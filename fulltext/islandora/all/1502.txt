Ryerson University

Digital Commons @ Ryerson
Theses and dissertations

1-1-2010

Inductive power transmission through printed sprial coils for seizure application
Amin Kalbasi
Ryerson University

Follow this and additional works at: http://digitalcommons.ryerson.ca/dissertations Part of the Electrical and Computer Engineering Commons Recommended Citation
Kalbasi, Amin, "Inductive power transmission through printed sprial coils for seizure application" (2010). Theses and dissertations. Paper 1125.

This Thesis is brought to you for free and open access by Digital Commons @ Ryerson. It has been accepted for inclusion in Theses and dissertations by an authorized administrator of Digital Commons @ Ryerson. For more information, please contact bcameron@ryerson.ca.

INDUCTIVE POWER TRANSMISSION THROUGH PRINTED SPRIAL COILS FOR SEIZURE APPLICATION

By AMIN KALBASI
(B.Eng, Ryerson University, 2007)

A thesis presented to Ryerson University in partial fulfilment of the requirements for the degree of Master of Applied Science in the program of Electrical and Computer Engineering

Toronto, Ontario, Canada, 2010

© Amin Kalbasi 2010

i

AUTHOR'S DECLARATION

I hereby declare that I am the sole author of this thesis.

I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research.

I authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or in part at the request of other institutions or individuals for the purpose of scholarly research. .

ii

INDUCTIVE POWER TRANSMISSION THROUGH PRINTED SPRIAL COILS FOR SEIZURE APPLICATION
Master of Applied Science, 2010 Amin Kalbasi Electrical and Computer Engineering, Ryerson University

Abstract
This thesis proposes a realistic model for transcutaneous inductive power link for seizure applications using PSCs (Printed Spiral Coils). The benefit of this model is smaller size implanted coil compared to its counterparts while maintaining high loaded system efficiency. The introduced Printed Spiral Coil (PSC) geometric parameters are achieved using MATLAB that searches for the highest efficiency of the inductive coil within the given constraints. The output from the MATLAB simulation is used to create optimum design in AMDSpro tool and is verified. The outer diameter of the implanted coil is introduced to be d o 2  6mm while the simulated efficiency is calculated as  sim  46.67% operating at f sim  2.52MHz for the relative distance of D  10mm filled with layers of modeled human skull (Outer Compact Layer,
Spongiosum, and Inner Comact Layer). The coupling coefficient of the spiral was calculated to be

k  0.69 . The implanted PSC is associated with load capacitance and resistance of

RL  4.5 and CL  95nf .

iii

Acknowledgements I wish to express my sincere thanks and regards to my supervisor Dr Kaamran Raahemifar. His invaluable guidance and help in my literature survey and other part of my thesis research work as my supervisor has assisted me profoundly. Without his insightful supervision, the achievements and contributions of this thesis would have never been feasible. Furthermore, his patience with me has been extraordinary through ups and downs where progress was very little allowing me to find my rhythm and encouraging me to move forward. He has always been a great mental and emotional support. I also want to extend my thanks to the committee members, Dr. M Kyan and Dr. K. M. V. McConville for their invaluable comments and feedback. Finally, I like to express my thanks and regards to my family from whom I drew my strength and support. They have gone through extraneous measures to facilitate achieving and striving toward high personal academic standings for many years. .

iv

TABLE OF CONTENTS CHAPTER 1 1.1 1.2 1.3 CHAPTER 2 2.1 INTRODUCTION Motivation Contributions Organization LITERATURE SURVEY Inductive coils 2.1.1 An Optimal Design Methodology for Inductive Power Link with Class-E Amplifier [11] 2.1.2 Designing Efficient Inductive Power Link for Implantable Devices [10] 2.1.3 Design and Optimization of Printed Spiral Coils for Efficient Transcutaneous Inductive Power Transmission [28] 2.1.4 Inductor Modeling in Wireless Link for Implantable Electronics [4] Operating frequency Summary THEORY Printed Spiral Coil Self Inductance Proposed PSC equivalent circuit model and losses Proposed PSC Coupling Coefficient, Q and Efficiency calculations Summary DESIGN The Proposed Design Methodology Design Constraints and Introduced Geometry Optimization 4.2.1 Parameter Authenticity Evaluation 4.2.2 Iterative Loop Structure 4.2.3 Self Inductance Calculation 4.2.4 Capacitance and Resonant Frequency Calculation 4.2.5 Resistance Calculation 4.2.6 Quality Factor Calculation 4.2.7 Mutual Inductance Calculation 4.2.8 Efficiency Calculation The Proposed Design of PSC in AMDSpro 4.3.1 Fabrication Compatibility 4.3.2 Biomedical Compatibility 4.3.3 Fine Tuning Summary RESULTS AND DISCUSSION Results and Analysis in MATLAB Results and Analysis in AMDSpro v 1 1 3 4 5 7 7 8 10 12 12 14 16 16 18 25 31 34 34 35 39 43 43 43 44 44 45 46 47 49 51 55 56 59 59 66

2.2 2.3 CHAPTER 3 3.1 3.2 3.3 3.4 CHAPTER 4 4.1 4.2

4.3

4.4 CHAPTER 5 5.1 5.2

5.3 CHAPTER 6 6.1 6.2 6.3

Discussion CONCLUSION Overview Contributions Future Work

71 73 73 73 76

vi

LIST OF FIGURES Figure 1.1: Block diagram of the wireless inductive power link [1] Figure 2.1: Power transmission break down Figure 2.2: Inductive link technology Figure 2.3: Geometry of two circular planar "pancake" coils [10] Figure 3.1: Square shape planar spiral inductor Figure 3.2: The proposed model for on-chip spiral inductor Figure 3.3: Printed Spiral Coil (external) Figure 3.4 Current Crowding in Spiral Traces [12] Figure 3.5: Simplified PSC model Figure 3.6: Schematic and equivalent circuit diagram for inductive power link [10] Figure 3.7: (a) simplified schematic diagram of the inductive link with lumped equivalent circuit elements (b) cross section of a pair of parallel conductors showing the parasitic capacitor components within the insulator and substrate [28]. Figure 4.1: The proposed program state diagram Figure 4.2: Square shape planar spiral inductor Figure 4.3: Square shape planar spiral inductor Figure 4.4: ADS designed PSC Figure 4.5: PSC underpass compatibility in AMDSpro Figure 4.6: human skull layers [22] Figure 4.7: substrate and human skull layers modeling Figure 4.8: (a) proposed iterative PSC design flow chart by [28] (b) proposed iterative design flow chart Figure 5.1: Data sweep of external coil versus quality factor Figure 5.2: Data sweep of quality factor and operating frequency Figure 5.3: Data sweep of quality factor and operating frequency for n=2,3 Figure 5.4: Normalized data sweep of implanted coil parameters and quality factor Figure 5.5: a) coupling coefficient k sweep b) external coil innermost radii ai iteration Figure 5.6: Input voltage of external coil Figure 5.7: Output voltage of implanted coil Figure 5.8: Instantaneous Input Power of external coil Figure 5.9: Instantaneous Load power of implanted coil 2 5 6 9 17 19 21 24 29 32

33 39 40 45 48 51 52 54 57 59 60 61 62 63 67 68 68 69

vii

LIST OF TABLES Table 4.1: PSC Geometric and operating parameter value range [16], [24] Table 4.2: M-file Programming Key Attributes Table 4.3: Material library created for AMDSpro Table 4.4: Human skull electromagnetic and physical properties Table 5.1: Optimized PSC Geometrics and Characteristics in MATLAB Table 5.2: Optimized PSC Geometrics and Characteristics Table 6.1: Result Comparison 36 38 50 53 65 70 75

viii

LIST OF ABBRIVIATIONS ADS ESR RF MOSFET PSC PLL RES SUB VCO Advanced Design System Effective Series Resistance Radio Frequency Metal Oxide Semiconductor Field Effect Transistor Printed Spiral Coil Phase Locked Loop Resonant Substrate Voltage Control Oscillator

ix

Chapter 1 Introduction

1.1 Motivation
Implanted electronics are extensively used as medical devices which both monitor and treat wide variety of conditions such as cardiac arrhythmia, deafness, paralysis prosthetics, and seizures; all of these conditions are treated or monitored using electronic devices such as pacemakers, cochlear implant, and brain implant. Historically power transmission or power protocol has been provided by a long-life battery or inductive link. Inductive RF link avoids the need for rechargeable battery. Implanted batteries require to be replaced by additional surgeries. These procedures increase the risk of infection and other complications. Furthermore, implanted battery takes up large space where space is very limited such as implanting electronic devices inside the skull. The power transmission protocol consists of two parts; the implanted part (in vivo) and the external part (in vitro). Figure 1.1 shows a general block diagram of an inductive power link system. The external device consists of a rechargeable battery connected to a switching circuit where the DC voltage is converted into AC signal in 1-10 MHz range frequency. The signal is then amplified through a class E amplifier and transmitted through a primary inductive coil to a secondary one implanted inside the skull. Once the signal reaches the LC tank, a limiting circuit, RF limiter, limits the amplitude of the induced voltage on the LC tank to protect it from hazardous high amplitude voltages [1].

1

Figure 1.1: Block diagram of the wireless inductive power link [1]

The power efficiency of the inductive link is of paramount importance due to heat and tissue damage caused by overheating. Winding separation as shown in Figure 1.1 affects the efficiency of the inductive coil. Furthermore, the primary and secondary windings are separated by a nonmagnetic material such as skin and skull where the transference energy is highly inefficient [25]. When designing power supply using inductive link the following issues should be considered:  The primary and secondary windings are separated by skin and skull where their thickness varies from one patient to another. Furthermore, the windings cannot be precisely aligned resulting in coupling variations [25].   Only biocompatible material can be used to seal the implanted devices. The power supply should be highly reliable since replacing of a potentially failed component requires surgery which could be costly and difficult.  Operating frequency of the power supply should be chosen carefully where the efficiency is at its highest value and tissue absorption is minimal.  AC resistances such as skin effect and proximity effect should be considered in designing efficient coils.

2

1.2 Contributions

Addressing the above design issues requires careful design procedure and methodology. Based on the recent advances, the importance of efficient and reliable power supply is highly emphasized since reducing tissue and skin heating is highly desirable and necessary for every implanted device. This thesis concentrates on the aforementioned factors and attempts to improve upon the performance of brain implantable device for seizure application. The thesis contributions are as following: 1. Establish a comprehensive equivalent circuit model for inductive Printed Spiral Coils (PSC) 2. Introduce MATLAB program that identifies PSC geometries for highest efficiency design in bio-implantable application based on system's constraints. 3. Improve the efficiency versus size of the realistic design rooted in the system's constraints using AMDSpro tool The above contributions will be discussed and justified in the coming sections. The inductive coil is designed in a 3-dimentional configuration with realistic modeling of human skull.

3

1.3 Organization

Chapter II consists of a brief survey about recent technological advances of bio-Implantable PSC and their advantages and disadvantages. This thesis justifies that a realistic model of a brain implantable PSC for power transmission of seizure application is missing in the recent studies. Chapter III of this thesis is the theory of the coupled Printed Spiral Coil (PSC) where the new equivalent circuit model is introduced and an overall expression for efficiency is presented. The theory chapter sets the field for achieving optimized parameter values based on the equations and environmental constraints. Chapter IV introduces the design where specific program is initiated in MATLAB to identify the optimum parameter values. Furthermore PSC model is imported from ADS tool to AMDSpro and is customized to fit the design objective and constraints. Chapter V discusses the results of MATLAB and AMDSpro simulations. Finally chapter VI is the conclusion of this thesis focusing on the results of simulations, the contribution of thesis and future work.

4

Chapter 2 Literature survey

In order to have a good picture of the topic under survey a proper outlook of the technology is required. Figure 2.1 shows the specific branch of the biomedical system's tree where this thesis research is focused on.

Figure 2.1: Power transmission break down

Other similar types of implantable system such as heart implant or cochlear implant require power delivery system or power source as well. However, these implanted devices have somewhat different specification such as tissue type, space availability, and power consumption. For instance the brains implants tend to be smaller than other implants due to limited space under the skull. Moreover, the tissue absorption is more of an issue since the brain cells are more
5

sensitive to external heating and high frequency signal waves compared to heart implant or shoulder implant. Different brain implantable devices are comparable; however, still some differences exist. In the seizure detection application most of the internal devices will be in the sleep mode periodically; therefore, causing high current draw fluctuations in the output of the power source (regulator). The power transmission system consists of different components which cover wide range of disciplines such as analog, digital, RF and electromagnetic. Figure 2.2 summarizes the inductive link components.

Figure 2.2: Inductive link technology

The Inductive link consists of the coils as part of electromagnetic device. The switching circuit consists of a class E amplifier. The CMOS voltage rectifier and regulator are other components of the analog design of the system. To limit the amplitude of the induced voltage on the LC tank and RF limiter is used to protect the implant from hazardous high amplitude voltage [1].
6

A brief review of the recent advances and technologies concerning the electromagnetic coils of the system shown in Figure 1.1 are discussed in Section 2.1. The coil operating frequency is discussed in Section 2.2.

2.1 Inductive coils
2.1.1 An Optimal Design Methodology for Inductive Power Link with ClassE Amplifier [11]
The author of [11] considers the primary and secondary coil losses separately in order to achieve independent optimization. Furthermore, the ESR (Effective Series Resistance) equation is calculated and mentioned. The primary contribution of author [11] is its concentration on efficiency, reducing tissue damage caused by overheating and ultimately considering skin and proximity effect into inductive coil models. The litz wires are bounded in numbers to reduce skin effect and proximity effect at high frequencies. Iitz wires consists of very thin wire bunched together to reduce skin effect and proximity effect in wires. However, Litz wire is space consuming and cannot be used for brain implantable devices. Moreover, Litz wires efficiency and parameters are highly process dependent. Author of [11] concentrates on the losses of the secondary coil from the induced voltage perspective. The major concentration of the author is on the class E power amplifier with closed loop circuit for tracking improvement. Sensitivity to frequency and component variation is the justification for the closed loop configuration. Reducing switching losses or achieving zero voltage switching condition will contribute to the overall efficiency of the system. The design of this inductive coil is more useful for other types of implants due to its parameters. The load voltage is 16 Vdc and the power induced in the secondary coil is calculated to be P2  275 mW
7

which is very large compared to the proposed specs of power consumption that is smaller than 25mW. In this range of power delivery the skin and heating effect of the coils are automatically reduced while issue of noise and efficiency still remains vital. Moreover, the optimal efficiency of the system proposed is when the coils are separated by 7mm; increasing the distance or even decreasing it will reduce the efficiency of the system. An extra adaptive control circuitry is needed for the class E amplifier to achieve optimized efficiency for a wide range of inductive coil distance.

2.1.2 Designing Efficient Inductive Power Link for Implantable Devices [10]
The author of [10] has presented a thorough analysis of a weakly coupled inductive link using planar spiral "pancake" coils from 100 kHz to 10 MHz. An expression for a complete efficiency was introduced as follows:

   PAT R
Eq. (1) is simply the efficiency of the transmitting and receiving circuit in addition to the efficiency of the class E amplifier. In Eq. (1) the receiving efficiency is defined as  R . The

(1)

solution to achieving a better total efficiency is to maximize the transmit efficiencyT . In order to maximize the transmit efficiency the quality factor (with load) of transmit and receive circuit should be maximized. The apparent trade off of this maximization is the reduced bandwidth of the resonant circuit. A narrow band power transmitter is highly sensitive to component variation as discussed in [10]. The quality factor of both coils is limited; therefore, in order to increase the efficiency of the system strong coupling coefficient is required. In the second part of the paper

8

the author of [10] is focusing on the coupling coefficient optimization of the coils. A final equation is achieved where the accuracy is within 5% of those obtained using field solver with a better computational speed up (105). The equation is as follows:

k

M LT LR

(2)

2 In Eq. (2) the mutual inductance M is a function of NT N R , LT is a function of NT , and LR is a 2 function of N R where N R and N T are the number of turns for receiving and transmitting coil

respectively. Hence the coupling coefficient k is independent of the number of turns in each coil and dependent on the total geometry of the coils. As mentioned before, the size of the coils are limited by the head room in the implantable device; therefore, the author suggests an optimal size for the coils where the highest coupling coefficient is achieved resulting in higher total efficiency, , while considering the physical limitation of the implanted device.

Figure 2.3: Geometry of two circular planar "pancake" coils [10]

Figure 2.3 shows the dimensions of the two spiral coils. These physical properties are d inR , d outR

and z which affects the coupling coefficient and the efficiency of the coils. One element that should be added to the argument is that the distance between the coils, z, is not filled with air.

9

The permeability of layers of skin, skull and body tissues should be considered when obtaining the optimum coupling coefficient of the system where it seems to be overlooked in the experimental results. Nevertheless, using the planar spiral coils is less space consuming than the solenoidal coils. The planar spiral coils comfortably rests on the surface of the skull fitting the limited head room of the brain implants. The fabrication of circular spiral is not implementable in all technology and design tools; different capacitance losses such as spiral to substrate and spiral to underpass are missing in equations. Furthermore, the effect of inductive coils equivalent series resistance is constant in the equations. As shown the ESR is highly dependent on skin and proximity effect.

2.1.3 Design and Optimization of Printed Spiral Coils for Efficient Transcutaneous Inductive Power Transmission [28]
The design of PSC for Transcutaneous Inductive Power Transmission is investigated by [28]. The proposed research presented in this thesis is the continuation of the work presented in [28], where Printed Spiral Coils (PSC) are chosen for the implantable purposes. PSC comfortably sits under skin flap with the rest of the implant electronics. For brain implantable PSC is the preferable choice since space limitation is an issue. Author of [28] performs a relatively thorough theoretical analysis to achieve highest efficiency for the implantable power transmission coils. In the theoretical analysis section of the paper, capacitance losses and ESR for the spiral inductor are exhibited. The final efficiency expression,

12 

k 2 Q1QL QL  2 1  k Q1QL Q2  QL

(3)

10

is used, along with other expressions of the coil, to find the optimum physical parameters of the spiral by means of MATLAB tools. An iterative design procedure which starts with a set of design constraints based on the implantable limitations and ends up with the optimum values by sweeping different parameters in MATLAB is discussed. The existing approach is a good starting point for achieving the highest efficiency in the field solver model. The author of [28] uses HFSS to verify its findings. The PSC introduced and analyzed contains missing elements in the theoretical calculation. Elements such as substrate losses and eddy current losses can affect the equations and starting parameters. The eddy current losses are due to electromagnetic field affecting the current distribution and increasing resistance in the conductor which is frequency dependent. The substrate losses will be defined in the Chapter 3. Furthermore, the existing model does not follow a realistic model in the calculation and the simulation. The brain or any other type of implantable power transmission coil is separated by some sort of tissue which affects the mutual inductance; this material was not specified in the design parameters or indicated in the field solver. In implantable technologies, electronic materials are coated with transducer encapsulating material such as Glass-Silicon [17]. These materials, although mostly transparent to RF signals, do contribute to capacitance losses along with the substrate. In the theoretical calculation the cross under capacitor is missing in the calculations. The cross under or underpass capacitance is the potential difference between the conductors which crosses from the inner most pin of the spiral to the outside of the spiral and the spiral traces. This capacitance is analyzed in the Chapter 3. Finally and most importantly, the coil sizes suggested and introduced are relatively high for implantable devices. The implanted coil outer diameter used is about 2cm which is fairly large if that design were to be implemented inside the skull where minimizing implanted PSC is of paramount importance.
11

2.1.4 Inductor Modeling in Wireless Link for Implantable Electronics [4]

The focus of [4] is on improving the power efficiency by increasing the Q of the coil pairs. In this paper the application of the link is telemetry. Therefore, the power loses due to skin and proximity effect is considered without neglecting the displacement current. The closed form analytical solution for calculating Q is claimed to be introduced innovatively to calculate the ESR, self resonant frequency and Q of the inductive coil. The idea is to maximize the Q by designing the coil for a given frequency or vice versa. There are two concerns in the proposed design in [4]. The first concern is the use of Litz wire for the purpose of design which makes it very process dependent compared to PSC technology that is widely used in RF designs and is well established. The second concern is that merely focusing on quality factor of the spiral coils does not guarantee high efficiency or performance. The mutual inductance of the spiral is an important factor in designing coupled coil which is mostly overlooked.

2.2 Operating frequency
The operating frequency of the inductive coil is very crucial from efficiency and biomedical perspective. It is obvious that increasing frequency of operation will improve the efficiency of the system. On the negative side other losses such as skin effect and proximity effect have a reversing effect on overall efficiency by increasing the losses. From biomedical and tissue absorption perspective, high frequency circuits affect the human skull and brain negatively. The high frequency is proven to be a harmful element in general. With that in mind, the author of
12

[19] suggests that the optimal operating frequency for the implantable device is in the GHz range while stating that there is no increase in tissue absorption when shifting the power transmission frequency from MHz range up to GHz range. The positive perspective of frequency increasing is the size reduction of the coils (suggested to be at least a factor by 104). A thorough analysis of the QUASI-STATIC vs. FULL-WAVE ANALYSIS was done and conclusion was reached that efficiency increases with frequency [19]. The problem with previous common belief scenario is that a low-frequency approximation technique was used to conclude the behavior at high frequencies. The author's statement regarding the direct relation of the efficiency and optimization is an overstatement. The skin and proximity effect are well proven physical concepts which are directly proportional with frequency, regardless of the approximation technique that is used. The proximity effect or current crowding is proportional with ESR of the coupled coils. These effects exist no matter what type of analysis is followed. These effects can be reduced as pointed out earlier in Chapter II; however, they are found to be the apparent trade off of higher frequency for power transmission in inductive coils. The power amplifier is designed to drive the primary coil with the desired frequency. In this case the higher frequency will produce higher switching noise for the MOSFET and increases the total loss or decrease the efficiency of the system. Nevertheless, the author of [19] points out that efficiency does not indefinitely increase with frequency due to relaxation losses. The fact that there will be an optimum operating frequency is admitted in the paper and this optimum frequency may well be in the MHz range. The permeability of the different tissue type is considered in the relaxation time constant  . The author of [19] suggests that the optimum permeability of brain and skull is in the GHz range.

13

2.3 Summary
The overall review of different technologies in the field can help us examine and improve the areas which have room for improvement. A brief look at what was reviewed earlier in this Chapter shows that a need for a realistic model is required; a model that represents the full biomedical limitations of an implant and a true theoretical model to back the proper calculation of that implant. Something that is not readily available in [28], [11], [15], [10] and [19] as they are more electrically focused. Having that in mind, this thesis tends to focus on the following contributions: 1. Establish a comprehensive equivalent circuit model for inductive Printed Spiral Coils The first contribution is to consider the environment of the PSC coils and create a model which is realistic in implantable seizure application. Chapter 3 explains this model that includes coating capacitance for both the external and implanted coils. The substrate and coil losses are also combined in one circuit configuration to give a better picture. Accordingly the equation for both the coating capacitances is estimated using parallel plate formulas. 2. Introduce MATLAB program that identifies PSC geometries for highest efficiency design in bio-implantable application based on system's constraints. In order to find an efficient model a proper algorithm is needed to search for the appropriate geometric parameters within the system's biomedical constrains. This model is introduced in Chapter 4 where a program was pioneered in MATLAB to use the

14

established theoretical knowledge governing a realistic equivalent model to find the optimized parameters. 3. Improve the efficiency versus size of the realistic design rooted in the system's constraints using AMDSpro tool The first two contributions are supporting this model both from the theoretical and efficiency perspectives. Chapter 4 shows how this abstract is realized in AMDSpro tool and tailored to fit its sole purpose of power delivery as a brain implantable device. Accurately modeling the human skull, considering other biomedical constraints and fabrication compatibility rules formulates the back bone of this thesis. The final contribution of this thesis is achieving high efficiency versus size ratio for the loaded realistic model in AMDSpro tool. Having the calculation steps is one thing but actual model requires further fine tuning to achieve a proper result that can be used once fabricated. The summary of the results of the calculation and simulation is presented in Chapter 5.

15

Chapter 3 Theory

3.1 Printed Spiral Coil Self Inductance
The realistic model of the Printed Spiral Coil (PSC) is introduced as the proposed model and is analyzed theoretically in this chapter. First, a brief review of the electromagnetic theory governing PSC inductors is very beneficial. The square shape Planar Spirals are easy to fabricate with almost any layout tool; their theoretical analysis is performed to achieve the most realistic set of equations describing the characteristics of coupled inductors using PSC technology. Furthermore, the theoretical analysis will set the proper stage for creating efficient model considering the human skull biological (temperature, space) constraints. The Inductance of an arbitrary spiral, considering crude zeroth-order estimate, is
L  0 n 2 r  4  107 n 2 r  1.2  106 n 2 r

(4)

In Eq. (4), n represents the number of the turns and r is the radius of a spiral in meters. Figure 3.1 shows that a typical square shaped spiral has more elements which are of concern. Eq. (4) is roughly 30% accurate; therefore, a more precise statement of inductance is needed which is based on some of the terms shown in Figure 3.1 as following [13]:

16

1.27   n 2 d avg   2.07     0.18  0.13 2  ln    2      d  d in   out d out  d in L

(5)

  0 r
In Eq. (5),  is the fill factor. The fill factor is an important element in the spiral coil design. As the inductor fills up the entire space d in approaches to zero and the fill factor  approaches to unity which is not desirable in terms of the self inductance since the innermost turns of a spiral inductor do not contribute to magnetic flux and yet they do add to the resistance. Finding a proper value for the fill factor is part of design parameters; however, 3:1 ratio between the outer and inner diameters is suggested (   0.5 ) [13].

Figure 3.1: Square shape planar spiral inductor Inductance of a PSC plays a major role in the overall efficiency of the coupled coil. In Figure 3.1

n , the number of turns, and d avg have direct relation to the coil's inductance. Intuitively
17

increasing those elements will result in higher self inductance; however, under the space restriction, increasing the turns will increase the fill factor  which promptly decreases the spiral's inductance; d avg can be increased slightly by reducing the gap between turns while the fill factor will improve as well. However, the turn to turn capacitance will increase and negatively affect the spiral. Having that in mind, other losses such as capacitance and resistances should also be considered with the overall efficiency of the coupled coil which will be investigated in the next section.

3.2 Proposed PSC equivalent circuit model and losses
The spiral inductors are subject to different capacitance and resistance losses. In order to introduce an optimum and realistic model these losses should be carefully examined. A realistic equivalent circuit is introduced for a coupled coil. This model compared to its previous counterparts gives a clearer picture of the overall losses. Figure 3.2 shows the equivalent circuit model for implantable coils. This model includes spiral, substrate, oxide and coating losses. The substrate and coating model is based on a symmetrical spiral inductor. The capacitance between the spiral and the substrate is represented as Cox1 and Cox2 ; these capacitances can be approximated by parallel plate formulas where the total area is the winding area [13].

Cox  0.5

w  l   ox tox

(6)

18

Figure 3.2: The proposed model for on-chip spiral inductor

In Eq. (6), w and l are the width and the length of the spiral; tox is the oxide thickness and the finally  ox is considered to be permittivity of the oxide layer. The substrate capacitance and resistance are represented as CSub and Rsub respectively; doping of the substrate affects the value of the capacitance and resistance which is mostly known as substrate loss. If the substrate is lightly doped the loss can be neglected; however, highly doped substrate can carry eddy currents losses [9]. For the purpose of complete analysis these losses are considered here in theoretical approaches. The parallel plate formula can be used for most of the capacitances of substrate and coating as well; however, it should be noted that the effect of image current from oxide to the substrate and from substrate to the coating forms the CSub and Cco . The substrate Rsub shows the substrate dielectric loss which is linked to the current that is coupled into substrate through Cox which is given by [13]:

19

Rsub 

2 w  l  Gsub

(7)

In Eq. (7), the resistance is measured using uniform conductor formula. In this equation w and l represent the width and the length of the substrate and Gsub is the fitting parameter that has the dimension of conductance per area. It is considered to be constant for a given substrate material and, as mentioned before, proportional to the doping of the substrate. The capacitance of the substrate can be similarly represented as:

Csub 

w  l  Csfp 2

(8)

Eq. (8) similarly uses substrate fitting parameter Csfp , which is directly related to substrate doping. Author of [13] have introduced typical values for the resistance and capacitance fitting parameters as Gsub  107 S m2 and 103  Csfp  102 fF m2 ; as mentioned before, the current mirror continues to create capacitance in both upper and lower coating layer of the external and internal coil. The lower coating contributes to another layer of capacitance; however, the upper coating will negatively affect the mutual inductance M in Figure 3.2 which will be discussed later in this section. The coating capacitance for the lower level can be expressed as:

Cco  0.5

w  l   co tco

(9)

The coating capacitance in Eq. (9) is potential difference between the charges stored at the lower end of the substrate layer as a result of current mirror effect and the external surface of the coating layer demonstrated in Figure 3.3(b). The coating material will play a major role in the capacitance. Similar to the oxide capacitance expressed in Eq. (3), the coating capacitance can be
20

represented for internal and external coil as Cco1 and Cco 2 . The coating and oxide material in both of the coatings are considered to be identical. The only differentiating factor between the external and internal substrate, oxide and coating may be their environment temperature. This temperature does affect the capacitance and resistance, resulting in substrate resistivity amplification as temperature increases. Having that in mind, the temperature for the external and internal coil is assumed to be identical in calculation.

Figure 3.3: Printed Spiral Coil (external)

21

At the beginning of this section, spiral losses were mentioned. Continuing our theoretical analysis, the spiral losses shown earlier are considered to be the parasitic capacitance CP and effective series resistance RS for both the internal and external coils. Graphically, these losses are subject to physical characteristics of the coil in Figure 3.3(A). The parasitic capacitance of a spiral coil can be the sum of lateral capacitance and the overpass or shunt capacitance. The lateral capacitance consists of the capacitance from turn to turn of the spiral shown in Figure 3.3(B) as C1 . The shunt capacitance Csh consists of the capacitance overlapping area between the cross-under and the rest of the spiral. Cross-under is used to access the inner most terminal. Therefore, the parasitic capacitance of the spiral can be represented as:

CP  C1  CSh

(10)

The lateral capacitance is considered to be negligible since the turns are almost equipotential and its series connection results in a much smaller capacitance value compared to shunt capacitance. The expression for the shunt capacitance can benefit from the same parallel plate formula. The author of [29] introduces the following equation for the shunt capacitance:

C sh  n  w 2 

 ox
t oxM1 M 2

(11)

In Eq. (11), n represents the number of overlapping turns; w is the width of the spiral and

toxM1 M 2 is the oxide thickness; increasing this thickness reduces the shunt capacitance; however,
fabrication limitation imposes the maximum distance that can be implemented between two metal layers.

22

The effective series resistance of the PSC shown in Figure 3.2 for internal and external coil is the sum of skin resistance and eddy current [9]. The PSC resistance can be investigated in two areas, the DC resistance and the frequency dependent resistance. The DC resistance entirely depends on the physical characteristics of the spiral and can be represented as:

RDC  c

lc w  t0

(12)

In Eq. (12),  c is the resistivity of the conductive traces of the spiral which depends on the metal layer(s) used. In order to reduce the resistance of the spiral, the topmost metal layer can be used coupled with two or more layers strapped together to reduce resistance. Effective series resistance RS is a combination of DC resistance and frequency dependent resistance. This frequency dependent element of resistance can be interpreted as skin resistance and eddy resistance [9]. At high frequencies, skin effect is due to magnetic fields causes' non-uniform current flow in the conductor, causing most of the current to flow near the surface of the metal traces [21]. The expression below represents this effect:

Rskin 

l w (1  e t  )

(13)

In Eq. (13),  is the skin depth of the metal layer which is given by,
2





(14)

In Eq. (14),  is the angular frequency,  is the permeability of the metal layer and  is the conductivity of the spiral trace.

23

Figure 3.4 Current Crowding in Spiral Traces [12]

Current crowding is caused by the eddy current field shown in Figure 3.4. The magnetic field of adjacent turns of spiral inductor penetrates the metal trace and produces eddy current loops. These loops constrict the normal flow of excited current and increase the effective resistance with respect to the uniform distributed current flow in the spiral strips. According to [21], the eddy current resistance is represented as

Reddy  0.1  RDC (

f f crit

)2

(15)

where,

f crit 

310 Dout  Din  2W  0.65 0.28 ( )W S 0t l

(16)

In Eq. (16), Dout and Din are the outer and inner diameter of the spiral. W is the conductor width normalized to 25.4 m and similarly S is the spacing between the spiral traces which is also

24

normalized to 2.54 m . Therefore, the total series resistance of the spiral inductor is expressed as the sum of the eddy and skin resistance as follows:

Rs  Rskin  Reddy Rs  RDC ( t0   (1  e  t 0




1 t 1 0 w

 0.1(

f f crit

)2 )

(17)

The expression in Eq. (17) shows the series resistance with respect to DC element. This equation can be used to investigate how to minimize the effective series resistance beside the constant DC resistance that is purely dependent on the physical aspect of the metal layer. As mentioned earlier cascading different metal layers together on the spiral strip can reduce the DC resistance. Furthermore, some techniques such as increasing the spacing between traces and reducing operating frequency will reduce the eddy and skin effect resistances in the spiral. However, these improvements could reduce the spiral inductance and the overall efficiency of the power transmission device; therefore, an expression for the total efficiency of the system is required in order to achieve the optimum parameter values. The next section introduces expression for inductive coil efficiency.

3.3 Proposed PSC Coupling Coefficient, Q and Efficiency calculations
The efficiency of the system  s is directly dependent on the mutual inductance M and the quality factor of the system k . In general the coupling coefficient is between two magnetically coupled coils is defined as:

k

M L1L2

(18)

25

In Eq. (18) L1 and L2 are the self inductance of the primary and secondary coils which was discussed earlier in Section 3.1. Therefore, higher mutual inductance results in better coupling coefficient k between the two coils. The mutual inductance of the PSC is a complicated expression [28]. The mutual inductance of a set of single-turn coils with shrinking diameters is expressed by M ij . The turns of the spirals are series connected. Therefore, the overall mutual inductance M is equal to the sum of the partial mutual inductances. Therefore, the mutual inductance of the single turn set of coils surrounded in non air medium is shown in the following equation:


M ij    J1 ( x
0

r ri  D ) J1 ( x j )  J 0 ( x ). exp(  x )dx rj ri ri  rj ri  rj

(19)

In Eq. (19), D is the relative distance between the coils, which in the design application is filled with human skull (  skl ), skin (  skn ), and spiral coating (  co ). Therefore, the relative permeability  r can be expressed as,

 r   skn   skl   co

(20)

In Eq. (19),  is the lateral misalignment or distance between the axes of the spiral. J 0 and J1 are the Bessel functions of the zeroth and the first order, respectively. If the coils are perfectly aligned (   0) the equation can be reduced to:

1  1 M ij  2 ri  rj [(  ) K ( )  ( E ( )]  2 
where,

(21)

26

  2(

ri  rj (ri  rj ) 2  D

1

)2 2

In Eq. (21), K ( ) and E ( ) are respectively the complete elliptic integrals of the first and second kind [28]. As said before, in order to calculate the total mutual inductance between the spirals, all the turns must be counted in for Equation (21) in case of perfect alignment. Therefore, we have:

M    M ij (ri , rj , D)
i 1 j 1

n1

n2

(22)

The parameter  is related to the shape of the spiral. This shape element is introduced in [28] to be 1.1 for the pair of square shaped PSC compared to 1.0 of a circular shape. In order to calculate the quality factor of a circuit, the overall outlook of Figure 3.2 equivalent model requires some simplification. The simplified approximate circuit is shown in Figure 3.5 where the substrate, oxide and coating capacitances are simplified and is represented as CSB . On the other hand, for RLC circuit simplification the Effective Series Resistance (ESR) is converted to an equivalent parallel resistance RP . This conversion follows the Thevenin equivalent circuit theorem where the combination of series voltage source is converted to the parallel current source. The parallel resistance relates to Rs as shown in the following equation [14]

Rp 

(L) 2 , Rs

(23)

where,  is the angular frequency and the L is the inductance of the corresponding resistance. The operating frequency or the centre frequency of the transmitter and receiver resonant circuit is

27

defined as   0 

1 . Having that in mind, the quality factor of a coil for an RLC parallel LC

circuit can be expressed as:

1 1  Q1 RS

L1 1 L1 1 1    Ceq1 RP1 Ceq1 QRS QL1

(24)

and for the implanted spiral is,

1 1  Q2 RL

L2 1  Ceq 2 RP 2

L2 1 1   Ceq 2 QRP 2 QL2

(25)

In Eqs. (24) and (25) the equivalent capacitance Ceq1 and Ceq 2 are the parallel combination of external and internal capacitors respectively expressed as,

Ceq1  CP1  CSB1 and Ceq 2  CP 2  CSB2  C2 . In Eq. (24), RS is the source resistance or output
resistance of the switching circuit. The quality factors for both the transmitter and receiver system is divided into loaded and unloaded quality factors represented by QRP and QL in Eqs. (24) and (25) which represents the energy stored in the series resistance and the load resistance respectively. For instance, the receiver coil energy in Figure 3.5 is divided between the parallel resistance RP 2 and the load resistance RL .

28

Figure 3.5: Simplified PSC model The efficiency of the spiral inductor system is highly dependent on the quality factor of the system and the coupling coefficient. In order to better define the overall system efficiency

 s needs to be broken down into transmitter internal efficiency and the transmitter and receiver
efficiency 12 and the receiver internal efficiency  22 .Although the focus of this thesis is on spiral inductor efficiency (12 ), other efficiencies such as switching circuit and load efficiency is highly interrelated in selecting the system's optimal parameters. In a nut shell, the efficiency of the system break down can be expressed as:

s  1222

(26)

Based on [14], the first efficiency ( 12 ) in Eq. (26) is the ratio between the delivered power to the receiver circuit and the total power given by the current source in Figure 3.5 is given by,
29

12 

1 1 1 2 k Q1Q2

(27)

In Eq. (27), coupling coefficient was previously defined. To complete the system efficiency the second part of Eq. (26) is the internal receiver efficiency 22 . As discussed earlier in this section the receiver efficiency is dependent on coil's ESR which is converted to parallel resistance RP 2 and receiver load RL stored energy.
1 1  R Q 1  L 1  R2 RP 2 QL 2

22 

(28)

Using Eq. (27) and (28), the system efficiency in Eq. (26) can be expressed in terms of system's parameters which is,

s 

1 1 [1  2 k L1L2 1 Rs 2 R R R RR (   2 s21  4s1 2 s 22 )]  [1  L2 s22 ] 2 2 (CP1  CSB1 )(CP 2  CSB2 ) RS RL RS L2  L1 RL  L1 L2  L2

(29)

The Eq. (29) is not based on primary parameters yet but gives an overall relation between the dependencies. It should be noted that in Eq. (29) the current source resistance RS should not be mistaken with ESR of primary and secondary coils represented with small subscript ( Rs1 and Rs 2 ). On a first glance at Eq. (29) it is obvious that increasing the coupling coefficient k will increase the efficiency of the system; however, there are many other elements which in practice are interrelated. Eqs. (4)- (29) are the link between the primary parameters and the overall efficiency of the system in Eq. (29). In order to find the primary parameters to which it gives the highest possible efficiency within the system constraints other mathematical tools such as
30

MATLAB should be used. Nevertheless, theoretical calculation are not full proof system to find the optimum parameters since the efficiency model introduced is based on approximation and does not fully guarantee the optimum results. Hence, the use of field solvers is very handy in finding and evaluating introduced geometries. Therefore, the outcome of primary values from MATLAB calculation based on the introduced equations is to be used as an input to AMDSpro software and modified further to achieve an efficient and realistic model for PSC in biotelemetry application.

3.4 Summary
In summary, the realistic and complete equivalent circuit model for inductive PSC was achieved and represented in Figure 3.2. The model is unique from previous models proposed in a way that includes both the substrate and the spiral losses in a single circuit configuration. This has improved the understanding and the simplification of the model in this chapter. Furthermore, the coating capacitances introduced in Eq. (9) is C co  0.5

w  l   co where Cco for external and t co

implanted coil is incorporated in C eq1 and C eq 2 calculation. The equivalent parallel capacitance relates directly to the link operating frequency between the external and implanted coil through f 

1 2 L1C eq1



1 2 L2 Ceq 2

. Identifying the correct resonant frequency with respect

to PSC's geometries is a key to introducing an optimum and realistic model. The other model investigated in the literature survey proposed different equivalent circuits. The equivalent circuit model introduced in [10] identifies the receiving and transmitting capacitance

C R and CT respectively shown in Figure 3.6. However, the detail of that capacitance is not
31

evaluated in this paper. The receiving capacitor itself is a combination of the spiral parallel capacitance and the load capacitance. The author of [10] overlooked the importance of identifying the actual breakdown of the receiving capacitor.

Figure 3.6: Schematic and equivalent circuit diagram for inductive power link [10] The author of [28] demonstrates the equivalent circuit model where C p1 and C p 2 represent the external and implanted load capacitances as shown in Figure 3.7 (a) where the breakdown of

C p 2 is the turn to turn capacitor in the insulator and the substrate shown in Figure 3.7 (b). In the
model presented in [28] the substrate and coating capacitors are missing in this configuration. The author also overlooked an important part of design which is the underpass capacitor discussed earlier in this Chapter.

32

Figure 3.7: (a) simplified schematic diagram of the inductive link with lumped equivalent circuit elements (b) cross section of a pair of parallel conductors showing the parasitic capacitor components within the insulator and substrate [28]. The turn to turn capacitance C pc and C ps are the lateral capacitors in the coating and substrate medium. Here they are introduced by [28] as the main contributing capacitor in the spiral losses. However, as mentioned earlier in this Chapter the lateral capacitance is considered to be negligible since the turns are almost equipotential and its series connection results in a much smaller capacitance value compared to shunt capacitance.

33

Chapter 4 Design

4.1 The Proposed Design Methodology
In order to achieve an optimized inductive link, our system parameters must be defined based on initial constraints which in design of PSC can be defined as environmental limitation, for example, implantable coil size, operating frequency and so on. Therefore, defining the internal and external coil physical constraints, their relative distance and chosen range of operating frequency are the restraining elements. The physical constraints are based on location of the inductive implant as well as commonly used sizing with the objective of reducing the sizing of the coils as much as possible while maintaining the efficiency. In another words, this realistic model is striving toward achieving the highest efficiency versus sized design as reported in the literature survey. MATLAB software utilizes the input parameters that were identified earlier, and in an interactive manner introduces various PSC parameters for internal and external coil. These parameters are tested for authenticity and then the program searches for the highest efficiency parameter for inductive couple PSC within the three dataset. The outcomes of these calculations are three sets of optimum parameter for external and internal PSC, optimum load capacitance and resistance value, and resonant frequency of operation for each set of parameter. The detail of this calculation and the programming method is elaborated in Section 4.2. The output of Matlab optimization parameter search is then utilized to design the coupled coil in ADS software. This software is professional tool for designing and fabricating RF antenna's and

34

circuitry. Therefore, the preliminary internal and external PSC is designed using the ADS software. Since ADS is a two dimensional environment and the distance between the two spirals are not adjustable from the standard fabrication rules, the CAD design from ADS software is imported into AMDSpro software which has three dimensional capability as well as environment settings for appropriate human skull medium and permeability. Having that in mind, the coils are separated in AMDSpro to the human skull relative distance. The distance is filled with the material representing the electrical characteristics of human skull. Furthermore, the substrate characteristic of the internal and external coil and their coatings are added to the imported CAD design. Detail of the design modeling in ADS and AMDSpro tool are described further in Section 4.3.

4.2 Design Constraints and Introduced Geometry Optimization
PSC design constraints are building blocks of the system and hence the optimum performance can be investigated within these constraints. Table 4.1 shows the initial limiting parameters for external and internal (in vivo) PSC.

35

EXTERNAL COIL PARAMETERS External coil outer diameter External coil inner diameter Number of turns Coil Fill Factor conductor width tracing conductor spacing IMPLANTED COIL PARAMETERS Implanted coil outer diameter Implanted coil inner diameter Number of turns Coil Fill Factor conductor width tracing conductor spacing COMMON PARAMETERS Coil Relative Distance Operating Frequency

Symbol do1 di1 n1 1 w1 s1

minimum 18 mm 1 mm 2 0.01 150 µm 150 µm

maximum 30 mm do1-1 mm 14 0.99 6000 µm 600 µm

do2 di2 n2 2 w2 s2 D f

10 mm do2-1 mm 2 14 0.01 0.99 150 µm 2000 µm 150 µm 200 µm 7.7 mm 1 MHz 10.8 mm 50 MHz

6 mm 1 mm

Table 4.1: PSC Geometric and operating parameter value range [16], [24] It should be noted that parameter expressions from Chapter 3 are slightly changed to facilitate software coding. In Table 4.1, the outer diameter d out is expressed as d o and d in is expressed as d i . Also the index of 1 or 2 in the symbol represents the external and implanted parameters respectively. The range of parameters of Table 4.1 can be justified from different references. The external coil size d o1 are based on implanted coil size d o 2 . For biomedical implantable size coil
10  10mm2 is found to be the maximum useable area [16], [24]. As mentioned in Section 4.1 the

goal is to minimize this size further to achieve lower space consumption while maintaining the efficiency. The external coil size is relative to the internal one with obviously less size restriction. However, from practical point of view 30  30mm2 may be too big to fit on the skull and could cause inconveniences for the patients. Consequently, the minimization of the internal will lead to less

36

space consuming external coil. The inner diameter d i for both the external and implanted coil are related to external coil size of the respective coil and could have a big range as shown in Table 4.1. The reasonable values are discussed later in this Section. The chosen range for number of turns n , spiral trace width w and spiral gap is all based on outer diameter of the spiral and fill factor. Finally the spiral relative distance is based on measured values in skull width calculation from [14]. The relative operating frequency was focused on Section 2.2. In order to find the best possible set of parameters Table 4.1 boundaries should be tested for efficiency result to find the set of strictures that represent the highest efficiency value. This process is iterative and there are several check points in the program to verify the accuracy of the calculation against theoretical and AMDSpro tool. Otherwise designing large number of PSC with different parameter and simulating each set for their performance evaluation could be extensively time consuming and impractical. Although the theoretical values should give us good direction toward choosing those parameters but the complexity of equations and their interdependency of one element to another makes it extremely difficult or even impossible to verify the right parameter values by hand calculations. Therefore, MATLAB is used as an effective tool to extract the right set of geometric parameters for implementing our design. The AMDSpro tool is constantly used throughout the process to verify MATLAB's results. For that matter, by using MATLAB M-file a program is introduced accordingly to achieve this objective. The program contains a set of important criteria that is outlined in Table 4.2. Each column of the table will be presented in detail to justify and expand on the authenticity and contribution of the thesis.

37

MATLAB M-File Programming Key Attributes 4.2.1) Parameter Authenticity Evaluation 4.2.2) Iterative loop structure 4.2.3) Self Inductance Calculation 4.2.4) Capacitance Calculations -Resonant Frequency Calculations -Load Capacitance Calculation 4.2.5) Resistance Calculation - Load Resistance Calculations 4.2.6) Quality Factor Calculation 4.2.7) Mutual Inductance Calculations 4.2.8) Efficiency Calculation

External Coil YES YES YES YES YES NO NO NO YES COMMON COMMON

Implanted Coil YES YES YES YES NO YES YES YES YES COMMON COMMON

Table 4.2: M-file Programming Key Attributes

The representation in Figure 4.1 is very much self explanatory and shows the flow of the program. The top left corner of the diagram shows the initialization followed by two major iterative structures which takes place one after another for external and implanted geometries. If the parameters are not qualified geometries, which will be explained in Section 4.2.1, calculating self inductances, quality factor and storing parameters will be skipped for that iteration. Finally a separate loop structure shown in the bottom section of Figure 4.1 is introduced to calculate the different combination of coupling coefficient and its corresponding efficiency values. Once the data for efficiency array is stored a search will identify the highest efficiency value and its related parameters for external and implanted coil.

38

Initialize

Iterate, n1, w1, din1

Iterate, n2, w2, din2

Qualified Geometry?

Qualified Geometry?

No Yes. Yes.

No

Yes

No CALCULATE L1, f, Q1 Store Geometries N1[] W1[] Din1[]

No CALCULATE L2, RL, Q2, CL Store Geometries N1[] W1[] Din1[]

End of iteration?

End of iteration?

Yes

Iterate For data set External (1 to x) For data set Implanted (1 to y) No CALCULATE K[x][y] Efficiency [x][y] Yes

Find Maximum efficiency Efficiency [i][j] Return corresponding sizes N1[i] W1[i] Din1[i] L1[i] Q1[i] f[i] N2[j] W2[j] Din2[j] L2[j] Q2[j] RL[j] CL[j] K[i][j]

END End of iteration?

Figure 4.1: The proposed program state diagram

4.2.1 Parameter Authenticity Evaluation
The parameters in Table 4.1 are swept according to specified range. However, there should be an evaluating equation which assures that the PSC is designable according to basic laws of size and

39

area compatibility. Choosing random number of turns, width, spacing and inner diameter within our design constraints can simply be useless since the parameters cannot form a square spiral due to one or more parameter being too small or too large as shown in Figure 4.2

Figure 4.2: Square shape planar spiral inductor In Figure 4.2 the total area occupied by spiral, gapping and inner space is a square with area of At  d o ; the empty square area inside the spiral is represented by Ae  d i ; alpha () is the box shown in Figure 4.2. The expression governing the conduction area Ac is shown as:
2 2

At  Ae  Ac  
or in another words,

d o  d i  [(lc  w)  (l g  s)]  (w  (w 2  s)

2

2

(30)

In Eq. (30), inside of the bracket represents the conduction area Ac and   (w  (w 2  s) . Furthermore, lc , l g are the spiral trace and spiral gap length respectively. The objective at this
40

stage is to modify Eq. (30) so that it can be represented in terms of primary parameters of spiral such as outer diameter, d o spiral width w , spacing s , and number of turns n . Therefore, spiral conduction length must be reconfigured. The spiral trace length lc can be divided into subsection for each side as shown in Figure 4.2. Hence for this particular spiral it can be written as,

lc  lc1  lc 2  ...  lc12
or in terms of the outer diameter and spiral width and gap,

l c  d o  2  (d o  w)  2  (d o  2  w  s)  2  (d o  3  w  2  s)  2  (d o  4  w  3  s)  2  (d o  5  w  4  s)  (d o  6  w  5  s)  ( w / 2)

The above expression can be simplified. Also the last term in the above expression is related to the last spiral trace length which is shorter due to Alpha () in Figure 4.2. The simplified version of the above equation can be shown as,

lc  12  d o  12  w  25  (s  w)  (w / 2)
Inserting the number of turns in the above expression gives rise to a general phrase square shaped spiral trace length. After several evaluations and verification with different examples and ADS tools the generic expression achieved for spiral length is:
lc  4  n  d o  4  n  w  [(2  n  1) 2  (s  w)]  (w / 2)

(31)

The next step towards reconfiguration of Eq. (30) is to find a similar representation for the length of spiral gap l g . In Figure 4.2 the length of different gaps are indicated on the gap space between the traces. Therefore, we have,
41

l g  l g1  l g 2  ...  l g 8

The length of the spiral gap can be expressed based on outer diameter, d o , spiral width w , spacing s , and number of turns n which is,

l g  4  (d o  w  n)  (n  1)  4  s  (n  1) 2

(32)

Having both lc , l g from Eq. (31) and (32) inserted into Eq. (30) will give practical value to the main authenticity evaluating equation. Thus we have,
d o  d i  [((4  n  d o  4  n  w  (2  n  1) 2  ( s  w)  ( w / 2))  w)  ((4  (d o  w  n)  (n  1)  4  s  (n  1) 2 )  s)]  ( w  ( w 2  s))
2 2

(33)

Any set of parameter that is used by MATLAB has to be tested with Eq. (33) for parameter compatibility and authenticity. This equation is the necessary condition for valid set of attributes but not guaranteed to be the sufficient requirement. In experimental programs difficulties were identified with some PSC parameter sets that did not fit the ADS design constraints. The difficulty was related to the minimum value for the internal diameter of spiral or in another words maximum space that gap and trace can occupy combined ( s  w) and number of turns in relation with the outer diameter. To rectify that problem two additional limiting expressions was added as sufficient factors; the inequalities are,

d o  (s  w)  (2  n) , l g  4  d i  (n  1)
With the above two terms the iterative loop structure can be set.

(34)

42

4.2.2 Iterative Loop Structure
The iterative structure of the program is used and different geometries for external and implanted PSC are tested. The loops are structured to assure all combination of possible parameters. The body of loop contains the evaluating condition along with other measurable parameters such as coil self inductance, resistance and capacitance values. Number of turns n , inner diameter and the spiral width w are swept in a sequential "for" loop. This loop is closed after all the calculations are complete and the appropriate strings are stored to be used for later stages of the program.

4.2.3 Self Inductance Calculation
The self inductance of external and implanted coil measured based on Section 3.1 Eq. (5). The only technique used in this section of the calculation is that the self inductance is being calculated after parameter authenticity evaluation expression shown in Eqs. (33) and (34). The relative permeability of spiral  r is shown in Eq. (20) and is related to human skull. The calculation of self inductance of the spiral depends only on the spiral physical parameters; however, to calculate the quality factor of a PSC capacitance and resistance of the spiral along with the frequency of operation is needed.

4.2.4 Capacitance and Resonant Frequency Calculation
The objective is to find the appropriate values for equivalent capacitances C eq in Eqs. (24) and (25) using the simplified model shown in Figure 3.5. The detail equation supporting various capacitances identified in Section 3.2 is used here. The units are changed to Farad to be

43

compatible for SI units. A second look at Figure 3.5 shows that Ceq1  C P1  C SB1 ; however,
Ceq 2  C P 2  C SB2  C2 . As a result, the calculation of Ceq1 is done based on the physical

parameter and results in resonant frequency calculation based on f  1 2 L1Ceq1 . Knowing that the inductive PSCs are operating at resonant frequency will help identify the optimum C2 from Ceq 2 , thus we have,

f 

1 2 L1C eq1 1  L2
2



1 2 L2 C eq 2

 C eq 2 

C 2  C eq 2  C P 2  C SB 

4.2.5 Resistance Calculation
Similar to capacitance the resistance of the internal and external were evaluated based on the Eqs. (15) and (23) in Sections 3.2 and 3.3 respectively. The frequency of operation is identified; therefore, the series resistance Rs or its equivalent parallel resistance R p are based on the resonant frequency. The only unknown parameter in Figure 3.5 is the load resistance which should be chosen to deliver the maximum power to the load.

4.2.6 Quality Factor Calculation
The quality factor can now easily be calculated based on parameters previously achieved. The quality factor in Eqs. (24) and (25) are stored in an array to be used later in the software. The

44

only point worth adding here is that the implanted coil has its own quality factor which is distributed between the parallel resistance and the load resistance. Therefore, Eq. (26) in Section 3.3 shows the implanted efficiency with respect to the internal parallel resistance and load resistance. Since internal resistance of a spiral is fully dependent on its physical parameter and operating frequency the load quality factor can be skipped and incorporate Eq. (26) directly into system efficiency calculation.

4.2.7 Mutual Inductance Calculation
Once the internal and external physical parameters were stored in the appropriate arrays, the values can be then utilized to calculate the mutual inductance in a separate "for" loop or iterative structure. The equations used to calculate Mutual Inductance have been stated in Section 3.3. A good look at the parameters in Eq. (21) shows that the mutual inductance of each loop for internal and external is calculated based on the radius of a circular coil. However, the proposed model is a square shaped spiral. In order to facilitate the calculation the radii of a square shaped spiral for external and implanted coil is approximated as shown in Figure 4.3.

Figure 4.3: Square shape planar spiral inductor

45

In Figure 4.3 each radius is represented based on the physical parameters of the square shaped spiral. In another word, if we were to promote the square shape PSC to a circular PSC the radius of each turn will be the circles shown in Figure 4.3 with the radius drawn. Hence, for this particular spiral we have,
a1  (d o  2w)  2 2 a 2  (d o  4w  2s)  2 2 a3  (d o  6w  4s )  2 2

Therefore, the radius of each turn can be represented in general form of,

ai  (d o  2  (i  w  (i  1)  s))  2 2

1 i  n

(35)

where n is the number of turns in a spiral inductor. Eq. (35) is applicable for any PSC which will be utilized to complete the calculation in Eqs. (21) and (22). The iterative loop calculates the coupling coefficient for all possible combination of external and implanted PSC and saves the result in an array. This array is then used to calculate the system efficiency for each combination. The efficiency calculation is done within the coupling iterative structure.

4.2.8 Efficiency Calculation
System's efficiency is based on Eqs. (26), (27), and (28) in Section 3.3. The continuation of last subsection code before end of the iterative loop for coupling coefficient calculation is PSC system efficiency calculation. The important part of the algorithm is saving each combination of PSC efficiency value in an array and storing its corresponding external and implanted PSC data set index. In the final section the program searches for the maximum value of efficiency from the identified array. The simulation was done for three sets of values and parameters highest

46

efficiency was stored. The simulation results and analysis of the parameters will be discussed in Chapter 5.

4.3 The Proposed Design of PSC in AMDSpro
The ADS (Advanced Design System) software is electronic design automation software for RF, microwave, and signal integrity applications. ADS tool is used to create RF designs such as PSC and contains pre defined substrate library. This tool is designed to manufacture and fabricate different RF designs in two dimensional elements. On the other hand, AMDSpro or EMpro tool is Agilent's software design platform to analyze 3D electromagnetic (EM) effects of different components such as high RF IC packages, biomedical devices and antennas. This tool gives the benefit of three dimensional simulations for the purpose of PSC; however, many predefined layers and substrate elements in ADS tool are missing in this software which needs to be defined. On the other hand, EMpro tool supports the platform for defining different biomedical materials as well. At this stage of design, three sets of parameters are at hand for design using ADS software. The external and implanted square shape spiral is drawn as shown in Figure 4.4 using the ADS software. The spiral internal underpass connection is not being implemented in ADS. Nevertheless, AMDSpro software will be able to add that connection in three dimensional setting with the appropriate distance.

47

Figure 4.4: ADS designed PSC

The technique of designing in the initial stage of PSC in one environment and importing it to another one creates a lot of challenges. PSCs in ADS are preset for fabrication. Therefore, elements such as underpass distance, substrate and metal layers properties are mostly missing when the CAD format of Figure 4.4 is imported to AMDSpro software. Consequently, those initial settings need to be redefined and in some cases experimented to improve the overall efficiency of the model. In general designing PSC in AMDSpro was proceeded with three main attributes in mind:    Fabrication Compatibility Biomedical Compatibility Fine tuning
48

Each of these elements is elaborated in more detail in Sections 4.3.1, 4.3.2, and 4.3.3 respectively.

4.3.1 Fabrication Compatibility
ADS design tool is tailored for RF design circuitry and as a result preset to be compatible with fabrication rules. On the other hand, AMDSpro is a general electromagnetic design tool which supports three dimensional simulations and meshing of different electromagnetic devices and antennas; however, there are no preset rules with regards to fabrication of the designs. In order to be completely practical this model should meet the normal fabrication laws for testing purposes and commercial comparability. Upon the importing of CAD design of Figure 4.4 into AMDSpro the library was updated to reflect the different layers of material used in ADS design tool. Tabulated materials imported into AMDSpro are shown in Table 4.3. The material library created assures physical compatibility between the predefined conductive layers in ADS tools with AMDSpro. In another words the final design characteristic can be fabricated since standard material rules are followed. A second look at Table 4.3 last column indicates the thicknesses of the materials translated to radius. This translation is done by thin wire approximation which is the closest model for defining plates with almost perfect conduction.

49

Material Library created in AMDSpro M1 (First level thin metal line) M2 (Second level thin metal line) M3 (Third level thin metal line) E1 (second to last metal layer) MQ (First level of Thick wiring FT (via connecting LY level to E1) LY (third to last metal level before E1) VL (via connecting M2, M3, M4 to MQ) V1 (square shape via for connecting M1 to M2) V2 (square shape via for connecting M2 to M3) SiO2_UnderLY Silicon substrate

Conductivity PC PC PC PC PC PC PC PC 7.3514e+06 S/m 7.3514e+06 S/m 0 S/m 66.7 S/m

Relatve Permiability Radius(um) NA 0.16 NA 0.18 NA 0.18 NA 1.5 NA 0.3 NA 2 NA 0.23 NA 0.33 1 0.18 1 0.18 4.1 2.92 11.9 N/A

Table 4.3: Material library created for AMDSpro

Another important part of fabrication compatibility is adding the cross under within the design constraint for underpass. The cross under or underpass is the conductive trace which crosses from the inner most pin of the spiral to the outside of the spiral and the spiral traces giving access to the inner loop pin shown in Figure 4.5. As noted earlier the spirals are imported from ADS as in Figure 4.4 and thus their underpass is added in AMDSpro. This requires careful attention of the fabrication rules governing underpass in ADS. The clear demonstration in Figure 4.5 shows that the z axis value is carefully chosen to mimic that. Moreover, the appropriate VIA from the imported library is used to mimic the connection between the two metal layers.

50

Figure 4.5: PSC underpass compatibility in AMDSpro

4.3.2 Biomedical Compatibility
The environmental constraints of the power bio-telemetry device, most importantly enforced in the initial design, is the external and implantable PSC relative distance. This distance is approximated to be 10 millimeter. The author of [14] elaborates on the different thicknesses and the electric properties of human skull. The most important element to investigate is the human skull breakdown.

51

Figure 4.6: human skull layers [22] In Figure 4.6 different layers of human skull is demonstrated. These layers are of paramount importance in terms of thickness and relative permeability for correct modeling in AMDSpro tool. Fortunately many pre existing biomedical material in AMDSpro will help in the permeability values; however, before achieving a correct model the thickness of each part should be realistically identified. A simple cross comparison between the layers defined in [24] and Figure 4.6 shows that the Outer Compact Layer is known as Periosteum. The next layer from the skin is referred to as Spongiosum or Bone of Skull. Finally the third layer is identified by Dura Mater or simply the Inner Compact Layer. The similarity between the external and internal layer name is not a coincident. Their electromagnetic properties are simply identical, although their thicknesses, as shown in Figure 4.6, are not. In an ideal case the implanted spiral will be located somewhere underneath the Inner Compact Layer. It should also be noted that the thickness of the human skull or each of the introduced layers, varies from one patient to another similar to any

52

other part of the human bone structure variation. Nevertheless, the variation of the human skull different layer's thickness and its corresponding electromagnetic properties are shown in Table 4.4.
Conductivity  Skull Layer Outer Compact Layer (Periosteum) 0.0399381 S/m Spongiform (Bone of skull) 0.0592176 S/m Inner Compact Layer (Dura Mater) 0.0399381 S/m

Relative Permeability 54.0041 114.316 54.0041

Thickness (mm) 2.2-2.4 3.8-5.1 1.7-4.3

Table 4.4: Human skull electromagnetic and physical properties Another environmental enforced parameter in design in AMDSpro surrounding temperature which is chosen to be about 28-32 degrees. Other settings such as input signal characteristics are further looked into in Chapter 5. The human skull layers in Table 4.4 are modeled as three layers sitting on top of one another in AMDSpro. The example of this model is shown in Figure 4.7. As mentioned before these layers represent the permeability of the human skull and their thicknesses vary from one person to another. Along with the realistic modeling of PSC for seizure application brain implantable power delivery requires to transmit power through different layers of human skull.

53

Figure 4.7: substrate and human skull layers modeling Figure 4.7 shows the substrate and human skull layers in four steps. The Figure 4.7a located in the top right hand side shows the separated implanted and external coil. The implanted coil is located on the top with smaller size relative to the external coil. Figure 4.7b, located on the top right hand side has incorporated the silicon substrates for external and implanted coil according to Table 4.3 imported substrate from ADS tools. The SiO2_UnderLY is already included in between the spiral strips and substrate. The bottom left representation of system, Figure 4.7c, has included two inner and outer Compact Layer picked up from Table 4.4 which are shown in blue. The final stage is to incorporate the Bone of skull or Spongiform layer demonstrated in Figure 4.7d. Having created a fabrication and biomedical compatible design, the simulation can proceeded. However, important simulation option will give rise to correct and reliable analysis of the results.
54

Section 5.2 clarifies on the simulation details and constraints. Although MATLAB calculation is the measuring factor in physical parameter of the PSC model, the design may require some fine tuning to improve upon its overall efficiency and performance which is briefly introduced in the next Section.

4.3.3 Fine Tuning
Figure 4.7 shows few techniques can improve the overall performance of the PSC; to name a few, the distance of the underpass from the main PSC body can be increased. Increasing this distance, as long as it is within the fabrication constrain, reduces the capacitance C p . It should be noted that the change of parallel capacitance of the external coil should be mimicked for the implanted PSC to avoid resonance frequency changed in the design. Another important fine tuning technique is stacking up layers of different metals, created in the library from ADS tools, for the spiral which will reduce the effective resistance of the implanted and external PSC. As mentioned earlier in this thesis, operating at link resonant frequency is the most optimum choice since the capacitance and inductance impedance of both coils cancels each other out. In MATLAB this operating frequency was calculated based on f cal 
1 1 . In  2 L1Ceq1 2 L2Ceq 2

order to ensure that the system is operating at a true resonant frequency in AMDSpro, operating frequency of the model is swept between f cal   and f cal   to catch the higher efficiency among that range based on calculation discrepancies in the capacitance and self inductances resulting in f cal . The symbol  represents the range which is chosen to be in the kHz values. The frequency sweep f cal is another form of fine tuning the design to achieve higher efficiency values in AMDSpro tool. The mentioned techniques have been implemented periodically and the design
55

has been reassessed to ensure highest possible system efficiency with the introduced realistic model.

4.4 Summary
In summary, this Chapter elaborated on the proposed MATLAB program to identify the optimum geometries of PSC based on the predefined constraints and focused on implementing a realistic design in AMDSpro tool, the second contribution of this thesis. The program developed in MATLAB can be used as an independent tool for calculating square shaped spiral coil geometry for biomedical application. Whether the PSC is fabricated for power transmission or signal analysis purposes, the program is re-adjustable by changing the initialization. The author of [28] has also introduced a MATLAB program which aims for the optimum spiral geometries. The advantage of the proposed algorithm in this thesis shown in Figure 4.8 (b) over Figure 4.8 (a) proposed by [28] is the geometry optimization methodology. The proposed flowchart by [28] optimizes the fill factor  and the line width w of the external and implanted coil back and forth but effect of coupling coefficient k on the primary and secondary coil is missing in the algorithm. In the proposed algorithm in this thesis in Figure 4.8 (b) all combination of the primary and secondary coils are coupled together.

56

Figure 4.8: (a) proposed iterative PSC design flow chart by [28] (b) proposed iterative design flow chart In Figure 4.8 (a) the stopping factor for the iteration is achieving efficiency improvement of less than 0.1% compared to the previous iteration. Since the equations used to evaluate the optimum values are not related linearly there may be places in the iterative loop where efficiency improvement intervals will become smaller than 0.1%; however, that may change if the starting point is set at a different location or if the iteration was to be continued. Furthermore, the program may enter an infinite loop or take many hours to complete. In order to address these problems the proposed algorithm in Figure 4.8 (b) takes into account all the possible geometry parameters and stores and evaluates them as long as they are within the defined constraints. This

57

approach is well manageable and the interval between the geometries can be adjusted avoiding potential program halt. Chapter 4 focused on implementing a realistic design. A realistic model was presented based on biomedical and fabrication compatibility. This model was finally fine tuned to achieve higher performance. To clearly emphasize on the realistic aspect of this model three features can be re stated here. Most importantly the human skull was modeled based on findings of human anatomy which simply shown in Figure 4.6. Secondly body temperature was embedded into simulation characteristics. Finally fabrication elements were a major factor to assure that the model created can perform as simulated if fabricated. All in all, the model is uniquely tailored for brain implantable power transmission using PSC. As compared earlier in the Chapter 2 the recent findings have focused merely on the electrical aspect of designing PSC and optimization was done in non-realistic environment.

58

Chapter 5 Results and Discussion

The results of PSC divided into two separate Sections. The coil optimized sizing and physical parameters were indentified using MATLAB. The program structure was earlier discussed in Section 4.2. Section 5.1 focuses on the simulation results of the program and the analysis and interpretation of it; in Section 5.2 the results from AMDSpro tool is evaluated. These two analyses serve as this thesis contributions and justifications of the methodology.

5.1 Results and Analysis in MATLAB
Three sets of data were simulated in MATLAB. The first set of data was limiting the outer diameter of the external PSC to d o  30mm and the implanted spiral outer boundary to d o  10mm . The first version of software was designed to sweep different parameters such as number of turns and width of the spiral. The effect of quality factor of external coil Q1 based on the sweeping parameters is illustrated in Figure 5.1. PSC quality factor is an important element in affecting the overall efficiency of the system based on Eq. (27) in Section 3.3.

Figure 5.1: Data sweep of external coil versus quality factor
59

Figure 5.1 shows the overall pattern of quality factor compared to the changes of turns and width of the external coil. Although the quality factor seems to be all over the place in terms of values received, a general decreasing pattern is identified in Figure 5.1 where the number of iteration is at its maximum. The number of turns of the spiral n is increasing on a steady form where the width of the spiral is varying at each turn. The observation from this graph is that the most important or affecting element in the overall performance of the spiral is the number of turns in a predetermined area. Obviously the maximum quality factor was found in the iteration process when the spiral width was at its maximum. Figure 5.1 shows the individual relation between quality factor, number of turns and width of the spiral within the defined constraints. Another interesting element that could be compared to external quality factor is the resonant frequency of the coil. This comparison is collected and shown in Figure 5.2 and the data for both the quality factor of external coil and the operating resonant frequency is normalized to 1.

Figure 5.2: Data sweep of quality factor and operating frequency Figure 5.2 indicates inversely proportional relation between the coil's quality factor and operating frequency. This is simply justifiable since the frequency of operation is calculated

60

based on the coil's self inductance L1 and equivalent capacitance Ceq1 . Accordingly the coil's inductance and capacitance is proportional to coil's physical parameters which are the same for quality factor for most part. Most important observation of Figure 5.2 is that the resonant frequency of the spiral coil is proportional for most part to quality factor when the numbers of turns are kept relatively low. Figure 5.3 shows this observation better when the external coil turns are limited to n1  2,3 .

Figure 5.3: Data sweep of quality factor and operating frequency for n=2,3 The sweep of parameters was also performed for the implanted spiral coil. With the smaller outer diameter the same pattern between the parameters are expected. This time to get a better sense of parameters relation with internal quality factor all of the elements in the Figure 5.4 are normalized to one. It should also be noted that the quality factor of the implanted coil Q2 depends on the load capacitance C 2 shown in Figure 3.5. A close look at Figure 5.4 reveals some more information in regards to relation between the coil turns, and width with the quality factor of implanted coil. For number of turns 2  n2  4 the high values of quality factor peaks are noticeable with the high to moderate qualified spiral trace width. However, once the number of turns exceeds four the
61

quality factor of the implanted PSC is diminished substantially due to much smaller spiral width. Therefore, an overall examination of the implanted and external coil parameter sweep can result in an estimated understanding that better overall quality factor of the coupled coil can be achieved if the number of turns of both implanted and external coil is limited to 2  n2  4 . On the other hand, within the turn limitation the larger the width the higher the quality factor can be achieved.

Figure 5.4: Normalized data sweep of implanted coil parameters and quality factor In order to complete the study for the total system efficiency according to Eq. (27) one more important element should be considered in sweeping the parameters. The quality factor of the spiral which is highly dependent on the physical parameters of both coils is another deciding factor in the calculations. The algorithm which calculates the coupling coefficient k of the system is written to measure the coefficient for all the combination of the parameter set. Hence, demonstrating the changes of the coupling coefficient along with the number of turns is a complicated task. Nevertheless, the overall coupling coefficient parameter was plotted in MATLAB and is demonstrated in Figure 5.5 (a).

62

Figure 5.5: a) coupling coefficient k sweep b) external coil innermost radii ai iteration Both Figure 5.5 (a) and (b) have identical iteration sequences. Therefore, iteration sequence itself is not important here which depends on how the parameters are swept in the MATLAB program. The important observation is the relation between the coupling coefficient and inner radii of the
63

spiral shown in Figure 5.5 (a) and (b). In order to make sense of Figure 5.5 (a) coupling coefficient change pattern, a second examination of the proposed code is beneficial. Section 4.2.7 shows the overall algorithm. The valid parameter to be compared is the radius of the spiral which based on Eq. (35) is related to outer diameter, width and the spiral gapping. To better interpret Figure 5.5 (a) the most inner radii of the external coil is plotted with respect to the same iteration indices as the coupling coefficient. Figure 5.5 (b) shows that the inner radii of the external coil increase as the number of iteration increases. The examination of Figure 5.5 (a) and (b) indicates that the higher the fill factor  the larger the coupling coefficient is between the two spiral. Fill factor  is between zero and one and was defined in Eq. (5) section 3.1. This observation originates from the fact that the number of iteration in Figure 5.5 (b) has somewhat quadratic relation with the innermost radii of the spiral. The innermost radii of the PSC on the other hand can be interpreted as the vacant area inside the spiral, d i1 directly proportional to the spiral's fill factor  .
2

As mentioned before, it is certainly not straight forward to link the number of turns or width of the square shaped spiral to the coupling coefficient since the innermost radii of the spiral depends on more than one element rather than on combination of parameters. Having that in mind, the proposed algorithm and the efficiency expression in Eqs (27) and (28) are used to pinpoint the optimum geometrics considering quality factor, coupling coefficient of various spiral sets, and load resistance values using overall system efficiency as the evaluating equation. Table 5.1 shows the calculated optimum geometries and characteristics of PSC in MATLAB for three sets of geometry limited to outer diameters of d o11  30mm , d o12  24mm and d o13  18mm .

64

The implanted coil set of parameters outer diameters are respectively d o 21  10mm , d o 22  8mm and d o 23  6mm .
Parameters PSC d o (mm) Set 1 Ext1 Imp1 30 7.5 2 0.15 5.55 0.0834 N/A 10 2.3 5 0.15 0.65 0.167 28.6 Set 2 Ext2 Imp2 24 4.9 2 0.15 4.7 0.061 N/A N/A 19.51 1.89 0.65 48.55 8 1.64 3 0.15 0.96 0.0457 120 4.46 4.12 Set 3 Ext3 Imp3 18 3.7 2 0.15 3.5 0.0457 N/A N/A 19.51 2.26 0.69 48.60 6 1.26 3 0.15 0.69 0.0346 89.3 4.23 4.12

 cal (%)

d i (mm) n (turns) s (mm) w (mm) L (µH) C 2 (nF) RL (  ) Q f (MHz) k

N/A 11.91 19.13 3.83 1.48 0.64 48.36

Table 5.1: Optimized PSC Geometrics and Characteristics in MATLAB Table 5.1 shows the optimized geometrics along with the load characteristics of the spiral in each set of parameters. MATLAB calculated efficiency is the loaded efficiency of the system. The calculation design shows that the system's efficiency is maintained on the 48.5% average while the external and implanted coil is reduced to the minimum size of d o13  18mm and d o 23  6mm . Implanted PSC size reduction can facilitate doctors with more options in terms of implanted location and other circuitry where the overall efficiency of the system is not compromised. The results achieved in [28] show 41.2% efficiency for spiral operating at 1 MHz not to mention, the outer diameter of the external spiral is as large as 69mm. The implanted coil outer diameter is 20mm which exceeds our largest implanted coil size. The efficiency of 85.8% is also introduced for higher frequency of operation; however, the design is not realistically introduced based on
65

the biomedical constraints. The PSC is simulated in air which is substantially different environment that the one that biotelemetry devices would be operating in.

5.2 Results and Analysis in AMDSpro
The spirals external and internal PSC are designed as elaborated earlier in Section 4.3. The most important element of concern before simulating the design is tuning the proper simulation parameters to assure accurate results with respect to the calculation settings. The AMDSpro design requires pin allocation for each port of the design. The example in Figure 4.5 shows the implanted PSC pins. The input signal pins are called Feed and Feed1 which mimic the input signal of the external coil. Each input pin is modeled as an RLC circuit in the AMDSpro tool. The source resistance as indicated in Figure 3.5 is estimated as RS  50 . On the other hand, the load capacitance and resistance values are used from Table 5.1. These values are inserted into the pins associated with the implanted coil in the parallel RLC format. Therefore, the simulation of the system is a loaded simulation. Many iteration of the AMDSpro has been examined using the fine tuning techniques explained in Section 4.3.3. The main objective was to find the best result by varying frequency, load capacitance and resistance. Among three sets of parameters only the smallest, Set3, from Table 5.1 was chosen since this set of parameter supports our final contribution of design which is minimizing the realistic PSC design while maintaining efficiency. The simulation was performed in AMDSpro tool for different frequencies between 1.5 to 3 MHz. The input pin voltage source of the external spiral is shown in Figure 5.6.

66

Figure 5.6: Input voltage of external coil The amplitude can be estimated as Vin _ amp  1.26 volts where input voltage oscillates between
 0.63  V  0.63 . Accordingly the output pin voltage signal is of interest with respect to the

external voltage. The output voltage simulation result is shown in Figure 5.7. The oscillation is a sinusoidal with minor amplitude variation which is expected to stabilize. The output voltage amplitude can be estimated as Vout _ amp  0.65 V. This value is little over half of the input voltage which is a promising result if the output current holds up with respect to the input current. The AMDSpro demonstrates the instantaneous power for both input and output of the system. Therefore, comparing the instantaneous power is sufficient for identifying the simulated efficiency.

67

Figure 5.7: Output voltage of implanted coil The instantaneous power delivery of input signal represents both the voltage and current characteristics and is a reliable point of reference for efficiency calculation.

Figure 5.8: Instantaneous Input Power of external coil

The input instantaneous power shown in Figure 5.8 has the amplitude of Pinput_ amp  30mw , in other words the peak to peak value of the power. This power can be averaged over a longer
68

period but it is evident that the input power is a stable sinusoidal signal. The output pin or the load pin from the implantable coil power signal is shown in Figure 5.9.

Figure 5.9: Instantaneous Load power of implanted coil

The amplitude of the load power signal will also stabilize if the simulation is viewed for longer period. The load power amplitude is estimated to be Poutput_ amp  14mw . Therefore, having the input and output power amplitude, the efficiency of the simulated system can be estimated as follows:
Poutput_ amp Pinput_ amp

 sim 

,

(36)

 sim  46.67%
The simulation efficiency shown in Eq. (36) is very much close to the calculated value by MATLAB which confirms that the program approach introduced in MATLAB works effectively to introduce optimized geometries and parameters for seizure application power transmission
69

coils. The MATLAB efficiency algorithm certainly is not a replacement for the AMDSpro tool since this tool usually uses much more complicated equations in comparison to the MATLAB's simulation. The objective of using MATLAB is to narrow down the geometries of the PSC and use the field solver such as AMDSpro to pin point the optimum design by using the fine tuning technique extrapolated in Section 4.3.3. To summarize the findings of the simulation and calculations for the Set3 geometries in Table
5.1 a separate table is created below which represents the final characteristics of the PSC after

fine tuning and simulation.
Parameters PSC d o (mm) Set 3 Ext3 18 3.7 2 0.15 3.5 0.0457 N/A N/A 19.51 2.52 0.69 48.60 46.67 Imp3 6 1.26 3 0.15 0.69 0.0346 95 4.5 4.12

d i (mm) n (turns) s (mm) w (mm) L (µH) C 2 (nF) RL (  ) Q f sim (MHz)

 cal (%)  sim (%)

k

Table 5.2: Optimized PSC Geometrics and Characteristics Table 5.2 summarized the values achieved for the smallest implantable device. The first section of the analysis was focused on making sense of the results achieved by MATLAB calculation and to verify with the fundamental theories; to achieve the design parameters and characteristics
70

shown in Table 5.1. The second section of the chapter focused on AMDSpro simulation results. The key final objective of thesis was to improve the efficiency versus size of the inductive link based on the system's constraints. Table 5.2 shows the simulated efficiency along with other geometric parameters and characteristics.

5.3 Discussion

According to Table 5.2 the calculated efficiency and simulated efficiency values are not only comparable but more importantly maintained while reducing the outer diameter of PSCs. The efficiency value stated in [28] cannot be the true comparable environment since the simulation is done in air and many losses are not counted for. Nevertheless, in the 1-2.5 MHz range frequency of operation our simulation shows improvement by %5 while our coil size is reduced substantially. Moreover, the implanted coil simulated here has smaller outer diameter compared to its counterparts. The author of [30] demonstrates the quality factor versus frequency and identifies high quality factor values. However, the quality factor of the spiral cannot be considered as a standalone element affecting the efficiency. In this thesis coupling coefficient was considered to be an important element in the design overall efficiency. The designed program takes that factor into account for all the iterations. To further emphasize on this in the earlier stage of the program high quality factors were achieved as a result of different iterations but the quality factor was smaller and did not measure up for the overall efficiency equation. The author of [10] uses litz wire to construct the bio-implantable coils and calculates the total efficiency of the system of
71

19.3 %. Our achieved efficiency was 46.67 %. The human skin or tissue was not modeled in this paper and the final efficiency is less than half the value calculated in our calculated and simulated results. Finally the author of [11] is introducing an interesting closed loop system which has two major weaknesses. The litz wire coil construction makes it very dependable on process variation and the high input amplitude of 16 volts may harm human anatomy especially for brain implants.

72

Chapter 6 Conclusion

6.1 Overview
This thesis proposes design methodology of power transmission device using PSC for brain implant in seizure application. The application provides constant source of power for implanted devices with high efficiency. The most practical form of power delivery, among the different form of coils that is used in power transmission PSC, is using coupled inductive coils which is the most reliable and less process dependent. Therefore, the modeling and optimization of the PSC is more practical than any other technology. The square shape, among different sizes and shapes of PSC available for technological advances, is the most easily fabricated shape. The spiral size is very much limited to biological and environmental limitations such as location of the implant.

6.2 Contributions
The proposed PSC has three major features which sets it apart from its counterparts. These features are brought in as the contribution of this thesis. The first contribution of this research is instituting realistic equivalent circuit model which was established in Chapter 3. The circuit proposed considers both the substrate and the spiral trace losses in the same circuit while adding coating capacitance losses for implanted and external coils. The second contribution was to set up a program in MATLAB which extracts optimum PSC geometric parameters and calculates system efficiency based on system's constraints. This program was well introduced in Section
73

4.2. As mentioned before the algorithm can be used to evaluate any bio-implantable PSC optimized geometry if the initializations are adjusted to fit the specific design limitations. The final contribution of this paper is size per efficiency improvement of the introduced realistic PSC design. The importance of the spiral sizing cannot be overlooked. Size reduction of any electrical device is an important improvement in the system as long as the trade off, in this case the efficiency, is not substantial. The human body is not designed to make space for external devices especially when it comes to brain. The space is very limited in which all the electronic devices can fit. Taking advantage of the smaller PSC helps reduce the chances of any complication after implanting PSC. With this mentality the MATLAB program was initially introduced where the outer diameter of implanted PSC was reduced to d o 2  6mm shown in
Table 5.2.

The MATLAB simulation was performed to find the highest efficiency parameter sets to be used in the AMDSpro tool. The realistic model was then simulated with specific fine tuning technique to achieve the highest efficiency of the simulating results in AMDSpro. Therefore, the key values achieved in Section 5.2 are  sim  46.67% which is close to the calculated efficiency by MATLAB cal  48.60% . This proximity verifies the validity of the proper calculation and accurate modeling of the system. The average efficiency of the system can be estimated to be

ave  47.64% . The average value achieved is the loaded efficiency of the system. The loaded
efficiency is calculated with the consideration of the load resistance R L . The concept of efficiency versus size is compared with other designs. The authors [28], [11] and [10] have proposed compelling arguments and satisfying designs. However, in terms of efficiency versus size this thesis stands out as shown in
74

Table 6.1.

Proposed By [28] [11] [10] Thesis

d o 2 ( mm)
20 16 10 6

f (MHz)
1 1 6.78 2.52

 (%)
41.20% 85% 20% 46.67%

Medium Air Air Air human skull

D (mm) 10 7 15 10

Technology PSC Litz Wire PSC PSC

Table 6.1: Result Comparison It should be noted that this comparison is not a simple linear contrast since there are biomedical characteristics such as tissue and skull permeability and environmental temperature commonly missing in most recent studies. The Litz Wire technology as mentioned before used by [11] is a process dependent technology. The achieved unloaded efficiency indicated in Table 6.1 is comparable to the loaded efficiency achieved in our design. The closest design to our power transmission system is reflected in [28]. The improvement against this design is increasing the overall loaded efficiency of the system by 6% for frequency operation of 1-2.5 MHz and reducing the sizing from 20 mm simulated in [28] to 6 mm used here for implanted coil outer diameter. It should be noted that the design introduced in [28] is considering the coils separation distance is filled with air rather than any tissue which is the actual case. It appears that the recent papers have less attention to the biomedical influence of different medium on the performance of the PSC. It is important to see that our proposed design is tailored for the purpose of the brain implantable device. Although using the program developed the design can be readjusted for other bio-implantable applications as well.

75

6.3 Future Work

As the design of Inductive Power Transmission through Printed Spiral Coils for Seizure Application is completed few areas of work is yet to be looked into for future endeavors. This design is ready to be fabricated and tested on a sample human skull. The result of the test can then be set for further investigation to improve the program by using more advanced algorithm such as genetic algorithm. Moreover, other shapes of spiral toward the circular shape can be designed and implemented. Since future fabrications may easily support these shapes, their optimization may give slightly better efficiency result. The power transmission for seizure monitoring is a crucial component toward power transfer for other implanted devices used in seizure monitoring such as Voltage regulators, VCO, PLL and sensors. In future works those components need be designed accordingly to give the system an overall functionality. The power delivery is transmitted in midrange frequency which is mostly allocated for biomedical applications. Nevertheless, other electronics may couple noise into the implant increasing the losses; therefore, a thorough noise analysis is useful to insure clean power delivery to implanted devices.

76

References
[1] Ahmadi, M.M.; Jullien, G.; , "A full CMOS voltage regulating circuit for bioimplantable applications," 48th Midwest Symposium on Circuits and Systems, 2005., pp.988-991 vol. 2, 7-10 Aug. 2005. [2] Akyel, C.; Babic, S.; Kincic, S.; , "New and fast procedures for calculating the mutual inductance of coaxial circular coils (circular coil-disk coil)," IEEE Transactions on Magnetics, vol.38, no.5, pp. 23672369, Sep 2002. [3] Bahl, I.J.; Garg, R.; , "Simple and accurate formulas for a microstrip with finite strip thickness," Proceedings of the IEEE , vol.65, no.11, pp. 1611- 1612, Nov. 1977. [4] Baker, M.W.; Sarpeshkar, R.; , "Feedback Analysis and Design of RF Power Links for Low-Power Bionic Systems," IEEE Transactions on Biomedical Circuits and Systems, vol.1, no.1, pp.28-38, March 2007. [5] Chen-Ming Hsu; Chien-Ming Lee; Tzong-Chee Yo; Ching Hsing Luo; , "The low power MICS band biotelemetry architecture and its LNA design for implantable applications," Solid-State Circuits Conference, 2006. ASSCC 2006. IEEE Asian , pp.435-438, 13-15 Nov. 2006. [6] Chen-Ming Hsu; Ho-Yin Lee; Ching-Hsing Luo; , "The Implementation of Biotelemetry Chip by Analog Modulation Technique," Life Science Systems and Applications Workshop, 2006. IEEE/NLM , pp.1-2, July 2006. [7] Dupire, T.; Tanguay, L.F.; Sawan, M.; , "Low power CMOS transmitter for biomedical sensing devices," 13th IEEE International Conference on Electronics, Circuits and Systems, 2006. ICECS '06., pp.339-342, 10-13 Dec. 2006. [8] Ferreira, J.A.; , "Improved analytical modeling of conductive losses in magnetic components," IEEE Transactions on Power Electronics, vol.9, no.1, pp.127-131, Jan 1994. [9] Friedman, G.; Mayergoyz, I. D.; , "On the estimate of eddy current losses in current carrying conductors," Journal of Applied Physics , vol.87, no.9, pp.6926-6928, May 2000. [10] Harrison, R.R.; , "Designing Efficient Inductive Power Links for Implantable Devices," IEEE International Symposium on Circuits and Systems, 2007. ISCAS 2007, pp.2080-2083, 27-30 May 2007. [11] Kendir, G.A.; Wentai Liu; Guoxing Wang; Sivaprakasam, M.; Bashirullah, R.; Humayun, M.S.; Weiland, J.D.; , "An optimal design methodology for inductive power link with class-E amplifier," IEEE Transactions on Circuits and Systems I: Regular Papers, vol.52, no.5, pp. 857- 866, May 2005. [12] Kuhn, W.B.; Ibrahim, N.M.; , "Analysis of current crowding effects in multiturn spiral inductors ," IEEE Transactions on Microwave Theory and Techniques, vol.49, no.1, pp.31-38, Jan 2001. [13] Lee, T.H.; , "The design of CMOS radio-frequency integrated circuits, 2nd edition," Communications Engineer , vol.2, no.4, pp. 136- 163, Aug.-Sept. 2004. [14] M. akhtari, H.C Bryant, A.N. Mamelak, L. Heller, J.J Shih, M. Mandelkern, A. Matlachov, D.M. Ranken, E.D. Best, W.W. Sutherling, "Conductivities of Three-Layer Human Skull" Brain Topography 13 (1), pp. 29-42, Nov 2000. 77

[15] Mohan, S.S.; del Mar Hershenson, M.; Boyd, S.P.; Lee, T.H.; , "Simple accurate expressions for planar spiral inductances," IEEE Journal of Solid-State Circuits, vol.34, no.10, pp.1419-1424, Oct 1999. [16] M. S. Humayun, J. D. Weiland, G. Y. Fujii, R. Greenberg, R. Williamson, J. Little, B. Mech, V. Cimmarsti, G. V. Boemel., G. Dagnelie, and E. de Juan, Jr., "Visual perception in a blind subject with a chronic microelectronic retinal prosthesis," Vis. Res., vol. 43, pp. 2573-2581, Sept 2002. [17] Najafi, K.; , "Packaging of Implantable Microsystems," Sensors, 2007 IEEE , pp.58-63, 28-31 Oct. 2007. [18] Pieters, P.; Vaesen, K.; Brebels, S.; Mahmoud, S.F.; De Raedt, W.; Beyne, E.; Mertens, R.P.; , "Accurate modeling of high-Q spiral inductors in thin-film multilayer technology for wireless telecommunication applications," IEEE Transactions on Microwave Theory and Techniques, vol.49, no.4, pp.589-599, Apr 2001. [19] Poon, A.S.Y.; O'Driscoll, S.; Meng, T.H.; , "Optimal Operating Frequency in Wireless Power Transmission for Implantable Devices," Engineering in Medicine and Biology Society, 2007. EMBS 2007. 29th Annual International Conference of the IEEE , pp.5673-5678, 22-26 Aug. 2007. [20] Qiuting Huang; Oberle, M.; , "A 0.5-mW passive telemetry IC for biomedical applications," IEEE Journal of Solid-State Circuits, vol.33, no.7, pp.937-946, Jul 1998. [21] R.K Ulrich and L. W. Schaper, Integrated Passive Component Technology. Hoboken, NJ: Wiley, 2003, ch. 11. [22] S. David. Essentials of Human Anatomy and Physiology. Boston : McGraw-Hill, c2003. [23] S. Gabriel, R W. Lau, and C. Gabriel, "The dielectric properties of biological tissues: II. Measurements in the frequency range 10 Hz to 20 GHz," Phys. Med. Biol., vol. 41, pp. 2251-2269, Nov. 1996. [24] Shah, M.R.; Phillips, R.P.; Normann, R.A.; , "A study of printed spiral coils for neuroprosthetic transcranial telemetry applications," IEEE Transactions on Biomedical Engineering, , vol.45, no.7, pp.867-876, July 1998. [25] Soma, Mani; Galbraith, Douglas C.; White, Robert L.; , "Radio-Frequency Coils in Implantable Devices: Misalignment Analysis and Design Procedure," IEEE Transactions on Biomedical Engineering, vol.BME-34, no.4, pp.276-282, April 1987. [26] Stieglitz, T.; Schuetter, M.; Koch, K.P.; , "Implantable biomedical microsystems for neural prostheses," Engineering in Medicine and Biology Magazine, IEEE , vol.24, no.5, pp. 58- 65, Sept.-Oct. 2005. [27] Tourkhani, F.; Viarouge, P.; , "Accurate analytical model of winding losses in round Litz wire windings," IEEE Transactions on Magnetics, , vol.37, no.1, pp.538-543, Jan 2001. [28] Uei-Ming Jow; Ghovanloo, M.; , "Design and Optimization of Printed Spiral Coils for Efficient Transcutaneous Inductive Power Transmission," IEEE Transactions on Biomedical Circuits and Systems, vol.1, no.3, pp.193-202, Sept. 2007.

78

[29] Yue, C.P.; Wong, S.S.; , "Physical modeling of spiral inductors on silicon," IEEE Transactions on Electron Devices, vol.47, no.3, pp.560-568, Mar 2000. [30] Zhi Yang; Wentai Liu; Basham, E.; , "Inductor Modeling in Wireless Links for Implantable Electronics," IEEE Transactions on Magnetics, vol.43, no.10, pp.3851-3860, Oct. 2007. [31] Zierhofer, C.M.; Hochmair, E.S.; , "Geometric approach for coupling enhancement of magnetically coupled coils," IEEE Transactions on Biomedical Engineering, vol.43, no.7, pp.708-714, July 1996.

79

Appendix
Mfile_Optimization_Program.txt

80

