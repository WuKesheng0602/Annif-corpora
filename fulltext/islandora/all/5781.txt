DEMAND SIDE MANAGEMENT BY PHEV CHARGING SCHEDULING IN RESIDENTIAL AREAS

by Babak Dayyani Bachelor of Science Degree in Electrical Engineering Sadjad University of Technology, 2012

A Thesis presented to Ryerson University in partial fulfillment of the requirements for the degree of Master of Applied Science in the Program of Electrical and Computer Engineering Toronto, Ontario, Canada

©

Babak Dayyani, 2016

AUTHOR'S DECLARATION

I hereby declare that I am the sole author of this thesis. This is a true copy of the thesis, including any required final revisions, as accepted by my examiners.

I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research.

I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

I understand that my thesis may be made electronically available to the public.

ii

Abstract
Demand Side Management by PHEV Charging Scheduling in Residential Areas
© Babak Dayyani, 2016 Master of Applied Science Electrical and Computer Engineering Ryerson University

During the last decade, Plug-in Hybrid Electric Vehicles (PHEVs) have become a part of modern transportation fleet, offering green alternatives to fossil fuel based transit system. Taking PHEVs great potentials into consideration, this transition can revolutionize transportation systems and push technological advancements further. However, in spite of plentiful economical and environmental advantages, new concerns are being brought up as PHEVs' utilization rate increases. PHEV's driving force is supplied by electricity. Hence, the built-in battery requires charging. Such newly introduced power demand, has raised alarming realizations for utility providers. Impacts of PHEVs on distribution networks, although have been proven to be noticeable, have not been thoroughly investigated for future years. In smart grid, the charging of PHEVs can be controlled to reduce the peak load, known as Demand-Side Management (DSM). In this work, we explore various DSM approaches accompanied by their effects on power consumption patterns. Moreover, Geometric Water-filling (GWF) method has been utilized to increase the accuracy of our proposed scheduling schemes. The main contribution of this work emerges by fusing consumer and utility provider concerns, resulting in our dual-target objective function. Such method allows us to alter the focal point between consumer and utility company satisfaction. Index Terms: Plug-in Hybrid Electric Vehicles, Demand-Side Management, Water-Filling

iii

Acknowledgments

I would first like to thank my thesis advisor Dr. Lian Zhao. The door to Prof. Zhao's office was always open whenever I ran into a trouble spot or had a question about my research or writing. She consistently allowed this research to be my own work, but steered me in the right direction whenever she thought I needed it. I would like to sincerely acknowledge the support from Ontario Centre of Excellence (OCE) of Canada and RigMaster International Inc. under Grant number OCE # 23975. My special thanks go to all the members of the examination committee: Dr. Anpalagan, Dr. Ma, Dr. Raahemifar and Dr. Zhao (in the alphabetical order). I must also express my very profound gratitude to my parents and my sister for providing me with unfailing support and continuous encouragement throughout my years of study and through the process of researching and writing this thesis. This accomplishment would not have been possible without them. Thank you.

Babak Dayyani

iv

Contents
Title Page . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Author's Declaration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Abstract . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Acknowledgments . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . i ii iii iv

List of Tables . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . viii List of Figures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ix

List of Acronyms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xii

1

Introduction 1.1 1.2 1.3 Background and Motivation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Research Contributions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Dissertation Outline . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

1 1 3 4

2

Literature Review 2.1 Centralized Schedulers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . v

5 7

2.2 2.3

Decentralized Schedulers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Hybrid Schedulers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

8 9

3

Theory and System Model 3.1 3.2 3.3

11

Generic Water-Filling Problem . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12 Water-Filling and Demand-Side Management . . . . . . . . . . . . . . . . . . . . 13 Geometric Water-Filling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 17

4

Load Scheduler Algorithms 4.1 4.2 4.3 4.4

21

Dynamic Battery Charging Model . . . . . . . . . . . . . . . . . . . . . . . . . . 21 Single PHEV Load Allocation . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22 Multiple PHEV Load Allocation . . . . . . . . . . . . . . . . . . . . . . . . . . . 25 Modified PHEV Load Allocation Algorithms . . . . . . . . . . . . . . . . . . . . 30 4.4.1 4.4.2 Modified Single PHEV Load Allocation . . . . . . . . . . . . . . . . . . . 31 Modified Multiple PHEV Load Allocation . . . . . . . . . . . . . . . . . 33

4.5

Dual-Target PHEV Load Allocation Algorithm . . . . . . . . . . . . . . . . . . . 37 4.5.1 4.5.2 Dual-Target Single PHEV Load Allocation . . . . . . . . . . . . . . . . . 38 Dual-Target Multiple PHEV Load Allocation . . . . . . . . . . . . . . . . 40

5

Simulation Results and Numerical Analysis

43

vi

5.1

Realistic Datasets . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43 5.1.1 5.1.2 Realistic PHEV Information . . . . . . . . . . . . . . . . . . . . . . . . . 44 Realistic Hard Load Data-Set . . . . . . . . . . . . . . . . . . . . . . . . 44

5.2 5.3

Simulation Results for Single PHEV Load Allocation Algorithms . . . . . . . . . 46 Simulation Results for Multiple PHEV Load Allocation Algorithms . . . . . . . . 53

6

Conclusion 6.1 6.2

76

Main Contributions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77 Future Works . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79

Appendix

80

A Dual-Target Objective Function Solution

80

Bibliography

83

vii

List of Tables
4.1 Power Allocation Algorithms and their respective properties . . . . . . . . . . . . 37

5.1 5.2 5.3 5.4 5.5 5.6

Battery information . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 44 Mean-Square Error values for Single-PHEV schedulers . . . . . . . . . . . . . . . 50 Numerical results of DTSLA algorithm while varying  . . . . . . . . . . . . . . . 51 PHEV information . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56 Mean-Square Error values for multi-PHEV schedulers . . . . . . . . . . . . . . . 62 Numerical results of DTMLA algorithm while varying  . . . . . . . . . . . . . . 65

viii

List of Figures
2.1 Overnight valley in power consumption in Ontario [1] . . . . . . . . . . . . . . . . 6

3.1 3.2 3.3 3.4

Classical water-filling power allocation . . . . . . . . . . . . . . . . . . . . . . . . 13 Illustration of the proposed Geometric Water-Filling algorithm . . . . . . . . . . . 18 Illustration of P2 (k ) (shaded area) when k = 2 . . . . . . . . . . . . . . . . . . . . 19 Power allocation using Geometric Water-Filling when k  = 3 . . . . . . . . . . . . 20

4.1

A section of distribution grid consistent of High Voltage Transformer, Low Voltage Transformer, and households [2] . . . . . . . . . . . . . . . . . . . . . . . . . . . 26

4.2 4.3

3-D Illustration of Multiple PHEV case . . . . . . . . . . . . . . . . . . . . . . . 28 Varying weight values according to different  ratios . . . . . . . . . . . . . . . . 42

5.1 5.2 5.3 5.4

Real non-PHEV power consumption of a household

. . . . . . . . . . . . . . . . 45

Smoothened and time-shifted non-PHEV power consumption of a household . . . 45 7 Months of non-PHEV power consumption sample . . . . . . . . . . . . . . . . . 45 Results of power allocation for a single PHEV without using SLA . . . . . . . . . 47 ix

5.5 5.6 5.7 5.8 5.9

Results of power allocation for a single PHEV using SLA . . . . . . . . . . . . . . 48 Results of power allocation for a single PHEV using mSLA . . . . . . . . . . . . . 49 Post-DTSLA Scheduler M SEP HEV , M SEHOU SE and g values while varying  . . 52 Results of power allocation for a single PHEV utilizing DTSLA when  = 0.5 . . . 53 Results of power allocation for a single PHEV utilizing DTSLA when  = 1 . . . . 54

5.10 Results of power allocation for a single PHEV utilizing DTSLA when  = 1.5 . . . 55 5.11 Results of power allocation for multiple PHEVs under uncoordinated charging . . . 57 5.12 Results of power allocation for multiple PHEVs using MLA . . . . . . . . . . . . 58 5.13 Results of power allocation for multiple PHEVs using pmMLA1 . . . . . . . . . . 59 5.14 Results of power allocation for multiple PHEVs using pmMLA2 . . . . . . . . . . 60 5.15 Results of power allocation for multiple PHEVs using mMLA . . . . . . . . . . . 61 5.16 Post-DTMLA Scheduler Mean Square Error and Objective Function values against varying  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63 5.17 Results of power allocation for multiple PHEVs utilizing DTMLA when  = 0.5 . 66 5.18 Results of power allocation for multiple PHEVs utilizing DTMLA when  = 0.7 . 67 5.19 Results of power allocation for multiple PHEVs utilizing DTMLA when  = 1 . . 68 5.20 Results of power allocation for multiple PHEVs utilizing DTMLA when  = 1.5 . 69 5.21 Results of power allocation for multiple PHEVs utilizing DTMLA when  = 1.7 . 70 5.22 Results of power allocation for multiple PHEVs utilizing DTMLA when  = 2 . . 71

x

5.23 Results of power allocation for multiple PHEVs utilizing DTMLA when  = 2.5 . 72 5.24 Results of power allocation for multiple PHEVs utilizing DTMLA when  = 3 . . 73 5.25 Results of power allocation for multiple PHEVs utilizing DTMLA when  = 3.5 . 74 5.26 Results of power allocation for multiple PHEVs utilizing DTMLA when  = 4 . . 75

xi

List of Acronyms
BMS CEV CWF DSM DTMLA DTSLA GWF GWFPP KKT LVT MAS MLA MSE PHEV RRA SLA SNR SOC V2G WF mMLA mSLA pmMLA Battery Management System Combustion Engine Vehicles Conventional Water Filling Demand Side Management Dual-Target Multi-PHEV Load Allocation Dual-Target Single-PHEV Load Allocation Geometric Water Filling Geometric Water Filling with Peak Power constraint Karush-Kuhn-Tucker Low Voltage Transformer Multi Agent System Multi-PHEV Load Allocation Mean Square Error Plug-in Hybrid Electric Vehicle Radio Recourse Allocation Single-PHEV Load Allocation Signal-to-Noise Ratio State Of Charge Vehicle to Grid Water Filling Modified Multi-PHEV Load Allocation Modified Single-PHEV Load Allocation pre-Modified Multi-PHEV Load Allocation

xii

Chapter 1 Introduction
In this chapter, we plan to introduce the new advancements in vehicular technology and the fusion of electrical energy in this area. We further aim to discuss the main issues regarding electrical vehicles and their place in electrical distribution grid, and also their potential impact on everyday life in this modern era.

1.1

Background and Motivation

Combustion engine vehicles (CEVs) are responsible for a large portion of greenhouse gas emissions, 12.3% in the year 2009 [3]. Thus, electrification of the vehicle fleet could offer a great potential to reduce both greenhouse gas emissions and the daily transportation cost. Plug-in hybrid electric vehicles (PHEVs) are a reliable alternative for the conventional combustion engine vehicles. PHEVs utilize conventional combustion engine coupled with an electrical engine to minimize the fossil fuel consumption [2]. PHEV's electrical engine driving force is supplied by a battery. This battery is mainly charged when plugged into a charger. Such chargers are usually located at consumers' residence or public 1

charging stations. The main advantage of using a PHEV is the fact that short-distance trips can be done solely by using the battery power and not using the fossil fuel, which would, on one hand, deduct everyday gas emissions, while also lowering travel cost for the consumer on the other hand. Despite the benefits accompanied by adopting PHEV technology, this shift of transportation method might also bring a threat to the electric grid. Since all PHEVs are essentially classified as electrical loads in electrical grid's perspective, uncoordinated charging of PHEVs can potentially add to the current peak load or result in a new peak load. As investigated in [4], the load of each house can potentially increase by 47% by the year 2050. Such overload can cause serious voltage deviation and transformer overloading which might result in damaging electrical appliances or even a blackout on large scales. However, smart grid developments and advanced metering and communication systems have enabled us to develop and use various algorithms to deal with such issues. Demand-side management (DSM), which is the modification of user demand for optimal usage of the electrical grid, is one proposed solution to such problem [5]. In other words, DSM essentially helps to schedule a coordinated charging pattern for all or part of PHEV fleet in the grid so that no extra load peaks are created. DSM is a crucial part of our future inter-connected smart grid, which makes the distribution grid more cost-effective, reliable and eco-friendly [2]. DSM-enabled PHEVs are accompanied with two major challenges. The increasing number of PHEVs is the first challenge. The number of PHEVs has passed the 20,000 mark in Canada in March 2016 [6] and they are expected to constitute around 40% of global vehicle sales by 2035 [5]. The other challenge is the uncertainty and dynamism inherent to DSM of PHEVs. For instance, PHEVs can continuously get connected or disconnected from the grid at uncertain random times. Such dynamic user behaviour unpredictability shall be taken into account in DSM approach. Such controversies are predominant motivations of this work.

2

1.2

Research Contributions

The primary contributions of this work are listed as follows. Firstly, an algorithm is proposed, aiming to flatten the overall power consumption of the household, while satisfying consumer's needs such as PHEV power requirements and available time frame. Through constructing such algorithm, power grid's stability and robustness are also enhanced while the additional PHEVdriven demand does not pose any further threats to the grid. Additionally, the proposed algorithm is further reinforced by dictating peak power constraints for battery's charging power and household overall power consumption. When the single-PHEV scheduling algorithm is constructed, we aim to expand the scheduler by including multiple PHEVs in our approach. Therefore, a multi-PHEV scheduling algorithm is proposed while solving the incompatibility issues of this expansion. Moreover, a priority function is constructed to decide between different consumers and their charging requirements, dictating the scheduling queue. By introducing such algorithm, smart grid infrastructure is utilized in the most efficient manner, aiming to satisfy the consumer and utility provider at the same time. Lastly, by aiming to increase the dynamism of our approach and also shedding more light on consumers' needs, a new dual-target scheduler is proposed. The new scheduler combines two objective functions and fuses centralized and decentralized approaches into a single structure. It is worth to mention that this novel algorithm provides a controlling mechanism which enables the focal point to vary between centralized and decentralized approaches. In other words, different weights in the algorithm facilitate us to modify the focus between utility providers' satisfaction and consumers' peace of mind. Such dynamics enabled by a dual-target objective function is the most significant contribution of this work.

3

1.3

Dissertation Outline

The remainder of this dissertation is organized as follows. Chapter 2 focuses on literature review and analyses different studies done in this area. The predicted impacts of PHEV charging are explained and major scheduling methods are also introduced in this chapter. Additionally, the leading scheduling opportunities are exposed. Chapter 3 focuses on the essential theory leading demand-side management (DSM) schedulers while exposing the undeniable adjacency of DSM algorithms and radio resource allocation (RRA) methods. Furthermore, water-filling (WF) problem statement and its generic solution is presented. Moreover, the link between WF and DSM is revealed and potential beneficial factors of geometric water-filling (GWF) are investigated. Lastly in this chapter, the GWF method is examined and its solution with respect to DSM problem statement, is considered. Our proposed scheduling algorithms are introduced in Chapter 4. Single-PHEV Load Allocation (SLA) and Multi-PHEV Load Allocation (MLA) algorithms are first proposed, followed up by their modified version to accompany additional features such as peak power constraints and priority function. At last, the novel dual-target scheduling algorithm is proposed in both single-PHEV and multi-PHEV formats, bringing this chapter to its end. Chapter 5 is dedicated to simulation results and numerical analysis for all the proposed algorithms. In this chapter, the realistic datasets of PHEV power consumption and non-PHEV power consumption are established, trailed by simulation results of single-PHEV and multi-PHEV scenarios. Numerical results are also presented to demonstrate the accuracy of different algorithms in various situations. Chapter 6 summarizes the main contributions and conclusions of this work while directions for future work are also suggested.

4

Chapter 2 Literature Review
Majority of the works on PHEV charging focuses on the fleet's impact on power grid. Authors in [7] optimistically concluded that the EVs would only increase the load peak values slightly, while authors in [4] gave a more precise prediction on load peak variances with regards to different PHEV penetration levels. Researchers in [4] discussed PHEV penetration levels of 35%, 47% and 50% for the years 2020, 2023 and 2026 respectively. They showed the malicious effect of the additive demand on peak load values, total losses and voltage deviations. One well-researched proposed solution to such problem is coordinated charging of PHEVs. Top two common places to charge a PHEV are shared parking lots in urban areas and parking garages in residential areas. Both location-based focuses present unique opportunities and challenges. Public PHEV charging introduces difficulties such as arrival process and charging demand variations which are highly dependant on consumer behaviours. Such vigorous nature requires probability-based coordinated charging strategies to tackle the issue. Authors in [8] introduce a scheduling scheme suitable for large shopping plazas and business districts. On the other hand, researchers in [9] propose an integration of solar and wind local generation coupled with power grid electricity to serve regional charging stations. Some researchers like authors in [10] have proposed a battery-switching station, where PHEVs with depleted batteries, change their battery upon 5

arrival and the batteries stored in the station are to be charged utilizing power supply optimization methods.
18

Overnight dip in power consumption
Non-PHEV Power Consumption Total Power Consumption

17

Power Consumption (in MW)

16

15

14

13

12 9 12 15 18 21 0 3 6 9

Time of day (hours)

Figure 2.1: Overnight valley in power consumption in Ontario [1]

Coordinated charging scheme in residential areas is also a compelling subject due to the fact that many PHEV users prefer to charge their vehicles in the comfort of their households. Therefore, charging algorithms in residential areas are chosen to be the main focus of this work. Most coordinated charging methods focus on the overnight dip in power consumption and adopt a valleyfilling approach to satisfy charging needs. Fig. 2.1 illustrates such overnight dip and one proposed approach which would fill the dip with additive PHEV power requirements. The dataset which resulted in Fig. 2.1 present province-wide power consumption in Ontario, Canada, on September 27 and 28, 2015 [1]. Coordinated charging methods have been studied over the past decade and they are regularly classified into 3 different categories as discussed in the following.

6

2.1

Centralized Schedulers

As the most commonly used scheme, centralized schedulers utilize a central operator to decide and dictate the charging rate and time for all PHEVs connected to the system. Decisions are made on a system-level consideration and the overall cost function is to be minimized. Central scheduling can be reached through different cost functions and problem formulations which lead to various objective functions. Furthermore, a number of techniques are employed to optimize such objective function. Authors in [11] integrate the cost function with a marketing agent aiming to lower the utility cost. Such objective function is later optimized by employing a variety of algorithms, utilizing quadratic programming in their core while making use of different knowledge levels of the system. Researchers in [8] blend the cost function and M/M/1 queueing theory which led to centralized scheduling schemes for clustered users in parking lots. On the same application, authors in [12] assumed Poisson distributed arrivals and an admission control strategy is put in place to reduce the load intensity while serving a maximum number of PHEVs in a parking lot. Researchers in [9] obtain the cost function by fusion of resource availability and market's energy cost which was then optimized through linear programming methods. Authors in [13] took advantage of a radial 33-bus system analogy and employed Artificial Bee Colony optimization to minimize the operational cost of the system. Wei et al. introduced a price-based utility function in [14] and minimized such function through a heuristic greedy algorithm. In a slightly different application, researchers in [15] aimed to perform DSM on HVAC systems while utilizing waterfilling algorithm to minimize the power consumption. Authors in [16] propose a dynamic price scheduler for charging stations, where profit maximization is set to be the main focus. Lyapunov optimization methodology is coupled with energy management systems to reach such goal. Game theory can also be approached as [17] did so. [17] assumes a large-scale vehicle to grid (V2G) network where PHEV charging and discharging are

7

fused to a cooperative model in the framework of coalition game theory. Total economical cost is to be optimized in the mentioned work. Investigated central scheduling schemes have proven to guarantee the optimal outcome, while the high computational complexity is an inevitable factor due to a large number of PHEVs connected to the realistic system. Diverse techniques such as sampling rate reduction and decision interval trimming have been explored, aiming to lower the computational complexity. Such modifications have decreased the complexity while also weakening the algorithm and eradicating final results. Centralized schedulers are still to be explored and enhanced in literature.

2.2

Decentralized Schedulers

Decentralized schedulers have emerged by perceiving systematic intentions from a different perspective. Such scheduling schemes grant individual PHEVs the right to determine their charging pattern. These schemes are regularly used when consumer's satisfaction is the sole goal of the system. Although such satisfaction could be defined in various terms. In this method, a smaller population of PHEV users are studied, thus the computational complexity does not raise any issues. Researchers in [18] explore time-based and fixed-price cost functions. Later on, non-cooperative game theory is applied to model consumers' behaviour where PHEVs are updating their charging strategy to minimize their individual cost function. The proposed algorithm converges to an -Nash equilibrium which can also be interpreted as a valley-filling strategy. Authors in [19] propose a priority-based load shaping tool where a home area network is utilized to intelligently redistribute power consumption to avoid transformer overloading while maintaining a high consumer satisfaction. Water-Filling method is adopted in [20] as means to minimize power consumption deviations and peak-to-average ratio of the overall demand. This algorithm employs a probabilistic demand

8

forecasting method and obtains the optimal power allocation based on water-filling mechanism. While authors in [20] focus on one household, researchers in [2] aim to expand the algorithm to be applicable to a number of households and their PHEVs. Researchers in [2] take advantage of a single-phase power supply to which PHEVs are connected to. The mentioned paper applies waterfilling methodology to minimize the power consumption deviation while scheduling is performed on multiple PHEVs. In order to increase the fairness for all consumers, a circular charging order strategy is employed. Decentralized scheduling schemes explored in literature do not guarantee optimal outcome. While on the contrary, local predictions lead to better matching of demand and supply and consumer satisfaction have increased in such method. Nevertheless, the chance of optimal solution can increase depending on the information and methods used to determine the local charging pattern. This method has low computational complexity, which is a favourable characteristic. Such feature is due to the fact that it is mostly performed on small scales and does not accommodate a large population of consumers. To put it in other words, decentralized scheduling lacks the scalability factor. Thus it can only benefit the consumer while the utility provider will have no control over the power consumption pattern.

2.3

Hybrid Schedulers

The hybrid scheduling method is an integration of centralized and decentralize schedulers. Such integration is obtained through different combinations. Authors in [3] proposed a central scheduler that gathers the behavioural information on consumers and then schedules their demand profile and reports them back to the consumers. Such scheduling is carried out via quadratic programming. This algorithm takes consumers into consideration by assigning agents to each PHEV, which would lead to a Multi Agent System (MAS). Final results are obtained by iterative negotiations of agents on different levels.

9

Such scheme is further enhanced in [5] where dynamic programming have been chosen to be the primal solution. Authors in [5] aim to minimize the charging cost for the consumer by introducing an energy cost model while maintaining a low divergence on total energy consumption to satisfy the utility provider. This mid-level real-time solution minimizes the energy cost and provides satisfactory scalability factor. Researchers in [21] took a different approach at the hybrid solution. Li et al. proposed a quadratic programming based algorithm to be adopted to minimize the total energy cost for the consumer. On the other hand, a distributed block scheduling method is proposed to minimize the power consumption variation on different blocks while taking various block sizes into consideration. The coalition of these two concepts results in a trade-off optimization on block size which led to the multi-level water-filling solution. The most noteworthy distinction between hybrid and central scheduling is the fact that central scheduler calculates individual charging plans for all system-connected PHEVs. While on the contrary, hybrid schedulers aim to acquire a collective charging plan for all PHEVs, which is far less computationally intense. On the other hand, hybrid scheduling diverges from decentralized scheduling due to the fact that collective PHEV power consumption is not a result of iterations of locally proposed charging plans, as it is the case of decentralized schedules. Rather, the collective PHEV power consumption pattern is the result of centrally calculated charging plan. In our work, the hybrid method is investigated due to its potentials. This method can deliver optimal local demand curves while maintaining a low computational complexity level. Such approach also provides us with more flexibility to integrate realistic constraints while other approaches do not support such accommodation. Our proposed system model will be discussed in details in Chapter 3.

10

Chapter 3 Theory and System Model
Demand-side management and coordinated charging schemes have been a point of interest in recent literature and the main motivation for our work. To put it in simple words, DSM intends to allocate finite amount of required energy in a fashion that a specific goal such as final cost or power deviation, is optimized. Radio resource allocation (RRA) on the other hand, aims to allocate limited energy resources to achieve the maximum throughput for a specific communication channel. Water-filling (WF) is one of the most popular methodologies utilized in RRA. The water-filling algorithm is a well-known concept in information theory which plays a significant role in RRA applications. This algorithm aims to maximize the mutual information between the input and the output of a communication channel which consists of multiple sub-channels where it's subject to a global power constraint. Water-filling aims to allocate more power where the signal-to-noise ratio (SNR) is the highest. In this chapter, a mathematical model of water-filling problem is first proposed, followed by the DSM problem statement. We then shed light on the analogy between the power allocation in communication channels and load scheduling problem portraying how the water-filling results can be used for our proposed scheduler. This chapter finishes by introducing geometric water-filling

11

(GWF) method and the detailed geometric solution to the water-filling problem is presented.

3.1

Generic Water-Filling Problem

The classical capacity-achieving water-filling result is the solution to the constrained optimization problem in (3.1).
N

max
i=1

log(1 +
N i=1

si 1 ), h- i (3.1)

s.t. The solution is given by

 

s i  PT 1iN

 s  0, i

si = ( - hi )+ , 1 = PT + N
N

hi ,
i=1

1iN

(3.2)

where (x)+ = max(0, x), N is the number of channels, hi and si respectively represent the channel gain and power level of the ith channel, and  represents the water-level chosen to satisfy the power constraint with equality
N i=1

si = P T .

Equation (3.2) is known as the water-filling result and it signifies that for an optimal solution, more transmission power will be allocated to channels with less noise; i.e. higher SNR values. This capacity achieving solution has the visual interpretation of pouring water over a multi-level surface, hence it is called water-filling or water-pouring [22]. This property is better illustrated in Fig. 3.1. The conventional way to solve such problem is through solving the non-linear equation in (3.1). As discussed in [23], a wide range of methods have been proposed in literature to solve (3.1) by satisfying Karush-Kuhn-Tucker (KKT) conditions. This particular class of solutions, which are 12

Power


s2 s1 h2 h1

s3

Water level

s4 h5

s6 h7 h6
Channels

h3

h4

Figure 3.1: Classical water-filling power allocation often referred to as conventional water-filling, have been discussed at length in [24, 25]. Another class of solutions to this problem is categorized as exact algorithms, which aim to find the exact answer in a finite number of iterations through computationally complex steps [23, 26]. Authors in [27] have proposed a novel way to achieve the exact solution for the water-filling problem, without going through computationally complex steps to solve KKT conditions. This novel approach adopts a geometric view of the problem and provides an explicit solution to the water-filling problem, hence called geometric water-filling. GWF is proven to provide the optimal solution to (3.1). The concept of geometric water-filling will be discussed in 3.3.

3.2

Water-Filling and Demand-Side Management

As discussed in Chapter 2, power allocation methods and load balancing algorithms have been investigated through the years. Researchers in [14,15,20] have subdivided the loads of a household to soft loads and hard loads, where soft loads can be shifted with some degree of flexibility while hard loads are not to be tampered with. The analogy similarity between WF and DSM is better understood when it's realized that hi in (3.1) is a part of channel's characteristics and cannot be

13

tampered with, while si is the variable which can be altered in order to satisfy the constraints and hence optimize the equation. Thus, the water-filling approach naturally fits the power allocation problem dealt with in this work. In this work, the additive PHEV load is the designated soft load and the non-PHEV load of a household is assumed to be the hard load; e.g. refrigerator, stove, washer, etc. In other words, the regular consumer's behaviour is set to be unmodifiable. Therefore, PHEV's energy requirement is assumed to be the only elastic load which can be adjusted within a number of pre-defined constraints. Similar to the classical capacity maximization method discussed in 3.1 where more power is to be allocated to channels with lower noise levels, soft loads' energy requirements shall preferably be allocated to time slots with less hard load. The conventional demand-side management algorithms deal with the following optimization problem:
T M 2

min{µ,si (t)}T t=1
t=1 i=1

si (t) + hi (t) - µ si (t)  PTi 1  i  M, 1  t  T

s.t.

 

T t=1

(3.3)

 s (t)  0, i

where si (t) and hi (t) respectively represent PHEV power consumption and non-PHEV power consumption for the ith household at any given time t. It's worth mentioning that in this approach, si (t) is the only elastic and schedulable load, while hi (t) is the hard load and cannot be tampered with. PTi represents the total energy requirement demanded by the PHEV at the ith household; i.e. P HEVi 's demand. µ represents the optimal reference level where the optimal result is obtained when the deviation with respect to µ is minimal.

14

T

2

min{µ,s(t)}T t=1
t=1

s(t) + h(t) - µ
T t=1

,

s.t.

 

s(t)  PT 1tT

(3.4)

 s(t)  0,

Without loss of generality and for simplicity, we assume a single-PHEV system represented in (3.4). The optimization problem in (3.4) aims to solve the power allocation problem in a way that the total power consumption (s(t) + h(t)) would have minimal deviation with respect to the reference level µ. Thus both s(t) and µ are variables in the problem formulation. Applying Lagrangian multiplier to the single-PHEV case driven from (3.4) results in
T 2 T

f s(t),  =
t=1

s(t) + h(t) - µ

-
t=1

s(t) - PT .

(3.5)

Differentiating (3.5) with respect to s(t) and setting it to zero yields  d L s(t),  = 0  s(t) + h(t) - µ + = 0. d(s(t)) 2 Denoting  = µ - /2 as an independent variable from time t, (3.6) can be rewritten as
+

(3.6)

s(t) + h(t) =   s(t) =  - h(t)

(3.7)

where  can be considered as the optimality condition of the optimization problem proposed in (3.3). On the other hand, water-filling methods aim to solve the optimization problem in
N

max f (si ) =
i=1

log 1 + s i  PT

si 1 h- i (3.8)

s.t.

 

N i=1

 s  0, i 15

1iN

where si and hi represent the allocated power and fading level in the ith channel. Applying Lagrangian multiplier to (3.8) will result in
N

L(si , ) =
i=1

log 1 +

si 1 +  PT - h- i

N

si
i=1

.

(3.9)

Acquiring differentiation from (3.9) with respect to si and setting it to zero gives d 1 L si ,  = 0  -  = 0. d(si ) si + hi
1 By denoting  =  , the water-filling final result will be given as

(3.10)

si = ( - hi )+

(3.11)

where  can potentially represent the water-level which would satisfy the problem's constraints presented in (3.8). By comparing (3.7) and (3.11), we can see how the water-filling analogy resembles the demandside management results when the noise level in a channel echoes the non-PHEV power consumption while different channels can represent the time axis where power allocation is applied upon; i.e. i-th channel would represent time t. Thus it becomes clear that water-filling would perfectly fit the problem defined by DSM. The only issue raised by using water-filling methods in DSM-based problem is the dimensionality mismatch when WF is to be applied upon multi-PHEV scenarios. This concern arises from the fact that DSM is defined as a three-dimensional problem while water-filling only provides the solution to a two-dimensional problem. This matter will be discussed and resolved in Chapter 4 by introducing a priority function. Another noteworthy point is the fact that in communication channels, throughput maximization is the main goal and obtaining the water level  in (3.1) is the only concern. While DSM aims to minimize the power deviation and reference level µ in (3.3) is representative of reference level, which is a different concept than water level. To rephrase it, in WF we aim to acquire the water level and calculate the soft loads with respect to the water level value. While in DSM, the objective is 16

to minimize the soft load deviations with respect to the reference level. This conceptual difference poses no obstacle regarding the coalescence of these two applications. It's also worth mentioning that the main consumer-driven constraint is to have the PHEV fully charged by a specific time, which will be introduced as td in 4.2. On the other hand, from the utility provider's perspective, a flat and predictable demand response is defined as the ideal case. Utilizing WF in DSM application would satisfy such requirement as water-filling aims to flatten the total power consumption which is the summation of soft and hard loads. Furthermore, the geometric water-filling method is chosen to be our approach because of it's low computational complexity and exact optimal result. This approach is further discussed in the following section.

3.3

Geometric Water-Filling

The proposed geometric water-filling was first put forward by authors in [27] as means of solving the generalized RRA problem. This approach is based on the geometric view of the waterfilling problem formalized in 3.1, where a limited resource of water is to fill a tank with a multilevel floor. The available water resources represent the total energy (PT ), and the steps on the floor are representing noise level in the channel (hi ). Fig. 3.2 helps to illustrate this analogy. The conventional approaches aim to find the dashed line  in Fig. 3.2 based on KKT conditions first, and then the power allocation of each step is done based on the water level  as stated in (3.2). Whereas in this approach, the allocated power to each time slot is calculated first, and the water level  is a post-product of the method. Let us use hi to also denote the "step depth" of i-th step where i  [1, . . . , N ], which is the height of each step from the floor. GWF approach requires the step depth of the stairs to be sorted monotonically increasing, indexed as {1, . . . , N }. It is crucial to the algorithm to sort the step

17

s 3

5


s2
2 1 3

4

h2

Figure 3.2: Illustration of the proposed Geometric Water-Filling algorithm levels monotonically increasing if it's not. We further define i,j as the "step depth difference" between ith and j th steps, expressed as i,j = hj - hi , 1  i  j  N. (3.12)

Instead of targeting the water level  in our algorithm, we direct our focus on water level step which is an integer number in {1, . . . , N } range, denoted by k  . This notation can alternatively be described as the highest step under water. Based on the value of k  , power allocation results can be driven instantaneously. This concept is further illustrated in Fig. 3.2 portraying an example in which k  = 3 and the shaded area is denoting the allocated power for the third step, indicated by s 3. In the following, we explain how to obtain the k  value without any knowledge on water level . Let P2 (k ) denote the water level above step k or zero. P2 (k ) can be further expressed as
k -1 + k-1 +

P2 (k ) =

PT -
i=1

hk - hi

=

PT -
i=1

i,k

,

k = 1, . . . , N

(3.13)

where {·}+ serves as the same notation used in equation (3.2). The non-zero property of P2 (k ) is derived from the fact that P2 (k ) is representing the water 18

volume above step k and this water volume intuitively cannot be negative. To put it into geometric perspective, zero value for P2 (k ) represents that there is no water on top of the k -th step. Now k 

5


3

4

2 1

Figure 3.3: Illustration of P2 (k ) (shaded area) when k = 2 can be obtained by utilizing the concept illustrated by P2 (k ) in Fig. 3.3. The highest level under water k  is acquired as k  = max k |P2 (k ) > 0, 1kN . (3.14)

Equation (3.14) chooses the highest level for which it has a non-zero P2 (k ) value, representing the highest step where power can be allocated. Now that the highest level under water is obtained, the power allocation for all the channels can be calculated as   sk + (hk - hi ), 1  i  k  si =  0, k < i  N where sk represents the left-over energy after basic allocation, expressed as sk  = 1 P2 (k  ). k (3.16)

(3.15)

The allocated power for all eligible channels is calculated in equation (3.15) and presented in Fig. 3.4. It's note worthy to mention that allocated power to each step is calculated without finding any values for the water level. Water level  can now be calculated as followed. 19

1 =  k

k

si + hi
i=1

1 =  k

k

si + P T .
i=1

(3.17)

5


s3 s1
2 1

4

s2

3

Figure 3.4: Power allocation using Geometric Water-Filling when k  = 3

20

Chapter 4 Load Scheduler Algorithms
As discussed in previous chapters, a coordinated load scheduling method necessitates to allocate the energy requirements of additional PHEV load. We first introduce a charging model for PHEV's battery, followed by system model proposal for the simplified single PHEV scenario. We then expand our load scheduling scheme for single PHEV and multi PHEV cases, where dimensionality mismatch is tackled. Lastly, our dual-target scheduling mechanism is introduced as the novel hybrid solution to DSM problem.

4.1

Dynamic Battery Charging Model

PHEV battery technologies have received a lot of attention in literature since battery represents the vehicle in many aspects such as energy capacity, range anxiety, and cost. All such factors contribute to the usefulness of PHEV technology and adoption rate is predicted to increase as PHEV batteries become more stable and cost-efficient. Almost all modern PHEV manufacturers use Lithium-ion (Li-ion) batteries because of its high-energy density and low maintenance features. State of charge (SOC) is namely the most exemplifying characteristic of the battery, which is the

21

equivalent of the fuel gauge. SOC is defined as

SOC =

C × 100% Cn

(4.1)

where C and Cn respectively represent remaining charge in the battery and nominal capacity of the battery. C and Cn are measured in the kW h unit. Due to behavioural characteristics of Li-ion batteries, fast charging rate is feasible when the battery is being charged up to 90%. On the other hand, a minimum SOC level of 20% is recommended in literature to increase the battery life [28]. Hence, a charging range of SOC  (20%, 90%) is considered throughout our work. Total energy requirements of a PHEV is represented by PT which can be calculated as PT = Cmax - C ×  -1 (4.2)

where Cmax is the maximum charging capacity and  serves as the charging efficiency coefficient.  varies depending on battery characteristics and charging features. Cmax is driven from the fact that a battery is desired not to be fully charged. Therefore Cmax = 90% × Cn . (4.3)

Total energy requirements calculation in (4.2) are to be utilized later in this chapter, when energy requirements of PHEVs are to be considered by our scheduling algorithm.

4.2

Single PHEV Load Allocation

For simplicity and without loss of generality, we first assume a single PHEV problem, where the PHEV's demands are to be scheduled for a household in a discrete-time process. The nonPHEV energy consumption and PHEV energy consumption of such household at each given time t is to represent hard load and soft load, and to be referred to as h(t) and s(t) respectively. 22

We further assume that consumers would like to have their vehicles fully charged by the time that they plan to leave the household. Therefore, to ensure consumer's satisfaction, we assume ta and td to be arrival and departure times of the PHEV to and from the household, which are dictated by the consumer. This limitation results in a valid time window [1, T ] where T = td - ta in which energy allocation should be performed. ta would be the time that the PHEV gets plugged-in to the grid, and td would be the preferred departure time of PHEV, set by the consumer. Moreover, energy requirements of the PHEV can be calculated via (4.2), depending on the initial charge upon PHEV's arrival and charging efficiency rate. Taking T and PT into consideration as time window limitation and total energy requirements for the PHEV, the DSM-based objective function can be formulated as

T

2

min{µ,s(t)}T t=1
t=1

s(t) + h(t) - µ
T t=1

,

s.t.

 

s(t) = PT 1  t  T.

(4.4)

 s(t)  0,

where µ represents the reference level. The unequality constraint in (3.4) is changed to the equality constraint in (4.4) as the exact amount of required energy PT is intended to be delivered to the consumer. As highlighted in 3.3, the hard load data requires to be sorted if GWF is to be employed. Therefore once the time-limited hard load data is obtained as h(t) for t = 1, . . . , T , h(t) should be sorted monotonically increasing. The new set of hard load data is called hs (k ), k  [1, . . . , T ] and will be used for the geometric water-filling algorithm. It's important to note that hs (k ) cannot be considered as a time-series dataset, but rather an information-based dataset, on which the GWF will be performed. To utilize the geometric water-filling algorithm discussed in Section 3.3, (3.13)- (3.16) should be re-written to be employed in Algorithm 1. When the hard load data is sorted, the P2 (k ) value 23

can be calculated by rewriting equation (3.13) as
k-1 +

P2 ( k ) =

PT -
i=1

hs (k ) - hs (i)

(4.5)

where hs (k ) represents the step depth of the k th step in geometric analogy. Next phase would be acquiring the highest step under water, which would indicate the set of eligible time slots for power allocation. Such indication is done by re-writing equation (3.14) as k  = max{k |P2 (k ) > 0, 1  k  T }. (4.6)

Now that power-allocation-eligible time slots are identified, allocated power to each time slot is determined by rephrasing equation (3.15) as   s + hs (k  ) - hs (k ) , s s (k ) =  0,

1  k  k k < k  T

(4.7)

where s would represent the left-over energy and is defined as s = 1 × P2 (k  ). k (4.8)

By applying (4.7), ss (t) holds the allocated power to eligible time slots. It can now be mapped back to the time-based order resulting in s(t). Thus, s(t) can be calculated as

s(t) = SLA PT , h(t)

(4.9)

As promised before, the reference level would emerge as a post-product of GWF method. Hence, the reference level µ can be calculated as 1 µ=  k
k

k=1

1 hs (k ) + ss (k ) =  k

k

ss (k ) + PT .
k=1

(4.10)

Such reference level value is to later be taken advantage of, during numerical analysis while SLA algorithm is being evaluated. 24

Algorithm 1 Single PHEV Load Allocation (SLA)
1: 2: 3: 4: 5: 6: 7: 8: 9: 10: 11: 12:

Initialize: PT , h(t) for t = 1, . . . , T Sort h(t) monotonically increasing to hs (k ) for k = 1, . . . , T
+

P2 ( k ) =

PT -

k-1 i=1

h (k ) - h (i)

s

s

for k = 1, . . . , T 1  k  T}

Find power-allocation-eligible time slots k  = max{k |P2 (k ) > 0, for k = 1, . . . , T do if k  k  then s =
1 k

× P2 (k  )

ss (k ) = s + hs (k  ) - hs (k ) end if end for Rearrange ss (k ) and hs (k ) to unsorted datasets of s(t) and h(t) Output: s(t) for t = 1, . . . , T A related point to consider regarding the single-PHEV scenario is the fact that such problems

are efficiently solved through decentralized approaches. Thus, the single-PHEV scenario is only acting as the simplified format of multiple PHEV scenarios and would be utilized as a sub-function in multi-PHEV algorithms.

4.3

Multiple PHEV Load Allocation

Multiple PHEV scenario comes into the picture when the power balancing is to be done in a neighbourhood among multiple households. Thus it is reasonable to focus on load balancing for a low-voltage transformer (LVT), which is the adopted view in our approach. We have also chosen such notion because of the following two reasons. Firstly, our approach has the consumers' satisfaction at its highest priority and through downgrading our point of view from a macro-grid system to a micro-grid method, such satisfaction parameter is achievable. To 25

put it in another way, in our approach, we down-size from a central scheduler to a hybrid scheduler in terms of consumer inclusiveness in pursuance of higher consumer satisfaction. Secondly, in a centralized approach where all consumers are being taken into consideration, computational complexity rises enormously, because of the very fact that every single household and their demands are being taken into consideration. Thus, by balancing the demand curve for each LVT, our hybrid approach aims for the mid-level view between a micro-grid perceptive where the focus is solely on consumers' needs and macro-grid view where only grid's satisfaction is intended.

Figure 4.1: A section of distribution grid consistent of High Voltage Transformer, Low Voltage Transformer, and households [2] Now that the scheduling algorithm for the single PHEV case has been presented, we can extend our algorithm to be applied to a group of PHEVs in a neighbourhood connected to an LVT. The objective function in multiple PHEV case would be defined as
Ti N 2

min{µ,si (t)}Ti s.t.  
Ti t=1

t=1

si (t) + hT (t) - µ
t=1 i=1

,

si (t) = PTi 1  t  Ti , i  [1, . . . , N ]

(4.11)

 s (t)  0, i

where si (t) and hT (t) respectively represent the soft load of the ith household and cumulative hard load for all LVT-connected households at time t. Furthermore, µ represents the reference 26

level of LVT's power consumption. In this approach, we aim to minimize the power consumption deviation for the LVT; i.e. sum of all soft loads and hard loads. Thus hT (t) is introduced as (4.12), representing the cumulative hard load for all LVT-connected households. On the same note, µ is calculated as a single value for all LVT-connected households and PHEVs.

N

hT (t) =
i=1

hi (t)

, t = 1 . . . , Ti .

(4.12)

It is worth mentioning that the objective function in (4.11) intends to achieve load allocation by comparing the soft load si (t) to cumulative hard load hT (t) at each time stance. Therefore our objective is, on one hand, to satisfy the consumers by meeting their energy requirements by fulfilling the equality constraint
Ti t=1

si (t) = PTi , while on the other hand, satisfying the utility

provider by delivering a power demand curve with minimal variance with respect to the reference level. Single PHEV power allocation can be interpreted as a two-dimensional problem where one dimension is time, another dimension is total load (summation of soft load and hard load) on each time slot, respectively presented in X axis and Y axis in Fig. 3.1. By upgrading the problem to a multiple PHEV scenario, we increase the dimensionality of the problem, turning it into a 3dimensional problem. This interpretation is better illustrated in Fig. 4.2, where each household has it's own time-related soft load and hard load datasets while we aim to allocate power to each household with respect to cumulative power consumption. With more than one PHEV to be scheduled in the system, a decision-making principle is required to make the 3-dimensional problem compatible with our proposed 2-dimensional solution. In other words, the algorithm requires a bridge between 2-dimensional water-filling method, and 3-dimensional DSM optimization problem at hand. As inspired by [2], PHEVs are to be scheduled one-by-one from 1 to N . Therefore P HEVi is always being scheduled before P HEVj where i < j . It is essential to point out that P HEVi is being scheduled earlier, not being charged,

27

Power

Time

Us

ers

Figure 4.2: 3-D Illustration of Multiple PHEV case meaning that it will fill the valley at a lower point in total power consumption. In order to calculate the allocated load for each household, we have denoted Ti and PTi to be valid time window and energy requirements for the ith PHEV, where these values are generally exclusively set by the consumer, and may vary for each consumer. these parameters are facilitated in (4.11). Such generality in our approach further guarantees consumers' satisfaction. In order to further simplify the notations, power consumption and allocated power for each PHEV are put into vectors PT and S(t) defined as     PT1 s1 (t)          PT2   s2 (t)       .   .   .   .   .   .  PT =   , S(t) =  , P   s (t)   Ti   i      .  .   .  .   .   .     PTN sN (t) 28

t = 1, . . . , T.

(4.13)

Now we can define the proposed load allocation algorithm for multiple PHEV case. In our MLA algorithm, the cumulative hard load data is being calculated first. Then SLA algorithm is being called iteratively. In each iteration, soft load is being allocated by taking the cumulative hard load hT (t) into account, instead of individual hard load. Furthermore, cumulative hard load is updated with respect to the new additive scheduled soft load. Therefore, load allocation of each PHEV for all the corresponding households S(t) can be calculated as S(t) = M LA(PT , hT (t)). (4.14)

Furthermore, the reference level for the LVT can be calculated by modifying (4.10) as 1 µ= N
N

i=1

1  ki

 ki

s hs T (k ) + si (k ) k=1

1 = N

N

i=1

1  ki

 ki

ss i (k ) + PTi
k=1

.

(4.15)

Algorithm 2 Multiple PHEV Load Allocation (MLA)
1: 2: 3: 4: 5: 6: 7:

Initialize: PT , hi (t) for t = 1, . . . , Ti and i = 1, . . . , N Calculate the cumulative hard load for LVT to hT (t) for i = 1 to N do Calculate si (t) as si (t) = SLA(PTi , hT (t)) update the cumulative hard load data hT (t)  hT (t) + si (t) end for Outputs: S(t) for t = 0, 1, . . . , Ti and i = 1, . . . , N By applying MLA algorithm to a number of LVT-connected PHEVs, we have achieved the

following:

1. PHEV energy requirements are satisfied for all households connected to the LVT, respecting individual time constraints, 2. A flat total power consumption curve with optimal power deviation is delivered to LVT, which is the ideal case for utility provider, 29

3. MLA algorithm requires only cumulative hard load data, and individual hard load data for each household was not required to perform the load allocation.

These 3 achievements deliver the optimal solution to the load allocation problem for multiple PHEVs connected to a local LVT. It is also worth mentioning that MLA by only requiring the cumulative hard load information, lowers the computational complexity of the algorithm compared to previous works [2] and hence increases the practicality of the proposed solution. However, our MLA algorithm encloses two practical problems. Firstly, as stated earlier, demands for P HEVi are always satisfied earlier than P HEVj for any i < j . Such order can lead to problems where the demand for the j th PHEV is higher (PTi < PTj ) and it's time window is smaller than its counterpart (Ti < Tj ). In such case, MLA cannot guarantee an ideal flat demand curve and consumer's demand satisfaction at the same time. The second problem arises from a practical limitation. Industrial battery chargers are equipped with battery management systems (BMS), which monitors and regulate battery's input charging power. Such systems apply practical limitations on charging power to ensure battery's life longevity. Therefore in order to take battery's longevity protection into account, our algorithms necessitate minor changes. Such issues are resolved in Section 4.4 in our proposed Modified Load Allocation Algorithms.

4.4

Modified PHEV Load Allocation Algorithms

Due to issues stated in the previous section, SLA and MLA algorithms are to be modified. Each problem is solved by proposing modified-SLA and modified-MLA algorithms.

30

4.4.1

Modified Single PHEV Load Allocation

One of the issues revealed in 4.3, was the practical maximum charging level on the battery, which is applied to increase battery's durability. On the other hand, each household has a limited maximum power that it can drain from the grid. Such restriction is also imposed by the practical limitation on household's terminal fuse. Mentioned issues can be resolved by applying peak power constraints to PHEV's charging power level and household's total power consumption, while satisfying their charging requirements in the valid time window. By re-writing our objective function proposed in (4.4), we will have
T

min{µ,s(t)}T t=1
t=1

s(t) + h(t) - µ ,

s.t.

        

T t=1

s(t)  PT 1tT (4.16)

0  s(t)  Smax , s(t) + h(t)  Hmax

where Smax represents PHEV's maximum charging power and Hmax serves as the total power consumption upper bound for the household. It's noteworthy that Smax and Hmax are constant values for all times t. The equality constraint in (4.4) is rewritten in inequality format in order to accommodate the changes accompanied by Hmax . In order to accommodate such modification, the optimal GWFPP method proposed in [27] is adopted and modified. By denoting  as a subsequence of the sequence {1, . . . , T }, according to the proven cardinality of || in [27], it can be expressed as {j1 , j2 , . . . , j|| } and (4.5) can be extended into the expression
||-1 +

P2 (ik ) =

PT -
j =1

h (ik ) - h (ij )

s

s

,

k = 1, . . . , ||.

(4.17)

It is notable that if  is taken as the sequence {1, . . . , T }, then the extended expression (4.17) is regressed to the original expression (4.5). By applying the corresponding changes to the SLA algorithm, the Modified-SLA (mSLA) can be presented as followed. 31

Algorithm 3 Modified Single PHEV Load Allocation (mSLA)
1: 2: 3: 4: 5: 6: 7: 8: 9: 10: 11: 12: 13: 14: 15: 16: 17: 18: 19: 20: 21: 22: 23: 24: 25: 26: 27: 28:

Initialize: PT , h(t) for t = 1, . . . , T, Smax , Hmax Sort h(t) monotonically increasing to hs (k ) for k  ,  = {1, . . . , T } while  =  do
+

P2 (k ) =

PT -

||-1 i=1

h (k ) - h (i)

s

s

for k = 1, . . . , T 1  k  T}

Find eligible time slots k  = max{k |P2 (k ) > 0, for k = 1 . . . , T do if k  k  then s =
1 k

× P2 (k  )

ss (k ) = s + hs (k  ) - hs (k ) end if end for   {k |ss (k ) > Smax or ss (k ) + hs (k ) > Hmax , k  } if  =  then for k   do if ss (k ) > Smax then Pexcess = Pexcess + ss (k ) - Smax ss (k ) = Smax end if if ss (k ) + hs (k ) > Hmax then Pexcess = Pexcess + ss (k ) + hs (k ) - Hmax

ss (k ) = Hmax - hs (k ) end if end for end if    \ , PT = Pexcess end while Rearrange ss (k ) and hs (k ) to unsorted datasets of s(t) and h(t) Output: s(t) for t = 1, . . . , T 32

In each iteration of the algorithm,  represents the set of time indices where ss (k ) > Smax or ss (k ) + hs (k ) > Hmax . Later, the set  is updated and the power allocation process is called again, to reallocate the excess energy to other time indices. Also at this state, the time indices in  are allocated the maximum possible power with regards to Smax and Hmax limitations. By the end of this algorithm, allocated soft load is obtained. Therefore, s(t) can be calculated as s(t) = mSLA PT , Smax , Hmax , h(t) . (4.18)

Furthermore, the reference level after power allocation can also be calculated utilizing (4.10).

4.4.2

Modified Multiple PHEV Load Allocation

In order to expand the features introduced in mSLA to multi-PHEV scenario, we put peak power constraint information of all PHEVs and households into vectors Smax and Hmax defined as

Smax

S  max1     Smax2     .   .   .  = , S   maxi     .  .  .    SmaxN





Hmax

H  max1     Hmax2     .   .   .  =  H   maxi     .  .  .    HmaxN





, t = 1, . . . , T.

(4.19)

On the same note, the objective function (4.11) can be re-written as
Ti N 2

min{µ,si (t)}Ti         
Ti t=1

t=1

si (t) + hT (t) - µ
t=1 i=1

,

si (t)  PTi (4.20) 1  t  Ti , 33 i  [1, . . . , N ].

s.t.

0  si (t)  Smaxi si (t) + hi (t)  Hmaxi ,

Note that each household and its PHEV, have their upper bounds, which are unique to them and not applicable on all PHEVs in the system; i.e. Smax and Hmax . As stated before, the issue to be addressed is the order of PHEVs' energy requirements being scheduled. This problem arises due to the linear order proposed in 4.3 where P HEVi gets scheduled before P HEVj when i < j . Researchers in [2] have introduced a circular order to obtain absolute fairness between all the consumers. In their proposed solution, power allocation is performed upon all possible orders of PHEVs, and the averaged power allocation between all trajectories is considered as the final result. Although this proposal solves the linear order of PHEVs, it is based on the assumption that all consumers provide enough time span and request reasonable energy requirements from system's point of view. This might not be the case at all times. For instant, if a vehicle arrives at home and requests to be fully charged with respect to the upper bound constraints, in rather a small time window, the proposed circular order will not be able to differentiate the urgency of such consumer, and thus not satisfying the requested needs. Therefore to address this concern in a way that urgency detection is accommodated and consumer satisfaction is achieved, a priority function is proposed to decide the order in which all PHEVs are being scheduled with respect to their relative priority compared to other PHEVs of all LVT-connected households. We took into account the PHEVs' energy requirements and time constraints, to establish a priority function where the PHEV with higher energy requirements and smaller time window has a higher priority to be scheduled. Thus the priority function for each PHEV is calculated using its energy requirements and timewindow information. The priority function provides a numerical value for each PHEV based on their information, and it can be calculated as i = PT Demand of P HEVi = i T ime W indow of P HEVi Ti (4.21)

where PTi , Ti and i represent total energy requirements, valid time window and priority value of 34

the ith PHEV. Such priority function will make decisions on a higher level compared to a clientcentred decision making principle used in decentralized approaches in DSM, while maintaining a high-enough system-level decision making strategy to satisfy the utility providers' needs. By taking priority function into consideration, the Modified MLA (mMLA) algorithm can be presented as followed. Algorithm 4 Modified Multiple PHEV Load Allocation (mMLA)
1: 2: 3: 4: 5: 6: 7: 8: 9:

Initialize: PT , Smax , Hmax , hi (t) for t = 1, . . . , Ti and i = 1, . . . , N Calculate the cumulative hard load for LVT to hT (t) Calculate priority values i =
Demand of P HEVi T ime W indow of P HEVi

=

PTi Ti

Sort i monotonically decreasing to j while saving the original indices in vector I for j = 1 to N do Calculate si (t) for the corresponding j index si (t) = mSLA PTi , Smaxi , Hmaxi , hT (t) update the cumulative hard load data hT (t) = hT (t) + si (t) end for Outputs: S(t) for t = 1, . . . , Ti and i = 1, . . . , N

Alongside the same note, reference level µ can be calculated through (4.15). It is notable that two different features of upper bound constraints and priority function are being added to the algorithm by moving from MLA to mMLA algorithm. To better illustrate the differences induced by such features, two different pre-Modified Multiple PHEV Load Allocation algorithms are introduced. pmMLA1 and pmMLA2 algorithms are defined as followed. The algorithm pmMLA1 is designed to perform power allocation in respect to objective function (4.20) while allocating PHEV energy requirements based on a linear order. This algorithm is presented as followed. On the other hand, the algorithm pmMLA2 is designed to perform power allocation based on objective function defined in (4.11) while taking priority function defined in (4.21) and it's 35

Algorithm 5 Pre-Modified Multiple PHEV Load Allocation 1 (pmMLA1)
1: 2: 3: 4: 5: 6: 7:

Initialize: PT , Smax , hi (t) for t = 1, . . . , Ti and i = 1, . . . , N Calculate the cumulative hard load for LVT to hT (t) for i = 1 to N do Calculate si (t) = mSLA(PTi , Smaxi , Hmaxi , hT (t)) update the cumulative hard load data hT (t) = hT (t) + si (t) end for Outputs: si (t) for t = 1, 1, . . . , Ti and i = 1, . . . , N

functionality into consideration. Such algorithm is presented as followed. The properties of algorithms pmMLA1 and pmMLA2 are discussed in more length and in comparison to other algorithms in Section 5.3 while their properties with comparison to other algorithms, are presented in Table 4.1. Aforementioned algorithms are mainly used for evaluative purposes. Algorithm 6 Pre-Modified Multiple PHEV Load Allocation 2 (pmMLA2)
1: 2: 3: 4: 5: 6: 7: 8: 9:

Initialize: PT , hi (t) for t = 1, . . . , Ti and i = 1, . . . , N Calculate the cumulative hard load for LVT to hT (t) Calculate priority values i =
Demand of P HEVi T ime W indow of P HEVi

=

PTi Ti

Sort i monotonically decreasing to j while saving the original indices in vector I for j = 1 to N do Calculate si (t) for the corresponding j index si (t) = SLA(PTi , hT (t)) update the cumulative hard load data hT (t) = hT (t) + si (t) end for Outputs: S(t) for t = 0, 1, . . . , Ti and i = 1, . . . , N

By utilizing mMLA algorithm, the power allocation for PHEV energy needs is being done in a 36

Table 4.1: Power Allocation Algorithms and their respective properties
GWF Load Algorithm Allocation SLA mSLA MLA pmMLA1 pmMLA2 mMLA Multiple S S M M M M Constraint Property Order Single or Peak Power Priority-based

central manner while taking time constraints and energy requirements into account. Such approach is more consumer-focus compared to central schedulers while on the other hand, considers utility provider's satisfaction at the same time. Nevertheless, mMLA algorithm only takes utility provider's satisfaction into consideration in the objective function (4.20). In order to achieve a fully hybrid objective function which takes both consumers and utility company's satisfaction into consideration, the following method is proposed.

4.5

Dual-Target PHEV Load Allocation Algorithm

A new scheduling algorithm is to be proposed in this section. Such novel algorithm takes both sides of a power allocation problem into account. Our proposed dual-target problem is resolved through introducing a new objective function where not only grids' requirements are being considered, but also individual PHEVs are being taken into account. This method is first applied upon single-PHEV power allocation scenario, and then is expanded to multi-PHEV case.

37

4.5.1

Dual-Target Single PHEV Load Allocation

One of the consumers' concerns while adopting PHEV technology would be battery's longevity. Li-ion batteries are rather costly, and they shall be replaced when the efficiency dips bellow a certain level. Therefore, keeping the battery in a healthy status would be beneficial to consumers. Decreasing sudden changes in battery's charging power would elongate battery's life time. To put it in other words, if the battery charges at a certain level with minimal changes, it would stay efficient for a longer time. Hence, by minimizing charging power deviation, consumer's needs are further put into perspective in our approach. Therefore in order to facilitate such fusion, we can introduce two objective functions, where each one aims to minimize the changes on each side, i.e. grid's side and consumers' side. Such objective functions can be formulated as
T 2

f1 =
t=1

s(t) + h(t) - µ
T 2

f2 =
t=1

s(t) - 

(4.22)

where f1 is similar to (4.16) which aims to minimize the overall changes of total power consumption. However, f2 is the new addition to our system. By minimizing f2 , we aim to minimize the changes in PHEV charging power ,i.e. s(t).  is the reference value of charging power which will be calculated later on. The ideal case where f2 = 0 is achieved when charging power is the constant value of  for all time intervals t. Furthermore, linear scalarization allows us to introduce weights to each objective function in order to fuse them. By minimizing both objective functions

38

in (4.22), the single-objective optimizing problem is formulated as followed. g = W1 · f1 + W2 · f2
T 2 T 2

min{µ,,s(t)}T W1 t=1
t=1

s(t) + h(t) - µ         
T t=1

+ W2
t=1

s(t) - 

,

s(t)  PT (4.23) 1  t  T.

s.t.

0  s(t)  Smax , s(t) + h(t)  Hmax ,

The objective function (4.23) aims to minimize both aspects of our problem. W1 and W2 are the weights introduced to the system, allowed by linear scalarization. By introducing the ratio of =
W2 W1

and changing it, our focus can vary from grid's side to consumer's side.  = 0 yields to

W2 = 0 and objective function (4.23) transforms to (4.16) where the sole focus is on the grid's flat power consumption. If  = 1 then W1 = W2 and a balanced view of grid's needs and consumers' requirements is obtained. As  increases, the focus yields to consumer's requirements and grid's flat line of power consumption becomes less important to the system. By applying Lagrangian Multiplier to (4.23), the solution is unveiled as followed.
+

s(t) =  -  · h(t)

(4.24)

where  and  are = 2W1 µ - 2W2  -  2W1 + 2W2 , = W1 . W1 + W2 (4.25)

The steps leading to such solution are detailed in Appendix A. By comparing (3.7) and (4.24), it becomes obvious that GWF can be utilized to achieve such power allocation results. ^ (t) =  ·h(t), the load allocation results of our dual-target objective function Thus, by defining h can be obtained as ^ (t) . s(t) = DT SLA PT , Smax , Hmax , h(t) = mSLA PT , Smax , Hmax , h (4.26)

39

Furthermore,  can be calculated as 1 =  k
k

ss ( k ) .
k=1

(4.27)

4.5.2

Dual-Target Multiple PHEV Load Allocation

Now that the results of single PHEV power allocation is obtained while utilizing the dual-target objective function, the same target-duality can be applied to the multiple PHEV senario. In this case, the objective function (4.20) can be written as

Ti

N

2

Ti

N

2

min{µ,i ,si (t)}Ti W1
t=1

si (t) + hT (t) - µ
t=1 i=1 Ti t=1

+ W2
t=1 i=1

si (t) - i

,

s.t.

        

si (t)  PTi (4.28) 1  t  Ti , i  [1, . . . , N ]

0  si (t)  Smaxi si (t) + hi (t)  Hmaxi ,

where W1 and W2 are objective function weights and i is the mean charging power for P HEVi over time period [1, . . . , Ti ]. Utilizing (4.26) and priority function proposed in (4.21), our dualtarget multi-PHEV load allocation algorithm can be written as followed. Thus, the allocated power for all LVT-connected PHEVs can be calculated by S(t) = DT M LA(PT , Smax , Hmax , hT (t)). (4.29)

The new objective function proposed in (4.28) allows us to change the focal point between grid's requirements and consumers' satisfaction. By  = 0, the algorithm becomes a centralized scheduler on a neighbourhood level. When  increases, consumers' satisfaction and minimal change in battery's charging power gets highlighted. It is predictable that when  increases, the mean square error value for battery's charging power decreases and mean square error value for the total power consumption increases. 40

Algorithm 7 Dual-Target Multiple PHEV Load Allocation (DTMLA)
1: 2: 3: 4: 5: 6: 7: 8: 9: 10:

Initialize: PT , Smax , Hmax , W1 , W2 , hi (t) for t = 1, . . . , Ti and i = 1, . . . , N Calculate the cumulative hard load for LVT to hT (t) Calculate priority values i =
Demand of P HEVi T ime W indow of P HEVi

=

PTi Ti

Sort i monotonically decreasing to j while saving the original indices in vector I for j = 1 to N do ^ Calculate h T (t) =  · hT (t) ^ Calculate si (t) for the corresponding j index si (t) = mSLA PTi , Smaxi , Hmaxi , h T (t) update the cumulative hard load data hT (t) = hT (t) + si (t) end for Outputs: S(t) for t = 1, . . . , Ti and i = 1, . . . , N In order to set realistic boundaries to prevent unwanted side-products and increase the algo-

rithm's robustness, we are to establish the following constraints on W1 and W2 weights. W1 > 0 , W2  0

W2 =, 0 W1 W1 + W2 = 1 (4.30)

W1 and W2 are realistic values which act as weights on the objective function, thus both are assumed to be non-negative. Furthermore, it is intuitive to set  to have a non-negative value. Since  < 0 yields to W1 · W2 < 0 which is contradictory to our first assumption and therefore false. On the other hand, as the mapping ratio  = W1 which was introduced earlier dictates, having ^ (t) = 0 which would nullify our algorithm. Thus it is reasonable to set W1 > 0  = 0 yields to h and avoid the revoking condition. In order to facilitate the above-mentioned limits, a normalizing condition is introduced as W1 + W2 = 1. By normalizing the weights, not only the mentioned limits are accommodated in our method, but it also makes  a redundant and hence removable parameter. When W1 + W2 = 1, then by 41

knowing the W1 value, W2 value can always be obtained by W2 = 1 - W1 and hence  can be formalized as  =
1-W1 W1

which is not an independent parameter and thus it can be omitted.

Although  does not serve as an independant parameter, it can still give us insights regarding the ratio it represents. Therefore, it can still be utilized as insight giving representation of the focal point of the system.

1
W1 W2

Weight Values
0



Figure 4.3: Varying weight values according to different  ratios

By examining Fig. 4.3, we can see  = 0 yields to W1 = 1 and W2 = 0 and therefore  = 1, which converges the algorithm to centralized view. As  increases, W1 drops and W2 rises, while W1 + W2 = 1 remains true at all times. As  increases, W1 approaches to 1 while W2 converges to 1. At  = 1, W1 and W2 values are equal and we have W1 = W2 = 1/2 and also  = 1/2. Various  values and their impacts are to be investigated later on. Numerical and simulation results for all the proposed algorithms are to be presented and evaluated in Chapter 5.

42

Chapter 5 Simulation Results and Numerical Analysis
Now that the load allocation algorithms have been presented, such algorithms are tested for real power consumption data which can be obtained through smart grid infrastructure. In this section, we first introduce our hard load dataset, followed by our PHEVs representing three different PHEV models on the market at the time of this work. We further give numerical results for different proposed power allocation algorithms. Mean-Square Error (MSE) is set to be our main numerical measurement. Numerical results are coupled with simulation results where their effectiveness can be more apparent. Single-PHEV load allocators and Multi-PHEV scheduling schemes are analysed independently.

5.1

Realistic Datasets

In our approach, we have chosen to use realistic data instead of probabilistic and randomized datasets. By doing so, we will evaluate our algorithm in a more pragmatic situation which will provide us with more authentic insights. Such data consists of realistic battery information and hard load datasets, which are presented in the following.

43

Table 5.1: Battery information PHEV Model BMW i3 Nissan Leaf Chevy Volt Cn (kWh) 22 30 18.4  80% 75% 85% Smax (kW) 3.5 3.5 3.5

5.1.1

Realistic PHEV Information

There are several PHEV manufacturers in the industry, while they all adopt similar Lithiumion technology in their battery packs. Several consumer-level PHEVs ranging between different price points have been listed in 5.1, along with their nominal capacity, charging efficiency and their maximum charging rate. Such information is obtained from [29]. These realistic information are to be utilized as the assigned additive loads to the system.

5.1.2

Realistic Hard Load Data-Set

The realistic non-PHEV power consumption for a household obtained from [30], which has a similar overall shape to Fig. 2.1, is illustrated in Fig. 5.1. Fig. 5.1 represents the real average household power consumption from January to August 2008, obtained from [30]. This data-set is further smoothened by applying a 9-th order SavitzkyGolay filter. Furthermore, data set is time-shifted by 10 hours, so that the power consumption of a working day would be considered in our system. Such changes are applied and results are displayed in Fig. 5.2. In order to expand the datasets for our algorithms, we obtain the average power consumptions for the first 7 months of year 2008, each assumed to represent demand curve of different households which will be later used in multi-PHEV algorithms. Our multi-hard-load demand curve is 44

Power Consumption (KW)

35 30 25 20 15 10 5 0 3 6 9 12 15 18 21 24

Time of day (hours)

Figure 5.1: Real non-PHEV power consumption of a household
40

Power Consumption (KW)

30

20

10

0 10

12

15

18

21

0

3

6

9

10

Time of day (hours)

Figure 5.2: Smoothened and time-shifted non-PHEV power consumption of a household illustrated in Fig. 5.3.
60
January February March April May June July

Power Consumption (KW)

50

40

30

20

10

0 10

12

15

18

21

0

3

6

9

10

Time of day (hours)

Figure 5.3: 7 Months of non-PHEV power consumption sample

45

5.2

Simulation Results for Single PHEV Load Allocation Algorithms

Our proposed algorithms can be evaluated now that realistic data sets are obtained. In this section, we aim to evaluate different proposed single PHEV load schedulers. Nissan Leaf is considered to be the primary PHEV model used through this section. As proposed in 4.2, SLA algorithm only requires total energy demand, hard load information of the household and valid time-window limitations to perform load allocation. Energy requirements (PT ) of a particular PHEV in general case can be calculated as PT = [SOCmax - SOCmin ] × Cn ×  -1 (5.1)

where recommended SOCmin and SOCmax values of a Lithium-ion battery were defined as 20% and 90% respectively in 4.1. Moreover, nominal capacity Cn and charging efficiency  of target PHEV can be obtained from Table 5.1. In addition, non-PHEV power consumption represented in Fig. 5.2 is assumed as hard load data. Valid time-window for this system is assumed to be 6-pm to 8-am where most NorthAmericans arrive to and depart from their households. Fig. 5.4 shows the power allocation without using any coordinated charging algorithm. In this manner, the vehicle starts charging upon arrival with constant power level. Such approach distinctly raises the peak power consumption from 34.5 kW to 38.5 kW as seen in Fig. 5.4(a) which is extremely hazardous and costly for the power grid. In contrast to uncoordinated charging scheme, Fig. 5.5 represents the power allocation results of a PHEV utilizing SLA algorithm as proposed in 4.2. Total household power consumption is portrayed in Fig. 5.5(a) while PHEV charging pattern is illustrated in Fig. 5.5(b). It's evident that SLA algorithm is automatically shifting the energy requirements of the PHEV 46

Power Consumption (KW)

40
Total Power Consumption Non-PHEV Power Consumption

30

20

10

0 10

12

15

18

21

0

3

6

9

10

Time of day

(a) Total Power Consumption under uncoordinated charging
5

Power Consumption (KW)

4 3 2 1 0 10

12

15

18

21

0

3

6

9

10

Time of day

(b) PHEV Power Consumption under uncoordinated charging

Figure 5.4: Results of power allocation for a single PHEV without using SLA to over-night hours where the non-PHEV power consumption is at its lowest, while it is allowed to allocate the power to any time in the valid time window of [6-pm , 8-am]. As predicted in 4.4.1, a non-uniform PHEV charging pattern was expected to be achieved whilst applying SLA algorithm. Moreover, the peak power consumption has not increased, which was one of many intentions upon proposing the algorithm. In order to observe the performance enhancement proposed in 4.4.1, we apply mSLA algorithm to the same dataset in the same time frame. The power allocation results under mSLA algorithm are portrayed in Fig. 5.6. It is apparent that mSLA has certainly regulated the PHEV power consumption by comparing Fig. 5.5(b) and 5.6(b). On the other hand, the flatness of total power consumption is distorted 47

Power Consumption (KW)

35 30 25 20 15 10 5 10
Total Power Consumption Non-PHEV Power Consumption

12

15

18

21

0

3

6

9

10

Time of day

(a) Total Power Consumption while utilizing SLA
Power Consumption (KW)
6 5 4 3 2 1 0 10

12

15

18

21

0

3

6

9

10

Time of day

(b) PHEV Power Consumption while utilizing SLA

Figure 5.5: Results of power allocation for a single PHEV using SLA and the ideal flat line is not achieved while applying mSLA. The effectiveness of mSLA is more appreciable when coupled with power allocation for multiple PHEVs. MSE values on each algorithm can be good representatives of their corresponding numerical advantages. The error value is to be calculated independently for PHEV charging power and household's total power consumption. The MSE values for above-mentioned algorithms are to be calculated according to (5.2) and be presented in Table 5.2.

48

35

Power Consumption (KW)

30 25 20 15 10 5 10 12 15 18 21 0

Total Power Consumption Non-PHEV Power Consumption

3

6

9

10

Time of day

(a) Total Power Consumption while utilizing mSLA
5

Power Consumption (KW)

4 3 2 1 0 10

12

15

18

21

0

3

6

9

10

Time of day

(b) PHEV Power Consumption while utilizing mSLA

Figure 5.6: Results of power allocation for a single PHEV using mSLA

1 = T µ= 1 T
T

T

s (k )  M SEP HEV
k=1

s

1 = T

T

ss ( k ) - 
k=1 T

2

hs (k ) + ss (k )  M SEHOU SE =
k=1

1 T

hs (k ) + ss (k ) - µ
k=1

2

(5.2)

We can observe how MSE value for total power consumption drops to zero by using SLA algorithm, while PHEV's MSE value increases. By applying the upper bound constraint to the system and utilizing mSLA algorithm, PHEV's MSE value drops further while maintaining lowvariation levels on total power consumption as it can be concluded from M SEHOU SE value on mSLA algorithm. In order to shed more light on consumer's needs, DTSLA algorithm is proposed. As mentioned 49

Table 5.2: Mean-Square Error values for Single-PHEV schedulers Scheduling Scheme M SEP HEV M SEHOU SE Uncoordinated 0 56.72 SLA 1.94 0 mSLA 0.49 1.39

earlier, having W1 information is sufficient for the algorithm to perform, while we still discuss the algorithm in terms of  because of the mid-level insight it gives us. By varying  values and also utilizing (4.30), W1 and W2 values are obtained. It is worth noting that while weights W1 and W2 remain normalized,  is the ratio that changes the focal point. Evidently  = 0 leads to W1 = 1 and therefore DTSLA algorithm is converted back to mSLA algorithm. Various  values results in different weight values which would follow the behaviour predicted in Fig. 4.3 and thus yields to different weight values which would directly affect the algorithm. Each  value leads to a different system definition, where the corresponding PHEV energy requirements get distributed via DTSLA algorithm. Hence power allocation for each different system provokes distinct PHEV power consumption and household power consumption MSE values. On the same note, each -related system would bring in a different objective function value with regards to (4.23). In our work, a variety of  values were examined and the best results emerged when   [0, 2]. Therefore, such values of  were investigated and their subsequent numerical values on W1 , M SEP HEV , M SEHouse and objective function value g are obtained and presented in Table 5.3. As presented in Table 5.3, M SEP HEV and M SEHOU SE values are on the rise as  increases. While at the same time, the objective function value in (4.23) achieves a minimum value of 1.232 at  = 0.5. This is considered the optimum point as described by the objective function (4.23). The relative trend of M SEP HEV , M SEHOU SE and objective function value g is portrayed in Fig. 5.7.

50

Table 5.3: Numerical results of DTSLA algorithm while varying   0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0 1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9 2.0 W1 1.0 0.9091 0.8333 0.7692 0.7143 0.6667 0.6250 0.5882 0.5556 0.5263 0.5000 0.4762 0.4546 0.4348 0.4167 0.4000 0.3846 0.3704 0.3571 0.3448 0.3333 M SEP HEV 0.495 0.496 0.582 0.528 0.590 0.590 0.620 0.645 0.640 0.693 0.715 0.764 0.785 0.856 0.921 1.097 1.162 1.262 1.288 1.328 1.359 M SEHOU SE 1.398 1.409 1.436 1.457 1.519 1.553 1.620 1.696 1.754 1.889 2.003 2.174 2.314 2.576 2.858 3.464 3.852 4.396 4.768 5.235 5.739 g 1.398 1.326 1.285 1.242 1.254 1.232 1.245 1.263 1.259 1.322 1.359 1.436 1.480 1.604 1.728 2.044 2.197 2.423 2.531 2.676 2.819

51

6
MSE
PHEVs

MSE and Objective Function Values

5

MSE HOUSE g

4

3

2

1

0 0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 2



Figure 5.7: Post-DTSLA Scheduler M SEP HEV , M SEHOU SE and g values while varying  To better visualize the different cases of , the power allocation for three values of  = 0.5, 1, 1.5 are represented in Fig. 5.8 , Fig. 5.9 and Fig. 5.10 respectively. By comparing the optimal values achieved through DTSLA algorithm and MSE values attained through mSLA algorithm, mSLA algorithm evidently outperforms the DTSLA algorithm. M SEHOU SE value achieved through mSLA is 1.39 while the corresponding value to minimal overall objective function would be 1.553. The same conclusion can be driven for M SEP HEV values where mSLA results in 0.49 while optimal DTSLA results in 0.59. Hence we can conclude that mSLA algorithm is a better choice with respect to MSE values while applying the proposed methods to single-PHEV system. Multi-PHEV systems require more sophistication, thus the proposed methods would be tested under more pressure in the following section.

52

35

Power Consumption (KW)

30 25 20 15 10 5 10 12 15 18 21 0

Total Power Consumption Non-PHEV Power Consumption

3

6

9

10

Time of day

(a) Total Power Consumption while utilizing DTSLA when  = 0.5
5

Power Consumption (KW)

4 3 2 1 0 10

12

15

18

21

0

3

6

9

10

Time of day

(b) PHEV Power Consumption while utilizing DTSLA when  = 0.5

Figure 5.8: Results of power allocation for a single PHEV utilizing DTSLA when  = 0.5

5.3

Simulation Results for Multiple PHEV Load Allocation Algorithms

As stated in 4.3, power allocation can be performed in a residential area where multiple households are connected to an LVT, each of which has a PHEV and therefore an additive load. In our work, 5 households are considered to be the target LVT-connected neighbourhood. MLA algorithm requires PHEV parameters such as energy requirements and valid time window and also household information namely hard load data. Each of these households' information are presented in terms of their PHEV model, SOC upon arrival, the hard load dataset used with regards to Fig. 5.3, maximum cumulative power consumption Hmax and valid time window dictated by arrival and departure times. Vehicle information such as battery capacity, charging efficiency and maximum 53

35

Power Consumption (KW)

30 25 20 15 10 5 10 12 15 18 21 0

Total Power Consumption Non-PHEV Power Consumption

3

6

9

10

Time of day

(a) Total Power Consumption while utilizing DTSLA when  = 1
5

Power Consumption (KW)

4 3 2 1 0 10

12

15

18

21

0

3

6

9

10

Time of day

(b) PHEV Power Consumption while utilizing DTSLA when  = 1

Figure 5.9: Results of power allocation for a single PHEV utilizing DTSLA when  = 1 charging power Smax for each PHEV is attainable by looking up the information of each PHEV model from Table 5.1. Total energy requirements of each PHEV is calculated according to the vehicle information and (5.1). Fig. 5.11 portrays the uncoordinated power allocation when no scheduling mechanism is utilized. In the unscheduled case, PHEVs are to start charging upon their arrival ta . The charging stops as the total allocated power reaches PT . The dramatic effects of unscheduled charging on the peak power consumption are noticeable in Fig. 5.11(a) where the peak power consumption has risen compared to the non-PHEV demand value. This issue is resolved via MLA algorithm. Fig. 5.12 portrays the total power consumption and PHEVs power consumptions while MLA algorithm is in effect. This mechanism not only prevents additive peak power consumption, in

54

35

Power Consumption (KW)

30 25 20 15 10 5 10 12 15 18 21 0

Total Power Consumption Non-PHEV Power Consumption

3

6

9

10

Time of day

(a) Total Power Consumption while utilizing DTSLA when  = 1.5
5

Power Consumption (KW)

4 3 2 1 0 10

12

15

18

21

0

3

6

9

10

Time of day

(b) PHEV Power Consumption while utilizing DTSLA when  = 1.5

Figure 5.10: Results of power allocation for a single PHEV utilizing DTSLA when  = 1.5 contrast with uncoordinated scheduling, but also manages to flatten the total power consumption as illustrated in Fig. 5.12(a). Furthermore, Fig. 5.12(b) shows the way that total energy requirements of individual PHEVs are met. Although MLA algorithm addresses the additive peak power consumption issue and also flattens the demand curve, it requires minor adjustment in order to make its performance closer to reality. By analysing Fig. 5.12(b), two distinct issues discussed in 4.3 are noticeable. Firstly, P HEV1 's energy needs are clearly being scheduled before all other PHEVs. This conclusion is driven by investigating P HEV1 's power consumption pattern and hard load pattern, revealing that P HEV1 's power consumption is filling the valley present in hard load. This motif replicates itself for P HEVi s as i grows, filling the remained of the valley. The second issue arises from the reality that there exists an upper limit to PHEV charging power dictated by battery's physical structure. 55

Table 5.4: PHEV information P HEVi #1 #2 #3 #4 #5 Model BMW i3 Chevy Volt Nissan Leaf Nissan Leaf Chevy Volt SOC 20% 40% 30% 20% 30% Hmax 50 50 50 50 50 h(t) Jan Feb Mar Apr May ta 6 pm 6 pm 5 pm 8 pm 10 pm td 8 am 7 am 8 am 7 am 9 am

While it is apparent that no upper limit is being applied on P HEV1 's charging pattern. Such modifications are applied to the MLA algorithm by distinct steps, as presented in 4.4.2 through pmMLA1 and pmMLA2 algorithms and leading to the final mMLA algorithm. The power allocation results of applying pmMLA1 and pmMLA2 algorithms to the same dataset, are presented in Fig. 5.13 and Fig. 5.14. By contrasting Fig. 5.13(a) and Fig. 5.12(a) we can observe how the overall power consumption is not disturbed while comparison of Fig. 5.12(b) and Fig. 5.13(b) individual PHEV power consumption shows the drastic changes when the upper-bound power constraints are applied. The beneficial effects of applying upper-bound power constraints are illustrated more effectively when it is applied it to multi-PHEV scenario, compared to single-PHEV power allocation results of mSLA algorithm illustrated in Fig. 5.6. Furthermore, by comparing Fig. 5.12(a) and Fig. 5.14(a) we notice that the priority function has no effect on the total power consumption. At the same time by contrasting Fig. 5.12(b) and Fig. 5.14(b) we can observe how the priority function gives higher priority to P HEV4 due to its energy requirements and time limitations. Fig. 5.15 illustrates the coalesced impact of upper-bound power constraint and priority function working simultaneously. By fusing these two features to a sole algorithm, mMLA algorithm emerges. The results of 56

250
Total Power Consumption Non-PHEV Power Consumption

Power Consumption (KW)

200

150

100

50

0 10

12

15

18

21

0

3

6

9

10

Time of day

(a) Total Power Consumption under uncoordinated charging
5
PHEV #1 PHEV #2 PHEV #3 PHEV #4 PHEV #5

Power Consumption (KW)

4

3

2

1

0 10

12

15

18

21

0

3

6

9

10

Time of day

(b) PHEV Power Consumption under uncoordinated charging

Figure 5.11: Results of power allocation for multiple PHEVs under uncoordinated charging mMLA algorithm are illustrated in Fig. 5.15. It is perceivable from Fig. 5.15(a) how the dip in the overall demand curve is being filled with PHEV energy requirements while a steady and flat-like curve is achieved. The elegancy of mMLA algorithm is further illustrated when Fig. 5.15(b) is inspected. By examining Fig. 5.15(b) we easily observe how energy requirements of P HEV4 is put forward against other PHEVs because of its high energy demand (PT4 ) and small time window (T4 ) as defined in Table 5.4. It is noteworthy that 57

200 180
Total Power Consumption Non-PHEV Power Consumption

Power Consumption (KW)

160 140 120 100 80 60 40 20 10 12 15 18 21 0 3 6 9 10

Time of day (hours)

(a) Total Power Consumption after MLA
12
PHEV #1 PHEV #2 PHEV #3 PHEV #4 PHEV #5

10

Power Consumption (KW)

8

6

4

2

0 10

12

15

18

21

0

3

6

9

10

Time of day (hours)

(b) PHEV Power Consumption after MLA

Figure 5.12: Results of power allocation for multiple PHEVs using MLA this algorithm as presented in 4.4.2, is applicable to any set of PHEV models, while it would still follow the respective upper bound limits and corresponding priority values in PHEV scheduling queue. Similar to Section 5.2, numerical MSE values provide a better insight to compare the proposed algorithms. Table 5.5 represents the MSE values. M SEP HEV s represents the mean MSE value for all PHEVs while M SELV T describes the MSE value for the total hard load. Both values are 58

200 180
Total Power Consumption Non-PHEV Power Consumption

Power Consumption (KW)

160 140 120 100 80 60 40 20 10 12 15 18 21 0 3 6 9 10

Time of day (hours)

(a) Total Power Consumption after pmMLA1
4.5 4
PHEV #1 PHEV #2 PHEV #3 PHEV #4 PHEV #5

Power Consumption (KW)

3.5 3 2.5 2 1.5 1 0.5 0 10

12

15

18

21

0

3

6

9

10

Time of day (hours)

(b) PHEV Power Consumption after pmMLA1

Figure 5.13: Results of power allocation for multiple PHEVs using pmMLA1

59

200 180
Total Power Consumption Non-PHEV Power Consumption

Power Consumption (KW)

160 140 120 100 80 60 40 20 10 12 15 18 21 0 3 6 9 10

Time of day (hours)

(a) Total Power Consumption after pmMLA2

10

Power Consumption (KW)

8

PHEV #1 PHEV #2 PHEV #3 PHEV #4 PHEV #5

6

4

2

0 10

12

15

18

21

0

3

6

9

10

Time of day (hours)

(b) PHEV Power Consumption after pmMLA2

Figure 5.14: Results of power allocation for multiple PHEVs using pmMLA2

60

200 180
Total Power Consumption Non-PHEV Power Consumption

Power Consumption (KW)

160 140 120 100 80 60 40 20 10 12 15 18 21 0 3 6 9 10

Time of day (hours)

(a) Total Power Consumption after mMLA
4.5 4
PHEV #1 PHEV #2 PHEV #3 PHEV #4 PHEV #5

Power Consumption (KW)

3.5 3 2.5 2 1.5 1 0.5 0 10

12

15

18

21

0

3

6

9

10

Time of day (hours)

(b) PHEV Power Consumption after mMLA

Figure 5.15: Results of power allocation for multiple PHEVs using mMLA calculated with regards to (5.3).

61

Table 5.5: Mean-Square Error values for multi-PHEV schedulers Scheduling Scheme M SEP HEV s M SELV T Uncoordinated 0 2750.75 MLA 0.8165 0 mMLA 0.5665 4.9343

1 i = Ti

Ti

ss i (k )
k=1

 M SEP HEVi

1 = Ti

Ti

ss i (k )
k=1 N

- i

2

 M SEP HEV s

1 = N

N

M SEP HEVi
i=1

TT = max(Ti ), sT (k ) =
i=1

ss i (k ),

i = 1, . . . , N, k = 1, . . . , TT 1 TT
TT s hs T (k ) + sT (k ) - µT k=1 2

µT =

1 TT

TT s hs T (k ) + sT (k )  M SELV T = k=1

(5.3)

It is noteworthy that in the uncoordinated power allocation, total power consumption's peak value increases from 191 kW to 205 kW, while the peak power consumption is decreased to its original value through all the proposed coordinated charging schemes. On the other hand, maximum post-scheduling PHEV power consumption via MLA is 9.27 kW which is an undesirable expense. This value is restrained through the upper bound constraint in mMLA algorithm. In pursuance of consumer-focused algorithms, DTMLA is proposed in 4.5.2. By normalizing weights and varying  values, different versions of DTMLA algorithm emerge. Diverse  values were inspected and sub-optimal results emerged when   [0, 4]. The overall trends on MSE value and objective function pattern are illustrated in Fig. 5.16(a) which portrays M SEP HEV s and g against  and Fig. 5.16(b) illustrating M SELV T and g against . By analysing the emerging results from DTMLA algorithm for varying  values, we observe that M SEP HEV s value drops below 0.5 when   [0.4, 1.8], which is an assumed desirable meansquare error region. Furthermore, M SEP HEV s reaches a minimum value of 0.4711 at  = 0.7 and  = 0.9, where (M SELV T , g ) values are (5.4568, 3.4039) and (5.7007, 3.2235) respectively. 62

5 4.5
MSE PHEVs g

MSE and Objective Function Values

4 3.5 3 2.5 2 1.5 1 0.5 0 0 0.5 1 1.5 2 2.5 3 3.5 4



(a) Post-DTMLA Scheduler M SEP HEV s and g values against varying 
16
MSE
LVT

MSE and Objective Function Values

14

g

12

10

8

6

4

2 0 0.5 1 1.5 2 2.5 3 3.5 4



(b) Post-DTMLA Scheduler M SELV T and g values against varying 

Figure 5.16: Post-DTMLA Scheduler Mean Square Error and Objective Function values against varying  Absolute minimum value of g is achieved when  = 1.7, where M SEP HEV s , M SELV T and g values are 0.4864, 7.2807 and 3.0028 respectively. By assuming g < 3.1 as the targeted low-error region,   [1.4, 2.1] values would all qualify for such resolution.

63

It is notable that M SELV T follows a monotonically increasing trend, which is undesirable, but rather foreseeable. Intuitively, changing the focal point of the system from grid's requirements to consumer's needs would increase the error value and bring about unpleasant consequences on the grid's side. By finding the intersection of  values where M SEP HEV s and g values are in the targeted region, we would have the following.   [0.4, 1.8]    [1.4, 2.1]    [1.4, 1.8]  W1  [0.3571, 0.4167] (5.4)

Therefore, we can conclude that   [1.4, 1.8] region is a desirable  range for DTMLA weight values. Numerical results of   [0.5, 2] region on W1 , M SEP HEV s , M SELV T and Objective Function Value g are showcased in Table 5.6. The algorithm itself, would result in  = 1.7 where g is minimum, which is included in our proposed desirable  region. Furthermore, to visualize different  values and their effects on power allocation, certain  values are chosen and their respective power allocation results are portrayed in Figs. 5.17 - 5.26. Fig. 5.18 represents the power consumption trends for minimum M SEP HEV case, while Fig. 5.21 illustrates the power consumption behaviour when g is at its minimum value. By examining the PHEV power consumption of different  values, we can monitor how the charging power trend smoothens as  grows. This predictable behaviour is caused by focusing on consumers' requirements and aiming to flatten the charging power.

64

Table 5.6: Numerical results of DTMLA algorithm while varying   0.5 0.6 0.7 0.8 0.9 1.0 1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9 2.0 W1 0.6667 0.6250 0.5882 0.5556 0.5263 0.5000 0.4762 0.4545 0.4348 0.4167 0.4000 0.3846 0.3704 0.3571 0.3448 0.3333 M SEP HEV s 0.4890 0.4782 0.4711 0.4766 0.4711 0.4720 0.4754 0.4825 0.4873 0.4869 0.4848 0.4885 0.4864 0.4957 0.5016 0.4987 M SELV T 5.4157 5.4360 5.4568 5.6680 5.7007 5.9449 5.9840 6.2517 6.5329 6.5900 6.8954 7.2121 7.2807 7.6260 7.9862 8.0697 g 3.7734 3.5769 3.4039 3.3607 3.2235 3.2085 3.0985 3.1049 3.1158 3.0299 3.0490 3.0745 3.0028 3.0422 3.0825 3.0224

65

200 180
Total Power Consumption Non-PHEV Power Consumption

Power Consumption (KW)

160 140 120 100 80 60 40 20 10 12 15 18 21 0 3 6 9 10

Time of day (hours)

(a) Total Power Consumption while utilizing DTMLA when  = 0.5
4.5 4
PHEV #1 PHEV #2 PHEV #3 PHEV #4 PHEV #5

Power Consumption (KW)

3.5 3 2.5 2 1.5 1 0.5 0 10

12

15

18

21

0

3

6

9

10

Time of day (hours)

(b) PHEV Power Consumption while utilizing DTMLA when  = 0.5

Figure 5.17: Results of power allocation for multiple PHEVs utilizing DTMLA when  = 0.5

66

200 180
Total Power Consumption Non-PHEV Power Consumption

Power Consumption (KW)

160 140 120 100 80 60 40 20 10 12 15 18 21 0 3 6 9 10

Time of day (hours)

(a) Total Power Consumption while utilizing DTMLA when  = 0.7
4.5 4
PHEV #1 PHEV #2 PHEV #3 PHEV #4 PHEV #5

Power Consumption (KW)

3.5 3 2.5 2 1.5 1 0.5 0 10

12

15

18

21

0

3

6

9

10

Time of day (hours)

(b) PHEV Power Consumption while utilizing DTMLA when  = 0.7

Figure 5.18: Results of power allocation for multiple PHEVs utilizing DTMLA when  = 0.7

67

200 180
Total Power Consumption Non-PHEV Power Consumption

Power Consumption (KW)

160 140 120 100 80 60 40 20 10 12 15 18 21 0 3 6 9 10

Time of day (hours)

(a) Total Power Consumption while utilizing DTMLA when  = 1
4.5 4
PHEV #1 PHEV #2 PHEV #3 PHEV #4 PHEV #5

Power Consumption (KW)

3.5 3 2.5 2 1.5 1 0.5 0 10

12

15

18

21

0

3

6

9

10

Time of day (hours)

(b) PHEV Power Consumption while utilizing DTMLA when  = 1

Figure 5.19: Results of power allocation for multiple PHEVs utilizing DTMLA when  = 1

68

200 180
Total Power Consumption Non-PHEV Power Consumption

Power Consumption (KW)

160 140 120 100 80 60 40 20 10 12 15 18 21 0 3 6 9 10

Time of day (hours)

(a) Total Power Consumption while utilizing DTMLA when  = 1.5
4.5 4
PHEV #1 PHEV #2 PHEV #3 PHEV #4 PHEV #5

Power Consumption (KW)

3.5 3 2.5 2 1.5 1 0.5 0 10

12

15

18

21

0

3

6

9

10

Time of day (hours)

(b) PHEV Power Consumption while utilizing DTMLA when  = 1.5

Figure 5.20: Results of power allocation for multiple PHEVs utilizing DTMLA when  = 1.5

69

200 180
Total Power Consumption Non-PHEV Power Consumption

Power Consumption (KW)

160 140 120 100 80 60 40 20 10 12 15 18 21 0 3 6 9 10

Time of day (hours)

(a) Total Power Consumption while utilizing DTMLA when  = 1.7
4.5 4
PHEV #1 PHEV #2 PHEV #3 PHEV #4 PHEV #5

Power Consumption (KW)

3.5 3 2.5 2 1.5 1 0.5 0 10

12

15

18

21

0

3

6

9

10

Time of day (hours)

(b) PHEV Power Consumption while utilizing DTMLA when  = 1.7

Figure 5.21: Results of power allocation for multiple PHEVs utilizing DTMLA when  = 1.7

70

200 180
Total Power Consumption Non-PHEV Power Consumption

Power Consumption (KW)

160 140 120 100 80 60 40 20 10 12 15 18 21 0 3 6 9 10

Time of day (hours)

(a) Total Power Consumption while utilizing DTMLA when  = 2
4.5 4
PHEV #1 PHEV #2 PHEV #3 PHEV #4 PHEV #5

Power Consumption (KW)

3.5 3 2.5 2 1.5 1 0.5 0 10

12

15

18

21

0

3

6

9

10

Time of day (hours)

(b) PHEV Power Consumption while utilizing DTMLA when  = 2

Figure 5.22: Results of power allocation for multiple PHEVs utilizing DTMLA when  = 2

71

200 180
Total Power Consumption Non-PHEV Power Consumption

Power Consumption (KW)

160 140 120 100 80 60 40 20 10 12 15 18 21 0 3 6 9 10

Time of day (hours)

(a) Total Power Consumption while utilizing DTMLA when  = 2.5
4.5 4
PHEV #1 PHEV #2 PHEV #3 PHEV #4 PHEV #5

Power Consumption (KW)

3.5 3 2.5 2 1.5 1 0.5 0 10

12

15

18

21

0

3

6

9

10

Time of day (hours)

(b) PHEV Power Consumption while utilizing DTMLA when  = 2.5

Figure 5.23: Results of power allocation for multiple PHEVs utilizing DTMLA when  = 2.5

72

200 180
Total Power Consumption Non-PHEV Power Consumption

Power Consumption (KW)

160 140 120 100 80 60 40 20 10 12 15 18 21 0 3 6 9 10

Time of day (hours)

(a) Total Power Consumption while utilizing DTMLA when  = 3
4.5 4
PHEV #1 PHEV #2 PHEV #3 PHEV #4 PHEV #5

Power Consumption (KW)

3.5 3 2.5 2 1.5 1 0.5 0 10

12

15

18

21

0

3

6

9

10

Time of day (hours)

(b) PHEV Power Consumption while utilizing DTMLA when  = 3

Figure 5.24: Results of power allocation for multiple PHEVs utilizing DTMLA when  = 3

73

200 180
Total Power Consumption Non-PHEV Power Consumption

Power Consumption (KW)

160 140 120 100 80 60 40 20 10 12 15 18 21 0 3 6 9 10

Time of day (hours)

(a) Total Power Consumption while utilizing DTMLA when  = 3.5
4.5 4
PHEV #1 PHEV #2 PHEV #3 PHEV #4 PHEV #5

Power Consumption (KW)

3.5 3 2.5 2 1.5 1 0.5 0 10

12

15

18

21

0

3

6

9

10

Time of day (hours)

(b) PHEV Power Consumption while utilizing DTMLA when  = 3.5

Figure 5.25: Results of power allocation for multiple PHEVs utilizing DTMLA when  = 3.5

74

200 180
Total Power Consumption Non-PHEV Power Consumption

Power Consumption (KW)

160 140 120 100 80 60 40 20 10 12 15 18 21 0 3 6 9 10

Time of day (hours)

(a) Total Power Consumption while utilizing DTMLA when  = 4
4.5 4
PHEV #1 PHEV #2 PHEV #3 PHEV #4 PHEV #5

Power Consumption (KW)

3.5 3 2.5 2 1.5 1 0.5 0 10

12

15

18

21

0

3

6

9

10

Time of day (hours)

(b) PHEV Power Consumption while utilizing DTMLA when  = 4

Figure 5.26: Results of power allocation for multiple PHEVs utilizing DTMLA when  = 4

75

Chapter 6 Conclusion
Over the last decade, significant attention has been given to the PHEV technology. Growing PHEV technology adoption introduces growing concerns regarding load allocation. Such concerns have urged current electrical distribution system to adapt to the new demand. A large scale adoption of PHEV technology will require a smart grid enabled electricity distribution system coupled with embedded charging scheduler in order to avoid colossal damages to the system. Therefore, considering present smart grid enabled infrastructure, demand-side management techniques emerge as a suitable tool to intelligently and efficiently reallocate unscheduled additive load. The main focus of this work is the development of a hybrid DSM technique which enables us to schedule the additive load in a beneficial fashion to both consumer and utility provider. Our proposed scheduling scheme is coupled with GWF method for its accuracy. Our load scheduling scheme is presented in different levels, where single-PHEV and multi-PHEV cases are studied separately. The final achievement of this work is the emergence of dual-target scheduler where consumer and utility provider's satisfaction measures are taken into consideration in forming a singleobjective optimization problem to address both problems. Such mechanism enables us to shift the

76

satisfactory-focal-point between two parties which would further increase the dynamism of our proposal. This mechanism can also be expanded to larger scales and larger neighbourhoods due to its modular nature. The contributions of this work are to be touched upon in the next section, followed by suggested directions for future studies on the subject.

6.1

Main Contributions

The main contributions of our work are as follows:

1. The ground work of DSM algorithms is discussed, coupled with water-filling approaches which are mostly utilized in RRA application. Such link is established between these two analogies by proving how they can result in the similar solution when convex optimization techniques like Lagrangian Multiplier are applied. Furthermore, GWF is introduced to be the primal methodological choice solving the DSM optimization problem. GWF analogy is explained in detail followed by its proposed solution to the DSM problem. 2. A load scheduling method is proposed, aiming to fully flatten the demand profile while consumer's energy requirements are met. This algorithm focuses on presenting the utility provider with an elastic and predictable load, resulting in a flat demand curve. Such characteristics are advantageous to the utility company since the predictability will help to decrease the energy cost and will also prevent unwanted CO2 emissions. On the other hand, our proposed algorithm will ensure consumer's satisfaction by delivering a fully charged vehicle by the dictated departure time integrated into the algorithm. 3. Previous work is expanded to a multi-PHEV scenario where multiple households are connected to an LVT. In such case, each individual household possesses independent energy requirement and time constraint. This extension is possible through developing a mapping 77

method in order to utilize 2-D GWF approach in the 3-D DSM system definition. This algorithm resulted in a scheduler, capable of allocating loads of multiple PHEVs across a neighbourhood to have their demands met, while a flat line with no deviation is maintained for the utility provider. 4. Both Single-PHEV and Multi-PHEV algorithm are further enhanced through introducing new and realistic constraints. By including upper bound constraints on charging power and household power consumption, a regulatory feature is added to the system which made it closer to reality and hence, more practical. Furthermore, a priority function is introduced to detect the urgency between different consumers' requirements and then decide which consumer gets scheduled first. This feature increases the fairness of the algorithm while making it robust to sudden and harsh consumer demands such as high energy requirements in short time windows. 5. A novel dual-target approach is proposed by fusing total demand flatness feature with charging power minimal-deviation trait. This fusion results in a new system model where two weights are introduced to balance the equation. These weights also increase the dynamism of the algorithm, making it possible to sweep between consumers' satisfaction and utility provider's needs. All previous characteristics such as upper bound constraints and priority function are also integrated into this scheduling scheme. 6. Realistic data are utilized to produce various numerical and simulation results aiming to acquire the most suitable algorithm for different situations. The mean-square error is chosen to be the candidate numerical evaluator, measuring the effectiveness and therefore flatness of the demand curve on consumer and utility sides. These numerical results are utilized to attain the weights region in which the results with minimal error are acquired. Such favourable regions are the ones with lowest MSE values on both sides of the system model, i.e. consumer and utility company.

78

6.2

Future Works

1. Predictive demand forecasting methods can benefit the simulation results, as they actively predict and adjust the load profile based on random user behaviour. On the same application, a moving horizon analogy can also be integrated into the scheduling scheme enabling the scheduler's flexibility to expand further. 2. The proposed algorithms can be fused with multi-agent system analogy and its application can be investigated on a large urban scale. In such system, the immense computational pressure will evaluate the effectiveness of our proposed scheduler and sample reduction techniques can further benefit the scheduler. 3. Weight values in dual-target system definition are subject to optimization, as they could not be mathematically fine-tuned any further. This issue is due to the fact that there are simply not enough constraints to optimize the weight values upon such basis. Introducing new beneficial constraints on weight values can profit the algorithm and advance the scheduler's performance even further. 4. Randomized user behaviour can potentially benefit the algorithm's robustness if the randomness is designed in a sensible fashion. Randomized behaviour can be produced by a number of different approaches, where only a few of such results would yield a realistic demand model. Such an appropriate randomized non-PHEV energy requirements can evaluate the proposed schedulers on a better resolution and thus enhance their performance further.

79

Appendix A Dual-Target Objective Function Solution
As stated in 4.5, our proposed solution necessitated a method to fuse two objective functions to be minimized. Such objective function fusion is attainable through linear scalarization method. Linear scalarization method allows us to assign weights (Wi ) to each objective function (fi ) and forge a single-objective problem, which can later be resolved through optimization methods of preference. Lets assume objective functions f1 , f2 , . . . fi are to be optimized through linear scalarization method. By denoting g (f ) to be the target single-objective optimization problem, g (f ) can be formulated as g (f ) = W1 × f1 + W2 × f2 + · · · + Wi × fi =
i

Wi fi .

(A.1)

Without loss of generality, we focus on the specific demand side management (DSM) optimization problem where only two objectives are to be achieved. As per as our problem statement in 4.5.1, two targeted objective functions are formulated as
T 2

f1 =
t=1

s(t) + h(t) - µ

(A.2)

80

T

2

f2 =
t=1

s(t) - 

(A.3)

where s(t), h(t) and µ in (A.2) respectively represent soft load, hard load and the reference level on the grid's side of our problem. In (A.3),  represents the ideal charging power flat line on consumer's side. It is noteworthy that f1 symbolizes grid's needs and ideals, while f2 expresses consumer's quintessential goal. By taking (A.1) into account, the new objective function can be written as
2

g (f ) =
i=1

Wi fi = W1 f1 + W2 f2 .

(A.4)

Through expanding the objective function further while adopting primary objective functions (A.2) and (A.3), simplified objective function is formulated as below.
T 2 T 2

W1 min{s(t)}T t=1
t=1

s(t) + h(t) - µ
T

+ W2
t=1

s(t) - 

,

s.t.
t=1

s(t)  PT

1  t  T.

(A.5)

By applying the Lagrungian Multiplier to (A.5), we have
T 2 T 2 T

L s(t),  = W1
t=1

s(t) + h(t) - µ

+ W2
t=1

s(t) - 

-
t=1

s(t) - PT . (A.6)

Obtaining the partial derivative of (A.6) with respect to s(t) and setting it to zero yields in  L s(t),  = 2W1 s(t)
T T T

s(t) + h(t) - µ + 2W2
t=1 t=1

s(t) -  -
t=1



 L s(t),  = 0 s(t)
T


t=1

2W1 + 2W2 s(t) + 2W1 h(t) - 2W1 µ - 2W2  -  = 0.

(A.7)

81

Introducing  and simplifying (A.7) further will result in 2W1 µ - 2W2  -  2W1 + 2W2 W1 s(t) =  - h(t) W1 + W2 =

+

.

(A.8)

^ (t) = Such outcome is analogous to DSM result obtained in (3.7). By denoting h can simply state the solution to (A.5) as ^ (t) s(t) = a - h
+

W1 W1 +W2

· h(t), we

(A.9)

The solution in (A.9) is employed in DTSLA and DTMLA algorithms in 4.5. In pursuance of optimal weight values, differentiations can be driven from (A.6) with respect to weights W1 and W2 and set them to zero. Thus the following equations would emerge.  L=0 W1
T 2

s(t) + h(t) - µ
t=1 T 2

=0

(A.10)

 L=0 W2

s(t) - 
t=1

=0

(A.11)

The equation (A.10) dictates M SELV T = 0, which is a given and a pre-assumed target for the function. On the other hand, (A.11) indicates that M SEP HEV = 0 which is also a pre-assumed goal for the system. Thus, we can conclude that derivation with respect to weights W1 and W2 do not yield any useful results and therefore, cannot be beneficial while obtaining the optimal solution for the system.

82

Bibliography
[1] "Independent Electricity System Operator." http://www.ieso.ca/. Accessed: 201509-30. [2] Y. Mou, H. Xing, Z. Lin, and M. Fu, "Decentralized optimal demand-side management for PHEV charging in a smart grid," IEEE Trans. Smart Grid., vol. 6, no. 2, pp. 726­736, 2015. [3] S. Vandeal, N. Bouck´ e, T. Holvoet, and G. Deconinck, "Decentralized demand side management of Plug-in Hybrid Vehicles in a smart grid," Proc. AAMAS ATES Workshop, 2010. [4] S. Shafiee, M. Fotuhi-Firuzabad, and M. Rastegar, "Investigating the impacts of Plug-in Hybrid Electric Vehicles on power distribution systems," IEEE Trans. Smart Grid., vol. 4, pp. 1351­1360, Sept. 2013. [5] S. Vandeal, B. Claessens, M. Hommelberg, T. Holvoet, and G. Deconinck, "A scalable threeStep approach for demand side management of Plug-in Hybrid Vehicles," IEEE Trans. Smart Grid., vol. 4, pp. 720­728, June 2013. [6] "Electric Vehicle Sales in Canada: March 2016 Update." http://www.fleetcarma. com/ev-sales-canada-2016-q1/. Accessed: 2016-08-01. [7] L. Sanna, "Driving the solution: The Plug-in Hybrid Vehicle." http://www.calcars. org/epri-driving-solution-1012885_PHEV.pdf. Published: Fall of 2005. [8] J. Huang, V. Gupta, and Y. Huang, "Schedling algrithms for PHEV charging in shared parking Lots," American Control Conference, pp. 276­281, June 2012. 83

[9] A. Kulvanitchaiyanunt, V. C. P. Chen, J. Rosenberger, P. Sarikprueck, and W. Lee, "A linear program for system-level control of regional PHEV charging stations," IEEE Trans. Industry Applications, vol. 52, pp. 2046 ­ 2052, May 2016. [10] Q. Dong, D. Niyato, P. Wang, and Z. Han, "The PHEV charging scheduling and power supply optimization for charging stations," IEEE Trans. Vehicular Tech., pp. 566 ­ 580, 2016. [11] K. Mets, R. D'hulst, and C. Develder, "Comparison of intelligent charging algorithms for Electric Vehicles to reduce peak load and demand variability in a distribution grid," IEEE Journal of Communications and Networks, vol. 14, pp. 672­681, Dec. 2012. [12] M. Erol-Kantarci, J. H. Sarker, and H. T. Mouftah, "Analysis of Plug-in Hybrid Electrical Vehicle admission control in the smart grid," IEEE International Workshop on Computer Aided Modelling and Design of Communication Links and Networks, pp. 56 ­ 60, 2011. [13] A. El-Zonkoly, H. Ashour, and A. Ahmed, "Optimal allocation, sizing and energy management of PHEV parking lots in distribution system," International Renewable Energy Congress, pp. 1 ­ 5, 2014. [14] Z. Wei, J. He, M. Zing, and L. Cai, "Utility maximization for electric vehicle charging with admission control and scheduling," Proc. IEEE Intl. Conf. Communications, pp. 661 ­ 666, June 2015. [15] K. Zhou and L. Cai, "A dynamic water-filling method for real-time HVAC load control based on model predictive control," IEEE Trans. Power System., vol. 30, pp. 1405 ­ 1414, Aug. 2014. [16] Y. Kim, J. Kwak, and C. Song, "Dynamic pricing, scheduling and energy management for profit maximization in PHEV charging stations," IEEE Trans. Vehicular Tech., pp. 1 ­ 16, May 2016. [17] R. Yu, J. Ding, W. Zhong, and Y. Liu, "PHEV charging and discharging cooperation in V2G networks - a coalition game approach," IEEE Internet of Things Journal, pp. 578 ­ 589, 2014. 84

[18] Z. Ma, D. S. Callaway, and I. A. Hiskens, "Decentralized charging control of large populations of Plug-in Electric Vehicles," IEEE Trans. on Control Systems Tech., vol. 21, pp. 67­77, Jan. 2013. [19] S. Shao, M. Pipattansomporn, and S. Rahman, "Demand response as a load shaping tool in an intelligent grid with electric vehicles," IEEE Trans. Smart Grid., vol. 2, pp. 67­77, Dec. 2011. [20] M. Shinwari, A. Youssef, and W. Hamouda, "A Water-filling Based scheduling algorithm for the Smart Grid," IEEE Trans. Smart Grid., vol. 3, pp. 710­719, June 2012. [21] D. Li, S. K. Jayaweera, O. Lavrova, and R. Jordan, "Load management for price-based demand response scheduling - a block scheduling model," International Conference on Renewable Energy and Power Quality, 2014. [22] R. G. Gallager, Information Theory and reliable communication. New York: Wiley, 1968. [23] D. P. Palomar and J. R. Fonollosa, "Practical algorithms for a family of waterfilling solutions," IEEE Trans. Signal Processing, vol. 53, pp. 686­695, Feb. 2005. [24] N. Amitay and J. Salz, "Linear equalization theory in digital data transmission over dually polarized fading radio channels," Bell Labs. Tech. J., vol. 63, pp. 2215 ­ 2259, Apr. 1984. [25] J. Yang and S. Roy, "Joint transmitter-receiver optimization for multi-input multi-output systems with decision feedback," IEEE Trans. Inform. Theory, vol. 40, pp. 1334 ­ 1347, Sept. 1994. [26] E. Telatar, "Capacity of multi-antenna gaussian channels," vol. 10, pp. 585 ­ 596, 1999. [27] P. He, L. Zhao, S. Zhou, and Z. Niu, "Water-filling: A geometric approach and its application to solve generalized radio resource allocation problem," IEEE Trans. Wireless Communications, vol. 12, pp. 3637­3647, July 2013.

85

[28] F. Marra, G. Y. Yang, C. Træholt, and E. Larsen, "Demand profile study of battery electric vehicle under different charging options," IEEE Power and Energy Society General Meeting, pp. 1 ­ 7, 2012. [29] "Plug-in Hybrid Electric Vehicles detailed information." http://www.plugincars. com/cars. Accessed: 2016-02-26. [30] "Individual Household Electric Power Consumption Data Set." https://archive. ics.uci.edu/ml/datasets/Individual+household+electric+power+ consumption#, Aug. 2012. Accessed: 2015-Nov-20.

86

