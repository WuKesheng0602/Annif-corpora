Variable versus Constant Flow Performance Investigations for Photovoltaic-Thermal Panels by Tamo Dembeck-Kerekes, BASc in Civil Engineering, University of Toronto, Toronto, Ontario, 2013

A thesis presented to Ryerson University in partial fulfillment of the requirements for the degree of Master of Applied Science in the Program of Building Science

Toronto, Ontario, Canada, 2018 ©Tamo Dembeck-Kerekes 2018

AUTHOR'S DECLARATION FOR ELECTRONIC SUBMISSION OF A THESIS I hereby declare that I am the sole author of this thesis. This is a true copy of the thesis, including any required final revisions, as accepted by my examiners. I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. I understand that my thesis may be made electronically available to the public.

ii

Abstract A quasi-steady-state model has been developed to evaluate of the potential of variable flow strategies to improve the overall thermal efficiency of Photovoltaic Thermal (PVT) collectors. An adaption of the Duffie-Beckman method is used to simulate the PVT in which the overall loss coefficient and heat removal factor are updated at each timestep in response to changes in flow rate and ambient conditions. A novel simulation method was developed to simulate a building heating loop connected to the solar loop via a thermal storage tank or counterflow heat exchanger. The model was validated with published data and with a parallel TRNSYS simulation. The results of the investigation show that optimizing flow rate has significant potential to improve thermal efficiency. This benefit was found to be dependant on ambient and process loop conditions, and was limited to the counterflow heat exchanger case rather than that with a thermal storage tank.

iii

Acknowledgements I am very fortunate to have discovered the building science program at Ryerson, which has helped me develop my passion for building science and energy analysis. The past two years have been an amazing experience, and I will look back on them fondly. Thank you to my supervisor, Jenn McArthur, who has supported and encouraged me through the entire process. I would not have accomplished this feat without her continued drive, giving me direction, and keeping my thesis moving. I am also extremely grateful for my family, who always believed that I would finish my masters, and who have never stopped telling me that I will go on to do great things for the world. Their love and unwavering support have allowed me to reach this point. I hope that I will continue to continue to make them proud. I would also like to thank Jamie Fine for aiding me in my research, and spending countless hours working on the TRNSYS model used to validate my model. I also extend my thanks to his supervisor, Seth Dworkin, who made it possible for me to go to Concordia University and use their solar simulation laboratory.

iv

Table of Contents 1  Introduction ............................................................................................................................. 1  1.1  2  Research Objective and Questions ................................................................................... 4 

Literature Review .................................................................................................................... 5  2.1  2.2  Variable Flow Rate Investigations ................................................................................... 6  Published Solar Panel Models .......................................................................................... 8 

3  4  5  6  7 

Methodology.......................................................................................................................... 13  PVT Collector Model Development ...................................................................................... 15  Model of a Building heating Loop with Thermal Storage..................................................... 23  Model of Building heating with Counter Flow Heat Exchanger ........................................... 35  Model Validation ................................................................................................................... 37  7.1  7.2  PVT Panel Model ........................................................................................................... 37  Heating System Model Validation ................................................................................. 51 

8 

Results ................................................................................................................................... 60  8.1  8.2  8.3  8.4  8.5  House Simulations ­ Thermal Storage ........................................................................... 60  House Simulations ­ Counter Flow Heat Exchanger ..................................................... 64  Optimal Flow Rate Investigation ­ Counter Flow Heat Exchanger............................... 67  Optimal Flow Rate Investigation ­ Thermal Storage Tank ........................................... 71  Optimal Flow Rate Simulation ....................................................................................... 73 

9 

Conclusions ........................................................................................................................... 77 

10  References ........................................................................................................................... 124 

v

List of Tables Table 1 ­ Collector Quality Variables .......................................................................................... 38 Table 2 ­ Simulation Parameters from Chow [13] ....................................................................... 39 Table 3: Thermal Efficiency Characteristics ................................................................................ 42 Table 4- Simulation Parameters from Vokas et al. [16] ............................................................... 41 Table 5 - Simulation Parameters [25] ........................................................................................... 44 Table 6 Test Case Parameters and Results ................................................................................... 47 Table 7: Model Inputs for Volther Powertherm Physical Parameters .......................................... 49 Table 8: PVT Physical Parameters ............................................................................................... 52 Table 9: Analysis Metrics for Constant vs. Optimal Flow Simulations ....................................... 74

vi

List of Figures Figure 1: Reduced Temperature Graph for Apricus Solar Panel [28] .......................................... 11  Figure 2: Methodology Flow Chart .............................................................................................. 13  Figure 3 Typical PVT Panel - Cross Section of Single Pipe Tributary Area [19] ........................ 15  Figure 4: Schematic of the Building heating System Coupled with the PVT System.................. 24  Figure 5: Thermal Storage Tank Schematic ................................................................................. 26  Figure 6: Thermal Storage Steady State Solution Process............................................................ 34  Figure 7: Heat Exchanger Steady State Solution Process ............................................................. 36  Figure 8: Thermal Efficiency vs Flow Rate for Chow [19] and Current Study at g=0.88.......... 40  Figure 9: Electrical Efficiency for Chow [19] and Current Study at g=0.88 .............................. 40  Figure 10: Thermal Efficiency vs Reduced Temperature (Vokas, 2005) and Current Study....... 43  Figure 11: Thermal Efficiency vs Reduced Temperature for Apricus [28] and proposed model 44  Figure 12: Volther Powertherm .................................................................................................... 45  Figure 13: Experimental Set-Up ................................................................................................... 46  Figure 14: Case A (mfr = 103 kg/hr, v = 2.6 m/s, PVT On) Measured vs. Simulated Results .... 49  Figure 15: Case B Conditions (mfr = 43 kg/hr, v = 2.6 m/s, PVT On) - Measured vs. Simulated Results ........................................................................................................................................... 50  Figure 16: Case C Conditions (mfr = 103 kg/hr, v = 5.8 m/s, PVT On ) - Measured vs. Simulated Results ........................................................................................................................................... 50  Figure 17: Case D Conditions (mfr = 103 kg/hr, v = 2.6 m/s, PVT Off) - Measured vs. Simulated Results ........................................................................................................................................... 51  Figure 18: Thermal Performance vs. Reduced Temperature for PVT Panel ................................ 53  Figure 19: TRNSYS System Layout Schematic [36] ................................................................... 53 

vii

Figure 20 - Solar Gain by Month for this model and TRNSYS ................................................... 55  Figure 21: Effect of Reference Ambient Temperature on Thermal Efficiency ............................ 56  Figure 22: Effect of Wind Speed on Thermal Efficiency ............................................................. 57  Figure 23: Example of Tank Node Temperatures and Solar Gains in TRNSYS Simulation ....... 58  Figure 24: Tank Node Temperature and Solar Gains for Sample January Day - Custom Model and TRNSYS ................................................................................................................................ 59  Figure 25: Weather for Sample January Day ................................................................................ 59  Figure 26: Variable Flow and Constant Flow Monthly Solar Gains ............................................ 61  Figure 27: Flow Rate and Solar Gains for a Sample April Day ................................................... 63  Figure 28: Tank Temperature in Variable Flow Simulation for a Sample April Day .................. 63  Figure 29: Tank Temperature in Constant Flow Simulation for a Sample April Day .................. 64  Figure 30: Monthly Solar Heat Gains for Heat Exchanger Simulation ........................................ 65  Figure 31: Effects of Flow Rate on Solar Inlet and Outlet Temperatures and Solar Gains at Timestep 520 ................................................................................................................................. 66  Figure 32: Effects of Flow Rate on Solar Inlet and Outlet Temperatures, and Solar Gains at Timestep 72 ................................................................................................................................... 66  Figure 33: Thermal Efficiency and Loop Heat Capacities vs. Flow Rate. heating Supply Temperature Ranges From 35°C to 70°C, Heating Load 4 MJ/10 mins....................................... 68  Figure 34: Thermal Efficiency and Loop Heat Capacities vs. Flow Rate. heating Supply Temperature Ranges From 35°C to 70°C, Heating Load 8 MJ/10 mins ...................................... 69  Figure 35: Thermal Efficiency and Collector Input/Output Temperatures vs. Flow Rate. heating Supply Temperature Ranges From 50°C, Heating Load 8 MJ ..................................................... 70  Figure 36: Thermal Efficiency vs. Flow Rate Using Different Initial Tank Temperatures .......... 71 

viii

Figure 37: Thermal Efficiency vs. Flow Rate Using Different heating Supply Temperatures .... 72  Figure 38: Thermal Efficiency vs. Flow Rate under Different Solar Irradiances ......................... 72  Figure 39: Monthly Solar Heat Gains for Constant vs. Optimal Flow Rate Strategies with heating Supply Temperature 35°C ............................................................................................................. 75  Figure 40: Monthly Solar Heat Gains for Constant vs. Optimal Flow Rate Strategies with heating Supply Temperature 60°C ............................................................................................................ 75  Figure 41: Thermal Efficiency vs. Flow Rate Using Convergence Values Of: 0.01°C and 0.001 kg/s (A), and 0.001°C and 0.0001 kg/s (B) ................................................................................... 77 

ix

List of Appendicies Appendix A: Common Procedure ................................................................................................. 81  Appendix B: PVT annual simulation with counterflow heat exchanger and constant panel flow rate ............................................................................................................................................... 88  Appendix C: PVT annual simulation with counterflow heat exchanger and variable panel flow rate to achieve constant outlet temperature ................................................................................... 93  Appendix D: PVT annual simulation with counterflow heat exchanger and variable panel flow rate to achieve optimal thermal efficiency .................................................................................... 99  Appendix E: PVT annual simulation with thermal storage tank and constant panel flow rate .. 104  Appendix F: PVT annual simulation with thermal storage tank and variable panel flow rate to achieve a target outlet temperature ............................................................................................. 113 

x

1

Introduction

The impacts of climate change over the past few decades are a source of growing international concern. Climate change has been linked to sea level rise, an increase in severe weather events such as floods, droughts, and heat waves, and global average temperature increase [1]. Atmospheric green house gases (GHGs) are driving climate change, and the Intergovernmental Panel on Climate Change [1] estimates that carbon dioxide emissions from fossil fuels account for 78% of GHG emissions increase from 1970-2010. Solar thermal technologies are part of the solution to reduce GHG emissions by sustainably supplying thermal energy in place of fossil fuel combustion. These technologies can be used for any general process requiring thermal energy, making it a flexible and useful technology beyond typical applications such as space heating and domestic hot water production. A comprehensive analysis of the potential of solar thermal technologies in supplying industrial processes in Cyprus was done by Kalogirou [2]. From his review similar studies, he identified the following industrial processes as the most suitable for integration with solar thermal technologies: "sterilising, pasteurising, drying, hydrolysing, distillation and evaporation, washing and cleaning, and polymerisation". The required supply temperatures for them ranged from 80°C-260°C, and five different solar thermal collector types with varying operating temperature ranges were analysed: flat plate, advanced flat plate, compound parabolic, evacuated tube, and parabolic-trough. TRNSYS was used to simulate the combinations of collector types and process supply temperatures, which were broken into seven equal increments of 30°C ranging from 60°C to 240°C. Optimal collector areas were determined based on the maximum life-cycle savings of the system, and then used to calculate the optimal thermal storage

1

tank volume and overall solar contribution to the process. It was found that collectors with low operating temperature ranges had their financial benefits peak within the first few process temperature increments, showing little improvement as that temperature increased. Conversely, the life-cycle cost savings of the parabolic-trough collectors which operate at high temperature ranges only surpassed the rest of the collector types at process supply temperatures of 120°C, but had the highest potential savings of any collector at the higher supply temperature ranges. In all collector cases, the fraction of process energy supplied by solar was highest at supply temperatures of 60°C, and decreased as the supply temperature increased. This study shows the remarkable potential for a variety of solar thermal technologies to be used in a range of industrial processes. Some specific examples of studies using solar thermal in industrial applications are described below. Deng et al. [3] also point out that different types of solar thermal collectors have varying temperature operating ranges, and the appropriate collector type should be chosen to match the thermal energy grade required for the process it is supplying. They provide a technological framework for using solar thermal for the application of post-combustion carbon dioxide capture. Rabbani and Hooshyar [4] did an experimental study treating wastewater using solar thermal flat plate collectors in Kashan, Iran. The process required that the effluent be kept at 55°C to be disinfected. With 4m2 of flat plate collectors, they were able to treat between 295-361 L/day of effluent depending on the season, and heat to the process could be supplied entirely by solar heat from the flat plate collectors for 55% of the year. Another study by Liu et al. [5] performed field testing using solar thermal flat plate panels to supply hot water to a livestock processing plant in Taiwan. Two independent solar arrays of 123.5m2 and 115.8m2 were installed, both connected to a thermal storage tank (10-ton and 7-ton) and a heat pump to supply auxiliary heat should the 2

tank temperature fall below 50°C. From March 25th-June 30th, the total useful thermal energy collected was 28,441 kWh, or 50.0% of the total energy consumed by the process. They also note that 97.58% of Taiwan's energy supply in 2013 consisted of imported fuel, meaning solar thermal projects displacing the consumption of said fuel will result in significant reductions in GHG emissions. Solar thermal technologies also warrant further investigation based on their global implementation trends. The installed capacity of solar thermal energy continues to increase in response to climate concerns and as the result of research leading to better, more efficient collectors. According to the International Energy Agency ­ Solar Heating & Cooling Programme [6], global solar thermal capacity for water collectors has grown from 62 GW in 2000 to 456 GW in 2016. This corresponds to 130 million tons of CO2 saved in 2016, once again demonstrating the important role of solar thermal in reducing global carbon emissions. Of the available solar thermal technologies available, photovoltaic-thermal (PVT) collectors, which produce both electricity and heat, provide a valuable alternative to both traditional flat plate thermal and photovoltaic collectors for renewable energy generation. If the thermal energy captured can be applied as useful energy, the overall system efficiency of PVT is often higher than that of a combination of PV and solar thermal panels occupying the same total area. PVTs have been the topic of substantial ongoing research, and have led to advances in panel construction, system operation techniques, and new applications [7, 8, 9]. This thesis contributes to this discourse by investigating a control strategy involving the variation of liquid flow rate through the collector to optimize the amount of useful energy obtained.

3

An important and often overlooked aspect of solar thermal collectors is the relationship between collector fluid flow rate, fluid outlet temperature, and thermal efficiency. As the flow rate through the collector increases, the total thermal energy captured increases, but the outlet temperature decreases, resulting in a trade-off between energy quantity and quality produced by the collector. There is a scarcity of research investigating how a variable flow control strategy can be used to optimize the amount of useful energy obtained, and this research gap is addressed by this thesis. 1.1 Research Objective and Questions

The objective of this thesis is to evaluate the potential of variable flow rate control strategies for increased thermal efficiency in PVT collectors. To address the research objective, three lines of inquiry have been carried out: 1. How can variable flow PVT systems be effectively modeled to identify the quantity of useful energy generated? 2. For a given set of heating loads and heating system characteristics, how can the optimal flow rate and its relative performance be determined? 3. How does the type of heat exchange mechanism from the solar collector fluid to the building heating fluid, the presence of thermal storage, and the heating characteristics affect the thermal performance of a variable flow rate control strategy? To answer these questions, a PVT model was developed to accurately predict thermal performance under varying flow rate values between timesteps. The model was expanded to include a building heating loop connected to the solar loop through a heat exchange mechanism. The mechanisms considered in this thesis are a counterflow heat exchanger, and thermal storage

4

tank with internal heat exchanger, the latter of which was simulated using a novel modelling method.

2

Literature Review

The existing body of research regarding PVTs is both extensive and diverse. Investigations include thermal efficiency improvements through both operational strategy [10] and physical panel characteristics [11, 12, 13, 14, 15, 16], novel modelling techniques [17, 18, 19, 20], and case studies for PVT applications [21, 22]. The PVT modelling methods used for these studies are also diverse, each having its own merits and limitations. Models using static thermal efficiency characterizations versus reduced temperature (T between panel inlet and ambient temperatures, divided by incident solar radiation) are useful for determining useful solar heat gains quickly and accurately over extended time periods. This type of characterization can be determined either analytically using the physical panel specifications, or experimentally by using several steady-state points at different reduced temperatures to produce a line of best fit. However, the method lacks flexibility in simulating changing flow rate conditions, can be inaccurate for individual timesteps, and gives limited insight into the thermal behavior of individual panel components. If determined experimentally, they are also limited to a specific panel. Conversely, analytical models use a series of heat balance equations between panel components to determine its performance under a given set of conditions. This type of model can be used to determine the a static reduced temperature efficiency as previously mentioned, and have the flexibility of recalculating it for different operating conditions or changes to the panel itself. They also tend to track the temperatures of the panel components, making them ideal tools

5

for researching novel panel constructions and upgrades. These models can vary greatly in complexity by considering either one, two, or three dimensional heat transfer, the heat capacity of the components, and can be either dynamic or stead-state. As determined by Zondag et al. [23], the average useful solar heat gains over a day are very similar between very simple (1D, steady-state), and very complex (3D, dynamic) models. The complex models allow for more detailed and accurate analysis of the panel in a given moment, and are useful for testing the dynamic effects of rapidly changing operating conditions. However, they require much greater computational power, and are less suited for determining useful solar heat gains over extended time periods. As such, it is imperative that the capabilities and shortcomings of the model are suited the nature of the study. The literature review presented in this thesis focuses on identifying existing work investigating variable flow strategies in liquid based solar thermal collectors, and identifying simulation models and techniques appropriate for testing those strategies.

2.1

Variable Flow Rate Investigations

Varying the collector fluid flow rate allows for the outlet temperature of the fluid from the panel to be controlled for different operating conditions, which can be ideal for supplying building systems such as domestic hot water and space heating. Calise et al. [24] performed a study of a solar tri-generation system using PVTs in which the flow rate through the PVTs was varied to achieve the desired outlet temperature. The target outlet temperature was changed in winter and summer according to the intended use of the solar thermal energy. However, achievement of the target temperature is highly dependant on the climatic conditions, the input temperature requirement of the downstream process, and the size of the solar array. In light of their study it is important to note that under conditions where constant target temperature is not possible or 6

practical, the variation in flow rate can still be optimized to maximize solar heat gains for the particular conditions. This minimizes the need for additional top-up energy to boost the output temperature to the requirement of the target process, and increases the percentage of energy loads met by solar. Limited work has been done to test the effects of differing constant flow rates on annual useful solar thermal heat gains. Kalogiru [25] used TRNSYS to simulate a PVT collector for domestic hot water heating in Cyprus, using six different constant flow rates. It was found that useful energy gain was strongly affected by the flow rate. It increased to a peak, and then decreased steadily to zero thereafter as the flow rate was increased. Similarly, Nualboonrueng et al. [26] simulated a PVT collector for domestic hot water production in Bangkok using TRNSYS. Their results showed a similar trend, wherein the different flow rate values had a significant impact on annual useful energy gain for a given system; while a particular constant flow rate performs better than others aggregated over the course of a year, that flow rate may not be optimal at any given moment within that year. The present work expands upon this observation, presenting a novel modelling technique for PVTs capable of assessing the potential of flowrate changes at each timestep to improve performance at variable current ambient conditions and building loads. An algorithm has been integrated into this novel simulation model that is able to follow control parameters relating to variable flow such as a desired outlet temperature on the scale of individual timesteps.

7

2.2

Published Solar Panel Models

Existing literature was reviewed to select the most appropriate model for accurate PVT performance prediction under varying flow rates. The primary parameters considered were the level of accuracy, adaptability to different operating conditions on the scale of individual time steps, and the level of complexity of the model and associated computational cost. Zondag et al. [23] performed an investigation into the effectiveness of 1D, 2D, and 3D models for predicting yields of PVT collector systems, examining the differences between dynamic and steady-state modelling. The steady-state model determines the thermal conditions when the panel has reached thermal equilibrium, ignoring both the heat capacity of solar panel components and their temperature change over time, while the dynamic model considers the temperatures of the components to be time dependant. When comparing simple steady-state 1D models to complex 3D dynamic models, they found that the average efficiency over the course of a day differed by only 0.2% on a clear day and by 0.0% on a day with highly fluctuating solar radiation. The differences between these two models occurred at the beginning and end of the day due to thermal mass effects considered only in the dynamic model. The solar gains between the two models when simulating only the first three hours of sunlight were 0.8% for the clear day, and 2.3% for the highly fluctuating solar radiation day. Meanwhile the computational cost for these models varied significantly; the time required to simulate one hour varied from 0.05 seconds for the 1D steady-state model to 2.5 hours for the 3D dynamic model. Given the minimal discrepancy between models considering the substantial increase in computational time, it was concluded that simple, steady-state models are appropriate for predicting daily system performance for a given application using hourly time steps.

8

Simple steady-state models are commonly used to characterize collector performance and predict solar energy gains over extended periods of time. The methodology presented by Duffie and Beckman [27] using the Hottel-Whillier-Bliss equation, Eq. (1), provides the basis for the simple steady-state model.  where is the useful heat gain, is the collector aperture area, 1  is the heat removal factor, is the

is the solar irradiance,

is the optical efficiency,

is the overall loss coefficient,

fluid inlet temperature to the solar panel, and

is the ambient temperature. The optical

efficiency and overall loss coefficient constitute the performance characterization of the collector, and are typically considered constant for a particular collector fluid flow rate and ambient wind speed. There is an abundance of research, for example [16, 15, 22, 17], that uses the Hottel-WhillierBliss equation, or a modified version thereof to predict the performance of a PVT system. Vokas et al. [22] calculated the average collector performance as a function of the panel reduced temperature. This characterization was linear with reduced temperature, and was applied using the F-chart method to compare the energy generation potential of a conventional thermal collector to a PVT collector for solar heating and cooling in three cities in Greece. In another study, Ben cheikh el hocine et al. [17] investigated the performance of a PVT collector with a galvanized iron absorber plate, using inlet and outlet temperatures and useful thermal energy as performance indicators. A one-dimensional model using the Hottel-Whillier-Bliss equation was created to simulate the panel, and the model was validated using experimental results. Anderson et al. [15] created a model based on a modified Hottel-Whillier-Bliss equation to investigate the impacts of different panel physical parameters on thermal efficiency. Absorber materials and 9

conductivity, absorber-PV bond conduction, riser tube width, transmittance-absorption product, and insulation thickness were varied and the thermal efficiency was plotted versus reduced temperature. The Duffie-Beckman method was also modified to simulate different amounts of PV coverage over the absorber plate. Finally, Dubey and Tiwari [16] used a modified version of the one-dimensional method to evaluate a new PVT design for standalone hot water heating in New Delhi, including a thermal storage tank that was modeled dynamically. PV modules encased in glass on both sides to replace the glazing cover of a flat plate collector and three different fractions of PV coverage for their collector were investigated. The model developed incorporated a variable transmittance-absorptance product for the collector, which accounted for the changing amount of PV cells shading the absorber plate, with a static heat removal factor and overall loss coefficient for the collectors. The results of their model were validated against experimental data, and their predictions for outlet temperature had a correlation coefficient of above 0.999 when compared to their test data. Together, these papers demonstrate the flexibility and application of the Hottel-Whillier-Bliss equation as used in combination with the DuffieBeckman method to accurately model PVT collector performance. However, there are limitations to how the Duffie-Beckman method and Hottel-Whillier-Bliss are typically used in simulation models. The Hottel-Whillier-Bliss equation is often used to characterize the performance of a collector on a reduced temperature graph, where the y-axis is the thermal efficiency of the collector (c), and the x-axis is the difference in temperature between the collector fluid inlet and the ambient air, divided by the solar irradiance ((Ti-Ta)/G). The efficiency is then characterized by the optical efficiency () multiplied by the heat removal factor (Fr) as the y-intercept. The slope of the line can be considered linear, in which case it is equal to -UlFr. In reality, the overall loss coefficient increases with increasing reduced 10

temperature due to the 4th order relationship with radiative heat loss. This causes the efficiency line to be non-linear, and an additional temperature dependence value for the overall loss coefficient to reduced temperature is often included to account for it. Assuming these values are constant, the efficiency be determined from the ambient temperature, solar irradiance, and fluid inlet temperature at any given point. Figure 1 shows a reduced temperature graph for a solar thermal flat plate collector at a fixed solar irradiance, and using the mean panel fluid temperature rather than inlet temperature.

Figure 1: Reduced Temperature Graph for Apricus Solar Panel [28]

As noted by Touafek et al. [12], this graph is critical as it provides a standard for solar thermal panel experimental testing and performance characterization. However, the performance characterization using a reduced temperature graph is accurate only as long as three variables remain constant. The first and most significant is flow rate. The second and third are wind speed and the ambient reference temperature at which the graph was characterized. The latter two are

11

less significant, although their effects become more pronounced as the reduced temperature increases. The modelling approach presented in this study addresses these limitations by reassessing those parameters each time there is a change in ambient conditions, flow rate, or fluid inlet temperature. This adaptation is significant as it permits the Duffie-Beckman calculation method for solar thermal panels to be used in simulations with variable flow control strategies, addressing the lack of research investigating novel control strategies as well as improving simulation accuracy from its typical adoption at high reduced temperatures.

12

3

Methodology

The methodology used to develop, validate, and integrate the sub-elements in the variable flow models and to use it to test different control strategies is illustrated in Figure 2.

Figure 2: Methodology Flow Chart

13

To carry out the desired investigations, a PVT model capable of operating at any flow rate was needed as the basis of this thesis. Studies involving PVT modelling and simulation were reviewed to select a model capable of that which: 1) has a high degree of accuracy, and 2) has a relatively low computational cost. As discussed in the literature review, the Duffie-Beckman approach is the most commonly used steady-state modelling technique for flat plate collectors and was selected as the basis for this study. Modifications to this technique were developed to allow variable flow rate characterization. Maple 2015 mathematical software [29] was used to code the simulation for both the PVT, the building system, and their interactions. The PVT model was validated using results published in existing literature, solar thermal manufacturer physical specifications and thermal performance data, and lab testing of a real PVT panel in a solar simulator at Concordia University. The model was then expanded to include a primary loop, consisting of the solar array, and secondary loop consisting of the distribution to the building and its return. These interface at either a counter flow heat exchanger, or a thermal storage tank with an internal heat exchanger. A set of equations were then developed to characterize the thermal behavior of the thermal storage tank as was the iterative calculation method used to obtain the steady-state conditions of the full system under a given set of inputs within each time step. The full system model was validated by running identical parallel simulations of a PVT array coupled with a sample house via a thermal storage tank in both the model presented here and with TRNSYS [30]. Both the overall annual solar heat gains and the tank temperature across sample days were compared as part of this validation. Simulations were run for a sample house using a standard constant flow rate strategy, and a variable flow rate strategy requiring a constant outlet temperature. Analysis of individual time 14

steps were conducted for both simulations, and was used to determine a strategy to identify the optimal flow rate at a given time. The simulation was run again using the optimal flow strategy to determine its relative benefit over the constant flow rate strategy. Both simulations were run using different building loads and heating supply temperatures, and the annual total useful heat generation was compared to determine the relative benefit of optimal flow within each scenario.

4

PVT Collector Model Development

The PVT collector used in this model is a flat plate thermal collector with PV laminate attached on top of the absorber plate. The cover glass is included above the PV layer to reduce heat loss, and is offset from the PV layer by a sealed air gap. The fluid pipes used for thermal energy extraction are bonded underneath the absorber plate, and run parallel to each other lengthwise along the collector. A cross section of a typical PVT panel of this type is shown in Figure 3.

Figure 3 Typical PVT Panel - Cross Section of Single Pipe Tributary Area [19]

15

A modified version of the Hottel-Whillier-Bliss equation is used to obtain the instantaneous efficiency of the collector based upon operating conditions. In this modified version, heat removal factors and overall heat loss coefficient are updated at each time step in accordance with the changing flow rate required to achieve a target outlet temperature. Since the loss coefficient increases as the temperature difference between the collector and ambient increases, a non-linear relationship exists between thermal efficiency and reduced temperature. This is primarily due to the 4th-order relationship between radiative heat loss from the absorber and the temperature difference between the absorber and ambient environment. The effect of temperature dependence on heat loss is particularly relevant for the variable flow strategy being proposed, where the panel flow rate will be reduced. This will result in an increase in panel temperature, making the non-linearity of radiative heat loss to temperature relationship is more pronounced. As mentioned in Section 2.2, the overall heat loss coefficient and heat removal factor are also heavily dependent on flow rate, and to a lesser extent wind speed and ambient temperature. Thus, these performance parameters must be updated at each timestep to account for the changes in those critical input conditions. Incoming solar radiation is assumed to be first reduced by optical losses through the cover glass, with the remainder being absorbed by the absorber plate as heat. The overall optical efficiency of the collector is therefore a product of the cover transmittance, and the absorptance of the absorbing surface. Depending on the PV cell packing factor, which is defined as the fraction of the absorber plate area that is covered by PV cells, it may be necessary to obtain an average effective absorptance for the entire area [16]. Therefore, the optical efficiency of the collector is given by the relationship shown in Eq. (2); for simplicity, it does not consider internal reflections between the absorber/PV surface and the cover. 16

(2) where is the transmittance of the cover, and is overall absorption coefficient of the

absorbing surface. A fraction of the solar energy reaching the absorber plate is then converted into electricity by the PV cells, and the amount of electrical energy generation is determined using the PV cell efficiency. This cell efficiency is dependent on the PV cell temperature, and is defined by the characteristics of the cells: 1 where is the electrical efficiency, is the nominal cell electrical efficiency, is the 3

reference temperature,

is the cell temperature, and

is the temperature dependence

coefficient of the cell. In this model, it is assumed that the PV cell temperature is equal to the average absorber plate temperature, which allows for model simplification [19]. The solar energy that is converted to electrical energy is no longer available to become thermal energy, and is subtracted from the incident solar energy [23]. Therefore, the amount of solar energy available for absorption, i.e. able to become thermal energy is expressed by:  The electrical power generated is therefore: (5) Duffie and Beckman use a numerical approach whereby an iterative calculation method is used to determine the collector thermal and electrical output using the system conditions at each time step, which is based on the method presented by Duffie and Beckman [27]. Absorbed heat is 4 

17

either transferred to the cooling fluid as useful thermal energy, or is lost to the environment. To determine the portion of that energy that is useful, the Hottel-Whillier-Bliss equation is used and has been modified to include PV generation: (6) where the overall loss coefficient is the sum of the top, bottom, and side loss coefficients: (7) where
isthetoplosscoefficient,

isthesidelosscoefficient,and

isthebottomloss

coefficient.Thebottomandsidelossesarefunctionsoftheinsulationencasingthe collector,andremainconstantthroughasimulation.Thetoplosscoefficientisafunctionof thethermalresistancebetweentheabsorberplateandtheexternalenvironmentthrough thetransparentsectionofthecollector,andvarieswithflowrateandexternalconditions. Heattransferalongthispathisbrokenintothecomponentmechanismsbetweentheplate, cover,andambientenvironment,whichactasthermalnodes.Thethermalresistance betweenthenodesissummedtoobtainthetotaltoplosscoefficient,whichisshownbythe relationshipinEq. 8 .TheheatlosscoefficientsinW/m2Kforthisequationaredefinedas follows. 1 1
, , ,

1
,

(8)

Convective heat loss between the absorber plate and cover is:

,

(9)

18

Where

is the width of the air gap between them,

is the thermal conductivity of the air which ) is

is assumed to be at the mean of the plate and cover temperatures, and the Nusselt number ( given by the following correlation [27]: 1708 sin 1.8
.

1 where

1.44 1

1

1708 5830

/

1

(10)

is the tilt angle of the collector, the + denotes positive only results (negative results will is the Rayleigh number given by:

be treated as 0), and  where

(11) is the

is the gravitational constant, is the volumetric coefficient of expansion,

kinematic viscosity, and

is the thermal diffusivity. The air temperature used to determine the

kinematic viscosity and thermal diffusivity of the air are assumed to be at the mean between the absorber plate and glass cover temperatures. The radiative heat loss from the plate to the cover is:

,

1

1

1 is the plate temperature, is the cover temperature,

(12)

where

is the Boltzmann constant,

is

the emissivity of the plate, and

is emissivity of the cover.

Convection heat loss due to wind from the cover uses a previously published correlation [31]:
,

2.8

3

(13)

where

is the wind speed.

19

Radiative heat transfer between the cover and ambient is:
,

(14) is the temperature of the sky.

where

The true values of the plate and cover temperatures at steady-state under the conditions being solved for are initially unknown. A numerical technique using iteration is used to determine these values which are interdependent. To begin, an initial guess is made for both the cover and plate temperatures, which are used to calculate the individual heat loss components and the overall loss coefficient as shown in Eqs. (8 -14). At steady-state, the rate of heat transfer between any two nodes is equal to the overall loss coefficient Ul. Keeping the previous guess of the plate temperature constant, this relationship allows for a new cover temperature to be determined based on heat loss coefficients obtained from the current cover temperature guess, which is shown in Eq. (15). This creates a loop wherein new heat loss coefficients are then calculated, and a new cover temperature is determined from them. This process repeats until two consecutive cover temperature values fall within a designated convergence tolerance.

,

,

(15)

The heat removal factor (Fr) is the final parameter required to determine the useful heat gain of the collector, which is the fraction of useful heat gain under a given set of conditions, to the useful gain if the entire absorber plate were at the coolant inlet temperature. As the absorber plate approaches the coolant inlet temperature, the collector approaches the theoretical point of maximum efficiency since a lower plate temperature correlates to lower heat loss to the environment. Therefore, the heat removal factor can also be defined as the ratio of actual heat gain to the maximum theoretical heat gain: 20

1 where is the flow rate, is the heat capacity of the cooling fluid, and ' is the collector

(16)

efficiency factor: 1 1 1 1 1 is the outer diameter of the riser pipes, (17)

where

is the distance between riser pipes,

is the

conductance of the riser to absorber plate bond, and

is the heat transfer coefficient between

the fluid and the interior of the pipes. As suggested by Zondag et al. [23], and Anderson et al. [15], the collector efficiency factor should be modified to include the thermal resistance of the bond between the solar laminate and the absorber plate. Therefore, the heat transfer coefficient of the bond between the absorber plate and PV laminate ( ) was added. is the standard fin

efficiency for tube and sheet solar collectors where the absorber plate cross section is rectangular, calculated as:

tanh 2 where:

2

(18)

(19) denotes conductivity, and thickness, where the subscripts ab and PV represent the absorber

plate and PV laminate respectively. Since a PV laminate has been added to the absorber plate,

21

the M term has been modified to include its thermal conductance in addition to the absorber plate [22]. The numerator in Eq. (17) represents the thermal resistance between the absorber plate and the ambient environment, and the denominator represents that resistance plus that from the fluid to the absorber plate. The physical interpretation of the collector efficiency factor is therefore the ratio between thermal resistance from the absorber plate, and from the fluid itself to the ambient environment. If there were perfect heat conduction from the fluid to the absorber plate, the collector would be perfectly efficient and the collector efficiency factor would equal one. can then be calculated using Eq. (6). However, this value will still be based on the initial guess for the plate temperature. Like the iterative process to find the cover temperature, another iterative loop is created by using the useful heat ( ) calculated from the previous estimate of the

plate temperature and using it to update the plate temperature value using Eq. (20). The new plate temperature then restarts the previous loop to recalculate the cover temperature and associated heat loss coefficients. This process is repeated until two consecutive calculated values for the plate temperature are within a designated convergence tolerance.

1 The useful heat gain determined by Eq. (6) is dependent on

(20) because the solar radiation that is is in turn a function

converted into electricity by the PV is not available to become heat, and of

as shown in Eq. (3). Since these variables are interdependent, an iterative process is used is updated, a new electrical efficiency is determined using Eq. (3), and the

wherein after

22

useful heat gain is re-evaluated using those values with Eq. (6) until the updated plate temperature converges within a specified tolerance. Once all iterative loops have converged, the collector efficiency can be determined as the useful heat collected divided by the amount of solar energy incident on the collector:

(21) where is the collector thermal efficiency, and solar insolation.

The fluid outlet temperature from the panel can be determined using the rate of useful heat gain from the collector, the fluid flow rate, and the fluid heat capacity. The outlet temperature is thus:

(22)

5

Model of a Building heating Loop with Thermal Storage

In order to evaluate the usefulness of the heat collected by the PVT system, a sample heating system with sample heating loads was simulated. One system investigated uses a stratified thermal storage tank with a built-in coil heat exchanger to transfer heat from the solar collector to the building heating loop. The solar (primary) loop working fluid from the PVT array enters the coil in the tank at the top, flows through the coil downward, and exits the tank at the bottom before re-entering the PVT array. The fluid in the tank is directly used by the building heating

23

system, being supplied from the top of the tank, and returning to the bottom of the tank. A schematic is shown in Figure 4.

Figure 4: Schematic of the Building Heating System Coupled with the PVT System

To reduce simulation complexity the heating loop supply and return temperatures are assumed to be constant, and the building heating system uses variable flow to control delivered heat to the building. The flow rate required to meet the space heating load in a given time step is given by:

(23) where is the mass flow rate of the building heating fluid, is the heat capacity of the fluid, is the space heating demand is the heating supply

over the current time step, temperature, and

is the heating return temperature, as shown in Figure 4.

24

When the outlet temperature from the thermal storage tank is greater than required, it is mixed with the return fluid to achieve the desired supply temperature. The required mixed flow rate can then be determined using Eqs. (24-26). (24)





(25)





(26)

where all mass flows and temperatures are shown in Figure 4. When needed, auxiliary heat is added to the building heating loop after the mixing valve if the fluid temperature from the thermal storage tank is below the required supply temperature. The auxiliary heat required in a timestep is calculated by: (27) where is the auxiliary heat added in a timestep, and is the length of the timestep.

The thermal storage tank is assumed to be stratified, and is modelled using two nodes along with an internal coil heat exchanger, as shown in Figure 5. Each of these nodes are assumed to be fully mixed, fluid flow between these nodes is restricted to heating loop flow, and there is no direct heat transfer between nodes. Additional simulations were run with more than two nodes and found negligible change in predicted collector efficiency, thus two nodes was deemed adequate for this model. The heat exchanger coil rests inside the tank, and fluid from the solar 25

loop runs through this heat exchanger from top to bottom to transfer heat into the tank; heating fluid flows in the opposite direction.

Figure 5: Thermal Storage Tank Schematic

An energy balance of each node is carried out for each time step. For the case in which the solar loop is not running, return fluid from the heating system will enter the bottom node, and the fully mixed displaced fluid will move to the top node. This fluid will mix with the existing top node fluid and exit towards the heating supply. Therefore, the thermal energy added to each node is contained in the fluid that enters the node, and the energy removed is the thermal energy contained in the fluid that leaves the node. The change in thermal energy in the node with respect to time is:

(28) where and are the fluid temperatures entering and exiting the node, and and

are the heat capacities of the fluid entering and exiting the node. The flow rate of fluid entering and leaving a node in this system will always be equal so both be referred to as . and will henceforth

26

In reality the temperature of the fluid that leaves each node will change throughout the time step. However, for the purposes of the simulation it is assumed that its temperature is constant, and is equal to the time-averaged mixed temperature of the node throughout the time step. Similarly, it is assumed that the temperature of the fluid entering each node is constant across a time-step as well, using the time-averaged temperature across the timestep if it were to be in fact transient. These assumptions are necessary in order to integrate the thermal storage tank model with the solar model. This is due to the Duffie-Beckman method being a steady-state representation of a solar thermal panel with constant inlet and outlet temperatures for a given set of conditions across a timestep. If the representative constant inlet fluid temperature is known for a given timestep, becomes the only unknown in Eq. (28). It can be solved for by expressing in terms

of the thermal energy contained in the node with respect to time, which is given by:

(29) where is the instantaneous amount of thermal energy in the node , is the mass of the

node, and

is the heat capacity of the heating fluid. Substituting this into Eq. (28) yields:

(30)

Re-arranging, the following linear differential equation is obtained:

(31) This equation is of the form:

(32)

27

where:

(33) and: (34) which has the solution: 1  Where   Substituting, the solution for the amount for thermal energy in a node after time becomes:

 is an integrating factor:

(35)

(36)

(37) Integrating:

(38) where is the integrating constant and is the length of the timestep. Because the amount of 0 based on the

thermal energy in the node is known at the beginning of the time step when previous timestep calculation, C is solved from this condition:

(39) and: 28

(40) Combining Eqs. (38) and (40) gives the solution for the amount of thermal energy in a tank node after time :

(41) Using the relationship between temperature and thermal energy in Eq. (29), the solution for the node temperature after time is:

(42)

For this system,

and

are equal and this simplifies to: (43)



The average node temperature, and thus the average temperature of the fluid leaving the node over the time step can be found by integrating the right side of Eq. (43) over the length of the time step, and then dividing by it:

(44) where Tnode is the temperature of the node at the beginning of the time step. Whenever the solar loop is not running, each node temperature depends only on the outputs of the node below it and the bottom node input is the heating return temperature. The updated node temperatures found using Eq. (43) then become the initial conditions for node temperature in the next time step. However, in some cases the output temperature from a node will simultaneously 29

affect the fluid temperature entering it, such as when the solar loop is running. In these cases the true average fluid temperature entering the node is no longer known. In order to be able to solve for the node output temperature, a numerical solution is required whereby an initial guess is made for the average input temperature. The resulting average node output temperature is used to update the average node input temperature for the next iteration, which continues until they converge on the true solution. The full numerical method to solve the overall system is described in detail at the end of this section. When the solar loop is running, an additional energy input term is included in Eq. (28) to represent the heat added to the node by the solar loop through the heat exchange coil. Given an assumed heat exchanger effectiveness of 70%, the rate of heat exchange from the solar loop to a node in the tank is given by: 0.7 where is the rate of heat exchange, the subscript denotes the solar loop, and is the (45)

temperature of the solar loop working fluid entering the node. With a perfectly efficient heat exchanger, the temperature of the solar loop working fluid leaving a node would be equal to the node temperature. However, with a 70% effective heat exchanger, the solar loop working fluid changes by 70% of the temperature difference between the node and the solar fluid entering the node. The solar loop working fluid outlet temperature from each node is thus: 0.7 1 the node below it. (46)

,

,

,

,

where denotes the current node, and

The change in thermal energy in a node when the solar loop is running is the same as Eq. (28), plus the additional energy input term from the solar loop, Eq. (45): 30

0.7 Again, Tnode is not know, and is solved for by substituting Eq. (29) for Tnode in Eq. (47):

(47)

0.7 At this point, is the only unknown with respect to time in this equation. By isolating

(48) and

rearranging Eq. (48), it becomes a linear differential equation with the form of Eq. (32): 0.7

0.7

(49)

Where from Eq. (32): 0.7 (50)

0.7

(51)

Solving in the same manner as before, the solution for E becomes: 0.7 0.7 C is also solved for in the same manor as before where the temperature of the node at therefore the amount of thermal energy present in in the node is known. 0.7 0.7 (53) becomes:
.

(52) 0 and

31

Substituting Eq. (53) into Eq. (52), and converting the amount of thermal energy in the node into the nodes temperature using Eq. (29) gives the formula for the temperature of a node at the end of the time step:

0.7

0.7

0.7

0.7

.

(54)

Or, if the specific heat capacity of the solar loop working fluid is the same as that in the storage tank, then:
0.7 0.7 0.7 0.7
.

(55)

and the average node temperature over the timestep is:

0.7

0.7

0.7

0.7

.

(56)

The constant temperature assumption for the simulation is mathematically representative of the transient nature of the temperature of a node so long as its true time-averaged temperature across each timestep is used. However, as mentioned above, these true average temperature values are unknown is some cases. Thus, an iterative process is used to obtain the solution for each time step due to the interdependency between the node temperatures and their energy transfer when the solar loop is running within the tank. This is because the method presented here requires that the average fluid temperature entering a node is known. Take for example two adjacent nodes

32

within the thermal storage tank, where node A is above node B. The storage tank fluid from node B flows upward into node A, and solar loop working fluid flows opposite, from A to B. The temperature of node A is dependent on the temperature of node B. Solar fluid temperature exiting node A (entering node B) is dependent on the temperature of node A, and finally the temperature of node B is dependent on the temperature of that solar loop working fluid entering it. The three are therefore interdependent, and the true value for their temperatures are not initially known. Further interdependencies exist between the fluid temperatures entering and leaving the solar array, and the tank temperature, as well as flow rate through the tank and temperature of the fluid leaving the top node of the tank. To solve the system, initial guesses are made for the unknown average temperatures across the timestep of the components. Using these and the known values for the tank node temperatures at the beginning of each timestep, new values for each component are calculated. These new values become the inputs for the next iteration, and this process continues until two consecutive values fall within a specified convergence tolerance. Figure 6 summarizes the steps using this numerical method to solve each timestep. It can be seen that multiple nested iterative loops are sometimes required. The solution process for the variable flow rate control strategy is the same as the process detailed for constant flow, except that in the update procedure after new tank node temperatures are calculated the target outlet temperature is updated and the solar loop flow rate necessary to obtain that temperature is also determined and updated. This step is highlighted with the black dashed outline.

33

Figure 6: Thermal Storage Steady State Solution Process

34

6

Model of Building heating with Counter Flow Heat Exchanger

The potential of variable flow was also evaluated in the case without thermal storage, where heat from the solar loop is directly transferred to the building heating loop through a counter flow heat exchanger with an assumed 70% heat transfer effectiveness. The system flow equations are similar to those presented in Eqs. (23-26), except that is used in place of .
,

is used in place of

and

The maximum rate of heat transfer through the heat exchanger is the minimum of the heat capacity flow rates of the two streams, shown for the solar loop and heating side of the HX loop in Eqs. (57) and (58) respectively, and denoted in further calculations as . (57) (58) The maximum possible heat transfer rate occurs when the outlet temperature of the fluid stream with the lowest heat capacity rate reaches the inlet temperature of the second stream. Therefore, the actual rate of heat transfer for the solar and heating loops is: 0.7 The output temperature of the heat exchanger re-entering the solar collectors is thus: (59)

(60) Similarly, the heating loop output temperature from the heat exchanger can be determined:

,

(61)

35

The iterative process to solve the system in the case of a counter flow heat exchanger is similar to that used for the thermal storage tank method. The flow chart shown in Figure 7 illustrates the solution process. Initial solar inlet temperature set to that at end of previous time step Calculate solar outlet temperature. Is outlet temperature greater than heating return temperature? Yes HX update procedure with solar heating side HX outlet temperature equals heating return temperature Done No Initial guess made for heat exchanger flow rate Initial Cmin determined using Eqs. (58) and (59) Initial heating side HX outlet temperature and new solar inlet temperature calculated using Eqs. (60) and (61), Solar output temperature calculated heating side HX outlet temperature and new solar inlet temperature calculated using Eqs. (60) and (61) Has solar inlet temperature converged? Yes No

Update heating side HX loop flow rate using Eqs. (23), (24), and (26) Update Cmin using Eqs. (58) and (59)

Has the heating side HX loop flow rate converged? Yes Done
Figure 7: Heat Exchanger Steady State Solution Process

No

36

7

Model Validation

The model was incrementally validated to ensure that each model component was correct prior to integration with more complex models. First, the PVT model was compared with published data from two characterization studies, manufacturer performance data for a flat plate solar thermal collector, and was further validated empirically with results from 35 tests cases conducted in the solar simulation lab at Concordia University. These lab tests were conducted at various flow rates and wind speeds to create multiple reduced temperature graphs to verify model accuracy under a variety of conditions. Second, the solar collector model was integrated into the two full building system models using a thermal storage tank and counter flow heat exchanger. The constant flow condition was validated against a parallel TRNSYS model, run for a one year simulation using the same weather file and sample building heating loads. Annual total solar heat gains as well as interval tank temperatures compared over two sample days were compared and sources of discrepancies were quantified and investigated. 7.1 PVT Panel Model

Model predictions were compared to three published sources to validate the PVT model described in Section 4. All physical collector properties and ambient conditions from the studies being compared were replicated for the simulation using the model presented in this thesis. In instances where simulation parameters were not specified in the literature, estimates were made based upon typical values, and sensitivity analyses were carried out to ensure that these estimates had negligible impact on the validation simulation study.

37

The first validation carried out was to a dynamic model for a PVT collector created by Chow [19], who treated each material in the collector as a thermal node each having a distinct heat capacity and heat balance equation. One difference between the model in this thesis and that presented by Chow is that the electrical efficiency given includes the effect of the cover glass reflective loss, rather than multiplying it by the cover glass transmittance as shown by Eq. (5). Chow's model also does not cover the entire aperture area of the panel with PV, and a packing factor is introduced to represent the fraction of the aperture covered by PV. The expression for electrical generation is therefore given by: (62) where is the solar radiation incident on the total aperture area, and is the packing factor.

Simulations determined the thermal and electrical efficiencies of a PVT collector as a function of fluid flow rate for four collectors of varying construction. These construction differences were quantified by the quality of the bond between the PV cells and the absorber plate (hPV) and the quality of the bond between the absorber plate to the pipes (Cb). A summary of the parameters used in the study are shown in Tables 1 and 2.
Table 1 ­ Collector Quality Variables

Collector A B C D

hPV [(W/m2*K)] 10,000 100 45 25

Cb [W/m*K] 10,000 100 45 25

38

Table 2 ­ Simulation Parameters from Chow [19]

Variable Ac  p c  Ta Ti I v d W rc e Tref o

Value 2 45 0.88 0.88 400 30 30 800 1.5 0.01 0.2 0.8 12 25 0.0045

Unit m2 ° W/m°C °C °C W/m2 m/s m m % °C °C-1

Side and bottom losses for the collector were not specified by Chow, and are assumed to be 1.5 W/m2K which is a typical value for this type of solar thermal collector. Because cover transmittance was not given, a sensitivity analysis was carried out to determine the value of the cover transmittance, and c=0.88 showed the best correlation with experimental results for similar collectors. Using this transmittance, the largest discrepancy for absolute thermal efficiency was found to be 1.6% compared to Chow's model for collector D, and the largest electrical efficiency result differences were between 1.2% and 2.2% higher, relative to the total, as shown in Figure 8. A sensitivity analysis was done using a value of 0.92 for the cover transmittance, in which case the largest discrepancy in thermal efficiency between the two models occurs in collector A with an absolute difference of 3.1% higher than Chow's model, as summarized in Figure 9. The absolute difference in collector D changes to 0.7% higher when compared to Chow's model. 39

0.7 0.6 0.5 Thermal Efficiency 0.4 0.3 0.2 0.1 0 0 0.01 0.02 0.03 0.04 0.05 Flow Rate [kg/s] A  Chow (2003) B  Chow (2003) C  Chow (2003) D  Chow (2003) A  Current Model B  Current Model C  Current Model D  Current Model

Figure 8: Thermal Efficiency vs Flow Rate for Chow [19] and Current Study at g=0.88

0.095 0.09 Electrical Efficiency 0.085 0.08 0.075 0.07 0.065 0.06 0 0.01 0.02 0.03 0.04 0.05 Flow Rate [kg/s] A  Current Model B  Current Model C  Current Model D  Current Model A  Chow (2003) B  Chow (2003) C  Chow (2003) D  Chow (2003)

Figure 9: Electrical Efficiency for Chow [19] and Current Study at g=0.88

40

The second validation used data from a study completed by Vokas et al. [22], which compared traditional solar thermal collectors to PVT for the application of domestic space heating and cooling via an absorption chiller. Their methodology is also based on Duffie and Beckman [27], and uses an iterative solution process to determine the performance of a PVT collector. The physical characteristics and ambient conditions used for their calculation are summarized in Table 3. Using a transmittance-absorptance product of 0.74, sourced from de Vries [20], values for the heat removal factor and overall loss coefficient were calculated for the PVT collector and again for the same collector ignoring the PV laminate using the iterative method in Section 4.
Table 3: Simulation Parameters from Vokas et al. [22]

Variable Ac hPV Cb c p (conventional) p (selective) Ta Ti m hfi d W kabs kPV abs PV  I v Us + Ub

Value 1.32 45  0.88 0.95 0.05 20 20 0.38 300 0.01 0.095 390 84 0.002 0.04 45 800 1 1.25

Unit m2 W/m2 *K W/m*K °C °C kg/s/m2 W/m2*K m m W/m*K W/m*K m m ° W/m2 m/s W/m2*K

41

Table 4 summarizes the results for

and

(y-intercept and slope of a reduced

temperature graph, respectively) for a PVT and simple thermal collector without PV laminate.
Table 4: Thermal Efficiency Characteristics

Collector Type PVT Solar Thermal

FRUT(W/m2C) 5.43 5.5

FR() 0.61 0.69

These values are assumed to remain constant for any operating or ambient conditions, such that the thermal efficiency at any point is a linear function of the temperature difference between the inlet solar fluid and ambient air, and level of solar irradiance. An F-chart method [27] was then used to determine the solar fractions for space heating and cooling under climate conditions for three different cities in Greece. The thermal efficiency using this method is characterised as: (63) The values presented in Table 4 were used for this comparison simulation. Figure 10 shows the thermal efficiency plotted against reduced temperature for both collector types, comparing the published results [22] with the proposed model. The custom model gives an absolute efficiency within 0.8% and 0.1% of Vokas at zero reduced temperature for the thermal and PVT panels, respectively. The results begin to diverge as the inlet water temperature is increased, up to 10.1% and 4.1% at a reduced temperature of 0.1 W/m2K. This difference is due to the non-linear relationship between radiative heat loss and difference between the plate and ambient temperatures. As the mean collector temperature increases with that of the solar inlet fluid, heat loss increases exponentially. The custom model accounts for this effect by reevaluating the heat loss whenever conditions change, providing a higher degree of accuracy under high reduced temperature conditions. 42

0.7 0.6 Thermal Efficiency 0.5 0.4 0.3 0.2 0.1 0 0 0.02 0.04 0.06 0.08 0.1 0.12 (TiTa)/I [W/m2K] PV/T  Vokas Thermal  Current Model PV/T  Current Model Thermal  Vokas

Figure 10: Thermal Efficiency vs Reduced Temperature (Vokas, 2005) and Current Study

The third validation compared predicted results to the manufacturer performance curve for the FPC-A32 Flat Plate Collector manufactured by Apricus Solar Hot Water, in order to compare the model against empirical curve fits derived from real test data. Collector physical characteristics provided by Apricus are shown in Table 5 and the nominal flow rate of the collector was used. Several inputs were not given and had to be assumed. The wind speed was assumed to be 3 m/s, and the heat transfer coefficient between the absorber plate and PV laminate 100 W/m2K. Side and bottom losses were not provided by the manufacturer and - due to their significant impact on collector performance - three potential values (1 W/m2K, 1.5 W/m2K, and 2 W/m2K) were tested to determine which best characterized the panel performance. As shown in Figure 11, 1.5 W/m2K has the strongest correlation. The custom model thus shows good consistency with real product test data.

43

Table 5: Simulation Parameters [28]

Variable Ac Ta m d W hfi hPV abs kabs g p p I v

Value 2.8 20 0.0333 0.01 0.13 300 100 0.004 230 0.92 0.04 0.95 800 3

Unit m2 °C kg/s/m2 m m W/m2*K W/m2*K m W/m*K W/m2 m/s

0.9 0.8 0.7 Thermal Efficiency 0.6 0.5 0.4 0.3 0.2 0.1 0 0 20 40 60 TmTa [W/m2K] 80 100 120 Usb = 1.5 W/m2K From Apricus Spec Usb = 2 W/m2K Usb = 1 W/m2K

Figure 11: Thermal Efficiency vs Reduced Temperature for Apricus [28] and Proposed Model

The final comparison was made to experimental test results using the Volther Powertherm shown in Figure 12. The testing was done at Concordia University in October 2017 in the Solar 44

Simulator ­ Environmental Chamber laboratory. Temperature measurements of the fluid and air were taken using resistance temperature detectors with a resolution of 0.01°C. The apparatus was mounted perpendicular to the incoming radiation from the solar lamps as seen in Figure 13. Solar radiation was measured by scanning the grid before the apparatus was mounted in the space it would occupy using a pyranometer. Small fluctuations in the readings were averaged across the grid to obtain the measured value.

Figure 12: Volther Powertherm

45

Figure 13: Experimental Set-Up

In all, 35 tests were conducted in which the ambient conditions, flow rate, and fluid inlet temperature were held constant until the fluid outlet temperature reached steady-state. Steady state in these tests was assumed to have been attained when the outlet fluid temperature changed by no more than 0.01°C over a period of two minutes. The tests were organized into four groups wherein the wind speed, flow rate, and ambient temperature were held constant while the solar irradiance and fluid inlet temperatures were varied. The data from each group could therefore be used to create a reduced temperature graph characterizing the collector's performance at the designated wind speed and flow rate. A summary of the test conditions and results can be seen in Table 6. Temperatures were recorded every five seconds, and final values are the average of the recordings during the two minute steady-state period. 46

Table 6: Test Case Parameters and Results

Test Number

Tin [°C]

Tout [°C]

Ta [°C] I [W/m2]

Thermal Power [W] 683.7 751.0 532.3 391.6 618.0 567.1 444.6 299.4 675.2 828.2 883.8 540.7 647.6 699.9 522.6 396.8 716.7 647.9 481.5 242.6 93.5 860.8 786.6 760.8 625.6 709.9 650.0 511.4 791.2 952.0 1004.5 

Electrical Power [W] 145.0 149.5 135.9 134.8 132.4 124.3 114.1* 108.1 163.8 174.9 180.2 151.9 143.2 149.0 135.2 126.4 151.0 146.8 137.9* 108.9 103.8 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 

Case A: mfr = 103 kg/hr, v = 2.6 m/s, PVT On 21.90 27.64 22.29 1062 2 13.57 19.86 22.29 1062 6 40.37 44.84 22.36 1062 8 59.23 62.46 23.08 1062 10 13.16 18.34 20.79 899 12 21.49 26.20 21.36 899 14 40.23 43.95 21.59 899 17 58.99 61.48 22.48 899 32 40.77 46.44 22.43 1301 18 22.21 29.12 22.97 1301 21 13.87 21.23 23.03 1301 22 59.46 63.98 23.66 1301 33 Case B: mfr = 43 kg/hr, v = 2.6 m/s, PVT On 21.69 34.62 22.55 1062 4 13.24 26.61 22.32 1062 7 39.70 49.68 22.94 1062 9 57.99 65.25 23.31 1062 11 Case C: mfr = 103 kg/hr, v = 5.8 m/s, PVT On 12.84 18.84 22.50 1062 24 21.74 27.19 22.16 1062 27 40.27 44.31 22.26 1062 28 58.75 60.76 22.73 899 31 72.55 73.33 22.27 899 35 Case D: mfr = 103 kg/hr, v = 2.6 m/s, PVT Off 13.90 21.12 23.02 1062 34 22.18 28.79 22.20 1062 1 21.98 28.38 22.15 1062 3 40.64 45.87 22.52 1062 29 13.34 19.26 21.01 899 13 21.67 27.07 21.16 899 15 40.30 44.59 21.41 899 16 40.96 47.60 22.79 1301 19 22.45 30.39 22.99 1301 20 23  14.06  22.46  23.54  1301  47

Note that tests #17 and 28 are anomalous. In test 17, the electrical power was measured before steady-state reached. The previous test had PV off and the measurement was taken before the PV was fully cooled, which likely resulted in underestimation. In test 28 the electrical power was measurement missing. The value was estimated using interpolation from tests 24 and 27 by assuming a linear reduction in power based on fluid inlet temperature. Inputs for the custom model were taken from the Volther Powertherm product data and are summarized in Table 7. Note that c, p, and kPV were not published for this panel and were assigned commonly-used values from the literature (specifically [15], [22], and [32], respectively). The measured values for electrical generation during the tests were used as inputs for the simulation. A sensitivity analysis was done for the following crucial parameters that were not given in the product specifications: The bond conductivity between the absorber plate and PV, side and bottom losses, and transmittance-absorption product. Figure 14 shows the measured vs simulated results for the sensitivity analysis under Case A conditions, where it was found that = 30 W/m2K, = 1.5 W/m2K, and = 0.72 had the closest correlation with the

measured results. Figures Figure 15-Figure 17 show the comparative results for Cases B-D using those values. The mean absolute error for Cases A-D are 0.44%, 0.51%, 1.17%, and 2.25% respectively. Because the assumed collector characteristics were calibrated to Case A, increases in error from it to the other test cases can be attributed to the changes in the test parameters. In Case C, the wind speed was increased, indicating that the empirical formula used to determine the heat loss coefficient from the cover to ambient due to wind was slightly inaccurate. Case D turned off the PV generation and had the largest error from Case A. The model assumes that all incoming solar radiation is first converted into electricity by the PV, and the remainder is

48

available to become heat. It is likely that this assumption is an oversimplification and the source of error in this case.
Table 7: Model Inputs for Volther Powertherm Physical Parameters

Variable Ac c p hfi Cb d W kabs kPV abs PV 

Value 1.4 0.88* 0.95* 300 100 0.008 0.11 400 130* 0.00012 0.04 45

Unit m2 W/m2*K W/m*K m m W/m*K W/m*K m m °

0.6 0.5

Thermal Efficiency

0.4 0.3 0.2 0.1 0 0.02

Test Data hpv=30, Usb=1, ()=0.74 hpv=30, Usb=1.5, ()=0.74 hpv=30, Usb=1.5, ()=0.71 hpv=30, Usb=1.5, ()=0.72 Poly. (Test Data)

0

0.02

0.04

0.06

0.08

0.1

[TiTa]/I

Figure 14: Case A (mfr = 103 kg/hr, v = 2.6 m/s, PVT On) Measured vs. Simulated Results

49

0.6 0.5

Thermal Efficiency

0.4 0.3 0.2 0.1 0 0 0.02 0.04 0.06 0.08 0.1 Test Data hpv=30, Usb=1.5, ()=0.72 Poly. (Test Data)

[TiTa]/I

Figure 15: Case B Conditions (mfr = 43 kg/hr, v = 2.6 m/s, PVT On) - Measured vs. Simulated Results

0.6 0.5

Thermal Efficiency

0.4 0.3 0.2 0.1 0 Test Data hpv=30, Usb=1.5, ()=0.72 Poly. (Test Data)

0.01

0.01

0.03

0.05

0.07

0.09

0.11

[TiTa]/I

Figure 16: Case C Conditions (mfr = 103 kg/hr, v = 5.8 m/s, PVT On ) - Measured vs. Simulated Results

50

0.7 0.6

Thermal Efficiency

0.5 0.4 Test Data 0.3 0.2 0.1 0 0.005 hpv=30, Usb=1.5, ()=0.72 Poly. (Test Data)

0

0.005

0.01

0.015

0.02

0.025

0.03

[TiTa]/I

Figure 17: Case D Conditions (mfr = 103 kg/hr, v = 2.6 m/s, PVT Off) - Measured vs. Simulated Results

7.2

Heating System Model Validation

To verify the accuracy of the overall system model and test the validity of the thermal storage tank and heat transfer methodology presented in Section 5, validation was conducted against a TRNSYS [30] model created by another student. The same simulation input parameters were used in both models, including weather data, panel characteristics, system layout, thermal storage tank size, heat exchanger effectiveness, and heating loads. The sample building used for the simulations was a 232.3 m2 (2500 ft2) residential home with RSI 3 (R-17) exterior walls, RSI 5.6 (R-32) roof, and a basement with RSI 1.6 (R-9) insulation around the perimeter. eQuest [33] was used to generate the load data, which was then used as an input for TRNSYS simulations, carried out using 10 minute timesteps and the same weather data [34]. Simulations of the solar panel were then carried out using ISO standard testing conditions [35] using the custom simulation model developed and described in Section 4 of this thesis. The

51

physical characteristics of the panel are summarized in Table 8 and the reduced temperature graph in Figure 18. The data points on the reduced temperature graph were used to create second-order thermal efficiency correlations, which were then used to define the PVT as a Type 1a simulation object in TRNSYS. A diagram of the TRNSYS model is shown in Figure 19.
Table 8: PVT Physical Parameters

Variable Ac hPV c p hfi d W Usb kabs kPV abs PV 

Value 39.75 100 0.88 0.90 400 0.01 0.2 1.5 400 84 0.0004 0.04 45

Unit m2 W/m2*K W/m2*K m m W/m2*K W/m*K W/m*K m m °

52

0.8 0.6

Thermal Efficiency

0.4 0.2 0 0.02 0.2 0.4 0.6 0.8 1 0.03 0.08 0.13 0.18 0.23 0.28

[TiTa]/I

Figure 18: Thermal Performance vs. Reduced Temperature for PVT Panel

Figure 19: TRNSYS System Layout Schematic [36]

In the simulated system, created and modeled by Fine [36], solar energy was collected using a 39.75 m2 solar array with water as the working fluid. Since this simulation was only used as validation for the model presented in this thesis, water was used as the working fluid for simplicity rather than an antifreeze solution with different properties. The useful solar heat gains 53

produced by the PVT array in a timestep was a function of the reduced temperature in in that timestep using the second order thermal efficiency correlation developed for this simulation. A counterflow heat exchanger (Type 91) was used as the heat exchange mechanism between the solar loop and the thermal storage tank, with the flow rate of both loops equal to the nominal panel flow rate of 0.02 kg/s/m2. The thermal storage tank was modelled using a two-node stratified tank (Type 4a), with a volume of 2m3. To replicate the setup described in Section 5, the fluid from the tank was used as the supply fluid for the building heating system with a recirculation loop to ensure constant supply temperature, and an auxiliary heater (Type 6). Using this system layout, control scheme, and input weather and building load data, the outputs from the TRNSYS simulation were then compared to the outputs from the simulation of the PVT array and building heating loop with thermal storage system model developed in this thesis (PVT-BTS). The TRNSYS model predicts a total of 23,868 MJ of useful solar thermal energy gathered, while the PVT-BTS predicts 22,532 MJ, a difference of 5.9%. The monthly useful gains for each of simulations are shown in Figure 20.

54

Solar Gains by Month
5000 4500 4000 3500 3000 2500 2000 1500 1000 500 0 Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec Custom Model TRNSYS

Qu [MJ]

Figure 20 - Solar Gain by Month for this model and TRNSYS

While the discrepancy between TRNSYS and the PVT-BTS models was within acceptable error margins, two differences between the models were identified that contribute to this discrepancy. The first difference is the methodology used to determine the solar collector performance at each timestep. The TRNSYS model used a static second order efficiency curve, while the custom PVT model updated the thermal efficiency in response to ambient conditions at each timestep. As operating conditions begin to vary from the ambient conditions the efficiency curve was created at, the efficiency calculated based on the correlation increases in error due to the fourth-order, rather than second-order temperature difference effect for radiation losses. As the reference ambient temperature used to define the reduced temperature decreases, the radiative heat loss likewise decreases, even if the absolute temperature between the plate and the ambient air remains constant. The custom model developed updates this temperature relationship and uses an iterative process to find the steady-state condition for each timestep. It therefore predicts higher performance over TRNSYS when the ambient temperature is below the reference temperature that the performance curve used, while the opposite is true for higher temperatures. This effect 55

becomes more pronounced at higher reduced temperatures, as can be seen in Figure 21. The plot was made using the same collector array used for the house simulation with a wind speed of 5 m/s. The effect of wind speed on thermal efficiency can be seen in Figure 22 created using an ambient reference temperature of 30°C.

0.7 0.6 Ta = 30C 0.5

Thermal Efficiency

Ta = 20C Ta = 0C

0.4 0.3 0.2 0.1 0

Ta = 5C Ta = 10C Poly. (Ta = 30C) Poly. (Ta = 20C) Poly. (Ta = 0C) Poly. (Ta = 5C) Poly. (Ta = 10C)

0.02

0

0.02

0.04

0.06

0.08

0.1

[TiTa]/I

Figure 21: Effect of Reference Ambient Temperature on Thermal Efficiency

56

0.7 0.6 0.5

Thermal Efficiency

0.4 0.3 0.2 0.1 0 0.1 0.2 0 0.01 0.02 0.03 0.04 0.05 0.06 0.07 0.08 0.09 0.1 v=0 v=1.5 v=3 v=6 v=10

[TiTa]/I

Figure 22: Effect of Wind Speed on Thermal Efficiency

The second difference was the treatment of the solar outlet temperature from the solar array when the system was not running. At timesteps when the fluid outlet temperature from the solar array is not above the tank top node temperature, the system does not operate and TRNSYS instead calculates the stagnation temperature of the panel, triggering the system to run in the following timestep. Calculated heat gains ­ despite the temperature being inadequate for heat transfer ­ are used to force an increase in tank bottom node temperature, which in turn increases the fluid inlet temperature to the solar array. This alternating pattern between time steps continues until the bottom node and solar inlet temperatures are sufficiently high to cause the solar outlet temperature to be greater than the tank top node temperature. In contrast, the custom simulation model described in this thesis calculates the steady-state condition for each timestep independently and will only run the solar loop if it would result in heat transfer to the tank at steady-state. A sample September day from the TRNSYS simulation is shown in Figure 23, which illustrates the alternating effect that occurs. The solar outlet temperature and solar heat gains can be seen to fluctuate between 9 hrs and 11 hrs, where the peaks of the solar outlet 57

temperature is the stagnation temperature at the time step, and the valleys are the outlet temperature when the solar loop runs. Just after 11 hrs the non-stagnation outlet temperature can be seen to approach the tank top node temperature at which point continuous operation begins.

380 370 360

9.00 8.00 7.00 6.00 5.00 Tank Top Temperature

Temperature [K]

Solar Gain [MJ]

350 340 330 320 310 300 9.00 10.00 11.00 12.00 13.00 14.00 15.00

Tank Bottom Temperature Solar Input Temperature Solar Output Temperature Solar Gains

4.00 3.00 2.00 1.00 0.00 16.00

Time [hr]

Figure 23: Example of Tank Node Temperatures and Solar Gains in TRNSYS Simulation

Aside from these two differences, the behavior of the stratified tank temperatures is similar between the two models. When the predicted solar gains are similar, the top and bottom node temperatures are observed to charge at a similar rate as can be seen in a sample day in January shown in Figure 24. Figure 25 displays the weather used for that same day.

58

310 309 308 307 306 305 304 303 302 8.00 9.00 10.00 11.00 12.00 13.00 14.00 15.00 16.00

5.00

Temperature [K]

3.00 2.00 1.00 0.00 17.00

Time [hr]
Tank Top Temperature (TRNSYS) Tank Top Temperature (This Paper) Solar Gains (TRNSYS) Tank Bottom Temperature (TRNSYS) Tank Bottom Temperature (This Paper) Solar Gains (This Paper)

Figure 24: Tank Node Temperature and Solar Gains for Sample January Day - Custom Model and TRNSYS

3.00

0.00

Solar Radiation [MJ/hr/m2]

2.00 1.50

4.00 6.00 8.00

Ambient Temperature [°C]

2.50

2.00

Solar Radiation

1.00 0.50 0.00 8.00 10.00 12.00 14.00 16.00

10.00 12.00 14.00

Ambient Temperature

Time [hr]

Figure 25: Weather for Sample January Day

These comparative simulation results validated the custom model, allowing further investigations to be carried out.

59

Solar Gains [MJ]

4.00

8 8.1

Results House Simulations ­ Thermal Storage

The house described in Section 7.2 was simulated using two flow rate strategies for the fluid in the solar array. The first strategy was using a constant flow rate of 0.02 kg/s/m2 of panel area and a total panel area of 39.75 m2. In this strategy, the solar loop runs if the outlet temperature is greater than the temperature of the top node of the thermal storage tank, or greater than the heating return temperature if no thermal storage is used. The second strategy uses variable flow rate to achieve a target outlet temperature from the PVT collectors. The target outlet temperature from the array was 0.5°C higher than the heating supply temperature when thermal storage was used. Once the tank surpasses that temperature, the target changes to 1°C higher than the current temperature at the top of the storage tank to ensure that the solar collectors continues to operate when the thermal storage is increased beyond the heating supply temperature. In both simulations, the solar loop is shut off if the tank temperature rises above 97°C to avoid boiling the heating loop fluid. Monthly solar energy gain results from both simulations are shown in Figure 26.

60

5000 4500 4000 3500

Qu [MJ]

3000 2500 2000 1500 1000 500 0 Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec Variable Constant

Figure 26: Variable Flow and Constant Flow Monthly Solar Gains

The results from the two operation strategies predict similar results; constant flow and variable flow predict useful solar gains of 22,638 MJ and 22,915 MJ, and solar fractions of 26.4% and 26.7%, respectively. Due to computational limitations of the loop convergence values, there is some error present in each timestep. Despite a specified building heating load of 85,840 MJ annually, the variable flow simulation adds a total of 84,766 MJ between the solar loop and auxiliary energy, while the constant flow adds 86,155 MJ. The absolute error is -1.3% and 0.4% for the variable and constant flow simulations respectively. These errors can be reduced by running the simulation with smaller convergence tolerances which will increase the computational cost required to run the simulation. The differences between the control strategies are more evident when individual timesteps are considered. The majority of the time the operating efficiency is similar despite them having significantly different flow rates due to the thermal efficiency plateau above a certain flow rate

61

threshold. However, during sunrise and sunset the reduced temperature is high, resulting in significantly different performance between constant and variable flow. If the tank temperature during these periods is below the variable flow target temperature of 310 K, the variable flow simulation must produce a temperature increase across the array to overcome the temperature gap between (a) the fluid entering the array at close to the tank bottom node temperature, and (b) the target temperature. This requires a sacrifice of thermal efficiency and as a result, when solar radiation is scarce, the solar array is often unable to operate. Conversely, the constant flow rate simulation requires only that the temperature gap between the solar inlet temperature and the tank top node temperature be overcome, and thus some useful heat is produced under those conditions. Alternatively, when the tank temperature is high and solar radiation is low, an opposite result is observed; the constant flow system is not able to produce an outlet temperature greater than the tank top node temperature, while the variable flow simulation reduces the flow rate until this is achieved. This effect is shown in Figures Figure 27-Figure 29.

62

12 10 8

3 2.5 2 1.5 1 0.5 0 13350

Flow Rate [kg/s]

Qu  Constant Qu  Variable Flow Rate  Constant Flow Rate  Variable

Qu [MJ]

6 4 2 0 13300

13310

13320

13330

13340

Timestep

Figure 27: Flow Rate and Solar Gains for a Sample April Day

330 325 Temperature [K] 320 315 310 305 300 13300

4.50 4.00 3.50 3.00 2.50 2.00 1.50 1.00 0.50 13310 13320 13330 13340 0.00 13350 Solar Radiation [MJ/m2/hr] Solar Input Temperature Solar Output Temperature Tank Top Temperature Solar Radiation

Timestep

Figure 28: Tank Temperature in Variable Flow Simulation for a Sample April Day

63

330 325 Temperature [K] 320 315 310 305 300 13300

4.50 3.50 3.00 2.50 2.00 1.50 1.00 0.50 13310 13320 13330 13340 0.00 13350 Solar Radiation [MJ/m2/hr] 4.00 Solar Input Temperature Solar Ouput Temperature Tank Top Temperature Solar Radiation

Time Step

Figure 29: Tank Temperature in Constant Flow Simulation for a Sample April Day

At the beginning of the day, as shown in Figure 28 and Figure 29, the solar radiation and tank temperatures are both low, and the constant flow simulation collects a small amount of solar energy. At the end of the day, the tank has warmed up such that the constant flow strategy is unable to generate useful heat, but the variable flow strategy is able to operate at low flow rates.

8.2

House Simulations ­ Counter Flow Heat Exchanger

The constant flow rate simulation predicts an annual solar energy gain of 7,318 MJ compared to 6,899 MJ with variable flow control. Similar to the thermal storage simulations, there is a level of error incurred by the convergence thresholds of the iterative loops. The constant flow simulation had total heat added to the building between solar and auxiliary heat 0.6% higher than the building heating load while the variable flow showed 0.6% lower. The monthly solar heat gains for both control strategies are displayed in Figure 30.

64

1600 1400 1200

Qu [MJ]

1000 800 600 400 200 0 Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec Variable Constant

Figure 30: Monthly Solar Heat Gains for Heat Exchanger Simulation

Similar to the thermal storage tank simulation, during timesteps with high solar irradiance the two strategies show similar gains, but when solar irradiance is low, the variable flow typically produces less energy than the constant flow rate. This is again due to the target temperature during these low irradiance timesteps, where the solar array either operates at a low flow rate that decreases thermal efficiency, or is unable to achieve the target temperature which renders the system inoperable. To properly compare the performance of two systems, two metrics are considered for each simulation: (1) total amount of thermal energy generated while the other system is inoperable; and (2) total amount of thermal energy generated in excess of the other system during timesteps when both are in operation. In the case of constant flow, these values are 404 MJ, and 97 MJ, respectively. For the variable flow strategy, these are 29 MJ and 53 MJ, respectively. These values indicate that the largest source of discrepancy between the simulations is due to the constant flow strategy operating, while the target temperature prevents the variable flow strategy from doing so. The following two figures show the theoretical useful heat as a function of flow rate for two different timesteps, comparing the optimal flow to those calculated for constant and variable strategies. Figure 31 shows the steady-state values for solar variables for different flow rates at timestep 520, where the variable flow showed higher solar gains. The 65

peak efficiency occurs when the outlet temperature is 310 K, the target temperature for the variable flow simulation. Figure 32 shows timestep 72, when is can be seen that neither flow rate strategy is operating at the optimal point.

320 318

Variable

2.5

Constant
2 Input Temperature Output Temperature Qu

Temperaure [K] 

316 314 312 310 308 306 304 0 0.2 0.4 0.6 0.8 1

1 0.5 0

Flow Rate [kg/s]

Figure 31: Effects of Flow Rate on Solar Inlet and Outlet Temperatures and Solar Gains at Timestep 520

313 312 311 310 309 308 307 306 305 304 303 0

Variable

Constant

1.8 1.6 1.4 1.2 1 0.8 0.6 0.4 0.2 0 Qu Input Temperature

Temperaure [K] 

Qu [MJ]

Qu [MJ]

1.5

Output Temperature

0.2

0.4

0.6

0.8

1

Flow Rate [kg/s]

Figure 32: Effects of Flow Rate on Solar Inlet and Outlet Temperatures, and Solar Gains at Timestep 72

These results demonstrate that while the constant flow approach generally performs better, the optimal flow rate fluctuates, and that and a mix of the two strategies would provide the best overall performance. 66

8.3

Optimal Flow Rate Investigation ­ Counter Flow Heat Exchanger

An in-depth analysis was performed for several test cases to further evaluate the effects of flow rate at different building loads, and heating supply temperatures. The PVT collector array described in Section 7.2 (properties in Table 8) along with the heat exchanger system set up without thermal storage (described in Section 0) was used for this analysis. The tests calculate the steady-state conditions of the system at flow rates ranging from 0.04 kg/s to 0.832 kg/s in 0.08 kg/s increments. External conditions for the tests were set to have a wind speed of 5 m/s, solar flux of 2.5 MJ/m2/hr, and ambient air temperature of 0°C. Ten tests were conducted: two building heating loads of 4 MJ/10 mins and 8 MJ/10 mins, each at five different heating supply temperatures ranging from 35°C to 70°C. It was observed that the optimal flow rate occurs when the heat capacities of the two streams are equal. Figure 33 and Figure 34 show the results of the five tests cases at a heating load of 4 MJ/10 mins and 8 MJ/10 mins respectively. The black line in each figure is the heat capacity of the solar loop, and the colored solid lines are the heat capacitates of the heating side fluid streams passing through the heat exchanger. At each of their intersections with the black line, the thermal efficiency for that case (represented by the double arrow line) is at its peak. The thermal efficiency then decreases from its maximum point as the flow rate increases. The loop heat capacity is linearly dependant on the flow rate because the heat capacity of the fluid is assumed to be constant across all temperatures. The solar loop heat capacity therefore increases linearly as the flow rate does. The heat capacities of the heat exchanger loops are observed to remain constant, except for the two cases where the heating supply temperatures are 35°C and 40°C with a heating load of 4 MJ/10 mins as seen in Figure 33. In those cases the solar loop causes the heat exchanger output to the building to increase above the heating supply 67

temperature. heating return fluid is mixed with the heat exchanger output fluid to reduce its temperature, causing the flow through the heat exchanger to decrease.

0.004 0.0035

0.3

0.25 0.003 0.2 0.0025 C solar C HX  Tsup = 35 C HX  Tsup = 40 C HX  Tsup = 50 0.002 0.0015 0.1 0.001 0.05 0.0005 0 0.04 0.06 0.08 0.1 0.12 0.14 0.16 0.18 0.2 0 0.15 C HX  Tsup = 60 C HX  Tsup = 70 c  Tsup = 35 c  Tsup = 40 c  Tsup = 50 c  Tsup = 60 c  Tsup = 70

CP [MW/K]

Flow Rate [kg/s]

Figure 33: Thermal Efficiency and Loop Heat Capacities vs. Flow Rate. heating Supply Temperature Ranges From 35°C to 70°C, Heating Load 4 MJ/10 mins

68

0.004 0.0035 0.003 0.0025

0.4 0.35 0.3 0.25 0.2 0.15 0.1 0.05 0 0.04 0.14 0.24 0.34 0.44 0.54 0.64 C solar C HX  Tsup = 35 C HX  Tsup = 40 C HX  Tsup = 50

CP [MW/K]

0.002 0.0015 0.001 0.0005 0

C HX  Tsup = 60 C HX  Tsup = 70 c  Tsup = 35 c  Tsup = 40 c  Tsup = 50 c  Tsup = 60 c  Tsup = 70

Flow Rate [kg/s]

Figure 34: Thermal Efficiency and Loop Heat Capacities vs. Flow Rate. Heating Supply Temperature Ranges From 35°C to 70°C, Heating Load 8 MJ/10 mins

The tests demonstrate that increasing the heating supply temperature will cause the efficiency to peak at a lower solar flow rate, and that the peak is greater relative to efficiency plateau that occurs at flow rates greater than the optimal point. Increasing the building heating load results in higher thermal efficiency at all heating supply temperatures. This occurs because as solar flow rate increases, the entire collector temperature decreases resulting in less thermal losses to the environment, and therefore greater useful heat gains. However, from Eq. (59), the rate of heat transfer is limited to the lesser of the heat capacity of the two streams. When the heat capacity of the heating side loop is greater than the solar loop, all of the solar thermal energy collected is able to be transferred to it. Once the solar loop surpasses the flow rate of the space heating loop, stops increasing and the amount of useful energy that can be extracted from the collectors 69

becomes fixed. As the solar flow rate is increased past the optimal point, the solar outlet temperature begins to decrease. Looking again at Eq. (59), with fixed, the rate of heat

transfer will decrease linearly with solar outlet temperature. Figure 35 shows the solar inlet and outlet temperatures, and thermal efficiency versus flow rate for the test case with an heating supply temperature of 50°C and building load of 8 MJ/10 mins. It can be seen that both the inlet and outlet temperatures begin to converge after the optimal point, and that the thermal efficiency decreases. A larger heating load requires a greater flow rate for the same temperature difference between the heating supply and return, resulting in a greater minimum possible stream heat capacity ( ).

340 335

0.3 0.25 0.2 0.15 Output temperature Input Temperature 0.1 0.05 0 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 Thermal Efficiency

Temperature [K]

330 325 320 315 310 305

Flow Rate [kg/s]

Figure 35: Thermal Efficiency and Collector Input/Output Temperatures vs. Flow Rate. Heating Supply Temperature Ranges From 50°C, Heating Load 8 MJ

70

8.4

Optimal Flow Rate Investigation ­ Thermal Storage Tank

A similar analysis to that in Section 8.3 was conducted using the thermal storage tank system to further evaluate the potential benefit of an optimal flow rate strategy. The same methodology and ambient conditions were used for the test cases, and the base conditions common to each test had the initial tank temperature set to 30°C, and heating supply temperature of 35°C. The parameters varied for the tests were the tank temperature, heating supply temperature, and solar intensity, and the results can be seen in Figures Figure 36-Figure 38.

0.4 0.35 0.3

Thermal Efficiency

0.25 0.2 0.15 0.1 0.05 0 0.05 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9

Ttank = 35 Ttank = 40 Ttank = 50 Ttank = 60 Ttank = 70

Flow Rate [kg/s]

Figure 36: Thermal Efficiency vs. Flow Rate Using Different Initial Tank Temperatures

71

0.4 0.35

Thermal Efficiency

0.3 0.25 0.2 0.15 0.1 0.05 0 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 Tsup = 35 Tsup = 40 Tsup = 50 Tsup = 60 Tsup = 70

Flow Rate [kg/s]

Figure 37: Thermal Efficiency vs. Flow Rate Using Different heating Supply Temperatures

0.4 0.35 0.3

Thermal Efficiency

0.25 0.2 0.15 0.1 0.05 0 0.05 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 S = 2.5 S = 2 S = 1.5 S = 1

Flow Rate [kg/s]

Figure 38: Thermal Efficiency vs. Flow Rate under Different Solar Irradiances

Higher initial tank temperature decreased thermal efficiency, due to the solar loop operating at higher temperatures and therefore having greater thermal losses to the environment. Lower solar irradiance always resulted in lower thermal efficiency, and the heating supply temperature had a negligible on thermal efficiency. Thermal efficiency increased with flow rate in all cases. The 72

reason being is that unlike the counter flow heat exchanger, the heat capacity of the heating side of the heat exchanger is the equal to the heat capacity of the heating loop passing through the thermal storage tank, plus that of the fluid in the tank itself. For comparison, at the nominal flow rate of 0.02 kg/s/m2, the total fluid passing through the heat exchanger during the 10 minute tests is 480 kg, whereas the mass of the thermal storage tank alone is 2,000 kg. Since the rate of heat transfer from the solar loop to the tank is governed by which in this case is always dictated

by the heat capacity of the solar loop, the maximum rate of heat transfer will always increase with solar flow rate. The results of these tests indicate that there is not good potential for thermal efficiency improvements from variable flow strategies.

8.5

Optimal Flow Rate Simulation

The findings of Sections 8.3 and 8.4 concluded that the greatest benefit from a variable flow rate strategy could be seen in a system using a counter flow heat exchanger without thermal storage, in which the solar loop flow rate matched that of the heating loop passing through the heat exchanger. Simulations were run to quantify said benefits using the sample home, solar array, and weather file described in Section 7.2. Heating supply temperature was identified as being a critical parameter to the system benefiting from variable flow, and so two separate values of 35°C and 60°C were tested. For each, a simulation using a constant flow, and variable optimal flow strategy was conducted. The results were once again evaluated using the metrics described in Section 8.2: (1) total amount of thermal energy generated while the other system is inoperable; and (2) total amount of thermal energy generated in excess of the other system during timesteps when both are in

73

operation. The combined total of thermal energy produced by the solar array and auxiliary heater were compared to the total building heating load as well to assess the level of accuracy of the simulation. These parameters are summarized in Table 9, and the monthly solar gains for the simulations with heating supply temperatures of 35°C and 60°C can be seen in Figure 39 and Figure 40 respectively.
Table 9: Analysis Metrics for Constant vs. Optimal Flow Simulations

Flow Strategy

Useful Solar Thermal Energy

Thermal energy produced when other flow strategy inoperable

Additional Thermal produced over other flow strategy when both are operable

(MJ)

% difference between calculated heat gains and building load

Constant Optimal Constant Optimal

heating Supply Temperature = 35°C 114.31 7,317.75 0.02 114.66 7,407.56 40.76 163.72 0 heating Supply Temperature = 60°C 4,440.84 1.17 47.13 40.16 4,973.70 0 581.16 0

0.13 0 0.06 0

74

1600 1400 1200 1000 Qu [MJ] 800 600 400 200 0 Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec Constant Optimal

Figure 39: Monthly Solar Heat Gains for Constant vs. Optimal Flow Rate Strategies with heating Supply Temperature 35°C

1200 1000 800

Qu [MJ]

600 400 200 0

Constant Optimal

Jan

Feb

Mar

Apr

May

Jun

Jul

Aug

Sep

Oct

Nov

Dec

Figure 40: Monthly Solar Heat Gains for Constant vs. Optimal Flow Rate Strategies with heating Supply Temperature 60°C

The results show that the optimal flow control strategy produced more total useful solar heat gains at both heating supply temperatures. In accordance to the observations made in Section 8.3, 75

the relative benefit of the optimal flow strategy over constant flow is greater when the heating supply and return temperature difference is greater. With a supply temperature of 35°C, the optimal flow simulation produced 1.2% more useful solar heat than the constant flow simulation, while that value increased to 12.0% with a supply temperature of 60°C. Although the simulation predicts the constant flow rate strategy producing more useful thermal energy than the optimal flow rate strategy during some time steps, it is a result of calculation error rather than an error with the strategy. The iteration convergence values are finite, leading to a small amount of error in each time step. The largest discrepancy between the simulations in a time step when constant flow produced more solar thermal energy was 0.147 MJ. To asses the impact of the iteration convergence values, that time step was then simulated at flow rates varying between 0.04 kg/s to 0.8 kg/s at 0.08 kg/s intervals using the annual simulation convergence values of 0.01°C for the solar inlet fluid loop, and 0.001 kg/s for the heating side heat exchanger loop, and again using values of 0.001°C and 0.0001 kg/s. The results are displayed in Figure 41. When the model uses the more stringent convergence values, the useful energy at the nominal flow rate used in the constant flow simulation is reduced from 0.595MJ to 0.456 MJ. Compared to the optimal flow simulation, the difference between the two simulations is reduced from 0.147 MJ to 0.005 MJ.

76

0.028 0.027 0.026

Thermal Efficiency

0.025 0.024 0.023 0.022 0.021 0.02 0.019 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 A B

Flow Rate [kg/s]

Figure 41: Thermal Efficiency vs. Flow Rate Using Convergence Values Of: 0.01°C and 0.001 kg/s (A), and 0.001°C and 0.0001 kg/s (B)

9

Conclusions

In order to investigate the potential benefits of variable control strategies for PVT collectors, a new steady-state modelling technique was developed using a modification of the method given by Duffie and Beckman [27] in which the overall loss coefficient and heat removal factors are updated at each time step. The proposed method allows variations in flow rate to be modelled, improving model accuracy at high reduced temperatures by accounting for changes in wind speed and ambient temperatures. The model was validated using published data from two academic studies, manufacturer test data, and custom laboratory test data. The PVT model was next simulated in conjunction with a building heating system, once using a counter flow heat exchanger, and a second time using a thermal storage tank with internal heat

77

exchanger. A parallel system was created in TRNSYS in which a house was heated by a PVT array and a backup auxiliary heater. A full-year simulation was run to validate the system model with TRNSYS with a useful solar heat gain discrepancy of 5.9% between models. The full system model developed in this thesis was then used to conduct a case study for a house comparing a constant nominal flow rate with a variable flow control strategy requiring a constant outlet temperature. The thermal storage tank case predicted solar fractions of 26.4% and 26.7% for constant and variable flow, while the counter flow heat exchanger case predicted 8.5% and 8.0% respectively. The largest sources of discrepancy between the control strategies were timesteps with low solar irradiation in the mornings when the tank temperature was also below the target temperature; in this set of conditions, the constant flow strategy was able to operate but the variable flow strategy was not. Detailed analysis of the counter flow heat exchanger simulation was conducted to identify the pattern between optimal flow rate points. Individual timesteps were simulated using a range of flow rates, and it was determined that the optimal flow rate occurred when the heat capacity of the solar loop and the heating side heat exchanger loop were equal. A similar analysis was undertaken for the thermal storage tank system, where tank starting temperatures, heating supply temperatures, and solar insolation values were varied. In all cases, the thermal mass of the tank was able to absorb the useful solar heat gains such that increased solar flow always yielded greater thermal efficiency. Ten sample time steps were simulated with the counter flow heat exchanger system to investigate the impact of heating supply temperature and building heating load on optimal flow rate. It was found that at higher heating supply temperatures, the overall solar heat gains were reduced, but the relative difference between optimal and nominal flow rates increased. The test case with a 78

5°C difference between heating supply and return temperatures showed a 0.7% relative increase in thermal efficiency from nominal to optimal flow, and the case with a 30°C difference had a 17.1% increase. To summarize, an optimal variable flow rate strategy for PVTs shows significant potential to increase thermal efficiency in systems not using thermal storage and is increasingly effective the larger the temperature difference between the heating supply and return temperatures are. In systems with thermal storage, increased flow rate always increased thermal efficiency of the solar array. It is worth emphasising that the conditions in which variable flow is the most beneficial are far less thermally efficient overall. Both thermal storage and low temperature differences between the process supply and return vastly outperform the relative benefit of optimal variable flow over constant flow in the case without thermal storage and with a high process supply-return temperatures. As such, the findings of this thesis should not be used as defining design principles when considering new solar thermal projects, and rather an upgrade to solar thermal systems in which the conditions are conducive to benefit from the optimal variable flow rate strategy. The potential implications of this research are significant. The optimal flow rate strategy defined in this thesis can be applied to any process using a fluid loop to deliver heat and is connected to a solar thermal loop via a counter flow heat exchanger; with thermal storage, there is no such benefit. This is only a minor limitation, since it is common for solar thermal systems to be connected to industrial processes without thermal storage [2]. Possible candidates include building space heating, space cooling via absorption chillers, domestic hot water, and industrial processes. Processes requiring temperatures outside the feasible range of PVT collectors for their climate could use the optimal flow rate strategy with more appropriate solar thermal collector types, such as dedicated solar thermal flat plates, or evacuated tubes. Furthermore, this strategy 79

would require only small modifications from a system using a constant flow rate: Variable speed pumps for the solar loop, and flow rate sensors to match the flow rate of the solar loop to that of the process loop. The simplicity of the solution combined with its flexibility to be used at different process supply and return temperatures mean that it has the potential to benefit a wide range of applications. By applying the modeling techniques developed in this thesis, more sophisticated feasibility analysis of solar PVT (and flat plate collector) systems can be undertaken and the benefit of variable flow to permit optimal flow control can be quantified. Improving the thermal efficiency of both existing solar thermal systems and new projects in the future will add to the ability for this technology to mitigate GHG emissions, and combat climate change. One limitation of this study is that only one building typology, one solar collector type, and a single climate zone have been simulated using the model and optimal flow rate strategy developed in this thesis. Future research to investigate the variable-flow approach using different types and combinations of solar collectors such as selective flat plate and evacuated tubes should be considered, as well as different building types, target processes, and climates. In addition, while the strategy to identify the optimal flowrate has been developed, the translation of this strategy into a real-world controls strategy has not been implemented and is a topic warranting further investigation. This included financial analysis comparing the cost of implementing flow rate controls with fuel savings associated with the additional thermal energy obtained from the solar thermal system. Such simulations and analysis would add greatly to this line of investigation and enhance the ability of this research support ongoing climate change mitigation efforts through reduced reliance on fossil fuels.

80

Appendix A: Common Procedure

The following pages describe the Maple code that is common to all of the PVT simulations. Initial parameters are defined, such as physical panel characteristics, fluid heat capacities, and thermal storage tank variables. The procedures that follow replicate the Duffie-Beckman method for determining the output for a solar thermal flat plate panel under a given set of conditions, modified to include the effects of the PV laminate. Procedures in Maple are blocks of executable operations, which are resolved in order, line by line. Each time a procedure is called, it will complete all operations within it and output the "return" values specified at the end of the procedure. The "CoverTemp" procedure updates the cover temperature, heat loss components, and overall loss coefficient for a given guess of plate temperature. The "CollEF" procedure updates the collector efficiency factor for a given overall loss coefficient. The "FlatPlateSim" procedure calls the above procedures to perform the iterative DuffieBeckman calculation method, and outputs the final panel outputs and condition once it has converged within the designated tolerance values. The "FlatPlateStag" procedure is similar to the "FlatePlateSim", except it simulates the panel when there is no fluid flow through it, and returns its stagnation temperature. Finally, the input matrix containing 52,561 rows is created; each containing the weather and heating load inputs for a 10 minute timestep.

81

8  d 5.67$10K

5.67 # 10 - 8 Temperature of ambient air (K) Ta d 264.4 264.4 Sky temperature (K) Ts d Ta K 6 258.4 Wind Velocity (m/s) v d 2.5 2.5 Emissivity of cover ec d 0.88 0.88 Emissivity of plate ep d 0.9 0.9 Length of air gap (m) L d 0.025 0.025 Tilt of collector (° from horizontal)  d 45 45 o d cos 45$Pi 180 1 2
at 5 digits

(1)

(2)

(3)

(4)

(5)

(6)

(7)

(8)

2

(9)

0.70710 o d (10) 0.70710 Heat Capacity of air (kJ/kg*K) Cpa d 1.005 1.005 Heat capacity of fluid (kJ/kG*K) cpf d 4.18 4.18 Width between pipes (m) Error, missing operator or `;` W d 0.2 0.2 Pipe Diameter (m) d d 0.01 0.01 Pipe-Fluid heat transfer coefficient (W/m2C) 82

(10) (11)

(12)

(13)

(14)

(15)

hfi d 400 400 Plate thickness (m) k d 0.0004 0.0004 Plate conductivity (W/mC)  d 400 400 Mass flow rate through collector (kg/s) mfr d 0.00340625 0.00340625 Area of collector (m2) Ac d 39.75 39.75 Solar irradience on collector surface (MJ/m2/h) S d 2.448 2.448 Inlet water temperature (K) Ti d 303 303 Assumed value for side and bottom losses Usb d 1.5 1.5 Lower target output temperature (K) TarTo1 d 310 310 Upper target output temperature (K) TarTo2 d 358 358 Absorptivity  d 0.95 0.95 Cover Transmittance  d 0.92 0.92 Tank Volume (m3) TankV d 2 2 Tank fluid heat capacity (MJ/kg*K) TankfCp d 0.00418 0.00418 Tank fluid density (kg/m3) 83 (29) (28) (27) (26) (25) (20) (19) (18) (17) (16)

(21)

(22)

(23)

(24)

Tank d 1000 1000 mTank d TankV$Tank 2000 Tank heat capacity total (MJ/K) TankCp d TankV$Tank$TankfCp 8.36000 Initial tank temp (K) TankTint d 308 308 HVAC return temperature (K) T_HVACret d 303 303 HVAC supply temperature (K) T_HVACsup d 333 333 (35) (34) (33) (32) (31) (30)

CoverTemp dproc Tp, Tc, v, Ts, L, o, Cpa, ec, ep, Usb local a, , k, , x1, x2, x3, x4, Ra, Nu, Nu1, Nu2, y1, y2, Ut, newcover; 0.0035$101325 a d ; Tp C Tc 2
14  dK 1.1555$10K $

Tc C Tp 2

3

11 C 9.5728$10K $

Tc C Tp 2

2

8 C 3.7604$10K $

Tc C Tp 2

6 K3.4484$10K ; Tc C Tp 3 Tc C Tp 2 1 11 8 4 1.5207$10K * K4.8574$10K * C 1.0184$10K kd 2 2 1000 Tc C Tp 4 * K3.9333$10K ; 2 k d ; a$Cpa 1 9.81$ $abs Tp K Tc $L3 Tc C Tp 2 Ra d ; $ 1708 1708 if 1 K ! 0 then Nu1 d 0 else Nu1 d 1 K end if; Ra$o Ra$o Ra$o 0.3333 Ra$o 0.3333 K 1 ! 0 then Nu2 d 0 else Nu2 d K 1end if; if 5830 5830

84

1708$ sin 1.8$ Nu d 1 C 1.44 1 K Ra$o $ Tp C Tc Tp2 C Tc2 x1 d ; 1 1 C K 1 ep ec Nu$k$1000 x2 d ; L x3 d $ec$ Tc C Ts Tc2 C Ts2 ; x4 d 2.8 C 3 v; 1 y1 d ; x3 C x4 1 y2 d ; x2 C x1 1 Ut d C Usb; y1 C y2 Ut$ Tp K Ta newcover d Tp K ; x1 C x2 return newcover, Ut; end proc CollEF dproc W, d, hfi, k, , Ut local m, F, Fprime; Ut md ; k$ C 0.04$84 m$ W K d tanh 2 Fd ; m$ W K d 2 Fprime d end proc

1.6

$Nu1 C Nu2;

1 Ut 1 1 1 1 W$ C C C Ut$ d C W K d $F 100$W 100 $d$hfi

;

FlatPlateSim dproc Ta, v, Ts, L, o, Cpa, ec, ep, Usb, W, d, hfi, k, , mfr, Ac, S, Ti, cpf, ,  local Tpinit, Tcinit, Ut, Tc, Tp, newTc, Fprime, Fr, Qu, c, To, newTp, Pitt, Tfm, Qe, e; Tpinit d Ta C 50; Tp d Tpinit; newTp d Tp C 50; Pitt d 0; while abs newTp K Tp O 0.1 do Ta C Tpinit Ta C newTp if Pitt = 0 then Tcinit d else Tcinit d end if; 2 2 85

Tc d Tcinit; if Pitt O 0 then Tp d newTp end if; newTc, Ut d CoverTemp Tp, Tc, v, Ts, L, o, Cpa, ec, ep, Usb ; while abs newTcK Tc O 0.1 do Tc d newTc; newTc, Ut d CoverTemp Tp, Tc, v, Ts, L, o, Cpa, ec, ep, Usb ; end do; Tc d newTc; Fprime d CollEF W, d, hfi, k, , Ut ; mfr$cpf$1000 Ac$Ut$Fprime Fr d $ 1 K exp K Ac$Ut mfr$cpf$1000 Qu d Ac$Fr$ newTp d Ti C Qu d Ac$Fr$ $3600 ; newTp d Ti C Pitt d Pitt C 1; Qu Ac Fr$Ut 1 K Fr $1000000 ; 3600 S$$ K S$0.12 K Ut$ Ti K Ta $ Qu Ac Fr$Ut $ 1 K Fr $1000000 ; 3600 K Ut$ Ti K Ta $ 1 1000000

; 1 1000000 $3600 ;

S$$ K S$ 0.12$ 1 K 0.0045$ newTp K 298

$

if Pitt O 9 then newTp d end do; Qu c d ; S$Ac To d Ti C

newTp C Tp ; end if; 2

Qu ; mfr$3600$cpf 1000 Qu Fr 1K $1000000 Ac Fprime Tfm d Ti C $ ; 3600 Fr$Ut Qe d S$ 0.12$ 1 K 0.0045$ newTp K 298 $Ac; Qe e d ; Ac$S return Qu, c, To, Tp, Qe, e; end proc

FlatPlateStag dproc Ta, v, Ts, L, o, Cpa, ec, ep, Usb, W, d, hfi, k, , mfr, Ac, S, Ti, cpf, ,  local Tpinit, Tcinit, Ut, Tc, Tp, newTc, Fprime, Fr, Qu, c, To, newTp, Pitt, Tfm, Qe, e; Tpinit d Ta C 50; 86

Tp d Tpinit; newTp d Tp C 50; Pitt d 0; while abs newTp K Tp O 0.1 do Ta C Tpinit Ta C newTp if Pitt = 0 then Tcinit d else Tcinit d end if; 2 2 Tc d Tcinit; if Pitt O 0 then Tp d newTp end if; newTc, Ut d CoverTemp Tp, Tc, v, Ts, L, o, Cpa, ec, ep, Usb ; while abs newTcK Tc O 0.1 do Tc d newTc; newTc, Ut d CoverTemp Tp, Tc, v, Ts, L, o, Cpa, ec, ep, Usb ; end do; Tc d newTc; S$ newTp d Ta C S$ newTp d Ta C Pitt d Pitt C 1; if Pitt O 9 then newTp d end do; Qe d S$ 0.12$ 1 K 0.0045$ newTp K 298 Qe e d ; Ac$S return Tp, Qe, e; end proc $Ac; newTp C Tp ; end if; 2 1000000 3600 1000000 3600 $$ K S$ Ut $$ K S$ 1000000 3600 1000000 3600 $0.12 ; $ 0.12$ 1 K 0.0045$ newTp K 298 Ut ;

with ExcelTools : inputs d Import 1..52561 x 1..4 Array Data Type: anything Storage: rectangular Order: Fortran_order (36)

87

Appendix B: PVT annual simulation with counterflow heat exchanger and constant panel flow rate

This is the Maple code used to simulate the full system with a counter flow heat exchanger and a constant flow rate through the solar thermal panels. A loop simulates each timestep by extracting the weather and heating load data from the input matrix, performing the procedure described in Section 6, and exporting the results to the outputs matrix. The flat plate procedures are run at the beginning of each timestep if there is solar radiation available. If the outlet temperature is greater than the heating loop return temperature, the solar loop runs for that timestep.

88

outputsTar1 d Matrix 52561, 12 52561 x 12 Matrix Data Type: anything Storage: rectangular Order: Fortran_order testrun dproc TarTo1, TarTo2, TankCp, TankTint, cpf, TankfCp, T_HVACret, T_HVACsup, mTank description "Simulation of system with counter flow heat exchanger. Constant flow rate. System operates if solar outlet temperature is higher than heating loop return temperature"; local v, Ta, To, Ti, Tiprev, S, mfrinit, Qu, , Ts, i, FItt, mfrprev, mfr, mfrstep, half, prevchange, QuAdj, Tp, Qe, e, TarToNom, TarTo, endloop, tankT, QuReal, Qaux, mfrb, Tsup, Tret, TimeStep, Cmin, case, Loopstart, Loopend, mfrtprev, mfrm, THXout, cpb; TarToNom d TarTo1; Tsup d T_HVACsup; Tret d T_HVACret; cpb d TankfCp; TimeStep d 600; for i from 1 to 52561 do endloop d 0; TarTo d 310; Ta d inputs i, 1 C 273; Ts d Ta K 6; v d inputs i, 2 ; S d inputs i, 3 ; Bload d inputs i, 4 ; mfrinit d 0.001$Ac; mfr d mfrinit; FItt d 1; #print "Time step" = i ; # initial conditions if i = 1 then Ti d 303; end if; Bload$ K 1 ; cpb$ Tsup K Tret $TimeStep mfr d 0.02$Ac; mfrb d if S = 0 then #print "There is no sun" ; outputsTar1 i, 1 ..3 d 0; 89 (1)

outputsTar1 i, 4 d Ta; outputsTar1 i, 5 ..8 d 0; outputsTar1 i, 10 d Ta; To d Ta; mfr d 0; Ti d Ta; THXout d Tret; else #print "Ti is" = Ti ; Ti d Tret; Qu, c, To, Tp, Qe, e d FlatPlateSim Ta, v, Ts, L, o, Cpa, ec, ep, Usb, W, d, hfi, k, , mfr, Ac, S, Ti, cpf, ,  ; #print "initial To is" = To ; end if; if To O Tret and Bload ! 0 then #print "To was greater than Ti and Tret" ; #initial guess for mfrHX is mfrb. If the output of the HX on the building side is greater than Tsup, then mfrHX needs to be reduced mfrHX d mfrb; #print "mfrHX initial is" = mfrHX ; mfr$cpf Cmin d min , mfrHX$cpb ; 1000 0.7$Cmin$ To K Tret THXout d Tret C ; #print "initial THXout is" = THXout ; mfrHX$cpb 0.7$Cmin$ To K Tret Ti d To K ; #print "initial Ti is" = Ti ; mfr$cpf 1000 Loopstart d 1; while abs mfrHXprevK mfrHX O 0.001 or Loopstart = 1 do Loopstart d 0; mfrHXprev d mfrHX; Loopstart d 1; while abs Tiprev K Ti O 0.01 or Loopstart = 1 do Loopstart d 0; Tiprev d Ti; Qu, c, To, Tp, Qe, e d FlatPlateSim Ta, v, Ts, L, o, Cpa, ec, ep, Usb, W, d, hfi, k, , mfr, Ac, S, Ti, cpf, ,  ; #print "New To is" = To ; 0.7$Cmin$ To K Tret THXout d Tret C ; #print "new THXout is" = THXout ; mfrHX$cpb 0.7$Cmin$ To K Tret ; #print "new Ti is" = Ti ; Ti d To K mfr$cpf 1000 end do; 90

#end of Ti convergance loop Tsup$mfrb K THXout$mfrb ; #print "mfrm new is" = mfrm ; Tret K THXout mfrHX d mfrb K mfrm; if mfrHX O mfrb or mfrHX ! 0 then #print "mfrHX=mfrb" ; mfrHX d mfrb; mfrm d 0; end if; mfr$cpf Cmin d min , mfrHX$cpb ; 1000 end do; #end of mfrHX convergance loop # Calculate useful heat added to tank from solar if solar loop was run mfr$TimeStep$cpf QuReal d $ To K Ti ;#print "QuReal is" = QuReal ; 1000 outputsTar1 i, 8 d QuReal; outputsTar1 i, 1 d mfr; outputsTar1 i, 2 d Qu; outputsTar1 i, 3 d c; outputsTar1 i, 4 d To; outputsTar1 i, 5 d Tp; outputsTar1 i, 6 d Qe; outputsTar1 i, 7 d e; outputsTar1 i, 10 d Ti; end if; #end of solar should run case if S O 0 and To ! Tret or To ! Ti or S O 0 and Bload = 0 then #solar should not run, calc stagnation temp #print "To is less than Tret and Ti, and there is sun" ; mfr d 0; Tp, Qe, e d FlatPlateStag Ta, v, Ts, L, o, Cpa, ec, ep, Usb, W, d, hfi, k, , mfr, Ac, S, Ti, cpf, ,  ; Ti d Tp; outputsTar1 outputsTar1 outputsTar1 outputsTar1 outputsTar1 outputsTar1 i, 1 ..3 d 0; i, 4 d To; i, 5 d Tp; i, 6 d Qe; i, 7 d e; i, 8 d 0; 91

mfrm d

outputsTar1 i, 10 d Ti; THXout d Tret; end if; if THXout ! Tsup then Qaux d mfrb$TimeStep$cpb$ Tsup K THXout ; outputsTar1 i, 9 d Qaux; else outputsTar1 i, 9 d 0; end if; #TidTo; end do; #End of time step loop end proc testrun TarTo1, TarTo2, TankCp, TankTint, cpf, TankfCp, T_HVACret, T_HVACsup, mTank 52561 x 12 Matrix Data Type: anything Storage: rectangular Order: Fortran_order (2)

with ExcelTools : Export outputsTar1, "Raw_Results 1.1.xlsx"

92

Appendix C: PVT annual simulation with counterflow heat exchanger and variable panel flow rate to achieve constant outlet temperature

This is the Maple code used to simulate the full system with a counter flow heat exchanger and a variable flow rate through the solar thermal panels to achieve a constant outlet temperature. A loop simulates each timestep by extracting the weather and heating load data from the input matrix, performing the procedure described in Section 6, and exporting the results to the outputs matrix. The flat plate procedures are run at the beginning of each timestep if there is solar radiation available. The initial guess for flow rate is the minimum value for the panel that is specified, as it will produce the highest possible outlet temperature. If that output temperature is greater than the target outlet temperature specified, the solar loop runs for that timestep. New flow rates are guessed using the bi-section numerical method until the flow rate corresponding to the target outlet temperature for a timestep is found.

93

outputsTar1 d Matrix 52561, 12 52561 x 12 Matrix Data Type: anything Storage: rectangular Order: Fortran_order testrun dproc TarTo1, TarTo2, TankCp, TankTint, cpf, TankfCp, T_HVACret, T_HVACsup, mTank description "Simulation of system with counter flow heat exchanger. Variable flow rate to achieve target temperature. system operates if solar outlet temperature is higher than heating loop return temperature"; local v, Ta, To, Ti, Tiprev, S, mfrinit, Qu, , Ts, i, FItt, mfrprev, mfr, mfrstep, half, prevchange, QuAdj, Tp, Qe, e, TarToNom, TarTo, endloop, tankT, QuReal, Qaux, mfrb, Tsup, Tret, TimeStep, Cmin, case, Loopstart, Loopend, mfrtprev, mfrm, THXout, cpb; TarToNom d TarTo1; Tsup d T_HVACsup; Tret d T_HVACret; cpb d TankfCp; TimeStep d 600; for i from 1 to 52561 do endloop d 0; TarTo d 310; Ta d inputs i, 1 C 273; Ts d Ta K 6; v d inputs i, 2 ; S d inputs i, 3 ; Bload d inputs i, 4 ; mfrinit d 0.001$Ac; mfr d mfrinit; FItt d 1; #print "Time step" = i ; # initial conditions if i = 1 then Ti d 303; end if; mfrb d Bload$ K 1 ; cpb$ Tsup K Tret $TimeStep (1)

if S = 0 then #print "There is no sun" ; outputsTar1 i, 1 ..3 d 0; outputsTar1 i, 4 d Ta; 94

outputsTar1 i, 5 ..8 d 0; outputsTar1 i, 10 d Ta; To d Ta; mfr d 0; Ti d Ta; THXout d Tret; else #print "initial Ti is" = Ti ; #print "initial mfr is" = mfr ; #TidTret; Qu, c, To, Tp, Qe, e d FlatPlateSim Ta, v, Ts, L, o, Cpa, ec, ep, Usb, W, d, hfi, k, , mfr, Ac, S, Ti, cpf, ,  ; #print "initial To is" = To ; end if; if To O TarTo and Bload ! 0 then #mfr can be increased, mfrstep is set mfrprev d mfrinit; mfr d mfrprev C 0.01$Ac; mfrstep d abs mfr K mfrprev ; prevchange d 2; #print "To was greater than Ti and TarTo" ; #initial guess for mfrHX is mfrb. If the output of the HX on the building side is greater than Tsup, then mfrHX needs to be reduced mfrHX d mfrb; #print "mfrHX initial is" = mfrHX ; mfr$cpf Cmin d min , mfrHX$cpb ; 1000 0.7$Cmin$ To K Tret THXout d Tret C ; #print "initial THXout is" = THXout ; mfrHX$cpb 0.7$Cmin$ To K Tret ; #print "Ti initial is" = Ti ; Ti d To K mfr$cpf 1000 Loopstart d 1; while abs mfrHXprevK mfrHX O 0.001 or Loopstart = 1 do Loopstart d 0; mfrHXprev d mfrHX; Loopstart d 1; while abs Tiprev K Ti O 0.01 or Loopstart = 1 do Loopstart d 0; Tiprev d Ti; if To O TarTo K 0.03 and mfr R mfrb then Qu, c, To, Tp, Qe, e d FlatPlateSim Ta, v, Ts, L, o, Cpa, ec, ep, Usb, W, d, hfi, k, , mfr, Ac, S, Ti, cpf, 95

,  ; #print "To is" = To ; else Loopstart d 1; endloop d 0; while abs To K TarTo O 0.03 and To O 0 and endloop = 0 or Loopstart = 1 do Loopstart d 0; #print Ta, v, Ts, L, o, Cpa, ec, ep, Usb, W, d, hfi, k, , mfr, Ac, S, Ti, cpf, ,  ; #print "mfr is" = mfr ; Qu, c, To, Tp, Qe, e d FlatPlateSim Ta, v, Ts, L, o, Cpa, ec, ep, Usb, W, d, hfi, k, , mfr, Ac, S, Ti, cpf, ,  ; #print "To in loop is" = To ; mfrprev d mfr; if abs To K TarTo O 0.03 then if To O TarTo then if prevchange = 2 then mfr d mfr C mfrstep; else mfrstep mfrstep d ; 2 prevchange d 2; mfr d mfr C mfrstep; end if; else if prevchange = 2 then mfrstep mfrstep d ; 2 prevchange d 1; mfr d mfr K mfrstep; else mfr d mfr K mfrstep; prevchange d 1; end if; end if; FItt d FItt C 1; if mfr O 8.94 then mfr d 8.94; endloop d 1; end if; if mfr ! mfrinit then mfr d mfrinit; endloop d 1; end if; if To O TarTo K 0.03 and mfrprev R mfrb then endloop d 1; mfr d mfrprev end if; end if; end do; end if; Cmin d min mfr$cpf , mfrHX$cpb ; 1000 0.7$Cmin$ To K Tret ; #print "new THXout is" = THXout ; mfrHX$cpb 96

THXout d Tret C

Ti d To K

0.7$Cmin$ To K Tret ; #print "New Ti is" = Ti ; mfr$cpf 1000

end do; #end of Ti convergance loop Tsup$mfrb K THXout$mfrb ; #print "mfrm new is" = mfrm ; Tret K THXout mfrHX d mfrb K mfrm; mfrm d if mfrHX O mfrb or mfrHX ! 0 then #print "mfrHX=mfrb" ; mfrHX d mfrb; mfrm d 0; end if; mfr$cpf Cmin d min , mfrHX$cpb ; 1000 end do; #end of mfrHX convergance loop # Calculate useful heat added to tank from solar if solar loop was run mfr$TimeStep$cpf QuReal d $ To K Ti ;#print "QuReal is" = QuReal ; 1000 outputsTar1 i, 8 d QuReal; outputsTar1 i, 1 d mfr; outputsTar1 i, 2 d Qu; outputsTar1 i, 3 d c; outputsTar1 i, 4 d To; outputsTar1 i, 5 d Tp; outputsTar1 i, 6 d Qe; outputsTar1 i, 7 d e; outputsTar1 i, 10 d Ti; end if; #end of solar should run case 0.04 or To ! Ti or mfr = mfrinit or Bload = 0 then if S O 0 and To ! TarTo K #solar should not run, calc stagnation temp #print "To is less than TarTo and Ti, and there is sun" ; print "To is" = To ; mfr d 0; Tp, Qe, e d FlatPlateStag Ta, v, Ts, L, o, Cpa, ec, ep, Usb, W, d, hfi, k, , mfr, Ac, S, Ti, cpf, ,  ; Ti d Tp; outputsTar1 i, 1 ..3 d 0; outputsTar1 i, 4 d To; 97

outputsTar1 outputsTar1 outputsTar1 outputsTar1 outputsTar1

i, 5 d Tp; i, 6 d Qe; i, 7 d e; i, 8 d 0; i, 10 d Ti;

THXout d Tret; end if; if THXout ! Tsup then Qaux d mfrb$TimeStep$cpb$ Tsup K THXout ; outputsTar1 i, 9 d Qaux; else outputsTar1 i, 9 d 0; end if; #TidTo; end do; #End of time step loop end proc testrun TarTo1, TarTo2, TankCp, TankTint, cpf, TankfCp, T_HVACret, T_HVACsup, mTank 52561 x 12 Matrix Data Type: anything Storage: rectangular Order: Fortran_order with ExcelTools : Export outputsTar1, "Raw_Results 1.1.xlsx" (2)

98

Appendix D: PVT annual simulation with counterflow heat exchanger and variable panel flow rate to achieve optimal thermal efficiency

This is the Maple code used to simulate the full system with a counter flow heat exchanger and a variable flow rate through the solar thermal panels to achieve optimal thermal efficiency. A loop simulates each timestep by extracting the weather and heating load data from the input matrix, performing the procedure described in Section 6, and exporting the results to the outputs matrix. The flat plate procedures are run at the beginning of each timestep if there is solar radiation available. The flow rate is always set to that of the building heating loop, and is updated along with it when it changes. If the output temperature is greater than the heating loop return temperature, the solar loop runs for that timestep.

99

outputsTar1 d Matrix 52561, 12 52561 x 12 Matrix Data Type: anything Storage: rectangular Order: Fortran_order testrun dproc TarTo1, TarTo2, TankCp, TankTint, cpf, TankfCp, T_HVACret, T_HVACsup, mTank description "Simulation of system with counter flow heat exchanger. Optimal flow rate by matching stream heat capacities. System operates a solar outlet temperature higher than heating loop return temperature exisits"; local v, Ta, To, Ti, Tiprev, S, mfrinit, Qu, , Ts, i, FItt, mfrprev, mfr, mfrstep, half, prevchange, QuAdj, Tp, Qe, e, TarToNom, TarTo, endloop, tankT, QuReal, Qaux, mfrb, Tsup, Tret, TimeStep, Cmin, case, Loopstart, Loopend, mfrtprev, mfrm, THXout, cpb; Tsup d T_HVACsup; Tret d T_HVACret; TimeStep d 600; cpb d TankfCp; for i from 1 to 52561 do endloop d 0; TarTo d 310; Ta d inputs i, 1 C 273; Ts d Ta K 6; v d inputs i, 2 ; S d inputs i, 3 ; Bload d inputs i, 4 ; mfrinit d 0.001$Ac; mfr d mfrinit; FItt d 1; #print "Time step" = i ; # initial conditions if i = 1 then Ti d 303; end if; Bload$ K 1 ; cpb$ Tsup K Tret $TimeStep mfr d mfrb; mfrb d if S = 0 then #print "There is no sun" ; outputsTar1 i, 1 ..3 d 0; outputsTar1 i, 4 d Ta; 100 (1)

outputsTar1 i, 5 ..8 d 0; outputsTar1 i, 10 d Ta; To d Ta; mfr d 0; Ti d Ta; THXout d Tret; else #print "Ti is" = Ti ; #TidTret; Qu, c, To, Tp, Qe, e d FlatPlateSim Ta, v, Ts, L, o, Cpa, ec, ep, Usb, W, d, hfi, k, , mfr, Ac, S, Ti, cpf, ,  ; #print "initial To is" = To ; end if; if To O Tret and Bload ! 0 then #print "To was greater than Ti and Tret" ; #initial guess for mfrHX is mfrb. If the output of the HX on the building side is greater than Tsup, then mfrHX needs to be reduced mfrHX d mfrb; #print "mfrHX initial is" = mfrHX ; mfr d mfrHX; mfr$cpf Cmin d min , mfrHX$cpb ; 1000 0.7$Cmin$ To K Tret THXout d Tret C ; #print "initial THXout is" = THXout ; mfrHX$cpb 0.7$Cmin$ To K Tret Ti d To K ; #print "initial Ti is" = Ti ; mfr$cpf 1000 Loopstart d 1; while abs mfrHXprevK mfrHX O 0.001 or Loopstart = 1 do Loopstart d 0; mfrHXprev d mfrHX; mfr d mfrHX; Loopstart d 1; while abs Tiprev K Ti O 0.01 or Loopstart = 1 do Loopstart d 0; Tiprev d Ti; Qu, c, To, Tp, Qe, e d FlatPlateSim Ta, v, Ts, L, o, Cpa, ec, ep, Usb, W, d, hfi, k, , mfr, Ac, S, Ti, cpf, ,  ; #print "New To is" = To ; 0.7$Cmin$ To K Tret THXout d Tret C ; #print "new THXout is" = THXout ; mfrHX$cpb 0.7$Cmin$ To K Tret ; #print "new Ti is" = Ti ; Ti d To K mfr$cpf 1000 end do; 101

#end of Ti convergance loop Tsup$mfrb K THXout$mfrb ; #print "mfrm new is" = mfrm ; Tret K THXout mfrHX d mfrb K mfrm; if mfrHX O mfrb or mfrHX ! 0 then #print "mfrHX=mfrb" ; mfrHX d mfrb; mfrm d 0; end if; mfr d mfrHX; Cmin d min mfr$cpf , mfrHX$cpb ; 1000

mfrm d

end do; #end of mfrHX convergance loop # Calculate useful heat added to tank from solar if solar loop was run mfr$TimeStep$cpf QuReal d $ To K Ti ;#print "QuReal is" = QuReal ; 1000 outputsTar1 i, 8 d QuReal; outputsTar1 i, 1 d mfr; outputsTar1 i, 2 d Qu; outputsTar1 i, 3 d c; outputsTar1 i, 4 d To; outputsTar1 i, 5 d Tp; outputsTar1 i, 6 d Qe; outputsTar1 i, 7 d e; outputsTar1 i, 10 d Ti; mfr$cpf outputsTar1 i, 11 d ; 1000 outputsTar1 i, 12 d cpb$mfrHX; end if; #end of solar should run case if S O 0 and To ! Tret or To ! Ti or S O 0 and Bload = 0 then #solar should not run, calc stagnation temp #print "To is less than Tret and Ti, and there is sun" ; mfr d 0; Tp, Qe, e d FlatPlateStag Ta, v, Ts, L, o, Cpa, ec, ep, Usb, W, d, hfi, k, , mfr, Ac, S, Ti, cpf, ,  ; Ti d Tp; outputsTar1 i, 1 ..3 d 0; 102

outputsTar1 outputsTar1 outputsTar1 outputsTar1 outputsTar1 outputsTar1

i, 4 d To; i, 5 d Tp; i, 6 d Qe; i, 7 d e; i, 8 d 0; i, 10 d Ti;

THXout d Tret; end if; if THXout ! Tsup then Qaux d mfrb$TimeStep$cpb$ Tsup K THXout ; outputsTar1 i, 9 d Qaux; else outputsTar1 i, 9 d 0; end if; #TidTo; end do; #End of time step loop end proc testrun TarTo1, TarTo2, TankCp, TankTint, cpf, TankfCp, T_HVACret, T_HVACsup, mTank 52561 x 12 Matrix Data Type: anything Storage: rectangular Order: Fortran_order with ExcelTools : Export outputsTar1, "Raw_Results 1.1.xlsx" (2)

103

Appendix E: PVT annual simulation with thermal storage tank and constant panel flow rate

This is the Maple code used to simulate the full system with a thermal storage tank and a constant flow rate through the solar thermal panels. A loop simulates each timestep by extracting the weather and heating load data from the input matrix, performing the procedure described in Section 5, and exporting the results to the outputs matrix. The flat plate procedures are run at the beginning of each timestep if there is solar radiation available. If the output temperature is greater than the tank top node temperature, the solar loop runs for that timestep.

104

outputsTar1 d Matrix 52561, 12 52561 x 12 Matrix Data Type: anything Storage: rectangular Order: Fortran_order testrun dproc TarTo1, TarTo2, TankCp, TankTint, cpf, TankfCp, T_HVACret, T_HVACsup, mTank description "Simulation of system with thermal storage tank. Constant flow rate. System operates if solar outlet temperature is higher than tank top node temperature"; local v, Ta, To, Ti, Tiprev, S, mfrinit, Qu, , Ts, i, FItt, mfrprev, mfr, mfrstep, half, prevchange, QuAdj, Tp, Qe, e, TarToNom, TarTo, endloop, tankT, QuReal, Qaux, Tmid, Ttop, Ttopnew, Tbot, Tbotnew, Ttopavg, Tbotavg, mfrb, Tsup, Tret, TimeStep, Cmin, case, Loopstart, Loopend, mfrt, mfrtprev, mfrm, SolarRun; TarToNom d TarTo1; Tsup d T_HVACsup; Tret d T_HVACret; TimeStep d 600; for i from 1 to 52561 do endloop d 0; TarTo d TarToNom; Ta d inputs i, 1 C 273; Ts d Ta K 6; v d inputs i, 2 ; S d inputs i, 3 ; Bload d inputs i, 4 ; mfrinit d 0.02$Ac; mfr d mfrinit; FItt d 1; SolarRun d 1; #print "Time step" = i ; # initial conditions if i = 1 then #QuReald0; #TtopdTankTint; #TbotdTankTint; Ttop d 303; Tbot d 303 ; Ti d 303; end if; outputsTar1 i, 8 d Ttop; outputsTar1 i, 9 d Tbot; mfrb d 1 Bload$ K ; TankfCp$ Tsup K Tret $TimeStep 105 (1)

if S = 0 then #print "no sun, To and Ti outputed as" ; outputsTar1 i, 1 ..3 d 0; outputsTar1 i, 4 d Ta; outputsTar1 i, 5 ..7 d 0; outputsTar1 i, 10 d 0; outputsTar1 i, 12 d Ta; To d 0; mfr d 0; else Ti d Tbot; Qu, c, To, Tp, Qe, e d FlatPlateSim Ta, v, Ts, L, o, Cpa, ec, ep, Usb, W, d, hfi, k, , mfr, Ac, S, Ti, cpf, ,  ; #print "solar ran" ; end if; if Ttop R 370 then mfr d 0; Tp, Qe, e d FlatPlateStag Ta, v, Ts, L, o, Cpa, ec, ep, Usb, W, d, hfi, k, , mfr, Ac, S, Ti, cpf, ,  ; Ti d Tp; outputsTar1 i, 1 ..3 d 0; outputsTar1 i, 4 d Tp; outputsTar1 i, 5 d Tp; outputsTar1 i, 6 d Qe; outputsTar1 i, 7 d e; outputsTar1 1, 12 d Tp; end if; if To O Ttop and mfr O 0 then #If ToOTtop then the solar loop should run for this time step #print "ToOTtop" ; mfr$cpf Cmin d ; 1000 if FItt = 1 then #Initial guess of Ttopavg is Ttop for first iteration of time step Ttopavg d Ttop; FItt d 0; end if; #Initial guess for Ttopavg is Ttop at begging of time step. Initial mfrt is cacled from this if Tret = Ttopavg then mfrt d mfrb; else Tsup$mfrb K Ttopavg$mfrb mfrm d ; Tret K Ttopavg mfrt d mfrb K mfrm; end if; if mfrt O mfrb or mfrt ! 0 then #print "mfrt=mfrb" ; mfrt d mfrb; mfrm d 0; 106

end if; Tbotnew d Tbot C 0.1; Ttopnew d Ttop C 0.1; Tbotavg d Tbot C 0.1; Loopstart d 1; while abs mfrt K mfrtprev O 0.001 or Loopstart = 1 do #mfrt convergance loop begins if Loopstart = 1 then Loopstart d 0; end if; mfrtprev d mfrt; Loopstart d 1; while abs Ti K Tiprev O 0.1 or Loopstart = 1 do if Loopstart = 1 then Loopstart d 0; end if; Tiprev d Ti; # Update tank and solar inlet temps iteratively Loopstart d 1; while abs Tbotnew K Tbotnewprev O 0.01 and abs Ttopnew K Ttopnewprev O 0.01 or Loopstart = 1 do if Loopstart = 1 then Loopstart d 0; end if; Tbotnewprev d Tbotnew; Ttopnewprev d Ttopnew; Ttopnew d 1 mTank $TankfCp 2 Tbotavg$TankfCp$mfrt C Cmin$To$0.7 Cmin$0.7 mfrt C mTank mTank $TankfCp 2 2
K

C

Ttop$mTank 2

$TankfCp K

Tbotavg$TankfCp$mfrt C Cmin$0.7$To $e Cmin$0.7 mfrt C mTank mTank $TankfCp 2 2

mfrt Cmin$0.7 C mTank mTank $TankfCp 2 2

$TimeStep

;

107

Ttopavg d

1 int TimeStep

1 mTank $TankfCp 2

Tbotavg$TankfCp$mfrt C Cmin$To$0.7 Cmin$0.7 mfrt C mTank mTank $TankfCp 2 2

C

Ttop$mTank Tbotavg$TankfCp$mfrt C Cmin$0.7$To $TankfCp K 2 Cmin$0.7 mfrt C mTank mTank $TankfCp 2 2
mfrt Cmin$0.7 C mTank mTank $TankfCp 2 2 $t

K

$e

, t = 0 ..TimeStep

;

Tmid d To K

To K Ttop $Cmin$0.7 ; mfr$cpf 1000

Tbotnew d

1 mTank $TankfCp 2

Tret$TankfCp$mfrt C Cmin$Tmid$0.7 C Cmin$0.7 mfrt C mTank mTank $TankfCp 2 2
K mfrt Cmin$0.7 C mTank mTank $TankfCp 2 2

Tbot$mTank $TankfCp 2

$TimeStep

K

Tret$TankfCp$mfrt C Cmin$0.7$Tmid $e Cmin$0.7 mfrt C mTank mTank $TankfCp 2 2 1 int TimeStep 1 mTank $TankfCp 2

;

Tbotavg d

Tret$TankfCp$mfrt C Cmin$Tmid$0.7 mfrt Cmin$0.7 C mTank mTank $TankfCp 2 2

C

Tbot$mTank Tret$TankfCp$mfrt C Cmin$0.7$Tmid $TankfCp K 2 Cmin$0.7 mfrt C mTank mTank $TankfCp 2 2
mfrt Cmin$0.7 C mTank mTank $TankfCp 2 2 $t

K

$e

, t = 0 ..TimeStep

;

108

Ti d Tmid K

Tmid K Tbot $Cmin$0.7 ; mfr$cpf 1000 #This becomes the updated average inlet temp to the panels for the current time step

Ttop d Ttopnew; Tbot d Tbotnew; end do; #End of tank and solar inlet temperature iteration loop Qu, c, To, Tp, Qe, e d FlatPlateSim Ta, v, Ts, L, o, Cpa, ec, ep, Usb, W, d, hfi, k, , mfr, Ac, S, Ti, cpf, ,  ; end do; #End of updating average inlet temp during time step iteration loop if Tret = Ttopavg then mfrt d mfrb; else Tsup$mfrb K Ttopavg$mfrb mfrm d ; Tret K Ttopavg mfrt d mfrb K mfrm; end if; if mfrt O mfrb or mfrt ! 0 then #print "mfrt=mfrb" ; mfrt d mfrb; mfrm d 0; end if; end do; #end of mfrt convergance loop else #if the solar loop from initial calc should not run for this time step because To ! Ttop #print "To!Ttop" ; if S O 0 then mfr d 0; Tp, Qe, e d FlatPlateStag Ta, v, Ts, L, o, Cpa, ec, ep, Usb, W, d, hfi, k, , mfr, Ac, S, Ti, cpf, ,  ; Ti d Tp; outputsTar1 outputsTar1 outputsTar1 outputsTar1 outputsTar1 outputsTar1 end if; i, 1 ..3 d 0; i, 4 d Tp; i, 5 d Tp; i, 6 d Qe; i, 7 d e; i, 12 d Tp;

109

if FItt = 1 then #Initial guess of Ttopavg is Ttop for first iteration of time step Ttopavg d Ttop; FItt d 0; end if; Loopstart d 1; while abs Ttopavg K Ttopavgprev O 0.01 or Loopstart = 1 do Loopstart d 0; Ttopavgprev d Ttopavg; if Tret = Ttopavg then mfrt d mfrb; else Tsup$mfrb K Ttopavg$mfrb mfrm d ; Tret K Ttopavg mfrt d mfrb K mfrm; end if; if mfrt O mfrb or mfrt ! 0 then #print "mfrt=mfrb" ; mfrt d mfrb; mfrm d 0; end if;
K mfrt $TimeStep mTank 2 mfrt $t mTank 2

Tbotnew d Tret C Tbot K Tret $e

;

K

Tbotavg d

int

Tret C Tbot K Tret $e TimeStep

, t = 0 ..TimeStep

;

# Update Top node
K mfrt $TimeStep mTank 2 mfrt K $t mTank 2

Ttopnew d Tbotavg C Ttop K Tbotavg $e int

;

Ttopavg d end do;

Tbotavg C Ttop K Tbotavg $e TimeStep

, t = 0 ..TimeStep

;

end if; #End of is To initally larger than Ttop, and should solar run? if statement if To ! Ttopavg and mfr O 0 then

110

#If the average solar output is lower than the average top node temp, instead do not run solar. This is if it was initally larger, but after running tank sim, it turns out not to be #print "sun, To was initally high enough but not after tank calc" ; mfr d 0; Tp, Qe, e d FlatPlateStag Ta, v, Ts, L, o, Cpa, ec, ep, Usb, W, d, hfi, k, , mfr, Ac, S, Ti, cpf, ,  ; Ti d Tp; outputsTar1 outputsTar1 outputsTar1 outputsTar1 outputsTar1 outputsTar1 i, 1 ..3 d 0; i, 4 d Tp; i, 5 d Tp; i, 6 d Qe; i, 7 d e; i, 12 d Tp;

if FItt = 1 then #Initial guess of Ttopavg is Ttop for first iteration of time step Ttopavg d Ttop; FItt d 0; end if; Loopstart d 1; while abs Ttopavg K Ttopavgprev O 0.01 or Loopstart = 1 do Loopstart d 0; Ttopavgprev d Ttopavg; if Tret = Ttopavg then mfrt d mfrb; else Tsup$mfrb K Ttopavg$mfrb mfrm d ; Tret K Ttopavg mfrt d mfrb K mfrm; end if; if mfrt O mfrb or mfrt ! 0 then #print "mfrt=mfrb" ; mfrt d mfrb; mfrm d 0; end if;
K mfrt $TimeStep mTank 2 mfrt $t mTank 2

Tbotnew d Tret C Tbot K Tret $e

;

K

Tbotavg d

int

Tret C Tbot K Tret $e TimeStep

, t = 0 ..TimeStep

;

# Update Top node 111

K

Ttopnew d Tbotavg C Ttop K Tbotavg $e int

mfrt $TimeStep mTank 2 mfrt K $t mTank 2

;

Ttopavg d end do; end if;

Tbotavg C Ttop K Tbotavg $e TimeStep

, t = 0 ..TimeStep

;

# Calculate useful heat added to tank from solar if solar loop was run if To O Ttopavg and mfr O 0 then #print "sun, To was good enough to be useful" ; mfr$TimeStep$cpf $ To K Ti ;#print "QuReal is" = QuReal ; 1000 outputsTar1 i, 10 d QuReal; outputsTar1 i, 1 d mfr; outputsTar1 i, 2 d Qu; outputsTar1 i, 3 d c; outputsTar1 i, 4 d To;#print "To output is" = To ; outputsTar1 i, 5 d Tp; outputsTar1 i, 6 d Qe; outputsTar1 i, 7 d e; outputsTar1 i, 12 d Ti;#print "Ti output is" = Ti ; QuReal d end if; #End of if statement for if solar was run or not if Ttopavg ! Tsup then Qaux d mfrt$TimeStep$TankfCp$ Tsup K Ttopavg ; outputsTar1 i, 11 d Qaux; else outputsTar1 i, 11 d 0; end if; #Tank temperatures are det for next time step Ttop d Ttopnew; Tbot d Tbotnew; end do; #End of time step loop end proc testrun TarTo1, TarTo2, TankCp, TankTint, cpf, TankfCp, T_HVACret, T_HVACsup, mTank with ExcelTools : Export outputsTar1, "Test_Results1_C0.02.xlsx"

112

Appendix F: PVT annual simulation with thermal storage tank and variable panel flow rate to achieve a target outlet temperature

This is the Maple code used to simulate the full system with a thermal storage tank and a variable flow rate through the solar thermal panels to achieve a target outlet temperature. A loop simulates each timestep by extracting the weather and heating load data from the input matrix, performing the procedure described in Section 5, and exporting the results to the outputs matrix. The flat plate procedures are run at the beginning of each timestep if there is solar radiation available. The initial guess for flow rate is the minimum value for the panel that is specified, as it will produce the highest possible outlet temperature. If that output temperature is greater than the target outlet temperature specified, the solar loop runs for that timestep. If the output temperature is greater than the target outlet temperature, the solar loop runs for that timestep. New flow rates are guessed using the bi-section numerical method until the flow rate corresponding to the target outlet temperature for a timestep is found. The target outlet temperature is updated if the tank top node temperature becomes greater than the primary target. In this case, the new temporary target becomes a specified value about the current tank top node temperature.

113

outputsTar1 d Matrix 52561, 12 52561 x 12 Matrix Data Type: anything Storage: rectangular Order: Fortran_order testrun dproc TarTo1, TarTo2, TankCp, TankTint, cpf, TankfCp, T_HVACret, T_HVACsup, mTank description "Simulation of system with thermal storage tank. Variable flow rate to achieve target temperature. System operates if solar outlet temperature is higher than tank top node temperature"; local v, Ta, To, Ti, Tiprev, S, mfrinit, Qu, , Ts, i, FItt, mfrprev, mfr, mfrstep, half, prevchange, QuAdj, Tp, Qe, e, TarToNom, TarTo, endloop, tankT, QuReal, Qaux, Tmid, Ttop, Ttopnew, Tbot, Tbotnew, Ttopavg, Tbotavg, mfrb, Tsup, Tret, TimeStep, Cmin, case, Loopstart, Loopend, mfrt, mfrtprev, mfrm, SolarRun; TarToNom d TarTo1; Tsup d T_HVACsup; Tret d T_HVACret; TimeStep d 600; for i from 1 to 52561 do endloop d 0; TarTo d TarToNom; Ta d inputs i, 1 C 273; Ts d Ta K 6; v d inputs i, 2 ; S d inputs i, 3 ; Bload d inputs i, 4 ; mfrinit d 0.001$Ac; mfr d mfrinit; FItt d 1; SolarRun d 1; #print "Time step" = i ; # initial conditions if i = 1 then #QuReald0; #mfrd0; Ttop d 341.4265939; Tbot d 324.1565621; Ti d 286.8083333; end if; outputsTar1 i, 8 d Ttop; outputsTar1 i, 9 d Tbot; (1)

114

mfrb d

Bload$ K 1 ; TankfCp$ Tsup K Tret $TimeStep

if S = 0 then SolarRun d 0; #print "no sun, To and Ti outputed as" ; outputsTar1 i, 1 ..3 d 0; outputsTar1 i, 4 d Ta; #print "To is" = Ta ; outputsTar1 i, 5 ..7 d 0; outputsTar1 i, 10 d 0; outputsTar1 i, 12 d Ta; #print "Ti output is" = Ta ; To d 0; mfr d 0; else #TidTbot; Qu, c, To, Tp, Qe, e d FlatPlateSim Ta, v, Ts, L, o, Cpa, ec, ep, Usb, W, d, hfi, k, , mfr, Ac, S, Ti, cpf, ,  ; #print "solar ran" ; end if; #print "Ttop is" = Ttop ; #print "To is" = To ; if Ti O 373 or Ttop R 370 then SolarRun d 0; mfr d 0; Tp, Qe, e d FlatPlateStag Ta, v, Ts, L, o, Cpa, ec, ep, Usb, W, d, hfi, k, , mfr, Ac, S, Ti, cpf, ,  ; Ti d Tp; outputsTar1 outputsTar1 outputsTar1 outputsTar1 outputsTar1 outputsTar1 end if; i, 1 ..3 d 0; i, 4 d Tp; i, 5 d Tp; i, 6 d Qe; i, 7 d e; i, 12 d Tp;

if Ttop O Tsup then TarTo d Ttop C 1; else TarTo d Tsup C 0.5; end if; if To O TarTo and mfr O 0 then #If the output temperature at the minimum flow rate is higher than the target, begin iterating flow rate, else do not run solar for the time step mfrprev d mfrinit; mfr d mfrprev C 0.01$Ac; mfrstep d abs mfr K mfrprev ; prevchange d 2;

115

Cmin d

mfr$cpf ; 1000

if FItt = 1 then #Initial guess of Ttopavg is Ttop for first iteration of time step Ttopavg d Ttop; FItt d 0; end if; #Initial guess for Ttopavg is Ttop at begging of time step. Initial mfrt is cacled from this if Tret = Ttopavg then mfrt d mfrb; else Tsup$mfrb K Ttopavg$mfrb mfrm d ; Tret K Ttopavg mfrt d mfrb K mfrm; end if; if mfrt O mfrb then #print "mfrt=mfrb" ; mfrt d mfrb; mfrm d 0; end if; Tbotnew d Tbot C 0.1; Ttopnew d Ttop C 0.1; Tbotavg d Tbot C 0.1; Loopstart d 1; while abs mfrt K mfrtprev O 0.001 or Loopstart = 1 do #mfrt convergance loop begins if Loopstart = 1 then Loopstart d 0; end if; mfrtprev d mfrt; Loopstart d 1; while abs Ti K Tiprev O 0.1 or Loopstart = 1 do if Loopstart = 1 then Loopstart d 0; end if; Tiprev d Ti; #print "Ti prev is" = Tiprev ; mfr$cpf ; #Cmin is updated based on the new mfr 1000 # Update tank and solar inlet temps iteratively Cmin d

116

# if both mfr and mfrt are 0, then there is no solar flow or tank flow, and the tank temp will end up being the same as it was at the beggining of the time step if mfr = 0 and mfrt % 0 then Loopstart d 0; endloopTankt d 1; Ttopnew d Ttop; Tbotnew d Tbot; else Loopstart d 1; endloopTankt d 0; end if; while abs Tbotnew K Tbotnewprev O 0.01 and abs Ttopnew K Ttopnewprev O 0.01 and endloopTankt = 0 or Loopstart = 1 do if Loopstart = 1 then Loopstart d 0; end if; Tbotnewprev d Tbotnew; Ttopnewprev d Ttopnew; Ttopnew d 1 mTank $TankfCp 2 Tbotavg$TankfCp$mfrt C Cmin$To$0.7 Cmin$0.7 mfrt C mTank mTank $TankfCp 2 2
K

C

Ttop$mTank 2

$TankfCp K

Tbotavg$TankfCp$mfrt C Cmin$0.7$To $e Cmin$0.7 mfrt C mTank mTank $TankfCp 2 2 1 mTank $TankfCp 2

mfrt Cmin$0.7 C mTank mTank $TankfCp 2 2

$TimeStep

;

Ttopavg d

1 int TimeStep

Tbotavg$TankfCp$mfrt C Cmin$To$0.7 Cmin$0.7 mfrt C mTank mTank $TankfCp 2 2

C

Ttop$mTank Tbotavg$TankfCp$mfrt C Cmin$0.7$To $TankfCp K 2 Cmin$0.7 mfrt C mTank mTank $TankfCp 2 2
mfrt Cmin$0.7 C mTank mTank $TankfCp 2 2 $t

K

$e

, t = 0 ..TimeStep

;

117

Tmid d To K To K Ttopavg $0.7;

Tbotnew d

1 mTank $TankfCp 2

Tret$TankfCp$mfrt C Cmin$Tmid$0.7 C Cmin$0.7 mfrt C mTank mTank $TankfCp 2 2
K mfrt Cmin$0.7 C mTank mTank $TankfCp 2 2

Tbot$mTank $TankfCp 2

$TimeStep

K

Tret$TankfCp$mfrt C Cmin$0.7$Tmid $e Cmin$0.7 mfrt C mTank mTank $TankfCp 2 2 1 int TimeStep 1 mTank $TankfCp 2

;

Tbotavg d

Tret$TankfCp$mfrt C Cmin$Tmid$0.7 Cmin$0.7 mfrt C mTank mTank $TankfCp 2 2

C

Tbot$mTank Tret$TankfCp$mfrt C Cmin$0.7$Tmid $TankfCp K 2 Cmin$0.7 mfrt C mTank mTank $TankfCp 2 2
mfrt Cmin$0.7 C mTank mTank $TankfCp 2 2 $t

K

$e

, t = 0 ..TimeStep

;

#if Cmin=0 then there is no solar flow rate to reach TarTo, and the Ti loop needs to end if Cmin = 0 then Ti d Tiprev else Ti d Tmid K Tmid K Tbotavg $0.7; #This becomes the updated average inlet temp to the panels for the current time step end if; end do; #End of tank temperature iteration loop #Target output temperature for solar is updated based on the new tank temp if Ttopavg O Tsup then TarTo d Ttopavg C 1; else TarTo d Tsup C 0.5; end if; #print "Ttopavg is" = Ttopavg ; #print "target To is" = TarTo ; #New flow rate required to reach the target temp found, mfr and To updated

118

if Cmin = 0 then endloop d 1; Loopstart d 0; else endloop d 0; Loopstart d 1; end if; #if Cmin=0 then solar loop should not run, and the mfr loop does not need to run while abs To K TarTo O 0.3 and To O 0 and endloop = 0 or Loopstart = 1 do Loopstart d 0; #print "Ti in loop is" = Ti ; #print "mfr guess is" = mfr ; Qu, c, To, Tp, Qe, e d FlatPlateSim Ta, v, Ts, L, o, Cpa, ec, ep, Usb, W, d, hfi, k, , mfr, Ac, S, Ti, cpf, ,  ; #print "To in loop is" = To ; mfrprev d mfr; if abs To K TarTo O 0.3 then if To O TarTo then if prevchange = 2 then mfr d mfr C mfrstep; else mfrstep mfrstep d ; 2 prevchange d 2; mfr d mfr C mfrstep; end if; else if prevchange = 2 then mfrstep mfrstep d ; 2 prevchange d 1; mfr d mfr K mfrstep; else mfr d mfr K mfrstep; prevchange d 1; end if; end if; FItt d FItt C 1; if mfr O 8.94 then mfr d 8.94; endloop d 1; end if; if mfr ! mfrinit then mfr d mfrinit; endloop d 1; end if; end if; end do; end do; #End of updating average inlet temp during time step iteration loop if Tret = Ttopavg then mfrt d mfrb; else Tsup$mfrb K Ttopavg$mfrb mfrm d ; Tret K Ttopavg mfrt d mfrb K mfrm; 119

end if; if mfrt O mfrb then mfrt d mfrb; mfrm d 0; end if; end do; #end of mfrt convergance loop else #if the solar loop from initial calc should not run for this time step because To ! TarTo if S O 0 then mfr d 0; Tp, Qe, e d FlatPlateStag Ta, v, Ts, L, o, Cpa, ec, ep, Usb, W, d, hfi, k, , mfr, Ac, S, Ti, cpf, ,  ; Ti d Tp; outputsTar1 outputsTar1 outputsTar1 outputsTar1 outputsTar1 outputsTar1 end if; i, 1 ..3 d 0; i, 4 d Tp; i, 5 d Tp; i, 6 d Qe; i, 7 d e; i, 12 d Tp;

if FItt = 1 then #Initial guess of Ttopavg is Ttop for first iteration of time step Ttopavg d Ttop; FItt d 0; end if; Loopstart d 1; while abs Ttopavg K Ttopavgprev O 0.01 or Loopstart = 1 do Loopstart d 0; Ttopavgprev d Ttopavg; if Tret = Ttopavg then mfrt d mfrb; else Tsup$mfrb K Ttopavg$mfrb ; mfrm d Tret K Ttopavg mfrt d mfrb K mfrm; end if; if mfrt O mfrb then #print "mfrt=mfrb" ; mfrt d mfrb; mfrm d 0; end if;

120

K

Tbotnew d Tret C Tbot K Tret $e

mfrt $TimeStep mTank 2 mfrt $t mTank 2

;

K

Tbotavg d

int

Tret C Tbot K Tret $e TimeStep

, t = 0 ..TimeStep

;

# Update Top node
K mfrt $TimeStep mTank 2 mfrt K $t mTank 2

Ttopnew d Tbotavg C Ttop K Tbotavg $e int

;

Ttopavg d end do;

Tbotavg C Ttop K Tbotavg $e TimeStep

, t = 0 ..TimeStep

;

end if; #End of is To initally larger than Ttop, and should solar run? if statement if To ! Ttopavg and mfr O 0 then #If the average solar output is lower than the average top node temp, instead do not run solar. This is if it was initally larger, but after running tank sim, it turns out not to be #print "sun, To was initally high enough but not after tank calc" ; mfr d 0; Tp, Qe, e d FlatPlateStag Ta, v, Ts, L, o, Cpa, ec, ep, Usb, W, d, hfi, k, , mfr, Ac, S, Ti, cpf, ,  ; Ti d Tp; outputsTar1 outputsTar1 outputsTar1 outputsTar1 outputsTar1 outputsTar1 i, 1 ..3 d 0; i, 4 d Tp; i, 5 d Tp; i, 6 d Qe; i, 7 d e; i, 12 d Tp;

if FItt = 1 then #Initial guess of Ttopavg is Ttop for first iteration of time step Ttopavg d Ttop; FItt d 0; end if; Loopstart d 1; while abs Ttopavg K Ttopavgprev O 0.01 or Loopstart = 1 do Loopstart d 0; Ttopavgprev d Ttopavg; 121

if Tret = Ttopavg then mfrt d mfrb; else Tsup$mfrb K Ttopavg$mfrb mfrm d ; Tret K Ttopavg mfrt d mfrb K mfrm; end if; if mfrt O mfrb or mfrt ! 0 then #print "mfrt=mfrb" ; mfrt d mfrb; mfrm d 0; end if;
K mfrt $TimeStep mTank 2 mfrt $t mTank 2

Tbotnew d Tret C Tbot K Tret $e

;

K

Tbotavg d

int

Tret C Tbot K Tret $e TimeStep

, t = 0 ..TimeStep

;

# Update Top node
K mfrt $TimeStep mTank 2 mfrt K $t mTank 2

Ttopnew d Tbotavg C Ttop K Tbotavg $e int

;

Ttopavg d end do; end if;

Tbotavg C Ttop K Tbotavg $e TimeStep

, t = 0 ..TimeStep

;

# Calculate useful heat added to tank from solar if solar loop was run if To O Ttopavg and mfr O 0 then #print "sun, To was good enough to be useful" ; mfr$TimeStep$cpf $ To K Ti ;#print "QuReal is" = QuReal ; 1000 outputsTar1 i, 10 d QuReal; outputsTar1 i, 1 d mfr; outputsTar1 i, 2 d Qu; outputsTar1 i, 3 d c; outputsTar1 i, 4 d To; QuReal d 122

outputsTar1 outputsTar1 outputsTar1 outputsTar1

i, 5 d Tp; i, 6 d Qe; i, 7 d e; i, 12 d Ti;

end if; #End of if statement for if solar was run or not if Ttopavg ! Tsup then Qaux d mfrt$TimeStep$TankfCp$ Tsup K Ttopavg ; outputsTar1 i, 11 d Qaux; else outputsTar1 i, 11 d 0; end if; #Tank temperatures are det for next time step Ttop d Ttopnew; Tbot d Tbotnew; #Ti for the next time step is set Ti d outputsTar1 i, 4 ; #print "Ti for next time step is" = Ti ; end do; #End of time step loop end proc testrun TarTo1, TarTo2, TankCp, TankTint, cpf, TankfCp, T_HVACret, T_HVACsup, mTank with ExcelTools : Export outputsTar1, "Raw_Results 1.6.1.xlsx"

123

10 References

[1] "Climate Change 2014 Synthesis Report Summary for Policymakers," Intergovernmental Panel on Climate Change, 2014. [2] S. Kalogirou, "The Potential Of Solar Industrial Process Heat Appications," Applied Energy, vol. 76, p. 337­361, 2003. [3] S. Deng, R. Zhao, L. Zhao, Y. Tan and Z. Yu, "Energy efficient considerations on carbon dioxide capture: Solar thermal engineering (Part I)," in The 6th International Conference on Applied Energy ­ ICAE 2014, 2014. [4] D. Rabbani and H. Hooshyar, "Application Of Flat Plate Solar Collector For Thermal Disinfection Of Wastewater Effluents," Iranian Journal Of Environmental Health Science and Engineering, vol. 8, no. 2, pp. 117-122, 2011. [5] Y. Liu, K. Chang, W. Lin and K. Chung, "Solar Thermal Application For The Livestock Industry In Taiwan," Case Studies in Thermal Engineering, vol. 6, p. 251­257, 2015. [6] W. Weiss, M. Spörk-Dür and F. Mauthner, "Solar Heat Worldwide," AEE - Institute for Sustainable Technologies, Gleisdorf, Austria, 2017. [7] A. H. Al-Waeli, K. Sopian, H. A. Kazem and M. T. Chaichan, "Photovoltaic/Thermal (PV/T) systems: Status and future prospects," Renewable and Sustainable Energy Reviews, vol. 77, pp. 109-130, 2017.

124

[8] A. Kumar, P. Baredar and U. Qureshi, "Historical and recent development of photovoltaic thermal (PVT) technologies," RenewableandSustainableEnergyReviews, vol. 42, pp. 14281436, 2015. [9] T. M. Sathe and A. Dhoble, "A review on recent advancements in photovoltaic thermal techniques," Renewable and Sustainable Energy Reviews, vol. 76, pp. 645-672, 2017. [10] S. Dubey and G. Tiwari, "Analysis of PV/T flat plate water collectors connected in series," Solar Energy, vol. 83, pp. 1485-1498, 2009. [11] P. Dupeyrat, C. Ménézo, M. Rommel and H. M. Henning, "Efficient single glazed flat plate photovoltaic­thermal hybrid collector for domestic hot water system," Solar Energy, vol. 85, pp. 1457-1468, 2011. [12] K. Touafek, M. Haddadi and A. Malek, "Modeling and Experimental Validation of a New Hybrid Photovoltaic Thermal Collector," IEEE Transactions on Energy Conversion, vol. 26, 2011. [13] P. Dupeyrat, C. Ménézo, H. Wirth and M. Rommel, "Improvement of PV module optical properties for PV-thermal hybrid collector application," Solar Energy Materials & Solar Cells, vol. 95, p. 2028­2036, 2011. [14] R. Liang, J. Zhang, L. Ma and Y. Li, "Performance evaluation of new type hybrid photovoltaic/thermal solar collector by experimental study," Applied Thermal Engineering, vol. 75, pp. 487-492, 2014.

125

[15] T. Anderson, M. Duke, G. Morrison and J. Carson, "Performance of a building integrated photovoltaic/thermal (BIPVT) solar collector," Solar Energy, vol. 83, pp. 445-455, 2008. [16] S. Dubey and G. N. Tiwari, "Thermal modeling of a combined system of photovoltaic thermal (PV/T) solar water heater," Solar Energy, vol. 82, pp. 602-612, 2008. [17] H. Ben cheikh el hocine, K. Touafek, F. Kerrour, H. Haloui and A. Khelifa, "Model Validation of an Empirical Photovoltaic Thermal (PV/T) Collector," Energy Procedia, no. 74, pp. 1090-1099, 2015. [18] N. Amrizal, D. Chemisana and J. Rosell, "Hybrid photovoltaic­thermal solar collectors dynamic modeling," Applied Energy, vol. 101, pp. 797-807, 2013. [19] T. Chow, "Performance analysis of photovoltaic-thermal collector by explicit dynamic model," Solar Energy, vol. 75, pp. 143-152, 2003. [20] D. de Vries, "Design a photovoltaic/thermal combi-panel," Eindhoven University Press, Eindhoven, 1998. [21] F. Shan, F. Tang, L. Cao and G. Fang, "Performance evaluations and applications o fphotovoltaic­thermal collectors and systems," Renewable and Sustainable Energy Reviews, vol. 33, p. 467­483, 2014. [22] G. Vokas, N. Christandonis and F. Skittides, "Hybrid photovoltaic­thermal systems for domestic heating and cooling--A theoretical approach," Solar Energy, no. 80, pp. 607-615, 2005.

126

[23] H. A. Zondag, D. W. De Vries, W. G. J. Van Helden and R. J. C. Van Zolingen, "The Thermal and Electrical Yield of a PV-Thermal Collector," Solar Energy, vol. 72, pp. 113128, 2001. [24] F. Calise, M. D. d'Accadia and L. Vanoli, "Design and dynamic simulation of a novel solar trigeneration system based on hybrid photovoltaic/thermal collectors (PVT)," Energy Conversion and Management, no. 60, p. 214­225, 2012. [25] S. A. Kalogirou, "Use of TRNSYS for modelling and simulation of a hybrid pv­thermal solar system for Cyprus," Renewable Energy, vol. 23, pp. 247-260, 2001. [26] T. Nualboonrueng, P. Tuenpus, Y. Ued and A. Akisawa, "The performance of PV-t systems for residential application in Bangkok," Progress in Photovoltaics, vol. 21, pp. 1204-1213, 2013. [27] J. Duffie and W. Beckman, in Solar Engineering of Thermal Processes, second ed. ed., New York, John Willey and Sons Inc., 1991, pp. 777, 250-326. [28] Apricus Solar, "Technical Information FPC-A32 Solar Collector," December 2013. [Online]. Available: http://www.apricus.com/upload/userfiles/downloads/Apricus_FPCA32_Tech_Info.pdf. [Accessed November 2017]. [29] Maplesoft, "Maple 2015," Maplesoft, a division of Waterloo Maple Inc., Waterloo, Ontario.

127

[30] S. Klein and e. al., TRNSYS 18: A Transient System Simulation Program, Madison: Solar Energy Laboratory, University of Wisconsin, 2017. [31] M. Khoukhi and S. Maruyama, "Theoretical approach of a flat plate solar collector with clear and low-iron glass covers taking into account the spectral absorption and emission within glass covers layer," Renewable Energy, vol. 30, pp. 1177-1194, 2005. [32] S. C. W. Krauter, Solar Electric Power Generation - Photovoltaic Energy Systems, Berlin, Heidelberg: Springer, 2006. [33] DOE, "eQUEST: the QUick Energy Simulation Tool," 16 04 2016. [Online]. Available: http://www.doe2.com/equest/. [34] University of Wisconsin--Madison. Solar Energy Laboratory. (2011). TRNSYS Help Manual - Weather, Madison, Wis.: The Laboratory. [35] ISO/FDIS 9806:2013(E): Solar energy -- Solar thermal collectors -- Test methods. [36] J. Fine, TRNSYS Model of House for PVT Validation, Toronto: (personal communication), 2016.

128

