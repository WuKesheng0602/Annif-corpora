VEHICLE POSITION TRACKING USING KALMAN FILTER AND CWLS OPTIMIZATION
by

Lubna Farhi MEng, National Univ. of Science and Technology, Pakistan, 2001

A thesis presented to Ryerson University in partial fulfillment of the requirement for the degree of Master of Applied Science in the Program of Electrical and Computer Engineering Toronto, Ontario, Canada, 2009

©

Lubna Farhi, 2009

Author's Declaration
I hereby declare that I am the sole author of this thesis. I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research. Signature

I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. Signature

ii

Instructions on Borrowers
Ryerson University requires the signatures of all persons using or photocopying this thesis. Please sign below, and give address and date.

iii

Abstract
Lubna Far hi, "Vehicle Position Tracking using Kalman Filter and CWLS Optimization", University, Toronto, 2009 MASc, Ryerson r

Vehicle position estimation for wireless network has been studied in many fields since it has the ability to provide a variety of services, such as detecting oncoming collisions and providing warning signals to alert the driver. The services provided are often based on collaboration among vehicles that are equipped with relatively simple motion sensors and GPS units. Awareness of its precise position is vital to every vehicle, so that it can provide accurate data to its peers. Currently, typical positioning techniques integrate GPS receiver data and measurements of the vehicles motion. However, when the vehicle passes through an environment that creates multipath effect, these techniques fail to produce high position accuracy that they attain in open environments. Unfortunately, vehicles often travel in environments that cause multipath effect, such as areas with high buildings, trees, or tunnels. c t with respect to the position The goal of this research is to minimize the multipath effe_ accuracy of vehicles. The proposed technique first detects whether there is disturbance in the vehicle position estimate that is caused by the multi ath effect using_hypothesis test. This technique integrates all information with the vehicle's own data and the Constrained Weighted Least Squares (CWLS) optimization approach with time difference of arrival (TDOA) technique and minimizes the position estimate error of the vehicle. Kalman filter is used for smoothing range data and mitigating the NLOS errors. The positioning problem is formulated in a state-space framework and the constraints on system states are considered explicitly. The proposed recursive positioning algorithm will be comparatively more robust to measurement errors because it updates the technique that feeds the position corrections back to the Kalman Filter as compared with a Kalman tracking algorithm that estimates the target track directly from the TDOA measurements. It compensates the GPS data and decreases random error influence to the position precision. The new techniques presented in this thesis decrease the error in the position estimate. Simulation results show that the proposed tracking algorithm can improve the accuracy significantly.

iv

Acknowledgments

All eulogy belong to Allah, the merciful, the compassionate, the omniscient who has patronized us with His conferred benevolence in all fields of life, including this project. I am thankful to my supervisors, Dr. Lian Zhao and Dr. Zaiyi Liao for providing me such a thought provoking and challenging work coupled with valuable assistance towards its completion and their scholarly suggestions in the completion of this project. I should also express my special thanks to Ministry of Transportation of Ontario (MTO). This work is supported by the MTO.

v

Contents
1 Introduction 1.1 Research Motivation 1.2 Overview of Different Position Location Methods 1.2.1 Modified Handset Techniques . . 1.2.2 Unmodified Handset Techniques . 1.3 Research Objective 1.4 Proposed Model . 1.5 Thesis Outline . 2 Background 2.1 Fading phenomena in wireless communication systems . 2.1.1 Large-scale fading . 2.1.2 Small-scale fading . 2.2 Accuracy measures . . . . 2.3 Positioning technologies 2.3.1 Cellular Network Positioning . 2.3.2 Satellite positioning . . . . . . 2.4 Mobile-Based Versus Network-Based techniques 2.5 Dead Reckoning Positioning System . 2. 6 Ranging . . . . . . . . . . . 2.6.1 Absolute Positioning 2.6.2 Relative Positioning 2. 7 Methods of Radionavigation 2.7.1 Time of Arrival (TOA) Technique . 2. 7.2 Time Difference of Arrival (TDOA) PL Technique 2.8 Optimization Approaches . . . . . 2.9 Filtering for Data Smoothing .. 2.9.1 Utilization in positioning . 2.10 Related Research . . . . . . . . . 3 Methodology 3.1 Positioning Measurement Models
1

1 2

2
3 5 6 8
9

11 13 13 14 17 18 20

22
23 23 23 24 25 25 27 28

30
32 32 36 36

Vl

3.2 3.3 3.4 3.5 3.6 3.7 3.8

TDOA Measurement Algorithm . . . . . . . . . . . . . CWLS Optimization . . . . . . . . . . . . . . . . . . . Position Measurement Model and NLOS Identification AWGS Model . . . . . . . . . . . . 3. 5.1 NLOS Error Model . . . . . . . . . . . . . . Data Smoothing by Kalman Filter . . . . . . . . . . Improving Positioning in a Multipath Environment Detection of the Multipath Effect 3.8.1 Biasing the Kalman Filter

37 38 41 42 43 43
49 49 50
52

4 Simulation Results 4.1 Simulation Scenario . 4.2 Initialization . . . . . 4.3 Results . . . . . . . . 4.4 Kalman Filter and CWLS Implementation 4.5 Comparison of the Techniques . . . . . . . 5 Conclusions and Future Work 5.1 Conclusions . . . . . . 5.2 Future Work . . . . . . . . . . . 5.2.1 Network Layers . . . . 5.2.2 Embedded systems design A List of Abbreviations and Symbols. Bibliography

52 54 55 61 62

65
65

66
67 67

68

70

vii

List of Figures
1.1 1.2 1.3 2.1 Wireless PL techniques. . . . . . . . . . Ideal case. . . . . . . . . . . . . . . . . . Vehicle Positioning Model Architecture ..
5 6

7

Multipath effect, when satellite signals are reflected off of high buildings or trees . . . . . . . . . . . . . . . . 2.2 Main propagation mechanisms. 2.3 Circular error probability. . . . 2.4 Cumulative distribution function. 2.5 Cell-ID method . . . . 2.6 Absolute Positioning. 2. 7 Relative Positioning. 2.8 TOA method. . . . . 2.9 TDOA method. . .. 2.10 Kalman Filter predictor-corrector algorithm. 3.1 3.2 3.3 4.1 4.2 4.3 4.4 4.5 4.6 4. 7 4.8 4.9 4.10 4.11 The Kalman Filter loop. Kalman Filter Response. Flow of Algorithm. . Simulation Scenario. Position estimation by GPS data and Kalman Filter. Position estimation for LOS/NLOS conditions. . . . . Hypothesis testing, Standard deviation for NLOS /LOS. Vehicle Speed variation. . . . . . . . . . . . . . . . . . Position estimation in Open area. . . . . . . . . . . . . Position estimation in High Building area using biased KF. Comparison of the average position error. . . . . . . . . . . NLOS mitigation with CWLS optimization. . . . . . . . . Position estimation error with the constrained and unconstrained filters. Comparison of Standard deviation between two techniques. . . . . . . . .

10 11
16 16

19
24 25 26
27

31

47
48

51
53 56 56 58 59 59 60 60 62 63 64

Vlll

List of Tables
4.1 4.2 4.3 Setup Kalman Filter Implementation. . . . . . . . . . . . . . . . . . Error Statistics for the Positioning using Kalman Filter. . . . . . . Error Statistics for the Positioning using Kalman Filter and CWLS.
55 57 61

lX

Chapter 1 Introduction
During the last two decades, wireless network technology has progressed at a very fast rate. Improvements have played an essential role in opening doors for researchers to consider new solutions for various applications. Cellular, Ad hoc, and wireless sensor networks are examples of recent wireless network technologies that have been used in telecommunication, monitoring, remote sensing, security, position estimation, and tracking systems. The later two applications have attracted the attention of many governmental and non-governmental organizations because position awareness can be deployed in numerous services. A vehicular wireless network is able to provide many communication services via the collaboration of the vehicles in the network. However, the accuracy of its position estimation is not satisfactory for some applications [1]. In this thesis, a new technique for improving the position estimation process is proposed.

1.1

Research Motivation

Accurate positioning of a vehicle is one of the essential features that assist third generation (3G) wireless systems in gaining a wide acceptance and triggering a large number of innovative applications. Although the main driver of location services is the requirement of locating Emergency 911 callers within a specified accuracy, mobile position information will also be useful in designing intelligent transportation system [2). Global Positioning System (GPS) could be used to provide mobile locations. However, it would be expensive to be adopted

1

2

in the mobile phone network because additional hardware is required in the mobile station (MS). Furthermore, using a G PS receiver as a stand-alone positioning technique has drawbacks. A regular GPS used without any specialized equipment can b~e less accurate, e.g., they are accurate only up to 5 to 10 meters in outdoor environment or open area [3]. In addition, GPS is not applicable in locations where no line of sight exists, e.g., in a tunnel. Therefore, integrating a GPS receiver with other positioning methods is well worth the efforts invested by many researchers [4, 5]. However, the accuracy of its position is still an unsolved problem.

1.2

Overview of Different Position Location Methods

There are numerous techniques that can be considered for use in wireless position location systems. However, we will discuss only those techniques that can be practically incorporated in wireless systems. Such techniques can be broadly classified into two categories as shown in Figure 1.1. Either the position location system requires a modification in the existing handsets or the system can be designed in such a way that all the modifications take place at the base stations or the switching center with no modifications in the existing handsets.

1.2.1

Modified Handset Techniques

Fro1n the technical aspect, the modified handset techniques are easy to implement and accurate to determine a mobile location. The GPS-based position location, mobile-assisted Time of Arrival (TOA) technique and mobile-assisted Time Difference of Arrival (TDOA) techniques fall into this category. The G PS-based position location (PL) requires installation of a GPS receiver in the handset and transmitting the received GPS data on the reverse link to the base station (BS) for further processing and position determination [14]. The drawbacks of this technique include an increase in the size and weight of the handsets, and additional drain of the batteries in the mobile phones. Moreover, a GPS receiver needs to have at least four satellites constantly visible. In a heavily shadowed and covered urban environment, the line-of-sight between the mobile station and the satellites is impeded. Therefore, the GPS

3

based solution is a feasible option for outdoor mobile units but not for indoor mobile units or units within urban canyons. In the mobile assisted TOA technique, the handset stamps the current time on any outgoing signal in the reverse channel. The base station determines the time required by the signal to reach the base station, and from that determines the distance between the base station and the mobile unit. If at least three base stations take part in this process then the triangulation method can be used to determine the mobile position. This requires that the mobile station and the base stations must be accurately synchronized. Although this is not impossible to achieve, it is not cost effective.

1.2.2

Unmodified Handset Techniques

An unmodified handset solution requires that all the modifications will be made at the base stations and at the switching centers, thus allowing existing terminal equipment to be used. Prominent options include: Angle of Arrival (AOA), Time of Arrival (TOA) or Direction of Arrival (DOA), and Time Difference of Arrival (TDOA) techniques. It is also possible to combine two or more of these techniques to achieve a more accurate position location. Combined methods are commonly known as Hybrid Techniques [16]. The AOA method utilizes antenna-arrays to estimate the direction of arrival of the signal of interest. A single AOA measurement constrains the source along a line. The position of the signal source can be located at the intersection of two lines if two DOA estimates are available from two separate antennas. Although the basic principle of the AOA method seems very simple, the method has some drawbacks. For measurement accuracy, it is important that the mobile unit and the participating base stations all have Line-Of-Sight (LOS) to the mobile. This is not the usual case in cellular systems. Cellular systems have heavily shadowed channels like the ones encountered in urban environments. In the unmodified handset TOA technique, when a base station detects a 911 user, it transmits a particular command or instruction signal to the user and asks the user to respond to that command signal. Since this method relies on a time reference, it is highly susceptible to the timing error due to Non-Line-Of-Sight (NLOS) between the base station and the

4

mobile unit. The unmodified handset TDOA has the relative advantage over TOA in the sense that the TDOA does not require any time reference for determining round trip delay. The TDOA technique estimates the time difference of arrival of the signal from the source at multiple base stations. Two versions of the received signal at pairs of the base stations are cross-correlated. From the peak of this cross-correlated output, the time difference of the signal arriving at two base stations is determined. This time difference gives rise to a hyperbola between the two receivers. If the base stations and the mobile user are in the same plane, then the mobile lies on a line of the hyperbola. If another base station takes part in this process, another hyperbola is defined, and the intersection of the hyperbolas results in the position estimate of the source. The TDOA method is also referred as the Hyperbolic Position Location method. The advantage of this technique is that all processing takes place at the base station infrastructure leveL Advantages of the method include: cost effectiveness, no need for an absolute time reference, capability with inexpensive antennas, and immunity to timing errors [15]. Any timing bias will be canceled in the time difference operation. As a result, the TDOA methods work better than the TOA methods in the absence of LOS between base stations and the mobile unit. In the hybrid techniques (HT), two or more of the techniques discussed earlier are combined to create a more accurate position location service. When AOA and TDOA are combined to form AOA-TDOA HT, multiple base stations receive signals from the mobile unit and the AOA estimates from each base station and the TDOA estimates between multiple base stations are combined to determine target location. Although this technique may not be as accurate as the AOA-TDOA HT, it may be the only unmodified handset PL solution possible when only one base station is able to receive the mobile signal [16]. This thesis focuses on the use of TDOA technique with optimization by using Kalman filter to allow efficient combining of position location data of GPS. Note that, this is more than simple technique used for averaging of estimates, but takes into account the quality of the various estimates.

5

Position Location techniques

Modified Handset Techniques

Unmodified Handset Techniques

I

1

1
Mobile Assisted TDOA

!
AOA

1
TOA

I

1
TDOA

1
Hybrid ~ h ·

GPS Based

Mobile Assisted TOA

AOA/TOA

~

AOA/TDOA

Figure 1.1: Wireless PL techniques.

1.3

Research Objective

The objective of this research is to improve the accuracy of positioning techniques, so that it can be used as a robust system during long GPS outages. To accomplish this objective, the following techniques have been developed: · The research presents a simple recursive solution to passive tracking of maneuvering targets using time difference of arrival (TDOA) measurements. · The Kalman Filter integrates the constant Inertial Navigation System with the GPS data (from simulation) in order to overcome most of the individual drawbacks in the two systems when they operate independently. · The CWLS optimization method minimizes Kalman Filter positioning errors by using information extracted from the communication among vehicles. · The updating technique feeds the position corrections back to the Kalman Filter, which compensates for the G PS data.

6

One intersectoin
po~nt

'' '' '

'

--Figure 1.2: Ideal case.

From a geometric point of view, the solution of such an optimization problem is the intersection point of three circles/hyperbolas. These circles signify the distances between the target vehicle and the reference points, the circles are centered at the locations of the reference points, and the radius of every circle is equal to the distance between the target vehicle and the center of that circle, as shown in Figure 1.2.

1.4

Proposed Model

For vehicle positioning, filtering techniques do have inherent problems, in term of stability, computational load, immunity from noise effects and observability. The performance of the filter is heavily dependent on the models used. In the proposed model, we concentrate on the ranging aspect of the vehicle transportation system. This thesis presents a simple recursive model by using time difference of arrival (TDOA) based on absolute position GPS data and incorporating state equality constraints in the Kalman filter. In this model, feed the position correction output back to Kalman filter,

7 it compensates the GPS data and decreases the measurement error for vehicle position

measurement as shown in Figure 1. 3. From the process of Kalman filtering, the standard deviation of the observed range data can be calculated and then used in NLOS /LOS hypothesis testing. In the TDOA method, the differences in the arrival times of the MS signal at multiple pairs of BSs are measured. TDOA-based position systems are of more interest because of its potential for high position estimation accuracy. We will mainly discuss positioning algorithm including fundamental performance in the presence of noise and multipath effects. Furthermore we will describe the combination of optimization strategies which will improve the overall accuracy (24].

----------------------1
GPS Data
I I I I I I I I I I

______(_____________ j
~

Posit ion estinwtedby TDOA and K.-lm·n Filter

lOS/ NlOS hypothesis test

Vehicle Position Optim ization by CWLS

Ii
[INS measurement (s,e)

l

Figure 1.3: Vehicle Positioning Model Architecture.

The goal of this work is vehicle position optimization by constrained weighted least square (CWLS) approach [21]. For vehicle position optimization we use CWLS and Lagrange multipliers for minimizing the cost function [27]. The approach proposed in this model introduces an additional optimization operation to the traditional systems. The optimization operation is applied to the output of a Kalman

8 Filter in order to increase the accuracy of the positioning and improved TDOA estimation method for reducing predictable errors.

1.5

Thesis Outline

In the remaining of this thesis, related research and background are presented in Chapter 2, in which the different positioning methods are discussed. Chapter 3 describes the Kalman Filter and the formulation of the optimization and updating techniques that help improving the position estimates. Chapter 4 contains the simulation work and the results that demonstrate the improvements in the position estimates, using the techniques mentioned in Chapter 3. Finally, Chapter 5 presents the conclusions of the thesis and recommendations for future work.

Chapter 2 Background
There are a number of different radio frequency based techniques that can be used for wireless position location. The issue is, how effectively and efficiently a technique can be implemented so that it can be incorporated in the existing system easily without making major changes, either at the user end or at the service providers end. Electromagnetic waves at radio frequency (RF) have the unique property of traveling through most objects. Position using radio frequency is performed by direct measurement of radio signals traveling between the base station and the mobile unit. The RF signal reflection and obstructed line of sight introduce error in the calculated position. However, only the radio frequency estimation systems offer the advantages of low cost, ease of integration and ability to work in harsh environmental conditions (3]. From an early work focused on analyzing and modeling the errors of associated with different types of GPS receivers, in

(30], it was able to model most GPS global errors;

however, it is mentioned in [31] that the multipath effect has a random behavior. Logically, this is true because one can not anticipate the specific environment that any vehicle may pass through during a 24-hour period. For example, some vehicles commute every day through an open area with almost no multi path effect. Another group of vehicles spend all their time traveling inside large cities, where satellite signals are reflected off or are blocked by high buildings, and therefore exposed to a multipath effect most of the time. Still other vehicles experience both of these cases. The local G PS receiver error is different from one vehicle to

9

10

High buildings and trees

Figure 2.1: Multipath effect, when satellite signals are reflected off of high buildings or trees.

11 another because it depends on the environment surrounding each vehicle as shown in Figure 2.1. The approach proposed in this thesis introduces an additional optimization operation to the traditional systems. The optimization operation is applied to the output of a Kalman Filter in order to increase the accuracy of the positioning.

2.1

Fading phenomena in wireless communication systems

The mobile stations places some fundamental limitations on the performance of the wireless communication systems. In a modern urban environment, a transmission path between

the transmitter and the receiver may vary from a simple line-of-sight scenario, to a path completely obstructed by buildings, natural objects, or foliage. To put it shortly, the channel is constituted of all the objects that directly or in- directly interact with the electromagnetic field created by the transmitter ( Figure 2.2). The mechanisms behind electromagnetic

.· .. .

·::-::·:-~: :~·:·:·:·:·: :·:·::.~;;~:,::' ~~se slation
Line-of- Sighr

:

.~·

receiver

mobile

Figure 2.2: Main propagation mechanisms.

12
wave propagation are diverse, but can generally be attributed to reflection, diffraction, and scattering Due to the motion of either the transmitter/receiver or the objects that interact with the emitted signal, the electromagnetic waves travel along different paths of varying length. Interaction between all these waves causes the received power at a certain location to vary. These variations are called fading. Depending on the phases and amplitudes of the interacting waves, their total effect could be constructive (i.e., they sum up so that the total power increases), or destructive, when their interaction results in the drop of power. The difficulty in dealing with fading is its non-stationary behavior that strongly depends on the actual environment, i.e., the geometrical distribution of the interacting objects. The latter is itself subject to time variation, especially in mobile communications. This in turns means very complex and non-stationary behavior of the corresponding channel.
It is convenient to distinguish fading caused by slowly changing factors, such as moving

away from the transmitter, causes slow power drop, and those that vary fast on top of them, mostly caused by the phase variations of multi path components arriving via different paths. These two types of fading are known as large-scale fading and small-scale fading, respectively. This section introduces the basic phenomena of the radio wave propagation. The main propagation mechanisms include reflection, diffraction, scattering, and absorption [8).

Reflection
In the reflection phenomena, radio waves encounter an obstacle that is large compared to the wavelength of the radio wave. As a result, part of the wave energy is reflected and the remaining part is absorbed into the object. Reflections occur from the ground surface and from building walls. Radio waves can also be absorbed due to atmospheric effects or even a human body.

Diffraction
Diffraction enables the radio waves to find their way to the shadow regions behind the corner of a building or over the rooftops. In multiple diffraction, obstacles cause the radio waves to diffract from several places.

Scattering

13 Rough and finite surfaces such as trees cause scattering. In scattering, the energy of the radio wave is dispersed to all directions. Scattering is sometimes referred to as diffuse reflection.

2.1.1

Large-scale fading

The name of this type of fading speaks for itself. It describes the variations of the received power over relatively large distances, usually from tens to thousands of meters. Large-scale fading effects are mainly caused by the particularities of the terrain profiles, e.g. , suburban areas, mountain areas, cities, etc. A significant amount of efforts has been invested in the development of propagation models that accurately reflect the variation of the received power over large distances, which is an important factor in the design of the cellular networks (8). Large-scale propagation models are constructed to predict the mean power for an arbitrary transmitter-receiver separation and to estimate the coverage area of a transmitter in a certain environment.

2.1.2

Small-scale fading

Because of the reflection, diffraction and scattering, radio waves travel different paths from the transmitter to the receiver, which is often called multipath propagation. Due to the difference in the length of travel, the arrival time and phase of the received signals are not identical. This leads to fluctuations in the received signal strength because at the receiver , the waves are combined constructively and destructively depending on their phase and arrival time. Small-scale fading , on the other hand, stems from the rapid fluctuations of the phases of a radio signal over very short distances (on the order of several wavelengths, i.e., centimeter scale for a typical wireless communication system operating in the G Hz frequency range). The cause of such rapid fluctuations is the interference between the multipath waves that arrive at the receiver at slightly different times. As the result, depending on the phases of the incoming wavefronts, the resulting power is either increased (maxima of the resulting

14 interference pattern), or reduced (minima of the interference pattern). There are several

physical factors in the radio propagation channel that influence small-scale fading. Some of the most dominant factors are:

· Multipath propagation - The presence of reflecting and scattering objects that
spread the signal energy in the amplitude, phase and time. These effects produce multiple copies of the transmitted signal that arrive at the receiving antenna causing interference (see, for example, Figure 2.2, where 3 paths of different length are superimposed at the receiving antenna). Multipath propagation causes delay spread the time duration needed for all of the replicas of the emitted signal, or in other words echoes, to die out. If we are talking about multiple antennas, then in addition to the latter, the multi path propagation also induces angular spread, the spread of the angles of the waves that impinge on the antenna array at a certain instant of time t.

· Speed of the mobile - The motion of the transceiver through the interference field
pattern results is time-dependent phase variations. These variations cause a specific modulation of the transmitted signal, also known as the Doppler shift. The large-scale effects are the key factors that govern the design and planning of the cellular network. The small-scale fading, on the other hand, directly impacts the design of the actual transceiver, since this is where the knowledge of the instantaneous power is mostly needed.

2.2

Accuracy measures

The output of the mobile positioning procedure contains typically the geographical coordinates of the estimated location together with the time stamp of the moment when the positioning was carried out. The coordinates of the location estimation can be either spherical coordinates or local Cartesian coordinates. In addition to the time and coordinate information, the estimated error of the location may be included to the output of the location procedure. The estimated error can be based on the location measurement quality information or it can be a fixed set of estimations for the positioning technology.

15
To be able to understand and compare the performance of the various positioning technologies and estimate the magnitude of the positioning error, it is important to know the most commonly used accuracy measures. In this section these measures, as well as their relationships to each other, are presented. Positioning error The term positioning error is generally considered as the Euclidean distance between the estimated location and true location

(2.1)
where (xi, Yi, zi) is the estimated position and (x, y, z) the corresponding true position. In cellular network positioning, the error in the altitude is often ignored. In addition, the true location might be replaced with the position calculated with the Global Positioning System (GPS) receiver because it is often too time-consuming and sometimes even impossible to determine the true position accurately. Circular error probability Circular error probability or circular error probable (CEP) is the radius of a circle centered at the true position, containing the position estimate with a certain probability. Usually the radius of the 50% (R50) probability is used, but 67% (R67) and 95% (R95) probabilities are often quoted (Figure 2.3). In case of three-dimensional accuracy, a common measure is Spherical Error Probability (SEP), which also takes the error in the altitude into account. Actually, R50 equals the median of the positioning error distribution. Half the errors are above the median and half are below the median. A bit similar measure is the arithmetic mean (a.k.a. average) which equals the sum of the positioning errors of the samples divided by the number of samples. The median is a much better measure than the arithmetic mean for highly asymmetrical distributions because it is less sensitive to extreme variations. In mobile positioning, the error distribution is usually distorted and thus, median is usually more illustrative than mean. Cumulative distribution function Cumulative distribution function (CDF) is often used in visualizing the positioning error.

16

I I I I I

I

I

,/ * * * ,''*
I I I
I

,, ,,

,,'

.,. ...

.--- ---...............
. - ---.....,

;.,

* ',~
, ,,,
I

', '' ~
\

RSO

* \ \
I I

\'

''
I I I

I I I I

I \
\

I I

· *

True position Position estimation

\

'

\

\

\

''

\

' ' ...,

*

' ........ ...... _ _.....

...... ........ __ .... ___

*

__ .....--.,...

.,,,/*

*,,

, [ _ _ - - - - - - R95

I

Figure 2.3: Circular error probability.

CDFC:urve

100m

lOCim

Figure 2.4: Cumulative distribution function.

17 A general impression of the error distribution can be obtained quickly by looking the CDF graph. The X-axis represents the positioning error in meters and the percentage of all samples is depicted in the Y-axis. With the cumulative distribution function, one can find out any desired percentile. For example, in Figure 2.4, it can be seen that 67% of the samples are positioned within about 150 meters. Median, R67 and R95 values can be approximated from the CD F graph by ocular estimation.

Root mean square error
Root mean square error is determined by squaring the positioning errors of the samples, summing up the results, dividing the sum by the number of samples, and then taking the square root of the division

di (2.2) n i=I where n is the number of positioned samples and di is the positioning error of sample of
=
_!_

R.M.S

t

i. Root mean square error represents the whole error distribution with one value. Therefore,

it is more comprehensive than R50 and R67 values. For example, if 67% of the errors were smaller than 50 meters but 20% of the errors were over 1000 meters, R67 value would give far too positive a picture of the situation. On the other hand, R67 together with R95 value would give more information about the distribution: most of the errors are small but there are also some major ones. In conclusion, the most illustrative measure is CDF because it shows the whole error distribution. Numerical values are used to simplify the representation. If the error has to be expressed with one value, root mean square error does it most comprehensively.

2.3

Positioning technologies

The position of the mobile terminal can be determined in several different ways. The most important technologies are satellite positioning, cellular network-based positioning and indQor positioning. This section briefly introduces these three technologies. A more comprehensive description can be found in [32].

2.3.1

Cellular Network Positioning

18

The cellular network positioning can be mobile-assisted, mobile-based, or network-based. Mobile-assisted positioning means that the mobile terminal performs the location measurements and transfers the measurement data to a particular component called location server (LS). The LS calculates the location estimate and sends it back to the mobile terminal. In mobile-based positioning, the mobile terminal is responsible for carrying out both the location measurements and the calculation of the location estimate, whereas in network-based location, the network performs the measurements and calculation. In the simplest case, the measurement data used in estimating the location of the mobile terminal contains only the identification information of the serving cell, or access point in case of WLAN. The information is used to find out the corresponding location of the signal source, which is then estimated to be the location of the Mobile Terminal. The name of this technique is Cell-Identification (Cell-ID) as shown in Figure 2.5 and its accuracy is directly proportional to the cell size in the network. For example, in the GSM network the cell size might vary from a couple of hundred meters to over 30 kilometers. For many location-based services, the accuracy of the Cell-ID technique is not sufficient. Thus, methods that are more complex have been developed to increase the accuracy. One way to improve the positioning accuracy is to utilize information about the signal strength. Depending on the network type and topology, the MT is capable of measuring signal strength values from a number of different sources. For example, in GSM, the MT continuously measures the signal strength of the serving and up to six neighbor cells. In freespace propagation, the signal strength can be assumed proportional to the distance between the signal source and the MT. By using propagation models, the location estimation for the MT can be solved geometrically. However, the line-of-sight (LOS) assumption is often invalid due to the disturbances in the propagation environment. Non line-of-sight propagation

environment can also be modeled to some extent, but the results are usually poorer than in case of LOS visibility. In addition, the number of hearable cells affects directly the

performance of the signal strength technique. Signals from at least three cells are needed to

19

MT

PositioninJ: error<= cell size

Figure 2.5: Cell-ID method.

solve the location of the MT unambiguously. The measured signal level information can also be compared to previously recorded or estimated values. By finding out the best matching sample, the location of the MT can be predicted. In addition to the signal strength, timing information can be utilized in mobile positioning. In GSM, a parameter called Timing Advance (TA) known by the serving cell is directly proportional to the distance between the serving cell and the MT so it can be used to enhance the accuracy of the Cell-ID method. However, the resolution of the parameter is poor (>550m) so it is beneficial only in case of large cells. In UMTS, Round Trip Time (RTT) can be used equally to enhance the Cell-ID. Because of the wider bandwidth used in 3G networks, the resolution of RTT (80m) is much better than the resolution of TA. More enhanced methods that use timing information includes Time of Arrival (TOA), Enhanced Observed Time Difference (E-OTD) and Observed Time Difference of Arrival (OTDOA). All these methods are based on triangulating the propagation time delay between the MT and at least three base stations. To support these methods, additional hardware com-

20 ponents called Location Measurement Units (LMUs) need to be installed into the network. TOA is a purely network-based method, whereas the E-OTD can be either mobile-based or mobile-assisted. TOA is used in both the GSM and UMTS networks. E-OTD is a method for GSM location and OTDOA is identical method for UMTS networks. As well as signal strength information, timing measurements could be also used in the Database Correlation Method. For example, the parameter Timing Advance could be used in assistance with the signal strength values. By equipping the base station with special antenna arrays, the angle of the signal arriving from the MT can be determined. Measurements from two different base stations are enough for locating the MT. This method requires usually changes in the network because the required antenna arrays are not included in the standards. On the other hand, the positioning accuracy of the method often decreases in non line-of-sight (NLOS) conditions. The previously presented techniques can be combined in order to get better positioning accuracy. In addition, various techniques can be used side by side to achieve a better

performance in different environments. For example, a more enhanced technique could be applied in urban areas where there is a need for precise location and a simpler solution could be used in other areas to minimize the expenses.

Accuracy of the cellular network based positioning technologies
None of the presented cellular network positioning techniques is superior to the others. The achieved positioning accuracy depends highly on the network type and topology, as well as the propagation environment. An accuracy comparison between the different techniques is presented in [32].

2.3.2

Satellite positioning

Two global satellite navigation systems, Global Positioning System (GPS) and Global Orbiting Navigation Satellite System (GLONASS), are currently viable in the world. The third one, Galileo, is under construction. The Global Positioning System [34] was primarily designed for the U.S. and allied mil-

21 itary forces but quickly became an important part of the global information infrastructure with wide range of applications. The GPS system is managed by the Interagency GPS Executive Board (IGEB). It provides three dimensional position, velocity, and time information, 24 hours a day in all weather conditions, anywhere in the world. The location error varies from a couple of meters to several tens of meters depending on propagation environment. In Differential GPS (DGPS), the location accuracy is improved by determining the positioning error of the GPS system in a known location and then subtracting this error from the solution in an unknown location. Error correction signals are broadcasted by using FM radio transmissions. With DG PS, the positioning error can be diminished down the level of 1 to 3 meters. Assisted GPS (A-GPS) technology uses the cellular network to assist the GPS receiver in the mobile phone to overcome the problems associated with the determination of the initial location and the low signal levels that are encountered under some situations. The assistance information increases the battery life and enhances the sensitivity of the GPS receiver in the mobile phone. A-GPS is one of the standardized location techniques in 3G networks.

GLONASS
The Russian Global Navigation Satellite System GLONASS was declared operational The Russian Global Navigation Satellite System GLONASS was declared operational in 1993. GLONASS is managed for the Russian Federation Government by the Russian Space Forces. Currently, 13 satellites are in operational use and work is underway to modernize the system. The latest status of the satellites can be checked from the GLONASS web page [36]. GLONASS is available for the public use and it provides the capability to obtain horizontal positioning accuracy within 57-70 1neters (99. 7% probability) and vertical positioning accuracy within 70 meters (99. 7% probability).

Galileo
In year 2008, Europe's own global navigation satellite system Galileo [35] is supposed to be fully operational. It will be the first time when a highly accurate global positioning service controlled by the civilian authorities is available for the public. Galileo is a joint

22 initiative of the European Commission (EC) and the European Space Agency (ESA). It is planned to be inter-operable with the existing global satellite navigation systems GPS and GLONASS. In other words, it should be possible to use satellites from all the three different systems in any combination with a single receiver.

2.4

Mobile-Based Versus Network-Based techniques

Wireless location technologies fall into two main categories: mobile based and network based. In mobile-based positioning systems, the MS determines its location from signals received from some base stations (BSs) or from the global positioning system(GPS). In GPS-based estimations, the MS receives and measures the signal parameters from at least four satellites of the current network of 24 GPS satellites. The parameter measured by the MS for each satellite is the time the satellite signal takes to reach the MS. GPS systems have a relatively high degree of accuracy, and they also provide global location information. There is also a hybrid technique that uses both the GPS technology and the cellular infrastructure. In this case, the cellular network is used to aid the GPS receiver embedded in the mobile handset for improved accuracy and/ or acquisition time [3). Still, embedding a GPS receiver into mobile devices leads to increased cost, size, and battery consumption. It also requires the replacement of millions of mobile handsets that are already on the market. In addition, the accuracy of GPS measurements degrades in urban environments as well as inside buildings. For these reasons, some wireless service providers may be unwilling to embrace GPS fully as the sole location technology. Network-based location technology, on the other hand, relies on some existing networks (either cellular or WLAN) to determine the position of a mobile user by measuring its signal parameters when received at the network BSs. In this technology, the BSs measure the signals transmitted from an MS and relay them to a central site for further processing and data fusion to provide an estimate of the MS location. A significant advantage of network-based techniques is that the MS is not involved in the location-finding process; thus, the technology does not require modifications to existing handsets. However, unlike G PS location' systems, many aspects of

23
network-based location are not yet fully studied. For position estimation, two operations must be performed at the BSs. The BSs have to measure some signal parameters (such as the time or the angle of arrival) of the received MS signals. Then, the measured signal parameters are combined in a data fusion stage to provide the final estimate for position.

2.5

Dead Reckoning Positioning System

Another method of positioning, called Dead Reckoning System (DRS), has been adopted in some applications. In this technique, the new location estimation depends on how far an object has moved from a known place given the directions and distances traveled over small periods of time. Since this technique is simple and inexpensive, however, it has a crucial disadvantage in that the errors in the measurements of the direction and the distance affect the final position estimation. In other words, the measurement errors accumulate over the total period of time. Thus, the Dead Reckoning technique is recommended for use only over short periods of time.

2.6

Ranging

Ranging is defined as finding the distance between a target node and a reference node within a network. These distances are then used to determine the position of the target node. This is called positioning and can be seen as advanced ranging. Positioning can be sub-categorized in node-centered, relative and absolute positioning. Node-centered positioning is defined as the action of computing the positions of a set of target nodes with respect to a reference node. Any given node can be viewed as a reference node and the positions of the other nodes can be found referenced to this one.

2.6.1

Absolute Positioning

Absolute (geographical) positioning is a special case of relative positioning that is worth mentioning. The reference coordinate system coincides in this case with the global coordinate

24
system in which the coordinates are given in terms of latitude and longitude and are unique worldwide for each node as shown in Figure 2.6 .

N2

(·2,4 )

·
Nl
Reference node
(0,0)

N3

·

{-4,0. 75)

Figure 2.6: Absolute Positioning.

2.6.2

Relative Positioning

When it comes to relative positioning the key notion is that the positions of a set of nodes are calculated with respect to a common system of coordinates. All nodes share the same reference system and each node has a unique set of coordinates within this system. The reference coordinate system can be placed arbitrarily but evolves typically from the nodecentered system where it coincides with the coordinate system of a given node as shown in Figure 2. 7. The terms ranging and positioning are equally important for localizing sensors in a given network. Accuracy in distance estimation is necessary in order to achieve accurate positioning [3]. There are several techniques that can help in localizing nodes accurately and they will be presented in this chapter.

25

y

(1,3)

Nl.
· N2
(3,1)

X
Common System of Coord.inates

Figure 2. 7: Relative Positioning.

2. 7

Methods of Radio navigation

The use of radio frequency (RF) signals has become an integral part of modern day tracking and positioning systems. Some of these technologies, i.e, received signal strength(RSS), angle of arrival(AOA), time of arrival(TOA) measurement of a known burst transmitted by the mobile terminal (MT) to number of base stations (NBS) and these are different BSs.

2.7.1

Time of Arrival (TOA) Technique

The Time of Arrival technique exploits triangulation to determine positions of the mobile users. Position estimation by the triangulation is based on knowing the distance from the mobile to at least three base stations in the line of sight (LOS). The base stations determine the time signal takes from the source to the receiver either on the uplink or on the downlink, the controlling base station prompts the mobile to respond to a initial signal. The total time elapsed from the instant the command is transmitted to the instant the mobile responds is detected. This time consists of the sum of the round trip signal delay, and any processing

26
and response delay within the mobile unit. When the processing delay is subtracted from the total measured time, total round trip delay is found. Half of the quantity would be the estimate of the signal in one direction. Multiplying this time with the traveling velocity of the electromagnetic waves would give the approximate distance of the mobile from the base station. The approximate distance to the mobile determined by two additional receivers could be used to determine the mobile position at the intersection of circles from multiple TOA measurements, as illustrated in Figure 2.8. The mobile position can be determined accurately if there exists a complete LOS between the mobile station (MS) and the base stations. However the occurrence of non-line-of-sight (NLOS) propagation causes the signal to take a longer path to the base station receiver and the measured TOA is generally larger than the arrival time of an LOS signal. In such a circumstance, there is a need to detect NLOS and to correct the biased error in the TOA measurements before processing them. In TOA algorithms, which requires that all the participating BSs and MT clocks are synchronized and (BS
~

3) [3].

Figure 2.8: TOA method.

The TOA algorithm assumes that the burst sent by the MT takes an absolute time to reach the BS#i(i
=

TBSi

1, ... ,NBS). The BS#i is then able to measure

TBSi

and forward

this information to a central server, where location estimation is performed. Due to possible NLOS propagation conditions, the "true" Euclidean distance di between the MT and the

BS#i is such that

di ~

c

* TN BSi,

27

where c is the speed of light and the equality sign holds

only if the MT is in LOS condition with the BS#i. Therefore, the MT must be located within a circle of radius
C*TNBSi

centered at the BS#i. By repeating these arguments for all

the NBS , NBS circles are determined and their intersection MT(also called feasible region) defines the set of the possible location points for the MT. As a result, the MT location can be obtained by finding the centroid of the feasible region.

2.7.2

Time Difference of Arrival (TDOA) PL Technique

Next we examine the TDOA or hyperbolic PL technique. Two distinct stages are involved in the hyperbolic position estimation technique. In the first stage, time delay estimation is used to find the time difference of arrival (TDOA) of acknowledgement signals from MS to BS's are determined. This TDOA estimate is used to calculate the range difference measurements between the base stations. In the second stage, an efficient algorithm is used to determine the position location estimation by solving the nonlinear hyperbolic equations resulting from the first stage. TDOA can be estimated by subtracting the TOA measurements from the two BS's [28).

'
crl!S
BS1
1

\ \

'
\
\ ,

,"

"

;

//'c-rl!S:l

\ v tdT

8S2

Figure 2.9: TDOA method.

28

In this research we are using the time of difference of arrival(TDOA). The TDOA algorithms are based on measuring the difference in the time of reception of signals at different BSs, without requiring a synchronization of all the participating BSs and MT. Actually, the uncertainty between the reference time of the BSs and that of the MT can be removed by means of a differential calculation. Therefore, only the BSs involved in the location estimation process must be tightly synchronized. For a couple of BSs, let say i and j, the TDOA,
Tij,

is given by

Tij

=

TBSi -

IBSJ,

where

TBSi

and

TBSJ

are the absolute times taken by the

burst to reach the BSs i and j, respectively. Assuming that the MT is in LOS with both the BSs, i and j, it follows that the MT must lie on a hyperbola. A second hyperbola on which the MT must lie can be obtained using a further TDOA measurement involving a third BS. The user position can therefore be identified as the interception point of the two hyperbolae, as shown in Figure 2.9. The solution of the relevant equation system can be found with an iterative method and least squares minimization.

2.8

Optimization Approaches

In general, the MS position is not determined geometrically but is estimated from a set of nonlinear equations constructed from the TOA, RSS, TDOA, or AOA measurements, with the knowledge of the BS geometry. Generally optimization approaches for positioning are: Nonlinear Least Square (NLS), Maximum Likelihood (ML), Gaussian ML (GML), Genetic Algorithm Method (GAM ) and Constrained Least Square method(CWLS) [21]. Basically, there are two approaches for solving the nonlinear equations. The NLS approach is to

solve them directly in a nonlinear least squares (NLS) or constrained weighted least squares (CWLS) framework. Other method called Taylor-series estimation (also Gauss or Gauss-Newton interpolation) is an iterative scheme for solution of the simultaneous set of algebraic position equations (generally nonlinear), starting with a rough initial guess and improving the guess at each step by determining the local linear least-sum-squared-error correction. The disadvantages are:

29

· Method is iterative, requiring an initial guess. · lt is computationally complex compared to simple plotting of lines of position (LOP). · Being a local correction, its convergence is not assured. Although optimum estimation performance can be attained, it requires sufficiently precise initial estimates for global convergence because the corresponding cost functions are multimodal. The second approach is to reorganize the nonlinear equations into a set of linear equations so that real-time implementation is allowed. In this thesis, the latter approach is adopted, and we will focus on a unified development of accurate positioning algorithm, given TDOA measurement. There are several advantages of the constrained weighted least squares techniques that prove useful in the underlying problem. These are: · Simple incorporation of multiple linear constraints. · A simple solution that does not call for iterative techniques. · Geometric interpretation that brings valuable insights into the design problem. · Numerical stability, noise suppression, and computational savings that can be achieved via rank reduction and subspace splitting to dominant and subdominant subspaces. · Reducing complexity by converting the underlying constrained minimization problem to an unconstrained minimization problem. · Multiple measurements and mixed-mode measurements are combined properly, i.e., with the correct geometric factors, and can be weighted according to their a priori accuracies. · Multiple independent measurements to a single station are averaged naturally. · Statistical spread of the solution can be found easily and naturally.

30

· Failure to converge is easy to detect. · Simulation is easy, so convergence can be readily tested. · The initial position guess can be quite far off without preventing good convergence. A significant advantage is that the method leads naturally to measures of the accuracy of the position-location solution obtained at convergence. If information about error variance values is available, the terms in the matrix determine the error. Whether error variances are known or not, it will constitute an overall measure of the differences between the navigational measurements used as input data and the corresponding quantities obtained from the position solution. Further, it can indicate the occurrence of a measurement blunder and thus give a useful check on the validity of the solution. The CWLS method places many different measurements in a common mathematical framework. lt is hoped that this will encourage the consistent evaluation of the different measurement processes.

2.9

Filtering for Data Smoothing

The Kalman filter is a set of mathematical equations that implement a predictor-corrector type estimator that is optimal in the sense that it minimizes the estimated error covariance. The Kalman filter has been the subject of extensive research and application, particularly in the area of autonomous or assisted navigation. This is likely due in large part to advances in digital computing that made the use of the filter practical, but also to the relative simplicity and robust nature of the filter itself. Rarely do the conditions necessary for optimality actually exist, and yet the filter apparently works well for many applications in spite of this situation. Filtering is desirable in many applications. For example, radio communication signals are corrupted with noise. A good filtering algorithm can remove noise from electromagnetic signals while retaining the useful information. Kalman filter is a tool that can estimate the variables of a wide range of processes and estimates the states of a linear system. It is the one that minimizes the variance of the estimation error.

31 Kalman filter is very useful to solve the vehicle navigation problem. In order to control the position of an automated vehicle, we first must have a reliable estimate of the vehicle's present position. Kalman filtering provides a tool for obtaining that reliable estimate. It estimates a process by using a form of feedback control: the filter estimates the process state at some time and then obtains feedback in the form of (noisy) measurements. As such, the equations for the Kalman filter fall into two groups: time update equations and measurement update equations. The time update equations are responsible for projecting forward (in time) the current state and error covariance estimates to obtain the a priori estimates for the next time step. The measurement update equations are responsible for the feedback i.e. for incorporating a new measurement into the a priori estimate to obtain an improved a posteriori estimate. The time update equations can also be thought of as predictor equations, while the measurement update equations can be thought of as corrector equations. Indeed the final estimation algorithm resembles that of a predictor-corrector algorithm as shown in Figure 2.10.

Corrector

Prediction

Figure 2.10: Kalman Filter predictor-corrector algorithm.

A Kalman filter is recursive so that new measurements can be processed as they arrive.
It is essentially a set of mathematical equations that implement a predictor-corrector type

32
estimator that is optimal in the sense that it minimizes the estimated error covariance.

2.9.1

Utilization in positioning

The Kalman filter can be utilized in mobile positioning to filter out the high frequency errors that are not corresponding to the vehicle dynamics [37]. This is done by combining the primary position estimates with knowledge about the expected speed and acceleration in the Kalman filter. The modified Kalman filter is used for improving the TDOA location estimates especially in non line-of-sight conditions. The filter is evaluated with simulations and the results yield significant accuracy of the positioning estimation. Other filtering approaches have been proposed in [38], Kalman filtering is compared to hidden Markov modeling. The hidden Markov model can be described as a set of states and state transitions, which have a certain state transition probabilities. The position estimation is performed by finding the optimal state sequence associated with the given observation sequence. Both methods are evaluated with real measurement data. In conclusion, the

hidden Markov modeling is said to be less sensitive to errors in the model parameters and on the other hand, it contains fewer parameters than the Kalman filter.

2.10

Related Research

GPS and Dead Reckoning System (DRS) techniques are both commonly used in vehicle navigation systems. However, GPS and DRS suffer from different drawbacks. Integrating the two methods is one approach to develop an enhanced technique. Many researchers have been motivated by this idea and have looked at it from different point of view in [2], it was proposed combining the standard GPS receiver and a DRS in one navigation system so that the GPS fixes the accumulated error caused by the DRS. When the GPS measurement is not available, and the DRS estimates the position using sensors such as wheel odometers, flux-gate compass, gyroscope, and accelerometer. Similarly, it was stated in [17] that it is possible to integrate the GPS reading with the Inertial Navigation System (INS) by means of Kalman Filter.

33
It can thus be concluded that even with the most advanced and expensive GPS, it is

essential to integrate G PS measurements with other measurements such those from an INS to improve the positioning process. None of the mentioned papers was able to overcome the problem of losing the satellite signals; therefore, it is better to find another source of information that can help with the goal of improving position estimation. Nowadays, the same kind of techniques are used to position and track for emerging application. In order to estimate the position of a single source using estimated TDOAs, one needs to first choose a data model which describes how a source position is related to TDOA observations and how noise or measurement error is introduced. If errors (that are possibly mutually dependent) are supposed to be additive to and independent of the TDOA measurements, the source would be located at the intersection of a set of hyperboloids. Finding this intersection is a nonlinear problem. Although such an additive model does not easily land it self to modification due to the nonlinearity, it describes the principal constraints imposed by the TDOA data in a simple way and thus is widely used in studying the positioning problem. There is a rich literature of source positioning techniques that use the additive measurement error model. Important distinction between these methods include likelihood-based versus least-squares and linear approximation versus direct numerical optimization, as well as iterative versus closed-form algorithms. In early research of positioning with passive sensor arrays, the maximum likelihood (ML) principle was widely utilized because of the proven asymptotic consistency and efficiency of an ML estimator (MLE). However, the number of microphones in an array for camera pointing or beamformer steering in multimedia communication systems is always limited, which makes positioning a finite-sample rather than a large-sample problem. Moreover, ML estimators require additional assumptions about the distribution of the measurement errors. One approach is to invoke the central limit theorem and assumes a Gaussian approximation, which makes the likelihood function easy to formulate. It can be difficult to verify and the MLE is no longer optimal when sampling introduces additional errors in discrete-time

34

processing. To compute the solution to the MLE, a linear approximation and iterative numerical techniques have to be used because of the nonlinearity of the hyperbolic equations. The Newton-Raphson iterative method, the Gauss-Newton method, and the least-mean square (LMS) algorithm are among possible choices. But for these iterative approaches, selecting a good initial guess to avoid a local minimum is difficult and convergence to the optimal solution cannot be guaranteed. Therefore, it is our opinion that an ML-based estimator is not suitable for the real-time implementation of a positioning system. For real-time applications, closed-form estimators are desired and appropriately, have also gained wider attention. Of the closed-form estimators, triangulation is the most straightforward. However, with triangulation it is difficult to take advantage of extra sensors and the TDOA redundancy. Nowadays most closed-form algorithms exploit a least-squares principle, which makes no additional assumption about the distribution of measurement errors. To construct a least-squares estimator, one needs to define an error function based on the measured TDOAs. Different error function will result in different estimators with different complexity and performance. The TDOAs to three sensors whose positions are known provide a straight line of possible source locations in two dimensions and a plane in three dimensions. By intersecting the lines/plans specified by different sensor triplets. Another closed-form estimator, termed spherical intersection(SI), employed a spherical LS criterion. The SI algorithm is mathematically simple, but requires an a priori solution for the source range, which may not exist or may not be unique in the presence of measurement errors. Although the SI method has less bias, it is not efficient and it has a large standard deviation. With the SI estimator, the source range is byproduct that is assumed to be independent of the position coordinates. it [24] improved the SI estimation with a second LS estimator that accommodates the information redundancy from the SI estimates and updates the squares of the coordinates. Other is quadratic-correction least-square (QCLS) estimator. In the QCLS estimator, the covariance matrix of measurement errors is used. But this information can be difficult to properly assume or accurately estimates, which results in a performance degradation in practice. When the SI estimate is analyzed and the quadratic correction is derived in

35 the QCLS estimation procedure, perturbation approaches are employed and presumptively,

the magnitude of measurement errors has to be small. But when noise is practically strong, its bias is considerable and its variance could no longer approach the stability. Recently a CWLS algorithm has been proposed. This method applies the additive measurement error model and employs the technique of Lagrange multipliers. The idea proposed in this thesis is to take advantage of all the research mentioned and develope a new position technique that will increase the accuracy of the position estimation so that it will be precise enough for most spatial systems. Specifically, using Kalman Filter to integrate a G PS reading with the measurements since fusing the measurement sets overcomes the faults. In proposed method, first the NLOS error bias have to be detected in the TDOA data. The bias in the measurements can be identified if we have the a priori knowledge of the standard deviation of the standard measurement noise. In the presence of the NLOS error, the measured range differences would deviate from the smoothed curves so that the standard deviation is much greater than the standard deviation of the standard measurement noise. The proposed method is based on the fact that the effect of NLOS error is to positively bias the measured range differences. Since the standard measurement noise, hence on the average the measurements will have a positive bias equal to the mean of the NLOS error. So to reduce the effect of the bias, the raw measurements need to be shifted downward by the value equal to the mean of the NLOS error.

Chapter 3 Methodology
The proposed formulation in this thesis introduces an additional optimization operation to the traditional systems. The optimization operation is applied to the output of a Kalman Filter in order to increase the accuracy of the position. Before the details of optimizing the position estimation are discussed, this thesis focus on the range-based technique of TDOA. Because the relative advantages of TDOA method are over other methods, this technique is widely used in RF PL system for the geo-position of mobile user [22).

3.1

Positioning Measurement Models

This section describes the TOA and TDOA measurements. Let x = [x, y]T be the MS position to be determined. The coordinates of the ith BS is
Xi

=

[xi, Yi]r, i

= 1, 2, · · ·,

M,

where the superscript T denotes the transpose operation and M is the total number of the receiving BSs. The distance between the MS and the BS, denoted by di, is given by
i = 1, 2, · · ·, M

(3.1)

The TOA is the one-way propagation time taken for the signal to travel from the MS to a BS. In the absence of disturbance, the TOA measured at the BS, denoted by ti, is
ti = -

di c

i = 1,2,···,M

(3.2)

where cis the speed of light. The range measurement based on ti in the presence of distur36

37 bance, denoted by rroA ,i is modeled as i=1,2,···,M (3.3)

where nroA,i is the range error in rroA,i· Equation (3.3) can also be expressed in a vector form as

rTOA = fToA(x) + llTQA,
where

(3.4)

rToA = [ rroA,I nToA = [ nroA,I
and

rroA,2 · · · rroA,M ] T , nroA,2 · · · nroA,M JT ,

(3.5)
(3.6)

j(x- xJ) :+ (yfToA(x) =

2

Y1)2]
(3.7)

[

j(x- XM) 2 + (y- YM) 2

3.2

TDOA Measurement Algorithm

The TDOA is the difference in TOAs of the MS signal at a pair of BSs. Assigning the first BS as the reference, it can be easily deduced that the range measurements based on the TDOAs are of the form:

i

= 2,3, · · ·, M

(3.8)

where nrnoA,i is the range error in rrnoA ,i · Notice that if the TDOA measurements are directly obtained from the TOA data, then
nrnoA,i

= nroA,i- nroA,I,

i

= 2, 3, · · ·, M .

38 In vector form, (3.8) becomes
rTDOA = fTDOA(x)

+ llTDOA,

(3.9)

where
rTDOA = [ TTDOA,2 llTDOA = [ nTDOA,2
TTDOA,3 · · · TTDOA,M ] T,

(3.10) (3.11)

nTDOA,3 · · · nTDOA,M ] T,

d2- dl d3- dl
fTDOA(x) =

l

(3.12)

[
dM- d1

3.3

CWLS Optimization

The CWLS approach is to reorganize ·the nonlinear equations into a set of linear equations. In this paper, the CWLS approach is adopted and we will focus on a unified development of accurate position algorithms for TDOA measurement. For TDOA-based position systems, it is well known that for noise conditions, the corresponding nonlinear equations can be reorganized into a set of linear equations by introducing an intermediate variable, which is a function of the source position. This technique, is commonly called spherical interpolation (SI) [27]. However, the SI estimator solves the linear equations via standard least squares (LS) without using the known relation between the intermediate variable and the position coordinate. To improve the location accuracy of the SI approach, it has proposed in [24] to use a two-stage CWLS to solve the source position, while [21] incorporates the relation explicitly by minimizing a constrained LS function based on the technique of Lagrange multipliers. According to [21), these two modified algorithms are referred to as the quadratic correction least squares (QCLS) and linear correction least squares (LCLS), respectively. The quadratic-correction least -squares( QCLS) estimator and linear-correction least-square(LCLS) yields an unbiased solution with small standard deviation that is close to moderate noise level. But when noise is practically strong, its bias is considerable and its variance can no longer fulfill the stability criteria. In this work, we develope a unified

39 approach for mobile location by utilizing TDOA measurement and improving the ranging

accuracy with the use of CWLS. CWLS will improve the performance of the QCLS estimator and LCLS estimator by introducing a weighting matrix in the optimization, which can be regarded as a hybrid version of the QCLS and LCLS algorithms [13]. The CWLS mobile positioning approach for the TDOA measurement is: without disturbance, (3.8) becomes:

It can be rewritten as

rrnoA,i + V(x- xi)2 + (y- YI)2 = V(x- xi)2 + (y- Y i) 2

i = 2, 3, · · · , M

(3.13)

Squaring both sides of (3.13) and introducing an intermediate variable, RI, which has the form (3.14) we obtain the following set of linear equation

(x- xi)(xi- xi)+ (y- YI)(Yi- YI) + rrnoA,iRl
=

1[ 2 2 (xi- xi) +

(Yi- YI) +

2

rTDOA,i]

2

(3.15)

i = 2,3, · · ·, M

Writing (3.16) in matrix form gives

G6=h
where
Y2- YI
YM- YI

(3.16)

rrD:OA,2]
rTDOA,M

(3.17)

h =

~
2

[

(x2 - x1J2 + (Y2 :- YI)
(
XM-

2
2

+ rhoA,2
2

l
'

(3.18)

XI)

2

+ (YM- yr) + rTDOA,lvl

.

and the variable 6 =

[x-

xi,

y- yr,

RI]T,

consists of the MS location as well as RI [22].

40
In the presence of measurement errors, the SI technique determines the MS position by simply solving (3.16) via standard LS and the location estimate is found from

J=

argmin(GJ- h)T(GJ- h)
= (GTG)- 1 GTh,

(3.19)

where

J = [x-x1,

y-y1,

R 1 ] is an optimization variable vector [21].

" T

An improvement to the SI estimator is the linear correction least squares (LCLS) method, which solves the LS cost function in (3.19) subject to the constraint of (x- xi) 2 + (y- y 1 ) 2 =

Rr, or equivalently,
(3.20)
where 2: = diag(1, 1, -1). Optimum estimate of the positioning of the vehicle is computed by minimizing the following CWLS cost function:

(3.21)
where Q is the covariance matrix of TDOA's measure values, which is a function of the estimate of R 1 , denoted by

R1

(21].

The idea of CWLS estimator is to combine the key principles in the CWLS and LCLS methods that is, the MS position estimate is determined by minimizing (3.21) subject to

(3.20). For sufficiently small measurement errors, the inverse of the optimum covariance
matrix Q- 1 for the CWLS algorithm is found using the best linear unbiased estimator (24] as

(3.22)
where

l [ ~: = ~: ! ~: l [
~:
d~I
dM - dl

(3.23)

+ Rl

and

0 denotes element-by-elements multiplication. Since Q contains the unknown {di}, we

express

41 and approximate (di- d1 ) by rrnoA,i· Similar to [21], the CWLS problem is solved by using the technique of Lagrange multipliers and the Lagrangian to be minimized is (3.24) where
'TJ

is the lagrange multiplier to be determined.

The estimate of 6 is obtained by

differentiating (3.24) £rDoA(6, ry) with respect to as

J and then equating the results to zero [21]

The solution is: (3.25) where
7]

is real value. Put

7]

in (3.25) and obtain the sub-estimates of

J.

Then choose the

solution

J from those sub-estimates which makes the cost function

(3.21) minimum.

3.4

Position Measurement Model and NLOS Identification

The range measurement between a mobile station and the mth base stations corresponding to TOA data can be modeled as: (3.26) where rm(ti) is the measured range at the sampling time ti, Lm(ti)is the true range, nm(ti) is the measurement noise and can be modeled as a zero-mean additive Gaussian random variable with variance (J"m (AWGS); N LOSm(ti) is the NLOS error component in the received signal. There is no NLOS error if the line-of-sight exists, in which case, the measurement error nm(ti) becomes the only source of range measurement error. To mitigate the NLOS errors, the existence of non-zero NLOS component needs to be identified [12]. To identify the change of channel situation between NLOS and LOS, the standard deviation of the estimated range data r m ( ti) can be calculate as

N L(rm(ti)- Lm(ti)) 2
i=l

1

N

A

(3.27)

42 where Lm(ti) is the estimated range data of the mth BS at time instant ti smoothed by the
A

unbiased Kalman filter. The standard deviation estimated in equation (3.27) can then be used in the simple hypothesis testing to determine the LOS /NLOS BSs
Ho: a~

< {CJm · · · LOS condition
{CJm · · ·

(3.28) (3.29)

H1 : a~ 2::
where

NLOS condition

r is a scaling factor, and r > 1 is used to reduce the probability of false alarm due to

small changes in variance at LOS condition.

3.5

AWGS Model

In all of the simulations, zero-mean additive white Gaussian noise is added to simulate the effect of thermal and background noise and the noise in the receivers. To add noise according to the desired level of Eb/ N 0 . In the simulation of digital communications systems, the SNR is commonly evaluated as Eb/ N 0 , where Eb is the transmit energy per bit and N 0 is a function of the noise power spectral density. The energy per bit in terms of the transmit signal power is given as (3.30) where
Tbit

is the duration of a bit and Ps is the signal power at the receiver input. Because

of spreading sequence and the sampling of the signal by N 8 , the energy is spread over many more symbols. The noise power, assuming a AWGN channel with two-sided power spectral density of N 0 /2, is given by

a~= No/2
Based on these assumptions, we get the variance of each noise sample to be

(3.31)

(3.32) where A is the amplitude of the user's signal. In our simulations, we have used unity signal power which results in A = 1. Therefore, the noise power for a given Eb/ N 0 is calculated

43

using (3.33) Hence, zero-mean Gaussian noise samples with variance given by (3.33) are added to the signals of all the users.

3.5.1

NLOS Error Model

The NLOS error can be modeled as the frequently used models for delay profiles which are exponential, uniform or delta random variable. The Saleh-Velenzuela (S-V) model is the model for multipath of an dance environment. The channel measurements showed that multi path arrivals in clusters rather than in a continuous form [12]. Assume that T0 is the arrival time of the first path in the first cluster. The arrival time T0 can be related to the positive NLOS error component N LOSm(ti) at the time instant ti. For the LOS cases, we have T0 = 0 and N LOSmti = T 0 x c = 0 and c is the speed of light. The arrival time T 0 for the NLOS cases can be modeled as an exponential distribution and described by the following formula [5]:

p(To) =A exp[-A(To)]

(3.34)

where A(l/nsec) is the cluster arrival rate. To mitigate the NLOS errors N LOSm(ti), the existence of non-zero NLOS component needs to be identified first.

3.6

Data Smoothing by Kalman Filter

The classical Kalman filter is suitable for real time applications. A Kalman Filter has been implemented in order to improve the accuracy of the position in different ways. A fixed speed and direction model is used here, since all the experiments are simulated model in MATLAB. For every vehicle that starts moving from a known position Xk
E

R 2 at time tkl

it is possible to estimate its position after a period of time /1t (sampling period )as follows:

(3.35)

44
where vector Xk signifies the exact vehicle position, which will be called the state, at time
tk, and the vector Xk
E

R 2 signifies the vehicle velocity which is obtained from the Inertial

Navigation System at tk as follows:

(3.36)
S E R signifies the vehicle speed, and

e

E

[0, 360] signifies the vehicle direction with respect

to the global axis. In addition, every vehicle has a location measurement obtained by means of its GPS receiver, which is indicated by

YGPS,k = (

~)

(3.37)
GPS,k
E

where k

E

(0, 1, 2, ... )signifies an index of the measurement sample at tk, and x, y

R signify

the vehicle's global coordinates. A Kalman filter can be used in estimating the state vector of a mobile target from the observed range data and therefore estimating the true range value. The state vector can be represented in [20]

(3.38)
where X(k) = [Lm(k)

Lm(k)] is the state vector of the mobile related to the mth sensor.

A= [ 1 6t]
0 1

'

B = [ 6t

0

6t

0 ]

(3.39)

Xk+ 1 is a 2 x 1 vector that signifies the state or position of the vehicle at time tk+ 1, given the position and the velocity at time tk.

:X.(kjk-1) = AX(k-1jk-1) where X(kjk-1)iS defined as an apriori state estimate at tk. An a priori estimate error e(k/k- 1):

(3.40)

(3.41)

45

and the apriori estimate error covariance is then
(3.42)

Process Noise Covariance The W(k) is the driving noise and

(3.43)

Process noise covariance matrix Q = a;I, and

(3.44)

where aw(i) = B for direction and aw(j) = s for speed.

wk

is a 2

X

1 vector that signifies
tk

the input of the Kalman Filter that is the INS measurement at time The measurement process is

(vehicle velocity).

(3.45)

where

Y(k+l)

is the measured data that signifies the expected reading at

tk+l·

c=
Yk+l

[

~ ~

l
tk+l·

(3.46)

is a 2 x 1 vector that signifies the expected reading at

The matrices A, B,

and C are 2 x 2 transition matrices that relate the current state and current input to the next state, and the expected state to the next measurement, respectively.

(3.47)
X(kik)

is defined as an aposteriori state estimate, which can be calculated given the measuree(k/k).

ment at tk and an a posteriori estimate error and the aposteriori error estimate is

(3.48)

46

Measure Noise Covariance
U(k)

is the measurement noise and

(3.49)
The measurement noise covariance matrix R = a~l is:

R = diag([a~, a~])

(3.50)

a~ is horizontal velocity components as estimated by the navigation system are used as

observation to the filter implementation.

Q and R are 2 x 2 matrices that signify the process noise covariance and the measurement
noise covariance, respectively. Q and R may change over time in the real world. These two matrices resemble the covariance of the INS error and the error of the GPS data when no multipath effect is present. Thus, it is assumed that they are constant. The operation of the Kalman filter can be summarized as follows: · Kalman filter time update equations: The apriori and aposteriori error covariance can be defined as
p (klk-1)

=

AP (k-1lk-1)A T

+ BQBT

(3.51)

· Kalman filter measurement update equations

(3.52)
The matrix
K(k)

is chosen to be a blending factor that minimizes the aposteriori

estimate error covariance. This blending factor is the Kalman gain vector.
X(klk) = X(klk-1)

+ K(k) [Y(k)

-

CX(klk-1)]

(3.53) (3.54)

P(klk) = P(klk-1)- K(k)CP(klk-1)

and p (klk) is the covariance matrix of x(klk).

47

. .¥010 ,f>o10 andXk

.

for the first time

Measurement Update

n

Time Update

Ll

xktk = xkik- 1 +K(yk -C1fk-1)

X

k /k-1
kl k-1

=AX +B¥ k-1 / k-1 k
=AP

pk l k =(1-KC)Pk / k-1

P

k-11 k-1

AT +Q

Computing Kalman Factor Gain

Figure 3.1: The Kalman Filter loop.

48

With the above equations, all the quantities required for estimating the system state at
tk are determined.

Figure 3.1 shows a block diagram depicting the discrete Kalman Filter loop that is used to estimate the systems next state in every cycle with the optimal error reduction. Two basic stages are described in Figure 3.1, the time update stage and the measurement update stage. In the first, the INS measurement is obtained and used to estimate the next location after

!:J.t and to calculate the a priori error covariance matrix P (k/k-l). In the second, the GPS is
obtained and fused with the result of the time update stage after calculating the Kalman Filter gain K. The aposteriori error covariance is also calculated in the measurement update stage because, it is needed in order to provide the filter with the initial state or location
X(ojo)

and the initial covariance error P (O/O), which will start the filter. Figure 3.2 shows

the predicted, filtered and smoothed trajectory's responses of kalman filter.

+

Predicted Position Measure Position Filtered Position Smoothed Position

Predicted Trajectory FilteredT rajectory Smoot hedTrajectory

·
·
..

Figure 3.2: Kalman Filter Response.

3. 7

Improving Positioning in a Multipath Environmerif

Although the Kalman Filter estimates position with a minimum mean square error, it produces unexpected errors as a result of multi path effects or the loss of the satellite signals. The focus in this thesis is on minimizing the multipath effect. However, reducing the multipath effect is only one aspect of the problem; detecting the multipath effect is another challenge. The proposed technique works in conjunction with the Kalman Filter to help vehicles detect the presence of the multipath effect in their position estimates. The multipath effect adds noise to the position estimate and contaminates the randomness of the measurement error. Accordingly, the Kalman Filter is not optimum in cycles when the multipath effect is present. CWLS will help to localize the target vehicle more accurately.

3.8

Detection of the Multipath Effect

In this thesis, the uncertainty of a vehicles position is represented by the variation in the discrepancy between the time update estimate of the Kalman Filter and the GPS data as follows:
Discrepancy =
Y(k) CX{klk-1)

(3.55)

Multipath effect in the GPS data will be reflected in the discrepancy value. Every vehicle should record the number of previous discrepancy values. The number of these values should be neither too small nor too large in order to well represent the uncertainty of the recent position estimation. When a vehicle does not experience any multipath effect, Gps accuracy will be good and the discrepancy values will be small and almost identical. As a result, the variation in the discrepancy values will also be small. In other words, this vehicle will have a small uncertainty about the position and it can therefore be used as a reference node for its neighbors. However, if a vehicle experiences multipath effect, the accuracy of the GPS will be drastically affected and the discrepancy values will be totally and randomly different. As a result, the variation in the discrepancy values will be large. In other words, this vehicle

50

will have a large uncertainty about the position, and it should not be used as a reference node for its neighbors in order to avoid misleading them. The discrepancy between the estimated position in the first stage and the actual measurement reflects the divergence between the GPS data and the position estimate. This divergence can decide that whether a multipath effect is present or not.

NLOS Error
Y(k) cx(klk-1)

>o

(3.56) (3.57)

then,

X(k+ 1) = AX(k)

+ BW(k)

LOS Error
Y(k) cx(klk-1)

<o

(3.58) (3.59)

then,

a~(k) =a~

The modified biased Kalman filter is proposed to process the range measurement according to the feedback identification result from the previous processed data. Before computing kalman gain, the measurement noise covariance a~ or the range prediction covariance P (klk- 1) is adjusted.

3.8.1

Biasing the Kalman Filter

The NLOS condition causes very high errors in range measurements. When the TDOA value is identified as NLOS, it is directed to a highly biased Kalman filter. This filter is biased in the sense that range error variance in the covariance matrix Q is assumed to be very high compared to that of the LOS case. This, in turn decreases the dependence of the output to the NLOS measurement. Here the filter's output follows previous outputs more closely. The idea in this simulation is to minimize the RMSE of the TDOA time series at the output of the filter by carefully selecting the best bias parameter. Figure 3.3 shows the flow chart of the algorithm:

51

Range measurments

LOS
decjsion

Variance calculation

NLOS
decision

Unbias, ed Identification

Biased

Constrained Weighted Least Squares CWLS

Position esti. mation

Location tracking

Figure 3.3: Flow of Algorithm.

Chapter 4 Simulation Results
This chapter presents the implementation of the algorithms and theoretical work explored in Chapter 3. First, the implementation of the Kalman Filter for a vehicle is described. then, the effect of multipath signals on GPS data and the performance of the Kalman Filter are demonstrated. The chapter concludes with the discussion of the results and a comparison of the different simulated scenarios.

4.1

Simulation Scenario

This research uses Matlab for simulation. The developed algorithm simulates a GPS operation by generating the GPS data code. In many applications, the Global Positioning Systems (GPS) receiver is connected to some form of intelligent electronic system which receives the positional data from the GPS unit and then performs the required operation. When developing and testing GPS-based systems, one of the problems is that it is usually necessary to create CPS-compatible geographical data to simulate a GPS operation. The simulation scenario covers a 5000 m (5 km) portion of a straight road. Vehicles traveling this road experience different local environments, such as an open area with no multipath effect, and an inner-city area where high buildings cause a severe multipath effect (NLOS error). The road consists of two lanes in one direction for vehicles with different speeds. The right lane contains the vehicles traveling at 50 km/h, and vehicles in the left lane are traveling at a higher speed of 60 km/h. The width of each lane is 3 meters, and

52

53

2km

0.3 km

0.4 km

0.4 km

1.91cm

Skm

Figure 4.1: Simulation Scenario.

54 vehicles are assumed to move in the center of the lanes. The simulation period is equal to
the time required for a vehicle to pass through 5 km at a speed of 50 km/h. As shown in Figure 4.1, on the first 2000 meters of the road the vehicles travel through an open-area environment. They then experience a multipath effect over a distance of 300 meters. Another region of open area follows for 400 meters. The second multipath area occurs for the next 400 meters. Then the vehicles travel through an open area to the end of the road.

4.2

Initialization

In the simulation, the designed values of matrices for the process noise and measurement noise covariance in kalman filter are as follows: The error in the state is represented by the process noise covariance matrix

Q = diag([(0.5m/s) 2 , (0.5m/s) 2 ])

(4.1)

W k is a 2 x 1 vector that signifies the input of the Kalman Filter that is the INS measurement

at time tk (vehicle velocity). The local and global errors in the GPS data are represented by the measurement noise covariance matrix of the Kalman Filter

R = diag([a~, a~])

(4.2)

However, R does not represent the measurement error covariance matrix when the Kalman filter estimation has deteriorated because of the NLOS effect. The measurement noise is assumed to be AWG N and NLOS noise is added to the true calculated range to get the measured range data. The measurement noise is assumed to be Gaussian distributed with zero mean and a standard deviation as shown in table 4.1 and this random change results in a dramatic increase in the uncertainty in the Kalman Filter estimate.

55 Parameters Process noise covariance Measurement noise covariance -Open Area - High buildings Sample data Sampling rate Values 0.5m 10-15m 100-150m 200 lsec.

Table 4.1: Setup Kalman Filter Implementation.

4.3

Results

The vehicles positioning technique is based on integrating the INS measurements and the GPS data via the Kalman Filter. In Figure 4.2 stars show how GPS data estimate the vehicles position that is unreliable specially when the vehicle passes through high-building regions. The simulation shows that curve line represents the position estimate by the Kalman Filter with the integration of INS and GPS data and straight line represents the "true" position of vehicle. In the simulation, in each second, the Kalman Filter can obtain one or more measurements of the INS system in order to estimate the next position via its time update stage; however, one INS measurement per second is used in the simulation because all the vehicles are moving in one direction at fixed speeds. Figure 4.3 shows how the estimate of the vehicles position is drastically affected and becomes unreliable when the vehicle passes through high-building regions. But the Kalman filter is changing the scenario from unbiased mode to biased mode abruptly. The statistics related to the position error are provided in table( 4.2). These statistics are calculated by computing the position error PEt in every second (t), since the position technique estimates positions every second. Then the mean and the standard deviation of the position errors are computed for different distances according to the local environments.

PEt

=II

t "t xreal- X

112

(4.3)
(4.4)

Mean Error= N t~ PEt

1

t2

56

5000

1: ~
'iii
0
Cl.

e

.. . .. .·.. . .. ... ..
\

.

.....

... · ·.
*
0

:.

-3000'------'-----''-----'-------'-----'-----'-----'------'
200

Time (sec)

Figure 4.2: Position estimation by GPS data and Kalman Filter.

Figure 4.3: Position estimation for LOS /NLOS conditions.

Standard Deviation of the Error= (N ~(PEtt=h

1

t2

57

MeanError) 2 ) 112

(4.5)

In table 4.2, the first column shows the type of environment that the vehicle experiences, the second column lists the length of the distance traversed in that simulation, the third and fourth columns give the mean error-environment and the standard deviation of the error in position estimate, respectively. It can be seen that the positioning techniques using the Kalman Filter and GPS can be reliable in the first open-area region. However, the increase in the standard deviation and the mean of the localization error in the first high-building region proves the unreliability of the location estimation technique using the GPS in the presence of the multipath effect. Moreover, the multipath effect still appears in the mean and the standard deviation of the positioning error during the second open area region even after the vehicle has left the first high-building region. In the second high-building region, the mean of the position error dramatically increases because the positioning error has been large since the beginning of this region. The multipath effect remaining in the positioning estimate from the previous open area causes an error in the position estimate at the beginning of this region. Again, the standard deviation of the positioning error during the second highbuilding region shows the instability caused by the multipath effect. The Kalman Filter finally brings the position error back to almost the same accuracy as at the beginning of the first open-area region. However, it minimize the error in the last open area. Enviroment Open area 1 High buildings 1 Open area 2 High buildings 2 Open area 3 Distance(m) 2000 300 400 400 1900 Mean Error (m) 2.33 30.49 9.43 24.01 4.92 Standard Deviation of the Error (m) 1.35 19.82 5.13 27.11 4.50.

Table 4.2: Error Statistics for the Positioning using Kalman Filter.

Figure 4.4 shows that the changes of the LOS/NLOS situation can be identified immediately, based on feedback of LOS /NLOS status and standard deviation. When estimator starts the calculation, the unbiased smoothing is used and the smoothing filter immediately switches to biased mode. NLOS errors can be effectively mitigated by the modified

58 biased Kalman filter. The scaling parameter '"'( = 1.2 is chosen for the testing to reduce the probability of false alarm in simulation.

Estim~td

position bJ GPS and l<almlllfht

~
I

:
I

; si,
0

el
I

I

I I I I I I I I I I

I

:E II
0

!
I

a. 7~
I I

I

I

rro .

....
I

'I I I I I

..;.>
.......... +..

L ·

/
200
:r6

210

Time (aec)

Figure 4.4: Hypothesis testing, Standard deviation for NLOS/LOS.

It can be seen that the position technique can be reliable in the first open-area region.

However, the increase in the standard deviation and the mean of the position error in the first high-building region proves the unreliability of the position estimation technique in the presence of the multipath effect. The problem with estimating position as discussed in this thesis is fundamentally caused by local and global GPS data errors. The system state will be affected, if there is any error in the INS measurements i.e. the vehicles speed or direction as shown in Figure 4.5. Acceleration of a vehicle produces changes in velocity and position, which results in error that should be corrected by feedback. Figure 4.6 shows how the Kalman Filter estimates the locations of a vehicle traveling in an open area for 1.8km, when mean error is 2.33 and standard deviation of the error is 1.35. Figure 4. 7 illustrates the application of Kalman filter when vehicle passing through the High buildings (NLOS), where the staright line and soild curve denote the true position and

59

-2~ooL----~----~--~~--~,7oo~--72007---~2720~--~----~--~7---~ Time (sec)

Figure 4.5: Vehicle Speed variation.

-1000

g

E

i

E

-500·0~----------------~~--------------~.007---------------~

Time (sec)

Figure 4.6: Position estimation 1n Open area.

60

Estimated position In Multlpath (NLOS)

2000

1800

0 ;: 1400

e c
·u;
0

1600

Q.

1200

1000

800 200

210

220

230

240

250

Time (sec)

Figure 4. 7: Position estimation in High Building area using biased KF.

Figure 4.8: Comparison of the average position error.

61 the estimated position respectively.

It can be seen in Figure 4.8 that the position technique using the GPS can be reliable
in the open-area region. However, the increase in the standard deviation and the mean of the position error in the first high-building region proves the unreliability of the position estimation technique using GPS in the presence of the multipath effect and the difference between the position estimates by GPS and Kalman filter is clear.

4.4

Kalman Filter and CWLS Implementation

In the experiment, the algorithm for improving the position estimate introduced unexpected errors in its position estimate. The output of the algorithm as shown in table 4.3 position estimate error statistics , is based on the Kalman Filter with CWLS optimization that minimizes the error in positioning a target vehicle since their position estimates are more accurate. During the open-area regions of the scenano, the CWLS technique outperforms the Kalman-Filter-only technique. Especially immediately after any high-building region, the position estimate error became very small. Although two poor position estimates occur in the second high-building region. The algorithm for improving the position estimate introduced unexpected errors in its position estimate. The output of the algorithm is based on the optimization that minimizes the error in positioning a target vehicle. Environment Open area 1 High buildings 1 Open area 2 High buildings 2 Open area 3 Distance(m) 2000 300 400 400 1900 Mean Error (m) 2.21 16.21 8.86 13.11 1.75 Standard Deviation of the Error (m) 1.25 9.82 4.31 18.63 0.87

Table 4.3: Error Statistics for the Positioning using Kalman Filter and CWLS.

Fig.4.9 shows the range measurement which is optimized by applying CWLS optimization technique to improve the estimation in NLOS region. It can be observed that the estimation by applying CWLS technique can greatly improve the estimation accuracy. Fig.4.10 shows

62

Estimeted position with CWLS Optimization

4000

g c
0 :;::

3000

a.

~

2000

- l OOOO L _ _ _ . . L _ _ _ _ - ' - - -- ' - -- -2 -00'---l..-300 ' - - -_j__350_

_______J

Time (Sec)

Figure 4.9: NLOS mitigation with CWLS optimization.

the position estimation error with constrained and unconstrained filters represented by the dashed and the solid curve respectively. It can be seen that the constrained filter results in much more accurate estimates than the unconstrained filter. The unconstrained filter results in average position errors of about 5.6 m, while the constrained filter results in position errors of about 3.1 m. The constraints may be time-varying. At each time step the unconstrained Kalman filter solution is projected onto the state constraint surface. This significantly improves the prediction accuracy of the filter.

4.5

Comparison of the Techniques

Figure 4.11 shows a comparison of the two techniques. With the Kalman filter technique, the standard deviation becomes high in the high-building regions because of multipath effect. On the other hand, when using the CWLS technique with Kalman Filter, standard deviation has significantly low and improves the estimation accuracy. The algorithm for improving the position estimate introduced unexpected errors in its

63

20r---~----~----~--~~==~====~

18

- - - unconstrained · · · · · · · constrained

16

g 14
Q)

c::
.Q

~ 10
(/)

cu
Q)

12

.g
a..
-~

c::

8
6 4
2

50

100

150
seconds

200

250

300

Figure 4.10: Position estimation error with the constrained and unconstrained filters.

position estimate. The output of the algorithm is based on the optimization that minimizes the error in positioning a target vehicle. The ideal case, in which the error in the position estimation is equal to zero, produces only one global minimum for the optimization problem. However, it is hard to find the ideal case in an experiment or even in the real world because every vehicle has an error in its position estimate. Such positioning errors result in two, three, or more local minima in the optimization problem.

64

30

· Std. dev. of Error(l<f)

Ic:: 20 .2 ... ·m
"0 "0
U')

CIJ

>

15

'E ftJ
J!
c::

.10

open areal

Hieh Buildines

Open area 2
Regions

Hi&h Buildings

Openarea3

Figure 4.11: Comparison of Standard deviation between two techniques.

Chapter 5 Conclusions and Future Work
In this thesis, new techniques have been proposed for improving the accuracy of the position estimate. The efficient NLOS mitigation technique has been proposed in the position estimation architecture to give quite accurate results. This chapter summarizes these techniques and suggests the future work.

5.1

Conclusions

The technique and algorithm in this thesis has been developed to be used for Vehicle Positioning. Vehicles often use GPS receivers to localize themselves; however, the accuracy of the GPS receivers location estimate is not reliable when the satellite signal is completely lost or distorted by trees, high buildings, or tunnels. The absence of satellite signals has been studied in much of the research and a Kalman Filter has been employed in order to integrate the G PS measurements with other measurements, such as the INS measurements, and to overcome the outage of the satellite signals. However, the distortion of the satellite signal still causes misleading information for the positioning system in the vehicles. In the proposed technique, the GPS receiver measurements are integrated with the INS measurements using a Kalman Filter because it has been proven that the Kalman Filter can fuse sensed data and obtain a minimum mean square error. To avoid the distortion of the satellite signal caused by the NLOS effect, a classifier has been added in order to detect whether the satellite signal is affected by the multipath signals that the system is receiving.

65

66

This classifier was designed using the simple hypothesis testing to determine the 108/NLOS. Once the test produces a result, the proposed technique decides whether to take the output of the Kalman Filter as the final output or to optimize the Kalman Filters output using the algorithm Constrained Weighted Least Square method. Simulation results demonstrate the effectiveness of this method. If the state constraints are nonlinear they can be linearized. The proposed method gives a real-time constrained least squares estimation algorithm for tracking the position using TDOA measurements. The NLOS errors can be mitigated effectively for achieving higher accuracy in range estimation and wireless location. The simulations showed great improvement in the estimate of the position after the modification had been implemented.

5.2

FUture Work

The work done in this research can be extended in many ways. The simulation results shows that the TDOA technique is eligible for the PL solution. The correction algorithms largely depend on the statistical parameters, configured at different environmental conditions. Another avenue of progress may be the study of different ways of combining information when more than one position location method is used to locate the mobile units such as the combination of AOA and TDOA methods. It is of importance in such hybrid systems that the overall PL solution should be able to combine the results from both methods in such a way that the inaccuracies in the results from both the methods should not add to each other, thus adversely affecting the overall PL solution. The resultant PL fix from the combination should be more accurate than the one obtained from either of the two solutions. Apart from the study of the TDOA method itself, research can also be directed towards some related technical issues. There may be some situations when only one base station is able to receive the signal from the 911 mobile. Such a situation may occur in rural or suburban areas where extensive coverage is not needed. One of the solutions proposed for such situations is to use a combination of AOA and TOA methods. However, if putting antenna arrays is not desirable in such cases, then one way to use TDOA method may

67 be the use of receivers in the cell just for the purpose of taking signal snap shots. For

the TDOA methods, at least two additional receivers will be needed in addition to the base station receiver itself. A similar technical issue that can be explored is the effect of additional position location data on the data lines between the base stations and switching center. If the position location process is to be executed only for 911 calls, then the additional traffic may not be significant. However, if the position location is performed more often, then the load on the data lines may become significant. Implementing the proposed technique in the real world seems to be a promising possibility. However, a number of issues need to be addressed.

5.2.1

Network Layers

Although the new techniques do not require a great deal of data exchange among nodes, nor do they require communication that needs more than one hop, a study needs to determine the best communication protocols in the physical and Network layers.

5.2.2

Embedded systems design

The new localization algorithms are currently implemented in MATLAB. The next step is to convert the MATLAB codes to C in order to facilitate the use of these techniques in embedded systems.

Appendix A List of Abbreviations and Symbols.
Symbol Meaning Inertial Navigation System National Marine Electronics Association Latitude Longitudes Line-of-sight Non-Line-of-sight Angle-of-arrival Constrained Weighted Least Squares Nonlinear Least Squares Received signal strength Time-of-arrival Time-difference-of-arrival Enhanced 0 bserved Time Difference Observed Time Difference of Arrival Global System for Mobile Communications Radio frequency Mobile terminal Base station

INS

NMEA
lat long

LOS NLOS

AOA
CWLS NLS RSS

TOA TDOA E-OTD OTDOA
GSM

RF

MT
BS

68

69

PL

Position location Transpose of matrix A Inverse of matrix A Element-by-element multiplication Universal Mobile Telecommunications System Wireless Local Area Network

AT
A-1

0
UMTS

WLAN

Bibliography
[1) D. Bouvet and G. Garcia, "Improving the accuracy of dynamic localization systems using GPS by identifying the gps latency", In Proceedings of the IEEE, International Conference on Robotics and Automation, April 2000. [2) W. W. Kao, "Integration of GPS and dead-reckoning navigation systems", In Proc. Vehicle Navigation and Information Systems Conference, 1991, pages 635-643. [3) P.Misra and P.Enge, "Global Positioning System (Signals, Measurements and Performance)". Ganga-Jamuna Press, 2006, pages 10-15. [4) R.Sharaf, Aboelmagd Noureldin, Ahmed Osman and Naser El-Sheimy, "Online INS/GPS integration with a radial basis function neural network", IEEE A&E Systems Magazine, March 2005. [5) S.Rezaei and R.Sengupta, "Kalman filter based integration of DGPS and vehicle sensors for localization", In Proceedings of the IEEE, International Conference on Mechatronics and Automation, Niagara Falls, Canada, July 2005. [6) http:/ /www.trimble.com/gps/whygps.shtml. [7) Jr. James, J. Caffery and Gordon L. Staber, "Overview of radiolocation in cdma cellular systems", IEEE Communications Magazine, April 1998, vol.36, no.5, pages 38-45. [8) Theodore S. Rappaport, "Wireless communications. Principles and practice", Prentice Hall PTR, 2002.

70

71 [9] N. Ackroyd and R. Lorimer, "Global Navigation: A GPS User's Guide", Lloyd's of London Press Ltd.,1990, London. [10] GPS-18x, "Technical Specifications", Garmin International, 1200E. 151 Street, Olathe, USA, 2008. [11] J. Kennewell, "Great Circle distances and bearings", IPS Radio & Space Services, Sydney, 1997, Australia. [12] M.P. Wylie and J. Holtzman, "The non-line of sight problem in mobile location estimation", In Universal Personal Communications IEEE International Conference, 1996, vol.2, pages 827-831. [13] A. Pages-Zamora, J. Vidal and D. R. Brooks, "Closed-form solution for positioning based on angle of arrival measurements", 13th IEEE International Symposium on Personal, Indoor and Mobile Radio Communications, 2002, vol.4, pages 1522-1526. [14] S. Bancroft, "An Algebraic Solution of the GPS Equations", IEEE Transaction on Aerospace and Electronic Systems, January 1985, vol. AES-21, pages 56-59. [15] E. Hepsaydir and W. Yates, "Performance Analysis of Positioning Using Existing CDMA System", IEEE Position Location and Navigation Systems, 1994, pages 190192. [16] M.Aatique, G.A. Mizusawa and B.D. Woerner, "Performance of Hyperbolic Position Location Techniques in Code Division Multiple Access", IEEE Transaction on Wireless Communication, 1997, vol.2,pages 543-562. [17] Qi. Honghui and J. B. Moore, "Direct kalman filtering approach for gps/ins integration", IEEE Transactions on Aerospace and Electronic Systems, 2002, no.38, vol.2, pages 687693. [18] J. J. Caffery and G. L. Stuber, "Subscriber location in CDMA cellular networks", IEEE Transaction on Vehicle transportation, 1998, vol.47, no. 2, pages 406-416.

72 [19] Y. Zhao, "Mobile phone location determination and its impact on intelligent transportation systems", IEEE Transactions on Intelligent Transportation Systems, 2000, vol.1, no.1, pages 55-64. [20] B. L. Le, K. Ahmed and H. Tsuji, "Mobile location estimator with NLOS mitigation using Kalman filtering", In Proc.IEEE Wireless Communication and Networking, 2003, vol. 3, pages 16-20. [21] G. W. Elko, Y. Huang, J. Benesty and R. M. Mersereati, "Realtime passive source localization: a practical linear-correction least-squares approach" , IEEE Transactions on Speech and Audio Processing, 2001, vol.9, no.8, pages 943-956. [22] H. C. So and S. P. Hui, "Constrained location algorithm using TDOA measurements", IEICE Transactions on Fundamentals of Electronics, Communications and Computer Sciences, 2003, vol.E86-A, no.12, pages 3291-3293. [23] A. F. Molisch, "Channel models for ultrawideband personal area networks", IEEE Transactions on Wireless Communication, 2003, vol.10, no.6, pages 14-21. [24] Y. T. Chan and K. C. Ho, "A simple and efficient estimator for hyperbolic location", IEEE Transactions on Signal Processing, 1994, vol.35, no.8, pages 1905-1915. [25] M. Hellebrandt and R. Mathar, "Location tracking of mobiles in cellular radio networks", IEEE Transactions on Vehicle Technology, 1999, vol.48, pages 1558-1562. [26] M. Najar and J. Vidal, "Kalman tracking based on TDOA for UMTS mobile", IEEE International Symp. Personal, indoor and Mobile Radio Communication, 2001, vol.1, pages 45-49. [27] J. 0. Smith and J. S. Abel, "Closed-form least-squares source location estimation from range-difference measurements" , IEEE Transactions on Acoustics, Speech and Signal Processing, 1987, vol.35, no.12, pages 1661-1669.

73 [28] H. B. Lee, "Accuracy Limitations of Hyperbolic Multilateration Systems", IEEE Transaction on Aerospace and Electronic Systems, January 1975, vol. AES-114, no. 1, pages 16-29. [29] Y. T. Chan and K. C. Ho, "A Simple and Efficient Estimator For Hyperbolic Location", IEEE Transactions on Signal Processing, August 1994, vol. 42, no. 8, pages 1905-1915. [30] J. Rankin, "An error model for sensor simulation GPS and differential GPS", Position Location and Navigation Symposium, 1994, vol.11, no.15, pages 260-266. [31] M.E. Cannon and G. LaChapelle, "Analysis of a high-performance c/a-code GPS receiver in kinematic mode", Journal of the Institute of Navigation, 1992, vol.39, no.3, pages 285-300. [32] S. Nousiainen, K. Kordybach, S. Ahonen, T.Lahti and I. Mura, "Resource and mobility management in multi-system environment", CAUTION-WP-VTT-D21-003-Int. Technical report, Caution Consortium, 2003. [33] http:/ /www.kolumbus.fi/ eino. uikkanen/ geodocs/kkjgps.htm. [34] http:/ /www.navcen. uscg.gov / gps/ geninfo.htm. [35] http:/ /www.esa.int/esaNA/galileo.html. [36] http:/ /www.glonass-center.ru. [37] T. Nypan, K. Gade and 0. Hallingstad, "Vehicle positioning by database comparison using the Box-Cox metric and Kalman filtering", VTC 2002, Birmingham, USA, pages 6-9. [38] T. Nypan and 0. Hallingstad, "A cellular positioning system based on database comparison · The hidden Markov model based estimator versus the Kalman filter", 2002, Norway, pages 4-7.

