NOTE TO USERS

This reproduction is the best copy available.

UMI
R e p r o d u c e d with p e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u rth e r r e p r o d u c ti o n p ro h ib ite d w ithout p e r m i s s io n .

R e p r o d u c e d with p e r m i s s io n of th e c o p y rig h t o w n e r . F u rth e r re p ro d u c tio n pro hibited w ith o u t p e r m is s io n .

Extended Kalman Filter Application in Permanent Magnet Synchronous Motor Sensorless Control
by

Ming Qiu

A thesis presented to Ryerson University in partial fulfillment of the requirement for the degree of Master of Applied Science in the Program of Electrical and Computer Engineering

Toronto, Ontario, Canada, 2003 ©(Ming Qiu) August 2003

R e p ro d u c e d with p e r m is s io n of t h e co pyright o w n e r. F urther r e p ro d u ctio n prohibited w ithout p e rm is s io n .

UMI Number; EC52948

INFORMATION TO USERS

The quality of this reproduction is dependent upon the quality of the copy submitted. Broken or indistinct print, colored or poor quality illustrations and photographs, print bleed-through, substandard margins, and improper alignment can adversely affect reproduction. In the unlikely event that the author did not send a complete manuscript and there are missing pages, these will be noted. Also, if unauthorized copyright material had to be removed, a note will indicate the deletion.

UMI
UMI Microform EC52948 Copyright 2008 by ProQuest LLC. All rights reserved. This microform edition is protected against unauthorized copying under Title 17, United States Code. ProQuest LLC 789 E. Eisenhower Parkway PC Box 1346 Ann Arbor, Ml 48106-1346

R e p r o d u c e d with p e rm is s io n of t h e co pyright o w n er. F u rth e r re pro duction prohibited without p e rm issio n .

Borrower's Page

R e p r o d u c e d with p e r m i s s io n of t h e cop y rig h t o w n er. F u rth e r rep ro d u ctio n prohib ited w ithout p e rm is s io n .

Thesis Title: Degree: Year: Author: Department: University:

EKF Application in PMSM Sensorless Control Master of Applied Science 2003 Ming Qiu Electrical and Computer Engineering Ryerson University, Canada

Abstract
This thesis presents the modeling, analysis, design and experimental validation of a robi sensorless conti'ol method for permanent magnet synchronous motor (PMSM) based ^ Extended Kalman Filter (EKF) to accurately estimate speed and rotor position.

Currently, there is no robust position/speed sensorless control method available for t permanent magnet synchronous motor (PMSM) in the published literature. Traditional commercial off-the-shelf simulation models for PMSM do not incorporate initial rol position and simplified steady-state based modeling of the associated power electroi circuitry and controls are used. These limitations have prevented the development a application of a robust real-time sensorless control method with good dynan performance over the full speed range for the PMSM.

The Main focus of this thesis is to overcome these limitations. In particular, a detail real-time PMSM model in MATLAB/Simulink simulation environment is develop which is used to validate the EKF sensorless control method by varying the mil

IV

R e p r o d u c e d with p e r m i s s io n of t h e co p yrig ht ow ner. F u rth e r r e p ro d u ctio n prohibited w ithout p e rm is s io n .

position of the rotor. The proposed position/speed sensorless control based on EKF method along with all the power electronic circuitry are modeled in this simulation environment. This user-friendly simulation and rapid-prototyping platform is then effectively used to predict, analyse, fine-tune and validate proper operation of the proposed EKF sensorless contiol method for all operating conditions. In particular, different control strategies are reviewed and the performance of the proposed EKF sensorless control method is critically assessed and validated for different types of dynamic and static torque loads. The robustness of the proposed EKF sensorless method is demonstrated by validating proper operation of the closed-loop motor control system for different rotor initial positions and insensitivity of the EKF speed/position estimation method to the PMSM parameter variations. Proper operation of the proposed EKF based sensorless control method for a high speed permanent magnet synclironous machine is verified experimentally in the lab at Honeywell.

R e p r o d u c e d with p e r m is s io n of t h e co p yrig ht o w n e r. F u rth e r re p ro d u c tio n proh ibited w ithout p e rm issio n .

Acknowledgements
The author wishes to express his sincere gratitude and appreciation to his academic supei"visor Professor Bin Wu and industrial supervisor Dr. Hassan. A. Kojori for their invaluable guidance, advice and financial support throughout the preparation of this thesis.

The author would also like to thank Mr. George Zhou, Mrs. Zheng Wang for the useful discussions, suggestions and helps. Thanks are extended to Dr. David Xu, Dr. Samuel Wei and thé fellow graduate students for many useful discussions.

The Program Scholarship and teaching assistantship from Ryerson University, researching assistantship from Professor Bin Wu, Ontario Graduate Scholarship (It was declined after author won the MJVIO IPM scholarship) from Ontario Ministry of Training, Colleges and Universities, Industrial Practice Master (IPM) Scholarship from Materials and Manufacturing Ontario (MMO), and income support from Honeywell Aerospace, Toronto, are gratefully acknowledged.

Special thanks are due to author's wife ling, for her understanding, encouragement and support.

R e p r o d u c e d with p e r m i s s io n of t h e copy rig ht ow ner. F u rth e r re p ro d u c tio n prohibited w ithout p e r m is s io n .

Table of Contents
Abstract Acknowledgements Table of Contents

Chapter 1: Introduction.................................................................. i
1.1 1.2 1.3 1.4 Technical Background for the Control of PMSM................................................... 2 Existing Challenges for Sensorless Control of the PMSM..................................... 9 Thesis Objectives...................................................................................................... 11 Outline of the Thesis................................................................................................. 12

Chapter 2: Modeling of PMSM EKF Sensorless Control
................................................................................................................................. 15

2.1 2.2 2.3 2.4 2.5 2.6 2.7 2.8

The Discrete Kalman Filter........................................................................................ 16 The Extended Kalman Filter (EKF).......................................................................... 20 Frame Transformation.................................................................................................24 Modeling of PMSM....................................................................................................28 Control Algorithms of PMSM................................................................................... 30 Siniulink Diagrams for PMSM Control.................................................................... 35 Modeling of EKF Estimator for PMSM Speed Contiol...........................................39 PMSM EKF Sensorless Control.................................................................................44

R e p r o d u c e d with p e r m i s s io n of t h e c o p y rig h t o w n e r . F u rth e r re p ro d u c tio n proh ibited w ithout p e r m is s io n .

2.9

Conclusions................................................................................................................ 50

Chapter 3: Computer Simulation and Analysis.......................... 53
3.1 Drive System Performance with Varions Loads..................................................... 54 3.1.1 3.1.2 3.1.3 3.1.4 3.2 Fan/PumpLoad.................................................................................................. 54 Linear Load.......................................................................................................... 58 Constant Torque Load..........................................................................................60 Summary............................................................................................................. 60

Robustness to Motor Parameter Variations............................................................ 62 3.2.1 Changes in State Winding Resistance................................................................ 62

3.2.2 Changes in Rotor Flux-linkage...........................................................................64 3.2.3 3.2.4 3.3 Elimination of the Flux-LinkageCorrector........................................................ 69 Summary.............................................................................................................. 71

Startup Transient........................................................................................................ 72 3.3.1 3.3.2 3.3.3 3.3.4 Startup at Different Positions............................................................................72 Cancellation of Divergence Corrector............................................................. 73 Removal of the Startup Current Pulse Injection............................................. 76 Summary.............................................................................................................. 77

3.4 Conclusions......................................................................................................................78

Chapter 4: Experimental Verification ....................................................... 79
4.1 4.2 Hardware Implementation......................................................................................... 80 Software for Real-time Implementation................................................................... 82

V lll

R e p r o d u c e d with p e r m i s s io n of t h e c o p y rig h t o w n e r. F u rth e r r e p ro d u c tio n p rohibited w ith out p e r m i s s io n .

4.3

Experimental Results.................................................................................................. 86 4.3.1 4.3.2 4.3.3 Accuracy Test........................................................................................................86 Robustness Test.....................................................................................................89 Startup Transient.................................................................................................. 92

4.4

Conclusions................................................................................................................. 95

Chapter 5; Conclusions.................................................................... 97

References............................................................................................loi Appendix A ......................................................................................................................105 Appendix B ........................................................................ in

Appendix C..........................................................................................ii? Appendix D ..........................................................................................123 Appendix E .......................................................................................... 129

R e p r o d u c e d with p e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u rth e r r e p r o d u c ti o n p ro h ib ite d w ith o u t p e r m i s s io n .

Chapter 1

Introduction
This thesis presents the modeling, analysis, design and experimental validation of a robust sesorless control method for permanent magnet synchronous motor (PMSM) based on Extended Kalman Filter (EKF) to accurately estimate speed and rotor position.

The permanent magnet synchronous motor is an ideal candidate for high-performance industrial drives since it features simple structure, high energy efficiency, reliable operation and high power density. In most PMSM drive systems on the market, closed-loop control is based on the measurement of motor speed or position by using a shaft sensor such as optical encoder. Hall effect sensor or resolver. The use of such sensors will increase the complexity and weight of the system, significantly increase cost and reduce the overall reliability of the controlled drive system. In some applications, due to harsh operating environments or excessive wire lengths, it is either impossible or impractical to bring the actual sensed speed/position signals from the load to the controller. Speed/position sensorless control of motor drive systems significantly reduces the system complexity, weight and cost and improves the overall system reliability and dynamic performance. These significant benefits have prompted the research and technology development of robust speed/position senseless control schemes for the PMSM and other types of motor controlled drive systems such as induction motors [1, 2], brushless DC motors [3, 4] and switched reluctance motors [5, 6].

In Section 1.1, the published literature and state-of-the-art for sensorless control of the

R e p r o d u c e d with p e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u r th e r r e p r o d u c ti o n p r o h ib ite d w ith o u t p e r m i s s io n .

permanent magnet synchronous machine will be critically reviewed, and it will be shown that currently there is no robust position/speed sensorless control method available for the PMSM. Both control schemes with and without sensors are briefly discussed, and their advantages, disadvantages and existing limitations are critically reviewed and assessed. Section 1.2 provides a summary of these limitations and problems associated with the existing sensorless control methods for the PMSM, Section 1.3 presents the main objectives of the thesis, and Section 1.4 provides a brief outline of the thesis.

1.1 Technical Background for the Control of PMSM
Many different control algorithms have been studied and reported in the literature for the speed and torque control of the PMSM [7-10, 14-28]. In the conventional PMSM drive systems, speed and torque control is achieved by obtaining the rotor position or speed information through shaft sensors such as optical encoders, Hall-Effect sensors or resolvers. Figure 1-1 shows a typical block diagram of a PMSM controlled drive system with a shaft sensor. In controlled drive systems, terminal variables of the motor, such as .voltages and currents, are time-varying. To acquire an effective control, standard frame transformations (e.g., abc-io-dq) of the motor electrical variables and parameters are used to convert the time-varying system into a time-invariant one. In Figure 1-1, the controlled system generates a current reference from the difference between the speed reference and the measured speed. The two projected components of the reference current on d and q axis, called 1(1* and /^*, are compai*ed to the dq components of the measured three-phase currents, respectively. The errors between them produce the control variables Vd and Vq. These

R e p r o d u c e d with p e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u rth e r r e p r o d u c tio n p ro h ib ite d w ithout p e r m i s s io n .

control components are transformed back into the stator (abc) frame, using a dq-to-abc frame transformation, to obtain a three-phase voltage reference values wlrich is then fed to the PWM Generator that produces the Pulse. Width Modulating (PWM) signals for the Inverter. Finally, the output voltages of the tliree-phase inverter are apj)lied to drive the PMSM.

Figure 1-2 presents a typical block diagram of a sensorless PMSM. The main difference between the controls wiür and without the shaft sensor is that in the sensorless method, a Speed and Position Estimation block is used instead of the shaft sensor to obtain the position and speed information. Hence the shaft sensor of the PMSM is eliminated. In the sensorless control procedure, the estimated information is calculated from the terminal voltages and currents. The estimated speed is used for speed control. The estimated position is applied in transforming the measured currents from the abc frame to the dq frame to obtain control components and converting the control voltages from the dq frame back to the abc frame to drive the motor.

Three estimation methods for the Speed, and Position Estimation block have been reported in the literature. These are briefly discussed and their technical problems/limitations are assessed and summarized below:

M ethod 1; The rotor position information is determined by directly measuring the motor terminal voltages and line currents with the aim of estimating the flux-linkages [7]. Figure 1-3 shows the diagram of this method inside the Speed and Position Estimation block in Figure 1-2. Two current loops are utilized in this algorithm. The outer current loop is used to correct the initial estimated position. The inner current loop corrects and updates the flux-linkage using the latest predicted rotor position. At each time step, based on the previous predicted position and flux-linkage, the motor line current is estimated for the

R e p r o d u c e d with p e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u r th e r r e p r o d u c ti o n p ro h ib ite d w ith o u t p e r m i s s io n .

DC Supply

inverter

PMSM

Speed Reference

S peed Controller PI
Current Function

PWM Generator

Sensor

Frame Transformation d-q to a-b-c

Actual Position

Frame T ransformation a-b-c to d-q

A 9 /A t
Actual Speed

Figure 1-1. PMSM control with shaft sensor.

DC Supply

inverter

PMSM

Speed Reference

S p eed Controller

PWM Generator

Sensor

Current Function

Frame Transformation d-q to a-b-c

Speed and Position Estimation Estimated Position

Frame Transformation a-b-c to d-q

Estimated Speed

Figure 1-2. PMSM control without shaft sensor.

R e p r o d u c e d with p e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u rth e r r e p r o d u c tio n p ro h ib ite d w ith o u t p e r m i s s io n .

3 -p h a se currents

3 -p h a se voltages

AI
Current estim ation Position correction and position estim ation & prediction Current estimation Flux linkage correction

(fc -i)

(t)

- H I

Integrator

Footnotes:
Estim ated Rotor Position Estimated Rotor S p e e d

e: Estimation m: Measurement (k): Calculating step

Figure 1-3. Block diagram of the position/speed estimation with the aim of estimating the flux-linkage.

R e p r o d u c e d w ith p e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u rth e r re p r o d u c tio n pro h ib ite d w ith o u t p e r m i s s io n .

outer loop control. The error between the measured current and the estimated outer loop current is used to predict the present position, which provides the required position and speed information for the sensorless control. At the same time, using this predicted present position and the previous flux-linkage, the line current is estimated for inner loop control. From the error between the measured line current and the estimated inner loop current, the variation of the flux-linkage is acquired. This information is then used to correct the flux-linkage and is furtlier used to predict the rotor position for the next time step. Although this algorithm can be applied for both Brushless DC Motors (BLDCM) and the PMSM, the performance of this algorithm depends on the quality and accuracy of the estimated flux-linkages and measured values of machine voltages and currents. System harmonics and noise, machine parameter variations due to the temperatme changes and magnetic saturation will significantly influence the accuracy of the rotor position estimation and may degrade the performance of the machine.

M ethod 2: Observer-based methods for control of different systems have been reported in literature [8-10, 13]. The state observer is a mathematical model that is lunning in parallel to the actual system and provides the estimation of the system state vectors, including the rotor position and speed, by on-line calculations [Appendix A]. Hence the PMSM rotor position information can be estimated through a state observer [8-10]. Figure 1-4 shows the block diagram of a Luenberger observer. The Input u of the system is the control vector, the Output y is the measurement vector and the State x is the state vector. Position and speed are included in state vector. The estimated information is applied to realize the sensorless control. The output of the Luenberger state observer is defined as a combination of different states, and this output is compared with the equivalent measured output of the actual motor. Any error between them is used to correct the state trajectory of the observer. However, the stability of the observer is important in providing accurate position information. Loss of the observer stability would cause erratic and destructive motor

R e p ro d u c e d with p e r m is s io n of t h e co pyright o w n er. F u rth e r r e p ro d u ctio n prohib ited w ithout p e rm issio n .

·" 1

System (not m easurable) input

u

X = Ax + Bu

O utput

Luenberger observer with

x.

State

> 

Figure 1-4. Structure of the Luenberger observer.

r'
System ( not m easurable) Input

u

X= Ax + Bu

Output

S tate Kalman filter

.J

Figure 1-5. Structure of the Kalman filter estimator.

R e p r o d u c e d with p e r m is s io n of t h e cop y rig h t ow ner. F urther rep ro d u ctio n prohibited w ithout p e rm issio n

operation. In order to keep the controlled system stable, the gain in the observer has to be optimized. Determination of the optimum gain of the observer under all operating conditions will lead to practical difficulties and limitations. Moreover, initial states are required for proper convergence of the observer. Due to these shortcomings, the state observer method has not been widely accepted and applied for the sensorless conh'ol of the PMSM.

Method 3: The Extended Kalman Filter (EKF) is reported [11-21] and used to perform state observer based control of the PMSM that is a nonlinear controlled drive system. Figure 1-5 shows the block diagram of an FKF estimator. A mathematical model describing the PMSM motor dynamics is derived and the rotor position is determined by directly measuring the terminal voltages and currents of the PMSM. Since the controlled system is time-varying and nonlinear, the measured voltages and currents are transformed into time-invariant components and the nonlinear system is linearized around the present operating point. The unknown state vaiiables (rotor speed and position) are estimated through the FKF method. Studies on estimating rotor position and speed of the PMSM by the FKF algorithm have been reported [14-21]. However, practical implementation of this method has not been reported due to the following limitations; · · Formulation of the FKF model in closed form not available, A detailed dynamic model for the PMSM including initial rotor position not available, · Discrete time not available, · Initial speed/position convergence problems reported and complex methods for correcting the initial flux required for proper operation to prevent stability problems, and · To overcome stall condition at start-up, a current pulse injection required at the odel of the overall controlled system and details of implementation

R e p r o d u c e d with p e r m is s io n of t h e co pyright o w n e r. F u rth e r r e p ro d u ctio n prohibited w ithout p e rm issio n .

beginning.

1.2 Existing Challenges for Sensorless Control of the PMSM
A critical review and assessment of existing speed/position sensorless control methods for the PMSM was presented in Section 1.1. In smnmary, the presently available sensorless methods for tlie PMSM suffer from one or more of the following problems or limitations: · Direct terminal voltage/current and/or frequency measurement require complex filtering which makes the implementation complex and difficult to tune [7]. · Sensorless conhol metliod not robust due to the fact that significant speed/position error is caused by machine parameter variations such as temperature, rotor magnet strength and saturation [8, 9]. · Due to the inaccuracy of position/speed and consequently flux estimation at start-up and low speeds, some form of open loop operation is commonly required for an extended period of time initially to either establish speed/back EMF or align the rotor position [22]. ® Some observer-based methods use fairly complex math and matrix algebra and their implementation requires advanced digital signal processors with exhemely high throughputs that are not practical [23, 24]. · High frequency injection methods are not practical and consequently not applicable at high speed PMSM operation [25]. · Due to inherent inaccuracies in the estimation of tire speed/position information, most of the existing methods would require a very liigh sampling rate and consequently a high switching frequency for the controlled power electronic devices.

R e p r o d u c e d with p e r m is s io n of t h e co pyright ow ner. F u rth e r rep ro d u ctio n prohibited w ithout p e rm issio n .

Tliis significantly increases the thermal management requirements of all the power-pass components (i.e., IGBTs, filters, DC link capacitors, etc.) and adds to the overall system weight and cost and adversely impacts reliability.

The above summary of the published literature and assessment of their limitations reveal that currently there is no robust position/seed sensorless control method readily available for the permanent magnet synchi'onous machine. Furthermore, most studies are only experimental. Conmiercial off-the-shelf simulation models for the PMSM (such as MATLAB/Simulink), which have recently become available, do not incorporate initial rotor position and simplified steady-state based modeling of the associated powerelectronic circuitry and controls are used. These limitations have prevented the development and application of a robust real-time sensorless control method with good dynamic performance over the full speed range for the PMSM

Even though the Extended Kalman Filter (EKF) is reported [14-21] and used to perform state observer based control of the PMSM drive system, practical implementation has not been reported due to the following technical problems or limitations: · · Formulation of the EKF model in closed form not available. A detailed dynamic model for the PMSM including initial rotor position not available. · Discrete time model of the overall controlled system and details of power electronics circuitry and implementation not available. · Initial speed/position convergence problems reported and complex methods for correcting the initial flux required for proper operation to prevent stability problems. · To overcome stall condition at start-up, a current pulse injection algorithm is required which needs significant time to adjust and verify for different types of loads and different machines with varying parameters.

1 0

R e p r o d u c e d with p e r m is s io n of th e co p y rig h t o w n e r. F u rth e r r e p ro d u ctio n prohibited w ithout p e rm issio n .

Proper performance and robustness of the reported EKF metlrod not studied for all operation conditions and different types of loads.

1.3 Thesis Objectives

Due to the technical problems or limitations presented in section 1.2, the main focus of the present thesis is to solve the existing problems and overcome the present limitations so as to develop a robust sensorless control method for the full speed range operation of the PMSM. The main objectives of the thesis are to; · Develop a detailed real-time PMSM model in MATLAB/Simulink simulation environment that can be used to validate the EKF sensorless control method by varying the initial position of the rotor. · Develop and formulate a user-friendly and robust EKF model in closed-form with the main objective of achieving fast simulations for tuning the parameters and validating proper operation of the EKF-based sensorless method. · Model the PMSM position/speed sensorless control based on EKF method along with all the power electronic circuitry in an integrated srmulation environment that can be effectively used to jv'edict, analyze, fine-tune and validate proper operation of the proposed method for all operatirrg conditions. · Validate the performance of the proposed EKF sensorless control method for different types of dynamic and static torque loads by simulation. · Demonstrate the robustness of the proposed EKF sensorless control method to the PMSM elechical parameter variations by simulation.

1 1

R e p r o d u c e d with p e r m i s s io n of t h e co py rig ht o w n er. F u rth e r re p ro d u c tio n proh ibited w ithout p e r m is s io n .

·

Verify the proper operation of the proposed closed-loop sensorless control system for different rotor initial positions by simulation.

·

Experimentally verify selected predicted results obtained by simulation for certain operating conditions that can practically be tested on the actual system prototype in the laboratory.

1.4 Outline of the Thesis
This thesis consists of five chapters. A critical review and assessment of the literature and advantages and limitations of the existing PMSM control methods, along with the objectives of the thesis are presented in the first chapter.

Chapter 2 presents the details of the theoretical background and formulation of the discrete Kalman filter and EKF theory. A detailed real-time PMSM model in MATLAB/Simulink simulation environment is developed in which the user can arbitrarily set the rotor initial position. An integrated Simulink-based EKF model for the PMSM along with all the power electronic circuitry modeled in the same simulation environment is developed to effectively predict, analyze, fine-tune and validate proper operation of the proposed EKF sensorless metiiod for aU operating conditions.

Chapter 3 presents the predicted results obtained through computer simulations of the proposed PMSM EKF sensorless control. Proper operation for different rotor initial positions and different types of dynamic and static torque loads are presented. The robustness of the control method is assessed and confirmed by studying the effect of

I 2

R e p r o d u c e d with p e r m i s s io n of t h e c o p y rig h t o w n e r. F u rth e r r e p ro d u ctio n prohibited w ithout p e r m is s io n .

variations in electric parameters of the PMSM. In particular, this chapter presents practical control techniques which eliminate the traditional complex methods for correcting the flux variation requhed for proper operation of the PMSM controlled drive system. It will be shown that the proposed EKF-based control method can effectively prevent stability problems by correctly predicting tlie initial speed/position. Traditional convergence problems are eliminated and there is no need for a current pulse injection at the beginning of start-up to avoid stall condition.

Chapter 4 presents the experimental verification of selected predicted results that were obtained through computer simulations from Chapter 3. The experimental set-up configuration (both hardware and software platform) is described in detail. The details of the dSPACE integrated hardware/software environment that is used for the implementation of the proposed EKF sensorless control method is presented. This experimental set-up is used to obtain and verify selected predicted results obtained by computer simulations, for certain operating points where practical.

Chapter 5 summarizes the conclusions and the future research recommendations.

1 3

R en ro d u ced with oerm ission o f th e coDvrlaht ow ner. Further reproduction prohibited without p erm ission .

''"' I

R e p r o d u c e d with p e r m i s s io n of t h e c o p y r ig h t o w n e r . F u rth e r r e p r o d u c tio n p ro h ib ite d w ith o u t p e r m i s s io n .

Chapter 2

M odeling of PM SM EKF Sensorless Control
This chapter presents the detailed modeling and formulation of permanent magnet synchronous motor (PMSM) drive without using speed or position sensors. The theoretical background on the extended Kalman filter (EKF) for rotor speed and position estimation is introduced. A dynamic model for the PMSM with the ability of presetting the initial rotor position is developed. Three control strategies for the PMSM are discussed, and the most promising one is identified. Finally, a Simulink based multi-tasking control diagram for the sensorless PMSM drive system is developed.

The contents of this chapter are aixanged as follows: Section 2.1 presents the basics of the discrete Kalman filter. Section 2.2 provides the fundamentals of the extended Kalman filter. Section 2.3 introduces the reference frame hansformations. Section 2.4 presents the PMSM simulation model. Section 2.5 focuses on PMSM control algorithms. Section 2.6 designs the Simulink diagrams for the PMSM control with sensors. Section 2.7 deals with modeling of EKF algorithm for PMSM speed control. Section 2.8 designs the Simulink diagrams for the PMSM EKF sensorless control, and Section 2.9 concludes Chapter 2.

1 5

R e p r o d u c e d with p e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u r th e r r e p r o d u c ti o n p ro h ib ite d w ith o u t p e r m is s io n .

2.1

The Discrete Kalman Filter

In this section, the basics of the discrete Kalman filter are introduced. In 1960, R.E. Kalman published his famous paper describing a recursive solution to the discrete linear filtering problem. However, the applications of this method in real-time motor control were limited by the computing speed of the controller due to its complex matrix calculations till a decade ago. Due to the advances of digital computing technique, Kalman filter has been researched in motor control area in recent years.

The Kalman filter presents the general problem of hying to estimate the states x e R" of a discrete-time controlled process that is dominated by the linear stochastic difference equation:
Xj.
-- -l-

Biij^

"f ^ 4 - 1

>

(^ - 1 )

with a measurement y e i?" ,

where

cr^_j and

are noise matrices,

A, B and H are relation matrices, and is the control vector. The random variables and represent the process (system) and measurement

noise, which are assumed to be independent, white and with normal probability distributions. The covariance matrices of these noises are defined as: Q= oH , (2.3) (2.4)

R = E[p- p^].

The above noise covariance matrices might change with each time step or measurement.

1 6

R e p r o d u c e d with p e r m i s s io n of t h e c o p y r ig h t o w n e r . F u rth e r r e p r o d u c tio n pro h ib ite d w ith o u t p e r m i s s io n .

However, considc i- ^ the noises of the actual motor control systems are continuous, independent and white Gaussian ones with unchanged distributions, Q and R are assumed to be constant in this thesis.

The 77.x 7 1 matrix A in the equation (2.1) relates the state at the previous time step k-l to the state at the current step k, in the absence of either a contiol function ( noise (cr^_i). The n~xl matrix B relates the control input
ug

) or process

to the state x. The

777X 77 matrix I I in the measurement equation (2.2) describes the relationships between the state x and the measurement y^.

Define

to be a priori state estimation at step k given knowledge of the process prior to be a posteriori state estimation at step k given lueasurement .

to step k, and

Then the estimation errors of a priori and a posteriori are defined as: (2.5)

(Z6)
Thus the covariances of the priori and posteriori estimation errors are: =
==7STg*. g*''].

C2/7)
C2.8)

Equation (2.9) computes a posteriori state estimate

as a linear combination of a priori and a

estimate x^ and a weighted difference between an actual measurement measurement prediction i î x j , jC t = x ; + iE; (]/* -- rCfx,:).

C2.9)

1 7

R e p r o d u c e d with p e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u rth e r r e p r o d u c ti o n p ro h ib ite d w ith o u t p e r m i s s io n .

The difference (y^

x /) in (2.9) is named as the measurement innovation, or the and the

residual. It reflects tiiv discrepancy between the predicted measurement actual measurement %.

The nxr n matrix Kk in (2.9) is chosen to be the gain that minimizes the posteriori error covariance (2.8). To realize the minimization, we can 1) substitute (2.9) into the equation (2.6), 2) substitute the above result into (2.8) to perform the indicated expectations, 3) take the derivative of the trace of the result with respect to Kk, and 4) set that result equal to zero, and then solve the equation for Kk-

The solutions to the Kalman filter are given as follows. Detailed mathematics derivations can be found in reference [29,30]. The solution equations can be divided into two groups: 1) time update equations, which use the current state and error covariance estimations to obtain t'ue priori estimations for the next time step.

x l - Axi._^+Bu^ ,
= = .

(2.10) (2.11)

2) measurement update equations, which incorporate a new measurement into the priori estimations to obtain improved posteriori estimations. K, = + i?)-` , (2.12)

2* = =a; -H artj,* iyjc;),
= (.f where I is the unity matrix.

(2T3)
(2.14)

,

R e p r o d u c e d w ith p e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u rth e r r e p r o d u c ti o n pro h ib ite d w ith o u t p e r m i s s io n .

k=k+1

Tim e U pdate (Predict)

M easu rem en t U pdate (Correct)

Figure 2-1. The discrete Kalman filter computing cycle.

initial estim a tes 4 and
k= k+ 1

Tim e U pdate (Predict)
(1) Project the state ah ead

(2) Project the error covariance ah ead

M easurem ent U pdate (Correct)
(1) Com pute the Kalman gain

K, =

+R)-^

(2) Update estim ate with m easu rem en t

(3) Update the error covariance

Figure 2-2. A complete picture of the Kalman filter operation.

1 9

R e p r o d u c e d w ith p e r m i s s io n of t h e c o p y r ig h t o w n e r . F u rth e r re p r o d u c tio n p ro h ib ite d w ith o u t p e r m i s s io n .

Figure 2-1 shows the discrete Kalman filter computing cycle. The time update equations serve as a predictor, and the measurement update equations work as a corrector. The process shows tire recursive feature of the Kalman filter. Figure 2-2 offers a complete pictme of the operation of the filter with its calculation equations.

2.2

The Extended Kalman Filter (EKF)

The Kalman filter described in the previous section solves the general problem of estimating the state x e R" of a discrete-time process that is expressed by a linear stochastic difference equation. However, in actual applications, the processes to be estimated aie usually non-linear. An extended Kalman filter (EKF) therefore is derived from the Kalman filter to solve this problem.

By means of Taylor series, the non-linear relationships around the current time step can be linearized by using the partial derivatives of the process and measurement functions. To realize linearization of a non-linear process, some parts in solution equations of the Kalman filter must be modified. Assuming x e R " to be a state vector of a process, it can then be governed by the non-linear stochastic difference equation: X j^ -- f with a measurement y e R " , yic where the random variables and (2.16) represent the process and measurement noise ) ))

20

R e p ro d u c e d with p e rm is s io n of t h e co pyright o w n er. F u rth e r rep ro d u ctio n prohibited w ithout p e rm issio n .

as shown in (2.3)and(2.4). From equation (2.15), the non-linearfunction / relates the state attheprevious time di'iving function step k-l to the state at the current time step k, and includes

and the zero-mean process noise cr^_, . In the measurement

equation (2.16), the non-linear function h shows tire relationship between the state vector Xj. and the measurement vector y^.

The individual values of the noise cr^. and

at each time step are not known in

practice. However, the state and measurement vectors without noise could be approximated as (2 17) ÿa=A(x*^n, where (2 18)

is the posteriori state estimation at the previous time step k-I. Thus a

non-linear process can be approximately linearized as: ~ jy* = where a) xq and y^. are the actual state and measurement vectors, b) x^ and are the approximate state and measurement vectors, "f" ^k (-^r-- l "%-l ) --:%&) ^k'^k-l ' , (2.19) C Z 20)

c) x^_, is the posteriori state estimation at step k-I, d) O'/, and are the random variables representing the process and measurement

noise as shown in (2.3) and (2.4), e) Ajc is the Jacobian matrix of partial derivatives of / with respect to x.

2 1

R e p r o d u c e d with p e r m is s io n of t h e cop y rig h t o w n er. F u rth e r rep ro d u ctio n prohibited w ithout p e rm issio n .

,

(2 .21)

f) Wk is the Jacobian matrix of partial derivatives of /

with respect to a ,

.
g) Hk is the Jacobian matrix of partial derivatives of h with respect to x,

(2.2i2)

P.23) h) V* is the Jacobian matrix of par tial derivatives of h with respect to p ,

^P\j\

The prediction error and the measurement residual are defined as;

2;. = = .% *
2^,» =

.
--iy*.

(2L 2L 5)
(2 26)

Practically, x^. in (2.25) is not accessible, because it is the actual state being estimated. On the other hand, in (2.26), which is used to estimate xy, is accessible by means of

measurement. Hence (2.25) and (2.26) can also be described by: ~ -^k (^fc-1 " .^t-1 ) "* " = fy, = where and
77^ .

(2.27) (2.213)

,

represent new independent random variables having zero mean and respectively, where Qk and Rk are shown in

covariance matrices ITQ^W^and (2.3) and (2.4).

2 2

R e p r o d u c e d with p e r m is s io n of t h e co pyright o w n er. F u rth e r r e p ro d u ctio n prohibited w ithout p e rm issio n .

The random variables of (2.27) and (2.28) have the following probability distributions: p(;F,, ) p(et)~N(0,W<2,W'^), X 7 7 j~ N (0 ,y R ,y ^ ). , (2L29) (2.30) (2.31) in

Since (2.27) and (2.28) are linear equations, the actual measurement residual g (2.26) and a Kalman filter can be used to estimate the prediction error (2.27). Defining this estimation as from (2.25): Xk = Xf. + èk . Assuming the predicted value of 2* is: g; = jTtg:,,. Substitute (2.33) back into (2.32), then

given by

, the posterior state estimations could be obtained

(2.32)

to be zero, the Kalman equation used to estimate

(2.33)

ât = = :% &b

= =ât +iEt (T* --ift).

(/I-34)

Similar to the discrete Kalman filter, the EKF equations can be split into two groups, 1) time update equations, ic* = ~ " b ,0 ). . (2L35) (2.36)

2) measurement update equations. .R T , = f - H i ( H ,? ; H l + j& t ==;cl , )-', (2.37) (/i.:38)

2 3

R e p r o d u c e d with p e r m is s io n of th e co p y rig h t o w n e r. F urther rep ro d u ctio n prohibited w ithout p e rm issio n .

= =(Z--

.

CL39) , because

In equations (2.35), (2.36), (2.37), (2.38) and (2.39), x,. was substituted by of remaining consistent with the eMier "super minus" priori notation.

The basic computing cycle of the discrete EKF is the same as that of the linear discrete Kalman filter shown in Figure 2-1. Figure 2-3 provides a complete operation picture of the EKF with its calculation equations.

2.3

Frame Transformation

Transformations between different reference frames are often employed in motor speed control systems to obtain an effective control by converting the time-varying system into a time-invariant one. A vector can be described in the stator (abc) frame by three elements, and can be described in stationary (a/3) frame by two elements, also can be described in the arbitrary (dq) frame by two elements. In a practical motor control, variables in the stator frame usually are transformed into the 2-axis stationary or arbitrary frame to simplify mathematical equations and acquire proper control components. The acquired control components are transformed back into the three-phase variables of the stator frame to drive the actual motor. The transformations between the reference frames are discussed in this section.

2 4

R e p r o d u c e d with p e r m is s io n of t h e co p y rig h t o w n er. F u rth e r r e p ro d u ctio n prohibited w ithout p e rm issio n .

Initial estimates % and Pa k=k+1

Time Update (Predict)
(1) P roject th e sta te a h e a d

(2) P roject th e error c o v a r ia n ce a h e a d

Measurement Update (Correct)
(1) C om p u te th e Kalman gain

(2) U p d a te e stim a te with m e a s u r e m e n t

(3) U p d a te th e error co v a ria n ce

JO ,

Figure 2-3. A complete picture of the extended Kalman filter operation.

2 5

R e p r o d u c e d with p e r m i s s io n of t h e cop y rig h t o w n e r. F u rth e r r e p ro d u ctio n proh ibited w ithout p e r m is s io n .

The angle between abc and cc/J frame (the angle between a and a axis) is usually set at 0° for calculation simplification. Figure 2-4 shows the relationship between abc and
a p frame. The transformation equations between abc and a/3 frame are;
_ 2 "1 ~ 3 _0 1/2 1/ 2

-

-

'

i/ïi/:; ---V â/:2

(2.40)

1 Fa F, = - 1 / 2

0 V3/2 -V 3/2

(2.41)

Fa.

-1/2

Note: Fs are variables representing voltages, currents or fluxes.

The angle between abc and dq frame (the angle between a and d axis) is defined as d . Figure 2-5 shows the relationship between abc and dq frame. The transformation equations between abc and dq frame are: _ 2 COS0 " 3 - sin 0 cos(0 --27T/3) - sin(0 - 2 k 13)
cosid + 2% 13)

'f ; F, Fa. (2.42)

-sin(04-2;z;/3)

cos F cos(û - 2 n 13) cos(d +2 k /3)

--sin 6

 sin(0 - 2 n 13)


(243)

sin(0 -t- 2;r / 3)

Since the angle between abc and a/3 frame is 0° and the angle between abc and dq frame is d , the angle between a/3 and dq frame is 6 . Figure 2-6 shows their relationship. The transformation equations between a/3 and dq frame are:

2 6

R e p r o d u c e d with p e r m is s io n of th e c o p y rig h t o w n e r . F u rth e r re p ro d u c tio n prohibited w ithout p e rm is s io n .

Vector

120 °
120°

Figure 2-4. Vectors in abc and a/3 reference frames.

V ector

120 °|
120°

Figure 2-5. Vectors in abc and dq reference frames.

V ecto r

0

a

Figure 2-6. Vectors in a/3 and dq reference frames.

2 7

R e p r o d u c e d with p e r m i s s io n of t h e c o p y rig h t o w n e r . F u rth e r re p ro d u c tio n p rohibite d w ith o u t p e r m i s s io n .

F

CO S9 -- sin 8

sin 6 COS0

X' X. X' X.

(2.44)

X" X-

p

cos 9 sin6>

- s in 6 cos 9

(2.45)

2.4

Modeling of PMSM

The PMSM model in Simulink or other commercial simulation packages do not have the function of presetting the rotor initial position, therefore it cannot be used in the startup transient research. To solve this problem, a new PMSM model is developed in this section.

From reference [31], the mathematical equations of the PMSM in dq reference frame are (2.46)

V , = R . - I , + ~ + N p -c o rK .

(2.47) (2.48) (2.49)

dt

J

dt
2 8

(2.50)

R e p r o d u c e d with p e r m i s s io n of t h e c o p y r ig h t o w n e r . F u r th e r r e p r o d u c ti o n p ro h ib ite d w ith o u t p e r m i s s io n .

where Aj is the rf-axis flux-linlcage, given by Ag is the q-axis flux-linkage, given by is the d-axis current, /g is the q-axis current, R^. is the resistance of the stator, Np is tire number of the pole pairs, co^ is the rotor mechanical angular speed,
0)

=L^

(2.51) ' (2.52)

is the stator electrical angular speed,

D is the friction coefficient relating to the rotor speed, J is the moment of inertia of the rotor,

d g is the electrical angular position of the rotor, and A,, is the flux of the rotor magnet.

Considering that the PMSM used in this research is non-salient, it can be assumed that L - Lj = Z/g . Hence equations (2.46), (2.47) and (2.48) can be rewritten as:

(2.54) (2.55)

From equation (2.49), (2.50), (2.53), (2.54) and (2.55), the PMSM Simulink model is developed, and its block diagram is shown in Figure 2-7. The input terminals 2, 3 and 4
2 9

R e p r o d u c e d with p e r m i s s i o n o f t h e c o p y r ig h t o w n e r . F u r th e r r e p r o d u c ti o n p ro h ib ite d w ith o u t p e r m is s io n .

are the three-phase stator voltages. Blocks Fcn_Vd and Fcn_Vq transform the Va, Vk and Vc into Vd and Vq, which are described by equation (2.42). Blocks Fcn_Jd and Inte_Id calculate the Fi described by equation (2.53), and blocks F c n jq and In te jq calculate the Iq described by equation (2.54). Blocks Fcnjfa, Fcn_h and Fcn_Ic transform Id and Iq into la, h and based on equation (2.43), respectively. Equation (2.55) is realized by gain

k=i.5'WMD*P. Blocks Sum, 1/J and integrator Inte_W,- determine the rotor speed described by equation (2.49). The Pole block is for Np  (o,.. And the InteJTheta block calculates 6^ from equation (2.50).

The input terminal 5 in Figure 2-7 is a special design of the new PMSM model. It provides the function of presetting the initial rotor position. For example, if we want to investigate the startup transient when the initial rotor position of the PMSM is 45°, we can simply preset pi/4 as the input value of the terminal 5, and run the simulation diagram. Hence this new PMSM model makes the research of startup process at different initial rotor positions practical. This model is applied in all simulations of this thesis.

2.5

Control Algorithms of PMSM

General control methods of the Permanent Magnet Synchronous Motor (PMSM) reported in reference [28] are summarized in this section. Figure 2-8 shows the vector diagram of a PMSM in the arbitrary {dq) frame. The vectors in the diagram can be written as:

3 0

R e p r o d u c e d with p e r m i s s io n of t h e c o p y rig h t o w n e r . F u rth e r r e p r o d u c tio n p ro h ib ite d w ithout p e r m i s s io n .

PMSM_d-q_MODEL

-- >1w |Fcn_Vd Load

--* \w ---H % ) m
Fen J o

CE> CE>
Vb TL,

C±>
Vc We.

tF cn_V q

Figure 2-7. PMSM Simulink model with initial rotor position input.

I q-axis

RJ,

^oLj,

4

A,

d-axis

Figure 2-8. Space vectors o f PMSM in dq reference frame.

3 1

R e o r o d u c e d with o e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u r th e r r e p r o d u c tio n p ro h ib ite d w ith o u t p e r m i s s io n .

A ,= A ,+ Z ,.(Z ,,+ Z ,,), y, |/j| = |7 ,|s m j8 , |7,| = |7 j c o s ^ , tan g = --------------------. +ù)(A, - ! , , / , ) where, is the stator flux-linkage, is the stator current, given by 7^ = /^ + 7^ , and j7j = Vs ·|7J , |7g| is the effective value of phase current,

(2.56) (2 .5 7 ) (2.58) (2.59) (2.60)

X, is the d-axis component of the PM flux-linkage, given by A, = V3/ 2 · X,. is the rotor permanent flux linkage, P is the leading angle of the stator current from ç-axis,

,

7?j is the stator per-phase resistance, and Ô is the leading angle of the stator voltage from <j-axis.

In addition, the motor power factor is represented as c o s^ -- - cos((5 --jS). (2.61)

By controlling the angle p in Figure 2-8, three current phase control algorithms can be developed for PMSM: 1) zero d-axis current control (7^, = 0 ),

3 2

R e o r o d u c e d with o e r m i s s i o n of t h e coD vriaht o w n e r . F u r th e r r e p r o d u c tio n p ro h ib ite d w ith o u t p e r m i s s i o n .

2) unity power factor control ( PF = 1 ), and 3) constant flux-linkage control ( A, =Const).

Method 1 - Zero d-axis Current Control (/^ --0)
In this control algorithm, /3 is set to zero. Thus the d-axis current --Is ' P =0

As a result, the currents do not have demagnetization component. The rotor flux will not be weakened by the control algorithm. The electromagnetic torque therefore is proportional to the armature current.

Figure 2-9 shows the vector diagram of this algorithm. High performance torque control can be easily obtained in this method since the electromagnetic torque is only proportional to the armature current. In addition, because the demagnetization of the permanent magnet never occurs, this method is most commonly used in PMSM control in industry. However, the rating of the inverter feeding the PMSM may somewhat increase since a lai'ge stator voltage may be required to obtain a large A,,.

Method 2 - Unity Power Factor Control ( PF = 1 )
In this control algorithm, the power factor (2.61) is always kept at unity. The condition of unity power factor is realized by P = 5 . Hence, the relationship between derived as: 7 ' ^ -s in P I ,^ s in " /3 + I,,c o s " ;8 ' and P is

The vector diagram for this control method is shown in Figure 2-10.

3 3

R e p r o d u c e d with p e r m i s s io n of t h e c o p y r ig h t o w n e r . F u rth e r r e p r o d u c tio n pro h ib ite d w ith out p e r m i s s io n .

Aq-axis

R ,

(ûLJ,

d-axis
Figure 2-9. Vector diagram of Method 1 (Ij-0 ).

+q-axis

X

d-axis

Figure 2-10. Vector diagram of Method 2 (PF =l).

4q-axis

col,
R.

d-axis
Figure 2-11. Vector diagram of Method 3 ( =Const).

3 4

R e p ro d u c e d with p e r m is s io n of t h e cop y rig h t o w n er. F u rth e r r e p ro d u ctio n prohibited w ithout p e rm issio n .

Method 3 - Constant Flux-linkage Control (

=Const)
is

In this control method, by controlling the current phase angle p , the flux-linkage kept constant ( angle P is I  4 sin' 0 + 4 cos"/?' = A, ). The relationsliip between the armature cuixent

and its phase

(263)

The vector diagram for this control method is shown in Figure 2-11.

All three methods can be used to control the non-salient PMSM in this research. However, considering that Method 1 is has the potential to provide excellent dynamic performance, and therefore this method is to be further investigated in this thesis.

2.6

Simulink Diagrams for PMSM Control

Based on the PMSM model designed in Section 2.4 and the PMSM control methods analyzed in Section 2.5, a Simulink-based PMSM control with sensors is developed and its block diagram is shown in Figure 2-12. The PMSM model described in Figure 2-7 is represented by block PMSM_Vabc_MODEL. Its output terminals Theta and Speed are the actual rotor position and speed. The actual rotor position is fed back to the current loop. And the actual speed is used in both speed and cuixent loops.

3 5

R e p r o d u c e d with p e rm is s io n of t h e cop y rig h t o w n e r . F u rth e r re production prohibited w ithout p e rm issio n .

P M SM C ontrol

Load

speed L oad

Spd_ref ldq_ref R e fe re n c e Spd_fdbk

Load

S peed C o n tro lle r C urrent C o n tro lle r Theta V dq_V abc pi/3 Inftfaf P o s itio n P M SM _V abc_M O D E L

labe

F c n _ T h e ta

Figure 2-12. Simulink diagram of PMSM control with sensors.

S p e e d C ontroller Id R e f Id S pd_ref Fon_ld

-K JD
lq _ R e f ld q _ re f **

OE )
S p d _ fd b k

Iq FcnJq

Figure 2-13. Details of the speed controller in Figure 2-12.

3 6

R e p r o d u c e d with p e rm is s io n of t h e co pyright o w n e r. F u rth e r r e p ro d u ctio n prohibited w ithout p e rm issio n .

The details of the Speed Controller block in Figure 2-12 are shown in Figure 2-13. Based on the error between the speed reference and the actual speed, the proportional integral (PI) produces a current reference Is to blocks Fcn_Id and Fcnjfq, which generate the current references l / and Iq*. Since Method 1 is applied in this thesis, the Fcn_Id block is set to keep I^* to be zero, and the Fcn_Iq block is designed to deliver Is to Iq*.

Figure 2-14 shows the details of Current Controller block in Figure 2-12. It employs two Pis to regulate stator cun'ents and provides feed forward control to decouple the dynamics between the applied voltages and the currents. Inputs of the Current Controller are the references Id and Iq*, actual cuixents Id and Iq, and rotor speed co ; the outputs of this controller are voltages Vd and Vq.

Details of hbcJdq and Vdq_Vabc blocks in Figure 2-12 are shown in Figure 2-15. These two blocks are designed to realize frame transformations discussed in section 2.3. Referring to equation (2.42), the FhcJldq block transforms /,,, It, and F into F and Iq for the control feedback. According to equation (2.43), the Vdq_Vabc block transforms Vd and Vq into Vb and Vc for the PMSM drive.

The load of the PMSM is described as the Load block. Figure 2-16 presents three types of different loads: 1) load torque is proportional to square of the rotor speed, shown in Figure 2-16(a), 2) load torque is proportional to the rotor speed, shown in Figure 2-16(b), and 3) load torque is constant, shown in Figure 2-16(c). These loads will be discussed in detail in Chapter 3.

3 7

R e p r o d u c e d with p e r m is s io n of th e co pyright o w n e r. F urthe r rep ro d u ctio n prohibited w ithout p e rm issio n .

C u r r a n t C o n tr o l le r

9
ldq _ re f

--4 2 D

Vd

-CF lu x

Lr

Figure 2-14. Details of tire current controller in Figure 2-12.
V dq^V abc la b c _ ld q 1 Vd

-K3D
Va

OE > Vq CD
T h e ta

m  m

->CZD
Vb

CDla b c
~
T h e ta

r

r(u)

-K D
Vc

f(u )
F c n jq

- KIdq D
4

Figure 2-15. Blocks for frame transformation.

T L = K = " W W C3D
sp eed S ig n

r-

L oad

"c:

--KD

CDsp eed

-M D

(a) Fan or pump load (load torque proportional to the square of the rotor speed).

(b) Linear load (load torque proportional to the rotor speed).

T L = C o n stan t

Load

step
3 .9 7
C o n stan t P to d u cti

(c) Constant load. Figure 2-16. Three types of motor loads for simulations of PMSM control.

3 8

R e p r o d u c e d with p e r m i s s io n of th e co p yrig ht o w n e r. F u rth e r r e p ro d u ctio n prohibited without p e rm issio n .

2.7

Modeling of EKF Estimator for PMSM Speed Control

Since the PMSM EKF estimator based on Simulink models seems not reported in the literature, an innovative one is designed in this section. The new design features simple structure, fast modification and convenient tuning. It is derived from the mathematics analysis of the PMSM EKF estimator.

Substituting frame transformation equation (2.44) into (2.53) and (2.54) yields:

^

at

=

L R f
JL/

L ^ X
I-/

L
0 ),. cos8,

( 2 .64 )

din
d t

Vo
jL/

.

(2.65)

Compared with the dynamics of the PMSM, the discrete sampling interval is very short in control process. The rotor inertia therefore could be assumed infinite. As a consequence, the torque equation (2.49) reduces to ^ = 0. (2.66)

dt

Therefore any mechanical load parameter as well as the load torque disappears in the equations. This means the motor speed is kept constant in the prediction (time update) step and produced entire dynamics in the correction (measurement update) step.

Write (2.64), (2.65), (2.66) and (2.50) into matrix form:

3 9

R e p r o d u c e d with p e r m is s io n of t h e cop y rig h t o w n e r. F u rth e r r e p ro d u ctio n prohibited w ithout p e r m is s io n .

R
x ~

L 0 0 0

0
_ RJ

1 ^ Np -- -sin 8 L -N p -- ^co s9 L 0 Np

0 0 0 0

[ /^a 1 hp 6

L 0 0 0

A
dt

4

L 0 0

o] 1 L 0 0

(2.67)

_

__

~i .4 .
Defining 0

0 1

0 0

o'
0

h 03,e..

C2.68)

'h '
X:

A"
.

d h dt Û ),

% =

h

X ' A .

C D ,.

; y=

A ' A .

A.
and

A_
'l L
--

A
L A=

0

Np - ^ s in 6^ X -N n ~ c o sG ^
0

0 0 · B

0 1 L 0 0 H
10 0 0

0
0

A
L 0

0 0 0

0

10

0

0

0

equations (2.67) and (2.68) can be rewritten as x = A- x + B - u , y = H -X . The approximate discrete equations of (2.69) and (2.70) can be written as xq. = ( / + A- T) - x Vi + 5 - r - u ^ _ i .
Jk ~ ^


(2.69) (2.70)

(2.71) (2.72)

where

4 0

R e p r o d u c e d with p e r m is s io n of th e c o p y rig h t o w n e r . F u rth e r re p ro d u c tio n prohibited w ithout p e r m is s io n .

I is the unity matrix, and T is the sample time interval.

Considering the process and measurement noise, the PMSM space-state discrete equations can be written as = / (^t_i, ). (2.73) (2.74) where / (^'i-i '^k-i --(7 + A ' T)Xf._i + B T  , (2.75)
(^"^ ^

^ (^ i ^Pk) = H - ^ k - ^ Pk-

From theory presented in Section 2.2, the PMSM states x can be estimated by EKF through following two steps during each sampling time interval: 1) time update step: = / ( % - ! '« 1 .0 ). P i = C ,P ,.X l 2) measurement update step: K , = p;
d I (d , p; d I

(2-77) . (2.78)

+ v ,R ,v i y ' .

(2.79) (2.80) (2.81)

x ,= x ; + K ,{ y t- h ( k ; ,0 ) ) , P ,= iI-K ,D ,)P y. where C[;j| ] - (%_i, U j. ,0),

(2.82)

4 1

R e p r o d u c e d with p e r m i s s io n of th e c o p y rig h t o w n e r . F u rth e r r e p ro d u c tio n pro h ib ite d w ith o u t p e r m i s s io n .

(2.83)

^U,jl ~ \ (% '®) > °^U'] 3A[,] 3P[y]

(2.84)

(2.85)

In actual PMSM control system, matrix and are constants. Thus

and in (2.78) and

are unity matrices and matrix in (2.79) are replaced by

Q and R in computing process. The matrixes C and D are 7 _K. £. L C= 0 0 0 ^ ^ 1 0 0 0 0 1 0 0 0 1 -r & L 0 0
h

&
L A. T-co,.-Npysme^ L 0 1 (2.87)
(2.86)

-r-7Vp^cos6>,
1 T

L A,

where the footnotes k and k-1 are omitted.

From above mathematical derivation, a Simulink based PMSM EKF state estimator is designed in Figure 2-17, where the inputs of this block are control vectors and measurement vectors and Vp ,

and Ip . The outputs of this model are estimated state/q. ,

/ p , mechanical speed tP,. and electric position 6 ^. Blocks M atrixjQ and MatrixJR are the noise coefficient matrices in equations (2.78) and (2.79). Blocks Matrix_X and M atiixJP are the memory stacks for time step updating. Since it is assumed in the EKF algorithm that the motor is started from standstill without the need of the initial rotor
4 2

R e p r o d u c e d with p e r m i s s io n of t h e c o p y r ig h t o w n e r . F u rth e r r e p r o d u c tio n p ro h ib ite d w ith o u t p e r m i s s io n .

EKF M o d el fo r P M S M M atîîx_Q M atrix M ultiply T /L C o n c a te n a tio n lb e ta _ o u t

V e rt C a t

Read_X R ead_X M a trix ^ C a lc u la to r M atrix M ultiply R ead_P

M atrix M ultiply T h e ta

jk

M atrix M ultiply

M atrix M ultiply W rite_X

R ead_Q M atrix M ultiply ,[4x2] M ultiply^

Sum 3

M atrix M ultiply Sum 4

V e rt C a t

R ead_R

M atrix M ultiply

M atrix C o n c a te n a tio n l

Figure 2-17.

Simulink-based PMSM EKF estimator.

4 3

R e p r o d u c e d with p e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u r th e r r e p r o d u c ti o n p ro h ib ite d w ithout p e r m i s s io n .

position information, the initial vector Xo has been considered as the null vector.

In a time update step, inputs Valpha and Vbeta, blocks Matrix Concatenation, T/L, Matrix_D', Multiply 1, Read_X, MatrixjCalculator, Multiply! and Sum l implement equation (2.77). Blocks Read_X, MatrixjCalculator, ReadJP, Multiplyd, Read Q and Sum! compute equation (2.78).

In a measurement update step, the output P- of the Sum!, blocks MatrixJD, MatrixJD', Multiply!, Read__R, Sum3, Inv and Multiplyô calculate equation (2.79). The output X- of the Sum l, the output K of multiplyô, model inputs lalpha, Ibeta, blocks MatrixJC, M atrixjCalculatorl, Multiplyô, Sumô and multiply? calculate equation (2.80). The output P- of the Sum!, the output K of multiplyô, blocks MatrixJC, MultiplyS and Sumô compute equation (2.81).

To prevent the occurrence of the algebra c h d e in MATLAB simulation, the calculation results of the present time step are delayed to the next time step. The process is implemented by stacking the outputs of the model into the MatrixJX block in current time-step and releasing it through block Read_X in next time-step.

2.8

PMSM EKF Sensorless Control

In this section, a multi-tasking Simulink-based PMSM EKF sensorless control diagram is designed. A simplified simulation diagram of the EKF method is firstly presented.

4 4

R e p r o d u c e d with p e r m i s s io n of t h e c o p y rig h t o w n e r . F u rth e r r e p r o d u c tio n pro h ib ite d w ith o u t p e r m i s s io n .

P M SM S e n s o rle s s C ontrol

L oad
L o ad Spd_ref S peed R e fe re n c e
Id q je f

I d q js f

Spdjfdbk
Vb Vb

W Vb Current C o n tro lle r Te T ro q u e Theta V dq_V abcS»V ab
ln rt_ P o s

P M S M _ V ab c_ M O D E L

pi/3 Initial P o sitio n

F cn _T hetad

m
iabc F o n _ T h e ta 2

Theta E i< F _ esiim ato r

Figure 2-18. Simplified EKF sensorless PMSM control.

V d q _ V ab c& V ab

V d q to V a b c

-K D
Vd F cn_V a Va

CZ>
Vq
F cn _ JV b

>CO
Vb

> < u)
T h e ta F cn _V c

*OE )

V a b c to V a b

Figure 2-19. Details of block ViicjJ/ahc&Vah in Figure 2-18.

i a b c t o Id q F o n _ ld

CL>
Iab c

F c n jq

T h e ta F c n _ la

Fcn__lb

Figure 2-20. Details of block labc-Idq&Iab in Figure 2-18.

4 5

R e p r o d u c e d w ith p e r m i s s io n of t h e c o p y r ig h t o w n e r . F u r th e r r e p r o d u c tio n p ro h ib ite d w ith o u t p e r m i s s io n .

A multi-tasking diagram with an ideal sinusoidal power supply for proposed control method is designed. Finally, an advanced multi-tasking PMSM EKF sensorless control diagram along with the sinusoidal pulse width modulated inverter is developed.

Simplified Simulation Diagram
A simplified PMSM sensorless control algorithm based on the EKF state estimator proposed in Section 2.7 is designed and shown in Figure 2-18. Different from the control with sensors shown in Figure 2-12, this algorithm uses the estimated position and speed from EKF estimator instead of the measured position and speed from sensors in control loops. Since the proposed EKF estimator requires the vectors V^, Vp, and as

inputs, blocks Vdq_Vabc&-Vab and labc-Jdq&lab are designed. As shown in Figure 2-19, the VdqVabc&Vab block transforms the voltages from dq frame to both ahc and ctjS frames. Similarly, in Figure 2-20, the labc-- Iciq&hb block transforms the currents from abc frame to both d^q and frames. This diagram is called simplified simulation diagram because

the EKF model and the PMSM are calculated at the same computing rate (single-tasking solver). Previous simulations in literature were based on this method. However, the simulation accuracy of this diagram is limited because the PMSM and the control circuit (including EKF model) are simulated at the measurement-sampling rate, which cannot be pretty high in practice. In addition, this diagram cannot simulate SPWM application because of the limitation of the measurement-sampling rate.

Multi-tasking Control Diagram with Ideal Sinusoidal Power Supply
In an actual PMSM control application, the motor keeps running continuously while the control circuit (including EKF model) updates the control vectors once in each system measurement-sampling interval. To simulate this process, a multi-tasking control diagram with ideal sinusoidal power supply for the PMSM is designed and shown in Figure 2-21.

4 6

R e p r o d u c e d with p e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u r th e r r e p r o d u c ti o n p ro h ib ite d w ith o u t p e r m i s s io n .

The purpose of using multi-tasking method is to calculate EKF model and PMSM at different computing rates so as to acquire better simulation results. The triggerable subsystem Control_Block, including control loops and EKF estimator, should work at the actual sampling rate of the real-time control. At the same time, the PMSM should be calculated at a higher computing rate to obtain more accurate motor information. Thus, the simulation accuracy of the diagram in Figure 2-21 is improved.

The Pulse Generator block in Figure 2-21 generates the enable pulse to trigger Control_Block so as to produce proper and 1/ to drive the PMSM. Hence both

of the Pulse Generator and the subsystem ControljBlock should work at the system measurement-sampling rate. For example, if the measurement-sampling rate is lOK per second, the time interval of the enable pulse of the Pulse Generator should be 0.0001 second. Therefore the Control_Block works at the rate of lOKfsec. On the other hand, the PMSM should be simulated at a higher computing rate, such as 200K/sec, to obtain more accurate simulation results. The details of ControljBlock are shown in Figure 2-22.

Multi-tasking Control Diagram with SPWM Power Supply
In practical applications, the PMSM is normally driven by a pulse width modulated (PWM) inverter instead of an ideal sinusoidal power supply. It is hence necessary to design a diagram to simulate the sinusoidal pulse width modulated (SPWM) inverter for the proposed control algorithm. Since the SPWM inverter cannot be simulated in simplified diagram due to the limitation of the single-tasking solver of the PMSM and the control circuit, a new multi-tasking diagram with the SPWM supply is designed and shown in Figure 2-23.

4 7

R e p r o d u c e d with p e r m i s s io n of t h e c o p y r ig h t o w n e r . F u r th e r re p r o d u c tio n pro h ib ite d w ithout p e r m i s s io n .

h ilu ltU ia fk in g P M S M E K F C o n tro l

Load

speed

JIJL
P u ls e G e n e r a to r

1
JT Spd Ref

L oad

Y
S peed Load la Vb lb Vb Ic Vb Te lnrt_Pos Theta ·f(u) F c n _ T h e ta 1

S p d ^ re f & est

Vb Vb Vb lalpha

S peed re f e r e n c e

E stja lp h a ibeta Iabc E s tjb e t a

PM SM V abc_M O D E L

F c n _ T h e ta 2 fe t_ W E stjrh eta C o n tro l B lo d r

T h e ta

p r/3
In itia l P o s itio n

 a
la lp h a I b e ta

Figure 2-21. Multi-tasking EKF sensorless PMSM control.

S u b sy ste m o f PM SM S e n s o r l e s s C o n tr o l S peed C o n tr o lle r Spd ref Spd R ef ldq_ref Spd fdbk ldq_ref Idq W Vd

ji
E n a b le

Vd

Vb Vb

Vti Vb Theta Vbb

V d q _ V a b c& V a b

la lp h a Idq lab la b c _ ld q & la b

Est l a lp h a

OE)
Vblpha lalph aljout Ibeta out lalpha (beta EKF W Theta e s t im a to r E st T h e t a E st W Est b e ta

Figure 2-22. The details of the block Control_Block in Figure 2-21.

4 8

R e p ro d u c e d with p e r m is s io n of t h e co p y rig h t o w n e r. F u rth e r rep ro d u ctio n prohibited w ithout p e rm issio n .

PM SM EKF S e n s o rle s s C ontrol

Iload

speed

Wr

,JLTL
P ulse G e n e ra to r

Load 300 V dc

Vio

Spd Ref S peed reference lalpha

SPW M Theta P M SM _V abc_M O D E L

Te

Ibeta Iabc & t_lbela EstJW T h e ta

C ontrol_Blod<

pi/3 Initial

Figure 2-23. Full Simulation of PMSM EKF Sensorless Control.

PW M G e n e r a to r

C I>
Vdo T hree P h a se V Sl Va R e la t io n a l O p e ra to r P r o d u c ts CW G e n e r a to r

P rod u ct

R e la t io n a l O p e r a lo r l

P r o d u c ti

Vo

KZD
P r o d u c ts V c_puvm

Figure 2-24. Details o f the block SPWM in Figure 2-23.

4 9

R e p r o d u c e d with p e r m is s io n of th e co py righ t o w n e r . F u rth e r rep ro d u ctio n prohibited w ithout p e rm is s io n .

The SPWM block in Figure 2-23 is designed to simulate the outputs of a three-phase inverter that converts a DC voltage into pulse width modulated waveforms. The details of the SPWM block are shown in Figure 2-24. The CW Generator block generates a triangular carrier waveform. The product of the carrier voltage and the 2/3 of DC voltage is compared with the three-phase reference voltages and . Blocks relational

operator, relational operator1 and relational operator! implement the comparisons. If the sinusoidal reference voltage is higher than carrier voltage, the relative comparator outputs logic 1, otherwise outputs logic 0. The comparison results generate singles Gi, G 3 and Gg, which are the gating signals for the three-phase inverter. The three- phase VSI function in Figure 2-24 simulates a three-phase inverter, whose output is given by:
= (2 G l-G 3 -G 5 ).y ^ /3 (2.88)

= (2 G 3 -G l- G 5 ) .y ^ c /3 = (2G5 - Gl - G 3). /3

(2.89) (^-90)

From above analysis, it is concluded tlrat this multi-tasking diagram with SPWM inverter can improve the simulation accuracy for the proposed PMSM EKF sensorless control algorithm.

2.9

Conclusions

In this chapter, the theory of tire discrete-time extended Kalman filters is introduced. A simulink based permanent magnet synchronous motor (PMSM) model is established. The main feature of the model lies its ability to preset the rotor initial position, which is not
5 0

R e p r o d u c e d with p e r m is s io n of th e cop y rig h t o w n e r. F u rth e r r e p ro d u ctio n prohibited w ithout p e rm issio n .

available in commercial simulation packages. Three control strategies for the PMSM are discussed, based on which the zero d-axis current control is adopted due to its good dynamic performance. To eliminate the use of position or speed sensors, a sensorless control algorithm using an EKF state estimator is developed for the motor drive. A multi-tasking Simulink-based diagram for the proposed drive system, which integrates the PMSM, the control algorithm, the SPWM power supply and the EKF model for motor speed estimation, is developed.

5 1

R e p r o d u c e d with p e r m is s io n of t h e co pyright o w n e r. F u rth e r r e p ro d u ctio n prohibited w ithout p e rm issio n .

MALUM

R e p r o d u c e d with p e r m is s io n of t h e cop y rig h t o w n e r . F u rth e r r e p ro d u ctio n prohibited without p e rm issio n .

Chapter 3

Computer Simulation and Analysis
This chapter presents tlie computer simulation and analysis of the PMSM EKF sensorless control algorithm proposed in Chapter 2. The drive system operation with different types of dynamic and static torque loads is investigated. The robustness of the proposed control algorithm is investigated by parameter sensitivity analysis. A practical control technique is developed for correcting rotor flux variations. One of the challenges in developing the PMSM sensorless control is the difficulties associated with the motor starting since the initial rotor position is usually unknown. This problem is thoroughly investigated, and techniques are developed to overcome this challenge. Computer simulation is extensively used in tliis chapter to assist the investigation and analysis of the proposed chive control algorithms.

The contents of this chapter are as follows: Section 3.1 investigates the performance of the proposed PMSM drive system operating with different types of mechanical loads, Section 3.2 studies the robustness of the drive system due to motor parameter variations and presents an algorithm for eliminating flux-linkage corrector. Section 3.3 simulates the motor startup process at different initial rotor positions and presents a technique that can eliminate tire use of divergence corrector and startup current pulse injection, and Section 3.4 concludes Chapter 3.

5 3

R e p r o d u c e d with p e r m is s io n of th e cop y rig h t o w n e r . F u rth e r re p ro d u c tio n prohibited w ithout p e rm is s io n .

3.1

Drive System Performance with Various Loads

The main objective of this section is to investigate the steady-state performance of the proposed EKF PMSM sensorless drive system operating under various load conditions. Three types of loads are considered: 1) fan/pump load, whose torque is proportional to the square of the rotor speed; 2 ) linear load, in which the load torque is proportional to the rotor speed. A typical example of tliis type of load is motor-generator sets; and 3) constant torque load, where the load torque in constant, such as an elevator.

3.1.1

Fan/Pump Load
(O^) usually

The load with the torque proportional to the square of the rotor speed (7^

represents fan or pump applications. This type of loads can be defined accordmg to the nameplate (Appendix B) of the PMSM. Since the rated power of the PMSM under investigation is 5KW and the rated speed is 12000 rpm (=1257 rad/s), the rated load torque is: T 1257^ 6)2 =2.5175x10-''. 0^ . (3.1)

Firstly, the Simulink block diagram of the proposed EKF-based sensorless PMSM drive with ideal sinusoidal power supply (Figure 2-21) is simulated to identify the control performance.

Figure 3 -1(a) shows the simulated waveforms of the speed reference speed < ^,,ci and tire estimated speed provides a step from
0

, the actual

in radian per second (rad/s). The speed reference
1200

to

1200

rad/s at the time 0 . 1 s, and a negative step from

rad/s

to -500 rad/s at the time of 5s. Since the error between actual and estimated speeds is hard to distinguish in Figure 3-1(a), the speed error ( ^aci - ^est) is shown in Figure

5 4

R e p r o d u c e d with p e r m i s s io n of th e c o p y rig h t o w n e r . F u rth e r re p ro d u c tio n prohibited w ithout p e r m is s io n .

3-l(b). From Figure 3-l(b), the steady-state speed eiTor is 7.5/1200=0.625% at the rated speed (=1200 rad/s), and reduces to (-0.5)/(-500)=0.1% at -500 rad/s.

The actual rotor position 0

and estimated rotor position 6 est aie shown in Figure 3-2(a).

The eiTor between these two positions ( 9 act -&est) is shown in Figure 3-2(b). The steady-state position error is (-5°)/360°-- 1.39% at 1200 rad/s, and 2.67360°=0.72% at -500 rad/s.

Figure 3-3 shows the waveforms electromagnetic torque of the PMSM. The waveforms of the actual and estimated stationary current 7^ and /,, are shown in Figure 3-4.

From the simulation results, it can be concluded that tlie performance of the PMSM EKF sensorless control is good when an ideal sinusoidal power supply is used. However, the pulse width modulating (PWM) teclinique is widely applied in practical motor drives, hence the control diagram with the PWM drive circuitry shown in Figure 2-23 should be investigated.

Figure 3-5 (a) shows the waveforms of the speed reference, actual speed and estimated speeds when the sinusoidal pulse width modulating (SPWM) power supply is applied. Figure 3-5(b) shows the eixor between the actual and estimated speeds. The steady-state speed error is about (-ll)/1200=-0.833% at 1200 rad/s, and goes to 10/(-500)=-2% at -500 rad/s. The phenomenon that the speed error increases when the speed reduces is caused by the PWM chopping noise. Since the current disturbance caused by PWM chopping noise is invariant at different speed occasions, the higher steady-state speed is, the less effect of PWM chopping noise happens, and the smaller the speed error occurs.

5 5

R e p r o d u c e d with p e r m i s s io n of t h e c o p y rig h t o w n e r . F u rth e r r e p r o d u c tio n pro h ib ite d w ith o u t p e r m is s io n .

i
I

.............. ! J 1

.

! i

..................

.................... ....................

...................

K ________L - ............... ........................ 5 .......................

:

I

:

i

J
......................

i

:

^

i

.

--

(a) Speed reference, actual and estimated rotor speeds.

(b) Error between actual and estimated rotor speeds. w / , No SPWM).

Figure 3-1. Response of actual and estimated rotor speeds (31

i
I

i
I

1

{(sec)

t(S9C)

(a) Actual and estimated rotor positions.

(b) Error between actual and estimated rotor positions. ·, No PWM).

Figure 3-2. Waveforms o f actual and estimated rotor positions (21 '

T oe
Figure 3-3. PMSM Electromagnetic torque (71 cc 6,/^ No PWM). estimated (71 ^ w / , No PWM). Figure 3-4. Waveforms o f actual and

5 6

R e p r o d u c e d with p e r m i s s io n of t h e c o p y r ig h t o w n e r . F u rth e r r e p r o d u c tio n p ro h ib ite d w ith o u t p e r m i s s io n .

!

!

!

:

!

!

/ /

i

/
...............

\

1

................. ............

^ \

................

--

--
Ksoo) l(58C|

(a) Speed reference, actual and estimated rotor speeds.

(b) Error between actual and estimated rotor speeds. <^r~ , SPWM).

Figure 3-5. Response of actual and estimated rotor speeds {Ti

Ô 5
(a) Actual and estimated rotor positions. (b) EiTor between actual and estimated rotor positions. Figure 3-6. Waveforms o f actual and estimated rotor positions (Tl . , SPWM).

1 0r / \... j - i / y - I I....j. u.-./. I...< ·/- y -- J s y j .1..... I I ·· f 1· · / ..u I. V ...J \ .... 1

... I ...V -T ^

..... / : "V........ .... 1. '^ 3

U ------ 5 6 i------ sk------ 5 m -------5 7 -------SV
I(sac)

Figure 3-7. PMSM Electromagnetic torque (7 ' ^ ocû; / , N
o PWM).

Figure 3 -8. Waveforms of actual estimated / (7),

and

, No PWM).

5 7

R e p r o d u c e d w ith p e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u r th e r r e p r o d u c ti o n p ro h ib ite d w ithout p e r m is s io n .

Figure 3-6 (a) shows the waveforms of the actual and estimated rotor positions. The rotor position error is shown in Figure 3-6(b). The average steady-state position error is (-13°)/360°=3.61% at 1200 rad/s, and 107360°=2.78% a t-500 rad/s.

Figure 3-7 shows the electromagnetic torque produced by the PMSM. Although the SPWM waveform causes torque disturbance, the average value is the same as that in Figure 3-3. The actual and estimated waveforms of the stationary frame currents f are shown in Figure 3-8. and

3.1.2

Linear Load
tu,.) can be described as a

The load with the torque proportional to the rotor speed

motor-generator (M-G) set, in which the motor drives the generator, and generator drives resistance load. The simulation for this load is based on the diagram shown in Figure 2-23. The load for the PMSM shown in Appendix B can be designed as:
7 ),

=W, =

3.1645x10-"

(3 .2 )

Figure 3-9(a) shows the speed reference, actual and estimated speeds when the SPWM drive is used with the load torque proportional to the rotor speed. Figure 3 -9 (b) shows the error between actual and estimated speeds. The steady-state speed eiTor is

(-7)/1200=-0.583% at 1200 rad/s, and 7/.(-500)=-l .4% at -500 rad/s.

Figure 3-10(a) shows waveforms of the actual and estimated rotor positions. The rotor position error is shown in Figure 3-10(b). The steady-state position error is (-1 3°)/360"=3.61% at 1200 rad/s, and 87360°=2.22% at -500 rad/s. Figure 3-11 shows

5 8

R e p r o d u c e d with p e r m i s s io n of t h e c o p y rig h t o w n e r . F u rth e r r e p r o d u c tio n pro h ib ite d w ithout p e r m i s s io n .

i

i

t[soc)

l(S6C)

(a) Speed reference, actual and estimated rotor speeds.

(b) Error between actual and estimated rotor speeds. . SPWM).
_ i_

Figure 3-9. Response o f actual and estimated rotor speeds (Tl

t<sec)

(a) Actual and estimated rotor positions.

(b) Error between actual and estimated rotor positions.

Figure 3-10. Waveforms o f actual and estimated rotor positions (J l °^ ^r-, SPWM).
' ..  ; ! ' ... TVi.................... n
\r \J ' \j \ l

mm.

J

V ...^ u n

.
/ \

.

... / . M ....
\ /

U U i

l

l

!

.....

i..

i\y i

-L

Ksec)

Figure 3-11. PMSM Electromagnetic torque (71°= 6;^, SPWM).

Figure 3-12. Waveforms o f actual estimated SPWM).

and

5 9

R e p r o d u c e d w ith p e r m i s s io n of t h e c o p y r ig h t o w n e r . F u r th e r r e p r o d u c tio n p ro h ib ite d w ith o u t p e r m i s s io n .

waveforms of the electromagnetic torque and Figure 3-12 shows the waveforms of actual and estimated stationary currents /,, and .

3.1.3

Constant Torque Load

In this simulation, the load of the PMSM in proposed contiol algorithm (Figure 2-23) is assumed to be constant (Tf= Const). The rated torque of the PMSM shown in Appendix B can be calculated as:

Figure 3-13(a) shows the waveforms of the speed reference, actual and estimated speeds when the SPWM drive and the constant rated load are applied. Figure 3-13(b) shows the error between actual and estimated speeds. The steady-state speed error is

(-ll)/1200=-0.833% at 1200 rad/s, and 12/(-500)=-2.4% a t-500 rad/s.

Figure 3-14(a) shows the actual and the estimated rotor positions. The rotor position error is shown in Figure 3-14(b). The steady-state position error is (-14°)/360°=3.89% at 1200 rad/s, and 37360°=0.833% at -500 rad/s. Figure 3-15 shows the PMSM electromagnetic torque and Figure 3-16 shows the waveforms of actual and estimated stationary currents L and /,, .

3.1.4

Summary

In this section, the performance of the proposed EKF sensorless drive system is

6 0

R e p r o d u c e d with p e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u r th e r r e p r o d u c tio n p ro h ib ite d w ith o u t p e r m i s s io n .

1(SÔC)

Ksec)

(a)

Speed reference, actual and estimated rotor speeds.

(b) Error between actual and estimated rotor speeds.

Figure 3-13. Response o f actual and estimated rotor speeds (Ti=Const, SPWM).

: : ...

luift

I ........ .... .................................
(a) Actual and estimated rotor positions. (b)

------- ,-------

Error between actual and estimated rotor positions.

Figure 3-14. Waveforms o f actual and estimated rotor positions {Ti-- Const, SPWM).

t(soc)

Figure 3-15. PMSM Electromagnetic torque (TL^Const, SPWM).

Figure 3-16. Waveforms of actual estimated I (TL-Const, SPWM).

and

6 1

R e p r o d u c e d with p e r m i s s io n of t h e c o p y r ig h t o w n e r . F u rth e r re p ro d u c tio n p ro h ib ite d w ithout p e r m i s s io n .

investigated under various loading conditions. Three typical loads including fan/pump load, linear load and constant torque load are considered. The results of the investigation are summarized in Table 3-1, from which the following conclusions can be drawn: 1) The proposed EKF algoritlrm for the rotor speed and position estimation is quite accurate. The maximum steady-state rotor speed error is only 2.4% and the maximum rotor position error is only 3.9%, which are acceptable in most engineering applications. 2) The proposed sensorless drive system can operate satisfactorily under any loading conditions.

3.2

Robustness to Motor Parameter Variations

The main purpose of this section is to investigate the robustness of the proposed EKF PMSM sensorless drive system in case of the motor electric pai'ameters variances. Two types of the motor electric parameter variations are considered: winding resistance, and 2 ) changes in rotor flux-linkage.
1)

changes in stator

3.2.1 Changes in State Winding Resistance
The body temperature of a mnning motor increases because of the core loss, copper loss and mechanical frictions. As a result, the stator winding resistances increase. Based on the proposed PMSM EKF sensorless control diagram in Figure 2-23, this phenomenon is simulated by keeping parameters in EKF model unchanged and increasing the winding resistances in the PMSM model. In this research the resistance values are assumed to be doubled (Rs~^2Rs).
6 2

R e p r o d u c e d with p e r m is s io n of t h e cop y rig h t ow ner. F u rth e r re p ro d u c tio n prohibited w ithout p e rm issio n .

Table 3-1. The simulation results of tire steady-state rotor speed and position errors of different loads.

Tl

col

Tl

col SPWM

-=-Const SPWM

No SPWM Speed reference
0

SPWM

^

(rad/s)

1200

-500

1200

-500

1200

-500

1200

-500

Steady-state speed error 0.625
0 .1

-0.917

-2

-0.583

-1.4

-0.917

-2.4

^rcf

Steady-state position eiTor 9 -9 360° xlOO(%) 1.389 0.722 -3.611 2.778 -3.611 2.222 3.889 0.833

6 3

R e p r o d u c e d with p e r m i s s io n of th e co p y rig h t o w n e r. F u rth e r r e p ro d u ctio n prohibited w ithout p e rm issio n .

Figure 3-17(a) shows the waveforms of speed reference, actual and estimated speeds when the PMSM windmg resistances are doubled. The error between actual and estimated speeds is shown in Figure 3-17(b). The average steady-state speed error is (-12)/1200=-1.0% at 1200 rad/s, and becomes 10/(-500)=-2.0% at -500 rad/s. Compared to Figure 3-5(b), Figure 3-17(b) does not indicate the influence on speed estimation by doubling the stator winding resistances.

Figure 3-18(a) shows the actual and estimated rotor positions. The rotor position error is shown in Figure 3-18(b). The average steady-state position error is (-13°)/360°=3.61% at 1200 rad/s, and 107360°=2.77% at -500 rad/s. Compared to Figure 3-6 (b), Figure 3-18(b) does not indicate the influence on rotor position estimation by doubling stator winding resistances. Figure 3-19 shows the electi'omagnetic torque produced by the PMSM and Figure 3-20 shows the waveforms of actual and estimated stationary currents hand

3.2.2

Changes in Rotor Flux-linkage

The rotor flux-linkage value of a PMSM might be higher than the named one when the PMSM is newly manufactured, and will be weakened after a long-term usage. Therefore two types of rotor flux-linkage variations should be studied: increase in flux-hnkage and decrease in flux-linkage.

Increase in Rotor Flux-linkage
Since most of the rotor flux-linkage increases when the PMSM is newly manufactured are less than 10% of the named one. 10% increment is considered in this simulation. To verify whether
10%

increment of the flux-linkage (

2

2

,.) influences the system

6 4

R e p r o d u c e d with p e r m is s io n of t h e co py righ t o w n e r . F u rth e r r e p ro d u ctio n p roh ibited w ithout p e rm issio n .

:

t(S9C)

(a) Speed reference, actual and estimated rotor speeds.

(b) Error between actual and estimated rotor speeds.

Figure 3-17. Response o f actual and estimated rotor speeds (Rs~^2Rs, SPWM).

(a) Actual and estimated rotor positions.

(b) Error between actual and estimated rotor positions.

Figure 3-18. Waveforms o f actual and estimated rotor positions (Rs~*2Rs, SPWM).

Figure 3-19. PMSM Electromagnetic torque

SPWM).

Figure 3-20. Waveforms of actual / ,, estimated 7 (Rs-^2Rs, SPWM).

and

6 5

R e p r o d u c e d with p e r m i s s io n of t h e copy rig ht o w n e r. F u rth e r rep ro d u ctio n prohibited w ithout p e rm is s io n .

stability, we can simulate the proposed PMSM EKF sensorless control diagram in Figure 2-23 by increasing the flux-linkage 10% in the PMSM module, at the same time keeping other parameters in EKF model unchanged.

Figure 3-21(a) shows the waveforms of speed reference, actual and estimated speeds when the rotor flux-linkage is increased 10%. The error between actual and estimated speeds is shown in Figure 3-21(b). The average steady-state speed eixor is (-13)/1200=-1.083% at 1200 rad/s, and becomes 10/(-500)=-2% at -500 rad/s.

Figure 3-22(a) shows the actual and the estimated rotor positions. The rotor position enor is shown in Figure 3-22(b). The average steady-state position error is

(-14°)/360°-- 3.89% at 1200 rad/s, and 87360°= 2.22% at -500 rad/s. Figure 3-23 shows the waveform of the PMSM electromagnetic torque and Figure 3-24 shows the waveform., of actual and estimated stationary current /,, and î^ .

Decrease in Rotor Flux-iinkage
Generally, if a PMSM loses 20% of its rotor flux-linkage, it should be remagnetized. Hence we consider the worst condition that is 20% decrease of the flux-linkage. To verify whether the
20%

decrement of the rotor flux-linkage influences the system stability, we

can simulate the control diagram in Figure 2-23 by decreasing tlie flux-linkage value 20% ( ^r~*0.8 2 r ) i n the PMSM module.

Figure 3-25(a) shows the waveforms of speed reference, actual and estimated speeds when the rotor flux-linkage is weakened 20%. The error between actual and estimated speeds is shown in Figure 3-25(b). The average steady-state speed error is 3/1200=0.25% at 1200 rad/s, and 3/(-500)=-0.6% at -500 rad/s.

6 6

R e p r o d u c e d with p e rm is s io n of t h e cop y rig h t o w n e r . F u rth e r r e p ro d u ctio n prohibited w ithout p e rm is s io n .

I
l(GOC)

l(soc)

(a) Speed reference, actual and estimated rotor speeds.

(b) Error between actual and estimated rotor speeds. /I,., SPWM).

Figure 3-21. Response o f actual and estimated rotor speeds (

t(sec)

(a) Actual and estimated rotor positions.

(b) Error between actual and estimated rotor positions. 2^, SPWM).

Figure 3-22. Waveforms of actual and estimated rotor positions (

3

1

..i........i

Figure 3-23. PMSM Electromagnetic torque ^

_ -, o., ^ ^ , r Figure 3-24. Waveforms o f actual estimated (Rs~*2Rs, SPWM).

. and

(Rg-2R3,SPWM).

6 7

R e p r o d u c e d with p e r m i s s io n of th e c o p y rig h t o w n e r . F u rth e r r e p ro d u ctio n p rohibited w ithout p e rm is s io n .

f
f

(a)

Speed reference, actual and estimated rotor speeds.

(b) Error between actual and estimated rotor speeds.

Figure 3-25. Response of actual and estimated rotor speeds ( ^r~*0.8 2^, SPWM).

......... i.................L......I....... ;...... ^ : i : ! ; 1 '· · · ' 0j# 4...................................... 1 J

;



V

J l .....;.. .......................................... ;....... :......... i : : : . ____i__...a.........;____.........'..... : :------5 :------1 :------,----: «U ----- 1 ------1 i------i-----((sec)

t(seo)

(a) Actual and estimated rotor positions.

(b)

Error between actual and estimated rotor positions.

Figure 3-26. Waveforms of actual and estimated rotor positions ( -^r~"0.8 2,., SPWM).

......Jr......
0 m m ...

Figure 3-27. PMSM Electromagnetic torque

/l,,SPWM).

Figure 3-28. Waveforms of actual 7^ and estimated ( 2, . -- -0.8 2 , S PWM).

6 8

R e p r o d u c e d with p e r m i s s io n of t h e c o p y rig h t o w n e r . F u rth e r r e p r o d u c tio n prohibited w ithout p e r m is s io n .

Figure 3-26(a) shows the actual and estimated rotor positions. The rotor position error is shown in Figure 3-26(b). The average steady-state position error is (-13°)/360°=3.61% at 1200 rad/s, and 67360°=1.67% at -500 rad/s. Figure 3-27 shows the PMSM electi'omagnetic torque and Figure 3-28 shows the waveforms of actual and estimated stationary current and

3.2.3

Elimination of the Fliix-Linkage Corrector

As references [19, 20] reported, the sensibility to electrical parameters uncertainty has been a disadvantage of the PMSM EKF sensorless control. Particularly, the EKF estimation is sensitive to the permanent magnet flux-linkage error, which causes speed estimation inaccuracy. When the rotor flux-linkage is decreased, the unchanged flux-linkage in EKF model will be larger than that of the rotor. The EKF estimator cannot distinguish the error of the motor flux-linkage from the eiTor of estimated speed. Hence the estimated speed in EKF has to be adjusted down to keep the balance of the estimated and measured current. Therefore, the estimated speed will be less than the actual speed. As a result, the actual motor speed will be larger than the speed reference. Figure 3-29 shows the speed reference, actual and estimated speeds when the rotor flux-linkage is weakened 10%. It can be noticed that the actaal speed is 10% higher than the speed reference. To solve this problem, a close-loop on-line flux-linkage corrector was proposed in literature. The detailed principle and design of this corrector ar'e presented in references [19, 20]. The corrector is triggered to correct the flux-linkage error after the successful convergence of the EKF. However, the Judgment of the successful convergence of the EKF is still a problem. The misjudgment of the convergence may trigger the flux-linkage corrector incorrectly, and may cause the system failure. Moreover, the weighted integral inside the corrector has to be tuned to avoid interference with the speed closed-loop dynamic. Otherwise, it may impact the control stability.
6 9

In addition,

R e p r o d u c e d with p e r m i s s io n of t h e c o p y rig h t o w n e r . F u rth e r re p r o d u c tio n pro h ib ite d w ith o u t p e r m i s s io n .

MOO

i~ I 1 0 0 0
800 600 400

!..

200

-400 -600

. .. ; . .

Figure 3-29. Speed reference, actual and estimated rotor speeds ( -'^r~*0.9 2-,.,SPWM, no flux-linkage corrector, EKF parameters from references).

Table 3-2. The simulation results of the steady-state speed and position eri'ors to PMSM parameter variations

Normal Speed reference (rad/s) Steady-state speed error ~ Inn \ / 0j A iUU -0.917 -2.0 1 .0 1200

-500

1200

-500

1200

-500

1200

-500

- 2 .0

-1.083

- 2 .0

0.25

- 0 .6

Steady-state position error Xl00(%) -3.611 2.778 -3.611 2.778 -3.889 2.222 -3.611 1.667

360°

7 0

R e p r o d u c e d with p e r m i s s i o n of t h e c o p y rig h t o w n e r . F u r th e r r e p r o d u c tio n p ro h ib ite d w ith o u t p e r m i s s io n .

the on-line corrector increases the computation steps.

The robustness research in Sections 3.2.2 unveils that the reported problem can be solved by tuning the matrix parameters of the PMSM EKF model instead of the on-line flux-linkage correcting.

The matrices of PMSM EKF model shown in 2 -17(b) are Matrix_R, MatrixjQ, Matrix_X and M atrixjP. Initial Matrix_X is the state vector Zo, which has been preset to the null vector. Initial Matrix_P is tire matrix Po in computation process. In EKF calculations, MatrixJR. and Matrix Q are constant covariance matrices R and Q. The decision of the elements of the matrices R, Q, and Pg are based on trial-and-error procedures [15, 16]. Since the P q is verified the less influent matrix in the initial EKF tuning procedure, the matrices R and Q become the key points of the EKF tuning. When the matrices are chosen as

R--

1 0 0 1

0 '8000 0 8000 Q= 0 0 0 0

0 0 ' 0 0 0 ; ^0 = 1200 0.01 0

'10 0 0 10 0 0 0 0

0 o' 0 0 200 0 0 10

(3.4)

the PMSM EKF estimator would not be sensitive to the motor parameter variations.

The simulations in this chapter are based on above matrices. From the research in Section 3.2.2 and 3.2.3, it can be concluded that the flux-linkage variations can be corrected by EKF model itself if proper matrix parameters are applied. The elimination of the reported on-line flux-linkage corxector not only improves the control stability, but also decreases the total computation time.

3.2.4

Sum m ary

In tlris section, the robustness of the proposed EKF PMSM sensorless drive system is
7 1

R e p r o d u c e d with p e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u r t h e r r e p r o d u c ti o n p ro h ib ite d w ith o u t p e r m i s s io n .

simulated in case of motor electric paiameter changes. Two types motor electric parameter variations including stator winding resistance variation and rotor flux-linkage variation are researched. The simulation results are summarized in Table 3-2, from which the following conclusion can be drawn: 1) The proposed EKF sensorless control algorithm is robust to the PMSM electric parameter variations. The maximum steady-state rotor speed error is 2.0% and the maximum steady-state rotor position eiTor 3.9%, which are acceptable in most engineering applications. 2) The on-line flux-linkage correcting reported in literature can be eliminated through tuning tlie matrix parameters of the EKF model. This advancement improves the stability of the control system and decreases the overall control computational time.

3.3

Startup Transient

The aim of tlris section is to investigate the startup transient of the proposed EKF PMSM sensorless drive system at different rotor initial positions. The overall 12 potential rotor initial positions of the PMSM are simulated. The control diagram (Figure 2-23) with the SPWM inverter is used for investigation,

3.3.1 Startup at Different Positions
Because the 4 poles prototype PMSM (Appendix B) has 24 potential positions when it is standstill, totally 12 electrical initial positions, from 0° to 330° with step of 30°, should be investigated.
7 2

R e p r o d u c e d with p e r m i s s io n of t h e c o p y rig h t o w n e r . F u rth e r r e p r o d u c ti o n pro h ib ite d w ithout p e r m i s s io n .

Figure 3-30(a) shows the waveforms of speed reference, actual and estimated speeds when the initial rotor position is 0°. The estimated speed converges to the actual one in about 0.12s. Figure 3-30(b) shows the actual and estimated rotor positions and their enor. Excluding the convergence period, the average ti'ansient position error is 77360°=!.94%. Total simulation results of startup transient of the proposed PMSM EKF sensorless control are attached in Appendix D.

3.3.2

Cancellation of Divergence Corrector

From the PMSM mathematics equations (2.64) and (2.65), it can be recognized that the motor voltage equations admit two acceptable solutions, the conect solution ( and the wrong one ( ^ g+ ^ ). Although the wrong solution does not fit

dt

--Np-Cû^ of the state equation (2.67), the EKF estimations still converge to it,

because the innovation step always remedies for the wrong position predicted value. This phenomenon is called divergence or convergence problem. As references [15, 16, 18] reported, the computation divergence at startup procedure is a disadvantage of the PMSM EKF estimator in sensorless contiol.

To solve tlie problem, references [15, 16] proposed an on-hne corrector. The corrector will not work till the EKF convergence period is completed. The element Q(4,4) can be used to indicate the end of the convergence when it becomes sufficient small. The correcting process is;

7 3

R e p r o d u c e d w ith p e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u r th e r r e p r o d u c ti o n p ro h ib ite d w ithout p e r m i s s io n .

£

I

I

t(ssc)

(a) Speed reference, actual and estimated rotor speeds.

(b) A ctual and estimated rotor positions and their error. (u/).

Figure 3-30. Waveforms of speeds and positions of the startup (Initial position: 0°, Tl
1000

&

800

400

-400

0.1

0.2

0.3

0.4

0.5 t(sec)

(a) No divergence corrector.

(b) Using divergence corrector.

Figure 3-31. Speed reference, actual and estimated speeds at startup divergence.

Î e
I
£ ten

(a) Speed reference, actual and estimated rotor speeds.

(b) Actual and estimated rotor positions and their error.

Figure 3-32. Speeds and positions o f the startup (Initial position: 90°, Rated load).

7 4

R e p r o d u c e d with p e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u rth e r r e p r o d u c ti o n p ro h ib ite d w ith o u t p e r m i s s io n ,

1) to wait the EKF convergence till the Q(4,4) is sufficient small,
2)

to test whether the estimated speed Np 6;,-coincides with

dt

, and

3)

if

Np

and

dt

are coincident, the divergence does not happen;

if they are not coincident, the corrector reverses the wrong speed and corrects the false angle, where ( replaces ( u;,., 9 in the state vector.

Figure 3-31(a) shows the waveforms of the speed reference, actual and estimated speeds when a divergence happens. Figure 3-31(b) shows the waveforms of the speed reference, actual and estimated speeds with a coixection of the divergence corrector.

However, in the correcting stepl, the "sufficient small" Q(4,4) is not a certain value. This uncertain judgment of the convergence may cause incorrect operation of the corrector. The stability of the system is therefore influenced. Moreover, the corrector increases the total computational time.

From the simulations research, it was found that proper choice of the EKF matrix parameters could prevent the occurrence of the startup convergence problem. The simulation results shown in Appendix D are based on the matrix parameters of equation (3.4). In total 12 startup simulations, half of them appear speed deviation, in which the PMSM rotate reversely a little at the very beginning due to the unknown initial rotor positions, and then rapidly spins to the correct direction. The results illustrate that the EKF estimator is able to correct the divergence automatically.

7 5

R e p r o d u c e d with p e r m i s s io n o f t h e c o p y r ig h t o w n e r . F u r t h e r r e p r o d u c tio n p ro h ib ite d w ith o u t p e r m is s io n .

3.3.3

Removal of the Startup Current Pulse Injection

As reference [19] reported, tire stall condition happens when the rotor lies in an unstable equilibrium point, where motor cannot or hardly startup. In PMSM sensorless control, if the initial rotor position error is close to ±90°, the delay of the startup arises because the ±90° position error causes the swap of the feedback flux and torque current components. For example, the initial estimated position is 0 = 0°, wliile the actual rotor position is - 90°. By using the biased rotor position, the ap to dq transformation maps the actual {Id, Iq) couple as a wrong {Iq, - I p feedback to the control loop. Usually, the PMSM control uses a null <i-axis current reference / / , while the g-axis current reference Iq* is delivered by the speed controller (PMSM control method 1, h=0. Section 2.5). As a result of this initial position error, a null torque current component is produced. The motor hence cannot be started.

To solve this problem, an Id transient current pulse has been proposed [19]. The purpose of the current pulse is designed to prevent the situation that Iqis delivered to 0. The ûf-axis cunent reference is given by (3.5) where Iiq is the rated current, and Ta is the motor electrical time constant. However, this current pulse influences the startup procedure of other initial positions and makes the control system complex.

From the startup simulations, it was found that the EKF model could converge to the actual speed and position rapidly at any initial rotor position when the matrix parameters in EKF model are properly tuned. The simulation shown in Figure 3-32 reports the EKF

7 6

R e p r o d u c e d with p e r m is s io n of t h e cop y rig h t o w n e r . F u rth e r r e p ro d u ctio n pro hibited w ithout p e rm issio n .

is able to startup from the stall condition (+90°) when the load is the rated torque. Figure 3-32(a) shows the waveforms of the speed reference, actual and estimated speeds when the load is the rated torque and the initial rotor position is 90°. Figure 3-31(b) shows the waveforms of the speed reference, actual and estimated speed. From the simulation results in Appendix D and Figure 3-32, it can be concluded that EKF with proper matrix parameters can startup from stall conditions without the help of the current pulse injection. The removal of the current pulse improves the system startup capability, and decreases the total computational time.

3.3.4 Summary
In this section, the startup transient of the proposed EKF PMSM sensorless drive system at different rotor initial positions is investigated. The overall 12 potential rotor initial positions of the PMSM are simulated. From the simulation results, it can be concluded that: 1) The proposed EKF sensorless control algorithm can start the PMSM at any initial rotor position. 2) The reported divergence corrector whose purpose is to solve the convergence problem is eliminated tlirough a proper tuning of the EKF matrix parameters. This improvement has enhanced the stability of the system and decreased the computational time. 3) The reported startup current pulse whose purpose is to avoid the stall condition is removed by tuning the EKF matrix parameters properly. Tins progress has improved the start capability of the proposed EKF sensorless algoritlim and simplified the overall control system.

7 7

R e p r o d u c e d with p e r m is s io n of t h e co pyright o w n e r . F u rth e r r e p ro d u ctio n prohibited without p e r m is s io n .

3.4

Conclusions

In this chapter, the performance of the proposed PMSM EKF sensorless drive system is investigated in detail. The investigation can be classified into three categories: 1) steady-state performance of the drive system operating with various types of mechanical loads, 2) robustness of the control algorithm to tire motor parameter variations, and 3) start-up transient when the drive starts at various initial rotor positions. Based on a set of comprehensive simulation studies, the following conclusions can be made.

1) The proposed sensorless drive system can operate satisfactorily under any load conditions. This is achieved in part by the proposed EKF speed/position estimation algorithm, which can detect the rotor speed and position quite accurately based on measured motor voltages and currents.

2) The drive system is insensitive to the variations in stator winding resistances and rotor flux-linkage. This is achieved through the proper tuning of the matrix parameters in the proposed EKF algorithm.

3) The drive system can start at any initial rotor position without using startup current pulse injection as proposed in literature. The developed EKF algorithm has the capability to handle the startup instability problems. With the proper tuning of the EKF matrix parameters, the PMSM can start from standstill with any initial rotor positions.

R e p r o d u c e d with p e r m i s s io n of t h e co pyright o w n e r. F u rth e r re p ro d u c tio n prohib ited w ithout p e rm issio n .

Chapter 4

Experimental Verification
Tills chapter presents the experimental verification of predicted results obtained through computer simulations in Chapter 3. The configuration of the experimental set-up (both hardware and software platform) is described in detail. The details of the dSPACE integrated hai'dware/softwai'e environment for the implementation of the proposed EKF sensorless control method are presented. The accuracy of estimated rotor speed and position in proposed PMSM drive system is verified. The system robustness is investigated. The drive startup hansients at valions initial rotor positions are tested, ar d the drive system performance is verified experimentally.

The contents of this chapter are as follows: Section 4.1 introduces the hardwai'e design and implementation of the EKF algorithm, Section 4.2 introduces the dSPACE software design for the proposed sensorless control. Section 4.3 presents the experimental results, and Section 4.4 concludes Chapter 4.

7 9

R e p r o d u c e d with p e r m i s s io n of t h e cop y rig h t o w n e r. F u rth e r r e p ro d u ctio n prohibited w ithout p e rm is s io n .

4.1

Hardware Implementation

In this section, the experimental hardware implementation of the PMSM EKF sensorless control is introduced. The dSPACE based hardware configuration of tlie control system is shown in Figure 4-1.

The Motor-Generator (M-G) Set in Figure 4-1 consists of a PMSM and a brushless DC generator (BLDCG) as a mechanical load for the PMSM. The generator delivers the generated power to a three-phase resistive load. Both of motors har^e shaft position sensors. Since these two motors are mounted together, sensors of each motor can be used to obtain the information of the position and the speed. The specifications of the M-G set are attached in Appendix B.

The DC supply in Figure 4-1 provides the electrical power to the inverter. In the actual experimental setup, it is a 300V, 50A variable DC power supply.

The Intelligent Inverter in Figure 4-1 converts the DC power into three-phase voltages with variable amplitude and variable frequency to chive the PMSM. In this experimental design, the Intelligent Inverter is a new-generation integrated intelligent IGBT power module, SEMIfCRON SkiiP342GD120-314CTVU. It provides many intelligent functions, such as, isolated drivers, DC voltage sensing, three-phase currents sensing, temperature sensing, short circuit monitoring, over current protection and over temperature protection. The detailed specifications are given in Appendix C.

The Dynamic Break in Figure 4-1 works as a protection circuit. When motor is commanded to slow down or rotate reversely, the kinetic energy of the rotor is changed into electric energy and fed back into the DC bus by the inverter. The DC capacitors as

8 0

R e p r o d u c e d with p e r m i s s io n of t h e co p y rig h t o w n er. F u rth e r re p ro d u c tio n prohibited w ithout p e r m is s io n .

DC Supply

intelligent Inverter
Current Sensing . . DO Voltage Sensing   Temperature Sensing Error Sensing

PMSM \ Motor-Generator set
3-phase load

Generator

j-- W \ / --

PWM Drive i:

-- W V~" ^ --w v --

Dynamic Break

Hardware Interface

Haii EfiecI Sensor

dSPACE Board D S1103

PC

Figure 4-1. Hardware implementation of the PMSM EKP sensorless control.

Halt Sensing
H .1 ILA H.1 1 I.B HnlLC

Current Vdc Sensing Sensing ia ib io Vdc

Temperature Error Sensing Sensing
O T E lr_ C E rr.B Err.A

3-Phase PWM Drive AH AU BH BLCH CL

BullarS.
C onditionei

Over Temperature

OR
Buffer & Conditioner Buffer & Conditioner Suiter & Rectiiier Over Voltage

Error

PWM Disable >=

OR

Over Current

PWM Signal Voltage Level Shifter

>=

Vrel AHALBH SUCH CL

too

1010

102

AOC17ADOiaADOI9 ADO20

iOi

To PIO

To ADC

To PIO

From PIO

Figure 4-2. Hardware Interface for dSPACE implementation.

6]

R e p r o d u c e d with p e rm is s io n of t h e cop y rig h t o w n e r . F u rth e r re p ro d u c tio n prohibited w ithout p e r m is s io n .

well as the IGBT modules may be damaged under tlris surge voltage. The dynamic break circuit switches a resistive load into the chcuit when the over voltage of the DC bus happens. As a result, the regenerated electric energy is consumed on the resistor. Once the DC voltage falls into the normal range, the dynamic break circuit will disconnect the energy-consuming resistor. Hence the DC voltage is protected in a safe range.

The dSPACE Board and the PC blocks in Figure 4-1 are the control parts of the implementation. PC compiles the software of the control algorithm and downloads it into the dSPACE board. The dSPACE board executes the downloaded instructions and realizes the real-time control.

The details of Hardware Intetface board are shown in Figure 4-2. The signals from Hall effect sensors are buffered and conditioned for dSPACE PIO. The analog values of the three-phase currents /«, 4 and Ic from inverter are processed for botli dSP/iCE analog-digital ports (ADC) and over-current protection circuits. Similarly, the DC voltage is processed for both dSPACE ADC and over-voltage protection circuits. As shown in Figure 4-2, any error signal from inverter or interface itself can disable the PWM signals, at the same time the running software is halted by 101 of the PIO. The voltage level of PWM signals from dSPACE Board is 5V. The PWM Signal Voltage Level Shifter block functions to shift the PWM voltage level from 5V to 15V, which is the requirement of the intelligent inverter.

4.2

Software for Real-time Implementation

8 2

R e p r o d u c e d with p e r m i s s io n of th e c o p y rig h t o w n e r . F u rth e r r e p ro d u ctio n prohib ited w ithout p e r m is s io n .
I

In this section, the experimental software structure of the dSPACE based implementation of the EKIF PMSM sensorless drive system is introduced. A merit of using dSPACE conti'oller to implement the control algoritlim is that the dSPACE Real-Time Interface (RTI) can effectively convert MATLAB Simulink diagrams into dSPACE hardware instructions. This function provides a shortcut to implement a Simulink based control algorithm and expedites the process of prototyping substantially. Considering the particular hardware, such as analog-digital (A/D) and digital-analog (D/A) I/Os, series I/Os, parallel I/Os and PWM generator, special definitions or modifications to the Simulink models are needed when the Simulinlc diagram is going to transfer to dSPACE instnrctions. The software for the experiments is developed based on the proposed EKF PMSM sensorless control algorithm shown in Figure 2-23. The implemented dSPACE block diagram is shown in Figure 4-3.

In the dSPACE block diagram, the Switch 1 block provides the speed reference to the system. From the start moment to the preset time, Switch 1 keeps sending out the instructions of the Speed Reference block. After the preset meurent, Switch 1 switches to the output of the Speedjref block that is coded by the Model Parameters block. The Speed Reference block can be re-coded to generate different speed references.

The Speed+Current Controller block in Figure 4-3 performs the mixture functions of the Speed Controller and Current Controller blocks shown in Figure 2-13 and Figure 2-14, respectively. It produces reference currents {Id and 7^*) from the error between the actual and estimated speeds inside tire block, and generates the voltage components in arbitrary frame {Yd* and F^*) from the errors between reference currents and measured currents.

Blocks Vdci-Vcibc, labcjdq and Cos_Sin_Theta in Figure 4-3 hansforrn the voltage components from the arbltiary (dq) frame to the stator (abc) frame. The fbcjdq block

R e p r o d u c e d with p e r m i s s io n of t h e c o p y rig h t o w n e r . F u rth e r re p r o d u c tio n pro h ib ite d w ith o u t p e r m is s io n .


RTW _M olor_lO

Halljft HaRjlK*ta |-|fc PLL

PLL_Hall

S p e e d + C u iie n t C onliolle: M o d e l P ard m e tet?

V dq_V abo

\.h'ph3

ls{phaI_out

Figure 4-3. dSPACE implementation of PMSM EKl" sensorless control.

R e p r o d u c e d w ith p e r m i s s io n of t h e c o p y r ig h t o w n e r . F u rth e r r e p r o d u c tio n p ro h ib ite d w ith o u t p e r m i s s io n .

transforms the current components from the stator {abc) frame to the aibitrary {dq) frame. The Cos_Sin_Theta block provides proper triangular functions to blocks Vdq_Vabc and
la h c jd q -

The transformations are based on equations (2.42) and (2.43).

The ABC_ab block in Figure 4-5 transforms cunent and voltage components from the stator {abc) frame to the stationary { aP) frame, respectively. The transformations are based on the equations (2.40).

The EKF_Estimator block in Figure 4-3 is the proposed extended Kalman filter (EKF) providing the estimations of the speed and position to the control loop. The details of this EKF estimator are shown in Figure 2-17.

The D SllO SD A C jO l block transforms the digital-based estimated rotor position into an analog signal that could be captured by the oscilloscope. The actual position information is obtained from the signals of Hall effect sensors, which are processed through blocks PLLJtiALL, PLL and Gain2. The DS1103DAC_C2 block then provides the analog signal of tire actual position to the oscilloscope.

The RTW_Motor_IO block in Figure 4-3 is the Real-Time Workshop lOs for the PMSM. It functions of collecting DC voltage, generating PWM drive signals, collecting signals of Hall effect sensors, collecting three-phase currents and protecting the whole system. The DC voltage is sensed and conditioned for the calculation in this block. Based on this voltage value, the three-phase stator frame voltages from the Vdq_Vabc block are calculated to obtain three duty-cycle vectors. The computation equation of obtaining duty-cycle vectors is based on the reference [33]: Dnfy _ CycZg(yj = 1 (1 -h
2

U.j · Kjp

,

(4.1)

8 5

R e p r o d u c e d w ith p e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u r t h e r r e p r o d u c ti o n p ro h ib ite d w ith o u t p e r m i s s io n .

where V^ = V^,

or

These three duty-cycle vectors are transformed into PWM waveforms by the RTW_Motor_TO block to chive the three-phase inverter. At the same time, the signals from Hall effect sensors are collected and conditioned, and then delivered to the PLL_HALL block to obtain the actual position. The three-phase currents of the inverter are simultaneously collected, conditioned and fed back to the current loop and the EKF estimator. The error signal from interface board is detected in the RTW_Motor_IO block to protect the system. Whenever the active error signal is detected, the RTW_Motor_IO block will disable the three-phase PWM outputs and halt the entire running program.

4.3

Experimental Results

Experiments for PMSM EKF sensorless control are presented in this section. All experiments are based on three-phase 8-ohm resistance loads connected to the BLDC generator shown in Figure 4-1.

4.3.1

Accuracy Test

Speed and position accuracy tests for the proposed PMSM control algorithm are presented in this subsection.

86

R e p r o d u c e d with p e r m i s s io n of t h e c o p y r ig h t o w n e r . F u r th e r r e p r o d u c tio n p ro h ib ite d w ith o u t p e r m i s s io n .

Speed Accuracy Test
The speed accuracy experiment of the proposed PMSM EKF sensorless control is based on the diagram shown in Figure 4-3. The output of Switch 1 is the speed reference The speed output of the PLL block is the measured "actual" speed < ^aci- The Gam block transforms the estimated speed of EKF from radian per second (rad/s) into revolution per second (rpm). The output of Gain is sampled as the estimated speed

Figure 4-4(a) shows the waveforms of the (O ref, ^act aiid

The

is preset as a

step-down waveform so as to research the different steady-state speed accuracies in one experiment. The step values are 5000 ipm, 3000 rpm, 1000 rpm and 200 rpm. Figure 4-4(b) shows the speed error act- ^ est- The average steady-state speed error is

-5/5000=-0.I% at 5000 rpm. -5/3000=-0.167% at 3000 rpm, -10/1000=-!% at 1000 rpm, and -20/200=-!0% at 200 rpm. The absolute value of average steady-state speed error increases as the speed decreases because of the influence of tlie chopping noise and the dead tmie of SPWM drive. Above results ai-e listed in Table 4-1.

From Figure 4-4(b), the larger errors happen at the transient periods. The results match those of simulations in Chapter 3. However, the Hall effect sensors only can accurately detect 6-fixed position information, 0°, 60°, 120°, 180°, 240° and 300'. Other position information is obtained from the integral process in present experimental setup. Hence the "actual speed" measured from Hall effect sensors is not accurate enough during transient period. The dynamic transient of the proposed control algorithm could not be researched under the condition of using Hall effect sensors in this thesis.

From the results of experiments, it can be concluded that the proposed PMSM EKF sensorless control has good speed control accuracy, except at low speeds.

8 7

R e p r o d u c e d w ith p e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u r th e r r e p r o d u c ti o n p r o h ib ite d w ith o u t p e r m i s s io n .

Û J ,

2

300

t( s e c )

(a) Speed reference, actual and estimated rotor speeds.

(b) En'or between actual and estimated rotor speeds.

Figure 4-4. Response of actual and estimated rotor speeds of speed accuracy tests

Table 4-1. Speed errors of the experiment for speed accuracy.

Speed reference m . (rpm) Steady-state speed error û)^,, Steady-state speed error ratio xioO(%) (rpm)

5000 -5

3000 -5

1000 -10

200 -2 0

-0.1%

-0.167%

-1%

-10%

Ml

Ml

1 ^ 5 .0 0 V CR5 CFÏ3 SO.OmV M a th i 5 .0 0 V

5 .0 0 V

M 2 .0 0 m s

C hi V

V HOEJ 2 0 .o m V M a th i 5 .0 0 V 10.0ms

liilO .O m s

C hi j ' ' ' mV 2 0'0'

(a)

Rotor speed at 5000rpm.

(b) Rotor speed at lOOOrpm.

Figure 4-5. Actual position, estimated position, position error and stator phase-current o f position accuracy tests.

R e p r o d u c e d with p e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u r th e r r e p r o d u c ti o n p ro h ib ite d w ith o u t p e r m i s s io n .

Position Accuracy Test The position accuracy experiment of the proposed EKF sensorless control is still based on the diagram shown in Figure 4-3. The measured "actual" position is calculated through the PLL block, and transformed into the analog signal through the dSPACE D/A port DS1103DAC_C2, then captured by the oscilloscope. The estimated position waveform form EKF estimator is transformed into the analog signal through the dSPACE D/A port DS1103DAC_C1, and shown on the oscilloscope as well.

Figure 4-5 (a) shows the v/aveforms of the measured actual position 9^^, the estimated position the error 0^^, Üie state winding current at speed of 5000 rpm.

The waveforms of CH I, CH2, MATHI and CHS of the oscilloscope represent the 0^^,,

and 7:4, respectively. In Figure 4-5(b), the 0,^, 0,^, 0,,, - 0 ^ and 7^
are shown when the speed is at 1000 rpm. In the experiments, as the speed decreases, the influence of the inaccuracy of Hall effect sensors increases. Hence the experiments at lower speeds were not researched under the present hardware conditions.

The steady-state position errors shown in the Figure 4-5(a) and (b) are about 47360°=1.111% at 5000 rpm, and 37360°=0.833% at 1000 rpm. Therefore, it can be concluded that the proposed PMSM EKF model is accurate in position estimation.

4.3.2

Robustness Test

To test the system robustness, four experiments aie designed based on the control diagram o f Figure 4-3 in this subsection. Since it is not practical to change the motor
8 9

R e p r o d u c e d with p e r m i s s io n of t h e c o p y r ig h t o w n e r . F u r th e r r e p r o d u c tio n pro h ib ite d w itho ut p e r m i s s io n .

parameters in experiments, an easy way to test the robust features is to keep the motor actual parameters unchanged, while change the parameters of the PMSM model in EKF model. For example, we can reduce the motor stator winding resistances in EKF model to half, at the same time keep the actual stator winding resistances of the PMSM unchanged. This is equivalent to the situation keeping motor parameters in EKF model unchanged and doubling the stator winding resistances. Based on this method. Figure 4-6(b), Figure 4-6(c) and Figure 4-6(d) are designed to simulate the cases of doubling the stator winding resistances, increasing 10% of the rotor flux-liv,!. age and decreasing 20% of the rotor flux-linkage.

Test 1: No parameter changed
The waveforms of the speed reference actual speed ^act and estimated speed ^est

ai'e shown in Figure 4-6(a) without any motor parameter changes.

Test 2: Stator resistance doubled
To simulate this condition, the stator winding resistances in EKF model are reduced to half. It is equivalent to doubling the stator resistances (Rs-^2Rs) in PMSM. The

experimental waveforms are shown in Figure 4-6(b).

Test 3: Rotor flux-linkage increased 10%
To simulate this condition, tire rotor flux-linkage in EKF model is decreased to 88.89%. This is equivalent to the rotor flux-linkage increased to 110% ( 4^--iio% The experimental waveforms are shown in Figure 4-6(c). in PMSM.

Test 4: Rotor flux-linkage decreased 20%
To simulate this condition, the rotor flux-linkage in EKF model is increased to 125%. It is equivalent to the rotor flux-linkage decreased to 80% ( 4^->-80% 4,.) in PMSM. The

9 0

R e p r o d u c e d with p e r m is s io n of t h e co p y rig h t o w n er. F u rth e r rep ro d u ctio n prohibited w itho ut p e r m is s io n .

t( s e c )

(a) No motor parameter change.

(b) Stator winding resistance in EKF model reduced to half (equivalent to Rs ~^2Rs PMSM). in

3000

t( s e c )

(c) Rotor flux-linkage in EKF model decreased 11.11% (equivalent to 110% in PMSM).

(d) Rotor flux-linkage in EKF model increased 25% (equivalent to d^--- §0% d^ in PMSM).

Figure 4-6. Response o f actual and estimated rotor speeds of robustness tests.

9 1

R e p r o d u c e d with p e r m i s s io n of t h e cop y rig h t o w n er. F u rth e r rep ro d u ctio n prohibited w ithout p e rm issio n .

experimental waveforms are shown in Figure 4-6 (d).

Since the Hall effect sensors in present setup cannot detect the negative speed, the measured "actual" speeds in Figure 4-6(a), 4-6(b), 4-6(c) and 4-6(d) indicate zero when the motor is rotating reversely. Hence the speed errors (^act during the period of

negative speed could not be accurately obtained. In actual experiments, the waveforms of < ^act - ^est from 0 ipm to 5000 rpni are the same as the relative part of Figure 4-4(b).

The average steady-state errors of these four tests are 5/5000=0.1% at 5000 rpm. Therefore, it can be concluded that the proposed PMSM EKF sensorless control is not sensitive to the motor parameter variations. From the results of tire simulations, the system robustness is verified. Moreover, the improvement of eliminating on-line rotor flux-linkage corrector is approved.

4.3.3

Startup Transient

The rotor of the 4-pole prototype PMSM (Appendix B) has 24 potential standstill positions. Therefore, it has 12 electi'ical initial rotor positions, 0°, 30°, 60°, 90°, 120°, 150°, 180% 210% 240% 270°, 300° and 330°.

To verify the startup feature, all potential standstill positions were tested in experiments. Figure 4-7(a) shows the speed waveforms of the startup procedure when the rotor initial position is 0°. The speed reference <^rcf provides a step command at the time of 1.0s. The estimated speed converges to tire actual speed < ^act in a short time period.

Hence tire motor starts from that moment smoothly.

92

R e p r o d u c e d with p e r m is s io n of t h e c o p y rig h t o w n er. F u rth e r r e p ro d u ctio n prohibited w ithout p e rm issio n .

'eu
t(seo )

(a) Rotor initial position at 0°.

(b) Rotor initial position at 90°.

i( s e c )

(c) Rotor initial position at 180°. Figure 4-7. Speed waveforms of startup transient.

9 3

R e p r o d u c e d with p e r m is s io n of t h e co p y rig h t ow ner. F u rth e r rep ro d u ctio n prohibited w ithout p e rm issio n .

Initial rotor positions at ±90° are called stall conditions in the literature where the PMSM cannot be easily started by the control method ld=0. A cunent pulse injection reported in the literature was needed to help tire motor to start at these positions. However, the simulations in previous chapter have verified that the control algorithm proposed in this thesis can start the motor at stall conditions by tuning the matrix parameters of the EKF estimator. Figure 4-7(b) shows the experimental waveforms ^act and

of the startup transient when the initial rotor position is 90°. From the waveforms, it can be concluded that without the help of the current pulse injection, the ojest converges to the o^act as fast as the process of starting from 0°. Hence it is verified that the startup current pulse injection to prevent stall conditions can be cancelled.

In the literature, tire startup procedure sometimes occur convergence problem, or so called divergence. To solve tlris problem, a divergence corrector is used in practice, especially when the initial rotor position is at 180°. But the simulation research in Chapter 3 of this thesis unveils that tire divergence corrector is negligible. Figure 4-7(c) shows the experimental waveforms < ^ref, ^aci and < ^e.u when motor starts from the initial rotor position 180°. hr the actual experiment, the motor rotates to the wrong direction at the beginniirg. After running about 60°, it chairges back into the correct direction and then rotates in expecting. Since the Hall effect sensor in this experiment set-up cannot detect the negative speed, this process cannot be observed from the waveform of It is

found that the start procedure at initial position of 180° is longer than those of previous tests. The reason is that the control algorithm needs extended time to correct the divergence. However the time extension is acceptable. The waveforms of ovearall startup transient tests are collected in Appendix E.

In Figure 4-7(a), (b) and (c), the measured "actual" speed waveforms are not smooth at the very beginning. This is caused by using Hall effect sensors to detect actual speed. The

9 4

R e p r o d u c e d with p e r m i s s io n of t h e co pyright o w n er. F u rth e r r e p ro d u ctio n prohibited w ithout p e rm issio n .

Hall effect sensors only can accurately detect 6-fixed position information. Other position information is obtained from the integral process in present setup. This can explain why the rotor speed detected by Hall effect sensors is not accurate at low speeds or transient periods. Especially, when the motor is at standstill, the Hall effect sensors cannot acquire the correct information of actual position.

Based on the startup tests, it can be concluded that the proposed control algorithm can start the motor from any initial position without special EKF divergence conector or stall condition avoidance current pulse.

4.4

Conclusions

The performance of the proposed PMSM EKF sensorless drive system is experimentally investigated in this chapter. The experiments can be classified into three categories: 1) steady-state performance of the drive system, 2) robustness of the control algorithm to the motor parameter variations, and 3) start-up transient when the drive starts at various initial rotor positions. Based on the experimental results, the following conclusions can be made:

1) The proposed sensorless drive system can operate satisfactorily with good control accuracies. The maximum rotor speed error is only 1.0% (except at very low speeds) and the maximum rotor position error is 1%, which are acceptable in most engineering application.
9 5

R e p r o d u c e d with p e r m i s s io n of t h e cop y rig h t o w ner. F u rth e r re p ro d u c tio n prohibited w ithout p e rm is s io n .

2) The drive system is insensitive to the variations in motor parameters such as the stator winding resistances and rotor flux-linkage. Hence the elimination of rotor flux-linkage corrector is achieved.

3) The drive system can start at any initial rotor position without using startup current pulse injection as proposed in literature. Due to the proper tuning of matrix parameters of the EKF model, the rotor position divergence can be effectively corrected in the experiment.

9 6

R e p r o d u c e d with p e r m i s s io n of t h e cop y rig h t o w n e r. F u rth e r r e p r o d u c tio n prohibited w ith out p e r m is s io n .

Chapter 5

Conclusions
111

this thesis, the modeling, analysis, design and experimental validation of a robust

sensorless control method for permanent magnet synchronous motor (PMSM) based on Extended Kalman Filter (EKF) to accurately estimate rotor speed and position has been presented. A MATLAB/Simulink based dynamic model for the PMSM has been developed which allows the user to arbitrarily adjust the initial rotor position. A real-time EKF-based. model in closed-form for the integrated PMSM drive system including all the power electronics and associated digital controls circuitry has been developed and implemented on an actual laboratory prototype. Detailed systematic computer simulations and analyses of the proposed EKF sensorless PMSM drive system have been presented which validate the robustness and accuracy of the proposed sensorless method. Predicted results obtained by computer simulations have been experimentally verified..

The Major Contributions of the Thesis Include:
1) Elimination of rotor flux-linkage corrector An on-line rotor flux-linkage corrector reported in the literature was required due to the sensitivity of the EKF estimator to the changes of rotor flux-linkage. The sensorless control algorithm proposed in this thesis has improved the robustness of the EKF estimation so that the rotor flux-linkage corrector reported in the literature can be eliminated.

2)

Cancellation of EKF divergence corrector

97

R e p r o d u c e d with p e r m i s s io n of t h e cop y rig h t o w n e r . F u rth e r r e p r o d u c tio n p rohib ited w ith o u t p e r m i s s io n .

An EKF divergence corrector was needed because the PMSM sensorless control method reported in the literature suffered from initial rotor position/speed convergence problems. A robust EKF sensorless PMSM drive system has been proposed in this thesis which can prevent any divergence problems at the beginning of the startup process without a need for any additional circuit.

3)

Removal of the startup current pulse injection The startup current pulse injection has been suggested in the literature to help the PMSM start from particular initial rotor positions. This thesis has shown that the new EKF-based sensorless control algorithm can start from any initial rotor position without a need for any startup current pulse injection.

The above contributions have significantly improved the steady-state and dynamic performance and robustness of the entire sensorless control, simplified the structure of the PMSM EKF sensorless control, decreased the total time required for computer computational simulations, and finally facilitated a much simpler implementation of the all the digital control algorithms on a standard single DSP platform with reduced digital through-put.

Other Contributions of the Thesis Include:
· · Formulation of the EKF model in closed form. Development of a detailed dynamic model for the PMSM including initial rotor position. · Development of a discrete time model of the overall controlled system that includes the details of power electronics circuitry. · Development of an accurate initial speed/position prediction method without any need for additional circuits to eliminate convergence problems reported in the literature

R e p r o d u c e d with p e r m i s s io n of t h e c o p y r ig h t o w n e r . F u r th e r r e p r o d u c tio n p ro h ib ite d w ith o u t p e r m i s s io n .

using complex methods for con'ecting the initial flux. · Development of a system capable of operation at low speeds without any stall condition problem or a need for a current pulse injection algorithm reported in the literature. · Demonstration of proper performance, robustness and accuracy of the proposed sensorless method for all operation conditions and different types of loads.

Recommendation of Future Research:
1) Verification of the dynamic performance of the PMSM at rated speed on the laboratory prototype would be useful. This thesis has only presented computer simulations for assessing dynamic performance at the rated speed due to limitations of the actual laboratory prototype. Dynamic tests on the prototype at full speed would require implementation of an integrated dynamic brake for safe operation of the system.

2) The actual speed signal obtained from tiall effect sensors of the PMSM integrated prototype was not accurate at low speeds and could not provide any data for speed or position in the reverse direction. The accuracy and robustness of the proposed EKF sensorless method can be further analyzed and improved if a more accurate speed/position data becomes available through a resolver.

3) The parameters of the EKF matiix are manually adjusted based on trial-and-error method. Further research and analysis is requhed to optimize the process of selection and tuning of the EKF parameters.

4) The proposed EKF-based sensorless method can also be extended to other types of motor drive systems incorporating brushless DC motor (BLDCM) or induction motor.

9 9

R e p r o d u c e d with p e r m i s s i o n o f t h e c o p y r ig h t o w n e r . F u r th e r r e p r o d u c ti o n p r o h ib ite d w ith o u t p e r m i s s io n .

R e p r o d u c e d with p e r m i s s i o n of t h e c o p y rig h t o w n e r . F u rth e r re p r o d u c tio n p ro h ib ite d w ith o u t p e r m i s s io n .

References
1. J. Holtz, "Speed estimation and sensorless control of AC drives". Industrial Electronics, Control, and Instramentation, 1993. Proceedings of the lECON '93, International Conference on, 15-19 Nov. 1993, Page(s): 649 -654 vol.2. 2. Bose, B.K.; Godoy Simoes, M,; Crecelius, D.R.; Rajashekara, K.and Martin, R., "Speed sensorless hybrid vector controlled induction motor drive". Industry Applications Conference, 1995. Thirtieth IAS Annual Meeting, IAS '95, Conference Record of the 1995 IEEE, Volume: 1, 8-12 Oct. 1995, Page(s): 137-143 vol.l. 3. Ogasawara, S. and Akagi, H., "An approach to position sensorless drive for brushless DC motors". Industry Applications, IEEE Transactions on. Volume: 27 Issue: 5, Sept.-Oct. 1991 Page(s): 928-933. 4. Matsui, N. and Shigyo, M., "Brushless DC motor control without position and speed sensors". Industry Applications, IEEE Transactions on. Volume: 28 Issue: 1, Jan.-Feb.

1992, Page(s): 120-127.
5. Laurent, P.; Gabsi, M. and Multon, B., "Sensorless rotor position analysis using resonant method for switched reluctance motor". Industry Applications Society Annual Meeting, 1993, Conference Record of the 1993 IEEE, 2-8 Oct. 1993, Page(s): 687-694 vol.l. 6. Ehsani, M. and Husain, I., "Rotor position sensing in switched reluctance motor drives by measuring mutually induced voltages". Industry Applications Society Annual Meeting, 1992, Conference Record of the 1992 IEEE, 4-9 Oct. 1992, Page(s): .422-429 vol.l. 7. N. Ertugrul and P.P. Acarnley, "A New Algorithm for Sensorless Operation of Permanent Magnet Motors", IEEE Transaction on Industry Applications, Vol. 30, No. 1, pp. 126-133, January/February 1994. 8. L.A. Jones and J.H. Lang, "A State Observer for the Permanent Magnet Synchronous
1 0 1

R e p r o d u c e d with p e r m i s s i o n o f t h e c o p y r ig h t o w n e r . F u r th e r r e p r o d u c ti o n p ro h ib ite d w ith o u t p e r m i s s io n .

Motor", IEEE transactions on industrial. Vol. 36, No. 3, pp. 374-382, August 1989. 9. I.E. Moyniham and M.G. Egan, J.M.D. Murphy, "The Application of State Observers in Current Regulated PM Synchronous Drives", IEEE lECON Proceedings, pp. 20-25.

1994.
10. Solsona, J.A. and Valla, M.I., "Disturbance and nonlinear Luenberger observers for estimating mechanical variables in permanent magnet synchronous motors under mechanical parameters uncertainties". Industrial Electronics, 2000. IS IE 2000. Proceedings of the 2000 IEEE Eiternational Symposium on. Volume: 2, 4-8 Dec.

2000, Page(s): 407 -412 vol.2.
11. R. E. Kalman, "A New Approach to Lineai' Filtering and Prediction Problems", Transactions of the ASME-Journal of Basic Engineering, 82 (series D): 35-45. 12. Greg Welch and Gray Bishop, "An Introduction to the Kalman Filter", TR95-041 Department of computer Science University of North Carolina at Chapel Hill Chapel Hill, NC 27599-3175. 13. Literature Number: BPRA0547, "Sensorless Control with Kalman Filter on TMS320 Fixed-point DSP", Texas Instruments Europe, July 1997. 14. Bolognani, S.; Oboe, R; and Zigliotto, M., "DSP-based Extended Kalman Filter Estimation of speed and Rotor Position of a PM Synchronous Motor", Industrial Electronics, Control and Instrumentation, 1994. lECON '94. 20th International Conference on. Volume: 3, 5-9 Sept. 1994, Page(s): 2097 -2102 vol.3. 15. Silverio Bolognani, Roberto Oboe and Mauro Zigliotto, "Sensorless Full-Digital PMSM Drive With EKF Estimation of Speed and Rotor Position", IEEE Transactions on Industrial Electronics, Volume: 46 N o.l, Feb. 1999. 16. Silverio Bolognani, Mauro Zigliotto and Marco Zordan, "Extended-Range PMSM Sensorless Speed Drive Based on Stochastic Filtering", IEEE Transactions on Power Electronics, VOL. 16, No. 1, Jan. 2001. 17. Jun Hu, Dong-qi Zhu and Bin Wu, "Permanent magnet synchronous motor drive

10 2

R e p r o d u c e d w ith p e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u r th e r r e p r o d u c ti o n p ro h ib ite d w ith o u t p e r m i s s io n .

without mechanical sensors Electrical and Computer Engineering", Canadian Conference on, Volume: 2, 1996, pp. 603 -606. 18. Dhaouadi, R.; Mohan, N.and Norum, L., "Design and implementation of an extended Kalman filter for the state estimation of a permanent magnet synchronous motor",Power Electronics, IEEE Transactions on. Volume: 6 Issue: 3, July 1991, pp.

491 ^ 9 7 .
19. Silver Bolognani, Mauro Zigliotto and Marco Zordan, "Extended-Range PMSM Sensorless Speed Drive Based on Stochastic Filtering", IEEE Transactions on Power Electronics, VOL. 16, No. 1, Jan. 2001. 20. K. L. Shi, Hassan Kojori and Bin Wu, "High-performance Sensorless PMSM Drive witli Extended Kalman Filter", 2002 SAE Power Systems Conference, October 2002, Florida. 21. L. Salvatore and S. Stasi, "Application of EKF to Parameter and State Estimation of PMSM Drive", Elechic Power Applications, lEE Proceedings B, Volume: 139 Issue:

3, May 1992, Page(s): 155-164.
22. Rusong Wu, Gordon R. and Slemon, "A permanent Magnet Motor Drive Without a Shaft Sensor", IEEE Transaction on Industry Apphcations. Vol. 27, No. 5, September/October 1991. 23. H. Katsushima, S. Miyazaki, et al. " A measuring Meüaod of Rotor Position Angles of the Direct Drive Servo Motor",Proc. of IPRC '90, Tokyo, pp. 724-731, 1990. 24. H. Watanabe, H. Katsushima and T. Fujii, "An Improved Measuring System of Rotor Position Angles of the Sensorless Direct Drive Servo Motor", IEEE lECON 1991, pp.

165-170, 1991.
25. Bon-Ho Bae, Gi-Bum Kim and Seung-Ki Sul, "Improvement of low speed characteristics of railway vehicle by sensorless control using high frequency injection". Industry Applications Conference, 2000. Conference Record of the 2000 IEEE, Volume: 3, 8-12 Oct. 2000, Page(s): 1874 -1880 vol.3.

10 3

R e p r o d u c e d with p e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u rth e r r e p r o d u c tio n pro h ib ite d w ith o u t p e r m i s s io n .

26. Joohn-Sheok Kim and Seung-Ki Sul, "New Approach for tlie Low-Speed Operation of PMSM Drive Without Rotational Position Sensors", IEEE Transaction on Power Electronics, Vol. 11, No. 3, May 1996. 27. Alfio Consoli, Giuseppe Scarcella and Antonio Testa, "Industry Application of Zero-Speed Sensorless Control Techniques for PM Synchronous Motors", IEEE Transactions on Industry Applications, Vol. 37, No. 2, March/April 2001 28. Shigeo Morimoto, Yoji Takeda and Takao Hirasa, "Current Phase Control Methods for Permanent Magnet Synclii'onous Motors", IEEE Transactions on Power Electronics. Vol. 5, No. 2, April 1990. 29. Peter S. and Maybeck, 1979,"Stochastic Models, Estimation, and Control, Volume 1", Academic Press, Inc. 30. R. G. Brown and P. Y. C. Hwang, "Introduction to Random Signals and Applied Kalman Filtering, Second Edition", 1992, John Wiley & Sons, Inc.

31. Paul C. Krause, Oleg Wasynczuk and Scott D. Sudhoff, "Analysis of Electric
Machinery", The Institute of Electrical and Electronics Engineers, Inc., New York. 32. Skiller, G.and Huang, D. Communications, "The stationary phase error distribution of a digital phase-locked loop", IEEE Transactions on. Volume: 48 Issue; 6, June 2000

Page(s): 925 -927.
33. AN401-03, "Three-Phase Sine-Wave Generation using the PWM Unit of the ADMC401", Analog Devices Inc., January 2000. 34. dSPACE GmbH, "MLIB/MTRACE MATLAB-dSPACE Interface Libraries",

dSPACE Inc, Copyright 1999. 35. dSPACE GmbH, "DS1103 PPG Controller Board Installation and Configuration Guide", dSPACE Inc, copyright 1999. 36. dSPACE GmbH, "Real-Time Interface (RTI and RTI-MP) Implementation Guide", dSPACE Inc, copyright 1999. 37. dSPACE GmbH, "Control Desk Experiment Guide", dSPACE hrc, copyright 1999.

1 0 4

R e p ro d u c e d with p e r m is s io n of t h e co p yright o w n er. F u rth e r r e p ro d u ctio n prohibited w ithout p e r m is s io n .

Appendix A

Basic Structures of State Observers

1 0 5

R e p r o d u c e d with p e rm is s io n of t h e cop y rig h t o w n e r. F u rth e r re produ ction prohibited w ithout p e rm issio n .

In certain applications, some internal state variables are not readily measurable and hence are not available for the control of the system due to excessive overall system cost, weight and practical limitations of the measurement circuitry. In these situations, state observer methods are used to estimate the state variables that are not available.

Assume a system having the following state equations x = A-x +B  u, y =H  X. (A. 1) (A.2)

where all symbols denote matrices or vectors. The simplest observer is shown in Figure A-1. Assuming that the input values of the system are known, we can simply realize the observer, wliich runs in parallel to the actual system to estimate the state vector. However this approach is not practical because the starting condition of the system is unknown. This causes tire state variable vector of the observer model to be different from that of the real system.

Tills problem can be solved from the principle that the estimated output vector is calculated based on the estimated state vector

y=H

(A.3)

Then it Is compared with the measured output vector. The error will be used to correct the state vector of the system model. Tlris is called the Luenbergerobserver, which is shown in Figure A-2. The state equation of Luenberger observer can be set up as:

Æ = ( A - L -ff) x + g w+ L y.

(A.4)

The matrix L must be set in order to make the error of the observer approach zero. This can be solved by setting up a state equation for the err or as:

g = ( A - L Lf) g,

(A.5)

1 0 6

R e p r o d u c e d with p e r m is s io n of t h e c o p y rig h t o w n er. F u rth e r rep ro d u ctio n prohibited w ithout p e rm is s io n .

where
e = X -- X.

(A. 6)

Transposing the matrices of the enor differential equation (A.5), a form that is similar to a feedback controller structure is obtained;

(A.7)
The effectiveness of such an observer greatly depends on the precise setting of the system parmneters and the exact measurement of tire output vector. In the case of an actual system, none of these criteria can be taken for granted. Due to measurement disturbances, intemal parameter variations, or the presence of excessive system noise, the Luenberger observer cannot be relied upon. Researchers have used the Kalman filter successfully to overcome these problems.

Figure A-3 shows the structure of a Kalman filter. The overall structure of the Kalman filter is the same as that of the Luenberger observer. Assume a system with the following equations:
X --

A - x + B- u + <J ,

(A.8) (A.9)

y = H -x + p .

where cr and p are the system and the measurement noises, which are stationary, white, uncorrelated and Gauss noises, and the expectations are zeros. Define the covariance matrices of these noises: Q = E[a-a'^], (A. 10)

R = E[p.p^].
where E[ ] denotes expected values.

(A. 11)

The system equation of Kalman filter Observer is tire same as that of the Luenberger:

jÊ= ( A- K- 7f ) % + R w+ K y,

(A.12)

1 0 7

R e p r o d u c e d with p e r m i s s io n of t h e cop y rig h t o w n er. F u rth e r rep ro d u ctio n prohibited w ithout p e rm issio n .

-I
S y ste m (not m e a s u ra b le ) Input

u

X = A x + Bu

X

S y ste m m odel

x = A x + Bu

X

Figure A-1. Simple state observer.

System (not m easurable) Input

u

X = Ax + Bu

Output

State
Luenberger obsen/er with x

.y-.y
Figure A-2. Structure o f the Luenberger observer.

 ~ 1
System ( not m easurable) Input

u

X = Ax + Bu

Output

S tate Kalman filter

I __________________________________________________________I

Figure A-3. Structure of the Kalman filter estimator.

1 0 8

R e p r o d u c e d with p e r m i s s io n of t h e co pyright o w n er. F u rth e r r e p ro d u ctio n prohibited w ithout p e rm issio n .

The only difference between them is the setting of the feedback gain matrix. For Kalman filter, it is K, while for Luenberger, it is L. Matrix K will be set based on the covariance of the noises. Establish a measure of the goodness of the observation as: 7 = Mg'". 6]. where e follows the definition given in (A.6). (A. 13)

This depends on the choice of K. K has to be chosen to make J minimal. The solution of this is the following = where P can be calculated from the solution of the following Riccati equation: P  R-'  H P - A- P - P  A'' - Q = 0. (A. 15) (A.14)

Q and R have to be set up based on the stochastic properties of the corresponding noises.

It should be pointed out that the discussion of Kalman filter in this appendix is only suitable for linear systems. For non-linear systems, the Extended Kalman Filter (EKF) algorithm is developed. Detailed formulations and discussions for the EKF method are presented in Chapter 2.

1 0 9

R e p r o d u c e d with p e r m i s s io n of t h e cop y rig h t ow ner. F u rth e r re p ro d u c tio n prohibited w ithout p e rm is s io n .

R e p r o d u c e d with p e r m i s s io n of t h e c o p y rig h t o w n e r . F u rth e r r e p r o d u c tio n prohibited w ithout p e rm is s io n .

Appendix B

Specifications o f the Motor-Generator Set

R e p r o d u c e d with p e r m i s s io n of t h e c o p y rig h t o w n e r . F u rth e r r e p r o d u c tio n p rohibite d w ithout p e r m i s s io n .

PERMANENT MAGNET D.C, BRUSHLESS MOTOR PARAMETER DATA SHEET

IN D U S T R IA L M O T O R % iW C.
Sübsidiaîy of Peertess WinsmHh, jhp. PXii BdjcSSsO Rock HSI, SC 29732 USA Phone- G#-32M 8W -/FA X :a03-328-167G f w eb sitef« M w p o ^ laENTIFtGAliON INFORMATION: DSG cüsfoMÉR; 145T FRAME: G .7/5. HP/KW: DUTY: CONTINUOUS -T- - F " V (NSULATfpN CU 6:01 C.t.S.R; 444 PEAkTORQUE-tB.lN:; JO B NUMBER: f 31897-2 CUSTOMER P.O. No; . 1204 : MODEL: F14SS4C0N9A7011 MAX BUSS VDC; 290 12000 RPM: SER. FACTOR; : ' T '.' RMS AMPERES: . 18.7 ENCLOSURE: ' / . TEFC 40 AMBIENT C: PEAK RMS a m p s 177 2Y  CONNECTION: 35.2 . RATED T O R Q U E -L S .IN .; SERIAL NUMBER: C0Î09P

-

WINDING DATA AT 25 Ç: SINE WAVE V àtàes b ^ é d o n Dflve.type.* . ROTOR POLES 14M1321-2Y E/S NO: RTT.OHMS; 18.8 VRMS/KRPM L-L; 0:888 LTf,:mH: KT. LB.IN7AMP RMS: 1.74 KT. L8JN./AMP PK:,_________________ 6.3 - MÉCH. TIME CONST, MS: 7.1 MIR CONST., kM:LB.!N/ s o r t WATT

PHASESC 0.08 1.13 2.46 ELECT. TIME CONST, MS:l

112

0.083 WK*2. LB.FT''2.: ROTOR INERTIA LB;1N.SEC''2:| 0.031 14350 PEAK THEORETICAL ACCELERATION, RAO.fSEC'2: STATIC PRES. INCHES OF WATER: N/A VENTILATION REQUIREMENTS; CFM: . 53  WEIGHT, LBS. IS STATIC FRICinoN TO RaU E, LB.IN: 0.0008 VISCOUS DAMPING TO ROUE, INFINITE SOURCE LB;IN./RPM 12500 MAXIMUM s a f e SPEED; ACCESSORY DATA: BLOWER MOTOR DATA: HP; FREQUENCY:! N/A TEMPERATURE PROTECTION DATA VOLTS; N/A N/A PHASES; THERMAL SWITCH NORMALLY CLOSED N/A AMPS;

N/A

·

N/A

HALL SWITCH ASSY. DATA; N/A MILLAMPS: MAXIMUM EXCITATION, VDC: SPEED ENCODER PULSES PER REVOLUTION PER CHANNEL: NUMBER OF SPEÈDtCÉÀNNELS IN QUADRATURE: 2 ' NUMBER O F COMMUTATION CHANNELS; 3 AT 120 ELEGT.OÉGREES
other

N/A N/A

DATA: PERFORM A N ce CURVES; { 03704301173-000 DIMENSION DRAWING: STANDARD: CONNECTION DIAGRAM; FERRITE PERMANENT MAGNETS.; SINE WAVECEMF. ADDITIONAL COMMENTS: HIGH SPEED ROTOR DESIGN- RESOLVER FEEDBACK SPECS. SEE ATTAGHËO.

-W
CERTIFIED FOR CONSTRUCTION: YES DATE: 6Æ/02

woT
ENGINEER; R. e . LQRDO

1 1 2

R e p r o d u c e d with p e r m i s s io n of t h e c o p y r ig h t o w n e r . F u r th e r r e p r o d u c tio n pro h ib ite d w ith o u t p e r m i s s io n .

PERMANENT MAGNET DÆ. BRUSHLESS MOTOR PARAMETER DATA SHEET

P QW ERTTEC IN D U S T R IA L M O T O R S , IN C .
Subsidiary of Pee/iess - Winsmith, In c P.O. Bdx 2B5D Rock Hiil, SC 29732 USA: Phone: BOaaZBTlBSa- FAX: 803^28-1870; website: www.powedecnmtors.c6rn
IDENTIFICATION INFORMATION:

CUSTOMER: FRAME; HP/kW ; DUTY: INSULATION CL: C.T.S.R: PEAKTORQUE-LB.IN.:
JOB NUMBER;!

DSG : 145T . 6 .7 /5 . CONTINUOUS
  / ..6 :0 1 ;-:: '

*44. 31897-3

\

CUSTOMER P.O. No 1204 1 MODEL F145S4C0N907011 : MAX BUSS VDC: : - : 300':' ' '  RPM 12000 " . . SER. FACTOR: RMS AMPERES : 22::: -ü." TEFC ENCLOSURE: : AMBIENT C   : 2 0 5 .- : . CONNECTION :r,: :::<..::2Y ' - V ' PEAK RMS AMPS R A TED T O f îO U E - L a J N . 35:2 SERIAL NUMBER:! C0110P

WINDING DATA AT 2 5 C: 'V a lu es ba s e d on Drive type:

TRAPEZOIDAL ROTOR POLES E/S NO: 14M13Z0-ZY RTTiOHMS; KV, VRMS/KRPM L-L; 17.71 LTT. mH: D.84B Lsync., niH 2.12 KT. LB.IN./AMP RMS. KT, LB.IN./AMP PK; MECH. TIME CONST.. MS; 4.3 MTR CONST., KM:LB.IN/ SORT WATT 8.02

0.0698 1.07 2.59 ELECT, TIME CONST., MS: I

1 2 . i:

MECHANICAL DATA:

0.083 0.031 WK-'Z. LB-FT-'Z.; ROTOR INERTIA, LB.IN.SEC%: PEAK THEORETIGAL ACGELERADON, RADUSEC`'2: 14350 VENTILATION REQUIREMENTS; CFM STATIC PRES. INCHES OF WATER: N/A ... : 53 STATIC FRICTION TORQUE, LB.IN; : WEIGHT, LBS. 0.00033 MAXIMUM SAFE SPEED; 12500
ACCESSORY DATA: -

N/A

BLOWER MOTOR DATA: HP: FREQUENCY;! N/A TEMPERATURE PROTECTION d a t a ;

N/A volts; PHASES; N/A THERMAL SWITCH NORMALLY CLOSED

N/A AMPS: N/A

HALL SWITCH ASSY. DATA: MAXIMUM EXCITATION, VDC: 6 MILLIAMPS: SPEED ENCODER PULSES PER..REVPLUDON PER CHANNEL: NUMBER OF SPEED CHANNELS IN QUADRATURE: 2 NUMBER O F COMMUTATION CHANNELS; 3 AT 120 ELECT. DEGREES OTHER DATA: DIMENSION DRAWING; CONNECTION DIAGRAM: ADDITIONAL COMMENTS: HIGH SPEED. ROTOR DESIGN. CERTIFIED F O R CONSTRUCTION: YES DATE: ere/02 /

' 75 30 :

03704101173-000 PERFORMANCE CURVES: STANDARD FERRITE PERMANENT MAGNETS. TRAPEZOIDAL OEMF; - r X ! ' ' NOl ENGINEER: R. E.LORDQ ...................................... . r 1- :

. .... 1

. ..J 1

113

R e p r o d u c e d with p e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u r t h e r r e p r o d u c ti o n p r o h ib ite d w ith o u t p e r m i s s io n .

POWERTËC "MOTOR DIMENSIONS
F140 Frames^ TENV (Totally Enclosed, Non-Venti'lated)

DRIVE END

(177.6)

35 6 0 :% % .

7 .» (177.8) 4X .3-1 THRO

aXC0.B5J

MX fl.CMTHROj

SIDEVIEW
-- C w it h BRAKE

-- c w irm e H c b p E R
ms



 S il « m
FI 43 F145 F-147

sm m

: 18;4f (416.82) 19.16 . (486,7) 21.91 (556,52)

'

Dimehs' KKlsi M i ),arc mnrj. all athcts In 'mclics

MODEL F143 FI 45 F147 Y'4.00- .·
'l W % 0 ( F

XI,

7.03 (178,56) 9.78 (248,4) 12.53 (318,26)'

OPPOSITE DRIVE END
a -- .,(111 3)

0.V 5 (ll'l.SI 7S' i 

" L i

1 . cdNOUJTOOX-CAlilBEROrATEDlH SO 'ST E PS

,p H n so \W A » s. ,

1 1 4

R e p r o d u c e d with p e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u rth e r r e p r o d u c tio n p ro h ib ite d w ith o u t p e r m i s s io n .

F140 Frame Mounting, NEMA
WEMA C FACE Dimensions in Inches

;000

) 6^ izn^zi3"f
1.80

> 4 X 3ffi^.15UNC.X:'.56 DEEP EQUALLY SftXCED ON A · 5,875 Q.C..

1 A A X ,
REFEATOT^NVblkëNSIONSbN f^GEZT.
FOR F R O ^W EV V FEET WWENSIONS,

1


2 F
6.00

2.25

2.2Q

k "

iiMODEL F143 M45FI 47

2F DlMENSrON '· ,;.:'4.00" 4". ^ ^5,00 k.

#

115

R e p r o d u c e d with p e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u r th e r r e p r o d u c ti o n p ro h ib ite d w ith o u t p e r m i s s io n .

R e p r o d u c e d with p e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u rth e r r e p r o d u c ti o n pro h ib ite d w ith o u t p e r m i s s io n .

Appendix C

Specifications o f the Inverter Power Module

117

R e p r o d u c e d with p e r m i s s io n of t h e c o p y r ig h t o w n e r . F u r th e r re p r o d u c tio n pro h ib ite d w ith out p e r m i s s io n .

SKîîP 342GD120^314G'n/ Power section Absoluté maximum ratings
Symbol !GBT
Vc' es

seivIIKRdn
Ta = 25°C unless plheiwise specified Values 1200 000 ±20 300 (225) 300(225) 2160 23 -40 (-25) ...±150 (125) 3000 1 Units V V V A A A :kA?s "C. V

iconditibhs

Vcc^
V(3Es
îc

Operating DC link voltage

SKüP® 2 SK integrated intelligent Power 6?pack SKÜP 342GD120-314CTV

T. = 25(70)"C Inverse diode T« = 25(70)-C -jc Tj = 150 °C, tp= 10ms; sin IPSM ;: . iVfDlode) Diode, Tf = 150 °G, iOms T i. (T,ij,) AC. imin. .Vw

Çssô S3

rm rm rW !

G h a r a p te r l.S tiG S Tg,= 2S°C unless othei wise specified Symbol ICpnditiohs  Units min. 1 typ. I max. IGBT VpEsot V lo:=250A,T)=25(125)''C _ W i.i) g.'i T; = 25(12S)°C 1,2 (1;3) 1,5 (1,6) VcEO V Tj.=:25(125)"C 5,3 (7,0) 6,3 (8,1) nin tCE mA Ices VGs=0,VcE=ycEs.Ti-25(125) °C (15) 0,4 lc=250A, Vcc=SOOV mJ 75 Eon + E.oit T|=125°C mJ Vcc=9Q0V 132 terminal chip, Tj = 125 "d 0,50 mîî R cCT.EE" top, bottom 15.0 nH Lce nF perp h ase, AC-side CcHC 1.4 Inversé die de : Vf --Vec If=250A ;T j = 25(125) "G V 2,1 (2,0) 2,6 Vjo T, = 2 5 (1 2 5 )"C y / 1.3 (1.0) 1.4 (1.1) T, = 25 (125) `C 3.3 (4,0) 4,5 (5.2) T t mCt )c=250A Vcc=600V mJ 10 Err Ti=125°C Vco=900V mJ 12 Mechanica 1data Nro DC tefrninals. Bl Units 6 8 Md. : AC tetrnlnals, SI Units Nm 13 15 w 2,7 skllP® 2 System w/o' heat sink kg ·v y . heatsink,. -6,6 - . kg Therrpai ctiaraclerlstlcs (P16 heat sink; 29 5 m''3/ h): T reference to Ismperatur 0 sensor per IGBT K/W R lbjllQ B T 0,090 per .diode m j .R tfiirétàda o#o per module 0,036 Rthta m i . Ri(mkOW)(rhax.) . taui(s) Z,h 1 2 3 4 : 3 : 4 iG'BTjr , 10 69 11 1 0,13 0,001 aipde),: .:. . 28 193 30 1 0,13 0,001 heatsihkn, 11,1 18.3 3.5 3.1 204  60 6 0,02

I I

*i«er

II

Features · SKIiP technology insîde · low loss IGBTs · CAL diode technology · Integrated current sensor · integrated temperature sensor · integrated treat sink . lEG 6Ô721-3-3 (humidity) class 3K3/1E32 (SkilP® 2 System) · IEG68T.1 (climate) 40/125/56 (StCiiP® 2 power section) 1)witfi assembiy of suitable MKP capacitor per tétminal (SEMlKRpN type is recommended)

This technical informatibn speciM'es semicohdudtor devices but prornises no characteristics. No warranty or guarantee; expressed or Implied is .made.regarding delivery, perfbrinance.pr suitability.-

1 1

R e p ro d u c e d with p e r m is s io n of th e cop y rig h t o w n e r. F urther r e p ro d u ctio n proh ibited without p e rm is s io n .

SKÜP 342GD12D-314GTV SKiiP 2 ® .....' SK integrated intelligent Power IL integrated gate driver Absolut é maxirrtumTStings
Symbol Vs, Vs2 V iH dv/dt VôotlO Vfedl,2 fm ax Term stabilized 15V power supply uns.tabiiized 24V po\yer supply input signai voltage (high) secondary to primary side input /output (AG) \ output 1 / output 2 (AC) switching freduericy Operating / stofage tefnpèrature Value 18 36 I S + 0,3 . 75 ; 3000 1500 20 -2 5 ... + 85 Unit V V V kV/ps Vac Vac kHz °C

SKÎÎP 342GDi20-314CTV

G a to d r iv e r f e a tu r e s

· .GMQS.cdrnpatible inputs . wide range power supply · integrated circuitry to éën se  phase current, heat sink temperature and DC-bus voltage (option) : « short-circuit protection · over current protection · over voltage protection (option) · power supply protected against under voltage '· int'edpck of.top/bpttorn switch isolation by transfomiers fibre optip ipterface-(option for GB-J>pes:;only)  · lEC 68T;1 (climate) 25/85/56; (SkiiP® 2 gatedriyér)

Values È le ç tr iC i 3f c h a r a c t e riS tlC S (T . = 25 "C) mln typ max. Units. Symbol Term V 15,6 supply voltage, stabilized 15 14,4 Vs, V 30 supply Voitage non stabilized 24 20 Vs2 mA ; 340 + 520"f/famx + 3,6*(iAc/A) VsV = 15V ,!si mA 250 + 380rf / Vs2 = 24V + 2.6* (Iac/A) Is2 . V  11,2 input threshpid voltage (High) Vn=+,: * " .* 5:4 V input thfesh'old'vdùaqëi (Low) Vrf. kfi input resistance 10 Rin : gs -- turh-oh propagation time (system) ld(on)lo. 1.2 1.6 turn-off propagation time (system) : gs td(on)io: ps 9 -- tpSR RR ESH T error memory esettime us 2,3 top/bottom switch: interlock time Ito A 300 Is to a V cdrfpspdri ianatogO U T max. current of 15 V supply voltage mA 50 -- -- Ivsioulm ax (available when supplied with 24V) mA 5 output current a t pin 13/20/22/24/26 Uomaif V 0,6 -- logic low output voitage Vet V -- -- 30 topic high output voltage V,A, A 375 -- over current trip level ( fsmbg our ~ 10V) Itripso A -  87 ground fault protection ixRIPtG 120: ° c 110 over temperature protection -r' T,p trip level of Uoc-protection ( U.^uo, our V 900 U dctrip = 9V); (option)

For electrical and theim sl'designsuppoil please use SEMISEL.Accessto0EMfSEL is viaSEMiKRON website ;http://serhi'sei,sémikf6n.c6m, FurthOf questions can be placed Via httoV/fad.serhikron-com/. '

This.technical information specifies semiconductor devices biit promises no characteristics: No warranty of guarantee : expressed or implied is m ade regarding dèityerÿ. perlpfmancëppsuitabliity.

1 1 9

R e p r o d u c e d with p e r m is s io n of th e cop y rig h t o w n e r. F u rth e r r e p ro d u ctio n prohibited w ithout p e rm issio n .

SKÜP® jgy 3 integrateci Intelligent Power System s
PIN-àrraÿ - S^-phâse bHdgé driver SKiiP 2 ,3 type ,,GD"
type.GDL)
X2: Pin 1 2 3 signal: .sWold : ` remark

seMIKRiin
rerpark connected.to,GND (fprusage'of shielded cable) .: . . .

PÎN ^rray - brake chopper driver (used ïri SKÜP 2

pin signal
1. 2 shield

posillve 1 5V CMOS logic; 10 kO trnpëdanbe . BOTHB`1 _ ERROR H B 1.out: sh o e circuit monitoring HB1 (1 LOW = NÔ ERRpR; open collector output; max. 30 y TI 5 mA prépàgalion delay .1 pS. : mih. puisewidih an-or-rnernory-raset b ps , 4 TOP HB 1 IN*) p psiliY alsy ÇMOS.'iDolcr 1b kfi.irnpedance ppsiUveiSV CM0S,1o'gic; lO'ipe impedaiiea S': BO*HB:2iN?l 6: ERROR H B 20U T Short circuit rnonitpringHBZ, LOW'S NO ERROR; open collector output; m ax;30V :/15m A : jirppagation delay 1 ps. mln1,pUisew|dlh. error-memory-resèt 9 p s . . r t0 p :H B z :iN ? t, posillveTI.SV .CMOS:ipgip; :10 kOlrnpedanpe O5v}pglc;,'1b, k li impedapdei, 8 ' t b. o j: h b , 3 iN?i  Rddltive; 15V:0M' 9 , ERROR HB:3 OUT :shoit. circUit'rhonitorlrlg HB 3 ') \ LbW =: NP' :ERRdRf op.en' collector output: rpax,.3p.y/.IS.mA prdpkgaiidti delay Tps, , rrilri;,pulsew|dth erfor-mernory-reset 8 jis H .S t o p Hb 321 positive 1SV CMOS iogic: 1b t&l Impedance pvsrtem p. OUT') LQW.=;Nd,ERROR;T.0DC0,:<11.5-*5*C, open (tollectorQulpul; rnax.,30 YV15 tnA. Jovv` oulputvoltage' < 0.6 V :. .ttigh" output Yoltagernax. .30 V :t2. reserved 13:; Uop analog OUT Uao vyhéln Using pptton,,;U<' ; actual DC-iink voitage, 9,0 V refer to Upcrw max. outputoument 5 mA : _.. 14. T 24 Voc IN: 24 Vac'tSKiiP 2: 20.-'30 Vv-SKiiP 3; 1 3 - SOY:) - 24 VoqlN 15 -r dpnT supply wittr 24: V, vrhan using * 15 :.V dc (S k'iiP'Zonly) 1.§,: 'TI'SV dC.IN' . : i s VoC'±d ?i pdtVBC supply (SKilP:2i:gniy) 17 't I S V d o IN tlonil supply wllhi'ISV.wh (SkljPZoniy) , , supply VQltagetrnonildringthrostroldl 3 V 16' 4:1:5 V bo OUT rnax: 50 m.^touxlliary power supply when 17- f tSVbc^OUT' , : ' si;liB system is supplied via pin 14/15 181 :: : .GNto. fdr poWer'suppiÿ pnd GtiDjfor'dlgltai signais 19 GND  2b": Tamp. analog OUT max. output current 5 mA .. . . 21 GND aux. : ' 22 i enaibg dUT p n ; SNiiP 2 and SKiiP 3 with AljOj ceramic su b  strate:- k c current aciual'vetoe 8 .0 Y 100.% Ic@ 25 "C ovèrourrent tdp.ievei'10 VW-125 %To @ 2 5 °.C ' curreniyal.ue: b skiiP is source . Current value <:b ee.SiiilPIs sinkSKiiP 3 with AIN ceramic substrate; tafër to:corresponding,dslashBet rpfprèricë :for:anàlog'Oijlput signals : 23 GND aUX 24 l,;analbg:6utH B 2 as:pin'22 25 OND'àüx'  ' rofaVance for anelpg. output'signals . 26 1::anâ!pg OUT HB 3 .as pin 2 2 ' '

3

4

CHOPPER ext. ÔN LOW.tIGBTON -tovF (maxi s V, lm«.= 5 mA . ihigh- '(min) li,5 V propagatidn delay ttf(ooj.S 20 ps taîo)!)S25tis . ERRtbROUTU LOW T NO ERROR open collector Output; rpax. 30 V /2,S m A pnopagationdefayfej(S,,i«,,brS 59 1 rs RESET . LOW = RESET' Resel-pulsp.-Brn'e IppHÉser RZOOins connect this pin to .ppetr çoHecIpr output without puli up'resistor jdyy" (max) 2 V .'. .high" (min) 12 V don'Lsupply with 24 V,->»hen Usli1g+ISVPcin suppiy.:voltage rnenitorihg ihreshold 15.6 v

5: reserved.
S ' + 24: Voc IN 7 . r.24 Voc IN 8 +15'YcclN: 9 + TSV do IN :io' GND 11 GND^ 12' reserved. 13 reserved 14' reserved Open coîleotor ouîpul; exiemal pull up resistor necessary

· dph Tsupply wilh 15 Y.-U-henuslrig^Zf VpoiN supply.voltage. monitoilrig threshold.13 V

i\Oppi1 ceiièctor :oulpui;exi0 . ,;âfgnaI,lo'Î3NDv..

(m ax).S ,A % :S !< iiP :& jnpWp

puli up resistor necessary.:

1 2 0

R e p r o d u c e d with p e r m is s io n of th e cop y rig h t o w n er. F u rth e r re p ro d u c tio n prohibited w ithout p e rm issio n .

SKiiP® 2,,3 integrated intelligent Power Systems
C ase S2 SK iiP2G B 2Tfp:d C a s e S3

S E M lK R f lN
SKiiP-2 GB 3-fold
Û m c J O r gCPCCd

rsi
.

: :

CDS.

. i

1r ~ ' " K \

weight Without heat sirik: 1 ,B5 kg P16; ' 4,7 kg C ase S4, SKiiP 2 GB 4-fold

v/eight Without heat sink; 2,72 kg P1@: 6,6 kg C a se 85, SKiiP 2 2*GB 2-foid

C tff tg d ytv ttlM /Z 6O m

1

weighf'Withoiit heatsink: 3.54 kg 

weight without heatsink: 3,54 kg

PÎ6:'

:,

8;46 kg

1 2 1

R eo ro d u ced with D erm ission of th e coDvriaht ow ner. Further reproduction prohibited without p erm ission.

[ AI-

i ki ' i .n *

Y\Vl' /

.

R e p r o d u c e d with p e r m is s io n of t h e co p yrig ht o w n er. F u rth e r r e p r o d u c tio n prohibited without p erm issio n .

Appendix D

Simulation Results of the Startup Transients

1 2 3

R e p r o d u c e d with p e r m is s io n of t h e cop y rig h t o w n er. F u rth e r re p ro d u c tio n prohibited w ithout p e rm issio n .

In this appendix, the simulation startup response waveforms of the proposed EKF PMSM sensorless drive system are listed. The 4 poles prototype PMSM (Appendix B) has 24 potential positions when it is standstill. Hence to obtain overall simulation results of startup transients, totally 12 electrical initial positions, from 0° to 330° with step of 30°, should be considered. The control diagram (Figure 2-23) with the SPWM inverter is used for investigation. Figure D-1 shows the response waveforms when the initial rotor position is 0". Figure D-1 (a) shows the waveforms of speed reference, actual and estimated speeds. The estimated speed converges to the actual one in about 0.12s. Figure D-l(b) shows the actual and estim.ated rotor positions and their error. Excluding the convergence period, tlie average transient position error is 7°/360°=1.94%. Other response waveforms initial rotor positions are listed in similarly order.

oT
(a) Speed reference, actual and estimated rotor speeds. '

0

OCE

ai

OIS

02

53

0.2

03

04

04S

05

(b) Actual and estimated rotor positions and their error.

Figure D -1. Waveforms o f startup transient when initial rotor position is 0°.

i 2 4.

R e p r o d u c e d with p e r m i s s io n of t h e c o p y rig h t o w n e r . F u rth e r re p ro d u c tio n prohibited w ithout p e rm is s io n .

I
I

!
i j

I

I

I
1
I f

(a) Speed reference, actual and estimated rotor speeds.

(b) Actual and estimated rotor, positions and their error.

Figure D-2. Waveforms of startup transient when initial rotor position is 30°.

Î

I

1
i
I
3

I

I
I

!

(a) Speed reference, actual and estimated rotor speeds.

(b) Actual and estimated rotor positions and their eiTor.

Figure D-3. Waveforms of startup transient when initial rotor position is 60°.

Î s

i
I I
I

II
E

I

I I

(a) Speed reference, actual and estimated rotor speeds.

(b) Actual and estimated rotor positions and tlreir error.

Figure D-4. Waveforms of startup transient when initial rotor position is 90°.

1 2 5

R e p r o d u c e d with p e r m i s s io n of t h e c o p y rig h t o w n e r . F u rth e r r e p r o d u c tio n pro h ib ite d w ithout p e r m i s s io n .

i 5

i
I

I

î I i

I
(a) Speed reference, actual and estimated rotor speeds

I

(b) Actual and estimated rotor positions and their error.

Figure D-5. Waveforms of startup transient when initial rotor position is 120°,

1

!
I

I I !

I
I

1
(a) Speed reference, actual and estimated rotor speeds.

(b) Actual and estimated rotor positions and their error.

Figure D-6. Waveforms of startup transient when initial rotor position is 150°.

I

I
I

J
I

I

I

s
Î

i Î
(a) Speed reference, actual and estimated rotor speeds. (b) Actual and estimated rotor positions and their enor.

Figure D-7. Waveforms o f startup transient when initial rotor position is 180°.

1 2 6

R e p r o d u c e d with p e r m i s s io n of t h e c o p y r ig h t o w n e r . F u rth e r r e p r o d u c tio n p ro h ib ite d w ith o u t p e r m i s s io n .

1
î
I

I

i i

I I
I

!
I

(a) Speed reference, actual and estimated rotor speeds.

(b) Actual and estimated rotor positions and their error.

Figure D -8. Waveforms o f startup transient when initial rotor position is 210°.

J

1
1
i

(a) Speed reference, actual and estimated rotor speeds.

(b) Actual and estimated rotor positions and their error.

Figure D -9. Waveforms o f startup transient when initial rotor position is 240°.

ÏTM

(a) Speed reference, actual and estimated rotor speeds.

(b) Actual and estimated rotor positions and their error.

Figure D-10. Waveforms o f startup transient when initial rotor position is 270°.

1 2 7

R e p r o d u c e d with p e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u r th e r r e p r o d u c ti o n p ro h ib ite d w ith o u t p e r m is s io n .

i

î I J
2

i

1

I

I

(a) Speed reference, actual and estimated rotor speeds.

(b) Actual and estimated rotor positions and their eiTor.

Figure D-11. Waveforms o f startup transient when initial rotor position is 300°.

I 1
1

J

I

(a) Speed reference, actual and estimated rotor speeds.

(b) Actual and estimated rotor positions and their error.

Figure D-12. Waveforms o f startup transient when initial rotor position is 330°.

I 2 8

R e p r o d u c e d with p e r m i s s io n of t h e c o p y r ig h t o w n e r . F u rth e r re p ro d u c tio n p ro h ib ite d w ith o u t p e r m i s s io n .

Appendix E

Experimental Results o f the Startup Transients

12 9

R e p r o d u c e d with p e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u r th e r r e p r o d u c ti o n p ro h ib ite d w ith o u t p e r m i s s io n .

In this appendix, the experimental startup response waveforms of the proposed EKF PMSM sensorless drive system are listed. To obtain overall experimental results of startup transients, totally 12 electrical initial rotor positions, from 0° to 330° with step of 30°, are considered. The control diagram (Figure 4-3) is used in experiment. Figure E-1 shows the waveforms of speed reference, actual and estimated speeds when the initial rotor position is 0°. Other response waveforms initial rotor positions are listed in similarly order.

In figures of tlris appendix, the measured "actual" speed waveforms are not smooth at the beginning of the startup. This is caused by using Hall effect sensors to detect actual speed. The Hall effect sensors only can accurately detect 6-fixed position information. Other position information is obtained from the integral process in present setup. This can explain why the rotor speed detected by Hall effect sensors is not accurate at low speeds or transient periods. Especially, when the motor is at standstill, the Hall effect sensors cannot acquire the correct information of actual position.

 S p eed R atsren c e

/S p e e d ReterencB

? 5 % 4000

\ \ \ \
\

s
"

it

2000

^

1000

\
jA E stim eted S peed --------------0 2 3 4 S B * S

«

^
9 10

Figure E-1. Speed reference, actual and estimated rotor speeds of startup test (initial position: 0").

Figure E-2. Speed reference, actual and estimated rotor speeds of startup test (initial position: 30°).

1 3 0

R e p r o d u c e d with p e r m i s s i o n of t h e c o p y r ig h t o w n e r . F u r th e r r e p r o d u c ti o n p ro h ib ite d w ith o u t p e r m i s s io n .

y Sp eed Reference

I

t
s

Figure E-3. Speed reference, actual and estimated rotor speeds of startup test (initial position: 60°).

Figure E-4. Speed reference, actual and estimated rotor speeds o f startup test (initial position: 90°).

/ S p e e d R etw en ce

Figure E-5. Speed reference, actual and estimated rotor speeds o f startup test (initial position: 120°).

Figure E-6. Speed reference, actual and estimated rotor speeds of startup test (initial position: 150°).

/ S p eed R efw ence

EsCmated Speed

TiiriB(s)

Figure E-7. Speed reference, actual and estimated rotor speeds o f startup test (initial position: 180°).

Figure E-8. Speed reference, actual and estimated rotor speeds of startup test (initial position: 210°).

1 3 1

R e p r o d u c e d with p e r m i s s io n of t h e c o p y r ig h t o w n e r . F u rth e r r e p r o d u c tio n p rohib ited w ith o u t p e r m is s io n .

^Sp& ed R eference

Figure E-9. Speed reference, actual and estimated rotor speeds of startup test (initial position: 240°).

Figure E-10. Speed reference, actual and estimated rotor speeds of startup test (initial position: 270°).

~

4000

Figure E-11. Speed reference, actual and estimated rotor speeds of startup test (initial position: 300°).

Figure E-12. Speed reference, actual and estimated rotor speeds of startup test (initial position; 330°).

1 3 2

R e o ro d u c e d with o e r m is s io n of th e coD vriaht o w n e r. F u rth e r r e o ro d u ctio n orohibited w ithout p e rm is s io n .

