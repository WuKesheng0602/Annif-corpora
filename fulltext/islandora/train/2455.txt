MAR 0 3 2005

hlù

^

A NEW PHASE-LOCKED LOOP WITH ACTIVE INDUCTOR RING OSCILLATOR

Mohamad El-Hage B.Eng, Ryerson University, Toronto, Ontario, Canada, 2002

Submitted in partial fulfillment of the requirements for the degree of Master of Applied Science

Department of Electrical and Computer Engineering Ryerson University Toronto, Ontario, Canada

September, 2004

ppr<or,p,-vQc RVEHSO?; ü:;:m S IT Y U8RARY

©MOHAMAD EL-HAGE, 2004

UMI Num ber: E C 53459

INFORMATION TO USERS

The quality of this reproduction is dependent upon the quality of the copy submitted. Broken or indistinct print, colored or poor quality illustrations and photographs, print bleed-through, substandard margins, and improper alignment can adversely affect reproduction. In the unlikely event that the author did not send a com plete manuscript and there are missing p ages, th e se will be noted. Also, if unauthorized copyright material had to be removed, a note will indicate the deletion.

UMI
UMI Microform E C 53459 Copyright2009 by ProQuest LLC All rights reserved. This microform edition is protected against unauthorized copying under Title 17, United S tates Code.

ProQuest LLC 789 East Eisenhower Parkway P.O. Box 1346 Ann Arbor, Ml 48106-1346

A uthor's Declaration

I hereby declare that I am the sole author of this thesis. I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research. Date .^e.-^Wrr\\yir 3>Q-~^£3DM . Signature

I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. Date S d -A oo M Signatun

11

Borrower's Page

Ryerson University requires the signatures of all persons using or photocopying this thesis. Please sign below, and give address and date.

Ill

A New Phase-Locked Loop With Active Inductor Ring Oscillator Master of Applied Science, 2004 Mohamad El-Hage Department of Electrical and Computer Engineering Ryerson University

A bstract

Many of today's applications require that a phase-locked loop (PLL) operate at high speeds, while maintaining reasonable phase noise and jitter performance. Voltage-controlled oscilla tors (VCO) are important building blocks in PLLs. More importantly, the VCO is the major contributor of phase noise in a PLL. The noisy environment, mainly due to the switching noise generated by the digital portion of these systems, imposes stringent constraints on the design of VCOs, especially phase noise or timing jitter. The switching noise originated in the digital portion of the systems are coupled to the supply and ground rails of the VCO of PLLs. Another important block of a PLL is the charge-pump, a block that is responsible for generating the control voltage to be applied to the VCO. The stability or fluctuation of the control voltage, can severely affect the phase noise performance of the VCO. The research in this thesis, centered on (i) the design considerations of CMOS charge-pumps, (ii) the timing jitter of the delay-cells of low-voltage CMOS ring-VCOs, and (iii) the design of a high-speed ring oscillator. A PLL was designed using a new active inductor 6.3-GHz.ring oscillator, with a tuning range of ±15% was designed in 0.18//m CMOS technology. The ring oscillator employed active inductor loads that resulted in an improvement of about 42% in oscillation frequency when compared to the conventional resistor loaded ring oscillator.

IV

Acknowledgm ent

I would like to thank first and foremost, my advisor Dr. Fei Yuan, for his support, guid ance, and constant stream of fresh ideas through out my research made this work possible. I profoundly appreciate his enthusiasm and close interaction that inspires my exploration of integrated circuits. Moreover, I feel privileged to have had the freedom he has given me while conducting my research. I thank all of the students in the Analog and Mixed Signal group at Ryerson University jJean Jiang in particular, for the numerous technical discussions that helped my research in many ways. I am extremely indebted to Jason Naughton for the CADENCE lab support. I would like to thank Dr. Kaamran Raahemifar, Dr. Lev Kirischian and the defense chair Dr. M. Zeytinoglu at Ryerson University for their participation in my defense. Special thanks go to Oksana Evseeva for her gracious support and countless sacrifices that have allowed me to complete this work.

D edication

I dedicate this work to my parents Khodre and Fairouz El-Hage for the support and endless encouragement they have given me.

VI

Contents
1 Introduction 1.1 M otivation.................................................................................................................... 1.2 Contribution................................................................................................................. 1.3 Thesis Organization.................................................................................................... 2 Phase-Locked Loops 2.1 Basic Topology and Function ................................................................................. 2.1.1 Phase Detectors.............................................................................................. 2.1.2 Voltage Controlled O scillators.................................................................... 2.1.3 PLL Operating Regions ............................................................................. 2.2 Loop D y n a m ics.......................................................................................................... 2.3 Critical Param eters.................................................................................................... 2.3.1 Static Phase E r r o r ....................................................................................... 2.3.2 Tracking R a n g e .............................................................................................. 2.3.3 Acquisition Range ....................................................................................... 2.3.4 Acquisition T i m e .......................................................................................... 2.3.5 Aided Acquisition.......................................................................................... 2.3.6 Phase Noise and J it t e r ................................................................................. 2.4 Charge Pump Phase-Locked Loop C P-PLL.......................................................... 2.4.1 S ta b ility .......................................................................................................... 2.4.2 D y n a m ic s.................................................................................................... . 3 Phase-Frequency D etectors 3.1 Functionality and Performance E v a lu ators......................................................... 3.2 Design Techniques ..................................................................................................... 3.2.1 Phase Detectors............................................................................................. 3.2.2 Phase-Frequency Detectors PFD ............................................................. 3.3 C onclusions................................................................................................................ Charge Pum ps 4.1 F u n ctio n a lity ............................................................................................................. 4.2 Non-ideal E f f e c ts ...................................................................................................... 4.2.1 M ism atches....................................................................................................
vii

1 1 2 3 4 4 5 5 6 8 10 10 12 13 15 16 17 18 20 20 23 23 24 25 28 34 35 36 37 37

4

4.3

4.4 4.5 4.6

4.7

4.2.2 Switch Induced E r r o r s.................................................................................. 4.2.3 Charge Sharing (OFF=> ON) ..................................................................... Basic Charge P u m p s ................................................................................................ 4.3.1 Switch-at-Drain.............................. 4.3.2 S w itch-at-G ate............................................................................................... 4.3.3 Switch-at-Source............................................................................................ Current-Steering Charge-Pumps............................................................................. Differential Current-Steering Charge P u m p s ...................................................... Miscellaneous Charge Pumps ................................................................................ 4.6.1 Charge-Pump with Active Amplifier ........................................................ 4.6.2 Charge-Pump with Error A m p lifier................. 4.6.3 Charge-Pump with Complementary Switches........................................... 4.6.4 Charge-Pump with AC Coupling tran sistors........................................... 4.6.5 High-Speed C harge-Pum p........................................................................... 4.6.6 Fully Balanced C harge-Pum p..................................................................... 4.6.7 Charge Amplifier Charge-Pum p................................................................. Conclusion...................................................................................................................

39 40 42 42 43 43 43 48 49 49 50 51 52 53 53 53 55 56 57 57 58 60 60 61 62 65 70 71 72 72 75 76 79 82 84 85 85 87 89 92

A n alysis o f Supply N oise S en sitiv ity o f VCO D elay Cells 5.1 Noise S o u rc es..................................................................................... 5.1.1 Device N oise..................................................................................................... 5.1.2 Supply N o i s e .................................................................................................. 5.2 Design C onsiderations.......................... 5.2.1 Single-ended and Differential Configurations........................................... 5.2.2 Linearity of L o a d ........................................................................................... 5.2.3 Voltage S w in g .................................................................................................. 5.3 Simulation R e s u lt s ........................ 5.4 C onclusions................................................................................................................ N ew 6.1 6.2 6.3 6.4 6.5 6.6 6.7 A c tiv e Inductor VCO D elay C ell Oscillation Frequency E stim a tio n ......................................................................... Oscillation Frequency of RC Ring O scilla to r..................................................... Active Inductor L o a d s ............................................................................................ Delay Cells with Active Inductor L oads............................................................... Comparative Speed A n alysis................................................................................... Sim ulation................................................................................................................... C onclusions................................................................................................................

Phase-L ocked Loop D esign 7.1 Design Procedure..................................................................................... 7.2 Phase-Frequency D e te c to r ...................................................................................... 7.3 Charge-Pum p............................................................................................................ 7.4 Simulation R e s u lt s ................................................................................................... Vlll

8 Conclusions 8.1 C onclusions................................................................................................................. 8.2 Future Research........................................................................................................... Bibliography A A ctive Inductor and its equivalent circuit V ita

95 95 96 98 104 107

IX

List of Figures
2.1 2.2 2.3 2.4 2.5 2.6 2.7 2.8 2.9 3.1 3.2 3.3 3.4 3.5 3.6 3.7 3.8 3.9 3.10 3.11 4.1 4.2 4.3 4.4 4.5 4.6 4.7 4.8 4.9 4.10 Basic phase-locked loop.............................................................................................. Characteristic of an ideal phase detector................................................................ PLL Regions of Operations....................................................................................... Simple low pass filter.................................................................................................. Loop filter with an added zero.................................................................................. Acquisition of lock in frequencydomain.................................................................. Acquisition of lock in time domain.......................................................................... (L) Jitter in a periodic signal, and (R) Frequencyspectrum of a signal with Phase noise.................................................................................................................... Charge-pump phase-locked loop............................................................................... Gilbert cell PD and characteristic............................................................................ XOR characteristic...................................................................................................... SR-latch PD and characteristic................................................................................ Sample-and-hold PD ................................................................................................... Sample-and-hold PD schematic................................................................................ PFD state diagram...................................................................................................... 2-XO RPFD.......................................... D-Flipflop PFD, and characteristic......................................................................... Dead-zone...................................................................................................................... Dead-zone characteristic............................................................................................ Dead-zone free PFD.................................................................................................... 4 5 7 9 11 13 15 17 19 25 26 27 28 28 29 30 31 32 33 33

Conceptual representation of a charge pump.............................................. 36 (L) Current mismatch, and (R) Pulse-width mismatch....................................... 38 (L) Switch at Drain CP, (M) Switch at Gate CP,and(R) Switch at Source CP. 42 Charge sharing comparison....................................................................................... 44 Charge injection comparison................................................................. 44 (L) Conventional current-steering CP, and (R)NMOS switch only CP. . . . 45 (L) Chang's CP, (M) Current reuse, and (R) Current reuse and positive feedback. 46 Charge up of current-steering CPs......................................................; .................. 47 Output current of current-steering CPs.................................................................. 47 Diflferential current-steering CP................................................................................ 48

X

4.11 4.12 4.13 4.14 4.15 4.16 4.17 4.18 5.1 5.2 5.3 5.4 5.5 5.6 5.7 5.8 5.9 6.1 6.2 6.3 6.4 6.5 6.6 6.7 6.8 6.9 7.1 7.2 7.3 7.4 7.5 7.6 7.7 7.8 7.9 7.10 7.11

Self-biased differential current-steering CP.............................................................. Charge-pump with active amplifier........................................................................... Charge-pump with error amplifier............................................................................ (R)Improved switch at drain CP, and (R)Improved switch at source CP. . . Charge-pump with AC coupling transistors............................................................ High-speed charge-pump............................................................................................. Fully balanced charge-pump....................................................................................... Charge amplifier charge-pump................................................................................... Delay cells: (L) Single-Ended, and (R) Differential............................................... Delay Cells: (L) Triode or Current source load, and (R) Symmetric load. . . IV characteristic of symmetric loads........................................................................ Cross-coupled delay cells: (L) P-Latch, and (R) N-Latch.................................... Cross-coupled delay cell with symmetric loads....................................................... Cross-coupled delay cells: (L) without skewed delay, and (R) with skewed delay. Supply Sensitivity test of a differential delay cell.................................................. VCO output: Symmetric Load.................................................................................. VCO output: Cross-coupled N-Latch....................................................................... Ring oscillator and its linear model.......................................................................... (L)Differential Delay cell, and (R) Small signal model of cell............................. Inductive load delay cells: (L) PMOS, (M) NMOS, and (R) NMOS-low voltage. Proposed differential delay cell with active inductive loads................................. Load impedance of delay cell employing active inductors.................................... Bode plots of H{s) = Conventional VCO output waveform at 5 GHz. . .......................................... Proposed VCO output waveform at 7 GHz............................................................. Simulated frequency tuning characteristic of the proposed VCO....................... Dead-zone free PFD..................................................................................................... Transistor implementation of DFF........................................................................ . Transistor implementation of AND gate.................................................................. Phase frequency detector simulation results.............................. Current reuse charge-pump implemented................................................................ The PFD and CP signals when the feedback signal lags reference signal. . . . The PFD and CP signals when the feedback signal leads reference signal. . . PLL simulation: VCO output lags input reference signal.................................... Reference and feedback signals before and after lock............................................ PLL simulation: VCO output leads input reference signal.................................. Reference and feedback signals before and after lock............................................

49 50 51 52 52 53 54 54 60 61 62 63 64 65 67 67 68 73 73 77 78 79 81 83 83 84 87 88 88 89 90 91 91 92 93 93 94

A .l Active Inductor............................................................................................................. 104 A.2 Small signal equivalent circuit of Active inductor......................................................105

XI

List of Tables
4.1 Charge Pump Functionality...................................................................................... 5.1 5.2 5.3 5.4 Rise time of delay cells and its normalized worst-case sensitivity...................... Fall time of delay cells and its normalized worst-case sen sitiv ity ..................... Average delay of delay cells and its normalized worst-case sensitivity. . . . . Oscillation frequency of delay cells and its normalized worst-casesensitivity. 37 68 69 69 70

XU

Chapter 1 Introduction
1.1 M otivation

Phase locked loops (PLLs) are used in almost every communication system. Some of their uses include recovering clock and data signals, performing frequency-phase modulation and demodulation and recovering the carrier from satellite transmission signals and frequency synthesis.

The demand for high speed, wide bandwidth communication systems has led to advance ments in both wireless and fiber-optic systems. To ensure economic viability, the entire semiconductor industry has been pushing for the implementation of a low-cost, low power, high-speed fully integrated receiver-on-chip.

To achieve the goal of a fully integrated receiver on-chip, where analog and digital blocks co-exist on the same substrate, the PLL has to operate at high speeds, while maintaining reasonable phase noise and jitter performance. Voltage-controlled oscillators (VCOs) are important building blocks of PLLs. More importantly, the VCO is the major contributor of phase noise of PLLs. Another important block of a PLL is the charge-pump, a block that is responsible for generating the control voltage to be applied to the VCO. The stability or fluctuation of the control voltage, can severely affect the phase noise performance of the VCO. In addition, the noisy environment, mainly due to the switching noise generated by

2 the digital portion of these systems, imposes stringent constraints on the design of VCOs,

especially on phase noise or timing jitter. The switching noise originated in the digital por tion of the systems is coupled to the supply and ground rails of the VCO of PLLs.

The research of this thesis, is centered on (i) the design considerations of CMOS chargepumps, (ii) the timing jitter of the delay-cells of low-voltage CMOS ring-VCOs, and (iii) the design of a high-speed ring oscillator.

I chose phase locked loop because it is an excellent research topic, as it covers many disci plines of electrical engineering such as communication theory, control theory, signal analysis, noise characterization, microelectronic transistor design, digital circuit design and non-linear circuit analysis.

1.2

C ontribution

The contributions made in this thesis are three-fold: 1. A comprehensive review of the architectures of CMOS charge pumps and an in-depth comparison of their characteristics such as speed, minimum supply voltage, mismatchinduced errors, charge injection and clock feed-through induced errors, and noise re jection is presented. 2. A comparative study of the architecture and timing jitter of the delay-cells of lowvoltage CMOS ring-VCOs. Design considerations, such as noise, single-ended versus dilferential configurations, linearity and symmetry of load, and the output voltage swing of delay cells were examined in detail. The worst-case sensitivity of the delay time of the delay cells and that of the oscillation frequency of corresponding ring-VCO were analyzed and simulation results are presented. 3. A new delay cell utilizing inductive loads to enhance the oscillation frequency of a four-

3 stage ring oscillator was proposed. Both theoretical analysis and simulation results are

presented. The new delay cell improves the oscillation frequency by 42%.

1.3

Thesis Organization

This thesis is organized as follows: · Chapter 2 introduces the PLL system theory, challenges and trade-offs that lie in the design of PLLs. · Chapter 3 presents the performance metrics of phase-frequency detectors and examines their different architectures. · Chapter 4 examines both the architectures and design considerations of CMOS charge pumps for phase-locked loops. · Chapter 5 presents a comparative study of the architecture and timing jitter of the delay-cells of low-voltage CMOS ring-VCOs. Design considerations, such as noise, single-ended versus differential configuration, linearity and symmetry of load, and the output voltage swing of delay cells are examined in detail. The worst-case sensitivity of the delay time of the delay cells and that of the oscillation frequency of corresponding ring-VCO are presented. · Chapter 6 details the design of a new delay cell used in a 4-stage ring oscillator. A comprehensive analytical analysis of the oscillating speed of ring VCOs is provided. Simulation results are presented to verify the speed improvement. · Chapter 7 details the design of a charge-pump PLL that employs the proposed delay cell. System level design, transistor level design and simulation results are presented. · Chapter 8 concludes the thesis and presents several research areas to be explored in the future.

Chapter 2 Phase-Locked Loops
This chapter introduces the PLL system theory, challenges and trade-offs that lie in designing a PLL. In Section 2.1, the PLL is introduced and its function and operating regions are de fined. The PL L's loop dynamics are formulated in Section 2.2. Critical parameters of PLLs are defined in Section 2.8. Section 2.f presents the loop dynamics and stability analysis of a charge-pump PLL.

2.1

B asic Topology and Function

A phase-locked loop is a feedback control circuit that synchronizes the frequency of the oscillator's output with that of a reference signal. A simple PLL utilizes three basic blocks: a phase detector (PD), a loop filter (LPF), and a voltage controlled oscillator (VCO), as shown in Figure 2.1 [3].
InpuL Phase Detector Loop Filter VCO Output

Figure 2.1: Basic phase-locked loop. A phase detector compares the phase difference between the input reference signal and the oscillator output. The PD generates an output voltage vpo proportional to the phase

difference between the two signals. A loop filter is a low-pass filter that filters out the high frequency components of vpo to produce Vc, which is the control voltage of the VCO. The control voltage Vc determines the frequency of the output voltage of the VCO.

2.1.1

P h ase D etectors

An ideal phase detector produces an output signal whose DC value is linearly proportional to the phase difference of the two input signals [2]:

VpD = KpoA(p,

(2 . 1)

where K p p is the gain of the phase detector, and Acf) is the phase difference between the two input signals, as shown in Figure 2.2.
i

1
--^

_

I I I I I I

Phase Detector

V p o (t)
0 A (|)

Figure 2.2: Characteristic of an ideal phase detector. The phase detector input-output characteristic should ideally be linear, non-periodic, and monotonie for a wide range of phase difference values. In reality, the gain or slope K p p of the characteristic is not constant and may depend on either the amplitude or duty-cycle of the input signals. Chapter 3 will further evaluate the design considerations of PDs, the different architectures, their advantages and limitations.

2.1.2

V oltage Controlled O scillators

An ideal voltage controlled oscillator produces an output signal whose frequency Uout is a function of the control voltage %[!]:

^out --^FR + Kvco^ci

(2.2)

6 where copR is the free-running frequency of the VCO and K y c o is the gain of the VCO. The

relations between time, phase, and frequency provide us with an expression of the output voltage of the VCO:

y(t) = Acos{uFRt + K v c o

J-- O O

f

Vcdt).

(2.3)

The VCO is considered a linear time-invariant system whose output of concern is the output excess phase. Equation (2.3) provides us the input {vc) - output {< f> out) relationship as:

<f>out{t) = K v c o

J

Vcdt,

(2.4)

from which we obtain the input-output transfer function:

^ o u t(g ) _

K v c o

r\
.

Vc{s)

s '

It is important to know that Vc in itself does not determine the phase at the output, but the frequency. A change in Vc will lead to either an increase or decrease in the output frequency L O ou t and consequently the output will either accumulate or dissipate phase faster thereby reducing phase-error. In essence, the initial conditions of the VCO and the system response determine the phase.

2.1.3

PLL O perating R egions

In this section we define the lock conditions, locked states, and the regions of operation of PLLs. Note that the behavior of PLLs in an unlocked state is not important. What is important is whether the PLL enters lock and how it acquires lock.

For PLLs to achieve lock, both frequency acquisition and phase acquisition must be attained. Frequency acquisition is defined as having equal input and output frequencies [1]. This con dition is extremely important for applications such as frequency synthesis that is intolerant to frequencyinaccuracies. a constantvalue, Phase acquisition is defined ashaving the phaseerror settle to casewhere frequency

notnecessarily zero, with respect to time. Inthe

acquisition is met, but phase acquisition is not, the loop must continue the transient, tem porarily loosing frequency acquisition until both lock conditions are met.

In the locked state, all signals within the phase-locked loop will be in a steady state [1]. The phase detector will generate an output whose average DC value is proportional to the phase difference, and the VCO will oscillate at a frequency equal to the input frequency with a phase difference A^.

The PLL's operation can be dissected to four different regions. In the case when the output signal is not locked in frequency and phase with the input signal, the PLL is said to be in a dynamic state. Alternatively, the PLL is said to be in a static state when the output signal is locked with only the frequency of the input reference signal. The four regions of op eration are shown in Figure 2.3 [3] as hold range, pull-in range, pull-out range, and lock range.

Static Stability Limit Dynamic Stability Limit ±A03h ±A(Op, ±Aco,,

Conditionally Stable Dynamically Unstable Figure 2.3: PLL Regions of Operations.

Hold range: The hold range A ojh is the frequency range over which the PLL can maintain phase tracking without falling out of lock.

8

Pull-in range: The pull-in range Acopj, also known as capture/ acquisition range^, describes the frequency range of the input signal over which the PLL can acquire lock. The process of acquiring lock within the pull-in range maybe a slow process. However, if the input reference frequency is within the narrower lock range, then the process of acquiring lock will be faster.

Lock range: The lock range A ujl, also known as the tracking range^, is the input frequency range over which the PLL can acquire lock without cycle slips, i.e. within a single beat.

Pull-out range: The pull-out range Awpo determines the dynamic limit for stable operation. In other words, it determines the maximum value of the frequency step that can be applied at the input without causing the PLL to unlock. Assuming the PLL is in lock, if a frequency step that exceeds the pull-out range is applied to the input, the PLL will not be able to track and will fall out of lock.

2.2

Loop D ynam ics

While the transient response of a phase-locked loop is a nonlinear process that is diflScult to formulate, a linear approximation is useful in understanding the PLL's behavior and design tradeoffs. In this section, the transfer function of the PLL is derived and its static and dynamic behaviors are analyzed [2]. Using the linear model, the open loop transfer function of the PLL is given by:

Ho(s) =

= K po G lpf (s ) ! ^ ,

(2.6)

where G l p f is the transfer function of the loop filter. Assuming the loop filter in use is a simple RC low pass filter, the transfer function will have the following form:
^We will avoid using the deceptive term capture range, since it is used as an alternative for lock range in some texts and pull-in range in others. ^When frequency detection is a property of the phase detector, tracking range becomes equal to acquisition range (Chapter 3).

9

G l p f {s) = Y q r z z : = r + I â c '

W V\AVin Vout

Ri

F ig u r e 2.4: Simple low pass filter.

Thus the closed loop transfer function is simplified to T T( \ 1 + Ho(s) _ K pd G lPf {s ) K vco s + K p d G lpf {s ) K vco _
w^pf l

KppK yco ^ ^ p d K vco

< 2 gs

The derived closed loop transfer function indicates that the PLL is a second order system with the loop gain K = K p p K v c o and two poles, one contributed from the LPF and the other from the VCO. From control theory, we recognize the form of the close loop transfer function as:

= s^ + 2C^,,s + u ,r where is the natural frequency, and C is the damping factor.

By comparing (2.8) and (2.9), we obtain

U )n -- \j^LPF^ 1 C = For a flat frequency response, the optimum value for damping factor C is equal to

(2.10)

This

value dictates a relationship between the LPF's cut-off frequency u> lpf and the loop gain K: K = This relationship puts a constraint on choosing K and
ujlpf

independently

in the design of a PLL.

2.3

Critical Param eters

In this section, we define the performance criteria of PLLs. They are static phase-error, tracking range, acquisition range, and acquisition time [1, 3, 5].

2.3.1

S tatic P hase Error

Even-though the PLL operates on excess phase ^outj its phase error^ final settling (t -- > oo = s-- ) 0) value and its response to frequency variations is of interest. The phase error transfer function is obtained from:

With the current configuration where, a single pole loop filter is used. Equations (2.9) and (2.12) indicate that a static phase shift at the input is transferred to the output unchanged (as s ^ 0, H(s) -- )  1 and He{s) 0). On the other hand, a rapid variation of the phase of

the input {dynamic phase shift) will lead to a small variation in the phase of the output.

Given that a phase shift is due to a change in frequency, it is worthwhile to analytically see the effect of an input step frequency Au}u{t) to the output phase error, where u{t) is the unit step function. The phase error is calculated as follows^:

$e(s)

=

He{s)^in{s) + 2(^U JnS Aw -h 2Cw,,s + Lol

(2.13) (2.14)

and its final settling value is:

t -¥00

lim $e =

5->0

lim s$e(s),

(2.15)

^In case where the PLL is designed to lock onto a non-zero phase difference (A0 = constant ^ 0), then

ÿe 7 ^ A0.
"^The Laplace transform of the frequency step equals Aw/s, therefore the input phase would be its derivative Aw/s^.

= Auj -- , = The above calculationsconclude thatstatic frequencyvariations at the

2C

(2.16) (2.17) input will manifest It is obvious

themselves as staticphase shiftsattenuated by a factor K atthe output.

that in order to minimize the phase error, a high loop gain K is needed. However, Equa tion (2.11) indicates that a tradeoff has to be made between C that determines the settling behavior (see Section 2.3.4), ioipp that determines the cutoff frequency of the loop filter, and K that determines the phase error, and width of the acquisition range (see Section 2.3.3).

To allow for a larger gain independent of ujlpf and without sacrificing the settling time, a zero (resistor R 2 ) added to the LPF would modify the loop filter transfer function to
R,

°- - - - - - AAA/'--
Vin Vout

F ig u r e 2.5: Loop filter with an added zero.

A similar calculation to those presented before will yield a closed loop transfer function

H is) =
(jJz

+1) I 1 .9 4- K f \ (jJ T r> TP + l)s + u Jlpf
-h

(2.19)

where. w. =

(2.20) (R, + % ) C

12

and the damping factor C

<=y

A

(jü z

f- 1),

U>z>

<^LPF-

(2.22)

Using the same optimal ^ value introduced before, the reader can similarly calculate the gain K as 32ulpf , &much larger gain compared to K = However, a disadvantage of

adding a zero to the loop filter is the decrease in the attenuation of high frequency signals. A possible solution would be to add another pole far from the zero in the form of a capacitor at the output. The downside of the additional pole is the degradation of the settling time, due to the change in the optimum damping factor.

2.3.2

Tracking R ange

As explained earlier, the tracking range is defined as the input frequency range over which the PLL can acquire lock without cycle slips(sfaifc tracking) i.e. within a single beat [3].

Assuming that the loop filter's components are linear, for the PLL to track, the three char acteristic curves (i) (f> e vs. a>i,,, (ii) vs. (f> e, and (iii) W out vs. Vc must vary monotonically.

In other words, the edge of the tracking range is determined by the slope/gain of each of the characteristic curves. The point at which any of the slopes approach zero or change sign defines the edge of the tracking range. While, the tracking range depends greatly on the type of phase detector used (see Chapter 3), for simplicity, we will assume that the phase detector is a simple analog multiplier. The gain K p o of an analog multiplier, changes sign for input phase differences A 0 greater than | . Voltage controlled oscillators, on the other hand, have a limited frequency range, beyond which the gain K v c o drops sharply. To lock within a single beat, the VCO output frequency can not vary by more than:

Awx, = A'pxjA'yco sin (-- ). ,

(2.23)

Because the tracking range refers to the deviation from the center free running frequency, the tracking range is half of the lock range.

2.3.3

A cquisition Range

13

In the case where a PLL acquires lock within a number of cycle slips or beats, the PLL is said to be in the dynamic tracking mode or within the acquisition range. In this section, we will determine the maximum input frequency range over which the PLL can acquire lock. We will present the process of acquiring lock in both frequency and time domains [1].

x(t)
CO,+Aco

Phase Detector

Loop Filter

VCO

X ( a > )
CO

W)

_L
0 Aco

cO j^-Aco

co^^+A co

m
CO

Aco

+2Aco

F ig u r e 2.6: Acquisition of lock in frequency domain.

Frequency domain: Assuming that the phase detector is a simple analog multiplier, we will plot the frequency spectra (Figure 2.6) of the signals around the loop to illustrate the process of acquiring lock. With the assumption that the initial conditions of the loop filter are zero, the VCO output frequency should be ujout = ^/r- A frequency step Aw is applied at the input to give w,,, = w/r+Aw. It can be shown analytically that the VCO output voltage will be [1]:

14

y{t) fa A cos U frt ----- ^ ^ ^ ^ s in w /r fs in (Aut), l \c J

K

(2.24)

where A is the amplitude of the output voltage, and A^ is the amplitude of the modulated control voltage. The spectra of the modulated signal has sidebands at ± Aw, the phase

detector multiplies the sidebands with the input frequency, resulting in a DC component at the control voltage. This DC component will grow over a number of cycles adjusting the VCO frequency until lock. From our analysis, we observe that the acquisition range is a function of: (1) the attenuation of the loop filter components at Aw and (2) the feedback strength of the DC component. In other words, the acquisition range is a function of the loop gain at Aw. Simple type-I ^ PLLs mentioned so far, experience a fading loop gain at larger frequency differences.

Time domain: Assuming the same initial conditions mentioned above, in this section we illustrate the process of lock in the time domain. During the first cycle, where the feedback in the loop has not yet affected the response, the output of the combined analog phase de tector and loop filter Vc is a sinusoid with a frequency equal to Aw = W j,, --ojout = Moreover, the frequency of the VCO increases and decreases with %. The implication is that Aojmax refers to positive peak of the sinusoid and Aw^in refers to the negative peak.

Without the feedback signal, the sinusoidal signal is periodic and symmetric with an aver age DC value of zero. To acquire lock, the DC value of Vc must move the frequency of the VCO in the direction of the reference input frequency. Fortunately, the feedback signal once introduced, has a time-varying frequency due to frequency modulatioq/at the VCO. If the output frequency is modulated in the positive direction, the frequency difference decreases and the sinusoid will have longer positive cycles as shown in Figure 2.7. Consequently Vc will have a larger positive DC component that will allow the PLL to lock.

®Type-I refers to the order of the PLL, more specifically the number of poles in the loop filter, in this case being one

15

F ig u r e 2.7: Acquisition of lock in time domain.

We can conclude that the proximity of w*» to W out will determine whether the loop will acquire lock within one beat or several beats. The number of cycle slips needed for lock is a function of the initial conditions of the loop filter and VCO [3]. The analytical estimation of the acquisition range is [3];

AW acg = K p d K vc O I G lpf^A o;)

(2.25)

2.3.4

A cquisition Tim e

The terms acquisition time and settling time are often mistakenly interchanged. The differ ence stems from the operating region of PLLs. While in the lock-tracking range, the time needed for a PLL to lock within a defined phase-error is referred to as the lock-in or settling time. For a second order PLL (C < 1), the step response is given by [1]:

V{i) =

u{t),

(2.26)

where

= sin"^y/l --C ," ^ . The settling time can be derived form (2.26):

16

1
^settle
-- ^

2
~

(^ U > n

^LPF

·

(2.27)

Clearly, there is a trade-off to be made between stability and ripple noise on the control voltage Vc- To minimize the ripple in the control voltage, the cut-off frequency of the loop filter has to be decreased. The drawback of decreasing u )lpf is stability degradation in the form of a prolonged settling time.

Acquisition time on the other hand, refers to the acquisition operating range of the PLL, and so defines the time needed for the PLL to acquire lock given a certain frequency difference. The acquisition time for a linear type-I PLL is given by [3]:

2.3.5

A ided A cquisition

For a PLL employing a simple one-pole loop filter, designed for an optimum damping factor of C == ^5 Equation 2.25 will conclude an acquisition range of a rather

small range. Due to jitter and sideband suppression requirements, minimize the ripple on the control voltage Vc, increasing ( j Jlpf is not feasible. Moreover, the loop gain fades as the input output frequency deviation increases. For the reasons mentioned, PLLs often employ a frequency detector to aid in the acquisition of frequency. The frequency detector will produce a DC voltage proportional to the frequency difference w,» --Uout- The concept is simple, for large frequency differences, the VCO will be driven by the DC of the frequency detector, and for small frequency differences, the VCO will be driven by the DC of the phase detector. With the addition of frequency acquisition, the loop gain is now constant and independent of the value of w,» --l O ouu this can substantially increase the acquisition range to a limit set by the tuning range of the VCO (see Chapter 3).

2.3.6

P h ase N oise and Jitter

17

One of the more important design considerations of phase locked loops is phase noise or jitter. An ideal periodic signal has a frequency spectra with an impulse at the fundamental frequency, in addition to energy impulses at DC and the harmonic frequencies of the funda mental frequency. Timing jitter is the resultant of varying zero crossings in the time domain (see Figure 2.8(L)). In the frequency domain, these variations result in energy skirts (see Figure 2.8(R)) known as phase noise [1, 3, 12].

P(co)
Carrier Power^

v(t)

loise Power

(L)

Figure 2.8: (L) Jitter in a periodic signal, and (R) Frequency spectrum of a signal with Phase noise. Phase noise is defined as the ratio of the power of the sideband noise Pgg in a IH z bandwidth at a given offset frequency Aw to the carrier power PcP s b {^o d" Aw, IH zB W )

T'f Aw} -- 10 logjQ

(2.29)

Phase noise in the frequency domain in specified in d B c /H z at a given frequency offset Aw, and translates into jitter specified by its peak-to-peak time value [picoseconds) in the time domain. While all PLL blocks contribute to the overall phase noise, we will only present the more dominant noise sources, input referred phase noise, and VCO generated phase noise. In both cases, we assume that the phase noise is a random component of the excess phase that the PLL operates on.

18

Input Phase Noise: The input-output phase transfer function given in (2.9), indicates that for a constant input excess phase or a slowly varying input phase with respect to time, H (s) is approximately equal to unity and consequently the output follows the input. As the input phase noise ^tn(^) varies at higher rates, the output phase depreciates to zero and the PLL fails to track. The input phase noise transfer function, obviously has a low pass character istic. In order to reduce the input refereed phase noise, the PLL loop bandwidth must be reduced. The consequences of reducing the loop bandwidth are, a reduction in lock speed, a limited capture range, and a degradation in stability.

VCO Phase Noise: The phase noise generated by the VCO (j>vco is modelled as an input signal. Assuming the VCO phase noise is uncorrelated to the input phase noise <j>in{t)i then the VCO phase noise transfer function is: ^out{s) _ ^ vco(s)
s {s

+ ujlpf) + 2^a>,,s +

(2 30)

The VCO phase noise transfer function has a high pass characteristic, and in order to reduce the VCO-referred phase noise, a PLL with a wide loop bandwidth is preferred. Clearly, a tradeoff has to be made regarding the width of the PLL bandwidth and its effect on the noise contribution from the input and the VCO. The application will dictate the loop bandwidth. The VCO phase noise is caused by several sources: up-converted 1 / f noise of the transistors, ripple in the control voltage, and power supply voltage fluctuations among other things. Chapter 5 will elaborate more.

2.4

Charge Pum p Phase-Locked Loop CP-PLL

The charge-pump phase locked loop (CP-PLL) shown in Figure 2.9 is preferable to the conventional PLL for the following reasons: · The CP-PLLs pull-in range is limited only by the VCO's tuning range [3].

Input

UP

19
Charge Pump Loop Filter VCO

Phase Detector
DN

Output

Figure 2.9: Charge-pump phase-locked loop. · The CP-PLL locks to a phase error of zero, even if the reference input frequency is not equal to the center free-running frequency of the VCO, as was the case in the simple PLL [1], · The CP-PLL displays more immunity to power supply variations [4]. · The CP-PLL does not experience charge decay as compared to the conventional PLL. This is because, in the simple PLL, charge is applied to the loop filter capacitor at every phase comparison, and between the phase comparison, the charge across the capacitor decays. With a charge pump in place, decay is minimized [2]. The CP-PLL, also referred to as the classical digital PLL uses the charge pump at the output of the phase-frequency detector. Only in this case, the phase-frequency detector produces two control signals U P and D N as opposed to one. The control signals will determine how much error current is applied to the loop filter. The charging and discharging of the loop filter will determine the value of the control voltage.

The combined response of a charge pump-phase frequency detector to a static phase differ ence is a linear ramp. In other words, the transfer function of the charge-pump and phase frequency detector combined, contains a pole at the origin and can be represented as: KpD

H (s) P F D - C P --

(2.31)

Clearly, with the addition of the charge-pump and all its advantages, the stability and dynamics of the PLL have changed. In the following sections, we analyze the stability and dynamics of CP-PLL [1, 12].

2.4.1

Stability

20

To ensure that the CP-PLL is a stable system, care must be taken in the design of the loop filter. With solely a capacitor as the loop filter, the new PLL transfer function can be easily computed as:

The above transfer function has two imaginary poles, rendering the system unstable. An added zero in the form of a resistor in series with the capacitor of the loop filter can help stabilize the system. The disadvantage of adding a resistor, is an increase in ripple at the control voltage. This ripple can be suppressed by a second capacitor C 2 in parallel with the R --Cl combination. C 2 should be chosen in the order of one-tenth of Ci, so that the system can still be analyzed as a second order system.

2.4.2

D ynam ics
= ^in -- 4>outi the charge

Assuming that the loop is experiencing a phase difference of pump will produce an average current equal to:

lave = and the loop filter will produce a control voltage:

(2.33)

KW = ^ ( « + ^ ) .
Consequently, the VCO output phase will be equal to:

(2.34)

$out(5) = The closed loop transfer function, can easily be computed to:

(2.35)

^'

A$(4

S ^ + iK ycoR s + ^ K y c o '

'

21

that has the form:

from which we can calculate: K vco i (2.38) (2.39)

27tC 'p =
C =

We can also repeat the calculations seen in Section 2.3.4, to calculate

^settle

--

=

r

Ê ^

o-

With the dynamics computed, we note the following observations: · High frequency applications require high loop bandwidth, which is proportional to the natural frequency Using the conventional PLL, could only be increased by

increasing u> i,pf (see Equation 2.11), which is undesirable for low noise applications (see Section 2.3.6). In a CP-PLL, can be increased through the charge pump current

I or VCO gain K y c o as shown in (2.39). · By comparing (2.27) and (2.40), we notice that with the CP-PLL design, tsetiie is independent of the loop filter capacitor. · The dynamic analysis of the simple PLL is based on the assumption that the system is a linear system. This assumption holds true on condition that the input reference frequency be much greater than the loop bandwidth. When the condition does not hold, discrete time analysis should be used. Since the loop bandwidth is directly

proportional to the natural frequency o;,,, discrete time analysis leads to the stability

22 limit [5]:

which puts a limit on the value of the resistor R. On the other hand, in the CP-PLL configuration, is independent of R, which eases the design constraint.

Chapter 3 Phase-Frequency Detectors
The dynamics of the PLL described in Chapter 2, conclude that the performance of the PLL -Tracking Range, Acquisition Range, Loop Gain, and Transient Response- depends on the properties of the PD in-use. Section 3.1 defines the performance evaluators of the PFD. This is followed by Section 3.2 that examines the different design techniques of phase detectors, phase-frequency detectors, and the dead-zone concept.

3.1

Functionality and Perform ance Evaluators

An ideal phase detector produces an output signal whose DC value is linearly proportional to the phase difference of the two input signals. The phase detector input-output characteristic should ideally be linear, non-periodic, and monotonie for a large range of phase difference Açi. In reality, the gain or slope K pd of the characteristic is not constant and may depend on either the amplitude or duty-cycle of the input signals. The performance evaluators of a phase detector are illustrated below [1, 2, 3, 8].

Tracking Range: We can recall that the edge of the tracking range of a PLL is defined as: where = K p o K y c o sin f · Therefore, we have to ensure that the PD characteristic

is monotone for a large phase difference A(f).

23

24 Acquisition Range: The acquisition range weis defined as: Awac? = K p o K v c o | G l p f U ^ ^ ) |,

the gain of the PD, K p o is constant and independent of the amplitude and duty-cycle of the input signals. Moreover, the phase detector's ability to detect input signals of different frequencies can greatly enhance the acquisition range, and remove its dependence on the gain KpD and loop-filter frequency u )lpf -

Lock Condition: Ideally, in the locked state the phase detector's output is zero, the chargepump is no longer switching, and the control voltage is fixed.-In practice, the phase detector's output is not zero, and can create unwanted switching activity at the charge-pump which increase the jitter and ripple on the control voltage Vc-

Sensitivity to input data pattern: PDs usually require that the input data have a minimum timing content. Long strings of ones and zeros could result in high VCO output jitter, due to the activity introduced to the control voltage Vc, even while in lock.

Lock Speed: Lock speed is an evaluation parameter of PLLs, but the choice of PD can greatly affect the time needed for a PLL to lock, given a phase difference. For example, digital PDs operate at slow speeds and require sufficient time for the outputs to stabilize, they sufier from long Lock time. Analog PDs are more suitable for high-speed applications, but are slightly more complex.

3.2

D esign Techniques

Phase detectors can be categorized into: (i) Combinational PDs, (ii) XOR PDs, and (iii) Edge-triggered PDs [8]. In the following section, we will examine PDs that are widely used, and highlight their advantages, disadvantages, and performance limitations.

; V >f
25

3.2.1

P hase D etectors

Gilbert Cell P D
The schematic and transfer characteristics of the Gilbert cell based PD is shown in Figure 3.1 [1]. When the inputs of the cell are of small amplitude, the cell behaves as an analog multiplier, whose output is determined by T T -- Vout =
o c AB

,,

cos(A0),

(3.1)

where o; is a factor due to the multiplier, A and B are the amplitudes of the input signals. Although this implementation is characterized as having a high operating speed, its inputoutput characteristic is nonlinear, sinusoidal and periodic. For phase differences near 90", the relationship is approximately linear. While the characteristic of the cell in Figure 3.1 indicates that it has a limited tracking range of 90". Within the range, the PD 's gain is a function of the amplitude of the input signals. Moreover, the cell suffers from high statistic power consumption, and can not detect frequency errors.

Vout

+ J C

Figure 3.1: Gilbert cell PD and characteristic.

26

XO R P D
When the inputs of the cell shown in Figure 3.1 are of large amplitude, the cell behaves as a XOR gate or a digital multiplier [1], whose output is determined by the following equation;

(3.2)
7T

-K

+ K

2k

Figure 3.2: XOR characteristic. As compared with the Gilbert cell PD, the tracking range has been improved to (0° ~ 180°) as shown in Figure 3.2, and the gain is no longer dependant of the amplitude of the input sig nals. A drawback of this circuit is the output's dépendance on the duty-cycle of the inputs; i.e. when the phase difference between the inputs varies from 90°, the output duty-cycle will no longer be 50%, resulting in an output DC value proportional to A(f>. This manifests itself as a static phase error in the PLL.

SR-Latch P D
The SR-Latch [12], is an edge-triggered 2-state PD. The rising edge of A drives Q to '1' and the rising edge of B resets Q to 'O '. Hence, the differential output changes sign for every con secutive rising edges of the inputs. Inherently, the input and output frequencies are the same.

The advantages of the SR-latch are: (1) Monotonie Acquisition range of ±180°, and (2) a DC output independent of the duty-cycle of the inputs as shown in Figure 3.3. The drawbacks of this cell are: (1) For applications that require frequency multiplication/ synthesis, equal

27 input and output frequencies is undesirable, (2) In cases where one of the input frequencies

is an integer multiple of the other, the SR-latch generates a nonzero DC output. As a re sult, PLLs employing an SR-Latch may lock onto a higher harmonic, and (3) the SR-latch provides only two output states, giving rise to significant ripple on the control line in the locked condition and hence producing greater jitter at the VCO output.

>S B

R -S Latch

Vout

-n
271

>R

Figure 3.3: SR-latch PD and characteristic.

Sample-and-Hold P D
Linear PDs are characterized as having linear input-output characteristics, with minimal ac tivity at the charge-pump after lock. Their drawback was in generating pulse-widths equal to a fraction of the clock period at high speeds. Digital PDs, on the other hand, employed simple flip-fiops for the maximum speed, but provided only two output states creating sig nificant ripple on the control line in the locked condition and hence producing greater jitter at the VCO output. The sample-and-hold PD proposed in [7], attempted to overcome these limitations.

The master-slave sample-and-hold (S&H) circuit is equivalent to an analog D-fiipfiop whereby each data transition samples the value of the VCO output as shown in Figure 3.4. The ad vantages of this topology are: (1) the master-slave configuration avoids a transparent path between and Vout producing a voltage linearly proportional to phase difference for most

of the period, and (2) the path with large switching transients operates at the data rate and not the VCO rate, minimizing the activity on the control voltage.

28
out

--o -- Ô --

0

V out

I
D in

T^p

1

1/

Anr ^ p Din

t

1

L

Figure 3.4; Sample-and-hold PD.

D in '

» -l

M3

M 6'

L Z a 'a
I ir M 7 a M 8^ r

t

p=

Figure 3.5: Sample-and-hold PD schematic. An implementation of the S&H circuit is shown in Figure 3.5. The master and slave circuits are differential pairs whose tail current and load turn off simultaneously, storing the value of the VCO output on the parasitic capacitances Cpi to Cp^. The control circuit is imple mented in PMOS transistors to allow for low-voltage operation.

The drawbacks of this circuit are: (1) limited acquisition range of ±50° [7], (2) sensitivity to the input data pattern, and (3) the speed is limited by the current steering circuit.

3.2.2

Phase-Prequency D etectors P F D

The main drawback of phase-detectors is their periodic transfer characteristic, which implies that phase-shifts of 27t cannot be distinguished. When the frequencies of the two input

29 signals are dilferent, phase will accumulate, the output of PDs becomes unpredictable, de

pending on how far the loop is away from the lock state, acquisition time can suffer greatly if one of the PDs mentioned is used. A solution to extend the acquisition/ tracking range and the lock speed of PLLs is to use phase-frequency detectors (PFDs) [1, 2, 12].

Phase-frequency detectors are able to sense phase as well as frequency differences when the loop is not locked. When in lock they behave as a PD, outputting a signal that is linearly proportional to the phase difference of the two input signals. In order to detect frequency differences, PFDs must contain memory, compared to the memoryless PDs. One possible so lution is to implement PFDs as an edge-triggered sequential machine, as shown in Figure 3.6.

State II

b1

State 0

At (

State I Qa=1

Q a = «
At

(

cu=o

fit

Figure 3.6: PFD state diagram. The PFD functions as follows: ·
lo a

< C Ü B - PFD produces positive pulses at Q a , while Q b remains at zero.

· iüA> wg: PFD produces positive pulses at Q b , while Q a remains at zero. · ( j Ja =
ojb' -

PFD produces positive pulses at either Q a or Q b with a width proportional

to the phase-difference between the two input signals. Ideally, Q a and Q b are never high at the same time since they control the charging and discharging of the CP. Consequently, the three logical states are as seen in Figure 3.6. Assuming the circuit is rising-edge triggered, and we start in State 0, a transition on A takes it to State I, another transition on B takes it to State 0 and so on... Two possible implementations of the PFD are presented.

30

Two-XOR P FD
The Two-XOR PFD is used in conjunction with a 4 stage ring VCO generating eight dif ferential clock signals CLKl through CLK4 spaced by 45". The D ataiead signal is the resultant of XORing the CLKl and CLK3 signals and hence is a periodic signal that acts as a charge-down signal, while the D a ta ia g signal is the non-periodic signal, resultant of XORing the CLKl and Data signals and acts as the charge-up signal. Figure 3.7 illustrates the operation of the Two-XOR PFD [6].
CLKl

CLKl ,
CLK3 » -

D A T A Jcad

CLK3 DATA DATA

o
DATAJ a g

D A T A c

n

DATA
Lag data > clock

Figure 3.7: 2-XOR PFD. The PFD achieves locked state when the signals Data and CLK3 are phase-aligned as shown in Figure 3.7. The DataXead and DataXag signal transitions occur at the same time and the control voltage stays at the same level.

In the case of the input data is faster than CLK3, then the 'High' state of the lag signal is shorter than that of the lead signal, the CP discharges and the clock period becomes shorter to track the input. The opposite happens when the input data is slower than CLK3.

An example of frequency correction occurs when the frequency of the input data is faster than the clock, then the surplus part of the lead signal discharges current, so the clock can track the data.

The advantages of the Two-XOR PFD are its ease of implementation, its large acquisition range, and high lock speed. However, when it comes to long string of ones and zeros, the

31

lead and lag signals are generated alternately causing jitter at the control voltage.

D- Flipflop P F D
Another implementation of the PFD is shown in Figure 3.8 [9]. The PFD employs two edge-triggered resettable D-Flip-flops and an AND gate. The data inputs of the DFF are connected to logic 'ONE' with the clock inputs being the input signals A and B.

D F ^
>C K

R eset

-4t c
+2 K

>C K

D F Ç

ONE

Figure 3.8: D-Flipflop PFD, and characteristic. The PFD functions as follows: Starting in State 0 (Q a = Q b =0), a transition on A causes Qa to go 'HIGH', further transitions on A will have no effect on Q a - A transition on B, will cause Qg to go 'HIGH', activating the AND gate and resetting both DFF. It is important to note the non-periodic behavior of the transfer characteristic for the PFD shown in Figure 3.8, when the phase difference is too large, the PFD enters the FD mode.

Since the PFD detects phase and frequency differences, it is characterized as having a wide Acquisition range, high lock speed, an output independent of input signal duty-cycle, and a constant gain over a phase error of ±360*' as shown in Figure 3.8. Its drawbacks include: (1) output jitter due to the meta-stability during lock condition, and (2) Dead-Zone due to the delay associated with the DFF and AND gate to be explained in the following section.

32

Dead-Zone
The dead-zone problem occurs, when a PFD is used in conjunction with a Charge-Pump (CP). The delay associated with the DFF and AND gate compared to that of the charging of the capacitor at the CP switches, will determine whether the system is in the dead-zone region or not [1, 2].

T1 B QA B AND Gate Threshold T1

QB t

Figure 3.9: Dead-zone. The dead-zone problem is better understood in conjunction with Figure 3.9. In the figure to the left, the phase difference between the two input signals A and B is large enough for the signals Q a and Qb to reach full logic levels of 'ONE'. In other words, there is enough time for the signal Q a to charge the capacitor Cp. In the figure to the right, the time or phase-difference between the two input signals is too small, and the PFD resets before signal Q a reaches a full logic level. In essence the CP switch fails to turn on for an ill-defined length of time. For such small phase differences, the gain of the PFD drops drastically as shown in Figure 3.10.

If the phase difference is within the dead-zone, the PLL will fail to correct itself and the deadzone will manifest itself as peak-peak jitter at the output. To avoid the dead-zone, a short delay is inserted between the output of the AND gate and the reset pins of the DFF

33

Dead-Zone

Figure 3.10: Dead-zone characteristic.
ONE

D DFF A *_ >C K ^ V -o Q .

Reset

Delay

>CK DFÇ D

Q

ONE

Figure 3.11: Dead-zone free PFD. as shown in Figure 3.11 [10]. The delay for the reset signal must be long enough to allow for the full switching of the UP and DN pulses and CP switches. Caution should be exercised when choosing the length of the pulse as not to limit the operating frequency of the PFD to:

fm a x --

2A T '

(3.3)

3.3

Conclusions

The architectures and design considerations of CMOS phase-frequency detectors for phaselocked loops have been presented. Basic PDs have simple configurations, however, they suffer from slow lock speed, narrow acquisition range, periodic input-output transfer characteristic and non-monotonic gain. PFDs have complex configurations but provide high locking speed, wide tracking range, linear, monotonie and non-periodic input-output transfer characteristic. However they suffer from the 'dead-zone' problem.

Chapter 4 Charge Pumps
Phase-locked loops play a critical role in mixed analog-digital systems, such as clock distri bution networks and frequency synthesizers [1]. The noisy environment of these systems, mainly caused by the digital portion, imposes challenges on the design of phase-locked loops. Charge pumps that convert digital outputs from phase-frequency detectors into analog control signals for local oscillators are an essential component of phase-locked loops.

In Chapter 2, we explained the benefits of using a CP-PLL over a basic PLL. What con cerns us in this chapter is the performance criteria of the charge-pumps and their effect on the performance of phase-locked loops. In clock and data recovery (CDR) applications, the maximum data bandwidth achievable is determined by the clock skew between the internal and external clocks. Clock skew is mainly determined by the non-idealities of charge pumps. Similarly, in frequency synthesis applications, phase-noise can be minimized by increasing the PLL's loop-bandwidth, hence the need for a high-speed CP. Moreover, charge pumps are the dominant block of a phase-locked loop that determines the level of unwanted FM modulation which gives rise to reference spur [13].

Many architectures of charge pumps have emerged recently. A comprehensive review of the architectures of CMOS charge pumps and an in-depth comparison of their characteristics such as, speed, minimum supply voltage, mismatch-induced errors, charge injection and clock

35

36 feed-through induced errors, and noise rejection, is presented in this chapter. Section j . l in

troduces the concept of a charge-pump and i t 's importance to a PLL. Section f.2 elaborates on the performance evaluators as well as the non-idealities of a charge-pump. Section 4-3 analyzes the basic charge-pump configurations. The more advanced current-steering and dif ferential current-steering charge-pumps are analyzed in Sections 4-4 and 4-5. Miscellaneous charge-pumps are presented in Section 4-6 and the chapter is summarized in Section ^.7.

4.1

Functionality

A CP consists of two switched current sources driving the loop filter, as shown in Figure 4.1. Ideal switching is realized by a three-state phase-frequency detector. The UP and DN signals are non-overlapping.

Cx

Ini

/
Vc

H

111

DN-

/
Cy

HM"
© /.

Figure 4.1: Conceptual representation of a charge pump. Depending on which switch is activated, the CP will either charge or discharge the load capacitor according to Table 4.1. The third state is known as the locked state in which both switches are open and the voltage across the load capacitor remains unchanged.

37

Table 4.1: Charge Pump Functionality. UP High Low Low DN Low High Low O utput S tate Vc Charge Discharge Locked

In reality, MOS transistors implementing these switches suffer from device mismatches and current-leakage that give rise to clock-skew and reference spurs in the output of the PLL.

These non-ideal effects are explained in greater detail in the following section.

4.2

N on-ideal Effects

As mentioned before, device mismatches and current-leakage result in a phase error that translates into timing jitter or modulation at the VCO output. These errors are analyzed below.

4.2.1

M ism atches

C urrent M ism atch The current sources J1 and 72 in the CP are essentially transistors biased in the saturation region. Non-idealities in the current mirrors or biased transistors causes static current mis matches between the two transistors. The difference between the charging and discharging currents causes a change or ripple in the control voltage K at each phase comparison as shown in Figure 4.2 (L).

The current mismatch and consequent ripple voltage translates to a phase-error defined as:
= 27T-

Aton A i 're/

[rad]

(4.1)

38

12

12

j

II

II
Net Current

Net Current

% %
(L)

(R)

Figure 4.2; (L) Current mismatch, and (R) Pulse-width mismatch.

where Tref is the reference clock period, I is the charge-pump current, Az is the current mismatch assumed to be greater than zero and is the turn on time of the PFD. It is

important to note that to avoid the dead zone, A t^ has a minimum limit.

For a third order PLL, the phase-error (f> c translates to a reference spur

(noise) [13] :

Pr = 2 O l o g ( ^ ^ i V 0 , ) - 2 O l o g ( 4 ^ ) ,
y/2 fr e f fp l

[dBc]

(4.2)

where N is the division value, / bw is the loop bandwidth, frej is the reference clock frequency and fpl is the frequency of the pole in the loop filter.

Moreover, due to the inhibited low output impedance property of short-channel Mosfets [12], dynamic current mismatch occurs, where the current mismatch A i varies with To

counter this error, the PLL locks with a finite phase error as shown in Figure 4.2(R) such that the average current per cycle is zero.

39

Tim ing M ism atch
The UP signal in Figure 4.1 must be active-low, hence the need for an inverter between the PFD and the charge pump (CP). The timing mismatch that is a resultant of the delay introduced by the inverter produces a phase error and a consequent spur that equals [13] :

Pr = 20 l o g ( ^
Jref

- 20 lo g (4 ^ ),
V2
-Lref -^ref Jpl

[dBc]

(4.3)

where A t a, the inverter delay is much less than Aton-

A simple solution to the delay problem is to insert a complementary pass gate before the DN signal to equalize the delay [Ij.

4.2.2

Sw itch Induced Errors

Charge Injection (ON ^ OFF)
Charge injection occurs when a switch moves from an ON state to an OFF state. When a MGS switch is ON, it operates in the triode region. During that time it holds mobile charges in its channel. Upon turning OFF, the charge must flow out of the channel and into the drain and source.

For the DN switch depicted in Figure 4.1, the total charge it holds in an ON state is:

Qon = -W L C o A V D N -V tn -V Y ),

(4.4)

where W , L, Cox, are the width, length, and oxide capacitance of the D N switch. Vd n , Vtn, and Vy are voltage of the D N signal, the threshold voltage of the D N switch, and the voltage at node Y.

When turned OFF, a portion of this charge will flow back to Vy, while the rest, a fraction K will flow into the load capacitance C l . The fraction K is the charge injection error. The

40

voltage-error at the output due to charge injection is calculated by:

AC = ^

C /L

=

Gf,

[V.]

(4.5)

Clearly, charge injection introduces a non-linear signal dependent error at the output voltage {Vtn has a non-linear relationship with Vy). It was shown in [14] that if a MOS transistor is turned OFF while in saturation, all the channel charge flows into the source, leaving the drain terminal unaffected ( K = 0 ). As a result, charge injection is avoided. As we shall see later on, positioning the switch relative to the current-sources will determine the severity of charge-injection.

Clock Feedthrough
Clock feedthrough is due to the overlap parasitic capacitances Cov- The error occurs when the fast rise and fall edges of a clock signal at the gate is coupled into the output node via the gate-to-source and gate-to-drain overlap capacitances, causing a sufficient rise of the signal level above the supply voltage. This rise in signal level could forward bias the junction diodes resulting in a electron injection into the substrate that can potentially lead to faulty operation, if it is conducted by a nearby high-impedance node [14][26]. It is important to note that clock feedthrough error is signal independent and manifests itself as an offset voltage that is calculated according to:

A C

=

^para i

[V]

(4.6)

where Cpara is the parasitic capacitances, Vdd and Vss are the high and low voltage levels of the clock.

4.2.3

Charge Sharing (OFF=^ ON)

Charge sharing occurs when switches in a CP move from an OFF state to an ON state. While the input of the CP is the output of a three-state PFD, where-by the UP and DN

41 switches of the CP can not be ON simultaneously, charge-sharing is the accumulative effect

of output voltage non-compliance due to each switch moving from the OFF to ON state. Charge sharing is the resultant of the finite drain capacitances C y and Cx of the charging and discharging currents respectively.

The process is best explained in conjunction with Figure 4.1. When the switches are OFF, the voltage at node X and Y are Va and ground, respectively. The output node Vc is floating. When the switches are turned ON, the voltage at node X will decrease and that on node Y will increase, resulting in charge sharing between C l , Cx , and C y, which causes a deviation in the output voltage Vc.

It is important to note, that even if the voltage drop across the two switches is equal, Ii and I 2 are equal and in-phase and the parasitics at node X and Y are equal, this will not avoid charge-sharing. To see why, let us consider the case where Vc is high (larger than the equilibrium midpoint voltage Vdd/2) when the switches are OFF. Turning ON the switches will lead to a voltage fluctuation at node Y that is much larger than the fluctuation at node X, this difference in voltage change must be supplied from C l resulting in charge-sharing.

The effect of charge or current leakage can be mathematically computed. Eq. 7.5 conveys the phase-offset due to charge-sharing and Eq. 7.6 gives the consequent reference spur in a third-order PLL [20].

< f)c =

^cp

[rad]

(4.7)

Pr = 20 lo g {^ ip jN < f> e) - 20 l o g ( ^ ) .

[dBc]

(4.8)

In later sections, it will become clear that by moving the position of the switches away from the output node, the effect of charge-sharing can be minimized.

42

S
To better understand how the structure of a charge-pump can affect the performance due to the non-ideal effects mentioned prior, the following sections will present the basic chargepumps, current-steering charge-pumps, and differential charge-pumps.

4.3

Basic Charge Pum ps

Figure 4.3 presents three single ended charge-pumps, differing only in the location of the switches. Prom Left to Right, each CP will be analyzed, its defects explained, setting the stage to explain the advantages of using the more advanced CP's.
UP M4 M2 M4 M2

M3 M3 Ml DN M3 DN

(L)

(M)

(R)

Figure 4.3: (L)Switch at Drain CP, (M)Switch at Gate CP, and (R)Switch at Source CP.

4.3.1

Sw itch-at-D rain

By concentrating on the middle branch of the circuit in Figure 4.3(L), one should notice its similarity to the conventional CP in Figure 4.1. Clearly the circuit suffers from chargeinjection. Moreover, having the switches close to the output, makes the circuit susceptible to charge-sharing at D1 and D2 and clock feedthrough errors. Mismatches such as current, voltage-drop across the NMOS and PMOS transistors and their parasitics are obvious errors.

43

4.3.2

Sw itch-at-G ate

To eliminate the drawbacks of Figure 4.3(L), the switches are moved from the drain to the gate, as shown in Figure 4.3(M) [15]. By changing the switch location, the mirrors and more specifically Ml and M2 are assured to be in saturation, minimizing charge-injection. This design, however, suffers from reduced switching speed due to the large parasitic capac itances at the gates of Ml and M2. To compensate for speed, the bias currents and hence power-consumption will have to be significantly increased.

4.3.3

Sw itch-at-Source

The Switch at the Source CP shown in Figure 4.3(R) has less power consumption than the switch at the gate in Figure 4.3 (M) without compromising switching speed. By placing the switch at the source, the parasitic capacitance at the gates of Ml and M2, no longer affect the switching speed, and therefore the bias currents can be lowered, consequently reducing power consumption. In addition, given the position of the switches away from the output, charge-sharing is minimized. Ml and M2 are assured to be in saturation, minimizing chargeinjection.

To illustrate the effect of charge-sharing and charge-injection, the Switch at Source and Switch at Drain CPs were analyzed using Spectre, and simulated during conditions where charge-sharing and charge-injection occur, as illustrated in Figures 4.4 and 4.5.

4.4

Current-Steering Charge-Pum ps

Current-Steering CP's utilize current switches to improve switching speed. The conven tional current-steering CP Figure 4.6(L) is composed of the switch at the drain CP with extra switches (Ml and M3). Even though the circuit improves switching speed, the prob lems that plagued the switch at the drain CP still exist here.

44

x IO

I
I

S w itc h -a t-S o u r c e

I

I

:S w itc h -a t-D r a in

-10

200

400

600

800

1000

1200

Time (ps)

Figure 4.4: Charge sharing comparison.
xIO '

3 .5

2 .5

S w itc h ^ a t-D r a n

1 .5

0 .5

-0 .5

200

400

600

800

1000

1200

1400

1600

1800

2000

Time (ps)

Figure 4.5; Charge injection comparison.

45 In order to avoid the PMOS and NMOS mismatches of CP in Figure 4.6(L), an NMOS-

Switches Only CP Figure 4.6(R) was proposed [16]. This CP, however, suffers from a slowpath node at the gate of transistor M5. That is, when M4 is ON, M3 is OFF, but M6 still conducts current until the parasitic capacitance at the slow-node is fully discharged. Moreover, When M3 is Off, current is wasted in the M4-/cp branch resulting in unnecessary Power-Consumption.

U PB o

1

M3

M4

M6

M5

V dd UP DN B o-- I Ml M2 I-- ° D N M3

Vdd UPB M4 DNB

V dd

Ml

M2 DN

(L)

(R)

Figure 4.6: (L) Conventional current-steering CP, and (R) NMOS switch only CP.

To solve the slow-node problem, Chang proposed a current-steering CP with a "Pull-Up" mirror as shown in Figure 4.7(L) [17]. The pull-up mirror increases the charging/discharging speed at node A. The drawback of this design is that in order to increase charging speed at A, Is must be increased. This, however, will decrease the net charge/discharging current of CP, subsequently, the speed of the circuit. In order to maintain speed, one would have to increase and consequently the power consumption. Moreover, when M2 is Off, there is

current/power wasted through Ml.

M5

M6

M 5

M6

M5

M6

M3 V dd

M3

M4

M3

M 2"j | -- °UP

(L)

(M)

(R)

Figure 4.7; (L) Chang's CP, (M) Current reuse, and (R) Current reuse and positive feedback.

Sanchez et all [11] modified Chang's CP by removing the current-source Is and connecting the drain of M5 directly to that of Ml, as shown in Figure 4.7(M). is now used to charge

node A and since It, is greater than Ig, M4 will turn OFF faster. In addition, current/power waste problem was resolved. One disadvantage of this design is the new slow-path node B. To fix this problem, Sanchez proposed using positive feedback by means of a Pull up transistor M7, as shown in Figure 4.7(R). Positive feedback, however, puts a restriction on the input signal UPB, for Ml to stay in saturation, UPB signal must be less than VDD; this requires additional circuitry.

The current steering circuits proposed by Chang and Sanchez were implemented in a 0.13 /j,m CMOS technology and analyzed using Spectre. Figures 4.8 and 4.9 show the effect of the pull-up transistor on CP.

47
125

120

I
^

1

115

Gurrent-Steering with PFB

110

C.qrrent-Stçeri.ng

105

100

50

100

150

200 250 Time (ns)

300

350

400

450

F ig u r e 4.8: Charge up of current-steering CPs.

0.5

X 10"

Current-Steering with PFB

-0 .5

-1 CurrentSteering

-1 .5

I

-2

-2 .5

-3 -3 .5

500

1000

1500

2000 Time (ps)

2500

3000

3500

4000

F ig u r e 4.9: Output current of current-steering CPs.

4.5

Differential Current-Steering Charge Pum ps

48

For any IC block, differential circuits will always prove to be more noise immune, and chargepumps are no exception.

Differential CPs have the following advantages: (i) NMOS and PMOS mismatches will no longer have the same significant effect on the overall performance of CPs. (ii) Due to its symmetric layout, differential CPs are immune to the timing mismatch, (iii) leakage cur rents are common-mode signals and the output stage is less sensitive to leakage current, (iv) differential CPs provide better immunity to voltage supply, ground and substrate noise [13]. On the negative side, differential CP's consume more silicon area, consume more power, and need a common-mode feedback circuit (CMFB).

M6

M7

V p o
FST SLW

Locked States: UP=DN='0' UP=DN='r

F ig u r e 4.10: Differential current-steering CP.

Figure 4.10 shows a conventional differential current-steering CP. It is important to note that the CMFB circuit takes FST and SLW as input and Vp as its output. The circuit suffers from excessive power consumption during either of the locked states [18].

Figure 4.11 is a Self-Biased differential current-steering CP. In addition to reducing PLL

49
M5 M8

Ml UPB

M2

M3

M4

FST

SLW

Locked States: M14

n M15
M16

UP=DN='0' UP=DN='r

F ig u r e 4.11: Self-biased differential current-steering CP.

noise, the new self-biased CP improves the power consumption, mainly because, when the PLL is locked, the current paths of the CP are blocked.

4.6

M iscellaneous Charge Pum ps

This section will present miscellaneous charge-pumps that are not new techniques in them selves but provide some valuable insight on how charge-pump issues have at sometimes been resolved.

4.6.1

Charge-Pum p w ith A ctive Am plifier

Figure 4.12 is that of a CP utilizing an active amplifier with unity gain to reduce the chargesharing effect experienced in switch at the drain CP's [19]. The amplifier holds the node voltages of A and B constant when the switch moves from OFF to ON.

50

U P \

UPB

^ O U t
A=1

D N \

DNB

F ig u r e 4.12: Charge-pump with active amplifier.

The disadvantage of this circuit lies in the common-mode input voltage restriction of the opamp. In addition, the op-amps output current, must support
lu p

and

Id

n

-

Such a com

plex op-amp will make the CP illustrated above, not suitable for low voltage operation.

4.6.2

Charge-Pum p w ith Error Amplifier

Most charge-pump topologies try to reduce current mismatch by using cascode configurations to increase the output impedance. As voltages become lower, using cascode configurations to increase output impedance, will no longer be possible. The CP in Figure 4.13 uses a switch at the source CP as one branch in conjunction with a differential amplifier and a reference mirror branch with replica biasing. As long as the amplifier has sufficient gain, the CP output will follow the reference [20].

51
UP Ml M5

M2

M6

Ich ref

MIO

M3

M7

M4

M8

F ig u r e 4.13: Charge-pump with error amplifier.

4.6.3

C harge-Pum p w ith C om plem entary Switches

The Charge-Pumps in Figure 4.14 are merely Switch at drain and Switch at source chargepumps with a similar modification. The transistors Ml and M2 in Figure 4.14 (L) are used to discharge and charge nodes P and N when M3 and M4 are inactive [21]. Similarly the transistors M14 and M15 in Figure 4.14 (R) where inserted to reduce switching glitches by providing paths to ground [22].

This method of using complementary switches, although extensively used, does not take into account the fact that leakage at node P is greater than that at node N.

52
M7 O UPB

Mil

M14

M3 DNB UPB M9 M4 UP

MIO

DN M2

M12 M15 M8

I

o DN

F ig u r e 4.14: (R)Improved switch at drain CP, and (R)Improved switch at source CP.

4.6.4

C harge-Pum p w ith AC Coupling transistors

The Charge-pump shown in Figure 4.15 is a switch at the source CP modified. Other than the cascoded mirrors, this CP utilized replica biasing in M2, M3 and M15 to reduce current mismatch. The other modification is the use of MCI and MC2 to reduce the charge coupling to the gate and increase switching speed [13].

MIS
@ Icp

MI4

UP

M13 Mil
biasl®-

MIO

M8 M9|

M7

M6 MS Vdd M3 M21 Ml

M4

DN

F ig u r e 4.15: Charge-pump with AC coupling transistors.

53

4.6.5

H igh-Speed Charge-Pum p

The charge-pump in Figure 4.16 is switch at the drain CP with its switches permanently closed. The charging and discharging operation is controlled by the two additional transistors Ma and Mb, the only difference being, is that Ma and Mb are never fully ON or OFF, but they absorb more or less current [23]. This structure avoids switching glitches and is intended for high speed applications.

DN<H[Klb Ml

M 7

M 8

M 9

M IO

Mil

F ig u r e 4.16: High-speed charge-pump.

4.6.6

Fully Balanced Charge-Pum p

The CP in Figure 4.17 uses a balanced load and complementary circuits approach to minimize current mismatches [24]. The idea is for each PFD output to see the same number of NMOS and PMOS switches. The use of dummy transistors although useful in reducing current mismatches, requires careful timing of the control signals.

4.6.7

Charge Am plifier C harge-Pum p

The CP in Figure 4.18, utilizes a small stand by current to improve switching speed and remove charge-sharing. It is important to note that the standby current does not affect the output current [25]. Also, the UP and DN switches are separated from the output thus reducing clock feedthrough.

54
UP Mdl D N o -|[^

UPB H & s l

==C pl

DNB o - | P

UP

Md2 Mx

I h ' DNB

E
Iref

Mcl

I.P I
Mc2

<
V c tr l 1

>
DNB DNH

M dS^^I-oDN U P b H[^ =pCp2
Ms2 UP

h U P

Hp Hp

DNB

Hp Md4

UPB

Figure 4.17; Fully, balanced charge-pump.
Cascode Current Mirror UP Cascode Current Mirror

U P o --I

V

I --oU P B

. vss vdd

DNB°-- I

I-- o = D N

Cascode Current Mirror

Cascode Current Mirror

Figure 4.18: Charge amplifier charge-pump.

4.7

Conclusion

The architectures and design considerations of CMOS charge pumps for phase-locked loops have been presented. Basic charge CPs have simple configurations. They, however, suffer from non-ideal effects and low speed. Current-steering CPs have complex configurations but provide high operation speed. Differential current-steering CPs provide better immunity to both power/ground variation and other common-mode disturbances, such as leakage current. These CPs, however, require large silicon areas and common-mode feedback.

This chapter explained in great detail, the importance of the charge-pump to a PLL, it's performance parameters and non-ideal effects. Moreover, a wide array of CP's was presented, and different topologies were compared. In conclusion, it is important to employ the ap propriate CP depending on the clock-skew, reference-spur, VCO input range and maximum leakage current criteria.

Chapter 5 Analysis of Supply Noise Sensitivity of VCO Delay Cells
The noisy environment, mainly due to the switching noise generated by the digital portion of these systems, imposes stringent constraints on the design of VCOs, especially phase noise or timing jitter. Although LC tank-based VCOs offer inherent low phase-noise, the compact size, wide tuning range, multiple clock phases, and ease of implementation of ring- VCOs have gained considerable attention most recently. The phase noise or timing jitter of ring- VCOs is a critical Figure of merit quantifying the performance of ring- VCO based PLLs. Recent studies have shown that the dominant source of the timing jitter is the switching noise orig inated in the digital portion of the systems and coupled to the supply and ground rails of VCO of PLLs. To better understand the effect of the switching noise on the timing jitter, the worst-case timing jitter of various delay cells of ring oscillator-based VCOs is explored in this chapter.

This chapter presents a comparative study of the architecture and timing jitter of the delaycells of low-voltage CM OS ring- VCOs. In Section 5.1, design considerations, such as noise, single-ended versus differential configuration, linearity and symmetry of load, and the output voltage swing of delay cells are examined in detail. Section 5.2 analyzes the worst-case

sensitivity of the delay time of the delay cells (see ) and that of the oscillation frequency of corresponding ring-VCO implemented in TSMC O.lSfxm CMOS technology using Cadence's

56

57 Spectre with BSIMSvS device models. Simulation results are presented in Section 5.3. The

chapter is summarized in Section 5.4-

5.1

N oise Sources

VCO noise sources, can be categorized into two main sources: (i) device noise that consists of thermal noise and j flicker noise of MOSFETs, and (ii) supply noise that is due to the switching of on-chip digital circuits. In the following section(s), we will present these noise sources and their effect on the phase noise and jitter of VCOs.

5.1.1

D evice N oise

Device noise of ring-VCOs includes wide-hand thermal noise and frequency-dependent flicker noise of MOSFETs. The power of flicker noise is signiflcantly higher than that of thermal noise at low frequencies. Due to the nonlinearities of the VCO, low frequency flicker noise is up-converted to frequencies in the vicinity of the oscillation frequency /oso according to [27]:

(5.1)
rms

7^ / spectively. F^c is the dc value of the impulse sensitivity function (ISF ), whose value is
determined by the magnitudes of the positive and negative lobes of the ISF . Since the slopes of the rising and falling edges of the output waveform of the VCO determine the magnitude of the lobes, an output waveform with equal rise and fall times will not suffer from the up-conversion of j noise.

where

/ 1 and f i represent the corner frequencies of the phase noise and flicker noise re-

Due to the up conversion of the flicker noise arising from the periodic oscillation of ring oscillators, flicker noise greatly affects the phase noise of ring oscillators, especially those

58 with tail biasing current sources. The cycle-to-cycle timing jitter (Ar) of a differential ring

oscillator due to its intrinsic device noise is given by [36]:

rp2

-^osc

Jose

T

I V on

'

T T

5

where Tosc is the oscillation period,

is the on-voltage, fosc is the oscillation frequency, K

is Boltzmann's constant, T is temperature, I is the tail current of the differential pair delay cell, a,, is the voltage gain, and %is the delay cell noise contribution factor.

We already know that the up-conversion of low frequency flicker noise can be minimized by matching the rise and fall times of the output waveform of the VCO. To reduce the amount of thermal noise that is transformed into jitter, Eq.(5.2) indicates that Vm must be maximized. Eq.(5.2) also indicates that better phase noise performance can be achieved by using long and narrow devices that constitute lower threshold voltages in order to minimize gain, maximize the on-voltage and ensure the dominance gate capacitance of the differential pair. This, however, increases with the device capacitance and subsequently lowers the oscillation frequency.

5.1.2

Supply N oise

Supply noise is mainly due to d i{t)/d t of the bond wires for the power and ground rails, and is also called switching noise. As current densities increase and power supply voltage decreases, supply fluctuations become critical, especially for mixed analog-digital systems. Maneatis [33] pointed out that supply noise can be classified into (i) static supply noise and (ii) dynamic supply noise.

Static supply noise arises from the changes in the DC value of the supply, and its sensitivity is measured as the percent difference in the buffer delay at two different supply voltages divided by the supply voltage difference. To see how static supply noise translates to output jitter, let us consider the differential delay cell shown in Figure 5.2(L). The cell is a simple

59 differential amplifier whose output voltage swing is a function of the loads and tail current.

Moreover, the delay of the differential amplifier is a function of the effective load resistance and output capacitance. Linear resistive loads give high static supply noise rejection, since the value of the loads is independent of the supply voltage Vdd- In order to control the oscillation frequency, the delay cell should have a mechanism to control the value of the delay. In most designs^, this is done by varying the value of the load resistors. Adjustable loads are nonlinear, and their effective resistance is a function of the bias current of M O: hias- Consequently, the static supply noise sensitivity of the delay cell is determined by the sensitivity of I/das to Vdd- A variation of the supply voltage will lead to a change in the drain voltage of the NMOS biasing current source MO. Due to the finite output impedance of the current source, a change in the drain voltage of MO will lead to a change in the value of the current source, and consequently a change in the delay of the cell. Hence, the static supply noise couples to the output through the output impedance of the current-source.

Dynamic supply noise is caused by a transient change in the supply voltage, and its sensitivity is measured as the percent difference in the buffer delay due to an instantaneous change in supply voltage divided by the supply voltage difference, minus the static supply sensitivity. Consider the differential delay cell shown in Figure 5.2(L). An ideal differential amplifier will have resistive loads that are independent of the common-mode voltage that carries the dynamic supply noise. In this case, a common-mode shift in the output voltage due to dynamic supply noise can not affect the delay of the cell. Unfortunately, variable loads do not provide a constant output differential resistance. As a result dynamic supply noise will affect the output voltage and a consequent change in the delay. The effect of dynamic supply noise can be limited, by a mechanism that restores the output voltage in a short amount of time. To reduce the recovery time of the output voltage, one can reduce the capacitive coupling to the output. Thus, the dynamic supply noise affects the output via capacitive coupling.
^Controlling the delay via the bias current is sensitive to substrate noise coupling to the control voltage.

5.2
5.2.1

D esign Considerations
Single-ended and Differential Configurations

Conventional single-ended ring oscillator delay cells are either current-starved or weighted current-adder inverter cells as shown in Figure 5.1(L). Due to the absence of a tail current, these cells exhibit low intrinsic device noise. The full output voltage swing of these cells provides a high signal-to-noise ratio (SNR). These cells, however, have a poor power supply rejection ratio (PSRR).

Vdd

Vdd

H

J
VM1 M2

Ktrl 0 -|

MO

(L)

(R)

F ig u r e 5.1: Delay cells: (L) Single-Ended, and (R) Differential.

The tail current source of differential delay cells is independent of common-mode variations. Differential delay cells are less sensitive to common-mode voltage variations, such as supply voltage fluctuations. This common-mode noise rejection, however, is limited by the finite output impedance of the tail current source and the linearity of the load. Moreover, due to the existence of a tail current source, differential delay cells experience a limited output voltage swing and a consequent low SNR. Furthermore, the asymmetry of the two branches in differential delay cells, results in an increase in Fdc and a subsequent increase in the upconversion of the j flicker noise of the tail current source.

61

5.2.2

Linearity of Load
Vdd M5 M3 lu/0.18u M4 lu/0.18u M3 Vdd M4 M6

lu/0.18u

lu/0.18u,

yr
Ml M2 0 .811/ 0 . 18u 0 .8 11 / 0 .18u MO 15u/0.35u

hMn-

M2 Ml 0.8u/0.18u 0.8u/0.18u MO 15u/0.35u

(L)

(R)

Figure 5. 2: Delay Cells: (L) Triode or Current source load, and (R) Symmetric load. The delay cell with resistive loads in Figure 5.1(R) achieves a high dynamic PSRR. In prac tice, monolithic variable resistors are usually realized using MOSFETs biased in the triode region as shown in Figure 5.2(L). It was shown in [33] that this type of variable resistors exhibits poor linearity once the frequency range is large. In addition, because the effective resistance of triode load resistors is determined by the bias conditions, i.e. Vdd --Ktr/i the resistance is heavily affected by the fluctuation of the supply voltage. Furthermore, as men tioned earlier this cell suffers from a small output voltage swing.

As compared with variable resistive loads, current source loads^ have a larger output voltage swing and are less sensitive to the supply fluctuation, owing to the large output impedance of current sources. The disadvantage of using current-source loads is that in order to ensure that the current source MOSFETs are in saturation, the current range of the current source
^Figure 5.2(L) with loads biased in saturation.

62

is usually small, resulting in a small tuning range.

Delay cells with symmetric loads, shown in Figure 5.2(R) combine both current-source and triode loads, to achieve a better PSRR due to improved linearity of the loads. Although not perfectly linear, the I-V characteristic, shown in Figure 5.3, of the symmetric load is symmetric about the center point of the output voltage swing. This symmetry ensures a first-order cancellation of the common-mode noise from the supply voltage [33].

x1 0 `
M ill Triode - - Symmetric 3.5

2.5

1.5

0.5

0.1

0.2

0.3

0.4
V r e s (V)

0.5

0.6

0.7

0.8

F ig u r e 5.3: IV characteristic of symmetric loads.

5.2.3

V oltage Swing

Delay cells with a full voltage swing offer high SNR but lower oscillation frequencies [29]. It was illustrated by [34, 35] that the single-sided phase noise L{Au>) of a three-stage ring oscillator is given by:

(5 3)

63 where Atv is the offset frequency from the carrier frequency, F is the excess noise factor, 7

is a coefficient^, K is Boltzmann's constant, T is absolute temperature, gdso is conductance, and Irms is the RMS value for the internal current swing. Low phase noise can be achieved by decreasing F and g^so, and increasing Fms- Fms can only be increased by increasing current-switching efficiency by increasing voltage swing. F and gaso can be decreased by minimizing the number of devices with small transistor widths which counters efficient cur rent switching; a trade-off has to be made.

Vdd M5 14u/0.18u M6 14u/0.18u 14u/0.18u
Vtrl ° - j

Vdd lu/0.18u Iu/0.I8u 14u/0.18u
Virl

M5 M3

o M4 M6 [--

yr

yr

y« H Ml M S --'
3u/0.18u lu/0.18u

M2 M4 lu/0.18u 3u/0.18u

Ml 3u/0.18u

M2 3u/0.I8u

(L)

(R)

F ig u r e 5.4: Cross-coupled delay cells: (L) P-Latch, and (R) N-Latch.

Figure 5.4 shows full-swing delay cells. These cells employ positive feedback latches, a Platch [31] or a N-Latch [30], to speed up the transition of the output signal, and to ensure that logic state, once established, is insensitive to dynamic supply voltage variations (high dynamic PSRR). Furthermore, the sharpening of the transition edges reduces the amount of noise converted to timing jitter. As compared the delay cells shown in Figure 5.2, the elimi nation of the biasing tail current source removes the effect of the up conversion of the flicker noise of the tail current source on the timing jitter. Also, voltage swing limit is no longer
^ 7 should not be confused with the body effect coefficient. The value for 7 is dependant on the technology used and the drain-source voltage. The theoretical value is still under research [1 ]

64 an issue and the cell has the capability to operate at a lower voltage. Note that in order to

break the latch, the input transistors of the cells have to be sufficiently large, resulting in a lower oscillation frequency, therefore the strength of the latch is inversely proportional to the oscillation frequency.

Vdd M7 M6 lu/0.18u
V/r/

M5' lu/0.18u<

M8

Vdd 0.3u/0.18u

M3

M4

Ml M2 0.8u/0.18u 0.8u/0.18u MO 15u/0.35u

Figure 5.5: Cross-coupled delay cell with symmetric loads. The delay cell shown in Figure 5.5 [37] takes the advantages of both the symmetric load and cross-coupling, and is capable of achieving a high dynamic PSRR while maintaining rea sonable oscillation frequency at the expense of increased intrinsic device noise. The PMOS transistors M3 and M4 exhibit a negative resistance of -- 2/^^ that increases the symmetry of the load. As a result, the output impedance and subsequently delay, are increased [Ij.

To further reduce the delay, the skewed delay cell shown in Figure 5.6 was proposed [32]. The negative delay is implemented by applying the premature output of preceding delay cell two-stages-before to skew transistors M5' and M6'. By introducing a negative delay at the input of transistors Mb' and M 6', the switching time of the loads is reduced. The rise time of the output and hence operating frequency are increased. As a result, timing jitter

Vdd

Vdd

65

M3 3u/0.2u l.6u/0.2u 3u/0.2u
3 u/ 0 . 2 A J T 6 u/0.2 u

M4 3u/0.2u

0.6u/0.4u M5
V,H

M6

--' Ml 4u/0.2u

M2 -- 4u/0.2u

4u/0.2u

Ml

M2 4u/0.2u

(L)

(R)

Figure 5.6: Cross-coupled delay cells: (L) without skewed delay, and (R) with skewed delay. is reduced. Moreover, positive feedback sharpens the transition edges to improve dynamic PSRR. The disadvantage of this delay cell is its high power dissipation when both the input NMOS transistors and skew transistors are ON at the same time.

5.3

Sim ulation R esults

While this chapter is focused on the effect of supply noise on VCO jitter only, it is important to understand the behavior of the PLL in the presence of supply noise. Let us consider first, how a PLL reacts to dynamic supply noise of a VCO. At a constant supply voltage, the PLL will ensure that the oscillation period/ frequency is equal to that of the reference signal at the input. A transient change in supply voltage will cause a transient change in the output period/frequency that will lead to a phase accumulation/ depreciation at the output. The phase error in the VCO will translate to a phase step between the reference signal and the output of the PLL. This phase step is corrected by the feedback loop of the PLL at a rate lim ited by its loop bandwidth. The absolute jitter^ will be equal in magnitude to the phase step.
^The difference between periodic jitter and absolute jitter is the reference signal. Periodic jitter is ref erenced to one period of the VCO output, and absolute jitter is referenced to the PLL input reference

66

When it comes to static supply noise, a DC change in the supply voltage will have a more significant effect on the absolute jitter. A DC change in the supply voltage will lead to a change in the delay of every buffer stage, and a consequent change in the oscillating pe riod/frequency. This change in oscillation period, will cause an accumulation or depreciation of phase at the output. As opposed to dynamic supply noise that is limited to the duration of the transient, this phase error will accumulate with time until the PLL compensates at a rate limited by the loop bandwidth. The resultant absolute jitter from the static supply noise is measured as the change in the supply voltage multiplied by the static sensitivity, divided by the PLL loop bandwidth. Recalling from Chapter 2 the stability limit (see Eq. (2.41)) to the natural frequency (i.e. loop bandwidth), we can conclude that the effect of the static supply noise is more significant than that of the dynamic supply noise. For the reasons mentioned above, the simulations are strictly for worst case static supply noise sensitivity.

The delay cells presented in this paper have been implemented in TSMC 0.18//m CMOS technology and analyzed using Cadence's Spectre with BSIM3v3 device models. Figure 5.7 shows the test of one delay stage in a multistage ring oscillator with a varying supply voltage AV dd - Five-stage ring VCOs employing the different delay cells were implemented, their control voltage was set to the center of the tuning range and the supply voltage was varied by ±

10% and the corresponding parametric changes were measured.

The rise and fall times, the average propagation delay, the oscillation frequency, and their normalized^ sensitivity to the supply voltage of these delay cells are analyzed and the results are presented in this section.

To ensure a fair comparison, transistors in the delay cells are sized properly. The inverter
signal. ^While sensitivity is measured as a percent change in the respective parameter divided by a 1 unit change in voltage, in this thesis sensitivity was measured as percent change in parameter over percent change in voltage, given that 1 V change is extreme in low voltage designs.

67

V dd'

A V dd'

Ml

M2

M O

F ig u r e 5.7: Supply Sensitivity test of a differential delay cell.

based delay cells have a full-swing voltage input. The input of differential pair-based cells, on the other hand, has a limited swing to ensure that the loads are in the triode.

The oscillating waveforms of a five-stage ring oscillator with symmetric loads and cross coupled N-Latch delay cell are shown in Figure 5.8 and Figure 5.9, respectively. One can observe how the differential cell employing symmetric loads is sensitive to a reduced supply voltage due to its limited output voltage swing. As for the cross-coupled N-latch, the com promise between PSRR and oscillation frequency is clear.

3

1.2

-- V d d = 1 .8 V " " " V d d = 1 .9 8 V V d d = 1 .6 2 V

F ig u r e 5.8: VCO output: Symmetric Load.

68

> 0.8

-- Vdd=1.8V I l «I Vdd=1.98V - 4- Vdd=1.62V Time (10"^ ns)

Figure 5.9: VCO output: Cross-coupled N-Latch.
Table 5.1 tabulates the rise time of the delay cells and the normalized sensitivity of the rise time to the supply voltage.

Table 5.1: Rise time of delay cells and its normalized worst-case sensitivity.
R ise T im e (ps) Delay cells Triode Load Symm. Load Cross Coupled-P Cross Coupled-N Symm. Load-P latch Cross-coupled w /o skew Cross-coupled w skew
Vd d Vd d i

10%
40.40 36.40 54.15 66.73 46.21 51.00 51.85

V dd

27.80 28.10 28.60 29.50 34.00 41.00 31.06

19.40, 21.45, 17.16, 28.40, 26.07, 33.00, 23.13,

3.77

2.66
6.46 6.49 2.96 2.19 4.62

Table

5.2 shows the fall time of the delay cells and the normalized sensitivity of the fall time

to the supply voltage.

69

Table 5.2: Fall time of delay cells and its normalized worst-case sensitivity. Fall T im e (ps) Delay cells Triode Load Symm. Load Cross Coupled-P Cross Coupled-N Symm. Load-P latch Cross-coupled w/o skew Cross-coupled w skew
Vd d Vd d

Atf
Vnn

i

10%
22.40 27.85 22.09 20.90 34.75 10.28 10.15 3.94 0.70 3.08 2.85 0.53 0.78

33.50 29.92 29.00 40.00 35.80

11.00
12.50

48.80, 27.79, 40.00, 36.26, 33.00, 12.00, 15.43,

2.11

Table 5.3 compares the delay of the delay cells and the normalized delay sensitivity to the supply voltage.

Table 5.3: Average delay of delay cells and its normalized worst-case sensitivity. D elay (ps) Delay cells Triode Load Symm. Load Cross Coupled-P Cross Coupled-N Symm. Load-P latch Cross-coupled w/o skew Cross-coupled w skew
Vd d Vd d

±

10%
31.40 32.12 38.12 43.81 40.48 30.64 31.00

âr

30.65 29.01 29.00 34.30 34.90 26.05 22.05

34.10, 24.62, 28.58, 32.33, 29.53, 22.50, 19.28,

0.68
1.29 1.64 1.67 1.56 1.56 2.65

V db

Table 5.4 tabulates all the oscillation frequency and the normalized sensitivity of the oscil lation frequency to the supply voltage.

70

Table 5.4: Oscillation frequency of delay cells and its normalized worst-case sensitivity.

Osc. Frequency (GHz)
Delay cells Triode Load Symm. Load Cross Coupled-P Cross Coupled-N Symm. Load-P latch Cross-coupled w /o skew Cross-coupled w skew Vi DD 3.78 3.56 3.31 2.87 2.99 3.67 4.05 Vdo i 10% 4.39, 3.91, 3.85, 3.51, 3.29, 4.20, 4.46, 3.06 3.00 2.31 2.39 3.06 3.16 3.53 U D . 1.76 1.27 2.35 1.95 0.61 1.41 1.14

5.4

Conclusions

A comparative study of the architecture and timing jitter of the delay-cells of low-voltage CMOS ring-VCOs has been presented. Design considerations of delay cells have been exam ined in detail, and the worst-case sensitivity of the delay time of the delay cells and that of the oscillation frequency of corresponding ring VCO have been analyzed. Simulation results presented in this chapter provide an in-depth comparison of the characteristics of the delay cells, in particular, power sensitivity, of low-voltage CMOS ring-VCOs.

m*'''

Chapter 6 New Active Inductor VCO Delay Cell
Of all the building blocks of PLLs, the voltage controlled oscillator is the main bottleneck in achieving high operation speed. The most exploited configurations of VCOs are ring oscilla tors and LC-tank oscillators. The compact size, wide tuning range, multiple clock phases, and the ease of implementation of ring- VCOs have gained their popularity. On the other hand, LC tank-based VCOs operate at higher frequencies and offer inherent low phase-noise. However, they suffer from a narrow frequency tuning range. In addition, monolithic spiral inductors have a low quality factor and consume a large inflexible on-chip area. While active inductors generate higher noise than their spiral counterparts, their smaller on-chip area, wide tuning range, and the capability of integration with digital CMOS circuitry makes their use appealing [46].

In order to exploit only the advantages of both the types of oscillators, a four-phase differential ring oscillator with active inductor loads is presented in this chapter. Section 6.1 details the oscillation criteria and design process of oscillator systems. In order to quantify the speed merit of inductive loads, the oscillation speed of a conventional RC ring oscillator is derived and its limitations are analyzed in Section 6.2. Section 6.3 highlights the inductive loading technique and the advantages of using active inductors over passive inductors. Delay cells with slightly different active inductive techniques are scrutinized and the new delay cell is proposed in Section 6 .4 . A comparative speed analysis is given in Section 6.5, and simulations

71

72

and conclusions are presented in Sections 6.6 and 6. 7.

6.1

Oscillation Frequency Estim ation

In the process of designing an oscillator, certain criteria has to be met. The necessary but not sufficient criteria^, Barkhausen criteria, states that for a feedback system to oscillate, two conditions must be met. The first condition is that the loop gain of the system at the oscillation frequency should be greater than unity. The second condition is that the phase shift of the system at the oscillating frequency should equal ^-- 180®. In order to estimate the delay of a cell, or the speed of the oscillatory system, it is essential that the design process be dissected. For an N-stage ring oscillator compromised of N delay stages, the design process is as follows: · Step!: Identify N, the number of stages, and the transfer function of the delay cell, in addition to the magnitude and phase transfer functions. · Step2: Calculate the phase shift per stage as and equate it to the phase shift given

in the phase transfer function of the delay cell. The result will be a relation between the oscillation frequency and delay-cell parameters. · StepS: Set the magnitude transfer function of the delay cell greater than unity and simplify the equation by substituting the relation found in Step2. This step will give the parametric condition that every delay cell must satisfy for the system to oscillate.

6.2

Oscillation Frequency of RC Ring Oscillator

In this section, we will derive the oscillation speed of a conventional RC ring oscillator. The design process mentioned above is used in conjunction with a linearized model of ring oscillators seen in Figure 6. 1.
'Meeting the exact criteria is not always sufficient due to parasitics, process and temperature variations. ^For a positive feedback system, the condition changes to a phase shift of 360®.

73

- S

- S

- S

Output

O

-1

1
%
ï F ig u r e
6 .1

%
ï

: Ring oscillator and its linear model.

Depending on the delay stage used, the load Z in Figure

6.1 can be modelled differently.

Let us take the basic differential delay cell seen in Figure 6.2(L) as an example. In Chapter 5, we mentioned that the differential delay cell is characterized as having a limited output voltage swing. The VCO frequency can be obtained by using the small signal model of the delay cell seen in Figure 6.2(R).

Ml

M 2
MO

y-

(L)
F ig u r e
6 .2

(R)

: (L)Differential Delay cell, and (R) Small signal model of cell.

Noting the similarities between Figures 6.1 and 6.2(R), obviously in the case of the differential pair delay cell, the load Z is modelled as a parallel combination of R and C, where C is the total capacitance seen at the output node, and is equal to the sum of the diffusion capacitance

74 at the drain of the input NMOS pair, the load capacitance, and the gate capacitance of the

next delay stage. By following the design procedure outlined earlier, the transfer function of one delay stage can be obtained from:

= |

=

(6. 1)

where Qm is the transconductance of the input transistors Ml and M2. The phase shift per delay stage can be calculated as:
_iono
(t> = \
lO oscR

C ),

( 6 . 2)

and for a given N , a relationship can be formulated between uJosci The magnitude transfer function can be calculated as:

and C.

I H{s) 1=

=. ^1 + {uJoscCRf

(6.3)

For a given N , by setting the gain to be greater than unity, the following oscillation condition is obtained:

R > -- ^1 + tan^(--).

(6.4)

From the above analysis, we can determine the oscillation frequency and oscillation condition (e.g. iV=4, u)osc = and R > ^ ) . With the combination of the load resistance R

and output capacitance C, the transfer function of the delay stage has a single pole. The oscillation frequency can be increased using the following approaches[38]: · Minimize the total output capacitance seen at the output node. · Minimize the load resistance. · Minimize the number of delay stages N.

75 · Maximize the transconductance per unit capacitance^ ^ of the input transistors and

load transistors. The limitation in reducing the load resistance is given in Eq. (6.4), where a reduction in the load resistance necessitates an increase in the pair's transconductance, to maintain the nec essary gain and ensure oscillation. Moreover, an increase in gain will consequently increase power dissipation, phase noise, and reduce the tuning range. In applications such as clock and data recovery (CDR) that demand quadrature outputs, reducing the number of delay stages is not an option.

In order to maximize the transconductance per unit capacitance, one can replace the PMOS transistors with NMOS transistors. Since the transconductance per unit capacitance of

NMOS transistors is larger than that of PMOS.

6.3

A ctive Inductor Loads

Shunt-Peaking [39] is often used to enhance the bandwidth of circuits, by utilizing inductors to tune out the capacitive load. The bandwidth extension is accomplished by the resonance of network formed by the inductor and the load capacitance. In order to get the bandwidth extension effect, the resonance frequency should be near the desired 3-dB frequency [40]. Since the value of the load capacitance is determined by the parasitic capacitance, the inductance value needed for the resonance frequency to be near the bandwidth of the circuit, is high. Using spiral inductors to achieve a large inductance value would consume a large chip area. Active inductors, on the other hand, are preferred over spiral passive inductors for a number of reasons [42, 41] · Active inductors are tuneable, while spiral inductors are not.
^Also known as the unity gain frequency /,,.

76 · Passive spiral inductors require a large chip area, while active inductors occupy a

significantly smaller chip area. · Passive spiral inductors contribute significant parasitic capacitance due to their large chip area. · The value of passive spiral inductance is proportional to the area, whereas the value of active inductance is independent of area. · Due to substrate and resistive losses, spiral inductors have.a low quality factor Q, while active inductors can achieve high Q. · Passive spiral inductors are prone to high-frequency electro-magnetic noise coupling. The drawbacks of active inductors are their large DC voltage drop which is a nuisance in low-voltage design, power consumption and noise [44].

6.4

Delay Cells w ith A ctive Inductor Loads

Figure 6.3 shows delay cells with active inductor loads. In Figure 6.3(L), transistors M3 and M4 operate in the saturation region, with the drain-gate feedback resistor providing an

additional zero in the cells transfer function, which counter balances the simple-pole gain roll-oflF transfer function. This loading structure suffers from an excessive voltage headroom loss required for the load to exhibit an inductive behavior[7]. This large voltage requirement reduces the circuit's common-mode voltage. Furthermore, this large voltage drop, reduces the voltage headroom needed for the current-control source I cm- The consequence is a re duction in the tuning range and the maximum achievable value for Ictri- In essence, this limits the maximum operation speed of the cells.

The load in Figure 6.3(M), has a similar structure to that of Figure 6.3(L), except that M3 is now an NMOS device with a lower threshold voltage and a higher transconductance per unit
*Ro is actually a PMOS device operating in the triode region

77
V dd V dd

M3 M3 M4

Ml

M2

x: n r M l
H M O

(L)

(M)

(R)

Figure 6.3: Inductive load delay cells: (L) PMOS, (M) NMOS, and (R) NMOS-low voltage. capacitance. The improvements introduced to the operating frequency and voltage drop by the NMOS active inductor are minor.

In order to reduce the voltage headroom even further, the cell in Figure 6.3(R) biases one terminal of the resistive device P3 at Vbh, one threshold voltage above the supply voltage Vdd- This reduces the voltage drop across M3 to its gate-overdrive voltage, the disadvantage of this topology is the need for an auxiliary circuit to produce the voltage on jitter.
Vb h ,

and its effect

The proposed delay cell in Figure 6.4 utilizes an active inductor load that avoids the restric tions associated with supply voltage and control range. The current-reused active inductor [45] employed in the proposed circuit, is composed of devices PI, P2 and biased currentsource lb- Transistors PI, P2 and their biasing current It form a shunt-shunt feedback loop that will allow the input impedance to emulate an inductor. At low frequencies, the input impedance (l/gm 2 divided by the feedback loop gain) is very small because of the shunt feedback. At high frequencies, the loading effect of the gate-source capacitance Cgsi, will de crease the feedback loop gain and increase impedance, thereby generating an inductive effect.

This active inductor offers tuning flexibility over the cells in Figure 6.3 by utilizing both

78

w

Ml

M2

MO

Figure 6.4: Proposed difFerential delay cell with active inductive loads. lb and half of Igs^- Moreover, the resonance frequency of this active inductor is y/u}t\(jJt2 = =

where uja and u>t2 are the unity gain frequencies of transistors PI

and P 2, respectively®. Given the current-reuse structure, the resonance frequency and in ductance value can be tuned by varying the drain currents of PI or P2 via It or Iss- This property allows this active inductor to operate at higher frequencies. Furthermore, the min imum supply voltage needed for this active inductor itself is max{vgs\ + Vds, Vdsi+ Vds2 + '(^ dsb), which makes its use favorable in low-voltage designs.

The disadvantage of the current-reuse method is the correlation between frequency tuning and quality factor Q tuning. This lack of independence in tuning is evident since Q is given by:

Q =

Rp i^tLp

(6.5)

^Iss was referred to as Ictri in the delay cells of Figure 6.3 ®See Appendix A.

79 1^, w#'
(6.6)

where Rp and Lp are the values of the equivalent passive resistance and inductance, respec tively.

In addition, the Q for this active inductor is quite small given the small value of Rp. With the use of a negative impedance circuit (NIC), Q can be enhanced at the cost of a reduced resonance frequency, increased power consumption and noise. For these reasons, an NIC is not employed in the proposed delay cell.

6.5

Com parative Speed Analysis

Following the same design process, let us now find the oscillation frequency of the proposed delay cell with active inductor loads. The load impedance Z of the proposed cell is the combination of the load capacitance C l in parallel with the equivalent passive circuit^ of the active inductor as shown in Figure 6.5.

R P

Equivalent Passive circuit of Active Inductor

Figure 6.5; Load impedance of delay cell employing active inductors. The transfer function of the new delay cell can easily be computed:
^See Appendix A for a full analysis of the active inductor equivalent circuit and the derivation of equations relating to the equivalent passive components Rp, Cp, Lp, and Rg with the active parameters of PI, P 2 and

h.

80

H M = ^

V2

= 9r.Z =

[i?5 + Rp] + s[Lp + RpCpRs + RpC^Rs] + s'^lRpCpLp + RpC^Lp] (6.7)

W

+ S

The above transfer function can be simplified further by substituting the equivalent passive components Rp, Cp, Lp, and Rs with the active parameters of PI, P 2 and R according to the simplified equations:

Cp Rp Rs Lp

= Cgs2, =
=

(6.8) (6.9)
, ( 6 . 10)

gm .2

,

9migm2 + gmigo2 = -^ £ 1 -. 9ml9Tn2 (6.11)

Prom the above equations, we can neglect Rs and simplify the transfer function of (6.7) to:

H{s)

=

Cp + Cx,

+ Xp[Cp+Ct]
^ (6 . 12)

Cgs2 + Cx

+ Scpfa'+C 'x, + Cgsl^g^lcLÎ

The above equation has the form of a bandpass biquadratic transfer function of the form H{s) = K .^2^As+uj^i and whose bode plots are shown in Figure 6.6.

The resonant frequency cU q and quality factor Q of the delay cell can be detected to be:

(jjf, =

Lp{Cp + C l) gmigm2
C g s l{C g s 2

(6.13)
C lY

+

Q =
V 9m 2
^ gsl

(6.14)

81 For differential oscillators to generate quadrature outputs, the minimum number of stages

required for maximum oscillation frequency is A^=4. Therefore, the phase shift required per delay stage is -- 45°. The frequency dependant phase shift for the given transfer function is given by:
7T

U JU o

(6.15)

The bode phase plot in Figure approximately equal to 5W (,.
Magnitude (dB)

6.6, shows that at -- 45°, the oscillation frequency is

3dB 201ogQ

-20dB/dec +20dB/dec

Phase (degree)

-45' -90'

Figure

6.6: Bode plots of H{s) =

For comparison purposes, we simplify the oscillation frequencies for both the conventional R C delay cell and that of the delay cell with active inductor loads:

82

- 5w« - 5

^

^

- Yc

J c l T l CJ

-

k^Ib[h + Iss/^]
C ,s l[ C ,s 2 + C , V

.
^

.

^

fiCi 

"

c i''

where A : is a factor determined by the size ratio of the respective loads. l O o sc L and u Joscr are the oscillation frequencies of a four stage ring oscillator utilizing an inductive load and resistive load, respectively.

Clearly the oscillation frequency of a four-stage ring oscillator using the proposed delay cell exceeds the frequency of an oscillator using the conventional RC delay cell.

As a final step, let us find the oscillation condition for the proposed delay cell. The magnitude of the transfer function at the oscillation frequency should be greater than unity. The magnitude of the transfer function is:

Setting the gain to be greater than unity yields:

24 24
9m >

gml9m2[Cgs2 + C l ] Cgsl

(6.19)
(6.20)

~^Q 9m 2-

6.6

Sim ulation

A 4-stage ring oscillator was designed using the proposed delay cell of Figure 6.4. The cell was designed in TSMC 0.18//m CMOS technology and analyzed using Cadence's Spectre with BSIM3v3 device models. To estimate the speed benefit of the proposed delay cell, a

83 4-stage ring oscillator using the conventional RC delay cell was also constructed using the

same CMOS technology.

£

Time (ps)

F ig u r e 6.7: Conventional VCO output waveform at 5 GHz.

t 1.45

Time(ps)

F ig u r e 6.8: Proposed VCO output waveform at 7 GHz.

Figures 6.7 and

6.8 present the simulated output waveforms of a four-stage oscillator utilizing

the conventional RC delay cell and the proposed delay cell, respectively. Only one output of the quadrature signals is plotted. The maximum simulated oscillation frequency achieved using the conventional cell is 5 GHz, while the maximum achievable using the proposed delay stage is 7.1 GHz. The new approach offers an improvement of approximately 42% in the

84
x io *

Control Voltage (V)

Figure 6.9: Simulated frequency tuning characteristic of the proposed VCO. operating frequency of the cell.

The frequency tuning range of the proposed delay stage is plotted in Figure 6.9 to be from

5.2 GHz to 7.1 GHz, or equivalently ±15%.

6.7

Conclusions

A high speed ring oscillator suitable for quadrature clock signal generation was constructed. The design achieves frequency enhancement through the use of high frequency low voltage active inductors as loads of the delay cells. The new delay cell proved an improvement in oscillation frequency by about 42%, while exhibiting a tuning range of ±15%.

Chapter 7 Phase-Locked Loop Design
This chapter presents the design procedure for a third-order charge-pump PLL and its sim ulation results. Before proceeding, it is important to realize that the design procedure is an iterative process. This is mainly due to the difficulty in matching the design parameters of the system level to that of the transistor level.

7.1

D esign Procedure

The design procedure presented in this section deals only with the system level parameters.

Of the basic specifications given when designing a PLL is the frequency range, which the VCO tuning range should cover. In our case, we intend to design a PLL that will accommodate the tuning range of the VCO (5.3 GHz - 7.1 GHz). The input reference frequency is given as 6.3 GHz and the power supply is

1.8 V. The steps below illustrate the design procedure:

1. Determine the VCO gain (K ycp) : The VCO gain is a function of the VCO tuning
range and the control voltage range which is limited by the power supply and the voltage levels necessary to keep the charge-pump in saturation.

- - T
85

-

""

2. Determine the damping factor

(Cmeon)

86 : The damping factor affects speed and stabil

ity. As a compromise, for a third order PLL, C m eon is often set to 0.707. 3. Determine the natural frequency (w,,) : Since the loop bandwidth has to be less than one-tenth of the reference frequency, but at the same time, as wide as possible to improve noise performance, a compromise between stability and noise performance, will set: = ( 0 .7 5 ) : ^ = 2.98, [Grad/s] (7.2)

The natural frequency has a significant effect on loop bandwidth. For a third order PLL whose damping factor equals 0.707, the natural frequency is related to the loop bandwidth according to: BWiaop = w»[\/2C " 4 - 1 -H\/(2C2-f-1)2 + 1]; = 1.45, [Kradjs] (7.3) (7.4)

4. Determine the charge-pump current (7cp) and loop filter capacitor(Ci) : Icp and Ci can be determined by the relationship between the natural frequency w,,, and the VCO gain K vco- It is desirable to have a high Icp which will ensure a high loop gain and con sequently a stable system. However, a large Icp will dictate a large capacitor C\ and consequently a large chip area. Therefore, a design tradeoff in the value of Icp is nec essary to ensure a stable yet area-efBcient PLL system. However, the VCO designed has an extremely large gain due to the narrow voltage control range, therefore the capacitor size will be small. Lets set Icp = 2.45 mA^ and the Loop filter capacitor is determined by:
Cl =

'n

= 10'

M

(7.5)

5. Determine the Loop Filter Components (R and Cg) : The Loop filter resistor is used to set the damping factor: R=

2- ^

w,,Gi

= 98,

[Q]

(7.6)

^While this value is large, it is necessary to ensure practical values for C\ and C2

87 The second loop filter capacitor Cg is used to suppress the ripple in the control voltage.

To maintain the order of the loop filter (second order), of Cl:
K 1

is set to less than one-tenth

(7.7)

The design process has defined all the key system level parameters. In the following sections, we will present the design and simulation of the different blocks, followed by the simulations of the overall PLL system.

7.2

Phase-Frequency D etector

The PFD circuit used is the one seen in Figure 7.1 and presented in section 3.2.2.

ONE

D OFF A >C K ^

Reset

Delay

B o ------- > C K Q D

ONE

Figure 7.1: Dead-zone free PFD. The D fiip-fiops used are optimized specifically for operation in the PFD. Since the data signals D is always set to high, a smaller number of devices in the signal path can be used to increase speed. The schematic of the flip-flop is shown in Figure 7.2. The circuits output Q goes high on a rising edge of the C L K signal. The output signal stays high as long as the reset signal R stays low. For maximum speed, the transistors are sized to the minimum.

88

while ensuring that effective pull-up and pull-down resistances are matched.

Ml

M6

M IO M 13

C LK ,

M2

MS M 7 M 12

M3

M4

M8 M il

Figure 7.2: Transistor implementation of DFF. The schematic of the AND gate is shown in Figure 7.3.

M3 A

M4

M6

M2

A.B

B

Ml

MS

Figure 7.3: Transistor implementation of AND gate. The PFD was implemented in TSMC 0.18//m CMOS technology and analyzed using Ca dence's Spectre with BSIM3v 3 device models. Figure 7.4 demonstrates the proper operation of the PFD. The frequency of one of the inputs was set to twice the frequency of the second signal.

Unfortunately, due to the delays in the signal path, this circuit failed to operate at frequen-

89
Reference Signal (V)

^

F e e d b a c k ^ i g n a l (V )

^

U P S iâ ia l(V )

^

®

2

D N S i g n a l (V )

3

! /V

--
2
R e s e t S i g n a l (V )

1 3

1 4 ly v

5

y\
T im i (n s)

F ig u r e 7.4: Phase frequency detector simulation results.

cies of 7 GHz. Increasing the drive strength of the transistors (M2, M5 and MIO) in the signal path can slightly improve the operating speed, but not to the required frequency. Dynamic flip-flops that operate at a frequency of about but not implemented in this thesis.

6 GHz have been reported in [47],

7.3

Charge-Pum p

Numerous charge-pump topologies were presented in chapter 4, given the high operating speed, and narrow control voltage range of the VCO, the choice of charge-pump has to take into account fast switching and minimal charge injection. The charge-pump used in our phase-locked loop design is an NMOS switches only current-steering charge pump employ ing a current-reuse technique presented in Section 4.4 [11]. The full transistor charge-pump circuit is shown in Figure 7.5. The circuit consists of NMOS current switches(Ml, M2, M7 and MS), current-mirror loads (M3, M4, M9 and MIO) and pull-up current mirrors (M5, M6, M il and M12) that increase the discharge speed. Given that both the U P and D N signals

90 use NMOS only current switches, current converter (M13-M14) is used to ensure the proper

direction of the discharge current. The addition of the current converter will introduce a new slow node that can slow down the discharge speed of the charge-pump, this problem can easily be remedied via a small discharge transistor [31].

M5

M6

M 1 2

M il

M3

MIO

U PB "-- I F

m

I

M13

M14

F ig u r e 7.5: Current reuse charge-pump implemented.

Since the designed PFD failed to work at the high frequency of the VCO, an ideal PFD from Cadence "ahdl" library was imported to test the phase-frequency detector and charge-pump combination. The input reference signal was set at 7 GHz, and a second-order low-pass loop filter was used as the output load. Figure 7.6 illustrates the charging of the loop filter, when the feedback signal lags in phase the reference signal. Similarly, Figure 7.7 demonstrates the charging of the loop filter when the feedback signal leads the reference signal.

91
Reference Signal (V)

0.1

0.2

0.4

0.5

0.6

0.7

0.8

F e e d b a c k s i g n a l (V )

0.1

0.2

0.3

0-5
U P S ic jn a l (V )

0.7

0.8

0.9

0.1

0.2

Q
D N S ig n a l (u V )

0.7

0.8

0.9

-2

0.1

0.2

0.3

0.84 0.82
0.8
0 0.1
0.2

0.4 0.5 0.6 O u t p u t C o n tr o l V o lta g e (V )

0.7

0.8

0.9

0.3

0.4

T im e (n s)

0.7

0.8

0.9

1

F ig u r e 7.6: The PFD and CP signals when the feedback signal lags reference signal.
R e f e r e n c e S ig n a l (V )

0.1

0.2

0.3

0.4

F e e d b a c k s ig n a l (V )

0.5

, 0.6

0.8

0.9

0.1

0.2

0.3

0.4

0.5
U P S i g n a l (V )

0.6

0.8

0.9

0.2

0.3

0.4

0.5
D N S ig n a l (V )

0.6

0.7

0.8

0.9

-2

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

0.8

O u tp u t C o n tr o l V o lta g e (V )

0.75
0 0.1 0.2

0.3

0.4

T im e (n s )

0.5

0.6

0.7

0.8

0.9

1

Figure 7.7: The PFD and CP signals when the feedback signal leads reference signal.

7.4

Sim ulation R esults

92

The full charge-pump PLL was constructed and designed in 0.18//m CMOS technology. To simulate the tracking of the PLL, the input reference frequency was set to 6.3-GHz, and the frequency of the oscillator's output waveform was varied to simulate two different cases. In the first case, the frequency of the VCO output was set to 5.7-GHz. Figure 7.8 illustrates how tracking operation of the PLL by increasing the control voltage until lock. Figure 7.9 shows a zoomed in view of both the input reference signal and the VCO output at two different time intervals, before lock and in-lock. In the second case, the frequency of the VCO output waveform was set to lead at 6.7-GHz. Similarly, Figure 7.10 illustrates how tracking operation of the PLL by decreasing the control voltage until lock. Figure 7.11 shows a zoomed in view of both the input reference signal and the VCO output at two different time intervals, before lock and in-lock.

Input Reference Signal (V)

3 4 5 Oscillator Output Waveform (V)

3 4 5 VCO Control Voltage (V) 0.84 0.83 0.82 0.81

0.8
0.79 0.78 Time (xIO ns)

Figure 7.8: PLL simulation: VCO output lags input reference signal.

93
Unlocked Signais 1.6 1.6
-- In p u t R e f e r e n c e s ig n a i O s c iiia to r O u tp u t In p u t R e f e r e n c e s ig n a l O s c iiia t o r O u tp u t

Locked Signais

1.5 1.4 1.3
1.2

1.4

0.9
0.8

3.5

4.5
T ir n e ( n s )

5.5

0.8

8.5

8.55

8.6

8.65
T im e (x I O n s )

8.7

8.75

Figure 7.9: Reference and feedback signals before and after lock.

Input Reference Signal (V)

3 4 5 Oscillator Output Waveform (V)

I

3 4 5 VCO Control Voltage (V) 0.84 0.82 0.8 0.78 Time (x10 ns)

Figure 7.10: PLL simulation: VCO output leads input reference signal.

94

1.6

In itia l U n lo c k e d S i g n a l s (V ) 1.6 In p u t R e f e r e n c e S ig n a l

lo c k e d S i g n a l s (V ) I n p u t R e f e r e n c e S ig n a l --* - O s c ill a to r O u tp u t

1.5 1.4 1.3
1.2

1.5 1.4 1.3
1.2

1.1

1.1

0.9
0.8

0.9 1.75
1.8

1.7

1.85
T im e (n s )

1.9

1.95

0. 8.

7.05

7.1

7.15
T im e (x 1 0 n s )

7.2

7.25

7.3

Figure 7.11: Reference and feedback signals before and after lock.

Chapter 8 Conclusions
8.1 Conclusions

In conclusion, a PLL was designed using a new active inductor 6.3-GHz ring oscillator, with a tuning range of ±15% was designed in 0.18/im CMOS technology. The ring oscillator employed active inductor loads that resulted in an improvement of about 42% in oscillation frequency when compared to the conventional resistor loaded ring oscillator.

Moreover, a wide array of charge-pumps was presented, and different topologies were com pared and an in-depth comparison of their characteristics such as, speed, minimum supply voltage, mismatch-induced errors, charge injection and clock feed-through induced errors, and noise rejection was established.

Furthermore, a comparative study of the architecture and timing jitter of the delay-cells of low-voltage CMOS ring-VCOs was featured. Design considerations, such as noise, single ended versus differential configuration, linearity and symmetry of load, and the output volt age swing of delay cells were examined in detail. The worst-case sensitivity of the delay time of the delay cells and that of the oscillation frequency of corresponding ring-VCO were verified.

95

8.2

Future Research

96

At high performance levels, demands for low power, high speed and noise elRciency run counter to each other and compromises have to be made. As CMOS technology continues to diminish in size, current densities will increase, supply voltages will drop, and sensitivity to supply voltage fluctuation will become more important. During the course of my research, I came across a many paths that I chose, for the sake of time, not to explore.

Moreover, designing a high frequency VCO as part of a PLL, dictates the design of a PFD capable of operating at similar speeds. As of today, there are no known PFDs that are capable of operating at such speeds in 0.18 fim CMOS technology. Had the application been frequency synthesis, the need for a high-speed PFD would be overcome by a high speed frequency divider or pre-scaler, which introduces a signiflcant amount of switching noise. Researching either of the topics considering the speed and noise trade-offs would prove ben eficial.

For one, the output waveforms of the VCO experienced limited swing that is undesirable in certain applications. High frequency differential buffers can alleviate this problem. Design ing buffers to operate at the frequency of the VCO is a challenge in itself, given the available 0.18 {im CMOS technology.

Furthermore, while the proposed VCO achieved high frequency operation and had a reason able tuning range, its gain K y c o was very high, which makes it susceptible to jitter at the control voltage. Further research is required in order to improve the VCO's immunity to variations in the control voltage.

Designing all of the sub-circuits mentioned in the thesis at low supply voltages was challeng ing, one way to relax the constrain on design low-supply voltage is to bias the body of the active devices in order to lower their threshold voltage levels. Off course doing so will have

97 significant repercussions on the noise performance of the circuit at hand. Moreover, whether

the body bias voltage can be used as a control node to the VCO, is a research path, few have chosen to research and one that might proof to be fruitful.

While the feasibility of using an active inductor was presented, and the results were positive, more research could have gone into analyzing the noise performance of the new delay cell, given the new load structure. How the quality factor Q of the active inductor affects the noise performance of the VCO, is a topic worth further exploration.

Furthermore, several researchers have developed current-mode active filters. Whether an ac tive current-mode filter is a suitable replacement to the conventional passive low-pass filters used in PLLs is a topis worth researching. While clearly, there is benefit in reduction of on-chip area, whether the PLL jitter performance is better or worst due to the active filter has not been researched.

Bibliography
[1] B. Razavi, Monolithic Phase-Locked Loops and Clock Recovery Circuits, pp.1-39, IEEE Press, 1996. [2] B. Razavi, Design of Analog CMOS Integrated Circuits, pp. 532 - 569, McGraw-Hill,
2001 .

[3] R.E. Best, Phase-Locked Loops, Fourth Ed., McGraw-Hill, 1999. [4] R. J. Baker, H. W. Li, and D. Boyce, CMOS: Circuit Design, Layout, and Simulation, IEEE Press, 1998. [5] P. M. Gardner, ''Charge Pump Phase-lock loops," IEEE Transactions on Communica tions, Vol. 28, No.

11, pp. 1849 - 1858, Nov 1980.

[6] J. Kang and D. Kim, "A CMOS clock and data recovery with two-XOR phase-frequency detector circuit," Proc. of ISCAS'Ol, IEEE Int. Symposium on Circuits and Systems, Vol. 4, pp. 266 - 269, May 2001. [7] S. Anand and B. Razavi, " A CMOS clock recovery circuit for 2.5-Cb/s NRZ data," IEEE J. Solid-State Circuits, Vol. 36, No. 3, pp. 432 - 439, March 2001. [8] S. Soliman, F. Yuan, and K. Raahemifar, "An overview of design techniques for CMOS phase detectors," Proc. of ISCAS'02, IEEE Int. Symposium on Circuits and Systems, Vol. 5, pp. 457 - 460, May

2002.

[9] C.A. Sharpe, "A 3-state phase detector can improve your next PLL design," EDN Mag, pp. 55 - 59, September

20, 1976.
98

99 [10] M. Soyuer and R. G. Meyer, "High-Frequency phase-locked loops in monolithic bipolar

technology," IEEE J. Solid-State Circuits, Vol. 24, No. 3, pp. 787 - 795, June 1989. [11] E.J. Hernandez, and A.D. Sanchez, "A Novel CMOS Charge-Pump Circuit with Positive Feedback for PLL Applications," Proc. of ICECS' 01, The 8''* IEEE Int. Conference on Electronics, Circuits and Systems, Vol. 1, pp.

349 - 352, Sep 2001.

[12] B. Razavi, Design of Integrated Circuits for Optical Communications, pp. 260 - 280, Mcgraw-Hill, 2003. [13] W. Rhee, 'Design of High-Performance CMOS charge-pumps in phase-locked loop," Proc. of ISCAS' 99, IEEE Int. Symposium on Circuits and Systems, Vol. 1, pp. 545 548, June 1999. [14] L.Dai and R. Harjani, "CMOS Switched-Op-Amp-Based Sample-and-Hold Circuit," IEEE J. Solid-State Circuits, Vol. 35, No. 1, pp. 109 - 113, January 2000. [15] A. Waizman, "A delay line loop for Frequency synthesis of deskewed clock," Proc. of ISSCC' 9 4 , IEEE Int. Conference on Solid State Circuits, pp. 298 - 299, Feb 1994. [16] J. Maneatis, "Low-Jitter and Process-Independant DLL and PLL based on Self-Biased Techniques," Proc. of ISSCC' 96, IEEE Int. Conference on Solid State Circuits, pp. 130 - 131, Feb 1996. [17] R.C. Chang and L.C Kuo, "A new Low-Voltage Charge-Pump Circuit for PLL," Proc. of ISCAS' 00, IEEE Int. Symposium on Circuits and Systems, Vol. 5, pp. 701 - 704, May 2000. [18] M.S. Lee, T.S. Cheung, and W.Y. Choi, "A Novel Charge-Pump PLL with reduced Jitter Characteristics," Proc. of ICVC' 99, The 6^ ^ IEEE Int. Conference on VLSI and CAD, pp. 596 - 598, Oct 1999. [19] M. Johnson and E. Hudson, "A Variable delay line PLL for CPU-coprocessor synchro nization," IEEE J. Solid-State Circuits, Vol. 23, No. 5, pp. 1218 - 1223, Oct 1988.

100 [20] J.S. Lee, M.S. Keel, S.I. Lim, and S. Kim, "Charge pump with perfect current matching

characteristics in phase-locked loops," IEEE ELECTRONIC LETTERS, Vol. 36, No. 23, pp. 1907 - 1908, November 2000. [21] O.T. Chen and R.R.B. Sheen, "A Power-efBcient Wide-Range Phase-Locked Loop," IEEE J. Solid-State Circuits Vol. 37, No. 1, pp. 51 - 62, Jan 2002. [22] C.M. Hung and O.K. Kenneth, "A Fully Integrated 1.5-V 5.5-GHz CMOS Phase Locked Loop," IEEE J. Solid-State Circuits, Vol. 37, No. 4, pp. 521 - 525, April

2002.

[23] L. Wu, H. Chen, S. Nagavarapu, R. Geiger, E. Lee, and W. Black, "A Monolithic 1.25 Gbit/sec CMOS Clock/Data Recovery Circuit for Fibrechannel Transceiver," Proc. of ISCAS' 99, IEEE Int. Symposium on Circuits and Systems, Vol. 2, pp. 565 - 568, June 1999. [24] J.M. Ingino and V.R. Kaenel, "A 4-GHz Clock System for a High-Performance Systemon-a-chip Design," IEEE J. Solid-State Circuits Vol. 36, No. 11, pp. 1693 - 1698, Nov

2001.
[25] W.H. Lee, J.D. Cho, and S.D. Lee, "A High Speed and Low Power Phase-Frequency Detector and charge-pump," Proc. of ASP-DAC' 99, IEEE Conference on Design Au tomation Conference, Asia and South Pacific, Vol. 1, pp. 269 - 272, Jan 1999. [26] Jan M. Rabaey, Digital Integrated Circuits: a design Perspective, pp. 227 - 231, PrenticeHall, 1996. [27] A. Hajimiri, S. Limotyrakis, and T.H. Lee, "Jitter and Phase noise in Ring Oscillators," IEEE J. Solid-State Circuits, Vol. 34, No. 6, pp. 790 - 804, June 1999. [28] Y. Eken and J.P. Uyemura, "A 5.9-GHz Voltage-Controlled Ring Oscillator in 0.18 pm CMOS," IEEE J. Solid-State Circuits, Vol. 39, No. 1, pp. 230 - 233, Jan 2004. [29] I.e. Hwang, C. Kim, and S.M. Kang, "A CMOS Self-Regulating VCO with Low Supply Sensitivity," IEEE J. Solid-State Circuits, Vol. 39, No. 1, pp. 42 - 48, Jan 2004.

[30] J.J. Kim, S.B. Lee, T.S. Jung, C.H. Kim, S.l. Cho, and B. Kim, "A Low-Jitter MixedMode DLL for High-Speed DRAM Applications," IEEE J. Solid-State Circuits, Vol. 35, No.

r

.

.

101

10, pp. 1430 - 1436, Oct 2000.

[31] J. Lee and B. Kim, "A Low-Noise Fast-Lock Phase-Locked Loop with Adaptive Band width Control," IEEE J. Solid-State Circuits, Vol. 35, No.
2000 .

8, pp. 1137 - 1145, Aug

[32] C.H. Park and B. Kim, "A Low-Noise, 900-MHz VCO in

0.6-//m CMOS," IEEE J.

Solid-State Circuits, Vol. 34, No. 5, pp. 586 - 591, May 1999. [33] J.G. Maneatis and M.A. Horowitz, "Precise Delay Generation Using Coupled Oscilla tors," IEEE J. Solid-State Circuits, Vol. 28, No.

12, pp. 1273 - 1282, Dec 1993.

[34] L. Dai and R. Harjani, "Comparison and Analysis of Phase noise in Ring Oscillators," Proc. of ISCAS' 00, IEEE Int. Symposium on Circuits and Systems, Vol. 5, pp. 77 - 80, May 2000. [35] L. Dai and R. Harjani, "Design of Low-Phcise-Noise CMOS Ring Oscillators," IEEE Transactions on Circuits and Systems-II: Analog and Digital Signal Processing, Vol. 49, No. 5, pp. 328 - 338, May

2002.

[36] A. Maxim, "Low-Voltage CMOS Charge-Pump PLL Architecture for Low Jitter Oper ation," Proc. of ESSCIRC' 02, European Solid-State Circuits Conference, pp. 423 - 426, Sep

2002.

[37] C.Y. Chang, P.C. Chen, C.Y. Yang, and Y.H. Lee, "The CMOS on-chip oscillator based on level tracking technique," Proc. of ASIC' 02, IEEE Asia-Pacific Conference on ASIC, pp. 197 -

200, Aug 2002.

[38] H. Chen and R. Geiger, "Maximizing the Oscillation Frequency of CMOS VCOs," Proc. of M W SCAS' 00, IEEE Mid-West Symposium on Circuits and Systems, Vol. 3, pp. 1248 - 1251, Lansing, MI, Aug. 2000.

102 [39] S. Mohan, M. Hershenson, S. Boyd, and T.H. Lee, "Bandwidth Extension in CMOS

with optimized On-Chip Inductors," IEEE J. Solid-State Circuits, Vol. 35, No. 3, pp. 346 - 355, March 2000. [40] Y. Oh, S. Lee, and H. Park, "A 2.5Gb/s CMOS Transimpedance Amplifier Using Novel Active Inductor Load," Proc. of ESSCIRC' 01, European Solid-State Circuits Confer ence, Villach, Austrai, Sep.

2001.

[41] S. Kara, T. Tokumitsu, T. Tanaka, and M. Aikawa, "Broad-Band Monolithic Microwave Active Inductor and its Application to Miniaturized Wide-Band Amplifiers," IEEE Transactions on Microwave Theory and Techniques, Vol. 36, No. December 1988. [42] A. Thanachayanont, " CMOS Transistor-Only Active Inductor for IF/RF Applications," Proc. of IC IT ' 02, IEEE Int. Conference on Industrial Technology, Vol. 2, pp. 1209 -

12, pp. 1920 - 1924,

1212, Dec. 2002.
[43] A. Worapishet and M. Thamsirianunt, "An NMOS inductive loading technique for ex tended operating frequency CMOS ring oscillators," Proc. of MWSCAS' 02, IEEE MidWest Symposium on Circuits and Systems, Vol. 1, pp. 116 - 119, Oklahoma, Aug.

2002.

[44] E. Sackinger and W. Fischer, "A 3-GHz 32-dB CMOS limiting Amplifier for SONET OC-48 Receivers," IEEE J. Solid-State Circuits, Vol. 35, No.
2000 .

12, pp. 1884 - 1888, Dec.

[45] Y. Wu, M. Ismail, and H. Olsson, "A Novel CMOS Fully Differential Inductorless RF Bandpass Filter," Proc. of ISCAS' 00, IEEE Int. Symposium on Circuits and Systems, Vol. 4, pp. 149 - 152, Geneva, May.

2000.

[46] H. Xiao and R. Schaumann, "A Low-Voltage Low-Power CMOS 5-GHz Oscillator based on Active Inductors," Proc. of ICECS' 02, IEEE Int. Conference on Electronics, Circuits and Systems, Vol. 1, pp. 231 - 234, Sept

2002.

1U3 [47] S. Li and M. Ismail, "A 7 GHz 1.5-V Dual-Modulus Prescaler in 0.18/rm Copper-CMOS

Technology," IEEE J. Analog Integrated Circuits and Signal Processing, Vol. 32, No. 1, pp. 89 - 95, July,

2002.

Appendix A Active Inductor and its equivalent circuit
The CMOS active inductor shown in Figure A .l is composed of transistors PI, P 2 and current source h- In order to find the equivalent circuit and equivalent impedance of the active inductor, the small signal equivalent circuit of the active inductor is shown in Figure A.2\

PI

P2 \o --I

-eq

F ig u r e A .l : Active Inductor. ^Assuming Cgs ^ Cgd, the gate-drain capacitance can be neglected for simplicity.

104

105

The equivalent impedance Z^q, can easily be found by: Un -- ~ where + 5m2 + sC'psa] +

14 + ^02(1 ^ 2 ~ 14)5
-- )' (A.l)
9 o2 + 9 o2 +

yi[9o\ + 9m2 + sCgs2 + 9mi--

9o, and Cgs are the transconductance, output conductance, and gate-to-source

capacitance to the corresponding transistors. Q oz is the output conductance of the current source
If,.

R,
'gs2

R

Figure A . 2: Small signal equivalent circuit of Active inductor. Similarly, the equivalent impedance of the passive circuit, can easily be found to be

iTM = v ; ,, [ i + s C p + - g - ^ ] .

(A.2)

By mapping the equivalent impedance of equation (A.l) to that of the passive equivalent circuit, we get

Cp Rp =

Cgs2l
9ol + 9m2 9o2 + ffo3 9ml9m2 "b 9ml9o2
C g sl

(A.3) (A.4) (A.5) (A.6)

Rs = Lp --

9ml9m2 "b 9m\9o2

Assuming the transistors exhibit high output impedance, the passive circuit equivalent pa rameters can be simplified further to

106

Cp
Rp

= Cp,2, = -- ,
9m2

(A.7) (A.8) (A.9) (A.10) equal:

Rs ip

= negligible, = 9m\gm2

whose quality factor Q and resonant frequency

Q =

(A.11) (A.12) (A. 13)
9ml 9m2

V ^t2

(A.14)

Y Cpsl Cgs2 where (jJt\ and are the unity gain frequencies of transistors PI and P 2 respectively.

VITAE
NAME: PLACE OF BIRTH: YEAR OF BIRTH: POST-SECONDARY EDUCATION AND DEGREES: Mohamad El-Hage Beirut, Lebanon 1979 Ryerson Polytechnic University Toronto, Ontario 1997-2002, B.Eng Deans Honors List 1998-1999, 2001-2002 Jack Roy Longstaffe Memorial Scholarship 1998-1999 RELATED WORK EXPERIENCE: Sep 2002 - Sep 2004, Ryerson University Teaching Assistant and Research Assistant May 2000 - Aug 2001, Nortel Networks Power Commodity Management Team Technical Prime / Global Operations PUBLICATIONS: 1. M. El-Hage and F. Yuan, ''Timing jitter analysis of delay cells of CMOS voltage con trolled oscillators," 2004 IEEE Canadian Conference on Electrical and Computer En gineering (CCECE2004). Niagara Falls, May 2004. 2. M. El-Hage and F. Yuan, ''Architectures and Design Considerations of CMOS Charge Pumps for Phase- Locked Loops,"2003 Canadian Conference on Electrical and Com puter Engineering (CCECE2003), Montreal, May 2003. 3. M. El-Hage and F. Yuan, "A fully differential CMOS current-mode preamplifier for Gb/s optical communications," presented at International Conference for Up-Coming Engineers (ICUE 2002), Toronto, Ontario, Canada, April 2002. 4. M. El-Hage, X. Fernando and F. Yuan, "A Wideband CMOS Optical Receiver," pre sented at Opto- Canada 2002, Ottawa, May 2002 (Third prize winner). 5. Other: Low Power Digital Integrated Circuits Laboratory Manual.

HONORS AND AWARDS:

107

