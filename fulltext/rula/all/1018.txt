Ryerson University

Digital Commons @ Ryerson
Theses and dissertations

1-1-2011

Fault detection and isolation in an aircraft engine bleed air system
Lan Shang
Ryerson University

Follow this and additional works at: http://digitalcommons.ryerson.ca/dissertations Part of the Aerospace Engineering Commons Recommended Citation
Shang, Lan, "Fault detection and isolation in an aircraft engine bleed air system" (2011). Theses and dissertations. Paper 751.

This Dissertation is brought to you for free and open access by Digital Commons @ Ryerson. It has been accepted for inclusion in Theses and dissertations by an authorized administrator of Digital Commons @ Ryerson. For more information, please contact bcameron@ryerson.ca.

FAULT DETECTION AND ISOLATION IN AN AIRCRAFT ENGINE BLEED AIR SYSTEM
by

Lan Shang Master of Applied Science Ryerson University, Canada, 2007 Bachelor of Engineering Beijing University of Technology, China, 2004

A dissertation presented to Ryerson University in partial fulfillment of the requirement for the degree of Doctor of Philosophy in the Program of Aerospace Engineering

Toronto, Ontario, Canada, 2011 Â©Lan Shang, 2011

AUTHOR'S DECLARATION

I hereby declare that I am the sole author of this dissertation.

I authorize Ryerson University to lend this dissertation to other institutions or individuals for the purpose of scholarly research.

______________________________

I further authorize Ryerson University to reproduce this dissertation by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

______________________________

II

FAULT DETECTION AND ISOLATION IN AN AIRCRAFT ENGINE BLEED AIR SYSTEM
Lan Shang Doctor of Philosophy, 2011 Program of Aerospace Engineering, Ryerson University

ABSTRACT
High temperature pressurized bleed air generated in the engine compressor is used for air conditioning in a jetliner. The engine bleed air must be regulated to a target temperature in the bleed air temperature control system using cold ram air before it can be used in the cabin or other low temperature area. The bleed air system is a control system that consists of sensors, and valve actuators. Potential faults associated with these components need to be considered in the design of the control system. This dissertation focuses on fault detection and diagnosis of the bleed air temperature control system. The faults in temperature sensors and valve actuators are detected using two unscented Kalman filters. The source of a fault is identified using the squared residuals. Nonlinear governing equations for the engine bleed air temperature control system are derived in state space form. Convergence analysis of the proposed fault detection and diagnosis methods is conducted. Heat exchanger is another core component in the bleed air temperature control system. A common fault associated with a heat exchanger is fouling which reduces the heat transfer efficiency, introduces additional resistance to flow, and increases fuel consumption. This dissertation presents a heat exchanger fouling detection method based

III

on the valve control command of an engine bleed air temperature control system. Heat exchanger fouling is monitored by estimating the deviation of valve control command. A simulated bleed air temperature control system has been designed and built. Experiments have been conducted for temperature sensor fault, valve actuator fault, and heat exchanger fouling. Computer simulations for each of these cases are conducted and compared to experimental results.

IV

ACKNOWLEGEMENT

The author would like to express her gratitude to her supervisor, Dr. Guangjun Liu, for his guidance before, during and after the process of this dissertation work. The author would also like to thank her friends and colleagues at the Systems and Control Laboratory, especially Shoaib Shah and Dale Molenaar, for their valuable discussions and suggestions on the simulation and experiments. Special thanks are given to Primoz Cresnik for his great help on the development of the experimental setup. Finally, the author wants to express her deep gratitude towards her parents for their love, encouragement and support.

V

TABLE OF CONTENTS

TABLE OF CONTENTS ......................................................................................... VI LIST OF FIGURES ..................................................................................................IX LIST OF TABLES ...................................................................................................XII NOMENCLATURE ...............................................................................................XIII CHAPTER 1 INTRODUCTION .............................................................................1 1.1 1.2 1.3 1.4 BLEED AIR TEMPERATURE CONTROL SYSTEM .........................................................1 FAULTS IN BLEED AIR TEMPERATURE CONTROL SYSTEM .......................................4 FAULT DETECTION AND D IAGNOSIS METHODS ........................................................6 HEAT EXCHANGER FOULING DETECTION .............................................................. 10

1.4.1 Types of fouling .................................................................................................. 10 1.4.2 Effect of fouling in heat exchanger ................................................................... 11 1.5 ORGANIZATION OF THESIS ...................................................................................... 12

CHAPTER 2 MODELING OF BLEED AIR SYSTEM ......................................... 14 2.1 2.2 SYSTEM CONFIGURATION AND MODELING ASSUMPTION ..................................... 14 NONLINEAR MODEL OF AN ENGINE BLEED AIR SYSTEM ...................................... 15

2.2.1 Control valve and flow rate ............................................................................... 15 2.2.2 Pressure calculation........................................................................................... 17 2.2.3 Temperature calculation .................................................................................... 19 2.2.4 Heat exchanger dynamics .................................................................................. 20 2.3 2.4 DISCRETE TIME SYSTEM MODEL ............................................................................ 21 RAM-AIR-PLUS-BYPASS CONTROL STRATEGY ....................................................... 22
VI

2.5

SIMULATION RESULTS ............................................................................................ 24

2.5.1 Ram air channel control .................................................................................... 25 2.5.2 Bypass channel control ...................................................................................... 26 2.5.3 Ram-air-plus-bypass channel control ............................................................... 28 CHAPTER 3 SENSOR AND ACTUATOR FAULT DETECTION AND ISOLATION 30 3.1 3.2 3.3 3.4 UNSCENTED KALMAN FILTER ALGORITHM ........................................................... 30 CONVERGENCE ANALYSIS ...................................................................................... 34 FAULT DETECTION AND I SOLATION METHOD ........................................................ 43 SIMULATION RESULTS ............................................................................................ 45

CHAPTER 4 HEAT EXCHANGER FOULING DETECTION ............................ 53 4.1 4.2 4.3 FOULING DETECTION ALGORITHM ......................................................................... 53 RESIDUAL GENERATION USING EKF ..................................................................... 54 EFFECT OF FOULING ................................................................................................ 56

CHAPTER 5 DEVELOPMENT OF TEST FACILITY AND EXPERIMENTS ... 61 5.1 5.2 TEST RIG DESIGN .................................................................................................... 61 MAIN COMPONENTS ................................................................................................ 64

5.2.1 Heat exchanger................................................................................................... 64 5.2.2 Heater and control systems ............................................................................... 65 5.2.3 Control valve ...................................................................................................... 66 5.2.4 Temperature sensor............................................................................................ 67 5.2.5 Flow sensor ......................................................................................................... 67 5.2.6 Pressure sensor .................................................................................................. 68

VII

5.3 5.4

EXPERIMENTS FOR SENSOR AND ACTUATOR FAULT DETECTION ......................... 69 EXPERIMENTS FOR HEAT EXCHANGER FOULING DETECTION ............................... 72

CHAPTER 6 CONCLUSIONS AND FUTURE WORK ........................................ 74 6.1 6.2 6.3 CONCLUSIONS ......................................................................................................... 74 LIST OF CONTRIBUTIONS......................................................................................... 76 FUTURE WORK ........................................................................................................ 77

6.3.1 Limitations in the current work ......................................................................... 77 6.3.2 Suggestions for future work ............................................................................... 78 REFERENCES ........................................................................................................ 79 APPENDIX .............................................................................................................. 84 PUBLICATIONS................................................................................................... 117

VIII

LIST OF FIGURES

Fig. 1.1 Environmental control system (Moir & Seabridge, 2001) .......................................2 Fig. 1.2 Plate-fin cross-flow heat exchanger core (Incropera & DeWitt, 1996) ..................3 Fig. 1.3 Three control configurations for bleed air temperature control...............................4 Fig. 1.4 Classification of faults ................................................................................................5 Fig. 1.5 Illustration of the concepts of hardware redundancy and analytical redundancy (Hwang et al., 2009) ....................................................................................................7 Fig. 1.6 Classification of FDD methods (Zhang & Jiang, 2008) ..........................................8 Fig. 2.1 Aircraft bleed air temperature control configuration Â­ ram-air-plus-bypass channel control ...........................................................................................................15 Fig. 2.2 Airflow through a ball valve ....................................................................................16 Fig. 2.3 Ram-air-plus-bypass control strategy ......................................................................23 Fig. 2.4 Load temperature response to a 40 Â°F step in Thi under ram air channel control .26 Fig. 2.5 Load temperature response to a 40 Â°F step in Thi under bypass channel control..27 Fig. 2.6 Load temperature response to a 40 Â°F step in Thi under ram-air-plus-bypass channel control ...........................................................................................................28 Fig. 3.1 The principle of the UT (Julier & Uhlmann, 2004)................................................30 Fig. 3.2 Diagram of a fault detection and isolation method ................................................43 Fig. 3.3 Simulation results for detecting load temperature sensor measurement fault which occurs at t=10s: (a) load temperature sensor measurement error detected with UKFS, (b) valve opening bias detected by with UKFA, (c) mean of squared residual x ....................................................................................................................47

IX

Fig. 3.4 Simulation results for detecting bypass valve opening angle fault which occurs at t=10s: (a) load temperature sensor measurement error detected with UKFS, (b) valve opening bias detected by with UKFA, (c) mean of squared residual x .......48 Fig. 3.5 Simulation results for detection ram air valve opening angle fault which occurs at t=10s: (a) load temperature sensor measurement error detected with UKFS, (b) valve opening bias detected by with UKFA, (c) mean of squared residual x .......49 Fig. 3.6 Simulation results for detection bypass valve opening angle fault which occurs at t=10s: (a) load temperature sensor measurement error detected with UKFS, (b) valve opening bias detected by with UKFA, (c) mean of squared residual x .......50 Fig. 3.7 Simulation results for detection ram air valve opening angle fault which occurs at t=10s: (a) load temperature sensor measurement error detected with UKFS, (b) valve opening bias detected by with UKFA, (c) mean of squared residual x .......51 Fig. 4.1 Diagram of heat exchanger fouling detection method ...........................................54 Fig. 4.2 Bleed air temperature drop comparison of clean and fouling conditions .............59 Fig. 4.3 Relationship of bypass valve opening command and pressure drop increment ...60 Fig. 5.1 Bleed air temperature control test rig configuration...............................................61 Fig. 5.2 Picture of the test rig ................................................................................................62 Fig. 5.3 Air to air plate-fin heat exchanger, manufactured by Bell Intercoolers ................64 Fig. 5.4 Air heater control system, manufactured by SYLANVIA .....................................66 Fig. 5.5 Control valve manufactured by BI-TORQ, CARBO-BOND, Inc. .......................66 Fig. 5.6 RTD temperature sensor, supplied by Honeywell ..................................................67 Fig. 5.7 Air velocity transducer, manufactured by OMEGA Inc. .......................................68 Fig. 5.8 Pressure sensors, manufactured by OMEGA Inc.: (a) PX303; (b) PX209 ...........68 Fig. 5.9 Experimental results for detecting measurement fault of load temperature sensor at t=50s: (a) load temperature sensor measurement error detected with UKFS, (b) valve opening bias detected by with UKFA, (c) mean of squared residual x .......70

X

Fig. 5.10 Experimental results for detecting bypass valve opening angle fault which occurs at t=50s: (a) load temperature sensor measurement error detected with UKFS, (b) valve opening bias detected by with UKFA, (c) mean of squared residual x ....................................................................................................................71 Fig. 5.11 Bypass valve opening command deviation for different fouling levels ..............73

XI

LIST OF TABLES

Table 2.1 Initial values and control parameters for ram air channel control ......................25 Table 2.2 Initial values control parameters for bypass channel control ..............................26 Table 2.3 Initial values and control parameters for ram-air-plus-bypass channel control .28 Table 2.4 A comparison of ram air usage for the three control configurations ..................29 Table 3.1 Parameter and initial values for bleed air system ................................................45 Table 4.1 Types of fouling added in heat exchanger ...........................................................57 Table 4.2 Inlet and flow conditions for fouling tests ...........................................................58 Table 4.3 Operating conditions for bypass control configuration .......................................59 Table 5.1 Main components of the test rig ...........................................................................63 Table 5.2 Steady state valve command deviation ................................................................73

XII

NOMENCLATURE

Roman A BR C D E Frec H K KP L Ma N P R Rv T TI V Vb W b etemp f g h m u valve opening area bypass ratio specific heat diameter expectation pressure recovery factor overall heat transfer coefficient parameter of heat exchanger proportional gain of PI -controller dimension of the augmented state vector Mach number heat exchanger deviation pressure gas constant for air variance of measurement noise temperature integral time constant of PI -controller positive definite function covariance of noise mass flow rate; weights for state vector and covariance bias between actual valve opening angle and the value under command temperature error state equation; fault acceleration of gravity output equation mass valve opening command
XIII

v y

measurement noise output

Matrix and vector A B E F G K P Rv S Vb X b e u v vb x y z      () a matrix sigma points corresponding to actuator bias vector a matrix state transition matrix state observation matrix Kalman filter gain covariance of state estimation error covariance of measurement noise vector residual covariance covariance of noise vector sigma points corresponding to state vector actuator bias vector state estimation error vector input vector measurement noise vector noise vector state vector output vector disturbance vector time varying diagonal matrix time varying diagonal matrix output estimation error vector time varying diagonal matrix

XIV

Greek




valve opening angle output estimation error pressure ratio ratio of specific heat parameter in unscented Kalman Filter parameter in unscented Kalman Filter a real number 0 <   1 parameter in unscented Kalman Filter a real number  >0 a real number time constant for temperature sensor time constant for valve a constant that determines the spread of the sigma points a stochastic process

 
  


 v t v   Subscripts bleed bleedbypass bleedmain c ci cin co d h hi hin ho i in

bleed air bypass bleed air main bleed air cold air side cold air side inlet of heat exchanger ram air inlet cold air side outlet of heat exchanger down stream hot air side hot air side inlet of heat exchanger bleed air inlet hot air side outlet of heat exchanger heat exchanger plate row index inlet
XV

j load loadm load_sp ram u v vc

heat exchanger plate column index load measured value at load set-point at load ram air upstream actual valve opening valve opening under command

Superscripts ^ a prediction augmented vector

XVI

CHAPTER 1 INTRODUCTION

1.1

Bleed Air Temperature Control System Bleed air is hot, compressed air taken from an aircraft engine, after the compressor

stage(s) and before the fuel is injected in the burners. This high-pressure, hightemperature engine bleed air is commonly used within the aircraft after cooling in several ways, including de-icing (Yeoman, 1994), pressurizing the cabin (Newman, et al., 1980) and air conditioning for passengers and avionics equipment (Ensign & Gallman, 2006). However, engine bleed air cannot be used directly due to its high temperature, and it must be cooled to the desired temperature, to be utilized appropriately in the cabin or other low temperature areas. The bleed air system is the heart of the environmental control system (ECS), (Hunt et al., 1995). The ECS in today's jetliners is designed to provide a safe and comfortable cabin environment at cruising altitudes that can reach 40,000 feet. At those altitudes, the cabin must be pressurized to enable passengers and crew to breathe normally. By government regulation, the cabin pressure cannot be less, at maximum cruise altitude, than the equivalent of atmospheric pressure at 8,000 feet. In addition to pressurization, the ECS controls air flow, filtration and temperature. Fig. 1.1 shows the ECS of an aircraft. The turbine drives the compressor that is used to increase the air pressure with a corresponding increase in temperature. The bleed air

1

temperature is then reduced in the heat exchanger, cooled by ram air. Reduction in temperature leads to water condensation in the air. A water extractor at the turbine inlet is used to remove most of the free water. A bypass line is used to adjust the turbine outlet temperature to the required value. The volume of air flowing round the bypass is varied by a temperature control valve.

Ram air Air Bleed from engine Temperature control valve Fresh air Cabin air for re-circulation Pressure cabin Auxiliary power unit (APU) Heat exchanger (coolers)

Compressor Discharge valve Swirl Conde nser Overboard Water extractor Turbine expander/cooler HP air from ground

Main air source: APU or engine bleed air

Fig. 1.1 Environmental control system (Moir & Seabridge, 2001)

Ram air is commonly used to cool the engine bleed air, and it is scooped from the aircraft boundary layer or close to it. The external air is forced through a scoop, which faces into the external air flow, through the heat exchanger matrix and then rejected overboard by forward motion of the aircraft.

2

Thermal conditioning of the hot engine bleed air is accomplished by first passing it through a heat exchanger device. The heat energy from the bleed air is transferred to the ram air stream. The heat exchanger presented in this thesis is called compact (crossflow) plate-fin heat exchanger (CPFHE). The compact heat exchangers are commonly used, due to their low weight and space requirement. Their large heat transfer area gives them excellent compactness and heat transfer characteristics (Kays & London, 1964). As shown in Fig. 1.2 the CPFHE is made by the stacking of corrugated sheets (fins) separated by planar sheets and closed on the sides by lateral bars. The gaps between constitute a fluid layer. A core is made of a large number of layers.

Fig. 1.2 Plate-fin cross-flow heat exchanger core (Incropera & DeWitt, 1996)

Fig. 1.3 shows three control configurations of aircraft bleed air temperature control system studied in previous research (Hodal & Liu, 2005; Shang & Liu, 2007; Shang, Liu, & Hodal, 2010), in which the bleed air temperature at the load is regulated by a valve controller. The output of the controller determines the ram air flow rate, or the bleed air

3

main/bypass flow ratio, or a combination of both. Sensors, valve actuators and the heat exchanger are key components in such a control system, and the potential faults associated with them need to be considered in the design of the control system.

ram air channel control (a)

bypass channel control (b)

ram-air-plus-bypass channel control (c) RAV: Ram air valve BPV: Bypass valve Fig. 1.3 Three control configurations for bleed air temperature control

1.2

Faults in Bleed Air Temperature Control System A fault is defined as an unpermitted deviation of at least one characteristic property

or parameter of the system from the acceptable behaviour. The fault is a state that may lead to a malfunction or a failure in the system. Faults can be classified based on several criteria, such as physical locations in the system, time characteristics of faults and the effect of faults on system performance. Fig. 1.4 shows the classification of faults.

4

Faults

Physical locations Actuator Sensor Dynamic changes in transducer Plant

Time characteristic Additive fa
++

Effect of faults Multiplicative fm Xa=X+fa X
+ + a

Gain reduction

Unknown bias

X

Xm=(a+fm)X

Fig. 1.4 Classification of faults

When faults are classified according to their physical locations, three main faults can be defined: actuator faults, sensor faults, and plant component faults. The main source of sensor fault in the bleed air system is the load temperature sensor, which measures the bleed air temperature at the load. Resistance temperature detectors (RTDs) are often used in aircraft to measure the flow temperature. The potential faults associated with RTD are caused by the degraded ability to maintain resistance vs. temperature relationship over time, the lead wire resistance, and contamination of the sensor probe. The faults are represented by fixed or drifting measurement biases. The fixed bias refers that the difference between the measurement and its true value is a constant, while the drifting bias means that the difference is a variable of time. The ram air and bypass valves are driven by valve actuators. Faults in valve actuators include partial or complete loss of control effectiveness, and can be represented by the bias between actual and the fault-free valve opening angle under command. The

5

bias includes not only multiplicative but also additive fault of the actuator (Zhou & Frank, 1996), which can cause change in actuator dynamics and the value of valve opening angle. A plant component fault in the bleed air temperature control system is associated with the heat exchanger. During the life time of heat exchanger, deposit of extraneous materials build up gradually upon the surface of heat exchanger core, which is generally defined as fouling. The accumulation of these unwanted deposits reduces the heat transfer efficiency of the heat exchanger, and causes over heating in the air conditioning system (Wright, et al., 2009). In some situations the fouling layer can effectively restrict the flow through the fins and lead to an increase of the drag coefficient. This will consequently increase the fuel consumption (Ishiymama, et al., 2008; Bott, 2007).

1.3

Fault Detection and Diagnosis Methods Fault detection and diagnosis (FDD) targets on identifying either that something

has gone wrong or that everything is fine in the system; and of determining the location as well as type of the fault (Willsky, 1976). In general, FDD method utilizes the concept of redundancy, which can be either a hardware redundancy (data-based) or analytical redundancy (model-based) as illustrated in Fig. 1.5. The basic concept of hardware redundancy is to compare duplicative signals by various hardware. The analytical

redundancy approach generally does not require additional hardware, it is usually a more cost effective approach compared to the hardware redundancy approach. However, the

6

analytical redundancy approach is more challenging due to the need to ensure its robustness in the presence of model uncertainties, noise, and unknown disturbances.

Fig. 1.5 Illustration of the concepts of hardware redundancy and analytical redundancy (Hwang et al., 2009)

Generally, the analytical redundancy approach can be divided into quantitative model-based methods and qualitative model-based methods. The classification of the existing FDD approaches is shown in Fig. 1.6. A quantitative model-based FDD method utilizes a mathematical model. The techniques commonly used are based on state estimation, parameter estimation, parity space, and combination of the first three. The principle of observer-based approaches is to estimate the system variables with a Luenberger observer for the deterministic case or a Kalman filter for the stochastic case and to use the estimation errors/innovations as residuals. In parity space approaches, residuals are computed as the difference between the measured outputs and estimated outputs and their associated derivatives. The parameter estimation method for FDD is based on the concept that faults typically affect
7

the physical coefficients of the process. By continuously estimating the parameters of a process model, residuals are computed as the parameter estimation errors. The role of residual evaluation is to detect when the residuals have changed sufficiently to make reliable fault detection. Binary decision and statistical decision are often used in residual evaluation. A binary decision is made from a comparison between the residual and a fixed threshold. In the field of statistical decision, a variety of detection techniques are available, such as generalized likelihood ratio test, sequential probability ratio test, and cumulative sum test.

Fig. 1.6 Classification of FDD methods (Zhang & Jiang, 2008)

8

For the model-based fault detection, faults are detected and isolated based on residuals generated by state variables or model parameter estimations. Kalman filter (KF), as a well known optimal state estimator for linear and Gaussian systems, is applied to detect sensor and actuator faults for linear systems with disturbance and measurement noise (Kobayashi & Simon, 2005; Kobayashi & Simon, 2007; Liu, et al., 2004). However, most systems in practice are inherently nonlinear. The extended Kalman filter (EKF) has been developed for nonlinear systems state estimation, and applied to detect faults for nonlinear systems (Yoshida & Iwami, 1996; Del Gobbo, et al., 2001), but unlike KF, the EKF is not an optimal estimator. In addition, if the initial estimate of the state is not near the actual value, or if the process is not modeled properly, the filter may quickly diverge, owing to its linearization of the nonlinear functions. As an alternative to the EKF estimator for nonlinear systems, unscented Kalman filter (UKF) has been proposed by Julier, et al., 1995, Julier & Uhlmann, 1997, and Julier & Uhlmann, 2004. Unlike EKF, which is based on the linearization of nonlinear function by first-order Taylor expansion, UKF uses the true nonlinear models and approximates a Gaussian distribution of the state variable. Furthermore, it is not necessary to compute the Jacobians in the UKF. For these reasons, the UKF is being used to estimate the state of a wide class of nonlinear systems, such as unmanned aerial vehicles (Cork & Walker, 2007; Qi, et al., 2008), satellite attitude determination system (Xiong, et al., 2007; Tidoroiu, et al., 2006), and heating ventilation air conditioning systems (Tidoroiu, et al., 2008). Other estimation tools such as neural networks (Kobayashi & Simon, 2005) and principal component analysis (PCA) (Mukherjee et al., 2005) have also been utilized for
9

FDD with applications to gas turbine engines. The neural networks approach provides an excellent ability for nonlinear estimation, but the time required for training neural networks to fully represent all possibilities can be excessive. PCA may represent an efficient approach when building a mathematical model of system under investigation is difficult, but selection of principal components can be challenging.

1.4

Heat Exchanger Fouling Detection During the life time of heat exchanger, deposit of extraneous materials, such as dirt,

scale, corrosion products or other material appears gradually upon the surface, which is generally defined as fouling and will interfere with heat transfer and/or fluid flow. Fouling is a phenomenon which occurs with or without a temperature gradient in many natural, domestic and industrial processes. 1.4.1 Types of fouling There are several types of fouling, and they are generally classified into the following categories (Epstein,1985). 1. Precipitation fouling Â­ the crystallization from solution of dissolved substances on to the heat transfer surface, sometimes called scaling. Normal soluble salts precipitate on sub-cooled surfaces, while inverse soluble salts precipitate on superheated surfaces. 2. Particulate fouling Â­ the accumulation of finely divided solids suspended in the process fluid onto the heat transfer surface. It includes gravitational settling of large

10

particles as well as deposition of colloidal particles by other mechanisms on to the heat transfer surface. 3. Chemical reaction fouling Â­ deposit formation at the heat transfer surface by chemical reaction in which the surface material itself is not a reactant. 4. Corrosion fouling Â­ the accumulation of indigenous corrosion products on the heat transfer surface.
5. Biological fouling Â­ the attachment of macro-organisms (macro-fouling) and/or

micro-organisms (micro-fouling) to heat transfer surface, along with the adherent slimes generated by the latter. 6. Freezing fouling Â­ the solidification of a pure liquid or constituents of a liquid solution onto a sub-cooled transfer surface. 1.4.2 Effect of fouling in heat exchanger Despite the cause or nature of the deposit, the accumulation of this unwanted deposit can reduce the thermal efficiency of the heat exchanger, which may cause over heating in air conditioning system. In some situations the fouling layer can effectively restrict the flow through the fins, which increases the demand for transport energy . In many cases, the deposit is heavy enough to significantly interfere with fluid flow and increase the pressure drop required to maintain the flow rate through the heat exchanger. Due to the reduced performance caused by fouling of heat exchanger, it may become necessary to remove the heat exchanger for cleaning, which is a time-consuming process. For an aircraft engine system where down-time is costly, condition based
11

maintenance (Rajamain, et al., 2004) is desirable to monitor the fouling level so that cleaning can be done only when necessary. Numerous methods have been developed for the fouling monitoring of heat exchanger. In some applications heat exchanger fouling is detected by observing a health related parameter, which are normally correction factors on the efficiency of the components. (Yoshida & Iwami, 1996; Persin & Tovornik, 2005; Borguet & Lenoard, 2009). The disadvantage of this method is that fouling is not easy to be detected due to the limitation in the mounting of pressure and temperature sensors. Statistical technique (Thomson, et al., 2000) is also used, which requires the collection of large amount of data.

1.5

Organization of Thesis This thesis consists of five chapters that are highlighted in the following: Chapter 2: The nonlinear mathematical model of a bleed air temperature control system is developed. A discrete time system representation of the bleed air system is then derived and used to perform prediction and update of state variables. Also the selection of control configuration is discussed. Chapter 3: An UKF based FDD method is developed to detect both sensor and actuator faults in the bleed air system. The convergence of the

12

proposed UKF has been proved. Simulations of the proposed method are conducted, and the simulation results are presented in this chapter. Chapter 4: A valve control command based heat exchanger fouling detection method is developed. The effects of fouling in the heat exchanger of the bleed air system are investigated and presented in this chapter. Chapter 5: An experimental setup for investigating the effectiveness of the proposed methods is described in this chapter, and the experimental results of sensor and actuator fault detection and heat exchanger fouling detection are presented, along with comments on the experimental results. Chapter 6: Conclusions of the thesis work and potential future research topics are provided.

13

CHAPTER 2 MODELING OF BLEED AIR SYSTEM

2.1

System Configuration and Modeling Assumption The aircraft bleed air temperature control system is shown in Fig.2.1. The mass

flow rate of the high temperature air from the engine is Wbleed (lb/s); the temperature is Thi (Â°F), and the pressure is Phin (psi). Most of the hot air is cooled through the hot side of the heat exchanger at a flow rate Wbleedmain (lb/s), while a small portion of the overall bleed flow is made to bypass the heat exchanger via the bypass channel at a flow rate of Wbleedbypass (lb/s), to be mixed downstream with the main bleed air flow coming out from the heat exchanger. Ram air is taken from the atmosphere at a mass flow rate Wram (lb/s). The inlet pressure Pcin (psi) and temperature Tcin ( Â°F) are determined from the ambient temperature Tamb (Â°F) and the ambient pressure Pamb (psi) (Hodal & Liu, 2005):

Tcin = (Tamb + 460)(1 + 0.2Ma 2 ) - 460
Pcin = Frec ( Pamb (1 + 0.2 Ma 2 ) 3.5 - Pamb ) + Pamb

(2.1)

(2.2)

where Frec is the pressure recovery factor, and Ma is Mach number. A control valve is placed in the ram air channel as well as in the bypass channel, and the ram air flow and the bypass flow are controlled to regulate the bleed air temperature at the load downstream. Assumptions are made as follows (Hodal & Liu, 2005):
14

a) transport delay between components is negligible; b) there is no heat loss to the surrounding environment through the pipes; and c) pressure loss due to pipe flow is negligible; and the flow is assumed to be fully developed.

Ram air

Tamb Pamb Ram air valve (RAV) Tci Pci Tho Pho Tco Pco Bypass valve (BPV) Tload Pload Load

Tcin Pcin Wram Bleed air Engine Thi, Phin Wbleed Thi, Phi Wbleedmain Wbleedbypass

Heat exchanger

Tamb Pamb

Fig. 2.1 Aircraft bleed air temperature control configuration Â­ ram-air-plus-bypass channel control

2.2 2.2.1

Nonlinear Model of an Engine Bleed Air System Control valve and flow rate Control valves are placed at ram air channel and bypass channel to regulate the

temperature at load. Ball valves are used to manipulate the flow rate by changing the opening angle v (rad), and thus the opening area Av (inch2). Fig. 2.2 shows airflow passing through a ball valve. Valve opening angles v=0 rad and v = /2 rad correspond to full-close and full-opening, respectively.

15

Dv

Fig. 2.2 Airflow through a ball valve

Neglecting valve hysteresis and backlash, the valve dynamics are modeled as a first-order lag.
2/  vs +1

 vc ( s ) = u v ( s )

(2.3)

where uv is the opening-command input to the valve (0%-100%), vc (rad) is the valve opening angle under command in radian and v is the valve time constant in second . The actuator fault is modeled as an equivalent bias b (rad), and

 v =  vc + b
For a valve with a diameter Dv, the valve opening area is

(2.4)

Av =

D 2
4

(1 - cos  v )

(2.5)

The mass flow rate Wv is calculated using an equation for isentropic expansion process for variable area duct flow

16

Wv =

Av Pu 2g [ ( 2 /  -  (1+  ) /  )]1 / 2 Tu ( - 1) R

(2.6)

where
Pd P P for d  0.5283,  = 0.5283 for d < 0.5283 , Pu Pu Pu

=

in which Pu and Pd are the pressures upstream and downstream of the valve, respectively; g = 32.174 ft/s2 is the acceleration of gravity, R = 1717 ft2/ (s2Â°R) is the gas constant for air, and  = 1.4 (for air) is the ratio of specific heat capacity at constant pressure to specific heat capacity at constant volume. Similarly for the ram air channel, Equations (2.3) to (2.6) hold with Wv = Wram, Pu = Pcin, Pd = Pci, Tu = Tci,, Dv = Dram, v = ram, v = ram, and uv = uram; and for the bypass channel: Wv = Wbleedbypass, Pu = Phin , Pd = Pload (load pressure), Tu = Thi, D v =Dram, v = bypass, v = bypass, and uv = ubypass. 2.2.2 Pressure calculation When air flows through the heat exchanger, the pressure drop caused by heat exchanger is a function of flow rate. The bleed air and ram air side heat exchanger pressure drops are given as follows:
2 + K 2Wbleedmain Pdroph = Phi - Pho = K1Wbleedmain

(2.7)

2 Pdropc = Pci - Pco = K 3Wram + K 4Wram

(2.8)

17

where Phi (psi) and Pci (psi) are the hot and cold side pressures upstream of the heat exchanger, and Pho (psi) and Pco (psi) are hot and cold side pressures downstream of the heat exchanger, respectively. The constants K1, K2, K3 , and K4 come from empirical data of an industrial heat exchanger 1. The pressure at load is:

Pload = K load Wbleed 2 + Pamb
where Kload is the load impedance constant.

(2.9)

As a result of neglecting the pressure drop due to the pipe flow, some equivalency statements can be drawn between the pressures at multiple positions of the system: Â· the heat exchanger hot-side inlet pressure is equal to the bleed-air pressure leaving the source, Phi  Phin ; Â·

the pressure at the hot-side heat exchanger outlet is equivalent to the pressure upstream of the load, Pho  Pload;

Â·

since ram air is dumped directly into the atmosphere, pressure at the cold-side heat exchanger outlet is equivalent to ambient pressure, Pco  Pamb.

1

The author is bound by a confidentiality agreement not to release the exact values of these parameters

18

2.2.3

Temperature calculation The cold air side inlet temperature of heat exchanger is the downstream temperature

of the ram air valve, which can be calculated using an equation for isentropic flow:
 -1 

 Pci Tci = Tcin  P    cin 

(2.10)

The temperature in Equation (2.10) is in Rankine. The load temperature is a mixture of bypass flow and cooled main bleed flow, and is determined as:

Tload =

ThoWbleedmain + ThiWbleedbypass Wbleed

(2.11)

The load temperature is measured by a thermal temperature sensor, which is associated with possible faults and measurement noise. The sensor dynamics is modeled as a simple first-order transfer function:
Tload ( s ) t s +1

Tloadm ( s ) =

(2.12)

where Tloadm ( Â°F) is the reading from a fault free load temperature sensor and t is the time constant of the sensor.

19

2.2.4

Heat exchanger dynamics The thermal dynamics of the heat exchanger are described by the following

equations (Erickson & Hedrick, 1999):

 =W T ho bleedmain (Thi - Tho ) / mh - H h (Tho - Tco ) /( mh C h )  = W (T - T ) / m - H (T - T ) /( m C ) T co ram ci co c c co ho c c

(2.13)

(2.14)

where the hot side fluid (bleed air) with a specific heat of Ch (Btu/lbÂ°R) and mass mh (lb) flows at a flow rate Wbleedmain, and with the inlet temperature of Thi and outlet temperature of Tho. The cold side fluid (ram air) with a specific heat of Cc and mass mc flows at a flow rate Wram, with inlet and outlet temperatures Tci and Tco, respectively. Hh and H c

(Btu/sÂ°R) denote the overall heat transfer coefficient of hot and cold side, respectively. The heat transfer coefficient is normally a function of surface geometry (which influences conditions in the boundary layer), nature of the fluid motion, and an assortment of fluid thermodynamic and transport properties (Incropera & DeWitt, 1996; Kays & London, 1964 ). For this study, the overall heat transfer coefficients are given as functions of flow rate,

H h = f (Wbleedmain ) H c = f (Wram )

(2.15)

(2.16)

20

These specific functions are determined empirically from experimental data on an existing heat exchanger used in the industry 2. 2.3 Discrete Time System Model The discrete time system representation of the bleed air system has the following equations: Mass flow rate
1

Wv ( k )

Pd ( k ) 2 (1+ )  2 Av ( k ) Pu ( k )  2g  = , = ( - )     ( k ) k k ( ) ( )   Pu ( k ) Tu ( k )  ( - 1) R 

(2.17)

Valve opening angle

 v ( k +1) =

-  v(k ) +


2

u v ( k +1)

v

t +  v ( k )

(2.18)

Valve opening area

Av ( k ) =

Dv2
4

(1 - cos  v ( k ) )

(2.19)

Load temperature
Tho ( k )Wbleedmain ( k ) + Thi ( k )Wbleedbypass ( k ) Wbleed ( k )

Tload ( k ) =

(2.20)

The discrete time state space system model is expressed in the following form:
2 The author is bound by a confidentiality agreement not to release any specific details regarding this particular heat exchanger, and the exact form of empirical relations describing it

21

x ( k +1) = f (x ( k ) , u ( k ) , b ( k ) , z ( k ) )

(2.21)

and the measured output equation is
y ( k +1) = h(x ( k +1) , u ( k +1) , b ( k +1) , z ( k +1) ) + v ( k +1)

(2.22)

where x = [ Tho Tco] T = [x1 x2] T represents the state vector, u = [ubypass uram]T represents the input vector, b = [bbypass bram]T represents the actuator bias vector, y = [ Tho Tco Tloadm] T = [x1 x2 y3]T represents the output vector, and z = [ Wbleed Thi Tci Phin Pload Pcin Pci] T represents the disturbance vector, v is the measurement noise and is assumed to be Gaussian white noise with variance Rv, and f and h represent the discrete nonlinear equations. These nonlinear discrete-time equations will be used as prediction and update functions in proposed state estimator, and are assumed to be continuously differentiable.

2.4

Ram-air-plus-bypass Control Strategy The key in the control system design for the proposed ram-air-plus-bypass channel

configuration is to properly control the bypass channel such that both fast temperature response and reduction of ram air usage are achieved. To reach this goal, a small bypass valve opening is selected as a set-point, which is to be maintained at steady state. Upon system transient and disturbances, the bypass valve opening is controlled to provide a fast response in regulating the load temperature. However, since a reduction in ram air usage is sought along with fast transient, it is desired to have a low bypass flow rate. By setting the bypass valve set-point to a value that will result in a fairly low (e.g., 10 %) bypass ratio (bypass flow rate to total bleed flow rate), it is ensured that the system is not
22

overcooled to a large extent, which results in unnecessary ram air usage and associated fuel consumption.

Fig. 2.3 Ram-air-plus-bypass control strategy

In the proposed control system architecture as shown in Fig. 2.3, the bypass channel valve opening ratio ubypass and ram air valve opening ratio uram are treated as control inputs. The bypass channel valve will strive to bring about fast temperature regulation, while the ram air channel valve loop will act to let the bypass channel valve return to its pre-defined set-point. This control strategy can be implemented using conventional PI control with two control loops. The bypass channel loop regulates the load temperature with the following PI control law:  K P bypass  etemp ( s ) ubypass ( s ) =  K P bypass +   T s I bypass  

(2.23)

where etemp is the temperature error defined as the difference between the load temperature Tload and its set-point Tload_sp; KPbypass and TIbypass are the regular controller proportional gain and integral time constant, respectively.

23

The ram air channel loop is driven by the bypass-valve opening error ebypass, defined as the difference between the bypass valve opening and its pre-defined set-point, and the control law is given by

  K u ram ( s ) =  K P ram + P ram ebypass ( s )  TI ram s   

(2.24)

where KPram and TIram are the regular controller proportional gain and integral time constant, respectively. The ram-air controller action is indirect in nature and requires that the bypass control loop is closed; in this way, it forms the outer control loop, with the bypass controller being the inner control loop.

2.5

Simulation Results Using the dynamic equations and control laws derived in the above sections,

simulation studies have been conducted for all three control configurations shown in Fig. 1.3. Disturbances arising from changes in engine loading and/or atmospheric conditions are considered. The simulation results for a 40 Â°F step increase in bleed air temperature Thi are presented here. Unless specified otherwise, the following simulations use a temperature set-point of Tload_sp = 190 Â°F, pipe diameter D = 1.5 inch, and valve time constant v = 1.5 s for the ram and bypass channels. The simulation time step is typically 0.1 s.

24

2.5.1

Ram air channel control PI control is applied for the simulation of ram air channel control configuration

shown in Fig. 1.3(a). The output of the ram air control, equivalent to the input to the valve, is given by the PI control law

 K P ram  etemp ( s ) u ram ( s ) = - K + P ram   T s I ram  

(2.25)

where KPram and TIram are the PI-controller proportional gain and integral time constant, respectively. The operating conditions in terms of temperatures, pressures, and flow rates, along with the tuned PI-control parameters for the ram-air controller, are listed in Table 2.1.
Table 2.1 Initial values and control parameters for ram air channel control

KPram=0.2 Wram=0.0172 lb/s Phin= 45.11 psi

TIram=100 s Thi=380 Â°F Pamb= 10.11psi

Wbleed=0.0183 lb/s Tci=117.5 Â°F

To maintain the load temperature at a set-point, an increase in ram air flow rate is necessary to counteract the increased thermal energy carried by the bleed air. According to the simulation results, from the initial steady state value of Wram=0.0172 lb/s, the ram airflow rate increases to Wram = 0.0192 lb/s for a 40 Â°F increase in bleed temperature. As expected, the response time of this control scheme is rather large, as shown in Fig. 2.4, due to the sluggish heat exchanger dynamics.

25

This control scheme does have one major advantage: it does not waste any ram air. At steady state, the amount of ram air used is the lowest necessary value required for regulation; in other words, no overcooling of the heat exchanger hot-side stream takes place, unlike for cases with a hot-side bypass.
194

Load temperature (Â°F)

193 192 191 190 189 0 100 200 300 400 500 600 700

Time (sec) Fig. 2.4 Load temperature response to a 40 Â°F step in Thi under ram air channel control

2.5.2

Bypass channel control For simulation of the bypass channel control configuration shown in Fig. 1.3(b), the

same temperature error etemp signal drives the bypass controller, with a PI control law identical to Equation (2.23). The operating conditions along with the PI-control parameters are listed in Table 2.2.
Table 2.2 Initial values control parameters for bypass channel control

KPbypass=5 Wram=0.273 lb/s Thi=380 Â°F Pamb= 10.11psi

TIbypass=25 s Wbleedmain =0.0133 lb/s Wbleedbypass=0.005 lb/s

Wbleed=0.0183 lb/s Tci=117.5 Â°F Phin= 45.11 psi

26

An increase in bleed air inlet temperature will cause the heat exchanger hot-side outlet temperature Tho to rise, and consequently a reduction in the bypass flow rate is required to restore the load temperature to its set-point. An important characteristic of this control scheme is its short response time, as confirmed by the load temperature response shown in Fig. 2.5. Disturbances in bleed air are also immediately felt, as indicated by the quite abrupt change in load temperature.
202 200

Load temperature (Â°F)

198 196 194 192 190 188 0 5 10 15 20

Time (sec) Fig. 2.5 Load temperature response to a 40 Â°F step in Thi under bypass channel control

Without a control valve in the ram air channel, the ram air flow rate in this configuration is dictated by the heat exchanger cold-side pressure drop and is a function of the operating conditions (i.e., airspeed and atmospheric pressure). For this simulation, the ram airflow rate is constant at Wram=0.273 lb/s. Note that this value is much larger than that in the ram air channel control case.

27

2.5.3

Ram-air-plus-bypass channel control For the proposed ram-air-plus-bypass channel control, the bypass valve opening is

assumed to be at the desired set-point at initial, such that the ratio of bypass to total bleed flow is low (10%). The corresponding steady-state values are listed in Table 2.3.

Table 2.3 Initial values and control parameters for ram-air-plus-bypass channel control

KPbypass=6 TIram=30 sec Wbleedmain = 0.0165 lb/s Wbleedbypass=0.0018 lb/s

TIbypass=15 sec Wbleed=0.0183 lb/s Wram= 0.0198 lb/s Tci=117.5 Â°F

KPram=2 Phin= 45.11 psi Thi=380 Â°F

By modulating both ram air and bypass channel flow rates, this control strategy is able to deliver efficient load temperature response while lowering the ram air usage penalty that is generally associated configurations employing a bleed air bypass. The simulation results shown in Fig. 2.6 below agree with this hypothesis.

Load temperature (Â°F)

Time (sec) Fig. 2.6 Load temperature response to a 40 Â°F step in Thi under ram-air-plus-bypass channel control

28

In the initial stages, actions of the bypass control valve quickly reduce the temperature error, with the remaining error slowly diminishing with time. The small variations in load temperature, made more visible in the inset plot of Fig. 2.6, are due to the slower-acting ram air channel controller modulating the ram air flow rate in order to slowly bring back the bypass valve opening to its set-point. In terms of ram air usage, this configuration fares much better than the bypass channel control configuration. Only a slight increase in ram airflow rate, from the initial value of Wram= 0.0198 lb/s to a new value of Wram= 0.0233 lb/s, when a 40 Â°F increase in bleed air temperature is simulated. For comparison purposes, ram air usage for the three control configurations analyzed here are listed in Table 2.4 below, in terms of initial and final steady-state values of ram air flow rate. For the bypass channl control configuration, since the ram air flow rate is constant, the intial and final value is the same in Table 2.4.

Table 2.4 A comparison of ram air usage for the three control configurations

Initial Control configurations (steady-state) Ram air channel control Bypass channel control Ram-air-plus-bypass channel control (PI) 0.017 lb/s 0.27 lb/s 0.02 lb/s

Final (steady-state) 0.02 lb/s 0.27 lb/s 0.023 lb/s

29

CHAPTER 3 SENSOR AND ACTUATOR FAULT DETECTION AND ISOLATION

3.1 Unscented Kalman Filter Algorithm
UKF uses a deterministic sampling technique known as the unscented transform (UT) to pick a minimal set of sample points (sigma points) around the mean. The approach is illustrated in Fig. 3.1. The nonlinear function is applied to each point, in turn, to yield a cloud of transformed points. The statistics of the transformed points can then be calculated to form an estimate of the nonlinearly transformed mean and covariance. The sigma points are deterministically chosen so that they exhibit certain specific properties (e.g., have a given mean and covariance). As a result, high-order information about the distribution can be captured with a fixed, small number of points.

Fig. 3.1 The principle of the UT (Julier & Uhlmann, 2004)

30

Consider the nonlinear system represented by (2.21) and (2.22). The considered actuator fault b is used to augment the state vector x, which are together predicted by UKF. Since the prediction of the state vector x has the same procedure as the prediction of the augmented state vector, only prediction of the augmented state vector is presented in this section. The augmented state vector is,
x a ( k ) = [ x ( k )T

b ( k )T ]T

(3.1)

and a estimation of the augmented state vector is
^ a ( k ) = [x ^ a ( k )T x

^ T ]T b (k )

(3.2)

The actuator fault b is unknown and time varying, and the change of the actuator fault is modeled as a Gaussian white noise  with covariance Vb, which allows the UKF to the model for the estimator becomes

estimate b (Simon, 2006). The system noise is neglected in the estimation model. Hence

^ ,u , z ) ^ ( k +1) = f (x ^ (k ) , b x (k ) (k ) (k )

(3.3 a)

^ +v b ( k +1) = b b(k ) (k )

(3.3 b)

The prediction error covariance is

^ a ( k ) )(x a ( k ) - x ^ a ( k ) )T ] P a ( k ) = E[(x a ( k ) - x

(3.4)

31

A set of 2L+1 sigma points is derived from the augmented state vector xa and covariance   , where L = 4 for the bleed air system, is the dimension of the augmented

state vector.

^ a (k ) , i = 0 Xia ( k ) = x
/2 ^ a ( k ) + [ LP a ( k ) ]1 Xia ( k ) = x i , i = 1,  , L /2 ^ a ( k ) - [ LP a ( k ) ]1 Xia ( k ) = x i , i = L + 1,  ,2 L.

(3.5)

^ a ( k ) and is where the constant  determines the spread of the sigma points around x

usually set to small values, 0.0001    1. The sigma points can be broken into the state vector and actuator bias components by
X a ( k ) = [ X ( k )T

B ( k )T ]T

(3.6)

where X(k) and B(k) represent the set of sigma points corresponding to the state vector and actuator bias vector, respectively. The prediction step is performed by propagating each column of the augmented sigma points matrix  () through the nonlinear function (3.3) and obtain the transformed sigma points matrix  (+1|)

X ( k +1 k ) = f ( X ( k ) , B ( k ) , u ( k ) , z ( k ) )

(3.7 a)

B ( k +1 k ) = B ( k ) + Vb

(3.7 b)

32

The predicted augmented state vector and covariance are given by

^ a ( k +1 k ) =  Wi s X a ( k +1 k ) x
i =0

2L

(3.8)

^ a ( k +1 k ) ]  [ X a i ( k +1 k ) - x ^ a ( k +1 k ) ]T P a ( k +1 k ) =  Wi c [ X a i ( k +1 k ) - x
i =0

2L

(3.9)

where the weights for the state vector and covariance are

W0s =  /( L +  ) W0c =  /( L +  ) + (1 -  2 +  ) Wi s = Wi c = 0.5( L +  )
 =  2 (L +  ) - L

(3.10)

(3.11)

(3.12)

(3.13)

where  is used to incorporate prior knowledge of the distribution of the state vector, and  = 2 is optimal for Gaussian distributions, and  is always set to 0 for state estimation (Van der Merwe & Wan, 2001). The transformed sigma points are projected through the output function (2.22) to yield

Y( k +1 k ) = h( X a ( k +1 k ) , u ( k +1) , z ( k +1) )

(3.14)

And the predicted output is given by

33

^ ( k +1 k ) =  Wi s Yi ( k +1 k ) y
i =0

2L

(3.15)

The state estimates and covariance are updated using the classical Kalman filter
^ a ( k +1) = x ^ a ( k +1 k ) + K a ( k +1) [y ( k +1) - y ^ ( k +1 k ) ] x

(3.16)

P a ( k +1) = P a ( k +1|k ) - K a ( k +1) Py ( k +1) [K a ( k +1) ]T

(3.17)

where
2L

^ ( k +1 k ) ]  [Yi ( k +1 k ) - y ^ ( k +1 k ) ]T + Rv Py ( k +1) =  Wi c [Yi ( k +1 k ) - y
i =0

(3.18)

and   is the Kalman filter gain, which is obtained by
-1 K a ( k +1) = Px a y ( k +1) Py ( k +1)

(3.19)

where
2L

^ a ( k +1 k ) ][Yi ( k +1 k ) - y ^ ( k +1 k ) ]T Px a y ( k +1) =  Wi c [ Xia ( k +1|k ) - x
i =0

(3.20)

3.2 Convergence Analysis
The convergence of the proposed UKF that has been derived for the bleed air system is analyzed in this section. Define the estimating error and prediction error of state vector
34

a a ^( e x a ( k +1) = x ( k +1) - x k +1)

(3.21)

a a ^( e x a ( k +1 k ) = x ( k +1) - x k +1 k )

(3.22)

Substituting (3.16) and (3.21) into (3.22) yields
a ^ a ( k +1 k ) - K ( ^ ( k +1 k ) ) = x a ( k +1) - x k +1) ( y ( k +1) - y

e xa

( k +1)

(3.23)

From (3.19), the Kalman filter gain

Pxy ( k +1)  -1 K x ( k +1)  K a ( k +1) = Px a y ( k +1) Py-(1k +1) =  Py ( k +1) =    Pby ( k +1)  K b ( k +1) 

(3.24)

where Pxy is the covariance of state vector x and output vector y, and Pby is the covariance of actuator bias vector b and output vector y. Equation (3.23) can be rewritten as

^ ( k +1 k )  K x ( k +1)   x ( k +1) - x ^ ( k +1 k )  e x ( k +1)   x ( k +1)   x = - -   e    b K  y ^ ^ 3( k +1 k )   3( k +1) - y   b ( k +1)  b ( k +1)     ( k +1 k )    b ( k +1)  
For the system under study, K x ( k +1) can be derived as K x ( k +1) = [ I

(3.25)

0] , and the

derivation is given in the following. Pxy and Py in Equation (3.24) can be expanded as

^1    x1 - x ^ )(y - y ^ )T ] = E   ^1 Pxy = E[(x - x [x1 - x  ^   x x -  2 2   Px1x1 =   Px2 x1 Px1x2 Px2 x2 Px1 y3   Px2 y3  

^2 x2 - x

 ^ 3 ] y3 - y  
(3.26)

35

^1    x1 - x   ^ )(y - y ^ )T ] = E   x2 - x ^2 [x1 - x ^1 Py = E[(y - y    ^3     y3 - y  Px x  11 =  Px2 x1  P  y3 x1 Px1x2 Px2 x2 Py3 x2 Px1 y3   Px2 y3   Py3 y3  

^2 x2 - x

  ^ 3 ] y3 - y   
(3.27)

The inverse of Py is

-1 Py

=

* Py

Py

(3.28)

where
Py = Px1x1 Px2 x2 Py3 y3 + Px2 x1 Py3 x2 Px1 y3 + Py3 x1 Px1x2 Px2 y3 - Px1x1 Px2 y3 Py3 x2 - Px1x2 Px2 x1 Py3 y3 - Px1 y3 Px2 x2 Py3 x1

(3.29)

 Px x Py y - Px y Py x Px y Py x - Px x Py y 2 3 3 2 2 3 3 1 2 1 3 3  22 33 * Py =  Px1 y3 Py3 x2 - Px1x2 Py3 y3 Px1x1 Py3 y3 - Px1 y3 Py3 x1   P P - Px1 y3 Px2 x2 Px1 y3 Px2 x1 - Px1x1 Px2 y3   x1x2 x2 y3

Px2 x1 Py3 x2 - Px2 x2 Py3 x1   Px1x2 Py3 x1 - Px1x1 Py3 x2    Px1x1 Px2 x2 - Px1x2 Px2 x1  

(3.30)

Substituting Equations (3.26), (3.29) and (3.30) into

-1 K x = Pxy Py =

1 * Pxy Py Py

(3.31)

yields
36

(column1) Kx = 1 Py  Px1x1 ( Px2 x2 Py3 y3 - Px2 y3 Py3 x2 ) - Px1x2 ( Px1x2 Py3 y3 - Px1 y3 Py3 x2 ) + Px1 y3 ( Px1x2 Px2 y3 - Px1 y3 Px2 x2 )    Px2 x1 ( Px2 x2 Py3 y3 - Px2 y3 Py3 x2 ) - Px2 x2 ( Px1x2 Py3 y3 - Px1 y3 Py3 x2 ) + Px2 y3 ( Px1x2 Px2 y3 - Px1 y3 Px2 x2 ) (column 2) - Px1x1 ( Px2 x1 Py3 y3 - Px2 y3 Py3 x1 ) + Px1x2 ( Px1x1 Py3 y3 - Px1 y3 Py3 x1 ) - Px1 y3 ( Px1x1 Px2 y3 - Px1 y3 Px2 x1 ) - Px2 x1 ( Px2 x1 Py3 y3 - Px2 y3 Py3 x1 ) + Px2 x2 ( Px1x1 Py3 y3 - Px1 y3 Py3 x1 ) - Px2 y3 ( Px1x1 Px2 y3 - Px1 y3 Px2 x1 ) (column3) Px1x1 ( Px2 x1 Py3 x2 - Px2 x2 Py3 x1 ) - Px1x2 ( Px1x1 Py3 x2 - Px1x2 Py3 x1 ) + Px1 y3 ( Px1x1 Px2 x2 - Px1x2 Px2 x1 ) Px2 x1 ( Px2 x1 Py3 x2 - Px2 x2 Py3 x1 ) - Px2 x2 ( Px1x1 Py3 x2 - Px1x2 Py3 x1 ) + Px2 y3 ( Px1x1 Px2 x2 - Px1x2 Px2 x1 ) =  1  Py Py  0  0 Py 0  = [I 0  0]

Hence the estimation error e x ( k +1) in Equation (3.25) is equal to zero, and only the estimation error of actuator bias needs to be considered. The convergence analysis is based on the following lemma (Agniel & Jury, 1971; Tarn & Rasis, 1976): Lemma 1: Assume that k and V(k) are a stochastic process and there exist real numbers v min, v max >0,  >0 and such that ,

vmin ||  k ||2  V ( k )  vmax ||  k ||2
and

(3.32)

E[V ( k +1 ) |  k ] - V ( k )  Âµ - V ( k )

(3.33)

are fulfilled. Then the stochastic process k is said to be asymptotically stable in mean square and exponentially bounded as
37

E{||  k +1 || 2 } 

v max Âµ k i E{||  0 || 2 }(1 -  ) k +1 +  (1 -  ) v min v min i =1

(3.34)

Define
T V (eb ( k +1) ) = eb ( k +1) (PT P ) -1 eb ( k +1)

(3.35)

2 2 and assuming min       max  . Then
2 2 || eb ( k +1) ||2 / pmax  V (eb ( k +1) ) || eb ( k +1) ||2 / pmin

(3.36)

From (3.25)
-1 T T ^ ^ V (eb ( k +1) ) = [eb ( k +1|k ) - K b ( k +1)  ( k +1|k ) ]  ( P P ) [e b ( k +1|k ) - K b ( k +1)  ( k +1|k ) ]

(3.37)

where

^ eb ( k +1 k ) = b ( k +1) - b ( k +1 k ) = e b ( k ) + b ( k )

(3.38)

in which () with covariance B is the difference between the real change of actuator fault and its predicted value, and

^ ( k +1 k )  e x ( k +1 k )   x ( k +1) - x =   ( k +1 k ) =  ^ 3( k +1 k )   3( k +1 k )   y3( k +1) - y    

(3.39)

38

varying diagonal matrix (k) to take the high order terms into account(Xiong, et al., 2006),

Expanding e x ( k +1 k ) by Taylor series about   () , and introducing an unknown time

e x ( k +1 k ) can be written as

T e x ( k +1 k ) =  ( k ) [Fx ^ ( k ) ][e x ( k ) e b ( k ) ] ^ ( k ) Fb

(3.40)

where   () = rewritten as



 =  ()



and   () =



 ()  =



. Since ex(k) = 0, Equation (3.40) can be

e x ( k +1 k ) =  ( k ) Fb ^ ( k )eb ( k )

(3.41)

By the same way

 3( k +1 k ) = ( ( k )G x ^ ( k ) +  ( k )G b ^ ( k ) )e b ( k ) +  ( k ) G b ^ ( k )b ( k ) + v( k ) ^ ( k )  ( k ) Fb
3 3

(3.42)

where   () =

diagonal matrix.

 =  ()



,    () =

 ()  =



, and () is an unknown time varying

For simplicity, define
T T A x ( k ) = [ I  ( k )G x ^ ( k ) ] ,  ( k ) =  ( k ) Fb ^ ( k ) ] , A b ( k ) = [0  ( k ) G b ^(k ) ,

and A ( k ) = A x ( k ) E ( k ) + A b ( k ) .

Equation (3.39) can be rewritten as

39

 ( k +1|k ) = A ( k )eb ( k ) + A b ( k )b ( k ) + v ( k )

(3.43)

Inserting (3.38) and (3.43) into (3.37) leads to

V (eb ( k +1) ) = [eb ( k ) + b ( k ) ]T (PT P) -1[eb ( k ) + b ( k ) ] - [eb ( k ) + b ( k ) ]T (PT P) -1 K b ( k +1) [ A ( k )eb ( k ) + A b ( k )b ( k ) + v ( k ) ] - [K b ( k +1) ( A ( k )eb ( k ) + A b ( k )b ( k ) + v ( k ) )]T (PT P) -1[eb ( k ) + b ( k ) ] + [K b ( k +1) ( A ( k )eb ( k ) + A b ( k )b ( k ) + v ( k ) )]T (PT P) -1  [K b ( k +1) ( A ( k )eb ( k ) + A b ( k )b ( k ) + v ( k ) )]
Taking the conditional expectation yields
E[V (eb ( k +1) ) | eb ( k ) ]  eb ( k )T (PT P) -1 eb ( k )
T - ( A ( k )eb ( k ) )T K b ( k +1) (PT P) -1 K b ( k +1) A ( k )eb ( k ) T + E{b ( k ) (PT P) -1b ( k ) + [ A b ( k )b ( k ) ]T T  K b ( k +1) (PT P) -1 K b ( k +1) A b ( k )b ( k ) T T + v ( k ) K b ( k +1) (PT P) -1 K b ( k +1) v ( k ) | eb ( k ) }

(3.44)

(3.45)

Since  (( ) ) = ( )  (  )-1 ( ), Equation (3.45) can be rewritten as
E[V (eb ( k +1) ) | eb ( k ) ] - V (eb ( k ) )  -( A ( k )eb ( k ) )T (K b ( k +1) )T (PT P ) -1 K b ( k +1) A ( k )eb ( k ) + E{(b ( k ) )T (PT P ) -1b ( k ) + [ A b ( k )b ( k ) ]T (K b ( k +1) )T (PT P) -1 K b ( k +1) A b ( k )b ( k )
-1 T + ( v ( k ) )T K T b ( k +1) ( P P ) K b ( k +1) v ( k ) | e b ( k ) }

(3.46)

From (3.24)
40

-1 K b ( k +1) = Pby ( k +1) Py ( k +1)

(3.47)

where

Pby ( k +1|k ) = Pbb ( k ) (  ( k ) A ( k ) )T

(3.48)

(Py ( k +1|k ) ) -1 = ( A ( k ) Pbb ( k ) A ( k )T + A b ( k ) B( k ) A b ( k )T + R v ( k ) ) -1 < ( A ( k ) Pbb ( k ) A ( k )T ) -1
in which   () is an unknown time varying diagonal matrix. Take  as
-1 T  = [ A ( k )eb ( k ) ]T K T b ( k +1) ( P P ) K b ( k +1) A ( k ) e b ( k ) / V (e b ( k ) )

(3.49)

(3.50)

Notice that  is always greater than zero. Inserting (3.47)-(3.49) into (3.50) yields

 < [eb ( k ) A ( k ) ]T {Pbb ( k ) [  ( k ) A ( k ) ]T [ A ( k ) Pbb ( k ) A ( k )T ]-1}T (PT P) -1
 [Pbb ( k ) [  ( k ) A ( k ) ]T [ A ( k ) Pbb ( k ) A ( k )T ]-1 ]A ( k )eb ( k ) / V (eb ( k ) ) = eb ( k )T A ( k )T [ A ( k ) Pbb ( k )T A ( k )T ]-1  ( k ) A ( k ) Pbb ( k )T (PT P) -1  Pbb ( k ) [  ( k ) A ( k ) ]T [ A ( k ) Pbb ( k ) A ( k )T ]-1 A ( k )eb ( k ) / V (eb ( k ) )
(3.51)

Assuming that

41

T T 2 2 2 amin I  A ( k ) A ( k )  amax I , pbb (min) I  Pbb ( k )  pbb (max) I , and rmin I   ( k )  ( k ) and
2 rmin  1 , we have

4 2 2 4 2 -1 2   a min rmin pbb 1 (min) [ a max p bb (max) p max ]

(3.52)

The assumption is valid if the operating conditions for the bleed air system, e.g. temperature, pressure and mass flow rate, for the bleed air system is upper and lower bounded. Setting

Âµ = E{b ( k )T (PT P) -1b ( k ) + [ A b ( k )b ( k ) ]T K b ( k +1)T (PT P) -1 K b ( k +1) A b ( k )b ( k )
+ ( v (k ) )
T T -1 KT b ( k +1) ( P P ) K b ( k +1) v ( k )

(3.53)
| eb ( k ) }

Notice that Âµ>0. Therefore, Lemma 1 can be applied to (3.46), (3.52) and (3.53). Based on Lemma 1, the UKF derived for the bleed air system is proved to be stable, because the inequalities (3.33) and (3.34) are fulfilled to guarantee that the estimation error eb(k+1) is bounded. Lemma 1 does not necessarily imply that E{||eb (k+1)||2} decreases for all k. Only the bound decreases exponentially. And as k, the mean square of the process is bounded by
2 pmax E{|| eb ( 0) ||2 }(1 -  ) k +1 2 pmin

E{|| eb ( k +1) ||2 } 

(3.54)

42

3.3 Fault Detection and Isolation Method
Detection and isolation of both sensor and actuator faults are considered for the bleed air temperature control system in this section. The sensor faults are represented by the difference between the fault free sensor output and the real measurement, and actuator faults are represented by the bias between actual and commanded valve opening angle. The proposed fault detection and isolation method works with a practical assumption that only one sensor or one actuator is faulty at a time. In the proposed method, sensor fault or actuator fault in the system will be detected by two unscented Kalman filters. One UKF is dedicated to sensor fault, which is denoted as UKFS, and another UKF, named UKFA, is for detecting actuator fault. A diagram of the proposed fault detection and isolation method is shown in Fig. 3.2 .

xa = x
Plant input u Plant output y UKFS

e
Fault Isolation Algorithm

x exceeds the threshold Sensor fault e Actuator ^ fault b

x xa =    b  

UKFA

^ b

x is limited between 0 and a threshold

Fig. 3.2 Diagram of a fault detection and isolation method

In UKFS, only sensor fault is considered in the system. The actuator fault b is not augmented with state variable x, and is not predicted. The error e, which is the difference

43

the actuator bias b is used to augment the state vector x, and the estimation value of  is derived. If no fault has occurred, the mean value of each element in actuator bias 

between predicted output   and sensor measurement y, is detected by UKFS. In UKFA,

 will remain zero; otherwise the sensor fault e predicted from UKFS and/or both e and   predicted from UKFA is nonzero. the actuator bias 

The system is considered to be faulty when either e derived from UKFS has  derived from UKFA is nonzero. In other words, a fault will be nonzero mean or  detected as a sensor fault by UKFS and as an actuator fault by UKFA in the meantime. To diagnose if the fault is a sensor fault or an actuator fault, a squared residual x is introduced, which is defined as

 x ( k ) = ( x ( k ) - x b ( k ) )T ( x ( k ) - x b ( k ) )

(3.55)

 into nonlinear function (2.21) where xb is the state variable calculated by substituting 

^ ,z ) xb ( k +1) = f (x b ( k ) , u ( k ) , b (k ) (k )

(3.56)

 is the actual actuator bias, the mean value of x should be equal to zero. However, If 

due to the dynamic error between the predicted actuator fault and the actual value, x will

be zero only when the system is steady. For most cases, when a dynamic actuator fault is under detection, x will be limited between zero and a threshold value. Otherwise, the mean of x will exceed the threshold, and e is the actual sensor fault. The value of the threshold needs to be selected by trial and error upon the control system tuning. When the

44

state vector x and actuator bias b are both bounded, x will also be bounded. The boundary is related to the boundary of x and b.

3.4 Simulation Results
Simulation studies have been conducted for the bleed air temperature control system, using dynamic equations and the UKF based fault detection and isolation method derived in the above sections. In the simulation, the measurement fault in load temperature sensor and actuator fault in bypass valve and ram air valve are considered. First a measurement noise in the load temperature sensor is introduced with variance Rv=0.01. The simulation duration is 100 seconds and the time step is typically 0.1 seconds. The mean of the squared residual x is calculated with the averaging period of 10 sampling points. The threshold of x is 0.2 Â°F2. The parameters and initial conditions are given to simulate an aircraft in cruising mode and are listed in Table 3.1. In the following figures (Fig. 3.3 to Fig. 3.7) the dashed line shows the real value of sensor or actuator fault, the dot-dashed line shows the threshold of x, and the solid line is the value of fault detected by the proposed UKF algorithm or the value of x .
Table 3.1 Parameter and initial values for bleed air system

Tload=190 ÂºF Pamb=10.11 psi Pho=45.107 psi Wbleedbypass=0.0018 lb/s Dbypass=Dram=1.5 in

Tamb=70 ÂºF Phin=45.11 psi Pco=10.11 psi Wram=0.0198 lb/s bypass= bypass=1.5 s

Thi=380 ÂºF Pcin=11.43 psi Pload=45.107 psi Wbleed=0.0183 lb/s

45

Fig. 3.3 shows the simulation results for detecting a sensor measurement fault, which occurs at t=10 s and increases linearly to 2 Â°F at t=20 s. As shown in Fig. 3.3(a), an error e is detected by UKFS, with the same magnitude as the simulated sensor measurement fault. In Fig. 3.3 (b), the UKFA outputs an estimated value of valve  , which occurs at t=10 s and increases to 0.02 rad. According to the fault opening bias 

isolation algorithm stated in last section, the bypass valve opening bias detected by UKFA is not an actual fault because the mean of squared residual x (Fig. 3.3 (c)) keeps increasing and exceeds the threshold. Fig. 3.4 to Fig. 3.7 show the simulation results for detecting bypass valve and ram air valve actuator faults. As shown in Fig. 3.4 (b) and Fig. 3.5 (b), a valve opening bias is simulated, which occurs at t=10 s and increases linearly to 2% full opening range of the valve (0.0314 rad) within 10 seconds, and the estimated valve opening bias increases after the actuator fault occurs and converges to the actual value. In Fig. 3.6 (b) and Fig. 3.7 (b), a valve opening bias is simulated as a sine wave with the peak value of 2% full opening range of the valve (0.0314 rad), and the estimated value follows the change of the actual actuator bias. In Fig. 3.4(c), after the fault occurs, the mean of squared residual is limited within 0.2 (Â°F2), as well as in Fig. 3.5 (c) to Fig. 3.7 (c). According to the proposed fault isolation algorithm, the fault detected by UKFA is the actual actuator fault and the sensor measurement bias detected by UKFS (Fig. 3.4 (a) to Fig. 3.7 (a)) is not really a sensor measurement fault.

46

(a)

(b)

(c)

Mean of squared residual x (deg.F2)

Bypass valve opening bias b (rad)

Temperature sensor error e (deg.F)

Time (sec)
Fig. 3.3 Simulation results for detecting load temperature sensor measurement fault which occurs at t=10s: (a) load temperature sensor measurement error detected with UKFS, (b) valve opening bias detected by with UKFA, (c) mean of squared residual x

47

(a)

(b)

(c)

Mean of squared residual x (deg.F2)

Bypass air valve opening bias b (rad)

Temperature sensor error e (deg.F)

Time (sec)

Fig. 3.4 Simulation results for detecting bypass valve opening angle fault which occurs at t=10s: (a) load temperature sensor measurement error detected with UKFS, (b) valve opening bias detected by with UKFA, (c) mean of squared residual x

48

(a)

(b)

(c)

Mean of squared residual x (deg.F2)

Ram air valve opening bias b (rad)

Temperature sensor error e (deg.F)

Time (sec)

Fig. 3.5 Simulation results for detection ram air valve opening angle fault which occurs at t=10s: (a) load temperature sensor measurement error detected with UKFS, (b) valve opening bias detected by with UKFA, (c) mean of squared residual x

49

(a)

(b)

(c)

Mean of squared residual x (deg.F2)

Bypass valve opening bias b (rad)

Temperature sensor error e (deg.F)

Time (sec)

Fig. 3.6 Simulation results for detection bypass valve opening angle fault which occurs at t=10s: (a) load temperature sensor measurement error detected with UKFS, (b) valve opening bias detected by with UKFA, (c) mean of squared residual x

50

(a)

(b)

(c)

Mean of squared residual x (deg.F2)

Ram air valve opening bias b (rad)

Temperature sensor error e (deg.F)

Time (sec)

Fig. 3.7 Simulation results for detection ram air valve opening angle fault which occurs at t=10s: (a) load temperature sensor measurement error detected with UKFS, (b) valve opening bias detected by with UKFA, (c) mean of squared residual x

51

Remark: There is a trade-off between fault detection reliability and efficiency when it comes to the selection of a threshold for x. For example, as shown in Fig. 3.3 (c), if the threshold for x is 0.1 (Â°F2), the sensor fault could be isolated about 10 seconds earlier, but the bypass valve actuator fault will be misclassified as sensor measurement error because x exceed 0.1 between 30 and 40 seconds in Fig. 3.4 (c). The selection of the threshold value depends on many factors, such as the system modeling error, and needs to be selected by trial and error upon the control system tuning. In extreme cases, when the system response deviates substantially from its dynamic model, a fault may not be detected correctly. In practice, an FDI method may be enabled only during cruising flight mode of the aircraft, when the system dynamics can be modeled more accurately with minimum uncertain factors.

52

CHAPTER 4 HEAT EXCHANGER FOULING DETECTION

4.1

Fouling Detection Algorithm The fundamental concept of the proposed fouling detection method is that the

fouling severity of the heat exchanger can be reflected by the deviation of valve control command from normal values. A diagram of the proposed heat exchanger fouling detection method based on valve command signal is shown in Fig. 4.1. In the proposed fouling detection method, a reference model is introduced which represents the performance of a clean heat exchanger. The difference between the estimated load
^ temperature T load and actual load temperature Tload is defined as the estimation error

^ -T  =T load load

(4.1)

With the estimation error reaching to zero, a deviation of the actual valve opening
^bypass . And then the valve command command ubypass is obtained, which is denoted as u

for the reference fouling-free system model is
^ bypass = u bypass + u ^ bypass u

(4.2)

If there is no fouling in the heat exchanger, the actual bleed air system dynamics
^bypass is close to zero. If the fouling is matches with the reference model, and u

53

^bypass will deviate from zero and the magnitude of u ^bypass reflects the significant, u ^bypass will severity of fouling. In the following section, the valve command deviation u

be considered as a state variable and predicted by an extended Kalman filter (EKF), which is used as a state estimator.

Fig. 4.1 Diagram of heat exchanger fouling detection method

4.2

Residual Generation Using EKF In the modeling of heat exchanger, the ratios of the thermal capacities of the

masses of the two air streams to the thermal capacity of the core itself are negligibly small, and hence can be regarded as zero. A small capacity ratio means that the fluid transit or dwell time is small compared to the duration of the transient (Gvozdenac, 1986). The functional dependency of the model parameters' (i.e., the heat transfer coefficients) on mass flow rate reflects the dynamic behavior of the heat exchanger. Since the heat transfer coefficients are functions of mass flow rate, the model is nonlinear and the EKF is applied to the state estimation. The correlation equations for heat transfer coefficients

54

for realistic heat exchangers are employed here as determined by Equations (2.15) and (2.16). Measurements of the inlet and outlet temperatures and the flow rates provide the data for model state estimation with the EKF algorithm.
^bypass together with the state variables The valve opening command deviation u

^ a = [x ^T compose the augmented state vector x

^bypass ]T , which is to be predicted by u

^bypass is unknown and time varying, and the EKF. The valve command deviation u

^bypass (Simon, 2006). Hence the model for the which allows the EKF to estimate of u

change of the deviation is modeled as a Gaussian white noise   with covariance Vb,

estimator becomes
^ ( k +1|k ) = f (x ^ ( k ) , ubypass ( k ) , u( k ) , z ( k ) ) x

(4.3 (a))

^bypass ( k +1| k ) = u ^bypass ( k ) + v ^b( k ) u

(4.3 (b))

The output equation is
^ ( k +1) = h(x ^ a ( k +1) , u( k +1) , z ( k +1) ) y

(4.4)

Equations (4.3) and (4.4) will be used as prediction and update functions in EKF, and are assumed to be continuously differentiable. The predicted estimate covariance is

P a ( k +1|k ) = F( k ) P( k ) F( k )T + Vb ( k )

(4.5)

where F is the state transition matrix and is given by
55

F( k )

f = a x

^ a (k ) x

 x ( k +1)  =  x ( k ) ^ ( k ) , u ^ bypass ( k ) x  0 { 1 ( N N )} Ã Ã 

x ( k +1) ^bypass ( k ) u

  ^ ( k ) , u ^ bypass ( k )  x  1 

(4.6)

The update equations for state estimates and covariance are
^ a ( k +1) = x ^ a ( k +1|k ) + K ( k +1) e( k +1) x

(4.7)

P a ( k +1) = (I - K ( k +1)G ( k +1) )P a ( k +1|k )

(4.8)

where K is the Kalman filter gain, G is the state observation matrix, and they are given by the following equations.

K ( k +1) = P a ( k +1)G ( k +1) S ( k +1)
T

-1

(4.9)

G ( k +1)

h = a x

x a ( k +1)

 y ( k +1) =  x ( k +1) 

^ ( k +1) , u ^bypass ( k +1) x

y( k +1) ^bypass ( k +1) u

   ^ ( k +1) , u ^bypass ( k +1)  x

(4.10)

S in Equation (4.9) is the residual covariance

S ( k +1) = G ( k +1) P a ( k +1)G ( k +1) + Rv ( k +1)
T

(4.11)

4.3 Effect of Fouling
In order to emulate the fouling effects, the heat exchanger internal tubes were lined with fouling, and tests were carried out after each layer of fouling was added. Three

56

cumulative layers of fouling were sprayed on to the internal structure of the heat exchanger in the hot air channels. The types of sprayed materials are listed in Table 4.1 .

Table 4.1 Types of fouling added in heat exchanger

Fouling type Level 1

Fouling type for bleed air (hot) side Spray of black asphalt undercoating on the front of the heat exchanger

Level 2

Grey primer thin coating on the front and inner structure of the heat exchanger

Level 3

Grey primer thick coating over the total heat exchanger structure

The effect of heat exchanger fouling in bleed air temperature control system is studied with respect to cruising flight mode. The system can be considered operating in a steady state under this mode. The temperature and pressure drops are measured at constant flow rates and increasing fouling levels. Experiments were carried out for various rates of air flow. Bleed and ram air flow rates ranging from 0.01 Â­ 0.06 lbm/s were tested. The inlet and flow conditions for which the tests were carried out are summarized in Table 4.2.

57

Table 4.2 Inlet and flow conditions for fouling tests

Test No.

Bleed air flow Ram air flow rate Inlet Temperature rate (lb/s) (lb/s) 0.02 0.01 0.055 0.01 0.01 Thi (o F) 163-165 163-165 156-157 164-166 120-122

A B C D E

0.035 0.011 0.011 0.045 0.02

For tests A Â­ E, with variations in hot and cold air mass flow rate and hot air inlet temperature, the change in flow temperature is observed for different levels of fouling. Therefore, increasing of fouling level has little effect on the outlet temperature response, under variant flow rates. As seen in Fig. 4.2, the outlet temperature does not change significantly with increasing fouling. The reason is that heat transfer rate is proportional to flow rate of air across the heat exchanger. In other words, if the flow rate through heat exchanger keeps constant, the heat transfer rate will not have significant change. Also, slight degradation in the heat transfer surface has no significant effect on the thermal performance of the heat exchanger, due to low thermal conductivity of air.

58

Air temperature drop (deg. F)

Test No .
Fig. 4.2 Bleed air temperature drop comparison of clean and fouling conditions

The relation between valve command signal and pressure drop increment through heat exchanger (as a result of fouling increase) is found with simulations and experiments for the same operating conditions listed in Table 4.3.
Table 4.3 Operating conditions for bypass control configuration

Thi = 135 Â°F Wbleed = 0.02 lb/s Phi= 16.2 psi

Tci = 70 Â°F Wram = 0.03 lb/s Kbypass =100(/2)

Tload_sp =86 Â°F Dbypass = 0.75 inch

As shown in Fig. 4.3 , the bypass valve opening command decreases with the increase of the pressure drop through the heat exchanger, which is caused by the increased fouling. The decrease of the bypass valve opening command can be explained as follow: the flow in bleed air (hot) side of heat exchanger is blocked with fouling, which leads to increased bypass channel flow and higher load temperature if the opening angle of bypass valve is not changed. To regulate the load temperature at the set point,
59

the bypass valve opening is decreased to reduce the flow through the bypass channel. The simulation well predicts experimental results despite of limited offset induced by modeling errors.

Fig. 4.3 Relationship of bypass valve opening command and pressure drop increment

From the results in Fig. 4.3, the effect of heat exchanger fouling in the bleed air system can be modeled as pressure drop increment through heat exchanger, which is defined as Pdroph for bleed air side and increases with accumulation of fouling. The hot side pressure drop for a fouled heat exchanger can be expressed as
Pdroph( f ) == Pdroph + Pdroph

(4.12)

60

CHAPTER 5 DEVELOPMENT OF TEST FACILITY AND EXPERIMENTS

5.1

Test Rig Design A test rig was developed at the Systems and Control Laboratory of Ryerson

University for the flow temperature control studies. Fig. 5.1 and Fig. 5.2 show the schematic layout and picture of the test rig, respectively. This test rig consists of one bleed air channel and a ram air channel. To simulate the engine bleed air, the air in bleed air channel is heated up to the required temperature with a 3 kW in-line heater. A bypass channel is split from the bleed air channel over the heat exchanger with an electrical control valve (CV2) installed. A temperature sensor is installed at the outlet of bleed air channel to measure the load temperature. Mass flow sensors, pressure sensors, temperature sensors, and manual valves are installed on the test rig. Main control elements and their locations in the test rig are listed in Table 5.1.

Fig. 5.1 Bleed air temperature control test rig configuration

61

Fig. 5.2 Picture of the test rig

There are two air sources in the experimental set up. The main air source is two parallel-connected high pressure tanks, each having a capacity of 51300 in3. The maximum pressure inside the tank is 100 psig, charged by a compressor. Although the compressor can continuously supply the compressed air to the tanks, the pressure of the air feeding to the test rig drops, depending upon the mass flow rate. To solve this problem, a control valve (CV3) is installed between the tanks and the test rig. The source air pressure for the test rig can be kept approximately constant by regulating this control valve. The second air source is a tank shared with other labs. It supplies air to the ram air channel. There are two size metal pipes in the test rig. The Â¾-inch diameter pipe is used to fit the Â¾-inch electrical control valves, which are used to regulate the air source inlet pressure, ram air flow rate and bypass flow rate. The 2-inch diameter pipe is used for
62

installing the flow sensor, because the sensor is too long to be installed in a Â¾-inch diameter pipe. The command unit consist of a Pentium-D PC, a 16 bit A/D board ( PCI 6034E) and a 16 bit D/A board (PCI 6704), both manufactured by National Instruments, Co. The PC serves as the controller that sends out current commands to control valves and collects signals of pressures transducers, flow sensors, and temperature sensors.

Table 5.1 Main components of the test rig

Component Air heater and control cabinet Heat Exchanger

Type Part Number P/N 074719 & 074722 A300029060RYU NI PX209-100G10V

Output/Input

Manufacture

Symbol in Fig. 5.1 Heater Heat Exchanger PS12,PS13

N/A

SYLVANIA Bell Intercoolers

N/A

0~10V OMEGA

Pressure Sensor PX303-100G10V Flow sensor Temperature sensor D/A Board FMA-905-V-S N/A 0~20mA DC -10~+10V DC -10~+10V N/A 1~11V 0~5V

PS11, PS21 OMEGA Honeywell National Instruments National Instruments DEll FS11, FS21 TS11, TS12, TS13,TS21 N/A

PCI-6704

A/D Board PC computer

PCI-6034E

N/A N/A

63

5.2 Main Components
5.2.1 Heat exchanger The heat exchanger is the core part of the test rig. The high performance air to air heat exchanger (Fig. 5.3) is manufactured by Bell Intercoolers. The size of the heat exchanger core is 3.0"Ã 2.9"Ã 6" . Tanks are welded on four sides of the core for pipe connection. The plate-fin heat exchanger has four bleed air channels and four ram air channels, and it is safe to operate with a pressure under 100 psig.

Fig. 5.3 Air to air plate-fin heat exchanger, manufactured by Bell Intercoolers

For the experiments, parameters for the heat exchanger, such as heat transfer coefficient is unknown to the user and need to be identified. With the change of flow temperature and incremental of heat transfer, the overall heat transfer coefficients Hh and Hc are estimated as

64

Hh = Hc =

Wbleedmain C h (Tho - Thi ) ln (T2 / T1 ) T2 - T1

(5.1)

where T1 = Tho - Tci and T2 = Thi - Tco .

5.2.2

Heater and control systems An in-line air heater is installed at the inlet of bleed air channel. The 3 KW heater is

able to heat the flow up to 300 ÂºF (150 ÂºC) at the mass flow rate 0.04 lb/s. The inlet and exit temperature limits are 200 ÂºF (93 ÂºC) and 1400 ÂºF (760 ÂºC), respectively. The maximum air inlet pressure is 60 psig, which is lower than the maximum tank pressure. In order to protect the heater and insure users' safety, the heater inlet pressure is regulated below 60 psig. And no valve is installed downstream the heater so that the flow will not be blocked. The closed-loop heater control system contains a temperature controller, power controller, over-temperature protection, and a thermocouple, providing a constant output temperature regardless of changes in the airflow. The temperature controller also

provides a display of the process air temperature. Fig. 5.4 shows the heater and its controller. The manufacturer is SYLAVNIA.

65

Fig. 5.4 Air heater control system, manufactured by SYLANVIA

5.2.3

Control valve The control valve (Fig. 5.5) is a Â¾-inch brass ball valve driven by an

electromechanical actuator. Both the valve and actuator are manufactured by BI-TORQ, CARBO-BOND, Inc. The temperature rating for the valve is 297 ÂºF. The control valve used in the test rig has limited sensitivity to the input current. The valve "dead-zone" is about 0.2 mA when the valve keeps going in one direction and about 0.5 mA when the valve changes its movement direction.

Fig. 5.5 Control valve manufactured by BI-TORQ, CARBO-BOND, Inc.

66

5.2.4

Temperature sensor A Honeywell RTD temperature sensor (Fig. 5.6) is used. The response time of the

sensor is affected by the air flow rate. For the low flow rate used in the experiment, the response time is considered as a constant.

Fig. 5.6 RTD temperature sensor, supplied by Honeywell

5.2.5

Flow sensor The air velocity transducer FMA-905 (Fig. 5.7) is manufactured by OMEGA Inc. It

utilizes both a velocity sensor and a temperature sensor to accurately measure air velocity V (in SFPM, standard feet per minute). To obtain mass flow rate W (lb/s) the SFPM velocity is multiplied by the cross-sectional area of the pipe A and air density :

W = VA

(5.2)

67

Fig. 5.7 Air velocity transducer, manufactured by OMEGA Inc.

5.2.6

Pressure sensor Two types of pressure sensors, PX303 and PX209 (Fig. 5.8) are installed in the test

rig to operate in different temperature ranges. Pressure sensors PX303 are used to measure ram air inlet pressure and bleed air inlet pressure at the location before the heater where the operating temperature is relatively low. The inlet pressure of the valve and the load pressure are measured by PX209, a higher temperature pressure sensor. All the pressure sensors are manufactured by OMEGA Inc.

(a)

(b)

Fig. 5.8 Pressure sensors, manufactured by OMEGA Inc.: (a) PX303; (b) PX209

68

5.3 Experiments for Sensor and Actuator Fault Detection
The proposed UKF based fault detection and diagnosis method has been evaluated experimentally as shown in Fig. 5.9 and Fig. 5.10. The sampling period is 0.1 s, and the mean of the squared residual is calculated with the averaging period of 10 sampling points. The threshold of  x is set to 0.3 Â°F2 In the first experiment, a 2 Â°F bias is added on the measurement signal of load temperature sensor at 50 seconds. This bias is used to simulate sensor measurement fault. As shown in Fig. 5.9(a), the sensor fault detected by UKFS is around 2.5 Â°F. Since the mean of squared residual x exceeds the threshold after the fault occurs (Fig. 5.9(c)), the actuator fault obtained by UKFA ((Fig. 5.9(b)) is not really an actuator fault. In another experiment, a 2 mA is added to the command to the bypass valve at 50 seconds, which is equivalent to a 0.2 rad valve opening fault. As shown in Fig. 5.10(c), since the mean of squared residual x is within the threshold 0.3 ( Â°F2). The bypass valve opening bias, which is detected by the UKFA around 0.16 rad (Fig. 5.10 (b)), can be considered as a true actuator fault. In other words, the sensor measurement bias detected by UKFS (Fig. 5.10 (a)) is not an actual sensor fault. For the second experiment, the mean of squared residual does not converge to zero when the system is steady, because there is always an error between the predicted load temperature and the measured value. This error may be caused by many factors. First, the system dynamic model is not exact due to the assumptions made in Section II. Some system parameters may not be identified accurately. Second, heat loss through the metal pipes, and unmodeled disturbances may also cause some error.

69

(a)

(b)

(c)

Mean of squared residual x (deg.F2)

Ram air valve opening bias b (rad)

Temperature sensor error e (deg.F)

Time (sec)
Fig. 5.9 Experimental results for detecting measurement fault of load temperature sensor at t=50s: (a) load temperature sensor measurement error detected with UKFS, (b) valve opening bias detected by with UKFA, (c) mean of squared residual x

70

(a)

(b)

(c)

Mean of squared residual x (deg.F2)

Ram air valve opening bias b (rad)

Temperature sensor error e (deg.F)

Time (sec)
Fig. 5.10 Experimental results for detecting bypass valve opening angle fault which occurs at t=50s: (a) load temperature sensor measurement error detected with UKFS, (b) valve opening bias detected by with UKFA, (c) mean of squared residual x

71

5.4 Experiments for Heat Exchanger Fouling Detection

The experimental result for heat exchanger fouling detection is shown in this section. Fig. 5.11 shows the bypass valve command deviation as predicted using EKF for various fouling levels. The dashed lines are results of simulation. The values are listed in Table 5.2, which correspond to the experimentally determined bleed air pressure drop for different fouling levels. The solid lines in Fig. 5.11 represent the valve command deviation in experiments, which are measured when the system is steady. As shown in Fig. 5.11, the estimated deviation increases with the increase of the heat exchanger fouling level. In other words, the severity of fouling is reflected by this increase. A larger deviation indicates a higher level of fouling accumulated in the heat exchanger. In the experiments, the change of some operating conditions, e.g., the total bleed air flow rate, will cause the fluctuation of valve command deviation. If the change of operating condistions is small, the fluctuation of estimated valve command deviation will be limited by a threshold. In some situations, due to the linearization in EKF, the filter may diverge if the actual operating conditions are not near the initial values. The ram air flow rate is maintained constant in the bypass control configuration, and fouling in the ram air channel is not studied in this work, which can be done using the same concept that has been presented in this dissertation. For the ram air control configuration (Shang, Liu, & Hodal, 2010), the load temperature is regulated by a valve placed in the ram air channel to control the ram air flow rate. With fouling increasing in ram air channel, the ram air valve will be forced to open more to let enough air pass through the heat exchanger.
72

Fig. 5.11 Bypass valve opening command deviation for different fouling levels

Table 5.2 Steady state valve command deviation

Fouling level Pressure drop increment (psi) Valve command deviation (%)

Clean heat exchanger 0 0

Level 1 0.004 2.21

Level 2 0.017 7.57

Level 3 0.06 15.73

73

CHAPTER 6 CONCLUSIONS AND FUTURE WORK

6.1

Conclusions This dissertation presents proposed fault detection and diagnosis methods along

with simulation and experimental results on the simulated bleed air temperature control system. The system regulates engine bleed air temperature using cold ram air through a controlled heat exchanging process. Temperature sensing elements, air flow control elements, and heat exchanging elements constitute the key components for proper functioning of the temperature control system. It is desired that faults in these key components can be detected and identified without using expensive redundant devices. Therefore, analytical fault detection and diagnosis methods based on mathematical models attract great attention and become the focus of this dissertation. The analytical methods of fault detection and diagnosis require the equations that govern the system dynamics to be established before fault detection and identification algorithms can be applied. A nonlinear mathematical model of the bleed air system is developed in this dissertation with realistic assumptions. Dynamics of the key components (heat exchanger, temperature sensor and control valve) are modeled. Influence of major parameters, such as mass flow rate, pressure, and temperature, are investigated in numerical and experimental tests. The nonlinear model is discretized in the time domain for use as prediction and update functions in the fault detection and diagnosis algorithms.

74

In the proposed fault detection method, two unscented Kalman filters are derived for the bleeding air temperature control system and used to monitor the sensor and actuator respectively. The value of sensor measurement error is estimated by one UKF, which is denoted as UKFS. By adding actuator bias in the state vector, actuator fault is estimated by another UKF, denoted as UKFA. For the fault diagnosis, a squared residual x is defined. The type of fault (sensor fault or actuator fault) is determined by comparing the squared residual and a threshold. Selection of the threshold value is based on empirical criteria obtained from experiments with trade-off between fault detection reliability and efficiency. Convergence analysis shows that the proposed UKF is stable and convergent. The proposed sensor and actuator fault detection and diagnosis method is investigated by both simulation and experiment. Sensor fault and actuator fault were detected and the type of fault is correctly determined based on the selected value of squared residual. For the health monitoring of heat exchanger, a valve control command based heat exchanger fouling detection method is developed. The fouling severity of the heat exchanger was reflected by the deviation of valve control command from normal values. Studying the effects of velocity and temperature on the fouling process provided useful information with respect to the operation of heat exchanger. The heat transfer efficiency of the heat exchanger and the pressure drop through the heat exchanger at various fouling levels are investigated experimentally. It is found that the outlet temperature of the heat exchanger dose not change significantly with the increased level of fouling under the same operating conditions (air flow rate and inlet temperature); however a larger deviation between the actual valve opening angle and the command value is found in
75

higher lever fouling cases. It was demonstrated that the valve opening angle deviation can be used as an effective indicator of fouling for the heat exchanger.

6.2 List of Contributions
The main contributions of this dissertation are summarized as follows: 1. A nonlinear model for the bleed air system was developed and used for design and convergence analysis for the proposed fault detection and diagnosis method. 2. A UKF based FDD method was developed to detect and identify temperature sensor fault and valve actuator fault in a high performance aircraft bleed air temperature control system. 3. A heat exchanger fouling detection method was developed in which fouling was monitored by estimating the deviation of valve control command of an engine bleed air temperature regulation system in operation.
4.

The sensor and actuator fault detection and diagnosis method, and the heat exchanger fouling detection method were investigated on computer-controlled bleed air temperature control rest rig. Experimental results confirmed the effectiveness of the proposed methods.

76

6.3 Future Work

6.3.1

Limitations in the current work The current research is limited in terms of actual implementation. It is difficult to

build an experimental setup that exactly simulates the actual environment in an aircraft at cruising conditions. The heat loss from the bleed air temperature control system to the environment can hardly be quantified and precisely modeled. It is difficult to maintain a constant flow rate and a constant inlet pressure of the bleed air and ram air for a long duration. In addition, the fouling layers in a heat exchanger are not ideal. The thickness may vary along the flow channel since the foulant can only be sprayed from the inlet and the outlet. These facts are considered to be responsible for the difference between the simulations and the experiments on the heat exchanger. The steady-state error and small swing of the system response can be seen from the experimental results. It may be caused by many factors. First, the system model is not exactly the same the real system because of the assumptions made in Chapter 2. Second, some system parameters may not be identified accurately. The temperature errors and small variation may also be caused by sensor measurement error, heat loss through the metal pipes, and unmodeled dynamics of the control valves.

77

6.3.2

Suggestions for future work 1. To enhance the reliability of the aircraft bleed air temperature control system, a fault tolerant control system can be designed based on the sensor or actuator faults estimation developed in this dissertation. 2. Parameter identification of heat exchanger may be conducted to obtain a more accurate heat exchanger model. 3. The test rig may be improved for a longer duration with stable air supply so that longer experimental runs can be achieved.

78

REFERENCES
Agniel, R.G., & Jury, E.I. (1971). Almost sure boundedness of randomly sampled system. SIAM Journal of Control, 9, 372-384. Borguet, S., & Lenoard, O. (2009). Coupling principal component analysis and Kalman filtering algorithms for on-line aircraft engine diagnostics. Control Engineering Practice, 17, 494-502. Bott, T. Reg. (2007). Fouling control and energy conservation. 1st International Conference on Thermal Issues in Emerging Technologies, Theory and Applications, 191-198. Cork, L., & Walker, R. (2007). Sensor fault detection for UAVs using a nonlinear dynamic model and the IMM-UKF algorithm. Information, Decision and Control, Adelaide, Australia, 230 Â­ 235. Del Gobbo, D., Napolitano, M., Famouri, P., & Innocenti, M. (2001). Experimental application of extended Kalman filtering for sensor validation. IEEE Transaction on Control System Technology, 9(2), 376 Â­ 380. Ensign, T., & Gallman, J. (2006). Energy optimized equipment systems for general aviation jets. 44th AIAA Aerospace Sciences Meeting and Exhibit, Reno, Nevada, AIAA-2006-228. Epstein, N . (1985). Fundamental of heat transfer surfaces in B.A. garret-price, fouling of heat exchangers, Noyes Publication. Erickson, K.T., & Hedrick, J.L. (1999). Plantwide Process Control, Weinheim: Wiley, New York.

79

Gvozdenac, D. D. (1986). Analytical solution of the transient response of gas-to-gas cross flow heat exchanger with both fluids unmixed. Journal of Heat Transfer, 108, 722 Â­ 727. Hwang, I., Kim, S., Kim, Y., & Seah, C.E. (2010). A survey of fault detection, isolation, and reconfiguration methods. IEEE Transactions on Control Systems Technology, 18(3), 636-653. Hodal, P., & Liu, G. (2005). Bleed air temperature regulation system: modeling, control, and simulation. Proceedings of the 2005 IEEE International Conference on Control Applications, Toronto, ON, Canada, 1003-1008. Hunt, E. H., Reid, D. H., Space, D. R., Tilton,F. E. (1995). Commercial airliner environmental control system. Engineering Aspects of Cabin Air Quality Aerospace Medical Association Annual Meeting, Anaheim, California. Incropera, F. P., & DeWitt, D. P. (1996). Fundamentals of Heat and Mass Transfer. 4th, New York: John Wiley & Sons. Ishiyama, E. M., Paterson, W. R., & Wilson, D. I. (2008). Thermo-hydraulic channeling in parallel heat exchangers subject to fouling. Chemical Engineering Science, 63(13), 3400-3410. Julier, S.J., Uhlmann, J.K., & Durrant-Whyte, H. (1995). A new approach for filtering nonlinear system. Proceedings of the American Control Conference, Seattle, WA, USA, 1628-1632. Julier, S.J., & Uhlmann, J.K. (1997). New extension of the Kalman filter to nonlinear systems. Proceedings of SPIE - The International Society for Optical Engineering, 3068, 182-193. Julier, S.J., & Uhlmann, J.K. (2004). Unscented filtering and nonlinear estimation. Proceedings of the IEEE, 92(3), 401-422.

80

Kays, W.M., & London, A.L. (1964). Compact Heat Exchangers, McGraw-Hill, New York. Kobayashi, T., & Simon, D. L. (2005). Evaluation of an enhanced bank of Kalman filters for in-flight aircraft engine sensor fault diagnostics. Journal of Engineering for Gas Turbines and Power , 127(3), 497-504. Kobayashi, T., & Simon, D.L. (2005). Hybrid neural-network genetic-algorithm technique for aircraft engine performance diagnostics. Journal of Pollution and Power, 21(4), 751-758. Kobayashi, T., & Simon, D.L. (2007). Hybrid Kalman filter approach for aircraft engine in-flight diagnostics: sensor fault detection case. Journal of Engineering for Gas Turbines and Power , 129(3), 746-754. Liu, G., Wang, D., & Li, Y. (2004). Active fault tolerant control with actuation reconfiguration. IEEE Transactions on Aerospace and Electronic Systems, 40(3), 1110 Â­ 1117. Moir, I., & Seabridge, A. (2001). Aircraft Systems: Mechanical, Electrical, and Avionics Subsystems Integration, AIAA Education Series, American Institute of Aeronautics and Astronautics, Inc., Reston, VA, USA. Mukherjee, J., Menon, S., Kini, V.B., & Eswara, L. (2005). Gas turbine fault detection and diagnosis using nonlinear feature extraction methods. Proceedings of the ASME Turbo Expo, 1, 737-743. Newman, W. H., Viele, M. R., & Hrach, F. J. (1980). Reduced bleed air extraction for DC-10 cabin air conditioning. SAE, and ASME, Joint Propulsion Conference, 16th, Hartford, Conn., AIAA-1980-1197. Persin, S., & Tovornik, B. (2005). Real-time implementation of fault diagnosis to a heat exchanger. Control Engineering Practice, 13, 1061-1069.

81

Qi, J., Han, J., & Wu, Z. (2008). Rotorcraft UAV actuator failure estimation with KFbased adaptive UKF algorithm. American Control Conference, Seattle, WA, USA, 1618 Â­ 1623. Shang, L., & Liu, G. (2007). Optimal control of a bleed air temperature regulation system. IEEE International Conference on Mechatronics and Automation, 2610-2615. Shang, L., Liu, G., & Hodal, P. (2010). Development of high performance aircraft bleed air temperature control system with reduced ram air usage. IEEE Transactions on Control Systems Technology, 18(2), 438-445. Simon, D. (2006). Optimal State Estimation: Kalman, H Infinity, and Nonlinear Approaches, John Wiley & Sons, Inc., Hoboken, New Jersey. Tarn, T.J., & Rasis, Y. (1976). Observers for nonlinear stochastic systems. IEEE Transaction on Automatic Control, 21(4), 441-448. Thomson, M., Twigg, P.M., Majeed, B.A., & Ruck, N. (2000). Statistical process control based faultdetection of CHP units. Control Engineering Practice, 8, 13-20. Tidoroiu, N., Sobhani-tehrani, E., & Khorasani, K. (2006). Interactive bank of unscented Kalman filters for fault detection and isolation in reaction wheel actuators of satellite attitude control system. IECON 2006 - 32nd Annual Conference on IEEE Industrial Electronics, Porto, Portugal, 264 Â­ 269. Tidoroiu, N., Zaheeruddin, M., Tudoroiu, E.R., & Jeflea, V. (2008). Fault detection and diagnosis (FDD) in heating ventilation air conditioning systems (HVAC) using an interactive multiple model augmented unscented Kalman filter (IMMAUKF). 2008 Conference on Human System Interactions, Krakow , Poland, 334 Â­ 339. Van der Merwe, R. and Wan, E.A. (2001). The square-root unscented Kalman filter for state and parameter estimation. IEEE International Conference on Acoustics, Speech, and Signal Processing, Salt Lake City, Utah, USA, 6, 3461-3464.

82

Willsky, A. S. (1976). A survey of design methods for failure detection in dynamic systems. Automatica, 12, 601-611. Wright, S., Andrews, G., & Sabir, H. (2009). A review of heat exchanger fouling in the context of aircraft air-conditioning systems, and the potential for electrostatic filtering," Applied Thermal Engineering, 27(13), 2596-2609. Xiong, K., Zhang, H.Y., & Chang, C.W. (2006). Performance evaluation of UKF-based nonlinear filtering. Automatica, 42(2), 261-270. Xiong, K. C., Chan, W., & Zhang, H. Y. (2007). Detection of satellite attitude sensor faults using the UKF. IEEE Transactions on Aerospace and Electronic Systems, 43(2), 480 Â­ 491. Yeoman, K. (1994). Efficiency of a bleed air powered inlet icing protective system. Aerospace Sciences Meeting and Exhibit, 32nd, Reno, NV, AIAA-1994-717. Yoshida, H., & Iwami, T. (1996). Typical faults of air-conditioning systems and fault detection by ARX model and extended Kalman filter. ASHRAE Transactions, 102(1), 557-564. Zhang, Y., & Jiang, J. (2008). Bibliographical review on reconfigurable fault-tolerant control systems. Annual Reviews in Control, 32(2), 229-252. Zhou, D. H., & Frank, P. M. (1996). Actuator fault diagnosis of a class of nonlinear systems in closed-loops: a case study. UKACC International Conference on Control, 1, 311-316.

83

APPENDIX

1. MATLAB script for sensor and actuator fault detection and diagnosis clear all clc OperatingCondition=[%Pin Ta Pa M Wh Thi 30 130 14.70 0.0 1.1 380; % mission segment data #1 35 30 14.70 0.0 1.1 250; % mission segment data #2 20 130 14.70 0.0 1.1 300; % mission segment data #3 0 0 14.70 0.0 1.1 0; % mission segment data #4 35 130 14.70 0.4 1.1 380; % mission segment data #5 35 20 14.70 0.4 1.1 380; % mission segment data #6 35 90 10.11 0.5 1.1 380; % mission segment data #7 35 10 10.11 0.5 1.1 380; % mission segment data #8 35 50 6.76 0.7 1.1 380; % mission segment data #9 35 -10 6.76 0.7 1.1 380; % mission segment data #10 35 10 4.37 0.8 1.1 380; % mission segment data #11 35 -25 4.37 0.8 1.1 380; % mission segment data #12 20 -40 2.15 0.85 1.1 380; % mission segment data #13 10 -25 2.15 0.85 1.1 380; % mission segment data #14 30 -40 2.15 0.85 1.1 380; % mission segment data #15 13 -30 2.15 0.85 1.1 380; % mission segment data #16 35 -40 2.15 0.85 1.1 380; % mission segment data #17 20 -40 2.15 0.85 1.1 380; % mission segment data #18 20 10 4.37 0.85 6.5 380; % mission segment data #19 25 -30 4.37 0.85 6.5 380; % mission segment data #20 20 50 6.76 0.7 6.5 380; % mission segment data #21 30 -10 6.76 0.7 6.5 380; % mission segment data #22 25 90 10.11 0.5 6.5 380; % mission segment data #23 35 10 10.11 0.5 6.5 380; % mission segment data #24 35 110 12.23 0.4 6.5 380; % mission segment data #25 35 15 12.23 0.4 6.5 380; % mission segment data #26 35 130 14.70 0.4 5.5 380; % mission segment data #27 35 20 14.70 0.4 5.5 380; % mission segment data #28 30 130 14.70 0.0 5.5 380; % mission segment data #29 35 30 14.70 0.0 5.5 250];% mission segment data #30 OpConNum=7%input('\nPLEASE CHOOSE THE OPERATING CONDITION NUMBER (1-30, typical No.#7):'); det_t=0.1%input('\nPLEAS INTER THE LEENGTH OF TIME STEP (et.0.1):'); interval=100; %duration for simulation

84

%fault signal %bypass valve actuator fault b_bypass_limit=0 %input('\nPLEAS INTER THE value of max bypass valve actuator fault(1%-10%):') for k=1:interval/det_t; if k<=10/det_t; b_bypass(k)=0; end if k>10/det_t %b_bypass(k)=sin((k-10/det_t)*0.01)*(0.01*0.5*pi*b_bypass_limit); b_bypass(k)=b_bypass(k-1)+0.01*0.5*pi*b_bypass_limit/(10/det_t); if abs(b_bypass(k))>0.01*0.5*pi*b_bypass_limit b_bypass(k)=b_bypass(k-1); end end end %ram air valve fault b_ram_limit=0 %input('\nPLEAS INTER THE value of max bypass valve actuator fault(1%-10%):') for k=1:interval/det_t; if k<=10/det_t; b_ram(k)=0; end if k>10/det_t b_ram(k)=sin((k-10/det_t)*0.01)*(0.01*0.5*pi*b_ram_limit); %b_ram(k)=b_ram(k-1)+0.01*0.5*pi*b_ram_limit/(5/det_t); %if b_ram(k)>0.01*0.5*pi*b_ram_limit % b_ram(k)=b_ram(k-1); %end end end %sensor fault fv_limit=2 %input('\nPLEAS INTER THE value of max bypass valve actuator fault(1%10%):') for k=1:interval/det_t; if k<=10/det_t; fv(k)=0; end %if k>10/det_t; % fv(k)=fv(k-1)+fv_limit/(10/det_t); % if fv(k)>fv_limit % fv(k)=fv(k-1); % end %end
85

if k>10/det_t fv(k)=sin((k-10/det_t)*0.01)*(fv_limit); end end Rv=0;%sqrt(0.01) v=Rv*randn(1,interval/det_t); %PI control parameter Kp_bypass=0.01; Ti_bypass=100; Kp_ram=2; Ti_ram=100; %time constant for sensor and actuator T_V=1.5; % Valve time constant T_T=2; % time constant for temperature sensor K_T=0; disp('ENTER THE INPUT NUMBER:'); disp('1. +20 deg. F step in bleed temperature'); disp('2. +20 deg. F step in ram air temperature'); disp('3. +5 psig step in bleed air inlet pressure') disp('4. +5 psig step in ram air inlet pressure') disp('5. +2 step load temperature setpoint') disp('6. +1% step in bleed air valve opening') Simu=0%input('\n'); P_in=OperatingCondition(OpConNum,1); % Bleed inlet pressure in psig T_amb=OperatingCondition(OpConNum,2); % Ambient temperature P_amb=OperatingCondition(OpConNum,3); % Ambient pressure Mach=OperatingCondition(OpConNum,4); % Mach number W_h=OperatingCondition(OpConNum,5)/60; % Total bleed flow in lb/sec T_hi=OperatingCondition(OpConNum,6); % Bleed air inlet temp. in deg. F T_ci=(T_amb+460)*(1+0.2*Mach^2)-460; % Ram air temperature (deg. F)

%sensor noise

%parameters d_bypass=1.5; % Valve diameter of bypass in inch d_ram=1.5; % Valve diameter of ram in inch R=639.6; % Gas constant, inch/Rankine g=9.80665/0.0254; % Gravity inch/sec^2 Gamma=1.4; F_rec=0.7; % Recovery factor pressure differential=0.7
86

C_H=0.24; C_C=0.24; K_bypass=pi/2/100; %actuator gain for bypass valve K_ram=pi/2/100; %actuator gain for ram air valve BR=0.1; %Bypass ratio

m_h=1; m_c=1;

%mass

%********************************************************************% % Initiallization starts here % %********************************************************************% %==============initialize the hot air bypass set point================% %flow rate% W_bleedmain=W_h*(1-BR); %hot air main mass flow rate W_bleedbypass=W_h*BR; %hot air bypass folw rate %pressure% P_hi=P_in+P_amb; % Bleed inlet pressure in psia P_load=P_hi-1.8*W_bleedmain^2-0.168*W_bleedmain; % pressure at load %valve opening angle% ratio_bypass=P_load/P_hi; % pressre ratio if ratio_bypass < 0.5283; ratio_bypass = 0.5283; end term_bypass=sqrt(((2*Gamma*g)/((Gamma-1)*R))*(ratio_bypass^(2/Gamma)ratio_bypass^((1+Gamma)/Gamma))); A_bypass=W_bleedbypass/((P_hi*term_bypass)/sqrt(T_hi+460)); Beta_bypass_c=acos(1-((4*A_bypass)/(pi*d_bypass^2))); %fault free valve opening angle u_bypass=Beta_bypass_c/K_bypass; %==============initialize the ram air set point=====================% %flowrate% W_ram=0.04; %ram air flow rate %pressure% P_co=P_amb; % dumping ram air into the atmosphere P_ci=(P_amb*((1+0.2*Mach^2)^3.5)-P_amb)*F_rec+P_amb; % Ram air pressure (psia) P_cin=2.058*W_ram^2+0.177*W_ram+P_co; % ram air valve downstream pressure %valve opening angle% ratio_ram=P_cin/P_ci; % pressre ratio if ratio_ram< 0.5283; ratio_ram = 0.5283; end
87

term_ram=sqrt(((2*Gamma*g)/((Gamma-1)*R))*(ratio_ram^(2/Gamma)ratio_ram^((1+Gamma)/Gamma))); A_ram=W_ram/((P_ci*term_ram)/sqrt(T_ci+460)); Beta_ram_c=acos(1-((4*A_ram)/(pi*d_ram^2))); %fault free valve opening angle u_ram=Beta_ram_c/K_ram; %============heat tranfer rate============================% [H_H,H_C]=H(W_bleedmain,W_ram); %calculation for heat transfer rate H_h=0.5; %heat transfer rate of hot side H_c=0.5; %heat transfer rate of cold side %=============outlet temperature of heat exchanger========% A=[W_bleedmain+H_h/C_H, -H_h/C_H;-H_c/C_C, W_ram+H_c/C_C]; B=[W_bleedmain*T_hi; W_ram*T_ci]; OUT=A\B; T_ho=OUT(1); T_co=OUT(2); T_load=(T_ho*W_bleedmain+T_hi*W_bleedbypass)/W_h; T_load_m=T_load; %================load pressure===================% P_load=P_hi-1.8*W_bleedmain^2-0.168*W_bleedmain; K_load=(P_load-P_amb)/W_h^2; %=============steady state value=================% P_hi_ss=P_hi; P_co_ss=P_co; P_ci_ss=P_ci; W_bleedmain_ss=W_bleedmain; W_bleedbypass_ss=W_bleedbypass; W_h_ss=W_h; W_ram_ss=W_ram; T_hi_ss=T_hi; T_ci_ss=T_ci; T_ho_ss=T_ho; T_co_ss=T_co; T_load_ss=T_load; u_bypass_ss=u_bypass; u_ram_ss=u_ram; Beta_bypass_ss=Beta_bypass_c; Beta_ram_ss=Beta_ram_c; term_bypass_ss=term_bypass; term_ram_ss=term_ram; %==============setup the disturbance=============%
88

d_T_hi=0; d_T_amb=0; d_P_in=0; d_P_amb=0; bypass_change=0; d_T_sp=0; if Simu==0; d_T_hi=0; end if Simu==1 d_T_hi=20; % Bleed air inlet temp. in deg. F elseif Simu==2 d_T_amb=20; % Ambient temperature elseif Simu==3 d_P_in=5; % Bleed inlet pressure in psig elseif Simu==4 d_P_amb=5; % Ambient pressure elseif Simu==5 d_T_sp=2 %load temperature setpoint elseif Simu==6 bypass_change=1 % percentage change of bypass valve opening end d_P_ci=((P_amb+d_P_amb)*((1+0.2*Mach^2)^3.5)(P_amb+d_P_amb))*F_rec+(P_amb+d_P_amb)-P_ci; d_T_ci=(T_amb+d_T_amb+460)*(1+0.2*Mach^2)-460-T_ci; d_P_hi=d_P_in+d_P_amb; T_hi=T_hi+d_T_hi; T_amb=T_amb+d_T_amb; T_ci=T_ci+d_T_ci; P_in=P_in+d_P_in; P_amb=P_amb+d_P_amb; P_ci=P_ci+d_P_ci; P_hi=P_hi+d_P_hi; u_bypass=u_bypass+bypass_change; %%%%%%%%%%%%%%Setup the setpoint%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% T_load_sp=T_load_ss+d_T_sp; u_bypass_sp=u_bypass_ss; %********************************************************************% % Nonlinear discrete-time model % %********************************************************************%

89

M2b=0; M2r=0; det_u_bypass=0; det_u_ram=0; for k=1:interval/det_t; %===========================valve fault==============% %Beta_bypass_c(k)=K_bypass*u_bypass(k); Beta_bypass(k)=Beta_bypass_c(k)+b_bypass(k); %Beta_ram_c(k)=K_ram*u_ram(k); Beta_ram(k)=Beta_ram_c(k)+b_ram(k);

%valve opening angle with fault %valve opening angle with fault

%===========================Mass flow rate==============% %ram air ratio_ram(k)=P_cin(k)/P_ci(k); % pressre ratio if ratio_ram(k) < 0.5283; ratio_ram(k)= 0.5283; end term_ram(k)=sqrt(((2*Gamma*g)/((Gamma-1)*R))*(ratio_ram(k)^(2/Gamma)ratio_ram(k)^((1+Gamma)/Gamma))); A_ram(k)=pi*d_ram^2*0.25*(1-cos(Beta_ram(k))); W_ram1=(A_ram(k)*P_ci(k))/(T_ci(k)+460)^0.5*term_ram(k); W_ram2=((0.177^2+4*(P_cin(k)-P_co(k))*2.058)^0.5-0.177)/(2*2.058); while (abs(W_ram1-W_ram2)>0.00001) if W_ram1>W_ram2 P_cin(k)=P_cin(k)+0.000001; else P_cin(k)=P_cin(k)-0.000001; end ratio_ram(k)=P_cin(k)/P_ci(k); % pressre ratio if ratio_ram(k) < 0.5283; ratio_ram(k)= 0.5283; end term_ram(k)=sqrt(((2*Gamma*g)/((Gamma-1)*R))*(ratio_ram(k)^(2/Gamma)ratio_ram(k)^((1+Gamma)/Gamma))); W_ram1=(A_ram(k)*P_ci(k))/(T_ci(k)+460)^0.5*term_ram(k); W_ram2=((0.177^2+4*(P_cin(k)-P_co(k))*2.058)^0.5-0.177)/(2*2.058); end W_ram(k)=(W_ram1+W_ram2)/2; %Bleed air A_bypass(k)=pi*d_bypass^2*0.25*(1-cos(Beta_bypass(k)));%bypass valve opening area %P_load(k)=P_hi(k)-1.8*W_bleedmain(k)^2-0.168*W_bleedmain(k); ratio_bypass(k)=P_load(k)/P_hi(k); %pressre ratio
90

if ratio_bypass(k) < 0.5283; ratio_bypass(k) = 0.5283; end term_bypass(k)=sqrt(((2*Gamma*g)/((Gamma-1)*R))*(ratio_bypass(k)^(2/Gamma)ratio_bypass(k)^((1+Gamma)/Gamma))); W_bleedbypass(k)=A_bypass(k)*P_hi(k)/(T_hi(k)+460)^0.5*term_bypass(k);%bypass flow rate (lb/s) W_h(k)=((abs(P_load(k)-P_amb(k)))/K_load)^(1/2)*sign(P_load(k)-P_amb(k));%total bleed air flow rate (lb/s) W_bleedmain(k)=(-0.168+sqrt(0.028224+7.2*(P_hi(k)-P_load(k))))/3.6; d_flow=(W_bleedmain(k)+W_bleedbypass(k))-W_h(k); while abs(d_flow)>0.000001; if d_flow>0; P_load(k)=P_load(k)+0.0000001; else P_load(k)=P_load(k)-0.0000001; end W_bleedmain(k)=(-0.168+sqrt(0.028224+7.2*(P_hi(k)-P_load(k))))/3.6; %main bleed air flow rate (lb/s) %Bypass flow ratio_bypass(k)=P_load(k)/P_hi(k); if ratio_bypass(k) < 0.5283; ratio_bypass(k) = 0.5283; end term_bypass(k)=sqrt(((2*Gamma*g)/((Gamma-1)*R))*(ratio_bypass(k)^(2/Gamma)ratio_bypass(k)^((1+Gamma)/Gamma))); W_bleedbypass(k)=(A_bypass(k)*P_hi(k)*term_bypass(k))/sqrt(T_hi(k)+460); W_h(k)=((abs(P_load(k)-P_amb(k)))/K_load)^(1/2)*sign(P_load(k)-P_amb(k)); d_flow=(W_bleedmain(k)+W_bleedbypass(k))-W_h(k); end BR(k)=W_bleedbypass(k)/W_h(k); %===============state and output equations=============% T_ho(k+1)=(W_bleedmain(k)*(T_hi(k)-T_ho(k))-H_h/C_H*(T_ho(k)T_co(k)))*det_t+T_ho(k); T_co(k+1)=(W_ram(k)*(T_ci(k)-T_co(k))-H_c/C_C*(T_co(k)-T_ho(k)))*det_t+T_co(k); T_load(k)=(T_ho(k)*(W_h(k)-W_bleedbypass(k))+T_hi(k)*W_bleedbypass(k))/W_h(k); T_load_m(k+1)=(1/T_T*T_load(k)1/T_T*T_load_m(k))*det_t+T_load_m(k);%temperature measurement from sensor T_load_s(k)=T_load_m(k)+fv(k)+v(k); %temperature sensor with fault if k==100 disp('k=100') end %===============PI control for temperature=============%
91

Temp_Error=(T_load_sp-T_load_s(k)); Bypass_Error=-det_u_bypass(k); error_ram(k)=Bypass_Error; % need to investigate the cancelling property of this statement, error_bypass(k)=Temp_Error; % temp_error can be negative,while bypass_error can be positive % ram air controller -------------------------------------------------M1r=Kp_ram*error_ram(k); M2r=M2r+((Kp_ram*error_ram(k))/Ti_ram)*det_t; det_u_ram(k+1)=M1r+M2r; u_ram(k+1)=u_ram(k)+det_u_ram(k+1); Beta_ram_c(k+1)=Beta_ram_c(k)+det_t/T_V*(K_ram*u_ram(k+1)-Beta_ram_c(k)); if Beta_ram_c(k+1)>0.5*pi Beta_ram_c(k+1)=0.5*pi; end if Beta_ram_c(k+1)<0 Beta_ram_c(k+1)=0; end % bypass controller --------------------------------------------------M1b=Kp_bypass*error_bypass(k); M2b=M2b+((Kp_bypass*error_bypass(k))/Ti_bypass)*det_t; det_u_bypass(k+1)=M1b+M2b; u_bypass(k+1)=u_bypass(k)+det_u_bypass(k+1); Beta_bypass_c(k+1)=Beta_bypass_c(k)+det_t/T_V*(K_bypass*u_bypass(k+1)Beta_bypass_c(k)); if Beta_bypass_c(k+1)>0.5*pi Beta_bypass_c(k+1)=0.5*pi; end if Beta_bypass_c(k+1)<0 Beta_bypass_c(k+1)=0; end %-----------------------------------------------------------------------

%===============to next step===========================% T_amb(k+1)=T_amb(k); T_ci(k+1)=T_ci(k); T_hi(k+1)=T_hi(k); %W_bleedmain(k+1)=W_bleedmain(k); W_h(k+1)=W_h(k); P_in(k+1)=P_in(k); P_amb(k+1)=P_amb(k); P_ci(k+1)=P_ci(k);
92

P_cin(k+1)=P_cin(k); P_co(k+1)=P_co(k); P_hi(k+1)=P_hi(k); P_load(k+1)=P_load(k); %u_bypass(k+1)=u_bypass(k); %u_ram(k+1)=u_ram(k); %v(k+1)=v(k); end %********************************************************************% % UKF algorithm % %********************************************************************% %parameters Afa=10^(-3); L=5; Beta=2; ki=0; la=Afa^2*(L+ki)-L; for i=1:2*L+1; if i==1 Ws(i)=la/(L+la); Wc(i)=la/(L+la)+(1-Afa^2+Beta); else Ws(i)=1/(2*(L+la)); Wc(i)=1/(2*(L+la)); end end %********************************************************************% % UKF-1 sensor fault % %********************************************************************% for k=1:interval/det_t; x=[T_ho(k);T_co(k)]; x_aa=[x;b_bypass(k);b_ram(k);v(k)]; y=[T_load_s(k);T_ho(k);T_co(k)]; %================residual generation================% if k==100; disp('k=100'); end if k==1 %initialization of state variable, covariance and output x_hat=x; %predicted state variable b_hat=[0;0]; %predicted actuator fault x_a_hat=[x_hat;b_hat]; %predicted augmented state variable
93

x_aa_hat=[x_hat;b_hat;0;]; %predicted augmented state variable P_aa=cov((x_aa-x_aa_hat)*(x_aa-x_aa_hat)');%augmented covariance y_hat=y; %predicted output else %correction of state estimates and covariance %x_a_hat(k|k) %P_a_hat(k|k) theta=[1;1;10^(-3);10^(-3)];%step constant 10^(-8) x_a_hat=x_a_hat+(K_a*(y-y_hat)); %P=P-K*P_y*K'; P_a=P_a-K_a*P_y*K_a'; x_aa_hat=[x_a_hat;v(k)]; P_aa=[P_a,zeros(L-1,1);zeros(1,L)]; x_hat=[x_aa_hat(1);x_aa_hat(2)]; b_hat=[x_a_hat(3);x_a_hat(4)]; end

%%%%%%%%%%%%%%%%%%%%%%%%%%converge%%%%%%%%%%%% %%%%%%%%%%%%%%%%%%%%%%%%% %%%%%%%%%%%%%%%%%%%%%%%%%%%%% T_load_m_hat1(k)=y_hat(1); T_ho_hat1(k)=x_a_hat(1); T_co_hat1(k)=x_a_hat(2); b_bypass_hat1(k)=x_a_hat(3); b_ram_hat1(k)=x_a_hat(4); %e_x1(k)=(x-x_hat)'*(x-x_hat); e1(k)=y(1)-y_hat(1); %e_ho1(k) %e_co2(k) %%%%%%%%%%%%%%%%%%%%%%%%%%%%%converge end%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%============sigma points============% k for i=1:2*L+1; if i==1; X_aa(:,i)=x_aa_hat; elseif 2<=i&i<=(L+1) X_aa(:,i)=x_aa_hat+Afa*sqrt(L*P_aa(:,(i-1))); elseif (L+2)<=i&i<=(2*L+1) X_aa(:,i)=x_aa_hat-Afa*sqrt(L*P_aa(:,(i-1-L))); end end

94

%===============Prediction Step================% %%%%X(k+1|k) X_T_ho=X_aa(1,:); X_T_co=X_aa(2,:); B_bypass=X_aa(3,:); B_ram=X_aa(4,:); B=[B_bypass;B_ram]; V=X_aa(5,:); X_Beta_bypass=Beta_bypass_c(k)+B_bypass; X_Beta_ram=Beta_ram_c(k)+B_ram; %valve opening angle with fault %valve opening angle with fault

X_A_bypass=pi*d_bypass^2*0.25*(1-cos(X_Beta_bypass)); X_A_ram=pi*d_ram^2*0.25*(1-cos(X_Beta_ram)); X_W_bleedbypass=(X_A_bypass*P_hi(k))/(T_hi(k)+460)^0.5.*term_bypass(k); X_W_bleedmain=W_h(k)-X_W_bleedbypass; X_W_ram=(X_A_ram*P_ci(k))./(T_ci(k)+460)^0.5.*term_ram(k); X_T_ho=(X_W_bleedmain.*(T_hi(k)-X_T_ho)-H_h/C_H*(X_T_hoX_T_co))*det_t+X_T_ho; X_T_co=(X_W_ram.*(T_ci(k)-X_T_co)-H_c/C_C*(X_T_co-X_T_ho))*det_t+X_T_co; X_T_load=(X_T_ho.*X_W_bleedmain+T_hi(k)*X_W_bleedbypass)/W_h(k+1); if k==1; X_T_load_m=X_T_load; end X_T_load_m=(1/T_T*X_T_load1/T_T*X_T_load_m)*det_t+X_T_load_m;%temperature measurement from sensor

X=[X_T_ho;X_T_co]; X_a=[X;B]; %predicted state and covariance %x_hat(k+1|k) %P(k+1|k) x_hat_o=0; %predicted state variable x_hat for i=1:2*L+1 x_hat=Ws(i)*X(:,i); x_hat=x_hat+x_hat_o; x_hat_o=x_hat; end

95

P_o=0; %predicted covariance P for i=1:2*L+1 P=Wc(i)*(X(:,i)-x_hat)*(X(:,i)-x_hat)'; P=P+P_o; P_o=P; end %x_a_hat(k+1|k) %P_a(k+1|k) b_hat=b_hat; %prediction of augmented state vector x_a_hat x_a_hat=[x_hat',b_hat']'; P_xb_o=0; %predicted covariance P_a for i=1:2*L+1 P_xb=Wc(i)*(X(:,i)-x_hat)*(B(:,i)-b_hat)'; P_xb=P_xb+P_xb_o; P_xb_o=P_xb; end P_bx_o=0; %predicted covariance P_a for i=1:2*L+1 P_bx=Wc(i)*(B(:,i)-b_hat)*(X(:,i)-x_hat)'; P_bx=P_bx+P_bx_o; P_bx_o=P_bx; end P_b_o=0; for i=1:2*L+1 P_b=Wc(i)*(B(:,i)-b_hat)*(B(:,i)-b_hat)'; P_b=P_b+P_b_o; P_b_o=P_b; end P_a=[P P_xb;P_bx P_b]; %output prediction %y_hat(k+1|k) Y1=X_T_load_m+V; Y2=X_T_ho; Y3=X_T_co; Y=[Y1;Y2;Y3]; y_hat_o=0; for i=1:2*L+1 y_hat=Ws(i)*Y(:,i); y_hat=y_hat+y_hat_o; y_hat_o=y_hat;
96

end %==============Correction Step====================% P_y_o=0; for i=1:2*L+1 P_y=Wc(i)*(Y(:,i)-y_hat)*(Y(:,i)-y_hat)'; P_y=P_y+P_y_o; P_y_o=P_y; end P_xy_o=0; for i=1:2*L+1 P_xy=Wc(i)*(X(:,i)-x_hat)*(Y(:,i)-y_hat)'; P_xy=P_xy+P_xy_o; P_xy_o=P_xy; end P_by_o=0; for i=1:2*L+1 P_by=Wc(i)*(B(:,i)-b_hat)*(Y(:,i)-y_hat)'; P_by=P_by+P_by_o; P_by_o=P_by; end P_xay_o=0; for i=1:2*L+1 P_xay=Wc(i)*(X_a(:,i)-x_a_hat)*(Y(:,i)-y_hat)'; P_xay=P_xay+P_xay_o; P_xay_o=P_xay; end %kalman filter gain K_a=[P_xay*inv(P_y)]; end %********************************************************************% % UKF-2 actuator fault % %********************************************************************% for k=1:interval/det_t; %x=[T_ho(k);T_co(k)]; %x_aa=[x;b_bypass(k);b_ram(k);v(k)]; y=[T_load_s(k);T_ho(k);T_co(k)]; %================residual generation================% if k==100; disp('k=100'); end
97

if k==1 %initialization of state variable, covariance and output x_hat=x; %predicted state variable %b_hat=[0;0]; b_hat=[10^(-12);0]; %predicted actuator fault x_a_hat=[x_hat;b_hat]; %predicted augmented state variable x_aa_hat=[x_hat;b_hat;0]; %predicted augmented state variable P_aa=cov((x_aa-x_aa_hat)*(x_aa-x_aa_hat)');%augmented covariance y_hat=y; %predicted output else %correction of state estimates and covariance %x_a_hat(k|k) %P_a_hat(k|k) theta=[1;1;10^(0);10^(0)];%step constant 10^(-8) e=y-y_hat; x_a_hat=x_a_hat+theta.*(K_a*(y-y_hat)); P_a=P_a-K_a*P_y*K_a'; x_aa_hat=[x_a_hat;v(k)]; P_aa=[P_a,zeros(4,1);zeros(1,4),0]; x_hat=[x_aa_hat(1);x_aa_hat(2)]; b_hat=[x_a_hat(3);x_a_hat(4)]; end

%%%%%%%%%%%%%%%%%%%%%%%%%%converge%%%%%%%%%%%% %%%%%%%%%%%%%%%%%%%%%%%%% %%%%%%%%%%%%%%%%%%%%%%%%%%%%% T_load_m_hat2(k)=y_hat(1); T_ho_hat2(k)=x_a_hat(1); T_co_hat2(k)=x_a_hat(2); b_bypass_hat2(k)=x_a_hat(3); b_ram_hat2(k)=x_a_hat(4); Beta_bypass_hat2(k)=Beta_bypass_c(k)+b_bypass_hat2(k); if Beta_bypass_hat2(k)>0.5*pi b_bypass_hat2(k)=0.5*pi-Beta_bypass_c(k); elseif Beta_bypass_hat2(k)<0 b_bypass_hat2(k)=-Beta_bypass_c(k); end Beta_ram_hat2(k)=Beta_ram_c(k)+b_ram_hat2(k); if Beta_ram_hat2(k)>0.5*pi b_ram_hat2(k)=0.5*pi-Beta_ram_c(k); elseif Beta_ram_hat2(k)<0 b_ram_hat2(k)=-Beta_ram_c(k); end

98

%%%%correction%%%%%%%%%%% %e_x2(k)=(x-x_hat)'*(x-x_hat); e2(k)=y(1)-y_hat(1);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% b_hat=[b_bypass_hat2(k);b_ram_hat2(k)]; x_a_hat=[x_hat;b_hat]; x_aa_hat=[x_a_hat;0]; %%%%%%%%%%%%%%%%%%%%%%%%%%%%%converge end%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%============sigma points============% k for i=1:2*L+1; if i==1; X_aa(:,i)=x_aa_hat; elseif 2<=i&i<=(L+1) X_aa(:,i)=x_aa_hat+Afa*sqrt(L*P_aa(:,(i-1))); elseif (L+2)<=i&i<=(2*L+1) X_aa(:,i)=x_aa_hat-Afa*sqrt(L*P_aa(:,(i-1-L))); end end %===============Prediction Step================% %%%%X(k+1|k) X_T_ho=X_aa(1,:); X_T_co=X_aa(2,:); B_bypass=X_aa(3,:); B_ram=X_aa(4,:); V=X_aa(5,:); X_Beta_bypass=Beta_bypass_c(k)+B_bypass; X_Beta_ram=Beta_ram_c(k)+B_ram; B_bypass=X_Beta_bypass-Beta_bypass_c(k+1); B_ram=X_Beta_ram-Beta_ram_c(k+1); X_A_bypass=pi*d_bypass^2*0.25*(1-cos(X_Beta_bypass)); X_A_ram=pi*d_ram^2*0.25*(1-cos(X_Beta_ram)); X_W_bleedbypass=(X_A_bypass*P_hi(k))/(T_hi(k)+460)^0.5.*term_bypass(k); X_W_bleedmain=W_h(k)-X_W_bleedbypass; X_W_ram=(X_A_ram*P_ci(k))./(T_ci(k)+460)^0.5.*term_ram(k);
99

%valve opening angle with fault %valve opening angle with fault

X_T_load=(X_T_ho.*X_W_bleedmain+T_hi(k)*X_W_bleedbypass)/W_h(k); if k==1; X_T_load_m=X_T_load; end X_T_load_m=(K_T/T_T*X_T_loadK_T/T_T*X_T_load_m)*det_t+X_T_load_m;%temperature measurement from sensor

X_T_ho=(X_W_bleedmain.*(T_hi(k)-X_T_ho)-H_h/C_H*(X_T_hoX_T_co))*det_t+X_T_ho; X_T_co=(X_W_ram.*(T_ci(k)-X_T_co)-H_c/C_C*(X_T_co-X_T_ho))*det_t+X_T_co; X=[X_T_ho;X_T_co]; B=[B_bypass;B_ram]; X_a=[X;B]; %predicted state and covariance %x_hat(k+1|k) %P(k+1|k) x_hat_o=0; %predicted state variable x_hat for i=1:2*L+1 x_hat=Ws(i)*X(:,i); x_hat=x_hat+x_hat_o; x_hat_o=x_hat; end P_o=0; %predicted covariance P for i=1:2*L+1 P=Wc(i)*(X(:,i)-x_hat)*(X(:,i)-x_hat)'; P=P+P_o; P_o=P; end %x_a_hat(k+1|k) %P_a(k+1|k) b_hat=b_hat; %prediction of augmented state vector x_a_hat x_a_hat=[x_hat',b_hat']'; P_xb_o=0; %predicted covariance P_a for i=1:2*L+1 P_xb=Wc(i)*(X(:,i)-x_hat)*(B(:,i)-b_hat)'; P_xb=P_xb+P_xb_o; P_xb_o=P_xb; end
100

P_bx_o=0; %predicted covariance P_a for i=1:2*L+1 P_bx=Wc(i)*(B(:,i)-b_hat)*(X(:,i)-x_hat)'; P_bx=P_bx+P_bx_o; P_bx_o=P_bx; end P_b_o=0; for i=1:2*L+1 P_b=Wc(i)*(B(:,i)-b_hat)*(B(:,i)-b_hat)'; P_b=P_b+P_b_o; P_b_o=P_b; end P_a=[P P_xb;P_xb P_b]; %output prediction %y_hat(k+1|k) Y1=X_T_load+V; Y2=X_T_ho; Y3=X_T_co; Y=[Y1;Y2;Y3]; y_hat_o=0; for i=1:2*L+1 y_hat=Ws(i)*Y(:,i); y_hat=y_hat+y_hat_o; y_hat_o=y_hat; end %==============Correction Step====================% P_y_o=0; for i=1:2*L+1 P_y=Wc(i)*(Y(:,i)-y_hat)*(Y(:,i)-y_hat)'; P_y=P_y+P_y_o; P_y_o=P_y; end P_xy_o=0; for i=1:2*L+1 P_xy=Wc(i)*(X(:,i)-x_hat)*(Y(:,i)-y_hat)'; P_xy=P_xy+P_xy_o; P_xy_o=P_xy; end P_by_o=0;
101

for i=1:2*L+1 P_by=Wc(i)*(B(:,i)-b_hat)*(Y(:,i)-y_hat)'; P_by=P_by+P_by_o; P_by_o=P_by; end P_xay_o=0; for i=1:2*L+1 P_xay=Wc(i)*(X_a(:,i)-x_a_hat)*(Y(:,i)-y_hat)'; P_xay=P_xay+P_xay_o; P_xay_o=P_xay; end %kalman filter gain K_a=[P_xay*inv(P_y)]; K_a(3,2)=0; K_a(3,3)=0; K_a(4,1)=0; K_a(4,2)=0; end T_ho_i=T_ho(1); T_co_i=T_co(1); b_bypass_hat2=real(b_bypass_hat2); b_ram_hat2=real(b_ram_hat2);

for k=1:interval/det_t; Beta_bypass_i(k)=Beta_bypass_c(k)+b_bypass_hat2(k); with fault Beta_ram_i(k)=Beta_ram_c(k)+b_ram_hat2(k); fault

%valve opening angle %valve opening angle with

if k==100 disp('k=100') end %===========================Mass flow rate==============% A_ram_i(k)=pi*d_ram^2*0.25*(1-cos(Beta_ram_i(k))); W_ram_i(k)=(A_ram_i(k)*P_ci(k))/(T_ci(k)+460)^0.5*term_ram(k);

%Bleed air A_bypass_i(k)=pi*d_bypass^2*0.25*(1-cos(Beta_bypass_i(k)));%bypass valve opening area W_bleedbypass_i(k)=A_bypass_i(k)*P_hi(k)/(T_hi(k)+460)^0.5*term_bypass(k);%bypa ss flow rate (lb/s)
102

W_bleedmain_i(k)=W_h(k)-W_bleedbypass_i(k); %===============state and output equations=============% T_ho_i(k+1)=(W_bleedmain_i(k)*(T_hi(k)-T_ho_i(k))-H_h/C_H*(T_ho_i(k)T_co_i(k)))*det_t+T_ho_i(k); T_co_i(k+1)=(W_ram_i(k)*(T_ci(k)-T_co_i(k))-H_c/C_C*(T_co_i(k)T_ho_i(k)))*det_t+T_co_i(k);

T_load_i(k)=(T_ho_i(k)*W_bleedmain_i(k)+T_hi(k)*W_bleedbypass_i(k))/W_h(k); if k==1; T_load_m_i(k)=T_load_i(k); end T_load_m_i(k+1)=(1/T_T*T_load_i(k)1/T_T*T_load_m_i(k))*det_t+T_load_m_i(k);%temperature measurement from sensor T_load_s_i(k)=T_load_m_i(k)+fv(k); %temperature measurement from sensor

end T_load_m_hat1=real(T_load_m_hat1); T_ho_hat1=real(T_ho_hat1); T_co_hat1=real(T_co_hat1); b_bypass_hat1=real(b_bypass_hat1); b_ram_hat1=real(b_ram_hat1); e1=real(e1); T_load_m_hat2=real(T_load_m_hat2); T_ho_hat2=real(T_ho_hat2); T_co_hat2=real(T_co_hat2); b_bypass_hat2=real(b_bypass_hat2); b_ram_hat2=real(b_ram_hat2); e2=real(e2); T_load=T_load'; T_load_s=T_load_s'; T_load_m_hat1=T_load_m_hat1'; T_load_m_hat2=T_load_m_hat2'; T_co=T_co'; T_co_hat1=T_co_hat1'; T_co_hat2=T_co_hat2'; T_ho=T_ho'; T_ho_hat1=T_ho_hat1'; T_ho_hat2=T_ho_hat2';
103

b_bypass_hat1=b_bypass_hat1'; b_bypass_hat2=b_bypass_hat2'; b_ram_hat1=b_ram_hat1'; b_ram_hat2=b_ram_hat2'; e1=e1'; e2=e2'; T_ho_i=T_ho_i'; T_co_i=T_co_i'; b_bypass=b_bypass'; b_ram=b_ram'; fv=fv'; e_T_ho=T_ho-T_ho_i; e_T_co=T_co-T_co_i; e_x=e_T_ho.^2+e_T_co.^2; DATA=[T_load_s(1:interval/det_t,1), T_load_m_hat1, T_load_m_hat2, T_ho(1:interval/det_t,1), T_ho_hat1, T_ho_hat2, T_co(1:interval/det_t,1), T_co_hat1, T_co_hat2, b_bypass, b_bypass_hat1,b_bypass_hat2, b_ram, b_ram_hat1, b_ram_hat2, fv, e1, e2, e_x(1:interval/det_t,1)] xlswrite('savedata.xls',DATA)

104

2. MATLAB script for heat exchanger fouling detection clear all clc N=10; det_t=0.1; %input('\nPLEAS INTER THE LEENGTH OF TIME STEP (et.0.1):'); interval=200; %duration for simulation % creation of the averaging matrix AVE for i=1:N; AVE(1,i)=1/N; end %parameters R=639.6; % Gas constant, inch/Rankine g=9.80665/0.0254; % Gravity inch/sec^2 Gamma=1.4; C_H=0.24; C_C=0.24; F_rec=0.7; % Recovery factor pressure differential=0.7 Mach=0.5; % Mach number M=1; m=M/(N*N); c_m=0.65; d_bypass=0.75;%1.5; % Valve diameter of bypass in inch d_ram=0.75;%1.5; % Valve diameter of ram in inch A_opened_bypass=pi*d_bypass^2/4; % bypass Valve full-open area in inch^2 A_opened_ram=pi*d_ram^2/4; % ram valve full-open area in inch^2 K_bypass=pi/2/100; %actuator gain for bypass valve K_ram=pi/2/100; %actuator gain for ram air valve T_V=1.5; % Valve time constant T_T=2; % time constant for temperature sensor K_T=1; % %PI control parameter Kp_bypass=0;%0.05;%0.01; Ti_bypass=50; Kp_ram=0;%2; Ti_ram=50; M2b=0; M2r=0; det_u_bypass=0; det_u_ram=0;
105

%%%%%%%%%%%%%%%%%%%%%%%%initial steady state value%%%%%%%%%%%%%%%%%%%%%%%% det_P_drop_ss=0.014748; BR_ss=0; %Bypass ratio T_amb_ss=70; % Ambient temperature T_hi_ss=135; % Bleed air inlet temp. in deg. F T_ci_ss=70; % Ram air temperature (deg. F) T_load_sp_ss=86; % temperature setpoint at the load P_in_ss=1.5; % Bleed inlet pressure in psig P_amb_ss=14.7; % Ambient pressure P_hi_ss=P_in_ss+P_amb_ss; % Bleed inlet pressure in psia P_cin_ss=20; P_ci_ss=25; P_co_ss=P_amb_ss; W_h_ss=0.02; % Total bleed flow in lb/sec W_ram_ss=0.03; % ram air flow in lb/s %disturbances disp('ENTER THE INPUT NUMBER:'); disp('1. +20 deg. F step in bleed temperature'); disp('2. +20 deg. F step in ram air temperature'); disp('3. +5 psig step in bleed air inlet pressure') disp('4. +5 psig step in ram air inlet pressure') disp('5. +2 step load temperature setpoint') disp('6. +1% step in bleed air valve opening') Simu=input('\n');

%********************************************************************% % Initiallization starts here % %********************************************************************% det_P_drop_h=0.01; b_bypass_hat_ss=0; %%%%%%%%%%%%%%%%%%%health heat exchagner initialization%%%%%%%%%%%%%%5 %bleed air% W_bleedmain_ss=W_h_ss*(1-BR_ss); %hot air main mass flow rate W_bleedbypass_ss=W_h_ss*BR_ss; %hot air bypass folw rate [H_H,H_C,C1,C2,C3,C4]=H(W_bleedmain_ss,W_ram_ss); [T_ho_ss,T_co_ss]=nonlinear_heat_exchanger(T_hi_ss,T_ci_ss,W_bleedmain_ss,W_ram _ss,H_H,H_C,C_H,C_C,m,c_m,N);
106

T_load_ss=(1-BR_ss)*T_ho_ss+BR_ss*T_hi_ss; while abs(T_load_ss-T_load_sp_ss)>0.001; if T_load_ss>T_load_sp_ss; BR_ss=BR_ss-0.00001; else BR_ss=BR_ss+0.00001; end W_bleedmain_ss=W_h_ss*(1-BR_ss); %hot air main mass flow rate [H_H,H_C,C1,C2,C3,C4]=H(W_bleedmain_ss,W_ram_ss); [T_ho_ss,T_co_ss,X_steady]=nonlinear_heat_exchanger(T_hi_ss,T_ci_ss,W_bleedmain_ ss,W_ram_ss,H_H,H_C,C_H,C_C,m,c_m,N); % call heat exchanger subroutine T_load_ss=(1-BR_ss)*T_ho_ss+BR_ss*T_hi_ss; end T_load_m_ss=T_load_ss; W_bleedbypass_ss=W_h_ss*BR_ss; %fouling caused pressure drop P_drop_h_ss=1.8*W_bleedmain_ss^2+0.168*W_bleedmain_ss+det_P_drop_ss+det_P_d rop_h; % bleed air side pressure drop through heat exchanger P_load_ss=P_hi_ss-P_drop_h_ss; % pressure at load %valve opening angle% ratio_bypass_ss=P_load_ss/P_hi_ss; % pressre ratio if ratio_bypass_ss < 0.5283; ratio_bypass_ss = 0.5283; end term_bypass_ss=sqrt(((2*Gamma*g)/((Gamma-1)*R))*(ratio_bypass_ss^(2/Gamma)ratio_bypass_ss^((1+Gamma)/Gamma))); A_bypass_ss=W_bleedbypass_ss/((P_hi_ss*term_bypass_ss)/sqrt(T_hi_ss+460)); Beta_bypass_c_ss=acos(1-((4*A_bypass_ss)/(pi*d_bypass^2))); %fault free valve opening angle u_bypass_ss=Beta_bypass_c_ss/K_bypass; %ram air% ratio_ram_ss=P_cin_ss/P_ci_ss; % pressre ratio if ratio_ram_ss < 0.5283; ratio_ram_ss = 0.5283; end term_ram_ss=sqrt(((2*Gamma*g)/((Gamma-1)*R))*(ratio_ram_ss^(2/Gamma)ratio_ram_ss^((1+Gamma)/Gamma))); A_ram_ss=W_ram_ss/((P_ci_ss*term_ram_ss)/sqrt(T_ci_ss+460)); Beta_ram_c_ss=acos(1-((4*A_ram_ss)/(pi*d_ram^2))); %fault free valve opening angle u_ram_ss=Beta_ram_c_ss/K_ram; %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% W_h=W_h_ss; W_ram=W_ram_ss;
107

P_co=P_co_ss; P_hi=P_hi_ss; P_ci=P_ci_ss; P_cin=P_cin_ss; P_amb=P_amb_ss; P_load=P_load_ss; T_amb=T_amb_ss; T_ci=T_ci_ss; T_hi=T_hi_ss; T_ho=T_ho_ss; T_co=T_co_ss; u_bypass=u_bypass_ss; Beta_bypass_c=Beta_bypass_c_ss; u_ram=u_ram_ss; Beta_ram_c=Beta_ram_c_ss; X_ss=X_steady; d_X=X_ss-X_steady; W_bleedmain=W_bleedmain_ss; %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% %==============setup the disturbance=============% d_T_hi=0; d_T_amb=0; d_P_in=0; d_P_amb=0; bypass_change=0; d_T_sp=0; if Simu==0; d_T_hi=0; end if Simu==1 d_T_hi=20; % Bleed air inlet temp. in deg. F elseif Simu==2 d_T_amb=20; % Ambient temperature elseif Simu==3 d_P_in=5; % Bleed inlet pressure in psig elseif Simu==4 d_P_amb=5; % Ambient pressure elseif Simu==5 d_T_sp=2 %load temperature setpoint
108

elseif Simu==6 bypass_change=1 % percentage change of bypass valve opening end d_P_ci=d_P_amb; d_T_ci=d_T_amb; d_P_hi=d_P_in+d_P_amb; T_hi=T_hi_ss+d_T_hi; T_amb=T_amb_ss+d_T_amb; T_ci=T_ci_ss+d_T_ci; P_amb=P_amb_ss+d_P_amb; P_ci=P_ci_ss+d_P_ci; P_hi=P_hi_ss+d_P_hi; u_bypass=u_bypass_ss+bypass_change; %%%%%%%%%%%%%%Setup the setpoint%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% T_load_sp=T_load_sp_ss+d_T_sp; T_load_m=T_load_ss; u_bypass_sp=u_bypass_ss; %********************************************************************% % Nonlinear discrete-time model % %********************************************************************% for k=1:interval/det_t; Beta_bypass(k)=Beta_bypass_c(k); Beta_ram(k)=Beta_ram_c(k); %===========================Mass flow rate==============% %ram air ratio_ram(k)=P_cin(k)/P_ci(k); % pressre ratio if ratio_ram(k) < 0.5283; ratio_ram(k)= 0.5283; end term_ram(k)=sqrt(((2*Gamma*g)/((Gamma-1)*R))*(ratio_ram(k)^(2/Gamma)ratio_ram(k)^((1+Gamma)/Gamma))); A_ram(k)=pi*d_ram^2*0.25*(1-cos(Beta_ram(k))); W_ram(k)=(A_ram(k)*P_ci(k))/(T_ci(k)+460)^0.5*term_ram(k); d_W_ram=W_ram(k)-W_ram_ss;

%Bleed air P_drop_h(k)=1.8*W_bleedmain(k)^2+0.168*W_bleedmain(k)+det_P_drop_ss+det_P_dr op_h;
109

P_load(k)=P_hi(k)-P_drop_h(k); ratio_bypass(k)=P_load(k)/P_hi(k); % pressre ratio if ratio_bypass(k)< 0.5283; ratio_bypass(k) = 0.5283; end term_bypass(k)=sqrt(((2*Gamma*g)/((Gamma-1)*R))*( ratio_bypass(k)^(2/Gamma)ratio_bypass(k)^((1+Gamma)/Gamma))); A_bypass(k)=pi*d_bypass^2*0.25*(1-cos(Beta_bypass(k)));%bypass valve opening area %W_bleedmain(k)=(-0.168+sqrt(0.028224+7.2*(P_hi(k)-P_load(k))))/3.6; W_bleedbypass(k)=A_bypass(k)*P_hi(k)/(T_hi(k)+460)^0.5*term_bypass(k);%bypass flow rate (lb/s) if W_bleedbypass(k)>=W_h(k); W_bleedbypass(k)=W_h(k); elseif W_bleedbypass(k)<=0 W_bleedbypass(k)=0 end W_bleedmain(k)=W_h(k)-W_bleedbypass(k); BR(k)=W_bleedbypass(k)/W_h(k); d_W_bleedmain=W_bleedmain(k)-W_bleedmain_ss; %===============state and output equations=============% [H_H,H_C,C1,C2,C3,C4]=H(W_bleedmain(k),W_ram(k)); [A,B,C,D]=ABCD(T_hi(k),T_ci(k),W_bleedmain(k),W_ram(k),X_steady,H_H,H_C,C_ H,C_C,m,c_m,C1,C2,C3,C4,N); U=[d_T_hi;d_T_ci;d_W_bleedmain;d_W_ram]; d_X=d_X+(A*d_X+B*U)*det_t; % update the state, ie. T_m Y=C*d_X+D*U; % calculate the output, T_ho det_T_ho(k)=Y; T_ho(k)=Y+T_ho_ss; if T_ho(k)<=T_ci(k); T_ho(k)=T_ci(k); end T_load(k)=(1-BR(k))*T_ho(k)+BR(k)*T_hi(k); if k==1 T_load_m(k)=T_load_ss; else T_load_m(k)=(K_T/T_T*T_load(k)-K_T/T_T*T_load_m(k-1))*det_t+T_load_m(k1);%temperature measurement from sensor end T_load_s(k)=T_load_m(k);

%===============PI control for temperature=============% Temp_Error=(T_load_sp-T_load(k));
110

Bypass_Error=-det_u_bypass(k); error_ram(k)=Bypass_Error; % need to investigate the cancelling property of this statement, error_bypass(k)=Temp_Error; % temp_error can be negative,while bypass_error can be positive % ram air controller -------------------------------------------------M1r=Kp_ram*error_ram(k); M2r=M2r+((Kp_ram*error_ram(k))/Ti_ram)*det_t; det_u_ram(k+1)=M1r+M2r; u_ram(k+1)=u_ram(k)+det_u_ram(k+1); Beta_ram_c(k+1)=Beta_ram_c(k)+det_t/T_V*(K_ram*u_ram(k+1)-Beta_ram_c(k)); if Beta_ram_c(k+1)>0.5*pi Beta_ram_c(k+1)=0.5*pi; end if Beta_ram_c(k+1)<0 Beta_ram_c(k+1)=0; end % bypass controller --------------------------------------------------M1b=Kp_bypass*error_bypass(k); M2b=M2b+((Kp_bypass*error_bypass(k))/Ti_bypass)*det_t; det_u_bypass(k+1)=M1b+M2b; u_bypass(k+1)=u_bypass(k)+det_u_bypass(k+1); Beta_bypass_c(k+1)=Beta_bypass_c(k)+det_t/T_V*(K_bypass*u_bypass(k+1)Beta_bypass_c(k)); if Beta_bypass_c(k+1)>0.5*pi Beta_bypass_c(k+1)=0.5*pi; elseif Beta_bypass_c(k+1)<0 Beta_bypass_c(k+1)=0; end %----------------------------------------------------------------------%u_ram(k+1)=u_ram(k); %Beta_ram_c(k+1)=Beta_ram_c(k)+det_t/T_V*(K_ram*u_ram(k+1)-Beta_ram_c(k)); %u_bypass(k+1)=u_bypass(k); %Beta_bypass_c(k+1)=Beta_bypass_c(k)+det_t/T_V*(K_bypass*u_bypass(k+1)Beta_bypass_c(k));

%===============to next step===========================% T_amb(k+1)=T_amb(k); T_ci(k+1)=T_ci(k); T_hi(k+1)=T_hi(k); W_h(k+1)=W_h(k); W_bleedmain(k+1)=W_bleedmain(k); P_amb(k+1)=P_amb(k);
111

P_ci(k+1)=P_ci(k); P_cin(k+1)=P_cin(k); P_co(k+1)=P_co(k); P_hi(k+1)=P_hi(k); P_load(k+1)=P_load(k); end Beta_bypass_matrix(i,:)=Beta_bypass_c; u_bypass_matrix(i,:)=u_bypass; T_load_matrix(i,:)=T_load; T_ho_matrix(i,:)=T_ho; W_bleedbypass_matrix(i,:)=W_bleedbypass; W_bleedmain_matrix(i,:)=W_bleedmain; W_h_matrix(i,:)=W_h; BR_matrix(i,:)=BR; P_load_matrix(i,:)=P_load; i=i+1; %end Beta_bypass_matrix=Beta_bypass_matrix'*(180/3.14); u_bypass_matrix=u_bypass_matrix'; T_load_matrix=T_load_matrix'; T_ho_matrix=T_ho_matrix'; W_bleedbypass_matrix=W_bleedbypass_matrix'; W_bleedmain_matrix=W_bleedmain_matrix'; W_h_matrix=W_h_matrix'; BR_matrix=BR_matrix'; P_load_matrix=P_load_matrix';

%********************************************************************% % EKF fault detection % %********************************************************************% %parameters Rv=0.0001; Qv=0.0001; %H= for k=1:interval/det_t; y=[T_ho(k);T_load_m(k)]; if k==1 x=[X_steady]; x_hat=x; %predicted state variable b_hat=0;%[0;0]; %predicted actuator fault x_a=[x;0]; x_a_hat=[x_hat;b_hat]; %predicted augmented state variable P_a=eye(N*N+1)*0.1;%cov((x_a-x_a_hat)*(x_a-x_a_hat)');%augmented covariance y_hat=y;%predicted output
112

else %update S=H*P_a*H'+eye(2)*Rv; K_a=P_a*H'*inv(S); x_a_hat=x_a_hat+K_a*(y-y_hat); P_a=(eye(N*N+1)-K_a*H)*P_a; end x_hat=x_a_hat(1:N*N); T_ho_hat=y_hat(1); T_load_m_hat(k)=y_hat(2); b_bypass_hat(k)=x_a_hat(N*N+1); %b_ram_hat(k)=x_a_hat(4); %predict(k+1|k) if k==1 Beta_bypass_hat(k)=Beta_bypass_c_ss; %Beta_ram_hat(k)=Beta_ram_c_ss; else Beta_bypass_hat(k)=Beta_bypass_hat(k1)+det_t/T_V*(K_bypass*(u_bypass(k)+b_bypass_hat(k))-Beta_bypass_hat(k-1)); %Beta_ram_hat(k)=Beta_ram_hat(k1)+det_t/T_V*(K_ram*(u_ram(k)+b_ram_hat(k))-Beta_ram_hat(k-1)); end %===========================Mass flow rate==============% %ram air %ratio_ram_hat(k)=P_cin(k)/P_ci(k); % pressre ratio %if ratio_ram_hat(k) < 0.5283; % ratio_ram_hat(k)= 0.5283; %end %term_ram_hat(k)=sqrt(((2*Gamma*g)/((Gamma1)*R))*(ratio_ram_hat(k)^(2/Gamma)-ratio_ram_hat(k)^((1+Gamma)/Gamma))); %A_ram_hat(k)=pi*d_ram^2*0.25*(1-cos(Beta_ram_hat(k))); W_ram_hat(k)=W_ram(k);%(A_ram_hat(k)*P_ci(k))/(T_ci(k)+460)^0.5*term_ram_hat( k);

%Bleed air P_drop_h_hat(k)=1.8*W_bleedmain(k)^2+0.168*W_bleedmain(k)+det_P_drop_ss; P_load_hat(k)=P_hi(k)-P_drop_h_hat(k); ratio_bypass_hat(k)=P_load_hat(k)/P_hi(k); % pressre ratio if ratio_bypass_hat(k)< 0.5283; ratio_bypass_hat(k) = 0.5283;
113

end term_bypass_hat(k)=sqrt(((2*Gamma*g)/((Gamma1)*R))*(ratio_bypass_hat(k)^(2/Gamma)-ratio_bypass_hat(k)^((1+Gamma)/Gamma))); A_bypass_hat(k)=pi*d_bypass^2*0.25*(1-cos(Beta_bypass_hat(k)));%bypass valve opening area %W_bleedmain(k)=(-0.168+sqrt(0.028224+7.2*(P_hi(k)-P_load(k))))/3.6; W_bleedbypass_hat(k)=A_bypass_hat(k)*P_hi(k)/(T_hi(k)+460)^0.5*term_bypass_hat( k);%bypass flow rate (lb/s) if W_bleedbypass_hat(k)>=W_h(k); W_bleedbypass_hat(k)=W_h(k); elseif W_bleedbypass_hat(k)<=0 W_bleedbypass_hat(k)=0 end W_bleedmain_hat(k)=W_h(k)-W_bleedbypass_hat(k); BR_hat(k)=W_bleedbypass_hat(k)/W_h(k);

%===============state and output equations=============% %[H_H,H_C,C1,C2,C3,C4]=H(W_bleedmain_hat(k),W_ram(k)); if (W_bleedmain_hat(k) <= 0.25 && W_ram_hat(k) < 0.10833); C1=0.993415638; C2=0.8718; C3=0.52682216; C4=0.4041; elseif (W_bleedmain_hat(k) > 0.25 && W_ram_hat(k) < 0.10833); C1=0.780612787; C2=0.6976; C3=0.822244343; C4=0.4041; elseif (W_bleedmain_hat(k) < 0.25 && W_ram_hat(k) > 0.10833) C1=0.993415638; C2=0.8718; C3=0.822244343; C4=0.6044; elseif (W_bleedmain_hat(k) > 0.25 && W_ram_hat(k) > 0.10833); C1=0.780612787; C2=0.6976; C3=0.822244343; C4=0.6044; end H_H=1*C1*W_bleedmain_hat(k)^C2; H_C=1*C3*W_ram_hat(k)^C4; %==================================================== [A,B,C,D]=ABCD(T_hi(k),T_ci(k),W_bleedmain_hat(k),W_ram_hat(k),X_steady,H_H, H_C,C_H,C_C,m,c_m,C1,C2,C3,C4,N);
114

d_W_bleedmain_hat=W_bleedmain_hat(k)-W_bleedmain_ss; d_W_ram_hat=W_ram_hat(k)-W_ram_ss; U=[d_T_hi;d_T_ci;d_W_bleedmain_hat;d_W_ram_hat]; d_X_hat=x_hat-X_ss; d_X_hat=d_X_hat+(A*d_X_hat+B*U)*det_t; % update the state, ie. T_m Y_hat=C*d_X_hat+D*U; % calculate the output, T_ho det_T_ho_hat(k)=Y_hat; T_ho_hat(k)=Y_hat+T_ho_ss; if T_ho_hat(k)<=T_ci(k); T_ho_hat(k)=T_ci(k); end T_load_hat(k)=(1-BR_hat(k))*T_ho_hat(k)+BR_hat(k)*T_hi(k); if k==1 T_load_m_hat(k)=T_load_ss; else T_load_m_hat(k)=(K_T/T_T*T_load_hat(k)-K_T/T_T*T_load_m_hat(k1))*det_t+T_load_m_hat(k-1);%temperature measurement from sensor end %T_load_s(k)=T_load_m(k); %================================================= y_hat=[T_ho_hat(k);T_load_m_hat(k)]; %Jacobian matrix F11=A*det_t+eye(N*N); F12=B(:,3).*det_t*P_hi(k)/(T_hi(k)+460)^0.5*term_bypass_hat(k)*K_bypass*pi*d_bypass^2 /4*sin(Beta_bypass_hat(k)); %F13=B(:,4)*det_t*(T_ci(k)T_co_hat(k))*P_cin(k)/(T_ci(k)+460)^0.5*term_ram_hat(k)*K_ram*pi*d_ram^2/4*sin( Beta_ram_hat(k)); F21=zeros(1,N*N); F22=1; %F23=0; %F31=0; %F32=0; %F33=1; F=[F11,F12;F21,F22]; H11=C; H12=D(3)*P_hi(k)/(T_hi(k)+460)^0.5*term_bypass_hat(k)*K_bypass*pi*d_bypass^2/4 *sin(Beta_bypass_hat(k));
115

%H13=0; H21=W_bleedmain_hat(k)/W_h(k)*C; H22=((T_ho_hat(k)+T_hi(k))/W_h(k))*P_hi(k)/(T_hi(k)+460)^0.5*term_bypass_hat(k)*K_byp ass*pi*d_bypass^2/4*sin(Beta_bypass_hat(k)); H=[H11,H12;H21,H22]; %Predicted estimate covariance P_a=F*P_a*F'+Qv; end

116

PUBLICATIONS

Journal Articles Shang, L., & Liu, G. (2010). Sensor and actuator fault detection and isolation for a high performance aircraft engine bleed air temperature control system. IEEE Transactions on Control Systems Technology, accepted for publication (August, 2010), IEEETCST 2010-0292. Shang, L., Liu, G., & Hodal, P. (2010). Development of high performance aircraft bleed air temperature control system with reduced ram air usage. IEEE Transactions on Control Systems Technology, 18(2), 438-445.

Journal Articles under Review Shang, L., & Liu, G. (2010). Control command based aircraft heat exchanger fouling detection. Journal of Aerospace Engineering. Submitted.

Conference Articles Shang, L., & Liu, G. (2010). Heat exchanger fouling detection in a simulated aircraft engine bleed air temperature control system. IEEE/ASME International Conference on Advanced Intelligent Mechatronics, MontrÃ©al, Canada, 774-778. Shang, L., & Liu, G. (2009). Valve control command based fouling detection of heat exchanger in an aircraft engine bleed air temperature control system. Proceedings of the IEEE International Conference on Automation and Logistics, Shenyang, China, 1852-1855.

117

Shang, L., & Liu, G. (2009). Sensor and actuator fault detection and isolation for a high performance aircraft engine bleed air temperature control system. 48th IEEE Conference on Decision and Control, Shanghai, China, 4888-4893. Shang, L., & Liu, G. (2007). Optimal control of a bleed air temperature regulation system. IEEE International Conference on Mechatronics and Automation, 2610-2615.

118


