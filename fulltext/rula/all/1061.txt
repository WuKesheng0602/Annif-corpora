Ryerson University

Digital Commons @ Ryerson
Theses and dissertations

1-1-2009

Nonlinear model predictive control of LDPE autoclave reactors
Noel C. Jacob
Ryerson University

Follow this and additional works at: http://digitalcommons.ryerson.ca/dissertations Part of the Polymer Science Commons Recommended Citation
Jacob, Noel C., "Nonlinear model predictive control of LDPE autoclave reactors" (2009). Theses and dissertations. Paper 616.

This Thesis is brought to you for free and open access by Digital Commons @ Ryerson. It has been accepted for inclusion in Theses and dissertations by an authorized administrator of Digital Commons @ Ryerson. For more information, please contact bcameron@ryerson.ca.

NONLINEAR MODEL PREDICTIVE CONTROL OF LDPE AUTOCLAVE REACTORS

by Noel C. J acob, B.Eng. Ryer:::on University, Toronto , ON , Canada

A

t h e~ i s

presented to

Ryerson University
in partial fulfillment of the requin:1nents

for the degree of Jviaster of Applied Science
Ill

Chem ical Enp;ineerinp;

Toronto , ON , Canada, 2009 © Noel C. J acob, 2009

PROP£RTYOF

qYERSON UNIVERSITY LIBRARY

iii

Author's Declaration
I hereb.Y declare that 1 a.rn t he so le au thor of t hi s t hesis. I a.ut hori z:e Rye rson Uni ve rsity to lend t liis t hesis to other institutions or individuals for the purpose of schola.rly research .

I further aut horiz:e Ryersou Uni versi ty to reproduce t hi!< t hesis by ph otocopving or by other mea ns.
in toL::tl or in p art. at t he request of other institutions or indi viduals for the pmpose of scho lar ly research.

v

Borrower's Page
RyP-rsou Uuivr.rsity requires the names and signa.turr.s of all persons usiug or photocopyiug
tl1i~

thesis. Please sign below and provide address and elate.

v ii

Abstract
Noel C . J acob , Mast er of Applied Science, Ryerson University, Toronto , 2000

P olymerizat ion reactors <Jre cha racteri zed by highly nonlin ear dyna mi cs. mul tiple operat ing regions, <J ild s igni fin111t interact.io JJ a llloll g the proce;;s vari Abl es , a nd a re the refo re, 1Jsuc1ll:v diAk ul t to cont rol effici entl y us in g con ve 11t ion a l li nea r process cont rol st rategies. ll is gt" nt-> ra.ll.v acce pted th at. nonlin ear control strategies a re required t o adequately handl e such
p roce~;~;e~;.

In t his work . we develop .

implement.. a mi eva luate via s imula.t ion a nonlinea.r modf·l predicL i vc con t rol (N J\·1 PC) fornmlalion for the control of two classes of commercia lly relevant low-density polyet hy lene (LDPE) a utoclave reactors, na mely, t he single, a nd multi-zone multi- fee d LDP E autocla ve react ors. \[ at hema tica l 111odels based on rigorous. fi rst-principl es mecha nisti c modeli ng of t he underlying react ion k inetics. prt! viousl.v deve loped by our rese;u ch group , were ex tended to describe t he d)rnami<: bd1av ior of the t wo LDPE Ru t oclavc reactors. Unsce nted K alm an fi lterin g (UKF ) bnsed state

est imat io n. not commonl y used in chemical engineering a ppli ca tions, was imp leme nted and foun<i to perform qui te well. The per fo rrn an (:e of t he proposed NlVIP C fonnu lat io11 was invest igated t hrough a se lect number of simulation cases on t he mathemat ical ' plant ' m odels. Th e result ing closedloop N iv!P C
p e r fonnF~.nc e

was compa red wit h performa nce obtained wil h conve ntiona l linear model

predi ct ive cont rol (LlVIP C) a mi pro port ional integra l--deri vat ive (PID ) co n t r o ll e r ~; . Th e resul ts of t he present st ud y indi cate t hat th e closed-loop di sturbance rejection a nd t rackin g performa nce delivered by t he Nl\1PC' algo rit hm is a sig ni fica nt improvement ove r t he a foreme ntio ned controllers.

Contents

Abstract List of Figures List of Tables 1 Introduction
] .1

vii xiii

XV

1

Research Object ives
Tlwsi~

:3

1. 2

Organization

,,
5
7

2

Literature Review
2.1 2.2 NMPC of Continu ous Polym erization n eactors Control of LOPE Autoclave n eactors . . . . . .

8
11

3

Mode l Deve lopment
3.1 n eaction Mechan ism 3. 1.1 3.1.2 3.1.3 3.1.4 l nit.iaLion ..

11
12 13 13
1 ~~

Pmpil!-!;at.ion . Termination . C hain Tra nsfe r

:3.2

Process lVIodeli11g . . . 3.2.1 Singl e-Zone Autoclave Model 3.2.1. 1 Notat ion .. .

14

16

20

X

CONTENTS

3.2 .2

Multi-Zone 1\:lu lti-Feed Autoclave =-- rode!
3.2.2.1

21

Notation .. . . . . . . .

24 25 30 32

4

Controlle r Formulation
4. 1

Nominal Formulation . OfisPL-free For mnlat. ion .
4.2 .1

4.2

Target Calculator. Regulator . . . . .

35
37

4.2.2

5

Sta t e Estimation
5. 1

39

Extended Ka lman F ilter
5.1. 1

40
42

P rediction . Correctiou .

5. 1. 2 5.2

43 44 46
49

Unscented Ka lman F ilter
5.2. 1

P rediction . Correctio11 .

5.2.2

6

Controller Imple m e ntation

51
59

7 R esults and Discussions
7.1

Single-Zone Autoclave
7.1. 1

62

Disturbance Model Design . Controller 'I\ming Parameters . Simulation Resul ts . . ..

65 66 70 78 78 78
80

7. 1. 2 7.1. 3 7.2

Mu lti-Zone Mulli-Feed Autoclave
7.2. 1

Dbturbauce l'vlodel Desigu . Controller Tuning Parameters . Simulation Resul ts . . . . .. .

7.2.2
7.2 .3

8

Conclus ions and Recomme ndations
8. 1

87 88

Recommendations

. ..

Nomenclature Bibliography

89
93

List of Figures
3.1
3.2
Single-zone LOPE autoclave reactor ..... .

15

Multi-zone multi-feed LDPE autoc lave re<tctor

22
28

tJ.l 4 .2

Illu;;tration of the control structure Int ernal vifw of thE'
0J~ IP C

block

33

5.1

ConLinuous-discre le exlended Kalman filler. . . . . . .. .

40
55

6.1

Global orthogonal co llocation . . . . . . . Orthogonal collocation on finite e lements

6.2

5G
6:3 61

7.1 7.2 7.:1 7.<1 7.5

Bifurcation d ia.g ram (single-zone a.utoc lave. feed ini tiator cone.) Bifurcation diagram (single-zone autoclave, feed temperature) EfTef'l of prE>dicl inn horizon on conl.rol perforrn F I.IlCP Effect of control horizon on <'Ontrol pcrforlllancc .. Dist. rejection (single-wne autoclave, feed temp. clist.) . Dist. rejection (single-zo ne a utocl ave, feed iniL. dist.) .. Dist. rejection (sing le-zone a u toclave, input dist. mode l) Dist. rejection (single-wne autoclave, plant-model mismatch) Dist. rejection (single-zone autoclave, plant-model mismatch)

67

G9
71 71

7.G
7. 7 7.8 7.9

73
7:3
71 75 75

7.1 U C losed-loop tnwking (single-;t,olle autoclave. mnltiple setpoi11ts) 7.11 C losed-loop Lracking (single-zone a nloclave . plant -model misma.l ch) .

xiv

LIST OF FIGURES

7.12 Closed-loop tracking (single-zone autoclave. LMPC failure exam ple) 7.13 Dist. reject ion (multi-zone autoclave. feed temp. clist .) 7.14 Dist. reject ion ( rnu lti-11o ne a utoclave, feed ini t. dist.) . 7.15 Dist. rejection (multi-w ne a utoclave, plant-model mismatch) 7.16 Dist. reject ion (multi-zone autoclave, plant-model mismatch) 7.17 C lo,;ed-loop tracking (lllulti-zon e autoclave. multip le setpo int s)

76

82
83

84
85

86

List of Tables
3.1 3.2 3.3 Reaction rate constant data . . . . . . . SinglP-wne autoclave model parameters M ulti-11one a.utoc:lave model parameters

18
21

2:3

Chapter 1

Introduction
Continuous polymer ization rt>actors
haw~

long been known to exhibit, highly complex and nonlinear

rlyuarnica.l behavior. For example, Schmidt a.nd Rily [7:3 j demonstrated the existence of multiple steady states in continuous isothermal methyl methacr:vlate
( ~:IIvii\)

solution polymerilmtion reac-

tors. Hamer, Akrarnov , and Hay [2G j extended Lhe results of Schmidt and Ray Lo the nonisoLhermal case, and showed the preseuce of multiple steady states and limit cycle oscillations in continuous
~vl l'v1A

and vinyl acetate (Vi\) polymerization systems. Russo and Bequette [7l j produced conditions

for observing input and output multiplicities in conLimwus styrene polymerization reactors. Ham and Rhee [25j studied the behavior of LDPE autoclave reactor;; and found , using an appropriate compartmental mixing model, the possibility of up to nine different steady states. However, linear con trol methodologies which have traditionally been used for chemical process control are fundamentally iucapable of dealing with the highly nonlinear behavior observed in many polymerization systems, oftentimes resulting in poor control performance. Furthermore , iL is we ll k11own that. the maximization of profitability of most. chemical processes demands operation in the vicinity of process constraints. For example. the rate of polymer product.ion, or equivalently monomer conversion. in LOPE autoclave reactors is ' maximized ' by operiltion at high temperatures. However , ethyleue decomposes extrelllely rapidly around 300"C leading to thermal runaway. which is a snfety constraint on the operation of the reactor. Other examples of process constraints include environJJlE'Ilta.l regulations , product
qua.lit~'

specifications, and input. saL-

2

1 Introduction

uration constraints, to name a few. Unfortunately, most conventional linear and nonlinear control algorithms do not account for the presence of constraints, potentiall.v leading to poor performance, and in certa.iu situations, instability. Over the past t.wo decades , model predictive control (l'dPC ) teclmology h<ls e1nerged as a general purpose control strategy for process control. 1viPC based on linear process models, or linear model predictive control (LIVIPC ), has been ext.raorrlinarily successfnl in the chemical process industries with nunif'J'OJJS reported applical ions, especii\lly in refinery and pel.rochemical opera.tions, where the degree of process nonlinearity is not 'too severe ' . The principal appeal of MPC as a control strategy for cheruica l processes sterns from it.s ab ili ty t.o explicitly haudle process and operational cons! raint.s within it.s fri1mework, leading Lo more efTkienL anrl profit able opPration . Despite the success of conventional UviPC , it is not recommended for systems that exhibit a high degree of process no11linearity, or for systems that are required to operate over a wide region, which is the case for most contiuuous polymeri;mtioH reactors. For such :,;ystem:;, it is esseutial to design COHtrol systems that take the nonlinear system dynamics into account over the operat ing range. Nonlinear model predictive control (NMPC) is an alternative to conventional LMPC. especially for situations where LMPC performs, or is expected to perform poorly. NMPC inherits many of the advantageous properties of LMPC , such as explicit handling of constraints , and intuitive treatment of multivariable (MllviO ) systems. However , instead of a local linear model, the N?v1PC controller utilii:eS a nonL-ineaT representation of the plant rlynamics i11 Lhe coHLroller framework. making it (at. le<:Jst. theoretically) appealing for processes with signific<:JIIt noiiiillec:ll'it. v. \Vhil e this would appear to be only a natural extension of :VIPC technology, it is clear from the significantly fewer industria.! applicatious that Nl\IPC has not had the level of industrial i1r1pact. that Ll\'1PC has had in the process industries [62 , 63]. Furthermore, while academic contributions to the theoretical understanding of NMPC have been subst.antia.l, relatively little work has been done by way of application (both experimental and simula.tion based) of 'modem' NMPC algoritl!rns
f(Jr

the control of chemie<ll processes , especially with

respect to continuous polymerization systems . Thus, the motivation behind t he present study is to investigate the performance of NMPC for the control of LOPE antocbwe reactors.

1.1 R ese a r ch Obj ect ives

3

1.1

R esearch Obj e ctives

The goal of t his study was to develop and test , t hrough simulations, a non linear model predictive cont rol scheme fo r the control of low-density polyet hy lene (LDPE) autoclave reactors. The ul timate
p r i <~e.

from au industri a l p ers pective. to be gain ed from t he implementat ion of a.dvaueed process

cont rol st rategies-such as N!viPC-on cont inuous p olymeri zation reactors is t hat it permi ts goo d contro l of 'polymer qua lity ' ind ices in t,he production
(po l y m eri <~Rt i on)

stage . In the current highl yi11 a. m a rked reductiou iu

comp et it ive ind ustr ial euviro nrn eut . good polymer qua lity cont.rol c·;ut

n~s ul t

degree of product vari a bili ty. and frequency of downst ream blendi ng operat ions d ue to product ion of off-spec prodttcL , potPnt ia lly leading to signi ficant cost savings [84 ]. T he indicato r of polymer qua.li t.Y chosen in t his st·ud y is t he polymer weight-averaged rn olec:ular weight. Inclu stri a lly, t he most frequent ly used indica tor of poly mer grade and end-usc propert ies is t he m elt fl ow index (1\.IFI ) or melt inclex (MI) . However, for a part icular polymer typ e, it. is us ua lly p ossible to develop fai rly
ac~ c ur a.te

correlations relat iug MFT to p olymer weiglt t-a.ve ra.ged molecular weight, t hus allowing clirect

conversion between th e two quant it ies. For example. t h e review papers of Shenoy a nd Saini [74. 75] list a nu mber of publi shed iVIFI correlations for polyet hy lenes. which is of interest. in t his stud y.

In t his wo rk. we consid er two classes of industria lly relevant LOPE autoclaves, name ly, si nglezone (or compact.). and mul t i- zone multi-feed reactors. In both cases we are primarily interested in applying a n Niv1PC formulat ion for t. he ro nlrol of t he reactor temperat ure (in case of t. he mu lt i-wne
n~a.ctor ,

t he temp era! ure pmfi.le). and t he p olymer weight-averaged molecu lar weight (controlled

Olt t pnts ). T he ri owrR t.es of the feed in iti Rtn r a ncl monomer stremn(s) were t.he cont.rol inputs (manipu lated vari a bles) selPcted t.o c!ri vf' the controlled ou t put.s to L hf'ir setpoints. distur bance rejectimt
~:~ nd

T he closecl-loop

setpoint (Tackin g perforrrum <:P of t he N\'IPC controller , for both LDPE

autoclave reactors, was investigated and compared wit h t he performance of conventiona l Ll'v1P C and PID cont ro llers.

4

1 Introduction

1.2

Thesis Organization

· Chapter 2 reviews some receut, relevant, industrial and academic contributions to the appli-

cation of N 1 IPC for the control of continuous
paid to LDPE autoclave reactors.

polymeri;~ation

!:iystem!:>, with special emphasis

· Chapter 3 briefly outlines the development of the nonlinear process models used in this work. The relevant reactiou mechanism , together with the single 1:1nd multi-zoue LDPE autoclave reactor models are presented. · Chapter 4 begins with a brief introduction to nonlinear model predictive control, followed by a detailed presentation of the controller formulation (algorithm) used in this work. · Chapter 5 provides details on the extended Kalmau rlltering ( EKF ), and unscented Kalman filtering (U KF) nonlinel\r st. ate estimation a.lgorithms employed in this study. · Chapter 6 addresses a number of issues relating to the implementation and closed-loop simulation of the NMPC controller, for e.g. model discretization, simulation structure, controller tuning, etc. · Chapter 7 presents and discnsses simulation results obtained from testing the NlviPC control system on both the single and multi-zone LDPE autoclaves. \Vherever possible , the closed- loop NMPC results are compared with conventional PID and L.MPC controllers. · Chapter 8 concludes this thesis with a few comments. and presents some recommendations for future work and improvements.

Chapter 2

Literature Review
T he t vvo b asic re(] ni reme nts of any model predicti ve cont ro l (l\ IP C) fo rnmlat io n a re. fi rst, an internal pnxlict.ion mo< kl. also rder rcd t.o al' process , or c·cm t-roll<· r rnorkl , a nd , second ,
Ft.

fin it0 hori zon

optim a l control, or dy nam ic opti mization , problem t hat must be solved online to determine cont rol inpu t t ra jectories which minimi;-;e a given , usua lly q ua dratic, cost fun ctiona l. The origins of MP C can b e traced back to t he early 1970s wit h t he development, in industry, of t he so called model pred ict ive heuristic cont rol (M PH C) , a nd competing d yn a mic matrix control (DMC) a lgori t hms [62]. Ever si nce, MP C has been a 'hot ' research a rea, wit h published research articles numbering many t housands. The interest ed reader is referred to t he pa p ers of Qin and Ba dgwell [62, 63] for a hi storical persp ective on t he current state of l\·1PC technology. In [63]. t he au t hors provide a nice overview of

indv.stdal a pplications of com mercia l N MPC software, which is of re leva nce Lo t his thesis.
The MPC control methodology is very 'general' . res ul t ing in t he development of nu mero us proposed co nt rol fornmlaLions in t he pu blished li teratu re. Fnr t hen no re, t remenrlons progress has bee n made in understimding t heoret ical MP C concepts , su ch as closed-loop stabili ty, op t im al ity, etcetera.. Obviously, a com prehensive rev iew of t hese topics is ou tside t he scope of t hi s work, and t he reader is referred Lo t he excellen L sm vey pa pers of DeN icolao et: a!. [14], and May ne et a !. [49] for more inform a.tiou . Linear rn odel predictive cont rol (LMP C), i. e. M P C based on linear process models. ha.s enj oyed tremend ous commercia l su ccess , wit h reportedly over 2000 industrial a pplications, es pecia ll y in ind us t r ies wit h 'moderate' degrees of process no nlin eari ty, s uch as t he refin ery a nd petrochemical

6

2 Literature Rev iew

businesl:l [63]. The literature dealing with theoretical and practical / implementational LJ'vfPC issues is vast, and is not reviewed here. The text of lVIaciejowski [43], and the software [4] provide a good introductory treatment of Ll'v1PC concepts.
IV!ATLAB

i'v1PC Toolbox 2

While significant. progress , mainly due to aca.dernia , has been made in understanding closed-loop
N~-IPC

properties (see for example [-18, 51, 50 , 10, 49, 14 , 83]) , this has not translated as yet into

wide industrial accepta.nce, as is quite clear from t.he significantly smaller number or applications compared to LMPC. Furthermore, academic contributions. both experimental and simulation-based , toward the application of recent NMPC technology has been somewhat limited. The latter is very surprising. especially in the context of chernic<tl / process and polyuter reaction engineering, since these processes exhibit strong nonlinear characteristics. which are quite difficult to handle using conventional control methodologies. However , there have been very good reasons for the reluctance in eiTibracing :\MPC despite its potential benefits. For instance , until recently, the online computation burden involved with l:lolving a potentially large nonlinear programming (NLP) problem online was prohibitively expensive. Another practical concern is the presence of nonconvexity and local minima in the underlying
optimi;~ation

problem , which i11 c:ertaiu cases can have disastrous consequences ,

for example reactor light-of!:'.

One can conclude that there still exists a strong need to demonslro.l.e, via experime11t and simulatiou, the efl'ectiveness a.nd robustness , or lack thereof of curreul NlVlPC fonnulat.ions for the control of chemical process systems , especially NMPC is large.
polymeri;~ation

systems where the potent in! for benefits front
N~lPC

This is Lhe motivation behind the presPnl research into t.hP

control of

LOPE c JUtoclave rea<.:tors . In thi:; review, we focus primarily ott literature dealing with Nl\lPC applications and l:lirnulation-based studies on conti11·uo'Us polymerization sy::;tems. However, since the amount of published research on NMPC control of continuous po lymerization reactors is actnally relatively small , we also inc:lude in tltis review a few relevant NMPC studies and applications on other chemical processes. Note that we do not review the growing literature on NMPC control of batch polymerization systems, where the impact NMPC: could be just as significant.

2.1 NMPC of Continuous Polymerization Reactors

7

2.1

NMPC of Continuous Polymerization Reactors

Alm, Park. and Rhce [1] com pared experimentally the closed- loop performa nce of NMPC, LMPC . and PlD controllers for the control of monomer conversion ami polymer weight-averaged molecular weight in a lab-scale contin uous methyl methacrylate (MlV!A ) so lut ion polymeri zation reactor. Their extended Kal!n an filter (EKF ) based NT\ !PC scheme utilized a detai led first-principles nonlinear process model coupler! with inpu Ljout.puL disturba nces to pred ict. futme plant behavior. Estimates of conversion and molecu lar weight were obtain ed inferenti a.lly using
Jll l'llSUrt' III CJit s,

onlim~

density aud viscosity

respectively. The results

~;bowed

siguifica.nt i111provement in closed-l oop performance

of Lhe

~lV!PC

con troller. over t.he Ll\:!PC and PID con trollers. for both servo a nd regulatory control.

The research group of Prof. Bequette at Rensselaer Polytechnic Institute has worked extensively on modeling anrl control of stynme polyrnerizH.tion systems. In particular, the articles Russo and Bequette [70], Schley, Pras<~d , Russo. and Bequette [72], tmd Prasad, Schley, Russo , and Bequette [6 1] describe the application of an EKF based nonlinear quad ratic dynamic matrix control (NL-QDiv!C) a pproach , proposed b.v Lee and Ricker [42], for t he control number-averaged ru olecular weight a nd other polymer properties, ;;uch as polydispersity, in continuously sti rred styrene polymerimtion reactors. They show. through simulations , that NL-QD tiC controller performs adcquatcl.v well in disturbance rejection and setpoint tracking situations . DenAmor , Doyle Ill , and IvkFarlane [5] reporls on an industrially-relevant simulation-based stud y 111 which the problen1 of grade transit ion control in
polymeri~<~tion

reactors is consid ered t hrough

t he coupling of an indust,rial real-time optim ization (RTO ) package-Rigorous Online Modeling and eqnation-based
optimi~at

ion (R.Ol\-l eo)-with an NMPC control system.

The goal of their work

was ·'to demonstrate that these (control) algor ithm;; can be incorporated into the framework of commercial grade software for on line applications'' . The performance of t heir RTO-Ntv'!PC-basccl conlrol scheme in polymer grade transition situations was tested using contin uously st irred l'v1.tv1A , a iid gas-ph ase
Huidi~cd

hod !Jolyetilylcne rcl:lctor mode ls. The sinnil ll.t ion

re~;ults ~; b owed

that their

recedi ng horizon est.imation (RH E) based controller provided good tracking performance , even in t. he presence of reasonable morlel mismatch and measurement noise. Ali , Abasaeed , and Al-Zahrani [2] applied an NL-QDMC contro l scheme due to Ali and Zafiriou [3]

8

2 Literature Review

for the stabilization of gas-phase polyethylene reactors . They showed , using simulations, that multiloop PI cont rol resulted in unacceptable closed-loop performance. potentially leading to reactor light-ofT, eve n for re latively Sll la.ll process disturba.11ces. Furt.hennure, usi11g PI controllers, it was not possible to utilize all avail able degrees of freedom due to the nonsquare nature of the reactor model. The designed NL- QDiviC scheme was shown to posses excellent closed-loop disturbance rejection and setpoint tracking properties, in addition to being ab le to take advantage of t ile nonsquare plant.

2.2

Control of LDPE Autoclave Reactors

Whil e several research papers have been published dealing with advanced control of styrene and MI\·1A polymerizat ion reactors. comparatively very li LLie has bee11 done in the area of high-pressure L.DPE autoclave rea.cLors. · One of first publisl1ed works on the cont rol of LDP8 autoclaves was that of l\·1ariui and Georgakis [·15 , !lti], where they considered the problem of ternperature control in irnperfecLly-rnixed sing le-zone autoclaves. They show that. classical Pl controllers are iu capable of stabilizing t he system over a wide operating range, and , frorn system dyJlamic;; con;;idera.tions. propose a so called 'reaction rate controller', which is able to adequately control the reactor temperature over a wide range. This work, ho wever , did not 'directly' consider molecular or end-use properties of the polymer, which is very important in iudust rial ap plications. Berber and Coskun [6] investigated , via simulations. the contro l of reactor t.t>mperat.me profile in a three-zone multi-feed autoclave using a linear QDMC controller. The tem peratures in each zone we re controlled by manipulating initiator feed rates to t he respective zones. Again. d irect online control of polymer molecular properties was not considered in the study. Their simu lations showed that the QDJ'viC control scheme deli vered super ior closed-loop regu latory and servo performance compared to PI control. It must be noted t hat t he results in their study indicate an unusually slow, damped response under PI control , wh ich might have more to do with over-conservative Luning t han poor performance. Ham am! Rhee [2.5] used a two-compartment four-cell cornpart m eutal mix ing scherue to model the dynamical behavior of so called slim-type LDPE autoclave reactors. They performed one and two-parameter continuatio n analyses in order to st.udy the steady state characteristics of the reactor

2.2 Control of LDPE Autoclave Reactors

9

model. In addition , they developed PID and pole placement controll ers for t he control of the reactor temperature. The showed, t hrough simulations using t he multi-compart m ent reactor model, that t he pole placement contro ller yielded better closed-loop performance than the PID controller in reactor startup and ;;etpoint tracking situations. Singstad, Nordhus, Strand, Lien. Lyngmo, and l'v1oen [76] presents details about a collaborative project between SfNTEF A ntomatic Control and
STAT OTI~

Petrochl-!rnicab and Plastics on thl-!
;;~·stem

development and cumm is;;ioning of a rnu ltivariable nonlinear control

for STATOILs LOPE

a utoc lave reactors in I3a.mble. Norway. The mul t ileve l control scheme is designed to control temperaLurP profiiP and product io11 ratl-!s aL Lile ba:-;it· level , <;t.11d poly1nl-!r qualit.v propl-!rt ies at t. ill-! supervisory level. The control strategy is based on the well known feedback
lineari<~at.ion.

or internal nonlin ear

decoupling, a pproach , whereby the nonlinear model is transformed into an equivalent linear system by appropriate nonlinear trans formations. Resul ts from the irnpl ernenta.t.ion of t.his strategy on t he actual plant show a considerable reduction in production of off-spec product. Singstad eta!. [76] also presents simulation resul ts which show the feedback performance comp ared to multi-loop PID control.
lin ea ri ~at i o n

strategy provides superior control

--

Chapter 3

Model Development
The polymerization of ethy lene in a LDPE autoclave reactors fol lows the well-established free-radical chain growth reaction mechanism . Free-radical polymerization takes place in t he presence of one or more iuitia.tors, such as benzoy l peroxide (BPO ) and dioctanoyl p<:roxide (DCT), which dissociate into primary rad icals in the reaction mixture. Primary radicals react readily with free monomer molecules generating growing (or live) polymer radicals which sequentially add monomeric units to t he polymer chain. In t.his Chil.pt.er, 'Ne briefly describe t.he polymerization ·r·eaction mecha.rrisrn. and t he resulting proces8 model used in this study. For a more comprehensive discussion of free-radical polymerization. the reader is deferred to the text.s of Knma.r a.ncl Gupta [39]. and Hudin [69]. The dP-tails prP.sP-nted in this C h::tptP-r ]pan hP-;wily Al-\'idawy
011

thP- work of Dllib. Gao . and Penlidis [16], Dhih and

[lfi]. n.nd 1\hazrnei

n1HI

Dhib [37], which deal srwcificall.v wit.h Lhe iss ne of free-radical

polymer ization in the cont.ex( of LDPE reactors.

3.1

Reaction Mechanism

The free-radical LDPE production Lakes place at extremely harsh temperature and pressme conditious when the t herrnodyJia.m ics of the reaction favor the polymerization of ethy lene. Commercial autoclave a.nd tubular reactors usually operate in the vicinity of around 150- 270° C and l -100- 2000bar.
T11

order to develop first-princ iples , mechanistic pmcess mode ls capable of adeqna.tely describing t he

12

3 Model Development

dynamic behavior of LDPE autoclave reactors, it is first necessary to postulate an experimentally vcrificrl kinetic reaction mechanism. The overall reaction merhnnism ran be rlassifiecl into four disti nct parts, namely, initiation , propagation, tenn ill< 1tion, and chain transfer. In this Section , these
reaction~

will be

discu~~ed

in greater detail.

3.1.1

Initiation

The iniLi aLion stage refers to the generation of monomeric radicals R 1 from free monomer molecules in the reaction mixture. Iu general, initiation can occur in one of two ways, chem-ical and self initi ation . Though the cH'ect of chemical initiation usually ontwcighs that of self ini t iation. both are considered in this reaction mechanism.

Chemical Initiation

Free-radical as
initiator~

pol yrneri:.~atio n~

a re usually a ided through the additiou of chemical compounds known
initiator~ i~ to

to the reacting mixture. The function of

supply primary rad icals R,, to

the system, which then combine with monomer rnoleritles t.o generate lliunomeric radicals. P rima.ry radicals are
u~ually

generated by the lwrnoly tic decomposition of initiat.or molecules as seeu in

equation (3.la) below. The most common initiators arc azo and peroxide based , though redox initiators are used occasionally [39].

I

--=----->
/(J

I<o

2 R,,

(3. la)

R;,, + llf --=---->. R 1

(3.1 b)

We assume that the peroxide initiator- dioctanoyl peroxide-is used to initiat.e polymerization in the LDPE autoclave reactors modeled in this study.

Self Initiation

At high temperatures , monomer molecules spontaneously react to form monomeric radicals. This process is called self initiation , and can be represented by equation ( 3.2) below.
3M
_ I< _'c::.''___,

21?1

(3.2 )

3.1 Reaction Mechanism

13

3.1.2

Propagation

In t he propagation stage, li ve polymer radicals grow in size through the sequ ential additio n of monomer molecules at t he active cent.er of the growing chain. This process can be represented for polymer chains of any kmgth by equation (3.3 ) below [15 , :37]

Rn + M

K,
------+ R n + l

3.1.3

Termination

Terminat.ion refers to reactions in which two live polymer radicals mutually ann ihilate each other resuiLing in the formation of dead polymer. There are t.wo Lypes of (.ermination reactions , romb·i nation and dispT'Opo ·r tionation. In this wo rk . we assume that chain termi nation occurs primarily via

t he combination mechanism .
(3.4)

3.1.4

Chain Transfer
n~act i ons

Chain transfer reactions are

in which t.he

ac~tive

center of growing radical chains are trans-

ferred to another molecule, or another location on the growi ng polymer chain.

Transfer to Monome r
T he active center of growing polymer chains can be transferred to free monomer molecules, which act as transfer agent.s. resulting in t.he format ion of dead polym er and monomeric radicals.

Rn

+ 1'{ 1

----->

Kfn-.

Pn

+ R1

(3.5)

Transfer to Polymer
Dead p olymer chains can revert back into growing polymer radicals by transfer of the active center from the growing radical to the dead polymer. Transfer to p olymer reactions are responsible for t he l'orrnat.ion o r long chain Lra.nching (LC:B), which can significant ly offect po lymer microstructure an d molecular weight distribution (MWD ).

(3.6)

14

3 Model Development

(1- Scission to Secondary Radicals Ueta scission of live polymer rad icals essentially results in thP formation of dead polymer chains Pn together wit h monomeric radicals fl. 1 as seen in equation (3.7) below.

- - ---. P, + l?1

/( ;~

(3.7)

Intramolecular Transfer Intramo lecular t ransfer , also known as backbiting. refers to the reaction in which the active center at t he end of a growing polymer radical is trans ferred to an internal - CH 2 - group in the polyrner chain . resulting in the formation of short chain branched (SCB) polymer microstructure. (3 .8)

3.2

Process Modeling

Depending on t he chosen reactor configuration, the reaction nt echanisrn postulated in the previous Section can be
ut ili :.~ed

to develop kinetic lllodels describing t he dynamic behavior of the reaction

system. Prior to presenting details on the mathematical mode ling of LDPE au toclaves. it is beneficial t.o discuss some characteristic features of these reactors. The principal feature of the imhtsl rial LDPE autoclave is that the reactor operates, to a very good approxirno.tion , adi abatically. Tliis can be attribu ted to t he fact that the thick reactor walls required to wit hstand the high operat ing pressures prevent heal transfer from the reaction mixture [88]. Consequently, external cooling jackets which are com mon in other stirred
polymeri:.~ation

reactors cannot be used to remove heat from the systern.

The only cooling source avai lable to t he reactor is the cool monomer feed strearn(s), which typically enter at about 30- 40°C. The author is only aware of one publication , that of Lee. Ham , Chang, Kim , and Rhee [41], which invwtigated the behavior of compact LDPE autoclaves model with

inter'nal cooling jackets. However , such configurations arc not cornrnon in indnstr:v. and t herefore ,
not considered in t his study. The decomposition of ethylene into byproducts such as ethane, methane. carbon, and hydrogen lJecomes signitica.nt at te111pe ratures in the rang<.' of :300°C . The decom posit ion react ions are highly

3.2 Process Modeling

15

exothermic, occur extremely rapidly, and if ini tiated. can resu lt in reactor runaway in the order of just a few seconds. The problem of ethylene decomposition is crit ically important in LDPE autoclave reactors, as opposed to, for example , tubular reactors , due to the adiabatic nature of the reactor. However, ethylene conversion is maximized by operation at higher temperatures , therefore, comrnercia! LDPE autoclaves arc usually operated close to the boundary where decomposition dynamics becorne dominant. Once ini tiated, etliylene decomposition is essentially impossibl e to control, a11d reactor runaway is inevitable, t herefore. from a process contro l perspective. t he modeling of decomposition kinetics is of limited usefulness , and was therefore , not attempted in this work. Zhang, Read, and Ray [88], Villa, Dihora, and Ray [85], and Lee . Yeo, and Cha11g [40] , are exa.rnples of modeling studies which account for ethylene decomposition kinetics in the reaction mechanism . The residence time in most LDPE autoclave reactors is normally in the 1- 2min range , and is, quite often, lower depending on t he particular reaction conditions. The monomer conversion attained is relatively low , often only in the 10-20% range . Higher residence times (and conversions), while desirable, are accompanied by higher operating temperatures (clue to t he absence of reactor cooling ), which is undesirable, since it moves the system closer to iu stability. In t.he followiug Sl!bsec:tions, we
present. bricfty, first-priuciplcs based clyuamic lllOdcls deve loped for two classes of LDPE autoclave
n~aeL ors ,

nan1ely. single-<:onf' auLodavPs . and mnlti-<:one mn!Li-fePd a.utoelaves.

:

~--r::d ~----------0

--q

~----------------------

Figure 3.1: Single-zone (compact) LDPE autoclave reactor showing the contro ller, meas urements. and eon( rol inputs.

16

3 Model Development

3.2.1

Single-Zone Autoclave Model

Single-wne , or coTilpact, LOPE autoc laves are well-agitated high-pressure vessels wit h relat ively low L/ D ratios, usual!)' in t he neighborhood of around 2-.'Jm/ m [41 ]. The pressurized monomer and initiator feed streams typically enter from the Lop of the reactor , while t he prod uced polymer n.ncl llllconsllmerl rPacLaiii.s arf' sip honed off l'rom the bot to1n. F igmf' :3 .1 shows a simple scliei natic of a typical single-zone autoclave reactor. In certain situations, cha in transfer agents ( CTA), such as solven ts, are a lso fed L o the reactor in order to modify properties of the polymer obtainecl, bowever, we did no t consider such cases in the present study. Despi te t he high agitation power input supplied to t he reactor , t he compact autoc:lave cannot be considered completely well-mixed. In fact , experiment al results and comp utational fluid dy namics (CF D) simulation studies [66] point to the existence of concentrat ion and tem perat ure gradients inside t he reactor. Compartmental mixing models, in which t he reactor vol ume is partitioned into two or more wellmixed compartments (or cells), are by far, the most commonly employed practice in the mo deling of imperfect mixing in LDPE autoc:laves, see for example [45, 85, 87, 41 ]. The choice of compartment shape a nd size can be made based on reactor design cousiderat.ious , experimenta l evidence, or from CFD studies. In t he follow ing, for the sake of simp licity, we present t he dynamic model pertaining to the case of t he perfectly-mixed reactor. Note that this model can be extended quite easily to include mult iple compartments. The following assumptions were made in t he modeling of t he LDPE a.utoc:lave reactor · The reaction mixt ure is perfectly mixed , i. e. t here are no concent ration or temperature gradients inside the reactor. · The density of the reaction mixture , while temperature and pressure dependent, does not change appreciably with time, i.e. t here is negligible mass accumul ation in t he reactor [59]. · Heat effects due to mechanical agitation, chemical and thermal initiation , terminat ion , and chain transfer reactions are negligible compared to the heat of polymerization. · The reaction mixture behaves as a single-phase system , I. e. t he contribut ion of the polymer phase to t he overall kinet ics is minimal.

3.2 Process Modeling

17

· Diffusiorwl effects on tile poly1nerization kinetics are negligible , i.e. the cage and Trornrnsdorff

gd rffer.ts Rre i1 bsent.
h~tl a.uces re~tcting

Using lhese a.ssmn pt. ions, si rn ple molar a nd energy

on the

spec ies can be performed

to yield equations (3.9) to (3 .12) for the single-zone reactor. Here , I is the initiator concentration in the react.or, !vf is the free monomer concentration. A/1. is the 'total' monomer concentrat.ion , and

T is the reactor temperature.

di
- dt

dl

=

rr + (qJJI- ql) / V
rM

(3.!))

dl'v!

=

+ (qJ .. Mr . ,., . - qM )/ V

(3. 10)

dM1 dt

=

·r.r\11,
7'r

+ ( !J.f"" M.r -

ql\11 ) / V

(3 .]] )
(3. 12)

-i
( .l

dT

=

+ (qJT.r- qT) / V

The total monomer concentration N1 1 refers to the ·combined' concentration of free monomer , and bound mononwr in growing and
de~td

polymer chains. Th e notation !J.fx dfmotrs the fred Aowrat.r

of component. X. and XI denotes the corresponding feed concentration. The total feed and exit Aowratcs are given by
{j.f

all(l q, respectively.

The notation rx refers to the rate of produc-

tion/consumpt ion (or rate of change) of component X.

(3. 13)
TAJ =

- K pMAo

(3.14)

(3.15)
(3.16)
The l1eat of polymeri:~:ation ( - ~H p) is a function of t he reactor temperatu re and pressure conditions given by the corre lation [3 7]

( - .6.Hr,) = 84185

+ 0.209 (T

- 273)

+ fl.lO:iP

(3.17 )

The density of the rf'ad ion mixwre p is also a function of the reactor temperature and pressure

18

3 Model Development

given by the correlation [20)
p = Hl95.8- 26l.llog

C~o) + 257. 7log ( ~)

- 63.3log

C:Oo)

log (

~)

(3. 18)

The heat capacity Cp of the reaction mixture is given by t he correlat ion [36) (3. l!J) Here,
.EM

oenotes the fr al't iou al IIJOIIOlllel' conversion acllicvcu ill the rca.ctor uchued by (3.20)

The tem perat ure and pressure depemlence of the react ion rate constants I<:.: is given by a modified form of the Arrhenius rate equation. I<= A exp ( - E a/ RT - t:.vP / RT ) (3 .21 )

Here, A is the preexponential factor , E a is the activat ion energy, t:.v is the activation volume, and

R is the universal gas constanl. The kinetic rate law
in Table 3.1.

param e t e r ~

for the above equaL ion are given

Equations (3.9) to (3. 12) obtained from molar and ene rgy balances adeq uately describe the open-loop dynamics of Lhe reactor temperature. and t he initiator , and free and ·total ' monomer concentrations. However , rnolar and energy balances do not provide any inf'onnatiou on the properties of the polymer (LDPE) produced . In fact , it is impossible to use mol ar balance techniques to obtain information about the polymer as al any point in time there t>xists a dist·ribut· ion, known as a chain

Table 3.1: Reaction rate constant data [15)

A
J<.:,l
K th

Ea
14

1.83 X 10 6.0<-lx 10:l

3.06 x 10 4.21 X 10 1.44 x 10

4

t:. v .) .9
0.0 - 5.6 9.2 - 20 .0 0.0 9.9 0.0

3.87x10 4
3

Kp
I<t~

5.12x10 5 2.53 x 10 9 1.20 x 10 1.40 x 10 3.27 x 10
4

3.37x10 3
4

j(fm Kfp

1.80 x l0·3
9
5

9.40x10 3 1.93 x 10 7.47 x lO:J
4

Kri
Kb

3.2 Process Modeling

19

length distribution (CLD), of growing and dead polymer chain lengths in the react.or. In genera.!, techniques based on popvlation balances on the live and dead polymer chains arc required to obtain such informat ion. In this study, we employed the method of moments approach in order to model the dynamics of the LDPE properties . This technique is a powerful, yet compact way to obtain important information on aver·age molecu lar properties of the polymer , such as the number and weight-averaged molecular weights. and the frequ encies of short (SCB) and long chain branching (LCB). In the following , the notation A; refers to the i' 11 moment of the CLD of the live polymer chains Rn, while the i 1h moment of the CLD of the dead polymer chains P, .
')()

fi.i

refers to

A; = LniRn
n= l

/l i =

L niPn
n.= l

(3.22)

Us in g the above

d ~·finitions ,

it is possibl e to develop equations desni!Jing the dynamics of t he leading

moments of the CLDs of thE' growing and dead polyrner chains. Since the lifetime of live polymer radicals are usually much srrwller than mea n residence times in LDPE autoclave reactors . the C'LD of (·. he live polymer ch:otins achievE's equilibrium very ra pidly relative to the remainder of the systern . Therefore. in order to reduce t he dimensionality of the resulting process model. we make the assumption that the distribution of live polym er radicals in the reactor reaches steady state instan-

t.a.nrously in the rPaction rnixtme. commonly known as t he quasi steady state assumption (QSSA ) .
L 1sin g t.he QSSA . the dyn am ical (difTerentia.l) equations corresponding Lo the leading mom ents of the live polymer CLD can be replaced with algebraic equations for the moments given by [37] (3 .23) (3.24)

(3.25) where the rate of radical initi at ion R, is given
b~'

(3 .26) The dynarnics oft lw leading moments of the dead polymer CLD is given, generally, by (3.27)

20

3 Model Development

where

(3 .28) (3.29) (3 .30)

When cilain transfer to polyrner occurs, i.e. equation (:3.6 ), thP. dead polymP.r ltlonJ ent equatiollS of order > 1 depend on the next higher moment, for e.g.
1· 1,,

depends on

11 2 ,

making this svstelll of

equations open ended. In order to solve this problem, some sure of momen t closure technique is required. Here, we make use of the approximation of Hulburt and Kat:t. [28], with which the t hird moment of the distribution equation
11 3

is app roximated algebraically by lower order moments through the

(3.31)

The number llfn, and weight 111 w averaged molecular weights arc related t.o the moments by equaLions (3 .32) and (3 .33), respectively. Usually, the magnitudes of t.he dead polymer moments greally exceed the equivale nt live polymer rnornents. lea.d ing to the sirnp lific:<i.tions slJOWIJ.

(3.32) (3. 33)

3.2.1.1

Notation

In the following Chapters, we will be utilizing, almost exclusively, the notation followed in the control and est imat ion literature. Therefore , it is useful to introduce son1e notation that will be used later on in context of the single-zone LDPE autoclave reactor model. The dift"erential equations (3.9 -

3.12, 3.27) of the reactor model can be expressed concisely as

:i:(t) = f(x(L) , 'U(t) . t)

(3 .34 )

3.2 Process Modeling

21

where x(t) E IR" is t he vector of

S~' stem

states, and u(t) E IRm is the vector of control inputs. Here,

the state and control input vectors are given by
:J' [

I

M

M,

'J'

Jl·o

11·1

~t2 f

(3 .35)

u

= [ QJ,

QJ"'

f
Zk- E

The vector of plant measurements

!Jk E JRP

and contro lled outputs

JR"c arc given by
(3.36)

3.2.2

Multi-Zone Multi-Feed Autoclave Model

Multi-zoue rnulti-fEOed LOPE autoclaves are well-agitated high-pressure vessels consisting of mu ltiple reaction zones , st>parated by disks. in series with one another. In general. each zone possesses a pair of feed in it iat or anr! monomer streams, which can he manipnla.t ed in order to control t he reaction con dition s in the particular zoue, such that. the polymer produced possesses the desired rnolecnla.r properti es [59]. In com parison with single-zone reactors, multi-zone reactors are usually much longer with L/D ratios as high as 20m / m [59]. F igure ;}.2 shows a simple schematic of a typical multizone multi-feed LOPE antocllwe reactor. Each zone in the rnn lti-:wne reactor is typically modeled as a single perfectly-mixed compartment (see for example [11]), or as a series of perfectly-mixed compa.rt.ments (see for example [f)9]). In this stud y. we chose to lllod el each reaction zone in the multi-zone autoclave as a single perfectly-mixed compartment vi rtually identical to the case of the single-zone reactor model presenLe<i in the previons Section. Note lhat the modeling assumptions outlined in the previous Section for the single-zone reactor st ill hold for each reactim1 zone in t he multi-zone reactor. Backmixing interaction between adjacent zones arc accounted for via. the internal upward qu , and downward qd ,

Table :3.2: Single-zone autoclave mode l parmnet.ers
p

1700 bar 0. 8798 28.05 g/ rnol 0.1216 rnol / L 20.89 mol / L

Tf

:n:us

K

.!
1 \ f0

1/
Qj, QJM

l f) 01.9 L 25 cm 3 /s 20 L/ s

IJ

llf.r

22

3 Model Deve lopment

t q,'l
--~---

---1-t]tJJ

J

q

Figure 3.2 : J \-1 ulti-zone multi-feed LDPE autoclave reactor showing the control inpu ts. The controller aud measurelllent structure (not shuwn) is ctnalogous to Figure 3.1.

3.2 Process Modeling

23

Ta ble 3.:3: Multi-11one autoclave model parameters
p

1700 bar 0. 8798 28.05 g/rnol 0.12 16 rno l/L 20.89 mol / L 313.15 K 350 L 350 L 300 L

J
Mo
l fu ,;,

R1 R2
Qfl.! Qfu

0.8 0.6 10.4 crn 3 /s
11.4 crn:1/s

i\1/1.2 .3

QJJ.3 Q.fM ,l QJM ,'l
QfAr .3

15.0 cm 3 / s 8.658 L/s 5.661 L/s 5.661 L/s

T!J., ." Vt

v2
l/~

Aow streams. The notation

Q11 ,

denotes the Aowra.te of the upward stream from the (i
(]d,

+ 1)th

w ne

to the ith zone. whereas lhe notation wne to t.he (i

denotes the Aow rate of the downward stream from the ith

+ 1)th wn0

(sN' Figmc ~.2). l n orriN to (jnant.ify the cffert. of ha.c krnixing on rr.ilc t.or

dynamics, we developed t he so called backmixing ratio R; E [0. 1) given by

(:3.:17)

whi ch , for any givE-m

re<-~ction

11one. is essent ia lly the ratio between Lhe ·u pward Aowrat.r. ·into, and ote that tl1e fi nal zone does no t have
<Ill

the downward Hov;ra.te away frolll the zo ne .

associated

backmixing ratio, as it. neither possesses an upwil.rd Aowrate into, nor a d ownward Aowrate away frorn t he wne. O ther ratios have been proposed to model bac:krn ixing i11 LDPE autoclave vessels, sec for example C hien , Ka n , and Chen [11], Pladis and Kipa rissides [59), and Chan, G loor. and Ham ielec [8). however , t.he present a pproach was devised as it possesses a number of interest ing properties.
Not. ab l~' ·

R,

=0

implies the complete absence of inter11ction, i. e. basically amounting
ith

to physical separat ion between the

and (i

+

l)l·11 reaction zones, whi le R i = 1 implies perfect
ith

mixing, i. e. Lhe a bsenc:e of concentrat ion and ternperntme gracl ient.s between the
~o n !'!s.

anrl (i

+ J) t h

The backn1i x ing ratios for

th~

rnulti-11011e reactor can be estimated from reactor operat ing

d ata, or from experimental st udies. As was d one in the case o f l he si ngle-zone LOPE
autoc l <~ve

reactor. rnola.r. energy, an d population

balance equations can be developed for each reaction zone in the JV- zone multi-zone reactor. The resulting expressions for t he first. middle , a nd final zones
('clll

be S\ll llm a.rized , respectively, by t he

24

3 Model Development

following three equations.

(3.38)

--- = rx , +~~~~~----------~------------~~--c/1.

dX;

IJJx .. XJ,i

+ IJu.. i Xi +l + IJri., + !Jd ,N-IXN-I
V,'V

lXi-1- !Jd .i x i - IJu, i - l Xi

\1,

(3 .39)

~ = rx N+

dXN

IJJx ,NXf ,N

- !Ju.. N-J X N- qXN

(3 .40)

Here, the notation X ; refers to any state variable (concentration , temperature, or moments) in the
ith

reaction zone, IJJ x,, is the feed Ilowrate of component. X to the

-ith

reaction :.-:one and XJ' ,i is the

corresponding feed concentrat ion , and 1·x. is the rate of change (or production, consumption) of component X in the
ith

zone, for examp le

3.2.2.1

Notation

The state and control input vectors for the three-zone LDPE autoclave reactor considered i11 this study are given by

x =
n

[I
J

M
qf M

Mt

T

J.lo

{L1

(3.41)

= [ qf

JT

where, for example

The measurement and controlled outpu t vectors are given by

y=z =[ T Mwf =[ T

(3.42)

Chapter 4

Controller Formulation
Model prec!ictive conLrol (l\'IPC ), a lso known as recec!ing horizon (RH ) or moving horizon (lv!HC) contro l, refers to a d-1ss of contTo! a lgorithms that make use of an exp licit process model to compute future control actions. At a ny sampling instance , the current measurements are used to ini t ialize an open-loop optima l co ntrol problem that is solved over a finite horizon to <ietermine an optimal control inp ut trajectory that minimizes a certain cost function. The cost function is designed so as to achieve some performance criteria, for e.g . maximization of profits. minimization of environmenta l impact , or as is often t.he case, minimizat ion of deviat ions from a desired setpoi nL. However , on ly L he fi rst control iu put in the opt.i1n al trajectory is appli ed to t he plant. This procl'<..lurc is then continued repeatedly at all future sampling instants. The lviP C methodology is d ifferent from 'conventional' a pproaches in that. in general. off-line comp utation of the lv1PC contro l law is impossible. TnsLead, t he control law is 'derived· on lin e by the periodic so lu t ion of the aforementioned optimal control problem. Prior to proceeding fmther. it wi ll be helpful Lo cl::t.rify some term inology that will be used frequent ly in this and subsequent Chapters. The term plant is used here to refer to the actual process under controL which in this case, is the LDPE autoclave reactor. The mathematical representation of t.li e plant , in the form of ODEs or DAEs, is refe rred to as the plaut model, or eq uiva lent ly, controller model or internal modeL In a simulation-based study such as this, both t he plant and plant model are 1nathemat ica l models. However, as discussed in Chapte r (i, t he models are different a nd are hand led

26

4 Controller Formulation

'separately ' in order to

proper!~·

maintain this distinction. In general. the MPC' formulation places

no restriction on the type of plant models that are acceptable. For example , in conventional linear MPC:: in1plemenLations , step, finite illlpulse, and linear :::;taLe space models have been used to model the plant behavior. On the other hand, Nl'vfPC controllers use nonlinear internal modeb to represent the process dynamics. These models can be rigorons mechanistic (i.e. first principles) models, such as the LDPE autoc:lave reactor models developed in Chapter 3, or data-driven nonlinear empirical models , for e.g. second order Volterra [58]. and neural network based NARl\1AX models [82. 2·1], a mong man.v others in the system identification literatnrc. In the rcrn ainctrr of this Chapter , we provide some necessary background 011 NMPC, and prese11t two formulations for t he control of the LDPE autoclave reactors. 'J'he solution of optimal cont rol problems involves fi nding optimal control policies which lead to the minimization or maximization of sorrw specified criteria. These nitcria are usually lumped together into a single objective (or cost) function , with each criterion weighted according to ils relative importance. This formulation hal:! important implications iu the fie ld of control engiueer ing. as many control problems can be viewed as optimal control problems with the objective L>eing the minimibat.ion of deviat ions , or errors , between certain quantities and their respective selpoints . ln cont inuous-Lim e, a geuera.l '!v!PC-relevauL' fiuite horizon optimal control problem bears the forrn of Problem (4 .1 ) shown below.
rn in
u(t )

.J (x (t) , lL (t))

= <I' (x (I. + T p))

+

J
t

t + T~>

L( : .r (T) , ·u (T)) riT

(4.la)

subject to :

:.i:(t)

= f(x(t) , ·u(t), t) , x(O ) = :r:o
:r.(l)
E > I:'

(-Ub)
(4 .lc)

11.(/.)
Vt
E=

E

U

u(t) = u(t +TAl)

[t + TAJ , t + T,]

(1. l d )

Here . .J (:.r(/),v (i.)) is a scalar- valued finite hor izon of the lluile
hori:~,o n

cu~t

funvtioua l in Uolza form , Tp is the length

com1nonly referred Lo as predict ion horizo11 i11 l\ lPC' parlance. and TAl il:l t he

length of the control horizon. The functions C(x(r) ,·u(r )) and 1J (.r(t+Tp )) are known as the
stage and tenn-inal costs (or penalties), respect ively. The so lutiou to Problem (4.1) determines

27

the optimal control input trajectory tt · ( t), which m inimizes the cost funct ion (4. 1a) subject to the constraints (4.lb) to (4. ld ). The second constraint (4. l c) forces t he states x(t) E IR'', and cont rol inpu ts v.(l ) E !Rm a long t he opt imal trajectory to lie in t he sets X and U , respectively. ln th is work , we are interested primarily in simple bound constraints of the form
,\' =

{l'L < .r(l) <Xu }
{ttL

U=

:S: 11 (I) :S: uu}

Constraints of t.his form arc uscfnl in process control , as it allows t he engineer to ·inform ' the controller of actuator constra.illt.s , and process variable ra nges, which 11sually take t his form. The fin a l constraint (4.ld) is , perhaps, unique to :VIPC a nd is used as a means to limit 'aggressiveness ' of the controller. Depcnoing on the sit uation. add it ional const raints can be fr eely int roduced , for e .g. inequali ty pat!J cons traints on the outputs y or controlled outputs z , however , t his formulation is s11 fficient lv genem l to ha.ndle most. cases. For t he case of u.nr:onstm-incd linear systems with quadratic objective functions, i.e. t he well known linear quadratic regnl ator (LQR) problem , the optimal control problem can be solved analytica lly offline via a va.riet_ ,. of techniques to obtain the stale feedback expression
1tk

=

f{ LQXk,

which

can t he n he used on line to calculate optimal control profiles. However, s imil a r analytic so lutions are nnavai lable for problems with constraints and model nonlinearity. For t hese cases . t he optimal contro l problem must be solved online to determine the optimal trajectories.
F-1 istorical!y, Problc~ m (4. 1) was solveo ' inoirect.ly ' using principles from the ca!r.nhts of variations ,

i. e. by solving the assoc iated Eu ler-Lagrange equation, and dynamic prograrnrnill g approaches , i. e . by solvi ng the Harn iltou-J acob i-I3ellman equation. However , the current on line implementat ions of these methods posses a number of disaci vantages [21, 7]. a nd as a resnlt, are seldom nsed in pract ice. In stead, ::tn a pp roximat-e (uurnerical) solution to Problem (4. 1) is usually sought by posing the optimal coutrol problem as a nonlinear programming (N LP ) problem t hrough appropriate pararneteri za.Lions of the control inputs and (optionally ) the staLes. The res ulting problem is then solved us in g conventional NLP methodologies, from which , sequent ial quadratic prograrnrning (SQP ) based methods are the most popular in the NMPC literat ure. This method is sometimes ca ll ed ·direct' as it involves a ciirect minimization of the cost ftmction subjec t to constraints . as opposed t.o relying on

28

4 Controller Formulation

Figure 4.1: Illustration of t.he control structure

results from optimal control theory. In th is study, we use orthogonal co llocation on finite elements (OCFE) to discreti~e both the control inputs and the states, and the resulting system is solved using the commercial SQP package SNOPT. The reader is referred to Chapter 6. which deals more elaborately wit h issues regarding implementation of the controller formulations. In digital controL it is standard procedure to regard the control inputs as being constant within each sampling interval, i.e. a zero-order hold (ZOH) is enforced in-between sampling instances. Therefore , it is more convenient to represent the cont inuous-time nonlinear ODE plant model (4. lb ) a;; a set of nonlinea.r cliJTcrence e(j nat.ions, which is common in t.lw i\1PC litrratnrr.

(tJ.2 )
E IR" and uk E IR"' are the plant states and control inputs,

with the initia l state x 0 . Here,

Xk

respectively, at the kth sarnpling instant, and t;k is the corresponding time. Now , using the discrete model (4.2), Problem ( 4.1) can be redefined, so that computer implementation of the formulation is made straightforward. In the following, we assume that both the control inputs and states are
discreti~ed.

j+P-i
min J(xj , u j)=<i>(:rJ+P)+
X j .U;

L

[.(xk> ·uk)

(4 .3a)

k=j

subject to:

(4.:3b)

(Uc)
Uk=llj+M-1 'Vk=j+M,j+M+L . .. , j+P - 1

(4.3d)

29

Here ,

:J (x j. u 1 ) is t he finite hor izon cost functional fo r t he discrete problem , P is t he length of

the prediction horizon measured in number of sampling periods, and Af is t he length of t he control horizon . The stage and te rmina l penalty functions. L (.q.,
u,k)

a nd

<T> (Xj+P ) ,

in Problem (4 .3) are

now d efined in terms of discrete quantities. in contrast to P roblem ('l.l) where they are funct ions of continuous vari ables. Note t hat t he continuous-time object ive (4 .la.) could very easily have b een incorp ori'tted into Problen1 (4.:3 ) in st.ead of' (4.3a.). by n,;ing a sn ito b!P Tllllllerical
qu;'ldr;.~tme

scherne to

evalu ate the integral. However , in add ition to being simp ler to comput e, when the cost is quadratic . t he discrete-t ime objective is ident ical to the case of t.he d iscrete-t ime LQR problem , making compa.rison between the two cases easier. Th e decision va.ri<'tble vectors
Xj

and

Uj

are t he sequence of

states and control inputs at each sampling instance over the ? - interval prediction horizon, i. e.

Xj= u ,=

[xJ
[ uT
.1

XT

j +J

x.i +P- J 11 T j + P- 2

T

T

xJ+P]
( T u.i + P - 1

T llj + l

Figure 4.1 is a simple schema.t.ic showing L he structure of the feedback loop with the NlVIPC cont roller. The Plant block denotes t he system we are interested in cont rolling, whi ch is, in t his
c;.~se ,

t he LDP E

autoclave reactor. The Nl\.fPC controller accepts as inputs . t he setpoints ::, of the controlled outputs
z ~;;.

and lhe cmrenl est. im at.e

: h of lhe plant. slat.e. The setpoints t.o t he controll er can be supplied

ruanually IJ.v uperilt.or iuterveutinu. or automAt ically using an nppP-r reill-time opt.irni zflt ion (RTO) layer [5]. Using the current. estimate as the starting point , the NM P C controller solves a given
open-loop finite horizon optimal control problem to obtain an optima.! control inp ut t rajectory u ;;,

which mini111izes I he associated cost fun ctio n. Only t.he rirst inpu l in th is tra.jecl ory t he plant.

'Ilk

is sent to

The main reqni re ment for solving lhe NM P C problem is t.he availa bility of t he current plant sLate. U,;na.lly. however. t he complete state vector is no t measured ouli ne, and in general , t. he

avai lable measurements !Jk ca.n be some nonlinear function of the state, or some subset of t he state. FnrLhE>rmore. the measmement,s taken might. be distorted by sensor noise. Therefore , the role of t he Estin1a.tor block (i.e. t he state estim ator) is to use t he a.vaila.ble measurements to const ruct an

estimate of the plant state

: h , which is then fed back to the controller. f\·1ore information on t he

state es timators used in this study can be found in C hapter 5.

30

4 Controller Formulation

In the following Sectious, we will present two Nl'v1PC formulations. namely, the nomina.! , and the offset-free NlvlPC formulations for the control of the LDPE c tll tocl;wc reactor.

4.1

N aminal Formulation

The process of modeling most systems of interest involves making simplifying assumptions on, and approximations of the underlying phenomena. This is especially true for polymeri:6ation reactors , which display complex phenomena, for e.g. nonideal mixing, multi-phase polymerization, and ge l format ion, etc. It is an extremely difficult task to properly model these features , and oftentimes. one must resort to emp irical correlations to describe complicated behavior. Due to these factors, iL is essentially impossible to develop a process model capable of match ing the plant dynamics exactly. Fortunately, for process control, it is only essential that the ·most important features ' of the plant 's dynamic response are modeled. However , in the nominal formulation discussed here, we assume that the plant model matches the plant dynamics perfect.ly. i.e. there is no plant-model mismatch, and that unmeasured disturbances do not enter the system. Obviously. this formulation cannot generally be used in practice , however , it is useful as an imroduction t.o more sophisticated algorithms , such as the offset-free fonuulation Jiscussed in Section 1.2. For this formulation, we postulate that the plant dynamics and measurements are described perfectly by the model

Xk+! = j(Xk, 'Uk , Wk ,

tk) (4.4)

Yk
ZJ,;

= h(xk, tk) + Vk
= g(yk)

Here, f/k E JRP is the vector of plant measurements (or outp·uts ), which in general , is some nonlinear function h(-) of the state
Xk·

The vector of controlled out.pnls
measurement~.

Zk

E JR "·· is modeled , somewhat gener-

ally, as a nonlinear fuuction g( ·) of the

though i11 maay cases they are coincident. The

vectors w,. E JR4 and vk E JRP are the state (or process) and measurement noise , respectively. Both
Wk

and

1'~,:

are assumed Lo be zero-mean Gaussian white-uoise processes with covariance matrices

4.1 Nominal Formulation

31

Qk and R.., respectively, i.e.

The process noise

Wk

can be viewed as another input to t he system. In t his case, however, the input

is Gaussian random. il.nrl we do not posses control over it s magnitude. In order to continue using the difference equation notation. \\'e assume that the process noise is ·sampled' n.t the beginning of the sampling period. and is then held constant over the dmation of the interval [32) . The measurement noise
'·' k

is assumed to be addi tive, though more general nonli11ear relationships can be rnodeled, if

necessary. As mentioned previously, the NMPC objective function is designed by weighting several, somet im es competing, performance criteria within a. s ingle cost function. In general, we require that t he controller maintain a number of controlled outputs (or process variables). for e.g . reactor temperat. ure a nd liquid level, at some desired setpoints. Furthermore, we desire that t he controller do this hy employing ' minin1al' cont.rol effort , and without taking 'very large' control moves. These notions are incorporated into a quadratic cost function which penalizes deviatiom, or errors, between the controlled output ('uutrol rak each
6. n~o
Zk

and its setpoint z,., the control input u.., and its setpoint n_., as well as the
~ntire

over the

predict.iou horizon. Therefore. the

contro ll ~r

NLP

t li ~t

is so lved at.

sa.rnp l in~~;

instance is given by
.i+ P - l

min
x .1 . u .l

llz_i+ P- z,jj~ +

L

l!zk- z,!!~ + !I nk- n, l! ~ + ll 6.u, !!§

(·1.5a)

k=j

subject to:
(4.5b) (4.5c)
llk

=

·nj+J\I-1

Vk = j

+ iVJ , j + M + 1. ... ,j + P-

1

(4.5d)

Here, Q E IRn., > n,. i,;

th~

cont rolled output penalty matrix, R E IRm x m. is the cont rol input penalty

matrix , and S E IRm nn is the control rate penalty matrix. The norm notation used in the objective function is simply a compact representation of the quadratic form , for e.g.

(4.6)

32

4 Controller Formulation

The control rate t:.u.k in formulation (1.5) is simply the difference between the current and past control inputs, i. e.
t:,.'Uf,

=

Ilk -

'Uh:- t

(4.7)

The setpoiuts z., and ·u_. are not indepeudent , and ntust correspond to a. steady state (or equilibrium) of the the plant model, i.e.
:t:s =

f(x 8 ,tt 8 ,0,·)

Ys = h(:t·., )

(4.8)

Zs

= g(ys)

The closed-loop response of the NMPC controller is tuned using the quadratic penalty matrices Q,

R , and S. Details on the tuning parameters used in this study can be found in Chapter 7.
In the presence of plant-model mismatch and/ or unmeasured disturbances , the nominal NMPC formulation is known to cause steady state errors (or offs ets) in the controlled variables. This feature cau be attributed partly due to the structure of the quadratic objective employed in the formulation. For example , when an unmeasured disturbance enters a system at equilibrium , the steady state control input setpoint u, that is required to maintain the controlled output
z~c

at its sctpoint

z. · changes depending on the type and magnitude of the disturbance. The umninal fonnulation ,
however, lacks any mechanism to estimate this disturbance, and to accorcliugly adjust setpoint u., to the necessary value. Consequently, the NLP solver is forced to compromise by balnncing offsets between the controlled output aml its setpoint, and the control input and its ' incorrect ' setpoint. The extent of the offset will, obviously, depend on the relative weighting between the two in the objective function. Note that, in this example , we have chosen to ignore coupled state estimation issues \vhich also arise due to model mismatch when using this formulation.

4.2

Offset-free Formulation

The nomin al N!VJ PC formulation discussed previously does not lllake any acc:ornruodatiou for rnodeling inaccuracies or unmeasured disturbances within the controller architecture, leading to steady state orbet itt the contro ll ed output. In ttwst che tnical proce;;ses, :>uch behavior is undesirable as iL

4 .2 Offset- free Formu lat io n

33

results in , fo r e.g. variable product quality and subopt im al operation, depending on t he extent of t he p lant -model mismatch, and/or t he ty pe a nd magnitud e of the disturban ce. P erha ps. in keeping wit h t he tradi tion of t;lu_, popnl ar PID CCllllroller , the most int ui t ive way of
e~ch i ev in g

offset-free op-

erat ion is to augment t he model state ve<.:tcn· with a number in tegral states x.r <.:orre8ponding to the cont rolled outputs. i.e.

.r/

.fo

t (z(r)- z (r)) dr = -~ t c(r) dT
8

(4 .9)

±.r = z(l-)

~

z,( t ) = e(t.)

However , doing so has several disad vantages, most notably, t ht> increased com put.alional cost. incmred clue to the inclusion of addi t ional states, which have to b e in corp orated iu to t he NLP tliat is solved on line , and t he requ irement for some anti-windup feat ure for t he integral states in order to prevent cont rol performance degradation clue to integra.! windup [52]. The most populFir choice. by far , in t he MPC li terature is to augment t he state vector of t he pl ant 1noclel willi consl.a11t disturbance states [5 2, .57]. 1t is well knowu t hat t·his esseut ially duplicates t he function of int-egral cont rol [23], while avoiding t he need for an anti-windup featu re [52]. Due to this property, t he disturbance states arc occasionally referred to as integrating disturbances. Obvious ly,
~im·c

these

state~ Me

art.ifkia lly introd uced qu a 11t ities, t.hcy arc not controll able, however,

a sui table disturbance model (i.e. controller model) can be designed such t hat t heir magnitudes can be estimated from avail able plant measurements. The disturbance states essentially function as 'model e({ua li /.ers' iu t he seuse t hat they serve to 'equ a li "e' the plan t and mod el dy namics with respect to the plant outputs. The H ex ibili ty prov ided by integrnling d isturbant:es permits structural nccom modnt ion of t he cffpct.s of 'moderat,f. plant-model mismatch nnd 1111mt>asmerl rlist.urba.nces

z ...

_I

I

T a rg c<

Cal<nl a <r>r

I

I Xt.J· Ur ,J

l

I H.egu I ator I

J

U.k

i
xk
Pk
"

Figurt> 4.2: Internal view of t.ht> NiV!PC block

34

4 Controller Formulation

from within the framework of the controller model. In thr offset-free N!viPC fornml ation , t he act ual plant dynamics and mras urrrnents are approximated ' internally' , i. e. according to t ile cont roller , by the wodel
:r:k+ l = J( :I:k- Uk,7Jk , 'l.L'k .l.k)

Yk = h(:r:k, Jlk , t.k)
-~k = g(y~;)

+ l'A:

(1.10)

Here, Pk E: !Rn" is the vector of disturbance states, and all other quantit ies are as previously defined. Disturbance models can be classified into input and outpv.t. dist urbance models dep ending on where the disturbance Pk is modeled as enteri ng the plant. For example, an input disturban ce model approximates the effect of model mismatch and / or umnea..surcd dist urbances a..'l au (artifici al) disturbance originating at the pl ant inpu t . The model (4. 10) is general and a llows for both input and output disturbances, as well as some combination of the two . Particular details on the design of the disturbance model used in this work can be found in Chapter 7. The dynamics of the integrating dis t urbance is modeled by
P k+l

=Pl.:+ ~k

where

~k-

E JR"d i;; assumed to be zero-mean Gaussiau white-noise wit h covariance mat rix · 'h . In t he
constant.

context of NMPC. thi s implies that the dist urba nce remains

over t he predict ion hor iw n.

The dist urban ce model (4 .10) is very general, and a llows for t he integra.ti11g disturbance statP.s to be introduced into the model dynamics and / or measurement equations in any arbitrary manner. However, in this work , we usc the simplified disturuaucc model (4.12 ). iu which the disturbance states are related linearly to the model dynamics and . m easurements as shown below.
Xk+l

= f(xk. 'Uk, t k) + X uPk + 7.1. h·
1

Yk Zk

= h (xk, tk) + XyPk + Uk
= g(yk )

(4.12)

Here, X u E !Rnxn" and X y E JRPX"" are the user-supplied input and outpnl dist urbance mat rices, respectively. Figure 4.2 shows the intem al struct ure of the Ntv'I P C controller block (see Figure 4.1) for t he offset-free fo rrnulat ion. Here , the controller consists of t.wo component s. narnely, the Target Calculator, and the Regulato r subsystems . The target calculator uses th e current esti mates .h of

4.2 Offse t-free Formulation

35

the plant state a nd dist urba nce

Pk

to calculate steady state (eq uilibrium ) targets for the state

Xt ..i

and control input u 1.,; , which is srnt t.o the H.cgnlator.

The regnlat.or solves an opC'n-loop finite'

hori zo n u pt in 1a I l'O JJ lrol problem t u obt.a i11 t.he oplilmd co JJ t rol i 11pn t. profile

u;; , which
uk

minimi zes

a. g iven (quadrati c) ob.iective function. Th e firs t control input in this t rajec tory

is sent to the

plant. In t he following su bsections . we will d iscuss in d etai l the fun ctions of t he target calculator a 11d regul a tor i11 Lilt> ufl'se>t -free \"MPC funnnl a.t ion .

4.2.1

Target Calculator

As ment ion ed prev iousl.v, the principal limi tation of the nominal formul at ion was t ha t it possessed no mechanism to adjust the setpoints z., u 8 to the controller , which , in the presence of modeling erro rs. unmeasm ed distmba nces, and / or process constraints, can lead to steady state offsets in t he control led variables. The ofTset.-free formul a.t. ion over comes this lim itation through the use of the so ca lled target calculator. Th e ro le of t he target calculator in t hi s formulation is to identify a stea dy st aLe , or e(jnilibrium , of th e contro ll er modt>l (4.10) at which the controlled output respective seLpoint ·'" · In t his Section. t he notation
Zt,J
::k

ach it>ves its

a11d

ILt .J

refers t o the COII t rolled ou t pu t a11d

control input setpoints, res pectively, at t he jlh (i.e. current) sampling instance. and Pi is the current disw rbance. The ta rgf' t ca lcu la tion problem is fund amenta lly an algebra ic pro blem , wh ich stated as Xt.j
ce~n

be

= f( :tt.. j · Ut.j· PJ, 0.. )
(4.13)

.Yt.J = h (x:t.J ·P.i, ·) Zt ..i = g(Yt.j)

O=z.-zt ..i
The first e(]u a.tion in (4 .13) is the eq uilibrium condi l ion for t.h e disturba nce mode l (4 .10), given the current disturbance P.i. The final condition ens m es t.h a.t the Pqnilibrinrn point corres ponds Lo the d esired seL point.s for the controlled variables. The on ly unknowns in the above equation are t.he target states a nd cont rol input s. i.e. :c 1 ·1 E IR" and u1 .J E !Rm, respectively. Clearly, fo r squa re plants (i. e. where n c = m), in the a bsence of constraints , th e a lgebraic problem (!J .13 ) is well-posed. and any Jm tlt ivariab ll' root-h nding a lgor it hm , for e.g. Newt.on-H aph::;o JJ , l'<l JJ be used to so lve it. Diffic ul t ies

36

4 Controller Formulation

arise, however , for ·thin' (nc > rn) and ·fat' (n c < m) plants , where the above system is not wellposed. For th in plants, there arc more equations than free variables , and in general, it is impossible to ri11d eLJuilibriullJ targets which satisfy the co lllrolled outptll setpoint. For fat plauts. there are fewer equations than free va riables , and in general, several equilibrium so lutions exist which satisfy the controlled output setpoint. Obtaining a so lution to (4.13) is further complicated by the presence of process coustraiuts. which lllight be critical in determining is feasible. Due to the reasons discussed previously, the problem of identifying steady state targets is rcsol ved in many proposed !VI PC algo ri thms by formulating it as an optirni llat ion (i.e. QP / NLP ) problen1. For example, following the approach of Muske and Ba.clgwell [52], and Pannocchia and Rawlings [57] for linear MPC. a quadratic objective NLP such as
· mm
X t.; · Ut.;

whet.llE~ r

tht:> c·ontrolled output setpoint

(zt.j - z,.) 7' Q(zt .j - z,. ) + (11t ,j - 'll s ) T R(nt. j- n8 )

(4. 14)

cFtn be definrd , subject to the stead.v state rontroller rnodel (-!.1:3) , and any necc·ssary process constraints. Obviously, the last condition in (4.13) is no longer applicable. Here ,
Zs

and

ns

are the

desi·red setpoints, which may or may not be achievable, and

Z t.J

and 1Jt.,j are the feasible (achievable)

targets. The matrices Q and R in (4.14) can be chosen to penalille (relat ively) deviatious of the controlled output target from its desired sctpoint , and the control input target from its desired setpoinL ln practice, one is usually more concerned with maintFLining the controlled output targel at or close to its setpoint, t herefore, the elements in Q are usually selected to be rnuch higher than the clements in R . in this work , we adopt the exact penalty approach proposed by Rao and Rawlings [6-l] for linear 1\IIPC , and Tenny. Wrigltt, and Rawlings [83] for NMPC. Here, in order to accommodate situations where achiev ing the controlled output setpoint is impossible, t he requirement that the setpoint be achieved exactly is relaxed by incorporating it into the target calculation NLP by defining the soft const raint

z, -

1) ::::: Zt,j ::::: ;;,

+ 1)

(4 .15 )

where TJ E [R"c is a nonnegative vector of slack variables. This constraint forces the controlled output target, Zt,j to lie within some 'radius' ·r7 of the desired setpoint z,.. This radius can be made arbitrarily

4.2 Offset-free Formulation

37

small by a ppropriately penalizing rJ in t he object ive functio n , such tlwt , for a ll inte nts and purposes. the equalit~' :: 1.:i = ::, holds when ach ieving t he desired sctpo int is feasible. In this study, the I J/ 1~ pena lty <tpproac h of Rao allf l R aw lin gs [64] is used to
p enali:~~e

17 iu t he target calcu latio n NLP.

Therefore , t he NLP that is solved at each iterat ion is given b)'

min
: r , ,J .n, ,1

.ry

(4.16a)

subject to: (1.1Gb)
Zs 1J ::; Zt,j ::; Z s

+ 'II

(4. 16c) ( 4.16d ) ( 4.16e)

In praC'tin', the l t /1~ pf'lla.lty mat ri C'es Q E

!Rn , x n ,

a nd II E IR "'" an·

diOSt'll

's u ni cie nt ly large' .

so that the soft constrain t is guara.ntef'd to be exact [611]. Hr·re . the notation 6.v 1 .,j represents t he rl iffC'rcnC'<' b C' twC'rn t hr <'mrrn t mtrl pnst. C'ontrol in put targ ets. i. e.

(4.17)

Penalizing

6. 11 1 .,J.

via t he quadratic penalty mat rix R. E !Rm x m. ensures t hat, if mul t iple control

inpu t t.arget.s satis fy t he cont r olled outpu t setpoint., t he t.arget.s seleC' t.ed are ones that. are dosest w t he previous target [83].

4.2.2

Regulator

Th e regu lato r in t he on·setAree NI\:IPC formul atio n so lves a n open-l oop optimal C'<>ntrol NLP online to c<tlculate optimal control inpu t t raj ectories which drive t he system to , or equi valently, stabili ze t he system a bout t hf' <' mrent controlled out pnL t he cmnmt NLP that is
~!;t im at~
~olved
Zt ,1

and C'ontrol inp11L

Itt..'/

targets. Therefore, given
o bj ~ct ive

of

th~

integrating dis tmbance sta.t.e PJ. t lt f' res ultin g qua.dratiC'

based

at each sampli ng iusta.nce is given by

nun
X J. U J

( 1.1 8a)

38

4 Controller Formulation

subj ect to: (4. 18b) (4.18c)
u.k=1L 1 +M-l

Vk=j + M , j+M + 1, ... ,j+ P - 1

(4 .18d)

Note t hat the str ucture of the regulator NLP is virtually ideutical to the case of the nominal Nlv!PC formulation. Furthermore. note that the model constraints (1.18b) a bove impli cit!)' assume that the integrat ing disturbance state P:i remains constant over the pred iction hori:wn.

Chapter 5

State Estimation
The operation of an.v stRLe feedback control scheme. such RS model predictive control, is depenrleni. on the availability of good state estimates at each sarupling iustauee on which to base future co!ltrol decisions. However , it. is rarely the case that physical mcasmement.s of all state variables arc available. all(] those i.ha.t. are a.vailab!f! are frequenL!y contaminated wiLh measmement. noise. FmLhermore. the system dynamics might be subjected to random disturbances (or noises) which can neither be controlled nor modeled deterministically [4 7]. Therefore , the role of the state estimator in the contro l system is to reconst.mct unmeasured state variables from Lhe available measurements, and also Lo filter the mcasurcmctJt.s to account for the t'IT'ects of noise ]12]. Tn tlli:; context, state estimators are oftentimes also referred to as filters. The state estimation techniques developed for lin ear systems are based on the highly advanced linear esLima.t ion t heor.Y [5:3]. The well known Kalman filler [:34, 35], originally proposed by R. E. Kalman in 1960. produces mininmrn variance and maximum likelihood (optimal) recursive state estimates for unconstrained Iin ear systems [5:3]. Hov.;ever , the optima.! solution to the non! inear fi ILeri ng problem is infinit.e dimensional

[3.1], and (.here cmrenLly r>xist.s no t ndy optimal solution which can

reasonably be illlplemented online. Therefore, a. number of :ouboptimal filtering strategies snit.ab le to on li ne implement a l ion have been suggested in order t.o solve t.he nonlinear flltering problem . [n the following Sections, we outline two such approaches that were utilized in this work. na mely. the Pxtended Kalm a n filtering (El<F ). and unscented Kalm an filt.~'r ing (OKF) state estimation schemes .

40

5 State Estimation

Note that in the context of the offset-free N.M PC formulation, where the quantities that rnust be estimated comprise both the state and disturbance vectors , the state vector
Xk

in the discussions to

follow should be thought of as the augmented vector of states and disturba11ces. i.e .

pf lT
5.1 Extended Kalman Filter
The exl t:nded

The f<ctlillct.ll IilLer [:3--l, :35] is the optin1al filter l'or Ull<:onsl rained li11ear sysLelliS.

1\alman filter (EKF ), as the name suggests , is au extension of' the linear Ka lman filtering algorithm to nonlinear systems. However, the EKF is not an optimal solution to thr nonlinear fi ltrring probkm, but is essentially a couvenie11t, improvisatory approach to the so lution of a highly complicated problem. The foundational principle of the EKF is that the state errors are 'small', i.e . the true state is suffidcntly dose to the estimated state, such that the error dynamics can be described fairly accurately by a first-order Taylor series expans ion [12]. Practically, this amounts to application of the well-known recursive linear Kalman fi ltering equations to locally linear approximations of the nonlinear model. Despite its ad hoc formulation , and absence of stroug theoretical justification, the conceptual simplicity of Lhe EKF implementation has made it one of the most widely used algorithms for

Figme fi.l: Cont.innons-discrete extended Kalman filt.er.

5.1 Extended Kalman Filter

41

nonlinear state estim ation. J\:[any published accounts of Nrv'IPC applications (see for example [1, 70 , 72 , 2]) have used EKF based schemes successfully for state estimation. In this Section, we

pr8St-mt t·he eontinuous-discrf:-'tf:-' (i.e. c-ontinuous rnodP-1-discrete measurements) extended Kalmau filtering <1lgorit.hlll which was used in this work. This configuratio n is appropriate for most chem ical engineering app li cations, as chem ical process m odels arc naturally formulated in conti nuous-time, a nd digital cmn J.lll ter systems used to monit-or most processes are on ly capable of samp ling the plant discretely. For details on other configurations, such as the contin uous, and discrete EKF algorithms, the rea der is referred to the introductory text of Crassidis and Junkins [12]. Many variations on the underlying EKF methodology have been suggested in order to improve its performance and stabil ity properties , for example. the iterated , and second-order EKF schemes [65]. however , on ly t-he original E KF scheme is covered here. Here. we shall consider continuous-time ODE plant models witl1 discnoLe nJP-asun-·nJeJJts of the form
.i·(t) = f(:r (t) . u.(t), w(t) , t)

(0.1)
.ilk = h(xk , tk)

+ 'l'k
respectiwl~·-

where x(t) E JR" and u(t) E lRm are the plant state and control inputs.

The vector

of process measurements Yk E JRP is assumed to be some nonlinear function h ( ·) of the state. The process (or state) noise w(t) E JR'l, and measurement noise '1',, E JRP are ass um8d to be i:ero-mean Gaussian white-noise pro cesses with symmetric covariance matrices Q(t) E lR"xn and Rk E JRPXP, respectively, i.e.

E { w( /.)117(7)} = Q(t:)o(t.- 7) (5.2)

E {1 1 ,,vJ} = R koki
Prior to proceeding fmther. it will be nsefnl to ex plain some of t he !t>nninology a.ml notation t hat is used t hroughout the re u1ainder of this Chapter. Ht>re. the tru,P slate :r(t) refers to the plant

state. i.e. the state of the actua l system which is under observctt.ion / control. Tn reality, one does not have accPss to the t nte sta.t.e. ThP only accessible information abont the plant are the available measurements

y,.,

from which a.n estimate of t he plant state :i:(t) can be inferred . Therefore , frorn a.

stric t notational point of view. all state and controlled output notation used in Chapter 4 should be thonght. of as slate and rontrolled output eslimnles, respectively. The state (or est im at ion ) error .i:

42

5 State Estimation

is defined as the difference between the true and estimated states , i.e. i:(t) = x(t)- i ·(t). The state error covariance matrix P(t) E
~n x n

is given by the following expectation

P(t)

=

E {.c(t)i:T(t )}

(.5.3)

A characteristic feature of discrete Kalman and Kalman-like filters is the recursive predictor-corrector structure of Lhe estimation algorithm. The notation :i:klk - l refers to the pr-eriicled state est imate at time tk given measurements up to time at
t~;;
tk _ 1 ,

while h :i k refers to the corrected (or updated) estimate

after the latest measurement Yk is available. The covariance matrix notations Pk lk- l and Pk lk

are definwi similarly. Figure 5.1 depicts scltematically the prediction and correction stages of the coHtiuuous-discrete EKF algorithm. In between sampling instances, the continuous-tirrHJ nonlinear plant model is numerically integrated forward in Lime in order to obtain a prediction of the plant state estimate .i·k lk- 1. However , as seen in the figure, whenever a rneasure. m eut becomes available (i.e. at each
t~,;) ,

the

predicted state estimate is corTected (updated) instantaneously to obtain i:klk. reflecting the effect uf the most recent measurement. In the following subsections, we will briefly outline the prediction and correction stages of the continuous-discrete EKF algorithm.

5.1.1

Prediction
i:k -JI A: - l

In the prediction step , the previous state

and covariance

PA: - I !k - l

updates arc propagated

over the sampling interval to give predictions of the current state ::i:klk- 1 and covariance Pk lk- 1, respectively. According to t he continuous-discrete EKF algor ithm , the predicted state estimate (also known as the predicted, or a prior·i mean) is obtained by directly propagating (i.e. integrating) the nonl inear system over the sampling interval. However , the predicted error covariance is obtained by propagrtLing the matrix H.in:at i dirl'en'nLia.l eqtta.t ion HiiSOC'iHLerl with t.he <·outinuou:o-discrete l'inl'.aT Ka.lma.n filtering alguritluu , LogetheT with the nonlinear system. Therefore , the state and error covariance predictions can be obtained by integrating the following system

[ P(L)

~(t)

l[

f(i(t) , ll(t),O , t)

F(-)P(t.) + P(t.)FT()

+ C'()Q(t)C:T(-)

l

(5.4)

5.1 Extended Kalman Filter

43

over t he sampling interval [tk _ 1,tk]· Here. the matrices F(-) E IR 11 x" and G(-) E IR 11 xq are Jacobia.ns of t he continuous-time nonlinear model given by

F(-)
C(-)

=.o:

af(.i(i.), ll(l.), w(t), t.)jai

(5 ..5)

= Of(i(t.), v(L), w(t). t;) j aw

Finally. Lhe predicted state est imate ran be nsed t.o calculate the predicted onLput (or measurements)
:lJk using the equat ion

(5.6)
For m!line implernentat.ion , it should be noted that since the sta.t.e error covariance matrix P(t ) is symmetrical. integrntion of the entire matrix differential equation in (5. 1) need not be performed. Inst.C'nd, only the nprr:r or lowC'f t.rinngn lar mnt.rices of t.h<' diff<'r<' ntinl <'({liM ion (i.e. on ly n(n + 1)/2 t->qnations) ueecl be iutegrat.f'd together with the nonliuear pla11t model. Naive implementations of t he EKF prediction algorithm can result in poor performance for large-scale systems. Numerical implementations utili;-;ing the special structure of the EKF equations , such as the ESDIRK scheme propost-:d by J 1 1rgense n, KrisLt-:JISen , Thom:;e11 ,
i:liHJ

Madsen [29), should he pre l'erreu in s it nRtions

where naive implementations are expected to fair poorly.

5.1.2

Correction

In tl1e correction (or update) step , the predicted state and error covariance are corrected using the most recent measurements y,.. The EKF update a lgorithm is completely identical to the cases of the discrete and C'ontinnons-disrrC'tC' linen.r ha.lman filtC'rs, <'xcept here, th<' ontput matrix of t.he linear system is
n~ placed

with the output. Jacobia11 of t he nonlinear system . ThereforE'!. the EKF state a nd
eq uation~

covariance update

are given

b~'

i',.l ·· = .i\ ik- 1 + J(..(y.- - .~k)

(5. 7)
] Pklk- 1

h1 ·· = [ I - K~rH (.i:k f k-1·1...)

where H (:i:k fk- l, t k) = Dh (:i:k fk- l, tk) /Di' is the output J acobian matrix of the nonlinear model. and J(k is Lhe Kalman gain giwn by

44

5 State Est imat io n

5.2

Unsce nte d Kalman Filter

The EKF algori t hm described previously is conceptually simple, relatively easy to implement, and perforllls reasonably well on several systems of interest. However , t il e error introdtH.:ed by lin-

earization in the EKF procedure can occasionally lead t he filter to perform poorly, and in certain situat ions, can cause the fi lter to di verge cornplC'tC'l.v [:l2]. for example'. Haseltine and Rawlings [27] provide a number of examples showi ng t he failure of t he EKF for relatively simple chemi cal engineering systems. Furthermore, calcu lation of analytic J acob ian matri ces required by the EKF is highly time-consuming n.nd prone to hum an-error . finite diffNC'l1CC' J acobians nrC' an obvious solut ion to t his prob lem, however, t hey are co rup utat ionally expe11sive to evaluate and can in trod ucP addi t ioual errors. The unscented transform [30 , 31 , 3:3 . 32] (UT ) on which t he unscented Ka lm an fi ltrr (U KF ) is bns0d was ckvdopcd to ov<'rcomC' probkms associated with li ncariz ntion in t he EKF, wh ile lllaintaining t he coinputa.tiolla l advant ages of t he Kahnan-like recursive predictm-corrector structure. The UT is founded on the notion that "it is easier to approximate a probability distribution than it is to approximate an arbit rary nonlinear function or transform ation" [33, 32] . Following t his approach, a deterministic set of so called sigma points abo ut the prior condi t ion al mean are initiated and t ransformed through the nonlinear process model to yield a cloud of transformed points. The statistics of t he transformed points can then be used to develop an est im ate of the trans formed mean and covariance [:32]. Julier , Uhlmann, and Durrant-Why te [33] . and Jul ier am i Uhlmann [32] show t hat this procedure results in a filter which is more accu rate t han the E I<F . and whose performance , in fact, lies between t hose of t he modified , t runcated sccolld-ordcr filter, a ud t he Gaussian secondorder fil te r. F'urt he rrnore, th e UKF behaves , in every practical se nse , as a black bo.c filter , requ iri ng only that t he nonlinear process model be suppli ed , making it much easier to implement t han the EKF which requires, adtli t ionally, t hat the J aco biau he specified. a ud the sccoud-orclcr filters wh ich require both the Jacobian aml the Hessian. Despite its ma ny pract ical advantages, t he UKF has received surprisingly relat ively very little attent ion , until very recent ly, from t he chem ical engineer ing an d process control community. Romanenko and Castro [G7] applied the UKF a lgor ithm of .Julier, Uhlmann , and Durrant-Whyte [3:3]

5.2 U nsce nted K a lman Filte r

45

for

~;ta t e

est im ation of a hig hly nonli near nonisotherm a l exothermi c CSTR. They

~; b ow e d,

t hrough

simulations, t hat the UKF greatly outp erfo r ms t he EKF , especially in high noise situations where Lli e efi'Pc:L :; o f lineari zat ion begin L o a.fre<:L qua lily of EKF sla.te esl i1n a les. In a fo llow-up study, Rorn a nenko, Santos, and Afonso [68] compared EKF and UKF p erform a nce on a simulated p H system having a nonli near measurem ent model. T hey showed . using a number of examp le cases , that t he UKF provides bet te r l:itate
est i m ate~;

t han t he EKF for t his a pplication . Recent ly. Pra kas h, Desh-

pa nd e. a nd P atwardh a n [60], a nd 1\l ara.fi oti, Olaru , a nd Hovd [1-lj have ap plied the UKF for state rstim i'lt ion in cont.rx t. of nonlin <Oar m odrl prr<iirt.ivr controllers. Kolils, Foss, a nd Schei [38] have sugge~; ted

a. 1111111ber of 1nod iric Ht.io1l s t.o Lhe sLH nd a rd ll l<F

r~lgori t h lll

to liH !Hll t> I'OilSt rai ned est imAt ion

probl etns. They s howed t hat l he mod ifi ed UI<F pe rfo rms we ll. eve n for systems wit h mult im od <l l proba bili ty density fun ct ions . using t he E KF-failu re exa mp les of Haselt ine and Hawlings [27]. Ttl
l li i~;

Scct iotl. we fin; t

pr e~;e t lt

a genera l UKF a.lgo ri t. lill t <;OI'!'l's po nding t o t he

~; i t u at i o n

where

t he process and meas11remc nt noise vectors appear nonlinearly in t he system a nd measuremen t m o de ls . res pect ively. vVhen t he p rocess and / or measurement noise vectors are assumed additive, as is qui te often t he <;aSt\ certain s irnplifi <;ot ions to t hb procedure (;o.ll be rn ade, whi <;h sha ll be discussed towards t he end of t his Section. Therefor e, consider t he genera l discrete-time nonli near mo<iel

(5.9)

whe re

Wk

E JRG is t.hr process noise. a nd a ll ot her q ua nt it ies a re as pre vio11s ly d efi ned. v\ 'e star t by

<i efin ing

fl

'new· vector

:rJ; _11k _ 1 . by lnif!;J lll:'llting

l he sLrt l e vec tor wit h t he p rocess a nd rnea.sm ernent

noise vecto rs to give
.l.k -I JA ·- 1

..rs

=

[xT w[_l k-!J k -1

,1,T k- l

JT

(5.10)

where .r k - ! J k - l E JRn + q+p is kn own as t he augmented state vecto r. The model (5 .9) can be easily rewritten in terms of :~ · ~ - tJA: - 1 , therefor e

·" ·1· k + !J k -

f "( .I ·" k Jk·

IL k , I k )

(5. ] 1)

46

5 State Estimation

The covariance matrix P;,'_ 11 , by the matrix

_

1

of the augmented state vector

Call.

in the general case. be represented

pk -1jk-l

p xw k-1

p xu 1.: - 1

pk-1 jk -1 =

pw.r.

k-1

Q,. _l
p vw
k- 1

P'"" 1.:-1
Rk - 1

(5.12)

p u2· k- 1

However , in many prac:tical situations, the state error , and process/ measurement noise vectors are not correlated among one another , therefore, the above augmented covariance matrix can be simplified. yielding

P~'-llk - 1

o qx n

(5.13)

where, for example, the notation 0 11 xq indicates a zero matrix with n rows and q columns.

5.2.1

Prediction

The prediction step ill the UKF algorithm consists of two suu-stej.JS, firs t, the generation of a set of sigma points , second , followed by propagation of the sigma points through the nonlinear model to obtain a set of transformed points, which are then used to develop an a p1"io1·i estimate of the plant state. These sigma points are not generated randomly, unlike for e.g. particle filters , but are chosen carefully such that they satisfy certain criteria, namely, they must have a mean equal to the previous state estimate
i~ - llk - I,

and a sample covariance equal to the previous covariance

P~'_

1 1 k_ 1 . Using
zem-rnwn

the notation of Rornanenko and Castro [67], letting n'" = (n

+ q + p) , a

set of (2n°

+ 1)

sigma. points can be computed from the columns of the matrix
v· [ o (2n"+l)x1

"-k -ljk-1-

(5.1 ,1)

Here, " E lR is a scalar parameter that can be used to 'fine tnne' higher order moments of l he distribution , and can be used to reduce overall prediction errors [:33]. If t he disLrilmlion of assumed tu be Gaussian, Julier , UhlJnaiiii , all(.! Durrant- Whyte [3:3] rec:ollllrlend that
K

.L'k-

is

be chose11

such that na +"' = 3, howewr. n. dif[rrent. choice of"' lllight. be reqnired if a differPnl. distribntion of

:r, is assumed. Note that in equat ion (5. 14) it is asslllned that the st.rnclure of the matrix square

5.2 Unscented Kalman Filter

47

root is of the form P

= /PJPT

Using t his convention, t he columns of

Xk- 1 tlr-l
JP

form the set of

sigma points. Ho wever, if the root is of t he form P =

/PT /P,

the rows of

together with the

zero row vector 0 1 x (2 n" + 1l forms t he complete set of sigma poiHts [33 , 32]. To eval uate t he matrix sqnare root , .J nlicr nnd Uhlmann [:32] recommend mlm<'rically efficient and stable methods. such as Cholesky factorization, for vv hi ch efficient algorithms a lready exist. The s igma p oint. set in (5 .14) is
zero-me<~n ,

but. has the s;;nne variance as the augmented stale :i:z _ 11 k _ 1 . T he mean mus t be corrected

by t he addition of the previous estimate i:r._ 11 ,._ 1 to all points in t he set , i. e. to every column in

Xt_11 ,,_ 1 .
nice ly by

Therefore. using Kronecker prod uct notat ion, (true mean ) t his can be rrpresentt>d very

(5. 15) where the notation 1 1 x( 2 n" + l) refers to a. matrix of ones with one row and (2n°· + 1) columns. Note t.hat t.he past estimate (mean)
.i-~ _

11 ,._ 1 in (5. 15) is given by
(5.16)

Each sigma point in the set

,yk - l[lr - l

is propagated through t he nonlinear model , i.e. integrated

forward in time, over t he samp ling interval [tk_ 1, tk], to generate a set of transformed points rl:'~r[k- 1 . Therefore. with some abuse of notation, this op eration can be represented by (5. 17) The a pTiori state est imat e point s, i.e .
2nn + l

.i·;:[ k-l

can then be ca.lculat.ed as a weighted average of t he transformed

x··t k - 1 =

2:.::
·=I

w,x.. klk- 1
,{'A·[Ir - l·

(f>.18)

Here, t he notation

X ;.A·[k-l

refers to t he

ith

co lumn of

and I'll, is the associated weight. The

weights W; are chosen according to t he algorit hm

K/(n° Wi= {

+ K)
11

if i = 1 (5. 19)
if' i

1/2(n

+K .)

I=

1
K.

In general. the weights can be positive or negative depending on the choice of

however. in order

to provide 1m biased estimates, they must satisfy the condit ion :Z::: i IV, = 1, which can readily be

48

5 State Est imation

verified from the above equation [32]. The predicted error covaria nce Pklk-l is given by a weighted outer product of the transformed points, i.e.
2n u+ l

Pklk-1

=

L

w i[x

i,A:I A ·-1 -

h1k-1l [ x i.ki A:-1

-

i:kik-l (

(5. 20 )

i=1

The propagated se t of sigma points Xi ,klk- 1 are then mapped through the non linear measurement model/in(-), yielding a :;et of outputs
Y~.:

given by

(5 .21 )

The predicted out put [h is calculated in the same way as the predicted state estimate i:klk-l, i.e . by taking the weighted sum of t he outputs Y k, t herefore
'2n "+ l

:0~.:

=

L

W iY i,k

(5. 22 )

i=1

Finally. t he innovation covariance Py and the cross correlat. ion PJ.Y matrices can be calc ulated from the following expressions
2n"+l

Py =

L

l·'V, [ Y i,k - Yk

l [Y ,,k -

Yk

]1'

(5 .23)

i=l
2n° +1

Pr.v =

L

wi[ X ;.klk-1- :i:.,IA--1] [Y i,k- YA- ]r

(5.24)

i= 1

If the process and / or measurement noise vectors are addi t ive, ta ke for example, the disturbance
model (4 .12), the model state vector need not be augmented with the approp riate process and/or measurement te rms. Instead , for additive process noise, t he covarian ce mat rix Q k can be added directly to equation (5.20) , i.e.
2nu+l

Pklk-1 = Q k

+

L
1=1

wi[ x i,klk-1- iklk-1] [ x i.klk-l- xkik -l ]r

(5. 25)

Likewise, for additive measu rement noise, the covarian ce matrix Rk can be added direct ly to equat ion
(5. 23 ). i. e.

Py = R~-:

2n" + l

+

L

IV, [ Yt.k - Yk

l [Yt.~-: -

YA

l

'!'

(5. 26 )

i=l

5.2 Unsce nted Kalman Filter

49

5.2.2

Correction

The UKF 1;tate an d covariance upd ates can be calculated using t he foll owing equation1;

{5.27)

where the Ka lma n gain

!<:~c.

for the unscented fi lter is g iven b)'
; = P,. 11 P1 1

J( k

{5.28)

PROPERlY OF RYERSON UNIVERSITY LIBRARY

Chapter 6

Controller Implementation
The hear t of the N.tv!P C a lgo rilhm is t he onli ne solut ion of a compu t.at iona lly t ractable op l ima l con t r ol p roblem owr a fin it.c hori zon to d etermine t he control profi ks to h e im pl r.mrnt.ed. At each sampling instan t, t he current plant measurem ents arc sent to a state estimato r , such as an extended

(i<;KF ). or unsce nted K a lma n fil ter (UKF ), which co nstr ucts a n estimate o f t he plant state. T he
est im ated state is then s u pplied to t he M P C contro ll er to initialize t he fi n ite hor izo n optimal contro l

problcrn. O nl y t he first control in put v 0 in t.hc op t imal sequence is sent to the pla nt . T his p roced ure is t, hen performed repeat edly whenever new pla nt. measurements a re ob tained. In both t he nom ina l a nd oH'sct- frec Nl\ IPC f'or n JUhl.t iol lS discussed in Ck1pter ·1. we
i:\.~S U IIICd

i111plici t.l:v that a d iscrete-

t ime process model Xk+l = .f(xk , uk, tk) was readil y available. However . t he au toclave reactor models o u t li ned in C ha p te r 3 are defi ned in cont inuous-t im e. and t herefore, must be disc ret ized in order to m a ke t he NMP C formulations amenable to solu t ion using convent iona l NLP so ftware. In t his study, we employed a 'complete discretization ' a pproach using or t hogona l collocation o n fini te elemen ts (O C FE ), i.e . bot h t he co nt r ol inputs and t he state vari a bles were discretized , as opposed to only the cont ro l in puts, whi ch is t he case in cont ro l vector parameteri zation (CVP ) based a pproaches . In t his C ha p ter , we provide a detailed descript ion t he pa r t icular O C FE schem e implemented in t his stud y. Ort hogona l collocation be longs to a fam ily of numerical integratio n schemes collectively known as t h e me thod of weighted resid na ls (lVfWH ). The 1md erl _v ing assmn p t ion of MWH method s is t hat

52

6 Controller Implementation

the solution to any system of diH'eren t ial equations can be approximated by a linear combination of chosen trial (or basis) functions , i.e.
5:(1.) =
N

2: u. ,tp, (t )
l=i

(6. 1)

where i( t) is the solution profile , 'P: ( t) are appropriate trial functions , and a, are unknown coefficients. ln grnC'ral, i\ lWH. nlC'thods can be applied to help solve ODE , DAE , and PDE systems , however, the discussion in this section is focused rnairdy
<HI

ODE systerus. For an arbitrary ODE

system given by i :( t ) = f(x(t). u(t) , t), a residual function R (t) can be defined by substituting the trial solution (6.1) into the ODE model to give

R(t ) = i(t) - f (i:(t) , u(t), t )

(6.2 )

The residual function is a measure of the accuracy with which the trial so lution approximates the tnrt' solution. The coefficients

a,

in equation (6.1 ) are determined by for cing the integral of t.he

weighted residual function to be zero over the required domain , i.e.

t }to

1 '

'w;R(t)dt=O
Wi

(6.3)

Vi = 1, 2, . . . , N. The choice of weighting function

in equation (6.3) is characteristic of a par-

ticular MWR technique. For example, if wi = ti - l , then t he MWR technique is referred to as the method of moments, since the first N moments of t he residual function are forced to be zero. A detailed discussion of other MWR tedllliques can be found in t he seruinal texts of Fiulayson [22] , and Villadsen and Michelsen [86]. The collocation method forces the res idual to be zero at N distinct points L, (known as collocat-ion
po 'i. nts) in the donrain , i.e.

R(t ;)

= 0

(6.4)

\:Ji = 1, 2, ... , N . In the language of equation (6.3) , the weighting function for the collocation method

ca11 be thought of as the shifted Dirac delta function b(t- t;) which has t he following property

l

tK

r5(t- ti)R(t) dt = R(t ,) = 0

(6.5)

l.o

If the collocation points are chosen at locations corresponding to the routs of au orthogonal polynomial , the collocation procedure is referred to as orthogonal collocation. By positioning the collocation points at the roots of an orthogonal poly nomial, the collocation method attains a number of

53

interesting properti es . References [50. 22, 86] and citations therein discuss these properties in some detail. Henceforth. in this Section. particulars of the actual ort hogonal co llocation met hod used in the
Ni\1 PC implPmrntfll inn. a.long wil.h its Pxi.Pnsion to flnilr PlPmenls will be disrnssed. Here, we will

make exteusive use of the notation found in the work of Cuthrell and Biegler [13]. Consider the system (6.6) modeled by u set of ordinary differential equations over t he unit t ime interva l t E [0.1] given by

: i:(t.) = f (.x(l,), 1.t,, l.)

(6 .6)

wit h init ial state .r(O) = .r 0 , and where .r(/.) E IR" is the vector of system states, and u E IR"' is tile vector of' control inputs. Note t hat. here, t ile control input
tL

is considered to be constant over

the given interval. It will become clear from future discussions that keeping u constant over t he interval helps us enforce zero-order hold in between sampling instances . Following the princip les of t he rnd hod of weighted residuals, here, we assume t hat t he solu t ion to ODE
~ystem

(6.6) can be

a pproxim ated by a linear comb ination of Lagrange basis polynomials given below
/{

.rK+ 1(t) = L
1= 0

·ri¢i(t)

cj>,t)-

( _rr l.- '·k
K

k=O
ki>

-1, - lk

(6.7)

where (!\

+ 1)
Rr r

is t he number of collocat ion points. ·~'K - 1 (t) is the polynomial approximation to t he unknown coefficients, and t.,. is the Lime c-orresponding to t he (k

solution, .r;

+ 1)'·11

co llocat ion

poillt. Note that t he tilde over the polynomial ap proxima.l'ion is dropp ed for notational conven ience. Continuous control inputs u(t) , if required , can be handled in a likewise fashion, however, the case wil,h ronsLant control inp11ts is on ly considered here. The interpolating polynomial (6.7) in Lagrange form possesses two unique propert.ies that bear meutioniug. First, the interpolatin g polynomial :.r: 1<+ 1 (f) eval uated at collocation point t; reduces to the coefficient :r, i.e . .Yg+ 1 (t;)

= x;.

Thi s property is advantageous as it implies that evaluation of

the coefficients : r, is eqni valent to evaluation of t he state variables at time I.;, making eval11 ation of t he Lagrange polynornial
:1: K

+ 1 (t) unnecessary unless one is interested in determining t he evolution of

stal.f' profiles in betwef'n ('Ollocat.ion poinl.s-whirh is nnl the case in the present application. Second . t he uwf!kirnt.s .r; are physicall y mea ningful quanl.it.ies rorres pond ing to the art 11 a l sl.at.f' variables

54

6 Controller Implementation

of the ODE system [13], as opposed to some ar bitrary constants (see equation (6.1)) depending on the st rnct.nre of t.lw trial function. This property is somewhat rd n.trd t.o t hr first. and is especially useful iu the implemen tat ion of the target calculator aud regulator NLP,;. B.v virt ue of t he fact t hat t he coeffi cients of t he Lagrange bas is polynomial and staLe variables (at the co llocat ion points) are equi valent. thr definition of bound and pFlt h constraints on the st at.cs, as wrll calculat ion of t he re::; pect ive objec t ive l'unctio ll:> iti 11 1ade sigllificallt.ly silllpler. In t his case, the residual functi on R(t) can be expressed as was clone previously, i. e. by substitution of the Lagrange basis polynomial (6 .7 )-thc trial fun ction- into the ODE model (6.('i ) to yield

R(t)

=

L
i=U

}(

x;¢;(t)- f(xK +l(t) , 11, t)

(6.8)

According to the principle of collocation , t he residual (6.8) is required to be L:ero at a ll (!( collocation points. t herefore
K

+ 1)

R(lj) = ,L x;¢;(1 j)- f(.rj,U,lj) = 0
i=O

(6 .9)

Vj = 1, 2, ... , K.

F\1rthermore, we also require that t he initial value problem be provided with

the initial state vector :c 0 , i.e . the state vector corresponding to t 0 . The only remaining issue is to specify t. he locations of the (I( + 1) collocation points lj on the solu t ion element [0. 1]. In this implementatiou. two co llocatiou poin ts were posit ioued at t he lower an d upper boundaries of t he element , i. e. at t 0

= 0 a nd t g = 1. respectively.

The remaining (A"- 1) interior· collocation points are

positioned at locations corresponding to the roots of a (K - l )th order shifted Legendre (ort hogonal) polynowia.l. Figure 6. 1 is a saruple schernatic showing a single co llocat ion element with iu terior collocation points corresponding to the roots of a third order shifted Legendre polynomial. The set of nonlinear algebraic equat ions (6 .9) must be solved simultaneously in order to obtain L he Lagrange coefTicients
J'j,

which in this case, are also the system states at t imes t1 . The derivatives
it h

¢i( ti) in equation set (6.9) depend only on the

Lagrange basis polynomial and the location of

the collocation point Lj, and can be evaluated beforehand . In this study, the Octave interface to the Villachen and Mi cbelsen [86] rou t iu es was used to evaluate q~i( lj), and also to identify roots of the orthogonal shifted Legendre polynomials . Wi t h respect to implementation of the
N~,.!PC

algorithm ,

the equalion set (G.9 ) cau be thought of a.s nonlin ear ·model constraints ' for t he regulato r NLP,

55

to

Figure f:i.l: Single col lo cat.ion elem ent with interior collocation points corresponding to t he roots of a t hird order shifted Legendre polynomial. i. e. these equations represent the process dynamics , which are accommodated as nonlinear algebraic constraints within the fra mework of the regulator NLP. The notation user! in equation set (6.9) is r at her cu mbersome, however , it can be expressed quite elegant ly using the matrix notatiou of !l leaclow:; and Rawlings [50], therefore <i>oX - F (X , u) = 0 where (6. 10)

0
~t( LJ)

0

¢2(l t) ¢2(t2 )

¢Jdt J)
(~{{( 12 )

<l> o =

J;l( /2)

¢tUK)
and

¢2(1[( )

~K(/.K )

:t:o.1
XI.J

xo.2

Xo.n

~- o

.,.T

X =

Xt,2

F (X,u )

=

XK.l

l : /( ,2

XJ(,n

Here. n is the dimensionality of the system state vector , and 4> 0 is the collocation weight matrix . The notation
:r: i .j

E lR used above deno tes the yth staLe variable at L he ith col location point. and
-i.

:1: , E IR" deuotes the en l ir-~> state vector at the

1

h co! locH.t ion point.

The co llocat.iou procedure

described previously is m inrnon ly known as global co ll ocation . and was restricted specifi cally to t he [0, 1] interval. ThPrefore. it. is necessary to expand thi s procf:dnre t.o an interval [lo, lK ] of arbi t rary

56

6 Controller Implementation

Figure 6.2: Col location 011 hnitc

clel n ent~

witl 1 iHterior collocat ion points

corre~ponding

to the

root~

of a third order shifted Legendre polynomial.

length. This rrt n be achieved by, First, positioning t.lw colloca.l ion pn inls on [io , II\ ] aL locations that correspond proportionally to t he points on the [0, 1] interval, and
~econd,

by dividing

(~ca li ng)

all but the First row of the collocation weight matrix <i>o in (6 .10) by the length of the co llocation element, i. e. by

UK

-to).

Iu t his study, the global collocat ion approach using a single collocation element is employed to discretize the nonlinear model (6.6) over a single sampling period, i. e . over a unit horizon. This strategy can be extended to a horizon of any desired length using orthogonal collocat ion on fin ite elernents (OCFE). The principal feature of OCFE is that, here, orthogonal collocat ion is ap plied consecutively on smaller, possibly unequal, segments called elemcnls with the requirement that t he state profiles be continuous across the element boundaries. Figure 6.2 is a schematic showing the OCFE methodology a pplied to a ? - interval prediction horizou. In t his study. each collocatiou element in the sequence was requ ired to be of identical length, equivalent to the sampling interval T 8 · The primary advantage of using a single co llocation element per sampling period is that it ren,dily yields state infonn ation at t he elelllent boundaries, which is reqnirt>d for eva!netting tl1e regulator
co~t

function in the NMPC fo rmulation. However , t his app roach can become computationally cumbersome for 'long' prediction horizons. In such situations, it. is usually beneficial to inc rease the length of the collocation elelllent with respect to t he sampling interval. as t his reduces t he total number of collocation points required , which in t urn also reduces the online computational load incurred. The nonlinear algebraic equations for the OCFE discretized problem, can be expressed ana logously to the case of the global collocation app roach , therefore

(6. 11 )

57

where

~=

4> 1

and
:ro,I

a:o.2
XJ .2

.ro,n

XT
0

.ru

f T (.rJ~, II.(), fT ( .1'

f.){)

X =
J'2J\.I
·~'2/\.2

f(X , u) =

i< + 1, lL 1. t K + 1)

:I'2K+l.n

:J:p f\.1

.l'pf{.2

Xp [{. n.

Here. 4> 0 is defined ide ntically to the global C'ollocation casP (see Pquat.ion (ti. lO )} . whereas tf> ,,;o ronsists of all row~ in ci> o with the exception or t he rirst row. i. e.

¢1 (ti)
ci>,,;o =

¢2 (ti)
(~2 (l2)

J>g(l1) ¢K(/,2)

rftl (/-2)

cPl(tJ< ) cP2(ti<)

cPK( tJ< )

The vector u reprrsrnts t.he srqncncr (or profile ) o r t.hr control inpnt.s ovrr t hr ? - interval prediction horizon, i.e.
u = [v~

u.f

T

,y

UP - l j

It is importilnt. to not P the <thnost. block diagonal (A 13D) structure or the collocat ion weight rna.trix 4>
in equation (6. 11). This st ructure arise;; from the overlap of collocation poi nts at. t.he rinit.e element. boundaries. For exarn plr. given a predirt;ion hori zon P

= 3, the

resulting collocation weight matrix

58

6 Controller Implementation

obtained is given below .
0

~~(ttl

~2 (tt)

~g( tg )

~l(tl)

~g( tg)

~t(lt)

~z(tt)

Chapter 7

Results and Discussions
Compil.n~d

to

~videly-used

process control approaches , such

As

conventional PID ::tnd Lr--'IPC contro l,

NMPC is s iguifica utly ruorc <·ornpli<.:atcd to ir up lcmc rr t, and requires llluclr higher cornputationa l expenditure to solve Lhe resulting NL Ps. Therefore , prior to im plementation, iL is extremely importaJLt to justify the selection of NMPC over establi shed appro;;cl res. In t his Chapter, we evaluate, via simulations. the performance of the N1-'!PC formulation for the control of both sing le and
multi-~one

LDPE ;mtocla.ve rea.rlors. \Vherever appropriate, we ronLra;:;L the NMPC performancf' direcUy with tha.t of PID and LMPC a lgorithms. Before presenting the results. we will brieflv 011Liir1P !.he PID and Vv1PC controller algorithms used in t his study.

PID Controller Algorithm
The standard proportional- integral- derivative (PID ) control algorithm basically invo lves the superposit.ion of Lhe proportional, integral, a nd derivative controller modes. Given a single-input

single-output (STSO ) loop pairing, the basic a.rw.log PTD controller a lgori thrn is given by
1

u(t;) = J\·" ( e() t

de(t)) + -l i ' c(t)dt + To-. - + u.,
Tr. 0

dL

(7. 1)

Here, P(l) is'"' scalar deflrlPcl as Lhe error lwtween a. pa.rt.icrd ar cnnLrollecl output and it.s set.po int, therefore , for the
ith

coutrollt'd output, e,(t) = z., , (t)- z,(t). The closed- loop performance of the

PI D ront rollf'r is governed by three (scalar) tun ing parameters. namely. t.he controller gain I'i:c,

60

7 Results and Discussions

integral time

TJ.

and derivative time

TD.

The proportional term in the PID controller algorithm

produces a signal proportional to the error in the controlled outputs. while the integral and derivative terms produces signals proportional to t he integral and derivative of the error , respectively. The net controller output is the sum of the three signals. The analog PID algorithm (7.1) is not suitable for online implementation on conventional digital computer systems, therefore, the algorithm is usually
discretiL~ed

(zero-order hold) and expressed in the iterative velocity form. shown below [80. 81]

(7.2)
where Tis the chosen sampling/ control interval. Note that the velocity form requires storage of the past error
ek - 1

for PL and the past two errors

ek - 1· ek - 2

for PID control.

The tuning parameters used iu the PID coutroller simulatious were obtained using the simp le internal model control (SHviC) tuning rules recommended by Skogestad [77 , 78 . 79]. Like most published PID tuning rules , for e.g. Ziegler- Nichols. the SIMC tuning rules require that the process dynamics be approximated by a first (FOPDT) , or second order plus dead Lime (SOP DT) transfer function model. The reader is referred to the works of Skogestacl [77 , 79] for details on the derivat ion and evaluat ion of the Sll'vlC rules. For both autoclave reactor models, we found from step tests (not shown)
Oil

tl!e

lineariL~ed

model that an FOPDT model provides an adequate approximation of the

linearized model dynamics , therefore , the tuning rules in [77 . 79] corresponding to the FOPDT model were used. Note that manual detuning of the PID control loops was required in order to obtain good , stable closed-loop responses for the nordiHear plant model.

LIVIPC Controller Algorithm
The offset-free Ll\'IP C formu lation used in this work is the exact li near analog of the otiset-free Nl\'lPC formulation discussed in Secti011 4.2. The liHear disturbance (i.e. internal) lllodel employed by tl!e contro ller allows for , in general, integrating disturbance inputs on both the states and measurements, as was the case with the nonlinear disturbance model (4. 10), therefore

(7.3)

61

where t.he discret e-t ime linear model J acobian matrices <I> E

rn;nxn

and f E

rn;nxm

are defined by

c:ond it iou s. Here , the function f(:I:k, uk) represents t he discrete-time nonlinear process model. In practice , however , the discrete model .Jacobians a.re derived from continuous model J acobians using t he wel l-known formulas

(7.4)

where A E rn;nxn and B E lR'"""' are the Jacobian matrices of the continuous-time nonlinear model evaluated at the desired ste<tdy state conditions. and
e AT

is the matrix exponential operator. Softc2d

ware implem entations of the matrix exponential operat ion. Sllch as the

function in

MATLAB,

are available to f'OlJvert continuous-time linear tirne invaria.11t (LTI) plant models to discrete-time LTI models. Th e clisturbEl!lce rnatrix

rd

E

rn;nxnrl

models the effect of the integratin g disturbance

inpu t Pk on the system dynamics. The outpllt matrices

c c JRP X

n

and cd

c

JRfi Xn,, relate the state

:r" and disturbance

, vectors to the measurements 1/k. respectively. The contro lled output matrix p1

H E lR"" xp relates the measurements to the controlled outputs

;;k·

The integrating disturbance

st.ales are ass um ed t.o remain constant. over the prediction horizon , therefore

Pk+l

= Pk + ~k

(7.5)

Similar to the orfset.-free Nl'vfPC algorithm , the offset-free Ll\:fP C <J.Igorithm consists of targr.t calculator and regulator components. In this case, t he role of the target calculator is to identify steady staLe (equilibrium ) targets of t he of the linear disLmbance modPl (7.3), wh ich satisfy Lhe controlled output setpo int . ::,. and other necessary process constraints . Tn t his study, we impl emented a target calcu la tor formulation similar to ones proposed by Muske and Rawlings [54 ], and Pannocc:hia and Rawlings [G 7] for Ll\'IPC shown below. min
Yt d , ll.t ,J

(7.6a)

subject to:
I - <f> [

-r
0

HC

l [ [ l
l ' t.,)

(7.6b)

11 1 .. .)

62

7 R esults a nd Discu ssion s

(Hie)
The first equality in equation (7.6b) is the steady state condition for the disturbance model , while the second equality condition requires that the controlled output
Zk

achieves its setpoint z,. at the

target steady state. Tl1e regulator fonnulation en1ployed in tl1e oH'set-free LMPC' formulation is virtually identical to the case of the offset-free NfvfPC formulation. By defining the following two deviation variables ,
't.u~.: = :r·~.:-

x1 .,j and

1> 1.:

= v~,;-

U.t ,j,

the reg11lator quadratic program (QP) that

is solved at each iteration is given by

j+P-1

ll wi+P li~·TJ-ITQJJC +
subject to:

L

l wk l 2rJ-ITQNC + ll 't'~,; ll it + ll .6. vk!l§

(7. 7a)

k=:i

(7.7b) (7.7c)

Uk='l!j+M-1

1::/k=j+M , j+M+l. ... , j+P -- 1

(7.7d )

ln order to facilitate comparison between the closed-loop responses of the NMPC, Llv!PC controllers , wherever appropriate , the two controllers were supplied identical tuning parameters. In the following Sect ions, we present results of t he simulation studies performed in this work in order to observe and compare the performance of the N 1PC formu lation for t.he control of the single and mult.i-w ne LDPE autoclave reactors.

7.1

Single-Zone Autoclave
rc~m l t.s.

Prior to discussing the closed-loop controller simu lation

it is beneficial t.o investigate the

steady state behavior of the the single-zone LD PE auloclave reactor modP.l. Figures 7.1 ami 7.2 are continuation diagrams showing the bifurcation behavior of the well-mixed single-zone LDPE autoclave reactor model, with the reactor residence time f)= V / q a:< t.he pr imary bifmcat ion parameter. The secondary bifurcation parameter is the feed initiator corH.:entration l 1 or the feed temperature

Tt. The bifurcation analysis of the autoclave reactor was performed by first. converting the singlezone reac tor model on llined in Chapter 3 into an equivalent dimension less form. General details on

7.1 Sing le-Zone Autoclave

63

1111 1
Ill

!U .,.-- -- - - -- -- --

--,

:.,

- - Ill o .~.> u'

8
,.:;

"'

:~

i3

0 .. 1

.

Ill1 11 I II

() .,- I I I

\1\

·-" I\ \
0
0

\ ' .::.::: ' .....__ _ _
10 20 Res . t ime, fl [m in .] 30 Res. t ime, fl [min .[

'

:!Oo

I

t
h

201)
I

,,,
~'

X

)(1(1

,, -'0:,.:,."":::"":::"":::"":::--:;;---------~- --- --:_::,
10

.....

[:.;:'
!\ .

c.
()'----~----------'

B.

/1 = 14ppm / 1 = 7ppm / 1 = 4ppm 30
.1()

()'----~--~-------'

0

20 Res. t ime, 0 [min.]

30

40

0

10

20
Res. t ime, B [min .[

Figure 7.1: Bifurcation di agram showing t he effect of feed ini t iator concentration 11 on steady state model behavior. how this procedmP is ca rried ouL can be found in references [73 , 26] among others. The cont irma.tion too lbox l'v1ATCONT [18,
17]

M ATLA B

was theu used to perform cont inuation a.ualyses on t !Je

d irn ensionless reactor model. Note that. solid lines (-) in Lhe fi gures indicate sla.ble equilibrium bra nches, while dashed lines (- - ) indicate unstable branches . T il e bifurcation di agrams iu bot h cases d ispla)' t he cla.ssica.l S shaped curve be!Ja.v ior consistent wit h the well-known ease of the nonisotherm al CSTR. A charact erist ic feature of such curves is t he presence of an unst a ble equi librium branch sand wiched
b etw~ee n

two stable branches. This results

in t he occurreucp of t hree equilibri um poiu t.s in the nonmd residence t ime opent t in g region of t he au to clave reactor. which is usua ll y in t l1 e l- 2rnin range. T he bottom low-temperature stable branch is associated wit h ext reme ly low monomer conversions (a lmost :tero) . and extremely high weightavf! ra.ged molecul ar \veights of poly mer (a.rouud 1 x 10 6 g/ rnol). T he operating point of t hE'! indust ri al reactor is usually located on t he upper high- temperature stable branch . or on the un stable branch in the vi cinily of t he upper st a ble branch . In this region , the achievable monomer conversion is in

64

7 Results and Discussions

0.2 m---~--~--~---

H > c
8

o.15

01

0

lO

10

40

Rc·. time, ~ [min.]

Re::; . time, 0 [min .]

:wu m---~--~--~---

~
h ci.

- c
200

I
\\

~

lOU

~----------3-----u
10
1()
l(J

~~

T1 = 5o' C T1 = 40"C T1 = JO' C
20
He:s. t ime, f) [miu .]

()L_--~-----~--___j

JO

40

Rc· . time, 6 [u1i11 .]

Pigure 7.2: Bifurcation diagram showing the effect of feed temperature Tf on steady state model behavior . the 10- 15% range , whi le the operating temperature is in t he 150- 275°C range . The weight-averaged molecular weight of the polymer produced iu this region is in the range of 0.5 x 10 5 3 x 10 5 g/ mol, which is sufficient for most commercial LOPE products. Note lha.t the bot.tom low-temperature stable branch is the ·uppe1· branch in t he case of t he molecular weight curves, whi le the upper hightem perature stab le branch is t he lower- stab le molecular weight branch. At reactor temperatures close to :300°C , unrnodeled ethylene decompositi on dynamics become dominant. leading to reaction runaway. Zhang, Read , and Ray [88], and Villa, Dihora, and Ray [85] present results on Lhe bifurcation analysis of single-zone LOPE autoclaves , which includes et hyleue decomposition kinetics in the process dynamics. The general offset-free :\MP C forlllulat iou discussed iu Chapter -! requires t hat t he struclnre of the distur bance modeL as well as t he controller tunin g pararu eters (for e.g. the pred iction, coutrol horizons , and Lhe qu ad ratic weight ing matrices) to be defined. ln general, the abili ty of the controller to ac hieve oflset-free co ntro l of the controlled variab les , as we ll as t he closed- loop stabili ty and

7.1 Single-Zone Autoclave

65

performance characteristics of the controller are governed by the choices of disturbance model and tuning parameters. In the following subsections, we will discuss some of the major issues encountered in the design of the Nl'vfPC/LivfP C disturbaJ1ce models, as well as the design criteria employed in the
~:>e l ect ion

of the Nl\1P C/Ll'v1PC tuning parameters for the control of the single-zone LDPE autoclave

reactor.

7.1.1

Disturbance Model Design

The ability of the Nl\fPC / Ll\!PC formulations to regu lnt c the cont rolled outputs at their sdpoints depends critical ly on the st m et nrc of t he disturbance model em ployed. The two primary requiretnents in the design of a ny disLurbattce 1110del are, first , that t.lte integrating disturbance states are observable from the available measurements, and second, t hat the disturbance states capture the ovemll effer.t. of tm mertsnrecl process clisLmbanres and plant-rnoclel mismatch on the controlled OtJLputs. In context of LMPC control of chem ica l process systems, many authors, for example, J\.'Iuske and 13adgwell [52], and Faanes and Skogestad [19]. recommend the use of input disturbance models in order to f\.r hieve offset-free cont.rol of the ront,rolled vrtriables. Their recommendations are . in parL, due to the fact that. in most pract ical situations,
di~:>turbanc es

to chemical processes are expected

to originate at the input , ahead of a dominant time constant, and very often at the control input , as opposed t.o at. the output , which is presupposed by output dist mbanc:e models [83] . However, as recommended
b~·

Tenny, Wright, and

Rawling~:>

[83]. a carefu l study of the steady

~:>tate

plant behavior

and expected disturbance dynamics is necessary before choosing an appropriate disturbance model. The structures of both the linear (7.3 ) and nonlinear (.1.10, 1.12) disturbance models described in L his work permit a combination of input and output clist.urbances, which is, as we show later, what was implemented in t his study. The ge11eralnonlinear disturbance model (4. 10) permi ts the inclusion of disturbance states in any arbitrary fashion. however . in this study, we utilized Lhe simplified dist. mbance model (4. 12) in which the disturbancP
state~

arP asswned to affect the system dynamics

and rnt-:asurements linear!)'. This rnodel has the advantage that t he matrices Xu and X?J in the Nl\1 PC dist.mbance model coincicle exacLl)' with, respect ivel.v. the matrices

rd

and Cd in the LMPC

distnrbance model. thus allowing for a direct comparison of t he two controllers. Unfortunately,

66

7 Results and Discussions

the open literature is essentially silent on the actual design of disturbance models. except in the case of Li\1PC (see for example, Pannocchia and Rawlings [57], Pannocchia [G5], Pannocchia and Bernporad (56], Muske and Baclgwell (52]), and a case by case approach assisted by simu lation is usually required in order to determine if a particular disturbance model is sufficient. Since on ly the two controlled outputs are measured onl ine, namely, the reactor temperature

T , and the weight-averaged molecular weight of polymer M

w:

using the results of Pannocchia and

Rawlings [57] for LlVIPC , we can only include up to a maximum of two integrating disturbance states in the contro ller model. In summary, the NMPC / LMPC disturbance rnodel matrices (see equations (7 .3 , 4.12)) used in this work are shown below.

x; ~ [J ~ [ :

0

0
0

0

0
0

0

0

0

:l

X y = Cr~

=

[:

0

100

l

Two points must be ruade c:lear on the disturbance lllodel matrices selected here. First , the dynaruic eq uation corresponding to the reactor tem perature (i.e. the dT/ dt = fr(.r , u, t) equation) was augmented with an input disturbance state (as is apparent from the Xu , I'd matrires). This is in line with the recommendations of [52, 19], albeit for Ll.VIPC. Second , the output/rneasuren1ent equation corresponding to the weight-averaged molecular weight was augmented with an output disturbance state (as is apparent from the Xy, Cd matrices). We believe that the output disturbance choice is more appropriate in tltis situation as the weight-averaged molecular weight M"' = AfoJ.L2/ p 1 is a nonlinear function of the states. If an input disturbance approach was adopted, one would have to a.dd input clisturbance states to one or more dynamic equations in the nonlinear controller model in orde r to accou nt for the eflects of process disturbances and plaut-Jnodel mismatch on the nwlecular weight. dynarnies. This approach is somewhat awkward , and does not. affect the molecular weight dynamics/measurement 'directly', ami therefore, was discarded in favor of the outp ut disturbance approach.

7.1.2

Controller Tuning Parameters

The selection of controller t.uuing parameters greatly affects the closed-loop stabi lity and performance characteristics of the control system . The tuning parameters which must be su pplied to the offset-

7 .1 S ingle-Zone Autoclave

67

free NM PC fo rmulation are t he prediction P and control !'vi hori zons, the regulator quad ratic pena lty mat rices Q, R , and S , and the target calculat or penalty matrices Q, U, and R. Unfort unat ely, as was t he case wit h t he design of t he di sturbance model, there are no clear guideliues avail able for t.he selection of t hese parameters , and nu merical simul ations and / or experiments a re usually required to judge if t he selected parameters are appropriate. In t he process of implement ing t he regulator
NLP, we first corr vPr t. Pd Lire nonlinea r process rnodel in t.o t he so cal led :;cct.l ed deviat ion form , by

int roduc ing t he fo llowing t ransformat ions fo r t he states. cont rol inputs, and control led out puts.

x;

=

(:r;- x,,)jx. ;,

Ti; = (11, - n,., )/Hi.,

Here. for exttrnple. t he notat iml .1:; E IR refers to a n indi v idual slate va ri able (i.e. not t he ent ire state vector ), and x,., E IR is a given scali ng facto r , preferably t he equ ilibriu m value of t he state variable. ln addition to im proving t he cond itioning of t he resnlting NLP, t he above t ra nsformations a lso help simplify select ion of t he tuning mat rices, if t he scalin g factors chosen are reasonable. In t his study,
272 .--------.---------.---------,--------,---------,

u
h

~

270

-- P = 1 - - P =2 ....... p = 10

~

~ 2G~
] ()

1:j

20

25

T ime, t [min .]
~
~

0 fl. l 5 E -......

s
X

I

5.1
G.05

[::S

"

~
0 .,..

:;
-1.95

-- P = 1 - - P =2 p = 10

""

0

10

15

20

2fi

T ime, t [min .]

F igm e 7.3: Effect of preciiction horizon on control performance. Closed-loop res ponse to an unmf'asured +5°C step disturba nce in feed te rn perat ure T r.

68

7 R esults and Discussions

the

~caling factor~

chosen (for a ll three

quantitie~)

correspond to the original steady state (equilib-

rium ) values of the plant . The main advantage, from a tuning perspective , of the scaled deviation transfonnat ions is that, if t he scaling factors are chosen appropriately, t he resulting scaled quantities are all of the same order of magnitude. Therefore. one need not be concerned (as much) with scaling the contro lled outputs and cont rol inputs in t he regulator and target calculator objective funct ions via the penalty matrices. The regulator tuning matrices used in a ll NMPC / LMPC simu lat ions in this study are shown below.

Q =

[

2 0

0 6

Since we are interested in ' better' control of the polyrner weight-averaged molecular weight relative to the reactor temperature, we penalize molecular weight deviations fr om its setpoint (six) more than reacLor temperature deviations from its setpoint (two). The conLrol input penalty matrix R and the control rate p enalty matrix S above were a.'isigiiPrl relrtt iV(' l,V low< !r \VPig ht.s, rcAecti11g t h<!ir lower importance relative to t he controlled output . The target calcu lator parameters employed in this st.udy are shown be low. U =2x l0l [ l

l

0 R = [ 005 0.5

l

l jT

He re, the notation 12 denotes a two-by-two identity matrix. The matrices Q and U are suppli ed with suffieient.l.v high values in order to ensure that the variable
7)

(which is , informall y, t he discrepancy

between t he cont rollerl o utput target and its setpoint ) in the target calculation is as small as possible, subject to tlie process dyuarnics a nd coustra.ints. For square plants , as is t he <.:ase here, t he choice of matrix R is not <.:ritical, therefore, here it is assigned the identity matrix. The remaining N:'v1PC/CVIPC tuning parameters which must he specified arc the prediction and cont rol
h orit~ons .

Iu genend, long prediction horiwns are desirable , as t his allows the controller to

'see ' future plant behavior and take appropriate co11trol actions. F\trt herrnore, long prediction horizons might be required in order to stabi lize plants operat ing at nnsLable operating point.s. However, increasing the length of the predictiou horizon ill t urn i11creases l ite orJ!i11 e COlll])Utat ional power required to solve the resulting larger NLPs, which is obv iously undesirable . Therefore , t here is s ingnifica nt incentive to keep t he predictio n ho rizo n a.~ snta.ll as pussible. while a.L the same Lime

7.1 Single-Zone Autoclave

69

272 .---------.----------,----------.---------.----------,

u
0

-- M = l - - M =2 M =6

h

10

15

20

25

~

"I 8

--X

:; p, 1:) E
li.l
5.0[1

Time, t [min .)

I~

·

~ -3
~

5

- - M=l --M=2 M = 6
llJ

15

20

25

Time, t [min.)

Figure 7.4: Effect of control horizon on control performance. Closed-loop response to an unmeasured +5° C step disturbance in feed temperature TJ.

cnsming adcqunt.<· closed- loop performance and st11bi lity. fignn' 7.3 shows the cflcct of in creasing the prediction horiwn on the closed-loop response of the contro lled o11tputs. The control horiwn in each case is
~et.

eqmt! to the prPdi ct ion

hori ~o n

t.o ens11re consist.Pn cy. It is clear from I he ngure Lhal.

while increasing th e prediction horizon from one to two yields some irnprovernent in the closed-loop coni rol performance. any fmt her increase in l lw predict ion horiwn does not yield any discernible improvem ent. in control perforniaii C:e. In this
stud~· ,

a prediction

hori;~;on

P = 6 was selected for use

in all the closed- loop controller sim ul at ion cases presented here . Figure 7.4 shows the effect of varying t he control horizon on the closed-loop response of the controlled outputs. Tn t his case, for the sake of comparison , t:he prediction horizon is kept constant at six. The results obtained from these simulations a.re consistent with known results from Ll\:IP C. speC'ifically, that reducing the control horizon relative to the prediction
hori~on

results in

1'\.

correspondiug decrease in ·controller aggressiveness' . Here, t he NMPC contro ller with a. unit control horizon exhibits a. relatively slow. grad ua l response with litt le, if any, overshoot. while longer control horiwns produces more aggressive control response wilh overshoot. However, much like the

70

7 Results and Discussions

prediction horizon

re~;ults

discussed previously, increasing the control horizon beyond a value of two

prorluces no significant change in closed-loop response, i.e. there is negligible increase in contro ller aggressiveness. In this work , we selected simulations performed.
1:1

control

hori;~,oH

Af = 2 for use in all closed-loop controller

7.1.3

Simulation Results

l11dustrial chemical processes are regularly affected by uouzero-meau uumeasured load disturbances duriHg the course of operation. These disturbances generally origi nate at the process and/or contro l inputs, and have the ultimate, negative effect of driving Lhe sysLern away from t he required operating poinL, which is obviously undesirable. Disturbances Lo polymerization reactors can adversely afl'cct the properties, quality of the produced polymer , potentially leading to unmarketable product aHd / or economic losses. Therefore, a critical requirement of any industrial process control system is its ability to effectively cotnpcnsutc fur (or reject) !IO!IZC!'O- l!lca!l pro<'ess distmba11ccs. Figures 7.5 ami 7.6 present simulation results <'Oiuparing the closed-loop distmbaiiCI:' rejectioll responses of NIV!PC , Ll\'IPC , and PID controllers for the siugle-wue LDPE autoclave reactor. We show results of two kinds of process disturbances which can l'ea.<;Oil<:lbly be expected to affect. Lhe reactor during oul ine operation. First , we considered the ca::;e of au unmeasured step disturbauce in the feed temperature Tf (see Figure 7.5), and second, the case of an unmeasured step disturbance in the feed initiator conce ntration If (see Figure 7.6). In both cases, we assume that NMPC

co11troller model matches t he plant dy11amics perfectly, i.e. there is no plaHt-ruodelmisma.tch, except of course, for the unmeasured disturbance entering the plant. The simulation results show that both linear and nonlinear MPC CO!!Lrollers perform adequate ly well. and are able Lo quickl y retum the controlled outputs to their re::;pe<.:Live setpoints following the process disturbances. However, Lhe PID control system performs relatively poorly in both cases , providing a very slow , gradual return of the controlled outputs Lo their setpoi nts.
It is clear from Figures 7.5 and 7.6 that the ' mixed disturbance ' based ofl'set-free LMPC for-

mulation (i.e. one input disturbance on the temperature equation, and one output disturbance on the molecular weight measurement. equat ion) described previously performs reasonably well in the

7.1 S ingle-Zone Autoclave

71

272 ,---------.---------.---------.---------,---------,
- - NMPC --LMPC PID

·· ...

·· ········ ······ ........
10 Time,

''"'·

5

15

20

25

t lmin .J

0

~

"I

--::::
X

a

5. 1!')
~.1

I~

"

5.0G

...

,

..

·''

.....

····· ··· · ,, ,,, ,,

' ,,,''

~
::?:
0

5

P = 6, M = 2

- - NMPC - - LMPC · · · · PID
15

5

10

20

25

Time , t [min.]

Figure 7.5 : Closed-loop response to an unmeasured +5°C step dist urbance in feed te mperature T1 . Comparison of NJVIPC , LMPC , and PID controller responses .

·······' ······· ..

'

.... ······ ,,
- - NMPC --LMPC · · PID

2f1!)

0

5

10

15

20

25

Tim e, t [min .]
~

"I

--s
X

0 E

54
P = 6, M = 2
5.2
5. 1

- - NMPC --LMPC PID

I~

3

·· ...

.. ,,

,,

...

~
c5 .,.

'········
15

5

"'

0

5

10

20

25

Time, t [min. ]

Fi gure 7.6 : Closed-loop response to an unmeasured - 10r7r, step disturba nce in feed ini t iator concentrat. ion I f. Cornparisou of NlVfPC , LMPC , and PTD controller respon ses .

72

7 Results and Discussions

presence of unmeasured process disturbances. However , our simulations reveal interesting results if an input disturbance model is used instead, as is the recommendation of many researchers for LlVIPC. The results of this investigation are presented in Figure 7.7, here,
w~

compare

th~

closed-

loop controlled output responses of input disturbance based ofl'set-free :'\MP C, Ll\IPC formulations following injection of a step disturbance in the feed initiator concentration. ln this situation. the output disturbance state on the kf w rneasurernent equation is
elin1inat~d ,

and instead, the dyrmmic

equation corresponding to the second 'dead polymer' moment tt 2 is augmented with an input disturbance state. The disturbance model matrices corresponding to t his particular ar rangement of integrating disturbance states are given below .

,r r [ .X"=[d=

0
0

0
0

0

1

0 0

0

0
1

0

0

0

l

xu=

cd

=

[

0 0

0
0

l
based Nl'v'IPC

Tile simu lat ion results show that the closed-loop response of the input

disturbanc~

controller does not differ appreciably frorn the rnixecl disturbance based controller (see Figure 7.6) . However, the closed-loop response of the input disturbance based LMPC cont roller response does appears to be sensitive to the disturbance model ernployed. Although t il is cannot be observed within the time frame of the presented results. the input disturbance based L '! PC controller does eventually return the controlled outputs to their respective setpoints , however, in doing so it takes extremely large excu rsions away from t he desired operating poiut. which is obv iously intolerable. Note that t here exist other (not shown) anangements of input disturbance states where such erratic behavior is not observed. However, it is clear , for this particular reactor. that the Ni'v1PC controller is more robust (compared to the LNIPC controller) with respect to the structure of the disturbauce model employed. The performance of model-based control systerns for any given application is impacted directly by the quality of the avai lable process model. This is especially true for NlVIP C/ LMPC control systems- where process models are used explicitly in the calculation of futme control moves. ln general, plant-model mismatch has the ultimate efl'ecl of degrading overall controller performance, and can even lead to control system instability depending on the extent of mismatch. Therefore , it is imperative for any pra.clical control system be robust wit.h respect to (at. least ) moderate

7.1 Single-Zone Autoclave

73

300 r - - - - - - - - - , - - - - - , - - - - - - , - - - - - - - . - - - - - - ,

~
h

2RO

- - :"<MPC-!0 - - LMPC-!0 PID

~

~ 26o V
2:10

···

' "

'

;_.:..-..

0

5

10
Time, t !min .]

15

20

25

~

a .........

0

5.5

"I

s
X
';

"
<1.5

'·· ······· · ,,,
P = 6, M = 2

I~

~
0 ,.-. "'"

4
:l.fi

- - :"<MPC-!0 --LMPC-!0 PID

0

5

10

15

20

25

Time, t lmin .]

Figure 7.7: Closed-loop response to an unmeasured - 10% st ep disturbance in feed initiator concentration I J. Bot h Nl'v!PC , LIV1PC controllers use input disturbance models.
272.---------,----------,----------.---------,----------, - - :"io mism atch - - +5% A 's, En 's 270 ,., , ,,, - 5% A 's, En 's

u
0

26X
2fi(i

fi

10

l !'i

20

2fi

Time, t lrnin .]
~

0 5. 15 E .........

"I

s
X

5. 1
5 05 P

I~

·

= 6,

M

=2

- - :"io mismatch

~
0
~

- - +5% A 's , Ea's - 5% A 's, Ea's

5

10

15

20

25

Time, t lmin. ]

Fi gm e 7.8: Cl osed-loop respm1se to an nnm eas nred +5° C step di sturbance in feed temperatme Tf. Comparison of
N ~·1PC

contro ller responses \\·ith and wit hout pl ant-model mismatch .

74

7 Results and Discussions

levels of plant-model mismatch. l'v1echanistic models of polymerization reactors, such as the one presented in Chapter 3, arc nsnnlly simplified representations of highly complicaterl physicochemical reaction phenomena, and therefore, are particularly succeptil>le to modeling inaccuracies allll errors. The most common types of mismatch in polymerization reactor models can be broadly classified into parametric and structural mismatch. Paramet ric mismatch arises from errors in estimation of model parameters. for e.g. reactio11 rate parameters , whi le structural rnisrnatch stems frorn assumptions based on model structure, for e.g. well-mixed versus compartmental mixing model. Figures 7.8 and 7.!:J show the disturbance rejection response of the closed-loop NMPC contro l system in the presence of parametric mismatch . Two cases of parametric mismatch were considered here, in the first case, the magnitudes of all preexponential factors (i.e . all the model A's) and activation energies (i. e. all the model Ea 's) in the internal NMPC controller model were modified such that they were G% higher than their ·plant ' counterparts, while in the second case, these pararn eter sets were modified such that they were 5% lesser. 'T'he res ults of our simu lations indicate that the 'mixed disturbance ' based offset-free NMPC formulation is adequately able to return the

275

u
0

:au
2G5
-~o

h

g.
~

mismatch
A '~, Ea ' ~

2GO
2!)[)

- - +5%
0

-5% A ':s, Eo'::;

5

10

15

20

25

Time, t [min.]

.,
0

...__

9 :::
.....
X

5.-.t

~ 5.~

- - No mi~rnatch

P
5.2

= 6,

M

=2

- - +5% A's, Ea's · · · · · · · - 5% A ' ~, Ea's

I~

"

g
::E

5.1
!j

c

0

10

15

20

2G

Time, t [rnin. ]

Figure 1.9: Closed-loop response Loan unmeasmed - 10% step clist urbance in feed initiator concentration I f . Cornpa.risorr of NMPC controller responses with and without plant-nrodel 111ismatch.

7.1 Single-Zone Autoclave

75

~()0

u
0

- - NMPC --PTD

250

h

A
200

~

ci. E

~
0
15

~A

f
45

k

150

t1

:~o

60

7!i

Time, t [min. ]

0
·o

~

-...

E

l.f>
1.2S
I I

s
I~
X 3

I

~v
P

- - NMPC --PTD

~
0
~

0.7S
0.5
()

liv
15

~

: \
= 6,
4::i

M

=2
60

30

75

Time, t [min.]

Figmf! 7.10: Closed-loop

tra<~king

response to multiple polyu1er grade (set point.) cha.nge requests.

Comparison of NMPC and PID control ler responses.
:lOll

--

~o

mismatch

u
0

250

- - +5% A 's, En 's · · · · · · · ~5% A 's, En 's

h

E ~

c..
200

v
0 15

lv.30

;.._

f
45 6U 75

150

Time, t [min.]
~
I "'

s -...

0

1. 5 1.25

s
X

I~

3

r
r
.;,:-- - - - - . . . . . . J

:iY-- - - - - - - - " - - +5% A 's, En's -5% A 's, En 's

: \' ···
--

~o

mismatch

~
0
~

ll.7S
0.5

P = 6, M = 2

()

IS

4G

60

75

Tiruc , t [min .]

Figmt> 7.11: Closrd-loop !.racking rt>sponsf) to rnnlt iple pol.vmer gradr (setpoint ) r.h:wge re(jnests. Comparison of NlV!PC controller
n~sponses

with and without plant- model rnisrna.tch.

76

7 Results and Discussions

000

u
0

250

- - NMPC - - LMPC-ID · · · · · · · LMPC-I0/.0~

h

~

ci. 6

.. ,,
21)0

!: i ll
0

5

10

15

20

25

Tiuw , t {tuin .]

.
I

~ -::::_
0

12
10 8

~

X

,

l:i ~
::E
0

6
-1

r· .
.

........ ...
P = 6, M = 2
10

- - :-IMPC - - LMPC-ID · · LMPC-ID / OD

0

5

15

20

25

Time, t [min .]

Figure 7.12: Closed- loop tracking response to a single polymer grade (setpoint) change requesL. Comparison of NMPC response with Ll\·1 PC using input. input/ output disturba.uce Tllodels.

controlled outputs to their set points in spite of t he mismatch in the model parameters. However. it is clear that this particular type of parameteric mismatch causes a noticable degradation in the closedloop controller performance, especially iu the +5 % case , where the mismatch appears to significantly increase overshoots in the temperature response, and introduce oscillations in the molecular weight response . Contiuuous poly rueriza.tion reactors are usually required to produce multiple polymer gr<:tdes , and are consequently required to operate over a wide range of operating conditions. It is important that the transition between the multiple operating points (or polymer grades) be efficient in order to minimi ze production of ofl'-spec product.. NY1PC is id eal for polymer grade change sit.uat iou s as it incorporates a nonlinear process model, which (at least in theory' ) describes the reactor behavior over a wide operating region. Figure 7.10 compares the closed-loop tracking behavior of t.he Ni'v1PC and PlD controllers in response to multiple polyrner grade change requests for the single-zone LDPE autoclave reactor. Note that all three operating points shown are stable equilibriums on the hightemperature stable branch. The simulat.ion results show tha.L the NMPC controller is able drive

7.1 Single-Zone Autoclave

77

the system to the desired operHting points extremely quickly with marginal overshoot. The slight overshoot observed in t he reactor temperature response is li ke ly due to its lower weight (with respect to the polymer molecu lar weight) in the NNIPC objective function. The PID controller, on the other hand, takes longer to drive the system to the desired operating point, and does so with significant oscillat ions in the closed- loop response. It should be mentioned that t he same set of PID tu ning parameters were used for both the disturbance rejection and the tracking simulation tests.

Figure 7.1 1 <:ornpan;s the (mntrolled output) closed-loop tracking responses of t.he offset- free

NlVIPC formulation with and without parametric mismatch . The parametric mismatch used previously in the disturbance rejection simulations was a lso used in t he tracki ng simulation tests presented here. \"ote that we experienred numerical difficulties (ill-conditioning) in t he target calcu lator NLP, leading to terminal failure of the controller a lgorithm in the target calculation step . In order to solve this problem, it was necessary to modify t he values of the matrices Q ami U in the target calc:u lator objective fuuclion . The lTlfl.tri<~es Q =
[ 2 R.!ld

II = [ 2

2

rr were used in the ' mismatch,

NiVIPC tracking simul ations as they we re found to not cause the numerical difficulties encountered
when using the oefault values. Nat.mally, t his is an ad hor: solution to the problem. ano a carefu l amt!ysis of til e somce of the rmrneric:a.l instl'lbility is required if this <tlgorithrn is to be implemented online . Nevertheless. the simulation results show that the closed-loop tracki ng performance of the

Nl\'IP C ront.roller is not. oegrarlerl ·too much' b.v the parametric mismatch, and in fact., appears to
be enha11ced sl ight.l y ill tile +.5% case.

Th e closed-loop tracking simul ation results of til e LMPC controller were intentiona ll y om itted from Figure 7.10. as the response exhibited a highly erratic and oscillatory character. Figure 7.12 compares the performance of lhe Ni\lPC controller with that. of the input disturbance. and mixerl (inpu t-output.) disturbance based LMPC contro ll ers in reponse to t.he first graoe change request. The results show t hat the input disturbance based LMPC controller is successfull y able to drive
tilt> reactor to the next operating poi nt , albeit with significantly more overshoot in t.he moler ul ar

wPig iit. respo11se t h<HI the N\IPC contro ller. Howewr. t l1 e mixed disturbance based Ll\1PC controll er, wh ich was shown to perform extremely well for disturbance rejection. is unable to track even t he first setpoint change . In fac:t , if plotted completely, the c losed-loop response exhibits sustained.

78

7 R esults and Discuss ions

erratic

oscillation~

about the

~etpoint.

Note that both LMPC

contro ll er~

were provided linear models

which were obtained by linearizing the nonlinear p lant model about t he original steady state. Better performance can , perhaps, be attained if nonliaear :;trategies, such as gain or model schedul ing, are used together with LMPC for tracking control.

7.2
7.2.1

Multi-Zone Multi-Feed Autoclave
Disturbance Model D esign

In Section 7.1.1, we argued for the use of a mixed disturbance model, i.e. a disturbance model with a combination of input and output disturbances. for the single-zone LDPE autoclave reactor. Following the same line of reasoning, we attest again , that a mixed disturbance model approach is best suited to the multi-zone multi-feed autoclave reactor. In this case, since there are four avai lable on line measurements (three temperatures, and one molecu lar weight), we can add up to a maximm n of four integrat ing d isturbance states in the controller model. Here , three input
disturbance~

were

added (one each) on the dynamic equations corresponding to the reactor temperatures in each zone , a.ad a single output disturbru1ce waB added
011

tile polylller molecular weight measureruent equettion.

Accordingly. the of[<;;et-free NMPC/ LMPC distmbauce model matrices employed here are shown below.

where the notation 0 " x "' denotes a :lero matrix with ·n rows aud m col umns, and 1, an matrix.

'll

x n identity

7.2.2

Controlle r Tuning Parameters

T he t uni ng parameters reqHired by the offset-free NMPC/LMPC for mulations for the contro l of the mult i-wue autoclave reactor were selected, in a large pa rt, analogously to the case of the siHgle-:--:o11e reactor. The controller pred iction (P = 6) and control (.!If = 2) horizons were chosen indentically. The regulator Luning matrices used in all NMPC / LMPC simulations in this study are shown below.

7.2 Multi-Zone Multi-Feed Autoclave

79

R = 0.516

The r.ontrolled output penalty matrix Q was, again, dwsen to be a diagonal matrix. with 2's corresponding to the reactor temperatures and () correspond ing to the polymer molecular weight. Likewise. the conlrol input penalty matrix R is a diagonal matrix with 0.5's along the main diagonal. \'lie wish 1o rlisf'onn'lge L he use of lil.rg;e control moves in I.he feerl monomer Oowmtes fJ M relative to the feed initiator Aown1tcs qr. therefore, the diagonal elements in S corresponding to the feed monomer Aowrates are supplied higher values (five) relative to the feerl initiator Aowra.tes (one). Un like the single-zone LDPE autoclave reactor. the multi-zone autoclave reactor is nonsquare , possessing more control inputs (six) than contro lled outputs (fom). In th is situation. lhere exist multiple stead,v state (equilibrium ) targets , or equivaleutly, Tllnltiple combinations of coutrol inputs , which sat isfy the contro lled output setpoint :: .· at stead)' state. Therefore, it is important that the contro ll er gttide t il e systen t to a steady state that is 'profitable', i.e. one that makes the most pra.ct. ical sense from an opemt iou a l perspective. For the mull i-zo ue reactor, a profitable steady state is
on~

at

which the target fred rnonornrr Aowrat.rs qM are not shifted 'too much· from their design values (in onr simnlat ions , t.he original steady stale values), ilS this has broader production rate impli cations. In stead , we require that the /.a.1:qet feed initiator Aown1.Les q 1 be Tllanipula.ted pn-:fert:nl'ially in order Lo return the controlled outputs to their setpoints. The quadratic penalty matrix 1?. in the target calcH lat.ion NLP (see eq11ation (4. 16)) is an extremely convenient tool which can be used t.o achieve t his obj ect ive. The matrix R essent ially penalizes deviations of the current control input target from the previous target
Ut.J - l ,

Ut.J

therefore, the elements of R can be selected such t hat ' large' moves

in the target feed monomer Aowrates are avoid ed, or eq nivalent l,v, 'large' moves in the target feed iniLiat.or Oowra.t.es are fa.vored . The La.rget f'aknlal.or matrices used in Lhis work are given below.

II

=2x

10 3 [ 1

Notice that the diagonal elerneuts of 1?. corresponding t n I he I arget feed monomer flowrnt.es arP snpplied relaLively large va lues for reasons previously discusser!. The other target. calcu lator parameters

80

7 R esults a nd Discu ss ion s

Q and U are also supplied sufficiently high values, similar to what was done in the case of the single
wnc LDPE autoclave reactor.

7.2. 3

Simulat ion R esults

The multi-zoue multi-feed autoclave reactor is a nonsquare (fat) plant, hav ing more control inputs (six) than controlled outputs (four). The state space based formulation of the Nl'v1PC/Ll'v1PC controllers is ideally suited to handling multivariable and nonsquare plants, however, single loop controllers such as PID require special
considen-~.tion.

as 'optirnal ' loop pairings between inputs and

outp11ts must f-irst lw identif-ied. Several techniqnes based on singular value decomposition (SVD) and relative gain array (RCA) analysis among others have been developed to assist in the selection of loop pairings [9 , 80] . Chaug and Yu [9] shows how RCA analysis can be extended to nonsquare systems using the so called nonsquare relative gain (NRG) array methodology. These techniques can be used to reduce nonsquare fat systems into square subsystems, which can be handled read ily by multi- loop P ID controllers . Fortunate ly, for the multi-zone autoclave reactor , we can rely on engineering judgement instead of such rigourous analysis in order to select appropr iate loop pairings. For instance, it is well known that the initiator feed to each reaction zone is extremely efl'ecLive in regulating Lhe temperature in the zone. ln fact, il is cmrent industrial pract ice l.o employ the feed initiator
flowrate~ qf1 a~

control

in puts to regu late the temperature profi le in the reactor. Therefore, fo llowing the same approach, in this study. we paired the initiator flowrates to each react ion zone with the reactor tewperature in the zone. The sole remain ing controlled output (i.e . the weight-averaged molecular weight of polymer i\1 w) must then be paired with oue of tl1e three remaining control inputs (i.e . oue of the t.hree feed monomer flowrates qfM ).
Thi~

is a relatively straightforward problem as there are only three input-output

pairing combinations possible. ln this study, the best input-output pairing combination among the three remaining options was selected by a sirnple cornparisou of t.he opeu- loop steady state gains. The combination of the ('input) feed monomer flowrale Lo the fi.rst zone fJJM ,I a.nd the (o ·utput) polymer weight-averaged molecular weight M
w

was found to possess the highest open-loop gain

7.2 Multi-Zone Multi-Feed Autoclave

81

Kht.J

= D.l..f u·/ D.q.r,~~ . 1 ,

therefore, this was selected as the final pairing.

Figures 7.13 and 7.14 present closed-loop simulation results comparing the disturbance rejection (contro lled output) responses of Nl'v1P C , LMPC. and PID controllers for the control of the multi-t.<me multi-feed LDPE autoclave reactor . Figure 7.13 shows the closed- loop controlled output response following the introduction of an unmeasured -5°C step disturbance in the feed temperatures T.r 1 , 2 . 3 to all three react ion :wnes , while Figure 7.14 shows the controlled output response following an unmeasured 10% step disturbance in the feed initiator concentrations JJ1.2. 3 to all three zones. The closed-loop results obtained for the multi-zone autoclave are qualitatively quite similar to t he case of the single-:.o:one reactor. Both the NMPC , L!VfPC controllers appear to perform very well in retmning the control led outputs to their respective setpoints following the process disturbances. However , the closed-loop response of the PID control system is clearly slower than the responses of the other two controllers. Nevertheless , the PID contro l system appears to fare better in regulating the multi-wne autoclave relative to the single-zone reactor. T he effect of pa.rametric mismatch ou the closed-loop disturbance rejection performance of t he
N!\.'1 PC formulation is shown in
Figun~s

7.15 and 7. 16. Here , t ile two disturbance rejection simul ation

cases presented previously were repeated , however . in this case, the rate law parameters (i .e. all the model A ·s, E" 's) in the int ernal controller mode l are perLnrbed from their nominal (p lant) values by +5% and - ,s<YcJ, respectively. The res ul ts indicate that this mismatch does not significantly degrade the closed-loop performance. However , the closed-loop syst.ern appears to be affected more severely in the +5% case compared to the - 5% one. Figure 7.17 shows the closed-loop tracking responses of the Nl\1P C and PID controllers iu response to multiple polymer grade change requests for t he multi-zone LDPE autoclave reactor. The
Ll\IPC tracking resHlts were. as was the case with the single-zone reactor, omitted siucc the offset-free LMPC forrnulation is unabl e to guide the system to the desired operating points. The dosed-loop

tracking results show that the NMPC controller is able to drive the plant. to the desired operating points relatively quickly, and with marginal overshoot.. The closed- loop PID tracking response is surprisingly quite good, although t he overshoots in the respcmse cau be significant depending on the magnitude of the 'jump' between operating points.

82

7 Results and Discussions

228

u
0

226 224
222

~

······ ··· ·····
- - :"'MPC --LMPC ' ' ' ' P!D
5

~

ci. r::

10

15

20

25

Time, t [rnin. ]

u
0

·····
- - NMPC --LMPC ' ' P!D
()

h'
8

ci. 6 Q)

2~l2

230

5

10

15

20

25

Tim e, t [rnin. ] 248

u
0

h'

244

·····
- - NMPC --LMPC

s E-' "'<

ci.

242
10
JG

· .. PID 20

25

0

.,.
I 0

~

--.....
X
"·,,

s

Time , t [min. ]

P

=

G, M = 2

- - NMPC --LMPC

PID

l:i

.. , ... .

7.2

g
:2

c

7

0

5

1!1

15

20

Tirne, t [ruin .]

Figure 7.1:3: Closed-loop response to an unrueasured -5° C' "'tep disturbance in feed te1nperature Tf. Comparison of NMPC. LMPC , and PID control ler responses .

7 .2 l\1ulti-Zone Multi-Feed Autoclave

83

2-1 0

u
0

2;35

h
E ~
ci.

- - NMPC - LMP C ....... PID

230
225

···· ·····
()

220

5

10
Time, t [min .]

15

20

25

2Gil

~

h'
~

- - "'MP C --LMPC , , ,,,,, PID

~
230 0

····· ······· ·· ··
5 10
15

20

25

Tim e, 1 . [min .]

260
C)
0

h'
~

- - NMPC --LMPC ,,, ,, ,, PID

~
2-10 0

.. ... ,

·········· ··
10 15

5

20

25

0

Time, t [min .] 7.4

.--s
X
I

E

.!:Q

7.2
7
ti H
(i,()
(I

.. ··

········
- - NMPC --LMPC PID
] ;)

[::;:;

"

~
0
~

P = 6, M = 2
:)
] ()

20

2:1

Ti me, t [min .[

Figm t' 7.1 4: C losed-loop rel:ip onse to a n nnrn efl,~u rerl

+ lOo/.', st.ep

di stnrba nr.e in feed ini t iato r con-

cent rat ion I I. Compa rison of Nl'vfPC , Ll'viPC , a nd PID cont ro ller responses .

84

7 R esults and Discussions

221\

~
h
~

s

0.

- - No mismatch

220 0
5
10 Ti me, t [min.]

-

+5% A 's, Ea 's -5% A's, Ea's
20

lG

25

u
u

~

231
- - No mismatch

0.
0:: f-<

"'

232 230 0 5
10

- - +5% A 's, Ea 's - 5% A'l-) Ea 's
1

lG

20

25

Time , t [min.]
24t;

u
0

246
244

h'

" ~
0 5

0.
242

- - No mismatch

- - +5% A 's, Ea.'s -5% A 's, E.'s 5
10 15

20

25

Time, t [min.]
7.6

---.,.
I

~

~
X

7.-l

I~
~
::?:
0

7.2

'rh
0

- - No mismatch

P

= 6,

M

=2

-

-

,, , , , ,,

+5% A's, E.'s -5% A's, E. 's

7

5

10

15

20

25

Ti me, t [n1in.]

F igure 7. 15: Closed- loop response Loan unmeasured - [) ° C sLep disLurbance in fped tempe raLure Tf. Comparison of NMPC controller responses wit h and without plant-model rnisrna.tch.

7 .2 Multi-Zone Multi-Feed A u toclave

85

2-10

~
~

2;35

230
225

E ~

ci

~
lJ

- - No mismatch - +5% A's, En's ....... -5% A's, Ea's

no
2f>IJ

5

10

J[i

20

25

Time, I . [min. ] - - No mismatch - - + 5% A 's, E, 's , , ,,,,, -5% A's, En 's

~
~

2. J5
2~()

E C)

ci

235 230

""'

~
0 5 10 15 Time, t [min. ]

20

25

260
C)
0

2G[l

h'
E ~
ci

250
24fl

~
0

- - No mismatch - - +5 % A 's, E, 's , , , ,,,, -5% A 's, E, 's

· .~·

2-10

5

10

15

20

25

0 E -..._
~
~

Time, t [min. ]
7.-1 7.2 7

I

8
X

I~

i3

P
6.8

= 6, M = 2

~
0 ;?.

- - :"io mismatch - - +5% A's, E, 's - 5% A ,s , En's
l fl

6.(-i

n

;;

]()

20

25

Time, t [min. ]

Figmf' 7. 16 : Closerl -loup

r e ~pous e

to an UlJnl!'HSmf'd + I 0% step di sturbance iu feed initiator c:m 1 -

centrntion l r. Comparison of Nl\IPC t:ontroller respom:es with and without pl ant-model mismatch .

86

7 Results and Disc ussions

25()

u L..
~

225 200 17G

- - NMPC --PID

~

P.

-

1\

rv
15

150
0

''J
I

1\

1/\

{
45

30

GO

7fi

Time, t [min. ]

250

2
~
~

225

2110

y·

/\_

E

ci.

1/\

175 150
0

v

{
- - ;\IMPC --PID

15

30

45

60

75

Time , t [min.]
~50

P"
h' ~

225

If'
200
175

I
i

fl..
1\

s

ci.

v
(\

{
- - NMPC --PID

150

0

15

30

45

60

75

Time , t [ruin.]
1.4

(

~
X

1.2

lv I
1)

: \
P

0.8

~
0
1-5

= 6, M = 2
15

- - NMPC --PID

06

30

60

75

Time , t [ruin .]

Figure 7.17: Closed-loop t rack ing response to multiple polyme r grade (setpoint) chauge requests .

Comparison of Nlv1PC and P ID controller responses.

Chapter 8

Conclusions and Recommendations
EKF ami U KF based N!VIPC formu lat ions were developPd and applied for the contro l of sing le and multi-zone LDPE autoclave reactors. The closed-loop performance properties of t he proposed formu lations for disturbance rejection and setpoint tracking were investigated through a number of
s iuml r.~lion <:cll;e

stndics. The dlc:ct of (parametric) plant -model mismatch

011

closed- loop Nl'"1PC

performance was also studied. Convent ional LMPC and PID controllers were also designed for t he contro l of both LDPE autoclave reactors in order to compare t he performance of NMPC wit h more ' industrially accepted ' < :on trollers. Our results showed that, for both lv1PC control lers , a mixerl distmlxmce model (inpu t distnrhl'lnce stat.e(s) on t he reactor tem perature dynamical equat.ion(s) , and a singl e output
di ~t urbanc e

state on t.he weight-averaged molecular weight measurement equation) was adequat.ely capable of accounting for the effects of unmea..'lured load dist urbances and ' moderate' pl a nt-m odel mismatch on the plant dynarnics. Furthermore, using the single-:.mne reactor model. we showed that the closedloop response of the offset-free UvfPC fo nn ulation is very se nsit ive to t he dist.ribution of d isturbance statt' S lwtween inpms anrl outputs , while the N!VIP C cont roller is more 'robust' in Lhis regard. The simulation results indicate that only marginal performance improvement can be gained from irnplernenting NlVIP C instead of LMPC for disturbance reject ion arou nd any given operating point. In other words, the Llv1PC contro ller was shown to perform quite well if the system is operated in a 'small' region around t he operating point at whi ch Lhe plant model was
lin ear i ;~ed.

Fmthermore,

88

8 Conclusions and Recommendations

both l\1PC controllers provided significautly superior perforrnauce relative to conventional multi-loop PID controllers- which was found to reject process disturbances relatively slowly. We showed LliaL Llie ofTseL-free LMPC forrnulaLion is unfiL lor ::;etpoinL t.ra.cking purposes for both LDPE autoclave reactor types, except in certain special situations. The inability of the LMPC controller to adequately track setpoint changes can be attributed directly to the high degree of process nonlinearity. On the other hand, both NMPC and PID controllers were demonstrated to be capable of driving the plant to the desired operating points. However , the PID controller caused significant overshoots and oscillations in the closed-loop tmdcing response , especially in situations where the 'jurup' between operating points was large .

8.1

Recommendations

The offset-free N:\IPC formulation was demonstrated to perform quite well over a wide operating region a.nd under a. variety of operating conditions. However , the computational expenditure required to solve the controller NLPs can be substantial , especially for systems with high dimensionality. such
aB the multi-zone multi-feed LDPE autoclave reactor. On tlw other hand. while the oA.s et-free LMPC

formulation performs reasouably well iu the regior1 close to tile operaLiug (liuearir,atiou) poiut, its perfonna.ucc was found to deteriorate siguificautly lineari:.-:alion . In the
C&';e

a;;

the systcrn rnovcd away from the point of

of Lhe LMPC controller, however, relatively marginal computational effort

is needed to solve the controller QPs. Using gain , model schedu ling techniques, the aforementioned advantages of NMPC. LMPC can be incorporated into a scheduled LMPC controller that is both computationally inexpensive, and also accounts for nonlinearity in the process dynamics. It is recommended that more research be performed to detennine if acceptable perforrnauce can be obtained using such techniques, especially in sctpoint tracking sit.uations.

Nomenclature
A;
~l;
ith

moment of the CLD of growing polymer raciicals, see eq. (3.22) moment of the CLD of dead polymer chains , see eq. (3.22)

ith

p

density of reaction mixture, g/L heal of polymeriz;aLion (ethylene), kJ / mol activat ion volum e, see eq. (3.2 1), cm 3 / mol backmixing ratio for the
ith

!::,HTJ

l::, u

R,
M,
111 11 ,

reaction zone , see eq. (3 .37)

number-averaged molecular weight., g/mol weight-averaged mo!Pcula.r weight , g/rnol prccxponcntial fact.or , sec cq. (3.21) heal capacity of reaclion rnixt me , .J /g- K activation energy, see eq. (3 .2 1), ca.l/ mol
initi ntor C'fficiC'ncy

A
Cp

Eo.

f
I lr
J(

initiator concent.raLion , mol / L initiator feed concentration. rnol / L reaction rate constant, see eq. (3.21) rate constant of reaction (:3.1 b) , L/ mol- s

f( 1

90

8 Conclusions and Recommendations

Kb
I<d

rate constant of back-biting reaction. see eq. (3.8). s

1

rate constant of ini t iator decomposition reaction. sec cq. (3 .la) , s rate constant of propagation react ion , see eq. (3.3), Lj mol- s rate constaut of term ination reaction, see eq. (3 .<1 ), L/ ruol- s

1

KP
/( 1

J({l

rate constant of /:!- scission to secondary radical reactiou. see eq. (3. 7), s - 1 rate constant of chain transfer to monomer reaction, see eq. (3 .5 ), L/ rnol- s rate constant of chain transfer to p olymer reaction. see eq. (3.6). 1 / mol-s rate constant of t herma l self initiation. see eq. (3.2 ) . L 2 j mol 2 -s nJ OIJorner cou c:eutration , ruol / L molecular weight of a single monomer unit, g/rnol monomer feed concentration , mol / 1 tot.al monomer concentratiou , mol / L non-growing (d ead) polylller chain haviug ·n nJononJeric units , mol / L exit volwnl't.ric Howratc , L/ s feed volmnctric flowratc, 1 / s downward flowraLe from t he ith to the ('i ini t iator feed volumetric Aowrate, L/ s monomer feed volum etric floi-I·TaLe, L/ s upward fl owrate frmn the (i

/(f m

l\!P

Ku,.

/11
!vfu
/If1

,H 1 P11
q

C/f

Qd ,

+ l )th

reaction zone, L/s

q/J

Iff"

q.u,

+

1 r

11

to the

ith

reaction w ne, L/s

n
R1

universal gas constant , sec cq. (3.21) rate of radical initiation , see eq. (3 .26 ) . mol / L- s

8.1 R ecommendations

91

TJ

rate of init iator consump t ion , mol / L- s rate of monomer consumption , mol / L- s grmvi ng (live) polymer chain having n monomeri c units . mol / L rate of temperature change. K/ s primary (init ia to r) radical concentrat ion . rnol / L growing (live) radical generated in the back-biting react ion. see eq. (3.8) . mol / L ra.te of total monomer consumption , mol/ L- s reactor temperature, K reactor feed temperat ure, K reactor volume. L monomer conversion

TM

Rn

rr
R,,
R1m

TM,

T

Tr

V
.l'AJ

Bibliography
[1] S.-. Ahn , !'d .- . P FLrk , Ftnd H.- . R.hee . Extenc!ed K alm Ftn filLer-hRsed nonlinear model prerlictive control for a continuous MMA polymerization reactor . Industrial and Engineering Chemistry

R esearch, 38(10):3942- 3949, 1999.
[2] E. Ali , A. Abasaeed, and S. Al-Zahra.ni. Op t imization and control of industrial gas-phase

ethylene polymeri zation react ors. Industrial and Engineering Chernis tr·y R esearch, 37(8):341434.23. 1998.

[:3] E. Ali a nd E. ZRfiriou .

Optimization- b a..~ec! t un ing of nonlinear model pred ict ive control with

state estimation. Jov.rnal of Process Contml, 3(2):07- 107, 19!)3.

[4] A. I3cmpora.d , 1\.1. Morari , a nd N. Ricker. Model pred ictive contro l toolbox 2: User 's guide.
Techn ical report, The MathWorks , Inc .. Natick, 1\tA, USA. 2007.

[.5] S. BenArnor, F. Doyle III , and R. .tvlcFa.rlan e. P olymer grade trausition control using ad vanced
real-time optimization software. Journal of Process Control, 14 (4):349- 364, 2004. [6] R. I3erbrr a nd S. Coskun. Dynam ic simul ation a nd quadratic dynamic matrix cont rol

of an industrial low d en sity polyet hy lene reaetor .

Cornp1ller·s and Chern'ical Eng'ineer"ing,

20 (Suppl. ):S799- S804 , 1996.

[7] M. Cannon. Efficient nonlinear model predictive control algorithms. Annual R eviews in Contml,
28(2):229 237, 2004.
[A] W .- . C ha.n. P. G loor, and A. Ha rnielec. h'i net. ic morlel for olefin pol. vrnPriznt ion in high-pressure

autoclave reactors. AJChE ./rmmal, :39(1 ):111 - 126. Hl93.

94

BIBLIOGRAPH Y

[9] J.- . Chang and C.-. Yu. The relative gain for non-square multivariable systems. Eng-ineer-ing Science , 45(5):1309- 1323, 1990.

Chemical

[10] II. Chen and F. Allgower. A quasi-infinite horizon nonlinear model predicti~·e control scheme with guaranteed stab ility. A·utO'Inat·ica, 34(10): 1205- 1217, 1998. [11] !.-. Chien , T. Ka.n, and B.-. Chen. Dynamic simulation and operation of a high pressure Compute1·s and Chem-ical

ethylene-vinyl acetate (EVA) copolymerization autoclave reactor. Engineering, 31(:3):233 -245, 2007.

[12] J. Crassidis and J. Junkins. Optimal estimation of dynamic system.s. CRC Press , 2004 . [13] J. Cuthrell and L. Biegler. On the optimization of differential-algebraic process systems . AIC'hE Jounwl, 33(8):1257- 1270, 1987. [14] G. DeNicolao, L. I\Iagni, and R. Scattolini. Stability and robustness of nonlinear receding

horizon control. In Nonlinear model predict·iue cont-rol (Allgower. F. and Zheng, A. editors). I3irkhauser Verlag, 2000. [15] H. Dhib and N. A l-Nidawy. IVIodelling of free radical polymerisation of ethylene using difunctional iHitiators. Chenl-ical Enginee· ring Scietu·e , 57(14):2735 2746 , 2002. [16] R. Dhib , J. Gao. and A. Penlidis. Simulation of free radical bulk / solution homopo l ~· rnerization using mono- and bi-functional initiators. Polymer Reaction Engineering, 8(4):299- 464, 2000. [17] A. Dhooge. vV. Govaerts , and Y. Kuznetsov .
.tviATCONT:

A

MATLAB

package for nmnerical

bifurcation analysis of ODEs. A CM Tr-ansactions on Mathem.atical Softwan:, 29(2):141 - 164, 2003. [18] A. Dhoogc, W. Govaerts, Y. Kuznetsov, W. Mcstrom, and A. Riet. uaLion toolbox in
MATLAB. CL_MATCONT:

A contin-

pages 161- 166 , 2003.

[19] A. Faanes alld S. Skogestad. Offset-free tracking of model predictive control with 111odel mismatch: Experimental results. 3972. 200[>. IndvstTia.l and Engin eering Chemistry Resear-ch, 1-1 ( 11 ) :: 396()-

BIBLIOGRAPHY

95

[20] P. Feucht. !3. Tilger , and G. Luft . Predi ction of molar mass distribution. number and weight average degree of polym eri zation and branching of low density polyethy lene. Chemical Engi-

neering Scif:nce, 40 (10): 1935 1942 , 1985.
[21] R. Findeisen a nd F. Allgiiwer. An introduction to nonlin ear model predict ive control. Technical report, Institu te for Systems Theory in Engineering , University of Stuttga rt , 2002. [22] B . Finlayson . Th e method of weighted residuals and variational principles. Academi c Press, 1972 . [23] G. Franklin , .J. Powell , and l\1. Workma n. D·igital control of dynamic systems. Addison- Wesley, 3rd edition , 1998.

[24] Y. Gao and lVf. E r. NA R.MAX time series model prediction: Feedforward a nd recurrent fuzzy
neural network approaches. Fuzzy Sets and Syst ems, 150(2) ::33 1- 350. 2005. [25] J. Ham awl H. -. Rhee. l\1odeling a.u d contro l of an LOPE autoclave reactor. Jov:rnal of Pmcess

Control, 6( 1) :241- 216. 19D6 .
[26] J. Hamer, T. Akramov. a nd W . Ray. Th e d ynami c beh avior of continuous polymerization reactors - II. Nonisothermal solution homopolymeri zation and copolym eri zation in a GSTR.

Chemical Engineering Scien ce, 36(12):1897 1914, 1981.
[27] E. H8sf' lt.inc and .I. R.R.w!ings. Critic R.l 0v8lnation of 0xt0nd0d Krt.lman filtering a nd movinghori zon est imat ion. Industrial and Engineering Chemistr:LJ Research, 44.(8) :2451 - 2460 . 2005. [28] H. Hulb urt and S. Katz. Some problems in pa rticl e technology. A statistical mechanical formulation . Chemical Engineering Sci ence, 19 (8): S55- 574, 1964. [20] J. J 0rgc usc u. !VI. Kr ist ensen, P. Tholllscu , and H. l\1 a.d::;c u. A computat ionally cffic:icut a nd robust implemf'ntation of the cont inuous-discrete extended Kalman fi lter. Pmceedings of lhe

Amt-Tican Conlml Confer-ence, pages 3706 :371 2, 2007.
[30] S. Julier and J. Uh lm ann. A g<mera.l method for a pproxi mating nonlin ear transformations

of pro bability di stributions. Technical report , Th e Robotics Research Group , Depart ment of Engineering Science, Un iversity of Oxford. 1996 .

96

BIBLIOGRAPHY

[31] S. Julier and J . Uhlmann. A new extension of the Kahnan filter to no nlinear systems. Technical report. The Robotics Research Group , Department of Engineering Science. University of Oxford, 1997. [32] S . Jul ier and .J. U hlwam1. U11scc uted fi!Lcri ug aud uon linear estitua.t.ioll.

Proceedings of the

IEEE, 92(3):401 -L122 , 2004.
[33] S . .Julier. J. Uh lmann , and H. Durrant- Whyte. A new method fo r the nonlinear transformation of means and covarianccs ill filters and estimators. IEEE Transactions on Automatic Control, 45 (3) :-177- 482, 2000. [34] R.. Kalman. A new approach to linear filtering and prediction problems. Tmnsa ctions of the

ASME, Jottmal of Basic Engineer"ing, 82 D:35- 45 , 1960.
[:35] R. Ka lm an and R. Bucy. New res ul ts in lin ear fillering and prediction t heory. Tmnsacl;ions of

the ASME, Jou·r nal of Basic Engineering, 83 D :95- 108 , 1961.
[36] D. Kalyon, Y.-. Chiou , S. Kovenklioglu . and A . BouaJ!'ar. H ig h pressure polymerizat ion of ethy lene a nd rheo logical behavior of polyethylene product. PolymeT Engineer'ing and Sci ence, 34(10):804 -814. 1994 . [37] P. Klwzraei and R. Dbib . lv!odel iug or ethy lene poly merizat ion wit h difu!l(:t iona l initiators in tubu lar reactors. Jom·nal of Applied Polymer· Science, 109(6):3908- 3922, 2008. [31:\] S. Kol iis, R. Foss , a.11d T. Scli e i. Co 11:;trai 11 ed 1101 dill eo r :;tate est i111 at ion based on the UKF approach . Compute1·s and Chemical EngineeTing, 33 (8): 1386- 1-101 , 2009. [39] A. Kum ar and I\.. Gupta. Fundamentals of polyrners. l\·1cG raw- Hill , 1998. [40] H. -. Lee , Y.-. Yeo , a nd J. Chan g. Modeling of industria l high pressure a utoclave polyethylene reactor including decomposition phenomena. K orean Jom--n al of Chemical Engineer·ing. 17(2) :22:3--229, 2000. [41] J. Lee, .J. Ham , K . Chang, .J . Ki rn, and H.-. Rhee. Analysis of a r1 LOPE compact autoc:lave reac tor b_v two-c-ell mode l with backflow. Pol-yrne·r Eng· inee-ring and S cience, 39(7): 1279- 1290 , 1999.

BIBLIOGRAPHY

97

[42] J. Lee and N. Ricker . 8xtended Kalm a n filter based nonlinear model predict ive control. Industrial and Engi n.cc1·ing Chemis try Research. 33(6): 1530-154 1, 1994. [43] J. !Vfa.ciejowski. ?7-e!i'irt'ivt: control with constra:in/:8. Prentice-Hall , 2001. [44] G. i\Iarafio1 i, S. Ola.rn , anrl !vi. Hovel. StaLe estim ation in nonlinea r modf'l pred ict ive control ,

unscented Kal!na 11 fllter advantages. In Nonlint:a'f' model pn'. d·ict·ive contml: To wa:rrls new chnllenging applications (Ma.gni , L. , Raimondo , D.NI. , and Allgower, F . editors). Springer Berlin / Heidelberg, 2009. [4.5] L. !Vla.rini and C. Georgrtlds. Low-density polyet hy lene vessel reactors. P art I: Steady strtte and dynamic modelling . i\IChE Journal, 30(3) :401- 408, 1984.

[46] L. l\'l a rini au d C. Georga.ki:; . Low-densi ty polyet hy le ne vesse l reactors. Pa rt II: A novel controller.
A l ChE J ournal, 30(3H09- tJ 15, 198tJ. [4 7] P . M ay beck. Sl ot:hnsl'ir models. es /.ima./'ion. nnd r:onl.ml. volume 1. Academic Press, 1979. [tJ8] D. I\·fay ne and H. l\1ichnlska. Receding horizon cont rol of nonlinear systems. IEEE Transactions on Automatic Contro l, 35(7):814-824, 1990. [4 9] D. Mayne . J. Rawlings, C . Rao, and P. Scokaert. Constrai11ed model predi ctive control: Stab ili ty and optimality. Autom.atica, 36(6) :789- 814, 2000 .

[f>O] E. 1 \il ea.dows and .!. Rawlings . Model predict ive control. In Nonlinear process conlrol (Henson,
\-I. A. and Seborg. D.E. editors) . Prenti ce- Hall. 1997.

[fi 1] H. IV !ichalska and D. !-.la.y nf' . Robust receding hori zon control of constrained nonlinear s.vsLems.
lEEE Tmnsactions on Aut.orrwlic Conlml. :38 ( 11 ): 1623 163 :3. 1993. [52] K. Muske a nd T . Badgwe\1. Dist urba nce modeling for offset-free linear model predictive control. J ournal of Pmce.ss Conlml, 12 (5):6 17- 632 , 2002. [53] K. Muske and T. Edgar. Nonlinear state estima t io n . Tn Nonlinear pmcess control (Henson , M.A. and Seborg, D.E. editors). Prentice- Ha ll , 1997.

98

BIBLIOGRAPHY

[54] K. Muske and J. Rawlingl:>. 39(2):262-287, 1993.

Model predictive contro l with linear models . AIChE Jounwl,

[55] C. Pannocchia. Robust disturbance modeling for model predictive control with application to rnu ltivariable ill-conditioned processes. JouTnal of P.roc:ess Conl'rvl, 13(8):693 701, 2003. [56] G. Pannoc:chia and A. Bernporad. Combined desigu of disturbance model and observer for offset-free model predict ive control. 1053 , 2007. [57] C. Pannocchia and .J. Rawlings . Disturbancf' models for offset-free model predictive contro l. A!ChE Jow-nal, -19(2):426 437 , 2003. IEEE Tmnsactions on Automatic Control, 52(6):1048-

[5x] R. PcR.rson R.nd B. OgnnnAikc. Nonlinnar process iclcntifica.lion. In Nonlinear process cont·rol
(Henson, ~·1.A. and Seborg, D .E. editors). Prentice-Hall, 1997. [59] P. Pladis and C. Kiparissides. Dynamic modeling of multiwne , multifeed h igh-pressure LOPE autoclaves. JouTnal of Applied PolymeT Science, 73(12):2327- 2348 , 1999.

[GO] .J. Prakash, A. Deshpande , and S. Patwardhan. Stale estimation and fault. tolerant nonlinear
predictive cont rol of an autonotliOUl:> hybrid l:>,Yl:>lett l using unscented Kalt 1 1a11 filter . In Nonlinear model p1·edictivc control: Towa1·ds new challenging applications (Magni , L .. Raimondo , D.M .. and Allgower, F. ed itors). Springer l3erlin / Heidelberg , 2009. [61 ] V. Prasad , M. Sclde.v. L. Russo , and B. Bequette. Product property and production rate control of
~tyrene

polymerization. Jounwl of Pmcess Control. 12(3):353- 312 , 2002.

[62 ] S. Qin and T. Badgwell. An overview of industrial model predictive control technology. In Fifth ·i ntcmational confe7·en ce on chemical pmcess contml (Kantor. J .C., Garcia. C.E. and Carnahan. B. editors) , pages 232- 256 , 1997. [63] S. Qin and T. Badgwell. An overview of uonlinear model predictive control application:;. Iu Nonlinear model predictive control (Allgower, F. and Zheng. A. editors). Birkhiiuser Verlag, 2000 .

BIB LIOGRAP HY

99

[61] C. R.ao a nd J. Rawlings. Steady states a nd constraints in model predi ctive control. A!ChE

Journal, 45 (6): 1266- 1278, 1999.
[65] J. Ra wlings a nd B . Ba.ksh i. Particle fi ltering and moving horizon estimation. Compv.ters and
Chemical EngineeTing, :30 ( 10 12): 1.529- 1541 , 2006.

[66] N. Read , S. Zhang , and W. Ray. Simulations of a. LDPE reactor using computational fiuid d ynamics. A!ChE Journal. 43 (1):104-117. 1997. [67] A . Romanenko and .J. Ca..'ltro. The unscen ted fi lter as an alternative to the EI<F for nonlinear state estim ation: A simulation case study. Compu.i.er8 a.n.d Chemical Eng·ir1 .eeTing, 28 (3):347 355, 2()()c 1.

[G8] A. Roma ucuko , L. Sa ntos, a nd P. Afonso. l.Ttts<Tutcd Kalma n fil tering of a simu la ted pH system.
Tn.dnstr·ial o.nd Engi71f'Pr·in.r; Cht:mis tr·y R t:8eardt, -!:3 (2:3) :7.53 1 7538. 2004.

[69] A . R. udin . Th e elements of polymer· science and engineering. Academic Pre::;s, 2nd edition , 1999 . [70] L . R.u::;so and B. Beq uette. Operability a nalysis and nonlinear model predictive control of a styrene pol.vmeri:tation reactor. Pmceed·ings of ihe IEEE Conference on Decision and Conlml, 1 :<-143- 448 , 1998. [71 ] L. Russo and B. Bequette. Opera bility of chemical reactors : :1\lultiplicity b ehavior of a jacketed sty rene polymerization reactor. Chemical Engin ee1'ing Science, 53(1):27- 45 , 1998.

[72] I\1. Schley, V. Prasa d , L. Russo, and D. Bequett e. Nonlinea r model predicti ve control of a
sty rene polyrnerint ion reactor. In Nonlin em· ·m odel pn:dict·ivP- control (Allgi.iwer. F . and Zheng,

A. editors). Birkha.user Verla g, 2000.
[73] A. Schmidt and W. 11 ay. The d~· nam i c behavio r of continuou s poly meri zation reactors - I. Isot hermal so lution p o lyrne ri :talion in a CSTR. l-110 , Hl8 1. [7-1 ] A . Slwnoy a nd D. Sa ini . Ivlell flow indE'x: tv lorE' t.han .inst. a quality conLrol rheo logical parameter. P an 1. Advances in Polymer Trch.nology, 6(1):1 - 58. 1986.

Chemical Engineering Sr:iencr, 36(8):1401 -

100

BIBLIOGRAPHY

[75] A. Shenoy and D. Saini . Melt How index: l'dore than just a qual ity control rheological parameter. Part II. Advances in Polymer Technology , 6(2):125- 145, 1986. [76) P. Siugstad, H. Nordhus, K. Strand , l\L Lien, L. Lyngmo , and 0. !Vloen. Mult ivariable 110!1-linear control of industrial LDPE autoclave reactors . volume 1, pages 615-619, 1992. [77) S. Skogesta.d. Probably the best simple PID tuning rules in the world . Technical report ,

Department of Chemical Engineering , Norwegian University of Science and Technology, 2001. [78] S. Skogesta.d. Simple analytic rules for model reduction and PID controller tuning. Joumal of
P·rvce::;::; Contn;l, 13( . J ) :291 -309, 2003.

[79] S. Skogestad. Simple analytic rules for model reduction and PID controller tuning . Modeling,

l denlijicalion uud Cunlml, 25 (2):85 120, 2004.
[80] C. Smith and A. Corripio. P1·inciples and practice of automatic pmcess contml. John Wiley & Sons , Inc , 2nd edition, 1997. [81] G. Stephanopoulos. Chemical process control: An intmdttction to theory and pmctice. PrenticeHall, 1984. [82] H. Su and T. l\:lcAvoy. Artific ial neural networks for nonlinear procest; iclentific:atioll aucl control. In Nonlinea'l' process cont·rol (Henson , M.A. and Seborg , D.E. editors) . Prentice-Hall , 19g7. [8:3] M. Tenny, J. Rawlings , and S. Wrighl. Closed- loop behavior of nonlinear model predictive control. A I ChE Jow7wl, 50(9):2112- 2151. 200-'l. [84] .J. Valappil and C . Georgakis. No nlinear model predictive control of end-use properties in batch reactors. A ! Ch.E Journal , 48 (9) :2006 - 202 1, 2002. [85] C. Villa, .J. Dihora. and \1'...'. Ray. Effects of imperfect mixing on low-density polyethylene reactor dynamics. A!Ch.E JO'lwrw.l, 44 (7):1646- 1656 , 1998. [86] J. Villadsen and M. Michelsen. Soi'ulion of diffe1'CT1 lial eqnat1:on models by polynomial upproxim.alion. Prentice-Hall, 1978.

BIBLIOGRAPHY

101

[87] S. Zhang and W. Ray. Modeling of imperfect mixing and its effects ou polymer properties.
A I C'hE .Joumal, -13(.5):1265- 1276, 1997.

[88] S. Zhang , N. Read, and W. Ra:v. Runaway phenomena in low-density polyethylene autoclave

reactors. A ! Ch.E Jo1LTna.l, 42(10):2911 - 2925 , 1996.


