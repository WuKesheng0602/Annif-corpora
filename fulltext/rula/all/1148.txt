Ryerson University

Digital Commons @ Ryerson
Theses and dissertations

1-1-2011

Fault diagnosis with adaptive kalman filters and CMG design for picosatellite ACS
Noel Abreu
Ryerson University

Follow this and additional works at: http://digitalcommons.ryerson.ca/dissertations Part of the Aerospace Engineering Commons Recommended Citation
Abreu, Noel, "Fault diagnosis with adaptive kalman filters and CMG design for picosatellite ACS" (2011). Theses and dissertations. Paper 655.

This Thesis is brought to you for free and open access by Digital Commons @ Ryerson. It has been accepted for inclusion in Theses and dissertations by an authorized administrator of Digital Commons @ Ryerson. For more information, please contact bcameron@ryerson.ca.

Fault Diagnosis With Adaptive Kalman Filters and CMG Design for Picosatellite ACS

by Noel Abreu
B.Eng., Electrical Engineering, Ryerson University, 2008

A thesis presented to Ryerson University in partial fulfillment of the requirements for the degree of MASTER OF APPLIED SCIENCE in the Program of Aerospace Engineering

Toronto, Ontario, Canada, 2011

c Noel Abreu 2011  All rights reserved

For ... my loving parents Miguel and Ana Abreu without whose support and endless love I would not have achieved this work.

v

Author's Declaration
I hereby declare that I am the sole author of this thesis. I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research.

I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

vii

Abstract
Fault Diagnosis With Adaptive Kalman Filters and CMG Design for Picosatellite ACS Noel Abreu, Master of Applied Science, Aerospace Engineering Ryerson University, Toronto, January 2011

Picosatellites have only recently become a viable research topic thanks to the creation of the cubesat standard in 1999 and improvements in technology. However they are still limited in application because there are no high performance active actuators available in the market that can satisfy the mass/power/budget constraints of a picosatellite. Space and power are limited in these satellites which means that hardware redundancy is not very practical. If actuator faults occur, analytical redundancy techniques should be employed to determine if, where, and how the fault(s) occurred. This thesis focuses on enhancing picosatellite actuator technologies, as well as presenting an algorithm for fault detection, isolation, and identification of ACS actuators. A CMG cluster design is proposed to demonstrate the feasibility of using CMGs in picosatellites to enhance their performance. The proposed CMG cluster design weighs less than 100g , occupies less than 25% of a cubesat's volume, and theoretically consumes less than 1.5W and 1W of peak and average power respectively. Furthermore, it is capable of providing sufficient torque and momentum storage for picosatellite attitude control in LEO. Next a novel adaptive Kalman filter algorithm is presented that can be implemented with the EKF and UKF for linear and non-linear systems respectively. The algorithm performs parameter estimation with sequential adaptive estimation and fading memory mechanisms that allow it to track changes in faulty parameters even in the presence of high levels of measurement noise. Furthermore, it is capable of tracking continuously varying and instantaneous changes in parameters. Numerical simulations are carried out to verify the performance of the proposed CMG cluster design as well as the fault diagnosis algorithm. The capabilities of the filter are further demonstrated via its application to a systems identification problem for a nanosatellite RW prototype being developed at SSDC group.

ix

Acknowledgements

After two and a half years and many uncertain and turbulent times I have finally completed my master's thesis on fault diagnosis of satellite ACS and the design of a picosatellite CMG cluster. There were times where I thought I wasn't cut out, and should just fall into the rungs of hard labor or retail management. However here I am, ready to graduate. Thankful to all those who have helped guide my life's path. My supervisor, Dr. Krishna Dev Kumar, has been an invaluable source of guidance, without which this thesis would not exist. I appreciate the challenges you threw my way and your confidence in me to complete them. As a young child I always marveled at the inner workings of machinery and technology. From my days as an infant in Shangrila, Uruguay I recall the many hours spent trying to assemble my own airplanes an automobiles from the many scraps of wood left behind in my father's small shop in the back yard of our single story home. This eventually led to disassembling electronic toys in my preteen years in Toronto, Canada to see how they worked and to challenge myself to putting them back together. This enthusiasm for understanding the inner workings of things was further fueled by the maths and sciences taught to me in my primary and secondary school careers. Eventually I knew that to grasp the level of understanding I desired, studying engineering was the only way. During my time as an undergraduate in electrical engineering at Ryerson I accumulated a wealth of knowledge on how electronic devices such as computers, TVs, radios, the internet, and a whole host of other technologies work. Thus I credit the Ryerson University engineering program with making me the engineer I am today. Space had always eluded me though, and I often contemplated a career in aerospace engineering. The opportunity never arose until the electrical engineering open house on the third floor of the engineering building in the spring of 2008. Here I was approached by a charismatic cast of characters; Bryan (Sparkie) Stuurman, Geoff Mcvittie, and Mike Alger, asking me if I would like to do space research. At the time I still felt I had more to learn and develop as an engineer and was interested by the offer. After working as a research assistant for Dr. Krishna Dev Kumar for the summer and enjoying every bit of it I decided to pursue a master's degree. Thus a heartfelt acknowledgement goes to these three fellows.

x Over time they have become more than just colleagues, but friends. Their many intuitive insights into the world of engineering have served as a catalyst to my eventual maturation as an engineer. Sparkie taught me that anything can be fixed with enough solder, flux, and an oscilloscope. His intuitions have inevitably shaped my own, and for that and his friendship I am eternally grateful. From Mike Alger I learned that during frustrating times anger is only a deterrent. Over these past two and a half years I came to know other knowledgeable engineers such as the members of the paper mill. Dr. Godard, you provided motivation when there was little to be had and served as a role model to me. Towards the end your guidance was invaluable. Dr. Kam Shahid taught me that age is just a number and provided guidance during my time at SSDC. Soon to be Dr. Surjit Vaarma, a quiet spoken individual, showed me what it means to be brave when having to present other people's work three times at an international AAS conference. To the rest of the lab crew; Tom Dzamba, Dmytri Ignakov, Daren Lee, and Suketu Patel, I appreciate your friendship and comraderie. Our many nights of hooliganism, video games, and nerf darts will never be forgotten. To my closest friends and cousins, Richard Gabarro, Jose Miguel Llorens, Ivonne Llorens, Michael Fleitas, Paul Durante, and Nicolas Spinelli. I would like to thank you for providing an outlet from the hard work and many frustrations of my postgraduate career. A special thanks to Jessica Molina, my best friend and confidant, and most avid supporter. Without these individuals I think my sanity would have faltered, and life would have been difficult. Regardless of what the future holds I hope they will always remain a part of my life. To my parents Miguel and Ana Abreu, you are truly the most selfless individuals I have ever come to know. I will always be indebted to you. Your nurturing, loving, and financial support has allowed me to always focus on my goals and make something out of my life. I feel blessed and privileged to have you as my parents. This thesis is for you, and I will spend the rest of my life trying to repay all your hard work and sacrifice. Finally to my sister Desire, although you may not know it you have helped a lot by being there for me when I needed you.

Contents

Author's Declaration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Abstract . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . List of Figures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . List of Tables . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Abbreviations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1 Introduction 1.1 Motivations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1.1.1 1.1.2 1.2 1.2.1 1.2.2 1.3 1.4 1.5 1.6 Picosatellite Actuator Development . . . . . . . . . . . . . . . . . . Fault Diagnosis for Picosatellite ACS . . . . . . . . . . . . . . . . . CMG Cluster Design for Picosatellites . . . . . . . . . . . . . . . . Fault Diagnosis and Identification . . . . . . . . . . . . . . . . . . .

v vii ix xv xix xxi 1 2 6 8 9 9 10 19 21 22 23 25 26 27 27 30 32 32 33 34 38

Literature Review . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

Problem Statement . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Research Objectives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Main Contributions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Thesis Outline . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

2 Attitude Control System for RyePicoSat 2.1 2.2 2.3 2.4 2.5 2.6 2.7 Coordinate Frames . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Satellite Attitude Dynamics . . . . . . . . . . . . . . . . . . . . . . . . . . Satellite Attitude Kinematics . . . . . . . . . . . . . . . . . . . . . . . . . Disturbance Torques Modeling . . . . . . . . . . . . . . . . . . . . . . . . . Attitude Control Requirements . . . . . . . . . . . . . . . . . . . . . . . . Attitude Control by Quaternion Regulation . . . . . . . . . . . . . . . . . Actuators . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.7.1 2.7.2 Reaction Wheels . . . . . . . . . . . . . . . . . . . . . . . . . . . . Control Moment Gyroscopes . . . . . . . . . . . . . . . . . . . . . .

xii 2.8

Contents
Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40 41 42 44 52 56 57 58 65 70 71 74 77 84 91 91 98 101 105 109 113 122 124 127 131 139 144

3 CMG System Design for Picosatellites 3.1 3.2 3.3 3.4 Mathematical Modeling of Spacecraft with CMGs . . . . . . . . . . . . . . Sizing and Component Selection for CMG . . . . . . . . . . . . . . . . . . Proposed CMG System Performance Simulations . . . . . . . . . . . . . . 4SGCMG Pyramid Cluster Structural Design . . . . . . . . . . . . . . . .

4 FDI Using Kalman Filters 4.1 4.2 4.3 Extended Kalman Filter . . . . . . . . . . . . . . . . . . . . . . . . . . . . Unscented Kalman Filter . . . . . . . . . . . . . . . . . . . . . . . . . . . . Parameter Estimation with Kalman Filters . . . . . . . . . . . . . . . . . . 4.3.1 4.3.2 4.4 4.5 Parameter Estimation with EKF . . . . . . . . . . . . . . . . . . . Parameter Estimation with UKF . . . . . . . . . . . . . . . . . . .

Adaptive Kalman Filtering . . . . . . . . . . . . . . . . . . . . . . . . . . . FDI by Parameter Estimation with Adaptive Kalman Filters . . . . . . . .

5 Simulation Results of RW and CMG FDI Algorithm 5.1 FDI for Reaction Wheels . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.1.1 5.1.2 5.1.3 5.1.4 5.1.5 5.1.6 5.2 5.2.1 5.2.2 5.3 5.4 5.5 CASE 1: Intermittent BEMF Constant Faults . . . . . . . . . . . . CASE 2: Incipient BEMF Constant Fault . . . . . . . . . . . . . . CASE 3: Mild Intermittent Bus Voltage Faults . . . . . . . . . . . CASE 4: Severe Intermittent Bus Voltage Faults . . . . . . . . . . . CASE 5: Incipient BEMF Constant Fault with Severe Intermittent Bus Voltage Faults . . . . . . . . . . . . . . . . . . . . . . . . . . . Robustness of RW FDI to Measurement Noise . . . . . . . . . . . . . . . . Simulation Results for Medium Noise Levels . . . . . . . . . . . . . Simulation Results for High Noise Levels . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

CASE 6: Severe Intermittent BEMF Constant and Bus Voltage Faults118

FDI for CMGs

System Identification of RW Hardware . . . . . . . . . . . . . . . . . . . . Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

Contents
6 Conclusions 6.1 Summary of Contributions . . . . . . . . . . . . . . . . . . . . . . . . . . . 6.1.1 6.1.2 6.1.3 6.2 6.2.1 6.2.2 Bibliography A Adaptive Parameter Plots for FDI Simulations Picosatellite CMG Cluster Design . . . . . . . . . . . . . . . . . . . Novel Adaptive Kalman Filters . . . . . . . . . . . . . . . . . . . . FDI for CMGs . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Picosatellite CMG Cluster Design . . . . . . . . . . . . . . . . . . . Novel Adaptive Kalman Filters . . . . . . . . . . . . . . . . . . . .

xiii 147 148 148 148 149 150 150 150 151 167

Future Work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

List of Figures
1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 2.1 2.2 2.3 2.4 2.5 2.6 Trend in Micro and Small Satellite Launches 1980-2000 [isu 2010]. . . . . . Nanosatellite Missions from 2004-2007 . . . . . . . . . . . . . . . . . . . . Number of Nanosatellites Deployed per Launcher . . . . . . . . . . . . . . Number of Successful Cubesat Launches per Year (2000-2010) . . . . . . . Types of Faults . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Steps in Fault Diagnosis . . . . . . . . . . . . . . . . . . . . . . . . . . . . Analytical VS Hardware Redundancy . . . . . . . . . . . . . . . . . . . . . Analytical Redundancy Techniques . . . . . . . . . . . . . . . . . . . . . . Coordinate Frames . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Satellite Body Frame . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Reaction Wheel Dynamics . . . . . . . . . . . . . . . . . . . . . . . . . . . Control Moment Gyroscope [Lappas 2002] . . . . . . . . . . . . . . . . . . 4SGCMG Pyramid System . . . . . . . . . . . . . . . . . . . . . . . . . . . Momentum Envelopes of 4SGCMGs Pyramid Cluster ( = 54.73o ) and and 3SGCMGs Orthogonal Cluster . . . . . . . . . . . . . . . . . . . . . . . . . 3.1 3.2 3.3 3.4 3.5 3.6 3.7 4.1 4.2 4.3 4.4 Radial and Axial Load Directions on a Motor Shaft . . . . . . . . . . . . . Input/Output CMG Torque Vectors . . . . . . . . . . . . . . . . . . . . . . CMG Simulation Control Logic . . . . . . . . . . . . . . . . . . . . . . . . CMG Attitude Control for 90 CMG Attitude Control for 90 CMG Attitude Control for 90
  

3 3 4 5 10 11 14 16 26 28 36 38 39 40 44 47 52 54 54 55 56 63 66 68 87

Roll Maneuver . . . . . . . . . . . . . . . . Pitch Maneuver . . . . . . . . . . . . . . . Yaw Maneuver . . . . . . . . . . . . . . . .

4SGCMG Pyramid Structural Design . . . . . . . . . . . . . . . . . . . . . EKF Signal Flow . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Unscented Transformation VS Linearization . . . . . . . . . . . . . . . . . UKF Signal Flow . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . AKF Signal Flow . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

xvi 4.5 5.1 5.2 5.3 5.4 5.5 5.6 5.7 5.8 5.9

List of Figures AUKF Signal Flow . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . RW FDI Simulation Setup . . . . . . . . . . . . . . . . . . . . . . . . . . . Reaction Wheel Applied Voltage Profile . . . . . . . . . . . . . . . . . . . . Reaction Wheel States for First 200 s . . . . . . . . . . . . . . . . . . . . . CASE 1 - Reaction Wheel Current Estimation . . . . . . . . . . . . . . . . CASE 1 - Reaction Wheel Speed Estimation . . . . . . . . . . . . . . . . . CASE 1 - Bus Voltage Estimation . . . . . . . . . . . . . . . . . . . . . . . CASE 1 - BEMF Constant Estimation . . . . . . . . . . . . . . . . . . . . CASE 2 - Reaction Wheel Speed Estimation . . . . . . . . . . . . . . . . . CASE 2 - Reaction Wheel Current Estimation . . . . . . . . . . . . . . . . 88 93 97 97 98 99 100 100 102 102 103 104 105 106 107 107 110 110 111 112 114 114 115 115 118 119 120 120 124 125

5.10 CASE 2 - Bus Voltage Estimation . . . . . . . . . . . . . . . . . . . . . . . 5.11 CASE 2 - BEMF Constant Estimation . . . . . . . . . . . . . . . . . . . . 5.12 CASE 3 - Reaction Wheel Speed Estimation . . . . . . . . . . . . . . . . . 5.13 CASE 3 - Reaction Wheel Current Estimation . . . . . . . . . . . . . . . . 5.14 CASE 3 - Bus Voltage Estimation . . . . . . . . . . . . . . . . . . . . . . . 5.15 CASE 3 - BEMF Constant Estimation . . . . . . . . . . . . . . . . . . . . 5.16 CASE 4 - Reaction Wheel Speed Estimation . . . . . . . . . . . . . . . . . 5.17 CASE 4 - Reaction Wheel Current Estimation . . . . . . . . . . . . . . . . 5.18 CASE 4 - Bus Voltage Estimation . . . . . . . . . . . . . . . . . . . . . . . 5.19 CASE 4 - BEMF Constant Estimation . . . . . . . . . . . . . . . . . . . . 5.20 CASE 5 - Reaction Wheel Speed Estimation . . . . . . . . . . . . . . . . . 5.21 CASE 5 - Reaction Wheel Current Estimation . . . . . . . . . . . . . . . . 5.22 CASE 5 - Bus Voltage Estimation . . . . . . . . . . . . . . . . . . . . . . . 5.23 CASE 5 - BEMF Constant Estimation . . . . . . . . . . . . . . . . . . . . 5.24 CASE 6 - Reaction Wheel Speed Estimation . . . . . . . . . . . . . . . . . 5.25 CASE 6 - Reaction Wheel Current Estimation . . . . . . . . . . . . . . . . 5.26 CASE 6 - Bus Voltage Estimation . . . . . . . . . . . . . . . . . . . . . . . 5.27 CASE 6 - BEMF Constant Estimation . . . . . . . . . . . . . . . . . . . . 5.28 Medium Noise - Reaction Wheel Speed Estimation . . . . . . . . . . . . . 5.29 Medium Noise - Reaction Wheel Current Estimation . . . . . . . . . . . .

List of Figures 5.30 Medium Noise - Bus Voltage Estimation . . . . . . . . . . . . . . . . . . . 5.31 Medium Noise - BEMF Constant Estimation . . . . . . . . . . . . . . . . . 5.32 High Noise - Reaction Wheel Speed Estimation . . . . . . . . . . . . . . . 5.33 High Noise - Reaction Wheel Current Estimation . . . . . . . . . . . . . . 5.34 High Noise - Bus Voltage Estimation . . . . . . . . . . . . . . . . . . . . . 5.35 High Noise - Reaction Wheel Current Estimation . . . . . . . . . . . . . . 5.36 CMG FDI Simulation Flow . . . . . . . . . . . . . . . . . . . . . . . . . . 5.37 CMG FDI - Attitude Quaternion . . . . . . . . . . . . . . . . . . . . . . . 5.38 CMG FDI - Unit 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.39 CMG FDI - Unit 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.40 CMG FDI - Unit 3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.41 CMG FDI - Unit 4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.42 CMG FDI Singularity Measure . . . . . . . . . . . . . . . . . . . . . . . . 5.43 Nanosatellite RW Module . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.44 Simple DC Motor Circuit . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.45 Applied Voltage Profile . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.46 System Identification Results . . . . . . . . . . . . . . . . . . . . . . . . .

xvii 125 126 128 128 129 130 132 134 135 135 136 136 137 139 139 141 142 142 167 168 169 169 170 170 171 171 172 172 173 173

5.47 System Identification: Residual . . . . . . . . . . . . . . . . . . . . . . . . A.1 CASE 1 - Adaptive Forgetting Factor . . . . . . . . . . . . . . . . . . . . . A.2 CASE 1 - Q and R Matrices . . . . . . . . . . . . . . . . . . . . . . . . . . A.3 CASE 2 - Adaptive Forgetting Factor . . . . . . . . . . . . . . . . . . . . . A.4 CASE 2 - Q and R Matrices . . . . . . . . . . . . . . . . . . . . . . . . . . A.5 CASE 3 - Adaptive Forgetting Factor . . . . . . . . . . . . . . . . . . . . . A.6 CASE 3 - Q and R Matrices . . . . . . . . . . . . . . . . . . . . . . . . . . A.7 CASE 4 - Adaptive Forgetting Factor . . . . . . . . . . . . . . . . . . . . . A.8 CASE 4 - Q and R Matrices . . . . . . . . . . . . . . . . . . . . . . . . . . A.9 CASE 5 - Adaptive Forgetting Factor . . . . . . . . . . . . . . . . . . . . . A.10 CASE 5 - Q and R Matrices . . . . . . . . . . . . . . . . . . . . . . . . . . A.11 CASE 6 - Adaptive Forgetting Factor . . . . . . . . . . . . . . . . . . . . . A.12 CASE 6 - Q and R Matrices . . . . . . . . . . . . . . . . . . . . . . . . . .

xviii

List of Figures 174 174 175 175 176 176 177 177 178

A.13 Medium Noise Power - Adaptive Forgetting Factor . . . . . . . . . . . . . . A.14 Medium Noise Power - Q and R Matrices . . . . . . . . . . . . . . . . . . . A.15 High Noise Power - Adaptive Forgetting Factor . . . . . . . . . . . . . . . A.16 High Noise Power - Q and R Matrices . . . . . . . . . . . . . . . . . . . . . A.17 CMG FDI - Adaptive Forgetting Factor . . . . . . . . . . . . . . . . . . . . A.18 CMG FDI - Q Matrix . . . . . . . . . . . . . . . . . . . . . . . . . . . . . A.19 CMG FDI - R Matrix . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . A.20 System Identification - Adaptive Forgetting Factor . . . . . . . . . . . . . . A.21 System Identification - Q and R Matrices . . . . . . . . . . . . . . . . . . .

List of Tables
1.1 1.2 1.3 2.1 3.1 3.2 3.3 3.4 3.5 3.6 3.7 5.1 5.2 5.3 5.4 5.5 5.6 5.7 5.8 5.9 Satellite Classification . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Successful Cubesat Launches to Date[ams 2010] . . . . . . . . . . . . . . . Satellite Program Costs by Mass . . . . . . . . . . . . . . . . . . . . . . . 1 5 6 39 45 46 48 49 50 53 53 92 94 94 95 95 95 96 101 101 104 104 108 108 112

Advantages and Disadvantages of Different Types of CMGs[Lappas 2002] . Worst-case Disturbance Torques for Picosatellite in 400 km LEO . . . . . . RyeSat ACS requirements . . . . . . . . . . . . . . . . . . . . . . . . . . . Faulhaber 1202 Penny Motor Specifications . . . . . . . . . . . . . . . . . . Steel Flywheel Design Parameters . . . . . . . . . . . . . . . . . . . . . . . Gimbal Motor Comparisons . . . . . . . . . . . . . . . . . . . . . . . . . . SR Steering Logic Parameters . . . . . . . . . . . . . . . . . . . . . . . . . CMG Picosatellite Simulation Parameters . . . . . . . . . . . . . . . . . . Ithaco A Reaction Wheel Parameters . . . . . . . . . . . . . . . . . . . . . Simulation Parameters for RW FDI . . . . . . . . . . . . . . . . . . . . . . Fault Case 1 - RW Severe Intermittent BEMF Constant Fault Profile . . . Fault Case 2 - RW Intermittent Time-varying BEMF Constant Fault Profile Fault Case 3 - RW Mild Intermittent Bus Voltage Fault Profile . . . . . . . Fault Case 4 - RW Severe Intermittent Bus Voltage Fault Profile . . . . . . Fault Case 6 - Severe BEMF Constant and Bus Voltage Out of Phase . . . CASE 1 - Performance Indices of BEMF Constant Estimate . . . . . . . .

Fault Case 5 - Simultaneous BEMF Constant and Bus Voltage Severe Faults 96

5.10 CASE 1 - Performance Indices of Bus Voltage Estimate . . . . . . . . . . . 5.11 CASE 2 - Performance Indices of BEMF Constant Estimate . . . . . . . . 5.12 CASE 2 - Performance Indices of Bus Voltage Estimate . . . . . . . . . . . 5.13 CASE 3 - Performance Indices of BEMF Constant Estimate . . . . . . . . 5.14 CASE 3 - Performance Indices of Bus Voltage Estimate . . . . . . . . . . . 5.15 CASE 4 - Performance Indices of BEMF Constant Estimate . . . . . . . .

xx

List of Tables 5.16 CASE 4 - Performance Indices of Bus Voltage Estimate . . . . . . . . . . . 5.17 CASE 5 - Performance Indices of BEMF Constant Estimate . . . . . . . . 5.18 CASE 5 - Performance Indices of Bus Voltage Estimate . . . . . . . . . . . 5.19 CASE 6 - Performance Indices of BEMF Constant Estimate . . . . . . . . 5.20 CASE 6 - Performance Indices of Bus Voltage Estimate . . . . . . . . . . . 5.21 Simulation Parameters for Medium Noise RW FDI . . . . . . . . . . . . . . 5.22 Simulation Parameters for High Noise RW FDI . . . . . . . . . . . . . . . 5.23 Medium Noise Power - Performance Indices of BEMF Constant Estimate . 5.24 Medium Noise Power - Performance Indices of Bus Voltage Estimate . . . . 5.25 High Noise Power - Performance Indices of BEMF Constant Estimate . . . 5.26 High Noise Power - Performance Indices of Bus Voltage Estimate . . . . . 5.27 Simulation Parameters for CMG FDI . . . . . . . . . . . . . . . . . . . . . 5.28 CMG Fault Parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.29 CMG FDI RMSE . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.30 CMG FDI ME . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.31 Portescap Nuvodisc 32BF . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.32 Simulation Parameters for Portescap Systems Identification . . . . . . . . . 5.33 Portescap System Identification Results . . . . . . . . . . . . . . . . . . . . 112 117 117 121 121 122 123 126 127 130 131 133 134 138 138 140 141 143

Abbreviations

ACS ADS ADCS AFF AKF AUKF BEMF BLDC CM CMG COTS CT DCM DGCMG DT ECEF EKF FDI FP GG GPS IAE IMM IMU ISS KF LEO LKF

Attitude Control System Attitude Determination System Attitude Determination and Control System Adaptive Fading Factor Adaptive Kalman Filter Adaptive Unscented Kalman Filter Back Electromotive Force Brushless Direct Current Covariance Matching Control Moment Gyroscope Commercial Off The Shelf Continuous Time Direction Cosines Matrix Double-Gimbal Control Moment Gyroscope Discrete Time Earth Centered Earth Fixed Extended Kalman Filer Fault Diagnosis and Identification Fault Parameter Gravity Gradient Global Positioning System Innovation Adaptive Estimation Interactive Multiple Model Inertial Measurement Unit International Space Station Kalman Filter Low Earth Orbit Linear Kalman Filter

xxii ME MEMS MLA MM MMAE MOI MTR PCB PDF RKF RMSE RW SAE SGCMG SRP SSDC SSO UAV UKF ZOH Mean Error Micro-Electro-Mechanical-System Maximum Likelihood Approach Multiple Model Multiple Model Adaptive Estimation Moment of Inertia Magnetic Torque Rod Printed Circuit Board Probability Density Function Robust Kalman Filter Root Mean-Squared Error Reaction Wheel Sequential Adaptive Estimation Single-Gimbal Control Moment Gyroscope Solar Radiation Pressure Space Systems Dynamics and Control Sun-Synchronous Orbit Unmanned Aerial Vehicle Unscented Kalman Filter Zero-Order Hold

List of Tables

Chapter 1

Introduction

Since the advent of earth orbiting artificial satellites in the late 1950's, technologies have improved to the point where today the development of small satellites is practical. Trends in satellite technologies have lead to more functionality in smaller packages which has impacted the space industry. Traditionally small satellites have been considered as 500 kg or less, the following table lists the satellite classifications by mass, At the beginning of Class Large Medium Mini Micro Nano Pico Femto Mass(kg) > 1000 500-1000 100-500 10-100 1-10 0.1-1 < 0.1

Table 1.1: Satellite Classification satellite development the solid-state age of the electronics industry had already began, this would prove to be a catalyst for spacecraft development. The first earth-orbiting artificial satellite was launched in 1957 by the Russians. Sputnik was an 83.6 kg satellite that helped identify the upper atmospheric layer's density and study the effects of the ionosphere on radio signal distribution. Sputnik 2 was launched later that year weighing over 500 kg and was the first to carry a living animal. The launch of Sputnik 1 sparked the Sputnik Crisis and subsequent space race within the Cold War. The Americans were quick to respond with the Explorer program. The 13.97 kg Explorer 1 was launched on January 31, 1958

2

Chapter 1. Introduction

with a cosmic ray sensing payload. Explorer 2 was launched nearly a month later but failed to reach orbit, and Explorer 3 was successfully launched later that month. All of these satellites in the Explorer program weighed more than 10 kg and provided the data needed for the discovery of the Van Allen radiation belt. In total the Americans successfully launched seven satellites in 1958-1959, while the Russians launched five of their own. From that time forward satellite and space probe development increased at an exponential rate for military and scientific purposes.

1.1

Motivations

Since the beginning of satellite development in the late 1950's, up to 1980 there had been well over 1000 satellite launches, with a small percentage (<10%) of satellites weighing less than 100 kg and less than 1% of satellites weighing 10 kg or less. In the time period 19801999 a total of 487 small satellites have been launched, 238 mini-satellites and 249 micro satellites from countries all over the world[Konecny 2004]. The start of the "modern" era for small satellites was 1981 when University of Surrey launched the 54 kg UoSAT-1, the first satellite to have an on-board microprocessor. This satellite successfully demonstrated the versatility of small satellites when combined with high technology. Coupled with the arrival of Dan Goldin new NASA administrator in 1992 the trend in smaller satellites persisted. Goldin adopted a smaller, faster, cheaper philosophy for NASA projects. He knew that smaller satellites were cheaper and faster to develop, and was weary of the failures of several high profile missions and cuts in funding during turbulent economic times. The trend eventually led to research on satellites that were smaller, cheaper and faster to develop than their larger cousins. Since the late 90's nanosatellite development has received a lot of attention. One of the earliest nanosatellites of the modern era was launched in 2000 also by Surrey Satellite Technology. The SNAP-1 was the first satellite with a mass less than 10 kg to have full 3-axis attitude control, on-board propulsion for orbit control, and the ability to image other satellites in orbit. This was proof of what could be accomplished in such a small package. Subsequently in the period 2004-2007 fifty-five nanosatellites have been launched by eleven different countries, of which 70.91% were successful(Fig. 1.2). On

1.1. Motivations

3

Figure 1.1: Trend in Micro and Small Satellite Launches 1980-2000 [isu 2010]. April 2008 COM DEV International developed the NTS nanosatellite to track ships from space using Automatic Identification System(AIS) signals. Astonishingly the entire unit was developed and launched with in a 7-month time-frame, supporting the feasibility and potential for commercial success of these satellites.

Figure 1.2: Nanosatellite Missions from 2004-2007 Interestingly 74.55 % of these satellites have been deployed for institutional purposes and 25.45 % for military uses, representing a shift from primarily military applications to more civilian endeavors. Formation flying and/or constellations of nanosatellites have been the most highly touted potential applications for these small satellites. Although constellations of microsatellites and larger exist for communications and GPS satellites, they are extremely

4

Chapter 1. Introduction

expensive to develop and cannot be launched three or four at a time because of their size. Nanosatellite developers can launch multiple units in one shot(Fig. 1.3), resulting in substantial cost savings and more reason to pursue satellite miniaturization research.

Figure 1.3: Number of Nanosatellites Deployed per Launcher In 1999, California Polytechnic State and Stanford Universities developed the cubesat standard. A cubesat is a 10x10x10 cm satellite with a mass less than 1 kg, although two and three cubes are also common. The standard includes strict requirements on satellite design such that it conforms with deployment vehicle specifications. From the onset it was understood that picosatellites could be developed at lower costs and in shorter periods of time as compared to nanosatellites. The intention of the cubesat standard was to provide universities with the means to develop small satellites for science research and technology demonstrations using commercial-off-the-shelf(COTS) components. COTS components can be described as technologies that are ready-made and available for sale, lease, or license to the general public. Motivations for using these components are reduced costs and development times. To date there have been eight successful launches with cubesats(Table 1.1). Since 2003 approximately forty international universities have cooperated on the development of 31 cubesats[Schilling 2006] built by seventeen of those universities, with more launches to take place in the near future. Thanks to the low costs associated with cubesat development, universities in countries across the world and many developing countries

1.1. Motivations Date Jun. 30, 2003 Oct. 27, 2005 Feb. 22, 2006 Dec. 16, 2006 Apr. 17, 2007 Apr. 28, 2008 May 19, 2009 Sept. 23, 2009 Launcher Rockot Kosmos-3M JAXA M-V-8 Minotaur Dnepr 1 PSLV Minotaur 1 PSLV-C14 Number of Cubesats 5 3 1 double 1 triple 6 + 1 triple 3 + 1 double + 2 triple 3 + 1 triple 4

5

Table 1.2: Successful Cubesat Launches to Date[ams 2010]

Figure 1.4: Number of Successful Cubesat Launches per Year (2000-2010)

have been able to develop space programs. Picosatellites have proven to be an excellent source of experience for space systems development, operation, and maintenance on a small scale that can be used as a basis to develop larger, more complex space programs. Table 1.3 shows typical costs associated with the various classes of satellites. Evidently there is good reason to pursue cubesat development, they are clearly the superior option for lowincome institutions. However various challenges exist within the current marketplace and technological landscape that limit the feasibility of cubesat development for commercial institutions. Cubesats are simply too small. Size restrictions translate to smaller payloads, actuators, sensors, batteries, and radios. All of which must be newly developed.

6 Class Large (> 1000 kg) Small ( 500-1000 kg) Mini (100-500 kg) Micro (10-100 kg) Nano (1-10 kg) Pico (0.1-1 kg)

Chapter 1. Introduction Costs (Millions of US$) > 100 50-100 5-20 2-3 0.5-1 < 0.08

Table 1.3: Satellite Program Costs by Mass For commercial interest to blossom, a profitable business model must be put forth with a strong bottom line. Otherwise academic institutions will have to continue to spear-head the technology development. Without commercial interest a technology is hard-pressed to evolve. However COTS technology has consistently improved while space technologies have lagged behind for want of space-proven parts. Consequently technologies required to build a picosatellite actuator or payload actually exist, and universities are aware of this. As academia continues to develop proven picosatellite technologies, a wider variety of space missions will be possible and profitable business models may ensue. In fact, Clyde Space has conservatively predicted that the number of cubesats launched will increase from 50 today, to about 500 by 2020. Commercial interest will inevitably follow.

1.1.1

Picosatellite Actuator Development

Picosatellite development is in its infancy, and new technologies must be developed to stimulate commercial interest. They are still considered impractical for many prospective missions as compared to larger satellites due to a lack of available technologies. Few payloads exist that can perform meaningful missions in earth orbit, and few actuator technologies have been developed that can provide full 3-axis attitude control while satisfying cubesat constraints. Universities are at the forefront of developing truly picosatellite sized actuators. The Technical University of Berlin has developed the BeeSAT cubesat project whose primary mission it is to test a cluster of three Reaction Wheels(RW) that weighs less than 150 g [Hakan Kayal 2007]. St. Louis University[Jayaram 2008] and the Lulea University

1.1. Motivations

7

of Technology[Garza 2008] of Sweden have also developed RWs for picosatellites. However only the BeeSAT system has made it to space. Within the past four years attempts have been made to develop actuators that can provide high performance for picosatellites although progress has been slow. This is why SSDC group is focusing on picosatellite technology development of RWs and CMGs. A RW consists of a flywheel mounted to an electric motor. They have been used extensively for active control of spacecraft. Generally RWs can perform slow maneuvering of satellites with average slew rates of approximately 1 /s . This is necessary to avoid saturating the wheel and to keep power consumption low. Saturation occurs when the maximum wheel speed is reached and no more actuation is available in the direction of increasing wheel speed. This phenomenon is usually resolved using momentum dumping techniques with thrusters or magnetic torque rods(MTR). Power consumed during a maneuver is directly related to the reaction torque generated by a RW, fast slews translate to larger motor torques and consequently larger current draws. Power consumption and weight issues have been limiting factors for picosatellite RW development, however some of these issues can be resolved by employing CMGs. A CMG functions on the gyroscopic principle, wherein a rotating mass resists movement with a force proportional to its speed of rotation. A similar effect is experienced when holding onto a spinning bicycle wheel on a swivel chair, with the wheel's spin axis parallel to the horizontal plane. As the wheel spins faster it becomes more difficult to tilt, the gyroscopic force is resisting the movement. However if the wheel is tilted then a large force is imparted onto the frame supporting it, causing the chair frame to rotate. CMGs consist of a flywheel that is rotated/gimballed about one or two of its axes, an output torque is generated in the direction of change of the flywheel spin axis. They can produce larger output torque to input power ratios compared to RW configurations[V. Lappas & Underwood 2005] and consume less electrical power for a given mass. For RW torque generation a transient current will occur from the time a voltage is applied at the armature until the back EMF(BEMF) voltage amplitude comes close to matching the applied voltage with opposite polarity, this results in a near zero voltage across the armature circuit so long as the wheel speed or applied voltage does not change. More current is drawn in a transient state of the wheel speed


8

Chapter 1. Introduction

than at constant speed, thus large angle maneuvers will consume more power. For CMGs a small transient current is experienced to start up the flywheels until a desired constant speed is attained, and the gimbal motors consume power when holding their positions or trying to rotate the flywheels. Gimbal angle rates are usually limited to < 10 /s . Because they rotate slowly, gimbal motors do not consume much power. In Lappas[Lappas 2002] this has been verified via hardware simulations. CMGs can provide large output torques relative to RWs for a given electrical input at low mass penalties. This is why most CMGs have been utilized in large spacecraft and space stations. However none exist for picosatellites, with a very select few having been designed for nanosatellites. Currently, applications of picosatellites are limited because of a lack of precise three-axis pointing. CMGs could resolve this issue and provide greater versatility and profitability for picosatellites.


1.1.2

Fault Diagnosis for Picosatellite ACS

In general it has been the case that regardless of the size of a satellite a myriad of resources are required in order to oversee a satellite project from proposed design and inception to mission completion. Engineers of many disciplines must be employed, countless tests must be performed, and in-orbit changes must be monitored. During the entire mission life of a satellite costs are accrued, if faults or failures occur on a satellite these costs will increase. As an owner/operator of a satellite these costs must be kept within reason. The most probable area on a satellite for a fault to occur is the attitude control system(ACS). Actuators almost always consist of moving mechanical parts subject to wear and tear. Ground tests in anachoic and thermal vacuum chambers, as well as launch vibration tables, can be used to verify that in ideal space conditions the spacecraft should survive. However unforeseen elements can lead to premature faults or failures such as a cold solder joint affecting electrical performance, minute particles interfering with mechanical components, or wild temperature fluctuations. In an attempt to curb the costs associated with the occurrence of faults or failures, fault diagnosis and identification(FDI) techniques can be developed to help monitor and anticipate them. Fault diagnosis will refer to detection and isolation of faults, fault identification will refer to identifying the type and severity of faults.

1.2. Literature Review

9

The FDI problem for satellites has been addressed for for attitude determination systems(ADS) and ACSs. In either case the objective is to determine whether or not a fault has occurred, and where it has occurred. In the past with larger satellites, faults and/or failures were handled through hardware redundancy because online computing power was at a premium and there was more onboard space. In the current landscape hardware redundancy is limited in order to reduce costs. In case a fault occurs, numerical methods can be utilized to diagnose and correct the problem(s). By processing sensor and actuator data online these techniques are possible. If the satellite is able to detect, isolate, and identify these faults then operators on the ground can move quickly to obtain the best possible performance from the satellite, or the satellite could simply correct the problem itself. Ultimately the goal is to facilitate at least partial completion of a mission in case of faults or failures. Since RWs and CMGs are very common actuators online FDI algorithms should be available that can monitor them. The problem of online FDI for a satellite ACS has not been studied extensively in the literature. Few researchers have tackled the FDI problem for reaction wheels in an ACS, while none have studied FDI for CMGs.

1.2
1.2.1

Literature Review
CMG Cluster Design for Picosatellites

CMG design documents are difficult to come by because they are mostly designed and manufactured by commercial entities. Generally a company will not make its product design specifications and procedures publicly available for competitive reasons. CMGs have been used since the early 70's in Skylab, the US military observation satellite KH-11, and MIR. Manufacturers VNIIEM and Honeywell were known for magnetic and ball bearing systems respectively. The French company Aerospatiale has developed mini CMGs for micro-class satellites and larger. The unit weighs 30 kg, consumes 45 W of peak power and 15 W in standby mode and uses a flywheel with inertia 0.0796 kg · m2 rotating at 12000 rpm. Momentum storage and output torque numbers are not listed, however they are probably comparable to that of the Skylab CMG system[T. R. Coon 1976]. In reference [Joel Reiter 1999] a CMG design is proposed for microsatellites using micro-electro-

10

Chapter 1. Introduction

mechanical-systems(MEMS) technology however it is not very practical. Currently, the only CMG system developed for satellites smaller than 10 kg comes out of SSTL and is described in reference ([Lappas 2002]). For picosatellites no designs have been proposed.

1.2.2

Fault Diagnosis and Identification

Within the current state of technology researchers can implement complex algorithms onboard small satellite computers such that the satellites themselves can perform for the most part autonomously. Thus research of online ACS fault diagnosis algorithms has proliferated since the mid 90's. A "fault" will denote an unpredicted change of system behavior resulting in a degradation of performance or preventing any semblance of normal operation of the system. They can be classified based on their duration and severity(Fig. 1.5). Faults
fault fault fault time Transient Fault

time Abrupt and Permanent Fault

time Intermittent Fault

fault signal

fault

fault signal time Incipient Fault

+

faulty signal

X

faulty signal

Additive Fault

Multiplicative Fault

Figure 1.5: Types of Faults can occur abruptly or slowly over time. Abrupt faults are usually caused by external disturbances that severely damage a component, such as the loss of an aircraft engine when impacted by birds or other things. Once they occur, replacement of the faulty component is the best course of action because the abrupt nature of the fault can introduce large stresses to the structure or electronics. Incipient faults occur slowly over time as the result of wear and tear within a mechanical system such as increased frictional losses in ball bearings. In this case immediate replacement of the faulty component is not necessary as long as satisfactory performance can be achieved. Transient and intermittent faults occur randomly

1.2. Literature Review

11

for bounded periods of time and then vanish, this makes them difficult to identify. They differ with respect to the number of states they can assume. For example a transient fault assumes one state and then vanishes, whereas intermittent faults can assume various states throughout a faulty time interval. An example of an intermittent fault is a loose electrical connection in a circuit. If vibrations are introduced to the circuit or changes in temperature for a bounded period of time faults will occur in the system. Additive faults are simply superimposed on healthy signals of a system, while multiplicative faults are directly proportional to system states. There are three primary components to fault diagnosis algorithms; (1) detection, (2) isolation, (3) identification. An FDI algorithm should be able to detect the occurrence of a

Figure 1.6: Steps in Fault Diagnosis fault, isolate where the fault has occurred, and for completeness identify what type of fault has occurred(Fig. 1.6). These tasks are not relevant for all applications, some applications will only require fault detection while others will also require isolation. Detection would only be required when regardless of the type of fault or its location the corrective action is the same, in this case the algorithm or mechanism would simply alert the operator(computer or human) that a fault has occurred. Isolation could be required in a complex system with many moving parts that could not be examined meticulously by an operator due to the sheer size and complexity of the system. In this case the algorithm should be able to detect and isolate the location of a fault so that the corrective action is fast and efficient. Identification of a fault is not always necessary when an operator is in charge of the corrective action, they would simply test the part themselves and then repair or replace it. However, fault identification is an important element to fault diagnosis if the

12

Chapter 1. Introduction

operators need to know right away which component faulted and why. Safety-critical systems or space systems are ideal candidates for this. The identification procedure must determine what part of the component is faulty so that the operator can determine onthe-fly what type of corrective action to take specifically for that component. In safety critical systems or autonomous systems this is a very valuable feature. For autonomous systems the operator can be considered as a computer. If the operator is indeed a computer that relies on FDI algorithms to determine the health of the system and the appropriate corrective action to take, then data is usually available in the form of sensor measurements. It is widely understood that sensors are subject to various errors and real-life systems are subject to disturbances that can lead to false alarms in an FDI algorithm. Consequently an FDI algorithm must be robust in the face of measurement noise and disturbances, such that decreased sensitivity to noise and disturbances can be achieved without decreasing sensitivity to faults. Over the past 2-3 decades research in autonomous FDI systems has received a lot of attention. As electric systems have permeated more and more into industries all over the world, the realization has set in that considerable computational power is now available to do complex computations on-line. Furthermore the need for fault diagnostics has increased as systems have become more complex. The most common approach in the early development of fault diagnosis schemes was signal processing. Time domain limit checking and trend analysis, and frequency domain techniques such as the Discrete Fourier Transform(DFT) are types of signal processing techniques. Limit checking involves analyzing the statistics of measurable states and outputs of a system and comparing them to the normal operating limits of the system[S. Simani & Patton 2003]. Dynamic trend or qualitative trend analysis is one of the most common trend analysis techniques[M.R. Maurya 2007] for FDI, it consists of two steps; (1) extracting trends from measurements, (2) interpreting the extracted trends[Sobahni-Tehrani 2008]. Extensive work has been done on trend extraction and representation including the establishment of a formal framework for representing process trends[Cheung & Stephanopoulos 1990]. Neural networks are well-suited to performing trend analysis and/or feature extraction for determining the operating state of a system[V. Venkatasubramanian 1991]. Fuzzified sym-

1.2. Literature Review

13

bolic representations[J. Wong & Palazoglu 1998] are also well suited to the task. Clustering algorithms based on Bayesian classification rules have also been developed to classify data into clusters that are centered about means determined a priori, with each mean representing a particular operating condition of a system[MacQueen 1967]. Interpretation of the classified data has been approached using alignment-based sequence-matching algorithms[M. Vingron 1989], hidden Markov models[W. Sun 2003], and dynamic timewarping for similarity estimation[J. Colomer 2002]. Frequency domain analysis of a timeseries of measured system states and outputs is another form of signal processing. The Discrete Wavelet Transform has been used for over fifteen years to perform feature extraction for fault diagnosis of machinery components[Peng 2004]. Another frequency domain technique is the DFT algorithm that transforms data from a time-domain representation to its frequency domain representation, where its frequency response can be analyzed and interpreted[J.W. Freestone 1986]. The problem with using signal processing techniques is that they do not consider the dynamic relationships between the measured signals of a system. The processed data represents the system as a whole including disturbances, non-linearities, and noise, thus the estimates are not very accurate. The ARMAX model is a general deterministic-stochastic model that has been used as far back as 1978[H. 1976] and was developed to extract information about system dynamics and noise. The model structure consists of a transfer function for the system dynamics and one for the system noise[Zywno 2007]. This structure must be known a priori though, which is not possible in all cases. Linear and non-linear least-squares techniques are used to estimate the coefficients of these transfer functions. However if disturbances occur that are not well represented in the model, and the structure is not well known, the performance of this technique is diminished. Consequently if a large disturbance or non-linearity affects a system, signal processing algorithms will tend to trigger false alarms[Sobahni-Tehrani 2008]. To overcome this problem researchers have employed redundancy techniques. Figure 1.7 demonstrates how redundancy fits into a control system. Redundancy allows for consistency checks to be performed between measured signals of a system that are mutually related, if one signal is not consistent with the others then a fault or failure has occurred. There are two forms of redundancy; (1)

14

Chapter 1. Introduction

Figure 1.7: Analytical VS Hardware Redundancy

hardware redundancy, (2) analytical redundancy. Hardware redundancy is achieved by using multiple(redundant) units of the same hardware in a system. In either case the goal is to perform consistency checks amongst the redundant units to determine whether any one unit is faulty. For example some satellite ACSs use four RWs for actuation with one redundant wheel usually mounted such that it can actuate on all body-axes. If one of the orthogonally mounted wheels fails, the redundant wheel can provide actuation about the uncontrolled axis. Many earth-orbiting satellites use combinations of attitude sensors such as star trackers, sun sensors, magnetometers, and earth horizon sensors to have redundant attitude measurement. Hardware redundancy however is not always a viable option in systems where onboard space and volume is limited. Furthermore the costs associated with extra hardware units are sometimes too large to accommodate. Some of the drawbacks of hardware redundancy can be avoided by using analytical redundancy.

1.2. Literature Review

15

An FDI algorithm that employs analytical redundancy is typically referred to as a model-based fault diagnosis system. Model-based fault diagnosis consists of using a mathematical model of the system in question to describe the ideal behavior of the system in a fault-free case. The output of the model is used to perform consistency checks against the measured states of the system. If the measurements deviate noticeably from the expected system behavior then it is assumed the system is operating in a faulty mode. The consistency check involves taking the difference between the model output (yk ) and system measurements(zk ). This results in a residual error signal that provides information about the health of the system. Residuals are paramount to the proper design of any FDI algorithm. A well chosen residual can mean the difference between a good FDI algorithm that responds well to faults of all types and severities, and a mediocre algorithm that is prone to false alarms. Residual signals should be zero in the healthy case and non-zero in a faulty system mode, however in practice measurements are subject to white-noise and systems are subject to disturbances which limits the residual to being in the vicinity of zero in healthy states. Residual generation can be approached in one of three ways[Sobahni-Tehrani 2008](Fig. 1.8); (1) mathematical model-based, (2) learning/intelligence-based, (3) expert system/fuzzy rule-based. Mathematical model-based residual generation involves a mathematical model of a system derived using physical principles. Model-based schemes can be classified further into linear and nonlinear observer-based methods[Wang Min 2008, Zhang Ke 2007] in a deterministic setting and Kalman filtering[N. Tudoroiu 2005] (extended Kalman filter (EKF), Unscented Kalman Filter(UKF), Adaptive Kalman Filter(AKF), and the linear Kalman filter (LKF)) in a stochastic setting. Residual signals are defined as the output estimation error or innovation sequence for deterministic and stochastic settings respectively. Another residual generation technique is the parity-space method based on simple algebraic projections and geometry that provide an appropriate check of the consistency of system measurements[E. Chow 1984]. This method has been applied to both linear and non-linear systems[S. K. Neguang 2006] for fault diagnosis and is more sensitive to measurement and process noise relative to observer-based methods. Parameter estimation can also be used for residual generation. The goal here is to estimate physical system pa-

16

Chapter 1. Introduction

Figure 1.8: Analytical Redundancy Techniques

rameters and compare the estimates to nominal parameter values. A change in any given parameter estimate will provide information as to where a fault has occurred along with the type and severity. Parameter estimation methods such as continuous-time adaptive parity equations[T. Hofling 1997], neural parameter estimators [E. Sobhani-Tehrani 2008a], Kalman filtering, Neural Networks, and least squares[Sichun Xu 2001] have been applied for fault diagnosis. Learning-based algorithms use time-histories of the input/output data of a system to learn the system model. This learned model is then used to generate residuals. These approaches are useful when a system model is difficult to obtain. However large quantities of input/output data are usually required to train these algorithms. References [P. M. Frank 1996, R. J. Patton 1999, Angeli 2008] provide comprehensive surveys of learning-based methods, also referred to as computational intelligence-based methods, or artificial intelligence-based methods. Fuzzy logic or neuro-fuzzy systems employ a set of " if then " rules that are based on expert knowledge of the system. If this expert knowledge is not available then neural networks are employed to determine the parameters of those rules. Any one of these methods are sufficient for residual generation and have been studied extensively. The next stage in the FDI problem is residual evaluation.

1.2. Literature Review

17

With a properly constructed residual, the healthy and faulty modes of operation should be manifested in the residual such that each mode creates a unique residual signal or pattern. The residual evaluation stage involves processing the residual signal such that its patterns can be matched to particular system modes of operation. A threshold test of instantaneous values, calculating moving window averages of the residuals, or statistical methods such as generalized likelihood ratio or sequential probability ratio testing, can be used to evaluate residual signals. Threshold testing involves establishing upper and lower thresholds for the residual signals. If the residuals exceed these boundaries then a fault has been detected. Reference [H. Azarnoush 2008] does fault detection for a RW with linear and non-linear observers for residual generation and threshold testing for residual evaluation. In the work of [Jung Dae Lee 2008] a simple threshold test of brushless DC(BLDC) motor currents is used to detect faults. A fault detection and isolation algorithm is presented in [Z. Q. Li & Khorasani 2006] by applying a dynamic neural network to learn the non-linear RW dynamics and generate residuals that are evaluated by threshold testing. However threshold testing is not very robust in the face of large measurement noise and/or disturbances since they can cause peaks in the residuals that exceed the thresholds. Adaptive thresholds that adjust based on system inputs can be applied[Gustafsson 2000], however this still only provides the ability to detect and in some cases isolate faults. When residual evaluation is performed using moving window averages of the residuals, statistics of the residuals are used to estimate measurement and process noise. This methodology has been applied extensively to the KF in the form of AKFs to adapt measurement and process noise. Reference [Ahmed El-Mowafy 2005a] uses the residual window averaging technique for attitude determination with Global Navigation Satellite Systems (GNSS), and [Vahid Fathabadi 2009] uses this technique for state estimation of nonlinear industrial systems. Finally, [Christopher Hide & Smith 2003] uses residual window averaging to estimate measurement and process noise for combining a low-cost inertial measurement unit (IMU) with GPS readings for positioning and attitude information.

18

Chapter 1. Introduction Next, statistical methods are considered for residual evaluation. The generalized like-

lihood ratio test(GLRT) [Youbin Peng 1997] is a useful tool in detecting changes in a residual. This method computes a threshold based on the probability of false alarm and correct detection thus making it more robust than a fixed threshold algorithm. Moreover it can estimate an abrupt jump in residual amplitude and the time of the jump. However the proposed method does not work if the residual change is not abrupt, and there are robustness issues against modeling errors and process disturbances. In addition to the GLRT, the sequential probability ratio test (SPRT) can be used. This method assumes that samples are uniformly distributed and independent, and that the structure of their distributions are known a priori with unknown parameters. In reference [Z. H. Min 2010] the Mann-Whitney rank sum test is used so that the PDF of the samples does not need to be known a priori. However this method is not robust to modeling errors and large process disturbances. These methods use residual threshold testing, with the adaptation based on statistical properties of the system.

Spacecraft fault diagnosis techniques have been developed such as Bayesian classification for fault detection and isolation[Ji-Ye Shao 2010], wavelet and dynamic recurrent neural networks for fault detection and isolation respectively[Zhao-Hui Cen 2010], fuzzy neural networks for fault detection[Yue-hua Cheng 2010], learning-based diagnostic tree approaches for fault detection and isolation[Amitabh Barua 2009], the interactive multiple model (IMM) approach to detect and isolate faults for reconfigurable control, and adaptive observer methods. Most methods do not perform fault identification however. Reference [Sobahni-Tehrani 2008] is one of the few that can perform fault detection, isolation, and identification. The algorithm is applied to RWs. This is done utilizing a mathematical model of a system known a priori along with self-learning computational intelligence techniques resulting in a hybrid approach. The algorithm cannot identify faults concurrently however, it is assumed that only one fault occurs at a time. Furthermore, its application to different systems requires redesign of the intelligent portion of the algorithm and re-training. For satellite ACS FDI, an approach is required that could detect concurrent faults while being simple to migrate to different systems.

1.3. Problem Statement

19

1.3

Problem Statement

In the sections above an overview of current trends in the satellite industry was presented. In particular it was noted that challenges associated with enhancing the picosatellite market are primarily a result of a lack of actuator technologies that can provide adequate performance while satisfying the mass/power/volume constraints of a picosatellite. The primary reason for this void is a lack of commercial interest in picosatellite technologies because business models cannot currently be developed to provide enough benefit in a commercial setting. With no commercial interest, technologies will not mature at a fast pace. Instead it is left up to the institutions who will actually use these satellites to pursue their own research on picosatellite technologies. Most will argue that picosatellites are not reliable enough to invest in considering the limited design envelope that restricts the use of redundant or S-class hardware. There is some truth to this belief, however there is a school of thought that believes smaller satellites are more reliable because less parts are required. Until this can be proven via flawless in-orbit operation of many picosatellites over their lifetimes, the unreliability of picosatellites will have to be addressed. Without hardware redundancy, reliability could be improved using the analytical redundancy approaches mentioned in the previous section. In case faults occur, these algorithms could help detect, isolate, and identify faults so that the satellite can be properly configured to mitigate negative effects that would otherwise occur if the fault was not diagnosed in time. Thus this thesis will address two problems that could enhance the body of available picosatellite technologies, [Prob1] Picosatellite Actuator Design : The design of an actuator that could provide accurate three-axis pointing while satisfying the mass/power/volume constraints of a picosatellite. Currently the only actuator technology being tested in space is on the BeeSat satellite which houses a RW cluster. To provide another means of highperformance attitude control, more actuator technologies should be studied such as CMGs to demonstrate their feasibility. Furthermore, the design should be low-cost.

20

Chapter 1. Introduction

[Prob2]Picosatellite Actuator FDI : To improve the reliability of satellites, a simple FDI algorithm is required that can be implemented in a picosatellites' computer(s). In particular, an algorithm that can be applied to various types of actuators and can detect, isolate, and identify faults is required. Very little literature is available on the identification of faults, especially for spacecraft actuators. Picosatellite development is increasing in universities across the world. Although a RW cluster has been designed for picosatellites in the BeeSat project, no-one has proposed designs for a CMG cluster. Industry does not believe that a CMG could be made small enough to fit in a picosatellite while adhering to the cubesat standard. Furthermore, there are challenges associated with using COTS components for space hardware. COTS components usually lack qualification for the space and launch environments. Thermal, vacuum, launch vibration, and radiation testing must all be passed to show that the hardware stands a chance of operating well in space. Besides the lack of actuators for picosatellites there is also a need for FDI algorithms with an emphasis on the identification aspect. Most schemes can detect and isolate faults, however the ability to identify faults adds more complexity to the problem. In the context of FDI for satellite attitude control actuators, there is very little work available. FDI of RWs and thrusters has been addressed to a limited degree, however FDI for CMG systems has not been addressed at all. This is surprising considering the high cost and increased probability of failure in these systems. More moving parts typically results in a less reliable unit. An ability to identify a faulty unit along with the type and severity of a fault could allow reconfigurable control laws to improve control, or if the fault is too severe the actuator could simply be shut down to avoid any adverse effects to the satellite. Analytical redundancy coupled with hardware redundancy could increase the operational life-time of these units and result in more reliable systems as a whole. FDI for CMGs is a tricky concept because there are many moving parts involved, each of which must be monitored. Furthermore, stepper motors are usually implemented as gimbal motors and a well defined analytical stepper motor model that closely resembles its various operational characteristics is not easy to develop. This makes analytical redundancy-based approaches very difficult to apply. A simple approach would be to take the CMG output torque and

1.4. Research Objectives

21

compare it to the torque commanded by the ACS control law. However because CMGs usually employ redundant units and each unit will actuate about more than one axis, it is difficult to isolate a faulty unit. A practical approach to CMG FDI should be independent of the specific hardware, and use telemetry from each unit to diagnose the CMG.

1.4

Research Objectives

As per the problems mentioned in the previous section, this dissertation focuses on designing a novel picosatellite actuator technology that can provide high attitude pointing performance while satisfying the mass/power/volume constraints. The performance of the actuator is verified via analysis and numerical simulations. Furthermore, an FDI algorithm for RWs and CMGs will be studied using Kalman filters. These objectives are listed below. [Obj1] Picosatellite CMG cluster design: CMGs are known to be well suited for agile satellites that require precise attitude pointing and have been proven to provide more output torque per unit of input power than RWs. Generally they have only been used in satellites larger than 10 kg while few have been applied in nanosatellites. Studying the feasibility of a picosatellite CMG cluster design that could provide average spacecraft body-rates of 1.5 /s while weighing less than 120 g, consuming less than 1.5 W of peak power, and occupying less than 25 % of the satellite volume, could demonstrate the potential of picosatellites to do more than they are currently given credit for. A primary goal here will be to design the entire unit using COTS components so that parts are cheaper and easier to access. [Obj2] FDI for picosatellite Actuators A fault diagnosis algorithm to detect, isolate, and identify faults in CMGs and RWs in a timely manner without false alarms is the primary goal for this objective. Second is the requirement that it be simple and computationally efficient relative to what is currently available. A model-based approach using KFs for parameter estimation is considered for this task. The algorithm should be able to estimate changes in model parameters cause by intermittent, incipient, abrupt, and multiplicative faults and should be robust to measurement noise. Finally, this algorithm should be capable of estimating different faults concurrently.


22

Chapter 1. Introduction Although CMG clusters have been designed for larger satellites, the first objective

presents challenges in the design and manufacturing stages while trying to satisfy the constraints. The technologies required for this design will stretch the design envelope to its limit, thus savings in size and power consumption will be high on the list of design priorities. As for the second objective, fault identification has not been addressed for RW and CMG FDI using parameter estimation with KFs. An investigation into the capabilities of KF-based parameter estimation for this application could serve as a useful tool for subsequent online FDI algorithms.

1.5

Main Contributions

A CMG cluster design for picosatellites and an FDI algorithm to perform fault detection, isolation, and identification for RWs and CMGs represent the two central themes of this thesis. The following contributions are identified and expanded upon based on the objectives stated in section 1.4. 1. CMG Design for Picosatellites (Obj1, Chap. 3) This thesis presents a novel design of a CMG cluster that can fit into a picosatellite. Three-axis attitude pointing performance of the cluster is verified in simulations while the mass/power/volume of the cluster are shown to be reasonable for operation within a picosatellite. 2. Fault Diagnosis and Identification for CMGs (Obj2, Chap. 5) A novel FDI methodology is developed for CMG clusters. The algorithm monitors the gimbal angle rates of the CMG cluster to determine if multiplicative faults have occurred. The algorithm can correctly identify multiplicative faults in each gimbal unit of the cluster simultaneously and within a reasonable amount of time. The formulation is independent of the hardware used for the gimbal motors and can therefore be applied to any CMG unit(s). Furthermore, the algorithm is robust to singularities in the steering logic, disturbances, and measurement noise.

1.6. Thesis Outline

23

3. Novel Adaptive Kalman Filter for Parameter Estimation (Obj2, Chap. 4) To perform robust FDI, a novel adaptive kalman filter was developed. In this filter the measurement and process noise covariances are estimated using a sequential adaptive estimation(SAE) approach with residual processing, while the filter memory is controlled using an adaptive forgetting factor(AFF). The SAE provides unbiased parameter estimates, while the AFF makes sure that the filter is sensitive to changes in parameters when faults occur. The combined effect is an algorithm that can perform fault detection, isolation, and identification while being robust to measurement noise and disturbances. For linear and weakly-nonlinear systems an EKF variant is presented, while for highly non-linear problems a UKF variant is presented. This filter is shown to be quite adept for FDI of RWs and CMGs, and is also capable of performing systems identification for unknown systems.

1.6

Thesis Outline

Chapter 2 presents satellite attitude dynamics and kinematics, disturbance torques modeling, and torque requirements, for a picosatellite in LEO. Furthermore, different actuator technologies are presented. Chapter 3 discusses the dynamics of a spacecraft with CMGs along with some common cluster arrangements. CMG Sizing is carried out for picosatellites using the information in chapter 2, followed by component selection and structural design for the CMG cluster. Numerical simulations are then carried out for the particular CMG design to verify the required performance is attainable. In chapter 4 an extensive review of KFs and their applications to FDI problems is given. The proposed novel filter is then presented. Chapter 5 first presents simulation results for RW FDI with the AUKF variant of the algorithm. Various fault scenarios are presented to demonstrate the capabilities of the filter in the face of different fault-types and various measurement noise levels. CMG FDI results are then presented using the AKF variant. Finally the filter is applied to a systems identification problem for a nanosatellite RW prototype being developed at SSDC. Chapter 6 discusses conclusions and future work.

Chapter 2

Attitude Control System for RyePicoSat

The focus of this thesis will be the ACS of a cubesat. The ACS of any satellite regardless of class whether active or passive is one of the most critical subsystems for the successful completion of a mission. Passive attitude control consumes no satellite resources and usually takes advantage of the earth's gravitational and magnetic fields. Active attitude control consumes either fuel or electrical power or both to maintain a desired attitude. The choice of which method to use depends on the required pointing accuracy for the proposed mission. The deciding factors for pointing accuracy are the communications system and type of payload(s)[Alger 2006]. Assuming an antenna with a beam-width of 1


on a satellite in a

600 km LEO, a simple trigonometric calculation indicates the beam would cover a 10 km2 area on the earth. Thus in order to guarantee continuous communication with the ground station the satellite must be capable of pointing its antenna with an accuracy of better than 0.5  . In practice, the beam width of a directional antenna is usually wider than 1


. However, it is evident that a less directional antenna requires less pointing accuracy

because it can cover more surface area on the earth. The same argument can be applied to imaging and other payloads that require some degree of pointing accuracy. The ACS of picosatellites have primarily been passive. Some developers have implemented magnetic torque rods for active control, however only coarse two-axis pointing can be achieved. There have been some cubesats with active ACSs, however they were missions aimed at qualifying the actuator technologies. To date RWs and magnetic torque rods(MTRs) are the only actuators that can fit within picosatellite mass, power, and volume constraints and still provide adequate attitude control performance. These constraints vary depending on the payload and mission requirements. Typically a cubesat has less than 2 W of available power[Polaschegg 2005, L. Alminde 2003] because surface area available to mount solar panels is limited to 9x9 cm2 on each side without considering any restrictions

26

Chapter 2. Attitude Control System for RyePicoSat

that other subsystems may pose. Consequently at the most these solar panels can provide about 3 W of power when at least three sides of the cube are exposed to the sun. Solar panels are usually accompanied by lithium-ion batteries to store and supply this power when no sun light is available, usually batteries with capacities of 3500 - 4200 mAh are utilized depending on how many cells are used[Alger 2006]. Depending on the payload mass penalty, mass budgets for actuators on a picosatellite can be anywhere from 100 - 150 g, which is very restrictive considering current technologies. This section will introduce the satellite attitude dynamics and kinematics, disturbance models for a picosatellite in LEO, sizing of a CMG for picosatellites, component selection, structural design, and an attitude control law with quaternion feedback.

2.1

Coordinate Frames

In order to describe the motion of a satellite in orbit three reference frames are used (Fig. 2.1): (1) Inertial reference Frame, (2) orbital reference Frame, and (3) body reference frame.

x, x0

 (roll )

 ( yaw)
z , z0

 ( pitch)
er tic al

y, y0

Perigee

Earth


Lo

ZI

ca lV

r R

YI

XI

Figure 2.1: Coordinate Frames

Or bit

2.2. Satellite Attitude Dynamics

27

The inertial reference frame is denoted XI , YI , ZI . With the XI axis facing in the direction of the vernal equinox, YI in the orbit normal direction, and ZI in the direction of the earth's geographic north pole. In particular the Earth-Centered-Earth-Fixed(ECEF) reference frame is used which has its origin at the centre of and rotates with the earth. Next is the orbit reference frame XO , YO , ZO . The origin of this reference frame is at the spacecraft centre of mass with ZO nadir-pointing, YO facing in the orbit anti-normal direction, and XO completing the orthogonal set. Finally, the body frame has its origin at the spacecraft centre of mass and is fixed to the spacecraft body. This frame is utilized to describe the motion of the satellite with respect to other reference frames.

2.2

Satellite Attitude Dynamics

The behavior of a rigid body rotating about body-fixed axes with origin at its center of mass can be described using Euler's equations of rotational motion shown in the equation below[B. Wie & Arapostathis 1989].
B B B J s BI = - BI ×J s  BI + u + uext

(2.1)

3x1 where  B is the spacecraft angular velocity with respect to the inertial frame BI  

expressed in the body frame, u  3x1 is the control torque vector, uext  3x1 is the external disturbance vector, J s  3x3 is the spacecraft inertia matrix, and  B BI × is a skew-symmetric matrix defined by,    z B × = BI  -y 0 -z 0 x  -x   0 y  (2.2)

2.3

Satellite Attitude Kinematics

Attitude representation has traditionally been in the form of Euler angles, Direction Cosines Matrices(DCMs), or quaternions. Euler angles, also known as the roll(), pitch(), and yaw( ) angles of a spacecraft, denote the amount of rotation about each of the body axes

28

Chapter 2. Attitude Control System for RyePicoSat

with respect to the orbital reference frame. Roll describes the rotation about the x -axis, pitch is a rotation about the y-axis, and yaw is a rotation about the z-axis(Fig. 2.2).

Figure 2.2: Satellite Body Frame There are 12 possible sequences of rotations. In this thesis the 3-2-1 sequence is selected, corresponding first to a rotation about the roll(1) axis, then the pitch(2) axis, followed by a rotation about the yaw(3) axis. This rotation sequence is equivalent to the following DCM,     C321 =  ssc - cs sss + cc sc   csc + ss css - sc cc cc cs -s  (2.3)

Note that singularities occur when the pitch angle  has a value of 90  , this is a common problem with euler angles that limits their applicability to small rotations. The benefit of using Euler angles is the ability to visualize the orientation of the satellite. However in practice the quaternion is preferred because it is more computationally efficient. The unit quaternion can be expressed as follows,    q   1   cx sin (/2)   q   c sin (/2) q  2   y   = q= =  q3   cz sin (/2) q4    q4 cos (/2)        (2.4)

where  denotes the principle angle and c = [cx , cy , cz ]T denotes the principle axis associated ) ( 2 2 with Euler's Theorem c2 x + cy + cz = 1 , where ci are the direction cosines of the Euler axis. q4   and q  3x1 represent the orientation of the spacecraft body frame, B , with respect to the inertial frame, I .

2.3. Satellite Attitude Kinematics The Euler axis and Euler angle can be obtained from the DCM in Eq. (2.3) as follows, C11 + C22 + C33 - 1  = acos 2 C23 - C32 cx = 2sin () C31 - C13 cy = 2sin () C12 - C21 cz = 2sin () ( )

29

(2.5a) (2.5b) (2.5c) (2.5d)

where Cij corresponds to the element in the ith row and j th column. Using Eq. (2.4) it can be shown that the quaternion satisfies the following relation,
2 2 2 2 q1 + q2 + q3 + q4 =1

(2.6)

This constraint is important to keep in mind when propagating the quaternion, if it does not satisfy the relation in Eq. (2.6) then the information will not be accurate. The quaternion is propagated using the following differential equations, 1 1 q  =  × q + q4  (2.7a) 2 2 1 q4 = -  T q (2.7b) 2 Often times only Eq. (2.7a) needs to be computed, integrating the vector components and substituting into Eq. (2.6), q4 can be calculated. This method ensures that the obtained quaternion will be normalized to one. Note that the spacecraft angular body rates in Eqs. (2.7a) and (2.7b) are with respect to the orbital reference frame. This is a problem because rate-measurements are usually obtained by strap-down sensor systems which provide angular rates with respect to the inertial frame. the angular velocity of the body-fixed frame with respect to the inertial frame can be described as
B B B BI =  BO +  OI

(2.8)

The direction cosine matrix C B O describing the orientation of the spacecraft body frame with respect to the orbital reference frame can be defined in terms of the quaternion as, ( 2 ) T T CB O = q4 - q q I + 2 qq - 2q4 (q ×) (2.9)

30

Chapter 2. Attitude Control System for RyePicoSat

where q × is a skew-symmetric matrix given by   q× =   qz -qy 0 -qz 0 qx  -qx   0 qy  (2.10)

Orbital angular velocity expressed in the body frame with respect to the inertial frame, B OI , can be obtained by rotating the angular velocity into the orbital frame using the transformation matrix C B O as follows,    B   B OI = C O  -0  0 0  (2.11)

2.4

Disturbance Torques Modeling

A satellite in LEO is subject to various disturbance torques as it orbits the earth. The gravity gradient (GG) disturbance torque is caused because of the distance between opposite ends of a spacecraft. Gravity will pull on one end of the spacecraft more than the other depending on inertia and orientation. Generally it is constant for earth-oriented vehicles and cyclic for inertially-oriented vehicles, and is influenced primarily by spacecraft inertias and orbital altitude. If the satellite moments of inertia(MOI) are equal the GG torque is zero. For a spacecraft with small products of inertia the GG torque can be expressed as, ( ) 3µ Jsx + Jsy TGG = (z 0 - z ) (z 0 × z ) (2.12) Jsz - 3 2R e 2 where µ = 3.986 × 1014
m3 s2

is the Earth's gravitational constant, Re is the orbit radius in

metres, Jsz , Jsx , Jsy are the spacecraft MOIs about the z, x, and y axes respectively, z 0 is the nadir unit vector in body coordinates, and z is the principle body z-axis unit vector. Solar radiation pressure(SRP) is created primarily due to the difference between the center of pressure and center of gravity of a satellite. This disturbance is manifested as a cyclic disturbance for earth-oriented vehicles and a constant disturbance for solaroriented vehicles. It is primarily influenced by spacecraft geometry, surface reflectivity, and

2.4. Disturbance Torques Modeling spacecraft center of gravity (cg). The equations are shown below, Tsp = F (cps - cg ) F = Fs As (1 + q ) cos (i) c

31

(2.13a) (2.13b)

where Fs is the solar constant (1, 367 W/m2 ), c is the speed of light (3 × 108 m /s ), As is the surface area, cps is the location of the center of solar pressure, q is the reflectance factor ( 0 to 1), and i is the angle of incidence of the sun. Magnetic disturbances are caused by the influence of the earth's magnetic field on a body in orbit and is manifested as a cyclic disturbance. This disturbance is primarily influenced by orbital altitude, residual spacecraft magnetic dipole, and orbit inclination. The worst case estimate of this disturbance can be determined using the following equation([Wiley J. Larson 2005] page 366), Tm = DB B= 2M R3 (2.14a) (2.14b)

where D is the residual dipole of the vehicle with units (A · m2 ), M is the magnetic moment of the earth (7.96 × 1015 tesla · m3 ), and R is the radius from dipole (earth) center to the spacecraft (m). Equation (2.14b) is the earth's magnetic field in tesla and applies to vehicles in a polar orbit- at the equator this value is halved. Aerodynamic disturbances can also affect spacecraft in LEO due to the very thin layer of atmosphere at these altitudes. For earth-oriented vehicles this disturbance is constant while for inertially-oriented vehicles it is variable. The primary factors influencing aerodynamic disturbances are orbital altitude, spacecraft geometry, and cg location. Similar to SRP torques aerodynamic disturbances are manifested due to the difference between centers of pressure and gravity of a spacecraft. It can be expressed as[Wiley J. Larson 2005], ( ) Ta = F (cpa - cg ) = 0.5 Cd AV 2 (cpa - cg ) (2.15)

where F is the atmospheric force, Cd is the drag coefficient (usually between 2 and 2.5),  is the atmospheric density, A is the surface area, V is the spacecraft velocity, and cpa is the center of aerodynamic pressure.

32

Chapter 2. Attitude Control System for RyePicoSat It is paramount that these disturbance torques be understood in order to design an

adequate ACS that is capable of maintaining a particular attitude and/or performing maneuvers. When the worst-case disturbance torques are known one can proceed to determine the minimum amount of torque the actuator hardware must supply to reject them. This design methodology has been carried out in section 4.4 of [Alger 2006] and explained thoroughly in [Wiley J. Larson 2005] chapter 11.

2.5

Attitude Control Requirements

When orbiting the earth a satellite must usually maintain a desired attitude, and when appropriate perform attitude maneuvers. Environmental disturbances experienced in orbit such as SRP, GG, magnetic, and aerodynamic disturbances cause the satellite body to drift from the desired orientation. A control system must be designed such that sufficient torque and momentum storage is available for any foreseeable attitude maneuvers and disturbance rejection, this is referred to as control capability. To determine the requirements for an ACS the expected worst-case disturbance torques on the satellite body must be known, as well as the required torque to perform the largest possible maneuver. A safety factor should be applied to arrive at the total required torque to reject disturbances. The ACS must also have sufficient momentum storage capability. In order to perform this analysis one must know the characteristics of the satellite in question. The RyeSat cubesat project is currently under development at Ryerson University[Alger 2006]. The various structural, electrical, and mechanical characteristics of this proposed cubesat will be considered here for analysis and simulations.

2.6

Attitude Control by Quaternion Regulation

Attitude control using the quaternion attitude representation has been studied extensively in the literature. Attitude control by quaternion back-stepping has been covered in [Raymond Kristiansen 2009], while the works of [Tayebi 2008], [Jonathan Lawton 2003], and [B. Wie & Arapostathis 1989] consider quaternion-based feedback attitude control

2.7. Actuators

33

strategies. The quaternion feedback regulator developed by [B. Wie & Arapostathis 1989] is used for its ease of implementation and minimal computational requirement. This controller consists of a linear body-rate feedback term, an error-quaternion feedback term, and a non-linear body-rate feedback term that counteracts the gyroscopic coupling torque, u = - × J s  -D -Kqe (2.16)

where D and K are 3×3 diagonal, positive-definite, and constant gain matrices. The quaternion error component q e defines a rotation from the commanded quaternion(qc )to the actual satellite attitude quaternion (qs ), it can be obtained using the expression below.      q1s q4c q3c -q2c -q1c q1e       q   q   -q q q - q 3c 4c 1c 2c   2s   2e   (2.17)    =  q3e   q2c -q1c q4c -q3c   q3s       q4s q1c q2c q3c q4 c q4e The gyroscopic decoupling term in Eq. (2.16) is not needed for slow rotational maneuvers, however when fast maneuvers are performed the influence of the gyroscopic effect must be considered. When applied to satellite attitude control the body-frame will perform an eigen-axis rotation about an axis and through an angle specified by the error quaternion according to Eq. (2.17) This method was shown to be globally stable if K -1 D> 0 .

2.7

Actuators

The most common actuator technologies for cubesats are reaction wheels (RWs), thrusters, and magnetic torque rods (MTRs), while CMGs are also common but in larger satellites. A RW consists of a flywheel attached to an electric motor. At least three RWs mounted orthogonally about each of the body axes are required for full three-axis attitude control. When the satellite must perform a maneuver the RWs accelerate and impart a torque onto the spacecraft, if a spacecraft must maintain a desired attitude in the face of external disturbances the RWs must absorb any added momentum to keep the total angular momentum of the system at zero. An MTR usually consists of a wire coil with a ferrite core. When a current passes through the coil a magnetic field is created. When multiple MTRs

34

Chapter 2. Attitude Control System for RyePicoSat

are combined a magnetic dipole can be created that counteracts the earth's magnetic field and provides two-axis pointing of a spacecraft. MTRs are usually employed along with a reaction wheel for full three-axis attitude control. Finally the CMG is another momentum exchange device like the RW. A CMG unit consists of a flywheel that is gimballed about one, two, or three of its axes. Gyroscopic torques are generated as the angular momentum vector is rotated about axes perpendicular to the flywheel spin-axis. Depending on mission requirements one actuator may be more appropriate than others, in particular the required degree of pointing accuracy is a primary factor for selecting actuators. MTRs provide the lowest pointing accuracy because of the time-varying nature of the earth's magnetic field and their inability to provide control about more than two axes. They are usually used in conjunction with RWs and CMGs for momentum dumping. For a cubesat MTRs are small enough to satisfy the mass/power/volume constraints hence making them a popular choice. RWs provide substantially improved pointing accuracy and agility relative to MTRs, however power consumption and mass tend to be larger. CMGs provide more accurate and agile pointing capabilities because of their torque amplification characteristics and gyroscopic stabilization. It must be noted that pointing accuracy is a only as good as the combined ADS and ACS(ADCS) accuracy. In other words if the ADS is only accurate to 1


and ACS pointing accuracy to 0.5  , no better than 1



pointing

accuracy can be achieved and vice-versa.

2.7.1

Reaction Wheels

Fundamentally a RW is a flywheel mounted to an electric motor. Electric Motors in space are usually BLDC or stepper motors as opposed to brushed motors. These types of motors are preferred because brushes can scrape particulate matter of the electrodes and contaminate instrumentation. A motor consists of stationary stator windings, and a permanent magnet or wound rotor. The difference between brushed and BLDC motors lies in the commutation method. BLDC motors commutate using stationary position sensors located as close to the rotor magnets as possible. The position sensors are Hall effect sensors that output a logic high level when a magnetic field is passing over them and low when no field is present. Each position sensor generates a pulse-train that is 120


out of phase with

2.7. Actuators

35

the other two sensor signals. Commutation is performed by processing the three signals and knowing when to excite a particular stator winding. The rotor speed can also be ascertained by observing the position sensors signal frequencies. In contrast a brushed DC motor uses metallic or carbon conducting 'brushes' to commutate while the stator remains similar to that of the BLDC. The commutator is usually located above the stator windings so that as the motor turns the brushes slide over the commutator making contact with the different commutator segments. Each segment is attached to one winding resulting in the generation of a dynamic magnetic field inside the motor when a voltage is applied across the brushes. This field repels the rotor magnets or windings resulting in the rotation of the rotor. A major problem with brushed DC motors is the wear and tear on the brushes and commutator, in the vacuum of space the tiny particles that wear off of the brushes can disperse in all directions and contaminate on-board electronics. A RW model must consider motor disturbances, non-linearities, and BEMF torque limiting. Figure 2.3 is a high-fidelity RW model for a torque-controlled BLDC motor developed by [Bialke 1998]. Voltage-controlled motors share the same disturbances and non-linearities. BEMF voltages are generated in stator windings when the rotor rotates. A faster rotor speed will yield a larger BEMF voltage, its exact value is determined by the product of wheel speed and BEMF constant Km , with SI units rad /s and V /rad/s respectively. In so far as torque limiting, when a voltage is applied to the motor the rotor rotates. It will rotate until a speed is reached at which the BEMF voltage is close to the applied voltage such that the differential voltage across the armature is small resulting in a small current. Rotation stops when the current is so small that the motor does not generate enough torque to accelerate. For example if five volts are applied at zero wheel speed the wheel will accelerate until the BEMF voltage nears five volts. In order to decelerate the wheel a lower voltage must be applied and vice-versa to accelerate the wheel again. On the mechanical side of the dynamics the motor can be subject to disturbances such as cogging and ripple torque. Cogging torque is caused by the rotation of the magnets in the rotor with respect to the motor windings. As a magnet rotates past a winding, its motion is first opposed by flux leakage from the end of the windings until it passes over the entire winding when the motor is then accelerated by the flux leakage. With current

36

Chapter 2. Attitude Control System for RyePicoSat

Figure 2.3: Reaction Wheel Dynamics [Bialke 1998] BLDC motor technologies cogging torque is no longer a concern as most designs minimize the amount of ferrous material rotating across the windings. Equation (2.18) describes the cogging torque mathematically, Tcog = B sin (3N t) (2.18)

where B is a gain, N is the number of motor poles, and  is the rotor speed. Torque ripple occurs at the commutation frequency and is characterized as a variation in the motor torque caused by the commutation method and the shape of the BEMF waveform. For analytical purposes this disturbance is approximated as a sinusoid while in reality it is closer to a

2.7. Actuators truncated rectified sine wave. The equation for this disturbance is shown below, ) ( N t Trip = C sin 2

37

(2.19)

where C is a constant and the other parameters are the same as in Eq. (2.18). BLDC motors are also subject Coulomb and viscous friction non-linearities that are dependent on the bearing material and lubricant. Coulomb friction is caused by the rolling friction within the bearings and is characterized by a torque discontinuity when the motor is not generating enough electrical torque. The expression for Coulomb friction is, Tcoul = c sign ( ) (2.20)

where c is the coefficient of Coulomb friction with units N · m, and the sign function can be characterized as shown below. -1 x < 0 sign (x) = { 0 1 x=0 x>0 (2.21)

Viscous friction varies depending on the type of the bearing lubricant and its temperature as well as the speed of the rotor. A higher bearing lubricant temperature will create less friction in the bearing while different lubricant materials will have varying viscosities. Viscous friction can be expressed as in Eq. (2.22), Tvisc = v  where v is the coefficient of viscous friction with units
N·m N·m

(2.22) /rad/s . The motor torque block

in Fig. 2.3 consists of scaling the motor current by the torque constant (Kt , with SI units /A ) which is equal to the BEMF constant when expressed in SI units. For the remainder It is important to discuss the high degree of nonlinearity in this RW model, in particular attention must be paid to the heavyside, absolute value, and signum functions in the model. These functions all lead to discontinuities that must be approximated by appropriate analytical models. These models take the form of rational exponential functions, and become very cumbersome when linearization is required. For the numerical representation of the this model refer to Reference [Sobahni-Tehrani 2008]. of this thesis the terms 'BEMF constant' and 'torque constant' are used interchangeably.

38

Chapter 2. Attitude Control System for RyePicoSat

2.7.2

Control Moment Gyroscopes

The CMG is a momentum exchange device that functions on the principle of gyroscopic forces. This actuator consists of a spinning flywheel that generates a large and constant angular momentum in the direction of its spin-axis. The flywheel is mounted onto a gimbal motor shaft, when this motor rotates the angular momentum vector changes direction resulting in a torque. Figure 2.4 demonstrates the relationships between gimbal angle rotation and output torque.

Figure 2.4: Control Moment Gyroscope [Lappas 2002] This figure demonstrates how a torque is created when only one gimbal exists, this is termed a SGCMG. A CMG that has two gimbals is known as a DGCMG. Generally DGCMGS rotate the flywheel about the two axes perpendicular to its spin-axis. If a gimbal would rotate the flywheel about its spin axis no gyroscopic torques would be created, in essence rotations about that axis would only generate reaction torques. Variable Speed CMGs(VSCMGs) are the preferred actuator in this case, while common CMG units have constant flywheel speeds, VSCMGs control using both gimbal and reaction torques. Table 2.1 demonstrates advantages and disadvantages of the different types of CMGs. SGCMGs are more common because they are less prone to faults, and simple to build. However they are also more likely to encounter singularities. DGCMGs and VSCMGs provide extra degrees of freedom that reduce excursions in to singular states, however they are more costly to develop and not as reliable as SGCMGs.

2.7. Actuators

39

Table 2.1: Advantages and Disadvantages of Different Types of CMGs[Lappas 2002] CMG Type SGCMG DGCMG VSCMG Advantage Torque amplification Torque amplification, extra degree of control Extra degree of control Disadvantage Singularities Cost, complexity, size Reliability

Figure 2.5: 4SGCMG Pyramid System A common SGCMG system configuration is the 4SGCMG pyramid cluster, shown in the figure below. As compared to an orthogonal cluster of 3SGCMGs, the 4SGCMG configuration is preferred for three reasons; (1) improved singularity avoidance, (2) increased redundancy, (3) increased angular momentum capability. Singularities are more likely to occur in systems with fast gimbal-rates or insufficient degrees of freedom. 4SCMGs provide an extra degree of control freedom that minimizes singularity occurrence. In the case a unit fails and only 3SGCMGs remain, a more robust and optimal steering law is required to account for increased occurrence of singularities, thus 3-axis control would still be available to a limited degree. Hardware redundancy is key in this case and satellite missions in general. A device that can be easily reconfigured autonomously in the face of a fault or failure is highly desirable. In conjunction with FDI using analytical redundancy as in chapter 4, a fairly robust system can be developed. Another advantage of 4SGCMG systems shown in Fig. 2.6 is a larger angular momentum envelope than 3SGCMG systems. If gimbal angles are about to reach singular states a larger momentum envelope means that there is more

40

Chapter 2. Attitude Control System for RyePicoSat

freedom to avoid singularities, loosening the steering law requirements. Power consumption is also lower for the 4-unit configuration relative to the 4-unit system[Hablani 1994]. An angle of inclination of  = 54.73


was selected because it results in a more spher-

ical and symmetric angular momentum envelope, and has been widely used. Reference [Kurokawa 1997] provides more information on singular surfaces and angular momentum profiles for different configurations of SGCMGs.

Figure 2.6: Momentum Envelopes of 4SGCMGs Pyramid Cluster ( = 54.73o ) and and 3SGCMGs Orthogonal Cluster

2.8

Summary

In light of this discussion the SSDC group at Ryerson has decided to pursue the design of a 4SGCMG pyramid system as shown in Fig. 2.5 that fits into a picosatellite cubesat frame. As mentioned in section 1.1 CMGs are primarily used in micro and larger satellites because of lack of interest in cubesat technologies commercially. Interest is beginning to peak however, culminating in the efforts of various universities to develop picosatellite sized RWs. Logically the next step is to study the feasibility of a CMG system for picosatellites. Few researchers have attempted to develop CMGs for picosatellites due to lack of demand. Consequently the design of a picosatellite SGCMG pyramid cluster will be proposed in this thesis for more agile and accurate cubesats.

Chapter 3

CMG System Design for Picosatellites

The spacecraft mission and orbit geometry influence the pointing commands for payloads and spacecraft attitude control system significantly. Low Earth Orbit (LEO) has the lowest altitudes. The orbit period is shortest and the time during which the spacecraft is in line of sight with the ground station is brief - 15 minutes or less. This necessitates autonomous tracking and requires sophisticated pointing capabilities onboard the spacecraft. One of the most severe constraints in small satellite is the limited power, mass or capacity of attitude control actuators. To enable high-speed maneuver missions for small satellites, an attitude control system using control moment gyros (CMG) is proposed in this thesis. A CMG consists of a spinning rotor with constant angular momentum. The CMG is an attitude control actuator that works on the principle of changing the direction of the angular momentum vector with respect to the spacecraft by gimballing the spinning rotor. The spinning rotor is mounted on a gimbal and torquing the gimbal results in a precessional, gyroscopic reaction torque orthogonal to the rotor spin and gimbal axes. Thus, the output torque is directly proportional to the rate of change of momentum and is controlled through the gimbal rate. Small gimbal torque input can produce large control torque output on the spacecraft. This torque amplification property of CMGs makes them favorable for precision pointing control and momentum management of agile small spacecraft in LEO. This chapter will present how spacecraft are modeled with CMGs for actuation, followed by sizing and component selection for application in a picosatellite. Then attitude control simulations are conducted using parameters determined in the sizing section to verify the performance of the CMG cluster.

42

Chapter 3. CMG System Design for Picosatellites

3.1

Mathematical Modeling of Spacecraft with CMGs
 B = - B ×H B + u + uext H BI BI BI
B HB BI = J BI + h

Spacecraft attitude dynamics with momentum exchange actuators can be expressed as, (3.1a) (3.1b) (3.1c)

J = J s + AJ a AT

where H B BI is the total angular momentum vector of the combined spacecraft and CMG, J is the total MOI of the spacecraft including CMGs, J cmg is a n × n diagonal matrix whose entries corresponding to the nth CMG unit inertia, A is a 3 × n projection matrix whose columns represent the influence of each CMG unit on the spacecraft, and h is the total CMG angular momentum vector given by h = Ahcmg (3.2)

where hcmg  n×3 describes the angular momentum of each CMG unit. Substituting Eq. (3.1b) into Eq. (3.1a) yields
B B B J BI +  BI ×J  BI = u + uext

(3.3) (3.4)

 +  B ×h = -u h BI

The influence of the CMG on the momentum and acceleration of the spacecraft is described by Eq. (3.4). Note that the CMG angular momentum is a function of the flywheel speeds  and gimbal angles  such that h = f ( , ) (3.5)

For the 4SGCMG pyramid configuration shown in Fig. 2.5 the total CMG angular momentum vector can be expressed as, h=   h = h1 (1 )   -cs1 c1 ss1  
4  i=1

hi (i , i )    

(3.6a) 

c4 cs3 -c2         + h2 (2 )  -cs2  + h3 (3 )  -c3  + h4 (4 )  cs4         ss4 ss3 ss2 (3.6b)

3.1. Mathematical Modeling of Spacecraft with CMGs

43

where 'c' and 's' are the cos and sin functions respectively. Given the control input u, Eq.  , subsequently the rate of change for gimbal angles   can be (3.4) can be used to obtain h determined by finding the Jacobian of Eq. (3.6b) with respect to gimbal angles i using the following equation,  = h where 
4   h (i , i ) i=1

i s2

 = ho Acmg  

(3.7)

 Acmg =   -s1 sc1

-cc1

cc3 s3 sc3

-cc2 sc2

 cc4   sc4

-s4

(3.8)

describes the influences of the torques of each CMG unit on the spacecraft, and ho = h1 = h2 = h3 = h4 represents the angular momentum stored in each of the flywheels. Desired gimbal angle rates are obtained from Eq. (3.7) by finding the pseudo-inverse A cmg of Acmg . (  =  1 ho )  A cmg h (3.9) (3.10)

[ ]-1 [ T ]-1 T T T A = Acmg Acmg Acmg cmg = Acmg Acmg Acmg

This method of obtaining desired gimbal angle rates is denoted 'steering logic'. Because of inherent singularities in A for particular gimbal angle sets this method is not very practical except in cases where the gimbal angle rates are very small and gimbal angle trajectories do not move much. To resolve this, singularity avoidance steering logic has been developed. Some of these methods are summarized in [Lappas 2002]. These techniques attempt to keep gimbal angle from reaching singular states to avoid singularities and gimbal lock. Singularities occur when gimbal angles result in a determinant of zero in the matrix of Eq. (3.8). Gimbal lock occurs when gimbal angle combinations result in zero output torque. Some steering logic can avoid singularities or gimbal lock while others can avoid both.

44

Chapter 3. CMG System Design for Picosatellites

3.2

Sizing and Component Selection for CMG

Sizing for the CMG is meant to determine how fast gimbal angle and flywheel angular rates should be as well as what size of flywheel to use. Tradeoffs between mass, power, and performance specifications must be made to arrive at an appropriate design. In general it is desired to keep the flywheel speed and size to a minimum for power and mass savings. However smaller flywheels will require higher wheel speeds and consume more power, while less power is consumed in the opposite case. Gimbal angle rates are usually selected as large as possible while considering power and torque requirements for the gimbal motor. Faster gimbal rates result in more consumed power and larger torque requirement for the gimbal motor shaft and its load, the load being the flywheel and any complementary electronics. A gimbal motor must be selected such that its radial and axial load tolerances are large enough to withstand launch vibrations. Axial loads push or pull the shaft into or out of the motor in the spinning axis direction while radial loads are perpendicular and cause the shaft to displace radially. In either case excess loads can lead to bearing damage. Flywheel mass and its corresponding motor mass must be kept at a minimum in order to reduce axial and radial loads (Fig. 3.1) on the shaft. Furthermore the torque required to maneuver the gimbal depends on maximum gimbal rate, faster gimbal rates mean larger required torques.

Figure 3.1: Radial and Axial Load Directions on a Motor Shaft Criteria for sizing of a CMG for picosatellites is established by estimating worst-case disturbance torques and maximum angular rate for maneuvers. Worst case GG disturbance can be determined using the following simplified equation[Wiley J. Larson 2005], Tg = 3µ |Jmax - Jmin | sin (2 ) 3 2Re (3.11)

3.2. Sizing and Component Selection for CMG

45

where Tg is the maximum gravity torque,  is the maximum deviation of the Z-axis from local vertical in radians, Jmin and Jmax are the smallest and largest MOIs of the spacecraft respectively in kg · m2 . Worst-case disturbances can be determined using Eqs. (2.13a-2.15). The estimated worst-case disturbance torques for a satellite in a 400km LEO have been determined in [Alger 2006] for the RyeSat and are shown in the table below Disturbance Magnetic Aerodynamic Gravity Gradient Solar Pressure Total Torque (N · m) 2.5 × 10- 6 5.6 × 10- 7 5.8 × 10- 9 6.1 × 10- 9 3.06 × 10- 6

Table 3.1: Worst-case Disturbance Torques for Picosatellite in 400 km LEO The next step in the sizing procedure is to determine how much torque is required to perform maneuvers. This is determined by specifying a change of angle  over a time tdur [Wiley J. Larson 2005] with the following equation, Tman = 4J t2 dur (3.12)

where J is the MOI of the satellite about a particular axis. The above equation should be applied to the body-axis that has the largest inertia value to make sure sufficient torques are available about all three body-fixed axes. The largest inertia component on the RyeSat is 0.005 kg · m2 . Thus to perform a 90 8.727 × 10
-6 

maneuver in 60 seconds the torque required is

N · m. In order to be capable of rejecting a worst-case disturbance while

performing the above-mentioned maneuver, total required torque comes to 1.485 × 10-5 N · m. Having determined the total required torque for picosatellite attitude control it is now time to determine the required momentum storage. For RWs and CMGs momentum storage is dependent on flywheel MOI and speed. To know how much momentum storage is needed to start an attitude maneuver, the total ) ( B spacecraft MOI (J ) and maneuver angle rate BI (avg ) must be known, then the following

46

Chapter 3. CMG System Design for Picosatellites

equation can be used[Wiley J. Larson 2005].
B Hstart = JBI (avg ) B The maneuver considered above has BI (avg ) = 0.0262 rad

(3.13) /s while J = 0.005 kg · m2 re-

sulting in a maximum starting angular impulse of 0.000131 N · m · s. To stop the maneuver an angular impulse equal to but opposite in sign must be applied to the spacecraft. Over one orbital period, the required amount of momentum storage to reject disturbances is[Alger 2006], dist P  (3.14) 4 2 N · m as determined above and P = 5553 s is the orbital period Hdist =

where dist = 3.06 × 10-6

resulting in 0.003 N · m · s of required momentum storage to handle disturbances. In total the ACS should be capable of storing 0.00313 N · m · s for sufficient momentum storage over one orbit. The results of the ACS requirements analysis for the RyeSat picosatellite are summarized in Table 3.2. Torque [N · m] Disturbance Rejection Attitude Maneuver Total 2 × 3.06 × 10-6 8.727 × 10-6 1.485 × 10-5 Angular Momentum[N · m · s] 0.003 0.000131 0.00313

Table 3.2: RyeSat ACS requirements Having understood the ACS requirements for a picosatellite, the next step is to size the CMG. Sizing consists of determining the flywheel size and angular velocity as well as maximum and average gimbal rates. We start by expressing the total CMG output torque,  T CM G = h×  (3.15)

where T CM G is determined from the torque requirements mentioned above(Table 3.2). Angular momentum and gimbal-rate vectors must be determined based on mission requirements, the selection process can be facilitated by observing the torque amplification properties of the CMG. Torque amplification for CMGs can be expressed as the ratio,  To-i  = B Ti-i BI (avg) (3.16)

3.2. Sizing and Component Selection for CMG

47

B where BI (avg ) is the average spacecraft angular rate, To-i is the CMG output torque and

Ti-i is the input torque. These values are related as shown in Fig. 3.2.

Figure 3.2: Input/Output CMG Torque Vectors  , in other words when According to Eq. (3.16) torque amplification is large when s   spacecraft angular rates are much smaller than gimbal angle rates. A maneuver of 90 60 s for the RyeSAT would result in an average body-rate of 1.5  /s or 0.0262 or 0.174
rad rad 

in

/s . In

order to achieve a torque amplification of at least 5, average gimbal angle rates of 10  /s /s will be considered. A singularity-avoidance steering law would be necessary


considering that during a 30 s maneuver a gimbal angle would reach 300

at maximum

angular speed. An x-axis maneuver will be considered using units 1 and 3 as labeled in Fig. 2.5. The total output torque about the x-axis is the sum of torques from units 1 and 3[Lappas 2002]. 1 cc1 T1x = ho  3 cc3 T3x = ho   Tx = T1x + T3x = 2ho cc

(3.17a) (3.17b) (3.17c)

 =  1 =  3 due to symmetric rotation for the maneuver, and where  = 1 = 3 and  max = 0.174 rad /s ho = Jw w is the flywheel momentum. For Tx = 1.485 × 10-5 N · m,  and  = 0


the required angular momentum can be determined to be ho = 7.388 × 10-5

N · m · s using Eq. (3.17c). Before the flywheel can be sized a candidate BLDC flywheel motor is selected as the Faulhaber 1202 penny-motor, this was done in order to have a

48

Chapter 3. CMG System Design for Picosatellites

better idea of the maximum wheel speed which is required for the sizing process. BLDC motors are ideal for space applications because brushes are not required to commutate the motor. Brushes cause the release of small particles that could contaminate satellite instrumentation. Faulhabers have space heritage and are one of the leaders in supplying COTS motors for spacecraft actuators. There were no other motors close to offering the performance of this motor in such a small package. Some of its specifications are shown in the table below. Parameter Nominal Voltage No-load Speed No-load Current Max. Output Power(40000 rpm) Shaft Radial Load max.(10000 rpm) Shaft Axial Load max.(10000 rpm) Mass Value 4V 41740 rpm (3935 rad/s) 0.028 A 0.652 W 0.6 N 1.0 N 1.1 g

Table 3.3: Faulhaber 1202 Penny Motor Specifications Some key aspects of this motor are its low power consumption and high dynamic range for shaft speeds(up to  4000
rad

/s ). The shaft diameter of this motor is only 1 mm, this

must be taken into account when designing the flywheel. If the load on this shaft is too large, then vibration loads during launch can exceed the specified axial and radial load tolerances resulting in either partial or complete failure of the bearing. This design will try to keep the flywheel mass and volume as low as possible while satisfying performance requirements, in general larger nominal speeds can allow for smaller flywheels for a given value of momentum as per the angular momentum equation h = Jw w . A flywheel speed of 2000
rad

/s is easily within the limits of this motor while consuming very low power in

steady-state operation, this will allow the design of a very small flywheel in addition to the motor's mere 1.1 g mass and 1.1 cm diameter. Considering the required angular momentum per CMG unit ho , the required flywheel inertia can be determined by the following, ho 7.388 × 10-5 Jw = = = 36.94 × 10-9 kgm2 (3.18) w 2000

3.2. Sizing and Component Selection for CMG

49

This is a very small inertia requirement, which should result in a very small flywheel mass and volume. Using the MOI equation for a thin disk about its spin axis and assuming a flywheel radius of rw = 6.5 mm the required mass of the flywheel can be determined as, md = 2Jw 73.88 × 10-9 = = 1.75 × 10-3 kg r2 42.25 × 10-6 (3.19)

According to the design the momentum wheel portion of a single SGCMG unit will only weigh 2.85 g not-including other structural parts. This is a substantial savings in mass compared to the required flywheel size for a reaction wheel. If the mass of the motor/flywheel assembly is assumed to be 3 g and 23grms[D. Sinclair 2010] of vibrations are assumed, then maximum resulting axial/radial torque is approximately 0.4 N which will be considered for the gimbal motor selection. Now the height of the flywheel hd can be determined to complete the flywheel design. Steel, with a density of s = 7800 found using the density and mass of the flywheel. Vd = md 1.75 × 10-3 = = 2.24 × 10-7 m3 s 7800 (3.20)
kg

/m3 , will be used as the

flywheel material due to its thermal properties and durability. The disk volume can be

Next the height is determined by utilizing the volume equation for a thin disk, hd = Vd 2.24 × 10-7 = = 1.688 × 10-3 m 2 rd 132.67 × 10-6 (3.21)

To make the design practical in terms of manufacturing, the height hd will be 1.7094 mm, comparable to 15-gauge steel, this results in negligible change in volume, mass and overall performance. Table 3.4 summarizes the flywheel design. Parameter Mass Radius Height Inertia Angular Momentum at 2000
rad

Value 1.75 g 6.5 mm 1.7094 mm 36.94 × 10-9 kg · m2 /s 7.388 × 10-5
kg·m2

/s

Table 3.4: Steel Flywheel Design Parameters

50

Chapter 3. CMG System Design for Picosatellites

Next a gimbal motor must be selected. Stepper motors are the most common motor choice for gimbals since they perform the function really well and have large holding torques compared to BLDC motors of the same size. Holding torque is an important characteristic because it determines how well the gimbal motor will hold its position. Selection of particular gimbal motors is based upon maximum gimbal angle rates, radial and axial maximum load ratings, and size. The Portescap P010 and Faulhaber ADM0620 stepper motors were considered for this design. Lappas utilized the P010 in his CMG design for nanosatellites, thus its specifications are more than sufficient for this application. However the ADM0620 was selected because it consumes less power and is smaller, also its performance specifications are on par with the requirements. A comparison of the motors is shown below. Parameter P010 (1.5/3 V) Nominal Current per Phase Holding Torque(nominal current) Max. Output Power Shaft Radial Load max. Shaft Axial Load max. Mass 0.43/0.15 A 1.85 mN · m 0.645/0.45 W  2.5 N  2.5 N 9g ADM0620 (3/6 V) .075/.04 A 0.2 mN · m 0.225/0.24 W  0.3 N  0.5 N 1.4 g ADM0620 w/ Gearhead _ 25 mN · m 5N 3N 4.8 g

Table 3.5: Gimbal Motor Comparisons The 6 V ADM0620 stepper motor will be used with a 06/1 planetary gearhead for the design thanks to low power consumption and mass, and high holding torque and radial and axial loads. Note that the gearhead increases the radial and axial load tolerances of the shaft and bearing such that the estimated load of 0.4 N is within the motor limitations. Even with the gearhead this motor only weighs 4.8 g, thus making the ADM0620 a more attractive option. Considering the flywheel, flywheel motor, and gimbal motor with gearhead their combined weight is only 7.6 g, for an entire 4SGCMG system this weight is only 30.4 g leaving 70 g for the structural and electrical components. Power consumption of the motors can be determined using the data in Tables 3.3 and 3.5. Penny motors operate at 28 mA and 4 V nominally resulting in 0.112 W. With a load this number should increase, however the

3.2. Sizing and Component Selection for CMG

51

load (flywheel) is extremely small and should not cause much of a change, a conservative estimate will be 0.2 W maximum power draw. Gimbal motor power consumption is 0.225 W with both phases on, in other words depending on the stepping algorithm this number could be halved. In total the worst-case power consumption per unit is 0.425 W, four units would consume 1.7 W peak. In practice the 1202 will be operated at about half the no-load rated speed of 40000 rpm. Thus assuming a linear relation between power and rotor speed, power consumption should be approximately half, or 0.1 W, for the flywheel motor. If a stepping algorithm is used that excites only one phase per step the gimbal motor power consumption will be approximately 0.112 W. Consequently the estimated maximum power numbers could be approximately 0.25
W

/unit for 1 W of power consumption for the total

4SGCMG cluster not-including other electronic components. Consequently the peak and average power constraints are satisfied. Next, simulations are set up to test the performance of the proposed system based on the sizing performed in this section.

52

Chapter 3. CMG System Design for Picosatellites

3.3

Proposed CMG System Performance Simulations

In order to verify the performance of the proposed CMG system, simulations were carried out in Matlab/Simulink. The model was setup as shown in Fig. 3.3.

Figure 3.3: CMG Simulation Control Logic The shaded area in the figure represents blocks that are implemented in continuoustime(CT) while unshaded blocks are in discrete-time(DT). Satellite and CMG dynamics are in CT, and the control law and steering logic blocks are in DT because they are usually implemented in a microprocessor. Gimbal angle dynamics consist of an electric motor model with wheel speed controller, this is meant to simulate transients in the the gimbal motor for given commands. The CMG dynamics are calculated using Eqs. (3.4-3.6b), while the satellite attitude dynamics and kinematics are simulated using Eqs. (2.1-2.7b). External torques are included into attitude dynamics in the form of gravity-gradient, aerodynamic, and SRP disturbances in Eqs. (2.12-2.15). A zero-order-hold(ZOH) with sampling frequency (Fs ) of 100 Hz is used to discretize the satellite states. Next the required change in CMG angular momentum is obtained using Eq. (3.4), and desired gimbal angle rates are obtained with some form of steering logic. These rates are then applied to the CMG gimbal model, whose output is used to calculate CMG output torque and momentum which are then passed to the satellite attitude dynamics. Simulations were conducted for 90 [Bong Wie 2001]. Desired gimbal angle rates can be computed as follows,  =  (1 )  /ho A h (3.22a)


rest-to-rest roll, pitch, and yaw maneuvers using the singularity robust steering logic in

3.3. Proposed CMG System Performance Simulations [ ] A = AT AAT + E   1 3 2    E=  3 1 1  > 0 2 1 1 i = 0 sin (t + i )

53 (3.22b)

(3.23)

(3.24)

where  is a scalar between 0 and 1. The i in Eq. (3.23) are modulating functions with amplitude 0 , modulating frequency  , and phase of i . The steering logic parameters are shown in the table below[Bong Wie 2001]. Parameter 0  [1 , 2 , 3 ]  Value 0.01 0.5
rad

/s

[0, /2 ,  ] rad [ ( )] 0.01 exp -10det AAT

Table 3.6: SR Steering Logic Parameters The following table lists other common simulation parameters used for all three simulations, Parameter Jx Jy Jz Jw w [ Re 10 20 30 40  Fs ] [ Value 0.0017 kg · m2 0.001 kg · m2 0.005 kg · m2 36.94 × 10-9 kg · m2 2000
rad

/s ]

400 km 0 0  0 0 54.73


100 Hz

Table 3.7: CMG Picosatellite Simulation Parameters Each simulation is run for 100 s, results are shown in Figs. 3.4-3.6.

54

Chapter 3. CMG System Design for Picosatellites
Gimbal Angle Rates
20 1 2 3 50 4

Gimbal Angles

deg/s

0 -20 0 20 40 60 80 100

deg

0 -50 0 20 40 60 80 100

x 10 4 2 0 0

-5

time [s] CMG Torque
10 x(roll) y(pitch) z(yaw) 5 0 -5

time [s] -5 x 10 CMG Angular Momentum

20

40

60

80

100

Nms

Nm

0

20

40

60

80

100

time [s] Euler Angle Errors
2 0 1.5 1 0.5 0

time [s] Measure of Singularity

deg

-2 -4 -6 0 20 40 60 80 100

0

20

40

60

80

100

time [s]

time [s]

Figure 3.4: CMG Attitude Control for 90
Gimbal Angle Rates
10 1 2 3 4



Roll Maneuver

Gimbal Angles
40 20

deg/s

0 -10 0 20 40 60 80 100

deg

0 -20 -40 0 20 40 60 80 100

20

x 10

-6

time [s] CMG Torque
6 x(roll) y(pitch) z(yaw) 4

time [s] -5 x 10 CMG Angular Momentum

Nm

10

Nms

2 0

0 0 20 40 60 80 100

-2

0

20

40

60

80

100

time [s] Euler Angle Errors
2 0 1.1

time [s] Measure of Singularity

deg

-2 -4 -6 0 20 40 60 80 100

1.05

1

0

20

40

60

80

100

time [s]

time [s]

Figure 3.5: CMG Attitude Control for 90



Pitch Maneuver

3.3. Proposed CMG System Performance Simulations

55

Gimbal Angle Rates
30 20 10 0

deg/s

1 2 3 4

Gimbal Angles
100

deg
0 20 40 60 80 100

50

0 0 20 40 60 80 100

10

x 10

-5

time [s] CMG Torque
3 x(roll) y(pitch) z(yaw) 2

time [s] -4 x 10 CMG Angular Momentum

Nm

5

Nms

1 0

0 0 20 40 60 80 100

-1

0

20

40

60

80

100

time [s] Euler Angle Errors
2 0 1.5 -2 -4 -6 1

time [s] Measure of Singularity

deg

0

20

40

60

80

100

0.5

0

20

40

60

80

100

time [s]

time [s]

Figure 3.6: CMG Attitude Control for 90



Yaw Maneuver

Note that the roll and pitch plots are similar except that units 1 and 3 are used for to control the roll while units 2 and 4 are used to control pitch. Furthermore, a larger control effort is required to maneuver about the x-axis since J x is larger than J y , if J x = J y then the same control effort would be required. When a yaw-axis maneuver is performed the gimbal angle trajectories are far different than in the previous two cases. Torque output and angular momentum are larger because each unit has a component about the z-axis which is aligned with the spacecraft z-axis, thus they all contribute control effort. Generally the cluster should be placed in a picosatellite such that the axis about which most control effort is needed corresponds to the z-axis of the cluster. In all cases as the gimbal angle sets approach singular states the steering logic is able to avoid singularities and gimbal lock while performing 90


maneuvers within 60  . Thus the proposed system performs well.

56

Chapter 3. CMG System Design for Picosatellites

3.4

4SGCMG Pyramid Cluster Structural Design

The CMG structure was designed to be compact, lightweight, and strong. It was also designed to provide support to the gimbal motor bearing. The proposed structure is shown below,

Figure 3.7: 4SGCMG Pyramid Structural Design Support for the gimbal motor is provided in the form of the top-plate shown in the figure which is mounted to the bottom plate via standoffs for extra support. Having a second bearing attached to a top plate will alleviate some of the load on the motor bearing. All the structural components are made of aluminum 6061 which is lightweight and strong. The dimensions are well within the design constraints mentioned in section 1.4. It occupies less than 25 % of the volume and the total mass of the unit is approximately 67 g not including the electronics and wiring.

Chapter 4

FDI Using Kalman Filters

The Kalman Filter(KF) is a model-based observer that yields estimates based on the stochastic properties of a system. This is a crucial aspect of the KF that makes it robust to measurement noise and process noise, and practical to implement. In the literature fault diagnosis and identification(FDI) using KFs has been studied extensively for these reasons as alluded to in section 1.5. Three of the common KF variants applied to the FDI problem are the EKF, AKF, UKF, and adaptive unscented Kalman filter (AUKF). When applied to the FDI problem the KF always performs residual generation by way of the innovation sequence[A.M. Benkouider 2008][F. N. Pirmoradi 2009b]. Residual evaluation can then be performed by a neural network[Liu 1999], a fuzzy neural network[Yang 2005], a multiple model KF[R. Mehra 1995], or estimation of the statistical properties of measurement and estimation error residuals for online tuning of the filter. The fourth case constitutes the AKF methodology. In all cases the state-distribution is represented as a Guassian random variable. However, whereas the EKF uses linearization to estimate the true mean and covariance of the random variable, the UKF uses sigma points or particles. These sigma points when propagated through a non-linear system capture the posterior mean and covariance accurate to the third order while the standard EKF is only accurate to the first order [N. Tudoroiu 2006]. Consequently the UKF is a more attractive option for highly non-linear systems but yields no advantage for weakly non-linear systems. Either algorithm can be used with an adaptive scheme, whether the EKF or UKF structures are used the adaptive mechanism remains the same. In this thesis the term AKF refers to the adaptive EKF. These filters can be used for either state estimation, parameter estimation, or joint state and parameter estimation. State estimation is the most straight forward approach to Kalman filtering that makes use of the standard KF equations without modifications. The goal is to estimate the system states according to the mathematical

58

Chapter 4. FDI Using Kalman Filters

model of the system. Here the FDI approach can be as simple as comparing the measured system states to the predicted model states, if the residual errors exceed a threshold a fault has been detected. However isolation and identification are not as straight forward and usually require clever choice of residuals and/or post-processing. Parameter estimation is a form of systems identification because it involves estimating the physical parameters of a system. Modifications must be made to the KF equations to accommodate the parameters as the state-vector. When the parameters of a system can be estimated the fault isolation and identification problems are directly resolved because the change in parameter(s) identifies where the fault(s) occurred and the severity. In other words the parameter estimation problem is better suited for fault detection, isolation, and identification than state-estimation. This section will introduce standard EKF and UKF theory for both state and parameter estimation and reasons why they alone are not well-suited to the FDI problem. Then the AKF will be introduced along with the various forms of adaptation that can be applied and their associated pros and cons. Finally the proposed algorithm will be presented.

4.1

Extended Kalman Filter

Given the following non-linear system, x  = f (x, u, xp , w) y = g (x, u, xp , w) (4.1a) (4.1b)

where f  Rn×1 is a non-linear function that describes the system behavior in terms of the states x  Rn×1 , the inputs u  Rm×1 , and the process parameters xp  Rp×1 , function g  Rt×1 is most often a linear function that maps the states, inputs, and parameters to the outputs, and w  Rr×1 is a random Gaussian white-noise vector representing process noise
2 . For implementation in the EKF the system above must with covariance E w, w = q

be linearized and discretized. Linearization can be accomplished by finding the Jacobians

4.1. Extended Kalman Filter of f and g as shown in the equations below, A= B= f (x, u, xp , w) x

59

(4.2a) (4.2b) (4.2c) (4.2d) (4.2e)

f (x, u, xp , w) u f (x, u, xp , w) L= w g (x, u, xp , w) C= x g (x, u, xp , w) D= u

where A  Rn×n is the state transition matrix, B  Rn×m is the control input matrix, C  Rt×n maps the states to the outputs, D  Rt×m relates the inputs to the outputs and is usually a matrix of zeros, and L  Rn×r is the disturbance response matrix. Using the above matrices Eqs. (4.1) can be expressed in linearized form, x  = Ax + B u + Lw y = C x + Du (4.3a) (4.3b)

Next the above system must be discretized at a particular sampling period ts . Discretization amounts to an approximation of the continuous-time dynamics. Smaller sampling periods will usually result in a more accurate DT model. A DT model of a CT differential equation is referred to as a difference equation, because the update is performed using Euler's forward or backward differentiation methods. The choice of method depends on the application. Euler's forward differentiation is commonly used in simulators while the backward differentiation is typically applied to simple signal filters and controllers. Discretization can also be accomplished using a Taylor Series approximation of the CT system, however it is important to note these methods require linearized equations for proper implementation. The discretization can be performed as follows[Rogers 2007], k = eAts  ts k = eA d B
0

(4.4a) (4.4b)

60  k =
0

Chapter 4. FDI Using Kalman Filters
ts

eA d L

(4.4c) (4.4d)

Ck = C with the resulting discretized system shown below, xk+1 = k xk + k uk + k wk y k = Ck x k

(4.5a) (4.5b)

where k  Rn×n is the state-transition matrix, k  Rn×m is the discrete control input matrix, k  Rn×r is the discrete disturbance dynamics matrix and C k is the discrete output matrix. The subscripts 'k ' and 'k + 1' denote the current and next time-steps respectively. Euler's method is at the heart of these derivations, and can be used to discretize the nonlinear system of Eq. (4.1) in a more basic fashion. xk+1 = xk + Ts f (xk , uk , xpk , w) This expression is used in this thesis to discretize non-linear systems. Central to the KF formulation is the measurement model shown below, z k = h (xk , uk , xpk ) + v k (4.7) (4.6)

The model consists of a function 'h' that maps the system states, inputs, and parameters to the measurements. The vector 'v k ' is a zero-mean white-Gaussian measurement noise
2 vector with covariance E v k , v k  = R . Later it will be shown that this covariance matrix

is an important determinant of stability for the KF along with the process noise covariance matrix. Measurement and process noises are assumed to be uncorrelated in most KF formulations such that E v k , wk  = 0. Eq. (4.7) can also be considered as an output equation for the KF as in the UKF algorithm presented in the next section. The measurement model can be derived using CT system dynamics without requiring discretization for implementation. This is because one is describing the relation between discrete measurements and CT dynamics directly without any differential expressions. However linearization must be performed in the case of nonlinear measurement models as required by the EKF formulation, accomplished by finding the Jacobian of h in Eq. (4.7) with respect to the state-vector, Hk = h (xk , uk , xpk )  xk (4.8)

4.1. Extended Kalman Filter

61

where Hk  Rt×n represents the sensitivity of the measurements to the system states. Now the linearized measurement model can be expressed as z k = Hk xk + v k (4.9)

Process and measurement noise matrices are defined as Q  Rn×n in continuous-time and Rk  Rt×t in discrete-time respectively. Process noise, the spectral density of the noisevector w can be expressed in DT using the following expression.  Qk =
tk tk+1

 (tk -  ) L ( ) Q ( ) L ( )T  (tk -  )T d

(4.10)

In many cases the exact form of these matrices is unknown. Typically they are approximated as diagonal matrices with the all non-zero entries equal. An explanation of how these matrices affect filtering performance is merited. Essentially they introduce uncertainty into the filter. Process noise indicates that the system model is not very accurate. Intuitively this can be considered as a system with internal process disturbances that are not well understood and cannot be accurately modeled. Introducing more modeling error into the KF via process noise tells the filter to generate estimates by considering the measurements more heavily. Larger entries result in decreased estimate sensitivity to model outputs and increased filter sensitivity to measurements, where-as smaller entries have the opposite effect. The measurement noise matrix Rk is used to include measurement noise information to the KF. Injecting more measurement noise into the KF tells the filter that estimates are to be generated by considering the system dynamics more heavily. Larger entries will cause the filter to consider the measurement information less than the model outputs, with the opposite occurring with smaller entries. Together these matrices can be used to define the bandwidth of the filter. Reference [Paul Zarchan 2000] uses the continuous-time KF properties to arrive at a transfer function whose natural frequency is equal to the ratio Qk /Rk . What this indicates is that if modeling uncertainty is present more than measurement uncertainty the filter will have a larger bandwidth. In this case the filter will track quickly albeit with more noise in the estimates. A lower bandwidth is characteristic of systems with low modeling error and causes the filter to track slower with less noise in the estimates. If there is no process noise then filter bandwidth is 0 Hz and tracking will not

62

Chapter 4. FDI Using Kalman Filters

occur, however if process noise is too large instability can ensue. Selection of these matrices is crucial to the stable operation of the filter. Another critical component of the KF is the estimation error covariance matrix P k , E xek , xek  = P k ^ k - xk xek = x (4.11a) (4.11b)

^ k is the state-estimate and xk is the true state. In addition to measurement and where x process noise matrices this matrix must also be initialized prudently. Initialization should reflect the true value of the expected estimation error and is usually completed assuming a diagonal matrix. Larger entries will tell the filter that large estimation errors exist resulting in a larger bandwidth and noisier estimates. On the other hand if the entries are small, the filter bandwidth will be smaller resulting in slower tracking with smooth estimates. Thus the selection of P k , Qk and Rk matrices affects the filter bandwidth and performance. They must be tuned appropriately for fastest, most accurate, and stable convergence possible while remaining stable. The KF formulation is now presented, 1) Prediction ^- ^- x k+1 = k+1 x k + k+1 uk
- T P- k+1 = k+1 P k k+1 + Qk+1

(4.12a) (4.12b)

2) Gain Calculation )-1 ( - T T K k+1 = P - k+1 Hk+1 Hk+1 P k+1 Hk+1 + Rk+1 3) Update ) ( ^- ^- ^- ^+ ^- xk x k+1 = x k+1 + K k+1 (r k+1 ) = x k+1 + ^ k+1 = x k+1 + K k+1 z k+1 - Hk+1 x
- P+ k+1 = (I - K k+1 Hk+1 ) P k+1

(4.12c)

(4.12d) (4.12e)

where the superscripts '-' and '+' denote the pre-update and post-update data respectively, and ^ xk denotes the innovation sequence. The KF formulation consists of three stages;

4.1. Extended Kalman Filter

63

Figure 4.1: EKF Signal Flow

(1) prediction, (2) gain calculation, (3) update. The signal flow of the algorithm is demonstrated in the block diagram below. First the prediction stage consists of the dynamic model of the system to predict the next system state(s) and error covariances. Next the Kalman gain is calculated based on the predicted estimation error covariance and measurement noise. Finally, based on the residual vector r k+1 and Kalman gain, predicted estimates and error covariances are corrected in the update stage. Sometimes it is better to use the output equation to compute the residual and the Hk+1 matrix only for the gain calculation and error covariance update. This will result in a better residual vector structure because the Hk+1 matrix is linearized and hence less accurate for this purpose. Since the residual vector demonstrates differences between the ideal system model and measurements it can be used to detect faults using threshold techniques. By observing Eq. (4.12c), the effects of the process and measurement noise matrices explained above can be better understood. Larger entries in the measurement noise matrix and/or smaller entries in the process noise matrix cause the gains to be small such that the states and error covariance are updated in smaller increments. Smaller increments result in slower convergence (low bandwidth) of the filter while larger increments (i.e. larger gains) will cause faster changes in the estimates and error covariances thus leading to faster convergence (high bandwidth). Many authors have employed the EKF primarily for fault detection, some of which are briefly explained.In reference [L. An 2004] the EKF is used for state-estimation of a hydraulic positioning system to detect and identify leakage faults. Estimated states are

64

Chapter 4. FDI Using Kalman Filters

compared to measured states to generate a residual vector. According to the residual error different patterns of change are observed to identify different faults using a look-up table for residual evaluation. While for the application this method is sufficient, highly complex systems where ambiguities exist between residual patterns and fault types would require more complex residual post-processing or pattern recognition techniques to perform identification and isolation. The work of [Chetouani 2008] also uses the EKF for state estimation of stochastic non-linear dynamic systems. Residual generation is computed as the difference between measured and estimated states of the system, if the residual exceeds a threshold then a fault has been detected. Then the residuals are processed in a bank of kalman filters where each filter corresponds to a single fault in order to isolate and identify the fault. Draw backs of this method are that a large number of filters are required to identify a large number of faults in addition to the filter representing the normal mode of operation, and for highly non-linear systems the method can be prone to false alarms because of the linearization process. Furthermore the algorithm does not perform full identification because it does not identify the size of a fault only the type. FDI using state-estimation with the EKF for spacecraft attitude determination is considered in [F. N. Pirmoradi 2009a]. At first the spacecraft attitude angles and rates are estimated in an EKF for residual generation. Statistical tests are then performed on the residuals in order to determine if a fault has occurred. These residuals then go to a second bank of filters that is used to isolate the source of the faults. The final stage of the algorithm involves another bank of filters to form fault signatures from which different hypotheses were formulated. This constitutes the identification portion of the algorithm. This method, like the previous two, can perform residual generation and fault detection fairly easily. However it is evident that substantial post-processing of the residuals is necessary in order to perform the isolation and identification phases. In all three examples provided here, the linearization of nonlinear system dynamics can lead to false alarms. Fault detection is easily performed thanks to the structure of the KF equations, however the isolation and/or identification phases require further residual post-processing. Ultimately this algorithm is unable to fully identify the type and size of faults without sufficient residual post-processing. Even then there are other issues with the standard EKF. It is widely known that a critical flaw of the EKF

4.2. Unscented Kalman Filter

65

formulation for FDI is its inability to guarantee unbiased estimates[Chuei-Tin Chang 1995] due to incorrect information about the system measurements or states. In other words the linearization of the system dynamics and measurement model can lead to biased estimates and even divergence resulting in false alarms. This fact has limited its use in practice, however the UKF can resolve some of these issues.

4.2

Unscented Kalman Filter

In response to linearization issues affecting the EKF the UKF was developed. In 1994 a "New Filter" was designed at the Robotics Research Group(RRG) in Oxford UK, it was named the UKF after a democratic vote by its members. In 1997 the first paper was published describing the UKF as a new extension of the KF to nonlinear systems. The UKF is a variant of the KF that can estimate the mean and covariance of a random variable true to the third order while the EKF only approximates them to the first order. Consequently higher order dynamics are not neglected. This filter builds on the principle that "it is easier to approximate a probability distribution than it is to approximate an arbitrary nonlinear function." In other words linear approximations are not used to approximate non-linear functions, instead the statistical moment of the state is approximated. In particular the UKF is a form of particle filter applied to a random variable with Gaussian distribution. Generally particle filters can be applied to systems with sampling densities that are nonGuassian[M. Simandl 2007]. The posterior distribution of the state is approximated using a large number of "well chosen" particles or sigma points that change randomly in time according to the model dynamics and system measurements[Crisan 2002]. Consequently the UKF resembles a Monte Carlo simulation except with points chosen deterministically. Figure 4.3 presents a visual interpretation of the unscented transform and linearized transform. When a random variable x is propagated through the non-linear function f , ¯ and the random variable y is obtained. The goal is to accurately estimate the mean y covariance P yy of y . Because EKF linearization is accurate to the first order the statistical properties of the output vector can not be captured accurately. The unscented transform generates a cloud of sigma points whose covariance and mean are close to the real values.

66

Chapter 4. FDI Using Kalman Filters

Figure 4.2: Unscented Transformation VS Linearization Three steps are involved in the unscented transformation process. First, given the n-state ¯ along with a set of random variable x a set of 2n sigma points are generated around x ¯ ). Next the 2n points are propagated through the non-linear output 2n +1 weights(one for x ¯ and covariance P yy of y are calculated based on function g to obtain y . Finally the mean y the distribution of these "particles" and their weights. The UKF formulation is presented in the algorithm below[Rogers 2007]. 1) Compute weights W0 = Wi =  n+ (4.13a) (4.13b)

1 2 (n + )

2) Establish symmetric sigma points about the state estimate ^0 = x ^-  k + (n + ) P - i ,  - ^i = x ^ k - (n + ) P -  i ^i =  ^- x k  i = 1, 2, ..., n i = n + 1, ..., 2n (4.14a) (4.14b) (4.14c)

4.2. Unscented Kalman Filter 3) Instantiate sigma points through process model ~ i = f ( ^ i)  4) Predict mean and covariance of states ¯= x
2n  i=0 2n  i=0

67

(4.15)

~i Wi 

(4.16a)

P xx =

~i - x ¯ ] [ ~i - x ¯ ]T + Q Wi [

(4.16b)

5) Instantiate sigma points through measurement model ~ i) Y i = h ( 6) Predict mean and covariance of measurements ¯= y
2n  i=0 2n  i=0

(4.17)

Wi Y i

(4.18a)

P yy =

¯ ] [Y i - y ¯ ]T + R Wi [Y i - y

(4.18b)

7) Predict cross covariance P xy =
2n  i=0

~i - x ¯ ] [Y i - y ¯ ]T Wi [

(4.19)

8) Gain calculation and updates
1 K = P xy P - yy

(4.20a) (4.20b) (4.20c)

^ =x ¯ + K (y - y ¯) x P + = P xx - KP yy K T

68

Chapter 4. FDI Using Kalman Filters

The scalar parameter  provides an extra degree of freedom for fine tuning the higher order moments of the approximation and can be used to reduce prediction errors. If x is assumed to be Gaussian then  should be selected such that n +  = 3, for different distributions  another value may be more appropriate. In Eqs. (4.14b) and (4.14c) the (n + ) P - i terms represent the scaled ith rows/columns of the square root-factor of P - . Factoring can be accomplished using methods such as Cholesky factorization[J. Chandrasekar 2008] and singular value decomposition(SVD)[M. Yamakita 2004] thus making the square-root operation more simple. It is evident that no linearization occurs in the filter, instead sigma points are propagated through the process and measurement models after which the state and measurement statistics are estimated. Although the k subscripts have been dropped steps 1-8 occur in discrete-time. The flow of the algorithm is shown below. Clearly the

Figure 4.3: UKF Signal Flow UKF requires more computational stages than the EKF, however the advantage is the ability to avoid linearizing highly non-linear process and/or output dynamics, which in and of itself could require many computations. Notice that the prediction phase consists of estimating the means and covariances of the measurement and estimates, whereas the EKF only predicts the estimates. Thanks to the propagation of sigma points through the system, the means and covariances of estimates and outputs are estimated with relatively higher accuracy when compared to linearization in the EKF. This algorithm should only be used

4.2. Unscented Kalman Filter

69

when absolutely necessary if the state-vector is large, otherwise the increased computational loads will merit the added robustness. For weakly nonlinear systems the EKF should be applied to the filtering problem, while for highly non-linear systems the UKF is a better choice. Especially when applying the KF to FDI problems. The UKF has been successfully applied to FDI problems to resolve some of the issues associated with linearization in the EKF that could lead to false alarms. FDI via state estimation with the UKF was used in reference [K. Xiong 2007] to detect sensor faults in a satellite attitude determination system. Residual generation is obtained as the difference between the state variables and measurements, while residual evaluation is performed by using the local approach to devise a hypothesis test to detect faults. Essentially a running average of the residuals is obtained of window-length N and is then compared to a threshold, if the threshold is exceeded a fault has been detected. The authors claim this is the first attempt at using the UKF for FDI purposes. This method works well for fault detection but can not perform isolation or identification of faults. A similar method for fault detection is used by [J. Prakash 2009] except that residual evaluation is performed using the generalized likelihood ratio test. Reference [M. Jayakumar 2010] performs state estimation with the UKF to isolate sensor faults in a flight control system. Residual generation consists of the difference between estimated and measured states, while residual evaluation is performed by simply observing the magnitude of the residual sequence to perform detection and isolation simultaneously. The isolation mechanism is based on hypothesis testing which is not a good method to use for systems with a large number of possible faulty modes. In that case there would be a large number of permutations, if insufficient measurements are available then identification/isolation of all faulty modes would not be possible. These methods are well-suited to fault detection in a similar manner as the EKF-based state estimation procedures, however they are more robust than the EKF in the face of large disturbances and non-linearities thanks to the unscented transform. State-estimation with the KF is feasible for fault detection and in some cases isolation, however it is difficult to perform fault identification. Another form of the KF is available which could help improve FDI performance, namely this involves modifying the KF formulation to perform parameter estimation in addition to or instead of state-estimation.

70

Chapter 4. FDI Using Kalman Filters

4.3

Parameter Estimation with Kalman Filters

In the previous sections the EKF and UKF were introduced for state estimation along with examples where they have been applied to fault diagnosis. It was mentioned that these methods can at best perform fault detection on their own, isolation with clever residual design and post-processing, and identification with substantial post-processing. It was also indicated that identification could be easily accomplished in one filter with minimal postprocessing if the KF is formulated to perform parameter estimation. Essentially a fault is usually the result of a change in system parameters, thus direct estimation of these parameters can provide information as to the type, severity, and location of the fault. The computational requirement of this method can be large when there are many "fault parameters"(FP) in a system, however through research the most common or critical fault types of a system can be identified such that only parameters reflecting those faults are estimated. This technique also has the advantage of producing as a byproduct the mathematical model for the system in question which can be used to generate residuals, thus state-estimation is not always necessary. As far back as 1979[Ljung 1979] parameter estimation was studied for the EKF, yet only within the last decade has it been applied in wide-ranging applications such as hydrology, soil carbon, speech dynamics, and structural dynamics[C. M. Trudinger 2008]. With the development of the UKF by Julier and Uhlmann in 1997 parameter estimation with KFs has become even more popular in the past decade because the UKF can handle non-linear systems better than the EKF. The joint state and parameter estimation problem is inherently nonlinear because parameters are usually coefficients to states. The standard EKF is used to estimate system states while parameters remain fixed, however this obviously is not true for parameter estimation. In this case the EKF/UKF equations must be modified such that the state-vector includes the parameters to be estimated. This is accomplished by either augmenting the state-vector with the parameter vector xp , or doing parameter only estimation. In the latter case there is less of a computational burden which is more appropriate for online operation[Jiahe Xu 2008], the system model can then be propagated using the parameter estimates. If partial state information is available due to lost measurements, then it would be necessary to perform joint-estimation.

4.3. Parameter Estimation with Kalman Filters

71

However if there is a very low probability of losing a sensor then parameter only estimation is fine. Because parameters are generally constant in a given mathematical model,  p = 0. Having said that it is important to their time-evolution can be described as x note that their estimates are indeed time-varying. Thus the state-prediction stages of the EKF and UKF must be modified to account for these factors. Naturally a common question emerges as to how the parameter estimates are varied if their time-evolution is zero. The evolution of the parameters is driven by the stochastic characteristics of the system. Poorly chosen Q and R matrices will lead to biases in the estimates and can even result in instability[C. M. Trudinger 2008].

4.3.1

Parameter Estimation with EKF

In this section the KF formulation will be formulated for parameter only estimation, the joint estimation problem can be addressed by including the state-estimation method. For parameter estimation in the EKF a system model is not required to vary the estimates. Thus of the linearized matrices in Eqs. (4.4) and (4.8) only the latter must be computed except with the Jacobian being calculated with respect to the parameter vector. Hk = g (xk , uk , xpk )  xpk (4.21)

Now the measurement matrix represents the relation between parameter estimates and measurements, which is really the only way to include information from the system dynamics model in the filter for parameter estimation. The EKF algorithm for parameter estimation is shown below, 1) Prediction ^- ^- x pk p(k+1) = x
- P- k+1 = P k + Qk+1

(4.22a) (4.22b)

2) Gain Calculation )-1 ( - T T K k+1 = P - k+1 Hk+1 Hk+1 P k+1 Hk+1 + Rk+1 (4.23)

72 3) Update

Chapter 4. FDI Using Kalman Filters

( ) n ^+ ^- ^- ^- x xk p(k+1) = x p(k+1) + K k+1 z k+1 - y k+1 = x p(k+1) + K k+1 r k = x p(k+1) + ^

(4.24a)

where y k+1

- P+ (4.24b) k+1 = (I - K k+1 Hk+1 ) P k+1 ( ) ^- = g x, u, x p(k+1) is the measurement/output equation. In the literature re-

view for FDI it was mentioned that a well defined or structured residual will make the residual evaluation stage more trivial. In this case the residual generation is obtained as the difference between the measurements and non-linear output equation as explained in section 4.1. This is a key aspect of this formulation that makes the residual generation more accurate and robust since the measurements of a non-linear system are being compared to the non-linear output equation and not the linearized form. In general the method of propagating states using the non-linear model while propagating covariances using the linearized matrices mitigates some of the drawbacks from linearization. Notice that the prediction elements have no information about the dynamics of the system, only the stochastic properties of the system drive the parameter estimation. For this reason it is important to have an error covariance prediction equation. The flow of the EKF algorithm for parameter estimation is basically the same as with state estimation. The residual signal is composed of system states, which is why there must be some form of model running in parallel with the filter to compare to measurements. Computational loads can be reduced utilizing a model that is run in parallel without performing stateestimation. However if sensor failures are expected to occur then state-estimation should be considered. In order to adapt parameters algorithm relies on residual data and the relationship between measurements and parameters defined in the measurement matrix. The measurement matrix is only utilized in the matrix equations of the filter, not in the residual generation as shown in section 4.1. Indeed trying to generate the residual in that
T ^- manner usually results in bad performance. This is because the term Hk k+1 only makes +1 x

sense when the estimates are measurable at least indirectly using sensors. These measurements usually give an idea of the state of the system whose true state must be estimated. For parameter estimation it is usually not possible to measure system parameters, thus measurements do not provide information as to the true parameter value(s) of the physical system. In state-estimation the filter tries to track the measurements while in parameter

4.3. Parameter Estimation with Kalman Filters

73

estimation it attempts to estimate parameters such that the residual error is minimized. For these reasons it is more appropriate to generate residuals as shown above, using the output equation rather than the measurement matrix. Few FDI algorithms with EKFs use the parameter estimation technique although there is a large body of work that has been dedicated towards developing parameter estimation algorithms with the EKF. This can be primarily attributed to the fact that the EKF has been around since the late 1960's when researchers required an optimal stochastic parameter estimator with noisy measurements. However for FDI the algorithm has not been used extensively. In [B. K. Walker 1995] FDI is done using the EKF to estimate states and parameters for an industrial actuator benchmark. Fault detection, isolation, and identification is performed via the parameter estimates. Residual generation consists of subtracting the estimates from the nominal parameter values while residual evaluation occurs by comparing the residual to a threshold. There are many drawbacks to this algorithm. First the Q and R matrices must be tuned appropriately such that the filter is sensitive to faults and insensitive to measurement noise. The challenge resides in the fact that making the filter more sensitive to the faults results in a filter that is more sensitive to measurement noise thus being more prone to false alarms. Second, the linearization process of the non-linear dynamics leads to bias and erratic behavior in the estimates when large changes occur in the system. As these changes occur the dynamics model becomes more inaccurate which should be accounted for by an increase in the entries of the error covariance matrix Q. Because this formulation cannot adapt the values of this matrix, estimates will usually diverge and result in false alarms. This algorithm performs some-what satisfactory as long as the thresholds are adapted depending on the inputs and outputs of the system, known as adaptive thresholding. Problems with tuning the EKF for parameter estimation are also discussed in [C. M. Trudinger 2008]. The authors conclude that although proper tuning of the measurement noise matrix R can allow the filter to converge, the tuning process is time consuming and convergence is usually slow. This is because the bandwidth of the filter does not change to reflect larger errors in the dynamics model. When changes occur in the physical system due to changes in parameters, ideally the filter bandwidth should increase to expedite convergence and then decrease as estimates approach the new parameter

74

Chapter 4. FDI Using Kalman Filters

values. In addition to this problem, one must consider the issues of applying the EKF to highly non-linear systems. For weakly non-linear systems the EKF is sufficient for the parameter estimation problem as pointed out in [T. Kataoka 1993] and [L. Loron 1993] where the technique is used to identify parameters in induction motors. However those methods are designed to perform the identification one time, if faults occur and system parameters change the estimates would not be able to track. The next section will discuss how the UKF is applied to parameter estimation problems for highly non-linear systems.

4.3.2

Parameter Estimation with UKF

For highly non-linear systems and/or systems subject to large disturbances the UKF is the better choice for reasons stated in section 4.2. There are many papers in the literature that apply UKFs for parameter estimation because of it's ability to handle non-linear systems very well such as the works of [Jiahe Xu 2008] and [Meiliang Wu 2008]. In particular the latter reference concludes the the UKF for parameter estimation is computationally efficient and appropriate for online applications. Relative to parameter estimation with the EKF far less research has been done in this area because the UKF algorithm has only been in existence for just over a decade. The formulation for parameter estimation with the UKF is shown below[Kyung-Yup Kim 2007]. 1) Compute weights W0 = Wi =  n+ (4.25a) (4.25b)

1 2 (n + )

2) Establish symmetric sigma points about the state estimate ^0 = x ^-  p(k+1) ^i =  ^i =  ^- x p(k+1)  +  (n + ) P - (k+1)i , i = 1, 2, ..., n i = n + 1, ..., 2n (4.26a) (4.26b) (4.26c)

^- x p(k+1)

-

(n + ) P - (k+1)i

4.3. Parameter Estimation with Kalman Filters 3)Predict mean and covariance of states
- P- k+1 = P k + Qk+1 + x- p(k+1) = xpk

75

(4.27a) (4.27b)

4) Instantiate sigma points through measurement model ^ i) Y i = g ( 5) Predict mean and covariance of measurements ¯= y
2n  i=0 2n  i=0

(4.28)

Wi Y i

(4.29a)

P yy =

¯ ] [Y i - y ¯ ]T + Rk+1 Wi [Y i - y

(4.29b)

6) Predict cross covariance P xy =
2n  i=0

[ ] ¯ ]T ^i - x ^- Wi  p(k+1) [Y i - y

(4.30)

7) Gain calculation and updates
1 K = P xy P - yy

(4.31a) (4.31b) (4.31c)

^ p = x- ¯) x p(k+1) + K (y - y
- T P+ k+1 = P k+1 - KP yy K

The primary difference in this implementation is most notable in steps 3 and 4. Because no dynamics information is available for parameters the sigma points from step 2 are not propagated, instead they are used in subsequent steps as is. Consequently the predicted means and covariances of the states are calculated as in Eqs. (4.22), in other words once

76

Chapter 4. FDI Using Kalman Filters

again only the process and measurement noise covariance matrices drive parameter estimation. The "predicted" mean and covariance of the states for the state-estimation UKF, ¯ and P xx respectively, in Eqs. (4.16) are replaced throughout the remaining steps of this x
- algorithm by the predicted mean and covariance x- p(k+1) and P k+1 of the states in step 3 of

the parameter estimation algorithm above. The flow of this algorithm is the same as that of the state-estimation UKF in section 4.2, differences lie in the state prediction calculations. The UKF does not require a measurement matrix because of the unscented transform as mentioned in section 4.2. Consequently there is no ambiguity as to which form of residual generation should occur. The function h in step 5 of this algorithm represents the output equation of the system in terms of its parameters. Depending on the system in question, if joint estimation is desired then the process model function f would be the same as the output function h. However the measurement particles Y i would be different than ~ i because outputs of the process model h are used as inputs to particles of the estimates  the output function h. With the UKF information relating parameters to system states is carried through using the output function as opposed to a linearized measurement matrix, hence it's ability to be accurate to third order. A performance comparison of the EKF and UKF parameter estimation algorithms is presented in [Miao Huanga 2010]. Results indicate that the UKF performs just as well as the EKF for certain cases of a weakly non-linear system, however the UKF is more stable and accurate when highly non-linear cases were considered. In [Girish Chowdhary 2010] it was also concluded that for a weakly non-linear system the EKF and UKF performances for parameter estimation were comparable, with UKF being more computationally intensive yet more robust with faster convergence. For highly non-linear systems the UKF's superiority to the EKF is confirmed in [Cheryl C. Qu 2009]. Parameter estimation for the NPSAT1 satellite launched by the Naval Postgraduate School in 2007 was performed using a UKF because the satellite attitude dynamics are highly coupled and non-linear[Pooya Sekhavat 2007]. Parameter estimation with KFs has been around a long time, however application of these algorithms to fault diagnosis problems has been studied much because of the deficiencies of the algorithm. In section 4.1 it was stated that the bandwidth of the KF,

4.4. Adaptive Kalman Filtering

77

defined by the ratio Qk+1 /Rk+1 , is critical to KF performance and that the selection of these matrices should be done carefully. In the case of parameter estimation this is relevant because ultimately parameter changes in a physical system represent a change in the system model. When running the filter this should be reflected as an increase in process noise covariance matrix entries or the bandwidth of the filter in general. If this is not done then the algorithm will only be able to perform identification of the parameters once. When the Kalman gain reaches steady-state and parameters have been estimated correctly the filter bandwidth is usually near-zero, if any of these parameters change the filter will not be able to track the changes because the bandwidth of the filter is fixed. In order for identification to be possible in the face of parameter uncertainty there must be some mechanism by which to adapt filter bandwidth based on residuals of measured changes in the system behavior versus the modeled behavior. AKFs provide this capability.

4.4

Adaptive Kalman Filtering

Adaptive Kalman filtering has been around since the late 1960's for online estimation of measurement and/or process noise characteristics[Shellenbarger 1966, F. L. Sims 1969]. At the early stages of KF research it was understood that in practice stochastic noise properties of a system are not always known. A mechanism was needed that could recursively compute the real measurement and process noise statistics online so that variations in system uncertainty could be tracked. These methods have been documented in [R. Lynn Kirlin 1987], three of the most common are; (1) the Bayesian approach, (2) the maximum likelihood approach, and (3) innovation/residual-based approach. The Bayesian approach is one of the oldest approaches for on-line noise covariance estimation and requires the most amount of a priori information. An expression for the time evolution of the conditional probability density function (PDF) of the random variable to be estimated must be known. Since the first two moments of a Gaussian PDF describe it completely, it is sufficient to obtain recursive expressions of these moments to describe the time-evolution. One approach taken by [Smith 1967] is to define the measurement noise R as the product of a nominal measurement noise matrix Rnom and an

78

Chapter 4. FDI Using Kalman Filters

unknown precision vector  included as part of an augmented state-vector. In order to obtain recursive equations for the PDF of the augmented state-vector conditioned on measurements P (xk+1 /z k ), the unknown  had to be approximated. This results in a non-reproducing PDF meaning that a finite number of moments of the PDF will not describe it completely. In general one is forced to approximate the PDF. One method of approximation is the Gram-Charlier(GC) expansion to obtain the recursive equations for the PDF[Sorenson 1967]. Basically the goal is to approximate P (xk+1 /z k+1 ) given the GC expansion of P (xk /z k ). At each iteration this algorithm requires information of more moments of the PDF at the previous iteration than were evaluated. Consequently we encounter the 'expanding grid' phenomena that leads to inaccurate estimates at the outer edges of the PDF and very large computational loads . The Fokker-Planck equation was used to obtain differential equations for the mean and process noise covariance in [R. L. Klein 1969]. Another method of using the Bayesian approach was developed by [Magill 1965]. In this case an optimal adaptive estimate is obtained as an appropriately weighted summation of conditional estimates formed by a set of estimators representing a finite number of possibilities known a priori resulting in a form of multiple-model approach. The weighting coefficients are calculated by non-linear operations on the measurements. Multiple model methods are also variations of the Bayesian approach. Here multiple filters run in parallel representing different modes of operation of a system, the weighted sum of their estimates constitutes an overall estimate with weights determined by error covariances of each filter[R. Mehra 1995, N. Tudoroiu 2005]. Variational Bayesian(VB) methods have also been developed that assume simpler, more practical forms of the PDFs such that their calculations are more tractible and less complex[Simo Sarkka 2009]. Generally Bayesian methods work well if the time-evolution of measurement and process noise PDFs are known sufficiently such that recursive equations can be derived, if not a more practical method is the maximum likelihood approach (MLA). The MLA is based on the philosophy that the most likely value of unknown parameters is that which makes their probability of occurrence given system measurements the greatest. In general the algorithm consists of initializing the posterior mean and covariance of the state independent of any a priori information about the statistics of R and

4.4. Adaptive Kalman Filtering

79

Q. Then estimates of R are obtained with Q known based on past estimates and of Q with R known based on past estimates. Shellenbarger [Shellenbarger 1966] attempts to ( ) ^ 1, R ^ 2, . . . , R ^ k , where Rj is the measurement noise covariestimate the sequence R = R ance at time-step j , by defining the PDF as P (z k /R). He approximates this function as ( ) ^ 1, R ^ 2, . . . , R ^ k-1 ; Rk and maximizes it with respect to Rk to obtain P s (Rk ) = P z k /R sub-optimal estimates. Process noise estimates are obtained similarly. Results indicate that if both Q and R are unknown estimates cannot be formed. In reference [Abramson 1970] a sub-optimal estimator is designed for diagonal, time-invariant process and measurement noise matrices that are not known precisely a priori. Estimates of the states and noise covariances are obtained by maximizing the logarithm of P (^ xk , z k /R, Q) with respect to that component which must be estimated(xk , R, Q). Each estimate is obtained with the other two known. It was shown that if the a priori values of R and Q are far from the true values the filter will converge to biased estimates, however if only R is unknown the estimates are unbiased. Another method was proposed in [Husa 1969] by considering uncertainties in the mean and covariance of the process and measurement noise, as well as off-diagonal elements for the covariance matrices. Simulations showed that the process noise estimates converged slowly and are very sensitive to initial conditions while the measurement noise estimator performed well. These methods are in general sensitive to filter initial conditions, in particular for estimation of process noise. The filter tuning problem is still present at the initialization stage which reduces some of the appeal of this method. Recent forms of the MLA use information from the innovation and residual sequences to construct more accurate covariance estimates and improve convergence times[Herschel L. Mitchell 2000, Feng Zhou 2008, Hongwei Bian 2005]. Tuning problems have been resolved using these newer methods, however a priori knowledge of the PDF structure is still required. If insufficient a priori information for the PDF structures is available such that neither of the former two methods are appropriate, innovation/residualbased methods should be considered. To relax the requirements on a priori information of the measurement and process noise structures, innovation/residual-based approaches can be considered. Most current adaptive algorithms use some form of processing of the innovation/residual sequence to obtain better

80

Chapter 4. FDI Using Kalman Filters

estimates of system statistics, better tracking, and faster convergence. Algorithms such as adaptive fading factor(AFF) and covariance matching(CM) fall into this category of adaptive filters. AFF algorithms generally introduce a scale-factor  to the error covariance prediction and/or gain calculations. In Reference [Vahid Fathabadi 2009] a scaling factor ^ v and C v  is defined as a function of estimated and theoretical innovation covariances C respectively shown in the equations below, { ( )} 1 - 1 ^ vC  = max 1, trace C v N ^v = 1 C N
k  j =k-N +1

(4.32a)

^ xk ^ xT k

(4.32b) (4.32c)

T C v = Rk+1 + Hk+1 P - k+1 Hk+1

where 'trace' is the trace operator. This has the affect of modifying the scale-factor when estimated variances based on innovations become larger. In other words when changes in system parameters occur the mechanism causes changes in the bandwidth of the filter. This is done by multiplying the gain of the standard KF equations by 1 / . Another form of adapting the scale-factor is proposed in [Giulio Reina 2007] where the magnitude of the deviation of the innovation vector from zero is used as an input to fuzzy rules, which then output a scale-factor representing the degree of confidence that divergence is occurring. Research presented in [Yuanxi Yang 2006] demonstrates the AFF method using both the residual and innovation sequences and concludes that a fading factor expressed by the innovation sequence is superior to one expressed by the residual sequence. The CM approach is a method of making residuals and innovations consistent with their theoretical covariances. Usually either the R matrix is held constant while the Q matrix is ^ v is used adapted or vice-versa. In the former case the estimated innovation covariance C to adapt the Q matrix until it matches the theoretical covariance[Shu-Wen Zhang 2004]. As innovations become larger in the face of system faults the estimated covariance increases thereby increasing Q and therefore the Kalman gain. This method can be subject to abrupt changes in Q in which case a running average window can be used to smooth out the estimate[H. K. Tzou 2001]. If R is to be estimated while Q is held constant, R ^ r until the covariances is adapted based on the estimated residual sequence covariance C

4.4. Adaptive Kalman Filtering

81

match. In reference [P. J. Escamilla-Ambrosio 2002] this method is used along with fuzzy rules to identify the amount and direction of change that should occur in the measurement noise matrix. These methods are sub-optimal as they involve approximations to the true statistics and in some cases convergence is uncertain. However they are more robust and responsive than the Bayesian and MLA methods because information from the residual and/or innovation sequences provide close approximations to the actual variances. Traditional covariance matching techniques estimate either the measurement or process noise matrices while the other is assumed constant, adaptive sequential estimation is a similar technique to that of covariance matching except that both measurement and process noise statistics are estimated simultaneously online. Myers and Tapley[K. A. Myers 1976] were one of the first to propose such a method. First they define an unbiased estimator for residual r k+1 as the following sample mean r k+1
N 1  = rj N j =1

(4.33)

Next an estimate of the covariance of r k+1 is calculated along with its expected value. Cr = 1  (r j - r k+1 ) (r j - r k+1 )T N - 1 j =1
N

(4.34a)

N [ ] 1  T E Cr = Hj P - k+1 Hj + R N j =1

(4.34b)

The resulting unbiased estimate is shown below. ( ] ) N [  N - 1 1 T - T ^ = R (r j - r k+1 ) (r j - r k+1 ) - Hj P k+1 Hj N - 1 j =1 N

(4.35)

Process noise can be estimated in a similar fashion except using the innovation sequence, ( ) ] N [ )( )T ) 1  ( N -1 ( - T + ^ Q= x ^ xkj - ^ x - k+1 P k+1 k+1 - P k+1 ^ xkj - ^ N - 1 j =1 N (4.36) where ^ x is the mean of the innovation. In this algorithm the difference between the innovation/residual vectors and their respective running average means is used to obtain covariance estimates. The goal being to obtain process and measurement noise es^ and R ^ must be timates for covariance matching. Absolute values of diagonal entries of Q

82

Chapter 4. FDI Using Kalman Filters

taken in order to guarantee the positive definiteness of these matrices. Another form of this technique that is more numerically robust was developed by Mohammed and Schwartz[A. H. Mohamed 1999]. An estimate of the innovation covariance is obtained by averaging the innovation sequence over a window of length N . ^v = 1 C N
k  j =k-N +1

xT ^ xk ^ k

(4.37)

Then based on the whiteness of the filter innovation sequence the statistical matrices can be estimated according to[A. H. Mohamed 1999]. ^ k+1 = C ^ v - Hk+1 P - H T R k+1 k+1 ^ k+1 = K k+1 C ^ vKT Q k+1 (4.38a) (4.38b)

In reference [A. H. Mohamed 1999] it was realized that a more useful approach to this problem is to use the measurement residual sequence r k to estimate the process and measurement noise, the reason being that changes in system states are better reflected through ^ k+1 using the residual sequence r k is derived by measurements. A similar expression for R [A. H. Mohamed 1999] resulting in ^ k+1 = C ^ r + Hk+1 P + H T R k+1 k+1 ^r = 1 C N
k  j =k-N +1

(4.39) (4.40)

rk rT k

Next the process noise estimate can be computed as ^ k+1 = 1 Q N
k  j =k-N +1 + T + ^ xk+1 ^ xT k+1 + P k+1 - k+1 P k k+1

(4.41)

In steady-state considering only the first term in this equation and substituting the relation ^ xk+1 = K k+1 r k , the estimate for Q can be approximated as in Eq. (4.38b) except ^ r . Most recent covariance matching techniques use as a basis one or both of these using C sequential adaptive estimation(SAE) algorithms. Reference [Wan-Chun Li 2005] performs process and measurement noise estimation by a similar method as Myers and Tapley for a UKF with the exception that running averages of the innovation/residual are not computed.

4.4. Adaptive Kalman Filtering

83

The method developed by Mohammed and Schwartz is also implemented in papers by [Ahmed El-Mowafy 2005b, Christopher Hide & Smith 2003] for INS/GPS applications. Parameter estimation with adaptive forms of the KF has been studied in the literature more and more in recent decades because of improvements in the ratio of micro-controller processing-power to size. Generally any adaptive scheme can be applied to the parameter estimation problem and has been in the literature. Yang et al.[Jann N. Yang 2004] developed an AFF-based scheme to estimate parameters for health-monitoring of civil infrastructures. A matrix of scale-factors  is adapted online by solving an optimization problem and is integrated into the KF equations as follows.
- T T P- k+1 = k+1 k+1 P k k+1 k+1 + Qk+1

(4.42)

In reference [L. Ozbek 2004] a single fading factor is used for parameter estimation of compartmental models in a study of ingestion and subsequent metabolism of a drug in a given individual. The work of [Zhi Gao 2005] uses a covariance matching technique to estimate process and measurement noise covariances for stator winding temperature estimation in an induction machine based on a hybrid model, Fuxjaeger and Iltis[Alfred W. Fuxjaeger 1994] employ the MM approach for parameter estimation in a spread spectrum code and Doppler tracking application, and Szabat et al. designed an adaptive mechanism based on Genetic Algorithm(GA) to estimate parameters for the improvement of industrial drives with mechanical elasticity. Much work has been done in the field of fuzzy-AKF methods such as in reference [Zhijie Zhou 2008] for fault prediction of non-linear systems with uncertainty. Relatively speaking FDI with AKFs has not been addressed extensively in the literature because researchers generally prefer intelligent expert-based systems such as fuzzy logic and neural networks or more optimal methods. Neural networks do not require mathematical models of practical systems and instead learn a system's behavior, while optimal algorithms guarantee convergence. Nonetheless within the past decade research has increased in this area thanks to an increasing need for health monitoring of electrical and/or mechanical systems and the availability of increased processing power. Reference [Karim Salahshoor 2008] apply the IAE approach for sensor fault detection and isolation with sensor fusion. Residuals are generated as the difference between measurements and their estimated values, and are evaluated using covariance matching techniques. Hajiyev and Caliskan[C. Hajiyev 2000]

84

Chapter 4. FDI Using Kalman Filters

also employ an IAE-based Kalman filter for fault detection and isolation of sensor and actuator faults. Faults are classified as either sensor or actuator faults by using a threshold test on a time-average of the residual sequence in conjunction with hypothesis testing. Fuzzy hybrids of the EKF have also been studied. Zhou et al.[Zhijie Zhou 2008] use the AFF technique by adapting the fading factor using fuzzy logic rather than stochastic properties for fault diagnosis, and Loebis et al. use fuzzy rules on the time-averaged residual sequence to determine, based on the residual's amplitude and sign, how much of an increment/decrement should be made to the measurement noise matrix for fault detection in an intelligent aerial unmanned vehicle(UAV). By far the most common form of AKF for FDI is the multiple-model adaptive estimation(MMAE) approach. Reference [N. Tudoroiu 2007] designed a fault detection and isolation algorithm for reaction wheels of a satellite ACS. A bank of KFs is designed such that each filter represents a particular faulty mode of operation or the healthy mode. The fault mode is determined by detecting the filter mode with largest conditional probability. Roumeliotis et al.[Stergios I. Roumeliotis 1998] employ a similar method using hypothesis conditional probability computations for sensor fault detection in a mobile robot. Hanlon and Maybeck[Peter D. Hanlon 2000] and Eide and Maybeck[P. Eide 1995] also apply a similar approaches to the FDI problem.

4.5

FDI by Parameter Estimation with Adaptive Kalman Filters

To approach the problem of fault detection, isolation, and identification of pico-satellite ACS hardware such as RWs and CMGs, an AUKF is presented for parameter estimation assuming full state measurement. A primary goal in the design was to limit the computational requirements of said algorithm to facilitate implementation in the ACS module. In other words only parameter estimation is considered in order to limit the prediction and update equation's computational requirements. A joint n-state and p-parameter estimator would result in an augmented state-vector xa with dimension n + p. Assuming m measurements are available, dimensions of the error covariance matrix would increase to (n + p) × (n + p), while those of the gain matrix would be (n + p) × m. For n = 2,

4.5. FDI by Parameter Estimation with Adaptive Kalman Filters

85

m = 2, and p = 2 the covariance matrix for parameter only estimation has four entries while in the joint case this number increases by a factor of 4. Similar computational savings are observed in the gain matrix to a lesser degree, however on macroscopic scales of time these computational savings quickly add up. State-propagation is performed by running a model online whose outputs are conditioned by the estimated parameters. Although this entails excess computational requirements, they are not realized in the KF equations, and the net savings is still considerable since only one set of equations needs to be calculated. Another goal in the design of this algorithm was to provide fast detection, isolation, and identification in a single filter. Monitored parameters should generally be selected based on a priori knowledge of the kinds of faults that are most likely to occur. For example if the frame of a UAV in flight is expected to sustain damage, inertia parameters should be monitored. False alarms in the face of disturbances and/or increased measurement noise should be limited, and the estimation accuracy should be better than 5%. Finally this algorithm should be applicable in general to any linear or non-linear system. Kalman filtering was selected because it is less complex to implement and is more readily applied to general parameter estimation. Neural networks such as those utilized by[A. Joshi & Khorasani 2008, Iz Al-Dein Al-Zyoud 2006, E. Sobhani-Tehrani 2008b] must be tailored to their particular application. Numbers of hidden units, inputs, and outputs have to be tuned and trained differently for comparable performance across different systems. With respect to linear or non-linear observers[H. Azarnoush 2008] KFs work better in the presence of measurement noise and disturbances, especially the more robust RKF and UKF variations. Parity space methods [E. Chow 1984, S. K. Neguang 2006] are also sensitive to measurement noise and disturbances. In the case of fuzzy systems the rules change based on the type of system and residuals, thus different systems require different sets of rules. Another reason for selecting a KF-based approach is the lack of availability of FDI algorithms for spacecraft ACS using KFs. Other than IMM approaches with the KF very few other methods exist, especially when considering the UKF. If FDI for reaction wheels and/or CMGs is investigated, even less can be found in the literature. Of the available methods for RW FDI at least 90% of them are IMM with the KF, or neural networks, a centralized KF has not yet been applied to this problem let alone with the ability to

86

Chapter 4. FDI Using Kalman Filters

identify faults. This KF algorithm will be applied to the FDI problem for RWs and CMGs. As explained in section 1.5 the FDI problem consists of residual generation and evaluation. Residuals will be generated as the difference between outputs of the propagated model and measurements. For residual evaluation the various methods outlined in the previous section were considered. The SAE approach[Christopher Hide & Smith 2003] was considered as the noise-estimation method of choice. Selection was made based on three factors; robustness, required a priori knowledge, and computational requirements. Compared to CM, MLA, and Bayesian approaches this algorithm is more robust because residuals are utilized to generate estimates of the Q and R matrices simultaneously rather than estimating either or. Furthermore this approach requires no a priori knowledge of stochastic properties, thus increasing its applicability to a wide range of practical systems. Other SAE algorithms such as[K. A. Myers 1976, Wan-Chun Li 2005] only utilize the time-averaged residual vector rather than both the residual and innovation sequences, thereby decreasing storage and computational requirements. With respect to MM approaches computational savings are realized because only one filter is required rather than a bank of filters that changes in size depending on the number of faulty modes in a system. Estimation accuracy is also of concern in the presence of unmodeled disturbances since noise covariances are not estimated online to adapt changes in modeling error. Some advantages to this method as compared to Myers and Tapley[K. A. Myers 1976] and related algorithms is that no statetransition matrix is required, for parameter estimation this is important because the matrix is not available since state-estimation is not performed. Also, the estimation equations for measurement and process noise matrices do not lend themselves to negative-definite results. Based on the research done for this study, this algorithm has not been applied to the parameter estimation problem for FDI using EKFs and UKFs, thus it was also interesting to study it's performance for this application. To clarify, the following adaptive mechanism is applied to the EKF formulation ^r = 1 C N
k  j =k-N +1

rk rT k

(4.43a) (4.43b) (4.43c)

^ k+1 = C ^ r + Hk+1 P + H T R k+1 k+1 ^ rKT ^ k+1 = K k+1 C Q k+1

4.5. FDI by Parameter Estimation with Adaptive Kalman Filters

87

To use this algorithm the EKF Eqs. (4.22a-4.24b) do not need to be modified, instead there is an added step to the algorithm including these equations. The flow of the AKF algorithm is shown in the block diagram below Note that the prediction stage consists of

Figure 4.4: AKF Signal Flow Eqs. (4.22). The moving window average of the matrix in Eq. (4.43a) is updated at each time-step. In practice the elements of the moving window are stored as an array. At each iteration the oldest element in the array is shifted out while the newest residual vector is shifted in, then the measurement and process noise estimates are calculated. Selection of the window size depends on the application, reference [Christopher Hide & Smith 2003] provides criteria for window length selection to avoid divergence and/or instability; (1) A window size smaller than the number of measurements when adapting R. (2) A window size smaller than the number of filter states when adapting Q. (3) A window size smaller than the sum of update measurements and filter states when adapting both Q and R. In these three cases divergence occurs because there are less equations than unknown parameters, resulting in an under-determined system. Following the above criteria destabilization of the filter is averted, however biased estimates may result for small sample sizes. For unbiased estimates a larger window length is preferred, however a window length that is too large will not allow the filter to correctly track high-frequency changes in the system states. Consequently the lower bound of the window length is selected based on the number of filter states and measurements, while the upper bound is selected depending on the dy-

88

Chapter 4. FDI Using Kalman Filters

namics of the system. For implementation in the UKF a modification must be made to Eq. (4.43b) because the measurement matrix is no longer available. Estimated measurement covariance is calculated in the UKF using Eq. (4.18b), consequently the measurement noise covariance matrix should be calculated as[Junchuan Zhou 2010], ^ k+1 = C ^r + P R yy P yy =
2n  i=0

(4.44a) (4.44b)

¯ ] [Y i - y ¯ ]T Wi [Y i - y

^ r is the same as in Eq. (4.43a). The signal flow of the resulting AUKF algorithm where C is shown in the block diagram below.

Figure 4.5: AUKF Signal Flow In this case the prediction stage of the UKF is ~i =  ^i  P xx = P - k + Qk+1 (4.45a) (4.45b)

In addition to adapting the Q and R matrices, a fading factor is applied to the error covariance matrix in the prediction stage so that
- P- k+1 = P k  + Qk+1

(4.46)

4.5. FDI by Parameter Estimation with Adaptive Kalman Filters for the EKF while for the UKF, P xx = P - k  + Qk+1

89

(4.47)

If  = 1 then the standard KF prediction occurs, if  > 1 the filter will weight the data exponentially so that the effect of current data is emphasized and information from older measurements is discounted, hence the name 'fading factor' or 'fading memory'. In the standard KF algorithm estimates depend highly upon past data which can lead to divergence of the estimates even in the face of new measurements. An FDI algorithm should consider current data more heavily so that estimates can track the current state of a system. In essence the fading factor limits how small the error covariances can get by artificially inflating the value of the predicted error covariance matrix thus introducing more uncertainty into the system. In reference [Lee 1988] it is shown that larger values of  give the filter a larger bandwidth with the opposite happening for a smaller value. Typically the fading factor is in the range 1 <  < 1.01 however the appropriate choice depends on the particular application. If it is close to or larger than the upper bound then instability can ensue, while if it is close to or lower than the lower bound there will be no effect. This algorithm incorporates two adaptive mechanisms; one to ensure that changes in system parameters are reflected as increased modeling errors, and the other to limit the memory of the filter so that it pays more attention to current data. Ultimately the modified algorithm attempts to adapt the bandwidth of the filter based on a moving window average of residuals while making sure that the bandwidth does not get small enough so that the filter ignores new data. To make the algorithm more robust and accurate an adaptive fading factor will be used. The primary goal is to force the filter to consider new measurements more heavily when faults occur and less heavily when no further faults are detected. Although the noise covariance estimations perform the function of adapting the filter bandwidth, eventually the filter will converge to very small gains thus making the bandwidth very small. In this case even if a fault occurs and the R matrix becomes large, the Q matrix will be much smaller because it is a function of the square of the gain matrix. Consequently the filter will not track correctly. A forgetting factor can mitigate this effect be forcing the filter to forget older data and become more sensitive to newer data. However a constant forgetting factor can have adverse effects when convergence has been achieved,

90

Chapter 4. FDI Using Kalman Filters

where it would be desired to make the filter less sensitive to new data so that the estimate holds even in the face of disturbances. An adaptive forgetting factor could force the filter to ignore new data when estimates converge and consider new data more heavily in the opposite case. This adaptation is based on the magnitude of the R matrix. Large diagonal entries of the measurement noise covariance matrix R result from large residuals as per Eq. (4.43a). Because a running average of the residuals is used a brief disturbance will not be detected, however a disturbance that persists over a longer period of time will be reflected in the residual average. Thus adapting the fading factor based on the magnitude of the R matrix would ensure that when the residuals become larger the filter bandwidth opens up, with the opposite happening when residuals become smaller. The adaptation is as follows, =1+ trace (Rk )  (4.48)

This formulation guarantees that the adaptive factor will increase for larger values of Rk . The trace operation consists of the sum of the diagonal elements of a matrix, which indicates the size of the residual error. For larger residual errors the trace operation gets large and therefore increases the value of the adaptive factor. Note that if ideally the Rk matrix is close to zero the adaptive factor will be close to zero meaning that when convergence is achieved it bases its estimates more on past data. In the opposite case that Rk diagonal entries get larger the fading factor will increase thus forcing the filter to base its estimates on new data. In order to keep the AFF below 1.01 upper bounds can be established for the Rk matrix or  can be determined so that the largest possible value of Rk will not cause  to exceed 1.01. Note that the filter estimates are not smooth since this is a sub-optimal algorithm. Furthermore, the task of a standard KF is to remove noise from state measurements, however for parameter estimation this is not the case. Since the estimates are not simply representations of the measurements without the noise, this noise is manifested in the parameter estimates. Hence the estimates are smoothed by time-averaging.

Chapter 5

Simulation Results of RW and CMG FDI Algorithm

Simulations of the FDI algorithm were performed in Matlab/Simulink to verify its performance. First, numerical simulations are conducted on the high fidelity RW model presented in chapter 2 with the bus voltage and BEMF constant being the FPs. The algorithm was tested for BEMF constant faults only, followed by bus voltage faults only, in both cases for different types of faults. Then the faults were injected simultaneously to test the performance of concurrent FDI. Next, numerical simulations were performed with the CMG system presented in chapter 3 with multiplicative faults in the gimbal angle rates. Finally, the algorithm was applied to a systems identification problem on the nanosatellite RW prototype being developed at SSDC group using only wheel speed measurements.

5.1

FDI for Reaction Wheels

The high fidelity reaction wheel model shown in Fig. 2.3 was used for simulations with the parameters listed in Table 5.1. Because of the high degree of non-linearity in the model the AUKF algorithm was applied. The simulation was set up as shown in Fig. 5.1. A control voltage trajectory is applied to the high fidelity Simulink model of the RW that serves as the plant. The outputs of the system are the wheel speed and current  and i respectively. To simulate sensor measurements these outputs are then discretized using zero-order-holds with a sampling period of Ts . The control voltage trajectory is also discretized to simulate the discrete environment. All these discretized components are fed into the parameter estimation algorithm where a residual is generated as the difference between measured states and outputs of an analytical model of the RW that is running in parallel to the filter.

92

Chapter 5. Simulation Results of RW and CMG FDI Algorithm Parameter Coulomb Friction(c ) Viscous Friction(v ) Ripple Torque(B) Cogging Torque(C) Torque Noise Frequency(a ) Jitter Angle(a ) BEMF(Ke ) Nominal Bus Voltage(Vbus ) Nominal Driver Gain (Gd ) Num. of Motor Poles(N) Input Filter Resistance(RIN ) Quescient Bus Power(Pq ) Driver Bandwidth(d ) Voltage Feedback Gain(kf ) Flywheel MOI(Jw ) Overspeed Circuit Gain(ks ) Max. Wheel Speed (s ) 9 Value 0.002 Nm 3.84 × 10-4 0 0.2 Hz 0.05 rad 0.029 V /rad/s 8V 0.19 A /V 36 2 3W
rad N·m

/rad/s

0.22

/s

0.5 V /V 0.0077 kg · m2 95 680
rad

/s

Table 5.1: Ithaco A Reaction Wheel Parameters Thus the parameter estimates adjust such that the analytical model outputs match the measurements as best as possible. White-noise is injected into the discretized outputs of the RW model to simulate measurement noise. The white-noise signal power is calculated as follows, Pv = 10 log10 (
T 1 |vk |2 T 0

) (5.1)

where wpsd is the power spectral density(PSD) of the white-noise. The nominal power spectral densities of the wheel speed and current measurements are 1 × 10-5 and 5 × 10-8 respectively resulting in -9.99 dB and -33.01 dB respectively of noise-power. Based on research done in [Sobahni-Tehrani 2008] it is known that various experimental experiences

5.1. FDI for Reaction Wheels

93

Figure 5.1: RW FDI Simulation Setup

with RWs on-board satellite missions have revealed the following potential sources of failure;

(i) Faults in the bus voltage (ii) Faults in the motor torque/BEMF constant

Thus the parameters that will be monitored are the bus voltage and BEMF constant. Changes in BEMF constant can be attributed to extreme temperatures in the windings that exceed the Curie temperature of the magnetic material in the motor resulting in a decrease in magnetism of the magnets. Furthermore, any blunt-force trauma imparted onto the magnets can degauss them. Bus voltage faults may occur as a result of things like cold-solder joints, loose wires, or failures in the power supply. Regardless of the cause it is important to monitor these parameters to improve the performance of RWs. Simulations were initialized as shown in the table below. The window size is selected to be large because for parameter estimation, it is assumed that parameters are not dynamic quantities for the most part, thus the problem of the filter not being able to track if the window is too large is not an issue here. This window size was found to be applicable to all the cases presented below for nominal measurement noise. The UKF parameter  is typically chosen as  = n - 3, where n is the number of estimates. Note that this is assumed for all simulations.  was selected to be 100 so that  would remain below

94

Chapter 5. Simulation Results of RW and CMG FDI Algorithm Sampling Period(Ts ) Simulation Time Window Size(N)  R0 Q0 P0 Qmax Rmax ^0 x  n 0.01 s 4000 s 50 100 2 × 10-4 × I2×2 1 × 10-5 × I2×2 1 × 10-8 × I2×2 1 × 10-4 0.5 [8, 0.029]T -1 2

Table 5.2: Simulation Parameters for RW FDI 1 × 10-2 , based on extensive simulations anything above that can lead to instability. The voltage applied at the motor terminals is a sine wave with an amplitude of 5 V and a frequency of 0.25 Hz. Various fault scenarios will be considered in the following sections. Fault scenarios depicting low and high severity faults will be considered. A high severity fault will be considered as changes that are  20 %, while low severity faults constitute changes  15 %. First, severe BEMF constant faults are simulated according to the following profile time (s) t < 1000 1000  t < 2000 2000  t < 3000 t  3000 km 0.029 0.020 0.013 0.029

Table 5.3: Fault Case 1 - RW Severe Intermittent BEMF Constant Fault Profile Next an intermittent time-varying BEMF constant fault is modeled as a sinusoid, the profile is shown in the following table.

5.1. FDI for Reaction Wheels time (s) t < 400 400  t < 3500 3500  t km 0.029 0.029 - 0.018 sin 0.029 (
-400) 2 (t3000

95

)

Table 5.4: Fault Case 2 - RW Intermittent Time-varying BEMF Constant Fault Profile An example of a time-varying fault in BEMF constant is if metallic particles or materials get into the flux gap of the motor and then eventually leave those areas. This type of fault will also provide an indication as to the ability of the algorithm to track a time-varying fault with time-varying states. Mild bus voltage faults are simulated as shown in Table 5.5. These mild faults typically will not cause large changes in performance of the RW, however time (s) t < 1000 1000  t < 2000 2000  t < 3000 t  3000 Vbus 8 7.5 7 6.8

Table 5.5: Fault Case 3 - RW Mild Intermittent Bus Voltage Fault Profile if precise control is needed they must be monitored because they cause small changes in current consumption. Severe bus voltage faults have a larger effect on the RW system and can drastically limit the amount of available torque. The severe bus voltage fault profile is shown in Table 5.6. Next the system will be simulated such that faults occur in both the time (s) t < 1000 1000  t < 2000 2000  t < 3000 t  3000 Vbus 8 6 4.5 8

Table 5.6: Fault Case 4 - RW Severe Intermittent Bus Voltage Fault Profile

96

Chapter 5. Simulation Results of RW and CMG FDI Algorithm

BEMF constant and bus voltage. Case 5 will combine case 2 and a severe bus voltage fault profile such that faults occur simultaneously for each parameter. This will demonstrate the performance of the filter in the face of severe faults for both parameters. The profile is shown in the table below. Finally case 6 will consist of running case 1 and a severe bus time (s) t < 500 500  t < 1500 1500  t < 3500 t  3500 Vbus 8 5 6.5 8 km ( ) -500) 0.029 - 0.018 sin 2 (t3000 ( ) (t-500) 0.029 - 0.018 sin 2 3000 0.029 0.029

Table 5.7: Fault Case 5 - Simultaneous BEMF Constant and Bus Voltage Severe Faults

timeVbus (s) t < 1000 1000  t < 2000 2000  t < 3000 t  3000

Vbus 8 6 5 7

timekm (s) t < 500 500  t < 1500 1500  t < 2500 t  2500

km 0.029 0.02 0.013 0.029

Table 5.8: Fault Case 6 - Severe BEMF Constant and Bus Voltage Out of Phase voltage profile with each parameter fault occurring out of phase with the other, this profile is shown in Table 5.7. The performance of the system identification will be performed using the root-mean-square(RMSE) of the estimation error and the mean of the error(ME) calculated as follows, ^p ek = xp - x RM SE =
N 1  [ek ]2 N k=1

(5.2a) (5.2b)

N 1  ME = ek N k=1

(5.2c)

These performance indices will be used for all simulation results to quantify the accuracy of the parameter estimates while the FDI performance will be analyzed based on detection,

5.1. FDI for Reaction Wheels

97

isolation, and identification times. Furthermore it should be noted that these indices will be calculated from the estimates once they have settled. In other words the transient periods will not be considered. Estimates of the noise covariance matrices along with the AFF are shown in appendix A. In each simulation the plots will show relevant information during the faulty period since in the healthy time-periods outputs are the same for each case. Consequently below are plots of the input voltage profile applied to the RW as well as the RW outputs up to the 200 s mark.
Applied Voltage Profile
5 4 3 2 1

Volts

0 -1 -2 -3 -4 -5 0 20 40 60 80 100 120 140 160 180 200

time [s]

Figure 5.2: Reaction Wheel Applied Voltage Profile

Measured Wheel Speed
20 0 -20 0 50 100 150 200 2

Measured Current
Amps
0 -2 0 50 100 150 200

rad/s

time [s]

time [s]

Estimated Wheel Speed
20 0 -20 0 50 100 150 200 2

Estimated Current
Amps
0 -2 0 50 100 150 200

rad/s

time [s]

time [s]

Wheel Speed Residual
5 0 -5 0 50 100 150 200 0.05

Current Residual
Amps
0 -0.05 0 50 100 150 200

rad/s

time [s]

time [s]

Figure 5.3: Reaction Wheel States for First 200 s

98

Chapter 5. Simulation Results of RW and CMG FDI Algorithm

5.1.1

CASE 1: Intermittent BEMF Constant Faults

In this section the FDI algorithm is applied to the RW system with severe intermittent faults starting at 1000 s and ending at 3000 s, outside of this range of time the parameter returns to its nominal value of 0.029. The wheel speed and current estimates are obtained from an analytical model running in parallel with the AUKF. This model uses the parameter estimates generated by the filter as well as the control input to generate these outputs. Consequently the outputs will be considered as estimates since they are independent of measurements. Residuals are generated as the difference between the analytical model outputs and measurements. Figures 5.5 and 5.4 demonstrate that the filter parameters adapt such that the estimates track the states very closely.
Measured Current
1

The current residual seems

Amps

0 -1 -2 1000 1500 2000 2500 3000

time [s]

Estimated Current
1

Amps

0 -1 -2 1000 1500 2000 2500 3000

time [s]

Current Residual
0.05

Amps

0

-0.05

1000

1500

2000

2500

3000

time [s]

Figure 5.4: CASE 1 - Reaction Wheel Current Estimation to indicate that during the fault period the current estimates are subject to more error, nonetheless the errors are fairly small. This increase in noise can be attributed to increased oscillations in the BEMF constant estimates that result in a slightly noisier current estimate. In Fig. 5.5 it can be seen that this also happens for the wheel speed. Regardless the algorithm is able to track the parameters fairly accurately as shown in Figs. 5.6 and 5.7.

5.1. FDI for Reaction Wheels
Measured Wheel Speed
20

99

rad/s

0

-20

1000

1500

2000

2500

3000

time [s]

Estimated Wheel Speed
20

rad/s

0

-20

1000

1500

2000

2500

3000

time [s]

Wheel Speed Residual
0.5

rad/s

0

-0.5

1000

1500

2000

2500

3000

time [s]

Figure 5.5: CASE 1 - Reaction Wheel Speed Estimation Notice that the bus voltage estimate does not contain any discernable fluctuations while the BEMF constant values change. This indicates that changes in the RW outputs due to BEMF constant faults do not resemble changes that would be observed if a bus voltage fault occurs. Fault detection and isolation occur instantaneously once the BEMF constant estimate deviates from its nominal value. Fault identification takes about 25 s. No false alarms are triggered in this case. A false alarm would be manifested as deviations in the estimates from the nominal values while in healthy modes, which does not occur here. However even if a false alarm did occur, this algorithm should eventually settle back to the true value. Thus for identification the estimates must be considered only when they have reached steady-state. The performance of the filter is presented in Tables 5.9 and 5.10. Excellent performance is obtained with the errors in the estimate on the order of 10-4 and mean errors on the order 10-5 . Performance of the bus voltage parameter estimation are shown in the next table. It is important to note that the bus voltage is also being estimated during the simulation and that its estimate can be affected by faults in the BEMF constant.

100

Chapter 5. Simulation Results of RW and CMG FDI Algorithm
Bus Voltage Actual
10

Volts

5

0

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Bus Voltage Estimate
10

Volts

5

0

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Bus Voltage Estimation Error
10

Volts

5 0 -5 0 500 1000 1500 2000 2500 3000 3500 4000

time [s]

Figure 5.6: CASE 1 - Bus Voltage Estimation
Back EMF Constant Actual
0.03

[V/rad/s]

0.02

0.01

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Back EMF Constant Estimate
0.04

[V/rad/s]

0.02

0

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Back EMF Constant Estimation Error
0.04

[V/rad/s]

0.02 0 -0.02 0 500 1000 1500 2000 2500 3000 3500 4000

time [s]

Figure 5.7: CASE 1 - BEMF Constant Estimation

5.1. FDI for Reaction Wheels time (s) t < 1000 1000  t < 2000 2000  t < 3000 t  3000 RMSE 1.038 × 10-4 1.42 × 10-4 1.79 × 10-4 1.04 × 10-4 ME -4.41 × 10-5 6.86 × 10-5 1.09 × 10-5 -2.64 × 10-5

101

Table 5.9: CASE 1 - Performance Indices of BEMF Constant Estimate time (s) t < 1000 1000  t < 2000 2000  t < 3000 t  3000 RMSE 0.0046 0.0379 0.0667 0.0044 ME -0.0044 -0.0354 -0.0651 -0.0042

Table 5.10: CASE 1 - Performance Indices of Bus Voltage Estimate

5.1.2

CASE 2: Incipient BEMF Constant Fault

Now the algorithm will be tested with a time-varying BEMF constant fault. From 400 s to 3500 s the BEMF constant will vary sinusoidally with an amplitude of 0.018 V /rad/s and frequency of 3.333 × 10-4 Hz, outside of this time period the BEMF constant will be at its nominal value. The filter performance in this case looks good as well. Figures 5.8 and 5.9 indicate that the estimates are able to track to the measurements of the RW. In fact to the naked eye it seems that the algorithm performs just as well in this case as in case 1. As expected the current residual grows for a period of time, however eventually it settles down. A key difference in this case lies in the wheel speed residual. It is more oscillatory in this case. This is because the algorithm is continuously tracking the parameter, and the adaptive mechanism does not get a chance to fully converge. The filter is capable of tracking the time-varying BEMF constant while the bus voltage remains relatively constant, again showing that the bus voltage estimate is not very sensitive to changes in the BEMF constant. Figures 5.10 and 5.11 demonstrate this. Looking at the BEMF constant estimation error it looks like the filter has a more difficult time tracking the estimate than in the case of instantaneous changes in the parameter value. This could be because the

102

Chapter 5. Simulation Results of RW and CMG FDI Algorithm
Measured Wheel Speed
20

rad/s

0 -20 -40 1000 1500 2000 2500 3000

time [s]

Estimated Wheel Speed
20

rad/s

0 -20 -40 1000 1500 2000 2500 3000

time [s]

Wheel Speed Residual
0.5

rad/s

0

-0.5

1000

1500

2000

2500

3000

time [s]

Figure 5.8: CASE 2 - Reaction Wheel Speed Estimation
Measured Current
1

Amps

0 -1 -2 1000 1500 2000 2500 3000

time [s]

Estimated Current
1

Amps

0 -1 -2 1000 1500 2000 2500 3000

time [s]

Current Residual
0.05

Amps

0

-0.05

1000

1500

2000

2500

3000

time [s]

Figure 5.9: CASE 2 - Reaction Wheel Current Estimation

5.1. FDI for Reaction Wheels

103

adaptive mechanism employs a moving window average of the residuals which would add some delay to the estimate. Hence with the parameter constantly varying in time it is not able to settle fully. In Fig. 5.7 there are spikes in the estimation error of the BEMF constant that correspond to the abrupt change in value of the parameter. In this case there is only one spike at the end of the faulty period when the parameter abruptly goes back to its nominal value. Thus filter performance improves when faults do not occur abruptly or intermittently. Fault detection and isolation occur instantaneously in this case as well as
Bus Voltage Actual
10

Volts

5

0

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Bus Voltage Estimate
10

Volts

5

0

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Bus Voltage Estimation Error
10

Volts

5 0 -5 0 500 1000 1500 2000 2500 3000 3500 4000

time [s]

Figure 5.10: CASE 2 - Bus Voltage Estimation the first, while identification occurs continuously as opposed to the previous case resulting in very good performance. This is confirmed by the performance indices shown in Tables 5.11 and 5.12. Although the BEMF constant estimation error seems to be more oscillatory in this case than in the previous one, the table above indicates that the accuracy of the BEMF constant estimate is very similar. Thus this filter can track the time-varying BEMF constant parameter as well as in the case of instantaneous faults. Again the performance of the filter for the bus voltage estimate is presented in Table 5.12 to see how the time-varying BEMF constant affects its estimation. The filter performance for the bus voltage estimate

104

Chapter 5. Simulation Results of RW and CMG FDI Algorithm
Back EMF Constant Actual
0.06

[V/rad/s]

0.04 0.02 0 0 500 1000 1500 2000 2500 3000 3500 4000

time [s]

Back EMF Constant Estimate
0.06

[V/rad/s]

0.04 0.02 0 0 500 1000 1500 2000 2500 3000 3500 4000

time [s]

Back EMF Constant Estimation Error
0.04

[V/rad/s]

0.02 0 -0.02 0 500 1000 1500 2000 2500 3000 3500 4000

time [s]

Figure 5.11: CASE 2 - BEMF Constant Estimation while a time-varying fault occurs in the BEMF constant is very similar to that of case 1. time (s) t < 400 400  t < 3500 t  3500 RMSE 1.12 × 10-4 3.84 × 10-4 1.33 × 10-4 ME -6.77 × 10-5 5.48 × 10-6 -4.41 × 10-5

Table 5.11: CASE 2 - Performance Indices of BEMF Constant Estimate

time (s) t < 400 400  t < 3500 t  3500

RMSE 0.005 0.037 0.0045

ME -0.0048 -0.0268 -0.0043

Table 5.12: CASE 2 - Performance Indices of Bus Voltage Estimate

5.1. FDI for Reaction Wheels

105

5.1.3

CASE 3: Mild Intermittent Bus Voltage Faults

Now the algorithm will be applied to a scenario where the bus voltage is subject to mild instantaneous faults in the time period from 1000 s to 4000 s, outside of this range the bus voltage is at its nominal 8 V. The wheel speed and current estimates and their associated residuals are shown in Figs. 5.12 and 5.13. The residuals are not severely affected by the mild bus voltage faults. Only in the current residual are there spikes corresponding to the instantaneous changes in current caused by the instantaneous changes in bus voltage. As opposed to cases 1 and 2, a bus voltage fault causes changes in both the wheel speed and current. This has ramifications for estimation in general. Because the bus voltage fault causes changes in both residuals the filter may mistaken it for a BEMF constant fault since it too causes a change in wheel speed. If a fault in one parameter was reflected as a change in only one residual then there would be no problem. Thus it can be expected that for larger bus voltage faults the BEMF constant estimate should be affected somewhat.
Measured Wheel Speed
20

rad/s

0 -20 -40 1000 1500 2000 2500 3000

time [s]

Estimated Wheel Speed
20

rad/s

0 -20 -40 1000 1500 2000 2500 3000

time [s]

Wheel Speed Residual
0.5

rad/s

0

-0.5

1000

1500

2000

2500

3000

time [s]

Figure 5.12: CASE 3 - Reaction Wheel Speed Estimation

106

Chapter 5. Simulation Results of RW and CMG FDI Algorithm

Measured Current
1

Amps

0 -1 -2 1000 1500 2000 2500 3000

time [s]

Estimated Current
1

Amps

0 -1 -2 1000 1500 2000 2500 3000

time [s]

Current Residual
0.05

Amps

0

-0.05

1000

1500

2000

2500

3000

time [s]

Figure 5.13: CASE 3 - Reaction Wheel Current Estimation

In terms of the parameter estimates the filter performs well in this case. Figures 5.14 and 5.15 demonstrate that the parameter estimates are very accurate based on estimation errors. The BEMF constant estimate is not affected much by the mild bus voltage faults. This is most likely because the faults are mild and do not cause large fluctuations in wheelspeed. For more severe faults it can be expected that the BEMF constant estimate will be affected more since the wheelspeed output will be subject to a larger change. Thus in this case the BEMF constant estimate is not very sensitive to bus voltage faults. For bus voltage estimation, spikes occur when the parameter changes instantaneously, however the filter quickly converges to the true value. As in previous cases fault detection and isolation is discerned quickly by taken the difference between the nominal parameter value and its estimate. Fault identification occurs about 25 s after each change in the parameter with no false alarms. One important indication of the filter performance in this case is how small of a change in bus voltage it can detect. At 3000 s the voltage changes by only 0.2 V and the filter is still able to track, thus even very small fluctuations are detectable. The

5.1. FDI for Reaction Wheels
Bus Voltage Actual
10

107

Volts

5

0

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Bus Voltage Estimate
10

Volts

5

0

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Bus Voltage Estimation Error
10

Volts

5 0 -5 0 500 1000 1500 2000 2500 3000 3500 4000

time [s]

Figure 5.14: CASE 3 - Bus Voltage Estimation
Back EMF Constant Actual
2

[V/rad/s]

1 0 -1 0 500 1000 1500 2000 2500 3000 3500 4000

time [s]

Back EMF Constant Estimate
0.04

[V/rad/s]

0.02

0

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Back EMF Constant Estimation Error
0.04

[V/rad/s]

0.02 0 -0.02 0 500 1000 1500 2000 2500 3000 3500 4000

time [s]

Figure 5.15: CASE 3 - BEMF Constant Estimation

108

Chapter 5. Simulation Results of RW and CMG FDI Algorithm

time (s) t < 1000 1000  t < 2000 2000  t < 3000 t  3000

RMSE 1.038 × 10-4 9.88 × 10-5 7.62 × 10-5 6.25 × 10-5

ME -4.41 × 10-5 -5.34 × 10-5 -1.61 × 10-5 -2.65 × 10-5

Table 5.13: CASE 3 - Performance Indices of BEMF Constant Estimate performance of the filter for this case is comparable to that of the previous cases, which is evident based on Tables 5.13 and 5.14. These tables clearly indicate that the filter's ability to estimate the BEMF constant is just as good as in all previous cases and is not greatly affected by small changes in bus voltage. For bus voltage the performance of the time (s) t < 1000 1000  t < 2000 2000  t < 3000 t  3000 RMSE 0.0046 0.0085 0.0117 0.0133 ME -0.0044 -0.0084 -0.0116 -0.0132

Table 5.14: CASE 3 - Performance Indices of Bus Voltage Estimate filter is very good. However it can be observed that the errors increase as the bus voltage decreases more and more. This is most likely an issue associated with increased non-linear behavior in the model as faults get worse. Consequently the quality of the estimates is directly proportional to the severity of the the faults.

5.1. FDI for Reaction Wheels

109

5.1.4

CASE 4: Severe Intermittent Bus Voltage Faults

Severe bus voltage faults will cause large changes in both wheel speed and current of the RW which should cause some visible deterioration of the BEMF constant estimate. Furthermore if Table 5.14 is any indication the quality of the bus voltage estimates should degrade. Since this in turn will affect the quality of the state estimates the BEMF constant should further degrade as well. The scenario constitutes a faulty period between 1000 s and 3000 s, with the bus voltage being at its nominal value outside this range. As expected Figs 5.16 and 5.17 show very large changes in wheel speed and current, along with large spikes in the residuals corresponding to large variations in the bus voltage. Looking at how much the RW states vary and how the filter is able to track these changes is a testament to how well the filter performs. Observing the parameter estimates in Figs. 5.18 and 5.19 will give a better idea of how the filter reacts to such large and abrupt changes in bus voltage. First it is evident that the filter is able to track these severe bus voltage faults without a problem. Spikes can be seen in the bus voltage estimation error corresponding to abrupt changes, however eventually the estimates settle down. As expected the BEMF constant estimate is affected by these large bus voltage faults. Again this is because large changes occur in the RW states that the filter thinks are being cause by a change in BEMF constant. Actually at the time of the faults both estimates diverge, here the filter bandwidth has increased so much that both estimates change. However as time wears on the estimates eventually settle to their true values. The filter essentially varies the estimates in the direction that minimizes the residual error, if it has two parameters to estimate it will vary these two parameters until its residual is near zero. This means that if there are too many parameters to estimate and not enough measurements the filter may settle to the wrong set of parameters. Although this would still allow say, a controller to reconfigure and provide good performance, the true parameter values would not be known. Fault detection occurs right away in this case, however because both parameters are affected isolation takes more time. Thus false alarms do occur during the transient phases of the estimates. To avoid false alarms one must wait until the parameters settle, then isolation and identification can be performed. In this case this corresponds to waiting about 100 s for the estimates to settle as opposed to about 25 s in the mild fault cases. Consequently it seems that the filter

110

Chapter 5. Simulation Results of RW and CMG FDI Algorithm
Measured Wheel Speed
50

rad/s

0 -50 -100 1000 1500 2000 2500 3000 3500

time [s]

Estimated Wheel Speed
50

rad/s

0 -50 -100 1000 1500 2000 2500 3000 3500

time [s]

Wheel Speed Residual
2

rad/s

0 -2 1000 1500 2000 2500 3000 3500

time [s]

Figure 5.16: CASE 4 - Reaction Wheel Speed Estimation
Measured Current
2

Amps

0 -2 -4 1000 1500 2000 2500 3000 3500

time [s]

Estimated Current
2

Amps

0 -2 -4 1000 1500 2000 2500 3000 3500

time [s]

Current Residual
Amps
0.2 0 -0.2 1000 1500 2000 2500 3000 3500

time [s]

Figure 5.17: CASE 4 - Reaction Wheel Current Estimation

5.1. FDI for Reaction Wheels

111

takes longer to track larger abrupt faults. The explanation lies in the manner in which the filter works. When the residuals become very large so does the filter bandwidth. The larger the bandwidth at the onset of a fault, the longer it takes the filter to find true parameter values. If entries in the Rk and Qk matrices were not limited, then the settling times would be the same in general. However because of the magnitude of the wheel speed residual, the forgetting factor would be very large and cause the filter to destabilize. Thus there exists a tradeoff between shorter settling times and stable operation. The performance of the filter for this case can be better understood by the performance indices in Tables 5.15 and 5.16. From Table 5.15 it is clear that besides causing spikes in the BEMF constant estimation
Bus Voltage Actual
10

Volts

5

0

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Bus Voltage Estimate
10

Volts

5

0

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Bus Voltage Estimation Error
10

Volts

5 0 -5 0 500 1000 1500 2000 2500 3000 3500 4000

time [s]

Figure 5.18: CASE 4 - Bus Voltage Estimation error when faults occur this estimate is not severely affected once the it settles, the errors are still very small. Thus after a waiting period of about 100 s there is no degradation to the estimate. For the bus voltage estimates, the performance indices in Table 5.16 indicate that the filter is still capable of estimating the parameter as accurately as in previous cases except for when the bus voltage is really low. Again the trend of increasing errors with large decreases in voltage is apparent, however these errors are certainly no cause for concern.

112

Chapter 5. Simulation Results of RW and CMG FDI Algorithm

Back EMF Constant Actual
2

[V/rad/s]

1 0 -1 0 500 1000 1500 2000 2500 3000 3500 4000

time [s]

Back EMF Constant Estimate
0.06

[V/rad/s]

0.04 0.02 0 0 500 1000 1500 2000 2500 3000 3500 4000

time [s]

Back EMF Constant Estimation Error
0.04

[V/rad/s]

0.02 0 -0.02 0 500 1000 1500 2000 2500 3000 3500 4000

time [s]

Figure 5.19: CASE 4 - BEMF Constant Estimation time (s) t < 1000 1000  t < 2000 2000  t < 3000 t  3000 RMSE 1.038 × 10-4 1.42 × 10-4 1.29 × 10-4 1.28 × 10-4 ME -4.41 × 10-5 -9.01 × 10-5 -1.13 × 10-4 -6.55 × 10-5

Table 5.15: CASE 4 - Performance Indices of BEMF Constant Estimate time (s) t < 1000 1000  t < 2000 2000  t < 3000 t  3000 RMSE 0.0046 0.0196 0.0263 0.0046 ME -0.0044 -0.0195 -0.0262 -0.0044

Table 5.16: CASE 4 - Performance Indices of Bus Voltage Estimate

5.1. FDI for Reaction Wheels

113

5.1.5

CASE 5: Incipient BEMF Constant Fault with Severe Intermittent Bus Voltage Faults

This case will test the ability of the filter to track variations in both the BEMF constant and bus voltage concurrently. No algorithm has been proposed that can perform this task for this application. According the the previous cases the filter should a more difficult time estimating parameters. The time-varying BEMF constant fault is the same as in case 2 and will be injected in the time period 500 s to 3500 s, otherwise it will be at its nominal value. Bus voltage faults will also occur during the same time period, outside of which the bus voltage will be at its nominal value. The maximum Rk and Qk values are lowered to 0.1 and 0.5 × 10-4 respectively because the task of estimating both parameters concurrently while they sustain faults causes the adaptive mechanisms to fluctuate more. Lowering these limits will cause the amplitudes of oscillations in the estimates to be smaller and keep the filter from instability. Current and wheel speed estimates and residuals are shown in Figs. 5.20 and 5.21. Evidently the faults cause large deviations in the states as would be expected based on previous cases. Still the algorithm is able to adapt the parameters and track the states. The wheel speed residual is affected much more than the current residual because it is more sensitive to BEMF constant and bus voltage variations. The largest fluctuations occur at the beginning of the fault period since at those times both parameters are faulted and the bus voltage changes are fairly large. Because both parameters are being faulted and the bus voltage faults are very severe, the non-linearities in the RW model are more prevalent and make it more difficult for the filter to converge. This is noticeable in the wheelspeed residual. Adding to the difficulty is the fact that the filter is continuously trying to track the the BEMF constant parameter while tracking the piecewise constant bus voltage parameter. Thus the bandwidth is not allowed to become too small. Current residuals do not vary much with variations in BEMF constant because changes in bus voltage are what affect it most. This is why the current residual only shows spikes when the bus voltage changes abruptly, otherwise it is not greatly affected. Another reason why the current residual is less oscillatory is that the variations in current are not as large as in the wheel speed.

114

Chapter 5. Simulation Results of RW and CMG FDI Algorithm
Measured Wheel Speed
50

rad/s

0 -50 -100 1000 1500 2000 2500 3000 3500

time [s]

Estimated Wheel Speed
50

rad/s

0 -50 -100 1000 1500 2000 2500 3000 3500

time [s]

Wheel Speed Residual
2

rad/s

0 -2 1000 1500 2000 2500 3000 3500

time [s]

Figure 5.20: CASE 5 - Reaction Wheel Speed Estimation
Measured Current
1

Amps

0 -1 -2 1000 1500 2000 2500 3000 3500

time [s]

Estimated Current
1

Amps

0 -1 -2 1000 1500 2000 2500 3000 3500

time [s]

Current Residual
Amps
0.2 0 -0.2 1000 1500 2000 2500 3000 3500

time [s]

Figure 5.21: CASE 5 - Reaction Wheel Current Estimation

5.1. FDI for Reaction Wheels
Bus Voltage Actual
10

115

Volts

5

0

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Bus Voltage Estimate
10

Volts

5

0

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Bus Voltage Estimation Error
10

Volts

5 0 -5 0 500 1000 1500 2000 2500 3000 3500 4000

time [s]

Figure 5.22: CASE 5 - Bus Voltage Estimation
Back EMF Constant Actual
0.06

[V/rad/s]

0.04 0.02 0 0 500 1000 1500 2000 2500 3000 3500 4000

time [s]

Back EMF Constant Estimate
0.06

[V/rad/s]

0.04 0.02 0 0 500 1000 1500 2000 2500 3000 3500 4000

time [s]

Back EMF Constant Estimation Error
0.04

[V/rad/s]

0.02 0 -0.02 0 500 1000 1500 2000 2500 3000 3500 4000

time [s]

Figure 5.23: CASE 5 - BEMF Constant Estimation

116

Chapter 5. Simulation Results of RW and CMG FDI Algorithm

By observing the parameter estimates a better understanding of the filter performance can be achieved. Figures 5.22 and 5.23 show the parameter estimates and their associated errors. The filter is able to track the parameters fairly well during the faulty period. Bus voltage estimation is very good compared to the BEMF constant estimation. This is expected because it has already been established that severe bus voltage fluctuations affect the BEMF constant estimate while in the opposite case this is not true. Bus voltage estimates are very clean as expected only having spikes at the times where the parameter value changes. When trying to understand why one estimate is more smooth than the other, it is important to note the orders of magnitude of the parameters in question. The AFF adapts based on the largest residual component, which in this case is the wheel speed residual. This is ok for the bus voltage estimation because it's values are large compared to that of the BEMF constant. Finer adjustments would result in a smoother BEMF constant because it is on the order of 10-3 , however in this case the filter will tend to make adjustments that are too large resulting in a more oscillatory estimate. To compensate somewhat for this the  parameter is used. The larger this parameter the smaller the order of magnitude of the AFF, which will lead to smaller adjustments to the estimates, however this also means the filter will converge slower. Consequently adjustment of this parameter is a tradeoff between fast convergence and robustness. Fault detection occurs right away as in previous cases, however similar to case 4 isolation and identification must be done once the parameter estimates have settled. In this case it takes about 100 s for the parameters to settle and therefore for identification to occur. In practice, once the estimates deviate from nominal values a period of about 100 s must be allowed for the parameters to settle before identification and isolation are performed. Performance indices for this case are shown in the tables below. Clearly the performance of the filter is degraded in this case, however this is a worst case scenario where bus voltage is fluctuating severely and BEMF constant is continuously varying. Considering the circumstances the filter estimates are actually fairly good and percentage errors are still small. As expected the bus voltage estimate gets worse the lower it gets, while the BEMF constant errors are larger when the wheel speed is varying quickly from 2500 s to 3500 s. As mentioned before this can be explained in terms of the

5.1. FDI for Reaction Wheels

117

time (s) t < 500 500  t < 1500 1500  t < 3500 t  3500

RMSE 3.34 × 10-4 9.82 × 10-4 0.0015 1.07 × 10-4

ME -9.94 × 10-5 -1.7388 × 10-4 1.82 × 10-4 5.84 × 10-5

Table 5.17: CASE 5 - Performance Indices of BEMF Constant Estimate

time (s) t < 500 500  t < 1500 1500  t < 3500 t  3500

RMSE 0.0059 0.4926 0.2242 0.0122

ME -0.0048 -0.1969 0.0066 -0.0121

Table 5.18: CASE 5 - Performance Indices of Bus Voltage Estimate nonlinearities becoming more prevalent, as well as the analytical model attempting to catch up with the measurements. Ultimately the filter performs the estimation function well, for fault identification however when the BEMF constant is continuously varying while severe bus voltage changes occur the data is not valid until the bus voltage parameter has settled. Consequently for FDI, once spikes occur in the residuals the estimates should be considered invalid until 100 s after they have been detected.

118

Chapter 5. Simulation Results of RW and CMG FDI Algorithm

5.1.6

CASE 6: Severe Intermittent BEMF Constant and Bus Voltage Faults

The final case to be run for the RW FDI consists of again attempting to estimate faults in both parameters, however now changes in one parameter occur out of phase with changes in the other parameter. Again it is expected that the BEMF constant will be affected by large fluctuations in bus voltage even when the estimate has settled, and that the bus voltage estimates will be fairly robust against changes in BEMF constant. It will be interesting to observe whether or not the filter performance improves however with the BEMF constant subject to instantaneous variations rather than continuous. The fault period begins at 500 s and ends at 3000 s, during this time the faults are injected into the RW system out of phase. Outside of this time range the parameters return to their nominal values. Again in this case the maximum values for the Rk and Qk matrices are lowered as in case 5. Figures 5.24 and 5.25 show the RW current and wheel speed during the simulation.
Measured Wheel Speed
50

rad/s

0

-50

1000

1500

2000

2500

3000

3500

time [s]

Estimated Wheel Speed
50

rad/s

0

-50

1000

1500

2000

2500

3000

3500

time [s]

Wheel Speed Residual
2

rad/s

0 -2 1000 1500 2000 2500 3000 3500

time [s]

Figure 5.24: CASE 6 - Reaction Wheel Speed Estimation

5.1. FDI for Reaction Wheels
Measured Current
1

119

Amps

0 -1 -2 1000 1500 2000 2500 3000 3500

time [s]

Estimated Current
1

Amps

0 -1 -2 1000 1500 2000 2500 3000 3500

time [s]

Current Residual
Amps
0.2 0 -0.2 1000 1500 2000 2500 3000 3500

time [s]

Figure 5.25: CASE 6 - Reaction Wheel Current Estimation The algorithm is able to correctly adapt the parameters such that the model estimates match the measurements. Spikes occur in the current residual when the bus voltage changes, while the wheel speed residual exhibits spikes when changes occur in either parameter. The parameter estimates and their associated errors are shown in Figs. 5.26 and 5.27. As expected the BEMF constant is sensitive to the faults in both parameters due to the severity of the faults, while the bus voltage estimate is only sensitive to changes in the bus voltage and is much cleaner. The filter has a more difficult time having to estimate both parameters when they have undergone severe faults, and this is evident in the amplitude of the spikes in the estimation error of the BEMF constant. A key observation from Figs. 5.26 and 5.27 is that the severity of the spikes in BEMF constant are proportional to the severity of the bus voltage fault. In terms of fault diagnosis, fault detection occurs instantaneously once again by simply comparing the estimates to the nominal parameter values. However fault isolation and identification can only be done once the estimates have settled, which takes about 100 s worst case as in case 5. Otherwise false alarms will occur. After the first fault detection, isolation, and identification, any subsequent spikes in the residuals indicate that the data should be ignored until the wait period of 100 s is over.

120

Chapter 5. Simulation Results of RW and CMG FDI Algorithm
Bus Voltage Actual
10

Volts

5

0

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Bus Voltage Estimate
10

Volts

5

0

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Bus Voltage Estimation Error
10

Volts

5 0 -5 0 500 1000 1500 2000 2500 3000 3500 4000

time [s]

Figure 5.26: CASE 6 - Bus Voltage Estimation

Back EMF Constant Actual
0.03

[V/rad/s]

0.02

0.01

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Back EMF Constant Estimate
0.04

[V/rad/s]

0.02

0

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Back EMF Constant Estimation Error
0.04

[V/rad/s]

0.02 0 -0.02 0 500 1000 1500 2000 2500 3000 3500 4000

time [s]

Figure 5.27: CASE 6 - BEMF Constant Estimation

5.1. FDI for Reaction Wheels Performance indices for this case are shown in the tables below,

121

time (s) t < 500 500  t < 1000 1000  t < 1500 1500  t < 2000 2000  t < 2500 2500  t < 3000 t  3000

RMSE 3.34 × 10-4 1.76 × 10-4 9.32 × 10-5 7.57 × 10-5 1.36 × 10-4 1.72 × 10-4 8.02 × 10-5

ME -9.94 × 10-5 -1.01 × 10-5 -7.15 × 10-5 1.43 × 10-5 -5.27 × 10-5 -8.18 × 10-5 1.26 × 10-5

Table 5.19: CASE 6 - Performance Indices of BEMF Constant Estimate

time (s) t < 500 500  t < 1000 1000  t < 1500 1500  t < 2000 2000  t < 2500 2500  t < 3000 t  3000

RMSE 0.0059 0.0682 0.0177 0.0159 0.0207 0.0255 0.0120

ME -0.0048 -0.0641 -0.0177 -0.0159 -0.0207 -0.0251 -0.0119

Table 5.20: CASE 6 - Performance Indices of Bus Voltage Estimate These results are not surprising given the previous cases. The filter estimates are very good once they have settled. Although the BEMF constant estimate is noticeably degraded when bus voltage deviates far from its nominal value. Again these indices are calculated when the estimates have reached steady state, during the transient periods the data is ignored. This and the previous case demonstrate the capability of the filter to monitor faults in both parameters concurrently.

122

Chapter 5. Simulation Results of RW and CMG FDI Algorithm

5.2

Robustness of RW FDI to Measurement Noise

This section will demonstrate the filter's robustness to measurement noise. Large measurement noise levels tend to muffle out small changes in the measurements thereby making it more difficult for the filter produce accurate estimates. Case 6 will be run from the RW FDI section with the increased measurement noise because this is the most challenging application due to the high non-linearity of the high fidelity RW model. If the filter performs well with severe faults then the other cases should be handled just as well. The following table lists simulation parameters for the medium noise case. Wheel Speed Noise Power Current Noise Power Sampling Period(Ts ) Simulation Time Window Size(N)  R0 Q0 P0 Qmax Rmax ^0 x  n 0.0065 dB -23.01 dB 0.01 s 4000 s 75 1 × 103 2 × 10-4 × I2×2 1 × 10-4 × I2×2 1 × 10-8 × I2×2 1 × 10-2 50 [8, 0.029]T -1 2

Table 5.21: Simulation Parameters for Medium Noise RW FDI Noticeable differences to the parameters are the  parameter and window size N .  is much larger in this case so that the bandwidth is not kept too wide. Because there is more noise in the measurements, a smaller bandwidth will filter out more of this noise. However decreasing  means that the filter will have a more difficult time tracking the parameters because of the smaller bandwidth. In particular the filter will produce biased estimates.

5.2. Robustness of RW FDI to Measurement Noise

123

This can be mitigated by increasing the residual moving average window size. As stated in chapter 4, the larger the window size the less biased the estimate will be. Another difference is the upper limits of the entries in the Qk and Rk matrices. These have been lowered to limit the amplitude of oscillations in these entries which can lead to large fluctuations in the estimates. Similar provisions must be made in the high noise case, the parameters are shown in the following table. Wheel Speed Noise Power Current Noise Power Sampling Period(Ts ) Simulation Time Window Size(N)  R0 Q0 P0 Qmax Rmax ^0 x  n 10 dB -13.01 dB 0.01 s 4000 s 50 1 × 105 2 × 10-1 × I2×2 1 × 10-4 × I2×2 1 × 10-8 × I2×2 5 × 10-3 5 [8, 0.029]T -1 2

Table 5.22: Simulation Parameters for High Noise RW FDI In this case the window size had to be made much larger because the high noise levels make it more difficult to extract the true mean of the residual.  was kept the same as the medium noise case because it was able to filter the noise out sufficiently. The upper limits of the Qk and Rk matrices are larger in this case because increased noise levels require that the noise covariance estimates possess relatively similar profiles to get a good picture of the noise environment and yield more accurate estimates. Results are presented in the following sections.

124

Chapter 5. Simulation Results of RW and CMG FDI Algorithm

5.2.1

Simulation Results for Medium Noise Levels

The filter performance is good in the presence of medium noise levels. Figs. 5.28 and 5.29 show the current and wheel speed estimates along with their associated residuals. Evidently
Measured Wheel Speed
0

rad/s

-20 -40 1000 1500 2000 2500 3000 3500

time [s]

Estimated Wheel Speed
20

rad/s

0 -20 -40 -60 1000 1500 2000 2500 3000 3500

time [s]

Wheel Speed Residual
40

rad/s

20 0 -20 1000 1500 2000 2500 3000 3500

time [s]

Figure 5.28: Medium Noise - Reaction Wheel Speed Estimation the residuals are noisier in this case compared to previous cases, especially the wheel speed residual, however good estimates are still obtained as shown in Figs. 5.30 and 5.31. It is clear that the accuracy of the bus voltage estimate is not greatly affected by measurement noise. The BEMF estimate however is much more noisy and sensitive to large changes in bus voltage, evident in Fig. 5.31 at the 1000 s mark. Due to the higher noise levels the filter bandwidth is smaller. Consequently settling times of the parameter estimates are longer. However it must be pointed out that these fault scenarios are extreme and would probably never happen in practice, and it can be assumed that performance would improve with less severe cases. Performance indices for this case are shown in Tables 5.23 and 5.24. Although the errors are slightly larger in this case, the performance of the filter is acceptable considering the severe faults and the presence of medium measurement noise power levels.

5.2. Robustness of RW FDI to Measurement Noise
Measured Current
1

125

Amps

0 -1 -2 1000 1500 2000 2500 3000 3500

time [s]

Estimated Current
1

Amps

0 -1 -2 1000 1500 2000 2500 3000 3500

time [s]

Current Residual
Amps
0.2 0 -0.2 1000 1500 2000 2500 3000 3500

time [s]

Figure 5.29: Medium Noise - Reaction Wheel Current Estimation
Bus Voltage Actual
10

Volts

5

0

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Bus Voltage Estimate
10

Volts

5

0

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Bus Voltage Estimation Error
10

Volts

5 0 -5 0 500 1000 1500 2000 2500 3000 3500 4000

time [s]

Figure 5.30: Medium Noise - Bus Voltage Estimation

126

Chapter 5. Simulation Results of RW and CMG FDI Algorithm
Back EMF Constant Actual
0.03

[V/rad/s]

0.02

0.01

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Back EMF Constant Estimate
[V/rad/s]
0.06 0.04 0.02 0 0 500 1000 1500 2000 2500 3000 3500 4000

time [s]

Back EMF Constant Estimation Error
0.05

[V/rad/s]

0

-0.05

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Figure 5.31: Medium Noise - BEMF Constant Estimation

time (s) t < 500 500  t < 1000 1000  t < 1500 1500  t < 2000 2000  t < 2500 2500  t < 3000 t  3000

RMSE 1.212 × 10-4 2.787 × 10-4 2.288 × 10-4 3.612 × 10-4 3.573 × 10-4 3.462 × 10-4 1.728 × 10-4

ME 3.759 × 10-6 -1.541 × 10-4 -1.36 × 10-4 -1.044 × 10-4 -2.083 × 10-4 -3.222 × 10-4 -5.366 × 10-5

Table 5.23: Medium Noise Power - Performance Indices of BEMF Constant Estimate

5.2. Robustness of RW FDI to Measurement Noise time (s) t < 500 500  t < 1000 1000  t < 1500 1500  t < 2000 2000  t < 2500 2500  t < 3000 t  3000 RMSE 0.0060 0.0172 0.0206 0.0189 0.0238 0.0344 0.013 ME -0.0058 -0.0170 -0.0205 -0.0189 -0.0237 -0.0343 -0.0128

127

Table 5.24: Medium Noise Power - Performance Indices of Bus Voltage Estimate Although the performance of the filter is degraded in this case, this is expected and it is clear that the parameters can be tracked with reasonable accuracy. As noise levels increase however, the filter will find it more and more difficult to track these parameters. In particular because as noise levels increase the filter bandwidth will have to decrease resulting in longer settling times. This case is studied in the next section.

5.2.2

Simulation Results for High Noise Levels

For high noise levels the performance of the filter was noticeably degraded compared to all previous cases as expected. Wheel speed and current measurements with associated residuals are shown in Figs. 5.32 and 5.33 respectively. In the first 1500 s it is clear that the filter has not locked on to the parameters yet. A quick look at Tables 5.25 and 5.26 verifies this. Errors are two orders of magnitude smaller after 1500 s. This is because the bandwidth of the system is smaller, consequently the hypothesis of the previous section is confirmed. Looking at plot of the AFF in the appendix will also confirm this. In cases where measurement noise levels are very large the filter must be run for a longer period of time at initially before it can perform well. However once it settles down the performance is reasonable albeit somewhat slower. At the onset of a change in parameter the filter begins to track, however the large noise levels cause large fluctuations in the residuals that cause the filter to think they are caused by parameter variations. Eventually the adaptive mechanism picks up the trend in the residual and is able to converge. The filter is very

128

Chapter 5. Simulation Results of RW and CMG FDI Algorithm
Measured Wheel Speed
50

rad/s

0

-50

1000

1500

2000

2500

3000

3500

time [s]

Estimated Wheel Speed
50

rad/s

0

-50

1000

1500

2000

2500

3000

3500

time [s]

Wheel Speed Residual
20

rad/s

0

-20

1000

1500

2000

2500

3000

3500

time [s]

Figure 5.32: High Noise - Reaction Wheel Speed Estimation
Measured Current
1

Amps

0 -1 -2 1000 1500 2000 2500 3000 3500

time [s]

Estimated Current
1

Amps

0 -1 -2 1000 1500 2000 2500 3000 3500

time [s]

Current Residual
Amps
0.2 0 -0.2 1000 1500 2000 2500 3000 3500

time [s]

Figure 5.33: High Noise - Reaction Wheel Current Estimation

5.2. Robustness of RW FDI to Measurement Noise

129

sensitive to any changes in the residual signal, thus even the smallest of disturbances or will lead to fluctuations in the estimates. Fluctuations in the BEMF constant estimate are more pronounced for reasons mentioned in the previous cases while the bus voltage estimate is affected to a lesser degree. In this particular simulation the onset of the bus voltage faults at 1000 s causes the BEMF constant estimate to fluctuate wildly, and it takes the filter approximately 250 s to settle down. The parameter estimates and the associated estimation errors are shown in the figures below. Figures 5.34 and 5.35 show that the

Bus Voltage Actual
10

Volts

5

0

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Bus Voltage Estimate
10

Volts

5

0

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Bus Voltage Estimation Error
10

Volts

5 0 -5 0 500 1000 1500 2000 2500 3000 3500 4000

time [s]

Figure 5.34: High Noise - Bus Voltage Estimation quality of the estimates is indeed degraded with the BEMF constant estimate being affected most. However if enough time is afforded to the filter at startup to settle down, it is clear by Tables 5.25 and 5.26 that the accuracy of the estimates is comparable to the previous case. According to these tables the algorithm performs well considering the high noise power levels. The errors in both estimates are fairly small after the 1500 s mark, however the settling time of the filter is higher that in any case with lower measurement noise levels. In the case that high noise levels are expected the filter should be run for at least 1500 s at start-up, and a wait period of 150 s should be allowed before identification and isolation

130

Chapter 5. Simulation Results of RW and CMG FDI Algorithm
Back EMF Constant Actual
0.03

[V/rad/s]

0.02

0.01

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Back EMF Constant Estimate
0.06

[V/rad/s]

0.04 0.02 0 -0.02 0 500 1000 1500 2000 2500 3000 3500 4000

time [s]

Back EMF Constant Estimation Error
0.05

[V/rad/s]

0

-0.05

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Figure 5.35: High Noise - Reaction Wheel Current Estimation time (s) t < 500 500  t < 1000 1000  t < 1500 1500  t < 2000 2000  t < 2500 2500  t < 3000 t  3000 RMSE 0.002 0.0022 0.0079 4.281 × 10-4 1.319 × 10-4 3.728 × 10-4 2.393 × 10-4 ME 0.0019 0.0018 0.0050 4.183 × 10-4 -7.597 × 10-6 3.368 × 10-4 -3.04 × 10-5

Table 5.25: High Noise Power - Performance Indices of BEMF Constant Estimate can be determined once parameters deviate from their nominal values. Performance can be expected to improve for less severe fault scenarios, however this case demonstrates clearly that the filter can provide fairly accurate estimates at various measurement noise levels with settling times being affected the most.

5.3. FDI for CMGs

131

time (s) t < 500 500  t < 1000 1000  t < 1500 1500  t < 2000 2000  t < 2500 2500  t < 3000 t  3000

RMSE 0.0329 0.0282 0.125 0.0265 0.0284 0.0265 0.0147

ME 0.0317 0.0256 -0.0629 -0.0263 -0.0283 -0.0262 -0.0138

Table 5.26: High Noise Power - Performance Indices of Bus Voltage Estimate

5.3

FDI for CMGs

The CMG FDI simulation is set up the same way as in Fig. 3.3 with the FDI algorithm being implemented in the steering logic block. Multiplicative faults are applied to the gimbal angle rates as follows,  =     0  pf =   0  0 ( 1 ho )  A cmg hpf  0 pf 2 0 0 0 0 pf 3 0  0    0   pf 4 0 (5.3b) (5.3a)

pf 1

where pf is the fault parameter matrix. Multiplicative faults are applied because they are more likely to resemble actual gimbal motor faults, additive faults are not very realistic because they would amount to the gimbal motor constantly rotating in which case no control would be possible. This method of FDI is selected because it can work regardless of the type of gimbal motor used. Multiplicative faults can indicate whether the bearing friction of the gimbal motors has increased. A well known case of CMG failure occurred in the ISS on June 8th 2002 when one of the units suffered a bearing failure. After investigating it was determined that the bearing lubricant was not being dispensed to the bearing fast enough resulting in increased wear of the bearing. An algorithm like this could have

132

Chapter 5. Simulation Results of RW and CMG FDI Algorithm

indicated before-hand that something was wrong with the system. Another capability of this algorithm is detection of a gimbal motor bearing lock which would be indicated by a fault parameter going to zero. In addition to detecting faults in the gimbal motor, the algorithm should also be able to determine if a fault has occurred in the flywheel motor. This problem can be easily approached by taking the difference between nominal wheel speed and measured wheel speed. Because wheel speed is constant, if it changes there is obviously a problem with the motor. A more intensive approach would be to use the RW FDI algorithm in chapter 4. Another advantage of this formulation is that because the Acmg matrix is not part of the AKF equations, if singularities in the steering logic occur the filter should not be in jeopardy of going unstable. A further advantage to this approach is the fact that the problem is not very non-linear since the fault parameters are simply multiplied against the commanded gimbal angle rates. Having said that the AKF will be applied to this problem. A flow diagram of this FDI approach is shown in Fig. 5.36.

Figure 5.36: CMG FDI Simulation Flow The measurements are simulated with -30 dB of noise. The steering logic determines the required gimbal angle rates, these rates are then applied to the CMG hardware model, after which the hardware will output its actual gimbal rates. During the healthy mode the hardware will match the commanded gimbal angle rates, and in the faulty mode the hardware will output its faulty angle rates. In the steering logic block, the commanded gimbal angle rates are multiplied by the estimated fault parameters. The difference between

5.3. FDI for CMGs the hardware and estimated faulty outputs constitutes the residual signal m - ^  = m - x c ^ p rk =  

133

(5.4)

 match the Thus the filter will adapt the fault parameters until the estimated gimbal rates ^   m . In other words, the measurement/output equation here is the measured gimbal rates  steering logic equation 5.3a hence the weakly non-linear nature of the problem. Contrary to the AUKF algorithm employed in the previous section, a measurement matrix must be defined for the AKF. According to Eq. (5.3a) the measurement matrix can be obtained by  with respect to pf resulting in taking the partial derivative of    Hk = =  pf ( 1 ho )  A cmg h (5.5)

The CMG system is simulated using the same parameters as in Tables 3.6 and 3.7, while the FDI algorithm parameters are initialized as in Table 5.27. Faults are injected into the Sampling Period(Ts ) Simulation Time Window Size(N)  R0 Q0 P0 Qmax Rmax ^0 x 0.01 s 1000 s 50 100 1 × 10-5 × I4×4 1 × 10-5 × I4×4 1 × 10-5 × I4×4 1 5 [1, 1, 1, 1]T

Table 5.27: Simulation Parameters for CMG FDI system at the 100 s mark according to the table below. The CMG system is commanded to perform a sinusoidal maneuver about the pitch axis with an amplitude of 90


and

frequency 0.005 Hz for the first 500 s, after which the same profile is applied to the roll axis. This is done because when actuation is applied about the pitch axis only units 2 and 4 actuate noticeably, meaning that the algorithm will have a hard time determining the

134

Chapter 5. Simulation Results of RW and CMG FDI Algorithm

faulty parameters of units 1 and 3 because they are not very active. Performing a roll-axis maneuver requires that units 1 and 3 actuate more whereby the algorithm will be better able to estimate their fault parameters. Fault Parameter pf 1 pf 2 pf 3 pf 4 Value 0.5 0.8 0.3 0.9

Table 5.28: CMG Fault Parameters The spacecraft attitude plots are shown in Fig. 5.37. Note the maneuver first about the pitch-axis and then about the roll-axis. Figures 5.38-5.41 below show the commanded and
X-Axis(Roll) Quaternion Component 1 1 Y-Axis(Pitch) Quaternion Component

0.5

0.5

0

0

-0.5

-0.5

-1

0

200

400 600 time [s]

800

1000

-1

0

200

400 600 time [s]

800

1000

Z-Axis(Yaw) Quaternion Component 1 1 0.95 0.5 0.9 0 0.85 0.8 -0.5 0.75 -1 0 200 400 600 time [s] 800 1000 0.7 0

Real Quaternion Component(q4)

200

400 600 time [s]

800

1000

Figure 5.37: CMG FDI - Attitude Quaternion measured gimbal rates, the associated residual, and the fault parameter estimate for each CMG gimbal unit. The filter is able to estimate all four parameters such that the residuals remain near zero for the most part.

5.3. FDI for CMGs
Unit 1 - Measured Gimbal Rate
20 20

135
Unit 1 - Commanded Gimbal Rate

10

10

deg/s

0

deg/s
0 200 400 600 800 1000

0

-10

-10

-20

-20

0

200

400

600

800

1000

time [s] Unit 1 - Residual
20 15 10 1.2 1 0.8 5 0.6 0 -5 -10 0 200 400 600 800 1000 0.4 0.2

time [s] Unit 1 - Fault Parameter VS Actual Parameter
estimate true

deg/s

0

200

400

600

800

1000

time [s]

time [s]

Figure 5.38: CMG FDI - Unit 1
Unit 2 - Measured Gimbal Rate
20 20

Unit 2 - Commanded Gimbal Rate

10

10

deg/s

0

deg/s
0 200 400 600 800 1000

0

-10

-10

-20

-20

0

200

400

600

800

1000

time [s] Unit 2 - Residual
60 40 20 1.4 1.2 1 0 0.8 -20 -40 -60 0 200 400 600 800 1000 0.6 0.4

time [s] Unit 1 - Fault Parameter VS Actual Parameter
estimate true

deg/s

0

200

400

600

800

1000

time [s]

time [s]

Figure 5.39: CMG FDI - Unit 2

136
20

Chapter 5. Simulation Results of RW and CMG FDI Algorithm
Unit 3 - Measured Gimbal Rate
20

Unit 3 - Commanded Gimbal Rate

10

10

deg/s

0

deg/s
0 200 400 600 800 1000

0

-10

-10

-20

-20

0

200

400

600

800

1000

time [s] Unit 3 - Residual
30 20 1 1.5

time [s] Unit 3 - Fault Parameter VS Actual Parameter
estimate true

deg/s

10 0 0.5 -10 -20 0

0

200

400

600

800

1000

0

200

400

600

800

1000

time [s]

time [s]

Figure 5.40: CMG FDI - Unit 3
Unit 4 - Measured Gimbal Rate
20 20

Unit 4 - Commanded Gimbal Rate

10

10

deg/s

0

deg/s
0 200 400 600 800 1000

0

-10

-10

-20

-20

0

200

400

600

800

1000

time [s] Unit 4 - Residual
20 1.2 1.1 0 1

time [s] Unit 4 - Fault Parameter VS Actual Parameter
estimate true

deg/s

-20

0.9 0.8

-40 0.7 -60 0 200 400 600 800 1000 0 200 400 600 800 1000

time [s]

time [s]

Figure 5.41: CMG FDI - Unit 4

5.3. FDI for CMGs

137

Only during the change in maneuver at 500 s and when singularities occur does the residual fluctuate wildly. Observing the parameter estimates, parameters fp1 and fp3 are very noisy for the first 500 s because there is very little movement in the gimbal motors and the filter has a hard time determining the faults in those units. Units 2 and 4 however are relatively smooth because they are actuating. At the 500 s when the maneuver changes there are large spikes in the estimates and residuals because of the sudden change in commanded gimbal rates. Afterwards the four estimates settle down. Thus the filter is fairly robust to sharp changes in gimbal angle rates. Spikes observed after the 500 s mark are due to large gimbal angle rate fluctuations because of singularities in the steering logic, as demonstrated by the singularity measure in Fig. 5.42.In the beginning of this section it was mentioned that the algorithm should not destabilize when singularities occur, according to these figures it is obvious that the filter performs well. Thus the algorithm is robust to sharp fluctuations in gimbal rates as well as singularities. Performance indices for the estimates are calculated between 200 s and 400 s and 900 s to 1000 s when the estimates have settled thus excluding any of the transient periods due to singularities. The results are in Tables 5.29 and 5.30. Notice that the estimates for fp1
Singularity Measure
1.4

1.2

1

0.8

0.6

0.4

0.2

0

0

100

200

300

400

500

600

700

800

900

1000

time [s]

Figure 5.42: CMG FDI Singularity Measure and fp3 are better during the second half of the simulation when the gimbal rates are more active. Conversely the estimates for units fp2 and fp4 are better during the first half of the

138

Chapter 5. Simulation Results of RW and CMG FDI Algorithm time (s) 200  t  400 900  t  1000 fp1 0.0146 0.0012 fp2 0.0033 0.0021 fp3 0.0121 0.0019 fp4 0.0014 0.0027

Table 5.29: CMG FDI RMSE time (s) 200  t  400 900  t  1000 fp1 -0.0101 -8.98 × 10-4 fp2 -0.0015 -6.83 × 10-4 fp3 0.0024 -0.0018 fp4 -5.51 × 10-4 -0.0021

Table 5.30: CMG FDI ME simulation when those gimbal rates are more active. Thus a rather intuitive implication is that for the filter to perform well the observable outputs should be non-zero, otherwise the algorithm can not know if anything is faulty. In terms of the FDI performance of the algorithm, fault detection does not occur immediately. If the system is healthy and singularities occur, spikes will occur in the estimates. To avoid false alarms one must wait about 100 s for the estimates to settle, at this time isolation and identification may also be performed. This is similar to the RW FDI algorithm when faults in one parameter caused fluctuations in the other.

5.4. System Identification of RW Hardware

139

5.4

System Identification of RW Hardware

During the development of this algorithm the SSDC lab has been working on a low cost nanosatellite RW design. The module is shown in the figure below. The motor shown in

Figure 5.43: Nanosatellite RW Module the diagram is a Portescap NuvoDisc 32BF BLDC motor. The module will perform voltage controlled wheel speed control meaning that an accurate model of the motor is necessary. A simple circuit diagram of the motor is shown below.

Figure 5.44: Simple DC Motor Circuit The equation describing this circuit is ea = eR + eL - eBEM F = Ri + L di - km  dt
rad

(5.6) /s , R is the

where i is the motor current in Amperes,  is the angular rotation rate in

armature resistance in , L is the armature inductance in H , and km is the BEMF constant in V /rad/s . The mechanical model of the BLDC motor is defined in the following equation. net = m - f Jw   = kt i - Tv  (5.7a) (5.7b)

140

Chapter 5. Simulation Results of RW and CMG FDI Algorithm

where Jw is the MOI of the rotor plus flywheel with units kg · m2 , kt is the torque constant with units
N·m

/A and has the same value as the BEMF constant when both are expressed

in SI units, and Tv is the coefficient of viscous friction. Most of the parameters in these equations are provided in the data sheet for this motor, they are listed in the following table. Since the inductance term in Eq. (5.7a) is so small, it can be neglected. Then Parameter R L km , kt Jw Value 3.7  0.36 mH 0.0078 V /rad/s ,
N ·m

/A

1 × 10-5 kg · m2

Table 5.31: Portescap Nuvodisc 32BF solving for the current and substituting into Eq. (5.7b) the following equation is obtained, ( ) km kt Tv km   =- + + ea (5.8) Jw R Jw Jw R Except for the coefficient of viscous friction the data sheet provides the required parameters for the model. This sparked the need for a way to identify the coefficient, and the algorithm in chapter 4 was applied to the problem. Re-writing Eq. (5.8) as   = A + Bea (5.9)

The task of the algorithm is to estimate the A and B parameters using only a speed measurement. The residual will be computed as the difference between the model in Eq. (5.9) and the measured wheel speed. Motor parameters are initialized with the values in Table 5.31 with Tv set to 0. The simulation parameters for this case are in Table 5.32. The measurements are sampled at T s = 0.04 s and the  parameter is very large here because the Rk matrix has very large entries on the order of 103 to 105 . The Rk matrix entries are very large because after many runs it was determined that the performance was best. In the case faults are present the Rk and Qk matrices would change abruptly which could lead to instability. This is why the magnitudes of the entries in the matrices are limited for the FDI cases but not in this case. The initial estimates are initialized to zero to demonstrate

5.4. System Identification of RW Hardware Sampling Period(Ts ) Simulation Time Window Size(N)  R0 Q0 P0 Qmax Rmax ^0 x 0.04 s 320 s 5 1 × 107 1 × 10-5 × I4×4 1 × 10-5 × I4×4 1 × 10-5 × I4×4 [0, 0]T

141

Table 5.32: Simulation Parameters for Portescap Systems Identification the capabilities of the filter in the case that no parameters are known. Instead of measuring a particular parameter, entire coefficients are estimated. The coefficient of viscous friction Tv will be calculated from the estimated A coefficient as follows. Tv = -Jw A - km kt R (5.10)

The voltage profile in Figure 5.45 was applied to the motor.
Applied Voltage
5 4 3 2 1

Volts

0 -1 -2 -3 -4 -5 0 5 10 15 20

time [s]

Figure 5.45: Applied Voltage Profile

142

Chapter 5. Simulation Results of RW and CMG FDI Algorithm
A Coefficient
1 300 250 0 200 -1 150 100 -2 50 0 0 50 100 150 200 250 300 0 50 100 150 200 250 300

B Coefficient

-3

time [s] Measured Wheel Speed
500 500

time [s] Estimated Wheel Speed

Rad/s

0

Rad/s
0 50 100 150 200 250 300

0

-500

-500

0

50

100

150

200

250

300

time [s]

time [s]

Figure 5.46: System Identification Results
Residual
100 80 60 40 20

Rad/s

0 -20 -40 -60 -80 -100 0 50 100 150 200 250 300 350

time [s]

Figure 5.47: System Identification: Residual

5.4. System Identification of RW Hardware

143

This voltage profile along with the measured wheel speed were used in the simulation to obtain the results in Figures 5.46 and 5.47. Identification was a success even under the assumption that the motor coefficients were unknown. The residual errors are large in Fig. 5.47 due primarily to the fact that current data has not been incorporated into the model and simulation, as well as the fact that viscous friction is actually a non-linear phenomenon while here it is being modeled as a linear quantity. However the filter still provides a best estimate of the motor dynamics which is close to the expected values. The results of the estimation are presented in Table 5.33. The coefficients are estimated within about 100 s of Coefficient A B Tv Value -1.71 208.13 6.95 × 10-7
N ·m

/rad/s

Table 5.33: Portescap System Identification Results the start of the simulation and yield reasonable results. The resulting coefficient of viscous friction calculated from the estimate of the 'A' coefficient is reasonable considering the size of the motor and bearing characteristics. A value close to this estimate was obtained by spinning the motor up to 500 rad /s , and then applying no actuation or commutation so that the motor decelerates until it reaches zero wheel speed. The idea being that deceleration is only caused by the viscous friction component. This same procedure could has been applied online with this motor with the same results.

144

Chapter 5. Simulation Results of RW and CMG FDI Algorithm

5.5

Conclusions

The FDI algorithm presented in chapter 4 and verified in this chapter has proven to perform well in a wide-range of scenarios and applications. Some key aspects of the filter performance are listed below. Concurrent Fault Diagnosis and Identification : This algorithm is able to diagnose more than one type of fault concurrently. This is important in case there is more than one faulty component in a system. However the number of parameters that can be estimated is limited by the number of available measurements. In a system with 'm' measurements available, if the size of the estimation vector n > m the filter will yield biased estimates since in under-determined systems various combinations of parameters can yield similar results. In essence there would not be enough degrees of freedom in the system for unbiased estimation to take place. Systems Identification : The filter structure makes it ideal for systems identification of unknown plants. For this method to work, the structure of the equations must be known, such as how many inputs and outputs comprise the system. Since systems identification consists of estimating entire coefficients rather than selective parameters, the problem of under-determination is mitigated so long as each system equation has a corresponding measurement. For example the previous section estimated two parameters with only one measurement, however the two parameters are part of a single equation whose output measurement is available. For non-linear systems this problem becomes much more challenging because the coefficients are by definition time-varying. Measurement Noise : Kalman filters operate on the premise that measurement noise exists in the measurements. Consequently if there is practically no measurement noise then filter performance will degrade. Furthermore, the filter must be tuned for different levels of measurement noise. High noise levels will usually require that the filter bandwidth be decreased so that sudden fluctuations are dampened. A larger window size allows the filter to better extract the true mean of the residual errors and yield unbiased estimates. However if it is too large then the filter settling time will be

5.5. Conclusions

145

large and tracking will not be slower. The larger  parameter desensitizes the filter to fluctuations caused by high noise levels resulting in less oscillatory estimates. If this parameter is too large however, tracking will be very slow as the filter bandwidth will be very small. These parameters must be tuned carefully to yield optimal performance. In practice the best approach would be to design the filter for the expected worst-case measurement noise levels so that the filter operates well in all cases. Input Signal Profile : Depending on the frequency and profile of input trajectory the filter must be tuned accordingly. Higher frequency inputs result in higher frequency outputs. In response to high frequency inputs window size N and the parameter  cannot be too large, otherwise the filter response will be too slow to extract the system behavior from the residuals. If the bandwidth of the filter is too small with respect to the system signal frequencies then tracking will not be possible and unbiased estimates will result. Consequently tuning is important in this case as well, the parameters cannot be too small or too large or unbiased estimates will result. Sampling Time : Slower sampling frequencies will result in lower filter performance. This is because at lower sampling frequencies more happens to the spacecraft attitude that is not accounted for in the filter which can cause the filter to lose tracking. For any given case if a slower sampling frequency is used then the window size must be decreased. This is because at lower sampling times a smaller number of recursive iterations are required to cover a particular time interval. The window size should remain fairly consistent in terms of time. In other words a window length of 100 at 100 Hz is 1 s long, to keep it 1 s long then the window length at 10 Hz should be 10. Finally, the  parameter should be made relatively larger for slower sampling frequencies. This is required to desensitize the filter to some of the increased modeling uncertainty.

Chapter 6

Conclusions

This thesis approached the problems of picosatellite CMG cluster design and fault diagnosis for RWs and CMGs. Picosatellite active actuator development is still in its infancy, notincluding the use of MTRs, and still requires improvements and added emphasis. Only recently has a satellite been launched with full three-axis control using RWs. The BeeSat satellite was developed at the Berlin Institute of Technology to demonstrate the potential of using RWs in picosatellites. Reasons for the lack of interest and investment in picosatellite actuator technologies were presented in chapter 1, and are primarily related to the small volume/power/mass budgets associated with them. Most space-proven payloads consume too much power or weigh too much to be implemented in cubesats. This is because they have primarily been geared towards micro and nano satellite classes. Up to now mainly passive ACS systems are employed in these satellites because they consume little power and usually provide enough pointing for their associated payloads. Right now cubesat development is being approached primarily by academia thanks to their associated low costs and development times. Cubesat development has only been around since the development of the cubesat standard in 1999, thus it is relatively young. As payload and actuator technologies improve it is the author's opinion that picosatellites will eventually become attractive to commercial entities. One of the goals of this thesis was to show that a picosatellite CMG cluster using COTS components is feasible for precise three-axis attitude pointing given currently available technologies. Another goal was to develop an algorithm that could diagnose and identify faults in the actuators of a satellite ACS.

148

Chapter 6. Conclusions

6.1

Summary of Contributions

The major contributions of this thesis are the development of a CMG FDI methodology, the design of a novel KF algorithm to perform parameter estimation for both linear and non-linear systems for purposes of fault diagnosis, as well as a CMG cluster design to demonstrate the feasibility of active control in picosatellites. Online fault diagnosis is of special concern to mission and safety critical missions in space to avoid costly oversights and perhaps save human lives. The algorithm developed in chapter 4 enhances the current body of work available for online FDI and systems identification. Development of picosatellite actuators will continue to attract more research dollars as new innovative technologies are developed. Research here at SSDC group is being focused towards enhancing picosatellite technologies as well as increasing the reliability of these actuators with FDI techniques.

6.1.1

Picosatellite CMG Cluster Design

The proposed CMG design demonstrates fairly well that it is possible to design one that fits into a picosatellite while not overwhelming the mass/power/volume budget of the satellite and providing sufficient performance to control the satellite. The design comes in under 100 g, occupies less than 25 % of the satellite volume, and consumes less than 1.5 W and 1 W peak and average power respectively. The motors that have been specified are the key components of this technology thanks to their small size and low power consumption. With a CMG cluster available to prospective picosatellite users, an increase in potential for their use in a wider variety of missions can be realized.

6.1.2

Novel Adaptive Kalman Filters

The AKF/AUKF performs parameter estimation by estimating the measurement and process noise covariances with a residual adaptive estimation(RAE) approach, and also uses an adaptive forgetting factor(AFF) to control when the filter is sensitive to new data. Combined, these simple mechanisms yield a filter that can track changes in the parameters of any general system. This has been shown for a highly non-linear RW system as well as a CMG system via numerical simulation in Matlab/Simulink. An example of systems

6.1. Summary of Contributions

149

identification is also demonstrated using hardware data from a RW prototype being developed at SSDC group. Depending on measurement noise levels, input signal trajectory, and sampling time, the filter parameters N ,  , Qmax , and Rmax must be tuned appropriately otherwise divergence will ensue. The FDI portion of the algorithm consists of comparing the parameter estimates to their nominal values. If the estimates begin to diverge then data should be ignored for at least 100 s after which it can be determined if a fault has occurred and isolation and identification can follow. Overall the algorithm functions well in the presence of various types of faults, and is able to provide isolation and identification in the presence of large noise power levels although with degraded quality in the estimates.

6.1.3

FDI for CMGs

Multiplicative faults are injected into each of the CMG gimbal units angular rotation rates to simulate increased friction losses in the gimbal motors. Simulated gimbal-rate measurements are then compared to commanded gimbal rates generated by steering logic to form a residual vector. Based on these residuals the measurement and process noises are estimated and the AFF is adapted. The parameter estimates vary until residuals approach their nominal values and the true multiplicative parameter values have been determined. In order to determine if the flywheel motor is faulty, a residual is formed as the difference between flywheel speed measurements and the expected nominal value of the flywheel speed. Any sustained fluctuations in this residual are indicative of problems with the flywheel motor. However this problem was not addressed in this thesis due to its trivial nature. The performance of the filter is verified by an attitude control simulation in Matlab/Simulink for a satellite that houses a 4SGCMG cluster in a pyramid configuration for attitude control.

150

Chapter 6. Conclusions

6.2
6.2.1

Future Work
Picosatellite CMG Cluster Design

To complete this work there is more design that must be completed followed by manufacturing and testing to verify performance claims in terms of attitude pointing and power consumption. The circuit design for telemetry, motor drivers, and the serial interface must be completed as well as the software to operate the system. The CAD model must be enhanced to include all these components including wiring harnesses and connectors as well as other miscellaneous parts. Then manufacturing and testing can proceed.

6.2.2

Novel Adaptive Kalman Filters

In response to the conclusions of chapter 5 an automated tuning procedure for the N ,  , Qmax , and Rmax parameters is required. This will make the algorithm easier to implement and provide better performance. Furthermore, work must be done to improve the performance of the algorithm for slow sample frequencies, very large noise levels, and different forms of input signal profiles.

Bibliography
[A. H. Mohamed 1999] A. H. Mohamed, K. P. Schwarz, "Adaptive Kalman filtering for INS/GPS," Journal of Geodesy, Vol. 73, No. 4, May, 1999, Pages: 193­203. 82 [A. Joshi & Khorasani 2008] A. Joshi, V. Gavriloiu, A. Barua A. Garabedian P. Sinha, & Khorasani, K., "Intelligent and Learning-based Approaches for Health Monitoring and Fault Diagnosis of RADARSAT-1 Attitude Control System," IEEE International Conference on Systems, Man and Cybernetics, 2008, Pages: 3177­3183. 85 [Abramson 1970] Abramson, P. D. "Simultaneous Estimation of the State and Noise Statistics in Linear Dynamical Systems," . Tech Report R-332, NASA, Mar, 1970. 79 [Ahmed El-Mowafy 2005a] Ahmed El-Mowafy, Ahmed Mohamed, "Attitude Determination from GNSS Using Adaptive Kalman Filtering," The Journal of Navigation, Vol. 58, No. 1, Jan., 2005, Pages: 135­48. 17 [Ahmed El-Mowafy 2005b] Ahmed El-Mowafy, Ahmed Mohamed, "Attitude Determination from GNSS Using Adaptive Kalman Filtering," The Journal of Navigation, Vol. 58, 2005, Pages: 135­148. 83 [Alfred W. Fuxjaeger 1994] Alfred W. Fuxjaeger, Ronald A. Iltis, "Adaptive Parameter Estimation using Parallel Kalman Filtering for Spread Spectrum Code and Doppler Tracking," IEEE Transactions on Communications, Vol. 42, No. 6, June, 1994, Pages: 2227­2230. 83 [Alger 2006] Alger, Michael William Richard. DESIGN AND DEVELOPMENT OF

POWER AND ATTITUDE CONTROL SUBSYSTEMS FOR RYESAT. Master's thesis, Ryerson University, 2006. 25, 26, 32, 45, 46 [A.M. Benkouider 2008] A.M. Benkouider, J.C. Buvat, J.M. Cosmao A. Saboni, "Fault detection in semi-batch reactor using the EKF and statistical method," Journal of Loss Prevention in the Process Industries, Vol. 22, 2008, Pages: 153­161. 57

152

Bibliography

[Amitabh Barua 2009] Amitabh Barua, Purnendu Sinha, Khashayar Khorasani, "A diagnostic tree approach for fault cause identification in the attitude control subsystem of satellites," IEEE Transactions on Aerospace and Electronic Systems, Vol. 45, No. 3, July, 2009, Pages: 983­1002. 18 [ams 2010] "Information about the Cubesat Program," , August, 2010. xix, 5 [Angeli 2008] Angeli, C., "Online expert systems for fault diagnosis in technical processes," Expert Systems, Vol. 25, No. 2, May, 2008, Pages: 115­132. 16 [B. K. Walker 1995] B. K. Walker, Kuang-Yang Huang, "FDI by Extended Kalman Filter Parameter Estimation for an Industrial Actuator Benchmark," Control Engineering Practice, Vol. 3, No. 12, 1995, Pages: 1769­1774. 73 [B. Wie & Arapostathis 1989] B. Wie, H. Weiss, & Arapostathis, A., "Quaternion Feedback Regulator for Spacecraft Eigenaxis Rotations," Journal of Guidance, Control, and Dynamics, Vol. 12, No. 3, May-June, 1989, Pages: 375­380. 27, 32, 33 [Bialke 1998] Bialke, B., "High fidelity mathematical modeling of reaction wheel performance," 21st Annual American Astronautical Society Guidance and Control Conference, 1998, Pages: 483­496. 35, 36 [Bong Wie 2001] Bong Wie, David Bailey, Christopher Heiberg, "Singularity Robust Steering Logic for Redundant Single-Gimbal Control Moment Gyros," Journal of Guidance, Control, and Dynamics, Vol. 24, No. 5, Sept.-Oct., 2001, Pages: 865­872. 52, 53 [C. Hajiyev 2000] C. Hajiyev, F. Caliskan, "Sensor/actuator fault diagnosis based on statistical analysis of innovation sequence and robust Kalman filtering," Aerospace Science and Technology, Vol. 4, No. 6, Sept., 2000, Pages: 415­422. 83 [C. M. Trudinger 2008] C. M. Trudinger, M. R. Raupach, P. J. Rayner I. G. Enting, "Using the Kalman filter for parameter estimation in biogeochemical models," Environmetrics 2008, Vol. 19, 2008, Pages: 849­870. 70, 71, 73

Bibliography

153

[Cheryl C. Qu 2009] Cheryl C. Qu, Juergen Hahn, "Process monitoring and parameter estimation via unscented Kalman filtering," Journal of Loss Prevention in the Process Industries, Vol. 22, 2009, Pages: 703­709. 76 [Chetouani 2008] Chetouani, Yahya, "Using the Kalman Filtering for the Fault Detection and Isolation (FDI) in the Nonlinear Dynamic Processes," INTERNATIONAL JOURNAL OF CHEMICAL REACTOR ENGINEERING, Vol. 6, 2008, Pages: Article A43 (pp. 1­22). 64 [Cheung & Stephanopoulos 1990] Cheung, J.T., & Stephanopoulos, G., "Representation of process trends - Part 1. A formal representation framework," Computers and Chemical Engineering, Vol. 14, No. 4/5, 1990, Pages: 495­510. 12 [Christopher Hide & Smith 2003] Christopher Hide, Terry Moore, & Smith, Martin, "Adaptive Kalman Filtering for Low-cost INS/GPS," The Journal of Navigation, Vol. 56, No. 1, Jan., 2003, Pages: 143­152. 17, 83, 86, 87 [Chuei-Tin Chang 1995] Chuei-Tin Chang, Jen-Wen Chen, "Implementation issues concerning the EKF-based fault diagnosis techniques," Chemical Engineering Science, Vol. 50, No. 18, Sept, 1995, Pages: 2861­2882. 65 [Crisan 2002] Crisan, D., "A survey of convergence results on particle filtering methods for practitioners," IEEE Transactions on Signal Processing, Vol. 50, No. 3, 2002, Pages: 736­746. 65 [D. Sinclair 2010] D. Sinclair, C. C. Grant, R. E. Zee, "Developing, Flying and Evolving a Canadian Microsatellite Reaction Wheel ­ Lessons Learned," 15th CASI Astronautics Conference, Toronto, Ontario, 2010. 49 [E. Chow 1984] E. Chow, A. Willsky, "Analytical redundancy and the design of robust failure detection systems," IEEE Transactions on Automatic Control, Vol. 29, No. 7, 1984, Pages: 603­614. 15, 85 [E. Sobhani-Tehrani 2008a] E. Sobhani-Tehrani, H. A. Talebi, K. Khorasani, "Neural parameter estimators for hybrid fault diagnosis and estimation in nonlinear systems,"

154

Bibliography IEEE International Conference on Systems, Man and Cybernetics, 2007, 2008, Pages: 3171­3176. 16

[E. Sobhani-Tehrani 2008b] E. Sobhani-Tehrani, H. A. Talebi, K. Khorasani, "Neural parameter estimators for hybrid fault diagnosis and estimation in nonlinear systems," IEEE International Conference on Systems, Man and Cybernetics, 2008, Pages: 3171­3176. 85 [F. L. Sims 1969] F. L. Sims, D. G. Lainiotis, D. T. Magill, "Recursive algorithm for calculation of adaptive Kalman filter weighting coefficients," IEEE Transactions on Automatic Control, Vol. AC-14, 1969, Pages: 215­218. 77 [F. N. Pirmoradi 2009a] F. N. Pirmoradi, F. Sassani, C. W. de Silva, "Fault detection and diagnosis in a spacecraft attitude determination system," Acta Astronautica, Vol. 65, 2009, Pages: 710­729. 64 [F. N. Pirmoradi 2009b] F. N. Pirmoradi, F. Sassani, C. W. deSilva, "Faultdetectionanddiagnosisinaspacecraftattitudedetermination system," Acta Astronautica, Vol. 65, 2009, Pages: 710­729. 57 [Feng Zhou 2008] Feng Zhou, Xiu-yun Meng, "Adaptive Kalman filter of transfer alignment with un-modeled wing flexure of aircraft," Journal of Beijing Institute of Technology, Vol. 17, 2008, Pages: 434­438. 79 [Garza 2008] Garza, Angel Mario Cano. 3rd International Conference on Recent Advances in Space Technologies. Master's thesis, Lulea University of Technology, 2008. 7 [Girish Chowdhary 2010] Girish Chowdhary, Ravindra Jategaonkar, "Aerodynamic parameter estimation from flight data applying extended and unscented Kalman filter," Aerospace Science and Technology, Vol. 14, 2010, Pages: 106­117. 76 [Giulio Reina 2007] Giulio Reina, Andres Vargas, Keiji Nagatani Kazuya Yoshida, "Adaptive Kalman Filtering for GPS-based Mobile Robot Localization," Proceedings of the 2007 IEEE International Workshop on Safety, Security and Rescue Robotics, 2007, Pages: 78­83. 80

Bibliography

155

[Gustafsson 2000] Gustafsson, F., Adaptive Filtering and Change Detection, John Wiley & Sons, 2000. 17 [H. Azarnoush 2008] H. Azarnoush, K. Khorasani, "Fault detection in spacecraft attitude control system," IEEE International Conference on Systems, Man and Cybernetics 2007, 2008, Pages: 726­733. 17, 85 [H. K. Tzou 2001] H. K. Tzou, Y. T. Lin, "The tracking of a manoeuvring object by using an adaptive Kalman filter," Proceedings of the Institution of Mechanical Engineers, Part I (Journal of Systems and Control Engineering), Vol. 215, 2001, Pages: 125­ 130. 80 [H. 1976] H., Myoken, State-space representation of dynamical econometric model and identifiability conditions, North-Holland, 1976. 13 [Hablani 1994] Hablani, Hari B., "Sun-Tracking Commands and Reaction Wheel Sizing with Configuration Optimization," Journal of Guidance, Control, and Dynamics, Vol. 17, No. 4, July-August, 1994, Pages: 805­814. 40 [Hakan Kayal 2007] Hakan Kayal, Frank Baumann, Klaus Briess Sergio Montenegro, "BEESAT: a pico satellite for the on orbit verification of micro wheels," 3rd International Conference on Recent Advances in Space Technologies, 2007, Pages: 497­502. 6 [Herschel L. Mitchell 2000] Herschel L. Mitchell, P. L. Houtekamer, "An adaptive ensemble Kalman filter," Monthly Weather Review, Vol. 128, No. 2, Feb, 2000, Pages: 416­ 433. 79 [Hongwei Bian 2005] Hongwei Bian, Zhihua Jin, Weifeng Tian, "Study on GPS attitude determination system aided INS using adaptive Kalman filter," Measurement Science & Technology, Vol. 16, No. 10, Oct, 2005, Pages: 2072­2079. 79 [Husa 1969] Husa, Gary Wayne, "Algorithms for Sequential Adaptive Estimation of Prior Statistics," IEEE Proc of 8th Symp on Adaptive Processes, numéro 6a, Nov, 1969. 79

156

Bibliography

[isu 2010] "ISU Small Satellite Interdisciplinary Survey," , Aug., 2010. xv, 3 [Iz Al-Dein Al-Zyoud 2006] Iz Al-Dein Al-Zyoud, K. Khorasani, "Neural Network-based Actuator Fault Diagnosis for Attitude Control Subsystem of an Unmanned Space Vehicle," 2006 International Joint Conference on Neural Networks, 2006, Pages: 3686­3693. 85 [J. Chandrasekar 2008] J. Chandrasekar, I. S. Kim, D.S. Bernstein A.J. Ridley, "Reducedrank unscented Kalman filtering using Cholesky-based decomposition," 2008 American Control Conference, 2008, Pages: 1274­1279. 68 [J. Colomer 2002] J. Colomer, J. Melendez, F.I. Gamero, "Pattern recognition based on episodes and DTW. Application to diagnosis of a level control system," Proceedings of the 16th International Workshop on Qualitative Reasoning, Barcelona, Catalonia, Spain, June 10-12, 2002. 13 [J. Prakash 2009] J. Prakash, Anjali P. Deshpande, Sachin C. Patwardhan, "State estimation and fault tolerant nonlinear predictive control of an autonomous hybrid system using unscented kalman filter," Nonlinear Model Predictive Control: Towards New Challenging Applications, Vol. 384, 2009, Pages: 285­293. 69 [J. Wong & Palazoglu 1998] J. Wong, K. McDonald, & Palazoglu, A., "Classification of process trends based on fuzzified symbolic representation and hidden Markov models," Journal of Process Control, Vol. 8, No. 5, 1998, Pages: 395­408. 13 [Jann N. Yang 2004] Jann N. Yang, Silian Lin, Li Zhou, "Identification of parametric changes for civil engineering structures using an adaptive Kalman filter," Proceedings of the SPIE - The International Society for Optical Engineering, Vol. 5391, 2004, Pages: 389­399. 83 [Jayaram 2008] Jayaram, Sanjay, "Design and analysis of nano momentum wheel for picosatellite attitude control system," Aircraft Engineering and Aerospace Technology, Vol. 81, No. 5, 2008, Pages: 424­431. 6

Bibliography

157

[Ji-Ye Shao 2010] Ji-Ye Shao, Ri-Xin Wang, Min-Qiang Xu, "Application of Bayesian network in model-based fault diagnosis," Jilin Daxue Xuebao (Gongxueban)/Journal of Jilin University (Engineering and Technology Edition), Vol. 40, No. 1, January, 2010, Pages: 234­237. 18 [Jiahe Xu 2008] Jiahe Xu, Tatjana Kolemisevska-Gugulovska, Xiuping Zheng-Yuanwei Jing Georgi Marko Dimirovski, "UKF based nonlinear filtering for parameter estimation in linear systems with correlated noise," Proceedings of the 17th World Congress, International Federation of Automatic Control, IFAC, Vol. 17, 2008. 70, 74 [Joel Reiter 1999] Joel Reiter, Karl Bohringer, Mark Campbell, "MEMS control moment gyroscope design and wafer-based spacecraft chassis study," Proceedings of SPIE The International Society for Optical Engineering, Vol. 3876, 1999, Pages: 122­128. 9 [Jonathan Lawton 2003] Jonathan Lawton, Randal W. Beard, "Attitude Regulation About a Fixed Rotation Axis," Journal of Guidance, Control, and Dynamics, Vol. 26, No. 2, March-April, 2003, Pages: 253­258. 32 [Junchuan Zhou 2010] Junchuan Zhou, Stefan Knedlik, Otmar Loffeld, "INS/GPS Tightlycoupled Integration using Adaptive Unscented Particle Filter," The Journal of Navigation, Vol. 63, 2010, Pages: 491­511. 88 [Jung Dae Lee 2008] Jung Dae Lee, Byoung Gun Park, Tae Sung Kim; Ji Su Ryu Dong Seok Hyun, "Simple fault detection algorithm of BLDC motor based on operating characteristic," 2008 IEEE Power Electronics Specialists Conference, 2008, Pages: 643­646. 17 [J.W. Freestone 1986] J.W. Freestone, E.G. Jenkins, "Diagnosis of cylinder power faults in diesel engines by flywheel speed measurement," Proceedings of the Institution of Mechanical Engineers. Part D, Transport Engineering, Vol. 200. University of Technology, Loughborough, England, 1986, Pages: 37­43. 13

158

Bibliography

[K. A. Myers 1976] K. A. Myers, B. D. Tapley, "Adaptive sequential estimation with unknown noise statistics," IEEE Transactions on Automatic Control, Vol. AC-21, No. 4, Aug, 1976, Pages: 520­523. 81, 86 [K. Xiong 2007] K. Xiong, C. W. Chan, H. Y. Zhang, "Detection of satellite attitude sensor faults using the UKF," IEEE Transactions on Aerospace and Electronic Systems, Vol. 43, No. 2, April, 2007, Pages: 480­491. 69 [Karim Salahshoor 2008] Karim Salahshoor, Mohsen Mosallaei, Mohammadreza Bayat, "Centralized and decentralized process and sensor fault monitoring using data fusion based on adaptive extended Kalman filter algorithm," Measurement, Vol. 41, 2008, Pages: 1059­1076. 83 [Konecny 2004] Konecny, Gottfried, "Small Satellites - A Tool for Earth Observation?," ISPRS Journal of Photogrammetry and Remote Sensing, Vol. commission IV, 2004. 2 [Kurokawa 1997] Kurokawa, Haruhisa. "A Geometric Study of Single Gimbal Control Moment Gyros Singularity Problems and Steering Law," . Technical report, Mechanical Engineering Laboratory, Agency of Industrial Technology and Science, Ministry of International Trade and Industry, Japan, June, 1997. 40 [Kyung-Yup Kim 2007] Kyung-Yup Kim, Lee J.T., Dong-Kuk Yu Young-Sik Park, "Parameter estimation of noisy passive telemetry sensor system using unscented Kalman filter," 007 International Conference on Future Generation Communication and Networking, 2007, Pages: 433­438. 74 [L. Alminde 2003] L. Alminde, M. Bisgaard, D. Vinther-T. Viscor K. Ostergard, "Educational value and lessons learned from the AAU-CubeSat project," Proceedings of International Conference on Recent Advances in Space Technologies, 2003. 25 [L. An 2004] L. An, N. Sepehri, "Leakage fault identification in a hydraulic positioning system using extended Kalman filter," Proceedings of the 2004 American Control Conference, Vol. 4, 2004, Pages: 3088­3093. 63

Bibliography

159

[L. Loron 1993] L. Loron, G. Laliberte, "Application of the extended Kalman filter to parameters estimation of induction motors," IEE Conference Publication, 1993. 74 [L. Ozbek 2004] L. Ozbek, M. Efe, "An adaptive extended Kalman filter with application to compartment models," Communications in Statistics - Simulation and Computation, Vol. 33, No. 1, 2004. 83 [Lappas 2002] Lappas, Vaios J. "A Control Moment Gyro (CMG) Based Attitude Control System (ACS) For Agile Small Satellites," . PhD thesis, University of Surrey, 2002. xv, xix, 8, 10, 38, 39, 43, 47 [Lee 1988] Lee, T. S., "Theory and application of adaptive fading memory Kalman filters," IEEE Transactions on Circuits and Systems, Vol. 35, 1988, Pages: 474­477. 89 [Liu 1999] Liu, Wei, "An extended Kalman filter and neural network cascade fault diagnosis strategy for the glutamic acid fermentation process," Artificial Intelligence in Engineering, Vol. 13, No. 2, April, 1999, Pages: 131­140. 57 [Ljung 1979] Ljung, L., "Asymptotic behaviour of the extended Kalman filter as a parameter estimator for linear systems," IEEE Transactions on Automatic Control, Vol. 24, 1979, Pages: 36­50. 70 [M. Jayakumar 2010] M. Jayakumar, B. B. Das, "Isolating incipient sensor faults and system reconfiguration in a flight control actuation system," Proceedings of the Institution of Mechanical Engineers, Part G: Journal of Aerospace Engineering, Vol. 224, Jan, 2010, Pages: 101­111. 69 [M. Simandl 2007] M. Simandl, O. Straka, "Sampling densities of particle filter: a survey and comparison," 2007 American Control Conference, 2007, Pages: 4437­4442. 65 [M. Vingron 1989] M. Vingron, P. Argos, "A fast and multiple sequence alignment algorithm," Computer Applications in the Biosciences, Vol. 5, No. 5, 1989, Pages: 115­ 121. 13

160

Bibliography

[M. Yamakita 2004] M. Yamakita, Y. Musha, G. Kinoshita, "Comparative Study of Simultaneous Parameter-State Estimations," Proceedings of the 2004 IEEE International Conference on Control Applications, 2004, Pages: 1621­1626. 68 [MacQueen 1967] MacQueen, J. B., "Some methods for classification and analysis of multivariate observations," Proceedings of 5-th Berkeley Symposium on Mathematical Statistics and Probability, numéro 1. Berkeley, University of California Press, 1967, Pages: 281­297. 13 [Magill 1965] Magill, D. T., "Optimal adaptive estimation of sampled stochastic processes," IEEE ­ Transactions on Automatic Control, Vol. AC-10, No. 4, Oct, 1965, Pages: 434­439. 78 [Meiliang Wu 2008] Meiliang Wu, Andrew Smyth, "Real-time International parameterestimaJournalofNon-

tionfordegradingandpinchinghystereticmodels,"

LinearMechanics, Vol. 43, 2008, Pages: 822­833. 74 [Miao Huanga 2010] Miao Huanga, Wenyuan Li, Wei Yana, "Estimating parameters of synchronous generators using square-root unscented Kalman filter," Electric Power Systems Research, Vol. 80, 2010, Pages: 1137­1144. 76 [M.R. Maurya 2007] M.R. Maurya, R. Rengaswamy, V. Venkatasubramanian, "Fault diagnosis using dynamic trend analysis: A review and recent developments," Engineering Applications of Artificial Intelligence, Vol. 20, No. 2, 2007, Pages: 133­146. 12 [N. Tudoroiu 2005] N. Tudoroiu, K. Khorasani, "Fault detection and diagnosis for reaction wheels of satellite's attitude control system using a bank of Kalman filters," International Symposium on Signals, Circuits and Systems, Vol. 1, 2005, Pages: 199­202. 15, 78 [N. Tudoroiu 2006] N. Tudoroiu, K. Khorasani, "State estimation of the vinyl acetate reactor using unscented Kalman filters (UKF)," 2005 International Conference on Industrial Electronics and Control Applications, 2006, Page: 05EX1175C (4 pp.). 57

Bibliography

161

[N. Tudoroiu 2007] N. Tudoroiu, K. Khorasani, "Satellite fault diagnosis using a bank of interacting Kalman filters," IEEE Transactions on Aerospace and Electronic Systems, Vol. 43, No. 4, Oct, 2007, Pages: 1334­1350. 84 [P. Eide 1995] P. Eide, P. Maybeck, "Evaluation of a multiple-model failure detection system for the F-16 in a full-scale nonlinear simulation," National Aerospace and Electronics Conference, Proceedings of the IEEE, Vol. 1, 1995, Pages: 531­536. 84 [P. J. Escamilla-Ambrosio 2002] P. J. Escamilla-Ambrosio, N. Mort, "Multi-sensor data fusion architecture based on adaptive Kalman filters and fuzzy logic performance assessment," Proceedings of the Fifth International Conference on Information Fusion, Vol. 2, 2002, Pages: 1542­1549. 81 [P. M. Frank 1996] P. M. Frank, B. Koppen-Seliger, "Recent trends in fault diagnosis: a survey," 27th Edition International Conference. Proceedings. Automation 1996, Vol. 2, 1996, Pages: 709­721. 16 [Paul Zarchan 2000] Paul Zarchan, Howard Musoff, Fundamentals of Kalman Filtering: A Practical Approach, Progress in Astronautics and Aeronautics, AIAA, second édition, 2000. 61 [Peng 2004] Peng, Z.K., "Application of the Wavelet transform in machine condition monitoring and fault diagnostics," Mechanical Systems and Signal Processing, Vol. 18, 2004, Pages: 199­221. 13 [Peter D. Hanlon 2000] Peter D. Hanlon, Peter S. Maybeck, "Multiple-model adaptive estimation using a residual correlation Kalman filter bank," IEEE Transactions on Aerospace and Electronic Systems, Vol. 36, No. 2, 2000, Pages: 393­406. 84 [Polaschegg 2005] Polaschegg, Mario. Study of a Cube-Sat Mission. Master's thesis, University of Graz, 2005. http://www.docstoc.com/docs/2363460/Study-of-a-CubeSat-Mission-Mario-Polaschegg. 25

162

Bibliography

[Pooya Sekhavat 2007] Pooya Sekhavat, Qi Gong, I. Michael Ross, "NPSAT1 parameter estimation using unscented kalman filtering," Proceedings of the American Control Conference, 2007. 76 [R. J. Patton 1999] R. J. Patton, C. J. Lopez-Toribio, F. J. Uppal, "Artificial intelligence approaches to fault diagnosis for dynamic systems," International Journal of Applied Mathematics and Computer Science, Vol. 9, No. 3, 1999, Pages: 471­518. 16 [R. L. Klein 1969] R. L. Klein, E. D. Eyman, "A suboptimal filter and filter sensitivity for stochastic parameter systems," Proceedings of the 7th annual Allerton conference circuit and system theory, 1969, Pages: 440­449. 78 [R. Lynn Kirlin 1987] R. Lynn Kirlin, Alireza Moghaddamjoo, "Conventional and robust adaptive Kalman filtering: a survey," Proceedings - IEEE International Symposium on Circuits and Systems, 1987. 77 [R. Mehra 1995] R. Mehra, S. Seereeram, D. Bayard-F. Hadaegh, "Adaptive Kalman filtering, failure detection and identification for spacecraft attitude estimation," Proceedings of the 4th IEEE Conference on Control Applications, 1995, Pages: 176­181. 57, 78 [Raymond Kristiansen 2009] Raymond Kristiansen, Per Johan Nicklasson, Jan

Tommy Gravdahl, "Satellite Attitude Control by Quaternion-Based Backstepping," IEEE Transactions on Control Systems Technology, Vol. 17, No. 1, January, 2009, Pages: 227­232. 32 [Rogers 2007] Rogers, Robert M., Applied Mathematics in Integrated Navigation Systems, AIAA Inc., third édition, 2007. 59, 66 [S. K. Neguang 2006] S. K. Neguang, P. Zhang, S. Ding, "Parity based fault estimation for non-linear systems: An LMI approach," Proceedings of American Control Conference, Minneapolis, Minnesota, USA, 2006, Pages: 5141­5146. 15, 85

Bibliography

163

[S. Simani & Patton 2003] S. Simani, C. Fantuzzi, & Patton, R.J., Model-based Fault Diagnosis in Dynamic Systems Using Identification Techniques, London, Great Britain, Springer-Verlag, 2003. 12 [Schilling 2006] Schilling, Klaus. "Design of PIco-Satellites for Education in Systems Engineering," IEEE A&E Systems Magazine. IEEE, 2006. 4 [Shellenbarger 1966] Shellenbarger, J. C., "Estimation of covariance parameters for adaptive Kalman filter," National Electronics Conference ­ Proceedings, Vol. 22, 1966. 77, 79 [Shu-Wen Zhang 2004] Shu-Wen Zhang, Chong-Jian Qiu, Qin Xu, "Estimating soil water contents from soil temperature measurements by using an adaptive Kalman filter," Journal of Applied Meteorology, Vol. 43, No. 2, Feb., 2004, Pages: 379­389. 80 [Sichun Xu 2001] Sichun Xu, Deyun Xiao, "A new fault diagnosis method based on parameter estimation," Control Theory & Applications, Vol. 18, No. 4, August, 2001, Pages: 493­497. 16 [Simo Sarkka 2009] Simo Sarkka, Aapo Nummenmaa, "Recursive Noise Adaptive Kalman Filtering by Variational Bayesian Approximations," IEEE Transactions on Automatic Control, Vol. 54, No. 3, Mar, 2009, Pages: 596­600. 78 [Smith 1967] Smith, G. L., "Sequential estimation of observation error variances in trajectory estimation problem," AIAA, Vol. 5, No. 11, Nov, 1967, Pages: 1964­1970. 77 [Sobahni-Tehrani 2008] Sobahni-Tehrani, Ehsan. Identification for Nonlinear Systems Using Hybrid Approach. Master's thesis, Concordia University, 2008. 12, 13, 15, 18, 37, 92 [Sorenson 1967] Sorenson, H. W., "On error behavior in linear minimum variance estimation problems," IEEE Transactions on Automatic Control, Vol. 12, No. 5, Oct, 1967, Pages: 557­562. 78

164

Bibliography

[Stergios I. Roumeliotis 1998] Stergios I. Roumeliotis, Gaurav S. Sukhatme, George A. Bekey, "Sensor fault detection and identification in a mobile robot," Proceedings. 1998 IEEE/RSJ International Conference on Intelligent Robots and Systems. Innovations in Theory, Practice and Applications, Vol. 3, 1998, Pages: 1383­1388. 84 [T. Hofling 1997] T. Hofling, R. Isermann, "Adaptive parity equations and advanced parameter estimation for fault detection and diagnosis," Proceedings of the 13th World Congress, International Federation of Automatic Control. Vol.N. Fault Detection, Pulp and Paper, Biotechnology, 1997, Pages: 55­60. 16 [T. Kataoka 1993] T. Kataoka, S. Toda, Y. Sato, "On-line estimation of induction motor parameters by extended Kalman filter," IEE Conference Publication, Vol. 4, 1993, Pages: 325­329. 74 [T. R. Coon 1976] T. R. Coon, J. E. Irby, "Skylab Attitude Control System," IBM Journal of Research and Development, Vol. 20, No. 1, Jan, 1976, Pages: 58­66. 9 [Tayebi 2008] Tayebi, Abdelhamid, "Unit Quaternion-Based Output Feedback for the Attitude Tracking Problem," IEEE Transactions on Automatic Control, Vol. 53, No. 6, 2008, Pages: 1516­1520. 32 [V. Lappas & Underwood 2005] V. Lappas, W.H. Steyn, & Underwood, C., "Design and Testing of a Control Moment Gyroscope Cluster for Small Satellites," Journal of Spacecraft and Rockets, Vol. 42, No. 4, 2005, Pages: 729­739. 7 [V. Venkatasubramanian 1991] V. Venkatasubramanian, R. Vaidyanathan, "Diagnosing noisy process data using neural networks," IFAC/IMACS Symposium on Fault Detection, Supervision and Safety for Technical Processes, No. 6, 1991, Pages: 547­552. 12 [Vahid Fathabadi 2009] Vahid Fathabadi, Mehdi Shahbazian, Karim Salahshour Lotfollah Jargani, "Comparison of Adaptive Kalman Filter Methods in State Estimation

Bibliography

165

of a Nonlinear System," Proceedings of the World Congress on Engineering and Computer Science 2009, Vol. 2, Oct, 2009, Pages: 884­891. 17, 80 [W. Sun 2003] W. Sun, A. Palazoglu, J.A. Romagnoli, "Detecting abnormal process trends by wavelet-domain hidden Markov models," AIChE Journal, Vol. 49, No. 1, 2003, Pages: 140­150. 13 [Wan-Chun Li 2005] Wan-Chun Li, Ping Wei, Xian-Ci Xiao, "An adaptive nonlinear filter of discrete-time system with uncertain covariance using unscented Kalman filter," International Symposium on Communications and Information Technologies 2005, Proceedings, Vol. 1, 2005, Pages: 1389­1392. 82, 86 [Wang Min 2008] Wang Min, Qin Shiyin, "Robust fault diagnosis for reaction flywheel based on reduced-order observer," Proceedings of the SPIE - The International Society for Optical Engineering, Vol. 7129, 2008, Page: 71292H (8 pp). 15 [Wiley J. Larson 2005] Wiley J. Larson, James R. Wertz, editeur, Space Mission Analysis and Design, Vol. 7th printing, Space Technology Library/Microcosm Press, third édition, 2005. 31, 32, 44, 45, 46 [Yang 2005] Yang, Tiangi, "A method of neuro-fuzzy computing for effective fault diagnosis," Proceedings of the IEEE International Conference on Control Applications, 2005, Pages: 256­259. 57 [Youbin Peng 1997] Youbin Peng, Abdelillah Youssouf, Philippe Arte-Michel Kinnaert, "A Complete Procedure for Residual Generation and Evaluation with Application to a Heat Exchanger," IEEE Transactions on Control Systems Technology, Vol. 5, No. 6, Nov., 1997, Pages: 542­555. 18 [Yuanxi Yang 2006] Yuanxi Yang, Weiguang Gao, "An optimal adaptive Kalman filter," Journal of Geodesy, Vol. 80, No. 4, July, 2006, Pages: 177­183. 80 [Yue-hua Cheng 2010] Yue-hua Cheng, Bin Jiang, Ming-kai Yang Zhi-feng Gao, "SelfOrganizing Fuzzy Neural Network-Based Actuator Fault Estimation for Satellite

166

Bibliography Attitude Systems," Journal of Applied Sciences, Vol. 28, No. 1, Jan, 2010, Pages: 72­76. 18

[Z. H. Min 2010] Z. H. Min, L. M. Sun, "A Novel Non-Parametric Sequential Probability Ratio Test Method for Structural Condition Assessment," Proceedings of the SPIE - The International Society for Optical Engineering, Vol. 7650, 2010, Page: 76502O (9 pp.). 18 [Z. Q. Li & Khorasani 2006] Z. Q. Li, L. Ma, & Khorasani, K., "A Dynamic Neural

Network-based Reaction Wheel Fault Diagnosis for Satellites," 2006 International Joint Conference on Neural Networks, July, 2006, Pages: 3714­3721. 17 [Zhang Ke 2007] Zhang Ke, Jiang Bin, Shi Peng, "Adaptive observer-based fault diagnosis with application to satellite attitude control systems," Second International Conference on Innovative Computing, Information and Control, 2007, Pages: 2035­2038. 15 [Zhao-Hui Cen 2010] Zhao-Hui Cen, Jiao-Long Wei, Rui Jiang Xiong Liu, "Real-time fault diagnosis of satellite attitude control system based on sliding-window wavelet and DRNN," 2010 Chinese Control and Decision Conference, 2010, Pages: 1218­1222. 18 [Zhi Gao 2005] Zhi Gao, Thomas G. Habetler, Ronald G. Harley, "An adaptive kalman filtering approach to induction machine stator winding temperature estimation based on a hybrid thermal model," Conference Record of the 2005 IEEE Industry Applications Conference Fortieth IAS Annual Meeting, Vol. 1, 2005, Pages: 2­9. 83 [Zhijie Zhou 2008] Zhijie Zhou, Changhua Hua, Hongdong Fan Jin Li, "Fault prediction of the nonlinear systems with uncertainty," Simulation Modelling Practice and Theory, Vol. 16, 2008, Pages: 690­703. 83, 84 [Zywno 2007] Zywno, Dr. Gosha. ELE 829 Lectures. Department of Electrical Engineering, Ryerson University, 2007. 13

Appendix A

Adaptive Parameter Plots for FDI Simulations

In this appendix the plots of the AFF and estimated Qk and Rk matrices are presented for each of the the simulations in chapter 5.
5 4.5 4 3.5 3 2.5 2 1.5 1 0.5 0 0 500 1000 1500 2000 2500 3000 3500 4000 x 10
-3

Adaptive Fading Factor

time [s]

Figure A.1: CASE 1 - Adaptive Forgetting Factor

168

Appendix A. Adaptive Parameter Plots for FDI Simulations

R-Matrix Diagonal Entry 1
0.5 0.4 0.3 3 0.2 2 0.1 0 1 0 1000 2000 3000 4000 0 6 5 4

x 10

-4

R-Matrix Diagonal Entry 2

0

1000

2000

3000

4000

time [s]
1.2 1 0.8 0.6 0.4 0.2 0 0 1000 2000 3000 4000 x 10
-4

time [s]
1.2 1 0.8 0.6 0.4 0.2 0 0 1000 2000 3000 4000 x 10
-4

Q-Matrix Diagonal Entry 1

Q-Matrix Diagonal Entry 2

time [s]

time [s]

Figure A.2: CASE 1 - Q and R Matrices

169

5 4.5 4 3.5 3 2.5 2 1.5 1 0.5 0

x 10

-3

Adaptive Fading Factor

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Figure A.3: CASE 2 - Adaptive Forgetting Factor
R-Matrix Diagonal Entry 1
0.5 0.4 0.3 3 0.2 2 0.1 0 1 0 1000 2000 3000 4000 0 0 1000 2000 3000 4000 6 5 4 x 10
-4

R-Matrix Diagonal Entry 2

time [s]
1 0.8 0.6 0.6 0.4 0.4 0.2 0 0.2 0 1000 2000 3000 4000 0 0 1000 x 10
-4

time [s]
1.2 1 0.8 x 10
-4

Q-Matrix Diagonal Entry 1

Q-Matrix Diagonal Entry 2

2000

3000

4000

time [s]

time [s]

Figure A.4: CASE 2 - Q and R Matrices

170

Appendix A. Adaptive Parameter Plots for FDI Simulations
5 4.5 4 3.5 3 2.5 2 1.5 1 0.5 0 0 500 1000 1500 2000 2500 3000 3500 4000 x 10
-3

Adaptive Fading Factor

time [s]

Figure A.5: CASE 3 - Adaptive Forgetting Factor
R-Matrix Diagonal Entry 1
0.5 0.4 0.3 1.5 0.2 1 0.1 0 0.5 0 3 2.5 2 x 10
-3

R-Matrix Diagonal Entry 2

0

1000

2000

3000

4000

0

1000

2000

3000

4000

time [s]
1.2 1 0.8 0.6 0.4 0.2 0 0 1000 2000 3000 4000 x 10
-4

time [s]
1.2 1 0.8 0.6 0.4 0.2 0 0 1000 2000 3000 4000 x 10
-4

Q-Matrix Diagonal Entry 1

Q-Matrix Diagonal Entry 2

time [s]

time [s]

Figure A.6: CASE 3 - Q and R Matrices

171

7

x 10

-3

Adaptive Fading Factor

6

5

4

3

2

1

0

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Figure A.7: CASE 4 - Adaptive Forgetting Factor
R-Matrix Diagonal Entry 1
0.5 0.4 0.3 0.2 0.2 0.1 0 0.1 0.4

R-Matrix Diagonal Entry 2

0.3

0

1000

2000

3000

4000

0

0

1000

2000

3000

4000

time [s]
1.2 1 0.8 0.6 0.4 0.2 0 0 1000 2000 3000 4000 x 10
-4

time [s]
1.2 1 0.8 0.6 0.4 0.2 0 0 1000 2000 3000 4000 x 10
-4

Q-Matrix Diagonal Entry 1

Q-Matrix Diagonal Entry 2

time [s]

time [s]

Figure A.8: CASE 4 - Q and R Matrices

172

Appendix A. Adaptive Parameter Plots for FDI Simulations

1.4

x 10

-3

Adaptive Fading Factor

1.2

1

0.8

0.6

0.4

0.2

0

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Figure A.9: CASE 5 - Adaptive Forgetting Factor
R-Matrix Diagonal Entry 1
0.1 0.08 0.06 0.02 0.04 0.02 0 0.01 0.04

R-Matrix Diagonal Entry 2

0.03

0

1000

2000

3000

4000

0

0

1000

2000

3000

4000

time [s]
6 5 4 3 2 1 0 0 1000 2000 3000 4000 x 10
-5

time [s]
6 5 4 3 2 1 0 0 1000 2000 3000 4000 x 10
-5

Q-Matrix Diagonal Entry 1

Q-Matrix Diagonal Entry 2

time [s]

time [s]

Figure A.10: CASE 5 - Q and R Matrices

173

2 1.8 1.6 1.4 1.2 1 0.8 0.6 0.4 0.2 0

x 10

-3

Adaptive Fading Factor

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Figure A.11: CASE 6 - Adaptive Forgetting Factor
R-Matrix Diagonal Entry 1
0.1 0.08 0.06 0.04 0.02 0 0.1 0.08 0.06 0.04 0.02 0

R-Matrix Diagonal Entry 2

0

1000

2000

3000

4000

0

1000

2000

3000

4000

time [s]
6 5 4 3 2 1 0 x 10
-5

time [s]
6 5 4 3 2 1 0 x 10
-5

Q-Matrix Diagonal Entry 1

Q-Matrix Diagonal Entry 2

0

1000

2000

3000

4000

0

1000

2000

3000

4000

time [s]

time [s]

Figure A.12: CASE 6 - Q and R Matrices

174

Appendix A. Adaptive Parameter Plots for FDI Simulations

1 0.9 0.8 0.7 0.6 0.5 0.4 0.3 0.2 0.1 0

x 10

-6

Adaptive Fading Factor

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Figure A.13: Medium Noise Power - Adaptive Forgetting Factor

R-Matrix Diagonal Entry 1
0.05 0.04 0.03 0.02 0.01 0 0.05 0.04 0.03 0.02 0.01 0

R-Matrix Diagonal Entry 2

0

1000

2000

3000

4000

0

1000

2000

3000

4000

time [s]
6 5 4 3 2 1 0 0 1000 2000 3000 4000 x 10
-5

time [s]
6 5 4 3 2 1 0 0 1000 2000 3000 4000 x 10
-5

Q-Matrix Diagonal Entry 1

Q-Matrix Diagonal Entry 2

time [s]

time [s]

Figure A.14: Medium Noise Power - Q and R Matrices

175

6

x 10

-6

Adaptive Fading Factor

5

4

3

2

1

0

0

500

1000

1500

2000

2500

3000

3500

4000

time [s]

Figure A.15: High Noise Power - Adaptive Forgetting Factor

R-Matrix Diagonal Entry 1
0.5 0.4 0.3 0.2 0.1 0 0.05 0.04 0.03 0.02 0.01 0

R-Matrix Diagonal Entry 2

0

1000

2000

3000

4000

0

1000

2000

3000

4000

time [s]
1.2 1 0.8 0.6 0.4 0.2 0 0 1000 2000 3000 4000 x 10
-4

time [s]
1.2 1 0.8 0.6 0.4 0.2 0 0 1000 2000 3000 4000 x 10
-4

Q-Matrix Diagonal Entry 1

Q-Matrix Diagonal Entry 2

time [s]

time [s]

Figure A.16: High Noise Power - Q and R Matrices

176

Appendix A. Adaptive Parameter Plots for FDI Simulations

4 3.5 3 2.5 2 1.5 1 0.5 0

x 10

-3

Adaptive Fading Factor

0

200

400

600

800

1000

time [s]

Figure A.17: CMG FDI - Adaptive Forgetting Factor
-7

4

x 10

Q-Matrix Diagonal Entry 1
1 0.8 0.6

x 10

-5

Q-Matrix Diagonal Entry 2

3

2 0.4 1 0.2 0

0

0

200

400

600

800

1000

0

200

400

600

800

1000

time [s]
3 2.5 1.5 2 1.5 1 0.5 0.5 0 0 200 400 600 800 1000 0 0 200 1 x 10
-6

time [s]
2 x 10
-6

Q-Matrix Diagonal Entry 3

Q-Matrix Diagonal Entry 4

400

600

800

1000

time [s]

time [s]

Figure A.18: CMG FDI - Q Matrix

177

R-Matrix Diagonal Entry 1
0.06 0.05 0.3 0.04 0.03 0.02 0.1 0.01 0 0 200 400 600 800 1000 0 0 0.2 0.4

R-Matrix Diagonal Entry 2

200

400

600

800

1000

time [s]
4 x 10
-6

time [s]
4 x 10
-6

R-Matrix Diagonal Entry 3

R-Matrix Diagonal Entry 4

3

3

2

2

1

1

0

0

200

400

600

800

1000

0

0

200

400

600

800

1000

time [s]

time [s]

Figure A.19: CMG FDI - R Matrix

Adaptive Fading Factor
0.35

0.3

0.25

0.2

0.15

0.1

0.05

0

0

50

100

150

200

250

300

350

time [s]

Figure A.20: System Identification - Adaptive Forgetting Factor

178

Appendix A. Adaptive Parameter Plots for FDI Simulations

4 3 2 1 0

x 10

6

R-Entry

0

50

100

150

200

250

300

350

time [s]

Q-Matrix Diagonal Entry 1
0.4 0.3 0.2 0.1 0 0 50 100 150 200 250 300 350

time [s]

Q-Matrix Diagonal Entry 2
600 400 200 0

0

50

100

150

200

250

300

350

time [s]

Figure A.21: System Identification - Q and R Matrices

179


