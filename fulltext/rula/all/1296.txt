Finite Element Analysis of Knee Articular Cartilage
by Randall Heydon BASc, University of Waterloo, 2009 A thesis presented to Ryerson University

in partial fulfillment of the requirements for the degree of Master of Applied Science in the Program of Mechanical Engineering Toronto, Ontario, Canada, 2011 c Randall Heydon 2011

I hereby declare that I am the sole author of this thesis. I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research.

I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

iii

Finite Element Analysis of Knee Articular Cartilage Master of Applied Science 2011 Randall Heydon Mechanical Engineering Ryerson University

Abstract
The knee joint is often subjected to high loads, which can lead to injury and osteoarthritis. To better understand its behaviour, a finite element model of the joint was created. A hyperelastic material model was created to represent articular cartilage. A six parameter Ogden curve was fitted against experimental stress-stretch data of cartilage. This material was applied to two different finite element models of the knee created from anatomical slice images. The complete models were validated against data from experiments performed on whole knees. Under compressive loading, the deflection of the model joints were found to be within one-half of a standard deviation of the experimental data. One model was tested in alternate configurations; its response was found to be strongly related to cartilage thickness and knee flexion. Therefore, it is concluded that this cartilage material model can be used to accurately predict the load response of knees.

v

Acknowledgements
I would like to thank my supervisors, Professors Kamran Behdinan and Donatus Oguamanam, for their guidance throughout this work. Without their help, I would still be aimlessly searching for material parameters. Thanks for helping me stay on the right path throughout. I would like to thank the Natural Sciences and Engineering Research Council of Canada for funding this research. I would also like to thank my parents for providing unending support. Not only the physical -- a home, and food -- but also the mental -- constant pride in my work, even if they might never care to understand its technical details. Thanks so much for getting me this far. Finally, I would like to thank the rest of my family and their bevy of knee problems for motivating me throughout this work. Though I am sure that reading this will not make your knees feel better, know that a lot of people are working on it. We will fix you up yet.

vii

Contents
Author's declaration Abstract Acknowledgements List of Tables List of Figures Nomenclature 1 Introduction 1.1 1.2 1.3 Motivation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Purpose . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Anatomy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1.3.1 1.3.2 1.4 1.4.1 1.4.2 1.4.3 1.4.4 1.4.5 Joint structure . . . . . . . . . . . . . . . . . . . . . . . . . . . . Articular cartilage structure . . . . . . . . . . . . . . . . . . . . . Physical experiments . . . . . . . . . . . . . . . . . . . . . . . . . Subject-specific models . . . . . . . . . . . . . . . . . . . . . . . . Hyperelastic models . . . . . . . . . . . . . . . . . . . . . . . . . Viscoelastic models . . . . . . . . . . . . . . . . . . . . . . . . . . Fibril-reinforced models . . . . . . . . . . . . . . . . . . . . . . . ix iii v vii xiii xv xvii 1 1 1 2 2 3 4 4 5 6 8 9

Literature review . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

2 Material modelling 2.1 Continuum mechanics basis . . . . . . . . . . . . . . . . . . . . . . . . . 2.1.1 2.1.2 2.1.3 2.2 2.3 Kinematics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Hyperelasticity . . . . . . . . . . . . . . . . . . . . . . . . . . . . Stress . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

11 12 12 14 15 17 18 18 19 20 23 23 24 25 26 26 27 27 27 28 31 31 32 33 37 40 44 51 52 52 53

Tool validation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Parameter fitting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.3.1 2.3.2 2.3.3 Steady-state . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Bovine . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . In-situ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

3 Finite element model 3.1 3.2 3.3 Slice images . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Volumetric reconstruction . . . . . . . . . . . . . . . . . . . . . . . . . . Mesh generation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3.3.1 3.3.2 3.4 3.4.1 3.4.2 3.5 Decimation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Volumetric meshing . . . . . . . . . . . . . . . . . . . . . . . . . . Cartilage-bone . . . . . . . . . . . . . . . . . . . . . . . . . . . .

Contact . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Cartilage-cartilage . . . . . . . . . . . . . . . . . . . . . . . . . .

Convergence testing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4 Simulation & results 4.1 Validation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.1.1 4.1.2 4.1.3 4.2 4.3 Visible Human model . . . . . . . . . . . . . . . . . . . . . . . . . Open Knee model . . . . . . . . . . . . . . . . . . . . . . . . . . . Modified Open Knee model . . . . . . . . . . . . . . . . . . . . .

Thickness analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Flexion analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

5 Summary & conclusions 5.1 Future work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.1.1 5.1.2 Geometry . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Material . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . x

A Code A.1 febio-validation.py . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . A.2 curvefit.py . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . A.3 offset.py . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . References

55 55 58 61 69

xi

List of Tables
2.1 4.1 Ogden material parameters for each data set. . . . . . . . . . . . . . . . . Comparison of joint deflections (in mm) between real and simulated knee joints. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18

33

xiii

List of Figures
1.1 2.1 2.2 3.1 3.2 3.3 3.4 3.5 Assembly of relevant knee joint components [11]. . . . . . . . . . . . . . . Unit cube used for material validation, in initial and stretched states. . . Comparison of fitted Ogden curves. . . . . . . . . . . . . . . . . . . . . . Sample image from the Visible Human Project showing femoral condyles and cartilage. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Reconstructed surface model of femoral articular cartilage. . . . . . . . . Volumetric mesh of femoral articular cartilage. . . . . . . . . . . . . . . . Sliding contact surfaces defined on each set of cartilage. . . . . . . . . . . Stress in convergence testing models as function of solution state (i.e. fraction of completion). . . . . . . . . . . . . . . . . . . . . . . . . . . . . Complete Visible Human model. . . . . . . . . . . . . . . . . . . . . . . . von Mises stress at cartilage surfaces on the Visible Human model (Pa). . Complete Open Knee model. . . . . . . . . . . . . . . . . . . . . . . . . . Comparison of Ogden material and Open Knee's neo-Hookean material. . von Mises stress at cartilage surfaces on the Open Knee model (MPa). . . von Mises stress at cartilage surfaces on the modified Open Knee model (MPa). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Cross-section through areas of peak stress. . . . . . . . . . . . . . . . . . Maximum deflection at each tested thickness offset. . . . . . . . . . . . . Maximum stress found at each tested thickness offset. . . . . . . . . . . . 3 17 19

24 25 27 28 29 32 34 35 36 38 39 40 41 42 43 44 45

4.1 4.2 4.3 4.4 4.5 4.6 4.7 4.8 4.9

4.10 Load-deflection curves at each tested thickness offset. . . . . . . . . . . . 4.11 Stress at femoral cartilage surface at different thickness offsets. . . . . . . 4.12 Stress at tibial cartilage surface at different thickness offsets. . . . . . . . xv

4.13 4.14 4.15 4.16 4.17

Maximum stress found at each tested flexion angle. . . . . . Maximum deflection at each tested flexion angle. . . . . . . . Profile of the femoral cartilage through one point of contact. Stress at femoral cartilage surface at different flexions. . . . Stress at tibial cartilage surface at different flexions. . . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

46 47 48 49 50

xvi

Nomenclature
 i C F P R S U V X x µ i t Cauchy stress tensor material stretch in direction i right Cauchy-Green deformation tensor deformation gradient tensor first Piola-Kirchoff stress tensor rotation tensor second Piola-Kirchoff stress tensor material stretch tensor spatial stretch tensor reference position of a particle current position of a particle neo-Hookean material parameter Cauchy stress in direction i position mapping function

ci , mi Ogden material parameters d1 , d2 Mooney-Rivlin material parameters xvii

IC IIC

first invariant of C second invariant of C

IIIC third invariant of C J N W Jacobian of deformation number of Ogden parameter sets strain energy density function of a hyperelastic material

xviii

Chapter 1 Introduction
1.1 Motivation

The knee is the largest joint in the body and carries very high loads. Accordingly, it is one of the most injured parts of the human body [1] and is highly susceptible to osteoarthritis, a degenerative condition that can become debilitating [2]. In such cases, knee replacement surgery may be the only option. Though the rate at which such operations are performed in Ontario has increased to meet demand, wait times are still above target levels [3]. The health of knees is therefore an important health care problem. Understanding the behaviour of the knee in a variety of conditions is important to preventing and correcting damage to it. Much work has been done analyzing real human knees [4­10], but such analyses are necessarily limited: cadaveric knees are not readily available, human subjects cannot be deliberately subjected to injury, and obtaining data from inside an intact knee can be difficult and inexact. These restrictions can be avoided by instead performing analyses on computerized simulations of knees. Accurate simulations can provide detailed information on knee response under a wide variety of situations.

1.2

Purpose

This thesis aims to create and validate a general-purpose computerized knee joint model using the finite element method. Of course, a truly "complete" model requires indefinite 1

1.3. ANATOMY

CHAPTER 1. INTRODUCTION

amounts of work to create; instead, this thesis focuses specifically on the material model of the articular cartilage. This will allow for the creation of a base model upon which more advanced models can be built.

1.3
1.3.1

Anatomy
Joint structure

The knee joint is made up of three bones and a variety of soft tissues. The bones are the femur, the tibia, and the patella [1]. The femur and tibia, which are the primary bones of the upper and lower leg respectively, can be seen in Figure 1.1 [11]. The patella, a sesamoid bone that helps transmit load through the quadriceps tendon, is not shown here. The articulating ends of the femur and tibia are divided into two condyles. The femoral condyles are round and bulbous, with a slight gap between the two; the tibial condyles have a slight depression to accommodate the femoral condyles, with a slight ridge dividing them [1]. Each bone has a layer of articular cartilage covering its articulating surfaces. In the gap between femoral and tibial cartilage, a pair of menisci wrap around the condyles. These are all surrounded by a fluid-filled capsule, ensuring that the soft tissues are saturated in synovial fluid. The cartilage and menisci transmit the large loads experienced by the joint, while the fluid lubricates the articulating surfaces to lower friction and prevent wear [1]. Four ligaments connect the femur and tibia, serving an important purpose in passive joint mechanics. The anterior and posterior cruciate ligaments, which can be seen in Figure 1.1, pass through the gap between the two femoral condyles. The lateral and medial collateral ligaments attach to the outsides of the lateral and medial condyles respectively. These ligaments ensure the femur and tibia remain in contact, and control relative positioning of the two bones during knee flexion [1]. 2

CHAPTER 1. INTRODUCTION

1.3. ANATOMY

Figure 1.1: Assembly of relevant knee joint components [11].

1.3.2

Articular cartilage structure

Articular cartilage is a type of hyaline cartilage found in all joints. It is a porous solid, which allows synovial fluid to permeate it. Synovial fluid serves multiple purposes: it nourishes the cartilage, which has no blood vessels; it lubricates the joint to allow for smooth articulation; and it carries a significant portion of the joint's load through exudation from the porous solid [1]. The solid consists of a set of collagen fibrils embedded in an extra-cellular matrix. Near the articulating surface of the cartilage, known as the superficial zone, the fibrils are oriented parallel to the surface. This helps protect the cartilage against wear, and 3

1.4. LITERATURE REVIEW

CHAPTER 1. INTRODUCTION

limits the rate at which synovial fluid exudes. In the middle zone, the fibrils are oriented somewhat randomly as they transition to the deep zone. In the deep zone, fibrils are oriented perpendicularly to the bone; as they enter the calcified zone, they are mineralized, allowing them to anchor onto the subchondral bone [1].

1.4

Literature review

There have been many different analyses of knees, through both physical experiments and finite element models. Many models, primarily from the last decade, take very different approaches in both geometry of knee components and choice of material models used to represent them. A few such models and experiments are compared here.

1.4.1

Physical experiments

An early experiment by Krause et al. [4] was performed to determine the effects of the menisci during knee loading. By loading twelve human and twelve canine knee joints up to 1000 N at a series of different flexions, the carried load, contact area, and absorbed energy of the joint were measured. Before testing, all soft tissues were removed except for menisci, ligaments, and part of the capsule. The testing was done with both menisci intact, medial meniscus removed, and both menisci removed. This paper, along with many others published around the same time, concluded that the menisci have an important load-bearing role. Particularly interesting to this work is the conclusion that a knee without menisci would, under the same load, deflect twice as much as knee with menisci intact. A subsequent paper by Kurosawa et al. [7] reported on a similar experiment on fourteen human knee joints. These were only tested at full extension, but were loaded up to 1500 N. Load-deflection and load-contact area relations were noted; deflection was measured from the end of the bone, while contact area was measured through silcone rubber castings. These tests were performed first with menisci intact, then with menisci removed. This paper came to the same overall conclusion as that of Krause et al. [4]: the menisci perform an important load-bearing function in the knee joint. However, they disagree on the effects of meniscectomy on joint deflection: where Krause's study reported a doubling 4

CHAPTER 1. INTRODUCTION

1.4. LITERATURE REVIEW

of deflection after meniscectomy [4], Kurosawa observed an insignificant increase [7]. It is difficult to explain this discrepancy; however, Kurosawa's work focused more directly on deflection and did not damage the capsule prior to loading [7], which lends more credence to its conclusion in this matter. This paper also found that total length of the femur and tibia did not significantly affect total deflection under load. This implies that the bones are so stiff as to remain almost entirely undeformed in comparison to the soft tissues in the joint.

1.4.2

Subject-specific models

One model, by Poto cnik et al. [12], was made with the intriguing goal of being easily adaptable to the unique knee geometries of different people. The paper outlines a procedure for using magnetic resonance imaging to take a sparse sequence of fast twodimensional images at several knee flexions and loads. Non-linear image registration is then used to reconstruct three-dimensional knee joint geometry for the subject. Finally, a template knee mesh is mapped onto the subject-specific geometry. This template mesh is constructed once from high-quality imaging data; by mapping it onto the subject's knee joint geometry, a high-quality subject-specific mesh results [12]. However, the resulting model is limited by the material models used. Bones, menisci, cartilage, and ligaments are all treated as linear-elastic isotropic materials [12]; though these are simple material models that can effectively model many metals, it is well known that many biological tissues exhibit non-linear, anisotropic behaviour [1]. Furthermore, though the geometry can be tailored to individual subjects, the material properties cannot without far more invasive testing; they are simply set to match those of the template. Therefore, this model is limited in its ability to predict the behaviour of real knee joints. ¨ Another paper, by Ohman et al. [13], similarly proposes a method to create and validate subject-specific knee joint models, but uses a different approach. Magnetic resonance imaging and computed tomography images are created with marker cubes on the bones. Registration is used to align these image sets, allowing them to be used jointly in reconstructing the surface geometry of bones, cartilage, menisci, and ligaments through a partially-automated process. The volumes are then automatically meshed with tetrahedral elements to create the complete finite element mesh. This work is still preliminary; though it is intended to be used for human knees, this method has currently 5

1.4. LITERATURE REVIEW

CHAPTER 1. INTRODUCTION

only been tested with porcine knees [13]. ¨ The material models used by Ohman et al. [13] are generally better than those of Poto cnik et al. [12]. The menisci material is represented by the neo-Hookean hyperelastic material model. This material model was developed to extend linear elasticity into nonlinear, high-strain regions; it is therefore an improvement over linear elasticity in this context, though it is one of the simplest hyperelastic material models available. Ligaments were modelled with a transversely-isotropic material model discussed in an earlier paper [14]. This material is a modification of the standard neo-Hookean material; it adds a directionally-dependent term to the standard neo-Hookean isotropic base. Strangely, though, both bones and cartilage are represented as rigid bodies. This is not uncommon for bones, as they are far stiffer than the soft tissues of the knee, but this is the only observed instance of a model with rigid cartilage. Therefore, though the models here are largely an improvement over those of Poto cnik et al., there continues to be notable limitations in them.

1.4.3

Hyperelastic models

The model created for the Open Knee project [15] uses a collection of material models ¨ similar to that of Ohman et al. [13]. Ligaments are modelled with the same transverselyisotropic neo-Hookean variant, and bones are rigid. However, the articular cartilage is modelled with a standard neo-Hookean material instead of being rigid, while the menisci are modelled with an orthotropic Fung material. These changes give a slight improvement ¨ over Ohman et al. by capturing the deformability of articular cartilage and the anisotropy of the menisci. However, the previously-mentioned limitations of neo-Hookean materials continues to hinder this model. This model is, however, particularly notable for being freely available for any use. It can be freely downloaded and has been placed under the Creative Commons AttributionShare Alike license; this allows anyone to use this model for any purpose, as long as the original creators are acknowledged and any modifications are made available under the same license. However, with this freedom, it is also expected that users of the model will validate it themselves to determine if it produces accurate results for their application. At the time of writing, only minimal validation has been performed; "only qualitatively based on general trends" for passive flexion of the joint [15]. Therefore, the model is not 6

CHAPTER 1. INTRODUCTION

1.4. LITERATURE REVIEW

yet in a state to be generally applied without further effort. ¨ As was mentioned earlier, the neo-Hookean material model used by Ohman et al. [13] and the Open Knee project [15] is much simpler than other hyperelastic material models. It is a special case of the Mooney-Rivlin material model, which is itself a special case of the Ogden material model, as is shown in Section 2.1.2. This implies that either of these are certain to represent material behaviour at least as well as the neo-Hookean model does. Furthermore, a paper by Brown et al. [16] has shown that, out of several hyperelastic material models, the Mooney-Rivlin model is best able to fit the normalized stress-stretch response of compressively-loaded cartilage samples. These experiments were performed on 57 samples of bovine patellar articular cartilage; both healthy and osteoarthritic samples were tested, at strain rates of 0.1 s-1 and 0.025 s-1 . A variety of hyperelastic stress-stretch curves -- Arruda-Boyce, Mooney-Rivlin, neo-Hookean, Ogden, Polynomial, and Yeoh -- were fitted to the experimental data. The Mooney-Rivlin and Yeoh models were found to have the best fit, with r2 values very close to 0.999. The neo-Hookean model fared slightly worse, with one case at 0.998 [16]. However, this work is called into question simply for the reportedly poor performance of the Ogden material, with one r2 lower than 0.993 [16]. Since the Mooney-Rivlin material is a special case of the Ogden material, it should be possible to set the Ogden material parameters in such a way as to give a response identical to that of MooneyRivlin. A properly-fitted Ogden material must therefore perform at least as well as Mooney-Rivlin; the fact that it did not implies that there must have been some limitation in the curve fitting techniques. This discrepancy was unacknowledged by the authors of this paper. Furthermore, it has been demonstrated by Bell et al. that articular cartilage cannot be fully modelled by homogeneous nor isotropic materials [17], though all previous models assume this. The authors of this paper created a series of simplified three-dimensional cylindrical articular cartilage models, assigning different linear elastic properties to each: the first, a homogeneous isotropic material; the second, three distinct layers, each an isotropic material; and the third, three distinct layers, each with a transversely isotropic material. Though it was concluded that homogeneous models are capable of giving accurate bulk deformation response, inhomogeneous anisotropic models are needed to give accurate per-layer deformation and stress response [17]. Therefore, all the previously mentioned 7

1.4. LITERATURE REVIEW

CHAPTER 1. INTRODUCTION

models, which do not account for depth- and directional-dependence of articular cartilage, cannot fully model small-scale cartilage response.

1.4.4

Viscoelastic models

Furthermore, hyperelastic materials cannot fully model biological tissue behaviour due to their strain-rate-independent nature. As was seen in the study by Brown et al. [16], different hyperelastic material parameters can be used to model articular cartilage response at different strain rates, but any one set of parameters will only be valid at the strain rate to which it was fitted. Many real biological tissues, including ligaments, cartilage, and menisci, are actually porous solids filled with fluids; the motion of this fluid strongly affects tissues' response to loading and leads to viscoelastic phenomena such as timedependent responses, history-dependent responses, and hysteresis [1]. Therefore, several knee joint models have opted to use material models that can capture this behaviour. A paper by Silver et al. [18] and subsequent doctoral thesis by Bradica [19], attempted to characterize the distinct elastic and viscous responses of articular cartilage in the knee. Cartilage samples were taken from the femoral condyles of patients undergoing total knee replacement surgery; these samples were sorted by their degree of fibrillation, a measure of the health of the cartilage. The samples were incrementally strained by 5% at a rate of 10% per minute, then allowed to relax for approximately 30 to 120 minutes until equilibrium had been reached; the next strain increment would then be applied. This was performed in both tension and compression to strains of about 30%, with stress measured continually throughout the process. The resulting stress-strain curves clearly showed the difference between stresses caused by elasticity and viscosity. This allowed for estimates of the elastic slope (i.e. Young's modulus) and viscous slope [18]. Interestingly, these works attribute the observed viscous effects to the structure of collagen fibrils rather than the pore fluid. The collagen fibrils, which self-assemble into triple-helical structures, are theorized to slide against each other, giving rise to the viscous effects. However, they acknowledge that effects from the fibrils alone are insufficient to understand cartilage behaviour [18]. Other models attempt to directly model the flow of fluid through an elastic solid, thereby giving rise to the observed viscoelastic phenomena. Such poroelastic or biphasic models were initally developed to model soil consolidation, but have since been expanded 8

CHAPTER 1. INTRODUCTION

1.4. LITERATURE REVIEW

to handle any fluid-filled porous solid. One such model, by Goreham-Voss et al. [20] used a poroelastic material in modelling unstable incongruities in articular cartilage of the ankle. The material model agreed qualitatively, but not very closely, with dynamic tests performed on plugs of articular cartilage. The discrepancy can be attributed not to the effects of the fluid phase, but to limitations of the solid phase: it was treated as a homogeneous linear-elastic transversely-isotropic material. Articular cartilage is generally considered to be transversely isotropic, but, as has already been discussed, it is also considered to be nonlinear, with properties that vary with depth. The finite element model is further limited in that the geometry is two-dimensional and assumed to be in plane strain, and contact is simulated by the application of load rather than actually modelled. Another pair of models by Vadher, Vaziri, et al. [21, 22], created to test the effects of partial and full meniscectomies on stress in the knee's articular cartilage, improves on some of the issues seen in Goreham-Voss's work [20]. Contact is properly handled, including fluid flow across boundaries,and the geometry is considered axisymmetric rather than plane strain. Though the knee joint is certainly not axisymmetric, this simplification does capture the tensile support provided by the meniscus fairly well. The material model is also slightly improved over that of Goreham-Voss; by dividing the cartilage into three layers with different properties -- superficial, middle & deep, and calcified -- the model can better capture the inhomogeneity of real cartilage. It does seem strange to combine the middle and deep layers into one homogeneous component, but stranger still is the fact that this component is given isotropic properties; this is a slight regression from Goreham-Voss's work. Otherwise, though, Vadher and Vaziri's models are a notable advancement.

1.4.5

Fibril-reinforced models

A group of researchers used a very different approach in their articular cartilage and mensici material models. Poroelastic analysis is used to divide the cartilage into solid and fluid phases, as seen in previously discussed models, but the solid phase is further divided into an isotropic matrix and a network of collagen fibrils. With proper placement of the elements representing the fibrils, the anisotropy and inhomogeneity of real cartilage naturally arises in the model. 9

1.4. LITERATURE REVIEW

CHAPTER 1. INTRODUCTION

To begin, several models with simplified geometry were created [23­26]. A cylindrical plug of cartilage is modelled axisymmetrically; the matrix is represented as a set of second-order square elements, overlayed with a series of nonlinear spring elements representing fibrils, and first-order square fluid elements. The matrix is represented as an isotropic linear elastic material, the stiffness of the fibril springs varies linearly with strain but carry no compressive loads, and matrix permeability varies exponentially with dilatation. Though initially homogeneous [23], later refinements of the model included depth-dependent properties: matrix stiffness and Poisson's ratio vary linearly with depth, while both matrix permeability and fibril stiffness vary quadratically with depth [24, 25]. Further refinements were later made to include the effects of radially-oriented fibrils by replacing the spring elements with axisymmetric membrane elements [26]. These models are limited similarly to previously discussed models -- axisymmetric modelling, simplified geometry, and linear elastic materials -- but performs reasonably well at predicting cartilage material behaviour. This approach is significantly advanced when used within a whole-knee model [27]. First, the linear elastic matrix material is replaced with a hyperelastic Ogden material, which can better model its real response. Then, this material is used in a full threedimensional knee joint model. Collagen fibrils are represented as membrane elements, aligned in the directions of fibrils, with membrane thicknesses set to represent the fibril volume fractions. This is done with both articular cartilage and menisci; ligaments are represented as nonlinear pre-strained springs, and bones are considered to be rigid. This model was validated against load-compression data, then applied to make predictions of contact stresses [27]. The model seems to be one of the most advanced full models currently available. However the level of complexity involved, as evidenced by the eight-year span between initial investigations and the creation of the model, means that reproducing this would be infeasible. They do acknowledge that simpler models can produce valid results for many investigations, meaning that this approach will not presently be necessary.

10

Chapter 2 Material modelling
Since the stress-strain curves for many soft biological tissues are nonlinear [1], linear elastic material models are not considered to accurately model them. Instead, a hyperelastic material model is used. These models were developed to account for large deformations in soft materials like rubber and can similarly be applied to soft biological tissues [16]. Like all elastic material models, hyperelastic models are energy conservative and therefore path independent [28]; this means that they alone cannot model the time-dependent response of many biological tissues, but they can be used to model, for example, cartilage at a specific strain rate, or the solid component of a biphasic or poroelastic material. It is important to note that a number of hyperelastic material models, including the Ogden model used here, were designed for use with incompressible and isotropic materials [29]. The incompressibility constraint coincides with the observed behaviour of articular cartilage and menisci quite well, as is evidenced by typical estimates of Poisson's ratios from 0.45­0.5 [18, 21, 30]. However, articular cartilage can be divided into three distinct layers, each with different orientation of collagen fibrils, giving each layer different transversely isotropic properties [17]. Unfortunately, the effect of distinct layers cannot be well addressed with the geometric construction techniques covered in Chapter 3; since all three layers must be considered as a whole, no single fibril orientation is considered dominant. Furthermore, homogeneous models cannot fully represent internal cartilage behaviour, but have been noted to accurately model bulk behaviour [17, 26]. Therefore, the cartilage as a whole will be treated as isotropic and homogeneous. Though hyperelastic material models can be applied to many different tissues, it was 11

2.1. CONTINUUM MECHANICS BASIS CHAPTER 2. MATERIAL MODELLING decided that bones would be modelled as rigid bodies. Bone length has a negligible effect on the deflection of the knee joint under compressive loading [7], implying that they are far stiffer than the soft tissues found in the knee. Therefore, modelling them as rigid bodies will decrease the amount of time required to find the solution while not severely impacting the quality of the solution.

2.1
2.1.1

Continuum mechanics basis
Kinematics

Kinematics is the study of the movement of particles through space and time without concern for the causes of the movement. The position of a particle within a body can be described as a mapping from one state to another; that is, a particle's current position, x, can be determined from the particle's reference configuration, X, through a mapping function which can vary with time [31]: x = t (X) (2.1)

Linear elements can be similarly mapped from reference to current configuration. This is done through the two-point deformation gradient tensor, F as such [31]: dx = FdX (2.2)

This tensor can be decomposed into rotational and stretch components [28]: F = RU = VR (2.3)

Here, R is the two-point rotation tensor that transforms material vectors into spatial ones. This tensor is orthogonal, meaning that RT = R-1 . The stretch tensors, U and V, represent deformation in material and spatial coordinates, respectively; these tensors are symmetric. The eigenvalues of these tensors, i , have a physical meaning in relating 12

CHAPTER 2. MATERIAL MODELLING 2.1. CONTINUUM MECHANICS BASIS the length of a linear element from reference to current configurations [28]: li = i Li (2.4)

Recognizing that the determinant of U and V is the product of their eigenvectors, of which there are three in a three-dimensional space, and that the orthogonal R tensor has a determinant of one, the determinant of F can be found. This is known as the Jacobian of deformation [28]: J = det F = det(RU) = det U = 1 2 3 (2.5)

The Jacobian has a physical meaning in relating the volume of a volumetric element from reference to current configurations [31]: dv = JdV (2.6)

Also of interest is the right Cauchy-Green deformation tensor. This eliminates the rotational component of the deformation gradient F, resulting in a diagonal second-order tensor dependent only on the body's stretches [28]: C = FT F = UT RT RU = UT U = U2 (2.7)

The three invariants of this tensor are often of use. They are defined as [28]:
2 2 IC = 2 1 + 2 + 3

(2.8a)

2 2 2 2 2 2 2 2 -2 -2 -2 IIC = 2 1 2 + 1 3 + 2 3 = 1 2 3 (1 + 2 + 3 )

(2.8b)

2 2 IIIC = 2 1 2 3

(2.8c)

13

2.1. CONTINUUM MECHANICS BASIS CHAPTER 2. MATERIAL MODELLING

2.1.2

Hyperelasticity

The state of a hyperelastic material is dependent solely on its current and initial configurations; the deformation path and elapsed time have no effect on, for example, internal stresses in the material [28]. A hyperelastic material is defined by a strain energy density function, W . This is typically expressed as a function of the invariants of C, which, as shown above, can be represented as functions of the principal stretches. The strain energy density function returns the internal strain energy per unit undeformed volume [28]. Furthermore, a hyperelastic material must respond realistically to extreme volumetric changes [31]: lim W   (2.9a)
J 

J 0

lim W  -

(2.9b)

Many biological tissues, including articular cartilage and menisci, are generally considered to be incompressible. In such a case, all volumes must remain constant throughout deformation; Equation 2.6 therefore tells us that J = 1 at all times for incompressible materials. There are a number of hyperelastic material models available. Some of the popular ones for biomechanics applications are Arruda-Boyce, neo-Hookean, Mooney-Rivlin, Yeoh, polynomial, Ogden, Veronda-Westman, and Holmes-Mow material models [16,32]. The neo-Hookean model is a special case of the Mooney-Rivlin model, while the MooneyRivlin model is a special case of the Ogden model. This can be seen in the strain energy density equations for these materials. When considering incompressible materials, the neo-Hookean formulation is given as [28]: WnH = µ (IC - 3) 2 (2.10)

14

CHAPTER 2. MATERIAL MODELLING 2.1. CONTINUUM MECHANICS BASIS The incompressible Mooney-Rivlin formulation is [16]: WM R = d1 (IC - 3) + d2 (IIC - 3) (2.11)

In these two equations, IC and IIC are the first and second invariants of the CauchyGreen tensor, C. It is easy to see in these two equations that setting d1 = µ/2 and d2 = 0 will cause the Mooney-Rivlin strain energy density equation to reduce to that of the neo-Hookean. The Ogden strain energy density formulation is different, relying on stretches directly rather than invariants of C [29]:
N

WO =
i=1

ci mi mi i (1 + m 2 + 3 - 3) m2 i

(2.12)

To compare with Mooney-Rivlin, the invariants must be expanded as functions of the three primary stretches. Making use of Equations 2.8a and 2.8b, and recognizing that 1 2 3 = J = 1, the Mooney-Rivlin strain energy density function becomes:
2 2 -2 -2 -2 WM R = d1 (2 1 + 2 + 3 - 3) + d2 (1 + 2 + 3 - 3)

(2.13)

It is clear that this is equivalent to an Ogden material with N = 2, m1 = 2, c1 = 4d1 , m2 = -2, and c2 = 4d2 . The Mooney-Rivlin model is known to work well for modelling cartilage [16]. As a more general case, Ogden will perform at least as well, if not better, than Mooney-Rivlin; this makes it an excellent choice of material model for this application.

2.1.3

Stress

From strain energy density functions, stress-stretch relations can be derived for hyperelastic materials. 15

2.1. CONTINUUM MECHANICS BASIS CHAPTER 2. MATERIAL MODELLING The first and second Piola-Kirchoff stress tensors, P and S, can be derived as [28]: P= W F W C (2.14a)

S=2

(2.14b)

The Cauchy stress tensor,  , which is more useful in engineering analyses, can be found in relation to the second Piola-Kirchoff stress tensor [28]:  = J -1 FSFT (2.15)

This equation can be significantly simplified to give the three principal stresses [28]:  i = J -1 W  ln i (2.16)

For the purposes of parameter fitting, discussed in Section 2.3, several simplifying assumptions are made to derive a stress-stretch function. First, uniaxial unconstrained loading is considered. All stretch will be applied to the material in the direction of 1 , while 2 and 3 are allowed to change freely. Since the Ogden material formulation is inherently isotropic, it can be concluded that 2 = 3 . Second, as was mentioned before, incompressibility is assumed, giving J = 1 2 3 = 1. Combined with the previous assumption, we find that: 2 = 3 = 1 2
-1

(2.17)

By applying Equation 2.17 to Equation 2.12, the strain energy density function becomes: N m ci - 2i mi W = -3 (2.18)  + 2  1 1 m2 i i=1 Finally, we derive this function as per Equation 2.16 with respect to principal stretch 16

CHAPTER 2. MATERIAL MODELLING 1 . This results in a stress function of:
N

2.2. TOOL VALIDATION

1 =
i=1

ci mi

i 2 m 1 - 1

-m1

(2.19)

2.2

Tool validation

In order to ensure that the finite element analysis software, FEBio, would give valid results, its implementation of the Ogden material model was validated against the stressstretch function given in Equation 2.19. A simple FE model was created to match the assumptions used in deriving Equation 2.19: a unit cube, stretched along one axis while allowing free deformation along the other two, as shown in Figure 2.1. This model uses an Ogden material, with parameters c1 = 6.3, m1 = 1.3, c2 = 0.012, m2 = 5.0, c3 = -0.1, and m3 = -2.0 [29]. Note that FEBio accepts up to six pairs of parameters (12 parameters in total) [32], so all further parameters are set so as to negate their effects: c4 = c5 = c6 = 0 and m4 = m5 = m6 = 1. This model's stress and stretch along the primary axis were stored to compare with the manual calculations.

Figure 2.1: Unit cube used for material validation, in initial and stretched states.

Using these c and m parameters in Equation 2.19 allows us to plot the stress-stretch curve for this material. Using the code shown in Appendix A.1, we show that this curve fits the stress-stretch curve given by FEBio very well. Therefore, we can conclude that FEBio's implementation of the Ogden material model is correct. 17

2.3. PARAMETER FITTING

CHAPTER 2. MATERIAL MODELLING

2.3

Parameter fitting

Now that FEBio's Ogden material implementation has been validated, it can be used in this knee model. However, Ogden material parameters for articular cartilage do not seem to be readily available in the literature. Fortunately, though, empirical stress-stretch curves for articular cartilage are available; the stress-stretch function found in Equation 2.19 can be fit to such curves in order to determine the best c and m parameters to represent the cartilage. Using the code shown in Appendix A.2, a least squares method was applied to perform the fitting.

2.3.1

Steady-state

Several stress-stretch curves were used for this parameter fitting. The first gives the steady-state stress-stretch response of human articular cartilage under uniaxial tension and compression [19]. Fitting the Ogden stress-stretch curve with N = 3 to these data points gives the six parameters shown in Table 2.1, and the curve shown in Figure 2.2. The curve fits the measured data points very well, with r2 = 0.994. Table 2.1: Ogden material parameters for each data set. c1 (Pa) Steady-state 2.1251×109 Bovine 4.2588×109 In-situ 4.2549×109 m1 0.59043 2.9623 11.277 c2 (Pa) -2.5746×109 -8.5102×109 -8.5126×109 m2 0.28020 2.3994 10.300 c3 (Pa) 4.5394×108 4.2537×109 4.2581×109 m3 -0.82711 1.8357 9.3065

Since these parameters represent the steady-state response of cartilage, this material would be a suitable candidate for representing the solid phase of a poroelastic material. Unfortunately, though, it is difficult to validate the behaviour of this solid material in a complete knee model due to a lack of data available for comparison. There currently does not seem to be any research on the steady-state behaviour of whole knee joints, likely because the required loading time of 30 to 120 minutes to reach steady state is far too high to represent realistic physiological conditions. Without such data, this material model cannot be validated independently of a complete poroelastic model. Since that is beyond the scope of this work, this material will for now remain unvalidated, but is left 18

CHAPTER 2. MATERIAL MODELLING

2.3. PARAMETER FITTING

4 3 2 Stress (MPa) 1 0 1 2 3 4 0.6

In-situ fit curve Steady-state fit curve Bovine fit curve In-situ data Steady-state data Bovine data

0.7

0.8

0.9 Stretch

1.0

1.1

Figure 2.2: Comparison of fitted Ogden curves. here so that it might be built upon in future work.

2.3.2

Bovine

With the steady-state material parameters untestable for now, other parameters are needed that represent cartilage behaviour at physiological loading rates. Two other experimental stress-stretch curves were used for this purpose. The stress-stretch data from [33] was assembled from three experiments. In each experiment, bovine cartilage was given a different amount of preconditioning stretch, then subjected to tensile stretch at a constant strain rate, until reaching a stretch ratio of 1.12. The different preconditioning stretches were found to have little effect on the stress response [33], allowing the data points from all three measurements to be used in parameter fitting simultaneously. 19

2.3. PARAMETER FITTING

CHAPTER 2. MATERIAL MODELLING

However, attempting to fit Ogden parameters to these points resulted in a stressstretch curve that is valid when near the measured data points, but not necessarily valid otherwise. All these data points were measured under tension [33]; since cartilage in a knee joint will often be subjected to significant compression, fitting to these data points alone would produce material parameters with an unrealistic response to it. Therefore, in order to make this data useful, the simple assumption is made that stress in compression is equal and opposite to stress in tension. Represented mathematically: 1 (1 ) = -1 (2 - 1 ) (2.20)

This is assumed to be valid within the measured stretch range and its corresponding compressive regime; that is, for 0.88 < 1 < 1.12. Fitting the Ogden curve to all these data points results in the bovine parameters shown in Table 2.1. As shown in Figure 2.2, the curve fits the data points quite well, with r2 = 0.995. It is important to note that bovine cartilage is typically less stiff than human cartilage [34]; this is reflected in Figure 2.2, where the in-situ material, discussed next, is notably stiffer. Though material properties of animal cartilage have been used in human models before [13], material parameters of human cartilage are preferred here.

2.3.3

In-situ

Given the limitations of the bovine material properties, one other source was used. Kurosawa et al. presented a load-deflection curve for an axially compressed whole human knee joint, as well as a load-contact area curve for a knee having undergone a full meniscectomy [7]. These curves were combined to generate the stretch-stretch data used to fit material parameters. A large collection of points were sampled off of the load-deflection curve for conversion. Only four points were available on the load-contact area curve, so spline interpolation was used to sample between them. Deflection was converted into stretch by the standard definition of stretch, 1 = 1 - d/t. Here, d is the deflection and t is cartilage thickness. The thickness was measured from the reconstructed models discussed in Section 3.2. This thickness is the combined 20

CHAPTER 2. MATERIAL MODELLING

2.3. PARAMETER FITTING

thicknesses of the femoral cartilage, measured to be 2.69mm, and the tibial cartilage, measured to be 2.23mm, totalling 5.92mm. Measurements were taken at the point of contact on the medial condyle. Load was converted into stress simply by dividing by the corresponding interpolated contact area. Attempting to fit the Ogden curve to all these data points did not work very well. Regardless of initial guesses of curve parameters, the resulting curve would have an unrealistic response. Namely, it included improperly oriented stresses -- negative in tension and positive in compression -- that would give an unstable response. To overcome this, only a subset of all stress-stretch data points were used for curve fitting; high-stress points were gradually removed from the set until the fitted curve gave a physically possible response. When fitted to this subset, we obtain the in-situ parameters shown in Table 2.1. This set of parameters has its own limitations. One is that they do not fit a significant portion of the data points; another is that stress-stretch Equation 2.19 was derived assuming unconstrained uniaxial loading, whereas the cartilage measured was not unconstrained while in the knee joint. However, since it based directly on human cartilage under physiological loading rates, it is the most applicable parameter set created here. Therefore, the in-situ material will be used to model the knee's articular cartilage.

21

Chapter 3 Finite element model
To create a complete simulation, the material properties discussed in Chapter 2 must be used as part of a complete Finite Element model. A volumetric mesh representing real knee geometry was made, contact relationships between the different components were defined, and material parameters were applied.

3.1

Slice images

The basis of the reconstructed knee geometry was the female dataset of the Visible Human Project; therefore, the model created here is referred to as the Visible Human model. This dataset was obtained from the cadaver of a 59-year-old woman who had died of a heart attack. A series of photographic images were taken of the interior of the body, all in the transverse plane. The images were taken every 0.33 mm, and were scaled such that each pixel represented a 0.33 mm square [35]. Only geometry of the knee is required for this project, so only a subset of images surrounding the knees were used. These images, numbers 5367 to 5967, were selected so as to include all patellar, femoral, and tibial cartilage, along with portions of bone. Finally, since these images are very large and contain much extraneous data, they were all cropped to include only relevant areas. One such image is shown in Figure 3.1. 23

3.2. VOLUMETRIC RECONSTRUCTION CHAPTER 3. FINITE ELEMENT MODEL

Figure 3.1: Sample image from the Visible Human Project showing femoral condyles and cartilage.

3.2

Volumetric reconstruction

In order to construct a three-dimensional model, the image set was loaded in to 3D Slicer [36]. The full-colour images were resampled into greyscale images, allowing for a simple thresholding algorithm to find the volumes of individual knee components. Though both left and right knees are visible in the images, the right was used for all models as it had better alignment between geometric and anatomical axes. The thresholding algorithm worked quite well on the cartilage volumes due to their being much brighter than most other parts of the knee. However, several blemishes had to be corrected manually. Most notably, it appears that, in the process of creating the images, the very bottom of the femoral condyles were lost. This resulted in an apparently empty volume where there should have been cartilage and subchondral bone. Fortunately, surrounding tissues preserved the shape of the condyles well enough to reconstruct them. Furthermore, there were a few notable pockmarks in the cartilage surface, possibly caused by early osteoarthritis that is common in older females [2]. These were easily removed by visual extrapolation from surrounding cartilage. Thresholding did not work as well on the bone, as it contrasted less with surrounding tissues. Instead, a more manual approach was taken to volumetric reconstruction of them. Images were traversed slice by slice, manually defining the boundaries of the bones. The 24

CHAPTER 3. FINITE ELEMENT MODEL

3.3. MESH GENERATION

boundaries were created and edited in all three planes so as to minimize ripple artifacts; the volumes were then passed through a smoothing filter in order to reduce them further. Finally, the volumes were exported as surface models, like the one shown in Figure 3.2; they consist of a very fine triangular mesh along the surface of the volume. The models show certain ridge-like artifacts resulting from converting the voxel-based volumes into surface models, but these are minor enough that they disappear after the decimation process discussed in Section 3.3.1.

Figure 3.2: Reconstructed surface model of femoral articular cartilage. These volumes are oriented in the same way as the slice images. Therefore, the x-axis aligns with the mediolateral axis, positive in the lateral direction; the y -axis aligns with the anteroposterior axis, positive in the anterior direction; and the z -axis aligns with the superior-inferior axis, positive in the superior direction.

3.3

Mesh generation

To use in a finite element model, the surface models must be discretized with a volumetric mesh. 25

3.3. MESH GENERATION

CHAPTER 3. FINITE ELEMENT MODEL

3.3.1

Decimation

In the volumetric meshing procedure, discussed in the next section, the triangular mesh that defines the surface is used to seed the volumetric mesh; every triangular facet becomes the face of at least one tetrahedron. The surface models as produced by 3D Slicer are very dense, which would result in a correspondingly dense volumetric mesh. Denser volumetric meshes give better results at the cost of computation time and memory usage, but, as is shown in Section 3.5, high-quality results can be obtained at densities far lower than that of the given mesh. Therefore, the surface mesh had to be decimated to lower its density. This was done with Meshlab's quadric edge collapse decimation, which reduces the number of surface triangles by combining them together while attempting to maintain the overall shape of the surface [37]. The models were decimated such that the number of triangles remaining is only a small fraction of the initial number. Cartilage models were created at four different densities for convergence testing: 0.5%, 1.0%, 1.5%, and 2.0% of the initial number of surface triangles. Bone models, being rigid, would not affect convergence, and were therefore decimated much further, to 0.1%.

3.3.2

Volumetric meshing

The decimated surface models were automatically discretized with first-order, four-node tetrahedral elements, with three positional degrees of freedom per node. Though hexahedral elements are generally considered to give better results with a less dense mesh, they tend to require much manual effort to arrange. Meshing software, Gmsh, was used, applying Delaunay triangulation through the tetgen algorithm, followed by an optimization process [38]. In this process, the meshes were also scaled down by a factor of 1000; the models exported from 3D slicer were created in a millimeter scale, but the meshes were converted to meter scale so as to ensure unit homogeneity during analysis. The femoral cartilage mesh is shown in Figure 3.3. 26

CHAPTER 3. FINITE ELEMENT MODEL

3.4. CONTACT

Figure 3.3: Volumetric mesh of femoral articular cartilage.

3.4

Contact

The meshes were loaded into PreView [39], a preprocessor for FEBio, in order to define contact relationships between the different knee components.

3.4.1

Cartilage-bone

Since the bones in this model are considered to be rigid bodies, a very simple rigid-body interface can be used to attach each set of cartilage to its respective bone. This type of contact simply ensures that all designated nodes on the cartilage model are displaced by the same amount as the rigid bone; computationally, it behaves identically to a prescribed displacement or nodal load [40]. The contact surface for both sets of cartilage was easily defined due to its thin geometry. All facets facing toward the bone were assumed to be attached to it.

3.4.2

Cartilage-cartilage

The contact between both sets of cartilage is much more interesting than with the bone. This contact must account for the fact that both bodies are deformable, can separate, 27

3.5. CONVERGENCE TESTING

CHAPTER 3. FINITE ELEMENT MODEL

and can slide relatively to each other. Fortunately, articular cartilage is typically welllubricated by synovial fluid [1], resulting in negligible levels of friction between cartilage surfaces. To achieve this, FEBio's facet-to-facet sliding algorithm was used. It "poses the contact problem as a nonlinear constrained optimization problem", with constraints enforced by penalty or augmented Lagrangian methods [32]. Four contact surfaces were defined; two on each set of cartilage, one of which for the lateral condyle, the other for the medial. The surfaces were defined to be as small as possible in order to reduce computation time; this was accomplished primarily by visual inspection and trial-and-error. However, caution was still exercised; surfaces erred on being too-large, and solutions were inspected to ensure no faces outside the surfaces intersected each other. These surfaces are shown in Figure 3.4.

Figure 3.4: Sliding contact surfaces defined on each set of cartilage.

3.5

Convergence testing

The final step in preparing the finite element model is determining how many elements are needed to converge on a solution. As was mentioned in Section 3.3.1, cartilage meshes at four different densities were created for this purpose. Each was assembled into a problem where the tibia is fixed in place, and the femur is gradually rotated to bring the two sets of cartilage into contact on both condyles. The stresses in the cartilage are recorded at 28

CHAPTER 3. FINITE ELEMENT MODEL

3.5. CONVERGENCE TESTING

every solution state, allowing comparisons throughout the femur's motion. The average stress throughout the cartilage over the course of the problem for each mesh density is shown in Figure 3.5.

14000 12000 10000 Average stress (Pa) 8000 6000 4000 2000 0 0.0

5529 Elements 9804 Elements 14857 Elements 21841 Elements

0.2

0.4 0.6 Solution state

0.8

1.0

Figure 3.5: Stress in convergence testing models as function of solution state (i.e. fraction of completion). This figure shows that calculated stresses are almost imperceptibly different between the model with 14857 elements and the one with 21841 (corresponding to the cartilage surface models decimated to 1.5% and 2.0%, respectively). Therefore, the 1.5% model should contain enough elements, and is used for further analyses.

29

Chapter 4 Simulation & results
4.1 Validation

To ensure that this model produces realistic behaviour, it is compared against the behaviour of real knees. The study performed by Kurosawa et al. [7] was previously used for validation of knee joint models [27]. This is the same source of data used to find the material parameters in Section 2.3.3; therefore, this paper both contributes to the model and validates it. This may appear to be an instance of the Texas sharpshooter fallacy, but is not since a different set of data was used in each case; the material parameters were found from the load-deflection curve of a single knee, while validation is being done against aggregate data from fourteen knees. These fourteen knees were "obtained from patients 37 to 76 years old who had undergone amputation" [7]. The reasons for the amputations varied, though most were due to vascular insufficiency or malignant tumors. The articular surfaces were examined, finding no arthritic or hemorrhagic changes [7]. Therefore, these samples can be assumed to represent healthy knees. This data consists of average joint deflections of the tested knees. The knees were loaded axially under full extension at a strain rate of 5 mm/min, with deflections noted at 500 N, 1000 N, and 1500 N; the maximum load roughly corresponds to double body weight. This was done first with the knees intact, then again after removing the menisci [7]. Since the model does not include menisci, the second dataset is used for validation. 31

4.1. VALIDATION

CHAPTER 4. SIMULATION & RESULTS

4.1.1

Visible Human model

The model's boundary conditions are adjusted to match the loading state of the knees in the experiment. A two-step process is used: first, the tibia has all degrees of freedom fixed while the femur is moved into contact with it by rotating in the coronal (xz ) plane and descending along the superior-inferior (z ) axis; second, the femur is fixed while the tibia is loaded upwards along the z -axis and left free to rotate within the coronal plane. Joint deflection is measured as the translation of the tibia in along the z -axis. The load is first dropped to 1 N to provide a reference deflection of the tibia, then gradually increased to 1500 N.

Figure 4.1: Complete Visible Human model. Convergence criteria for the Newton-Raphson iterations were tweaked to complete the analysis and obtain good results. Generally, tightening the tolerance on the augmented 32

CHAPTER 4. SIMULATION & RESULTS

4.1. VALIDATION

Lagrangian method used to enforce contact and incompressibility gave results closer to those of Kurosawa [7]; however, ensuring convergence at all loads required that the convergence tolerances on displacement and energy be loosened, though this did not appear to strongly affect the results. This simulation required about one hour of computing time to complete. This was done on a 2 GHz, dual core Athlon 3800+ CPU, with 4 GB of memory. The results of this analysis were very good, with deflections at all loads within onehalf of a standard deviation of the experimental deflections. These results are tabulated in Table 4.1. Table 4.1: Comparison of joint deflections (in mm) between real and simulated knee joints. 500 N 0.83±0.21 0.79 0.75 0.71 1000 N 1500 N 0.98±0.16 1.11±0.25 1.03 1.22 1.09 1.20 (at 1200 N) 0.92 1.06

Experimental (mean ± std. dev.) [7] Visible Human Open Knee Modified Open Knee

The von Mises stress distributions on the surfaces of the two layers of articular cartilage are shown in Figure 4.2. This shows stresses at the full load of 1500 N. Peak stresses of approximately 20 MPa are seen at the central points of contact. Interesting to note is that the contact areas are further toward the anterior than those seen in the Open Knee models, as shown in Sections 4.1.2 and 4.1.3. It is possible that the knees of the subject used to create the Visible Human model were actually slightly hyperextended, rather than being at the assumed zero-degree flexion.

4.1.2

Open Knee model

For comparison purposes, the Open Knee model [15], shown in Figure 4.3, was subjected to the same loading conditions. This model is superior to the one created for this project in several ways -- it includes menisci, modelled with an orthotropic Func material, and ligaments, modelled with a transversely isotropic variant of the neo-Hookean material, and is meshed very finely with hexahedral brick elements -- except that it uses the very 33

4.1. VALIDATION

CHAPTER 4. SIMULATION & RESULTS

Figure 4.2: von Mises stress at cartilage surfaces on the Visible Human model (Pa).

34

CHAPTER 4. SIMULATION & RESULTS

4.1. VALIDATION

simple neo-Hookean material model for the articular cartilage. To compare directly to the results obtained from the other model, while also easing convergence, the menisci are removed from the Open Knee model for this analysis.

Figure 4.3: Complete Open Knee model. The boundary conditions for this model are slightly different from those used in the previous model. Here, the tibia has all degrees of freedom fixed for the duration of the analysis, while the femur is loaded. Translation of the femur along the z -axis is therefore measured as the joint deflection. The load is initially brought to 10 N so as to initiate tibio-femoral contact and provide a reference deflection, then gradually increased to 1500 N. Throughout, the femur is restricted from rotating in the sagittal (yz ) and transverse (xy ) planes, but is free to rotate in the coronal (xz ) plane. It is also free to translate in any direction, allowing it to settle into a natural position. 35

4.1. VALIDATION

CHAPTER 4. SIMULATION & RESULTS

This model was unable to fully complete the analysis, as the load was only able to reach 1200 N before negative Jacobians prevented it from going further; some elements had become so severely deformed that they inverted, entering a non-physical state. Yet even at this lower load, the model had deflected notably beyond the expected deflection. The failure of this model can be directly attributed to the cartilage material model it employs. By comparing the stress-stretch curves of this materials and the Ogden material used earlier, as shown in Figure 4.4, it is easy to see that the Ogden material is much stiffer at higher compressions, thereby reducing deflection to better match the experimental results.

4 3 2 Stress (MPa) 1 0 1 2 3 4 0.6 0.7 0.8 0.9 Stretch 1.0

In-situ Open Knee
1.1

Figure 4.4: Comparison of Ogden material and Open Knee's neo-Hookean material. The resulting stress distribution at 1200 N is shown in Figure 4.5. Note that this model was created on a millimeter scale, as opposed to the Visible Human model's meter 36

CHAPTER 4. SIMULATION & RESULTS

4.1. VALIDATION

scale, thereby causing stresses to be displayed in units of megapascals rather than pascals. As was mentioned earlier, the points of contact are further posterior than those of the Visible Human model, likely due to slightly different default flexions. Note that the peak stress is far lower than that of the Visible Human model, reaching only 3 MPa. This is partially accounted for by the lower load, but not entirely; at 1200 N, the Visible Human model experienced a peak stress of 16.5 MPa. The difference in material stiffness, as seen in Figure 4.4, must account for the remainder. The softer material allows for more deflection, as is seen in Table 4.1; by deflecting further, the curved cartilage surfaces press together, allowing the load to be distributed over a larger contact area.

4.1.3

Modified Open Knee model

For further comparison, the Open Knee model was modified to use the Ogden material instead of the default neo-Hookean material. Though otherwise identical to the previous Open Knee model, Table 4.1 shows that it performs much better at high loads. Though it required 7.5 hours of computation time, its performance is about on par with that of the Visible Human model. However, it is interesting to note that the Visible Human model tended to overestimate deflection, while the modified Open Knee model consistently underestimated it, despite the fact that the two models used identical cartilage material parameters. This can be explained by differences in cartilage thickness: as was mentioned in Section 2.3.3, the Visible Human model had a total cartilage thickness of 5.9 mm; the Open Knee's cartilage, however, totals only 4.2 mm. This difference is not easily explained beyond the fact that different human subjects were used in creating the geometry of each model. But despite this, both models seem to produce reasonable results. The stress distribution, shown in Figures 4.6 and 4.7, has a peak value of 22 MPa. This is comparable to the peak of 20 MPa seen in the Visible Human model; the slight increase can be attributed to the thinner material, resulting in less deflection and therefore a smaller contact area. Also note that the contact areas are roughly the same shape and in the same locations as those of the unmodified Open Knee model, but they are notably smaller and with more concentrated stresses. This corroborates the idea that large contact areas contributed to 37

4.1. VALIDATION

CHAPTER 4. SIMULATION & RESULTS

Figure 4.5: von Mises stress at cartilage surfaces on the Open Knee model (MPa). 38

CHAPTER 4. SIMULATION & RESULTS

4.1. VALIDATION

Figure 4.6: von Mises stress at cartilage surfaces on the modified Open Knee model (MPa). 39

4.2. THICKNESS ANALYSIS

CHAPTER 4. SIMULATION & RESULTS

Figure 4.7: Cross-section through areas of peak stress. the very low stress seen in the unmodified Open Knee model.

4.2

Thickness analysis

The discrepancy between articular cartilage thickness in the Visible Human and Open Knee models was investigated by adjusting the cartilage thickness of the modified Open Knee model. Using the code in Appendix A.3, several different models were created with varying cartilage thickness. This was done simply by adjusting the z coordinate of the nodes attached to the articular cartilage. The articulating surfaces of the cartilage were held in place; the surface directly connected to the bones were translated into the bones, thereby increasing the thickness; and the interior cartilage nodes were translated proportionally to their proximity to bone. This resulted in a generally uniform increase in element thickness throughout the articular cartilage. By only adjusting the z coordinate, unusual geometry is created when the cartilage is not normal to the z -axis. Particularly toward the far anterior and posterior of the femoral cartilage, the elements can be seen to have taken on a rather sheared appearance when the desired offset is high. Fortunately, though, these highly-angled surfaces tend to be quite distant from the areas where the cartilage comes in contact, implying that it should have little effect on the results. As is obvious in Figure 4.8, there is a direct linear relation between cartilage thickness and total deflection, with each additional millimetre of cartilage resulting in approximately 0.4 millimetres of additional deflection. Stress, as shown in Figure 4.9 appears to vary inversely with total undeformed thickness, t, in the form of   t-1 . Both of these results are what would be expected of a linear elastic material. The thickest model 40

CHAPTER 4. SIMULATION & RESULTS

4.2. THICKNESS ANALYSIS

experiences compressive stretches as low as 0.73, while the thinnest sees 0.70; therefore, though the cartilage material responds nonlinearly to loading, the difference between what is experienced by these models is small enough to observe a linear relation.

2.2 2.0 1.8 Joint deflection (mm) 1.6 1.4 1.2 1.0 0.8 1 1 0 2 3 Change in total undeformed thickness (mm) 4

Figure 4.8: Maximum deflection at each tested thickness offset. The load-deflection curves of the various models, seen in Figure 4.10, reveal some interesting information. In addition to the modified Open Knee model at various thickness offsets, this figure includes the Visible Human model and the data reported by Kurosawa et al. [7], with error bars indicating one standard deviation, as tabulated in Table 4.1. Note that the stepped appearance of the curve from the Visible Human model is a byproduct of the augmented Lagrangian method used to enforce contact, which incrementally adjusts contact enforcement parameters; the Open Knee model uses the simpler penalty method, resulting in smoother curves. 41

4.2. THICKNESS ANALYSIS

CHAPTER 4. SIMULATION & RESULTS

35 30 Maximum stress (MPa) 25 20 15 10 1

1 0 2 3 Change in total undeformed thickness (mm)

4

Figure 4.9: Maximum stress found at each tested thickness offset.

From these curves, it is apparent that a small change in cartilage thickness can give a response well away from the mean. This would imply that the relation between articular cartilage thickness and material stiffness is fairly consistent across a large group of people. Furthermore, it may be safe to assume that thickness and material stiffness are not directly related to each other; this would further imply that both thickness and stiffness are fairly consistent across a large group of people. Also notable is the fact that the response of the Visible Human model lies between those of default and +1 mm modified Open Knee models. Though the Visible Human model was measured as being about 1.7 mm thicker than the default Open Knee model, its response is not similar to a 1.7 mm offset. This is likely caused by variations in cartilage thickness throughout the model. For example, at the point of contact on the lateral 42

CHAPTER 4. SIMULATION & RESULTS

4.2. THICKNESS ANALYSIS

2.5 2.0 Joint deflection (mm) 1.5 1.0 0.5 0.0200

+4.0 mm +3.0 mm +2.0 mm +1.0 mm +0.0 mm -1.0 mm Visible Human Kurosawa data

0

200

400

600 800 Load (N)

1000 1200 1400 1600

Figure 4.10: Load-deflection curves at each tested thickness offset.

condyle, the Visible Human model is just 3.9 mm thick, less than the 4.2 mm measured in the Open Knee model. So, though the two geometries are different, variations within them apparently balance to create a fairly consistent response. Finally, the maximum stress distributions at articulating surfaces are shown in Figures 4.11 and 4.12. As would be expected from the fact that deflection increases with thickness, it can be seen that contact areas also increase with thickness. Though the general shape of the contact areas remains consistent, the increasing thickness brings more cartilage in contact. Also, the peak stress can be seen to shift from the lateral condyle to the medial condyle with increasing thickness. As is seen in Figure 4.7, articular cartilage on the lateral condyle is notably thinner with the initial geometry. Since the offset applied here is distributed equally across all areas of cartilage, the thicker models have 43

4.3. FLEXION ANALYSIS

CHAPTER 4. SIMULATION & RESULTS

a less pronounced difference between the two condyles, thereby preventing stress from concentrating.

(a) -1 mm

(b) 0 mm

(c) +2 mm

(d) +4 mm

Figure 4.11: Stress at femoral cartilage surface at different thickness offsets.

4.3

Flexion analysis

The modified Open Knee model was further analyzed by loading it while under flexion. This was done with a further modification of the model used for validation in Section 4.1.3. The femur is rotated around the x-axis to the desired flexion angle, allowing the ligaments to naturally hold it in position; then, load is applied along the z -axis up to 44

CHAPTER 4. SIMULATION & RESULTS

4.3. FLEXION ANALYSIS

(a) -1 mm

(b) 0 mm

(c) +2 mm

(d) +4 mm

Figure 4.12: Stress at tibial cartilage surface at different thickness offsets.

1500 N. All other boundary conditions are identical to those specified in Section 4.1.2. Note that, since rotation about the x-axis is fixed, no torsions or moments are carried by the articular cartilage. Note that, in this analysis, the tibia remains parallel to the superior-inferior (z ) axis. Therefore, this loading condition is analogous to a person carrying a heavy weight in front of them; the body leans back to counterbalance the weight, but the tibia stays upright under the centre of gravity. This is different from a person squatting, which would see the tibia rotate along with the femur; such a loading condition would require menisci or the patella to prevent the femoral condyles from slipping off of the tibial plateau. Since menisci and the patella are not included in this model, such a loading condition is not tested. 45

4.3. FLEXION ANALYSIS

CHAPTER 4. SIMULATION & RESULTS

The maximum stress in the cartilage can be seen to generally rise with the flexion angle, as is shown in Figure 4.13, though it wavers as the flexion angle rises above 40 .

31 30 29 Maximum stress (MPa) 28 27 26 25 24 23 220 10 20 30 40 Flexion angle (degrees) 50 60

Figure 4.13: Maximum stress found at each tested flexion angle. The maximum deflection follows a similar relationship, as can be seen in Figure 4.14. The same rise-and-fall seen in Figure 4.13 appears here, though it rises quickly even at a 5 flexion, the peak comes at a much lower angle of about 20 , and the fall is much more severe from 30 onward. This gradual rise and levelling of the maximum stress can be seen as a result of the geometry of the femoral condyles that can be seen in Figure 4.15. At 0 flexion, the contact areas of the condyles are relatively large and flat; at higher flexions, more curved portions of the condyles are brought into contact. As is seen in Figure 4.16, this results in smaller contact areas, creating more concentrated stresses. The slight decrease can similarly be attributed to a slightly flatter area toward the posterior of the condyle that 46

CHAPTER 4. SIMULATION & RESULTS

4.3. FLEXION ANALYSIS

1.35 1.30 1.25 1.20 1.15 1.10 1.050 10 20 30 40 Flexion angle (degrees) 50 60

Deflection (mm)

Figure 4.14: Maximum deflection at each tested flexion angle. would come in contact only at higher flexions. Interesting to note is the change in contact locations on the tibial cartilage, as seen in Figure 4.17. As the flexion angle increases, the contact areas move slightly toward the posterior of the tibial cartilage. Since translation of the femur is not directly constrained, this phenomenon must be caused solely by the four ligaments that connect the two bones. This has been observed even in intact knees, where "at these larger angles of flexion the femoral condyles ride on the posterior aspects of the menisci" [6]. Therefore, the ligaments in this model appear to be able to produce realistic behaviour.

47

Figure 4.15: Profile of the femoral cartilage through one point of contact.

(a) 0 flexion

(b) 10 flexion

(c) 30 flexion

(d) 60 flexion

Figure 4.16: Stress at femoral cartilage surface at different flexions.

(a) 0 flexion

(b) 10 flexion

(c) 30 flexion

(d) 60 flexion

Figure 4.17: Stress at tibial cartilage surface at different flexions.

Chapter 5 Summary & conclusions
The purpose of this thesis was to produce an accurate articular cartilage material model for a general-purpose finite element model of a knee joint. In Chapter 2, this model was developed. The stress-stretch curve for a six-parameter Ogden material was fitted to data from several experiments. This produced hyperelastic relations for human articular cartilage at both steady-state and physiological loading rates. The steady-state material was noted only for potential future use, while the physiological rate material was used for all analysis here. To test the performance of this material model, a finite element model of the knee joint was created in Chapter 3. This model included only bone and articular cartilage geometry; ligaments and tendons were ignored due to their having little effect in compression, while menisci were ignored to emphasize the effects of the cartilage material model. Convergence testing was performed to find an optimum element density. In Section 4.1, the complete model was then validated against experimentally determined load-deflection data of whole knee joints. Data for knees which had undergone full meniscectomies was used to match the simplified geometry of the finite element model. At loads up to 1500 N, corresponding to roughly double average body weight, the model experienced joint deflection within a fraction of a standard deviation of the experimental data. An alternate finite element model was similarly tested. Though it performed poorly, replacing its cartilage material model with the material model created here allowed it to perform as well as the previous model. Finally, two sets of parametric analyses were performed. In Section 4.2, the thickness 51

5.1. FUTURE WORK

CHAPTER 5. SUMMARY & CONCLUSIONS

of the articular cartilage geometry was varied, then loading was applied as before. It was found that both load-deflection and load-stress responses are strongly dependent on articular cartilage thickness. This leads to the conclusion that thickness must not vary widely amongst humans. In Section 4.3, the knee was passively flexed to various angles before loading. Stress and deflection both increased when compared to 0 flexion due to more curved cartilage geometry. Furthermore, passive positioning caused by the ligament models resulted in changed contact locations consistent with observations in real knees. The following conclusions are inferred: 1. The Ogden material parameters found here can accurately represent articular cartilage under high loads. 2. Knee articular cartilage thickness must not vary widely amongst the population. 3. Loading the knee while under flexion can concentrate stresses.

5.1

Future work

To make this model more generally useful, it will need to be validated under a wider variety of loading conditions. There are a number of resources in the literature that could be used for purposes of comparison [8­10], but these require additional features to be present in the model. Therefore, to perform these validations, the following enhancements to the model are recommended.

5.1.1

Geometry

Adding ligaments to the model is important to allow for passive flexion of the joint. The ability to model passive flexion would, in turn, allow for validation against against the study performed by Kdolsky et al. [9]. In contrast to the Visible Human model created in Chapter 3, the Open Knee model already contains ligaments and has had basic testing in passive flexion [15]. Therefore, it is recommended to use the Open Knee model for future work. Geometry for the patella, along with related cartilage and ligaments, would also improve the model. Large amounts of force can pass through the patella, particularly 52

CHAPTER 5. SUMMARY & CONCLUSIONS

5.1. FUTURE WORK

at high flexions [1]. Furthermore, it would allow for validation against the work of Herberhold et al. [8], which includes cartilage deformation data more detailed than that used for validation thus far. Therefore, it is recommended that such geometry be created and added to the model.

5.1.2

Material

The main flaw in the cartilage material model is that a hyperelastic material alone does not model the viscous time-dependent response of actual cartilage. Time-dependent response is necessary to model different loading rates and could be validated against the work of Martin et al. [10]. Though there are numerous ways to model viscous material response, a poroelastic or biphasic approach, as used in many other studes [20­26], could be most effective. In such a material model, the steady-state Ogden material created in Section 2.3.1 could potentially be used to represent the solid phase. Therefore, it is recommended that such a material model be created to use with the knee model. Another important flaw is the homogeneity and isotropy of the cartilage material. Though a homogeneous isotropic material can effectively model articular cartilage as a whole, it cannot accurately reproduce the relationships between its different layers [17]. The Open Knee model allows for three distinct layers of cartilage material, though it does not yet take advantage of them. Since such an improvement to the model would allow for better insight into cartilage behaviour, it is recommended that unique properties be determined for each layer.

53

Appendix A Code
Several short programs were written for this project; relevant ones are included in their entirety here. These were written in Python 2.7, taking advantage of the NumPy, SciPy, SymPy, and Matplotlib libraries.

A.1

febio-validation.py

This program was used in validating FEBio's material model implementations, as discussed in Section 2.2. Though only validation of the Ogden model was covered in this thesis, this code is also capable of validating neo-Hookean and Mooney-Rivlin materials against results from FEBio. It does so using symbolic mathematics; the materials' strain-energy density equations are hard-coded, allowing the software to automatically derive the equation for the corresponding stress-stretch curve. 1 2 3 4 5 6 7 8 9 #! / u s r / b i n / env python2 import sympy , pylab from numpy import arange , a r r a y l n l 1 = sympy . symbol . Symbol ( ' l n l 1 ' ) s t r e t c h 1 = sympy . exp ( l n l 1 ) s t r e t c h 2 = s t r e t c h 1  - 0.5 s t r e t c h 3 = s t r e t c h 1  - 0.5

55

A.1. FEBIO-VALIDATION.PY

APPENDIX A. CODE

10 11 12 F = sympy . Matrix ( ( ( s t r e t c h 1 , 0 , 0 ) , ( 0 , s t r e t c h 2 , 0 ) , ( 0 , 0 , stretch3 ) ) ) 13 J = F . d e t ( ) 14 15 16 def m o o n e y r i v l i n (C1 , C2 , K) : 17 Fbar = J  ( sympy . S( - 1) /3 )  F 18 Cbar = Fbar . t r a n s p o s e ( )  Fbar 19 I b a r 1 = Cbar . t r a c e ( ) 20 Ibar2 = 0 21 for i in range ( 3 ) : 22 Csub = Cbar [ : , : ] 23 Csub . c o l d e l ( i ) 24 Csub . r o w d e l ( i ) 25 I b a r 2 += Csub . d et ( ) 26 27 W = C1  ( Ibar1 -3) + C2  ( Ibar2 -3) + 0 . 5  K ( sympy . l n ( J ) )  2 28 return W 29 30 31 def ogden ( c , m, K) : 32 N = min ( ( l e n ( c ) , l e n (m) ) ) 33 W = 0 . 5  K ( sympy . l n ( J ) )  2 34 for i in range (N) : 35 W += ( s t r e t c h 1  m[ i ] + s t r e t c h 2  m[ i ] + s t r e t c h 3  m[ i ] - 3 )  c [ i ] / (m[ i ] m[ i ] ) 36 return W 37 38 39 def neo hookean (E , nu ) :

56

APPENDIX A. CODE 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 lam = E nu / ( (1+nu )  (1 - 2  nu ) ) mu = 0 . 5  E / (1+nu )

A.1. FEBIO-VALIDATION.PY

C = F. transpose ()  F I 1 = C. t r a c e ( ) W = 0 . 5  mu  ( I1 -3) - mu sympy . l n ( J ) + 0 . 5  lam  ( sympy . l n ( J ) )  2 return W

from s y s import argv i f argv [ 1 ] == 'mr ' : matl = m o o n e y r i v l i n ( - 84.76 , 1 7 . 3 5 , 1 e6 ) data = open ( ' mooney- r i v l i n -FE . data ' ) l e g e n d = ( 'M -R c a l c u l a t e d ' , 'M -R FE ' ) e l i f argv [ 1 ] == ' ogden ' : matl = ogden ( [ 6 . 3 , 0 . 0 1 2 , - 0 . 1 ] , [ 1 . 3 , 5 . 0 , - 2 . 0 ] , 1 e6 ) data = open ( ' ogden-FE . data ' ) l e g e n d = ( ' Ogden c a l c u l a t e d ' , ' Ogden FE ' ) e l s e : print 'A r e a l m a t e r i a l , p l e a s e ! ' s t r e s s = sympy . d i f f ( matl , l n l 1 ) x1 = arange ( 0 . 5 , 2 , 0 . 0 0 5 ) y1 = [ s t r e s s . e v a l f ( subs={ l n l 1 : sympy . l n ( i ) } ) for i in x1 ] #Must d i f f e r e n t i a t e w i t h r e s p e c t t o l n ( s t r e t c h ) , as per b o n e t 9 7 pylab . p l o t ( x1 , y1 , ' b ' ) x2 = [ ] y2 = [ ] try : for l i n e in data . r e a d l i n e s ( ) :

57

A.2. CURVEFIT.PY

APPENDIX A. CODE

71 pt = l i n e . s p l i t ( ) [ 0 : 2 ] 72 x2 . append ( f l o a t ( pt [ 0 ] ) ) 73 y2 . append ( f l o a t ( pt [ 1 ] ) ) 74 pylab . p l o t ( x2 , y2 , ' g ' , l i n e w i d t h =4) 75 except NameError : pass 76 77 f e b s t r e s s = a r r a y ( y2 ) 78 m a t l s t r e s s = a r r a y ( [ s t r e s s . e v a l f ( subs={ l n l 1 : sympy . l n ( i ) } ) for i in x2 ] ) 79 S St o t = sum ( ( f e b s t r e s s - sum ( f e b s t r e s s ) / l e n ( f e b s t r e s s ) )  2 ) 80 S S e r r = sum ( ( f e b s t r e s s - m a t l s t r e s s )  2 ) 81 R2 = 1 - S S e r r / SStot 82 print ' Goodness o f f i t : %s ' % R2 83 84 pylab . l e g e n d ( l eg e nd , l o c= ' l o w e r r i g h t ' ) 85 pylab . x l a b e l ( ' S t r e t c h ' ) 86 pylab . y l a b e l ( ' S t r e s s ( Pa ) ' ) 87 #p y l a b . s a v e f i g ( ' f e b i o - v a l i d a t i o n . p d f ' ) 88 pylab . show ( )

A.2

curvefit.py

This program was used to fit material parameters to the experimental stress-stretch data for cartilage, as discussed in Section 2.3. The centrepiece of this program is SciPy's least squares optimization routine. As in febio-validation.py, this can be used to fit linear elastic, Mooney-Rivlin, and Ogden materials (though not neo-Hookean), but was used primarily for Ogden. As an optimization, the automatic derivation of the Ogden stress-stretch curve was replaced with the manually derived Equation 2.19. 1 #! / u s r / b i n / env python2 2 import sympy , pylab , numpy , s y s 3 from s c i p y . o p t i m i z e import l e a s t s q 58

APPENDIX A. CODE 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 from math import l o g , exp #Read i n d a t a . with open ( s y s . argv [ 1 ] ) as data : stretch = [ ] stress = [] for pt in data . r e a d l i n e s ( ) : ( x , y ) = pt . s p l i t ( ' , ' ) try : s t r e t c h . append ( f l o a t ( x ) ) s t r e s s . append ( f l o a t ( y ) ) except Val ueErro r : pass s t r e t c h = numpy . a r r a y ( s t r e t c h ) s t r e s s = numpy . a r r a y ( s t r e s s )

A.2. CURVEFIT.PY

try : matltype = s y s . argv [ 2 ] except I n d e x E r r o r : matltype = ' ogden ' i f matltype == ' l i n e a r ' : def m a t l s t r e s s ( p , l 1 ) : return p [ 0 ]  ( l 1 - 1 ) + p [ 1 ] p g u e s s = [ 1 7 . 4 e6 , - 0.708 e6 ] e l i f matltype == 'mr ' : l n l 1 = sympy . symbol . Symbol ( ' l n l 1 ' ) s t r e t c h 1 = sympy . exp ( l n l 1 ) s t r e t c h 2 = s t r e t c h 1  - 0.5 s t r e t c h 3 = s t r e t c h 1  - 0.5 F = sympy . Matrix ( ( ( s t r e t c h 1 , 0 , 0 ) , ( 0 , s t r e t c h 2 , 0 ) , ( 0 , 0 , stretch3 ) ) )

59

A.2. CURVEFIT.PY 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 C = F. transpose ()  F I 1 = C. t r a c e ( ) I2 = 0 for i in range ( 3 ) : Csub = C [ : , : ] Csub . c o l d e l ( i ) Csub . r o w d e l ( i ) I 2 += Csub . d et ( )

APPENDIX A. CODE

dI1 = sympy . d i f f ( I1 , l n l 1 ) dI2 = sympy . d i f f ( I2 , l n l 1 ) def m a t l s t r e s s ( p , l 1 ) : s = p [ 0 ]  dI1 + p [ 1 ]  dI2 return numpy . a r r a y ( [ f l o a t ( s . e v a l f ( subs={ l n l 1 : l o g ( i ) } ) ) for i in l 1 ] ) pguess = [100 , 20] e l i f matltype == ' ogden ' : def m a t l s t r e s s ( p , l 1 ) : s = 0 #a s s e r t l e n ( p )%2 == 0 for i in range ( 0 , l e n ( p ) , 2 ) : #Hand- d e r i v e d s t r e s s - s t r e t c h f u n c t i o n . s += p [ i ] / p [ i +1]  ( l 1  p [ i +1] - l 1  ( - p [ i + 1 ] / 2 . 0 ) ) return s #p g u e s s = [ 2 . 3 e9 , 0 . 2 4 , - 2.4 e9 , 0 . 0 3 5 , 1 . 3 e8 , - 2 . 3 ] p g u e s s = [ 4 . 2 5 8 8 1 7 3 2 e + 0 9 , 2 . 9 6 2 3 2 3 6 2 , - 8.51024477 e +09 ,2.39944995 , 4.25374435 e +09 ,1.83572264]

62 63 e l s e : 64 print 'A r e a l m a t e r i a l , p l e a s e . ' 65 sys . exit (1)

60

APPENDIX A. CODE 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88

A.3. OFFSET.PY

def r e s i d u a l s ( p ) : return m a t l s t r e s s ( p , s t r e t c h ) - s t r e s s p b e s t = l e a s t s q ( r e s i d u a l s , pguess , maxfev =150000) [ 0 ] print ' Optimal p a r a m e t e r s : %s ' % p b e s t S St o t = sum ( ( s t r e s s - sum ( s t r e s s ) / l e n ( s t r e s s ) )  2 ) S S e r r = sum ( ( s t r e s s - m a t l s t r e s s ( pbest , s t r e t c h ) )  2 ) R2 = 1 - S S e r r / SStot print ' Goodness o f f i t : %s ' % R2 #m a t l s t r e t c h = numpy . arange ( s t r e t c h [ 0 ] , s t r e t c h [ - 1] , 0 . 0 0 1  ( s t r e t c h [ - 1] - s t r e t c h [ 0 ] ) ) m a t l s t r e t c h = numpy . arange ( 0 . 1 , 2 , 0 . 0 0 1 ) pylab . s c a t t e r ( s t r e t c h , s t r e s s , c= ' g ' ) xlim = pylab . xlim ( ) ylim = pylab . ylim ( ) pylab . p l o t ( m a t l s t r e t c h , m a t l s t r e s s ( pbest , m a t l s t r e t c h ) , ' b ' ) pylab . p l o t ( m a t l s t r e t c h , m a t l s t r e s s ( pguess , m a t l s t r e t c h ) , ' r ' ) pylab . xlim ( xlim ) pylab . ylim ( ylim ) pylab . show ( )

A.3

offset.py

This program was used to create versions of the Open Knee model with different cartilage thicknesses. It reads in the default FEBio input file of the Open Knee model and creates a new input file with the total cartilage thickness changed by the amount specified as the first argument to the program. This program operates on the basis that each piece of articular cartilage in the Open 61

A.3. OFFSET.PY

APPENDIX A. CODE

Knee model is divided into three layers of brick elements, with each layer given its own material definition. Though all layers are given the same properties, the fact that they are distinguished allows the code to determine where a node resides within the cartilage. All nodes connected to the bottom layer of cartilage (closest to bone) are processed into one set, while nodes connected to the middle layer are processed into another; the differences between these sets gives the top and bottom sets of nodes, while the intersection gives the middle set. The bottom node set is translated in the z direction by half of the total desired offset, while middle and top node sets are translated proportionally in the same direction. This is repeated on both pieces of cartilage to achieve the total desired offset. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 #! / u s r / b i n / env python2 import xml . e t r e e . cElementTree as e t r e e i n p = e t r e e . ElementTree ( ' f e b i o s p e c ' , ' 0 0 . f e b ' ) # Find m a t e r i a l i d o f c a r t i l a g e l a y e r s . for mat in i np . f i n d ( ' M a t e r i a l ' ) : i f mat . g e t ( ' name ' ) == ' f c a r t m ' : f c a r t m i d = mat . g e t ( ' i d ' ) e l i f mat . g e t ( ' name ' ) == ' f c a r t b ' : f c a r t b i d = mat . g e t ( ' i d ' ) e l i f mat . g e t ( ' name ' ) == ' tcartm ' : t c a r t m i d = mat . g e t ( ' i d ' ) e l i f mat . g e t ( ' name ' ) == ' t c a r t b ' : t c a r t b i d = mat . g e t ( ' i d ' ) # Find a l l nodes t h a t are p a r t o f t h e c a r t i l a g e m a t e r i a l # ( e x c l u d i n g t h e o u t e r m o s t l a y e r , which i s not b e i n g m o d i f i e d ) . f top nodes = set () ; f bottom nodes = set () t top nodes = set () ; t bottom nodes = set () for elem in i np . f i n d ( ' Geometry ' ) . f i n d ( ' Elements ' ) : i f elem . g e t ( ' mat ' ) == f c a r t m i d : f t o p n o d e s . update ( elem . t e x t . s p l i t ( ' , ' ) ) 62

APPENDIX A. CODE 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55

A.3. OFFSET.PY

e l i f elem . g e t ( ' mat ' ) == f c a r t b i d : f b o t t o m n o d e s . update ( elem . t e x t . s p l i t ( ' , ' ) ) e l i f elem . g e t ( ' mat ' ) == t c a r t m i d : t t o p n o d e s . update ( elem . t e x t . s p l i t ( ' , ' ) ) e l i f elem . g e t ( ' mat ' ) == t c a r t b i d : t b o t t o m n o d e s . update ( elem . t e x t . s p l i t ( ' , ' ) ) # f f f S e p a r a t e t h e found nodes i n t o t h r e e l a y e r s f o r d i s p l a c e m e n t . mid nodes = f top nodes . i n t e r s e c t i o n ( f bottom nodes ) top nodes . difference update ( f mid nodes ) bottom nodes . difference update ( f mid nodes )

t mid nodes = t top nodes . i n t e r s e c t i o n ( t bottom nodes ) t top nodes . d if fer en ce up da te ( t mid nodes ) t bottom nodes . d i f f e r e n c e u p d a t e ( t mid nodes ) # Move each node i n t h e z d i r e c t i o n by an amount d e p e n d i n g on # i t s l a y e r and t h e r e q u e s t e d t h i c k e n i n g . import s y s ; t h i c k e n = f l o a t ( s y s . argv [ 1 ] ) t bottom move = -f bottom move f bottom move = t h i c k e n / 2 ; f mid move = f bottom move  2 . 0 / 3 ; t mid move = -f mid move f t o p m o v e = f bottom move / 3 ; t t o p m o v e = -f t o p m o v e def move node ( n t e x t , move z ) : x = map( f l o a t , n t e x t . s p l i t ( ' , ' ) ) x [ 2 ] += move z return ' , ' . j o i n (map( s t r , x ) ) for node in i np . f i n d ( ' Geometry ' ) . f i n d ( ' Nodes ' ) : i f node . g e t ( ' i d ' ) in f t o p n o d e s : node . t e x t = move node ( node . t e x t , f t o p m o v e ) e l i f node . g e t ( ' i d ' ) in f m i d n o d e s :

63

A.3. OFFSET.PY

APPENDIX A. CODE

56 node . t e x t = move node ( node . t e x t , f mid move ) 57 e l i f node . g e t ( ' i d ' ) in f b o t t o m n o d e s : 58 node . t e x t = move node ( node . t e x t , f bottom move ) 59 e l i f node . g e t ( ' i d ' ) in t t o p n o d e s : 60 node . t e x t = move node ( node . t e x t , t t o p m o v e ) 61 e l i f node . g e t ( ' i d ' ) in t m i d n o d e s : 62 node . t e x t = move node ( node . t e x t , t mid move ) 63 e l i f node . g e t ( ' i d ' ) in t b o t t o m n o d e s : 64 node . t e x t = move node ( node . t e x t , t bottom move ) 65 66 # Give an a p p r o p r i a t e d i s p l a c e m e n t o u t p u t f i l e n a m e . 67 for i in i np . f i n d ( ' Output ' ) . f i n d ( ' l o g f i l e ' ) . f i n d a l l ( ' rigid body data ' ) : 68 i f i . g e t ( ' f i l e ' ) i s not None : 69 i . a t t r i b [ ' f i l e ' ] = s y s . argv [ 1 ] + '- d i s p l a c e m e n t . t x t ' 70 71 # Write t o f i l e . 72 with open ( s y s . argv [ 1 ] + ' . f e b ' , 'w ' ) as out : 73 i n p . w r i t e ( out , e n c o d i n g="ISO -8859-1" , x m l d e c l a r a t i o n=True )

64

References
[1] C. R. Ethier and C. A. Simmons, Introductory Biomechanics: From Cells to Organisms. Cambridge: Cambridge University Press, 2007. [2] National Collaborating Centre for Chronic Conditions, Osteoarthritis: National clinical guideline for care and management in adults. London: Royal College of Physicians, 2008. [3] Ontario Health Quality Council, "Q Monitor: 2010 report on Ontario's health system," 2010. http://ohqc.ca/pdfs/2010_report_-_english.pdf. [4] W. R. Krause, M. H. Pope, R. J. Johnson, and D. G. Wilder, "Mechanical changes in the knee after meniscectomy," Journal of Bone and Joint Surgery, vol. 58, pp. 599­ 604, 1976. [5] B. B. Seedhom, "Transmission of the load in the knee joint with special reference to the role of the menisci. part i: Anatomy, analysis and apparatus," Engineering in Medicine, vol. 8, pp. 207­219, 1979. [6] B. B. Seedhom and D. J. Hargreaves, "Transmission of the load in the knee joint with special reference to the role of the menisci. part ii: Experimental results, discussion and conclusions," Engineering in Medicine, vol. 8, pp. 220­228, 1979. [7] H. Kurosawa, T. Fukubayashi, and H. Nakajima, "Load-bearing more of the knee joint," Clinical Orthopaedics and Related Research, vol. 149, pp. 283­290, 1980. [8] C. Herberhold, S. Faber, T. Stammberger, M. Steinlechner, R. Putz, K. H. Englmeier, M. Reiser, and F. Eckstein, "In situ measurement of articular cartilage 65

REFERENCES

REFERENCES

deformation in intact femoropatellar joints under static loading," Journal of Biomechanics, vol. 32, pp. 1287­1295, 1999. [9] R. K. Kdolsky, B. Al Arabid, M. Fuchs, R. Schabus, and V. V´ ecsei, "Measuring the pressure pattern of the joint surface in the uninjured knee," The Middle European Journal of Medicine, vol. 116, pp. 196­200, 2004. [10] K. J. Martin, C. P. Neu, and M. L. Hull, "Quasi-steady-state displacement response of whole human cadaveric knees in a mri scanner," Journal of Biomechanical Engineering, vol. 131, 2009. [11] H. Gray, Anatomy of the Human Body. Philadelphia: Lea and Febiger, 20 ed., 1918. [12] B. Poto cnik, D. Zazula, B. Cigale, D. Heric, E. Cibula, and T. Toma zi c, "A patientspecific knee joint computer model using mri data and `in vivo' compressive load from the optical force measuring system," Journal of Computing and Information Technology, vol. 16, pp. 209­222, 2008. ¨ [13] C. Ohman, D. M. Espino, T. Heinmann, M. Baleani, H. Delingette, and M. Viceconti, "Subject-specific knee joint model: Design of an experiment to validate a multi-body finite element model," Visual Computer, 2010. In Press. [14] T. Heimann, F. Chung, H. Lamecker, and H. Delingette, "Subjectspecific ligament models: Towards real-time simulation of the knee joint," in Computational Biomechanics for Medicine IV Workshop 2009, September 2009. ftp://ftp-sop.inria.fr/asclepios/Publications/Herve.Delingette/HeimannBiomechanicsWorkshop09.pdf. [15] A. Erdemir and S. Sibole, Open Knee: A Three-Dimensional Finite Element Representation of the Knee Joint, User's Guide. Lerner Research Institute, Cleveland Clinic, 1.0.0 ed., 2010. https://simtk.org/home/openknee. [16] C. P. Brown, T. C. Nguyen, H. R. Moody, R. W. Crawford, and A. Oloyede, "Assessment of common hyperelastic constituitive equations for describing normal and osteoarthritic articular cartilage," Journal of Engineering in Medicine, vol. 223, pp. 643­652, 2009. 66

REFERENCES

REFERENCES

[17] J. S. Bell, C. P. Winlove, C. W. Smith, and H. Dehghani, "Modeling the steadystate deformation of the solid phase of articular cartilage," Journal of Biomaterials, vol. 30, pp. 6394­6401, 2009. [18] F. H. Silver, G. Bradica, and A. Tria, "Viscoelatic behaviour of osteoarthritic cartilage," Connective Tissue Research, vol. 42, pp. 223­233, 2001. [19] G. Bradica, The effects of osteoarthritis on the viscoelastic properties of human articular cartilage. PhD thesis, Rutgers, The State University of New Jersey, 2003. [20] C. M. Goreham-Voss, T. O. McKinley, and T. D. Brown, "A finite element exploration of cartilage stress near an articular incongruity during unstable motion," Journal of Biomechanics, vol. 40, pp. 3438­3447, 2007. [21] S. P. Vadher, H. Nayeb-Hashemi, P. K. Canavan, and G. M. Warner, "Finite element modeling following partial meniscectomy: Effect of various size of resection," in Proceedings of the Annual International Conference of the IEEE Engineering in Medicine and Biology, pp. 2098­2101, 2006. [22] A. Vaziri, H. Nayeb-Hashemi, A. Singh, and B. A. Tafti, "Influence of mensicectomy and meniscus replacement on the stress distribution in human knee joint," Annals of Biomedical Engineering, vol. 36, pp. 1335­1344, 2008. [23] L. P. Li, J. Soulhat, M. D. Buschmann, and A. Shirazi-Adl, "Nonlinear analysis of cartilage in unconfined ramp compression using a fibril reinforced poroelastic model," Clinical Biomechanics, vol. 14, pp. 673­682, 1999. [24] L. P. Li, M. D. Buschmann, and A. Shirazi-Adl, "A fibril reinforced poroelastic model of articular cartilage including depth dependent material properties," Advances in Bioengineering, vol. 43, pp. 213­214, 1999. [25] L. P. Li, M. D. Buschmann, and A. Shirazi-Adl, "A fibril reinforced nonhomogeneous poroelastic model for articular cartilage: Inhomogeneous response in unconfined compression," Journal of Biomechanics, vol. 33, pp. 1533­1541, 2000. [26] R. Shirazi and A. Shirazi-Adl, "Analysis of articular cartilage as a composite using nonlinear membrane elements for collagen fibrils," Medical Engineering & Physics, vol. 27, pp. 827­835, 2005. 67

REFERENCES

REFERENCES

[27] R. Shirazi, A. Shirazi-Adl, and M. Hurtig, "Role of cartilage collagen fibrils network in knee joint biomechanics under compression," Journal of Biomechanics, vol. 41, pp. 3340­3348, 2008. [28] J. Bonet and R. D. Wood, Nonlinear Continuum Mechanics for Finite Element Analysis. Cambridge: Cambridge University Press, 2 ed., 2008. [29] R. W. Ogden and P. Chadwick, "On the deformation of solid and tubular cylinders of incompressible isotropic elastic material," Journal of Mechanics and Physics of Solids, vol. 20, pp. 77­90, 1972. [30] G. Li, O. Lopez, and H. Rubash, "Variability of a three-dimensional finite element model constructed using magnetic resonance images of a knee for joint contact stress analysis," Journal of Biomechanical Engineering, vol. 123, pp. 341­346, 2001. [31] P. Wriggers, Computational Contact Mechanics. Heidelberg: Springer-Verlag, 2 ed., 2006. [32] S. Maas, D. Rawlins, J. Weiss, and G. Ateshian, FEBio User's Manual. Musculoskeletal Research Laboratories, University of Utah, 2010. http://mrl.sci.utah. edu/software/febio. [33] A. Karami, "Experimental and finite element analysis of articular cartilage," Master's thesis, Ryerson University, 2007. [34] O. D´ emarteau, L. Pillet, A. Inaebnit, O. Borens, and T. M. Quinn, "Biomechanical characterization and in vitro mechanical injury of elderly human femoral head cartilage: comparison to adult bovine humeral head cartilage," OsteoArthritis and Cartilage, vol. 14, pp. 589­596, 2006. [35] National Library of Medicine, "The Visible Human Project." http://www.nlm. nih.gov/research/visible/visible_human.html. [36] S. Pieper, M. Halle, and R. Kikinis, "3D Slicer," in Proceedings of the 1st IEEE International Symposium on Biomedical Imaging: From Nano to Macro, pp. 632­ 635, 2004. http://slicer.org/. 68

REFERENCES

REFERENCES

[37] P. Cignoni, M. Corsini, and G. Ranzuglia, "Meshlab: an open-source 3d mesh processing system," ERCIM News, 2008. http://meshlab.sourceforge.net/. [38] C. Geuzaine and J.-F. Remacle, "Gmsh: a three-dimensional finite element mesh generator with built-in pre- and post-processing facilities," International Journal for Numerical Methods in Engineering, vol. 79, no. 11, pp. 1309­1331, 2009. http: //geuz.org/gmsh/. [39] S. Maas, D. Rawlins, and J. Weiss, PreView User's Manual. Musculoskeletal Research Laboratories, University of Utah, 2010. http://mrl.sci.utah.edu/ software/preview. [40] S. Maas, D. Rawlins, J. Weiss, and G. Ateshian, FEBio Theory Manual. Musculoskeletal Research Laboratories, University of Utah, 2010.

69

