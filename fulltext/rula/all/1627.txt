ANALYSIS OF ELECTROCARDIOGRAMS DURING HUMAN VENTRICULAR ARRHYTHMIAS FOR OPTIMIZING TREATMENT OPTIONS
by Krishnanand Balasundaram, B.Eng., Ryerson University, June 2008

A thesis presented to Ryerson University in partial fulfillment of the requirements for the degree of Masters of Applied Science in Electrical and Computer Engineering Toronto, Ontario, Canada, 2012 c Krishnanand Balasundaram, 2012

AUTHOR'S DECLARATION FOR ELECTRONIC SUBMISSION OF A THESIS I hereby declare that I am the sole author of this thesis. This is a true copy of the thesis, including any required final revisions, as accepted by my examiners. I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research. I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. I understand that my thesis may be made electronically available to the public.

ii

Abstract
Analysis of Electrocardiograms During Human Ventricular Arrhythmias for Optimizing Treatment Options, Masters of Applied Science, 2012, Krishnanand Balasundaram, Department of Electrical and Computer Engineering, Ryerson University. Cardiovascular diseases are diseases that arise from abnormal medical conditions of the heart and the circulation system. Ventricular arrhythmias are a subset that originates from rhythm disorders of the lower chambers (ventricles) of the heart. In spite of research and technology advancements, annually 350,000 sudden cardiac deaths are reported in North America (45,000 in Canada) most of which are ventricular fibrillation (VF) related. This serves as a strong motivation to improve upon or optimize the choice of current treatment options from an engineering perspective which could eventually help reduce the number of SCDs. The choice of the treatment vary in general based on the following two categories of affected population and the type of arrhythmia: (1) symptomatic patients who are prone to or have had arrhythmia occurrences and are currently under medical care and (2) people who suffer ventricular arrhythmias in an out-of-the-hospital environment. This thesis, by employing advanced signal analysis, attempts to improve the characterization of the ventricular arrhythmias, thereby providing better discriminatory clues in assisting clinicians and emergency medical staff (EMS) to arrive at optimal treatments options for both the categories of affected population. In the study of symptomatic patients, the organizational structure of the arrhythmia was quantified using wavelet-singular value decomposition analysis, which lead to a novel sub-classification of the ventricular arrhythmia. Classification accuracies of 93.7% for ventricular tachycardia (VT)/nonVT classification and 80% for organized-VF/disorganized-VF classification were achieved. In the study of out-of-the-hospital arrhythmia instances, focal structural variations were analyzed using wavelets, which led to identifying a signal pattern that could serve as an important clue for the EMS personnel to improve the resuscitation outcomes. Using a database of 25 out-of-thehospital arrhythmia segments, the proposed analysis yielded a classification accuracy of 80%.

iii

Acknowledgment
I acknowledge my supervisor Dr. K. Umapathy for his guidance and motivation. I also thankfully acknowledge Dr. P. Dorian, Dr. K. Nanthkumar, Dr. K. Nair and Mr. S. Masse from Toronto General Hospital and St. Michael's Hospital for their valuable clinical expert inputs and access to the intracardiac electrogram and resuscitation database used in this thesis.

iv

Dedication
I lovingly dedicate this thesis to my parents and my brother. They served as an inspiration for my hard work and focus through out my masters. This thesis is a testament to their loving support and guidance.

v

Contents
1 Introduction 1.1 The Cardiac System . . . . . . . . . . . . . . 1.1.1 Cardiac System Physiology . . . . . 1.1.2 Ventricular Arrhythmias . . . . . . . 1.2 Motivation . . . . . . . . . . . . . . . . . . . 1.2.1 Relevance of Engineering Approaches 1.2.2 Objective . . . . . . . . . . . . . . . 1.3 Thesis Outline . . . . . . . . . . . . . . . . . 1 2 2 4 9 10 11 12 14 14 16 17 18 21 26 27 29 30 30 31 32 32 35 35 36 36 41 46 57 60

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

2

Background 2.1 Time Domain Analysis of Ventricular Arrhythmias . . . . . . 2.2 Frequency Domain Analysis of Ventricular Arrhythmias . . . 2.3 Time-Frequency Domain Analysis of Ventricular Arrhythmias 2.3.1 Short Time Fourier Transform . . . . . . . . . . . . . 2.3.2 Wavelet Transform . . . . . . . . . . . . . . . . . . . 2.4 Classification Scheme . . . . . . . . . . . . . . . . . . . . . . 2.4.1 Fisher's Linear Discriminant Analysis . . . . . . . . . 2.4.2 Cross Validation . . . . . . . . . . . . . . . . . . . . 2.4.3 Classification Accuracies . . . . . . . . . . . . . . . . 2.4.4 Receiver Operating Characteristics . . . . . . . . . . . 2.5 Background Summary . . . . . . . . . . . . . . . . . . . . . Ventricular Arrhythmia Analysis for Symptomatic Patients 3.1 Significance of Organizational Structure . . . . . . . . . . . . 3.2 Related Work . . . . . . . . . . . . . . . . . . . . . . . . . . 3.3 Ventricular Arrhythmia Organization Analysis . . . . . . . . . 3.3.1 Database and Preprocessing . . . . . . . . . . . . . . 3.3.2 Frequency Domain . . . . . . . . . . . . . . . . . . . 3.3.3 Wavelet Transform and Image Processing . . . . . . . 3.3.4 Wavelet Transform and Singular Value Decomposition 3.3.5 Endo and Epicardial data . . . . . . . . . . . . . . . . 3.4 Results Review and Discussion . . . . . . . . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

3

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

vi

3.5 4

3.4.1 Review of Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60 3.4.2 Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62 Chapter 3 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63 65 66 67 68 68 69 72 84 86 86 88 88 90 91 92 92 106 106 106 107 107 108 109

Ventricular Arrhythmia Analysis for Out-of-the-Hospital Arrhythmia Incidents 4.1 Significance of Patterns in Ventricular Arrhythmias . . . . . . . . . . . . . . . 4.2 Related Work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.3 Ventricular Arrhythmia Patterns . . . . . . . . . . . . . . . . . . . . . . . . . 4.3.1 Database and Preprocessing . . . . . . . . . . . . . . . . . . . . . . . 4.3.2 Analysis for Pattern Identification . . . . . . . . . . . . . . . . . . . . 4.3.3 Wavelet Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.3.4 Correlation Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.4 Results Review and Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . 4.4.1 Review of Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.4.2 Discussion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.5 Chapter 4 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

5

Conclusions and Future Works 5.1 Summary of Results and Impact . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.2 Potential Applications . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.3 Directions for Future Works . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

A Experimental Results of Pattern Characterization A.1 Experimentally Arrived Average Parameter and Threshold Ranges for Each Pattern A.1.1 Average Parameter and Threshold Ranges for Local Pattern 1 . . . . . . . A.1.2 Average Parameter and Threshold Ranges for Local Pattern 2 . . . . . . . A.1.3 Average Parameter and Threshold Ranges for Local Pattern 3 . . . . . . . A.1.4 Average Parameter and Threshold Ranges for Local Pattern 4 . . . . . . . A.1.5 Average Parameter and Threshold Ranges for Global Pattern . . . . . . . .

B Publications 110 B.1 Journals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110 B.2 Conferences . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110 C Glossary 111

vii

List of Tables
3.1 3.2 3.3 3.4 4.1 A.1 A.2 A.3 A.4 A.5 Level 1 Fourier Domain Classification: VT and non-VT Level 2 Fourier Domain Classification: OVF and DVF Level 1 CWT and SVD Classification: VT and Non-VT Level 2 CWT and SVD Classification: OVF and DVF . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39 39 56 57

Classification: successful and unsuccessful shock outcomes . . . . . . . . . . . . . 81 Average scale factors for pattern 1 . . Average scale factors for pattern 2 . . Average scale factors for pattern 3 . . Average scale factors for pattern 4 . . Average scale ranges for global pattern . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 106 107 108 108 109

viii

List of Figures
1.1 1.2 1.3 1.4 1.5 2.1 2.2 2.3 2.4 2.5 2.6 3.1 3.2 Typical Sinus Rhythm ECG recorded from surface leads . Electrical conduction path of the heart . . . . . . . . . . . Example of patients with VT (part a) and VF (part b) ECG Conduction blocks during VF . . . . . . . . . . . . . . . . Block diagram outlining the work presented in this thesis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3 . 4 . 7 . 8 . 12 19 20 20 23 25 26

Heisenberg uncertainty in Fourier transform [1] . . . . . . . . . . . . . . . . . . . Sample VF signal and corresponding spectrograms with short and long time windows Sample VF signal with corresponding scalogram (y-axis is in normalized frequency) Heisenberg uncertainty in wavelet transform [1] . . . . . . . . . . . . . . . . . . . Complex Morlet wavelet . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Complex Gaussian 2 wavelet . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

Thesis contributions presented in Chapter 3 are highlighted . . . . . . . . . . . . Example of patients with VT (part a) and DVF (part b) ECG and the corresponding Welch periodogram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3.3 Arrhythmia scatter plot with frequency domain features . . . . . . . . . . . . . . 3.4 Example of patients with VT (part a), OVF (part b) and DVF (part c) ECG with corresponding scalograms . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3.5 ROC curves for the time width feature . . . . . . . . . . . . . . . . . . . . . . . 3.6 Average time width boxplot . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3.7 SVD analysis of synthetic VT (part A) and DVF (part B) ECG . . . . . . . . . . 3.8 ROC curves for SVD features . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3.9 VT and Non-VT scatter plot . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3.10 OVF and DVF boxplot for the variance of the dominant U component . . . . . . 3.11 Sample spatial distribution of temporal organization map of the LV endocardium (A) and epicardium(B) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3.12 Phase map and SDTO map comparison . . . . . . . . . . . . . . . . . . . . . . 4.1 4.2 4.3

. 33 . 37 . 40 . . . . . . . 41 45 46 50 54 55 56

. 59 . 60

Thesis contributions presented in Chapter 4 are highlighted . . . . . . . . . . . . . 66 Sample successful and unsuccessful waveforms (with pre-shock, post-shock and defibrillation shock labeled) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70 Four local patterns and one global pattern . . . . . . . . . . . . . . . . . . . . . . 71

ix

4.4 4.5 4.6 4.7 4.8 4.9 4.10 4.11 4.12 4.13

Time-scale plane depiction of local pattern 1 (with the illustration of depolarization and sub-peak) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Time-scale plane depiction of local pattern 2 . . . . . . . . . . . . . . . . . . . . Time-scale plane depiction of local pattern 3 . . . . . . . . . . . . . . . . . . . . Time-scale plane depiction of local pattern 4 . . . . . . . . . . . . . . . . . . . . Time-scale plane depiction of global pattern (with the illustration of the envelope) Pre-shock analysis using local and global patterns . . . . . . . . . . . . . . . . . Successful and unsuccessful pre-shock sample . . . . . . . . . . . . . . . . . . . ROC curve for feature extracted from global pattern . . . . . . . . . . . . . . . . Synthetic global pattern . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Boxplot for average correlation analysis . . . . . . . . . . . . . . . . . . . . . .

. . . . . . . . . .

74 75 76 77 78 82 83 84 85 87

x

Chapter 1 Introduction

T

HE function of the heart, and the cardiovascular system in general, is important in regulating the functions of all other vital organs and systems in the body. The transportation of blood

across the body allows for the exchange of oxygen and carbon dioxide, as well as the exchange of other nutrients to occur. While the rate at which the blood circulates through the body varies depending on the activity being performed, the heart is responsible for providing the necessary pressure to provide the appropriate circulation, which essentially makes the heart an electromechanical pump. The electromechanical function of the heart is controlled by a set of rhythmic impulses that travels through the cardiac muscles causing it to contract and expand. The study of cardiovascular diseases focuses on understanding the problems that causes the variations or changes in the rhythmic heart activity as a result of pathophysiological conditions. The issue that exists with this is that not all the pathophysiological conditions or their effect on the functionality of the heart are known or fully understood. This is especially the case for ventricular arrhythmias, which is a subset of the cardiovascular diseases. Ventricular arrhythmias could be lethal and immediate medical attention is required to avoid sudden cardiac death. The objective of ventricular arrhythmia signal analysis can be broadly classified into two categories. The first is to offer some type of electrocardiogram (ECG) quantification in order to predict a particular event or provide automated detection of particular cases of the arrhythmic activity to arrive at an appropriate therapy. The second category of analysis focuses on the development of tools that can be used to better understand the mechanisms that drive and sustain ventricular ar-

1

rhythmias. The important factor in the analysis is the use of appropriate biomedical engineering approaches in order to capture the relevant signal variations of a particular abnormality.

1.1

The Cardiac System

1.1.1 Cardiac System Physiology
To better understand ventricular arrhythmias, we will first explore the the cardiac system and the mechanisms that are responsible for the regular functions of the heart. The information provided in this section is a brief summary extract from "`Textbook of Medical Physiology"' [2]. For more detailed information on the physiology of the human heart, the readers are referred to the above book. The heart itself consists of four large chambers that are responsible for transporting blood across the body. The four chambers are the left and right atria and ventricle. The right chambers (atria and ventricle) of the heart brings in de-oxygenated blood from the body and pumps it to the lungs. The left chambers (atria and ventricle) receive oxygenated blood from the lungs that needs to be sent to the body. The atria and the ventricles perform specific tasks to achieve the goals set for the left and right chambers. The function of the atria is to receive blood into the heart and pump it into the ventricles. This provides the ventricles with a higher volume of blood, which the ventricles will pump out of the heart. Therefore the heart essentially acts as a pump to transport blood across the body. The blood transports oxygen and other nutrients to vital cells, organs (including the heart itself) and systems, so that the body can continue with its normal functions. Without proper circulation, the brain does not have enough oxygen, as well as diffusion of nutrients and waste cease, and the neuron will degrade. Permanent neural damage will occur without immediate restitution of the blood circulation [3]. The ECG recorded from the surface of the human body depicts the integrated electrical activity that occur on the surface of the heart. For the typical normal sinus ECG [also referred to as sinus rhythm (SR)] shown in Figure 1.1, the P wave of the ECG captures the electrical impulse traveling from the sinoatrial node to the atrioventricular node, which also causes the atria to contract. The QRS complex captures the depolarization of the ventricles and the T wave is caused by the 2

(a) Ideal Sinus Rhythm
Sample SR Signal
600

500

400

Amplitude (Arbitrary units)

300

200

100

0

-100

-200

0

0.5

1

1.5

2

2.5

3

3.5

4

Time (s)

(b) Real Sinus Rhythm ECG

Figure 1.1: Typical Sinus Rhythm ECG recorded from surface leads repolarization of the ventricles. The average regular heart rate while at rest is 72 beats per minute (bpm) [2]. The hearts function is based on the initiation of the electric impulse (action potential) from the sinoatrial node. Once the impulse is activated, it transverses through the muscle fibers of the atrium, which cause the muscles to contract and force the blood into the ventricles. The impulse continues by conducting through the atrioventricular node that slowly conducts the impulse through the purkinje fiber. The impulse finally travels from the purkinje fibers through the ventricle muscle fibers causing the muscles of the ventricles to contract. The process of the atrial and ventricular muscle contraction is known as depolarization. This conduction pathway is depicted in Figure 1.2. The relaxation of the muscle fibers (both atrium and ventricle) is known as repolarization. The atrium and ventricles do not contract at the same time. The ventricles have a delayed contraction because after the atria contracts, time is required for the blood to accumulate within the ventricles. The delayed contraction is caused by the slow conducting purkinje fibers that delay the action potential from entering the ventricle muscles. The electrical signals can also be mapped

3

Figure 1.2: Electrical conduction path of the heart on the outer surface of the heart (Epicardial mapping) or in the inner ventricle wall (Endocardial mapping). The integration of the electrical impulses on the surface of the heart is what is observed as the surface ECG depicted in Figure 1.1.

1.1.2 Ventricular Arrhythmias
Ventricular arrhythmias originate from abnormal contractions of the lower chambers of the heart (ventricles) that could lead to sudden cardiac death (SCD). Deaths caused by ventricular arrhythmias has existed through out the history of mankind. Of the ventricular arrhythmias, ventricular tachycardia (VT) and ventricular fibrillation (VF) are the most prominent types that affects the quality of life. VT is a condition that causes the ventricles to beat (contract and expand) abnormally fast (heart rate around 150 bpm [2]). VF on the other hand, with a heart rate which exceeds

4

that of VT, is a lethal condition because there is no coordinated contractions of the ventricles and would lead to sudden cardiac death if not treated withing minutes of its occurrence. Cases dating back to 1500 BC had indicated the existence of VF in humans resulting in death [4]. With the advances in medical technology and treatment, most other types of diseases have been either eradicated or inhibited with respect to the general health of the public. However, cardiac arrest (mainly due to VF) claims a large percentage of fatalities in the developed world. The deaths caused by these arrhythmias have been estimated to be 350,000 deaths in North America alone on an annual basis [5]. One reason of the large number of fatalities is related to the change in the modern lifestyle. The commercial use of technologies to improve our lifestyle is a common theme in today's society, but it also increases risk factors to cardiac arrest, such as physical inactivity and obesity. This coupled with rise in other factors, for instance smoking, alcohol consumption and in general poor diet choices, has increased the risk of cardiac arrest [6]. Therefore ventricular arrhythmias has been an area of interest for which newer technologies, analysis tools and treatment options are being developed for. As previously mentioned, the most common arrhythmias, and the ones that are relevant to this thesis, are VT and VF, where VT is usually a precursor to VF. An example of each type of ventricular arrhythmia is provided in Figure 1.3. The medical definition of VT is the abnormally fast rhythmical beating of the ventricles. This does not include the increase in heart rate during physical exercise, but rather related to the physiological conditions/factors of the person and/or the heart. Factors such as increased body temperature, stimulation of the heart by nerves from the central nervous system and toxic conditions have been known to cause VT [2]. Patients suffering from VT will have limited circulation because the increase in heart rate hinders the accumulation of blood in the ventricles, therefore reducing the blood traveling through the cardiac system. Patients with VT tend to have shortness of breath, dizziness and even faint. VT has been sub-classified in the medical community as monomorphic VT (MVT) and polymorphic VT (PVT). MVT has a strong organized structure, which indicates that only one or a few stationary sources of electrical activation is sustaining the arrhythmia in the ventricles. PVT however does contain a certain degree of organized activity, but also contains periods of ECG structural variations.

5

VF on the other hand is far more lethal because when a person has VF, the electrical impulses in the ventricles are not rhythmic, which does not allow for a coordinated contraction of the ventricles. Without the coordinated contraction, blood is not being pumped through the ventricles, therefore depriving all organs of oxygen and other vital nutrients. The heart, being a muscle, will also further degrade with the lack of blood flow, which will eventually lead to death, unless resuscitation could take place within a short period of time. Some factors that are known to cause sudden VF are electrical shocks, ischemia (restriction of blood supply) of the heart muscle, ischemia of the heart's specialized conduction system and possibly both [2]. It is also easier to understand why a person suffering from VT is likely to develop VF because with the drop in blood pressure during VT, the heart muscle will degrade due to the lack of sufficient blood flow. Eventually the ventricle muscles will scar (dead muscle tissue) that leads to uncoordinated contractions. When comparing the ECG in Figure 1.3 to the normal sinus rhythm ECG in Figure 1.1, we see some obvious differences. The VT example can be seen to have some regular contractions, but without the rest period between contractions (as depicted by the RR interval in Figure 1.1), the blood pressure is reduced. The ECG of a patient suffering from VF can be seen as unorganized and non-rhythmic. This is because as the heart muscles become deprived of oxygen and other nutrients, the muscle fibers will attempt to create its own electrical activation source in order to contract and pump the blood. When multiple muscle fibers contract (at different instances in time) in an attempt restore blood circulation, it creates an unorganized ECG. The multiple contractions in the ventricular muscle fiber does not effectively produce enough pressure to pump blood through out the body. Also as the muscles of the heart degrade over time (due to lack of blood flow), they will begin to die, therefore creating conduction blocks within the ventricular muscles [2], which inhibit the ability for the electrical impulse to transverse through the ventricles. These conduction blocks further complicate the electrical activations of the heart, as seen in Figure 1.4. The VT and VF arrhythmia examples provided in Figure 1.3 depicts the issue in distinguishing between the ventricular arrhythmia groups. The immediate treatment for a patient with VT is to provide electrical pacing in order to slow the heart rate, where as the only short term (immediate) solution for someone in VF is to provide a defibrillation shocks in an attempt to reset the heart's

6

Sample VT Signal
0.15

0.1

Amplitude (arbitrary units)

0.05

0

-0.05

-0.1

0

0.5

1

1.5

2

2.5

3

3.5

4

Time (s)

(a) VT
Sample VF Signal
0.2

0.15

0.1

Amplitude (arbitrary units)

0.05

0

-0.05

-0.1

-0.15

-0.2

0

0.5

1

1.5

2

2.5

3

3.5

4

Time (s)

(b) VF

Figure 1.3: Example of patients with VT (part a) and VF (part b) ECG

7

Figure 1.4: Conduction blocks during VF

8

function [7]. The long term established solutions for VT are anti-arrhythmic medications, ablation and placement of an implantable cardioverter defibrillator (ICD). The ICD placement for patients with a known history of developing VT is done for two reasons. The first is that if a patient develops VT, the ICD can attempt to pace the heart in order to reduce the heart rate back to a normal rhythm. The other reason is that prolonged VT has the possibility to lead to VF, for which the ICD can apply the appropriate defibrillation shock therapy. For VF, the long term solution is to install an ICD, which is used to monitor and provide defibrillation shocks when necessary. Also, the current ablation strategies cannot be applied for VF treatment since SCD occurs within minutes of VF onset. These treatments are unique to both arrhythmias and will be further discussed in chapter 3.

1.2

Motivation

With a better understanding of ventricular arrhythmias and its effect on patient survival, it is evident that further research is needed to improve the current treatment options such that the annual number of SCDs may be reduced. Despite the amount of research in understanding VF, the mortality rate remains high. This serves as a strong motivation to further optimize the choice (i.e. choose the appropriate) of current treatment options from an engineering perspective to improve survival rate. The current treatment options for ventricular arrhythmias include anti-arrhythmic drugs, controlled pacing of the heart, defibrillation shock, and ablation of the underlying tissue substrate. The choice of the treatment vary in general based on the affected population and the type of arrhythmia. This thesis by employing advanced signal analysis, attempts to improve the characterization of the ventricular arrhythmias, thereby providing better discriminatory clues in assisting clinicians and emergency medical staff (EMS) to choose optimal treatment options. A major bottle neck for progress in this area is the availability of limited data due to ethical constraints and practical difficulties involved in collecting human VF data. Although analysis using animal data is common to this field, the study of human ventricular arrhythmias is more relevant as findings of animal studies cannot be accurately extrapolated due to species differences. In addition, clinical expertise in the area of ventricular arrhythmias is a key factor without which developing methodologies to 9

assist treatments cannot be validated. These limitations however do not affect the proposed work due to the collaborative research effort with Toronto General Hospital and St. Michael's Hospital, Toronto, Canada, and the availability and access to clinical expertise and unique arrhythmia databases. This further strengthens the motivation and provides us with an unique resourceful environment to undertake the study.

1.2.1 Relevance of Engineering Approaches
Biomedical Engineering has helped create a variety of solutions in the medical field because many of the signals within the human body are bio-electric. The end of the 20th century created many technological advancements in bio-instrumentation and signal processing in particular, which helped pave the way for engineers into the field. Tools such as efficient signal acquisition systems and better digital signal processing algorithms allowed engineers to analyze signals in domains familiar to them. Therefore, a collaborative study that incorporates the signal processing expertise from bio-medical engineers and background information from the medical community has created a new field of study for ventricular arrhythmias. VF in particular is a disorganized signal with many temporal and spectral fluctuations. This requires an analysis tool that is well suited to capturing time varying signal structures. Existing signal analysis approaches focus on two main avenues of research in ventricular arrhythmias. The first avenue focuses on developing methodologies that perform automated detection and/or characterization of the arrhythmia using intra cardiac electrograms and ECGs. These tools that have been applied to this field of research have had the primary goal of assisting clinicians in choosing the appropriate treatment options for ventricular arrhythmias. There are two sub groups in the affected population that are of significance to clinicians. The first group refers to patients where arrhythmia symptoms have been identified. These symptomatic patients have either had a previous arrhythmia occurrence or have identified physiological markers that indicates that they are prone to future arrhythmic episodes and are under medical attention. In this group, both short and long term treatments depends on the characteristics of the arrhythmia. Hence, detection and characterization of arrhythmias using signal analysis is of importance. The second group refers

10

to subjects who suffer from arrhythmia occurrences in an out-of-the-hospital environment. For this group of patients, it is important to determine ECG features or characteristics of the arrhythmia in near real time to assist (EMS) personnel to improve the resuscitation success. The second avenue of signal analysis approaches is to develop tools to analyze the varying spatio-temporal electrical patterns in the ventricular arrhythmia in order to attain a better mechanistic understanding. The significance of this research avenue is mainly due to the limited knowledge on the mechanisms that initiate or sustain ventricular arrhythmias. With the identification of mechanisms within ventricular arrhythmias, clinicians can develop treatment options to counter or modulate these mechanisms. The analysis of mechanisms in ventricular arrhythmias can also be used to create models that can be used to develop proactive strategies at the micro or macro organ level.

1.2.2 Objective
The primary objective of this thesis is to arrive at methodologies to assist clinicians in choosing optimal treatment options for symptomatic patients as well as out-of-the-hospital arrhythmia occurrences. · For symptomatic patients, this thesis will study the underlying organizational structure of the arrhythmia in order to improve upon the classification of VT and VF, especially the overlap zone between them. Identifying patients predominantly in the overlap zone is critical as the choice of long and short term treatment options depends on the affinity of the arrhythmia towards VT or VF. · In analyzing out-of-the-hospital arrhythmia occurrences, this thesis will aim to improve upon the prediction of resuscitation outcomes using pattern analysis. This will aid the EMS personnel to choose the right time to defibrillate (and/or appropriate therapy) that may result in successful resuscitation. Though the primary goal of these methods is to guide the choice of treatment options, they will also be explored for mechanistic insights. The detailed block diagram of the proposed approaches 11

Symptomatic Patients Ventricular Arrhythmias Out-Of-theHospital Arrhythmia Occurrence

Preprocessing of Ventricular Arrhythmia Signal

Wavelet Analysis

Organizational Index

Arrhythmia Classification

Preprocessing of Ventricular Arrhythmia Signal

Pattern Analysis

Wavelet Pattern Detection

Predicting Shock Outcome

Correlation Analysis

Predicting Shock Outcome

Figure 1.5: Block diagram outlining the work presented in this thesis in achieving the above objectives is shown in Figure 1.5, and will be referred to in the thesis contributions given in chapter 3 and 4.

1.3

Thesis Outline

The thesis is outlined as follows: · Chapter 2: This chapter will provide information on the background of signal processing concepts used in this thesis as well as background information on existing methods. It enlightens the reader by providing literature survey that is related to the study of ventricular arrhythmias and discussing signal analysis methods.This chapter will also discuss a classification scheme that will be used in this thesis. · Chapter 3: This chapter will present the proposed method that quantifies the organization index of ventricular arrhythmias to aid in optimizing the short and long term solutions for symptomatic patients found in the overlap zone between VT and VF. The wavelet methodology is discussed in detail followed by feature extraction and pattern classification. The 12

results are reviewed at the end of the chapter with the discussion on comparison with related works. · Chapter 4: This chapter will present methodologies to identify focal signal patterns to aid EMS in providing optimal therapy for the out-of-the-hospital arrhythmia incidents. Details on the physiological connection to a few of frequently occurring ventricular arrhythmia signal patterns are discussed followed by pattern detection using wavelets. A computationally efficient correlation analysis is also provided on the dominant pattern identified for the application. The results are reviewed at the end of the chapter with the discussion on comparison with related works. · Chapter 5: This chapter will summarize the thesis with conclusions and directions for future work. Potential applications of the proposed work is also identified.

13

Chapter 2 Background

T

HIS chapter introduces and discusses the necessary signal analysis concepts that will be used in this thesis to better understand ventricular arrhythmias. The previous works on ventricu-

lar arrhythmias using signal analysis have also been explored. These tools exist in a variety of the signal processing domains, such as time domain, frequency domain and time-frequency domain. Hence, this chapter will address the signal processing tools according to these three categories and discuss the significance of using time-frequency/time-scale analysis for ventricular arrhythmias. This chapter will also briefly present a classification scheme commonly used to analyze the discrimination between groups.

2.1

Time Domain Analysis of Ventricular Arrhythmias

There are many time domain methods that have been used and implemented in order to analyze certain ventricular arrhythmias characteristics. Although these methods have not been implemented in this thesis and hence not explained in detail, they offer background knowledge as well as comparable methods to the ones set out in this thesis. The time domain analysis of ventricular arrhythmias were some of the first methods that were implemented to better analyze the arrhythmia. Some of the early time domain analysis of VF includes sequential hypothesis testing and complexity measure [8,9]. These methods were used to detect either SR, VT or VF. In 2005, Amann et al. had published a review paper which summarized many of the common analysis techniques used to help distinguish VT from VF for automated external defibrillators. Some of these analysis tech14

niques include threshold crossing interval, autocorrelation algorithm, standard exponential algorithm, modified exponential algorithm, signal comparison algorithm and Tompkins algorithm [10]. All these methods analyze particular time domain characteristics of the ECG to determine the classification accuracy (through sensitivity and specificity) between VT and VF. Phase space plot was used by Rocha et al. to create a two dimensional phase space coordinates using the current signal and time delayed signal to classify SR, VT and VF [11]. Roberts et al. had also used the phase space to classify MVT, PVT and VF [12]. Arafat et al. had proposed a variation of the existing threshold crossing interval to characterize SR, VT and VF using a binary classifier to first differentiate SR and non-SR and then differentiate VF from non-VF [13]. Some other common methods which analyzed VF in the time domain include dynamic sample entropy [14], empirical mode decomposition [15] and ECG amplitude measure [16]. Two other important features that is currently used are the heart rate (or also heart rate variability) analysis and the phase extracted from Hilbert transform of an ECG. The heart rate, typically obtained using the RR interval (the interval between successive R waves as seen in Figure 1.1) in an ECG, and heart rate variability is commonly used in cardiology and arrhythmia classification [17­20]. The heart rate plays a key role in the medical community as it can be easily used to determine various defects in the heart. Although the RR interval is the most prominent analysis, the QT interval has also been used to medically diagnose the condition of a patient [21]. Therefore this has warranted numerous signal processing analysis techniques to accurately capture the RR interval. The Hilbert transform has also been used such that the phase of the signal may be analyzed. Amann et al. had proposed an algorithm to classify VT and VF by taking the Hilbert transform of the ECG and then differentiating the arrhythmias using the phase space plots [22]. Some of the biggest contributions that were made in the field of cardiology was the phase analysis of the electrical activity recorded on the surface of the heart. Using the Hilbert transform, phase maps created from the surface of the heart had illustrated the degree of spatial organization in a human heart during an arrhythmic episode [23­30]. Although phase maps are computationally expensive (because of the multichannel electrograms on the surface of the heart), these had given indication

15

to organization centers, known as rotors, which gave rise to the notion that there is some form of organization during VF. The methods mentioned in this section are only some of the many time domain techniques that could be used to analyze VF and ventricular arrhythmias in general. Although these methods provide an analysis tool for distinguishing VT and VF, they would suffer when attempting to capture particular structural changes in VF over time.

2.2

Frequency Domain Analysis of Ventricular Arrhythmias

Frequency domain analysis have also been widely used in analyzing ventricular arrhythmias. Frequency domain has its advantages over the time domain as in some cases useful information about the signal is more obvious in the frequency domain than directly from the time domain [31]. A signal is transformed into the frequency domain by decomposing a signal into a combination of sine and cosine functions with different frequencies. The Fourier transform is used to perform this transformation given by Equation 2.1 [1].
N -1 n=0
-i2kn N

F (k ) =

f ( n) e

(2.1)

Equation 2.1 represents the discrete Fourier transform F (k ) for the discrete signal f (n) with N sample points, where k represents the discrete frequency. The energy captured at frequency k is |F (k )| 2 . The Fourier Transform has been widely used in the study of ventricular arrhythmias. Stewart et al. [32] and Strohmenger et al. [33] had used parameters, such as the median, dominant and edge frequency as well as amplitude of the dominant frequency, in order to predict the success of the resuscitation of a person in cardiac arrest. Median and dominant frequency, spectral flatness measure and band limited energy was used by Eftestol et al. to also predict successful resuscitation [34]. The VF filter leakage method was developed and used to identify if the ECG episode was VF or non-VF [8, 9]. The review article published by Amann et al. had also incorporated the VF filter leakage and spectral band method in their analysis of VF detection algorithms [10]. Perez et al. had studied the dominant frequency and dominant frequency harmonics to evaluate the organizational 16

level of VF [35]. Ropella et al. had used a spectral coherence analysis to classify MVT, PVT and VF [36]. Fourier Transform was not only limited to surface lead analysis, but also expanded on the multichannel intracardiac electrograms recorded from the surface of the heart. Dominant frequency (DF) maps were created and analyzed from the electrical activations. The DF maps were used by our research group to calculate the DF ratio and indicate the regional differences in the heart during VF [37]. Ciaccio et al. had also used DF maps to find a region on the surface of the heart which can be used to classify VF from MVT and PVT [38]. Using the Fourier transform as given in Equation 2.1 significantly limits its application to non-stationary signals. Since the Fourier transform is calculated over the entire time duration (N samples points) of the signal f (n), the occurrence (time localization) of a particular frequency cannot be determined. In other words, the underlying assumption is that a signal is stationary for its duration. Arrhythmias in general are non-stationary in nature due to the dynamical changes of their activation patterns, and therefore requiring a time-frequency analysis approach.

2.3

Time-Frequency Domain Analysis of Ventricular Arrhythmias

In time-frequency/time-scale analysis, unlike the time and frequency only approaches, joint time and frequency properties of the signal is analyzed, which is the most suitable way to analyze signals with time varying spectral content. In general, there are two approaches to consider when using the time-frequency analysis of a signal. The first approach is an adaptive time-frequency decomposition based approach, where the signal is approximated from a variety of time-frequency basis functions that are translated, modulated and scaled. Each basis function has a definite time and frequency localization. The purpose of this approach is to enhance characteristics of a signal in fewer dimensions, which is ideal for classification applications [39­41]. The second approach is the time-frequency energy distribution approach, which is typically used for visualization with high time-frequency resolution. Complex feature extraction and pattern recognition tools will be required in order to extract features directly from the time-frequency 17

distribution [39,42]. Since the proposed work focuses on feature extraction and classification tasks and the nature of the work demands computationally efficient time-frequency/time-scale methods, the following section will only discuss the relevant time-frequency/time-scale techniques for this thesis.

2.3.1 Short Time Fourier Transform
As mentioned in the previous section, the fundamental assumption when performing the Fourier transform is that the signal is stationary for the length of the signal. The STFT was developed in order to analyze frequency varying signals over time. STFT essentially computes the Fourier transform on a small portion (or a window) of the signal by shifting the window. This is then repeated for the remainder of the signal. The similarities between the STFT and Fourier transform can be seen in Equation 2.2 [1].
N -1 n=0

Sf (l, m) =

f ( n) g ( n - m ) e

-i2ln N

(2.2)

For the discrete STFT Equation 2.2, the window g (n - m) (with discrete time shifts m) is applied to the discrete signal f (n) to determine the energy (|Sf (l, m)|2 ) at frequency l and time instance m. The spectrogram measures the energy of signal f in a time-frequency neighbourhood of (l, m) and is represented by |Sf (l, m)|2 [1]. Another powerful aspect of the windowed Fourier transform is that the user can determine what specific type of windowing to use (e.g. Hanning, Butterworth, etc.). The STFT has been used in order to predict the heart rate and heart rate variability using different window functions [43]. Choi et al. had used the STFT to map out the spatiotemporal organization by analyzing the regions of frequency distribution [44]. Evan et al. had used the STFT on the activation potential of the heart to find regions of conduction blocks [45]. Although STFT has been used to analyze ventricular arrhythmias, there are issues that limit its potential. The first issue is similar to that of the regular Fourier analysis, which is the assumption that the ECG is stationary (or quasi stationary) within the window g . Since VF is non-stationary, it is crucial to localize the occurrence in time of a particular frequency. This can only be done by 18

Figure 2.1: Heisenberg uncertainty in Fourier transform [1] shrinking the window g such that we obtain a more localized time for the frequencies occurring in the window. The fundamental issue with this is the further you decrease the window's length, the worse the frequency resolution becomes (or the harder it becomes to determine the energy of the frequency accurately). In the regular Fourier transform, theoretically we had an infinite time window, which would give an accurate frequency resolution, but poor time localization. A smaller window gives better time localization at the expense of frequency resolution. This issue is known as the Heisenberg uncertainty principle as shown in Figure 2.1 [1]. A VF signal and the corresponding spectrogram with short and long time window is shown in Figure 2.2. We would be able to modify the STFT such that there is a varying window length that is dependent on the frequency. This would allow us to optimize the frequency and time localization. The issue of not being able to determine the location of the frequency component within the given window however still remains. The cause of this problem lies with the basis function used to analyze the signal for its frequency spectrum. The term e
-i2ln N

has an unlimited time support (or

a time support that spans the full length of the window). Therefore for a particular frequency, the time spanned by the window length g (n - m) will be analyzed by the sine and cosine to determine 19

Sample VF Signal
0.8

0.6

Amplitude (arbitrary units)

0.4

0.2

0

-0.2

-0.4

-0.6 100 200 300 400 500 600 700 800 900 1000

Time Samples

(a) Sample VF Signal
Spectrogram (Long Window)
0.05
0.05

Spectrogram (Short Window)

0.045 1.2 0.04 1

0.045

1.2

0.04 1

Normalized Frequency

0.03 0.8 0.025 0.6

Normalized Frequency

0.035

0.035

0.03

0.8

0.025 0.6 0.02

0.02

0.015 0.4 0.01

0.015

0.4

0.01 0.2

0.005

0.2

0.005

0

100

200

300

400

500

600

700

800

900

1000

0

100

200

300

400

500

600

700

800

900

1000

Time Samples

Time [s]

(b) Spectrogram (Long Window)

(c) Spectrogram (Short Window)

Figure 2.2: Sample VF signal and corresponding spectrograms with short and long time windows

Sample VF Signal
0.8

0.6

Amplitude (arbitrary units)

0.4

0.2

0

-0.2

-0.4

-0.6 100 200 300 400 500 600 700 800 900 1000

Time Samples

(a) Sample VF Signal

(b) Scalogram

Figure 2.3: Sample VF signal with corresponding scalogram (y-axis is in normalized frequency)

20

the energy of that frequency, as seen in Figure 2.1. From this figure, we can see that the window selected provides the same resolution for all frequencies, which is not ideal. This particularly creates an issue with non-stationary signals such as VF, which has varying frequency components present at different times. With these issues, it is logical to look towards joint time-frequency/timescale techniques.

2.3.2 Wavelet Transform
In wavelet analysis, a signal f (n) is modeled using all possible variations of a mother wavelet  . Mother wavelets (small waves) are mathematical functions that satisfy certain properties and have specific time-frequency localization. Due to the flexibility in generating many variations (scale and translation of the mother wavelet), wavelet decomposition is highly adaptive to the signal structures. In addition, the flexibility in the choice of the mother wavelet determines the characteristics of the decomposition and helps in performing signal adaptive and application specific analysis. The discrete implementation of wavelet transform is given by Equation 2.3 [46], 1 W f (s, m) =  s
N n=1

f ( n)   (

n-m ) s

(2.3)

where m and s represent the discretized time and scale parameter and W f (s, m) represents the wavelet coefficients for the discrete time signal f (n). The wavelet coefficients W f (s, m) are obtained as a result of scaling (parameter s) and translating (parameter m) the mother wavelet  . The scaling factor s represents the parameter that varies the frequency of the wavelet by shrinking or expanding the time window, thus causing the mother wavelet to vary its frequency characteristics. The translation parameter m centers the wavelet window to encompass a part of the signal. The coefficients are therefore representative of the correlation of the wavelet (with a particular s and m parameter) to the signal f (n) localized around the time parameter m and frequency characteristics that are inversely related to s. The scalogram defines the time-scale energy localization and is given as |W f (s, m)|2 . The sample VF, that was used to demonstrate the spectrogram, was used with its corresponding scalogram (shown in Figure 2.3). The y-axis has been shown in normalized frequency for the scalogram example for easy comparison with the spectrogram in Figure 2.2. 21

The discretization or the sample steps used for the parameters m and s distinguish between discrete continuous wavelet transform (CWT) and the commonly and widely used discrete wavelet transform (DWT). Theoretically, the parameters m and s should be continuous to qualify as true CWT. However, the software implementation of the CWT limits these choices based on the discretization constraints. The DWT is dyadic in nature, although it can completely represent a signal, it may not be suitable for feature extraction applications due to issues with invariance properties. In particular, the DWT is shift variant, which causes a time shift in the signal to provide different wavelet coefficients [31]. The CWT is preferred in this case because although it provides redundant information, it satisfies the shift invariance properties and can be utilized for feature extraction applications. The CWT has advantages over the STFT in its accuracy in localizing the time-scale energy of the signal. The purpose of this is of direct consequence of the basis wavelets selected to analyze the signal. The basis functions (also known as mother wavelets) used in the wavelet transform have a finite time support, which allows for the time localization of the energy in a particular scale (inversely proportional to frequency). Due to the wavelets having a limited time support, the window length can vary based on the scale being analyzed by the wavelet, thus giving it an adaptive window. This can be visually seen in Figure 2.4. However, in order for the wavelets to accomplish the time localization, there are several properties, as outlined in "A Wavelet Tour of Signal Processing" [1], that must first be satisfied. Research into the wavelet transform has shown that the same order of computational complexity as the fast Fourier transform can be achieved for the over complete wavelet transform [47]. The computational complexity for the fast Fourier transform is given as N log2 (N ) [1]. Therefore the wavelet transform is efficient in terms of complexity with the ability to provide better time-scale (or time-frequency) localization. The other advantage of the wavelet transform over the STFT is the variations of basis functions that are available to analyze the non-stationary signal. Unlike the Fourier transform that analyzes the signal with a combinations of sines and cosines, the wavelet transform has the ability to analyze the signal with any number of mother wavelets  in order to determine the frequency components found in the signal.

22

Figure 2.4: Heisenberg uncertainty in wavelet transform [1] For this thesis, the CWT will be used over other adaptive time-frequency decomposition approaches for a couple of reasons. In the application of optimizing treatment options, it is necessary that the computational complexity be limited in order to provide a quick analysis of the arrhythmia. The localization of time-frequency components is also necessary for the analysis of non-stationary signals such as VF. The wavelet analysis is best suited in both these regards because it has an adaptive window which is continuously scaled, depending on the wavelet basis, and it could also be implemented in near real time. The criterion for selecting an appropriate wavelet is one that is highly dependent on the application it is being used for. The first decision to be made is based on the type of wavelet to be used (real wavelet or an analytic wavelet). These are used for two different types of applications. Real wavelets are used under the condition that the user is trying to capture sharp signal transitions or fractals. This is especially useful in analyzing borders in images. Analytic wavelets on the other hand are used to study the temporal evolution of frequency tones present in the signal and has advantages of retaining the phase information of the signal [1]. In optimally selecting the best wavelet, there are approaches that could be followed. The first 23

approach is to optimally select a wavelet that compactly represents signal with the fewest number of scales. The second approach uses discriminatory kernels to identify the optimal wavelet for the purpose of classification. The following methods are only a few methods used to discuss the optimal wavelet selection through compact representation. Shannon Entropy provides a measure of the information in any distribution [48] where the lowest entropy would describe a signal with a wavelet representation that is compact in the scale range and therefore gives a measure on how well a wavelet represents the signal. A different method provided by Cui et al. shows that the phase spectrum can be used to obtain the best wavelet to represent the signal [49] where a wavelet can be optimally selected to complement the signal under analysis by creating a phase spectrum that almost represents a constant. The discriminatory kernels aim to optimize the wavelet selection for the purposes of classification. Jones et al. had proposed a classification based cost function that optimizes common features of the wavelet analysis to determine the appropriate wavelet [50]. Daamouche et al. proposed the optimization of the wavelet selection in practical implementation of filter banks by optimizing the filter coefficients and selecting the wavelet that provides the best support vector machine classification. A technique that selected the highest correlation for a specified scale of the mother wavelet was used to optimally select the wavelet with the highest correlation for the given application [51]. In this thesis, the wavelets were selected based on the relative similarity of them to the signal structure present in ventricular arrhythmia, since the priority is to discriminate between groups and detection of patterns. From the literature it was observed that the Morlet wavelet [29, 52­55] and the Gaussian wavelet [55, 56] were widely used for ECG analysis. In addition, an analytical wavelet is also required as it provides information on frequency evolution and the phase information can be used for pattern detection applications. The complex Morlet and the complex Gaussian wavelets are provided in Figures 2.5 and 2.6 respectively, and will be used in this thesis because they closely represent the ventricular arrhythmia structure. The complex Morlet wavelet and the complex Gaussian wavelet are mathematically represented by Equations 2.4 [57] and 2.5 [1] respectively, where c0 is the center frequency.

24

Complex Morlet wavelet cmor1-1 0.6 0.4 0.2 0 -0.2 -0.4 -0.6 -0.8 -8 -6 -4 -2 0 Real part 2 4 6 8

0.6 0.4 0.2 0 -0.2 -0.4 -0.6 -0.8 -8 -6 -4 -2 0 Imaginary part 2 4 6 8

Figure 2.5: Complex Morlet wavelet

M orl (n) = 

1 -4

(e

-jc0 n

-e

-

c2 0 2

)e-

n2 2

(2.4)

Gaus (n) = [

- n2 1 2, 2 ]e-jc0 n e ( 2  )( 1/4)

(2.5)

The Morlet wavelet is representative of the organizational signal structure found in arrhythmias and hence the Morlet wavelet will be used in quantifying the organization in the arrhythmia. This will be further expanded upon in chapter 3. The Gaussian wavelet closely represents a QRS depolarization, found in Figure 1.1. This wavelet is also similar to the depolarization of the ventricles. This wavelet is better suited to analyzing the patterns that will be discussed in chapter 4. Similar to the Fourier analysis of VF, the wavelet analysis of VF has been widely used in literature due to its ability to decompose non-stationary signals in the time-frequency domain. In the review paper by Amann et al. [10], a method consisting of obtaining the Fourier transform of the wavelet coefficients in order to capture the maximum absolute value to determine if a defibrillation should be given in the case of VF. In this same review paper, the Li method had used the DWT to decompose the VF, and a particular scale band was used to distinguish VF from non-VF. Watson et al. had revealed that it is possible to detect cardio pulmonary resuscitation (CPR) occurrence 25

Complex Gaussian wavelet of order 2 0.5

0

-0.5

-1 -5

-4

-3

-2

-1

0 Real part

1

2

3

4

5

0.6 0.4 0.2 0 -0.2 -0.4 -0.6 -0.8 -5 -4 -3 -2 -1 0 Imaginary part 1 2 3 4 5

Figure 2.6: Complex Gaussian 2 wavelet and atrial activity in the ECG during VF by using the wavelet transform [58, 59]. Kahdra et al. had used the wavelet transform to capture bands of energy such that SR, atrial fibrillation, VT and VT could be classified [29]. The wavelet transform was also used to obtain a feature (scale distribution width) in order to better predict the success of defibrillation [54, 56]. The wavelet transform has also been applied in the spatial analysis of VF ECG. Sierra et al. had used the wavelet analysis of each electrode on the surface of the heart to calculate the cycle length variability. This information was used to discriminate between MVT and PVT. The methods discussed here are only few of the relevant wavelet transform methods used in order to characterize ventricular arrhythmias.

2.4

Classification Scheme

A pattern classification system is typically used to discriminate between groups using a common set of features. The objective of a pattern classifier is to provide the best discrimination between multiple groups. As discussed during the literature analysis of the different methods in the study of ventricular arrhythmias, they usually consisted of identifying a feature or feature space such that a distinction can be made between two or multiple groups (VT, VF, sinus rhythm, etc.). Pattern 26

classification is especially important in the field of ventricular arrhythmia because of the unique treatment options. Therefore, the goal is to improve upon the classification of the arrhythmias in order to choose the correct treatment option. Classification accuracies are also important when comparing a variety of different features that aim to perform the same task. There are several methods used in order to calculate the classification boundary and accuracy of a given method. This section will explore one of the well established methods, which is the Fisher's linear discriminant analysis. The information outlined in this section is a summary extract from "`Pattern Classification"' [60]. The readers are referred to this book for more detailed information.

2.4.1 Fisher's Linear Discriminant Analysis
The Fisher's linear discriminant analysis (LDA) is a supervised machine learning approach. This means that the classifier is built using a set of training samples that are pre-classified by experts. A supervised classifier is important in the medical community because the clinicians provide the gold standard in categorizing the samples. Therefore, when training the classifier, features must be selected to highlight the information that is validated by the clinicians, which would require a supervised learning in order to build the classifier. The linear discriminant function will only create linear boundaries, and will therefore perform poorly if the features do not exhibit strong discrimination. Therefore, if a good classification is obtained using an LDA method, then it indicates that either the classification task is simple or the extracted features demonstrate strong discrimination. In a linear classification system with multiple groups c, the number of linear discriminant functions required would be c - 1 functions. Each function would classify a class from the remainder of classes. Therefore a combination of the discriminant functions would eventually lead to regions, where one class would occupy a region. However, not all regions will be assigned to a class. The Fisher's discriminant function can be seen as projecting the d dimensional samples x onto a corresponding set of samples y using the weight vector matrix w. The matrix W can be seen as a generalized matrix equation that incorporates all the class's weight vector wi with a dimension of d × c - 1. The projection of x onto y is given in Equation 2.6 [60].

27

y = Wt x

(2.6)

In order to obtain the weight vectors W, a criterion function J(W) was used to determine the optimal weight vectors. This criterion function is given in Equation 2.7. The terms SB and SW indicate the between class and within class scatter matrix respectively. The equation for SB is given in Equation 2.8 and the equation for SW is given in Equation 2.9. The scatter matrices provide information on the distribution of the classes themselves and the distribution of samples within each class respectively. For Equation 2.8, the term ni is the number of samples in class i, mi is the mean for each class and m is the total group mean from the mean mi of each class. The within class scatter matrix SW is the summation of the variance from each class. The optimal weight vectors is calculated by maximizing J(W). By maximizing the criterion function, the class separation increases and/or the variance of each group is decreased. The weight vectors are calculated to provide the best projection of x onto y and therefore form the basis of the linear boundaries. |Wt SB W| |Wt SW W|

J( W ) =
c

(2.7)

SB =
i=1 c

ni (mi - m)(mi - m)t
c

(2.8)

SB =
i=1

Si =

(
i=1 xDi

(x - mi )(x - mi )t )

(2.9)

In obtaining the weight vectors W , the classifier is trained with a pre-classified set of training samples. These training samples create the optimal boundary for the given training set. The downfall is that since this boundary was optimized for this training set, it does not guarantee that it will provide a good classification for the testing set. In order to remove the dependency on the training and testing sets, cross validation is required.

28

2.4.2 Cross Validation
Cross validation is done by dividing the total number of samples n into m equally sized sets of data. The training is done on all but one of the sets and the remaining set is tested on the classifier. this process is repeated m times until all m sets have been used as a training set. Cross validation is heuristic in terms of selecting the number of sets and the number of samples per set. The validation error provided by the cross validation does provide an estimate of the accuracy using an unknown number of sets [60]. A subset of the cross validation method is the Leave-One-Out (LOO) method. If there were n sample points available, the LOO method will train the classifier with n - 1 samples and then test the classifier with the remaining sample. The LOO method will execute n times to test each sample. The classification accuracy is then provided based on the testing results of each sample. In re-sampling theory, the sample average of the data set, where the ith point is removed, can be calculated as the following [60]. 1 = n-1
n

 (i )

xj
j =i

(2.10)

Equation 2.10 is known as the leave-one-out mean. The Jackknife estimate of the means is the mean of the leave-one-out mean. This is given in Equation 2.11. 1 = n
n

(.)

 (i )
i=1

(2.11)

The Jackknife estimate of the variance can be obtained as follows. n-1 V ar = n
n

(i) - (.)
i=1

(2.12)

The benefit of the Jackknife variance (given in Equation 2.12) is that this can now be generalized for any other estimator. For example, instead of using the mean estimator, a different estimator can be applied where the leave-one-out iteration is calculated for the estimator.

29

2.4.3 Classification Accuracies
Classification accuracy is used to quantify the performance of a classifier built using a set of features. This is given in Equation 2.13 [61]. TP + TN TP + FP + TN + FN

Acc =

(2.13)

The four terms usually used are T P (True Positive), F P (False Positive), T N (True Negative) and F N (False Negative). For example, in a binary classification with sick and normal subjects, the term T P is the identification of a sick person as a sick person. In contrast, the term T N was identification that a normal person as a normal person. The F N determines the number of actual sick subjects that were classified as normal subjects and F P determines the number of normal subjects that are classified as sick subjects. Using the four categories, the sensitivity and specificity of technique are given in Equations 2.14 and 2.15 [61]. TP TP + FN TN TN + FP

Sensitivity =

(2.14)

Specif icity =

(2.15)

The sensitivity and specificity of each group will have to be calculated in order to obtain the overall classification accuracy. This type of analysis is useful when it is more important to detect one class over the others.

2.4.4 Receiver Operating Characteristics
The Receiver Operating Characteristics (ROC) analyzes the change in sensitivity and 1-specificity with the change in the decision boundary between the groups in a binary classifier. That is the decision boundary is varied and the sensitivity and specificity are calculated and plotted onto a two dimensional plane. The first dimension represents the 1-specificity and the second dimension represents sensitivity. These values are plotted with each change in the decision boundary. This is useful in classifiers that may have a varying loss function associated to the groups [60]. The 30

loss function could change depending on the application at hand. The area under the ROC curve provides an indication of the robustness of the feature in discriminating the classes of groups. The larger the area under the curve, the more robust it is at discriminating the class. This is because varying the boundary between the groups should keep the sensitivity high and 1-specificity low, giving a larger area under the ROC curve. The ROC analysis is also generally used to compare the strength of multiple features. The comparison is done by usually analyzing the area underneath the ROC curve to determine which feature is robust for a binary classification problem.

2.5

Background Summary

This chapter had presented background information on relevant signal processing tools such as the Fourier Transform, Short Time Fourier Transform and Continuous Wavelet Transform. The justification as to the use of time-frequency/time-scale methods (especially the CWT) was provided in this chapter. Highlights on existing methods in the time, frequency and time-frequency domain that were developed to aid in the analysis of ventricular arrhythmias was discussed. Finally, general classification approach (Fisher`s LDA), cross validation technique (LOO) and ROC curves were discussed as these will be used in presenting the results in subsequent chapters.

31

Chapter 3 Ventricular Arrhythmia Analysis for Symptomatic Patients

T

HE short and long term treatments for VT and VF are different. Patients can be identified (sometimes at an early stage) based on other symptoms that indicate that they are prone

to an arrhythmia episode. The automated detection of these arrhythmias is crucial because of the differences in the therapy options available. The literature review has shown that a lot of work has been performed in the field of classifying VT from VF. The issue, and therefore the difficulty, lies in the detection of the transition of the arrhythmia due to the degradation of the heart leading from VT to VF. The ability to detect the overlap zone between VT and VF will provide a useful clinical tool that can quantify the degree of organization and accordingly assist clinicians in optimizing short and long term therapy options for patients diagnosed to be in this overlap zone. The proposed methodology will look to identify signal structures that are representative of either VT, VF or the overlap zone between VT to VF. This chapter will highlight the analysis on organizational structure of arrhythmias for symptomatic patients. The proposed work presented in this chapter is highlighted in Figure 3.1.

3.1

Significance of Organizational Structure

Most of the literature analysis has shown that classification is possible between VT and VF [9­ 11, 17, 29, 35, 36], but what was not emphasized was that those methods had mainly focused in differentiating MVT and VF. Unlike the existing techniques, this chapter focuses on furthering this 32

Symptomatic Patients Ventricular Arrhythmias Out-Of-theHospital Arrhythmia Occurrence

Preprocessing of Ventricular Arrhythmia Signal

Wavelet Analysis

Organizational Index

Arrhythmia Classification

Preprocessing of Ventricular Arrhythmia Signal

Pattern Analysis

Wavelet Pattern Detection

Predicting Shock Outcome

Correlation Analysis

Predicting Shock Outcome

Figure 3.1: Thesis contributions presented in Chapter 3 are highlighted analysis by identifying the overlap zone between VT and VF. The purpose for this is because the clinician who is analyzing symptomatic patients suffering from an arrhythmia in the overlap zone of VT and VF could choose the appropriate therapy in treating them. There are very few studies that differentiate MVT from PVT and PVT from VF using surface ECGs. The temporal organization of signal structures of an arrhythmia intuitively relates to the degree of stationarity found in the ECG signal. The VT example provided in chapter 1 (Figure 1.3a) exhibits strong organization. This arises from the regular rhythmic depolarizations of the ventricles found in the VT sample. The VF example in chapter 1 (Figure 1.3b) does not have repetitive signal structures as it is non-stationary in nature. If the temporal organization of signal structures can be quantified, it could be used to depict the transition from VT to VF and therefore identify the overlap zone between VT and VF. It is known that there is well established treatments for VT and VF, which raises the question as to what the purpose is of detecting the overlap zone between VT and VF. As mentioned above, the ventricular arrhythmia state will degrade as the response time is delayed. By the ability to detect the overlap zone between VT and VF, the treatment option most appropriate could be selected. 33

For example, if a PVT was detected (which is closer to VT), then pacing could first be provided. If however the arrhythmia is determined to be closer to VF, then defibrillation could be provided without any delays. Since the short term therapy option cannot be delayed, a developed smart algorithm must also be quick in its analysis so that the therapy can be delivered as soon as possible. This is especially the case in ICDs where an accurate analysis of the arrhythmia must be quickly provided in order to either pace the heart or provide a defibrillation. It has been shown in the literature that an unnecessary ICD shock may increase the mortality [62], which makes the detection of VT and VF and the identification of patients in the overlap zone crucial. This detection of patients in the overlap zone could be used to reduce the number of ICD discharges caused by inaccurate diagnosis of the electrogram, thus preventing further damage to the heart. Therefore the short term implications of detecting the overlap zone is significant for resuscitation and improving the patients survivability. The detection of the border zone is also important for long term treatment options. Unnecessary ICD shocks are known to increase the mortality of the patient [62]. Although ICDs have helped patients for a few decades, if amenable, long-term solutions via ablation strategies are always preferred. This makes the determination of the overlap zone crucial as patients diagnosed could have an ablation therapy attempted first before considering the placement of an ICD. The classification of previous arrhythmic episodes, during regular patient visits, might assist the clinicians in deciding on future anti-arrhythmic drugs, multiple level shock threshold programming and ablation therapies. The other factor that had influenced this study is the rotor dynamics [63], which had shown that rotors became complex in nature over time. Rotors are thought to be centers of high frequency periodic excitations sources within the heart [64]. Studies had also shown that there is a relation to the temporal complexity in the ECG organization and to the rotor mechanisms behind ventricular arrhythmias [63]. The study of the overlap zone between VT and VF will enable the clinician to relate the temporal complexity of the arrhythmia, using a single channel ECG, in terms of the rotor mechanisms, that are believed to be the cause for VF. With these reasons, the goal of this chapter was to arrive at discriminatory clues related to the organizational index of the arrhythmia that could

34

better classify the overlap zone between VT and VF.

3.2

Related Work

As highlighted in chapter 2, there have been many studies that identified the classification between VT and VF [9­11, 17, 29, 35]. There have only been a few studies conducted on identifying the overlap zone. These studies had also limited the analysis to MVT, PVT and VF. Ropella et al. had proposed a spectral coherence analysis as a basis on which to differentiate MVT, PVT and VF [36]. This is done by using the bipolar electrograms to obtain a similarity measure of the two signals. The phase reconstruction approach proposed by Roberts et al. [12] had proposed to use the phase space of the signal to identify regions in the phase space to discriminate between the above mentioned arrhythmias and sinus rhythm. The dominant frequency obtained using multichannel electrogram from the surface of the heart was used by Ciaccio et al. to discriminate MVT, PVT and VF [25]. In [65] a wavelet-SVD approach on the SR ECG prior to the occurrence of an arrhythmia was used to predict the type of cardiac arrhythmia. The SVD matrix obtained, by capturing the scalogram of a normal sinus ECG, had used the Eigendecomposition of the scales to predict the arrhythmia. The Eigendecomposition matrix was placed in a neural network in order to determine the type of arrhythmia that would occur. Although this method does not classify the ECG into MVT, PVT and VF, the wavelet-SVD is similar to the proposed approach, and will be discussed later. There are also studies conducted on spatial organization by analyzing the activation on the surface of the heart [23, 24, 28], but these studies primarily focused on identifying mechanisms within the heart.

3.3

Ventricular Arrhythmia Organization Analysis

This section highlights the contribution to the analysis of the ventricular arrhythmia in order to determine if a patient belongs in the overlap zone. The database and the arrhythmia groups are first introduced. This is followed by the analysis of the organizational signal structure in the frequency

35

domain and the wavelet domain. The methodology and features required to capture these signal structures are discussed with regards to each domain.

3.3.1 Database and Preprocessing
The database used in this study was obtained from the MIT-BIH ventricular arrhythmia database (public database available through PhysioNet [66]). This database consisted of 30 patient ECG recordings (sampled at 250 Hz) of real patients and each patient had a varying type of ventricular arrhythmia episode with different time durations. These arrhythmia episodes recorded from these patients had occurred in an hospital setting. The signals were filtered between 0.5 and 30 HZ using an FIR filter to remove movement artifacts and high frequency noise [33]. Although the dominant ventricular arrhythmia components exist in the frequency range of 2 to 12 Hz, literature survey has also shown that there are components that reside in the 1-2 Hz as well the 12 to 20 Hz range [33, 34,67], which justifies the 0.5-30 Hz filtering. These pre-processed signals were analyzed and with the help of electrophysiologists from Toronto General Hospital, and only relevant segments for this thesis were extracted. A novel categorization of the ventricular arrhythmias was introduced as VT (consisted mostly of MVT and PVT), organized VF (OVF) and disorganized VF (DVF) in order to account for the overlap zone between VT and VF. OVF consists of organized/early VF and DVF is the disorganized ECG arrhythmia. This classification was necessary to capture the transition from MVT to DVF such that short or long term treatments can be optimized. In particular, patients exhibiting OVF could benefit from ablation possibilities. In total, 63 four second signals were selected (approximately two non-overlapping segments selected randomly from each of the 30 patients) and labeled into three categories as VT, OVF and DVF by the electrophysiologists, which served as the ground truth. Of the 63 signals, 21 were categorized into VT, 20 into OVF, and 22 as DVF.

3.3.2 Frequency Domain
The most obvious feature that stands out is the temporal organization between the groups, where VT is highly organized and VF is not. The Fourier transform is well established in capturing the

36

Amplitude (arbitrary units)

Amplitude (arbitrary units)

0.15 0.1 0.05 0 -0.05 -0.1

0.1

Amplitude (arbitrary units)

Sample VT Signal

Sample OVF Signal

Sample DVF Signal
0.1 0.05 0 -0.05 -0.1 -0.15

0.05

0

-0.05

0

0.5

1

1.5

2

2.5

3

3.5

4

-0.1

0

0.5

1

1.5

2

2.5

3

3.5

4

0

0.5

1

1.5

2

2.5

3

3.5

4

Power/Frequency (Watts/Hz)

Power/Frequency (Watts/Hz)

Power Spectral Density of VT Signal
0.4

Power Spectral Density of OVF Signal
0.25 0.2 0.15 0.1 0.05 0

Power/Frequency (Watts/Hz)

Time (s)

Time (s)

Time (s) Power Spectral Density of DVF Signal
0.25 0.2 0.15 0.1 0.05 0

0.3

0.2

0.1

0

0

5

10

15

20

25

0

5

10

15

20

25

0

5

10

15

20

25

Frequency (Hz)

Frequency (Hz)

Frequency (Hz)

(a) VT

(b) OVF

(c) DVF

Figure 3.2: Example of patients with VT (part a) and DVF (part b) ECG and the corresponding Welch periodogram frequency content of a stationary signal. Even though in chapter 2 we had identified the need for time-frequency analysis, the existing literature has evidence that Fourier features perform well in discriminating VT and VF [35]. This is also evident from the current ICD technologies which are rate dependent in differentiating VT and VF. The spectral features could differentiate VT and VF, however they may not be accurate in capturing the overlap zone. In order to validate this and justify the need for time-scale analysis, we extracted similar frequency domain features that were used in existing literature [34, 35], to classify the three types of arrhythmias. This can be identified in the spectrum of the VT, OVF and DVF examples provided in Figure 3.2. Therefore frequency features were used to attempt to capture the overlap zone between VT and VF. Method Similar to many of the published methods, the Fourier transform was used in order to capture the frequency parameters of the ECG. The power spectral density was obtained using a Welch periodogram method for all the 63 signals of the database. The Welch periodogram P (l) is given in Equation 3.1 [68]. The Sf can be found from Equation 2.2 of chapter 2. The term w represents the length of the window, U is the normalization factor to account for the power in the window w,

37

M represents the number of samples of window w and l is the frequency. 1 Pi (l) = M ×U
N -1

|fi (n)w(n)e-j 2ln |2

(3.1)

n=0

where i varies from 0, 1, ...L - 1 and L is the total number of data segments. To obtain the power spectral estimate the average of Pi (l) over all L data segments was obtained as given in Equation 3.2 [68]. 1 P (l ) = L Feature Extraction The PSD analysis of a sample VT,OVF and DVF ECGs using the Welch periodogram is shown in Figure 3.2. The normalized spectrum was used to calculate several features. There were several features that were initially attempted due to their use in literature. These features were the dominant frequency, percentage of power captured by the dominant frequency, harmonic power percentage and bandwidth. The features that were retained to analyze the ECGs were the percentage of power captured by the dominant frequency and the bandwidth because these features provided the best classification of OVF and DVF. The percentage of power captured by the dominant frequency was obtained using Equation 3.3. The term lDF is the dominant frequency and P wr(lDF ) is the percentage of power for the dominant frequency. The bandwidth was obtained using Equation 3.4. The terms lL and lH represent the lower and higher frequencies at which the power is half of the dominant frequency power (3 dB drop), which is the value commonly used. P (lDF ) k P (l )
L-1

Pi (l)
i=0

(3.2)

P wr(lDF ) =

(3.3)

BW = lH - lL

(3.4)

38

Results The classification was performed in two levels to classify VT, OVF and DVF. The first level classified VT from non-VT (OVF and DVF), then the second level classified non-VT into OVF and DVF. The purpose of this was to be able to comparatively study the classification accuracy between VT and non-VT. The main contribution of this chapter, the analysis of VF into OVF and DVF, could then be assessed independently. The results for Level 1 (VT and non-VT) obtained using the dominant frequency energy percentage and bandwidth can be found from Table 3.1. An LDA classifier was used in conjunction with the LOO method. The classification between VT and non-VT had achieved an accuracy of 88.90%. Table 3.1: Level 1 Fourier Domain Classification: VT and non-VT Method Cross-validated % Groups VT VT 18 Non-VT 4 VT 85.7 Non-VT 9.5 Non-VT 3 38 14.3 90.5 Total 21 42 100 100

The same features were used for the Level 2 classification of OVF and DVF arrhythmias and a classification accuracy of 63.15%. The results are presented in Table 3.2. Table 3.2: Level 2 Fourier Domain Classification: OVF and DVF Method Cross-validated % Groups OVF DVF OVF DVF OVF DVF Total 8 8 16 6 16 22 50 50 100 27.3 72.7 100

A direct three group classification was also preformed to classify VT, OVF and DVF and the overall classification accuracy was found to be 68.3% , where OVF had a classification accuracy of 45%. The feature space of the percentage of power captured by the dominant frequency and bandwidth is provided in Figure 3.3 for all the three features. The scatter plot in Figure 3.3 shows 39

Frequency Domain Features Scatter Plot
18
Percentage of Power by Dominant Frequency (%)

16

VT DVF OVF

14

12

10

8

6

4

2

0

0.5

1

1.5

2

2.5

3

3.5

4

4.5

5

Bandwidth (Hz)

Figure 3.3: Arrhythmia scatter plot with frequency domain features the VT samples occupy the top left corner and the DVF on the bottom right corner. This means that the Dominant frequency power is higher for VT and lower for DVF where as the bandwidth is higher for DVF and lower for VT. OVF can be seen to be a transistion from VT to DVF with samples closer to both sets of group. It should be noted that the accuracy between VT and non-VT obtained from Table 3.1 was 88.90%, which is obvious and expected as shown in literature [35,36] that spectral features perform well in distinguishing VT from VF. The mis-classified samples from the non-VT group (from table 3.1) were all from the OVF subgroup. This can be noticed in Table 3.2, where the number of OVF samples had decreased from 20 (the original number of samples) to 16. This is an indication that there is a natural transistion from VT to DVF by the way of MVT  PVT  OVF  DVF. The classification between OVF and DVF was not favorable as expected. The overlap between OVF and DVF can also be appreciated in the scatter plot shown in Figure 3.3. This indicates that only spectral features may not be able to classify the overlap zone between VT and DVF (OVF).

40

Amplitude (Arbitrary Units)

Amplitude (Arbitrary Units)

0.06 0.04 0.02 0 -0.02 -0.04 -0.06 -0.08 0 0.5 1 1.5 2 2.5 3 3.5 4

0.1

Amplitude (Arbitrary Units)

A: Sample VT ECG

A: Sample OVF ECG

A: Sample DVF ECG
0.1

0.05

0.05

0

0

-0.05

-0.05

-0.1

0

0.5

1

1.5

2

2.5

3

3.5

4

-0.1

0

0.5

1

1.5

2

2.5

3

3.5

4

Time (s) B: Wavelet Coefficients
20
Scales (Scale) Scales (Scale)

Time (s) B: Wavelet Coefficients
20 40 60 80 100 120
Scales (Scale)

Time (s) B: Wavelet Coefficients
20 40 60 80 100 120

40 60 80 100 120 0.5 1 1.5 2 2.5 3 3.5 4

0.5

1

1.5

2

2.5

3

3.5

4

0.5

1

1.5

2

2.5

3

3.5

4

Time (s)

Time (s)

Time (s)

(a) VT

(b) OVF

(c) DVF

Figure 3.4: Example of patients with VT (part a), OVF (part b) and DVF (part c) ECG with corresponding scalograms

3.3.3 Wavelet Transform and Image Processing
The goal of using the wavelet transform is to better capture the organization in terms of time-scale structures present in the arrhythmia. As discussed in section 2.3.2, the complex Morlet and complex Gaussian wavelet have been widely used in the analysis of ventricular arrhythmias and are suitable for this thesis and hence this point forwards, these wavelets will be used for further analysis. For this chapter, the complex Morlet wavelet is used to capture the organizational structure of the arrhythmia. As a preliminary analysis, the scalograms for the three groups of arrhythmia were studied, and an example of each of these groups is provided in Figure 3.4. The scalograms were normalized to be represented in percentage of total energy, and is given by Equation 3.5. Each node in the W f (s, m) matrix was represented as a percentage of the total energy captured by the wavelet transform.
2 ~f (s, m) = 100 × (|W f (s, m)| ) W 2 s m (|W f (s, m)| )

(3.5)

These three signals, shown in Figure 3.4, are real arrhythmia samples from the MIT database, which were analyzed using the wavelet transform to give a sample time-scale representation of the

41

groups. Figure 3.4a, Figure 3.4b, and Figure 3.4c show three sample surface ECGs pre-classified by the electrophysiologist as VT, OVF, and DVF ECG episode. Observing the three ECG signals in the figures, a smooth transition in the organization signal structure is evident from VT to DVF. From Figure 3.4a, it can be observed visually (from part A of Figure 3.4a) and in the scalogram (from part B of Figure 3.4a) that VT has a strong organized structure and the signal energy is confined to a narrow bandwidth but spread uniformly over time and this is indicative of a monocomponent. The VF example in Figure 3.4c does not have an observable organizational structure (from part A of Figure 3.4c) and the energy is distributed over the time-scale plane (disorganized) which is reflected in the scalogram (from part B of Figure 3.4c). This is indicative that DVF has more non-coherent signal components with varying time-scale structures. Visually inspecting the OVF ECG and its corresponding coefficients found in Figure 3.4b shows a higher degree of organization than the DVF example found in Figure 3.4c. This is indicative that OVF has a mixture of coherent and non-coherent signal components that manifest as different time-scale structures compared to DVF. However, it is not as organized as the VT example in Figure 3.4a, which is also reflected in the scalogram. Based on the above initial observation, a preliminary image processing approach was explored to validate if the time-scale structures from the scalogram could be used to discriminate between the three groups. The frequency components of OVF appears to be confined to a small range of scales similar to the VT example, which would be a limitation for Fourier analysis to distinguish VT from OVF (as seen in the mis-classification between VT and OVF in Table 3.1). The wavelet transform of the OVF differs from the VT because the scale energy is not uniformly distributed through time. A time domain method can detect this difference, but it would then fail at classifying OVF from DVF. Also as seen in Table 3.2, the OVF and DVF signals have similarities in the frequency domain. Wavelet is better suited over STFT because of its improved time-scale (time-frequency) localization. As seen from the scalogram of the OVF and DVF samples, the energy in the time-scale structures have a longer time duration and confined in the scale dimension than that of the DVF sample. The significant part of this initial observation highlighted the ability of CWT to capture the difference between DVF and OVF in two dimensional time-scale structures.

42

Method A subset of the original database was used for the validation that the different time-scale structures could be used to classify the three groups of arrhythmias. A total of 24 signals, with 8 signals in each group, was used for this study. All the 24 signals were decomposed using CWT and the coefficients were used to construct normalized scalograms. The initial step in processing the scalogram was to only retain the most significant energy coefficients. This was done by applying a threshold to the normalized coefficients to capture the top 25% of the coefficient energy. A threshold of 25% was used such that the retained significant energy coefficients captured only the spread of the time scale energy of importance to the organization. This would also help denoise the scalogram in the analysis of the organization. The threshold  was obtained in such a way the coefficients that sum to the top 25% of the scalogram energy were retained. Components of energy were now retained (using Equation 3.6) as a result of capturing only the coefficients that represented the top 25% of the scalogram energy and setting the remaining coefficients to zero. The results in a filtered version of the scalogram FW ~f (s, m) that retains the dominant time-scale components. This notation will be used to represent filtered versions of the scalograms that selectively retains time-scale structures.

FW ~f (s, m) > 

(3.6)

The retained components FW ~f (s, m) represents multiple time-scale structures of interest and these components were extracted using the Moore-Neighbour tracing algorithm proposed by [69]. Feature Extraction From the retained time-scale structures in FW ~f (s, m), the width of the component was calculated with respect to time. The width signifies the duration of the j th time-scale component found from the filtered scalogram FW ~f (s, m) and is given in Equation 3.7. The time width T Wj for timescale component j is obtained by finding the difference between the minimum time mL,j and the maximum time mH,j for the identified component using Moore-neighbour algorithm [69]. It would 43

be expected that VT signals would have a much larger time width, due to the monotonic nature of the signal, OVF would have multi-component, yet relatively larger time width when compared to a DVF signal. Once the feature was extracted, a weighted mean as given in Equation 3.8 is computed, where the weights aj are given in Equation 3.9 and A represents the sum of the weights aj . T Wj = mH,j - mL,j 1 A

(3.7)

TW =

aj T W j T Wj j T Wj

(3.8)

aj = ROC

(3.9)

The ROC curves obtained for the time width feature are given in Figure 3.5. The ROC curve gives us an indication that the preliminary wavelet analysis of the organizational structure using time scale structures has provided a robust feature. As seen in Figure 3.5a, this feature is strong in separating VT from non-VT ECGs because the area under the ROC curve is large (0.961). The ROC curve for the classification between DVF and OVF is also strong, with an area of 0.930, which indicates the robustness of this feature for the classification of VF into OVF and DVF. Results The boxplot for the average time-width feature, is shown in Figure 3.6, and it is evident that there is a progressive increase in the average time from DVF to VT. The average time-width feature was used to perform an automated pattern classification. An overall three group classification accuracy of 75% was achieved using the LOO method. This initial results was encouraging for a smaller database and was published in a conference preceeding [70]. Also a binary classification for VT/Non-VT (Level 1) and OVF/DVF (Level 2) was performed on the smaller database and classification accuracies of 91.7% and 75% were achieved respectively. 44

(a) ROC for VT versus non-VT

(b) ROC for DVF versus OVF

Figure 3.5: ROC curves for the time width feature

45

Average Time Width Boxplot

3

2.5

Average Time Width

2

1.5

1

0.5

DVF

OVF Groups

VT

Figure 3.6: Average time width boxplot The interesting information that we gathered from this preliminary analysis is that there is a natural transition from VT to DVF, which is defined as OVF. This can be seen from Figure 3.6, with no overlap between VT and DVF and OVF found between the groups. Also with the improved time localization of frequency components, a feature (the time width) that can represent the ECG organizational structure was identified. The identification of discriminative localized time-scale components suggests the existence of specific patterns in the ventricular arrhythmia. Encouraged by the above initial results and expanding on the above analysis, the scalogram can be treated as a matrix, and matrix decomposition methods can be applied to extract features for an efficient and robust approach for classifying the three arrhythmia groups.

3.3.4 Wavelet Transform and Singular Value Decomposition
The initial analysis demonstrated the classification of ventricular arrhythmias using the organization structure by using the wavelet transform and image processing. The image processing however was taking advantage of specific patterns found in the scalogram matrix (as observed in Figure 4.13) and then provided a hard thresholding method to capture the organizational structure of the arrhythmia. This hard thresholding that was used may not be universal for a larger or different

46

database. Therefore, if it were possible to capture the same patterns using some form of matrix decomposition, the classification can be performed more efficiently in a closed form and robust method. Method All the 63 signals, comprising of 21 VT, 20 OVF and 22 DVF samples, from the database were used in this study, as opposed to 24 samples used in section 3.3.3 for the preliminary wavelet analysis. The signal were decomposed using CWT and the normalized scalogram was constructed. The scalogram can be treated as a matrix with s×m dimension. Since we are interested in retaining the dominant time-scale components, a technique that performs a matrix eigendecomposition would be appropriate. There are several matrix decomposition methods that use eigendecomposition. Of these methods, the principal component analysis [71­73] and singular value decomposition (SVD) [65, 74, 75] are commonly used in literature. Based on existing literature, SVD is one of the widely used decomposition methods on the wavelet scalogram and there is also evidence that it has been applied to bio-medical signal analysis [65, 74, 75]. This is because the SVD creates eigenvectors for combinations of scale and time, which is better for the identification of time-scale structures. Hence SVD decomposition of the wavelet scalogram will be used in the proposed study. SVD decomposes the information spread over the scalogram by treating the matrix as a sum of separable components [76]. The concept behind SVD is to decompose the normalized scalogram ~f (s, m) (Equation 3.5) into a canonical form. The canonical form decomposes the matrix matrix W into the format given in Equation 3.10 [77]. ~f (s, m) = U SV H W

(3.10)

The matrices U and V are unitary matrices and H denotes the complex conjugate transpose of ~f (s, m) is the matrix. The singular values are represented by matrix S . Therefore the matrix W factorized by creating two unitary matrices, U and V , and a singular value diagonal matrix S [78]. The matrices U and V H represent components that describe the energy distribution pattern found ~f (s, m). The singular values in the matrix S represents the amount in the scalogram matrix W

47

^f (s, m). The matrices U of energy captured by the components U and V H from the matrix W and V H have an unique representation when applied to the wavelet scalogram. If the scalogram is oriented such that the rows contain the scale aspect and the column contains the time aspect of the scalogram, then the U matrix contains components that capture the frequency information (in terms of scales) of the scalogram and the V H matrix captures the temporal information of the scalogram. Equations 3.11 and 3.12 indicate how U and V H capture the specific frequency and temporal information respectively. ~f (s, m)×W ~f (s, m)T = U ×S ×U T W

(3.11)

~f (s, m)T ×W ~f (s, m) = V ×S ×V T W

(3.12)

~f (s, m)×W ~f (s, m)T Both the U and V matrices perform the Eigendecomposition on matrices W ~f (s, m)T ×W ~f (s, m) respectively [79]. U and V obtain the Eigen vectors for their reand W spective matrices. The Eigen values S and S contain the same non-zero diagonal entries of ~f (s, m)×W ~f (s, m)T and matrix S , but may be placed in a different order. The matrices W ~f (s, m)T ×W ~f (s, m) identify dominant time-scale energy structures from the scale and time W respectively. Therefore performing the Eigendecomposition on these matrices allows for the identification of prominent time-scale signal structures, which is represented in the Eigen vectors that are retained in U and V H . The singular values are an indication of the dominance of the components within the scalogram. This enables efficient dimensionality reduction by retaining only application specific dominant components. ~f (s, m). Each U and V H component capture specific energy variation from the matrix W Therefore for a particular component i, the combination of the U and V H with the corresponding singular value can create the scalogram matrix that captures only a particular set of energy ~f (s, m). This can be seen in Equation 3.13, where the ith column of matrix U variations from W (y = 1,2,...,m) multiplied by ith row of matrix V H (z = 1,2,...,s) multiplied by the corresponding singular value Si creates the filtered component FW ~f ,i (s, m) scalogram.

48

H FW ~f ,i (s, m) = Uy,i ×Si,i ×Vi,z

(3.13)

The number of FW ~f ,i (s, m) matrices that will be created will be dependent on the minimum between m or s (if m is less than s then there will be m number of FW ~f ,i (s, m) matrices created, and vice versa), which is also known as the rank r of the matrix. Each component i that is created is ~f (s, m) and therefore can be used to reconstruct the original scalogram. a subset of the original W This is well demonstrated by Hassanpour for the use of noise reduction [80]. To demonstrate the power of SVD decomposition on the scalogram, two synthetic signals were created. The first signal simulates a monomorphic VT signal, and the second signal simulates the DVF signal. Part A of Figure 3.7a and Figure 3.7b shows the scalogram of the simulated VT and DVF signal respectively. The first five components from both the U and V H matrix and the line plot of the first dominant component for each matrix (shown above the rows of V H matrix and to the left of the U matrix) in part B and C respectively. Only the line plot of the first component in the U and V H matrix is given because it demonstrates that the SVD had correctly identified the dominant organizational structure, which has effectively reduced the dimension to two vectors (one from U and V H ) instead of analyzing a matrix with all the coefficients. The original signal is also given in part D of the figures. The first component, consisting of the first column of the U matrix (Part B of Figure 3.7a and Figure 3.7b) and the first row of the V H matrix (part C of Figure 3.7a and Figure 3.7b), which is the dominant time-scale component of the scalogram, can be observed to capture specific information with regards to the synthetic signal's wavelet scalogram. In particular, it captures the most dominant time-scale energy variation within the scalogram. For example, in Figure 3.7a, the energy distribution in the dominant time-scale component of the U matrix (line plot in part B of Figure 3.7a) is centered between the scales of 40 and 60, where as the dominant time-scale component in the V H matrix (line plot in part C of Figure 3.7a) has its energy distributed throughout the time window. In Figure 3.7b, it is seen that the energy in the dominant time-scale component of the U matrix is spread through the scales and the dominant time-scale component of the V H matrix has its energy sparsely distributed through time. SVD has accurately captured the dominant 49

A: Scalogram of Synthetic VT
20 20

B: Synthetic VT First 5 U components

Scales (Scale)

40 60 80 100 120 140 0.5 1 1.5

Scales (Scale)

40 60 80 100 120 140

Time (s)

2

2.5

3

3.5

4

0.5

1

1.5

2

Components 1-5

2.5

3

3.5

4

4.5

5

5.5

Amplitude (Arbitrary Units)

C: Synthetic VT First 5 V components

D: Synthetic Monomoprhic VT
0.1

Components 1-5

0.05

1 2 3 4 5 0.5 1 1.5 2 2.5 3 3.5 4

0

-0.05

-0.1

Time (s)

0

0.5

1

1.5

Time (s)

2

2.5

3

3.5

4

(a) Simulated VT

(b) Simulated DVF

Figure 3.7: SVD analysis of synthetic VT (part A) and DVF (part B) ECG

50

time-scale component found in the synthesized VT signal. The singular values gives an indication of the amount of energy retained by each component [81]. SVD reorganizes the components such that they are sorted in descending order of the singular values. Analyzing the dominant time-scale component captured by the U and V H matrix as well as the dominant component's singular value allows us to obtain discriminant features to classify the groups of arrhythmias. Feature Extraction The dominant time-scale components (first U and V H vector as well as the singular value S ) are retained because they capture the profound time-scale structures in the scalogram of the ECG. The dominant time-scale component is also preferred because it performs a dimensionality reduction of the original scalogram. An observable difference between the VT and non-VT groups from the SVD of the scalogram was the energy distribution in the dominant time-scale component of the V H matrix of a VT signal, which is expected to be equally distributed for most of the time (which could be observed in part C of the simulated VT and DVF signal in Figure 3.7a and 3.7b). Since VT can also be modeled using fewer components, it makes the initial singular value for these components to be much larger than the subsequent components. In the case of a non-VT signal, the energy distribution in the dominant time-scale component of the V H matrix will be non-uniform and relatively larger number of components will be required to represent the scalogram, which in turn makes the singular values more spread over subsequent components, unlike VT. The features that can be used to classify VT from non-VT ECGs would be the percentage of energy captured by the first component (refer to F 1 in Equation 3.14, which is generic for the ith component) and the variance of the first component (i.e. first row) of the V H matrix (F 2 in Equation 3.15). The variance is used to capture the energy spread of the component (spread through time in the case of the V H matrix). If the component is uniformly spread, then the variance is expected to be smaller when compared to a component that has a single or multiple peaks. ^i = F1 = S Si S (j )

r j =1

(3.14)

51

2 F 2 = V H ,i =

1 m-1

m

(V H (k, i) - V H )2
k=1

(3.15)

^ represents the singular value for component i expressed as a percentage For Equation 3.14, S and r represents the minimum of s and m (min[s, m]) or the rank of the matrix. The percentage of the singular value is used instead of the actual value because the value produced by taking the SVD of a matrix only gives specific information about the component. In order to use this value as a feature, the singular value must be placed into context in terms of the scalogram matrix. Therefore, the percentage is indicative of how much energy is captured by the particular U and V H component. From Equation 3.15,  2 represents the variance of vector V H and V H is the mean of the V H vector for component i. Equations 3.15 and 3.16 are given in a generalized for for any component i, but only the dominant component (i = 1) is retained, which captures the dominant time-scale structures in the filtered scalogram. The most distinguishing feature between the OVF and DVF was observed in their composition of organized signal structures which is reflected in the energy distribution of the dominant component of the U matrix. After the non-VT ECGs are segregated using features F 1 and F 2 (percentage of energy captured by dominant component and variance of the first component in the V H matrix), the first component of the U matrix was retained as a feature to discriminate between OVF and DVF in the non-VT group. As DVF is dis-organized with multiple frequency components, it has a highly varying energy distribution over its scales, which compared to OVF has fewer and narrower peaks. This can be noted from the time-scale structures found in figure 3.4. Therefore, the variance of the dominant component of U will be a suitable feature in classifying the organization range of VF. The feature F 3 using Equation 3.16 was extracted for this purpose. 1 = s-1
s

F3 =

2 U,i

(U (i, j ) - U )2
j =1

(3.16)

Although the feature F 3 resembles a bandwidth feature, it should be noted that this feature is extracted on the decomposed selective time-scale structures represented by the dominant SVD component. This dominant component helps to identify the underlying difference in the scale

52

dimension of OVF and DVF, which is also dependent on the choice of mother wavelet. This information may not be readily available from the spectral analysis, where the information is extracted from the entire signal using sine and cosine functions. ROC The ROC curve given in Figures 3.8a and 3.8b indicate that the F 1 and F 2 features selected for the VT and non-VT classification are robust. This is indicated by the area under the ROC curve, which is 0.947 and 0.958 respectively. The ROC curve provided for the DVF and OVF classification as shown in Figure 3.8c also demonstrate good discrimination with area under the ROC curve of 0.811. Therefore, this is an indication that the matrix decomposition approach is a robust method by which we could capture the organizational index. Results A two level classification was performed to evaluate the extracted features. The level 1 classification classified VT from non-VT and the level 2 classified the non-VT group into OVF and DVF. An LDA classifier with the LOO method was used to analyze the features extracted from 63 preclassified ECGs. The scatter plot, given in Figure 3.9, shows the feature space separation between VT and non-VT groups using Features F 1 and F 2. The linear boundary separating VT and the non-VT is obtained from the classification and shown in Figure 3.9. VT scalogram typically have an uniform energy distribution across time, thus making the F 2 (X-axis from Figure 3.9) lower when compared to the non-VT signals. Furthermore, since VT requires fewer number of components to model, the F 1 (Y-axis from Figure 3.9) shows that all VT samples have a relatively higher singular value when compared to the non-VT group. Hence VT signals occupy the top left corner of the scatter plot. The feature used to distinguish between OVF and DVF was the variance of the energy distribution of the first U component (F 3). Since this classification uses a single feature, a box plot shows the distribution of the feature for the two groups. Figure 3.10 demonstrates the classification of OVF and DVF using F 3 (variance of the first dominant scale component). It is observed that OVF tends to have a higher variance than DVF due to OVF dominant component typically having fewer 53

(a) ROC for VT versus non-VT (F1)

(b) ROC for VT versus non-VT (F2)

(c) ROC for OVF versus DVF (F3)

Figure 3.8: ROC curves for SVD features 54

Arrhythmia Set Scatter Plot
90
First Component Singular Value F1 (%)

VT Non-VT

85 80 75 70 65 60 55 50 45 40 1 2 3 4 5 6

First Time Component Variance Distribution F2 (Arbitrary Units)
Figure 3.9: VT and Non-VT scatter plot

55

First U Component Variance Boxplot between OVF and DVF
50

45

Variance (Arbitrary Units)

40

35

30

25

20

15

OVF Groups

DVF

Figure 3.10: OVF and DVF boxplot for the variance of the dominant U component but narrower spectral peaks and DVF having a evenly spread spectral energy distribution. LOO cross validation was performed in estimating the classification accuracy. For the Level 1 of the binary classification, an accuracy of 93.7% was obtained. The confusion matrix for the classification is presented in Table 3.3. Out of the 21 VT signals, 19 were correctly classified with an accuracy of 90.5% and out of the 42 non-VT signals, 40 were correctly classified with an accuracy of 95.2%. Table 3.3: Level 1 CWT and SVD Classification: VT and Non-VT Method Cross-validated % Groups VT VT 19 Non-VT 2 VT 90.5 Non-VT 4.8 Non-VT 2 40 9.5 95.2 Total 21 42 100 100

For the Level 2 of the binary classification, an overall classification accuracy of 80.0% was achieved, as presented in Table 3.4. Out of the 18 OVF signals, 14 were correctly classified with an accuracy of 77.8% and out of the 22 DVF signals, 18 were correctly classified with an accuracy 56

of 81.8%. As it is challenging to draw a boundary between subgroups of VF into OVF and DVF, the obtained results are encouraging. A direct three group classification was also preformed to classify VT, OVF and DVF and the overall classification accuracy was found to be 79.4% . Table 3.4: Level 2 CWT and SVD Classification: OVF and DVF Method Cross-validated % Groups OVF DVF OVF DVF OVF DVF Total 14 4 18 4 18 22 77.8 22.2 100 18.2 81.8 100

An analysis on the misclassified ECGs had indicated that the misclassification had occurred between either VT and OVF or OVF and DVF. There were no instances where a VT or DVF was misclassified into the DVF or VT group respectively. This is encouraging and considering that it would be difficult to account for all natural variations and subtle changes in the signal characteristics that are captured by a trained electrophysiologist in pre-classifying the three groups. However, using the proposed approach, the clinicians now have a scale to discriminate the organization levels between the three types of arrhythmias which could aid them in assessing the nature of the arrhythmias and decide on optimal therapeutic solutions. Therefore, the identification of the overlap zone for the benefit of patients suffering from OVF was provided through the use of CWT.

3.3.5 Endo and Epicardial data
There has been a large number of articles in the field of VF dedicated to the analysis of the Endo and Epicardial electrical activation (multichannel activations on the outer and inner surfaces of the heart) during VF [23­25, 27­30, 82­84]. This is especially true in the study of Rotors, where the dynamics of these organization centers were closely analyzed [23, 24, 28]. Since many of the recent mechanistic insights were related to the analysis of the activation on the surface of the heart, a by-product of the developed method in section 3.3.3, the time width, was applied on the endo and epicardial activation on the surface of the heart to better understand the spatial distribution of temporal organization (SDTO). The fundamental reason to performing research on 57

the surface of the heart is because there is still very limited knowledge as to the mechanisms behind the initiation and maintenance of VF. It was also discussed previously that there is a link between the organization found in the surface ECG and the organization within the heart. Therefore, the study of the SDTO may give us a better insight into the organization occurring in the surface of the heart. The information provided in this section is an auxiliary finding compared to the previously established method which focused on optimizing short and long term treatment options. The electrical activity is typically analyzed using a Lagendorff setup (described by Nanthakumar et al. [85]) to preserve the hearts functionality as long as possible after it has been explanted from the human body. This is a unique database that is obtained because of the collaborative study on VF. The electrical signal obtained from the Lagendorff setup is an 112 electrode system to capture the epicardial activation (consisting of 14 columns and 8 rows across the ventricles of the heart) and another 112 electrode system to capture the endocardial activation. Each electrode is sampled at 1000 Hz. Therefore prior to beginning the signal analysis, the signals have to be downsampled, filtered and normalized. The electrode signals can be obtained through two formats: unipolar or bipolar. The unipolar activation is obtained by measuring the electrical activation with respect to a ground that is far enough from the activation point. Bipolar activation is the recording of the electrical activation with respect to two adjacent electrodes. This thesis will only analyze the unipolar activations for the analysis. This study is a byproduct of the method developed from section 3.3.3 in order to attain a better understanding of the temporal organization across the surface of the ventricles. The method described in section 3.3.3 was applied to each electrode on the surface of the ventricles. Therefore for each electrode, the average time width was obtained for a given window of the signal. The window was shifted and again the time width was obtained. This was repeated until the length of the electrode recordings were analyzed. For this analysis, a two second window with 1.5 second overlap was used to obtain the time width feature. Figure 3.11 shows an example of a SDTO map. The darker portions of the SDTO map indicate more organization (higher average time width) where as the lighter portions indicate regions of disorganized activity (lower average time width).

58

VT

OVF

DVF

(a) Endocardium SDTO

VT

OVF

DVF

(b) Epicardium SDTO

Figure 3.11: Sample spatial distribution of temporal organization map of the LV endocardium (A) and epicardium(B) Unfortunately, the correlation of the organization on the surface ECG and the organization of the activation on the surfaces of the heart could be conducted because the hearts were explanted. The result of the analysis did show that both endocardium and epicardium exhibited similar organization structures. This result was also very similar to that previously obtained by the phase maps. Since the results were correlated to the phase maps, a second study was undertaken to determine if the organization is correlated to the rotors found from the phase map. The phase map would show a point where the phase could not be determined and each of the nodes adjacent to

59

VT

OVF

DVF

Figure 3.12: Phase map and SDTO map comparison the point is different. In addition to these adjacent nodes having different phases, all the adjacent nodes would form a full 360 degree phase shift. On the SDTO map, this was seen as a localization of highly unorganized signal, with organized structures around the node. The initial results of the comparison between the phase map and spatial-temporal organization map can be seen in Figure 3.12. It can be seen that at points where there appear to be rotors, there also appear to be a high degree of unorganized activity with surrounding organized electrograms, which is promising. The correlation of this work to existing rotor work indicates that the temporal organization on the surface of the heart is regionally organized. This can be seen by the unorganized activity in the region of the rotor with organized activity surrounding the area of the rotor. This technique identified similarities to the phase maps and could be potentially used to for future activation studies on the surface of the heart.

3.4

Results Review and Discussion

3.4.1 Review of Results
In this chapter, the organization of the signal structures were analyzed to detect the overlap zone between VT and VF. The spectral features from existing works were evaluated for the three group 60

arrhythmia classification. The percentage of power of the dominant frequency and the bandwidth performed well in separating VT from non-VT (88.90%) using an LDA classifier with LOO method. However, they performed poorly in classifying OVf from DVF (63.15%). The direct three group classification accuracy obtained using these features was 68.3% with an OVF classification of 45%. A preliminary wavelet study was undertaken to extract dominant time-scale structures from the scalogram for classifying VT, OVF, and DVF groups. The average of each time width for the time-scale components were used in a LDA classifier with the LOO method. A classification accuracy of 75% was obtained for three group classification and 91.7% and 75% were achieved for two level binary classification into VT/Non-VT and OVF/DVF respectively. The results obtained from this preliminary study encouraged a matrix decomposition approach on the scalogram for performing efficient classification of the arrhythmias in a closed form and universal method. A universal method is also preferred because the hard thresholding used to attain the initial classification accuracies may not always be applicable for a different or larger database of arrhythmias. Therefore, the time width was limited to the smaller database to indicate that the time-scale structures can be related to the organizational structure of the signal. Based on existing literature, SVD was chosen as the scalogram matrix decomposition technique to extract the dominant time-scale structures representative of the three arrhythmias. Features were extracted from the dominant SVD component (both U and V H component) as well as the singular value. The process reduced the dimensionality of the feature space drastically. A binary classifier was used to first classify VT from Non-VT arrhythmias and then classify OVF and DVF. The classification accuracies obtained were 93.7% and 80.0% respectively. This method had also achieved its goal of providing an index for organization of signal structures for VT, OVF, and DVF. The proposed method performed well in classifying OVF and DVF, where the spectral featuers had failed. The analysis of the electrical activation on the surface of the heart using multichannel electrode and the time-width feature was a by-product of this method. The aim was to analyze the temporal organization over the regions of the ventricles. This analysis had indicated a correlation between

61

phase maps and the identification of rotors. This also provided a new analysis tool to study the electrical activations on the surface of the heart.

3.4.2 Discussion
There has been little work done in analyzing the transition between VT and VF. It should be noted that the related methods mentioned previously [12,25,36] had aimed upon classifying MVT, PVT and VF. This chapter had however looked to analyze the underlying organizational structure, which classified the arrhythmias as VT (MVT and PVT), OVF and DVF. This is different because PVT is a sub-classification of VT, and therefore would require the VT therapy options. The OVF cases discussed in this chapter however could be analyzed to determine which therapy option is better suited in aiding these patients. In short term treatment options, this method can be used to better select between pacing and defibrillation shock. For long term options, the patients with predominantly OVF can be first subjected to ablation therapy before installing an ICD. To the best of our knowledge, no other proposed works has attempted to perform this type of classification. Ropella et al. had developed a spectral coherence analysis by which to differentiate MVT, PVT and VF using a two channel bi-polar intracardiac electrograms [36]. The proposed work in this chapter focuses on the sub-classification on VF into OVF and DVF using wavelet analysis and only uses a single lead ECG. Moreover the proposed work uses a time-scale technique to extract features which is a major advantage and is superior to spectral based methods such as spectral coherence analysis. Due to different groupings of the arrhythmia, databases, and number of channels used for the analysis and the presentation styles of the results, we were unable to perform a fair and direct comparison with the above work. In comparison to the phase reconstruction approach proposed by Roberts et al. [12], the proposed method is much simpler computationally, yet powerful due to the application of wavelet-SVD analysis. The identification of phase points within a region of the phase space plot requires a longer duration of the signal, which is not suitable for real time analysis. Ciaccio et al. had proposed a method to analyze the dominant frequency on the surface of canine hearts (using multichannel electrogram) to distinguish MVT, PVT and VF [25]. The method proposed in this chapter studies the temporal organizational of the signal structures using

62

a single channel human surface ECG during an arrhythmia episode, which is more relevant for real world treatment of ventricular arrhythmias. In [65] a wavelet-SVD analysis, similar to the proposed work was applied, however on ECGs during normal sinus rhythm with support vector machine based classifier to predict cardiac arrhythmias (VT and VF). This work had focused on only the scale dimension of the SVD matrix to predict the occurrence of the type of arrhythmia. This differs from the current method proposed in this chapter, where in the current method the characterization of the arrhythmias is performed after the initiation of the arrhythmia with different focus applications. The signal characteristics are quite different between SR and an ECG during arrhythmia, as can be inferred from Figure 1.1 and 1.3 from chapter 1. The potential of this work lies in the distinction of patients found in the overlap zone between VT and DVF, in particular OVF and DVF. The organization index provided in this study analyzes the organization of the ECG through time. Existing research [23­25, 27­30, 82­84] has shown many works that have studied the temporal evolution of the spatial organization of VF. Furthermore, a study [63] have also shown the degradation of VF surface ECG through time is linked to the temporal evolution of the spatial disorganization. The impact of the proposed work can be further increased by performing a study that links the mechanistic study of the spatial organization to the temporal organization found at the surface of the heart.

3.5

Chapter 3 Summary

This chapter has introduced wavelet methods that analyzed the underlying organization of signal structures in the arrhythmia. The proposed methods could aid clinicians in diagnosing those patients who suffer from arrhythmias in the overlap zone with characteristics that resemble OVF and suitably provide them with optimal therapeutic solutions and inspire newer treatment strategies. The proposed methods will also aid ICDs in choosing appropriate therapies based on an organizational index (compared to the current rate dependent technologies) and also motivate newer pacing and shock strategy. Finally, this chapter had provided a an auxiliary finding where the time-width organization analysis feature could applied to the endo and epicardium electrical activation to analyze the spatial distribution of temporal organization (SDTO), which may have implications on 63

mechanistic insights of arrhythmias. Based on the analysis performed and the results obtained from this chapter, it is evident that arrhythmias are characterized by different composition of time-scale structures. This motivates the quest for identifying specific signal morphologies in the arrhythmias that could be related to physiological phenomena. The identification of these patterns may also lead to identifying application specific discriminatory clues. Chapter 4 will explore at identifying and developing a method to accurately detect the structural patterns.

64

Chapter 4 Ventricular Arrhythmia Analysis for Out-of-the-Hospital Arrhythmia Incidents

U

NLIKE symptomatic patients, arrhythmia may occur to people with no prior history or identification of cardiac related problems. There are also instances where arrhythmias could be

initiated in normal people due to external factors, such as electric shock and physically demanding tasks that require short bursts of elevated physical activities (sports like football, rugby, etc.). When these arrhythmia occurrence happens out-of-the-hospital, these are referred to as out-of-thehospital arrhythmia incidents. The survival rate of the out-of-the-hospital arrhythmia incidents is highly dependent on the immediate treatment provided by the EMS personnel within minutes of its occurrence. During an out-of-the-hospital arrhythmia occurrence, the most important goal for EMS personnel is to choose the appropriate therapy (CPR, anti-arrhythmic drugs and defibrillation shocks) to successfully resuscitate the patient. Depending on the state of the heart suffering an arrhythmia, when the EMS staff arrive a combination of the therapies could be administered. There are existing methods that could analyze the ECG during arrhythmia in this out-of-the-hospital arrhythmia occurrences and predict if a subsequent shock would restore normal rhythm [86­92]. For the purpose of this thesis, we will focus on analyzing the pre-shock ECG during arrhythmia and relate it to signal patterns that could lead to the accurate prediction of the shock outcome. The previous analysis presented in chapter (chapter 3) had provided clues for the existence of focal signal structures and components in arrhythmia. This chapter will introduce methods that will 65

Symptomatic Patients Ventricular Arrhythmias Out-Of-theHospital Arrhythmia Occurrence

Preprocessing of Ventricular Arrhythmia Signal

Wavelet Analysis

Organizational Index

Arrhythmia Classification

Preprocessing of Ventricular Arrhythmia Signal

Pattern Analysis

Wavelet Pattern Detection

Predicting Shock Outcome

Correlation Analysis

Predicting Shock Outcome

Figure 4.1: Thesis contributions presented in Chapter 4 are highlighted analyze local and global signal patterns with the motivation of predicting the defibrillation shock outcomes of the out-of-the-hospital arrhythmia incidents using the pre-shock ECG waveforms. The outline of this chapter is highlighted in Figure 4.1.

4.1

Significance of Patterns in Ventricular Arrhythmias

The organization analysis had indicated the existence of time-scale patterns in the arrhythmia, but it did not focus on detecting specific time-scale patterns occurring during the arrhythmia. It might be possible to use the organizational analysis to predict shock outcomes in the out-of-the-hospital arrhythmia incidents. However, arriving at signal patterns that can be visually identified by the EMS in assessing the choice of therapies in a short window of time could benefit resuscitation outcomes. Hence, in this chapter the ECG will be analyzed to determine specific patterns with physiological connections that can be used to gain a better understanding of the ventricular arrhythmias and used for predicting the shock outcomes. In order to accomplish this, the ECG must be analyzed more "`locally"', as opposed to the

66

organizational analysis performed on the arrhythmia. This analysis is especially useful for patients who experience an arrhythmia in the out-of-the-hospital setting, where an optimal resuscitation of the patient can be provided within a short period of time. The timing of the resuscitation is crucial because the blood circulation must be restored immediately, otherwise serious damage can occur to the vital organs and possibly even death. The detection of local patterns can also be beneficial to the research community. Until recently, VF has always been regarded as chaotic and random in terms of electrical activation. The study into rotor dynamics has shown that there is some form of organization that can provide mechanistic insights for the arrhythmia [23,24,28]. Therefore the organization centers that dynamically change in the heart would produce particular patterns, both on the intracardiac electrograms and surface electrograms. If these patterns could be captured, then they could be associated with physiological occurrences and could determine the condition of the arrhythmia. This has medical significance because the identification of physiological markers can potentially inspire new therapy options to provide effective anti-arrhythmia treatments specific to the distribution of patterns. It can also be used to determine the effective use of current anti-arrhythmia drugs, which is currently not well established [93].

4.2

Related Work

The prediction of successful defibrillation is vital to EMS personnel because it allows to optimally resuscitate patients with limited number of defibrillation shocks. As discussed in section 3.1, the increase in the number of defibrillation shocks that are applied to the heart will damage the muscle fibers [62]. The study of successful defibrillation has been an area of intense research, both from a medical and engineering perspective. As Olshansky et al. had summarized, the effect of drug therapy on resuscitation success is continuously being conducted [93]. From an engineering point, the analysis of defibrillation success is the primary goal. Since not all defibrillations are successful, the goal is to find signal characteristics that would aid the paramedics in determining the most appropriate time to provide the defibrillation. There are a wide range of signal characteristics that have been used [86­92] to analyze the defibrillation success. Time domain features, such as 67

non-linear measure of randomness [87] and a phase space method [88], was used to predict the shock outcome. Frequency domain characteristics are also employed in the prediction of shock outcome [90, 91]. The scale distribution width, obtained from the scalogram, is also a strong predictor of the defibrillation outcome [89, 92]. This chapter introduces techniques to capture reoccurring patterns during arrhythmia and investigation of their relation in determining the shock outcomes.

4.3

Ventricular Arrhythmia Patterns

This section highlights the detection of commonly reoccurring patterns and its application to ourof-hospital arrhythmia occurrences. First, the database used for identifying the commonly occurring patterns and then testing the occurrence of these patterns on out-of-the-hospital arrhythmic occurrences are defined. This is followed by the wavelet and correlation analysis of the patterns in predicting shock outcomes.

4.3.1 Database and Preprocessing
Pattern Identification Database The identification of specific patterns in the arrhythmia was the first step in representing the signal morphology. In order to identify specific patterns in the ECG, recordings must be analyzed to determine the most reoccurring patterns during ventricular arrhythmia. There were 30 complete surface ECG recordings obtained from the MIT-BIH database [66], specifically from the Creighton database and the MIT Malignant database, which were sampled at 250 Hz. The ECGs were arrhythmia occurrences from different patients with varying medical conditions. These ECGs were analyzed to find the commonly occurring patterns, so that the ECG could be represented into a combination of these patterns. The goal was to capture as large a percentage of the signal energy using the identified patterns. These 30 ECG waveforms were filtered between the frequency range of 0.5 to 30 Hz to remove any movement and noise artifacts (similar to that of section 3.3.1). The filtered waveforms were then used to identify reoccurring patterns.

68

Out-of-the-Hospital Arrhythmia Incident Database In order to validate the patterns identified from the MIT-BIH database for the application of predicting shock outcomes of in the out-of-the-hospital arrhythmia incidents, a special database was used which contained 25 out-of-the-hospital arrhythmia occurrences. This database is unique because it was obtained through our collaborators from Toronto General Hospital and St. Michael's Hospital. These were the field data collected by the EMS personnels using the Zoll Inc. (Model AED Pro) external defibrillator. The ECG waveform obtained are the surface ECG during the period of time that the EMS personnel attempted to resuscitate the person. The waveforms were down sampled to 250 Hz and then applied through a bandpass filter, with a pass band of 0.5 to 30 Hz. A maximum of 10s of pre-shock ECGs were used for the analysis. A successful shock outcome was defined the restoration of normal sinus rhythm for at least five beats and unsuccessful otherwise [56]. Three experienced electrophysiologists of Toronto General Hospital and St. Michael's Hospital had validated and classified the 25 ECG tracings into 14 successful and 11 unsuccessful outcomes. Sample signals for a successful and unsuccessful case is shown in Figure 4.2, with the pre-shock signal, post-shock signal and defibrillation shock, for better clarity.

4.3.2 Analysis for Pattern Identification
From the analysis of ECGs, using the MIT-BIH database described in section 4.3.1, there were five patterns that were found to commonly occur in any stage of the arrhythmia. These patterns were identified manually through visual inspection and correlation within the database. This search for patterns was unbiased without any known previous physiological conditions. This was done to ensure that all types of patterns are collected as a representation of the signal. The five patterns were segmented into two groups of patterns. The first group of patterns consists of 4 local patterns. These patterns exist in each ventricle depolarization, and were identified as such. The other consisted of a global pattern. The patterns are shown in Figure 4.3. These patterns that were identified may not be the only patterns, but were found to be the most commonly occurring patterns in the given database. Each local pattern was chosen such that they do not coexist with other patterns of the same group. Patterns from the normal sinus rhythm 69

Example of an Unsuccessful Shock
1
Amplitude (Arbitrary Units)

0.5

Pre-shock Signal

Post-shock Signal

0

-0.5

Defibrillation Shock

-1 0 5 10 15 20 25

Time (seconds) Example of a Successful Shock
Amplitude (Arbitrary Units)

0.5

0

-0.5

Pre-shock Signal

Defibrillation Shock

Post-shock Signal

-1 0 5 10 15 20 25

Time (seconds)

Figure 4.2: Sample successful and unsuccessful waveforms (with pre-shock, post-shock and defibrillation shock labeled)

70

Pattern 1: Local Pattern 1 0.25 0.2 0.15 0.25 0.2 0.15

Pattern 2: Local Pattern 2

Amplitude (arbitrary units)

0.1 0.05 0 -0.05 -0.1 -0.15 -0.2 -0.25 0.2 0.4 0.6 0.8 1 Time (s) 1.2 1.4 1.6 1.8 2

Amplitude (arbitrary units)

0.1 0.05 0 -0.05 -0.1 -0.15 -0.2 -0.25 0.2 0.4 0.6 0.8 1 Time (s) 1.2 1.4 1.6 1.8 2

(a) Pattern 1
Pattern 3: Local Pattern 3 0.6 0.25 0.2 0.15 0.4

(b) Pattern 2
Pattern 4: Local Pattern 4

Amplitude (arbitrary units)

0.1 0.05 0 -0.05 -0.1 -0.15 -0.2 -0.25 0.2 0.4 0.6 0.8 1 Time (s) 1.2 1.4 1.6 1.8 2

Amplitude (arbitrary units)

0.2

0

-0.2

-0.4

-0.6

-0.8

0

0.5

1 Time (s)

1.5

2

(c) Pattern 3
Pattern 5: Global Pattern 1
1

(d) Pattern 4

0.8

0.6

0.4

Amplitude

0.2

0

-0.2

-0.4

-0.6

-0.8

-1

0.5

1

1.5

2

2.5

3

3.5

4

4.5

5

5.5

6

Time (s)

(e) Pattern 5

Figure 4.3: Four local patterns and one global pattern

71

were not considered in this detection. The patterns were strictly limited to after the onset of the ventricular arrhythmia. Physiological Relevance to Identified Patterns Most of the patterns that were independently identified have an electro-physiological connection. The local patterns 1, 2, 3 and 4 all have known physiological occurrences. Pattern 1 is widely known as indicative of a conduction block in the heart, and has been previously referred in medical settings [94]. Pattern 2 and 3 can be seen as a variation of Pattern 1. Pattern 4 is seen as a reentry electrical pattern where by the electrical activation that originally depolarized the heart will continuously depolarize the heart in a circular motion without termination [2]. The global pattern resembles a medical pattern known as Torsade de pointes [95]. The global patterns also resembles an AM modulated sinusoid as illustrated in Figure 4.3e.

4.3.3 Wavelet Analysis
The detection of the patterns can be more effectively performed on the time-scale domain, where time-scale properties of each pattern can be identified and used for the detection. The time-scale domain is preferred over the time domain analysis of the patterns (such as the one dimensional correlation) because it allows for the natural scaling of the mother wavelet, which is useful in capturing the variations or scaling of each pattern. Template matching is a well established method for detecting locations where the two dimensional pattern matches [96­98]. This method relies on the normalized correlation to determine whether the template has a higher degree of match to the pattern found on the scalogram. The scalogram templates for each pattern is identified in Figures 4.4, 4.5, 4.6, 4.7 and 4.8. There are a couple of limitations to this type of template matching method. The first limitation is that VF is known to exist in a wide range of frequencies [33, 34, 67], which requires multiple variations of templates for each pattern. The other limitation to template matching is it is ineffective when the templates are similar to each other. This is especially the case for the local pattern templates given in Figures 4.4, 4.5, 4.6 and 4.7, which have many similarities. Therefore, the properties of

72

the wavelet scalogram can be used to detect the occurrence of each pattern. The advantage of using the CWT to detect the occurrences of these patterns is based on the continuous (or nearly continuous) scaling of the mother wavelet to decompose the signal. This allows for an adaptive technique to be used to capture the variations of each pattern so that an accurate representation of the arrhythmia can be accomplished. In order to avoid the short comings of the template matching method using fixed templates with varying scales, the scalogram characteristics of each pattern can be used to better detect the occurrence of the patterns. Furthermore, since these patterns are both time and frequency dependent, it is important that the time spread is detected (which was also indicated by the time-width analysis from section 3.3.3). The use of the scalogram in the detection of the patterns is also important for creating a knowledge base that can be used for future morphological time-scale pattern analysis in studying ventricular arrhythmias. The methodology for the automated detection of the patterns was first developed and validated using the MIT-BIH database. This method was later applied to the resuscitation database to determine if specific patterns could be used to predict the defibrillation shock outcome. Method The time-scale planes were constructed for the arrhythmia segments from the 30 ECG tracing of the MIT-BIH database and the local and global patterns are shown on the time-scale planes in Figures 4.4 to 4.8. Analyzing these time-scale structures had revealed that the separation of the local and global patterns required an analysis on the energy captured by the time-scale structures. A methodology for automating the detection of the patterns on the time-scale plane was developed as described below. Detection of Local and Global Patterns The wavelet selected in the task of identifying the local patterns is the complex Gaussian wavelet (given in Figure 2.6 of chapter 2). The Gaussian wavelet has a time-scale structure that resembles the time-scale structure local patterns. The complex wavelet is employed because the phase of the ECG will be used to help determine the type of pattern that is detected. Prior to obtaining the wavelet scalogram, the signal, in the given window, was normalized. 73

Amplitude (arbitrary units)

Local Pattern 1 with Sub-peak
0.3 0.2 0.1 0 -0.1 Depolarizaion -0.2 0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 2 Sub-Peak

Time (s) Scalogram for Pattern 1 with Sub-peak
Scale (scale)

20 40 60 80 100 Sub-Peak Depolarizaion

0.2

0.4

0.6

0.8

1

1.2

1.4

1.6

1.8

2

Time (s)
Figure 4.4: Time-scale plane depiction of local pattern 1 (with the illustration of depolarization and sub-peak)

74

Amplitude (arbitrary units)

Pattern 2: Local Pattern 2
0.3 0.2 0.1 0 -0.1 -0.2

0.2

0.4

0.6

0.8

1

1.2

1.4

1.6

1.8

2

Time (s) Time-Scale Plane Depiction of Pattern 2
Scale (scale)

20 40 60 80 100

0.2

0.4

0.6

0.8

1

1.2

1.4

1.6

1.8

2

Time (s)
Figure 4.5: Time-scale plane depiction of local pattern 2

75

Amplitude (arbitrary units)

Pattern 3: Local Pattern 3
0.3 0.2 0.1 0 -0.1 -0.2

0.2

0.4

0.6

0.8

1

1.2

1.4

1.6

1.8

2

Time (s) Time-Scale Plane Depiction of Pattern 3
Scale (scale)

20 40 60 80 100

0.2

0.4

0.6

0.8

1

1.2

1.4

1.6

1.8

2

Time (s)
Figure 4.6: Time-scale plane depiction of local pattern 3

76

Amplitude (arbitrary units)

Pattern 4: Local Pattern 4
0.4 0.2 0 -0.2 -0.4 -0.6

0

0.2

0.4

0.6

0.8

1

1.2

1.4

1.6

1.8

2

Time (s) Time-Scale Plane Depiction of Pattern 4
Scale (scale)

20 40 60 80 100

0.2

0.4

0.6

0.8

1

1.2

1.4

1.6

1.8

2

Time (s)
Figure 4.7: Time-scale plane depiction of local pattern 4

77

Pattern 5: Global Pattern 1
Amplitude

0.5

0

-0.5 0 1 2 3 4 5 6

Time (s) Full Wave Rectified Pattern 5
Amplitude

0.4 0.2 0 0 1 2 3 4 5

Envelope

6

Time (s) Time-Scale Plane Depiction of Full Wave Rectified Signal
Scale (scale)

100 200 300 400 1 2 3 4 5

Envelope

6

Time (s)
Figure 4.8: Time-scale plane depiction of global pattern (with the illustration of the envelope)

78

From the wavelet coefficients, the real, scalogram and phase planes were obtained for the patterns. For the global pattern, the ECG waveform was full wave rectified before constructing the scalogram in order to capture the envelope energy. These 2D time-scale planes were obtained using Equations 4.1, 4.2 and 4.3 respectively. W fr (s, m) = |real(W f (s, m))| 100 × (|W f (s, m)|2 ) ~ W f (s, m) = 2 s m (|W f (s, m)| ) W fp (s, m) = (W f (s, m))

(4.1)

(4.2)

(4.3)

All the time-scale plane depiction of the patterns only in this chapter are W fr (s, m). In the detection of depolarizations and envelopes (in the case of the global pattern), the W fr (s, m) in combination with the W fp (s, m) is used to detect the maximas and their polarity, which is related to the depolarization. The eight-connected neighbourhood approach was used to identify the maximas. Scalogram from all the 30 ECG tracings comprising of the local and global patterns were re-analyzed for arriving at the following descriptions in order to automate the detection process of these patterns using image processing. · Local Pattern 1 contains two sub-peaks in addition to the depolarization maxima as illustrated in Figure 4.4. · Local Pattern 2 contains one dominant sub-peak in addition to the depolarization maxima. · Local Pattern 3 contains three sub-peaks in addition to the depolarization maxima. · Local Pattern 4 contains no sub-peak within the depolarization maxima. · Global Pattern contains distinct information in its envelope over many depolarizations as illustrated in Figure 4.8.

79

In order to perform the automated detection using the above constraints, additional conditions on range of energy thresholding and scale parameter were experimentally obtained and are provided in Appendix A. Using the above constraints and the conditions provided in the appendix, a sliding window of 10 seconds (in order to accommodate the variations of the patterns) and an overlap of 1 second for the local pattern and 5 second for the global pattern were used to automatically identify the patterns. To validate the above automated process, three randomly chosen ECG recording (10% of the database) from the MIT-BIH database were used. The number of automatically detected patterns were verified against manually identified patterns and the following detection accuracy was obtained. The detection accuracies were 81.5%, 75.3%, 83.3%, 78.4% and 73.1% for local pattern 1 to 4 and the global pattern respectively. With the identification and validation of the patterns detected using automated process, we tested these patterns on the out-of-the-hospital arrhythmia incident database with the motivation of associating the signal patterns to the prediction of shock waveforms. Feature Extraction The proposed automated process for detecting the local and global pattern was applied to the 25 pre-shock ECG tracings of the out-of-the-hospital arrhythmia incidents. The goal was to identify the distribution of these patterns in the successful and unsuccessful shock outcome categories. This was accomplished by computing the percentage of energy P Eneri captured by each of the pattern relative to the total signal energy. Since the energy of each pattern occurrence within the arrhythmia was retained, the total energy captured by each pattern EP atterni [where i is the pattern type (local pattern 1 to 4 and global pattern)] with respect to the total signal energy ESignal could be used as a feature. The percentage of energy P Eneri captured by each pattern is given in Equation 4.4. EP atterni ESignal

P Eneri =

(4.4)

Figure 4.9 illustrate the boxplot for the five patterns and their energy contribution to the success and unsuccessful groups. A higher percentage contribution from a pattern indicates the prominence

80

of that pattern in that group. It can be seen from Figure 4.9 that global pattern discriminates the successful and unsuccessful cases. It is also highlighted in Figure 4.10a where the frequent occurrence of the global pattern can be observed in the successful defibrillation case. Therefore, only the global pattern was used to perform pattern classification. ROC The ROC curve obtained for evaluating the feature is shown in Figure 4.11. The global pattern exhibits strong discrimination as illustrated by the area under the curve (0.841). Results The feature extracted using the global pattern was fed to the LDA classifier and the classification accuracy was computed using the LOO method. The results are provided in Table 4.1. Table 4.1: Classification: successful and unsuccessful shock outcomes Method Cross-validated % Groups Succ Unsucc Succ Unsucc Succ Unsucc Total 10 4 14 1 10 11 71.4 28.6 100 9.1 90.9 100

From the table, we could observe that 10 out of 14 successful cases and 10 out of 11 unsuccessful cases were correctly classified with an overall classification accuracy of 80%. The main objective of this study was to determine whether a characteristic pattern of the pre-shock waveform could predict the shock outcome. Based on the above pattern detection method using wavelet analysis, the global pattern was identified to perform well with good classification accuracy. This result encourages that the EMS personnel could use the frequency of occurrence of the global pattern in the ECG during the arrhythmia as a visual feedback in predicting the shock outcome. While the wavelet analysis method provided an accurate method for detecting the pattern, a more computationally efficient method is desirable for near real time applications in predicting

81

Percentage of Energy (%)

0.3 0.2 0.1 0 Suc Unsuc

Percentage of Energy (%)

Local Pattern 1

Local Pattern 2 0.4 0.3 0.2 Suc Unsuc

Percentage of Energy (%)

Local Pattern 3 0.15 0.1 0.05 0 Suc Unsuc

Percentage of Energy (%)

Local Pattern 4 0.4 0.3 0.2 0.1 Suc Unsuc

Percentage of Energy (%)

Global Pattern 1 0.8 0.6 0.4 0.2 0 Suc Unsuc

Figure 4.9: Pre-shock analysis using local and global patterns

82

(a) Successful Defibrillation Case

(b) Unsuccessful Defibrillation Case

Figure 4.10: Successful and unsuccessful pre-shock sample

83

Figure 4.11: ROC curve for feature extracted from global pattern the shock outcomes. Although a 1D correlation of the patterns will be computationally efficient, it suffers from the limitations of accommodating the scaled variations of the pattern. However, having narrowed down the global pattern to be optimal for the application in hand, the following section attempts to generate a synthetic global pattern with specific parameters that is optimized in classifying the given database.

4.3.4 Correlation Analysis
The one dimensional (1D) correlation is a simple analysis that identifies the occurrence of a given template (global pattern in this case) within a signal. In order to apply the correlation analysis for the global, a pattern template must be generated. Although the limitation of the 1D correlation is known, a synthetic single variation of the global pattern (with fixed parameters) can be identified to approximate the occurrence of this pattern in order to predict the outcome of the defibrillation. The choice of parameters for the synthetic pattern are limited by the global pattern variations present in the database under study. The creation of the global pattern template can be accomplished because the global pattern is similar to an AM modulated signal. The synthetic pattern y can be constructed as shown in Equation 4.5.

84

Synthetic Global Pattern 0.25 0.2 0.15
Amplitude (arbitrary units)

0.1 0.05 0 -0.05 -0.1 -0.15 -0.2 -0.25 0.2 0.4 0.6 0.8 Time (s) 1 1.2 1.4

Figure 4.12: Synthetic global pattern

y = sin(1 )×sin(2 )

(4.5)

The amplitude modulation (denoted by the sinusoid with frequency 1 ) is applied to a sinusoid, with frequency 2 , to construct synthetic global pattern. The correlation of the synthetic pattern was performed using multiple variations by changing the frequencies 1 and 2 . Since VF is nonstationary in nature, multiple variations of global pattern was synthetically created to best capture the occurrence of global pattern of the waveforms. An example of the synthetic global pattern is given in Figure 4.12. The normalized correlation analysis Rf,y of the signal is given in Equation 4.6 for two signals f and y [99]. The terms f and y represent the mean of the vector f and y respectively. [(fn - f n )(yn+m - y n+m )] [ fn - f n ] 2 [ yn + m - y n + m ] 2

Rf,y (m) =

(4.6)

The arrhythmia signal (given as f ) and the pattern template (given as y ) will provide a normalized correlation coefficient (Rf,y (m)). This correlation analysis was then applied to the resuscitation database. The average correlation of the signal was calculated, using Equation 4.7, to provide a single feature. The term N represents the length of the correlation vector Rf,y . 85

AveRf,y =

1 N

N

Rf,y (m)
m=1

(4.7)

The average correlation AveRf,y is used as an indicator as to the average occurrence of a particular synthetic global pattern y . If the average correlation is high for a particular variation of global pattern, then the occurrence of this variation of the global pattern is high in the given pre-shock waveform. Upon obtaining the average correlation AveRf,y for different variations of synthetic global pattern, it was found that one variation better discriminated the two groups. The frequency parameters for this variation of the synthetic global pattern were found to be 1 Hz and 5 Hz for 1 and 2 respectively. The boxplot using the average correlation for the identified variation is shown in Figure 4.13. As seen in this figure, successful cases tend to have a higher correlation to the particular variation of synthetic global pattern than unsuccessful cases. An overall classification accuracy of 80% was obtained in using the feature in an LDA classifier with the LOO method. Although the result is comparable to the wavelet based automated detection method, it should be noted that the paramenters (1 and 2 ) for the synthetic GP were optimally chosen to maximize the discrimination using the same resuscitation database. On the other hand, the wavelet based detection was developed and validated using the MIT-BIH database and was applied to the resuscitation database, and hence maintains independence of datasets. The automated detection, using a 1D correlation analysis with a single variation of GP, could be used in ICDs to improve the accuracy of predicting the shock outcome. However, for arriving at the optimal parameters, a large dataset are to be used to accommodate a wider range of variations.

4.4

Results Review and Discussion

4.4.1 Review of Results
The goal of the pattern analysis in this chapter was to help aid arrhythmia diagnosis in out-ofhospital incidences by providing a characteristic pattern that can be used to predict the shock outcomes. In order to accomplish this, five most occurring patterns were identified using the given

86

Average Correlation using Synthetic Global Pattern with f
0.35

1

1Hz and f2 5Hz

Average Correlation Coefficient

0.3

0.25

0.2

0.15

Suc Groups

Unsuc

Figure 4.13: Boxplot for average correlation analysis database. An automated detection process was developed by searching for this patterns on the scalogram based on certain constraints arrived at experimentally. The automated detection process was validated against manual inspection and identification of these patterns. These patters were then tested on the resuscitation database to evaluate if any of the most frequently occurring patterns could be a pre-cursor for the shock outcomes. The percentage of energy captured by each of the pattern was extracted as a feature to quantify the prominence of the pattern in the successful and unsuccessful categories of the shock outcomes. Using an LDA based classifier an overall classification accuracy as high as 80% was achieved using only the global pattern. This analysis revealed that the global pattern seems to have a strong correlation with the shock outcomes and can be used by the EMS personnel as quick visual feedback in preciting the shock outcomes and accordingly choose the appropriate therapy. Encouraged by the results achieved by the global pattern, a simple 1D correlation approach was tested by generating a synthetic template for the pattern. Using this approach, a classification accuracy of 80%. Allthough the parameters used for the synthetic template limit this analysis to the given database, its simplicity and gain in computational complexity make this an attractive alternative.

87

4.4.2 Discussion
The proposed pattern analysis methods are different from existing methods used for the prediction of shock outcomes. Existing methods capture particular characteristics of the signal in either time, frequency or time-frequency domains. Phase space method [88] is an example of the time domain feature used to predict the shock outcome. Frequency sub-band energies was used as a feature to predict the shock outcome [90, 91]. Foomany et al. had provided a wavelet based feature to determine whether the shock would be successful or unsuccessful [56]. The proposed method in this chapter provides the EMS with a visually identifiable morphological structure, that could be used to predict the shock outcomes. Furthermore, these morphological structures can be better analyzed for their physiological relevance, when compared to other techniques that use features from the time, frequency and wavelet domain. It is also encouraging that a result of 80% was obtained in the classification of the preshock waveforms, which is comparable to the results of existing literature, although with a small database. The analysis of the resuscitation cases is only one immediate application of the out-of-thehospital pattern analysis, yet its contribution could have an significant impact as EMS personnel can now be trained to visually identify the pattern occurrence and optimally choose the therapy, which can result in saving more lives.

4.5

Chapter 4 Summary

This chapter introduced two methods that could analyze the pre-shock waveform in order to predict shock outcomes using signal patterns. This was achieved by identifying a set of local and global patterns that were found to be commonly reoccurring. The wavelet analysis introduced a scalogram based pattern analysis method that could accurately detect the occurrence of all five patterns. This method was tested with the out-of-the-hospital resuscitation cases to show that global pattern was dominant in discriminating the two categories of shock outcomes. An average correlation analysis technique was also developed as simple and computationally efficient alternative. The representation of the arrhythmias, in terms of signal morphologies, could eventually lead to a bet-

88

ter mechanistic understanding as it allows us to determine the physiological state of the arrhythmia based on past and present occurrences of these patterns. It could lead to the development of more effective drugs, by which the progress can be directly monitored. This will however require much further analysis and greater collaboration between engineers and cardiologists.

89

Chapter 5 Conclusions and Future Works

V

ENTRICULAR arrhythmias are a subset of cardiovascular diseases that could lead to serious medical conditions and/or death. Annually around 350,000 (45,000 in Canada) SCDs

are reported in North America, most of which are VF related. Over the years, information extracted from electrocardiograms and electrograms during arrhythmia have been used to optimize the choice of treatment options and implantable medical devices for these lethal arrhythmias, despite this the mortality rate remains high. This thesis presented methodologies that using advanced signal analysis techniques attempts to improve upon the current strategies in choosing appropriate therapy for the affected population. For the symptomatic group of patients, a novel subgroup of ventricular arrhythmia was introduced with a motivation to quantify the overlap zone between the two important ventricular arrhythmias (VT and VF) which may lead to optimizing the therapy for patients in this overlap zone. For the out-of-the-hospital arrhythmia occurrences, the proposed method introduced a pattern detection approach with the motivation to identify discriminant electrocardiogram morphologies with physiological relevance that could provide a quick visual feedback to the EMS personnel as the choice of therapy has to be decided within minutes for this subgroup of affected population. The proposed approaches performed well in achieving the set goals of this thesis as validated by the results obtained.

90

5.1

Summary of Results and Impact

The first major contribution of this thesis was the study of the organizational signal structures found in the arrhythmias. A wavelet singular value decomposition (SVD) based technique was used to accurately classify the transition of the arrhythmia from VT to DVF, and a set of features were extracted to elucidate this transition. A databases consisting of 63 arrhythmia segments from the publicly available MIT-BIH databases was used to perform a 3 group classification as VT, OVF and DVF. The samples were originally classified by trained and experienced electrophysiologists which served as the ground truth. Using a LDA based classifier a two level binary classification of these groups were performed. The first level classified VT from Non-VT with a classification accuracy of 93.7% and the second level performed the classification of OVF and DVF with a classification of 80% accuracy was obtained. A direct 3 group classification was also performed and a classification accuracy of 79.4% was obtained. These results are significant in the sense that the clinicans can now grade the affinity of the ventricular arrhythmias which will help them to explore long-term ablation solutions for the patients in the overlap zone. This will also influence the ICD by improving their intelligence in choosing between pacing and delivering shocks and thereby reduce the ill-effects of unneccessary shocks. The proposed method was also used to generate a spatial distribution of temporal organization map to study the temporal organization on the surface of the heart's ventricles and a correlation was made with existing rotor maps. This tool provides avenues for regional chracterization of temporal organization of the arrhythmia on the surface of the heart which could be of significance in arriving at mechanistic insights. The second major contribution of this thesis was the prediction of shock outcomes for the outof-the-hospital arrhythmia occurrences using a pattern analysis approach. Commonly occurring signal patterns were identified in the arrhythmia, which is especially useful when diagnosing outof-hospital arrhythmia incidents. The reason for this is that when the EMS arrive to assist a patient suffering from ventricular arrhythmia, there is a short window of time in which they must diagnose and provide appropriate therapy. The wavelet scalogram based pattern detection approach was used to identify the five reoccurring signal patterns. Of these patterns, one of the pattern demonstrated strong discrimination between the successful and unsuccessful outcome groups and was used to 91

perform classification of database with 25 resuscitation cases. Using a LDA based classifier a classification accuracy of 80% was achieved in seggregating the two groups. A 1D correlation approach was also introduced as a computationally efficient alternative, specialized for the given database, which yielded a classification accuracy of 80%. Considering that the time critical nature of the resuscitation process for the out-of-the-hospital arrhtyhmia occurences, the proposed method has identified a discriminatory signal pattern that could provide a visual feedback to the EMS personnel in near real-time for monitoring and assiting in choosing the appropriate therapies.

5.2

Potential Applications

The following are few of the potential applications of this thesis work: · An organizational index based arrhythmia classifier for implantable devices and retrospective analysis of symptomatic patients. · A electrocardiogram morphology based technique for assisting EMS personnel in optimizing resuscitation outcomes. · A novel spatial distribution of temporal organization (SDTO) map which could be of use in mechanistic study of ventricular arrhythmias. · Characterization of ventricular arrhythmias using local and global signal morphologies for diagnostic and mechanistic insights.

5.3

Directions for Future Works

The methods that were discussed in this thesis had the main goal of furthering our understanding of ventricular arrhythmias (specifically VT and VF) and to aid clinicians and EMS in treating patients with ventricular arrhythmias. The organizational analysis had shown the existence of the arrhythmia in the transition state between VT and VF. This could be further explored from the ICD perspective to arrive at better algorithms. The identification of the organization index can

92

also inspire future anti-arrhythmic drugs, multiple level shock threshold programming and ablation therapies best suited for patients with OVF. The characterization of the arrhythmia using the five reoccurring patterns indicate that the arrhythmia is not completely random. This has also been indicated in the literature by analyzing the rotors within the heart during VF. This characterization approach has a lot of potential in terms of associating pathophysiological relevance to varying distribution of these reoccurring patterns. The identification of physiologically relevant signal patterns can also be used to determine if these markers are caused by specific mechanisms within the heart during an arrhythmia. These patterns could also serve as precursor to predict the possibility of future arrhythmic events. The author does hope that this information will be used one day to help provide better treatment options that can reduce the number of SCDs.

93

Bibliography
[1] S. Mallat. A wavelet tour of signal processing. 2009. [2] Arthur C. Guyton and John E. Hall. Textbook of Medical Physiology. Saunders Elsevier, Philadelphia, PA, 2011. [3] H.S. Bhatoe. The hypoxic-ischemic brain injury: Beyond semantics. Indian Journal of Neurotrauma (IJNT), 8(2):65­66, 2011. [4] LA Brewer 3rd. Sphygmology through the centuries. historical notes. American journal of surgery, 145(6):696, 1983. [5] H.V. Huikuri, A. Castellanos, and R.J. Myerburg. Sudden death due to cardiac arrhythmias. New England Journal of Medicine, 345(20):1473­1482, 2001. [6] C. Vaillancourt, I.G. Stiell, et al. Cardiac arrest care and emergency medical services in canada. The Canadian journal of cardiology, 20(11):1081, 2004. [7] B.L. Wilkoff, V. Kuhlkamp, K. Volosin, K. Ellenbogen, B. Waldecker, S. Kacet, J.M. Gillberg, and C.M. DeSouza. Critical analysis of dual-chamber implantable cardioverterdefibrillator arrhythmia detection: results and technical considerations. 103(3):381, 2001. [8] X.S. Zhang, Y.S. Zhu, N.V. Thakor, and Z.Z. Wang. Detecting ventricular tachycardia and fibrillation by complexity measure. Biomedical Engineering, IEEE Transactions on, 46(5):548­ 555, 1999. Circulation,

94

[9] I. Jekova. Comparison of five algorithms for the detection of ventricular fibrillation from the surface ECG. Physiological measurement, 21:429, 2000. [10] A. Amann, R. Tratnig, K. Unterkofler, et al. Reliability of old and new ventricular fibrillation detection algorithms for automated external defibrillators. BioMedical Engineering OnLine, 4(60), 2005. [11] T. Rocha, S. Paredes, P. de Carvalho, J. Henriques, and M. Antunes. Phase space reconstruction approach for ventricular arrhythmias characterization. In Engineering in Medicine and Biology Society, 2008. EMBS 2008. 30th Annual International Conference of the IEEE, pages 5470­5473. IEEE, 2008. [12] F. Roberts, R. Povinelli, and K. Ropella. Identification of ecg arrhythmias using phase space reconstruction. Principles of Data Mining and Knowledge Discovery, pages 411­423, 2001. [13] M.A. Arafat, A.W. Chowdhury, and M.K. Hasan. A simple time domain algorithm for the detection of ventricular fibrillation in electrocardiogram. Signal, Image and Video Processing, 5(1):1­10, 2011. [14] H. Li, W. Han, C. Hu, and M.Q.H. Meng. Detecting ventricular fibrillation by fast algorithm of dynamic sample entropy. In Robotics and Biometrics (ROBIO), 2009 IEEE International Conference on, pages 1105­1110. IEEE, 2009. [15] M. Abdullah Arafat, J. Sieed, and M. Kamrul Hasan. Detection of ventricular fibrillation using empirical mode decomposition and bayes decision theory. Computers in Biology and Medicine, 39(11):1051­1057, 2009. [16] V. Krasteva and I. Jekova. Assessment of ecg frequency and morphology parameters for automatic classification of life-threatening cardiac arrhythmias. Physiological measurement, 26:707, 2005. [17] C. Lerma, N. Wessel, A. Schirdewan, J. Kurths, and L. Glass. Ventricular arrhythmias and changes in heart rate preceding ventricular tachycardia in patients with an implantable car95

dioverter defibrillator. Medical and Biological Engineering and Computing, 46(7):715­727, 2008. [18] B.M. Asl, S.K. Setarehdan, and M. Mohebbi. Support vector machine-based arrhythmia classification using reduced features of heart rate variability signal. Artificial intelligence in medicine, 44(1):51­64, 2008. [19] MG Tsipouras, DI Fotiadis, and D. Sideris. Arrhythmia classification using the RR-interval duration signal. In Computers in Cardiology, 2002, pages 485­488. IEEE, 2002. [20] M.O.A. Omar, N.H. Solouma, and Y.M. Kadah. Morphological characterization of ecg signal abnormalities: A new approach. In Proceedings Cairo International Biomedical Engineering Conference, pages 1­5, 2006. [21] V.A. Medina-Ravell, R.S. Lankipalli, G.X. Yan, C. Antzelevitch, N.A. Medina-Malpica, O.A. Medina-Malpica, C. Droogan, and P.R. Kowey. Effect of epicardial or biventricular pacing to prolong qt interval and increase transmural dispersion of repolarization does resynchronization therapy pose a risk for patients predisposed to long qt or torsade de pointes? Circulation, 107(5):740­746, 2003. [22] A. Amann, R. Tratnig, and K. Unterkofler. A new ventricular fibrillation detection algorithm for automated external defibrillators. In Computers in Cardiology, 2005, pages 559­562. IEEE, 2005. [23] K.H. Ten Tusscher, A. Mourad, MP Nash, R.H. Clayton, C.P. Bradley, D.J. Paterson, R. Hren, M. Hayward, A.V. Panfilov, and P. Taggart. Organization of ventricular fibrillation in the human heart: experiments and models. Experimental physiology, 94(5):553, 2009. [24] S. Mass´ e, E. Downar, V. Chauhan, E. Sevaptsidis, and K. Nanthakumar. Ventricular fibrillation in myopathic human hearts: mechanistic insights from in vivo global endocardial and epicardial mapping. American Journal of Physiology-Heart and Circulatory Physiology, 292(6):H2589, 2007. 96

[25] E.J. Ciaccio, J. Coromilas, A.L. Wit, and H. Garan. Onset dynamics of ventricular tachyarrhythmias as measured by dominant frequency. Heart Rhythm, 8(4):615­623, 2010. [26] A.C. Skanes, R. Mandapati, O. Berenfeld, J.M. Davidenko, and J. Jalife. Spatiotemporal periodicity during atrial fibrillation in the isolated sheep heart. Circulation, 98(12):1236­ 1248, 1998. [27] F.H. Samie, O. Berenfeld, J. Anumonwo, S.F. Mironov, S. Udassi, J. Beaumont, S. Taffet, A.M. Pertsov, and J. Jalife. Rectification of the background potassium current: a determinant of rotor dynamics in ventricular fibrillation. Circulation research, 89(12):1216, 2001. [28] S.P. Thomas, A. Thiagalingam, E. Wallace, P. Kovoor, and D.L. Ross. Organization of myocardial activation during ventricular fibrillation after myocardial infarction. Circulation, 112(2):157­163, 2005. [29] L. Khadra, AS Al-Fahoum, and H. Al-Nashash. Detection of life-threatening cardiac arrhythmias using the wavelet transformation. Medical and Biological Engineering and Computing, 35(6):626­632, 1997. [30] G. Sierra, M. de Jes´ us G´ omez, P. Le Guyader, F. Trelles, R. Cardinal, P. Savard, and R. Nadeau. Discrimination between monomorphic and polymorphic ventricular tachycardia using cycle length variability measured by wavelet transform analysis. Journal of electrocardiology, 31(3):245­255, 1998. [31] C.S. Burrus, R.A. Gopinath, and H. Guo. Introduction to wavelets and wavelet transforms: A primer. Recherche, 67:02, 1998. [32] AJ Stewart, JD Allen, and AAJ Adgey. Frequency analysis of ventricular fibrillation and resuscitation success. The Quarterly Journal of Medicine, 85(1):761­769, 1992. [33] H.U. Strohmenger, K.H. Lindner, and C.G. Brown. Analysis of the ventricular fibrillation ecg signal amplitude and frequency parameters as predictors of countershock success in humans. Chest, 111(3):584­589, 1997. 97

[34] T. Eftestøl, K. Sunde, S.O. Aase, J.H. Husøy, and P.A. Steen. Predicting outcome of defibrillation by spectral characterization and nonparametric classification of ventricular fibrillation in patients with out-of-hospital cardiac arrest. Circulation, 102(13):1523­1529, 2000. ´ Barquero-P´ [35] O. erez, J.L. Rojo-Alvarez, A.J. Caama~ no, R. Goya-Esteban, E. Everss, F. AlonsoAtienza, J.J. S´ anchez-Munoz, and A. Garc´ ia-Alberola. Fundamental frequency and regularity of cardiac electrograms with fourier organization analysis. Biomedical Engineering, IEEE Transactions on, 57(9):2168­2177, 2010. [36] K.M. Ropella, J.M. Baerman, AV Sahakian, and S. Swiryn. Differentiation of ventricular tachyarrhythmias. Circulation, 82(6):2035­2043, 1990. [37] K. Umapathy, S. Masse, E. Sevaptsidis, J. Asta, H. Ross, N. Thavandiran, K. Nair, T. Farid, R. Cusimano, J. Rogers, et al. Regional frequency variation during human ventricular fibrillation. Medical engineering & physics, 31(8):964­970, 2009. [38] E.J. Ciaccio, J. Coromilas, A.L. Wit, and H. Garan. Onset dynamics of ventricular tachyarrhythmias as measured by dominant frequency. Heart Rhythm, 8(4):615­623, 2011. [39] K. Umapathy, S. Krishnan, V. Parsa, and D.G. Jamieson. Discrimination of pathological voices using a time-frequency approach. Biomedical Engineering, IEEE Transactions on, 52(3):421­430, 2005. [40] M. M. Goodwin. Adaptive Signal Models: Theory, Algorithms and Audio Applications. Kluwer Academic Publishers, Boston, MA, USA, 1998. [41] S. Jaggi, W.C. Karl, S. Mallat, and A.S. Willsky. High resolution pursuit for feature extraction. Applied and Computational Harmonic Analysis, 5(4):428­449, 1998. [42] L. Cohen. Time-frequency distributions-a review. Proceedings of the IEEE, 77(7):941­981, 1989.

98

[43] M.G. Tsipouras and D.I. Fotiadis. Automatic arrhythmia detection based on time and time­ frequency analysis of heart rate variability. Computer methods and programs in biomedicine, 74(2):95­108, 2004. [44] B.R. Choi, W. Nho, T. Liu, and G. Salama. Life span of ventricular fibrillation frequencies. Circulation research, 91(4):339­345, 2002. [45] F.G. Evans, J.M. Rogers, W.M. Smith, and R.E. Ideker. Automatic detection of conduction block based on time-frequency analysis of unipolar electrograms. Biomedical Engineering, IEEE Transactions on, 46(9):1090­1097, 1999. [46] L. Angrisani, P. Daponte, M. D'apuzzo, and A. Testa. A measurement method based on the wavelet transform for power quality analysis. Power Delivery, IEEE Transactions on, 13(4):990­998, 1998. [47] S. Karlsson, J. Yu, and M. Akay. Time-frequency analysis of myoelectric signals during dynamic contractions: a comparative study. Biomedical Engineering, IEEE Transactions on, 47(2):228­238, 2000. [48] O.A. Rosso, S. Blanco, J. Yordanova, V. Kolev, A. Figliola, M. Sch¨ urmann, and E. Bas ¸ar. Wavelet entropy: a new tool for analysis of short duration brain electrical signals. Journal of neuroscience methods, 105(1):65­75, 2001. [49] X. Cui and T. Huang. A novel method of selecting complex wavelet for feature extraction in partial discharge signal processing. In Image and Signal Processing, 2008. CISP'08. Congress on, volume 1, pages 128­131. IEEE, 2008. [50] E. Jones, P. Runkle, N. Dasgupta, L. Couchman, and L. Carin. Genetic algorithm wavelet design for signal classification. Pattern Analysis and Machine Intelligence, IEEE Transactions on, 23(8):890­895, 2001. [51] J. Rafiee, MA Rafiee, N. Prause, and MP Schoen. Wavelet basis functions in biomedical signal processing. Expert Systems with Applications, 38(5):6190­6201, 2011. 99

[52] P.S. Addison. Wavelet transforms and the ECG: a review. Physiological measurement, 26:R155, 2005. [53] D. Morlet, J.P. Couderc, P. Touboul, and P. Rubel. Wavelet analysis of high-resolution ecgs in post-infarction patients: role of the basic wavelet and of the analyzed lead. International journal of bio-medical computing, 39(3):311­325, 1995. [54] K. Umapathy, S. Krishnan, S. Masse, X. Hu, P. Dorian, and K. Nanthakumar. Optimizing cardiac resuscitation outcomes using wavelet analysis. In International Conference of the IEEE Engineering in Medicine and Biology Society, volume 1, pages 6761 ­ 6764, 2009. [55] PS Addison, N. Uchaipichat, JN Watson, GR Clegg, CE Robertson, PA Steen, and T. Eftestol. Wavelet power spectrum-based prediction of successful defibrillation from ventricular fibrillation. In Engineering in Medicine and Biology Society, 2001. Proceedings of the 23rd Annual International Conference of the IEEE, volume 2, pages 1812­1815. IEEE, 2001. [56] F. H. Foomany, K. Umapathy, S. Krishnan, S. Masse, T. Farid, K. Nair, P. Dorian, and K. Nanthakumar. Wavelet-based Markers of Ventricular Fibrillation in Optimizing Human Cardiac Resuscitation. In Conference proceedings:IEEE Engineering in Medicine and Biology Society, pages 2001­2004, 2010. [57] S.J. Huang, C.T. Hsieh, and C.L. Huang. Application of morlet wavelets to supervise power system disturbances. Power Delivery, IEEE Transactions on, 14(1):235­243, 1999. [58] J.N. Watson, P.S. Addison, G.R. Clegg, M. Holzer, F. Sterz, and C.E. Robertson. A novel wavelet transform based analysis reveals hidden structure in ventricular fibrillation. Resuscitation, 43(2):121­127, 2000. [59] P.S. Addison, J.N. Watson, G.R. Clegg, P.A. Steen, and C.E. Robertson. Finding coordinated atrial activity during ventricular fibrillation using wavelet decomposition. Engineering in Medicine and Biology Magazine, IEEE, 21(1):58­65, 2002.

100

[60] R.O. Duda, P.E. Hart, and D.G. Stork. Pattern classification. 2nd edn wiley. New York, page 632, 2001. [61] T. Fawcett. An introduction to roc analysis. Pattern recognition letters, 27(8):861­874, 2006. [62] J.D. Mishkin, S.J. Saxonhouse, G.W. Woo, T.A. Burkart, W.M. Miles, J.B. Conti, R.S. Schofield, S.F. Sears, and J.M. Aranda Jr. Appropriate evaluation and treatment of heart failure patients after implantable cardioverter-defibrillator discharge:: Time to go beyond the initial shock. Journal of the American College of Cardiology, 54(22):1993­2000, 2009. [63] F.H. Samie and J. Jalife. Mechanisms underlying ventricular tachycardia and its transition to ventricular fibrillation in the structurally normal heart. Cardiovascular research, 50(2):242, 2001. [64] K. Umapathy, S. Masse, E. Sevaptsidis, J. Asta, S. Krishnan, and K. Nanthakumar. Spatiotemporal frequency analysis of ventricular fibrillation in explanted human hearts. Biomedical Engineering, IEEE Transactions on, 56(2):328­335, 2009. [65] H.H. Namarvar and A.V. Shahidi. Cardiac arrhythmias predictive detection methods with wavelet-svd analysis and support vector machines. In Engineering in Medicine and Biology Society, 2004. IEMBS'04. 26th Annual International Conference of the IEEE, volume 1, pages 365­368. IEEE, 2004. [66] A. L. Goldberger, L. A. N. Amaral, L. Glass, J. M. Hausdorff, P. Ch. Ivanov, R. G. Mark, J. E. Mietus, G. B. Moody, C.-K. Peng, and H. E. Stanley. PhysioBank, PhysioToolkit, and PhysioNet: Components of a new research resource for complex physiologic signals. Circulation, 101(23):e215­e220, 2000. [67] C.G. Brown, R.F. Griffith, P. Van Ligten, J. Hoekstra, G. Nejman, L. Mitchell, and R. Dzwonczyk. Median frequencya new parameter for predicting defibrillation success rate. Annals of emergency medicine, 20(7):787­789, 1991.

101

[68] Proakis John G. and Manolakis Dimitris G. Digital Signal Processing: Principles, Algorithms, and Applications. Pearson-Prentice Hall, New Jersey, NJ, 2007. [69] R.C. Gonzalez, R.E. Woods, and S.L. Eddins. Digital image processing using MATLAB. Pearson Education India, 2004. [70] K. Balasundaram, S. Masse, K. Nair, T. Farid, K. Nanthakumar, and K. Umapathy. Waveletbased features for characterizing ventricular arrhythmias in optimizing treatment options. In Engineering in Medicine and Biology Society, 2011. IEMBS'11. 33rd Annual International Conference of the IEEE, volume 1, pages 969­972. IEEE, 2011. [71] F. Castells, P. Laguna, L. S¨ ornmo, A. Bollmann, and J.M. Roig. Principal component analysis in ecg signal processing. EURASIP Journal on Applied Signal Processing, 2007(1):98­98, 2007. [72] R. Gottumukkal and V.K. Asari. An improved face recognition technique based on modular pca approach. Pattern Recognition Letters, 25(4):429­436, 2004. [73] W.S. Yambor. Analysis of pca-based and fisher discriminant-based image recognition algorithms. 2000. [74] H. Hassanpour, M. Mesbah, and B. Boashash. Time-frequency feature extraction of newborn eeg seizure using svd-based techniques. EURASIP Journal on Applied Signal Processing, 2004:2544­2554, 2004. [75] N. Ozkurt and F.A. Savaci. Determination of wavelet ridges of nonstationary signals by singular value decomposition. Circuits and Systems II: Express Briefs, IEEE Transactions on, 52(8):480 ­ 485, aug. 2005. [76] V. Venkatachalam and J.L. Aravena. Nonstationary signal classification using pseudo power signatures: The matrix svd approach. Circuits and Systems II: Analog and Digital Signal Processing, IEEE Transactions on, 46(12):1497 ­1505, dec 1999.

102

[77] AG Akritas, GI Malaschonok, and PS Vigklas. The svd-fundamental theorem of linear algebra. Nonlinear Analysis, 11(2):123­136, 2006. [78] M.A. Casey. Auditory group theory with applications to statistical basis methods for structured audio. PhD thesis, Massachusetts Institute of Technology, 1998. [79] G. Strang and Massachusetts Institute of Technology. Computational science and engineering. Wellesley-Cambridge Press Wellesley, MA, 2007. [80] H. Hassanpour. A time-frequency approach for noise reduction. Digital Signal Processing, 18(5):728­738, 2008. [81] M. Wall, A. Rechtsteiner, and L. Rocha. Singular value decomposition and principal component analysis. A practical approach to microarray data analysis, pages 91­109, 2003. [82] K. Nanthakumar, G.P. Walcott, S. Melnick, J.M. Rogers, M.W. Kay, W.M. Smith, R.E. Ideker, and W. Holman. Epicardial organization of human ventricular fibrillation. Heart Rhythm, 1(1):14­23, 2004. [83] J. Huang, J.M. Rogers, C.R. Killingsworth, K.P. Singh, W.M. Smith, and R.E. Ideker. Evolution of activation patterns during long-duration ventricular fibrillation in dogs. American Journal of Physiology-Heart and Circulatory Physiology, 286(3):H1193, 2004. [84] K.A. Cheng, D.J. Dosdall, L. Li, J.M. Rogers, R.E. Ideker, and J. Huang. Evolution of activation patterns during long-duration ventricular fibrillation in pigs. American Journal of Physiology-Heart and Circulatory Physiology, 302(4):H992­H1002, 2012. [85] K. Nanthakumar, J. Jalife, S. Mass´ e, E. Downar, M. Pop, J. Asta, H. Ross, V. Rao, S. Mironov, E. Sevaptsidis, et al. Optical mapping of langendorff-perfused human hearts: establishing a model for the study of ventricular fibrillation in humans. American Journal of PhysiologyHeart and Circulatory Physiology, 293(1):H875­H880, 2007. [86] C.W. Callaway and J.J. Menegazzi. Waveform analysis of ventricular fibrillation to predict defibrillation. Current opinion in critical care, 11(3):192, 2005. 103

[87] R.A. Price. Predicting successful defibrillation-are we there yet? Resuscitation, 79(3):343, 2008. [88] S. Shandilya, K.R. Ward, and K. Najarian. A time-series approach for shock outcome prediction using machine learning. In Bioinformatics and Biomedicine Workshops (BIBMW), 2010 IEEE International Conference on, pages 440­446. IEEE, 2010. [89] FH Foomany, K. Umapathy, L. Sugavaneswaran, S. Krishnan, S. Masse, T. Farid, K. Nair, P. Dorian, and K. Nanthakumar. Wavelet-based markers of ventricular fibrillation in optimizing human cardiac resuscitation. In Engineering in Medicine and Biology Society (EMBC), 2010 Annual International Conference of the IEEE, pages 2001­2004. IEEE, 2010. [90] A. Neurauter, T. Eftestøl, J. Kramer-Johansen, B.S. Abella, V. Wenzel, K.H. Lindner, J. Eilevstjønn, H. Myklebust, P.A. Steen, F. Sterz, et al. Improving countershock success prediction during cardiopulmonary resuscitation using ventricular fibrillation features from higher ecg frequency bands. Resuscitation, 79(3):453­459, 2008. [91] H.U. Strohmenger. 14(3):311, 2008. [92] E. Afatmirni, K. Nanthakumar, S. Masse, K. Nair, T. Farid, S. Krishnan, P. Dorian, and K. Umapathy. Predicting refibrillation from pre-shock waveforms in optimizing cardiac resuscitation. In Engineering in Medicine and Biology Society, EMBC, 2011 Annual International Conference of the IEEE, pages 251­254. IEEE, 2011. [93] B. Olshansky, P. Nerheim, and R.E. Kerber. Anti-arrhythmic drugs and cardiac resuscitation. Cardiopulmonary resuscitation, pages 351­376, 2005. [94] D.W. Wang, P.C. Viswanathan, J.R. Balser, A.L. George Jr, and D.W. Benson. Clinical, genetic, and biophysical characterization of scn5a mutations associated with atrioventricular conduction block. Circulation, 105(3):341­346, 2002. [95] D.M. Roden. Torsade de pointes. Clinical cardiology, 16(9):683­686, 1993. 104 Predicting defibrillation success. Current opinion in critical care,

[96] S. Yoshimura and T. Kanade. Fast template matching based on the normalized correlation by using multiresolution eigenimages. In Intelligent Robots and Systems' 94.'Advanced Robotic Systems and the Real World', IROS'94. Proceedings of the IEEE/RSJ/GI International Conference on, volume 3, pages 2086­2093. IEEE, 1994. [97] K. Briechle and U.D. Hanebeck. Template matching using fast normalized cross correlation. In Proceedings of SPIE, volume 4387, pages 95­102. Spie, 2001. [98] J.C. Yoo and T.H. Han. Fast normalized cross-correlation. Circuits, Systems, and Signal Processing, 28(6):819­843, 2009. [99] J. Webster. Medical instrumentation: application and design. Wiley-India, 2009.

105

Appendix A Experimental Results of Pattern Characterization
A.1 Experimentally Arrived Average Parameter and Threshold Ranges for Each Pattern

A.1.1 Average Parameter and Threshold Ranges for Local Pattern 1
To capture the pattern, the higher frequency (lower scale) sub-band is analyzed to capture the sub-peak energy. An average range of scale factors (parameter) was experimentally obtained by analyzing 30 ECG recordings to capture the scale of the sub-peak with respect to the depolarization scale and is given in Table A.1. Table A.1: Average scale factors for pattern 1 Scale Range Scale factor 10-30 2.75 30-45 3 45-75 3.25

The sub-peaks were identified by using the W fp (s, m). The following average threshold ranges were experimentally identified for Pattern 1. · The ratio 5 
~f W sub-peak ×100 ~f W
depol

 100 must be satisfied.

· The ratio 0.25 

~f W sub-peaki ~f W

sub-peakj

 4 where i = j . 106

The first threshold states that the energy of the sub-peaks must be greater than 5% of the depolarization maxima, but cannot be greater than the energy captured by the depolarization itself. This is to ensure that this is a valid sub-peak. The second threshold checks that the energy ratio between each sub-peak is not larger than a factor of 4. If the ratio is too large, then it will resemble pattern 2.

A.1.2 Average Parameter and Threshold Ranges for Local Pattern 2
Similar to pattern 1, the average scale factor was experimentally obtained for pattern 2 and is provided in Table A.2. Table A.2: Average scale factors for pattern 2 Scale Range Scale factor 10-30 2.75 30-45 3 45-75 3.25

The sub-peaks were identified using the W fp (s, m). The following average threshold ranges were experimentally identified for Pattern 2. · The ratio 5 
~f W sub-peakM ax ×100 ~f W
depol

 100 must be satisfied. There may only be one sub-peak

that satisfies this. · The ratio
~f W sub-peakOther ~f W
sub-peakM ax

 0.25 must apply.

The first threshold states that the sub-peak with the maximum energy must at least have an energy of 5% of the depolarization energy and without exceeding it. The second threshold checks that the ratio between the other sub-peaks and the maximum sub-peak cannot exceed 0.25. If this does, then it would resemble pattern 1 or pattern 3.

A.1.3 Average Parameter and Threshold Ranges for Local Pattern 3
Similar to pattern 1, the average scale factor was experimentally obtained for pattern 3 and is provided in Table A.3. 107

Table A.3: Average scale factors for pattern 3 Scale Range Scale factor 10-30 3.25 30-45 3.5 45-75 3.75

The sub-peaks were identified using the W fp (s, m). The following average threshold ranges were experimentally identified for Pattern 3. · The ratio 5 
~f W sub-peak ×100 ~f W
depol

 100 must be satisfied.

· The ratio 0.25 

~f W sub-peaki ~ Wf

sub-peakj

 4 where i = j .

The first threshold states that the energy of the sub-peaks must be greater than 5% of the depolarization maxima, but cannot be greater than the energy captured by the depolarization itself. The second threshold checks that the energy ratio between each sub-peak is not larger than a factor of 4. If the ratio is too large, then it will resemble pattern 2.

A.1.4 Average Parameter and Threshold Ranges for Local Pattern 4
Since pattern is expected to have no sub-peaks (or if there are sub-peaks, then the energy captured by them is negligible), the average scale factors developed for pattern 1 were used to capture any sub-peak energy and is provided in Table A.4. Table A.4: Average scale factors for pattern 4 Scale Range Scale factor 10-30 2.75 30-45 3 45-75 3.25

The following average threshold is imposed on the depolarization to capture pattern 4. · The ratio
~f W sub-peak ×100 ~f W
depol

 5 must be satisfied. 108

The threshold states that all the sub-peaks must be below 5% of the energy of the depolarization.

A.1.5 Average Parameter and Threshold Ranges for Global Pattern
The envelope maximas are in the higher scales (lower frequencies) of the time-scale plane and the depolarization maximas are in the lower scales of the time-scale plane. The average scale range (and corresponding frequency range) for the type of maxima is provided in Table A.5 Table A.5: Average scale ranges for global pattern Type of Maxima Depolarization Envelope Scale Range (scale) Frequency Range (Hz) 10-50 2-10 50-400 0.25-2

Since the envelope energy spans over many depolarizations, an average of each ratio between N depolarizations and the envelope maxima was experimentally obtained. The following average threshold ranges are imposed on the average ratio of the envelope to the depolarizations. · The ratio 10  · The
~f W depolmin ~ Wf
~f W depol ×100 ~f W envelope

N

 50 must be satisfied.

depolmax

×100  25 must also be satisfied.

The first threshold checks that the average of the envelope maxima energy to the depolarization maxima energies is within the given ratio. This ensures that the envelope does belong to the global pattern. The second threshold ensure that the depolarizations are actual depolarizations and not noise. Each of the AM envelope structure in the pattern was detected individually.

109

Appendix B Publications
List of publications arised/arising from this thesis work

B.1

Journals

1. K. Balasundaram, S. Masse, K. Nair, and K. Umapathy. A Classification Scheme for Ventricular Arrhythmias Using Wavelets Analysis. Medical & Biological Engineering & Computing., Under 2nd revision, July 2012.

2. K. Balasundaram, S. Masse, K. Nair, and K. Umapathy. Analysis of Electrocardiogram Morphologies During Human Ventricular Fibrillation to Optimize Resuscitation Outcomes. IEEE Transactions on Biomedical Engineering Letters. to be submitted, July 2012.

B.2

Conferences

1. K. Balasundaram, S. Masse, K. Nair, T. Farid, K. Nanthakumar, and K. Umapathy. Waveletbased features for characterizing ventricular arrhythmias in optimizing treatment options, in Proc. IEEE Engineering in Medicine and Biology Society 2011 conference (EMBC 2011), pp. 969-972, Boston, USA.

110

Appendix C Glossary
Glossary
AED CPR CWT DVF DWT ECG EMS ICD LDA LOO MVT OVF PVT PQRST ROC SCD SDTO SR STFT SVD VT VF Automatic External Defibrillator Cardio Pulmonary Resuscitation Continuous Wavelet Transform Disorganized Ventricular Fibrillation Discrete Wavelet Transform Electrocardiogram Emergency Medical Staff Implantable Cardioverter Defibrillator Linear Discriminant Analysis Leave-One-Out Method Monomorphic Ventricular Tachycardia Organized Ventricular Fibrillation Polymorphic Ventricular Tachycardia Segments of ECG waveform Receiver Operating Characteristics Sudden Cardiac Death Spatial Distribution of Temporal Organization Sinus Rhythm Short-time Fourier Transform Singular Value Decomposition Ventricular Tachycardia Ventricular Fibrillation

111


