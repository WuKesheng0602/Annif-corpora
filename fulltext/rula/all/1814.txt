Ryerson University

Digital Commons @ Ryerson
Theses and dissertations

1-1-2011

A Comparative Study of Formation Control at the Earth-Moon L Libration Point
Waqas A. Manzoor
Ryerson University

Follow this and additional works at: http://digitalcommons.ryerson.ca/dissertations Part of the Space Vehicles Commons Recommended Citation
Manzoor, Waqas A., "A Comparative Study of Formation Control at the Earth-Moon L Libration Point" (2011). Theses and dissertations. Paper 1281.

This Thesis is brought to you for free and open access by Digital Commons @ Ryerson. It has been accepted for inclusion in Theses and dissertations by an authorized administrator of Digital Commons @ Ryerson. For more information, please contact bcameron@ryerson.ca.

A COMPARATIVE STUDY OF FORMATION CONTROL AT THE EARTH-MOON L2 LIBRATION POINT

by Waqas A. Manzoor B.Eng., Aerospace Engineering Ryerson University, 2009

A thesis presented to Ryerson University in partial fulfillment of the requirements for the degree of Master of Applied Science in the Program of Aerospace Engineering

Toronto, Ontario, Canada, 2011 Â© Waqas A. Manzoor 2011

i

i

AUTHOR'S DECLARATION

I hereby declare that I am the sole author of this thesis. I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research.

_______________________________________________________ I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. _______________________________________________________

ii

iii

DEDICATION

to my parents,

iii

iii

ABSTRACT

A COMPARATIVE STUDY OF FORMATION CONTROL AT THE EARTH-MOON L2 LIBRATION POINT Waqas A. Manzoor, Master of Applied Science, Aerospace Engineering Ryerson University, Toronto, 2011

This thesis examines the performance of control methods that fall under the optimal, predictive and adaptive classifications, subjected to sensor/actuator faults, and presents approaches to apply them to non-affine systems utilizing single thruster and solar sail actuator configurations. The system of interest consists of a leader-follower satellite formation near the L2 point of the Earth-Moon system. The control methods studied here include those which are emerging in the space systems literature, and are evaluated in terms of their transient and steady state responses, and control input variation. Numerical simulation of faults affecting both sensor and propulsion actuator systems are conducted, along with an experiment to validate the results in a laboratory environment. The observed behavioral characteristics in the simulations match those demonstrated in the experiment. Alternative representations of dynamics were explored for controller design of non-affine systems. The research presented herein provides support for the usage of the proposed control strategies in future space applications.

iv

TABLE OF CONTENTS 
AUTHOR'S DECLARATION  ......................................................................................................... ii  DEDICATION ........................................................................................................................... iii  ABSTRACT ............................................................................................................................... iv  1        Introduction .................................................................................................................... 1  1.1  1.2  Introduction .....................................................................................................................  1  Literature Review ............................................................................................................  2  Dynamics and Controls ............................................................................................  3  Propulsion and External Disturbances.....................................................................  4 

1.2.1  1.2.2  1.3  1.4 

Motivation .......................................................................................................................  5  Objectives ........................................................................................................................  6  Controller Design .....................................................................................................  6  Formation Flying Using Thrust Vectoring ................................................................ 7  Formation Flying Using Solar Radiation Pressure  .................................................... 7 

1.4.1  1.4.2  1.4.3  1.5  1.6 

Thesis Outline ..................................................................................................................  8  Summary  ........................................................................................................................  10 

2        System Dynamics .......................................................................................................... 11  2.1  2.2  2.3  2.4  2.5  2.6  2.7  2.8  Introduction ...................................................................................................................  11  Equations of Motion ......................................................................................................  11  Equilibrium Points .........................................................................................................  15  Linearization ..................................................................................................................  16  Reference Trajectory .....................................................................................................  17  Follower Satellite Equations of Motion for Formation Flying ....................................... 22  Nonlinear Reference Trajectory ....................................................................................  26  Summary  ........................................................................................................................  27 

3        Formation Control using Thrusters ................................................................................ 29  3.1  3.2  Introduction ...................................................................................................................  29  Controller Designs .........................................................................................................  30  Linear Quadratic Regulator ...................................................................................  31 

3.2.1 

3.2.1.1  Mathematical Background ....................................................................................  31 

v

3.2.1.2  Simulation Results .................................................................................................  33  3.2.2  Model Predictive Control ......................................................................................  38 

3.2.2.1  Mathematical Background ....................................................................................  38  3.2.2.2  Simulation Results .................................................................................................  42  3.2.3  Adaptive Control  ....................................................................................................  47 

3.2.3.1  Algorithm Formulation ..........................................................................................  47  3.2.3.2  Stability Analysis ....................................................................................................  50  3.2.3.3  Simulation Results .................................................................................................  52  3.3  HardwareintheLoop Simulation .................................................................................  56  General Description ...............................................................................................  57  SAFE System Using LQR Controller ........................................................................  58  SAFE System Using MPC Controller .......................................................................  61  SAFE System Using Adaptive Controller ................................................................ 63 

3.3.1  3.3.2  3.3.3  3.3.4  3.4 

Summary  ........................................................................................................................  66 

4        Performance Analysis with State Estimation ................................................................. 67  4.1  4.2  4.3  4.4  Introduction ...................................................................................................................  67  Observer Design ............................................................................................................  68  Simulation Results .........................................................................................................  69  Summary  ........................................................................................................................  81 

5        Formation Control Using Thrust Vectoring  .................................................................... 83  5.1  5.2  5.3  5.4  Introduction ...................................................................................................................  83  System Model and Controller Design ............................................................................  84  Simulation Results .........................................................................................................  86  Summary  ........................................................................................................................  97 

6        Formation Control Using  Solar Sail Propulsion .............................................................. 99  6.1  6.2  6.3  6.4  Introduction ...................................................................................................................  99  System Model and Controller Design ..........................................................................  100  Simulation Results .......................................................................................................  105  Summary  ......................................................................................................................  112 

7        Conclusions ................................................................................................................. 113  References ........................................................................................................................... 119 

vi

LIST OF FIGURES
Figure 1.1: Thesis Organization Flowchart  ................................................................................ 9 Figure 2.1: Location of L2 Point ..............................................................................................11 Figure 2.2: Lagrangian Points ..................................................................................................  16  Figure 2.3: Lissajous Trajectory  ...............................................................................................  21  Figure 2.4: Halo Trajectory  ......................................................................................................  21  Figure 2.5: Lyapunov Trajectories ...........................................................................................  22  Figure 2.6: L2centered and Relative Frames .......................................................................... 23  Figure 3.1: Normally Distributed Probability of Error  ............................................................. 30  Figure 3.2: Effect of Sensor Degradation on System Performance using LQR Controller ........ 35  Figure 3.3: State Errors using LQR Controller subjected to Sensor Inoperative Condition .... 36  Figure 3.4: Control Input using LQR Controller subjected to Sensor Inoperative Condition . 37  Figure 3.5: State Errors using LQR Controller with Unsteady Thrust ..................................... 37  Figure 3.6: Control Input using LQR Controller with Unsteady Thrust ................................... 38  Figure 3.7: Effect of Sensor Degradation on System Performance using MPC Controller ....... 43  Figure 3.8: State Errors using MPC Controller subjected to Sensor Inoperative Condition ... 44  Figure 3.9: Control Input using MPC Controller subjected to Sensor Inoperative  Condition ................................................................................................................................. 45  Figure 3.10: State Errors using MPC Controller with Unsteady Thrust .................................. 46  Figure 3.11: Control Input using MPC Controller with Unsteady Thrust ................................ 46  Figure 3.12: Effect of Sensor Degradation on System Performance using Adaptive Controller . 53  Figure 3.13: State Errors using Adaptive Controller subjected to Sensor Inoperative  Condition ................................................................................................................................. 54  Figure 3.14: Control Input using Adaptive Controller subjected to Sensor Inoperative  Condition ................................................................................................................................. 55  Figure 3.15: State Errors using Adaptive Controller with Unsteady Thrust ........................... 55  Figure 3.16: Control Input using Adaptive Controller with Unsteady Thrust ......................... 56  Figure 3.17: Satellite Airbed Formation Experiment .............................................................. 57  vii

Figure 3.18: Error Response of Numerical Simulation of SAFE using LQR Controller ............ 59  Figure 3.19: Control Input Response of Numerical Simulation of SAFE using LQR Control  ...... 59  Figure 3.20: Error Response of HIL Simulation of SAFE using LQR Controller ........................ 60  Figure 3.21: Control Input Response of HIL Simulation of SAFE using LQR Controller .......... 60  Figure 3.22: Error Response of Numerical Simulation of SAFE using MPC Controller ........... 61  Figure 3.23: Control Input Response of Numerical Simulation of SAFE using MPC  Controller. ...............................................................................................................................  62  Figure 3.24: Error Response of HIL Simulation of SAFE using MPC Controller ....................... 62  Figure 3.25: Control Input Response of HIL Simulation of SAFE using MPC Controller ......... 63  Figure 3.26: Error Response of Numerical Simulation of SAFE using Adaptive Controller .... 63  Figure 3.27: Control Input Response of Numerical Simulation of SAFE using Adaptive  Controller ................................................................................................................................ 64  Figure 3.28: Error Response of HIL Simulation of SAFE using Adaptive Controller ................ 65  Figure 3.29: Control Input Response of HIL Simulation of SAFE using Adaptive Control ....... 65  Figure 4.1: Effect of Sensor Degradation on System Performance using LQR Controller  with State Estimation ..............................................................................................................  70  Figure 4.2: Effect of Sensor Degradation on System Performance using MPC Controller  with State Estimation ..............................................................................................................  71  Figure 4.3: Effect of Sensor Degradation on System Performance using Adaptive  Controller  with State Estimation ...........................................................................................  72  Figure 4.4: State Errors using LQR Controller with State Estimation subjected to Sensor  Inoperative Condition ..............................................................................................................  74  Figure 4.5: Control Input using LQR Controller with State Estimation subjected to               Sensor Inoperative Condition .................................................................................................  74  Figure 4.6: State Errors using MPC Controller with State Estimation subjected to Sensor  Inoperative Condition ...............................................................................................................  75  Figure 4.7: Control Input using MPC Controller with State Estimation subjected to              Sensor Inoperative Condition .................................................................................................  75 

viii

Figure 4.8: State Errors using Adaptive Controller with State Estimation subjected to           Sensor Inoperative Condition .................................................................................................  76  Figure 4.9: Control Input using Adaptive Controller with State Estimation subjected to        Sensor Inoperative Condition .................................................................................................  76  Figure 4.10: State Errors using LQR Controller with State Estimation subjected to  Unsteady Thrust ......................................................................................................................  77  Figure 4.11: Control Input using LQR Controller with State Estimation subjected to  Unsteady Thrust ......................................................................................................................  78  Figure 4.12: Error Variation using MPC & State Estimation with Unsteady Thrust ............... 78  Figure 4.13: Control Input using MPC & State Estimation with Unsteady Thrust .................. 79  Figure 4.14: Error Variation using Adaptive Controller & State Estimation with Unsteady  Thrust ...................................................................................................................................... 80  Figure 4.15: Control Input using Adaptive Controller & State Estimation with Unsteady  Thrust ...................................................................................................................................... 80  Figure 5.1: Illultration of Vectored Thrust .............................................................................. 83  Figure 5.2: Angle Convention Used for Thrust Vectoring ....................................................... 84  Figure 5.3: State Errors using Duel SDRE Controllers for Thrust Vectoring Based Control ...... 87  Figure 5.4: Control Input Using DuelSDRE Controllers for Thrust Vectoring Based Control ...... 88  Figure 5.5: State Errors using Single SDRE Controller for Thrust Vectoring Based Control ...... 88  ...... 89  Figure 5.6: Control Input Using Single SDRE Controller for Thrust Vectoring Based Control  Figure 5.7: State Errors using Duel LTVMPC Controllers for Thrust Vectoring  Based  Control .................................................................................................................................... 90  Figure 5.8: Control Input using Duel LTVMPC Controllers for Thrust Vectoring Based  Control .................................................................................................................................... 90  Figure 5.9: State Errors using Single LTVMPC Controller for Thrust Vectoring Based  Control  .................................................................................................................................... 91  Figure 5.10: Control Input using Single LTVMPC Controller for Thrust Vectoring Based  Control ..................................................................................................................................... 91  Figure 5.11: State Errors using Adaptive Controller for Thrust Vectoring Based Control ........ 92  ix

Figure 5.12: Control Input using Adaptive Controller for Thrust Vectoring Based Control ..... 93  Figure 5.13: State Errors using Adaptive Controller for Thrust Vectoring Based Control  subjected to Sensor Inoperative Condition ............................................................................ 94  Figure 5.14: Control Input using Adaptive Controller for Thrust Vectoring Based Control  subjected to Sensor Inoperative Condition ............................................................................ 94  Figure 5.15: Trajectory using Duel SDRE Controller for Thrust Vectoring Based Control ....... 95  Figure 5.16: Trajectory using Duel LTVMPC for Thrust Vectoring Based Control .................. 95  Figure 5.17: Trajectory using SDRE Controller for Thrust Vectoring Based Control ................ 96  Figure 5.18: Trajectory using LTVMPC for Thrust Vectoring Based Control ........................... 96  Figure 5.19: Trajectory using Adaptive Controller for Thrust Vectoring Based Control  .......... 97  Figure 6.1: Illustration of Solar Sail on Spacecraft .................................................................. 99  Figure 6.2: Free Body Diagram of Sail ...................................................................................  101  Figure 6.3: Convention Used To Define Control Angles ....................................................... 102  Figure 6.4: State Errors using SDRE Controller for SRP Based Control ................................... 106  Figure 6.5: Control Input using SDRE Controller for SRP Based Control  ................................ 106  Figure 6.6: State Errors using LTVMPC Controller for SRP Based Control  ............................. 107  Figure 6.7: Control Input using LTVMPC Controller for SRP Based Control ......................... 108  Figure 6.8: State Errors using Adaptive Controller for SRP Based Control ............................. 109  Figure 6.9: Control Input using Adaptive Controller for SRP Based Control .......................... 109  Figure 6.10: State Errors using LTVMPC Controller for SRP Based Control subjected to  Sensor Inoperative Condition ...............................................................................................  110  Figure 6.11: Control input using LTVMPC Controller for SRP Based Control subjected to  Sensor Inoperative Condition ...............................................................................................  110  Figure 6.12: Trajectory using SDRE Controller for SRP Based Control .................................. 111  Figure 6.13: Trajectory using MPC Controller for SRP Based Control ................................... 111  Figure 6.14: Trajectory using Adaptive Controller for SRP Based Control ............................ 112 

x

LIST OF TABLES
Table 3.1: Closed Loop Eigenvalues using LQR Controller ...................................................... 33  Table 3.2: Closed Loop Eigenvalues using MPC Controller ..................................................... 41 

 

xi

NOMENCLATURE
zeros matrix
,

acceleration, or area
state-dynamics matrix

control-coupling matrix center of mass
e tracking error vector (position and velocity)

force gravitational constant control method based on H -norm
, ,

unit vectors defining orthogonal coordinate frame axes identity matrix control feedback gain matrix observer gain matrix Sun-line unit vector mass moment normal vector photonic momentum flux

,

position relative position sliding surface time thrust magnitude

xii

control input vector Velocity, or Lyapunov function spectral density matrix for process noise
, , , , ,  , ,

axes along orbital plane
linearized state variables (position)

leader-centered orthogonal coordinate secondary frame axes barycenter-centered orthogonal coordinate frame axes, or state variables (position) state vector out-of-plane (ecliptic) dimensions spectral density matrix for measurement noise out-of-plane control angle, adaptive parameter in-plane control angle eigenvalue nondimensionalized mass efficiency coefficient of solar sail reflectivity standard deviation angular velocity

Â· Â· Â· Â· Â· Â· Â· Â·

initial condition of (), or () relative to the L2 point () of Earth () of Moon () of the follower satellite relative to the barycenter-centered frame () of ith body () of body j with respect to body i nominal value of () () of the leader satellite relative to the barycenter-centered frame xiii

Â· Â·

() of the follower satellite relative to the leader satellite rate of change of () with respect to time represents vector or matrix

xiv

ACRONYMS
AUV MPC LQR LTI LTV LQE LQG HIL PID SAFE SDRE SFF SMC SRP SSDC Autonomous Underwater Vehicle Model Predictive Control Linear Quadratic Regulator Linear Time Invariant Linear Time Varying Linear Quadratic Estimator Linear Quadratic Gaussian Hardware-in-the-Loop Proportional-Integral-Derivative Satellite Airbed Formation Experiment State Dependent Riccati Equation Spacecraft Formation Flying Sliding Mode Control Solar Radiation Pressure Space Systems Dynamics & Control

xv

CHAPTER 1

Introduction

1.1

Introduction

Satellite technology in one way or another has historically, and will likely continue to be, a key component in social prosperity. From the economy, to education, to defense, modern humanity's organizational structure is dependent on processes relating to the acquisition and transfer of information to a level only currently achievable by the employment of satellite technology. Current and future satellite missions are planned to utilize orbits and formation configurations never before attempted, whether it is for new observation points of the universe or for communication strategies for remote parts of the Earth. The dynamics and control of satellites continues to be an active area of research and innovation today. Major space agencies including NASA, ESA and JAXA, and

other organizations such as DARPA, not to mention universities worldwide, have taken initiatives to implement miniature multi-satellite clusters flying in formation to achieve the same tasks traditionally accomplished by larger complex single satellites. The

advantages of this emerging model involves increased system reliability and the use of smaller rockets for orbital deployment; for example, Small Lift Launch Vehicle systems like the Pegasus, Athena II or Kosmos-3M rockets. Such satellite systems categorically require autonomous operation, putting high priority on seeking superior control methods as they emerge. The field of control systems spans across all disciplines of engineering, and periodically bestows the opportunity to cross-apply developments between diverse industries. Enabled exclusively by advances in control technologies, miniature satellites and formation flying has become a more reliable option. Control algorithms may be 1

designed to be optimal, robust, predictive and adaptive, all categories of which are covered in the research presented herein.

1.2

Literature Review

Several scientific missions have flown to Lagrangian points of the Sun-Earth system that have measurable economic advantage. A good example of such a mission is

GEOSTORM, now a system that can act as an early warning system to prevent potential disasters such as the 1989 Quebec Blackout. That blackout was caused by an abnormally large amount of solar wind forcing an oscillation of the Earth's magnetic field and causing a sharp unexpected overload in current flowing through Upper North American power lines. attention. Such missions are clearly very useful and therefore deserve special

The region about the Earth-Moon L2 collinear libration point was chosen to be the system on which the investigated control methods are applied. This is situated on the lunar far side and is an ideal location for communications satellites. Furthermore, it will

potentially be of great interest to space infrastructure development projects as an ideal observation point. The proposed depot-based space transportation architecture

considered this point to be an ideal location for an in-space fuel depot [5]. Orbits at Lagrangian points are actively exploited in the Sun-Earth system, with six past and five planned missions. The ARTEMIS mission, initiated in 2008, is only currently in flight with one of its objectives being to explore the L1 and L2 points of the Earth-Moon system and attempt insertion into a Lissajous trajectory. NASA is now currently planning to insert a communication satellite on the far side of the moon, a mission first conceived in 1968 by Farquhar [6]. There is considerable scope for research in the development of control systems subjected to external disturbances and sensor/actuator limitations.

2

1.2.1

Dynamics and Controls

Investigating the scope of control methods for implementation on a particular spaceflight application is a task a number of researchers have performed. Breger [16] presents an example of one of the recent studies that has brought the Model Predictive Control (MPC) control method into space systems. One of the key conclusions of interest to the writer is that it was specified that the MPC control method out-performed the Linear Quadratic Regulator (LQR) control method in his system. The effects of sensor noise was also studied where the error box of the trajectory and maximum control input was plotted over a range of simulated sensor errors. Farrar [23] presents a comparative analysis of formation flying at Earth-Moon libration points that seeks to establish which of the Proportional-Integral-Derivative (PID), H-norm-based (H) or Sliding Mode Control (SMC) methods result in greater fuel efficiency while subjected to perturbations from the gravitational influence of Jupiter, Solar Radiation Pressure (SRP) (as a perturbation) and noise. Xibin [25] formulates a general approach in setting up an MPC algorithm for use in formation flying in general and Bilodeau [24] expands this for formation flying in eccentric orbits with a refined optimization algorithm. Strategies and implementation issues of the selected model-based control methods were presented in Tewari [5] and Slotine [6], while system dynamics were given in Tewari [1], Curtis [2] and Kumar [4]. The adaptive controller considered in this study is unique and follows from the same family of Adaptive Sliding Mode controllers presented by Godard [21]. The work of McInnes [12,14,15,35,36,38,40,52] included deriving families of reference trajectories, proposing control angle definitions for underactuated control and demonstration of control using very small control forces at both lunar-side collinear Lagrangian points. He presents an analytical approach to solving out-of-plane dynamics and maximizing for the nominal out-of-plane control angle for displacement perpendicular to the orbital plane. Wong [11] uses solar radiation pressure to control a satellite at the L4 Lagrangian point subjected to the modeled disturbance of the Sun using Linear Quadratic Regulator and Sliding-Mode Control. Shahid [20] includes the disturbances derived from NASA's ephemeris model of the Solar System in his control of 3

a satellite at the Sun-Earth/Moon L2 Lagrangian point. Li [10] very thoroughly covers the derivation of reference trajectories in both the Sun-Earth and Earth-Moon systems with the inclusion of SRP into the dynamics, as well as the model of solar radiation pressure and procedure for deriving nominal sail size.
1.2.2 Propulsion and External Disturbances

Thrust vectoring is a technique used mainly by the aerospace industry to achieve flight path stability or high-performance maneuverability of rockets, fighter aircraft, missiles, autonomous underwater vehicles (AUVs) and some satellites. It involves redirecting the line-of-thrust at the rocket engine itself, by rotating or changing the geometry of the exhaust nozzle. The advantage of this is that a single thruster can be used to apply a control force (or moment) along (or about) multiple axis. Unlike for aeronautical vehicles, aerodynamic stiffness and damping effects for space vehicles are not a factor, and the coupling of attitude and translational dynamics is easily avoidable; hence, a separate attitude control system is assumed and the control angles are calculated in the L2-centered coordinate frame. Alternatively, it can be assumed that the spacecraft center of mass and line-of-thrust always coincide. The challenge of formulating the equations of motion compatible with the control method designs was solved following the work presented by Shahid [20] (which was applied to a different problem). Currently, all known control methods take in only affine control inputs, wherein the control inputs are coupled into the system dynamics such that it can be represented state-space form. On the other hand, Solar Radiation Pressure (SRP) as a means of control is the use of photonic momentum transfer from sunlight which is exerted on a reflective surface, or "solar sail", to induce motion. The primary advantage of this method of propulsion is that it does not require onboard propellant. In 2009, JAXA has already launched its "Interplanetary Kite-craft Accelerated by Radiation Of the Sun" (IKAROS) mission while NASA has attempted to deploy their NanoSail-D unit as a module of its FASTSAT satellite. These are the first experimental missions of their kind. They still do not

4

involve formation flying or orbits about Lagrangian points. The development of control methods, and strategies to apply them, is an active area of research. How et al [16,33] reports several observations of formation flying system behavior subjected to sensor noise. Among the conclusions of that study that was echoed therein was that the average control effort increases in direct proportion with the magnitude of sensor noise. Sharma [47] and Ni [51] go into detail about what kinds of noise one can expect in space applications, with information about causes of such, going into responses of electronic components perturbed into off-design conditions. Further insight was gained as to the selection of appropriate noise magnitude and frequency from noting the values used by Breger [16,27] in his similar analysis for formation flying in Earth orbit, and also from the technical report by Miller [22] on Apollo's flight experience. Breger [16,27] provides an analysis of Model Predictive Control, also in Earth orbit, that studies the effect of sensor noise in the ultimate positional error of the spacecraft trajectory Â­ termed the "error box". Faults in actuators are also commonly simulated, as was done so by Godard [34] for the cases of a sensor inoperative condition and unsteady thrust. Specifically for thrusters, Sutton and Biblarz [46] explain the reality of unsteadiness in thrust that is due to combustion dynamics and turbulent expansion of gas leaving the thrust chamber.

1.3

Motivation

As the region immediately around Earth continues to be occupied by more and more artificial satellites and space junk, an alternative must be sought which can provide the solution to these challenges currently being faced, or challenges that are expected in the near future. The Lagrangian points in this regard are very promising regions for satellites to be situated. Space technology has undergone great advancement that has benefited the quality of life for people all over the world. This should continue, as there is still much more that can be done; for example, if a Lagrangian point satellite can be displaced out5

of-plane by the polar radius of Earth, then why would it be required to keep inserting satellites in potentially less reliable and expensive Molniya orbits for constant line-ofsight communication with near-polar regions? By examples such as the one already discussed about GEOSTORM, and the historical lunar missions, it is well known that the capability of such endeavors does indeed exist, and needs only to be economically justified. This thesis aims to contribute to this endeavor of helping move forward the technological readiness of advanced control strategies in various space applications. 1.4 Objectives

This section highlights what seems to be insufficient in the literature and how those gaps are filled. These explanations are grouped by topic and given separately in terms of controller design, formation flying using thrust vectoring and formation flying using solar radiation pressure.
1.4.1 Controller Design

Three control methods are considered. First, linear quadratic regulator (LQR) is applied to all simulations involving thrusters that can act along the three body-frame axes. For thrust vectoring (single thruster) and solar sail propulsion, this method evolved into the more general time varying state dependent Riccati equation (SDRE). These actuator configurations can only be modeled as time-varying plants given that the input matrix contains trigonometric functions with arguments that are time-varying. Then, the model predictive control (MPC) method is applied. Linear time-varying model predictive control (LTV-MPC) is applied to the appropriate non-affine plants. The prediction and control horizons are used as tuning parameters and manipulated variables (control inputs) are left unconstrained. Also, a unique form of a novel nonlinear adaptive controller is designed. This method is a modification of one that was recently developed in [21] based on a Lyapunov function. The control grain is defined to be a function of the adaptive parameter. Although the LQR and MPC methods are based on linearized dynamics, the 6

correcting force is applied on the nonlinear plant. In addition to the control methods, the analysis also involves analyzing controller performance against simulated sensor errors, sensor inoperative condition and unsteady thrust. The magnitude of noise used in the numerical simulation for sensor measurement and unsteadiness of thrust is conservatively greater in comparison to the external disturbances the system would likely face in reality.
1.4.2 Formation Flying Using Thrust Vectoring

The differential equations governing the motion of the system become more complex when the effect of a single thruster variably couples with all translational degrees of freedom. Equations of motion based on the third time derivative to describe motion are needed for the system to be affine without the model becoming an approximation. This increase in order of the differential equations of motion accomplishes the necessary condition of the system being able to accept affine control inputs, which would not normally exist due to control angles being arguments of trigonometric functions. In this study the technique from [20] is extended to dynamics which involve non-constant Sunline.
1.4.3 Formation Flying Using Solar Radiation Pressure

Farquhar's original idea of a halo orbit on the lunar far side being a suitable location for a communication satellite is combined with the displaced orbit concept presented in [12]. The dynamics presented in [12] considered an under-actuated sail and only went as far as defining a reference trajectory. The writer then uses this method, but with a suitable fully-actuated convention defined in [20] for the sail and successfully executed the concept in simulation. Using a suitable nominal sail size, deduced from the reference trajectory formulation in [10], and a suitable nominal control angles following the procedure presented in [12], it was shown that formation flying is achievable in numerical simulation. The controller was also arranged to allow for nominal out-of-plane displacement for other applications. 7

1.5

Thesis Outline

This section describes the structure of the thesis. An organizational flowchart describing the flow of this thesis is presented in Figure 1.1. The problem and goal of the research, including a literature review, has already been provided thus far here in Chapter 1. Next, before any controller is designed, the system model to be controlled is described in Chapter 2. The equations of motion of the system are derived, arranged in a suitable form for controller application and a suitable reference trajectory proposed in this chapter. Then in Chapters 3 to 6, simulation results are presented and performances are compared for the controllers in terms of maximum control force, maximum overshoot, steady state error and settling time. Chapter 3 and Chapter 4 involve the utilization of thrusters along three body-frame axes, directly and in conjunction with an observer, respectively. An observer is used to filter noise and provide estimated state variables for the controller to act on. Additionally, Chapter 3 includes results of hardware-in-the-loop testing on the testbed described in Section 3.3.4. The mathematical design of the considered control methods is given in Chapter 3 as well, whereas the theory presented in Chapter 4 is the design of the observer. Chapter 5 and Chapter 6 comprise what is termed "advanced configurations". These involve actuator configurations that have not yet been applied in formation flying or orbital control at Lagrangian points. Chapter 5 presents controller performance where the control algorithm involves reformulation of the representation of thrust vectoring dynamics in a form suitable for application of the control methods. Chapter 6 is the same except that maneuvering is done using a solar sail. The theory portion in these last two chapters involves linearization and derivation of equations of motion of an applicable form with specific definitions of control angles such that control using those configurations becomes possible. Finally, Chapter 7 concludes the study presented in this thesis, and offers suggestions for future work to carry on this research.

8

Figure 1.1: Thesis Organization Flowchart

9

1.6

Summary

In this study, a more relevant pool of control methods (in comparison with those presented in literature) and three different force generating mechanisms are analyzed with the evaluation of their performance against sensor and propulsion actuator faults. The main contributions of this thesis to the field of satellite control are listed below: 1. Development of linear and nonlinear control algorithms for formation control about the Earth-Moon L2 point using control methods that are gaining importance in space applications, namely: (a) Infinite Horizon Unconstrained Model Predictive Control (LTI-MPC, LTV-MPC) (b) Lyapunov-based Direct Gain Tuning Adaptive Control (Adaptive) (c) Linear Quadratic Regulator (LQR), or State Dependent Riccati Equation (SDRE) as the LTV version (d) In conjunction with the observer: Linear Quadratic Estimator (LQE, basically a Kalman Filter)
 

2. Validation of control methods through implementation on a space systems testing platform called the Satellite Airbed Formation Experiment (SAFE), in the Space Systems Dynamics & Control Group (SSDC) laboratory at Ryerson University. 3. Formulating dynamics that enable the use of thrust vectoring and SRP based propulsion actuation, having inherently affine control inputs, for the control of a follower satellite's trajectory about a leader satellite following a nonlinear reference trajectory. 4. Analysis of the performance of control systems subjected to sensor noise, sensor offline and propulsion actuator degradation.

10

CHAPTER 2

System Dynamics

2.1

Introduction

In this chapter, a brief review of the equations of motion of the Earth-Moon circular restricted three-body system is derived. An analytical solution to the linearized equations of motion about the L2 point is then determined from which two zero-force candidate reference trajectories are deduced, namely, the Lissajous and Lyapunov orbits. Mathematical background and trajectory simulation for the non-natural Halo orbit are also presented. Figure 2.1 is an illustration of the position of the L2 point relative to the three-body system to give the reader a better understanding.

Figure 2.1: Location of L2 Point 2.2 Equations of Motion

Equating Newton's Second Law of Motion with the Law of Universal Gravitation and dividing through by the mass of the ith body to obtain specific force, the N-body general

11

equation of motion is produced, showing the force of gravity acting on the ith mass by the others:

(2.1)

In the case of the circular restricted three-body problem, N = 3. G  6.67428 Ã 10-11 N(m/kg)2 is the universal gravitational constant. The vector difference of the position vectors in the brackets is the separation distance between centers of mass of the respective bodies. What follows next is something that was first realized by Lagrange, after whom the equilibrium solution of the three body problem is named. Expansion of this equation shall now be done for the third mass which represents the satellite. The following equation describes the motion of the satellite in the presence of the two primaries (Earth and Moon): (2.2)

|

|

|

|

The subscript on the left-hand side will hereafter be dropped for convenience, as the subject of interest is known to be the satellite motion. Nondimensionalization of the equation is now in order, given important reasons which include: (a) (b) Overall simplification of the equations of motion. Great reduction of computational effort/time in simulations with a unit nondimensional time interval larger than that of the true second; a real second-by-second simulation of a one month orbit, for example, is very inefficient. (c) (d) Avoidance of potential singularities resulting from machine truncation of numbers following from (b); thus, an improvement of accuracy. It is necessary for applicability in most model-based control methods, including those designed in this study.

12

All distances are normalized by the separation distance of the primary masses, denoted by R12, and all masses are normalized by the combined mass also of the primaries (m1 + m2); let the nondimensional mass of the second largest body (m2) be denoted by . Geometrically, the vector difference between the position of body i ( = 1, 2 ) and the satellite (body 3) is equal to the position vector of the satellite from body i, hereafter denoted by ri. , (2.3)

Applying the Law of Universal Gravitation at the center of mass of the system, the nondimensional value of the gravitational constant is sought such that the angular velocities of the primary bodies about the center of mass would equal one. The frame of reference is rotating at this angular velocity with the primaries. Let a denote the net acceleration of all bodies in the system towards the center of mass. Also, the mass of the satellite is negligible compared to the masses of the primaries; m3/(m1+m2)  0.

|

|

|

|

|

|

(2.4)

Eq. (2.4) rearranges to give the square of angular velocity,  | where |

(2.5)

is the rotation rate of the primaries about the barycenter of the three-body

system. One nondimensional unit of time is then equal to 1/ . Another simplifying conclusion is realized by nondimensionalizing the equation describing the system barycenter. Note that R1 and R2 are always fixed along the x axis and that the acceleration due to gravity acting in the y and z directions will depend on the respective nonzero y and z displacements. Let (i, j, k) represent the direction vectors that define the axes of the rotating coordinate frame.

13

(2.6a)

Â·

Â·

(2.6b)

Â· 

Â· 

Â·

(2.6c)

1Â· 

Â· 

Â·

(2.6d)

Substituting these results and notations in Eq. (2.2) and decomposing the vector in three dimensional configuration space R3, the gravitational component of the satellite's acceleration becomes 1 | | 1 | | 1 | | 1 | | (2.7a)

| |

(2.7b)

| |

(2.7c)

Superimposing Eq. (2.7) with the centrifugal and Coriolis accelerations in this rotating frame and nondimensionalizing it ( = 1) yields 1 | | 2 1 | | 1 | |

2

(2.8a)

| |

(2.8b)

14

1 | |

| |

(2.8c)

Eqs. (2.8) are the equations of motion for the circular restricted three body system. They describe the motion of an uncontrolled (free) satellite under the influence of two other (celestial) bodies, as long as the masses of the other bodies are much greater than the mass of the satellite and that the bodies keep a fairly constant separation distance (this will be case when the m2 has an orbital eccentricity of approximately zero about m1). The modification of these equations of motion to include the effect of control forces will be presented in Section 2.4.

2.3

Equilibrium Points

Equilibrium points are defined as a set wherein the velocity and acceleration of the dynamical system is zero. This corresponds to the minima of a Lyapunov function with suitable conditions of stability centered over the origin of the phase-plane representing the point of minimum pseudo-potential energy. Applying this concept to Eq. (2.8), the resulting solution can be categorized in two groups. Firstly, all equilibrium points lie on the plane of the primaries; solution points L 0.83692,0 , L 0. The first group follows from the easily noted The second group is 0, which from numerical computation establishes the collinear libration 1.15568,0 , and L 1.00506, .

comprised of the triangular libration points which follow from elementary manipulation of the equations: L 0.4875, 1.5 , L 0.4875, 1.5 . The names of these groups

have to do with the geometry that they make out with respect to the primaries, shown in Figure 2.2. Note that when the mass difference of the primaries is great enough as is the case for the Earth-Moon system, the center of mass actually lies within m1. In this study, only the L2 point is of concern due to its relevance in present and proposed missions, and potential applications.

15

Figure 2.2: Lagrangian Points

2.4

Linearization

Eqs. (2.8) are in a nonlinear form; they need to be linearized for stability analysis, reference trajectory determination and for the implementation of linear model-based control methods. To do this, the first order binomial expansion of the nonlinear denominators of the gravitation terms is taken. 1
/

1 1
/

(2.9)

The linearized term as a whole can then be represented as a constant:

16

1
/

1

/

(2.10)

After linearizing about y = 0 for the collinear equilibrium points, the state space matrix equation can be written as

1 0 0

2

0 0 1

0 0

0 2 0

2 0 0 0 0 0

Â·

(2.11)

where B is the control coupling matrix and u is the control input. Linearization of relative equations is given in section 2.5.

2.5

Reference Trajectory

Extracting the oscillatory frequencies from the eigenvalues from the characteristic equation of state dynamics matrix, the resulting incommensurable roots suggest that one can expect such dynamical systems to incorporate zero-force trajectories that can be used as a feasible reference trajectory which is periodic or quasi-periodic in nature. The unforced solution of the time invariant system, Eq. (2.11), is given by

0

0

(2.12)

where qi and pi are the right and left eigenvectors of the state dynamics matrix, respectively, corresponding to the ith eigenvalue.

17

After further expanding Eq. (2.12), with Euler's formula applied to the e for imaginary  (marginally stable poles), the remaining exponential terms from non-imaginary, positive eigenvalues can be cancelled out using the initial conditions for velocity as: 0 0 where , 0 0 (2.13a) (2.13b)

is the frequency from the imaginary axis eigenvalues is the

corresponding to the in-plane mode of oscillation of the unforced system, and

frequency corresponding to the out-of-plane eigenvalues. The remaining expansion of Eq. (2.12) gives the bounded solution to Eq. (2.11) and can be used as a zero-fuel reference trajectory. 0 cos 0 cos 0 cos By selecting initial conditions becomes (2.15a) (2.15b) 0 (2.15c) 0 0 0 0 0 0 (2.14a) (2.14b) (2.14c) 0, a candidate reference trajectory

Note, Eq. (2.14) is a periodic orbit that lies entirely on the orbital plane of the primaries, which by definition is called a Lyapunov orbit. Following the type of reference trajectory chosen by Li [10], and formation size used in [4,9-11], A 3.433 was chosen for this

18

study to maintain 10 km on the major axis. This elliptical trajectory has an eccentricity of 0.9392. It is also possible to include an out-of-plane oscillation while still maintaining the zerofuel property of the orbit. If the initial velocity condition along the z dimension was 0 0 , then following Eq. (2.14c), (2.15c) would become (2.16) This trajectory, defined by Eqs. (2.15a, (2.15b) and (2.16) is known as a Lissajous orbit. Since the ratio of in-plane and out-of-plane frequencies is not a rational number, the trajectory never closes and is thus referred to as a "quasi-periodic" orbit. However, if the condition is enforced, then the trajectory becomes completely closed (and thus periodic). Such a trajectory is referred to as a Halo orbit because it displays a projected circle about the x axis, thus seeming to trace a halo around a primary as viewed from the other primary. The advantage of a Halo orbit over a Lissajous orbit is that the spacecraft will never be in eclipse by m2, maintaining an unobstructed sightline with m1; the disadvantage is that the enforced condition is not a natural part of the solution to the equations of motion, requiring the continuous utilization of control force. The reference trajectory is derived for the case where solar radiation pressure is used as a means to control a spacecraft. Since the presence of the solar sail implies a constant force applied to the satellite, with a magnitude proportional to that of the nominal sail area, it will affect the nominal motion. This affect is sinusoidal due to the constant rotation of the Sun-line vector relative to the spacecraft. 2 2 1 2 1 0 cos sin (2.17a) (2.17b) (2.17c)

The reference trajectory is defined to be a natural motion about the collinear equilibrium point so that control force would go to zero. The reference trajectory will thus

necessarily be a solution to the above differential equations of motion. From Eq. (2.17), 19

describing the nominal motion, it is expected that the general solution of the differential equation will be of the following form. cos cos . (2.18a) (2.18b) (2.18c)

Therefore, Eq. (2.18) is a reference trajectory. Note that in Eq. (2.18c), the constant value is usually zero, but may be a non-zero value so long as the sail maintains a nominally non-perpendicular angle between its surface and the plane of the primaries. Coefficients, which represent the amplitudes of motion, must first be solved before the trajectory can actually be used in the controller. This is done by taking Eq. (2.18) and its time derivatives representing the reference velocity and acceleration, and substituting then back into Eq. (2.17). coefficients. (2.19a) Then the equations are solved simultaneously for the

(2.19b)

Nominal motion along the z direction will remain fixed, either zero or at some out-ofplane displacement. Here, only the x and y equations were of importance. For the L2 point of the Earth-Moon system,  0.0358An and  -0.6998An. An area-to-mass ratio of 10 is assumed, requiring the nominal sail area to be kept at 10% of the value of the characteristic sail acceleration [10]. The eccentricity of this elliptical trajectory is 0.09987. Figures 2.3-2.5 show the Lissajous, Halo and two Lyapunov trajectories (one for use with thrusters and the other with SRP). The formation size of the Lissajous and Halo trajectories was chosen to be 150% of the average lunar radius. 20

Figure 2.3: Lissajous Trajectory

Figure 2.4: Halo Trajectory 21

Figure 2.5: Lyapunov Trajectories

2.6

Follower Satellite Equations of Motion for Formation Flying

In this section, the relative equations of motion of the follower satellite are derived with respect to the leader satellite. The purpose of this is that the very concept of formation flying requires control of the formation. The formation is composed of follower (also known as slave) satellite(s) moving about a leader (also known as master) satellite. If all satellites in the formation were controlled independently as leaders, then it would not be classified as formation flying. Such a flight management structure becomes convenient for satellites that must remain in formation. Figure 2.6 illustrates the leader-centered relative frame in relation to the L2-centered frame in which the equations of motion Eq. (2.8) are derived, and R is the Cartesian position vector.

22

Figure 2.6: L2-centered and Relative Frames

Eq. (2.20) is the usual equation of motion along the y direction as given in Eq. (2.8b) but relating to the follower spacecraft:

(2.20)

From Figure 2.6, the following is true by definition (2.21)

23

Then Eq. (2.20) becomes 1

2

(2.22)

Rearranging, 1 1 (2.23)

2 2

Notice that the last term in the first square brackets is equal to terms collected in the round brackets; therefore, that whole part of Eq. (2.23) vanishes. Finally, the remaining portion of the equation again happens to be in exactly the same form as Eq. (2.8b), but in terms of the relative frame. linearization in Eq. (2.24) where Linearization follows; first, giving the definition of is the general state:

(2.24)

2

1

3 1

3 1 1

2 2 2 1 1

(2.25)

24

The terms in the inner bracket in the second last line of Eq. (2.25) are approximately constant and are a function of spatial position relative to the primaries and has negligible contribution with changes in rF that are small compared to the separation distance of the primaries presented in Eq. (2.10). Following the same procedure for the equation of motion corresponding to the x direction,

2
2

1
1

1
1

(2.26)

2 2

1 1 1 (2.27)

1 2 1

1 1 (2.28)

This time the terms corresponding to the leader satellite did not cancel out. This is a common feature of relative dynamics. However, the first of the square brackets are not dependent on the parameters that are considered to be states (xr,,yr,zr) and their time derivatives. Therefore, that whole portion again vanishes, but this time due to the differentiation with respect to state in the linearization, making the result Eq. (2.29) which corresponds to that given in Eq. (2.21): 2 2 1 (2.29)

25

Similarly, for motion along the z dimension: 1 (2.30)

1

(2.31)

One can very easily obtain the linearized result (2.32) It can be seen that the follower's state depends on the leader's state in reality, but the linearized dynamics are the same whether it be treated as a leader or follower. This also suggests that the follower can have the same reference trajectories about the leader, and similarly for the leader about the L2 point. In simulations that involve linear (modelbased) controllers, the linearized equations of motion Eq. (2.25), Eq. (2.29) and Eq. (2.32) shall be used, and the calculated control force ultimately applied on the nonlinear equations of motion Eq. (2.23), Eq. (2.28) and Eq. (2.31). 2.7 Nonlinear Reference Trajectory

In section 2.4, it was proposed that a reference trajectory could be derived using the approach of solving for the characteristic equation from the state dynamics matrix presented in Eq. (2.11), from which one can construct the general solution of the differential equation, substitute in the oscillatory frequencies from the marginally stable roots (poles) of the characteristic equation, and finally select initial conditions that cancel out terms dependent on the unstable poles. Note however that Eq. (2.11) does not represent the actual dynamics of the three-body system. It is a linearization, hence an approximation which is valid only in the vicinity of the L2 point. Since the accuracy

reduces with distance away from the L2 point, the spacecraft would behave differently in

26

reality. Therefore, a zero-force reference trajectory about the point is not necessarily accurate when taking this approach.

The nonlinear equations of motion given by Eq. (2.8) are a relatively true representation of the dynamics of the three-body system, neglecting only gravitational anomalies close to the primaries, the influence of celestial bodies farther out on space, low-mass celestial bodies within the three-body region, micrometeorite collisions, sources of radiation pressure and other unmodelled dynamics. An analytical solution does not exist. The only way then to determine the solution is by using a numerical method. Several

methods exist, amongst which the most popular ones include the PoincarÃ©-Lindstedt method and the Pernicka-Howell method. The Pernicka-Howell method is used in the present study to determine the reference trajectory of the leader spacecraft. This is done because the relative equations of the follower depend on the leader in the nonlinear system, and are thus necessary. The reader is referred to [20] for a detailed derivation of the nonlinear reference trajectory at the L2 point using the Pernicka-Howell method. 2.8 Summary

The equations of motion of the circular restricted 3-body system were derived from the general N-body problem. They were then nondimensionalized. The closed form Several reference solutions of the equations of motion were presented with the linearization to state-space form as required for compatibility with model-based controllers. trajectories and their initial conditions were derived from the linearized model, including for when the influence of SRP is modeled into the dynamics; these included the Lissajous, Halo and Lyapunov trajectories. Finally the SFF problem was addressed with the derivation of the relative equations of the follower spacecraft with respect to the leader spacecraft. These equations were again linearized and it was found that the form of state space model, thus the reference trajectory, is unchanged in the relative frame (about the leader satellite). A brief discussion on nonlinear reference trajectory was also presented. 27

28

CHAPTER 3

Formation Control using Thrusters

3.1

Introduction

An overview of the three control methods under investigation for this study is included in this section. The first method is called the "Linear Quadratic Regulator" (LQR) [1]. A second linear control method that is prevalent in the process industry, known as "Model Predictive Control" (MPC) [27], is then presented. This has recently become a topic of research in the space systems field, but so far only examined in the literature for satellites orbiting the Earth. Finally, "Adaptive Control', which is a nonlinear control method, is evaluated. This section mainly serves as a comparison of controller performance under both ideal conditions and non-ideal conditions with simulated sensor external disturbances.

When evaluating controller performance, a basis of comparison must be established. The approach used in this study is to initially tune the controllers such that they all yield the same nominal performance in terms of settling time and overshoot, given a specific operating environment. The tuning requirements in numerical simulation, HIL

simulation and in deployment are expected to change due to unmodeled dynamics. Even sampling time (for digital controllers like MPC) and solver step size can affect results if not appropriately chosen. The approach selected in this study is to nominally choose tuning gains that yields the best performance when the system is not subjected to any external disturbances.

29

3.2

Controller Designs

In the literature, when a stated standard deviation in error, , is introduced into a system, its performance is expected to be satisfactory within 3, normally distributed [34]. This standard shall also be followed in this analysis. By the definition of white noise, this deviation is to be applied as a plus or minus perturbation on the nominal signal and therefore has a mean of zero. As Figure 3.1 illustrates, the probability that the noise will result in an error that is within some bound X is equal to the area under the normal distribution curve with limits Â± X, therefore there is a ~100% chance the error falls within 3 and a 68.27% chance the error will be no more than .

Figure 3.1: Normally Distributed Probability of Error It is of interest to know the maximum error the trajectory that a satellite will undergo when the sensor outputs are subjected to a variation of noise levels. The affected sensors will be that for measuring position and velocity, as those are required in determining the required control force for corrective action. The resultant position error maintained by the satellite's trajectory in the steady state is termed the "error box". As a general means for establishing robustness, taking into account various types of possible faults a sensor or sensing system may experience (such as outlier data, temporary failure, miscalibration, external interference, degradation, etc.), a noise is introduced into the system. In addition to sensor noise, two fault cases will be simulated that cover worst-case scenarios. The first is where the position and velocity sensors have gone offline over 50% of the course of an orbit. During this time, the controller sees zero position and 30

velocity error, and state errors are frozen to show the continued motion along the desired elliptical trajectory. Finally, random oscillation is introduced about the nominal value of thrust calculated by the control laws, to simulate thruster combustion instability. The amplitude of this oscillation is random but limited to 1 mN, and has a frequency that is also random but limited to 3373 cycles per orbit as a conservative degree of disturbance. Thrust degradation is important to include in simulations whenever thrust output changes, because propellants are used inefficiently during transient operation below full design pressure in the combustion chamber, which also entails non-optimal expansion of the flow through the nozzle. This applies to cold gas, warm gas or hot gas thrusters. In the case of pulsed thrust, the specific impulse decreases as the pulse duration becomes short, which is the case for on-off control, such as bang-bang sliding mode, as convergence to the reference trajectory is approached. The magnitude of total impulse delivered in a short-pulse duty cycle degrades over time as well [46].
3.2.1 Linear Quadratic Regulator

3.2.1.1 Mathematical Background

A cost function, J, is defined as a combination of the state and control vectors whereby their relative importance can be factored in by weighting matrices that also serve to resize the vectors for matrix summation. These (diagonal) matrices can be denoted by Q and R, where Q affects the state error, and R affects the control effort in the response. Varying the elements of these matrices provides a means of controller tuning for acceptable settling time and overshoot. Such tuning can be applied to all or some states, or control inputs individually. This means that the control gain, K, will be a function of Q, R and of course the system dynamics, whose effects can be grouped into the matrix M:

Â·

(3.1)

31

Thus, the cost function is minimized when the matrix M is minimized. Tewari [5] shows how the matrix M is related to the state transition matrix and control gain of the system, and is the solution of the following matrix differential equation, which is popularly known as the State-Dependent Riccati equation.

(3.2)

Minimization of Eq. (3.2) involves setting the right-hand side to zero, since the above form of the Riccati equation is of first order and separable. The optimal feedback gain is then found by substituting the matrix M into a relation by which it was defined:
(3.3)

This approach is called a `linear quadratic regulator' since Eq. (3.3) is in a matrix quadratic form. Since this is a linear gain, the control input in this negative feedback system is directly proportional to the state error, , via the gain:

(3.4)

Even for a controllable system, there does exist a range of values that the elements of the Q and R matrices can have that will lead to unstable closed loop system eigenvalues. These can serve to provide bounds for tuning. The B matrix for the configuration of thrusters considered in this chapter implies an instantaneous application of the specific force from Eq.(3.4). The full equations of motion that represent the system are then given by

(3.5)

32

Following the choice of the weighting matrices to be Q=102ÃI6Ã6 and R=10-2ÃI33Ã3, respectively, the optimal gain given by the LQR controller is K=102ÃI3Ã3. This gain results in the placement of the eigenvalues on the complex plane as listed in Table 3.1.

Closed-Loop Eigenvalue 1, 2 3 4 5 6 -99.0167 Â± 2.0195i -0.9388 -1.0278 -1.0428 -98.9572

Table 3.1: Closed Loop Eigenvalues using LQR Controller All eigenvalues in Table 3.1 are on the left-hand side of the complex plane; therefore the system is stable. Eigenvalues 1 and 2 clearly correspond to the x and y states, since they are the only eigenvalues with an imaginary component implying oscillation. Eigenvalue 3 corresponds to the z state, while 4, 5 and 6 correspond to the x, y and z states, respectively. States with negative poles that are large in magnitude converge faster after a perturbation.

3.2.1.2 Simulation Results

A performance evaluation for the LQR controller subjected to varying degrees of sensor noise is presented in Figure 3.2. It shows the variation of resultant error box size of the satellite in the steady state as a function of the error the sensing system can provide for position; this is the lower dashed line in the figure. For several position sensor errors, various velocity sensor errors were also factored in up to 200 km/hr; that corresponds to the upper dashed line in the figure. The solid vertical lines throughout are the running lines marking where the simulations actually took place.

33

The effect of velocity sensor errors increases with position sensor errors until it overcomes in dominance beyond 6 km in position error, where the error box size more than doubles for a 200 km/hr velocity sensor error. The control force remains on the order of 1 N/kg. This may not be desirable for a miniature satellite where the desirable order of magnitude is 1 mN/kg. The performance of other controllers remains to be presented in comparison. Assuming a navigation system based on inertial measurement, as has

historically been done for Apollo and other far range missions, the velocity information is expected to be more accurate than the position information, as the value of the latter is derived from integration of the former. This is because the process of integration

amplifies error. Similar applied error values have also been used in [16].

One exercise in testing the performance of the controller is to evaluate system recovery after it has been subjected to disturbances. The concept of sensor and propulsion system actuator fault cases follows the examples set out in the literature that involve similar investigates [34,46]. However, faults (other than noise due to degradation) can also occur in sensors and become catastrophic to the system if not accounted for in the control system design. The first cases being examined are where the sensors for both position and velocity are disabled and assumed null values while 50% of the orbit elapses, returning to correct operation thereafter. This disturbance will be applied only along the x and y dimensions. The z dimension will remain unaffected. A successful controller would give such a response where: (a) The error does not grow too large. (b) The required control input does not grow too large. (c) The trajectory does not diverge from the reference. The first of these conditions can be evaluated by considering Figure 3.3, where it can be seen that the maximum error is about 3.2 meters and occurs in the x direction. Of course, there is no real threshold for what satisfies being not "too large". responses are to be compared with those generated by other controllers. 34 Therefore, the

35

Figure 3.2: Effect of Sensor Degradation on System Performance using LQR Controller

Figure 3.3: State Errors using LQR Controller subjected to Sensor Inoperative Condition

As expected, there is no disturbance seen in the z direction due to uncoupled dynamics made obvious from the systems equations of motion and the inherent stability of the z motion. The amplitude of oscillation in the z direction is exactly equal to the initial error applied, which has been enforced to zero following the perfect initial conditions. The variation of control input that was used in the trajectory recovery for this controller is shown in Fig. 3.4. The magnitude of the maximum required control acceleration is 0.3 N/kg. The reference trajectory is recovered within 2 orbits, with some negligible steady state error remaining in velocity along the y dimension. The final comprehensive fault case considered is that of unsteady thrust due to instabilities in the respective thruster's combustion. As explained in the introduction to this chapter, a random frequency oscillation of Â±1mN is applied. Again, the stable dynamics along the out-of-plane z dimension is uncoupled, but shown anyway. The error response is shown in Figure 3.5. The high frequency oscillation is due to the added disturbance.

36

Figure 3.4: Control Input using LQR Controller subjected to Sensor Inoperative Condition

Figure 3.5: State Errors using LQR Controller with Unsteady Thrust

37

In this case, the steady state error is bounded within 5 km for position and within 0.75 km/hr for velocity. The variation of the control input is shown in Figure 3.6, and shows it to be bounded within 7.5 N/kg.

Figure 3.6: Control Input using LQR Controller with Unsteady Thrust
3.2.2 Model Predictive Control

3.2.2.1 Mathematical Background

Before the mathematics of this control method is introduced, it is necessary to explain some basic terminology used for this controller. Immediately apparent is that the variable representing control inputs is referred to as "manipulated variables". In this report, the states are selected such that they are physically meaningful and directly relevant so that the "output" of the plant would synonymously refer to the states which are to follow the setpoints (reference trajectory) as input to the controller. The distinctiveness of this control method is that its optimization involves the calculation of M planned control moves, with the current sampling instant being k and the last control move planned to occur when the sampling instant will be k + M; thus, M is the "control horizon". 38

Simultaneously, the optimization also takes into account the predicted trajectory of P sampling instants into the future, until the sampling instant becomes k + P; thus, P is the "prediction horizon". A "sampling instant" corresponds to a "time step" in the calculation/simulation. Parameter "r" is the variable representing the setpoint, which can be time-varying, as in the case of the trajectory that is considered in this study. As already implied by using sampling instant rather than time, the first step is to convert the system model to digital state space form. Let Sy be the weighted sum of setpoint deviation within the prediction horizon that serves to increase control effort to force convergence:

(3.6)

Let Su be the weighted sum of the control variations within the control horizon that serves to track and ultimately suppress large values of u that could otherwise lead to degradation of setpoint tracking (towards instability) and larger than necessary control effort (towards larger overshoot, settling time and high sensitivity to disturbances):







1

(3.7)

For cases that require a setpoint on the control input (manipulated variable), Su must also be defined, which is the weighted sum within the control horizon that subjects importance upon the control to converge to reference values of manipulated variables:

1

(3.8)

39

This is necessary for most systems. For example, other than by using hard constraints, such setpoints on manipulated variables can be used to keep a system within safe operating limits or at a zero or minimum-power level in the case where there are more manipulated variables than output setpoints to prevent random fluctuations of control force within the operating space. Such cases correspond to over-actuated systems for which multiple solutions for counter-acting disturbances would exist. Also, some cases require a continuous control force, such as when a satellite is to be held at an orbit displaced above or below the orbital plane of the primaries in a three-body system using solar radiation pressure; the solar sail would have to be held at a non-zero nominal control angle. Regarding the limit of summation in the above equations, the scalar "n" refers to the number of elements of the vector presented on its subscript. As for the equations themselves, "w" is the (positive) weight corresponding to the importance of the deviation of the variable presented in its superscript. For example, the controller is more robust when wnu is larger and converges to the setpoint faster when wjy is larger. An efficient way to decide on such trade-offs is to set one of the weights to 0    1 and the other to 1 - . wju is treated as wjy (it penalizes the error in the control input rather than the setpoint) but does not have the same sort of tradeoff. A small weight means that the variation of the corresponding variable is not significant to the system's overall performance, and vice-versa. With the three cost functions defined in Eq. (3.6) to (3.8), the optimization becomes
 | ,...,

min

|

,



(3.9)

Eq. (3.8) is subjected to the following constraints:
| 


(3.10) 




| |

(3.11) (3.12)



|

0 , 0

,...,

1

(3.13) (3.14)

40

The first three conditions, Eq. (3.10) to (3.12), require the respective output and control input to remain within their bounds in the operating space. Vmin/max are (positive) weights on the importance of the constraint, such that a larger value softens the constraint and a value of zero corresponds to a hard constraint that is strictly not to be violated. All weights have a maximum value of one. Finally,  is a "slack variable" necessary for programming purposes to turn inequalities into equations of the same number as variables. It is evident from the formulation of this control method that if desired, it is very easy to install constraints on control effort, as well as on state variables/plant outputs. Adjusting settling time remains an exercise of tuning gains via the much simplified tuning of weights. Also, just as with the LQR control method which also applies to linearized systems, stability is guaranteed by executing the optimization of the cost function after checking the controllability matrix, and returning only stable closed loop system eigenvalues. Control input is determined from Eq. (3.4) the same way as it is for the LQR controller. Choosing null output weights and output weight [1,1,1,0,0,0], with a control horizon of 1 as is the only option when using an infinite prediction horizon, the gain matrix becomes 10 2.0006 0.0133 0 0.0133 0 1.9998 0 0 1.9997 0.0200 0.0001 0.0001 0.0200 0 0 0 0 0.0200

with closed loop system eigenvalues given in Table 3.2.
Closed-Loop Eigenvalue 1, 2 3, 4 5, 5 -100 Â± 0.9933i -100 Â± 1.0066i -100 Â± 1.0001i

Table 3.2: Closed Loop Eigenvalues using MPC Controller

41

All the poles have negative real parts, so the control system is expected to be stable. The relatively large magnitude and oscillatory components on all states suggest fast and underdamped convergence. The system is again represented by the full nonlinear equations of motion as given in Eq. (2.8).
3.2.2.2 Simulation Results

As with the previous controller, the following analysis simulates sensor degradation by adding the same Gaussian noise distribution in the feedback position and velocity data used by the controller. The magnitude of the stated error is  and the corresponding noise added to the data had zero mean and was within the standard deviation of 3. Fig. 3.7 shows the relationship between the error box size of the trajectory and maximum control input required for stability across the spectrum of sensor errors. The MPC controller far out-performs the LQR control in terms of the control input required in handling sensor errors. The MPC controller allows the spacecraft to drift 3 times farther from the reference trajectory, but has a control input on the order of 10 mN/kg, 100 times less than the LQR controller. Typically, as the prediction horizon is increased, one expects a better response. However, in the case of formation flying where the reference trajectory is changing at every time step, one cannot expect better performance when a larger prediction horizon implies the control requirement to be relaxed such that it is to converge to zero at some point in the future. This conclusion is also supported in literature [33]. The case is examined where the in-plane position and velocity sensors become stuck, or disabled, for 50% of an orbit. The error response is shown in Figure 3.8.

42

43

Figure 3.7: Effect of Sensor Degradation on System Performance using MPC Controller

Figure 3.8: State Errors using MPC Controller subjected to Sensor Inoperative Condition

All states are seen to converge back to the reference trajectory within 2% of an orbit. The recovery phase of the transient response in Figure 3.8 shows a vertical drop, especially along the x dimension. In fact, if one were to zoom in they would find that the recovery actually takes place over 0.014 orbits (~ of a km) and has an overshoot of 13.7 m. This is pretty reasonable for the recovery from a tracking error on the order of only 10 km. The variation in control input that yielded this response in Figure 3.9 is given next.

Therefore, in terms of maximum control acceleration required, this response is far superior to that of the LQR controller. Here, all controllers were initialized to give the same performance. However, the results are valid for only what was modeled, so an

adjustment of tuning parameters would be required in different environments, including physical deployment, to achieve comparable responses.

44

Figure 3.9: Control Input using MPC Controller subjected to Sensor Inoperative Condition

Figure 3.10 gives the error response for the MPC controller subjected to the same worstcase thruster instability. The position errors are less than 10 times smaller and the velocity errors are also smaller but with generally the same magnitude as compared with the performance resulting with the LQR controller. The significant difference is that the control force required to yield this response is on the order of 0.1 mN/kg as shown in Figure 3.11.

Overall, the MPC controller is more sensitive to degraded sensors, especially for velocity, but still yields better performance (compared with the LQR controller) in other areas of robustness, such as during sensor faults and under thruster instability.

45

Figure 3.10: State Errors using MPC Controller with Unsteady Thrust

Figure 3.11: Control Input using MPC Controller with Unsteady Thrust

46

3.2.3

Adaptive Control

This analysis would not truly be complete without including at least one nonlinear control approach in the system performance comparison. Of all such nonlinear control methods, it appears that the space industry is presently inclined to have greater trust in bang-bang control for applications such as station-keeping and attitude control [1]. However, more advanced versions of sliding mode control exist, and have been studied for many years. The reader will find that the adaptive controller designed and analyzed herein, based on Sliding Mode Control theory, has some beneficial characteristics to offer when applied to the system under consideration.

3.2.3.1 Algorithm Formulation

Consider a plant with equations of motion in the form below, with q representing the state vector and the subscript referring to the dimension being pertained to:

(3.15)

The general idea behind sliding mode control is to transform the nth order nonlinear system dynamics to an equivalent n-1 order problem of keeping the state trajectory on a surface in n-1 space. In this case for a 2nd order system, the problem is to keep the state trajectory on a line on the phase plane:

0

(3.16)

One can define the sliding plane as a differential function of the tracking error, e, of the state:

47

(3.17)

The sliding mode control law can then be written in the following form:

(3.18)

Selecting the nominal control gain, ko, to be zero is also valid. Note that when expanded and after the substitution of Eq. (3.4) into Eq. (3.6),  is effectively equivalent to Â­ktP1 and thus satisfies the stability condition of Eq. (3.3), as long as both kt and P1 are positive.

An adaptation law for the adaptive control gain, kt, is to be created; it is chosen to be of the form (3.19) where 1 (3.20)

|| || denotes the vector norm and

is the adaptive parameter being used as a weight that

governs the application of necessary penalization of tracking error with respect to the distance of the state on the sliding plane from the stable origin. Thus, is appropriately

chosen as a term representing the magnitude of the total tracking error with the property of being greater than or equal to unity as to not vanish the adaptive parameter, while  is simply another tuning parameter:

1

(3.21)

It follows that the adaptation law is

48

(3.22)

This must be integrated in the simulation, for it to be applied to the control law, being fed back to the controller.

Sufficient values for the tuning parameters have been chosen to be P1 = 2, P2 = 100,  = 0.01 and ko = 2. P1 largely controls the settling time, ko can be used to roughly set the order of magnitude of the control input appropriately, P2 can be used to roughly set the sensitivity and magnitude of variation of the adaptive parameter, and  roughly sets the allowable threshold sensitivity of deviation after convergence from the origin of the phase plane. Suitable values can be carefully selected based on desired response, but are usually found easily and quickly by trial and error.   Eq. (3.19) is actually an approximation of the sgn function, which justifies using the term "sliding mode". Most nonlinear control law's share a basic characteristic in that they are merely derived from a Lyapunov function that is made to contain all the nonlinear terms of the dynamical model. The adaptation law is then formulated such that the stability conditions imposed on the Lyapunov function are ensured to be satisfied upon substitution.

The resulting control law, when substituted in the equations of motion, cancels out all nonlinearities and incorporates the gain derived by linear control methods. These gains are of course modified by the nonlinear terms already in the control law, but the task has been greatly simplified. In the case presented herein, the gain itself was made to be the parameter, eliminating even the need for using linear controllers. This approached was derived using the controller design philosophy presented in [21].

49

3.2.3.2 Stability Analysis

The stability of this approach has will be demonstrated by ensuring the tuning parameters are selected to conform to the conditions that guarantee the validity of Eq. (3.23). Proof of the stability of the nonlinear control system while being subjected to the adaptation law given in Eq. (3.22) can best be demonstrated using the Lyapunov Stability Theorem.

Let

be the approximated value of

as output by the adaptive controller. The candidate

Lyapunov function below had been found to fulfill these criteria: 1 2 1 2

(3.23)

Eq. (3.23) is positive definite as long as P2 > 0, thus the first condition of the stability requirement is satisfied. Now, note that the sliding plane, S, is a function of tracking error of the state which is zero when the system is in equilibrium, the case in which the adaptive parameter would also converge to zero, making Eq. (3.17) equal to zero when the error is zero. Since the controllers are designed based on the error dynamics equation of motion, the effective state is actually its own differential, and the second stability condition is satisfied. Finally, proving the third stability condition exists will also serve to validate Eq. (3.22) as an appropriate adaptation law. One can begin by differentiating Eq. (3.23) with respect to time: 1

(3.24)

Expanding and differentiating Eq. (3.17) with respect to time, the result is

(3.25)

50

Let

; substitution of Eq. (3.22) and (3.25) into Eq. (3.24) yields (3.26)

Substituting c into Eq. (3.26), noting that simplification yields

/

and expanding, further

(3.27)

Thus, the inequality of Eq. (3.28) is a true statement (3.28)

Integration of Eq. (3.28) from

0 to

 yields 0 

(3.23)

V(t) is a non-increasing function of time and is low-bounded. Therefore 0 and . The boundedness of S implied that .

0

 and

is also true since

are also bounded. The relation lim negative definite as long at > 0,

0 indicates that and

converge to zero

asymptotically according to Barbalat's lemma. It is also easy to see that Eq. (3.26) is >0 and P2 > 0. Thus, this adaptive controller and its associated adaptation law Eq. (3.22) has been proven to be stable. The system is again represented by the full nonlinear equations of motion as given in Eq. (2.8).

51

3.2.3.3 Simulation Results

The same sort of analysis is done at this stage as done earlier, wherein sensor degradation is simulated by means of adding the same Gaussian noise distribution in the feedback position and velocity data used by the controller. Again, if the error has a specific magnitude, , then the corresponding noise added to the data has a zero mean, and is within the standard deviation of 3.

Upon simulation, right away it is noticed that the growth of the error box size with sensor errors is similar to that of the LQR controller. The difference in performance is that the adaptive controller is less sensitive to velocity sensor noise. The right-handed scale in Figure 3.12 presenting the required control force shows that the order of magnitude is of 1 mN/kg, 1000 times less than that of the LQR controller and 10 times less than the MPC controller. Therefore, this is ultimately the best type of controller to use if sensor noise is expected. For improved understanding of the controller behavior and for better comparison, the other disturbance cases are now examined. Firstly, the sensor is disabled over 50% of the orbit. The error response is shown in Figure 3.13. All states converged back to the reference trajectory within 1 orbit after the maximum tracking error approaching 10 km. Motion in the z dimension is not affected, since the motion along the x dimension is not coupled with it as it is with motion along the y dimension. This is to be expected as evident through the equations of motion, Eq. (2.8). In terms of fuel cost, the more important performance indicator would have to be the control input response (as well as the settling time, but that is not an issue here, as all controllers perform similarly in that regard), presented in Figure 3.14.

52

53

Figure 3.12: Effect of Sensor Degradation on System Performance using Adaptive Controller

Figure 3.13: State Errors using Adaptive Controller subjected to Sensor Inoperative Condition

The large errors establish that the adaptive controller happens to apply much more aggressive corrective action than the other controllers. However, the impulsively applied control force, which is on the order of 10 mN/kg, compensates for that, although it is 10 times larger than that of the MPC controller. Ultimately, the acceptability of this sort of response lies solely with mission objectives or expectancy of such a sensor faults occurring. Figure 3.15 shows the error response for the final type of fault being considered in this study, that of thruster instability. The velocity error is bounded within 0.25 km/hr, which is a much tighter band than that of the MPC controller. The position error has a comparable bound to the MPC controller as well. The corresponding control variation in Figure 3.16 also displays a comparable distribution of applied control force with respect to the MPC controller.

54

Figure 3.14: Control Input using Adaptive Controller subjected to Sensor Inoperative Condition

Figure 3.15: State Errors using Adaptive Controller with Unsteady Thrust

55

Figure 3.16: Control Input using Adaptive Controller with Unsteady Thrust It is hard to select the best performing controller between the adaptive and MPC approaches. Industry tends to trust model-based control more, and the robustness and flexibility of adaptive control cannot be matched, even if the controllers are re-tuned to produce a more favorable outcome for a specific case. None the less, it has been established that the two emerging controllers, MPC and adaptive, are definitely more robust than the traditional LQR controller. 3.3 Hardware-in-the-Loop Simulation
 

In this section, the control methods are validated in a laboratory environment for space flight. LQR, being a common control method in use is very well understood; MPC has been simulated, or used in Earth-orbit [16], and is mature in the process industry for robotic applications, with the expectation here that it would be an effective means for translational control in a simplified space environment; and a type of adaptive controller, all arrear in this study. An adaptive controller of the same family has so far only been tested in the laboratory on a satellite reaction wheel and never for translational control.

56

3.3.1

General Description

The HIL simulation was taken place at the Ryerson University's Space Systems Dynamics & Controls (SSDC) Group facility called the Satellite Avionics Instrumentation Laboratory (SAIL) on a specially designed testbed referred to as the Space System Testing Platform. The system was a part of the Satellite Airbed Formation Experiment (SAFE) which is a proprietary robot that is suspended off the glass airbed using air pressure, and utilizes fans as thrusters. The levitation minimizes friction to simulate the free-drift of the space environment, but restricted to 2 dimensions and 3 degrees of freedom. This serves as an analogy to the in-plane dynamics in a space system application, relating to say station-keeping a leader spacecraft at a Lagrangian point. For the purposes of this study, the goal was to travel from the edge of the airbed to its center within a 10 cm-by-10 cm box. A photograph of this system is presented in Figure 3.17 for better understanding.

+X +Y

Figure 3.17: Satellite Airbed Formation Experiment

57

This system makes use of a vision system to track its location on the airbed. Three LEDs are situated on the top of the unit, identifying the axis of the body frame so that its orientation can also be determined. The camera is mounted on the ceiling of the

laboratory overlooking the airbed. A 10 Hz radio is used for communication between the SAFE unit and the computer where the controller is running in a Simulink model. The SAFE system was developed over many years, and is currently used as a testing platform for new controllers and algorithms. Since two of the control methods are model-based, the equations of motion presented in state-space form are

(3.24)

Parameter m is the mass of the SAFE unit. Parameter

is the angular velocity induced

by the thrusters in the case of thruster misalignment relative to the center of mass, and is assumed to be zero; otherwise it is a function of thrust, where the thruster location is with respect to the center of mass. Control forces in this system can only be on or off, therefore the continuous control variation output by the controller will be used with a 0.1 threshold as it is applied. Simulations and test data are now presented for each of the controllers.

3.3.2

SAFE System Using LQR Controller

For what was thought to be the behavior of the SAFE system in simulation, Figures 3.18 and 3.19 show the error and control response, respectively. For the actual test data of the SAFE system, Figures 3.20 and 3.21 show the error and control response, respectively.

58

Figure 3.18: Error Response of Numerical Simulation of SAFE using LQR Controller

Y Error [m] 

X Error [m] 

Figure 3.19: Control Input Response of Numerical Simulation of SAFE using LQR Controller

59

Y Error [m] 

X Error [m] 

Figure 3.20: Error Response of HIL Simulation of SAFE using LQR Controller

Figure 3.21: Control Input Response of HIL Simulation of SAFE using LQR Controller

60

Obviously, the performance in reality is quite different. However, simulation is still the first step and provides important information as not only an approximation of realistic behavior, but also the controllability of the system itself. Controllability in the textbook sense is based only on the state-space matrices, and does not account for the stability of the system under disturbances.
3.3.3 SAFE System Using MPC Controller

Figures 3.22 and 3.23 give the error and control response in simulation, this time for when MPC control is used. The MPC controller tended to regulate the velocity more vigorously which resulted in a slow and more direct convergence. It took just under half the settling time for convergence as compared to the LQR controller because the LQR controller spent a lot of time in overshoot condition. However, the vigorousness of the MPC controller caused it to be inefficient in terms of actuation usage.

Figure 3.22: Error Response of Numerical Simulation of SAFE using MPC Controller

Y Error [m] 

X Error [m] 

61

Figure 3.23: Control Input Response of Numerical Simulation of SAFE using MPC Controller Now, Figures 3.24 and 3.25 give the true response from test data.

Y Error [m] 

X Error [m] 

Figure 3.24: Error Response of HIL Simulation of SAFE using MPC Controller

62

Figure 3.25: Control Input Response of HIL Simulation of SAFE using MPC Controller
3.3.4 SAFE System Using Adaptive Controller

Y Error [m] 

X Error [m] 

Figure 3.26: Error Response of Numerical Simulation of SAFE using Adaptive Controller

63

Figures 3.26 and 3.27 give the error and control response in simulation, this time for when adaptive control is used.

Using this controller, settling time was in the vicinity of half of a minute. Only one overshoot exists in the response unlike with LQR control where the system was much more underdamped. The simulation results showed almost identical response in the trajectory but differed significantly in the control response. Ultimately, test results were different as compared to simulation results largely due to the much increased damping in the test case; however, the LQR controller gave a slightly higher settling time in test than in experiment.

Figure 3.27: Control Input Response of Numerical Simulation of SAFE using Adaptive Controller Figures 3.28 and 3.29 give the true response from test data.

64

Figure 3.28: Error Response of HIL Simulation of SAFE using Adaptive Controller

Y Error [m] 

X Error [m] 

Figure 3.29: Control Input Response of HIL Simulation of SAFE using Adaptive Controller

65

3.4

Summary

In the case of thruster instability, the adaptive controller performs only slightly better than the MPC controller. Overall, the LQR controller generally performs the worst in terms of both control input and errors. The adaptive controller tends to allow for higher error tolerance but still yields similar control requirements than the MPC controller, being slightly better for some faults and slightly worse for others. Adaptive control was the most efficient controller demonstrated in terms of both propulsion system actuator usage and convergence in the HIL simulations, where the performance indicator was primarily taken to be settling time.

66

CHAPTER 4

Performance Analysis with State Estimation

4.1

Introduction

As was done in the previous chapter, the performance of various controllers will be compared while subjected to simulated sensor noise and sensor/actuator faults. The difference between the two chapters is that state estimation is to be used here. The performance of all controllers in all cases is shown to be significantly improved.

It is expected that for all real systems the sensed value of state or output information involves errors. These errors may originate from modeling uncertainties or external disturbances, called process noise, or from the inherent imprecision of observation, called measurement noise. A position or velocity sensor will always have a certain finite degree of accuracy, which can degrade over time as the mechanical structure of the sensor configuration approaches its design life for the given environment. In the case of a sensing system based on inertial navigation, as was the case for the Apollo missions, errors will exist which will be amplified in the integration process to derive position and velocity information. Therefore it is important to evaluate not just the performance of the controller, as is done in most studies [9-15, 21, 23, 24, 28], but the combination of controller and observer. This evaluation approach can prove to result in very different outcomes.

67

4.2

Observer Design

Since it is of greater interest in this study to test the performance of the considered control methods rather than observation methods, the same observation method was applied to all cases. This also ensures common and equal modification for all control methods, so that the results may remain comparable. The state estimation was done using an approach called "linear quadratic estimation" (LQE). This is based on the Kalman filter, wherein the gain matrix of the Luenberger Observer equation, Eq. (5.1), is optimally determined through the minimization of the covariance of the estimation error:
(5.1)

Let the dynamics of the system involve process noise (vector v, coupled by matrix F) in the equations of motion and uncorrelated measurement noise (vector z) in the output equation by superposition, as shown in Eq. (5.2):
(5.2a,b)

By a procedure detailed in [5], it can be shown that the correlation matrix of white noise is related to the observer gain matrix given in Eq. (5.3):
(5.3)

V and Z are the spectral density matrices of the process and measurement noise signals, respectively. The optimal Kalman filter gain is calculated by determining the covariance matrix of the estimation error that satisfies the matrix Riccati equation, Eq. (5.4):
(5.4)

The solution for Ropt is found numerically. Finally, paralleling the procedure of finding the optimal LQR controller gain, the LQE gain is determined, Eq. (5.5):
(5.5)

68

Evidently, all the vectors/matrices may be time-varying when necessary. The spectral density matrices may be used as tuning parameters. To keep the results of all controllers comparable, tuning was kept constant with V = 10ÃI3Ã3 and Z = 0.1ÃI6Ã6. Thus, the observer gain was 0.8688 0.0595 0.0595 0.9495 0 0 1.4274 0.0846 0.2430 0.7039 0 0 4.3 Simulation Results 0 0 0.9312 0 0 0.6355 1.4274 0.2430 0 0.0846 0.7039 0 0 0 0.6355 10.8754 0.1804 0 0.1804 9.8514 0 0 0 9.7745

The same 3 convention was used in the application of simulated sensor noise. When a standard deviation of  is stated, errors within a 3 normal distribution are actually simulated. This is a standard practice in the aerospace industry [16, 22]. Figures 4.1-4.3 show the performance of the controllers, respectively, in conjunction with state estimation using LQE. Figure 4.1 shows the effect of sensor degradation on system performance using the LQR controller with LQE state estimation. The LQR controller with LQE, commonly referred to as "Linear Quadratic Gaussian" (LQG) shows an improvement of several orders of magnitude in the reduction of the error box size as compared with LQR alone. When the controller is applied alone, it is only possible for the error box to be somewhat smaller than the position sensor error applied due to the time taken for the controller to attempt correction before a different random error is sensed, creating an absorbing affect. Further, the error box size is proportional to the velocity sensor error applied. In the case with estimation, especially involving a noise with zero means as it appropriately exists, the controller acts on an error that is closer to the true state value and not just from defective sensing. The MPC controller with LQE shows a phenomenal improvement with an error box size reduced by three orders of magnitude as compared with MPC alone. Figure 4.2 shows the effect of sensor degradation on system performance using the MPC controller with LQE state estimation. Figure 4.3 then shows the effect of sensor degradation on system performance using the adaptive controller with LQE state estimation. 69

70

Figure 4.1: Effect of Sensor Degradation on System Performance using LQR Controller with State Estimation

71

Figure 4.2: Effect of Sensor Degradation on System Performance using MPC Controller with State Estimation

72

Figure 4.3: Effect of Sensor Degradation on System Performance using Adaptive Controller with State Estimation

The adaptive controller with LQE similarly shows an improvement of three orders of magnitude in the error box size as compared with adaptive control alone. The LQR controller with LQE is superior in terms of maintaining the smallest error box size. Besides being the components of the LQG controller, it has been shown that the LQE observer is suitable also for the other control methods as well, giving excellent results. This is due to the separation principle of control theory which states that controllers and observers may be designed and tuned independently before operating jointly. The tracking errors allowed by all controllers are so small that the control force needed throughout all simulated operating points with sensor errors was still within 10-7 N/kg, a value that would fall under any control threshold and thus be ignored. No tuning gains or parameters were changed. Therefore, all real systems which are subjected to noise require state estimation for optimal robustness. The application control methods alone are not sufficient. The fault cases are then re-simulated using LQE. Plots representing error and control force variations follow for each controller. First, the "sensor inoperative" cases are presented. However, due to the very different characteristics of the controller-observer combinations, this fault case is somewhat modified. Instead of giving a position reading of zero error over 50% of an orbit, the sensor reading will simply freeze instead over the course of one whole orbit, effectively letting the spacecraft drift away freely. When applied to the controller alone, unacceptable results follow in terms of the ratio of tracking errors to Earth-Moon separation distance. The controllers still however guarantee a bounded input resulting in a bounded output (BIBO). All dimensions are affected, but as before only the in-plane results are meaningful since the out-of-plane dynamics are inherently stable. For the LQR controller subjected to an offline sensor case, Figures 4.4 and 4.5 show the error and control input response, respectively. Figures 4.6 and 4.7 show the same for the MPC controller, and Figures 4.8 and 4.9 for the adaptive controller's error and control input response, respectively.

73

Figure 4.4: State Errors using LQR Controller with State Estimation subjected to Sensor Inoperative Condition

Figure 4.5: Control Input using LQR Controller with State Estimation subjected to Sensor Inoperative Condition LQG shows a similar settling time of less than 2Â½ orbits with a maximum required control input of 50 mN/kg. Even when compared to the less vigorous sensor fault in the previous chapter, this combination far out-performs. 74

Figure 4.6: State Errors using MPC Controller with State Estimation subjected to Sensor Inoperative Condition

Figure 4.7: Control Input using MPC Controller with State Estimation subjected to Sensor Inoperative Condition

75

A similar improvement in control effort was also seen in the MPC controller with LQE.

Figure 4.8: State Errors using Adaptive Controller with State Estimation subjected to Sensor Inoperative Condition

Figure 4.9: Control Input using Adaptive Controller with State Estimation subjected to Sensor Inoperative Condition

76

An improvement was observed in the Adaptive controller with LQE where approximately the same magnitude of control force was required to correct the state error incurred during the free drifting of the satellite. The settling time still remains under two orbits. With these results, it can be concluded that the MPC+LQE combination is the best of the three, ahead of the Adaptive controller with LQE by not very much at all. Comparison is judged solely on magnitude and duration of control effort and transient recovery in the error response. In terms of best performing controllers, the same conclusion follows from the previous chapter without state estimation in the control scheme. Finally, the unsteady thrust fault case is presented. This is a test of control system robustness in dealing with random disturbances on the actuator segment rather than the sensor segment of the system. For the LQR controller subjected to unsteady thrust, Figures 4.10 and 4.11 show the error and control input response, respectively; Figures 4.12 and 4.13 show the same for the MPC controller and Figures 4.14 and 4.15 for the Adaptive controller's error and control input response, respectively.

Figure 4.10: State Errors using LQR Controller with State Estimation subjected to Unsteady Thrust

77

Figure 4.11: Control Input using LQR Controller with State Estimation subjected to Unsteady Thrust For the LQG case, maximum error reduced by three orders of magnitude and control acceleration remains within of 10 mN/kg.

Figure 4.12: Error Variation using MPC & State Estimation with Unsteady Thrust

78

Figure 4.13: Control Input using MPC & State Estimation with Unsteady Thrust For the MPC controller with LQE case, excluding the initial overshoot which seems to be a characteristic common to the results of all controllers even though there is no initial confirmed by zooming in on the plots on screen, velocity errors are reduced by 40%. Errors along the y axis are noticeably reduced as well. Control acceleration is bounded by Â±1mN, matching the maximum magnitude of disturbance.

There was no major improvement in the performance if the Adaptive controller with LQE system in terms of control input. The actual control acceleration applied is indeed greater than 1mN/kg, but the plots shown are the calculated control inputs by the controller which is independent of the fluctuations. That is why it is possible for control

acceleration to be less than the applied disturbance. Position errors show at least a 10 fold improvement whereas velocity errors do not show any significant improvement. Dealing with unsteady thrust, LQG yields the better outcome for this one fault case. The Adaptive controller with LQE was not far behind.

79

Figure 4.14: Error Variation using Adaptive Controller & State Estimation with Unsteady Thrust

Figure 4.15: Control Input using Adaptive Controller & State Estimation with Unsteady Thrust

80

4.4

Summary

This chapter involved noise in both the state as sensing noise and control input in terms of unsteady thrust, each with their own appropriate definitions. The LQE observer was designed to produce a better state estimation whereupon the controller would act rather than direct corrupted state measurement. The same fault cases were simulated as in the previous chapter where the spacecraft drifted up to some common tracking error before each of the controllers were allowed to realize the error buildup and commence corrective action, while being subjected to noise. The conclusion of best performing controllers did not change with adaptive and MPC controllers demonstrating the greatest robustness. However, in the case of unsteady thrust where a 1mN oscillation of thrust was applied with random frequency, simulating turbulence in combustion, the LQG combination outperformed. These results are valid for the conditions in which the control system was simulated.

81

82

CHAPTER 5

Formation Control Using Thrust Vectoring

5.1

Introduction

Many satellites, such as Earth observation satellites, utilize a single primary thruster and rely on an attitude control system to redirect the line of thrust when needed. With thrust vectoring, the line of thrust can be modified by rotating the thruster nozzle or reconfiguration of its geometry. Currently, many rockets, fighter aircraft and missiles make use of this method as it provides the advantage of using a single engine to gain the maneuverability usually acquired by multiple engines. Attitude dynamics also become coupled with translational dynamics when the line of thrust does not pass through the center of mass of the vehicle. In this chapter, it is assumed that the line of thrust is always coincident with the satellite center of mass (or that attitude control is taken care of separately) and that the control angles are given relative to the L2-centered coordinate frame. Figure 5.1 illustrates the concept of thrust vectoring for better understanding.

Figure 5.1: Illustration of Vectored Thrust 83

5.2

System Model and Controller Design

Using the convention shown in Figure 5.2, the effective line of thrust or direction the nozzle is pointing is defined by the angles and . Angle is the in-plane angle is the out-of-

between the x axis and the projected thrust vector on the x,y plane, while

plane angle between that projected thrust vector to the real three dimensional thrust vector.

Figure 5.2: Angle Convention Used for Thrust Vectoring

The Bu matrix on the right hand side of Eq. (2.11) then becomes Eq. (5.1).

(5.1)

This form is correct, but the limitation of non-affine control inputs. The thrust, T, is affine as it can be separated into the control input vector, u. However, the two angles are arguments of trigonometric functions and thus cannot be separated. This approach is an 84

alternative to linearization which will be used in the next chapter. Fortunately, the same type of problem was tackled in [20] while attempting to make equations of a satellite in the Sun-Earth system using solar radiation pressure to become affine. The procedure involves the controller utilizing a dynamics model representation based on the third timederivative of the system. Then, the rate of change of the thrust magnitude and of the two control angles then become the new effective control inputs for the controller. Referring to Eq. (5.2), the control inputs are then integrated and fed back to the nonlinear system, Eq. (5.3), for simulation of the motion.

1 0 0

2

0 1 0

0 0

0 2 0

2 0 0

0 0 0

(5.2)

0

Eq. (5.2) is used for designing controllers that are based on linear system models. The nonlinear plant is them represented as

(5.3)

85

The "State Dependent Riccati Equation" (SDRE) method is a time-varying system model being used as a candidate controller. In the derivation of this controller, the B and K matrices in Eq. (3.2) to (3.4) become time-varying. The "Linear Time Varying Model Predictive Control" (LTV-MPC) method is also used. It is unconstrained to the control input and works better with a slightly larger (finite) prediction horizon. The adaptive controller is now based on a tracking error which includes error in acceleration. The control law for the SDRE and LTV-MPC controllers is given in Eq. (5.4a) and in Eq. (5.4b) for the adaptive controller. As one would intuitively attempt to apply direct control on the affine thrust, a Dual SDRE controller (two controllers running in parallel) was first simulated out of interest using the model corresponding to Eq. (5.1) to control thrust magnitude only, and a reduced form of Eq. (5.2) to control angles only. The former was the primary and the latter was the secondary used only to provide appropriate control angles.

(5.4a)

(5.4b)

5.3

Simulation Results

Eq. (5.1) shows that the magnitude of thrust as a control variable is an affine parameter in the equations of motion and can therefore be controlled directly. Using a secondary controller based on Eq. (5.2) and controlling the thrust magnitude directly proves to result in unacceptable performance, as shown in Figures 5.3 and 5.4 with the error and control input responses, respectively, when the Dual SDRE controller is used.

86

Figure 5.3: State Errors using Dual SDRE Controllers for Thrust Vectoring based Control Convergence to the reference trajectory is achieved within 3 orbits to the best degree possible with a maximum thrust requirement of 20 mN/kg. The main problem with this approach was the steady state error being around 250 m along the x direction while undamped along the other dimensions. The single controller is considered in contrast; error and control responses are shown in Figure 5.5 and Figure 5.6, respectively.

The settling time in this case remained constant; convergence to the reference trajectory was also achieved within 3 orbits. However, the magnitude of control acceleration required was 1 mN/kg in the steady state and just under 7 mN/kg in the overshoot. Therefore, it is more efficient to use the single controller over the duel controllers where the interaction affect always prolonged convergence. Overall, this is not desirable

performance due to the magnitude of steady state errors. Model predictive control is considered next; responses are shown in Figure 5.7 and Figure 5.8, respectively.

87

Figure 5.4: Control Input Using Dual-SDRE Controllers for Thrust Vectoring Based Control

Figure 5.5: State Errors using Single SDRE Controller for Thrust Vectoring Based Control

88

Figure 5.6: Control Input Using Single SDRE Controller for Thrust Vectoring Based Control

The response shown in Figure 5.8 is better compared to the Duel SDRE controllers where the maximum control input is 3.3 mN/kg for the Duel LTV-MPC controller. The error response in Figure 5.7 shows a 400 m steady state along the x axis, 600 m along the z axis and an even less improvement along the y axis with no overshoot. So what is "better" depends on the mission requirements; however, this controller is also inferior compared to the single LTV-MPC controller and has only been shown to for demonstration only. Error and control input responses for the single LTV-MPC

controller are shown in Figure 5.9 and Figure 5.10, respectively.

89

Figure 5.7: State Errors using Dual LTV-MPC Controllers for Thrust Vectoring Based Control

Figure 5.8: Control Input using Dual LTV-MPC Controllers for Thrust Vectoring Based Control

90

Figure 5.9: State Errors using Single LTV-MPC Controller for Thrust Vectoring Based Control

Figure 5.10: Control Input using Single LTV-MPC Controller for Thrust Vectoring Based Control

91

In Figure 5.9, convergence is achieved by 1 orbit for in-plane motion and by 3 orbits for out-of-plane motion. Thrust settles to the order of 1 mN/kg which may fall within the deadzone of a typical actuator. Angle variation is large, but becomes irreverent as thrust approaches zero.

Finally, the adaptive controller is considered. Since it is not based on any model, rather directly on a Lyapunov function whose combination of coefficients (within their respective valid ranges are effectively used as tuning parameters; see discussion in Section 3.2.3.2 on stability of Adaptive controller design), the affinity of the equations of motion is irrelevant. responses, respectively. Figures 5.11 and 5.12 illustrate the error and control input

Figure 5.11: State Errors using Adaptive Controller for Thrust Vectoring Based Control

92

Figure 5.12: Control Input using Adaptive Controller for Thrust Vectoring Based Control Errors converge to a steady state error of less than 10 m within 10 orbits in-plane. Outof-plane convergence is achieved by 100 orbits. Thrust settles to less than 1 mN/kg which is a profound result, especially when even the maximum specific control acceleration in overshoot is 0.75 mN/kg. Control angle variation also remains well within reasonable bounds in the transient phase of the response, for the conditions simulated. A methodological tuning method would definitely have the potential to further improve this result. This may be desirable for out-of-plane motion where the settling time may not be reasonable for most mission applications. The reason for otherwise superior performance in-plane is due to the adaptive nature of the controller where it would innately compensate for unmodeled dynamics which are lost in the linearized models upon which the SDRE and LTV-MPC methods are based. Given how out-of-plane dynamics are completely uncoupled even in the nonlinear model of the plant, it should be possible to use a hybrid controller where in-plane dynamics are stabilized via the adaptive controller and the out-of-plane dynamics stabilized via the faster LTV-MPC only along this direction. This could be a more robust approach.

93

Finally, the sensor inoperative fault case is simulated for thrust vectoring based control using the adaptive controller. The results are shown in Figures 5.13 and 5.14.

Figure 5.13: State Errors using Adaptive Controller for Thrust Vectoring Based Control subjected to Sensor Inoperative Condition

Figure 5.14: Control Input using Adaptive Controller for Thrust Vectoring Based Control subjected to Sensor Inoperative Condition

94

As a summary, Figures 5.15-5.19 shows the resultant trajectory followed by all the controllers.

Initial state error is 1 km along each axis.

Figure 5.15: Trajectory using Dual SDRE Controller for Thrust Vectoring Based Control

Initial state error is 1 km along each axis.

Figure 5.16: Trajectory using Dual LTV-MPC for Thrust Vectoring Based Control

95

Initial state error is 1 km along each axis.

Figure 5.17: Trajectory using SDRE Controller for Thrust Vectoring Based Control

Initial state error is 1 km along each axis.

Figure 5.18: Trajectory using LTV-MPC for Thrust Vectoring Based Control

96

Initial state error is 1 km along each axis.

Figure 5.19: Trajectory using Adaptive Controller for Thrust Vectoring Based Control

5.4

Summary

For systems where there are non-affine control inputs, the utilization of controllers in parallel was shown to be non-optimal when the control inputs are coupled. The fact that the control angles in Figures 5.5 and 5.7 remain under 20Â° indicates that linearization may be a feasible alternative to taking the triple time derivative to make the control input variables affine as the small angle approximation would hold. This will be done in the upcoming SRP chapter. For controllers with large control angle requirements seen in some of the responses, linearization would violate small angle approximation; vigorous tuning would be required and would not be practical. Only the adaptive controller converged properly (somewhat the LTV-MPC as well) and can therefore be considered as the only successful (again, other than perhaps the LTV-MPC) one for the case of thrust vectoring. The dual controllers did not converge satisfactorily at all. From the similarity to a Lissajous trajectory, it is clearly shown that the Lyapunov trajectory is a subset of the Lissajous trajectory. 97

98

CHAPTER 6

Formation Control Using Solar Sail Propulsion

6.1

Introduction

Control using solar radiation pressure (SRP) has the main advantage of requiring zero fuel. The life of the satellite then becomes solely a function of the mechanical life of its components. This makes SRP control highly worth investigating. The aim of this chapter is to demonstrate, by simulation, the feasibility of SRP based control for the considered system and to compare the performance of the various considered controllers. Figure 6.1 illustrates a solar sail on a satellite for better understanding for the reader.

Figure 6.1: Illustration of Solar Sail on Spacecraft 99

6.2

System Model and Controller Design

Solar Radiation Pressure is a linear combination of three components of force:

(6.1)

Each force component can be defined with reference to the variables shown in Figure 6.2 where L is the unit vector defining the direction of the Sun-line and N is the sail normal.



Specular: 

  2 Â· (6.2a)



Diffuse:  

  Â· 2 3 (6.2b)

   Absorption:    Â· (6.2c)

where

is the efficiency coefficient,

,

,

1,0,0

(  = 1, by conservation

of energy principle), P is the mean momentum flux near the Lagrangian points ( 4.5 10 N/m ) and is the illuminated surface area.

Since their efficiencies are negligible, diffuse and absorption are negligible. Also, as specular efficiency is taken to be 100%, a perfectly reflective surface is being assumed.

100

Figure 6.2: Free Body Diagram of Sail Given that the mass of the primaries remains constant, the only force acting on the sail is that of photonic bombardment, which simplifies to:

2

Â·

/

cos

(6.3)

Notice that

Â·

| || |

cos

cos

cos

, by the definition of the 2 is the

dot product; where |N|Â·|L|=1 since both N and L are unit vectors. characteristic acceleration and is the .

In 3-dimensional space, this acceleration can be decomposed in terms of

and

with

respect to the axes of the leader centered frame as defined in Eq. 2.5. The unit vector defining the orientation of the sail normal is denoted by the vector N. Parameter is that

the angle the in-plane projection of the sail normal makes with respect to the positive xaxis and is the out-of-plane angle of the sail normal as shown in Figure 6.3.

101

Figure 6.3: Convention Used To Define Control Angles By this convention of control angles, the orientation of the sail normal is defined by,
cos cos cos sin sin

(6.4)

Acceleration can only act along the sail normal,
cos cos Â· cos sin Â· sin Â· (6.5)

Separating and rewriting the components of the acceleration vector after substituting aSRP,
(6.6a) (6.6b) (6.6c)

In the case of a planet-moon system, L defines the Sun-line direction vector and is not always collinear with the x-axis. In this system it will constantly be changing direction in 102

a sinusoidal fashion with an angular frequency that is equal to the difference of the angular velocities of the two primaries.

(6.7) 0

and

,

is the angular velicity of Moon, Earth . The fact that the

last element is zero implies that the synodic component of the orbit is being neglected. This is a common simplification in the literature [9-12,14,15]. Substituting Eq. (6.7) in Eq. (6.3) yields the model of acceleration of a solar sail in a planet-moon system.
cos (6.8a) (6.8b) (6.8c)

Feedback control gain is proportional to state error; therefore the equation of motion representing the error of the instantaneous state and the nominal is determined. However, the goal is to linearize the SRP portion of the differential equation such that the nonlinear term cancels out. This term exists due to the presence of the sail and is instates contribution of the particular solution. It is called nonlinear since it ruins the necessary form of the matrix equation used in linear control design (state space form) with a lingering constant in the equation that neither multiplies with a state variable nor a control input. Firstly, the equations of motion, including the SRP contribution, must be completely linearized to have an applicable model of real satellite motion. The linearization process involves taking the derivative with respect to each control variable, evaluating the result at the nominal and multiplying by the small change in that variable Â­ this is the definition of linearization as shown in Eq. (6.9). These delta terms represent the small variations in the aforementioned quantities which will be used as control variables. The nominal inplane control angle n is set to 0 (meaning that the normal of the sail is to nominally be 103

parallel with the x-axis), small angle approximation is applied, and finally, the nominal out-of-plane control angle n is set to 0 as well (implying the normal of the sail is to nominally be in-plane). Note that since the angles are subjected to small angle approximation, they must not become large in simulation.

(6.9) cos 3 cos  t sin  t

,

,

cos  t sin

(6.10a)

,

,

cos 3

sin  t

cos  t (6.10b)

sin  t sin

,

,

cos

sin

cos

2 sin

cos

(6.10c)

Eq. (6.10) is evaluated for n such a case the factor cos

0 and the out-of-plane angle remains variable in case it is to be applied to an and bn in Eq. (2.19) to appropriately

is desired to be nonzero as to maintain a constant out-of-plane displaced trajectory. In

determine the zero-force reference trajectory. Now that a, , and  are no longer arguments of trigonometric functions, they can be isolated in matrix form and are termed to be "affine control inputs". Control algorithms that are based on non-affine control inputs are still a topic of active research in the field of mathematics. The reader can verify that the application of small perturbation theorem and small angle approximation leads to all nonlinear terms cancelling out as the equations of motion approach the nominal equations as shown in Eq. (2.17). Eq. (6.10) is evaluated and separated into the control coupling matrix, B, and the control input vector, u, as is necessary for substitution in Eq. (2.11). Eq. (6.11) is the state space model which the linear controllers are based on and Eq. (6.12 is the nonlinear on which the control inputs 104

are applied. The control law for the SDRE and LTV-MPC controllers is still given as shown in Eq. (5.4a) and in Eq. (5.4b) for the adaptive controller.

1 0 0

2

0 1 0

0 0

0 2 0

2 0 0

0 0 0

(6.11)

cos cos 0 cos

cos  t sin  t sin

sin  t cos  t 0

3 cos  t sin 3 sin  t sin cos 2 sin

cos

3 3 2

2 2

cos (6.12)
2

When this procedure is applied to some alternative sail normal definitions, the result corresponding to the x and y direction usually remains the same, but sometimes terms containing  vanish, thus leaving the z component of motion uncontrollable. Thus, the convention defined in Figure 6.3 was specially selected after consideration of various alternatives including those proposed in [9,11,12,20]. 6.3 Simulation Results

The same initial conditions were used in simulating control with SRP as was used in other sections; a 1 km initial position error along all dimensions. Figures 6.4 and 6.5 show the response and control input variation, respectively, when the SDRE controller is used.

105

Figure 6.4: State Errors using SDRE Controller for SRP Based Control

Figure 6.5: Control Input using SDRE Controller for SRP Based Control

106

The term "control effort" is no longer appropriate considering no fuel is ever burnt. However, if it is considered that control effort has to do with important power budget constraints, as is with miniature satellites, then a minimal change in sail area is desirable. Accordingly, this control method yields in a change in sail area of -2.7Â·10-3 m2/kg initially with control angles within 2Â°. This causes a control acceleration with components -2.5 N/kg, -0.1 N/kg and 50 mN/kg along the x, y and z directions, respectively, and is of similar order of magnitude as quoted in literature [52] for solar sailing propulsion in this system. Note that negative force cannot be applied with a solar sail. The values given for "control acceleration" as "specific force" is actually the resulting (induced, hence "control") acceleration experienced by the satellite when the nominal area is reduced, as this is how the equations of motion are formulated. Steady state is reached when 80% of the first orbit elapses. Figure 6.4 illustrates an overdamped response with steady state error along the axis transverse to the primaries. This error is bounded within 50 m. The overall transient response diminishes by the time 20% of the first orbit has elapsed. Figures 6.6 and 6.7 show the response and control input variation, respectively, when the LTV-MPC is used. The overall performance is superior to that of the SDRE controller.

Figure 6.6: State Errors using LTV-MPC Controller for SRP Based Control

107

Figure 6.7: Control Input using LTV-MPC Controller for SRP Based Control

Settling time is a mere ~1% of the first orbit. Appropriately, this is done only through large control inputs. The maximum said area change is -8.5 m2/kg, which still leaves a net resultant positive sail area, and in- and out-of-plane control angles of -43Â° and 2.24Â°, respectively. Specific force does not exceed 5 N/kg along any dimension; it may seem much compared to the miliNewtons otherwise being quoted, but to put this into perspective, 5 N is equivalent to about the weight of a half-empty jar of peanut butter. Next in Figures 6.8 and 6.9, the results of the adaptive controller are shown. This controller takes the longest to settle of the three, requiring 30 orbits. It represents the complete opposite type of behavior as compared with the LTV-MPC with respect to the settling time Â­ control effort trade-off. For this controller, maximums of 67Ã10-3 m2/kg of sail area change and control angles changes within 0.0075Â°. The transient response dissipates within 0.7% of the first orbit.

108

Figure 6.8: State Errors using Adaptive Controller for SRP Based Control

Figure 6.9: Control Input using Adaptive Controller for SRP Based Control

109

Finally, the sensor inoperative fault case is simulated for SRP based control using the LTV-MPC controller. The results are shown in Figures 6.10 and 6.11.

Figure 6.10: State Errors using LTV-MPC Controller for SRP Based Control subjected to Sensor Inoperative Condition

Figure 6.11: Control Input using LTV-MPC Controller for SRP Based Control subjected to Sensor Inoperative Condition 110

As a summary, Figures 6.12-6.14 show the resultant trajectory followed by all the controllers.

Initial state error is 1 km along each axis.

Figure 6.12: Trajectory using SDRE Controller for SRP Based Control

Initial state error is 1 km along each axis.

Figure 6.13: Trajectory using MPC Controller for SRP Based Control

111

Initial state error is 1 km along each axis.

Figure 6.14: Trajectory using Adaptive Controller for SRP Based Control

6.4

Summary

The LTV-MPC demonstrated the most reasonable performance, as far as the question of robustness goes, while the SDRE controller does not display adequate steady state properties and the adaptive controller performs better than the LTV-MPC in some ways. Although the adaptive controller displayed the best performance, it is very sensitive to external disturbances and angle variations of less than 1Â° would be totally impractical in reality where noise from on-board electronics and actuators among other unknown influences would greatly affect the actual performance. Regardless that the tuning can fix this problem, this was a study of robustness where tuning parameters were unchanged to see how the controllers would perform in unexpected off-design operations such as initial error. The definite conclusion that was indeed made was that the classical SDRE controllers have been performing inferior to the newly emerging predictive control method in space applications.

112

CHAPTER 7

Conclusions

Formation flying is being sought after as the underlying structure of many planned spacecraft missions spanning over many applications including communications and observation. As discussed in Chapter 1, the improvements leading to enhanced reliability of technologies such as those based on MEMS and fuel efficient propulsive methods against various external disturbances and unmodeled dynamics, and above all with improved economic feasibility, are the current challenges facing engineers that wish to push the threshold of space flight advancement. Typically, solar radiation pressure is considered an external disturbance or as often is the case in literature, not accounted for at all. Conversely, in this thesis, its existence was taken advantage of, and was used as the very means of propulsion for the spacecraft with control inputs representing only geometric reconfigurations of a momentum transferring reflective surface. Also, this thesis presented an analysis of control performance subjected to various disturbances that were aimed to incorporate more reality into the simulation. The controllers were implemented on a real physical system in a laboratory environment to validate them for the proposed use, and verify the trends and characteristics demonstrated in simulations. The main results and contributions of this research are summarized in this chapter, which closes with some future work recommendations. 7.1 Contributions Outline

Referring to the Thesis Map presented in Figure 1.1, the conclusions that can be made with respect to the two foci of the study are now articulated.

113

7.1.1 Thrusters LQR control was shown to be relatively the worst performing controller overall. The MPC controller is not any more difficult to apply in MATLAB simulations yet it is not very popular in the literature relating to space systems as compared to LQR. The LQR controller had a tendency to yield larger control inputs, which is generally undesirable. The performance of the MPC controller displayed a response that was closest to being critically damped. The form of MPC control that was used herein was Infinite Time Horizon Unconstrained Model Predictive Control. It is therefore more flexible in the sense that it can account for control and output constraints if one desired to include so and optimization is can be over a time interval that goes a specified number of time steps into the future based on the model provided. Adaptive control demonstrated the greatest resilience against sensor noise, followed by MPC control. The same conclusion was made with regards to controller performance subjected to thruster instability. A consistent result for the simulations presented in this thesis and on other systems as well is that the MPC controller tends to be relatively more sensitive to velocity noise than the other controllers, but still performing better than the LQR controller. The adaptive controller tended to allow for the largest errors when sensors were disabled, limiting itself to use smaller control forces. When the simulations were repeated using LQE state estimation, the performance of all controllers greatly improved; however, the LQR controller came out to be the superior controller specifically for the thruster instability fault case. With regards to the hardware-in-the-loop testing (2-axis thrusters), the simulations predicted a longer settling time than what came to pass in reality. This is because the real system had friction that introduced more damping. The tether was also a disturbance which made the unit spin more than it otherwise would have, as it presented a resistance anchored off the center of mass of the unit. Since the components of thrust were decomposed along the actuating axes, the only issue spinning caused had to do with the magnitude of thrust delivered along the resultant line of force, considering that the thrusters had a constant magnitude on-off output. Thus, more rotational motion extended 114

the transient response. Finally, the voltage of the batteries powering thrusters made a significant impact on the frequency and magnitude of overshoots; thus, settling time. When the thrusters fired with lower power due to low batter charge, the system moved slower overall, and therefore built up less momentum, thus increasing the effectiveness of frictional damping (mass acceleration friction). This is the first such conclusion made about the SAFE system. Other less significant disturbances came from a minor slant in the table going downward towards the +y axis, and friction being a function of the position on the table due to dust particles that may have landed. In multiple runs of the same test using the same controller, the response displayed the same distinct characteristics, but with a settling time varying by up to ~20%. The overall results of the SAFE test and simulations of formation flying at the Earth-Moon L2 point matched in terms of controller characteristics, and are therefore taken to be a good parallel. 7.1.2 Advanced Configurations

Actuation via the harnessing of solar radiation pressure and thrust vectoring was analyzed. Both configurations involve variables that were to be used as control inputs a nonlinear functions embedded with the equations of motion as non-affine in nature. In the case of solar sailing, adding perturbations to the area and two angles followed by linearization made the resulting equation have affine control inputs which were the perturbations themselves. This approach was successful because the controller was tunes well enough to bound the change in area to less than that of the nominal sail area so that area would never be less than zero and the control angles within the range of small angle approximation. Linearization however did not work for thrust vectoring. A completely unorthodox formulation of dynamics was devised for this case which involved the controller based on jolt-dynamics rather than acceleration-dynamics and having the calculated control inputs be the rate of change of thrust and rate of change of angles with respect to time, quantities which would then be numerically integrated and applied to the acceleration-dynamics based plant. In the thrust vectoring simulations, the adaptive and MPC controllers again converged most efficiently. Control angles in with MPC control did happen to make complete revolutions but that was okay since no small angle 115

approximation was made and validity of such a response therefore holds. The MPC and SDRE controllers experienced some steady state error. This was due to integrated position not being included as states, which is a somewhat abstract quantity that cannot be directly measured. In the solar radiation pressure simulations, the SDRE controller again displayed some steady state error whereas the MPC and adaptive controllers did not. The MPC controller had a much shorter settling time but utilized control inputs which were greater in magnitude, which does not really matter for solar sailing since the propulsive force is free and reasonably larger control variations may be more practically implemented in reality. Overall, control using SRP was more efficient than with thrust vectoring in spite of both configurations making use of the same principle. 7.2 Future work

Some areas of interest pertaining to the advancement of this study are now identified.  In practice, there would be a delay in reorienting the thrust vector due to the process of nozzle reconfiguration or in changing the attitude of the satellite, whichever approach is taken. In this study, it was assumed that this effect was negligible since the time taken to even reorient the satellite would be much less in comparison to the period of the orbit. This also applies to the reconfiguration of a solar sail in response to a control command, and was also the same assumption that justified using an identity matrix in the state space equations modeling the effect of thrust in the equations of motion, given that the build-up of thrust into steady state operation required a time that is much less than the period of the orbit. Other than that, communication delay and the processing of sensor data can introduce another delay, especially if it is based on optical images or star sensors. Therefore, a study involving controller design that accounts for the various delays could possibly be valuable.  The advances of model-less adaptive control were shown to be of great success in this study, it would thus be beneficial to look at other types of adaptive controllers with algorithms for self-tuning. Such a controller could be applied to anything at

116

all and potentially yield superior performance over the usual model-based control methods.  Hardware-in-the-loop testing with 6-degrees of freedom. It is proposed that a system be built similar to the SAFE system but as an AUV. An IMU + radio transmitter would be placed on a human leader and the follower would autonomously maintain formation around it. Such a 3-dimensional environment would be more similar to the space environment, as well as lead into other potentially useful applications.  Bellman's [13] research on the determination of optimal trajectories using dynamic programming shows how to rewrite differential equations or cost functions to be minimized to such that are in discrete recursive form, such that the extrema could be searched for. Instead of differentiation, it was suggested that functions be approximated by Legendre polynomials and the coefficients be numerically solved for. This approach has the prime advantage of being relatively quicker in convergence, and thus creates room to include more than six state variables in the equations of motion for which optimal trajectories are sought with respect to fuel, mass, etc. A predictive controller can be formulated using this approach, and serve to solve systems that may not necessarily be writable in state-space form. Indeed, this may be applied in the near future as an extension of this study.

117

118

References
[1]
[2] [3] [4] [5] [6] [7] [8] [9] Tewari, A., Atmospheric and Space Flight Dynamics Â­ Modeling and Simulation with MATLABÂ® and Simulink, BirkhÃ¤user, Boston, 2007. Curtis, H.D., Orbital Mechanics for Engineering Students, Elsevier ButterworthHeinemann, Oxford, 2005. Arnold, V.I., Kozlov, V.V., Neishtadt, A.I., Mathematical Aspects of Classical and Celestial Mechanics, 3rd Edition, Springer, New York, 2006. Kumar, K.D., Fundamentals of Dynamics and Control of Space Systems, Ryerson University, Toronto, 2006. Tewari, A., Modern Control Design Â­ With MATLABÂ® and Simulink, Wiley, Chichester, 2002. Slotine, J.E., Li, W., Applied Nonlinear Control, Prentice Hall, New Jersey, 1991. Nise, N.S., Control Systems Engineering, 3rd Edition, Wiley, U.S.A., 2004. Hahn, B.H., Essential MATLABÂ® for Engineers and Scientists, Elsevier Academic Press, Burlington, MA, 2010. Wong, F., Kumar, K.D., "Formation Flying of Spacecraft at Earth-Moon Libration Points Using Solar Radiation Pressure," Advances in the Astronautical Sciences, Vol. 136, No. 8, 2009, pp.879-898. Li, H., "Application of Solar Radiation Pressure to Formation Control Near Libration Points," PhD Dissertation, University of Cincinnati, February 2008. Wong, F., "Formation-Keeping Strategies at the Earth-Moon L4 Triangular Libration Point," MASc Thesis, Ryerson University, Toronto, 2009. Simo, J., and McInnes, C. R., "Solar sail orbits at the Earth-Moon libration points," Communications in Nonlinear Science and Numerical Simulation, Vol. 14, Issue 12, 2009, pp. 4191-4196. Bellman, R., "On the Determination of Optimal Trajectories via Dynamic Programming," Mathematics in Science and Engineering, Vol. 5, No. 8, 1962, pp. 281-290.

[10] [11] [12]

[13]

119

[14]

Simo, J., and McInnes, C. R., "Displaced solar sail orbits: dynamics and applications," 20th AAS/AIAA Space Flight Mechanics Meeting, San Diego, California, February 14 Â­ February 17, 2010. Bookless, J., and McInnes, C. R., "Control of Lagrange point orbits using solar sail propulsion," Acta Astronautica, Vol. 62, Issue 2-3, 2008, pp. 159-176. Breger, L., How, J., and Richards, A., "Model predictive control of spacecraft formations with sensing noise," ACC.2005.1470323, American Control Conference, Cambridge, MA, USA, June 8 Â­ June 10, 2005. Curtis, H. D., Orbital Mechanics for Engineering Students, Oxford, ButterworthHeinemann, 2005. Zegler, F., and Kutter, B., "Evolving to a Depot-Based Space Transportation Architecture," AIAA 2010-8638, AIAA SPACE Conference & Exposition, Anaheim, California, USA, August 30 Â­ September 2, 2010. Farquhar, R. W., "The Control and Use of Libration Point Satellites," PhD Dissertation, Stanford University, Dept. of Aeronautics and Astronautics, 1968. Shahid, K., "Spacecraft Manoeuvring at the Sun/Earth-Moon L2 Libration Point," PhD Dissertation, Ryerson University, Toronto, 2010. Godard, "Fault Tolerant Control of Spacecraft," PhD Dissertation, Ryerson University, Toronto, 2010. Miller, J. E., and Laats, A., "Apollo Guidance and Control System Flight Experience," Journal of Spacecraft and Rockets, Vol. 7, 1970, pp. 551-561. Farrar, M., "A Comparative Analysis of Control Techniques for Formation Flying Spacecraft in an Earth/Moon-Sun L2-Centered Lissajous Orbit," AIAA-20087358, AIAA/AAS Astrodynamics Specialist Conference and Exhibit, Honolulu, Hawaii, August 18 Â­ August 21, 2008. Bilodeau, V. S.,and Lafontanie, J. D., "Explicit Predictive Control Law for Satellite Formation Flying in Eccentric Orbits," Advances in the Astronautical Sciences, No. 142, 2008, pp. 637-656. Xibin, C., Donglei, H., "Research on the Model Predictive Control Approach for Satellite Formation Keeping," Journal of Astronautics, Issue 4, 2008, pp. 12761283. Wie, Bong, Space Vehicle Dynamics and Control, AIAA, Reston, Virginia, 1998.

[15] [16]

[17] [18]

[19] [20] [21] [22] [23]

[24]

[25]

[26]

120

[27] [28] [29] [30] [31]

Bemporad, A., Morari, M., and Ricker, N., Model Predictive Contorl ToolboxTM 3 User's Guide, Natick, The MathWorks, Inc., 2010. Wong, F., Kumar, K. D., "Formation Control at the Earth-Moon L4 Libration Point," Advances in the Astronautical Sciences, Vol. 136, 2010, pp. 879-898. Schmid, P. E., "Lunar Far-Side Communication Satellites," Technical Report Â­ Goddard Space Flight Center, Greenbelt, MD, USA, June 12, 1968. Angelopoulos, V., "THEMIS," Technical Report Â­ Space Sciences Laboratory, University of California, Berkeley, CA, USA, September 9, 2010. Koon, W. S., Lo, M. W., Marsden, J. E., and Ross, S. D., "Dynamical Systems, the Three-Body Problem, and Space Mission Design," International Conference on Differential Equations, 2000, pp. 1167-1181. Lam, W. C., Ura, T., "Nonlinear controller with switched control law for tracking control of non-cruising AUV," Autonomous Underwater Vehicle Technology, Monterey, CA, USA, June 2 Â­ June 6, 1996. How, J. P., and Tillerson, M., "Analysis of the Impact of Sensor Noise on Formation Flying Control," ACC.2001.946298, American Control Conference, Arlington, VA, USA, June 25 Â­ June 27, 2001. Godard, and Kumar, K.D., "Robust Attitude Stabilization of Spacecraft Subjected to Actuator Failures," Acta Astronautica, Vol. 68, Issue 7, July 2009, pp. 12421259. McInnes, C. R., "Solar Sail Trajectories at the Lunar L2 Lagrange Point," Journal of Spacecraft and Rockets, Vol. 30, No. 6, 1993, pp. 782Â­784. Baoyin, Hexi., and McInnes, C.R., "Solar Sail Orbits at Artificial Sun-Earth Libration Points," Journal of Guidance, Control, and Dynamics, Vol. 28, No. 6, November, 2005, pp. 1328 Â­ 1330. Wang, Z. S., and Williams, T. W., "Uses of Solar Radiation Pressure for Satellite Formation Flight," International Journal of Robust and Nonlinear Control, Vol. 12, Issue 2-3, 2002, pp. 163Â­183. McInnes, C.R., McDonald, A.J., Simmons, J.F.L., and MacDonald, Ewan W., "Solar Sail Parking in Restricted Three-Body Systems," Journal of Guidance, Control and Dynamics, Vol. 17, No. 2, 1994, pp. 399 Â­ 406. Kumar, K. D., Bang, H. C., and Tahk, M. J., "Formation Flying of Satellites Using Solar Radiation Pressure," ISTS-2004-d-25, 24th International Symposium on Space Technology and Science, Miyazaki, Japan, May 30 Â­ June 6, 2004. 121

[32]

[33]

[34]

[35] [36]

[37]

[38]

[39]

[40] [41] [42] [43]

McInnes, Colin R., Solar Sailing: Technology, Dynamics and Mission Applications, Springer, Berlin, 2004. Larson, W.J., Wertz, J.R., Space Mission Analysis and Design, Kluwer Academic Publishers, 3rd Edition, Boston, 1999. Szebehely, V., Theory of orbits, Academic Press, New York, 1967. Kelly, A., "Modern Inertial and Satellite Navigation Systems," Technical Report Â­ Robotics Institute, Carnegie Mellon University, Pittsburgh, PA, USA, May, 1994. Grewal, M. S., Weill, L. R., and Andrews, A. P., Global Positioning Systems, Inertial Navigation, and Integration. John Wiley & Sons, Inc., Hoboken, New Jersey, 2007. Titterton, D. H., Strapdown Inertial Navigation Technology, 2nd Edition, MPG Books Ltd., Bodmin, Cornwall, 2004. Sutton, G. P., and Biblarz, O., Rocket Propulsion Elements, 7th Edition, John Wiley & Sons, Inc., New York, NY, 2001. Sharma, A., Golubchik, L., and Govidan, R., "On the Prevalence of Sensor Faults in Real-World Deployments," In Proceedings of SECON, 2007, pp. 213-222. Paxson, D., Wernet, M., John, W., "An Experimental Investigation of Unsteady Thrust Augmentation Using a Speaker-Driven Jet," AIAA 42nd Aerospace Sciences Meeting and Exhibit, Reno, Nevada USA, January 5 Â­ 8, 2004. Barbour, N. M., Elwell, J. M., and Setterlund, R. H., "Inertial Instruments: Where To Now?," AIAA Guidance, Navigation and Control Conference, Hilton Head Island, SC, USA, August 10 Â­ August 12, 1992. Koon, W. S., Lo, M. W., Marsden, J. E., and Ross, S. D., "Constructing a Low Energy Transfer Between Jovian Moons," Contemporary Mathematics, Vol. 292, 2001, pp. 129-146. Ni, K., Ramanathan, N., Chehade, M., Balzano, L., Nair, S., Zahedi, S., Pottie, G., Hansen, M., Srivastave, M., and Kohler,E., "Sensor Network Data Fault Types," ACM Transactions on Sensor Networks, Vol. 5, Issue 3, 2009, pp. 25-53. Simo, J., and McInnes, C. R., "Displaced periodic orbits with low-thrust propulsion," 19th AAS/AIAA Space Flight Mechanics Meeting, Georgia, USA, February 8 Â­ February 12, 2009.

[44]

[45] [46] [47] [48]

[49]

[50]

[51]

[52]

122

