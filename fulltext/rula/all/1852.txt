Ryerson University

Digital Commons @ Ryerson
Theses and dissertations

1-1-2009

Characterization Of Human Stability Using Vector Acceleration Signals
Joseph Santarcangelo
Ryerson University

Follow this and additional works at: http://digitalcommons.ryerson.ca/dissertations Part of the Electrical and Computer Engineering Commons Recommended Citation
Santarcangelo, Joseph, "Characterization Of Human Stability Using Vector Acceleration Signals" (2009). Theses and dissertations. Paper 1185.

This Thesis is brought to you for free and open access by Digital Commons @ Ryerson. It has been accepted for inclusion in Theses and dissertations by an authorized administrator of Digital Commons @ Ryerson. For more information, please contact bcameron@ryerson.ca.

Characterization/of Human Stability Using Vector Acceleration Signals

by

Joseph Santarcangelo

A project presented to Ryerson University in partial fulfillment for the degree of Master of Engineering in the Program of Electrical and Computer Engineering

Toronto, Ontario, Canada 2009

©Joseph Santarcangelo, 2009

\PROPE R TY OF
RYERSON UNIVERSITY UBRAR'f

Author's Declaration

I hereby declare that I am the sole author of this project. I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research.

Author's Signature:

I further authorize Ryerson University to reproduce this project by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

Borrower's Page

Ryerson University requires the signature of all persons using or photocopying this thesis. Please sign below, and give address and date.

Name

Signature

Address

Date

ii

Abstract

Characterization of Human Stability Using Vector Acceleration Signals
©Joseph Santarcangelo, 2009

Master of Engineering Department of Electrical and Computer Engineering Ryerson University

Biomedical signals carry information about a physiological event. The part of the signal pertaining to a specific event is called an epoch. Once the event has been determined, the corresponding waveform may be segmented and analyzed based on many parameters[ 1]. As falls have increased in recent years due to an aging population, it is important to gain insight to the reaction of an individual to perturbations. One common method of studying human reactions is by using a balance aperture. This thesis describes the physical actions that produce acceleration on a balance apparatus and captures the acceleration on an accelerometer. Algorithms were developed to segment the unstable periods of the accelerometer signal. Wavelets were used as well as non-linear filters. The non-linear filters increased the amplitudes of periods of instability, simple signal models of the output of the non-linear filters where formulated and analyzed. Vector processing techniques were also developed. The experimental results demonstrate that the acceleration during unstable periods can be differentiated by its frequency content, by its discontinuous nature and by using vector relationships. The algorithms were tested with five individuals and had over 80% accuracy.

111

Acknowledgements
I would like to thank Dr. Kristina M. McConville, for guiding me through the vast amount of unfamiliar material regarding biological modeling and control systems, helping me manage the cross-disciplanary issues between the biology physiology, data aquisition, signal processing and mathematics. Dr McConville reviewed my work and helped me understand the complex interplay between sensory feedback and balance. I would also like to thank her for keeping me on track, guiding me through the research process, making sure each step in the process was complete and letting me be creative in the process. I would also like to thank Matija Milosevic for acquiring the data.

IV

List of Figures
Figure 1: balance apparatus ................................................................................................. 1 Figure 2: individual on a balance apparatus (www.woodentoys.com) ............................... 2 Figure 3 signal A (top) and signal B (bottom) .................................................................... 7 Figure 4: a) spectrums of subject one b) spectrum of subject four (bottom) ...................... 8 Figure 5: a) signal b) magnitude ofCWT c) phase ofwavelet transform ......................... 21 Figure 6 :a)delta function b) the magnitude of is wavelet transform ................................ 23 Figure 7: Haar Scaling function basis set of function ....................................................... 25 Figure 8:projection onto subspace with different finite resolutions ............................................. 25 Figure 9: Haar Wavelet ..................................................................................................... 27 Figure 10: filter banks ....................................................................................................... 29 Figure 11: signal m/s2(top) and image of matrix D red are the largest values (bottom). 33 Figure 12: output of non-linear filter for different values ofm for subject 2 ................... 35 Figure 13: output of new filter for different values of m .................................................. 37 Figure 14a) low frequency part of signal y(n) b) high frequency component of signal y(n) c) y(n) .............................................................................................................. 38 Figure 15 a)st(n) for signal y(n) and b) s2(n) for signal y(n) c) s10(n) for signal y(n) K=3 ............................................................................................................................ 38 Figure 16:a) zt(n) b) s4(n) ofzt (n) for K=4 c) s3o(n) ofzt (n) for K=4 ........................ 42 Figure 17:a) Z 1 (ro), b) S6(ro) of Zt (ro) with for K=4 c) S3o(ro) of Zt (ro) with K=4 ......... 43 Figure 18:a) u(n-245)- u(n-255) b) z2 (n) c) s6(n) ofz2 (n) for K= b) z2 (n) d) S6(n) ofz2 (n) for K=4 ............................................................................................................... 44 Figure 19: spectrum of signal for different values of m, it is evident that as m increases the spectrum approaches a Gaussian shape a) Z2 ( ro) the DTFT of the original signal , b) S6( ro) with K =4 Z2 (ro) for K=4 c) S3o( ro) of Z2 (ro) with K=4 .............. 44 Figure 20: relationship between Cartesian coordinates and spherical coordinates system, bold arrows indicate new unit vectors ....................................................................... 46 Figure 21: a) accelerometer signal y component b) Magnitude ofCWT Gaussian .......... 48 Figure 22: a) accelerometer signal y component b) Magnitude of CWT Morlet. ............. 49 Figure 23: accelerometer Signal y component (top) and wavelet coefficients (bottom). 50 Figure 24: f(u) red super imposed over signal normalized amplitude .............................. 51 Figure 25 a) normalized segmented period where red has a amplitude of one super imposed over signal b) magnitude of CWT .............................................................. 52 Figure 26 :phase of CWT with different segmented period super imposed (top) signal with different segmented period super imposed (bottom ) ....................................... 53 Figure 27: time frequency flow chart ................................................................................ 54 Figure 28: different segmentation periods of time frequency algorithms ......................... 54 Figure 29: non-linear averaging filters algorithm flow chart ............................................ 55 Figure 30: flow chart of inverse tangent algorithm ........................................................... 56 Figure 31 :mean value of different time frequency algorithms for five individuals .......... 59 Figure 32: mean values of trials with different signal parameters .................................... 61 Figure 33: subject 2 a) output of non-linear filter, stable periods in red and segmented periods in green b) r(n) .............................................................................................. 62

Vl

Figure 34: subject 3 a) output to non-linear filter, stable periods in red and segmented periods in green b) r(n) .............................................................................................. 62 Figure 35: function A compared to output of non-linear filter s4(n) using subject 2 ....... 64 Figure 36: function B compared to output of non-linear filter s4(n) using subject 3 ....... 64 Figure 37: comparative performance of algorithms .......................................................... 66 Figure 38: non-linear averaging filter (blue )and the angle output from the inverse tangent (red) (normalized) ..................................................................................................... 68

vii

List of Equations
Equation 1: signal model using random variables ............................................................ 10 Equation 2: response to the Dirac impulse defined ........................................................... 13 Equation 3: convolution integral ....................................................................................... 13 Equation 4: uniform sampling of the function/................................................................ 14 Equation 5: discrete convolution ....................................................................................... 14 Equation 6: averaging in convolution form ....................................................................... 14 Equation 7: discrete complex weight coefficients ............................................................. 15 Equation 8: functions expressed as weighted sinusoidal functions ................................... 15 Equation 9: Fourier Transform .......................................................................................... 16 Equation 10: Inverse Fourier Transforms ......................................................................... 16 Equation 11 : Discrete Time Fourier Transforms .............................................................. 16 Equation 12: averaging in frequency domain ................................................................... 17 Equation 13: Inverse Discrete Time Fourier Transform ................................................... 17 Equation 14: Discrete Fourier Transform ........................................................................ 17 Equation 15: Z transform .................................................................................................. 18 Equation 16: down sampling up sampling Z transform identity ....................................... 18 Equation 17 :inverse z transform ....................................................................................... 18 Equation 18: linear time frequency transform ................................................................... 19 Equation 19: Windowed Fourier Transform ..................................................................... 19 Equation 20: Wavelet Transforms ..................................................................................... 20 Equation 21: magnitude of the Wavelet Transform .......................................................... 20 Equation 22: f(t) be composed of two sub signals: .......................................................... 22 Equation 23: Taylor expansion of sub signal .................................................................... 22 Equation 24: Wavelet that contains n vanishing moments ............................................... 22 Equation 25: Wavelet Transform of a singularities .......................................................... 22 Equation 26: Complex Gaussian ....................................................................................... 23 Equation 27: Discrete Wavelet .......................................................................................... 24 Equation 28: scaling function ............................................................................................ 24 Equation 29: projection of function onto scaling function subspace and projection operator...................................................................................................................... 25 Equation 30 scaling function ............................................................................................. 25 Equation 31: definition of scaling function filter .............................................................. 26 Equation 32: projection of function onto wavelet subspace and projection operator ...... 26 Equation 33: wavelet ......................................................................................................... 26 Equation 34: definition of wavelet of filter ....................................................................... 27 Equation 35: first detail coefficients ................................................................................. 28 Equation 36: approximation coefficients second iteration ............................................... 28 Equation 37: polynomial of degree k ................................................................................ 31 Equation 38: samples of a signal in vector form ............................................................... 32 Equation 39: matrix D ....................................................................................................... 32 Equation 40: elements of the matrix D .............................................................................. 32 Equation 41 :non-linear averaging filter ............................................................................ 34 Equation 42: delta function input to non-linear filter ........................................................ 36 Equation 43: response of delta function to non-linear filter .............................................. 36 viii

Equation 45: signal composed of two sine waves ............................................................. 37 Equation 46: discrete-time Fourier transform of s 1(n) ..................................................... 39 Equation 47: discrete-time Fourier transform of sm(n), for large values ofm .................. 39 Equation 48: normalization constant ................................................................................. 39 Equation 49:normalized spectrum ..................................................................................... 39 Equation 50:mean of spectrum .......................................................................................... 39 Equation 51 :variance of function ...................................................................................... 40 Equation 52:chirp function ................................................................................................ 42 Equation 53: time varying vector ...................................................................................... 45 Equation 54:magnitude of time varying vector ................................................................. 46 Equation 55: angle from the z-axis to the xy plane ........................................................... 46

IX

List of Tables
Table 1: hypotheses Summary .......................................................................................... 12 Table 2: different wavelets and scaling functions ............................................................. 31 Table 3: test parameters ..................................................................................................... 57 Table 4: values of Sensitivity, Specificity, Diagnostic Accuracy, Positive Predictive Value, Negative Predictive Value and Prevalence .................................................... 58 Table 5 mean value of different time frequency algorithms for five individuals ............. 59 Table 6 best trial of non-linear filter algorithm ................................................................. 60 Table 7: mean values of trials with different signal parameters ...................................... 60 Table 8: function used to model output of non-linear filter .............................................. 63 Table 9: results for the Inverse tangent algorithm ............................................................. 65 Table 10 comparative Performance of algorithms ............................................................ 66 Table 11: comparative Performance Table ....................................................................... 67

X

List of Abbreviations
3-D

DFT DTFT
CWT
db

LTIS STFT

Three dimensional Discrete Fourier Transform Discrete Time Fourier Transform Continuous Wavelet Transform Daubechies wavelets Linear Time Invariant Systems Short Time Fourier Transform

Xl

Chapter 1
1.0 Introduction
The incidence of falls has vastly increased in recent years as our population ages according to epidemiological reports. As such, more research is being conducted on the factors involved in falls, avoiding obstacles and changing directions being the most common. More specifically, efforts have been made in quantifying the human response to perturbations using a balance apparatus, as shown in Figure 1 [2], [3].

Figure 1: balance apparatus

Operation of Apparatus: An individual stands on an unstable surface and tries to maintain balance by not allowing the apparatus to come into contact with the ground. The individual on the balance apparatus is never in true static equilibrium but appears to be in one of two states. The first state or the stable state is characterized by many tiny incremental movements of a short duration, whereby the arms stay in relatively the same position and the individual is hunched over with a stiff spine. The second or unstable state is characterized by large displacements, involving sporadic arm movements, weight shifting from one leg to another, with the individual moving back and forth, shown in

1

Figure 2. By placing an accelerometer on the balance apparatus, one can record relevant accelerations.

Figure 2: individual on a balance apparatus (www.woodentoys.com)

Unfortunately a quantitative method does not exist to determine what state an individual is in presently. The accelerometer signal characteristics are extremely variable from individual to individual and from trial to trial making methods segmentation based on statistical decisions difficult. Once the signal is segmented other physiological data can be analysed including the motion of the arms, neck and eyes. The variance in the signals amplitude, statistical content and spectrum make it difficult to use standard algorithms and filters. The algorithms were developed using time frequency analysis, a non-linear filter and vector signal processing. Continuous Wavelet Transform based algorithms worked well but multi-resolution wavelets did not perform as well which made the time frequency algorithms computationally expensive. The algorithm using vector signal processing used the angle generated by the relationship between acceleration vectors. It produced the best performance. This suggests that the relationship between vectors should be examined when studying accelerometer signals.

2

The non-linear filter was newly developed and characterized in the frequency domain. The new filter was tested with the accelerometer signal as well as generated signals. The output of the non-linear filter was similar to the angle relationship. This suggests that the non-linear operation captures correlations between vectors. The algorithm was tested with signals from five individuals and the three best algorithms performed with diagnostic accuracy over 80%. This thesis describes accelerometer segmentation algorithms used in fall and seizure detection and describes the challenges associated with segmenting the accelerometer signal. The physiological, perceptual and cognitive mechanisms of balances are discussed and used to determine parameters that can be helpful tn segmenting the signal. The analysis methods are discussed including linear time invariant systems, Fourier Transforms, Windowed Fourier Transforms, Wavelet Transforms and Multiresolution Analysis. A non-linear filter is developed and its Fourier Transform is derived. Vector signal processing is also discussed. A detailed description of the algorithms are given, the results of the algorithms are shown, modeled, analysed and compared.

3

Chapter 2
2.0 Background Information
2.1 Accelerometers
Electronic accelerometers are dependent on piezo-electric properties. Piezoelectric accelerometers consist of damped mass-spring systems, in which a piezoelectric element acts as spring and damper. This element generates an electrical charge in response to the mechanical force. Clinical applications of accelerometers include gait and balance evaluations, fall risk assessment and mobility monitoring [3-5]. The idea of utilizing an accelerometer to measure human movement was first proposed in the 1950s, but suffered many practical considerations. Like many electronic devices at the time, accelerometers were bulky and interfered with the motion of the subject. They were also very expensive and unreliable. Eventually accurate and inexpensive low power accelerometer devices were developed for air-bag release systems [3].

2.1.1 Accelerometer Segmentation Algorithms

Two common applications of accelerometer signal segmentation algorithms are fall detection and seizure detection. Although the signal characteristics are different from those on a balance board, it is helpful to examine the methodology behind these segmentation algorithms. The main challenge of determining a fall detection algorithm is distinguishing a true falling event from normal activities such as fast walking, and
4

ascending and descending stairs [7]. Some algorithms depend on multiple sensors including an accelerometer, tilt sensor and gyroscope [6]. One common element of the reviewed methods is averaging the signal then using a threshold value to determine the segmentation periods of the signal [7 -9]. Some algorithms augment the classification using logic operations [8], others use the root-sum-of-squares of the three signals from each tri-axial accelerometer [9]. For distinguishing between normal daily activities such as sitting, standing, lying, and movement, statistical properties of the amplitude of the signal are effective, but time frequency methods are more effective when distinguishing between various complex movements. As a consequence, time frequency methods have been applied to seizure detection algorithms of accelerometer signal. Tamara et al [ 10] examined the use of Short Time Fourier Transform (STFT) and the Continuous Wavelet Transform (CWT), which involved examining the time frequency response of artificial signals such as sine waves and impulses, which represented the most important characteristics of the myoclonic seizures. The signals include damped sinusoids, decaying functions and sinusoids of different frequencies. These functions are commonly used in modeling the cognitive and physiological processes. This method cannot be applied in analysing the balance apparatuses signal as the signal is corrupted by noise and interference. The insight gained was used to analyze real patient data, and time-frequency measures were then used for myoclonic seizure detection. Discriminate analysis set-up was used on clinical data. It was found that both STFT and CWT could be used for feature extraction for detecting myoclonic seizures [10].

5

Nijsen and Janssen [11] also used wavelets to detect seizures, but their methodology was different. First they developed a physiological model of arm movements during certain epileptic seizures [11], then using this model they developed a wavelet that had maximum correlation which in tum would augment detection [12], Modeling the muscle activity that causes the accelerations during an epileptic seizures is not as involved as modeling regular muscle movements [ 11]. In addition, there is no complex muscle interaction, feedback or neural control process.

2.1.2 Accelerometer Segmentation
The main problem of segmenting the stable and unstable periods is that the accelerometer signal varied a great deal from individual to individual. Stable and unstable periods for one individual would have different characteristics such as amplitude, duration and shape. The component of an accelerometer signal from two individuals is shown in Figure 3. Signal A (top) has two unstable 1 seconds to 2 seconds and 5 seconds to 6 seconds. The shape of the unstable periods is distinctive, with a sudden decrease in amplitude followed by a sharp increase in amplitude. The unstable periods are short in duration, about 0.50 seconds and have peak amplitude -0.17 m/s2 to -0.25 m/s2, whereas the stable periods have amplitudes of between -0.1 m/s2 and 0.1 m/s2 . Signal B (bottom) has unstable periods that have completely different characteristics. The first period from samples 2 seconds to 3 seconds, has the same shape and duration as the unstable period in signal A, and the second unstable period, from 5 seconds to 9 seconds, has a completely different shape and duration. Some portions are square shaped while other portions oscillate from positive to negative values. The varying characteristics of accelerometer

6

signals from individual to individual makes it impossible to use a threshold value to segment the unstable periods.
a)Y-component subject 2

0.1
C\1

en

0 I-

I,

r
I
I

"'
I

''

·.I

,r

I'',

E -0.1
-0.2 1 2
4 3 Seconds b)Y-component subject 3

5

6

0.2 0.1
C\1

en

0 -0.1 -0.2 1 2
3

,,

I

l,

·

..
I

,·q\.

,of'

E

~

I

...

I

I

I

..

',

4

5
Seconds

6

7

8

9

Figure 3 signal A (top) and signal B (bottom)

Comparing the signals in Figure 4, one can see that the spectrums of the signal have different forms. Although both signals have most of the energy distributed in the low frequency components the distribution of the spectrum has different form 20 to 50 Hertz range. This makes it difficult to determine a cut-off frequency for conventional filtering.

7

a)
Amplitude Spectrum of Subject One dB

~ ~~~--~~--~~--~~--~~

-100

-80

-60

~

-20

0

20

40

60

80

100

Frequency (Hz)

b)
Amplitude Spectnm of Subject Four dB

-30
~ ~~~--~~~~~~--~~~

-100

-3)

-a>

~

-20

0

20

40

60

fK)

100

Frequency (Hz)

Figure 4: a) spectrums of subject one b) spectrum of subject four (bottom)

8

2.2 Determining Signal Characteristics
Standing straight involves keeping several joints and muscle groups in a geometric relationship with respect to the environment. Many factors affect the process of standing, such as what the individual task is at the time. Developments in posture control show that cognitive and perceptual factors can affect balance [14].

Posture is defined as:
" ... the geometric relation between two or more body segments expressed in terms ofjoint angle(s) between segments. A complete geometry defining the posture of the whole body should include the relation of the body to the environment ... "[13]

Understanding how the brain processes and reacts to sensory information in the process of balance provides quantified measurements that may be used in any signal segmentation algorithm. Posture is maintained by the central nervous system controlling different jointed segments of the body, reacting to gravity and some kind of external stimuli. The nervous system controls resultant torque around a joint to maintain posture. The process of matching resultant external torque with torque developed by muscles acting around that joint to maintain equilibrium can be defined as balance. The input to the neural systems is sensory information and the response is a series of motor outputs to the body, which control movements. The motor outputs do not activate individual muscles but rather groups of multiple muscles forming a 'muscle

9

synergy. Movement is a result of complex multiple motor outputs changed or modulated over time [13].
In balance control, motor command signals must be dynamically modulated in

response to a suite of sensory information. When responding to perturbations, the motor outputs causing muscle-activation patterns are highly variable [14]. This is similar to what happens when an individual loses balance on an apparatus when performing a highly involved task. However, because the occurrence appears unpredictable, the

response will be treated as that of an imposed perturbation [15]. The muscle synergy responsible for balance causes movement. Each movement is manifested on the balance apparatus, which then causes periods of stability to appear similar in characteristics regarding amplitude and shape. This interference makes developing a segmentation algorithm challenging as the characteristics of the interference such as amplitude and shape differ from individual to individual. The acceleration is proportional to the vector sum of forces. Therfore, one can model this interference as additive random function :

Equation 1: signal model using random variables

The variable~ is a random variable and n is the time index, unstable parts of the signal and S(n, mechanisms that generate X(n
~,)and ~)

X(n,~)

represents the

represents the interference. The underlying
~)are

S(n,

not understood, they are assumed to be

correlated. It was determined using Least Mean Squares fillters that both stable and 10

ustable periods of the signal was not staionary for a fixed period of time. This is shown in Appendx 1. A common method of studying standing balance is to record motions, reaction forces and torques between the feet and the ground and forces acting externally to the joint. This is similar to the balance board used to obtain trajectories of the arms and neck. The effect of imposed perturbations (disturbances) on an individual standing exerting torque at the ankle, to balance, involves exerting counter torque. An unpredictable perturbation of the support surface (balance board) causes activation of knee and hip muscles. These sudden changes are manifested on the balance board accelerometer signal as sudden changes in magnitude and direction. The hypothesis is that in these periods the accelerometer signal will become discontinuous. Reaction to the perturbations takes approximately a tenth of a second, voluntary reaction time is approximately a fifth of a second, this is because time for the postural reflex is longer than a spinal reflex [ 14]. Therefore one expects the frequency content of the signal to reflect this change. The mechanism of postural reflex involves sequential organization over several muscle groups. The way the body harnesses the muscle groups changes in the context of their specific adaptation. For example if a small support structure is bombarded with larger perturbations, hip flexion is used to induce forces at the ground instead of ankle torque [ 14]. The statistical content of the accelerometer signal will change as a direct consequence. The ability of the subject to re-establish stability is also affected by role and pitch. Leg and trunk muscles reaction appears dependent on vestibular signals. For example,

11

ankle torques for almost all perturbation directions were aligned along the pitch plane [15], therefore the individual's response is dependant on the pitch of the balance apparatus.

The Hypotheses are summarised in Table 1

Manifestation

Interference

Discontinuities

Frequency Content
Reaction to the perturbations takes approximately a tenth of a second voluntary reaction time is approximately a fifth of a second [13], this is because time for the postural reflex is longer than a spinal reflex [13] Therefore one expects the frequency content of the signal to reflect this change

Statistical Content
The way the body harnesses the muscle groups changes in the context of their specific adaptation

Physiological Mechanism

The muscle synergy responsible for balance cause movement, this is manifested on the balance apparatus

Sudden changes are manifested on the balance board accelerometer signal as sudden changes in magnitude and direction, due to activation of knee and hip muscles

Result

This interference makes developing a segmentation algorithm challenging

Hypothesis is that in these periods the accelerometer signal will become discontinuous

Therefore the statistical content of the accelerometer signal will change as a direct consequence

Table 1: Hypotheses Summary

12

Chapter 3
3.0 Theory
3.1 Time Domain
Time-domain analysis is the study of the temporal characteristics of a signal over a prescribed period of time. Typical tools used in time-domain analysis include integration, differentiation, finding the correlation of two signals and using differential equations to describe a physical process. Linear, time invariant systems (LTIS) are integral to many signal processing applications such as filtering. These systems can be characterized by their response to the Dirac impulse defined as [16]:

h(t) =L{o(t- u)}
Equation 2: response to the Dirac impulse defmed

L represents the response of the LTIS to the Dirac impulse. By using this impulse response, one may find the response of the system on a particular signal. This operation is referred to as a convolution, which is essentially the integrated product of two functions that have been time shifted over an observation time range.
+oo

L{f(t)}=

Jh(r)f(t --r)d-r

-oo

Equation 3: convolution integral

13

When a continuous signal is sampled at a period T, it becomes a discrete signal. If the signal is band limited and sampled at twice the bandwidth, the signal can be reconstructed without loss of information. Uniform sampling of the function f may be modeled as a weighted Dirac sum:

00

Lf(nT)8(t- nT)
n=-oo

Equation 4: Uniform sampling of the function/

The signal is now an array of numbers. This allows computers to process the signal information without the realization of a physical system. Many operations are analogous in both domains, like convolution [ 16-18]:
00

L{f[n]}= f[n]

* h[n] =I,

f[k]h[n- k]

Equation 5: discrete convolution

Operations like derivatives and integrals can be simulated. This is done with difference equations; tools used to represent digital systems are operations that involve delay. For example, one may now represent the process of averaging as follows [ 17-18]:

n+N

L{f[n]} = L,J(p) = f(n)*(u(n+N)-u(n-N))
p=n-N

Equation 6: averaging in convolution form

14

3.2 Fourier Analysis
Frequency analysis is based on the fact that one can express an arbitrary periodic function as an infinite series of appropriately weighted sinusoidal functions. Fourier series is used to analyze periodic functions. The basic functions are {sin(kx), cos(kx) } (which are orthogonal) and the complex exponential exp(ikx) is used to simplify the calculations.

Equation 7: discrete complex weight coefficients

The inner product maps the magnitude or energy of signal into discrete complex weight coefficients { Dk } . The magnitude represents the "weight" of the sinusoid with frequency k*ro. The phase information can also be used.
00

Xr

(t)
k=-oo

D e Jkmt
k

Equation 8: functions expressed as weighted sinusoidal functions

To represent non-periodic functions, we use Fourier transforms which are an extension of the Fourier series and are an example of an integral transform. The function X( co) is the spectral density, a continuous distribution of the sinusoid.

15

-too

X

(m )
-

Jx
00

(t )e -

1 (j)

1

dt

Equation 9: Fourier Transform

X(c.o) is a complex function so its magnitude and phase are usually studied. The inverse transform follows:

X

(t)

1 -J X 21!
+ 00
-00

( m) e

jmt

dm

Equation 10: Inverse Fourier Transforms

Fourier transforms can also be used in discrete signal analysis, where it transforms the discrete time signal into a continuous function of c.o .

I, g(n)e-Jmn
n=-oo

00

Equation 11: Discrete Time Fourier Transforms

The new function is periodic from

-1t

to

1t,

if the spectrum is filtered at that

bandwidth with a (rect(ro)) it will become continuous in time. The inverse transform is from
-1t

to 1t. One may gain new insight to operations such as averaging as follows.

16

f[n]*(u(n+ N) -u(n- N)) H

sin((N + _!_ )m) 2 f(m) sin(m)
2

Equation 12: Averaging in frequency domain

Averaging simply attenuates the higher frequencies of the signal. The function can also be constructed via the following formula [17-18]:

g(n) = - G(eim)eira dm

1

+7!

21C

J

-1!

Equation 13: Inverse Discrete Time Fourier Transform

The Discrete Fourier Transform (DFT) was implemented by uniformly sampling N discrete points on the spectrum. The basis functions are discrete sinusoids. An important fact in performing operations such as convolution, is that the DFT treats x[ n] as a periodic function of period N.

D[k]

= -L x[n]e- 1knn
} N-1 .

N

k=O

Equation 14: Discrete Fourier Transform

3.2.1 Z Transform

When analyzing a discrete system the Z transform is used. The Z transform is analogous to the Laplace transform and is defined as:

17

H (z)

=

L,
n =
-oo

00

h[n]z-n

Equation 15: Z transform

The region of convergence for a causal stable system is the interior of the unit circle in the z-plane. One important identity is:

(v(n)) J.. 2 t 2 =

~ (v(n) + (-l)"v(n)) < <-~rasform

{

~ Jv(z)+ V(-z))

Equation 16: down sampling up sampling Z transform identity

For completeness, the inverse z transform is defined as follows [19]:
x [ n] =

Equation 17:inverse z transform

3.4 Time Frequency
Time Frequency analysis deals with the correlation of a signal with a family of waveforms that are well concentrated in time and frequency. These waveforms are denoted by time- frequency atoms, denoted by the set

{;r }rer'

where 'Y is an index

parameter. It is assumed that 11;11 =1 and (br e L2 (9{) . The linear time frequency transform can be defined as:

18

00

Tf(y)

= Jf(t)¢J* r(t)dt =(f,¢Jr)

Equation 18: linear time frequency transform

The inter-product (f,¢Jr) can be interpreted as a distribution on the time frequency plain (t, co). The down side of much of time frequency analysis is that the resolution in time decreases with an increase of resolution in frequency and vice versa, as illustrated by Heisenberg uncertainty Theorem [16].

3.4.1 Windowed Fourier Transform

Gaber introduced the Windowed Fourier Transform in 1946, it consisted of a signal correlated with a real symmetric window (g(t)=g(-t)) translated by u and modulated by the frequency ~:
00

Sf(u,~) = Jf(t)g(t -u)e-i9 dt = (f,g"·')
Equation 19: Windowed Fourier Transform

With the following condition imposed:

llgll =1 and

gu ,(

&f e L2 (9t) [16-20] .

19

3.4.2 Wavelet Transforms

Wavelet Transforms offer different time frequency atoms. They decompose the signal into basis that are dilated and translated. The Wavelet Transform at time u and scales is:

Wf (u, s)

Equation 20: Wavelet Transforms

To measure time evolution of frequency transients complex analytic Wavelets are used.

In order to detect sharp signal transitions real Wavelets are used [20].

The magnitude of the Wavelet Transformer is a distribution referred to as a Scalogram. It is helpful in identifying signal characteristics at different points u and s. The energy function is defined as the square of the magnitude of the Wavelet Transform:

E (u , s )

=

I

Wf

(u , s )

2

1

Equation 21: Magnitude of the Wavelet Transform

The distribution of energy in the Wavelet Transform offers insight to where the energy of the signal is located in time and frequency. The peaks of the Wavelet Transform offer a view of the temporal evolution of the frequency content of a signal. This is because the wavelet has a finite duration unlike the sinusoidal waveforms that make up the Fourier

20

Transforms. Figure 5 shows a sinusoid waveform that decreases in frequency at time 600. Notice that the Scalogram peaks (wavelet modulus maxima) shifts from 200 to 400 at about the same time. The phase of the Wavelet Transforms reveal the location of peaks in the Scalogram and the location of frequency shifts in time[16],[20].

a) Artificial Signal

':
100 200

iA A 'A (\
DJ
-400 500 600 700

·~ ~ 'A f\ 'A ~ :
1000 1100

-O-~ WI-I-~~~~~..,J.....~.....· I-. l\J-4L i- \l __,)._ -\1~ .-~ lf \~ l~ \llJ~ o!.l- -\i\1
--V.L\l

c) Phase Continuous Wavelet Transform Complex Gaussian 4th derivative

20
Q)

(i

t.l40
60

Figure 5: a) signal b) magnitude ofCWT c) phase of wavelet transform

Singularities detection is also an important application in wavelets, the number of vanishing moments of a wavelet is key in determining performance in detecting singularities. Consider a signal f that contains a singularity. Let the signal f(t) be composed of two sub signals:

21

Equation 22: f(t) be composed of two sub signals:

The first sub signal Pv(t) is m times differentiable in the neighbourhood [v-h,v+h] and hence contains no singularities. Taylor expansion of the signal lead to the following expression:
Pv(t)=

I f*~v) k.
k=O

(t-v)*

Equation 23: Taylor expansion of sub signal

The second part of the signal defined as Ev(t) contains the singularity. If a wavelet has n vanishing moments the following condition holds for all values of k:
00

Jtklj/(t)dt =0
O~k~n

Equation 24: wavelet that contains n vanishing moments

Therefore, the Wavelet Transform using a wavelet that contains n vanishing moments of the signal f(t) is[ 16]:

Wf ( u , s )

= W Ev(u,s)

Equation 25: Wavelet Transform of a singularities

It can be shown analytically that the singularities can be detected by finding the
abscissa where the wavelet modulus maxima converge at a finite scale [16]. This property is demonstrated in Figure 6. Notice that as the scale of the transform increases the energy

22

becomes more dispersed. The following is an example of a wavelet with vanishing moments, known as the Complex Gaussian wavelet. The Cp term is a polynomial, pis the order [16],[20]:

Equation 26: Complex Gaussian

a) Delta function

.

.
-

0.5

0~--~·--~·~--~·--~·------·---·------·--~·----~·--~·--~

100

200

300

400

500

600

700

800

900

1000 11 DO

b) Magnitude of Continuous Wavelet Transform Complex Gaussian 4th derivative

20
co 40
(.)

Q)

(J1

60 80
100

200

300

400

500

600

700

800

900

1000 11 00

Figure 6 :a)delta function b) the magnitude of is wavelet transform

Discrete Wavelets are similar to continuous Wavelets, but the scale a and the location parameter b are measured in discrete intervals. The Wavelet used must be Orthogonal in translation on itself and in dilation, the Discrete Wavelet is defined as:

23

where ~ c L (9\)
2

and

f e L2 (9\) , the functions l/Jj ,n is known as the scaling

function and forms an orthonormal basis for the space Vj , although there are many important properties of the subspace vj one of the most important is, vj c vj-1 . This means that any function in the subspace Vj can be written in terms of a linear combination of the function in the subspace Vj_ 1 resolution we can construct a function in
~
·

If we assume that

Vo

is the finest

as follows:

~2

1

t ~¢'(-)

2

~ = L.th[n]¢J(t-n)
~-

. h[n] = wtth

(1

~2

t ) ~¢J(-)¢J(t-n)

2

Equation 31: definition of scaling function filter

It is helpful to think of the set of functions Vj_ 1 as "skinny function" and the set of

functions Vj as their "fat cousin function". The actual wavelet functions also have a subspace associated with them denoted by Wj with its own projection operator Pw1
Pw1 / =
:

fb}n]~j.n
n=-

with b}n] = f(t)<{Jj,ndt

j

Equation 32: projection of function onto wavelet subspace and projection operator

Equation 33: wavelet

An important property is ~ c Vj_ 1

,

which is used similarly to the scaling function to

define the following property.

26

v2

1

t ~qJ{-)

2

=

~g[n]~(t-n)
n=-oo

~

where g[n] =

(1 v2

t ) ~qJ(-)~(t-n)

2

Equation 34: definition of wavelet of filter

If g(m)

= e-imh(m+ 1r)

it can be shown that the wavelets and the scaling functions can

form an orthogonal basis of vj-1"
Haar Wavelet 1.5

J
0 -Q.5 -1 -1.5 0 0.2 0.4 0.6 0.8 1.2 1.4

Figure 9: Haar Wavelet

The relationship between the wavelet and scaling function is important because it allows you to obtain the projection on the subspace on
Vj_ 1 · Vj

and

~

only with the projection
bj+ 1

One can obtain

aj+1

[n] known as the approximation coefficients and

[n]

known as the detail coefficients with just a} n] . A simple derivation to show that b1[ n],
a1[n] can be obtained froma 0 [n] is quite insightful, the

detail coefficientsb1[n] are

defined as:
bl[k] =
1 ,-;:Joo
-oo

( - 2k f(t)qJ(--)dt

v2

2

27

Equation 35: first detail coefficients

because

~ c

Vo it may be written in a series expansion of the scaling function at a larger

resolution :
1 f- 2k ~ { t/J(u- n) 1 U - 2k ~ cp(--) = £.J ~ cp( )du
00

f

v2

2

n--oo

-

-oo

v2

2

f
00

(t- n)
x=u-2n

oo{ lf)(x- (n- 2k)) .J2 1 =~ qJ(~)L Jf)(t- n) =."fg(n- 2kytJ(t- n)
00

b1[k]

=Jf(t) !g(n-2k)¢J(t-n)dt = !g(n-2k) Jf(t)f/J(t-n)dt = !g(n-2k)a0 [n]
n=-oo k=-oo k=-oo

[20] A similar relationship holds for the scaling function

a1[k]

=

r;::- f(t)t/J(--)dt

1

f

v2

t-2k 2

Equation 36: approximation coefficients second iteration

because

V.

c

Vo

the scaling function can be written as a linear combination of the scaling

function of the smaller scaling. The weight is simply the inner product

v2

1 f - 2k ~ t/J(--)

2

~{ = £.J
n=-oo

t/J(u- n) ~ t/J( -oo v2

foo

1

U -

2k )du 2

f

(t- n)
x=u-2n

= .~{lf)(x- (n- 2k)) ~ f)(~+xf)(t- n) = .~h(n -2kY(J(t- n)

Now by inserting into the above a 1[k] 28

a1[k]

= Jf(t) fh(n-2k)¢J(t-n)dt = fh(n-2k) Jf(t)l/J(t-n)dt = fh(n-2k)a 0 [n]
n=-oo n=-oo n=-oo

a0 [n] can be approximated by the samples of the signal. Figure 7 shows how to obtain

b1[ n] , a 1[ n] , which can be implemented in hardware or software by simply convoluting with the filter h[ n] and g[ n] and down sampling the results. The process can be repeated

An important property of this associated subspace is that vj-]

= vj E9 wj .

This

implies that the scaling function and wavelet at resolution j spans the subspace by the scaling function j-1, symbolically:

~~foot/i.._u-n)-¢1.:_-)duu-2k ~-2k). ~~foot/i._u-n)-(/i.:-)du u-2k -~-2k) (ft/i._u-n))=-vL. /({A..--) +V2 f-cp.._--)
' k
-oo

J2

1

2

11 ( J2 '

2

k

-oo

J2

1

2

1( 'J2 1

2

a j [n]

= Lh(n- 2k)a j+I [k] + Lg(n- 2k)bj+I [k]
k k

a0 [n] can be obtained by putting zeros between each sample ofb1[k], a1[k] convolving

the resulting signals with the filters h[n] and g[n].
A[nl

Figure 10: filter banks

29

The output after up sampling and filtering is referred to as the Averages Aj[n] and Difference Dj[ n]. The averages contain the low frequency components of the signal and the difference contains the high frequency components of the signal. One can also construct wavelets by using the proceeding filter banks relationship. Using the Z transform the following relationship can be obtained [23]:
H(z)H(z)+G(z)G(z)

= 2z-1 H(-z)H(z)+G(-z)G(z) = 0

Most scaling and wavelet functions are not useable for many applications as they are not smooth or they have poor frequency resolution and the filters do not have a finite impulse response causing phase distortion, so most practical wavelets are Biorthognal. In many cases there is no close analytical expression for the wavelet or scaling function, but one can express them in terms of the filters [16],[21]:

30

Scaling function (time or space)
Approximations of the scaling 116lction db2 for 1 to 5 ~erations 1.4 1.2 1

Wavelet function (time or space)
Approximations of the V\11\elet db2 for 1 to 5 ~erations

\

l

2

1.5

1 0.8 0.6 0.4 0.2 0 -0.2 0.5

j

!\\
~A--- /
/

ol...._

"
/
0.5 1 1.5 2

.... ......,

____
3

-0.5

--0.5 1 1.5 2

-1

-0.40

2.5

-1.5 0

r
2.5

3

Approx imations of the scaling 116lction sym4 for 1 to 5 1.4 1.2 1

~erations

Approximations of the 2

V\ll~elet

sym4 for 1 to 5

~erations

1.5 I 1

I

0.8 0.5 0.6
I

0 ~- - - · - - - ""n<~~ .../ \ l
0.4 -0.5 0.2
I

,j
A

t

:---::,~'"--

~ --

t 1<'

I

~

'~

0 · -0.2

--1

_,

-~

-1

.'
1 2

0

2

3

4

5

6

7

-1.5 0

3

4

5

6

7

Table 2: different wavelets and scaling functions

One can construct wavelet bases that have vanishing moments. The definition of a polynomial of degree k is:
00

qk(t) = Lnk¢'(t- n)
n=-oo

Equation 37: polynomial of degree k

For this project Daubechies wavelets are used, for short dBk where k the number of vanishing moments, hence the projection of q2(t) on the db2 wavelet should be 0 and the projection of q3(t) on the db2 wavelet should not be 0 [16].

31

3.4 Non-Linear Filters for Low frequency Signal Segmentation

Treating the samples of a signal like an array, vector and matrix operations can be used to gain valuable insight into many signal characteristics. Consider a vector of dimension N defined by:

x =[x(O),x(l), ... ,x(N -l)f
Equation 38: samples of a signal in vector form

Each element of the vector consists of one sample of the signal. Consider matrix D defined by the following operation:

x(O)x(O) x(l)x(O) x(1)x(N -1)

x(O)x(1) .. x(1)x(1) ..

x(O)x(N -1)

x(N -1)x(N -1

Equation 39: matrix D

The elements of the matrix are specified as:

Equation 40: elements of the matrix D

The elements of D around the diagonal represent the cross-correlation between samples that occurred relatively close in time. The matrix D provides a helpful visual

32

tool in determining the temporal evolution of the signal statistics. Consider matrix D of the accelerometer signal shown in Figure 11, the red areas are where the signal is correlated with itself. These areas correspond to areas of instability.

A

2

3
sec

4 B

5

6

100
200
C\1

c

300

400
500

600 100
200 300
n1

400

500

600

Figure 11: signal m/s2(top) and image of matrix D red are the largest values (bottom)

These results suggest samples corresponding to periods of instability are closely correlated in an interval. A running average value of matrix D in a square area (2K+1)x(2K+1) should provide a measure of signal instability. Rather than calculating the products and then summing the elements of sub-matrix D, it can be readily shown that the following two expressions are identical:

33

s,(n) = ( 2K + 1 .,~K .,~:(n,,n,) =(( 2K +1 )tx(n+k)J 'k=-K
Identity l:sub-matrix summing

1

)2

n+K

n+K

1

2

A derivation of this identity is given below:

n+K

n+K

n+K

n+K

n+K

n+K

s(n) = L

Ld(n.,n2 )

=

L

Lx(n.)x(n2 )

=

L

x(n1) Lx(nJ
n2 =n-K

n1=n-K n2 =n-K

n1=n-K n2 =n-K

n1=n-K

=((x( n =((x( n -

K) + .. + x( n) + .. + x( n + K) )(( x( n - K) + .. + x( n) + .. + x( n + K)) K) + .. + x( n) + .. + x( n + K) )
2

=(kt/(n+k)

J

Short durations of positive and negative activity corresponding to high frequencies cancel out. Increasing the exponent from m=2 improves the results, thus leading to the following:

sm(n) =((

1 2K +1

J±x(n +k)Jm
'k=-K

Equation 41:non-linear averaging fdter

When m equals one, the new signal is simply a uniform discrete average. If the modulus of the argument in equation 40 is less than one, then sm(n) approaches zero exponentially. Similarly, if the value of the modulus is larger than one, the output approach infinity as m approaches infinity. Therefore, scaling of the signal may be

34

necessary depending on the type of implementation. Figure 12 shows the output of different values ofm, the 2K+l term was dropped out of the equation. When m equals one, the new signal is simply a uniform discrete average. The figure below shows the new signal of different values of m. if m is even, the new signal will be positive.

a)Y-component subject 2
C\1

- =B;g en

E

1

2

3
Samples b)New Signal m=1

4

5

6

C\1

-6
en

E -1

:

1

2

3
Samples c )New Signal m=2

4

5

6

~

C\1-

""'"en 2

E 0

1

2

3
Samples b)New Signal m=4

4

5

=:l
6

CX)

""'E "-

en 10 5 0

1

2

3
Samples

4

5

~ 6

Figure 12: output of non-linear filter for different values of m for subject 2

The unstable regions have relatively larger amplitudes and the signal is considerably smoother. This new signal will make segmentation much simpler by amplifying the desirable characteristics and attenuating undesirable characteristics, this can be quantified with time domain analysis and transform domain analysis. For

35

implementation the averaging interval we be denoted by K and the interval will be causal.

The generation of the larger amplitudes can be quantified with time domain analysis. Consider a causal implantation on the following signal:

sm(n)

=(~(AO(n-a+k)+ BO(n-b+k))

J

Equation 42: delta function input to non-linear filter

Where the delta function at point-a represents an event of interest of amplitude A and the delta function at point-b represents another event with amplitude B, as long as

K +a >b, the new signal will equal: sm(n) =Am(u(n -a+ K) -u(n-a))+ Bm(u(n-b+ K)-u(n-b))
Equation 43: response of delta function to non-linear filter

The above formula demonstrates that the amplitude of the new signal is related to m and that two delta functions must be K

+ 1 samples apart to be distinguished. The

signal output is shown along with the output equation.

sm(n) = (

~(20(n-4+k) +30(n -8 + k))

J

= 2m(u(n- 2) -u(n-4))+3m(u(n -6) -u(n- 8))

Equation 44:example of response of non-linear filter to a delta function

36

Original Signal

!t ~ :
1 2

3

4
I I

5

~ ~ :
I

6 7 8 New Signal m=1

9

: : ~ j
I

10

11

12

3 2 1 0

I

-

-

1

2
I

3
I

4

5 6 New Signal m=2

7

8

9

10

5 t0 1 2

-

3

4

5 6 New Signal m=4

7

8

9

10

50 0 1 2

3

4

5

6

7

8

9

10

Figure 13: output of new filter for different values of m

This difference is related to the frequency of the signal. Consider the following signals:

y(n) =sin( !E..n)(u(n- 20)- u(n- 40)) + 15 cos( 7r n) 10 3 Equation 45: signal composed of two sine waves

The high-frequency component has 15 times the amplitude of the low-frequency component. This has a masking effect which makes it difficult to detect the peaks in the lower frequency range in y(n). After applying the new filter shown in Figure 16, the peaks comprised of the low frequencies become more and more apparent as m increases. This suggests that the filter's frequency characteristics are not only associated with the

37

averaging interva12K+l but with the exponent parameter m. Fourier analysis illuminates the process:
sin(r(10 n) (u(n-20)-u(n-40))

<(

0 -1 10 20 30 n 15cos((r(3) n)

40

50

60

IIl

_:~[
10 10 0 -10 10

_ _ l _ __ _ _ L _ _

20

30 n y(n)

40

~-=
50 60 50 60

(.)

20

30

40

Figure 14a) low frequency part of signal y(n) b) high frequency component of signal y(n) c) y(n)
Sm(n) m=1 and K=3

c(

-~l
!f
X

:
5

:
10

:
15 20
·

:

:

:

25

30

35

40
·

45

' 50

;
1

n Sm(n) m=2 and K=3

'

'

m

:
5 10
4

:
15 20

:
25

:

:

:

30

35

40

45

50

10

n Sm(n) m=10 and K=3

0

;~

'

'
: :

_I____L_

5

10

15

20
·

25

30

35

40

~~l
45 50

Figure 15 a)s 1(n) for signal y(n) and b) s2(n) for signal y(n) c) s 10(n) for signal y(n) K=3

38

The discrete-time Fourier transform (DTFT) ofs 1(n) is [16]:
3{s,(n)}=5;(0J)=

.~((U: +l ~x(n+k) }-j"'
s~~)

=(-1-lY(m) sin((K +0.5)m)
2K+lr

Equation 46: discrete-time Fourier transform of St(n)

As K increases, the width of the main lobe of the spectrum decreases thus filtering out higher frequencies. Therefore, the ability to attenuate lower frequencies is determined by the value of 2K+1 the order of the filter. As the value of m goes to infinity, the DTFT for the new filter (with respect ton) converges to:

Equation 47: discrete-time Fourier transform of sm(n), for large values of m

Equation 48: normalization constant

S(m)

= s. (m)
c

Equation 49:normalized spectrum
1r

1-Ls

= JmS(m)dm
-Tr

Equation SO:mean of spectrum

39

1C

a s = f<m-JLs) 2 S(m)dm
-1C

2

Equation Sl:variance of function

The derivation is 46 given below:

Let n=

a "'mas
1
tr"

sm

a c rmu, =( ( J (J.
m

j-a

2

11" )

S(w)e rma. dw

w

Jm

Taylor series expansion of exp(u) gives:

£, LS(m)( m· 1C

Jl, )dm= 0

s
m

a (rma

s

]-(CJm( a2Jm - - 1- e jJ!~. a 27! 2m
40

m~oo( C

=

2K

)m

e-2 e Tma.

-a 2

j mJ.L, a

[23]

s (n) = m

C

)m
e

-n ma;
2
ejmj.L, n

2

( 2K

Now consider Sm(~) to be a continuous, complex-valued function of

se 9t

The Fourier transform then becomes:

The discrete-time Fourier transform becomes:

m

S

m - (21r )m-1

((J))

C

1
~

Le
00

-((l)-mJJs-2nif
2m0'2 s

210n a s

2

I=-«>

The equation shows that three parameters affect the spectrum: the variance, mean and the value of m. The mean and variance are related to the signal and the averaging window. If the signal is composed of higher frequencies, the mean will be larger and if

41

the signal is composed of a large range of frequencies, the variance will be larger. Assuming that the majority of the single energy is concentrated in the lower part of the spectrum, the size of window 2K+1 will be inversely proportional to mean and variance. A small variance ensures that the effects of spectral overlap are small. The equation also shows that the spectral characteristics are not only determined by the order of the difference equation but by the parameter m. This is shown below with several signals,

the closed form expression for the mean is derived in appendix 2.

z1(t) =cos(-t 2 ) ~ m. (t) =- t
500 250
Equation 52:chirp function
A

1!

1!

: ~-.---1 L _ - - - ' - - - - - ' - - - - - - ' - - - ' - - - - ' - - - - - L - - - - - l -80 -60 -40 -20 40 80 60 0 20

n B

-60

-40

-20

0
n

20

40

60

c
40 sof 30
20
10
L _
________j__ _
___J___

___j___....J

-

-60

-40

-20

0
n

20

40

60

Figure 16:a) z1(n) b) s4(n) of z1 (n) for K=4 c) s30(n) of z1 (n) for K=4

42

A

~~
30 20
10

-3

-2
·

-1

:
2

'l
3
A -1t!>ro:s;1t B

-3

-2

-1

0 B -n:!>ro!>1t

2

3

c
400
200

-3

-2

-1

c

0 -1t!>(J):s;1t

2

3

Figure 17:a) Z 1 (ro), b) S6(ro) of Z 1 (ro) with for K=4 c) S30(ro) of Z 1 (ro) with K=4

Figure 18 shows a unit step function corrupted with additive Gaussian noise with power 0.5 dB symbolically represented as z2(n). Examining Figures 18(c) and 18(d), as m increases the amplitude of the step function increases while the noise is attenuated. The output also appears sharper as m increases and Figure 19 shows the spectrum for increasing values of m. It is evident spectrum tends to be of Gaussian shape.

43

A

2 1 0

_l_

50

100

150

200

250
n 8

300

350

400

450

500

_

~ ~;,I
r

1 t1 11 I

r ·:

~

' I

~

'.

;_ ~ "\I I
:·'' I

50

100

150

200

250
n

300

350

400

450

·' :

·~
500

c

1~
50
X

100

150

200

250
n D

300

350

400

450

~

10

9

I __

__j_

50

100

150

200

250
n

300

350

400

450

Figure 18:a) u(n-245)- u(n-255) b) z2 (n) c) s6(n) of z2 (n) for K= b) z2 (n) d) s6(n) of z2 (n) for K=4
A

'

L;,

,'

.,1 I '

·[·.·'

!t.

· ··

l.,

I

lr I,J,

I

,I

llj,,l

,I

d I

I

I

I.

·,l,l

1 ',

11 1,,

.l
-

1

-3

-2

-1

0 A -1t$(0$1t B

2

3

300 200 100 -3
X

-2
9

-1

0 B -1t$C0$1t

2

3

10

c
-

9 r-

8

-3

-2

-1

0

2

3

c

-1t$ co$ 1t

Figure 19: spectrum of signal for different values of m, it is evident that as m increases the spectrum approaches a Gaussian shape a) Zz (m) the DTFT of the original signal, b) S6(m) with K=4 Zz (m) for K=4 c) S30(m) of Zz (m) with K=4

As m gets larger, the spectrum of the signal approaches a Gaussian shape. This means that most of the energy is centralized in the lower frequencies and thus accounting

44

for the relative increase in the amplitude in those locations.

Also, the width of the

spectrum is proportional to m so that the higher frequencies are attenuated and the sharp jumps created by a broad frequency range are preserved.

3.5 Vector processing

The accelerometer signal can be treated as a time dependent series of threedimensional vectors. Each component of the vector represents the acceleration in a particular direction. This is denoted by:

r(n)

=[x(n),y(n),z(n)Y

Equation 53: time varying vector

Vector processing has been used in image processing and has several advantages, it does not disregard the correlation between vector components, a variety of vector filters can be created, and results tend to be better than normal methods [24]. Spherical coordinates are commonly used in describing three-dimensional tracking. The coordinate system is shown below [25]:

45

z
r

.l

Figure 20: relationship between Cartesian coordinates and spherical coordinates system, bold arrows indicate new unit vectors

Calculating the accelerometer in not important but using many of the parameters is useful in segmenting the signal. The magnitude of the vector may be used:

Equation 54:magnitude of time varying vector

The angle from the z-axis to the xy plane may also be used this angle reflects the pitch:

¢J n) =tan

(

-~(~x(n)2 + y(n)2
z(n)

J

Equation 55: angle from the z-axis to the xy plane

3.6 Algorithms

Three algorithms were created to detect periods of instability. These algorithms used the continuous wavelet transform.

46

Stable periods of the signal are characterized by small amplitude motions and sharp sudden movements. Unstable periods are characterized by large amplitudes, long motions littered with sharp transitions caused by the subject suddenly shifting. Sometimes these had extremely short periods of instability. The movements of the subject manifest themselves on the balance board accelerometer: stable periods as a low amplitude high frequency signal, unstable periods as a low frequency signal littered with sharp discontinuities and short periods of instability consisted of sharp almost discontinuous high amplitude motion. The algorithms were developed to adjust for these changes.

3.6.1 Time frequency Based Algorithm

Analysis with Windowed Fourier Transform also proved difficult, although the difference between stability and instability was evident. On inspection, there were many practical issues, such as the window edges which interfered with the segmentation algorithm and too much energy was located at the lower frequencies. Also the signal was not stationary for a constant period of time; this would have to be taken into account when choosing a window size because the signal must be stationary in a given window. The high frequency motions of the stable portions of the signal appeared in the low scales of the Scalogram. Periods of instability were evident in all scales; longer periods of instability had the majority of the energy distributed in the lower scales. For analysis purposes the scales of the transform that provided the best results were used for

47

the subjects tested. Analytic wavelets proved more accurate in detecting long periods of dynamic activity, the phase proved useful in finding short periods of instability.

The complex Gaussian and the Morlet wavelet were tested. The Morlet wavelet was used because it could detect changes in frequency and the Gaussian was used because of its ability to detect discontinuities. The Gaussian was used at the end because the Scalogram was smoother. Changing the number of vanishing movements did affect the characteristics of the Scalogram but not the segmentation period.
a)Y-Component Subject 2

0.1
0
~

e -o.1
-0.2
100

200

300

400

500

600

b) Magnitude of Continuous Wavelet Transform Complex Gaussian 4th derivative

20
Q)

(ij
(.()

u

40 60 80 100 200 300 400 500 600

Figure 21: a) accelerometer signal y component b) Magnitude of CWT Gaussian

48

a)Y~ Component

Subject 2

0.1 0
N
(f)
~

E -0.1

-0.2 100 200 300 400 500 600

b) Magnitude of Continuous Wavelet Transform Morlet wavelet

20
Q)

(ij
(/)

u

40 60 80 100 200
300

400

500

600

Figure 22: a) accelerometer signal y component b) Magnitude of CWT Morlet

Multiresolution analysis had mixed results. It was apparent by examining the distribution of wavelet coefficients that the signal was unstable, but areas of sharp transitions in the signal that were not associated with unstable periods had a similar distribution. This is shown in Figure 23 where the unstable period between samples 100 and 150 had a similar distribution to that of sharp peaks between samples 230 and 250. The average of the signal was also very smooth, making it easier to use algorithms based on derivatives, but the amplitude of the peaks of stable periods was attenuated. Preliminary segmentation was not very successful so algorithm development focused on complex CWT.

?ROPERTY OF

49

RYERSO N UNIVERSITY LIBRARY

Signal (red) ahd Approximation blue at level 4 db1 0

-0.15 -0.2 -0.25
----~------''----~----'---~--"------''---'

100

200

300

400

500

600

Details Coelriclents

100

200

300

400

500

600

Scale of colors ftom MIN to MAX

Figure 23: Accelerometer Signal y component (top) and wavelet coefficients (bottom)

In order to segment periods of dynamic balance an algorithm with adjustable parameters was used to identify stable and unstable states, let

Lo represent the segmented

periods level zeros. Level one (Lt) and level two (L2) were more accurate but had a greater chance of missing periods of instability. All three levels used a numerical

approximation of the wavelet transform from one component of acceleration of the accelerometer signal, the range of scales were chosen to coincide with those scales associated with instability. For level one segmentation a new signal f(u) (in reality it's a discrete signal f(nu))was created. Each point in f(u) consisted of the maximum magnitude value of scale with respect to the point u.

50

Accelerometer Data (blue)& f(t) (red)

0 .9 0.8 0 .7 0.6 0.5 0.4 0.3
,-J'"' ~·1.1·,

II

-0. 1
100 200 300

400

500

600

Figure 24: f(u) red super imposed over signal normalized amplitude

After f(u) was obtained a simple threshold value of

mean of f(u) plus the

variance of f(u) was used to indicate when to begin the segmentation process. This segment region will be written symbolically as So. The segmenting would stop when the first local maximum of f(u) fell below the threshold value. This method did have drawbacks. If the subject was always unstable, the method would only classify unstable regions with the most intensity. Also if ratio of amplitudes of unstable regions to stable regions was too low the algorithm would misclassify periods of the signal. Adding the variance to the mean did make the segmenting more accurate.

51

a)Y-Component Subject 2 (blue)& Segmented Period Red

be manifested in the Scalogram in a range that could be detected using the Ievel-l segmentation algorithm.

0.5
In order to segment the peaks that were missed by the level one segmenting a new parameter was added. If the phase was 3 .14 for all scales in those ranges that period

-0.5
would be segmented. Figure 26 demonstrates this process. The green lines on the phase

100

200

300

400

500

600

plot represent the start and end of points of zero phase. Below the corresponding segmented portions this segment region will be written symbolically as St.The yellow regions are also sharp jumps in the signal but did not correspond to any signal activity.
P·iase of Wavele t Trasform Complex Gauss1 an

b) Magnitude of Continuous Wavelet Transform Complex Gaussian

20
Q)

(i;
(/)

40 60
80
10

u

100

200

300

400

500

600

20
30

Figure 25 a) normalized segmented period where red has a amplitude of one super imposed over signal b) magnitude of CWT

40
50
100 200

300

400

500

Accelerometer Data & segmented peri od s fu ll ph ase line g·reen & small scale phase line yello"'

I .
c
£

Figure 25 shows the segmented period and the corresponding Scalogram. The periods of instability corresponding 500 to 600 have been segmented, but the short period of instability from 105 to 130 has not been segmented. In order to segment these periods of short periods of instability the phase of the Wavelet transform was used. The phase of the WT provides information about the peak. Values of 3.14 specify a peak at that particular time and scale, because sharp signal transitions are composed of all frequencies they show up as peak at all scales. Depending on the signal factors that affected the threshold the short periods of instability may not have had enough energy to
Figure 26 :phase of CWT with different segmented period super imposed (top) signal with different segmented period super imposed (bottom )

I ..
100

200

300

400

500

600

52

53

a)Y-Component Subject 2 (blue)8t Segmented Period Red

b) Magnitude of Continuous Wavelet Transform Comple x Gaussian

20
(ij
(.)

G:l

40 60 80 100 200 300 400 500 600

(I)

Figure 25 a) normalized segmented period where red has a amplitude of one super imposed over signal b) magnitude of CWT

Figure 25 shows the segmented period and the corresponding Scalogram. The periods of instability corresponding 500 to 600 have been segmented, but the short period of instability from 105 to 130 has not been segmented. In order to segment these periods of short periods of instability the phase of the Wavelet transform was used. The phase of the WT provides information about the peak. Values of 3.14 specify a peak at that particular time and scale, because sharp signal transitions are composed of all frequencies they show up as peak at all scales. Depending on the signal factors that affected the threshold the short periods of instability may not have had enough energy to

52

The phase method works well for short periods of instability and offers excellent time localization, but for longer periods of instability the method failed. The failure may be because when peaks are close in duration the phase exhibits strange patterns, the final segmentation periods were: Segmented period using phase
Segment Periods using Phase S 1

L3
... ....
~~

.. ....

Wavelet Transform

----+

f(u) is obtain from the maximum magnitude of CWT

r---+

threshold value off(u) mean using plus the variance f( u)

---+

Segmented Periods using Magnitude S0

Lt

r-----+

Segment Periods using Phase S 1

(
~·

\

L2
I

~\J/

.. .

Figure 27: time frequency flow chart

Lt =So

L2 =S0 uS 1
L 3 =S0 nS1
Figure 28: different segmentation periods of time frequency algorithms

3.6.2 Non-Linear Averaging Filters Algorithm

The segmentation algorithm for the Non-Linear Averaging filter used a simple threshold value to segment the signal. A new signal was created using three components from the accelerator. This new signal was filtered via the Non-linear averaging filter. The

54

Chapter 4
4.0 Results and Discussion

All three components of the accelerometer signal were sampled at 100 Hz and loaded on to Lab View, the algorithms were developed and tested in Matlab. Five subjects took part in the study. The diagnostic accuracy was used as the main performance measure of the segmentation algorithms. In order to maximize diagnostic accuracy both sensitivity and specificity had to be maximized. The stable and unstable periods were segmented manually and the algorithms were tested. These parameters are defined below:
Variable Value

a b c b

Number of samples classified as unstable and that where designated as unstable Number of samples classified as unstable and that where designated stable Number of samples classified as stable and that where designated stable Number of samples classified as stable and that where designated unstable
Table 3: test parameters

57

Parameter Sensitivity

Value

--a+d a+b+c+d a -a+b d b+d

a a+c

Specificity

Diagnostic Accuracy

Positive Predictive Value

Negative Predictive Value

-a+c a+b+c+d

d c+d

Prevalence

Table 4: Values of Sensitivity, Specificity, Diagnostic Accuracy, Positive Predictive Value, Negative Predictive Value and Prevalence

4.1 Results of Time Frequency Algorithm
Looking at the Results for the three different segmentation algorithms using contuse wavelets transforms, the Complex Gaussian was used because it had the best results. The results suggest that simply using the magnitude of CWT maxtmtses diagnostic accuracy. This suggests that the signal ts discontinues during periods of instability. Multiresolution results were not included.

58

Period Sensitivity Specificity 0.931 0.662 0.838 Diagnostic Accuracy 0.810 0.653 0.491

Positive Predictive Value 0.891 0.665 0.423

Negative Predictive Value 0.757 0.624 0.505

Prevalence 0.479 0.515 0.530

Lo
0.691 Lt 0.615 L2 0.191
Table 5 mean value of different time frequency algorithms for five individuals

Mean Value Time Frequency
1 0.9 0.8 0. 7 c 0.6
~--~~---------=~~------~--------~

+-..,----"''----~'"""""-...:;:::----'-----;-;---::::.lllii:-:--..:.-...--------'-------1 +----~---:,;-- ---------~:;__..:.._,...-....,.._....._-+"""-..;;::--;:----.:---:-3-----1 +--·f'C---E-=-~~_;;;__.-..,-'-....._-=,..:..:..-...,;--,---~-------1

-L--4======~~5:jA~~~~~:::::::::~.....;~--,-:...._~_:_j

m 0.4 o.s ::E 0.3 0. 2 0.1

t=2t=~a~~~~~~§~::=::::::!:=J
+-~---" ;:--:.....:,:.....;=-=-~~:..:;;::._--'----=-:::=~-:-:-:--:-'--:-c:::-:-;:-~~__,
+-----::-·'----:--::-:c-:::----:-::-,.......,-,:--::-:---::-::=~-,--::--=:-----,-----.--~,....,.-t +-------------'--~~~~:..__~=------=---1
(I) (I) (I)

0 +-~--~-----,----'-~r-----~----~~--~

-~~(I)
CDCD> z .... Q..

Cti .2 ~ C) u cu

c:
(ij

0

(I)

>

Q..

~

Figure 31:mean value of different time frequency algorithms for five individuals

4.2 Results of Non-Linear Averaging Filters Algorithm
The optimal values of M was 4, the optimal threshold value was 0.1 and the optimal value of2K+1 was 9. These values for each subject are shown below.

59

L=9 M=4 Th=0.1 Subject 1 Subject 2 Subject 3 Subject 4 Subject 5 mean

Sensitivity 0.900 0.791 0.639 0.625 0.798 0.751

Diagnostic Specificity Accuracy 0.875 0.853 0.956 0.884 0.923 0.988 0.921 0.913 0.757 0.762 0.871 0.836

Positive Predictive Value 0.839 0.864 0.856 0.906 0.991 0.891

Negative Predictive Value 0.909 0.928 0.695 0.677 0.754 0.79279405

Prevalence 0.460 0.261 0.518 0.540 0.615 0.479

Table 6 best trial of non-linear filter algorithm

K' 5 6 7 8 9 10 11 12

Sensitivity 0.740 0.708 0.724 0.724 0.751 0.721 0.721 0.691

Specificity 0.926 0.929 0.931 0.929 0.921 0.932 0.932 0.931

Diagnostic Accuracy 0.829 0.818 0.826 0.825 0.836 0.825 0.824 0.810

Positive Predictive Value 0.890 0.891 0.895 0.892 0.891 0.899 0.900 0.891

Negative Predictive Value 0.79 0.778 0.791 0.787 0.793 0.777 0.776 0.757

Prevalence 0.479 0.479 0.479 0.479 0.479 0.479 0.479 0.479

Table 7: mean values of trials with different signal parameters

60

'CD

>
c

u;

:::::1

ca CP ::E

1 0.9 0.8 0.7 0.6 0.5 0.4 0.3 0.2 0.1 0 5 6 7 8 9 10 11 12
Kbar

-+- Sensiti\1ty
---- Specificity -.. Diagnostic Accuracy

--*- Positi\E Predicti\E Value
__._._ Negati\E Predicti\E Value - - - Prevalence

Figure 32: mean values of trials with different signal parameters

These results suggest that the variance of bandwidth is a key parameter in the signal segmenting process. Subject two had the most accurate segmentation results, with diagnostic accuracy ranging from 0.91 to 0.93, subject three had the least accuracy with diagnostic accuracy ranging form 0.65 to 0. 72. Figure 34 and Figure 35 show their output of the non-linear filter, the unstable areas and the segmented areas. It is evident that each unstable period has a spike of amplitude associated with it, the spike are most likely cased by activation of knee and hip muscles. The greater the duration between these spikes the more accurate the segmentation algorithm.

61

a)

i

0.5 0 s4(n) Stable Areas Segmented Areas 100 200

-~ n;
0

z -o.5 .
-1

e

300
b)r(n)Subject 2

400

500

600

0.25 0.2
C\1

fh .......

0.15 0.1 0.05
I I
·, 1

E

I

I ,
·,\,,

')'

I

I

I

I'

100

200

300

400

500

600

Figure 33: subject 2 a) output of non-linear filter, stable periods in red and segmented periods in green b) r(n)

i
0.5 0 s4(n) -0.5 . -1 Stable Areas Segmented Areas 100 200

a)

n;

-~
0

z

e

300

400

500

600

700

800

900

b)r(n)Subject 3 0.25 0.2
C\1

.......

fh

E
0.1
I'
,

;II
·
r~
i

,., I. I'·'
200 300

I

\\

100

400

500

600

700

800

900

l

Figure 34: subject 3 a) output to non-linear filter, stable periods in red and segmented periods in green b) r(n)

62

The raw acceleration signal was corrupted with noise and interference making it difficult to formulate a model of the signal. Using the output of the non-linear filter could be modeled using simple functions in one second intervals. These are summarized and compared below.

Function

How Parameters Affect Segmenting

How Parameters Relate Back to Balance

A)e-..wu(n) * K(u(n)-u(n- N))

A.: if the damping parameter gets to large the signal decays to fast and some periods are missed
N: is small the periods are missed K :if is to large many unstable periods are missed

l..
- reflect the ability to become stable, large values my suggest the individual is strong physical, perceptual and cognitive abilities - small values imply constant sudden motion N -reflect the change of acceleration, a small value of N means the individual is moving rapidly

B) e-..w

sin 2 (0n))

A.: if the damping parameter gets to large the signal decays to fast and some periods are missed, this term is proportional to m

0
Moving of the arms shifting of trunk may be manifested on the balance board. This my reflected in the signal as oscillations, this suggest that the individual is weak and must compensate

n: large values ofthe
modulating term effects the accuracy, using large values of m and K , negate this term

Table 8: Function used to model output of non-linear filter

63

0.9 0.8 0.7 0.6

s4(n) Function A A-=0.07 ,N=15

"ffi 0.5

.!:::!

i

E 0 z

0.4 0.3 0.2 0.1

0.1

0.2

0.3

0.4 Seconds

0.5

0.6

0.7

0.8

Figure 35: function A compared to output of non-linear filter s4(n) using subject 2

0.9 0.8 0.7
~
0

I

~--------------------~

;:~lion

B A=0.07 ,f.!=1Ti20 , .
-

-

0.6

"ffi 0.5

.!:::!

E

z 0.4
0.3 0.2 0.1 0
I

-

-

0

0.1

0.2

0.3

0.4 0.5 Seconds

0.6

0.7

0.8

0.9

Figure 36: function B compared to output of non-linear filter s4(n) using subject 3

64

4.3 Inverse Tangent Algorithm
The results for the Inverse tangent algorithm

Subject 1 Subject 2 Subject 3 Subject 4 Subject 5 Mean

Sensitivity 0.794 0.853 0.881 0.717 0.913 0.832

Specificity 0.915 0.940 0.652 0.906 0.928 0.868

Diagnostic Accuracy 0.859 0.917 0.771 0.804 0.919 0.854

Positive Predictive Value 0.888 0.834 0.731 0.9 0.953 0.861

Negative Predictive Value 0.839 0.948 0.840 0.732 0.869 0.845

Preva lence 0.460 0.261 0.518 0.540 0.615 0.479

Table 9: results for the Inverse tangent algorithm

The vector results show that changes in the pitch are important in segmenting the signal. This manifestation is difficult to analyse without referencing other data, therefore, they are discussed more in depth in comparative results.

4.4 Comparative Results
The results for the time frequency algorithm that performed best, the non-linear averaging filter with optimum parameters and inverse tangent algorithm are set out below. positive predictive value, negative predictive value and prevalence were also included.

65

Positive Diagnostic Predictive Sensitivity Specificity Accuracy Value Time Frequency Algorithm L1 0.691 NonLinear Averaging Filters Algorithm 0.751 Inverse Tangent Algorithm 0.832

Negative Predictive Value

Prevalence

0.931

0.810

0.891

0.757

0.48

0.921

0.836

0.891

0.793

0.49

0.868

0.854

0.861

0.845

0.49

Table 10 Comparative Performance of algorithms

1 -r-----:----........--....-----------,
0.9 -r----~F~~~~~---:------.:::-1 0.8 -1--~<r----f. =------'~!::ii21n---"---'----l
0. 7

+--9---_.:.;_~--::-:-::-:----'---~...---:-:-----l

--.-- Time Frequency Algorithm L1 --.- Non-Linear A\Eraging Filters Algorithm --.. ln\Erse Tangent Algorithm

0.6 0. 5
0.4

+-:-:--~__;;,_:_-:"':-':'-:-::-'-'--:--'-:--::--=-'-'--~-~----l
-+----'-'-::---;--"---:__,.,....-.---:---:-;-..,----;:-- - --'n"-:--1

+-...;...;.._,.-"--'--------'~-:-'---':""----::7-----';--:--';':-';;;-..;,..--,----f
--r--...:;.._,..~~~,--.,.--__.__,__....,.,..,-____.___;.__---,--..:.--=---1

0.3 0. 2 0. 1
0

+-'-----c:-:-~~--::----:;-;;:=---:-:---'------'-----:---:--:---=.::----l
- + - - - - . . , - - - - - " - - - - - - ' - - - - - , - - - - ' - - - - - - ' - ---1

+-_:...._--r------r-"---r--..,---.....,------l

Figure 37: comparative performance of algorithms

66

The similar performance between each algorithm suggests that the hypothesis is correct. The table below demonstrates how each algorithm amplifies the desirable

characteristics and attenuates the undesirable characteristics.

Manifestation Physiological Mechanism and Result

Interference
-the muscle synergy responsible for balance cause movement, this is manifested on the balance apparatus -this interference makes developing a segmentation algorithm challenging

Discontinuities
-sudden changes are manifested on the balance board accelerometer signal as sudden changes in magnitude and direction, due to activation of knee and hip musclesHypothesis is that in these periods the accelerometer signal will become discontinuous

Frequency Content
-reaction to the perturbations takes approximately a tenth of a second, voluntary reaction time is approximately a fifth of a second, this is because time for the postural reflex is longer than a spinal reflex -therefore one expects the frequency content of the signal to reflect this change [13] -only scales that are correlated with instability are used -the filter amplified the frequency content associated with the unstable periods

Statistical Content
-the way the body harnesses the muscle groups changes in the context of their specific adaptation -therefore the statistical content of the accelerometer signal will change as a direct consequence

Wavelets Non-Linear Averaging Filters

Inverse tangent algorithm

-only scales that are correlated with instability are used -samples of regions of instability are closely correlate in a interval this is amplified my the non-linear filter -correlation between vector components dissipates noise

-wavelets with vanishing moments are used -the filter does not totally dissipate frequencies assorted with discontinuities

activation of knee and hip muscles form the discontinuous , but also case a change in pitch

-unknown

-only scales that are correlated with instability are used -samples of regions of instability are closely correlate in a interval this is amplified my the non-linear filter -correlation between vector components amplifies periods of instability

Table 11: Comparative Performance Table

67

One interesting observation is that non-linear averaging and the angle output from the inverse tangent had similar results, this is shown below. The output of the filter

corresponds to changes in the pitch. Changes in pitch are caused by the force imparted by the feet pressing down on the balance apparatus, it is assumed that the activation of knee and hip muscles validating the hypothesis.

Normalized Output
S4(n)

0.9 0.8

q, (n)

0.7
0.6 0.5 0.4

0.3
0.2 0.1
0
1

I
11

1

:1 ,I
. Jj-'

II

1

~-· '

,I

I
) . · ' ....... '

0

100

200

300

400

500

600

700

Figure 38: non-linear averaging filter (blue )and the angle output from the inverse tangent (red) (normalized)

Building on the models of the signal above the damping parameter and the oscillations is key to the signals segmentation process. These may be useful in formulating measurable parameters used for diagnosis. These processes are reflected in

68

the time frequency algorithms and vector process algorithms, but it is difficult to formulate a model based on these parameters.

69

Chapter 5

5.0 Conclusion
It is apparent that as the population ages and becomes prone to injuries due to falls, loss of balance must be better understood. This thesis examined the response to perturbations on a balance apparatus and developed signal processing algorithms to segment periods of instability based on the acceleration vector obtained by an accelerometer on a balance apparatus. As an individual stands on a balance apparatus in a stable state, the individual uses complex muscle synergies, causing the balance apparatus to accelerate. These actions cause accelerations that are similar to acceleration patterns exhibited during an unstable state. Thus parameters like amplitude, signal energy and bandwidth are difficult to establish because the signal characteristics change so much from individual to individual, making it difficult to establish parameters to classify unstable states.
It was established that the signal could be segmented using vanishing moments via

time frequency analysis from CWT, but using discreet wavelet transforms with vanishing moments was not as effective. A non-linear averaging filter was also developed to segment the signal that amplified the areas of instability; this filter was also tested on generated signals. The behaviour of the filter was explained in the frequency domain, but results suggest that there are more underlying complex statistical properties.

70

An inverse tangent algorithm was also developed. This algorithm demonstrated that the correlation between vector components is important in segmenting the accelerometer signal. The models formulated suggest that a damping of the signal and the oscillations is key in determining the algorithms accuracy. The damping reflects the main process of stabilization and the oscillations may be regarded as interference. The next step is to see how factors such as age changes this parameter and records the changes of different systems of the body during unstable periods. The algorithms were tested with five individuals and were found that the Diagnostic Accuracy was over 80%.

71

Appendix 1- Least Mean Squares filters
Adaptive Filters are the practical counterpart to optimum filters, the primary mechanism of functionality is reducing the mean squared error of the desired response
y(n,~) with respect to the input signal x(n,~) . The learning curve is the mean squared

error average across all realizations and measures the performance of the adaptive filter and is defended as

J (OJ;n) =E {

y( n, () - OJT ( n)~( n, ()}

(A.l.l)

The value of vector omega must be determined to minimize the learning curve. This learning curve can be minimized implicitly, but for practical considerations in is done using a search method like Newton Raphson method that determines the valued of omega the minimizes mean squared error.

OJk =mk=I +uVJ(m;n)(A.l.2)

The gradient in with respect to omega and k is the index of iteration, and u is a constant dependent on the particular search method used. Recursive least squares was used because the convergence rate is only dependent on the filter order M, and can be found by 2M+ 1. The actual search method can be written as:

72

W: =mk=I + R-1x(n)e(n) (A.l.3)
R is the autocorrelation matrix and e(n) in the error. If ~is a delayed version

y and the learning curve suddenly diverges after a

period of steady state operation the signal is no longer stationary. It was fond the learning curve of the RLS increased during periods of instability, but was much less effective then other methods. Because the learning curve never converged the signal was regarded as unstable.
Accelerometer Data X

0.1
0
-Q.1

100

200

300
Learning Cun.e RLS

400

500

600

I I'

50

100

150

200

250

300

350

400

450

500

550

Figure A.l.3 RLS learning curve subject 1

73

Appendix 2-Derivation of Mean

Jl, =

~ mX(m)sin([K +~.s]m) dm
-n

J

sinh-)

1 J!( ~ ( ) -jon sin([K + 0.5 ]m) d =m~xne m

C -n
00

·~

sin(~)
] )

L x(n) fmstn = n=-oo
1( ·

([

K +0.5 m e-jondm

C

-1r

. Sln

(m) l

00

= n=-oo
00

L x(n)

c

f- m ejw(K+O.s) _. e-jw(K+0.5) e- .ondm
1r

1

-1(

(1- elw)e

-j!!!..
2

-expanding by geometric series

= n=--C
21tj

Lx(n)

fm(ejw<K+t> -e-jmK~-jonLejapdm
1(
00

-1(

p=O

=-

oo ( oo ( -1)-n+p+K Lx(n) L - - - - - - C n=-p=O (-n+m+K)(-n+m+K -1)

J

this can be solved numerically

74

Bibliography
Winte, D. A. "Human balance and posture control during standing and walking." Gait & Posture 3 (1995): 193-214.
[2]

[I]

Culhane, K. M., D. Lyons, G. M. Lyons, and M. O'connor,. "Accelerometers in rehabilitation medicine for older adults." Published by Oxford University Press on behalf of the British Geriatrics Society (2005)

[3]

Mayagoitia, Ruth E., Joost C. LOtters, and Petter H. Veltinkand. "Standing balance evaluation using a triaxial accelerometer." Gait & Posture 15 (2002): 55-59.

[4]

Adlerton, Anna Karin, Ulrich Moritz, and Rolf Moe-Nilssen. "Forceplate and accelerometer measures for evaluating the effect of muscle fatigue on postural control during one-legged legged stance." Physiotherapy Research Intemationalm 8 (2006): 187-99.

[5]

Hwang, J. Y., J. M. Kang, Y. W. Jang, and H. C. Kim. "Development of Novel algorithm and real-time monitoring ambulatory system using Bluetooth module for fall detection in the elderly." Annual international conference of the IEEE-EMBS 26 (2004).

[6]

Doughty, K., R. Lewis, and A. Mcintosh. "The design of a practical and reliable fall detector for community and institutional telecare." Telemed Telecare 6 (2000): 15054.

75

[7]

Dt'az A, Prado M, Roa LM, Reina-Tosina J, Sa'nchez G. "Preliminary evaluation of a full-time falling monitor for the elderly." Proceedings of the 26th annual international conference of the IEEE-EMBS (2004) p. 2180-3

[8]

Bourke, A. K., and J. V. O?Brien. "Evaluation of a threshold-based tri-axial accelerometer fall detection algorithm." Gait & Posture 26 (2007).

[9]

Tamara, M. E., V. Nijsen, J. Pierre, G. M. Cluitmans, A. Griep, and M. Aarts. "Short Time Fourier and Wavelet Transform for Accelerometric Detection of Myoclonic Seizures." Belgian Day on Biomedical Engineering IEEE/EMBS Benelux Symposium (2006).

[10]

Nijsen, T. M., R. M. Aarts, A. Arends, and P. J. Cluitmans. ", Model for arm movements during myoclonic seizures." International Conference of the IEEE EMBS. Cit'e Intemationale. Lyon. France (2007): 1582-585.

[11]

Nijsen, T. M., A. J. Janssen, and R. M. Aarts. "Analysis of a wavelet arising from a model for arm movements during epileptic seizures." (2007).

[12]

Ting, L. H., and J. M. Macpherson. "A limited set of muscle synergies for force control during a postural task." Nero physiology 93 (2005): 609-13.

[13]

Avella, D., and A. Bizzi. "Shared and specific muscle synergies in natural motor behaviors." Proc. Natl. Acad. Sci. USA 102 (2005): 3076-081

[14]

Balasubramaniam, Ramesh, and Alan Wing. "The dynamics of standing balance." Trends in Cognitive Sciences 6 (2002): 531-36.

[15]

Carpenter, Mark G., and John H. Allum. "Derectional sensitivity of strtch reflexes and balance corrections for normal subjects in the role and pitch planes." Experimental brain research 129 (1999) 93-113.

76

[16]

Stephan Mallat. "A Wavelet tour of Signal Processing.", Academic Press (1999) Dimitris G. Manolakis, VinayK.Ingle, Stephen M.Kogon. "Statistical and Adaptive Signal Processing." McGraw Hill Books (2005)

[17]

[18]

Rangaraj M. Rangayyan. "Biomedical Signal Analysis: A Case-Study Approach.", IEEE Press Series on Biomedical Engineering (2002)

[19]

Sanjit K. Mira. "Digital Signal Processing a computer Based Approach.", Me Graw Hill (2005)

[20]

Mallat, Stephan. "A Theory For Multiresolution Signal Decomposition: The Wavelet Representation." IEEE Transactions On Pattern Analysis And Machine Intelligence 2 (1989).

[21]

Dwight E Mix, Kralg J. Oleniczak. "Elements of Wavelets for Engineers and Scientists.", Wiley & Son (2003)

[22]

Rou D. Yates, DavidJ. Goodman. "Probabilaty and Stocastic Processes.", Wiley & Son (2005)

[23]

Alberto Leon Garcia. "Probabilaty and Random Engineering.", Wesley Publishing Company (1994)

Processes for Electrical

[24]

Rastislav Lukac, Bogdan Smolka, Karl Martin,Konstantinos N. Plataniotis, and Anastasios N. "Venetsanopoulos Vector Filltering for Color Imageing." IEEE Singal IEEE Signal Processing Magazine (2005)

[25]

William F. Riley, Leroy D. Sturges."Engineering Mechanics Dynamics.", Wiley & Son (1996)

77


