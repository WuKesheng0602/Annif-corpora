Ryerson University

Digital Commons @ Ryerson
Theses and dissertations

1-1-2012

High-Power Multimodular Matrix Converters and Modulation
Jiacheng Wang
Ryerson University

Follow this and additional works at: http://digitalcommons.ryerson.ca/dissertations Part of the Electrical and Computer Engineering Commons Recommended Citation
Wang, Jiacheng, "High-Power Multimodular Matrix Converters and Modulation" (2012). Theses and dissertations. Paper 1696.

This Dissertation is brought to you for free and open access by Digital Commons @ Ryerson. It has been accepted for inclusion in Theses and dissertations by an authorized administrator of Digital Commons @ Ryerson. For more information, please contact bcameron@ryerson.ca.

HIGH-POWER MULTIMODULAR MATRIX CONVERTERS AND MODULATION
By

Jiacheng Wang

B. Sc., Shanghai Jiao Tong University, Shanghai, China, 2001 M. Sc., Shanghai Jiao Tong University, Shanghai, China, 2005

A dissertation presented to Ryerson University in partial fulfillment of the requirements for the degree of Doctor of Philosophy in the program of Electrical and Computer Engineering

Toronto, Ontario, Canada, 2012 © Jiacheng Wang, 2012

Author's Declaration

I hereby declare that I am the sole author of this dissertation. This is a true copy of the dissertation, including any required final revisions, as accepted by my examiners.

I authorize Ryerson University to lend this dissertation to other institutions or individuals for the purpose of scholarly research.

I further authorize Ryerson University to reproduce this dissertation by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

I understand that my dissertation may be made electronically available to the public.

iii

High-Power Multimodular Matrix Converters and Modulation
Jiacheng Wang Doctor of Philosophy Electrical and Computer Engineering Ryerson University, Toronto, 2012

Abstract
High-power multimodular matrix converters (MMMCs) comprising multiple threephase to single-phase matrix converter modules have emerged as a viable topology candidate for medium-voltage adjustable speed drives. As a combination of direct power conversion and cascaded multilevel structure, the MMMCs inherit features such as elimination of dc capacitors, four quadrant operation capability, employment of lowvoltage devices only, and superior output waveform quality under a limited device switching frequency. Due to their particular topological structure, modulation scheme design for the MMMCs is not straightforward and complicated. The presented work is mainly focused on development of suitable modulation schemes for the MMMCs. Several viable schemes as well as their corresponding switching patterns are proposed and verified by both simulation and experimental results. In order for the MMMCs to produce sinusoidal waveforms at both input and output ac terminals, a direct transfer matrix based modulation scheme is presented. It is revealed that a suitable modulation strategy for the MMMCs should aim at fabricating the total input iv

current on the primary side of the isolation transformer. For topologies with more than two modules in cascade on each output phase, switching period displacement is necessary among modules to generate multilevel output waveforms. An indirect space vector based modulation scheme for the MMMCs is developed. With a few presumptions satisfied and viewed from a certain perspective, the MMMCs can still be modeled indirectly and be divided into fictitious rectifier and inverter stages. Therefore, space vector modulation methods can be independently applied to both stages for duty ratio calculation, before the results are converted and combined for determining per-phase output pulses. A new output switching pattern providing improved harmonic performance is also proposed. A novel modulation scheme based on diode rectifier emulation and phase-shifted sinusoidal pulse-width modulation is proposed. The method sacrifices input power factor adjustment, but enables the use of an indirect module construction leading to significantly reduced device count and complexity. Strategy for reducing additional switchings caused by input voltage ripples is also implemented and explained. In addition to simulation verifications, all the proposed schemes are further tested experimentally on a low-voltage prototype built in the lab. Details about the prototype implementation are introduced.

v

Acknowledgement
My foremost appreciation goes to my dissertation advisor, Professor Bin Wu, for his continuous and invaluable guidance, support, and patience throughout the course of this work. I was fortunate enough to have worked with him over the last several years. I am very grateful to Professor David Xu for his tremendous help on the experimental construction of the lab setup, and for the many interesting discussions. Thanks are extended to all the fellow colleagues who have worked at LEDAR during the past years. The time and friendship we shared are truly memorable. Special thanks to my dear wife and parents for their constant understanding and support, without which this couldn't have been possible. Financial supports from Professor Bin Wu and Ryerson University are greatly acknowledged.

vi

Table of Contents

Abstract ................................................................................................................................ iv  Acknowledgement................................................................................................................ vi  Table of Contents ................................................................................................................ vii  List of Figures ....................................................................................................................... x  List of Tables ....................................................................................................................... xv  Glossary of Acronyms ....................................................................................................... xvi  Chapter 1  Introduction .................................................................................................. 1 

1.1  Technical Requirements for MV Drive Converters ............................................. 4  1.2  Overview of Modern MV Drive Converter Topologies ....................................... 6  1.2.1  ac-dc-ac Indirect Converters........................................................................... 7  1.2.2  ac-ac Direct Converters ................................................................................ 21  1.3  Dissertation Objectives ....................................................................................... 26  1.4  Dissertation Outline ............................................................................................ 27  Chapter 2  Direct Modulation Scheme for the MMMC Topologies ......................... 29 

2.1  Topological Structure of the MMMCs ............................................................... 30  2.1.1  Three-Phase to Single-Phase (3 x 2) MC Module ........................................ 30  2.1.2  Three-Module Multimodular Matrix Converter-I ........................................ 32  2.1.3  Nine-Module Multimodular Matrix Converter-II......................................... 34  2.2  Direct Modulation Scheme for the MMMCs ..................................................... 35  2.2.1  Transfer Function Matrix Derivation ........................................................... 36  vii

2.2.2  Switching Pattern.......................................................................................... 41  2.2.3  Switching Period Displacement for MMMC-II ........................................... 42  2.3  Simulation Results .............................................................................................. 44  2.3.1  Simulation Results for MMMC-I ................................................................. 45  2.3.2  Simulation Results for MMMC-II ................................................................ 48  2.4  Experimental Verification .................................................................................. 51  2.5  Summary............................................................................................................. 57  Chapter 3  Indirect Space Vector Based Modulation Scheme for the MMMCs ..... 58 

3.1  Indirect Modeling for the MMMCs .................................................................... 59  3.2  CSR SVM for Rectifier Stage Calculations ....................................................... 63  3.3  Two-level VSI SVM for Inverter Stage Calculations ........................................ 65  3.3.1  Duty Ratio Calculation ................................................................................. 65  3.3.2  Duty Ratio Conversion ................................................................................. 68  3.4  Three-level VSI SVM for Inverter Stage Calculations ...................................... 70  3.4.1  Duty Ratio Calculation ................................................................................. 70  3.4.2  Duty Ratio Conversion ................................................................................. 74  3.5  Switching State Combination ............................................................................. 75  3.6  Switching Pattern Design ................................................................................... 77  3.7  Simulation Results .............................................................................................. 79  3.7.1  Simulation Results for MMMC-I ................................................................. 81  3.7.2  Simulation Results for MMMC-II ................................................................ 84  3.8  Experimental Verification .................................................................................. 88  3.9  Summary............................................................................................................. 94  Chapter 4  Modulation Using DFE Emulation and Phase-Shifted SPWM .............. 96  viii

4.1  3 x 2 Converter Module Structures .................................................................... 97  4.2  Modulation Scheme .......................................................................................... 102  4.2.1  Diode Front-End Emulation for the Rectifier Stage ................................... 102  4.2.2  Phase-Shifted SPWM for the Inverter Stage .............................................. 103  4.2.3  Mathematical Derivation of Input and Output Quantities .......................... 104  4.2.4  Effect of the 18-Pulse Phase-shifting Transformer .................................... 110  4.2.5  Gate Signal Mapping for Direct MC Module............................................. 112  4.2.6  Reduction of Additional Switchings Caused by Input Voltage Ripples .... 113  4.3  Simulation Results ............................................................................................ 116  4.4  Experimental Verification ................................................................................ 119  4.5  Summary........................................................................................................... 123  Chapter 5  Experimental Platform Implementation ................................................ 125 

5.1  Construction of 3 x 2 MC Power Modules ....................................................... 128  5.2  Voltage and Current Measurement ................................................................... 131  5.3  Commutation Control of the Bidirectional Switches ....................................... 132  5.4  Module Synchronization, Communication and Protection............................... 136  5.5  Summary........................................................................................................... 137  Chapter 6  Conclusions .............................................................................................. 138 

6.1  Main Contributions and Conclusions ............................................................... 139  6.2  Suggested Future Work .................................................................................... 141  Appendix I  Per-Unit System Calculation .................................................................. 142 

References ......................................................................................................................... 143 

ix

List of Figures

Fig. 1-1 General structure of a medium-voltage drive system. .................................................................... 4  Fig. 1-2 Classification of high-power converters for MV drive. .................................................................. 7  Fig. 1-3 LCI based MV drive for synchronous machine load. ..................................................................... 8  Fig. 1-4 Configuration of PWM CSC based MV drive system. ................................................................... 9  Fig. 1-5 NPC converter based MV drive.................................................................................................... 14  Fig. 1-6 A seven-level CHB converter based MV drive. ........................................................................... 15  Fig. 1-7 Four-level flying capacitor converter (output phase A)................................................................ 17  Fig. 1-8 NPC/H-bridge converter based MV drive. ................................................................................... 18  Fig. 1-9 Five-level active NPC converter (output phase A). ...................................................................... 19  Fig. 1-10 Modular multilevel converter. .................................................................................................... 20  Fig. 1-11 Three-phase to three-phase conventional MC. ........................................................................... 23  Fig. 2-1 Simplified diagram of a 3 x 2 MC module. .................................................................................. 31  Fig. 2-2 Simplified circuit diagram of three-module MMMC-I................................................................. 33  Fig. 2-3 Simplified circuit diagram of nine-module MMMC-II. ............................................................... 34  Fig. 2-4 Example of switching pattern in a complete switching period. .................................................... 42  Fig. 2-5 Displaced switching periods and resultant phase voltage waveforms. ......................................... 43  Fig. 2-6 Simulated output voltage and current waveforms of MMMC-I (fo = 40 Hz, ma = 0.9). .............. 46  Fig. 2-7 Simulated output voltage and current waveforms of MMMC-I (fo = 80 Hz, ma = 0.9). .............. 46  Fig. 2-8 Simulated input current waveforms of MMMC-I (fo = 40 Hz, ma = 0.9). .................................... 47 

x

Fig. 2-9 Simulated output voltage and current waveforms of MMMC-II (fo = 40 Hz, ma = 0.9). ............ 49  Fig. 2-10 Simulated output voltage and current waveforms of MMMC-II (fo = 80 Hz, ma = 0.9). ......... 49  Fig. 2-11 Simulated input current waveforms of MMMC-II (fo = 40 Hz, ma = 0.9). ................................ 50  Fig. 2-12 Adjustable input power factor of MMMC-II (fo = 40 Hz, ma = 0.9)........................................... 51  Fig. 2-13 Experimental output voltage and current waveforms of MMMC-I (fo = 40 Hz, ma = 0.9). ...... 53  Fig. 2-14 Experimental output voltage and current waveforms of MMMC-I (fo = 80 Hz, ma = 0.9). ...... 54  Fig. 2-15 Experimental grid voltage and current waveforms of MMMC-I (fo = 40 Hz, ma = 0.9). .......... 54  Fig. 2-16 Experimental output voltage and current waveforms of MMMC-II (fo = 40 Hz, ma = 0.9). ..... 55  Fig. 2-17 Experimental output voltage and current waveforms of MMMC-II (fo = 80 Hz, ma = 0.9). ..... 56  Fig. 2-18 Experimental grid voltage and current waveforms of MMMC-II (fo = 40 Hz, ma = 0.9). ......... 56  Fig. 3-1 Simplified diagram of three-module MMMC-I. ........................................................................... 59  Fig. 3-2 Indirect model for MMMC-I using the fictitious dc concept. ...................................................... 60  Fig. 3-3 Indirect model for MMMC-I with single-pole single-throw switches.......................................... 63  Fig. 3-4 CSR SVM for rectifier stage current synthesis............................................................................. 65  Fig. 3-5 Two-level VSI SVM for inverter stage voltage synthesis. ........................................................... 66  Fig. 3-6 Three-level VSI SVM for inverter stage voltage synthesis. ......................................................... 71  Fig. 3-7 Output switching pattern I ............................................................................................................ 78  Fig. 3-8 Output switching pattern II. .......................................................................................................... 79  Fig. 3-9 Functional block diagram of the indirect modulation scheme implementation. ........................... 80  Fig. 3-10 Simulated output voltage and current waveforms of MMMC-I (Pattern I, fo = 40 Hz, ma = 0.9). .......................................................................................................................................................... 82  Fig. 3-11 Simulated output voltage and current waveforms of MMMC-I (Pattern II, fo = 40 Hz, ma = 0.9). .......................................................................................................................................................... 82 

xi

Fig. 3-12 Simulated output voltage and current waveforms of MMMC-I (Pattern II, fo = 80 Hz, ma = 0.9). .......................................................................................................................................................... 83  Fig. 3-13 Simulated input current waveforms of MMMC-I (a) Pattern I. (b) Pattern II. (fo = 40 Hz, ma = 0.9). ..................................................................................................................................................... 83  Fig. 3-14 Simulated output voltage and current waveforms of MMMC-II (Pattern I, fo = 40 Hz, ma = 0.9). .......................................................................................................................................................... 85  Fig. 3-15 Simulated output voltage and current waveforms of MMMC-II (Pattern II, fo = 40 Hz, ma = 0.9). .......................................................................................................................................................... 85  Fig. 3-16 Simulated output voltage and current waveforms of MMMC-II (Pattern II, fo = 80 Hz, ma = 0.9). .......................................................................................................................................................... 86  Fig. 3-17 Simulated input current waveforms of MMMC-II (a) Pattern I. (b) Pattern II. (fo = 40 Hz, ma = 0.9). ..................................................................................................................................................... 87  Fig. 3-18 Adjustable input power factor of MMMC-II (Pattern II, fo = 40 Hz, ma = 0.9)......................... 87  Fig. 3-19 Experimental output voltage and current waveforms of MMMC-I (Pattern I, fo = 40 Hz, ma = 0.9). ..................................................................................................................................................... 89  Fig. 3-20 Experimental output voltage and current waveforms of MMMC-I (Pattern II, fo = 40 Hz, ma = 0.9). ..................................................................................................................................................... 89  Fig. 3-21 Experimental output voltage and current waveforms of MMMC-I (Pattern II, fo = 80 Hz, ma = 0.9). ..................................................................................................................................................... 90  Fig. 3-22 Experimental output voltage and current waveforms of MMMC-II (Pattern I, fo = 40 Hz, ma = 0.9). ..................................................................................................................................................... 91  Fig. 3-23 Experimental output voltage and current waveforms of MMMC-II (Pattern II, fo = 40 Hz, ma = 0.9). ..................................................................................................................................................... 91  Fig. 3-24 Experimental output voltage and current waveforms of MMMC-II (Pattern II, fo = 80 Hz, ma = 0.9). ..................................................................................................................................................... 92 

xii

Fig. 3-25 Experimental input voltage and current waveforms of MMMC-I (Pattern I and II, fo = 40 Hz, ma = 0.9). .............................................................................................................................................. 93  Fig. 3-26 Experimental input voltage and current waveforms of MMMC-II (Pattern I and II, fo = 40 Hz, ma = 0.9). .............................................................................................................................................. 93  Fig. 3-27 Experimental input waveforms of MMMC-II showing adjustable power factor (Pattern II, fo = 40 Hz, ma = 0.9). ................................................................................................................................... 94  Fig. 4-1 Cascaded converter structure with nine power modules. ............................................................. 98  Fig. 4-2 Power module construction for (a) Non-regenerative CHB. (b) Regenerative CHB. (c) MMMC. ...................................................................................................................................................... 99  Fig. 4-3 MMMC leg of output phase A with indirect MC modules. ........................................................ 101  Fig. 4-4 Ideal rectifier side voltage waveforms in an indirect MC module. ............................................ 102  Fig. 4-5 Inverter stage gate signals generated by phase-shift modulation. .............................................. 103  Fig. 4-6 Ideal phase A output voltages without phase shifts in the transformer secondary windings. ..... 110  Fig. 4-7 Ideal phase A output voltages with phase shifts in the transformer secondary windings. .......... 111  Fig. 4-8 Additional rectifier stage switchings caused by input voltage ripples. (a) Without filter. (b) With filter applied. .................................................................................................................................... 115  Fig. 4-9 Simulated output voltage and current waveforms of MMMC-II (fo = 40 Hz, ma = 0.9). ........... 118  Fig. 4-10 Simulated output voltage and current waveforms of MMMC-II (fo = 80 Hz, ma = 0.9). ......... 118  Fig. 4-11 Simulated input current waveforms of MMMC-II (fo = 40 Hz, ma = 0.9). .............................. 119  Fig. 4-12 Experimental output voltage waveforms of MMMC-II under no load condition. ................... 121  Fig. 4-13 Experimental output voltage and current waveforms of MMMC-II (fo = 40 Hz, ma = 0.9). .... 122  Fig. 4-14 Experimental output voltage and current waveforms of MMMC-II (fo = 80 Hz, ma = 0.9). .... 122  Fig. 4-15 Experimental input side waveforms (fo = 40 Hz, ma = 0.9). .................................................... 123  Fig. 5-1 Structural diagram of the low-voltage experimental setup. ........................................................ 126 

xiii

Fig. 5-2 Low-voltage experimental setup of the MMMC. ....................................................................... 127  Fig. 5-3 Construction of the experimental 3 x 2 MC module. ................................................................. 128  Fig. 5-4 Top-front view of the experimental MC modules. ..................................................................... 129  Fig. 5-5 Gate driving of the bidirectional switches. ................................................................................. 130  Fig. 5-6 Voltage and current measurement using isolated 1-Bit -Modulator. .................................... 131  Fig. 5-7 Initial state of output port p connected to input phase a. ............................................................ 132  Fig. 5-8 Four-step device commutation based on load current direction. (a) Step 1. (b) Step 2. (c) Step 3. (d) Step 4. ...................................................................................................................................... 133  Fig. 5-9 Gate signals during the four-step device commutation. ............................................................. 134  Fig. 5-10 FPGA finite state machine implementation of the four-step device commutation. .................. 135 

xiv

List of Tables

Table 2-1 System parameters for direct modulation scheme simulation .................................................... 45  Table 2-2 Experimental system parameters for direct modulation scheme................................................. 52  Table 3-1 Duty ratio conversion for the inverter stage with the two-level SVM ........................................ 69  Table 3-2 Example of dc-link currents expressed in terms of the load currents ......................................... 72  Table 3-3 Example of duty ratio conversion for the inverter stage with the three-level SVM ................... 75  Table 3-4 Switching state combination for 3 x 2 MC Module 1 ................................................................. 76  Table 4-1 System parameters of MMMC-II for simulation ...................................................................... 116  Table 4-2 Experimental parameters of MMMC-II .................................................................................... 120 

xv

Glossary of Acronyms
ANPC CHB CSC CSR DFE EMI FPGA FLC GTO HVDC IM IGBT IGCT LS-SPWM LCI LVDS MC MV MOV MMC MMMC Active Neutral Point Clamped Cascaded H-Bridge Current Source Converter Current Source Rectifier Diode Front End Electromagnetic Interference Field Programmable Gate Array Flying Capacitor Gate Turn-Off Thyristor High-Voltage Direct Current Induction Machine Insulated Gate Bipolar Transistor Integrated Gate Commutated Thyristor Level-Shifted Sinusoidal Pulse-Width Modulation Load Commutated Inverter Low-Voltage Differential Signaling Matrix Converter Medium Voltage Metal Oxide Varistor Modular Multilevel Converter Multimodular Matrix Converter xvi

NPC PS-SPWM PWM RL RB-IGBT SHE SCR SPWM SVM SGCT SM THD TPWM VSC VSI

Neutral Point Clamped Phase-Shifted Sinusoidal Pulse-Width Modulation Pulse-Width Modulation Resistor and Inductor Reverse Blocking Insulated Gate Bipolar Transistor Selective Harmonic Elimination Silicon Controlled Rectifier Sinusoidal Pulse-Width Modulation Space Vector Modulation Symmetric Gate-Commutated Thyristor Synchronous Machine Total Harmonic Distortion Trapezoidal Pulse-Width Modulation Voltage Source Converter Voltage Source Inverter

xvii

Chapter 1 Introduction

In the area of high-power converters for medium-voltage (MV) motor drives, research and development efforts have been made to either devise new converter configurations, or solve technical problems and optimize performance of existing topologies for specific applications. During the past decade, since there were few revolutionary high-power semiconductors rising, a large percentage of the relevant work was focused on existing topologies and their variants. At present, several major multilevel voltage-source inverters (VSIs) fed by diode or active front-ends are the primary converter choices for most commercial MV drives [1]. Competitive solutions such as the pulse-width modulated (PWM) current-source converter (CSC) are also finding widespread application in industry [2]. In addition to the conventional converters that are relatively mature, alternative topologies including several types of hybrid multilevel converters [3-5], active neutral point clamped (ANPC) converters [6, 7], modular multilevel converters (MMCs) [8, 9], and multilevel matrix converters [10-12] have also attracted increased research interests over the past years. Although the overall effectiveness and potential benefits of these emerging topologies still need further investigation and proof, a few of them have already made their way into practical products and entered the commercial market. Correspondingly, modulation and control strategies adapted to these new converters have been proposed and studied in a large number of recent publications, helping improve operating performance as well as exploring new possibilities.

1

Among all emerging high-power converter topologies, the multilevel matrix converters form a special category that incorporates the concepts of both multilevel structure and direct power conversion. As alternatives to dc-link based ac-dc-ac converters, direct ac-ac topologies such as the conventional matrix converter (MC) have been extensively studied for several decades [13-15]. However, mainly due to the lack of power semiconductor that can offer sufficiently high voltage and current handling capability, the conventional MCs are not suitable for high-power applications. The fact has led to the invention of multilevel MCs that can reach higher power and voltage levels with existing power semiconductors. This research line is evident in a series of recent publications where the ideas of several major multilevel converter topologies, for instance the neutral-point-clamped (NPC) converter [16], the flying capacitor converter (FLC) [17], and the cascaded H-bridge converter (CHB) [18], are borrowed and combined with the matrix converter concept, resulting in a number of corresponding multilevel MC topologies, namely, the neutralpoint-clamped multilevel MCs [10, 19], the capacitor clamped multilevel MC [20], and the multiple cell based MCs [11, 21, 22]. To date, only one particular type of multilevel MC topology has been practically implemented as a commercial MV drive. Designated here as the multimodular matrix converter (MMMC), the topology is composed of a multiple number of three-phase to single-phase MC power modules, cascaded to allow the converter to operate at very high power and voltage levels. It is reported that the commercialized MV drive using this topology has reached 3 MVA / 3.3 kV with three MC modules in series per phase, and 6 MVA / 6.6 kV with six modules in series per phase [12]. Being a member of the MC family, the MMMC possesses features such as elimination of dc energy storage components, extended lifespan, inherent four-quadrant operation, and fast dynamic performance. Additionally, it also possess inherited characteristics from the cascaded multilevel structure,

2

such as modular design, flexible scalability, and high quality multi-step output voltage waveforms. Modulation is essential to the proper operation of any type of power converters. For the MMMC, modulation scheme design is not straightforward at first glance due to its particular topological structure. As the converter is composed of three-phase to singlephase MC modules without a stiff dc voltage or current, well established modulation strategies for neither the conventional MCs nor the multilevel converters can be directly adopted. This necessitates the development of specifically tailored modulation schemes for the MMMC to produce sinusoidal input and output waveforms with variable amplitude and frequency. In this dissertation, several new modulation schemes are proposed and investigated for the MMMC topologies. All the presented schemes are able to generate sinusoidal waveforms at both input and output ports of the converters, with the frequency, amplitude and angle of the output fundamental component arbitrarily adjustable. The input power factor can be adjusted by the first two schemes, while for the last method, it is left uncontrolled but close to unity under suitable component parameters and working conditions. This chapter is dedicated to the background introduction of the study. First, the general technical requirements on high-power converters for MV drives are briefly summarized. Then, an overview of the state-of-the-art MV drive converter candidates, as well as their features and limitations is provided. After the introduction of the newly emerged multilevel MC topologies, the main objectives and outline of the dissertation are presented at the end of the chapter.

3

1.1 Technical Requirements for MV Drive Converters

Fig. 1-1 General structure of a medium-voltage drive system.

The MV drive is basically an ac-to-ac power converter system which transforms the fixed amplitude and fixed frequency grid voltage into a desired form for varying the speed of the electric motor load. As demanded by motor control objectives such as speed and torque regulation, the output amplitude and frequency of the drive converter need to be freely adjustable. In Fig. 1-1, the general structure of a typical MV drive system is illustrated. The entire system is composed of the following stages: a line-side filter interfacing the grid, an input transformer providing isolation and adequate secondary voltage level, an ac-to-ac power converter which, in most cases, consisting of a rectifier and an inverter coupled through a dc-link, and an output filter located between the inverter and the machine. In a practical MV drive, some of the stages may be omitted depending on the particular converter configuration. The majority of commercial MV drives are in the power range of 1 to 4 MW, and their voltage ratings are in the range of 3.3 kV to 6.6 kV [23]. As these apparatus present significant loads to the MV distribution grid, they are subject to strict line-side 4

requirements on the generation of harmonic contents and input power factor regulation. In the context of any electrical grid, harmonic distortions, if not properly contained, may cause many harmful effects such as malfunction and failure of equipments, tripping of important industrial processes, and excessive loss and heating in the transformers. Therefore, power electronics based apparatus like the MV drive should comply with established harmonic standards such as IEC 1000 and IEEE Standard 519-1992 [24]. As harmonic content generation in an MV drive is mainly due to the switching behavior of the rectifier stage, the choice of converter topology and its modulation scheme have a large impact on the lineside harmonic performance. Additionally, the input filter is necessary in most topologies to help with the harmonic reduction. Besides harmonic distortion, input power factor regulation is another important lineside requirement. In most cases, a high input power factor within a small region close to unity is demanded by the utility grid. On the motor side of the drive, the waveform quality is also of great importance. Harmonic contents generated by the inverter or LC resonance could result in additional power loss, heating, and torsional vibration in the electric machine, and therefore should be minimized. Minimization of the harmonic contents requires the inverter stage of the drive to produce high quality sinusoidal waveforms by means of well designed modulation strategies. Additional output filters are necessary in many situations to further smooth the waveforms and improve the machine current quality. Other motor-side technical concerns include high dv/dt in the generated voltage waveforms, electromagnetic interference (EMI), and common-mode voltage stress on the machine load. Since most modern inverters are operated by PWM, the dv/dt and EMI associated with device switching transients can be very high considering the significant voltage ratings of the MV converter. If not properly mitigated, these detrimental effects 5

may cause premature failure of shaft bearing and motor winding insulation, as well as malfunction or failure of nearby electronic equipments [23]. Possible solutions to attenuate the harmful dv/dt and EMI include employment of dv/dt filters and use of multilevel converters to reduce PWM voltage waveform steps. In addition to dv/dt and EMI, the common-mode voltage stress ­ also a by-product of the switching behavior of the converter ­ is another serious concern in the MV drive system. If completely placed on the motor, the high stress caused by common-mode voltages could result in premature failure of the motor winding insulation as well [23]. To avoid this situation, most available MV drives employ an input isolation transformer to undertake the dominant part of the stress. In a few designs where the input transformer is eliminated, the major part of the common-mode voltage can be taken by a specially designed common-mode choke [25]. Furthermore, it is worth mentioning that, the choice of multilevel converter topologies and/or suitable modulation schemes may reduce or even eliminate the switching-generated common-mode voltages [26], thereby relieve the stress on isolation transformer and/or common-mode chokes.

1.2 Overview of Modern MV Drive Converter Topologies
This section gives an overview of the most relevant high-power converter topologies for MV drives. The focus is mainly placed on existing topologies that have found practical presence in industry, as well as several potential topology candidates which are recently proposed and studied in the literature. Although not considered as high-power converters, the conventional matrix converter and some of its multilevel derivatives are also briefly reviewed due to their high relevance to the subject matter. As shown in Fig. 1-2, converter topologies for MV Drives can be generally classified into two major categories: the ac-dc-ac indirect converters, which contain dc-links

6

interconnecting the rectifier and inverter stages, and the ac-ac direct converters, which perform power conversion directly between their input and output ac terminals.

High-Power Converters

ac-ac Converters

ac-dc-ac Converters

CycloConverter

Multilevel Matrix Converters

Voltage-Source Converter

Current-Source Converter

Multilevel VSC

Two-level VSC

LCI

PWM CSC

Neutral-Point Clamped

Cascaded HBridge

FlyingCapacitor

Others

Fig. 1-2 Classification of high-power converters for MV drive.

1.2.1 ac-dc-ac Indirect Converters
The ac-dc-ac indirect converters invariably require dc energy storage components and can be further divided into current-source converters (CSCs) and voltage-source converters (VSCs). The CSCs have a current-stiff dc-link realized by dc inductors, whereas the VSCs feature voltage-stiff dc-links comprised of dc capacitors. Both CSC and VSC topologies have found wide commercial application in the MV drive industry; but they are associated with different characteristics and features.

7

1.2.1.1 Current-Source Converters In the subcategory of CSCs, the load-commutated inverter (LCI) and the PWM CSC are the only two types currently being used in practical products. The LCI is built with siliconcontrolled rectifier (SCR) devices, and is mainly suitable for very high power synchronous machine (SM) drives. In contrast, the more modern PWM CSC is made up of symmetric gate-commutated thyristors (SGCTs) with reverse voltage blocking capability. The PWM CSC can be used to drive both megawatt induction machines (IMs) and SMs.

LCI based CSC

Fig. 1-3 LCI based MV drive for synchronous machine load.

The LCI based MV drive as shown in Fig. 1-3 is essentially a back-to-back thyristor converter constructed with SCR devices [27]. In the dc-link of the converter, a large inductor is employed to smooth the current. Aimed at very high power SM applications, the 8

power rating of an LCI drive is typically in the range of a few to tens of megawatts, and may even reach a hundred megawatts or beyond in some particular cases. Due to its simple structure and use of inexpensive and rugged SCR devices which are commutated at the fundamental frequency, the LCI drive features low converter cost, low power loss, high efficiency, high reliability, simple control, and allows regenerative operation. As the commutation of SCR devices require a load voltage of leading power factor (hence the name "load-commutated"), the LCI drive is most suited for large SMs that can work in the over-excited condition by adjusting the rotor field current. Along with all the benefits obtained, the LCI has limitations and drawbacks from using the phase-controlled SCRs as well, those include: limited control freedom and dynamic performance, high harmonic contents in both the line- and motor-side currents, and variable input power factor under different load conditions [2, 28]. In a practical LCI drive, input filter and power factor compensator are normally required.

PWM CSC

Ldc SGCTs Utility Grid M

Ci

Co

Fig. 1-4 Configuration of PWM CSC based MV drive system.

9

The state-of-the-art PWM CSC drive possesses a similar topology to that of the LCI, featuring two three-phase full-bridge converters connected in the classic back-to-back configuration through a dc-link inductor [29]. However, unlike the LCIs which are composed of SCRs and operated by phase control, the PWM CSC consists of fully controllable SGCT devices that can be arbitrarily turned off by the gate signals. These modern high-power devices allow the PWM CSC to be operated by various PWM schemes at a switching frequency of several hundred hertz, generating chopped current pulses at both ac terminals of the converter. Due to PWM operation, ac filter capacitors are required to assist device commutation and to attenuate the generated harmonic current contents. The PWM CSC drive is able to produce variable amplitude variable frequency sinusoidal waveforms with adjustable angle at both the line and motor side. Generally speaking, features of the PWM CSC include simple topology, motor friendly waveforms, and reliable fuse-less short-circuit protection. Moreover, the topological structure of the PWM CSC enables an integrated dc-link choke design using a common magnetic core to realize a practical transformerless MV drive. The integrated choke consists of a differential part as the normal dc-link inductor, and a common-mode choke to undertake the dominant part of the common-mode voltage stress. The otherwise required input isolation transformer can therefore be eliminated. The PWM CSC can be switched by various modulation schemes, such as trapezoidal PWM (TPWM), selective harmonic elimination (SHE), and space vector modulation (SVM) [23]. The TPWM is a carrier-based modulation strategy where a trapezoidal modulating wave is compared with a specially tailored carrier wave to generate gate signals. Although the scheme satisfies the CSC switching constraints, the generated PWM waveforms contain relatively high low-order harmonic contents. The SHE is an offline calculated method that offers both low switching frequency and superior harmonic profile due to its purposeful 10

elimination of several low-order harmonics. However, when compared with the online switching schemes, the SHE's dynamic performance is inferior, owing mainly to its lack of modulation index adjustment capability. The SVM is a digital modulation method which performs real-time duty-cycle calculation and reference vector synthesis, and provides excellent dynamic performance for the converter control by offering the complete degrees of control freedoms (modulation index and delay angle). However, the harmonic performance of the conventional CSC SVM is not as good as that of the SHE. Also the SVM is associated with more switchings and power losses by introducing the short-through pulses. These two drawbacks, together with the fact that in a practical PWM CSC drive, the motor-side magnitude adjustment is normally done through controlling the dc-link current level by the rectifier, rather than to utilize the inverter-side modulation index, make SHE the main modulation scheme choice in a PWM CSC drive in the medium to nominal speed range. TPWM and SVM may also be chosen when the load machine works in the low speed region, where the SHE may not find a viable solution for the calculation of angles. The main drawback of the PWM CSC drive lies in its slow dynamic performance, which is primarily because of the large choke employed in the dc-link, and the drive's control strategy of using the rectifier to regulate dc current level for load-side magnitude adjustment.

1.2.1.2 Voltage-Source Converters Compared with CSCs, VSC topologies are much more popular in many applications including the MV drive. In the fast developing MV drive industry, both conventional twolevel VSC and a number of multilevel VSC topologies are currently present in the market. The two-level VSC based MV drive needs to put devices in series to withstand the high voltage stress, and produces large voltage steps in the output waveform equaling that of the 11

entire dc-link voltage. The multilevel converters, on the other hand, are relieved from many problems of the two-level VSC and, in general, possess the following advantages: 1) Reduced voltage stress on individual power switches. This enables the use of power semiconductors with lower voltage rating and avoids the problems and challenges associated with series device connection; 2) Reduced dv/dt during device switchings. In contrast to the two-level VSC, each device in a multilevel VSC is normally switched between two adjacent voltage levels instead of the entire dc-link voltage. This also brings the benefit of lower common-mode voltage steps/amplitudes; 3) Better input/output waveform quality in terms of total harmonic distortion (THD) and harmonic profile due to the generated multi-step waveform shape that is closer to sinusoid. As a result, the requirement on input/output filters can be significantly lowered or even eliminated. At present, several multilevel VSC topologies such as the NPC converter and the CHB converter are the primary converter choices for most commercial MV drives.

High-Power Two-level VSC As the dominant topology in low-voltage motor drives, the two-level VSC has also been used to implement MV drives by a few manufacturers [23]. In a two-level VSC based MV drive, the power devices (insulated gate bipolar transistor, IGBT) need to block the entire dc-link voltage. Since there is no single device available to offer such a high voltage rating, the IGBTs in the converter legs have to be connected in series to share the voltage stress. The series-connection of devices is accompanied by static and dynamic voltage sharing issues which need to be addressed by active or passive means [30]. In addition, the voltage 12

step, dv/dt and common-mode voltage stress generated by the two-level VSC are very high, which require large-size differential and common-mode filters to suppress. Depending on specific application requirement, the dc-link of the two-level VSC drive can be fed by a diode front-end for non-regenerative operation, or an active front-end to realize a back-toback configuration for regenerative breaking. In terms of modulation, the well-established carrier-based sinusoidal PWM (SPWM) and SVM schemes can both be used in the twolevel VSC to implement advanced motor control strategies [31].

Neutral-Point-Clamped Converter The three-level NPC converter as shown in Fig. 1-5 is presently one of the most widely used topologies in newly developed MV drives. Unlike the two-level VSC which only switches between the negative and positive rails of the dc-link, the NPC converter splits the dc-link equally with two cascaded capacitors, and thereby introduces a dc neutral point [16]. On each of the NPC's phase legs there are four power switches. In addition, two diodes are added to connect the dc neutral point to the junctions between the first and second, third and fourth switches, hence allowing the phase output terminal to be clamped to the dc neutral level. As a result, the phase output voltage of an NPC converter can have three levels (with respect to the dc neutral point): +Vdc/2, 0, and -Vdc/2. Compared with the twolevel VSC, the device voltage stress in the NPC converter is halved for a given dc-link voltage. Besides, the output voltage quality of the NPC is better due to the multilevel waveform shape which reduces the requirement of the filter. Commercial NPC drives are implemented with high-voltage IGBTs or integrated gate commutated thyristors (IGCTs), which have replaced gate turn-off thyristors (GTOs) as the dominant high-power semiconductor devices. Currently, the NPC based MV drive covers a voltage rating up to 4.16 kV without putting devices in series or using step-up transformer, and is expected to 13

extend to higher voltage ranges with the advent of 10 kV IGCTs [32]. In a typical NPC drive, multi-pulse diode rectifier or active rectifier using the same NPC topology can be employed as the front-end converter, for unidirectional or bidirectional power flow applications, respectively.

idc Front-End Rectifier (Multipulse Diode or Active) Vdc
E A B N C

Filter

M

Grid

E

Fig. 1-5 NPC converter based MV drive.

The NPC converter can be modulated by various modulation schemes, such as the multi-carrier-based SPWM, three-level SVM, and SHE [33]. Both carrier-based PWM and SVM provide the complete control freedoms of modulation index and angle adjustment. Due to the multiplicative effect brought by the three-level structure, the equivalent converter switching frequency of the NPC is twice that of the device switching frequency, offering the converter a good dynamic performance for advanced motor control requirements. One of the main technical issues associated to the NPC converter is the need to balance dc capacitor voltages during operation. The problem has been solved by many strategies proposed over the years for either diode-front-end-fed or active-front-end-fed configurations [34, 35]. Another drawback of the NPC lies in the uneven power loss and, 14

thereby, uneven heat dissipation on the outer and inner switches. Using active switches in place of the clamping diodes and forming a three-level active NPC topology may significantly improve the loss distribution, but at the expense of increased semiconductor cost [6].

Cascaded H-Bridge Converter

Fig. 1-6 A seven-level CHB converter based MV drive.

Besides NPC, the CHB converter (Fig. 1-6) is another very popular multilevel VSC topology that has been chosen by a large number of MV drive manufacturers. As the name indicates, the CHB is made up of series connected single-phase full-bridge converters (H15

bridges). The H-bridges are supplied by separate dc-link capacitors sourcing energy from three-phase diode-rectifiers, which are normally fed by the secondary windings of a phaseshifting input transformer interfacing the grid. Each H-bridge, together with the dc-link capacitor and the diode rectifier, forms a standard power cell and serves as the fundamental building block for the modular design of the entire converter. Regarding the power cells, although CHB converters with unequal dc-source modules were also revealed to have some advantages by scholarly research [5], the loss of modularity make them unfavorable choices for practical drive products. In a practical CHB drive with equal dc-source cells, as each power cell independently contributes three voltage levels (+E, 0, -E), the entire converter is able to produce high quality multilevel output voltages, and may reach very high voltage and power ratings using only low-voltage IGBTs. It was reported that the maximum ratings for the CHB converter in use is 13.8 kV / 31000 kVA [1]. On the input side of the converter, the harmonic contents caused by the diode rectifiers are mostly cancelled out in the phaseshifting transformer. Therefore, the total input current has low harmonic distortion and can meet the grid requirements. The CHB converter can be modulated by several multicarrier-based SPWM schemes, such as the phase-shifted SPWM (PS-SPWM) which employs horizontally shifted triangle carriers for comparison with the sinusoidal modulating wave, and the level-shifted SPWM (LS-SPWM) schemes where the carriers are vertically distributed in the modulation plane. The CHB converter can also be operated by staircase modulation, SVM, and SHE schemes. In practice, the most used scheme is the PS-SPWM which provides decent harmonic performance, even device switchings, and balanced load sharing among the contributing cells. It is worth noting the equivalent switching frequency of the CHB can be several times that of the device switching frequency, making the topology an attractive candidate for high-speed applications.

16

A main drawback of the CHB converter is its need for a costly and bulky phase-shifting transformer with many secondary windings. Moreover, if regenerative operation is required for a CHB, the diode rectifiers in the power cells have to be replaced by active rectifiers [36], leading to significantly increased cost and complex control.

Flying Capacitor Converter

Fig. 1-7 Four-level flying capacitor converter (output phase A).

The flying capacitor (FLC) converter is among the classic multilevel converter topologies and has been well studied in the literature [17]. As shown in Fig. 1-7, The structure of the FLC is similar to that of the high-power two-level VSC, in which IGBT devices are connected in cascade in the phase legs to block the high dc-link voltage. However in an FLC, in addition to the switching devices, capacitors are added to the phase legs and connected between the switch pairs in the upper and lower half bridges, thereby clamping the device joints and introducing more output voltage levels. Although able to produce multilevel output waveforms, the FLC converter requires a large number of extra capacitors that need to be charged during startup and balanced during normal operation, which is main drawback of the topology. FLC converter based drive is offered by only one 17

manufacturer in the market and is much less popular than the NPC and CHB based products.

NPC/H-bridge Converter
A C

M
B

E

Vdc1
E

Vdc2

Phase B

Vdc3

Phase C

N
Fig. 1-8 NPC/H-bridge converter based MV drive.

The NPC/H-bridge converter in Fig. 1-8 employs two NPC legs to support each of its three output phases [37]. The two NPC legs are connected in the H-bridge configuration and able to generate five output voltage levels between their output terminal pair. Because each H-bridge provides one output terminal to be connected with those from the other phases, the three H-bridges in the converter cannot share a common dc-link as in the NPC converter. Instead, they need to be fed by isolated multi-pulse rectifier configurations from the input phase-shifting transformer. Having twice the device count in an NPC converter, the NPC/H-bridge converter provides more voltage levels and covers a higher 18

power/voltage range than the NPC does. Currently, two manufacturers offer NPC/H-bridge converter based MV drive products with the voltage rating up to 6.9 kV.

Five-level Active NPC Converter

Fig. 1-9 Five-level active NPC converter (output phase A).

The three-level ANPC was further extended into a five-level converter topology in recent years [6, 7, 38]. The outcome is called a five-level ANPC but can be essentially considered as a hybrid combination of a three-level ANPC and a basic flying capacitor power cell. Fig. 1-9 shows the circuit diagram of the five-level ANPC for a single output phase. Through the use of redundant switching states, the voltage across the added flying capacitor is maintained at 1/4 of the dc-link voltage, such that the inverter phase output voltage can be chosen from the following five voltage levels (with respect to the dc neutral 19

point): +Vdc/2, +Vdc/4, 0, -Vdc/4 and -Vdc/2. Taking into account the voltage stress in the converter, series connection of devices is required in the ANPC part to enable use of unified devices with the same voltage rating. The back-to-back configuration of the fivelevel ANPC topology has been commercialized as an MV drive by one leading manufacturer, with the power rating up to 1 MVA / 6.9 kV and transformerless option available [7].

Modular Multilevel Converter

Fig. 1-10 Modular multilevel converter.

The modular multilevel converter (MMC) is a relatively new topology proposed for high-power applications [8, 9, 39]. During the past decade, it has attracted increasing 20

interest and has found industrial presence in a light-weight high-voltage direct current (HVDC) transmission system. The MMC is composed of stacks of series connected halfbridge choppers formed by two IGBTs and a capacitor. Each MMC phase leg consists of a positive stack and a negative stack as well as the necessary output inductors. Due to the cascaded structure, the MMC features very good modularity and scalability, and is therefore able to undertake very high voltages. Not like the CHB converter which is also based on series connection of power cells, the power modules in MMC do not need isolated dc sources. Therefore, the three inverter legs in the MMC can share a common dc-link fed by a common rectifier. The use of MMC for MV drive application was proposed in [40], where it was revealed the fluctuation of the chopper capacitor voltages are related to the motor current frequency. It was also concluded in [8] that the converter can be adapted for loads such as the fans, pumps, blowers and compressors, while not suitable for high-torque low-speed applications.

1.2.2 ac-ac Direct Converters
Unlike indirect converters that invariably synthesize output voltage or current from a dc-link stage supported by passive elements, the ac-ac converters perform single-stage power conversion directly from the ac inputs and are free of any dc-link components. To date, only a few ac-ac direct converters have found presence in the MV drive industry. These include the classic cycloconverters and one particular type of the newly developed multilevel MC topologies.

Cycloconverter

21

A cycloconverter is a direct frequency changer whereby fixed magnitude fixed frequency input ac power is converted to output ac power in a single stage [2]. With groups of thyristors employed and operated coordinately, both magnitude and frequency of the output can be varied. In order to avoid severe waveform distortion, the output frequency of a cycloconverter cannot exceed a fraction of the input frequency. The output voltage is constituted from selected portions of the input voltage pulses, and its magnitude can be adjusted by means of phase angle control. Motor drives using cycloconverters possess advantages such as simple structure, high reliability, low switching losses and very high efficiency due to the use of naturally commutated thyristor devices. Furthermore, these converters can be operated in all four quadrants and have inherent capability of bidirectional power flow. On the other hand, also owing to the use of phase controlled thyristors, the input power factor of cycloconverters is generally low, with significant harmonic currents being drawn from the grid by the converter. Cycloconverters are mainly used in low-speed high-power motor drives in industries of cement, mining, metals and the like. It should be mentioned that cycloconverter based drives are not as popular as inverter based drives in new designs due to technology advancement and performance improvement of the latter.

Matrix Converters Although matrix converters (MCs) share the same basic functionality with cycloconverters: to perform single stage ac power conversion with variable magnitude and variable frequency, the MCs differ from the cycloconverters in many aspects. Equipped with four-quadrant bidirectional switches made up of force-commutated devices such as IGBT, a typical MC is able to generate output voltages with either higher or lower frequencies than that of the input. A conventional MC features inherent four quadrant 22

operation capability, sinusoidal input/output waveforms, and a controllable input power factor [14, 41]. If compared with dc-link based indirect converters, the MC possesses several advantages such as reduced size and higher power density, improved lifespan due to elimination of the bulky and often trouble-causing dc-link component, and faster dynamic performance owing to its single stage conversion. Nevertheless, for the same reason of the avoided dc-link component, MCs are also known for their relatively complex modulation and commutation techniques, limited voltage transfer ratio, and lack of ride-through capability.

SaA Bidirectional Switch SbA ScA vas vbs vcs Cf Ls SaB SbB ScB SaC SbC ScC load

Fig. 1-11 Three-phase to three-phase conventional MC.

With maturation of suitable power devices and advancement of control, the MC has been considered an alternative topology for dc-link converters where power density and 23

regeneration capability are of great importance. Among all configurations, the three-input three-output MC (3 x 3 MC) as shown in Fig. 1-11 and its topological variants have attracted the most research interest. Although study on the conventional MC can be traced back to several decades ago [13], the topic only started to resurge lately and has regained much attention during the past years. Owing to the solving of several major technical challenges such as bidirectional switch commutation control, the MC has been pushed closer to practical application. It is worth mentioning that the first commercial MC based adjustable speed drive was already released [12]. So far, most of the research work about MC falls into the low-voltage category where the converter can be operated at a relatively high switching frequency, whereas the high power applications had never considered MC as a viable option due to concerns on efficiency and power device rating limitations. Recently, there has been an increasing interest in introducing MCs into the high-power arena [20, 42-44]. Taking account of the limited voltage ratings of existing power semiconductors, the conventional 3 x 3 MC is still not a viable option for higher voltage applications. In view of this, researchers have directed attention to come up with new MC topologies which incorporate the concepts of multilevel converters. During the past decade, the ideas of several major multilevel VSC topologies have been utilized and combined with the conventional MC concept, resulting in the emergence of the neutral-point-clamped multilevel MCs, the capacitor clamped multilevel MC, and the multi-module based multilevel MCs. In addition to being members of the MC family, these new topologies also possess features similar to the multilevel VSCs. Correspondingly, their modulation and control aspects have been studied in a number of publications [10, 11, 19-21, 44, 45]. The neutral-point-clamped multilevel MCs are developed from the indirect construction of the conventional MCs. The indirect construction separates the whole converter into a rectifier stage and an inverter stage with no dc-link components. Instead of using a twolevel VSC, a three-level NPC converter is employed in the inverter stage to provide more 24

output voltage levels. Recently, several topological variants of the NPC multilevel MC have been discussed in a few publications [10, 19, 43]. Compared with the conventional MC, the neutral-point-clamped MCs improve the output voltage quality at the cost of increased device count. However, the device voltage stress, especially for those in the rectifier stage, is not reduced. The topology is therefore still not suitable for higher voltage applications. Another novel multilevel MC topology, the capacitor clamped multilevel MC, was proposed in 2005 [20]. This converter employs six flying capacitors to balance voltage distribution among series connected switch modules and to provide middle voltage levels. The voltage stress on the switches is halved comparing to that of a conventional MC. In the meantime, the harmonics in the output voltage and current waveforms are also significantly lowered. The main disadvantage of this topology lies in the large amount of clamping capacitors required, as well as the increased device count and complex converter structure. At present, the only multilevel MC topology that has found commercial presence is the multimodular matrix converter (MMMC) [11, 12]. Formed by three-phase to single-phase MC (3 x 2 MC) modules, the MMMCs are very similar to the CHB converter in terms of topological structure, but are different from the latter in the construction of constituent power modules. In a CHB converter, each module contains a dc-link capacitor, and the output voltages are synthesized from the dc voltage; whereas in an MMMC, the output voltages of any single module are directly fabricated from the three-phase ac inputs. Due to the series connection of power modules, the MMMC can reach high voltage and power levels while using low-voltage IGBTs only. Meanwhile, they also need the input phaseshifting transformer to provide isolated ac sources, just like the CHB converter. Proper operation of the MMMC topologies relies on suitable modulation schemes that can generate variable frequency sinusoidal waveforms at both ac terminals. To date, there is 25

no comprehensive study on the modulation scheme design for the MMMCs. It is therefore this work's primary aim to propose and develop appropriate modulation schemes for these particular converters.

1.3 Dissertation Objectives
Modulation scheme design for the MMMC topologies is not a straightforward task. Unlike the conventional MCs that feature a three-phase-in three-phase-out balanced structure, or the dc-link based indirect converters where the dc component decouples the rectifier and inverter stages, the MMMCs are composed of 3 x 2 MC modules in which the power flow is pulsating. Although synthesis of sinusoidal output voltage waveforms can be achieved without much difficulty, the simultaneous generation of sinusoidal line-side current waveforms requires coordination among different MC modules and needs careful design. Aiming at developing various possible modulation schemes for the MMMCs, the main objectives of this dissertation are listed as follows: 1) Establish the mathematical transfer function matrix of the MMMCs as a basis for modulation scheme design. Propose a direct transfer function based modulation scheme together with a suitable switching pattern to generate sinusoidal waveforms at both sides of the converters. 2) By applying the classic fictitious dc-link concept, create an equivalent indirect circuit model for the MMMCs to lay a foundation for the design of indirect space vector based modulation schemes. Based on the developed model, design indirect modulation schemes and novel switching patterns to improve waveform quality. 3) Develop a novel modulation scheme based on diode front-end emulation and phaseshifted SPWM. Different from the other proposed strategies, this new method 26

allows the use of an indirect module structure with significantly reduced device count and structure complexity, which come at the price of sacrificing the input power factor adjustment capability. 4) Provide simulation results to verify the proposed concepts, and build a low-voltage prototype of a nine-module system to further test the modulation schemes experimentally.

1.4 Dissertation Outline
This dissertation consists of six chapters which are organized as follows. Chapter 1 provides the background and introduction of the study. Chapter 2 describes the MMMC topologies, then proposes a direct transfer-functionbased modulation scheme for generating sinusoidal waveforms at both sides of the converters. Starting with the most fundamental three-module version of the topology, it is revealed that, although the input currents of individual 3 x 2 MC modules contain significant harmonic distortion, the total line-side currents, being the sum of the secondary currents referred to the primary side of the transformer, can still be sinusoidal when a proper modulation method is applied. Chapter 3 presents an indirect circuit modeling to design indirect space vector based modulation schemes for the MMMCs. Based on the fictitious dc-link concept, the indirect model separates the converter into a rectifier stage and an inverter stage. SVM methods for current-source rectifier and voltage-source inverters can then be independently applied to calculate the duty ratios needed for input current and output voltage synthesis. After the duty ratios are converted and combined, gate signals for the real switches are generated

27

according to two switching patterns. The second proposed switching pattern is proved to offer a superior harmonic profile in the generated waveforms. Chapter 4 proposes a simple modulation method for the nine-module MMMC fed by an input phase-shifting transformer. Focusing only on fabricating multilevel output voltage waveforms, the method is essentially a combination of diode front-end emulation with phase-shifted SPWM. Although the method does not bother with input current synthesis, because power balance among modules on a same output phase is guaranteed, and owing to the harmonic elimination capability of the phase-shifting transformer, sinusoidal input current with good quality can still be achieved. Chapter 5 introduces a low-voltage lab prototype constructed for experimental verification of the proposed modulation schemes. Details about the implementation of the power modules, voltage and current measurement, device commutation control as well as module synchronization, communication and protection are provided. Chapter 6 summarizes the main contributions and conclusions of the presented work. Possible future research directions are also suggested.

28

Chapter 2 Direct Modulation Scheme for the MMMC Topologies

The multimodular matrix converters (MMMCs) are comprised of a multiple number of three-phase to single-phase (3 x 2) matrix converter (MC) modules. The MC modules are normally fed by a multi-winding input transformer, and can be cascaded on the load side to provide high voltage/power output without using power devices of increased voltage ratings. Similar to the cascaded H-bridge (CHB) converter, the MMMCs possess features such as modular design, high quality multi-stepped output voltage waveform, and allow the use of low-voltage power semiconductors under mass production. Moreover, the MMMCs eliminate the dc components necessary in the CHB, and they are inherently regenerative. Due to the unique topological structure, established modulation schemes for neither the CHB converter nor the conventional three-phase to three-phase (3 x 3) MCs can be directly applied to operate the MMMCs. In each 3 x 2 MC module, although generating any desired single-phase output voltage from the three-phase input voltages by means of pulse-width modulation (PWM) is not difficult to achieve, to synthesize three-phase input sinusoidal currents from the single-phase output current is basically an impossible job. The fact can also be appreciated from the power balance perspective, as the single-phase output power is always pulsating, while a balanced three-phase input provides a constant power flow.

29

The main objective of this chapter is to develop a direct modulation scheme for the MMMCs to synthesize sinusoidal voltage/current waveforms on both ac sides of the converters. Rather than trying to fabricate sinusoidal currents right at the input ports of the MC modules, the proposed strategy targets the total input currents on the primary side of the multi-winding transformer. It will be demonstrated that although the three-phase input currents of each MC module have distortions, the sum of the secondary-winding currents eventually becomes sinusoidal when referred to the primary side of the transformer. As for the output voltage, the generated frequency can be either higher or lower than that of the input, making the converters and the modulation scheme suitable for medium-voltage (MV) drive application where the output voltage and frequency need to be variable to control the machine load.

2.1 Topological Structure of the MMMCs
2.1.1 Three-Phase to Single-Phase (3 x 2) MC Module
The fundamental building block for the MMMC topologies is a three-phase-in singlephase-out MC module which consists of six bidirectional power switches. As shown in Fig. 1-1, each bidirectional switch can be practically formed by two insulated-gate bipolar transistor (IGBT)-diode pairs connected in anti-series, or by two reverse blocking IGBTs (RB-IGBT) connected in anti-parallel [46]. Since the bidirectional switches are four quadrant operable, they are able to block voltages of both polarities and allow currents in either direction. Under normal operating conditions, when the switches in the module are turned ON and OFF, the output terminals p and q can be arbitrarily connected to any one of the three input terminals a, b, and c to choose a proper voltage level. The input-side terminals of the MC module are fed by a three-phase power supply [vas, vbs, vcs]. A three30

phase ac filter capacitor is needed at the input port of the module to assist switching commutation and suppress current harmonics. On the output side, the module should be connected to an inductive load, whose continuous current is utilized as a current source for fabrication of desired input currents.

3 x 2 MC Module Sap Sbp Scp vas vbs vcs Ls a b c Cf p

Bidirectional Switches Saq Sbq Scq q

load

Fig. 2-1 Simplified diagram of a 3 x 2 MC module.

Similar to the conventional 3 x 3 MCs, the 3 x 2 MC module is subject to switching constraints. Any switching state that may cause short circuit of the filter capacitors or interrupt of the inductive load current is prohibited. Hence, at any instant of time, two and only two switches in the module, one from the upper group of [Sap, Sbp, Scp] and the other from the lower group of [Saq, Sbq, Scq] must be in the ON state. The switching constraint for the 3 x 2 MC module can be mathematically expressed as follows 31

S (t )  Sbp (t )  Scp (t )  1   ap    Saq (t )  Sbq (t )  Scq (t )  1, 1, S jk is ON   where S jk (t )   j  {a, b, c}, k  { p, q}. 0, S is OFF ,  jk 

(2.1)

The switching constraint provides a basis for the modulation and switching state design for the MMMCs. In addition, due to the use of bidirectional switches, device commutation between different phases should comply with the constraint as well to avoid short circuit of the capacitors and open circuit of the inductive load during transients. Same as the direct type conventional 3 x 3 MC, the 3 x 2 MC modules can readily adopt the load current or input voltage based multi-step commutation strategies for device commutation control [47]. The principle and implementation details of the commutation are explained in Chapter 5.

2.1.2 Three-Module Multimodular Matrix Converter-I
Using three 3 x 2 MC modules, the simplest version of the MMMC topology (MMMCI) can be built to supply an inductive load. Fig. 2-2 shows the simplified circuit diagram of MMMC-I, where a three-phase-four-winding transformer is employed to provide isolation and the required secondary-winding voltage level. The MC modules act as the interface between the input transformer and the load. On the input side, each module is fed by one of the secondary windings of the transformer, and ac filter capacitors are present to assist commutation as well as to filter the switching harmonics. On the output side, the q terminals from all the modules are connected together to form a reference neutral point,
32

Bidirectional Switches

3 x 2 MC Module 1 S11 S12 p
+

iA A

v1sa i1sa a i1swa v1sb i1sb b iCf v1sc i1sc c Cf

S13

vAN S14 S15 S16 q -

3 x 2 MC Module 2 S21 S22 vpa ipa vpb ipb vpc ipc v2sa i2sa a v2sb i2sb b v2sc i2sc c Cf i2swa iCf S24 S25 S26 3 x 2 MC Module 3 S31 S32 v3sa i3sa a v3sb i3sb b v3sc i3sc c Cf i3swa iCf S34 S35 S36 S33 p
+

p
+

S23

iB B load

vBN q N

iC C

vCN q -

Fig. 2-2 Simplified circuit diagram of three-module MMMC-I.

33

while the p terminals are directly connected to the load phases. The load of the converter could be either a three-phase RL or an ac machine, the inductive nature of which is necessary for the proper operation of the MC modules.

2.1.3 Nine-Module Multimodular Matrix Converter-II

  20

  0

  20

Fig. 2-3 Simplified circuit diagram of nine-module MMMC-II.

If a larger number of MC modules are employed, the fundamental three-module MMMC-I can be extended to multilevel configurations for higher power/voltage output 34

levels and better waveform quality. Fig. 2-3 illustrates the simplified circuit diagram of a nine-module version of the MMMC. Designated as MMMC-II, the converter is equipped with three MC modules on each of its output phases which are fed by a phase-shifting transformer having nine secondary windings. The secondary windings of the transformer are arranged into three groups with phase displacements of -20º, 0º and +20º, respectively. This configuration allows for cancellation of several unwanted low-order harmonic currents on the primary side [48]. The whole converter of MMMC-II can be essentially viewed as three sets of MMMC-Is connected in series. It is also very similar to the seven-level CHB converter in terms of structure, except that the H-bridge switching cells in the latter are replaced by the MC modules without dc capacitors. In order to achieve even higher power and voltage output levels, the number of MC modules employed for series connection can be further increased. The commercial MV drive based on the MMMC topology, as an example, puts six MC modules in series per phase to reach a voltage level of 6.6 kV [12]. Nevertheless, this would require the input phase-shifting transformer to have a larger number of secondary windings and more sophisticated phase displacement arrangements, similar to the case of multilevel CHB converters.

2.2 Direct Modulation Scheme for the MMMCs
The challenge for the design of a modulation scheme suitable for the MMMCs lies in how to produce sinusoidal voltage/current waveforms on both sides of the converter. Just like in a conventional 3 x 3 MC, the inputs of the MC modules are regarded as voltage sources whereas the outputs are taken as current sources due to the inductive load. The task of a properly designed modulation scheme is to assemble sinusoidal output voltages from segments of the input voltages, and fabricate sinusoidal input currents with pieces from the 35

load currents, both at the same time. For the conventional 3 x 3 MC, a large number of modulation schemes have been well established in the literature [15, 49-56]. However, these methods cannot be directly applied to the MMMCs. As mentioned earlier, in each individual 3 x 2 MC module, although it is not difficult to generate any desired singlephase output voltage, to directly synthesize three-phase sinusoidal input currents from the single-phase output current would be almost impossible. The succeeding sections present a direct-transfer-function-based modulation strategy for the MMMCs. The explanation is first carried out based on the three-module MMMC-I. Since the more complicated versions are essentially cascaded connection of multiple sets of MMMC-I, the basic modulation scheme can be easily modified to control them. Instead of trying to obtain sinusoidal currents at the input ports of the MC modules, the proposed scheme targets the total input currents on the primary side of the transformer. As a result of the modulation, although the input currents of each MC module are not sinusoids, the total input current at the primary side of the transformer is sinusoidal and well follows the angle reference. For the output voltage, the frequency and angle can be arbitrarily set, and the magnitude can be controlled through the modulation index adjustment.

2.2.1 Transfer Function Matrix Derivation
Referring to the circuit diagram of MMMC-I in Fig. 2-2, because all the three-phase windings of the input transformer have the same phase shifts, the relationship between the instantaneous output and input voltages of the converter can be established by means of a switching function matrix

36

 v AN   S11  S14    vL   vBN    S 21  S 24      vCN     S31  S34

S12  S15 S 22  S 25 S32  S35

S13  S16  v1a   v1a      S 23  S 26   v1b   H  v1b         S33  S36  v   1c   v1c  

(2.2)

in which the transformer-secondary-winding-fed input voltages of the MC modules (neglecting the voltage drops on line and leakage inductances) are given by

v1a    v1   v1b   VS     v1c  

cos(i t )      cos(i t  2 / 3)      cos(  t 2  / 3)  i  

(2.3)

where VS and i represent the magnitude and frequency of the secondary winding voltages, respectively. On the other hand, the fundamental components of the desired MC output voltages can be written as

cos(o t   o ) v AN        vL   vBN   VL  cos(ot   o  2 / 3)          v cos(  t    2  / 3) o o  CN   

(2.4)

in which VL , o , and  o denote the desired voltage magnitude, frequency, and phase angle of the output fundamental component, respectively. Suppose the converter is operated with

37

a switching frequency sufficiently higher than the input and output fundamental frequencies, the low-frequency form of (2.2) can be obtained by averaging it over the switching period

 v AN   d11  d14    vL   vBN    d 21  d 24      vCN     d31  d34

d12  d15 d 22  d 25 d32  d35

d13  d16  v1a   v1a      d 23  d 26   v1b   H  v1b         d33  d36  v   1c   v1c  

(2.5)

where d jk represents the duty ratio of switch S jk . As for the currents, the fundamental components of the load currents that are utilized for the input current synthesis can be expressed in terms of the output voltage and the load

cos(o t   o   L ) iA      v   vL V iL  iB   L   L  cos(ot   o   L  2 / 3)  . Z  L Z    Z      i t    cos(    2  / 3) o o L  C  

(2.6)

In (2.6), Z and  L designate the load impedance and load power factor angle, respectively. Considering the transformer's turns ratio Ns / Np and the influence of the filter capacitors, the total input current at the primary side of the transformer can be written as (taking phase

a as an example)

38

ia 

NS (i1a  i2 a  i3a ) NP  iA     S31  S34  iB   3C f dv1a / dt  .       i  C 

 N   S   S11  S14 NP   

(2.7)

S 21  S 24

Hence, the low-frequency form of the three-phase input currents can be given in (2.8)

  d11  d14  ia    N  ii   ib   S   d12  d15   NP    d  d   ic     13 16

d 21  d 24 d 22  d 25 d 23  d 26

d31  d34  iA    d32  d35  iB   3C f   d33  d36   iC  

 dv1a / dt      dv1b / dt        dv1c / dt  

(2.8)


NS H T iL  3C f dv1 / dt  .  NP

In order to obtain any desired output voltages with variable magnitude and variable frequency while achieving sinusoidal three-phase input currents, the solution to the transfer matrix, H , is derived in (2.9) based on the above equations. In the expression of H , i is an arbitrary angle that can be utilized to control the input power factor, whereas ma designates the modulation index for output magnitude adjustment. The low-frequency dutyratio equivalent, H , can be easily obtained by performing a regular sampling to H with the switching period, i.e. substituting nTs into (2.9) for t .

39

cos(o t   o )     H  ma  cos(ot   o  2 / 3)   cos(i t  i ) cos(i t  i  2 / 3) cos(i t  i  2 / 3)      cos(o t   o  2 / 3)  

cos(o t   o ) cos(o t   o )    cos(i t  i ) cos(i t  i  2 / 3)     ma  cos(ot   o  2 / 3) cos(o t   o  2 / 3)   cos( t   ) cos(i t  i  2 / 3) i i      cos(o t   o  2 / 3) cos(ot   o  2 / 3)  cos(i t  i  2 / 3)  cos(i t  i )

  cos(i t  i  2 / 3)     cos(o t   o  2 / 3)  .  cos(i t  i  2 / 3)      cos(ot   o  2 / 3)   cos(i t  i  2 / 3) 

cos(ot   o )

(2.9)

The magnitudes of the input and output voltages can now be related as follows

3 VL  VS  ma  cos i  . 2

(2.10)

If the input transformer is taken into account, the voltage transfer equation of the whole converter can be rewritten as

3 N VL   S Vi  ma  cos i  2 NP
40

(2.11)

where Vi designates the primary winding voltage magnitude. As a matter of fact, the limited voltage transfer ratio issue associated with conventional 3 x 3 MC [57] becomes a lesser concern in the MMMCs, as the transformer is able to provide an adequate secondary voltage level with a properly designed turns ratio.

2.2.2 Switching Pattern
After the duty ratios of the switches are determined by the transfer matrix, a certain switching pattern is needed for setting the commutation instants in the MC modules during a specific switching period. Here, a simple pattern with center-placed double-sided pulses is employed to investigate the performance of the modulation scheme. Without loss of generality, we take the first 3 x 2 MC module (the one supplying load phase A) in Fig. 2-2 as an example to explain the switching sequence. It is easy to identify that the duty ratios for the six switches in this module ( S11 ~ S16 ) are calculated from the first row of the transfer matrix, i.e. ( H11  d11  d14 , H12  d12  d15 , H13  d13  d16 ), and their absolute values can be sorted and denoted as

d max  max( H11 , H12 , H13 )   d mid  mid( H11 , H12 , H13 ) .  d  min( H , H , H ) 11 12 13  min

(2.12)

41

For each pair of switches that are connected to the same input phase ( S11 and S14 , S12 and S15 , S13 and S16 ), which one to be controlled is decided by the polarity and value of the calculated duty ratio. Since the sum of H11 , H12 , and H13 is always zero, the one that has the maximum duty ratio is always of the opposite polarity to the rest two. Considering the case of H11  H12  H13 and H13  0 , the pattern is exemplified in Fig. 2-4. In this case,

because d max  H13 and H13 is negative, S16 is kept ON throughout the entire switching period, whereas the three switches in the upper group ( S11 , S12 , S13 ) are successively turned ON and OFF in the specific order indicated by the pattern. Consequently, the output voltage of the module will be synthesized from two different input line-to-line voltages.

(1  d max )Ts d minTs 2 2 S13 , S16 S11 , S16

d midTs

S12 , S16

d minTs (1  d max )Ts 2 2 S11 , S16 S13 , S16

Fig. 2-4 Example of switching pattern in a complete switching period.

2.2.3 Switching Period Displacement for MMMC-II
Because the configuration of MMMCs with higher number of power modules can be essentially regarded as multiple sets of MMMC-Is in cascade, the direct modulation scheme
42

described in the last sections can be readily applied to control them. As for the nine-module MMMC-II, a total of three MMMC-I modulators are required. Each modulator is responsible for operating a group of three MC modules connected to the secondary windings that have the same phase shift. In order to allow the input phase-shifting transformer to achieve maximum harmonic elimination performance, the input displacement modulation angles, i , of the three modulators are required to have separate values to match their respective secondary winding phase shifts (-20º, 0º, +20º).

Ts 3

Ts 3

Ts

Fig. 2-5 Displaced switching periods and resultant phase voltage waveforms.

With reference to Fig. 2-3, on the output side of the converter, the total phase voltage impressed on the load is the sum of the individual output voltages from the three

43

contributing MC modules, e.g. v AN  v A1  v A 2  v A3 . Therefore, the output phase voltage references should be divided into three parts during any switching period. A simple and straightforward distribution would be to divide the references into three equal parts, such that a balanced load-power sharing among the transformer's secondary windings is achieved, allowing for a better harmonic elimination performance. The last concern on the modulation of MMMC-II lies in how to set the switching instants within different MC modules. If the switching periods of the three modules in a same output phase are identically located on the time axis, switching transitions in different modules happen all at once, and the resultant output phase voltage would be the straight addition of the constituent pulses, leading to a voltage waveform with poor quality and high dv/dt. Alternatively, a displaced allocation of the switching periods can be employed among modules in the same output phase as a better solution. Exemplified in Fig. 2-5, the switching periods of module A1, A2 and A3 are displaced by one thirds of the complete period between one another. This approach is similar to the principle of phase-shifted modulation for the CHB converters, where the carriers are evenly distributed in the modulation plane to allow for phase shifts. The displaced switching periods effectively reduces the output voltage step and improves the waveform quality.

2.3 Simulation Results
Both MMMC-I and MMMC-II are modeled and simulated in MATLAB/Simulink to verify the validity of the topologies with the developed direct modulation scheme. The following part presents the simulation results of the models. The system parameters used for the simulations, such as the rated power and voltage, sampling and switching frequency as well as per-unit values of the passive components are listed in Table 2-1. 44

Table 2-1 System parameters for direct modulation scheme simulation

System Parameters Rated Power Grid Input Voltage (line-to-line, rms) Input Frequency Transformer Turns Ratio NP : NS Sampling Frequency fs Device Switching Frequency fsw Total Line Inductance Ls (referred to the primary side) Filter Capacitance Cf Load Resistance RL Load Inductance LL

MMMC-I 333 kVA 1387 V 60 Hz 3:2 1.8 kHz  1.2 kHz 0.08 pu 0.2 pu 0.9 pu 0.25 pu

MMMC-II 1 MVA 4160 V 60 Hz 9:2 1.8 kHz  1.2 kHz 0.08 pu 0.25 pu 0.9 pu 0.25 pu

2.3.1 Simulation Results for MMMC-I
Using the above-described modulation scheme, simulations for MMMC-I are carried out to supply a three-phase RL load. According to (2.11), the turns ratio of the input transformer is arranged to be 3 : 2 such that a unity total voltage gain can be obtained at the maximum modulation index. The sampling frequency for the modulation is 1.8 kHz. Based on the earlier-described switching pattern, each device in the converter is operated at around two third of the sampling frequency, i.e. 1.2 kHz.

45

v AN

v AB

iABC

Fig. 2-6 Simulated output voltage and current waveforms of MMMC-I (fo = 40 Hz, ma = 0.9).

v AN

v AB

iABC

Fig. 2-7 Simulated output voltage and current waveforms of MMMC-I (fo = 80 Hz, ma = 0.9).

46

400 200 0 -200 -400 400 200 0 -200 -400 400 200 0 -200 -400 400 200 0 -200 -400 400 200 0 -200 -400

i1wa (A)

i1a

(A)

isa (A)

i3a (A)

ia

(A)

THD = 7.27%

30

40

50

60

70

80

90

t (ms)

Fig. 2-8 Simulated input current waveforms of MMMC-I (fo = 40 Hz, ma = 0.9).

In Fig. 2-6 and Fig. 2-7, typical waveforms of output voltage and current are illustrated for output fundamental frequencies of 40 Hz and 80 Hz, respectively. The figures show that the converter is able to yield output frequencies either lower or higher than that of the input. The output voltages are seen to be synthesized with chopped segments from the input voltages. Under a modulation index of 0.9, the line-to-line output voltage, v AB , has an rms 47

value around 1200 V in both figures, almost equaling 0.9 times of the input voltage magnitude. The output currents are continuous sinusoidal waveforms and have a relatively low THD in both figures, which is due to the smoothing effect of the inductive load. Fig. 2-8 shows the input current waveforms of MMMC-I when the output fundamental frequency is 40 Hz. The currents at the input port of the MC module are composed of chopped pulses from the load currents. Due to the presence of filtering capacitance and line inductance, the secondary winding currents i1a , i2 a , and i3a become continuous waveforms, despite the fact that they do not have a very sinusoidal shape. However when it comes to the primary winding, the three secondary currents, after being referred to the primary side, add up to the total input line current ia , which can be seen from the figure as a sinusoid with a THD of 7.27%.

2.3.2 Simulation Results for MMMC-II
With switching periods for modules in series evenly displaced, Fig. 2-9 and Fig. 2-10 present a set of typical output voltage and current waveforms of MMMC-II at fundamental frequencies of 40 Hz and 80 Hz, respectively. As mentioned earlier, a total of three MMMC-I modulators are required for modulating the MMMC-II. Each modulator should have an input displacement angle i that matches the phase shift of the supplying secondary winding of the transformer. Due to the cascaded structure and the displaced switching period arrangement, output phase-to-neutral (vAN) and line-to-line (vAB) voltages of MMMC-II possess multilevel waveform shapes and are associated with significantly reduced THD and dv/dt comparing to their counterparts of MMMC-I in Fig. 2-6 and Fig. 2-7. Accordingly, the quality of the load current waveforms is also improved.

48

v AN

v AB

iABC

Fig. 2-9 Simulated output voltage and current waveforms of MMMC-II (fo = 40 Hz, ma = 0.9).

v AN

v AB

iABC

Fig. 2-10 Simulated output voltage and current waveforms of MMMC-II (fo = 80 Hz, ma = 0.9).

49

Fig. 2-11 illustrates the input current waveforms of MMMC-II. In this figure, the current waveforms at the input port of the MC module and in the secondary winding of the transformer have similar shapes to those in Fig. 2-8. On the primary side, the current components coming from the secondary windings that have the same phase shift, e.g. +20º, add up and form a sinusoidal waveform of ia _ 20 . It is then further combined with currents from the other secondary winding groups to build the total input current, ia , whose THD is as low as 2.65% thanks to the harmonic elimination capability of the phase-shifting transformer.

i1wa

i1a

ia _ 20

ia

Fig. 2-11 Simulated input current waveforms of MMMC-II (fo = 40 Hz, ma = 0.9).

50

Fig. 2-12 shows the adjustable input power factor of MMMC-II by varying the input displacement angle i in the modulation program. The input power factor of the converter can be freely adjusted to be unity, leading, or lagging. It should be noted that being a part of the nature of a direct frequency converter, a phase shift in i is a compromise on the voltage gain and will reduce the maximum obtainable output voltage magnitude. This can be clearly seen from the equation of (2.11).

400 200 0 -200 -400 400 200 0 -200 -400 400 200 0 -200 -400

va

(x 10 V)

ia
va

(A)

400 200 0 -200 -400

ia
va
(x 10 V)

ia

(A)

400 200 0 -200 -400

va

(x 10 V)

ia

(A)

400 200 0 -200 -400

30

35

40

45

50

55

t (ms)

Fig. 2-12 Adjustable input power factor of MMMC-II (fo = 40 Hz, ma = 0.9).

2.4 Experimental Verification
In addition to simulation results, a scaled-down low-voltage experimental prototype consisting of nine 3 x 2 MC modules has been built to verify the modulation concepts. Each 51

MC module is equipped with the necessary bidirectional switches, isolated gate drivers, as well as sensor circuits for voltage and current measurement. Field programmable gate arrays (FPGAs) are used to realize the modulation function, dispatch gating signals, and handle device commutations. Details about the experimental setup implementation are provided in Chapter 5. Both MMMC-I and MMMC-II are tested on the platform supplied by 208 Vrms / 60 Hz grid voltage. Detailed experimental system parameters are listed in Table 2-2. The per-unit values of the passive components under a 5 kW rated power are similar to those provided for the simulations. The phase-shifting transformers used in the experiments have a fixed turns ratio of 2 : 1, therefore, a variac is inserted between the grid and the transformers to adjust the primary to secondary voltage gain.

Table 2-2 Experimental system parameters for direct modulation scheme

System Parameters Grid Input Voltage (line-to-line, rms) Input Frequency Equivalent Transformer Turns Ratio NP : NS Sampling Frequency fs Device Switching Frequency fsw Equivalent Total Line Inductance Ls Filter Capacitance Cf Load Resistance RL Load Inductance LL

Value 208 V 60 Hz 2 : 1 (MMMC-I) 9 : 2 (MMMC-II) 1.8 kHz  1.2 kHz  2 mH ( 0.087 pu) 66 F (0.21 pu) 7.9  (0.91 pu) 5 mH (0.22 pu)

52

The experimental waveforms for MMMC-I and MMMC-II acquired from the lab prototype are shown in the following figures. Fig. 2-13 and Fig. 2-14 provide MMMC-I output waveforms at 40 Hz and 80 Hz fundamental frequencies, respectively. The output voltages are fabricated by pieces from the input voltages and match well with their simulation counterparts. The output current is smoothed by the inductive load and appears to be continuous. In Fig. 2-15, the input voltage and current waveforms of phase a are presented. The converter is working at the unity power factor condition as the input voltage and current are in phase. The grid current has visible distortions due to reasons such as polluted grid voltage and LC resonance.

v AN

250V/div 20A/div

v AB

iA

5ms/div

Fig. 2-13 Experimental output voltage and current waveforms of MMMC-I (fo = 40 Hz, ma = 0.9).

53

v AN

250V/div 20A/div

v AB

iA
5ms/div

Fig. 2-14 Experimental output voltage and current waveforms of MMMC-I (fo = 80 Hz, ma = 0.9).

100V/div

20A/div

va ia

5ms/div

Fig. 2-15 Experimental grid voltage and current waveforms of MMMC-I (fo = 40 Hz, ma = 0.9).

54

Fig. 2-16 and Fig. 2-17 illustrate the experimental output waveforms of MMMC-II, with the fundamental frequency lower (40 Hz) and higher (80 Hz) than that of the input (60 Hz). Similar to simulation results, the experimental output voltage waveforms of MMMCII have multilevel waveform shapes and are better in quality than those produced by MMMC-I. The output current waveforms are also improved as a consequence. Fig. 2-18 shows the input-side waveforms of MMMC-II while the output frequency is 40 Hz. Compared to the relatively distorted input current of MMMC-I as shown in Fig. 2-15, the input current waveforms of MMMC-II appear as good sinusoids which can be adjusted by the input displacement angle to be leading, lagging, or in-phase with the grid voltage. The better current waveform of MMMC-II is due to the phase-shifting transformer's harmonic elimination capability which helps improve the input current quality.

v AN

250V/div 20A/div

v AB

iA

5ms/div

Fig. 2-16 Experimental output voltage and current waveforms of MMMC-II (fo = 40 Hz, ma = 0.9).

55

v AN

250V/div 20A/div

v AB

iA

5ms/div

Fig. 2-17 Experimental output voltage and current waveforms of MMMC-II (fo = 80 Hz, ma = 0.9).

va
ia

200V/div 50A/div

va ia va
ia
5ms/div

Fig. 2-18 Experimental grid voltage and current waveforms of MMMC-II (fo = 40 Hz, ma = 0.9).

56

2.5 Summary
In this chapter, studies on two MMMC topologies composed of multiple 3 x 2 MC modules are carried out. The MMMC topologies combine benefits of both multilevel and direct frequency conversion concepts. Similar to the multilevel voltage-source converters, the MMMCs allow the use of low-voltage power semiconductors in the power modules and are able to yield high-quality multi-stepped output waveforms. Moreover, they also possess features as MCs such as elimination of dc components, four-quadrant operation capability, fast dynamic response, sinusoidal input/output quantities, and adjustable input power factor. A direct modulation scheme based on input-output transfer matrix derivation is proposed to control the MMMCs for obtaining sinusoidal voltage/current waveforms on both sides of the converters. The output pulses are generated by the modulation program according to a center-placed double-sided switching pattern. In addition to simulated results, experimental verification has proved that, by targeting the primary side input current synthesis rather than the secondary side, the modulation scheme is able to generate sinusoidal output voltage and input current waveforms simultaneously, with the amplitude, frequency, and power factor all adjustable. For MMMC-II, owing to the cascaded structure and switching period displacements, multilevel output waveforms with superior quality can be readily achieved. It should be mentioned that the input phase-shifting transformer plays an important role in the MMMC-II system, helping improve the input current quality with its harmonic elimination capability.

57

Chapter 3 Indirect Space Vector Based Modulation Scheme for the MMMCs

In the previous chapter, a direct modulation scheme for the multimodular matrix converters (MMMCs) has been developed. By taking modules from all three phases as an integral for transfer matrix derivation and applying coordinated control, the direct modulation scheme is able to make the converters produce sinusoidal waveforms on both sides. Taking a different approach, this chapter is dedicated to the design of indirect space vector based modulation techniques for the MMMCs. It will be explained that although composed of 3 x 2 MC modules, the MMMCs can still adopt the classic rectifier ­ fictitious dc-link ­ inverter concept and be modeled indirectly if viewed from a certain perspective. Consequently, indirect space vector modulation (SVM) techniques can be developed based on the established circuit model. In the proposed methods, a current-source rectifier (CSR) SVM is employed to calculate duty ratios and determine switching states for the rectifier stage; while for the inverter stage, output voltage synthesis from either a two-level voltagesource inverter (VSI) SVM or a three-level VSI SVM is feasible. The duty ratios and switching states are then converted and combined to be mapped to the real switching devices. Finally, the gate signals are generated according to two output switching patterns, one being the same center-placed double-sided pattern as used for the direct modulation scheme, whereas the other has a different arrangement for negative half-cycle pulses. The second pattern produces voltage waveforms with significantly improved harmonic 58

performance. Its superiority over the conventional pattern will be explained and demonstrated with simulation and experimental examples.

3.1 Indirect Modeling for the MMMCs

Fig. 3-1 Simplified diagram of three-module MMMC-I.

A simplified diagram of the three-module MMMC-I is redrawn in Fig. 3-1 for the explanation of the indirect circuit modeling. As mentioned earlier, the converter is composed of a four-winding input transformer, three 3 x 2 MC modules, and supplies a 59

three-phase inductive load. The switching states in the MC modules have to comply with a switching constraint. Taking the first module as an example, only two switches (one from S11, S12 and S13 and the other from S14, S15 and S16) should be ON at any instant of time to avoid detrimental short circuit of the filter capacitors and current interrupt in the inductive load.

Fig. 3-2 Indirect model for MMMC-I using the fictitious dc concept.

For conventional 3 x 3 MCs, modulation schemes based on both direct and indirect models are well studied in the literature [15, 50, 53]. While the direct model takes the converter as a whole for the derivation of system transfer function matrix, the indirect model separates the MC into a rectifier stage and an inverter stage which are coupled to each other through an imaginary dc-link without real components. Accordingly, the transfer function for the entire system can be obtained as the product of the individual transfer functions of the rectifier and the inverter. As for the three-module MMMC-I, the same indirect modeling concept can be applied to all the power modules such that they can be regarded as a fictitious three-phase rectifier coupling with a fictitious single-phase inverter. 60

Then, if we consider the transformer as merely an isolation stage with a gain determined by its turns ratio, and assume the rectifier stages of all three modules are operated synchronously by the same gate signals (i.e. the same input line-to-line voltage is impressed onto the fictitious dc stages of these modules at any time), an equivalent indirect circuit model for MMMC-I can be derived in Fig. 3-2. The model is composed of a common rectifier part, a dc-link isolation stage represented by three "dc transformers [58]" (TS1, TS2, TS3), and an inverter part consisting of two sets of three-phase output ports (A-B-C and A'B'-C'). The rectifier stage of the model is identical to that of the conventional 3 x 3 MC's. As the switches are controlled by the modulation program to synthesize sinusoidal input currents, line-to-line voltages from the three-phase ac source are impressed on the dc-link. The dc-link voltage would then be transferred to the secondary side of the transformers and utilized by the inverter to fabricate output voltages. It should be noted that the three dc transformers have the same turns ratio (Ns / Np), and their voltage/current characteristics are no different from those of an ideal ac transformer. Therefore, the load currents in their secondary windings are also transformed to the primary side, summed and then utilized by the rectifier modulation program as the dc current source for input current synthesis. In the original MMMC-I as shown in Fig. 3-1, the voltage/current relationship between the input and output ports can be expressed as follows (taking input port a and output port AA' as an example and neglecting the current on the filter capacitor)

v AA ' 

NS [vab ( S11  S15  S14  S12 )  vbc ( S12  S16  S15  S13 ) NP

(3.1)

vca ( S13  S14  S16  S11 )] ia  NS [iA ( S11  S14 )  iB ( S21  S 24 )  iC ( S31  S34 )] NP (3.2)

61

where Sjk denotes the state of a bidirectional switch (0-OFF, 1-ON), subscript j indicates the module number, and k indicates the switch number; Ns / Np represents the secondary-toprimary turns ratio of the input transformer. Taking account of the switching constraint mentioned earlier, vAA' consists only of scaled input line-to-line voltage pieces and zero. In the indirect model of MMMC-I (redrawn in Fig. 3-3 with single-pole single-throw switches), the voltage/current relationship of the input/output ports can be derived as follows (again taking input port a and output port AA' as an example):

v AA ' 

NS ( S Ap  S A ' p )[vab ( Sap  Sbn  San  Sbp ) NP

(3.3)

vbc ( Sbp  Scn  Sbn  Scp )  vca ( Scp  S an  Scn  S ap )] ia  NS ( S ap  San )[iA ( S Ap  S A ' p )  iB ( S Bp  S B ' p ) NP

(3.4)

iC ( SCp  SC ' p )].

Note that switching constraints exist for the symbolic switches in the indirect model as well. For the rectifier stage switches, the constraints are the same as those for a CSR; whereas for the inverter stage switches, the constraints are identical to those for a two-level VSI. The two equations of (3.3) and (3.4) serve as the mathematical base for the circuit model in Fig. 3-3; corresponding switching states can always be found making them equivalent to (3.1) and (3.2).

62

Fig. 3-3 Indirect model for MMMC-I with single-pole single-throw switches.

3.2 CSR SVM for Rectifier Stage Calculations
The indirect circuit model developed for MMMC-I in the last section facilitates the design of suitable indirect space vector modulation (SVM) schemes. Similar to what was used in the conventional 3 x 3 MC, the basic idea of an indirect modulation scheme is to separately apply SVM to the rectifier and inverter stages, before combining their switching states to produce the final gate signals. For the rectifier stage, a traditional SVM for operating current-source rectifiers (CSRs) can be readily employed. Its space vector diagram and synthesis of the current reference vector are shown in Fig. 3-4. With reference   to the circuit model in Fig. 3-2, the stationary vectors ( I 0 ~ I 6 ) in Fig. 3-4 correspond to the
 positions of the rectifier switches Srp and Srn. For instance, I1 ( ab ) indicates that Srp is

63

connected to input phase a whereas Srn is clamped to phase b, therefore, the primary side dc-link voltage vpn is equal to vab. The CSR SVM assumes the total dc-link current, ip, is constant and uses it as a current source for generation of the input currents. At any instant of time, the reference vector is synthesized by two adjacent active vectors and a zero vector. The duty ratios of the constituent vectors can be calculated by

d u  mc sin( / 3   sec )   d v  mc sin( sec )   d o  1  du  d v

(3.5)

where mc represents the rectifier stage modulation index, which is normally set to unity because the input current magnitude actually depends on the load; while sec denotes the sector angle of the reference vector I ref (the angle between I ref and its adjacent active vector on the clockwise side). It can be noticed that, during any switching period, the two active vectors for synthesizing the reference current vector cause two different line-to-line voltages to be impressed onto the dc-link. In view of the fact that zero vectors have no contribution to the effective dc-link voltage, the local average of the dc-link voltage over a switching period can be expressed in terms of the averaged line-to-line voltages weighted with their respective duty ratios





v pn  vll1du  vll 2 d v .

(3.6)

64

As an example, suppose I ref dwells in Sector I, since the two adjacent active vectors in
  this case are I1 and I 2 , the effective part of the dc-link voltage at the primary side of the



transformers would be a combination of segments from vab and vac.



 I 3 (bc)
 I 2 (ac)
 dv Iv

 Iv

 I 4 (ba )

i
 I0 (aa, bb, cc)

 I ref



 I ref
 I0

sec
 du I u
 Iu

 I 5 (ca )

 I1 (ab)
 I 6 (cb)

Fig. 3-4 CSR SVM for rectifier stage current synthesis.

3.3 Two-level VSI SVM for Inverter Stage Calculations
3.3.1 Duty Ratio Calculation
Provided the rectifier input voltages are three-phase balanced, the value of v pn remains a constant throughout all the sectors [15]. In addition, because the three dc transformers (TS1, TS2, TS3) have the same turns ratio and therefore identical voltage gain, the secondary voltages obtainable at ports (pA-nA), (pB-nB) and (pC-nC) are all equal. These prerequisites establish a basis for the inverter stage to adopt voltage-source inverter (VSI) SVM 65

techniques which requires an invariable dc source to generate sinusoidal output voltage waveforms. The two-level VSI SVM diagram for the inverter stage is shown in Fig. 3-5. As mentioned earlier, the inverter stage of the model can be regarded as two sets of three-phase outputs. Hence, the reference voltage vector, Vref , represents the desired three-phase
' voltages to be synthesized at ports (A-B-C), while Vref represents the voltages at the other





three-phase output ports (A'-B'-C'). In the actual converter, since the latter ports are connected to form the reference neutral point N, the real output phase voltages vAN, vBN, and vCN can be viewed as a vectorial combination of vABC and vA'B'C'.

 V3 (npn)



 V2 ( ppn)

Sector 2
 V4 (npp)

 Vref

 Vy

Sector 3

v

Sector 1

 d yVy
 V1 ( pnn)


 Vref

 Sector 4 Sector 6 V0 ' ( ppp) Vref (nnn) Sector 5   V5 (nnp ) V6 ( pnp )

 V0

sec

Sector n

 d xVx

 Vx

Fig. 3-5 Two-level VSI SVM for inverter stage voltage synthesis.

In Fig. 3-5, the VSI switching states are listed in the parentheses beside their respective   stationary vectors ( V0 ~ V6 ). Letter p or n in each switching state indicates whether the corresponding output phase should be clamped to the positive or the negative rail of the dc66

' link, respectively. As shown in the figure, it is preferable to set Vref in the opposite



direction of Vref , for this disposition not only allows maximum voltage utilization, but also results in the minimum SVM computation burden. This is because the duty ratios of the
' active vectors adjacent to Vref are always the same as those of Vref ' s ; moreover, the







switching states pertaining to their active vectors are always complementary. For example, consider the situation that Vref is in Sector 1, the two active vectors for its synthesis are
  V1 ( pnn) and V2 ( ppn ) whose duty ratios are dx and dy, respectively; in this case, the



'  corresponding active vectors for synthesizing Vref in Sector 4 would be V4 (npp) and
 V5 (nnp) . Obviously, switching states of these two vectors are the exact inverse to those of   V1 and V2 . Additionally, their respective duty ratios are also dx and dy. As a result, duty

ratio calculation for all the vectors needs to be done only once using the following formulas

d x  mv sin( / 3   sec )   d y  mv sin( sec )   d z  1  d x  d y

(3.7)

where mv designates the inverter modulation index which can be used to adjust the output voltage magnitude, and sec denotes the sector angle of Vref . Assuming the inverter supplies a three-phase balanced inductive load (RL or ac machine), the sinusoidal output voltages generated by SVM result in continuous load currents that are also three-phase balanced. During every switching period, as the inverter dwells in the two switching states pertaining to the active vector pair for reference voltage 67



synthesis, the corresponding load currents are introduced into the dc-link. Taking again the
' example of when Vref is in Sector 1 ( Vref in Sector 4), since the switching states for (A-B-C)





and (A'-B'-C') are ( pnn, ppn) and ( npp, nnp ) , the secondary winding currents of the dc transformers (ise1, ise2, ise3) in a single switching period would be a combination of (iA, -iB, -

iC) and (iA, iB, -iC). Accordingly, the local average of the total dc-link current at the primary side of the transformers can be expressed as a function of the averaged load currents weighted with their duty ratios

ip  ipr1  ipr 2  ipr 3  N s N p   ise1  ise 2  ise 3   N s N p  (2 iA d x  2 iC d y )

(3.8)

in which Ns / Np represents the turns ratio of the transformers. Under balanced load currents condition, the value of ip remains a constant regardless of the position of Vref . The dc-link current requirement of the rectification stage SVM is therefore satisfied.



3.3.2 Duty Ratio Conversion
In order to facilitate the design of optimized switching sequence, the duty ratios calculated by the two-level VSI SVM are then converted using a per phase approach. The conversion process is detailed in Table 2-1 for all six sectors. Delivered by the conversion are new duty ratios that represent the percentages of a switching period, during which the
68

Table 3-1 Duty ratio conversion for the inverter stage with the two-level SVM Sector  of Vref AA'-BB'CC' pn-np-np Original duty ratio dx

A-B-C

A'-B'-C'

Duty ratio conversion

 V1 ( pnn)
1

 V4 (npp)  V5 (nnp)  V5 (nnp)  V6 ( pnp)  V6 ( pnp)  V1 ( pnn)
 V1 ( pnn)  V2 ( ppn)  V2 ( ppn)  V3 (npn)  V3 (npn)  V4 (npp)

 V2 ( ppn)  V2 ( ppn)
2

pn-pn-np

dy

dAp = dx + dy; dAn = 0; dAo = 1 - dAp - dAn; if (dx > dy) then (dBp = 0; dBn = dx - dy) else (dBp = dy - dx; dBn = 0); dBo = 1 ­ dBp ­ dBn; dCp = 0; dCn = dx + dy; dCo = 1 ­ dCp ­ dCn;

pn-pn-np

dx

 V3 (npn)  V3 (npn)
3

np-pn-np

dy

if (dx > dy) then (dAp = dx - dy; dAn = 0) else (dAp = 0; dAn = dy - dx); dAo = 1 ­ dAp ­ dAn; dBp = dx + dy; dBn = 0; dBo = 1 ­ dBp ­ dBn; dCp = 0; dCn = dx + dy; dCo = 1 ­ dCp ­ dCn;

np-pn-np

dx

 V4 (npp)
 V4 (npp)
4

np-pn-pn

dy

dAp = 0; dAn = dx + dy; dAo = 1 - dAp - dAn; dBp = dx + dy; dBn = 0; dBo = 1 ­ dBp ­ dBn; if (dx > dy) then (dCp = 0; dCn = dx - dy) else (dCp = dy - dx; dCn = 0); dCo = 1 ­ dCp ­ dCn;

np-pn-pn

dx

 V5 (nnp)  V5 (nnp)
5

np-np-pn

dy

dAp = 0; dAn = dx + dy; dAo = 1 - dAp - dAn; if (dx > dy) then (dBp = dx - dy; dBn = 0) else (dBp = 0; dBn = dy - dx); dBo = 1 ­ dBp ­ dBn; dCp = dx + dy; dCn = 0; dCo = 1 ­ dCp ­ dCn;

np-np-pn

dx

 V6 ( pnp)  V6 ( pnp)
6

pn-np-pn

dy

if (dx > dy) then (dAp = 0; dAn = dx - dy) else (dAp = dy - dx; dAn = 0); dAo = 1 ­ dAp ­ dAn; dBp = 0; dBn = dx + dy; dBo = 1 ­ dBp ­ dBn; dCp = dx + dy; dCn = 0; dCo = 1 ­ dCp ­ dCn;

pn-np-pn

dx

 V1 ( pnn)

pn-np-np

dy

dAp = dx + dy; dAn = 0; dAo = 1 - dAp - dAn; dBp = 0; dBn = dx + dy; dBo = 1 ­ dBp ­ dBn; if (dx > dy) then (dCp = dx - dy; dCn = 0) else (dCp = 0; dCn = dx - dy); dCo = 1 ­ dCp ­ dCn;

69

output phase voltages (vAA', vBB', vCC') are equal to the positive dc-link voltage, the negative dc-link voltage, or zero. As can be noticed, when Vref is in Sector 1, the output state for AA'
    is pn under both active vector pairs ( V1 ( pnn) - V4 (npp) , V2 ( ppn ) - V5 (nnp) ), thus, the



resultant duty ratio dAp for AA' being pn is the sum of dx and dy, while dAn for AA' being np is 0, and dAo for AA' being pp or nn is 1-dx-dy; As for phase B, due to the fact that dx and dy correspond to opposite output states for BB' (np and pn), a judgment on which one has more significance is required to determine the results; For phase C, the calculations are similar to those of phase A because the output state for CC' remains to be np under both active vector pairs.

3.4 Three-level VSI SVM for Inverter Stage Calculations
3.4.1 Duty Ratio Calculation
In the last section, the inverter stage of the MMMC-I indirect model is regarded as a pair of three-phase output sets, and accordingly, the desired output voltage for driving the load can be synthesized from the combination of two opposite voltage reference vectors rotating in the two-level space vector diagram. Nonetheless, if viewing from another standpoint, it is also possible to consider the inverter stage of the model as three output port pairs (AA', BB', CC'), and the voltage obtainable at each port pair can be freely selected from three possible values which correspond to different switching states. Taking AA' as an example, the voltage vAA' supplied by the first dc transformer may arbitrarily adopt a value of +vse1, -vse1, or 0. Furthermore, because the rectifier stage is commonly shared and the transformers are identical, the voltages at the secondary side of the transformers are all the same and equal to

70

 V15(npn)  V3

 V8 (opn)



 V14 ( ppn)

 V9 (npo)

(opo) (non) (opp ) (noo)
 V4

 V2

( ppo) (oon)

 V7 ( pon)

 V16(npp )

 Vref
 V13( pnn)


( ppp ) (nnn)

 V0

(ooo)

v

( poo)  V1 (onn)

 V10(nop )

(oop ) (nno)  V5
 V17 (nnp )

( pop )  (ono) V6
 V11(onp )

 V12( pno)

 V18( pnp )

 Vy

dx D
d z D Vref

dyD
 Vx

Triangle n

 Vz

Fig. 3-6 Three-level VSI SVM for inverter stage voltage synthesis.

71

vse1  vse 2  vse 3  N s / N p  v pn

(3.9)

where Ns / Np represents the secondary-to-primary turns ratio of the transformers. If we take all three phases into account, a three-level VSI SVM diagram as shown in Fig. 3-6 can be employed for the derivation of inverter stage duty ratios and switching states, as a viable alternative to the two-level VSI SVM described in the last section. For the three-level SVM, the reference vector is normally synthesized by the three nearest stationary vectors for better harmonic performance. The equations in [23] for neutral-point-clamped converter modulation can be used to calculate duty ratios of stationary vectors in all the sectors.

Table 3-2 Example of dc-link currents expressed in terms of the load currents

Triangle

Inverter Vectors

Duty Ratio

dc-link Current ip
N s / N p  iA

 V1 ( poo, onn)

2  2mv sin(   v ) 3



   V1  V7  V13

 V7 ( pon)

2mv sin v

N s / N p  (iA  iC )

 V13 ( pnn)

2mv sin(  v )  1 3



N s / N p  2iA

In the indirect model of MMMC-I, the rectifier and inverter stages are coupled to each other through the ideal transformers, so the load currents introduced into the dc-link by the 72

inverter stage SVM are directly utilized by the rectifier stage modulation program for synthesis of input currents. It is always required that the local average of the dc-link current be a constant when the output voltage reference vector rotates in the space vector plane.
 As shown in Fig. 3-6, assume at a certain time the output voltage reference vector ( Vref )

   stays in the triangle surrounded by V1 , V7 and V13 , the dc-link currents corresponding to

these three vectors are expressed in terms of the load currents in Table 3-2. During an entire  switching period, as the inverter dwells at the three vectors to synthesize Vref , the average dc-link current can be derived as follows

ip  [2  2mv sin(   v )]  ( N s / N p  iA ) 3
[2mv sin  v ]  [ N s / N p  ( iA  iC )]  [2mv sin(   v )  1]  ( N s / N p  2 iA ). 3



(3.10)



Assume the load is three-phase balanced, the load currents can be written as

iA    V ^ iB   L   Z  iC  

cos( v   L )      cos( v   L  2 / 3)      cos( 2 / 3)      v L  

(3.11)

^ , Z , and  designate the magnitude of the output voltage, the impedance of in which V L L

the load, and the load power factor angle, respectively. Substituting (3.11) into (3.10) and after a series of deductions, we have 73

ip 

^ Ns V  L  mv  3 cos  L Np Z

(3.12)

which is a constant value irrespective of any changing variables. The deductions can be applied to all the other triangles and the same result of (3.12) holds true. Therefore, the local average of the dc-link current is proved to be a constant throughout all the sectors and can be utilized by the rectifier SVM for the synthesis of input currents.

3.4.2 Duty Ratio Conversion
Similar to the two-level inverter stage modulation, to facilitate the design of optimized switching sequence, the duty ratios of the vectors calculated by the three-level VSI SVM are then converted using a per phase approach as well. The conversion procedure is    exemplified in Table 3-3 for the triangle V1  V7  V13 . Delivered by the conversion are new duty ratios that represent the percentages of a switching period during which the output phase voltages (vAA', vBB', vCC') are equal to the positive dc-link voltage, the negative dc-link voltage, or zero. The original vectors, their switching states, as well as the corresponding duty ratios are all listed in the table. For small vectors that have redundant switching states, the duty ratio is distributed evenly between the two states. For example, since the small  vector V1 ( poo, onn) has a duty ratio of d1, both of its two switching states (poo and onn)

    would have a share of d1/2. Hence, as Vref is synthesized by V1 , V7 and V13 , the output state
   of AA' is p for d7 ( V7 ), d13 ( V13 ), and a half of d1 ( V1 ( poo) ); the resultant duty ratio dAp for

74

AA' being p is therefore d1/2 + d7 + d13, whereas dAn for AA' being n is 0, and dAo for AA' being zero is 1 - dAp - dAn. Similar calculations can be applied to phases B and C.

Table 3-3 Example of duty ratio conversion for the inverter stage with the three-level SVM
Inverter Vectors Original Duty Ratio

Triangle

Duty Ratio Conversion

 V1 ( poo, onn)
   V1  V7  V13

d1 dAp = d1/2 + d7 + d13; dAn = 0; dAo = 1 - dAp - dAn;

 V7 ( pon)  V13 ( pnn)

d7

dBp = 0; dBn = d1/2 + d13; dBo = 1 ­ dBp ­ dBn; dCp = 0; dCn = d1/2 + d7 + d13; dCo = 1 ­ dCp ­ dCn;

d13

3.5 Switching State Combination
After all the switching states and duty ratios for both stages of the indirect model are determined, the next step is to combine them and generate final gate signals for the actual devices. To make possible the combination it is required that the switching periods of both stages are equal and synchronized. Since the per phase forms of the output stage duty ratios have been derived in the last subsections, it is now convenient to explain the process using the example of the first MC module in Fig. 3-1. Assume the input current reference vector stays in Sector I in a certain switching period Ts, the rectifier stage is therefore supposed to   dwell at I1 ( ab ) for a duty ratio of du and at I 2 ( ac ) for a duty ratio of dv. If in the meantime, the desired output voltage at port AA' is positive, duty ratio dAp which represents the percentage of AA' being pn has a positive finite value whereas dAn would be zero. Taking account of both stages then leads to the final distribution of the switching period: AA' should be connected to (ab) for an interval of dudApTs and be connected to (ac) for another 75

interval of dvdApTs; throughout the rest of the switching period, AA' will adopt the state pp and output a zero voltage, which implies both A and A' are connected to input phase a, a choice that results in the minimum number of switchings.

Table 3-4 Switching state combination for 3 x 2 MC Module 1

Rectifier State

Inverter State (AA') pn

Devices ON S11, S15 S12, S14 S11, S14 / S12, S15 S11, S16 S13, S14 S11, S14 / S13, S16 S12, S16 S13, S15 S12, S15 / S13, S16 S12, S14 S11, S15 S12, S15 / S11, S14 S13, S14 S11, S16 S13, S16 / S11, S14 S13, S15 S12, S16 S13, S16 / S12, S15

ab

np pp / nn pn

ac

np pp / nn pn

bc

np pp / nn pn

ba

np pp / nn pn

ca

np pp / nn pn

cb

np pp / nn

Table 3-4 lists all the possible switching state combinations for MC module 1. The corresponding real devices that should be turned ON are also provided. From the table it can be seen that if the rectifier stage stays at (ab) while AA' is outputting a positive voltage,

76

the devices that should be ON are S11 and S15. For modules 2 and 3, the combination process is similar. It should be noted that the output state designations listed in the table are from the twolevel SVM method. For the three-level SVM method, the output states of p, o, and n are equivalent to pn, pp/nn, and np from the two-level SVM method, respectively.

3.6 Switching Pattern Design
During a single switching period, the order in which the obtained intervals are put affects the switching frequency and harmonic performance. This necessitates the design of suitable switching patterns to make final the modulation program with optimized results. Fig. 3-7 and Fig. 3-8 illustrate two different switching patterns which are exemplified for output phases A and B. To distinctly show their difference, it is assumed the desired vCN in this particular switching period is zero, while vAN is positive, and vBN is negative. Under this condition, the duty ratios and thus pulse widths for phases A and B are exactly the same. In the figure VLL1 and VLL2 denote the two magnitudes corresponding to the two input line-toline voltages impressed on the dc-link. With the presumption that the switching frequency is sufficiently higher than the output fundamental frequency, they are considered as constants during the entire switching period. The duty ratios d0, d1, and d2 represent the final values derived from the earlier described switching state combination process. In the case being shown, d2 is greater than d1. The first switching pattern is actually the same as the one used for the direct modulation scheme in Chapter 2. And as can be noticed from the figures, both switching pattern I and II provide the same output in phase A whose voltage polarity is positive. The main distinction lies in phase B where the negative voltage output is differently arranged. In Fig. 77

3-7, the shape of vBN appears to be a mirrored image to vAN with respect to the horizontal axis, causing the line-to-line voltage vAB to have the same double-sided center-placed pattern. However in Fig. 3-8, the pulses in phase B are equally split and placed at both sides of the switching period. With this arrangement, the effective part of vAB is more evenly distributed and associated with lower voltage step jumps. It will be demonstrated that the second pattern brings better harmonic performance in the generated waveforms.

VLL 2 VLL1

0

d 0Ts / 2
0

d1Ts / 2

d 2Ts

d1Ts / 2

d 0Ts / 2

-VLL1 -VLL 2

d 0Ts / 2
2VLL 2

d1Ts / 2

d 2Ts

d1Ts / 2

d 0Ts / 2

2VLL1

0

Fig. 3-7 Output switching pattern I

78

VLL 2 VLL1

0 d 0Ts / 2 0
-VLL1 -VLL 2
d 2Ts / 2
d1Ts / 2

d1Ts / 2

d 2Ts

d1Ts / 2

d 0Ts / 2

d 0Ts

d1Ts / 2

d 2Ts / 2

2VLL1 VLL 2 VLL1

0

Fig. 3-8 Output switching pattern II.

3.7 Simulation Results
To verify the presented indirect modulation schemes, converter models and simulation programs are implemented and tested in MATLAB/Simulink. In the created models, the converters are used to supply a three-phase RL load. System parameters for the simulations are the same as those listed in Table 2-1. A functional diagram illustrating the software 79

implementation of the modulation scheme is given in Fig. 3-9. During the simulation, the modulation program accepts modulation index and angle settings and outputs the final gate signals. Under a sampling frequency of 1.8 kHz, the actual device switching frequency is around 1.2 kHz under both switching patterns.

mc = 1, i

mv, v

Rectifier SVM

Inverter SVM Inversion stage duty ratio and switching states Duty Ratio Conversion Per-phase forms

Rectification stage duty ratio and switching states

Duty Ratio and Switching State Combination Gate signals according to the selected switching pattern MMMC Circuit

Fig. 3-9 Functional block diagram of the indirect modulation scheme implementation.

80

3.7.1 Simulation Results for MMMC-I
Using the proposed indirect modulation techniques, typical output voltage and current waveforms of MMMC-I obtained under the two switching patterns are shown in Fig. 3-10 and Fig. 3-11. For the inverter stage calculations, both the two-level and three-level SVM methods provide the same results, and the following waveforms are derived with the twolevel method. In Fig. 3-10 and Fig. 3-11, the output fundamental frequency is 40 Hz while the total modulation index ma is 0.9. Being the product of the individual modulation indices of the rectifier and inverter, ma is essentially equal to mv as a result of the rectifier's mc set to unity. The waveforms of the phase voltage vAN are composed of chopped segments from the inputs. Its shapes in both figures are similar and the THDs are also on a same level. However, when it comes to vAB, the quality improvement brought by Pattern II becomes distinct. Unlike the one obtained under Pattern I in Fig. 3-10 which has a THD of 56.60%, in Fig. 3-11, the center part pulses of the half cycles of vAB does not return to zero, leading to a waveform closer to sinusoid with a much reduced THD of 36.19%. Accordingly, the load currents in Fig. 3-11 also have better waveform shapes with a THD as low as 2.48% compared to the 5.68% in Fig. 3-10. Fig. 3-12 shows the output voltage and current waveforms of MMMC-I under Pattern II with the output frequency changed to 80 Hz. It verifies that by adjusting the reference vector's rotational speed, the modulation program is able to generate output frequencies either lower or higher than the input.

81

v AN

v AB

iABC

Fig. 3-10 Simulated output voltage and current waveforms of MMMC-I (Pattern I, fo = 40 Hz, ma = 0.9).

v AN

v AB

iABC

Fig. 3-11 Simulated output voltage and current waveforms of MMMC-I (Pattern II, fo = 40 Hz, ma = 0.9).

82

v AN

v AB

iABC

Fig. 3-12 Simulated output voltage and current waveforms of MMMC-I (Pattern II, fo = 80 Hz, ma = 0.9).

ia

ia

Fig. 3-13 Simulated input current waveforms of MMMC-I (a) Pattern I. (b) Pattern II. (fo = 40 Hz, ma = 0.9).

83

Fig. 3-13 illustrates the current waveform of input phase a under both switching patterns. Because the input currents are synthesized from load current pieces, a better waveform quality can be noticed under Pattern II in Fig. 3-13(b) with a lower THD.

3.7.2 Simulation Results for MMMC-II
Consisting of nine MC modules, the MMMC-II topology requires three MMMC-I modulators to operate. Each of them controls a group of three modules supplied by secondary windings that have the same phase shift. As described earlier in Chapter 2, in order to get multilevel waveforms at the outputs, switching periods of the three modulators are displaced from each other by one thirds of an entire cycle. Additionally, the initial angles of the input current reference vectors are adjusted to match their respective winding phase shifts (+20º, 0º, or -20º). Fig. 3-14 and Fig. 3-15 present typical output voltage and current waveforms of MMMC-II under both switching patterns. In both figures the output fundamental frequency is 40 Hz and the modulation index is 0.9. Due to the higher number of waveform levels in the multi-stepped output voltage, all the results given here have significantly better waveform quality than their counterparts of MMMC-I in Fig. 3-10 and Fig. 3-11. Again, the output line-to-line voltage and load currents obtained under Pattern II possess better harmonic performance than those under Pattern I.

84

v AN

v AB

iABC

Fig. 3-14 Simulated output voltage and current waveforms of MMMC-II (Pattern I, fo = 40 Hz, ma = 0.9).

v AN

v AB

iABC

Fig. 3-15 Simulated output voltage and current waveforms of MMMC-II (Pattern II, fo = 40 Hz, ma = 0.9).

85

v AN

v AB

iABC

Fig. 3-16 Simulated output voltage and current waveforms of MMMC-II (Pattern II, fo = 80 Hz, ma = 0.9).

Fig. 3-16 shows the output waveforms of MMMC-II under Pattern II for a higher output fundamental frequency (80 Hz). Fig. 3-17 gives the input current waveforms of MMMC-II under both switching patterns. Thanks to the harmonic elimination capability of the 18pulse transformer, the waveform quality of the input currents is further improved comparing to those shown in Fig. 3-13. In Fig. 3-18, it shows that by controlling the angle of the input current reference vector, the input power factor of MMMC-II can be arbitrarily adjusted to be unity, leading, or lagging.

86

ia

ia

Fig. 3-17 Simulated input current waveforms of MMMC-II (a) Pattern I. (b) Pattern II. (fo = 40 Hz, ma = 0.9).

va

ia
va

ia

va

ia va ia

va

ia va ia

Fig. 3-18 Adjustable input power factor of MMMC-II (Pattern II, fo = 40 Hz, ma = 0.9).

87

3.8 Experimental Verification
The proposed indirect modulation techniques are further tested on the low-voltage prototype with the system parameters listed in Table 2-2. Same as the experiments for the direct modulation scheme presented in the last chapter, all the waveforms are obtained from the setup supplying an RL load, with a 5 kW rated power and fed by 208 Vrms line-to-line grid voltage. The following section provides the experimental waveforms obtained under the indirect modulation scheme under both switching pattern I and II. In Fig. 3-19 and Fig. 3-20, output waveforms of MMMC-I under switching pattern I and II are presented for an output fundamental frequency of 40 Hz. Similar to the simulation results, although the phase-to-neutral voltage vAN has close waveform shapes under both patterns, switching pattern II provides a waveform with significantly better quality when it comes to the line-to-line voltage vAB. Correspondingly, the load current waveform in Fig. 3-20 under pattern II is also much smoother than that in Fig. 3-19. Fig. 3-21 illustrates the output waveforms of MMMC-I under pattern II for a higher output fundamental frequency (80 Hz). By changing the rotational speed of the voltage reference vector in the VSI SVM, the output frequency can be adjusted at will by the modulation program.

88

250V/div 20A/div

v AN

v AB

iA
5ms/div

Fig. 3-19 Experimental output voltage and current waveforms of MMMC-I (Pattern I, fo = 40 Hz, ma = 0.9).

250V/div 20A/div

v AN

v AB

iA
5ms/div

Fig. 3-20 Experimental output voltage and current waveforms of MMMC-I (Pattern II, fo = 40 Hz, ma = 0.9).

89

250V/div 20A/div

v AN

v AB

iA

5ms/div

Fig. 3-21 Experimental output voltage and current waveforms of MMMC-I (Pattern II, fo = 80 Hz, ma = 0.9).

Fig. 3-22, Fig. 3-23 and Fig. 3-24 give the output side waveforms of MMMC-II, which are smoother and closer to sinusoids compared to those of MMMC-I due to their higher steps of multilevel waveform shapes. Same as the MMMC-I, by adjusting the rotational speed of the output voltage reference vector, output frequency either higher (80 Hz) or lower (40 Hz) than the input is achievable.

90

v AN

250V/div 20A/div

v AB

iA

5ms/div

Fig. 3-22 Experimental output voltage and current waveforms of MMMC-II (Pattern I, fo = 40 Hz, ma = 0.9).

v AN

250V/div 20A/div

v AB

iA

5ms/div

Fig. 3-23 Experimental output voltage and current waveforms of MMMC-II (Pattern II, fo = 40 Hz, ma = 0.9).

91

250V/div 20A/div

v AN

v AB

iA
5ms/div

Fig. 3-24 Experimental output voltage and current waveforms of MMMC-II (Pattern II, fo = 80 Hz, ma = 0.9).

On the other side, input voltage and current waveforms of both converters are shown in Fig. 3-25 and Fig. 3-26 under unity power factor condition. Due to polluted grid and LC resonance, the input current waveforms for MMMC-I in Fig. 3-25 contain visible harmonic components. However, the same currents of MMMC-II appear with superior quality which is attributed to the harmonic elimination capability of the input phase-shifting transformers. Finally, the cases of leading, lagging, and unity input power factor of MMMC-II are given in Fig. 3-27, which are obtained by adjusting the initial angle of the input current reference vector in the modulation program.

92

100V/div

20A/div

va ia

va

ia
5ms/div

Fig. 3-25 Experimental input voltage and current waveforms of MMMC-I (Pattern I and II, fo = 40 Hz, ma = 0.9).

100V/div

20A/div

va
ia

va

ia
5ms/div

Fig. 3-26 Experimental input voltage and current waveforms of MMMC-II (Pattern I and II, fo = 40 Hz, ma = 0.9).

93

va va

100V/div

50A/div

ia ia

va

ia
5ms/div

Fig. 3-27 Experimental input waveforms of MMMC-II showing adjustable power factor (Pattern II, fo = 40 Hz, ma = 0.9).

3.9 Summary
This chapter is focused on developing indirect space vector based modulation techniques for the MMMC topologies. It is revealed that as long as the input transformer is regarded no more than an isolation stage with a voltage gain, and the module outputs are seen as inverters that share a common input rectifier stage, the classic rectifier ­ fictitious dc ­ inverter concept from the conventional matrix converter can still be adopted for establishing an indirect circuit model of the MMMCs. Consequently, space vector modulation calculations can be separately applied to the rectifier and inverter stages of the model for duty ratio derivation. The derived switching states and duty ratios are then converted and combined to produce the final gate signals. For the inverter stage, both twolevel and three-level SVM programs can be employed for the output voltage synthesis. This 94

chapter also proposes a novel switching pattern for the output pulse generation in the MMMCs, and demonstrates that the new pattern provides superior waveform quality over the conventional one. The modulation and switching concepts are verified by both simulation and experimental results.

95

Chapter 4 Modulation Using DFE Emulation and Phase-Shifted SPWM

As mentioned earlier, among all multilevel converter topologies, there exists a particular breed realized by connecting output terminals of modular converter cells in series. Typical members of this category include the cascaded H-bridge converter (CHB) [18, 59] and the modular multilevel converters (MMCs) [8, 40, 60]. With the cascaded structure, these converters can reach very high power/voltage levels while employing low-voltage devices only, and in general possess features like modular design, superior waveform quality under limited device switching frequency, and good fault-tolerant capability. Being a combination of cascaded structure and matrix converter (MC) modules, the multimodular matrix converters (MMMCs) also belong to the cascaded converter family. A typical MMMC fed by a phase-shifting-transformer is similar to the CHB converter in terms of topological structure, but is different from the latter in the construction of constituent power modules. In a CHB converter, each power module contains a dc capacitor, and the output voltage is synthesized from the voltage-stiff dc-link; however in an MMMC, the output voltage of any single module is directly fabricated from the module's ac input voltages. The previous chapters introduced direct and indirect modulation schemes for the MMMCs. The presented schemes consider multiple MC modules as an integral and manage to synthesize output voltage and input current at the same time. They can generate 96

sinusoidal waveforms and are able to adjust the input power factor of the converter by varying the input current reference angle. In this chapter, a different modulation strategy for the phase-shifting-transformer-fed MMMC is proposed. Unlike the previous methods, the new scheme cannot adjust the input power factor. By taking advantage of the indirect construction of the MC modules, the new scheme makes the rectifier stage of each module emulate the voltage transfer characteristic of a diode front-end (DFE), while applying the well-known phase-shifted sinusoidal PWM (PS-SPWM) for inverter stage control. As a result, the input phase-shifting transformer is effectively made use of for output voltage and input current quality improvement. Compared with the previous methods, the new modulation scheme is simpler and more straightforward, easier to implement, and associated with lower switching losses. The possibility of its application to MMMCs built with physically constructed indirect 3 x 2 MC modules could lead to significant reduction of the converter's semiconductor cost, as well as elimination of the complexity involved in bidirectional switch device commutations which are essential in direct MC modules.

4.1 3 x 2 Converter Module Structures
Fig. 4-1 illustrates a cascaded converter structure consisting of nine power modules fed by an 18-pulse phase-shifting transformer. The overall topology structure is common for both the CHB converter and the MMMC topology, while the different 3 x 2 module structures for non-regenerative CHB, regenerative CHB, and MMMC are given in Fig. 4-2(a), (b) and (c), respectively. The non-regenerative CHB module is fed by a diode frontend whereas the regenerative CHB module contains an active rectifier. For the direct 3 x 2 MC module given in Fig. 4-2(c), a total of six bidirectional switches are needed, each of them realized by two insulated-gate bipolar transistor (IGBT)-diode pairs and connecting one of the module's output ports to one of the input ports. Because a single direct MC 97

module contains 12 IGBT devices, to build a nine-module MMMC with it requires 108 IGBTs in total. Moreover, as the IGBTs are grouped in pairs to form the four-quadrant bidirectional switches, complicated device commutation control as well as a large number of isolated gate drivers and power supplies is necessary, resulting in relatively high converter and accessory cost.

A1

vA1
+

N B1

  20
A2 vA2
+

C1 3x2 Converter Module B2 C2

  0
A3 vA3
+

B3

  20



C3 A B load C

Fig. 4-1 Cascaded converter structure with nine power modules.

98

(a)

(b)
Sap Sbp Scp Bi-directional Switches Saq Sbq Scq Cf q p

a b c

(c) Fig. 4-2 Power module construction for (a) Non-regenerative CHB. (b) Regenerative CHB. (c) MMMC.

99

It is well known that a conventional three-phase to three-phase (3 x 3) MC can be constructed either directly or indirectly. While the direct construction is implemented with bidirectional switches making straight connections between input and output ports, the indirect construction separates the entire MC into a rectifier stage and an inverter stage, which are coupled to each other through an imaginary dc-link with no real energy storage components. Similarly, an alternative choice to realize a 3 x 2 MC module is to adopt the indirect construction consisting of a three-phase rectifier and a single-phase inverter. In a classic indirect MC construction, bidirectional switches are still needed in the rectifier or inverter stage to block possible reverse dc-link voltages [42], however, if a proper modulation scheme can guarantee the constant positive voltage polarity of the dc-link, the indirect module can be formed by unidirectional voltage-blocking switches only and could have a lower total device count. Fig. 4-3 illustrates an entire MMMC leg of output phase A using indirect 3 x 2 MC modules. The structure of the indirect MC modules is similar to a regenerative CHB cell, except that the MC modules do not have dc capacitors but are equipped with ac filter capacitors. It can be seen that with this specific module configuration, the total number of devices required by a nine-module MMMC is reduced to 90, and the number of necessary gate drivers/power supplies are significantly reduced too. Additionally, the complicated device commutation control for bidirectional switches is no longer necessary since only unidirectional switches are employed in the power modules.

100

  20

  0

  20

Fig. 4-3 MMMC leg of output phase A with indirect MC modules.

101

4.2 Modulation Scheme
4.2.1 Diode Front-End Emulation for the Rectifier Stage
The new modulation scheme functions by making the rectifier stage of the indirect MC modules emulate the voltage transfer characteristic of a diode rectifier, such that the maximum ac line-to-line input voltage is always passed to the dc-link for inverter use. However, because of the employment of active switches, bidirectional current flow and thereby regenerative operation is allowed in the rectifier, being its main difference from a real diode bridge. Fig. 4-4 shows the ideal rectifier stage voltage waveforms in an indirect MC module under this type of control. The dc-link voltage vd in the figure appears to have the same shape as the output of a three-phase diode rectifier and contains six pulses per fundamental cycle of the input voltage. Consequently, the voltage polarity of the dc-link is always positive, and hence the use of conventional IGBTs without reverse voltage blocking capability as shown in Fig. 4-3 becomes viable.

Fig. 4-4 Ideal rectifier side voltage waveforms in an indirect MC module.

102

4.2.2 Phase-Shifted SPWM for the Inverter Stage
vcr1

1.0

vcr 2

vcr 3

vm
vm

0

1.0

g 7, A1 g 9, A1 g 7, A 2 g 9, A 2
g 7, A3 g 9, A3

Fig. 4-5 Inverter stage gate signals generated by phase-shift modulation.

For the inverter stage, the widely used carrier-based phase-shifted SPWM for the CHB converters [23] can be readily employed. In Fig. 4-5, the PS-SPWM diagram and gate signal generation for the inverter stage devices of the three MC modules in Fig. 4-3 (output phase A) are illustrated. As the entire output phase leg consists of three modules, two sinusoidal modulating waves (vm+ and vm-) as well as three triangular carrier waves (vcr1, vcr2 and vcr3) are needed. The triangular carriers are evenly distributed in the modulation plane and have equal phase displacements between one another. The resultant switching frequency of the inverter stage devices are determined by the frequency of the carriers. In the figure, only gate signals for the upper devices in each module are shown; the lower devices are switched complementarily with respect to the upper devices.

103

4.2.3 Mathematical Derivation of Input and Output Quantities
With the above described rectifier stage control, the dc-link voltage of each indirect MC module contains a dc component and ac harmonic components at orders of every multiple of 6. Taking into account the input voltage phase shifts introduced by the 18-pulse transformer, the dc-link voltages of the three modules in Fig. 4-3 can be expressed as the following by means of Fourier series expansion

vd , A1  Vdc   V6 k cos[6k (i t   9)  6 k ]
k 1 



vd , A 2  Vdc   V6 k cos[6ki t  6 k ]
k 1 

(4.1)

vd , A3  Vdc   V6 k cos[6k (i t   9)  6 k ]
k 1

where Vdc is the dc component of the six-pulse rectified voltage waveforms (equaling to 1.35 times the transformer secondary line-to-line voltage); V6k is the amplitude of the 6kthorder harmonic component; i represents the input fundamental angular frequency; and 6k designates the initial angle of the 6kth-order harmonic component. On the other hand, the inverter stage voltage relationship in a single module can be given as (taking Module A1 as an example)

v A1  vd , A1  [ S7, A1 (t )  S9, A1 (t )]

(4.2)

104

in which S7,A1(t) and S9,A1(t) are the switching functions controlled by gate signals g7,A1 and
g9,A1. As the PS-SPWM is essentially bipolar sinusoidal pulse-width modulation with

phase-shifted carriers, the switching functions are actually determined by the modulating waves of vm+ and vm-

vm   0.5ma cos(o t   o ) vm   0.5ma cos(o t   o )

(4.3)

where ma and o are the output modulation index and fundamental component angle which provide two degrees of freedom for load side control, and o is the output fundamental angular frequency. Assuming the carrier frequency is sufficiently high, the low-frequency form of (4.2) when averaged over the carrier period can be written as follows

v A1  vd , A1ma cos(ot   o ).

(4.4)

Hence, the total output phase-to-neutral voltage is

105

v AN  v A1  v A 2  v A3
 ma cos(ot   o )  (vd , A1  vd , A 2  vd , A3 )  ma cos(ot   o ) 
   V 3   dc  V6 k cos[6k (i t   9)  6 k ] k 1        V6 k cos[6ki t  6 k ] .  k 1       V6 k cos[6k (i t   9)  6 k ]   k 1 

(4.5)

It can be seen that, due to the phase shifts introduced by the 18-pulse transformer, all the 6kth harmonics except the multiples of 18th are cancelled out. As a result (4.5) can be rewritten as

v AN  ma cos(ot   o ) 
    V 3 3  dc  V18 k cos[18ki t  18 k ] . k 1  

(4.6)

Since the 18kth harmonic components have very little amplitudes, their effect on the inductive load is minimum. The total output-to-input voltage magnitude relationship can be then given as

VAB  7.01 

Ns  ma  Vab Np

(4.7)

106

in which Ns / Np stands for the secondary-to-primary turns ratio of the transformer, and ma is in the range of 0 to 1. For the current analysis, by neglecting the high order harmonics in the generated module output voltages, the converter output current can be derived for a given load impedance and expressed as follows (assuming the load is three-phase balanced)

iA  I L cos(o t   o   L )

(4.8)

where IL and L are the load current magnitude and load power factor angle, respectively. Since the dc-link current in MC module A1 is

id , A1  iA  [ S7, A1 (t )  S9, A1 (t )],

(4.9)

its low-frequency local average can be given as

id , A1  I L cos(o t   o   L )  ma cos(ot   o ) I m  L a [cos(2o t  2 o )  cos( L )]. 2

(4.10)

Neglecting the line impedances, the phase a secondary winding current ia,A1 at the input of module A1 is

107

ia , A1  id , A1  [ S1, A1 (t )  S2, A1 (t )]  C f dva , A1 / dt


I L ma [cos(2o t  2 o )  cos( L )]  2

(4.11)

[ S1, A1 (t )  S2, A1 (t )]  C f dva , A1 / dt

where S1,A1(t) and S2,A1(t) are the switching functions for devices S1,A1 and S2,A1, respectively. In a similar way, the input currents of modules B1 and C1 can be derived and given in (4.12) and (4.13)

ia , B1  id , B1  [ S1, B1 (t )  S2, B1 (t )]  C f dva , B1 / dt


I L ma [cos(2ot  2 o  4 3)  cos( L )]  2

(4.12)

[ S1, B1 (t )  S 2, B1 (t )]  C f dva , B1 / dt

ia ,C1  id ,C1  [ S1,C1 (t )  S2,C1 (t )]  C f dva ,C1 / dt


I L ma [cos(2ot  2 o  4 3)  cos( L )]  2

(4.13)

[ S1,C1 (t )  S2,C1 (t )]  C f dva ,C1 / dt .

Due to the fact that modules A1, B1 and C1 are supplied by a group of transformer secondary windings that have the same phase shift (-20º), the rectifier stage switching functions in these modules are all the same. Therefore, the 2o components in ia,A1, ia,B1, and ia,C1 are cancelled out when the three currents are summed and referred to the primary side. As a result the remaining part of ia,A1 can be expressed as

108

' ia , A1 

I L ma cos( L )  [ S1, A1 (t )  S2, A1 (t )]  C f dva , A1 / dt . 2

(4.14)

As described earlier the rectifier stage of the MC modules is operated by diode front-end emulation, so the switching function in (4.14) can be expanded to the following Fourier series [58]

S1, A1 (t )  S 2, A1 (t )  4 n n sin( ) sin( ) sin(ni t ) 2 3 n 1,5,7,11... n





(4.15)

sin(5i t ) sin(7i t )    sin(i t )    2 3 5 7   .   sin(11i t ) sin(13i t )       11 13  

From (4.15) it can be identified that the secondary winding current ia,A1 contains several low-order harmonics as a result of the rectifier stage switchings. However, because the average dc-link currents in modules A1, A2, and A3 are equal owing to the inverter stage PS-SPWM, and thanks to the 18-pulse rectifier configuration which is able to eliminate the 5th, 7th, 11th, and 13th harmonic components [23], the dominant harmonics are removed on the primary side of the transformer, leading to a sinusoidal current waveform of ia.

109

4.2.4 Effect of the 18-Pulse Phase-shifting Transformer

2 0 -2 2 0 -2 2 0 -2 5 0 -5

v A1 (x 103 V)

v A2 (x 103 V)

v A3 (x 103 V)

v AN (x 103 V)

25

30

35

40

45

t (ms)

Fig. 4-6 Ideal phase A output voltages without phase shifts in the transformer secondary windings.

As is analyzed above, the 18-pulse phase-shifting transformer plays an important role to make effective the proposed modulation scheme. The transformer is essential for both input current and output voltage quality improvement. On the input side, because the rectifier stage of the MC modules is switched like a diode front-end, a significant amount of low order current harmonics exist in the transformer's secondary windings. But since the inverter stage employs the carrier-based PS-SPWM which guarantees balanced load sharing 110

among modules on a same output phase, the low-order current harmonics are cancelled out in the transformer, thereby resulting in sinusoidal current waveforms at the primary side.

2 0 -2 2 0 -2 2 0 -2 5 0 -5

v A1 (x 103 V)

v A2 (x 103 V)

v A3 (x 103 V)

v AN (x 103 V)

25

30

35

40

45

t (ms)

Fig. 4-7 Ideal phase A output voltages with phase shifts in the transformer secondary windings.

For the output voltage synthesis, the phase displacements in the transformer's secondary windings have a positive effect too. Fig. 4-6 shows the situation if the winding phase shifts do not exist, in which the output phase voltage vAN is affected by the six-pulse voltage waveform in the dc-links of the MC modules and contains corresponding harmonic

111

distortions. With the 18-pulse effect introduced by the winding phase shifts, the waveform of vAN is free of the low frequency distortions and has a much better shape in Fig. 4-7.

4.2.5 Gate Signal Mapping for Direct MC Module
The gate signals generated for the indirect 3 x 2 MC modules can also be used to control an MMMC constructed with direct 3 x 2 MC modules. Before the gate signals are applied to the switching devices, a logic mapping program is needed to convert them. Considering the direct MC module as shown in Fig. 4-2(c) and the indirect MC module A1 as shown in Fig. 4-3, the logic mapping of the signals can be expressed as

g ap  g1, A1  g 7, A1  g 2, A1  g8, A1 gbp  g3, A1  g 7, A1  g 4, A1  g8, A1 g cp  g5, A1  g 7, A1  g 6, A1  g8, A1 g aq  g1, A1  g9, A1  g 2, A1  g X, A1 gbq  g3, A1  g9, A1  g 4, A1  g X, A1 g cq  g5, A1  g9, A1  g 6, A1  g X, A1 . (4.16)

On the right side of the equations are the original gate signals generated for the indirect MC module, whereas on the left side are the corresponding gate signals for the direct MC module. Input/output equivalence between the two types of modules is hereby established.

112

4.2.6 Reduction of Additional Switchings Caused by Input Voltage Ripples
In Fig. 4-4, the ideal case source voltages at the input terminals of the MC modules consist of a balanced set of three-phase pure sinusoids. Since the amplitude relationship among the three waveforms changes six times per fundamental cycle, an entire input voltage period can be equally divided into six sectors, hence, the rectifier stage devices of the MC modules are switched exactly at the source voltage frequency. However, due to the existence of line and transformer impedances, the actual input terminal voltages (i.e. the voltages on the filter capacitors) may deviate from the source in practice. Among other factors, the inverter stage switching behavior adds higher frequency ripples to the capacitor voltages. These ripples may cause multiple instances of crossings between voltage waveforms, therefore leading to an increased number of amplitude relationship changes. Because the rectifier stage modulation is based on the input voltage amplitude judgment, the multi-crossings essentially result in additional switchings for the rectifier stage devices, specifically in the vicinity of sector transitions. The phenomenon is exemplified in Fig. 4-8(a), where the input voltages va,A1, vb,A1, and vc,A1 of Module A1 in Fig. 4-3, as well as the gate signals g1,A1 and g3,A1 for rectifier stage devices S1,A1 and S3,A1 are shown for a certain period. The plot is derived under 60 Hz source voltage and 1080 Hz inverter stage switching frequency. In the center part of the figure, as va,A1 decreasing and vb,A1 increasing, the two voltages come to their first intersection. Accordingly, device switchings take place in phases a and b and the dc-link voltage in the module transitions from vac,A1 to vbc,A1, starting from where the inverter stage begins to take energy from phase b instead of a. In view of the fact that the filter capacitances are relatively small, the imposed load causes vb,A1 to drop and crosses va,A1 again, leading to another round of device switchings in phases a and b, and forcing the dc113

link voltage to transition back to vac,A1. Because the above-described process may repeat itself for a considerable number of times, a significant amount of additional switchings appear in the region as a result. The extra device switchings are undesirable since they increase the rectifier stage switching frequency and introduce additional power losses. On the other hand, the extra switchings do have a positive effect on reducing the input voltage ripple magnitude during sector transitions and, therefore, help improve the output voltage/input current quality. To deal with the issue, the measured input voltages are passed through a second-order filter, the transfer function of which is given as,

H f ( s) 

K s / (2 f c )  s / (2 f c Q)  1
2 2

(4.17)

where fc is the cutoff frequency, Q is the quality factor and K denotes the filter gain. Assuming a unity Q, the phase angle delay introduced by the filter can be calculate by,

 ( f )   arctan

f / fc 1  ( f / fc )2

(4.18)

114

v

va , A1

vb , A1

vc , A1

g1, A1

g 3, A1

(a)

v

va , A1

vb , A1

vc , A1

g1, A1

g 3, A1

(b) Fig. 4-8 Additional rectifier stage switchings caused by input voltage ripples. (a) Without filter. (b) With filter applied.

115

which needs to be compensated for the fundamental component. With the use of the filter, the amplitude judgment for the rectifier stage modulation is then performed on the filtered and compensated voltages. In order to achieve a balance between switching frequency and input/output waveform quality, a cutoff frequency of 2.5 KHz is selected for the filter. As shown in Fig. 7(b), after applying the filter, the number of additional switchings near the sector transition is substantially reduced.

4.3 Simulation Results

Table 4-1 System parameters of MMMC-II for simulation

System Parameter

Value

Rated Power Grid Voltage (line-to-line, rms) Grid Voltage Frequency Transformer Turns Ratio NP : NS Inverter Stage Carrier Frequency fs Total Line Inductance Ls (referred to the primary side) Filter Capacitance Cf Load Resistance RL Load Inductance LL

1 MVA 4160 V 60 Hz 9:2 1080 Hz 0.08 pu 0.25 pu 0.9 pu 0.25 pu

To verify the proposed modulation scheme, a simulation model is built and tested in MATLAB/Simulink. In the simulation, the nine module MMMC-II circuit is supplied by 116

60 Hz grid voltage and is connected to a three-phase RL load. System parameters of the model are listed in Table 4-1. Under 1080 Hz inverter stage switching frequency, the output voltage and current waveforms are shown in Fig. 4-9. The waveforms are obtained for an output frequency fo of 40 Hz while the inverter stage modulation index ma is set to 0.9. It can be seen that owing to the use of PS-SPWM, the output line-to-neutral and line-to-line voltages appear to be multi-stepped waveforms with decent quality. Because of the inductance in the load, the three-phase load currents are close to sinusoids with very low harmonic distortion. Fig. 4-10 gives another set of output waveforms with the fundamental frequency changed to 80 Hz. With the use of PS-SPWM in the inverter stage, the output frequency, magnitude and angle can be arbitrarily adjusted by varying the reference waves for the PSSPWM. Fig. 4-11 illustrates the input side current waveforms of the converter. The first subplot exemplifies the input current waveform of a single MC module (phase a1 of Module A1) which contains chopped pieces from the load currents. Due to the filtering effect of the capacitors, the current in the corresponding secondary winding of the 18-pulse transformer, as shown in the second subplot, is much smoother but still contains significant harmonic components. However, because the inverter stage modulation imposes a balanced load sharing among modules in a same output phase, and with the rectifier stages of the modules emulating the voltage transfer characteristic of diode bridges, the harmonic elimination capability of the 18-pulse transformer is made good use of. Evident in the third subplot, the total input current on the primary side of the transformer is seen to be a sinusoid with low distortions. Additionally, although the proposed modulation does not control the input current angle, the line power factor is close to unity under medium to high load conditions.

117

v AN

v AB

iA , iB and iC

Fig. 4-9 Simulated output voltage and current waveforms of MMMC-II (fo = 40 Hz, ma = 0.9).

v AN

v AB

iA , iB and iC

Fig. 4-10 Simulated output voltage and current waveforms of MMMC-II (fo = 80 Hz, ma = 0.9).

118

iwa , A1

ia , A1

va

ia

Fig. 4-11 Simulated input current waveforms of MMMC-II (fo = 40 Hz, ma = 0.9).

4.4 Experimental Verification
The proposed modulation scheme is also verified experimentally on the low-voltage prototype as described in Chapter 5. The prototype is composed of nine MC modules built with IGBT-diode pairs. Each module is equipped with sensor circuitry for input/output voltage/current measurement and field-programmable gate array (FPGA) devices for implementation of the modulation scheme, dispatching gate signals, interfacing the analogto-digital converters, and handling other necessary tasks. Since the experimental MC modules are of the direct type, the gate signal mapping described in Section 4.2.5 is also realized in the FPGA. On the input side, the MC modules are fed by a group of three 18119

pulse phase-shifting transformers, which are put together to provide a total of nine secondary windings. As the transformers have a fixed turns ratio of 2 : 1, a variac is placed between the transformers and the 208 V / 60 Hz grid to provide the adequate voltage level. Same as the simulation, an RL is used as the load of the converter. Detailed experimental parameters are listed in Table 4-2.

Table 4-2 Experimental parameters of MMMC-II

System Parameters

Value

Rated Power Grid Input Voltage (line-to-line, rms) Input Frequency Equivalent Transformer Turns Ratio NP : NS Inverter Stage Carrier Frequency fs Equivalent Total Line Inductance Ls Filter Capacitance Cf Load Resistance RL Load Inductance LL

5 kVA 208 V 60 Hz 9:2 1080 Hz  2 mH ( 0.087 pu) 66 F (0.21 pu) 7.9  (0.91 pu) 5 mH (0.22 pu)

Fig. 4-12 shows the experimental output voltage waveforms of vA1 and vAN under no load condition. Although vA1 contains the six-pulse ripples introduced by the rectifier stage, vAN is seen to be similar to Fig. 4-7 which is free of the low frequency ripples due to the 18pulse transformer and has seven voltage levels. 120

250V/div

v A1

v AN

5ms/div

Fig. 4-12 Experimental output voltage waveforms of MMMC-II under no load condition.

Fig. 4-13 and Fig. 4-14 present the load side waveforms of the MMMC for output frequencies of 40 Hz and 80 Hz. Under both frequencies, the experimental waveforms of the line-to-neutral voltage vAN, line-to-line voltage vAB appear to have multilevel waveform shapes and resemble their simulation counterparts well. Due to the inductance in the load, the load current iA possesses a smooth sinusoidal waveform. The input side current waveforms are shown in Fig. 4-15, where the secondary winding current ia1 from module A1 can be noticed to contain significant harmonic distortions. However, the total input current ia at the grid connection point has a good sinusoidal waveform, which proves the fact that although the input current is not controlled by the proposed modulation scheme, sinusoidal input currents can still be achieved by taking advantage of the harmonic elimination capability of the 18-pulse phase-shifting transformer.

121

250V/div 50A/div

v AN

v AB

iA
5ms/div

Fig. 4-13 Experimental output voltage and current waveforms of MMMC-II (fo = 40 Hz, ma = 0.9).

250V/div 50A/div

v AN

v AB

iA
5ms/div

Fig. 4-14 Experimental output voltage and current waveforms of MMMC-II (fo = 80 Hz, ma = 0.9).

122

100V/div

50A/div

ia , A1

va

ia

5ms/div

Fig. 4-15 Experimental input side waveforms (fo = 40 Hz, ma = 0.9).

4.5 Summary
The MMMC topologies are a combination of cascaded converter structure and 3 x 2 matrix converter modules. This chapter presents a new and simple modulation scheme for the MMMC-II fed by a phase-shifting input transformer. The method is established by modeling the MC modules indirectly and using their rectifier stage to emulate the voltage transfer characteristic of a three-phase diode bridge, while applying the well-known phaseshifted modulation scheme to the inverter stage. On the output side, the magnitude and angle can be freely adjusted by the inverter stage modulation. On the input side, although the modulation does not involve input current synthesis, sinusoidal input current waveforms can still be obtained, which is owing to the harmonic elimination capability of the phase-shifting transformer. 123

Compared with the previously developed modulation schemes for the MMMC, the new modulation scheme is simpler, more straightforward, and associated with lower switching losses. Its features enable the use of an indirect module structure which does not need the complicated bidirectional switch realization and device commutation control in direct matrix converters, and significantly reduces the total number of switches required. The main limitation of the scheme lies in its lack of input power factor control capability.

124

Chapter 5 Experimental Platform Implementation

In order to provide experimental verification of the proposed modulation schemes, a low-voltage prototype of the multimodular matrix converters (MMMCs) has been implemented in the lab. All experimental results presented in the previous chapters are obtained from the prototype supplied by 208 V / 60 Hz grid voltage. For validation of modulation schemes on MMMC-II, a total of nine 3 x 2 matrix converter (MC) power modules has been constructed and assembled to collectively produce multilevel output waveforms. Fig. 5-1 shows the simplified schematic of the experimental setup, and a picture of the real platform is given in Fig. 5-2, which consists of three input phase-shifting transformers, a variac to offer the adequate input voltage level, nine MC power modules distributed in the three output phases, and an RL load. The phase-shifting transformers used in the experiment has only three secondary winding sets each, therefore, three such transformers are needed to provide nine secondary windings for the MMMC-II, while all the primary windings are connected in parallel for the line-side currents to add up. Since each transformer has a fixed primary to secondary turns ratio of 2 : 1, a variac is inserted between the transformers and the grid to adjust the input voltage magnitude. For experiments of the MMMC-I, only the three MC modules (A2, B2, and C2) fed by the zero degree secondary windings are used; the other modules are disconnected in this case.

125

This chapter provides detailed explanation of the major components constituting the low-voltage experimental platform for verifying the proposed modulation schemes for the MMMC topologies. The MC module construction, voltage and current sensor circuits, bidirectional device commutation, module coordination and communication will be described in the following sections, respectively.

20

TR1

A1

vA1
+

N B2 C3

0



20

208 V / 60 Hz Variac

0

TR2

A2


20 20

vA2
+

B3

3 x 2 MC Modules C1

20

TR3

A3

vA3
+

20
0


B1 C2 A B RL C

Fig. 5-1 Structural diagram of the low-voltage experimental setup.

126

Fig. 5-2 Low-voltage experimental setup of the MMMC.

127

5.1 Construction of 3 x 2 MC Power Modules
p Sap V/I Sensor Circuit a b c Cf Saq Sbq Scq V/I Sensor Circuit Sbp Scp

q
Fig. 5-3 Construction of the experimental 3 x 2 MC module.

Fig. 5-3 illustrates the experimental construction of the 3 x 2 MC modules. The bidirectional switches linking the input and output ports of the modules are realized by the anti-parallel connection of a pair of series-connected IGBT and diode (IRG7PH42U and DSEP60-12A). Fig. 4-1 shows the gate driving structure of a single bidirectional switch. Each IGBT device is equipped with an independent gate driver circuit supported by an isolated power supply sourcing energy from the main auxiliary power source. The gate driver circuit is built around an optocoupler IC (HCPL316J) which provides internal galvanic isolation between the power side and the signal side. The gate signals are delivered by a field programmable gate array (Altera Cyclone EP1C6) to the gate drivers, and in the meantime, diagnostic signals from the gate drive circuit are also fed back 128

Fig. 5-4 Top-front view of the experimental MC modules.

129

to the FPGA for fault detection. By providing separate gate signals for the two IGBTs in a bidirectional switch, current flow in the switch can be controlled at will and, therefore, multistep device commutation between different phases can be achieved.

Fig. 5-5 Gate driving of the bidirectional switches.

At the input ports of each MC module, a set of three-phase film capacitors are mounted as the input filter. In addition, voltage and current sensing circuit are implemented to measure the polarity and magnitude of the input voltages and currents. The same circuit are installed at the single-phase output ports as well for measuring output voltages and currents, which are essential to the realization of device commutation algorithm.

130

5.2 Voltage and Current Measurement

V

Voltage Divider R1
+

3 m Rs

I

R2
+

-

Isolation Boundary

AD7401A - Modulator

AD7401A

Isolation Boundary

1-Bit Data Stream

CLK

CLK

1-Bit Data Stream

Sinc3 Filter

16-Bit Data FPGA

Sinc3 Filter

Fig. 5-6 Voltage and current measurement using isolated 1-Bit -Modulator.

The MMMC modulation schemes as well as the bidirectional switch commutation require voltage/current information from the sensing circuit. As mentioned earlier, the sensing circuit is implemented at both input and output ports of each 3 x 2 MC module. Core to the measurement circuit is an isolated Sigma-Delta modulator IC (AD7401A) which accepts a differential ±250 mV analog voltage input and converts it into a high-speed 1-bit data stream. As shown in Fig. 4-4, the input/output voltages of the MC module are scaled down using a voltage divider before being passed to AD7401A; whereas for current measurement, a 3 m sensing resistor is employed to convert the measured current into the 131

acceptable voltage range. It is worth mentioning that the modulator IC possesses an on-chip internal isolation and therefore provides insulation for the digital circuit from the power circuit (5000 V minimum). The clock signal (up to 20 MHz) required by the operation of the modulator on the digital side is provided by the FPGA. The data bits are clocked out on the rising edges of the clock signal and transmitted to the FPGA, and passed through a lowpass Sinc3 digital filter. At the output of the filter the 16-bit digital data of the voltage or current is obtained which can be utilized by the other function modules.

5.3 Commutation Control of the Bidirectional Switches

Sap+ a SapCf Sbp+ b SbpFig. 5-7 Initial state of output port p connected to input phase a.

p LL

iL

Due to the use of bidirectional switches involving devices connected in anti-parallel, the current commutation between different phases should be properly handled, such that during commutation transients, the switching constraint in the MC module is not violated. Unlike

132

Fig. 5-8 Four-step device commutation based on load current direction. (a) Step 1. (b) Step 2. (c) Step 3. (d) Step 4.

133

Fig. 5-9 Gate signals during the four-step device commutation.

voltage-source converters where dead-time can be inserted during commutation and current-source converters that can adopt gate signal overlaps, the MC modules have to employ a multistep commutation technique based on the load current and/or input voltage information to avoid detrimental short-circuit of the filter capacitors and open-circuit of the inductive load. For the experiments of the MMMCs, a four-step load current based commutation technique is implemented in the FPGA. The entire commutation process is illustrated from Fig. 4-5 to Fig. 5-9. Assuming the load current iL at output port p is positive at the beginning, Fig. 4-5 shows the initial state of the circuit in which the load current is about to be commutated from input phase a to phase b. At this moment, both Sap+ and Sapare turned ON; but owing to the load current direction, Sap+ is the actual device that carries current. In Fig. 5-8 the four-step process is illustrated in detail. Before turning ON the incoming current carrying device in phase b (Sbp+), the device Sap- not carrying current in the phase a bidirectional switch should be turned OFF first, as shown in Fig. 5-8 (a); otherwise, Sap- and Sbp+ would provide a short-circuit path for the input capacitors and cause harm. Subsequently, Sbp+ is turned on to establish the current path for iL in phase b; this is done prior to the turning OFF of Sap+ to provide a short overlap period and guarantee the continuity of the load current. The actual current is commutated from phase a to phase b 134

right after Sbp+ is ON or Sap+ is OFF, depending on which input voltage is greater in magnitude. In the last step as shown in Fig. 5-8 (d), Sbp- is also turned ON to allow reverse load current flow, and the whole commutation process is finished.

Fig. 5-10 FPGA finite state machine implementation of the four-step device commutation.

135

Fig. 5-9 shows the gate signals generated for the four devices involved during the commutation. It can be seen that each step lasts a period of td, which is settable in the FPGA to ensure complete turning ON and OFF of the IGBTs. The commutation program is implemented in the FPGA using a simple finite state machine as shown in Fig. 5-10. In the normal state, the commutation module accepts the original gate signals from the modulation program and compares it with the old one. If a change in the original gate signals is detected indicating that commutation is necessary, the commutation program will go through the four-step process and output corresponding final gate signals to control the IGBTs. During the entire process, the load current direction information is also fed into the commutation module for determining the right sequence.

5.4 Module Synchronization, Communication and Protection
In the experimental setup, each MC module is responsible for generating gate signals for its own on-board devices, therefore, it is required that all the modules are synchronized and coordinated for implementation of the proposed modulation schemes. With the equipped FPGAs, synchronization and serial data communication functions are implemented, and the signals are transmitted through a low-voltage differential signaling (LVDS) channel carried by category-5 network cables. It is worth mentioning that the FPGAs are operated at a basic clock frequency of 150 MHz, and the serial communication reaches a high baud rate of 37.5 MHz. Moreover, protection measures are also implemented on each module to avoid harmful effects to the switching devices. Besides functions provided by the gate drivers, an overvoltage protection circuitry is placed at the output port of each module, which includes a metal oxide varistor (MOV) and a thyristor based crowbar controlled by a voltage comparator circuit monitoring the output voltage. In case an overvoltage happens, the 136

protection circuit functions immediately and provides a bypass current path, such that the devices voltage will not exceed the upper limit.

5.5 Summary
A low-voltage experimental platform has been built in the lab to verify the MMMC modulation schemes presented in the last chapters. The prototype is composed of nine 3 x 2 MC power modules, three 18-pulse phase-shifting transformers for feeding the modules, an input variac, and supplies a three-phase RL load. The bidirectional switches in the MC modules are realized by anti-parallel connection of IGBT-diode pairs, with the IGBTs operated by separate gate drivers. The gate driving circuitry is built around an optocoupler driver IC with diagnostic and fault protection features. In each MC module, voltage and current measurement circuit are available at the input and output ports. The measurement circuit is implemented using an isolated SigmaDelta modulator which converts the differential voltage input into a 1-bit high-speed data stream. The data stream is fed into the FPGA and passed through a digital filter for 16-bit data output. Also with the FPGA, the load current based four step method is implemented to control the commutation of the bidirectional switches. As a result, safe current commutation avoiding input voltage short-circuit and load current interrupt is successfully achieved. All the modules are equipped with synchronization, communication, and protection features, and are used to produce the final output waveforms collectively.

137

Chapter 6 Conclusions

Over the past decades, various high-power converter topologies were invented and extensively investigated for medium-voltage drive applications. However, of all the topologies that have been proposed in the literature, only a small portion have successfully entered and thrived on the commercial market. As one of the newly emerged MV converter candidates, the multimodular matrix converter (MMMC) is among the few that have found industrial presence so far. The MMMC topologies are composed of a multiple number of 3 x 2 matrix converter (MC) modules. And they are essentially a combination of structures of the conventional matrix and multilevel converters. Owing to the fact that modulation for the MMMCs cannot directly adopt existing schemes for either the conventional MC or the dclink based multilevel converters, it is necessary to develop new schemes particularly suited for the MMMCs for generating sinusoidal input and output quantities with variable amplitude and frequency. This dissertation is mainly focused on the development of modulation schemes for the MMMC topologies. Several different schemes, along with the relevant switching patterns, have been proposed and studied in the last chapters. All the results were supported by verifications from both simulation and experiment. The experimental validations are carried out on a low-voltage lab prototype fed by the grid voltage.

138

6.1 Main Contributions and Conclusions
The main contributions of the work are concluded as follows. 1) Developed a direct transfer matrix based modulation scheme for the MMMCs. The scheme is capable of producing sinusoidal waveforms at both input and output ports of the converters, with the frequency, amplitude and angle on both sides of the converters all adjustable. It is identified that for synthesis of the input sinusoidal currents, different MC modules should be taken as an integral and coordinated in the modulation program. Consequently, although the secondary winding currents of the input isolation transformer still contain distortions, the total grid-side current as a sum of the input currents from different modules can possess a sinusoidal shape. For higher level MMMCs with more than two modules in series on each output phase, phase displacement among the module switching periods is necessary for the generation of multilevel waveforms with improved quality. 2) Established an indirect circuit model for the MMMCs consisting of virtual rectifier and inverter stages, based on which an indirect space vector based modulation scheme is developed. A new switching pattern producing superior waveform quality comparing to the conventional pattern is also proposed. If viewed from a certain perspective, the MMMC topologies may still adopt the fictitious dc-link concept and be divided into virtual stages of a rectifier and an inverter. The rectifier stage is commonly shared assuming the input side of the modules is operated synchronously. For the output voltage synthesis, either a two-level or a three-level space vector diagram can be employed for duty ratio calculations. Finally, output pulses are generated according to two switching patterns. The proposed new pattern featuring split

139

negative half-cycle pulses is able to yield better harmonic performance than the conventional one. 3) Proposed a simple and straightforward modulation scheme for higher level MMMCs fed by a phase-shifting transformer. This method is a combination of diode frontend emulation and phase-shifted sinusoidal PWM. The fact that it can be applied to physically constructed indirect MC modules leads to reduced part count, gate supplies/drivers, and avoids the complexity involved in device commutations since only unidirectional switches are employed. At a much lower switching frequency, the new method is able to provide waveform quality on par with those from the previous strategies. The benefits associated with the new scheme are obtained at the expense of sacrificing input power factor adjustment capability. The proposed scheme takes advantage of the indirect construction of the MC modules. By emulating the voltage transfer characteristics of the diode rectifier, the method ensures positive dc-link voltage polarity, and therefore allows the use of MC modules built with unidirectional devices only. This modulation relies on the phase-shifting transformer which plays an important role in output and input waveform quality improvement. Method for reducing additional switchings caused by input voltage ripples is also presented. 4) Constructed a complicated low-voltage prototype of the MMMC topology, on which the proposed modulation schemes are successfully verified. The prototype is composed of nine MC modules that are scaled-down versions of the simulated system. Each module is equipped with bidirectional switches, isolated gate drivers, voltage/current sensors, protection circuits, and FPGAs for implementing modulation program and handling necessary auxiliary tasks. Synchronization and communication functions are also realized among different modules.

140

6.2 Suggested Future Work
Based on the existing platform, possible future research can be carried out in the following directions. 1) Explore other possible modulation and control methods for the MMMCs and compare performances of different methods. New candidate methods such as model predictive control can be applied and investigated. In addition, comprehensive evaluation and quantitative comparison of existing schemes in terms of harmonic profile, switching frequency, semiconductor losses may further help to reveal the benefits and limitations associated with the respective methods, and identify the optimized scheme corresponding to particular working conditions. 2) Address issues related to unbalanced input voltage and/or fault conditions. If the input voltage or load is not three-phase balanced, special measure should be taken for the modulation schemes to perform properly. It would be then necessary to invent and investigate possible methods to compensate for the unbalances and maintain satisfactory performance of the modulation schemes. 3) Study methods to suppress resonances caused by filter capacitors and input inductances. Due to the existence of the filter capacitance in each MC module, resonances could be triggered on with the line and leakage inductances. The excited ripples can have negative effects on the modulation and degrade the waveform quality. To address this issue, suitable damping strategies may be employed to counteract the resonances and help improve the modulation performance.

141

Appendix I Per-Unit System Calculation

In the per-unit representation of an electrical power conversion system, the base values are calculated according to the given rated power SR, rms line-to-line voltage VLL, and base frequency fB. Assume we have a system with a rated power of 1 MW and line-to-line voltage of 4160 V/ 60 Hz, the values are calculated as follows

VB  VLL / 3  4160 / 3  2401.78 V I B  S R /  3VB   1e6 /  3VB   138.79 A

(I.1) (I.2) (I.3) (I.4) (I.5)

Z B  VB / I B  17.31

B  2 f B  2  60  377 rad/s
LB  Z B / B  45.9 mH and CB  1/ B Z B   153 F

Therefore, a 0.9 pu resistance in such a system would be

Z  0.9Z B  0.9 17.31  15.58 

(I.6)

142

References
[1] J. Rodriguez, S. Bernet, B. Wu, J. O. Pontt, and S. Kouro, "Multilevel voltage-sourceconverter topologies for industrial medium-voltage drives," IEEE Trans. Ind. Electron., vol. 54, pp. 2930-2945, 2007. [2] B. Wu, J. Pontt, J. Rodriguez, S. Bernet, and S. Kouro, "Current-source converter and cycloconverter topologies for industrial medium-voltage drives," IEEE Trans. Ind. Electron., vol. 55, pp. 2786-2797, 2008. [3] M. D. Manjrekar, P. K. Steimer, and T. A. Lipo, "Hybrid multilevel power conversion system: a competitive solution for high-power applications," IEEE Trans. Ind. Appl., vol. 36, pp. 834-841, 2000. [4] M. Veenstra and A. Rufer, "Control of a hybrid asymmetric multilevel inverter for competitive medium-voltage industrial drives," IEEE Trans. Ind. Appl., vol. 41, pp. 655664, 2005. [5] C. Rech and J. R. Pinheiro, "Hybrid Multilevel Converters: Unified Analysis and Design Considerations," IEEE Trans. Ind. Electron., vol. 54, pp. 1092-1104, 2007. [6] T. Bruckner, S. Bernet, and H. Guldner, "The active NPC converter and its loss-balancing control," IEEE Trans. Ind. Electron., vol. 52, pp. 855-868, 2005. [7] F. Kieferndorf, M. Basler, L. A. Serpa, J. H. Fabian, A. Coccia, and G. A. Scheuer, "A new medium voltage drive system based on ANPC-5L technology," in Industrial Technology (ICIT), 2010 IEEE International Conference on, 2010, pp. 643-649. [8] H. Akagi, "Classification, Terminology, and Application of the Modular Multilevel Cascade Converter (MMCC)," IEEE Trans. Power Electron., vol. 26, pp. 3119-3130, 2011. [9] M. Hagiwara and H. Akagi, "Control and Experiment of Pulsewidth-Modulated Modular Multilevel Converters," IEEE Trans. Power Electron., vol. 24, pp. 1737-1746, 2009. [10] L. Meng Yeong, P. Wheeler, and C. Klumpner, "Space-Vector Modulated Multilevel Matrix Converter," IEEE Trans. Ind. Electron., vol. 57, pp. 3385-3394, 2010.

143

[11]

K. Jun, E. Yamamoto, M. Ikeda, and E. Watanabe, "Medium-Voltage Matrix Converter Design Using Cascaded Single-Phase Power Cell Modules," IEEE Trans. Ind. Electron., vol. 58, pp. 5007-5013, 2011.

[12]

E. Yamamoto, H. Hara, T. Uchino, M. Kawaji, T. J. Kume, K. Jun Koo, and H. P. Krug, "Development of MCs and its Applications in Industry," Industrial Electronics Magazine, IEEE, vol. 5, pp. 4-12, 2011.

[13]

M. Venturini, "A new sine wave in, sine wave out conversion technique eliminates reactive elements," Proc. Powercon, vol. 7, pp. 1-15, 1980.

[14]

P. W. Wheeler, J. Rodriguez, J. C. Clare, L. Empringham, and A. Weinstein, "Matrix converters: a technology review," IEEE Trans. Ind. Electron., vol. 49, pp. 276-288, 2002.

[15]

L. Huber and D. Borojevic, "Space vector modulated three-phase to three-phase matrix converter with input power factor correction," IEEE Trans. Ind. Appl., vol. 31, pp. 12341246, 1995.

[16]

A. Nabae, I. Takahashi, and H. Akagi, "A new neutral-point-clamped PWM inverter," IEEE Trans. Ind. Appl., vol. IA-17, pp. 518-523, 1981.

[17]

T. A. Meynard, H. Foch, P. Thomas, J. Courault, R. Jakob, and M. Nahrstaedt, "Multicell converters: basic concepts and industry applications," IEEE Trans. Ind. Electron., vol. 49, pp. 955-964, 2002.

[18]

P. W. Hammond, "A new approach to enhance power quality for medium voltage AC drives," IEEE Trans. Ind. Appl., vol. 33, pp. 202-208, 1997.

[19]

J. W. Kolar, F. Schafmeister, S. D. Round, and H. Ertl, "Novel three-Phase ac-ac sparse matrix converters," IEEE Trans. Power Electron., vol. 22, pp. 1649-1661, 2007.

[20]

Y. Shi, X. Yang, Q. He, and Z. Wang, "Research on a novel capacitor clamped multilevel matrix converter," IEEE Trans. Power Electron., vol. 20, pp. 1055-1065, 2005.

[21]

S. Angkititrakul and R. W. Erickson, "Control and implementation of a new modular matrix converter," in Applied Power Electronics Conference and Exposition, 2004. APEC '04. Nineteenth Annual IEEE, 2004, pp. 813-819 vol.2.

144

[22]

J. Change, "Modular AC-AC variable voltage and variable frequency power conveter system and control," ed: US Patent 5,909,367, 1999.

[23] [24]

B. Wu, High-power Converters and AC Drives. Piscataway, NJ: IEEE/Wiley, 2006. "IEEE Recommended Practices and Requirements for Harmonic Control in Electrical Power Systems," IEEE Std 519-1992, 1993.

[25]

B. Wu, S. Rizzo, N. Zargari, and Y. Xiao, "An integrated DC link choke for elimination of motor common-mode voltage in medium voltage drives," in Thirty-Sixth IAS Annual Meeting, 2001.

[26]

P. C. Loh, D. G. Holmes, Y. Fukuta, and T. A. Lipo, "Reduced common-mode modulation strategies for cascaded multilevel inverters," IEEE Trans. Ind. Appl., vol. 39, pp. 1386-1395, 2003.

[27]

S. D. Sudhoff, E. L. Zivi, and T. D. Collins, "Start up performance of load-commutated inverter fed synchronous machine drives," Energy Conversion, IEEE Transactions on, vol. 10, pp. 268-274, 1995.

[28]

R. Emery and J. Eugene, "Harmonic losses in LCI-fed synchronous motors," IEEE Trans. Ind. Appl., vol. 38, pp. 948-954, 2002.

[29]

N. R. Zargari, S. C. Rizzo, Y. Xiao, H. Iwamoto, K. Satoh, and J. F. Donlon, "A new current-source converter using a symmetric gate-commutated thyristor (SGCT)," IEEE Trans. Ind. Appl., vol. 37, pp. 896-903, 2001.

[30]

C. Abbate, G. Busatto, and F. Iannuzzo, "High-Voltage, High-Performance Switch Using Series-Connected IGBTs," IEEE Trans. Power Electron., vol. 25, pp. 2450-2459, 2010.

[31]

K. Zhou and D. Wang, "Relationship between space-vector modulation and three-phase carrier-based PWM: a comprehensive analysis [three-phase inverters]," IEEE Trans. Ind. Electron., vol. 49, pp. 186-196, 2002.

[32]

S. Bernet, E. Carroll, P. Streit, O. Apeldoorn, P. Steimer, and S. Tschirley, "10 kV IGCTs," Industry Applications Magazine, IEEE, vol. 11, pp. 53-61, 2005.

145

[33]

J. Rodriguez, L. G. Franquelo, S. Kouro, J. I. Leon, R. C. Portillo, M. A. M. Prats, and M. A. Perez, "Multilevel Converters: An Enabling Technology for High-Power Applications," Proceedings of the IEEE, vol. 97, pp. 1786-1817, 2009.

[34]

N. Celanovic and D. Boroyevich, "A comprehensive study of neutral-point voltage balancing problem in three-level neutral-point-clamped voltage source PWM inverters," IEEE Trans. Power Electron., vol. 15, pp. 242-249, 2000.

[35]

R. M. Tallam, R. Naik, and T. A. Nondahl, "A carrier-based PWM scheme for neutral-point voltage balancing in three-level inverters," IEEE Trans. Ind. Appl., vol. 41, pp. 1734-1743, 2005.

[36]

M. A. Perez, J. R. Espinoza, J. R. Rodriguez, and P. Lezana, "Regenerative medium-voltage AC drive based on a multicell arrangement with reduced energy storage requirements," IEEE Trans. Ind. Electron., vol. 52, pp. 171-180, 2005.

[37]

Z. Cheng and B. Wu, "A Novel Switching Sequence Design for Five-Level NPC/H-Bridge Inverters With Improved Output Voltage Spectrum and Minimized Device Switching Frequency," IEEE Trans. Power Electron., vol. 22, pp. 2138-2145, 2007.

[38]

P. Barbosa, P. Steimer, J. Steinke, M. Winkelnkemper, and N. Celanovic, "Active-neutralpoint-clamped (ANPC) multilevel converter technology," in Power Electronics and Applications, 2005 European Conference on, 2005, pp. 10 pp.-P.10.

[39]

A. Lesnicar and R. Marquardt, "A new modular voltage source inverter topology," in Proc. EPE, 2003, pp. 1-10.

[40]

M. Hagiwara, K. Nishimura, and H. Akagi, "A Medium-Voltage Motor Drive With a Modular Multilevel PWM Inverter," IEEE Trans. Power Electron., vol. 25, pp. 1786-1799, 2010.

[41]

J. W. Kolar, T. Friedli, J. Rodriguez, and P. W. Wheeler, "Review of Three-Phase PWM AC-AC Converter Topologies," IEEE Trans. Ind. Electron., vol. 58, pp. 4988-5006, 2011.

[42]

J. W. Kolar, M. Baumann, F. Schafmeister, and H. Ertl, "Novel three-phase AC-DC-AC sparse matrix converter," in Applied Power Electronics Conference and Exposition, 2002. APEC 2002. Seventeenth Annual IEEE, 2002, pp. 777-791 vol.2.

146

[43]

C. Klumpner, M. Lee, C. Pitic, P. Wheeler, and P. Zanchetta, "A New Three-Level Indirect Matrix Converter with Reduced Number of Switches," in Industry Applications Conference, 2007. 42nd IAS Annual Meeting. Conference Record of the 2007 IEEE, 2007, pp. 186-193.

[44]

R. W. Erickson and O. A. Al-Naseem, "A new family of matrix converters," in Industrial Electronics Society, 2001. IECON '01. The 27th Annual Conference of the IEEE, 2001, pp. 1515-1520 vol.2.

[45]

L. Xu, J. C. Clare, P. W. Wheeler, L. Empringham, and Y. Li, "Capacitor Clamped Multilevel Matrix Converter Space Vector Modulation," IEEE Trans. Ind. Electron., vol. 59, pp. 105-115, 2012.

[46]

I. Jun-ichi, I. Sato, A. Odaka, H. Ohguchi, H. Kodachi, and N. Eguchi, "A novel approach to practical matrix converter motor drive system with reverse blocking IGBT," IEEE Trans. Power Electron., vol. 20, pp. 1356-1363, 2005.

[47]

B. H. Kwon, B. D. Min, and J. H. Kim, "Novel commutation technique of AC-AC converters," Electric Power Applications, IEE Proceedings -, vol. 145, pp. 295-300, 1998.

[48]

D. A. Paice, Power Electronic Converter Harmonics: Multipulse Methods for Clean Power. Piscataway, NJ: IEEE Press, 1996.

[49]

A. Alesina and M. G. B. Venturini, "Analysis and design of optimum-amplitude nineswitch direct AC-AC converters," IEEE Trans. Power Electron., vol. 4, pp. 101-112, 1989.

[50]

D. Casadei, G. Serra, A. Tani, and L. Zarri, "Matrix converter modulation strategies: a new general approach based on space-vector representation of the switch state," IEEE Trans. Ind. Electron., vol. 49, pp. 370-381, 2002.

[51]

R. K. Gupta, K. K. Mohapatra, A. Somani, and N. Mohan, "Direct-Matrix-Converter-Based Drive for a Three-Phase Open-End-Winding AC Machine With Advanced Features," IEEE Trans. Ind. Electron., vol. 57, pp. 4032-4042, 2010.

[52]

H. M. Nguyen, H. H. Lee, and T. W. Chun, "Input Power Factor Compensation Algorithms Using a New Direct-SVM Method for Matrix Converter," IEEE Trans. Ind. Electron., vol. 58, pp. 232-243, 2011.

147

[53]

C. Klumpner, F. Blaabjerg, I. Boldea, and P. Nielsen, "New modulation method for matrix converters," IEEE Trans. Ind. Appl., vol. 42, pp. 797-806, 2006.

[54]

L. Helle, K. B. Larsen, A. H. Jorgensen, S. Munk-Nielsen, and F. Blaabjerg, "Evaluation of modulation schemes for three-phase to three-phase matrix converters," IEEE Trans. Ind. Electron., vol. 51, pp. 158-171, 2004.

[55]

J. Rodriguez, M. Rivera, J. W. Kolar, and P. W. Wheeler, "A Review of Control and Modulation Methods for Matrix Converters," IEEE Trans. Ind. Electron., vol. 59, pp. 58-70, 2012.

[56]

Y. Young-Doo and S. Seung-Ki, "Carrier-Based Modulation Technique for Matrix Converter," IEEE Trans. Power Electron., vol. 21, pp. 1691-1703, 2006.

[57]

B. Wang and G. Venkataramanan, "Six Step Modulation of Matrix Converter with Increased Voltage Transfer Ratio," in Power Electronics Specialists Conference, 2006. PESC '06. 37th IEEE, 2006, pp. 1-7.

[58]

R. W. Erickson and D. Maksimovic, Fundamentals of Power Electronics: Kluwer Academic Publishers, 2001.

[59]

M. Malinowski, K. Gopakumar, J. Rodriguez, and M. A. Pérez, "A Survey on Cascaded Multilevel Inverters," IEEE Trans. Ind. Electron., vol. 57, pp. 2197-2206, 2010.

[60]

M. Glinka and R. Marquardt, "A new AC/AC multilevel converter family," IEEE Trans. Ind. Electron., vol. 52, pp. 662-669, 2005.

148

