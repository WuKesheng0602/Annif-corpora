NOTE TO USERS

This reproduction is the best copy available.

UMI

SPACE VECTOR MODULATION FOR THREE-LEVEL NEUTRAL POINT CLAMPED INVERTER

By

Weixing Feng

A project presented to Ryerson University in partial fulfillment of the requirement for the degree of Master of Engineering in the program of Electrical and Computer Engineering

Toronto, Ontario, Canada, 2004 Â©Weixing Feng 2004

UMI Number: EC52908

INFORMATION TO USERS

The quality o f this reproduction is dependent upon the quality o f the copy subm itted. Broken or indistinct print, colored or poor quality illustrations and photographs, print bleed-through, substandard margins, and im proper alignm ent can adversely affect reproduction. In the unlikely event that the author did not send a com plete m anuscript and there are missing pages, these will be noted. Also, if unauthorized copyright m aterial had to be removed, a note will indicate the deletion.

UMI
UMI Microform EC52908 C opyright 2008 by ProQ uest LLC. All rights reserved. This microform edition is protected against unauthorized copying under Title 17, United States Code. ProQ uest LLC 789 E. Eisenhow er Parkway PC Box 1346 Ann Arbor, Ml 48106-1346

AUTHOR'S DECLARATION

I hereby declare that I am the sole author of this project.

I authorize Ryerson University to lend this project to other institutions or individuals for the purpose of scholarly research.

Signature:

I fiirtlier authorize Ryerson University to reproduce this project by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

Signature:

11

BORROWER'S PAGE

Ryerson University requires the signatures of all persons using or photocopying this project. Please sign below, and give address and date.

Ill

SPACE VECTOR MODULATION FOR THREE-LEVEL NEUTRAL POINT CLAMPED INVERTER

ABSTRACT
For most medium voltage high power applications, Neutral Point Clamped (NPC) three-level inverter is a preferred choice due to its advantages such as low cost, light weight and compact size. Space vector modulation is widely used in real-time digital control for power converters. It is especially suitable for use in NPC multilevel inverters due to its good harmonic profile, flexibility and easy digital implementation. This thesis focuses on the space vector modulation for high power three-level NPC inverter, where the switching frequency o f the semiconductor devices is nomially below 1OOOHz to reduce the power loss o f the switching devices. The conventional space vector modulation (SVM) scheme for the three-level NPC inverter produces even order harmonics in the output voltages, which are not desirable for most industrial applications. In this thesis, the mechanism of even order harmonic generation is analyzed. A new space vector modulation scheme, which can eliminate all the even order harmonics, is proposed. The perfomiance of the new design is investigated and simulation results are provided for the verification purpose. The hamionic and THD profiles are compared with those of the conventional SVM scheme. The elimination of even order hamionics is achieved at the expense of a slight increase in the switching frequency. The proposed space vector modulation scheme can be applied to other types of converters for

IV

the even order harmonic elimination. An algorithm is developed to mitigate the neutral point potential deviation, which is a common problem in the NPC inverters. The simulation results show that this algorithm is suitable for both conventional and the proposed space vector modulation schemes.

V

ACKNOWLEDGEMENTS

I would like to express my sincere gratitude and appreciation to my supervisor Professor Bin Wu. This project would not be successful without his guidance throughout the entire period o f the degree program. 1 would also express my sincere thanks to Dr. D. Xu and Dr. S. Wei for their help and suggestions during my study. My appreciation is extended to other graduate students working in LEDAR for their assistance and discussions.

Thanks are extended to my wife Mrs. Chunhong Huang and my son Tongle Feng for their fully support.

VI

CONTENTS

1. Chapter 1 Introduction............................................

1

1.1 High Power Inverter Topologies............................................................................. 2 1.2 Modulation Techniques for High Power Three-level Inverter..............................8 1.3 Research Objectives.............................................................................................. 12 1.4 Thesis Outline .............................................................................................. 13

2. Chapter 2 Space Vector Modulation for Three-level Neutral Point Clamped Inverter..................................................................................... 14
2.1 Tliree-level Neutral Point Clamped Inverter.......................................................15 2.2 Space Vector Modulation.....................................................................................21 2.3 Sum m ary............................................................................................................... 39

3. Chapter 3 Simulations and Harmonics A nalysis............................. 40
3.1 Modeling of Simulations....................................................................................... 40 3.2 Waveforms and Harmonic Analysis..................................................................... 43 3.3 Harmonic and THD Profiles................................................................................. 52 3.4 Neutral Point Potential Control............................................................................57 3.5 Summary................................................................................................................ 59

vii

4. Chapter 4 Even Order Harmonic Elimination................................. 60
4.1 Mechanism of Even Order Harmonic Generation..............................................60 4.2 New Space Vector Modulation Algorithm......................................................... 66 4.3 Simulations of the New Algorithm......................................................................69 4.4 Neutral Point Potential Control........................................................................... 76 4.5 Sununary ..................................................................................................... 76

5. Chapter 5 Conclusions..........................................................................77

R eferences .................................................................................................................... 79

Appendix I Harmonic limits of IEEE standards 519-1992....................................... 80 Appendix II Switching Pattern Design based on Traditional Scheme.................... 82 Appendix III Switching Pattern Design based on New Scheme.............................85 Appendix IV S-function Program used in Gating Signal Generator.......................88

Vlll

L IST O F TABLES

Table 2-1 Switching states of each phase in tliree-level NPC inverter....................................17 Table 2-2 Tliree-phase switching states of three-level NPC inverter...................................... 20 Table 2-3 Space vectors and corresponding switching states.................................................23 Table 2-4 Seven segments in sub-region I - l a .......................................................................... 31 Table 2-5 Two patterns of switching state sequence in I-la .................................................... 33 Table 3-1 Harmonic analyses under different amplitude modulation index ma.................... 48 Table 4-1 New switching state sequence in I-lb and IV -lb.................................................... 67

IX

LIST O F F IG U R E S

Fig. 1.1 Simplified configuration of three-level NPC inverter...............................................3 Fig. 1.2 Simplified topologies of cascaded H-bridge multilevel inverter.............................. 3 Fig. 1.3 Simplified power circuit of three-level flying capacitor inverter............................. 7 Fig. 1.4 Phase-shifted modulation scheme for a seven-level inverter.................................... 9 Fig. 1.5 Voltage-shifted modulation schemes for a five-level inverter.................................. 9 Fig. 1.6 Spaee vectors ( F . - Vis) and reference vector ( IVe/) for three-level inverters 11

Fig. 2.1 Simplified power circuit of NPC three-level inverter............................................... 16 Fig. 2.2 Two options of the DC voltage source........................................................................16 Fig. 2.3 Three switching states of each phase.........................................................................17 Fig. 2.4 Space vectors of the tlrree-level NPC inverter..........................................................24 Fig. 2.5 Division of the space diagram ....................................................................................27 Fig. 2.6 Reference vector in 1-2............................................................................................... 27 Fig. 2.7 Space vector modulation in 1 -la .................................................................................31 Fig. 2.8 Directions o f switching state sequence in I-la based on two patterns................... 33 Fig. 2.9 Directions of the switching state sequence for pattern I .................................. 34

Fig. 2.10 Neutral point potential deviation under redundant switching states of V ; ........36 Fig. 2.11 Closed-loop control of neutral point potential.........................................................38 Fig. 3.1 Simulation model of space vector modulated Three-level NPC Inverter.............41 Fig. 3.2 Configuration of phase A in Tliree-level NPC Inverter sub-system..................... 41

X

Fig. 3.3 Gating signal generator sub-system........................................................................... 44 Fig. 3.4 Flowchart of S-function program............................................................................... 44 Fig. 3.5 Simulated waveform s............................................................................................46,47 Fig. 3.6 Waveform and spectrum of vab (Wa=0.8,//=60Hz, /ia=1440Hz).......................... 49 Fig. 3.7 Waveform and spectrum of (Wa=0.6,//=60Hz, /ia=1440Hz).......................... 49

Fig. 3.8 Waveform and spectrum of vab (7 Â» a= 0 .4 ,//= 6 0 H z,=1440Hz).......................... 50 Fig. 3.9 Waveform and spectrum of vab (7?7a=0.2,/i=60Hz, /ia=1440Hz).......................... 50 Fig. 3.10 Linear relationship between Vabi ,rm s and iria.......................................................... 51 Fig. 3.11 Waveform and spectrum of vab (ma=0.8,//=60Hz,^a=720Hz)............................53 Fig. 3.12 Wavefonn and spectrum of vab (/Ma=0.8,y}=30Hz,^ =720Hz)............................53 Fig. 3.14 Harmonic profile (/}=60Hz,7^=1440Hz)............................................................... 54 Fig. 3.15 THD profile (/}=60Hz, /ia=1440Hz)....................................................................... 54 Fig. 3.16 Harmonic profile (/}=60H z,^=l080H z)...............................................................55 Fig. 3.17 THD profile (/}=60H z,^=1080H z)...................................................................... 55 Fig. 3.18 Harmonic profile (/}=60Hz,^a =720Hz)................................................................. 56 Fig. 3.19 THD profile (/}=60Hz,_/;Â«=720Hz).........................................................................56 Fig. 3.20 Closed-loop controlled capacitor voltages with same DC capacitors.................. 58 Fig. 3.21 Closed-loop controlled capacitor voltages with different DC capacitors............. 58 Fig. 4.1 SVM and waveforms of Vab in I-lb and IV -lb based on traditional schem e........63 Fig. 4.2 Waveforms o f vao and vab generated by traditional scheme (777^=0.4, rnf=\2) .......64 Fig. 4.3 SVM and waveforms of vab in I-lb and IV -lb based on new schem e.................. 67 Fig. 4.4 Switching sequence directions of new schem e........................................................ 68 Fig. 4.5 Waveforms of vao and vab generated by new scheme
{ m a - O A , m j = l 2 ) .................

68

XI

Fig. 4.6 Waveform and spectrum o f vab (wÃ®a=0.8,/;=60Hz,^^o=720Hz)..............................71 Fig. 4.7 Waveform and spectrum of Vab (fMa=0.8, /}= 3 0 H z,^ =720Hz)..............................71 Fig. 4.8 Harmonie profile ( / } = 6 0 H z , 1440H z)................................................................ 72 Fig. 4.9 THD profile (/}=60Hz,7^= 1440H z).........................................................................72 Fig. 4.10 Harmonic profile ( / } = 6 0 H z , 1080Hz)................................................................73 Fig. 4.11 THD profile (/}=60Hz,/,Â«= 1080Hz)........................................................................ 73 Fig. 4.12 Harmonic profile (/)=60Hz, /io=720Hz).......... 74

Fig. 4.13 THD profile (/}=60Hz,/,,,=720Hz)......................................................................... 74 Fig. 4.14 Voltages of same DC capacitors with neutral point potential control................. 75 Fig. 4.15 Voltages of different DC capacitors with neutral point potential control........... 75

Xll

Chapter 1 Introduction
With the technology advancements in semiconductor devices such as high-voltage insulated gate bipolar transistors (IGBT) and gate controlled thyristors (GCT), modem multi-megawatt variable frequency drives are increasingly used in petrochemical, mining, steel & metals, transportation and other industries to conserve electric energy, increase productivity and improve product quality. There are a number of liigh-power drive manufacturers around the world, including ABB (Switzerland), Siemens (Germany), Toshiba (Japan), Rockwell Automation (Canada), General Electric (US), ASI Robicon (US) and Alstom (France). These companies use various power converter technologies in their drive products. For instance, ABB produces three-level neutral point clamped inverter fed drives, Rockwell manufactures GCT current source

inverter based drives, Robicon promotes cascaded H-bridge multilevel inverter technology, Toshiba uses multilevel NPC/H-bridge hybrid inverters, and Alstom is developing flying-capacitor multilevel inverter drives. All these drive systems operate at medium voltage (MV) levels, typically from 2300V to 7200V. This thesis focuses on high power three-level neutral point clamped inverter using spaee vector modulation with even order harmonic elimination.

1.1 Multilevel Voltage Source Inverter Fed Drives
1.1.1 Neutral Point Clamped Inverters Fed Drives

A simplified configuration of a three-level neutral point clamped (NPC) inverter fed drive is shown in Fig. 1.1. Some manufacturers use GCTs as switching devices while others use IGBTs or injection enhanced gate transistors (lEGT) in the inverter [1-3]. The device switching frequency is normally around 500Hz. In the dc link, the do capacitor is split into two, providing a neutral point N. The diodes connected to the neutral point are referred to as clamping diodes, which clamp the inverter terminal voltage to the neutral point potential. Due to the clamping function of the diodes, the maximum voltage on each of the switches is E, which is half of the dc link voltage for the three-level inverter. Depending on the drive system design requirements, it is optional to use one or two DC voltage sources [1,2]. With two DC voltage sources, the dc capacitor voltage is fixed. Otherwise, the dc capacitor voltage is floating, and certain measures should be in place to minimize the neutral point potential deviation. The three-level NPC inverter based drive offers the following features and drawbacks. Â· No Dynamic Voltage Sharing Problem. The switches in the NPC inverter do not have dynamic voltage sharing problem mainly due to the use of clamping diodes; Â· Low Harmonics Distortion. The inverter is capable of producing tliree-level inverter terminal voltages with respect to the neutral pint N and five-level line-to-line voltages. Compared with the conventional two-level inverter, the NPC inverter is able to produce better output voltage waveforms with lower THD;

DA l zs

TE B1

D

#
7K
C3

Cl

C2

.+ O

D A5 A DAd D " i DA3
A3

f Vf
B D,C6 jk 'B3
B3

n 3-phase 2 ^ balanced Dgg load

3 $ h K
H

8 ^ 4 !--I^A4 --

%4

nk t ^B4

^C4

jk %

C4

Fig. 1.1 Simplified configuration of three-level NPC inverter.

Fy2-

+

c

H k+

M
output 2k

(a) Power cell for cascaded H-bridge inverter

< I H-bridge cell H-bndge cell H-bridge cell H-bridge cell H-bridge cell

c:- .Z3-- |n

I

H-bridge cell H-bridge cell H-bridge cell

T-phase balanced load

1 ^

H-bridge cell

(b) Topology o f seven-level cascaded H-bridge inverter

Fig. 1.2 Simplified topologies o f cascaded H-bridge multilevel inverter.

Â·

Provision for four-quadrant operation. Majority of the MV drives do no need regenerative operation capability. For more advanced applications where regeneration capability is necessary, the same topology can be applied to the rectifier working as the DC voltage source;

Â·

Possible neutral point potential deviation. With the neutral potential left floating [2], the neutral point potential may vary and the dc link voltage may not be equally divided between the two dc capacitors. Special measures should be taken when designing the PWM schemes to prevent such deviations, which makes the PWM pattern design more complicated; and

Â·

Additional clamping diodes. The NPC inverter requires clamping diodes. The number of clamping diodes can be calculated by 3(w-l)(m-2), where m is the number of voltage levels. For a three-, four- or five-level NPC inverter, the number of the clamping diodes is 6, 18 and 36, respectively. The substantial increase in the clamping diodes makes the four-level and five-level inverters impractical for industrial use.

1.1.2

Cascaded H-bridge Inverter Based Drive

Cascaded H-bridge multilevel inverter is one of the popular converter topologies used in megawatt drives [4-6]. It is composed of multiple units of power cells as shown in Fig. 1.2(a). Each power cell is mainly composed of an H-bridge inverter powered by a three-phase diode rectifier connected to an isolated secondary winding of a phase shafting (zigzag) transformer. The power cells in one inverter phase are normally connected in cascade on their ac output side to achieve high voltage operation and low harmonic distortion. The number of power cells in a drive is mainly determined by the operating voltage and manufacturing cost. For

instance, in ac drives with a rated line-to-line voltage of 2300V, the seven-level inverter in Fig. 1.2(b) can be used, where the inverter has a total of nine power cells using 600V class components [4]. The use of identical power cells leads to a modular structure, which is an effective means for cost reduction. The number of voltage levels in a cascaded H-bridge inverter, w, can be found from ot = (2//+1), where H is the number of H-bridge cells per phase. The cascaded H-bridge inverters with seven to eleven voltage levels are most widely used in industry. The multilevel inverter requires a number of isolated dc supplies, each of which feeds a power cell. The dc supplies are normally obtained from multipulse diode rectifiers [7], For the seven- and nine- and eleven-level inverters, 18-, 24- and 30-pulse diode rectifiers can be used, respectively. The cascaded H-bridge multilevel inverter fed drive has a number of features, including: Â· Low voltage THD and dv/dt. The inverter output voltage waveform is formed by several small voltage steps (levels), and distributed sinusoidally over time, resulting in a low THD and dv/dt; Â· Modular structure. The multilevel inverter is composed of multiple units of identical H-bridge power cells, which is an effective means for reducing the manufacturing cost; Â· High voltage operation without switching devices in series. The power cells are connected in cascade to withstand high ac voltages. There are no voltage sharing problems among the switching devices; Â· Low line current THD. The low-order harmonic currents produced by diode rectifiers are cancelled by the phase shifting transformer, assuring compliance with IEEE Standard 519-1992; and

Â·

Optional degrees of redundancy. The modular nature o f the drive allows optional degrees of redundancy. An electronic bypass switch can short the output of a defective power cell such that the current from the remaining eells ean reach the motor.

There are some drawbacks associated with the drive: Â· A large number of isolated dc supplies. The dc supplies for the cascaded H-bridge inverter are usually obtained from a multipulse diode rectifier employing an expensive phase shifting transformer with a nine to eighteen sets of secondary windings; Â· Large number of cables. The cascaded H-bridge inverter fed drive require 27 to 54 cables connecting the transformer secondary windings to the power cells. It is expensive to place the transformer away from the drive. If the transformer can be located outside the electrical equipment room, the physical space for the drive can be smaller, and the losses fi-om the transformer are not dissipated into the electrical room, allowing a much lower rating for the room's cooling equipment; and Â· No regenerative operation capability. None of the cascaded H-bridge inverter fed drives currently operating in the field has regenerative operation capability. It is technically possible to design a multilevel regenerative PWM rectifier that provides isolated dc supplies for the inverter [8,9]. However, the manufacturing cost of such a drive will be too high to be accepted by its user. 1.1.3 Flying Capacitor Inverter Fed Drive

As shown in Fig. 1.3, the flying-capacitor multilevel inverter can be easily constructed by adding dc capacitors to the two-level inverter [10]. Therefore, it preserves some of the features of the two-level inverter such as modular design. Like other multilevel inverters, the flying-capacitor inverter also features low THD and dv/dt in the inverter output voltage.

ID

IP

z:

Cl

D B2

D02 25

B
"B1

c Cl

-"B 3

D 83

-'C3

3-phase 7f^ balanced Dp. load

HK25 S Ã§ ^ D C4 Fig. 1.3 Simplified power circuit of three-level flying capacitor inverter.

The main drawbacks include a) difficulties to balance the voltages on the dc capacitors, b) complex switching pattern design, and c) necessity of isolated pre-charging circuits for the dc capacitors. It is these drawbacks that prevent this topology from a widespread application in high-power drive systems.

1.2 Modulation Techniques for the High Power Multilevel Inverter
The modulation schemes for the multilevel voltage source inverters can be generally classified into carrier based modulation and space vector modulation. 1.2.1 Carrier Based Modulation

There are two commonly-used carrier based modulation schemes: phase-shifted and voltage-shifted modulations. In general, a multilevel inverter with m voltage levels requires (m -1) triangular carriers. The modulating signal is usually a three-phase sinusoidal wave with adjustable amplitude and frequency. The gate signals are generated by comparing the modulating wave with the carrier waves. a) Phase-shifted Modulation All the triangular carriers of phase-shifted modulation have the same frequency and the same peak-to-peak amplitude, but there is a phase shift between any two adjacent carrier waves, given by =360Â°/(m-l). Fig. 1.4 shows the principle of the phase-shifted to

modulation for tlie seven-level cascaded H-bridge inverter. The triangular carriers are compared with phase A modulation wave to generate gate signals.

^

^o5

^o2

^4

^

Fig. 1.4 Phase-shifted modulation scheme for a seven-level inverter.

(a) In-phase disposition (IPD)

^crl
0

^crt

/^ s /\ /

.

A

A

A

(b) Alternative phase opposition disposition (APOD)

(c) Phase opposition disposition (POD)

Fig. 1.5 Voltage-shifted modulation schemes for a five-level inverter.

b) Voltage-shifted Modulation All of the {m-l) triangular carriers of voltage shifted modulation have the same frequency and amplitude. They are vertically disposed such that the bands they occupy are contiguous. Fig. 1.5 shows three schemes for the voltage-shifted modulation for a five-level inverter: (a) In-Phase Disposition (IPD), where all carriers are in phase; (b) Alternative Phase Opposition Disposition (APOD), where all carriers are alternatively in opposition disposition; and (c) Phase Opposition Disposition (POD), where all carriers above the zero reference are in phase but in opposition with those below tlie zero reference. 1.2.2 Space Vector Modulation

Space vector modulation (SVM) is one of the preferred real-time modulation techniques and is widely used for digital control of rectifiers and inverters. For a given inverter (or rectifier) topology, there are a certain number of switching states. Each switching state produces a defined inverter output voltage, which can be represented by stationary voltage vectors in space. A collection o f all the space vectors forms a space vector diagram. A reference voltage vector rotates in space within the space vector diagram. For a given position in space, the reference vector can be approximated by tliree nearest stationary' vectors, based on which the gating signals for the switches in the inverter can be generated. Therefore, when the reference vector rotates in space for one revolution, the inverter output voltage changes one fundamental cycle. The magnitude of the inverter fundamental output voltage corresponds

to length o f the reference vector while its frequency corresponds to the rotating speed of the reference vector. [11, 12] For the three-level NPC inverter, the space vector diagram is shown in Fig. 1.6.

10

Bn

EC

[OPN]

[OPO] [NON]

V ,
'V j
[PPP]

[PON]

[000]

[NPO]

[W JN ]
VreÃ¹

[PNN]

Y I

[NPP] [NOP]

\

[POO] [ONN]

An

CA`

^6[POP] \ [ONO]

[PNO]

[PNP]
CÂ«

Fig. 1.6 Space vectors (F ~ Vis) and reference vector ( F ^ for three-level inverters.

11

The space vector modulation in general provides the following features; Â· Â· Â· Low harmonics distortion, Effective neutral point potential control, and Easy digital implementation.

However, the traditional space vector modulation scheme produces even order harmonics in the output voltages o f the multilevel inverter, which is not desired for most industrial applications. Especially, if SVM scheme is used for three-level NPC rectifier, it produces even order harmonics in the input currents, which can not satisfy the IEEE standards 519-1992. These standards are included in Appendix I for reference. The problem of even order harmonics can be solved by a new scheme proposed in this thesis.

1.3 Research Objectives
The simulation investigations find that the undesired even order harmonies are produced by the traditional space vector modulation for three-phase three-level NPC inverter. From literature survey, it was found that the generation mechanism of the even harmonics had not been studied and there is neither any algorithm to solve this problem. Furthermore, the deviation o f the neutral point potential should also be mitigated for the three-level NPC inverter. Hence, the objectives of this thesis are to Â· reveal the generation mechanism of the even order harmonics in the output voltages of the traditional space vector modulated three-phase three-level NPC SVM inverter, Â· develop a new SVM scheme to eliminate the even order harmonics in the three-level NPC inverter, and

12

Â·

develop a control algorithm to correct the neutral point potential deviation in the three-level NPC inverter.

1.4 Thesis outline
This thesis consists o f five chapters. In the first chapter, a critical review on high power multilevel inverters and modulations schemes is conducted, and the objectives of the thesis are presented. Chapter 2 introduces the three-phase three-level NPC inverter and the principle of the SVM. Following the discussion of the power circuit and switching states of the NPC inverter, the space vectors corresponding to the inverter switching states are presented. The dwell time calculation and switching pattern design are introduced. The impacts of the redundant switching states to the neutral point potential are analyzed. A closed-loop control algorithm is developed to correct the deviation of the inverter neutral point potential. Chapter 3 investigates the performance of tlie three-level NPC SVM inverter by simulations. The Simulink models for the proposed power circuit and SVM scheme are simulated. The harmonic analyses are conducted to obtain the THD profiles. The closed-loop control of the neutral point potential is verified. Chapter 4 presents the elimination of the even order harmonics in the output voltages of the NPC inverter. The mechanism of the even order hamionic generation in the traditional SVM method is revealed. A new SVM scheme is developed for the elimination of the even order harmonics. The effectiveness of the new scheme is verified by simulations. The closed-loop control for the neutral point potential is demonstrated that the neutral point potential deviations can be cancelled. Chapter 5 provides the conclusions of this thesis research and suggestions for the future study.

i;

Chapter 2 Space Vector Modulation for Three-Level Neutral Point Clamped Inverter
Space Vector Modulation (SVM) is one of the preferred modulation schemes used in three-level Neutral Point Clamped (NPC) inverter, which can offer good harmonic profile, extended linear operation range, effective neutral point potential control and easy digital implementation. In SVM, a reference vector is approximated by the nearest stationary space vectors, which represent the switching states of the inverter. Therefore, the amplitudes of the inverter output voltages can be controlled by the magnitude of the reference vector while the fundamental frequency corresponds to the rotating speed of the reference vector. This chapter presents the general principle of the space vector modulation for three-level neutral point clamped inverter. The circuit structure and the switching states of the three-level NPC inverter are introduced. The space vectors, reference vector, dwell time calculation, switching state sequence, and neutral point potential control of the NPC inverter are also presented.

14

2.1 Three-level Neutral Point Clamped Inverter
The three-level NPC inverter features higher operating voltage without devices in series, better output voltage THD, and lower electromagnetic interference (EMI). Therefore, it is increasingly used in high power applications. In this section, the power circuit and the switching states of this type of inverter are introduced. 2.1.1 Power Circuit of Three-Level NFC Inverter

The simplified power circuit of three-level NPC inverter is shown in Fig. 2.1. There are four switching devices (Sxi-Sxd, four anti-parallel diodes {Dxi~Dx4) and two clamping diodes {Dx5 and Dx6) in each leg, where the subscript X represents legs A, B or C, respectively. For example,

S a i stands for the switching device in leg A connected to the positive bus. The DC

capacitor splits into two to produce a neutral point o, so that a single DC voltage source can be used in the three-level NPC inverter. If two identical DC voltage sources are connected to the inverter as shown in Fig. 2.2 (a), the neutral point potential is fixed at zero. However, when a single DC voltage source is used as shown in Fig. 2.2 (b), deviations of the neutral point potential may occur. It causes unbalanced voltage stress on the switching devices and also introduces some undesired harmonics to the output voltages. Therefore the performance o f the inverter is deteriorates. A solution to this problem will be discussed in detail in Section 2.2.5. 2.1.2 Per-phase Switching States

In three-level NPC inverters, the phase voltage is defined as the voltage between the phase output and the neutral point o, and is determined by three per-phase switching states, [P], [O] and [N], which are shown in Fig. 2.3.

15

+

P bi

%
c,
D V r^
----

%

2\

Scj ~1P,C l zs

* %

f a # 4%
B Db6
%

^C2

D,C2 2K

0

5

"

af 6

^A3

A3

Â¥

HK

l 5Â«

Ã

3-phase balanced A(-j load

DA4

^B4

HK zK AB4

Ac-/

Fig. 2.1 Simplified power circuit o f NPC three-level inverter.

+ E'

C,

C

Three-level NPC inverter

F 3-phase balanced load

+

o C,

Three-level NPC inverter 3-phase balanced toad

+

c.

(a) two identical DC voltage sources

(b) one DC voltage source

Fig. 2.2 Two options of the DC voltage source.

16

Positive DC bus
XI

Positive DC bus
XI

Positive DC bus
Sxi

X2

output

output

output

X3

X4

Negative DC bus (a) [P] state

Negative DC bus (b) [O] state

Negative DC bus (c) [N] state

Fig. 2.3 Three switching states of each phase.

Table 2-1 Switching states o f each phase in tliree-level NPC inverter Switching state [P] [0 ] [N] Sxi On Off Off Sx2 On On Off Off On On Sx4 Off Off On Inverter phase voltage Vxo +py2 0

17

Â·

[P] S ta te

In this state, the upper two switching devices, Sxi and Sx2, are on and the lower two, Sxs and Sx4, are off. Since the upper clamping diode Dxs is reversely biased, it is turned off. The anode of the lower clamping diode Dxe is floated because of the off-state of Sx3 and Sx4. Thus the output o f the phase is connected to the positive DC bus through Sxi and Sx2 . As a result, the phase voltage is + V/2. Â· [O] state

In this state, Sxi and Sx4 are off while Sx2 and Sx3 are on. The output of the phase is connected to neither positive pole nor negative pole of the DC link. When the phase current is positive (flowing out o f inverter), the current can flow through Dxs and Sx2 from the inverter neutral point, so that the output voltage is clamped at neutral point. Similarly, when the phase current is negative (flowing into inverter), Dxe and Sx3 clamp the output voltage to zero. Therefore, the phase output voltage in this state is clamped at zero. Â· [N] state

In this state, Sxi and Sx2 are turned off, while Sx3 and Sx4 are in on-state. As reversely biased,

D x 6is inconductive. Sxi and Sx

2

discomiect the cathode of Dxs. Sx3 and Sx4 connect the output

to the negative DC bus. Hence, the output phase voltage is -Vd/2 in this state. The above discussed three per-phase switching states are listed in Table 2-1. It can be observed that the operations o f switching devices in the same leg, such as a pair of Sxi and Sx3 or a pair of Sx2 and Sx4, are complementary. When one of them in a pair is switched on, the other in the same pair must be off. The both-on or both-off situation of the complementary devices is not allowed. The transition between [P] state and [N] state is prohibited. Therefore, the dynamic voltage

18

sharing problem could be avoided in the three-level NPC inverter. Furthermore, the magnitude of step changes o f the output voltages in the three-level NPC inverter is Vy2, which is only half of that in traditional two-level inverters. As a result, less EMI is generated.

2.1.3 Inverter Switching States Since the proposed NPC inverter has three per-phase switching states, there exist 27 switching states in the three-phase inverter, which are shown in Table 2-2. In Table 2-2, the three capital letters in the brackets represent the switching states of inverter legs A, B and C. For example, the inverter switching state [PON] means phase A is in [P] state, phase B is in [O] state and phase C is in [N] state. Thus the inverter phase voltages, vao, vbo and vco, are Py2, 0 and - V/2, respectively. The line-to-line voltages, voltages;
V
ab

vab, vbc

and

vca,

can be obtained through the inverter phase

~ V

ao

V

bo

V

ca

~ Vco

--

V

ao

The voltage between the 3-phase balanced load neutral point n and the inverter neutral point o is: = -^lPco)/3 (2 1-2)

And the phase voltages of 3-phase balanced load can be obtained by either:

=

(2 1-3)

19

Table 2-2 Three-phase switching states of three-level NPC inverter
Group Switching state Inverter phase voltage Line-to-line voltages No. [ABC] Load neutral voltage Load phase voltages
^An

^ A o

^Bo

Vco

Vab

Vbc

Vca

VSn

Vcn

[NNN] 0 [0 0 0 ] [PPP] [POO] [ONN] [PPOl [CON] [OPOl [NON!
ro p p i

-K /2 0
py?

-P /2 0 P /2 0 -P /2 P /2 0 P /2 0 P /2 0 0 -P /2 0 -P /2 0 P /2 P /2 0 -P /2 -P /2 -P /2 P /2 P /2 P /2 -P /2 -P /2

- p /2 0 P /2 0 -P /2 0 -P /2 0 -P /2 P /2 0 P /2 0 P /2 0 -P /2 -P /2 0 P /2 P /2 0 -P /2 -P /2 -P /2 P /2 P /2 P /2

0

0

0

-p /2 0 P /2 P /6 -P /2 P /3 -P /6 P /6 -P /2 P /2 -P /6 P /6 -P /2 P /2 -P /6 0 0 0 0 0 0 -P /6 P /6 -P /6 P /6 -P /6 P /6

0

0

0

1 2
3 4

p /2 0 p /2 0 0 -P /2 0 -P /2 0 -P /2 P /2 0 P /2 0 -P /2 -P /2 0 ^2 P /2 P /2 -P /2 -P /2 -P /2 P /2

P /2 0 -P /2 -P /2 0 P /2 P /2 -P /2
-Prf

0 p /2

-P /2 -P /2

p /2 P /6 -P /6 -P /2 - P /6 P /6 P /2 0 -P /2 -P /2 0 P /2 2P /2 P /2 -P /2 -2P /2 -P /2 P /2

-p /6 P /6 P /2 P /6 -1 /6 -P /2 0 P /2 P /2 0 -P /2 -P /2 -P /2 P /2 2 P /j P /2 -P /2 -2P /3

-p /6 -P /2 -P /6 P /6 P /2 P /6 -P /2 -P /2 0 P /2 P /2 0 -P /2 -2K/3 -P /2 P /2 2 P /2 P /2

P /2 0 -P /2 -P /2 P /2
Vd

0 P /2 P /2 0
-Vd

[NOG] [OOP] [NNOl [POP] [ONOl [PONl
[OPNl

5 6 7 8 9

-P /2 P /2
Vd

[NPOl [NOPl [ONPl [PNO] [PNN] [PPNl [NPN] [NPPl [NNPJ [PNP]

P /2 -P /2
-Vd

10 11 12
13 14 15 16 17

-P /2 P /2
Vd Vd

P /2 -P /2 -P /2
-Vd

-P /2 0
Vd Vd

0
-Vd -Vd 0 Vd

0
Vd Vd

0
-Vd -Vd

18

0

20

or:

(2 1-4)

Vo, = ( V c x - V j / 3 According to the line-to-line voltages and the load phase voltages, the inverter switching states are classified into 19 groups as shown in Table 2-2, in which some groups have two or three inverter switching states although their inverter phase voltages are different. Particularly, group 0 has three inverter switching states, and each of group 1 to group contains two switching states.
6

2.2 Space Vector Modulation
This section presents the general principles of the SVM applied in the presented three-phase three-level NPC inverter. The space vectors, reference vector, dwell time calculation, space vector selection and switching state sequence of the inverter are discussed. A mitigation algorithm for solving neutral point potential deviations is proposed in detail as well. 2.2.1 Space Vectors of Three-Level NPC Inverter According to the 3-phase-to-2-phase frame transformation [11], the output voltages of the three-phase three-level NPC inverter can be represented by space vectors in the a-P frame: 2n cos-- 3 sm-- 3
.
I
k

Va VA where Va and

1
_ 2

COS-----

^K 3

V a.

V a.

3 0

sin-- 3

.

Ak

V b.

(2 .2 - 1)

Vc,,

Vc.

are the real and imaginary components of the space vector.

21

The space vector can be written as; E
= 1

E

1

e

(2.2-2)

+
( \ y = tan* r 4

,

(12-3) (2.2-4)

I F I is the magnitude, and y is the phase angle of the space vector. Based on Eqs. (2.2-1) to (2.2-4), space vectors corresponding to the switching states of the inverter can be obtained as shown in Table 2-3. Eq. (2.2-1) is used to calculate the a and (5 components of the space vectors, after substituting the load phase voltages produced by the switching states. The magnitude and the phase angle of the space vectors can be obtained from Eqs. (2.2-3) and (2.2-4), respectively. For instance, the load phase voltages in switching state [PON] are E /i, 0 and - V/2. Substituting them into Eq, (2.2-1), vÂ« and v^are obtained as V /2 and Vs V/6. According to Eq. (2.2-2), the space vector corresponding to this switching state is ^f3 V /3 e where the magnitude is Vs V /3, and the phase angle is n/6. which is corresponding to the switching state

In Table 2-3, this space vector is shown as

[PON]. Other space vectors can be acquired similarly. Fig. 2.4 illustrates the diagram of all space vectors, which are listed in Table 2-3. Based on their magnitudes, the 19 space vectors correspond to the 27 switching states of the three-level NPC inverter, which can be further classified into four types, zero vector, small vectors, medium vectors, and large vectors, as shown in Table 2-3 and Fig. 2.4.

99

Table 2-3 Space vectors and corresponding switching states

Name

V o V IP V , V in V 2 P V 2 V 2N
K jf

V a 0

space vector

V p
0 0

M agnitude

Phase angle

Switching state

Load phase voltages

0

0 0 n /3

roool
[NNNl
[POO]

[PPPl

0

V o , 0 0
-pyd

[O N N ]
[PPO] [OON] [OPO]

-P/d P/d

V sp y a V3py<^ pyj

-P/2 -P/d pyd py2 pyd -p/2 -P/2
0

V s N V 4 P K, V 4N V s p V s N V s p pyd V s N V r 0 V s V p -p y 2 V /o - K /2 0 V u py; V 12 V l3 p y j V ,4 py^ V is - p y j - pyj V V l7 -pyj
2

[N O N ]

- P /6

P/2 P/d -P/d

0
-V 3 pyd -V 3 p y a V3py(^ V sp y j V3py(^ -V 3 pyd V sp y j

n 4 t i /3 7 1 ^ 6
71/2 571/6
7;z/(^

[OPP]

[N O O ]
[OOP] [NNO] [POP]

-pyj

-p /d

[O N O ]
[PON] [OPN] [NPO] [NOP] [ONP] [PNO] [PNN] [PPN]

pyd py?
0

-P/2
0

P/2 P/2

-p/2 -P/2

0
-P/2 -P/2 -P/2 py2 2P/2 P/2

P/2 P/2

-V sp y j
-V 3 p y 6

371/2

0
P/2 2P/J -P /j -2P/2

0

1 1 7 /6 0
7/3
2

0
-P/2 -2 P/2 -P/2 P/2 2P/2 py2

V spyj V Fpyj 0 -Vs p y j -V sp y j pyj

is

2

7 T 47/3

2 ;z /3

[N P N ]
[NPP] [NNP] [PNP]

-P /j
P/2

-P/2
-2 P/2

pyj

23

'

BC

[OPN]

[OPO] \ [NON]

V ]
[PPP]

f [PPO] K,[OON]
F7 [PON]
[000]
[WfN] V r e fj

[NPO]

[PNN]

V , [POO]
[NPP] [NOP] \ [ONN]

An

ex'
[PNO]

AB

F/;[N NP]
Cn

[PNP]

Fig. 2.4 Space vectors of the three-level NPC inverter.

24

The zero vector corresponds redundantly to three switching states, [PPP], [0 0 0 ] and [NNN] since these switching states produce zero load voltages. For the same reason, it can be found that each small vector has two redundant switching states. For instance, small vector Vj corresponds redundantly to two switching states [POO] and [ONN]. Depending on whether the switching states contain [P] state or [N] state, the small vectors are further classified as [P] type small vector or [N] type small vectors. For example, because of containing a [P] state, [POO] is classified as a [P] type small vector, which is called as sorted as a [N] type small vector, named as Similarly, [ONN] is

The redundancy o f switching states offers

not only flexibility in switching pattern design, but also a method for the inverter neutral point potential control, which is discussed in detail in Sections 2.2.4 and 2.2.5. 2.2.2 Reference Vector and Space Vector Modulation The output voltages of the three-phase three-level NPC inverter can be represented by a reference vector Vre/, shown in Fig. 2.4. Space vector modulation can be realized by approximating F^/ with space vectors based on 'voltage-second balancing' principle. The product of F^/ and 7^ equals to the sum of the selected space vectors multiplied by their time intervals within each sampling period: x:r,=:E(iF,x :% ) 7:, = :E(7D (2 .2 -5 ) C2 .2 -6 )

where F, and F, represent a space vector and its dwell time to approximate Vre/-

25

Normally, the nearest three space vectors are selected in order to reduce the harmonic distortion. The dwell times o f tire selected space vectors need to be calculated for the SVM implementation. 2.2.3 Dwell Time Calculation To facilitate the space vector selection and the dwell time calculation, the space diagram is divided into six sectors (I to VI) as illustrated in Fig. 2.5. Each of these sectors can be further divided into four regular triangle regions (1 to 4). When the reference vector F^^/is located in a certain region, the space vectors on the vertexes of this region should be selected. For the purpose of switching pattern design, region
1

and

2

are further divided into two sub regions,

sub-region a and sub-region b. The dwell time can be calculated from Eqs. (2.2-5) and (2.2-6) by substituting the reference vector and the selected space vectors into them. a) Dwell Time Calculation in Region 2 When the reference vector is located in region 2 of sector 1, as showm in Fig. 2.6, the space vectors used to approximate the reference vector are Vj, and F;. Their dwell times are

Ta, Tc and 7^, respectively. Therefore, Eqs. (2.2-4) and (2.2-5) can be rewritten as: F , x 7 ; + F 2 x 7 ; , - H F^xT^,
+

(2.2-7)
( 2 .2 - 8)

where

F r e f, F

/,

V 2 and F 7 can be calculated as:

26

B r t

Sector II
BC

II-4

n-3
II-2b II-2a

Sector III

II1-3

Sector I
I-2b I-lb I-la I-2a

II-lb

ll-Ia

lll-2 f
III-4

m-la

'16

IV -la IV-3 IV-2a tV-2b IV-lb, V -la
V - lb

VI-1b VI-4

An

VI-2a
AB

V-2a IV-4

V-2b

Sector rV
V-3 V-4

Sector VI

Cn

Sector V

Fig. 2.5 Division of the space diagram.

1-4

I-2b

I-lb I-la

I-2 a 1-3
a

Fig. 2.6 Reference vector in 1-2.

27

^ r e f ^ \V r e /l X COS (Ã )

+}

X

\ Vref\

X S ill

(9),
(2.2-9)

V ] = V d l 3 x CO S (0) + ' ] x V d / 3 x sin (0), V2 =Vd! 3 X cos (7 t/3 ) + j X Vd! 3 x sin (it/3), Vs Vd!3 X cos (n/6) + j x V3 F^/3 x sin (n/6).

Substituting Eqs. (2.2-9) into (2.2-7), two equations are obtained by splitting the real part and imaginary part:

Re:

IF,,/| xcos (0)xTs = VJZxTaXcos (0) + VJ VJ3 xcos (n/6) xT* + E/3 xcos (n/3) xTc
( 2 .2 - 10)

Im:

IVref \ xsin {9)xTs = VJ3xTaXs\n (0) + 43 VJ3 xsln (n/6) xTh + E//3xsin (n/3) xT/. (2 .2- 11)

These two equations are the same as:
xcos (^XT; =E/3xz; 4- E/2 XT* 4- E/6x71., and ( 2 .2 - 12)

IVref \ xsin (Ã)x Ts = 43 E/6 xTh + Vs E/6 xj;.

(2.2-13)

From Eqs. (2.2-8), (2.2-12) and (2.2-13), the dwell time of selected space vectors can be solved below Ta = TsX [1- 2 V3 \Vref\ / Vd X Slu {$)], 76 = 7], X [2 Vs |Ã;^| / Ey X sin (n/34-6!) - 1], 7:; = 7:, X [1- 2 Vs |Ã ^ | / Ey X sin (n/3-6)]. (2.2-14)

b) Dwell Time Calculation in Other Regions Following the same procedures as shown above, the equations for dwell time caleulations in other regions are derived. In region 1, they are:

28

'

Z ;= 7 :,x 2 V 3 |K Â« ^ |/P ^ x sin (:i/3 -6 0 Tb = Ts X [1- 2 -s/3 IFre/I / Frf X sin (n/3 + 9)] Tc = T; X 2 -n/3 IF;^/1 / Frf X sin ( 6D
(2.2-15)

For region 3, the dwell times are: Tfl = Ts X [2 - 2 V3 \Vref\ / VdX sin {%l3+$)] Tb=TsX
2

V3 \ Vref\ / VdX sin((9) 1/ F^x sin iiil2-9) - 1]

(2.2-16)

Fc = Fj X [2 -\/3 1

When the reference vector is in region 4, we have: C 7:,= 7 ; x [ 2 V 3 | F ^ | / p ; / x s i n ( 6 0 - l ] Tf, = T, X 2 V3 I / F:, X sin (jr/3-6) (2.2-17)

Tc=TsX~ [2 - 2 -v/3 IF^/l I VdX sin (ti/3+0]

2.2.4 Switching Sequence Design With the proper space vector selected and their dwell time calculated, the switching state sequence of the space vector modulation for the three-level NPC inverter needs to be designed. Generally, two design criteria have to be met during the switching sequence design in order to achieve the minimum device switching frequency. 1. The transition from one switching state to the next should involve only two switches, one being turned off and the other being turned on; and 2. The transition from one triangular region to the next should involve minimum number o f switching. a) Seven-Segment Scheme As a commonly used SVM teclmique, seven-segment scheme meets these criteria. In the seven-segment scheme, the nearest three space vectors are used in the seven segments of

29

each sampling period to approximant

Vre/.

Among these three space vectors, there is at least

one small vector, whose two redundant switching states both are used. In region 3 and region 4, there is only one small vector available. It would be the only choice. In region 1 and region 2, there are two small vectors. The small vector with longer dwell time is called the dominant small vector, whose two redundant switching states both are applied. However, only one switching state corresponding to the other small vector is chosen to meet the design criteria. The sub-regions a and b o f regions 1 and 2 are used to select the dominant small vector. The small vector on the vertex o f the sub-region is the dominant small vector. For example, in sub-region I-la, switching states [POO] and [ONN], both corresponding to dominant small vector
V/,

are used with [OON], which is one of the redundant switching states of the

non-dominant small vector FÃ¿. Attentions have to be paid to the arrangement o f switching state sequence to meet the design criteria. Table 2-4 gives an example of switching state sequences in I-la. It can be seen that there is only one phase changing the switching state during each transition. The per-phase switching state change is between [O] and [P] or between [O] and [N], which involves two switching devices, one is turning on, another is turning off. Therefore, the first criterion is met. Based on this switching state sequence, the SVM during a sampling period in I-la is illustrated in Fig.2.7

30

Table 2-4 Seven segments in sub-region I-la I-la Segment Space vector & switching state P;,,
2

Time interval

[ONN] [OON]
7 /2 r /2 T/2 7 /2 7 /2 7/^^

"d rd th

3

Fo F /f Fo

[0 0 0 ] [POO] [OOO]

4

5*

6*^
?th

F;jv [OON] Fy^ [ONN]

Sampling period f . Segmenti
2

n d

3 rd

4

th

i
1

5'*'

1

6

`h

1
1
1

7"'
_
1

[ONN] I [OON] ! [0 0 0 ]

Fm

[POO]

Ta/ 2 V tp

_ 1_

i

Tc/2

1 Fo 1 [0 0 0 ]

I VlN

Fw 1 [OON] 1 [ONN]

%O ''
0

V bo VcÃ  
l-E

I -E

Fig. 2.7 Space vector modulation in I-la.

31

.9K

b) Two Patterns of Switching State Sequence Seven-segment scheme has two patterns for switching state sequence in each region or sub-region. Pattern I and II, of which both can meet the first design criterion. But the switching state sequences based on these two patterns are different. For example, in the sub-region I-la, illustrated in Table 2-5, the first four switching states of Pattern I in I-la are [ONN], [OON], [ 0 0 0 ] and [POO]. In the a-|3 frame, the direction of their sequence is counter clockwise. On the contrary, this direction of the first four switching states in Patter II is clockwise. Fig. 2.8 shows the difference between the sequence directions of the two patterns. c) Switching Pattern Design for the Entire Space Vector Diagram In order to meet the second design criterion, the switching patterns of the NPC inverter in the conjunctive areas should be detemiined based on the pattern selection of a region or sub-region. For example, when Pattern I is used in I-la, it can be seen from Table 2-5 that the last switching state of Pattern I in I-la is [ONN]. On the other hand, [OON] is the first switching state of the Pattern I in I-lb, while [PPO] is the first state of Pattern II in the same area. Obviously, Pattern I in I-lb should be chosen since, from [ONN] to [OON], there is only one phase changing switching state during the transition from I-la to I-lb. Similarly, the pattern in I-2a can be easily determined because the reference vector may turn form I-la into I-2a. Based on these rules, the patterns of all the regions or sub-regions in the entire diagram could be determined one by one. Fig. 2.9 illustrates the directions of the entire space diagram after Pattern I is selected in I-la. The switching pattern design of entire space diagram is given in Appendix I.

32

Table 2-5 Two patterns of switching state sequence in I-la Segment ist
2

Pattern I V IN [ONN]

Pattern II

[POO] Po [0 0 0 ] [OON] P/Af [ONN] P;Af [OON]
Po P /f

nd rd th Vo V IP Vo

[OON]
[0
0 0

3

]

4

[POO]

S*"
6

[0 0 0 ]

* "

V on [OON]

[OOO] [POO]

fjih

[ONN]

t0
Pattern I : Counter C lockw ise Pattern II : Clockwise

Fig. 2.8 Directions of switching sequence in I-la based on the two patterns.

33

Van

Sector II

Sector III / \ / 0 0 \ / \S e c to r I

0 /\0

Sector IV

0*

/S e c to r V I

Sector
Fig. 2,9 Directions of the switching sequence for pattern I.

34

2.2.5 Neutral Point Potential Control As a common problem of NPC inverters, the neutral point potential deviation may occur when a three-level NPC inverter uses a single DC voltage source. It causes unbalanced voltage stress on the switching devices and also introduces some undesirable harmonics to the phase output voltages. However, seven-segment scheme can mitigate this problem by using closed-loop control. a) Neutral Point Potential Deviation There are some reasons for the deviation of the neutral point potential, such as imbalances in DC capacitors or discharge resisters, dead time implementation and elimination of minimum pulse of the gating signals. Some switching states also cause the neutral point potential deviations because of the neutral point current io, which changes the charges and the voltages of the DC capacitors. Fig. 2.10 shows the simplified circuits and the current directions caused by the redundant switching states o f Fy. It can be seen that the directions of neutral point currents could be opposite with the same load. These redundant switching states have opposite influences to the neutral point potential. Note that each pair of other redundant switching states has opposite impacts as well. b) Closed-loop Control of Neutral Point Potential Since each pair of the redundant switching states of the three-level NPC inverter impact the neutral point potential oppositely, they can be used for the neutral point potential control by shifting a part o f the duty time between the pair of the redundant switching states.

35

( a ) [P O O ] w ith load in m o to r in g m o d e

(b) [C N N ] w ith lo ad in m o to r in g m o d e

( c ) [P O O ] w ith load in re g e n e ra tin g m o d e

(d) [C N N ] w ith load in re g e n e ra tin g m ode

Fig. 2.10 Neutral point potential deviation under redundant switching states of V /.

36

For the purpose of the neutral point potential control, At is defined as the percentage of the time intervals of the first and the seventh segments that would be shifted to the forth segment: r/ =
X

(1 - At)
(1

tj' = /? X (1 - At) = r, X

- At)

(2.2-18)

t / = t4+1, X At + t? x Att4+ t, X At X 2 where t/, t4 and r? are the time intervals of 1 Â® `, 4*'' and 7^ segments before the adjustment, / / , r / and r / are those after the adjustment. Since one of the redundant switching states is used in the first and the last segments, the other is assigned to the forth segment, the adjustment of their time intervals does not change the total dwell time of the small vector corresponding to these redundant switching states; ti ' + r /
+ =

/; X (1 - At) +

X

(1 - At) + t4-t- t] X At X 2 (2.2-19)

= ti +t4 + tj

It should be noted that the direction of this time interval adjustment, represented by the sign of At, is determined by two factors: 1) the pattern of the seven-segment scheme, in which the redundant switching states exchange their segments; influence of the same switching state could be reversed. Based on the above discussions, a scheme of the neutral point potential closed-loop control is designed as shown in Fig. 2.11, in which the At is obtained based on the difference between the two capacitor voltages.
2

) the mode o f load, in which the

37

Voltage senser

Three-level NPC inverter
Voltage

load

Cz

senser

Vcl
^

Gating signals

c o n tro lle r

sv
modulator

Fig. 2.11 Closed-loop control of neutral point potential.

38

2.3 Summary
The principle o f the space vector modulation for the three-level neutral point clamped inverter was introduced in this chapter. The power circuit and the switching states of the three-level NPC inverter were described. The space vectors of the three-phase three-level NPC inverter were presented. The space vector selection method was introduced and the dwell time calculation equations were derived. Based on the requirement of minimizing the device switching frequency, the switching state sequence of the inverter was developed. A neutral point potential closed-loop control system was designed by utilizing redundant switching states.

39

Chapter 3 Simulations and Harmonic Analysis
Featuring time-saving, low-cost and risk-free, simulation process becomes an important tool in developing and designing a power electronics system. Established in the

MATLAB/Simulink platform, the simulation study of the space vector modulation (SVM) scheme for the three-phase three-level neutral point clamped (NPC) inverters is presented in this chapter. The power circuit and the SVM scheme of the inverter are modeled. The harmonic and THD profiles of the output voltages of the NPC inverter are investigated. Furthermore, the closed-loop neutral point potential control algorithm presented in the previous chapter is verified.

3.1 Modeling of Simulations
The simulation modeling o f the SVM scheme for the three-phase three-level NPC inverter includes two steps, the function block design and the controller S-function programming. 3.1.1 Function Blocks

Built up from the basic units included in the Simulink libraries, the function blocks form the simulation model of the SVM three-level NPC inverter are shown in Fig. 3.1, where five sub-systems including power supply, three-level NPC inverter, load, reference generator and gating signals generator are illustrated.

40

Positive Bus Power

1 Inverter neutral point
Negative Bus

3-Level NPC Inverter

3-Phase RL Load Load Neutral Point

-- Reference  Vector -- Generator

>

Gating Signai Generator 

n
bating
Signals

Fig. 3.1 Simulation model o f space vector modulated Three-level NPC Inverter.

CDPositive Bus
AI

Ã2

CD--
Inverter Neutral Point

CD
A6 A3

A4

A4

Negative Bus

CD--
Gating Signals Fig. 3.2 Configuration of phase A in Three-level NPC Inverter sub-system.

CD----

41

a) Power Supply To investigate the ideal performance of the mverter, two identical DC voltage sources are connected in series in the block Power Supply. b) Three-level Neutral Point Clamped Inverter According to the power circuit introduced in previous chapter, a three-phase three-level NPC inverter is designed in the block 3-Level NPC Inverter in Fig. 3.1. The configuration of one of the three identical legs in the inverter is shown in Fig. 3.2. c) Load The block 3-Phase RL Load in Fig. 3.1 contains a balanced three-phase RL load, in which the values of the resistances and inductions can be preset. d) Reference Vector Generator The reference vector, output of the block Reference Vector Generator, is generated based on the settings of the amplitude modulation index rua and the fundamental frequency f :
K^/=IW e^, (3.1-1)

where IFre/I is the length of F^/ and y is the phase angle of

iVre/j= - J S x m a X V d

/ 3,

(3.1-2)

y = 2 K x f j X t.

(3.1-3)

42

e) Gating Signal Generator Based on the magnitude and the phase angle of the reference vector produced by the block Reference Vector Generator, the gating signals to the inverter in Fig. 3.1 are generated by the block Gating Signal Generator, of which the details are illustrated in Fig. 3.3, where a S-function block, introduced later, is applied. 3.1.2 S-function Programming According to the SVM scheme introduced in Chapter 2, the S-function block in the Gating Signal Generator is coded based on the programming flowchart shown in Fig. 3.4. The program of the S-function block can be loaded by the simulation systems or the timer preset by the sampling period. At the beginning of each sampling interval, the space vector selection and dwell time calculation are processed based on the values of the reference vector at the middle-point of the sampling interval. In the simulation, the gating signals of the inverter are generated based on the switching states, which are obtained from the pre-designed look up tables according to the segment and sector numbers. Only the end o f the simulation can stop the gating program.

3.2 Waveforms and Harmonic Analysis
In the following simulations, the parameters of the power supply and the load are given by: Rated output power rating: RL loads (each phase): IMAV R=17.3Q (1.1033 pu.)
L==2.3mH (0.0553 pu.)

DC input voltage rating (total):

5600V

43

Magnitude o -- 
ref

c
Phase ancle

S-fiinction Program S-fiinction block

KID

Gating Signals

Fig. 3.3 Gating signal generator sub-system.

Initial

Begining of
Yes

?

Input:

Dwell time calculation and space vector selection

Gating signal generation Output: gating signals

Pre-designed lookup table

Fig. 3.4 Flowchart of S-function program.

44

Different parameters o f the amplitude modulation index

ma,

fondamental frequency / / and

sampling frequency fsa, are simulated to investigate the performances under different operating conditions. Note that the frequency modulation index
m f= fsa

/ f i is set as an integer

in following simulations, i.e. the so-called synclironous sampling method, in which the number o f sampling intervals in each fundamental period is always an integer, is applied in this thesis. 3.2.1 Simulated Waveforms Following simulation parameters are preset: Modulation index: Fundamental frequency: Sampling frequency:
m a= O .S , fi-6 0 H z,

and

/sa=1440Hz.

The frequency modulation index m / = f s a / f i is 24, and the inverter switching frequency ^

is

^a/2=720Hz. Fig. 3.5 shows the simulation results, which include gating signals, inverter output phase voltages
vao

and

vbo ,

the inverter line-to-line voltage

vab,

the voltage between

the neutral point of the balanced three-phase load and that of the inverter v,,o, the load phase voltage VAn, and the output current /^. Especially, since the operations of the 3"" and the 4*'' switching devices are complementary with those of the and the 2 "`^devices in the same leg,

respectively, the gating signals of E* and 2"** devices of all the legs are shown in Fig. 3.5(a). The inverter output phase voltages and line-to-line voltage are shown in Fig. 3.5(b), in which the phase voltages
vao

and

vbo

have three levels, and the line-to-line voltage

vab

has five

levels. In Fig. 3.5(c), it can be noticed that the voltage of the neutral point difference v,,o has five levels, while the load phase voltage
va,, has

nine levels. Due to the filter effect of the RL

load, the waveforms of /^, shown in Fig. 3.5(d), looks closer to a sinusoidal wave than that of the load phase voltage v^,,.

45

Lm rni m UM F!
'g,a/

m iM m E

mm n
0.005
0 .0 ]

urnTM

m

mm
0.015 0.02 0.025 0.03 0.035

t(s)

(a) Gating signals v.,(V )
6000

-6000 t _ 6000

F"

-6000 6000 F"

-6000
0

0.005

0.01

0.015

0.02

0.025

0.03

0.035

(b)

vao, vbo and vab

Fig. 3.5 Simulated waveforms (to be continued)

46

6000 F

-6000 t _

(V)

Ã¿AAVwvVW%v#V^^
-6000

v ,.(V )
6000

-6000
0

t(s)
0.005

0.01

0.015

0.02

0.025

0.03

0.035

(c) //A )
200
150

vao,

Vno and va,,

100
50

0

-50 -100 -150

-200
0

0.005

0.01

0.015

0.02

0.025

0.03

0.035

{Ã )ÃA Fig. 3.5 Simulated waveforms (continued).

47

3.2.2 Harmonie Analysis The harmonic components of the line-to-line voltage Fourier transformation function offered by MATLAB. a) Fundamental Component and THD The waveform o f the line-to-line voltage
vab,

are analyzed based on the fast

simulated in section 3.2.1, and its spectrum are

shown in Fig. 3.6. Similarly, simulations and the harmonic analyses for different amplitude index triaS are processed to obtain the relationship between tria and the total harmonic distortion (THD). The simulation waveforms and the harmonic spectrums are shown in Fig. 3.6 to Fig. 3.9. The simulation conditions, rms values of the hmdamental component VAsi.rms of the inverter line-to-line voltages and the THDs are listed in Table 3-1. The line-to-line voltages have only three levels with less than 0.5 w^s, for example Wa=0.4 and Wa=0.2. Because only zero vectors and small vectors are used to approximate the reference vector when the reference vector is rotating only in the inner regions, the line-to-line voltages of the inverter looks as those of a traditional two-level inverter in tliese cases. Table 3-1 Harmonic analyses under different amplitude modulation index ma Figure ma )}(Hz) (Hz)
Va BI ,rm s (V )

Fig. 3.6
0 .8

Fig. 3.7 0.6 60 1440 2368.4 45.72%

Fig. 3.8 0.4 60 1440 1583.2 77.82%

Fig. 3.9
0 .2

60 1440 3162.2 38.93%

60 1440 788.1 148.9%

THD

48

6000 F

i
-6000 0
^AB,rms

^S)
0.005 (^ ) TWO = 38.93% 0.01 0.015 0.02 0.025 0.03 0.035

3000

2000
1000
0

10 "

22

Â»
I - j I

20

"
I I L.

i
-I 60 I I I I I I t 180 300 420 540 660 780 900

I 

, i
J

/(H z )

1020 1140 1260 1380 1500 1620 1740

Fig. 3.6 Waveform and spectrum of vab (Wa=0.8,//=60Hz,^a=1440Hz)

^xa(V)
6000

-6000 0.005 0.01 0.015

0.02

0.025

0.03

0.035

3000 2000
1000

THD = 45.72%

22 "

60

180

300

420

540

660

780

900

1020 1140 1260

1380

1500 1620 1740

Fig. 3.7 Waveform and spectrum o f v a b (Â«7a=0.6,//=60Hz,7Ã¯a=1440Hz).

49

6000 F

-6000 0 0.005 0.01 0.015 0.02 0.025 0.03 0.035

^AB.rms (V)
3000 T//D = 77.82%

2000
1000
0

14h i
60 180 300 420 540 660 780

16

"

20

"

i

i

28" i
I

/(H z)
900 1020 1140 1260 1380 1500 1620 1740

Fig. 3.8 Waveform and spectrum of vab (/Wa=0.4,//=60Hz,7^a=1440Hz).

6000

-6000
0

0.005

0.01

0.015

0.02

/(s )
0.025 0.03 0.035

A B .rm s

3000

THD = 148.9%

2000
1000
20

"

60

180

300

420

540

660

780

900

1020 1140 1260 1380 1500 1620 1740

Fig. 3.9 Waveform and spectrum o f v a b (77to=0.2,//=60Hz,^a=1440Hz).

50

^ A B I .r m s

4000
3500

3000
2500

2000
1500 Ax

= 0.7

1000
500

ni
0.2

0.4

0.6

Fig. 3.10 Linear relationship between

V a b i ,r m

and

m a-

51

Table 3-1 shows the THD is higher when the amplitude modulation index nta is smaller. Based on the values in Table 3-1, a linear relationship between Fig. 3.10, and given as:
Kra/. rm s = 0.707 x (3 2-1)
V a b i , rm s

and m a is illustrated in

Furthermore, the inverter line-to-line voltages in above simulations contain some even order harmonics, which are noted in Fig. 3.6 to Fig. 3.9. b) Even Order Harmonics In order to illustrate the even order harmonics in the low frequency band more clearly, cases of the three-level NPC inverter working under a lower sampling frequency (720Hz) are simulated. The waveforms and the spectrums of the inverter line-to-line voltages aie shown in Fig. 3.11 and Fig. 3.12, in which the fundamental frequencies are 60Hz and 30 Hz, respectively. The even order harmonics are particulaidy noted in these two figures.

3.3 Harmonic and THD Profiles
Sweeping the amplitude modulation index nia from 0 to 1, with fixed frequency modulation index m/, the harmonic and THD profiles of the three-level NPC inverter can be obtained. Three groups of profiles are acquired based on different values of /Â«/: 1) m /= 24 {fsa = 1440Hz and f = 60Hz); 2) mj= 18 ( / ,, = 1080Hz and / / = 60Hz); and 3) mf= 12 ( / Â« = 720Hz and/ = 60Hz). The sextuple nifS are used herein is to ensure the even distribution of the sampling period in the six sectors, i.e. each of the six sectors contains the same number of the sampling periods. The harmonic analyses of above three nifS reveal that the line-to-line voltages have both even order and odd order harmonics. The hannonic and the THD profiles are shown in Fig. 3.13 to Fig. 3.18. In the harmonic profiles, those beyond 20`'' order harmonics are not included because they can be easily filtered by a small filter in practice.

52

6000

-6000 0.005
0.01

0.015

0.02

0.025

0.03

0.035

3000 2000
1000

7WD = 42.76%

20'

Fig. 3.11 Waveform and spectrum of vab (ma=0.8,/i=60Hz,_/Ã®a=720Hz).

6000

0.01

0.02

0.03

0.04

0.05

0.06

0.07

^' AB.rms (V)
3000 7770 = 39.01%

2000
1000

60

180

300

420

540

660

780

900

1020 1140 1260 1380 1500 1620 1740'

Fig. 3.12 Waveform and spectrum o f v a b (/M a=0.8,//=30Hz,^ =720Hz).

53

V

AB,n

/

V

ABJjnax

0.05 0.04 0.03

0.02 0.01
O.I 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9

(a) Even order harmonic profile

^AB.n '

^AB,l,max

0.05

0.04
0.03

.F
r

--

____ 1 St

igU ,

7

0.02
0.01
0

12

th

j

'h

13 Ih

^1 1


i

X

k

L

0

0.1

0.2

0.3
(b)

0.4

0.5

0.6

0.7

0.8

0.9

Odd order harmonic profile

Fig. 3.14 Harmonic profile (/}=60Hz,7 ^ = 1440Hz). THD 300%
250%

200%
150% 100% 50%
0

%

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

Fig. 3.15 THD profile (//=60Hz,^a-1440Hz).

54

^ A B . n ^ ^ A B .l.m a x

0.08 0.06 0.04
0.02
;ih jQ ii 14th ](th 2 0*

m 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9
(a) Even order harmonic profile
V

AB.n

/

V

ABJjnax

0.08 0.06 0.04 0.02 m. 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9
(b) Odd order harmonic profile

__ _

19" 17"' 13

Fig. 3.16 Harmonic profile (//=60Hz,jÃa=l080Hz). THD 300% 250% 200% 150%
100%

50%
0

%

m
0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

Fig. 3.17 THD profile (/}= 60H z,^ -1080H z).

55

^ A B .n ^ ^ A B .l.m a x

0.2

0.16 0.12 0.08 0.04 m 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9
(a) Even order harmonic profile

0.2
0.16 0.12 0.08 0.04 m 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9
(b) Odd order harmonic profile

I"

Fig. 3.18 Harmonic profile (/y= 60H z,= 720H z). THD 300% 250%
200%

150%
100%

50%
0

%

m 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 Fig. 3.19 THD profile (/}=60H z,^ =720Hz).

56

From the harmonic profiles of each case, the even order harmonics are obvious and much larger than close-by odd order ones. For example, in Fig. 3.14, when Wa=0.8, the 16^'' order harmonic, about 0.016 of the maximum of the fundamental component is much

larger than those of the 17*'^ and the 19^'' odd order harmonics. The reasons of this phenomenon on even order harmonics is discussed in Chapter 4, in which a new space vector modulation scheme for solving this problem is developed as well. The THD profiles show that THD of the inverter line-to-line voltage will be decreased when Ma is increased. The comparison among these THD profiles shows that THD value is slightly higher with smaller mj, which is coincident with the theory.

3.4 Neutral Point Potential Control
As mentioned in Chapter 2, the neutral point potential may deviate when a single DC voltage source is applied as the power supply with two DC capacitors. To solve this problem, a closed-loop neutral point potential control scheme is proposed in Fig. 2.13. In order to realize the control, the PID parameters should be properly tuned. However, since the FID tuning technique is not the main focus herein, the simulations in this section are just designed to demonstrate that the neutral point potential deviation can be corrected according to the mathematical derivations in Section 2.2.5. Therefore, only proportional control is used, and a ti'ial-and-error method is applied to pick up the P parameter. In the simulations, when a large value of P is selected, a voltage oscillation on the DC capacitor occurs; when P is around
0.004, the amplitude of the oscillation becomes stable. In the following simulations, 0.0015

is selected to reduce the amplitude of the oscillation.

57

voltage (V)

30ÃÃ

2900

2800

2700

2600 Fig. 3.20 Closed-loop controlled capacitor voltages with same DC capacitors.

voltage (V) 3000

2900

2800

2700

2600

0

0.005

0.01

0.015

0.02 0.025

0.03 0.035

0.04 0.045

0.05

Fig. 3.21 Closed-loop controlled capacitor voltages with different DC capacitors.

58

As shown in Fig. 3.20 and Fig. 3.21, two conditions of the closed-loop neutral point potential control are simulated: 1) using two identical DC capacitors, 2400pF x 2; and 2) applying two different DC capacitances, 2280pF and 2520 pF, 95% and 105% of 2400pF, where /na=0.8, //=60Hz, and 1440Hz in both cases. From the simulation waveforms, it can be noticed

that the DC capacitor voltages converge quickly at 2800V. Therefore, the closed-loop control scheme proposed to correct the neutral point potential deviation is practical.

3.5 Summary
In this chapter, the space vector modulation three-phase tliree-level NPC inverter was simulated and analyzed on the MATLAB platform. The Simulink models for the space vector modulated NPC inverter were developed. The harmonic components in the inverter output voltage waveforms were analyzed. It was revealed by the investigation that the conventional space vector modulation produces both odd and even order harmonics in the inverter output voltages. The effectiveness of the neutral point potential control was verified as well.

59

Chapter 4 Even Order Harmonic Elimination
The harmonic analysis in previous chapter shows that the output voltages of the three-level space vector modulated NPC inverter contain even order harmonics, which is not desired in industrial applications. In this chapter, the generation mechanism of even order harmonics is analyzed and a new SVM algorithm is proposed to solve the problem. Simulation models of the new algorithm are developed, and the hannonic analysis is conducted, which shows that the new scheme is able to eliminate all the even order harmonics. In addition, the closed-loop control of neutral point potential in the new SVM scheme is verified.

4.1 Mechanism of Even Order Harmonic Generation
This section focuses on the mechanism of even order harmonic generation. 4.1.1 Half-wave Symmetry Any periodic waveforms can be expressed by a Fourier series [13] as: f(t) = ao! 2 + 1 L [a,, cos {n coi t) where n=l to co, ai = 2% !T ,T is tire period oÃ®f(t). b,, sin {n 0)i r)] (4.1-1)

60

a,, = 2/T

[ /(/)co s(o (y |0

M=0,l,2,3,... and

b,,^2/T

[ /(?)sin(/ 7 Ã») , 0

^dt,

/r= 1,2,3,...

Eq. (4.1-1) can also be rewritten as:
f(t) = co +'Lc,,cos{noe^t - y,,)

(4.1-2)

where

c,,= ^a l +bl '

y,, = ta n '(6 Â» / a,,). In order to ensure f(t) has no even order hannonic, the amplitude of the even order harmonics c,, ( / 7 = 2 ,4 , 6 , 8 ...) must be zero, where:

a,, = 2/T

[ f { t ) cos{na>d)

](/t= 0, where n = 2,4, 6 , 8 ...

(4.1-3)

and:

b,, = 2/T

I _ [ / (t) sin(Mm,t)

]dt = 0, where

= 2, 4, 6 , 8 ...

(4.1 -4)

Eqs. (4.1-3) and (4.1-4) can be fulfilled only if:

(4 1- 5)

or in the phase angle format of Eq. (4.1-5):
f(r)= -f(r+ ^)

(4.1-6)

From Eqs. (4.1-5) and (4.1-6), it is clear that a function contains no even order harmonic only if its waveform is half-wave symmetrical.

61

4.1.2 Even Order Harmonics Generation As shown in Chapter 3, the voltage waveforms of the traditional SVM scheme are not half-wave symmetrical so that they can not meet Eq. (4.1-5) or (4.1-6). According to the discussion of 4.1.1, these voltages contain even order harmonics. In order to present the mechanism of the even order harmonic generation clearly, two sampling periods o f tire traditional SVM algorithm are picked for examples. As shown in Fig. 4.1(a), the reference vector is located respectively in I-lb and IV-lb, in which the fundamental components o f the output voltages are out of phase, i.e., JTxg -b ;r 04.1-7) in these two circumstances can be given as

The waveforms o f line-to-line voltage

shown in Fig. 4.1 (b) and (c), respectively. According to Section 4.1.1, the voltage waveforms in these two sampling periods supposed to meet the requirement of Eqs. (4.1-5) and (4.1-6) such that Vab has no even order harmonics. However, in the 2"^, 3"", 5*' ' and 6 "' segments, the voltage waveforms do not fiilfill the requirement of the half-wave symmetry, which is presented by Eqs. (4.1-5) and (4.1-6). This implies that the even order harmonics in the output voltage are introduced by the traditional SVM scheme. The same problem occurs to the inverter output voltages in other regions. For example, assuming the amplitude modulation index nia is 0.4 and the frequency modulation index nif is
1 2

, thus in each fundamental cycle there are

1 2

sampling periods, each of which presents

a reference vector in an imier sub-region shown in Fig. 4.1(a). Consequently, the waveforms o f the phase voltage Vao and the line-to-line voltage Vat can be obtained as shown in Fig. 4.2, in which both of them are not half-wave symmetrical so that they both have even order harmonics.

62

Il-lb III-la

II-la

I-Ib

111-lb

1-la

IV -la

VI-Ib

/V i

lV-1

V l-la V -la V -lb

(a)

V

r c f in I-1a and IV-la
Sampling period T

Segment
Switching State

I 3'"
I I I

4 lit [PPO]

; th

6

th

Vi p

[0 0 0 ]! [P 0 0 ]
I I I I

IF o
[P 0 0 ] |[ 0 0 0 ]

E

(b )I-lb Sampling period T 4 th
Vsp

Segment SV
Switching State

1

st

I _ I Vo F.W I [N N 0 ]j[N 0 0 ]j[0 0 0 ]
I
\V
ab

[OOP]

I

!

I

[ 0 0 0 ] ] [ N 0 0 1[NN0]

-E

(c)

IV-lb

Fig. 4.1 Space vector modulation and waveforms of vab in I-lb and IV-lb.

63

O n e C y c le H alf Cycle

-M

!< * I I R e g b n j V -la | V -lb

Ã

V l-la

V l-lb

I-la

I-lb

n -la

11-lb

m-la

ra-ib

rv-ia I

IV-lb

V -la

V -lb

1
T'TI

.J

L .^ .J

-E

Â« i

n
-E

Â±--
0

I..
71/6

.L
77/2

!..
--I
277/3 371/2

I 1 --
577/3

L.
277

-r^

Â·J r

Fig. 4.2 Waveforms o f Vjo and vab generated by traditional scheme (wa=0.4, m/=12).

64

On the other hand, the analysis o f the space vector in the a - p frame can also find out the mechanism of the even order harmonic generation in the inverter outputs. The on-duty space vectors in the corresponding segments of the out-of-phase sampling periods sometimes are not symmetrical to each other with the original point. For instance, as shown in Fig. 4.1, the vector V ^ (in the 2nd segment of I-lb) and the vector V (in the 2nd segment of V-lb),

located in the corresponding segments of two out-of-phase sampling periods, are not symmetrical to each other with the original point. Therefore, their components on the voltage axes don't have same amplitudes and opposite directions. Consequently, the output voltage waveforms are not half-wave symmetrical, resulting in even order harmonics n the inverter output voltages. However, from Fig. 4.1, it can be noticed that each on-duty space vector has a symmetrical vector used in the out-of-phase sampling periods, although not all of them appear in the corresponding segments. As shown in Fig. 4.1(b) and Fig. 4.1(c), for example, 1. ^
2

in the

and the 7*'' segments of I-lb is symmetrical to

5

in the F' and the 7 ^'*

segments of IV-lb; -Â· ^
1

in the 3 " ^ * ^ and the 5*'' segments of I-lb is symmetrieal to ^

4

in the 2"** and the 6 *

segments of IV-lb; and 3- F Qin the 2"^ and the 6 * '' segments of I-lb is symmetrical to segments o f IV-lb. As a conclusion, the even order harmonics in the output voltages are naturally caused by the switching sequence of the traditional seven-segment SVM scheme. in the 3'^`*and the 5"'

^ 0

65

4.2 New Space Vector Modulation Algorithm
As concluded in previous section, the even order harmonics exist in the inverter output voltages because the switching sequence of the traditional seven-segment SVM scheme can not produce half-wave symmetrical waveforms. However, it is also noticed that each on-duty space vector has a symmetrical vector used in the out-of-phase sampling periods. Hence, it is possible to produce a half-wave symmetrical waveform by rearranging the switching sequence. In Fig. 4.1(c), by switching the 2"^ and 3'^'*, and the 5'*' and 6 `* ' segments in IV-lb, respectively, a new sequence is obtained as shown in Table 4-1, in which the switching sequence in I-lb is also included for comparison. Apparently, the two
vab

waveforms of I-lb and IV-lb in Fig.

4.3 are half-wave symmetrical and meet the requirement of Eqs. (4.1-5) and (4.1-6). Therefore, the problem of even order harmonic in these two sub-regions has been solved. Similarly, the switching sequences are reaiTanged in all of the shaded areas as shown in Fig. 4.4. Accordingly, the switching pattern design of the new scheme is attached in Appendix II. The waveforms o f
vao

and

vab

in Fig. 4.2 can be improved as shown in Fig. 4.5, in which

both of them are quarter-wave symmetrical: = or in the phase angle format: (4.1-9) Eqs. (4.1-8) and (4.1-9) also meet the requirements of half-wave symmetry. Therefore, there is no even order harmonics in the waveforms of vao and v a b (4.1-8)

66

Table 4-1 New switching sequence in I-lb and IV-lb. Segment nd Mb [OON]
2

IV-lb F jf Fp F^y^ Fj/y F^;v Fp F^f [OOP] [OOO] [NOO] [NNO] [NOO] [OOO] [OOP]

Fo F /?

[0

0

0

]

gtd
4

[POO]

th

F^fEPPO] Fyf [POO]

S'" '" yth
6

Fp [ooo]
F;vv [OON]

S am p lin g period Segm ent SV Switching State
1

st

nd
Vo

V2N

I 3"Â» I I
I

4 til
V2I`

; th

I 6 th

Vn

[OON] [ 0 0 0 ] j [POO]
V
ab

[PPO]

I Fo [ P 0 0 ] l[ 0 0 0 ] [OON]

(a) space vector modulation in I-lb
k i -- ---------------Segment SV
Switching State 1 st

Sampling period T
3 rd 4 th 5 "'

---------------------- D>

1 2 nd

Fdf

i

If,/

V n

6 *

! 7 `h
i Fjp

pb

[OOP] 1 [OOO ]| [NOO 1
i ^V ab

[NNO]

[ N 0 0 ] j [ 0 0 0 ] | [OOP]

!
1 1 1 1 1

n U

t
(b) space vector modulation in IV-lb

-

1

Fig. 4.3 Space vector modulation and waveforms of vab in 1-1 b and IV-lb.

67

V g,, Sector II

B C

Sector III

0

\

Sector I

{ 1 6

An

\C A^ Sector I

f

AR

Sector VI

Cn

Sector V

Fig. 4.4 Switching sequence directions of new scheme.

O ne Cycle

R egioni egion, V -la , V -lb

I

4-

H alf Cycle V l- la , V l-lb I-la I I-lb U-la U -lb

m-la ni-lb

IV -la

IV-lb

V -la

V -lb

^AoÃ¯\

r I
I I

 H

--------1

mi

Â·f ^' ab rtTfi

. 1.

f
0 71/6 71/2

4I
271/3

_r
n
vab

_ 1

1
371/2

1

--

. 1

531/3

i

271

------1 y r* "

Fig. 4.5 Waveforms o f v a o and

generated by new scheme (OTa=0.4, m/=12).

68

The proposed new seven-segment SVM scheme contains the same switching states in each sampling period, including the redundant switching states, as those of the traditional SVM algorithm. Only the switching sequence is reairanged to fulfill the half-wave symmetry of the waveforms so as to eliminate the even order harmonics of the inverter output voltages. Hence, the closed-loop neutral point potential control can also be applied to the new scheme. A special attention should be paid to the sign of At in the shaded areas shown in Fig.4.4 should be reversed since the redundant switching states exchange their segments. It should be noted that there is a slight increase of the average device switching frequency in the new scheme. The increase is one half of the fundamental frequency. The proposed new SVM scheme can also be applied to any other types of multilevel converters for even order harmonic elimination.

4.3 Simulations of the New Algorithm
The proposed new SVM scheme is simulated in this section. In order to verify the elimination of the even order harmonics, the harmonic and THD profiles of the simulation results are presented. 4.3.1 New Space Vector Modulation Model The Siniulink block diagram of the new scheme is the same as that of the traditional scheme in Chapter 3, because the improvement of the scheme is located in modifying the switching sequence, which is coded in the S-fimction block shown in Fig. 3.3. Based on Fig. 4.4 and compared to the previous S-function program, the new one should:

69

1

) modify the pre-designed look-up table to get the new phase switching state; ) switch the time intervals of the corresponding segments in the shaded areas; and

2

3) reverse the sign of the Ã in the shaded areas. The modified program of the S-function block is attached in Appendix III. 4.3.2 Harmonic and THD Profiles In order to evaluate the performances of the new SVM scheme, the simulation waveforms and harmonic spectrums o f the are shown in Fig. 4.6 and Fig. 4.7, of which the

simulation conditions are the same as those of Fig. 3.11 (/Â«a=0.8,/7= 60H z,=720H z) and Fig. 3.12 (/na=0.8,//=30Hz,7^a=720Hz), respectively. The waveforms of the
vab

shown in Fig. 4.6 and Fig. 4.7 are half-wave symmetrical. The
vab

harmonic spectrums of the scheme.

show that only the odd order harmonics are left in the new

Similar to the simulations in Section 3.3, the harmonic and THD profiles under different simulation conditions o f the proposed new SVM scheme are acquired and shown in Fig. 4.8 to Fig. 4.13. Compared with the harmonic profiles of the traditional scheme, all even order harmonics in the new scheme are eliminated. However, the odd order harmonics are inereased at the same time. The THD profiles o f the output voltages in the new scheme have equivalent features to those o f the traditional scheme under the same operating conditions.

70

y 4 g (V )

6000

-6000 0.005
A B .rm s ( V )

0.01

0.015

0.02

0.025

0.03

0.035

3000

77/D = 42.73%

2000
1000

0
60 180 300

7 * i
420 540

{ 7 `h
'

jo *

13*

i l
660 780 900

I

I

I

:I

I /(H z)

1020 1140 1260 1380 1500 1620 1740

Fig. 4.6 Waveform and spectrum of vab (Wa=0.8,//=60Hz,^a=720Hz).

%4B(V)
6000

1
-6000

0.01
^'A B .rm s ( V )

0.02

0.03

0.04

0.05

0.06

3000

THD = 38.93%

2000
47* 49*

1000

11* 13*

17* 19*

23* 25*

29*

31*

33*

T

t /

53. Y

0
_J

n
1
I

II
L_

> I
660 780

1 i
900

I

1
1

11

1 -1 1
540

_ _ _ _ _ _ _ _ _ _ I_ _ _ _ _ I_ _ _ _ _ _ _ _ _ _ I_ _ _ _ _ i_ _ _ _ _ I-------- - ------- -------- _ ____ I------- -------- L _

1 1 1

\{ \
1

/(H z )

60

180

300

420

1020 1140 1260 1380 1500 1620 1740

Fig. 4.7 Waveform and spectrum of vab (ma=0.8 , /}= 3O H z,= 720H z).

71

^ A B ,n ^ ^A B .U m a x

0.05 0.04
|s t

0.03
gth ],,th ]4th ](,th 2 0 *

0.02
0.01
m

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

(a) Even order harmonic profile
^AB.n ^ ^AB.I.max

0.05 0.04 0.03

0.02
0.01
m

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

(b) Odd order harmonic profile

Fig. 4.8 Harmonic profile (/}=60Hz,7 ^= 1440Hz). THD 300%
250%

200%
--

150%
.

100% 50% 0% 0.1 0.2 0.3 0.4 0.5 0.6

of new S I:heme T H D of traditii mal schen le T H D

--

0.7

0.8

0.9

Fig. 4.9 THD profile (/}=60Hz,^o=1440Hz).

72

^ A B .n ^ ^ A B J .m a x

0.1 0.08 0.06 0.04

0.02

m .
0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9
(a) Even order harmonic profile
^AB.n ^ ^ABJ.max

0.08 0.06 0.04 0.02

' lh

0.3 0.4 0.5 0.6 0.7 0.8 (b) Odd order harmonic profile Fig. 4.10 Harmonic profile (/}=60Hz,^o= 1080Hz). THD 300% 250% 200%
--

0.2

0.9

m

150%
100 %

T H Lof new SIFeme T H D of traditii mal schen le
M l
0.7 0.8 0.9

50% 0% "0.1
0.2 0.3 0.4 0.5 0.6

Fig. 4.11 THD profile (/}= 60H z,^= 1080Hz).

73

^ A B ,n ^ ^ A B ,1 ,m ax

0.2
0.16
0.12

0.08 0.04 0.2
V / V

20 " '

0.3

0.4

0.5

0.6

0.7

0.8

0.9

(a) Even order harmonic profile
AB,n AB,Lmax

0.2

0.16
1.9"'

0.12

-

1"

0.08 0.04 m 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9
(b) Odd order harmonic profile

Fig. 4.12 Harmonic profile (/}=60Hz,^a=720Hz). THD 300% 250% 200% f \
-- ' of new s :heme T H L T H D o f traditic mal schen le

150%
-

100%

50%
0% 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8

-- ...

^

0.9

tn

Fig. 4.13 THD profile (/}=60Hz,^a=720Hz).

74

3000

2900

2800

2700

2600

Fig. 4.14 Voltages of same DC capacitors with neutral point potential control. voltage (V) 3000

2900
V' - ' V

cl

2800 / 2700 /%/ 2600 t(s) 0.05

0

0.005

0.01

0.015

0.02 0.025

0.03 0.035

0.04 0.045

Fig. 4.15 Voltages of different DC capacitors with neutral point potential control.

75

4.4 Neutral Point Potential Control
Similar to the traditional SVM scheme used in Section 3.4, the closed-loop neutral point potential control is applied to the proposed new SVM scheme. It is also simulated to verify the performance. The simulation parameters are kept the same as those in Section 3.4: ma = 0 .8 ,/;= 6 0 H z ,/a= 1440Hz and P - 0.015. Under the first condition similar to that of Fig. 3.20, the simulation model uses two identical DC capacitors with the capacitance of 2400pF. The voltages over the two DC capacitors are illustrated in Fig. 4.14, in which the neutral point potential is controlled. In the second case shown in Fig. 3.21, the capacitances of the two DC capacitors are 2280pF and 2520p,F, respectively. The voltage waveforms of two DC capacitors are shown in Fig. 4.15, where the neutral point potential is corrected as well.

4.5 Summary
In this chapter, the mechanism of the even order harmonie generation in the output voltages of the three-level NPC inverter modulated by the traditional SVM scheme was analyzed. A novel SVM scheme was proposed to eliminate those undesired harmonics. The effectiveness of the propose scheme was verified by simulations. The voltage THD profiles of the proposed scheme were investigated and the results were compared with those of the traditional scheme. Finally, the application of the closed-loop neutral point potential control in the new scheme was verified. The proposed SVM scheme can also be applied to any other types of multilevel converters for even order harmonic elimination.

76

Chapter 5 Conclusions
This thesis focuses on the space vector modulation (SVM) schemes with even order harmonic elimination for three-phase tliree-level neutral point clamped (NPC) inverters. The main contributions of this thesis are as follows; 1. The mechanism of the even order harmonic generation in the inverter output voltages is revealed. From the mathematical and simulation analyses, this thesis research has discovered that the even order harmonics in the output voltages of the NPC inverter are produced by asymmetrical waveforms caused by the improper switching sequence of the traditional SVM scheme. 2. A new SVM scheme is developed to eliminate the even order harmonics. The new scheme can produce symmetrical inverter output voltage waveforms. As a result, all the even order harmonics are eliminated. The harmonic performance of the NPC inverter operating under various conditions is investigated, and the THD profile of the new scheme is provided. The proposed SVM scheme can also be applied to any other types of multilevel converters for even order harmonic elimination. 3. An algorithm for the closed-loop control of the inverter neutral point potential is proposed. The cause of neutral point potential deviation is analyzed. The deviation is corrected by using redundant switching states in the SVM scheme. This proposed control algorithm has been verified by simulations.

77

Recommended future works: Â· The proposed SVM scheme and neutral point potential control for the tliree-Ievel NPC inverter are verified by experiments; and Â· The proposed SVM scheme can also be applied to NPC rectifiers for the purpose of even order harmonic elimination. It is recommended that the input power factor control and the output DC voltage control for the rectifier are investigated.

78

References
[1] R. Sommer, et al, `New medium voltage drive systems using tliree-level neutral point clamped inverter with high voltage IGBT', IEEE Industry Applications Society (IAS) Conference, ppl513-1519,1999. S. Malik and D. Kluge, `ACS 1000 - World's First Standard AC Drive for Medium Voltage Applications,'ABB Review, No.2, pp 4 -ll, 1998. J.P. Lyons, V. Vlatkovic, RM. Espelage, F.H. Boettner and E. Larsen, `Innovation IGCT Main Drives,' IEEE Industry Applications Society (IAS) Conference, pp2655-2661,1999. RW. Hammond, `A New Approach to Enhance Power Quality for Medium Voltage AC Drives,' IEEE Trans, on Industry^ Applications, Vol.33, N o.l, pp202-208, 1997. W.A. Hill, and C.D. Harbourt, `Performance of Medium Voltage Multilevel Inverters,' IEEE Industry Applications Society Annual Meeting (IAS), Vol.2, pp 1186-1192, 1999. R.H. Osman, `A Medium Voltage Drive Utilizing Series-Cell Multilevel Topology for Outstanding Power Quality,' IEEE IAS Conference, pp2662-2669, 1999. B.Wu, Y.Li and S.Wei, `Multipulse Diode Rectifiers for High-Power Multilevel Inverter Fed Drives,' IEEE International Power Electronics Congress (CIEP), Mexico, October 2004. M.F. Aiello, RW. Hammond and M. Rastogi, `Modular Multi-level Adjustable Supply with Parallel Connected Active inputs,' US Patent #6,301,130, 2001. J. Rodriguez, L. Moran, et al, `High Voltage Multilevel Converter with Regeneration Capability,' IEEE Trans, on Industrial Electronics, Vol.49, No.4, pp839-846, 2002. Y. Shakweh and E.A. Lewis, `Assessment o f medium voltage PWM VSI topologies for multi-megawatt variable speed drive applications,' IEEE Power Electronics Specialists Conference, Vol.2, pp965 -971, 1999. B. Bose, ` Modem power electronics and AC drives', Prentice-Hall Inc., 2002, ISBN 0-13-016743-6, TDK 2781.B67 2001 S. Wei, B.Wu, F. Li and C. Liu. `A general space vector PWM control algorithm for multilevel inverters'. Applied Power Electronics Conference and Exposition 2003, Eighteenth Annual IEEE, Vol.l, 9-13 Feb. 2003 pp562-568 H. Hsu, `Applied Fourier Analysis', Harcourt Brace Jovanovich, Publishers, 1984, ISBN 0-15-601609-5, QA403.5.H78 1984

[2]

[3]

[4]

[5]

[6 ]

[7]

[8 ]

[9]

[10]

[11]

[12]

[13]

79

Appendix I Harmonic limits in IEEE standards 519-1992
Ikble 103
C urrent D istortion Limita for G eneral Disteibution System s (120 V Through 69 000 V)
Maximum Harmonic Current Dtstartion in Percent of 4 individual Harmonie Order (Odd Harmonics) V 4 <20* W<5Q 50<100 lOOclOOO >1000 <11 4.0 7.0 100 12.0 15.0 2.0 35 4.S 5.5 7,0 I7sh<23 15 2.5
40 GO

23sh<35
0,6

msh
0.3 OS 0.7 10 1.4

TDD 5.0 8,0 120 15,0
200

10 1.5
30

6.0

2.5

Even harmonies are limited to 25% of the odd harmonic limits above. Currentdistartkns that result in a dc oAet, e.fhalf-wave converters, are not allowed. *AII power generation equipment is limited to these values of current distortion, regardleBf of actual 4 / 4 where = maximum short-circuit current at r c c .
/ Â« m axim um dem and load c u rre n t (fundam ental frequenqr component) at

PCC,

Table 10.4

Ciurent Distortion Limits for General Subtranamission Systems (69 0 0 1 V Through 161000 V)
Maximum Rarmunic Current Distortian in Percent of 4 Individual Harmonic Order (Odd Harmonics)
<11

1W <I7
1.0

17<5<23 0.75 1,25
2.0 2.5 a.o

23sA<35 03 0.5 0.75 1.0 1,25

35Sfc 0,15 0.25 0.35 0.5 0.7

TDD 2.5 4.0 6,0 7.5 10.0

<20* 20<S0 50<100 lOOclOOO >1000

20

3,5 50 Â«0
7.5

1.75 2.25 2.75 3.5

Even harmonies are limited to 25%W the odd harmonic limits above. Current distortions that result in a dc offset, e.g., half-u-ave ctmverters, are not allowed. "AO power generation equipmmt is limited to these values of current distortion, regardless of artu al f^ 4 where 4 = maximum short-circuit current at PCC. = maximum demand load current (fundamental frequency component ) at PCC.

80

% b le m s Current Distortion Limits for Goneral Transmission Systems (>161 kV), Dispersed Generation and Cogeneration
Individus! Harmonie Order (Odd Harmonie#) <11 <50 S50 2.0 3.0 llÂ£h<17 1.0 1,5 1ÃS1k 23 0.75 1.15 23Sh<35 0.3 0.45 3Ssh 0.15 0.22 THD 2.5 3,75

Even harm<mkÂ» are limited to 25% of the odd harmonic limits shove. Current distortions that result m a d e ofSei, eg., half-wave converters, are not allowed. *AII power generatkm equipment is limited to these values of current distwtion, regardless of actual where /, = maximum short-circuit current at PCC. = maximum demand load current (fundamental frequency component! at PCC,

81

Appendix II Switching Pattern Design based on Traditional Scheme
Segment r'
2n d

Time interval

I-la vector switching state [ONN] vector P /A f K 2A f

I-2a switching state [ONN] [OON] [PON] vector

1-3 switching state

V IN
7c/2 7% /2 7h/{2 7% /2 7b/2

F

IN

[ONN]
[PNN] [PON]

[OON]

grd 4 th
5 '" 6"'

F 72
F? F IP F? V 13

Vo V IP Fo

[0 0 0 ]

F?
T /f

[POO] [OOO] [OON]
[ONN] Mb

[POO]
[PON]

[POO]
[PON] [PNN] [ONN] 1-4

F7
F2A' F /v vector F 2A f

[OON] [ONN]
I-2b switching state

y th
Segment Time interval

Fvv
vector

F 7^
vector F
2N

switching state

switching State [OON] [PON] [PPN] [PPO] [PPN] [PON] [OON] 11-3

J S I
3r d
4 th

TbV
7%/2 7a/2 7c/2 7% /2 7c/^ Time interval 7c/^ 7Â»/2 7b/2 7c/2 7%/2

5*

6"' 7 "' Segment ].S t 2"d
3 rd
4 th

F 2// Vo V IP V 2P V IP Vo V 2N
vector

[OON] [OOO] [POO]
[PPO]

[OON] [PON] [POO]
[PPO]

F?
F /f F 2?

[POO]
[0 0 0 ]

F IP F?
F2V vector

[POO]
[PON] [OON] II-2a switching state [OON] [OPN] [OPO] [PPO] [OPO] [OPN] [OON] II-2b

[OON]
II-la switching state [OON]

Vl V 14 V 2P F7 ^ F? F 2N
vector F 2A f

switching state [OON] [OPN] [PPN] [PPO] [PPN]

V 2N Vo V 2P V 3P Vo V 2N
vector

[OOO]
[OPO] [PPO] [OPO]

F 2^ Vs V 3P V 2P
F

Vs F 7^
F
2P

5"'

F 14

"` 'yth
6

[OOO]
[OON] II-lb switching state [NON] [OON]

T c/'^
Time interval

Vs F 2A f
vector

Fa
F
2N

[OPN]
[OON] II-4

Segment

jst
2 nd 3 rd
4 th

switching state [NON] [OON] [OPN] [OPO] [OPN] [OON] [NON]

vector F
3N

switching state [NON] [NPN] [OPN] [OPO] [OPN] [NPN] [NON]

Th/V 7b/2 T& /2

5'^ 6"' 7b/2

y th

7h/^

V 3N F A f Fo V 3P Fo F A f V 3N
2 2

[OOO]
[OPO]

F 2A f F 2^ Vs V 3P

[OOO]
[OON] [NON]

Ff
F2N
F
3N

V 15 Vs F 3P Vs V 15
F
3N

(to be continued)

82

(Continue of last page)
Segment JS, 2nd grd
4

Time interval

III-la vector switching state [NON] [NOO] [OOO] [OPO] [0 0 0 ] [NOO] [NON] Ill-lb vector switching state [NOO] [OOO] [OPO] [OPP]
V 3P

lll-2 a vector switching state [NON] [NOO] [NPO] [OPO] [NPO] [NOO] F JA / vector F fA f
F p

II1-3 vector switching state [NON] [NPN] [NPO] [OPO] [NPO] [NPN] [NON] 111-4 vector switching state [NOO] [NPO] [NPP] [OPP] [NPP] [NPO] [NOO] IV-3 vector switching state [NOO] [NOP] [NPP] [OPP] [NPP] [NOP] [NOO] IV-4 vector F switching state [NNO] [NNP] [NOP] [OOP] [NOP] [NNP] [NNO]

7c/2 7% /2 7h/2 7%/2 7c/2

th

V V Fo V
Fo

3N

4N

3P

V V 9 V
3N 3P

5 `" 6 "' y th Segment
,st

Fp

V 4N

F jv Time interval

[NON] III-2b switching state [NOO] [NPO] [OPO] [OPP] [OPO] [NPO] [NOO] IV-2a

V F /j V9 Fa? V9 V1 5 V
3N 3N

')iid grd
4

73/2 7o(2 7k/2 7a/2 7%/2 7b/^ Time interval 7e/4 7%/2 7h/2 Tt/2 7o/2 73/2 7(yV Time interval 7Ã/'/

V o V o

V
F p

4N

V 3P V 4P

th

5 "'

[OPO] [OOO] [NOO]

6"'
7 `h

Fp
F vjv vector

V V1 6 9
4P V

F 76

Fvv

Segment ]St 2Â»d grd
4 "' 5 "'

IV-la
vector switching state [NOO] [OOO] [OOP] [OPP] [OOP] [0 0 0 ] [NOO] IV -lb vector switching state [NNO] [NOO] vector
F F ^ f

switching state [NOO] [NOP] [OOP] [OPP] [OOP] [NOP] [NOO] IV-2b switching state [NNO] [NOO] [NOP] [OOP] [NOP] [NOO] [NNO]

6'" y til Segment
r

V o V V Vs p V
5P 4P
F o

V 4N

V

4N

F / o

F 4N 10

V

F /o F

V

SP

F

70

V1 6 V1 0
SN 17

4P

4N

F

F -77/

3 rd
4 *

T c /2

V

5N

JA f

V 4N

7%/2 7Ã/2 7%/2 7k/2 7o/4

Fo
V SP

[OOO]
[OOP]

S'"
6" *

V o

[OOO]
[NOO] [NNO]

V 4N V SN

7*!'

(to be continued)

V10 V V V
SP
F / o

F V A ^

V V10
V 10 V

V SP

4N

1 7

SN

V SN

83

(Continue o f last page)
Segment Time intenal V -Ia vector
V 5N

V-2a vector
Ã j A /

V-3 vector F
J AT

switching state [NNO] [ONO]

switching state [NNO] [ONO]

switching state [NNO] [NNP] [ONP] [OOP] [ONP] [NNP] [NNO] V-4

F 6.V
V u

Ã / 7

2I 'd

7% /2 73/2 7c/2 Tb/4 Time interval TcyV 7%/2
Ta/ 2 Tc/ 2

Ã

o

[OOO]
[OOP]

[ONP]
[OOP] [ONP]

V u V 5P V u V

F 5 `"
6 "'
Ã o

F jp
Ã ; /

[OOO] [ONO]
[NNO] V -lb

y ih Segment

V

5 N

V

6 N

[ONO] [NNO]
V-2b

1 7

F jv vector
F 6A'

F 5N
vector

vector
V 6N

switching state

switching state [ONO]

switching state [ONO] [ONP] [PNP] [POP] [PNP]

1
2

[ONO] [OOO] [OOP]
[POP] [OOP] [OOO] [ONO] V l-la

F 6N
V u

V o

Ã y y

[ONP]
[OOP] [POP] [OOP] [ONP] [ONO] VI-2a

3 4 5
6

V 5P

F 6P

F 18 F 6P
F yg
V u

V 5P

F 5P
V u

7% /2 7k/4 Time interval

Ã F

o gAf

[ONP]
[ONO] VI-3

7 Segment
IS.

Ffyy
vector

F gAf
vector

vector
V 6N

switching state [ONO]

switching state [ONO] [PNO] [POO] [POP] [POO] [PNO] [ONO] VI-2b

switching State [ONO] [PNO] [PNP] [POP] [PNP] [PNO] [ONO] VI-4

F 6N
V 12

2 'id

F g A'
V 12 V 18

7% /2 7o<2 7b<2 7b<2 7%/2 7c/4 Time

grd
4 .,,

V o V IP

[OOO]
[POO] [POP] [POO]

Ã 6f

5"`
6" '
y til

r /f
V o V 6N

F ip F F ip

6 F

F 6P
Ã y g

[OOO] [ONO]
V l-lb

V 12

V 12 V 6N

F f AT
vector
ÃyA T

Segment

interval
7b(2 7% /2 7o<2 7% /2 7b<2

vector
Ã y y ^

switching state

switching state [ONN] [ONO] [PNO] [POO] [PNO] [ONO] [ONN]

vector
Ã y #

switching state [ONN] [PNN] [PNO] [POO] [PNO] [PNN] [ONN]

'y n d
3

]S .

[ONN]
[ONO] [OOO] [POO] [0 0 0 ] [ONO] [ONN]

V 6N V o
V IP

F
V 12

rd

Vis
V 12 V 12

4* 5" '
6 ""
y ,h

V o

F yp Ãy2

V ip

F 6N
ÃyA T

Fyj

Ã / V

F !N

(End o f Appendix I)

84

Appendix III Switching Pattern Design based on New Scheme
Segment 1" 2Â«d grd
4

Time internal

I-la vector F /P switching state [POO] [OOO] [OON] [ONN] F 2^ [OON] [OOO] [POO] I-lb vector switching state [OON] [OOO] [POO] [PPO] [POO] [OOO] [OON] II-la vector F 27V switching state [OON] [OOO] [OPO] [PPO] [OPO] [OOO] [OON] Il-lb vector switching state [OPO] [0 0 0 ] [OON] [NON] [OON] [0 0 0 ] [OPO] vector F jp vector vector vector

I-2a switching state [POO] [PON] [OON] [ONN] [OON] [PON] [ONN] I-2b switching state [OON] [PON] [POO] [PPO] [POO] [PON] [OON] II-2a switching state [OON] [OPN] [OPO] [PPO] [OPO] [OPN] [OON] II-2b switching state [OPO] [OPN] [OON] [NON] [OON] [OPN] [OPO] vector F2f vector F 27V Fa F
14

1-3 vector switching state [POO] [PON] [PNN] [ONN] [PNN] [PON] [ONN] 1-4 vector F 27V switching state [OON] [PON] [PPN] [PPO] [PPN] [PON] [OON] II-3 switching state [OON] [OPN] [PPN] [PPO] [PPN] [OPN] [OON] II-4 switching state [OPO] [OPN] [NPN] [NON] [NPN] [OPN] [OPO] .

76/2 7c/2 7o<2 7c/2 76/2

th

Vo V 2N

V IP Vl
F 27V

V IP Vl
F 72 F 7 7 V F 72

5 "'

6*" th Segment r' Â«d rd th

Vo V

I P

V IN V 27V Vl
P 7 7 V

Vl
F7V

Time interval

2

3

T b /2 T a /2
7c/2 7h/2 76/2 7c/^ Time interval 7c/^ 76/2 7h/2 7b/2 7a<2 76/2 7<W Time interval

V 2N
Fo F /p P 2P K /p

4

5 '"

6 "' 7 `h Segment r*
3

Vo V 2N

V 27V Vl V IP V 2P V IP Vl
K 27V

Vl V 14
F 27Â» F
14

Vl
F2V

rd th

4

5 `h

6 `h 2 th
Segment jst
2 3

Vo V 3P V 2P V 3P Vo
K2At

V 27V Vs
V
sp

V 2P V 3P
F& F 2^

V 2P V 14 Vs
F 27V

nd rd

T b /2
76/2 76/2 7c/2 76/2 76/^

7o/^

V SP Vo
K 27 V F 2 7 V T2A7

Vs
F 27V F 27V F 2A f

Vs
F 72

4 1

..

V 3N
F 72

5 `h

6 `h
2 til

Vo V 3P

Vs
F 2P

Vs V SP

(to be continued)

85

(Continue o f last page)
Segment
]S t

Time interval

Ill-la vector switching state [OPO] vector

III-2a switching state [OPO] vector

1II-3 switching state [OPO] [NPO] [NPN] [NON] [NPN] [NPO]

2 nd
grd

7% /2 7c/2 7c/2 7% /2

Vo
F F ^jV

[

000]

V 3P F p
K F F p jA !

F

3P

[NPO]
[NOO] [NON]

F

p

[NOO]

V 15

4 th 5 "' 6 '"
y th F

JA f

[NON]
[NOO] [OOO]

FJAT

[NOO] P^iO] [OPO] H Flb

V 15
F
p

Vo V 3P
vector

[OPO]
Ill-lb switching state [NOO] [OOO] [OPO] [OPP] [OPO] [OOO]

F jp vector

F jp
vector

[OPO]
III-4 switching state [NOO] [NPO] [NPP] [OPP] [NPP]

Segment
jS t

Time interval

switching state

TtvV

2 "d
3 rd 41.
s" *

T a /2 7c/2 T a /2
7% /2
7c/^ Time interval

7% /2

6" '
th

V 4N Vo V 3P V 4P V 3P Vo
F vector

F
Fp

[NOO]
[NPO] [OPO] [OPP] [OPO] [NPO]

F

4N

Fp

F jf
F
4P

F 16
F VP

F jf

F /g
F
p

[NOO]
IV -la switching state [NOO] [OOO] [OOP] [OPP] [OOP]
[OOO] [NOO]

Fp F^#
vector
Fv^

[NPO]
[NOO] IV-3

[NOO]
IV-2a switching state

Fv//
vector

Segment

switching state [NOO] [NOP] [NPP] [OPP] [NPP] [NOP] [NOO] IV-4

2 Â»d
3 rd

V 4M
7% /2 7a/2 7c/2 7o<2 7%/2 7c/^ Time interval
F o

[NOO]
[NOP] [OOP]

F
F

10

4 th
5 '"

6 "'
'y th

V 5P V 4P V 5P Vo V 4N
vector

V 5P
VP

FV A f V JO V 16
F
VP

[OPP] [OOP]
[NOP]

Fjp V 10 F vv
vector

[NOO]
IV-2b switching state [OOP] [NOP] [NOO] [NNO]

F /g V JO V 4N
vector F
5P

Segment

IV -lb switching state [OOP]
[OOO]

r`
2 "d
3 rd

T a /4
7c/2

switching state [OOP] [NOP] [NNP] [NNO] [NNP] [NOP] [OOP]

V 5P
F o

V 5F
V 10

7%/?

F /o

7c/2

4 th
5

"'

6 `"
y th

7% /2 7b/^

V 4N V 5N V 4N Vo V 5P

[NOO]
[NNO]

FV A f
F jv p

V 17 V SN
F /z

[NOO]
[

V 4N
F to

[NOO]
[NOP] [OOP]

000]

V 10
F jp

[OOP]

F jp

(to be continued)

86

(Continue o f last page)
Segment Time interval V -la vector switching state [OOP]
')nd grd

\^ 2a vector switching state [OOP] [ONP] [ONO] [NNO] [ONO] [ONP] vector K jf

V-3 switching state [OOP] [ONP]

F jf
V II V 6N V 5N

7b/2 7b/2 7c/2 7%/2 7b/4 Time interval

4 th

Vo V 6N V 5N
E

[0 0 0 ] [ONO] [NNO]

F //
K /7

[NNP]
[NNO] [NNP] [ONP] [OOP] V-4

5"'
6 "'
y th

[ONO]
[OOO] [OOP] V -lb

F 6V \f
V II V 5P

V 17

Vo
V 5P

F /t

[OOP]
V-2b

Segment
1 2

vector
V 6N

switching state [ONO] [OOO] [OOP] [POP] [OOP] [OOO] [ONO] V I-la

vector

switching state [ONO] [ONP] [OOP] [POP]

vector
V 6N V II V 18 V 6P

switching state [ONO] [ONP] [PNP] [POP] [PNP] [ONP] [ONO] VI-3

3 4 5
6
7

T b /2 T a /2
7c/2 7h<2 7t/2 Tc/4 Time interval 7c/4 T6/2 7a/2 7c/2 7h/2 7%/2

TtvV

F 6^
V
II

Fo
V 5P V 6P V 5P

V 5P V 6P V 5P V II V 6N

[OOP]
[ONP]

F /a
V II

Fo
V 6N
vector

[ONO]
VI-2a

K 6A' vector
K

Segment
JSt
2

switching state [ONO] [OOO] [POO]

vector

switching state [ONO] [PNO] [POO] [POP] [POO]

switching state [ONO] [PNO] [PNP] [POP] [PNP] [PNO] [ONO] VI-4

nd

grd

E 6# Fo
V IP V 6P

F fv
V 12 V IP V 6P V IP

F /;
K

4 th 5 `"
6 '"
y th

[POP] [POO]
[OOO] [ONO] V I-lb

Fgf
K /a
V 12

F tf
Ko K
vector
V IP

7b/4
Time interval

F t; K 6A '
vector

[PNO] [ONO]
VI-2b switching state [POO]

K
vector
V IP V 12

Segment
jSt

switching state [POO] [OOO] [ONO] [ONN] [ONO] [OOO] [POO]

switching state [POO] [PNO] [PNN] [ONN] [PNN] [PNO] [POO]

F /f
V 12 V 6N V IN V 6N

2nd grd
4

7%/2 7c/2 To/? 7c/2 73/2

Fo
V 6N V IN V 6N Vo V IP

[PNO] [ONO] [ONN]
[ONO]

K /j
V IN

th

5 "'
6 '"

F /j
K /;

y th

F

/2

[PNO]
[POO]

7h/4

V IP

(End o f Appendix II)

87

Appendix IV
S-funtion Program used in Gating Signal Generator based on New Scheme
function [sys,xO,str,ts] = ModeI_I(t,x,u,flag,sfq,deadtime) ct__period =1 /sfq; deadtime=deadtime; switch flag, %stp: sample frequency %ct__period: sample time %interlock deadtime

%%%%%%%%%%%%%%%%%%
% Initialization %

%%%%%%%%%%%%%%%%%%
% Initialize the states, sample times, and state ordering strings, case 0 [sys,xO,str,ts]=mdlInitializeSizes(t,x,u,ct_period);

%%%%%%%%%%%%%%%%%%
% Main function and Data update %

%%%%%%%%%%%%%%%%%%
case 2 sys=mdIUpdate(t,x,u,ct_period,deadtime);

%%%%%%%%%%%
% Outputs %

%%%%%%%%%%%
% Return the outputs o f the S-function block, case 3 sys=mdlOutputs(t,x,u); case { 1 ,4, 9 } sys=[];

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Unexpected flags (error handling)%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Return an error message for unhandled flag values, otherwise error(['Unhandled flag = ',num2str(flag)]); end % end timestwo
% = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = =

% mdllnitializeSizes % Return the sizes, initial conditions, and sample times for the S-function. function [sys,xO,str,ts] sizes = simsizes; sizes.NumContStates sizes.NumDiscStates sizes .N umOutputs sizes.Numlnputs = mdlInitiaIizeSizes(t,x,u,ct_period) = 0; =25; = 12; = 6;

% In Model I, this line is: sizes.Numlnputs

=2;

sizes.DirFeedthrough = 5;

sizes.NumSampleTimes = 2; sys = simsizes(sizes); str = []; xO = zeros( 1); ts = [ct_period,0;0,0]; % end mdllnit.ializeSizes

88

% =======================
% mdl discrete state % Return the output vector for the S-function function sys=indlUpdate(t,x,u,ct_period,deadtime) %input:ul :vector length,u2:vector angle % For Model II: u3 :capacitor voltage u4:P parameter, u5:1 parameter, u6: D parameter % ctjperiodisample time, deadtime:interlock deadtime %interval parameters: dwell times: xl=tl,x2=t3,x3=t3 % x4=global region number % x5=sample time, x6=delta t % gating: x7=g_a 1, x8=g_a 2, x9=g_a_3, xl0=g_a_4 % X11=g b_ 1,x 12=g_b_2,x 13=g_b 3 ,x 14=g_b_4 % X15=g_c_] ,x 16=g c_2,x 17=gc_3,x 18=g_c_4 % X19=interlock flag, x20=interlock start time sys(l:25)=x(l:25); %calculation o f dwell time if rem(t,ct_period)/ctjDeriod < le-3, %vector angle liner vangle=rem(u(2),2*pi); if vangle < 0, vangle=vangle+2 *pi ; end " /osection number sno= round(3*vangle/pi+.5); %interval angle ivangle=vangle-(sno-1)*pi/3 ; thita %dwell time in region 2 ta=ct_period*(l-2*u(l )*sin(ivangle)); % ta tb=ct_period*(2*u(l)*sin(ivangle+pi/3)-l); tb tc=ct_period*(l-2*u(l)*sin(pi/3-ivangle)); % tc "/ointerval region number and dwell time in each region if ta<0, irno=6; % ta'<0, =>in region 4 t3=ct_j)eriod*(2*u( 1)*sin(ivangle)-1); t2=ct_period*2*u( 1)*sin(pi/3-ivangle); tl=ct_period*(2-2*u(l)*sin(ivangle+pi/3)); else if tc<0, imo=3; % ta'>=0,tc'<0, =>in region 3 tl=ct_period*(2-2*u(l)*sin(ivangle+pi/3)); t2=ctjDeriod*2*u( 1)*sin(ivangle); t3=ct_period*(2"'u( 1)*sin(pi/3-ivangle)-1); else if tb<0, ta',tc'>=0, tb'<0, =>in region 1 if ivangle>pi/6, imo=2; % ta',tc'>=0, tb'<0, interval angle > pi/6, =>in region lb t3=ct_period*2*u(l)*sin(pi/3-ivangle); t2=ctj>eriod*(I-2*u(l)*sin(ivangle+pi/3)); 11=ctj)eriod*2*u( 1)*sin(i vangle); else imo=l ; ta',tc'>=0, tb'<0, interval angle <= pi/6, =>in region la tl=ct_period*2*u(l)*sin(pi/3-ivangle); t2=ct_period*( 1-2*u( 1)*sin(ivangle+pi/3)); t3=ct_period*2*u(l)*sin(ivangle); end

% %

%

%

89

else % ta',tb',tc'>=0. => in region 2 if ivang!e>pi/6, imo=5; % ta',tc'>=0, tb'<0, interv'al angle > pi/6, =>in region 2b if rem(sno,2)<l e-2, %in sector II, IV or VI tl=tc; t3=ta; t2=tb; else %in sector 1, ill or V tl=ta; (2=tb; t3=tc; end else irno=4; % ta',tc'>=0, tb'<0, interval angle <= pi/6, =>in region 2a tl=ta; t2=tb; G=tc; end end end end %global region number gmo=(sno-1)*6+imo; sys(I)=tl; sys(2)=t2; sys(3)=t3; sys(4)=gmo; sys(5)=ct_period; %Begin of delta t: only for Model II. Delete this part for Model I. p=u(4); dt= (2800-u(3))*p; sys(6)=dt*(-1)^(sno+floor(i vangle*6/pi)); end % End o f delta t: only for Model II. Delete this part for Model I. if x(5)>0, %normal condition other than the beginning %interval time it= rem (t,x(5)); %seven time intervals corrected with delta t IIn Model I. this line is: tl=x(lV4; tl=x(l)/4-x(l)*x(6); t2=x(2)/2+tI; t3=x(3)/2+l2; % In Model I. this line is: t4=x( 1V2+13: t4=x( 1)/2+x( I )*x(6)*2+t3 ; t5=x(3)/2+t4; t6=x(2)/2+t5; %on-duty vector interval number if it > t6, ivn=I; else ifit> t5 , ivn=2; else ifit> t4 , ivn=3; else

90

if it > t3, ivn=4; else

ifit>t2,
ivn=3; else ivn=2; else ivn= end end end end end end %in duty vector global number gvn = ivn + x(4) * 4 - 4 ; %tables o f switching states A=[2 1 1 1 1 1 2 2 2 2 2 1 2 2 1 1 1 2 2 2 1 2 2 2 1 1 1 2 1 1 1 0 1 1 2 2 1 1 1 2 1 1 1 0 1 1 0 0 1 1 0 0 0 1 1 1 1 0
0 0 1 0 0 0 0 0 1 1 0 0 0 1 0 1 1 11 1 0 0 0 0 0 1 0 0 1 1 1 0 0 0 1 0 0 0 1 1 1 0 1 1 2 2 1 1 2 2 2 1 1 1 1 2 2 2 1 2 2 2 2 2 1 1 2 2 2 1]; 121 1 0 0 1 1 1 0 1 1 121 1

B=[l 1 1 0 1 1 1 2 1 1 0 0 1 1 1 0 1 1 1 2 1 1 2 2 1 1 2 2 2 1 1 1 1 2 2 2 1 2 2 2 2 2 1 1 2 2 2 1 2 1 1 1 1 1 2 2 2 2
212211122212221112111011221112111011001100011110001000001100 0 1 0 1 1 1 1 1 0 0 0 0 0 1 0 0 1 1 1 0 0 0 1 0 0 0 ];

C=[l 1 0 0 0 1 1 1 1 0 0 0 1 0 0 0 0 0 1 1 0 0 0 1 0 1 1 1 1 1 0 0 0 0 0 1 0 0 1 1 1 0 0 0 1 0 0 0 1 1 1 0 1 1 1 2 1 ! 0 0 1 I 101 1 121 1 2 2 2 2 1 I 1 1 1 2 1 2 2 2 1 2 2 2 2 2 1 1 2 2 2 1 2 1 1 1 1 1 2 2 2 2 2 1 2 2 1 1 1 2 2 2 1 2
2 2 1 1 1 2 1 1 1 0 1 1 2 2 1 1 1 2 1 1 1 0 1 1 0 0 ];

%switching states pa = A(gvn); pb = B(gvn); pc = C(gvn); %gate signals if pa==2,

g(l)

1;

g(2)=l g(3)=0 g(4)=0 end if pa = = 1 , g(l)=0

g(2) 1; g(3>

g(4M
end if pa == 0 , g(l)=0 g(2)=0 g(3)=l g(4)=l end if pb==2,

g(5)=l
g(6)=l g(7)=0 g(8)=0

91

end ifpb==l, g(5)=0; g(6)=U g(7)=l;
g (8 M ;

end if p b = 0 ,

g(5)=0;
g(6)=0;

g(7)=l; g(8)=i;
end if pc==2,
g ( 9 ) - i;

g(iO)-l;
g(ll)=0;

g(1 2 M ;
end ifpc==l, g(9)=0; g(10)=l;

g(MM; g(i2 M ;
end if pc==0, g(9)=0; g(10)=0; g(i i )=i ; g(12)=l; end %interiock dead zone for i=l;12, if x(i+6) ~= g(i),
ifx (l9 ) = 0 , sy s(1 9 )= l;

sys(20)=t; end
ifg (i)= H ),

%should jump %first time %set start flag " /ostart time

sys(i+6)=0; end if t > sys(20)+deadtime, sys(7;18)=g(l:12); sys(19)=0; end end end end

%Jump down

%deadtime over %all jump %reset start flag

%end o f normal condition

% mdlOutputs % Return the output vector for the S-function function sys = mdlOutputs(t,x,u) sys(l:12) = x(7:18);

92

