Ryerson University

Digital Commons @ Ryerson
Theses and dissertations

1-1-2013

Current Source Converter Based Offshore Wind Farm: Configuration and Control
Miteshkumar Nandlal Popat
Ryerson University

Follow this and additional works at: http://digitalcommons.ryerson.ca/dissertations Part of the Electrical and Computer Engineering Commons Recommended Citation
Popat, Miteshkumar Nandlal, "Current Source Converter Based Offshore Wind Farm: Configuration and Control" (2013). Theses and dissertations. Paper 1525.

This Dissertation is brought to you for free and open access by Digital Commons @ Ryerson. It has been accepted for inclusion in Theses and dissertations by an authorized administrator of Digital Commons @ Ryerson. For more information, please contact bcameron@ryerson.ca.

CURRENT SOURCE CONVERTER BASED OFFSHORE WIND FARM: CONFIGURATION AND CONTROL
By

Miteshkumar Nandlal Popat
B. Eng., B.V.M. Engineering College, V.V.Nagar, India, 1997 M. Tech., Indian Institute of Technology, Roorkee, India, 2006

A dissertation presented to Ryerson University in partial fulfillment of the requirements for the degree of Doctor of Philosophy in the program of Electrical and Computer Engineering

Toronto, Ontario, Canada, 2013 Â© Miteshkumar Nandlal Popat, 2013

ii

Author's Declaration

I hereby declare that I am the sole author of this dissertation. This is a true copy of the dissertation, including any required final revisions, as accepted by my examiners.

I authorize Ryerson University to lend this dissertation to other institutions or individuals for the purpose of scholarly research.

I further authorize Ryerson University to reproduce this dissertation by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. I understand that my dissertation may be made electronically available to the public.

iii

iv

Current Source Converter Based Offshore Wind Farm: Configuration and Control
Miteshkumar Nandlal Popat Doctor of Philosophy Electrical and Computer Engineering Ryerson University, Toronto, 2013

Abstract
Recently, offshore wind farms have emerged as the most promising sector in the global renewable energy industry. The main reasons for the rapid development of offshore wind farms includes much better wind resources and smaller environmental impact (e.g., audible noise and visual effect). However, the current state of the offshore wind power presents economic challenges significantly greater than onshore. In this thesis, a novel interconnecting method for permanent magnet synchronous generator (PMSG)-based offshore wind farm is proposed, where cascaded pulse-width modulated (PWM) current-source converters (CSCs) are employed on both generator- and grid-side. With the converters in cascade to achieve high operating voltages, the proposed method eliminates the need for bulky and very costly offshore converter substation which is usually employed in voltage source converter (VSC) high voltage DC (HVDC)-based counterparts. Related research in terms of control schemes and grid integration are carried out to adapt the proposed cascaded CSC-based offshore wind farm configuration. The large distance between generator- and grid-side CSC in the proposed wind farm configuration addresses significant challenges for the system control. In order to overcome the problem, a novel decoupled control scheme is developed. The active and reactive power control on the grid-side converters are achieved without any exchange of information from the generator-side controller. Therefore, the long distance communication links between the generator- and grid-side converters are eliminated and both controllers are completely decoupled. At the same time, the maximum power tracking control is achieved for the generator-side converters that enable full utilization of the wind energy.
v

Considering inconsistent wind speed at each turbine, a coordinated control scheme is proposed for the cascaded CSC-based offshore wind farm. In proposed control strategy, the wind farm supervisory control (WFSC) is developed to generate the optimized dc-link current control. This enables all the turbines to independently track their own MPPT even with inconsistent wind speed at each turbine. Grid integration issues, especially the fault ride-through (FRT) capability for the cascaded CSC-based offshore wind farm are addressed. Challenges in implementing existing FRT methods to the proposed offshore wind farm are identified. Based on this, a new FRT strategy using inherent short circuit operating capability of the CSC is developed. Moreover, the mitigation strategy is developed to ensure the continuous operation of the cascaded CSC-based offshore wind farm when one or more turbines fail to operate. Simulation and experimental verification for various objectives are provided throughout the thesis. The results validate the proposed solutions for the main challenges of the cascaded current source converter based offshore wind farm.

vi

Acknowledgement
I would like to express my sincere gratitude to my supervisor, Professor Bin Wu for his invaluable guidance, generous support, and consistent kindness throughout the course of the work. I would like to thanks Dr. Navid Zargari, Prof. David Xu, and Dr. Moya Dai for many fruitful discussions, suggestions, and comments. I would also like to thank all my friends in Laboratory of Electric Drives Application and Research (LEDAR) at Ryerson University, especially Dr. Fangrui Liu, Ehsan Al-nabi, Dr. Jason wang, Ning Zhu and Venkata Yaramasu for many useful discussions and joyful time that we shared together. My special thanks go to my wife, Chandni, for her everlasting love, support and understanding. I am also grateful to my little daughter, Jiya, who always cheer me up. My special thanks also go to my parents and brothers for their continuous encouragement and support. Financial supports from Professor Bin Wu and Ryerson University are gratefully acknowledged.

vii

viii

List of Publications
Journal publications
[1] M. Popat, B.Wu and N. Zargari, "A novel decoupled interconnecting method for current source converter based offshore wind farms," IEEE Trans. on Power Electronics, vol. 27, no. 10, pp 4224-4233, 2012. [2] M. Popat, B.Wu, F.Liu and N. Zargari, "Coordinated control of cascade d current source converter based offshore wind farms," IEEE Trans. on Sustainable Energy, vol. 3, no. 3, pp. 557-565, 2012. [3] M. Popat, B.Wu and N. Zargari, "Fault ride-through capability of cascaded current source converter based offshore wind farms," IEEE Trans. on Sustainable Energy, final manuscript accepted, Oct. 2012, in Press.

Conference publications
[5] M. Popat, B. Wu, and N. Zargari, "A novel decoupled interconnecting method for current source converter based offshore wind farm", in Proc. IEEE Electrical Machines & Drives Conf, (IEMDC), Niagra Falls, Canada, pp. 711-716, May 15-18, 2011. [6] M. Popat, B. Wu and N. Zargari, "DC link current control of cascaded current source converter based offshore wind farms," in Proc. IEEE International Electrical Machines and Drives Conference (IEMDC), Niagara Falls, Canada, pp. 817-822, May 15-18, 2011. [7] M. Popat, B. Wu and N. Zargari, "Fault ride-through of PMSG-based offshore wind farm connected through cascaded current source converter based HVDC," in Proc. IEEE Power Electronics and Machines in Wind Applications (PEMWA) , Denver, USA, July 16-18, 2012.

ix

x

Table of Contents
Abstract...........................................................................................................................................v Acknowledgement........................................................................................................................vii List of publications.......................................................................................................................ix Table of Contents..........................................................................................................................xi List of Figures and Tables...........................................................................................................xv Chapter 1 1.1 Introduction............................................................................................................1 Review of previous work.........................................................................................2 1.1.1 Megawatt WECS offshore application........................................................2 1.1.2 Offshore wind farm configuration...............................................................7 1.1.3 Grid fault-ride through...............................................................................10 1.2 1.3 Chapter 2 2.1 Thesis objectives....................................................................................................11 Thesis outline.........................................................................................................13 Offshore wind farm configuration.....................................................................17 Transmission systems for offshore wind farm......................................................18 2.1.1 High voltage alternating transmission (HVAC)........................................19 2.1.2 Line-commutated converters (LCC)-based HVDC...................................21 2.1.3 Voltage source converter (VSC)-based HVDC.........................................23 2.2 2.3 Offshore substations...............................................................................................26 Offshore wind farm configurations........................................................................27 2.3.1 Series DC wind farm..................................................................................28 2.3.2 Wind farm configuration based on high frequency link............................29 2.3.3 Wind farm configuration based on medium frequency (MF) link.............31 2.3.4 Series interconnected wind turbines using thyristor converter..................33
xi

2.3.5 Distributed HVDC configuration for the offshore wind farm...................33 2.4 Proposed cascaded current source converter-based offshore wind farm configuration..........................................................................................................35 2.5 Chapter 3 3.1 Conclusions............................................................................................................37 Decoupled Control of Cascaded CSC Based Offshore Wind Farm................41 Overview of the system control.............................................................................42 3.1.1 Requirements for the system control.........................................................43 3.2 Decoupled control of cascaded CSC based system...............................................46 3.2.1 Generator-side converter control...............................................................49 3.2.2 Decoupled grid-side converter control.......................................................52 3.2.3 Grid converter dc voltage estimation.........................................................56 3.2.4 Effect of power factor regulation on dc-link current.................................58 3.3 3.4 3.5 Chapter 4 4.1 4.2 4.3 System performance investigation by simulations................................................61 Experimental verification.......................................................................................67 Conclusions............................................................................................................73 Coordinated Control of Cascaded CSC Based Offshore Wind Farm............75 Coordinated control of the wind farm....................................................................76 Active and reactive power control of wind farm...................................................78 Optimized dc-link current control..........................................................................79 4.3.1 Minimum dc-link current requirement from offshore side converters......80 4.3.2 Minimum dc-link current requirement from grid side converters.............83 4.3.3 Reference dc-link current...........................................................................85 4.4 4.5 4.6 System performance investigation by simulations ...............................................86 Experimental verification.......................................................................................91 Conclusions............................................................................................................97

xii

Chapter 5

Grid Fault Ride-Through Strategy for Cascaded CSC Based Offshore Wind Farm...........................................................................................................99

5.1

Grid integration requirements for the wind farm.................................................100 5.1.1 Fault ride-through requirement................................................................102

5.2

Challenges in existing FRT methods for the proposed offshore wind farm........104 5.2.1 Active power reduction at each wind turbine through power setpoint adjustment................................................................................................104 5.2.2 Active power reduction through offshore grid frequency and/or voltage control......................................................................................................108 5.2.3 Energy dissipation in breaking resistor using full rated DC chopper......109

5.3

Proposed fault ride-through method....................................................................110 5.3.1 Short-circuit operating capability of PWM CSC.....................................111 5.3.2 Fault detection..........................................................................................112 5.3.3 Generator-side converters........................................................................113 5.3.4 Wind generators.......................................................................................114 5.3.5 Grid-side converters.................................................................................114 5.3.6 System performance investigation by simulations..................................116

5.4

Mitigations strategy for faulty turbines in cascaded CSC based offshore wind farm.............................................................................................................124 5.4.1 System performance investigation by simulations..................................125 5.4.2 Experimental verification.........................................................................127

5.5 Chapter 6 6.1 6.2

Conclusions..........................................................................................................131 Conclusions.........................................................................................................133 Conclusions..........................................................................................................133 Future works........................................................................................................136

xiii

Appendix A System Modeling................................................................................................139 A.1 A.2 A.3 Wind turbine power model......................................................................140 Permanent magnet synchronous generator..............................................144 Current source converter..........................................................................147

References...................................................................................................................................151 Glossary of Acronyms and Symbols.........................................................................................161

xiv

List of Figures and Tables
Figures
Fig. 1-1 DFIG based WECS..........................................................................................................4 Fig. 1-2 EESG based direct-drive/semi-direct-drive WECS.........................................................6 Fig. 1-3 PMSG based direct-drive/semi-direct-drive WECS........................................................6 Fig. 1-4 Basic layout of large AC offshore wind farm..................................................................7 Fig. 1-5 Basic layout of VSC-HVDC based offshore wind farm..................................................9 Fig. 1-6 Thesis organization.........................................................................................................13 Fig. 2-1 Schematic layout of an offshore wind farm....................................................................17 Fig. 2-2 The basic configuration of an offshore wind farm with a high-voltage alternating-current (HVAC) solution............................................................................................................................18 Fig. 2-3 Single line diagram of Horns rev wind farm..................................................................20 Fig. 2-4 Basic configuration of a wind farm using a line-commutated converter (LCC) high-

voltage direct-current (HVDC) system..........................................................................................21 Fig. 2-5 A typical example of an offshore wind farm using VSC HVDC system.......................23 Fig. 2-6 The Horns rev offshore transformer substation..............................................................26 Fig. 2-7 The series DC wind farm layout....................................................................................28 Fig. 2-8 Wind farm configuration using high frequency link......................................................29 Fig. 2-9 Detailed circuit of high frequency link..........................................................................29 Fig. 2-10 Wind farm configuration based on medium frequency link..........................................31 Fig. 2-11 Series interconnected wind turbines using thyristor-based current source converter....32 Fig. 2-12 Distributed HVDC based configuration.........................................................................33 Fig. 2-13 Wind turbine converter topology...................................................................................33 Fig. 2-14 Proposed cascaded current-source converter-based offshore wind farm.......................35
xv

Fig. 3-1 Proposed system configuration for an offshore wind farm............................................40 Fig. 3-2 Aggregate model representing the proposed wind farm................................................41 Fig. 3-3 Block diagram of a conventional control scheme for the CSC-PMSG-WECS.............45 Fig. 3-4 Block diagram of the proposed decoupled control scheme for the cascaded CSC-based offshore wind farm.........................................................................................................................45 Fig. 3-5 Block diagram of the generator-side converter control..................................................47 Fig. 3-6 Block diagram of the proposed grid-side decoupled control scheme............................51 Fig. 3-7 Example of reactive power requirements during normal system operation of the

wind farm.......................................................................................................................................57 Fig. 3-8 Dc-link current requirement with wind speed changes..................................................58 Fig. 3-9 Generator speed in response to change in the wind speed.............................................61 Fig. 3-10 Grid output powers in response to change in the wind speed........................................62 Fig. 3-11 System dynamic response with change in wind speed...................................................63 Fig. 3-12 Grid-side controller response to change in wind speed..................................................64 Fig. 3-13 Steady-state grid phase voltage and current waveforms................................................65 Fig. 3-14 Photo of low voltage laboratory experimental setup of a CSC-PMSG-WECS.............66
* Fig. 3-15 Measured system dynamic responses; reference speed  g (30 rpm/div), generator speed

 g (30 rpm/div), grid real power Pgrid (1 kW/div) and grid reactive power Qgrid (1kVAr/div).....68
Fig. 3-16 Measured system dynamic response; dc-link current idc (2 A/div) and dc-link voltage

vdci (60 V/div).................................................................................................................................68
Fig. 3-17 Measured grid-side converter controller response........................................................69 Fig. 3-18 The steady-state grid phase voltage v s (100 V/div), line current is (10 A/div), and grid reactive power Q grid (1 kVAr/div) with different power factor operation of the wind farm..........70 Fig. 4-1 Proposed offshore wind farm configuration with different wind speed at each turbine.74 Fig. 4-2 Block diagram of the proposed coordinated control for the cascaded CSC-based

offshore wind farm.........................................................................................................................75
xvi

Fig. 4-3 Generator-side converter control scheme.......................................................................78 Fig. 4-4 Grid-side converter control scheme...............................................................................82 Fig. 4-5 Block diagram of the cascaded CSC-based WECS with inconsistent wind speed at each turbine............................................................................................................................................84 Fig. 4-6 System dynamic response with step change in wind speed at PMSG#1.......................86 Fig. 4-7 Grid output powers in response to step change in wind speed for the wind turbine

connected to PMSG#1...................................................................................................................87 Fig. 4-8 Generator-side CSCs dc-output voltage and dc-link current in response to step change in wind speed for the wind turbine connected to PMSG#1...........................................................88 Fig. 4-9 Block diagram of the laboratory experimental setup.....................................................89 Fig. 4-10 Photo of a Laboratory experimental setup.....................................................................90 Fig. 4-11 Measured system dynamic response with step change in speed reference for PMSG#1;
* reference speed  g 1 and actual speed  g 1 for PMSG#1 (22.5 rpm/div), and output power from

PMSG#1 Pg1 (1000 W/div)............................................................................................................92 Fig. 4-12 Measured system dynamic response with step change in speed reference for PMSG#1;
* * reference speed  g 1 for PMSG#1 (45 rpm/div), reference speed  g 2 and actual speed  g 2 for

PMSG#2 (1000 rpm/div), and output power from PMSG#2 Pg 2 (500 W/div) .............................92 Fig. 4-13 Measured average dc output voltage for generator-side converters with step change in speed reference for PMSG#1.........................................................................................................93 Fig. 4-14 DC-link current and grid output power in response to step change in speed reference for PMSG#1...................................................................................................................................94 Fig. 4-15 Measured grid phase voltage and line current................................................................95 Fig. 5-1 Grid fault-ride through requirement in E.ON grid codes.............................................100 Fig. 5-2 Reactive current support requirement in E. ON grid code...........................................101 Fig. 5-3 Wind farm configuration with communication link for power setpoint adjustment....103 Fig. 5-4 Dc-link response during grid fault...............................................................................105
xvii

Fig. 5-5

Active power reduction for VSC-HVDC based wind farm through offshore grid-

frequency and/or voltage control.................................................................................................107 Fig. 5-6 Wind farm configurations with DC chopper and breaking resistor.............................108 Fig. 5-7 Block diagram of cascaded CSC-based offshore wind farm control...........................109 Fig. 5-8 Generator-side converter control switch during grid fault...........................................111 Fig. 5-9 Zero switching-state operation of generator-side converters during grid fault............112 Fig. 5-10 Grid active and reactive currents and power following the E.ON grid code...............114 Fig. 5-11 Block diagram of cascaded CSC-based wind energy system under investigation.......115 Fig. 5-12 System dynamic response to the grid fault...................................................................117 Fig. 5-13 Bypass signals for the generators during grid fault......................................................117 Fig. 5-14 Generators and grid output power during grid fault.....................................................118 Fig. 5-15 Generators speed during the grid fault.........................................................................119 Fig. 5-16 Grid phase voltage and current during grid fault.........................................................120 Fig. 5-17 Dc-link response with proposed FRT method and FRT with power setpoint adjustment....................................................................................................................................121 Fig. 5-18 Generator-side converter control switch during turbine-generator failure and/or very low wind speed............................................................................................................................123 Fig. 5-19 System dynamic response with isolating one faulty turbine-generator unit from the cascaded CSC-based wind farm...................................................................................................124 Fig. 5-20 Dc-link current and grid powers with isolating one faulty turbine-generator unit from the cascaded CSC-based wind farm.............................................................................................125 Fig. 5-21 Block diagram of experiment setup.............................................................................126 Fig. 5-22 Measured generators active power in response to isolation of PMSG#2 from the System..........................................................................................................................................127 Fig. 5-23 Measured generators speed in response to isolation of PMSG#2 from the system.....128 Fig. 5-24 Measured system dynamic responses with isolating PMSG#2 from the system.........129

xviii

Tables
Table 2-1 VSC-HVDC based grid connection of wind power....................................................24 Table 2-2 Comparison of different wind farm configurations.....................................................38 Table 3-1 System parameters for simulation and experiment .................................................... 60 Table 4-1 System parameters for simulation and experiment ....................................................84 Table 5-1 Switching state for the PWM current source converter.............................................110 Table 5-2 System parameters for simulation and experiment ..................................................116

xix

xx

Chapter 1

Introduction
Recently, offshore wind farms have emerged as the most promising sector in the global renewable energy industry. One of the main reasons for the offshore wind farm development is the lack of suitable wind resources on-land. This is particularly the case in densely populated areas such as in some European countries. Another important reason is that the offshore wind speed is often significantly higher and steadier than that on-land. Considering that the energy obtained by wind turbines is proportional to the cube of the wind speed, the turbines can capture more energy when operating offshore (10% increase in the wind speed will result in 30% increase in energy) [1]. Moreover, the environmental impact, such as audible noise and visual impact, is minimal with the offshore located wind farms [2, 3]. These factors are the primary drivers behind the development of the offshore wind farm. The latest development in the field of wind power generation is the trend towards large offshore wind farms. The global wind power installations increased by 41 GW in 2011, which brings the total installed capacity up to 238 GW [4]. The total installed capacity of the offshore wind farms in Europe have increased from less than 0.1 GW in 2000 to more than 3.8 GW in 2011 [4]. Offshore wind power capacity is expected to reach total of 75 GW worldwide by 2020 [2].

1

The large offshore wind farm and its connection to the grid over distances of tens of kilometers create a number of technical and economic challenges for the developers and system operators [1]. Additionally, the wind farm must be designed to respond appropriately to the grid faults. Few research works related to the offshore wind farm system, particularly configuration and control, have been published so far. In this thesis, the cascaded current source converter (CSC)-based offshore wind farm is proposed. Comprehensive work is carried out to analyze and develop a complete offshore wind farm system from the perspective of wind farm configuration, system control schemes and grid integration. This chapter starts with a comprehensive review of the offshore wind farm system including the megawatt wind energy conversion system (WECS) in offshore applications, wind farm configuration and grid code requirements. Based on this review, the objectives of the thesis are stated. Finally, the organization of the thesis is summarized.

1.1 Review of previous work
In this section, a comprehensive review of the offshore wind farm system is provided. The review is carried out with a focus on the following three subjects: megawatt WECS used for offshore application, system configuration, and grid integration issues.

1.1.1 Megawatt WECS for offshore application
A variety of configurations have been developed for the wind energy conversion systems. These configurations can be classified in two categories according to their operating mode:

2

fixed-speed wind turbine and variable-speed wind turbine. In fixed-speed configurations, the generators are directly connected to the grid through a transformer. Squirrel cage induction generator (SCIG) is exclusively used in this WECS, and its rotational speed is determined by the grid frequency and the number of poles of the stator winding. These wind energy systems are configured without power converter. On the other hand, the variable-speed WECS invariably employ power converters for adjusting the generator speed according to the wind speed. Variable speed operation has a several advantages over the fixed speed WECS. It increases the energy conversion efficiency and reduces the mechanical stress caused by wind gusts. Moreover, the variable speed WECS has ability to meet the grid code requirements. Therefore, it becomes the dominant technology in large WECSs used for offshore application. The different variable-speed WECS are being discussed in the following subsections. a) Doubly-fed induction generator (DFIG)-based WECS The DFIG is widely used for the variable-speed wind energy generation system. A typical block diagram of a DFIG based WECS is shown in Fig. 1-1. The rotor winding is fed through the variable frequency power converter. The stator windings of the generator are directly connected to the grid, providing a major path for the power flow. The converters only have to process the slip power in the rotor circuits, which is approximately 30% of the rated power of the generator nominal power [5, 6]. The rotor speed of the wind turbine is regulated by adjusting the electrical torque via the rotor-side converter.

3

Gear box

DFIG

Power converter

Fig. 1-1 DFIG based WECS.

The fractional-rating power converter reduces the converters cost in comparison to the WECS with full-capacity converter. This is the main reason for wide acceptability of the DFIGbased WECSs for onshore application. However, the DFIG configuration has certain disadvantages as follows [7]: 1) The DFIG based WECS normally requires a costly gearbox to adapt the low speed of wind turbine to the high speed generator. However, the use of a gearbox brings several problems including low reliability, possible oil spills from gearbox, high cost and necessary regular maintenance. 2) The connection of the power converter requires the use of a wound rotor with slip rings and brushes. However, the life cycle of the brushes is usually small and therefore, needs a regular maintenance. This drawback prevents the DFIG for the offshore applications where the maintenance cost is a quite expensive. 3) The fractional-rating power converter and direct connection of the stator in DFIG WECS may cause limited controllability of grid active/reactive power as well as fault ride-through capability.

4

b) Direct-drive or semi-direct-drive synchronous generator-based WECS In the direct-drive arrangement, the turbine and generator rotors are mounted on the same shaft without a gearbox and the generator is specially designed for low-speed operation with a large number of poles. Therefore, the synchronous generator of direct-drive results in a large diameter due to the large number of poles and high torque of the turbine. Normally, the induction generator is not suitable for this type of configuration because the design with direct-drive system may cause high magnetizing current which leads to low power factor and efficiency [8]. The synchronous generators can be classified into two categories: electrically excited synchronous generators (EESG) and permanent magnet synchronous generators (PMSG), as shown in Fig. 1-2 and Fig. 1-3, respectively. Both direct-drive and semi-direct-drive configurations need a fully rated power converter between the stator circuit and the grid to enable generator speed variations. Such a converter is costly and low in efficiency compared with the partially rated converter in DFIG. However, the elimination or reduced complexity of the gearbox improves the system efficiency and reduces the initial costs. More importantly, the direct-drive generator reduces the need for maintenance which is very important in offshore application. With the use of a fully rated power converter, the generator is fully decoupled from the grid which can be utilized to significantly improve the fault ride-through capability of the generation system. As a result, the direct-drive configuration with full-rating power converter becomes a favorable option for megawatt WECS in offshore application [9].

5

Gear box

EESG

Power converter

Excitation

Fig. 1-2 EESG based direct-drive/semi-direct-drive WECS.

Gear box

PMSG

Power converter

Fig. 1-3 PMSG based direct-drive/semi-direct-drive WECS.

As shown in Fig. 1-2, the EESG configuration needs an excitation circuit to provide rotor field current via a slip ring. The exciter and slip ring can be removed by replacing the EESG with a PMSG, as shown in Fig. 1-3. The PMSG has several advantages over EESG including the elimination of field copper loss, higher power density, light weight, and reduced maintenance [10]. However, the problems such as loss of flexibility of field control and possible demagnetization also arise with PMSG. Although the direct-drive PMSG solution currently has less market than the EESG, recently it is getting more attention and is seen as an attractive solution for the offshore applications.

6

1.1.2 Offshore wind farm configuration
The internal electric systems of large wind farms and grid connection over distances of tens of kilometers creates a number of technical, economical, and environmental challenges for the developers and system operators [1]. Fig. 1-4 shows the basic layout of a large AC offshore wind farm. The wind generators are usually rated at 690V, the wind turbine generator (WTG) is equipped with a step-up transformer for the internal medium voltage grid connection. The internal medium voltage offshore grid is normally rated at 30 kV to 36 kV [11]. The internal medium voltage grids are collected at a central offshore platform, where a transformer is used to step-up the medium voltage in the wind farm to the high voltage AC (HVAC) transmission level. Then, the submarine cable is used for the offshore wind farm connection to the onshore grid.

WTG

WTG

Gear box

Generator

Power converter

HVAC

WTG

WTG Offshore substation

Onshore station

Fig. 1-4 Basic layout of large AC offshore wind farm.



7

Conventionally, the HVAC connection has been used that offers some advantages such as low cost, relatively simple layout, proven technology, etc [12]. Denmark's Horns Rev wind farm, the main European offshore pilot project, constructed in 2002, has a capacity of 160 MW, and was the first plant using an offshore transformer substation [13-15]. This wind farm connected to the onshore grid through a 15 km long three-core AC cable with a rated voltage of 150 kV. Denmark's 165.6 MW Nysted wind farm, constructed in 2004, also with an offshore transformer station, connected to the onshore grid through an approximately 10 km 132 kV AC submarine cable [14, 15]. The United Kingdom's 90 MW Barrow wind farm, which was completed in 2006, also adopts an offshore 33/132 kV substation. It is connected to the onshore grid through a 7 km long AC cable rated at 132 kV [15]. In contrast, the U.K.'s 90 MW offshore wind farms, Kentish Flats located 8.5 km from onshore, and 60 MW offshore wind farm, Scroby Sands located 2.5 km onshore, do not use an offshore substation [15]. However, the long transmission distance between offshore wind farms and the onshore grid may need reactive power compensation on both ends of the cable. Therefore, the conventional HVAC transmission is neither technically nor economically attractive for the long distance offshore wind farm. In this cases, the high voltage DC (HVDC) appears to be the most-suitable option [16-18]. Previous studies have identified the advantages of using the HVDC transmission system based on either the voltage source converter (VSC) [16, 19-21] or the conventional line commutated converter (LCC) [22, 23] for integrating large wind farms to the grid. These advantages include independent active and reactive power control, transmission distance using DC is not affected by cable charging current, etc. However, there has not been any installation of LCC-based HVDC system in combination with wind power.

8

WTG

WTG

HVDC



WTG

WTG
VSC

VSC

Offshore substation

Onshore substation

Fig. 1-5 Basic layout of VSC-HVDC based offshore wind farm. The basic layout of a VSC-based HVDC is shown in Fig. 1-5. The huge offshore substation requirement is the major drawback for the VSC-HVDC. The installed step-up transformer and HVDC converters at central offshore platforms result in high installation and service costs [24, 25]. Furthermore, high dc-link voltage provides a challenge for the VSC-HVDC converters (e.g., converter structure and voltage sharing among switching devices) [26]. Various recent studies [24, 27-34] have adopted a series interconnection of wind turbines for the wind farms in which the step-up transformers and HVDC transmission converters are eliminated. In [27], the interconnecting method with cascaded thyristor converters on the wind farm side and a single thyristor inverter for the grid connection was proposed. However, the generators' large current harmonics cause high torque ripples and grid-side power factor that cannot be governable as well, due to switching devices that are not fully controllable. In [28, 29], the wind farm configuration with a series connected wind turbine was proposed where each wind energy conversion unit consisted of a 3-phase to 1-phase matrix converter, a high frequency transformer and a single-phase AC-DC converter. However, three conversion stages were
9

required for each unit, resulting in system complexity and more switching losses. In [30], the series interconnection of wind turbines obviates the need for an offshore platform. Each wind turbine is equipped with an AC-DC diode rectifier and a DC-DC converter, while the grid connection is accomplished through a line-commutated CSC. However, the diode rectifier produces a large stator current harmonics, and subjects the shaft to unfavorably high torque ripples. In [31], a series connected current source converters on generator-side and single PWM CSC on the grid-side were used. Besides, the cluster consisting of a group of four wind turbines was connected to each converter on the wind farm side. However, such a wind farm would not allow each wind turbine to operate independently for maximum wind power acquisition since turbines are grouped in clusters. Moreover, the failure of one converter would cause all four units in the same cluster to go out of service. In [32, 33], a series DC wind farm was proposed where a group of series connected wind turbines were connected in parallel clusters. The drawback of this configuration is that the DC-DC converters in the wind turbines must have the capability to operate at a very high voltage, in order to compensate for the outage of any wind turbines from the cluster.

1.1.3 Grid fault ride-through
Existing grid connection codes require the fault ride-through (FRT) capabilities for the wind farm. Three-phase short-circuit faults are considered the most challenging case among all the type of faults. In most of the existing wind farms, the ability to ride-through the grid faults is not possible without control or hardware modifications. The FRT requirement, also named lowvoltage ride-through requirement, imposes great challenges to wind farm developers and designers. Recently, considerable research has been carried out to address this issue [23-26].

10

Besides the requirement of wind farm to remain operational during fault, a large amount of reactive current from the wind farm to support grid voltage recovery is also demanded. In a VSC-HVDC-based wind farm, when low-voltage grid fault occurs, the active power output to the grid may be interrupted while the generators are still dumping power to the dc-link. The lack of power output will cause the dc-link capacitors to be overcharged, leading to overvoltage in the HVDC link of the wind farm. Recently, much research has been published about the FRT methods for the wind farm connected through VSC-HVDC [12, 16, 35-39]. In [12, 35], an active power reduction at each wind generator in the wind farm is achieved through power setpoint adjustement during the grid fault. Alternatively, the wind farm output power can be rapidly reduced either by increasing offshore grid frequency [16] and/or grid voltage reduction [36]. In [37, 39], the DC chopper is used to dissipate the excess dc-link power in the breaking resistors. In this technique, the wind farm stays completely unaffected by faults. However, the major drawback is high investment cost due to the large size DC chopper which needs to be rated at full wind farm power. Although, the CSC-based WECS is considered a potential candidate in the medium-voltage high-power ranges [40-42], the FRT methods for such a system have been rarely studied in the literature. In [43], CSC-PMSG-WECS is used, where the controllers for the generator- and grid-side converters can easily be coordinated for the FRT capability.

1.2 Thesis objectives
As indicated in the review, the existing solutions for the large offshore wind farm configuration needs a very huge offshore substation and, therefore, it becomes quite a costly solution. Little research has been reported on alternative solutions for the offshore wind farm

11

system. The main objective of this thesis, therefore, is to develop a new offshore wind farm configuration and system control including fault ride-through capability. 1) CSC-based offshore wind farm configuration investigation The main objective of this work is to investigate the new pulse-width modulated (PWM) current-source converter (CSC)-based offshore wind farm configuration which eliminates the bulky and costly offshore converter substation while retaining all the advantages of a voltagesource converter (VSC)-HVDC-based offshore wind farm. 2) System control schemes According to the literature survey, a little research has been carried out on the CSC-based WECS. The main control objective in the proposed CSC-based offshore wind farm system includes independent MPPT control of the wind generators, dc-link current control, and grid power factor control. Specifically, independent maximum power point tracking (MPPT) control capability under varying wind speed needs to be ensured. In order to lower the operating power losses, the optimized dc-link current control under varying wind speeds also needs to be considered. 3) Grid integration of CSC-based offshore wind farm Compliance with grid connection codes and state of the art technologies for the fault ridethrough (FRT) are to be developed for the proposed CSC-based offshore wind farm. Previous works on FRT have been carried out in the field of the VSC-HVDC based wind farm. The FRT of CSC-based wind farm requires the development of novel method since it is new to the CSCbased wind farm. Therefore, the objective of the thesis is to develop a new control scheme to
12

address the FRT issues, which enables the CSC-based wind farm with full grid connection code compatibility. 4) Mitigation strategy against outage of faulty turbine-generator unit from CSC-based offshore wind farm Besides the fault ride-through, the CSC-based offshore wind farms must ensure the continuous operation of the wind farm when one or more turbines fail to operate. Therefore, the mitigation strategy will be developed to ensure operation continuity against outage of the faulty turbine-generator units. 5) Verification of theoretical analysis and simulations on low power laboratory prototype The proposed CSC-based offshore wind farm configuration and control strategies will be verified on low voltage experimental setups consisting of two PMSGs.

1.3 Thesis outline
This thesis consists of six chapters which are organized as follows. A diagram summarizing the main contents is shown in Fig. 1-6.

Cascaded CSC-based offshore wind farm

Chapter 2 Configuration

Chapter 3 & 4 Control schemes

Chapter 5 Fault ride-through

Fig. 1-6 Thesis organization.
13

Chapter 1 presents the background and introduction of the study.

Chapter 2 presents a detailed review of the recently proposed offshore wind farm configurations. The challenges of the offshore wind farm configuration are discussed. Based on this review, a new cascaded CSC-based offshore wind farm configuration is proposed. The comparative analysis of different configurations is also carried out.

Chapter 3 develops a novel decoupled control scheme for the cascaded CSC-based offshore wind farm. The challenges for the system control are identified. The long distance communication link between generator- and grid-side converters is eliminated and both controllers are completely decoupled. Simulations and experiments are conducted to demonstrate the system performance.

Chapter 4 proposed a coordinated control of the cascaded CSC-based offshore wind farm. In proposed control strategy, the wind farm supervisory control (WFSC) is developed to generate the optimized dc-link current control. This enables all the turbines to independently track their own maximum power point tracking (MPPT) even with inconsistent wind speed. Simulations and experiments are conducted to demonstrate the system performance under inconsistent wind speed.

Chapter 5 investigates the major aspects for the grid integration of a cascaded CSC-based offshore wind farm. A novel fault ride-through strategy is developed to ride through grid lowvoltage faults. The system performance is investigated by simulations. Moreover, the mitigation

14

strategy for the outage of faulty turbines from the CSC-based offshore wind farm is developed. Both simulation and experiment are conducted to demonstrate the system performance.

Chapter 6 summarizes the main contributions and conclusions of the thesis. Possible future research works are also suggested.

15

16

Chapter 2

Offshore Wind Farm Configuration
Offshore wind power can help to reduce the energy imports, air pollution and greenhouse gases (by displacing fossil-fuel power generation) [11]. However, according to the US Energy Information Agency, offshore wind power is the most expensive energy generating technology being currently considered for large scale deployment [44]. The current state of the offshore wind power presents an economic challenges significantly greater than onshore [24]. The turbine represents just one third to one half of the costs in offshore projects today. The rest comes from infrastructure, maintenance, and oversight. The major challenge in building an offshore wind farm is the high capital investment due to the large offshore substation. A huge offshore platform for the large components of the transmission system (e.g., transformers, converter stations) is required. Therefore, the internal electrical system for the offshore wind farm and its grid connection has attracted a great amount of attention for the designer and researcher [1]. This chapter begins with a survey of different transmission systems for the grid connection of large offshore wind farms. It covers high-voltage alternating-current (HVAC) transmission systems, line commutated converter (LCC)-based high voltage direct-current (HVDC) and voltage source converter (VSC)-based HVDC transmission systems. A review of some relevant projects shows the development as well as the state-of-the-art within the field of grid connection systems for wind farms. The detailed review of the recently proposed wind farm configuration

17

consisting of a series interconnected wind generators is discussed. Following that, the cascaded current-source converter-based offshore wind farm configuration is proposed. The comparative analysis for different wind farm configurations is included at the end of this chapter.

2.1 Transmission systems for offshore wind farm
The offshore wind farms are usually located far from the grid connection point. Transmitting power over such a long distance creates challenges for the wind farm developer and the network operator. Fig. 2-1 shows a schematic layout of the offshore wind farm. From the offshore collection point, the HVAC or HVDC [23] transmission link can be used for the onshore grid connection. For HVDC connections, two technical options, LCC based HVDC (LCC-HVDC) and VSC based HVDC (VSC-HVDC), have been reported in the literature [45-47]. In the following subsection, the above options are discussed in more detail.

Wind farm Collecting point HVAC/HVDC Grid interface PCC

Fig. 2-1 Schematic layout of an offshore wind farm.

18

2.1.1 High voltage alternating transmission (HVAC)
Fig. 2-2 shows the schematic layout of the HVAC option for the wind farm grid connection. An HVAC transmission system consists of the following main components: an AC based collector system within the wind farm, offshore transformer stations including static VAR compensator (SVC), three-core polyethylene insulation (XLPE) HVAC cable to shore, and onshore substation possibly with SVC. As shown in Fig. 2-2, offshore wind farm is connected to the onshore grid through 150 kV HVAC cable.

Offshore substation
SVC 150kV

Onshore station
150kV

Offshore wind farm

30kV

150kV XLPE cable Onshore network 400kV
SVC SVC

Fig. 2-2 The basic configuration of an offshore wind farm with a high-voltage alternatingcurrent (HVAC) solution.

HVAC is normally preferred for the wind farm with grid connection distances of less than 50 km, where it provides the simplest and most economic connection method [38]. The main advantage of the HVAC connection is its low-cost substations, since no power electronic devices are required. But with far distant offshore wind farms, the HVAC options have the following disadvantages.

19



The submarine AC cable produces large amount of reactive current due to its high capacitance, typically in the range of 100Â­150 kVAr/km for 33 kV XLPE cables, 1000 kVAr/km for 132 kV XLPE cables [21]. As a result, the active current-carrying capacity of the cable is significantly reduced for larger distances. Therefore, with increasing transmission distances and voltage levels, reactive power compensations are required at both ends, as shown in Fig. 2-2.



The offshore wind farm grid and the onshore main grid are synchronously coupled, and therefore, faults on grid-side may affect the offshore wind farm and vice versa.

Fig. 2-3 shows the single line diagram of Horns rev offshore wind farm. It has a capacity of 160 MW, and was the first plant using an offshore transformer substation. The wind farm consists of 80 Vestas turbines, each rated at 2 MW [13]. Each wind turbine is installed with 690 V/33 kV transformers for internal feeder connections. The geometry of the wind farm is shown in Fig. 2-3, where 10 rows with 8 turbines each in an almost rectangular pattern is used [14]. Due to the short distance from shore, a conventional HVAC transmission link is implemented. The 21 km submarine cable is used for the onshore connection. The cable is rated at 170 kV and consists of three-conductor 630 mm2 cable with copper conductors and dry extruded insulation (XLPE). With an additional onshore cable of 34 km, the total length of the cable connection is 55 km. The reactor of 80 MVar is used to compensate the capacitive reactive current produced by cable. The reactor is located at the connection point between the submarine cable and onshore cable.

20

Wind turbine cluster 16Ã2 MW= 32 MW

~ ~ ~ ~ ~ ~ ~ ~

To four other wind turbine clusters Offshore transformer station Controlled reactor
160 MVA 165/34 kV

Fig. 2-3 Single line diagram of Horns rev offshore wind farm [48].

2.1.2 Line-commutated converters (LCC)-based HVDC
The LCC-based HVDC, also known as the classical HVDC system, employs linecommutated current-source converter with naturally commutated thyristor valves. Such converters need a relatively strong synchronous voltage source to assist the communication of thyristor valves. Also, the conversion process demands reactive power which needs to be supplied from the large AC filter, shunt banks or series capacitor. Moreover, the LCC-HVDC system cannot provide independent control of active and reactive powers [49]. Therefore, this system is less suitable for the offshore wind farm.
21

~

~
HVAC cable
0.4 kV auxiliary supply with 1000 kW/1250 kVA diesel generator

~ ~ ~ ~ ~ ~ ~ ~
150 kV Onshore station

In order to solve the above problems, some researchers have proposed the LCC-HVDC with static compensator (STATCOM) which is also called a `hybrid HVDC'[50]. The STATCOM provides the required commutation voltage as well as the reactive power compensation. A LCCHVDC system with STATCOM is shown in Fig. 2-4. It consists of the following main components: an AC based collector system within the wind farm, an offshore substation with three-phase two-winding converter transformers as well as filters and STATCOM, the HVDC cables and an onshore converter station with a three-phase converter transformer and filters.

Offshore substation
30 kV

Offshore wind farm

STATCOM Filter

Onshore converter station
400 kV, 60 Hz

Cable
Filter

Onshore network

Fig. 2-4 Basic configuration of a wind farm using a line-commutated converter (LCC) highvoltage direct-current (HVDC) system.

Although the reliability of the LCC-HVDC is demonstrated by more than 50 years of service experience on-land, its large footprint due to the huge space requirements for the converter station and auxiliary makes it impractical for offshore application.

22

2.1.3 Voltage source converter (VSC)-based HVDC
Nowadays, the VSC-HVDC system for the offshore wind farm is gaining more and more attention. This system is marketed with the name "HVDC Light" by ABB [51] and "HVDC Plus" by Siemens [52]. A typical example of VSC-based HVDC system for the offshore wind farm application is shown in Fig. 2-5. The offshore substation contains a step-up transformer and wind farm side VSC (WFVSC). The WFVSC collects energy from the wind farm and transmits it to the grid-side VSC (GSVSC) via HVDC cables. The GSVSC transmits available active power to the grid and also provides the reactive power control to the grid. The use of VSC as opposed to a line-commutated CSC offers the following advantages [16, 20]: 1) It is self-commutating and doesn't need an external voltage source for commutation. Therefore, system is possible without synchronous generators or compensators for offshore wind farm application. 2) There is no occurrence of commutation failures due to disturbances in the AC network. 3) It can independently control the active and reactive flow at each AC network. 4) It provides faster dynamic response due to higher PWM than the fundamental switching frequency (phase-controlled) operation, which further results in reduced need for filtering, and hence smaller filter size. These features make VSC-HVDC more attractive compared to LCC-HVDC. However, VSC has higher losses compared to LCC. Further, the free-wheeling diode component of the VSC valve devices will permit the fault current to continue indefinitely, even when the IGBTs are blocked. Therefore the fault can only be cleared by circuit breaker action and this will involve a large delay in restoring normal system operation.

23

Offshore 30 kV wind farm

Offshore substation
WFVSC

Onshore converter station GSVSC HVDC cable +/-150 kV

400 kV

Fig. 2-5 A typical example of an offshore wind farm using VSC HVDC system.

Although the VSC-HVDC based offshore wind farms require fewer auxiliaries than LCCHVDC, it still needs a huge offshore platform to support the step-up transformer and HVDC converters. Table 2-1 shows a summary of commercial HVDC Light installations for on-land and offshore wind farms. The HVDC Light installation on Gotland is the first application where a VSC-HVDC link is used in parallel with the existing AC system. The environmental issues and weak networks on the island of Gotland are the main reasons for the selection of the VSC-HVDC link. With the independent control capability of active and reactive power of the VSC-HVDC, the parallel structure contributes to dynamic stability improvements of the entire local AC network [53]. The Tjaereborg project was used to gain experience for future offshore wind farm project. The Tjaereborg wind farm consists of four wind turbines with a total installed capacity of 6.5 MW, two 2.0 MW wind turbines with doubly fed asynchronous wind turbine generators

24

~

~

Onshore network

(WTGs), one 1.5 MW directly connected asynchronous WTG, and a 1.0 MW with a full converter based synchronous WTG [54]. TABLE 2-1 VSC-HVDC BASED GRID CONNECTION OF WIND POWER
Project name Gotland HVDC Light, Sweden Tjaereborg Denmark Year of commission 1999 Length of DC cable 2 Ã 70 km Submarine cables 2 Ã 4.3 km Submarine cables 2 Ã 125 km Submarine 2 Ã 75 km Underground 2 Ã 75 km Submarine 2 Ã 90 km Underground 2 Ã 45 km Submarine 2 Ã 90 km Underground Power ratings 50 MW -55 to +50 MVAr 7.2 MW -3 to +4 MVAr DC voltage Â±80 kV Topology Semiconductor IGBTs (series connected) On-land wind power On-land wind power (Demo project) Offshore wind farm Offshore wind farm

2-level

2000

Â±9 kV

2-level

IGBTs (series connected)

BorWin 1 Germany

2012

400 MW

Â±150 kV

--

--

DolWin 1 Germany

2013

800 MW

Â±320 kV

--

--

DolWin 2 Germany

2015

900 MW

Â±320 kV

--

--

Offshore wind farm

BorWin 1 wind farm, the world's most remote offshore wind farm, is connected to the German grid by a 400 MW HVDC Light transmission system. It consists of 80 wind generators each of 5 MW, located about 130 km from the coast in the North Sea. The generators feed power into a 36 kV AC cable system which is transformed to 154 kV for the HVDC Light offshore station. The receiving station is located at Diele, 75 km from the coast, where the power is injected into the German 380 kV grid [55]. The Dolwin1 and Dolwin2 offshore wind projects are in planning stage. The 800 MW HVDC Light transmission systems will be used for the grid connection of DolWin1 offshore
25

wind farm to the German grid [56]. The Dolwin1 wind farm will be connected through the 165 km long HVDC cable to ensure a robust network connection. With this transmission link, the voltage range of the HVDC Light system will be extended to 320 kV DC. The Dolwin 2, the world's largest offshore wind power project, will be grid connected by HVDC Light with a total capacity of 900 MW at 320 kV [56].

2.2 Offshore substation
The main constraints that must be addressed in any offshore electrical installation at offshore substations for large offshore wind farms are as follows [19]: a) Limited space: Equipment should be as compact as possible to reduce the overall size and weight. b) Extremely harsh environment: Constant exposure to the salty air and water requires equipment to be located either indoors or in sealed enclosures. c) Auxiliary supplies: The auxiliary supplies in forms of UPS, generators, or battery is required to ensure supply availability for the critical load during very low or no wind condition. d) Limited maintenance access: Accessibility for maintenance is reduced for the offshore application. Therefore, the equipments should be maintenance-free with high reliability. The offshore substation usually needs to accommodate an offshore transformer, HVDC converters and compensator, depending on the type of wind farm configuration. These offshore substations are large, complex and very costly.

26

Fig. 2-6 shows the Horns Rev platform which is a steel building with a surface area of approximately 20Ã28 meters and is placed about 14 m above mean sea level. The Horns Rev offshore substation includes 36 kV switch gear, 36/150 kV transformer, 150 kV switch gear, control and instrumentation system, emergency diesel generator, including 2Ã50 tons of fuel, sea water-based fire extinguishing equipment, staff and service facilities, a helipad, crawler crane, and man over board boat [13].

Fig. 2-6 The Horns rev offshore transformer substation.

2.3 Offshore wind farm configurations
As discussed previously, the major drawback of the LCC-HVDC and VSC-HVDC system is their requirements for the huge offshore substation. Various recent studies [24, 27-34, 57] have
27

adopted a series interconnection of wind turbines for the wind farms which either eliminates or reduces the size of the offshore substation. In the following subsections, some of the recently published offshore wind farm configurations are discussed.

2.3.1 Series DC wind farm
In [32, 33], a series DC wind farm is proposed where a group of series connected wind turbines were connected in parallel cluster, as shown in Fig. 2-7. The advantage of this configuration is that, a suitable DC transmission voltage is achieved without using large offshore HVDC converters. As shown in Fig. 2-7, the VSC-HVDC converter is used for the onshore grid connection. The voltage across each stack vstack remains the same and it is controlled by the gridside VSC-HVDC converter. At the same time, the full bridge isolated boost converter with the pulse-width modulator was employed for the individual wind turbine control, as shown Fig. 2-7. This solution can be implemented with both asynchronous and synchronous type of generators. The major drawback of this configuration is that the converters in the wind turbines must have the capability to operate at a very high voltage, in order to compensate for the outage of any wind turbines from the cluster.

28



istack,1 WT1,2

WT1,1



vWT1,1



istack,2 WT1,m



vWT1,2



istack,m

vWT1,m


WT2,1





vWT2,1

WT2,2





vWT2,2

WT2,m



vWT2,m


vstack




HVDC link

DC AC

PCC

WTn,1





vWTn,1

WTn,2





vWTn,2

WTn,m



vWTn,m


Transmission side component DC/DC converter Rectifier Mechanical and generator system

Protection

AC DC

DC HF AC

HF AC

DC
Breaker 

vtransmission


Fig. 2-7 The series DC wind farm layout [33].

2.3.2 Wind farm configuration based on high frequency link
The wind farm configuration based on a high frequency link is proposed in [28, 29]. The proposed concept can be applied to both parallel and series interconnected wind energy conversion systems, as shown in Fig. 2-8. The series interconnected wind generators can eliminate the need for the offshore substation as shown in Fig. 2-8 (a). Fig. 2-9 shows the each WECS which consists of a 3-phase to 1-phase matrix converter using reverse blocking IGBT, a high frequency transformer, and a single-phase AC-DC converter. The wind generator is
29

controlled by a matrix converter which transforms the three phase sinusoidal voltage waveform to a square high frequency voltage wave form. The high frequency transformer is used for isolation purposes and can be designed to raise the voltage level to reduce transmission losses. And finally, a full-bridge converter transforms the high frequency voltage into a DC voltage.

PMSG

High frequency link High frequency link High frequency link

PMSG

High frequency link High frequency link High frequency link

PMSG

High voltage

PMSG

DC DC Offshore substation HVDC

PMSG

PMSG

(a) series connection

(b) parallel connection

Fig. 2-8 Wind farm configurations using high frequency link.

Matrix converter

HF transformer Full bridge

Clamp circuit

Fig. 2-9 Detailed circuit of high frequency link.

30

However, three conversion stages are required for each unit, resulting in system complexity and more switching losses. Moreover, high switching frequency brings heavy converter losses for the MW ratings WECS used in the offshore wind farm.

2.3.3 Wind farm configuration based on medium frequency (MF) link
Fig. 2-10 shows a wind farm configuration where every wind turbine is connected to a single-phase MF collection grid via a distribution transformer and a cycloconverter, which allows the wind turbines to operate at variable speeds [57, 58]. The collection grid is connected to an HVDC cable via a transmission transformer and a single-phase VSC converter. The MF distribution transformer at each turbine increases the voltage to 32 kV. The single-phase MF collection bus connects the distributed wind turbines to a central offshore substation. The MF transformer was designed to operate at a frequency of 500 Hz. The offshore substation is comprised of a circuit breaker, a single-phase MF transmission transformer and a single-phase VSC. The transmission transformer raises the voltage of the collection grid to 150 kV, which is half the DC link voltage. The high-voltage side of the transformer is connected to a single phase VSC, whereas one of the transformer terminals is connected to the midpoint in the DC link created by bus-splitting capacitors. These capacitors provide the necessary DC voltage source for the dynamics of the system and govern the voltage ripple on the DC line. Series-connected IGBTs with antiparallel diodes and snubber capacitors form the valves of the VSC. Converter switching losses is reduced by applying soft-switching commutation schemes throughout the operating range of the converter. The ground reference of the VSC can be made at the midpoint in the DC link.

31

Circuit breaker Auxiliary power

PMSG
Distribution transformer Cycloconverter

Transmission transformer

PMSG

Installation in the wind turbine: Cycloconverter, MF distribution Transformer and circuit breaker

MF AC bus

Offshore substation: Circuit breaker MF transmission transformer And single-phase VSC

HVDC cable

Fig. 2-10 Wind farm configuration based on medium frequency link.

Compared to conventional three-phase hard-switched VSCs, the proposed single-phase VSC offer considerable advantages [57, 58]. Even though the power rating of the converter remains unchanged, large cost savings are realized by the reduction from three phase legs to a single phase. Both the overall IGBT power rating and the number of series-connected IGBT valves are reduced significantly. This is important as IGBTs are expensive and require complex gate drives and voltage-sharing circuitries when series-connected. In this context it should be pointed out that soft-switching with capacitive snubbers facilitates the voltage sharing between different valves. By using a soft-switching commutation scheme, the switching losses are also reduced considerably. In addition, the reduction to one phase leg may improve the reliability of the VSC. Although the transmission step-up transformer and HVDC converter size is reduced, the offshore substation is still required.
32

2.3.4 Series interconnected wind turbines using thyristor converter

In [27], the interconnecting method with series interconnected thyristor-based current-source converters on the wind farm side and a single thyristor inverter for grid connection was proposed. The system layout is shown in Fig. 2-11. The outputs of each AC generator coupled with the wind turbine are rectified, and these rectified outputs are connected in a series and integrated into the dc-link. The resultant DC output power is converted again to AC power with the thyristor inverter. The synchronous compensator is connected to the inverter through a duplex reactor which provides the reactive power needed for commutation of the thyristor inverter and also support the AC output voltage as per the grid code requirement. The maximum wind power acquisition by wind generators is achieved through thyristor converter firing angle control. Based on the wind velocity measured at each turbine, the system controller generates the firing angle for each thyristor converter.

Thyristor converter #1

PMSG

Thyristor DC reactor inverter DC transmission line Thyristor converter #n

PMSG

Synchronous compensator

Duplex reactor

AC output (to utility or loads)

Fig. 2-11 Series interconnected wind turbines using a thyristor-based current source converter.
33

The high torque ripples produced by the large current harmonics of the generators is major drawback of this system. The torque ripples are undesirable for the PMSGs used for the offshore application, where maintenance cost is very high.

2.3.5 Distributed HVDC configuration for the offshore wind farm
In [30], a series interconnected PMSG-based offshore wind farm configuration was proposed. The system configuration is shown in Fig. 2-12 while individual wind turbine converter topology is shown in Fig. 2-13.

PMSG

AC DC

DC DC DC Ilink AC
Grid

PMSG

AC DC

DC DC

Fig. 2-12 Distributed HVDC based configuration.

B R E A K E R

F I L T E R DC-DC Converter

Ilink

Vo

PMSG

AC-DC Converter

Fig. 2-13 Wind turbine converter topology.

34

Each wind turbine is equipped with an AC-DC diode rectifier and a DC-DC converter, while the grid connection is accomplished through a line-commutated CSC. The DC-DC converter is used to control the wind generator for maximum wind power acquisition. The proposed configuration eliminates the need for an offshore substation. However, the diode rectifier produces large generator current harmonics and subjects the shaft to unfavorably high torque ripples.

2.4 Proposed cascaded current source converter-based offshore wind farm configuration
As mentioned in the review, the VSC-HVDC-based offshore wind farm needs a huge offshore converter substation. In this thesis, a novel PWM CSC-based offshore wind farm configuration is proposed. Fig. 2-14 shows an overall system schematic of the proposed cascaded current-source converter based offshore wind farm [59]. The series interconnected PWM CSCs are employed on both the generator- and grid-side. The number of CSCs on both sides is usually the same and denoted by n. The step-up multi-winding transformers are employed to connect the grid-side CSCs to the grid, providing isolation and grid integration. The variable speed wind turbine driving PMSG is considered in this study. The proposed configuration has all the advantages of a VSC-HVDC-based offshore wind farm such as independent active and reactive power control, black start capability, etc [16]. The additional attractive features of the proposed configuration are listed as follows [59, 60]: 1) This configuration eliminates the need for the HVDC converter and offshore step-up transformer; hence, the wind farm configuration is possible without an enormous offshore converter platform.

35

2) It has fewer numbers of conversion stages compared to the VSC-HVDC-based offshore wind farm, which reduces the conversion loss. 3) It consists of high power medium-voltage PWM CSCs, which proved highly reliable in AC drive application. High-power PWM CSC drives in the megawatt range are widely used in the industry. 4) The multi modular grid-side converters provide higher reliability and maintenance ease in compared to the single grid converter in the VSC-HVDC-based wind farm. 5) The power quality, specifically current harmonics at grid-side, is significantly improved by use of multi-winding transformers at the grid connection point.

Distributed CSCs
PMSG CSC #1 CSC #2

#1

Y Y

Centralized modular CSCs grid multi-winding CSC transformer
#1 CSC #2

#2

HVDC Link

#n

Y 

CSC #n

CSC #n

offshore wind farm

onshore grid connection

Fig. 2-14 Proposed cascaded current-source converter-based offshore wind farm.

Moreover, the operation of the proposed cascaded system will not be interrupted by failure of any turbine-generator unit because the corresponding converter can be easily bypassed by firing its switching devices in any one leg of the converter. In this case, the affected turbine36

generator unit will be isolated from the generation system, while the path for the system dc-link current is provided by a shorted leg of the converter. Furthermore, an IGCT or GTO used in CSC is always short-circuited when it fails and provides the path for the dc-link current [61, 62][33]. These features improve the reliability of the cascaded system. However, the cascade connection of the wind generators needs careful consideration when it comes to the system insulation i.e., the wind generator furthermost from the grounding point must be capable of withstanding whole transmission voltage to the ground. Some of the following approaches can be used for the system insulation [33]. (1) Insulate the generator winding, filter capacitor and CSC for high potential to the ground (2) Insulate the wind turbine tower from high potential to the ground and keep the nacelle on high potential. Since the above solutions seem impractical, a three-phase isolation transformer with star point grounded on the generator-side is considered in proposed system. As shown in Fig. 2.16, high-voltage insulation to the ground is only needed for the transmission side components of the isolation transformer such as CSC and filter capacitors, which are easy to insulate compared to the wind generator. It should be noted that all the converters, filter capacitors and other components used in the system have the same rating, but the insulation level is not uniform. The insulation requirement is reduced for the wind turbine unit located closer to the ground point.

2.5 Conclusions
This Chapter comprises a survey of the offshore wind farm configuration and their connection to the onshore gird. The challenges for the offshore wind farm configuration have been identified. The high capital investment due to the offshore converter substation is a major
37

obstacle for potential growth of the offshore wind farm. In this Chapter, a novel interconnecting method for an offshore wind farm based on cascaded PWM CSCs on both generator- and gridside is proposed. With the converters in cascade to achieve high operating voltages, the proposed method eliminates the need for a bulky and costly offshore converter substation which is usually employed in the VSC-HVDC-based counterpart. Moreover, based on the detailed review of recently proposed offshore wind farm configuration, a comparative analysis is prepared as outlined in Table 2-2. The PMSG with fully rated converter based WTG system is assumed for the HVAC, LCC-HVDC and VSC-HVDC configuration in following comparative analysis.

38

TABLE 2-2 COMPARISON OF DIFFERENT WIND FARM CONFIGURATIONS
Offshore HVDC converter No Thyristor valve based HVDC converter 3- VSC-HVDC converter No DC-DC converter 1- VSC-HVDC converter No Onshore HVDC converter No Thyristor valve based HVDC converter 3- VSC-HVDC converter 3- VSC-HVDC converter 3- VSC-HVDC converter 3- VSC-HVDC converter Thyristor valve based HVDC converter Thyristor valve based HVDC converter Centralized modular CSCs Space requirement for offshore substation small size offshore platform Very huge offshore platform Huge offshore platform No offshore platform Medium size offshore platform Medium size offshore platform No offshore platform No offshore platform No offshore platform Generator insulation requirement Normal Normal Normal High High Normal High

Wind farm configuration HVAC LCC-HVDC VSC-HVDC Series DC based WF High frequency link based WF Medium frequency based WF Series interconnected WTG with thyristor converter Distributed HVDC based WF Proposed cascaded CSC based WF

Black start capability Yes No Yes Yes Yes Yes Yes

Capability for network support No No Wide range Wide range Wide range Wide range Limited

No No

Yes Yes

High High

No Wide range

39

40

Chapter 3

Decoupled Control of Cascaded CSC based Offshore Wind Farm
As introduced in Chapter 2, the proposed cascaded current-source converter (CSC)-based offshore wind farm provides simple wind farm configuration where series interconnected pulsewidth modulated (PWM) CSCs are employed on both the generator- and grid-side. The major control objective on generator-side converters is to extract the maximum power available from the wind turbine, while the control objectives on grid-side converters are the dc-link current regulation and reactive power regulation to fulfill the grid code requirement. This chapter presents a novel decoupled control scheme for the cascaded current-source converter (CSC)-based offshore wind farm. The requirements for the system control are discussed first. The large distance between generator- and grid-side CSC in the proposed wind farm configuration addresses significant challenges for the system control. In order to overcome the challenges, a decoupled grid-side control is developed. The active and reactive power control on the grid-side converters are achieved without any exchange of information from the generator-side controller. Therefore, the long distance communication link between generatorand grid-side converters is eliminated and both controllers are completely decoupled. While the maximum power tracking control is achieved for the generator-side converters that enable full utilization of the wind energy. Following that, the effect of the reactive power regulation on the
41

dc-link current is investigated. Simulation and experimental results for the proposed decoupled control are provided at the end of this chapter.

3.1 Overview of the system control
Fig. 3-1 shows the proposed offshore wind farm configuration, where cascaded currentsource converters are employed on both the generator- and grid-side [59]. The numbers of CSCs on each side are usually the same and are denoted by n. The permanent magnet synchronous generator (PMSG) is considered as a wind generator. The step-up multi-winding transformers are employed to connect the grid-side CSCs to the grid, providing isolation and grid integration. As shown in Fig. 3-1, the monopolar HVDC system is considered.

Distributed CSCs
PMSG

#1

Y Y

CSC #1 CSC #2

Centralized modular CSCs grid multi-winding CSC transformer
#1 CSC #2

#2

HVDC Link

#n

Y

CSC #n

CSC #n

offshore wind farm

onshore grid connection

Fig. 3-1 Proposed system configuration for an offshore wind farm.

42

Since offshore wind speed is usually much stronger and steadier than that inland, nearly uniform wind speed at each turbine is assumed in this study. Therefore, the wind farm is represented by one lumped model of the PMSG as shown in Fig. 3-2. Moreover, the grid-side converter structure consists of the cascaded modular CSCs with all converters of equal rating and regulated by the central controller. Due to the cascade connection, equal sharing of the active and reactive power can be easily achieved among each module through the identical gating signals. Therefore, an aggregate model has been used to develop the control scheme for the cascaded CSC-based offshore wind farm as shown in Fig. 3-2.

Ldc 2
Cable

Ldc 2

idc
iwi vci is vs

ig vcr iwr
PMSG

vdcr
icr
Cr

vdci
ici
Ci

~
Grid

Fig. 3-2 Aggregate model representing the proposed wind farm.

3.1.1 Requirements for the system control
The major control functions for the generator- and grid-side converter and their challenges for the proposed system are discussed as follows.

43

1) Dc-link current control Unlike voltage-source converter based wind energy conversion system (WECS) where the dc-link voltage is usually controlled at a constant value, the dc-link current in the CSC-based WECS can either be controlled as a constant or be varied according to the variation in the input power. The constant dc-link current gives better dynamic response but at the expense of high system losses at low input power. Although the dc-link current can be maintained at the highest level to obtain best dynamic response, the fastest response is usually not required for WECS since the output power is regulated to have slow changes rather than fast transients that may cause power system instability. Moreover, the maximum power generated from the wind turbine is proportional to the cubic of wind speed. In order to extract more energy from the wind, the system requires variable speed operating capability and the generated power varies in a wide range as the wind speed changes. Therefore, it is beneficial for the megawatt system to minimize the dc-link current if the power input is reduced. In contrast, by maintaining high dc-link current at lower power input requires a significant amount of shoot-through states in CSC, causing more conduction loss on the devices and reducing the system efficiency. In a CSC-PMSG-WECS, the reference for the dc-link current is usually obtained from the generator-side controller [41, 42], while in the proposed configuration, the distance between the generator- and grid-side converters may be hundreds of kilometers and large numbers of cascaded converters are used at both sides. Therefore, the long distance communication links between the onshore grid-side converter and to each generator-side controller are required. The reliability and communication delay of the link exhibits considerable challenges for the proposed system. Moreover, the cost of the long distance communication link is also a major concern.

44

2) Generator speed control for maximum power capture As discussed in Chapter 2, the variable-speed wind turbines are able to operate at an optimal rotation speed as a function of the wind speed. The generator-side converter may control the turbine rotation speed to get the maximum possible power by means of a maximum power point tracking (MPPT) algorithm. Previous research has focused on three types of maximum wind power extraction methods, namely tip-speed ratio (TSR) control, hill-climb searching (HCS) control and power signal feedback (PSF) control [63]. The TSR control regulates the wind turbine rotor speed to maintain an optimal TSR [64]. Both the wind speed and turbine speed need to be measured for TSR calculation, and the optimal TSR must be given to the controller. However, the use of the external anemometer increases the cost and decreases system reliability. Moreover, the system control based on the wind speed measurement may cause severe fluctuation in output power. The HCS control has been proposed to continuously search for the peak output power of the wind turbine [65, 66]. It works well only when the wind turbine inertia is very small so that the turbine speed reacts to wind speed almost instantaneously. For large inertia wind turbines, the system output power is interlaced with the turbine mechanical power and rate of change in the mechanically stored energy, which often renders the HCS method ineffective. PSF control requires the knowledge of the wind turbine's maximum power curve [67], and tracking of this curve through its control mechanisms. This maximum power curve needs to be obtained via simulations or tests for individual wind turbines. This strategy can effectively avoid the fluctuation in output power and is easy to execute in practice, which makes it popular.

45

3) Reactive power control on grid-side Like conventional power plants, wind farms are also requested for reactive power regulation capability by many grid codes. In industrial CSC-based AC drive application, selected harmonic elimination (SHE) is usually used for the grid-side converter to eliminate a lower order harmonics [68, 69]. However, due to limited control freedom, the grid-side reactive power cannot be fully controllable. The literature [70-72] has been addressed the line power factor compensation. Unity power factor is obtained in [70] by phase shifting the modulating signals with respect to the converter operating point, which is not straight forward for the grid-side active and reactive power control. In [71], the nonlinear state variable approach in the rotating synchronous frame for independent control of grid-side d- and q-axis current is used. However, the performance based on input-output linearization is affected by the system parameters. In [72], two separate proportional and integral (PI) regulators are designed for the modulation index and phase angle. However, the coupling between the modulation index and phase angle may affect the system performance.

3.2 Decoupled control of cascaded CSC based system
Fig. 3-3 illustrate the block diagram of the conventional control scheme for the CSC-PMSGWECS. The space vector modulation (SVM) pulse-width modulated (PWM) technique is applied on both the generator- and grid-side converter. The generator-side controller is responsible for the MPPT by adjusting the generator speed as a function of the wind speed. Another control freedom on the generator-side controller is used for the optimizing generator operation, such as to minimize generator current or to limit generator terminal voltage, while the dc-link current control on the grid-side converter ensures the power balance in the system.
46

Grid
PMSG

Generatorside converter Gating SVM-PWM
* iwrq
* iwrd

Grid-side converter Gating SVM-PWM
* iwid

* iwiq

MPPT controller

Optimized generator operation

Reference dc-link current
* ( idc )

dc-link current controller

Reactive power controller

Generator-side controller

Grid-side controller

Fig. 3-3 Block diagram of a conventional control scheme for the CSC-PMSG-WECS.

PMSG

Generatorside converter Gating SVM-PWM
* iwrq
* iwrd

Cable

Grid Grid- side converter Gating SVM-PWM
* iwid

* iwiq

MPPT controller

Optimized generator operation

dc-link current controller
* idc

Reactive power controller

Generator-side controller

dc-link power estimation Decoupled grid-side controller

Fig. 3-4 Block diagram of the proposed decoupled control scheme for the cascaded CSC-based offshore wind farm.

47

The actual dc-link current depends on the real power difference between the generator- and gridside converters. Another control freedom on the grid-side controller is used to regulate the reactive power output to the grid to follow the grid code requirements.
* In CSC-PMSG-WECS, the reference dc-link current idc is usually obtained from the

generator-side controller as shown in Fig. 3-3. However, in the proposed configuration, the distance between the generator- and grid-side converters may be hundreds of kilometers and large numbers of cascaded converters are used at both sides. Therefore, the long distance communication links between the onshore grid-converter and to each generator-side controllers are required. The reliability and communication delay of the link exhibit considerable challenge for the proposed system. Moreover, the cost of the long distance communication link is also a major concern. In order to overcome the problem, a new decoupled control for the cascaded CSC based offshore wind farm is developed. The block diagram of the proposed decoupled control scheme for the cascaded CSC-based offshore wind farm is shown in Fig. 3-4. It can be seen that the reference dc-link current is achieved by estimating the dc-link power at the grid-side converter terminal without any information from the generator-side controller. Therefore, the generator- and grid-side controllers are fully decoupled, and the need for the long distance communication link is eliminated, which improves the reliability of the proposed cascaded system. In the proposed decoupled control scheme, the reactive power regulation is achieved by modulation index and delay angle control. The added control freedom of the SVM scheme is utilized to implement a simple PI regulator for the grid power factor control, while the MPPT algorithm based on PSF control is implemented on the generator-side converter. The reference speed for the generator controller is provided through generator power measurement.
48

3.2.1 Generator-side converter control
The generator-side control scheme is shown in Fig. 3-5. The control scheme is developed based on generator-rotor-flux-oriented synchronous frame. As discussed above, the main control objective of the generator-side converter is to control the turbine speed to achieve optimum wind power acquisition and to optimize the generator operation. Fig. 3-5(a) shows the system configuration while the proposed generator-side control is shown in Fig. 3-5(b).

Ldc 2

Ldc 2

vw

Tm Turbine
model

ig
PMSG

iwr
icr

vdcr
Gating

Cable

idc

vdci
Ci

is
Ls

vs

Grid

~

 g , g

Cr

(a) System configuration.

g
Pg

1.5n p f
speed controller

idc
Capacitor current compensation (Eq. 3.4)
 iwrd
 iwrq
2 2 id  iq / idc



 g



Te*

 igq

mr

 igd 0

tan1(iq / id )

r

SVM Gating PWM

r
(b) Proposed control scheme. Fig. 3-5 Block diagram of the generator-side converter control.

A speed PI controller for the variable speed operation is employed in the controller, whose reference is fed from the MPPT algorithm based on maximum wind generator power Pg -versus-

49

* (reference speed) look up table. The outputs of the speed controllers are the reference torque g

* ( Te* ), where the torque subsequently generates the q-axis stator current reference ( igq ). The

* reactive component of the generator current, igd can be set to optimize the generator operation.

For instance, the zero d-axis generator current option offers the minimum generator current with a linear relationship between the generator current and electromagnetic torque. Alternatively, the d-axis can be controlled to operate the generator at a unity power factor. In the proposed control
* scheme, the generator current is minimized by setting igd to zero and leaving only torque

producing current in the winding. This option is simple and straightforward for the control
* system design. As shown in Fig. 3-5 (b), igd = 0 is given directly to the controller and used for

calculation of the capacitor currents and converter PWM currents. The generator speed and torque equation can be written as:

n (T  T ) d g  p m e dt J Te  1.5n p igq f

(3.1)

(3.2)

where n p is the number of pole pairs of the generator; J is the total inertia of the wind turbinegenerator system; Tm is the mechanical torque applied by the wind turbine; Te is the electrical torque produced in the generator. According to the above relations, the speed regulator generates the torque current reference,
* as shown in Fig. 3-5 (b). The generator output power can be derived from the measured speed igq

and generator torque as given in (3.3). The generator torque is estimated from igq (torque
50

component of generator current) which can be obtained from the generator terminal current measurement.

Pg  Teg / np  1.5 f igqg

(3.3)

* * The reference current of the converter bridge, iwrd and iwrq can be obtained as:

* *  iwrd  igd  icrd * *  iwrq  igq  icrq

(3.4)

The capacitor current icrd and icrq can be derived as:

d  icrd  Cr vgd  g Cr vgq   dt  i  C d v   C v crq r gd g r gd  dt 

(3.5)

Assuming that the dynamic characteristic of the capacitor currents, icrd and icrq , have little effect on the system performance, the steady termed are derived by setting differential terms to zero in (3.5).

 icrd  g Cr vgq   icrq  g Cr vgd

(3.6)

*  0 , the reference current of the converter can be obtained as With the help of (3.2),(3.6) and igd

expressed by (3.7).
51

*  Te 2 iwrd  g Cr f  g Rg Cr   1.5n   p f      Te i*  (1   2 L C )  wrq g q r   1.5n     p f   

    (3.7)

By use of (3.7) and considering the maximum modulation index, the magnitude of the converter current indicates the minimum dc-link current requirement from the generator-side converter
* *2 *2 given by: idc _ gen  iwrd  iwrq . While neglecting the term containing the small value of generator

stator resistance R g , the minimum dc-link current requirement in steady-state can be expressed as:

i

* dc _ gen



 C  
2 g r f

2

 Te  (1   Cr Lq )   1.5n  p f 
2 g 2

   

2

(3.8)

3.2.2 Decoupled grid-side converter control
The major control functions of the grid-side converter are to regulate the dc-link current and reactive power to the grid. The control scheme is shown in Fig. 3-6. The system configuration is shown in Fig. 3-6(a), while the proposed decoupled grid-side converter control is shown in Fig. 3-6(b). The controller is developed based on grid-voltage orientation control, where the synchronous frame is oriented to the grid-voltage vector. The dc-link current is affected by both the generator- and grid-side LC parameters and the power flows of the system. The line-side inductance, together with transformer leakage inductance is normally about 0.1 pu. However, the synchronous inductance of a PMSG for high52

power low-speed wind applications is usually above 0.4 pu (per unit) [73], which is much higher than the grid-side equivalent inductance. Therefore, the grid-side filter capacitor is normally larger than that for the generator-side to keep resonance frequency near about 4.0 to 4.5 pu. This may cause a large amount of reactive power produced by the filter capacitor which needs to be absorbed by the grid-side converter. As a result, the dc-link current for the grid-side is higher than that for generator-side. In the proposed grid-side control, the dc-link current control is achieved by estimating the dc-link power at the grid-side converter terminal without any information from the generator-side controller. Therefore, the generator- and grid-side controllers are fully decoupled, and the need for a long distance communication link is eliminated.
Ldc 2 Ldc 2 idc

vw

Turbine Tm PMSG model

Cable

vdcr
Cr

vdci

ii vci is Ls ici
Ci
Gating

vs
PLL

Grid

~

idc

s

(a) System configuration.

idc
2 2 id  iq / idc Gating SVM  PWM  i tan 1 (i / i ) iwiq q d

idc
 iwid  Reference isd dc current  idc Capacitor dc-link current  controller Pdc current (Eq. 3.19)  compensation isq  Reactive power  Qo (Eq. 3.11)  controller 

mi

X

dc-link voltage (Eq. 3.20)

vs

s

 i mi

Qo

(b) Proposed control scheme. Fig. 3-6 Block diagram of the proposed grid-side decoupled control scheme.

53

As shown in Fig.3-6(b), the grid-side controller is composed of two independent control loops for real and reactive power regulation, respectively. The dc-link current regulator adjusts the real power flow while the reactive power controller is implemented to provide reactive power regulation to the grid. The grid voltage vector is aligned with the d-axis synchronous frame which sets the grid voltage with only the d-axis component while the q-axis component equals zero. Therefore, the active and reactive power outputs to the grid can be independently controlled by regulating the current outputs to the grid as follows:

3 3 Po  (vsd isd  vsqisd )  vsd isd 2 2 3 3 Qo  (vsq isd  vsd isq )   vsd isq 2 2

(3.9)

(3.10)

* * The reference current provided by the grid-side converter, iwid and iwiq can be found by:

* * * iwid  isd  icid  isd  s Ci vciq   i*  i*  i  i*   C v s i cid  wiq sq ciq sq

(3.11)

where the steady-state capacitor voltage vcid and vciq can be expressed as:

vcid  Rs isd  s Ls isq  vsd   v  R i   L i s sq s s sd  ciq

(3.12)

54

where Ls represents the grid-side line inductance, while Rs stands for the transformer and line losses. With use of (3.12), the grid-side converter reference current can be derived as

* * * iwid  (1  s 2 Ls Ci )isd  s RsCiisq   i*   C v   R C i*  (1   2 L C )i* s i sd s s i sd s s i sq  wiq

(3.13)

* * The coupled terms s RsCi isq and s RsCiisd can be taken as small disturbances and neglected in

converter currents calculation since Rs is normally very small.

* * iwid  (1  s 2 Ls Ci )isd   i*   C v  (1   2 L C )i* s i sd s s i sq  wiq

(3.14)

The magnitude of the converter reference current from grid-side converter can be derived as,

* *2 *2 idc _ grid  iwid  iwiq mi

(3.15)

When considering the maximum modulation index, mi  1 , the magnitude of the converter reference current indicates the minimum dc-link current requirement as given in (3.16):

* 2  2 idc (1  s 2 LsCi )2 isd  (sCi vsd  (1  s2 LsCi )isq ) _ grid 

(3.16)

Based on the assumption of lossless converter, the dc-link power available at the dc terminal of the grid-side CSC is equal to grid output power Po. Therefore, the value of isd can be derived as

55

Pdc  Po 

3 vsd isd 2

(3.17)

isd 

2 Pdc 3 vsd

(3.18)

With help of (3.10),(3.16) and (3.18), the grid-side minimum dc-link current requirement in steady-state can be obtained as

i i
* dc

 dc _ grid

  2 Pdc    2Qo 2  (1  s LsCi )     sCi vsd  (1  s LsCi )  3 vsd   3vsd   2 2

2

2

(3.19)

3.2.3 Grid converter dc voltage estimation
In (3.19), all the electrical parameters can be detected at the grid-side converters, avoiding the long distance communication link between the generator- and grid-side controllers. The dclink power can be obtained by measuring dc-link current and averaged dc voltage of grid-side converter. However, the average grid-side converter dc voltage vdci is difficult to obtain because of its highly chopped nature. Use of additional sensor with a filter may increase the system cost. Alternatively, the following two methods can be easily employed to estimate the average dc-link voltage at the grid-side converter terminal.

1) Dc-link voltage estimation using converter modulation index and delay angle The dc-link power, Pdc at the grid-side CSC can be obtained from the measured idc and estimated dc-link voltage as given in (3.26).

56

vdci  1.5 VLL mi cos (i )

(3.20)

where VLL is the rms line to line grid voltage, mi is the converter modulation index and  i is the delay angle.

2) Dc-link voltage estimation using dwell time The grid-side controller calculates vdci based on the grid voltage vs and currently active switches. The generator- and grid-side converter both are modulated with a space vector modulated scheme. For example, in sector I, assume that in the given sampling period Ts , the switches S1 and S 2 are on for duration T1 , and switches S1 and S 6 are on for duration T2 . In this case the average value of the grid-converter dc voltage is calculated by:

Sector I:

vdci 

(vao  vbo )  T1  (vao  vco )  T2 Ts

(3.21)

Similarly, grid-side average dc voltage in different sector can be obtained as follows:

Sector II:

vdci 

(vao  vco )  T1  (vbo  vco )  T2 Ts

(3.22)

Sector III:

vdci 

(vbo  vco )  T1  (vbo  vao )  T2 Ts

(3.23)

Sector IV:

vdci 

(vbo  vao )  T1  (vco  vao )  T2 Ts

(3.24)

57

Sector V:

vdci 

(vco  vao )  T1  (vco  vbo )  T2 Ts (vco  vao )  T1  (vco  vbo )  T2 Ts

(3.25)

Sector VI:

vdci 

(3.26)

Similarly, equations can be derived based on the particular switching pattern employed, and the calculations are preferably carried out by the space vector controller since it computes the switching pattern.

3.2.4 Effect of power factor regulation on dc-link current
Like conventional power plants, wind farms are also requested for the reactive power regulation capability by many grid codes [74]. This is affected either by externally providing a specific reactive power value or by a specific power factor. Fig. 3-7 shows the range of the reactive power requirements during normal operation of the wind farm [74]. It can be seen that the wind farm should produce a maximum reactive power of Â±0.33 pu when it delivers rated active power (1 pu) to the grid. This corresponds to a 0.95 lagging and leading power factor, respectively. Similarly, when the wind farm produces an active power of 0.5 pu, it should be capable of providing a reactive power up to Â±0.33 pu, which leads to a 0.835 lagging and leading power factor, respectively. Therefore, the wind farm control should be developed by considering the reactive power regulation capability of the wind farm.

58

Po / Prated (pu)
1.0 0.8 0.6
0.5

0.95 leading p.f.

0.95 lagging p.f.

0.835 leading p.f.

0.835 lagging p.f.

0.4 0.2
-0.33 0 -0.4 -0.3 0.33

-0.2

-0.1

0

0.1

0.2

0.3 Qo / Prated (pu)

Fig. 3-7 Example of reactive power requirements during normal system operation of the wind farm. Both the generator- and grid-side have their own minimum dc-link current requirement as given by (3.8) and (3.19), respectively. As discussed previously, the grid-side converter usually required a larger dc-link current for the reactive power compensation due to the filter capacitor.
* Therefore, the reference dc-link current of the system, idc , is obtained from (3.19) for the proper

operation of the CSC on both sides. However, the grid-side dc-link current is changing with the
* grid reactive power demand, Qo as given in (3.19). As per the grid code, the wind farm should

have reactive power regulation capability even during normal operation as illustrated in Fig. 3-7. Considering the case study with the wind farm operation at unity, 0.95 lagging and 0.95 leading power factor, the minimum dc-link current requirement from both sides under variable

59

wind speeds are plotted in Fig. 3-8. Using (3.8) and (3.19), the dc-link current is plotted for the simulation parameters given in Table 3-1. It can be seen, in the full range of the wind speed, the grid-side demands higher dc-link current than the generator-side for the unity and lagging power factor operation. However, the grid-side dc-link current requirement may become less than the generator-side for the leading power factor operation during the wind speed range from 0.7 to 1.0 pu Therefore, during the leading power factor operation, the generator may not operate for the optimum power due to an insufficient dc-link current. In order to overcome the problem, the reference dc-link current for unity and the leading power factor operation is selected based on the unity power factor curve which ensures the proper operation of both side CSC with desired power factor to meet the grid code requirement.

idc (pu)

* idc _ grid (0.95lagging p.f.)
* idc _ grid (unity p.f.)
* idc _ grid (0.95leading p.f.)

* idc _ gen

v (pu)
Fig. 3-8 Dc-link current requirement with wind speed changes.

60

3.3 System performance investigation by simulations
An aggregate model of the wind farm represented by a single equivalent wind generator has been used in the simulation analysis. The 100 MW wind farm consisting of 40 PMSGs, each of 2.5 MW, is considered whose parameters are listed in Table 3-1. The multisampling space vector modulation scheme is applied on both sides of PWM CSCs [75]. The distributed model of the cable provided by the Matlab/Simulink has been employed for the simulation. The cable length is considered as 80 km and its parameters are taken as resistance 0.0139 /km, inductance 0.159 mH/km and capacitance 0.231 ÂµF/km. A wind turbine model is incorporated to simulate the aerodynamics of wind turbine. The turbine model receives the wind speed and actual speed of the generator, and the MPPT controller provides the reference speed to the control system. The simulation results are provided in Fig. 3-9 to Fig. 3-13. The simulation is used to investigate the system performance for the proposed decoupled control scheme. In order to simulate transient response of the proposed control system, step change as well as ramp increase are applied to the wind speed. In order to simulate the transient response of the proposed system, the wind speed is assumed to have a linear increase from 0.8 pu(9.6 m/s) to 1.0 pu(12m/s) between 3.5s to 4.5s and step-down from 1.0 pu to 0.9 pu at 6s, as shown in Fig. 3-9(a). As a result, the reference speed for the MPPT is changed accordingly as shown in Fig 3-9(b). The actual speed follows the reference speed very well in both steady- and transient-state as illustrated by Fig. 3-9(b).

61

TABLE 3-1 SYSTEM PARAMETERS FOR SIMULATION AND EXPERIMENT Parameters Simulation Experiment

Generator parameters Rated power Rated voltage Rated current Rated speed Grid/Generator frequency Permanent magnet flux Synchronous inductance Number of pole pairs 100 MW 120 kV 482 A 37.5 rpm 60/20 Hz 551.32 Wb 0.4 pu 32 3.6 kW 208 V 10 A 150 rpm 60/20 Hz 0.956 Wb 0.2 pu 8

Converter parameters Generator-side filter capacitor Grid-side filter capacitor Grid-side line inductance dc-link Inductance 0.3 pu 0.5 pu 0.1 pu 1 pu 0.3 pu 0.5 pu 0.1 pu 1 pu

62

vw (pu)

t (sec)

(a) wind speed

 g (pu)
* g

g

t (sec)

(b) Generator speed

Fig. 3-9 Generator speed in response to change in the wind speed.

The real and reactive power at the onshore grid-side for the given wind speed is shown in Fig. 3-10(a) and (b), respectively. While significant change in real power is observed with change in wind speed, the reactive power is maintained at zero for either steady- or transientstate operation, and the unity power factor is kept regardless of the amount of real power. It can be observed that small change in wind speed from 0.8 pu to 1 pu cause real power increases to about rated power from its previous value at half the rated output power.

63

Pgrid (MW)

t (sec)

(a) Grid active power output

Qgrid (MVar)

t (sec)

(b) Grid reactive power output

Fig. 3-10 Grid output power in response to change in the wind speed.

However, the high inertia of the turbine-generator system causes slow change in output power in response to sharp wind speed change at 6 sec. The dc-link current variation in response to the change in wind speed is shown in Fig. 3-11(a). The large variation in output power causes considerable change in the dc-link current. This justifies the minimized dc-link current control which significantly improves the system efficiency. The estimated dc-link voltage at the gridside converter terminal is shown in Fig. 3-11(b).

64

idc (A)

t (sec)

(a) Dc-link current

vdci (kV)

t (sec)

(b) Estimated grid converter dc voltage

Fig. 3-11 System dynamic response with change in wind speed.

In Fig. 3-12(a) and (b), the grid-side controller modulation index and firing angle are displayed. As observed in Fig. 3-12(a) the grid-side modulation index remains near unity in steady-state. Therefore, the dc-link current is minimized in steady-state when the modulation index of the grid-side converter is maintained near unity. In order to maintain the desired power factor, the converter firing angle is adjusted accordingly to compensate for the reactive power generated by the filter capacitor. Fig. 3-12(b) shows the change in the firing angle to maintain the unity power factor at the grid.

65

mi

t (sec)

(a) Grid-side controller modulation index

 i (rad)

t (sec)

(b) Grid-side controller firing angle

Fig. 3-12 Grid-side controller response to change in wind speed.

The steady-state grid phase voltage and current waveforms for the unity, leading and lagging power factor operations, are shown in Fig. 3-13(a),(b) and (c), respectively. This shows the reactive power regulation capability of the proposed system. It is noted that the current direction is defined by generation convention, as marked in Fig. 3-6 (a).

66

vs , is (pu)

vs is

t (sec)

(a) Unity power factor operation

vs , is (pu)

vs is

t (sec)

(b) Lagging power factor operation

vs , is (pu)

vs is

t (sec)

(c) Leading power factor operation

Fig. 3-13 Steady-state grid phase voltage and current waveforms.

3.4 Experimental verification
The proposed decoupled control scheme has been verified on a low-power prototype of PMSG-based WECS using gate-turn-off thyristor based CSC. The photo of the low voltage laboratory experimental setup of a CSC-PMSG-WECS is shown in Fig. 3-14.

67

Grid-side PWM CSC

Generator-side PWM CSC

Prime-mover controller Main Controller

Prime-mover PMSG

Fig. 3-14 Photo of low voltage laboratory experimental setup of a CSC-PMSG-WECS.

68

The parameters of the experimental setup are listed in Table 3-1. The system control platform consists of a fixed-point digital signal processor (DSP) for control scheme realization and field-programmable gate array (FPGA) for gating and fault handling. Both steady- and transient-state performance are tested on the prototype. The prime-mover of the setup is a permanent-magnet synchronous machine controlled in torque producing mode according to the given reference, regardless of the generator speed. This condition is different from the wind turbine model used in simulation where MPPT control gives the reference speed. In the experiment, the generator operates in speed control mode to follow the reference speed given externally from the computer. The experimental results obtained from the prototype system are shown in Fig. 3-15 to Fig. 3-18. In Fig. 3-15, the speed reference of PMSG is step-down from 0.9 pu to 0.7 pu (135 rpm to 105 rpm), while the mechanical torque provided by the prime-mover is kept constant. It can be seen that the actual speed of the PMSG follows the reference very well in both steadyand transient-state. The grid active and reactive power waveforms are illustrated in Fig. 3-15. This shows that the speed variation of PMSG results in output power changes from 2000 W to 1500 W, while the reactive power is maintained at zero in both steady- and transient-state operation. This verifies that the unity power factor is maintained in both operating conditions while real power changed significantly. In Fig. 3-16, the dc-link current and estimated dc-link voltage at the grid-side converter are displayed. Due to the output power variation of PMSG, the dc-link current is changed accordingly which is evident from Fig. 3-16. This shows the change in dc-link current from 12.5 A to 10.5 A. The significant variation in dc-link current with output power justifies the minimized dc-link current control which effectively improves the system efficiency.

69



* g

g

Pgrid
Qgrid

500 ms

* Fig. 3-15 Measured system dynamic responses: reference speed  g (30 rpm/div), generator speed

 g (30 rpm/div), grid side real power Pgrid (1 kW/div) and grid side reactive power Qgrid (1
kVAr/div).

idc

vdci

500 ms

Fig. 3-16 Measured system dynamic response: dc-link current idc (2 A/div) and dc-link voltage

vdci (60 V/div).

The variation in dc-link voltage from 170V to 150V at grid-side converter is shown in Fig. 3-16. In Fig. 3-17 (a) and (b), the grid-side converter modulation index and firing angle are displayed.
70

mi

500 ms

(a) Grid-side controller modulation index mi (0.2 unit/div)

i

500 ms

(b) Grid-side controller firing angle  i (0.6 rad/div)

Fig. 3-17 Measured grid-side converter controller response.

As shown in Fig. 3-17 (a), the modulation index at the grid-side converter is maintained near unity which helps to reduce the total system loss. Since the dc-link current is minimized in steady-state when the modulation index of the grid-side converter is maintained near unity. The firing angle of the grid-side converter is adjusted to compensate for the reactive power generated by filter capacitor.

71

vs is

Qgrid
5 ms
(a) Unity power factor operation

vs is

Qgrid
5 ms
(b) Leading power factor operation

vs is

Qgrid
5 ms
(c) Lagging power factor operation

Fig. 3-18 The steady-state grid phase voltage v s (100 V/div), line current is (10 A/div), and grid reactive power Q grid (1 kVAr/div) with different power factor operation of the wind farm.

72

Fig. 3-17 (b) shows the change in firing angle with output power to maintain the unity power factor at the grid-side. The steady-state grid-side phase voltage and current for unity, leading and lagging power factor operation with corresponding grid reactive powers are shown in Fig. 3-18 (a)-(c), respectively. It is noted that the current direction is defined by generation convention, as marked in Fig. 3-6 (a).

3.5 Conclusions
In this chapter, a new decoupled control scheme for the cascaded CSC based offshore wind farm is developed. The main conclusions are given as follows. The proposed control strategy decouples the active and reactive power control for the gridside converters. To minimize the power losses of the proposed wind energy system, a minimal dc-link current control scheme is proposed. More importantly, the dc-link current control is achieved by measuring the dc-link power of the grid-side converters without any information from the generator-side controller. Therefore, the generator- and grid-side controllers are fully decoupled, and the need for long distance communication link is eliminated, which improves the reliability of the proposed cascaded system. While the maximum power tracking control is achieved by the generator-side converters that enable full utilization of the wind energy. The effect of the reactive power regulation capability of the grid-side converter on the dclink current is identified. In addition, the reactive power regulation at the grid is considered for the dc-link current reference calculation which allows the wind farm to operate at the desired power factor to meet the grid code requirement.

73

The proposed control scheme has been verified in simulation on an aggregate wind farm model and in experiments on a low-voltage laboratory prototype system. The main features of the wind farm control including MPPT control, dc-link current, and power factor regulation are verified by simulation and experimental results.

74

Chapter 4

Coordinated Control of Cascaded CSC Based Offshore Wind Farm
In Chapter 3, the control strategy is developed assuming uniform wind speed at each turbine in the wind farm. Considering the different wind speed at each wind turbine, each unit will generate different output power. Therefore, each generator-side current-source converter (CSC) needs different dc-link current requirement for the maximum power generation. However, the dc-link current in all CSCs is inevitably same due to the cascade connection. This exerts a considerable challenge for the system control under varying wind speed. Considering the inconsistent wind speed at each turbine, a coordinated control scheme for the cascaded CSC-based offshore wind farms is proposed in this chapter. In proposed control strategy, the wind farm supervisory control (WFSC) is developed to optimize the dc-link current control. This enables all the turbines to independently track their own maximum power point tracking (MPPT) even with inconsistent wind speed. The complete wind farm control is presented with individual wind turbine control, WFSC and centralized grid-control. Following that the system performance is investigated by simulations for inconsistent wind speeds at each turbine. Also, the experimental verifications are carried out on the laboratory prototype of the cascaded CSC-based system consisting of two permanent magnet synchronous generators (PMSGs).
75

4.1 Coordinated control of the wind farm
As discussed in Chapter 2, the proposed offshore wind farms with cascaded PWM-CSCs at both generator- and grid-side can eliminate the need for a bulky and costly central offshore converter platform. Fig. 4-1 shows the proposed wind farm configuration with different wind speeds at each turbine. As shown in Fig. 4-1, the number of cascaded generator- and grid-side CSCs is equal and denoted by n. The PMSG is considered as a wind generator in the proposed system.

PMSG

v1 v 2

#1

Y 

CSC #1 CSC #2

grid multi-winding CSC transformer
#1 CSC #2

#2

Y 

HVDC Link

v n

#n

Y 

CSC #n

CSC #n

offshore wind farm

onshore grid connection

Fig. 4-1 Proposed offshore wind farm configuration with different wind speed at each turbine.

The inconsistency of wind speed will cause each generator-side converter to have its own requirement for the dc-link current according to its generated power. However, due to the cascade connection, the dc-link current through all the CSCs is inevitably the same. This therefore addresses a considerable challenge for the system operation. The dc-link current may be maintained at its highest level for the proper operation of all CSCs, though at the expense of
76

high power losses. Moreover, independent MPPT for the each turbine should be ensured under inconsistent wind speed. In order to overcome the above challenges, the coordinated control is developed for the cascaded CSC-based offshore wind farm.

i

* wr1

Pg*1 P
* gn

Pg1 Turbine and Pg*1 generator control unit #1 monitoring signal

 Maximum power mode  Power limitation mode

Pcmd
P WF

mode
Q
* o

Qcmd ngrid
P WF   ( P gi )
i 1 n

Qcmd

Pcmd
Qcmd

System operator

Total available wind farm power

vs
* Qo

Turbine and * generator control Pgn unit #n monitoring signal

* iwrn Pgn

dc-link current optimization

idc _ gen  max(i , i
* wr1

* wr 2

,....., i

* wrn

)
2

* idc

 2P WF iwi  (1  s 2 Lo Ci )2   3n v  grid ds

  2Q    C v  (1  s2 Lo Ci ) o     s i ds 3 vds   

2

Centralized grid-side converter control

monitoring signal

* idc  max(idc _ gen , iwi )

wind farm supervisory control (WFSC)

Fig. 4-2 Block diagram of the proposed coordinated control for the cascaded CSC-based offshore wind farm.

Fig. 4-2 shows the block diagram of the proposed coordinated control scheme [76]. The proposed control can be divided into three control units: WFSC, individual turbine-generator control, and centralized grid-side control. The WFSC acts as a single centralized unit, which has inputs from system operator orders, available power from each turbine generator unit, monitoring signals from each turbine-generator and grid-side converter unit, and measured grid voltage at the wind farm grid connection. Similar to a conventional power plant, the wind farm should operate in a different type of active power control mode such as balanced control, delta control,
77

power rate limiter, and the frequency control mode [77]. The wind farm controller receives the desired type of control objective from the system operator. The main control objectives of the proposed coordinated control are as follows: 1) Independent MPPT with inconsistent wind speed. 2) Optimized dc-link current control for system loss minimization. 3) Active power control for each generator-side converter and reactive power control for the grid-side CSCs.

The following section comprehensively identifies the dc-link current requirements of each turbine-generator unit for inconsistency of wind speed and ensures its independent MPPT control capability. An optimized dc-link current control algorithm is proposed for the cascaded CSCsbased system to achieve the lowest operating power losses and for the independent MPPT for each turbine-generator unit. Moreover, active and reactive power control for the offshore wind farm is investigated.

4.2 Active and reactive power control of the wind farm
The WFSC generates an active power reference for each turbine-generator controller according to the total active power demand from the system operator. The WFSC operates the wind farm either in maximum power mode or power limitation mode according to the system operator's demands. In maximum power mode, every wind turbine in the wind farm is allowed to operate in MPPT control mode to explore the maximum wind power. The second mode is the power limitation mode (e.g., balance control, delta control), in which the wind farm is required to operate at a certain amount of power specified by the system
78

operator. Specifically, the wind farm has to operate with a certain constant reserve capacity in delta control mode, which can be used in frequency regulation. In the proposed system, the system operator sends the reference for the reactive power
* demand Qcmd at the grid connection point to the WFSC. Then, reactive power reference Qo for

each grid-side converter is generated based on equal distribution of reactive power as given by:

* Qo 

Qcmd ngrid

(4.1)

where ngrid is the number of grid-side converters in operation, which can be obtained from the status of the grid-side converters' monitoring signals.

4.3 Optimized dc-link current control
As discussed previously, the inconsistency of wind speed will cause each generator-side converter to have its own requirement for the dc-link current according to its generated power. Unlike a VSC-based wind farm where the dc-link voltage is usually controlled at constant value, the dc-link current in a CSC-based wind farm can be varied according to the variation in the input power. The variable dc-link current significantly reduces system losses during low wind speed. The WFSC is used to generate optimized dc-link current control algorithm which ensures the maximum power tracking by each wind-turbine generator while the active power balance and reactive power requirement of each grid-side converter.

79

4.3.1 Minimum dc-link current requirement from offshore side converters
Fig. 4-3 shows the control scheme for the PMSG #n, which is developed based on rotorflux-oriented synchronous frame. The control scheme is enabled to operate the wind farm either in maximum power mode or in power limitation mode (e.g., for network frequency regulation [77]). Although the function of these two modes is different, their control schemes share the same generator-side converter control strategy. The main focus of this chapter is to develop optimized dc-link current control for the cascaded CSC-based offshore wind farm. Therefore, the power limitation mode of the wind farm is not discussed and only the maximum power mode is considered.
idc v1
PMSG #1

PWM CSC #1

vdcr1

 g1

v n

PMSG #n

ign

vgn
icrn
Cr

iwrn

PWM CSC #n

vdcrn

 g1

n

abc / dq
vgdn , vgqn

gating
SVM PWM

Maximum power mode

gn

 gn 

mrn

i
Speed controller Power regulation

 gdn

 rn

0
 igqn

v n
WFSC

MPPT




Capacitor i 2 2 id  iq / idc current  iwrqn 1 compentan (iq / id ) sation

 wrdn

 Pgn



Pgn

Power limitation mode

Operation mode WFSC

Fig. 4-3 Generator-side converter control scheme.

80

Wind speed availability at each wind turbine may be different and the wind velocity at turbine #n is assumed to be vwn . In optimum operation, the maximum mechanical power Pm_max and corresponding optimal torque Tm_opt of the turbine can be defined as [78]

3   Pm _ max  K p (gn )  2  Tm _ opt  KT (gn )

(4.2)

where  gn is the optimum wind turbine speed in rad/s and the constants Kp ,KT can be obtained from the aerodynamic characteristic of the wind turbine. Since direct driven PMSG-based wind energy conversion system (WECS) is considered, the turbine and generator rotor angular speed are the same. The leakage inductance of the transformer is normally very small compared to synchronous inductance of the PMSG. Therefore, in control system design, the generator-side transformer is neglected. The generator controller receives the reference speed from the MPPT block and regulates the PMSG speed accordingly. The speed controller is used to generate q-axis current
* reference igqn (representing the torque).

By considering the electromagnetic torque ( Ten) to be equal to the optimum mechanical torque of the turbine (Tm_opt) in steady-state, the q-axis generator current can be obtained from (A.13) and (4.2) as

igqn 

KT (gn )2 1.5n p f

(4.3)

81

* With the help of (4.3) and, the igdn =0, the reference current for the converter bridge can be

expressed as

* iwrdn  n pgnCr vgqn  KT (gn ) 2 *  n pgnCr vgdn iwrqn  1.5n p f 

(4.4)

Using (4.4), the magnitude of the reference converter current in steady-state can be expressed as

iwrn  

2 n

 KT (n Cr f )    1.5 n f p 
2 p 2

 2 2 (1  n 2  p gn Ld Cr )  

2

(4.5)

Considering the maximum modulation index, (4.5) shows the minimum dc-link current requirement for the CSC connected to PMSG #n in steady-state. Similarly, the dc-link current requirement of each CSC on the generator-side depends on the optimum speed of the wind turbine (i.e., wind speed at each turbine). The WFSC block shown in Fig. 4-2, collects the observed data of each generator-side
* converter reference current iwri , (where i = 1,2,...,n). Due to wind speed inconsistency, each

generator rotates with its own optimum speed to converge maximum wind power, and therefore each converter has a different converter reference current. For the proper operation of all converters on the offshore side, the dc-link current must be equal to or higher than the maximum magnitude of the converter reference current.

* * * idc _ gen  max(iwr 1 , iwr 2 ,....., iwrn )

(4.6)

82

Equation (4.6) indicates the minimum dc-link current for optimum wind power acquisition by all wind turbines when considering different wind speeds. Moreover, the WFSC receives the generated power information from each turbine-generator unit and calculates total wind farm power PWF.

P WF   ( P gi )
i 1

n

(4.7)

4.3.2 Minimum dc-link current requirement from grid-side converters
The main control objectives for the grid-side converters are to regulate the dc-link current and reactive power to the grid. All the grid-side converters are of equal rating and regulated by the same central controller as shown in Fig. 4-4. Due to the series connection, equal sharing of active and reactive power can be easily achieved among each module through identical gating signals. As illustrated in Fig. 4-4, grid-voltage orientation is employed where the grid voltage vector is aligned with the d-axis. The outputs of the dc-link current and reactive power controllers are d* * axis grid current reference ( isd ) and q-axis grid current reference ( isq ), respectively. After the

* * , iwiq grid-side filter capacitor current compensation, the converter reference current ( iwid ) is

obtained as
* 2 *  iwid  (1  s LoCo )isd  2 *  iwiq  s Co vsd  (1  s LoCo )isq 

(4.8)

83

idc

grid
PWM CSC #1

PWM CSC #n

iwi

vci is ici
Ci

Lo

vs

gating#n

PLL

abc / dq
vcid , vciq vsd , vsq  s
(a) System configuration.

idc
 idc

dc current controller Reactive power controller

 isd

 iwid

WFSC

 Qo

 isq

Capacitor current compensation

i  i / idc
2 d 2 q

mi
SVM PWM

gating#1 gating#n

 iwiq

tan 1 (iq / id )  i

Qo

s
(b) converter control scheme.

Fig. 4-4 Grid-side converter control scheme.

The modulation index mi and delay angle  i are calculated from the grid converter reference current, and gating signals are generated using SVM. Based on available wind farm power information and reactive power demand from the system operator, the WFSC derives the dc-link current requirement for each grid-side converter as follows. Assuming a lossless system, the total available wind farm power should be equally shared by each grid-side converter.

84

P 3 WF  vsd isd ngrid 2 3 * Qo   vsd isq 2

(4.9)

(4.10)

With (4.9) and (4.10), the magnitude of the grid-side converter reference converter current can be obtained as

 2P WF iwi  (1  s LoCi )   3n v  grid sd
2 2

  2Q    s Ci vsd  (1  s2 LoCi ) o    3 vsd   

2

2

(4.11)

Considering maximum modulation index, (4.11) shows the minimum dc-link current requirement for the grid-side converter in steady-state.

4.3.3 Reference dc-link current
The WFSC obtains the reference dc-link current by comparing the minimum dc-link current requirement for the offshore generator-side (4.6) and onshore grid-side converters (4.11). The
* larger one is used for the reference dc-link current idc as given by

* idc  max(idc _ gen, iwi )

(4.12)

By fully considering the minimum dc-link current requirement of each generator, the system can use (4.12) as a reference current to ensure each generator operates at its own maximum power.

85

4.4 System performance investigation by simulations
In order to verify the effectiveness of the proposed coordinated control scheme for the cascaded CSC-based offshore wind farm, a digital simulation is carried out for a wind farm as shown in Fig. 4-5. The wind farm, consisting of two turbine-generator units, is considered to reduce the simulation time. Each PMSG are rated at 2.5 MW/3000 V. The multi-winding transformer is used for the grid connection. The main simulation parameters are listed in Table 4-1. The gating signals for the converters on both sides are generated through the SVM technique with device switching frequency of 540 Hz. Each PMSG is mechanically driven by its own wind turbine for which the wind speed is deliberately set different.

Pg1
v1
PMSG #1 Cr PWM CSC#1

Ldc / 2
PWM CSC#1

Po1
Ci

Lo

grid

idc

Pg 2
v 2
PMSG #2 C r PWM CSC#2 PWM CSC#2

Po 2
Ldc / 2

Y Y 
Lo

Ci

Fig. 4-5 Block diagram of the cascaded CSC-based WECS with inconsistent wind speed at each turbine.

86

TABLE 4-1 SYSTEM PARAMETERS FOR SIMULATION AND EXPERIMENT Parameters Experimetnal setup PMSG#1 PMSG#2 Generator parameters 2.5 MW 3.6 kW 2.08 kW 3000 V 208 V 170 V 481 A 10 A 7.5 A Simulation 60/20 Hz 60/20 Hz 60/60 Hz

Rated power Rated voltage Rated current Grid/generator frequency Permanent magnet flux Synchronous inductance Pole pairs dc-link inductance Generator-side capacitor Grid-side capacitor Grid-side line inductance

0.245 Wb 13.78Wb (1 0.956 Wb pu) (1 pu) (0.94 pu) 11.45mH 19.1mH 13.88mH (0.4 pu) (0.2 pu) (0.4pu) 32 8 2 Converter parameters 28.6mH 95 mH 40 mH (1 pu) (1 pu) (1.08 pu) 200ÂµF 60 ÂµF 663ÂµF(0.3 pu) (0.3 pu) (0.31 pu) 368.4ÂµF (0.5 120 ÂµF (0.345 pu)* pu) 0.95mH(0.1 3 mH (0.15 pu)* pu)

(*single grid-side converter where converter parameters are based on total rated power 5.68kW and 208V)

87

The simulation results are illustrated in Fig. 4-6 to Fig. 4-8. The wind disturbance is introduced for the wind-turbine connected to PMSG#1, with a speed stepped down from 1 pu to 0.9 pu (12 m/s to 10.8 m/s) at 7 sec, while the wind speed is kept constant at 0.8 pu for the other wind turbine. The main objective of the simulation analysis is to investigate the system performance under different wind speeds at each turbine. In particular, the independent MPPT of the each turbine and optimized dc-link current will be investigated.

 g (pu)

 g1

* g 1

g 2

* g 2

t (sec)
(a) Reference and actual speed for PMSG #1 and PMSG #2

Pg1 , Pg 2 (MW)
Pg1

Pg 2
t (sec)
(b)Output power of PMSG #1 and PMSG # 2

Fig. 4-6 System dynamic response with step change in wind speed at PMSG#1.

88

The reference speed for the MPPT control and actual speed of PMSG#1 and PMSG #2 are shown in Fig. 4-6 (a). The speed of PMSG#1 closely tracks its reference speed even suffering wind disturbance, while the speed of PMSG #2 is not affected by the wind speed variation of the other turbine. The output power of PMSG#1 responds quickly to the wind speed variation of its turbine, while that of PMSG #2 remains almost unchanged due to its constant wind speed.

Po1,Po2 (MW)

Po1  Po 2

t (sec) (a) Equal sharing of active power by grid-side CSCs
Pgrid (MW),Qgrid (MVAr)

Pgrid
Qgrid

t (sec)

(b)Grid active and reactive power

Fig. 4-7 Grid output powers in response to step change in wind speed for the wind turbine connected to PMSG#1.

The output power of PMSG#1 and PMSG #2 is shown in Fig. 4-6(b). The output power of PMSG#1 responds quickly to the wind speed variation of its turbine, while that of PMSG #2

89

remains almost unchanged due to its constant wind speed. These generator responses reveal that independent MPPT control of each wind turbine is feasible in a cascaded CSC-based wind farm regardless of the wind speed at each turbine location. The grid- side converters share equal active power, which can be illustrated by both grid-side converters' output power as shown in Fig. 47(a).

vdcr1, vdcr2 (kV)

vdcr1

vdcr 2
t (sec)

(a) Generator-side converters dc-output voltage
idc (A)

idc

t (sec)

(b) Dc-link current

Fig. 4-8 Generator-side CSCs dc-output voltage and dc-link current in response to step change in wind speed for the wind turbine connected to PMSG#1.

In Fig. 4-7(b), total active and reactive power injected to the grid is shown. The reactive power is maintained at zero for either steady- or transient-state operation, and the unity power

90

factor is kept regardless of the amount of real power. The unity power factor at the grid connection point is achieved by setting the reactive power references Qo* to zero for each gridside converter. Fig. 4-8(a) shows the average dc-output voltage across each generator-side CSC. Fig. 4-8(b) shows the dc-link current waveform in response to the change in wind speed. The large variation in the dc-link current with different wind speeds justifies the minimized dc-link current control, which significantly improves the system's efficiency

4.5 Experimental verification
A low-power wind farm prototype consisting of two PMSGs in cascade connection using GTO based CSCs are developed for the experimental verification. The block diagram of experimental setup is the same as shown in Fig. 4-5 except only one grid-side converter is employed in order to reduce experimental complexity. The block diagram of experimental setup is shown in Fig. 4-9 and the photo of the laboratory setup is shown in Fig. 4-10.

Pg1
PMSM #1 PMSG #1 Cr PWM CSC#1

Ldc / 2

grid

Po1
PWM CSC#1

Lo

idc

Y 

Pg 2
PMSM #2 PMSG #2 Cr PWM CSC#2

Ci

Ldc / 2

Fig. 4-9 Block diagram of the laboratory experimental setup.

91

Grid-side Generator-side PWM CSC#1 PWM CSC#1

Generator-side PWM CSC#2

b

e

prime mover #1

PMSG #1

PMSG #2

Prime mover #2

a

d

c

g

f

Fig. 4-10 Photo of a Laboratory experimental setup: (a) prime mover #1 and PMSG#1 (b) DSP-FPGA based controller for PMSG#1 (c) DSP-FPGA based controller and VSC for prime mover #1 (d) prime mover #2 and PMSG #2 (e) DSP-FPGA based controller for PMSG #2 (f) DSP-FPGA based controller and VSC for prime mover #2 (g) generator- and grid-side CSCs.

92

Due to the same rating and centralized control of the grid-side converters, each module has the same function and one converter is utilized at the grid-side, which will not affect generatorside operations. The PMSG#1 is rated at 3.6 kW/208 V while the PMSG#2 is rated at 2.08 kW/170 V. The main experimental parameters are listed in Table 4-1. In the experimental setup, the two sets of PMSGs are cascade connected as shown in Fig. 4-9. The permanent-magnet synchronous machines are used as prime-movers for both PMSGs. The prime-movers operate in torque producing mode while both PMSGs operate in speed control mode. Two generator-side converters, one each for PMSG#1 and PMSG#2, are cascaded while one converter is used for the grid connection. System controls are implemented on a platform consisting of a DSP and a FPGA-based platform as shown in Fig. 4-10. The experimental results obtained from the laboratory prototype system are shown in Figs. 4-11 to 4-14. As shown in Fig. 4-11(a), the speed reference of PMSG#1 is stepped down from 0.75 pu to 0.6 pu(112.5 rpm to 90 rpm) while the corresponding torque provided by the primemover is kept constant. During this period the speed reference for PMSG#2 is kept constant at 0.9 pu(1620 rpm). Figs. 4-11 and 4-12 shows that the actual speeds of PMSG#1 and PMSG#2 follow their corresponding references very well in both steady- and transient-state. The speed variation of PMSG#1 results in the output power changes from 1700 W to 1300 W as shown in Fig. 4-11 while the output power of PMSG#2 remain constant at 600 W as shown in Fig. 4-12. The variation in average dc output voltage of the generator-side converters CSC#1 and CSC#2 are shown in Fig. 4-13(a) and (b), respectively.

93

 g1
* g 1

Pg1

1s

Fig. 4-11 Measured system dynamic response with step change in speed reference for PMSG#1;
* reference speed  g 1 and actual speed  g 1 for PMSG#1 (22.5 rpm/div), and output power from

PMSG#1 Pg1 (1000 W/div).

* g 1 * g 2

g 2

Pg 2

1s

Fig. 4-12 Measured system dynamic response with step change in speed reference for PMSG#1;
* * reference speed  g 1 for PMSG#1 (45 rpm/div), reference speed  g 2 and actual speed  g 2 for

PMSG#2 (1000 rpm/div), and output power from PMSG#2 Pg 2 (500 W/div).

94

vdcr1

1s
(a) Average dc output voltage of generator-side CSC#1, vdcr1 (30 V/div).

vdcr 2

1s
(b) Average dc output voltage of generator-side CSC#2, vdcr 2 (30 V/div).

Fig. 4-13 Measured average dc output voltage for generator-side converters with step change in speed reference of PMSG#1. Due to the output power variation of PMSG#1, the requirement of a minimum dc-link current will change accordingly, which is evident from Fig. 4-14(a) with the dc-link current changing from 14 A to 12.5 A. In Fig. 4-14(b), the change in grid-side active power (2100 W to 1700 W) and reactive power waveforms are displayed.
95

idc

1s
(a) Dc-link current idc (5 A/div)

Pgrid

Qgrid

1s
(b) Grid-side real power Pgrid (1 kW/div) and reactive power (1 kVAr/div)

Fig. 4-14 Dc-link current and grid output power in response to step change in speed reference for PMSG#1.

It is observed that the unity power factor is maintained by keeping the reactive power zero in both steady- and transient-state, while the active power is changed in accordance with the output power of PMSG#1. The grid phase current variation with grid output power is shown in Fig. 4-15(a), while the steady-state grid phase voltage and current are illustrated in Fig. 4-15(b). Unity power factor operation at the grid connection point is also verified by Fig. 4-15(b).

96

is

1s
(a) Grid line current is (15 A/div)

vs is

5 ms
(b) Steady state grid phase voltage vs (100 V/div) and grid line current is (15 A/div)

Fig. 4-15 Measured grid phase voltage and line current.

4.5 Conclusions
An advanced coordinated control scheme is proposed for the cascaded CSC-based offshore wind farm. This control scheme enables all the turbines to independently track their own MPPT even with inconsistent wind speeds. In particular, an optimized dc-link current control algorithm is developed for the cascaded CSC-based system to minimize the operating power loss.
97

Moreover, the whole wind farm control strategy, which consists of wind farm supervisory control (WFSC), local wind turbine control and centralized grid control, is investigated. The centralized grid-side controller is developed for equal sharing of active and reactive power among each grid-side converter by identical gating signals. The system performance with the proposed coordinated control scheme is investigated by simulations on a cascaded CSC-based offshore wind farm. A low power wind farm prototype consisting of two PMSGs in cascaded connections using GTO based current-source converters is developed and simulation results are verified experimentally.

98

Chapter 5

Grid Fault Ride-Through Strategy for Cascaded CSC based Offshore Wind Farm

With rapid increase in penetration of wind power, it becomes necessary for the wind farm to behave like a conventional power plant. Therefore, the grid connection codes have been developed for the wind farm. The aim of these grid codes is to ensure continued growth of wind generation without compromising the power quality as well as the security and reliability of the electric power system. The fault ride-through (FRT) capability of a wind farm is of particular concern because the disconnection of a large wind farm caused by network disturbances may lead to system instability. This chapter addresses the grid integration issues, mainly the fault-ride through requirement, for the proposed cascaded CSC-based offshore wind farm. The existing FRT methods for the VSC-HVDC based offshore wind farm were reviewed. Based on this review, it has been shown that these methods cannot be applicable or made suitable to the proposed cascaded offshore wind farm. Using the inherent short circuit operating capability of the CSC, a new FRT strategy for the cascaded CSC-based offshore wind farm is developed. Intensive simulations are conducted to ensure the validity and feasibility of the proposed FRT method. Besides the grid fault, the other technical challenge for the cascaded CSC-based wind farm is to ensure continuous operation of the wind farm when one or more turbines fail to operate.
99

Various recent studies have adopted a series interconnection of wind turbines but this issue has not been investigated in the literature. In this Chapter, the mitigation strategy for the faulty turbine-generator unit in cascaded CSC-based wind farm is developed. This enables the isolation of faulty turbine-generator unit from the system without affecting the operation of the other series interconnected wind turbines. The proposed mitigation method has been verified by both simulation and experiment.

5.1 Grid integration requirements for the wind farm
The grid operators in the countries of Denmark, USA, Germany, Britain, Canada and other countries have issued grid codes for the wind farm grid connection. These grid codes vary in their defined scopes and detailed specifications, but some trends are common to most. A few of these requirements are summarized as follows [79]. 1) Active Power control. This requirement refers to the ability of the wind farms to regulate their power outputs to any defined level within maximum power that can be extracted from the wind. Maximum ramp rates are imposed on the wind turbine. In Canada, HydroQuebec requires ramping up or down capability from 0 to Pmax , or from Pmax to 0, in an adjustable 15 to 60 minutes interval [80]. Moreover, the turbines are required to limit the maximum output power specified by the system operator. 2) Reactive power capability. In general, the wind farms are required to control their reactive power output. The grid code demands that the wind farm should be able to operate over a wide range of power factor. In Canada, the operating power factor range is between -0.9 to 0.9. Furthermore, continuous voltage control as practiced by the

100

conventional synchronous generators is also required. This is achieved by feeding or absorbing reactive current during voltage sags and swells. 3) Frequency operating limits. The grid code imposes the frequency range within which the wind farm should remain in operation. In cases where the frequency exceeds the range, the wind farm should remain active for a specified amount of time before being disconnected from the system. In Canada, each utility has its own frequency range where the wind farm should operate normally. In Manitoba, the normal range of frequency is 59.0 < f < 61.5 Hz [79]. 4) Voltage operating limits. Grid codes also specify the voltage operating limits within which wind farms are expected to remain in operation. In Canada, the wind farm should operate normally while the terminal voltage Vt on the high voltage side of grid interfaced transformer is in the range 0.9 < Vt < 1.1 pu [79]. 5) Fault ride-through capability. All existing grid codes imposes requirements that in the event of grid voltage drop, the wind farms has to remain connected for a specific amount of time before it is allowed to disconnect. The fault type includes a variety of symmetrical or unsymmetrical cases with different voltage levels and different time durations. The wind farms consisting of variable speed wind turbines with full rating power converters can control their active and reactive power as presented in chapter 4. Moreover, pitch angle control can also be used to control the output active power. Therefore, grid code requirement 1) to 4) can easily be applied with proper commands and references through WFSC. However, the FRT capability is not as straightforward as the other requirements. The E.ON code [81] from the German power system operator is considered to describe the FRT requirement.

101

5.1.1 Fault ride-through requirement
In order to prevent the disconnection of a wind farm during the grid faults, many countries impose the grid code requirements for the FRT capability. A typical FRT requirement enforced by E. ON grid code is considered [81]. As shown in Fig. 5-1, the curve illustrates that grid voltage drops to zero for 150 ms due to a short circuit fault and then recovers gradually back to its lower voltage band. The wind farms must stay in operation as long as voltage at the grid connection point remains above the solid line.

Peak L-L voltage (V/VB)
100% 90%

Wind farm should remain in operation above this curve

Wind farm not required to remain on-line
0

0

150

1500

t (ms)

Fault occurs

Fig. 5-1 Grid fault ride-through requirement in E.ON grid codes.

Moreover, wind farms have to provide reactive current to support the grid voltage recovery during voltage dips, as shown in Fig. 5-2. Voltage support is required when the terminal voltage exits the dead band of 10% around the rated operating point. While in dead band, the wind farm can operate with power factor control. As it specifies, the voltage control should start functioning in the event of voltage dip below 10%. In particular, it has to provide 2% of the reactive current

102

compensation for each 1% of the voltage dip. For grid voltage dips below 50% of the rated value, the reactive current is kept to a maximum of 100% of the rated current.

Reactive current support (IQ/IB) 100%

50% Voltage sag (V/VB) 100%

-10%

10%

50%

Voltage dead band

Fig. 5-2 Reactive current support requirement in E. ON grid code.

A short-circuit grid fault or other large grid disturbance may cause the grid-side converter to lose its control capability. Therefore, the unbalanced power flow at the input and output may cause over-current or over-voltage in the converters and trigger the system protection. Recently, literature has published the FRT methods for the VSC-HVDC-based wind farm [12, 16, 35-37, 39]. Although the CSC-based WECS is considered a potential candidate in the medium-voltage high-power ranges, the FRT methods for such a system have been rarely studied in the literature. In [43], CSC-PMSG-WECS is used where the controllers for the generator- and grid-side converters can easily be coordinated for the FRT capability. However, in the proposed CSCbased offshore wind farm, the long distance between the generator- and grid-side converters causes the grid voltage-dip which cannot be identified at the same instant by the generator-side controller. In addition, the low dc-link inductance of the CSC-based system exerts a considerable challenge for the FRT capability. Therefore, recently proposed FRT methods for VSC based
103

counterpart [12, 16, 35-37, 39] cannot be adapted or made suitable for the proposed system.

5.2 Challenges in existing FRT methods for the proposed offshore wind farm
During the fault on grid network, the active power transfer capability of the grid-side converter is significantly reduced due to voltage dip. At the same time, the power fed to the dclink from the wind generators must be reduced fast enough to limit the rapid rise of dc-link voltage/current in a voltage-/current-source-based wind farm. Without countermeasure, this may cause undesired tripping or destruction of the converters. In [12, 16, 35-37, 39], various FRT methods are proposed for the VSC-HVDC-based wind farm. In this section, challenges in implementing these FRT methods to the proposed cascaded CSC-based wind farm have been discussed.

5.2.1 Active power reduction of each wind turbine through power setpoint adjustment
In large wind farms, the communication links are usually employed between the wind farm controller and to each turbine controller for communicating the reference signals (e.g., active power reference, monitoring signals). The basic layout for the VSC-HVDC and cascaded CSCbased offshore wind farm with communication links are shown in Fig. 5-3(a) and (b), respectively. When the fault is detected from the grid voltage measurement, the maximum transferable active power from the grid-side VSC (GSVSC) is calculated. Accordingly, the active power reduction factor is sent to each turbine-generator controller through the communication link for the VSC-HVDC-based wind farm [12, 35] (Fig. 5-3(a)).
104

~ ~

AC/DC DC/AC AC/DC DC/AC

WFVSC

Comunication link

Grid
GSVSC

Offshore grid
(a) VSC-HVDC based offshore wind farm

Comunication link

Grid
CSC #1 CSC #2

~ ~ ~

CSC #1 CSC #2

CSC #n

CSC #n

(b) Cascaded CSC based offshore wind farm

Fig. 5-3 Wind farm configuration with communication link for power setpoint adjustment. The main drawback of this scheme is the requirement for highly reliable communication links between the grid-converter and each turbine-generator unit. Moreover, the communication delay in sending the power setpoint to each wind turbine may limit the speed of the power reduction. This delay may become a major concern for CSC-based offshore wind farm where the dc-link inductance is normally smaller compared to the dc-link capacitance of VSC-based counterpart. The effect of the communication delay for the proposed CSC-based system has been discussed in the following case study. In the VSC-based system, the dc-link voltage is usually controlled by the grid-side converter. Actually, it is the power difference between generator- and grid-side converters that

105

determines the dc-link voltage. The dc-link voltage in the VSC-based WECS can be derived as [38]

vdc 

2 (P WF  P grid )dt Cdc 

(5.1)

Similarly, the dc-link current in CSC-based WECS can be derived as

idc 

2 (P WF  P grid )dt Ldc 

(5.2)

where PWF Pgrid Cdc ,vdc Ldc ,idc Total wind farm power injected to the dc-link from generator-side converters; Output power injected to the grid from grid-side converters; Dc-link capacitance and voltage for VSC-HVDC-based wind farm; Dc-link inductance and current for the cascaded CSC-based wind farm;

Compared with the 4 pu or even higher dc-link capacitance Cdc in VSC-based system, the dc-link inductance Ldc in the CSC-based system is normally around 1 pu or less. Due to the low dc-link inductance, much less energy can be stored in the dc-link of the CSC-based system compared to the VSC-based counterpart. As a result, during grid fault, very rapid rise of the dclink current may occur in the current-source-based system. Fig. 5-4 (a) and (b) shows the dc-link response during the grid voltage dip for the voltage- and current-source-based wind energy systems, respectively.

106

In both systems, a 2.5MW/3000V non-salient PMSG-based WECS is used whose parameters are given in Table 4-1. The dc-link responses are carried out for the different range of dc-link parameters as shown in Fig. 5-4. The dc-link parameters are selected in the range of 3 to 5 pu for a VSC-based system while 0.7 to 1.0 pu for a CSC-based system.
vdc (pu)
Fault instant 20 ms Cdc=3 pu Cdc=4 pu Cdc=5 pu

t (sec) (a) VSC-HVDC-based WECS Idc (pu)
Fault instant 20 ms Ldc=0.7 pu Ldc=0.85 pu Ldc=1.0 pu

t (sec) (b) CSC-based WECS

Fig. 5-4 Dc-link response during grid fault. Before the grid fault, both systems were operating at rated conditions. The three-phase fault has occurred at 6.5s. Considering the worst case scenario, the grid voltage has a dip-down to 0 pu for 150 ms and instantly recovers to 1 pu. It can be seen that there is a very rapid rise in the dclink current for the CSC-based system compared to the dc-link voltage in VSC-based

107

counterpart. In this paper, a communication delay of 20 ms is considered for sending the power reduction setpoint to each turbine. In a very short time interval of 20 ms, the dc-link current reaches more than 3 pu for the given practical range of dc-link inductance (0.7 to 1.0 pu). On the other hand, the dc-link voltage merely rises to about 1.3 pu during the same duration. This indicates that the CSC-based wind farms are highly vulnerable to the communication delay. In addition, even the communication link is assumed fast enough, the real power output of the generator cannot be decreased at a very high slew rate due to the large inertia of the electromechanical system. Therefore, this method cannot be feasible for the proposed cascaded CSCbased offshore wind farm.

5.2.2 Active power reduction through offshore grid frequency and/or voltage control
In [16], the offshore grid frequency is rapidly increased by wind farm side VSC (WFVSC) during the grid faults (Fig. 5). As a result, the generators output power is reduced. However, each turbine-generator controller needs to be equipped with an additional control loop which reacts to the change in offshore grid frequency. Alternatively, the generators output power is also reduced by fast decreasing the offshore grid voltage during the grid fault (Fig. 5) [36]. The WFVSC is used to control the offshore grid frequency or voltage. In both cases, the communication link between the grid-side VSC (GSVSC) and WFVSC is normally used to detect the onshore grid fault. Moreover, these FRT methods need an offshore grid and dedicated HVDC converter, whereas the proposed wind farm is configured without these components.

108

Pg

f
AC/DC DC/AC AC/DC DC/AC

or

V Comunication link
WFVSC GSVSC

Grid

~ ~

Offshore grid

Fig. 5-5 Active power reduction for VSC-HVDC-based wind farm through offshore gridfrequency and/or voltage control.

5.2.3 Energy dissipation in breaking resistor using full rated DC chopper
In this FRT method, the DC chopper is used to dissipate the excess dc-link power in the breaking resistors during the grid fault. The VSC-HVDC based wind farm with dc-chopper and breaking resistor is shown in Fig. 5-6(a) [37, 39]. This method can also be applied to proposed CSC-based offshore wind farm. In this system, the DC chopper needs to be series connected in the HVDC link which bypasses the breaking resistor in normal operating mode (Fig. 5-6(b)). The main advantage of this technique is that the wind generators remain completely unaffected from the grid fault. Accordingly, there is no impact on the mechanical drive train and thus, the wind turbines do not speed up during a fault.

109

Grid

~ ~

AC/DC DC/AC AC/DC DC/AC

WFVSC

GSVSC

HVDC cable DC chopper (a) VSC-HVDC based offshore wind farm

~ ~ ~

Wind farm side PWM CSCs CSC #1 CSC #2 HVDC cable CSC #n

DC chopper

Grid side PWM CSCs CSC #1 CSC #2

Grid

CSC #n (b) Cascaded CSC based offshore wind farm

Fig. 5-6 Wind farm configurations with DC chopper and breaking resistor.

However, the major drawback of this method is a high investment cost due to the size of the DC chopper with breaking resistor which needs to be rated at full wind farm capacity. In consideration of all the above constraints, a novel FRT method for the cascaded wind farm is introduced in the next section.

5.3 Proposed fault ride-through method
Due to the low dc-link inductance, the CSC-based system needs a fault ride-through capability which allows very fast power reduction without relying on the communication link. The wind farm control model consisting of the wind farm supervisory controller (WFSC), turbine-generator control units and centralized grid-side converter control is discussed in
110

Chapter 4. Besides normal operation, the WFSC is also used to control the bypass operation of the converter for the fault ride-through capability as shown in Fig. 5-7.

Pg*1
Turbine and generator control unit #1

Pg1 Pg*1 tstop

P

* gn

 Maximum power mode  Power limitation mode

Pcmd
P WF

mode

Q

* o

Qcmd ngrid
P WF   ( P gi )
i 1 n

Qcmd

Pcmd
Qcmd

System operator

Total available wind farm power

vs
Turbine and generator control unit #n

Pgn * Pgn tstop

Bypass control of CSCs for the Fault Ride-Through capability

* Qo

Centralized grid-side converter control

(WFSC)

Fig. 5-7 Block diagram of cascaded CSC-based offshore wind farm control.

In the following subsections, a novel FRT method using the implicit short-circuit operating capability of the CSC is discussed.

5.3.1 Short-circuit operating capability of PWM CSC
For pulse-width modulated (PWM) CSC, the switching pattern must satisfy a constraint, that is, only two switches in the converter conduct at any time instant, one in the top half of the converter bridge and the other in the bottom half [68]. Under this constraint, the three-phase CSC has a total of nine switching states as listed in Table 5-2. In the three zero switching states, the converter currents are obtained as: iwA = iwB = iwC = 0 (Fig. 5-9). This operating mode is referred as bypass operation. During this operation mode, the generator remains isolated from
111

the system while the converter is bypassed through the shorted leg to provide the path for the system dc-link current. This feature is used for the FRT capability of the proposed wind farm. TABLE 5-1: SWITCHING STATES FOR THE PWM CURRENT-SOURCE CONVERTER Type Switching State Onstate switch {1,4} Zero states {3,6} {5,2} {6,1} {1,2} Active states {2,3} {3,4} {4,5} {5,6} S1,S4 S3,S6 S5,S2 S6,S1 S1,S2 S2,S3 S3,S4 S4,S5 S5,S6 Idc Idc 0 -Idc -Idc 0 -Idc 0 Idc Idc 0 -Idc 0 -Idc -Idc 0 Idc Idc 0 0 0 Converter PWM current iwA iwB iwC

5.3.2 Fault detection
In event of the grid fault, the dc-link current idc normally exceeds the operating range due to reduced power transfer capability of the grid-side converters. This abnormal dc-link current measured at each generator-side converter is used as an indication of the grid fault. It eliminates the need for highly reliable communication links between grid-converters and each turbinegenerator unit for the fault detection.

112

5.3.3 Generator-side converters
Whenever the dc-link current idc exceeds the safe current threshold limit, the generator-side converter control is switched to the fault-ride through mode from the normal operation as shown in Fig. 5-8. In fault ride-through mode, the generator-side converters are bypassed using any zero switching-state as shown in Fig. 5-9. Consequently, the PMSG remains isolated from the system without interrupting the system dc-link current. This allows very fast power reduction without relying on a communication link to detect the grid fault.

S=0

s

Maximum power point tracking

idc
ITh

1
0

idc
S=1

Fault ride-through using zero switching-state

Fig. 5-8 Generator-side converter control switch during grid fault.

Since no information is available about depth of the grid voltage dip, the step-wise isolation of the wind generators are proposed. Whenever the dc-link current exceeds the threshold current limit ITh1, the wind farm capacity is reduced to about 50% by isolating half of the wind generators in the wind farm. As a result, in cases of less severe fault, the dc-link current may resume its original value from ITh1. However, for severe grid-fault, even though half of the wind generators are isolated, the dc-link current can still exceed the higher threshold limit ITh2 (ITh2 > ITh1). In this case, complete wind farm power is reduced to zero by isolating all the wind generators. This ensures sufficient power reduction for any severity of grid fault.

113

Ldc

iwA
PMSG #1

S1

S3

S5

idc
S4 S6 S2

iwC

PMSG #n

idc

Fig. 5-9 Zero switching-state operation of generator-side converters during grid fault. As shown in Fig. 5-7, When the fault is cleared, a WFSC identifies the grid voltage recovery and sends the deactivate bypass signal (tstop) to switch back the generator-side converters to their normal operation.

5.3.4 Wind generators
During grid fault, the incoming wind energy is stored as kinetic energy in the rotating mass, thus increasing the generator speed. However, the large inertia (4~6s) of the turbine-generator unit prevents over-speed risks during a very short interval of time.

5.3.5 Grid-side converters
During the grid fault, the grid-side converters should provide the reactive current to support the grid voltage recovery. The range of reactive power support by the grid-side converters is

114

limited by the current ratings of the converter and also the maximum allowable current at the grid connection point. Assuming maximum steady-state operating current at the grid terminal is 1 pu, the grid reactive current output could be derived as follows:
2 I b (Vb  vds ) / Vb  * iqs  Ib   if (vds  Vb )  0.5 pu if (vds  Vb )  0.5 pu

(5.5)

where Vb Ib vds
* iqs

magnitude of the rated phase voltage magnitude of the rated phase current d-axis grid voltage q-axis grid current (reactive component)

The grid-side controller is designed to give priority to the reactive current and remaining current carrying capacity of converter is used for active current as given by
*  * ids Ib2  iqs

(5.6)

The maximum active power transferable from grid converter can be derived as
*2) Pgrid  vds ( Ib2  I qs

(5.7)

* * ) and active current (ids ) injected from the wind Fig. 5-10(a) shows the grid reactive current (iqs

farm during the grid faults following the E.ON grid code. It can be seen that when voltage at the wind farm grid connection point is reduced to less than 0.5 pu, a reactive current of 100% of the rated current is required according to (5.6). As a result, there is no active current output from grid-converters. Fig. 10(b) shows the corresponding active and reactive power injected to the
115

grid during grid faults following the E.ON grid code. The active power output from the wind farm is derived by (5.7).
* * ids , iqs (pu)

* iqs

* ids

vds (pu) (a) Grid currents requirement as grid voltage changes
* * Pgrid , Qgrid (pu)

* Qgrid (pu)
* Pgrid (pu)

vds (pu) (b) Grid power requirement as grid voltage changes

Fig. 5-10 Grid active and reactive currents and power following the E.ON grid code.

5.3.6 System performance investigation by simulations
In order to verify the effectiveness of the proposed FRT method for the cascaded CSC-based system, a digital simulation is carried out for the wind farm consisting of two wind generators as shown in Fig. 5-11. The simulation is performed using Matlab/Simulink with the SimPowerSystem toolbox. The main simulation parameters are listed in Table 5-2. In these simulation studies, the turbine-generator inertia constant is considered to be 2 sec. The space-

116

vector modulation (SVM) technique is applied for both side converters with the device switching frequency of 540 Hz. The simulation results are shown in Figs. 5-12 to 5-17. The system performances with the proposed FRT method against a three phase fault are investigated by simulation.

Pg1

Ldc / 2
PWM CSC#1 PWM CSC#1

Po1

Lo

grid

v1

PMSG #1 Cr

Ci

idc

Y Y 
Po 2
PWM CSC#2

Pg 2
v 2
PMSG #2 Cr PWM CSC#2

Ldc / 2

Ci

Lo

Fig. 5-11 Block diagram of cascaded CSC-based wind energy system under investigation.

A three-phase fault is assumed very near to the wind farm grid connection point, causing grid voltage drop to 10% from the rated value. The fault lasts for 100 ms and then grid voltage recovers from 10% to 100% at a slope of 300% per second as shown in Fig 5-12(a). During a small duration of grid fault, the wind speed is considered constant at rated value. Therefore, the system was operating at the rated condition before the fault at 3 sec.

117

TABLE 5-2 SYSTEM PARAMETERS FOR SIMULATION AND EXPERIMENT Parameters Experimetnal setup PMSG#1 PMSG#2 Generator parameters 2.5 MW 3.6 kW 2.08 kW 3000 V 208 V 170 V 481 A 10 A 7.5 A Simulation 60/20 Hz 13.78Wb (1 pu) 60/20 Hz 0.956 Wb (1 pu) 60/60 Hz 0.245 Wb (0.94 pu) 13.88mH (0.4pu) 2

Rated power Rated voltage Rated current Grid/generator frequency Permanent magnet flux Synchronous inductance Pole pairs dc-link inductance Generator-side capacitor Grid-side capacitor Grid-side line inductance

11.45mH 19.1mH (0.4 pu) (0.2 pu) 32 8 Converter parameters 28.6mH 95 mH 40 mH (1 pu) (1 pu) (1.08 pu) 200ÂµF 60 ÂµF 663ÂµF(0.3 pu) (0.3 pu) (0.31 pu) 368.4ÂµF (0.5 120 ÂµF (0.345 pu)* pu) 0.95mH(0.1 3 mH (0.15 pu)* pu)

(*single grid-side converter where converter parameters are based on total rated power 5.68kW and 208V)

118

vgrid (pu)

t (sec)

(a) Grid voltage
idc (pu)

t (sec) (b) Dc-link current

Fig. 5-12 System dynamic response to the grid fault.

bypass signals PMSG#1 PMSG#2

t (sec)

Fig. 5-13 Bypass signals for the generators during grid fault. Since grid fault is not detected at the same instant by generator-side converters, the power is still injected into the dc-link from wind generators. The power unbalance produces a sudden overshoot of the dc-link current (Fig. 5-12(b)). When it reaches threshold current limit ITh1 = 1.5

119

pu, instantly the bypass signal for PMSG#1 unit is generated, which switches the CSC#1 into bypass operation and isolates the PMSG#1 from the system. The bypass signals for the PMSG#1 and PMSG#2 are shown in Fig 5-13.

Pg1 (pu)

t (sec) (a) PMSG#1 active power output

Pg2 (pu)

t (sec) (b) PMSG#2 active power output
Pgrid, Qgrid (pu)

Qgrid

Pgrid t (sec) (c) Grid active and reactive power

Fig. 5-14 Generators and grid output power during grid fault.

120

With isolation of the PMSG#1, the power injected ( Pg1) from CSC#1 immediately reduced to zero as shown in Fig. 5-14(a). However, in case of severe fault, the dc-link current rises to ITh2 (2 pu) even after the isolating PMSG#1. Therefore, the bypass signal is also generated for the CSC#2 as shown in Fig. 5-13. As a result, PMSG#2 is isolated and the complete wind farm output power is reduced to zero (Fig. 5-14(b)). The grid active and reactive power output are shown in Fig. 5-14(c). The first priority of the grid-side converters is to support the grid voltage recovery. When grid voltage dips-down to 10% of the rated value, the reactive current support of 1 pu is provided by grid-side converters and therefore the active power is reduced to zero as shown in Fig. 5-14(c). When the fault is cleared and grid voltage recovers to 50% of the rated value, the WFSC identifies the grid voltage recovery and sends a signal to switch the generator-side converters from bypass mode to normal operation (Fig. 5-13).
r1 ,r2 (pu) r1 r2

t (sec)

Fig. 5-15 Generators speed during the grid fault.

During the grid fault, the incoming wind energy is stored as a kinetic energy in a moment of inertia of the turbine-generator mechanical system. As a result, the isolated generators speed increased to about 4% from the rated value as shown in Fig. 5-15.
121

vgrid ,igrid (pu) vgrid igrid

Period I

Period II

t (sec)

(a) Grid phase voltage and current waveforms. vgrid ,igrid (pu)

t (sec)

vgrid ,igrid (pu)

(b) Period I

t (sec)

(c) Period II Fig. 5-16 Grid phase voltage and current during grid fault.

The grid voltage and current waveforms during the grid fault are shown in Fig. 5-16. During normal operation, the power factor is maintained at unity, while during grid fault, rated capacitive reactive current is injected to the grid for voltage recovery. At the fault instant, the
122

discharging of the converter filter capacitors cause current transient at 3 sec, which settles down within one cycle. As shown in Fig. 5-16(b), the rated current is supplied with 90Â° apart. With grid voltage recovery, the reactive current support gradually decreases, as shown in Fig. 5-16(c).
idc (pu)

idc (power setpoint adjustment) idc (proposed FRT method)

t (sec)

Fig. 5-17 Dc-link responses with proposed FRT method and FRT with power setpoint adjustment.

The comparison of the dc-link response for the proposed FRT method and FRT with active power reduction at each wind turbine through the power setpoint adjustment is shown in Fig. 517. During the grid fault, the profile of the grid voltage is considered as shown in Fig. 5-12(a). In active power reduction method, the communication delay of 20 ms is considered. Due to this delay, dc-link current is rises to 3.5 pu before the power reduction order activates. This may cause undesired tripping or damage to the converter. On the other hand, the proposed FRT strategy isolates the wind generators from the system whenever the dc-link current reach thresholds limit of 2 pu. Therefore, the maximum instantaneous dc-link current through the switching devices cannot exceed the threshold limit of the converter.

123

5.4 Mitigation strategy for faulty turbines in cascaded CSC-based offshore wind farm
As discussed previously, the other technical challenge for the cascaded CSC-based wind farm is to ensure continuous operation of the wind farm when one or more turbines fail to operate. This issue is not critical for the VSC-HVDC-based wind farm, where wind generators are parallel connected. However, it is an essential need for the cascaded system that when one or more wind turbine-generator units fail, the remaining healthy turbines should continue operation without interruption. Various recent studies [24, 27, 28, 30, 31, 33] have adopted a series interconnection of wind turbines but this issue has not been researched. The following aspects need to be carefully considered for the operating continuity of the proposed cascaded CSC-based offshore wind farm. 1) Failure of the turbine-generator unit. 2) Failure of the converter switching devices. Moreover, wind turbines facing wind speeds lower than the cut-in speeds have to be isolated from the system without affecting the operation of other series interconnected wind turbines. Considering the above aspects, the mitigation strategy for faulty turbines in the cascaded CSCbased wind farm is proposed. As shown in Fig. 5-18, the zero switching-state of the converetr of the CSC can be used to isolate the affected wind turbine from the system. With fast identification of the turbinegenerator fault through monitoring signals, the affected CSC can be easily switched to bypass mode from normal operation. Moreover, the turbines facing wind speed lower than cut-in speed can be easily isolated from the system. Furthermore, in the new-generation high-power CSC, symmetrical switching devices such as integrated gate-commutated thyristor (IGCT) is
124

commonly used. The IGCT, as a press-pack device, is designed to behave as a short-circuit when it fails [82]. Therefore, in the event of switching devices failure, the system continues its operation without interruption.

monitoring signal

is turbine-generator failure ? OR

S=0

Maximum power point tracking

vw

is vw < cut-in speed ?

S=1

Isolation of the generator using zero switching-state

Fig. 5-18 Generator-side converter control switch during turbine-generator failure and/or very low wind speed.

5.4.1 System performance investigation using simulations
In order to verify the effectiveness of the mitigation strategy for faulty turbines in the cascaded CSC-based wind farm, the isolation of one wind turbine from the system is considered. The digital simulation is carried out for a wind farm consisting of two wind generators, as shown in Fig. 5-11. The simulation results are shown in Figs. 5-19 to 5-20. It is assumed that at t=5 sec, the monitoring signal identifies the abnormality in PMSG#2 of the system shown in Fig. 5-11. Consequently, the generator-side CSC#2 is switched to bypass mode from normal operation mode and therefore, PMSG #2 is isolated from the system (Fig. 5-19(a)), while the output power and speed of PMSG#1 is not affected as shown in Fig. 5-19 (a) and (b). This proves that isolating one PMSG from the system using the bypass mode of converter will not affect the other series
125

interconnected wind turbines in the system. Since the PMSG#2 is isolated and there is no path for the power flow, the incoming wind energy will be stored in a moment of inertia of the turbine-generator. In the mean time, pitch control is used to reduce the incoming wind energy and thus, the speed of the turbine-generator (Fig. 5-19(b)). The small undershoot of the dc-link current is observed due to dynamically quick changes in dc-link power (Fig. 5-20(a)). The wind farm output active and reactive power injected to the grid is illustrated in Fig. 5-20(b).

Pg1 , Pg2 (pu)

Pg1 Pg2
t (sec) (a) Generators output real power.

g1 , g2 (pu)

g2

g1
t (sec) (b) Generators speed.

Fig. 5-19 System dynamic response with isolating one faulty turbine-generator unit from the cascaded CSC-based wind farm.

126

idc (pu)

t (sec) (a) DC-link current.

Pgrid , Qgrid (pu)

t (sec) (b) Grid output power.

Fig. 5-20 Dc-link current and grid powers with isolating one faulty turbine-generator unit from the cascaded CSC-based wind farm.

5.4.2 Experimental verification
The mitigation strategy for the cascaded CSC-based system is verified on a low-power prototype of the wind farm consisting of two PMSGs in cascade using gate turn-off thyristors based CSCs. The block diagram of the experimental setup is shown in Fig. 5-21. It is same as the simulation setup given in Fig. 5-11, except that only one grid-side converter is employed to reduce the experimental complexity. Due to the same rating and centralized control of the gridside converters, each module has the same function, and one converter utilized at the grid-side

127

will not affect the generator-side operation. The experimental parameters are provided in Table 5-2.

Pg1
PMSM #1 PMSG #1 Cr PWM CSC#1

Ldc / 2

grid

Po1
PWM CSC#1

Lo

idc

Y 

Pg 2
PMSM #2 PMSG #2 Cr PWM CSC#2

Ci

Ldc / 2

Fig. 5-21 Block diagram of experiment setup.

The permanent-magnet synchronous machines are used as a prime-mover for the both PMSG. The prime movers are operating in torque producing mode while both PMSGs are operated in speed control mode. The system controls are implemented on a DSP and FPGA based platform. The experimental results obtained from the laboratory set up are illustrated in Figs. 5-22 to 5-24, where the bypass signal shows the time instant at which the PMSG#2 is bypassed. Before applying the bypass pulse, the system working in normal operation mode with active power Pg1 = 1800W and speed g1 = 112.5 rpm (15 Hz) for PMSG#1 as shown in Fig. 5-22(a). While active power Pg2 =600W and speed g2 = 900 rpm for PMSG#2 as shown in Fig. 5-23(a). After bypassing generator-side CSC#2, the output power from PMSG#2 is reduced to 0 from 600W (Fig. 5-22(a)), while the speed g1 and output power Pg1 of PMSG#1 are not affected as illustrated in 5-23(a). This proves the effectiveness of the proposed cascaded system against isolating a few wind turbines without affecting other healthy units in the system.
128

bypass signal

Pg _1

100 ms
(a) PMSG#1 active power output (1 kW/div)

bypass signal

Pg _ 2

100 ms
(b) PMSG#2 active power output (500 W/div)

Fig. 5-22 Measured generators active power in response to isolation of PMSG#2 from the system. In the experiment, the prime-mover of the isolated PMSG#2 is still applying the same torque even after isolating PMSG#2 and therefore, the PMSG#2 is accelerated (Fig. 5-23(b)). It is worth mentioning that the inertia constant of the experimental setup is much smaller than that in the simulation. Therefore, the rapid rise in the speed of the PMSG#2 is observed. To avoid the overspeed of the machine, the maximum speed limit is adjusted to 1000 rpm for the prime-mover controller.

129

bypass signal

r _1

100 ms
(a) PMSG#1 speed (30 rpm/div)
bypass signal

r _ 2

100 ms
(b) PMSG#2 speed (400 rpm/div)

Fig. 5-23 Measured generators speed in response to isolation of PMSG#2 from the system.

As shown in Fig. 5-24(a), the dc-link current shows small undershoots during bypassing of the generator-side CSC#2. The grid-side output active and reactive power is shown in Fig. 5-24(b).

130

idc

100 ms
(a) Dc-link current (5 A/div)

bypass signal

Pgrid
Qgrid

100 ms
(b) Grid active power (1 kW/div) and reactive power (1 kVAr/div)

Fig. 5-24 Measured system dynamic responses with isolating PMSG#2 from the system.

5.5 Conclusions
This chapter first discusses the grid integration issues of the CSC-based offshore wind farm. The existing fault ride-through (FRT) methods for the VSC-HVDC based offshore wind farm are reviewed and based on which challenges in implementing these methods to proposed cascaded
131

CSC-based wind farm are identified. Based on this, a novel FRT strategy is proposed for the cascaded current-source converter (CSC)-based offshore wind farm. It is shown that the low dclink inductance of the current-source-based system causes very rapid rise of the dc-link current during grid fault. Therefore, a small communication delay may also cause undesired tripping of the wind farm or damage to the converters. In order to overcome the problem, inherent shortcircuit operating capability of the CSC is used to develop a FRT strategy without relying on the communication link. As a requirement of the current source-based system, this approach allows very fast power reduction during the grid fault. Intensive simulation results verify the effectiveness of the proposed FRT strategy. In addition, mitigation strategy for the cascaded CSC-based system is proposed which ensures the operating continuity of the system even with the failure of one or more wind turbines from the system. Both simulation and experimental verification of the flexible operation is provided for the cascaded wind farm consisting of two PMSGs.

132

Chapter 6

Conclusions
In this thesis, the application of current source converters (CSCs) in a permanent magnet synchronous generator (PMSG)-based offshore wind farm is proposed. A comprehensive study of the CSC-based offshore wind farm has been carried out. The main effort of the research has been put into developing a CSC-based offshore wind farm system, including configuration investigation, system control schemes, and grid integration solution.

6.1 Conclusions
The main contributions and conclusions of this research works are summarized as follows. 1) Novel cascaded CSC-based offshore wind farm configuration investigation The high capital investment due to the offshore converter substation is a major obstacle for the potential growth of the offshore wind farm. In order to overcome the problem, a novel interconnecting method for an offshore wind farm using cascaded PWM CSCs on both the generator- and grid-side, is proposed. With the converters in cascade to achieve high operating voltages, the proposed method eliminates the need for a bulky and costly offshore converter substation which is usually employed in the VSC-HVDC-based counterpart.

133

2) Novel decoupled control scheme for the cascaded CSC-based offshore wind farm has been developed A new decoupled control scheme for the cascaded CSC-based offshore wind farm is developed. The proposed control strategy decouples the active and reactive power control for the grid-side converters. To minimize the power losses of the proposed wind energy system, a minimal dc-link current control scheme is developed. More importantly, the dc-link current control is achieved by measuring the dc-link power of the grid-side converters without any information from the generator-side controller. Therefore, the generator- and grid-side controllers are fully decoupled, and the need for the long distance communication link is eliminated, which improves the reliability of the proposed cascaded system. 3) Effect of the grid reactive power regulation on the dc-link current has been investigated The effect of the reactive power regulation capability of the grid-side converter on the dclink current is identified. Furthermore, the reactive power regulation at the grid is considered for the dc-link current control which allows the wind farm to operate at the desired power factor to meet the grid code requirement. 4) Coordinated control scheme for the cascaded CSC-based offshore wind farm has been developed An advanced coordinated control scheme is developed for the cascaded CSC-based offshore wind farm. This control scheme enables all the turbines to independently track their own maximum power point tracking (MPPT) even with inconsistent wind speeds. In particular, an optimized dc-link current control algorithm is developed for the cascaded CSC-based system to minimize the operating power loss.

134

Moreover, the whole wind farm control strategy, which consists of wind farm supervisory control (WFSC), local wind turbine control and centralized grid control, is investigated to make further utilization of this advanced wind farm configuration. The centralized grid-side controller is developed for the equal sharing of active and reactive power among each grid-side converter by identical gating signals. 5) New fault ride-through (FRT) strategy for the cascaded CSC-based offshore wind farm has been developed A new FRT strategy has been developed to ride-through the grid low-voltage faults for the cascaded CSC-based offshore wind farm. It has been investigate that the low dc-link inductance (0.7 to 1.0 pu) of the current source-based system causes very rapid rise of the dc-link current during grid fault. Therefore, a small communication delay may also cause undesired tripping of the wind farm or damage to the converters. In order to overcome the problem, a fast and reliable FRT strategy is developed using the inherent short-circuit operating capability of the CSC. Intensive simulation results are presented to verify the new FRT strategy. 6) Mitigation strategy for the faulty turbine-generator unit in cascaded CSC-based offshore wind farm has been developed Besides grid fault, the other technical challenge for the cascaded CSC-based wind farm is to ensure continuous operation of the wind farm when one or more turbines fail to operate. In order to overcome the problem, the mitigations strategy for the faulty turbine-generator unit in the cascaded CSC-based system is developed.

135

7) Simulation models have been developed for verifications of system operation A complete system model for the offshore wind farm has been developed. The system performances for the proposed control schemes are investigated in simulation. 8) Experimental verifications on a laboratory prototype have been conducted. In this research, the low-voltage experimental platforms are designed. The single CSCPMSG-WECS is developed for the decoupled control scheme verification, while the coordinated control scheme and mitigation strategy for faulty turbines are verified on a cascaded CSC-based system consisting of two PMSGs. The control algorithms are coded in digital signal processor (DSP).

6.2 Future works
The following is suggested for future research work. 1) PWM modulation technique for grid-side cascaded CSCs In the proposed offshore wind farm configuration, a large numbers of PWM CSCs are cascaded on the grid-side. In order to improve the grid power quality, the PWM modulation techniques should be investigated to obtain the multilevel operation for the grid-side cascaded CSCs. 2) Control of cascaded CSC-based offshore wind farm under unbalanced grid fault conditions Under unbalanced conditions, the grid voltage and current consist of positive, negative and zero sequence components. Conventional control methods are normally developed only for a positive sequence component. Therefore, system control and performance under unbalanced cases should be investigated.
136

3) Sensorless control of PMSG in a proposed cascaded CSC-based offshore wind farm The generator design for direct-drive or semi-direct-drive WECSs leads to a large rotor diameter, making it difficult to mount the encoder on the rotor shaft. A sensorless control algorithm should be developed for the CSC-PMSG based WECS for offshore wind farms.

137

138

Appendix A

System Modeling

In a variable-speed WECS, the generator speed or torque should be regulated to achieve maximum power point tracking of the wind turbine. On the other hand, the real and reactive power output should satisfy the grid code. In this work, generator-side equations are derived with respect to the generator rotor flux oriented synchronous reference frame, whereas grid-side equations are obtained based on the grid voltage oriented synchronous frame. The modeling of the system starts with deriving three-phase equations from the electrical circuit. The equations are then transformed into their corresponding synchronous frames based on which the control system will be designed. The abc subscripts used hereafter denote the threephase components in the stationary reference frame. The d and q subscripts refer to the d-axis and q-axis of the selected reference frame, respectively. The transformation from abc frame to dq frame is expressed in (A-1) under the assumption of a three-phase balanced system. x represents a system variable which can be a three-phase current, voltage, or flux linkage.  is the angle of the synchronous frame with respect to the a axis of the stationary frame. Any three-phase components can be expressed as a vector in both frames. The length of the vector denotes the magnitude of the component.

139

 xd  2 cos  x     q  3   sin 

cos (  2 / 3)  sin (  2 / 3)

 xa  cos(  4 / 3)     xb   sin (  2 / 3)   x   c

(A.1)

The system includes a few passive elements that introduce differential terms into the dynamic equations. The transformation of a differential term from abc to dq brings additional terms due to the rotating action of the dq frame, as can be seen in (A-2),

d [ x]abc d [ x]dq  0       x dq dt dt   0 

(A.2)

where [ x]abc stands for the vector [ xa xb xc ]T and [ x] dq represents [ xd xq ]T .  is the rotating speed of the dq reference frame with respect to the abc stationary frame.

A.1 Wind turbine power model
The modeling of the wind turbine for electrical system design mainly focuses on the amount of captured power from the wind and thus the mechanical torque applied to the shaft of the generator. The mechanical power extracted from the wind depends on many factors. A simple equation is often used to describe the power characteristics of wind turbines:

Pmech 


2

3 Ac p ( , ) vw

(A.3)

where Pmech is the mechanical power extracted from the wind; v w is the wind velocity in m/s ;

 is the air density in kg/m3; A is the area swept by the rotor blades of the turbine in m2 ; cp is

140

the power coefficient, which is a function of  and ;  is the blade pitch angle in degrees; , namely the tip speed ratio, is the ratio between the rotor tip speed vtip and the wind speed v w . The relation between the blade tip speed and the turbine rotor speed  r is a constant Kb for a rigid system representation. The generator mechanical speed  m is direct proportional to the turbine rotor speed. Particularly in a direct-drive system,  m equals  r . Therefore,

  K b m / v w .
The above equation indicates a few design factors affecting wind power capture. As the power increases with the length of the turbine blades, which is the radius of the covered area A, doubling the blades length will quadruple the wind turbine power rating. This is one of the reasons that lead to larger wind turbines. Air density and wind speed are influencing factors for site selection, among other environmental factors. Tip speed ratio and pitch angle control can be employed to manipulate extracted wind power during operation.
Turbine output power (pu) Pitch angle = 0 Max. power at base wind speed (12 m/s) 12 m/s

10.8 m/s

9.6 m/s 8.4 m/s 7.2 m/s 6 m/s Turbine speed (pu)

Fig. A-1 Wind turbine power-speed characteristics and maximum power point operation.
141

The relation between torque and mechanical power is given by the following equation:

Tmech 

Pmech

m

 Kb

Pmech vw

(A.4)

One of the key control objectives of WECS is to achieve maximum power capture when the wind speed is lower than the rated. According to the turbine characteristics, the maximum power point is determined by the pitch angle and tip speed ratio at a certain wind speed. As a result, with a given pitch angle, the optimum turbine generator speed, torque and power is related to the wind speed by,

m,opt  vw
2 Tmech,opt  vw 3 Pmech,opt  vw

(A.5)

Fig. A-1 shows power curves of a typical characteristics of a wind turbine under various wind speeds at zero pitch angle. For wind speed within the rated value, it's possible to find the corresponding rotor speed at which efficiency and power generation are maximized. The power efficiency curve is normally obtained by field data collection on the real wind turbines. Fig. A-2 provides typical c p curves as it varies with tip speed ratio and pitch angle. According to GE's model in [58], the c p curves can be expressed in a mathematical representation using polynomials. The curve fit is a good approximation for a specific value of  in the range of 2 to 13 m s if a polynomial of four degrees is used.
4 4

c p ( ,  )   i , j i  j
i 0 j 0

(A.6)

142

cp
  0o   5o

  10o   15o

  20o


Fig. A-2 Wind turbine power efficiency curve.

Taking  = 0Â° as an example, the curve fit of power efficiency curve is shown as a dash line in Fig. A-2. Its polynomial expression is given in (A.7).
(c p ) 0  3.16e  4 4  0.01 3  0.105 2  0.3091  0.289

(A.7)

By replacing c p ( ,  ) in (A.3) with the polynomial expression, we can derive the equations for mechanical power and torque applied to the generator.

Pmech 



 4 4  3    i , j i  j  Av w   2  i 0 j 0 

4 1 3 0 2 1 1 2 0 3  k 4 m vw  k 3m v w  k 2 m vw  k1m v w  k 0 m vw

3 1 2 0 1 1 0 2 1 3 Tmech  k4m vw  k3m vw  k2m vw  k1m vw  k0m vw

(A.8)

143

where k x 


2

AK

x b


i 0

4

i,x

 i ( x  0,1,.....,4). The values of  i , x are obtained from the curve fitting

of c p . The coefficient AK bx / 2 can be determined according to the rated values of Pmech ,  m and v w . The derived mechanical torque equation can be used in the system model to calculate the torque at any wind speed and generator speed. The equation alters with the change of pitch angle. Pitch angle is usually adjusted to limit or regulate the active power. For the sake of convenience in electrical system analysis, the pitch angle can be assumed constant.

A.2 Permanent magnet synchronous generator
In the PMSG, the rotor magnetic flux is generated by permanent magnets, and these generators are therefore brushless. Because of the absence of the rotor windings, a high power density can be achieved, reducing size and weight of the generator. In addition, there are no rotor winding losses, reducing the thermal stress on the rotor. Moreover, mechanical stages of the gearbox are completely eliminated or reduced which saves in cost and maintenance. The drawback of these generators lies in the fact that permanent magnets are more expensive and prone to demagnetization. Depending on the permanent magnet placement on the rotor, the PMSG can be classified into surface permanent magnet machines (SPM) or interior permanent magnet machines (IPM). The permanent-magnets are placed on rotor surface in surface-mounted PMSG while they are inset into the rotor surface for interior PMSG. Most designs of PMSGs for WECS use surface-mounted permanent magnet rotor since it leads to a simple rotor design with low weight. Since the permeability of the magnets is very close to that of the non-ferrite materials, the effective air gap between the rotor core and stator is uniformly distributed around
144

the surface of the rotor. The surface-mounted PMSG is also referred to as non-salient pole PMSG, in which the d- and q-axis synchronous inductances usually considered the same. From the literature, the synchronous inductance of a PMSG for high-power low speed wind applications is usually above 0.4 pu. Fig. A-3 shows a general dq-axis model of the synchronous generator. Since the synchronous inductance varies as a function of the rotor position in a salient pole machine, the equivalent circuit of a PMSG is normally modeled in the rotor field synchronous reference frame. The dq-axis magnetizing inductances, Lmd and Lmq , are usually equal ( Lmd = Lmq ) in nonsalient PMSG, whereas in the salient-pole PMSG, d-axis magnetizing inductance is normally lower than q-axis magnetizing inductance ( Lmd < Lmq ).

igd Rg


g gq


Lls
 

igq Rg

g ds
 

Lls
iqm Lmq

vgd


p gd


Lmd

 If

vgq


p gq


Stator
(a) d-axis circuit

Rotor

Stator
(b) q-axis circuit

Fig. A-3 General dq-axis model of synchronous generator. As shown in Fig. A-3(a), the permanent magnet that replaces the field winding can be modeled by an equivalent current source I f of fixed magnitude in the d-axis circuit. The dynamic equations for the generator terminal voltage v g are given by

145

 vgd   Rg igd  g gq  p gd   vgq   Rg igq  g gd  p gq

(A.9)

where  gd and  gq are the d- and q-axis stator flux linkages, which can be calculated by following set of equations

  gd   Lls igd  Lmd ( I f  igd )  ( Lls  Lmd )igd  Lmd I f   Ld igd  f    gq  ( Lls  Lmq )igq   Lqigq
where  f is the rotor flux, and Ld and Lq are the stator dq-axis self inductance, given by

(A.10)

 f  Lmd I f   Ld  Lls  Lmd L  L  L ls mq  q

(A.11)

The generator voltage can be derived by substituting (A.10) into (A.9), and considering
d f / dt  0 due to constant  r in PMSG as given by

 vgd   Rg igd  g Lgqigq  Ld pigd   vgq   Rg igq  g Ld igd  Lq pigq  g f
Fig. A-4 shows a simplified model of the PMSG, which is derived based on (A.12).

(A.12)

146

igd


Rg

 f Lq igq


igq Rg


 g Ld igd  g f




vgd


Ld

vgq


Lq

(a) d-axis circuit

(b) q-axis circuit

Fig. A-4 Simplified dq-axis model of synchronous generator

Substituting (A.10) into (A.13), the torque equation can be given by

Te  1.5Ppair ( f igq  ( Ld  Lq )igd igq )
The rotor speed  g can be obtained from

(A.14)

P d g  pair (Tm  Te ) dt J

(A.15)

where Ppair is the number of pole pairs of the generator; J is the total inertia of the wind turbinegenerator system; Tm is the mechanical torque applied by the wind turbine; Te is the electrical torque produced in the generator.

A.3 Current source converter
In proposed wind farm configuration equal numbers of cascaded CSCs are employed on both generator- and grid-side. Since identical converter topology is used on both side, the modeling of

147

grid-side converter is presented in this section. The same method can be applied for the generator-side converters. Considering aggregate wind farm model, a single grid side converter is considered for the modeling purpose. The configuration of the grid-side CSC is given in Fig. A-5. The ac side of the converter has three-phase modulated waveforms dictated by the gating signals of the devices.


idc  vdci

S1

S3

S5

ii vci

is

Grid

~
S4
S6

S2

ici
Ci



Fig. A-5 Configuration of the grid-side CSC The device switching actions generate high-frequency harmonics in the system. The ac capacitors serve as the harmonic current filter in addition to its function to ensure safe current commutation. The Three phase output current of the grid-side current source converter can be represented by fourier series expansions given by
iwia (t )  Gaci mi idc (cos(s t  1 )  A5 cos (5(s t   5 ))  A7 cos (7 (s t   7 ))  ......) iwib (t )  Gaci mi idc (cos(s t  1  2 / 3)  A5 cos (5(s t   5  2 / 3))  A7 cos (7 (s t   7  2 / 3))  ......) iwib (t )  Gaci mi idc (cos(s t  1  2 / 3)  A5 cos (5(s t   5  2 / 3))  A7 cos (7 (s t   7  2 / 3))  ......) (A.16)

148

where

mi ,  i - modulation index and delay angle of the grid-side current source converter;

Gaci

- ac gain of the corresponding PWM modulation scheme. - fundamental frequency of the grid voltage and current;

s

An ,  n - coefficient and phase angle of the n th order harmonics, n= 5, 7, 11...
The coefficient of low order harmonics usually very small, the modeling for current source converters is derived based on the averaged model which neglects the harmonic components.

[iwi ]abc  Gaci [mi ] idc
Where

(A.17)

[mi ]abc

 mia   mi cos(s t   i )       mib    mi cos(s t   i  2 / 3)       m m cos(  t    2  / 3) s i  ic   i 

(A.18)

To derive the voltage relations, it is assumed that there are no power losses in the inverter. The power into and out of the inverter should be equal, that is,
vdciidc  [iwi ]T abc [vci ]abc

(A.19)

Substituting (A.17) into (A.19), the dc-link voltage equation can be expressed as

vdci  G aci mi [vci ]abc

(A.20)

By transforming above three phase equations into dq synchronous frame, the converter model can be given by
149

iwid   mid  i   Gaci  m  idc  wiq   iq 
vdci  1.5G aci (mid vcid  miq vciq )

(A.21)

(A.22)

where mid and miq are the equivalent d- and q-axis modulation indices of the converter respectively.


ig
PMSG

vcr iwr

S1

S3

S5

vdcr

 idc

icr Cr
S4
S6

S2



Fig. A-6 Configuration of generator-side CSC As shown in Fig. A-6, the generator-side converter has identical topology as grid-side converter but power flow in reverse direction. The equations on dq-synchronous frame are similar to above analysis and they are summarized as follows

iwrd   mrd  i   Gaci  m  idc  wrq   rq 
vdcr  1.5G acr (mrd vcrd  mrq vcrq )

(A.23)

(A.24)

where,  g is the electrical angular speed of the generator. mrd and mrq are the equivalent d- and q-axis modulation indices of the generator-side converter, respectively.
150

References
[1] T. Ackermann, "Transmission systems for offshore wind farms," Wind Power in Power Systems, pp. 479-503, 2005. [2] G. W. E. Council, "Global Wind Energy Outlook 2009," Global Wind Energy Council, 2009. [3] European Wind Energy Association, "The European Offshore Wind Industry-Key Trends and Statistics 2009," Retrieved August, vol. 13, 2010. [4] G. W. E. Council, "Global Wind Report: Annual Market Update 2011," GWEC Report, April, 2012. [5] S. Muller, M. Deicke and R. W. De Doncker, "Doubly fed induction generator systems for wind turbines," Industry Applications Magazine, IEEE, vol. 8, pp. 26-33, 2002. [6] L. Xu and P. Cartwright, "Direct active and reactive power control of DFIG for wind energy generation," Energy Conversion, IEEE Transactions on, vol. 21, pp. 750-758, 2006. [7] J. Dai, "Current source converters for megawatt wind energy conversion system," Dept of Electrical and Computer Engineering, Ryerson University, Toronto, 2010. [8] M. Dubois, H. Polinder and J. Ferreira, "Comparison of generator topologies for direct-drive wind turbines," in IEEE Nordic Workshop on Power and Industrial Electronics (Norpie 2000), Aalborg-Denmark, pp. 22-26, 2000. [9] T. Chan and L. Lai, "An axial-flux permanent-magnet synchronous generator for a directcoupled wind-turbine system," Energy Conversion, IEEE Transactions on, vol. 22, pp. 86-94, 2007. [10] M. Singh and A. Chandra, "Application of adaptive network-based fuzzy inference system for sensorless control of PMSG-based wind turbine with nonlinear-load-compensation capabilities," Power Electronics, IEEE Transactions on, vol. 26, pp. 165-175, 2011.

151

[11] J. Twidell and G. Gaudiosi, "Offshore Wind Power," Wind Eng, vol. 34, pp. 123-124, 2010. [12] L. Xu and B. R. Andersen, "Grid connection of large offshore wind farms using HVDC," Wind Energy, vol. 9, pp. 371-382, 2006. [13] J. R. Kristoffersen, "The Horns Rev wind farm and the operational experience with the wind farm main controller," Revue E-SociÃ©tÃ© Royale Belge Des Ãlectriciens, vol. 122, 2006. [14] Z. Chen and F. Blaabjerg, "Wind farm--A power source in future power systems," Renewable and Sustainable Energy Reviews, vol. 13, pp. 1288-1300, 2009. [15] M. Bilgili, A. Yasar and E. Simsek, "Offshore wind power development in Europe and its comparison with onshore counterpart," Renewable and Sustainable Energy Reviews, vol. 15, pp. 905-915, 2011. [16] Lie Xu, Liangzhong Yao and C. Sasse, "Grid Integration of Large DFIG-Based Wind Farms Using VSC Transmission," Power Systems, IEEE Transactions on, vol. 22, pp. 976-984, 2007. [17] X. Koutiva, T. Vrionis, N. A. Vovos and G. B. Giannakopoulos, "Optimal integration of an offshore wind farm to a weak AC grid," Power Delivery, IEEE Transactions on, vol. 21, pp. 987-994, 2006. [18] S. M. Muyeen, R. Takahashi and J. Tamura, "Operation and Control of HVDC-Connected Offshore Wind Farm," Sustainable Energy, IEEE Transactions on, vol. 1, pp. 30-37, 2010. [19] N. Kirby, L. Xu, M. Luckett and W. Siepmann, "HVDC transmission for large offshore wind farms," Power Eng J, vol. 16, pp. 135-141, 2002. [20] Lie Xu, Liangzhong Yao and C. Sasse, "Power electronics options for large wind farm integration: VSC-based HVDC transmission," in Power Systems Conference and Exposition, 2006. PSCE '06. 2006 IEEE PES, pp. 760-767, 2006.

152

[21] P. Bresesti, W. L. Kling, R. L. Hendriks and R. Vailati, "HVDC connection of offshore wind farms to the transmission system," Energy Conversion, IEEE Transactions on, vol. 22, pp. 37-43, 2007. [22] S. V. Bozhko, R. Blasco-Gimenez, R. Li, J. C. Clare and G. M. Asher, "Control of offshore DFIG-based wind farm grid with line-commutated HVDC connection," Energy Conversion, IEEE Transactions on, vol. 22, pp. 71-78, 2007. [23] S. Bozhko, G. Asher, Risheng Li, J. Clare and Liangzhong Yao, "Large Offshore DFIGBased Wind Farm With Line-Commutated HVDC Connection to the Main Grid: Engineering Studies," Energy Conversion, IEEE Transactions on, vol. 23, pp. 119-127, 2008. [24] A. Prasai, Jung-Sik Yim, D. Divan, A. Bendre and Seung-Ki Sul, "A New Architecture for Offshore Wind Farms," Power Electronics, IEEE Transactions on, vol. 23, pp. 1198-1204, 2008. [25] M. Liserre, R. CÃ¡rdenas, M. Molinas and J. Rodriguez, "Overview of multi-MW wind turbines and wind parks," Industrial Electronics, IEEE Transactions on, vol. 58, pp. 1081-1095, 2011. [26] N. Flourentzou, V. G. Agelidis and G. D. Demetriades, "VSC-based HVDC power transmission systems: An overview," Power Electronics, IEEE Transactions on, vol. 24, pp. 592-602, 2009. [27] S. Nishikata and F. Tatsuta, "A New Interconnecting Method for Wind Turbine/Generators in a Wind Farm and Basic Performances of the Integrated System," Industrial Electronics, IEEE Transactions on, vol. 57, pp. 468-475, 2010. [28] A. Mogstad and M. Molinas, "Power collection and integration on the electric grid from offshore wind parks," in Proc. Nordic Workshop on Power and Industrial Electronics, 2008. [29] A. B. Mogstad, M. Molinas, P. K. Olsen and R. Nilsen, "A power conversion system for offshore wind parks," in Industrial Electronics, 2008. IECON 2008. 34th Annual Conference of IEEE, pp. 2106-2112, 2008.

153

[30] E. Veilleux, "Interconnection of Direct-Drive Wind Turbines using a Series Connected DC Grid", Dept of Electrical and Computer Engineering, University of Toronto, Toronto, 2009. [31] D. Jovcic, "Offshore wind farm with a series multiterminal CSI HVDC," Electr. Power Syst. Res., vol. 78, pp. 747-755, 2008. [32] S. Lundberg, "Evaluation of wind farm layouts," EPE JOURNAL, vol. 16, pp. 14, 2006. [33] S. Lundberg, "Configuration Study of Large Wind Parks", M.S. Thesis, Chalmers Univ. of Technology, Goteborg, Sweden, 2003. [34] C. Meyer, M. Hoing, A. Peterson and R. W. De Doncker, "Control and design of DC grids for offshore wind farms," Industry Applications, IEEE Transactions on, vol. 43, pp. 1475-1482, 2007. [35] G. Ramtharan, A. Arulampalam, J. Ekanayake, F. Hughes and N. Jenkins, "Fault ride through of fully rated converter wind turbines with AC and DC transmission," Renewable Power Generation, IET, vol. 3, pp. 426-438, 2009. [36] C. Feltes, H. Wrede, F. W. Koch and I. Erlich, "Enhanced Fault Ride-Through Method for Wind Farms Connected to the Grid Through VSC-Based HVDC Transmission," Power Systems, IEEE Transactions on, vol. 24, pp. 1537-1546, 2009. [37] V. Akhmatova, A. H. Nielsenb, J. K. Pedersenc and O. Nymannc, "Variable-speed wind turbines with multi-pole synchronous permanent magnet generators. Part I: Modelling in dynamic simulation tools." Wind Eng, vol. 27, pp. 531-548, 2003. [38] O. Anaya-Lara, N. Jenkins, J. Ekanayake, P. Cartwright, M. Hughes and M. Hughes, Wind Energy Generation: Modelling and Control. Wiley, 2009. [39] G. Ramtharan, N. Jenkins and O. AnayaLara, "Modelling and control of synchronous generators for widerange variablespeed wind turbines," Wind Energy, vol. 10, pp. 231-246, 2007.

154

[40] B. Wu, Y. Lang, N. Zargari and S. Kouro, Power Conversion and Control of Wind Energy Systems. Wiley-IEEE Press, 2011. [41] J. Dai, D. Xu and B. Wu, "A Novel Control Scheme for Current-Source-Converter-Based PMSG Wind Energy Conversion Systems," Power Electronics, IEEE Transactions on, vol. 24, pp. 963-972, 2009. [42] Y. Lang, B. Wu and N. Zargari, "A novel reactive power control scheme for CSC based PMSG wind energy system," in Industry Applications Society Annual Meeting, 2008. IAS'08. IEEE, pp. 1-6, 2008. [43] J. Dai, D. Xu, Bin Wu and N. R. Zargari, "Unified DC-Link Current Control for LowVoltage Ride-Through in Current-Source-Converter-Based Wind Energy Conversion Systems," Power Electronics, IEEE Transactions on, vol. 26, pp. 288-297, 2011. [44] A. E. Outlook, US Energy Information Administration (EIA), 2011. [45] D. Xiang, L. Ran, J. R. Bumby, P. J. Tavner and S. Yang, "Coordinated control of an HVDC link and doubly fed induction generators in a large offshore wind farm," Power Delivery, IEEE Transactions on, vol. 21, pp. 463-471, 2006. [46] M. E. Montilla-DJesus, D. Santos-Martin, S. Arnaltes and E. D. Castronuovo, "Optimal operation of offshore wind farms with line-commutated HVDC link connection," Energy Conversion, IEEE Transactions on, vol. 25, pp. 504-513, 2010. [47] S. M. Muyeen, R. Takahashi, T. Murata and J. Tamura, "A Variable Speed Wind Turbine Control Strategy to Meet Wind Farm Grid Code Requirements," Power Systems, IEEE Transactions on, vol. 25, pp. 331-340, 2010. [48] P. Christiansen, K. JÃ¸rgensen and A. SÃ¸rensen, "Grid connection and remote control for the horns rev 150 MW offshore wind farm in denmark," in Proceedings of the 2nd International Workshop on Transmission Networks for Offshore Wind Farms, pp. 29-30, 2000.

155

[49] M. P. Bahrman and B. K. Johnson, "The ABCs of HVDC transmission technologies," Power and Energy Magazine, IEEE, vol. 5, pp. 32-44, 2007. [50] H. Zhou, G. Yang and H. Geng, "Grid integration of DFIG-based offshore wind farms with hybrid HVDC connection," in Electrical Machines and Systems, 2008. ICEMS 2008. International Conference on, pp. 2579-2584, 2008. [51] K. Eriksson, "Operational experience of HVDC LightTM," in AC-DC Power Transmission, 2001. Seventh International Conference on (Conf. Publ. no. 485), pp. 205-210, 2001. [52] A. Siemens, "Introduction into HVDC PLUS," Online:

https://www.Energyportal.Siemens.Com, 2008. [53] U. Axelsson, A. Holm, C. Liljegren, M. Aberg, K. Eriksson and O. Tollerz, "The gotland HVDC light project-experiences from trial and commercial operation," in Electricity Distribution, 2001. Part 1: Contributions. CIRED. 16th International Conference and Exhibition on (IEE Conf. Publ no. 482), 2001. [54] A. K. Skytt, P. Holmberg and L. E. Juhlin, "HVDC light for connection of wind farms," in Second International Workshop on Transmission Networks for Offshore Wind Farms Royal Institute of Technology Stockholm, Sweden, 2001. [55] P. Haugland, "It's time to connect: Technical description of HVDC LightÂ® technology," Ludvika, Sweden: ABB, 2006. [56] J. Glasdam, J. Hjerrild, L. H. Kocewiak and C. L. Bak, "Review on Multi-Level Voltage Source Converter Based HVDC Technologies for Grid Connection of Large Offshore Wind Farms," Online: http://vbn.aau.dk/ws/files/62819770/Glasdam_Review_on.pdf , 2012. [57] S. Meier, S. Norrga and H. P. Nee, "New voltage source converter topology for HVDC grid connection of offshore wind farms," in Proceedings of the 11th International Power Electronics and Motion Control Conference, EPE-PEMC, 2004.

156

[58] S. Meier, "Novel voltage source converter based HVDC transmission system for offshore wind farms," Licentiate Thesis, Royal Institute of Technology, Stockholm, Sweden, 2005. [59] M. Popat, Bin Wu and N. R. Zargari, "A Novel Decoupled Interconnecting Method for Current-Source Converter-Based Offshore Wind Farms," Power Electronics, IEEE Transactions on, vol. 27, pp. 4224-4233, 2012. [60] M. Popat, Bin Wu and N. R. Zargari, "A novel decoupled interconnecting method for current source converter based offshore wind farms," in Electric Machines & Drives Conference (IEMDC), 2011 IEEE International, pp. 711-716, 2011. [61] S. Bernet, "Recent developments of high power converters for industry and traction applications," Power Electronics, IEEE Transactions on, vol. 15, pp. 1102-1117, 2000. [62] P. Steimer, H. Gruning, J. Werninger, P. DÃ¤hler and G. Linhofer, "Series connection of GTO thyristors for high-power static frequency converters," ABB Rev., pp. 14-20, 1996. [63] Z. Chen, J. M. Guerrero and F. Blaabjerg, "A review of the state of the art of power electronics for wind turbines," Power Electronics, IEEE Transactions on, vol. 24, pp. 18591875, 2009. [64] K. Tan and S. Islam, "Optimum control strategies in energy conversion of PMSG wind turbine system without mechanical sensors," Energy Conversion, IEEE Transactions on, vol. 19, pp. 392-399, 2004. [65] R. Datta and V. Ranganathan, "A method of tracking the peak power points for a variable speed wind energy conversion system," Energy Conversion, Ieee Transactions on, vol. 18, pp. 163-168, 2003. [66] M. G. Simoes, B. K. Bose and R. J. Spiegel, "Fuzzy logic based intelligent control of a variable speed cage machine wind generation system," Power Electronics, IEEE Transactions on, vol. 12, pp. 87-95, 1997.

157

[67] M. Chinchilla, S. Arnaltes and J. C. Burgos, "Control of permanent-magnet generators applied to variable-speed wind-energy systems connected to the grid," Energy Conversion, IEEE Transactions on, vol. 21, pp. 130-135, 2006. [68] B. Wu, High-Power Converters and AC Drives. Wiley-IEEE Press, 2006. [69] B. Wu, J. Pontt, J. RodrÃ­guez, S. Bernet and S. Kouro, "Current-source converter and cycloconverter topologies for industrial medium-voltage drives," Industrial Electronics, IEEE Transactions on, vol. 55, pp. 2786-2797, 2008. [70] N. Zargari and G. Joos, "A three-phase current-source type PWM rectifier with feedforward compensation of input displacement factor," in Power Electronics Specialists Conference, PESC'94 Record., 25th Annual IEEE, vol. 1, pp. 363-368, 1994. [71] J. R. Espinoza and G. Joos, "State variable decoupling and power flow control in PWM current-source rectifiers," Industrial Electronics, IEEE Transactions on, vol. 45, pp. 78-87, 1998. [72] Y. Xiao, B. Wu, S. C. Rizzo and R. Sotudeh, "A novel power factor control scheme for high-power GTO current-source converter," Industry Applications, IEEE Transactions on, vol. 34, pp. 1278-1283, 1998. [73] E. Spooner and A. Williamson, "Direct coupled, permanent magnet generators for wind turbine applications," in Electric Power Applications, IEE Proceedings, pp. 1-8, 1996. [74] M. Tsili and S. Papathanassiou, "A review of grid code technical requirements for wind farms," Renewable Power Generation, IET, vol. 3, pp. 308-332, 2009. [75] J. Dai, Y. Lang, B. Wu, D. Xu and N. R. Zargari, "A Multisampling SVM Scheme for Current Source Converters With Superior Harmonic Performance," Power Electronics, IEEE Transactions on, vol. 24, pp. 2436-2445, 2009. [76] M. Popat, Bin Wu, Fangrui Liu and N. Zargari, "Coordinated Control of Cascaded CurrentSource Converter Based Offshore Wind Farm," Sustainable Energy, IEEE Transactions on, vol. 3, pp. 557-565, 2012.
158

[77] A. D. Hansen, P. SÃ¸rensen, F. Iov and F. Blaabjerg, "Centralised power control of wind farm with doubly fed induction generators," Renewable Energy, vol. 31, pp. 935-951, 2006. [78] S. Heier, Grid Integration of Wind Energy Conversion System. Chichester, U.K.: Wiley, 1998. [79] J. Morneau, A Comparative Evaluation of Low Voltage Ride through Solutions in Wind Turbines using Doubly Fed Induction Generators, 2009. [80] H. Q. TransÃnergie, "Transmission Provider Technical Requirements for the connection of power plants to the Hydro-QuÃ©bec Transmission System," Montreal: HQTÃ, 2006. [81] E. Netz, "Grid Code High and extra high voltage," E.ON Netz GmbH, Bayreuth, 2006. [82] C. Waltisberg, T. Setz,"Applying IGCT Gate Units," Application note, ABB Switzerland Ltd, 2011.

159

160

Glossary of Acronyms and Symbols
CSC DFIG DSP EESG FOC FPGA FRT GSVSC GTO HCS HVAC HVDC IGBT IGCT LCC LVRT MF MPPT PI PMSG PSF PWM SHE Current Source Converter Doubly-Fed Induction Generator Digital Signal Processor Electrically Excited Synchronous Generator Field Oriented Control Field Programmable Gate Array Fault ride-through Grid-Side Voltage Source Converter Gate-Turn-Off Thyristor Hill Climb Searching High Voltage AC High Voltage DC Insulated Gate Bipolar Transistor Integrated Gate-Commutated Thyristor Line Commutated Converter Low-Voltage Ride-Through Medium Frequency Maximum Power Point Tracking Proportional and Integral Permanent Magnet Synchronous Machine Power Signal Feedback Pulse-Width Modulation Selected Harmonic Elimination

161

STATCOM SVC SVM TSR VOC VSC WECS WFSC WFVSC WTG XLPE

Static Compensator Static Var Compensator Space Vector Modulation Tip Speed Ratio Voltage Oriented Control Voltage Source Converter Wind Energy Conversion System Wind Farm Supervisory Control Wind Farm Voltage Source Converter Wind Turbine Generator Cross-Linked Polyethylene Insulation

To avoid confusions, the variables in this dissertation are represented as follows.  The low-case letters normally refer to instantaneous quantities and upper-case letter refer to constants, average, or RMS value.  A variable with a suffix `a' or `b', or `c' represents its corresponding phase a, phase b or phase c component, respectively.  A variable with a suffix `d' or `q' stands for the corresponding direct -axis or quadrature axis components in the defined synchronous reference frame, respectively.   A variable with superscript `*' denotes the reference value of this variable. A variable with last character of suffix `i', where i  (1, 2,....., n) , denotes the variables for the corresponding turbine-generator unit in wind farm. The following provides explanations to the variables that are commonly used in this dissertation. Other variables which only appear in specific sections are explained in the context where they appear.

162

Voltages Vb base voltage of the system, which is the magnitude of the grid phase voltage d-axis, q-axis grid-side capacitor voltages in the synchronous frame d-axis, q-axis generator-side capacitor voltages in the synchronous frame dc-voltage of the generator-side converter dc-voltage of the grid-side converter average dc-voltage of the generator-side converter average dc-voltage of the grid-side converter generator terminal voltage d-axis, q-axis generator terminal voltage grid phase voltages magnitude of grid line to line voltage d-axis, q-axis grid voltage

vcid , vciq vcrd , vcrq
vdcr vdci Vdcr Vdci
vg

vgd , vgq
vao,vbo,vco
VLL

vsd , vsq

Currents Ib base current of the system, which is the magnitude of the grid phase current d-axis, q-axis grid-side capacitor currents in the synchronous frame d-axis, q-axis generator-side capacitor currents dc-link current d-axis, q-axis generator stator currents in the synchronous frame d-axis, q-axis generator stator currents in the synchronous frame d-axis, q-axis grid phase currents in the synchronous frame d-axis, q-axis grid phase currents reference in the synchronous frame
163

icid , iciq icrd , icrq
idc

igd , igq
* * igd , igq

isd , isq
* * isd , isq

iwid , iwiq iwrd , iwrq idc _ gen idc _ grid
* idc

d-axis, q-axis grid-side converter output currents in the synchronous frame d-axis, q-axis generator-side converter output currents in the synchronous frame minimum dc-link current requirement from generator-side converter minimum dc-link current requirement from grid-side converter reference dc-link current

Flux linkage

f

magnetic flux of the generator rotor

Frequencies and time constant

g
* g

electrical angular frequency of the generator reference electrical angular frequency of the generator mechanical angular frequency of the generator frequency of the grid voltage

m

s

Power and torque Pdc
Pg

power stored in the dc-link inductor generator output power grid real power output grid reactive power output grid-side converter real power output grid-side converter reactive power output turbine mechanical output power total wind farm real power output

Pgrid Qgrid Po Qo Pmech

P WF

164

Pcmd

active power command from system operator reactive power command from system operator electrical torque of the generator mechanical torque applied to the generator shaft

Qcmd Te Tm

LC components and generator parameters

Ci
Cr
J

filter capacitor on grid-side converter filter capacitor of generator-side converter inertia of the wind turbine and generator generator d-axis synchronous inductance in the synchronous frame dc-link inductance generator q-axis synchronous inductance in the synchronous frame grid-side equivalent line inductance number of pole pairs of the generator number of grid-side converter in operation generator stator resistance grid-side equivalent resistance

Ld
Ldc
Lq

Ls
np

ngrid Rg

Rs

Converter modulation scheme related

mr mi

modulation index of generator-side converter modulation index of grid-side converter delay angle of grid-side converters delay angle of generator-side converters

i

r

165

Ts fsw T1, T2, T0

counter period of the converter modulation scheme device switching frequency of the converter dwell times for active vector 1, active vector 2 and zero vector

Miscellaneous

vw
d/dt

wind speed derivative operator

166

