Ryerson University

Digital Commons @ Ryerson
Theses and dissertations

1-1-2013

Sensorless Current Source-Fed PM Drive System For Low Speed Operations
Ehsan Al-Nabi
Ryerson University

Follow this and additional works at: http://digitalcommons.ryerson.ca/dissertations Part of the Electrical and Computer Engineering Commons Recommended Citation
Al-Nabi, Ehsan, "Sensorless Current Source-Fed PM Drive System For Low Speed Operations" (2013). Theses and dissertations. Paper 1932.

This Dissertation is brought to you for free and open access by Digital Commons @ Ryerson. It has been accepted for inclusion in Theses and dissertations by an authorized administrator of Digital Commons @ Ryerson. For more information, please contact bcameron@ryerson.ca.

SENSORLESS CURRENT SOURCE-FED PM DRIVE SYSTEM FOR LOW-SPEED OPERATIONS

By

Ehsan Al-Nabi
B.Sc, Al-Mustansiria University, Iraq. 1992 M.A.Sc, Al-Mustansiria University, Iraq. 1997 M.A.Sc, Ryerson University, Canada. 2007

A dissertation presented to Ryerson University in partial fulfillment of the requirements for the degree of Doctor of Philosophy in the program of Electrical and Computer Engineering

Toronto, Ontario, Canada, 2013 © Ehsan Al-Nabi, 2013

ii

Author's Declaration

I hereby declare that I am the sole author of this dissertation. This is a true copy of the dissertation, including any required final revisions, as accepted by my examiners.

I authorize Ryerson University to lend this dissertation to other institutions or individuals for the purpose of scholarly research.

I further authorize Ryerson University to reproduce this dissertation by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. I understand that my dissertation may be made electronically available to the public.

iii

iv

Sensorless Current Source-Fed PM Drive System For Low Speed Operations
Ehsan Al-Nabi Doctor of Philosophy Electrical and Computer Engineering Ryerson University, Toronto, 2013

Abstract
In this thesis, a sensorless method for low and zero speed operation is proposed for a highpower medium-voltage pulse-width-modulated Current­Source-Converter (CSC)-fed Interior Permanent Magnet Motor (IPM) drive system. The proposed method is based on injection of a high-frequency (HF) pulsating sinusoidal signal into the estimated synchronous reference frame of the drive's Field Oriented Control (FOC) scheme. The conventional FOC control scheme, low switching frequency, dc-link inductor and the inverter output three-phase filter capacitor of the medium-voltage high-power current-source drive present some challenges in the generation and design of the HF injection signal. To overcome the challenges, the FOC scheme is modified by introducing a modulation index control with a suitable dc-link current compensation to enhance the dynamic response of the injected signal and prevent any clamp in the injected signal. In addition, a Multisampling Space Vector Modulation (MS-SVM) method is proposed to prevent the distortion in the HF signal due to a low switching frequency to injected signal ratio. It is found that by using the proposed FOC scheme and multisampling modulation scheme, and proper design of the HF signal, an accurate rotor flux angle can be estimated for sensorless zero/low speed operation.
v

Moreover, a novel input power factor compensation method is proposed for a high-power pulse-width-modulated Current-Source-Converter (CSC)-fed Permanent Magnet Synchronous Motor (PMSM) drive system. The proposed method is based on controlling the d-axis stator current component in the field-oriented control scheme of the drive system. The main feature of the proposed scheme is to compensate for the line-side power factor without the need for modulation index control in either the rectifier or the inverter. Simulation and experimental verification for various objectives are provided throughout the thesis. The results validate the proposed solutions for the main challenges of zero/low speed operation of sensorless Current-Source-Converter (CSC)-fed Permanent Magnet Synchronous Motor (PMSM) drive system.

vi

Acknowledgement
I would like to express my sincere gratitude to my supervisors, Professor Bin Wu and Professor Vijay Sood for their invaluable guidance, generous support, and consistent kindness throughout the course of the work. I would like to thank Dr. Navid Zargari, Prof. David Xu, and Dr. Moya Dai for many fruitful discussions, suggestions, and comments. I would also like to thank all my friends in the Laboratory of Electric Drives Application and Research (LEDAR) at Ryerson University, especially Dr. Metish Popat, Dr. Fangrui Liu, and Dr. Jason Wang for many useful discussions and joyful time that we shared together. My special thanks go to my wife, Nedea Jawad, for her everlasting love, support and understanding. I am also grateful to my kids Azher, Hassan and Ola, who always support me and cheer me up. My special thanks also go to my parents and brothers/sisters for their continuous encouragement and support. Financial support from Professor Bin Wu and Ryerson University/Rockwell Automation are gratefully acknowledged.

vii

viii

Table of Contents
Abstract...........................................................................................................................................v Acknowledgement........................................................................................................................vii Table of Contents..........................................................................................................................ix List of Figures and Tables.........................................................................................................xiii

Chapter 1 1.1 1.2

Introduction..............................................................................................................1 Background of sensorless drives...............................................................................4 Literature review for zero/low speed sensorless drives..............................................7 1.2.1 1.2.2 1.2.3 1.2.4 1.2.5 Vector excitation and current amplitude measurement................................8 Pulses excitation and current amplitude measurement..............................10 Rotating vector excitation and current demodulation...............................12 Pulsating vector excitation and phase measurement..................................14 Pulsating vector excitation and impedance measurement..........................16

1.3

Input PFC of the CSC-fed PMSM drive..................................................................17 1.3.1 1.3.2 1.3.3 Optimize line/motor capacitors..................................................................18 Detecting the input phase angle.................................................................18 Direct torque control..................................................................................19

1.4 1.5 Chapter 2 2.1 2.2

Dissertation objectives.............................................................................................21 Dissertation outline...................................................................................................23 Modeling and Control of CSC-fed PMSM Drive................................................26 Drive system configuration......................................................................................27 PWM modulation techniques...................................................................................28 2.2.1 Selective harmonic elimination (SHE)......................................................29
ix

2.2.2 2.2.3 2.3

Trapezoidal pulse width modulation (TPWM)..........................................31 Space vector modulation (SVM)...............................................................31

Mathematical model of the drive.............................................................................34 2.3.1 2.3.2 2.3.3 2.3.4 2.3.5 2.3.6 PM machine mathematical model.............................................................35 Current source converters model...............................................................39 Dc-link model............................................................................................45 Grid-side model.........................................................................................45 State-space equations.................................................................................46 Steady-state equations...............................................................................47

2.4 2.5

CSC drive control schemes......................................................................................48 Control schemes of CSC-fed PMSM drive.............................................................54 2.5.1 2.5.2 2.5.3 Zero d-axis current (ZDC) control............................................................54 Maximum torque per ampere (MTPA) control.........................................57 Unity power factor (UPF) control.............................................................60

2.6 Chapter 3 3.1 3.2 3.3 3.4 3.5 3.6

Conclusions..............................................................................................................64 Input Power Factor (PF) Control of PWM CSC-fed PM Drive........................66 Input PF in PWM CSC-fed drive system.................................................................67 Principle of the proposed PFC.................................................................................68 Mathematical derivation of proposed PFC scheme.................................................70 Analysis and control scheme of the proposed PFC.................................................75 Simulation results....................................................................................................78 Conclusions.............................................................................................................86

Chapter 4 Zero/low Speed Sensorless Control Using Pulsating High Frequency Injection Method........................................................................................................................................88

x

4.1 4.2 4.3 4.4

Introduction to sensorless signal injection method..................................................89 Technical challenges of HFI method with CSC-fed drive system...........................90 Saliency and saturation in PMSM machine ............................................................92 Types of high-frequency (HF) injection signals.......................................................94 4.4.1 4.4.2 4.4.3 PWM excitation.........................................................................................94 Rotating vector excitation..........................................................................95 Pulsating vector excitation.........................................................................96

4.5 4.6

High frequency model of CSC-fed PM drive...........................................................98 Proposed HF sensorless scheme for the CSC-fed IPM drive.................................103 4.6.1 4.6.2 Injection scheme......................................................................................103 Rotor angle estimation using HFI............................................................107

4.7 4.8

Proposed PWM modulation scheme......................................................................112 High-frequency signal design.................................................................................114 4.8.1 4.8.2 4.8.3 4.8.4 Effect of filter capacitor...........................................................................114 Effect of low switching frequency...........................................................117 Effect of saturation...................................................................................119 General design guide................................................................................120

4.9

Initial rotor position for CSC-fed PM drive...........................................................121 4.9.1 4.9.2 Conventional techniques..........................................................................122 Proposed initial rotor position-based iron saturation...............................123

4.9 4.6 Chapter 5 5.1 5.2

Time domain simulation of large drive..................................................................126 Conclusions............................................................................................................133 Experimental Verification...................................................................................136 Experimental prototype..........................................................................................136 Verification of power factor control method..........................................................138
xi

5.3 5.5 Chapter 6 6.1 6.2

Verification of zero speed sensorless method........................................................142 Conclusions............................................................................................................151 Conclusions and Future Work............................................................................153 Conclusions............................................................................................................153 Future works..........................................................................................................157

References..................................................................................................................................159 List of Publications....................................................................................................................172

xii

List of Figures and Tables
Figures Fig. 1-1 Main types of PMSM machines.........................................................................................2 Fig. 1-2 Different topologies for paper mills, (a) induction motor with gear system, (b) PMSM system..............................................................................................................................................3 Fig. 1-3 Sensorless voltage source drive with position estimation from voltage and current measurement....................................................................................................................................5 Fig. 1-4 Medium-voltage level CSC-fed PM drive system.............................................................7 Fig. 1-5 Sensorless voltage source drive using voltage vector excitation for rotor position estimation.........................................................................................................................................8 Fig. 1-6 Current response results from injecting narrow voltage pulses.......................................12 Fig. 1-7 Sensorless voltage source drive using rotating vector excitation method.......................14 Fig. 1-8 Sensorless voltage source drive using pulsating vector excitation method.....................17 Fig. 1-9 Power factor control scheme achieved by detecting the Input phase angle.....................19 Fig. 1-10 General block diagram of direct torque power factor control scheme...........................20 Fig. 1-11 Dissertation organization................................................................................................23 Fig. 2-1 Proposed configuration of a medium-voltage level CSC-fed PM drive system.............28 Fig. 2-2 PWM current source inverter...........................................................................................29 Fig. 2-3 SHE pattern that satisfies the CSC switching constraint.................................................31 Fig. 2-4 Trapezoidal pulse width modulation................................................................................32 Fig. 2-5 SVM modulation scheme (a) Space vector diagram (b) Vector synthesis.......................34 Fig. 2-6 Cross-section view of a simplified symmetrical three-phase, four poles PMSM machine..........................................................................................................................................36 Fig. 2-7 Simplified dq-axis model of PMSM in the rotating reference frame .............................39 Fig. 2-8 Phasor diagram of PMSM motor.....................................................................................40 Fig.2-9 Configuration of current source rectifier-side...................................................................40 Fig. 2-10 Configuration of current source inverter-side................................................................44 Fig. 2-11 Configuration of dc link.................................................................................................45
xiii

Fig. 2-12 Configuration of grid-side model...................................................................................46 Fig. 2-13 Detailed field-oriented control (FOC) scheme of the CSI-fed PMSM drive system.....50 Fig. 2-14 Detailed dc-link control scheme of the rectifier side.....................................................50 Fig. 2-15 Fixed dc-link current with online PWM scheme...........................................................51 Fig. 2-16 Variable dc-link current with fixed PWM scheme.........................................................53 Fig. 2-17 Variable dc-link current with online PWM scheme.......................................................53 Fig.2-18 CSI-FOC control scheme with ZDC control...................................................................54 Fig. 2-19 Performance of non-salient PM with ZDC scheme.......................................................55 Fig. 2-20 Performance of salient PM with ZDC scheme...............................................................56 Fig. 2-21 CSI-FOC control scheme with MTPA control...............................................................59 Fig. 2-22 Performance of salient PM with MTPA scheme............................................................59 Fig. 2-23 Performance of non-salient PM with UPF scheme........................................................62 Fig. 2-24 Performance of salient PM with UPF scheme...............................................................62 Fig. 2-25 CSI-FOC control scheme with UPF control..................................................................63 Fig. 3-1 Vector diagram of the input side converter......................................................................67 Fig. 3-2 Vector diagram of the whole CSC-fed PMSM drive system..........................................71 Fig. 3-3 Relationship between the d-axis stator current and the reactive line current component for fan-type load.............................................................................................................................72
* * Fig Fig. 3-4 Relationship between, I ds , I dc _ UPF , and I qw as a function of motor speed for fan-type load. (a)Cm =0.3 p.u. and Cg =0.4 p.u. (b) Cm =0.4 p.u. and Cg =0.5 p.u.......................................77

Fig. 3-5 Block diagram of the FOC scheme with the proposed control method...........................78 Fig. 3-6 Performance of the drive with PFC method with fan-type load......................................80 Fig. 3-7 Performance of the drive without PFC method with fan-type load.................................81 Fig. 3-8 Drive waveforms without the proposed input power factor compensation at light load condition(Vg 100V/Div, Iin 5A/Div, iw 10A/Div).........................................................................82 Fig. 3-9 Drive waveforms with the proposed input power factor compensation at light load condition(Vg 100V/Div, Iin 5A/Div, iw 10A/Div)..........................................................................84 Fig. 3-10 Drive waveforms without the proposed input power factor compensation at heavy load condition(Vg 100V/Div, Iin 10A/Div, iw 10A/Div)........................................................................85

xiv

Fig. 3-11 Drive waveforms with the proposed input power factor compensation at heavy load condition (Vg 100V/Div, Iin 10A/Div, iw 10A/Div)......................................................................86 Fig.4-1 Current Source drive with two injection option, through external circuit and through the inverter...........................................................................................................................................92 Fig.4-2 q-axis and d-axis inductance of the IPM motor with the change of the stator current......94 Fig. 4-3 Vector diagram representing the rotating vector excitation method................................95 Fig. 4-4 Conventional FOC control scheme of CSC-fed PM drive system with three phase HF rotating signal Injection.................................................................................................................96 Fig. 4-5 Vector diagram representing the Pulsating vector excitation method..............................97 Fig.4-6 Conventional FOC control scheme of CSC-fed PM drive system with q-axis HF pulsating signal..............................................................................................................................98 Fig. 4-7 Conventional FOC control scheme of CSC-fed PM drive system with d-axis HF pulsating signal..............................................................................................................................98 Fig. 4-8 Simplified HF equivalent circuit diagram of the CSC-fed IPM drive in the actual rotor reference frame............................................................................................................................102 Fig. 4-9 Block diagram of the proposed CSC-fed IPM drive system..........................................103 Fig. 4-10 Proposed FOC controllers of the CSC-fed IPM drive.................................................104 Fig. 4-11 Block diagram of the sensorless signal processor method and the rotor angle/speed estimator.......................................................................................................................................111 Fig. 4-12 SVM modulation scheme (a) Conventional SVM modulation method(b) Proposed MSSVM modulation method.............................................................................................................115 Fig. 4-13 D-q axis voltage responses to inverter current (a) Inverter d-axis voltage response to the inverter d-axis current ( vd / idw ) (b) Inverter q-axis voltage response to the inverter d-axis current ( vq / idw ).............................................................................................................................118 Fig. 4-14 Inverter q-axis voltage response to the inverter d-axis current ( vq / idw ) for two different q-axis inductances........................................................................................................................119 Fig. 4-15 Relation between the rotor position and the spatial inductance variation....................122 Fig. 4-16 Polarity-dependent saturation in the d-axis for 4-poles IPM synchronous machine. (a) permanent magnet flux and the armature current flux vector direction are aligned, (b) permanent magnet flux and the armature current flux are 180 degrees out of phase....................................124 Fig. 4-17 principle of the proposed polarity discrimination method...........................................125
xv

4-18 Overall proposed FOC control scheme with the proposed HF zero speed injection method.........................................................................................................................................127 4-19 Estimated and actual rotor flux angle with 0.47 Hz operating frequency with step load change from no-load to full-load.................................................................................................128 Fig. 4-20 Estimated and actual rotor flux angle with zero operating frequency with step load change from no-load to full-load.................................................................................................128 Fig. 4-21 Stator current with 0.47 Hz operating frequency with step load change from no-load to full-load.......................................................................................................................................129 Fig.4-22 Stator voltage with 0.47 Hz operating frequency with step load change from no-load to full-load.......................................................................................................................................130 Fig. 4-23 Estimated and actual speed at 0.47 Hz operating frequency with step load change from no-load to full-load......................................................................................................................132 Fig. 4-24 Estimated and actual speed at zero operating frequency with step load change from noload to full-load............................................................................................................................133 Fig.5-1 experimental setup of the CSC-fed PMSM drive system...............................................137 Fig. 5-2 Drive waveforms without the proposed input power factor compensation at light load condition. (Vg 100V/Div, Iin 5A/Div, iw 10A/Div).....................................................................139 Fig. 5-3 Drive waveforms with the proposed input power factor compensation at light load condition. (Vg 100V/Div, Iin 5A/Div, iw 10A/Div)......................................................................140 Fig. 5-4 Drive waveforms without the proposed input power factor compensation at heavy load condition. (Vg 100V/Div, Iin 10A/Div, iw 10A/Div)....................................................................142 Fig. 5-5 Drive waveforms with the proposed input power factor compensation at heavy load condition. (vg 100V/Div, iin 10A/Div, iw 10A/Div)....................................................................144 Fig.5-6 Line-to-line stator voltage and its frequency harmonic spectrum(a) Conventional SVM at motor speed of 2 rad/sec and no-load condition (b) Proposed MS-SVM (with higher signal/noise ratio) at motor speed of 2 rad/sec and light-load(0.2p.u.) condition............................................145 Fig.5-7 Line-to-line motor stator voltage, stator phase current and the frequency spectrum of the line-to-line motor stator voltage (a) Zero speed operation (b) 3.342 Hz electrical operating frequency......................................................................................................................................147
xvi

Fig.5-8 Estimated and actual rotor position during the start up from zero speed to 0.477Hz operating electrical frequency (a) No-load condition (b) Full load condition.............................148 Fig.5-9 Estimated and the actual rotor speed during load disturbance.(a) Zero speed (b) 0.954Hz operating electrical frequency......................................................................................................149 Fig. 5-10 d-axis stator current results from the high frequency injected signal when the rotor and the stator flux in the same direction (Correct polarity)................................................................150 Fig. 5-11 d-axis stator current results from the high frequency injected signal when the rotor and the stator flux in the opposite direction (wrong polarity)............................................................151

xvii

Tables
Table 1-1 Estimated position range based on current response.....................................................12 Table 2-1 Compression between ZDC, MTPA, and UPF schemes...............................................63 Table 3-1 MV CSC-fed Non-Salient PM drive System Parameters..............................................83 Table 3-2 LV System Parameters..................................................................................................83 Table 4-1 MV CSC-fed Salient PM drive System Parameters....................................................126 Table 5-1 Experimental LV System Parameters..........................................................................138

xviii

Glossary of Acronyms and Symbols
AC BPF CSC CSI CSR DC DSP EMF FOC FPGA GCT GTO HF HFI IGCT IM IPM LPF MS-SVM MTPA PF PFC Alternating Current Band-Pass Filter Current Source Converter Current Source Inverter Current Source Rectifier Direct Current Digital Signal Processor Back-electromagnetic-force Field Oriented Control Field Programmable Gate Array Gate-Commutated Thyristor Gate-Turn-Off Thyristor High-Frequency High-Frequency Injection Isolated Gate-Commutated Thyristor Induction Motor Interior Permanent Magnet Low-Pass Filter Multi-Sampling Space Vector Modulation Maximum Torque Per-Unit Ampere Power Factor Power Factor Compensation
xix

PI PM PMSM PWM SHE SPM SVM THD TPWM UPF VSC VSI VSR ZDC

Proportional and Integral Permanent Magnet Permanent Magnet Synchronous Motor Pulse-Width Modulation Selective Harmonic Elimination Surface Permanent Magnet Space Vector Modulation Total Harmonic Distortion Trapezoidal Pulse-Width Modulation Unity Power Factor Voltage Source Converter Voltage Source Inverter Voltage Source Rectifier Zero D-axis Control

To avoid the confusion, the variables in this dissertation are represented as follows.       The low case letters normally refer to instantaneous quantities and upper-case letter refer to

constant, average, or PMS value. A variable with a suffix 'a' or 'b', or 'c' represents its corresponding phase a, phase b or

phase c component, respectively. A variable or parameter with subscript h represents its corresponding high-frequency

component of that variable/parameter. A variable with superscript r denotes the rotor reference frame of this variable.

^ denotes the rotor reference frame of this variable. A variable with superscript r
A variable followed by (s) indicates the Laplace transformation of the variable.

xx

The following provides explanations to the variables that are commonly used in this dissertation. Other variables which only appear in specific sections are explained in the context where they appear.

Voltages

vas , vbs , vcs

motor phase voltages line capacitor voltage dc-voltage of the rectifier-side dc-voltage of the inverter-side input terminal voltage voltage across the dc-link inductance d-axis, q-axis rectifier-side voltages in synchronous frame rectifier terminal voltage d-axis, q-axis motor voltages in synchronous frame grid-side voltage stator phase voltage

vc
vdcr vdci

vi vLdc

vrd , vrq
vr

vsd , vsq
vsi

vs
Currents

ias , ibs , ics

motor phase currents d-axis, q-axis rectifier-side capacitor currents in synchronous frame d-axis, q-axis inverter-side capacitor currents in synchronous frame dc-current compensation dc-link current command dc-link current d-axis, q-axis grid-side currents in synchronous frame

icrd , icrq icid , iciq I_ comp Idc _ comp
idc

ird , irq

xxi

isd , isq iwrd , iwrq iwid , iwiq
iwra , iwrb , iwrc
Flux linkage

d-axis, q-axis motor currents in synchronous frame d-axis, q-axis rectifier output currents in synchronous frame d-axis, q-axis inverter output currents in synchronous frame rectifier output currents

 as ,bs ,cs

motor stator phase fluxes

 asm ,bsm ,csm permanent magnet flux linkage as it sweeps over the a, b, and c phases

f

magnetic flux of the motor rotor d-axis, q-axis motor stator flux linkage in synchronous frame

 sd , sq
Frequencies

h

angular-frequency of high frequency signal mechanical angular frequency of the motor electrical angular frequency of the motor frequency of grid voltage and current

m

r
s

Torque and angle

Te

motor electromagnetic torque load torque rotor position error rotor flux angle

TL

err

f

LC components and motor parameters

Cr

rectifier-side ac capacitor value

xxii

Ci
J

inverter-side ac capacitor value inertia of the load-motor mechanical system
motor self-inductances motor mutual inductances d-axis, q-axis motor magnetizing inductances

Laa , Lbb , Lcc Lab , Lba , Lbc

Lmd , Lmq
Lsm Ls Ld

motor spatial synchronous inductance
grid-side equivalent line inductance

motor d-axis synchronous inductance in synchronous frame motor q-axis synchronous inductance in synchronous frame dc-link inductance number of pole pairs of the motor motor stator resistance
grid-side equivalent resistance

Lq
Ldc
P R

Rs

Converter modulation scheme related

fs
fsw

sampling frequency of converter modulation scheme device switching frequency of the converter modulation index of current source inverter or rectifier equivalent d-axis, q-axis modulation indices of the rectifier-side in synchronous frame

ma

mrd , mrq
mra , mrb , mrc mr

equivalent phase modulation indices of the rectifier-side modulation index of the rectifier-side modulation index of the inverter-side equivalent d-axis, q-axis modulation indices of the inverter-side in synchronous frame

mi

mid , miq
mia , mib , mic

equivalent phase modulation indices of the inverter-side

xxiii

Ts

counter period of the converter modulation scheme dwell times for active vector 1, active vector 2, and zero vector delay angle of the inverter-side delay angle of the rectifier-side angle of a vector in the space vector plane relative angle of a vector within the sector it is located

T 1,T 2 ,T o

w

rec

ref
sec
Miscellaneous

d / dt
s

derivative operator Laplace operator

xxiv

xxv

Chapter 1 Introduction
In recent years, a growing interest has developed in the Permanent Magnet Synchronous Motor (PMSM) due to many desirable features such as high efficiency, low maintenance, high power density and high power factor [1-3]. Due to significant improvements in magnets and thermal properties of the permanent magnet materials, the rating of PMSM has increased to meet the requirements of high power applications [1,4-6]. In fact, the power ratings of PMSM have been extended from 1kW to 30MW. This increase in power rating and the above-mentioned advantages open a new area of research in the field of high power medium-voltage drives for these type of motors. In general, the permanent magnet synchronous motor can be classified into two main types: Surface Mount Permanent Magnet Motor (SPM) and Interior Permanent Magnet motor (IPM). When the magnets are mounted on the surface of the rotor, the machine is a surface mounted permanent magnet motor (also known as a non-salient type). When the magnets is placed inside the rotor, the machine is an interior permanent magnet motor (also known as a salient type) [3]. Fig. 1-1 shows the two main types of PMSM machines. This is contrary to the Induction Motor (IM) which is always considered as non-salient. In addition, PMSM has a constant rotor flux generated by the rotor permanent magnets and independent of the stator flux, while in the IM, the rotor flux is generated as a reaction to the stator flux.
1

Several manufacturers of electrical machines have in recent years developed large PMSM motors. The use of these large PMSM motors has been focused on the industries of ship propulsion, wind turbines, and paper mill machines [4,5]. For wind turbines and generators, Siemens has a product with a 3.3 MVA PM motor [5]. ABB has a medium voltage product of 4 kV wind turbines with a power range from 1 to 3 MW [7,8]. For ship propulsion applications, ABB has already produced different types of PM motors for different types of ships. These motors range in power from 400 kW to 5 MW and are typically used in offshore support vessels, floating oilrigs, cable layers, and ferries [9]. Siemens has developed propulsion motors with power ranges from 5 MW to 30 MW [10]. Rolls-Royce has developed a 180 rpm, 20 MW PM motor for propulsion of small warships [11]. For paper mill applications, ABB has developed a medium-speed PMSM motor for direct drive paper mill applications [12]. The new system replaces the induction motor and the gear as shown in Fig. 1-2. This reduces maintenance and increases the efficiency of the system.

Stator winding slot
S N

Stator
N S

Stator winding slot
S N

Stator

Shaft
Shaft
N

Shaft

Shaft
N S

Rotor
N

S

Rotor Air gap permanent magnet
S N

Permanent magnet

S N

S

Air gap

(a) Non-salient PM

(b) Salient PM

Fig. 1-1 Main types of PMSM machines

2

For high performance control of permanent magnet motors, information on the rotor position is indispensable. The position is traditionally measured by a sensor mounted on the shaft of the motor. The bulky position sensor increases the cost of the drive, makes the installation more difficult, and needs additional wiring. The position sensor reduces the reliability of the drive since its failure causes a break in the operation [13]. In worst case scenario, the process in which the drive is involved is also interrupted. This makes the sensorless topic one of the important research areas for the PMSM drive.

Driven roll(s)

Jackshaft Reducer

IM Encoder

(a) Driven roll(s) PMSM

(b)

Fig. 1-2 Different topologies for paper mills, (a) induction motor with gear system, (b) PMSM system [12]

In this thesis, a current source converter (CSC) is used for controlling the permanent magnet synchronous motor. Comprehensive work is carried out to analyze and design the control scheme of the CSC to solve different challenges at zero and low speed operation from different perspectives of system control and grid requirement.

3

This chapter continues with an introduction of the PMSM machine and the sensorless drives. Then a review of prior art for zero/low speed sensorless drives is provided. Other important challenges of the CSC-fed PMSM drive at low speed, such as poor input power factor, is also covered. Following that, the objectives and motivations of the thesis are defined. The organization of the thesis is summarized at the end.

1.1 Background of Sensorless Drives
The current flow in the windings of a permanent-magnet (PM) machine must be synchronized to the instantaneous position of the rotor, and therefore, the current controller must receive information about the position of the machine's rotor. As mentioned before, an auxiliary device (e.g., an optical encoder or resolver) may be used to measure rotor position, but there has been much interest in "sensorless" schemes, in which position information is derived by on-line analysis of the voltages and currents in the machine windings. Fig. 1-3 shows a schematic of a sensorless voltage source drive (VSD) scheme with a position estimator which operates by receiving measurements of motor voltages and currents and supplying rotor-position data to the current and speed controller. In the last few decades, many efforts in academia and industry were dedicated to the development of sensorless drives for induction machines and PMSMs. However, only recently was a breakthrough achieved, and some of the academic solutions were finally able to be implemented and used in industrial drives. The hesitant acceptance of the sensorless schemes on the part of manufacturers can be explained by the practical requirements that have to be fulfilled in industrial applications and systems. New control methods can only be accepted if they do not lead to an increase in costs or efforts. Thus, the elimination of the
4

angular sensor is not acceptable if it yields a necessity for the installation of additional computing power or special sensors, such as voltage or current sensors.

VSR Grid C

VSI

ia ib

va vb

PM

ia

ib
* va ,b , c

PWM

Position estimator



* r

+

^r 

Te Current Speed Controller Controller

*

^f

^f
d dt

Fig. 1-3 Sensorless voltage source drive with position estimation from voltage and current measurement

Despite the differences between induction machines and PMSMs, the sensorless approaches can be applied in the same manner although with an important difference: in the case of PMSM, the absolute position of rotor flux has to be detected for correct starting of the control, whereas the induction machine can be magnetized in any arbitrary direction.

5

In recent years, interest in zero speed sensorless drives utilizing permanent magnet motors has increased for vehicular, crane, and aircraft applications. In such applications, there is a requirement for direct electromechanical drives without using mechanical locking actuation and mechanical shaft speed sensors. It is well known that there are serious problems with sensorless motor drives at zero and low speeds, and this has been a topic of research in the field for many years. A number of zero/low speed sensorless methods have been reported so far [14]. Almost all of these methods have been applied to low and medium power levels of the standard VSI-based PMSM drive systems. As a competitor to the VSI drive, Pulse-width modulation (PWM) current source converter (CSC) fed ac motor drives, shown in Fig. 1-4, are often used in high power (1000-10000 hp) applications [15-18]. The CSC drive has the features of simple structure, reliable short circuit protection, four quadrant operation capacity, and nearly sinusoidal outputs. In addition, the switching device [symmetrical GTO or gate commutated thyristor (GCT)] used in the CSC can be easily connected in series, which makes the CSC drive particularly suitable for implementation at medium voltage (2300 V-7200 V) level [16]. However, the CSC drive has mainly focused on induction motor applications so far. To the author's knowledge, there has been no high-power medium-voltage PWM CSC-based permanent magnet synchronous motor drive reported. Therefore, it is worth while to investigate this type of drive in addition to its sensorless applications. Although the investigation of an accurate sensorless technique for the vector control drive was started after the 1980s, it is worth mentioning that very few publications of sensorless application have applied to the PWM CSC-based motor drives. However, most of the research conducted to date regarding sensorless CSC-based drives are based on the
6

back-EMF of the machine [19-21]. These methods are suitable only for high speed application and fail at low and zero speeds. Application of a sensorless PWM CSI-based drive under low and zero speed has not been reported on yet.
Ldc

idc

Grid Vs

Ls

iin v iw c
vdc
icg

iw

vs is
Motor

~
Cg

icm Cm

PWM Rectifier

PWM Inverter

Fig. 1-4 Medium-voltage level CSC-fed PM drive system

1.2 Literature Review for Zero/Low Speed Sensorless Drives
Several algorithms have been suggested in recent literature to achieve sensorless operation. Back-electromagnetic-force (EMF) or machine model-based estimator methods have been described in [11-25]. These methods work reasonably well at medium and high speeds, but as the speed decreases, their performance deteriorates. Furthermore, uncompensated inverter nonlinearity and stator resistance variations lead to unsatisfactory operation or even instability at low speed. Furthermore, at zero speed operation, the terminal stator voltage is zero. Therefore, the sensorless algorithm based on the machine model fails regardless of the algorithm's superiority.

7

In order to overcome the limitations of the machine model-based sensorless methods at zero and low-speed operation, another group of sensorless algorithms based on non-ideal characteristics of the machine (such as saliency) has been developed. The zero/low speed sensorless methods can be classified as follows.
VSR Grid C VSI

ia ib

va vb

PM

DSP
V12 V10

Phase a

V1

V3 V5

V8 V6 Phase b V 4

V7
V9 V11 Phase c

V2

Fig. 1-5 Sensorless voltage source drive using voltage vector excitation for rotor position estimation

1.2.1 Vector Excitation and Current Amplitude Measurement
This method is based on exciting the motor with test voltage vectors and observing the resulting phase current amplitude [26-28]. With a stand-still rotor and unknown rotor position, twelve voltage vectors are initially produced as shown in Fig. 1-5. The test voltage vectors are produced in the order V1,V2,V3,...V12. The orientation of the vectors are such that vector V1 is in phase with phase a winding. The produced vectors are such that even

8

vectors are of opposite direction with respect to previous odd vectors. For example, vector V2 is in the opposite direction with respect to vector V1. Similarly, vector V4 is in the opposite direction with respect to vector V3 as shown in Fig. 1-5. Therefore, if an odd vector happened to be located close to the magnet pole, then the difference between the absolute phase current produced by that vector and that produced by the successive even vector would be larger than zero because of the effect of magnetic saturation in the stator core. Therefore, the rotor position (i.e., the position of the magnetic north pole) can be determined by identifying the maximum difference between the absolute value of the odd and even current responses. Once the vector providing the maximum current response is identified from applying the twelve vectors of Fig. 1-5, more vectors can be applied in the vicinity of the maximum current difference in an effort to refine the search. In [26-28], four sets of vectors were used for that purpose. The first set constitutes the twelve vectors shown in Fig. 1-5, which permits the identification of the maximum with a 30-degree resolution. A second set of three vectors is thereafter applied to refine the search to a 7.5 degree resolution. This process is repeated two times to finally obtain a resolution of 1.875 degree. The advantage of this method is that it does not depend on rotor saliency and it is completely parameter independent. However, it has the disadvantage of being very slow. Therefore, it cannot be employed for low speed operation as its bandwidth is slow. A second disadvantage of this algorithm is that the production of test vectors causes rotor vibration.

9

1.2.2 Pulses Excitation and Current Amplitude Measurement
This method uses inductance variation due to saliency as well as the magnetic saturation properties of the stator core to detect the initial position of the rotor [29-31]. If a voltage is applied directly in phase with the phase a winding, the current response in phase a will be expressed by (1-1).
I a  I o  I a cos(2 f )

(1-1)

where I a is the phase a current, I o is the average current in the phase, I a cos(2 f ) is a sinusoidal component of the current that varies in proportion to twice the electrical rotor angle  f . This sinusoidal component exists as a result of the inductance variation caused by the presence of saliency in the motor. Similarly, if the voltages are applied directly in phase b and c of the motor, their respective current responses can be expressed by (1-2) and (1-3).

Ib  I o  Ib cos(2 f  2 / 3) I c  I o  I c cos(2 f  2 / 3)

(1-2)

(1-3)

In this method, the motor is excited at standstill with two types of voltage pulses. The first type of pulse has a narrow duty-cycle, such that it does not cause magnetic saturation in the stator core. The second type of pulse has a large duty cycle, and consequently causes the stator core to saturate. The current response in each phase is first obtained from applying the narrow duty-cycle pulses to each phase. Such responses can be plotted as a
10

function of the position as shown in Fig. 1-6. As can be seen from Fig. 1-6, the current responses of the narrow pulses follow (1-1), (1-2), and (1-3). Therefore, it is possible to estimate the rotor position based on the sign of I a , I b and I c as shown in Table 1-1. Also as shown in Table 1-1, the sign of I a , I b and I c can provide an estimate of the position with a 30-degree resolution and one combination of signs provides two possible position estimations. Therefore, this method does not differentiate between the position of the north magnetic pole and the south magnetic pole. To achieve such position polarity differentiation, the magnetic saturation properties of the stator core are utilized. The second type of voltage pulse is employed to cause magnetic saturation of the stator core. This large duty-cycle pulse is applied to the motor in the same manner as the narrow duty-cycle pulse. For this second test, because of magnetic saturation, the amplitude of the current flowing close to the north pole of the magnet will be different from that of the current flowing close to the south pole of the magnet. Based on this phenomena, the polarity of the magnet can be discriminated. The main advantage of this method is that it is parameter independent. However, it is too slow to be employed when the motor is turning. Therefore, it is only good for initial rotor position detection at standstill and does not work at low speed.

11

is ( A)
Ia

I c

I a

I b

Ib

Ic

Io

0

180

360

 f (deg)

Fig. 1-6 Current response results from injecting narrow voltage pulses Table 1-1 Estimated position range based on current response

 f (Degree) 345 to 15 165 to 195 15 to 45 195 to 225 45 to 75 225 to 255 75 to 105 255 to 285 105 to 135 285 to 315 135 to 165 315 to 345

I a
+ + -

I b
+ + +

I c
+

+

-

+ +

1.2.3 Rotating Vector Excitation and Current Demodulation
This method is based on excitation by high frequency sinusoidal rotating vector and demodulation of the corresponding high frequency currents [32-34]. The excitation signal is injected in the stationary reference frame and is therefore classified as a rotating vector.

12

The current feedback resulting from this excitation is thereafter separated from the actual motor current by using a high-pass filter and then is demodulated to extract the position information. The main feature of this method is that it can detect the rotor position at zero and low speed operation. Fig. 1-7 shows the control scheme of the voltage source drive with the rotating vector excitation sensorless method. As can be seen, the excitation voltages v h and v h are injected onto the

 -axis and  -axis of the stationary reference frame at a frequency of

h . The suffix "h" signifies "high frequency". The motor currents are thereafter filtered
using band-pass filters to extract the resulting high frequency current components. A certain current demodulation process was performed for the extracted high frequency currents before obtaining the estimated rotor position [33]. Since the excitation signal of this method is injected in the stationary reference frame, the method inherently remains open loop. In other words, the algorithm does not depend on an initial position estimate. This open-loop structure might limit the dynamic performance of this method. Furthermore, this method is robust to parameter variation as it is completely parameter independent. However, this method is still affected by the position polarity problem. In other words, it still provides a position estimate that is a function of twice the actual rotor position. Therefore, the actual rotor position must be detected by some other method.

13

v h  V h sin ht v h  V h cos ht
i
* q

+ -

v
PI PI

* q

i +

* d

* vd

Rotating to Stationary v

+ v + + + 2/3

VSI
v v v
* a * b * c

ia ib ic

M

-

^f
iq
id
Stationary To Rotating

LPF LPF BPF BPF

i
i
3/2

^

f

Demodulation process & Position estimation

Fig. 1-7 Sensorless voltage source drive using rotating vector excitation method

1.2.4 Pulsating Vector Excitation and Phase Measurement
This method is based on pulsating vector excitation. That is, a high frequency sinusoidal voltage is injected into the rotating reference frame of the motor. Then, the phase angle between the high frequency current component and the injected high frequency voltage is utilized to extract the rotor position information [35,36]. Initially the motor is unloaded, at standstill and the rotor position is unknown. The algorithm assumes that the d-axis is aligned with phase a. In other words, the algorithm assumes that the rotating reference frame is geometrically identical to the stationary reference frame and that

 f  0 . The excitation is thereafter performed in two sequences.

14

During the first sequence, a high frequency voltage is injected in the d-axis of the rotating reference frame, which is equivalent to the phase difference

 -axis of the stationary reference frame. The

d between the resulting d-axis high frequency current and the d-axis

voltage is measured. During the next sequence of excitation, a high frequency voltage is injected in the qaxis of the rotating reference frame, which is equivalent to the reference frame. The phase difference

 -axis of the stationary

q between the resulting q-axis high frequency

current and the q-axis voltage is measured. From the phase measurement obtained during the two excitation sequences, the angle of the rotor can be calculated as

 f   tan 1 (

K L tan d  tan q K L tan q  tan d

)

(1-4)

where K L 

L  L , L is stator inductance and L is the inductance difference. L

The position estimation obtained from (1-4) will have two different possible polarities. This phenomenon is once again caused by the nature of the methods based on inductance variation due to rotor saliency. The two possible polarities of the angle correspond to the two possible magnetic poles of the rotor magnet. This method can be used for detecting the initial rotor position only. Therefore, it is not suited for low speed operation. Furthermore, this method does not function appropriately if the motor, at standstill, is loaded. An additional disadvantage is the fact that unlike any other low and zero speed sensorless methods, this method is parameter dependent.
15

1.2.5 Pulsating Vector Excitation and Impedance Measurement
This method is based on injecting a pulsating high-frequency voltage signal into the machine [37-40]. The fundamental principle used is inductance variation due to rotor saliency. This method has demonstrated good dynamic performance even at heavy load conditions. In this method, a sinusoidal HF pulsating signal is injected into the synchronous reference frame of the drive control scheme. The purpose of injecting this HF signal is to excite or amplify the HF impedance of the motor, which contains position information. This impedance can thereafter be measured and processed for extracting the rotor position. Fig. 1-8 shows the control scheme of the voltage source drive with the pulsating vector excitation. As can be seen, the excitation voltage vdh is injected onto the d-axis of the rotating reference frame at a frequency of

h . The suffix "h" signifies "high frequency".

The motor currents are thereafter filtered using band-pass filters to extract the resulting HF current components. The HF impedance of the motor is calculated from the extracted HF currents and voltages before obtaining the estimated rotor position. The advantage of this method is that it can be employed for low and zero speed operation. It is also completely parameter independent and therefore is robust to parameter variations. However, this method is restricted to motors that contain saliency. Also, this method is still affected by the position polarity problem. In other words, it still provides a position estimate that is a function of twice the actual rotor position. Therefore, the actual rotor position must be detected by some other method.

16

It is worth mentioning that all of the abovementioned sensorless methods have been applied to voltage-source-converter (VSC)-fed drive systems with low and medium power applications. However, similar approaches for high-power medium-voltage current-sourceconverter (CSC)-fed drive systems have not yet been explored.

vdh  Vdh sin ht
i
* q

VSI
v
* a * b * c

+ -

PI PI + +

* vq

i +

* d

* vd

Rotating v to Stationary v

ia ib ic

M

-

^f
iq
id
Stationary To Rotating

LPF LPF BPF BPF

i
i
3/2

^f

Position estimation

Fig. 1-8 Sensorless voltage source drive using pulsating vector excitation method

1.3 Input PFC of the CSC-Fed PMSM Drive
Input power factor improvement is one of the main requirements and challenges for the CSC-fed drive system at low speed operation of a fan load type [41,42]. In the new generation of high power current source drives, as shown in Fig. 1-4, pulse-widthmodulated high-power current source rectifiers (CSR) are used to replace the thyristor rectifiers in most applications due to the improved line current waveforms, and reduced

17

costs, with the elimination of the input transformers. However, the input capacitor tends to cause the line PF to be leading especially at light load conditions or low speed operation as it may lead to penalty from the utility. Several methods have been developed for line power factor compensation as follows [43-49].

1.3.1 Optimize Line/Motor Capacitors
The input power factor of CSR-CSI can be compensated for by properly selecting the line-side and motor side capacitors [43]. As established in [43], in an optimal design of line and motor side capacitors for CSR-CSI-fed induction motor drives having fan/pump loads, the input power factor can be kept over 0.95 for a 30%-100% rated load. However, with fixed line-side and motor-side capacitors, the input power factor will vary with the load. Therefore, a unity power factor over the operating range cannot be guaranteed.

1.3.2 Detecting the Input phase angle
In this control scheme, the input power factor is controlled by two PI regulators, one in a feed-forward loop for modulating index control, and the other in a feedback loop for delay angle control as shown in Fig. 1-9. In the feed-forward loop, the detected phase angle

 between the source voltage Vs and current I s is compared with the phase angle reference

 * which is usually set at zero degrees to achieve unity power factor operation [44-46].
The resulting error  , shown in Fig. 1-9, is used to control the modulation index. In
* the feedback loop, the dc-current I dc is compared with the current reference I dc . The error

signal I is used to control the delay angle  . It should be noted that the magnitude of the
18

dc-current I dc is actually controlled by both feed-forward and feedback loops. This control scheme can guarantee the system input power factor is unity as long as the value of the modulating index is not saturated.
Grid

~

vs

Ls

is
C

iw

Ldc

idc

Load

CSR PWM Generator

LPF

LPF

LPF

Is

Vs

VZD

Power Factor Angle Detector

 * + -



PI

ma



PI

I dc * I - + I dc

Fig. 1-9 Power factor control scheme achieved by detecting the Input phase angle

1.3.3 Direct Torque Control
The direct torque control method is based on a non-linear state variables feedback approach in the dq rotating reference frame [47-49]. Fig. 1-10 shows a general control scheme of the direct torque control method. As shown in Fig. 1-10, this approach allows the independent control of the two components of the line current (active and reactive) with the same dynamic performance, regardless of the operating point. In this approach, a unity power factor can be achieved by controlling the reactive reference component to zero.

19

isd ,ref

+

1 sTac 1 sTac

ud
Input-output transformation

md

m

isd
SVM Technique

dq
mq

S wk

isq ,ref

+ -

uq

 m 

PWM CSR

isq

State variables and supply voltage

cos sin

Fig. 1-10 General block diagram of direct torque power factor control scheme It should be noted that almost all the above-mentioned methods require controlling the modulation index and phase angle in the rectifier-side for input power factor regulation. These schemes require an online PWM scheme such as Space Vector Modulation (SVM). However, using an online PWM modulation scheme for a high-power CSC-fed drive system, where low switching frequency is necessary, can cause significant low order harmonics and may excite the LC resonance, if not properly mitigated. To solve this problem, a SHE modulation scheme with variable modulation scheme may be considered. However, this approach requires a number of lookup tables with different modulation indices, and increases the implementation complexity. For these reasons, an input power factor compensation scheme using existing SHE-pattern modulation scheme can offer significant benefits in high-power current-source drives.

20

1.4 Dissertation Objectives
On the market of electric motor drives, the PWM CSC-fed induction motor (IM) systems are widely used in the high-power medium-voltage range. However, little research has addressed the application of CSC drives with permanent magnet motors prior to this work. Although the currently available PWM CSC drives can also work with permanent magnet motors, they are not intentionally designed for zero/low speed sensorless operation, and are also not designed to achieve unity power factor (UPF) at grid side at low speed with this particular type of motor. It is therefore important to understand these particular applications and focus on the special issues related to the PWM CSC-fed PMSM drive. The main objective of this thesis is to develop and design a sensorless control scheme for the high-power medium-voltage current source converter fed permanent magnet motor drive system for zero and low speed operation. This control scheme should work with 100% load torque at zero and low speed range. The second objective in this thesis is to develop and design an input power factor control scheme for a high-power medium-voltage current source converter-fed permanent magnet motor drive system. This control scheme must provide unity input power factor for all operating ranges including the very low speed range. Also, this control scheme must keep the existing rectifier's SHE modulation scheme of the drive system. The main objectives of this thesis are as follows.

21

1) System Modelling and Analysis According to the literature survey, little research work has been carried out on the CSCbased permanent magnet synchronous machine (PMSM)-fed drive system. It is therefore necessary to establish accurate models to study the steady-state and transient performance of the system. The first objective can be divided into the following goals: (a) development of a dynamic model for the whole CSC-fed PMSM drive system; (b) development of the steadystate model of the system; (c) evaluation of the PMSM control schemes; and (d) evaluation of the CSC control configuration.

2) Grid Power Factor Control The power factor (PF) control capability of the commercial medium voltage CSC-fed drive system is somewhat limited due to the loss of control freedom as result of using SHE. In order to achieve flexible PF control in the CSC-fed PMSM drive system at all ranges of speed, additional control freedom from the system needs to be employed. The second objective of the work, is to develop a new control scheme to achieve the unity power factor at all operating ranges including the very low speed range.

3) Zero/low Speed Sensorless Control The zero/low speed sensorless operation is considered a big challenge for electrical motor drives because of the limitation of sensorless-based motor model methods at that range of speed. In order to achieve zero/low speed sensorless operation with maximum torque capability, additional control signals have to be injected into the drive system.
22

The third objective of the thesis is to develop a new control scheme to address the zero/low speed sensorless operation of the CSC-fed PMSM drive system and enable this feature with maximum motor torque capability.

4) Polarity Identification As part of the sensorless speed operation of the CSC-fed PMSM drive, the initial rotor position of the PMSM motor needs to be determined. Therefore, proper control for the initial rotor position needs to be considered in the design of the drive. The fourth objective, is to design a new control for the sensorless CSC-fed PMSM drive to identify the polarity of the rotor for accurate initial rotor speed control.

1.5 Dissertation Outline
This dissertation consists of six chapters which are organized as follows. A diagram summarizing the main contents is provided in Fig. 1-11.

Low Speed Sensorless CSC Fed PM Drive System

Modelling & general Control Configuration

Input Power Factor Control

Zero/low Speed Sensorless Control

Experimental Verification

Fig. 1-11 Dissertation organization

23

Chapter 1 presents the background and introduction of the study. Chapter 2 carries out the development of system models and control configuration for CSC-fed PM drive system. The dynamic and steady state models are established. Different control configurations and schemes are presented for the CSC and the PM drive. Chapter 3 focuses on the input power factor improvement of the drive system. The major challenges of the power factor control are reviewed first. Then, a novel d-axis stator current control scheme is proposed to achieve unity input power factor over a wide range of speeds. Detailed implementation and functionality of the proposed control scheme are explained. The performance of the proposed control scheme is verified with analytical and time domain simulation. Chapter 4 focuses on zero/low speed sensorless control of the CSC-fed drive system. A novel control scheme is developed for the low/zero sensorless speed control. The proposed method is based on the injection high frequency (HF) approach. The general injection approach and different injection methods are first reviewed. A pulsating injection control scheme is then proposed for the current source converter fed-interior permanent magnet motor. Details of the proposed control structure, theoretical analysis and time domain simulation are elaborated. Chapter 5 carries out the experimental verification of the proposed power factor control method and the zero-speed high-frequency injection method. The chapter starts with an explanation of the experimental prototype. Then the experimental results of the proposed methods are provided with their explanation.

24

Chapter 6 summarizes the main contributions and conclusions of the dissertation. Possible future work is also suggested.

25

Chapter 2 Modeling and Control of CSC-fed PMSM Drive
In this chapter, a mathematical basis of the current source converter fed permanent magnet synchronous motor (CSC-fed PMSM) is discussed and derived. Various aspects such as pulse-width-modulation (PWM) schemes, control schemes of the CSC drive system, and control schemes of the PMSM drive system, are included in this chapter. The main objective of this chapter is to derive the dynamic and steady-state models of the CSC-fed PM drive system and to cover other important control aspects of the CSC-fed PMSM drive system. This provides the mathematical and theoretical basis for the control system design in the following chapters This chapter starts with the discussion and definition of the power circuit configuration of the CSC-fed PMSM drive system. Then the pulse-width-modulation techniques suitable for the high-power CSC drive system are introduced. After that, a detailed dynamic and steady-state mathematical models are derived and defined for the proposed CSC-fed PMSM drive system. Then the control schemes of the CSC drive system are discussed. Finally, a full steady-state study and analysis for three control schemes of the PMSM motor are performed and compared to give an idea about the existing control for that motor.

26

2.1 Drive System Configuration
In medium-voltage high-power electric drive applications (such as in the petrochemical, mining and metal industries), the PWM Current-Source Inverters (CSI) are used increasingly in motor speed control. Compared to Voltage-Source Inverter (VSI) fed drives, the current source approach offers simple converter topology, inherent regeneration, reliable fuse-less short circuit protection and low output voltage dv/dt. In the new generation high-power current-source fed drives, the thyristor rectifiers are replaced by PWM Current-Source Rectifier (CSR) to improve line-side current harmonics and the power factor. A Field-Oriented Control (FOC) scheme is usually used to improve the dynamic performance of the drive. It should be noted that most existing studies in the literature have mainly focused on speed and torque control of high-power induction machines. Very few publications have considered the CSC-fed PMSM drive system. Fig. 2-1 illustrates the proposed configuration of a medium-voltage level CSC-fed PM drive system. The illustrated configuration consists of a high power PM machine, three phase filter capacitors, and a full rating back-to-back PWM CSC. The PWM CSR is connected back-to-back with the PWM CSI through a dc-link inductor. As shown in Fig. 21, a number of switching devices can be connected in series in each phase leg to meet the voltage requirements. The input and output three-phase AC capacitors help the semiconductor switch commutations and filter out current harmonics. The size of these capacitors is mainly determined by the inverter/rectifier switching frequency. Since the CSC-fed drive system is usually used for high-power applications in which the device

27

switching frequency is often limited to around 600 Hz, a large capacitor between 0.2 p.u. and 0.5 p.u. is normally required.
Ldc

idc

vg Ls iin vc iw

iw

vs is
PMSM

~
Cg icg

vdc
icm

Cm

PWM Rectifier

PWM Inverter

Fig. 2-1 Proposed configuration of a medium-voltage level CSC-fed PM drive system

2.2 PWM Modulation Techniques
Various modulation techniques have been developed for the PWM CSI, including selective harmonic elimination (SHE), trapezoidal pulse-width-modulation (TPWM), and space vector modulation (SVM) [50-53]. In the back-to-back PWM CSC, the CSR and the CSI are similar in terms of modulation. Therefore, the above-mentioned modulation schemes can be applied to both of them. The SHE scheme is considered the best scheme in terms of the THD and therefore is usually used in the CSR side with a fixed input frequency of 60 Hz. However, in the case of the CSI, a combination of modulation schemes might be used for different operating frequency. A simplified PWM CSI, composed of six symmetric devices, and fed by an ideal dc current source is shown in Fig. 2-2. As mentioned before, the current commutations of the

28

converter necessitates a three-phase capacitor in parallel with the load. The switching pattern design for the CSI should generally satisfy two conditions: 1) the DC current idc should be continuous, and 2) the inverter PWM current iw should be defined. The two conditions can be translated into a switching constraint: At any instant of time (excluding commutation intervals), there are only two sets of series-connected switches conducting, i.e., one set in the top half of the bridge, such as S1 in Fig. 2-2, and the other in the bottom half of the bridge, such as S2. In this subsection the modulation techniques are introduced and discussed.

+

S1
A

S3

S5 iw

idc vdc

B C

PMSM

S4
-

S6

S2

Cf

Fig. 2-2 PWM current source inverter

2.2.1 Selective Harmonic Elimination (SHE)
The selective Harmonic Elimination (SHE) technique is an offline modulation scheme that can eliminate a number of unwanted low-order harmonics with a limited number of pulses. In this technique, the switching angles are recalculated and then imported into a digital controller for implementation. In order to achieve a better harmonic profile and to reduce the complexity in finding switching pattern solutions, the calculated pulses are
29

normally arranged in such a way that the derived PWM waveform has a quarter-wave symmetrical shape. In high power applications, where the SHE is usually preferable, low switching frequency is needed to reduce the losses. Therefore, three, five or seven switching angles per quarter of cycle are preferred. In the case shown in Fig. 2-3, five pulses are employed. This figure shows a typical SHE pattern that satisfies the CSC switching constraint. There are five pulses per half cycle with five switching angles in the first /2 period. However, only two out of the five angles, i.e, 1 and 2 are independent. Given these two angles, all other switching angles can be derived. The two switching angles provide the ability to eliminate two harmonics such as the 5th and 7th harmonic from the rectifier/inverter current waveform. This can be considered the main advantage of this technique since it is hardly possible by using other modulation techniques to remove these low order harmonics (5th and 7th). The main disadvantage of the SHE is the lack of flexibility for control as the offline calculated set of angles is valid at a certain modulation index. In practice, SHE is normally used with a fixed modulation index. If variation of the modulation index is needed, the solutions for all the required modulation indices have to be calculated offline and stored in a look-up table with their set of angles. This adds more complexity to the control scheme implementation and it is not practical in real applications. Moreover, the calculation of SHE angles with a large number of pulses per fundamental cycle sometimes involves transcendental equations that have no solutions, which prevents the SHE from being applied to a full frequency range.

30

iw

2


3

3

 1
I dc

0

1 

6


3

2 3



2

t

 2

Fig. 2-3 SHE pattern that satisfies the CSC switching constraint

2.2.2 Trapezoidal Pulse Width Modulation (TPWM)
The principle of the trapezoidal pulse width modulation (TPWM) for the current source fed drive is shown in Fig. 2-4, where the trapezoidal modulation is represented by vm and the triangular carrier wave is represented by vcr. Similar to the carrier-based PWM schemes for the voltage source fed drive (VSC), the gate signal is generated by comparing

vm with vcr . However, the trapezoidal modulation does not generate any gate signal in the
center  / 3 interval of the positive half cycle or in the negative half of the fundamental frequency. Such arrangements can satisfy the switching constraint of the current source converter.

2.2.3 Space Vector Modulation (SVM)
Similar to the voltage source converter, the current source converter can also be controlled by the space vector modulation (SVM). A typical space vector diagram for the current source converter is shown in Fig. 2-5(a), where I1  I 6 are active vectors and I 0 is a

31

zero vector. The active vectors form a regular hexagon with six equal sectors, whereas the zero vector I 0 lies at the center of the hexagon.

vcr

vm Vm Vcr
2 3

0


3



2

t

iw
I dc
0

3
2 3



2

t

Fig. 2-4 Trapezoidal pulse width modulation The desired three-phase output current of the current source converter can be expressed as a reference vector I ref rotating counter clockwise in the vector plane. For a given length and position, I ref can be synthesized by three nearby stationary vectors, based on which the switching states of the inverter can be selected and gate signals for the switches can be generated. When I ref passes through sectors one by one, different sets of switches are turned on or off. The inverter output frequency corresponds to the rotating speed of I ref , whereas the magnitude of the output current can be adjusted by the length of I ref . The ratio between the magnitudes of I ref and the dc link current I dc determined the modulation index

32

ma of the converter, given as ma  I ref / I dc . The angle  ref is defined as the phase
displacement between the reference vector and  axis of the vector plane. As shown in Fig. 2-5(b), the reference vector I ref can be synthesized by the adjacent vectors based on the ampere-second balance principle, that is, the product of the reference vector I ref and the sampling period Ts equals the sum of the current vectors by the time interval of chosen space vectors. Assuming that the sampling period Ts is sufficiently small, the reference vector I ref can be considered constant during Ts . Under this assumption, the reference vector
I ref can be synthesized by vectors I1 , I 2 and I 0 . There

ampere-second balancing equation is thus given by

  I ref Ts  I1T1  I 2T2  I 0T0   Ts  T1  T2  T0
The vector dwelling times can be derived by solving (2-1),

(2-1)

T1  ma sin( / 3  sec )Ts  T2  ma sin secTs T  T  T  T s 1 2  0

(2-2)

where sec is the displacement angle of the reference vector within a certain sector. Therefore, its value is in the range of 0  sec   / 3 . Once the vector dwelling times are calculated, the vector sequence in a sampling period needs to be determined for the generation of PWM pulses. Different sequence patterns can be generated, however, the selection of the sequences are associated with different device switching frequencies and harmonic profiles. One of the most widely-used sequences is called a three-segment
33

sequence. The switching pattern generated with this sequence has the advantage that the transition from one sector to another required only one device switch-on and one device switch off. Hence, in each sampling period, three switch-ons and three switch-offs take place, which is equivalent to three full device switching. Therefore, if the sampling frequency is f s  1/ Ts , the corresponding device switching frequency is f sw  f s / 2 .
J

I3 In2 I4
Sector III Sector II

I2
I ref

T2 In2 Ts

I ref

 ref
Sector IV



In0

Sector I

sec

Sector n

I0
Sector V Sector VI

I5

I1

T1 I n1 Ts
I n1

I6
(a) (b)

Fig. 2-5 SVM modulation scheme (a) Space vector diagram (b) Vector synthesis

2.3 Mathematical Model of the Drive
In this section, a dynamic and steady state mathematical models of the CSC-fed PM drives are established. As mentioned earlier, the illustrated configuration, shown in Fig. 21, consists of a high power PMSM motor, a full rating back-to-back CSC and the input and output filter capacitors. The back to back CSC can be divided into a current source inverter
34

side (motor-side converter) and a current source rectifier side (grid-side converter) interconnected through a dc-link inductor. The modeling starts with each part of the system. Then all the derived equations are combined to represent the whole system. In this work, the motor-side equations are derived with respect to the motor rotor flux oriented synchronous reference frame, whereas the grid-side equations are obtained based on the grid-side filter capacitor voltage oriented synchronous frame.

2.3.1 PM Machine Mathematical Model
Fig. 2-6 shows the cross-section view of a simplified symmetrical three-phase, four poles PMSM machine. The stationary three-phase winding as, bs, and cs are displaced by 120 electrical degree from each other. In the PMSM machine, the d-axis is aligned with the North pole of the permanent magnet in the rotor and the q-axis is 90o electrical degrees a head of the d-axis of the machine. The three phase voltages of the PMSM machine (shown in Fig. 2-6) can be described by the following equations [54-56].

d  vas  Rias  dt  as  d  vbs  Ribs   bs dt  d  vcs  Rics  dt  cs 

(2-3)

35

bs

permanent magnet Rotor
N S

S N

Shaft

qax is
Stator
N S

f
cs
N

d-axis

Air gap
S

Fig. 2-6 Cross-section view of a simplified symmetrical three-phase, four poles PMSM machine The flux linkage equations of the PMSM machine can be expressed as

as

 as   Laa     L  bs   ba   cs     Lca

Lab Lbb Lcb

Lac  ias   asm      Lbc   ibs    bsm  Lcc    ics     csm  

(2-4)

where Laa, Lbb, and Lcc are the self-inductances of the PM machine, and

Lab= Lba, Lbc=

Lcb, and Lca= Lac are the mutual inductances of the machine. The self and the mutual inductances of the PM machine can be expressed as [56]
 Laa  Lls  Lma  Lls  L0 s  L2 s cos 2 f   Lbb  Lls  Lmb  Lls  L0 s  L2 s cos(2 f  2 / 3)  L  L  L  L  L  L cos(2  2 / 3) ls mc ls 0s 2s f  cc   Lab  Lba  0.5L0 s  L2 s cos(2 f  2 / 3)  L  L  0.5L  L cos(2 ) cb 0s 2s f  bc   Lca  Lac  0.5L0 s  L2 s cos(2 f  2 / 3)
36

(2-5)

where Lls is the leakage inductance, f is the electrical angle of the rotor position, and Lma, Lmb, and Lmc are the magnetizing inductances of the stator phases. The inductance L0s is the dc component of the magnetizing inductance, whereas L2s is the magnetizing component of the inductance that changes with the second order of the rotor position. The fluxes asm, bsm, and csm are the flux linkages created by the permanent magnet as it sweeps over the as, bs, and cs windings, and
 asm   f cos  f   bsm   f cos( f  2 / 3)   csm   f cos( f  2 / 3)

(2-6)

where f is the magnitude of the flux linkage of the permanent magnet. Accordingly, the direct axis and the quadrature axis inductances are defined as
 Lmd  1.5( L0 s  L2 s )  L  1.5( L  L ) 0s 2s  mq   Ld  Lls  Lmd  Lq  Lls  Lmq 

(2-7)

where the Ld and Lq represent the synchronous inductances of the permanent magnet machine. In the case of the interior permanent magnet, the q-axis inductance Lq is usually greater than the d-axis synchronous inductance (Lq>Ld). In these types of motors, the value of the Lq is usually between 0.7 p.u. to 2.0 p.u. In case of the surface mount permanent magnet, the q-axis and the d-axis inductances are equal (Lq=Ld) and usually the value of the inductance is between 0.4 p.u. and 1.2 p.u.

37

To easily describe vector control on the PM machine, the machine equations in (2-3) are transformed to the d-q synchronously rotating reference frame. The d- and q-axis are defined as in Fig. 2-6. The machine dynamic equations in the synchronously reference frame can be represented as follows

d  vsd  Risd   sd  r sq   dt  v  Ri  d     sq sq sq r sd  dt 
where

(2-8)

  sd   f  Ld isd    sq  Lqisq

(2-9)

The dynamic equations of the machine can be rearranged by combining (2-8) and (2-9),

d  v  Ri  L isd  r Lq isq sd sd d   dt  v  Ri  L d i   L i    sq sq q sq r d sd r f  dt 

(2-10)

Fig. 2-7 shows a simplified model for the permanent magnet synchronous motor, which is derived based on (2-10). Where the core loss in the rotor is neglected. Fig. 2-8 shows the vector diagram of the motor model, where,

 and 

represent the stator voltage

and current angles with respect to the back-emf voltage of the motor. The angle



is also

called the torque angle of the motor. The electromagnetic torque equations of the motor can be

represented by

Te 

3 P[ f isq  ( Lq  Ld )isqisd ] 2
38

(2-11)

Te  TL  J

d r dt

(2-12)

where J is the total moment of inertia of the load-motor mechanical system, TL is the mechanical torque applied by the load, Te is the electromagnetic torque produced by the motor, P is the number of pair poles of the motor, and r is the electrical angular velocity of the rotor. The first term in (2-11) represents the magnet torque due to the rotor permanent magnet flux f, the second term represents the reluctance torque component due to the interaction between the stator d-q axes current components and the inductances of the PMSM machine. In terms of the SPM, where Lq=Ld, the reluctance torque component is zero.
isd
+

Ldc

R

- + r Lq isq

vsd
vdc

Ld

Current Source Inverter (CSI)

-

isq
+

R

+ -

+ -

vsq
-

r Ld isd r f

Lq

Fig. 2-7 Simplified dq-axis model of PMSM in the rotating reference frame

2.3.2 Current Source Converters Model
In the back-to-back current source converter configuration shown in Fig. 2-1, the rectifier- and inverter-side have the same topology, but they have reversed energy flow. In
39

this section, the modeling of the rectifier-side will be derived first, then the same method can be applied to the inverter-side.
q-axis

r Lq I qs

r Ld Ids
Vs Is


E  r f

 

s

Ld Ids

Lq I qs

f

d-axis

Fig. 2-8 Phasor diagram of PMSM motor

+

Grid

ir

vr

iwr
vdcr

~
icr Cr

idc

-

Fig. 2-9 Configuration of current source rectifier-side The configuration of the rectifier side CSC is shown in Fig. 2-9. The ac side of the converter has a three-phase current modulated waveforms generated by the gating signals

40

of the devices. The device switching actions generate high-frequency harmonics into the system. The ac capacitors work as a filter for the current harmonic in addition to its main function to maintain safe current commutation.

(a) Three-phase equation in the stationary frame The general representation of the ac side current waveform can be expressed as,
iwra  mr idc (cos(s t  1 )  a5 cos(5(st   5 ))  a7 cos(7(st   7 ))  ...) iwrb  mr idc (cos(s t  1  2 / 3)  a5 cos(5(st   5  2 / 3))  a7 cos(7(st   7  2 / 3))  ...) iwrc  mr idc (cos(s t  1  2 / 3)  a5 cos(5(s t   5  2 / 3))  a7 cos(7(st   7  2 / 3))  ...)

(2-13) where mr, 1 - modulation index and delay angle of the grid-side current source converter; s - fundamental frequency of the grid voltage and current

an ,  n - coefficients and phase angles of the nth order harmonics, n=5,7,11,...

The modulation index mr is usually equal to 1 when SVM modulation is used and in the range of 1.02 to 1.04 for the SHE modulation scheme. The coefficient a5 , a7 and a11 becomes small or approaches zero for the modulated PWM converter output current. The high order harmonic components are substantially reduced by the LC filters. Also, the dynamic performance of the system are determined primarily by the fundamental component of the system variables. Therefore, the effects of the harmonics can be

41

neglected. Based on the above-mentioned two reasons and by incorporating the phase information into the modulation index, (2-13) can be simplified by

iwr abc  mr abc idc
where

(2-14)

mr cos(s t   r )  mra        mr    mrb    mr cos(st   r  2 / 3)       mrc   mr cos(s t   r  2 / 3)  

(2-15)

The power balance of the rectifier-side gives the following equation with loss in circuit neglected.
vdcr idc  iwr abc vr abc
T

(2-16)

substituting (2-14) into (2-16), the dc-link voltage vdcr can be derived as a function of the three-phase voltage vcr abc and the three-phase modulation indices.
vdcr   mr abc vr abc
T

(2-17)

The ac current equations can be obtained based on the three-phase circuit given in Fig. 2-9.

icr abc  Cr vr abc

d dt

(2-18)

ir abc  iwr abc  icr abc
where Cr and is the rectifier filter capacitor.
42

(2-19)

(b) The dq-axis equations in rotating synchronous frame As mentioned before, the design of the control system is based on the defined rotating synchronously reference frame. Therefore, it is desirable to transform the above three-phase equations into the dq synchronous frame. Performing frame transformation on (2-14), (217) and (2-18), we have,

iwrd   mrd  i    m  idc  wrq   rq 
vdcr  1.5(mrd vrd  mrq vrq )

(2-20)

(2-21)

 d vrd   0 icrd   i   Cr   dt  vrq    crq     s

 C s  vrd    r     0    vrq    C  r 

d  vrd  s Cr vrq  dt  d vrq  s Cr vrd   dt 

(2-22)

ird  iwrd  icrd  i    i  i   rq   wrq crq 

(2-23)

where mrd and mrq are the equivalent d- and q-axis modulation indices of the converter, respectively. The inverter-side as shown in Fig. 2-10 has similar equations as those listed above, and they are summarized as below.

43

+

S1 idc vdci
A

S3

S5 iwi is
PMSM

B C

ici
-

S4

S6

S2

Ci

Fig. 2-10 Configuration of current source inverter-side

iwid   mid  i    m  idc  wiq   iq 
vdci  1.5(mid vsd  miq vsq )

(2-24)

(2-25)
d  vsd  r Ci vsq  dt  d vsq  r Ci vsd   dt 

 d vsd   0 icid   i   Ci   dt  vsq   ciq      r

 C r  vsd    i     0    vsq    C i  

(2-26)

isd  iwid  icid  i    i  i   sq   wiq ciq 

(2-27)

In the above-mentioned equations, r is the electrical angular speed of the motor and

Ci is the inverter filter side capacitor. mid and miq are the equivalent d- and q-axis
modulation indices of the motor-side converter, respectively.

44

2.3.3 DC-link Model
The motor-side and grid-side current source converters are linked by the dc-link inductor as shown in Fig. 2-11. The dc-link current is given by ,
d idc  vdcr  vdci dt

vLdc  Ldc

(2-28)

Replace vdci and vdcr in (2-28) with (2-21) and (2-25), we have,
d 1.5 idc  (mrd vrd  mrq vrq  mid vsd  miq vsq ) dt Ldc

(2-29)

idc
Current Source Rectifier Side +
vdcr

Ldc
+ vLdc +

vdci
-

-

Current Source Inverter Side

Fig. 2-11 Configuration of dc link

2.3.4 Grid-side Model
The grid side can be modeled as a voltage source with a small source impedance ( Ls and Rs) as shown in Fig. 2-12. Ls represents the sum of the line impedance and the leakage inductance of the transformer, while Rs stands for the transformer and line losses. The three-phase equation can be derived in a straight-forward manner from the equivalent circuit
45

d is abc dt



1 Ls

 v 

is abc

  vi abc  Rs is abc



(2-30)

The dq-axis equations based on the grid voltage oriented synchronous frame are,
 v  Ls vid   isd  v    iq   v  L isq s   diid   s Ls isq  Rs iid  dt  diid  s Ls isd  Rs iiq   dt 

(2-31)

Ldc

vsi

ii

Ls

Rs

vi
Current Source Rectifier Side
vdcr

Fig. 2-12 Configuration of the grid-side model

2.3.5 State-space Equations
By combining all the equations derived for the motor, converters, dc-link, and the grid, a 10th order dynamic system is constructed to simulate the dynamic behavior of the CSC fed PMSM drive. The state-space dynamic system are listed below.

46

1 d  dt isd  L  vsd  Risd  r Lq isq  d  1 d  dt isq  L  vsq  Risq  r Ld isd  r f  q  d 1  vds  r vqs   mrd idc  ids  Cr  dt d 1  vqs  r vds   mrq idc  iqs  Cr  dt d P Tm  1.5 P iqs f   Lq  Ld  iqs ids  r  J  dt   d isd  s isq  1 (visd  vid  Rs isd )  dt Ls   d i   i  1 (v  v  R i ) s sd isq iq s sq  dt sq Ls   d v   v  1 i  m i  s iq id id dc  dt id Ci   d v   v  1 i  m i  iq iq dc  s id  dt iq Ci   d i  1.5 m v  m v  m v  m v rd rd id sd iq sq   dt dc L  rd rd dc 







(2-32)

2.3.6 Steady-state Equations
The steady state of the equations of the system can be derived by setting the differential terms in (2-32) to zero.
vds  Rids  r Lqiqs
vqs  Risq  r Ld isd  r f

(2-33)

(2-34)

iwrd  mrd idc  r Ci vsq  isd iwrq  mrqidc  r Ci vsd  isq

(2-35)

(2-36)

47

Tm  1.5P iqs f   Lq  Ld  iqsids
vid  s Lsisq  visd  Rsisd viq  s Lsisd  visq  Rsisq mid idc  sCr viq  iid
miqidc  sCr vid  iiq mid vid  mid vid  mrd vsd  mrq vsq





(2-37)

(2-38)

(2-39)

(2-40)

(2-41)

(2-42)

The above equations can be used to calculate the steady-state values of the system variables according to an arbitrary set of the system inputs. Among the system inputs, vid and viq represents the grid capacitor voltage. In the input capacitor oriented synchronous frame, vid equals to the magnitude of the measured input capacitor voltage whereas viq is equal to zero. The value selection of the control variables, mrd, mrq, mid and miq, depends on the specific control algorithms employed for the drive system.

2.4 CSC Drive Control Schemes
Fig. 2-13 illustrates the detailed field-oriented control (FOC) scheme of the CSI-fed PMSM drive system. The outputs of the FOC scheme are the reference dc-link current and the reference switching angle for the inverter. The synchronous q-axis stator current component is generated from a speed feedback loop (with a simple PI controller). The daxis current reference can be controlled by a number of methods to achieve different machine performance. This will be discussed in more details in the next Section.
48

By substituting (2-33) and (2-34) into (2-35) and (2-36), the synchronously rotating
* * reference frame inverter-command currents idw and iqw , can be calculated as

* 2 2 * *  idw  r Cr f  r Cr Ld ids  ids * 2 * *  iqw  r Cr Lqiqs  iqs

(2-43)

The stator resistance in high-power motors is normally very low, and therefore it is neglected in (2-43) for simplicity with little errors. Using (2-43), the inverter switching

angle inv and the dc-link current command can be obtained in (2-44) and (2-45), where  f is the rotor flux reference frame angle, usually measured using a rotor shaft position sensor or estimated by different techniques depending on the speed operating range . In (2-44), and (2-45), it is assumed that both the rectifier and the inverter are controlled with phase angle control and unity modulation indices minv  1 .
*  iqw   tan  *    f i   dw  1

inv

(2-44)

* * 2 * 2 idc  (idw )  (iqw )

(2-45)

Fig. 2-14 illustrates the detailed dc-link control scheme of the rectifier side. In this scheme, the dc-link current will follow the dc-link current reference using a simple PI regulator. The output of the dc-link current PI regulator is the average dc voltage reference, which subsequently generates the switching delay angle reference for the rectifier.

49

i

* sd

* iwd

Cartesian to Polar

r*

+ -

r

Speed controller

Capacitor Compensation
* iwq

* idc

d/dt
+

w
+

f

inv

Fig. 2-13 Detailed field-oriented control (FOC) scheme of the CSI-fed PMSM drive system.

* vdci * idc

+ -

Current controller

1 1.5Vi

 rec
cos -1
+ -

 rec

 ci

idc

Vi

PLL

Fig. 2-14 Detailed dc-link control scheme of the rectifier side Now, based on how to implement the overall control scheme, controlling the dc-link current and the switching pattern, the control of the CSC can be classified into three techniques as follows [57]

A. Fixed dc-link current scheme with online PWM (SVM with ma control) In this configuration, the rectifier is operated with fixed dc-link current. This can be achieved by independently (independent from the inverter controller) controlling the

50

rectifier as shown in Fig. 2-15. As can be seen, the rectifier controller is independent from the inverter controller. The dc-link reference current is adjusted to keep a constant dc-link current. The output dc-link current is controlled through the inverter using an online PWM modulation scheme with ma control. Since the output inverter is PWM modulated, the system has time responses close to the sampling period. However, the dc-bus losses and switch conduction losses are maximum, since the dc-link current is always equal to its maximum value, regardless of the load speed and torque.
Vg

Ls

~


CSR

Ldc

CSI
C

PM


abc

SHE Modulation

SVM Modulation

vs
dq
vqs

f f

 rec
idc vc
CSR Controller
* idc _ comp

ma

inv

CSI FOC Controller

r
f

vds

Fig. 2-15 Fixed dc-link current with online PWM scheme

B. Variable dc-link current scheme with fixed PWM (SHE modulation) In this scheme, the CSI is operated with a fixed pattern, which is usually optimized in terms of harmonic spectrum and switching frequency such as the SHE modulation scheme. Thus, the load current harmonic distortion (THD) is minimal. However, the dc-link current must be adjusted by sending the required dc-link current reference to the rectifier side controller. Accordingly, the CSR controller will adjust the rectifier firing angle rec to meet
51

the requirements of the load, as shown in Fig. 2-16. Usually, the dc-link inductor is designed to have an acceptable current ripple (less than 15% of the average value). In order to achieve this value and due to the low-order harmonics produced by the rectifier, the size of the dc-link inductor becomes quite bulky. This results in a slow system transient response.

C. Variable dc-link current scheme with online PWM (SVM with ma control) Unlike the fixed dc-link current scheme, this scheme varies the dc-link current, in order to keep the CSI modulation index constant in steady state. In addition, this scheme ensures that the CSI gating pattern is modified on-line (as shown in Fig. 2-17), so as to force the output current to track the reference, thereby resulting in a fast dynamic response, with rise times in the range of the sampling period of the space-vector technique. It should be noted that a high modulation index set point under steady-state condition (ma near 1.0) is desired, in order to minimize the dc-link current and to obtain low harmonic distortion waveforms on the load side. However, a lower modulation index would provide a wider operating range before the CSI modulator goes into saturation (ma>1.0) under transient conditions. When the modulation index reaches its maximum, the slower (no acting) acting index controller will increase the dc-link current to meet the load requirements. The converter then operates similar to the fixed dc-bus current CSI drive. Therefore, a suitable compromise between steady-state and transient state is required. More details and a solution will be provided in Chapter 4.

52

Vg

Ls

~


CSR

Ldc

CSI
C

PM


abc

SHE Modulation

SHE Modulation

vs
dq vqs

f f

 rec
idc vc
CSR Controller
* idc _ comp

inv
CSI FOC Controller

vds



 r

f

Fig. 2-16 Variable dc-link current with fixed PWM scheme

Vg

Ls

~


CSR

Ldc

CSI
C

PM


abc

SHE Modulation

SVM Modulation

vs
dq
vqs

f f

 rec
vc
CSR Controller

idc

ma

inv

CSI FOC Controller
* idc _ comp



 r

vds

f

Fig. 2-17 Variable dc-link current with online PWM scheme

53

2.5 Control Schemes of CSC-fed PMSM Drive
The permanent magnet synchronous motor performance can be controlled by controlling the d-axis stator current component of the motor [58]. For instance, the d-axis stator current of the motor can be set to zero to achieve a linear relationship between the stator current and the motor electromagnetic torque. Alternatively, the d-axis stator current of the motor can be adjusted to produce maximum torque with a minimum stator current. Another approach is to set the d-axis to produce a unity power factor at the machine side. In this section, the above-mentioned three control schemes are presented and analyzed.

2.5.1 Zero d-axis Current (ZDC) Control
The d-axis stator current control can be implemented by setting the d-axis stator current reference to zero. Fig. 2-18 shows the implementation of this control in the FOC scheme of the CSC-fed PM drive system. As can be seen the d-axis current reference is set to zero and therefore, the torque will be developed in the motor by controlling the q-axis current reference generated from the speed controller.
Cartesian to Polar

i 0
* sd

* iwd

r*

+ -

r

Speed controller

Capacitor Compensation
* iwq

* idc

d/dt
+

w
+

f

inv

Fig. 2-18 CSI-FOC control scheme with ZDC control
54

With the d-axis stator current kept at zero, the steady state stator current, torque and stator voltage equations (2-46), (2-47) and (2-48) can be represented by (ignoring the voltage drop across the resistor)
2 2 is  ids  iqs  iqs

(2-46)

Te  1.5P f iqs  1.5P f is

(2-47)

vs  (r Lq I qs )2  (r f )2
1.2 1 0.8

(2-48)

PF

p.u.

0.6 0.4 0.2 0

Vs Pm Is ,Tm

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

 r (p.u.)

0.9

1

Fig. 2-19 Steady-state performance of non-salient PM with ZDC scheme with fan-type load According to (2-47), a linear relationship between Te and is, is achieved as the rotor  f flux in the PM motor is constant. Also, the resultant terminal voltage vs is always increased with the load. With the assumption of keeping the stator current at its maximum value, maximum torque can be achieved with the rated machine stator terminal voltage when this
55

control scheme is applied to the non-salient machine, as shown in Fig. 2-19. The figure shows a steady-state analysis results for a non-salient PM motor with ZDC control as a function of motor speed for a fan type load. As can be seen, the non-salient motor can provide maximum torque at one per unit voltage and current with one per unit speed when the d-axis stator current controlled to zero. However, this might cause over-voltage across the machine terminal as the load and speed increases when it is applied to the salient machine, as shown in Fig. 2-20. As can be seen, as the load and speed increases, the voltage increases until it exceeds the rated voltage at certain speeds. In addition, this control cancels the reluctance torque component when it is applied to the salient motor and therefore, the torque will be less than rated when the stator current is at rated value. Therefore, this control method could be limited for certain operating conditions when it is applied to the salient pole motors.
1.2 1 0.8

PF Is Vs Pm Tm

p.u.

0.6 0.4 0.2 0

0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

 r (p.u.)

0.9

1

Fig. 2-20 Steady-state performance of salient PM with ZDC scheme with fan-type load

56

2.5.2 Maximum Torque per Ampere (MTPA) Control
The maximum torque per ampere control generates a maximum possible torque with a minimum stator current. As shown earlier, for a given rotor flux linkage, the motor torque given in (2-11), is a function of the dq-axis stator currents ids and iqs. This implies that the motor can produce a given torque with different values of ids and iqs, which are the fluxproducing and torque-producing components of the stator current, respectively. Therefore, it is possible to produce a torque with minimum stator current by adjusting the ratio of ids to iqs. For a given stator current is, the magnitude of its d-axis current can be calculated by
2 ids  is2  iqs

(2-49)

Substituting the above equation into (2-11), the motor torque can be expressed as a function of iqs:
3 P  f iqs  ( Ld  Lq ) 2

Te 





2 is2  iqs iqs

 

(2-50)

In the non-salient motor, the d- and q-axis inductances are equal. The above equation can be simplified to (2-47), where only the q-axis current contributes to the torque production. By setting the d-axis current to zero, the motor torque is produced by the minimum stator current ( is  iqs ). Therefore, the ZDC control is essentially the MTPA control for the non-salient motor. For the salient-pole motor, the MTPA scheme can be derived through the following steps. Differentiating (2-50) with respect to iqs, we have

57

dTe 3P  1 2  f   Ld  Lq  ids   Ld  Lq  iqs  2 diqs 2  is2  iqs 

   

(2-51)

To find the maximum torque per ampere, one can set the above derivative to zero:

 f   Ld  Lq  ids   Ld  Lq 

2 iqs

ids

0

(2-52)

Below the base speed, with the assumption of keeping the stator current at its maximum value, the d-axis stator current component in term of the q-axis stator current component can be derived from (2-52)

ids 

f
2( Lq  Ld )



2 f
4( Lq  Ld )
2

2  iqs

(2-53)

Fig. 2-21 shows the implementation of the MTPA control in the FOC control scheme of the CSC fed PM drive system. As can be seen, the d-axis stator current reference can be calculated from the q-axis stator current reference generated from the speed regulator. Fig. 2-22 shows a steady-state performance analysis of salient PM motor with MTPA control as a function of motor speed for the fan-type load. As can be seen, the salient motor can provide maximum torque at one per unit voltage and current with one per unit speed when the MTPA control is used.

58

2  Lq  Ld 

f



4  Lq  Ld 

2 f

2

i

2 qs

* isd

i
Capacitor Compensation

* wd

Cartesian to Polar

* idc
* iwq



* r

+ -

r

Speed controller

* isq

w
+

d/dt

f

+

inv

Fig. 2-21 CSI-FOC control scheme with MTPA control The main feature of the MTPA scheme is that it can produce a desired torque with minimum stator current. This maximizes the utilization of the stator current and minimizes the losses dissipated in the stator winding.
1.2 1 0.8

PF Is Vs Pm Tm

p.u.

0.6 0.4 0.2 0

0

0.1

0.2 0.3

0.4 0.5

0.6 0.7 0.8

 r (p.u.)

0.9

1

Fig. 2-22 Steady-state performance of salient PM with MTPA scheme with fan-type load

59

2.5.3 Unity Power Factor (UPF) Control
This control method provides unity power factor at machine side by controlling the stator current angle to align the stator current with the stator voltage. Neglecting the small voltage drop across the stator resistor, the phase angle of the stator voltage and current can be illustrated by
 v  arctan(vsq / vsd )  arctan(( f   Ld isd ) /( Lqisq ))   i  arctan(isq / isd )

(2-54)

Therefore, unity power factor operation can be realized when the angle  between the stator voltage and current (   v  i ) is zero. Under this condition, the following relationship can be achieved
2 2 Ld isd  f isd  Lqisq 0

(2-55)

From (2-55), the d-axis stator current ids that keeps the stator current within the limit is given by
2 f  2 f  4 Ld Lq isq

isd 

2 Ld

(2-56)

The maximum value of isq and isd that can satisfy the machine side power factor operation is given by

60

f  isq  2 Ld Lq   f  isd  2 L d 

(2-57)

Under this condition and depending on machine parameters, the output torque will be limited. This can cause a limitation in speed in case of a fan-type load as the torque is related to the square of the speed. Fig. 2-23 and Fig. 2-24 show the performance curves for the salient and non-salient motors. For the salient motor, the stator current, stator voltage, motor torque, motor power are all increased nonlinearly with the motor speed, as shown in Fig. 2-24. When the rotor speed increases to a certain speed less than the rated speed, the stator current reaches its rated value. This implies that the motor speed under UPF control will be limited to certain values less than the rated speed depending on the motor parameters. Fig. 2-23 shows the performance curves for the non-salient motor with the UPF control scheme. A similar phenomena can be observed. The non-salient motor reaches its limit specified in (2-57) and therefore, the speed range of the non-salient motor with UPF control may be limited to a certain range depending on motor parameters.

Fig. 2-25 shows the implementation of the UPC control in the FOC control scheme of the CSC-fed PM drive system. As can be seen, the d-axis stator current reference derived in (2-56) can be calculated from the q-axis stator current reference generated from the speed regulator.

61

1.2 1

PF
0.8

p.u.

Is Vs Tm Pm

0.6 0.4 0.2 0

0

0.1 0.2 0.3

0.4 0.5

0.6

0.7

0.8 0.9

 r (p.u.)

1

Fig. 2-23 Steady-state performance of non-salient PM with UPF scheme with fan-type load

1.2 1

PF
0.8

Is Vs Pm Tm

p.u.

0.6 0.4 0.2 0

0

0.1 0.2 0.3 0.4 0.5

0.6 0.7 0.8 0.9

 r (p.u.)

1

Fig. 2-24 Steady-state performance of salient PM with UPF scheme with fan-type load

62

2 f  2 f  4 Ld Lq I qs

* I sd

I
Capacitor Compensation

* wd

Cartesian to Polar

2 Ld
* I sq

* idc
* I wq



* r

+ -

r

Speed controller

w
+ +

d/dt

f

inv

Fig. 2-25 CSI-FOC control scheme with UPF control Table 2-1 provides a summery for the operating range of the permanent magnet synchronous motors using ZDC, MTPA, and UPF schemes. In summary, the ZDC scheme is valid for non-salient synchronous motors, the MTPA scheme can be used for both salient-pole and non-salient motors (the MTPA is equivalent to ZDC for the non-salient motor), and the UPF scheme has limited operating range. The above conclusion is made based on two synchronous motors.

Table 2-1 Compression between ZDC, MTPA, and UPF schemes Motor Control Scheme Non-salient Motor Salient-pole Motor ZDC Full Partial MTPA Full Full UPF Partial Partial

63

2.6 Conclusions
In this chapter, the mathematical steady-state and dynamic equations for a CSC-fed permanent magnet synchronous drive system are derived. A comprehensive analysis has been performed for various configurations and control schemes for CSC and a permanent magnet synchronous motor. The main conclusions of this chapter are as follows:  A 10th order dynamic model for the CSC-fed PM drive system is derived. The equations are established in synchronous reference frame defined on both sides. In the case of the motor side, the equations are synchronized with a rotor angle reference frame, whereas the grid side equations are synchronized with capacitor voltage.  The steady-state equations of the system are obtained to calculate the steady-state values of the system variables.  Three control configurations of the CSC-fed drive system are discussed and compared. Selection variable dc-link control scheme can reduce the loss of the drive system. In addition, choosing a variable dc-link control scheme with an on-line PWM can improve the dynamic. This will be discussed in detail in the following chapters.  Three control schemes for salient and non-salient permanent magnet motors are discussed and analyzed. These control schemes are zero d-axis current (ZDC) control, maximum torque per ampere (MTPA) control, and unity power factor (UPF) control. The performance of these control schemes are analyzed and compared.

64

The outcome of this chapter provides the theoretical and mathematical basis for designing the control schemes in the following chapters.

65

Chapter 3 Input Power Factor Control of PWM CSCFed PM Drive
Input power factor (PF) improvement is one of the main requirements and challenges for the CSC-fed drive system. In the new generation of high power current source drives, pulse-width-modulated high-power current source rectifiers (CSR) are used to replace the thyristor rectifiers in most applications due to the improved line current waveforms, and reduced costs with the elimination of the input transformers. However, the input capacitor tends to cause the line PF to be leading. The main objective of this chapter is to address the input power factor issue in the PWM CSC-fed PM drive system. The major challenges of power factor control are reviewed first. Then, a d-axis stator current control scheme is proposed to achieve unity input power factor over a wide speed range. Detailed implementation and functionality of the proposed control scheme are explained. The performance of the proposed control scheme is verified with analytical and time domain simulation.

66

3.1 Input PF in PWM CSC-Fed Drive System
As mentioned earlier, the input ac capacitors of the drive have values between 0.3-0.6 p.u. This large input ac capacitor can help filter the high frequency harmonics. However, these capacitors generate large leading reactive current in the grid side which tends to cause the leading power factor, especially under light load conditions. Fig. 3-1 shows the vector diagram of the input side converter. As can be seen, the input current Iin leads the input voltage Vc by a large angle because of the uncompensated leading reactive current IQ caused by the capacitor.
q-axis Icg Iin IQ Vc

rec
Iw-q Iw

Fig. 3-1 Vector diagram of the input side converter To control the power factor at the drive's input, a few approaches have been reported. Most require controlling the modulation index and phase angle in the rectifier side for input power factor regulation. These schemes require an online PWM scheme such as a space vector modulation (SVM) scheme for the rectifier and inverter for entire operating range. However, using an online PWM modulation scheme for a high-power CSC-fed drive

67

system, where low switching frequency is necessary, can cause significant low-order harmonics and may excite the LC resonance if not properly mitigated. At high-power levels (1-10MVA), the concern about losses in a drive system limits the switching devices' switching frequency to a few hundred hertz, which leads to another concern about the harmonics, especially the low-order harmonics. Therefore, the selective harmonic elimination (SHE) modulation, which can effectively reduce the low-order harmonics component at both the grid side and motor side, is the most popular PWM method for the high-power CSC-fed drive system. In more detail, the SHE is usually employed for the CSR to eliminate the low order line-side harmonics at the drive input. In the case of the inverter side, a combination of SVM and SHE are used. The SVM is used at low speeds and SHE is usually implemented at high-speeds to generate the best side waveforms. Therefore, with the use of SHE, the option of controlling the modulation index is not valid. Eliminating the harmonics without modulation index control usually takes the priority for high-power CSC-fed drive system. For the above-mentioned reasons, the power factor compensation design for a high-power CSC drive is a challenge, as the compensation scheme should be preferably realized without any modification of the existing PWM scheme.

3.2 Principle of the Proposed PFC
The principle of the proposed input Power Factor Compensation (PFC) is to maintain a large enough rectifier current to compensate for the input reactive current component even with light load conditions. To understand the proposed d-axis stator current adjustment method, the relation between the machine side and line side converters is studied. Fig. 3-2
68

shows the steady-state vector diagram of the whole CSC-fed PMSM drive system before and after the proposed compensation method during light load conditions. As mentioned earlier, in order to eliminate the low-order harmonics (5th and 7th harmonics) in the rectifier side, the SHE modulation scheme with fixed modulation index mrec  I w / I dc is used, where I w is the rectifier current and I dc is the dc-link current. On the machine side, the inverter current I w is proportional to the dc-link current through the inverter modulation index minv  I w / I dc . Assuming constant and equal modulation index in the machine and line side, the inverter and rectifier currents are equal I w  I w . With this assumption, the rectifier q-axis current component Iw-q can be used to compensate for the reactive component of the line current IQ. However, under light load conditions, Iw-q is lower than the capacitor current (Icg) and cannot fully compensate for it (Fig. 3-2(a)). Therefore, to increase the rectifier current, the d-axis stator current component in the FOC scheme is controlled to provide the required dclink current and then the required rectifier current for the unity power factor compensation. As can be seen in Fig.3-2(b), by injecting enough d-axis stator current, the rectifier current
I w is increased. In addition, increasing the d-axis motor stator current causes an increase in

the rectifier switching delay angle

 rec because

of the reduction of the dc-link voltage. The

increase in the rectifier current and delay angle will increase the Iw-q component of the rectifier current which can compensate the reactive line current component IQ (IQ= Iw-q-Icg =0, for unity input power factor).

69

Fig. 3-3 shows the general relationship between the d-axis stator current and the reactive line current for a fan-type load (fan-type load is considered the most common load for high-power drives) as the motor operates from standstill to rated speed. It can be observed that the reactive (capacitive) line current is reduced with the increase of the d-axis stator current component. A summary of the detailed relationship between the d-axis stator current and the line side reactive current component IQ is given by (3-1). This relation is valid for all operating speed ranges.
 IQ  I ds  I dc  rec  I   Q  IQ  I ds  I dc  rec  I   Q  (Capacitive current)  (Inductive current)

 (Capacitive current)  (Inductive current)

(3-1)

3.3 Mathematical Derivation of the Proposed PFC Scheme
In order to properly adjust the d-axis stator current component for power factor compensation, the mathematical relationship between the d-axis stator current component Ids and the drive input reactive current IQ is derived. This can be obtained by examining the drive system variables at a steady-state condition. To keep the currents and voltages of the drive within the operating limits, the proposed d-axis stator current is derived with respect to the q-axis stator current component. Assuming a unity modulation index at the inverter and rectifier (minv=mrec=1 and
* therefore I dc  I w  I w ), the total q-axis component IQ (reactive) of line current can be

calculated by
* IQ  iVC Cg  I dc sin( rec )

(3-2)

70

Machine side

Line side

q-axis Vs

Iw

Is

Icg Iin IQ Vc

d-axis Icm Iw-q

rec
Iw

(a) Without PFC Machine side Line side

q-axis Vs

Icg Is Iw Ids IQ=0 Iin Icm Vc

rec

Iw-q

Iw

(b) With PFC

Fig. 3-2 Vector diagram of the whole CSC-fed PMSM drive system.

71

IQ (p.u.)
1
Capacitive Current

0.5

Ids=0.14 p.u. Ids=0.43 p.u.

0

Ids=0.72 p.u.
-0.5

Ids=1.0 p.u.
Inductive Current

-1 0 0.2 0.4

0.6

0.8

1

r (p.u.)
Fig. 3-3 Relationship between the d-axis stator current and the reactive line current component for fan-type load.

where i is the line-side electrical angular frequency, Cg is the line-side capacitor filter, VC is the peak value of the line-side capacitor voltage and rec is the switching angle (delay angle) of the rectifier. (Note that IQ=0 means unity power factor, IQ >0 means leading power factor, and IQ <0 means lagging power factor.) Neglecting the losses, the average dc-link voltage command can be derived from the machine side variables as

* Vdc 

rTe
* I dc P

(3-3)

72

The average dc-link voltage command can be represented in terms of line-to-line input
*  1.5VLL cos( rec ) . Considering unity voltage and the rectifier phase delay angle by Vdc

power factor condition and using the trigonometric relation cos2  sin 2  1 , the dc-link current command can be derived as
* 2 2 ( I dc )  i2VC2Cg 

r2Te2
2 1.5P 2VLL

(3-4)

The dc-link current command in (3-4) represents the required dc-link current for unity input power factor and can be denoted by I dc _ UPF .

Considering the motor side capacitor current compensation, the synchronous-frame
* * inverter-command currents I dw and I qw , can be calculated as

* 2 2 * *   I dw  r Cm f  r Cm Ld I ds  I ds  * 2 * *   I qw  r Cm Lq I qs  I qs

(3-5)

The stator resistance in high-power motors is normally very low, and therefore it is neglected in (3-5) for simplicity with little errors. Using (3-5), the inverter switching angle

inv and the dc-link current command can be obtained in (3-6) and (3-7), where  f is the
rotor flux reference frame angle, usually measured using a rotor shaft position sensor. In (3-6), and (3-7), it is assumed that both the rectifier and the inverter are controlled with phase angle control and fixed-unity modulation indices mrec  minv  1 .

73

inv  tan 1  

*  I qw   *   f I dw  

(3-6)

* * 2 * 2 I dc  ( I dw )  ( I qw )

(3-7)

Now, from (3-5) and (3-7), the dc-link current command can be expressed in terms of machine parameters and the motor-side capacitor as

* 2 * * 2 * * 2 ( I dc )  (r2Cm f  r2Cm Ld I ds  I ds )  (r2Cm Lq I qs  I qs )

(3-8)

The sign of the first term in (3-8) is adjusted to obtain the minimum possible d-axis stator current, while achieving the unity power factor. By equating, equation (3-4) and (3-8) and after simplification, the d-axis stator current component command is derived as

 Cm f   V C 
2 r 2 2 i C 2 g * I ds 

r2Te2
2 2 LL

1.5P V (r2Cm Ld  1)

* * 2  (r2Cm Lq I qs  I qs )

(3-9)

Based on (3-5) and (3-4), the proposed d-axis stator current component command in (3-9) can be modified to

I 
* ds

* 2 r2Cm f  ( I dc _UPF )2  ( I qw )

(r2Cm Ld  1)

(3-10)

74

3.4 Analysis and Control Scheme of the Proposed PFC
From (3-10), a valid solution for the proposed d-axis stator current control method
* must satisfy the condition I dc _UPF  I qw . In addition, the d-axis stator current command must

be limited to be within the rated current of the
*  I s _ rated ), where I s _ rated is the motor rated current. ( 0  I ds

drive (and hence the motor)

* It can be seen from (3-9) that the proposed d-axis stator current command I ds is related

to a few drive and machine parameters. Among them, the input and output filter capacitors are of special interest as they are parts of the drive circuit. Based on the switching frequency and the input and output inductances, the filter capacitors might have different values. In general, the design of the capacitors are based on the Nyquest sampling theorem where the resonance frequency of the LC filter must be less than half the switching frequency to ensure system stability. To show the effect of the filter capacitors on the proposed method, a small input and output capacitors of Cg=0.4 p.u. and Cm=0.3 p.u. are selected for the large drive presented in Table 3-1 (in the simulation, the input capacitor is selected Cg=0.5 p.u. to show the effectiveness of the proposed method even with a large input capacitor). With this selection, the input and output resonance frequencies are 203.2 Hz and 116.5 Hz, respectively, which ensures system stability with a switching frequency of 540 Hz.
* * Fig. 3-4(a) illustrates the relationship between I ds , I dc _ UPF , and I qw as a function of

motor speed for fan-type load for the small filter capacitors. As illustrated in Fig. 3-4(a), the d-axis stator current command can provide the required dc-link current that ensures unity
75

power factor operation for wide speed ranges. It is obvious that the injected d-axis current can cause additional loss in the motor and the drive. However, the increase in the loss (motor loss, dc-link loss and the switching device conduction loss) is a common for all unity power factor compensation methods, as the rectifier current has to be increased to compensate for the large capacitive current, especially at light load conditions. As the load increases with the motor speed, the d-axis stator current command will be reduced until it hits the zero limit of the controller, as shown in Fig. 3-4(a). In this case the proposed method becomes ineffective and cannot fully compensate the power factor. However, in this situation the input power factor is close to unity and does not require any
* compensation as shown in Fig. 3-4(a). Fig. 3-4(b) shows the relationship between I ds ,

* as a function of motor speed for the fan-type load when large filter I dc _ UPF , and I qw

capacitors of Cg=0.5 p.u. and Cm=0.4 p.u. are used. As can be seen, the effective range of the proposed method can be extended to cover all speed ranges with the large filter capacitors. In accordance with the d-axis stator current method in (3-9), the block diagram of the FOC scheme with the proposed control method is shown in Fig. 3-5. The developed torque is estimated from (2-37) by measuring the d-q axes stator currents to improve the dynamic performance. In addition the input capacitor voltage is measured (instead of using fixed value) for more accurate results. It is worth mentioning that the proposed method can be applied to both salient (IPM) and non-salient (SPM) permanent magnet synchronous motors. Furthermore, the proposed scheme can make use of the existing speed PI regulator parameter and does not require an additional PI regulator.

76

(p.u.)
1

Input PF
0.8 0.6

Idc_UPF
0.4 0.2 0

* Iqw
0 0.2 0.4 (a) 0.6

* Ids 0.8

r (p.u.)

1

(p.u.)
1 0.8 0.6 0.4 0.2 0 0 0.2

Input PF

Idc_UPF
* Ids

* Iqw
0.4 (b) 0.6

0.8

r (p.u.)

1

* * Fig. 3-4 Relationship between, I ds , I dc _ UPF , and I qw as a function of motor speed for fantype load. (a) Cm =0.3 p.u. and Cg =0.4 p.u. (b) Cm =0.4 p.u. and Cg =0.5 p.u.

77

Input power factor controller

iqs

ids

Te  1.5P iqs f   Lq  Ld  iqs ids
Te





r
Vc
* iqs
* I ds 

2 r2Cm f  i2VC2C g 

* * 2  (r2Cm Lq I qs  I qs ) 2 1.5 P 2VLL (r2Cm Ld  1)

r2Te2

* ids

r*

+ -

r

Speed controller

i

* qs

* idw

Capacitor Compensation
* iqw

* idc

d/dt

+

w inv

f

+

Fig. 3-5 Block diagram of the FOC scheme with the proposed PFC control method.

3.5 Simulation Results
Analytical and time domain simulation results obtained using Matlab are provided in this section to demonstrate the performance and effectiveness of the proposed compensation method. Table 3-1 shows the system parameters of the medium-voltage highpower 2.44 MW drive system used in the analytical simulation. Table 3-2 shows the system parameters of the low-voltage low-power 6.5 kW drive system used in the time domain simulation.

78

A. Analytical Simulation Results Figs. 3-6 and 3-7 show the results for the simulation curves of the drive input power factors, machine stator voltage Vs and current Is, developed torque Te, input reactive current IQ, and the d-axis stator current component with and without the proposed compensation method. Note that the conventional ZDC control method with no input power factor compensation is compared with the proposed control method. As can be seen in Fig.3-6, for speeds above 80% of the rated value, there is no need for compensation, as the input power factor can be maintained close to unity by properly designing the input and output capacitor filters compensation. However, for speeds below 80%, the input reactive current is not zero, as the power factor becomes leading. When the proposed method is enabled (Fig. 3-7), the drive input reactive current component IQ can be regulated to zero, and unity input power factor is achieved. It is very clear from Fig. 3-7 that the proposed method maintains the stator voltage and current within the drive and motor capacity.

B. Time Domain Simulation Results Figs. 3-8 and 3-9 illustrate the steady-state performance of the drive without and with power factor compensation at light load conditions. In Fig. 3-8, the motor is controlled using conventional ZDC without the power factor compensation. In this case, the motor is operated at 0.262 p.u. speed and torque of 0.217 p.u. to emulate the light load condition. As can be seen, there is a large phase angle between the input current and the input phase voltage because of the large line capacitor 0.57 p.u. of the drive. This line capacitor draws
79

significant leading reactive current (especially at light load and low speed) and results in a power factor of 0.248 (leading).

(p.u.)
1.2 1 0.8 0.6 0.4 0.2 0 0 0.2 0.4 0.6

Vs I s , Te Ids
0.8 1

1 0.8 0.6 0.4 0.2 0 0 0.2 0.4 0.6

Input PF

IQ
0.8 1

r (p.u.)

Fig. 3-6 Steady-state performance of the drive without PFC method with fan-type load. Figs. 3-10 and 3-11 illustrate the performance of the drive at a heavy load condition (0.7 p.u. torque at 0.88 p.u. speed) with and without the proposed compensation method. Without power factor compensation (using ZDC method), the power factor is slightly

80

leading 0.98 due to the large line capacitor used (see Table 3-2). When the d-axis stator current method is enabled, enough d-axis stator current of 0.217 p.u. is injected to the machine for power factor compensation. As a result, the power factor changes from 0.98 (leading) to unity as shown in Fig. 3-11.
(p.u.)
1.2 1 0.8 0.6 0.4 0.2 0 0 0.2 0.4 0.6 0.8

Is Vs Te Ids
1

1 0.8 0.6 0.4 0.2 0 0 0.2 0.4

Input PF

IQ
0.6 0.8

r (p.u.)

1

Fig. 3-7 Steady-state performance of the drive with PFC method with fan-type load. Fig. 3-9 illustrates the performance of the drive at light load condition with the proposed line power factor compensation. A large d-axis stator current 0.465 p.u. is injected into the machine by the proposed method for the input power factor compensation,
81

as shown in Fig. 3-9(b). This d-axis stator current boosts the dc-link current from 0.234 p.u. to 0.513 p.u., and thus provides enough rectifier current I w to compensate the reactive capacitor current. As can be seen from Fig.3-9(b), the line current is in-phase with the phase voltage and a unity power factor is achieved.

Iin

Vg

Iw

0.015 i (A) 8 6 4 2 0 -2 0 0.1

0.02 0.025 (a)

0.03

0.035 t (sec)

Iqs

Ids

0.2 (b)

0.3

0.4 0.5 t (sec)

Fig. 3-8 Drive waveforms without the proposed input power factor compensation at light load condition. (Vg 100V/Div, Iin 5A/Div, I w 10A/Div)

82

Table 3-1 MV CSC-fed Non-Salient PM drive System Parameters Parameters System Ratings Power Voltage Current Grid/Motor Freq. Motor Parameters d-axis synch. ind. q-axis synch. ind. Stator Resistance Number of Poles Rotor Magnet Flux Converter Parameters Grid-side Cap. Motor-side Cap. Grid-side Line Ind. DC Link Ind. Switching Freq. Data 2.44 MW 4000 V 490 A 60/53.3 Hz 9.8mH (0.697pu) 9.8mH (0.6976pu) 0.024 (0.03pu) 8 9.75web (0.72pu) 281µf (0.5pu) 190µf (0.3pu) 2.72mH (0.218pu) 16.25mH (1.3pu) 540 Hz

Table 3-2 LV System Parameters Parameters Data System Ratings Power 6.5 kW Voltage 230 V Current 16.3 A Grid/Motor Freq. 60/77.5 Hz Motor Parameters d-axis synch. ind. 3.3mH (0.197pu) q-axis synch. ind. 7.3mH (0.436pu) Stator Resistance 0.25 (0.03pu) Number of Poles 6 Rotor Magnet Flux 0.38web (0.97pu) Converter Parameters Grid-side Cap. 185µf (0.57pu) Motor-side Cap. 120µf (0.4pu) Grid-side Line Ind. 4.71mH (0.218pu) DC Link Ind. 28.1mH (1.3pu) Switching Freq. 600 Hz

83

Vg Iin

Iw
-10 0.015 10 i (A) 5 0 -5 0.02 0.025 (a) 0.03 0.035 t (sec)

Iqs

Ids
0 0.1 0.2 0.3 (b) 0.4 0.5 t (sec)

Fig. 3-9 Drive waveforms with the proposed input power factor compensation at light load condition. (Vg 100V/Div, Iin 5A/Div, I w 10A/Div)

It should be noted that the q-axis stator current component has been reduced while the d-axis stator current component has increased due to the proposed method, as shown in Figs. 3-10 and 3-11. This can be explained as follows: since the IPM machine type is used in the test, the increase in d-axis stator current produces the reluctance torque component of the machine torque, which causes a reduction in the required q-axis stator current that participates in the magnet torque component.
84

Vg Iin

0.03 20

0.035 0.04 (a)

0.045 0.05 t (sec)

i (A)

Iqs
15 10 5 0 -5 0 0.1 0.2 (b) 0.3

Ids
0.4 0.5 t (sec)

Fig. 3-10 Drive waveforms without the proposed input power factor compensation at heavy load conditions. (Vg 100V/Div, Iin 10A/Div, I w 10A/Div)

85

Vg Iin Iw

0.03

0.035

0.04 0.045 (a)

0.05 t (sec)

i (A)

20

Iqs
15 10 5 0 -5 -10

Ids
0 0.1 0.2 (b) 0.3 0.4 0.5 t (sec)

Fig. 3-11 Drive waveforms with the proposed input power factor compensation at heavy load conditions. (Vg 100V/Div, Iin 10A/Div, I w 10A/Div)

3.6 Conclusions
A control scheme for the PWM CSC-fed PMSM drive system with input power factor compensation has been proposed. Unlike previous power factor compensation schemes, the proposed approach is based on the motor d-axis stator current control in the field oriented

86

control of the drive system and does not require an online modulation scheme for the rectifier and/or the inverter. As a result, Selective Harmonic Elimination (SHE) modulation patterns can be implemented on both the rectifier and inverter to minimize drive switching losses. The effectiveness of the proposed method is verified by theoretical analysis and time domain simulation results. Results have shown that with properly designed filter capacitors, the proposed d-axis stator current can effectively regulate the input power factor to be unity in the entire speed ranges. The main feature of proposed method is that it does not require modulation index control within the PWM modulation scheme, and therefore the SHE modulation scheme can be used with only a delay angle control. This can give the proposed scheme additional advantages over the other methods, including: 1. Suppression of the LC resonances due to the elimination of low-order harmonics such as the 5th and 7th harmonics, that may excite the LC resonances; 2. Reduced switching and harmonic losses due to the elimination of dc current bypass operation and reduced switching frequencies; 3. Minimal harmonic distortion as the SHE scheme eliminates the low-order harmonics; and 4. A simplified control scheme that does not require an additional PI controller. The effectiveness of the proposed control method is evaluated by analytical and time domain simulation results.

87

Chapter 4 Sensorless Zero/low Speed Control Using Pulsating High Frequency Injection Method
In many PM drive applications, field-oriented control (FOC), or vector control is employed. Therefore, information regarding the rotor flux position and rotor speed are required. In general, these feedback signals come from feedback devices mechanically coupled to the rotor such as an encoder and resolver. However, in most applications, the presence of these devices presents several disadvantages, such as reduction of reliability, additional cost and sensitivity to noise and vibration. Consequently, with all the above mentioned sensor limitations, the PM drive might be restricted from many applications. Different sensorless methods have been developed in order to remove the sensor from the drive. However, the operation with sensorless at zero and low speed is still a challenge in most industrial applications. The main objective of this chapter is to propose a sensorless control method for low and zero speed operation for the high-power medium voltage pulse-width-modulated current-source-converter fed PM motor. The proposed method is based on the HF injection approach. The general injection approach and different injection methods are first reviewed. A pulsating injection control scheme is then proposed for the current source converter-fed interior permanent magnet motor. The challenges of a conventional FOC

88

control scheme, low switching frequency, dc-link inductor and filter capacitor of the CSCfed IPM drive are addressed. Then a modified FOC scheme with multisampling SVM modulation is introduced to overcome the above-mentioned challenges. The detailed study led to propose a general guide for the HF signal design for the CSC-fed PM machine. A time domain simulation for a high-power medium voltage drive is carried on to verify the proposed low/zero speed sensorless method.

4.1 Introduction to Sensorless Signal Injection Method
As mentioned before, several algorithms have been suggested in recent literature to achieve sensorless operation. Back-electromagnetic-force (EMF) or the machine modelbased rotor angle estimator method, is considered one of the sensorless approaches. This approach can provide dynamic performance similar to the actual sensor. These methods work reasonably well at medium and high speeds (above 3% of nominal speed motor operation), but as the speed decreases, their performance deteriorates. The uncompensated inverter nonlinearity and stator resistance variations lead to unsatisfactory operation or even instability at low speed. Furthermore, at zero speed operation, the terminal stator voltage is zero. Therefore, the sensorless algorithm, based on the machine model, fails regardless of the algorithm's superiority. Since the design of model-based sensorless methods depends on the machine parameters of the machine, these methods are parameter sensitive. Therefore, the main limitations of the model-based sensorless control methods can be listed as   Zero and low speed operation is not possible; Speed and position estimation is parameter sensitive.
89

In order to overcome the limitations of the machine model-based sensorless methods at zero and low speed operation, another approach based on anisotropic property (such as the machine rotor saliency) of the machine can be used [38, 59-63]. This approach requires the following   Trackable magnetic anisotropy (unsymmetrical machine property) Applicable signal injection present throughout the operating range In this approach, a persistent signal is injected into the machine along with the fundamental excitation in order to use the anisotropic property that contains information about the rotor position, which enables the sensorless control of the machine at zero and low speed operation. Usually, the much higher frequency and low amplitude injected signal results in the fundamental behavior of the machine being little changed. The anisotropy of the machine can be caused either by saliency of an interior magnet rotor such as the IPM motor saliency, and/or by the saturation of the stator iron [62, 64-66]. The latter is dominant in surface mount magnet machines. In general, the IPM machine has superior performance with the application of sensorless high-frequency injection methods as it has a high inductance saliency ratio. Numerous high-frequency injection techniques for vector controlled voltage-source-fed IPM motor drives have been reported in recent literature. However, similar approaches for high-power medium-voltage Current Source drives have never been explored [67].

90

4.2 Technical Challenges of HFI Method with CSC-fed Drive System
Almost all existing HF injection-based sensorless control schemes have been applied to the VSC-fed drive system with low and medium power applications. In most of the literature surveyed [68-71], the frequency of the injection sinusoidal signal is 500 Hz and higher. The high switching frequency of the VSC-fed drive system (at low and medium power application) ensures proper discretization of the above-mentioned range of HF injected signal. In addition, in the VSC-fed drive; the inverter is connected to a fixed dclink voltage provided by an independent voltage-source rectifier. In this case, the injected HF signal will be directly controlled through the inverter. For the reasons outlined above, the sensorless HFI method ensures good performance with the VSC-fed drive system. However, in the CSC-fed drive which has a different topology (output capacitors at the output of the inverter and large dc inductance in the dc-link), and operates at low switching frequency, the injection method could be a challenge. The large filter capacitor and the low switching frequency might complicate the design and generation of the injection highfrequency signal. In addition, in a conventional current-source-converter fed drive system, the output current of the inverter is controlled through the rectifier with a variable dc-link current. Therefore, the low dynamic response of dc-link current through the dc-link inductor may be another challenge. Fig. 4-1 shows two possible methods for injecting the high-frequency into the CSC-fed drive system. The first possible solution is to use an external injection circuit at the output terminals of the inverter to make sure there is a proper injection signal at the machine [62,72] as shown in Fig. 4-1. However, this can increase the size and the cost of the
91

converter. Therefore, developing an injection control scheme of high-frequency signal through the current-source-inverter (as shown in Fig. 4-1) can offer significant benefit in the high-power medium-voltage drive system.
Ldc

idc
HF Injection Circuit HF Injection Through Inverter

Vg

Ls

iin V iw c
vdc
icg

~
Cg

IPM

PWM Rectifier

PWM Inverter

Fig.4-1 Current Source drive with two injection option, through external circuit and through the inverter

4.3 Saliency and Saturation in PMSM Machine
The permanent magnet machine can be designed to be either salient or non-salient. Imbedding the magnets into the rotor of interior PM machine provides a more mechanically robust rotor compared to a rotor with magnets mounted on the surface. A rotor constructed in this way also results in a rotor q-axis inductance that is larger than the d-axis inductance. The flux in the d-axis of the motor must cross the magnet air-gap as well as the physical air-gap, whereas the q-axis flux can take a path through the pole face of the motor, requiring the flux to only cross the physical air-gap. This results in a rotor q-axis inductance that is greater than the d-axis inductance [56,73]. The large ratio between q-axis and d-axis inductance (saliency ratio) of the IPM machine makes the IPM machine a natural candidate
92

for the high-frequency-based sensorless control methods. On the other hand, surface mount PMSM are not deliberately designed to be salient, which means high-frequency-based sensorless control can be much more complicated in terms of detecting some saliency in this machine. The salient nature of the IPM machine and consequently their suitability for sensorless control can be strongly affected by the operating conditions. Fig. 4-2 shows the q-axis and d-axis inductance of the IPM motor with the change of the stator current. As shown, the change in the d-axis inductance can be neglected. This can be explained because the saturation in the d-axis normally occurs due to the magnet and does not significantly change when the fundamental current changes. However, the q-axis inductance can vary across a wide range as the operating conditions change, as shown in Fig. 4-2. The end result is that the salient behavior of the machine seen by the high-frequency signals can dramatically change with the operating point. Two effects can be distinguished: a reduction of the saliency ratio, and the movement of the minimum reluctance axis away from the magnetic d-axis because of cross saturation. Both effects will result in deterioration of sensorless control and often instability unless compensating strategies are adopted. Therefore, a test for magnetic saliency for the machine is considered mandatory for the high-frequency injection method to ensure enough range in the operating conditions in the d-q axis so that the machine remains salient.

93

0.01 0.009 0.008

Lq

Ld , Lq ( H )

0.007 0.006 0.005 0.004 0.003 0.002 0.001 0 0 5 10 15 20

Ld

i ( A)

25

Fig.4-2 q-axis and d-axis inductance of the IPM motor with the change of the stator current

4.4 Types of High-Frequency (HF) Injection Signals
4.4.1 PWM Excitation
The estimation of the rotor position at low and zero speed requires a persistent excitation in the machine. Instead of injecting a special test signal, the high-frequency content of the switching waveform in a pulse-width-modulation controlled drive system can be used for the same purpose [62]. This injection signals do satisfy the persistent excitation requirement. However, this approach may not be visible for the CSC-fed IPM drive system. The main limitation of using this type of HF signal with the CSC-fed IPM drive system is that the output capacitor filter can damp the switching frequency harmonic (between 540 to 600 Hz) level dramatically and therefore make it hard to reach the motor and then detect its response.

94

4.4.2 Rotating Vector Excitation
Fig. 4-3 shows the vector diagram representation of the rotating vector excitation method. As shown in the vector diagram, a high frequency rotating vector (voltage or current) injected into the fundamental component (voltage or current) of the machine. The injection of this high frequency signal generates two rotating components at the machine terminal. One component rotates at the negative sequence and the other rotates at the positive sequence. In the estimating process, the negative sequence is extracted because it contains the rotor position information, while the positive sequence component does not contain the position information and therefore is eliminated from the process by using certain filters.
  axis
h
Nagative sequence Component

h

h

e

Fundamental Component

Positive sequence Component

  axis

Fig. 4-3 Vector diagram representing the rotating vector excitation method Fig. 4-4 shows the implementation of the rotating vector excitation method in the FOC control scheme of the CSC-fed PM drive system. As can be seen, the conventional FOC control scheme is modified to inject the rotating three-phase balanced HF sinusoidal signal.
95

The investigation of this method with the CSC-fed drive system shows that this method requires more filters for detecting the HF response. Moreover, the nature of injecting the rotating signal with the latency of the filters can reduce the dynamic performance of this injection method. This may cause unstable operation, especially at sudden full load changes. In addition, injecting a rotating signal can excite both the d-axis and q-axis fundamental current components. This can affect the fundamental torque and cause more torque ripples.

3 phase HF signal

^f
d-axis current Calculation
+ +

3

2
* I ds * I dw

Cartesian to Polar
* I dc

+

+

I

* qs

Capacitor Compensation
* I qw

r*

+ -

Speed controller

To rectifier Controller

w
^r 

^f

+ +

inv

To inverter PWM

Fig. 4-4 Conventional FOC control scheme of CSC-fed PM drive system with three phase HF rotating signal Injection

4.4.3 Pulsating Vector Excitation
This algorithm is based on pulsating vector excitation. This algorithm excites the motor by injecting a pulsating sinusoidal high frequency signal into the estimated rotating reference frame of the fundamental component of the motor. The purpose of injecting this
96

high frequency signal is to excite the high frequency impedance of the motor, which contains position information. This impedance can thereafter be measured and processed for extracting the estimated rotor position. Fig. 4-5 shows the vector diagram of the pulsating method principle. As can be seen, a high frequency pulsating signal is injected in the estimated rotor reference frame. Then, the error err between the actual and the estimated rotor position will be estimated and controlled to zero to achieve the actual rotor position. More details will be provided in the following sections.

axis
Es tim a fra ted m ro e to Pu in lsa je tin ct g io n A ct u fra al r m oto e r r

e

rr

f
PM or rot

^  f

axis

Fig. 4-5 Vector diagram representing the pulsating vector excitation method Fig. 4-6 and Fig. 4-7 show the two possible proposed pulsating signals for the CSC-fed PM drive system. As can be seen from the figures, the pulsating high frequency sinusoidal signal can be injected into the d-axis or q-axis estimated stator rotating reference frame of the machine in the FOC control scheme. However, it is found that the injection into the qaxis component can impact the fundamental torque component and produce more pulsating torque and noise. Therefore, the injection on the d-axis seems more visible compared to other injection schemes. More details about this method will follow in the next sections.
97

HF  I h cos h t

Cartesian to Polar
* I dw * I dc

d-axis current Calculation
+ +

* I ds
* I qs

Capacitor Compensation
* I qw

r*

+ -

Speed controller

To rectifier Controller

w
^r 

^  f

+

+

inv

To inverter PWM

Fig.4-6 Conventional FOC control scheme of CSC-fed PM drive system with q-axis HF pulsating signal

HF  I h cos h t

Cartesian to Polar
* I dw * I dc

d-axis current Calculation

+

+

* I ds
* I qs

Capacitor Compensation
* I qw

r*

+ -

Speed controller

To rectifier Controller

w
^r 

^  f

+ +

inv

To inverter PWM

Fig. 4-7 Conventional FOC control scheme of CSC-fed PM drive system with d-axis HF pulsating signal

4.5 High Frequency Model of CSC-fed PM Drive
The simplified CSC-fed IPM drive can be modeled by an ideal DC current source (which simplifies the PWM rectifier model), a current source inverter, three-phase AC capacitors, and an IPM motor. The magnetic saturation and cross-coupling saturation effect

98

of the IPM motor are ignored. Also, the stator resistance and inductances are assumed constant. With these assumptions, the voltage equations of the IPM motor and the output AC filter capacitors on the actual rotor reference frame are depicted as follows

r r vds   Rs  Lrd p r Lrq  ids   0     r   r r  r  v  L R  L p i       qs r d s q qs       r f 

(4-1)

v r   0 p  ds  r  v   qs    r

r  1/ C r r  vds

 r  0  vqs    0

r 0  icd   r  1/ C r   icq  

(4-2)

where Rs is the armature winding resistance, Lrd and Lrq are the d-axis and q-axis inductances,
r r and vqs are the d-axis and q-axis stator voltages,  f is the flux of the permanent magnet, vds

r r and iqs are ids

the d-axis and q-axis stator currents, p is the differential operator, C is the

r r output AC capacitor of the drive, icd and icq are the d-axis and q-axis capacitor currents, and

r is the electrical angular velocity of the rotor.

Considering only a sinusoidal high-frequency component of frequency h is injected into the drive, the speed r related component of (4-1) and (4-2) can be neglected if the frequency of the injected component h is sufficiently higher than the speed frequency r as only the time derivative terms are proportional to the high-frequency component. Based on this assumption, the high-frequency components of the voltage equations of (4-1) and (4-2) in the actual rotor position can be expressed as (4-3) and (4-4).

99

r r r vdsh   Rsh  idsh   Lrdh p 0   r    r  r r 0 Rsh  Lqh p   vqsh      iqsh  

(4-3)

r r v r  1/ Ch 0  icdh  p  dsh   r  r r  1/ Ch   vqsh    0 icqh  

(4-4)

The high-frequency components of voltages, currents and parameters in (4-3) and (4-4) are depicted with a subscript h . The steady state representation of equations (4-3) and (4-4), using the injection high-frequency current signal of frequency h can be illustrated as (4-5) and (4-6).
r r vdsh   Rsh  jh Lrdh  r  0 vqsh      r  idsh    r r  Rsh  jh Lrqh   iqsh  

0

(4-5)

r r r vdsh  1/ jhCh   icdh 0  r    r  r 0 1/ jhCh vqsh    icqh    

(4-6)

From the equations above, one can construct the simplified high-frequency equivalent circuit diagram of the CSC-fed IPM drive in the actual rotor reference frame, as shown in Fig. 4-8. As can be seen from the circuit, the d-axis and q-axis circuits are decoupled in the actual rotor position. Therefore, the high-frequency mathematical representation of the simplified CSC-fed IPM drive can be represented as
r r vdsh   Z dh   r   vqsh     0  r  0  idwh r  r  Z qh   iqwh  

(4-7)

r r where idwh and iqwh are the high-frequency components of the inverter currents and,

100

r Rsh  jh Lrdh Z  r r r 1  jh Rsh Ch  h 2 LrdhCh r dh

Z 
r qh

r Rsh  jh Lrqh r r r 1  jh Rsh Ch  h 2 LrqhCh

.

In HF pulsating sensorless operation, because the actual rotor position is unknown, the estimated rotor reference frame is used instead of the actual rotor reference frame. Therefore, the voltage equation in (4-7) should be derived based on the estimated rotor reference frame. This can be achieved by transforming the voltage equation in (4-7) to the estimated rotor reference frame as

^ ^ r r r vdsh   Z dh idwh  0  1  T (  ) T (  )  r^   err err  r ^  r     vqsh    0 Z qh   iqwh   ^ r  Z diff sin 2 err  idwh   Z avg  Z diff cos 2 err   r^   Z avg  Z diff cos 2 err     Z diff sin 2 err iqwh  

(4-8)

where

err

^ ; T ( )   cos err   f  f err   sin  err 

r r r r Z qh  Z dh Z qh  Z dh sin err  ; Z avg  ; Z diff  cos err  2 2 

Equation (4-8) represents the simplified high-frequency mathematical model of the CSC-fed IPM drive system in the estimated rotor reference frame. The voltages and
^. currents in the estimated rotor reference frame are depicted with a superscript r
f

and ^ are
f

the actual and estimated rotor flux angles. As can be seen, the components of the matrix impedance are related to the rotor position error err . In addition, different from the

101

impedance matrix of the actual rotor position in (4-7), the matrix impedance in the estimated rotor position has coupling components between the q- and d-axes. These can be zero when the rotor position error becomes zero. In this case, the estimated angle is equal to the actual rotor position. It will be shown later that the actual rotor position can be estimated by controlling the rotor position error of the high-frequency coupling impedance component to zero.

HF Pulsating Injection d-axis + +
vdsh

idwh

idsh idc
1 jh Ch

Rsh
jh Ldh

Current Source Inverter q-axis

iqwh iqc vqsh

iqsh

Rsh
jh Lqh

1 jh Ch

Fig. 4-8 Simplified HF equivalent circuit diagram of the CSC-fed IPM drive in the actual rotor reference frame.

102

Vg

Ls

~


CSR

Ldc

CSI
C

IPM


abc
^ r vds

SHE Modulation

 rec
vc
CSR Controller

idc

SHE & SVM Modulation inv ma CSI FOC Controller

r

dq
^ r vqs

^  f

* idc _ comp

HF signal
f

^r 

^ 

Speed and rotor Angle Estimator

 err

Signal processing

Fig. 4-9 Block diagram of the proposed CSC-fed IPM drive system.

4.6 Proposed HF Sensorless Scheme for the CSC-fed IPM drive
4.6.1 Injection Scheme
Apart from the injection control scheme (represented by the dotted block and injected high-frequency (HF) signal), Fig. 4-9 illustrates the block diagram of the typical CSC-fed IPM drive system and its FOC control scheme. The drive system consists of a PWM CSR and a PWM CSI. In the control scheme, selected harmonic elimination (SHE) modulation is used in the grid side. In case of the inverter control, SHE is also employed at medium and high speed. However, a conventional space vector modulation (SVM) with fixed-unity modulation index ( ma  1 ) and controlled phase angle is usually employed at low speed operation [74].

103

HF  I h cos h t

^ r icd

Cartesian to Polar
^ * r idw * idc

I _ comp
* idc _ comp

d-axis current Calculation

+

+

^* r ids
^* r iqs

+ +

+

+ +

+

^ * r iqw

r*

+ -

Speed controller

To CSR Controller

^ r icq

w
idc

x
inv

1
Limit

ma
To CSI PWM

/

^r 

^  f

+

+

0

Fig. 4-10 Proposed FOC controllers of the CSC-fed IPM drive. Fig. 4-10 shows the details of the proposed FOC controller. The output of the speed controller is the estimated q-axis stator current reference which directly controls the magnet torque component of the machine. The estimated d-axis reference is calculated from the estimated q-axis current for maximum torque per unit ampere (MTPA). After the motor^ r ^ r side capacitor current compensation, using icd and icq calculated currents, the reference

inverter currents in the estimated synchronous d-q frame are obtained, which then generate
* the desired dc-link current idc _ comp , and the inverter switching angle  w which is oriented to

* the estimated rotor flux angle ^f . The two signals idc _ comp and  w represent the output signals

* of the inverter FOC control. By controlling idc _ comp and  w , the magnitude and frequency of

the output current are regulated respectively. It should be noted here that in the
* *  idc conventional FOC control scheme idc _ comp and there is no ma control.

In order to extract the rotor position information from the coupling impedance in (4-8) for low and zero speed operations, a high-frequency sinusoidal signal is required to be injected into the machine. In general, the high-frequency signal can be generated via either
104

dedicated circuitry or the same inverter that produces the fundamental component. The inverter is the preferred generator, based upon cost and reliability. This means that only changing the software can generate the high-frequency current signal, and there is no need to change the hardware configuration. In the VSC-fed drive, sinusoidal high-frequency voltage or current can be injected into the estimated rotating reference frames in the control scheme for the HFI sensorless method. However, in CSC-fed drive, the typical FOC control scheme, shown in Fig. 4-10, is different from the VSC control scheme where stator voltage reference does not exist in the CSC FOC control scheme. Therefore, only high-frequency sinusoidal current signal injection is permitted for the typical CSC-fed IPM drive system. As can be seen in Fig. 4-10, the proposed high-frequency injection method is based on injecting a pulsating sinusoidal high-frequency current signal on the fundamental estimated d-axis stator current component in the FOC control scheme. More details about the highfrequency signal design will be provided in next section.
* In the rectifier control side, the dc-link current command idc _ comp at the output of the

inverter FOC control scheme is normally used as a reference for the rectifier dc-link current feedback controller. This controller consists of PI-controllers and filters for removing switching harmonics. The output of the PI-controller is the average dc-link voltage reference, which subsequently generates the switching delay angle  rec for the rectifier. It should be noted here that the amplitude of fundamental output current and the highfrequency injected sinusoidal current signal will be controlled through the dc-link current controller. However, due to rectifier control loop filtering and the phase delay caused by the large dc-link inductor, the injected high-frequency current signal can not be adequately

105

controlled. This results in system instability because of the large error in the rotor angle estimation. To overcome the above-mentioned problem, modulation index ma control in the inverter FOC control scheme is proposed for low and zero speed operation, as shown in Fig. 4-10. This can improve the dynamic performance of the injected signal by controlling
* it through the inverter. As can be seen, by dividing the dc-link current command idc by the

actual current idc , the ma can be calculated and controlled. Ideally, the modulation index should be equal to one, as the dc-link command is equal to the actual dc-link current (
* ma  idc / idc  1 ).

However, due to phase delay in the filtering process in the rectifier control

loop and the large dc-link inductor, part of the high-frequency signal will appear in the modulation index signal. Since the maximum limit of the modulation index signal is equal to one ( ma _ max  1 ), the modulation signal will be clamped. This causes a large error in the estimated rotor angle and causes system instability. To solve this problem, dc-link current compensation I _ comp , shown in Fig. 4-10, is introduced to avoid the saturation of the modulation signal by
* making the actual dc-link current larger than the generated dc-link command idc and,

therefore, the modulation index signal is always less than one. It should be noted that the value of the compensated dc-link current signal could be in the range between zero and the peak of the HF-injected signal. This can be decided depending on the amount of HF signal's delay through the rectifier control loop and the dc-link inductor. In this thesis, the compensation dc-link current signal is designed to be 60 % of the HF peak signal to ensure proper and stable operation.
106

4.6.2 Rotor Angle Estimation Using HFI
As mentioned earlier, to extract the position information from the cross-coupling impedance in (4-8), only current signal injection is possible in the CSC-fed IPM drive system. Based on this restriction, information about the measured voltage has to be processed for rotor position estimation. Fortunately, stator voltage sensors in the CSC-drive system are part of the system. Additional filters for PWM harmonics of voltage signals are not required because the CSC filter capacitors eliminate these harmonics. Therefore, this section considers a method based on processing the voltage response information of a highfrequency current injection signal for rotor position estimation. In more detail, to obtain voltage and current relationship through the cross-coupling high-frequency impedance in the CSC-fed IPM drive, a high-frequency pulsating current signal is injected in the d-axis estimated reference frame as in (4-9) and a measured highfrequency q-axis voltage component is processed for the rotor position estimation.

^ r ids   I h cos ht   r^     0   iqs   

(4-9)

It should be noted that in the CSC FOC control scheme, the fundamental d- and q-axis steady state components of the capacitor current are usually compensated to achieve accurate control. The steady state compensated capacitor currents can be calculated at the estimated reference frame, using (4-2), as follows

107

^ ^ r r r  icd  r vqs C  r^ ^ r r  icq  r vds C

(4-10)

Therefore, the stator currents command components are different from the inverter current command components as shown in Fig. 4-10. However, at low speed operation, the d-axis capacitor compensation current signals are very small and can be neglected. Therefore, the d-axis and q-axis components of the stator currents and the inverter currents can be
^* ^ * r r ^* ^ * r r  iqw approximated to be equal ( ids and iqs ) at low speed operation. Based on this  idw

assumption and using (4-8) and (4-9), the q-axis high-frequency stator voltage component in the estimated rotor reference frame can be expressed as in (4-11)

^ r vqsh  ( zdiff sin 2err ) I h cos ht

(4-11)

Since the inductance part of the impedance Z diff in (4-11) is the most effective part at high frequency, the resistive term of the impedance can be ignored. Based on this assumption, the voltage equation of (4-11) becomes

v

^ r qsh

h Lqh I h Lrdh  h(  )sin 2err sin ht 2 r r 2 r r 2 1  h LqhCh 1  h LdhCh
r

(4-12)

It is very clear from (4-12) that the rotor position estimation error err is amplitude modulated in the high-frequency q-axis voltage component. By demodulating the rotor position estimation error signal from (4-12) and controlling it to zero, the rotor position angle and speed can be estimated.

108

Fig. 4-11 shows the block diagram of the signal processing (demodulating process) method and the rotor position/speed estimator. As can be seen, the three phase stator terminal voltages of the machine are first measured using voltage sensors. From measured voltages, the q-axis voltage component in the estimated synchronous frame is calculated using an abc/dq coordinate transformation oriented at the estimated rotor angle position. Now, in order to obtain the rotor position estimation error, the signal processing method, consisting of BPF, multiplication, and LPFp (as shown in Fig. 4-11) is used as follows  A band-pass filter (BPF) with a center frequency of h is used to extract the highfrequency component from the q-axis stator voltage component in the estimated rotor reference frame.  Multiplication by sin h t is used for demodulating purpose. The results of the multiplication are two components, a dc-component and a second order harmonic highfrequency component.  A low-pass filter (LPFp) with cut-off frequency in the range of 5-10 times larger than the rotor angle estimator bandwidth is used to eliminate the second order harmonic term in the obtained signal. The mathematical details of the above mentioned signal processing method for extracting the rotor position estimation error are as follows:

109

^ r  (err )  LPFp {vqsh sin ht}



h Lqh Ih h Lrdh (  )sin 2err 2 r r 2 r r 2 1  h LqhCh 1  h LdhCh
r

(4-13)

Assuming that the estimated rotor position error is small, (4-13) can be approximated as

h Lrqh h Lrdh  (err )  I h (  ) err 2 r r 2 r r 1  h LqhCh 1  h LdhCh
=kerrerr
h Lrqh h Lrdh  ) is the signal injection response gain. 2 r r 2 r r 1  h Lqh Ch 1  h Ldh Ch

(4-14)

where kerr  I h (

As mentioned earlier, to estimate the rotor position and speed, the error signal  (err ) must be controlled to zero. This can be achieved using the estimator shown in Fig. 4-11. As can be seen, the rotor position estimator consists of a PI-controller and integrator. The closed-loop transfer function of this estimator from the actual rotor position to the estimated position can be expressed as in (4-15)
^  k s  k2 f  2 1  f s  k1s  k2

(4-15)

where the estimator open loop transfer function is G(s)  (1/ s)(k p  ki / s) ; k1  err k p and
k2  err ki . The PI-parameters k p and ki of the estimator can be simply designed by selecting

proper bandwidth for the estimator.

110

HF  I h cos h t

Cartesian to Polar

I _ comp
* I dc
* I dc _ comp

d-axis current Calculation

+

+

* I ds
* I qs

I
Capacitor Compensation

* dw

+

+



* r

+ -

Speed controller

* I qw

^r 

w
^f
Idc
+ +

x
inv

1
Limit

ma
To CSI PWM

/

0

^f
1 s
sin h t

Machine terminal voltages

LPFs

PI -Controller
( k p  ki / s )

 ( err )

LPFp

v

^ r qsh

v

^ r qs

abc dq

va vb vc

BPF

Rotor speed & position estimators

Signal processing

Fig. 4-11 Block diagram of the sensorless signal processor method and the rotor angle/speed estimator

In this thesis, the estimator is tuned for a 100 Hz bandwidth. This bandwidth gives fast response in the estimated speed and rotor angle position under dynamic load changes. To estimate the rotor speed, the output of the PI-controller in the rotor position estimator is directly used to estimate the rotor speed. A low-pass filter (LPFs) is used to reduce the ripple in the estimator rotor speed. The cut-off frequency of the speed estimator low-pass filter is set to 100 rad/sec. It is worth noting that in the CSC-fed IPM drive, in addition to the motor inductances, filter capacitor C plays an important role in the rotor position estimator design and therefore in the estimator dynamic response, as it is part of the gain kerr . Additionally, although the
111

values of the estimated d- and q-axis inductances are affected by the saturation, this does not influence the accuracy of the rotor angle estimation since these values are just gains of the estimator and their changes may have only a small impact on the rotor position estimation dynamic.

4.7 Proposed PWM Modulation Scheme
As mentioned earlier, one of the major challenges of injection through the inverter is the low ratio between sampling frequency and the injection signal frequency. One possible solution to this problem is to perform the injection at the output terminal of the inverter using an extra hardware device. However, this increases the cost and reduces the reliability of the drive system. Another solution could be to increase the switching frequency. However, this will increase the switching loss of the drive. In this section, a modified PWM modulation scheme is proposed to avoid the abovementioned challenges and achieve visible operation for the high frequency injection sensorless scheme. In general, to implement the SVM modulation scheme, a counter with a maximum value of Ts repeatedly counts from zero to Ts for each counter period, where Ts is the sampling period. The real time value of the counter is compared with the calculated dwelling times T1 and T1  T2 to generate the vectors I1 , I 2 and I o as shown in Fig. 4-12(a). In the conventional SVM, dwelling time T1 and T2 are calculated once and are then kept fixed within one counter period. Fig.4-12(a) shows the use of the conventional SVM modulation method with the injection of 300 Hz at an operating frequency of 1 Hz and 600 Hz switching frequency. As shown in Fig. 4-12(a), the counter generates the vector I1 at the

112

beginning of the each sample period. Once the counter value reaches above T1 , the second vector I 2 is generated. The zero vector I o is then chosen if the counter value increase is higher than T1  T2 . It is very clear that the discretization of the injection signal is very poor, causes a distortion for the injected high-frequency current signal and the high-frequency voltage response of the injected signal as well. As a result, a large error is created in the rotor angle estimation, leading to system instability. Fig.4-12(b) shows the proposed MS-SVM method for the injection method in which the dwelling time calculation is still based on the same counter period Ts as the conventional SVM, while the sampling of the vector angle and calculation of T1 and T1  T2 are performed multiple times with a multisampling frequency of f ms  1/ Tms during the sampling frequency (counter frequency) f s  1/ Ts . This method is first introduced in [75] to attenuate the fifth and seventh order harmonics of the fundamental output current. However, the purpose of using the multisampling SVM with the sensorless injection method is to improve the sinusoidal high-frequency injected waveform and, therefore, the rotor angle estimation. The ratio between the multisampling frequency f ms and the sampling frequency f s can be defined as SRms  f ms / f s . As shown in Fig.4-12(b), where
SRms  4 , the values of T1 and T1  T2 gradually change, reflecting the updated injected signal

in the vector reference angle. As a result, the proposed MS-SVM scheme can be considered to be an indispensable approach for the injection scheme for achieving visible sensorless operation at zero/low speed for the CSC-fed IPM drive system.

113

4.8 High-Frequency Signal Design
4.8.1 Effect of Filter Capacitor
The output filter capacitor can be considered as one of the main challenges with the sensorless high-frequency injection method. Normally, a high-frequency of 500 Hz is used in many literatures with application of VSI-fed drive system. The author of this thesis found that injection method with this range of frequency is not visible when it applies to the CSI-fed IPM drive system as the high frequency signal is damped by the large filter capacitor. Therefore, more investigation is carried out to determine a suitable frequency range for the current­source-converter fed IPM drive. To examine the effect of the output capacitor filter on the selection of high-frequency signal injection, the frequency responses of the system are investigated for the drive system parameters shown in Table 4-1. Two important transfer functions, vd / idw and vq / idw are derived first and their responses are studied using Bode plots. By converting (4-8) to a dynamic model, the transfer functions vd / idw and vq / idw as a function of rotor position error
 err can be derived as

^ r  vds  r^  zavg  zdiff cos 2 err  idw  r^  vqs   z sin 2 diff err  i r^  dw

(4-16)

where
114

zdiff  zavg 

s( Lrq  Lrd ) Lrd LrqC r 2 s 4  ( LrqC r 2 Rsr  Lrd C r 2 Rsr )s 3  ( LrqC r  Lrd C r  C r 2 Rsr 2 )s 2  2C r Rsr s  1 2 Ld LrqC r s 3  2( Rs Lrd C r  Rs LrqC r ) s 2  ( Lrq  Lrd  2CRsr 2 )s  2 Rsr Lrd Lrq C r 2 s 4  ( LrqC r 2 Rsr  Lrd C r 2 Rsr )s 3  ( LrqC r  Lrd C r  C r 2 Rsr 2 ) s 2  2C r Rsr s  1

T1  T2

Ts

Counter value

counter

T1

I1

I2

I0

(a)

t

T1  T2

Ts

Counter value

counter

T1

I1

I2

I0

(b)

t

Fig. 4-12 SVM modulation scheme (a) Conventional SVM modulation method(b) Proposed MS-SVM modulation method

115

Fig. 4-13 shows the output d-q voltage responses with respect to the d-axis inverter current. Fig. 4-13(a) shows the Bode plot of inverter d-axis voltage response to inverter daxis current ( vd / idw ) for different rotor position errors err  30o ,10o ,and 1o . As can be seen, the filter capacitor creates two resonance frequencies with motor inductances Ld and Lq . It is very clear that with high error the response shows high q-axis resonance components because of the coupling between the d-axis and q-axis circuits. However, the q-axis resonance frequency vanishes as the error err reduces while the d-axis resonance is still visible without any change. It should be noted here that injecting a high frequency component close to the d-axis resonance frequency could amplify the output voltage and current response. Fig. 4-13(b) shows the Bode plot of inverter q-axis voltage response to the inverter d-axis current ( vq / idw ) for different rotor position error err  30o ,10o ,and 1o . This response is important for the pulsating high-frequency injection method as the inverter qaxis voltage vq is used for the demodulation process. In addition, this response has the information of the machine saliency. As can be seen, two peak resonances are visible and the overall response is damped with the reduction of rotor position error err . Based on the system resonance frequencies, the response in Fig. 4-13 can be divided into three regions. These regions are Region 1: frequencies before the q-axis resonance frequency, Region 2: frequencies between the d- and q- axis resonance frequencies, Region 3: frequencies after the d-axis resonance frequency. As demonstrated below, injection of a high frequency signal in the proper region can give accurate and stable rotor angle estimation.

116

4.8.2 Effect of Low Switching Frequency
Normally, the switching frequency determines the number of PWM pulses of the fundamental stator current signal. In the high-frequency injection method, the injected current signal is modulated in the fundamental current signal of the CSC drive. With this arrangement, the switching frequency does not increase and the injected signal will be controlled within the PWM pulses of the fundamental current signal. Therefore, the number of PWM pulses that construct the high-frequency current signal nhf can be determined as
nhf  f sw / f hf

, where, f sw and f hf are the switching and injection frequency respectively. It

should be noted that in order to maintain a flexible and controllable injection highfrequency signal, a PWM modulation scheme with at least 2-pulses must be maintained. Therefore, the maximum injected high-frequency current signal for a certain system switching frequency can be achieved as f hf _ max  f sw / 2 .

117

Region 1

Region 2

Region 3

50

40

 err  30 o

Magnitude (dB)

30

 err  10o
 err  1o

20

10

0

q-axis res. freq. d-axis res. freq.
0 1 2 3

-10 10 10

Frequency (Hz) 10 (a) vd / idw

10

50

err  30o err  10o
Magnitude (dB)
0

err  1o

-50

q-axis res. freq. d-axis res. freq.

-100

0

1

10

10

Frequency (Hz) (b)

2

3

10

10

vq / idw

Fig. 4-13 D-q axis voltage responses to inverter current (a) Inverter d-axis voltage response to the inverter d-axis current ( vd / idw ) (b) Inverter q-axis voltage response to the inverter daxis current ( vq / idw )

118

4.8.3 Effect of Saturation
In an IPM machine, the effect of magnetic saturation in the q-axis is dominant. This can cause a reduction in the q-axis inductance as the load increases. Since the resonance frequency in CSI depends on the machine inductances, the resonance frequencies can be shifted according to the change of inductances of the machine with the load torque. Fig. 4-14 shows Bode plot of vq / idw response of the CSC-fed IPM drive for no-load and full load condition. It is very clear that the frequency range around the q-axis resonance frequency can be affected, as the q-axis inductance changes with the load. However, the resonance frequency of the d-axis will not change because of the negligible change of the d-axis inductance. Therefore, the saturation effect can impact the high frequency response around the q-axis resonance during the load change. This can cause an unstable frequency region when detecting the high frequency response for the estimation process.

40

q-axis resonance freq.

d-axis resonance freq.

Magnitude (dB)

20

No-Load
0

Full-Load

-20

-40

1

2

3

10

10

10

Frequency (Hz)

Fig. 4-14 Inverter q-axis voltage response to the inverter d-axis current ( vq / idw ) for two different q-axis inductances
119

4.8.4 General Design Guide

It is important that the injection signal should be selected carefully in order to achieve feasible operation for the sensorless injection method. As mentioned earlier, the frequency range of the voltage response can be divided into three regions as shown in Fig.4-13. Selecting injection signal in the frequency range below the q-axis resonance frequency (Region 1) might be low frequency and can impact the fundamental torque of the system. Also, the frequency range between the two resonances (Region 2) might not be visible as it affected by the saturation as shown in Fig. 4-14. Therefore, the frequency range after the daxis resonance frequency (Region 3) can be considered the visible range to inject the high frequency signal.

Now, if the excitation frequency is very close to the d-axis resonance frequency, the stator voltage and current may become unacceptably high. If the HF excitation frequency is far above the d-axis resonance frequency, the q-axis voltage response may become too low to be detected, and also the higher HF excitation frequency must be limited by f hf  f sw / 2 . As a result, the high frequency injected signal range should be selected not very far and not very near to the d-axis resonance frequency. It is worth noting that with different motor inductances, the filter capacitor design of the CSC-fed drive can provide a degree of freedom for the design of the injected signal frequency range.

120

4.9 Initial Rotor Position for CSC-Fed PM Drive
In the PM machine, where the rotor flux is independent of stator flux, the correct initial rotor position must be detected [29,31,76]. In order to explain the challenge of the initial rotor position in the PM machine, equation (4-1) is converted to a stationary reference frame as

s s  pL sin 2 f vds   Rs  p( L  L cos 2 f )   ids  sin  f   s   s   r f    (4-17) p  L sin 2  R  p (  L   L cos 2  ) cos  v i f s f f       qs     qs  

From the stationary reference frame model of the salient PM machine in (4-17), two position dependent components are apparent. The first is the back-EMF component which is not available at zero speed. The second term is due to the saliency and is a second harmonic of the rotor position. While this term allows determination of the magnetic axis (as shown in the proposed injection HF method), it does not allow determination of magnetic polarity (north or south) [77-80]. This can be explained as in Fig. 4-15, which shows the relation between the rotor position and the spatial inductance variation. As can be seen, the inductance changes two times compared with the rotor position. Therefore, the estimated rotor position can show uncertainty of  electrical degree. This means that the zero-speed sensorless method proposed previously can track the pole location only, but cannot differentiate between the magnetic north and south i.e, it is unknown whether positive or negative torque will result. Therefore, for the PM machine, an additional algorithm is required to determine the magnetic polarity in order to overcome the unexpected reverse rotation at the initial start.
121

f

t
Lsm
q-axis d-axis

LB
Lls  LA
90 180 270 360

f

Fig. 4-15 Relation between the rotor position and the spatial inductance variation

4.9.1 Conventional Techniques
To solve the initial rotor position problem, different possible conventional initial position procedures for the PM motor are previously proposed such as the following [29].

  

Open loop control. Specific gate pattern. Arbitrary starting.

In the case of the open loop control procedure, the motor is started by an open loop control till the speed comes to a certain point at which time the rotor position estimation is possible. This starting method is effective with model-based sensorless methods at medium and high speed.

122

Another approach for initial rotor position is by using specific gate pattern to generate sequence of dc-current vectors. While this method proved effective, it does not guaranteed alignment and it results in rotation of the motor shaft. In the case of the arbitrary starting procedure, an arbitrary gate pattern can be applied to the motor for the initial rotor position. This method may cause a temporary reverse rotation. In the extreme case, a stable start cannot be achieved.

4.9.2 Proposed Initial Rotor Position-based Stator Iron Saturation
To solve the problems of the above-mentioned conventional methods, another approach based on the stator iron saturation has been proposed. Fig. 4-16 shows the polarity-dependent saturation in the d-axis for 4-poles IPM synchronous machine. The solid arrows represent the magnet and the dashed arrows represent the armature current flux. In Fig.4-16(a), the permanent magnet flux and the armature current flux vector direction are aligned. This will increase the stator saturation and decreases the inductance. In Fig. 416(b), the permanent magnet flux and the armature current flux are 180 degrees out of phase. Since the inductance in the d-axis rotating frame is changed according to different magnetic polarity, the d-axis stator current is different as well. In case of polarity discrimination based upon the stator iron saturation, different techniques have been used over the years. Using separate positive and negative pulse techniques can produce torque (generate reluctance torque) and cause mechanical movement for the IPM machine [26,29,81]. Other methods that use second order harmonics [76,78,79] of the injected frequency is not visible when it applied to the current source

123

converter fed drive system as the output filter capacitor damps the second order component of the high frequency injected signal.
d-axis Armature flux direction Magnet flux direction Stator winding slot
N S

d-axis Armature flux direction Magnet flux direction Stator winding slot
S N

Stator

Stator

Shaft

Shaft
N N S N S

Shaft
S N S

Rotor
N S

Rotor Air gap
N

Shaft

Air gap permanent magnet
S

permanent magnet (a)

(b)

Fig. 4-16 Polarity-dependent saturation in the d-axis for 4-poles IPM synchronous machine. (a) permanent magnet flux and the armature current flux vector direction are aligned, (b) permanent magnet flux and the armature current flux are 180 degrees out of phase.

Therefore, in this thesis, the same HF sinusoidal current signal that injected in the d-axis estimated rotor position is used for polarity discrimination. After injecting the HF current signal, the actual d-axis stator current is measured to identify the polarity of the magnet. Fig. 4-17 shows the principle of the proposed polarity discrimination method. As can be seen, the measured d-axis HF current signal has different positive and negative amplitude as the motor inductance is already saturated because of the magnet flux. Therefore, the north-pole can be determined if it is aligned with the d-axis stator current ( qr
0 ).

In this

124

case, the increase of the saturation makes the amplitude of the positive cycle of d-axis stator current component larger than that of the negative cycle of d-axis stator current. Fig. 4-18 shows the overall proposed FOC control scheme with the proposed HF zero speed injection method. As can be seen, the proposed polarity discrimination method has been added to the scheme. The process of the polarity discrimination contains a high-pass filter to extract the high-frequency component of the d-axis current. Then, the maximum peak of the positive and negative of the output signal is calculated and compared. If the positive d-axis stator current component is larger than that of the negative d-axis current, the north-pole is aligned with the d-axis stator current ( qf
0 ).

If the positive d-axis stator

voltage component is smaller than that of the negative d-axis current, the south-pole is aligned with the d-axis stator current ( qf
p ). Therefore, an angle of  is added to the

estimated rotor position to get the right rotor flux position as shown in Fig. 4-18.



HF injected current

t

i
HF current response

 L i

i

t
Fig. 4-17 Principle of the proposed polarity discrimination method

125

4.10 Time domain simulation of large drive
Simulation results obtained using Matlab/Simulink are provided in this section to demonstrate the performance and effectiveness of the proposed high-frequency injection sensorless method. Table 4-1 shows the system parameters of the medium-voltage highpower 2.44 MW drive system used in the simulation. A high frequency of 200 A (around 30% of the rated current), 200 Hz has been used in the injection scheme of the drive. The amplitude of the injected signal can be adjusted depending on the size of the filter capacitor. The selection of the amplitude of the injected signal is based on a capacitor size of 0.42 p.u. The amplitude can be reduced to 20% of the rated current if the size of the capacitor is reduced to 0.3 p.u. Table 4-1 MV CSC-fed Salient PM drive System Parameters Parameters Simulation System Ratings Power 2.42 MW Voltage 4000 V Current 485 A Grid/Motor Freq. 60/40 Hz Motor Parameters d-axis synch. ind. 9.0 mH(0.47pu) q-axis synch. ind. 22 mH(1.16pu) Stator Resistance 0.035 (0.007pu) Number of Poles 12 Rotor Magnet Flux 6.77 web(0.52pu) Converter Parameters Grid-side Cap. 281 µf(0.5 pu) Motor-side Cap. 350 µf(0.42pu) Grid-side Line Ind. 2.72 mH(0.218pu) DC Link Ind. 16.25 mH(1.3pu) Switching Freq. 540 Hz

126

HF  I h cos h t

Cartesian to Polar
* I dw * I dc

I _ comp
* I dc _ comp

d-axis current Calculation

+

+

* I ds
* I qs

Capacitor Compensation
* I qw

+

+



* r

+ -

Speed controller

^r 

w
^ 
Idc
f

x
inv

1
Limit

ma
To CSI PWM

/

+

+

0

^  f
+ +

Max. peak detection
Polarity Identification

idh

BPF

id

abc dq
^  f

ia ib ic

1 s

sin h t

LPF

PI Controller

 ( err )

abc
vqh

va vb

LPF

BPF

vq

dq

vc

Rotor position and speed estimators

Signal processing

Fig.4-18 Overall proposed FOC control scheme with the proposed HF zero speed injection method Figs. 4-19 to Fig. 4-24 show the performance of the proposed high-frequency injection sensorless method with a step change load of 1 p.u. (57000 N.m) at zero and 0.47 Hz operating frequency. Fig. 4-19 and Fig. 4-20 show the estimated and the actual rotor angle at zero and 0.47 Hz operating frequency. As can be seen, the estimated angle follows the actual rotor angle position with a small error of around 3 degree (0.833%) at no-load and 5 degrees (1.388%) at full-load. This error mainly appears as a result of magnetic saturation of the machine. One effective method for this error compensation is with a position correction term that is a linear function of the stator current.

127

 f (rad )
7
Actual

6 5 4 3
Estimated

2 1 0 0 1 2 3 4 5 6 7 8 9 10

t (sec)
Fig. 4-19 Estimated and actual rotor flux angle at 0.47 Hz operating frequency with step load change from no-load to full-load

 f (rad )
7
Actual

6 5
Estimated

4 3 2 1 0 0 1 2 3 4 5 6 7 8 9 10

t (sec)
Fig. 4-20 Estimated and actual rotor flux angle at zero operating frequency with step load change from no-load to full-load
128

is ( A)
1000 800 600 400 200 0 -200 -400 -600 -800 -1000

0

1

2

3

4

5 (a) 0.47Hz

6

7

8

9

10

t(sec)

is ( A)
1000 800 600 400 200 0 -200 -400 -600 -800 -1000 0

1

2

3

4

5 (a) 0 Hz

6

7

8

9

10

t (sec)

Fig. 4-21 Stator current at zero and 0.47 Hz operating frequency with step load change from no-load to full-load

129

vs (V )
3000 2000 1000 0 -1000 -2000 -3000 0 1 2 3 4 5 6 7 8 9 10

t(sec)
(a) 0.47Hz

vs (V )
3000 2000 1000 0 -1000 -2000 -3000 0 1 2 3 4 5 (a) 0 Hz 6 7 8 9 10

t (sec)

Fig.4-22 Stator voltage at zero and 0.47 Hz operating frequency with step load change from no-load to full-load

130

Fig. 4-21 and Fig. 4-22 show the stator current and voltage of the motor at zero and 0.47 Hz. As can be seen, with proper selection of the HF current signal amplitude and frequency (200 A, 200 Hz), the stator voltage and current waveforms are within the operating rated values of the drive. In addition, with proposed ma control, dc-link current compensation, and the multisampling SVM, the HF injection current component signal has transferred and modulated properly through the inverter even with a large capacitor and low switching frequency of 540 Hz. Fig. 4-23 and Fig. 4-24 show the estimated and actual rotor speed at zero and 0.47 Hz operating electrical frequency during the step change load. It is observed that the estimated speed tracks the actual speed quite well during the load disturbances. It is evident from the dynamic performance that the proposed FOC and modulation scheme ensure proper transfer and dynamic for the HF signal, even with heavy load dynamic. This means that the proposed sensorless injection method of CSC-fed IPM drive is capable of persistent zero/low speed with a high dynamic load condition. It is very clear that the speed and rotor angle estimation waveforms have noticeable pulsation ,as shown in Figs. 4-20, 4-23 and 4-24, due to the CSC nonlinearity and the un-modeled disturbances that appear during the demodulation process. However, the actual speed of the motor is smooth due to the inertia of the motor that works as a low pass filter to these pulsating frequencies.

131

r (rad /sec)
5 0 -5 -10 -15 -20 0

1

2

3

4

5 6 (a) Estimated

7

8

9

10

t (sec)

r (rad / sec)
5 0 -5 -10 -15 -20

0

1

2

3

4

5 (b) Actual

6

7

8

9

10 t (sec)

Fig. 4-23 Estimated and actual speed at 0.47 Hz operating frequency with step load change from no-load to full-load

132

r (rad /sec)
5 0 -5 -10 -15

-20 0

1

2

3

4

5

6

7

8

9

t (sec)

10

(a) Estimated

r (rad / sec)
5 0 -5 -10 -15 -20

0

1

2

3

4

5 (b) Actual

6

7

8

9

t (sec)

10

Fig. 4-24 Estimated and actual speed at zero operating frequency with step load change from no-load to full-load

4.11 Conclusions
In this chapter, a novel sensorless control scheme is proposed for a high-power medium voltage CSC-fed IPM drive system at zero/low speed operation. This control
133

scheme is based on the high-frequency sinusoidal injection method. Unlike the application of the HF injection method in VSI, the HF injection method of the CSC-fed IPM drive system requires modification of conventional FOC and SVM modulation schemes. Therefore, modulation index control with dc-link compensation in the FOC scheme is introduced to improve the slow dynamic of the injection signal through the rectifier controller and dc-link inductor, and to avoid any clamp in the HF signal. In addition, multisampling (MS-SVM) instead of conventional SVM is proposed to prevent the injected signal distortion resulting from poor discretization. The detailed analysis of the influences of the output filter capacitor, low switching frequency, and motor saturation on the HF injected signal led to propose general guide for the visible frequency range of the HF injected signal. The validity of the sensorless injection method in the medium voltage CSC-fed drive system is verified using a time domain simulation using high-power medium-voltage CSC drive system parameters. Results have shown that by using the proposed FOC scheme and multisampling SVM modulation scheme, and proper design of the high-frequency signal, an accurate rotor position angle can be estimated for zero/low speed sensorless operation of CSC-fed IPM drive system. The main contributions of this chapter can be summarized as follows.  A new control scheme based on a high frequency sinusoidal injection method is proposed for a zero/low speed sensorless high-power medium voltage CSC-fed IPM drive system. This includes the injection control scheme of the CSC drive and the speed/position estimator.

134



The proposed sensorless control scheme can allow 100% rated torque at zero and low speed operation.



A multisampling PWM (MS-PWM) modulation scheme is proposed to prevent the injection signal distortion resulting from poor discritization.



A high-frequency mathematical model is developed for the high-power medium voltage CSC-fed IPM drive system.



Detailed analysis is performed to study the feasibility and the influences of the output filter capacitor, low switching frequency and motor saturation on the high-frequency (HF) signal injection method.

  

Proposed general guide for the visible frequency range of HF injected signal is created. Systematic analysis and design are carried out for the rotor position/speed regulator. An initial rotor position control method is proposed for high-power medium voltage CSC-fed IPM drive system. The same sinusoidal injected signal of the sensorless speed control is used. The main feature of this method is the simplicity in detecting the initial rotor position.

135

Chapter 5 Experimental Verification
In this chapter, an experimental verification for the proposed power factor control method and the zero-speed high-frequency injection method is performed. The chapter starts with an explanation of the experimental prototype. Then the experimental results of the proposed methods are provided with their explanation.

5.1 Experimental Prototype
To experimentally verify the power factor compensation method and zero speed high frequency injection method that was proposed in the previous chapters, a scaled-down prototype of the current-source converter with a 6.5 kW IPM motor is used in the laboratory. The experimental prototype consists of a current source rectifier and an inverter in back-to-back configuration with a dc-link inductor connected between the two converters. Each of the rectifier and inverter bridges is composed of six ABB's reverseblocking IGCT rated 6KV/800A each. Although high-power IGCTs are used, the power rating of the prototype is only 20kW at 208V. This is mainly due to the limitation of the three-phase power supply and personal safety issues in the laboratory. Fig.5-1 shows the experimental setup of the CSC-fed PMSM drive system. Parameters of the drive and the IPM motor are listed in Table 5-1.

136

The speed and position estimated results of the proposed method are compared with actual results measured by using a resolver mechanically connected with the IPM motor. The mechanical load in the test is applied by using a dc motor coupled mechanically with the IPM motor. This dc motor is controlled by dc drive in a torque mode operation. In case of the zero speed sensorless method, the HF signal is designed to be 3A (13% of rated current), 300 Hz for the drive system parameters listed in Table 5-1. The drive control platform consists of a fixed-point DSP for control scheme realization and a fieldprogrammable gate array (FPGA) for gating and fault handling.

CSR

CSI

DC Machine Controller

IPM Machine

Fig.5-1 experimental setup of the CSC-fed PMSM drive system

137

Table 5-1 Experimental LV System Parameters Parameters Data System Ratings Power 6.5 kW Voltage 230 V Current 16.3 A Grid/Motor Freq. 60/77.5 Hz Motor Parameters d-axis synch. ind. 3.3mH (0.197pu) q-axis synch. ind. 7.3mH (0.436pu) Stator Resistance 0.25 (0.03pu) Number of Poles 6 Rotor Magnet Flux 0.38web (0.97pu) Converter Parameters Grid-side Cap. 185µf (0.57pu) Motor-side Cap. 120µf (0.4pu) Grid-side Line Ind. 4.71mH (0.218pu) DC Link Ind. 28.1mH (1.3pu) Switching Freq. 600 Hz

5.2 Verification of Power Factor Control Method
Figs. 5-2 to 5-5 show the experimental results obtained from the CSC-scaled prototype drive system for power factor verification. In these results, two load conditions (light and heavy load condition) are tested to demonstrate the effectiveness of the proposed method. Some of the experimental results have been presented with simulation results to show the accuracy of the experimental implementation. Figs. 5-2 and 5-3 illustrate the steady-state performance of the drive with and without power factor compensation at light load condition. In Fig. 5-2, the motor is controlled using conventional ZDC without power factor compensation. In this case, the motor is operated at
138

0.262 p.u. speed and torque of 0.217 p.u. to emulate the light load condition. As can be seen, there is a large phase angle between the input current and the input phase voltage because of the large line capacitor 0.57 p.u. of the drive. This line capacitor draws significant leading reactive current (especially at light load and low speed) and results in a power factor of 0.248 (leading).

iin

vg

iqs  5.4 A

' iw

ids  0 A

2.5ms
Experiment Results

50ms

iin

vg

8 6 4
' iw

iqs

2 0 -2

ids

0.015

0.02 0.025 (a)

0.03

0.035

0

0.1

0.2 (b)

0.3

0.4

0.5

t (sec)
Simulation Results

t (sec)

Fig. 5-2 Drive waveforms without the proposed input power factor compensation at light load condition. (Vg 100V/Div, Iin 5A/Div, I w 10A/Div)

139

vg

iin

iqs  5 A

' iw

2.5ms
Experiment Results

50ms

ids  10.7 A

vg

10 5 0
' iw

iin

iqs

-5 -10

ids
0.1 0.2 0.3 (b) 0.4 0.5

0.015

0.02

0.025 (a)

0.03

0.035

t (sec)

0

t (sec)

Simulation Results

Fig. 5-3 Drive waveforms with the proposed input power factor compensation at light load condition. (Vg 100V/Div, Iin 5A/Div, I w 10A/Div)

Fig.5-3 illustrates the performance of the drive under light load condition with the proposed line power factor compensation. A large d-axis stator current 0.465 p.u. is injected to the machine by the proposed method for the input power factor compensation as shown in Fig. 5-3b. This d-axis stator current boosts the dc-link current from 0.234 p.u. to
140

0.513 p.u., and thus provides enough rectifier current I w to compensate the reactive capacitor current. As can be seen from Fig.5-3b, the line current is in-phase with the phase voltage and a unity power factor is achieved. Figs.5-4 and 5-5 illustrate the performance of the drive under a heavy load condition (0.7 p.u. torque at 0.88 p.u. speed) with and without the proposed compensation method. Without the power factor compensation (using ZDC method), the power factor is slightly leading 0.98 due to the large line capacitor used (see Table 5-1). When the d-axis stator current method is enabled, enough d-axis stator current of 0.217 p.u. is injected to the machine for power factor compensation. As a result, the power factor changes from 0.98 (leading) to unity as shown in Fig.5-5. It should be noted that the q-axis stator current component has been reduced while the d-axis stator current component has increased due to the proposed method as shown in Figs. 5-4 and 5-5. This can be explained as follows: since the IPM machine type is used in the test, the increase in d-axis stator current produces the reluctance torque component of the machine torque which causes a reduction in the required q-axis stator current that participates in the magnet torque component.

141

vg

iin
' iw

2.5ms

iqs  16.1A

ids  0 A
50ms

Fig. 5-4 Drive waveforms without the proposed input power factor compensation at heavy load condition. (vg 100V/Div, iin 10A/Div, iw 10A/Div)

5.3 Verification of Zero Speed Sensorless Method
Figs.5-6 to 5-11 show the experimental results of the proposed zero speed sensorless method obtained from the drive system. In these results, different load and speed conditions are tested to show the validity of the high-frequency sensorless control of the CSC-fed IPM drive system. Fig.5-6 illustrates the HF injection response represented by line-to-line stator voltage and its frequency harmonic spectrum for conventional and proposed SVM modulation
142

scheme with motor speed of 2 rad/sec and light load condition. In Fig.5-6a, the injection is controlled through the inverter using conventional SVM. Ideally, the harmonic profile of the voltage response in the stationary reference frame should appear as two components with frequencies of h  ^f and h  ^f . However, the harmonic profile, shown in Fig.5-6a, of the injection with the conventional SVM shows that the voltage response has been distorted, as it appears as multiple side-band components. The physical origin of these sidebands components is not a saliency in the machine. Therefore, these components can cause incorrect modeling of saturation-induced saliency and can deteriorate the estimated rotor angle and speed. Therefore any increase and sudden load change can cause system instability. It should be noted that the test in this case has been carried out at no-load and with a very low speed control loop bandwidth to avoid any unstable operation incurred due to the error in the estimated rotor angle. Fig.5-6b illustrates the HF response represented by stator voltage and its frequency spectrum with the proposed MS-SVM. As can be seen, the side band harmonics of the injected high-frequency signal have been reduced dramatically with the use of MS-SVM, and therefore a large signal-to-noise ratio can be achieved. Fig.5-7 shows the line-to-line motor stator voltage, stator phase current and the frequency spectrum of the line-to-line motor stator voltage at zero and 3.342 Hz electrical operating frequency for no-load operation. As can be seen, with the proper selection of the HF current signal amplitude and frequency (3A, 300Hz), the stator voltage waveform response is within the operating rated voltage of the drive. In addition, with the proposed
ma

control with dc-link compensation and the multi-sampling SVM, the high-frequency

143

injection current component signal has transferred properly through the CSI inverter even with large capacitor and low switching frequency.

vg

iin
' iw

2.5ms

iqs  15.4 A

ids  5.4 A
50ms

Fig. 5-5 Drive waveforms with the proposed input power factor compensation at heavy load condition. (vg 100V/Div, iin 10A/Div, iw 10A/Div)

144

Voltage

1
Injected Signal In Stationary Frame
Ch1: 100V/div, 1 sec/div

Noise

Ch2: 5V/div, 5 Hz/div

2

(a)

Voltage

1
Injected Signal In Stationary Frame
Ch1: 100V/div, 1 sec/div Ch2: 5V/div, 5 Hz/div

Noise

2

(b)

Fig.5-6 Line-to-line stator voltage and its frequency harmonic spectrum (a) Conventional SVM at motor speed of 2 rad/sec and no-load condition (b) Proposed MS-SVM (with higher signal/noise ratio) at motor speed of 2 rad/sec and light-load (0.2 p.u.) condition

It should be noted here that injecting any signal into the machine may reduce the overall drive efficiency because of the loss of the injected signal. However, this can be adjusted by selecting the proper (minimum) signal injection amplitude. Also, the injected signal might impact the machine fundamental torque and speed. However, since the excitation signal in the proposed method takes the form of the HF sinusoidal waveform, as
145

shown in the current and voltage waveform of Fig.5-7; this will reduce the vibration in the motor. The moment of inertia of the machine functions as a low pass filter to any HF signal and, therefore, filters the effect of the pulsating HF sinusoidal torque component (results from the injected HF signal) to negligible levels on the motor speed. Fig.5-8 shows the estimated and the actual rotor position during startup from zero speed to 0.477Hz operating electrical frequency at no-load and full-load. It is obvious that the estimated rotor position follows the actual rotor position under the steady state and transition condition with a small error of around 0.1 degree (0.02%) at no-load and 3.8 degree (1.05%) at full-load as shown in Fig.5-8. This error appears mainly as a result of the magnetic saturation of the machine and has been addressed numerously in the literatures. One effective method for this error compensation is with a position correction term that is a linear function of the stator current. Fig.5-9 shows the estimated and the actual rotor speed at zero and 0.954Hz operating electrical frequency during load disturbance. The full load was applied to the machine at t=4 sec and removed at t=14 sec. It is observed that the estimated speed tracks the actual speed quite well during the load disturbance. It is evident from the dynamic performance that the proposed FOC and modulation scheme ensures proper transfer and dynamic for the high-frequency signal even with a heavy load dynamic. This means the sensorless injection method of CSC-fed IPM drive is capable of persisting zero/low speed with a high dynamic load condition.

146

Voltage

1
Ch1: 250V/div, 400ms/div Current

2 zoom
Voltage Ch1: 20A/div, 400ms/div

3
Ch3: 250/div, 4ms/div Current

4
Ch4: 20A/div, 4ms/div 300Hz

5

Zero speed No load

Ch5: 50V/div, 10Hz/div

(a)

Voltage

1
Ch1: 250V/div, 400ms/div Current

2 zoom
Voltage Ch1: 20A/div, 400ms/div

3
Ch3: 250/div, 20ms/div Current

4
Ch4: 20A/div, 20ms/div

5
7 rad/sec speed No load Ch5: 50V/div, 10Hz/div

(b)

Fig.5-7 Line-to-line motor stator voltage, stator phase current and the frequency spectrum of the line-to-line motor stator voltage (a) Zero speed operation (b) 3.342 Hz electrical operating frequency.

147

2 rad
Estimated position

0 rad
2 rad
Actual position

0 rad
1s/div

Error=0.1 (Elec. Degree) (a)
2 rad
Estimated position

0 rad
2 rad
Actual position

0 rad
1s/div

Error=3.8 (Elec. Degree) (b)
Fig.5-8 Estimated and actual rotor position during the start up from zero speed to 0.477Hz operating electrical frequency (a) No-load condition (b) Full load condition

148

Estimated speed

Actual speed

10 (rad/s)/div, 2s/div

(a)

Estimated speed

Actual speed

10 (rad/s)/div, 2s/div

(b)

Fig.5-9 Estimated and the actual rotor speed during load disturbance.(a) Zero speed (b) 0.954Hz operating electrical frequency

Fig. 5-10 and Fig. 5-11 show the experimental results of the rotor polarity discrimination method. As mentioned in Chapter 4, the principle of the polarity discrimination method is to detect the positive and negative peaks of the measured highfrequency d-axis stator current that results from the high-frequency injection signal.

149

Fig. 5-10 shows the actual high frequency d-axis stator current measurement when the rotor permanent magnet flux and the stator flux are aligned. As can be seen, the positive cycle of the d-axis stator current waveform has a larger amplitude compared with the negative cycle. In this case, no additional action is required from the detecting polarity circuit as the polarity of the rotor is correct. Fig. 5-11 shows the high frequency d-axis stator current waveform when the rotor permanent magnet flux and the stator flux are 180 degrees out of phase. As can be seen, the negative cycle of the high frequency d-axis stator current waveform has a larger amplitude compared with the positive cycle. Therefore, it is necessary to add an additional 180 degrees to the estimated rotor angle to achieve the correct position and polarity for the estimated rotor flux angle.

id

Fig. 5-10 d-axis stator current results from the high frequency injected signal when the rotor and the stator flux in the same direction (Correct polarity)

150

id

Fig. 5-11 d-axis stator current results from the high frequency injected signal when the rotor and the stator flux in the opposite direction (wrong polarity)

5.4 Conclusions
This chapter first discusses the experimental setup that was used in this thesis. Then, both the power factor control and zero speed sensorless methods were verified experimentally using the experimental setup. The main conclusions of this chapter are as follows:  For the proposed power factor compensation method, the experimental results show that with properly designed filter capacitors, the proposed d-axis stator current control can effectively regulate the input power factor to achieve unity for the entire speed range.  For the proposed zero/low speed sensorless method, the experimental results show that by using the proposed FOC scheme and multisampling SVM modulation, and the

151

proper design of the HF signal, an accurate rotor position can be estimated for zero/low speed sensorless operation of the CSC-fed PM drive system.  Although a scaled-down prototype is used in the experiments, the experimental results are equally valid for high power drives at megawatt levels from the control scheme development perspective. This is due to the following justifications:

1.

The maximum switching frequency of the current source rectifier and inverters remains at 540Hz, which is the same frequency in the commercial large drives. The switching frequency is one of the most important factors affecting the dynamic performance of the drives;

2.

The system sampling frequency of 4 KHz is selected to be the same as that used in large commercial drives;

3.

Per unit system is used in designing all the filter capacitors and inductors in the drive. These passive components are selected such that they are in the range (in per unit) as those in large drives. In doing so, the design and analysis are applicable to large drives; and

4.

The IGCTs used in the prototype are the same as those that would be used in the large drives. The effect of the switching times on the system dynamic performance would be similar to that in the large drives.

152

Chapter 6 Conclusions and Future Work
6.1 Conclusions
In this thesis, a zero/low speed sensorless CSC-fed PMSM drive system is proposed. A comprehensive study of the proposed drive has been carried out. The main topics covered include: PMSM control scheme investigation; zero/low speed sensorless control investigation; and an initial rotor position control and low speed input power factor compensation. The main contributions and conclusions of this research are summarized as follows: 1) Feasibility investigation of CSC-fed PMSM drive system The characteristics of three control configurations of the CSC-fed drive system are discussed and compared. Selecting variable dc-link current control scheme can reduce the loss of the CSC-fed drive system. In addition, choosing the variable dc-link control scheme with the on-line PWM with fixed low modulation index can improve the dynamic performance of the drive. The performance of three control schemes are studied and analyzed. It was found that in order to achieve full control for SM and IPM motors, the ZDC and MTPA must be used respectively.

153

2) Complete system models for CSC-fed PMSM drives have been built The mathematical basis of current source converter fed permanent magnet synchronous motor is discussed and derived. The dynamic and steady state models are established. The main conclusions of the system modeling are as follows:  A 10th order dynamic model for the CSC-fed PM drive system is derived. The equations are established in synchronous reference frame defined on both sides of the converters. In the case of the motor side, the equations are synchronized with the rotor angle reference frame, whereas the grid-side equations are synchronized with capacitor voltage.  Steady state equations are obtained from the dynamic model to calculate the steady state values of system operating points.

3) A unity power factor control scheme has been proposed for wide speed operation including very low speed range. A new unity power factor control scheme is proposed for whole speed range including the very low speed operation. This control scheme is based on the motor d-axis stator current control in the field oriented control of the drive system and does not require online modulation scheme. The proposed control scheme can be applied to both salient and nonsalient permanent magnet synchronous motors. Furthermore, the proposed scheme is simple and does not require any additional PI regulator.

154

4) A zero/low speed sensorless control scheme has been proposed for the CSC-fed IPM drive In this thesis, a new control scheme for zero and low speed sensorless operation for current source converter fed IPM motor is developed. The main conclusions of the proposed control scheme are as follows:  A new control scheme based on a high frequency sinusoidal injection method is proposed for the zero/low speed sensorless CSC-fed IPM drive system. This includes the injection control scheme of the CSC drive and the speed/position estimator.  The proposed sensorless control scheme can allow 100% rated torque at zero and low speed operation.  A multisampling PWM (MS-PWM) modulation scheme is proposed to prevent the injection signal distortion resulting from poor discretization.  Detailed analysis was performed to study the feasibility and the influences of an output filter capacitor, low switching frequency and motor saturation on the high-frequency (HF) signal injection method.  A proposed general guide for the visible frequency range of HF injected signal was created.  Systematic analysis and design were carried out for the rotor position/speed regulator.

155

5) Polarity identification control scheme has been proposed for the CSC-fed IPM drive An initial rotor position control method is proposed for CSC-fed IPM drive system. In the proposed method, the same sinusoidal injected signal of the sensoless speed control is used. The main feature of this method is the simplicity in detecting the initial rotor position.

6) Simulation models have been developed for verification of system operation and control schemes   A complete system model, including motor, converters, and the grid are developed. A unity power factor control algorithm was investigated and implemented in the simulation.  A high frequency sinusoidal injection scheme and rotor angle position/speed estimator for zero/low speed sensorless control scheme are implemented and investigated in the simulation.

7) Experimental verification on a laboratory prototype has been conducted A low-voltage experimental platform was designed. The control algorithms are coded in DSP. All the input power factor control scheme, high-frequency injection zero/low sensorless control scheme, and the polarity identification method are verified experimentally.

156

The outcome of the research work presented in this thesis has brought several innovative contributions to the establishment and performance of current source-fed PMSM drive systems, including : (a) a new UPF control scheme for all operating speed ranges including the very low speed range with simple control design (b) a new zero/low speed sensorless control scheme with good dynamic performance, maximum torque capability, simplified control design, and very small rotor position estimation error (c) and a new polarity identification method for initial rotor position.

6.2 Future Work
The following work is suggested for future research 1) Zero/low sensorless control of the CSC-fed Surface Mount drive system As mentioned in this thesis, the zero/low speed sensorless method requires some saliency to estimate the rotor position and speed. Since the surface mount (SM) permanent magnet motor is considered as a non-salient motor, therefore, developing a zero/low sensorless method for CSC-fed SM drives brings great benefit to the system. 2) Transition algorithm between low and high speed sensorless methods Using the high frequency injection method for sensorless operation may reduce the high speed capability of the machine because of the power losses and pulsating torque noise. Therefore, a combination of two methods may be required for a sensorless drive operation over full speed ranges. During the transition region, the estimation methods are simply changed at certain speeds. As a result, it is not straight forward to combine the methods in

157

the transition region. Therefore, a proper transition algorithm for the two sensorless methods will bring great benefit to the drive system.

158

References
[1] M. J. Melfi, S. D. Rogers, S. Evon, and B. Martin, "Permanent-magnet motor for energy saving in industrial application," IEEE Trans. Ind. Appl., vol.44, no.5, pp.1360-1366, Sept./Oct. 2008. [2] E. Armando, P. Guglielmi, G. Pellegrino, M. Pastorelli, and A. Vagati, "Accurate modeling and performance analysis of IPM-PMASR motor," IEEE Trans. Ind. Appl., vol.45, no.1, pp.123-130, Jan./Feb. 2009. [3] L. Parsa, and L. Hao, "Interior permanent magnet motor with reduced torque pulsation," IEEE Trans. Power Electron., vol. 55, no.2, pp. 602-609, Feb. 2008. [4] P. Curiac, and D. H. Kang, "Preliminary evaluation of a megawatt-class low-speed axial flux PMSM with self-magnetization function of the armature coils," IEEE Trans. Energy Conversion, vol.22, no.3, pp.621-628, Sept 2007. [5] Ø. Krøvel, , R. Nilssen, , and A. Nysveen, "A Study of the research activity in the nordic countries on large permanent magnet synchronous machines", NORPIE, Trondheim Norway, pp 1-6, June 2004. [6] J. S. Smith, and A. P. Watson, "Design, manufacture, and testing of a high speed 10 MW permanent magnet motor and discussion of potential applications," Proceedings of the 35th Turbo machinery symposium, pp. 19-24, 2006. [7] A. Faulstich, J. K. Steinke, and F. Wittwer, "Medium voltage converter for permanent magnet wind power generators up to 5 MW," in Proc. Eur. Conf. Power Electron. Appl., 2005, P.9.
159

[8]

M. Liserre, R. Cardenas, M. Molinas, and J. Rodriguez, "Overview of multi-MW wind turbines and wind parks," IEEE Trans. Ind. Electron., vol. 58, no.4, pp. 10811095, April. 2011.

[9]

T. Jokinen, A. Arkkio, M. Negrea, I. Waltzer, "Thermal analysis of Azipod permanent magnet propulsion motor," International Journal of Electrical Engineering in Transportation, vol. 1, no. 1, pp.15-20, 2005.

[10]

P. Anderson and U. Gragen, "The energy saving propulsion concept," Dynamic Position Conference, Houston, Session 6, pp.1-15, October, 1997.

[11]

J. King, and I. Ritchey, "Marine propulsion: The transport technology for the 21st century," Ingenia online-Royal academy of Engineering, no.12, pp7-14, May 2002.

[12]

B. Welin, and C. Friman, "New direct drive system opens a new era for paper machines," Paper and Timber, vol. 83, no. 5, pp.385-387, 2001.

[13]

M. Rashed, P. MacConnell, A. Stronch, and P. Acarnley, "Sensorless indirect-rotorfield-orientation speed control of a permanent-magnet synchronous motor with stator-resistance estimation," IEEE Transactions on Industrial Electronics, vol. 54, no. 3, June 2007, pp. 1664-1675.

[14]

P. Acarnley, and F. Watson, "Review of position-sensorless operation of brushless permanent-magnet machines," IEEE Transactions on Industrial Electronics, vol. 53, no. 2, December 2006, pp. 352-362.

160

[15]

M. P. Kazmierkowski, and L. Malesani, "Special section on PWM converter current control," IEEE Transactions on Industrial Electronics, vol. 45, no. 5, October 1998, pp. 689-690.

[16]

P. Espelage and J. Nowak, "Symmetrical GTO current source inverter for wide speed range control of 2300 to 4160 V, 350 to 7000 hp, induction motors," in Proc. IEEE IAS Annu. Meeting, 1988, pp. 302-307.

[17]

N. Zargari, Y. Xiao, and B. Wu, "Near unity input displacement factor current source PWM drives," IEEE Transactions on Industry Applications, vol. 35, no. 4, July/August 1999, pp. 19-25.

[18] [19]

B. Wu, High-Power Converters and AC Drives. Wiley-IEEE Press, 2006. A. Beig, and V. Ranganathan, "A Novel CSI-Fed induction motor drive," IEEE Transactions on Power Electronics, vol. 21, no. 4, July 2006, pp. 1073-1082.

[20]

N. Kasa, M. Kamatani, and H. Watanabe, "Current source inverter drive speed sensorless vector controlled induction motor," IECON, pp. 983-986, Nov.1993.

[21]

A. Nikolic, and B. Jeftenic, "Speed sensorless direct torque control implementation in a current source inverter fed induction motor drive," in 35th Annual IEEE Power Electronics Specialists Conference 2004, pp. 2843-2848.

[22]

G. Foo, and M. F. Rahman, "Sensorless direct torque and flux-controlled IPM synchronous motor drive at very low speed without signal injection," IEEE Trans. Ind. Electron., vol.57, no.1, pp.395-403, January 2010.

161

[23]

S. Bolognani, M. Zigliotto, and M. Zordan, "Extended-range PMSM sensorless speed drive based on stochastic filtering," IEEE Trans. Power Electron., vol.16, no.1, pp.110-117, January 2001.

[24]

S. Bolognani, L. Tubiana, and M. Zigliotto, "Extended kalman filter tuning in sensorless PMSM drive," IEEE Trans. Ind. Appl., vol.39, no.6, pp.1741-1747, Nov./Dec. 2003.

[25]

G. Zhu, A. Kaddouri, L. A. Dessaint, and O. Akhrif, "Nonlinear state observer for the sensorless control of a permanent-magnet AC machine," IEEE Trans. Ind. Electron., vol. 48, no. 6, pp.1098-1108, December 2001.

[26]

S. Nakashima, Y. Inagaki, and I. Miki, "Sensorless Initial Rotor Position Estimation of Surface Permanent-Magnet Synchronous Motor," IEEE Trans. Ind. Appl., vol.36, no.6, pp.1598-1603, Nov./Dec. 2000.

[ 27]

T. Yuzawa, K. Tanaka, R. Moriyama, and I. Miki, "An efficient estimation method of sensorless initial rotor position for surface PM synchronous motor," IEEE Electric Machines and Drives Conference, (IEMDC), pp. 44-49, 2001.

[28]

M. Tursini, R. Petrella, and F. Parasiliti, "Initial rotor position estimation method for PM motor ," IEEE Trans. Ind. Appl., vol.39, no.6, pp.1630-1640, Nov./Dec. 2003.

[29]

N. Matsui, "Sensorless PM brushless DC motor drives," IEEE Trans. Ind. Electron., vol. 43, no.2, pp. 300-308, April 1996.

162

[30]

R. Mizutani, T. Takeshita, and N. Matsui, "Current model-based sensorless drives of salient-pole PMSM at low speed and standstill," IEEE Trans. Ind. Appl., vol.34, no.4, pp.841-846, Jul./Aug. 1998.

[31]

M. Boussak, "Implementation and experimental investigation of sensoerless speed control with initial position estimation for interior permanent magnet synchronous motor drive," IEEE Trans. Power Electron., vol. 20, no.6, pp. 1413-1422, Nov. 2005.

[32]

A. Consoli, G. Scarcella, and A. Testa, "Industry application of zero-speed sensorless control techniques for PM synchronous motors," IEEE Trans. Ind. Appl., vol.37, no. 2, pp. 513-521, March/April 2001.

[33]

C. Silva, G. M. Asher, and M. Sumner, "Hybrid rotor position observer for wide speed-range sensorless PM motor drives including zero speed," IEEE Trans. Ind. Electron., vol. 53, no. 2, pp. 373-378, April 2006.

[34]

G.-D. Andreescu, C. I. Pitic, F. Blaabjerg, and I. Boldea, "Combined flux observer with signal injection enhancement for wide speed range sensorless direct torque control of IPMSM drives," IEEE Trans. Energy Conver., vol. 23, no. 2, pp. 393402, June 2008.

[35]

T. Noguchi, K. Takehana, and S. Kondo, "Mechanical-sensorless robust control of permanent-magnet synchronous motor using phase information of harmonic reactive power," IEEE Trans. Ind. Appl., vol.37, no. 2, pp. 513-521, March/April 2001.

163

[36]

T. Noguchi, K. Yamada, S. Kondo, and I. Takahashi, "Initial rotor position estimation method of sensorless PM synchronous motor with no sensitivity to armature resistance," IEEE Trans. Ind. Electron., vol. 45, no. 1, pp. 118-125, Feb. 1998.

[37]

M. J. Corley, and R. D. Lorenz, "Rotor position and velocity estimation for a salient-pole permanent magnet synchronous machine at standstill and high speeds," IEEE Trans. Ind. Appl., vol.34, no. 4, pp.784-789, July/August 1998.

[38]

J.-H. Jang, J.-I. Ha, M. Ohto, K. Ide, and S.-K. Sul, "Analysis of permanent-magnet machine for sensorless control based on high-frequency signal injection," IEEE Trans. Ind. Appl., vol. 40, no. 6, pp.1595-1604, Nov./Dec. 2004.

[39]

G. Foo, S. Sayeef, and M. F. Rahman, "Low-speed and standstill operation of a sensorless direct torque and flux controlled IPM synchronous motor drive," IEEE Trans. Energy Conver., vol. 25, no.1, pp. 25-33, March 2010.

[40]

N. Bianchi, S. Bolognani, J.-H. Jang, and S.-K. Sul, "Advantages of inset PM machines for zero-speed sensorless position detection," IEEE Trans. Ind. Appl., vol. 44, no. 4, pp.1190-1198, July/Aug. 2008.

[41]

Y. W. Li, M. Pande, N. R. Zargari, and B. Wu, "An input power factor control strategy for high-power current-source induction motor drive with active frontend," IEEE Trans. on Power Electronics, vol. 25, no. 2, pp 352-359, Feb. 2010.

[42]

E. Al-nabi, B.Wu, N. Zargari, and V. Sood, "Input power factor compensation for high power CSC fed PMSM drive using d-axis stator current control," IEEE Trans. on Industrial Electronics, vol. 59, no. 2, pp 752-761, Nov. 2012.
164

[43]

Y. Xiao, B. Wu, N. Zargari, and R. Sotudeh, "Designed of line/motor side capacitors for PWM CSR-CSI drives to achieve optimal power factor in high power fan/pump applications," in Proc. IEEE APEC, 1997, pp.333-337.

[44]

Y. Xiao, B. Wu, S. Rizzo, and R. Sotudeh, "A novel power factor control scheme for high-power GTO current-source converter," IEEE Trans. Ind. Appl., vol.34, no.6, pp.1278-1283, Nov./Dec. 1998.

[45]

N. Zargari, Y. Xiao, and B. Wu, "Near unity input displacement factor for current source PWM drives," IEEE Ind. Appl. Mag., vol. 5, no.4, pp. 19-25, Jul./Aug. 1999.

[46]

H. M. Nguyen, H. Lee, and T. Chun, "Input power factor compensation algorithms using a new direct-SVM method for matrix converter," IEEE Trans. Ind. Electron., vol.58, no.1, pp.232-243, January 2011.

[47]

J. Dai, D. Xu, and B. Wu, "A novel control scheme for current-source-converterbased PMSG wind energy conversion systems," IEEE Trans. Power Electron., vol. 24, no.4, pp. 963-972, Apr.2009.

[48]

J. Espinoza, and G. Joos, "State variable decoupling and power flow control in PWM current-source rectifier," IEEE Trans. Ind. Electron., vol. 45, no.1, pp. 78-87, Feb. 1998.

[49]

T. Noguchi, D. Takeuchi, S. Nakatomi, and A. Sato, "Novel direct-power-control strategy of current-source PWM rectifier," in Proc. IEEE-PEDS, 2005, pp. 860-865.

[50]

B. Wu, S. B. Dewan, and G. R. Slemon, "PWM-CSI inverter for induction motor drives," IEEE Trans. Ind. Appl., vol.28, no.1, pp.64-71, Jan./Feb. 1992.
165

[51]

Y. W. Li, B. Wu, D. Xu, and N. R. Zargari, "Space vector sequence investigation and synchronization methods for active front-end rectifiers in high-power currentsource drives," IEEE Trans. Ind. Electron., vol. 55, no.3, pp. 1022-1034, March. 2008.

[52]

J. R. Espinoza, G. Joos, J. I. Guzman, L. A. Moran, and R. P. Burgos, "Selective harmonic elimination and current/voltage control in current/voltage-Source topologies: A unified approach," IEEE Trans. Ind. Electron., vol. 48, no.1, pp. 7192, Feb. 2001.

[53]

B. Wu, J. Pontt, J. Rodriguez, S. Bernet, and S. Kouro, "Current-source converter and cycloconverter topologies for industrial medium-voltage drives," IEEE Trans. Ind. Electron., vol. 55, no.7, pp. 2786-2797, July. 2008.

[54]

P. C. Krause, Analysis of electric machinary and drive system, John Wiley & Sons, Inc, 2002.

[55]

T. Matsuo, and A. Lipo, "Rotor position detection scheme for synchronous reluctance motor based on current measurements," IEEE Trans. Ind. Appl., vol. 31, no. 4, pp.860-868, Jul./Aug. 1995.

[56]

P. Vas, "Parameter Estimation, Condition Monitoring, and Diagnosis of Electrical Machines," Oxford University Press, 1993.

[57]

J. R. Espinoza, and G. Joos, "A Current-source-inverter-fed induction motor drive system with reduced losses," ," IEEE Trans. Ind. Appl., vol. 34, no. 4, pp.796-805, Jul./Aug. 1998.

166

[58]

E. Al-nabi, B. Wu, and V. Sood, J. Dai, "High power CSI-fed IPM drive system with minimum dc-link current", in Proc. IEEE IECON, Phoenix, AZ, USA, pp. 857863, November 7-8, 2010.

[59]

P. L. Jansen, and R. D. Lorenz, "Tranducerless field orientation concepts employing Saturation-induced saliencies in induction machines," IEEE Trans. Ind. Appl., vol.32, no.6, pp.1380-1393, Nov./Dec. 1996.

[60]

M. W. Degner, and R. D. Lorenz, "Using multiple saliencies for the estimation of flux, position, and velocity in AC machines," IEEE Trans. Ind. Appl., vol. 34, no. 5, pp.1097-1104, Sept./Oct. 1998.

[61]

A. Consoli, G. Scarcella, and A. Testa, "Industry application of zero-speed sensorless control techniques for PM synchronous motors," IEEE Trans. Ind. Appl., vol.37, no.2, pp.513-521, March/April 2001.

[62]

F. Briz, and M. Degner, "Rotor position estimation: A review of high-frequency method," IEEE Ind. Electron. Magazine, vol. 5, no.2, pp. 24-36, June 2011.

[63]

J.-I. Ha, S.-J. Kang, and S.-K. Sul, "Position-controlled synchronous reluctance motor without rotational transducer," IEEE Trans. Ind. Appl., vol.35, no.6, pp.13931999, Nov./Dec. 1999.

[64]

K. J. Meessen, P. Thelin, J. Soulard, and E. A. Lomonova, "Inductance calculations of permanent-magnet synchronous machines including flux change and self- and cross-saturations," IEEE Trans. on Magnetics, vol.44, no.10, pp.2324-2331, October 2008.

167

[65]

B. Stumberger, G. Stumberger, D. Dolinar, A. Hamler, and M. Trlep, "Evaluation of saturation and cross-magnetization effects in interior permanent-magnet

synchronous motor," IEEE Trans. Ind. Appl., vol.39, no.5, pp.1264-1271, Sept./Oct. 2003. [66] S. Morimoto, M. Sanada, and Y. Takeda, "Effects and compensation of magnetic saturation in flux-weakening controlled permanent magnet synchronous motor drives," IEEE Trans. Ind. Appl., vol.30, no.6, pp.1632-1637, Nov./Dec. 1994. [67] E. Al-nabi, B.Wu, N. Zargari, and V. Sood, "Sensorless control of CSC-fed IPM machine for zero and low speed operation using Pulsating HFI method," IEEE Trans. on Industrial Electronics, vol. 60, no. 5, pp. 1711-1723, May. 2013. [68] F. Cupertino, P. Giangrande, G. Pellegrino, and L. Salvatore, "End effects in linear tubular motors and compensated position sensorless control based on pulsating voltage injection," IEEE Trans. Ind. Electron., vol. 58, no. 2, pp.494-502, Feb. 2011. [69] D. D. Reigosa, P. Garcia, F. Briz, D. Raca, and R. D. Lorenz, "Modeling and adaptive decoupling of high-frequency resistance and temperature effects in carrierbased sensorless control of PM synchronous machines," IEEE Trans. Ind. Appl., vol. 46, no. 1, pp. 139-149, Jan./Feb. 2010. [70] S. Bolognani, S. Calligaro, R. Petrella, and M. Tursini, "Sensorless control of IPM motors in the low-Speed range and at standstill by HF injection and DFT processing," IEEE Trans. Ind. Appl., vol. 47, no. 1, pp.96-104, Jan./Feb. 2011.

168

[71]

S. Yang, and R. D. Lorenz, "Surface permanent magnet synchronous machine position estimation at low speed using eddy-current-reflected asymmetric resistance," IEEE Trans. Power Electron., vol. 27, no. 5, pp. 2595-2604, May 2012.

[72]

M. E. Haque, L. Zhong, and M. F. Rahman, "A Sensorless initial rotor position estimation scheme for a direct torque controlled interior permanent magnet synchronous motor drive," IEEE Trans. Power Electron., vol. 18, no. 6, pp. 13761383, Nov. 2003.

[73]

J. X. Shen, Z. Q. Zhu, and D. Howe, "Improved Speed Estimation in Sensorless PM Brushless AC Drives," IEEE Trans. on Industrial Application, vol. 38, no. 4, pp.1072-1080, July/August 2002.

[74]

Y. W. Li, M. Pande, N. R. Zargari, and B. Wu, "DC-Link current minimization for high-power current-source motor drives," IEEE Trans. Power Electron., vol. 24, no.1, pp. 232-240, January 2009.

[75]

J. Dai, Y. Lang, B. Wu, D. Xu, N. R. Zargari, "A Multisampling SVM scheme for current source converters with superior harmonic performance," IEEE Trans. Power Electron., vol. 24, no. 11, pp. 2436-2445, November 2009.

[76]

J.-I. Ha, K. Ide, T. Sawa, and S.-K. Sul, "Sensorless rotor position estimation of an interior permanent-magnet motor from initial states," IEEE Trans. Ind. Appl., vol.39, no.3, pp.761-767, May/June 2003.

169

[77]

T. Aihara, A. Toba, T. Yanase, A. Masimo, and K. Endo, "Sensorless torque control of salient-pole synchronous motor at zero-speed operation," IEEE Trans. Power Electron., vol. 14, no.1, pp. 202-208, Jan. 1999.

[78]

H. Kim, K. K. Huh, R. D. Lorenz, and T. M. Jahns, "A Novel method for initial rotor position estimation for IPM synchronous machine drives," IEEE Trans. Ind. Appl., vol.40, no.5, pp.1369-1378, Sept./Oct. 2004.

[79]

D. Raca, M. C. Harke, and R. D. Lorenz, "Robust magnet polarity estimation for initialization of PM synchronous machines with near-zero saliency," IEEE Trans. Ind. Appl., vol.44, no.4, pp.1199-1209, Jul./Aug. 2008.

[80]

Y. Jeong, R. D. Lorenz, T. M. Jahns, and S. Sul, "Initial rotor position estimation of an interior permanent-magnet synchronous machine using carrier-frequency injection methods," IEEE Trans. Ind. Appl., vol.41, no.1, pp.38-45, Jan./Fed. 2005.

[81]

S. Ostlund, and M. Brokemper, "Sensorless rotor-position detection from zero to rated speed for an integrated PM synchronous motor drive," IEEE Trans. Ind. Appl., vol. 32, no. 5, pp.1158-1165, Sept./Oct. 1996.

170

171

List of Publications
Journal publications
[1] E. Al-nabi, B.Wu, N. Zargari, and V. Sood, "Input power factor compensation for high-power CSC fed PMSM drive using d-axis stator current control," IEEE Trans. on Industrial Electronics, vol. 59, no. 2, pp 752-761, Nov. 2012. [2] E. Al-nabi, B.Wu, N. Zargari, and V. Sood, "Sensorless Control of CSC-fed IPM machine for zero and low speed operation using Pulsating HFI method," IEEE Trans. on Industrial Electronics, vol. 60, no. 5, pp. 1711-1723, May. 2013.

Conference publications
[3] E. Al-nabi, B. Wu, and V. Sood, J. Dai, "High power CSI-fed IPM drive system with minimum dc-link current", in Proc. IEEE IECON, Phoenix, AZ, USA, pp. 857-863, November 7-8, 2010. [4] E. Al-nabi, B.Wu, N. Zargari, and V. Sood, "Power factor compensation for highpower CSC fed PMSM drive using d-axis stator current control," in Proc. IEEE International Electrical Machines and Drives Conference (IEMDC), Niagara Falls, Canada, pp. 753-758, May 15-18, 2011. [5] E. Al-nabi, B.Wu, N. Zargari, and V. Sood, "Zero and Low Speed Sensorless Control for CSC-Fed IPM Drive System," in Proc. IEEE Applied Power Electronics Conference and Exposition (APEC), Orlando, Florida, USA, pp. 615-622, February 5-9, 2012.

172


