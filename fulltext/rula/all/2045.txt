NOTE TO USERS

This reproduction is the best copy available.

UMI

Cuff Dynamics System / nalysis and Modeling
By

Xuefei Chen
B achelor o f Com puter Scicence N ortheastern University Shenyang, P .R .C hina,1996

A thesis presented to Ryerson University in partial fulfillment of the requirement for the degree of Master of Applied Science in the Program of Electrical and Computer Engineering.

Toronto, Ontario, Canada, 2003 Â©Xuefei Chen 2003

PPOrr'Z'Of

UMI Number: EC52926

INFORMATION TO USERS

The quality of this reproduction Is dependent upon the quality of the copy submitted. Broken or Indistinct print, colored or poor quality Illustrations and photographs, print bleed-through, substandard margins, and Improper alignment can adversely affect reproduction. In the unlikely event that the author did not send a complete manuscript and there are missing pages, these will be noted. Also, If unauthorized copyright material had to be removed, a note will Indicate the deletion.

UMI
UMI Microform EC52926 Copyright 2008 by ProQuest LEG. All rights reserved. This microform edition Is protected against unauthorized copying under Title 17, United States Code. ProQuest LLC 789 E. Elsenhower Parkway PC Box 1346 Ann Arbor, Ml 48106-1346

Author's Declaration
I hereby declare that I am the sole author of this thesis. I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research. Signature

I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. Signature

r

Instructions on Borrowers
Ryerson University requires the signatures of all persons using or photocopying this thesis. Please sign below, and give address and date.

Abstract
C uff D ynam ics System A nalysis and M odeling By X u efei Chen, M aster o f A pplied Scien ce E lectrical and Com puter EngineeringD epartm ent Ryerson U niversity

This thesis investigates the properties of the cuff dynamics system. The approach used has been to first build up a linear model for the cuff dynamics system. Analysis of the results shows that the linear model can only hold over a very small operating range, the conclusion is drawn that the cuff dynamics system exhibits strong nonlinearity.

An artificial neural network then is proposed to model the nonlinear cuff dynamics system. Mathematical analysis of the results shows that the model structure provides a better representation of the system dynamics. Two experiments are designed to capture the nonlinearity of the cuff dynamics system using a NNARX neural network model. The single operating point of cuff dynamics approximation and the multiple operating point cuff dynamics approximation. A second order with one zero model is chosen as the best representation.

The result of the simulations shows that it is not appropriate to use the cuff as sensor in the blood pressure measurement without considering the behaviour of the cuff. The cuff dynamics shows strongly nonlinear properties, which contribute a lot to the whole blood pressure measurement.

Acknowledgements
I would like to thank my supervisor. Prof. Diane Kennedy, who is a truly a great person, for her support, outstanding supervision, encouragement and example, giving me an opportunity to finish the graduate program in one year. Also thanks for Bonny Lau, who set up a cuff simulation environment and collected the data which is the important basis of my thesis. Thanks for y mentor. Prof. Javad Alirezaie, Prof. Sridhar Krishan and Prof. Gul Khan, help me to open the door to the electrical engineering area.

Also to my dear husband, Zheng Xu, gives me the biggest support in my life. At last, thanks my coming baby, together with me go in through this most important year of my life, and gives me such a wonderful time.

Contents
CHAPTER 1
1.1 1.2 1.3 1 .4

INTRODUCTION.................................................................. - .............1

T h e S y st e m iDENTiHCAiTON P r o b l e m ...................................................................................2 P r e v io u s W o r k .................................................................................................................................5 R e s e a r c h D e s c r i p t io n ................................................................................................................ 9 T h e s is O b j e c t iv e s ...................................................................................................................... ..1 0

1.4.1

Thesis Outline...................................................... ^............................................... 10

CHAPTER 2
2 .1

BACKGROUND....................................................................................12

D y n a m i c a l S y s t e m M o d e l i n g .............................................................................................. 12

2 .1 .1

System Classification.......................................................................................... 13 Lumped-Parameter and Distributed-Parameter Systems......................... 14 Causal and Noncausal Systems................................................................... 14 Time-Invariant and Time-Varying Systems.............................................. 14 Linear and Nonlinear Systems.................................................................... 15

2 .1 .1 .1 2 .1 .1 .2 2 .1 .1 .3 2 .1 .1 .4 2 .1 .2 2 .1 .3

Mathematical Models......................................................................................... 15 Linearization at an Operating Point.................................................................. 16

2.2

N o n l i n e a r S y s t e m I d e n t i h c a t i o n ......................................................................................... 18

2.2.1

Methods for Black-Box System Identification............................................... 20

CHAPTER 3

ARTIFICIAL NEURAL NETWORKS FOR NONLINEAR

SYSTEM IDENTIFICATION AND MODELING.................................................... .24
3.1 3.2 3.3 3.4
T h e M u l t i -L a y e r P e r c e p t r o n .............................................................................. 25 N e u r a l N e t w o r k M o d e l s f o r N o n l i n e a r S y s t e m IDENTIFICATION................. 26 I n p u t s a n d O u t p u t s o f N e u r a l N e t w o r k .......................................................... 29 B e n c h m a r k N e u r a l N e t w o r k S t r u c t u r e ........................................................................ 31

3.4.1

Effectiveness of the One Hidden Layer Neural Network Structure.............. 32 Sufficiency................................................................'...................................33 Rules for Selecting the Proper Number of Neurons................................ 34

3.4.1.1 3.4.1.2 3.5

ARTIFICIAL N e u r a l N e t w o r k T r a i n i n g ................................................................................ 36

CHAPTER 4
4.1 4.2

CUFF DYNAMICS EXPERIMENTAL SETUP AND ANALYSIS. 39
..................................................................40

B l o o d P r e s s u r e S im u l a t io n S y s t e m

D y n a m i c S y s t e m P r o p e r t y In v e s t i g a t i o n ......................................................... 42

4.2.1 4.2.2 4.2.3 4.3

Causality.............................................................................................................. 43 Time-Invariance..................................................................................................43 Nonlinearity........................................................................................................ 44

L i n e a r S y s t e m A p p r o x i m a t i o n ............................................................................. 46
vii

4.3.1

Investigation of the Output Signalat Cuff Pressure 100 mmHg..................... 46 Trial One...................................................................................................... 48 Trial T w o ..................................................................................................... 50 Trial T hree................................................................................................... 52

4.3.1.1 4.3.1.2 4.3.1.3 4.3.2

Investigations at Other Operating Points.........................................................53

CHAPTER 5

SINGLE OPERATING POINT CUFF DYNAMICS

APPROXIMATION USING A NEURAL NETWORK................................................55
5.1 5.2
M o d i h c a t i o n OF I n p u t AND O u t p u t S i g n a l ....................................................... 56 E x p e r im e n t s t o D e c i d e t h e S y s t e m O r d e r a n d R e l a t iv e D e g r e e .............. 57

5.2.1 5.2.2

Trial 1, System Order = 1.................................... `..............................................57 Trial 2, System Order = 2 ....................................................................................58 Results of the No Zero Second Order System......................................... 59 Results of One Zero Second Order system............................................... 60

5.2.2.1 5.2.2.2 5.2.3

Trial 3, System Order = 3 ....................................................................................61 Results of No Zero Third Order System .................................................. 62 Results of One Zero Third Order System................................................. 63 Results of Two Zero Third Order System ................................................ 63

5.2.3.1 5.2.3.2 5.2.3.3 5.2.4 5.3

Conclusions.......................................................................................................... 64

C r o s s -V a l id a t io n T e s t ......................................................................................... 65
viii

CHAPTER 6

MULTI-OPERATING POINTS CUFF DYNAMICS

APPROXIMATION USING A NEURAL NETWORK.................................................67
6 .1 D e t e r m in in g S y s t e m O r d e r a n d S a m p l in g R a i e D ir ec tl y
from

I n p u t /O u t p u t D a t a .................................................................................................

68

6.1.1 6.1.2
6 .2 6 .3 6 .4 6 .5

Deciding Sampling Rate......................................................................................68 Deciding System O rder.......................................................................................70

MODIHCATION OF NEURAL NETWORK STRUCTURE..........................................................7 3 N e u r a l N e t w o r k T r a in in g
and

C r o s s - V a l id a t in g T e s t i n g ............................ 7 5

M o r e C r o s s -V a l id a t io n T e s t i n g ........................................................................................7 9 C u f f D efl at in g C r o s s -V a l id a t io n T e s t in g .................................................................. 81

CHAPTER 7
7 .1 7 .2 7 .3 7 .4

DISCUSS AND CONCLUSIONS........................................................ 84

S im u l a t io n R e s u l t D i s c u s s .................................................................................................... 8 4 C o n c l u s i o n ......................................................................................................................................85 R e s e a r c h C o n t r ib u t io n ...........................;............................................ R e c o m m e n d a t io n s 86

for

F u t u r e W o r k .............................................................................. 87

LIST OF ACRONYMS.........................................................................

88

BIBLIOGRAPHY.............................................................................................................. 89

List of Figures
Figure 1.1 Figure 1.2 Figure 1.3 Figure 1.4 Figure 1.5 Figure 2.1 Figure 2.2 Figure 3.1 Figure 3.2 Figure 3.3 Figure 3.4 Figure 3.5 Figure 3.6 Figure 3.7 Waveform of cuff pressure........................................................................4 Model of occlusive arm cuff......................................................................6 Transverse section of the cuff-arm-arterysystem.................................... 7 Ursino and Cristalli `s block diagram ...................................................... 8 Proposed M odel...................................... :................................................ 9 A dynamic system .....................................................................................13 Block diagram o f system S ...................................................................... 13 4-3-3 feed-forward M L? network.......................................................... 25 NNARX model structure.........................................................................29 Benchmark neural network structure.....................................................31 The `purelin' activation function............................................................ 32 The `hyperbolic-tangent' activation function....................................... 32 Funahashi's network................................................................................ 34 Evaluation of 10 different neural network structure............................. 36

Figure 4.1 Figure 4.2 Figure 4.3 Figure 4.4 Figure 4.5 Figure 4.6 Figure 4.7 Figure 4.8 Figure 4.9 Figure 4.10 Figure 5.1 Figure 5.2 Figure 5.3 Figure 5.4 Figure 5.5 Figure 5.6 Figure 5.7

Simulator overview ................................................................................. 41 Output signals at 102/72 mmHg............................................................. 42 Scaling of output signals of 102/72........................................................44 Scaling of output signal of 102/72 to equal gain s................................45 Two periods of square wave of 102/72..................................................46 First half period of output signal of 102/72 at CP=100 mmHg...........47 Output signal VS. step response of trial o n e .........................................49 Output signal VS. step'response of trial tw o .........................................51 Output signal VS. step response of trial three.......................................52 Poles map at multiple operating points.................................................. 54 Two period of square wave of 72/102.................................................... 56 First order model Structure...................................................................... 57 Training result of first order model.........................................................58 Second order with one zero and no zero model structures...................59 Results of second order no zero m odel.................................................. 60 Results of second order one zero m odel................................................ 61 Third order v.dth two zero, one zero tliird and no zero model structures 62

Figure 5.8

Result of third order no zero model........................................................62

XI

Figure 5.9 Figure 5.10 Figure 6.1 Figure 6.2 Figure 6.3 Figure 6.4 Figure 6.5 Figure 6.6 Figure 6.7 Figure 6.8 Figure 6.9 Figure 6.10 Figure 6.11 Figure 6.12 Figure 6.13 Figure 6.14

Result of third order one zero model.....................................................63 Cross validation data set of 102/72........................................................ 66 Average mutual information for output signal...................................... 70 False nearest neighbors result for output data...................................... 72 Modified neural network structure......................................................... 73 Ideal square wave of 110/70...................................................................74 Cuff pressure of multiple lev el.............................................................. 74 Cuff signal without DC Offset................................................................75 Output signal ............................................................................. 75 |

i|
|

I

i |

.1

I j I

I

Inputs of training data s e t...................................................................... 76 Expected output of training data set......................................................77 Inputs of cross-validation data set......................................................... 77 Results of cross-validation data set.......................................................78 Results of cross-validation-of 102/72....................................................80 Inputs of cuff deflating experiments of 102/72.................................... 82 Result of cuff deflating experiments of 102/72................................... 83

List of Tables

Table 4.1 Transfer function and system poles at multiple operating points........................ 53 Table 5.1 Comparison o f different order and number or zero models................................. 64 Table 5.2 Identification error of different cuff pressure level...............................................65

Xlll

y

Chapter 1 Introduction

An important measure of cardiovascular function is the blood pressure, defined as the force or pressure of the blood against the arterial walls of the cardiovascular system.

Blood pressure fluctuates as a result of the pulse cycle. When the heart contracts, pushing blood out of the heart and into the arteries of the cardiovascular system, the blood pressure increases, reaching a maximum known as the systolic blood pressure (SBP). In contrast, when the heart relaxes in between heart beats (pulses), the pressure in the arteries decreases and the lowest pressure is referred to as the diastolic blood pressure (DBF). The mean arterial pressure (MAP) is defined as 1/3 systolic plus 2/3 diastolic. The systolic, diastolic and MAP are the measures used when discussing blood pressure.

During the past 90 years two primary methods of non-invasive blood pressure assessment, the auscultatory (Korotkoff) method and the oscillometric method, have been developed. Both the auscultatory and oscillometric techniques use an air filled cuff to actuate an external pressure change on the arm in order to occlude the blood flow in the brachial arm artery.

A

I
C hapter I : Introduction

In the Korotkoff approach, the sound of the blood flow is used to determine blood pressure. In the oscillometric approach, the cuff works not only as an actuator of change of exerted pressure on the arm, but also as a pressure sensor to get the pressure waveform.

The behaviour of cuff is not as simple as it looks and contributes complex dynamics to the blood pressure measurement. It is therefore necessary to understand the behaviour of cuff if we are indeed to use it as a sensor.

1.1 The System Identification Problem
Non-invasive blood pressure measurement principles are based on simple fundamental physics. When the cuff is inflated to a pressure greater than the maximum arterial pressure (systolic pressure), no blood flows through the artery under the cuff. When the cuff slowly deflates to a pressure equal to the systolic pressure, blood begins to flow through the artery. When the cuff no longer occludes the artery and the artery has returned to the original shape, the ininimum pressure (diastolic pressure) is observed.

The auscultatory method of blood pressure determination depends on the sound of turbulent blood flow to obtain the blood pressure signal. The physical phenomenon of turbulent flow is due to the cuff deforming the shape of the brachial artery. The human ear can hear the Korotkoff sounds produced by turbulent flow, through use of a stethoscope. As the pressure decreases from above the systolic pressure due to the deflation of the cuff, and the blood begins to flow, the Korotkoff sounds become audible. The sounds fade away as the cuff pressure decreases. The systolic pressure is the pressure at which the Korotkoff sounds first become audible. The pressure at which the sounds become extremely muffled

C hapter I I n tr o d u c tio n

and disappear occurs when the artery regains its fully rounded shape, or in other words, at the diastolic pressure.

Unfortunately, inaccurate blood pressure determination may occur due to hearing problems or noisy backgrounds, in addition to inherent limitations of the human ear. Furthermore, the I I I mercury-based devices used to record cuff pressure are being phased out of medical equipment [1]. In part due to these reasons, attention on the oscillometric method has increased. The method can be easily automated in commercial devices and does not require the presence of highly trained personal for administration and interpretation.

I
I Ã

The oscillometric method is based on the following observation, first presented by Marey in 1876: there is a pressure change induced in the cuff through interaction within the ' brachial artery as air released from a pressured cuff. The physics behind the observation is that a change in blood pressure within the artery causes a change in volume of the brachial artery due to the elasticity o f the vessel. The change in volume of the artery causes a change in volume in the cuff due to the coupling of the cuff to the arm. A sensitive pressure transducer that creates a digital signal can be used to detect the corresponding pressure change within the cuff.

I
'
i

I I

j I [

The signal in Figure 1.1 describes a blood pressure waveform obtained from the presssure , ( : J change recorded in a cuff [2]. The waveform is recorded as the cuff pressure deflates from a cuff pressure greater than the systolic pressure to a cuff pressure that is less than the diastohc pressure. In this example, the cuff pressure signal is shown starting at approximately 200 mmHg and decays somewhat exponentially to end at approximately 40 mmHg. Looking closely, one can observe small oscillations superimposed on this signal, due to the change in volume produced by the brachial pulse. A low pass filtering of this

C hapter J I n tr o d u c tio n

signal allows these pulses to be observed in greater detail, also shown in this Figure. In accordance with the oscillometric approach, automated blood pressure devices use the following steps to determine the blood pressure: systolic occurs when there is a rapid increase in the shape of the cuff pressure waveform envelope; MAP occurs at the maximum oscillation in envelope shape; diastolic occurs at the point of rapid decrease in envelope shape. In this example, systolic is about 157 mmHg and diastolic is about 83 mmHg. MAP is about 107 mmHg, which can be calculated from the following Equation, and shown in dashed line in Figure 1.1. MAP = 1/3 SBP + 2/3 DBF = 1/3*157 + 2/3 *83 = 107 mm Hg.

Korotkov S8B B is Cuff
pressors

[.

OsdliatioBS in

ceff procure

Radml puise
S see

Figure 1.1

Waveform o f cuff pressure

Under normal circumstances, the relationship is quite accurate. However, factors such as arrhythmia, rate of change of air in the cuff, arm size, cuff tightness ar ound the arm, cuff elasticity, etc. can dramatically affect the results, both in the detection of where the MAP occurs as well as determination of systolic and diastolic using the oscillometric method [3].

Chapter I ; Introduction

1.2 Previous Work
Observe that in the oscillometric method, the cuff signal is actually an indirect measure of the arterial pressure signal, because we are using the pressure in the cuff to infer the actual pressure. This observation is often overlooked, but it is important to recognize that this is quite a change from the Korotkoff approach where the actual sounds of the arterial blood flow are used to determine blood pressure.

It turns out that recent work in deriving a good mathematical model of how the cuff interacts with the arm tissue and artery in order to understand how the signal is transformed from arterial pressure to cuff pressure is quite complex, and remains an open area of research in the bioengineering community.

Some research has been done on understanding the Korotkoff method and how it relates to the modeling o f cuff pressure wave signals. For example, Cozby, et al. [4] investigated the low frequency components of Korotkoff signal and found out the relationship between change of energy and systolic. Tanishiro et al. [5] constructed a system to investigate the sounds emerging from the brachial artery in the diastole of the cuff in auscultation, which can be used to detect hypertension. Jian et al. demonstrated the significant potential of using a fuzzy logic model to estimate cardiac output from blood pressure waveforms [6].

Since 1993, some researchers have begun to consider the mathematical model of cuff dynamical behaviour. The motive of these researchers is to form a model derived using laws o f physics to govern the cuff behaviour, based on the material and construction of the cuff.

C hapter J : Introduction

For example, Gary and Vineet [7] showed the relationship between cuff pressure and occlusive air volume. They set up the following experimental environment. A rigi ' glass cylinder is used to represent the arm, which can isolate the arm mechanics from cuff mechanics. An occlusive cuff was wrapped around the cylinder and a water balloon was used to represent brachial artery. A calibrated pressure transducer was used to monitor the cuff pressure. The water-filled balloon was injected with 5 mL of water in increments of 1 mL at several initial levels of cuff pressure, and then the water was withdrawn in 1 mL until the balloon was empty. The cuff pressure was recorded at each 1 mL changed in volume.

Figure 1.2 is the model o f occlusive arm cuff of Gary and Vineet's work. The inner cylinder was used to represent the volume of the arm under the cuff V ,-. The outside cylinder represents cuff elastic stretch. The sheath encloses the exterior volume
Ve-

Veinitial External Ctiff Volume

Stiffness

,

,

tt-

Vi:Enclo se d Atm V olume

-r

,

j

a

rr

i

Figure 1.2

Model o f occlusive arm cuff

They found out the relationship between the change in arm volume and cuff pressure, given by Equation 1.1:

dP

{P + d p ) - { P - d p )

Chapter 1: Introduction

An important contribution of their work is the observation that for cuff pressures greater than 150 mmHg, the relationship between cuff pressure and volume is almost linear. However, in the range of human blood pressure, it is mostly nonlinear.

Research conducted by Ursino and Cristalli [8] expands on the work of [7], and gives a mathematical lumped parameter model of the oscillometric technique. They propose three sets of mathematical equations to represent the cuff, arm tissue and brachial artery hemodynamics respectively. These equations are linked together to gain a comprehensive model.

In their model, they propose an equation representing the cuff mechanical behaviour that is characterized by the compliances of its internal and external wall and the enclosed air. Figure 1.3 is the transverse section of the cuff-arm-artery system

bone cuff external wall

air volume (Vg)

(
brachial artery Figure 1.3

I

cuff internal wall

arm soft tissue

Transverse section o f the cuff-arm-artery system

A 16'*' order, nonlinear set o f complex equations o f their cuff, artery and arm represents the relationship between cuff pressures, amount of air in the cuff and arterial pressure.

Chapter 1 ; Introduction

A block diagram of dynamical model created to represent then work is shown in Figure 1.4. As one can see, from a system point of view, their system model has two inputs, one output. The inputs are the amount of an in cuff and artery pressure. The output is the cuff pressure. The cuff system actually includes one block of cuff and arm dynamics and another block of artery dynamics. In the cuff/arm block, the cuff and arm dynamics are integrated together, and cannot be easily separated.

d/dt;-.
Cuff Pressure
"(Â·Â«It-

Amount of air in cuff (Steady state cuff pressure)

Cuff and Arm Dynamics ;
-

Extravascular

Artery pressure

Artery Cross-sectional Area

Figure 1.4

Ursino and Cristalli `s block diagram

This model is quite interesting, because the resulting signal does approximate the actual cuff signal to some degree.

Questions arising from their work are: "Is it possible to separate arm dynamics from the cuff dynamics?" "Can we gain insight into the cuff contribution to the overall dynamics of the system?" "How are the detection of systolic, diastolic, and MAP affected by the cuff?"

C hapter I : Introduction

The answers to these questions are primarily what the work that is reported in this thesis seeks to address.

1.3 Research Description
From a control theoretic point of view, since the cuff works as a sensor in blood pressure measurement, it is not desirable that the cuff contributes a significant effect in the overall dynamics of the system. A dynamic system model shown in Figure 1.5 will be set up to isolate and investigate the cuff behaviour.

Steady State Cuff Pressure Artery Pressure

Cuff Pressure

Figure 1.5

Proposed Model

In the "Proposed model", the cuff dynamics are to be separated from the arm dynamics. The experimental environment is set up where the artery and arm are assumed to contribute negligible dynamics, which allow isolation of the dynamics of the cuff for investigation.

Clujpter 1 : Introduction

1.4 Thesis Objectives
The objectives of this thesis are: Â· To evaluate the effectiveness of using a blood pressure cuff as a sensor by performing dynamical system analysis. Â· To construct linear models of the cuff at operating points over the practical range, and show that this model holds over small operating regions. Â· To propose an artificial neural network structure that will adequately capture the system dynamics over a desirable operating range. Â· To provide mathematical analysis to support the choice* of neural network model.

1.4.1

Thesis Outline

The majority o f the work contained in this thesis focuses on the use of artificial neural networks for nonlinear system identification and modeling. The system under consideration is the blood pressure cuff.

This thesis is organized as follows:

Chapter 2 contains some basic background on dynamical system modeling, required for the development o f the research.
10

Chapter 1

Introduction

Chapter 3 discusses the neural network models used in the system identification area. The benchmark neural network structure is proposed and support of the benchmark structure as a suitable choice for cuff modeling, are presented.

In Chapter 4, the experiments to obtain the cuff dynamics are set up and used to linearize the cuff dynamic system, and simulation results are analyzed.

Chapter 5, a single operating point of the cuff dynamic system identification is done using a neural network. The benchmark nonlinear model for the cuff dynamics system is presented.

Chapter 6, multiple operating points of cuff dynamics system identification is done using a neural network. Theories of supporting the order of benchmark nonlinear model and sampling rate are given.

Chapter 7, discussion and summary of the simulation results are outlined and conclusion I are represented. Contributions made in this work and possible areas of future study are identified.

Chapter 2 Background

The scope of this work, as indicated in Chapter 1, spans areas o f system modeling, system identification, and neural networks. In order to be able to fully appreciate the development of the techniques employed in carrying out the research in this thesis, it is important that a proper introduction be given to the major areas this thesis pertains to.

This chapter therefore begins with an overview of dynamical systems. The mathematical fimdamentals o f system modeling and system identification are then discussed. The focus o f this chapter is on nonlinear system modeling, specifically black-box modeling, which is presented at the end of this chapter.

2.1 Dynamical System Modeling
A system is a device or process which transforms an input signal into an output signal. Mathematically, a system is a mapping from the input signal class to the output signal class.The following figure gives an illustration of system.

12

L

C h a p te r ! : Background

system
Input sigial class Output sigial class

Figure 2.1

A dynamic system

In general, without explicitly stiting the associated signal class, we can write

y(t) = S (u (t)),



(2.1)

with t representing continuous time. Using a block diagram notation, a system can be illustrated as shown in Figure 2.2.

s
Figure 2.2 Block diagram of system S

2.1.1

System Classification

Before we go further into mathematical model representations of systems, we will look at the following system classification, and how they are related to our identification problem.

13

C h a p te r! ; Background

2.1.1.1

Lumped-Parameter and Distributed-Parameter Systems

Systems that are modeled by ordinary differential equations are called lumped-parameter systems. Systems that are modeled by partial differential equations are referred to as

distributed-parameter systems. We will assume that a lumped-parameter system can be used to adequately model the cuff. However, the elastic nature of the cuff, dealt with in [7], lends suspicion that a distributed-parameter system model may provide more accuracy.

2.1.1.2

Causal and Noncausal Systems

A. causal system is one that is nonanticipative; that is, the output may depend on current and past inputs, but not future inputs. A system that violates the condition of causality is called a noncausal system. A system S is causal if the output y ( t ) depends only on the input

2.1.1.3

Time-Invariant and Time-Varying Systems

A time invariant system is one that does not change its behaviour depending on when in time input signals occur. That is to say, a system is invariant if for all T, y(t-T) = (S(u(t-T))
^2 2 )

When this property is not satisfied, then a system is said to be time-varying.

14

i
C hapter 2 : Background

2.1.1.4

Linear and Nonlinear Systems

A linear system is any system that obeys the properties of additivity and homogeneity, which can be combined into superposition property. A nonlinear system is any system that does not obey the property of superposition.

To demonstrate that a system S obeys the superposition property is to show that for I t constants c/ and C 2 (2.3)

S (C l U l( t )+ C2 U 2 ( t ) ) = Cj S( U] ( t) ) + C2S(U2(t))

2.1.2

Mathematical Models

Quantitative mathematical models of physical systems are used in order to provide a fundemental basis for analysis. Depending on the classification of the system, various models arise. In our application, we are interested in mathematical models for both linear and nonlinear lumped-parameter systems, so these models take the form of differential equations, either in input-output form (single n`^ order equation) or state space form ( n first-order equations).

The general model for a nonlinear continuous time system in input-output form is given by Equation 2.4.

y(f) = 5'(yC)(f),y'''-"(0,...,y("(f),!f('")(r),w('"-"(0,...,w(')(0,Â«(0),/i > m

(2.4)

By selecting state variables x in an appropriate fashion, an equivalent state-space
15

Chapter 2 : Background

representation to Equation 2.4 can be obtained.

x{t) = g(xitX uit))\ y(t) = h(x(0)

(z is MX7 vector)

(2.5)

The general model for a linear continuous time system is given by Equation 2.6.
jn
at

^n-1
at

J
at at

^m-1
at

^
at

(2 .6)

With equivalent state space representation:

x{t) = A{t)x{t) + B{t)u{t) y{t) = C{t)x{t) {x is n x l vector; A is n xn vector; B is m x l vector; C is I x n vector)

(2.7)

We now describe how a linear model may be used to approximate the nonlinear model.

2.1.3

Linearization at an Operating Point

Although we recognize that a process may be better modeled by a nonlinear representation, the analysis of nonlinear systems is generally difficult. To simplify the analysis, linear model approximation is used for the following reasons: Â· A vast body of mathematical theory exists for analysis of linear systems. Linearization around the operating points yields mathematically tractable linear models, which may be valid over a large region. 16

C hapter 2 ; Background

Â·

The output of system can be computed for any arbitrary input.

The general method of linearizing a nonlinear system can be described as follows: consider the state space representation of nonlinear system, described in Equation 2.5, selecting an operating point defined by xo, yo, Â«o and dropped T' for clarity of notation. Suppose that a small perturbation occurs, so that. I I
u =U q +A ii

x = x^+ Ã x y = yo+ ^y Then, from Equation 2.5, we have

4-(:Co+Ax) = io + A x = g(Xo+A x,Mq + Am) at Jo + Ay = A(% o + Ax)

oj

Now, consider a Taylor series expansion of Equation 2.8, retaining the linear terms:

X o + Ax = g(Xo,Mo) + -- ,
rih dh yo + Ay = /z(Xo)+dx

Ax +

Am (2.9)

Since from Equation 2.5,

Â·^0 ~ S(^O'^o) yo = H xo)

17

Chapter 2 : Background

Equation 2.9 is simplied to,

dx 9AI 9^1

^o ,"oA m

By defining.

A=

dx

3u

C- -- 0 , 9% -^

We arrive at Equation 2.7.

2,2 Nonlinear System Identification
As shown in the previous Section, we can find the counterpart linear model to represent a nonlinear system. However, in many cases systems are required to operate in regions in the state space where linear models do not give satisfactory results. To cope with this, research on developing tools for the design and analysis of nonlinear systems has increased. The process is known as the problem of nonlinear system identification.

The definition of nonlinear system identification is to build a mathematical model of a dynamic system based on measured data. The key problem is to identify a suitable model of structure for an unknown process in order to predict and gain insight into the behaviour of the process. Essentially, the idea is to adjust parameters within a selected structure until its output coincides as weU as possible with the measured output.
18

Chapter 2 : Background

The procedure to determine a model of a dynamical system from observed input-output data involves three basic ingredients: Â· Â· Â· The input-output data. A set of candidate models (the model structure). A criterion to select a particular model in the set, based on the information in the data (the identification method).

According to prior knowledge and physical insight about the system, system identification can be color-coded as follows. Â· White-Box models: This is the case when the physics governing the system behaviour is perfectly known; it is therefore possible to construct the system model entirely from prior knowledge and physical insight. Â· Grey-Box models: This is the case when some physical insight is available; the several parameters remain to be determined from observed data. Â· Black-box model: This is the case when no physical insight is available or used, but the chosen model structure belongs to families that are known to have good flexibility and have been " successful in the past".

The best way to test whether a model is good or not is by cross validation, which means taking a close look at the output of the model compared to the measured one on a validation data set.
19

Chapter 2 ; Background

2.2.1

Methods for Black-Box System Identification

For nonlinear systems, black-box models are often used even though there is some knowledge o f the physics governing system, mainly because it is difficult to give a generic treatment of gray-box modeling for general nonlinear systems. It is simply impossible to embrace all types of a prior knowledge that might exist. Another problem is that even though knowledge about the system is available, it is difficult to utilize it as it relates to a continuous-time description of the system. Transferring the knowledge to a discrete-time description is often hard and thus it is frequently lost in the discretization process. Black-box modeling is quite diverse and covers topics from mathematical approximation theory, to estimation theory and non-parametric regression.

A nonlinear black-box system identification problem can be represented by the following Equation.

y{t) = g { u '~ \y `-') + v{t)

(2.10)

u

represents the past inputs, y' ' represents the past outputs, g is the mapping function to

be identified, and v(t) accounts for the identification error. The goal is to make v(t) very small, so that g(u' \ y ` can be thought of as a good prediction o f y(t) given past data. Using

an approximation method. Equation 2.10 can be rewritten as:

y(f I

= g ( u '~ \y `-\& ) = g{Ã§{t),6)

(2.11)

g is the nonlinear function parameterized by 6. (p(t) is called regression vector and its components are referred to as regressors, which contains past observations and

Therefore, the choice o f nonlinear mapping in Equation 2.11 has been decomposed into
20

ma*,

C h a p te r! ; Background

two partial problems for dynamical systems:

1. 2.

How to choose the regression vector tp(t) from past inputs and outputs. How to choose the nonlinear mapping g((p) from the regressor space to the output space.

Normally, there are six types of regressor models for nonlinear black-box dynamical model. [9]

Â· Â·

NFIR models, which use only u(t-k) as regressors NARX models, which use u(t-k) and y(t-k} as regressors

NOE models, which use u(u-k) and %{t-- k\0) as regressors. In this case, %{t-- k\6) represents simulated output.

Â·

NARMAX models, which use u(t-k) , y(t-k) and s(}~k\ 6) as regressors.

Â·

NBJ models, which use u{t-k) , y{t-k), e(t-k\ Ã) and q,{t-k\ & ) as regressors.

Â·

NON_LINEAR STATE_SPACE models, which use past components of virtual outputs.

To decide the mapping function g((p,9), it is typical to expand the representation in parameter form.

21

Chapter 2 : Background

gk is referred as a basis function. Expansion 2.12 with different basis functions, together with all the possible choice of regressor models, plays the role of a unified framework for investigating most known nonlinear black-box model structures.

There are two classes of single-variable basis functions that can be distinguished depending on their nature: Â· Â· . Local Basis Functions are functions having their gradient with bounded support. Global Basis Functions are functions having infinitely spreading gradient.

Here are some popular model structures used for nonlinear mapping. They all have the general form o f function Expansion 2.12. Â· Wavelets: A typical example for the use of local basis functions. Details of this technique is discussed in [10] and [11]. Â· Â· B-splines: B-splines are local basis function which are piecewise polynomials [12]. Fuzzy Models: In this case, the basis Amctions are constructed from the fuzzy set membership functions [13]. Â· Â· Projection pursuit regression [14]. Partial Least Squares [15].

22

r
C h a p te r! : Background

Â·

Sigmoid Neural Networks; The combination of the model expansion (2.12), with its extension o f a ridge basis function and the sigmoid function, gives the celebrated one hidden layer feed-forward sigmoid neural network [16] and [17].

Among these identification methods, the artificial neural network is a widely used technique for the purposes of identification due to attributes such as massive parallelism, adaptability, robustness and the inherent capability to handle nonlinear systems. The two most common types of feed-forward neural networks are the multi-layer perceptron (MLP) and the radial basis functions (RBF) networks. Both types of neural networks are successfully used not only to model various biological and industrial processes but also to design controllers around them with significant benefits. The RBF is the more complicated approach, as feedback is incorporated in the process.

In this thesis only the MLP network architecture will be used to estimate nonlinear models for the cuff dynamics system, as feedback in the neural network may lead to problem of instability. This does not mean in any way that it is the best neural network architecture for nonlinear system identification. It is simply that in our application, we are constrained to using this approach.

23

Chapter 3 Artificial Neural Networks for Nonlinear System Identification and Modeling

Artificial neural networks (ANN) have provided users the opportunity to develop relatively easily black-box nonlinear models. It is well known that the multi-layer perceptron network (MLP) is good at learning nonlinear relationships from a set of data. So, it is natural to consider a MLP network as a model structure to solve a nonlinear dynamic system identification problem.

By making this choice, the model structure selection is basically reduced to dealing with the following two issues: Â· Â· Selecting the inputs to the network. Selecting internal network architecture.

In this Chapter, the basic structure of the MLP neural network is first introduced. Then, pairs o f nonlinear mapping neural network models are brought in. The highlight of this Chapter is the selection of a benchmark neural network structure used for identification of
24

C hapter 3: A rtificial Neural Networks f o r Nonlinear System IdentifiÃ©Ã¼tion an d M odeling
'

the cuff dynamic system. The proofs of the appropriateness of selecting such a neural network structure are given in detail.

3.1 The Multi-Layer Perceptron
The rmlti-layer perceptron (or MLP) network is widely used because its ability to model simple as well as very complex functional relationships. A fully connected one hidden layer, one output layer feed-forward MLP network with 4 inputs, 3 hidden units and 3 outputs units is illustrated in Figure 3.1.[18]

UU,

Figure 3.1

4-3-3 feed-forward MLP network

The output of neural network can be expressed as follows:

^ q

Cm
V '=1

\

y,(w,W ) = F;. /=i Vr

= F:
k V=l

(3.1)

Normally, a sigmoid activation function is used in the hidden layer ( d en o ted /) and linear
25

Chapter 3: A rtificial Neural Networks f o r Nonlinear System Identification and Modeling

activation function ( denoted F ) is used in the output layer.

The weights (specified the matrices w and W, or alternatively by the vector

are the

adjustable parameters o f the network, and they are determined from a set of examples through the process called training. The examples, or the training data as they are usually called, are a set of inputs, u(t), and corresponding desired outputs, y(t). The objective of training is then to determine a mapping from the set of training data to the set of possible weights so that the network will produce predictions y (t), which in some sense are "close" to the true outputs y(tj[18],

3.2 Neural Network Models for Nonlinear System Identification
The general framework for representing non-hnear mappings represented by a neural network is given by:

=

+

.

(3.2)

or in predictor form
*

i
4

=

(3 j)

where tp(t) is the regression vector, defined in Section 2.2.1, containing past sampled inputs u(t-k) k= 0,l,2,... , past sampled outputs y(t-k) k=0,l,2,..., or a signal derived from the
26

CAapfer J ;

A'a.ni/ /V enw rb/br ATon/wear ^ jfe m Mgn(Ã¿!&hom am// Mo(/gfwg

inputs and outputs. ^ is a vector containing the weights and g is the function realized by the
neural network. Depending on the choice of regression vector, four regessor models can be used in neural network nonlinear system identification [19].

M A R X model: Uses past sampled inputs
regressors yielding the regression vector:

and past sampled outputs

as

<D(f,6') = [ y ( r - l )

...

y (f-n )

+

( 3 .4 )

and predictor:

y { t \ d ) = % t \ t ~ \ , 6 ) = g[(p{t,6),e]

(3.5)
with n the system order, n-m the related degree, and d the delay measured in sampling intervals.

NNOE model: Uses past sampled inputs
regressors yielding the regression vector:

and past predicted outputs yCf-kl^) as

^ (A m = [ y ( f - l |m and predictor:

...

y ( f - /z |^ )

+

(3.7)
With n, m and d as defined above.
27

Chapter 3: A rtificial Neural Networks f o r N onlinear System Identification and M odeling

NNARMA model: Uses past sampled inputs u(Nk) and past sampled outputs y(t-k) and
prediction error e(t-k\9) as regressors yielding the regression vector:

Ã§{t,Ã´^ --\y{t --1) ... ^(^" 1) Â·Â·Â·

yif ~ ~n)

u{t --(P)

u{t --d --m + V)

-- 1) ...

-- /)] (3 8)

Where

^

I

and predictor: y ( t\0 ) = g[Ã(t,6),0] (3 g)

With n, m, d as defined above and I is the delay tap of feedback.

NNSSIF model (state space innovation form): Uses past components of virtual outputs
as regressors to yield the regression vector:

^ (0 =

16^)

(3.10)

and predictor:
% + l | ^ ) = g[(P(f),6'] y ( f |^ ) = (l + c ,^ + ... + c*^")% |6')

Ã w ithx an n x l state vector, and cg , k=0,l,2... are parameters of the backward shift operator.

Only the NNARX model has a predictor without feedback. The remaining model types all
28

Chapter 3: A rtificial Neural Networks f o r Nonlinear System Identification and Modeling

have feedback through the choice o f regressors, w hich in the neural netw ork term inology m eans that the networks becom e recurrent: future network inputs w ill depend on present and past network outputs. This might lead to instability in certain regions o f the netw ork's operating range, and it can be very difficult to determine whether or not the predictor is stable. An N N A R M A structure can be constructed to avoid this by using a linear m oving average filter for filtering past residuals. The basic rule o f thumb is, how ever, to use a N N A R X type m odel w henever possible.

In this work, N N A R X m odel structure is selected referring to (3.4) and (3.5), with d as one delay measured in sam pling intervals. Figure 3 .2 illustrates the inputs and outputs structure o f N N A R X model.

m
u(i-I)
Network

w
Figure 3.2 N N A R X model structure

3.3 Inputs and Outputs of Neural Network
T h e choice o f input-output data from the plant can be obtained from m easurem ent o f a practical system . The system is presumed to have dynam ics w hich can be m athem atically
29

Chapter 3: A rtificial Neural Networks fo r Nonlinear System Identification and Modeling

represented as follows.

By making some modifications of Equation 2.4, which is the general form of a nonlinear, continuous time, time-invariant, causal system, let the inputs to the system be represented by u, the outputs represented by y, t-k; k = 0,1,2,... represent time instances at which input/output data is sampled, and g represent the function realized by the neural network. A sampled version of Equation 2.4 can now.be written as;

y(t) = g[yit -

- 2 ),...,y (t - n),u(t

- m)]

(3.12)

The observed state y(t) of a system is assumed to be a function of prior outputs y(t-k); k=l,2,... n, and prior inputs u(t-k); k=l,2,...,m, of a system model. Here, n is the delay tap of the output of the system model, and represents the system order, essentially a measure of how much 'memory' the system possesses because it describes the length of time that a past output still has effect on the present output. m<n is the delay tap of the inputs, with n-m representing the `relative degree' of the system, essentially a measure of how long it takes before the effect of an input will be seen at the output; n and m are dictated by the underlying physical laws governing the system behaviour.

According to previous Section, the main task of using a neural network to identify a dynamic system is to find the best n and m representing the system model to provide the mapping from input to output. Since little knowledge of the physics governing the system is known, an experimental method is initially used in the system identification process. A verification of the final selection of n and m is given in Chapter 5.

30

Chapter 3: A rtificial Neural Networks f o r Nonlinear System Identification and M odeling

3.4 Benchmark Neural Network Structure
Once the neural network model is decided, the neural network structure, like how many hidden layers should be contained in the network and how many neurons are required for each layer, must be determined.

In this work, the structure of the MLP neural network is chosen as shown in Figure 3.3. There are two layers in the neural network: the hidden layer has 5 neurons and uses the tansig' activation function; the output layer uses the `purelin' activation function. The proof of appropriateness of choosing a single hidden layer is given in Section 3.4.1.1. The reason for choosing 5 neurons in the hidden layer is provided in Section 3.4.1.2.

n+m

r

IW(t If

--

\

. % fW :::

^

/

Figure 3.3

Benchmark neural network structure

The neural network is to capture the dynamic behaviour of the unknown system in NNARX form (3.4) and (3.5). The one dimension output represents the observed state of the system y. n+m+1 is the dimension of inputs to the neural network, which means the input is a single vector of n+m+1 elements. As mentioned before, y is assumed to be a fonction of prior outputs y(t-k); k= l,2,... n, and prior inputs u(t-k); k= l,2,...,m .

The activation function of output layer is `purelin', which represents a direct feed through of input to output, as illustrated in Figure 3.4.
31

Chapter 3: A rtificial Neural N etworks fo r Nonlinear System Identification and Modeling

Figure 3.4

The `purelin' activation function

The

activation function of the hidden layer is

`tansig', which represents

a

hyperbolic-tangent function. This function takes the input and squashed it the range -1 to 1, according to the expression:

e" --e " e"+ g - "

(3.13)

Figure 3.5 gives an illustration of the hyperbolic-tangent activation fonction.

a

0
-Ã

a=Â£ansig{n)
Figure 3.5 TTre `hyperbolic-tangent' activation function

3.4.1

Effectiveness of the One Hidden Layer Neural Net^vork Structure

In this Section, we show that a one hidden layer neural network is sufficient for modeling
32

Chapter 3: A rtificial Neural Networks f o r N onlinear System Identijfdation and Modeling

the dynamics of a system o f form 2.4. We also offer guidance as to select of an appropriate number of neurons to choose for the hidden layer.

3.4.1.1

Sufficiency

Funahashi showed that an infinitely large neural network with a single hidden layer is capable of approximating any continuous fonction to any degree of accuracy. Namely, he proved the following theorem. [20]

Theorem 1. [21 ]

Let (p (x) be a nonconstant, bounded and monotone increasing be a compact set andf: K ~^R be a real-valued continuous

continuous function. Let K

function on K. Then fo r arbitrpry e>0, there exists an integer N and real constants w ,-, such that

7 {x, '=' satirfies

%

) (3.14)

/ - 7 _ =sup|/w -/w

< Â£

(3.15)

An illustration of Funahashi's network is showed in Figure 3.6.

In other words, any continuous mapping can be approximated by a input-output mapping of a one hidden layers network whose output functions for the hidden layer are <P(x) selected as described above, and linear for the output layer. In our benchmark system, 4>(x) is
33

Chapter 3: A rtificial Neural N etworks fo r Nonlinear System Identification and Modeling

chosen as the "tansig" activation function.

0 = 2

(o, )

Oi - O ( 2

)

O. = 0 ( 2

Figure 3.6

Funahashi's network

In practice, however, the question of how to select an appropriate value for N, i.e. the number of neurons in the hidden layer, remains.

3.4.1.2

Rules for Selecting the Proper Number of Neurons

A common measure o f the neural network model quality is by using the average generalization error [19]. There are two contributions of the modeling error; the bias error and the variance error. The bias error is the portion of the error that is due to an insufficient model structure. It is defined as the error of the function obtained by averaging over all data sets. The variance error is the portion of the error that is due to the fact that the function implemented by the network obtained on a specific data set deviates from the average
34

1

C hapter 3: A rtificial Neural Networks fo r Nonlinear System Identification and M odeling

function.

In practice, there will always be a certain bias error even in the limit of large training data sets. One way to decrease bias error is to add more weights to the networks. But one must also expect the variance error to work in the opposite direction: as more weights are estimated on the same data set, the variance on the estimated weights wdl increase.

To get the best number o f neurons to balance the bias/variance dilemma, the following experiments are made: based on the benchmark neural network structure (Figure 3.3), ten different models are trained to get the result of bias and variance error, which denoted by training error and testing error in our experiment. All these models have the same structurÃ© of inputs and outputs, using a first order system model. (Discussion of the first order system model will be provided in Chapter 5.) The simplest model structure has one hidden neuron, and then the model structure is gradually increased by one hidden neuron at a time. The networks are trained under the same training set and evaluated by another data set (Discussion of training data sets will be provided in Chapter 5.). Each network is trained five times with 100 epochs and the same training goal, 0.000001, which is small enough to ensure that the training will never meet its goal, and the minimum training error can always get to 1(K) epochs. The result of the experiments is shown in Figure 3.7.-

35

Chapter 3: A rtificial Neural Networks fo r Nonlinear System Identification and Modeling

K10 2.4
2.2

-4

+ O

tr a in in g error t e s t erro r

(> O O O O O O O O

I 1.8 " O
c

2 2 O )
O S

cn 1.6 I , .
1.2

1

*
4-

# 5 B
Hidden units

$
10

0.8

1

Figure 3.7

Evaluation of 10 different neural network structure

The general picture is as expected: the training error initially decreases, but at some point it starts increasing again. This phenomenon is due to overfitting which means the networks not only model the features of the system but also model the undesired content like noise in the training set. From Figure 3.7, the optimal trade-off between bias and variance error for our data is achieved for a network containing five hidden neurons.

3.5 Artificial Neural Network Training
The neural network training process for identification can be roughly divided into two
36

ChaÃ®ner 3: A rtificial Neural Networks fo r Nanlinear System Identification and Modeling

categories: on-line training and off-line training. On-line training is performed simultaneously or differs by just one simulation step. On-line training normally needs connection o f the plant to the neural network training. Off-line training is accomplished ahead of the identification process from data obtained from the plant. Since the data is obtained separately in advance of the system identification process, off-line training is used in this work.

The learning algorithm used to adjust the synaptic weights of a multi-layer perceptron is known as back-propagation. It consists of three passes: forward execution,

back-propagation of errors and weight update. The main principle of the method is that it finds the derivatives of an error function with respect to the weights in the network. Let tdj denotes the desired output, yj denotes the neuron output, k indicates the k-tli example. The error at the output of neuron / is given as:

= y'j (^) - c/y (^')

(3.16)

The instantaneous sum of the squared output errors is given by:

! where / is the number of neurons of the output layer.

(3T7)

Using gradient based optimization algorithms can then minimize the error function. Three gradient based optimization algorithms will be discussed.

The gradient descent method is the method easiest to be implemented. The principle of the
37

vm-

CfiapÃ®er 3: Artificial Neural Networks f o r Nonlinear System Identification and M odeling

gradient method is to at each iteration modify the weights along the opposite direction of the gradient. The convergence of the method depends on the step size. A line search generally gives the most rapid convergence in terms of iterations, but it will required a large amount of network evaluations per iteration. In practice, the gradient method is quite slow. In most applications it is therefore difficult to justify using the gradient method. However, it also provides the advantages of simplicity when it is implemented and the modest requirement to data storage.

The Gauss-Newton method requires first order derivative information only, and that makes it less expensive to compute. The Guass-Newton method is faster when executed far from the ininimum.

The Levenberg-Marquardt method is a trust region method designed specifically for nonlinear least squares. Its step size is adjusted automatically along with the trust region radius. The convergence properties of the Levenberg- Marquardt method are similar to that of the Guass-Newton method. In addition, the method has an attractive side effect in the improved numerical conditioning obtained by adding a positive diagonal matrix to the Hessian. Compared to the previously discussed methods, the Levenberg-Marquardt method appears to be the most obvious choice for neural network training: a fast and robust convergence is obtained. In this research a MLP network with Levenberg-Marquardt training method will be used.

38

me

Chapter 4 Cuff Dynamics Experimental Setup and Analysis

This Chapter introduces the model used to simulate the cuff dynamic system. This simulator reproduces the periodic blood pressure waves caused by the action and reaction of the heart in a simplified manner by controlling the flow of water through a tubing circuitry [22]. The pressure signals are acquired at the output of the cuff system to form the data sets used to set up the cuff dynamic system model.

Preliminary investigation of the cuff dynamic system is performed following the description of the experimental setup. The proofs of causality and time-invariant system properties are given respectively.

The last part of this Chapter investigates the ability o f a linear model to approximate the system. The detailed procedure of finding the linear model for a particular operating point is given.

39

Chapter 4 Cuff Dynamics ExpÃ©rimentai Setup and Analysis

4.1 Blood Pressure Simulation System
The overall experimental design involves a vertical water column that provides a fixed, static pressure and a circuitry of tubing to model the human circulatory system [22]. An electric valve controlled by a timer circuit is used to regulate the flow of water through the system, creating simplified pressure pulses representing those found in the artery. A blood pressure cuff is wrapped around an artificial arm and inflated to a specific pressure before data acquisition is initiated. A manual valve is located downstream, just before water flows through the entire circuit and returned to a reservoir. A submerged pump returns water into the column at a controlled rate. Pressures are measured at two points - fluid pressure just before the artificial arm with an artery pressure sensor, and air pressure inside the cuff with a cuff pressure sensor. Figure 4.1 shows the schematic diagram of the system.

The electrical valve generates input signals. It is periodically turned on/off to create the pressure pulse which are basically ideal square waveforms with fixed amplitude of lOmmHg, frequency o f 0.2Hz, and duty cycle o f 50%, with sampling rate of 1000 samples/second. The output signal is collected at the cuff pressure sensor. The cuff is initially inflated to a pressure well beyond the maximum (systolic) level, and its response to the simulated input is acquired and logged. Air is then released from the cuff until the pressure drops by lOmmHg, and the output data is again collected. This process is repeated in cuff pressure decrements of lOmmHg to a level well below the minimum (diastolic) pressure. The simulated waveform's offset is then augmented by lOramHg (with the amplitude maintained at a constant lOmmHg), and the above procedure is repeated. For this specific experiment, the input waveforms range from a diastolic of 40mmHg to 140mmHg (systolic of 50mmHg to ISOmmHg). For each input, the output response are acquired for cuff pressures ranging from 60mmHg to IbOmmHg
40

C h apter 4 Cuff Dynamics Experimental Setup and Analysis

^

(Overflow Prevention)

A nery P re s su re S ensor

Cuff P re s s u re S ensor

Manual Valve

p .-- .

\
Blood Pressure Artificial Artery
'

Artificial Arm

Hand
Pump

(4

---

1 ' ^- - - - - - - - - E -- -- --Beserwir/

ygfratalta, j
Figure 4.1 Simulator overview [22]

41

Chapter 4 Cuff Dynamics Experimental Setup and Analysis

4.2 Dynamic System Property Investigation

Before setting up the dynamic model of the cuff, it is necessary to make some hypothesis on the system. In this Section, an evaluation of causality, time-invariant property and nonlinearity are performed.

Figure 4.2 shows the output signals of systolic at 102 mmHg and diastolic at 72 mmHg.

Outputs (102/72)

130
-

120

120
110

100

----- 60

100 V

0.5

2.5 X 10
,4

F i g u r e 4 .2

O u tp u t s ig n a ls a t 1 0 2 /7 2 m m H g

42

C h a p ter 4 Cuff Dynamics Experim ental Setup an d A n alysis

r,-

One can see that at different operating points, which are different cuff pressure levels, the output signals show very different behaviour. When the cuff pressure is very high and very low, the output signal shows small gain. When the cuff pressure is close to the MAP, which is 92 mmHg, the output signal has the largest gain.

In order to take a close look at the cuff dynamic system, we apply control system theory. The following analyses are based on the output signal in response to an artery pressure of 102/72 mmHg, shown in the Figure 4.2.

4.2.1

Causality

In the cuff pressure simulation model, one can find that the output signal can only be obtained after the input signal, wfiich is the ideal square wave generated by the electrical valve is applied. This means that the output depends only on current and past inputs, but not future inputs. According to the definition o f causal system in Section 2.1.1.2, the cuff pressure simulator exhibits causality.

4.2.2

Time-Invariance

In the real world, when actual blood pressure is measured, the measured cuff pressure is not only affected by the cuff dynamics but also by factors such as chemical processes that stiffen the brachial artery in response to occlusion by the cuff. In this sense, the system may be viewed as exhibiting time-variant property.

In our experimental environment, there are no such effects. The parameters of the system,
43

Chapter 4 Cuff Dynamics ExpÃ©rimentÃ¢t Setup and Analysis

such as composition of the artificial artery, do not change with time. We consider that the experimental system is time-invariant.

4.2.3

Nonlinearity

To investigate the linearity of the system, two types of scaling are applied to the output signals. The data scaled are the output signals of systolic at 102 mmHg and diastolic at 72 mmHg. Each output signal corresponds to one constant cuff pressure. As shown in Figure 4.2, the pink curve is the output signal when the cuff pressure is fixed at 110 mmHg, while the black curve is the output signal when cuff pressure is fixed at 60 mmHg.

O u tp u t S ig n a l a t 1 0 2 /7 2 W lh o u t o ffse t

4
120

3 2

110

100 70

0
1

2
-3 Â·4
0

1000
F ig u re 4 ,3

3000

40CG

9000

6000

S c a lin g o f o u tp u t signals o f 1 0 2 /7 2

44

Chapter 4 Cuff Dynamics Experimental Setup and Analysis

Figure 4,3 shows the same output signals, eliminating the DC offset at each cu ff pressure level.

The definition of DC offset here is the constant cuff pressure level for each output signal, and can be considered as steady state operating point. Jn effect, we are left with looking at the system response, at various operating points, to the same input signal. By definition o f linearity (refer to Section 2.1.1.4) we should see the same output Figure 4.3 shows that at each operating point, different gain and transient behaviours are obtained.

To illustrate the differences in transient behaviour more closely. Figure 4.4 shows the output signals scaled to equal gains.

1.5

Scaled Output Based on Cuft Pr@ssure=120

----- 120
1

100 90

0.5

0

-0.5

1.5

0

1000
F ig u re 4 .4

3000

5000

6000

S c a lin g o f o u tp u t sig n a l o f 1 0 2 /7 2 to e q u a l g a in s

45

C hapter 4 Cuff D ynam ics Experim ental Setup a n d Analysis

4.3 Linear System Approximation
From the previous,Section, one can observe that the behaviour of the cuff demonstrates nonlinear property at different operating points. It is reasonable to see whether the nonlinearities are weak enough that a linear model may suitably approximate the dynamics over the whole operating range. In this Section, a second order (no zero) linear system will be applied to model the cuff dynamics.

4.3.1

Investigation of the Output Signal at Cuff Pressure 100 mmHg

In the experiment, the input signal is an ideal 0.2 Hz square`wave, with duty cycle at 50% and sampling rate at 1000 samples/sec. Figure 4.5 illustrates the input signal at 102/72.

2000

4000

6000

8000

10000

12m0

14000

Figure 4.5

Two periods of square wave of 102/72
t

At the second half period of the input signal, one can look the signal as a step signal. By comparing the output o f the cuff pressure system and the output of a standard step input signal, a transfer function of a linear model wÃ¼l be obtained.

46

f'
C hapter 4 Cuff D ynam ics Experimental Setup and Analysis

The first step to constructing a linear system is to normalize the output signal to unity amplitude. Figure 4.6 is the plot of output signal.

0.9

0.8
0.7

I
Ã

0.6
0.5 0.4 0.3

0.2

1.5

2.5

Time (s e c )

Figure 4.6

First half period of output signal of 102/72 at CP=1G0 mmHg

Consider the transfer function of a second order, unity-gain system given by Equation 4.1.

r (^ )

K s + ps 4- K

(4.1)

By generalizing the formula into damping ratio and natural frequency format. Equation 4.1 can be written as.

T(.y)

a>: + 2Co),,s + ty;

(4.2)

Investigating Figure 4.6, this system is overdamped. Performance measures of the system
47

I,

f."

Chapter 4 Cuff D ynamics Experimental Setup an d Analysis

are defined by 10%-90% rising time Tri and the settling time Ts with 2% error. With 2% error of Ts, the second order system can be described with closed-Ioop damping constant , which is given by Equation 4.3.

With 10%-90% rising time Tru the linear approximation of T,i is given by Equation 4.4.

2.16^ + 0.60 C Ã»,,

(4.4)

The rise time o f the linear system model is calculated from the output data samples so that with the range of 10% to 90%, rise time is 1.435 seconds. In order to find the best settling time, three trials are made and the results are given in following Sections.

4.3.1.1

Trial One

From Figure 4.6, a measurement of settling time of 2.6 second is obtained. With rise time of 1.435 seconds, and with 2% error of settling time using Equation 4.3 and Equation 4.4, we obtain

^ 0 - 6 0 .1 .4 3 5 Â®"

(4.5)

By solving Equation 4.5, the parameters Ã and
48

are

I

#1
C hapter 4 Cuff Dynamics Experimental Setup and Analysis

\C D ^ =1.3563

I C = 0.8816
and the system transfer function can be given by: T{s) = 1.84 +2.3915 + 1.84)

(4.6)

(4.7)

The step response is shown in Figure 4.7.

s te p R esponse -- Output singal step response

I

0.8

Q.

^

0.6

04

0.2

OS

2,5
Time (s e c )

3$

4,5

F ig u r e 4 .7

O u tp u t s ig n a l V S . s te p re s p o n s e o f tr ia l o n e

49

Chapter 4 Cuff Dynamics Experimental Setup and Analysis

As one can see, the step response of the linear system using Equation 4.7 gives a large error compared to the actual output signal, the estimated model is much slower than actual signal.

Major contribution of the error is the settling time. It appears that the system response to the on/off action o f the valve at frequency 0.2Hz is a bit too fast to allow the signal to properly settle down to its final value after each step. Since the location o f the 2% settling time is very sensitive to the final value, this will generate a large error in the estimated linear model.

4.3.1.2

Trial Two

In order to obtain a more compatible model, another trial is attempted. The formula used for calculating rise time is modified as in Equation 4.8, which uses 5% settling time, giving less sensitivity of final value to get a better estimate.

^ .= 3 ^ = ^

.

(4.8)

The new equation set to calculate the parameters of the system becomes:

T,,

=

to yield

50

C hapter 4 Cuff D ynamics Experimental Setup and Analysis

\Ã»)^ =0.8626 I ^ = 0.7476

(4.10)

The system transfer function is given by: T(^) = 0.7441 1.295 + 0.7441)
(4.11)

(5^

The system response to the step input signal is shown in Figure 4.8.

One can observe that with 5% settling time, the linear model still does not give a good estimate of output signal --it is still too slow. By trial-and-error method, a better model is found in trial three.
, step Response
Output singal step response

X J
a.

0.0

0.6

0.4

0.2

0

1

2

3

4

S

6

7

8

9

Time ( s e c ) F ig u r e 4 .8 O u tp u t s ig n a l V S . s te p re s p o n s e o f tr ia l tw o

51

Chapter 4 Cuff D ynamics Experimental Setup a n d Analysis

4.3.1.3

Trial Three

By selecting 2% settling time at 1.48 sec., the following Equations are obtained; _ 2.16^ + 0.60 1.435

(4.12) = 1.48
yielding parameters = 3.2656 I ^ = 1.2083

(4.13)

So, Equation 4.14 gives the linear system transfer function. T{s) = -- -------- ---------(^^+ 7.89B + 10.66) The system response to the step input signal is given in Figure 4.9.
-- -- Output singal sfap rasp on se

(4.14)

0.9

0.6
07

0.6 0,6

I

0.4 03

0.1

25
Figure 4.9 Output signal VS. step response of trial three
52

35

C h apter 4 C u ff Dynamics Experimental Setup and Analysis

From Figure 4.9, one can tell that the step response of the second order linear model gives a reasonable estimate of the output signal. Due to unmodelled dynamics, including high order terms and nonlinearity, the two curves wiU never fit perfectly together.

4.3.2

Investigations at Other Operating Points

The previous Section gives the details of the procedure to finding a decent linear model at a particular operating point. Following the same procedure, the transfer fimctions at other different operating points, over a practical operating range, can be calculated. Table 4.1 gives results for cuff pressures of 120 mmHg, 100 mmHg, 80 mmHg and 60 mmHg, along with the computed pole locations.

Â«m a
120 mmHg 0.9 Second (5^+13.075 + 29.03) 100 mmHg 1.48 Second (5^+7.8915 + 10.66) i \0 J o (5^+22.535 + 100.1) 80 mmHg 0.45 Second

-10.2258; -2.8392 -6.1603; -1.7311 -16.4428; -6.0908 -2.7002+5.2121; (5^ +5.45 + 34.46) -2.7002-5.212i

60 mmHg

39.13 Second

T C )-

Table 4.1 Transfer function and system poles at multiple operating points

Figure 4.10 is the plot of the system poles given in Table 4.1. As one can see these poles move quite dramatically when the operating point of the cuff system changes, indicating
53

Chapter 4 CuffDynamics Experimental Setup and Analysis

that the linear model holds only over a "small" operating range. For the whole operating range, a suitable single second order linear system model cannot be found.

In the next Chapter, we look at incorporating higher order dynamics and nonlinearity.

P ole-Z ero Map "T= I ^ I \ Â» V- *

0 .0 %

/ 0 .60 .

0.49

- ' ' 0:^5

% /
-n.975

\

.'X

..

-0.094,..
___

"x4

14 _______ 12
_______________

4

p.'
-

'I - 1 ----X-"i-X;rrr|^^i-

-0.994'

-ttS7S

X potes of cp=80 X poles of cpÂ«100 X poles of cp =120

0.935..'

-B -18

0.%.'
L

\0 .8 X

\ 0.66
-B

-IB

. . I

-14

-12

-10

-B
R eal A xis

j
-4

0.48

X 'Â· '- 0.25 :____L'
-2

Figure 4.10

Poles map at multiple operating points

54

I
'Ã©

Chapter 5 Single Operating Point Cuff Dynamics Approximation Using a Neural Network

This Chapter presents simulation results using the neural network identification model at distinct operating points.

The purpose is to look not only at incorporating nonlinearity into the model, but also to look at the effect of modifying the model order. The proposed neural network is the NNARX model given by:

y (0 = ^ [ y ( f - i )

Â·Â·Â· y { t- n )

The trial and error method is initially used to decide the delay tap of input and output signals. The simulation is performed on the training set and further cross-validation on another data set not included in the original training set. Results are also presented comparing the speed of convergence and amount of identification error.

55

"Ã©

C h a p ters: Single Operating Point Cuff D ynam ics Approximation Using a Neural Network

5.1 Modification of Input and Output Signal
This part of the experiments are performed at single operating points, again selecting the nominal cuff pressure level at 100 mmHg. The input signal is the ideal square wave with amplitude between 72 mmHg diastolic and 102 mmHg systolic, created with frequency of 0.2Hz, duty cycle of 50%, and sampling rate of 1000 samples/second; two periods are shown in Figure 5.1.

2

0

20CD

40D0

BOOD

BOOO

IQDCD

12000

14000

Figure 5.1

Two period of square wave of 72/102

The output signal is the cuff signal collected at the cuff sensor. It is also sampled at rate of 1000 samples/second and modified to remove the DC offset of 100 mmHg. The reason for eliminating the DC offset is to capture the cuff dynamics without the contribution of constant cuff pressure level. In this manner, cross validation can be performed on the output signal at different cuff pressure levels (i.e. different operating points). The input and output signals are divided into two parts; the first part is used to train the neural network and second part is used to perform the cross- validation.

As discussion in Section 3.2, the NNARX model used for this work has the structure shown in Figure 3.2. The input of neural network consists previous output signals and previous input signals, both input and output signal will start from one delay tap of the current time point. The ending delay tap number of output signals n, deciding the order of the system
56

I

Chapter 5: Single Operating Point Cuff Dynamics Approxinuition Using a Neural Network

will be determined by the experiment. The ending delay tap of the input signal m, deciding on the relative degree, wUl be determined by the same method.

5.2 Experiments to Decide the System Order and Relative Degree
A variety of system order and relative degree are used in an attempt to find a good model fit. All the models are training 5 times with 500 epochs and the goal is setting as 0.0001. The training curves show the average convergence epochs.

5.2.1

Trial 1, System Order = 1

The first trial represents first order system, whose model structure is depicted in Fig 5.2.

u(t-l)

Network

Figure 5.2

First order model Structure

The inputs to the neural network are given hy y(t-J) and ii(t-l), represents a first order with no zero dynamic system.

57

Chapter 5: %ig/e Operating Point Caff Dynamics Approximation Using a Neural Network

Figure 5.3 shows the result of the first order system model. The left of Figure 5.3 is the training curve, convergence demonstrated at 110 epochs. The right of Figure 5.3 is the result of the cross validation on the test data set. As we can see that the output of neural network is very close to expected output signal. All the identification error is normally distributed in a small range o f -0.03 and 0.03.

P e rto rrra n c c is 9 9344?e-OG5. G oal is 0 CC05

1 0
10 ,

1 2 Q C 0

1403D

2CC0

40CO

10003

120CO

MODO

1 0
iC GO 1 12 E p o c h s 80

" 0 05 ,

6030

10000

12000

0-04

0 03

-0 02

.0 01

0

001

0.02

0 03

0 04

0 06

L e a rn in g C urve

Training Results

Figure 5.3

Training result of first order model

To further the comparison, the mean square error of five trials is also calculated. The MSE of first order model is 1.4065, with relative error computed to be on the order of 4.7%.

5.2.2

Trial 2, System Order = 2

The second trial uses a second order system structure. There are two possible models to represent the system; one zero second order system, and no zero second order system, whose structures are depicted in Figure 5.4.
58

C hapter 5: Single O perating Point Ciiff Dynamics Approxim ation Using a Neural Network

y{i-0 y{t-2) y(^) u(t-I)

y(i-0 y{^-2) u(t-2)
yO) ^

u(t-2)
W -

Figure 5.4

Second order with one zero and no zero model structures

The Figure on the left represents one zero second order system. The inputs to the neural network are given by y (t-l ) , y(t-2) and u(t-l), u(t-2). The Figure on the right represents no zero second order system. The inputs to the neural network are given hy y ( t- l) , y(t-2) and u(t-2).

5.2.2.1

Results of the No Zero Second Order System

Figure 5.5 shows the result of the second order system no zero model. The left of Figure 5.5 is the training curve, convergence demonstrated occurs around 40 epochs. The right of Figure 5.5 is the result o f the cross validation on the test data set. We can see that the output of neural network is very close to the expected output signal. All the identification error is normally distributed in a small range of -0.03 and 0.03.

59

ChaÃ®ner 5: Single Operating Point Cuff Dynamics Approximation Using a Neural Network

Performance is B72CS26-0Q5. Goa! is 0 CJQ 01

a

10

rio,
10

2000

4000

: T O O

B300

10000

12000

14000

-10

2000

4000

BOOG

8000

loe Ã¦

12000

14000

-

0 2000 4000 4000 I----------------- .-------' 2000

Â· 0.1

60oe

8000

10DOO

12000

14000

33 Epochs -0.04 -0 02 0 0.02 0 04 0 06

L e a rn in g C urve

T r a in i n g R e s u l t s

Figure 5.5

Results o f second order no zero model

To further the comparison, the mean square error of five trials is also calculated. The MSE of second order no zero model is 1.7225, with relative error computed on the order of 5.7%.

S.2.2.2

Results of One Zero Second Order system

Figure 5.6 shows the result of the second order system one zero model. The left of Figure 5.6 is the training curve, convergence demonstrated occurs around 35 epochs. The right of Figure 5.6 is the result of the cross validation on the test data set. We can see that the output of the neural network is very close to the expected output signal. All the identification error is normally distributed in a small range o f-0.03 and 0.03.

60

Chapter 5: Single Operating Point C iijf Dyttatnics Approximation Using a Neural Network

Performance is 5.563886-035, Goal is O.OCOl

2300

40CQ

SOX)

OOOO

IQCTX)

12000

14000

U

/ljUU

41LU

bUUU

dUUU

lUUJU

T/UUU

14UUJ

2 0.1

0

2D00

40CO

6000

8000

JOCGÃ

12000

14000

IQ

15 Z3 36 epochs O'-- 0 .0 4
- 0.02

Learning Curve

0

0.02

0.04

0.06

Training Result

Figure 5.6

Results of second order one zero model

The MSE of second order one zero model is L. 6730, with relative error computed on the order of 5.6%.

5.2.3

Trial 3, System Order = 3

The third trial uses a third order system structure. There are three possible models to represent the system: one zero, two zeros and no zero third order system whose structures are depicted in Figure 5.7.

The Figure on the left represents two zeros third order system. The inputs to the neural network are given hyy(t-I), y(t-2), y(t-3) and u(t-I), ii(t-2), u(t-3). The Figure in the middle represents the one zero third order system. The inputs to the neural network are given by y(t-l) , y(t-2), y(t-3) and u(t-2), u(t-3). The Figure on the right represents the no zeros third order system. The inputs to the neural network are given h y y (t-l) , y(t-2), y(t~3) and u(t-3).
61

Chapter 5: Single Operating Point Cuff Dynamics Approximation Using a Neural Network

y(t-I)

-ibTeural Â»
u(t-l)

y(t)

Neural
Network

u(t-2)

uft-W

'A ' yr

Network; u(t-3)

Figure 5.7

Third order with two zero, one zero third and no zero model structures

5.2.3.1

Results of No Zero Third Order System

Figure 5.8 shows the result of the third order system no zero model. The left of Figure 5.8 is the training curve, convergence demonstrated occurs around 30 epochs. The right of Figure 5.8 is the result of the cross validation on the test data set. All the identification error is normally distributed in a small range of -0.05 and 0.03.
a B 56?-i-kO :Â» Ã¹in i t D CCÃI

P e rM m rc f

D

4X0

KCQ

60:0

ICOX

I20X

\10X

D

3:03

4X3

BXO

BOX

1CQX

1:0%

140X

10

2 c

15

K

004

.003

.o m

OCl

G

0 3'

O'X

0C3

T r a in ln E R e s u lt

Figure 5.8

Result of third order no zero model

The MSE of 5 trials is 1.6833, with relative error computed on the order of 5.6%.
62

Chapter 5: Single O perating Point Cuff Dynamics Approxintation Using a Neural Network

S.2.3.2

Results of One Zero Third Order System

Figure 5.9 shows the result of the third order system no zero model. The left of Figure 5.9 is the training curve, convergence demonstrated occurs around 100 epochs. The right of Figure 5.9 is the result of the cross validation on the test data set. All the identification error is normally distributed in a small range o f -0.02 and 0.04.

Performance is 9.95023e-0Q5, Goal is 0.0001

0

2000

40Â»

Booe

BOCO

10003

12000

14000

0

2000

4000

BOoe

8000

10003

12000

14000

-

' Q 5000

20)0

4000

6000

BOOO

10003

12000

14000

0.04

-0 02

0

0.02

0 04

0 06

DCe

aÃ¼pTrÂ«ining|

98 Epochs

t r a i n in g R e su lt

Figure 5.9

Result o f third order one zero model

The MSE of 5 trials is 1.9790, with relative error computed on the order of 6.6%.

5.2.3.3

Results of Two Zero Third Order System

The third order with two zeros model normally cannot converge under the same condition as all other models.
63

Chapter 5: Single Operating Point Cuff D ynamics Approxim ation Using a Neural Network

5.2.4

Conclusions

Using the trial and error method, the result of the simulation shows that the NNARX model provides a good dynamic mapping from the ideal square wave to cuff signal. Table 5.1 contains comparison of different orders of the system with different numbers of zeros with respect to the speed of convergence of the training and MSE and relative error of the expected output and NN output.

System Model List

Epochs of Convergence 110 35 33 50 25

Identification Error 1.4065 L7225 1.6750 L6833 L9790 Can't converge

Relative Error 4 J% 5 J% 5^% 5.6% 6.6%

First Order system Second Order System Third Order System

No zero No zero One zero No zero One zero Two zeros

Table 5.1 Comparison of different order and number or zero models

According to the result of comparison, the second order system with one zero is the most efficient model for mapping the input and output signal.

64

Chapter 5: Single O perating Point C ujf D ynam ics Approxim ation Using a Neural Network

5.3 Cross-Validation Test
This part Df the experiment is the cross validation test for the second order one zero model. The neural network structure and parameters obtained from the training result of the cuff pressure at 100 mmHg, which is selected as the nominal point for all the experiments. The testing data set is the ideal square wave and cuff signal at cuff pressure at 120 mmHg, 110 mmHg, 90 mmHg, 80 mmHg, 70 mmHg and 60 mmHg. For each set o f data, after deleting their DC offset, they are fed into the existing neural network and then the result is plotted and the identification error is calculated.

Table 5.2 shows the identification error for each level of cuff pressure.

Cuff Pressure 120 110 100 90 80 70 60

Identification E irq r , riÃ¿ 2.77E+0a` 1.73E+02 3.00E+00 2.34E+00 6.19E+00 3.01E+00 9.05E+02

Table 5.2 Identification error of different cuff pressure level

The table shows that at most cuff pressure levels, the second order one zero model can provide a good mapping from the ideal square wave at the system output signal. The worst
65

Chapter S: Single Operating Point CuffDynamics Approximation Using a Neural Network

results occur at cuflf pressure 110 inrnHg aud cuff pressure 60 mmHg.

By investigating the cuff signal in the cross-validation test, illustrated in Figure 5.10, one can find that cuff signal at cuff pressure 110 mmHg (pink curve) and 60 mmHg (black curve) show the most degradation from the zero center. The neural network model is trained on a data set of cuff pressure at 100 mmHg, which is most consistently zero centered. This is the reason that crosses validation gives bigger identification errors at 110 and 60 mmHg.

Output SignsI tt 102/72 without offSBi

10

120

100

a

e --1

2

0

-2

A

OS Ssmplo

2.5

X1 0

Figure 5. i 0

Cross validation data s e t o f 102/72

66

Chapter 6 Multi-Operating Points Cuff Dynamics Approximation Using a Neural Network

In the previous Chapter, the neural network model is based on a nominal operating point of 100 mmHg. But in the real world, the actual cuff pressure signal is obtained under a deflating cuff pressure. In order to investigate the cuff behaviour at changing cuff pressures, results of experiments on multiple operating points are introduced in this Chapter. Results are also presented in different cross validation data sets.

This Chapter also presents a method to extract the sampling rate and proper order from a set of input and output data without any insight into the dynamic system. The false nearest neighbors algorithm is presented to decide the system order and mutual information of the data set is used to select the sampling rate.

67

Chapter 6: M ulli-Operaling Points Cuff Dynamics Approximat ion Using a Neural Network

6.1 Determining System Order and Sampling Rate Directly from Input/Output Data
It is very common that there is no insight available for nonlinear black-box identification problems. Many researchers have devoted themselves on finding methods to extract useful information only from input and output data. The FNN (false nearest neighbors) algorithm and Lipschitz numbers are most commonly used for deciding the model order. Embedding delay, which is the concept of sampling rate for the discrete time system, is most commonly estimated by evaluating the autocorrelation function or the mutual information of the input and output sequence. These methods are based on input-output data only, their application does not depend on any restrictions to the input signal and most importantly they are applicable to both linear and nonlinear systems. In t' nis work, the FNN and mutual information method is applied to back up our decision of system order and sampling rate.

6.1.1

Deciding Sampling Rate

The mutual information function, I(t), can be used to determine the optimal value of the time delay for the state space reconstruction. It is first proposed in an article by Fraser and Harry [25]. The idea is that a good choice for the time delay T is one that, given the state of the system x(0, provides maximum new information with measurement at x{t+T). Mutual information is the answer to the question, "Given a measurement ofx(t), how many bits on average can be predicted about x(t+T)T[26] . Normally a graph of I(t) starts off very high, and as T is increased, I(t) decreases, then usually rises again. It is suggested that the value of time delay where l(t) reaches its first minimum should be used for the state space
68

Chapter 6: M ulti-O perating Points Cuff Dynamics Approxim ation Using a Neural Network

reconstruction.

The Equation used for calculating the mutual information is given in 6.1 [26]. xj represents one random state measurement of output data point and X2 represents another random state measurement of output data point.

/ (X, ,

) = j" f

(X, , X; ) 10g[f

(X, , X; ) / f (X,

(X;(fX;

(6.1)

In this work, the calculation of delay tap and system order is performed by a time series analysis software entitled VRA (Visual Recurrence Analysis) developed by Eugene Kononov [27].

VRA can perform pattern and deterministic recognition in the time series using a recurrence plot, and it gives a graphical representation of the correlation integral in such a way so that the temporal dependence in the system under study is preserved. It also can perform the Average Mutual Information, False Nearest Neighbors, and spatio-temporal entropy methods to determine the optimal values of embedding dimension and time delay for delayed coordinate embedding. Figure 6.1 shows the average mutual information for our output data.

69

Chapter 6: M ulti-Operating Points Cuff D ynamics Approximation Using a Neural Network

0 5.4 5.2-

0 2 4 G 8 10 13 16 19 22 25 28 31 34 37 40 43 46 49 52 55 58 61 64 67 70 73 76 79 82 85 88 91 94 97 T im e Lag (units)

Figure 6.1

Avi age mutual information for output signal

The result o f the analysis is that the first AMI (Average Mutual Information) minimum is found at time lag 30. By investigating the Figure, the time lag 30 gives an AMI value of 4.7 bits. So 5 bits on the average is enough to predict next data point. Converting into the sampling rate, 2^ = 32, 32 samples/ second is fast enough not to lose any information of the cuff signal.

This experiment gives a very important proof that the sampling rate used in the single operating point cuff dynamics approximation, which is 1000 samples/second, is more than fast enough to prevent any loss of information of the signal. Furthermore, in the multiple operating point cuff dynamics approximation in this Chapter, which will be discussed in the following Section, a sampling rate of 100 samples/second is quite reasonable too.

6.1.2

Deciding System Order

The false nearest neighbors (FNN) algorithm was originally developed for determining the
70

I

'

C hapter 6: M ulti-Operating Points Cuff Dynamics Approximation U sing a Neural Network

smallest dimension regression vector needed to recreate the dynamics of autonomous chaotic systems [28]. Rhodes and Morari [29] have proposed the following algorithm for determining the proper model order for input/output dynamic systems.

1.

Identify the closest point to a given point in the time delay coordinates. That is, for a given time delay point n.m{k) = [y{k-x),...,y{k-h), u{k-T),...^ u{k-mry\ find the point r/,,,,(/) in the data set such that the following distance d is minimized.

d = \\n.mik)-n,jj)\\^

(4.2)

2.

Determine if the foUowmg expression is true or false.

<

(4.3)

Where R is some previously chosen threshold value. If expression 4.2 is true, then the neighbors are true neighbors. If the expression is false, then the neighbors are false neighbors. 3. Continue the algorithm for all points k in the data set calculate the percentage of points in the data set, which have false nearest neighbors. 4. Continue the algorithm for increasing I and m until the percentage of false nearest neighbors drops to zero.

Chapter 6: M ulti-Operating Points Cuff D ynam ics Approxim ation Using a Neural Network

The FNN algorithm can be summarized as the following fact. If the dimension of the time delay space is too small to represent the dynamics of the system, points which are close in the time delay space may be far apart in the prediction space. However if tnc dimension of the time delay space is large enough, then points which are close in the time delay space win always remain relatively close in the prediction space.

Figure 6.2 shows the FNN result using VRA software, VRA giving a best embedding dimension of 3, which is the order of output signal in neural network modeling. But as one can see from the Figure that order 2 also gives a decent percentage of false neighbors. Referring to the discussion in Section 3.4.1.1, a certain number of weights are able to model the true system to certain accuracy. The difference between second order and third order model determines the different number of weights in the neural network. But as the trade-off between fast convergence and complexity of the neural network structure, the second order model can give a good approximation of cuff dynamics.

V

E m bedding Dimension

F ig u r e 6 .2

F a ls e n e a r e s t n e ig h b o r s re s u lt fo r o u tp u t d a ta

72

C hapter 6: M ulli-Operating Points Cuff D ynamics Approximation Using a Neural Network

6.2 Modification of Neural Network Structure
Even though in the previous Chapter, the neural network model is based on one cuff pressure, experiments show that the neural network is good at capturing the cuff behaviour at different operating conditions. The experiments in Chapter 5 show that the second order one zero NNARX model is the best model for the cuff behaviour identification from experimental of view, and the analysis in Section 6.1 confirm it from theoretical point of view. In order to investigate the multiple operating points cuff behaviour, the neural network is modified as follows.

The significant change is the input to the neural network. In the previous experiments, the neural network is a single input and single output model. In this Section, multiple inputs are used. Figure 6.3 shows the modified neural network structure.

Figure 6.3

Modified neural network structure

u denotes the ideal square wave at some level of systolic and diastolic that is the same as before, it is created with frequency of 0.2Hz, duty cycle of 50%, and sampling rate 100 samples/second. The positive value of the square wave represents the systolic cuff pressure, and the negative value o f the square wave represents the diastolic cuff pressure. Figure 6.4 is an example of ideal square wa\ e at systolic at 110 mmHg and diastolic at 70 mmHg.
73

Chapter 6: M ulti-Operating Points Cuff D ynamics Approximation Using a Neural Network

%100

2000 Figure 6.4

4000

BO O O

B O O O

10000

Ideal square wave of 110/70

u ' denotes another input of neural network, which is the cuff pressure at different level. Taking the signal in Figure 6.5 as an example, cuff pressure stays constant at each level, which contains two periods of the ideal square wave. The signal in Figure 6.5 decreases from 150 mmHg to 60 mmHg, 10 mmHg each level, u '(t-l) and u '(t-2) represent the one delay tap and two delay taps of cuff pressure, respectively.

2000 Figure 6.5

4000

G O O D

8000

10000

Cuif pressure of multiple level

The last part of the input to the neural network is y, which denotes the cuff signal without DC offset. Figure 6.6 showing the response to the input signal at cuff pressure shown in Figure 6.5. Figure 6.5 is the DC offset for each level of cuff signal, and Figure 6.6 is the pait without DC offset, y(t-l) and y(t-2) represents the one delay tap and two delay taps of modified cuff signal, respectively.

74

Chapter 6: M ulti-Operating Points Cuff D ynamics Approxim ation Using a Neural Network

o

2000
Figure 6.6

4000

B O O O

8000

10000

Cuff signal without DC Offset

Figure 6.7 is the output signal at 110/70 including the DC off set, i.e., it combines each two periods of cuff signal at cuff pressure at 150 mmHg, 140 mmHg, 130 mmHg, 120 mmHg, 110 mmHg, 100 mmHg, 90 mmHg, 80 mmHg, 70 mmHg and 60 mmHg.
200
2 150

O )
tn
CL

5 100

2000

4000 Figure 6.7

B O O O Output signal

8000

10000

6,3 Neural Network Training and CrossValidating Testing
The trainings of the neural networks are performed at the cuff signal at 110/70 mmHg. The whole data set covers the range of cuff signal at 150 mmHg to cuff signal at 60 mmHg. The training data set takes one part, which is cuff pressure at 150 mmHg, 130 mmHg, 110
75

Chapter 6: M ulti-Operating Points Cuff Dynamics Approximation Using a Neural Network

mmHg, 90 mmHg, 70 mmHg. Figure 6.8 illustrated all the inputs to the neural network.

5000
10

o 5
cn

0

1000

2000

3000

4000

5000

1000 Figure 6.8

2000

3000

4000

5000

Inputs of training data set

The neural network is trained using supervised Levenberg-Marquardt algorithm. Figure 6.9 is the output signal used for supervised training. The epochs are set to 500 and training goal is set to 0.01.

76

Chapter 6: M ulti-Operating Points C ujf Dynamics Approxim ation Using a Neural Network

_ 200 c n
5 150

^3 O

100
1000 Figure 6.9

2000

3000

4000

5000

Expected output of training data set

Cross-validation test is performed on another part of data set, which is cuff pressure at 140 mmHg, 120 mmHg, 100 mmHg, 80 mmHg, 60 mmHg. Figure 6.10 illustrated all the inputs to the neural network.

5000

" G 20 Ã« 0 1 10 1 ? 3 = 0 3 0 U
150
CD

1000

2000

3000

4000

5000

o

g

100
50

Q
'0 1000 Figure 6.10 2000 3000 4000 5000

Inputs of cross-validation data set

77

Chapter 6: M ulii-Operating Points C ujf D ynam ics Approxim ation Using a Neural Network

The results o f cross-validation testing are illustrated in Figure 6.11. The simulation is performed on the inputs of Figure 6.10 based on the neural network structure obtained from the training set.

5000

5000

5000

0 Figure 6.11

5

10

15

20

Results of cross-validation data set

As shown in Figure 6.11, the first subplot is the real cuff signal, the second subplot is the neural network output. These two signals look pretty close to each other. By investigating the identification error and the histogram of identification error, one can find that most of the error is close to zero, except for some `big jumps' happening when the cuff pressure suddenly undergoes step changes. Because the output signal is combining different levels of cuff pressure, the neural network needs some time to adapt to the changes when the level
78

Chapter 6: M ulti-Operating Points Cuff Dynamics Approxim ation Using a Neural Network

of cuff pressure decreases, and this is the reason the `big jump' happens.

Overall, the neural network gives a decent output signal compared to the expected cuff signal, which shows that this neural network can capture the cuff dynamic behaviour at quite different operating points.

6.4 More Cross-Validation Testing
To further support the analysis of the efficiency of the neural network model of the cuff dynamic behaviour, more cross-validation tests are performed.

It is reasonable to investigate the neural network performance at different systolic and diastolic levels since in reality, most people have difference systolic and diastolic. Another testing data set is created at 102/72 mmHg, at cuff pressure at 120 mmHg, 110 mmHg, 100 mmHg, 90 mmHg, 80 mmHg, 70 mmHg and 60mmHg. Figure 6.12 illustrates the results of cross-validation.

As one can see, the neural network model gives a good estimation of the cuff signal even at different systolic and diastolic points. The error shows normal distribution with zero mean except at the `big jumps'.

79

Chapter 6: M ulti-Operating Points Cuff D ynamics Approximation Using a Neural Network

1000

2000

3000

4000

5000

B O O O

7000

0

1000

2000

3000

4000

5000

B O O O

7000

2 0 E 0) c o cu u 1*-- c cu "O

10

0

-1 0

1000

2000

3000

4000

5000

B O O O

7000

10000
E

O ) 5000 O "K
X

CD

F ig u r e 6 .1 2

R e s u lts o f c ro s s - v a lid a tio n o f 1 0 2 /7 2

80

C hapter 6: M ulti-Operating Points Cuff Dynamics Approximation Using a Neural Network

6.5 Cuff Deflating Cross-V alidation Testing
In reality, the measurement of blood pressure is obtained when the cuff is inflated to a pressure greater than systolic pressure, and then slowly deflated to a pressure less than diastolic pressure. In our experiment environment, the cuff signal is obtained from constant levels of cuff pressure. A similar experiment to measuring real blood pressure is formed based on the modification of input to the neural network.

Figure 6.13 illustrates the inputs to the neural network. This experiment uses the cuff signal simulation at 102/72 mmHg. The ideal square wave (in the first subplot) at 102/72 mmHg represents the pulse. One can notice that, in the second subplot, the cuff linearly changes with time, which is different from the experiments performed before, but represents more closely to the cuff action. The last part of the inputs to the neural network is the output signal without DC offset that is constructed from the existing data set of cuff signals at 102/72.

81

Chapter 6: M ulti-Operating Points Cuff D ynam ics Approxim at ion Using a Neural Network

to

80

1000 120

2000

3000

4000

5000

BO O O

7000

| i " .
" S

O

00

1000 10

2000

3000

4000

5000

BO O O

7000

5
0

o

Â·5

0

1000

2000

3000

4000

5000

B O O O

7000

Figure 6.13

Inputs of cuff deflating experiments of 102/72

Figure 6.14 gives the results of the cuff deflating experiments. The dash line represents the output of neural network, which estimated the cuff signal. The solid line is the scaled estimated cuff signal, from which DC offset is eliminated and scaled to 10 time its original value. One can observe the similarity between Figure 6.14 and Figure 1.1, which shows a real blood pressure waveform measured in a cuff. In Figure 6.14, one can see the trend forming a real cuff signal; the amplitude of oscillation starts from a small value, reaches the maximum value, and then decreases to a small value again.

82

C hapter 6: M ulti-O perating Points Cuff Dynamics Approximation Using a Neural Network

140 130
-- -S c a le d Cuff P re ssu re Cuff P r e ssu r e

120
110 100

I?.

1000
Figure 6.14

2000

3000

4000

5000

6000

7000

Result of cuff deflating experiments of 102/72

According to the oscillometrlc method, the MAP should be able to be computed as: 1/3 * systolic + 2/3 * diastolic = 1/3 * 102 + 2/3 * 72 = 82 mmHg Our maximum occurs at approximately 95 mmHg, an error of approximately 16%.

This experiment shows that the cuff itself does contribute a lot to the whole blood pressure measurement system, not only its nonlinearity, but also the same curve shape of cuff signal.

83

Chapter 7 Discussion and Conclusions

7.1 Simulation Results Discussion
The properties of the cuff dynamics system are investigated in detail in this work. The approach used has been to first build up a linear model for the cuff dynamics system. Analysis of the results shows that the linear model can only hold over a very small operating range. For the whole practical operating range of cuff dynamics system, one signal linear model can not be obtain to represent the system due to the strong nonlinearity contribution of the cuff dynamics.

An artificial neural network then is proposed to model the nonlinear cuff dynamics system. Experiments analysis of the results shows that the model structure provides a better representation of the system dynamics. Two experiments are designed to capture the nonlinearity of the cuff dynamics system using a NNARX neural network model.

The first is based on the single operating point of cuff dynamics approximation. The experiment is built up and performed on one particular cuff pressure level. The simulation results show that the second order with one zero model is the best representation of cuff
84

C hapter 7; D iscussion and Conclusions

dynamics system.

The second experiment is performed on the multiple operating point cuff dynamics approximation. New input and output data sets are r onstructed to represent the cuff dynamics over a large range of cuff pressures. The same second order with one zero model is used as in the previous simulations. The cross-validation testing result shows the proposed model can also capture the cuff dynamics over a multiple operating point constructed by the different cuff pressure level. Furthermore, the proposed model can even capture the cuff dynamics over a linearly changing cuff pressure range, which is completely new data set and more close to real cuff action.

The simulation results show that neural network is a reasonable tool to model the nonlinear cuff dynamics system with httle need for physical insight into the system.

7.2 Conclusion
The conclusion of this thesis work supports the author's suspicion; in inflatable cuff may not be the most suitable choice to work as a sensor. By investigating the properties of the cuff dynamics system within an experimental environment set up to provide isolation of cuff dynamics from artery and arm dynamics, strong nonlinearity has been shown in the cuff dynamics system. Recall that in the oscillometric method, the cuff is not only the actuator of change of pressure on the arm, but is also the sensor used to get the pressure waveform. A large error in the resulting waveform is contributed by the strong nonlinearity of the cuff dynamics system.

85

Chapter 7: Discussion arc! Conclusions

By the analysis of the results of linear model approximations, it is found that one single liner model can not obtain to model the cuff dynamics system over a practical operating range. A second order one zero NNARX model is found to be the best representation of the cuff dynamics system, ass it can not only approximate the cuff dynamic system in a single operating range, but also a multiple operating range. The suitability of the selected model is demonstrated using the mutual information method for the sampling rate and the false nearest neighbor method for the system order.

7.3 Research Contribution
The main contribution of this work is in the area of biomedical engineering. It has been demonstrated that cuff dynamics, when examined in isolation from blood pressure dynamics, contribute a good deal to the overall system model. A method of modelling the dynamics, in particular through the use of neural networks, has been achieved. The

advantage of using a neural network is to solve the problem lies in the fact that a system mapping at a certain accuracy level can be obtained without exact knowledge of the system dynamics.

To the author's best knowledge, this is the first approach to analysis the cuff dynamic system from control system point of view and set up a model for a separated cuff dynamics system using neural networks. This approach is also quite different from previous research, which has been to create the cuff model in combination the arm and artery dynamics or create a model for cuff dynamics from physical law point of view.

86

C hapter 7: Discussion and Conclusions

7.4 Recommendations for Future Work
The work of this thesis demonstrates the nonlinearity of the cuff dynamics system, which is not desirable for the cuff working as a sensor. There are three recommendations for the further research.

1.

Investigate the correlation of the cuff dynamics with the location of the MAP point as described in the oscillometric method.

2. Create another sensor separate from the cuff to capture the pressure dynamics, and leave the cuff to its original purpose - to exert external pressure on the arm.

3. If it is really necessary to use cuff as a sensor, cuff dynamics must be considered in the blood pressure measurement system. The best way to eliminate the contribution of cuff dynamics is to create an inverse dynamics model of cuff, connect it to the blood pressure measurement system. In this way, a more accurate blood measurement system can be obtained without contribution of nonlinear cuff behaviour.

87

List o f Acronyms

List of Acronyms

MAP SBP DBP NFIR NARX NOE N ARM AX NBJ MLP NNAlRX NNOE NNARMA NNSSIF. FNN AMI

Mean Avrtery Pressure Systolic Blood Pressure Diastolic Blood Pressure Nonlinear Finite Impulse Response Nonlinear AutoRegressive with exogenous input Nonlinear Output Error Nonlinear AutoRegressive Moving Average with eXogenous input Nonlinear Box-Jenkins Multi-layer Perceptron Neural Network Finite Impulse Response Neural Network Output Error . Neural Network AutoRegressive Moving Average Neural Network State Space Innovation Form False Nearest Neighbor Average Mutual Information

Bibliography

Bibliography

1. Burke M.J.,

"An electronic manometer for blood-pressure measurement", lEE

Colloquium on Innovative Pressure, Force and Flow Measurements, Page: 1/1 -1/5, October 1999.

2. http://www.colin-europe.com/pages/oscillometrv.html.

3. Amoore J.N., Geake W.B., Scott D.H.T., "The effects of pulse rate, artefact and pulse strength on oscillometric non-invasive blood pressure measurements". Proceedings of the 18th Annual International Conference of the IEEE on Engineering in Medicine and Biology Society(1996) , VOL.: 5, Page: 1977-1978, November 1996.

4. Cozby R.C., Adhami R.R., " Low-frequency Korotkoff signal analysis and application", IEEE Transactions on Biomedical Engineering, VOL.: 40, Issue: 10, Page: 1067-1070, October 1993.

5. Tanishiro.

H., Funakubo.A., Kawamura T., Fukui Y., "Analysis of sound

characteristics originating from the brachial artery in auscultation", Proceedings of the First Joint o f BMES/EMBS Conference(1999), VOL.: 2 , Page: 892, October 1999.

89

Bibliography

go

6.

Jian Ling, Guerra J.M., Robey B.L., Winter D.C., "Continuous cardiac output determination from blood pressure waveforms using a fuzzy logic model", Proceedings o f the First Joint of BMES/EMBS Conference (1999), VOL.: 2 , Page: 931, October 1999.

7.

Gary Drzewiechi, Vineet Bansal, "Mechanics of the Occlusive Arm Cuff and Its Application as ,a Volume Sensor", IEEE Transactions on Biomedical Engineering, VOL.: 40, No. 7, July 1993.

8.

Mauro Ursino, Cristina Critalli, "A Mathematical Study of Some Bimechanical Factors Affecting the Oscillometric Blood Pressure Measurement", IEEE Transactions on Biomedical Engineering, VOL: 43, No. 8, August 1996.

9.

Jonas Sjoberg, Qinghua Zhang, "Nonlinear Black-box modeling in system identification a unified overview", Automatica, VOL.: 31, NO. 12, Page: 1691-1724, June ,1995.

10. Sureshbabu N., Farrell J. A, "Wavelet based system identification for nonlinear control applications". Proceedings o f the 1995 IEEE International Symposium on Intelligent Control (1995), Page: 236-241, August 1995.

11. Schoenwald D.A.; "System identification using a wavelet-based approach". Proceedings o f the Second IEEE Conference on Decision and Control (1993), V0L.:4, Page: 3064-3065, December 1993.

90

Bibliography

`

p;

12. Ramos J.A., Durand J.-F., "Identification of nonlinear systems using a B-spIines parametric subspace approach". Proceedings of American Control Conference (1999), VOL.; 6, Page: 3955-3959, June 1999.

13. Jyh-Shing, Roger Jang, "Neuro-fuzzy modeling for dynamic system identification". Proceedings of Soft Computing in Intelligent Systems and Information Processing (The 1996 Asian), Page: 320-325, December 1996.

14. Ying Z.; Atkeson, C.G., "Implementing projection pursuit learning", IEEE Transactions on Neural Networks, VOL.: 7, Issue: 2, Page: 362-373, March 1996.

15. Qin, S.J., "Partial least squares regression for recursive system identification". Proceedings of the 32nd IEEE Conference on Decision and Control (1993), VOL: 3, Page: 2617-2622, December 1993.

16. Songling W.; Xiongjun Y,; Qiang W.; Jun-hu H.; Hai-yan H., "New common mathematical models of fanners performance based on the partial least squares regression method", IEEE Region 10 Conference on Computers, Communications, Control and Power Engineering. VOL.: 3, Page: 1834-1837, October 2002.

17. Ge S.S., Hang C.C., Zhang, T., "Neural-based adaptive control design for general nonlinear systems and its application to process control". Proceedings of American Control Conference (1998), VOL.: 1, Page: 73-77, June 1998.

18. Magnus Nprgaard, "Neural Network Based System Identification Toolbox Manual", Department of Automation, Technical University of Denmark, January 2000.
91

Bibliography

92

19. Magnus N0rgaard, Ole Ravn Niels K. Poulsen , Lars K. Hansen, "Neural Networks for Modelling and Control of Dynamic Systems", Springer-Verlag, London, 2000.

20. Robert FullÃ©r, "Neural Fuzzy Systems lecture", http://www.abo.fi/~rfuller/nfsl2.pdf. Department of Operations Research Eotvos Lorand University.

21. FUNiMiASHI K., "On the approximate realization of continuous mappings by neural networks". Neural Networks (1989), VOL.: 2, Page: 183-192, 1989.

22. Bonny Lau, University of Waterloo, Co-operative Work Team Report, 2003.

23. K. Hornik,

"Approximation capabilities of multilayer feed-forward networks",

Neural Networks (1991), VOL.:4, Page:251-257, 1991.

24. K. Hornik, M. Stinchcombe, H. White., "Multilayer feed-forward networks are universal approximators.". Neural Networks (1989), VOL.: 2, Page: 359-366, 1989.

25. Andrew M. Fraser, Harry L, "Independent coordinates for strange attractors from mutual information". Physics Review (1986), VOL:33, Page: 1134-1140, 1986.

26. Al-Ani A., Deriche M., "An optimal feature selection technique using the concept of mutual information". Symposium on Signal Processing and its Applications, Sixth International (2001), VOL: 2, Page: 477-480, August 2001.

27. Eugene Kononov, http://home.netcom.com/~eugenek/download.html.
92

Bibliography

'

95

28. M. B. Kennel, R. Brown, H.D.I. Abarbanel, "Determining embedding dimension for phase-space reconstruction using a geometrical construction". Physical Review A, VOL.: 45, Page: 3403-3411, March 1992.

29. Carl Rhodes, Manfred Morari, "Determining the Model Order of Nonlinear Input/Output Systems Directly From Data", Proceeding of the American Control Conference, Seattle, Ishington, Page: 2190-2194, June 1995.

30. Autin M., Bley M., Hasler M., " Order of discrete time nonlinear systems determined from input-output signals", IEEE International Symposium on IS CAS '92. Proceedings of Circuits and Systems (1992), VOL: 1, Page: 296-299, May 1992 .

31. Vincen Verdult, Michel Verheagen, Jacquelien Scherpen, "Identification of nonlinear Nonautonomous State Space from Input-Output Measurements",

UT/TN/SCE-1999.007, September 1999.

32. Sun EC., Sun Z.Q., Zhang R.J., Chen Y.B., " Neural adaptive tracking controller for robot manipulators with unknown dynamics", lEE Proceeding of Control Theory and Applications,, VOL.: 147, Issue: 3 , Page: 366-370, May 2000.

33. Martin T.Hagan, "Neural Networks for Control", School of electrical & computer engineering, Okahoma State University.

34. Moraes J.C.T.B., Ceruili, M., Ng, P.S., " A strategy for determination of systolic, mean and diastolic blood pressures from oscillometric pulse profiles". Computers in
93

Bibliography

94

Cardiology 2000, Page: 211-214, September 2000.

35. Jia-Jung Wang, Chin-Teng Lin, Shing-Hong Liu, Zu-Chi Wen, " Model-based synthetic fuzzy logic controller for indirect blood pressure measurement", IEEE Transactions on Systems, Man and Cybernetics (Part B), VOL.: 32, Issue: 3, Page: 306-315, June 2002.

36. Neil E. Cotter, "The Stone-Weierstrass Theorem and Its Application to Neural Network", IEEE Transactions on Neural Networks, VOL.:I, No.4, Page:290-295, December 1990.

37. Narendra K.S., Mukhopadhyay, S., "Adaptive control using neural networks and approximate models", IEEE Transactions on Neural Networks,, VOL.: 8, Issue: 3 , Page: 475-485, May 1997.

38. Rovithakis G.A., "Tracking control of multi-input affine nonlinear dynamical systems with unknown nonlinearities using dynamical neural networks", IEEE Transactions on Systems, Man and Cybernetics (Part B), VOL.: 29, Issue: 2, Page: 179-189, April

1999.

94

