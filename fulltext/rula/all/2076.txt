NOTE TO USERS

This reproduction is the best copy available.

UMI
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

MULTI-PERIOD TRANSPORTATION EQUILIBRIUM APPROACH FOR TRANSPORTATION PLANNING
by Meng Wu B.Sc., Tianjin University, China, 1998

A thesis presented to Ryerson University

in partial fulfillment of the requirement for the degree of Master o f Applied Science in the Program of Mechanical Engineering

Toronto, Ontario, Canada, 2003 Â© Meng Wu, 2003

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

UMI Number: EC52902

INFORMATION TO USERS

The quality of this reproduction is dependent upon the quality of the copy submitted. Broken or indistinct print, colored or poor quality illustrations and photographs, print bleed-through, substandard margins, and improper alignment can adversely affect reproduction. In the unlikely event that the author did not send a complete manuscript and there are missing pages, these will be noted. Also, if unauthorized copyright material had to be removed, a note will indicate the deletion.

UMI
UMI Microform EC52902 Copyright 2008 by ProQuest LLC. All rights reserved. This microform edition is protected against unauthorized copying under Title 17, United States Code. ProQuest LLC 789 E. Eisenhower Parkway PC Box 1346 Ann Arbor, Ml 48106-1346

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

BORROWER'S PAGE

Ryerson University requires the signatures of all persons using or photocopying this thesis. Please sign below, and give address and date.

(ni)
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Title: Multi-Period Transportation Equilibrium Approach For Transportation Planning Name: Meng Wu Degree: Master of Applied Science Year of Convocation: 2003 D epartm ent: Department of Mechanical and Industrial Engineering, Ryerson University.

ABSTRACT

Previous studies in transportation equilibrium have focused on models in which travel demands were functions of travel time in the current time period. Most of these models are single-period models, neglecting the time lag effect. However, the time lag effect can be a very important factor, especially in long-term transportation planning. In this thesis, the geometric distributed lag (GDL) structure used in energy equilibrium models is applied to the multi-period transportation equilibrium models. Because it may be difficult to obtain the equilibrium solutions of such models by general iterative methods directly, such as the projection method or the relaxation method. General iterative methods are modified and implemented by GAMS (general Algebraic Modeling System). Final, a small scale transportation equilibrium model is solved by modified iterative method, illustrating the procedure of modeling and equilibrium seeking.

(iv)
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

ACKNOWLEDGEMENTS

I am truly in debt to my supervisor Professor June Wu for her guidance, support and patience throughout my research at the School of Industrial Engineering, Department of Mechanical Engineering, Ryerson University.

Financial support, in the form of Ryerson University Graduate Scholarship and Academic Assistantships from Professor June Wu, is gratefully appreciated.

I would also like to acknowledge the support of all my friends and family, their constant support enables me to focus on my study and accomplish the objectives.

(V)
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

LIST OF NOTATIONS
L P R S I fj C l Xp Cp di w. Si p c, Ui Cp t f i `^ x''p C^p^ the set of links the set o f paths the set o f origin nodes the set o f destination nodes the set o f original and destination pairs flow on link I travel time on link / flow on path p travel time on path p travel demand on O-D pair i travel disutility on O-D pair i link to path indicator marginal travel time on link I marginal travel disutility on O-D pair i marginal travel time on path p time period flow on link / at period t flow on path p at period t travel time on path p at period t

(vi)
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

d\`^

travel demand on O-D pair i at period t travel disutility on O-D pair i at period t

B E

matrix for the travel disutility elasticity matrix for the time lag elasticity matrix for inflated travel disutility elasticity at period t

(vii)
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

TABLE OF CONTENTS
Declaration .............................................................................................................................. ii Borrower's Page .................................................................................................................... ni Abstract .......................... iv

Acknowledgements .................................................................................................................. v List o f Notation ....................................................................................................................... vi Table o f Contents .............................. viii

List o f Tables.......................................................................................................................... x i List o f Figures ....................................................................................................... xiii

CHAPTER 1 INTRODUCTION.................................................................................. 1 CHAPTER 2 BASIC CONCEPTS AND LITERATURE REVIEW.........................4
2.1 Market Equilibrium and Market Equilibrium Models.............................................. 4 2.2 Basic Concepts for Transportation Equilibrium M odels.......................................... 8 2.2.1 Travel Time Function and Travel Demand Function......................................9 2.2.2 System-optimization versus User-optimization..............................................10 2.3 Solution Algorithms for Equilibrium Models.......................................................... 11 2.3.1 Economic Surplus Maximization Approach................................................... 12 2.3.2 General Iterative Approach..............................................................................14 2.3.3 Project Independence Evaluation System Algorithm.................................... 17 2.3.4 Multi-period GDL Energy/Environment Equilibrium Models and Decoupling Algorithm...............................................................................................18

CHAPTER 3 SINGLE-PERIOD TRANSPORTATION EQUILIBRIUM MODELS ................................................................................................................21
3.1 The Formulation for Single-period System-optimization....................................... 24 3.2 The Formulation for Single-period User-optimization........................................... 25 3.3 Transportation Equilibrium Models with Variable Demand..................................26 3.3.1 System-optimization with Variable Demand..................................................27 3.3.2 User-optimization with Variable Demand......................................................29

(viii)
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

3.4 An Illustration Case for Single-period Transportation Equilibrium Models...... 31

CHAPTER 4 MULTI-PERIOD TRANSPORTATION EQUILIBRIUM MODELS......................................................................................................................... 37
4.1 Multi-period Transportation Network Equilibrium M odels...................................38 4.1.1 Multi-period Transportation Equilibrium Models without Time Lag Demand ......................................................................................................................................38 4.1.2 Multi-period Transportation Equilibrium Models with Time Lag Demand 40 4.1.2.1 Time Lag Demand in Equilibrium Models........................................... 40 4.2 Exponential Structure in Demand Functions........................................................... 43

CHAPTER 5 SOLUTION ALGORITHMS FOR MULTI-PERIOD GDL TRANSPORTATION EQUILIBRIUM MODELS..................................................... 46
5.1 Decoupling Approach for GDL Equilibrium M odels............................................. 46 5.2 Inflated Disutility Elasticity in Transportation Equilibrium Models................... 47 5.2.1 One O-D pair and Multi-period Inflated Disutility Expression.................... 47 5.2.2 Two O-D Pairs and Two-Period Inflated Disutility Expression................... 48 5.2.3 Multi O-D Pairs and Multi-period Inflated Disutility Expression................ 50 5.3 Decoupled Projection Method for Multi-period Transportation Equilibrium Models with Time Lag Linear Demand.......................................................................... 52 5.4 Decoupled Relaxation Method for Multi-period Transportation Equilibrium Models with Time Lag Exponential Demand..,...............................................................56

CHAPTER 6 A NUMERICAL EXAMPLE................................................................60
6.1 The Structure of the M odel........................................................................................60 6.2 Decoupled Relaxation Method for the Solution of the Model................................66 6.3 Calculation Results.....................................................................................................72

CHAPTER 7 SUMMARY.............................................................................................78
7.1 Contribution.............................................................. 79 7.2 Future Research..........................................................................................................79

Appendix A: Single-Period Transportation Equilibrium Models

............. 81

(ix)
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Appendix B: Multi-period Transportation Equilibrium Models............................. 106
References :................................................ 129

w
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

LIST OF TABLES

Table 3.1; Path-link relationship......................................................................................23 Table 3.2: System-optimization calculation results....................................................... 34 Table 3.3: User-optimization calculation results............................................................35 Table 6.1 : Time functions for links..................................................................................64 Table 6.2: System-optimization computing iteration information................................ 73 Table 6.3 User-optimization computing iteration information..................................... 74 Table 6.4 System-optimization flow in each link results...............................................75 Table 6.5 User-optimization flow in each link results................................................... 76 Table 6.6 System-optimization demand, marginal travel disutility and marginal time in each O-D pair results..............................................................................................76 Table 6.7 User-optimization demand, travel disutility and time in each O-D pair results........................................................................................................................... 77 Table A.l : Type o f examples............................................................................................82 Table A.2: System-optimization results o f example 1................................................... 83 Table A.3: User-optimization results of example 1........................................................84 Table A.4: System-optimization results of example 2 .....................................................85 Table A.5: User-optimization results of example 2 ........................................................86 Table A.6: System-optimization results o f example 3 .................................................. 88 Table A.7: User-optimization results of example 3 ........................................................89 Table A. 8 : System-optimization results of example 4 .................................................. 91 Table A.9: User-optimization results of example 4 ........................................................93 Table A. 10: System-optimization results of example 5 ............................................. 95 |

Table A .l 1: User-optimization Results o f example 5.................................................... 96 Table A. 12: System-optimization results of example 6 ................................................. 98 Table A.13: User-optimization results o f example 6 ....................................................100 Table A. 14: System-optimization results of example 7..............................................102 Table A.15: User-optimization results of example 7 ...................................................103 Table A. 16: System-optimization results of example 8 ............................................... 104

(xi)

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Table A. 17: User-optimization results of example 8 ....................................................105 Table B .l : Type o f example in Appendix B ..................................................................107 fable B.2: Example 1 system-optimization iteration information...............................110 Table B.3: Example 1 system-optimization results......................................................110 Table B.4: Example 1 user-optimization iteration information...................................I l l Table B.5: Example 1 user-optimization results........................................................... 112 Table B.6: Example 2 system-optimization iteration information.............................. 115 Table B.7; Example 2 system-optimization results...................................................... 116 Table B.8: Example 2 user-optimization iteration information...................................117 Table B.9: Example 2 user-optimization results........................................................... 118 Table B.IO: Example 3 system-optimization iteration information.......................... 120 Table B.l 1: Example 3 system-optimization results....................................................120 Table B.12: Example 3 user-optimization iteration information.................................121 Table B.13: Example 3 user-optimization results......................................................... 122 Table B.14: Example 4 system-optimization iteration information............................ 125 Table B. 15: Example 4 system-optimization results.................................................... 126 Table B .l6: Example 4 user-optimization iteration information.................................127 Table B.17: Example 4 user-optimization results....................................................... 128

(xii)

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

LIST OF FIGURES

F ig u re 2.1 : Demand / supply equilibrium..........................................................................6 F ig u re 2.2: Consumers' plus producer's surplus............................................................12 F ig u re 3.1; Example network with two O-D pairs and four links...............................22 F ig u re 3.2: Equilibrium conditions with variable demand............................................30 F ig u re 3.3: Example network with one O-D pair and three links................................. 31 F ig u re 6.1 : The transportation network topology...........................................................61 F ig u re 6.2: Algorithm flow chart.................................................................................... 71 F ig u re A .l Example 1 network topology.........................................................................82 F ig u re A.2 Example 2 network topology..................................................................... 84

F igure A.3 Example 3 network topology.........................................................................86 F igure A.4 Example 4 network topology.........................................................................90 F igure A.5 Example 5 network topology.........................................................................94 F igure A.6 Example 6 network topology.........................................................................96 Figure A.7 Example 7 network topology....................................................................... 101 Figure A. 8 Example 8 network topology....................................................................... 103 F igure B .l Transportation network topology.............................................................. 108

(xiii) I
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

CHAPTER 1 INTRODUCTION

With the explosion of urbanization, traveling has become embedded into our daily lives. As a result, transportation has become increasingly important to our daily routine. Not only do transportation engineers need to plan the whole urban transportation system, but ordinary people also need to plan their own trips ahead of traveling. Regardless of who does the planning, both an individual and a transportation engineer have the same goal in mind; to lessen road traffic trouble caused by mass transportation. Actions between drivers and engineers' decisions and road congestion problems could be modeled as shifts in transportation equilibrium positions. The equilibrium models of transportation networks, which employ mathematical methods, are widely utilized in the realm of transportation planning and regional development.

In transportation equilibrium problem, much attention has been focused on those models in which travel demands can be functions of the travel time in the current time period. However, most o f these single-period models, neglecting the time lag effect (Sheffi, 1985, Nagumey, 1999). In the real world, the time lag effect can be a very important factor, especially in long-run transportation equilibrium problem analysis. The analysts and transportation engineers may wish to present the time lag effect in response of travel

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

demands to travel time. For example, the travel demand in this year on some paths depended to a great extent on historical data, such as the locations of residences or the residents' places of work, and these location decisions were influenced by the travel time when the decisions were made.

The geometric distributed lag (GDL) equilibrium approach (Dhrymes, 1981) has been applied in the energy field (Wu and Fuller, 1995). It has proved to be useful especially in long-run energy planning and environment management (Chung, Wu and Fuller, 1997). In order to provide a tool that can describe the time lag effect to analyze the effect of past travel time on current demands. The GDL demand need to be introduced into the multi period transportation equilibrium models. The current GDL equilibrium approach requires to be further modified in order to analyze long-term urban transportation equilibrium networks. In this thesis, the GDL equilibrium approach will be used to provide alternations cases under two distinct conditions, i.e., system-optimization and user-optimization.

In the energy GDL equilibrium models, the demand is represented by a function of the prices in the current time period, but also price in previous time periods based on the GDL structure, and the supply is a cost-minimizing linear process sub-model. It is motivated by Daniel and Goldberg (1981). Convergence of projection independence evaluation system (PIES) algorithm (Ahn and Hogan, 1982) as applied to the GDL equilibrium models has been explored both theoretically and empirically by Wu and Fuller (1991). Because it can be difficult to compute the solution of the GDL equilibrium

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

models by the PIES algorithm directly, the decoupling algorithm was developed by Wu and Fuller (1996). In this thesis, the decoupled principle i.e., to decouple the inter-period price links, as applied in the GDL energy equilibrium models needs to be modified when applied to urban transportation networks, considering the time lag effect. The modified iterative methods, called decoupled projection method and decoupled relaxation method are employed to solve transportation equilibrium models with GDL demand.

This thesis is organized as follows. Chapter 2 contains a literature review and some background material on equilibrium models and various equilibrium-seeking algorithms. Chapter 3 provides a mathematical presentation of single-period transportation equilibrium models. In chapter 4, based on the single-period models, GDL demand is introduced into multi-period transportation equilibrium models, considering the time lag effect. In chapter 5, an exponential structure is utilized in the demand function, and then solution algorithms are provided for the multi-period transportation equilibrium models with time lag demand. In chapter 6, a numerical example is solved by using the decoupled relaxation algorithm. Finally, the summary and conclusions are presented in chapter 7.

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

CHAPTER 2 BASIC CONCEPTS AND LITERATURE REVIEW

2.1 Market Equilibrium and Market Equilibrium Models

The equilibrium concept was first introduced in market fields (Thompson and Thore 1992). The application of this equilibrium concept in a market environment can be seen as a classical market equilibrium model. In a market equilibrium model, a commodity in the market is influenced by two sides of the market, the suppliers and the consumers. The supplier's behavior o f production can be described by a supply function, and the users' behavior o f consumption can be captured by a demand function. The price of goods will be automatically regulated by the market until they reach an equilibrium state in which the market is said to clear.

The supply fonction expresses the amount of goods that the suppliers produce according to the current market price. As the price increases, it becomes a more profitable product and the quantity supplied increases. The demand function describes the aggregate behavior o f consumers by relating the amount of product consumed to its price. As the price increases, the amount of consumer decreases. When the price of production equals the price o f consumption, the market achieves clearance.

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Figure 2.1 depicts simple supply and demand functions for a certain product. When the entire quantity product is consumed, the market clears at the point where the two curves intersect. This point (P*, Q*) is known as equilibrium point, where P* is equilibrium price and Q* is equilibrium production quantity. If the price is higher than P*, production will be higher than consumption, as shown in Figurer 2.1 b, such a balance cannot be kept because not all of the product sells. This will result in growing inventory. Prices will eventually fall and consumptions will increase accordingly. If price is lower than P*, the quantity demanded is higher than the production. Such a situation is again unstable, since producers will try to increase price in order to capture the consumers' willingness to pay more. This will lead to higher production and lower demand. In other words, if the price is lower or higher than P*, market forces will tend to push the price to its "market clearing" level. At this point, the price will be stable and the point (P*, Q*) will be the corresponding equilibrium point.

Reproduced with permission of the copvriaht owner. Further reproduction prohibited without permission.

Quantity

Supply

P

Quantity quantity

Supply Function

quantity produced

P Price

Quantity

quantity produced quantity

[ = 1

P Price

Figure 2.1; Demand / supply equilibrium (a) market-equilibrium quantity and price; (b) price too high; (c) price too low (Sheffi, 1985)

Following Ahn and Hogan (1982), the general type of market equilibrium models can be defined as: Supply side: Min S.t. d Z AZ =Q ZeW Demand side: (2.1) (V)

G= & W
Equilibrium condition: P=V

R e o ro d u c e d w ith o e rm is s io n o f th e c o o v ria h t o w n e r. F u rth e r re o ro d u c tlo n o ro h ib ite d w ith o u t o e rm is s io n .

In model (2.1), Kis an optimal dual variable vector (shadow price vector), corresponding to the demand requirement constraints A Z = Q, C is a cost vector for the supply activities, Z is a production activity level vector. I f is a polyhedral production constraint set which includes resource availability, material balance and other system constraints, and Qcj f.J is the demand function relating demand vector O to the price vector F.

Under the competitive market assumption, the elements of a shadow price vector F can be regarded as the supply prices, representing the marginal cost o f meeting an additional unit o f demand. As a result, a set of optimal solutions F* (or P*) and Q* become equilibrium price and demand vectors, respectively. An accompanying optimal value of the objective function Z* represents an equilibrium production profile of the supply activities.

The classical market equilibrium model o f Ahn and Hogan (1982) has been applied widely in energy and environmental fields. In 1988, Murphy et al applied partial equilibrium models containing a large number of constraints to build an Intermediate Future Forecast System (IFFS) and forecasted integrated energy markets for the US. Energy Information Administration (ElA). IFFS has been demonstrated to be a very useful tool to predict and measure the impacts of new energy policy to the energy markets. Since the 1960s, mathematical models began to be used to certain problems of environment quality control for resource management and policy analysis. Equilibrium

R e o ro d u c e d w ith o e rm is s io n o f th e c o o v ria h t o w n e r. F u rth e r re o ro d u c tlo n o ro h ib ite d w ith o u t o e rm is s io n .

models were applied in the environmental quality control field to analyze environmental quality polity and describe economic and environment impacts (Greenberg, 1995).

2.2 Basic Concepts for Transportation Equilibrium Models

Like in market equilibrium, the concept o f equilibrium can also be presented in the transportation equilibrium models (Sheffi, 1985). In this section some basic concepts for transportation equilibrium models will be reviewed.

In a transportation network of an urban area, normally there is heavy traffic during rush hours on most streets, intersections and transit lines. One o f the major problems which transportation engineers and urban planners face is to predict the impact of given transportation scenarios to the whole transportation system.

Consider a congested segment of an urban network as an example. In order to reduce congestion, one main solution is to consider opening a new road to the network. However, the new road may bring a new congestion problem if more and more users choose the new road than originally anticipated. When congestion arises again, users may choose to go back to the old road according to current flow distributed in system. After a short period, the drivers become familiar with the new network and know which route is better for them. Finally, the traffic on all roads reaches a stabilized point or equilibrium status.

R e o ro d u c e d w ith o e rm is s io n o f th e c o o v ria h t o w n e r. F u rth e r re o ro d u c tio n o ro h ib ite d w ith o u t o e rm is s io n .

2.2.1 Travel Time Function and Travel Demand Function

Similar to the supply function and demand function in the market equilibrium models, there are corresponding travel time function and travel demand fonction in urban transportation equilibrium models to represent time and travel demands (Sheffi, 1985).

In an urban transportation network, assume there are a few origin and destination pairs (O-D pair) of interest. For each O-D pair, there are a few different paths that people can choose. The system can be modeled and studies to see what flows distribution will make the traveling system optimal where all travelers could spend as little time as possible. On a given O-D pair, if all travelers took the quickest path, congestion would develop on this path. As a result, the travel time on this path might increase to a point where it is no longer the minimum travel-time on this path. Some of these drivers would then change to a different path. The alternative paths can be congested too, and so on. The situation can be analyzed by two functions: 1. Time fonction which describes how the level of travel time being affected by the transportation flows; 2. Demand function, which describes how the traffic volume on a road being affected by the travel time spent on this O-D pair.

Usually the travel impedance associated with the links on a path can include many components, reflecting travel time, safety, travel cost, stability o f flow, and others. Among those factors, the travel time is naturalized in this thesis. In other words, the demand function is described by the travel time spent on the links under current flow status.

R e o ro d u c e d w ith o e rm is s io n o f th e c o o v ria h t o w n e r. F u rth e r re o ro d u c tio n o ro h ib ite d w ith o u t o e rm is s io n .

If variable demand instead o f assuming fixed travel demand between every O-D pair is considered, the demand may be influenced by the level of service on the network such as travel time. In order to take this phenomenon into consideration, the demand between every O-D pair may be a fimction o f minimum travel time among all paths between this O-D pair; this can be referred to as travel disutility.

The demand function can be expected to be monotonically decreasing in the O-D travel time. Usually the demand is bounded by the total population between this O-D pair in a certain period.

2.2.2 System-optimization versus User-optimization

Wardrop (1952) explicitly recognized alternative possible behaviors of users of transportation networks and stated two principles. First, the travel time o f all routes actually used is equal, and less than those which would be experienced by a single vehicle on any unused route. Second, the average travel time for all users is minimal. In 1969, Dafermos and Sparrow coined the terms user-optimized (UO) and systemoptimized (SO) in transportation equilibrium models to distinguish between two distinct situations. In the first situation, users act unilaterally in selecting their quickest routes. In the latter problem, users select routes according to what is optimal for the whole system.

R e o ro d u c e d w ith o e rm is s io n o f th e c o o v ria h t o w n e r. F u rth e r re o ro d u c tio n o ro h ib ite d w ith o u t o e rm is s io n .

System-optimization problem is also known as traffic assignment firom the system level, namely because it assigns the O-D travel demand to make the total travel time spent in this system minimum. The capacity of each path on every O-D pair must also be known. The objective is to minimize the total users travel time. An equilibrium status will be reached when the marginal total travel time on all the used paths connecting a given original and destination pair is equal to or less than the travel time required on any unused path.

Comparing to system-optimization model, user-optimization is to optimize from individual user's view, under the condition of knowing the travel time and the number of users in each path for all the O-D pairs. It tries to find an optimal path with minimal travel time from origin to destination. A stable condition is reached only when no traveler can improve individually his travel time by unilaterally changing his route. In other words, the travel time on each used path is same and equal to or less than the travel time on any unused path.

2.3 Solution Algorithms for Equilibrium Models

Since the computable equilibrium models are used widely in management and decision making, such as transportation network flow assignment, decision making for optimal routes choosing, and even currently most concerned environment pollution problems caused by cars' emissions, etc (Nagumey, 2000), much work has been done to develop various solution techniques for calculation of the equilibrium models. In this section,

11
R e n ro d u c e d w ith D e rm issio n o f th e c o o v ria h t o w n e r. F u rth e r re o ro d u c tio n o ro h ib ite d w ith o u t o e rm is s io n .

some previous work on solution algorithms will be reviewed for solving equilibrium models.

2.3.1 Economic Surplus Maximization Approach

Economic surplus maximization algorithm is a popular method in solving equilibrium models. This idea is originated with Samuelson (1947), and widely used (Takayama and Judge, 1971). It is from an optimization's angle to model the original problem, in order to maximize the total producers and consumers surplus. When the surplus is maximized, an equilibrium solution also reached. In other words, an equilibrium problem can be transferred into an optimization problem. The competitive equilibrium problem is closely related to the surplus problems, which can be solved by an economic surplus maximization approach that is equivalent to solve a nonlinear optimization problem.

To illustrate this method, the single product and single-period equilibrium model is examined. Figure 2.2 shows the basic idea of the computational technique for the economic surplus maximization approach to the competitive equilibrium model.

SCO)

Ql

Q-

Q

Figure 2.2: Consumers' plus producer's surplus 12

L

Reoroduced with oermission of the coovriaht owner. Further reoroduction orohibited without oermission.

In Figure 2.2, if the quantity purchased and produced is Q L The area below the demand curve (jD) from 0 to Q l is usually interpreted as the total value to consumers of an amount QL Further, the area below the supply curve (5) is the total cost of supplying an amount Q l, because the supply curve is essentially the marginal cost curve for all producers aggregated together. So the shaded area A (Q l) is the area under the demand curve (up to demand quantity Q l minus the total cost (the area under the supply curve), which is the value of a function called "consumers' plus producers' surplus". As Q moves form Q l to the right, the shaded area becomes larger, until Q passes Q *- then moving to the right makes negative additions to the area. As a result, we know that the shaded area A ( 0 is maximized at the equilibrium point Q*.

Economic surplus maximization approach can be applied in one commodity and one period. It even can be extended to cover the multi-period competitive equilibrium model. Samuelson(1947) and Takayama and Judge(1971) stated that it can also be generalized to the multi-commodity and multi-period competitive equilibrium case if certain conditions are satisfied, namely the demand functions satisfy the integrability condition. This condition is equivalent to the symmetry o f the demand function's (a vector valued function of prices) Jacobian matrix, or the price o f those commodities do not interact with each other in the demand frmctions. Samuelson (1947) and Takayama and Judge (1971) also reported that their models assume the symmetry o f cross-price effects, satisfying the integrability condition.

13
Reproc'Ã¼ced with permission of the copyright owner. Further reproduction prohibited without permission.

However, in the presence o f many known examples of asymmetrical cross, such as price effects in demand functions, this condition could not he expected to hold. As a result, the convenient equivalence between the competitive equilibrium problem and the economic surplus maximization problem is not available in multi-commodity and multi-period competitive equilibrium case.

2.3.2 General Iterative Approach

In equilibrium model calculation, once the urban transportation equilibrium optimized flow pattern is established according to two types' equilibrium (system-optimization and user-optimization), transportation equilibrium problems can be solved by general iterative approach (Nagumey, 1999).

As we mentioned before, in a system-optimization, users are allocated among the routes to minimize the total time in the system. In a user-optimization problem, each user o f a network, system seeks his/her optimal travel paths until equilibrium is reached, in which no user can decrease his/her time of travel by unilateral changing routes. In the particular situation of the transportation equilibrium problem under certain symmetry assumptions on time and travel disutility function, an algorithm called projection method is effective in solving this kind of problems (Bertsekas and Gafiii, 1982). The projection method divides the original problem into smaller components, which are equivalent to quadratic programming problems. Usually, quadratic programming problems are much easier to

14
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

solve as compared to some nonlinear optimization problems, especially in cases where hundreds of decision variables are involved.

The projection method in computation of single-period transportation network equilibrium can be represented as follows: Step 0 : Initialization Select an initial feasible flow and demand pattern e K. Also, select

symmetric, positive definite matrices G a n d - M , where G is m n L x n L matrix and --M i s an n J x n J matrix. Select p such that 0< p < min 2a 2a .7 'A Where a is constant in the strong monotonie condition, K o f the positive definite symmetric matrixes 5c. Set k:=l Step 1: construction and computation Construct G-I
77

and p are the maximum over

%

and

And = pu{d''-^)-M dTk-\ Compute the unique transportation pattern ( f ' `,d ^) corresponding to travel time and travel disutility functions o f the special form:

15
A
Reproduced with permission of the copyright owner. Further reproduction prohibited without oermission.

c * -'(/) = G r + A*-' u' ^ - \ d ) = M d + &^ Step 2: convergence verification I / * - / * - '! w* If---I ------- < e and---r-- r-i-- - < 6 , withe > 0 , a pre-specified tolerance, stop; ik-\ l / ``` otherwise, set A : := A : -f-1, and go to Step 1.

Nagumey (1999) pointed out that possibilities for the selection o f the matrices G and M are any diagonal positive definite matrices of appropriate dimensions. One could also set G and M to the diagonal parts of the Jacobian matrices

%]

1%

evaluated at the initial feasible flow pattern. Observe that if one selects diagonal matrices then the above sub-problems are decoupled by mode o f transportation and each sub problem can be allocated to a distinct processor for computation.

By practical applications it is demonstrated that the projection method is an effective solution technique in solving the transportation equilibrium models, especially in transportation equilibrium models involving hundreds of variables and complicated nonlinear functions which are expensive to evaluate. However, the projection method can only be used if the time functions and demand function's Jacobian matrices G and -M satisfy symmetric, positive definite conditions. However, this symmetry assumption is not expected to hold in most applications. In many known examples, the asymmetry affects the time o f mode i on link a in different manner with that o f mode j on link b. In

16
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

the case of a single mode problem, the asymmetry condition would imply that the time on link a is affected by the flow on link b in different manner as the time on link b is affected by the flow on link a. As a result, the projection method is not available in those models with asymmetric properties.

2.3.3 Project Independence Evaluation System Algorithm

As shown in section 2.3.2, the projection method cannot be directly used in competitive equilibrium case with asymmetrical cross - price effects in demand functions. The Project Independence Evaluation System (PIES) was developed based on economic surplus maximization algorithm. The PIES algorithm is also known as a relaxation method in transportation equilibrium models (Nagumey, 1999). It's done by approximating a non-inverse demand function by substituting the price with an approximate value to estimate the asymmetrical cross price, items. Normally this approximate price comes from last iteration optimal value. A nonlinear optimization algorithm may compute the optimal activity levels and market prices are derived from the corresponding shadow prices. The PIES algorithm combines the economic surplus maximization algorithm and the fixed-point method (Scarf, 1973) to solve multicommodity and multi-period competitive equilibrium problems. (Stone, 1985)

The PIES algorithm (Ann and Hogan, 1982) is initiated by inserting an approximate price vector into an economic sub-model that determines demands. This is done so that a demand function with cross price effects is approximated by eliminating the cross

I
Reproduced with permission of the copyripht owner. Further reproduction prohibited without permission.

I

components and thus a non-inverse function being transferred to an inverse-able function. Hence, the economic surplus maximization problem may be solved by a linear or nonlinear optimization algorithm.

'

I

If the quantity demanded is known, the competitive selection of supply alternatives is equivalent to that required delivering these quantities at minimum total cost. Furthermore, the change in the total cost required to deliver an additional unit of a given product can be interpreted as the supply price of the product. This results in a new approximation to the vector o f the market price. The price vector is inserted back into the demand sub-model; a new approximate demand function is established, and so on. If the quantities demanded can be determined such that the associated supply prices and demand prices are equal, a solution is obtained which would be equal to Ãie equilibrium solution for the original non-integrable system.

2.3.4 Multi-period GDL Energy/Environment Equilibrium Models and Decoupling Algorithm

As we mentioned before, in equilibrium models, the time lag effect can be a very importation factor, and the analyst may wish to present the time lag effect in demand function in response of the price. In order to present time lag effect, a new multi-period equilibrium model with GDL demand, called the GDL equilibrium model, has been proposed by Wu and Fuller (1995). In the GDL equilibrium model, the demand is

18
Â£

I Reoroduced with oermission of the coovriaht owner. Further reoroduction orohibited without oermission.

represented by a function of the prices not only in the current time period but also in previous time periods based on the geometric distributed lag structure.

For the normal solution algorithm for the GDL equilibrium model, Wu and Fuller (1996) stated that it can be difficult to compute the solution of the GDL equilibrium model by applying the PIES algorithm directly. Consequently, a new equilibrium seeking algorithm, referred to as the decoupling algorithm, was developed.

The decoupling algorithm constructs a modified GDL demand at each decoupling iteration through inflated price elasticity, in which demands are approximated as the functions only of the current period prices. By doing so, it successfully decouples inter period travel disutility links in decoupled sub-model. Then the PIES algorithm can be used in each decoupling step. The optimal values obtained fi'om the PIES algorithm are inserted back again to calculate new inflated price elasticity. So and so on, the system will reach the final optimal point. Accompanying solutions are the equilibrium optimal solutions.

Following Wu and Fuller (1996), the decoupling algorithm can be stated as follows: Step 1. Provide a starting guess of the price vector Step 2. Using I Step 3. If-- |% | let = Pm , and go to step 2. , for t = 1,2,..., T , set w = 1.

estimate the decoupled sub-model and calculate its equilibrium, I -- < J , a small enough tolerance, then go to step 4. Otherwise,

19
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Step 4. Teiminate with p* --

.

The decoupling algorithm has been proved to be effective in solving energy model with GDL structure. It was applied in solving a large scale model of North American energy supplies and demands in the 30-year version (10 periods each of 3 years duration) (Wu and Fuller 1996).

In this chapter, classical market equilibrium models were introduced, as well as their application in energy and transportation equilibrium fields. Then, some previous solution algorithms were reviewed; economic surplus maximization, projection method, and relaxation algoritlim. All of these were demonstrated to be effective algorithms in solving single-period energy equilibrium models and single- period transportation equilibrium models. Decoupling algorithm was developed for the solution of the energy equilibrium models, considering multi-period demand functions with time lag effect, called GDL energy equilibrium models. Computation results suggest empirically that decoupling algorithm is very efficient convergent algorithm.

In this thesis, the GDL equilibrium approach used in the energy model will be applied to multi-period transportation equilibrium problems witli time lag effect demand.

Reoroduced with oermission of the coovriaht owner. Further reoroduction orohibited without oermission.

CHAPTER 3 SINGLE-PERIOD TRANSPORTATION EQUILIBRIUM MODELS

As it was mentioned in Chapter 2, equilibrium concepts can be applied in transportation network. There exist two types of equilibrium status in the transportation equilibrium models, system-optimization and user-optimization. In this chapter, single-period transportation equilibrium models for two types of equilibria will be discussed.

Before the basic formulation is discussed, the following paragraphs present the network notations used in this chapter. Following Sheffi (1985), the network itself is represented by a directed graph that includes a set o f consecutively numbered nodes, N, a set of links, L, and a set o f paths, P. Let R denote the set of origin nodes and S denote the set of destination nodes. The origin node set and the destination node set are not mutually exclusive since nodes can serve as origins and destinations of different travel demands at the same time. Each O-D pair i (i e RS) is connected by a set of paths (routes) through the network.

The origin-destination matrix is denoted by d with entries J , . In other words, d; is the travel demand between origin r and destination 5 during the period of analysis. Let fi and

21
Reeroduced with Dermission of the coDvrioht owner. Further reoroduction orohibited without oermission.

I

c, present the flow and travel time, respectively on link / (where 1 e.L). Furthermore C ; = c , ( / ) , where c,(.) represents the relationship between flow and travel time for link a. In other words, c, ( / ) is the travel time function on link I. Similarly, let Xp and Cp represent the flow and travel time, on path p. the travel time on a particular path is the sum o f the travel time on the links comprising this path. So, the time function in each path p can be represented as follows: Cp='Z^,S,^p I Where Ã´, p = 1, if link I is a part of path p connecting O-D pair i, and = 0 otherwise.

Using the same indicator variable, tlie link flow can be expressed as a function of the path flow, that is

P

The above equation means that the flow on each link is the sum of the flows on all paths going through that link.

The path-link indicator variable can be presented by a path-link indicator matrix. As an example of the use of the indicator matrix to represent the path-link relationships, consider the simple network shown in Figure 3.1.

Figure 3.1: Example network with two O-D pairs and four links

22
Reoroduced with oermission of the coovriaht owner. Further reoroduction orohibited without oermission.

Assume that there are 2 O-D pairs node 1 to node 4 and node 2 to node 4. The first path from origin node 1 to destination node 4 uses link 1 and link 3 and the second one uses link 1 and 4. Similarly, assume that the first path from origin node 2 to node 4 uses link 2 and 3, and the second one uses link 2 and 4. So the path-link indicator Si ^ matrix for Figure 3.1 can be written as the following table: Table 3.1: Path-link relationship RS 1-4 Linkl Link2 Links Link4 Pathl 1 0 1 0 RS2-4

Path2 Paths Path4 1 0 0 0 . 1 1 0 1 0 1 0 1

For example, S ^ = 1 (since linkl is on path 1), S^ 2 ~ 0 (since link 3 is not on the path 4). The incidence relationships for Figure 3.1 mean that. For example,
C l = c . J i i + C2^2_, + C3 ^3^1 +

C^S^i

= C, + C3

The above equation means that the travel time on path 1 between origin 1 and destination 4 is the sum o f the travel times on the links comprising this path. Similarly, Ã +^2<5^3.2 +^3<^3,3 +^4^3,4 = ^ ^ 1 + ^3

The flow on a particular link is the sum o f the path flows traversing this link.

In this chapter, equilibriums models for system-equilibrium condition will first be discussed and then for user-optimization condition.

23
Reoroduced with oermission of the coovriaht owner. Further reoroduction orohibited without oermission.

3.1 The Formulation for Single-period System-optimization

In a single-period system-optimization model, it is assumed that there exists a central controller who seeks to minimize the total time in the network. As it was discussed in the previous chapter, the network achieves system equilibrium status when the marginal time spent in used paths is less than or equal to marginal time on unused paths. It achieves equilibrium status from the whole system level to minimize the total drivers' travel time rather than individual user. In other words, at system-optimization flow pattern, drivers may be able to decrease their travel time by unilaterally changing routes.

The single-period system-optimization flow pattern can be obtained by solving the following mathematical program (Sheffi, 1985):

MmZ = ^ c , ( / ) x /
/

s.t.

p

Xp> 0 and the definitional constraints

/, = E ^ A ,
p

(3-1)

In model (3.1) the objective function is the total travel time spent in the whole network. Constrain 1 states that the flow on all paths connecting each O-D pair should equal to the corresponding O-D travel demand. In other words, all O-D travel demands have to be

24
Reoroduced with Dermission of the coovriaht owner. Further reoroduction orohibited without oermission.

assigned to the network. The non-negative conditions in constraint 2 are required to ensure that the solution o f the program will be physically meaningful. In model (3.1) it is assumed that the travel demand at each O-D pair is a fixed number first. In this case, the original equilibrium problem is transferred to a pure optimization programming. The accompanying optimal solutions are equilibrium solutions.

3.2 The Formulation for Single-period User-optimization

Compared with system-optimization, for user-optimization, the road choosing is based on behavioral assumption that each individual car travels on the path that minimizes the travel time firom its origin to destination. Once the network achieves user equilibrium mode, no user can lessen his travel time by unilaterally changing roads. The useroptimization flow pattern is achieved when the travel time for each O-D pair on all used paths is less than or equal to the travel time that should be experienced by an individual user on any unused path.

The equilibrium flow pattern can be obtained by solving the following mathematical formulation (Sheffi, 1985): ft Min Z = V (c, {cÃ¹)dcÃ» I 0 S.t.

Xj,>0

25
Reoroduced with oermission of the coovriaht owner. Further reoroduction orohibited without oermission.

and the definitional constraints
(3.2)
P

In model (3.2), the objective function is the sum of the integrals of the travel time functions, and the constraints are the same as system-optimization models' constraint set.

3.3 Transportation Equilibrium Models with Variable Demand

In models (3.1) and (3.2) it was assumed that the demand between every origin and destination is fixed and known. However, in reality, travel demands may be influenced by the level o f service on the network. For example, as congestion increases, users may decide to use another path.

In order to present this phenomenon, the travel demand, d .^, between every O-D pair r-s, can be assumed to be a function of the travel time between r and s (Sheffi, 1985). d. = D,(w,) Where m , is the minimum travel time between r and s, and D^Ã) is the demand function of travel disutility between r and s. The demand function may be presented by dj - A B f (m,) , where A and B are known parameters associated with origin r and destination j, respectively, and /(Â« ,) is a function of u,-.

The demand function may be expected to be monotonically decreasing or not increasing. As U ; grows, d^ decrease, and vice versa. This function is also bounded. For example, the

26 J ^
Reoroduced with Dermission of the coovriaht owner. Further reoroduction orohibited without oermission.

maximum number of demand generated between an O-D pair in a certain period may be bounded by the total population size at the origin.

3.3.1 System-optimization with Variable Demand

Consider the variable demand and the demand function is given by a function o f travel disutility, d. = D,.(w). Then system-optimization with variable demand can be formulated as follows: Min Z - j ; c , ( / ) x / , - ^ f l , - `{ d )x d ,
I i

S.t.

p

^ ,> 0 and the definitional constraints

(3-3-1)
P

Where Dr*(.) is the inverse of the demand fimction associated with O-D pair L The objective function is the sum of the total link travel time functions minus the sum of the inverse demand fimctions multiplying corresponding demands. The constraint set is similar to the fixed-demand function.

27
Reoroduced with oermission of the coovriaht owner. Further reoroduction orohibited without oermission.

According to the system-optimization equilibrium condition; marginal time spent in any used paths is less than or equal to unused paths. There is another mathematical presentation for system-optimization models.

Min Z = ^
I 0

A
I

'''A ^Ui{v)dv
0

s.t.

p

Xp > 0 d; > 0 and the definitional constraints (3.3-2)
P

Where C l ( / ) = dci ( / ) / df, X/ , + c; ( / ) Â« / ( / ) = dU;{d)ldd; X d. +u.(d) c , { f ) , Ui{d) are marginal time and travel disutility. Marginal time can be interpreted as the marginal contribution o f an additional traveler to the total travel time in this system.

In model 3.3-2, a system-optimization problem is formulated as user-optimization models by marginal time substituting time.

^

28

U V lW 't-V v:i t

^``

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

3.3.2 User-optimization with Variable Demand

The user-optimization with variable demand can be formulated as follows (Sheffi, 1985):
/; rf,< 0

Min Z = ^
I

^ C j { c o ) d ( o ^DT^{cÃ¹)doe
0

s.t.

Xj,>0

and the definitional constraints f,= 'Z ^ A p
P

(3.4)

Where Z)r'(.)is the inverse of the travel demand function associated with O-D pair i. The objective function is the sum of the integrals o f the link travel time functions minus the sum o f the integrals o f the inverse demand function. The constraint set is similar to the fixed-demand formulation.

The solution o f equilibrium models with variable demand functions can be interpreted by Figure 3.2. Here for simplicity, just consider one path and link equal to path transportation network. Further, assume the travel time spent in this path is given by travel time functions, c = f + 1, The demand decrease with the total time needed in the system is given by travel demand functions, D = 5 - u ,

29
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

g

Figure 3.2; Equilibrium conditions with variable demand

Under user-optimization equilibrium condition, and according to economic surplus maximum method, the equilibrium solution will be achieved when the maximization difference between the area under the inverse demand curve (u = 5 - d ) and the area under the time function (c= i is maximized. If system-optimization is considered,

demand curve and time curve are substituted by marginal demand and marginal time. The corresponding marginal travel disutility function should be
A

u = d u l d d x d + u = 5 --2 x d . And marginal time function is c --d c l d f x f + c --2 x f + 1.

30
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

The equilibrium solution can be obtained when the difference area between the areas under the marginal travel disutility function and marginal time function are maximized. Figure 3.2 show the equilibrium solution under system-optimization and useroptimization.

3.4 An Illustration Case for Single-period Transportation Equilibrium Models

In this section, the transportation network topology structure as shown in Figure 3.3 will be used to illustrate the single-period transportation network equilibrium model and its optimal solutions. System-optimization and user-optimization will be considered separately.

Figure 3.3: Example network with one O-D pair and three links

It was assumed that there are 1 O-D pair, 2 links and 2 paths in a small transportation network. For the origin and destination pair node 1 to node 3 there are 2 paths available, path I connected by link a and link c, and path 2 through link b and link c. In supply side, 31
Reoroduced with oermission of the coovriaht owner. Further reoroduction orohibited without oermission.

it was assumed that there are interactively flow influences in time functions for each link. For example, the travel time spent in link a not only depends on the flow in its own link, but also on other links in the same O-D pair. The travel time functions in each link are given as follows; ^a=5x/^+2x/j, + 5 C i=7x/j+/,-t-5 C c= 3 x /, + /,,+/Ã´ + 7 On demand side, instead o f fixed demand, it was assumed that the travel demand varies with travel time spent in the system. The less travel time spent in this segment of network, the more users prefer travel on the routes. The travel disutility function is; J, = 49. 5 -0 .5 xwj

First, system-optimization mode was considered to assign flows in order to achieve the minimum total travel time for all users spent in this system. The system-optimization case can be formulated as follows; Min

2
l-a,byC

^ / ( / ) ^ . / Ã® ~ S "/(^ )^ ^ / = ( 5 ^ / a + 2 x / i + 5 ) x / , + ( 7 x / j + / ^ + 5 ) x / j +
i~\

( 3 x ) : + / ,+ y ^ + 7 ) x y ; - ( 9 9 - 2 x ( f J x ^ ,

s.t.

^1+^2 = ^ ,;
fa fb fc

~ ^1 Ã
-- ^2 '

=^1 + X ;;

A /L ^ 0; >0;

32
R e n ro d u c e d w ith n e rm is filo n o f th e c n n u rin h t o w n e r F u rth e r re n rn d iic tin n n rn h ih ite d w ith o u t n e rm le s in n

Compared with system-optimization, user-optimization can be modeled as: Min /i Z= ^
/=a,fc,c 0 0

d ,

L Ã j(5xÃ¼) + 2xy^ + 5)(fÃ¼)+ j(7xa) +
0 0

+5)do) +

j(3xÃ»> + /^ + fi^ + 7)dco- ^ { 9 9 - l x Ã¼ ) d Ã¼
0 0

s.t.

x^+X2 =d^;
fa

= X , -fX ;:

A / : ^ 0; Xi,X2 > 0;

Since no asymmetry effect in time and travel disutility function exist, the projection method can be used to find the optimal solutions.

After applying the projection method, final results are summarized in Tables 3. 2 and 3.3

33
R A n r n r l i i r t a d w i t h nArmi.C-Qinn n f t h p n n n w r i n h t n w n o r Fi i r t h n r r A n r n r l i i r tt i n n n r n h i h i t A H w i t h n i i t n A r m i c c i n n

/'Ml

Iteration 0

L

fc

4
C a

4
Cb

8
Cc

d, 8

z

33 C; 72
Ca

37
Q

39

76
Cb

53
c ,

65 C2
128 /b

4 63

116 1 2.511
Ca

/c 4.589 C c 25.357

d,
4.589

z 167.084

2.079
Cb

21.713
Cj

22.064
Q

47.07

34.268
c ,

47.421 4 36.617
C2

4 39.124

73.392 2
/Â«

75.741
/b /.

d, 4.947

z 193.787

2.825
Ca

2.122
Cb

4.947
C c 26.788

23.369
c ,

50.157
Ca

22.679 Q 49.467 4 37.533
C

4

37.494
c ,

41.629 z 194.145

79.123 3
fa

79.162
/b

di
4.952 C c

2.829 23.389
c ,

2.122
Cb

4.952

22.683 C;

26.807

50.196
Ca

49.49
4 4

37.534
c ,

37.537
C2

41.663

79.2 79.2 Table 3.2: System-optimization calculation results

I
R o n r n H i i P ^ r i H \A/ it h n o r m i c c i n n rvf t h o r ' n n v / r i n h t n v A / n o r

34
P i i r t h o r r o n r n H i l o t i n n n r r i h i h i + Ã» H \A /lfhnn+ r v o r m i c c i r v n

Iteration 0

fa 4 C a 33 c, 72 5.021 38.421 C/ 82.137 fa 4.948 C o 37.75 c, 80.562 .. fa 4.999 38.011 Q 81.042 fa

1

fb 4 C b 37 c. 76 . fb 4.158 C b 39.127 Q 82.843 fb 4.005 C b 37.983 Q 80.795 fb 4.008 C b 38.055 C2 81.086 /.

fo 8 C c 39

d, 8

z

1

fc 9.179 C c 43.716

dj
9.179

z 334.168

2

fc 8.953 C c 42.812

d,
8.953

z 317.739

3

fc 9.008 C c 43.031

d,
9.008

z 321.581

4

fc

di

z

5

4.997 4.001 8.998 320.846 8.998 C a C b C c 37.987 38.004 42.992 c, Q 80.979 80.996 z d, fa fb fc 5 4 -321 9 9 C a C b C c 38 43 . 38 c, Q 81 81 Table 3.3: User-optimization calculation results

In Table 3.2 and 3.3, two examples were solved from the same guess of flow //. In Table 3.2 when flow in the system was automatically adjusted iofa --2.829, fb= 2.122,_/Ã¨=4.952, the marginal travel time spent in two paths were equal. As a result, the system achieves

35
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

system-optimization where the corresponding flows are equilibrium flow patterns under the system-optimization condition. The same as system-optimization, Table 3.3 iteration 4 shows the time spent in path 1 and 2 are equal, and no user can change his or her routes to get less travel time. Hence the system achieve user-optimization where the corresponding flow p a t t e r n = 5,fb=4,fc=9 are equilibrium solutions. % Appendix A illustrates eight single-period transportation equilibrium models. The optimal solutions and test the convergence o f projection method is used for computing single-period transportation equilibrium models by using GAMS.

36
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

CHAPTER 4 MULTI-PERIOD TRANSPORTATION EQUILIBRIUM MODELS

Transportation network demand adjustment to travel disutility usually occurs over a long period, while current time demand mainly depends on travel times in previous time period. As it was discussed before, in long period equilibrium analysis, the time lag effect can be a very important factor.

In this chapter energy GDL equilibrium will be applied to transportation equilibrium fields to consider the time lag effect. First, multi-period transportation equilibrium models without time lag demand will be introduced; and then time lag effect in transportation network demand function is presented. Finally, exponential structure in demand function will be introduced to describe the relation between demand and travel disutility in multi-period transportation equilibrium.

37
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

11

4.1 Multi-period Transportation Network Equilibrium Models
4.1.1 Multi-period Transportation Equilibrium Models without Time Lag Demand

Multi-period transportation equilibrium model can be an important tool for decision makers. In transportation policies analysis, the transportation planner and analyst usually need to analyze and consider transportation congestion that normally occurs during a long period. In this section, multi-period transportation equilibrium models will be considered.

Consider the system-optimization case, multi-period equilibrium model can be formulated as follows: Min Z
/=1 I I

S .t

p

xf

>0
> 0

and the definitional constraints (4.1)
P

Where D \'^ ^(.)is the inverse o f the demand function associated with 0-D pair i in each j period t. The objective function is sum of travel times on all links in all periods, minus

^

M

___________________

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

the sum o f demands on all links multiplied by their corresponding travel disutility. The constraint,
p

, states that the flow on all paths connecting each O-D pair in

period t equals to the O-D demand in that period. The no negativity conditions are required to ensure that the solution o f the program will be physically meaningful.

Compared with system-optimization, the multi-period user-optimization equilibrium model without time lag effect can be formulated as follows:

M in Z = 2 OE
t =l /

\ c \ `\ o i ) d o > - Y ,
0 ' 0

s.t.

p

4'> > 0

and the definitional constraints

39
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

\

4.1.2 Multi-period Transportation Equilibrium Models with Time Lag Demand
4.1.2.1 Time Lag Demand in Equilibrium Models

In the energy sector, the reaction o f demand to a change in its price is a process in a period (Wu and Fuller, 1995). Part of the reaction may occur during the period of the price changes, but the complete adjustments to the price changes typically occur in the latter period. Daniel and Goldberg (1981) pointed out that the effect of the price of an energy commodity in preceding period often exceeds the effect of the current period price on the demand for that commodity. Similarly there exists "time lag" effect in transportation models. Road flow and congestion level of current period depend a great extent on flow and travel time of previous periods. In order to present the "time lag effect", lag elasticity coefficients E in demand functions is introduced.

In transportation network, the general demand function without time lag effect can be described as:

1 = 1 Where d^`'>= Travel demand in i O-D pair at period t, a\`^ = Constant in demand function i at period t, bj = Travel disutility elasticity.

40
Reproduced with permission of the copvriaht owner. Further reproduction prohibited without permission.

= Travel disutility in i O-D pair at period t.

In energy models the general geometric distributed lag (GDL) stracture can be stated as (Wu and Fuller, 1995); = di+
1=0

Where y = Demand quantity in period t, = Price in period t, a = A constant, a* = Unknown constants, = A random variable independent ofx^'^, with mean zero and constant variance.

Comparing the energy models with general distributed lag structure, the general type demand function (for simplicity, consider a one O-D pair transportation equilibrium model) with time lag effect can be stated as:

Where -- The travel demand and the travel disutility at period t, a^`'>= Constant at period t, b =Tbe travel disutility elasticity, e = The time lag elasticity,

41
Reoroduced with oermission of the coovriaht owner. Further reoroduction orohibited without oermission.

At period f - 1 :

So that, by successive substitution

Â«=1

n=l

Where = Travel demand and the travel disutility at period t, b =The travel disutility elasticity, e = The lag elasticity, = Constant at period t -- i.

In one O-D pair and T-period transportation equilibrium models, the demand function employed time lag structure can be represented by: Â£,(1) ^^(1)

J)LT) _

_ ^ (.T -D ^ p m _ p(T -2)pp[2) _ _ _ _ _ p p {T )

Where Â£)Â«) ^jj(.o = Vectors o f demand and travel disutility in period t; E= sxi / X/ matrix of lag elasticity; B = an / X/ matrix o f travel disutility elasticity; = a vectors o f the constant factors at period t.

42
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

This can also be written in matrix notation as;

' j5(D 

B

urn

=

-

E `-^B

B

2)(n

ET-Ib

T -l

B

U(r)

4.2 Exponential Structure in Demand Functions

In energy equilibrium models, the demand function is not limited to linear expression; there exists a more popular expression among econometricians: exponential structure in demand function, which is used very widely. In the previous transportation equilibrium research, for the sake of simplification, the demand was assumed to be a linear function of travel disutility. In this section, the exponential demand function is introduced, i.e., travel demand is an exponential function of travel disutility.

First, in energy models the geometric distributed lag exponential structure can be stated as

1=0

43
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

The influence of the lag independent variable x on the reaction variable y decreases with increasing lags, and the influence of the lag variable x on variable y is close to zero as the lag goes to infinity.

Comparing with GDL demand function, the transportation network with time lag exponential demand function can be stated by; X )X

Where =The travel demand and the travel disutility in O-D pair i at period t, UjP =The travel demand and the travel disutility in O-D pair j at period t, bj j = The travel disutility elasticity, e, = The time lag elasticity for demand on O-D pair i.

For the sake o f simplicity, consider one O-D pair T-period models with time lag effect, the exponential demand function can be presented by

I
I

Where =The travel demand and the travel disutility at period t, b =The travel disutility elasticity, e = The time lag elasticity.

At period t - l : 44
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

So that, by successive substitution

n=l

7 7 = 1

If

= Inu^'^, = ln ]~ Ia Me''
n=\

and if period t from 7 to T is considered, the following can be obtained d = a --B,u The vectors q, a and p, and the matrix 5, can be stated as matrix expression:

V )'

, 0)

--

-

_^(D_

e^-^b

e^-^b

b

u (n

45
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

CHAPTER 5 SOLUTION ALGORITHMS FOR MULTI-PERIOD GDL TRANSPORTATION EQUILIBRIUM MODELS

5.1 Decoupling Approach for GDL Equilibrium Models

As introduced before, decoupling algorithm is an effective algorithm used in the energy GDL models. At each decoupling step, a new decoupling sub-model is constructed, in which the travel demands depend only on their cunent period travel disutility through inflated disutility elasticity. Then, the PIES algorithm can be used directly in each decoupling sub-model. If the prices and demand quantities at a decoupling step are equal to those at the next decoupling step (in practice, "equal" means within a given small tolerance), an equilibrium solution is obtained.

In this chapter, the GDL approach is compared to present the expression o f inflated disutility elasticity in multi-period transportation equilibrium models with time lag effect demand. Next, the solution algorithms decoupled projection and decoupled relaxation methods for solving transportation equilibrium models with time lag effect will be stated.

il

46

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

5.2 Inflated Disutility Elasticity in Transportation Equilibrium Models
5.2.1 One O-D pair and Multi-period Inflated Disutility Expression

First consider a one O-D pair and multi-period transportation equilibrium. The one O-D pair and multi-period with time lag demand function can be described as d = a --B,u the matrix notation as follows:
>
1) -

0

u

=

-

Ã©

'6

b

Here, we set

6

"' , 6 '^' , 6 "' to be inflated disutility elasticities at period 1,2, 3. The demand

function also can be described as: V ') "
0 1

-

uW

-

0

0

,(0

diT)

0

0

u (T)

47
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

If the last decoupled iteration has travel disutility, U *, this iteration inflated disutility elasticities can be found through the following steps: '&(')
0

'

yO) *

h

o'

yO) *

0

0

y(b * =

e'- '6

6

j^(0 *

0

0

yn *

The inflated disutilities considering one O-D pair multi-period can be expressed by algebra structure: ^

5.2.2 Two O-D Pairs and Two-Period Inflated Disutility Expression

Furthermore consider 2 O-D pairs and 2 period's transportation network. Assume that there exist 2 origin and destination pairs, and consider t - 2 transportation equilibrium with lag elasticity E, travel disutility elasticity B. The demand function can be stated as follows:

y %

48

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

D=A-Bfir

or the matrix structure as;
B Â£,(2)^ If O'

_EB B_ ^ ( 2)

is set to be inflated disutility elasticity at period t = 1 and 2, then the demand

function can also be described as:
0 ` g(2)

Â£)(2)

_ 0

Â£(2)

Note that the last decoupled iteration travel disutility is U*, then 'B Â£,(2) EB O' B * -Â£( 1) _
0 0

' JÂ£( 2)

Â£ ( 2)

0

'
2)

*

"B EB

O' B [;( 2)

_

0

B^^\ y

At period t= l, and from the above equation, the following is achieved; ^{i)x [/(!)* = ^ x At period t= l the inflated disutility elasticity B^^^ equal to travel disutility elasticity^, namely, ?o) _ B^'^ = B Or At period t=2; ^ ( 2) [/( 2)' = e B x [/(')' + 5 X
X

b\\ _ Z ? 2,

b^2
&22

At period t?=2 the inflated disutility elasticity B^^^

49
Reoroduced with oermission of the coovriaht owner. Further reoroduction orohibited without oermission.

=EBx

/ [7^^)') + B

Also, the above equation can be extended to: Â«1*11 ^2^21
4 T = Ã1 X i n X

^1^12 ^2^22
/ up^') + in

4^21

^i;

^22

Similarly, ijp^ = 6 i Xi ,2 X ijP = gj ^ ^2! ^ / Â»P^*) + i (2 + ill

ijP = 6 2 ^ ^22 ^ (Â»2^' /wp^') + ij 2

5.2.3 Multi O-D Pairs and Multi-period Inflated Disutility Expression

More generally, consider the multi O-D pairs (I) and multi-period (T) transportation networks. Assume that there exists one origin and destination pair, and consider t =T transportation equilibrium with lag elasticity E and travel disutility elasticity B. The demand function can be stated as follows: D = v4-jB2.[/ or the matrix structure as: " ~ B
Â£ )(0

: ^ (n

- E'-^B E^-'B

.

B EB B

jy (0 [/(D

.

50
Reoroduced with oermission of the coovriaht owner. Further reoroduction orohibited without oermission.

If

. . . B

is set to be inflated disutility elasticity at periodt = \ . . . T , the demand

function can also be described as: -^ (0 Â£ ,( 0

=

-

B (0

Uio

Also, note that if the last decoupled iteration travel disutility is U*, then B E'~'B '^(T) Â·^(1) B (0 B (D At period t= l, and from above equation, the following is achieved: = ^ x [/(')' At period t = 1 the inflated disutility elasticity namely.
6 ,?

.

B EB B

uor A(n B
-

-

B (0

E^~'B

E'~^B

equal to travel disutility elasticity 5 ,

Â· b[P  4T

4T' = 4i A. 4/ 4,

Â· 4/ Â· 4/ Â· 4/_

= B Ox AT At period t = t.

 6T

51
R e o ro d u c e d w ith o e rm is s io n o f th e c o o v ria h t o w n e r. F u rth e r re o ro d u c tio n o ro h ib ite d w ith o u t o e rm is s io n .

j

X

-

E`~^BX

+

E`-^BX

+

... + B C / m

( I

At period t ~ t the inflated disutility elasticity B'^'^ BO) = X([/(')*/[/(')') + E `-^B X + ... + 5

The above equation can also be extended to consider one O-D pair, b[\ - ^ r ' Xbii X Similarly, 'X X{uj^* / wP") + X{uf^* / + ... + 6 .. lu[`''*) + e["% , X

5.3 Decoupled Projection Method for Multi-period Transportation Equilibrium Models with Time Lag Linear Demand

The multi-period with time lag effect and the linear demand function transportation problem can be formulated as a quadratic programming in the objective function with linear constraints nonlinear programming. As it was mentioned before, the projection method can be applied in solving single-period or multi-period transportation equilibrium problems without the time lag effect demand. Due to time lag effect in demand function exists, it could be difficult to compute the solution for the multi-period transportation equilibrium problems with time lag effect directly.

52

i

R e o ro d u c e d w ith o e rm is s io n o f th e c o o v ria h t o w n e r. F u rth e r re o ro d u c tio n o ro h ib ite d w ith o u t o e rm is s io n .

In this section, decoupled projection methods, such as projection method combined decoupling approach to solve the multi-period transportation equilibrium models with time lag effect will be discussed.

In essence, due to the time lag effect, the decoupled projection sub-model must be constructed so that the linear demands depend only on their current period prices through inflated disutility elasticity. As a result, an equilibrium solution o f the projection sub model can be calculated relatively easily with the original projection method at each iteration decoupled projection sub-models. This will give an approximate equilibrium solution of the decoupled projection sub-model. The new equilibrium solution is inserted back to adjust the next iteration inflated disutility elasticity. Thus, a new decoupled projection sub-model is established and can be solved by the original projection method, and so on. For the convergence verification, if the differences of demands between this iteration and the last iteration is less than or equal to a given tolerance which is small enough, then an equilibrium solution can be obtained for this transportation equilibrium models with time lag effect.

The decoupled projection method for transportation equilibrium models with time lag effect can be stated as the follow: Step 1. Initialization: Provide a starting feasible solution guess of travel disutility between each O-D pair, fort= 1, 2, 3, ...T; set the iteration index m =l, set the tolerances small enough.

53
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Step 2. Construct a sub-model without time lag effect in demand function. Using , and the results achieved from the last iteration of this decoupled projection

method, calculate current iteration inflated disutility elasticity,

Then, the transportation equilibrium problem with time lag effect is transferred to multi period linear demand equilibrium problem without time lag effect. Original projection method can be called to calculate the solution (the original projection method will be stated in the following). Step 3. Convergence test If k>

E = Max
1 6 /

< s.

a preset tolerance, then go to step 4, otherwise, increase the iteration index m = and go to the next iteration. Step 4. Terminate with D* = D ^,U* = U^.

The sub-procedure of decoupled projection method for transportation equilibrium models with time lag effect, namely, original projection method applied to multi-period linear demand transportation equilibrium models without time lag effect can be stated as follows: Step 1. Initialization: (Projection method)

54

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Provide a starting feasible solution guess of flow vector in each link, Fj;2o >and demand between each O-D pair, M = d D ~ \d )ld d . Step 2. Construct and compute; (Projection method) Using last iteration solution D^'_\ calculate current iteration constant factor and , set the iteration index n = l, calculate G = 9 C (/) / d f and

T^`'', construct objective function:

s
T

/=1

/=!

(=l

1 = 1

then call the nonlinear programming (NLP) solver to get current iteration solution aiidDl`\ Using U r= D -'(D W ) to calculate the current iteration ,

Step 3, Convergence test (Projection method) If

Ig L and

E = M ax ieL

------ < s ,

then go to step 4, otherwise, increase the iteration index n = n + 1, and go to next iteration. Step 4, Terminate with F* = F,, D* = , U* = . (Projection method)

55
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

5.4 Decoupled Relaxation Method for Multi-period Transportation Equilibrium Models with Time Lag Exponential Demand

In the last section, it was stated that the decoupled projection method can be used in solving multi-period with time lag effect hansportation models. By using exponential demand functions instead o f linear demand functions in the transportation equilibrium problem, G and M can be any diagonal positive definite matrices o f appropriate dimensions based on projection method. One could also set G and M to be the diagonal parts o f the Jacobian matrices \d d d f\ mÃ \du / dd \. Now, it is shown that matrix M is difficult to calculate from exponential structure demand functions. So the projection method is not available for the multi-period transportation equilibrium problem with time lag effect.

In this section, another iterative method, namely, relaxation method will be considered to be applied in solving transportation equilibrium problems with nonlinear demand functions. Like the projection method, the original relaxation method can be applied in solving the single-period or multi-period transportation equilibrium problems without time lag effect. It can also be difficult to compute the solution o f the multi-period transportation equilibrium problems with time lag effect directly. The decoupled relaxation method is generated for this reason, in which relaxation method is combined

56

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

with decoupling approach, and applied in solving the multi-period exponential structure demand function transportation equilibrium models with time lag effect.

Through "inflated disutility elasticity" the time lag effect is transferred to demands depending only on their current period travel disutility in each decoupled relaxation sub model. Original relaxation methods can be used to solve the multi-period nonlinear demand function structure without time lag effect at each iteration decoupled relaxation sub-models. This will give an approximate equilibrium solution o f the decoupled relaxation sub-model. The new equilibrium solution is inserted back to adjust the next iteration inflated disutility elasticity, a new decoupled relaxation sub-model is established and solved by the original relaxation method, and so on. If the difference of demands between this iteration and last iteration is less than or equal to a given tolerance which is small enough, then an equilibrium solution is obtained for transportation equilibrium models with time lag effect.

The decoupled relaxation method for transportation equilibrium models with time lag effect can be stated as follows: Step 1. Initialization: Provide a starting feasible solution guess of travel disutility between each O-D pair, , &Â»r t= 1,2, 3, ...T; set the iteration index m =l, set the tolerance g small enough. Step 2. Construct the decoupled relaxation method sub-model Using , results got from last decoupled projection method, calculate current iteration

inflated disutility elasticity.

57
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

b\p = e \ ` X

X

+ e\ ^by x

/ w^^*) + . . . + Ã¨^.

Then call the original relaxation method to calculate the solution. Step 3. Convergence test If

e = M a x'

<Â£.

then go to the step 4, otherwise, increase the iteration index m = m + l, and go to next iteration. Step 4. Terminate withD* = D^,U* = U^.

At each decoupled relaxation iteration, the original relaxation method can be used in solving o f nonlinear demand transportation equilibrium models with time lag effect The original relaxation method applied to multi-period nonlinear demand transportation equilibrium models without time lag effect can be stated as follows: Step 1. Initialization: (Relaxation method) Provide a starting feasible solution guess of flow vector in each link,jriO ^ between each O-D pair, , set the iteration index n = l. demand

Step 2. Construct and compute: (Relaxation method) Using last iteration solution,
c~i -- c (
^

, construct new time functions
/Â·(')
L ,n -\}

\

and new travel disutility functions

58
i l l lliiiiii Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

then call the NLP solver to compute the solution using the above travel time and travel disutility fiinctions, and Using

to calculate the current iteration

,

Step 3, Convergence test (Relaxation method) If

F = Max

<s

and . K '- % | E = Max--- i --77! --*  <s

then go to the step 4 otherwise, increase the iteration index n = n +1, and go to next iteration. Step 4, Terminate with F* = F,, D* = D,,,U* = . (Relaxationmethod)

59
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

CHAPTER 6 A NUMERICAL EXAMPLE

In this chapter the decoupled relaxation method will be applied to a numerical case of a small transportation network. In this example, time lag demand functions have exponential structure, and also the travel disutility interacts with each other in the demand. In order to have an overview of the procedure of developing such models and equilibrium seeking algorithms, formulations for two different types of transportation equilibrium, i.e., system-optimization and user-optimization will be illustrated.

6.1 The Structure of the Model

As a numerical case, the local transportation network system in a city will be modeled. In the local transportation network system of city Z, four major communities (A, E, U and Y) and a downtown area M exist. They are all connected by local main streets as shown in Figure 6.1. For simplification, it is assumed that all streets are one-way only and the single direction flows for people fi"om those four communities traveling to downtown for work each day was modeled. Base on this model, future demand will be predicted.

60 in il III III
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

The transportation network topology diagraph used in this example is shown in Figure
6 . 1.

Â© ------ KÂ£)

Figure 6.1: The transportation network topology

As shown in Figure 6.1, there are 25 nodes in this transportation network. Since there is only the transportation flow firom the four major communities to downtown area, there are 4 original-destination (O-D) pairs, RSam, RS em, RSum, RSym- Every edge in the graph is a `Link' and there are totally 40 links.

61
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

The variables will be used in this r i , si. fP
c-(l)

-

Flow in link / (where I ~ 1, 2, Flow in path p (wherep = 1, 2,

40) in period t (where t ~ l, 2 3)24) in period t (where t ~ l 2 3 ) -

Demand in O-D pair i (i = am, em, um, ym) in period t (where t ~ l 2 3)Travel disutility in O-D pair i (i = am, em, um, ym) in period t (wheie t = j);

2,

The parameters are defined as follows:

-

4 W x 2 4 n w Ã¼ rix o fm d m a k fv a rid fieÃ M Ã ^ Ã¼ d cn j# k % K h ,p )-

-

4x4Wn%Ã¼rixofmdhak,rvaridfieODT)pÃFfa&,ekÃ¼omAÃ¿,); square matrix of short-run travel disutility elasticity-

B

- 4 x 4 -

4x 4 square matrix of inflated disutility elasticity in period f 1x 4 matrix of short-run lag elasticity; Constant factors in demand equation i in period t; Discount rate.

E 4r

By observation, there are 6 paths for each O-D pair. The relationships between link and path for each O-D pair are:
P\ - { a

A A As} A , As) As) A A s Ao) A o A: s Ao) A o A g Ao) A 4 A

P i = (A A

RSam

p-i -- (a
Â·

Pa -- { a Ps = { a

p& - (a

62

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Pi Pi
A
R Se

-- {^4 --K -

4 4 4 43 43 4b 43

4r 46} 4z
A7

4e } 4 l} 4Ã©} 4 i} 4 i) 4 o1

{^4
(4

Pw = Pl2 Pii

4z 4?

P n = {k
{4

hi
4;

- {4 z

A 4 ~ {4 z

4b 4b 43 43 4b 4g 45 4s 4.

hi
4g 44

ho} h i}
4 o}

RSu

Pl5 = ihl Pi6 ~ {hi P\1 {4?

4@ 4s } 44 44 4s} 4 s}

Pis = [hi Pl9 -- {4 o P20 - ( 4 o
RSym

ho h i } he hi }
4o
45}

P21 -- (4 o P22 - [he P2S -- ihÃ¨ P2A -- {4 e

hi hi

he hi }
4z

hi 1

The demand functions are assumed as follows:
< '2
= X X X X (,, Â« )-* " X

= o ,, X (x2 r*" X rf.`2 = <

X X X

X X x

XÂ« : - Â» ) " X w i- Â» ) " x (rf""")"

X(Â«2)-*" X(Â«Â»>)-Â·"

= V X(Â«2 )-'" X( u Ã¯ Ã¯ r `Â«

Travel disutility elasticities are given as follows:
Z>ii =

1. 6

b,2 = - 0.4
6 2 2 = 1 .6 1 632 = 6 642 = -

6,3 = -

0.6

6,4 = 624 = -

0.5 0.4

62, = --0.3 63, = 64, = -

6 2 3 = --0.7 6 3 3 = 1 .6 2 643 = -

0.2 0.3

0.6 0.5

634 = --0.3 644 =

0.4

1.64

Lag elasticities:
63
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

;i

^.m=0.7

= 0.72

g.. =0.72

e^,,=0.75

Time functions on the links used in this model are given in Table 6.1
L ink
h h h u h k h h k ho lu lu lu lu lu hÃ´ lu lj8 ll9 ho lu 122 hs I24 I25 I26 hr hs hÃ§ ho h t hz I33 I34 I35 he hr hs I39 ho

y} + Ã+ fs + ,/i +

Q 69 o.^x/^ + 2 0 . J x / ; 4- j 0 .5 x/Ã¿ + j
0.4
x fg + 4

/^ + 0 .2 x /} + 4 /tf + 0 . 4 x f 2 + 1 f y + 0 .3 + 2
f s + O .I ^ fs + fÃ§ fio fu

5

+ 0 .3 x/^ 4- 1

+ 0. 2 x f i 4 + 2 + 0 .3 X/}, + 2 f ,2 + 0 . 4 x f i y + ] f i s + 0 .2 x f i i f 4- 4 f i 4 + 0 . 4 x f , f ) 4- 2 y}j + O .Jx/), + ;
f i f i

6

+

0.4 x

fi,

4- 2

fis + f i

7 4- 0 .2 X/}; 4 - 2 0 .4 x f j ^ 4 - 1
x fy if

9 + 0 .2

fio fs i fs

+

O .S x f^ g

4- 3 4- J

+ & 4 X&0 + 2

fs 3 fs

2 + 0.1 x f i + 5 + 0 .2 x f j g 4- 4 4 + 0 4 x6 , + 2

fis

+

0 .2 x f 4 + 4

fie + fr r

0.1

x fn fi

+

5

+ 0. 4 x

4- 2

&, + &2 x 6 7 Ã, + 0 J x 6 , f s o -h 0 .5 x f ^ f s i 4- 0.2 x f r

+ 2 + 2 4- 1 4- 3

.6 : + 0 .4 x 6 7 -h 2 f s 3 + 0 .4 x 6 g 4- 1 f s 4 + 0 . 5 x 6 , 4- 1 f s s 4- 0.3 x f g 4- 2

6f
fs r fs s fs

+ 0 .2 x 6 o 4 -2 + 0 .2x62 4- 2 4- 0 . 2 x 6 , 4- 1

9 + 0.2 x f s 4- 2 ,6 o 4- 0 . 4 x 6 rt4 -2

Table 6.1; Time functions for links 64

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

The discount rate: r = 0.05

In this model, a three period transportation equilibrium analyses was considered. Assume the demand equations are the constant elasticity type with time lag exponential structure. The travel disutilities interact in the demands equation according to travel disutility elasticity and lag elasticity.

From the system level, the minimum total time spent in this network must be achieved. This problem can be formulated as system-optimization. From user point of view, it will be modeled as user-optimization. Two type o f equilibrium models are illustrated below.

System-optimization can be formulated as: Objective function:
3 40 4

Minimize

z=
/= 1

x
1=1

x i f f x (1/(1 + r ) '}

S.t.
p= i 24

~

t = \,2,3

/ = !,...,40

^p,i X
p= \

^ = iff^

f = 1,2,3

i = am, em, um, ym

Non-negativity:

if f ) > 0 ;

65 /Â«.
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

User-optimization can be formulated as: Objective ftmction:
//'>

d

(< )

Minimize

z= /=!
24

d c o
/=1 0
1=1

j
0

(u )x rfujx (1/(1 + ?-)'}

S.t.
24

/ = 1,2,3

Z=1,...,40

^ Ap ,X
p=\

t = 1,2,3

i --am,em,um,ym

Non-negativity:

6.2 Decoupled Relaxation Method for the Solution of the Model

In the given conditions of this model, three periods were considered. Further, the demand functions are exponential structure with time lag effect, and the travel disutilities interact with each other in the demand functions.

Due to the time lag effect, the demands in the previous periods will influence demands in the current period. The general algorithms in urban transportation equilibrium cannot be used to solve the model directly since it required a travel disutility function o f demand.

66

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

i.e., D'^(d). But in this model, because o f the interaction of multi-periods' demand functions, D'^(d) cannot be achieved directly. Thus by adapting the decoupled method and using inflated disutility elasticities the demand functions can become function of current period travel disutility. After doing so, the relaxation method can be applied in each decoupled step to solve this model and get current calculated values. Next, these calculated values in decoupled process o f next step can be used. Finally, the results can be brought back into the relaxation method and the process repeated until an equilibrium state is reached in the system-optimization model: (i) the marginal travel disutility spent in each used path is less than or equal to the value on any unused path; (ii) in all used paths, the marginal travel disutility is the same, so the time spent in the whole system is minimized; In the user-optimization model: (i) the travel disutility spent in each used path is less than or equal to the value on any unused path; (ii) in all used paths, the travel disutility is the same, so users will spend same time no matter which path they choose.

In the real world, the travel disutility elasticities and lag elasticities usually would be obtained from regression of historical data via statistics. In this chapter, it was assumed that travel disutility elasticity b(ij) and lag elasticity e,- are known, and a set o f data assumed to be close to the statistics was used. The given historical data includes travel

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

disutility u at period t

0 and demand d at periods t -- 1 and t --0. The constant factors

a-i in demand functions are calculated from the given data by equation 6 . 1 ;
(6.1)

j=\

The demand functions can be described as a matrix notation: B
(1)

^ ( 2)

-

EE

B

(6.2)

2)(3)

E"B

EB

B

^(3)

Where the constant factor o f demand function

X

(6.3)

At each step o f decoupled algorithm, the demand functions without time lag effect are shown in the following matrix;
0

[/rO)

^ ( 2) =

^ ( 2) -

^( 2)

[/(")

(6.4)

2)0 )

^(3)

[ / ( 3)

Where

B^4

are 4x4 square matrices of the inflated travel disutility in period,

2, 3 calculate by equation (6.5)

68

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

n=l

Where U* is the equilibrium travel disutilities in the last decoupled iteration.

If system-optimization model is considered ,then at each decoupled step the form of each NLP solved at each iteration in relaxation method is the following:
40

/=1
4 4

t;'

^

9/;

1=1

(6 .6)

s.t.
24

/ = 1,2,3

/ = 1,...,40

i = 1,2,3 p=i Non-negativity:

i - am, em, um, ym

%M> 0 ;

> 0;

From user-optimization point at each decoupled step, the form of each NLP at each relaxation method is the following:

69
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Min
40

Z = j ] l / ( l + r y x [ ( ^ l /2 ' 1=1 /=!
/=1

( ,)

2

u, ;

-, .V

,

M

(6.6)
S.t. p= i
24

t = 1,2,3

I = 1,...,40

z 4 ., P=1
Non-negativity:

t = 1,2,3

/ = am, em, um, ym

Both system-optimization and user-optimization are formulated and solved separately by decoupled relaxation method implemented by the GAMS. The computation results are discussed in the next subsection. The flowchart o f the algorithm is shown in Figure 6.2

70

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Deftne Â«efts ÃTime. Link. Path. OD pair)

Deftne indices I T l, ITS

Define dal* tables VO. C M . JX 2 V I0 . CN. G

Define dala R. BB. E, UO, U l. U2. UV, DDD, D P I , P I , D2. FD. F I

Calculate AO. AA, B P . DR

Define decision variables Z, F. P . X

Define equations OBJ. C O N l. COM2

Formulate e<iu*tions OBJ. COMl. COM3

Define bounds on vsriables D. F

Define GAMS options

loafin* d m lmMERRl. M EJRR2. BRRl. SRR2. TI.

Initialize MERRl wilhi a value larger than specified tolerance

B egizx Decoupling Algoritbm witli IT l -- 1

MERRl > to lsa n c e 7

Initialize MERR3 w ith a value larger than specified tolerance

Begin Relaxaition Algotilbm with IT2 -- 1

MERR2 > tolerance 7

UV

calculate ERR2 with cost disutility, demand and flow in each link

SÂ«tM ERR3 Â«quai to

F I - F . P . D 2 - D .D . U 2 -- UV

IT2 - IT2

Reset MERRI--0

calculate ERRl with cost disutility and demand

S slM E R R l Â«quel to

FI -- F.L. D1 - D.2. U l - U2

MAXITER7

Define output

Figure 6.2: Algorithm flowchart

71
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

6.3 Calculation Results
In the following, the above numerical examples computational results are summarized. Tables 6.2 and 6.3 show decoupled relaxation iterative information. For the two type transportation equilibrium cases with time lag effect, this test model involves 207 decision variables and 135 single equations. The model was solved from a "cold start" with initial estimates o f demands and travel disutilities. Both of this test models need only, six for system-optimization and four for user-optimization decoupled iterations to converge. For system-optimization, total 2428 nonlinear programming were solved to get the optimal solution. And total 1522 nonlinear programming were solved to get the optimal solutions for user-optimization. It is interesting to notice that most nonlinear programming iterations, 58% of NLP iterations for system-optimization and 75% of NLP iteration for user-optimization are finished in the first decoupled step. Only 42% of NLP iterations for system-optimization and 25% of NLP iteration are used to calculate the equilibrium solutions during the following decoupled steps. This means, for this simple model, the decoupled relaxation method converges well in the following decoupled steps. This indicated that the decoupled relaxation method is a useful approach to solve multi period transportation equilibrium models with time lag demand. Tables 6.2 and 6.3 illustrate the number o f interactions for two type's equilibria.

72
III !' Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Decoupled Iteration

Relaxation Iteration
1 2

No. of NLP Iteration

Total No. NLP

3 4 5
6 1

482 160 108 97 94
88

7
8

73
69

1410

9
10 11 12

53 42 33 37
38

13 14
1 2

36
83 88

75 64 50 ' 2 537 6 35 7 37 8 37 9 36 10 32 1 47 2 48 3 32 3 Zjo 4 40 5 34 6 37 1 37 4 105 2 36 3 32 1 37 7H 5 /U 2 33 1 34 6 Oo 2 34 Table 6.2: System-optimization computing iteration information

3 4 5

73
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Decoupled Iteration

Relaxation Iteration
1 2

3 4 5
1 6

No. of NLP Iteration 606 118 90 81
68

Total No. NLP

53 1212 39 7 8 32 31 9 10 33 11 30 31 12 1 58 2 30 157 2 3 35 4 34 24 1 3 89 2 31 34 3 32 1 04 4 32 2 Table 6.3 User-optimization computing iteration information Tables 6.4 and 6.5 illustrate the final computational results in the cases of systemoptimization and user-optimization: flow in each link, travel disutility and demand in each O-D pair. From Table 6.4, all paths in this system that are used and at each period t
a (0 can be seen. Further, marginal times c, spent at all paths in each O-D pair are the same

and equal to the marginal travel disutility Â», . Thus, when the network achieves systemoptimization, the accompanying solutions are optimal solutions. Table 6.5 also displays the adjustment of demands in four communities for all three periods. Since there is the time lag effect in demand function, the current demands partly depend on demands firom

74

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

previous periods. Demands in period t = 1 will be influenced to a great extend by the demand in period t --0. For example, demands for O-D pair AM at period t = 0 was assumed to be equal to 22. Since the demand is relatively large compared to the road capacity between this O-D pair, congestion will occur more frequently than expected, it will then take longer time to travel on the path. At the next period, namely at t = i, when people notice such information, they will switch to different paths to shorten their travel time or even move to a different community in the future in order to save their travel time. So the travel demand between this O-D pair will decrease. When the network achieves system-optimization, the demand for O-D pair AM is adjusted automatically to 15.509. Table 6 . 6 and Table 6.7 show how demands changes for four O-D pairs under system-optimization and user-optimization separately.

fl f2 f3 U fs f6 f? fs f9 fio fn fl2 fl3 fl4
fl5

fl6
fl7

fl8 f|9 fro

t-1 t=3 t=l t =2 tp=2 7.69 6^58 17.53 16.74 6 .6 fri 2j&4 1.841 1.687 6.924 6 .6 6 frz 4.108 4.113 4.189 2.007 1.995 frs 8.466 8 .8CJ 4.866 4.791 8.458 fr4 7.818 6.945 6.665 15.853 15.091 frs 5.406 5.018 4.914 5.729 5.649 fro 6.392 5.954 5.875 3.344 3.461 frv 4.728 4.352 4.269 3.651 3.337 frs 9.814 9.24 9.122 2.954 3.359 fr9 4.286 3.845 3.733 5.983 5.875 fro 4.048 3.627 3.525 6.54 6.443 frl 6.084 5.964 6.028 5.658 5.331 fo2 6.234 6.042 6.065 4.575 4.409 fr3 3.533 3.1 2.931 6.51 6.262 fr4 5.644 5.236 5.122 5.172 5.082 frs 16.524 15.544 15.428 9.883 9.904 fre 4.877 4.431 4.307 5.89 5.38 fr? 3.58 3.198 3.057 1.315 0.971 frs 5.54 5.095 5.023 5.195 5.291 fro 16.051 15.122 15.026 10.367 10.373 fio Table 6.4 System-optimization flow in each link results

t=3 16.743 6.684 2.092 4.88 15.11 5.752 3.627 3.287 2.865 5.945 6.531 5.379 4.458 6.3 5.166 10.158 5.325 0.867 5.433 10.599

75
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Solutions for user-optimization are summarized in Tables 6.5 t=l 10.319 2.989 5.636 11.749 9.939 7.33 8.624 6.113 13.995 6.045 5.724 9.235 9.632 3.894 7.651 23.584 6.51 4.363 t=3 t= 2 t= 2 t=l 26.625 9.996 25.849 10.057 fsi 2.533 9.6 2.649 9.978 fs2 6.305 6.105 4.095 4.206 fss 12.587 7.94 12.319 8.264 fs4 9.748 9.723 23.035 23.692 fs5 7.408 7.464 9.74 10.158 fs6 8.754 8.838 5.236 5.752 fs? 6.281 5.177 6.214 5.091 fs8 14.268 14.419 5.144 4.972 fs9 5.903 5.926 8.193 8.721 fso 5.569 5.528 11.098 10.459 fsi 10.008 9.767 9.272 9.298 fss 10.234 10.042 7.906 8.145 fss 3.822 3.82 9.698 9.999 fs4 7J65 7.474 7.839 7.78 fs5 24.089 24.373 15.695 16.85 fs6 6.49 6j08 9.904 9.64 fs7 4.226 4.185 1.998 1.495 fs8 8.029 8.075 7.7 8.504 fs9 24.058 24.325 23.579 16.284 15.174 fio Table 6.5 User-optimization flow in each link results
t = l

fl f2 fs f4 f5 fe f? fg fg fio fll fl2 fis fl4 fl5 fl6 fn fis fl9 fso

t=3 27.023 10.163 4.255 8.41 24.036 10.353 5.978 5.07 4.922 8.965 11.392 9.326 8.261 10.15 7.925 17.37 9.552 1.29 8.859 16.784

dam dem dum dym
A

15.509 18.65 11.548 20.25 81.546 92.887 74.009 94.097 81.546 92.887 74.009

t= 2 13.804 17.706 10.711 20.277 75.581 88.628 70.051 92.176 75.581 88.628 70.051

t=3 13.265 17.58 10.704 20.757 74.192 88.204 69.916 93.187 74.192 88.204 69.916

W am
A

W em
A

W um
A

^ vm
A

Cam
A

Cem Cum
A

94.097 92.176 Cym 93.187 Table 6 .6 System-optimization demand, marginal travel disutility and marginal time in each O-D pair results

76

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

t=l
dam 2 0 .2 5 8

dem
dum dym

U am U em U ym U ym
Cam Cem Cum Cym

25.744 19.176 30.869 63.49 74.507 63.54 78.922 63.49 74.507 63.54
7 8 .9 2 2

t=2 19.805 26.588 18.938 33.134
6 3 .5 4 1

t=3 19.72 27.005
1 8 .8 7 7

34.155 63.776
7 7 .3 8 3 6 4 .2 8 8 8 4 .1 7 4 6 3 .7 7 6 7 7 .3 8 3 64288 8 4 .1 7 4

76.409 63.967 82.5
6 3 .5 4 1

76.409
6 3 .9 6 7 8 2 .5

Table 6.7 User-optimization demand, trave: disutility and time in each O-D pair results

According to Tables

6 .6

and 6.7, we can predict the demand changes in the next three

periods. For example, in table 6.7, it shown the numbers of residences lived in community A will decrease for 20.258 in period one to 19.72 in period three. And the demand in community E will increase firom 25.744 to 27.005 in next three periods.

77
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

1'

CHAPTER 7 SUMMARY

In this thesis, the GDL equilibrinm approach was employed to different types of transportation equilibrium models, i.e., single-period and multi-period models without time lag effect, and multi-period models with time lag effect. And exponential structure expression of GDL was introduced into demand functions instead of linear demand function to illustrate i.e., the effect of past travel time on current travel demands. Two types of transportation equilibrium models were mathematically presented to study system-optimized and user-optimized behavior on travelers o f the urban transportation networks.

The projection method and relaxation method are general tools which can be used to calculate the equilibrium solution in single-period transportation equilibrium models. Consider multi-period transportation equilibrium models with the time lag effect, using projection method and relaxation method to solve such model directly may be difficult to converge. Based on the decoupling principle, the modified iterative methods, called decoupled projection or decoupled relaxation method, was used to solve multi-period transportation equilibrium models. Four examples were solved by applying decoupled projection in multi-period time lag linear demand and decoupled relaxation in multi-

78

! Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

period time lag exponential demand. Appendix B illustrates four multi-period transportation equilibrium test models and their computational results. More numerical test models can be found in the manual (Wu, 2003). The GAMS was used to calculate the optimal solution and investigate the computational behavior of transportation equilibrium algorithm.

7.1 Contribution

In this thesis, main contributions can be summarized as follows;

1. Introduction of multi-period GDL structure into transportation equilibrium models. 2. Introduction of different expressions of demand functions: linear structure demand with cross effect of travel disutility, exponential structure demand with cross effect of travel disutility. 3. Modification and implementation of the decoupling algorithm to solve multi period transportation GDL equilibrium models.

7.2 Future Research

With limited empirical investigations on the test models, it is interesting to notice that the decoupled projection method and decoupled relaxation method converge well for the test

79
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

efficient methods for multi-period transportation equilibrium models in long-term transportation planning and urban development.

80

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Appendix A Single-Period Transportation Equilibrium Models

81
h
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

For the single-period transportation network equilibrinm problems and optimal solution algorithms, eight test examples were tested in which different types of transportation network problems were included. The types of these examples are summarized in Table A .l:
Example Fixed demand Y Y Y Y Y Y Y Y Y Y Y Y Y Y Variable demand Time cross effect No time cross effect Y Y Path = link? Y Y Y N N N N. N

1 2 3 4 5 6 7 8

Table A. 1; Type of examples For each example, based on the network topology diagraph, time and demand functions or travel disutility functions, mathematical formulations were given in two forms: Â· system-optimization and user-optimization. Projection method was also applied in the examples. Programming code in GAMS was also developed to get the solution for those examples. In the end of each example, a table of the optimal solution was summarized.

Example 1: Fixed demand function (Path = Link) (1)

a

Figure A .l Example 1 network topology

82

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Time functions: Ca(/) = 2 x / ^ + 5

Demand functions:
d, = 10

The solution will be illustrated in two cases for the system-optimization model and the user-optimization model respectively. Case I: System-optimization model. Min z = ^ c , ( / ; ) x y ; = (2 x / , - h 5 ) x y ; + ( / , + i o ) x y ;
l=a^b

s.t.

Xi+jC2 = 1 0 ;
fa ~ ^1'

A = ^2; A .A ^ 0; x,,x2 > 0; Applying the projection method, the final results are summarized in Table A.2:
Iteration 0
fa fb Ca Cb

2

8

9
Cl

13 1
fa fb

18 6 26
Cb

c, 9 c,
13

C2 18 C2

Z

26
C2 15.833

c,
13.334 Cj 21.667

4.167

5.833

13.334
C]

21.667 2
fa fb

15.833 Ã 2 21.667
Cb

c,
21.667

Z 147.917

c,
13.334 Cl 21.667

Q
15.833

4.167

5J83

13.334
Cl

15.833
C2

6
21.667

21.667

21.667

Z 147.917

Table A.2: System-optimization results of example 1

83
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Case II; User-optimization model Min
fl. A Z = ^ jc,(ty)<iÃ»7 = J(2x(2>+5)io+ ^{co-\-\Ã))dcÃ» l= a,bO 0 0

S.t.
fa fb

=10;
~ ^ a 'i ~ j

A .A ^O ; Xa,Xi, >0 ; Applying the projection method, the final results are summarized in Table A.3: Iteration
0 1 2
fa
2

fb

Ca

Cb

c,
9

8
fb

9
Ca

18
Cb

fa

c, 5 15 15 5 15 c, Ca Cb fa fb 15 15 5 5 15 Table A.3: User-optimization results of example 1

Q 18 Q 15 Q 15..

Z
Z

112.5 Z 112.5

Example 2: Fixed demand function (Path=Link) (2)

a

Figure A.2 Example 2 network topology Time functions: Ca(/) = 2 x / ^ +5 Cbif) = fb +8
C c (/) = 1 .5 x f + 5

84

Reproduced with permission o f the copyright owner. Further reproduction prohibited without permission.

Demand functions:
=

10

The solution will be illustrated in two cases for the system-optimization model and the user-optimization model respectively. Case I: System-optimization model.

Min

z = %]c,(y;)xy)=(2xy;4.s)x/,4.(/;,+8)xy;-H(i.5xy; + 5)x/;
l=a,b,c

S.t.

X j + jCj+X3 = 10;

fb ~

^2

> ^ 0; >0;

Applying the projection method, the final results are summarized in Table A.4; Iteration
0
fa

2

1

2.654

2

fo 2.654

Cl 9 Cl Cl Cl 13 13 14 20 Cl f c Ca Cc Cb A 3.808 3.538 10.308 11.808 10.307 10.308 Cl Cl Cl Cl 15.615 15.615 15.615 15.615 Cl C c Ca Cb A A 3.808 3.538 10.308 11.808 10.307 10.308 Cl Cl Cl Cl 15.615 15.615 15.615 15.615 Table A.4: System-optimization results of example 2
A A Cb

3

5

9

11

C c 12.5 C 3

Cl
11
Q

Cl 12.5 Cl
20

Z

14
Q

Z Ci 11.808 10.307 108.79 Cl Q 15.615 15.615 Ci Z Q 11.808 10.307 108.79 Ci C; 15.615 15.615

Case II: User-optimization model.

85
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

4

Min

Z= ^
l=a,b,c 0

J(2xÂ£Ã¼ + 5 ) ( i 0 + j((Â» + 8 ) J 0 + J ( 1 .5 x 0 + 5)jÂ£y
0 0 0

S.t.

Xi+X2+X3=10;
fa fb

= ^2 Â»

/ : = :^ ; x,,X2,X3 > 0; Applying the projection method, the final results are summarized in Table A.5
Iteration 0 1 2

f 2
fa

fb

fc

Ca

Cb

Ca

3

5
fc

9
Ca

c,
L

C 2
11 C, 11

Q
12.5 Q 11

z z
84.5
Z

11
Cb

12.5
Ca

f
3

C,
11

9

3

4

11

11

11

f
3

Cl Cb Cc fc 4 11 11 3 11 11 Table A.5; User-optiinization results o f example 2

C2
11

Q
11

84.5

Example 3; Fixed demand function (Path = Link)

Figure A.3 Example 3 network topology

Time fiinctions: = 5x/,,+ /^+ 5 Cj = 1 0 x /^ + 5 x / ^ + 5 = 1 0 x /^ + 5 x /^ + lI0 = 5 x / , + 2 x / ^ +150

c, = 4 x / ^ + 3 x /^+ 10

86

Reproduced with permission of the copyright owner. Further rep.oduction prohibited without permission.

Demand functions:
c^i = 10 =10

The solution will be illustrated in two cases for the system-optimization model and the user-optimization model respectively. Case I: System-optimization model. Min

Z= E^,(/:)'</=(5x/,+/:,+5)x/,+(10x/,4-5x/,+5)xy;,+
l=a,b,c,d,e

(iOx/:,+5xy;+iio)xy; + (5xy:,+2xy;-n50)xy;+(4xy;4-3x/;+io)xy;
q x. + x . + x , =10; Xj+Xrf=10;
fa f b -- ^3 Â» fc fd ~ ^4 ' fe - ^5:

>0;

Applying the projection method, the final results are summarized in Table A.6:

;
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Iteration 0

fb

fa

.

fd

fc

Z

10
Ca

0
Cb

0
Cc

5
Cd

5
Cc

60 c, 60
Ca

30 C2 30
Cb

135 Q 135
Cc

195 Q 195
Cd

30 Q 30
Cc

110 c, 110 1
fa

30 Q 30
fb

135 Q 135
fa

220 Q 220
fd

50 Q 50
fe

7.333 41.665 c, 41.665
Ca

2.667
Cb

0 160 Q 160
Cc

0
Cd

10
Cc

Z 993.333

31.670 C2 31.670
'Cb

164.666 Q 164.666
Cd

50 Cs 50
Ce

78.33

c,
78.33 2
fa

58.340 C2 58.340
fb

160 Q 160
fa

164.666 Q 164.666
fd

90 Q 90 /. 10
Cc

6.667
Ca

3.333
Cb

0
Cc

0
Cd

Z 883.333

38.335 c, 38.335
Ca

38.330 Q 38.330
Cb

160 Q 160
Cc

163.334 Q 163.334
Cd

50 Cj 50
Cc

71.660 160 71.66 163.334 90 Cj c, C5 C2 Q 71.660 71.660 160 163.334 90 Table A.6: System-optimization results o f examples

Case II: User-optimization model. Min
f, fa fb

Z=

'Y j

^Ci{cÃ»)dÃ») = j{5'x.CÃ¹ + fj+ S )d c Ã¹ + ^ { ] .Q 'x .Ã» )^ + 5 y .f^ + 5 ) d c Ã» +
0 0

I^a,b,c,d,e 0

j(10xty + 5x

^ +\\Ã)dcÃ»+ J(5xty + 2x

+150)iÂ£O+ j(4xiy^ -t-3x

+\Q)dÃ»)

88

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

S.t.

X , +x, =10; ^ ' X 4 +X5 = 1 0 ; fa =^,; A --^3* / : = ^ 3;
fd

" ^4 5

f e " ^55

^1 ? ^2) ^3 3^4 5^ 5

"

^5

Applying the projection method, the final results are summarized in Table A.7
Iteration 0
fa Ã fc fd

10 60
Cl

0
Cb

0
Cc

5
Cd

60 1
fa

30 C2 30
Ã

135 c, 135
fc

195 Q 195
fd

,/Ãª 5 C e 30 C5 30 ,/Ãª 10 C e 50 Q 50 fe 10
Ce

Z

8
Ca

2
Cb

0
Cc

0
Cd

Z 620

45
Cl

25
C2

45 2
fa

25
Ã

160 Q 160
fc

166 Q 166
fd

6.667 38.330
Cl

3.333
Cb

0 160
Cs

0
Cd

Z 516.667

38.330

38.330 Q 38.330

160

163.333 Q 163.333

50 C5 50

Table A.7: User-optimization results of example 3 Example 4: Fixed demand function (Path ^ Link)

89
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

0
Â©
Figure A.4 Example 4 network topology Time functions; Ca = 5 x / ^ + 2 x / j +5
C& =

7X

+ / , +5

Demand functions:

d , =10
The solution will be illustrated in two cases for the system-optimization model and the user-optimization model respectively. Case I: System-optimization model. Min
I;<^iW ) x / . = < 5 x / . + 2 x A + 5 ) x / ,, + ( 7 x / . + / . + 5 ) x A + ( 3 x / , + / , + / . + 7 ) x / ,
l=a,b,c

S.t.

X,+X2=10;
fa fb - ^2)

^ 0; x,,%2 ^ 0 ; Applying the projection method, the final results are summarized in Table A.8

90

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Iteration. 0

fn

Ã

/c

z

4
Ca

6
Ch

10
Cc

37

c,
Ca

84 57 1

51 C2 98
Cb

47
Cc

C l
fa

134 5.5
Ca

93 C, 170 f. 4.5
Cb

77 fc 10 C c 47 z 897

41.5 c, 88.5
Ca

42 Q 89
Ch

Cc

69

c, 146
2
fa

73.5 C2 150.5
fb

77 z 886.828

fc

5.688
Ca

4.312
Cb

10
Cc

42.064

c, 89.064
Ca

40.872 Q 87.872
Cb

47

Cc

70.504 C; 147.504 3
fa

71.056 c, 148.056
fb

77 z 885.497

fc

5.711 42.133

4.289
Ch

10
Cc

c,
Ca

89.133 70.688

40.734 c. 87.734
Cb

47

Cc

c,
fa

147.7 4 5.714 42.142

70.757 c. 147.757 /; 4.286
Ch

77 z 885.33

fc

10
Cc

c,
Ca

89.142 70.714

40.716 c, 87.716
Cb

47

Cc

c,

70.715

147.7 147.715 Table A.8: System-optimization results of example 4

C 2

77

91
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Case II: User-optimization model. Min
f, L

4
0

4
0

Z=

jci(o))dÃ»)= j(5xÃ»),,+2xfi^+5)dÃ»)+^(7xco + f^+5)Ã¢ Ã»)+j(3 xÃ»)^ + f ^ + f h + l ) d Ã» )
l=a,b,c 0 0

S.t.

Xi+X2=10;
fa

fb = ^ 2,
fo
= ^ 1 + ^ 2;

Applying the projection method, the final results are summarized in Table A.9

92

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Iteration 0

ft

4
Cq

6

/c

z

10
Ce

Cb

37

c,
84 Iteration 1
fa

51
Q

47 z 10
Ce

98
ft

5.167
Cq

4.833
Cb

5 9 9 .8 3 3

40.5

c,
fa

8T 5

44 Q 91
ft

47 z 592.906

Iteration 2

/c

5 .4 5 8
Cq

4.542
Cb

10
Ce

41.375

4 2 .2 5
C2

47

c,
Iteration 3 88.375 /. 5.531
Ca

89.25
ft
/c

4.469
Cb

10
Ce

z 591.015

41.594

c,
/ .

41.812
Q

47 z
5 9 0 .5 3 2

88.594 Iteration 4 5.549
Ca

88.812
ft
/ .

4.451
Cb

10
Ce

41.648

c,

41.703
Q

47 z
5 9 0 .4 1 1

8 8 .6 4 8

88.703
ft
/ .

Iteration 5

fa

5.554 41.662

4.446
Cb

10
Ce

c,

41.676
G

47 z 590.381

88.662 Iteration 6
fa

88.676
./Ã /c

5.555 41.666

4.445
Cb

10
Ce

41.666
G

c,

47

88.666 88.666 Table A.9: User-optimization results of example 4

93

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Example 5; Variable demand function (Path ^ Link) (1)

Figure A.5 Example 5 network topology Time functions: C \= =/i +1 ^3 = /s + 2 C4 = / ,
+1

Demand functions: (f, = 4 - 1 / 7 Â» , =7 -- 1/ 6Â»2

The solution will be illustrated in two cases for the system-optimization model and the user-optimization model respectively. Case I: System-optimization model. Min
Z = Ã
/=1

=, ( / , ) X

- Ã
1=1

" , Â« ) X rf, = ( / , . + 1 ) X y ; + ( / j + 2 ) X / , + ( / j + 2 ) X / j + ( / . + 1 ) X / .

 (28 -- 4 X(/, ) XÃ¹f, --(42 -- 6X

^ ^2

S.t.

Xj+Z; =(/,; "FX ^ = r/2 >

94

llWlilii
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

y;

A = ^3 + ^ 4 ; /3 =Xi+Xa; f^=x^+x^\ A A A /;^o ; ^15 ^ 2 ) ^3 5^4 ^ 0 , c?i Ã»?2 ^ 0; Applying the projection method, the final results are summarized in Table A. 10 Iteration 0 fj 3 C l
4 Cl 8

_ f2 2 C 2
4 C2 8

f2 2 C s
4 Cs 8

f4 3 C 4
4

dl 3

d2
2

Z

C4 8
Ã4

Cl
1 Cl

C 2
6 C2
...

C s
6 Cs

7
C4 Z

Iteration 1

13 14 12 13 dl fj fs /4 d2 f2 1.354 2.476 1.665 2.476 2.165 1.354 C/ U l C 2 C s U 2 C 4 2.354 4.476 3.665 12.282 3.165 9.038 c, C2 Cs Q 6.019 5.519 8.141 7.641 Cl C 2 C s C 4 3.708 6.952 5.33 5.33 C; C2 Q C4 9.038 9.038 12.282 12.282 Table A.IO; System-optimization results of example 5

-65.063

Case II: User-optimization model. Min

 Z "= ^
i= \
dl

2

ju ^ ^ (v)do

= j(Ã») + Ã¯)dÃ») + j(Ã»? + 2)dÃ») +
0 1 0

^ (0 3

Â·+2)dÃ») +

+ Ã¯)dÃ»)

0

'=1 0
d2

-- ^(28 --4 x u')dv -- J(42 --6xu)c/Ã¼

95
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

s.t.

X j + ^ 2 =<3?i;
X 3 +X4 f\ = .^1 + 5 = X3 + x^] / 3 =X, +X3 ; f ^ = X 2 +x^;  ^I3^ 2 > * ^ 33"^4 ~ ^3 > 0;

Applying the projection method, the final results are summarized in Table A. 11 Iteration 0 dl ds /4 3 2 3 C2 C; C3 C 4 4 4 4 4 C, C2 Cs C4 8 8 8 8 dl d2 ./4 f, fs 7S 4.953 3.331 4.331 2.709 4.953 2.709 Cl U 2 Cs C 4 C2 M ; 5.331 9.04 12.284 6.953 5.331 3.709 Cl 2 Q Q 12.284 9.04 12.284 9.04 Tab e A. 11: User-optimization Resu ts of example 5 ./} 3 fi 2 fs 2 Z

Iteration 1

Z -130.126

Example 6: Variable demand function (Path

Link) (2)

Figure A.6 Example 6 network topology

96
I

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Time functions: Ca = 5 x / ,, + 2 x / ^ +5 C 6 = 7 x y ^ + _ /^ + 5

Ca=3x/;+y;+y;,4.7
Travel disutility function:
M[ = 9 9 -- 2 X c/j

The solution will be illustrated in two cases for the system-optimization model and the user-optimization model respectively. Case I; System-optimization model. Min
Z= c,(/)x/;-^M,.(c;)xJ, = ( 5 x / . + 2 x / j + 5 ) x / , + ( 7 x / j , + / ^ + 5 ) x / f t +

/=o,6,c

1= 1

(3xy:+y;+y;+7)xy;-(99-2x^,)x<f,
s.t.
x ^ + X 2 = d{, fa=x,; f b =X2l fc=X^

A A / L ^ 0; - O i d,^0; Applying the projection method, the final results are summarized in Table A. 12

97
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Iteration 0

fa

/c

4
Ca

4
Cb

8
Cc

dl 8

Z

33

c, 12
Ca

37 Q 76
Cb

39

Cc

53

c,
116 1
fa

65 c. 128 /6 2.079
Cb

63

A

d, 589

Z

2.511
Ca

4.589 1
Cc

167.084

21.713

c,
47.07
Ca

34.268 c, 73.392 2
fa

22.064 Q 47.421 . 4 36.617 Q 75.741 A 2T22
Cb

25.357

Cc

39.124

A

d, 4.947

Z

2.825
Ca

4.947
Cc

193.787

23.369

c,
50.157
Ca

22.679 c. 49.467
Cb

26.788

Cc

37.494

c,
3 79.123 /. 2.829
Ca

37.533 Q 79.162 A 2.122
Cb

41.629 d, 4.952

A

Z 194.145

4.952
Cc

23.389

c,
50.196
Ca

22.683 Q 49.49
Cb

26.807

Cc

37.537 41.663 C; c, 79.2 79.2 Table A. 12: System-optimization results of example 6 37.534

98

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Case II: User-optimization model. Min
ft fa fb

Z= ^

J c,(Â£Ã¼ )c/Ã» )-^

|(5xffl + 2 x /j,+ 5 ) c /t y + j( 7 x ty + / ^ +5)Ã»?o +

/= K ii,c 0 M0 0 /. d\ |(3xfl} + + f^+l)dco~ j(9 9-2xu)du
0 0

0

s.t.

X ,+
f a -- ^1) fb " ^2 5

;

f , ^X^+X^\ A .A /L ^ 0 ; x,,X2 >0;

d , > 0;
Applying the projection method, the final results are summarized in Table A. 13

99
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Iteration 0

.Ã

fb

dl

Z

4
Ca

4
Cb

8
Cc

8

33
Cj

72 1
fa

37 Q 76
fb

39

fc

dl

Z

5.021
Ca

4.158
Cb

9.179
Cc

9.179

334.168

38.421
Cl

82.137 2
fa

39.127 C2 82.843
fb

43.716

fc 8 .9 5 3 Cc

dl

Z

4.948
Ca

4.005
Cb

8.953

317.739

37.75
Cl

80.562 3
fa

37.983 Q 80.795
fb

42.812

fc

dl

^

z 321.581

4.999 38.011
Cl

4.008
Cb

9.008
Cc

9.008

81.042 4
fa

38.055 Q 81.086
fb

43.031

fc 8498 Cc

dl 8 .9 9 8

Z

4.997
Ca

4.001
Cb

320.846

37.987
Cl

80.979 5
fa

38.004 Q 80.996
fb

42.992

5
Ca 38 Cl

4
Cb

fc 9 Cc

dl 9

Z

-321

38 Q
..
.8 1

43

81

Table A. 13: User-optimization results o f example 6

100

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Example 7; Fixed demand function (Path ^ Link)

Figure A.7 Example 7 network topology Time functions: Ca = /a + 5 Cj = 2x /"j +10

Travel disutility fimction:
M j = 100

The solution will be illustrated in two cases for the system-optimization model and the user-optimization model respectively. Case I: System-optimization model. M inZ = Yu
l= a,b,c

> <// = (/a + 5) X / , + (2 X/^ +10) X/ j + (/^ +15) x

S.t.

X,+X2=100; fa =^i;
fb --

f c = ^ \ +^z; A A /L ^0; x,,X2 >0; Applying the projection method, the final results are summarized in Table A. 14

101
Reproduced with permission of the copyrig, ;t owner. Further reproduction prohibited without permission.

Iteration 0 "

fa

fb

fc

Z

40
Ca

60
Cb

100
Cc

45
Cl

160
Ca

130 c. 245
Cb

115

Cc

85
Cl

300 1
fa

250 c, 465
fb

215

fc

67.5
Ca

32.5
Cb

100
Cc

z 18831.25

72.5 c, 187.5
Ca

75 G 190
Cb

115

Cc

140
Cl

140
G

215

355 355 Table A. 14: System-optimization results of example 7

Case II: User-optimization model. Min

Z

4 .

fa

ft,

]((^ + 5)dÃ¼}+ \(2x(-o + lQ)dÃ»)-\- ](a> + l5)d<v
0 0 0 n

S.t.
fa fb fc

+%2 =100;
-- --U i = 4 +^2i

A. A ./: ^ 0;
X ,,x , > 0 ;

Applying the projection method, the final results are summarized in Table A. 15

102

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Iteration 0

fa

fb

fc

Z

40
Ca

60
Cb

100
Cc

45
Cl

130 Q

115

160 1
fa

245
fb fc

z
10495.83

68.333
Ca

31.667
Cb

100
Cc

115 c, 188.333 188.334 Table A. .5: User-optimization results of example 7

73.333

73.334

c,

Example 8; Variable demand function (Path

Link)

Figure A.8 Example 8 netu'ork topology

Time functions: c. = / , + 5 C j= 2 x j^ + 1 0

Travel disutility function:
U[ --99 --2 X

The solution will be illustrated in two cases for the system-optimization model and the user-optimization model respectively.

103
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Case I; System-optimization model. z = X ^ < M ) x . ^ - Z ".-W)x`' . = ( / . + 5 ) x / , + ( 2 x / . + 1 0 ) x / , + a + 1 5 ) x / ,
M .U 1 l^a,b,c

1 = 1

- ( 9 9 - 2 X <i, ) X (i,

S.t.

x^+X2=d^\

fb - ^ 2 '

_/;=%,+%z; x,,X2 >0;

Applying the projection method, the final results are summarized in Table A. 16 Iteration
0
fa fb _ Ic

Z

40
Ca

60
Cb

100
Cc

45
Cl

130

115

160
Ca

Q 245
Cb Cc

85

c,
300 1
fa

250 C:

215

465
fb fc

Z

67.5
Ca

32.5
Cb

100
Cc

18831.25

72.5
Cl

75 C:

115

187.5
Ca

190
Cb Cc

140

140

215

c,

c.

355 355 Table A. 16: System-optimization results of example 8

104

Reproduced with permission of the copyright owner, hurther reproduction prohibited without permission.

Case II; User-optimization model. Min f, ft,
Z = ^

% 1=1

f-. ^
^ {0

^c,{(o)da) c ,{ ( o ) d c a 0

' fo. + 5)dco+ j ( 2 x c o + lO)d (0 + j (t y +

%
1 5 )(io -

J (9 9 -2 x Ã¼ )c ? u

l-a,b,c Q

S.t.

x^+X2=d^;
fa
" ^15

fc = ^i Xi,^2 >0; dx > 0 ; Applying the projection method, the final results are summarized in Table A. 17
Iteration 0
fa fb fa

Z

40
Ca

60
Cb

100
Cc

45

130

115

C l
160 1
fa

Q
245
fb fc

Z

68.333
Ca

31.667
Cb

100
Cc

73.333

73.334

115

10495.83 188.333 188.334 Table A. 17: User-optimization results o f example 8

c,

C 2

Through the numerical tests as shown in these eight single-period transportation equilibrium models, it can be concluded that the projection method is very efficient algorithm in soh ing single-period transportation equilibrium models.

105
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Appendix B Multi-period Transportation Equilibrium Models

106

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

For the multi-period transportation network equilibrium problems and optimal solution algorithms, four examples will be presented. These include linear, exponential, time lag effect and no time lag effect transportation equilibrium models. The types of these examples are summarized in Table B.l:
Example Linear structure demand function Y Y Y Y Exponential structure demand Function No time lag effect Y Y Time lag effect

1 2 3 4

Y Y Table B. 1: Type o f example in Appendix B

In this appendix, the same network topology and time functions that were implemented for all four examples will be used. Three periods for each o f the examples will be considered. Further, there will be a constant discount factor for every period in all the examples, and demand functions are given according to Table B.l.

In each example, a mathematical formulation in the two forms of system-optimization and user-optimization will be given. In example 1 and 3, the demand functions have no time lag effect and the relaxation method is used; in example 2 and 4, the demand functions have a time lag effect and the decoupled relaxation method is used. The programming code was developed in GAMS to get the solution for those examples.

At the end of each example, the results were summarized in two tables, one for computing iterations and the other one for the optimal solutions.

107
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Example 1: Linear structure demand function without time lag effect.

Figure B. 1 Transportation network topology Time functions: = /;(')+ 0 .5 c" = + 0.4 X +2 c r= .^ ^ '^ + 0 4 x / ( ') + 2 cW =/:<')+0.3 x _ ^ ')+ l Discount factor: r = 0.05 Period: t = 1,2,3 Demand functions: d[`^ = ofj -1 .6 Xu[`^ + 0.9 Xi
d.2^ = Ã 2 + l - l x w f ' ^ - 1 . 8 x m ^ 4

History data (in periodr = 0) are given as follows: Demand: Travel disutility: 4 = Â°> = 3 , =12.4, =12.5.

The solution will be illustrated in two cases for the system-optimization model and the user-optimization model respectively.

108

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Case I: System-optimization model.
4

M in Z = % l/ ( l + ry
r= l

I ;=1

1=1

S.t.

+X4^ = 4-

/Â·(O -- _% y(f) ^(0., /4 2 ^, -^4 for all >0;

Relaxation method was used to calculate the optimal solution; First the parameter o f demand functions, a^ and o , = 4 < '- Â» + 2 ( a r ' x V fl)
J= \

was regressed from history data. (B.l)

The objective function at lÃ¢ relaxation step is described as equation B.2: Z= 2 '=' - 1 < Â· = 1 /(I + r)' X ^ 4 " + (a, + ( t " ? '" - ' X(-V y ,)) + nTM `-'> Xi><,,,,)/(.,,,,,)x 4,`'>] 7 = 1 x W " ) ' + c" ( / ">"-'>) X

/<'>" -'> ) (B.2)

Iteration information is summarized in Table B.2:

109
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

No. o f Total No. NLP NLP Iteration 100 1 37 2 20 3 18 277 4 20 5 22 6 20 7 20 8 20 9 Table B.2; Example 1 system-optiimzation iteration information Relaxation Iteration

The optimal solution for system-optimization model is summarized in Table B.3 f, t=l i=2 t=3 (=7 t=2 t=3
2.302 2.302 2.302 1.939 1.939 1.939

/i
1.753 1.753 1.753 2.488 2.488 2.488

d,
2.302 2.302 2.302

dl

u'-i

1.939 13.076 13.300 13.076 1.939 13.300 13.076 13.300 1.939 c, Q Q Q 13.076 13.076 13.300 13.300 t=l t=2 13.076 13.076 13.300 13.300 13.300 13.300 Ã®=3 13.076 13.076 Z -64.6160 Table B.3: Example 1 system-optimization results

Case II: User-optimization model.
//'>

Min

Z = | ] 1/(I + r)' X( g
/=1 0

{co)da) 1=1

] D f {v)dv)
0

s.t.

110

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

f ( .`) _ ^(0 + jf(0.

/-(() _ y(0 , yd). J2 --A 3 + ^4

,

=%M+xW; /;(')= x < ')+ x r; for all x ' ^ \f,^ `\d9^ > 0; Relaxation method was used to calculate the optimal solution: First the parameter o f demand function was regressed, a, and from history data. (B.3)

< i , = i r ' + Z " r ' x(V /)) The objective function at Ã '*projection step is described as equation B.4:

t= \

(B.4) + (a, + M X(-i,u>)) + X X</,">]

- 2 ( -1 /(2 Xb,,,,)x
1=1

Iteration information is summarized in Table B.4 No. of Total No. NLP NLP Iteration 1 101 2 18 3 20 203 4 20 5 24 6 20 Table B.4: Example 1 user-optimization iteration information Relaxation Iteration The optimal solution for user-optimization model is summarized in Table B.5

111
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

t=l t=2 f=3 t=2 t=3

2.906 12.627 2.906 12.523 12.627 c, C2 Q 12.523 12.627 12.627 t=2 12.523 12.627 12.627 t=3 12.523 12.627 12.627 Z -86.374 Table B.5; Example I user-optimization results

fi 3.916 3.916 3.916 d, 3.916 3.916 3.916 c, 12.523 12.523 12.523

f2 2.906 2.906 2.906 di
2406

Ã 2.38
2J8 2J8

M / 12.523 12.523

f4 4.441 4.441 4.441 U 2
12.627

Example 2: Linear structure demand function with time lag effect

Time functions: fU) + 0 .5 x ^c) -Fl +o.4xy;(') + 2 c-r + 0.4x/,M + 2 + 0.3x_^') + 1 Discount factor: r = 0.05 Period: t = 1,2,3 Demand functions: d[`^ = Qj -- 1.6X d^^ = Ã 2 +l.lXMj^'^ + 0.9XU2^ 4-0.82X 1.8xÂ«(')+0.8x(f('-')

112

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

History data (At t = - \ and f = 0) are given as follows;

At f = -1 : demand: At t = 0 : demand: travel disutility: =4 , = 3, = 12.4, = 12.5. - 3, = 2;

The solution will be illustrated in two cases for system-optimization and useroptimization respectively. Case I: System-optimization model. Min Z = j ] l / ( l + r)' /=!
s .t .

/=!

(= 1

for all x f

>0;

Decoupled relaxation method will be illustrated to calculate the optimal solution: First the parameter o f demand function, a, and a , was regressed from history data. (^.s)

+ i;Â» r
M

The constant factor inflated disutility elasticity in the decoupled steps w ill also be needed here.

113
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Constant factor of demand function;
= (a, X X ( B 6)

n-1

Inflated disutility elasticity at each decoupled step:

C > = * M x iw " " n -1

(B.7)

The objective function at Ã '* decoupled step applying relaxation method is described as equation B.8:

z = 1 1/(1+ r)' /=i
- Z ( - l / i g ,
X < "

+ c r> (/Â« " -Â» ) 1 = 1 oJt
t
X ( - % , Â»

>;<'Â»->) Â°Ji ^g\
) / % ) X d f ]

+ (4 " ' + (

+ U < -Â« Â« > X %

1 = 1

y=i

Iteration information is summarized in Table B.6

114

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

No. of Total NLP No. NLP Iteration 101 1 2 38 3 18 1 272 4 17 5 19 20 6 7 18 8 22 9 19 1 18 2 2 19 3 18 128 4 21 5 16 6 21 7 15 1 20 3 2 17 3 88 17 4 17 5 17 4 1 17 49 2 17 3 15 5 1 16 'X 'X 2 17 6 15 1 15 Table B.6: Example 2 system-optimization iteration information Decoupled Iteration Relaxation Iteration

The optimal solution for system-optimization model is summarized in Table B.7

115
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

f2 t= l t= 2 t= 3 t= l t= 2 t= 3 t= ] t= 2 t=3 Z

fs

f4

2.469 2.351 2.358
d,

2.469 2.351 2.358
c,

13.899 13.328 13.328

1.919 1.805 1.802 di wU 2.115 13.899 1.997 13.328 1.984 13.328 Cj C2 13.899 14.121 13.328 13.563 13.328 13.529 -71.2960

2.115 1.997 1.984

2.664 2.543 2.540 14.121 13.563 13.529 Q 14.121 13.563 13.529

Table B.7: Example 2 system-optimization results

Case II: User-optimization model. 3 4 2 Z = ^ 1 / ( 1 4- r)' X ^c\`^{cÃ¹)dco ~ ^ r=l /= 1 0 i= l

Min

J
0

{v)do)

S.t. = d\`^\ =d^2\

for all x f

>Q\

Decoupled relaxation method was used to calculate the optimal solution: First the parameter o f demand function, and was regressed from history data.

y= i (B.9)

116

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

The constant factor inflated disutility elasticity in the decoupled steps will be needed here. Constant factor of demand function: (B.IO) n "l inflated disutihty elasticity of demand at each decoupled stqj:
^(U) ~ 4' j ) ^ S (^i
n=l

Xw

)

(B.ll)

The objective function at /c ^ '' decoupled step applying relaxation method is described as equation B.12:

Z=iu (l +ryxg(l/2x.^Egr)x(y;m):+,Â«(/TM-,,)_ag^
t=\

/= !
M

-

2

: ( -1 /(2 X

) Xd;Â« + ( 4 " + ( t u f " - Â« X( - % ) ) + 4>.(.-0 X4<Â« ) /
J= l

X4 " ] (B.12)

1=1

Iteration information is summarized in Table B.8 Total No. of No. NLP Iteration NLP 115 1 21 2 19 3 21 4 1 284 21 5 6 22 23 7 8 24 18 9 1 19 2 38 2 19 3 1 19 34 2 15 4 20 1 20 Table B.8: Example 2 user-optimization iteration information Decoupled Iteration Relaxation Iteration The optimal solution for user-optimization model is summarized in Table B.9

117
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

t=I t=2 t-=3

f4 h h _ 3.191 4.737 2.632 3.241 2.676 4.788 4.804 3.258 2.690 Ui U 2 d2 13.389 3.191 13.301 3.241 13.520 13.432 t=2 13.475 13.563 3.258 t-3 C; C3 Q 13.301 t= l 13.389 13.389 13.432 t=2 13.520 13.520 13.475 13.563 t=3 13.563 -94.2282 Z Table B.9: Example 2 user-optimization results ft 4.179 4.223 4.236 d, 4.179 4.223 4.236 c, 13.301 13.432 13.475

Exam ple 3 : Exponential structure demand function without time lag effect.

Time fonctions:
= /( ') + 0 .5

-t-0.4

2

0.3 X

Discount factor:
r = 0.05

Period:
t = 1,2,3

Demand functions:

=<32 X w

f ` X

118

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

History data (At period 2 "= 0) are given as follows: Demand: =4, =3, = 12.4, = 12.5 .

Travel disutility:

The solution will be illustrated in two cases for the system-optimization model and the user-optimization model respectively.

Case I: System-optimization model. Min Z = % l/( l + r)' /=! S.t. = dl`^; y;(') = x ['> + x f ;

/=!

(= 1

+ x^`^; JA " -^2 ^ ^4 5 for all >0;
f i t ) __ , y (f).

Relaxation method was used to calculate the optimal solution: First the parameter o f demand function, a, = Xf j w f M ) and was regressed from history data. (B. 13)

119
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

The objective function, at k!'' relaxation step is described as equation B.14;
Z = t l / ( l +
i= l

/,< Â» < Â·-'> )

(B.14)

/= !

y=i

Iteration information is summarized in Table B.IO; No. of Total No. NLP NLP Iteration 262 1 48 2 20 3 18 4 430 19 5 21 6 22 7 8 20 Table B.IO: Example 3 system-optimization iteration information Relaxation Iteration

The optimal solution for system-optimization model is summarized in Table B .ll: f2 h f4 1.910 1.542 2.263 1.910 1.542 2.263 1.910 1.542 2.263 1.896 u'-'i d, dj u'^2 1.910 11.735 12.568 1.896 t=l 1.896 1.910 11.735 12.568 t=2 1.910 11.735 12.568 t=3 1.896 Q Cl Q Q 11.735 11.735 12.568 12.568 t=l 11.735 11.735 12.568 12.568 t=2 11.735 12.568 11.735 12.568 -222.8318 Z Table B. 1: Example 3 system-optimization results fi t=l t=2 t=3
1.896 1.896

Case 11: User-optimization model.

120

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Min

4 2 Z = g l / ( I + r)` Xg Jcf> (dy)rftyj f=l 1 = 1 0 '= ) 0

,

(o)dv)

s.t.
4 "' +^4" = 4 " ;

/3<'>>x!'>+4'>;

for all ij>./;Â«,rfÂ«>0; Relaxation method was used to calculate the optimal solution: First the parameter of demand honction, a, and was regressed from history data.

M
The objective function at A " " relaxation step is described as equation B.16:

xryx (=1

, , J

^

/

y^JL/ ^

jP ( t)\2

,

,, ( 0 / , T ( 0 .( * - 1 ) \

^

/=!
i=l

1 = 1

(B.16) Iteration information is summarized in Table B.12:
No. of Total No. NLP NLP Iteration 1 332 2 21 3 21 448 4 23 5 25 6 26 Table B.12: Example 3 user-optimization iteration information Relaxation Iteration

121
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

The optimal solution for user-optimization model is summarized in Table B.13;

f2 fs /< 4.486 2.957 2.419 2.957 2.419 4.486 4.486 2.957 2.419 d2 W / U 2 12.639 12.749 t=l 2.957 t=2 2.957 12.639 12.749 12.639 2.957 12.749 f=3 Cj Q Q 12.639 12.749 12.749 t=2 12.749 12.639 12.749 t=3 12.749 12.639 12.749 Z -423.336 Table B.13; Example 3 user-optimization results t=i t=2 t=3 fi 3.949 3.949 3.949 d, 3.949 3.949 3.949 c, 12.639 12.639 12.639

Example 4: Exponential structure demand function with time lag effect.

Time functions: 0.5 c(') ,(0
,(0

4-0.4 x / C ) + 2
(0

Discount factor: r = 0.05 Period: t = 1,2,3 Demand functions:

122

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

History data (At period t = -I and ? = 0) are given as follows: At period f = -1 : demand: At period t = 0: demand: = 4, = 3, =12.4, =12.5 = 3, = 2;

travel disutility:

The solution will be illustrated in two cases for the system-optimization model and the user-optimization model respectively. Case I: System-optimization model.

Min Z = ^ l/( H - r y f=l
S.t. = dl`^; =d^`^ -, f l `^ = + x f\ 4= %(')+%(');

l-l

1 = 1

for all Decoupled relaxation method was used to calculate the optimal solution: First the parameter o f demand function, a, and was regressed from history data.

123
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

a, =

X y = i

) X (f

(B.17)

The constant factor inflated disutility elasticity in the decoupled steps will be needed here. Constant factor of demand function:

(B.18)
Inflated disutihty elasticity o f demand at each decoupled step:

6 (U) = h . J ) ^

E ( 4 "" X ln(wW ) / l n ( w ))
n = I
decoupled step is described as equation B.20:

(B. 19)

The objective function at

(= 1
i= l >1

/=i

^Ji

^Jt

(B.20)

Iteration information is summarized in Table B.14

124

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

No. o f Total NLP N o. NLP Iteration 266 1 2 46 3 18 4 21 464 20 1 5 22 6 23 7 8 24 9 24 ' 25 1 2 19 19 3 137 2 4 18 5 19 6 20 7 17 1 18 2 18 3 96 3 20 4 19 5 21 1 19 2 18 74 4 3 21 4 16 1 21 63 5 2 19 3 23 1 20 "17 6 2 17 21 7 1 21 Table B.14: Example 4 system-optimization iteration information Decoupled Iteration Relaxation Iteration

The optimal solution for system-optimization model is summarized in Table B.15

125

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

fi
t= l t=2 t=3 t= l t=2 t=3 t= l t=2 t=3 z
2.194 2.26 2.421

f2
2.373 2.374 2.467 ^

fs
1.911 1.944 2.067

f4
2.656 2.69 . 2.821

d,
2.194 226 2.421

d2
2.373 2.374 2.467

U '^j

U '^2
14.508 14.617 15.164 Q 14.508 14.617 15.164

c,
13.459 13.671 14.337

1

13.459 13.671 14.337 Cj C2 13.459 14.508 13.671 14.617 14.337 15.164 -192.4626

Table B.15: Example 4 system-optimization results

Case II: User-optimization model.
3 4 //'' 2

M in

Z = J ; 1/(I + r)' X J c f ^ { c o ^ d oe jD f ^ (= I 1 = 1 0 ' = ' 0

{Ã¼)dv)

s.t.

;

(0 _ ,,(0  ^ 3 h (0 __ ,,(0 Ã - Aj

, ,,(0. ^*^4 5 .- ^3 Â»(0.5 -1

for ail

>0;

Decoupled relaxation method was used to calculate the optimal solution: First the parameter o f demand function, a, and was regressed from history data.

M The constant factor inflated disutility elasticity in the decoupled steps is needed here.

126

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Constant factor of demand function; (B.22)
Inflated disutility elasticity of demand at each decoupled step: 6(% ) = hij) ^ S ( ^ r X^og(uf ) / log(wf )) (B.23)

The objective function at k!'' decoupled step applying relaxation method is described as equation B.24:

t= \


'\ i=
) X ( 4 '> X

<y I
X X (tff

ojj
]

^ 1 /( 1 - 1 / %

/=I (B^4)

7 = 1

Iteration information is summarized in Table B.16: Total No. of NLP No. Iteration NLP 1 323 2 26 21 3 4 19 1 450 5 20 6 20 7 21 8 21 1 16 2 20 2 123 3 21 4 22 5 23 1 18 3 57 2 19 3 20 1 22 4 44 2 22 5 1 19 19 Table B.16: Example 4 user-optimization iteration information Decoupled Iteration Relaxation Iteration

127
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

The optimal solution for user-optimization model is summarized in Table B.17: f2 fs Ã 3.71 3.038 5.211 4.168 3.378 5.607 4.441 3.566 5.826 Ul d2 U 2 t=l 3.71 14.516 14.648 4.168 15.521 t=2 15.715 4.441 t=3 16.066 16.316 Cs G Q t=l 14.516 14.648 14.648 15.521 t-2 15.715 15.715 16.066 t=3 16.316 16.316 Z -385.3421 Table B.17: Example 4 user-optimization results t=l t=2 t=3 fi 4.539 4.817 4.951 d, 4.539 4.817 4.951 Cj 14.516 15.521 16.066 Through the numerical tests as shown in these four single-period transportation equilibrium models, it can be concluded that the relaxation method is an effective algorithm in solving multi-period transportation equilibrium models without time lag effect and the decoupled relaxation method is also effective method in solving multi period transportation equilibrium models with time lag effect.

128

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

References:
Ahn, B.H. and W.W. Hogan, 1982, "On Convergence of the PIES Algorithm for Computing Equilibrium", Operations Research, 30, 2,281 -300. Bertsekas, D.P. and Gafiii, E.M., 1982, "Projection Methods for Variational Inequalities with Application to the Traffic Assignment Problem", Mathematical Programming Study 17, 139-159. Chung, W., Y.J. Wu and J.D. Fuller, 1997 "Dynamic Energy and Environment Equilibrium Model for the Assessment of CO 2 Emission Control in Canada and the \JSA", Energy Economics, 19, 1,103-124.  Dafermos, S. and F. T. Sparrow, 1969, "The Traffic Assignment Problem for a General Network," J. Res. National Bureau Standards-B. Math. Sci., 73B, 2, 91-- 118. Daniel, T. E and H. M. Goldberg, 1981, " Dynamic Equilibrium Energy Modeling; the Canadian BALANCE Model", Operations Research, 29, 5, 829-852. Dhrymes, P.J., 1981, "Distributed Lags: Problems o f Estimation andFormulatiorC\ North-Holland, Amsterdam. Fuller, J.D. 1987, "A System for the Construction and Maintenance of Energy Planning Models", Strategic Planning In Energy and Natural Resources, B. Lev et al (eds.), North-Holland, Amsterdam, 3-15. Greenberg, H.J., 1995, ''Mathematical Programming Models for Environmental Quality Control", Operations Research, 43, 4, 578-622. Murphy, F.H, Conti, J.J., Shaw, S.H. and Sanders, R., 1988, "Modeling and Forecasting Energy Markets with the Intermediate Future Forecasting System", Operations Research, 36, 3, 406-420. Nagumey, A., 2000, "Congested Urban Transportation Networks and Emission Paradoxes", Transportation Research D, 5, 2, 145-151. Nagumey, A., 1999, "Network Economics: A Variational Inequality Approach", Revised Second Edition, Kluwer Academic Publishers, Dordrecht, The Netherlands.

129
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Samuelson, P. A., 1947, ''` Foundations o f Economic Analysis", Harvard University Press, Cambridge, Mass. Scarf, H. (In collaboration with T. Hansen), 1973, "Computation o f Economic Equilibria ", Yale University Press, New Haven, CT. Sheffi, Y., 1985. "Urban Transportation Networks: Equilibrium Analysis with Mathematical Programming Methods", Prentice-Hall, Englewood Cliffs, NJ, Stone, J.C., 1985, "Sequential Optimization and Complementarity Techniques for Computing Bcnomic Equilibria", In Economic Equilibrium: Model Formulation and Solution. A. S. Manne (ed.) North-Holland, Amsterdam, 173-191. Takayama, T. and G. G. Judge, 1971, "Spatial and Temporal Price and Allocation Models ", North-Holland, Amsterdam. Thompson, G.L. and S. Thore, 1992. "Computational Economics: Economic Modeling with Optimization software". The Scientific Press. Wardrop, J. G., 1952, "Some theoretical aspects of road traffic research". Proceedings, Institution o f Civil Engineers, PART II, V ol.l, 325-378. Wu, Y.J. and J.D. Fuller, 1991. "Convergence of Multi-period Equilibrium Calculation, with Geometric Distributed Lag Demand," Operations Research Letters, 10, 197-202. Wu, Y.J. and J.D. Fuller, 1995, "Introduction of Geometric Distributed Lag Demand into Energy Process Models," Energy - the International Journal, 20, 7, 647-656. Wu, Y.J. and J.D. Fuller, 1996, "An Algorithm for the Multi-period Market Equilibrium Model with Geometric Distributed Lag Demand," Operations Research, 43, 6, 10021012 .

Wu, C. and Y.J. Wu, 2003, "GAMS Implementation for Construction and Calculation of Transportation Equilibrium Models," Technical Report, Department of Mechanical and Industrial Engineering, Ryerson University, Toronto, ON, Canada.

130

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

