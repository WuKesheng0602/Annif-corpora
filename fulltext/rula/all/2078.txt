A CONTEXT BASED AUTOMATED SYSTEM FOR LUNG NODULE DETECTION IN CT IMAGES

by

Maciej Dajnowiec B.A.Sc., University o f Toronto, 2003

A Thesis presented to Ryerson University in partial fulfillment o f the requirements for the degree o f

Master o f Applied Science

in the Program o f Electrical and Computer Engineering

Toronto, Ontario, Canada, 2005

© (Maciej Dajnowiec) 2005

PROPERTY OF RYERSON m V SN G ITY L » R A R /

UMI Number: EC53014

All rights reserved
INFORMATION TO USERS

The quality of this reproduction Is dependent upon the quality of the copy submitted. Broken or indistinct print, colored or poor quality illustrations and photographs, print bleed-through, substandard margins, and improper alignment can adversely affect reproduction. In the unlikely event that the author did not send a com plete manuscript and there are missing p ages, th ese will be noted. Also, if unauthorized copyright material had to be removed, a note will indicate the deletion.

UMI
UMI Microform EC 53014 Copyright 2008 by ProQuest LLC All rights reserved. This microform edition is protected against unauthorized copying under Title 17, United States Code.

ProQuest LLC 789 East Eisenhower Parkway P.O. Box 1346 Ann Arbor, Ml 48106-1346

I hereby declare that I am the sole authour o f this thesis.

1 authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose o f scholarly research.

Signatory

I further authorize Ryerson University to lend this thesis by photocopying or other means, in total or in part, at the request o f other institutions or individuals for the purpose o f scholarly research.

S ig n atu ^

1 1

R yerson U niversity requires the signatures o f all persons using or photocopying this thesis. Please sign below , and give address and date.

I l l

A CONTEXT BASED AUTOMATED SYSTEM FOR LUNG NODULE DETECTION IN CT IMAGES

M aster o f Applied Science 2005

Maciej Dajnowiec Electrical and Computer Engineering Ryerson University

Abstract

This thesis is focused on automatic lung nodule detection in CT images. CAD systems are suited for this task because the sheer volume o f information present in CT data sets is overwhelming for radiologists to process. The system developed in this thesis presents a fully automatic solution that applies a sequential algorithm which strongly focuses on nodule context. The system operates at a rate o f 80% sensitivity with 3.05 FPs per slice. Our testing data, consisting o f 19 CT data sets containing 239 lung nodules, is extremely robust when compared with other documented systems. In addition it introduces many new approaches such as a tight bounding, vessel connectivity, perimeter analysis, adaptive MLT and region growing based lung segmentation. The experimental results produced by this system are an affirmation o f the competitiveness o f its performance when compared to other documented approaches.

IV

Acknowledgments
I w ould like to first thank Professor Javad A lirezaie for taking a chance on m e and accepting m e into the program . I also w ant to thank him fo r his guidance and all the w ork he has p u t into helping m e produce this thesis, it w ould n o t have been possible w ithout him . I w ould like to thank Dr. Paul B abyn for providing us w ith the CT data w e needed for our experim ents. I w ant to thank him for all the tim e he spent identifying lung nodules and giving us insight into them w ithout w hich it w ould have been im m easurably m ore difficult to develop the system that w e did. I w ould like to thank m y lab m ates throughout m y tenure here; M ahdi, N ezara, A deel, Peym an, R ushin, N egar, Jacob and M asha. I could not have asked for n icer people and a w arm er environm ent w ithin w hich to get all o f this done. I w ould like to thank m y exam ining com m ittee m em bers; Dr. A npalagan, Dr. A ndroutsos and Dr. Z hang for being a part o f the hom e stretch in this process. L astly, I w ould like to thank Professor Phil A nderson and P rofessor T arek A bdelrahm an w ho w ere kind enough to w rite letters for m e that m ust have been kind since I w as granted the opportunity to do w hat I have com pleted now.

Dedication
To my guardian angel Candice and the children we have yet to raise, my father, Waclaw, my mother Barbara and my big brother Mateusz. Thanks to all o f you I will always be the most fortunate man in the world.

VI

Table of Contents
1 Introduction
1.1 CT Im aging 1.2 C ancer Statistics 1.3 Lung N odules 1.4 C A D System 1.5 O utline

1
1 4 6 10 11

2 Literature Survey
2.1 LD A B ased T echniques 2.2 R ule B ased Techniques 2.3 T em plate M atching Techniques 2.4 Fuzzy N eural N etw ork T echnique 2.5 H ybrid R ule B ased and LD A system s 2.6 A utom atic L ung Segm entation System 2.7 C om paring R esults

12
12 14 16 17 19 20 21

3 Lung Nodule Synthesis
3.1 L ung N odule Synthesis A pproach 3.2 L ung N odule Synthesis R esults

24
24 29

4 Lung Volume Segmentation
4.1 L ung V olum e T hresholding 4.2 3D Lung V olum e Extraction

32
33 39

5 Lung Nodule Detection
5.1 L ung R O I E xtraction 5.2 FP reduction

52
52 61

V ll

6 Experimental Results
6.1 Lung Segmentation 6.2 ROI Extraction Results 6.3 Lung Nodule Detection Results

79
79 82 85

7 Conclusions
7.1 Future W ork

101
103

Bibliogrpahy

106

V lll

List of Tables
T able 1.1 2005 U S statistics on expected new cancer cases 4 5 5 T able 1.2 2005 U S statistics on expected cancer deaths Table 1.3 2005 U S statistics on 5 year survival rates for different cancers

Table 2.1

N odule detection system perform ance in subsequent testing

22

T able 5.1 G rey level values o f different CD F values T able 5.2 G rey level values at 65% , 92.5% and 97.5% C D F values T able 5.3 F eature thresholds for different types o f R O ls

54 59 72

Table 6.1 C om parison betw een lung segm entation approaches Table 6.2 Sim ulated nodule testing results Table 6.3 Phase 1 lung nodule detection results Table 6.4 Phase 2 lung nodule detection results Table 6.5 Phase 3 lung nodule detection results T able 6.6 P hase 4 lung nodule detection results T able 6.7 P erform ance com parison o f lung nodule detection techniques Table 6.8 E ffect o f C T slice resolution on appearance o f sm all nodules

80 85 87 88 89 90 92 97

IX

List of Figures
Figure 1.1 Thoracic CT slice Figure 1.2 Frontal radiogram Figure 1.3 Juxtapleural nodules Figure 1.4 Ground glass nodules Figure 1.5 Noisy nodule Figure 1.6 Diaphragm adjacent nodules Figure 1.7 Large lung wall nodule

^ '
2 3 7 7 8 8 9

Figure 3.1 A CT scan with a nodule in the right lung Figure 3.2 Enlarged image o f lung nodule in right lung Figure 3.3 3D mesh of a lung nodule Figure 3.4 Nodule size distribution within a CT data set Figure 3.5 A real and synthetic nodule in the same CT slice Figure 3.6 3D mesh o f a synthetic nodule Figure 3.7 Screenshot o f lung nodule synthesis GUI

26 26 27 28 29 30 31

Figure 4.1 Nodule detection subsystem diagram Figure 4.2 A CT slice with the valid portion identified Figure 4.3 The HU distribution o f a high intensity CT scan Figure 4.4 Thresholding comparison o f a high intensity CT slice Figure 4.5 A CT slice with normal contrast Figure 4.6 The HU distribution of a normal CT scan Figure 4.7 Thresholding comparison o f a regular intensity CT slice Figure 4.8 Eight pixel connectivity Figure 4.9 Thresholding a regular intensity CT slice Figure 4.10 Removing the background non-body pixels from a CT slice Figure 4.11 Removing body pixels from the lungs Figure 4.12 Lung volume splitting due to diaphragm intrusion Figure 4.13 A CT slice with the lung separated by vascular tissue

32 34 34 36 37 37 38 39 40 40 41 43 43

Figure 4.14 T hreshold o f a lung volum e split by vascular tissue F igure 4.15 A CT slice near the top o f the lungs F igure 4.16 T hresholding and volum etric elim ination near the top o f the lungs F igure 4.17 A CT slice w ith m any objects attached to the lung w alls F igure 4.18 A threshold o f a CT slice w ith a jag g ed b o rder F igure 4.19 E ffect o f m orphological closing on the lung w alls F igure 4.20 A n exam ination o f m orphological closing on the lung w alls F igure 4.21 A com parison o f a pre/post m orphology segm ented C T slice F igure 4.22 A sum m ary o f our lung segm entation process

44 44 45 45 46 47 48 48 51

Figure 5.1 CD Fs o f three different lung volum es Figure 5.2 C T slices from three different lung volum es Figure 5.3 A single CT slice thresholded at Figure 5.4 A single CT slice thresholded at Figure 5.5 A single CT slice thresholded at m ultiple m ultiple m ultiple C D F values C D F values C D F values

53 54 55 56 57 59 60 63 63 64 65 66 68 69 69 73 74 75 76 78

Figure 5.6 A CT slice thresholded at 65% , 92.5% and 97.5% C D F values Figure 5.7 A CT slice thresholded at its 62.5% CD F value F igure 5.8 A disc structuring elem ent o f radius 1 F igure 5.9 Intensity threshold eroded at different thresholds F igure 5.10 A disc structuring elem ent o f radius 2 F igure 5.11 N orm ally oriented ellipses w ith traditional bounding boxes Figure 5.12 A com parison betw een a tight and norm al bounding box Figure 5.13 A CT slice containing a b o rd er case nodule Figure 5.14 A threshold o f a CT slice containing a border case nodule Figure 5.15 A close up o f a thresholded border case nodule Figure 5.16 A grey level contrast spectrum Figure 5.17 The concept o f nodule trim m ing and com paction Figure 5.18 A CT slice containing different types o f vertical vessels Figure 5.19 V ertical and horizontal vessel connectivity Figure 5.20 Sum m ary o f our FP reduction process

XI

Figure 6.1

Top o f the lung volume segmented using region growing

81 81 82 84

Figure 6.2 Bottom o f the lung volume segmented using region growing Figure 6.3 Segmentation o f a fragmented lung using region growing

Figure 6.4 A comparison o f LDM and M LT extraction o f ROIs

I

 .:

i ,

XII

List of Abbreviations
C A D C om puter A ided D iagnosis C D F C um ulative D ensity Function C T C om puted Tom ography D IC O M D igital Im aging and C om m unications in M edicine F P False Positive H U H ounsfeld U nits L D A L inear D iscrim inant A nalysis L D M Local D ensity M axim um M L T M ulti-L evel T hresholding R O I R egion o f Interest

xni

Chapter 1 Introduction
Computers have revolutionized the modem world. They have accelerated the flow, presentation and processing o f data. In virtually all professions they play a significant role either directly or indirectly. In direct use they can be used as a tool to help make a task more complete, accurate, simple or quick. One realm where computers play a significant role is image processing [1], [2]. Image processing applications have led to computers checking for manufacturing defects during the production process to reading license plates [3]. A particularly important application is medical imaging [4], Here, computers are used to help diagnose and interpret medical images of patients. Systems have been designed to analyze and interpret things from brain scans to radiograms [5-7]. Technologies such as computerized tomography (CT) and magnetic resonance imaging (MRI) in conjunction with computer hardware advancements have lead to an explosion o f research in medical imaging applications.

1.1 CT imaging

CT imaging was invented in the early 1970's by Sir Godfrey N. Hounsfield and Professor Allan M. Cormack independently o f each other [3]. CT imaging basically consists o f an x-ray source with sensors on the opposite side o f a concentric circle which is rotated around the eircle's z-axis. A patient lies down, contained within this circle, in between the x-ray souree and the sensors. Many images are taken sequentially in the direction o f the circle's perpendieular axis to obtain a 3D representation o f a particular region o f the patient. The intensities in the CT images are representative o f Hounsfeld

U nits (H U ) w hich m easure the attenuation o f the x-rays as they pass through that particular location. C T im ages are stored in the Digital imaging and Communications in Medicine (DICOM) file format which keeps the data in a lossless state with up to 15 bits of resolution per pixel. O ver the years C T im aging has im proved by using less radiation and providing thinner slices to produce m ore accurate data sets. C T im aging has allow ed doctors to get m ore detailed and inform ative im ages than w ere available w ith conventional radiogram s. For exam ple, the im age in figure 1.1 represents a single im age from a 65 slice data set o f a p atien t's lungs w here in the past one or tw o radiogram im ages w ould have been taken from the front and sides o f a patient in the diagnosis procedure. Slices are cross sections o f the patient at specific points, usually a series consists o f spatially sequential slices.

Figure 1.1: A CT im age o f a section o f the thorax

Figure 1.2: a single radiogram taken from in front of a patient representing an entire lung volume

The evolution o f CT, and its resultant more detailed images, has given rise to certain challenges. Radiologists now must potentially go through in excess o f a hundred images to diagnose a single case where in the past they would only have to look through a handful o f radiograms [8], [9]. CT imaging provides a huge volume o f useful information which makes it that much more challenging and demanding to evaluate a CT data set thoroughly. Radiologists can often miss important details due to the amount o f detail present in a CT data set [10-13]. In this case there is an abundant amount o f information but difficulty in processing it. This makes processing CT image data sets and appropriate task for Computer Aided Diagnosis (CAD) systems [12-13]. CAD systems allow for complete and thorough analysis o f all the data which can then be used as an aid to the radiologist in their diagnosis. Cancer, for example, is one disease that is commonly screened for using CT imaging.

1.2 Cancer Statistics

In looking at statistics from the U S, cancer is the leading k iller o f people under the age o f 85 [14]. In particular it is the second leading killer o f children aged 1 to 14 only behind accidents. T he life tim e probability o f getting cancer for a m an is 46% w here for a w om an it is 38% . It is also estim ated that ju st over h a lf a m illion A m ericans w ill die from cancer in 2005.

N um ber o f expected new C ancer cases T ype m en Prostate B reast L ung and 93,010 B ronchus C olon and R ectum P ancreas L eukem ia T o ta l 16,100 19,640 710,040 16,080 15,170 662,870 32,180 34,810 1,372,910 71,820 73,470 145,290 79,560 172,570 232,090 1,690 w om en 0 211,240 total 232,090 212,930

P ercentage o f expected can cer cases, « m en 32.69% 0.24% 13.10% w o m en 0.00% 31.87% 1 2 .0 0 %
% \

to tal 16.90% 15.51% 12 .5 7 %

10.11%

11.08%

10.58%

2.27% 2.77%

2.43% 2.29%

2.34% 2.54%

T able 1.1: 2005 U S statistics on expected new cancer cases [14]

Percentage o f expected 1 JNumber o f expected deaths Cancer Type men Prostate Breast Lung and 90,490 Bronchus Colon and 28,540 Rectum Pancreas Leukemia Total 15,820 12,540 295,280 15,980 10,030 275,000 31,800 22,570 570,280 5.36% 4.25% 5.81% 3.65% 5.58% 3.96% 27,750 56,290 9.67% 10.09% 9.87% 73,020 163,510 30.65% 26.55% 28.67% 30,350 460 women 0 40,410 total 30,350 40,870 men 10.28% 0.16% cancer deaths
.

i total % 5.32% 7.17%

women 0.00% 14.69%

Table 1.2; 2005 US statistics on expected cancer deaths [14]

Cancer Type Prostate Breast Lung and Bronchus Colon and Rectum Pancreas

All Stages %

Local %

Regional %

Distant % -

99.3% 87.7% 15.2%

100.0% 97.5% 49.4%

100.0% 80.4% 16.1%

33.5% 25.5% 2.1%

63.4%

89.9%

67.3%

9.6%

4.4%

15.2%

6.8%

1.8%

Table 1.3: 2005 US statistics on 5 year survival rates [14] depending on what stage the cancer is found. Local means the cancer has not spread, Regional involves the cancer spreading to lymph nodes or organs in the immediate region and Distant refers to cancer which has spread to parts o f the body that are remote from the origin o f the cancer.

T able 1.1 show s the expected deaths and new cases o f som e o f the m ost com m on form s o f cancer. M en and w om en are m ost susceptible to prostate and breast cancer respectively [14], [15], but the survival rates for both are excellent w hen caught early. Lung cancer is the second m ost likely form o f cancer for both m en and w om en and the third m ost com m on over all. In table 1.2, how ever, it can be seen that lung cancer accounts for the m ost cancer deaths o f any cancer; it actually accounts for m ore cancer deaths than leukem ia, prostate, breast, colon and rectum cancer com bined. A s seen in table 1.3 a lung cancer patient has a significantly better chance o f survival if they are diagnosed early. B ased on the overall survival rate for lung cancer it can be observed that the m ajority o f lung cancer is detected after it has spread significantly. I f the survival rate could be brought closer to the early detection rate for lung cancer then a truly significant num ber o f lives could be saved. A ssum ing good detection techniques could bring the overall survival rate up to 40% then that w ould equate to approxim ately 42,000 lives saved each year due to early detection in the U nited States alone.

1.3 Lung Nodules

It is because o f the potential to save lives and continued advancem ents in com puting p ow er that autom ated lung nodule detection has becom e an active research area in the m edical im aging com m unity for C A D system s. L ung nodules refer to grow ths w ithin the lungs that are potentially cancerous. N odules are generally defined to b e any grow th in the lungs that is sm aller than a 30 m m sphere [8], [9], [16], [17]. Figures 1.3 through 1.7 give good illustrations o f som e o f the different types o f nodules that can be found in a C T im age.

Figure 1.3: Circled on the left side is a typical lung nodule; just below two more nodules are circled which are touching the lung wall (juxtapleural nodules)

Figure 1.4: Near the middle o f the lung a ground glass nodule is circled and just below it is a nodule in contact with the lung wall

F igure 1.5: A nodule is circled that is overlapping w ith vascular structures, in this case a blood vessel at the bottom right portion o f the nodule

X'

F igure 1.6: A p air o f nodules overlapping w ith the diaphragm as it enters the CT data set near the bottom o f the lungs

Figure 1.7: A large nodule attached to the lung wall near the top o f the image is circled, as well there are many other nodules in the image that are left unlabeled

Nodules are generally sub-classified as solitary nodules (fig. 1.3), juxtapleural nodules (fig. 1.3, 1.4, 1.7) and ground glass opacity nodules (fig. 1.4). Solitary nodules are generally well formed isolated nodules, which tend to be circular but can also have a strongly elliptical shape. Juxtapleural nodules are nodules that are in contact with the lung walls. Their shape tends to be less defined than isolated nodules and they do tend to get bigger than isolated nodules, though they can also be very small. Ground glass opacity nodules are just basically areas o f opaque irregularities that do not tend to be particularly well formed. Ground glass nodules often have contact with the lung walls. All o f the different types o f nodules can overlap with normal vascular objects; an example o f this can be seen with a nodule overlapping a vessel in fig. 1.5. In fig. 1.6 two nodules are seen that are overlapping with the diaphragm as it enters the CT data set from below. A very large nodule is found in fig. 1.7 which reflects the tendency for some juxtapleural nodules to be very elliptical. The nodule in this case is growing along the contour o f the lung where some juxtapleural nodules may be attached by only a faint connection as can be seen in one o f the nodule in fig. 1.3. One o f the main points to take

from this description is that nodules do have tendencies based on their respective classifications, even w ith these tendencies there are alw ays exceptions in practice. Intensity, shape definition, location and connectivity are all variables that provide for m any different types o f contexts and appearances given nodules o f the sam e basic type. This m akes lung nodule detection a challenging and necessarily robust process for a com puter system .

1.4 CAD System

Lung nodule detection consists basically o f three steps. First, the lung volum es need to be segm ented from the body. T hough this m ay seem to be a sim ple and straightforw ard step it is a very im portant one that does dem and careful consideration. N ext, R egions o f Interest (ROIs) are extracted from the lung volum e to include all objects th at are rem otely suspicious o f being cancerous. This step is usually closely integrated w ith the final step so they can som etim es be grouped together as a single stage depending on the approach used. The final step is False Positive (FP) reduction. This step takes all R O Is and tries to elim inate as m any candidates that are not nodules w hile retaining as m any suspicious candidates as possible. This last step is key to delivering an effective C A D system because it greatly affects the confidence behind the objects w hich are labeled as potential nodules. A com plete lung nodule detection system that builds upon effective com ponents from previous approaches and uses original techniques to deliver a unique and innovative system has been developed. It contains a new approach in lung segm entation that u ses 3D region grow ing to provide m ore com plete lung volum es by including parts o f the lungs at the top and bottom o f the CT data set that are elim inated w ith traditional volum etric approaches [18]. An adaptive, non-linear m ulti-level thresholding (M LT) approach is u sed that evolved from an existing fixed, linear M L T technique for RO I extraction [8], [19]. The adaptive and non-linear aspects use the cum ulative density function (C D F) o f the lung volum e to m ake the approach m ore robust. The FP reduction stage uses original and creative approaches such as a "tig h t" bounding box m etric, vessel and lung w all

10

connectivity, 3D compacting and analysis and vertical contrast to produce the final output o f the system. The effectiveness of this work along with the results obtained by other researchers shows significant promise for using a CAD system in the area o f lung nodule detection to increase the accuracy o f diagnosis by taking advantage o f the information available through advances in CT imaging [17].

1.5 Outline

The next chapter contains the literature review. It presents different approaches that have been presented for lung nodule detection. The merits and drawbacks o f each approach are analyzed, and based on these a course o f action is chosen for the development o f a nodule detection system. Chapter 3 deals with a lung nodule synthesis technique that was developed as a precursor to the actual lung nodule detection system. The purpose behind the technique along with its value within lung nodule detection is discussed. It is used to ereate a preliminary test set for the nodule detection system, and the results o f the system's performance on this test set is also presented in the results section, chapter 6. Chapters 4 and 5 are the focus o f the research and present the entire design o f the lung nodule detection system. Chapter 4 explains the lung segmentation procedure, while ehapter 5 deals with ROI extraction and FP reduction. These chapters contain the methodologies and the parameters under which the system performs in its final state o f testing. Chapter 6 provides all o f the results for the system at different stages o f development along with the changes the system underwent as it progressed in the experimentation proeess. Critical analysis at each stage is offered, and through this analysis the changes to the system are conceived and implemented. The last chapter, ehapter 7, deals with the eonclusions that have been made about the system at its current stage o f development. It also points out where the system needs improvement, along with offering many avenues that can be pursued towards this end.

11

Chapter 2 Literature Survey
A utom ated lung nodule detection is a relatively new area o f research. O ne o f the first papers in the field o f lung nodule detection using C T im ages w as published by [20] b ased out o f the D epartm ent o f R adiology at the U niversity o f Chicago. This early w ork helped to set in m otion future research in the area, especially as com puters got faster and CT im aging becam e m ore prevalent. It w as only a m atter o f tim e b efo re technology caught up enough to be able to design effective C A D system s. N ow , a basic hom e PC can b e used for im age processing w ork that w ould have been unm anageable for m ost pow erful com puters back in the m id-1990s. N ow , research in this area is increasing and C A D system s are show ing prom ising results. The results and approaches o f m ore developed techniques such as the ones by [8] and [9] using L inear D iscrim inant A nalysis (LD A ) and rule based approaches are used as im portant input into m ore recent approaches. R ecent w ork by [17] is an excellent exam ple o f evolving and refining the techniques o f previous w ork w hile adding on their ow n unique contributions. O thers look to apply existing com puter im age processing techniques such as tem plate m atching as done by [21] and neural netw orks as presented by [22]. The num ber o f approaches available allow s researchers to exam ine their effectiveness and choose their ow n path for developing a lung nodule detection technique.

2.1 LD A Based Techniques

A system using LD A tries to exploit statistical feature differences betw een different classes to separate them . The system developed by [8] uses threshloding and

12

LDA. The body is first separated from the background by analyzing the grey level values o f a diagonal line from the top right com er to the center of each CT image. A threshold value is obtained from an analysis o f this line and an outer thoracic border is obtained to separate the background from the body pixels. To segment the lungs a grey level histogram o f the body pixels is analyzed to obtain a threshold that provides a maximum distance between pixels representing body and non-body pixels. A contour o f the lungs is obtained and used as the initial lung border. To fill in any holes the lung contour is processed by a rolling ball filter to smooth the contours. For the ROI stage they apply multiple grey-level thresholding on the lung volumes. At each level, all objects that exist above the threshold are considered to be nodule candidates if their volume is less than that o f a 3 cm diameter sphere. The thresholds are evenly spaced out and are at fixed levels for all cases. The final stage o f the process involves FP reduction. The system computes nine nodule features: volume, sphericity, radius o f the equivalent sphere, maximum compactness, maximum circularity, maximum eccentricity, mean grey level within the nodule, the nodule's grey level standard deviation and the threshold at which the object first decreases below the volume criterion. These features are then put into a LDA classifier to produce the final nodule candidates. This approach by [9] provides some positive tactics. It uses multi-level thresholding (MLT) which is a good way to try to separate objects within the lungs based on their intensity differences. The volume restriction tries to ensure that nodules are not assimilated into larger objects. The features used for LDA foeus strongly on the candidates shape and intensity characteristic, while only using one indirect feature (the threshold at which the object first decreases below the volume criterion). One o f the deficiencies in the approach is the lack o f nodule context. The features focus almost exclusively on grey level content o f the nodule and the geometric properties without having any direct way to evaluate the context o f the nodules within the lung volume. In addition, the thresholding approach uses fixed threshold levels and spacing. This will be problematic if the CT scans analyzed are darker or brighter as a whole than what is expected by the pre-selected thresholding levels. By fixing the thresholding levels the system can not adapt to variations in the distributions o f the CT scans.

13

T he reported results o f their early w ork [8] list a sensitivity o f 70% and approxim ately 3 FPs p er C T slice. Future w ork using the sam e features and system ic approach drew FPs dow n to approxim ately 1.5 w hile retaining 70% sensitivity [19]. T hey im proved their system by adding rule based elim ination to the FP reduction stage. (

2.2 Rule Based Techniques

R ule based techniques try to detect nodules using a set o f features w hich are then applied to binary rules, the outcom e o f w hich are used to identify nodules. O ne such technique w as developed by [9] and focuses heavily on rule based feature analysis w ith a strong em phasis on nodule context. The first step involves extracting the lung fields from the C T data set. This approach involves using a fixed threshold to perform an initial segm entation o f the lungs. To only include the lungs in the segm entation other objects that w ould also fall below the threshold such as the trachea are elim inated based on their cross-sectional and intra-series positions. The rem aining volum es are considered to be the lungs. C ontours are taken for the lungs on each slice w here they exist. The contours are then sm oothed to fill any gaps along the borders. This approach is sim ilar to the one perform ed by [8] but it uses b o rder pixel analysis along w ith shortest point linear connections to fill gaps. The effect is very sim ilar to the rolling ball algorithm m entioned earlier. The lung volum e is then analyzed and split up into 4 sections w here groupings o f adjacent CT slices belong to a particu lar section. B efore extracting the R O ls the lungs w ould be preprocessed. The lungs w ould be sm oothed by using basic m orphology operations follow ed by unsharp m asking to im prove R O I extraction by providing m ore strongly defined and separated structures. A fter the preprocessing the ROI extraction phase begins. The lung regions are separated into air and organ clusters. T he nodule candidates belong to the organ cluster. They then apply thresholding on the organ cluster to ex tract the R O Is. N ext, they perform surface curvature analysis in the intensity plane o f the R O I candidates in order to further refine them . W ith the RO Is defined they now proceed to rule based FP reduction.

14

The first stage o f FP reduction involves extracting the feature set for each ROI. The features are: area, thickness, circularity, grey-level, variance o f grey-level, localization, variance o f gradient, distance from the lung wall, convexness and contrast. From these features they develop rules which deal with nodules in different cases. They take separate approaches for nodules which are interior and those which contact the lung wall. One o f the major positives about this approach is distinguishing interior nodules from lung wall nodules and evaluating them using separate rules. Another good point to note is that the features chosen do make an attempt to take the context into account. The convexness and the contrast features are used to analyze the surrounding pixels for nodules contacting the lung wall. The reported results for this system were 90% sensitivity and 0.3 FPs per slice. These good results along with a well thought through approach make this a very promising system. Another rule based approach was developed by [23]. For lung extraction a grey level histogram o f the data set is analyzed and a threshold, to separate the lungs from their surroundings, is found based upon separating the two major peaks o f the histogram. Volumetric analysis and 3D connectivity is used to form a complete lung volume. Morphological closing is applied to fill in any gaps and to smooth out the lung contours. For ROI extraction a 3D local density maximum (LDM) algorithm is used. The lungs are thresholded from an intitial value to a bottom value incrementally in evenly spaced steps. The top threshold can be chosen as the highest pixel value in the lung volume while the lowest can be the smallest. Objects are identified at each threshold and, if taken as a ROI, are kept separate by not allowing them to be assimilated into larger objects at lower thresholds. This attempts to separate connected components with different density profiles. A rule based approach is used to reduce FPs using three features; object volume to modified bounding box volume ratio, maximum depth to cross-sectional projection length and major to minor cross sectional bounding box ratio. These features focus strongly on shape properties while also looking at the compactness o f the ROI.

15

The results produced a sensitivity o f 84.2% w ith 5 FPs p er CT case. It should be strongly no ted that these results w ere perform ed on a set o f 266 sim ulated nodules as the researchers did not have access to a real CT database o f lung nodules. This technique presents a n ew approach to RO I detection that is geared tow ards being able to separate connected com ponents. This is an im portant goal because nodules due tend to overlap w ith other structures w hich m akes them m ore difficult to segm ent properly. A lso, the rule based approach is a sim ple approach that focuses on 3D structure. This technique w as im plem ented for this thesis because o f its sim plicity and good reported results. E xperim ents found the system to perform very poorly on our CT data; further details are presented in the results section, chapter 6.

2.3 Template Matching Techniques

A tem plate m atching technique attem pts to use a prior database o f nodules that can be used to find sim ilar objects in the target analysis. R ules are often used after the tem plate m atching step to reduce the FPs. A tem plate m atching approach is attem pted b y [21]. This system is based on m atching nodule candidates to m em bers in a pre-existing nodule tem plate database w hile using rules to reduce the num ber o f FPs. The basic prem ise o f tem plate m atching is that a database o f nodule tem plates could be u sed to find sim ilar candidates in the lung volum e. They used a spherical m odel w ith a G aussian distribution based on their analysis o f the characteristics o f real lung nodules. T hey used four 3D lung nodules w hich w ere evenly spaced in diam eter from 10 to 40 pixels, w here one pixel w as 0.638 mm. To detect nodules that appear in only one slice, the m iddle sections o f each 3D m odel w ere used as 2D m odels. A genetic algorithm w as used to find nodule candidates by locating areas that w ere sim ilar to any o f the m em bers o f the tem plate library. They also perform ed a separate search along the lung w alls for R O Is that did not use a genetic algorithm . T hey w ould use a general tem plate m atching technique by going around the b o rder o f the lungs and using a m odified version o f the tem plate library. The tem plate library w as m odified by stretching the G aussian m odels in the x-direction and using halves o f those ellipsoids as the new tem plates. F o r

16

the lung walls the templates were rotated to be tangent with the lung wall surface for each point o f inspection. For FP reduction they used a rule based approach incorporating a set o f 16 features: mean, standard deviation, area, circularity, irregularity, contrast, max mean CT value, directional variance o f pixel gradient, directional cross-correlation o f pixel gradient, inverse difference moment, entropy, second area, second mean, local mean, local standard deviation and local directional variance o f pixel gradient. Their results for the technique indicated a sensitivity o f approximately 72% with 5.5 FPs per CT case. This was an improvement over their previous work [24] where they had the same sensitivity but a much higher number o f FPs at 30.8 per CT case. In the previous experiment they used only 11 features as opposed to 16 in the current one for FP reduction. One o f the major challenges with this kind o f approach is the nodule template library. In this case the library was relatively small but even with a more comprehensive library it remains difficult to try to account for all possible nodule cases. One o f the major positive contributions from this paper is the realized FP reduction by improving a rule based technique from their previous approach.

2.4 Fuzzy Neural Network Technique

This approach uses a combination o f fuzzy logic with traditional neural network based training. This approach is interesting as it tries to blend together two approaches which separately can work well for feature based decision problems. A fuzzy neural network approach was presented by [22]. To segment the lungs they use a threshold value to form a binary image. This image is then median filtered and operated on by morphological closing. Finally, region growing is applied to fill any gaps remaining in the lung fields. For the ROI acquisition mechanism a histogram analysis is performed. The grey level value that retains the top 20% o f the pixels in the lung volume is used to threshold the image. The objects that remain after the tresholding are the ROIs.

17

F o r feature reduction, a fuzzy neural netw ork approach is used. A s inputs to the netw ork three features are m easured for each RO I: area, circularity and m ean grey leveL A fuzzy neural netw ork is a com bination o f fuzzy logic and neural netw orks. T he m ain prem ise behind fuzzy logic is that it is an intuitive w ay o f looking at problem s, instead o f using specific equations general truths are used, im plem ented through rules [25]. T hese rules provide the appropriate guidelines for a solution. For exam ple, in this

im plem entation the area feature is assigned a m em bership value betw een 0 and 1 for three fuzzy m em bership functions that determ ine the R O Is m em bership to three different categories o f size: sm all, m edium and large. All o f the m em bership functions are then applied to rules and then into a defuzzification layer w hich detennines w hether the R O I is a nodule or not. The neural netw ork portion o f the system is responsible for the w eights assigned to the inputs going into the fuzzification layer and w eights assigned to the output o f each rule going into the defuzzifaction layer. The neural netw ork uses the gradient steepest descent m ethod [22] to train using a set o f 20 patterns (12 nodules, 8 non-nodules) cyclically until the m ean square error falls below a certain target. T heir reported results w ere a sensitivity o f 89.3% w ith 0.3 FPs p er CT slice. The target size o f objects they can detect is betw een the areas o f circles w ith diam eters in the range o f 10 m m to 50 m m . Som e o f the positives from this approach are that fuzzy logic is a potentially good candidate as an approach for lung nodule detection. Fuzzy logic is very effective in techniques that need m ore than a binary process [2 5-27]. A pplying a neural netw ork to a fuzzy system is a good attem pt at integrating tw o system s that are often used fo r problem s that depend on feature analysis. The im plem entation o f the system appears to need m ore refinem ent. The ROI acquisition stage is a very sim ple single level thresholding approach, w hich is a regression from a M LT approach in term s o f thoroughness. The num ber o f features used is lim ited to three w hile providing no context for the R O I in term s o f 3D features or its surroundings. A lso, the neural fuzzy netw ork is trained using a very sm all set that consists o f only 20 unique patterns w hich is no t ideal for a robust problem sueh as lung nodule detection. A lso, the target size o f nodules being over 10 m m lim its the effectiveness o f this approach as a significant portion o f nodules tend to be below 10 m m in size. Though this approach does introduce an interesting

18

fusion o f two potentially effective techniques the implementation and execution need to be refined to explore the true potential o f this kind o f a system.

2.5 Hybrid Rule Based and LDA systems

This kind o f approach tries to combine rule based techniques and LDA based techniques. Both have been used as the primary form o f FP reduction separately but in this kind o f approach both techniques are fully implemented into the system. A combination o f a thorough rule based approach and LDA was proposed by [17]. For lung segmentation a fixed low threshold was used to segment the body form the background initially. The lungs were extracted using k-means clustering. In this case k = 2 since there are only two classes, air and body pixels. The lungs were further separated into sections by splitting lungs on each CT slice into a peripheral sub-region and a central sub-region which would be used later for FP reduction. To fill discontinuities along the lung borders they used indentation detection [17] which similarly to previous techniques used a straight line to connect gaps in the lung borders. To obtain the ROIs a k-means clustering technique was used with k - 2, similar to the approach used for segmenting the lungs. The number o f pixels belonging to each class was related by a ratio which varied depending on where the clustering was being done. For upper slices and lower slices less ROIs were expected so the algorithm used a higher ratio o f background to object pixels. For the middle portion o f the lung the ratio was smaller so more objects could be detected. Some o f the outputs due to this technique would contain holes; these were filled since nodules are considered to be full structures. FP reduction was a multi-stage process. First 2D rule based reduction was applied, based on the ratio o f major to minor axis o f an equivalent ellipse followed by a compactness criterion. The remaining 2D objects would then be connected using 26 point connectivity. Four more rules were then applied for these objects relating to the bounding box size, maximum circularity and a relation of the location o f the object to its size. At this point 3D features were extracted from the remaining candidates: volume, surface area, mean grey level, grey level standard deviation, skew and kurtosis o f the grey level histogram. The last part of FP reduetion involved applying LDA. For the LDA process

19

the follow ing features w ere used: volum e, surface area, m ean grey level, standard deviation o f the grey levels, m axim um cross sectional area, perim eter, m ajor and m inor axis, circularity and eccentricity. The results after the rule based elim ination w ere a sensitivity o f 87% and 2.92 FPs per slice. A fter applying LD A the sensitivity fell to 84% w hile reducing FPs to 1.74 p er C T slice. T his approach results in a thorough and prom ising com bination o f LD A and FP reduction. The approach uses an extensive and effective com bination o f rules and features to perform FP reduction. The rule set w as large and tried to account for nodule context and internal properties. The LD A perfoim ance suggests it can be an effective tool to use in order to reduce FPs w hile retaining good sensitivity perform ance.

2.6 Automatic Lung Segmentation System

A system focused solely on autom atic lung segm entation w as produced by [18]. In m ost papers lung segm entation is treated as a precursor to nodule segm entation, how ever, in this paper lung segm entation is the focus and is addressed w ith m ore depth and attention. This is beneficial because proper lung segm entation is very im portant in the p roper identification o f nodules along the lung w alls as w ell as producing com plete and p roper lung volum es. T he process begins w ith choosing a threshold for the lungs. The threshold is based on a technique called optim al thresholding [18]. This tries to find a threshold that w ill separate air voxels from body voxels through an iterative feedback process. O nce the threshold value is found it is applied to the CT scans the background is elim inated by finding air voxels that are connected to the borders o f the CT im ages. The lungs are obtained by only obtaining those air groupings w hich m eet a m inim um size criterion. A fter this volum etric based reduction the trachea is identified and elim inated using a slice b y slice region grow ing approach. Topological analysis is used to fill in any enclosed holes left in the lungs after thresholding. To fill in any indentations left along the lung w alls a m orphological closing is applied.

20

This paper presents thorough and detailed guidelines for lung segmentation that are not present in works where the main focus is lung nodule detection. They also provide a performance metric by comparing their segmentation results to manual traces o f the lung regions. The mean difference between the borders o f the manual traces and the lung segmentation system was 0.48 pixels.

2.7 Comparing Results

Comparing results to objectively evaluate the relative performance o f different techniques is very important. For proper comparison you would have a robust, publicly available test set that all techniques could use. This way the results would have merit relative to each other and also in an absolute sense due to the integrity o f the test data. Currently there are no such databases but there is a government initiative in the US to produce one [28]. This initiative has produced a preliminary 23 nodule database that is intended to contain 400 nodules when it is complete. Given the current climate, all the researchers to date have needed to find their own data sets and obtain results from them. This point especially makes it difficult to compare techniques based on their reported results since there is no absolute way to judge the differences between nodule sets. In addition this makes it difficult to implement learning algorithms in a system because researchers are limited with the cases they have access to. As alluded to in the introduction there are many different types o f nodules that can exist in many different contexts. Even with access to a significant amount o f data it would be difficult to gauge if it was complete enough to produce a completely robust system. The problem o f objectively comparing the results o f differing techniques is one that has been recognized and investigated to some degree [17]. An example o f the disparity that can occur for the same system using different data sets was examined by [17]. This problem is further addressed in the results section, chapter 6, which includes an evaluation o f the technique produced by [23]. The results in table 2.1 can show how much the data set can affect the performance o f a system. This is reflected very strongly in the system by [29] which had

21

excellent results on their initial data but failed significantly on a subsequent data set [17]. T he system in [8] had w eaker initial perform ance but th eir approach proved to be m ore robust and they actually im proved th eir FP perform ance by refining th eir system [19]. T he m ain point that is reinforced in table 2.1 is that the experim ental results can not be u sed as an absolute com parison m etric since everyone is using different test data. From table 2.1 it can be seen that the technique that had excellent results initially failed on a different data set.

Initial System Sensitivity Fiebich et 95.7% al. Arm ato et 72% al.

Secondary V ariation A ssessm ent 30% -6 5 .7 %

Initial FPs 0.3

S econdaiy V ariatio ijjl A ssessm ent
.

6.3

6

71%

-1 %

4.6

1.5

-3.1

T able 2.1: Perform ance results o f nodule detection system in initial and follow up studies from [ 17]

M any o f the techniques listed involve a rule based stage for FP reduction. A rule based approach is an excellent foundation for a nodule detection system as it can be easily controlled and it is easy to directly im plem ent advice from radiologists. The w ork by [9] is entirely rule based and has good reported results. The reported perform ance results for the techniques that have been listed are in the range o f 70% to 90% w here FPs have ranged betw een 0.5 to 4.6 FPs p er slice. These are good general guidelines for the w orking param eters o f a system since this encom passes a w ide range o f perform ance results using different system s over different data sets. The objective is to m ake an initial attem pt at creating a robust system , but m ore im portantly one that can serve as a foundation w hich can be built upon. F o r this reason it w as initially desired to design a sim ple rule based approach inspired by the w ork o f [23] w ho have delivered a system that uses a sim ple rule based FP reduction stage along w ith an innovative new R O I extraction algorithm . This approach is later exam ined in the

22

results section, chapter 6, and is found to have significant problems. For the development o f the lung segmentation stage most papers do not produce much detail so the work done by [18] served as a good model from which to develop a lung segmentation technique.

23

m #g:

Chapter 3 Lung Nodule Synthesis
T he m ost im portant resource needed for developing a lung nodule detection system is a lung nodule database. U nfortunately, there have been no public data sets until recently [28] so obtaining test data has been a challenge in and o f itself. E ven this data set is prelim inary and is still being com pleted. To obtain data researchers partnered w ith hospitals to gain access to the resources they need. For schools that can not establish these partnerships research in the area o f lung cancer detection has been difficult. To w ork around this problem some researchers have created data sets by creating synthetic nodules w hich they then insert into the test data [23], [30], [31]. Synthetic nodules can even be used to test techniques built on real nodules or to potentially increase a lim ited data set that m ight be available to a researcher. This can allow the researcher to artificially create cases that are not present in their data or to create an artificially large database to evaluate the potential o f using synthetic nodules as input into learning based approaches. C om er cases are an excellent application o f a lung nodule synthesis technique as even w ith a real nodule database it can be difficult to find them . L earning based techniques usually require a large and diverse set o f inputs to train the system to a point o f stability; synthetic nodules have the potential to produce the volum e and context necessary in such a data set. In these regards synthetic nodules can be useful for a variety o f developm ent and testing purposes that are lim ited by a clinical CT data set.

3.1 Lung Nodule Synthesis Approach

CT im ages o f real lung nodule cases form ed the basis fo r the lung nodule creation technique [30-38]. The prim ary focus o f this w ork w as to create nodules w hich are

24

relatively circular. This allows the nodule synthesis system to target a particular structure in order to clearly define the goal o f the synthesis technique. As already discussed, nodule shape and size can vary significantly, so it is important to have a clear focus for the type o f structure to be simulated. Using a circular model, which allows for elliptical deviation, permits the system to simulate a large subset o f nodules. There is freedom to set the context o f these nodules as they can be placed anywhere in the lung volume. In figure 3.3 the nodule resembles a sharp bell shaped structure. Based on this observation a Gaussian shape was used for the synthetic nodule structure. A Gaussian distribution has been used as a structural base in other experiments involving synthetic nodules [23]. It has also been used as the foundation for nodule templates in detection techniques [24]. The magnitude and standard deviation o f the Gaussian are all parameters that can be manipulated. The following formulas are used to create the Gaussian that forms the basis for the synthetic nodule [3]:

=g

(3.1)

The X and y terms in (3.1) refer to spatial coordinates along the x and y axes in a 2D surface and the o term refers to the standard deviation o f the Gaussian. In (3.1) the

scaling term is omitted in order for the Gaussian G{x,y) to be equal to one at its center. This result, G{x,y), is then sampled to create an M xN matrix, G[m,n], centered on the origin. The samples are taken using Ax and Ay equal to 1 as the sampling period. The Gaussian that is created is a perfectly symmetric 2D intensity image; however, the original nodule is clearly not symmetric as seen in figure 3.2.

25

Figure 3.1: A CT scan containing a nodule in the right lung (left side o f im age)

F igure 3.2: T he im age from figure3.1 zoom ed into the lung nodule w hich has been circled

26

Figure 3.3: Mesh o f real lung nodule from Figure 3.2

The next step in the creation o f the synthetic lung nodule addresses this issue. A random, asymmetric matrix is added to the Gaussian to provide it with an authentic look that would not be present if the image was a perfectly symmetric Gaussian.

R{m,n) - random^ ,, random^ ^ &{ - \,\\, distributed uniformly F{m, ?î) = « XG[m, n] + x R[m, n] (3.2)

In (3.2) a and p are scaling terms. These are used to control the magnitude and asymmetry o f the nodule during the nodule insertion process. The final step is to take the modified Gaussian, F[m,n], and insert it into a real CT image. This is done using a Graphical User Interface (GUI) that reads in the DICOM image data. To blend the nodule smoothly into the image any values o f the nodule that are less than those o f the image at the insertion coordinates are replaced with the original image value.

27

T he param eters that determ ine the appearance o f the nodule are accessible in the G U I. T hese param eters are the peak intensity and standard deviation o f the base G aussian, the dim ensions M and N o f the sam pling m atrix and the interval o f the random m atrix. The process o f inserting the nodule involves adjusting the param eters until the inserted nodule appears as desired by the user. From other studies real nodules w ere observed to have som e com m on characteristics. N odule diam eter is generally less than 30 m m , and they tend to be circular and slightly elliptical. For one nodule detection technique sm all synthetic nodules w ith a diam eter betw een 2 and 7 m m w ere created [23]. T hese nodules w ere restricted to circular shapes or ellipses w here one diam eter did not exceed the other by m ore than a factor o f 1.5. A different study [17] that used a database o f 64 real lung nodules provided statistics o f their diam eter values. Figure 3.4 contains the diam eters o f the nodules in this study, w here a value o f 8 m m m eans the diam eter w as in the range (4 m m , 8 m m ]. The diam eters had a m ean o f 8.89 m m , standard deviation o f 5.66 m m , m inim um o f 2 m m and a m axim um o f 25 m m . A bout 78% o f the nodules in their database had a diam eter less than or equal to 12 mm.

 o

"5
o

E

3

12

16

20

D i a m e t e r( m m )

Figure 3.4: D istribution o f nodule diam eters observed in the test data used by [17]

To produce credible lung nodule im ages the feedback o f a radiologist, or som eone w ho has professional experience w ith lung nodules in CT im ages, is desired. T his is im portant

28

to produce nodules with a realistic density distribution, shape and placement since visual assessment is the primary mode o f verifying the realism o f the inserted nodules. Ideally, the person using the GUI to create synthetic lung nodules would be an experienced radiologist.

3.2 Lung Nodule Synthesis Results

An example o f a synthetic nodule is presented in figure 3.5 alongside a real nodule.

Figure 3.5: A real nodule and a synthetic nodule below it are identified by a circle

From figure 3.5 it can be seen that the two circled objects are very similar in terms o f intensity and size. Also, the synthetic nodule is more circular than the real nodule in this particular case though this is adjustable. Looking at the synthetic nodule asymmetry is clearly present in the nodule which provides needed authenticity to the nodule. A radiologist confirmed that a set o f 23 synthetic nodules that were created had an authentic visual appearance. In general, nodules are judged primarily using visual analysis by a radiologist so the quality o f the synthetic nodules was validated after they passed visual inspection by an expert radiologist.

29

Inspection o f the m esh plot in figure 3.6 for the synthetic nodule also yields a good com parison to the real nodule depicted in figure 3.3. The shapes are sim ilar to each other. T he synthetic nodule does have the fundam ental G aussian shape as expected from (3.1) and the asym m etry gives it a gentle, natural noisy appearance in both the m esh and intensity im ages. The nodule does blend very well w ith its environm ent as seen in figure 3.5. The blending approach o f using the largest pixel value betw een the nodule and the background is used instead o f filtering as it tries to alter as few pixels in the im age as possible. Sharp drop offs for very dark backgrounds are not a concern as nodules can have very defined borders and high contrast w ith their im m ediate surroundings.

Figure 3.6: A m esh o f the synthetic nodule from figure 3.5

T he value behind creating synthetic lung nodules w as three fold. Initially, there w as no available C T data set w ith lung nodules so this w as going to provide, at the very least, som e data to experim ent on. Secondly, it provided an opportunity to learn m ore about nodules and their properties through studying them m ore extensively. L astly, it provided the opportunity to expand our own CT data prim arily for testing. Inserting the nodules as irregular separate structures should cause them to b e detected regardless o f

30

their exact density distribution due to the simple fact that they are abnormalities within the lung volume.

> N o d u l c _ e u !

Onginellmage

Enhencment ROI select

Zoom ed E nhanced Image

Q iü

Enhance Uppef Otg Uppet Map

Lowei Otg

Lowet Map

Enhanced Image

Value rrwd

S eed 1

1

1

50
RH

0
P eak

1 S av e Name:

5 RV

j

380
FuBness

Edil Text Reset to Ongtnal Zoom ROI select Save

i

5

1 2.7

J

R eset nodule ptopefües

mm
TctjL u 'j e n ...............

Figure 3.7: A screenshot o f the nodule synthesis GUI



............- '

`

31



^

^;v?,

.

Chapter 4 Lung Volume Segmentation
L ung volum e segm entation is a necessary step in a lung nodule detection system . Lung nodules are found w ithin the lungs so separating them from the rest o f the CT d ata is im portant in order to target a lung nodule detection system only in the areas w here lung nodules can occur. In addition to being a necessary step, it is also the first stage o f a lung nodule detection system , the basic outline o f w hich is show n in figure 4.1.

CT Data

Lung Segmentation

ROI Detection

FP Reduction

Lung Nodules

Figure 4.1 : G eneral structure o f a lung nodule detection system

T here have been few publications that deal in depth w ith lung segm entation [18], [39] w hich is unfortunate since good lung segm entation is an im portant factor in the total

32

process. By ensuring the lung volume is completely segmented the best opportunity is afforded to find all possible lung nodules. A simple and effective approach was provided by [18].

4.1 Lung Volume Thresholding

The initial step in segmenting the lungs is to find an appropriate threshold to begin with. To find the threshold value a modified version o f the technique used by [18] is used. The CT values are considered to consist o f body pixels and non-body pixels, finding a threshold attempts to identify a good boundary between these two regions. In figures 4.2 and 4.3 a single CT slice is presented and analyzed. Figure 4.2 (b) shows the area o f a CT image that represents the actual scan. This area is intuitively correct since CT scans occur in tube shaped chambers which lead to circular CT scan areas. Figure 4.3 shows the HU distribution of the CT image in figure 4.2 giving an idea o f the intensity value distribution o f the slice. In general, the area between -800 HU and 200 HU in a CT scan o f the body tends to be a valley but in this case there is a hill like distribution. This makes finding the appropriate CT threshold value particularly challenging for this slice since lung segmentation techniques usually try to find a value that is directly between the two major peaks at -950 HU and 150 HU which represent non-body and body pixel clusters respectively [18]. This approach is founded on the belief that a shallow valley exists between the two clusters. It is important to note that non-body pixels denote air and low density tissue where body pixels refer to high density objects within the body.

33

(a)

(b)

F igure 4.2: (a) a single CT scan, (b) T he effective CT scan area o f figure 4.2 ( a ) , areas in black are no t part o f the actual CT data

1200

1000

800
.5

0 1
GOO

400

200

-1000

-800

.600

-400

'200
HU

0

200

400

600

Figure 4.3: The HU distribution o f the CT scan in figure 4.2

T he approach by [18] tries to separate the body and the non-body pixel clusters using an iterative approach. The threshold value T, defines the threshold value at iteration i. T he initial value is To = -500 HU the m idpoint betw een -1000 H U and 0 H U the approxim ate values for air and w ater respectively. The m ean values o f the non-body and body pixels are obtained at each iteration, represented as fx,, and ^b-

34

f M ^ M,, + Jh

( 4 . 1)

2 The process described by (4.1) continues until places. This approach works well in dividing the HU distribution in a manner that provides a large separation between the major peeks o f the body and non-body pixels in a CT image. This approach works well for cases where the two major peaks are separated by a shallow valley, as is the case in most CT scans. This does not work well for the CT slice denoted in figure 4.2, the reason being that the two peaks are separated by a hill-like distribution. Clustering into two relatively evenly split sets becomes challenging and ineffective in this case. The key to resolving this problem is that even in cases where the two peaks are separated by a shallow valley there is a large range o f acceptable values that can be chosen for the threshold. The value can fall anywhere in the valley between the bases o f the two peaks and the threshold will provide a good separation. This means biasing the threshold to the body cluster peak would be acceptable in the general case and in the case where the shallow valley does not separate the two major peaks in the HU distribution. This system uses the algorithm of (4.1) but it does not include any pixels below -874 HU in its calculations. This value was found experimentally by adding 250 to the HU floor of 1024. This biases the threshold value higher while not being affected by rare distributions since the adjustment is absolute and not density dependant. Using the system's approach the threshold was found to be -220 HU where using all pixel values the threshold was found to be -440 HU. As can be seen from figure 4.4 using the higher threshold value included a significant portion of the lung volume in the non-body pixels that was not present in the initial thresholding. A significant portion o f the lungs in this case would have been omitted without using a threshold value closer to the body pixel cluster in figure 4.3. By using the higher threshold value it can be observed that the lung volumes were segmented properly by the thresholding step. is equal to T rounded to two decimal

35

(a)

(b)

(c)

Figure 4.4: the results o f thresholding the CT slice in figure 4.2 w ith HU values o f -440 (a) and -220 (b) w here the w hite pixels are considered body pixels. The im age in (c) show s pixels that are reclassified as non-body pixels w hen com paring (b) to (a). In figure 4.5 a m ore norm al exam ple o f a CT slice containing the lungs is seen. T he H U distribution in figure 4.6 shows o ff a m ore typical distribution for these kinds o f C T im ages characterized by a shallow valley betw een the tw o m ajor pixel clusters. U sing the approach by [18] the threshold obtained w as -440 HU and by our technique it w as -363 H U .

36

Figure 4.5: A sample CT image with normal contrast and HU distribution

600

500

400

"

300

200

100

0
1000 -800 600 400

200

0

200

400

HU

Figure 4.6: The HU distribution o f figure 4.5, in this case characterized by a shallow valley between the two major pixel clusters

An example o f thresholding a normal CT slice containing the lungs using both approaches is presented in figure 4.7. Both thresholds do a good job o f segmenting out the lung volumes. It can be seen that the two segmentation results provide the same basic segmentation by observing the difference image in figure 4.7 (c).

37

(a)

(b)

(c)

Figure 4.7: the results o f thresholding the CT slice in figure 4.5 w ith HU values o f -440 (a) and -363 (b) w here the w hite pixels are considered body pixels. The im age in (c) show s pixels that are reclassified as non-body pixels w hen com paring (b) to (a).

N o w that this thresholding approach has been show n to be robust and effective the process can proceed to the next step o f actually extracting the 3D lung volum e.

38

4.2 3D Lung Volume Extraction

^

With a thresholding approach being well defined the rest o f the lung volume segmentation process continues. The first step after thresholding involves removing the background pixels. This is done by eliminating 2D 8-connected non-body components that are contacting the image border.

Figure 4.8: The grey pixels around the white pixel are considered connected to the white pixel in an 8-connectivity scheme Figure 4.16 is the result o f eliminating the non-body pixels connected to the border o f the image in figure 4.15. Here it is seen that the majority o f the background is eliminated save for some small objects around the lungs and an artifact at the bottom o f the image which resulted form non-body pixels being isolated from the image border. These artifacts are eliminated later on.

39

Figure 4.9: T he results o f thresholding figure 4.5 using a CT value o f -363 H U w here the non-body pixels are represented in w hite

Figure 4.10: The result o f elim inating all non-body pixels w hich are connected to the im age border in figure 4.9

T he next step in the process involves rem oving any holes that are com pletely contained w ithin a non-body object. This consists o f finding body pixel objects w hich have no contact w ith the im age border. From figure 4.10 m any body objects can be seen that are represented w ith black pixels contained com pletely w ithin the lung objects. The results o f rem oving these isolated objects can be seen in figure 4.11.

40

Figure 4.11 : The results o f removing the isolated body pixel objects from the lungs in figure 4.10

After removing the holes from the lungs the next step in the process involves finding a seed image for the rest o f the lung segmentation process. The seed image is used to perform 3D region growing to allow for a complete and well defined lung volume. The technique developed by [18] for complete lung volume segmentation is used only to find the seed image for the system's lung segmentation process. The existing lung segmentation technique basically retains all non-body objects on the current slice which exceed 1% o f the total pixel count o f the image. In this ease the image is 512x512 pixels meaning the 1% limit is any object above 2621 pixels. If more than two objects exceed this minimal limit than the two largest ones are retained. This criterion effectively eliminates the trachea from the segmentation since it is generally too small to exceed 1% o f the total number o f pixels. On the negative side, when a lung is split up into multiple large pieces, such as when the diaphragm enters the CT images at the bottom o f the data set, part o f the lung will be eliminated because there will be more than two pieces which constitute the lungs on that particular slice. This erroneously excludes part o f the lung volume. This also affects the lung volume when it is divided into multiple pieces by vascular tissue. Also, near the top and bottom o f the lungs, parts o f the lungs will not necessarily exceed the 1% threshold so they will also be incorrectly eliminated from the lung volume. Therefore, this technique, developed by [18], works well for the larger, well

41

defined parts o f the lungs but has difficulties n ear the top and bottom o f the lung volum es. To address these shortcom ings region grow ing approach w as introduced w hich uses a set o f seed im ages. The initial seed im age is found by finding the first slide from the top o f the CT scan that has at least two objects w hich exceed the 1% volum e criterion, if there are m ore than tw o then the tw o largest ones are retained. U nfortunately, there are infrequent cases w here parts o f the lungs are cu t-o ff due to high intensity vascular tissue in the lung volum e such as illustrated in figures 4.13 and 4.14. In that case the isolated region w ould be excluded from the lung volum e. To address this two m ore seed im ages are obtained. T he next two slides are chosen as these seed im ages and the sam e volum e constraint is used to obtain two lungs. This redundancy is an attem pt to m axim ize the chances that at least one seed im age is a proper representation o f the lung volum e for that particular slice. The seed im ages are further processed using the m athem atical

m orphology operators o f dilation and erosion [3], [40], [41]. The purpose behind this approach is to sm ooth the lung borders and to fill in any indentations. Indentations are often caused by vascular tissue along the lung wall. A ny objects along the lung borders have a high chance o f being lung nodules so it is very im portant that the lung volum e include these objects. Large vessels near the centre o f the CT im ages also cause large ruts in the lung borders; they also need to be included in the lung segm entation.

42

(a)

(b)

Figure 4.12: (a) The lower portion o f the lung volume where the diaphragm has entered into the scan for both lungs, (b) shows the results o f thresholding (a) producing three pieces that are legitimate parts o f the lung volume

Figure 4.13: A CT slice with a significant amount o f vascular tissue in the left lung indicated by a circle

43

i
(a) (b)
F igure 4.14: (a) The result o f thresholding figure 4.13 resulting in a piece o f the lung being separated by vascular tissue as is illustrated in (b) w here the section being c u t-o ff is zoom ed in on

Figure 4.15: A CT slice near the top o f the lung volum e

44

Figure 4.16: (a) the result of thresholding figure 4.15. (b) The result o f retaining only objects which are larger than 1% o f the pixel count o f the image in (a).

In figures 4.18 (b), it can clearly be seen that the segmentation process to this point has not properly reproduced the border o f the lungs from the original image in figure 4.17. This is more obviously seen in figure 4.18 (c) which shows a close-up o f the right lung.

Figure 4.17: A CT slice with significant objects near the lung borders

45

L

(a)

(b)

(c) Figure 4.18; (a) the results o f thresholding the CT slice in figure 4.17. (b) The result o f filling, elim inating the background and retaining the tw o largest objects that satisfy the volum e criterion from (a), (c) An enlarged im age o f the right lung from (b) clearly show ing the state o f the lung border.

To alleviate this problem m orphological closing using a 30m m disc as the structuring elem ent is used. The choice for size o f the structuring elem ent arises from the typical m axim um agreed upon size for a lung nodule. In extrem e cases nodules have exceeded the 30 m m diam eter characterization; how ever, in the vast m ajority o f cases this

46

structuring element is sufficient. The structuring element can close gaps in the borders up to 30 mm wide. It does a good job o f filling in omitted vessels and it is small enough to prevent the two lungs from being joined. The reason the structuring element is circular is to produce curved boundaries after closing since the lung boundary is generally curved. A fter morphological closing a complete and accurate segmentation o f the lungs is produced. A comparison between the two segmentations and the final results are illustrated by figures 4.20 and 4.21.

Figure 4.19: The results o f morphologically closing the objects in figure 4.18 (b) using a disc structuring element with a 30 mm diameter

47

I"'"

(a)

(b)

Figure 4.20: (a) The grey area represents the original segm entation from figure 4.18 (b); the w hite area represents the new area covered by figure 4.19. (b) is a m agnified im age o f the right lung (left side o f im age)

(a)

(b)

Figure 4.21 : The results o f the (a) pre-m orphology and (b) post m orphology segm entation o f the CT slice in figure 4.17

H aving obtained the final seed im ages the process can proceed onto the rest o f the segm entation procedure w hich deals prim arily w ith region grow ing. The region grow ing aspect o f this segm entation technique allow s it to overcom e the w eaknesses present in a

48

pure volumetric approach which are excluding small top and bottom portions o f the lungs as well as omitting chunks o f the lungs because they are separated by vascular tissue. Before the actual region growing process begins the rest o f the CT slices are also processed in a manner similar to the seed images. All CT images are thresholded using the same CT value as the seed image. After thresholding all non-body objects in contact with the image border are eliminated. All body objects contained within non-body objects are converted to non-body pixels; this is basically filling in the holes within the lungs. At this point the non-seed images are left for the region growing process. It is important to note since there are 3 separate seed images and this process is done in parallel for each seed image then each seed image is a normal slice in 2 o f the other processes. This means that the region growing approach actually applies to the seed images due to the parallel and independent nature of the region growing technique. Having processed all o f the images each CT slice consists o f multiple non-body pixel objects. For connected components in 3D a 26 point connectivity scheme is used. This means that for a given pixel any other pixel contained within a 3x3 cube centered at the given pixel is connected. The premise behind the region growing approach is that if non-body pixels are connected to the lung volume on an adjacent slice then they are part o f the lung volume. This means the non-body object does not fall under volume constraints and there is no limit to the number o f objects in a CT slice that can be included in the lung volume. The seed image is the master lung volume that the rest o f the volume is grown from. The lungs are grown both up and down. Another attribute o f the lung volume analysis also identifies objects in the target slice by which object they are connected to in the seed slice. Morphological closing is applied independently on these groupings to attempt to join objects that are separate but in fact belong to the same object and also to keep objects separate which do not belong together. This particular approach basically refers to keeping the left and right lungs separate as well as rejoining any parts o f the same lung that might have been faintly separated during the thresholding process as in figure 4.14. When the adjacent slice to the seed image is done with the morphological closing then it is complete and acts as the seed image for the slice adjacent to it that has not been processed. Once a CT slice with no more attached non-body objects is reached then the process stops. This process is done in both top and bottom

49

directions starting from the seed im age. O nce all three o f the lung volum es are com pleted in parallel then the results o f each are logically O Red together to produce the final lung volum e. The entire lung segm entation process is sum m arized in figure 4.22. The stages w hich involve processes which have been developed or created in this system are highlighted. The system 's overall lung segm entation process im proves on past processes by including regions in the top and bottom o f the lungs w hich are elim inated in volum etric based approaches. The system is also able to reattach parts o f the sam e lung that are separated by vascular tissue due to the region grow ing approach. In addition, by using connectedness as an attribute the lungs can be closed separately. This prevents m orphological closing from joining the tw o lungs if they are close together into one large lung volum e. N ow w ith the lung volum e properly extracted nodule detection stages o f the system can be exam ined.

50

CT Data Set

Remove Background Non-Body Objects and fill in body holes in Non-Body Objects

Find first slice,N, from the top of the CT set with at least 2 objects that meet volume criterion

et slice I ^ N + l , N+2 as seed' ages and retain only the twpx ^ largest objects for each slice ^ N
r 1r

N+1
' r

N+2

Apply morphological closing to the CT image V . N 1f N+1 N+2 U

Apply 3D region growing t^adjacent no processed slices sequentially

N

N+1

N+2

Apply morphological closing on each lune B separately, if the set still has unprocessed slices en feedback in the 3D region growing step N N+1 N+2

Logically OR the three separate lung volumes

Segmented Lung Volume

Figure 4.22: An overview o f the lung segmentation process where grey boxes represent our unique contribution to the lung segmentation process

51

Chapter 5 Lung Nodule Detection
T he m ain focus o f this thesis lies in the lung nodule detection portion o f the process. In the com plete system overview from figure 4.1 the lung nodule detection process encom passes both the second and third stages o f R O I D etection and FP reduction. T he first part o f the process involves acquiring the actual nodule candidates from the lung volum e; the second portion involves reducing the num ber o f candidates b y elim inating as m any FPs as possible.

5.1 Lung ROI Extraction

T he approach used for ROI extraction is based on M L T [8], [42-44]. The m ain reason for using this technique is that it is both easy to control and at the sam e tim e has proven to be effective [19], [45]. Initially, a technique based upon the LD M algorithm from [23] w as being developed because o f the reported potential for perform ing w ell in segm enting connected but unrelated objects. T he M L T technique obtains thresholding levels using the CDF o f the lung volum e. This allow s us to adaptively choose our thresholding levels in a w ay that is relevant to the density values represented in the lung volum e. This non-linear approach is an innovation over the technique used by [19] w here uniform ly spaced intervals w ere used at p reset threshold values. By using adaptive thresholding our technique is m ore robust to cases w here the density values in the lung volum es are irregular and the density values o f interest range over different intervals. An exam ple o f a C T scan w ith an irregular density distribution is provided in figure 4.2.

52

To select the thresholding values two ranges o f interest are identified, the nodule range and the vessel range. The nodule range refers to density values that could likely make up nodules. The vessel range identifies very high intensity density values that can belong to well defined blood vessels or nodules alike. This definition implies that the vessel range is a proper subset o f the nodule range. From this point on the term density refers to the grey level value not the HU metric. The HU unit provides a primarily negative value range in the lung volume where the grey level provides only positive values.

Grey Level - HU + 1024

( 1)

The HU values range between -1024 and 3072 for a given CT scan where the grey level equivalents range between 0 and 4096. Based on the presented range it is easy to infer that the density values in our CT scans are represented by 12-bit values. A number o f CDFs o f the lung volume from a CT scan can be seen in figure 5.1.

I s

b

I

" 0.4

6 t i y L m l V i)v t

Figure 5.1: Three CDFs o f three separate lung volumes

53

Figure 5.2: Three CT slices com ing from the three separate lung volum es represented by the CD Fs in figure 5.1 aligned from left to right In term s o f the nodule density range the goal was to look at the range o f intensity values w here nodules w ould be likely found. The approach by [22] uses a single threshold at the 80% value from the CDF and gives at least a good starting point w ithin w hich to experim ent for the bottom o f the nodule range. H ere the grey level values corresponding to a range o f CDF values for the three different lung volum es are looked at.

CT S t u ^ 1 I CT Study 2 . CT Study 3

60% 191 294 335

65% 202 311 354

70% 215 331 377

75% 232 357 407

80% 256 393 448

85% :L 296 445 504

374 528 586

T able 5.1: The grey level values at different CDF percentage values for the three lung volum es from figure 5.1

The first thing observed from table 5.1 is that the grey level values can be very different for the same CD F values betw een lung volum es. These results support the use o f the C D F because the CD F is context sensitive to the variations in the intensity values o f the lung volum es w here absolute grey level threshold values are not. B y using the C D F the thresholding is perform ed relative to the density profile o f the particular lung volum e [46].

54

%

1

Figure 5.3: the first CT slide from figure 5.2 thresholded at each CDF value from 60% through to 90% from table 5.1 from left to right, top to bottom

55

Figure 5.4: the second CT slide from figure 5.2 thresholded at each CDF value from 60% through to 90% from table 5.1 from left to right, top to bottom

56

Figure 5.5: the third CT slide from figure 5.2 thresholded at each CDF value from 60% through to 90% from table 5.1 from left to right, top to bottom

57

The goal o f obtaining the bottom threshold for the nodule range w as to have a CT value below w hich it is unlikely that a nodule w ould exist. Based on the coverage o f the different CT levels from figures 5.3 to 5.5 the threshold was initially chosen to b e 65%. This w as later chosen to be the bottom o f the nodule range. In som e cases w here the density profile is very high the 65% CDF level w ould still be too high to detect faint nodules. To address this issue an absolute grey level floor value for thresholding w as found and tested against. I f the 65% CDF value w as above 300 then the low est thresholding value w as set to 300. The levels betw een the 65% CDF value and the 300 grey level value w ere uniform ly spaced at 20 and w ere used to only detect nodules. This step size w as based upon observed steps in the nodule range during testing and is sm all enough to provide good segm entation results. In defining the bottom o f the vessel range the main objective is to include only w ell defined, strongly form ed vessels. To satisfy this condition a very conservative approach w as taken and a CDF value o f 92.5% was chosen for the bottom , this exceeds the highest threshold values presented in figures 5.3 to 5.5. From figures 5.3 to 5.5 it can be seen that using a 90% threshold value already leaves only very high intensity objects, b y choosing a higher threshold it ensures a very rigorous standard for w hat objects can be considered vessels in term s o f their density. A high threshold value attem pts to prevent separate connected objects from being classified as vessels since connections betw een objects tend to be o f a low er density value than solid individual objects. T he initial threshold value is com m on for both ranges and is the highest level used in the thresholding process. This level is the starting point for the threshoding process and is higher than both the bottom values o f the nodule and vessel ranges. The initial threshold value is chosen as the 97.5% CDF value. Even at 92.5% only very high intensity objects w ill exceed the threshold and objects are very well separated. The C D F value o f 97.5% is a very safe initial threshold in that with very high certainty objects at this threshold w ill be separate unless they are actually strongly connected, or in fact the sam e object. In figure 5.6 it can be seen w hat the objects look like that exceed the bottom threshold value o f 65%. This image clearly illustrates how far the bottom nodule range value o f 65% goes tow ards trying to detect low intensity structures as em phasized in

58

figure 5.7. Table 5.2 shows that all o f the studies listed are close to having the 65% CDF value near 300 or below. In these cases using 300 as a bottom threshold does not significantly change the CDF based approach.

CT Study 1 CT Study 2 CT Study 3

65% 202 311 354

92.5% 444 586 638

668 768 804

Table 5.2: The grey level values at the threshold defining CDF values from figure 5.1

/£

...,

Figure 5.6: The thresholding o f the CT slice at the top left com er using CDF values at 65%, 92.5% and 97.5%. The thresholded images retain their original pixel densities where the threshold value is exceeded

59

Figure 5.7: A com parison o f the 65% threshold o f the slice from figure 5.6 and the resulting im age w hen the m ask is applied to the original CT slice. O f note is how m any dark pixels exceed the threshold.

N ow that the ranges are defined a set o f thresholds is defined. G iven the relatively , small C D F difference w ithin the vessel range o f 92.5% and 97.5% , 10 evenly spaced threshold levels are used in this range inclusive o f range end points. The range b e tw e e n , 65% and 92.5% contains 20 evenly spaced threshold levels including the 65% value but not the 92.5% value w hich is contained in the previous range. This increase in the num ber o f levels is determ ined by the m ore im portant role that this range plays in the lung volum e since it encom passes 27.5% o f the CDF. T he num ber o f levels and the use o f the C D F w ere determ ined through experim entation. The various stages and

perform ances using different thresholding approaches are detailed in the results section chapter 6. O ne novel com ponent to the M LT approach that has been added was using a density range to obtain one set o f ROIs. The prem ise behind this is that if a nodule is attached to a high intensity object that is denser than itself it will not be separated from that object w ith traditional thresholding. In this case the nodule range is used, w hich is defined to be betw een the 92.5% and 65% CD F value and does not include the absolute bottom m entioned earlier. All pixels that fall w ithin the nodule region are left on w hile all others are left off. This separates m edium intensity objects from high intensity objects. In this im plem entation it only leaves on pixels present in the nodule range. The im plem entation o f the approach is relatively sim ple but in its current form it is an

60

exploratory look at a concept that could be expanded upon and potentially used to produce an entirely new ROI extraction process. Instead o f thresholds a range that is moved in steps from the top to the bottom o f the density profile o f the data set could be used and it would be able to separate objects with density differences. This offers a new and interesting approach to ROI extraction that is worth exploring in future research. Returning the focus on the implemented ROI extraction process, each level uses an 8 connectivity 2D scheme to identify objects on each slice. Each threshold produces ROI objects. ROI objects in the vessel range are considered for both nodule and vessel candidates. Objects detected in or below the nodule range but not in the vessel range are considered only as potential nodule candidates. This produces thousands to tens o f thousands o f objects at each level. The MLT approach will process hundreds o f thousands o f objects for each CT scan due to because at least 24 thresholding levels will exist. A comparison between our approach and a technique developed by [23] which uses local density peaks to identify ROIs was carried out during the development process. Performance, time and ROI extraction are compared in the results section, chapter 6.

5.2 FP reduction

In order to reduce the number o f ROIs a FP reduction system needs to be implemented. The very first step taken to reduce the number o f FPs is size filtering. The datasets that are targeted contain 5 mm thick CT slices. In addition, this system initially targeted nodules whose areas are greater than or equal to a circle o f 4 mm in diameter (ie. 12.6mm^). In addition, since wall nodules are inherently more suspicious and can be quite small their minimum size needed to be larger than a circle with a diameter o f 3 mm (7.1mm^). Experimentation led to making the area range variable as opposed to fixed. The area range now depends upon the X, Y resolution o f the CT scan. For scans with an X, Y resolution above 0.65 mm the minimum areas remain at the 3 mm and 4 mm circles for the wall and interior nodules respectively. For scans with a higher resolution, a pixel area o f 0.5 is used when calculating the area. The main reasoning behind this was that visually, at a resolution o f 0.7 mm, 3 and 4 mm circles represented objects that were

61

clearly identifiable w hen looking at the picture. W ith higher resolutions, sm aller objects w ill appear big g er than they w ould in a low er resolution scan. Since the 3 and 4 m m circle m odels w orked well for resolutions around 0.7 m m the approxim ate area o f 0.5 mm^ w as used from these CT im ages to calculate the m inim um areas for higher resolution CT scans. The effectiveness along w ith the im plem entation o f this approach is further exam ined in the results section, chapter 6 . Size constraints are a very im portant consideration in the FP reduction process as they are very effective and usually represent the first stage o f FP reduction. U sing size alone brings dow n the num ber o f R O Is at each threshold level from hundreds o f thousands to a few thousand or hundred. This not only also saves a lot o f com putational pow er by elim inating so m any candidates early on in the FP reduction process. T he FP reduction system uses tw o separate approaches to reduce FPs for nodule candidates w ith and w ithout contact to the lung w alls, the effectiveness o f a dual approach like this has shown to produce good nodule detection results [17], [19]. It is generally m ore difficult to segm ent some nodules w hich are in contact w ith the lung w all, in particular w hen they are grow ing along the lung wall. In these cases the R O I extraction system can usually identify a portion o f the lung nodule because o f m orphological closing. A lso, objects in contact w ith the lung w alls are generally m ore suspicious than interior objects so the system is m ore sensitive by considering a w ider range o f w all connected objects through the m ore perm issive m inim um area criterion. A s an im portant addition at this point there is one significant problem that arises from the! lung segm entation that affects the FP reduction process. W hen looking at m any o f the segm ented im ages, a haloing affect around the lung border can be observed. These pixels interfere w ith feature extraction for the FP reduction phase. This haloing effect can b e seen around the lung borders distinctly in figure 5.5. To rem ove this b o rder a sim ple erosion o f the lung segm entation area is perform ed using a disc structuring elem ent w ith radius 1. T his erosion is perform ed prior to any features being calculated fo r the ROIs, including the area.

PROPERT'/OF

62

R Y E R SG tJ mvmsiTY Ü3RARV'

Figure 5.8: A disc structuring element o f radius I

It can be clearly seen in figure 5.9 that eroding the lung volume helps to significantly reduce the lung border effect in particular at higher threshold values since less o f the border is included in the threshold. At this stage the effect is reduced enough to allow for real border objects to be identified. The remaining lung border artifacts are dealt with later on in the FP reduction process or are eliminated during the area filtering procedure. At this stage o f the process nodule type classification is explored.

Figure 5.9: The effect o f eroding the lung volume on the thresholded images at CDF values o f 65% and 80% from figure 5.5

63

T o classify nodules as interior or wall nodules the perim eter feature is calculated. T he feature is calculated by dilating the object using a disc elem ent o f radius 2. By looking at figure 5.10 the disc structuring elem ent is exactly w hat a single pixel at the centre w ould look like if it w as dilated using figure 5.8 tw ice in a row.

Figure 5.10: A disc structuring elem ent o f radius 2

A fter dilation, those pixels w hich are new to the object w ould be considered perim eter pixels. I f any o f those pixels lay outside o f the lung volum e then those are considered to be external pixels. perim eter = P =
Pe

(5.1)

Ph

T he perim eter, P, is basically the percentage o f surrounding pixels that are outside o f the lung volum e w here pe are the num ber o f perim eter pixels external to the lungs and Pb are the num ber o f external pixels w hich are internal to the lungs. It is im portant to note that even though the surrounding pixels are not all in direct contact w ith the object, given the structuring elem ent in figure 5.10, they are still at m ost separated by one pixel. V isually, a spacing o f one pixel w ould usually be interpreted as connected since the object w ould be very close to the lung border. Therefore, in the w orst case som e objects w ould have a perim eter value greater than 0 if they are extrem ely close to the lung w all w hich could be practically interpreted as being connected. G iven these observations the structuring elem ent in figure 5.10 is suitable to use for the perim eter feature. The m ain use o f the perim eter value is to check w hether or not the object is connected to the lung w alls. I f the object has a perim eter value greater than 0 it is

64

considered a wall nodule candidate, if it is equal to 0 then it is an interior nodule candidate. The actual perim eter metric is unique to this detection system, as other systems have distinguished between wall and interior nodules before [17], [9] without actually quantifying the strength o f the connection as has been done through the perimeter feature. This measurement is used further along in the FP process for more than just separating nodules into wall and interior nodules. It also classifies wall nodules as lightly or strongly connected. The next step in FP reduction proceeds onto identifying nodules and vessels from the wall and interior nodule candidates. Nodules range in shape from spherical to ellipsoidal in terms of 3D shape. In terms o f cross-sectional shapes this amounts to nodules being circular to elliptical. The shape o f an ellipse is determined by its major to minor axis ratio. A circle is the case where an ellipse has a major to minor axis ratio o f one. The shape o f an ellipse and a circle also tend to be very compact. One way to evaluate compactness is to look at the area o f an object and compare it to the area o f its bounding box [17], [23]. From figure 5.11 the bounding box o f an object can easily be visualized. However, this bounding box idea does not traditionally work well for angled objects since the bounding box has been predicated on the X and Y dimensions o f the object.

Figure 5.11: A couple o f ellipse with their accompanying bounding boxes

The difference between a fitted tight bounding box and the traditional X,Y bounding box can be seen in figure 5.12. With the X, Y bounding box both the sides o f the rectangle and compactness are dependant on the orientation o f the object. W ith a tight bounding box an object could be at any orientation and the rectangle dimensions and compactness would be the same.

65

V, * v

Figure 5.12: A n exam ple o f w hat an X, Y based bounding box looks like on the left and a proper, tight bounding box on the right

In an attem pt to obtain a tight bounding box the orientation o f the object is obtained. T he orientation is found as the angle betw een the x-axis and the ellipse w ith the sam e second m om ents as the object [46], [47].

(5.2)

In (5.2) a and b are constants w hich determ ine the order o f the m om ent represented b y rrtab- A lso, x and y refer to spatial coordinates on the x and y axes on a 2D surface. T he order o f the m om ent in (5.2) is equal to a + b. The orientation o f the object is determ ined by using (5.3) w hich defines the orientation o f an ellipse based on its second order m om ents.

tan 2Û =

2m,
^02 ^20

(5 3)

In (5.3) 0 is the angle that represents the orientation o f the object w ith second m om ents m]j, mo2 an d m 2 Q . O nce the orientation is obtained using (5.3) it is then rotated [47] w ith bi-eubic interpolation [48] applied in order to set its new orientation at 0°. O nee the objects orientation is at 0° the bounding box can be obtained. This technique basically am ounts to rotating objects such that the trivial X , Y bounding box represents the tight bounding box. O btaining a tight bounding box for each object is unique to this technique.

66

Two features are computed using the tight bounding box, the compactness [23] and the axis ratio.

axis ratio =
m in{L^,Ly)

(5.4)

compactness - C - ---- \h

(5 5)

Both o f these features relate to shape of the object. In (5.4)

refers to the length

along the x-axis o f the bounding box where I,, refers to the length along the y-axis. In (5.5) Ao refers to the area o f an object and Abb refers to the area o f the objects bounding box. The axis ratio, Ran looks at the ratio o f the long side o f the bounding box to that of the short side to get an idea o f the 2D symmetry o f the object. A long axis ratio is usually associated with objects such as horizontal vessels in the lungs. Compactness, C, is a good identifier o f nodules, ellipses or other generally compact shapes. Since nodules tend to appear as circular or elliptical objects on CT slices then a high compactness is another discriminating feature for nodules. Looking at the areas o f circles, ellipses and rectangles [47] expected compactness values can be attained.

Area o f Circle = A^ - nr^ Area o f Ellipse - A^= nab Area o f Rectangle = A^= Iy.h

(5.6) (5.7) (5.8)

Compactness o f a circle = C ^ - --nr^ C = ------- , where I = h = 2r Ixh Q = ----- -- ----- = - ^ (2r)X (2r) 4r = - = 0.79 4

67

Compactness o f an ellipse = C =
nab Ix h C = -, where I = 2a, h = 2b ^ Aab = ^ = 0.79 4

nab { 2a ) x{ 2 b )

In the above equations r refers to the radius o f a circle, a and b refer to the m ajor and m inor axes o f an ellipse and I and h refer to the length and height o f a rectangle. From the above equations, both ellipses and circles have theoretically the sam e com pactness o f 0.79. In practice, since these are represented using discreet m atrices and there is no guarantee they are perfectly well formed, due to a n o d u le's actual shape along w ith im age noise, its com pactness w ill vary. The com pactness and axis ratio chosen for the system w ere based on experim ental results and the specific perform ance o f targeted border cases. G iven that lung nodule detection is im age based this system used a nodule that was visually ju d g ed to be a good border case in terms o f com pactness and axis ratio, as identified in figures 5.13 - 5.15. B order cases are im portant in setting thresholds for separating nodules from non-nodules and in classification problem s in general [49].

Figure 5.13: A CT slice w ith an exam ple o f a nodule, circled in black, that w as u sed to shape the com pactness and axis ratio nodule thresholds for the system

68

Figure 5.14: A threshold o f figure 5.13 at the 72.5% CDF level

Figure 5.15: The nodule circled in figure 5.13 and thresholded in figure 5.14

This nodule has a slight L shaped feature which will reduce its compactness, showing how an elliptical object can be slightly skewed in a noisy, discreet environment. It also is relatively long and so falls within the extreme case o f what an acceptable nodule's axis ratio would be. The traditional X, Y bounding box provides a compactness o f 0.5 and an axis ratio o f 1.44. Since the nodule is on an angle the compactness is obviously lower then a tight bounding box would represent. Likewise, obtaining the axis ratio is also

69

inaccurate as 1.44 is too low. A fter obtaining the tight bounding box the new com pactness is 0.65 and the axis ratio is found to be 1.86. These num bers are m ore intuitively inline w ith the visual interpretation o f the object in figure 5.14. To allow for som e flexibility w ith these thresholds the system used slightly less strict values than the values calculated for this nodule. The compactness threshold w as 0.6 and the axis ratio threshold w as chosen as 2.0. The nodule in figure 5.14 is approxim ately equivalent to a circle w ith a diam eter o f 6 mm. It is im portant to note that these values are thresholds used for the interior nodules. All interior nodules which passed these thresholds along w ith exhibiting a p erim eter value below 0,05 and an area m inim um w ere accepted. The low p erim eter threshold allows nodules which are w eakly connected to still be considered interior nodules. The area threshold w as exam ined earlier in the chapter as the m inim um size o f a nodule that could be detected. N odules in contact with the lung wall are handled differently. O bjects that exceed the m inim um area criterion, in contact w ith the lung wall, are considered very likely lung nodule candidates. W all nodules have slightly m ore lenient com pactness and axis ratio requirem ents o f 0.5 and 2.5 com pared to that o f an interior nodule candidate. W all nodules that are attached w eakly to the lung wall often can be m ore elongated and less com pact than interior nodules due to the connection, so that is the reasoning behind using a low er com pactness value and a higher axis ratio. W eakly connected wall nodules are considered to have a perim eter value o f 0.25 or lower, m eaning at m ost 25% o f their p erim eter pixels are connected to the lung wall. Strongly connected nodules are considered to have a perim eter value betw een 0.25 and 0.65. Strongly connected nodules do not have any com pactness or axis ratio restrictions as they can take on irregular, shapes and curvatures that are heavily influenced by the lung wall contour due to their strong connections. The upper lim it o f 0.65 is never practically surpassed as objects w ith higher p erim eter values w ould not be segm ented since they do not intrude into the lung volum e significantly. Even a sem i-circle w ould have a perim eter ratio o f approxim ately 0.61 and that is w ith the orientation o f the curved side touching the lung wall. It is im portant to note that all wall nodules have to be eonsidered thick as w ell. This addresses haloing artifacts that rem ain after lung volum e segm entation. B efore FP reduction m orphology w as used to reduce the lung volum e to reduce the haloing artifacts

70

as seen in figure 5.9. Even with this reduction some haloing artifacts remain, and in a further step to eliminate them all wall nodules must be able to be morphologieally eroded using the structuring element in figure 5.10 without being eliminated. This process attempts to get rid o f any remaining thin artifacts along the lung wall and will not consider them as wall nodules. Lastly, at this stage of the process the system attempts to identify vessels and vessel groupings. As mentioned earlier, vessels can only be identified in the vessel thresholding range. Objects in this density range must be larger than a 5 mm diameter circle, have a compactness o f over 0.4, an axis ratio o f over 2.5 and a perim eter value o f under 0.05. Vessels are generally very compact so using a minimum compactness value of 0.4 is lenient and allows for V-shaped, branching or curved vessels which are less compact than straight, horizontally oriented vessels. A minimum axis ratio o f 2.5 ensures the vessels are elongated, which is consistent with horizontal vessels. A perim eter maximum o f 0.05 ensures vessels are not significantly connected to the lung walls, which prevents irregularly shaped wall nodules from being considered vessels. To address the issue of large groupings o f vessels, any objeets in the vessel density range which exceed the size of a 20 mm diameter circle and have a perim eter value below 0.2 are considered to be large groupings o f vessels. Also the perim eter value needs to be greater than 0 ensuring contact with the lung wall. The size threshold ensures only large groupings that are unlikely to be nodules are eonsidered. The perim eter value is consistent with the idea that vessel grouping branches will skew the perim eter towards a lower value since the branches would dominate the perimeter rather than the connection to the lung wall. Also, a maximum compactness value of 0.55 is used as vessel groupings are expected to have branches that will tend to lower the compactness measurement. To prevent nodules from getting too big an upper area limit is placed upon them. No interior nodule can be larger than a 15 mm circle. From our data sets only nodules connected to the lung wall ever approached or surpassed this size limit. This prevents large sections or entire slices of the lungs from being considered lung nodules at lower thresholds. A summary of these constraints is presented in table 5.3.

71

S' s^m
variable (min) Interior N odule 15 mm (max) W eakly C onnected variable W all N odule Strongly C onnected 5 mm W all N odule V essel 5 mm 2.5 0.4 (min) (m in) V essel G rouping 0.05 (m ax) 0.65 (m ax) 0.5 (min) (m ax) 0.25 (m ax) > 0 .2 5

0.6 (min)
2.5

0.05 (m ax)

>0

20 mm

>0
0.55 (m ax)

0.2 (m ax)

T able 5.3: A sum m ary o f RO I groupings and there corresponding feature thresholds

T he n ext stage o f the process looks at all interior nodule candidates that are only one C T slice deep. A ny nodule that exists on one CT slice needs good contrast w ith adjacent slices, otherw ise it is m ost likely connected to a vessel, m eaning it itse lf is m ost likely a vertical vessel.

72

Figure 5.16: Three rows o f grey level corresponding to nodule vertical contrast analysis. The middle row is grey level values left to right ranging from 1000 to 100 in increments of 100. The range o f gray values is between 1200 and 0, corresponding to white and black respectively. The top row is 85% o f the middle grey level value. The bottom row is the middle row value minus 100.

For contrast analysis the mean value of adjacent pixels above and below the nodule candidate are compared to the mean value o f the nodule's pixels. The contrast value for the adjacent pixel's mean is calculated using the mean of the nodule candidate.

Vertical Contrast =

- min(7V

x0.15, 100)

(5.9)

In (5.9) Nmean refcrs to the mean pixel value of the nodule. The contrast criterion from (5.9) is visualized in figure 5.15. Given a nodule o f the average intensity represented by the middle row o f figure 5.15 the vertical contrast needs to be at least that o f the brighter o f the two squares directly above and below the value. It can be seen that this contrast requirement is lenient. The reason for this is to not be overly aggressive in eliminating nodules during this stage. The certitude o f the reasoning behind the contrast analysis is that one slice nodules need to be more intense than their vertically adjacent pixels. There is no particular specification of how much contrast is required so a moderate contrast value in (5.9) is used to ensure this elimination rule is not overly aggressive. The next stage o f FP reduction is designed to produce 3-D compact representations of all nodule candidates. The premise behind compaction o f the nodule can be seen in figure 5.17.

73

Figure 5.17: The conceptual idea behind com pacting nodule candidates. From left to right the original nodule, nodule w ith w eak connections such as small vessels elim inated, nodule w ith only significant cross-sectional com ponents retained

F irst there is a desire to elim inate all w eakly 3D connected objects such as small adjacent vessels or sm all vessels that are feeding blood into the nodule. This is done by elim inating all 2D nodule candidates that are 3D connected to any other nodule candidates w ho are at least 4 tim es larger then them selves. A gain, this criterion is relatively lenient and strives to ensure that the 2D object being elim inated is relatively insignificant in its 3D context. This first step is the transition betw een the first and second im age in figure 5.17. T he transition from the concept o f the m iddle im age to the last im age is now perform ed. This tries to retain the m ost significant 3D portions o f the nodule candidate. This is done by retaining only those 2D com ponents which are w ithin 50% o f the area o f the largest 2D com ponent for a particular 3D nodule candidate. This processing is attem pts to counteract the partial volum e effect due to thick slice CT scanning. This stage serves as pre-processing for the rest o f the FP reduction process which deals w ith the nodule in a 3D context. It does this by attem pting to retain the m ost significant portions o f each nodule. In addition by elim inating weak connections, it also serves to potentially separate unique 3D objects that were previously connected. A t this stage the vessels identified near the beginning o f the FP reduction stage are finally utilized. They are used to process interior nodule candidates. The prem ise behind this next stage is that if a nodule candidate is engulfed by vessels then it is m ost

74

likely a vertical vessel. Often a vertical vessel that appears to be a nodule will be covered by a horizontal vessel in an adjacent slice. Also, vertical vessels tend to be represented by a higher grey value when the vessel they branch off o f in the same CT slice, so it may be identified as a nodule, but in context it is actually branching vertically from a vessel. It is viewed as a nodule by the system at a higher threshold where the horizontal vessel would not pass. Some contexts for vertical vessels are illustrated through figure 5.18.

Figure 5.18: A CT slice that identifies an isolated vertical vessel on the right and multiple vertical vessels that are branching from horizontal vessels on the left.

This next step looks at any 2D object that overlaps by more than 50% o f its pixels with vessel objects in the current and adjacent slices. In figure 5.19 it can be seen how vessels from adjacent slice can cover portions o f a potential nodule candidate to identify it as a vertical vessel.

75

Figure 5.19: T he conceptual idea o f a potential nodule represented by the circle actually being a vertically vein bridge betw een two horizontal vessels on adjacent slice. The im age show s how projecting vessels onto the current slice covers the m ajority o f the area o f the potential nodule.

The threshold for what is considered covered is the m ajority o f the nodule c an d id ate's area, m eaning 50% or more. A ny 2D object at this point is a significant portion o f a 3D object due to the previous stage's eom paction and so if the 2D object is elim inated any other slices that are part o f that object in a 3D context are also elim inated. This is possible due to the careful and strict 3D trim m ing that took place in the previous step. W all nodules are not elim inated in this process because vessels do not often extend out to the lung w all in any significant manner. V essels are m ainly identified near the centre o f the lungs and near the trachea entrance at the lung w all. Therefore, it is highly unlikely that a w all nodule candidate could be covered by vessels. This doubt is w hat prevents the system from applying this FP elim ination process on wall nodules. The last FP reduction step involves analyzing the depth o f any nodule rem aining that spans m ore than one CT slice. This is basically a final attem pt to elim inate any vertical vessels that m ight have slipped through the system to this point. This step uses the 3D equivalent o f the axis ratio, it is called the vertical ratio.

vertical ratio

(slices - 1) X slice thickness ------ -- ------- ;-- -- -----^ 7-- m ax(X lengths, Y lengths)

P -o j

76

The vertical ratio is designed specifically for thick slice CT processing on interior nodules. To account for any potential partial volume artifacts the 3D depth o f the object less one slice is used. This is a precautionary measure which keeps in line with the theme of being cautious rather than too aggressive in the FP reduction process. The vertical ratio is basically the depth of the nodule candidate less one slice divided by the longest length o f all the tight bounding boxes for each 2D cross section, keeping in mind that this analysis focuses on nodule candidates that are more than one slice thick. One slice objects will have a vertical ratio o f zero. Any object which has a vertical ratio greater than 3.0 is eliminated from consideration. This is more permissible than the axis ratio which has a cut-off of 2.0. This is again a testament to how careful this system is using 3D features in such a thick slice environment. Wall nodules are not considered for this step because they can have significantly more irregular shapes than interior nodules, in particular when they are large. This is based on observations o f CT data sets along with radiologist's diagnosis o f nodules in these same data sets. After this last step wall nodules and interior nodules that have made it to this point are combined into one set and these represent the final nodule set that is output by the system. A summary o f the FP reduction process can be seen in figure 5.20.

77

Shape and Size Analysis Interior Nodules Vessels
W all N o d u le s

Contrast Analysis 3D trimming

Vessel Reduction Combine Wall and Interior Nodules

F igure 5.20: A sum m ary o f the FP reduction process

78

Chapter 6 Experimental Results
This chapter presents all the experimental results that deal with the final output o f the system. It also presents various comparisons and results for testing done on different portions of the lung nodule detection system. For experimentation one CT data set that contained 10 synthetic nodules along with 19 CT data sets that contained a total o f 239 real nodules were used for testing system performance. Images were acquired using a GE LightSpeed Ultra CT scanner, with a slice thickness o f 5 mm in all cases with an effective pixel resolution of 12 bits.

6.1 Lung Segmentation

The lung segmentation process was detailed in chapter 4. The main irmovation presented in this technique was that 3D region growing increased the size o f true lung volume extracted compared to a standard volumetric based approach [18]. Parts o f the lung volume that would have been eliminated due to the volume threshold or separated due to vascular tissue within the lungs are retained.

79

m study ID 2099069 2124347 2173232 2045724 2161056 1673108 2110370 2174158 2118038 2063289

Pixels Volumetric - ^ 451599 454350 1021103 1139669 616996 1431887 567832 724028 1835559 810363

Pixels Region Growing 577303 537819 1132014 1243561 714572 1582161 636755 838172 2041767 913602

% pixel difference 27.84% 18.37% 10.86% 9.12% 15.81% 10.49% 12.14% 15.77% 11.23% 12.74%

# slices volumetric 21 25 41 43 29 47 30 27 43 41

# slices T regiohi qrowlHHü 32 40 55 53 39 55 33 32 52 48

# slice 11 15 14 10 10 8 3 5 9 7

T able 6.1: Statistics com paring volum etric and region grow ing based lung segm entation

A com parison o f the volum etric lung segm entation technique and the region grow ing technique is presented in table 6.1. A simple and effective w ay o f looking at the perform ance difference betw een the two is how many more pixels one includes in the lung volum e than the other. It can be seen, from table 6 . 1, that the region grow ing approach includes m ore o f the lung volum e, usually betw een 10-15%, than the volum e based approach. The num ber o f slides containing a portion o f the lung volum e is also higher in each case. T hese results are consistent, since the region grow ing approach is designed to include sm aller lung volum es on a slice. These results support the idea that region grow ing is a superior approach to volum etric analysis w hen it comes to lung volume segm entation. The inherent benefit is m uch m ore com plete lung segm entation at the top and bottom o f the lung volum e. There is an additional benefit that any portions o f the lung that are cu t-o ff in a CT slice w ill be retained as long as that volum e is 3D connected to the lung volum e in an adjacent slice.

80

Figure 6.1 : An example of part of the lung volume near the top of the scan that was retained with the region growing approach but not retained with volumetric based lung segmentation

Figure 6.2: An example of part o f the lung volume near the bottom o f the scan that was retained with the region growing approach but not retained with volumetric based lung segmentation

81

%

Figure 6.3: T he tip o f the left lung is an example o f a portion o f the lung volum e that is c u t-o ff from the rest o f the lung but is retained in the lung volum e due to the region grow ing approach

6.2 ROI Extraction Results

This lung nodule detection system involves a novel approach at M LT that uses the lung v o lu m e 's density profile to establish the thresholds in an adaptive m anner. The technique ensures the thresholds are generated based on the CDF o f the particular lung volum e. There is a new approach, a LDM technique proposed by [23] w hich focuses on local density m axim um s. It also uses a form o f M LT; how ever, objects are distinguished based on their density profile and connections to other objects. The potential o f the approach is that it can separate overlapping structures as long as they w ere represented by distinct density profiles. A good way o f visualizing this is with two m ountains, one low er than the other. T he peak o f the low er m ountain will distinguish it from the larger m ountain. This has good potential in separating nodules from vessels w hen they overlap in the CT slice. F or a M L T approach this is a challenge and often the attached objects w ill not be separated, particularly when the nodule is o f a low er intensity than the object

82

to which it is attached. Given these facts the MLT that was incorporated in this system was compared to the proposed LDM algorithm. The first major difference between the techniques was that the LDM approach took approximately eight times longer to run than the adaptive MLT approach used in this system. The running time for the LDM fell in the area o f 4 hours where the MLT approach ran in approximately 30 minutes on the same data set. This is a significant difference but it is still acceptable if the results of the LDM are significantly better than the MLT approach used by the system. The next major failing with the LDM system was that the size threshold was so low that objects would be identified small and fail to properly fill out. On the other hand the MLT technique performs an excellent job o f filling out nodule candidates, in particular larger ones. Basically, the MLT approach consistently failed to produce accurate or even acceptable representations of nodules in the CT data that it was tested on, as can be seen in figure 6.4.

83

«

I

F igure 6.4; A CT slice with ROIs (black spots w ithin high intensity structures) obtained by the L D M algorithm in the top im age and the adaptive M LT approach in the bottom image.

The adaptive M L T produces R O Is that are better representations o f nodule candidates than the LD M technique. For larger objects it can be seen that the LDM algorithm often does not fill them out, in particular a very large nodule near the top o f the

84

right lung (left side o f image) in figure 6.4. The idea behind the LDM approach is promising but at this stage o f development a technique that was proven and effective was needed for the ROI portion o f the system so the LDM algorithm was not used. Also, by using MLT it made it possible to identify vessels, this would have been extremely difficult, if at all possible, using the LDM algorithm. Most likely, an entirely separate system would have been created alongside the LDM algorithm to detect vessels since the LDM algorithm uses the definition of a nodule in how it segments the image from one threshold to another. The adaptive MLT is simpler in that each threshold is independent o f other thresholds; this allows for more flexible processing afterwards. Based on these observations from testing the two systems the adaptive MLT approach was incorporated. It produces more complete ROI representations within the lung volume and allows for very flexible analysis o f ROIs which led to the development o f vessel identification and application in FP reduction.

6.3 Lung Nodule Detection Results

The most significant portion o f the results section is actual data on how well the system deteets nodules. Initially the system was tested using simulated nodules produced by the system described in chapter 3. The simulated nodules were applied onto a single CT series that contained no other nodules.

# of simulated nodules detected 67 10

# o f3 1 ) objects detected 108

Sensiii\it\

10

100%4

98

0 $ h!
1.46

Table 6.2: The results o f applying the lung nodule detection system onto a set o f simulated nodules

Testing with simulated nodules the system performed very well. The sensitivity shows that 100% o f the nodules were detected. The number o f FPs was also very good at

85

1.46 p e r slice. The results for the sim ulated nodules are encouraging, how ever, these results are som ew hat expected since the nodules w ere well form ed and regular. For exam ple, all o f the nodules w ere large enough to satisfy the m inim um area criteria o f the system . A dditionally, the nodules are very well fonned since they are synthetic, and therefore are easier to segm ent. T he data com piled in tables 6.3 through 6.6 consists o f sensitivity and FP analysis w hen the system w as applied to 19 real CT data scans. The tables represent the results o f the system at four different phases in the developm ent process. The data sets are actually divided into tw o m ajor sets, those beginning with the letters "ID " and those beginning w ith the letters "F B " . The suffix letter o f each set represents the testing phase; " C" represents the first phase and "F " represents the fourth and final phase by using alphabetical order. T he "ID " set was the first set that was obtained and used for m ost o f the developm ent until the phase 1 results. The results on the "FB " test set in table 6.3 w ere basically a b lind test at that point having developed the system using the " ID " set only. In addition to blind testing, the "FB " set w as used as an indicator at that point to see if the system could help im prove the sensitivity o f a radiologist's diagnosis. T he experim ents and results are obtained as follows. The truth sets w ere obtained by getting an expert radiologist to exam ine and m ark all o f the data sets in each location that he detected a nodule. The "ID " and "FB " test sets w ere done separately but as entire sets in one session each. W hen the "FB " set was introduced the system w as at the perform ance level displayed in table 6.3. The radiologist identified 4 additional nodules that w ere n o t initially detected. This means originally the set had 56 identified nodules as opposed to the 60 currently listed. This m eans the system helped to identify 7% m ore nodules. T hree w ere identified in FB3 and one was found in FB9. The m ost im portant thing to note from this result is that the system only perform ed at 50% sensitivity fo r the data set at the tim e o f this test as seen in table 6.3 for the "F B " data set. This result im plies th at even at low sensitivity values the com puter aided diagnosis can help im prove diagnosis accuracy.

8 6

oo

Series FB1C FB2C FB3C FB4C FB5C FB6C FB7C FB8C FB9C FB1GC ID101C ID51C ID52C ID53C ID54C ID55C ID56C ID57C ID58C S e t FB S e t ID T o tal

# of # nodules detected 1 0 0 0 34 20 1 1 1 0 13 4 0 0 1 1 8 4 1 0 58 50 0 0 103 68 13 10 1 ^ 0 0 0 0 0 3 2 1 0 60 30 179 130 239 160

# Missed 1 0 14 0 1 9 0 0 4 1 3 0 35 3 1 0 0 1 1 30 49 79

S en sitiv ity 0.00% NA 58.82% 100.00% 0.00% 30.77% NA 100.00% 50.00% 0.00% 86.21 % NA 66.02% 76.92% 0.00% NA N/A 66.67% 0.00% 50.00% 72.63% 66.95%

Total Slices 40 67 57 50 61 40 37 53 59 35 65 32 38 61 46 51 56 55 44 499 448 947

Objects Detected 62 95 124 70 112 116 112 109 138 80 352 98 213 181 138 81 90 118 147 1018 1418 2436

FPs / slic e 1.55 1.42 1.82 1.38 1.84 2.80 3.03 2.04 2.27 2.29 4.65 3.06 3.82 2.80 3.00 1.59 1.61 2.11 3.34 1.98 2.88 2.40

Initial Interior 0 0 18 1 0 2 0 1 0 0 33 0 15 2 0 0 0 0 0 22 50 72

Contrast 0 0 16 1 0 2 0 1 0 0 33 0 15 2 0 0 0 0 0 20 50 70

Jrimmirici 0 0 16 1 0 2 0 1 0 0 33 0 15 1 0 0 0 0 0 20 49 69

V essel reduced 0 0 16 1 0 2 0 1 0 0 32 0 11 1 0 0 0 0 0 20 44 64

Depth / Final 0 0 16 1 0 2 0 1 0 0 32 0 11 1 0 0 0 0 0 20 44 64

Wall , only 0 0 4 0 0 2 0 0 4 0 18 0 57 9 0 0 0 2 0 10 86 96

Table 6.3: Results o f using the nodule detection system with the MLT thresholds set at the 90% CDF value for the top o f the vessel range, 80% for the bottom o f the vessel range and 65% for the bottom o f the nodule range

Series

#of nodules

# detected

# Missed

S en sitivity 0.00% NA 58.82% 100.00% 0.00%

Total' "Objects Slices Detected

FP s D Initialslic e Interior Contrast 1.78 1.42 1.82 1.38 1.84 2.93 2.95 2.04 2.31 2.29 5.62 3.34 4.82 2.85 3.00

Trimminfl

V essel reduced

Depth /F inal

Wallf only#

00 00

FB1D FB2D FB3D FB4D FB5D FB6D FB7D FB8D FB9D FB10D ID101D 1D51D ID52D 1D53D ID54D 1D55D ID56D ID57D ID58D
S e t FB S e t ID Total

1 0 34
1

1 13 0 1 8 1 58 0 103 13 1 0 0 3 1
60 179 239

0 0 20 1 0 5 0 1 4 0 50 0 76 10 0 0 0 2 0
31 138 169

1 0 14 0 1 8 0 0 4 1 8 0 27 3 1 0 0 1 1
29 41 70

38.46%
N/A 100.00% 50.00% 0.00% 86.21% NA 73.79% 76.92% 0.00% NA NA 66.67% 0.00% 51.67% 77.09% 70.71%

40 67 57 50 61 40 37 53 59 35 65 32 38 61 46 51 56 55 44
499 448 947

71 95 124 70 112 122 109 109 140 80 415 107 259 184 138 83 90 120 164
1032 1560 2592

1.63 1.61
2.15 3.73 2.01 3.17 2.56

0 0 18 1 0 3 0 1 0 0 33 0 18 2 0 0 0 0 0
23 53 76

0 0 16 1 0 3 0 1 0 0 33 0 16 2 0 0 0 0 0
21 51 72

0 0 16 1 0 3 0 1 0 0 33 0 16 1 0 0 0 0 0
21 50 71

0 0 16 1
0

0
0

0
0

16 1
0

4
0 0 2

3 0 1 0 0 32 0 15 1 0 0 0 0 0
21 48 69

3
0

1 0 0 30
0

0 0 4
0

15 1 0
0

20 0 61 9
0

0
0 0 21 46 67

0 0 2
0 10 92 102

Table 6.4: Results of using the nodule detection system with the MLT thresholds set at the 90% CDF value for the top o f the vessel range, 80% for the bottom o f the vessel range and 65% for the bottom o f the nodule range. In addition if the bottom o f the nodule range is higher than 300 then 300 is used as the bottom o f the nodule range at steps o f 20 between thresholds from the 65% threshold.

oo

FB1E FB2E FB3E FB4E FB5E FB6E FB7E FB8E FB9E FB10E ID101E ID51E ID52E ID53E ID54E ID55E ID56E ID57E ID58E

-# o f ; # n o d u le s ' detected 1 0 0 0 34 24 1 1 1 0 7 . 13 0 0 1 1 6 8 1 0 58 52 0 0 103 78 13 10 1 0 0 0 0 0 2 3 1 0

# M issed 1 0 10 0 1 6 0 0 2 1 6 0 25 3 1 0 0 1 1

Sensitivity
0.00% NA 70.59% 100.00% 0.00% 53.85% N/A 100.00% 75.00% 0.00% 89.66% NA 75.73%

76.92% 0.00%
N/A N/A 66.67%

0.00%
65.00%

Set FB Set ID Total

60 179 239

39
142

181

21 37 58

Total Slices 40 67 57 50 61 40 37 53 59 35 65 32 38 61 46 51 56 55 44 499

Objects Detected 89 98 133 91 126 127 122 133 139 106 421 113 263 197 150 97 116 120 180 1164

F P s/ slice
2.23 1.46 1.91 1.80 2.07 3.00 3.30 2.49 2.25 3.03 5.68 3.53 4.87 3.07 3.26 1.90 2.07 2.15 4.09 2.25

Initial Interior 0 0 14 1 0 3 0 1 1 0 38 0 21 2 0 0 0 0 0

C ontrast 0 0 14 1 0 3 0 1 1 0 37 0 19 2 0 0 0 0 0

Trimming 0 0 14 1 0 3 0 1 1 0 37 0 19 1 0 0 0 0 0

V e s s e lf reduced* 0 0 14 1 0 3 0 1 1 0 35 0 18 1 0 0 0 0 0

0 0 14 1 0 3 0 1 1 0 34 0 18 1 0 0 0 0 0

0 0 10 0 0 4 0 0 5 0 18 0 60 9 0 0 0 2 0

79.33% 75.73%

448
947

1657 2821

3.38 2.79

20 61 81

20 58 78

20 57 77

20 54 74

20 53 73

19 89 108

Table 6.5; The same system configuration as in table 6.4 except that now the top o f the vessel range is now the 97.5% CDF value and the bottom o f the vessel range is the 92.5% CDF value.

Series FB1F FB2F FB3F FB4F FB5F FB6F FB7F FB8F FB9F FB10F ID101F 1D51F ID52F 1D53F ID54F ID55F ID56F ID57F ID58F

. # of nodules

# detected 0 0 25 1 0 9 0 1 6 0 52 0 85 10 0 0 0 2 0

# M issed 1 0 9 0 1 4 0 0 2 1 6 0 18 3 1 0 0 1 1

1 0 34 1 1 13 0 1 8 1 58 0 103 13 1 0 0 3 1

Sensitivity 0.00% N/A
73.53%

Total S lices 40 67 57 50 61 40 37 53 59 35 65 32 38 61 46 51 56 55 44

Objects Detected 89 98 138 91 126 142 152 165 139 132 421 130 334 205 173 94 116 122 215

F P s/ slice
2.23

Initial Interior 0 0 19 0 0 5 0 1 1 0 38 0 45 4 0 0 0 0 0

Contrast 0 0 19 0 0 5 0 1 1 0 37 0 42 4 0 0 0 0 0

Trimminçi 0 0 18 0 0 5 0 1 1 0 37 0 42 3 0 0 0 0 0

V e sse l reduced 0 0 18 0 0 5 0 1 1 0 35 0 40 2 0 0 0 0 0

Depth / Final 0 0 18 0 0 5 0 1 1 0 34 0 40 2 0 0 0 0 0

-wair
o n l#
0 0 7 0 0 4 0 0 5 0 18 0 45 8 0 0 0 2 0

100.00% 0.00%
69.23%

1.46 1.98 1.80
2.07 3.33

N/A 100.00%
75.00%

4.11
3.09 2.25 3.77

0.00% 89.66% N/A
82.52%

5.68
4.06

6.55
3.20 3.76

vû
O

Set FB S et ID Total

60 179 239

42 149 191

18 30 48

76.92% 0.00% N/A N/A 66.67% 0.00% 70.00% 83.24%
79.92%

1.84
2.07 2.18

499 448 947

1272 1810 3082

4.89 2.46
3.71 3.05

26 87 113

26 83 109

25 82 107

25 77 102

25 76 101

16 73 89

Table 6.6: The same system configuration as in table 6.5 except now the minimum nodule size is dependant on the cross sectional resolution o f the CT slices to allow for smaller nodules being detected on slices that have a higher resolution.

The layout of the information in tables 6.3 through 6.6 is identical. The first column identifies the particular CT data set. At the bottom each separate set is identified as well as a row representing all the sets together. Columns two through four provide nodule information about the CT set and the performance o f the nodule detection system. The fifth column is highlighted, and identifies the sensitivity performance for the data sets identified in the first column. The sixth column relates how many CT slices are contained in the data identified in the first column. The seventh column shows how many objects were detected by the nodule detection system. The eighth column reports the FPs per slice for the particular data set. This number equals the number o f objects detected less nodules detected, all divided by the number of slices in column six. The last six columns identify how many true nodules are identified as nodule candidates at different stages o f the FP reduction system described in chapter 5. The "Initial Interior" candidates relate to nodules that satisfy the minimum area, compactness and major to minor axis ratio criteria directly after ROl identification. This refers to nodules that basically pass the first stage o f FP reduction. The last column, "Wall only", refers to nodules that were detected because they were identified as wall nodules and were not picked up as interior nodules. The other five columns refer to progressive stages of processing interior nodules in the FP reduction process. The "Contrast" lists how many nodules still remained after vertical contrast analysis for single slice nodules in addition to further area analysis. The "trimming" column shows how many nodules survived the 3D trimming stage o f the FP reduction process. The "Vessel Reduced" column refers to nodules that survive the FP reduction stage that uses vessel objects to check for connectivity and eliminate likely vertical vessels that are still considered nodule candidates. The "Depth / Final" column declares which nodules passed the 3D depth analysis, the final stage in nodule FP reduction. The detected nodules are the sum o f the "Wall Only" and the "Depth / Final" columns. The first phase of testing is presented in table 6.3. The performance o f the system can best be summarized by the sensitivity and FP performance. The sensitivity over all data was shown to be 67%. The "ID" set performed at 73% sensitivity with 2.88 FPs per slice. If IDlOl was eliminated from consideration, which dominates the statistical results since it contains 103 nodules, the sensitivity was 82% (62/76) with 2.79 FPs per slice.

91

This perform ance w as prom ising on the ID set especially w hen looking at the set w ithout ID 101. T he m ain reason for optim ism w as through an analysis o f previous techniques and their results. Sensitivity and FP perform ance for various nodule detection techniques can be seen in table 6.7.

D etection System

Sen& ühntyrange (m ax[FPs p er slice], m in[FPs per

A rm ato et al. Gurcan et al. F iebich et al. Zhao et al. L ee et al. K anazaw a et al. P a ik et al. B row n et al. O ur system

(72% [4.6], 71% [1.5]) (84% [1.74]) (95.7% [0.3], 30% [6.3]) (84.2% [5 p er set], fail [fail]) (72% [1.1]) (90% [0.3]) (90% [5.6 per set]) (78% [15 per set]) (80% [3.05])

T able 6.7: S ensitivity and FP perform ance from different nodule detection system s [8], [9], [17], [19], [23], [24], [29], [50], [51] including best and w orst reported perform ance if available

T he range o f reported sensitivities for different system s varies significantly. The w ork done by [19] show s an im provem ent o f their system in term s o f FP perform ance not due to u sin g a different data set but because they m odified their system. The system does perform consistently at around 70% sensitivity. FP perform ance tends to be very good for system s th at have been evaluated using one testing data set. Q uite different results are produced w h en som e system s are tested on different data sets. For exam ple [29] reported excellent results in sensitivity and FP perform ance. W hen their system was applied to a second data set it perform ed at unacceptable levels o f 30% sensitivity and 6.3 FPs p er slice [17] as seen in table 6.7. A sim ilar experience was encountered w hen applying the technique designed b y [23] to the "ID " data set used for testing our lung nodule detection

92

system. The system actually failed to produce meaningful results as it could not segment nodules properly using the LDM technique mentioned earlier in this chapter. The FP reduction stage also performed so poorly that no meaningful data was presented. The number o f nodule candidates for any CT set exceeded 1000 nodules, o f which the vast majority were not formed properly due to the failure of the LDM algorithm on the target data set. Even looking at the results by [50] that showed excellent performance their system only found nodules that were equal to or larger than a 6 mm sphere. Given this consideration, the system would perform poorly on many other data sets, including our own, which include many nodules smaller than this criterion. This shows that systems that show very promising results need to be evaluated carefully, and that high sensitivity and low FPs are no guarantee that the system can maintain that performance on different data sets. The system created by [8] reports much more conservative sensitivity and FP numbers, but subsequent testing [19] showed this level of performance was maintained in terms o f sensitivity and improved in the realm of FPs. Also, the data set from [19] was perhaps the most similar to the one analyzed by this system as it consisted o f 17 data sets and 187 nodules, where our data set has 19 cases and 239 nodules. This data association makes their performance results a good minimum benchmark for this system. Given all o f these results and the preliminary state o f this system the performance on the "ID " data set was encouraging both in terms of sensitivity and FP performance. Subsequent testing on the "FB" data set produced significantly worse results than the "ID" data set with a sensitivity o f only 50% but an improvement in FP performance at 1.98 per slice. In addition, an examination o f the FP reduction stage to stage results is helpful to see how the FP system performed. In total, 8 nodule candidates were eliminated during the FP reduction stage leading to a decrease from a potential sensitivity o f 70% (168/239) to an actual sensitivity of 67% (160/239). This is not a significant decrease in sensitivity and the FP reduction process at the initial stage can contain approximately 40 FPs per slice, which is an unmanageable number for diagnosis. Given this, the FP reduction process is necessary and key to producing an effective system for clinical use. The vessel reduction stage was responsible for eliminating most o f the nodules during the FP process. This occurred in some cases when nodules overlapped significantly with large veins. Another problem is that the system does pickup the

93

diaphragm n e ar the bottom o f the CT data set, as occurred in case 1D52 and this elim inated nodules that w ere overlapped by the diaphragm . To treat this problem the system attem pts to not include the diaphragm near the bottom by ensuring the vessel clusters have ^ p e rim e ter value below 0.2 as indicated in table 5.3. This exploits the fact that the diaphragm tends to have a large perim eter value w hen it is in contact w ith the lung w all. H ow ever, this does not work w hen the segm ented diaphragm is thresholded w hen it does not have contact w ith the lung wall. To alleviate this problem phase 4 o f the system , in table 6.6, incorporates a greater than 0 perim eter feature to attem pt to reduce this effect. R egardless, the diaphragm problem in the vessel reduction stage is not going to significantly im prove sensitivity so another m odification was m ade for phase 2 o f the system . G iven th a t the sensitivity w as w eak at the beginning o f the FP reduction system , the R O I extraction system w as targeted. O ne observation w as that for ID 52 there w ere m any nodules that w ere visibly dense, but fell below the 65% CDF value o f the lung volum e becau se the CT scan as a whole had a very high density profile. A check was put into the system to ensure faint nodules w ere not m issed due to the 65% CD F cutoff. I f the 65% C D F value w as higher than 300, then the threshold levels w ere augm ented in decreasing increm ents o f 20 from the 65% CDF value to 300. The value o f 300 was chosen from observing figure 5.15 and concluding that the intensity value o f 300 w as a reasonable value for w hat objectively could be considered to have good contrast w ith a black background. Steps o f intensity 20 ensure good coverage at that level and are adequately sm all to allow for proper detection o f faint objects. This is based on the observation o f step size and perform ance in the original approach w ithin the nodule range o f thresholds. T he results o f im plem enting this system change in the ROl procedure can be seen in table 6.4. T he overall sensitivity o f the system im proved to 71 % ( 169/239). There w ere less vessel elim inated nodules at this point for one m ain reason. There was m ore o f a skew to detecting w all nodules than before, and since wall nodules are not part o f the vessel elim ination procedure the num ber o f vessel elim inated nodules dropped from 5 to 2. A lso the potential sensitivity perform ance based on the first phase o f the FP reduction process is n ow at 74% (178/239). This is com parable to the difference observed in phase

94

1 testing in table 6.3 between potential and actual sensitivity. One major observation is that all but one of the new nodules was found in 1D52 so even though sensitivity did increase, performance improved mainly due to one CT data set. This is not to say this was an ineffective or useless modification. There was one other CT study, FB6, which also improved by detecting one additional nodule. Regardless o f results the modification was one that made sense when the reason for it was examined, in particular when considering that it is important to account for CT studies that have irregular density profiles. Phase 3 was developed with more of a focus towards the "FB" data set. On o f the major problems with ROl candidates was that some high intensity nodules were not being picked up. Due to this the nodule and vessel ranges were reconsidered and new threshold CDF values were used for the top and bottom o f the vessel range. The 92.5% and 97.5% CDF values were used rather than the 80% and 90% values in the previous two results. Likewise, only 4 threshold levels were previously used in the vessel range, producing steps between thresholds of over 50 in some cases. To alleviate this problem the vessel range was chosen to be more compact and the number of threshold levels increased to 10. The higher thresholds also ensure a higher standard for the density and connectivity o f objects that are considered vessels. The previous range was too lenient in terms of the density allowance and some diffusion between objects satisfied the vessel density criterion. With the higher thresholds there is less o f a chance that these diffusions can be included as vessels. Also, the higher vessel range and increased inter-level resolution ensures that the third phase of development would do a better job o f identifying nodules which are visually distinct but exist in a high intensity background or are surrounded by high intensity objects. The performance of the system at the third phase of development can be seen in table 6.5. The sensitivity results had a decided increase in performance again, now perfonuing at 76% in total. This is a 5% increase over the previous phase, which itself had a 4% increase over the previous phase. Therefore the total sensitivity improvement is consistent with the previous modification on a global sense; however there is a distinct difference. The second phase improved sensitivity by basically improving performance in case ID52 while only improving the "FB" sensitivity from 50% to 52%. The sensitivity for the third phase in the "FB" data set was at 65%, an improvement o f 15% and 13%

95

over the previous results. This is im portant because the "ID " set already had relatively good sensitivity, even after the first phase o f testing but the "F B " set perform ed very poorly. A lso, the m eaning the ID ID set contains 179 nodules w here the "FB " set only contains 60,

test set dom inates global sensitivity perform ance. O f the 12 new

nodules detected, 8 o f them w ere from the "FB" set. The significant im provem ents m ade in the FB set in term s o f detection sensitivity are a very encouraging observation that strongly supports the new M LT approach tow ards the vessel range im plem ented in the third phase o f the system . L ooking further into the results presented in table 6.5, the potential sensitivity at the begin n in g o f the FP reduction stage is 79 % (190/239) com pared to the actual sensitivity o f 76% (181/239). N o one particular FP reduction step is responsible for elim inating an exceptional num ber o f nodules so the FP process seem s relatively balanced, and has only a small affect on sensitivity. G iven the good sensitivity perform ance produced by the system after m aking m odifications prim arily to the M LT process, the FP reduction stage w as now m odified for the fourth and last phase o f the system , the results o f which are shown in table 6.6. O ne observation, w hen looking at the results was that some nodules that w ere well form ed did not get detected and it was concluded that the M LT process w as not responsible, especially given the m odifications made to this point to the thresholding approach. T he system w as calibrated to accept nodules that w ere greater than a 4 m m disc in size w ith in the interior and a 3 mm disc along the lung wall. It was found that the reason for this w as that the nodules that w ere not being detected w ere falling below the m inim um size criteria, w hen other nodules in other CT scans that w ere sm aller than them visually w ere being detected. Any past literature on the topic o f nodule detection alw ays dealt w ith a low er bound on nodule size in term s o f an absolute area as our system has been u sin g to this point. The truth o f the m atter is that when a hum an observes the nodules in a C T scan they are not concerned about the geom etric area; they actually focus on the p ix el area o f the object. W hat happened w ith the nodule that w as not being detected w as th at the X, Y resolution o f the CT scan was very high, m aking sm aller nodules ap p ear visually larger since the pixel area was significantly sm aller. A nalysis o f the system found th a t m any CT scans had X, Y resolutions that w ere in the range o f 0.7

96

mm. In the case where the nodule was not being detected the X, Y resolution was actually approximately 0.5 mm. This means that smaller nodules visually large but geometrically small. The minimum area criteria were established using the visual feedback o f a 0.7 mm CT scan, so to adjust the criteria to be sensitive to the size o f the object in terms o f pixel a modification was made to the lower area criteria. It can be seen in table 6.8 that a CT scan with an X,Y resolution of 0.5 mm compared to that o f one with a resolution o f 0.7 mm actually means that objects had to appear twice as big visually to have the same area.

t> ^ ^ T e s o lu t io n 0.7 mm 0.5 mm

Pixel Area 0.49 mm^ 0.25 mm^

3 mm disc pixel area 15 pixels 29 pixels

4 mm pixel disc area 26 pixels 51 pixels

Table 6.8: A comparison of the effect on visual size by the X,Y resolution o f CT scan

Given that the pixel area of a 0.7 mm resolution CT scan was approximately 0.5 mm^, and that provided good visual resolution, the pixel area was artificially enhanced to that value when calculating the 3 and 4 mm disc area for high resolution CT scans with an X,Y resolution smaller than 6.5 mm. This stops short o f making the pixel area absolute, but it does address the need to be sensitive to the visual representation o f the nodule. Given the past systems were sensitive to nodules as small as a 3 mm disc this new criteria lowered the minimum sized nodules that the system could detect. The highest resolution CT data set in the testing data was 1D52 with an X, Y resolution of 0,4805 mm. This means by modifying the pixel area the new effective area minimums o f potential nodules were actually the equivalent areas o f 15 pixel and 26 pixel objects which represent the area of a 3mm and 4mm disc respectively. This means the new minimum area for a wall nodule was 3.46 mm^ which is equivalent to a disc with a diameter o f 2.1 mm and the new area o f for an interior nodule was 6 mm^ which is the same as a disc with a diameter o f 2.8 mm. This means that the system was now setting the minimum size criteria o f what could be considered a nodule based on the X, Y pixel resolution o f the CT scan. This is sensible when considering higher resolution CT scans produce larger and better defined

97

representations o f sm aller nodules. O ur CT scans ranged in resolution betw een 0.7 m m and 0.5 m m approxim ately. This m odification represents the first nodule detection system that reports using variable size criteria based on the CT scan resolution and additionally represents only the third system that reports being able to detect nodules below 3 m m in diam eter [17], [51]. T he results o f the m odification produce a significant im provem ent in the results, displayed in table 6.6. The system sensitivity increased to 80% (191/239), boosted by a fairly balanced increase from both test sets. It is im portant to note that this m odification only im proved the perform ance o f the CT scans w hich had a high X, Y resolution. From table 6.6 they can be seen to be FB3, FB6-8, FBIO, 1D51-55 and 1D58. This m eans for CT scans w here the m odification took effect the old sensitivity o f 72% (120/167) im proved to 78% (130/167). That represents 10 additional nodules and a sensitivity jum p o f 6% , w hich is higher than the total sensitivity jum p o f 3%. This w as a very effective m odification to the system that clearly perform ed well in the cases that w ere targeted. N ow w ith an overall sensitivity o f 80% the system has im proved dram atically from the first phase o f developm ent w hich had a sensitivity o f 67%. W hat is even m ore im pressive is that the potential sensitivity o f the system when looking at the beginning o f the FP reduction process is 85% (202/239), m uch higher than the previous value o f 79% in the third phase o f testing. A n other very prom ising assessm ent o f perform ance com es from looking only at nodules that satisfy the m inim um area criteria o f the system , in this case the total num ber o f nodules drops to 211 from 239. This m eans the sensitivity o f the system to nodules that satisfy the m inim um area criteria is 91% (191/211). These are excellent num bers in term s o f sensitivity and show s excellent potential for detecting nodules. U sing the value o f 91% w hen com paring to any other reported system this provides a very favourable com parison and actually provides a good argum ent that other system s perform at a low er sensitivity than our system does based on the data sets they have used. F o r exam ple, a system such as the one proposed by [9] reports sensitivity o f 90% , w hich from table 6.7 represents the pinnacle o f nodule detection sensitivity perform ance. H ow ever, it only reports detecting nodules w hich are larger than a disc with a diam eter o f 4 m m or greater. Given that only 211 nodules m eet the m odified size

98

criteria in phase 4, and that phase 4 had detected 13 more nodules than phase 3, when only the size criteria was altered, it is safe to assume that those thirteen nodules fell below the previous size criteria. That means, o f the 239 nodules, it is reasonable to conclude that 41 nodules fall below the 4 mm diameter disc size criteria. This automatically means the system proposed by Kanazawa et al. would miss 41 nodules in our test set purely due to its size constraints. They also claim that they detected 95% o f nodules before their FP reduction process which implemented the area cut-off criteria. It can be assumed, in the most extreme case, that all o f their nodules were eliminated due to them being too small. This means that 5% of their data set consisted o f nodules below 4 mm in diameter. Also, assuming the 5% of their data set that was not picked up by their ROl process was above 4 mm in diameter then 95% o f their data consisted o f nodules above 4 mm in diameter. If they detected 90% of all nodules where only 95% were detectable due to the size criteria then their system worked at 94.7% sensitivity above 4 mm. Given that our test set consists o f at most 198 nodules above 4 mm in diameter their system would have detected 188 nodules if it operated at a sensitivity of 94.7%. This means that at its best, their system could have performed at a total sensitivity o f 78.6% (188/239). This is a lower sensitivity than was obtained by our system. It is also important to note that this is a best case assumption for their system. A similar argument can be made for other systems that report higher sensitivity but use a higher minimum area cut-off. Looking at the results of [51], they used thin section CT which makes detecting small nodules easier. Also, their system had an overall detection sensitivity o f 83.5% on a test set of 79 nodules, which is significantly smaller than our test set of 239 nodules. Since our system is operating on thicker slices the detection sensitivity should be lower than on a system with thinner slice CT scans where there is significantly less inter-slice interference. The study by [17] reports a sensitivity o f 84% using a data set o f 63 nodules, again a significantly smaller data set than our own. If the performance o f our system using a subset o f 60 nodules from 8 CT data sets in table 6.6 was analyzed the system performs at a sensitivity o f 90% (54/60) which is higher than the reported results by [17] but with a comparable data set size in terms o f nodules.

99

G iven the results, our system does perform very well in sensitivity and the argum ent can and has been m ade that it has class leading sensitivity based on the results and test set w hen com pared to the test sets and results o f other reported techniques. T he m ajor deficiency in our system is the FP perform ance w hich is at 3.05 FPs p er slice. The FP perform ance does range betw een 1.46 and 6.55 FPs p er slice so the actual range o f FP results on a case by case basis can be com petitive w hen com pared to other techniques listed in table 6.7. Likew ise, due to the diverse nature o f our test set it is d ifficult to com pare the FP perform ance o f other system s given how perform ance is highly dependant on the actual CT data sets as our own data has shown given the intra-set range o f FP results. T he challenges o f the test set aside, the system 's FP perform ance is acceptable at this stage and there is a focus to im prove it w ith further developm ent.

100

Chapter 7 Conclusions
Creating this system was a significant challenge and a great opportunity at the same time. This system has the opportunity to lead the way in automatic lung nodule detection in Canada as no other Canadian based research in this field has been found yet. The greatest challenge of creating a lung nodule detection system was the scope o f the project. The main objective of this work was to create a fully functional system that was practical and effective. One of the largest obstacles to overcome was the sheer volume o f work that needed to be done to create a complete system. Everything was built from scratch and getting started required finding a direction that could be followed. Looking at the state o f the art in lung nodule detection research there are many different approaches but it is difficult to judge the merits of the systems without access to them or their data sets. This makes choosing a path difficult because there are no guarantees that the chosen approach is going to be successful. The first phase o f this research demonstrated this as a system that had excellent potential, based on the presented results, was implemented but performed unacceptably on our CT data. In retrospect, with a more critical eye and more understanding of lung nodules, the results o f the system that was initially examined [23] are not surprising. This was a lesson to look deeper than what is presented from the direct performance data. At this stage of the process a completely functional lung nodule detection system has been developed that meets the initial design goals and was created in a very short period o f time. In addition a lung nodule synthesis tool was created that was used in the testing process and additionally provided insight into nodules that helped to develop the rest o f the system. From this point forward future research work will have this system as

101

a basis and a springboard. Each o f the system s can be exam ined individually and w ith m ore detail. In addition, the techniques that have been im plem ented in this system can be further refined and exam ined. M ost im portantly, new approaches can be carried in the context o f th e system w ith m ore narrow focus and detail since the creation o f all the com ponents does not need to be a concern. T he results o f the nodule detection system are very encouraging and show good progress w as m ade during the developm ent o f the system. The results rose from a 67% total case sensitivity to 80%. A lso the sensitivity o f the "FB " test set rose from 50% up to 70% , w hich w as another very encouraging sign. In addition, it has been show n that the system 's sensitivity perform ance is class leading w hen the context o f the CT data is applied to the reported results o f other techniques. In particular, the num ber o f nodules and the v ariety o f cases m akes our CT data set the m ost robust set that any system has been rep o rted ly tested on. In addition to excellent sensitivity perform ance and a robust data set there are m any innovations present in the system that can be built upon and applied to other system s. First, a unique 3D region grow ing approach is used for lung segm entation that im proves over volum etric approaches by including m ore o f the lung volum e, in particular near the top and bottom o f the lungs. N ext there is a unique M LT approach that selects thresholds based on the CD F values o f the density profile o f the lungs. It is the first ROI acquisition system th at tries to detect vessels in addition to nodules and uses them in FP reduction; this is done by uniquely defining a vessel range am ong the thresholds used in R O l extraction. The system is only the second system that uses thick slice CT scans to find nodules b elow 3 m m in diam eter, the other being the one developed by Gurcan et al. [17]. In addition this is the only system that adaptively determ ines the m inim um area criterion b ased on the X , Y resolution o f the im age, taking advantage o f CT scans with high cross-sectional resolutions to identify small nodules. One o f the m ost significant innovations involves using a tight bounding box to calculate 2D shape features, w here, in past system s the orientation o f the nodule w ould interfere w ith accurate feature extraction. T he system itse lf is o f a m odular design, perm itted through a rule based approach. T his allow s for future developm ent w here rules and stages can be plugged in and out at different points o f the FP reduction process.

102

Given the new ideas presented, and the excellent sensitivity performance on the data sets, development on the system must be continued. Even with excellent preliminary results, comparing systems that were tested using different data sets still prevents an absolute comparison; it only allows analysis and interpretation that forms performance conclusions as has been done. It can definitely be said that this system is better than what others have proposed but it can be inferred that it appears to have the best sensitivity performance among these systems when the context of the data sets is considered. One step towards producing a semblance of absolute comparison is the development o f a public nodule database [28] that will allow direct comparison to some degree between systems. The database is intended to contain 400 nodules within thin slice CT scans. N ot only will this help systems to be compared but it will also allow research in this area to flourish as any researcher will have access to a large database of real lung nodules.

7.1 Future Work

There is much opportunity for future development on this system as it currently stands. Developing a lung nodule detection system is a large task with many components. Lung volume segmentation, ROI extraction and FP reduction can all be very intricate projects of their own, but piecing all three together into a complete system while developing all them in parallel leaves the door open for improvements in all three areas. - The automated lung segmentation process is an evolution from previous approaches and performs well in our CT data, but further refinement is possible. The trachea is a significant object in the CT scans and further looking at how to segment it separately and analyze how it enters the lungs can lead to improving how they are segmented in those slices. The heart is a significant object that also intrudes on the segmentation and developing techniques that identify it and exclude it from the lung volume can potentially improve the segmentation process. In addition, identifying the bones around the lungs could help the process significantly as they could be used to identify shadows on adjacent slices that increase the number of FPs. The ROl process is a crucial portion o f the lung nodule detection system. A major focus o f this work was finding the right thresholds and regions to use in the system.

103

Im proving

the

ROI

extraction

process

w as

show n

to

increase

sensitivity

by

approxim ately 10% in chapter 6. Exploring other potential system s is a crucial area o f future research, as the R O l extraction process m ay be the m ost im portant stage o f a lung nodule detection system . Properly extracting the nodules is crucial to allow the system to analyze the nodules the sam e w ay a radiologist w ould w hen looking at the picture. It is relatively easy for a person to separate attached nodules from a vessel but not so for an algorithm . E ven though the LDM algorithm presented earlier failed in its im plem entation the idea behind it is a good one. M odification and developm ent o f that algorithm can potentially lead to properly extracting nodules which are strongly attached to other vascular tissue, in particular w hen the intensity o f the nodule is low er than the attached object. T his scenario is difficult for a pure thresholding approach as the nodule can not be separated from the attached object. O ne potential thresholding approach that could work for such a system w ould be using a density range rather than a threshold. All pixels w ithin the range w ould be turned on and the range can m ove through the density profile sim ilarly to a threshold. The step betw een ranges and the size o f the range w ould be crucial developm ent decisions. This system has taken a step in this direction by using the nodule range o f the threshold steps in this m anner during the ROI extraction process. T he FP reduction stage is crucial in the perform ance o f the system and is dependant on a reliable R O I extraction process. M any new and effective techniques have been im plem ented at this stage o f developm ent but FP reduction is the m ain area that needs to be im proved upon w ithin this system. Com m ercial system s claim FP perform ance anyw here in the range o f 8 to 30 nodules [52]. This system has significant inter study variance in FP perform ance and in cases is com petitive with other research system s. It is again difficult to absolutely com pare, in particular given how perform ance varies am ong system s as illustrated in chapter 6. H ow ever, given the excellent sensitivity results so far, reducing the num ber o f FPs in the future is the main focus. By m aking the system rule based it w as being setup for such future work. FP reduction stages can be changed independently and easily. One m ajor m odification that can be m ade is applying a ED A stage w hich has show n to be very prom ising in other system s [17], [19]. D eveloping such a system w ould involve a deep analysis o f the feature spaces o f lung nodules and is a m ajo r undertaking that can potentially pay significant dividends in FP

104

reduction. Also, many features can be examined further such as the perim eter feature that is used to identify interior and wall nodules. Adding new features to the system, testing their effeetiveness and analyzing the distribution o f these features among nodules and FPs is a time consuming but crucial part of further developing the system. Another consideration in the future will be applying the system to thin slice CT scans. The system is setup in a general way and can be applied directly to thin section CT scans, however it is designed to be very cautious with 3D features given the inaccuracy in 3D metrics produced my thick slice CT scans. Adapting the system to thin slice CT scans will allow it to take advantage of cleaner and more accurate nodule representations potentially producing entirely new features to analyze in the FP reduction process. The system has a very bright future and there are many important areas that can be developed. A fully functional system with innovative components has been produced in a very short period o f time, and there is great anticipation in exploiting its future potential through more research.

105

Bibliography
[1] T. Y am am oto, Y . U kai, M . K ubo, N . N iki, H. Satou and K. Eguchi, '^Computer a id ed diagnosis system with functions to assist com parative reading f o r lung cancer based on helical C T im age". T he Proceedings o f the International C onference on Im age Processing, V ol. 1, pp. 1 8 0 - 183, Sept. 2000 [2] D . L ee, "5om e com putational aspects o f low -level com puter vision". Proceedings o f the IE E E , V ol. 76, Issue 8, pp. 890 - 898, Aug. 1998 [3] R. C. G onzalez, R. E. W oods, D igital Im age Processing. 2"'^ ed., N ew Jersey; Prentice Hall, 2002 [4] K. Phoi, `''Current status and fu ture poten tial o f com puter-aided diagnosis in m edical im aging", B ritish Journal o f Radiology, Vol. 78, pp. 3-18, Jan. 2005 [5] G. C oppini, S. D iciotti, M. Falchini, N. V illari and G. V alli, "N eural networks fo r com puter-aided diagnosis: detection o f lung nodules in chest radiogram s", IEEE T ransactions on Inform ation Technology in B iom edicine, Vol. 7, Issue 4, pp. 344 - 357, D ec. 2003 [6] M . G. Penedo, A. M osquero, M. J. Carreira and D. Cabello, "Lung nodule detection in curvature space w ith m ultilayer perceptron network", Proceedings o f the 18th A nnual International C onference o f the IE EE Engineering in M edicine and B iology Society, Vol. 3, pp. 1 1 3 0 - 1132, N ov. 1996 [7] M . G. P enedo, A. M osquero, M. J. Carreira and D. Cabello, "C om puter-aided diagnosis: a neural-netw ork-based approach to lung nodule detection", IEEE T ransactions on M edical Im aging, Vol. 17, Issue 6, pp. 872 - 880, Dec. 1998 [8] S. G. A rm ato III, M . L. Giger, C. J. M organ, J. T. B lackburn, K .D oi, and H. M acM ahon, "C om puterized D etection o f Pulmonary' N odides on CT Scans", Im aging and T herapeutic T echnology, R SN A , pp. 1303-1311, 1999 [9] K. K anazaw a, Y. K aw ata, N. N iki, H. Sat oh, H. O hm atsu, and R. K akinum a, "C om puter-aided D iagnosis f o r Pulmonary Nodules B ased on H elical CT Im ages , Proceedings o f the International Conference on Pattern R ecognition, Vol. 2, pp. 1683-1685, A ug. 1998 [10] F. Li, S. Sone, H . A be, H. M acM ahon, S. G. A rm ato III and K. D oi, "Lung Cancers M issed at L ow -D ose H elical CT Screening in a General Population: Comparison o f Clinical, H istopathological, and Imaging Findings", Radiology, Vol. 225, N o. 3, pp. 673 - 683, D ecem ber 2002

1 0 6

[11] D. Sortini, K. Maravegias and A. Sortini, ''Difficulty o f early diagnosis in patients with solitary pulmonaiy nodule". Journal o f Thoracic and Cardiovascular Surgery, Vol. 129, Issue 5, pp. 1196-1196, May 2005 [12] J. W. Lee, J. M. Goo, H. J. Lee, J. H. Kim, S. Kim and Y. T. Kim, "Thepotential contribution o f a computer-aided detection system fo r lung nodule detection in multidetector row computed tomography", Investigative Radiology, Vol. 39, pp. 649 655, Nov. 2004 [13] Y. Kawata, N. Niki, H. Ohmatsu and N. Moriyama, "Example-based assisting approach fo r pulmonary nodule classification in three-dimensional thoracic computed tomography images", Academic Radiology, Vol. 10, pp. 1402 - 1415, Dec. 2003 [14] American Cancer Society, Cancer Facts and Figures 2005, Atlanta: American Cancer Society, 2005 [15] National Cancer Institute of Canada: Canadian Cancer Statistics 2004. Toronto, Canada, 2004 [16] M. S. Brown, M. F. McNitt-Grey, J. G. Goldin, R. D. Suh, J. W. Sayre, and D. R. Aberle, "Patient-Specific Models fo r Lung Nodule Detection and Saiweillance in CT Images", IEEE Transactions on Medical Imaging, Vol. 20, No. 12, pp. 1242-1250, December, 2001 [17] M. N. Gurcan, B. Sahiner, N. Petriek, H. Chan, E. A. Kazerooni, P. N. Cascade, and L. Hadjiiski, "Lung Nodule Detection on Thoracic Computed Tomography Images: Preliminary Evaluation o f a Computer-Aided Diagnosis System", Medical Physics, Vol. 29, No. 11, pp. 2552-2558, November 2002 [18] S. Hu, E. A. Hoffman, and J. M. Reinhardt, "Automatic Lung Segmentation o f Accurate Quantitation o f Volumetric X-Ray CT Images", IEEE Transactions on Medical Imaging, Vol. 20, No. 6, pp. 490-498, June 2001 [19] S. G. Armato III, M. L. Giger and H. MacMahon, "Automated detection o f lung nodules in CT scans: preliminaiy results". Medical Physics, Vol. 28, pp. 1552 - 1561, Aug. 2001 [20] M. L. Giger, N. Ahn, K. Doi, H. MacMahon and C. E. Metz "Computerized detection ofpulmonary nodules in digital chest images: use o f morphological filters in reducing false-positive detections", Medical Physics, Vol. 17, No. 5, pp. 861 - 865 Oct 1990 [21] Y. Lee, T. Hara, H. Fujita, S. Itoh and T. Ishigaki, "Automated Detection o f Pulmonary Nodules in Helical CT Images Based on an Improved Template-Matching Technique", IEEE Transactions on Medical Imaging, Vol. 20, No. 7, July 2001

107

[22] D .T. Lin, and C.R. Y an, Lung Nodules Identification Rules Extraction with N eural F uzzy N etw o rie\ Proceedings o f the International C onference on N eural Inform ation Processing, V ol. 4, pp. 2049-2053, N ov. 2002 [23] B. Z hao, G. G am su, M. S. G insberg, L. Jiang, and L. H. Schw artz, ^^Automatic D etection o f Sm all Lung N odules on C T Utilizing a Local Density) Maximum Algorithm ", Journal o f A pplied C linical M edical Physics, Vol. 4, No. 3, pp. 248-260, Sum m er 2003 [24] Y . L ee, T. H ara, H. Fujita, S. Itch and T. Ishigaki, "Nodule detection on chest helical C T scans by using a genetic algorithm ", Proceedings o f the conference on Intelligent Information System s, pp. 67 - 70, 1997 [25] F uzzy L ogic T oolbox, [online docum ent] M arch 2005 [cited 2005 June 6] A vailable at: http://w w w .m athw orks.com /access/helpdesk/help/pdf_doc/fuzzy/fuzzy.pdf [26] M . N achtegael and E. E. K erre, "Fuzzy mathematical m orphology: general concepts and decom position p ro p ertie s", Third International Conference K now ledge-B ased Intelligent Inform ation Engineering System s, pp. 255 - 258, Sept. 1999 [27] A. T. Popev, "M orphological operations on fu zzy sets". Fifth International C onference on Im age Processing and its A pplications, pp. 837 - 840, July 1995 [28] "L ung Im aging D atabase C onsortium " , [online docum ent] [cited June 6 2005] A vailable at: http://im aging.cancer.gov/program sandresources/lnform ationSystem s/L lD C /print [29] M. Fiebich, C. W eitholt, B. C. Renger, S. G. A rm ato, K. R. H offm an and S. D ietrich, "A utom atic detection o f pulm onary nodules in low -dose screening thoracic CT exam inations", Proc. SPIE 3661, pp. 1434 -- 1439, 1999 [30] J. P. K o, H. R usinek, E. L. Jacobs, J. S. B abb, M. Betke, G. M cG uinness and D. P. N aidich, "S m allpu lm on ary nodules: volume measurement at chest CT-- phantom study". R adiology, V ol. 228, N o. 3, pp. 864 - 870, Sept. 2003 [31] L. P astor, P. M anzoni, M. Parm entier and B. K astler, "Lung modeling fo r nodule analysis in H R C T \ 2001 IE EE N uclear Science Sym posium C onference R ecord, Vol. 3, pp. 1 5 0 4 - 1508, N ov. 2001 [32] W . J. K ostis, A. P. R eeves, D. F. Y ankelevitz and C. 1. H enschke, "Threedim ensional segm entation and grow th-rate estim ation o f sm all pulm onary nodules in helical C T im ages", IE E E Transactions on M edical Im aging, Vol. 20, Issue 10, pp. 1259 - 1274, Oct. 2003 [33] Y. K aw ata, N . N ik i, H. O hm atsu, R. K akinum a, K. M ori, K. Eguchi, M. K aneko and N. M oriyam a, "Q uantitative surface characterization o f pulm onary nodules based on thin-section C T im ages", IE E E Transactions on N uclear Science, V ol. 45, Issue 4, pp. 2 1 3 2 - 2 1 3 8 , A ug. 1998

108

[34] Y. Kawata, N. Niki, H. Ohmatsu, M. Kusumoto, R. Kakinuma, K. Mori, H. Nishiyama, K. Eguchi, M. Kaneko and N. Moriyama, ^ `Internai structure analysis o f pulmonaiy nodules in topological and histogram feature spaces'', Proceedings o f the International Conference on Image Processing, Vol. 1, pp. 1 6 8 -1 7 1 , Sept. 2000 [35] Y. Kawata, N. Niki, H. Ohmatsu, M. Kusumoto, R. Kakinuma, K. Mori, K. Eguchi, M. Kaneko and N. Moriyama, `` 'Curvature based analysis o f internal structure o f pulmonary nodules using thin-section CT images", 1998 The Proceedings o f the International Conference on Image Processing, Vol. 3, pp. 851 - 855, Oct. 1998 [36] R. S. Saunders Jr., E. Samei and C. Hoeschen, "Impact o f resolution and noise characteristics o f digital radiographic detectors on the detectability o f lung nodules". Medical Physics, Vol. 31, pp. 1603 - 1613, June 2004 [37] J. Bums, L. B. Haramati, K. Whitney and M. N. Zelefsky, "Consistency o f reporting basic characteristics o f lung nodules and masses on computed tomography", Academic Radiology, Vol. 11, pp. 233 - 237, Feb. 2004 [38] M. S. Smyczynski, H. C. Gifford, T. H. Famcombe, W. P. Segars, B. M. W. Tsui and M. A. King, "Impact o f respiratoiy motion on the detection o f solitary pulmonary nodules ` with SPECT tumor imaging ofNeoTect", Vol. 2, pp. 838 - 841, Nov. 2002 [39] I. Middleton and R. I. Damper, "Segmentation o f magnetic resonance images using a combination o f neural networks and active contour models". Medical Engineering and Physics, Vol. 26, Issue 1, pp. 71 - 86, Jan. 2004 [40] S. S. Wilson, "Theory o f matrix morphology", IEEE Transactions on Pattern Analysis and Machine Intelligence, Vol. 14, Issue 6, pp. 636 - 652, June 1992 [41] J. Yang and X. Li, "Directional morphology and its application in boundary detection". Fifth International Conference on Image Processing and its Applications, pp. 7 4 2 -7 4 6 , July 1995 [42] J. R. Parker, "Grey level thresholding in badly illuminated images", IEEE Transactions on Pattern Analysis and Machine Intelligence, Vol. 13, Issue 8, pp. 813 819, Aug. 1991 [43] J.-C. Yen, F.-J. Chang and S. Chang, "A new criterion fo r automatic multilevel thresholding", IEEE Transactions on Image Processing, Vol. 4, Issue 3, pp. 370 - 378, March 1995 [44] N. Ramesh, J.-H. Yoo and I. K. Sethi, "Thresholding based on histogram approximation", lEE Proceedings on Vision, Image and Signal Processing, Vol. 142, Issue 5, pp. 271 - 279, Oct. 1995

109

[45] S. G. A rm ato III, M. B. A ltm an and P. J. La R ivière, ^ ` 'Automated detection o f lung nodules in C T scans: Effect o f image reconstruction algorithm ''. M edical Physics, Vol. 30, N o. 3, pp. 461 - 472, M arch 2003 [46] A. L eon-G arcia, Probability and R andom Processes for Electrical Engineering. 2"** ed., M assachusetts; A ddison-W esley, 1994 [47] H. A nton, C. R orres, E lem entary Linear A lgebra A pplications V ersion. 7^'' ed., N ew Jersey: W iley, 1994 [48] R. K eys, `' 'Cubic convolution interpolation f o r digital image processing", IEEE T ransactions on A coustics, Speech, and Signal Processing, Vol. 29, Issue 6, pp. 1 1 5 3 1160, D ec. 1981 [49] W .A .H . M ousa, and M .A .U . K han, ``Lung Nodule C la ssif cation utilizing Support Vector M achines", Proceedings o f the International C onference on Im age Processing, V ol. 3, pp. 153-156, June 2002 [50] D. S. Paik, C. F. B eaulieu, G. D. Rubin, B. A car, R. B. Jeffrey Jr., J. Yee, J. Dey and S. N apel, ''^Surface norm al overlap: a com puter-aided detection algorithm with application to colonic p o lyp s and lung nodules in helical C T \ IEEE Transaction on M edical Im aging, V ol. 23, Issue 6, pp. 661 - 675, June 2004 [51] M . S. B row n, J. G. G oldin, R. D. Suh, M . F. M cN itt-G rey, J. W. Sayre and D. R. A berle, '"Lung M icrondules: A utom ated M ethod fo r D etection at Thin-Section C T Initial E xperience" R adiology, V ol. 226, pp. 256 - 262, Jan. 2003 [52] K. M arten, A . G rillhosl, T. Seyfarth, S. O benauer, E. J. Rum m eny and C. Engelke, " `C om puter-assisted detection ofpu lm onary nodules: evaluation o f diagnostic perform an ce using an expert know ledge-based detection system with variable reconstruction slice thickness settings", European R adiology, V ol. 15, N o. 2, pp. 203 -- 212, Feb. 2005

110

