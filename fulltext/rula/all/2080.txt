NOTE TO USERS

This reproduction is the best copy available.

UMI
R ep ro d u ced with p erm issio n of th e copyright ow ner. Further reproduction prohibited w ithout p erm issio n .

R ep ro d u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited w ithout p erm ission .

O F D M S y stem s: S y m b o l E rror R a te E v a lu a tio n , F ilter B a n k D e sig n and J o in t M a x im u m L ik elih o o d D e te c tio n

by
(MEng, Beijing University of Aeronautics and Astronautics, China, 1995) (BSc, Beijing University of Aeronautics and Astronautics, China, 1992)

A thesis presented to Ryerson University in partial fulfillment of the requirement for the degree of Master of Applied Science in the Program of Electrical and Computer Engineering Toronto, Ontario, Canada, 2003

©YUHONG WANG 2003

R ep ro d u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without p erm issio n .

UMI Number; EC52901

INFORMATION TO USERS

The quality of this reproduction is dependent upon the quality of the copy submitted. Broken or indistinct print, colored or poor quality illustrations and photographs, print bleed-througn, substandard margins, and improper alignment can adversely affecc reproduction. In the unlikely event that the author did not send a complete manuscript and there are missing pages, these will be noted. Also, if unauthorized copyright material had to be removed, a note will indicate the deletion.

®

UMI
UMI Microform EC52901 Copyright 2009 by ProQuest LLC. All rights reserved. This microform edition is protected against unauthorized copying under Title 17, United States Code. ProQuest LLC 789 E. Eisenhower Parkway PC Box 1346 Ann Arbor, Ml 48106-1346

B o r r o w e r 's P a g e
Ryerson University requires the signatures of all persons using or photocopying this thesis. Please sign below, and give address and date.

N am e

S ig n a tu re

A d d ress

D a te

Ill

R ep rod u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without perm ission.

A b s tr a c t
OFDM Systems: Symbol Error R ate Evaluation, Filter Bank Design and Joint Maximum Likelihood D etection YUHONG WANG M aster of Applied Science of Electrical and Com puter Engineering Ryerson Uni verst iy A closed-form symbol error rate (SER) formula for a generic OFDM system w ith ilf-ary phase shift keying (M PSK) m odulation, and optim al phase detector for each subchannel, is derived. By employing the derived SER formula as the objective function, a novel OFDM system based on designed complex-valued unitary filter banks is presented to minimize th e SER. A detection algorithm is presented for a generic OFDM system to jointly detect subchannel symbols received in one tim e frame. M onte-Carlo num erical sim ulations are perform ed to verify the theoretical SER analysis and compare the error perform ance of the proposed OFDM system with D FT-based OFDM and DWk'lT systems, and the new joint detection algorithm w ith the conventional subchannel detection algorithm . The above efforts provide system atic approaches for the OFDM error perform ance analysis and the OFDM system design. K e y w o rd s; OFDM system, M PSK, symbol error rate, u nitary filter bank, joint m ax im um likelihood detection.

IV

R ep rod u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without p erm ission .

A c k n o w le d g m e n t
I appreciate the support and encouragement from Dr. Xiao-Ping Zhang, my supervi sor. His expertise hr com munications and filter banks is very helpful for this work. I would like to thank all the com m ittee members for their participation in m y thesis defense. I would like to thank th e Electrical and C om puter Engineering departm ent at Ryerson University for th e financial support of my study and research. I would like to thank all staff of the Electrical and Com puter Engineering at Ryerson University for their kind help. I wish to convey the warm est thanks to my family for their endless support.

R ep rod u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without perm ission.

C o n ten ts

1 2

In tr o d u ctio n P rin cip les o f D ig ita l F ilte r B an k s 2.1 Fundam entals of Digital Filter Bank 2.1.1 2.1.2 2.1.3 2.2 ...................................................................

1 6 7 8 10 13 14 14 16 18 19 20 20 22 24 24 27 29

Basic Building B lo ck s.................................................................................... Polyphase S tr u c tu r e s .................................................................................... Perfect R econstruction P r o p e r ty ................................................................

Filter Bank Based T ran sm u ltip lex er...................................................................... 2.2.1 2.2.2 TDM and F D M .............................................................................................. Perfect Reconstruction T ra n s m u ltip le x e r...............................................

2.3 3

S u m m a r y .....................................................................................................................

O rth ogon al F req u en cy D iv isio n M u ltip le x in g (O F D M ) S y ste m s 3.1 Basic Principles of OFDM 3.1.1 3.1.2 3.2 ....................................................................................

D ata G eneration and M o d u la tio n ............................................................ OFDM T i-ansm ultiplexer..............................................

DFT-Based OFDM and D W h lT ............................................................................. 3.2.1 3.2.2 D FT-based O F D M ....................................................................................... Discrete Wavelet M ultitone S y stem s......................................................... .....................................................................................................................

3.3 4

Summ ary

S y m b o l Error R a te E v a lu a tio n and F ilte r B a n k D e sig n for O F D M S y s te m s w ith M P S K M o d u la tio n vi 30

R ep rod u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without p erm ission .

4.1

Symbol E rror R ate Evaluation for OFDM Systems w ith M PSK M odulation 32 4.1.1 4.1.2 4.1.3 System M o d ellin g ........................................................................................... Symbol Error R ate for Generic M PSK-OFDM S y s t e m s ..................... SER Expression for AWGN C h a n n e ls ....................................................... 32 33 40 41 42 43 44 45 51

4.1.4 SER Expression for Fading C h a n n e ls ....................................................... 4.2 Complex-Valued U nitary Filter Bank Based OFDM System Design 4.2.1 . . . .

Param eterization of Filter Bank C o e ffic ie n ts..........................................

4.2.2 SER Improvement Based on Proposed Filter B a n k s ............................ 4.3 4.4 5 S im u la tio n s .................................................................................................................. Sum m ary ......................................................................................................................

J o in t M a x im u m L ik elih o o d D e te c tio n A lg o r ith m for O F D M S y ste m s a n d Error P erfo rm a n ce A n a ly sis 5.1 Joint D etection A lgorithm for OFDM S y s te m s .................................................... 5.1.1 System M o d ellin g ............................................................................................ 54 56 56 57 62 64 67 67 69 72 72 74 75 77

5.1.2 C onstellation Points of Received Vector S y m b o ls................................... 5.1.3 Joint Detection of Received Vector S y m b o l............................................. 5.1.4 E rror Perform ance A n a l y s i s ........................................................................ 5.1.5 Discussions 5.2 5.3 6 ..............................................................................

S im u la tio n s .................................................................................................................. Sum m ary ......................................................................................................................

C o n c lu sio n s an d F u tu re R esea rch 6.1 6.2 C o n c lu s io n s .................................................................................................................. Future R e s e a rc h ............................................................................................................

A B

C e n tr a l L im it T h e o re m C h a n g e o f V ariab les

Vll

R ep ro d u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without perm ission.

L ist o f F igu res
2.1 Block diagram of a generic digital filter b a n k ....................................................... 2.2 Ideal m agnitude responses in a P-subcham iel filter bank ............................... 7 8 8 9 11 12

2.3 D em onstration of decim ation for I f = 2 ................................................................. 2.4 D em onstration of the interpolator for P -- 2......................................................... 2.5 Noble identities of m ultirate s y s t e m s .................................................................... 2.6 T he polyphase representation of a P -b an d maximally decim ated filter bank 2.7 The simplification of polyphase representation of P -b an d m axim ally deci m ated filter b a n k 2.8 (a) Tim e dom ain m ultiplexing (b) Time domain dem ultiplexing...................... 2.9 T he operation of a frequency division m ultiplexer................................................ 2.10 T he transm ultiplexer based on filter bank s t r u c t u r e ......................................... 2.11 (a) Equivalent structures for the transm ultiplexer using polyphase m atrices,

13 14 15 16

(b) rearrangem ent using noble identities, (c) simplified stru c tu re ........................ 17 3.1 T he block diagram for an OFDM tra n s c e iv e r....................................................... 3.2 D a ta parsing function in an OFDM transceiver. T he num ber of subchannels P -- 3. Sign represents single binary s y m b o l................................................... 21 22 23 20

3.3 T he block diagram of an OFDM tra n s m u ltip le x e r............................................. 3.4 T he construction of ou tp u t of tran sm ittin g f i l t e r s ............................................. 3.5 Subchannel frequency responses of D FT-based OFDM system for oj G

^ ^ & 8 8 ]m M P = 3 2 .....................................................................................................

26

vm

R ep rod u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without p erm ission .

3.6

The stylized plot of CP inclusion. T he Ik long CP can also be th e trailing zeroes................................................................................................................................. 27 27 29

3.7 3.8 4.1 4.2

The schematic diagram of a D FT -based OFDM s y s t e m ................................. Frequency responses of a D W M T system for u; G [0,0.88] and P = 32 . . .

Block diagram for filter bank m odulator and dem odulator in OFDM systems 32 Error perform ance of single carrier m odulation and th e conventional DW M T {g = 2) m odulation w ith B P S K .............................................................................. 41

4.3

Error perform ance of the conventional D W M T systems {g = 2) over channel c(n.) = [ 1 , 0. 2e^W 2^ Q.i]......................................................... 42 47

4.4 4.5

Flow chart of system s i m u l a t i o n ............................................................................. Com parison of th e analytical and sim ulated perform ance of OFDM systems over AWGN channels; Q PSK (P = 1 6 ) ................................................................

48

4.6

Com parison of th e analytical and sim ulated perform ance of OFDM systems over AWGN channels: QPSK (P = 3 2 ) .....................................................................48

4.7

A m plitude characteristics of frequency responses of two channels used in sim ulations ................................................................................................................... 49

4.8

Com parison of th e analytical and sim ulated perform ance of OFDM systems w ith Q PSK coding over channel ci[n) (P = 1 6 ) ............................................... 50

4.9

Com parison of th e analytical and sim ulated perform ance of OFDM systems w ith Q PSK coding over channel c^in) (P = 16)................................................... 50

4.10 C om parison of th e analytical and sim ulated perform ance of O FD M systems w ith Q PSK coding over channel Ci(?r) (P = 3 2 ) ................................................ 4.11 C om parison of th e analytical and sim ulated perform ance of O FD M systems w ith Q PSK coding over channel C 2 {n) (P = 32)................................................... 4.12 System perform ance of different OFDM systems w ith Q PSK m odulation over channel Ci(n) (P = 32)........................................................................................ 4.13 System perform ance of different OFDM systems w ith Q PSK m odulation over channel C 2 (n) (P = 32)........................................................................................
IX

51

51

52

52

R ep rod u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without p erm ission .

5.1 5.2 5.3 5.4

Block diagram for filter bank m odulator and dem odulator in O FD M systems 56 Schematic illustration of ML d e te c to r ................................................................... C alculation of SER under joint detection a l g o r i t h m ........................................ Com parison of joint detection and subchannel detection over an AWGN channel w ith BPSK ( P = 3 2 ) ................................................................................. 70 64 69

5.5

Com parison of joint detection and subchannel detection over channel Ci(?7.) v d m B P S K ( P = 3 2 ) .................................................................................................. 70

5.6

Com parison of joint detection and subchannel detection over channel C 2 (n) v d ^ B P S K ( P = 3 2 ) .................................................................................................. 71 77

B .l

Illustration of change of varia,b l e s ..........................................................................

R ep rod u ced with p erm ission o f th e copyright ow ner. Further reproduction prohibited without p erm issio n .

C h a p ter 1 In t ro d u ct io n

and wireless systems. T he principle of MCM consists of splitting up a w ideband signal a t a high symbol ra te into several lower ra te signals, each one occupying a narrow er band, so called a subchannel or a subcarrier. By dividing th e in p u t d a ta stream into parallel substream s, and each stream being m odulated and m ultiplexed onto one of subchannels a t different carrier frequencies, the power spectrum of th e tra n sm itte d signal can be shaped to m a tc h th e channel characteristics to achieve near optim al perform ance theoretically. T he general recognized advantage of th e MCM is its robustness against different types of channel distortions, such as m u ltip ath propagation and narrow band interferences [1, 2, 3]. O rthogonal frequency division m ultiplexing (O FDM ), as th e m ost im p o rtan t class of the M CM , has been under intensive research and developm ent in recent years [4, 5, 6, 7]. In th e O FD M m odulation, subcarriers are m ade m utually orthogonal so th a t th e receiver can sep arate these subcarriers even there is spectral overlapping am ong them . The MCM apjjroach adopted in O FD M is th e filtered m ultitone, in which a filter bank m odulator and dem odulator transfers tim e-division m ultiplexed (TDM ) d a ta to frequency-division m ultiplexed (FDM ) d a ta and vice versa [8, 9]. A filter bank m o d u lato r divides the spec tr a of com m unication channels into a set of spectrally overlapping or non-overlaiDping subchannels, and the aliasing caused by spectral overlapping will b e rem oved by a fil-

I

N recent years, m ulti-carrier m odulation (MCM) has become increasingly popular as a transm ission technique, especially in high speed com m unications, including wireline

R ep ro d u ced with p erm ission o f th e copyright ow ner. Further reproduction prohibited w ithout p erm issio n .

2 te r bank dem odulator, if th e niter bank m odulator and dem odulator fulfills th e perfect reconstruction (PR ) pro p erty flO]. M ainly two types of filter banks have been adopted as m odulators and desnodulators in O FD M system s. T he application of th e first one, discrete Fourier transform (D FT ) filter banks, was proposed decades ago [11] and has found broad applications such as very high-speed digital subscriber lines (VDSL) [12], E uropean d igital audio broadcast ing (DAB), E uropean digital video broadcasting (DVB) and short-range wireless access an d wireless LAN stan d ard s (IEEE802.11a). A D F T filter bank exhibits th e desired m u tu a l orthogonality of subchannels and can be im plem ented w ith a fast Fourier transform (F F T ) algorithm . T h e other type of the filter banks, which are generated from a well designed prototype filter via extended lapped transform (ELT), have been proposed for discrete wavelet m ultitone (DW M T) system s as another realization of th e O FD M m odula tion [13, 14, 15]. A dopted as one of signaling stan d ard s for asym m etric d igital subscriber lines (ADSL), a D W M T system can achieve a high level of subchannel spectral contain m ent so th a t it is m ore rob u st w ith regard to interchannel interference and narrow band channel noise com pared to th e D FT -based O FD M system [13, 16]. In m ost practical O FDM systems, the m u tu al orthogonality of subchannels is often destroyed by non-ideal transm ission channels. T he tran sm itted symbols for a given sub channel m ay be d isto rted by co-subchannel symbols (intersym bol interference or ISI) and symbols on the other subchannels (interchannel interference or IC I), as well as th e channel noise. For th e D F T -based O FD M system , the high degree of spectral overlaps am ong the subchannels of D F T filter banks m akes it difficult to retain subchannel isolation for m ultip a th channels, therefore a technique in which a `cyclic prefix' is inserted a t th e beginning of each d a ta segm ent has been adopted, at th e cost of system efficiency [2, 8], to partially offset th e interference introduced by com m unication channels. Due to th e existence of ISI, IC I an d channel noise in an OFDM system , th e precise error perform ance evalua tio n can n o t be readily obtained. Recently some a tte m p ts based on certain assum ptions an d bounds have been m ade to investigate th e error perform ance of the O FD M system s

R ep ro d u ced with p erm issio n of th e cop yright ow n er. Further reproduction prohibited w ithout p erm issio n .

3 [6, 17, 18, 19, 20, 21]. T h e absence in these efforts includes th e following two topics; a. T he error perform ance evaluation has been conducted only for th e D FT -based O FD M system s. However, th e error perform ance of a generic O FD M system , in which th e m odulation filters form a set of orthonorm al basis, and th e filter bank m o d u lato r and dem odultor fulfill th e P R property, such as th e D W M T systems, has not been system atically investigated. b. T he detection algorithm adopted for O FD M system s has been th e conventional subchannel detection algorithm , under which the detection and decoding is done per received subchannel symbol by considering effects from all th e other symbols, except th e one to be decoded, as interference. Consequently, under this detection algorithm , for a given suchannel, inform ation carried by th e sym bols of th e other subchannels is n o t used for obtaining a b e tte r evaluation of sym bols tran sm itted on th e given subchannel and to improve th e system error perform ance. B oth of th e above topics are addressed in this thesis. The error perform ance of a generic O FD M system , w ith D FT -based O FD M and D W M T as two realizations, is stu d  ied by considering th e effects of b o th interference and additive channel G aussian noise. By studying th e constellations of received symbols an d the interference for a given sub channel, an d m odelling th e sum of ISI and IC I as a Gaussian process using th e C entral Lim it T heorem , th e statistical probability of th e received sym bol on a given subchannel is investigated. Furtherm ore, a closed-form expression of the sym bol error ra te (SER) is derived for a generic O FD M system em ploying M PSK m odulation and th e conventional o ptim al phase detector in each subchannel. T his SE R formula can b e applied to b o th the D F T -b ased O FD M an d the D W M T systems. It can also be used as a design criterion for an O FD M system . T his SE R form ula is verified w ith num erical M onte-C arlo sim ulations by em ploying D F T based O FD M system s and conventional discrete wavelet m ultitone (D W M T ) system s. Sim ulation results are consistent w ith th e derived form ula. This work is presen ted in [22].

R ep ro d u c ed with p erm issio n of th e cop yright ow n er. Further reproduction prohibited w ithout p erm issio n .

4 In addition, by using th e derived SER formula as the objective function, a novel OFDM system based on designed complex-valued u nitary filter banks w ith improved system error perform ance is presented. A u n itary filter bank is a good candidate to OFDM m odula to r / dem odulator due to th e inherent m utual orthogonality betw een filters. In addition, unlike to real-valued coefficient filters, complex-valued filters have asym m etric frequency responses and are m ore suitable to deal w ith complex-valued signals which are often present in wireless systems. Filters in the presented OFDM system are param eterized w ith free param eters, which can be adjusted to various applications. In th is thesis, the free param eters are determ ined to minimize the SER by employing th e derived SER as th e objective function. Sim ulation results show th a t the designed OFDM system outperform s th e conventional D W M T system s in term s of SER and has com parable SER, perform ance w ith the D FT -based OFDM systems [22]. By taking different objective functions, the complex-valued filter banks can be adjusted to various criterions in OFDM design as presented in [23, 24]. To address the topic b, a detection algorithm for a generic OFDM system which jointly detects an d decodes subchannel symbols received in one frame, is presented. T he m ain advantage of this jo in t detection algorithm is th a t, it tu rn s th e m utual effects of jointly decoded subchannel symbols, from interference to useful inform ation contributing to th e constellation points of each other. The received symbols from a subset of subchannels are considered as th e m ultidim ensional vector symbols and the constellation points of th e vector symbols are derived. Based on derived constellation points, m axim um likelihood (ML) criterion is employed in detecting th e vector symbol. Lower and upper bounds of th e vector sym bol error ra te is presented. Sim ulations are conducted to com pare th e detection perform ance 'uider the proposed joint detection algorithm and th e conventional subchan nel detection algorithm . It is shown th a t th e joint detection algorithm outperform s the subchannel detection algorithm for b o th D FT -based O FD M and DW M T systems. This p a rt of w ork is presented in [25]. O u tlin e: T he rem ainder of this thesis is organized as follows. In C hapter 2, the

R ep ro d u ced with p erm ission of th e copyright ow n er. Further reproduction prohibited without p erm issio n .

5 fiindam entals of digital filter banks, which act as th e m odulator and dem odulator for the OFDM transm ission, are introduced. In C hapter 3, the basic principles and properties of an OFDM system are sum m arized. In C hapter 4, a closed-formed SER form ula is derived, for a generic OFDM system w ith M PSK m odulation and th e optim al phase detector for each subchannel. A novel O FDM system, based on designed complex-valued u nitary filter banks, is presented. In C hapter 5, a new joint detection algorithm and error perform ance analysis under this algorithm are introduced. C hapter 6 concludes th e thesis and proposes several topics for further work. N o ta tio n s ; Boldface lower-case letters are used to represent vectors, and boldface upper-case letters are reserved for m atrices. T he notations and represent the

transpose and transpose-conjugate (H erm itian) of A , respectively. The superscript A*, denotes th e conjugation only. T he Kronecker function is defnied as

=

{i

n ;

a

T h e notatio n diag{ao,ai, · ,o.p-i) denotes an P x P diagonal m atrix w ith diagonal elem ents a^, h = 0,1, · · ·, P -- 1.

R ep ro d u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited w ithout p erm ission .

C h a p ter 2 P rin c ip le s o f D ig ita l F ilter B an k s

T

h e idea of subdividing a signal frequency band into a set of subbands was recog nized very early in th e fields of m ultirate signal processing, where subband p arti

tioning was introduced to perform short-tim e spectrum analysis of speech signals, initially in analog and then in digital form. It was later found th a t, for th e digital representa tion of speech signals, if the subbands are individually quantized (subband coding) w ith possibly different accuracy, it is possible to achieve, for the same to tal bit rate, a signal quality b e tte r th an th a t obtained by quantizing the full-band signal. Over the last two decades, th is discipline of technology: has found applications in image compression, the digital audio industry, statistical and adaptive signal processing and in m any other fields [26, 27]. It also fits naturally w ith certain special classes of time-frequency representations such as th e short-tim e Fourier transform and the wavelet transform , which are useful in analyzing th e tim e-varying n atu re of signal spectra. The principal element for the spectral splitting is th e perfect reconstruction (PR) ciuadrature m irror filter (QM P) bank. The P R QM F stru ctu re allows spectral decompo sition into a set of overlapping segments in such a way th a t the aliasing incurred in the initial `analysis stage' is elim inated during signal reconstruction by the `synthesis' stage, and all th e am plitude and phase distortion is completely elim inated in th e reconstructed signal. In tills chapter, the fundam entals of digital filter banks, w ith emphasis on maxim ally

R ep ro d u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without p erm ission .

7 décima,ted Q M F filter banks, are presented. T he topics to be discussed include operations of decim ation and interpolation in Section 2.1.1, polyphase structures in Section 2.1.2 and the property of P R in Section 2.1.3. In addition, th e filter bank based transniultiplexer, which acts as the m odulator and dem odulator in MCM systems, is introduced in Section 2.2. Section 2.3 summarizes this chapter. This chapter provides a sum m ary of the principles of digital filter banks as presented in [10, 26, 28].

2 .1

F u n d a m e n ta ls o f D ig it a l F ilt e r B a n k

x(n)

«/f'd

(n) x(nj

F ig u r e 2.1: Block diagram of a generic digital filter bank

Fig. 2.1 illustrates a generic form of a QMF digital filter bank w ith P subbands. The upsam pling / downsampling factor is donated as K and K < P. As shown in Fig. 2.1, a filter bank can be a parallel arrangem ent of a set of filters w ith a common input (analysis filter bank) or w ith the o u tp u t of the filters sum m ed to generate a single synthesized signal (synthesis filter bank). The analysis filter bank, {ho{n) hp(n) denoted as t l , , hp{n)}, w ith

' npulse response for the pth-filter for 0 < p < P -- 1, splits the

signal x{n) into P suuband signals. In frequency dom ain, the analysis filter b an k splits th e spectrum of x{n) into P uncorrelated subbands. Fig. 2.2 shows th e ideal m agnitude responses in a P subband filter bank. The synthesis bank { /o (n ),/i(n .), · · · , /p _ i(n )} , combines P signals {£'o(n), £ i(n ), · · · , x p - i { n ) } into one signal x{n), typically called the reconstructed signal. A filter bank is said to be critically sam pled or m axim ally decim ated when K -- P.

R ep rod u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without perm ission.

F.
0

· · ·

Fo
1

2k

<a

F ig u re 2.2: Ideal magnitude responses in a F-subchannel filter bank According to the sampling theory, the original signal :r(n) can not be reco^'ered perfectly from the signal x{n) if K > P. W ith K < P, x{n) may be restored from x{n) if th e filter bank satisfies the P R property.

2 .1 .1

B a s ic B u ild in g B lo c k s

Two of th e most basic building blocks used in m ultirate filter bank systems are the decim ator and the interpolator, which are shown in Fig. 2.1 w ith symbols j, K and t A , respectively. The AT-fold decim ator takes an input sequence x{v) and retains only samples th a t occur a t times which are multiples of K . Fig. 2.3 dem onstrates the idea for K -- 2. T he in p u t/o u tp u t relation is therefore y{n) = x { Kn) .

T

-I

0

I

I

2

n

K

-I I

1 n

F ig u re 2.3: Demonstration of decimation for K = 2 T he relation of the input x{n) and o u tp u t y(n) of a /\-fo ld decim ator, which denoted

R ep rod uced with p erm ission of the copyright ow ner. Further reproduction prohibited without p erm ission .

as j. AT, in Z-transform dom ain is K-L Y { z ) = lA'(2 )l,,f =
(= 0

X ( z Y '<W>), Eq. (2.1) becomes

( 2 . 1)

wliei'e W is defined as W = e

W ith z = A'-l

( 2 .2 )
1=0

which shows th a t Y (<ÿ^) is a sum of K uniformly shifted versions of an Ai-fold stretched version of %(eh^'). There are overlaps between various term s in Eq. (2.2) and these overlaps are usually called aliasing. T he A'-fold interpolator, indicated by the symbol of T K , has the following inputo u tp u t relationship:
3

/( 7 1 )

x(-^), 0,

if n is multiples of K, otherwise,

(2.3)

i.e., the o u tp u t y{n) of th e interpolation is obtained by inserting K --1 zero-valued samples betw een the adjacent samples of x{n). Fig. 2.4 is a dem onstration of this operation for K = 2.

x(n)
0 1 2 3 4

 n

n
0 1 2 3 4 5 6 7

F ig u re 2.4: Demonstration of the interpolator for K = 2. In the transform dom ain th e in p u t-o u tp u t relationship of an interpolator, expressed w ith 'f K , is equivalent to (2.4) i.e., y(e-7^) is merely a /F-fold compressed version of w ith period 27T, the function T(e^^) has period of 2'n/K. Since XieP'^) is periodic

R ep rod u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without perm ission.

10 As shown in Fig. 2.1, the filter proceeding a (A-fold) decim ator, Hp{z), /> ; = 0,1, · · , P -- 1, is called a decim ation filter. A decim ation filter is used to bandlim it the signal and reduce the aliasing effect caused by th e decimator. On the other hand, an interpola tion filter Fp{z), fc = 0,1, · · ·, P -- 1, follows an interpolator to elim inate the repetitions of the compressed version of caused by the interpolator. In tim e domain, the

input-output relation of a decim ation filter can be expressed as:
00 OO

' ^p{n) = H
/ = -- OO

:ip{l)hp{nK ~ I) = ^
l = -- OQ

hp{l)xp{nK - I),

(2.5)

for p = 0,1, · · , P -- 1, and the input-output relation of an interpolation filter can be expressed as:

2 .1 .2

P o ly p h a s e S tr u c tu r e s

The polyphase representation is im portant in the analysis and im plem entation of m ultirate filter bank system s because it perm its great simplification of theoretical results and also leads to com putationally efficient im plem entations of decim ation/interpolation filters, as well as filter banks. In the following, th e discussion is lim ited to the maxim ally decim ated filter banks of which the number of subbands equals to upsam pling/dow nsam pling factor, i.e. K = P. In the following, the letter P is used to represent b o th the num ber of

subbands and the upsam pling/dow nsam pling factor. To explain th e basic idea, of the polyiahase ; ` r u c tu re , let. H{z) be any transfer function w ith impulse response h(n). Define the P sequences ez(Ti) = /i(Z + P7% ), 0 < Z < P - 1 , and define
CO

(2.7)

^ ,( ^ ) = then H (z) can be expressed as

E D(7%)z-\ n=-- O O

(2.8)

n (z )= ^ z -'E ,(z n . l= Q

(2.9)

R ep rod u ced with p erm ission of the copyright ow ner. Further reproduction prohibited without perm ission.

11

As defined in Eq. (2.8), {E'o(z),

- , E p ^ i ( z ) } are said to be the P polyphase compo

nents of H{z) and Eq. (2.9) is called th e (P-com ponent) polyphase representation of H{z). A second type of polyphase representation is of the form H{z) -- where Ri{z) = Ep_i ^i{z) are perm utations of Ei{z). The la tte r representation is more convenient in dealing w ith synthesis filters. Two useful identities about polyphase structure, so called noble identities, are intro duced in Fig. 2.5, while symbol ' = ' means two items in b o th sides of the symbol are equivalent. These identities hold for any H{z). Please refer to [26] for proofs of these identities.

x(n)

F ig u r e 2.5: Noble identities of multirate systems

T h e filter banlcs in Fig. 2.1 can be simplified by applying polyphase structure. The analysis filters can be expressed as % (4 = E z-'E,,{zn, /=0 where Epi(z^) is the z-transform of epi(n) which is defined as Gpz(M ) = hp{l -h Pn). We can p u t th e z-transform of analysis filters in m atrix form at as
( 2 . 11 )
( 2 . 10 )

r

ffo(z) W i(z)

1

-

1
z~^

( 2 . 12 )

. ^ p -i(z) .
where
Eoo{z) Eio{z) E qi{z )
·  ·

E ii(z)
E p-i,i{z)

...

E( E

(2.13)
Ep

 Ep - l f i { z )

R ep rod uced with p erm ission of th e copyright ow ner. Further reproduction prohibited without perm ission.

12 The set of synthesis filters can be expressed in a similar way w ith the second type of polyphase structure as f'p(z) = E L= 0 where Rip{z) = E/(f_i_()(z). Using m atrix notations we have
[j:o(z) fi(z) --jF f_ i(z )] = [z-(f-:^) ... l]A (z^ ),

(2.14)

(2.15)

where -^oo(z) i?0l(2)
R o,P -l{z]

A(z) =

.Rio(z)
, Rp- i . o{z)

.Rn(z)
Rp-ij(z)
· · ·

Ri,p-i{z) Rp-i,p-i{z)

(2.1G)

By adopting above polyphase representations, the filter banks of Fig. 2.1 can be rep resented w ith a equivalent representation shown in Fig. 2.6. W ith noble identities shown in Fig. 2.5, Fig. 2.6 can be redrawn as in Fig. 2.7, where m atrix Q{z) -- R { z ) E { z ) is the transfer m atrix. Polyphase representations can be used to explain the PR property wdrich will be discussed in the following.
Xg(n)
-I

X, (n) y(n) f

TDM

Synthesis bank

FDM

A nalysis bank

TDM

(nR
Xj(ll)-

\p \p \p

y(i> ) U-' '-W

\p

A 'tzi

Xp_,(n)-

F ig u re 2.6: The polyphase representation of a P-band maximally decimated filter bank

R ep rod u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without perm ission.

13

x(n)

~ 1

 -/
F igure 2.7: The simplification of polyphase representation of P-band maximally decimated filter bank

2 .1 .3

P e r f e c t R e c o n s t r u c tio n P r o p e r t y

W hen a Q M F bank is free from aliasing, am plitude distortion and phase distortion, then the reconstructed signal .-r(n) is merely a scaled and delayed version of x{n), i.e. x{n) = cx{n -- mo), where b o th c and iuq are constants and mo is an integer, then this filter bank is said to have th e P R property. T he necessary and sufficient condition of the PR property for a m axim ally decim ated QM F bank are (2.17) or m ost generally, Q{ z ) = R ( z ) E ( z ) = cz --no I
p-r

0

(2.18)

for some integer r w ith 0 < r < P -- 1 and some integer uq. The I is th e identity m atrix. The delay involved in th e filter bank is mo = P uq + r + P -- 1. W ith o u t loss of much generality, by om itting the effects of th e constant delay and scaling and assigning the delay factor as r = 1, th e necessary and sufficient condition for a filter bank to be P R can be w ritten as Q (z) = A(z)Æl(z) = f , or Q (z) = A (z)jB (z) = 0 Ip-i 0
(2.20)

(2.19)

R ep ro d u ced with p erm ission of the copyright ow ner. Further reproduction prohibited without perm ission.

2 .2

F ilt e r B a n k B a s e d T r a n s m u ltip le x e r

14

T he function of transniultiplexer in digital comiminications is to convert betw een two d a ta form ats called th e TD M form at and th e FDM format. This function can be accomplished w ith a set of analysis filters and a set of synthesis filters.

2 .2 .1

T D M and FD M

To describe the TD M form at consider Fig. 2.8(a), where three signals are passed through 3-fold interpolator and added through a delay chain. It can be shown th a t y{n) is an Interleaved version of t he three signals, th a t is , it has the form zo(0), Ti(0), Z2(0), zo (l), 3:2(1), - - -}

This is th e TDM version of the three signals. We can recover th e three signals from y{n) by using th e tim e-dom ain dem ultiplexer shown in Fig. 2.8(b). To explain th e FDM
y(n}-I

X, (n)

`~X2(-])X2(0) · ·
y( n)

-^x,(-I)x^(0) ' · · (b)

(a)

F ig u re 2.8: (a) Time domain multiplexing (b) Time domain demultiplexing.

operation, consider Fig. 2.9 where th e frequency responses of three signals XQ{n),xi{n) and .X 2 (n) are shown. The FD M signal y{n) is a single com posite signal, whose transform is obtained by `pasting' th e fruquency response of th e individual signals next to ea,ch other. The FD M operation can be performed using th e circuit shown at the right b o tto m of Fig. 2.9, where each individual signal is first passed th ro u g h an interpolator to obtain a 3-fold compression of th e transform . The interpolation filter Fp{z) (assume ideal for th is discussion), p = 0 ,1 ,2 , retains one out of th e three im ages which appear in Xp( eF^) , T he shaded portions in Fig. 2.9 are the retained images from each signal. The

R ep ro d u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without p erm issio n .

15

filter responses, which pass th e shaded regions of th e respective signals, are shifted w ith respect to each other so th a t th e retained p arts from Xp(e^^` ^) do no t overlap w ith th e retained p arts form up, th e FDM signal,
P 7^

k. W hen the o u tp u ts of th e three filters are sum m ed

is obtained.

0

2 (s'-"" C O

\/i'V L _< <
% / e '- " '.

2n

C O

C O 2%

0

27t

N/1 \/
\

(0 2k

\/

/

-- H 13
C O X , (n )--

F,,(z)

n n ~ H F,(z)
H I -- A P2 (z)
^y(n)

Signal 0 Signal 1 Signal 2

Figure 2.9: The operation of a frequency division multiplexer. Fig. 2.10 shows th e com plete filter bank based transm ultiplexer. W hen th e synthesis filters, {Fo(z), F i(z ), · · ·, F p _ i( 2 :)}, are non-ideal, the adjacent sp ectra in Fig. 2.9 will actually ten d to overlap. Similarly if the analysis filters, Hp{z), p = 0,1, · · ·, P -- 1, are non-ideal, th e o u tp u t of Hp{z), p = 0,1, · · ·, P --1, has contributions from Xp{e^` ^) as well as Xk{G^^) for p ^ k. Therefore in general, each of the reconstructed signals Xp{n) has contribution from th e desired signal Xp(n) as well as th e 'cross-talk' term s x-/.(n), p ^ k. In th e following, we will present an approach to transm ultiplexing in which cross-talk is p e rm itte d in the TD M -- ^ FDM converter and th en cancelled by th e FD M TD M

converter stage. It can be shown th a t the cross talk term s can be com pletely elim inated w ith carefully selected analysis and synthesis filters.

R ep ro d u ced with p erm ission o f the cop yright ow ner. Further reproduction prohibited w ithout p erm issio n .

16

x,(n)
FDM
TDM

'Xj(n)

Synthesis Bank

Analysis Bank

TDM

F ig u re 2.10: The transniultiplexer based on filter bank structure

2 .2 .2

P e r f e c t R e c o n s t r u c t i o n T r a n s m u lt ip le x e r

If the received signal i'p(n) of subchannel p, p = 0,1; · · ' i -P--1, is ju s t a delayed and scaled version of Xp{n)^ th e n th e transniultiplexer is a P R transniultiplexer. In th e following, th e sufficient condition for a P R transniultiplexer is sum m arized. Fig. 2.10 shows th a t

fc=0

k=0

k=0
(2 .21)

for 0 < /t,p < P --1, where Skp{z) is th e polyphase com ponent of Hk{z)Fp{z). By defining

x{n) and x { n) xp-i{n) Eq. (2.21) can be expressed m ore com pactly as .Âr(z) = g (z )A :(z ).

( 2 .22 )

(2.23)

(2.24)

i.e., the transm ultiplexor is an linear tim e-invariant (LTI) system w ith transfer m a trix S'(z). T he system is free from cross talk if and only if S { z ) is a diagonal constant m atrix. W ith o u t loss of generality, th e sufficient condition for a P R transm ultiplexer can be defined as g (z ) = f . (2.25)

R ep ro d u ced with p erm issio n of th e cop yright ow n er. Further reproduction prohibited w ithout p erm issio n .

17

x,(n)-

-I

y(")
TDM

-1
TDM Synthesis bank FDM Analysis bank

(a)
\p / i 'd z~' k h \p

z~' x, (n)-- \p Z-' z-> L /

-V;
x,,{n)x,{n)-

\p

\p

x,,_^(n)Xp_i(n)-

A -,, J n )

F ig u r e 2.11: (a) Equivalent structures for the transmultiplexer using polyphase matrices, (b) rearrangement using noble identities, (c) simplified structure.

T h e relation betw een m axim ally decim ated P R filter b an k and m axim ally decim ated P R transm ultiplexer is sum m arized in the following. By using the polyphase decom posi tio n for th e transniultiplexer shown in Fig. 2.10, th e resulting eequivalent transniultiplexer circuit is shown in Fig. 2.11(a) and can be further simplified into the equivalent form shown in Fig. 2.11 (c). It ic, therefore, clear th a t the transfer m a trix S { z ) can b e expressed as
( 2 . 26 )

w here

F(z) =

0

1

0

(2.27)

T h e sufficient condition for a P R transniultiplexer can th e n expressed wdth th e transfer function of a QM F as g (z ) = 7 4#. Æ 7(z)r(z)B(z) = 7 < = > B (z ).B (z ) = T -X z ).
( 2 . 28 )

R ep ro d u ced with p erm issio n of th e cop yright ow n er. Further reproduction prohibited w ithout p erm issio n .

18

S u b stitu tin g for r ( z ) , this becomes Q{ z ) = R { z ) E { z ) = 0 2-1 Ip-i 0 (2.29)

which is th e sufficient and necessary condition for a Q M F to have P R property which is described in section 2.1.3. Therefore, we can sum m arize th e above results as follows: If Hp{z) and Fp{z), p = 0,1, · · , P -- 1, are the analysis and synthesis filters in a m axim ally decim ated QM F bank satisfying th e P R condition of Ecp (2.29), th en the transm ultiplexer, w ith synthesis bank Fp{z), p = 0,1, · ·, P --1 and analysis bank Hp{z), p = 0,1, - - -, P --1, is a P R transniultiplexer.

2 .3

Sum m ary

In this chapter, th e fundam entals of digital filter banks and filter bank based transm ul tiplexers are sum m arized as presented in [10, 26, 28]. T he operations of the decim ator and interpolator are introduced. T he functions of th e analysis filter and synthesis filters are described. T he polyphase presentation of a filter ba,nk and th e sufficient and neces sary condition for a filter b an k to be P R are presented. The TD M and FDM functions perform ed by a filter bank oased transm ultiplexer is d em onstrated and the relationship betw een th e P R filter bank and th e P R transniultiplexer is derived. In th e next chapter, th e fundam entals of an O FD M system will be presented on th e basis of th e filter bank theory introduced in this chapter.

R ep ro d u ced with p erm ission of th e copyright ow n er. Further reproduction prohibited without p erm ission .

C h ap ter 3 O rth o g o n a l F req u en cy D iv isio n M u ltip le x in g (O F D M ) S y ste m s

A

S one of the m ost im p o rtan t classes of MCM, OFDM is a m odulation scheme th a t allows digital d a ta to be efficiently and reliably tran sm itted over a radio channel, An OFDM system tran sm its d a ta by using a large

even in m u ltipath environm ents.

num ber of narrow bandw idth sub carriers, which are chosen in such a way th a t they do not interfere w ith each other. T he nam e `O FD M ' is derived from th e fact th a t th e digital d a ta is sent using m any subcarriers, each of a different frequency (FDM ) and these subcarriers are orthogonal to each other, hence orthogonal frequency division m ultiplexing [29]. T h e origins of the OFDM m odulation started in th e late 1960's. In 1971 W einstein [11] introduced th e idea of using a D FT -based filter bank for im plem entation of the generation and reception of OFDM signals. In 1990's, the D W M T m odulation was proposed as an alternative of th e D FT -based OFDM m odulation [13]. The O FD M m odulation has been adopted in m any standards of current and future wireline and wireless applications, such as asym m etric digital subscirber line (ADSL), European digital audio broadcasting (DAB), E uropean digital video broadcasting(D V B ), short-range wireless access and wireless LAN stan d ard s (IEEE802.11a). In this chapter, th e basic principles of OFDM systems are introduced. Section 3.1 presents th e d a ta generation and m odulation in OFDM m odulation, characteristics of O FD M filter bank m odulator and dem odulator, and orthogonality of subchannels in

19

R ep ro d u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited w ithout p erm issio n .

20

OFDM system s are presented.

Section 3.2 explains two im portant realizations of the

OFDM m odulation, the D FT-based OFDM system and the DW M T system and th e prop erties of b o th systems. Section 3.3 summarizes this chapter.

3 .1
3 .1 .1

B a s ic P r in c ip le s o f O F D M
D a t a G e n e r a tio n a n d M o d u la tio n
Transmitter

V q (n) Data in
Data Parsing Constellation Encoding Filter Bank Modulator RF Modulation

Channel

Data Data oiit Deparsin,

Constellation Symbol Decision

Filter Bank Demodulator

RF Demodulation Receiver

F ig u re 3.1: The block diagram for an OFDM transceiver Fig. 3.1 shows a block-level diagram for an OFDM transceiver. T he operation of an OFDM transceiver is outlined as follows. Since the d a ta to be tran sm itted are typically in the form of a serial b it d a ta stream (as v{n) shown in Fig. 3.1), a d a ta parsing stage is needed to convert the input serial b it stream to the symbols to be tran sm itted over subchannels. Fig. 3.2 shows operation details of d a ta parsing [10]. As shown in Fig. 3.2, v{p) represents th e binary d a ta stream to be tran sm itted over a transm ission channel and it is divided into non-overlapping 6-bit segments, which are th e n p artitio n ed into P groups Uo(n),Ui(n), · · ,u p _ i(n ). T he group Vp{n) consists of bp bits, p = 0,1 , · · ·, P -- 1. The tim e interval between Vp{n) and Vp{n -f 1) is 6 tim es longer

R ep ro d u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without p erm ission .

bii I bt I b -> I bp I bi I by i bn i t> i i by b-h'n b lock
6 - b it block 6 - b it block

21
binary data v(n)

serial

6« bits 6, bits

v(n)

to parallel

vjn)

^2 bits

F ig u re 3.2: Data parsing function in an OFDM transceiver. The number of subchannels P = 3. Sign represents single binary symbol

th a n th a t between v{n) and v ( n + 1). This longer symbol tim es provide b etter im m unity to im pulse noise. E ach binary d a ta group generated by the parsing stage, Vp{n), p -- 0,1, · , P -- I, are encoded separately using various discrete coding schemes. One of th e typical m odulation schemes in an OFDM system is the M PSK m odulation. The alphabet size (for example, BPSK or 16-PSK) of the m odulation scheme for a subchannel is chosen to be th e maximum th a t th e subchannel, on which the coded symbols are to be tran sm itted , can support w ith an acceptable symbol error rate. In an OFDM system, the channel is divided into a

num ber of narrow band subchannels. A subchannel which is affected by the narrow band interference can be identified easily, the alphabet size for th a t subchannel can be made small, or the use of the subchannel can be inhibited. T h e o u tp u t of the constellation encoding block, XQ{n), Xi {n), , Xp- j {n), are m odu lation symbols for the filter bank m odulator. In the OFDM transm ission, tim e is divided into continuous, non-overlapping frames, and during the frame n, P symbols, XQ{n),xi{n), · · ·, x p - i i p ) , w ith each one m odulated to one of P subchannels, are tran sm itted in paral lel. T h e o u tp u t of the filter bank m odulator, a serial d a ta stream of th e FDM format, is m odulated on a radio frequency (RF) carrier and tran sm itted through the transm ission channel. A t th e receiver end, filter bank dem odulator receives the composite d a ta stream and tim e-division multiplexes them into P parallel d a ta stream s. A fter all received sym-

R ep ro d u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without perm ission.

22 bols have been decoded, the parallel d a ta stream s are converted into the serial binary d a ta stream in an inversive way of parsing function a t the tran sm itter end. The com bination of the pair of the OFDM filter bank m odulator and dem odulator is referred as an OFDM transniultiplexer.

3 .1 .2

O F D M T r a n s n iu ltip le x e r

A n OFDM transniultiplexer is a transniultiplexer based on filter bank structure, which is introduced in section 2.2. Fig. 3.3 shows the block diagram of the OFDM m odulator and dem odulator, or the OFDM transniultiplexer, and th e coniniunication channel.

x,(ny

u,(n)

--

y ,{n)

Channel

s(n)
Modulator

r(n)
Demodulator

F igu re 3.3; The block diagram of an OFDM transniultiplexer

O p era tio n o f O F D M T ran sn iu ltip lex er The operation of an OFDM transm ultiplexer can be described as follows. T he outp u t of the m odulation filter of subchannel p, Fj,{z), Q < p < P -- 1, has the format (3.1) Fig. 3.4 dem onstrates how this construction is done in tim e dom ain for the 0-th filter
/o (n ),

which we assume to be a lowpass filter. Essentially one copy of th e impulse response

sequence /o(n) is draw n around every sample of .ro(n) (separated by K ) and all copies are summed up. If the length of
/o (n )

is not greater th a n A', there will be no overlap in uo{n).
{ 'U o (? 7 .),U i(n ), · · · , 'U p _ ] ( n ) } ,

O utputs from all m odulation filters,

are added up to form

the composite signal s(n) to be transm itted through th e transm ission channel. A t the receiver, th e filter bank dem odulator separates th e signal r(n ) into the com ponents yp(n),

R ep rod u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without perm ission.

Xf)(0)

23

F igu re 3.4: The construction of output of transmitting filters

which are distorted and noisy versions of th e symbols X'p('n), 0 < p < P -- 1- T he task at this point is to detect the symbols Xp{n) from yp{n) w ith acceptable error probability, thus the crucial issue in OFDM transm ission is to make t/p(n) resemble P r o p e r ty o f O F D M M o d u la tio n a n d D e m o d u la tio n F ilters In the ideal case, which means no distortion and noise in the channel, be perfectly retrieved from yp{n)y p -- 0 ,
Xp{n) Xp{n).

should

-- 1, therefore th e m odulation and

dem odulation filters should satisfy the P R property which is expressed in Eq. (2.25). This P R property can be alternatively expressed in time domain as; (3.2) where 0 < j h, P 2 < P -- 1, S{pi --p?) and 5{n) are the Kronecker functions. For OFDM systems, P subchannels are selected to be m utually orthogonal, which means they are m utually independent of each other, or m athem atically, the inner prod uct of each pair of subchannel impulse response sequences is zero. O rthogonality is the essential property of an OFDM system since it allows multiple inform ation signals to be tran sm itted over a common channel and each signal can be detected w ith a negligi bly sm all am ount of interference from the other signals, if the channel distortion is mild com pared to th e bandw idth of a subchannel. The orthogonality betrveen each pair of subchannels can be expressed in tim e dom ain as (3.3) where 0 < P i,P 2 < P -- 1-

R ep rod uced with p erm ission of the copyright ow ner. Further reproduction prohibited without perm ission.

24 The equivalent expression of Eq. (3.3) in frequency dom ain can be w ritten as

T i%

( T

)

=

(=4 ^ j j
I

Eq. (3.3) also guarantees th a t each m odulation filter, fp{n), p = 0,1, · · ·, P -- 1, has un it energy. W hen all subchannels are m utually orthogonal as expressed in w ith Eq. (3.3), the PR can be fulfilled by making the relation between th e m odulation and dem odulation filters as ftp(0 = / ; ( - ( ) .
where 0 < p < P -- 1. From Eq. (3.5), it can be concluded that when m odulation filters are m utually orthogonal and have unit energy, i.e., modulation filters are orthonomal, the dem odulation filters are orthonormal as well.

(3.5)

j
j |

i

Fading channels, which are m ultipath and frequency selective, always destroy the orthogonality of subchannels. As a consec|uence, the received subchannel symbols % (n), 0 < p < P -- 1 are distorted by b o th 181 and IC I introduced by the fading channel. [ [

f
3 .2 D F T -B a se d O F D M a n d D W M T

1
1
{

The DFT-based OFDM system and the DWMT system are two important realizations of OFDM systems. The former is the most w^ell known OFDM system and it has been thoroughly investigated in [5, 6, S, 29, 30].

3 .2 .1

D F T -b ase d O F D M

T he idea of using the inverse D FT (IDFT) and D FT transform s for the generation and reception of OFDM signals was proposed by W einstein and E bert several decades ago [11]. This approach présentes an opi^ortunity for an easy im plem entation of OFDM , especially w ith the use of Fast Fourier Transform (FFT ), which is an efficient im plem entation of D FT. T he ID FT and D FT transform s can be im plem ented w ith an ID F T filter bank and a D FT filter bank, respectively [8, 14].

R ep rod uced with p erm ission of th e copyright ow ner. Further reproduction prohibited without perm ission.

25 T he construction of ID F T filter bank can be divided into two steps. Firstly th e low pass m odulation filter is chosen as a P-long rectangular pulse (3.6)

Otherwise,

and th en the other P --1 m odulation filters are obtained by ro tatin g th e low pass filter as (3.7) where cU p = 2'Kp/P. We can see th a t, the frequency response of th e P --1 band pass trans m itting filters {Pi(e-^` ^}, Po(e-^` ^), · ·, Pp-iXe-^^^)} are obtained by shifting th e frequency response of the low pass filter Po(e-'^), i.e. (3.8) and all filters
{ /o (n ),

/i(ra), · · , /p_i('u)} are of same length L = P.

T he OFDM m odulation w ith filters defined in Eqs. (3.6) and (3.7) can also be described with m atrix operations. Denoting th e ID FT m atrix $ as

$

/o(0) A (0)
FxP

/o(l) A (1) fp -i(l)
To(7l) z i(n ) xp_i{n)

f o { P -- 1)

(3.9) /p _ i(P -l) J

. /p -i(O )
and vector X as

(3.10)

the o u tp u t of the ID FT filter bank m odulator, which is denoted as U -- [uo{n),Ui{n), · · ·, up_] (n)]^, can be obtained by (3.11) T h e orthogonorm ality of the ID F T filter bank follows th e fact th a t th e ID F T m atrix $ is unitary, i.e., -- J, where I is the identity m atrix. Eq. (3.5) holds to make the

filter b an k m odulator and dem odulator fulfill the PR. property.

R ep rod uced with p erm ission of th e copyright ow ner. Further reproduction prohibited without p erm ission.

26 111 a D FT-based OFDM system , a subchannel has significant spectral overlap w ith a large num ber of its neighboring subchannels. Fig. 3.5 shows th e fi'equency responses for the subchannels, which occupying frequency range [0,0.14], of a D FT-based OFDM system w ith P = 32 subchannels. It shows th a t the first sidelobe is as high as --13 dB. T he intensive spectral overlaps of adjacent subchannels in D FT -based OFDM systems indicate the subchannel isolation can only be retained for channels which have virtually no distortion.

<

-5 0

A n g u lar F re q u e n c y

F igu re 3.5; Subchannel frequency responses of DFT-based OFDM system for u >  [0,0.88] and F = 32

To com pensate for the high degree of spectral overlaps, a technique in which a 'cyclic prefix' (C P) being inserted a t the beginning of each transm ission block, which consisting of P symbols, was proposed. The CP can be the trailing zeroes (a null signal), which is referred as the zero-padded CP, or a p art of the signal block as shown in Fig. 3.6. At th e receiver end, the CP is discarded to avoid interblock interference and each tru n cated block is dem odulated w ith a D F T filter bank. W ith th e inclusion of the CP, the following rule holds: If the channel impulse response is shorter th a n th e length of the CP, Lf., th e subchannel isolation is achieved [30]. However, for fixed symbol alphabet sizes, the inclusion of the CP reduces th e transm ission rate by the fraction of P / { P + Lk) [13]. Theoretically, the inclusion and removal of zero-padded cyclic prefix can be accom-

R ep rod u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without p erm ission .

27

P

P+L,
F igu re 3.6: The stylized plot of CP inclusion. The Ik long CP can also be the trailing zeroes.

plislied by choosing upsam pling/dow nsam pling factor as K -- L filters in Fig. 3.3 as '13]
0, (.G H ),

Lk and m odulation

_ p + i< z < o .

'

D FT -based OFDM systems w ith C P is implem ented as schem atically shown in Fig. 3.7.

C on stellation E n cod in g

Parallel Add CP. Serial

C hannel

C on stellation S y m b o l D e c isio n

Serial Parallel

R em ove CP.

F igu re 3.7: The schematic diagram of a DFT-based OFDM system

3 .2 .2

D is c r e te W a v e le t M u lt ito n e S y s te m s

T he DW M T, or the overlapped discrete m ultitone, is an alternative form of OFDM tran s mission and it is proposed recently by Sandberg [13]. A DM^MT system incorporates careful pulse design to achieve a high level of subchannel spectral containm ent, w ithout sacrificing the P R property of th e set of subchannels. The advantages introduced by the spectral containm ent properties of DW M T subchannels are th a t, th e D W M T system is b e tte r able th a n the D FT -based O FD M system to am eliorate th e effects of narrow band

R ep rod u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without perm ission.

28 interference and narrow b an d channel noise [2, 13], and do no t need C P to separate tran s m itted d a ta blocks for b e tte r error perform ance w ith com promised system efficiency. In a DW M T system, upsam pling/dow nsam pling factor K = P. In D W M T systems, m odulation filters are a set of real-valued cosine m odulated filters which are generated from a prototype low pass filter w{n) w ith th e extended lapped transform s (ELT) [15, 31, 32, 33]. /p(n) = 'm ( T i ) ^ c o s (p + ^ ) ( ^ +

There are two constrains for w{n). Firstly the m odulation filters generated w ith Eq. (3.13) should be m utually orthogonal, secondly the m odulation filters and dem odulation filters constructed w ith Eq. (3.5) should satisfy the P R property to make the system a P R system. U nder these two constraints, tu(n) m ust fulfill the rec|uirement expressed as [15], [33]): O O w{n -- m P ) w { n + n P + 2rP) = S{r),
î n = --C O

(3.14)

i.e., as long as w(n) satisfies Eq. (3.14), th e filters generated w ith Eqs. (3.13) and (3.5) can be employed respectively as m odulation and dem odulation filters of a D W M T system. It is shown th a t even w ith the enforcement of the P R condition in Eq. (3.14), there are enough degrees of freedom in choosing the lengths of m odulation filters, and there are flexible com binations of transition w idth and stopband a tten u atio n for subchannels. Usually ha D W M T systems, th e length of w (n), T, is chosen to be L = gP, g > 2 is the overlapping factor. In the DW M T transm ission, each symbol in th e g frames, ^ j j

n , n -- l , ..., n ~ g + 1, contributes to the d a ta segment th a t is tran sm itted during fram e n. Since there are more th a n one choice of w{n) for each specific g, the one w ith th e biggest m ainlobe energy is usually chosen for the D W M T system . A good choice of w{n) for g = 2 is [32]: T T f 1 w{n) = sin L 2pr+2 (3.15) ( (

T he frequency responses of several subchannels, which are constructed w ith prototype filter w( n) defined in Eqs. (3.15) and (3.13), are shown in Fig. 3.8 for a D W M T system

R eo r o d u ce d with p erm ission of th e copyright ow n er. Further reproduction prohibited w ithout p erm ission .

29
-1 0

-2 0

-30

< D -50

-6 0

-70

-9 0

0,1

0.2

0.3

0.4

0.5

0.7

A ngular F requency

F ig u re 3.8: Frequency responses of a DWMT system for w E [0,0.88] and P = 32 w ith P = 32 subchannels. From Fig. 3.8 we can see th a t the first side lobe of subchannels in th e D W M T system is about 25 dB down from the m ain lobe an d each subchannel occupies ju st th e half th e bandw idth which is occupied by th e subchannels in th e D FT based OFDM w ith sam e num ber subchannels, as shown in Fig. 3.5. G enerally for a

D W M T system , w ith g getting larger, higher spectral concentration and tig h t subchannel spectral containm ent can be obtained.

3 .3

Sum m ary

In th is chapter, the fundam entals of a generic OFDM system are presented. The d a ta generation and m odulation in an O FD M system, the th e m utual orthogonality of sub channels and the properties of m odulation filters and dem odulation filters of an OFDM system are introduced. T he effect of fading channels on an OFDM system is explained. T he properties and im plem entations of two special OFDM system s, nam ely D FT -based O FD M and D W M T system s, are presented as well.

R ep ro d u ced with p erm ission o f th e cop yright ow ner. Further reproduction prohibited w ithout p erm issio n .

C h a p ter 4 S y m b o l Error R a te E v a lu a tio n and F ilte r B a n k D e sig n for O F D M S y ste m s w ith M P S K M o d u la tio n

subchannel is distorted by not only th e channel noise, b u t IC I and ISI. T he existence of the lazge am ount of interference makes it difficult to theoretically evaluate th e error perform ance of an OFDM system . R ecently some attem p ts have been m ade to investigate th e error perform ance of the D FT -based OFDM system s based on certain assum ptions and b ounds [6, 17, 18, 19, 20, 21, 34]. However, the error perform ance of a generic

A

S explained in cliapter 3, th e orthogonality among subchannels of an OFDM system is often destroyed by fading channels. As a result, th e received signal of each

O FDM system , which fulfills b o th th e perfect reconstruction (PR ) an d th e orthogonality properties, as expressed in Eqs. (3.2) and (3.3) respectively, has not been system atically studied. In th is chapter, the error perform ance of a generic O FD M system , w ith th e D FT -based O FDM system and the D W M T system as two realizations, is stu d ied by considering the effects of b o th ISI, IC I and the additive channel noise. By investigating th e expressions of a received sym bol and interference involved in the received sym bol to b e decoded, and m odelling the sum of ISI and IC I as a G aussian random process, th e probability density function (P D F ) of the received symbol is derived. A closed-form sym bol error ra te (SER) expression is form ulated for an O FD M system w ith M PSK m odulation and th e optim al 30

R ep ro d u ced with p erm issio n of th e copyright ow n er. Further reproduction prohibited w ithout p erm issio n .

31

phase detector for each of the subchannels.

N um erical M onte-Carlo sim ulations have

been perform ed to verify th e derived SER form ula and sim ulation results dem onstrate the consistency w ith th e theoretical analysis, for b o th th e D F T based O FD M systems and th e conventional D W M T systems. T h e derived SER form ula can be used to evaluate b o th th e D F T -based O FD M system s, no m a tte r w ith or w ithout CP, and the D W M T systems. It can also be employed as a criterion to design an O FD M system to obtain satisfactory error perform ance. By using this form ula as the objective function, a novel OFDM system based on designed complexvalued u n ita ry filter banks is presented in order to improve th e error perform ance. Unlike to filters w ith real-valued, complex-valued filters have asym m etric frequency responses and are more suitable to deal w ith complex-valued signals which are often present in a wireless system . T he filters of th e designed u nitary filter banks are inherently orthogonal. By param eterizing th e coefficient of th e complex-valued u n itary filter banks w ith free param eters, it is possible to ad ju st the OFDM system for various design criterions. In this chapter, th e derived SER form ula is taken as the objective function, the com plex valued filter banks are designed to minimize the SER. Sim ulation results show th a t the new O FD M system based on designed filter banks outperform s th e D W M T system in term s of SER, and its S E R perform ance is com parable to th a t of th e D FT -based OFDM system w ith CP, which is less efficient in term s of transm ission rate. T h e rem ainder of th is chapter is organized as follows: In Section 4.1, a closed-form SE R form ula for a generic O FD M m odulated w ith M PSK scheme is derived and its perform ance over AW GN channels and fading channels is investigated. In Section 4.2, a novel O FD M system based on complex-valued u n itary filter banks, w hich can be adjusted to different design criterions, is presented. System sim ulations are described in Section 4.3 to verify th e theoretical analysis ab o u t the SE R perform ance, and to d em onstrate th e SE R perform ance of designed O FDM systems. Section 4.4 sum m arizes th is chapter.

R ep ro d u ced with p erm issio n of th e cop yright ow n er. Further reproduction prohibited w ithout p erm issio n .

4 .1

S y m b o l E r r o r R a t e E v a lu a tio n for O F D M S y s  t e m s w it h M P S K M o d u la t io n
S y s te m M o d e llin g

32

4 .1 .1

p-i

s(n)

r(n)

p-/

F ig u re 4.1: Block diagram for filter bank modulator and demodulator in OFDM systems The filter bank based m odulator and dem odulator, w ith P subchannels, of a generic OFDM system are illustrated in Fig. 4.1. T he m odulation and dem odulation filters of sub cha n n el p, 0 < p < F -- 1, are denoted respectively as /p and hp, which are of length L = g K , where g is th e overlapping factor, and K is th e upsam pling/dow nsam pling factor. T he m odulation filters fp, 0 < p < P -- 1, fulfill the orthogonality property (Section 3.1.2), i.e., for 0 < p i , p 2 < F -- 1 L-l (4.1) Moreover, the m odulation and dem odulation filters satisfy the PR property defined as
L -l

z=o

= W (^ (p i - % ) -

(4.2)

B oth D F T -based OFDM and D W hlT system s are special cases of a generic OFDM system. For D F T -based OFDM , th e low pass m odulation filter is chosen as (section 3.2.1) /o (0 = I TTP: 0 < / < L -- 1, ^ otherwise " (4.3)

T hen th e other F -- 1 m odulation filters are obtained by ro tatin g the low pass filter to /p(Z) = (4.4)

R ep ro d u ced with p erm ission of th e cop yright ow n er. Further reproduction prohibited without p erm ission .

33 where cO p = 2'Kp/P, p -- 1, - , P --1. T he inclusion of zero-padded CP can be im plem ented by choosing th e upsam pling/dow nsam pling factor K = P + Lk, where is th e length of

the C P and it is no shorter tha,n th e length of th e transm ission channel c{n). D em odulation filters are generated as follows to remove th e CP th a t is a,^ded a t the tra n sm itte r end

For D FT -based OFDM , th e overlapping factor g = 1. T he length of filters for a D FTbased OFDM system w ith CP is L = P + L^. For a conventional real-valued cosine m odulated filter b an k based D W M T system, K = P and m odulation filters are generated as (section 3.2.2) fp{l) -- w { l ) ^ c o s 4----- ---- ) p '

for p = 0,1, · · ·, P -- 1, and w{l) is th e impulse response of a low-pass filter, which is of length L = gP, g > 2. T h e dem odulation filters of a D W M T system can be obtained by hp{l) = fp{--l)-, --L -h 1 < Z < 0. (4.7)

T h e transm ission channel c{n) is modelled as a linear tim e invariant (LTI) F IR (finite impulse response) filter^of length Lc, followed by a statio n ary zero-mean random Gaussian noise source e(n), which is independent of tran sm itted symbols {xp{n), p = 0,1, · · ·, P --1}. For an OFDM system w ith M PSK m odulation scheme, abbreviated as an M PSKO FDM system, a conventional optim al phase detector is employed for each subchannel to calculate the phase of each received symbol and decode the received symbol w ith preset phase boundaries. T he SE R for a generic M PSK -O FD M system is derived in th e following.

4 .1 .2

S y m b o l E r r o r R a t e fo r G e n e r ic M P S K - O F D M S y s te m s

In O FD M systems, a t each tim e fram e n i, P parallel symbols {^o(w )i ^'i('/^i), - " , x p - i { n i ) } are tran sm itted , w ith each symbol m odulated to one of th e P subchannels. T he transm it^c(n) can be considered as the overall transfer function resulting from the real communication channel and a time domain equalizer (TEQ), which precedes the filter bank demodulator in cases where a TEQ is employed.

R ep rod u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without p erm issio n .

34 ted subchannel symbol in subchannel pi at frame n i, x.p^{ni), represents as well constel lation points generated by a m odulation scheme such as M PSK. C orresponding to each tra n sm itte d constellation point, there is a received symbol (n i -pd), where d is

th e system dælay. If only the delay involved in th e convolution w ith th e m odulation filter and dem odulation filter, b oth of length L = g K, is considered, th en d = g. The following form ulation gives the expression of yp^{ni + d). F o rm u la tio n 1: In an OFDM system shown in Fig. 4.1, assum e th e channel impulse response is c(n), n = 0,1, - - -, Tc --1, and the zero-mean addictive G aussian random noise is e{n). T hen, for a given subchannel p i, th e received symbol + d), corresponding

to the sym bol Xp^{n\) which tran sm itted at tim e frame ni, can be expressed as:
Vvi

(^1 + d) = ÿpj + Ç+ C l

(4-8)
channel

where

is the contribution

from symbol Xpj(ni), C is the contribution from

noise, and C isthe interference calculated by summing up

all ICI and ISIitems. Note which can be expressed

th a t Xp^{n.i) is th e only transm itted symbol contributing to as follows % /pi = C can be calculated as
CO

(4 9)

Z)
n = -- OO

(4.10)

and C can be calcinated as
OO

P --1

OO

C=

/%
n=-- oop5épj,p=ü

(?2).'Cp(7T.)-|n ^ n -i,n ----oo

Q -' pjp,, (n)xpj (n).

(4.11)

In Eqs. (4.9) and (4.11), Upp^(n), for 0 < p. pi < P -- 1, is the weight of th e contribution from the tran sm itted symbol Xp{n) to the received symbol as: (ni + d ) , and it is calculated

Ijc-- 1 Ij-- 1 a.ppi (^) = Z ) c(j) ZZ /p(0''ipi[(^i - n ) K - j -I]-, i=o 1=0

(4.12)

where Lc is the length of the channel c(n).

R ep ro d u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without p erm ission .

35 Proof: As shown in Fig. 4.1, the composite da,ta sequence to be tran sm itted over channel, s{n), is th e sum of th e o u tp u t signals of all m odulation filters, i.e.
P-- 1
OO

(4.13) p=Q i ~ --oo At th e receiving end, the received signal r(?z) is distorted by channel noise and interference due to the non-ideal channel. r{n) can be expressed as;
OO

r(??) = s{n) * c{n) + e(n) = where

^
k ----oo

s{k)c{v -- k) + e(n),

(4.14)

represents the convolution. As indicated in Fig. 4.1, r(n ) is passed to the filter , P --1, and the o u tp u t of each subchannel dem odulation

bank dem odulator hp, p = 0,1,

filter is downsampled by factor I P The received symbol for the subchannel pi a t time frame n-i can be expressed as:
OO

("1 + d) =
7n=~oo

r(jn)hpYniK - m ) , .

(4.15)

By su b stituting Eqs. (4.13), (4.14) into (4.15),
P-- 1
OO OO OO

%i(7ii + d)

= +

^
OO

^ YZ

Zp(n) ^

^

y p (/G -n A :)c(m .-A ;)/ip .(M iA :-m ) (4.16)

p = 0 n = --OO

r n = --OO k= --oo

G{m)hp^{n.iK -- m).

m ~ --co

Let j =^m -- k and I = k -- n K , Eq. (4.16) becomes
P --1
OO

-Lq--1

L --1

%i(Mi + d) = ^

Y!

Ê
j= 0

H
1=0

- ; - 0 + ^-

(4.17)

p--Q n = --ca

where ^ is defined in Eq. (4.10). By defining app^{n) and Ç as in Eqs. (4.12) and (4.11) respectively, Eq. (4.17) can be reduced to Eq. (4.8). F o r m u la tio n 1 is proven. R e m a rk s : W hen th e filter bank based m odulator/ dem odulator an d th e communica,tion channel are all linear and tim e invariant, the term ÿp^ in Eq. (4.8) is determ inistic for a given tran sm itted symbol (^i)- According to Eq. (4.9), ÿp^ is a weighted version

of 3ipj(ni) and th e weight a-p^pi (n,i) is a constant for a given subchannel pi. Therefore in

R ep rod u ced with p erm ission o f the copyright ow ner. Further reproduction prohibited without perm ission.

36

general, the constellation points of Zp, ('n j and

are a one-to-one m apping. For each which can

constellation point of Zp, (Mi), there is a corresponding constellation point be calculated by Eq. (4.9). All the possible values of

form the set of constellation

points a t the receiving end of subchannel p\. T he noise item ^ and interference item C , are both random processes. The following theorem derives a closed-form SER formula for M PSK m odulation by calculating the PD F of yp^{n\ d) and setting the detection boundaries for the optim al

phase detector of each subchannel. T h e o re m 1; W hen the transm itted symbols,
Xp{n),0

< p < P -- 1, are coded by

th e M PSK scheme w ith symbol energy Eg. and an optim al phase detector is adopted for each subchannel, the SER of the received symbol ypi{ni 4- d), which corresponds to the tran sm itted symbol Xp^{rii), can be determ ined as: 7sin^(7r/Af) dÿ, sin" {(I)) where: (4.18)

is the signal to noise and interference ratio (SNIR),

is th e variance of zero m ean

addictive Gaussian random noise e(n) and app^(n) is defined in Eq. (4.12). Proof-. In the M PSK coding scheme, the tran sm itted symbols Zp(n) is coded as : Zp(n) = A . = 0,1, · ·, M - 1, (4.20)

where 6k is the tran sm itted phase and takes one of the values from th e set {(2?r/c)/Af}. Due to th e fact th a t the coefficients of m odulator/ dem odulator and channel can be complex valued, ypi(ni 4- d) m ay be complex-valued as well. We denote the real and Imaginary p a rts of yp^ (ni + d) as a and b. To get the expression for the SER of (ni 4- d), the joint P D F 6) m ust be (rii 4- d).

form ulated. In the following, we first derive the characteristic function of

R ep rod u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without p erm ission .

37 Since e(n) is a zero m ean G aussian random process, it is easy to see from Eq. (4.10) th a t ^ is a Gaussian random process w ith zero mean and variance 0-Ç = cr,j. (4.21)

From Eq. (4.11), the interference C is the weighted sum of identical independent dis tributed (iid) random variables, x'p(n), each w ith mean Hx and variance cr^. According to the C entral Lim it Theorem [35], ( approaches a Gaussian random process as the quantity QÎ Xy(n), which is m ainly dom inated by P, gets large. Moreover, the m ean and variance of C can be calculated as: F'Ç ~ XI " ()^)A'[2 'p(n)] -F y~) a' p,p, n,n^n\ (n)], (4.22)

X] XZkppiWI^^(ir[%p(n)]+ ^
ViVrV\ " n .n ^ n i

|&pipi(7T)|^yor[a:p,(n)],

(4.23)

where FI)-], V'ar[-] and | · | denote the expected value, the variance and th e absolute value, respectively. W ith o u t loss of generality, assume

E[Tp(n)] = 0.
From Eq. (4.20),

(4.24)

yor[zp(a)] = Gi,

(4.25)

for p = 0,1, · · · , P -- 1. T hen the m ean and variance of Gaussian random variable C can be obtained as: A ''C -- 0, C T çXZ X Z l^ p p iW I^+ XZ
|2
P IP I

(4.26) , 6T, (4.27)

Since the noise ^ and the interference ( are independent to each other, the received sym bol (ni -f- d) is a G aussian random variable w ith m ean ÿp^ and variance cT y = cr| -t- aç. (4.28)

R ep rod uced with p erm ission of th e copyright ow ner. Further reproduction prohibited without perm ission.

38 Using Eqs. (4.21) and (4.27), we get
Ê .7 .*·

(4.29)

T he characteristic function of

('/?,] + d) can be expressed as; $i,(u) = exp(;-ÿp, ^ ). (4.30) (ui +

T he joint P D F of a and b can then be obtained w ith the characteristic function of

d) as:
2

,ra 2

exp

[a - i?.e(yp, )]^ + [b - /m(%/p, )Y 2 cr2

(4.31)

where Re{-) and Im{-) represent the real and imaginary p arts of a complex-valued, respecti'i'-ely. W ith th e change of variables from (a, fa) to {V, Qy), which are defined as y - V a 2 + fa'^, and Qy = tan ^ a (4.33) (4.32)

th e PD F of the detected phase Qy can be obtained by

fve{V, Qy)
where Since = tan""^[

V

exp

+ 1 % /p i I " - 2 y___ml IW p , I c o s ( 0 ^ X

)

(4.34)

is the phase of the output constellation point fpi '

(«i -f d) is a Gaussian random process, the optim al phase detector based on

th e m axim um likelihood (ML) detection criterion can be employed to perform detection for subchannel p ]. The operation principle of the optim al phase detector is to com pute th e phase of (uj +d) and select th e constellation point, from th e constellation set of pp,, (rq -f d). T hen th e tran sm itted symbol

w ith the sm allest phase difference relative to

is determ ined from the one-to-one m apping relation between the constellation points of .Epj(ni) an d T he decision boundaries for (rq -t-d) can be determ ined based on the

R ep rod u ced with perm ission of th e copyright ow ner. Further reproduction prohibited without p erm ission .

39

constellation points of

According to Bq. (4.9), ÿp^ is a scaled version of Xp^{n.i) and

the weight a'p^(ni) is a constant for a given subchannel, i.e. the phase difference between the constellation points of ÿp^ is same as th a t of transm itted symbol Xp^(ni). Therefore the phase difference of any two adjacent constellation points of is 2-ïïjM. W ithout loss

of generality, we assume the phase of the tran sm itted symbol Xp^{nj) is 0. In this case, no decision error will happen if the phase of denoted as (rij + d) falls inside th e range A, which is

To calculate the SER, th e integration range of the variable V in Eq. (4.34) is [0, +oo), which is com putationally complex. In the following, we convert th e integration over the infinite range into a integration over a finite range. The variable (R, 0 y) in Eq. (4.34) are replaced with {r.-ipy)-, which are defined as follows:
r = v'r= + 2 V 'c o s ( 0 ,, -« j^ ,)|s ,, |+ ||/,, .P ,

(4.36) (4.37)

-- tan ^ Then the PD F of (r, 'ipy) is

Ksin(e,
V
COS{Q y ) + 1%/p, I

U , (r.

exp

j .

(4.38)

Please refer to the A ppendix B for the details of Eqs. (4.36)-(4.38). According to [36, 37, 38, 39], the SER can be calculated as
(Af --1)7T A/ /oo

Jo where R = where -y =

' Jr

(4.39)

, and the expression of SER can be simplified as in Eq. (4.18),

O ' :,

(4/10)

By su b stituting Eqs. (4.9) and (4.29) into Eq. (4.40), we get Eq. (4.19). Thus T h e o r e m
1

is proved.

R ep rod u ced with perm ission of th e copyright ow ner. Further reproduction prohibited without perm ission.

40 The overall SER for a M PSK-OFDM system, Pg, can be obtained by averaging Pe,pi over all P subchannels, (4-41)
P \= 0

4 .1 .3

S E R E x p r e s s io n fo r A W G N C h a n n e ls

For an AWGN channel or a channel which is perfectly equalized, expression of SER for a generic MPSK-OFDAf system can be simplified on the basis of Eq. (4.19). For an AWGN channel, c{n) = 5{n). It can be seen from Eq. (4.2) th a t

1

.e., the only symbol which has nonzero contribution to
7

(??i + d) is Xp^{ni). Since

C T " = cj,,, the SNIR

in Eq. (4.19) becomes

7 = P = % ,
which is th e signal-to-noise ratio (SNR). From Eq. (4.41) the overall SER, Pe is Pe = Pe,px 

(4.43)

(4.44)

By substituting Eq. (4.42) into Eq. (4.18), we get the SER for a M PSK-OFDM system, which is identical to the SER form ula for a single carrier M PSK system over AWGN channels. W ith the increase of SNR, the SER will decrease ciuickly. It can also be

seen from Eq. (4.44) th a t for a,n AWGN channel, the num ber of subchannels, P , has no effect on th e system error perform ance. Fig. 4.2 shows th e SER results for b o th single carrier m odulation and the convetional DW M T m odulation, w ith different num bers of subchannels, over an AWGN channel. The m odulation scheme adopted is binary phase shift keying (BPSK).

R ep rod u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without p erm ission .

41
10

s
CO

10

'

O -h --
10

D W M T: N = 32 D W M T: N =8 S in g le c a rrie r

12

S N R (d S )

F ig u re 4.2: Error performance of single carrier modulation and the conventional DWMT {g = 2) modulation with BPSK

4 .1 .4

S E R E x p r e s s io n fo r F a d in g C h a n n e ls
7

To investigate the perform ance of OFDM systems over fading channels, we rew rite Eq. (4.19) in an alternative expression as

in

(4.45)
It can be seen from Eq. (4.45) th a t when SNR p is much larger th a n 1 (OdB), Pe,p-^ is dom inated by the ratio of weights for the desired symbol and the interference, which can be approxim ated as ^
E n ( ^ ') I T E n .n ^ n i l^ 'p iP i(^ )l

(4.46)

In th is case, th e SER perform ance will not change much w ith th e increase of SNR p. Fig. 4.3 shows the error perform ance of a DW M T system, w ith overlapping factor p = 2, over a sample fading channel. For D FT -based OFDM system s, from Eq. (4.12), th e inclusion of zero-padded C P does not change the value of num erator in Eq. (4.46), b u t th e value of th e denom inator will decrease because of th e increase of th e upsam pling/dow nsam pling factor K . Therefore,

R ep ro d u ced with p erm ission o f th e copyright ow ner. Further reproduction prohibited w ithout perm ission.

42
10

'

P=64 P=32 P=8

az
CO
LLl

10

15

20

25

S N R (d B )

F igu re 4.3: Error performance of the conventional DWMT systems {g = 2) over channel c(n) = [1 , 0 .2 eJ^/=, 0 . 1 ].

D FT -based OFDM systems w ith CP will dem onstrate superior error perform ance th an D FT -based OFDM systems w ithout CP. Expressions of (4.18) and (4.41) provide a system atic approach to calculate th e SER of a generic M PSK-OFDM system, which fulfills th e orthogonality and P R conditions in Eqs. (4.1) and (4.2). Moreover, the SER formula can be used as th e objective function in th e design of m odulation and dem odulation filter banks for an OFDM system to achieve b e tte r error performance. In the following, a novel OFDM system, based on complexvalued u n itary filter banks designed to minimize SER, is presented.

4 .2

C o m p le x -V a lu e d U n it a r y F ilte r B a n k B a s e d O F D M S y s t e m D e s ig n

U nitary filter banks are a special class of maximally decim ated (P = K ) P R filter banks. A u n itary filter bank is a good candidate to th e m od u lato r/d em o d u lato r for an OFDM system because the inherent m utual orthogonality among its filters. U nitary filter banks w ith F IR filters have m any useful properties. Among these properties are th a t they

R ep rod u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without p erm issio n .

43 can be com pletely factorized, are easy to im plem ent w ith a lattice stru ctu re and have no questions of stability [26]. Moreover, they can be used to construct orthonorm al m ultiband wavelet bases, which are powerful tools for non-stationary signal analysis. Due to th e existence of complex-valued signals in wireless systems, complex-valued filters, which have asym m etric frequency responses, are proposed in this paper. T he com plex-valued filter bank is com pletely param eterized and th e coefficients of all filters are expressed w ith free param eters, which can be determ ined on basis of different applications. In this paper, the SER, expressed in (4.18) and (4.41) of an OFDM .system which employs M PSK coding scheme for all P subchannels, is talcen as the objective function to optim ize the perform ance of th e designed filter banks.

4 .2 .1

P a r a m e t e r i z a t i o n o f F i l t e r B a n k C o e ffic ie n ts

T he Householder factorization of th e polyphase com ponent m atrices of m odulation filters {fo, f i r , f p ~ i } can be sum m arized as follows [26, 40}. T he z-transform of filter fp, p=
0

, l , - - - , P -- 1 can be form ulated in th e polyphase form as:

F^{z) = y
A :-- 0 Define the polyphase com ponent m atrices F [ z ) as follows: ( f ( z ) ) , , t = Fp.k(z). If F { z ) is a u nitary m atrix, i.e. F ^ (z -^ )F (z ) = f , where I is the identity m atrix, th e n F { z ) has the Householder factorization {n [-f j F, is unit-norm H ouseholder

(4.47)

(4.48)

(4.49)

(4.50) param eters, and to various appli

wdiere J is the McMillan degree of F ( z ) , F is a PX P constant u n itary

m a trix which can be selected according

cations. As a special case, for filter banks associated w ith P b an d wavelet transform s.

R ep ro d u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without p erm issio n .

44 th e u n itary m atrix V m ay be generated by assigning one colum n as a co n stan t vector [^) ' which corresponds to th e scaling filter, th en adding orthogonal colum ns

to generate wavelet filter vectors [41], [42]. T he P --1 orthogonal colum ns m ay be produced / P - 1 \ via the G ram -Schm idt process in I I ways. The H ouseholder param eters are of u n it norm, therefore each H ouseholder p aram eter in Eq. (4.50) can be further param eterized as [40]: '^n.j f [n L o I , ; = 0,1, - -, P - 2 ; = P-1, , .

n C :o a m (g ,,,),

for n = I, ·, J -- 1, i.e., Vn,j can be determ ined by 2 (P -- 1) angle param eters. A fter V has been determ ined, the filter bank {/o, / i , · ·, f p - i } is determ ined by 2( J -- 1 )(P -- 1) angle param eters. T he length of filters /p, p = 0 , 1 , · · ·, P -- 1, is L = J P . The relation betw een m odulation filters and dem odulation filters can be expressed as (4.52) w here p = 0,1, · ·, P -- 1 and I = --L + 1 , --L + 2, -, 0.

4 .2 .2

S E R Im p ro v e m e n t B ased on P ro p o se d F ilte r B an k s

To calculate all filter coefiicients in Eq. (4.50), th e co n stan t m a trix V and th e free p a ram eters 6n_k-> (kn,j-, hi Eq. (4.51) should all be determ ined. T h e procedure to design an O FD M system based on the P -b a n d complex-valued u n itary filter bank to optim ize SE R perform ance is outlined as follows. · S tep 1: Choose the u nitary m a trix V according to different applications. For sim plicity, we propose V as th e P x P D FT m atrix, which is defined as

(4.53)
for A ;, n = 1, 2, · ·, P .

R ep ro d u ced with p erm issio n of th e cop yright ow n er. Further reproduction prohibited w ithout p erm issio n .

45 Step 2: Define th e objective function. We talce th e SER form ula for a M PSK coded O FD M system expressed in Eq. (4.41), which is reproduced in th e following, as the objective function: ^ 5 3 -P3,pi,
P i= 0

(4.54)

w here Pe,pi can be calculated by i r A i 7siiK (7r/M ) sin^(ÿ)

(4.55)

w here

7

is a function of coefficients of m odulation/ dem odulation filters, which j =
1

in tu rn are functions of free p aram eters 6n_j and
0

,2 , - -, P -- 2, n =

, 1 , · · ·, K -- 1 -

· Step 3: A pply a num erical optim ization m ethods to determ ine th e values of free p aram eters. F irst set up initial values for all free param eters dnj and (pnj, j --

0 ,1 , - - - , P -- 2, n = 1 , 2 , - - - , J -- 1 , th en a conjugate gradient m eth o d can be used to m inim ize the 2 ( J -- 1 ) ( P -- 1 ) dim ensional function Pg. N ote th a t th e optim iza tio n m ay fall into a local m inim um . Some global o ptim ization m ethods such as

adding ran d o m interference and sim ulated annealing m ay also b e used. However, in practice, a local m inim um m ay be satisfactory as well.

4 .3

S im u la t io n s

To verify our theoretical analysis of error perform ance of a generic M PSK -O FD M system, M onte-C arlo num erical sim ulations are perform ed w ith three types of O FD M systems, nam ely th e D FT -based OFDM system w ith zero-padded C P w hich is no shorter th a n the length of th e transm ission channel, th e D FT -based O FD M w ith o u t CP, and the conventional D W M T system s w ith overlapping factor g = 2, whose m o d u latio n filters are generated by p ro to ty p e filter [32] w(l) = sin

(4.56)

R ep ro d u ced with p erm issio n o f th e co p y iig h t ow n er. Further reproduction prohibited w ithout p erm issio n .

46

for ^ = 0,1, 2 P -- 1 . B oth AWGN channels and fading channels are considered in the sim ulations. In sim ulations, the procedure to calculate th e SE R for a specific SNR is outlined in the flowchart of Fig. 4.4. T he quantity of symbols generated in sim ulations is
10 ®.

In syste m simulation, the tran sm itted M P S K d a ta stream s Xp{n), p -- 0,1, · , P -- 1, are generated according to Eq. (4.20). T he composite d a ta sequence before th e channel, s{n), as illu strated in Fig. 4.1, are obtained by first upsam pling each of the M PSK symbol stream {xQ{n),xi{n), , x p _ i { n ) } by factor K , th en convolving each d a ta stream w ith one of th e P subchannel m odulation filters, finally sum m ing up the o u tp u ts of all P m od ulation filters. A fter s{n)'s convolution w ith th e channel c{n), the AW GN noise, whose power is calculated according to a p articu lar SNR, is added to the tran sm itted sequence to obtain distorted d a ta sequence r(n ). T hen 7'(n) is passed th ro u g h the dem odulation filter of each subchannel, and the result signals are downsampled by factor K . An optim al phase detector is employed for each subchannel according to th e preset phase detection boundaries. M atching of the detected symbol w ith the original d a ta is m ade and errors are counted to o b tain SE R for the particular SNR. Fig. 4.5 and 4.6 show b o th the analytical and sim ulation results over an AWGN channel for D FT -based O FD M system s w ith and w ithout zero-padded CP, and D W M T generated w ith prototype filter expressed in Eq. (4.56). T he m odulation scheme is cpiadrature phase shift keying (Q PSK ) and the num ber of subchannels are 16 and 32, respectively. It can be seen th a t our theoretical analysis m atches th e sim ulations results. In addition, all three kinds of O FD M system s exhibit the sam e error perform ance as th a t in single-carrier system s over an AWGN channel and this perform ance does not change w ith the num ber of subchannels. T h e identical SER perform ance of single carrier system s and OFDM

system s over AW GN channels has been explained in section 4.1.3. Figs. 4.8 and 4.9 show th e results of these OFDM systems, w ith P = 16 subchannels, over two sam ple m u ltip a th fading channels w ith impulse response Ci(n) -- [1, 0.5e-^'^/® ] an d C 2 (n) = [1, 0.5e-^'^/®, 0.2e-^'^/^, 0.1] for Q PSK symbols, respectively. T he am-

R ep ro d u ced with p erm issio n of th e cop yright ow n er. Further reproduction prohibited w ithout p erm issio n .

47
Error counter=0 Generate transmitted symbols with MPSK scheme for all P subchannels Upsample and convolve with filter bank modulator

Summation of outputs of all modulation filters

Convolve with transmission channel Add AWGN noise according to the specific SNR

Convolve with filter bank demodulator and downsample Subchannel detection with optimal phase detector

Comparison of decoded symbol and originally transmitted symbol

Are they sam e?

error counter = error counter

error counter=error counter +1

Have all decoded^^ symbols compared

SER = error counter Ip

F ig u re 4.4; Flowchart of system simulation plitude characteristics of frequency responses of b o th channels are shown in Fig. 4.7. Fig. 4.10 and 4.11 show the results of these OFDM systems, w ith P = 32 subchannels,

R ep ro d u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited w ithout p erm ission .

48
10

10

' "

10

10

"
O O D F T - b a s e d w . C P : a n a ly tic a l D F T - b a s e d w . C P : s im u la tio n D F T - b a s e d w /o . O P : a n a ly tic a l D F T - b a s e d w /o . C P : s im u la tio n D W M T : a n a ly tic a l g = 2 D W M T : s im u la tio n g -- 2__________

10

10

^

10

'
S N R (dB)

10

15

F ig u re 4,5: Comparison of the analytical and simulated performance of OFDM systems over AWGN channels: QPSK (P - 16)
10

10"

'

10

az
10

'

D F T - b a s e d w. C P a n a ly tic a l O D F T - b a s e d w. C P : s im u la tio n -- ' D F T - b a s e d w /o. C P : a n a ly tic a l O D F T - b a s e d w /o . C P : s im u la tio n D W M T: a n a ly tic a l g = 2 D W M T: s im u la tio n g = 2 _________

10

'
10

10- '

15

S N R (d B )

F ig u re 4.6: Comparison of the analytical and simulated performance of OFDM systems over AWGN channels: QPSK (P = 32) over the tw o sample m u ltip ath fading channels ci(n) and C 2 (n) for Q PSK symbols. Each sim ulation result dem onstrates th e consistency w ith corresponding theoretical analysis. As expected, the D FT -based OFDM system w ith CP has superior SER over th e other

R ep ro d u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without p erm ission .

49

C 1(n) C 2(n)

O

0.5

0.1

0.2

0 .3

0 .5

f

0.6

0 .7

0.8

0 .9

F ig u re 4.7: Amplitude characteristics of frequency responses of two channels used in simula tions

two OFDM systems, w ith the cost of system efhciency. It is also dem onstrated th a t th e D W M T has the poorest SER. The reason is th a t b o th channels have no narrow band interference in com parison to the bandw idth of th e subchannels. Therefore, ISI is the dom inant effect on the SER th a n ICI, which DW M T is designed to minimize. Moreover, since the filters in D W M T are of longer length, th e dispersive channel may distort more symbols and increase ISI. To investigate the error perform ance of th e new OFDM based on filter banks designed in section 4.2, sim ulations are perform ed w ith a D FT -based OFDM w ith zero-padded CP, a conventional D W M T system of which the prototype filter is defined in Eq. (4.56), and the new O FDM system based on complex-valued unitary filter banks. The filters of b o th the D W M T system and th e newr OFDM system are of length L = 2P. As showm in Figs. 4.12 and 4.13, th a t the new OFDM system based on proposed complex-valued u n itary filter banks has b e tte r SER th a n th e D W M T system. Its perform ance is com parable to th a t of th e CP included D FT -based OFDM , wdiose transm ission efficiency is decreased by a factor of p ^£ ^i where is th e length of CP. Lk is chosen no less th a n the length of

R ep ro d u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without perm ission.

50
10

`

O
10

D F T - b a s e d w . C P : a n a ly tic a l D F T - b a s e d w . C P : s im u la tio n D F T - b a s e d w /o . C P : a n a ly tic a l O D F T - b a s e d w /o . C P : s im u la tio n D W M T : a n a ly tic a l g = 2 -5 K - D W M T : s im u la tio n g = 2 __________

10

'

Q C. LUO
CO

10

' '

O;

10

10

10

15

S N R (d B )

20

25

30

F igu re 4,8: Comparison of the analytical and simulated performance of OFDM systems with QPSK coding over channel ci(n) (P = 16)

10

its -.: r. ^ Q-- o o o
D F T - b a s e d w . C P ; a n a ly t ic a l D F T - b a s e d w . C P : s im u la tio n D F T - b a s e d w /o . C P : a n a iy tic a l D F T - b a s e d w /o . C P : s im u la tio n D W M T : a n a iy t ic a l g = 2 D W M T : s im u la tio n g = 2

:; .9:: :o .

o O
*

10

S N R (d B )

25

30

F ig u re 4.9: Comparison of the analytical and simulated performance of OFDM systems with QPSK coding over channel C 2 (n) {F -- 16).

channel.

R ep rod uced with p erm ission of th e copyright ow ner. Further reproduction prohibited without perm ission.

51

0

o <> *

D F T --D a s e a w . C P : a n a ly tic a l D F T - b a s e d w . C P : s im u la tio n D F T - b a s e d w /o . C P : a n a ly tic a l D F T - b a s e d w /o . C P : s im u la tio n D W M T : a n a ly tic a l g = 2 D W M T : s im u la tio n ,g=2

- 0 - e O-o-

SNF^IdB) F ig u re 4.10: Comparison of the analytical and simulated performance of OFDM systems with QPSK coding over channel ci(n) (P = 32) to

to
o O *
10

D F T - b a s e d w . C P : a n a iy t ic a l D F T - b a s e d w . C P : s im u la tio n D F T - b a s e d w /o . C P : a n a ly t ic a l D F T - b a s e d w /o . C P : s im u la tio n D W M T : a n a iy t ic a i g = 2 D W M T : s im u la tio n g = 2 __________

10

15 S N R (dB )

20

25

30

F ig u re 4.11: Comparison of the analytical and simulated performance of OFDM systems with QPSK coding over channel (n.) (P = 32).

4 .4

Sum m ary

In this chapter, a closed-form form ula of SER is derived for a generic OFDM system w ith M PSK m odulation and optim um phase detection in each subchannel, based on the

R ep rod uced with p erm ission of th e copyright ow ner. Further reproduction prohibited without perm ission.

52
10

10

10

' '

10

D e s ig n e d O F D M L = 2 P D F T -b a s e d w. C P . DW M T L=2P
10

'

10

10

10

S N R (d B )

15

20

25

F ig u r e 4 .1 2 : System performance of different OFDM system s with QPSK modulation over channel ci(n ) (F = 32).
10

"'42h'- D e s i g n e d O F D M L = 2 P - Q - D F T -b a s e d w. C P . DW MT

LUO CO

az .

10

'

10

S N R (dB)

15

20

25

F ig u r e 4 .1 3 : System performance of different OFDM system s with QPSK modulation over channel (n) (P = 32).

constellation points of received symbols and the assum ption th a t the sum of ISI and ICI can be modelled as a G aussian random processes. It is shown th a t for AWGN channels, OFDM system s dem onstrate identical SER. perform ance w ith single carrier systems. For

R ep rod uced with p erm ission of th e copyright ow ner. Further reproduction prohibited without perm ission.

53 fading channels, when SNR, is far bigger than OdB, SE R of an OFDM will be dom inated by the ratio of weights for desired symbol and interference. This form ula can be used to evaluate D FT-based OFDM and DW MT systems as well as to design new OFDM systems. By employing the derived formula as the objective function, we present a design m ethod for a novel OFDM system based on complex-valued m ultiband unitary filter banlvs to minimize SER. The proposed OFDM system has m ore flexible frequency response and is more suitable to deal w ith complex-valued signals present in wireless systems. This de sign m ethod provides flexibility in choosing OFDM subchannels for different applications by optim izing filter banks tow ards different objective functions. Sim ulations are perform ed w ith DFT-based OFDM systems w ith and w ithout zeropadded CP, and the D W hlT system with overlapping factor g = 2. Sim ulation results show the consistency of theoretical SER analysis and num erical simulations. Moreover, simulations dem onstrated th a t th e designed OFDM system outperform s the conventional DW M T systems, filters of bo th systems are of same length, in term s of SER, the perfor mance of th e designed OFDM is also comparable to th a t of th e D FT-based OFDM w ith zero-padded CP, while th e la tte r system compromises transm ission efficiency for b etter error perform ance.

R ep rod uced with p erm ission o f th e copyright ow ner. Further reproduction prohibited without p erm issio n .

C h ap ter 5 J o in t M a x im u m L ikelih ood D e te c tio n A lg o rith m for O F D M S y stem s and Error P erform an ce A n a ly sis

received symbols of a given subchannel, all transm itted symbols on the other subchannals are considered as random ICI interference. We refer this detection algorithm as the

I

N C hapter 4, the error perform ance of a generic OFDM system is investigated by considering tran sm itted symbols of each subchannel individually. W hen detecting the

subchannel algorithm which has been adopted in many atte m p ts recently [6 , 17, 18, 19, 20, 21] when evaluating the error perform ance of an OFDM system . However, when

employing the subchannel detection algorithm, the detection and decoding of a given subchannel does not take advantage of the information carried by the other subchannels to obtain a b etter evaluation of the transm itted symbols of the given subchannel, and to improve th e system error performance. In this chapter, a joint detection algorithm is proposed for a generic OFDM system to jointly detect and decode symbols received in one frame. T he m ain advantage of the jo int detection algorithm is th a t it turns the m utual effects, of subchannel symbols to be jointly decoded, from interference into useful information contributing to the constellation points of each other.

54

R ep rod u ced with p erm ission of the copyright ow ner. Further reproduction prohibited without perm ission.

55

As explained in Section 3.1.1, in a f-sn b c h an n e l OFDM system , during each tim e frame, P symbols, with each one m odulated to one of P subchannels, are tran sm itted in parallel. The transm itted symbols are m odulated w ith discrete schemes, such as M PSK and quadrature am plitude m odulation (QAM). For a given frame, the tran sm itted symbol of a given subchannel is a one-dimensional symbol. The alphabet size of the constellation points, for the one-dimensional tra n sm itte d symbol, is finite. As a result, the alphabet size of the constellation points of the P-dim ensional tran sm itted symbol, which consists of symbols tran sm itted on all P subchannels at the given frame, is also finite. The

transm itted P-dim ensional symbol and received P-dim ensional symbol are referred as the tran sm itted OFDM symbol and received OFDM symbol respectively. For the case th a t the filter bank m odulator and dem odulator and th e transm ission channel are all linear and tim e invariant, all the constellation points of a received OFDM symbol can be obtained. Considering the alphabet size of the constellation points of a received OFDM sym bol will increase exponentially w ith th e increase of the num ber of subchannels, P , the received OFDM symbol is evenly p artitio n ed into a num ber of subsets, which consisting symbols w ith lower dimensions, to prohibit excessive com putation load. The subchannel symbols received in one subset, referred as a received vector symbol, are jointly detected by considering the effects of all subchannels excluded in the subset as interference. In this way, th e ICI involved in a received symbol is partially reduced. In this chapter, for linear and tim e invariant filter bank m o d u lator/dem odulator and transm ission clrannels, the constellation points and the PD F of th e received vector symbol are derived. T he m axim um likehhood (ML) criterion is employed to decode a received vector symbol by comparing the M ahalanobis distances between the received vector sym bol and each of the constellation points of th e received vector symbol, and decode the received vector symbol as th e constellation point which is th e closest to th e receive vec to r sym bol in term s of th e M ahalanobis distance. A lower b o und and an upper bound of th e vector symbol error ra te (VSER) are derived to provide a practical viewpoint of the system error perform ance by employing th e proposed joint detection algorithm . Sim

R ep ro d u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without p erm ission .

56 ulations axe perform ed to investigate th e perform ance of the jo in t detection algorithm. Sim ulation results show th a t the joint detection algorithm has superior error perform ance to subchannel detection algorithm. This chapter is outlined as follows. In Section 5.1, the joint detection algorithm for a generic OFDM system is presented by deriving the constellation points of the received vector symbols in 5.1.2, then investigating the PD F of received vector symbols and ML detection in 5.1.3, and finally analyzing the system error perform ance under joint ML algorithm , and deriving a lower and an upper bounds of the V SE R in 5.1.4. Results of num erical sim ulations are dem onstrated in Section 5.2. Section 5.3 concludes the chapter.

5 .1
5 .1 .1

J o in t D e t e c t io n A lg o r ith m for O F D M S y s te m s
S y s te m M o d e llin g

A generic block diagram of an OFDM filter bank m odulator and dem odulator w ith P subchannels is shown in Fig. 4.1, which is reproduced below.

x,(n)
p~!

e(n) s(n)
\K

F igu re 5.1: Block diagram for filter bank modulator and demodulator in OFDM systems

T he theoretical model of a generic OFDM system is the sam e as in section 4.1.1, and it is reiterated here. T he upsam pling/dow nsam pling factor K -- P + Li; for D FT-based O FDM system s, where La, is th e length of zero-padded CP, and K -- P for DW M T an d other OFDM systems w ithout CP [13]. M odulation and dem odulation filters of the subchannel p are respectively denoted as fp and hp, p -- 0,1, ·. P -- 1. B oth filters are of length L -- g K , where g is the overlapping factor, g = 1 for D FT -based OFDM and g > 2 for D W M T systems. The constraint for the set of m odulation filters is th a t, fp,

R ep ro d u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited w ithout p erm issio n .

57
0

< p < P -- 1 , fulfill th e following othorgonality property, L-l
/=0

Moreover, the m odulation and dem odulation filters satisfy th e P R property defined as ~ /=o T he transm ission channel c(-n.) is m odelled as a LTI FIR. filter of len g th followed = - P 2 ), < p i ,p 2 < -P (5.2)

0

0

1

by a stationary zero-m ean Gaussian random noise source e(n), which is independent of tran sm ittin g symbols {xp{n),p = 0 , 1 , · · ·, P -- 1 } . c(n) is th e overall transfer function resulting from th e real com m unication channel and a tim e dom ain equalizer if there is a one. T he m apping schemes for tra n sm itte d symbols are discrete, such as M PSK and PAM.

5 .1 .2

C o n s te ll a ti o n P o in ts o f R e c e iv e d V e c to r S y m b o ls

For a P -subchannel O FD M system , during each tim e frame, a P-dim ensional OFDM symbol, which consists of P parallel symbols {xo{n), Xi{n), · · · ,.xp_i(n)}, is tran sm itted . This O FD M symbol can be p artition ed into P / J subsets, each of size J to form P / J ./-dim ensional vector symbols, if P is an integer m ultiple of J . W ith o u t loss of generality, the subset consisting of subchannels w ith index { p i,p i -t- 1 , · , pi -b ./ -- 1 }, is taken as an exam ple for following analysis. T he subchannels indices in subset pi is denoted as subset p i.
{ p i. P i

T he group of indexes of subchannels in subset p i is expressed as P (p i) =

- | - l , . - . , p i - l - J -- 1 } . T he symbols of subset p% a t a given fram e n i are defined w ith

the J-dim ensional colum n vector, Xp ^ {n i) , (^ 1 ) = K a (" ]), a:pi+i(Tti), - · ·, Xp^+j-i{nC)f  All elem ents of (5.3)

(?ri) are m odulated w ith discrete m apping schemes, therefore the

num ber of values which Xp^ (ni) can take, or the cardinality of the al%jha,bet set of X p^{ni), represented w ith G, is finite. Tliis cardinality can be determ ined by th e m apping schemes

R ep ro d u ced with p erm ission of th e copyright ow n er. Further reproduction prohibited w ithout p erm issio n .

58 of all subchannels in the subset. If the cardinality of th e alphabet set for th e subchannel
p, p E

'P (pi), is

Mp,

th e alphabet size of X p , (?ri) will consist of rip,p6 -p Afp elements

because all subchannels are coded independently. As a special case, if all subchannels in th e subset pi are coded w ith th e same A'1-a.vy coding scheme, th e n th e cardinality of the alphabet set of Xp^{n.i) is T he set of all values th a t X p ^ { n i) can tak e is denoted as

th e constellation set Cx- Corresponding to the tra n sm itte d vector sym bol at fram e n i, X p , (ni), the received vector symbol is denoted as y pj {ni + d ) = [yp, (??,! + d), ypi+i(n] + d). · · ·, tjp,+j-^ (^i + d)]^ , (5.4)

where d is the system delay involved in the convolution w ith m o d u latio n filters and de m odulation filters, and other operations in th e transm ission such as channel equalization. If all m odulation and dem odulation filters are of length L -- g K , and only the delay in volved in the convolutions are considered, th en d = g. In the following, th e constellation points of Yp^ {rii 4 - d) is derived. T h e o r e m 1: Given a J-dim ensional vector sym bol tra n sm itte d in tim e fram e U], X p i(n i), as defined in Eq. (5.3), th e constellation points Sp^ = [sp,, Spj+i, · · ·, of the corresponding received vector symbol Yp^ {ni + d), as defined in Eq. (5.4), can be determ ined as: Sp^ = A - Xp,(-n.i), where pipi ( ^ 1 P 2 P 1 (^ i)
û ' ( p i 4 - j - i ) p j (rij[) c i { p , - | . j _ i ) ( p j - ) - x ) (^ '1 )  û ^ ( p i + j --i ) ( p i + J --1) ( ^ i )

(5.5)

(5.6)

^PmP,,> P m

e T (p i) and p,,,

EV{p-i),

is calculated as follows (5.7)
j =Q 1=0

where K is th e length of the com m unication channel c{n).

R ep ro d u ced with p erm ission of th e copyright ow n er. Further reproduction prohibited w ithout p erm issio n .

59 Proof: W ith o u t loss of generality, the subchannel pi is tak en as a sam ple subchannel for th e following analysis. According le th e F o r m u la tio n
1

in Section 4.1.2, th e received

sym bol of subchannel pi a t tim e fram e n i, yp^{ni + d), can be expressed as:
p -i

P#Pi iP= 0 n + Z
n .n ^n i

cüpipiWa^piW'

(5 8 )

w here Opp, (n) is defined in Eq. (4.12). The first term on th e rig h th an d side of Eq. (5.8), ^ is th e contribution from th e additive channel noise and it can be calculated as f =

Z
7 l = -- OO

OQ

&{n)hp^{niK - n.).

(5.9)

By rearranging the last three item s on th e right handside of Eq. (5.8), we get an alternative expression for (ni + d)

+ 4

= +

p.peP(pi)

Z

o:ppi(^i):rp(ni)+ Z
n ,n ^m

Z(^'ppi(^):^p(^)
V

Z
V ^ v i'P iV l)

o:ppi(^i)3:p(Mi) + ^,

(5.10)

N ote th a t all the J tra n sm itte d symbols in subset. p \ , {xp^ (n ), Xp^+i (n ), · · ·, Zp^+j_i (n )}, a.re determ inistic, hence th e first term on th e rig h th an d side of Eq. (5.10) is determ inistic given th a t th e m odulatio n /d em o d u latio n filters and transm ission channel are linear and tim e invariant. The second and th ird term s in Eq. (5.10) are ran d o m processes which are interference involved in th e received sym bol Çp^, which can be calculated as (n^ + d). D enote th e interference item as

^1=

Z
n.n^ni

Z°!pp](^)3:p(/i)+
V

Z
P.P^'P(pi)

c*:pPi(7ii):Cp(Mi),

(5.11)

i.e., Çpj is th e w eighted sum of identical independent d istrib u ted (iid) random variables, Xp(n), 0 < p < P -- 1. A ccording to th e C entral Lim it T heorem [35], Çp,approaches a G aussian random process as th e q u an tity of Xp{n), which is m ainly d om inated by P. gets large. M oreover, the m ean and variance of Çpj can be calculated as: P^Pi ~ ~Z n,n#m {''^')E\xp{ri)\ +
V

Z!
P ,P ^'P {P i)

Q -'ppj (rii)E'[ 2 :p(ni)],

(5.12)

R ep ro d u ced with p erm issio n of th e cop yright ow n er. Further reproduction prohibited w ithout p erm issio n .

60
cr;
,2

Ç pi =

l°:ppi W |^Vor[zp(?% )] +
n ,r iÿ tn \ P

^
P .P ^ P ( p l )

\appAni)\^Var\xp^{ni)],

(5 .1 3 )

where £'[·],y ar[-] and | · | respectively denote th e expected value, the variance and the absolute value. A ssum e all tra n sm itte d symbols, w ith M PSK scheme, where Xp(n) is Xp(n) = where coded as , k = 0,1,   , M - 1, (5.14)
Xp(n),

0 < p < P -- 1, are m odulated

ûk is th e tra n sm itte d phase and vdll take on

one of the values from the set

{(27rA:)/M}. W ith o u t loss of generality, assume P[zp(Tr)] = 0, and from Eq. (5.14) th a t Var[xp{n)] = (5.16) (5.15)

for p -- 0,1. - - -, P -- 1. T he m ean and variance of G aussian random variable ç^, can be obtained as:
hçpj = 0, (5 .1 7 )

-

(5.18)
n ,n ÿ é n i P P .p iV ip i)

It is easy to see from Eq. (5.9) th a t ^ is a G aussian random process w ith zero m ean and variance (5.19) where a'^ is the variance of addictive channel noise. Consequently, th e m ean of sym bol on subchannel pi, 5pi=.G;[2/pX?ti)] (n.i), which is also th e constellation point of th e received

(??]), can be calculated as =
--

Y ] Q:ppi(m):Cp(m) p,p&v[p\)
^ p ip i(^ 'i)  ^ p i ( p i + . 7 --i ) ( ^ i ) ] l ^ p i ( ^ i ) (5 .2 0 )

T he variance of

(rii + d) can be calculated as

R ep ro d u ced with p erm issio n of th e cop yright ow n er. Further reproduction prohibited without p erm issio n .

61 Using Eqs. (5.18) and (5.19), we get E æ+ C T ". _n,n^ni
P

Vpi

(5.22)

P,P0"P(pi) p,,, e 'P (pi), can be obtained by sub

The constellation point for th e subchannel stitu tin g pra for Pi in Eq. (5.20) as

p,pev{pi) ~ [ E>-'p,,,pi(^i) ^Pm{pi+i)i'^i)    Ei'p,,^(pi+j_i)(??i) j Xp^('r(^23)

Eq. (5.5) can be obtained by p u ttin g Eq. (5.20) and Eq. (5.23) in m atrix form at. T h e o  r e m 1 is proved. R e m a rk : W hen filter bank m odulato r/d em o d u lato r and th e transm ission channel are b o th known, Sp^ is determ inistic. Each elem ent of Sp^ is a weighted sum of tran sm itted symbols in subset pi and all weights are constant. Therefore in general, corresponding to each constellation point of th e tran sm itted vector symbol Wpj(7?.i), there exists one and only one constellation point for the received vector symbol Sp ^. The constellation points of X pj (n i) and Sp^ are a one-to-one m apping. All th e values th a t Sp^ can take form the constellation set of th e received J-dim ensional vector symbol (ni -t- d), which is

denoted as Cg. T he cardinality of the alphabet set of Sp^ is sam e as th a t of th e alphabet set of X p^(rii), GA received OFDM symbol consists of th e received symbols from all P subchan nel. T he derivation of th e constellation points of a received OFDM sym bol is a special case of T h e o r e m 1. Assigning th e constellation points of th e received OFDM sym as S = [so,5i, · · · ,5 p _ i]^ , which can be

bol, {yo(ni + d ),y i( n i -k d), · ·  ,y p -i(n i + d)} calculated as
0 :0 0 ( M l ) O O l ( M i ) a i i ( n i )

Q ' o ( p - i ) ( n i ) 0 'i ( p _ i ) ( n i )

Z o ( M i ) a : i ( M i )

s = .

aw{ni)
0 ( p _ i ) o ( M i )

(5.24)
0 ( P - 1 )
i

( M

i

)

·

·

0 ( P - 1 ) ( P - 1 ) ( M

i

)

j

_

Z p _ l ( 7 % l )

_

R ep ro d u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without p erm ission .

62

5 .1 .3

J o i n t D e te c ti o n o f R e c e iv e d V e c to r S y m b o l

For a given subset p i, the task of the subset joint detection can be described as to find the constellation point in C s for Yp^ (ni + d) based on ML criterion, th en decide which constellation point in C x is tran sm itted on basis of th e one-to-one m apping relation of C s and C x- According to ML criterion, the Y p ^{n i + d) should be decoded as 1, 2, · · ·, G, which maximizes the conditional PD F /y |s (Vp, conditional P D F function is derived. T h e o r e m 2; Given the tran sm itted vector symbol X p, (n i), as defined in Eci- (5.3), and the constellation point of the corresponding received vector symbol Y p, {rii -f d), th e conditional P D F function /y |g {Yp^ / v i s ( n , i s i ) = (27r)-//2|2|V2 exp can be expressed as Pi pi' (5.25) , =

In th e following this

where E is a diagonal m atrix which is defined as a.22/ P l
0 0 ' 0 0

S 0

V p \+ i

(5.26) ··
y ( P i 4 - j -- 1)

0

.

where

, the sum of variance of channel noise and interference in subchannel Pm,

Pm E V {p i), can be calculated by substituting pm for pi in Eq. (5.22). Proof: The statistical characteristics of the element pm-, Pm E V {p i) of Yp^{rii -j- d). yp,,Xrii+d). is considered. As explained in T h e o re m 1, yp^{n,i~\-d) is a G aussian random variable w ith m ean Sp,,^ and variance (5.27) Therefore, the conditional P D F of Up^frii -h d), given th e tran sm itted sym bol which cor responding to constellation point 5* , can be obtained as: exp
Vpr,

(5.28)

R ep ro d u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without p erm ission .

In th e following we will dem onstrate th a t

63 (n i + d), Pm E ' P (p i) is independent to

symbols received on th e other subchannels of subset Pm during the same frame, Pp. (n i+ d ), Pj e 7^(pi) and Pj ^ Prn- According to Eq. (4.15), ypj{ni + d) can be expressed as - 0,
/

and - k), k the correlation function of Up^ini + d) and ypj{ni 4- d), Ryy{l, k) is + 4 = (6.30)

(Z , k) =
=

(ni + d)p;^. (7 % i + d)]
J 2 Y ,E [ r ( .lV ik ) ] h ^ J n J i- l) h ; .{ n ,K - k y I k (6.31)

Prom Eqs. (5.1) and (5.2) th a t, in an OFDM system, the m odulation filters and their K shifted versions form a set of orthonorm al basis, so do the dem odulation filters. W hen the frequency bandw idth of the subset pi is sufficiently narrow com pared to the bandw idth of th e transm ission channel, it is reasonable to assume th a t E [r{l)R {k)] -- S{l -- k) w ithin the bandw idth of th e subset, then Eyy(Z,A:) = 0, /o r (5 32)

i.e. yp,n{iT'i + d) and yp^{rii + d) are uncorrelated. From Eq. (5.32), Y p-^{ni + d) is a J-dim ensional joint-G aussian random variable vector consisting of J independent one dim ensional G aussian random variables pp, (n-i), yp,+i(?ri), · · , y p i+ j_ i(n i). tional joint P D F of stellation point The condi

given the tran sm itted vector symbol which corresponds to con can be obtained

A |.(y ,.l4 .)=

n
ripm .P7n.E7-'

fyHvvJ4J-

(5.33)

By su b stitu tin g Eq. (5.28) for (5.33), T h e o r e m 2 is proved. T h e M ahalanobis distance from the distorted vector symbol Yp^ (rii + d) to th e con stellation point is defined as [43]

M D { Y , ,, S < J = {Y,,, -

- S `J

(5.34)

R ep rod u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without perm ission.

64 By applying ML detection algorithm , we decode Y p ^[n i + d) as the constellation point Sp^ which maximizes conditional P D F /y |s (^ p i This is equivalent to decode

Y p^{ni + 1) by the M ahalanobis distance, defined in Eq. (5.34), between Yp^{rii + d) and each constellation point S p ^,i = 0,1, , G -- 1, and assign Yp^{iii + d) to be the

constellation point for which the M ahalanobis distance is the minimum. T hen according to the one-to-one m apping between th e constellation point set of the received vector symbol, C s, and the constellation point set of th e tran sm itted vector symbol, C x , the tran sm itted vector symbol are figured out. The detection process is schematically shown in Fig. 5.2.

M ahalanobis D istance Calculator

M ahalanobis D istance Calculator

M ahalanobis D istance Calculator

F ig u re 5.2: Schematic illustration of ML detector

5 .1 .4

E r r o r P e r f o r m a n c e A n a ly s is

T he form ulation of the average error probability of received J-dim ensional vector symbol
Yp^{ni +

g), denoted as V SER P,,e,pi, is theoretically straightforw ard. A n error occurs

whenever the received vector symbol Yp^ (??] -|-g) does not fall inside region Rp^, which is associated w ith the constellation point Sp^ [44], and the VSER can be calculated as

= 1-

4 E / , A IS (Vp. i s ; . ) d y ,, , ^ t=o -'^Pi

(8.35)

However, the decision on the boundary of Rp^ and the num erical com putation of Eq. (5.35) are not feasible in m ost cases. In the following, an upper bound is derived for th e V SER by

R ep ro d u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without perm ission.

65

transform ing the M ahalanobis distances between

(n i + g) and Sp^, i

0,1, ,G -- I,

to the Euclidean distances betw een a new observation vector and new vector constellation points. T he inverse of the J x J diagonal m atrix S can be decomposed as (5.36) where B is also a J x J diagonal m atrix which is defined as jg = dia,? ------1 . . . . , ------ ^ (5.37)

By su b stituting Eq. (5.37) into Eq. (5.34), the following expression is obtained th a t M D (y ,, ,S ;,, ) = Assign the new observation vector symbolas == and the new constellation point as v ;, = s s ;.. (5 40) (5 39)

- B S `J .

(5.38)

in spatial domain, th e Gaussian random noise in each one of J orthogonal directions is changed into AWGN noise w ith unit power. The AWGN noise processes in th e J directions are iid noise processes. It is easy to see th a t
M D {Y,,,,S` J = U D {Z ,, ,, V i).

(5.41) and By replacing the

where U D { Z p ^ , V p J is the Euclidean distance between

Ma.halanobis distance between Yp-, and S'p^ to the Euclidean distance between Zp, and V p ^, the task of finding an Sp^ which is closest to Yp^ in term s of M ahalanobis distance change to finding a Vp^ which is closest to Zp^ in term s of Euclidean distance, and Zp^ is a J-dim ensional observation vector distorted by iid AWGN noise in each of th e J directions. T he variance m atrix of Zpj is a J x J identity m atrix.

R ep rod u ced with p erm ission of the copyright ow ner. Further reproduction prohibited without perm ission.

66 On basis of [44], tlie upper bound of the average probability of vector symbol error,
1

only depends on the minimum Euclidean distance between any pair of the constel I < i , k < G, i k, and the power of the iid AWGN noise.

lation points, Vp.^ and

In the case th a t the AWGN noise having unit power, th e upperbound of the average probability of the VSER can be calculated as (5.42) where dmin = / o r l < i, A ; < G. (5.43)

Eq. (5.42) shows th a t, Pve,px decreases exponentially as th e square m inim um distance of the transform ed constellation points, increases.

Thus far, VSER has been the only figure used in the proposed joint detection algorithm to assess th e error perform ance of a generic OFDM system. However, it. is also meaningful to evaluate the SER,Pe,of the one-dimensional symbol receh'cd on one of P subchannels, under joint detection algorithm. The relation of P,,e,pi &nd Pe.p, > the SER of subchannel Pi, Pi e V {p i), is explained in the following. Pve,px = P pi+ j-i U
\ Vi=Vi

1 \ (subchannel p, is in error)
}

<

E
P i= V\

(5.44)

where (J represents the union operation. We also note th a t Poe,Pi > P(subchannel pi is in error) = Pe,p,It follows therefore th a t the SER in the subset pi is bounded as follows: < a ,,, ,, . T he SER, over ah P subchannels, P^, can be evaluated by averaging P / J subsets:
2 - ^ p i = | 4 ve,

(5.45)

(5.46)
P vc,p,

over all the

p

P/J pi=i

P

R ep ro d u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without perm ission.

5 .1 .5

D is c u s s io n s

67

For AWGN channels or channels which have been perfectly equalized, th e transfer function c('ft) = 5{n), there is no 181 and ICI involved in th e received symbols due to the PR property of the filter bank m odulator and dem odulator. The only distortion in received symbols comes from additive channel noise. Therefore the S in Eq. (5.25) is reduced to 0 E 0 0
2 a.n

..

0

(5.48)
..

where cr^ is the variance of the channel noise. For AWGN channels, from Eq. (5.48) th a t thé noises in all J orthogonal directions are iid. noise w ith variance cr.^, and the Euclidean distance can be employed directly for ML detection. Moreover, for AWGN channels, it is possible to do further exploration on the constellation points of th e received vector symbol Y`pj(ni + d). The m atrix A in Eq. (5.5) can be verified as an identity m atrix by substituting Eq. (5.2) into (5.6). Consequently the constellation points of the received vector symbol Y p , (?ii + d ) are same as th a t of transm itted symbols X p ^ (n i). For AWGN channels, an OFDM system dem onstrates same error perform ance under joint detection algorithm and subchannel detection algorithm.

5 .2

S im u la t io n s

System simulations are implemented to mW uate the perform ance of various OFDM sys tem s by employing the proposed joint detection algorithm. In the sim ulations, aU sub channel symbols are m odulated with the BPSK scheme. The P subchannels are divided into a num ber of disjoint subsets, w ith each subset including 8 subchannels, for BPSK m odulation. In system simulations, the composite tran sm itted signal to be tran sm itted through the channel, .s(n), as illustrated in Fig. 5.1, is obtained by first upsam pling each of the p BPSK symbols stream s
{ .X o (n ), :i'i( 7 i) ,

-, a.'p_i(n)} by factor

then convolving w ith one of the

R ep rod u ced with perm ission of th e copyright ow ner. Further reproduction prohibited without perm ission.

68 P m odulation filters, finally summ ing up all outp u t from P subchannels. A fter the s(?r) convolving w ith th e transm ission channel c('n), the AWGN noise is added to the compos ite serial symbol sequence to got the distorted signal r[n). The signal r(n ) is then passed through th e dem odulation filter of each subchannel, and the result signal on each subchan nel is downsampled by factor K . The P received symbols, {yo in ) , y i{ n ) , - -,
i

(??,)}, arc

divided into a num ber of subsets, each of size 8 for BPSK coding. The subchannel symbols in one subset, referred as a received vector symbol, are decoded jointly by calculating the M ahalanobis distances between it and all constellation points in Cs- The constellation point in C x , which corresponding to the constellation point in C s having th e minimum M ahalanobis distances to the received vector symbol, is the one having been transm itted. To make com parison of the system error performance between the subchannel detection algorithm and the joint detection algorithm , the SER in joint detection algorithm is cal culated according to the procedures outlined in Fig. 5.3. The emphasis in transferring th e V SER result to SER is th a t, when a received vector symbol of a specific subset is not decoded correctly, each subchannel symbol in the subset will be checked w ith the tran sm itted symbol of th a t subchannel to see w hether this received subchannel symbol is correctly decoded. By considering all received vector symbols th a t are wrongly decoded in the way described above, we obtain the sim ulated average SER. Num erical simulations are performed w ith three kinds of OFDM systems, namely, the D FT -based OFDM system w ith zero-padded CP, the D FT-based OFDAl w ithout CP and the conventional D W M T system overlapping factor g -- 2 whose m odulation filter are generated from the prototype filter defined in Ecj. (4.56). The sample channels include an AWGN channel and two fading channels with impulse response Ci (n) = [1, and

Fig. 5.4 show numerical sim ulation results of b o th subchannel detection and joint detection for OFDM systems over AWGN channels. B oth detection algorithm s have

sam e error perform ance which is no t changed with the num ber of subchannels, P. Fig. 5.5 and Fig. 5.6 dem onstrate error perform ance of b o th detection algorithm s under

R ep rod u ced with p erm ission of the copyright ow ner. Further reproduction prohibited w ithout perm ission.

69
Joint dectection

Is the eceived vector symbol .^.decoded correctl)'?^^^

Is the ith element decoded correctly?

error counter = error counter

error counter^ error counter +

Have all P/J subsets been considered?

SER^error counter/?

F ig u re 5.3: Calculation of SER under joint detection algorithm the two sam ple fading channels. Those figures denionstrate th a t joint detection algorithm has superior perform ance th a n subchannel detection algorithm especially when the SNR getting larger.

5 .3

Sum m ary

In this chapter, a joint m axim um likelihood detection algorithm is proposed to jointly detect and decode th e symbols received during one tim e frame. By employing the joint detection algorithm , the effects of symbols in th e same tim e fram e are used to calcu late the constellation points of the received vector symbols instead of being considered

R ep ro d u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without p erm ission .

70

cr
LU CO

joint: D F T - b a s e d w /o. C P . joint : D F T - b a s e d w. C P . joint: DW M T g = 2 s u b c h a n n e l : D F T - b a s e d w. C P . -- · s u b c h a n n e l : D F T - b a s e d w /o. C P . · s u b c h a n n e l : D W M T g = 2 __________

HX 

10'
S N R (d B )

12

F igu re 5.4: Comparison of joint detection and subchannel detection over an AWGN channel with BPSK ( P = 32)

10 10' 10' O C
joint: D F T - b a s e d w /o . C P . jo in t: D F T - b a s e d w . C P . joint: D W M T g = 2 s u b c h a n n e l: D F T - b a s e d w . C P . -- - s u b c h a n n e l : D F T - b a s e d w /o . C P . · ·· s u b c h a n n e l : D W M T g = 2 __________ 4X O

10' 10' 10'

10

15 S N R (d B )

20

25

F igu re 5.5: Comparison of joint detection and subchannel detection over channel C](n) with BPSK ( P = 32)

as interference in subchannel detection algorithm . An upper bound of V SER is derived by transferring M ahalanobis distances, between th e received vector sym bol and th e con-

R ep ro d u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited w ithout p erm ission .

71

10'

CO

09
p

-H:
:

10

jo in t: D F T --b a s e d w / o . C P . jo in t: D F T --b a s e d , w . C P . jo in t: D W M T g = 2 s u b c h a n n e l : D F T --b a s e d w . C P . · -- · s u b c h a n n e l : D F T --b a s e d w / o . C P . s u b c h a n n e l : D W M T g = 2 _________ 10 15
20

+ X a

10'

25

S N R (dB )

F igu re 5.6: Comparison of joint detection and subchannel detection over channel co(Ti) with BPSK ( F = 32)

stellation points of th e received vector symbol, to the the Euclidean distances of a new observation vector and new constellation points, to provide a practical view point of th e system perform ance under joint detection algorithm . M onte-Carlo num erical sim ulations are perform ed, w ith th e D FT -based O FD M systems and D W M T system s, to com pare the perform ances of the subchannel and the jo in t detection algorithm s. Sim ulation results dem onstrate th a t the proposed joint detection algorithm has b e tte r error perform ance for an O FD M system th an the subchannel detection algorithm.

R ep ro d u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited w ithout p erm issio n .

C h a p ter 6 C o n clu sio n s and F u tn re R ese a rch
6 .1 C o n c lu s io n s

In a generic O FD M system , m odulation filters form a set of orthonorm al basis, and m odulation filters and dem odulation filters fulfill th e perfect reconstruction p ro p erty to keep subchannels well isolated, and enable the tra n sm itte d symbols to be perfectly re trieved from the received symbols. However, in m ost cases these nice properties are easily destroyed by m u ltip ath channels. Some work has been done in evaluating th e error per form ance for the D F T -based OFDM systems. T he topics unaddressed in th e published literatu re include the system atical error perform ance evaluation for a generic O FD M sys tem , and some d etection algorithm s other th a n th e subchannel detection algorithm , in which each received symbol is detected individually w ithout considering all inform ation carried by the other symbols. B oth of th e subjects are addressed in this study. F irstly in th is study, a closed-form form ula of th e SE R has been derived for M PSK coded O FD M system s which employs optim um phase detection for each subchannel. The derivation of th e S E R form ula is based on the constellation points of the received symbols and th e assum ption th a t th e sum of ISI and IC I can be m odelled as a G aussian random process w hen the num ber of subchannels is large. T his form ula can be used to calculate the SE R of either the D F T -based OFDM system, the D W M T system or other O FD M system s which fulfill the orthogonality and P R requirem ents and use M PSK m odulation. The applications of th e derived form ula in AWGN channels and fading channels are discussed. 72

R ep ro d u ced with p erm issio n of th e cop yright ow n er. Further reproduction prohibited w ithout p erm issio n .

73

R esults of num erical sim ulations dem onstrate th e consistency w ith th e SE R form ula over b o th AWGN an d fading channels. Secondly, a system atic m eth o d is presented to design a novel OFDM system based on com plex-valued m ultib an d u n itary filter banks, which have m ore flexible frequency response and are m ore suitable to deal w ith complex-valued signals present in wireless system s. This m eth o d provides flexibilities in choosing O FD M subchannels for different applications by optim izing filter banks tow ards different objective functions. In this thesis, th e derived SE R form ula, for a generic M PSK -O FD M system , is employed as the objective function. System sim ulations show th a t th e designed O FD M system outperform s D W M T system s, filters of b o th system s are of the sam e length, in term s of SER. Sim ulations also show th a t the error perform ance of th e designed O FD M system is com parable to D FT based OFDM w ith zero-padded cyclic prefix, which comprom ise th e transm it don ra te for b e tte r error perform ance. Finally in this study, a jo int ML detection algorithm is proposed to jointly d etect and decode the symbols received at one tim e frame. T he received symbols in one fram e are p a rtitio n e d in to several subsets, and th e received sym bols w ithin one subset are decoded jointly. T he jo in t detection algorithm make b e tte r use of th e inform ation carried by the o th e r symbols in the sam e subset as the one to be decoded, an d com paratively reduces the interference involved in the sym bol to be detected. Based on th e constellation points and the P D F function of th e received vector symbol, an upper b o und of th e VSER. is derived by tran sferrin g th e M ahalanobis distances betw een th e received vector sym bol and th e constellation points of th e received vector symbol to th e E uclidean distances of a new tran sferred observation vectors an d th e new transferred constellation points. M onte-Carlo num erical sim ulation are perform ed, w ith th e D FT -based O FD M and D W M T system s, to com pare th e perform ances of th e subchannel detection algorithm an d th e joint detection algorithm . Sim ulation results dem onstrates th a t th e joint detection algorithm provides b e tte r error perform ance for a n O FD M system th a n th e subchannel detection algorithm .

R ep ro d u ced with p erm issio n o f the cop yright ow n er. Further reproduction prohibited w ithou t p erm issio n .

74

6 .2

F u tu r e R e s e a r c h

OFDM has a prom ising future in wireless local area network and in fixed and mobile com m unications due to its high spectral efliciency and flexibility in spectrum allocation and m odulation. F urther work could be done under b o th th e subchannel and th e joint detection algo rithm s for the detection and error perform ance evaluation for a generic O FD M system. Under th e subchannel detection algorithm , the overall effect of channel noise and interference for a given subchannel is approxim ated as a zero-m ean G aussian process in the F o r m u la tio n 1 of chapter 4. The constellation points of received symbol and its P D F function can b o th be derived from the constellation points of th e tran sm itted symbol. In this way, th e error perform ance evaluation is m ainly based on th e detectors an d the decoding decision boundaries a t the receiver end of each subchannel. In C hapter 4, the SE R form ula for th e M PSK m odulation is derived. T he other m odulation schemes in a O FD M system include QAM and M-ary differential phase shift keying (M DPSK), to nam e two. T he form ulation for SER expressions for these m odulation schemes will be done in th e future. U nder th e proposed joint detection algorithm , th e ICI is partially elim inated by jointly decoding th e received symbols w ithin a subset (C hapter 5). However, the jo in t detection algorithm can be extended to jointly detect successive symbols for a given subchannel, hence p artially reducing the ISI, or jointly detect all symbols in a subset w itliin a num ber o f successive frame to p artially reduce b o th IC I and ISI. In th e sim ulation studies, th e fading channels are random ly selected and are com par atively simple. In th e future, the Rayleigh and Rice fading channels will be adopted to evaluate system perform ance in practical situations.

R ep ro d u ced with p erm ission of th e cop yright ow n er. Further reproduction prohibited w ithout p erm issio n .

A p p e n d ix A C en tra l L im it T h eo rem
This appendix is a sum m ary of th e central lim it theorem on basis of [45]. T he com m on definition of th e central lim it theorem consider th e norm alized sum of a large num ber of identically distrib u ted random variables random variable given by
A / --1

Xi,

where

y

is th e norm alized

and each z, has m ean /i and variance cr^. T he random variable y is approxim ately norm ally distributed (a G aussian distribution w ith zero m ean and u n it variance) as PI becomes large. A m ore general statem en t of th e central lim it theorem justify th e G aussian approxi m atio n when Xi, i -- 0 ,1 , · ·, M -- I, are no t identically d istrib u ted b u t are independent. It requires th a t the sum &=
i= 0

M -l (VI 2)

of M random variables, a;j (which are not necessarily identically d istrib u ted b u t are inde pendent) , each w ith m ean as M gets large, provided th a t
M-l
z--0

an d variance

. approaches a G aussian random variable

for j -- 0,1, - · , M -- I. Furtherm ore, the m ean and variance of the sum, y, are given by M -l l-h = Ar,, (A-4)
i= l

75

R ep ro d u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without p erm ission .

a.

,2

M -l
i= \

76

y

T he condition for Eq. (A. 3) to hold is equivalent to specifying th a t no single Xi dominates V-

R ep rod u ced with p erm ission of the copyright ow ner. Further reproduction prohibited without p erm ission .

A p p e n d ix B C h an g e o f V ariab les
T he purpose of the change of variables (V 0 ^) in Eq. (4.34) to
{r.ijjy)

are to calculate

SE R w ith the integration over a finite range by applying results of [36, 37, 38, 39]. As shown in Fig. B .l, y is th e received symbol, <dy and V are phase and radius of y, respectively. Tl.ie constellation point corresponding to th e tran sm itted symbol, w ith phase zero, is ^ , y is a t a distance r from y^^ Pi and is the angle betw een vectors y.p^y

an d o?/p^ line connecting points y and y^^ Pi and th e coordinate.

F ig u re B .l: Illustration of change of variables T h e following expressions can be derived from Fig. B .l,
IW p . I + ^ c o s(6 y % ) = r c o s (t/;y ),

(B .l)

77

R ep ro d u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without p erm ission .

rsin(i/'y) = y 8iii(ey Therefore, = \/r= - 2|Fp, \rcos{ijy) + |% 7p, p, e ,, _ ta r,-' I - 7 ; 4 '^ ) \rc o s (^ ;,) - 1 % /Pi I + or alternatively r = + 2 y cos(0y I + IVp, ·

78 (B.2)

(B.3) (B.4)

(B.5) (B.6)

iljy = tan - 1

V sm(Qy - % ) y cos(O), + Iz/pj

According to the Change of Variable Theorem [46], a (y ,0 . a (r, where o{v,eu) d{r,Tpy) is th e determ inant of Jacobian m atrix and (B.4) into Eq. (B.7), Eq. (4.38) is obtained. (B.7] S ubstitu tin g Eqs. (B.3)

R ep rod u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without p erm ission .

B ib lio g ra p h y
[1] S. S. P rad h an and K. Ram cliandraii, "Efficient layered d a ta tra n sp o rt over multicarrier system using optim ized embedded m odulation," IE E E Trans, on Corn.munications, vol. 50, pp. 877-881, June 2002. [2] A. N. Akansu, P. Duhamel, X. Lin, and M. Gourville, "O rthogonal transm ultiplexers in communications: a review," IE E E Trans, on Signal Processing, vol. 46, no. 4, pp. 979-995, Apr. 1998. [3] I. Kalet, "The m ultitone channel," IE E E Trans, on Communications, vol. 37, pp. 119-124, Feb. 1989. [4] V. Mignone and A. Morello, "CD 3-0PD M : a novel dem odulation scheme for fixed and mobile receivers," IE E E Trans, on Com.m,unications, vol. 44, no. 9, pp. 11441151, Sept. 1996. [5] C. Liu, "The effect of nonlincarity on a QPSK-OFDM -QAM signal," IE E E Trans, on C onsum er Electronics, vol. 43, no. 3, pp. 443-447, Aug. 1997. [6] S. Lei and V. Lan, "Perform ance analysis of adaptive interleaving for OFDM sys tem s," 2002 . [7] N. Benvenuto and S. Tornasin, "On th e comparison between OFDM and single carrier m odulation w ith a D FE using a frequency-domain feedforward filter," IE E E Trans, on Communications, vol. 50, pp. 947-955, June 2002. IE E E Trans, on. Vehicular Technology, vol. 51, no. 3, pp. 435-444, May

79

R ep rod u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without perm ission.

80 [8] G. Cherubini, E. EJeftheriou, S. Olcer, and J. M. CiofE, "Filter bank m odulation techniques for very high-speed digital subscriber lines," IE E E CommunicaUons Mag azine, vol. 38, no. 5, pp. 98-104, May 2000. [9] G. Cherubini, E. Eleftheriou, and S. Olcer, "Filtered m ultitone for very high-speed digital subscriber lines," IE E E Journal on Selected Areas in Communications, vol. 20, no. 5, pp. lOlG 1028, June 2002. [10] P. P. V aidyaiiathau, "Filter banks in digital com m unications." IE E E Circuits a.nd System Magazine, vol. 1, no. 2, pp. 4-25, 2001. [11] S.B. W einstein and P.M. E bert, "D ata transm ission by frequency division m ulti

plexing using the discrete fourier transform ," ' IE E E Trans. Commun. Technol., vol. COM-19, Oct. 1971. [12] M. D. Nave and C. Del-Toso, "A short overview of the VDSL system requirem ents," IE E E Communications Magazine, vol. 40. no. 12. pp. 82-90, Dec. 2002. [13] S. D. Sandberg and M. A. Tzannes, "Overlapped discrete m ult it one m odulation

for high speed copper wire comm unications," IE E E Journal on Selected Areas in Communications, vol. 13, no. 9, pp. 1571-1585, Dec. 1995. [14] IVi.A. Tzannes, M.C. Tzannes, and H.L. Resnikoff, "DM T systems, DW M T systems and digital filter banks," in Proc.ICC, vol. 1. pp. 311 315, 1004. [15] H. S. Malvar, "Extended lapped transforms: properties, applications, and fast al gorithm s," IE E E Trans, on Signal Processing, vol. 40, no. 11, ])p. 2703 -2714. Nov. 1992. [16] A. N. Akansu and X. Lin, "A com parative performance evaluation o f D M T (OFDM) and D W M T(DSBM T) based DSL communications systems for single and n.ultitone interference," in proa. IC A SSP , vol. 6, pp. 3269-3272, M ay 1998.

R ep ro d u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without perm ission.

SI [17] W. Hwang and K. Kim. "Perform ance analysis of OFDM on the shadowed im iltipath channels," IE E E Trans, on. Consumer Electronics, vol. 44, no. 4, pp. 1323-1328, Nov. 1998. [18] T. Tjlum g, X. Wang, and C.S. Ng, "Error perform ance evaluation of th e M DPSKDMT system s in AWGN and impulse noise," IE E E Trans, on C onsum er Electronics, vol. 46, no. 1, pp. 131-136, Feb. 2000. [19] T. Pellet, P. Spruyt, and M. Ivloeneclaey, "The BER perform ance of OFDM systems using nou-sj'ndironized sampling," in Proc. IE E E G LO BE C O M '94, pp. 2-53-257, Nov. 1994. [20] G. Vandersteen, J. Verbeeck. Y. Rolain, and J. Schoukeirs, "A ccurate bit-error-rate estim ation for OFDM based telecom m unication systems schemes in the presence of nonlinear distortions." in Proc. 17th IE E E IM TC , vol. 1, pp. 80 - 85, 2000. [21] J. Lu, T. Tjhung, P. Adachi, and C. Huang, "BER perform ance of OFDM -M DPSK system in frequency-selective Rician fading w ith diversity reception," IE E E Trans, on. Vehicular Technology, \'ol. 49, no. 4, pp. 1216-1225, July 2000. [22] Y. W ang and X.-P. Zhang, "Symbol error rate evaluation and filter bank design for OFDM system s w ith MPSK m odulation," to he submitted, 2003. [23] Y. W ang and X.-P. Zhang. "Design of i\l-band complex-valued filter banks for mul ticarrier transm ission over m ultipath wireless channels," m p?vc. IC A S S P '03, Apr. 2003. [24] Y. W ang and X.-P. Zhang. "Filter bank based interference suppression for fading channels." in proc. C C E C E '03, May 2003. [25] Y. W ang and X.-P. Zhang, "Joint m axim um likelihood detection algorithm for OFDM systems and error perform ance analysis," to he submitted, 2003.

R ep rod uced with p erm ission o f th e copyright ow ner. Further reproduction prohibited without p erm ission .

[26] P. P. V aidyaiiatlian, Prentice Hall, 1993.

82 Multiratc System s and Filter Banks, Englewood Cliffs, NJ;

[27] S. M allat, A Wa,velet Tour of Signal Processing, Académie Press, 1998. [28] P. P. V aidyanatliaii, "Theory aim uesign of iM-chaiinel maximally decim ated quadra ture m irror filters with arbitrary M, ha\dng perfect, reconstruction property." IE E E Tra-ns. A SSP ., pp. 476-492, Apr. 1987. [29] E. Lawrey, "A daptive techniques for m ultiuser O FD M ," PhD dissertion. Jam,es Cook University. Australia., 2001. [30] L. Hanzo, C. W ang, and M. Yee, Adaptive wireless transceivers: turbo-coded, turbo equalized and space-time coded TDM A, CDMA, and OFDM systems, chapter 13, IE EE Press, 2002. [31] H. S. Malvar, "Lapped transform s for efficient traiisform /subband coding,'' IE E E Transaction on Acoustics, Speech and Signal Process, vol. 38, no. 6, June 1990. [32] H. S. Malvar, "M odulated QMF filter bank w ith perfect reconstruction," Electronic Letters, vol. 26, no. 13, June 1990. [33] R.A. G opinatli and C.S. Burrus, "On cosine-m odulated wavelet, orthonorm al bases,'' IE E E Trans, on Image Processing, vol. 4, no. 2, pp. 162-175, Feb. 1995. [34] Y. Zhao and S. G. Haggman, "Ber analysis of OFDM communication systems w ith interca.rrier interference," in proc. IC C T'98, vol. 2, Oct. 1998. [35] H. Stark a.nd J. W . W oods, Probability, random, processes, and estim ation theory fo r engineers. Prentice Hall. 1994. [36] W. Craig, "A new, simple, and exact result, for calculating the probability of error for two-dim ensional signal constellations," in Proc. IE E E M ilitary Com munication Conference, M IL C O M ' 91, pp. 571-575, Oct. 1991.

R ep rod u ced with p erm ission of th e copyright ow ner. Further reproduction prohibited without p erm ission .

83 [37] M. K. Simon and D. Divsalar, "Some new tw ists to problems involving th e G aussian probability integral," IE E E Trans, on Communications, vol. 46, pp. 200-210, Feb. 1998. [38] F. S. W einstein, "Simplified relationships for the probability d istribution of the phase of a sine wave in narrow -band norm al noise," IE E E Trans, on Inform ation Theory, vol. IT-20, pp. 658-661, Sept. 1974. [39] R. F. Pawula, S. 0 . Rice, and J. H. R oberts, "D istribution of the phase angle between two vectors p ertu rb ed by Gaussian noise." IE E E Trans, on Communicattons, vol. COM-30, pp. 1828-1841, Aug. 1982. [40] X.-P. Zhang, M. Desai, and Y.-N.Peng, wavelets: some properties and design," no. 4, pp. 1039-1048, Apr. 1999. [41] H. Zou and A. 11. Tcwfik, "Discrete orthogonal M -band wavelet decom positions." in proc. IC A SSP , vol. 4, pp. IV -605-608, 1992. [42] P. Steffen, P. N. Heller. R. A. Go%)inath, and C. S. Burrus, "Theory of regular' Mban d wavelet bases," IE E E Transaction on Signal Processing, vol. 41, no. 12, Dec. 1993. [43] B. Manly, M ultivariate statistical methods: a prim er. 2nd edition, C hapm an Hall, 1994. [44] S. Haykiii. C om m unication system s, f th édition. John W iley k Sons Inc, 2001. [45] N. L. Johnson, S. K otz, and N. Balakrlslm an, Discrete M ultivari te Distributions, John W iley k Sons Inc, 1997. [46] H. Jeffreys and B. S. Jeffreys, Methods o f Mathematical Physics. 3rd edtion., Cam  bridge U niversity Press, Cambridge, England, 1988. "O rthogonal complex filter banks and IE E E Trans. Signal Processing, vol. 47,

R ep ro d u ced with p erm ission of th e copyright ow n er. Further reproduction prohibited without p erm issioi


