SYNCHRONOUS GENERATOR EXCITATION CONTROL BASED ON MODEL PREDICTIVE CONTROL
By

QINGXIANG JIN (M.Eng, Harbin Institute of Technology, China, 1996) (B.Eng, Harbin Institute of Technology, China, 1991)

A thesis presented to Ryerson University in partial fulfilment of the requirements for the degree of Master of Applied Science in the Program of Electrical and Computer Engineering

Toronto, Ontario, Canada, 2005

© QINGXIANG JIN 2005

PRO PW TYO F RYERSeil UBflAHr

U M I Num ber: E C 5 3 0 2 6

All rights r e se r v e d INFORMATION TO U SE R S

T he quality of this reproduction is d ep en d en t upon the quality of the copy subm itted. Broken or indistinct print, colored or poor quality illustrations and photographs, print bleed-through, substandard margins, and improper alignm ent can adversely affect reproduction. In the unlikely ev en t that the author did not sen d a com plete manuscript and there are m issing p a g e s, th e s e will be noted. Also, if unauthorized copyright material had to be rem oved, a note will indicate the deletion.

UMI
UMI Microform E C 53026 Copyright 2 0 0 8 by P roQ uest LLC All rights reserved. This microform edition is protected against unauthorized copying under Title 17, United S ta te s C ode.

P roQ uest LLC 789 E ast E isenhow er Parkway P.O. Box 1346 Ann Arbor, Ml 4 8 1 0 6 -1 3 4 6

Author's Declaration

I hereby declare that I am the sole author of this thesis.

I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research.

Signature:

I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

Signature:

Borrower's Page
Ryerson University requires the signatures of all persons using or photocopying this thesis. Please sign below, and give address and date.

Name

Signature

Address

Date

in

Synchronous Generator Excitation Control Based On Model Predictive Control Master of Applied Science 2005 Qingxiang Jin Electrical and Computer Engineering Ryerson University, Canada

ABSTRACT

This thesis research has designed and developed an optimal predictive excitation control, named the Model Predictive Excitation Control (MPEC), for utility generators. Four

significant results are achieved: First, the MPEC has been designed and has significantly improved the classical model predictive control and is much simpler and computationally efficient. Second, the MPEC simulation program and results have been accomplished, and study cases have demonstrated the effectiveness of the MPEC. Third, the Modified classical model predictive control procedure has been formulated to correct a timing error such that the controlling input for the present time step is re-written as that for the next time step. Fourth, the MPEC optimization formulation and procedure has been developed for the generator control with only two substation-ready-available measurements which are the generator terminal voltage and speed.

IV

Acknowledgement

The author would like to express his deep gratitude to his supervisor Dr. Richard W.Y. Cheung, Professor for his expert supervision. The author highly appreciates the valuable advices, guidance, encouragement, and financial support from Dr. Cheung through this thesis research.

The author also wishes to thank Professors B. Wu and D. Xu for their great help and support.

The author would like to convey the warmest thanks to his family and friends, especially his wife Hongli, for their support and encouragement.

Contents
Chapter 1 Introduction 1

1.1 Motivation 1.2 Introduction of Generator Excitation Control 1.3 Thesis Objectives 1.4 Organization of this thesis

1 2 4 5

Chapter 2

Study of Generator Excitation Control and Basic Modelling of Generator and Network 7

2.1 Review of power system generator excitation control 2.2 Basic model for power system synchronous generator 2.2.1 Generator model in abc phase reference 2.2.2 dqO transformation 2.2.3 Per-Unit Model for Generator Excitation Control Design 2.3 Generator equivalent circuits in d-axis and q-axis 2.3.1 6 -order model with damper windings 2.3.2 3-order model with no damper winding 2.4 Network model for excitation control design and evaluation 2.5 Model for generator saturation effects 2.6 Excitation system and speed governor system 2.7 Formulation for computer simulation 2.7.1 Obtaining initial values 2.7.2 Network equations 2.7.3 Simulation steps 2.8 Concluding Remarks

9 13 13 16 19 21 21 24 24 27 29 30 31 32 32
34

VI

Chapter 3

Model Predictive Control: Concept and Formulation

37

3.1 Model predictive control 3.2 Formulation of Prediction Model 3.3 Formulation of Performance Index 3.4 Formulation of Controlling Input through Optimization 3.5 Concluding Remarks

38 41
45

47
49

Chapter 4

Model Predictive Excitation Control (MPEC)

51

4.1 Basic Procedure for Modified Standard Model Predictive Control 4.2 MPEC Design Formulation I 4.2.1 Selection of controlled-system output and controlling input variables 4.2.2 Selection of state equation and state variables 4.2.3 Selection of control optimizing variables 4.3 MPEC Design Formulation II 4.3.1 Perturbed variables formulation 4.3.2 Optimizing variables in terms of state variables and references 4.3.3 Optimizing variables in vector form 4.4 MPEC Design Formulation El 4.5 Concluding Remarks

52 53 54 55 56 57 57 59 61 61 62

Chapter 5

MPEC Design Analysis

67

5.1 Computer Simulation Platform for MPEC Design Analysis 5.2 Case Studies for evaluating the performance of the MPEC 5.3 Self-tuning Strategy 5.3.1 Power system characteristics 5.3.2 Conflict of terminal voltage regulation and oscillation damping 5.3.3 Self-turning strategy

69 71 75 75 77 79

vn

5.4 Weight coefficients self-turning

.

^

j-iv

' .h i

82 82 84 87 91

5.4.1 Choosing weight coefficients by the trial and error method 5.4.2 Weight coefficients self-turning algorithm 5.4.3 Verifications by the computer simulation 5.5 Concluding Remarks

Chapter 6

Conclusion

93

6 .1 Major Research Work Completed

94 96 97

6.2 Major Research Contributions 6.3 Future Work

Bibliography

99

Appendix I Per unit Appendix n Derivation of some equations Appendix in The generator parameters Appendix IV Matlab codes for the MPEC simulation

103 107 123 124

vm

Figure List
Figure 2.1 Block diagram for the AVR and PSS excitation control system Figure 2.2 A typical synchronous generator model Figure 2.3 Equivalent circuits of the synchronous generator with three dampers Figure 2.4 Equivalent circuits of the synchronous generator without dampers Figure 2.5 Connection of a generator to an equivalent power system network Figure 2.6 Phasor diagram of a generator connected to a power system network Figure 2.7 Representation of saturation effects Figure 2.8 Block diagram of the excitation system Figure 2.9 Block diagram of the speed governor and turbine system Figure 2.10 Flow chart of digital simulation Figure 3.1 Block diagram of the model predictive control Figure 3.2 The prediction process of the MPC Figure 5.1 A typical power system configuration for excitation control study Figure 5.2 Case study I: Simulation results for Disturbance 1 Figure 5.3 Case study 2: Simulation results for Disturbance H Figure 5.4 Case study 3: Simulation results for Disturbance HI Figure 5.5 Case study 4: Simulation results for Disturbance IV Figure 5.6 Simulation results for Case study 5 Figure 5.7 Changes of coefficients k2 and k4 with a large disturbance 10 15 23 24 25 27 28 29 30 34 41 45 69 72 73 74 75 77 78

Figure 5.8 Responses of rotor speed, toque and terminal voltage with a large disturbance 79 Figure 5.9 Simulation results for Case study 6 81

Figure 5.10 Scheme of the predictive excitation control system with weights self-turning 82 Figure 5.11 Simulation results Figure 5.12 Simulation results for Case study 7(1) for Case study 7 (2) 83 84 87
88

Figure 5.13 Weights turning algorithm Figure 5.14 Simulation results Figure 5.15 Simulation results Figure 5.16 Simulation results for Case study 8 for Case study 9 for Case study 10

89 90

IX

Figure An. 1. Phasor diagram of V it, Ve and// Figure AÜ.2. Phasor diagram for the terminal voltage and air-gap voltage Figure AII.3. Phasor diagram of V/, It and componentsat the d-axis and q-axis Figure AIU. 1. A generator to a power system

107 108 110 123

List of Tables
Table 5.1 Parameter values for excitation control study 70 123

Table AIU. 1. The parameters of the generator connected to a power system

Chapter 1

Introduction

1.1

Motivation

The electricity power system is often subjected to various disturbances, caused by for example, fault activating, capacitor switching, large load changing, transmission line switching, etc. These disturbances, if not properly handled, can cause stability problems on the power system. With appropriate operations on power system controls such as correct circuit breaker operations and proper generator excitation controls, the disturbed power system can either regain the pre-disturbance operating state or reach a new stable operating state after the disturbances. This thesis deals with the design of an optimal generator

excitation control for enhancement of the stability of the power system, particularly after the power system has been subjected to sever disturbances such as a three-phase fault occurring on or near the generator bus.

During the dynamic process in which the power system changes from one operating state to another after disturbances, the generator voltage and generator speed may operate in a low frequency oscillation. As a standard practice, the generator terminal voltage would be maintained within ± 5 % of its rated voltage, the generator speed should be controlled within ± 0 .2 % of its rated speed and kept it nearly constant, and if there is any generator speed oscillation that should be damped as soon as possible. would result in overvoltages or undervoltages. problems. Poor generator excitation control

The overvoltage usually causes sever

For example, the performance of some electric equipment could be considerably

affected by the supply voltage changing out of the ±10% range. Similarly, the undervoltage

could cause problems too, for a simple example a light bulb of 100 W will operate at about 80 W when the supply voltage drops by 10% as the power consumed by the light bulb varies with the square of its supply voltage.

The problems of frequency oscillation, overvoltage, and undervoltage, etc. caused by disturbances occurred on the power system are investigated in this research.

1.2

Introduction of Generator Excitation Control

An exhaustive investigation is carried out in this thesis research on the control of power system generator excitation for enhancement of the power system stability. The basic function of an excitation system is to provide direct current to the synchronous generator field winding. Excitation controls have functions of both adjusting voltage and damping The following describes the cause of power

oscillation by controlling the field voltage.

system oscillations, the need for generator excitation control, the conventional excitation controls, and the modern digital controls.

The power system generator terminal voltage could drop substantially during a large disturbance such as a three-phase fault occurring on or near the generator bus. During the fault, the flow of the electrical power to the power system is interrupted, and the generator rotor speed is accelerated by the input mechanical power. The protection circuit in the power system will normally operate to clear the fault. The generator is then reconnected to the power system and recovers the power supply to the system. This recovery often results in some post-fault oscillations caused by the energy stored in the generator rotor during the period of the fault. The damper windings on the generator rotors can be used to control these oscillations. However increasing the damper windings is costive when designing and making the generator. The generator excitation control provides, in general, a better control in terms of cost and control effectiveness.

One classical generator excitation control is the automatic voltage regulator that controls the

generator terminal voltage. This type of regulator normally increases the field voltage to quickly recover the terminal voltage to its pre-fault level. Such a fast recovery of the

generator terminal voltage will impose a negative effect on the damping of the post-fault oscillation, because the oscillating torque that causes the oscillation increases relatively with the terminal voltage. With addition of a power system stabilizer to the automatic voltage regulator, this combined generator excitation control, if proper designed, could eliminate any negative effects on the damping of the post-fault oscillation. However, this combined control has drawbacks [1-4]. The regulator and the stabilizer are usually designed separately. The regulator is designed to meet the required voltage regulation performance and the stabilizer is designed to damp the oscillations. The coordination of two goals often has some problems when operation conditions change.

As the modem digital control techniques are replacing the classical analog control techniques, increasing number of controllers are designed and implemented based on new digital signal processing (DSP) technology, such as DSP-based controllers with high precision sensors. Comparing with analog controllers, the DSP-based technology has outstanding performance in terms of reliability, accuracy, and implementation.

Various modem control techniques have been proposed for the design of the excitation controllers such as the optimal control, adaptive control, artificial intelligent control, fuzzy control, etc.[5]. A linear optimal excitation controller was designed to minimize the system state variation, so that it worked for both voltage and speed deviations [6 ], The design focus was on formulating the performance index. The optimal design procedure was to minimize the performance index to get the optimal control. Comparing with stabilizers, the

compensation blocks was not needed and a wider band of frequencies was obtained [7]. However, based on linearization at a specific operating point, this controller cannot provide a good response when the operating condition changed widely. The adaptive controller can modify performance of the controller in response to changes in the dynamics of the process and in the characteristics of disturbances. Normally the parameters of the conventional

controllers such as fixed gain, lead lag and PID, are determined off-line at a nominal

operating point to give good performance. However, the controller dynamic response may be unsatisfied when the operating point changes. Adaptive controller can change its parameters to the new operating condition according pre-designed rules, so that adaptive controllers can work well over a large operating range, but it is time consumption for real-time system identification [8 ]. These controllers cannot be used for fast on-line control.

New techniques such as fuzzy logic and artificial neural networks have been used in power system applications. Some new excitation controllers based on artificial neural networks were claimed to be effective for different operating points, but they required complex algorithms and a long time for training neural nets [9]. Fuzzy logic controllers have been used in design power system stabilizers [10]. This type of controllers does not require any kind of computational complexity, but it always needs a right off-line design.

The findings from this exhaustive investigation on the generator excitation controls have initiated the focus of this thesis research that leads to the development of the MPEC, an optimal generator excitation control.

1.3

Thesis Objectives

The objective of this thesis research is to design and analysis an optimal control of the generator excitation based on the model predictive control, a modem digital control technique. This thesis research has three targets:

Researching an effective real-time control of the power system generator excitation.

·

Assessing the correct application of the model predictive control.

Designing and analyzing an optimal control of the generator excitation for enhancement of the power system stability, particularly after the power system is subjected to sever disturbances such as a three-phase fault occurring on or near the

generator bus.

1.4

Organization of This Thesis

The following provides an outline of this thesis.

Chapter 2

presents an exclusive review of the cause of power system oscillation, the need for generator excitation control, the classical automatic voltage regulator with addition of power system stabilizer, the modern digital control techniques that include the adaptive control, fuzzy logic control, artificial neural network control, and the predictive control. This chapter presents the modelling of

generator, power system network, excitation system, and turbine governor system for the design of an optimal excitation control in this thesis

Chapter 3

presents the basic model predictive control that forms the base for the optimal predictive control designed in this thesis research. This chapter shows that the basic model predictive control simply consisting of two key components: one for system prediction and one for control optimization. First, the system

prediction is formed using the state equation of the controlled system that is the power system with the generator being considered in this thesis research. Second, the control optimization is formed using the optimal predictive control process.

Chapter 4

presents the MPEC design and formulation.

This chapter illustrates that the

MPEC, the core development in this thesis research, has made substantial improvement upon the standard model predictive control. This chapter shows that the MPEC is a simpler and computationally efficient control.

Chapter 5

presents the computer simulations of the MPEC design. This chapter illustrates the effectiveness of the MPEC design for typical power system conditions.

Chapter 6

presents the conclusion of this thesis.

Chapter 2

Generator Excitation Control and Basic Modelling of Generator and Network

This chapter first presents a review of the causes of power system oscillations, the need for generator excitation control, the classical automatic voltage regulator with addition of power system stabilizer, the modern digital control techniques that include the adaptive control, fuzzy logic control, and artificial neural network control. Finally the predictive control is introduced.

Second, this chapter presents an efficient generator model for the excitation control design and evaluation. This model is power invariant with respect to the phase reference and the well-known Park's dqO reference to simplify the design formulation and evaluation.

Third, this chapter presents a simple power system network model developed in this thesis using a straightforward network equivalent circuit approach. This network model that has been successfully used for the generator excitation control design eliminates the limitations in the standard approach using a single generator-infinite bus configuration.

Fourth, this chapter presents a simple formulation for modeling the effect of the generator saturation that is included in the simulation models developed for evaluation of the effectiveness of the optimal excitation control designed in this thesis. This is needed

particularly for assessing the control performance right after a sever disturbance such as a three-phase fault in the power system near the generator bus when the generator excitation is operating at its high level.

Fifth, this chapter presents a second-order linear model for the hydraulic turbine and speed governor control. This control is used to improve long-term stability performance of the generator in addition to the excitation control. This chapter also presents the steps of

computer simulations for verifying the design and the findings in this thesis research.

The following outlines the sections in this chapter.

Section 2.1 presents a review of the cause of power system oscillation, the need for generator excitation control, the classical and the modem control techniques for the design of power system generator excitation control.

Section 2.2 presents a power invariant generator phase model and dqO model that form the base for the generator excitation control design and evaluation.

Section 2.3 presents a 3-order generator model without any damper windings and a 6 -order generator model that includes three damper windings. equivalent circuits are given. Their corresponding

Section 2.4 presents a simple equivalent network model for the power system network that the generator being studied is connected to.

Section 2.5 presents the modeling of the generator saturation effects for the accurate assessment of the design developed in this thesis particularly for the generator operating at high excitation levels.

Section 2.6 presents the generator excitation system model and the turbine governor system model.

Section 2.7 presents the steps for computer simulations for evaluating the design and the findings in this thesis research.

Section 2.8 presents the concluding remarks of this chapter.

2.1

Review of Power System Generator Excitation Control

This section presents the findings of an exhaustive investigation carried out in this thesis research on the control of power system generator excitation for enhancement of the power system stability. The basic function of an excitation system is to provide direct current to the synchronous generator field winding. Excitation controls have functions of both adjusting voltage and damping oscillation by controlling the field voltage.

The following describes the cause of power system oscillation, the need for generator excitation control, the automatic voltage regulator (AVR), power system stabilizer, modem digital control techniques, adaptive control, fuzzy logic control, and artificial neural network control. Finally the predictive control is introduced.

(a)

Cause o f power system oscillation and need fo r generator excitation control

The terminal voltage of the power system generator could be very low during a large disturbance such as a three-phase fault occurring on or near the generator bus. During the fault, the flow of the electrical power to the power system is interrupted, and the generator rotor speed is advanced by the input mechanical power. After the protection circuit has

cleared the fault, the generator is reconnected to the power system and recovers the power supply to the system. Very often this recovery results in some kind of post-fault oscillations caused by the energy stored in the advancement of the generator rotor during the period of the fault. The damper windings on the generator rotors can be used to control the oscillation, but this method is very expensive. Compared with damper windings, the generator excitation control provides, in general, a better alternative in terms of cost and control effectiveness.

(b)

Automatic Voltage Regulator fo r Generator Excitation Control

One classical generator excitation control is the AVR that regulates the terminal voltage of the generator based on the terminal voltage feedback. The AVR normally increases the field voltage to quickly recover the terminal voltage to its pre-fault level. Such a fast recovery of the generator terminal voltage will impose a negative effect on the damping of the post-fault oscillation, because the oscillating torque that causes and maintains the oscillation increases relatively with the terminal voltage.

(c)

Power System Stabilizer

With addition of a power system stabilizer (PSS) as a supplementary controller to the AVR, this combined generator excitation control, if proper designed, could eliminate any negative effects on the damping of the post-fault oscillation. Figure 2.1 shows a block diagram of the combined AVR and PSS excitation control.

PSS Compensation Washout Gain

Generator
re f

AVR

Figure 2.1 : Block diagram for the AVR and PSS excitation control system

The control signal for the PSS is either the speed deviation (AcoA, or the electric power (AP), or the system frequency (Af) as additional feedback signals for introducing a damping torque control component. The speed signal is the most commonly used. In general, the PSS

consists of three blocks: a phase compensation block, a signal washout block, and a gain block. The phase compensation block provides the appropriate phase-lead characteristic to

10

compensate for the phase lag between the exciter input and the generator electrical torque. The signal washout block serves as a high-pass filter, with the time constant high enough to allow signals associated with oscillations in amount of damping introduced by the PSS. to pass unchanged. The gain determines the The stabilizer can produce a component of

electrical torque in phase with the rotor speed deviation. Therefore, those oscillations relative to the rotor speed can be detected and damped by the PSS. The power system dynamic performance is improved by the damping of post-fault oscillations.

The PSS is designed based on the model of a single machine to an infinite bus system under a specific operating condition. This method is commonly used by industry till today for

damping the oscillations. However, it has the following drawbacks:

· The AVR and PSS are usually designed separately. The AVR is designed to meet the required voltage regulation performance and the PSS is designed to damp the oscillations. The coordination of two goals has some problems when operation conditions change.

· The PSS, which is designed for a narrow band of oscillating frequencies, cannot provide a total satisfactory damping when the oscillation frequency changes.

(d)

M odem digital control techniques fo r generator excitation control

As the modem digital control techniques are replacing the classical analog control techniques, increasing number of controllers are designed and implemented based on new digital signal processing (DSP) technology, such as DSP-based controllers with high precision sensors. Comparing with difficulty for maintaining the accuracy of analog controllers, the DSP-based technology has outstanding performance in terms of reliability, accuracy, and

implementation.

11

For overcoming the drawbacks in the conventional excitation control, various modem control techniques have been proposed for the design of the excitation controllers such as the optimal control, adaptive control, artificial intelligent control, fuzzy control, etc.

A linear optimal excitation controller was designed to minimize the system state variation, so that it worked for both voltage and speed deviations. The design focus was on formulating the performance index. The optimal design procedure was to minimize the performance index to get the optimal eontrol. Comparing with the PSS, the compensation blocks was not needed and a wider band of frequencies was obtained. However, because of based on

linearization at a specific operating point, this controller cannot provide a good response when the operating condition changed widely.

(e)

Adaptive control, fuzzy logic control, and artificial neural network control

The adaptive controller can modify performance of the controller in response to changes in the dynamics of the process and in the characteristics of disturbances. Normally the

parameters of the conventional controllers such as fixed gain, lead lag and PID, are determined off-line at a nominal operating point to give good performance. However, the controller dynamic response may be unsatisfied when the operating point changes. Adaptive controller can change its parameters to the new operating condition according pre-designed rules, so that adaptive controllers can work well over a large operating range, but it is time consumption for real-time system identification. These controllers cannot be used for fast on line control.

New techniques such as fuzzy logic and artificial neural networks have been used in power system applications. Some new excitation controllers based on artificial neural networks

were claimed to be effective for different operating points, but they required complex algorithms and a long time for training neural nets. Fuzzy logic controllers have been used in design power system stabilizers. This type of controllers does not require any kind of

computational complexity, but it always needs a right off-line design.

12

(f)

Predictive control versus conventional PSS

The conventional PSS mainly depends on the feedback control theory such as PI or lead-lag control. These feedback controllers act on the past states of the controlled system. However, the new predictive control considers both the past situation and the changing of the system in a finite future time horizon. Predictive control is one of only a few advanced control methods used successfully in industrial control applications.

2.2

Basic Model for Power System Synchronous Generator

For the power system application, a typical synchronous generator consists of a three-phase winding on the stator, and a field winding together with one or two damper windings on the rotor. The generator models in the phase "a 6 c" variables and in the synchronous-rotating variables are presented in this section.

2.2.1

Generator model in abc phase reference

As a standard practice, the magnetic axis of the field winding is defined as the rotor direct axis (d-axis), and another axis at a position of 90 electrical degrees from the field winding magnetic axis is defined as the rotor quadrature axis (q-axis). Figure 2.2 shows a simplified circuit model for a generator used in the electricity power system, where the generator stator has three windings in the three-phase axes, and its rotor has one field winding and one damper winding in the d-axis and two damper windings in the q-axis. Based on the reference direction defined in Figure 2.2, the generator flux-current relationship can be written in the form of;

¥ a b cs

' 4 A r

4 4

/ .

^abcs ^dqr

( 2 . 1)

13

where y/^bcs^iWa ¥b
¥dcr^\¥fd ¥\d

¥cY
¥\q ¥i,\

is the 3-phase stator winding flux linkage vector, is the rotor winding flux linkage vector, is the 3-phase stator winding current vector,

^abcs ~ \fa ^b
^dqr~\fd hd

Y
hq hqÏ

is the rotor winding current vector,

^a a L, -- ^ha ^ca

^ah ^ac ^hh ^bc ^cb ^cc is phase a self inductance, is the stator winding inductance matrix.

kb = Kao + 4 .2

COS

2{9 -I n i'S )

is phase b self inductance, is phase c self inductance, is phase a to phase b mutual inductance,

kc = 4 .0 + 4 .2 cos 2(^ + 2;r / 3)
kb

= 4 = ~4«) - 4*2 c o s ^ + ;^/ 3)

kc -

L - " 4fco " 4fc2 cos(2^ - n 13) is phase a to phase c mutual inductance,
kb

kc

-

= " 4*0 " 4*2 cos(20 - n)

is phase b to phase c mutual inductance,

6 is the electrical angle between the magnetic axis of the phase a and the magnetic axis of the field winding. ^ffd ^f\d 4 w k\d
0 0 0

0 0

=

^

klq

A2 q 4 :,

is rotor winding inductance matrix.

where Lÿd is self inductance of the field winding, l^iid, Liiq and are self inductances of the damper windings at the d-axis

and the q-axis respectively. Lfid is the mutual inductances between the field winding and the damper winding in the d-axis, and L]2q is the mutual inductances between two damper windings in the q-axis. The mutual inductances between stator and rotor windings are.

14

LaijCOSd ^sr ~ L^faCos{0-27T/3) L,,,^cos(^-2;r/3) L^fd cos(g + 2 n ! 3) L^xd cos(g+ 2;r / 3)

-L ,, 2, sin 0 -L^xq -L^,^sin(^-2;r/3) -- L^2q sin(^--2nl3) ~L,,2q{0 + 2Jtl3) L^Xq sin(0+2;r/3)

where La/d, Laid, Laiq and Lajq are the peak mutual inductances between the stator winding and rotor windings.

d-axis

~o

0 "

a-axis
q-axis Stator Rotor

Figure 2.2 : A typical synchronous generator model

The generator terminal voltages can be written as;

^abcs
_

Rs
_

0

~ ^abcs + P

V abcs ¥dqr _

(2 .2)

^dqr

0

where p is differential operator d/dt,
^ abcs ~ \?a

1
0 0

is the three-phase stator winding voltage vector, is the rotor winding voltage vector with the short-circuited damper windings,

^dqr^i^fd

of

R^^diag[R^

R,

R,]

is the three-phase stator winding resistance matrix.

15

R^=diag[Rf,

7?,^ i?,,

is the rotor winding resistance matrix.

Equation (2.2), together with (2.1), is the typical generator mathematical phase model that can be used to design the generator control and to analyze the generator performance. However as shown in (2.1), the stator winding inductances Lgand the mutual inductances Lgr between the stator and the field winding are varying with the rotor position 6, and therefore this varying parameter makes the computation of the generator phase model difficult. On the other hand, the computation can be greatly simplified if the generator model can be expressed in a reference frame rotating with respect to the rotor. The modeling of the generator in the rotating reference frame is discussed in the following.

2.2.2

dqO transformation

In order to simplify the computation of (2.1), the stator currents and voltages can be transformed into two sets of rotating orthogonal variables. One set aligns with the d-axis defined along the magnetic axis of the generator field winding, and the other set aligns with the q-axis defined at 90 electrical degrees from the d-axis [15]. This transformation is known as the Park's dqO transformation. The following matrices can be used for the transformation.

cos^

cosf#-

cos(#+-- 3 -sin(#+--
3

C O S0

-sin0

I/V 2

P = J - -sin# -sinf#I/V 2 I/V 2

c o s ( d - ^ ) - s m ( 6 - ^ ) I/V 2 (2.3) I tt 2 7 T c o s (6 + ^ ) -sin(<9-t-^ ) l/^|2

I/V 2

The coefficient of the matrices is particularly chosen to make the expression of the generator electrical output to be power invariant for both abc phase variables and dqO variables. This simplifies the generator per-unit model, to be shown in the next section, for the design of the excitation control.

16

The above matrices are used to transform the abc phase variables of the stator flux linkage, voltage and current in dqO variables as follows:

abcs

^dqOs ^dqO s

^^abcs ^^ahcs

(2.4)

where Vf,^os=[Wd edqOs=[^d

¥q ^q

is the dqO stator flux linkage vector, is the dqO stator voltage vector, is the dqO stator current vector.

The generator flux-current relationship of (2.1) can be expressed in dqO variables using (2.3) and (2.4) as follows:

¥dqO s W dqr _

P L ,P '

P k r

"^dqOs
^dqr

(2 5)

. L lP

'

A .

pQ fd

where F L ,, = ,j --

0 0

Aid 0 0 L.

0 " Ai<j 0 I^]

0
- h l q

0

-I

A/d Aid 0 0

0 0
~ ^ a \g ~ h l q

0 0 0 0

PL,p-^=diag[La
L d = L .'aaO
L' qq = 4 ` ` aaQ

^abO ^abO

^^aal ^ 2 ^^aa2

/2

\j-` d --A + Ad L q= L ,+ A ,

·^0 " ^aaO

where Ld, Lq, and Lg are commonly defined as the d-axis inductance, q-axis inductance and zero-sequence inductance respectively. Li is the leakage inductance, and Lad and Laq are the mutual inductances associated with the air-gap leakage flux linkages due to id and iq respectively.
17

Equation (2.5) shows that with the dqO transformation, all position 6-varying inductances in the original generator equation of (2.1) are eliminated. In addition, it clearly shows that the two axes are decoupled such that current in the d-axis produces only d-axis flux and the qaxis current produces only the q-axis flux. Therefore the dqO transformation makes the analysis of the synchronous generator simple.

Similarly with the dqO transformation, the stator voltage equation (2.2) becomes

+ Pp(P''¥d,0. ) =
=

+ PP''P¥d,Os + P( PP )¥d,Os
¥d

C2.6)

-^dqO sP ,

+

P ¥ d q 0 .s

+

[~ ¥ q

where cOr=d6/dt=27ife\ectncai rad/s. This equation is expressed in detail as follows.

'Pa

0
Ra

0 0
Ra

0 0 0
R
m

0 0 0 0
R^ d

0 0 0 0 0
R^d

0 " 0 0 0 0 0

-id - i .

> /
¥ d

0 «0
^fd

0 = 0 0 0 0

0 0 0 0 0

¥0
ifd ild

0 0 0 0 0 (17)

0 0 0 0

+P

¥fd ¥ u

0 0 0

0 0 0

0 0

0

-'29

_

¥2q_

The zero-sequence component in (2.5) and (2.7) can be eliminated for the stability analysis of a power system with balanced circuits, and the component of py/dqOs in (2.6) which is small and decays fast in post-disturbance can also be eliminated to simplify the analysis of the generator stability and the design of the generator control. equation that is simplified from (2.7). This leads to the following

K = -P Jd-^r¥q
(28)

18

where cO r is the generator rotor speed in electrical radians per second.

The three-phase

generator terminal power can be calculated from the terminal voltages and currents as below:

[ P ,= V ,+ e ,i,

The internal electromagnetic power Pg produced by the generator can be obtained from the generator terminal power plus the losses on the stator winding resistance, and can be expressed in terms of flux linkages by substituting (2.8) into (2.9) as below:

P e = P t + (i d + i l ) K

= G ) / y^d iq - ¥ q id )

(2 -10 )

The electric torque can be obtained from (2.10) by dividing the rotor speed as follows:

Te=Pel0)^ch^0)^(¥diq-¥qid)l03^ech=^p(¥diq-¥qid)i^

(2 . 11)

where com ech is the rotor speed in mechanical radians per second, and rip is the number of poles.

2.2.3

Per-unit model for generator excitation control design

For the power system stability analysis, it is convenient to use a per-unit system to normalize system equations. Compared with using physical units, the per-unit normalization can simplify the system equations and make them less stiff to solve that reduces their computational effort. The following defines a per-unit model for the generator excitation control design and evaluation.

(a)

Simplifications fo r per unit model

19

To obtain a computationally efficient per-unit model for the power system generator, the first simplification is to define a per-unit system such that the mutual inductances, between the stator and rotor windings with respect to the stator side and the rotor side at each axis, are to be equal in per unit, that is:

^ad - ^afd ~^a\d
^ a q - ^ a \ q lq

^

The detail for achieving the above per unit relationship is given in Appendix I.

The second simplification, to obtain a computationally efficient per-unit model for the generator, is to define the torque of (2.11) in per unit as below. The detail is given in Appendix I.

Te=¥d^q-¥qid

(2.13)

The third simplifieation is to neglect a small variation of «rby setting it to be 1 in the per unit formulation of (2.8) as below. The detail is given in Appendix I.

(b)

Per unit model equations

The superbar notation is dropped for writing the per-unit equations in a simple form in this thesis, since all variables and parameters are in per unit except time t in seconds. Therefore, equation (2.7) can be written as:

20

«d = - ¥ q - R J d e ,= ¥ d -R J , P¥fd =^o(^fd -^fd^fd) P¥rd=-^oRidhd P¥ig = [P¥2,=-(OoR2gÎ2g

.

where oeo= 2nfbase=i'^l electrical rad/s. The detail is given in Appendix I

Note that the per-unit formulation of (2.15) provides the mathematical relationships, first for the generator terminal voltage, stator flux and terminal current in dq reference and, second for the change of the generator rotor flux in real time, the damping current, and the excitation voltage and current in dq reference. The first mathematical relationship given in the first two equations of (2.15) is used to connect the generator model to the power system network model for computer simulations of various power system disturbances. The second

mathematical relationship given in the third equation of (2.15) is the key equation for the generator excitation control, and the remaining equations in (2.15) is used for the study of the effects of damping on the generator control.

The rotor motion equation that represents the mechanical characteristics of a synchronous generator and the unbalance between the electromagnetic torque and the mechanical torque on the generator is given below;

\pAco,= (T^-T^-K [)A o},)/2H
\p S -- coq A c O j.

Ç l\6 )

where

= ÿï^i^ -Wqh is generator electrical torque, T,, is mechanical torque in pu, Acür is change of rotor angular velocity, 6 is the rotor angular position, H is the moment of inertia in second, and K d is the damping factor.

21

2.3

Generator Equivalent Circuits in d-axis and q-axis

The use of equivalent circuits is a common method to provide a visual representation of the generator model. Both the standard generator model with 3 damper windings and the

simplified generator model without any damper windings are presented in this section. The generator model without damper winding is used for simplifying the design of the generator excitation control. The generator with 3 damper windings is used in computer simulations for accurate assessment of the excitation control design developed in this thesis research.

2.3.1

6-order model with damper windings

The mutual inductance between the damper winding at d-axis and field winding, Lfid can be determined using the d-axis air-gap flux linkages, and the value is close to Lad- Similarly, the mutual inductance between the two damper windings at q-axis, L^q is approximately equal to Laq. For power system stability study, it generally assumes Lfjd=Lad and Li 2q=Laq, and the self inductances Lffd, Ljjd, L//^and Lz2q are split into leakage inductance and mutual inductance as below [1].

^f\d - Kd

(2.17) K\q ~ Kq Kq

Klq ~ K q ~^Kq

Using (2.17), all the flux linkages in the generator can be assembled together as:

22

V / W fd ¥\d 1 ^ 2 ,_

0 4 . hd '4 0 4 0 0 4 . 0 ^ffd hd 4 . 0 hd hd 0 4q 0 0 0 4q 0 0

0 hq 0 0

0' 4q 0 0 hq hq hïq_

-h 4 4 4
(2 . 18)

Equations (2.15), (2.16) and (2.18) forms the basic generator model in dqO frame, which is commonly used in the commercial software for utility applications. With these equations, the equivalent circuits expressing the relationship between flux linkages and currents can be built as shown in Figure 2.3.

In Figure 2.3, the d-axis flux linkage y/d consists of the leakage flux linkage produced by current id through L/, and the air-gap flux linkage y/ad produced by current id through LadSimilarly, the q-axis flux linkage y/q consists of the leakage flux linkage produced by current iq through L/, and the air-gap flux linkage y/aq produced by current iq through Laq-

L,

o +

rrm _ < -- id + I

<lid
5 L ad -j- ^k 1 r + f pvfd --

V d

V ad

PYld

R id

L, .rVYYX H` Iq L

Y aq

r

1
R |q pV |/2q

Laq

p v |/,q -----

Figure 2.3 : Equivalent circuits of the synchronous generator with three dampers

23

Equations (2.15), (2.16) and (2.18) can be written, based on the equivalent circuits of Figure 2.3, as below.

^d=-V,-Rah pA(0,=(T^-T^-K,Aco^)l2H pS =cO f^A cû ^ PVu PV'i, PWl, ¥ ,= V a ,-iA (2.19) if, hé=Wu-¥a6)IUi \= W ^ -¥ a ,V U ,

The time and angles are expressed in seconds and electrical radians respectively where all other variables are in per unit. Equation (2.19) forms the typical generator model for power system stability analysis. This model consists of 6 differential equations, so that this model is called the 6-order generator model. In this thesis, this model is used for computer

simulations to verify the generator excitation control design.

2.3.2

3-order model with no damper winding

Figure 2.4 shows the equivalent circuits for the generator without damper windings for simplifying the design of the excitation control.

' 4L fd V ad

rYYYV

+

V aq

R fd

Figure 2.4 : Equivalent circuits of the synchronous generator without dampers

24

Without damper windings, the generator model equation (2.19) becomes (2.20). The new model equation (2.20) consists of three differential equations, so that this model is called the 3-order generator model.

pAco^ = { T ^ - T ^ - K pAû)^ ) / 2H p S --ojqA w ^ P¥fd = ~^fd^fd)

^d = ~ ¥ q - P J d

=¥d-l^Jq Vd = Vad - id 4
¥q =¥aq
" ' g A

(2.20)

ifd - i¥fd ~ ¥ad)i ^fd

Neglecting of the damper windings reduces the computational effort and makes the analysis easier with a lower order model, but it introduces some errors. Taking advantages of this simple model is useful for the excitation control design to be shown in later chapters.

2.4

Network Model for Excitation Control Design and Evaluation

The design of an optimal generator excitation control needs to initially establish typical operating conditions for the generator. This thesis research develops a simple power system network model to which the generator is connected. Figure 2.5 shows the network model that is simply a Thevenin equivalent circuit. This equivalent circuit consists of an equivalent voltage source Ve and an equivalent impedance Z e (=Re+Xe). This equivalent circuit can be obtained by running the standard power flow studies on the power system network that the generator is connected to under predefined power system operating conditions. A typical predefined condition at the point of connection is, that the generator terminal voltage V, and power P, are specified, and then the generator current I, is computed. This network model, which though is quite similar to the classical model of a generator-infinite bus configuration used for the power system stability studies, eliminates the limitations imposed by the classical model such as assumptions of constant infinite bus, pre-fixed transmission elements between the generator bus and the infinite bus, etc.

25

Vt

Ve

^
Xe

-- w\/Re

G

Figure 2.5 : Connection of a generator to an equivalent power system network

The equivalent circuit varies corresponding to the power system changes, such as faults occurring, loads switching, and transmission operating. For example, with a three phase fault occurring at the generator bus, the equivalent impedance Ze becomes zero. Various

disturbances can be simulated with the change of the parameters Z e and Ve as to be discussed in later chapters.

In the conventional power system stability study using a single generator-infinite bus model, the voltage magnitude of the infinite bus is always assumed to be constant and the voltage phase angle is often assumed to be zero that is used as the reference in the analysis computation. In the new equivalent circuit model approach, the generator terminal voltage
e is used as reference. As distinguished from the conventional approach, the phase angle Ô

magnitude Ve and phase Ô e of the equivalent circuit voltage is determined by the power system network operations being under studied. The generator rotor angle c 5 , is then

computed from both the generator model and the network model.

A phasor diagram illustrating the operation of a generator connected to a power system network is shown in Figure 2.6. The generator terminal voltage and equivalent network voltage in dq reference can be expressed as:

\V, =ej+jg I = ^Bd + j^Bq
(2.21)

26

where

\ed =V, sin<5;. \^q - V , cos Si =V£sin<5` £ =V e COs S^

are the dq components of V,,

are the dq components of Ve .

A

q-axis

d-axis

Figure 2.6 : Phasor diagram of a generator connected to a power system network

With respect to Figure 2.6, the network voltage and current are related as follows:

( 2 .22)

where I, = id +j iq components, - ^Bd +^E^d ~^E^q \^q = ^Bq + ^E^q + ^ E^d components.

is the generator terminal current in terms of dq

are the dq components of V, in terms of circuit

2.5

Model for Generator Saturation Effects

The effects of the generator magnetic saturation are included in the evaluation of the performance of the excitation control design developed in this thesis. This section develops a simple formulation for the effects of the generator saturation. The assumption used in

27

developing the formulation is that the leakage inductances are assumed to be independent of the iron saturation, since the leakage flux paths are mostly in air gap. With this assumption, the generator saturation can be represented as:

(2.23)

where Ladu and Laqu are the unsaturated values of the mutual inductances Lad and Laq on the daxis and q-axis respectively. K^d and Ksq are the saturation factors that identify the degrees of saturation in the d-axis and q-axis respectively.

In Figure 2.7, Aif/ is defined as the difference between the calculated unsaturated air-gap flux linkage y/cai and the actual saturated air-gap flux linkage y/sat- An exponential function is introduced to describe the characteristics of the generator saturation as follows:

(2.24)

where y/m is the threshold value of saturation, and A^at and Bsat are constants. These values are provided by the generator manufaeturer or can be obtained from the open circuit test on the generator.

ads

M ^cal

Figure 2.7 : Representation of saturation effects

28

A simple method can be used to determine the saturation factor Ksd- First, obtain the air-gap flux at the d-axis ifjad and the air-gap flux at the q-axis from known terminal voltage and

current. Second, calculate the saturated air-gap flux as follows.

=

(2.25)

Third, use (2.24) to calculate Ai//. Fourth, calculate the saturation factor as follows.

= ¥s.,/(¥s.r+^¥)

(2.26)

For the salient pole generator, since the path for the q-axis flux is largely in air, there is no significant variation with Laq. The Ksq can be assumed as 1 per unit for all loading

conditions. For the round rotor generator, there is magnetic saturation in each axis, but the qaxis saturation data is usually not available. Usually, K^q is assumed to be equal to Ksd-

The effect of saturation in the generator excitation winding has been included in the simulation models for the evaluation of the effectiveness of the excitation control designed in this thesis research. This is needed for the accurate assessment of the performance of the excitation control design, particularly for evaluating the controller performance right after a sever disturbance such as a three-phase fault in the power system near the generator when the controller is operating at its maximum level.

2.6

Excitation System and Speed Governor System
The exciter is taken as a

Figure 2.8 shows a simplified generator excitation system.

controllable dc voltage source that supplies power to the field winding. The exciter is simply modelled as a gain with a delay of which the time constant is 7g and the gain is K^. The exciter output is limited between the maximum value Ef,,^ and the minimum value Ef^în-

29

-fmax Excitation Control Control Signal
-fmin

Exciter
Field

1+ 57,

Winding

Figure 2.8 : Block diagram of the excitation system

A second-order linear model of the hydraulic turbine and speed governor is given by:

pG = [Mc+Gn-G]/7g
p 7,, = 2[ G - 7,, - 7> , - G + G ,, ) / 7 , , ] / 7 ,,,

(2.27)

where p = d/dt, and T,,,, G and

ug

are mechanical torque, gate position and governor control and To are the

input respectively. Go is initial value of the gate position at the steady state. water flow time constant and the governor response time constant respectively.

The first equation in (2.27) represents characteristics of the speed governor. governor adjusts the gate position G according to controller input
uq.

The speed

The second equation in

(2.27) represents characteristics of the turbine system. With changes in the gate position G, the turbine system changes the mechanical torque. The speed governor and the turbine

system can be modelled with the block diagram of transfer functions shown in Figure 2.9.

1 I + 7c 5
GO

1+7,^5/2

Figure 2.9 : Block diagram of the speed governor and turbine system

Equation (2.27) can be used as the turbine and governor model for the control design.

30

2.7

Formulation for Computer Simulation

In this section, a detailed simulation formulation is developed for verifying the generator excitation control design. A 6'^-order generator model and a 2"^-order turbine model are used for computer simulations. For verifying the generator excitation control alone, the

mechanical input torque is assumed to be unchanged in the simulation and the six differential equations in (2.19) is eomputed. With consideration of the turbine and speed governor

control, the mechanical torque is determined by solving the two differential equations in (2.27).

2.7.1

O btaining initial values

For the computer simulation, the initial values of the differential equation (2.19), which include < 5 , /)cOr, ijjfd, y^id, H fiq and if/2q, are obtained as the following.

For the generator and the power system network shown in Figure 2.5, with given generator terminal voltage V,, network equivalent voltage Ve, and generator terminal power P,, the initial value of generator power angle < 5 can be obtained. The detailed derivation of the equations is given in Appendix II. The power angle ô by which Ve leads the q-axis can be expressed as,

S = S e +S i =aresin^£/^/y,F£)-i-tan"'[(X^/, cosxp-RJ, sin^)/(% +RJ, cosÿ?+%^/, sinç?)] (2.28)

where 7, is the terminal eurrent of the generator, and (p is the power factor angle at the given operating condition. is reactance of the stator winding at the q-axis. Its numerical value

equals to Lqs in per unit which is saturated value. /,, (p, Lqs and Ô e are calculated in Appendix

n.
Before a disturbance is applied to test the response of the generator excitation control, the generator is assumed to be operating at a steady state. Each state variable has a steady state

31

value, and all time derivatives py/fj, py/jd, py^iq and py/2q are equal to zero, therefore the currents on damper windings ijq and iu are zero, and the flux linkages of damper

windings are equal to the corresponding axis air-gap flux linkages (y/]q=y/2q=W aq and y/jcF^y/ad) in (2.19). From (2.18) and (2.19), the flux linkage, the field current and voltage are obtained.

V fd ~ ^fd (y^ad^^adx ^d ~ Vud^^d )

(2.29)

where

=1/(1/L,,,,+1/L^, + 1 / A J and y/^j =e^+ RJ,+ ijL,.

The electromagnetic torque is calculated by using (2.13). At the steady state, the generator runs at the rated speed, Jcor equals to zero. All initial values are calculated.

2.7.2

Network equations

During the transient process, the currents are solved from the network equations with updated state variables, which include y/fd, y/jd, y/iq, y/iq and S. The currents id and iq are presented in terms of state variables as the following equations. The detailed derivation is given in Appendix H.

\id =[(^E+K)i^d
[4

cosS)~{R^ +K)i^d +gg sin<5)]/[(/?^ +RJ^ +(X^ 4-X^,)(%g + % j] n 30 )
cos(^+(Xg+% j(gj +gg sin^]/[(^g + R j^ +{X^ +%!)]

where

K =^ads(¥fd^Lfd+¥u^^d)
L"ds and L"qs are also called the d-axis sub-transient inductance and the q-axis sub transient inductance respectively, which are given in Appendix H. X"qs and X"qs are reactances corresponding to L",, and 1%^, they are equal to 1",^ and L"qs in per unit.

32

In the simulation process, the mutual inductance Lads and L,,qs are updated at computing every step with the flux linkage changing. With (2.25), the air gap flux ^sat can be obtained, then by (2.23) to (2.26), the mutual inductances are updated for considering the effects of saturation.

2.7.3 Sim ulation steps

Disturbances can be simulated by modifying parameters {Re, Xe and Ve) of the equivalent circuit or changes inputs of the generator (T,,, and Vrej) in Figure 2.5. Due to the disturbance, the terminal voltage and current change instantly, but not the state variables < 5 , cO r and y/fd, etc. e "d and e "q are relative to the state variable y/jd y/jd y/iq and y/2q that cannot change suddenly. For any given disturbance, currents are solved at first, then voltages, flux linkages and torque. When finished algebraic equation solving, differential equations are solved, and state variables S, cO r y/fd y/id Viq and y/2q are updated, then go to solve the algebraic equation with updated
ô,

e"d and

e"q.

The process of simulation is as the following,

1 Input the parameters including all resistance {Ra, Re, Rfd, Rid, Riq and R 2q), reactance and inductance {Xe, Xd, Xq, Xi, Lfd, Ljd, Ljq and l 2 q), constants (inertia H, damping factor Kd and information of saturation) and simulation time {t) and sample time (At). 2 Calculate initial value at steady state by using (2.28) and (2.29). For given operating condition {P,, V, and Ve), we can obtain all the initial values such as current, power angle, exciter input and etc. at steady state, all time derivatives are equal to zero. 3 Check if the network ehanges, such as load varying, faults and transmission line switch on/off. Then modify parameters such as R e, X e, and Ve correspondingly. 4 Compute network equations to obtain currents id and iq by using (2.30), flux linkages y/ad, y/aq, voltages Cd and C q by using (AII.l 1) and (AH. 12). 5 Acquire currents on the rotor by using (2.19) 6 Calculate Ksd and Ksq to update saturated inductance Lads and L,,qs using (2.23).

33

7 8

Obtain the torque Te by using (2.13). Solve the differential equation (2.19) with updated torqueand currents. For turbine governor control, include equation (2.27).

9

Update state variables y/fd, y/id, yJiq, yJiq, and Ô , and calculate e"d,e" qby using (AH.15)

10 Go back 3 and repeat until reaching predefined simulation time.

The fourth-order Runge-Kutta method is used as the solution of the differential equation. During the process of solving the deferential equation (2.19), at every stage (four stages) of per time step (0.01s), the differential equations are solved, and then the updated state variables are used to solve network equations; this updating goes through four stages. The detailed simulation is shown in Figure 2.10.
Input system parameters

Calculate initial values

Network variable changes (operating, faults and etc)

Solving Network algebraic equations at time step

Solving state differential equations to update state variables and Network algebraic equations to update network variables at each integral stage Integral Process

Update all variables

No, t+At Yes End and print results

Figure 2.10 : Flow chart of digital simulation

34

2.8

Concluding Remarks

This chapter has presented an exclusive review of the cause of power system oscillation, the need for generator excitation control, the classical automatic voltage regulator with addition of power system stabilizer, the modem digital control techniques that include the adaptive control, fuzzy logic control, artificial neural network control, and the predictive control.

This chapter has presented the modeling of generator, power system network, excitation system, and turbine governor system for the design of an optimal excitation control in this thesis. A summary is given below:

·

A 3"^^-order generator model prepared for the excitation control design, and a 6`'^-order generator model prepared for the performance evaluation of the optimal predictive control developed in Chapter 3 and Chapter 4.

#

A simple power system network model developed for the generator excitation control design that eliminates the limitations in the standard approach using a single generator-infinite bus configuration.

#

A simple formulation for generator saturation developed for evaluation of the effectiveness of the optimal excitation control designed in this thesis.

35

36

Chapter 3

Model Predictive Control: Concept and Formulation

This chapter presents the fundamental model predictive control that forms the base for the optimal excitation control. Two key components of system prediction and control

optimization are included in the model predictive control. The system prediction is formed by using the system state equation and the control optimization is formed by using the optimal control process.

The control optimization process is implemented by minimizing the least square values in terms of a system performance index. The performance index includes two terms of

deviations of the selected outputs and variations of the inputs of the controlled system. The first term is to minimize the deviations between selected system outputs and their control references. The second term is in an implicit (not obvious) form acted like a classical

negative feedback.

The standard classical formulation for calculating the controlling input does easily cause confusing. According to the standard formulation notation, the value of controlling input at the present time step is calculated from the data at the same time step. Since all the data at the present time step, including the controlling input, are known, it is therefore not possible to calculate, through an optimization process, the already-known data. In the generator

excitation control considered in this thesis research, the controlling input at the present time step is already known and also has been applying to the controlled system. Therefore, this thesis research proposes to re-write the classical predictive control state equation expression.

^'

R Y E H St:', i

LBiWlY

such that the controlling input for the present time step should be re-written as the controlling input for the next time step. This chapter shows the proposed new predictive control state equation.

The following outlines the sections in this chapter.

Section 3.1

presents the concept of the model predictive control. This section describes the algorithm of the fundamental model predictive control that forms the base for the optimal predictive control for the power system generator excitation control designed in this thesis research.

Section 3.2

presents the formulation of the prediction model. This section describes the prediction model of the controlled system, the generator and its connected power network, that is simply the state equation model of the system.

Section 3.3 presents the formulation of the performance index. This section describes the performance index used in the optimal predictive control to determine the controlling input to the controlled system.

Section 3.4

presents the formulation of the controlling input to the controlled system that is the controlling voltage feeding to the excitation winding of the synchronous generator connected to a power system.

Section 3.5

presents the concluding remark of this chapter.

3.1

Model Predictive Control

The fundamental model predictive control is presented, for the optimal excitation predictive control which is designed in this thesis research. The fundamental model predictive control simply consists of two key components; one for system prediction and one for control

38

optimization. The key component for the prediction of the controlled system, that is the power system with the generator being controlled, is formed using the state equation model of the controlled system. The state equation model for the generator and its connected power system has been presented in Chapter 2. The key component for control optimization is formed using the optimal predictive control process. This section is focused on the basic predictive control process.

The basic model predictive control is simply a control optimization process using a form of least square minimization computation in terms of a system performance index. And the performance index is best formed by a set of the squared values that includes two terms: deviations of the selected outputs of the controlled system, and variations of the inputs to the controlled system. The first term is obvious that the optimization process is to minimize the deviations of selected system outputs with respect to their control references. For the power system generator excitation control, the system outputs selected in this thesis research are generator voltage, speed, and acceleration. The second term is in an implicit (not obvious) form that includes the variations of the controlling inputs in the optimization computation acted like a classical negative feedback. The controlling input selected in this thesis research is the generator excitation voltage.

The following discusses the characteristics of the basic model predictive control for application in the power system generator excitation optimal control.

Figure 3.1 shows a block diagram of the model predictive control process. As shown in the figure, the control process consists of three blocks: one for the prediction model of the controlled system, one for the optimal controller, and one for the system to be controlled. The figure can be used to illustrate the algorithm of the model predictive control.

A simple algorithm can be described as follows:

39

1. A prediction model (a set of state equations) of the controlled system is used to predict the system outputs in the next few time intervals based on the outputs, at the present time, measured from the controlled system. In terms of control parameters as shown in Figure3.1, the prediction model is used to produce a set of predicted system outputs, y{t-¥kAt), starting from the present-time measured system output y{t), where kAt represents the next k'^' time interval from the present time t. These predicted outputs can be calculated recursively as represented by y{t+At\t), where t+At\t means the predicted value at the time t+At is calculated based on the value at the time t. For the power system generator excitation control, the predicted system outputs include the generator terminal voltage, speed, and acceleration.

2. An optimal predictive controller is used to determine the controlling input to the controlled system. The determination process is simply an optimization computation in the form of least square minimization in terms of a system performance index J. The value of J is computed as a summation of a set of square values obtained from the deviations of the predicted system outputs from their references, Ae, and the variations of the controlling inputs to the controlled system, Au.

y =^(de^Q de)-t-^(du^R Ju)
1 0

(3.1)

To speed up the process of determining the optimal controlling input to the controlled system, weighting factors, Q and R are added to the summation for J. For the

generator excitation control, the controlling input u is simply the generator excitation voltage.

3. The control optimization process is simply setting the derivative of J in (3.1) to zero and then computing the value of the controlling input u.

40

4. The vector u consists of k controlling input values: u{t-^At), u{t-¥2At), uit+SAt) one for each of the next k intervals selected in the control optimization process. Only the controlling input value of u{t+At) is applied the generator exciter.

r(t+k)

-)-

r(t+k)-y(t+k|t)

> |)
References Deviations

^

Optimal controller (Generator excitation controller)

u(t|t) Input of controlled system Output of optimal controller

Controlled system (Electricity power system) y(t+k|t) Predicted output of controlled system Prediction model Measured system outputs Of controlled system y(t)

Figure 3.1 : Block diagram of the model predictive control

The fbllovying sections present the general formulation of the model predictive control. The formulation provides the base for the design of the power system generator excitation control developed in this thesis research. The model predictive control consists of two key

components: Prediction Model and the Optimal Predictive Controller. Therefore, first the formulation for the prediction model is presented. Second the formulation for the optimal predictive controller is given. Third the formulation for the control algorithm is presented.

3.2

Formulation of Prediction Model

This section presents the formulation of the prediction model. The prediction model of the controlled system, that is the generator and its connected power network, is simply the state equation model of the system. The state equation, consisting of a set of the first-order

differential equations, for the generator has been given in Chapter 2.

41

(a)

State Equation

In general, the state equation of the controlled system can be written in the following form:

x(t) = A,x(t) + B^u{t) y it) = Cx{t) (3.2)

where x is the state vector, y is the output vector, u is the controlling input. At is the state matrix, Bt is the input vector, and C is the output matrix.

(b)

Discrete State Equation

The state equation (3.2) can be expressed in the following discrete-time form, using the firstorder Euler method.

x{k) - [% (A: + 1) - x(Â:)]/At = A^x(k) + BiU{k)

(3.3)

where k = t / At that is defined as the k* step in the predictive control, and At is, the step interval. Therefore from (3.3), the state equation in discrete form can be simplified as:

x(k + l) = Ax{k) +Bu(k) yik) = Cx{k) y ( k + \) ^ C x ( k + \)

(3.4a) (3.4b) (3.4c)

where A = A,At + 1, and B = BfAt.

Equation (3.4a) shows that the system state variables %(A:+1) at the next time step k+1 can be expressed by two components at the present time step k. One component is the state variables x{k) that demonstrate the system process continuality, and the other is the controlling input u{k).

42

(c)

Formulation fo r One-Step Model Prediction Model

The standard way for expressing the one-step model predictive control, based on the discrete state equation of (3.4a) and (3.4c), is as follows:

x (k + l \ k ) - A x i k ) + B u ( k \ k ) y ( k + \ \ k ) = Cx(k + l \ k )

(3.5a) (3.5b)

where x:(/:+l|A:) means the values of x at the time step /c+l is calculated based on the data obtained at the time step k. follows: The computation of the above model can be carried out as

a.

Make the measurements y(k) at the controlled system. Calculate the sate valuables x(k) from y (A :) using (3.4b).

b.

Use the prediction model to calculate x(A:+1) from x(^) and u(k) using (3.4a). Calculate the predicted output y (A:+l) from x(A:+l) using (3.4c).

c.

Use the predictive optimization performance index given in (3.1) to calculate the controlling input u.

(d)

Modification on Standard Model Predictive Control Expression

Point 3 mentioned above for calculating the controlling input u will be further discussed in the following sections. However, u{k\k) in the standard formulation of (3.5a) does easily cause confusing, because according to the notation of k\k means the value of u at the time step k is calculated from the data at the present time step of k. Since all the data at the present time step k, including the controlling input u, are known, it is therefore not possible to calculate, through an optimization process, the already-known data. In this case, the

43

controlling input u at the present time step is already known and also has been applying to the controlled system.

It may not be a surprise that this confusing could exist, because the usual way of solving the state equation is with a given input u to find the value of x. Conversely, in the predictive control, the controlling input for the next time step to the controlled system needs to be predicted, that is this control is always carried out to determine u at the next time step k+l from the present time k.

Therefore, this thesis research proposes to re-write the predictive control state equation expression, such that the u{k\k) in (3.5a) should be re-written as u{k+l\k) as follows:

x(k -fi I &) = Ax{k) -t- Bu{k -fl | &) y(^-l-l|&) = Cx(A;-t-l|/:) (3.6)

where u(k+ 1|A :) means the controlling input to the controlled system, in the case of generator excitation control that is the applied excitation voltage, at the time step ^+1 is determined from the data at the present time k. The equation for the system output y remains the same as (3.5b).

(e)

Formulation fo r N-Step Model Prediction Model

Prior to the formulation of the N-step prediction model, two parameters need to be defined: 1) is defined as the control horizon that means that n,, control inputs are considered in the control optimizing process; 2) N is defined as the prediction horizon that means that jV-stepahead system outputs are predicted. The control horizon is smaller than the prediction

horizon N. These two parameters are used to adjust the control effects.

The prediction process for N-step prediction control is shown in Figure 3.2. The present time step is k and the future time step is k+i (i=l,2...A0. For an example, y (A ;) are the present-time

44

system outputs and y(^+/|A:) are the predicted outputs at time k+i that are calculated at time k. u(k+j\k) (j=0,l... n,,-l) are the future control inputs at time k+j that are calculated at time k.

----- past

Mure

__^
Q
O

^

O

U

Reference trajectory r(k+N) O U e Predicted output varialsfee y(k+N|k)

y(k)

o
1
u(k|k) u(k-1) 1 k 1 1

o

r

Future control variables u(k+n,,-1 |k)

1

1

1

I
1

l

1

l

1

'

1

l

1

l

1
k+N

k-rn,,-l Prediction horizon Control horizon

k-3

k-2

k

Figure 3.2 : The prediction process of the MPC

When the time step > k+Uu, the control inputs remain the same value as u(k+Hu\k). For k < time step < k+Uu, the state variables and system outputs are predicted using the following equations. The derivation of these equations is given in Appendix II

x {k + n^ + l \ k ) = A x (k + n ^^ \k) + Bu{k + n^ -1|A:) y( k +n^ + l \ k ) - C x { k + n ^^ +1|^) (3.7)

For time step > k+N, the state variables and system outputs are predicted as below. The derivation of these equations is given in Appendix II.

x(A: + N \ k ) = A x(k + N - l \ k ) + Bu(k + n ^ - \ \ k ) y( k + N \ k ) ^ C x ( k + N \ k ) (3.8)

Using this prediction model, the system outputs y(k+i\k) (i=l,2...A ) are predicted over the interval time N starting at the instant k. These predicted system outputs are calculated from the measurements y (A :) and the control inputs u(k+j\k) (/=0,1... n«-l).

45

3.3

Formulation of Performance Index

This section presents the formulation of the performance index. The index is used, in the optimal predictive control, to determine the controlling input to the controlled system.

(a)

Formulation o f One-Step Performance Index

The performance index J is computed as a summation of a set of square values obtained from the deviations Ae of the predicted system outputs y from their references r, and the variations Au of the controlling input u to the controlled system. To speed up the process of

determining the optimal controlling input to the controlled system, weighting factors, Q and R are added to the summation for J. For the generator excitation control designed in this thesis research, the controlling input u is simply the generator excitation voltage.

Therefore, the performance index for one-step model predictive control is defined as:

J = Ae^Q^Ae + Au^ R^Au

(3.9)

where Ae = r - y{k-\-\\k) Au{k + \ \ k ) = u{k + \ \ k ) --u{k)

(3.9a) (3.9b)

The above equation is used to compute the controlling input u{k+\\k) for the next time step k+ 1 from the data of the present time step k. The computation is simply, first by m i n i m i z i n g the value of J to determine Au, and second by (3.9b) to calculate u{k+l\k). The process for minimization of J is discussed in the following section.

(b)

Formulation ofN-Step Performance Index

Through the formulation of the N-step performance index is simply an extension of the formulation for the one-step performance index given in (3.9), the detailed derivation

46

however is fairly complex and is provided in Appendix H. The final equation of the N-step performance index is given in the following.

(3.10)

r{k + l) where j g = r{k + 2) r(k + N)_

y(k + l\k ) y(k + 2\k)
-

Au =

u{k 1^) u(k + \ 1k)
-

u (k -l) u(Jc --1) u{k-V)

j { k + N\ k)

_uik+n^ - l | t )

3.4

Formulation of Controlling Input through Optimization

The section presents the formulation of the controlling input to the controlled system that is the controlling voltage feeding to the excitation winding of the synchronous generator connected to a power system. The formulation using predictive control optimization to determine the controlling input u{k+l\k) for the next time step k+l based on the data at the present time step k.

(a)

Formulation o f deviations o f predicted system outputs from references

The controlling input u{k+l\k) is computed through a optimization process using the performance index J. Therefore in order to obtain the formulation for the controlling input, it is necessary to express J in terms of u{k+l\k). However, since 7 is a summation of the

deviations Ae of the predicted system outputs y from their references r, and the variations Au of the controlling input u to the controlled system, it therefore needs to first formulate Ae in terms of u{k + 1|A :) prior to formulate J. This is done in the following.

The deviations Ae of the predicted system outputs y from their references r can be expressed as:

47

Ae=r-y{Jc-\r\\k)

(3 -H )

where the predicted system outputs y{k+ 1|fc) has been expressed in (3.6), as re-given below for convenience:

x{k + 11/:) = A x{k) + Bu{k -fl|A:) y ik + \ \ k) = Cx{k + \ \ k) (3.6)

where u(k+l\k) has been expressed in (3.9b), as re-given below for convenience:

m (^ + 1|A:) = m(A :) + /Jm (â : + 1|/:)

(3.9b)

By substitution of (3.6) and (3.9b) into (3.11), the deviation Ae becomes:

Ae= r-C Ax(k)-C Bu(k)~C BAu(k + 11/t)

(3.12)

Equation (3.12) can be shorten as below:

Ae = E --CBAu(k +\\k ) where E = r-C A x { k )-C B u {k ) (3.13)

(b)

Formulation o f controlling input through optimization

The performance index J for one-step model predictive control has been expressed in (3.9), as given below for convenience:

J = Ae^Q^Ae + Au^ R^Au

(3.9)

By substitution of (3.13) into (3.9), the performance index becomes:

48

J - { E - CBAu{k + l \ k ) f Q,(E - CBAu{k +11A :)) + Au{k +11

/?, A M ()k+ 1 1it) ^

J = E^Q ,E - 2Au{k + l \ k y (CBY Q,E + Au(k + 11A :)'' ((C B /g , (C B ) + /?, )Au(k + 1I&)
= E ^ Q i E - 2 A u { k + 1 j A:)^ G + Au{ k + \ \ k f H A u { k + \ \ k )

where G =

(C B f

,

and//=

(C B )''g ,(C B ) + /?,

( 3 .1 5 )

By conducting a minimization on the performance index 7 of (3.14) such as:

dJ / A u ( k + \ \ k ) ^ 0

( 3 .1 6 )

The result of the minimization from (3.16) on (3.14) is:

Au(k + l \ k ) =

H-'G

(3 .1 7 )

Finally, the formulation, using predictive control optimization to determine the controlling input u(k+l\k) for the next time step k+ l based on the data at the present time step k, can be obtained from (3.17) and (3.9b):

u( k + l \ k ) = u i k ) + Au( k + ] \ k )

( 3 .1 8 )

The above following formulation is derived for the one-step predictive control.

The

formulation for the N-step predictive control is a similar derivation. The details are provided in Appendix II.

3.5

Concluding Remarks

This chapter has presented the fundamental model predictive control. This control forms the base for the optimal predictive control, to be described in Chapter 4, for the power system

49

generator excitation control. This chapter has described the two key components of the fundamental model predictive control that are the system prediction and the control optimization.

This chapter has demonstrated the basic model predictive control that is simply a control optimization process using a form of least square minimization computation in terms of a system performance index. This thesis research has found that the performance index is best formed by a set of the squared values that includes two terms: deviations of the selected outputs of the controlled system, and variations of the controlling inputs to the controlled system. The controlling input selected in this thesis research is the generator excitation voltage.

The following summarizes the procedure for carrying out the optimal model predictive control.

a.

Make the measurements y(k) at the controlled system. Calculate the sate valuables x(k) fromy(&) using (3.4b).

b.

Use the prediction model to calculate x(k+l) from x{k) and u(k) using (3.4a). Calculate the predicted outputy(/:+l) from x(k+l) using (3.4c).

c.

Calculate the components G and H of the deviations Ae of the predicted system outputs y (A+ 1) from their references r using (3.15).

d. Finally, calculate the controlling input u(k+l\k) for the next time step k+l based on the data at the present time step k using the predictive control optimization final equation of (3.18).

50

Chapter 4

Model Predictive Excitation Control (MPEC)

This chapter presents an optimal generator excitation control, named the Model Predictive Excitation Control (MPEC) in this thesis research. This control is a significant further

development upon the modified predictive control concept provided in the previous chapter.

This chapter will illustrate that the MPEC, the core development in this thesis research, has made substantial improvement upon the standard model predictive control. The MPEC is much simpler and computationally efficient because: 1. The MPEC calculates the constants representing the generator and its connected power system only once, as compared to the standard one that requires all the state equations to be calculated for each time step.
2.

Within the MPEC control loop, the only significant computational effort is to calculate a few 3x1 vectors, as compared to the standard one that requires several matrices multiplications to be calculated for each time step. 3, The MPEC has increased practical use since it only requires two practically available measurements, the generator speed and terminal voltage, as compared to the standard one that requires many measurements to calculate the complete system. 4. The MPEC can be well implemented for the real-time control of the power system generator excitation, as compared to the standard one that requires heavy computation effort that prevents it to be a real-time control. 5. The MPEC is superior to other controls, since it has achieved significant improvement upon the standard one, and the standard one has claimed to be better than others.

The following outlines the sections in this chapter.

51

Section 4.1

presents the basic procedure for the modified standard model predictive control, as a base for reference, comparison, and illustration of the core development in this thesis research, the MPEC for generator excitation control design.

Section 4.2

presents the MPEC design formulation, Part /, the selections of the controlled system output variables, controlling input variables, state variables, and optimizing variables, for the objective of serving two prime requirements of the generator excitation control; one to regulate the generator terminal voltage, and one to suppress oscillations caused by disturbances occurred in the power system.

Section 4.3

presents the MPEC design formulation. Part II, for the predicted perturbed generator speed, generator terminal voltage, generator torque, and their optimizing variables.

Section 4.4

presents the MPEC design formulation. Part III, for the optimizing index and the controlling input to the generator excitation circuit.

Section 4.5

presents the concluding remark of this chapter.

4.1

Basic Procedure for Modified Standard Model Predictive Control

This section presents the basic procedure for the modified model predictive control, as expanded from the materials given in Section 3.5.

PI:

Compute the state matrices A, B, and C for the MPEC prediction model as given in

(3.6):

52

x ik + \\k) = Ax( k) + B uik + \\k) 3'(A: + 1|à:) = Cj:(A: + 1 |^ ) (3 5 )

P2;

Make the measurements y(k) at the controlled system. Calculate the sate valuables x(k) from y(k) using (3.4b):

y(k) = Cx{k)

(3.4b)

P3;

Use the prediction model to calculate x(k+ l) from x(k) and u(k) using (3.4a). Calculate the predicted output y (k+f ) from x(k+ l) using (3.4c).

x (k + l) = Ax( k) + Bu(k) y( k + Y) = Cx(k + \)

(3.4a) (3.4c)

P4:

Calculate the components G and H of the deviations Ae of the predicted system outputs y(k+ l) from their references r using (3.15).

G = (CByQ,E, H = (^CBfQ,(CB) + R, (3.15)

P5:

Calculate the controlling input u(k+l\k) for the next time step k+ l using the predictive control optimization equations of (3.17) and (3.18):

Au(k + l\k ) = H-'G uik + l\k ) = u(k) + /}u{k + \\k )

(3.17) (3.18)

The above procedure of the modified standard model predictive control has been further improved and simplified, in this thesis research, for the application in power system generator excitation control. This is described in the following sections.

53

4.2

MPEC Design Formulation I

This section presents the design formulation, part I, for the optimal generator excitation control, named the Model Predictive Excitation Control (MPEC) in this thesis research. The MPEC can be recognized as a further development upon the modified standard predictive control concept provided in the previous chapter.

The two prime requirements of the generator excitation control are: one to regulate the generator terminal voltage, and one to suppress oscillations caused by disturbances occurred on the power system. The following selections of the output variables in y, the state variables in jc, the controlling input u, and the optimizing variables in e are simply to serve the above two prime requirements.

4.2.1

Selection of controlled-system output and controlling input variables

In order to serve the first requirement of the MPEC for regulating the generator terminal voltage, the terminal voltage V, that is practically measurable is selected as one of the system output.

In order to serve the second requirement of the MPEC for suppressing oscillations that directly relates to the change of generator speed, the generator speed W r that is also practically measurable is selected as the other one of the system output.

Therefore, the output vector is composed of:

=M

(4.1)

54

The controlling input u for the generator excitation control is simply the generator field voltage e/rf. Therefore,

Au{k + l \ k ) =

(k + \ \ k )

(4.2)

4.2.2

Selection of state equation and state variables

From the power system generator excitation control point of view, there are two key state equations (differential equations) requires to be included in the design: one is the generator electrical and mechanical dynamic second-order differential equation, and one is the generator excitation electromagnetic first-order differential equation. This requirement leads to the selection of three state variables: one for generator speed for excitation flux one for power angle Ô , one

The generator eleetrieal and mechanical dynamic equation can be written as:

cZAA)XA:)/6/t = (7 ;(t)-7 :(& ))/2 f/

(4.3)

d A S (k)l dt = cü^Aû)^(k)

(4.4)

where inertia.

is the mechanical torque. Te is the electrical torque, H is the rotor mechanical

The generator excitation electromagnetic equation can be written as:

dAifTj-j (k)/ dt = CO^Aefj (k) = co,,Au(k)

(4.5)

55

Equations (4.3) to (4.5) are the state equations required for the design of the generator excitation control. Therefore, the state variables in the design for any time step can be written as:

Aco^(k) x(k) = A ^(t) (4.6)

AWfuik)

4.2.3

Selection of control optimizing variables

The selection of the correct optimizing variables is important for the success of achieving the two prime requirements of the generator excitation control that is to regulate the generator terminal voltage and to suppress oscillations caused by disturbances occurred on the power system.

Originally, in the standard model predictive control, the optimizing variables are the terms in the performance index. The performance index is best formed by a set of the squared values of the deviations of the selected outputs of the controlled system with respect to their references, Ae, and the variations of the controlling inputs to the controlled system. Au.

However, there are lots of limitations in the real power system environment that makes the implementation of the standard model predictive control become impractical. It is either too expensive or not practical to obtain all the measurements from the generator and its connected power system required for the standard predictive control implementation. Therefore, this thesis research makes a significant change in the implementation of the model predictive control. The first part of the change is to define the optimizing variables for the generator excitation control design, as shown in the following.

In order to achieve the first prime requirement of the excitation control for the regulation of the generator terminal voltage, the deviation of the terminal voltage % from its pre-

56

disturbance value is used as one of the optimizing variable. This optimizing variable is defined as:

Ae^v,(k + l) = AV,{k)-AV,{k + l)

(4 .7 )

where AV,{k) = V* -V ,{k)

AeAvt is the terminal voltage optimizing variable, V, is the pre-disturbance value, Vi(k) is the terminal voltage at the time step k, and AV,(k+l) is the predicted perturbed value for the time step k+ l.

In order to achieve the second prime excitation control requirement for suppression of oscillations in the power system, two deviations are used: one for the generator torque, and one for the generator speed. These two deviations are defined as:

(/: -Hi) = Z;, -

7; ( t )

- AT,

-t 1)

(4 .8 )

Ae^^ (k + l) = A(0^ (k + l ) - AT, (k + l)A t/H

(4.9)

where Ag^^, is the generator electrical torque optimizing variable,

is the mechanical

torque, Te(k) is the electrical torque at the time step k, and AT^k+ l) is the predicted perturbed value for the time step k+ l, and A<y,(Â: + 1) is the predicted generator speed deviation.

4.3

MPEC Design Formulation II

This section presents the design formulation, part Ü, for the MPEC developed in this thesis. In this section, first extend the formulation of the state variables x{k) in (4.6) in terms of the generator speed û)î{k) and the generator terminal voltage V,(k) measurements. Second, extend

57

the formulation of the optimizing variables

in (4.7),

(4.8), and Ae^^in (4.9) in

terms of the state variables and their reference values.

4.3.1 Perturbed variables formulation

(a)

Perturbed state variables

The following extends the formulation of the state variables x{k) in (4.6) in terms of the generator speed and the generator terminal voltage measurements in (4.1).

Ao)^{k) = û)X^)-oe,, AS{k) = û)^,AtAû)^{k) Aif/f^(k) = co^AtAu{k) (4.10)

(b)

Predicted perturbed generator torque

The following equation expresses the predicted perturbed generator electrical torque AT^(k + V) of the next time step k+ l, in terms of the state variables: the perturbed power angle AS(k) and the perturbed excitation ûuxAy/j.^(k) of the present time step k. Appendix n provides the detailed derivation of (4.11).

AT^(k + ]) = k^AÔ(k) + k^Ay/j^ (k)

(4.11)

where A , = n, (yr^o +
^2 " ^liV^adO

) - m, ({/^ +
kaqido)~f^2(V^atiO

)
+ i^gL^j /L yj

m ^ =egiXj.^sin0o-R^cosS^)/Dj. n, = egiR^ sin^o cos0^)/D^

+L^J] + ^/J] = Rj + Xj^Xj^

Rr=Ra+RE ^T q ~ ^E '^^q ^T d ~ ^E '^^d

58

(c)

Predicted perturbed generator terminal voltage

The following equation expresses the predicted perturbed generator terminal voltage AVt(k + 1) of the next time step k+I, in terms of the state variables: the perturbed power angle A S (k) and the perturbed excitation flux A n provides the detailed derivation of (4 . 12). (Æ ) of the present time step k. Appendix

AV,{k + 1) = k^AS{k) + k^Ay/^^{k) where k,
wo

(4 .1 2 )

+L,n,

+
W o

-L,m,

W O

wo

(d)

Predicted perturbed generator speed

The following equation shows the use of the predicted perturbed generator speeds AcD^iJk) and A w ^ { k -\) to express the electrical torque T(k) from (4.3):

dAo), (k )/d t = (T ; (k)-T ^ (k)) / 2H T^{k) = {k) -2 H [ A o } (k )- A oe { k -\)\lAt

(4 .3 ) ( 4 .1 3 )

Also, the predicted perturbed generator speed can be expressed as;

Aû){k + 1) = 2A<jû{k) - Aù){k -

1)

( 4 .1 4 )

4.3.2 Optimizing variables in terms of state variables and references

(a)

Optimizing generator terminal-voltage variable

59

The following extends the formulation of the generator terminal-voltage optimizing variable in (4 .7 ), in terms of the state variables x(k) and their reference values.

Substituting (4.10) and (4.12) into (4.7), one obtains:

Ae,^,(k + \) = A V,ik)-AV,{k + \)

(4.7)

Ae^y, {k + \) = A V ,{k)-kjA S {k)- k^Ay/^^ (k) = AVi{k) + (-- k^At)Aco{k) + (-- k^co^At)Au{k) (4.15)

(b)

Optimizing generator electrical-torque variable

The following extends the formulation of the electrical-torque optimizing variable Ae^j.^ of (4.8) in terms of % (A :) and their reference values. By substituting (4.10), (4.11) and (4.13) into (4.8), one obtains:

AgArX^ + l) = L - ? :W - A 7 :( t- H )

(4.8)

Ae^j.^ (k + ]) = lHAco{k) ! A t- 2HAco{k - \ ) l A t- k^A5{k) - k^A

(k)

Ae^.j.^{k + l) = {2H / At -k^At)Aco{k) + {-2H ! At) Aa){k-\)-\-{-kjCù^At)Au{k) (4.16)

(c)

Optimizing generator speed variable

The following extends the formulation of the generator speed optimizing variable A e^ of (4.9) in terms of x(k) and their reference values. By substituting (4.11) and (4.14) into (4.9), one obtains:

Ae^^ik -t-1) = Aco^ (k + l ) - a t ; {k + l)A t/2H

(4.9)

60

- ^Cûik - 1 ) - ^tk^LÔ{k)l2H - ùdk^ày/^^(k)/2H

^ e ^ ^ ik + 1) = (2 - ^ t^ tk J 2 H )A û } ^ { k ) + ( - l ) A a ( t - 1) + (AtAtk^a)J2H )Au(k) (4.17)

4.3.3

Optimizing variables in vector form

The following compiles the three optimizing variables in (4.15), (4.16), and (4.17) into a vector:

Ae(k +1) = K^Aoe^ik) + K^,Aoe^ { k - l ) + K^AV, (k) + E^Au{k) Ae(k +1) = £, + E^Au{k) (4.18)

'2 -A tA tk J 2 H ~ where = --k-^At 2H ! At --k^At

-1 0

0" 1 ,£'2 0

-AtAtk2Û)^l2H - k^oe^At

-2H/At

E,^[K^AoeXk) + K,Aoe^{k-V) + K^AV,{k)\

(4.19)

4.4

MPEC Design Formulation III

The section presents the optimization formulation designed for the MPEC developed in this thesis research. Though the control concept is based on the standard model predictive

control, the formulation for the MPEC is modified and improved significantly from the standard one. As compared with the standard one that has been given in Section 4.1, the main improvement is the computational efficiency that is important for the real-time digital control, since fewer matrixes need to be computed as shown below.

Formulation o f controlling input through optimization

The performance index J for the MPEC has the same form as the standard predictive control given in (3 .9 ) which is given below for convenience.

61

J = J e ^Q ^ Je + Au^R^Au

(3-9)

By substitution of (4.19) into (3.9), the performance index 7 becomes:

7 = (E, +

Q{E^ + E^^m ) + AuRAu (4.20)

= E^QE, + e J q E^Au + e Y q E,Au + E^QE^Au + RAu^

By carrying out the optimization processthat is tominimize the performance index 7 of (4.20),

dJIAu = 0

(3.16)

Au(k + l \ k ) = E,

(4.21)

where E^ = (-E,

- E^QE^ ) / liE ^Q E ^ +R)

(4.22)

Finally, the formulation for determining the predicted controlling input u(k+l) to the controlled system that is the generator and its connected power system is:

u{k + 1 1À :) = u(k) + Au(k + 1 1A :) u{k + l \ k ) - u { k ) + E-i (4.23)

4.5

Concluding Remarks

The control process of MPEC is based on the formulations described in the above sections, and it is summarized below:

Step 0:

Calculate the constants for the prediction model of the generator and their

62

connected power system using (4.19):

~ 2 -A tA tk J 2 H ' K.= --k^At 2H ! At --k^At

-1 0
-2HIAt

"o' 1 ,£2 -- 0

AtAtk2Û)^ / 2H -k^co^At

- kjCO^Ai

Step 1:

Make the measurements of the generator terminal voltage and speed, and calculate their perturbed values using (4 .7 ) and (4 . 10):

AV,(k ) = V* - V ,(k), Ao)^(k) = Q}^{k)-oe,,

Step 2:

Calculate the constants of control optimization using (4.19) and (4.22):

E,=K^Acû^{k) + K,Aû)^{k-\) + K^AV,{k) E,=^i-E,^QE,-E,^QE,)/2{E,^QE, + R)

Step 3:

Compute the controlling input to the generator excitation, that is the generator excitation voltage e/d for the next time step k+l using (4.2) and (4.23):

Aejy (A : + 11Â :) = u(k +1 [ A :) = u(k) + E^

Step4:

Go to Step I, and repeat the computation.

The above-mentioned control optimization process, the core of the MPEC developed in this thesis research, is simple and computationally efficient, as compared to the standard model predictive control, because:

1. The constants, in Step 0, that represent the prediction model of the generator and its connected power system, need to be computed only once.

63

This significantly reduces the computation time, when compared with the standard model predictive control that requires, for each time step, all the state equations to be calculated (see Procedures PI, P2, and P3 in Section 4.1).

2. Within the control process loop, the only significant computational effort required is in Step 2, of which the computation is just a few 3x1 vector calculations.

This substantially reduces the computation time, when compared with the standard model predictive control that requires, for each time step, several matrices multiplications to be calculated (see Procedure P4 and P5 in Section 4.1).

3. Only two measurements, which are the generator speed and terminal voltage in Step 1, are required. These two measurements are already available in the power system generating station. No new/additional installations for measurements are needed for the MPEG. This significantly increases the practical use of the MPEG, when compared with the standard model predictive control that requires many measurements in order to be able to make the prediction model functions.

4. The control process of the MPEG, designed in this thesis research, can be well implemented for the real time control of the generator excitation.

However, the standard model predictive control requires considerably heavy computation effort that mostly likely prevents it to be implemented for the real-time control of the power system generator.

5. As presented in Section 2.1, the standard model predictive control is superior to other methods for the excitation control of power system generator such as automatic

64

voltage regulator, power system stabilizer, artificial intelligent control, fuzzy control, etc.

The MPEC power system generator control is superior to other control methods, since the MPEC has made significant improvement on the standard model predictive control.

65

66

Chapter 5

MPEC Design Analysis

This chapter presents the design analysis of the MPEC, the Model Predictive Excitation Control developed in this thesis research.

First, this chapter presents the computer simulation platform for the analysis of the MPEC design developed in this thesis research.

Second, this chapter presents study cases for evaluating the performance of the MPEC designed in this thesis research. In these study cases, the conventional controls including the automatic voltage regulator (AVR) and the power system stabilizer (PSS) are used for performance comparisons with the MPEC. educational/commercial software Matlab. The study cases are carried out using the

Self-turning control can modify the controlling parameters in response to different characteristics of the dynamic process under various disturbances and operating conditions [19]. In this chapter, the self-turning method is applied for improving the predictive As an extension of the model

excitation control by turning the weighting coefficients.

predictive control applications, the predictive governor control is developed for damping the speed oscillation. Based on the predictive excitation control and the predictive governor

control, an integrated controller is designed to implement functions of both the excitation and the governor controls in this chapter.

This chapter presents the characteristics of power systems, by which the generator dynamics are different under various operating conditions. The predictive excitation control is adaptive

67

to these characteristics.

When the operating condition changes from the original design

setting, the oscillation damping shrinks. By analyzing the power system characteristics and considering the generator voltage boundary, the weighting factor self-turning strategy is established to adapt the predictive excitation control to typical operating conditions.

This chapter presents how the weighting factors are selected. A useful guide for selecting the weighting factors for the predictive excitation control is developed. How the weighting

factors affecting on the controller performance is also studied. Based on the analysis of effects from the weighting factors, a detailed self-turning algorithm is designed for the predictive excitation control. The computer simulations are provided for evaluating the self turning algorithm as well.

This chapter presents the design analysis of the MPEC, the Model Predictive Excitation Control developed in this thesis research.

The following outlines the sections in this chapter.

Section 5.1

presents the computer simulation platform for the analysis of the MPEC design developed in this thesis research.

Section 5.2

presents 4 study cases for evaluating the performance of the MPEC. In these study cases, the conventional controls including the AVR and the PSS are used for performance comparisons with the MPEC.

Section 5.3

presents self-turning strategy of the MPEC. The power system nonlinearity is analysis by simulating the dynamie process of the generator experienced a large disturbance. The requirements of the voltage and oscillation are also given for the utility industry.

68

Section 5.4

presents how the weight coefficients affect the MPEC performance. The weight coefficients self-turning method is created for improving the MPEC. The simulations for various cases are given for verifying the effectiveness of the self-tuming weight coefficients,

Section 5.5

presents the concluding remark of this chapter.

5.1

Computer Simulation Platform for MPEC Design

This section presents the computer simulation platform for the analysis of the MPEC design developed in this thesis research.

(a)

Typical power system configuration fo r generator excitation control studies

Figure 5.1 shows a typical power system configuration classically used for the study of both the generator excitation control and the power system stability. This figure shows that the generator is connected to the low voltage terminal LT of the step-up transformer. The

transformer has impedance of X, and its high voltage terminal HT is connected through two transmission lines with impedances X u and X u to the power system network EB. The

parameters for this power system configuration are given in Appendix HI. The excitation control was designed under the operating conditions of the generator providing the active power Pr=0.9 per unit, the reactive power 0 ^ 0 .4 3 6 per unit, and the terminal voltage V ^l per unit.

LT

HT

EB

A A A /A /W xt
XI1

A A A /XI2

Figure 5.1: A typical power system configuration for excitation control study

69

Table 5.1 provides the parameter values for the studies of the MPEC optimal excitation control. This table provides the values of the pre-fault power system operating conditions (currents and power angles). This table lists the parameter values used to calculate ki, k2 , ks, and k4 which are the parameters for defining the perturbed generator torque and terminal voltage in equations (4.11) and (4.12). This table also gives the values of the weighting parameters Q and R in equation (4.22), where Q consists of ky,, kje, and kû,, as the weighting factors for the optimizing variables of the perturbed generator terminal voltage, generator torque, and generator speed respectively, and R has one weighting value ke for the perturbed generator excitation voltage.

Table 5.1 ; Parameter values for excitation control study Pre-fault values
ido=

Parameter values
m ,= m2= ni= n2=

Weighting values kv=\ kp=0.05 k(u=8 kg=5

0.9059

1.1788 1.4196 0.4824 0.0059

1.6249 A:2=1.1164 /ti=0.1768 W ).3782

iqO = 0.4236 (5o=67.4321° %f=0.4725

(b)

Typical power system disturbances for generator excitation control studies

The following provides four typical disturbances that are used for the studies of the generator excitation controls.

Disturbance I: A large disturbance caused by a three-phase fault on the generator bus. This disturbance assumes a three-phase fault occurring on the high voltage side of the generator transformer, at the point F shown in Figure 5.1. This fault lasts for 0.07s. Then the fault is cleared by the circuit breaker, and the faulted transmission line is put out of service. This disturbance is used for testing the MPEC when the generator and its connected power system are experiencing a sever disturbance.

70

Disturbance II: A medium disturbance caused by switching o ff a transmission line. This disturbance assumes that one transmission line is being switched off. This disturbance is used for testing the MPEC when there is a significant change of the energy flow in the power system such as one transmission near the generator being put out of service.

Disturbance III: A small disturbance caused by a change o f generator terminal voltage. This disturbance assumes that the operating reference for the generator terminal voltage Vf is decreased by 2%. This voltage change is used for testing the MPEC when a significant

change of the generator electrical operations such as the generator being commanded to reduce its output power.

Disturbance IV: A small disturbance caused by a change o f generator mechanical torque. This disturbance assumes that the generator is experiencing with a 5% decrease of mechanical torque T,,,. This disturbance is used for testing the MPEC when a significant change of the generator mechanical operations such as the generator is being commanded to increase its output power.

5.2

Study Cases for Evaluating MPEC Performance

This section presents 4 study cases for evaluating the performance of the MPEC designed in this thesis research. In these study cases, the conventional controls including the automatic voltage regulator (AVR) and the power system stabilizer (PSS) are used for the performance comparisons with the MPEC. commercial software Matlab. Appendix IV. The study cases are carried out using the educational / The computer codes for the study cases are provided in

Study Case I :

Disturbance I caused by a three-phase fault on the generator bus

71

Figure 5.2 shows the results of the Matlab computer simulation for the generator excitation control of a large disturbance caused by a three-phase fault occurring on the generator bus as described in the previous section.

The simulation results shown in Figure 5.2 include the generator speed, terminal voltage, field voltage, and power angle. The simulation results show that the MPEC provides a better damping on the generator speed oscillation than the classical control AVR+PSS. The speed oscillation is suppressed within 3 s, as compared with the classical control AVR+PSS that needs 4 s. The voltage regulation offered by the MPEC is about the same as that of the AVR+PSS. The post-fault lowest points of the generator terminal voltage are about the same for the MPEC of 0.935 per unit and for the AVR+PSS of 0.940 per unit.
üpeecS deviation (pu)
0.01
0 .0 0 5

Terminal Voltage (pu)

0.8 0.6
-0 .0 0 5 0 .4

-

0.01

0

2

0.2
4

6

0

2

4

6

Field Voltage (pu)
120

Power Angle (deg.)
---

100

CPSS MPEC

60

-10

0

2

40 4

6

0

2

4

6

tlme(s)

time(s)

Figure 5.2: Study Case I: Simulation results for Disturbance I

Study Case 2:

Disturbance I I caused by switching off a transmission line

72

Figure 5.3 shows the results of computer simulation for the generator excitation control of a medium disturbance caused by switching a transmission line off the generator bus as described in the previous section.

The simulation results in Figure 5.3 show that the MPEC provides a better damping on the speed oscillation than that of the classical control AVR+PSS. The post-fault speed

oscillation is suppressed within 2 s, as compared with the AVR+PSS that needs 3 s. With the MPEC, the terminal voltage is a little higher than that of the AVR+PSS. The highest point of the generator terminal voltage is 1.035 per unit for the MPEC, comparing to 1.025 per unit for the AVR+PSS after the fault.

X

10'^

S p e e d deviation (pu)
1 .0 6 1 .0 4

Temiinal Voltage (pu)

1.02

0 .9 8

6

Field Voltage (pu)

Po\ner Angle (deg.)
--CPSS MP EG

80 75 70

-10

65

time(s)

time(s)

Figure 5.3: Study Case 2: Simulation results for Disturbance II

Study Case 3:

Disturbance II I caused by a change o f generator terminal voltage

73

Figure 5.4 shows the results of computer simulation for the generator excitation control of a small disturbance caused by a change of the generator terminal voltage, as described in the previous section.

The simulation results show that with the classical excitation control AVR+PSS, the terminal voltage reaches the new reference very quickly, because the AVR has a high gain for the voltage deviation. The MPEC achieves the best damping on the generator speed oscillation but offers a slightly slower response to voltage regulation.
X 10"^

S p e e d deviation (pu)

Terminal Voltage (pu)

10

5

0 .9 9

0

0 .9 8

·5

0

2

4

6

0 .9 7

0

2

4

6

Field Voltage (pu)

P o m r Angle (deg.)

69

---

CPSS MPEG

0

2

4

6

time(s)

time(s)

Figure 5.4: Study Case 3: Simulation results for Disturbance IE Study Case 4: Disturbance IV caused by a change o f generator mechanical torque

Figure 5.5 shows the results of computer simulation for the generator excitation control of a small disturbance caused by a change of generator mechanical torque as described in the previous section.

74

In this case, the generator speed oscillation is in a smaller magnitude and a shorter time with the MPEC than that with the other controls. Although the lowest point of the terminal

voltage with the MPEC is at 0.003 per unit lower than that with the other controls.

10"'

S p e e d deviation (pu)
1 .0 0 5

Terminal Voltage (pu)

0.995

-10

0.9 9 0 2 4

6

Field Voltage (pu)
68

Power Angle (deg.)
--CPSS MPEG

66

64

2

4

time(s)

time(s)

Figure 5.5: Study Case 4: Simulation results for Disturbance IV

5.3

Self-tuning Strategy

This section presents the characteristics of the power system, by which the generator dynamics are different under typical operating conditions. A self-turning strategy of the

weighting factors in the predictive control is established to adapt the MPEC to typical operating conditions.

5.3.1

Power system characteristics

75

The power system dynamic process changes with different operating conditions. instance, with light loads demanding small generator power
P,

For

or heavy loads demanding

large Ft, the generator has different dynamic responses under the same large disturbance. The speed deviations are changed proportionally smaller with the light loads than that with the heavy loads. However, the terminal voltages variations do not change the same as the speed deviations. This is shown by the simulation results given in Figure 5.6.

From the equation (2.20), the rotor speed derivative is proportional to the difference of mechanical torque and electric torque. The electric torque is the product of the terminal voltage and current. The terminal current is the sinusoidal function of the power angle. The power angle variations are determined by the speed deviations.

The MPEC designed in this thesis research is built based on the simplified 3-order generator model. Parameters kj, k2 , ks, and defined in (4.11) and (4.12), of the controller are

calculated from the designed operating condition. When the operating condition changes from the originally designed operating condition, the parameters k/, k2 , k i and ^ change correspondingly. The coefficient variations are given in Figure 5.6 as an example. These

variations affect the controller performance.

Study Case 5:

Large disturbance on the system under active power o f 0.1, 0.4 or 0.9p u

This study case investigates the MPEC performance for different operating conditions. The simulation results are shown in Figure 5.6, where three curves represent the operating conditions of P,=0.1 per unit, P,=0.4 per unit and
Pf=0.9

per unit respectively. Four graphs

show the voltage deviation (VrVre/), the speed deviation (z/ai^), the power angle (S) and the coeffieient k2 .

The simulation results show that the speed oscillation magnitude increases with raise of the active power. However, the terminal voltage deviation changes with the active power

differently. After the fault is cleared, the terminal voltage goes back to the rated value very

76

quickly for f r=0-1 per unit and P ,=0.4 per unit, but it takes longer time to reach its rated value for P{=Q.9 per unit. The coefficient k 2 changes largely with different conditions.

The weighting coefficients of the MPEC are self-turned according to different operating conditions using the self-tuming technique.

Terminal voltage (pu.)
0.2 0.01
0 .0 0 5
-

Hotor S p e e d (pu.)

0
0.2
P t= 0 .9
-

- 0 .4

0.6 0.8
2 4

-0 .0 0 5

P t= 0 .4 P t= 0 .1

-

-

0.01

0

2

4

6

Power angle (deg.)
150

K 2 coefficient

100
50

0

2 time(s)

4

6 timefs)

Figure 5.6: Simulation results for Study Case 5

5.3.2 Conflict of terminal voltage regulation and oscillation damping
Design of the generator excitation control has two prime requirements: one is the generator terminal voltage regulation and the other is oscillation damping. In the process of

determining the weighting factors to improve the predictive control, it needs to achieve a good performance on both the voltage regulation and the oscillation damping. However, by turning the weighting factors for better oscillation damping, the generation terminal voltage regulation may become worse.

77

This section investigates the reason why the two requirements are not always coincident. In some cases, they may be conflict. For example, the voltage regulation needs to increase the field voltage while the oscillation damping needs to decrease the field voltage.

To investigate why these two requirements are not coincident, the dynamics process of a generator, subjected to a large disturbance defined in Section 5.1, is simulated. The results are shown in Figure 5.7 and 5.8.

The parameters k2 and k4 in (4.11) and (4.12) represent the relationship AV; and ATg with Ay/jd respectively, and Ay/fd is changed by the controlling input directly. The changes of kz and kd changes are given in Figure 5.7. Note and kd used in the MPEC design are constant. They

are shown in variable values in the figure just for explaining the dynamic process of the generator. As shown in the Figure 5.7, they are positive during the whole process.
Coefficients KS a n d K A

Figure 5.7: Changes of coefficients k2 and

with a large disturbance

In Figure 5.8, for convenient to compare, three output deviations in per unit are shown in the same figure, which are the generator speed deviation (noted as Speed), the terminal voltage deviation (noted as E,-Vrej) from the reference and the unbalance torque (noted as Tg-Tm) that is proportional to and represents the acceleration. When the disturbance occurs at 0.1s, the speed increases because the mechanical torque is greater than electric torque that becomes zero during the fault. Then the fault is cleared at 0.17s. At this time, the terminal voltage recovers to around 0.9 per unit, and the electric torque exceeds the mechanical torque because

78

the power angle has increased during the fault.

The electric torque is higher than the

mechanical torque that causes the generator speed to decrease.

During the period of 0.17s to 0.47s, the speed deviation is positive as shown in Figure 5.8. The electric torque should be increased to decrease the speed deviation. In order to increase the electric torque, it requires increasing the generator field voltage. For the condition shown in Figure 5.8, the terminal voltage is lower than the reference.It needs increasing generator field voltage to raise the generator terminal voltage as the

well. For this case, the

regulation of the terminal voltage and the damping of the speed oscillation are coincident during this period.

However for the period of 0.47s to 0.90s, the situation is different where the speed deviation is negative. In order to reduce this negative speed deviation, it needs to decrease the

controlling input to reduce the generator voltage and therefore to decrease the electrical torque or to increase the generator accelerating torque. However during this period, the

terminal voltage is lower than the reference. It requires the higher controlling input to reduce the voltage deviations. Two requirements for the controller are opposed with each other, as one requires for the control decrease to minimize the negative speed deviation and one requires for the control increase to reduce the voltage deviation.

3-phase short-circuit with P=0.9 0 = 0 .4 0.4 0.3 0.2

_ _ D
- 0.1

- 0.2

-0 .3

- 0 .4

0.2

0.6

0.8

1.2

1.4

1 .0

tim e (s)

Figure 5.8: Responses of rotor speed, toque and terminal voltage with a large disturbance

79

5.3.3

Self-turning strategy

'

A self-turning controller has a strategy for turning the controller parameters [19]. For the MPEC, the strategy is found as the following.

In the electricity power system, the variation of the generator terminal voltage usually does not exceed ±5% of its rated value. This variation of a short duration is acceptable to

industries. In this thesis research, ±5% is considered as the boundary for the terminal voltage deviation.

After disturbances, the terminal voltage is regulated quickly close to the pre-disturbance value. If the terminal voltage is within this boundary, the weighting factors do not need to be further turned to improve the terminal voltage.

Many papers are reported on the self-turning excitation control. Some of them use state estimation technique to catch the model characters under various operation conditions for modifying the controller parameters. For an example, in the paper [8], the recursive-leastsquares identification technique is used to track the system model changes. The model The

characters under different operating conditions are identified by this technique.

weighting coefficients for the identification technique also need to be chosen by the trial and error method. On the other hand, this identification technique is time-consuming for

identifying system model online.

Study Case 6:

Large disturbance on the system fo r the light load F;=0.1pu and g,=0.1pa

For the MPEC, the control performance is not only relative to the prediction but also to the weighting coefficients. The performance is not improved much if only the prediction is

changed with the operating conditions. This is illustrated in the study case shown in Figure 5.9.

80

W i t h th e u p d a te d m o d e l, a ll p a ra m e te rs o f p r e d ic tio n m o d e l, in c lu d in g u p d a t e d b y m e a s u r in g c u r r e n t s . f r o m th e i n i t i a l v a lu e s . u p d a te d m o d e l.

kj, k2 , ks

and

k4 ,

a re

W i t h th e f ix e d m o d e l, a ll p a r a m e te r s a re c o n s ta n ts c a lc u la t e d

F ig u r e 5 .9 s h o w s t w o c u rv e s : o n e f o r th e f ix e d m o d e l a n d o n e f o r th e

T h e r e a r e m a n y p a r a m e t e r s d e p e n d i n g o n t h e d e s ig n e d o p e r a t i n g c o n d i t i o n .

I f t u r n in g th e s e

p a r a m e te r s o n - lin e to a d a p t n e w o p e r a tin g c o n d itio n s , e it h e r m o r e m e a s u r e m e n ts o r c o m p le x te c h n iq u e s a re r e q u ir e d . im p r o v e d as show n in E v e n th o u g h th e s e p a ra m e te rs a re tu r n e d , th e c o n tr o l e ffe c ts m a y n o t S tu d y C ase 6. In t h is th e s is re s e a rc h , tu r n in g o f th e w e ig h tin g

c o e ffic ie n ts p r e d ic tio n

ko^, kp

and

ky

is s t u d ie d f o r i m p r o v i n g t h e p r e d i c t i v e e x c i t a t i o n c o n t r o l , w h i l e t h e The s c h e m e o f th e p r e d ic t iv e e x c it a t io n c o n tr o l w it h

m o d e l r e m a in s th e f i x e d .

w e i g h t s s e l f - t u r n i n g is s h o w n i n F i g u r e 5 . 1 0 .

10
5

X lo'^

S p e e d deviation (pu)

Terminal Voltage (pu)

1.2 1
0.8

0
·5

0.6
0 .4

Updated model Fixed model

0

2

4

6

0.2

0

2

4

6

Field Voltage (pu)

Po\ær Angle (deg.)

10.5

-10 time(s)
F ig u r e 5 .9 :

timefs)
S i m u l a t i o n r e s u lts f o r S t u d y C a s e 6

The

d e ta ile d

s e lf-tu m in g

a lg o r ith m

is

d e v e lo p e d

in

th e

S e c tio n

5 .4 .

The

s e lf-tu m in g

81

algorithm consists of the weights self-tuming block in Figure 5.10.

The system

characteristics are checked with the weights self-tuming block with measurements of the generator speed and the terminal voltage. When the measured system outputs meet the selftuming regulation, the corresponding weights are tumed and applied to the predictive excitation controller. The predictive excitation control works with the new weight

coefficients to improve control effects.

Weights Self-turning Predictive Controller Power System

Figure 5.10: Scheme of the predictive excitation control system with weights self-tuming

5.4 Weight Coefficients Self-turning
This section presents how the weight coefficients are chosen for the predictive excitation control. Based on analysis how the weights affect on the control, the self-tuming algorithm is created for improving the predictive excitation control.

5.4.1

Choosing weighting coefficients

Although optimal control becomes popular, there is no the general regulation about the weight coefficients selection. A good rule of the weight coefficients choosing is made for some controlled systems, but it may not work well with other controlled systems. The MPC is a kind of optimal control, for applications based on the MFC, the weight coefficients are chosen based on the characteristics of the generator and its connected power system.

In the performance index given in (4.20), the system output weight decides the rank with

82

which the controller keeps the system output tracking its reference. A big weight causes the corresponding output deviation to be minimized relatively quickly, compared with a small weight on other controlling variables. For satisfying two conflict requirements

simultaneously, weights should be chosen in a proper scale. Otherwise, one requirement is over-met while another one is under-met. The control input weight is used to punish the control input increments. The controller responses slowly with the big control input weight and quickly with the small control input weight.

From the equation (4.22), the MPEC is mainly affected by the ratio between various weight coefficients. Choosing the weights is actually finding the ratio between every weight

coefficients. It is a good start by choosing kv as unity, and then finding other weights.
S p e e d deviation (pu)
0.01
0 .0 0 5

Terminal Voltage (pu)

-0 .0 0 5

kw=16 - kw=8

-

0.01

0

2

4

6

Field Voltage (pu)

Power Angle (deg.)

120
100

-10 timefs) tim efs)

Figure 5.11: Simulation results for Study Case 7(1)

83

Study Case 7:

Large disturbance happens on the system under the fu ll load Pt=Q.9 and =0.436, different weight coefficients ka, and ke are verified with the MPEC.

This case is to study the weight coefficients effects on the MPEC. The simulation results are shown in Figure 5.11, including the generator speed deviation, the terminal voltage, the field voltage, and the power angle.

From the results, the speed oscillation changes proportionally with the weight coefficients A g,. With k(o increases from 4 to 16, the magnitude of the speed oscillation decreases largely, and the oscillation procedure decreases from more than 5 s to 2 s. But the voltage regulating is affected negatively. It is because that the speed deviation is traced well with the higher kp. Correspondingly, the terminal voltage is adjusted worse because the less control effort is spent on tracing the voltage deviation. The other output weight coefficients K and kp have similar character as ka,.
S p e e d deviation (pu)
0.01
0 .0 0 5

Terminal Voltage (pu)
1.2

1
0.8 0.6

-0 .0 0 5

0.4

---

k e= 2 0 k e= 5 0 4

-

0.01

0

2

4

6

0.2
0 2

Field Voltage (pu)

120 100

P o m r Angle (deg.)

-10

0

2 timelsl

4

6

0

2 time(s)

4

6

Figure 5.12; Simulation results for Study Case 7 (2) In Figure 5.12, three curves represent the input weight coefficient of ke=5, ke=20 and ke=50

84

respectively. From the results, the control input weight coefficient ke effects are verified. The control input changes more slowly with the larger coefficient, and the oscillation lasts longer time. The oscillation damping is weakened while the voltage adjusting is strengthened.

By the above method, the weight coefficients are selected as K=\, kp=0.05, koj=S and ke=5.

5.4.2

Weight coefficients self-turning algorithm

The speed oscillation magnitude is proportional to the active power P, at the operation point with the large disturbance. When the active power P, is much smaller than that at the

designated point which the predictive excitation control is designed based on, the weights make the control damping function weakened. In this case, the weights (kp and k^) should be enlarged for keeping the good damping.

During the dynamic process after the large disturbance. Am,, reaches the peak value when the acceleration speed crosses the zero. In the view this point, the weight coefficients can be tumed according to the peak value of AcOr from the measurements. At first, the peak value of AcOr is found by checking the signs of Am,,(^-1) and Am,,(k). If the signs are different, the acceleration speed crosses the zero, and AcOr(k) is the peak value. Then the weights are

changed according the peak value of AcOr(k) shown in the following self-turning algorithm. This turning is made only at the point where the peak value Am,, of is found.

With the different reactive power Q, at the operation point, the terminal voltage changes differently during the dynamic process after the large disturbance. When the reactive power Q, is negative, the terminal voltage may not go back within the boundary (±5%) of the rated voltage. Under this situation, the weight ky should be increased for improving the voltage adjusting. Turning ky is based on measuring the terminal voltage.

Based on above analysis, the weights self-tuming regulation is made as: turning ky only when the terminal voltage is out of the scale of ±5%, otherwise tuming kp and k^ to eliminate the

85

oscillation as fast as possible. For the one-step predictive excitation control presented in the last chapter, the detail of weight coefficients tuming algorithm is shown as the following.

Self-turning algorithm

1.

If Aef=\erVrep-0.05 pu, ky increases 2 times, kp and feoe remain initial value, go to the end.

2. 3.

Else ky remains the initial value, go to the next. If the signal of A cO r(k)-A co fk-l) is same as the signal of A c o f k - l ) - A c o f k - 2 ) , go to the end.

4. 5. 6. 7. 8.

If \AcOr{k)\<=3e-A pu, kp and /cwremain initial value, go to the end. Else if |Ao)r(^)|<=0.00i3 pu, kp and k^,y increase 3 times, go to the end. Else if |Aûi,.(Â:)|<=0.0065 pu, kp and k^, increase 2 times, go to the end. Else if |Act),(^)|>0.009 pu, kp and L, remain initial value, go to the end. End; apply the turned weight coefficients to the controller.

The first two steps are checking if the terminal voltage is in the preset scale (±5%). If yes, just tuming ky to adjust voltage first, otherwise go to the next for tuming kp and to increase

damping. The third step is finding the extreme value of the speed deviation by checking if the acceleration speed crosses zero. The fourth is checking if the speed deviation is small enough. If yes, do nothing because the oscillation is dying out. The fifth and sixth are turning kp and ku, twice or three times according the magnitude of speed oscillation. The seventh does not change the weight coefficients because the controller works at the designed point. The control input weight kg is not turned by this algorithm. The scheme of the

coefficients self-turning algorithm is given as Figure 5.13.

If the weights are turned online, the high-frequency noise is introduced into the control input by changing the weights too often. In this research, the weights kp and are changed only at

the point where the speed deviation was checked at its peak value. It prevents the highfrequency noise from the control input. The tuming scale for AcOr can be divided smaller to

86

make the control input smoother than above tuming scale, for example, the scale of AcUr(k) divided in zone [3e-4, 0.001, 0.003, 0.005,...] with the gain [1, 3.5, 3.0, 2.5,...].

Ato Max/Mln

Obtain Vt Am Vt out limit

Turning kp according Am

Turning k^. according Vt Controller

Figure 5.13: Weights tuming algorithm

5.4.3

Verifications by the computer simulation

To verify the effects of the above weights self-tuming method, the following cases are studied using the computer simulations.

Study Case 8: Large disturbance happens on the system under the fu ll load f,=0.9 and 0<=O.436 with the self-turned MPEC.

This case is used to verify the self-turning algorithm. The simulation results are shown in Figure 5.14, including the generator speed deviation, the terminal voltage, the field voltage, the power angle and the variations of and k^. kp is turned with the same ratio as k^. Three

curves represent the generator dynamic processes under the classical control (AVR+PSS noted as CPSS), the predictive excitation control (noted as Fixed MPEC) and the self-tuming predictive excitation control (noted as Self-tumed MPEC) respectively.

87

%

S p e e d deviation (pu)

terminal Voltage (pu)
8
-- -- -- 1.05 Fixed MPEC Self-turned MPEC CPSS

Field Voltâge (pu)
6
4 2

0
0.95 -2 -4

6
Power A ngle (deg.)
110 100

0.9

-6

0

2

4

6

time(s)

time(s)

Figure 5.14: Simulation results for Study Case 8

From the simulation results, when the fault occurs, the voltage is lower than the preset scale (±5%) in a short period. According the self-tuming algorithm, increases 2 times and other

weights remain the same value for strengthening the terminal voltage adjusting. Comparing the predictive excitation control without weights turning, the self-tuming weights improves the voltage adjusting with a little higher magnitude of the speed oscillation. With the weight self-turning, the terminal voltage is regulated as fast as the classical control AVR+PSS. At the second peak point of the speed deviation, the voltage is within the scale, so ky is tumed back initial value and ^ and kp increase twice according the self-turning regulation to

improve the oscillation damping. And then ka, and kp increase three times at the next peak point of the speed deviation. The oscillation damping increases twice and three times by tuming ka, and kp, the speed oscillation is ended by the self-turned MPEC in 2 s, while the classical control and fixed MPEC need 5 s and 3 s respectively.

88

In conclusion, the self-tuming makes the controller gaining the good voltage adjusting like the classical control and good oscillation damping like the predictive control. The control effects are improved by the self-turning algorithm.

Study Case 9: Comparing the self-turned M PEC effects on the system with the large disturbance under the light load P,=0.1 and Qt=Q.\ with the classical control AVR+PSS and fix e d MPEC.

Both predictive excitation control and classical control are designed based on a certain operating condition. When the operating condition changes a lot, the control performance is affected by the nonlinearity of the generator model. The self-turning method can overcome this drawback by turning the weight coefficients according the characters of the different conditions. The case 9 is studied for evaluating the self-turning algorithm. The simulation results are shown in Figure 5.15, including the generator speed deviation, the terminal voltage, the field voltage, the power angle and the variations of and k^.

S p e e d deviation (pu)
8 6 0.9 4 0.8 0.7
0.6

T erm inal Voltage (pu)

F ield Voltage (pu)

2 0
 2
-4

0.5 - 0.4 2 4 6 0.3 CPSS SelM um ed M PEC Fixed M PEC

0

Pow er A n g le (deg.)

kp

11.5

10.5

2

tim e(s)

tim e(s)

4

Figure 5.15: Simulation results for Study Case 9

89

The MPEC has better oscillation damping than the classical control at the designed point that is verified in the case 1 and 4. From the simulation results in Figure 5.15, with the new operating point, the fixed MPEC has almost same oseillation damping as the classical control. The good damping effects of the MPEC are shrunk when the operating condition changes. With self-tuming technique, the MPEC is improved with good damping because the weights are changed to adapt the new operating condition.

Study Case 10: Comparing the self-turned MPEC effects on the system with the small disturbance under the heavy load P,=1.0 and g(=0.436 with the classical control AVR+PSS and fixed MPEC.

This case is studied for verifying the control effects with the small disturbance under the operating condition P ^l.O and <2,=0.436. The simulation results are shown in Figure 5.16, including the generator speed deviation, the terminal voltage, the field voltage, the power angle and the variations of A :< oand k^.
x io ^
4

S p e e d deviation (pu)

Terminal Voltage (pu)

F ield Voltage (pu)

2 0 ·2
·4

·6 -8

- -- 0

C P SS Fixed MPEC SelMumed MPEC

2

4

6

Power A n g le (deg.)
24 22 20 16 16 14 12 10 8

kv

n

L I2 4

am e(s) Figure 5.16: Simulation results for Study Case 10

90

From the results in Figure 5.16, compared with another two controls, the self-tuming predictive control has the best oscillation damping by sacrificing a little voltage adjusting. The speed oscillation is brought to end in a half cycle. The terminal voltage deviation is 0.015 pu which is permitted in the practical utility industry.

By studying the above case, the conclusion is obtained from the simulation results: the weight self-turning algorithm improves the MPEC with different disturbances and different operating conditions. The weight self-turning MPEC can damp the oscillation very fast and keep the terminal voltage within the preset scale (±5%).

5.5 Concluding Remarks
Comparing the classical control, simulation results verify that the MPEC obtains a better oscillation damping by sacrificing a little terminal voltage adjusting. The two requirements voltage adjusting and oscillation damping of excitation control system are studied by the simulation as well; two requirements are coincident during a period and are conflict during another period. The self-turning technique is applied for improving the predictive excitation control in this chapter. The well-selected regulation makes the proposed control overcome the drawback that the control is affected by the different operating condition. And also the controller

performance in the designed point is improved by the self-turning algorithm. The simulations of three cases, which includes three operating condition and two disturbances, are given for verifying the method.

91

92

Chapter 6

Conclusion

This thesis research has successfully completed the design and development of an optimal power system generator excitation control, named the Model Predictive Excitation Control (MPEC). This thesis summarizes an exhaustive investigation carried out in this research on the methods and techniques for the control of power system generator excitation. This research has found that the model predictive control technique, if properly implemented, can provide an effective real-time control of the generator excitation through a digital optimization process. This thesis research has found that the standard classical formulation of the digital model predictive control for computing the controlling input easily cause confusing. According to the notation given in the standard model predictive formulation, the value of controlling input at the present time step is calculated from the data at the same present time step. Since all the data at the present time step, including the controlling input, are known, it is therefore not possible to calculate, through an optimization process, the already-known data. In the generator excitation control considered in this thesis research, the controlling input at the present time step is already known and also has been applying to the controlled system. Therefore, this thesis research proposes to re-write the classical predictive control state equation expression, such that the controlling input for the present time step should be re-written as the controlling input for the next time step.

This thesis shows in detail the correct application of the model predictive control for the power system generator excitation control. The standard model predictive control is a This thesis has found that the model

multiple-step (N-step) optimal control process.

93

predictive control with one-step optimization, if properly designed, is sufficient to provide an effective generator excitation real-time control. The findings in this thesis research have shown that the N-step model predictive control has a complex formulation and expensive computation. In addition, the N-step control optimization virtually does not offer any

meaningful advantage to the efficiency of the generator excitation control. Therefore, this thesis research recommends strongly not implementing the N-step control optimization for the power system generator excitation control. This thesis details the support for this

recommendation and recommends the use of one-step predictive control.

6.1

Major Research Work Completed

The following presents a summary of the major tasks accomplished in this thesis research.

1. This thesis research has conducted an exclusive investigation on the cause of power system oscillation, the need for generator excitation control, the classical automatic voltage regulator with addition of power system stabilizer, and the modern digital control techniques that include the adaptive control, fuzzy logic control, artificial neural network control, the predictive control, etc. The findings of this investigation have initiated the core research and development of this thesis.

2. This thesis research has completed the modeling of the synchronous generator, power system network, excitation system, and turbine governor system for the design of power system optimal excitation control. In particular, a S^'-order generator model has been prepared for the excitation control design, and a 6"^-order generator model has been prepared for the performance evaluation of the MPEC developed in this thesis research.

3. This thesis research has investigated correct application of the standard model predictive control for the power system generator excitation control has been investigated. This thesis has found that the model predictive control with one-step

94

optimization is sufficient to provide an effective generator excitation real-time control. The findings in this thesis research have shown that the N-step model

predictive control has a complex formulation and expensive computation. In addition, the N-step control optimization virtually does not offer any meaningful advantage to the efficiency of the generator excitation control. Therefore, this thesis research

recommends strongly not implementing the N-step control optimization for the power system generator excitation control. This thesis details the support for this

recommendation and recommends the use of one-step predictive control.

4. This research has found that the model predictive control technique, if properly implemented, can provide an effective real-time control of the generator excitation through a digital optimization process. This thesis research has found that the standard classical formulation of the digital model predictive control for computing the controlling input easily cause confusing. According to the notation given in the

standard model predictive formulation, the value of controlling input at the present time step is calculated from the data at the same present time step. Since all the data at the present time step, including the controlling input, are known, it is therefore not possible to calculate, through an optimization process, the already-known data. In the generator excitation control considered in this thesis research, the controlling input at the present time step is already known and also has been applying to the controlled system. Therefore, this thesis research proposes to re-write the classical predictive control state equation expression, such that the controlling input for the present time step should be re-written as the controlling input for the next time step.

5. This thesis has developed the Model Predictive Excitation Control (MPEC). This thesis has illustrated that the MPEC, the core development in this research, has made substantial improvement upon the standard model predictive control. The MPEC is much simpler and computationally efficient.

95

6. This thesis has conducted extensive computer simulations for the design analysis of the MPEC. A total of 10 typical study cases has been presented in this thesis, of which 4 study cases are focused on the demonstration of the effectiveness of the MPEC when compared with the classical automatic voltage regulator and power system stabilizer. The rest 6 study cases are concentrated on the improvement and extension of the capacity of the model predictive controls including the MPEC and the standard one, for the application in the power system generator excitation control.

6.2

Major Research Contributions
1. MPEC, an optimal generator excitation control, has been designed in this thesis research. The MPEC has made substantial improvement upon the standard model predictive control. The MPEC is much simpler and more computationally efficient.

2. MPEC simulation program and results have been accomplished in this thesis research. Four typical study cases have been presented to demonstrate the

effectiveness of the MPEC excitation control, and six typical study cases have been presented to illustrate the improvement and extension of the capacity of the model predictive controls including the MPEC and the standard one for power system generator excitation control.

3. Modified standard model predictive control procedure has been formulated in this thesis research. This thesis research has found that the standard classical formulation of the digital model predictive control for computing the controlling input easily cause confusing. This thesis research has re-written the classical predictive control state equation expression, such that the controlling input for the present time step has been re-written as the controlling input for the next time step.

4. MPEC optimization formulation and procedure has been developed in this thesis research. This thesis has designed a unique formulation and optimization procedure

96

for the control of power system generator with only two substation-ready-available measurements which are the generator terminal voltage and speed data.

6.3

Future Work

The following presents recommended future work on the following areas:

·

The design of the MPEC developed in this thesis is recommended to be fully tested in the real power system network.

·

The optimization process of the MPEC is recommended to be further investigated to enhance its capability for different types of disturbances that could occur in the real power system.

·

The optimization procedure for the MPEC is recommended to be further developed for other applications such as control of flexible ac transmission systems.

97

98

Bibliography

[1]

P. Kundur, Power System Stability and Control, McGraw-Hill, cl994, pp699-827.

[2]

IEEE Std 1159-1995, IEEE Recommended Practice for Monitoring Electric Power

Quality, ppl-9.

[3]

G. Rogers, Power System Oscillations, Kluwer Academic Publishers, 2000, pp28-50.

[4]

K.T. Law, D J. Hill, N.R. Godfrey, "Robust controller structure for coordinated power

system voltage regulator and stabilizer design" , Control Systems Technology, IEEE Transactions on , Volume: 2 Issue: 3 , Sept. 1994, pp220 -232.

[5]

IEEE Digital Excitation Applications Task Force, "Digital Excitation Technology--

A Review of Features, Functions and Benefits," IEEE Transactions on Energy Conversion, Vol. 12, No.3, September 1997.

[6]

Y.N. Yu and H.A.M. Moussa, "Optimal Stabilization of Multi-machine Systems",

Power Apparatus and Systems, IEEE Transactions on, pp. 1174-1182, May/June, 1972.

[7]

Y.N. Yu, Electric Power System Dynamics, Academic Press, 1983, pp95-137.

[8]

C. Mao, J. Fan, O.P. Malik, G.S. Hope, "Studies of real-time adaptive optimal

excitation controller and adaptive optimal power system stabilizer" , Energy Conversion, IEEE Transactions on, Vol.7, Issue: 3, Sept. 1992, pp598 -605.

[9]

Y. Zhang, G.P. Chen, O.P. Malik, G.S. Hope, "A multi-input power system stabilizer

based on artificial neural networks", WESCANEX 93. "Communications, Computers and

99

Power in the Modem Environment.' Conference Proceedings, IEEE, 17-18 May 1993, pp240246.

[10]

A.M.D. Ferreira, J.A.L. Barreiros and J.R. Brito-de-Souza, "Fuzzy Power System

Stabilizer Including a Fuzzy PI Controller", UKACC international Conference on Control'98, 1-4 Sept. 1998.

[11]

J.W. Finch; K.J. Zachariah; M E. Farsi, "Generalised predictive control applied to a

turbogenerator voltage regulator". Electrical Machines and Drives, 1989, Fourth International Conference on, 13-15 Sep 1989, ppl30 -134.

[12]

Z. Liang; H. Zhang; H. Wang; H. Ni, "Holographic robust predictive control of

synchronous machine excitation for power system". Power Engineering Society Winter Meeting, 2000. IEEE , Volume; 1 , pp23-27

[13]

M. Saidy, "A unified approach to voltage regulator and power system stabiliser design

based on predictive control in analogue form", Electrical Power & Energy Systems. Vol. 19, No.2, ppl03-109, 1997

[14]

M. Saidy and F. M. Hughes, "A predictive integrated voltage regulator and power

system stabilizer". Electrical Power & Energy Systems. Vol. 17, No.2, pplOl-111, 1995

[15]

IEEE Std 1110.-2002, IEEE Guide for Synchronous Generator Modeling Practices

and Applications in Power System Stability Analyses, pp6-28.

[16]

J.M. Maciejowski, "Modelling and predictive control: enabling technologies for

reconfiguration". Electrical Power & Energy Systems. Vol. 19, No.2, ppl03-109, 1997

[17]

J.M. Maciejowski, Predictive Control with Constraints, Prentice Hall, 2001.

100

[18]

E.F. Camacho and C. Bordens, Model Predictive Control 2"** edition. Springer, 2003.

[19]

K.J. Astrom, B. Wittenmark, Adaptive control second edition, Addison-Wesley

Publishing Company, 1995, pp90-ppl37

101

102

Appendix I
a. Base values fo r per unit

Per unit

For using per unit, the base values are defined as the following.

Stator winding base values

^^base ^sbase fbase Isbase ^base O ^m base ^sbase Lsbase y^sbase Tsbase tbcLie

the 3-phase volt-ampere rating of machine (MVA). the rated line-line voltage RMS value (kV). the rated frequency (Hz). yA.taselesbase, the rated phase current RMS value (kA), line current/-^3 . '2-^fbase=(Oo, the rated electrical rotor speed (electrical rad/s). '^`(ObasJpf, (p/=number of poles) the mechanical rotor speed (mechanical rad/s). esbase!isbase, the impcdancc (Q). 'Z^sbasJcobase, the inductaucc (H).
Lsbaseisbase~^sbase!(^base,

the fluX linkage (Wb.tUmS).

^^base!(^mbase~ PfPsbase!sbase!'^, the tOrqUC (N.m). llcûhase=y^(), the time (s).

Field winding base values

ifd b a s e

-- ~
--

! s b a s e L a d ! ( ^ '\ ] ^ / '^ l- ^ a fd ) ,

the CUITent (kA).

^fdbase
^d b a se

VAbase!ifdbase, the VOltagC (kV).
ifd b a s e !ifd b a s e , t h e im p c d a n C C (O ).

Lfdbase
y ^ fd b a s e

= ~

ZfdbasJcobase, the inductancc (H).
L fd b a s e ifd b a s e ~ ^ fd b a s e !o )b a s e ,

the fluX lin k age (W b.tU m s).

103

d-axis damper winding base values
ild b a s e ~ is b a .'s e L a c ll( .'^ ^ / ^ ^ a J d ) i ^ ^ 6 C U I T C n t ( k A ) .

^ Id b a se

~

^ ^ b a s e H ld b a s e ^ t h c

V O ltâ g C

(k V ).

^tdbase ~
^Id b ü se --

ths impcdsilCC (O).
Id b a s e l^ b a s e ^ t k c in d u C tâ llC C (H ).

y^Jdbase

~

Lldh(iseildbase~(^Idba.self^baset t h c fluX l i ü k â g C

( W lj.tu r n s ) .

q-axis damper winding base values

ik q b a s e

--

i s b u s e ^ u q l (  \j 3 / 2

Lakq}, th c

C U IT C n t ( k A ) .

^kqbase

--

^^baseU kqbasei

th c

V O ltâ g C

(k V ).

^kqbase ~
L kqbase ~

^kqbaseUkqbasei thc ilTipcdiinCC (fi).
'^ k q b a s e l^ b a s e i t h c in d u C t& n C 6 ( H ) .

^kqbase

~

L k q b a s e tk q b a s e ^ ^ k q b a s e l^ b a s e f th C

flu X

Ü llk â g C

( W lj.tU m S ) .

w h e re

s u b s c r i p t A: i s

1 o r 2

th a t re p re s e n ts

th e

firs t o r s e c o n d

d a m p e r in

th e q -a x is .

b. Inductances in per unit

F ro m

e q u a tio n

( 2 .5 ) , th e

flu x

lin k a g e

a t th e d -a x is o f th e

s ta to r c a n

b e

e x p re s s e d

as:

¥ d

~

~ ^ d h

+

^ '^ / '^ ^ a f d ^ f d

(A I. I)

w h e re

th e m u tu a l flu x

lin k a g e

y / ^ f d i - -\] 3

/

i^ y ) p r o d u c e d

b y t h e c u r r e n t ifd c a n

b e

e x p re s s e d

in

p e r u n it a s:

¥ a fd

-

y l^ l^ ^ a fd ^ fd ^¥ sh a se ~

^ fd ^ a fd

(A I .2 )

w h e re

=

L ^h a Jsb a se

th e b a s e

v a lu e s o f th e

s ta to r q u a n titie s d e fin e d

a b o v e .

104

"

K fd -

 'I W ^ ^ a f d

/ fdbase li^baseLbase ) IS thc mutual inductancc L a f d in per unit, thc field current in per unit,

hd ~ h d ^^ fdbase

Using the base value of the field current is defined above,

can be written as

^ a fd

fdbase ^ ^ ^ s b a s e ^ s b a s e ^

= = hd

K ^ j3 /2 k f,m L ,^ J .^ ) =L ^IL ^,,

(AL3)

Similarly, the relationships of the following mutual inductances can be derived using the per unit system defined above.

^ a fd = h d ^ a \d = K d ^ a lq = K q fa iq = ^aq

(AI.4)

c. Torque in per unit

With the base value of the torque 7 )^ = obtained:

/ 2 , the torque in per unit can be

T

T

/T

^ f^ W d ^ q

W q h ^ , P f ¥ s b a s e K base

e =re T. /Z L , -

2

2

(AI.5)

--W d^q

¥qh

d. Voltage equations in per unit

105

By neglecting a small variation of (y^by setting it to be one in per unit, the voltage equation (2.8) in per unit is obtained as below:

k --

(A I. 6)

With the definition of the flux linkage base values, the rotor winding voltage equations in per unit are obtained as below.
P W fd P ¥ fd fdbase ~ ( ^ f d ~ ^ f d ^ f d ) ^ W f d b a s e ~ ^ b a s e ^ P fd ~ ^ f d ^ f d ^ ^ fdbase ~ ^ b a s e ( ^ f d ~ ^ f d ^ f d )

=

0)q (  jy -- R j j

)

Similarly, Py^fd ~ ^ o (^fd ~ ^fdhd )
P W \d ~ ~ ^ o ^ \ d h d P ¥ \q - ~ ^ V ,^ \q h q

(AI.7)

PWlq --~P^Q^2qhq

106

Appendix II

Derivation of some equations

a. Initial values o f the current It, the power angle Se and power factor angle ç

For the generator and power network shown as in Figure 2.4, the equivalent resistance R e is very small comparing the reactance X e, it is usually ignored in the power system study. With given terminal voltage V,, equivalent voltage Ve and terminal power P,, referring the phasor diagram shown in Figure AII.1, the apparent power is.

Vt

Figure AII.1 : Phasor diagram of V,, Ve and /,

5, = P, + jQ, = V j* = y, [(V, - Ve cos
= s in COS

- jV^ sinô,,)/jX^]*

(An.i)

where Se is the power angle by which V, leads Ve- It can be expressed as below. = arcsin(X^P, IV,Ve )

The terminal current and power factor angle are solved by,

(AIL2)

107

(p = c t g - \ P , / Q , )

(An.3)

b. Initial values fo r saturation effects

With the terminal voltage V, and current It, the saturation can be decided as the following. To obtain the saturation factor for the initial value, from (2.25) the air-gap flux are expressed as.

(An.4)
[W aq +44

In per unit the air-gap flux is equal to the air-gap voltage y/sai=Vsat and with the equation (An.4), the air-gap voltage is given in vector forms as

(AH.5)

where X/ is equal to Li in per unit.

'sat

Ralt

Figure AII.2 : Phasor diagram for the terminal voltage and air-gap voltage

108

The phasor diagram is shown as Figure AII.2, and the air-gap flux is obtained as

,at

+sin ^

COSÇY + { I , s in ç + X ,I, c o sç Y

(An.6)

then using (2.24) and (2.26) to obtain the saturation factor. The inductances Lads and Laqs are replaced by the saturated values by (2.23) and inductances Lds and Lqs are updated as below.

(An.7)

c. Obtaining Initial position o f the q-axis

The q-axis position is referenced to the equivalent voltage V, with the angle < 5 .

From the

equivalent circuit Figure 2.2, the dq components are expressed as the following equation at the steady state (iiq=i2q=iid=0 ).

(AH.8)

Substituting into (AH.4)

\^q ~ ^fd^ad ^Jq ^d^d \^d ~^q^q~

(An.9)

Rewriting in phasor form.

V ,= e^ + je^ = -R ^ (iq + jiq ) + (~jiq ~ id ) J^g + Ji/d ^ad = where jL j,-R J , = jifjL^d ~ Rd (^</ ~ 4 )

Pd (^d

^g )

(An. 10)

109

The phasor diagram for the terminal voltage V, and current 7/ at the d-axis and q-axis is shown in Figure AII.3. The voltage behind Ra^]Xq is defined as Eq that lies along the q-axis.

Using this phasor diagram, Along with V, , there are another two components RaIfios(^ and %y.,7,sin(p. XqsIiCOSip. expressed as. Along with the 90 degree leading to V,, there are two components -RJtSiTup and With this analysis, the power angle < 5 , by which Vt leads the q-axis can be

4 = tan '[(X^/,cos^-i?/,sin^)/(V; -(-/?/cos^+JSf^/,sin^)]

(An. 11)

q-axis

d-axis

Figure AH. 3 : Phasor diagram of Vf, I, and components at the d-axis and q-axis

Voltages and currents at the d-axis and q-axis on the stator can be calculated as,

eg=V,co&S. e^=V,sin4 i^=I,coiS.+ ç) i^=I,sïï{St+(p) (AU. 12)

110

From (2.20), the flux linkages at the d-axis and q-axis and the air-gap flux linkage components on the stator winding are

The power angle ô by which Ve leads the q-axis can be expressed as,

S = S e + S^= arcsin^g/^/%Vg)+tan"' [{X J, c o s ç - RJ, sin^)/(% +RJ, cos^+ X^J, sin^)] (Afl.14)

where 1, is the terminal current of the generator, and (p is the power factor angle at the given operating condition. X^s is reactance of the stator winding at the q-axis. equals to L^j in per unit which is saturated value. Its numerical value

d. Obtaining Initial value fo r the fie ld winding variables

At the steady state, all time derivatives are equal to zero.

So currents on damper windings

are zero {iici=i2q-iid=^) in (2.19), and the flux linkages of damper windings are equal to the corresponding axis air-gap flux linkages {ii/]q=y/2q=igaq^T^^ Vid=¥ad) in (2.19). and equivalent circuits in Figure 2.2, From (2.19)

\¥ad-- ^adJd
¥aq = - ^ a jq

^ads^fd
+

^adshd
+ ^ "g s h q

(All. 15)

Substitute currents ijq, ig,, hd and ifd from (2.19) into (Afl.15) to eliminate terms of currents.

111

Wad~^adÀ

^Jd'^¥\d^

'

(A n . 16)

y¥aq - KqÀ~^q '^¥\q/ ^q '^Vlq ! ^2q) where |C ,= 1 /(1 /L ,, ,,+ 1 /L ,,+ 1 /L ,, ) K . = 1/ 0 / 4 , , + I / A ,+ 1 /4 ,)

From (2.19),

and y/id=\(/ad, the flux linkage, the field current and voltage are obtained

¥ fd ~ ^ f d ( ¥ a d / i f d = ^ ¥ fd - ¥ a d ) fh d

~ î^lrf / 4 r f )

(AH.17)

^fd - hd^fd

e. Obtaining current with updated state variables

During the transient process, the state variables are updated by solving the differential equation, the current is obtained as the following. following terms. For simple in writing, define the

H = kq si¥^qf^^q + ¥2q ^L ,^)
~

(An. 18)

^ads ^ f d

/ ^ fd ^ ¥ \ d ^ 4 d )

Then with (AH. 15), we have

\¥ o d ^ ^ -K d .h \}¥aq =^'d -Laqjq

(An. 19)

With the equations of (2.19) and (AH. 19)

^d - ~¥aq - Kh + 4 /, -^d~ 4*/, - Kh
= ¥ad K iq 4 4 = I^ J d R J q

(An.20)

112

where

1 4 - 4 + 4 ,. V'ds and L " qs are also called the d-axis sub-transient inductance and the q-axis sub-transient inductance respectively.

By using (2.22), solve currents Id and Iq as,

^E^Bd^^^E +^ EJ q · ` ' E ^ ' d ~^E^Bq E^Bq ~ ^ E ^ ^ B d J '^ ^ E ^ P, =(^E^Bd ~^E^Bq +^E^q " ) / ( 4 + ^ |) Bq ^'E^q

(AH 21)

Eliminate terms of Cd and e, by substituting (AII.20) into (AII.21), currents id and i, are presented in terms of e " d, e"q and ô as the following equations.
\^d ~ ^ B c o s (5 ) -( /? £ + R J { e j +C g sin<5)]/[(/?£ + ( ^ £ + 4 J ( ^ c + ^ ,y .)] 22)

\ i q = [ ( 4 + 4 X ^ 9 -ggCOS<$) + (X g +

+  g sin<5)]/[(^£ +/?,,)^ + (% g +X_^,)(%g

where X"ds and X "qs are reactances corresponding to L"ds and
L"qs in per unit with a>=1.0 pu (X"ds= (ûU'ds and X'4=<»L'4)-

they are equal to L '4 and

f.

Obtaining torque and voltage in the perturbed value

From the equation (2.13) and (2.20), the electric torque is expressed in terms of as (AH.23).

i j / a d ,

and

y/aq

Te=¥adiq-¥aqid

(A U .23)

To find the A 4 in terms of Ay/fd and Aô, all components of 4 (AU.23), the perturbed value of
¥ad, Waq,

id and iq should be found in terms of

y/fd and S

at first. From Figure 2.3 and equation

(2.19),

113

[d - ^ f j f d '^Wad

¥a d- ^ad(-^ fd~ h ) ¥a g~ ^a q ^g
Eliminating the term of i/d in (AH.24),

(AH.24)

¥ad -

^ ~ K dh

+

^ a d ¥ fd !

+

i^ ad ^ ^ f d ) ~ ^ a d

(

L

+

¥ fd ^ ^ f d

)

(AH.25)

The air gap flux linkage y/ad and y/aq is expressed as,

I¥ad ~ ^ad ( h ~^¥fd^ ^fd ) \¥aq ~~^ag^g where ) is called the d-axis transient inductance.

(AH.26)

Similarly solving network equation in the section 2.6.2 as (2.30), using (2.20) and (2.22), we can obtain the expressions of id and ig in terms of y/fd and < 5 ;

Uq
[ig

=[(-^£ + ^ g)i¥fj^ aJ^ (^ aj'^ h d^ ~ ^ B c o s S )-(R ,r

sin<^/[(/?£ + R ^ ) +(%g + X ^ ){X ^ +-^d)]
sm S]/[{R^+RJ^

27)

=[(^£ + K ) ( ¥ f A d /(4d

cos<5)+(Xg + X g ) e ^

+(%g +%,)(%£ +X )1

where X'd and Xg are d-axis transient reactance and q-axis reactance of the generator with saturation, and they are equal to corresponding inductances (L L 'ad^Li and L^) in per unit.

By defining R^=R^+ r ^ X^^=X^ + X^ X ^ ,= X , + X , D^=R^ + X^^X^g

pd =\.^Tg(¥fdkdKLad +Lfg)-eBCosâ)-Rj.egSinS\I p, = [& (¥fd^ad /(4d + ^/d) - cosS)+Xj^eB sin<^/

(AH.28)

114

All values at the operating point are expressed with subscript 0, for instance, ijo means the value of id at the operating point. The perturbed value of id and i^ are approximately derived as the following.

\i, =i,o+A/, ^[X^^{(y^^,,+Ay/^,)L^J{L^^+L^^)-e,cos0,+Aâ))-R,e,sm{S,+Aâ)]/D^ K ^V =[^A(Wfd0 +^¥fj)i-ad lif-ads + ^fd)-^B cos|% +AS))+ X'j-jBg sin(4 +AS)]/Dj.

(AÏÏ 29)

* W 0~^^d ~^^Tq¥fdAad^^^ad ^fd^V ~A^T¥fdAad ^A ^ad +^/(/)1^^7'

A X j^AI//^jL^j I{L^ +L^^)]/Dj + (An.30) fd^ad ^A -'ad
X j.^eg (sin J(, c o s A J + c o s J q s in A < 5 )]/D y

[-% y^gg(cos<^ c o s A J - s i n J q s in A ^ -7 ? ^ e g (s in ^ o c o s A ^ + c o s ^ o s i n A ^ ] / D j .

[-Rj.eg(cosSQ c o s A < J -s in Jq sinA<5) +

With A <5 is small enough, sinA^=A5 andcosA<5=l.

^dO ~ ^ ^ d ~ ~ ^ ^ T q ^ ¥ fd 0 ^ a d

^A-` a d ^fd ^ COsAq) [^gi^Tg sin<5g Rj- cosÔçf)AÔ+Xj^L^j
^ fd ) ~ ^B

R j^ g SII\Sq]/D j- +

+L^j)Ay/'^j\lDj

(An.31)

^qO

A f ^ r iW f d O ^ a d ^^^ad

~ ^ Td^B S În < 5 o ]/D y +

[gg(/?j- sin<^ ~^Td C O sSq )AS +RjL^^ K^ad ^fd^^¥fd^^ where with (AE.27) + L ,J-g g C o ^ )-/(,g g S m ^]/A \iq O" [^r ((^fxlO ^a d/ (^ad ^fd )~^B C O S O q) + X j^C qSin^Q] / A

Aid and AL are expressed in terms of perturbed values Aij/fd and A < 5 as the following:

fA/j =miAô+m2Ayrjrj [Ai^ =n^AS+n2Ai//f^ where m, = sin<5g - /?^ cosSq)ID j. «2 = (/?j.^ ) /[Z)y + Lfj )]

(An.32)

n, = g(Rj. sin Jg - X^d cos^ ) / D j

From (AH.26) and (AH.32), the flux linkages Ay/ad, and Ayjaq are expressed as below:

115

[^Ya d~ ^ad( ^^d ^

^ ^fd) ~ (^^ ^fd ^2^^ad^V ^fd

(An.33)

l^y^a, = - 4 ,A f , ^-n^L^^Ay/j, -n,L^^AÔ

From (AH.23), (An.32) and (An.33),
A^g ~WadQAiq Al//g^i^Q ~ WaqoAid ~ A^aq^dO

ATg = k^AÔ + k 2Ay / fd

(AH.34)

where
~ ^ 1 ( î^ a d O

^a q ^d O ) ~ ^ \ (W aqO

^a d ^ q O )

^2

~

^ 2 ( t^ a d O

^a q ^d O ) ~ ^ 2

aqO

^ad^qO )

'g O ^ a d ^ ^ / d

Similarly, obtaining the terminal voltage in terms of Ay/fd and AJ is as the foUowing. From the equation (2.20), A^d =-R,Ai^ + L,Ai^-Ay/^^ Ae^ = -R^Ai^ + LfAij - A and with =ed^Ae^+e^^Ae^
AV, ^kj,A5+k^Ay/f^

(An.35)

(An.36)

where h - 77^ + Z^n, + L n, ] + [-/?,,«! - L,rn^ - L^n\ ] y. /O
[-& « 2 " + 4 d (1 / ^ /d " "*2 ) ]

K ~ - ^ \ - R a ' ^ + Z ,« 2 + L ^ / l 2 ] +

W O

wo

V,o, qo and edo are the value of the terminal voltage, its q-axis and d-axis components at the operating point.

g. N-step predictive control algorithm

The prediction model is built based on the state equation as below.

116

\x(k + N \ k ) = A x(k + N - l \ k ) + Bu{k + n ^ - l \ k ) [y{k + N \ k ) = Cx(k + N \ k )

(An.37)

Using this prediction model, the system outputs y{k+i\k) (i=l,2...A0 are predicted over the interval time N starting at the instant k. These predicted system outputs are functions of the measurements y (&) and the control inputs u(k+j\k) (j=0, 1... n,,-l).

In the general form of the MPC, the A^-step-ahead system outputs and tiu control inputs are considered in the performance index J. The performance index is shown in matrix form as the equation (AII.38).

J= -

2

RAu)

(An.38)

where 'r ( t + D ' r{k + 2) r(k + N) Ô1 0 0 02 0 = 0 I, 0 Rj = 0 0 Z 2 ... ... ... y(k + l\k) y(k + 2\k) yik + AZ1Æ ) o' 0 u{k 1k) u(k + \\ k) u{k + n ^-l\k)_ Ri 0 0 0 R2 0 ... ... ... u (k - l) u (k - l) u{k - 1) O' 0 0 Qi --
_

Ae -

-

Au --

-

... ··· ·· ·

0 0

R=

0 0

^2 0

.

0

0

Qi (i=l,2...N) is the system output weight matrix for the Z-th predicted outputs.

It is the

positive diagonal matrix which the size is the number of system outputs y (the system outputs in dimension m). Its elements k, to k^ are the positive weight coefficients corresponding to the each system output. Rj n j is the control input weight matrix for the;-th control

117

inputs. It is the positive diagonal matrix which the size is the number of control inputs u (the control inputs in dimension /). Its elements l\ to /y are the positive weight coefficients

corresponding to the each control input.

At the instant k, the control input u{k\k) includes two parts shown as the equation (AII.39), one part are the control inputs u{k-\) at the last instant ^-1, and another part ^iu{k\k) are the increments of the control inputs at the instant k, which are calculated by the control algorithm.

u{k\k) = u {k -\) +Au{k\k)

(AII.39)

At the instant k+ 1, the control input u{k+ 1|A :) consist of the control inputs u{k\k) at the instant k and the control input increments \u{k+l\k) at instant k+1, which are calculated by the control algorithm.

u(k + 1|A:) = «(A:|A:) + Au{k + l|/c) = «(fc-l) + Au(k | k) + Au(k +11/:)

(AII.40)

Similarly,

u(k + n u - l \k ) = u{k -1) + Au{k | k) +... + Au{k + nM- 1 1A :)

(AH.41)

For only

control inputs are considered, at the instant k+n^, the control inputs remain the

same values as those at the instant k+riu-1.

u(k+nu\k) = u ( k - \) + Au(k \k) +... + Au{k + n u - \\ k)

(ATT49.)

Until the (V-th step,

u(k + N \k ) = u{k -1) + Au{k \k) +...+Au{k. + n u - \ \k )

(AII.43)

118

where the term (A:4-JV|/r) means the value at the instant k+N that is calculated at instant k.

From the equation (AII.37) to (AII.43), the predicted results of state variables and system outputs can be rewritten as the following.

At the first step prediction,

x(k + 1 1/c) = Ax(k) + Bu{k | k) = Ax{k) + Bu{k -1) + BAu(Jk \ k) y (k + l\k ) = Cx{k + \\k ) (An.44)

At the second step prediction, substitute the first step results (AII.44) into the second step prediction model (AII.37),

x(k + 2 1A :) = Ax{k + 11A) + Bu(k +11A) = A[Ax(k) + Bu(k IA)] + fi«(A +11 A) = A^x(k) + ABu{k\k) + Bu(k + l\k) = A^x(k) + AB[u{k -1) + Au{k | A)] + B[u(k -1) + Au{k | A) + Au{k + 11A)] = A^x(k) + (A + I)Bu(k -1) + (A + I)BAu{k | A) + BAu{k + 11A) y(A + 2|A) = C;c(A + 2|A) (AH.45)

Similarly,

x(A + rt,, 1A)=A""JC (A ) + (A"""' +...+A+I)BUk-\) +{A""~` +...+A+l)BAu(j<.\k)+...+BAu{k +n^ -1|A) y (A + IA) = Cx{k + | A) (AH.46)

From the end of control horizon A+n,, on, thecontrol input increments remain the same value as Au(k+riu-l\k).

x(k +\ +1|A)=A""^^JC (A ) + (A"" +...+A + /)jBa(A-l) + (A"" +...+A +I)Bàu(k\k)+...+{A + I)Bâu(,k+n^ -1|*) y(A + n,,+ l|A ) = Cjc(A + n,,+IlA) (An.47)

119

Until the A^-step,

- f

î>

x(k+N\k)=A'" xik)HA^~' +...+A+I)Bilk-l)+{A''~' +...+A+I)Biu(k \^)+...+(A^'~ +...+A+I)Bâu(k+n^ -1 1 k) y(k + N \k) = Cx(k + N \k ) (An.48)

The equations (AII.44) to (AII.48) are expressed in matrix form as the below.

B
x ( Â : + l |Â :)

B AB+B

0 B
n^-2

0 0 0 0

'A % A `B

x{k+nu\k)
=

A'"

x(/c) +

i=() nu

Au(k Ik) Au{k+\\k) Au(k+n^ - lU )

u(k -- 1) +

x(k+nu+l\k)
'ji-i

Z fiB
i=0

Z
N -2

a 'b

...

B
N-n^

i= 0 .

N-1
_i=0

xi k + N l k )

_A^

' £ a `b
i=0

...

Z
i=0

a 'b

J=o

y(k + \\k) y{k + N IA)

C 0
0

0 ... 0 C ... 0
0
... c

x(A +11k) x(k + 2\k) x{k + N |fc)

(An.49)

In the more compact matrix form, the above equations (AH.49) are expressed as below.

-- A'x(k)+B'u{k -1) + B'Au [Y =C'A'x(k)+C'B'u(k-1) +C'B'Au where jc(Â:+l|Â:) A u{k\k) y(k+ \\k) x(k+nu\k) Y= X= x(k+nu+l 1k) _x(k + Ni k) Au = y{k + N\ k) Au{k + l\k ) A' = Au{k + n u - \ \ k ) _A^ A ATM

(AE.50)

120

B c c '= 0 0 0 c 0 t , A `B . . o' 0 ;
I .

B AB + B

0 B n,-2 Y , a `b
i=0

0 0 ... 0 0 B \
.. .

-£ a 'b J i= 0 B" = f ^ A 'B B' = i=0 _ J^AB N-1 Y , A `B - i= 0

N-2 ÿ / 1 'B i= 0

y A 'B ,=0

The predicted results include two components of the future process;

One part, which is in terms of x{k) and u{k-l), is the naturally moving ahead of the system process and is uncontrollable. This part is used to calculate the system output differences from their references. With this component, the differences between the predicted system outputs and their references are expressed as below.

Err(k) = Y^Jk) -C 'A 'x (k) -C 'B 'u{k - 1) where (it) = [r(Jt + l) r{k + 2) ... r(Â:+ A^)f are the references.

(An.5i)

Another component, which is in terms o ïA u , consists of the control inputs that are calculated to minimize the differences calculated by above. components from the reference are expressed as below. The output differences included two

J e^E rr(k)-C 'B "A u

(An.52)

With the above equation (AII.52), the performance index J (AII.38) is rewritten as the following.

J = (Err(k) - C 'B 'J u f Q{Err{k) - C'B'Ju) + Ju^RAu J = E rr{ k f QErr{k) - 2 Au^ ( C 'B y QErr(k) +Au^ ( ( C B 'f Q(C'B') +R)Au = constant --2Au^G + Au^ HAu

(An.53)

121

wher^ G = H =(C'B"fQ(C' B ') + R

Finding the gradient of J and setting it to zero.

dJ / dJu = 0

(An.54)

The control inputs can be obtained as below.

Au(k) = H 'G

(An.55)

Finally the first optimal control inputs Au{k\k) are applied to the controlled system. At the next time instant k+l, this process is repeated all over again with the prediction horizon shifted one step. All values will be updated to the next time k+l, and the control inputs u(k+l\k+l) will be obtained and applied to the system.

122

Appendix III

The generator parameters

A generator to a power system shown in Figure AHI. 1 is used to research. Xt is the reactance of the transformer and XII and X12 are the reactance of two transmission lines.

LT

HT

EB

AAA/AAAr
Xt X11

AAAXI2

Figure AIH. 1 : A generator to a power system

The generator parameters are given in Table AIII.l.

All Reactance are in pu based on

555MVA and 24Kv Base. This generator is used for studying the excitation control only.

Table Am. 1 : The parameters of the generator connected to a power system
S yste m P a ra m e ters S a tu ra tio n AVR CPSS In itia l va lu es

S=555MVA V=24kV f=60Hz Poles=2 H=3.5MWs/MVA
Kd=0.0

Xd=1.81 Xq=l .76 X,=0.16 Xn=0.165 X,d=0.1713 X,q=0.7252 X2q=0.125

Ra=0.003 Rfd= 0.0006 Rid=0.0284 Riq=0.0062 R2q=0.0237 Xi=0.15 X ,,=0.5/X ,2=0.95

·Asat-- 0 .0 3 1 B sat -- 6.93 T ti=0.8

Ka=200.0 Tr=0.015 s Efm ax-- 2.0 Efmax=6.4

Ks,ab=9.5 T q=1.41 s T ld=0.154 s T lg=0.033 s

P=0.9 Q=0.436 E,=].0

Yy;-- C O

123

Appendix IV

Matlab codes for the MPEC simulation

clear all;% clear all variables in memory

%Choosing the study case by selection of operating condition, disturbance and excitation control
%

Select different excitation control separately, the comparison can be shown in the same figure

%The study cases can be down by setting as the following,
% %

Case l:operating condition Pt=0.9and Qt=0.436,Disturb=l and Exciter= 1,2,3 uncomment Figure 1 Case 2:operating condition Pt=0.9 and Qt=0.436,Disturb=2 and Exciter=l,2,3 uncomment Figure 1

%Case 3:operating condition Pt=0.9 and Qt=0.436,Disturb=3 and Exciterai,2,3 uncomment Figure 1
%

Case 4:operating condition Pt=0.9 and Qt=0.436,Disturb=4 and Exciter= 1,2,3 uncomment Figure 1

% Case 5:Disturb=l and Exciter=3, and operating condition Pt=0.1,0.4 and 0.9 uncomment Figure 2 %Case 6:operating condition Pt=0.1 and Qt=0.1,Disturb=l and Exciter=3
%

comment/uncomment the line 142,uncomment Figure 1

%Case 7;operating condition Pt=0.9 and Qt=0.436,Disturb=l and Exciter=3 % change the weight coefficient at the line 95,uncomment Figure 1

% Case 8:operating condition Pt=0.9 and Qt=0.436,Disturb=l and % Exciterai ,3 comment/uncomment the line 164,uncomment Figure 3

%Case9:operating condition Pt=0.1 and Qt=0.l,Disturb=l and % Exciterai ,3 comment/uncomment the line 164,uncomment Figure 3

% Case 10:operating condition Pt=l .0 and Qt=0.436,Disturb=l and % Exciter=l,3 comment/uncomment the line 164,uncomment Figure 3

%

Choose the operating condition by setting the terminal voltage Et and Active power Pt and reactive power Qt

Et=1.0;Pt=.l;Qt=0.1;
% %

Choose the disturbance; 1 for Large;2 for Medium;3 for change voltage reference -0.02pu;4 for change the mechanical torque -5%

Disturb=l;

% Choose the excitation control: 1 for AVR+PSS;2 for AVR only;3 for MPEC;4 for self-turned MPEC
Exciter=3;

%

sample time and fault occur and clear time:

% ti,tp,tc,ts and tmax are initial time,pre-fault time,fault cleared time,sample time
%

and maximum simulation time respectively.

ti=0.0;tp=0.1;tc=0,17;tt=1.0;tmax=5.;ts=0.01;n=3;

124

%

generator parameters impedances and resistances

% Xadu and Xaqu are unsaturated mutual reactances at d- and q-axis % Xl,XfI,Xld,Xlq and X2q are leakage reactances of stator winding, % field winding, damper windings at d- and q-axis respectively.
Xadu=1.66;Xaqu=1.61;Xl=0.15;Xfl=0.165;Xld=0.1713;Xlq=0.7252;X2q=0.125;

% Ra,Rfd,Rld,Rlq and R2q are resistances of stator winding,
%

field winding,damper windings at d- and q-axis respectively.

Ra=0.003;Rfd=0.0006;R ld=0.0284;Rlq=0.0062;R2q=0.0237;

% For saturation effects with the equation Fl=As*exp(Bs*(Fa-ftl));
As=0.03125;Bs=6.931;ftl=0.8;

% Inertia constant H and damping factor KD
H=3.5;KD=.0;

% Caculate initial value % Calculate current It, power factor angle Fi and current in vector IT
It=sqrt{Pt''2+Qt''2)/Et;Fi=asin(Qt/abs(It)/Et);IT=cos(Fi)-j*sin(Fi);

%

For the saturation

% Calculate the air-gap voltage Ea and flux Fa to find the saturation factors Ksd and Ksq
Ea=Et+(Ra+j*Xl)*IT;Fa=abs(Ea);Fl=As*exp(Bs*(Fa-ftl));K sd=Fa/(Fa+Fl);K sq=K sd;
% %

Update all reactances with saturated values Xads and Xaqs are saturated mutual reactances at d- and q-axis.

Xads=Ksd*Xadu;Xaqs=Ksq*Xaqu;

% Xadsp and Xaqsp are saturated transient reactances at d- and q-axis Xad' and Xaq'.
X a d sp = l/(l/X a d s+ l/X fl);X aq sp = l/(l/X aq s+ l/X lq );

% Xadspp and Xaqspp are saturated subtransient reactances at d- and q-axis Xad" and Xaq".
X a d sp p = l/(l/X ad s+ l/X fl+ l/X ld );X aq sp p = l/(l/X aq s+ l/X lq + l/X 2q );

% Calculate saturated Xq,Xd",Xq"
Xqs=XI+Xaqs;Xdspp=Xadspp+Xl;Xqspp=Xaqspp+Xl;

% Calculate power angle and ed eq id iq and ifd etc initial values
%

the angle between terminal voltage and q-axis

deltat=atan((Xqs*It*cos(Fi)-Ra*It*sin(Fi))/(Et+Ra*It*cos(Fi)+Xqs*It*siii(Fi)));
%

the angle between terminal current and q-axis

ang=deltat+Fi;

125

% voltage and current components at d- and q-axis ed,eq,id and iq
ed=Et*sin(deltat);q=Et*cos(de!tat);id=It*sin(ang);iq=It*cos(ang);

% solve algebraic equation at steady state with condition damper winding current ild.ilq,i2q % and speed deviation RPM are zeros
ild=0;ilq=0;i2q=0;RPM =0;

%obtain air-gap flux fad and faq; field winding current ifd, voltage efd and flux ffd
fad=eq-i-Ra*iq+Xl*id;faq=-Xaqs*iq;ifd=fad/Xads+id;efd=Rfd*ifd;ffd=fad+Xfl*ifd;ifdO=ifd;

%obtain damper windings flux and electric torque, and mechanical torque TmO equals to Te
flq=faq;fld=fad;f2q=faq;fd=eq-rRa*iq;fq=-ed-Ra*id;Te=fd*iq-fq*id;TmO=Te;
%

obtain subtransient voltage Ed" and Eq"

Edpp=Xaqspp*(flq/Xlq+f2q/X2q);Eqpp=Xadspp*(ffdÆ fl+fld/Xld);

% %

Power network equivalent circuit parameters Reactances is changed for the three-phase short-circuit;

%prefault Xtp=XT+XLl//XL2, during fault Xf=XT and after fault Xtc=XT-i-XLl %where XT.XLl and XL2 are reactances of transformer and transmission lines
Xtp=0.15+0.5*0.93/(0.5-r0.93);Xtf=0.I5;Xtc=0.15+0.5;

%Obtain the equivalent bus voltage EB and power angle delta between EB and q-axis
EB=Et-j*Xtp*It*(cos(Fi)-j*sin(Fi));delta=deltat-angle(EB);EbO=abs(EB);
%

EB component at d- and q-axis

EbdO=EbO*sin(delta);EbqO=EbO*cos(delta);

%

Exciter parameters and limiters for AVR and PSS;

KA=200;TR=0.015;Kstab=9.5;TQ=1.41;TLD=0.154;TLG=0.033;Efmax=7.0;Efmin=-6,4; vmax=0.2;vinin=-0.2;

% initial value for the exciter
Efd=efd*Xadu/Rfd;Vref=Efd/KA+Et;vl=Et;v2=0;vso=0;py2=0;Efd0=Efd;Vtdes(l;6/ts)=l.;
%

for plot the initial values n=3

ET(l:n)=Et;TE(l:n)=Te;Fdelta(l:n)=delta;EFD(l:n)=Efd;IFD(l:n)=ifd;FRPM (l:n)=RPM ; VolI(l :n)=0;RPMI(l :n)=0;DRPM (l :n)=0;

%

Controller parameter Excitation and governor systems

%system output weight coefficients speed deviation Kw, voltage Kv and electric torque Kp % controlling input weight coefficient Ke.
Kw=8;Kv=l;Kp=0.05;Ke=5;
%

Self-turning weight coefficients pfacl is for Kw and Kp; pfac2 is for K v

p fa cl= l;p fac2= l;

126

% Main computing cycle start from n point and t from 0
k=3;t=0;
%

Define different colors for different controller comparison

colorel='g';colore2='k-';colore3='b';

% Starting while t<tmax; % Disturbances define % Disturbance 1 is large disturbance with a three-phase short-circuit on the generator bus
if D istu rb ==l;if t<tp Tm=TmO;Re=0.;Xe=Xtp;Eb=EbO;elseif t<tc Tm=Tm0;Re=0.;Xe=Xtf;Eb=0; else Tm=TmO ;Re=0. ;Xe=Xtc ;Eb=EbO ;end ;

% Disturbance 2 is medium disturbance with a transmission line switching off
elseif Disturb==2;if t<tp Tm=TmO;Re=0.;Xe=Xtp;Eb=EbO;elseif t<tc Tm=Tm0;Re=0.;Xe=Xtc;Eb=Eb0; else Re=0.;Xe=Xtc;Eb=EbO;end;

% Disturbance 3 is small disturbance with voltage reference changed with -0.02 pu
elseif Disturb==3;Vchg=-0.02;if t<tp

Tm=Tm0;Re=0;Xe=Xtp;Eb=Eb0;Vref=Efd0/KA-i-1.0;Vtdes(l:6/ts)=1.0; else Tm =Tm 0;Re=0;Xe=Xtp;Eb=Eb0;Vref=Efd0/K A+l+Vchg;Vtdes(l:2000)=l+Vchg;end;

% Disturbance 4 is small disturbance with mechanical torque changed with -5%
elseif Disturb==4;if t<tp Tm=Tm0;Re=0;Xe=Xtp;Eb=Eb0; elseif t<tc Tm=Tm0-0.05*Tm0;Re=0;Xe=Xtp;Eb=Eb0; else Tm=Tm0-0.05*Tm0;Re=0;Xe=Xtp;Eb=Eb0;end; end;

% Solve algebraic equations % Calculate the reactances when the power network changes
Rt=Re+Ra;Xtq=Xc+Xqspp;Xtd=Xe-i-Xdspp;D=Rt*Rt+Xtq*Xtd;Ebd=Eb*sin(delta);Ebq=Eb*cos(deIta);

% Calculate Ed" and Eq" with updated flux (state variable) fld,flq,f2q and ffd
Edpp=X aqspp*(flq/X lq+f2q/X 2q);E qpp=X adspp*(ffd/X fl+fld/X ld);

% Obtain the current and terminal voltage
id = ( X t q * ( E q p p - E b q ) - R t * ( E b d + E d p p ) ) /D ; iq = ( R t * ( E q p p - E b q ) + X t d * ( E b d + E d p p ) ) /D ; it = s q r t ( id ^ 2 + iq ''2 ) ;

ed=Ebd-Xe*iq;eq=Ebq+Xe*id;et=sqrt(ed"^2+eq''2);

% Flux and rotor winding currents
fd = e q + R a * iq ;fq = - e d -R a * id ;fa d = fd + X l* id ; fa q = fq + X l* iq ;f a = s q r t( fa d '^ 2 + f a q '^ 2 );

ifd=(ffd-fad)/X fl;ild=(fad-fld)/X ld;ilq=(faq-flq)/X lq;i2q=(faq-f2q)/X 2q;
%

Electric torque and output power

127

Te=fd*iq-fq*id;Pt=ed*id+eq*iq;Qt=eq*id-ed*iq;Fi=acos(Pt/abs(it)/et); IT(k)=it;ET(k)=ct;TE(k)=Te;PT(k)=Pt;QT(k)=Qt;FI(k)=Fi;IFD(k)=ifd;

%Calculate Controller parameters
ml=Eb*(Xtq*sin(delta)-Rt*cos(delta))/D;m2=Xtq/D;m3=Rt/D;nl=Eb*(Rt*sin(delta)+Xtd*cos(delta))/D;n2=Rt/D;n3=Xtd/D; kl=nl*(fad+Xaqs*id)-m l*(faq+Xadsp*iq); k2=n2*(fad+Xaqs*id)-m2*(faq+Xadsp*iq)+Xadsp*iq/Xfl; k3=ed/et*(-Ra*m l+Xl*nl+Xaqs*nl)+eq/et*(-Ra*nl-Xl*m l-Xadsp*inl); k4=ed/et*(-Ra*m2+Xl*n2+Xaqs'*'n2)+eq/et*(-Ra*n2-Xl*in2-Xadsp*(in2-l/Xfl)); Kl(k)=kl;K2(k)=k2;K3(k)=k3;K4(k)=k4;

% Using the fixed parameters kl k2 k3 and k4 calculated initially
kl=1.6249;k2=1.1164;k3=0.1768;k4=0.3782; % comment this line if using updated model by measuring current

% Saturation updating
if fa>=0.8 fi=As*exp(Bs*(fa-ftl));Ksd=fa/(fa+fi);Ksq=Ksd;else K sd=l; Ksq=Ksd; end; Xads=Ksd*Xadu;Xaqs=Ksq*Xaqu;Xadsp=l/(l/Xads+l/Xfl);

%

Excitation control define

% 1 for AVR+PSS; 2 for AVR only; 3 for MPEC
if Exciter==l Efd=200*Vref-200*vl+200*vso;color=colorel; elseif Exciter==2 Efd=KA*(Vref-vl);color=colore2; elseif Exciter==3

%Self-turning weighting
%

Check speed deviation

if sign(DRPM(k-2))~=sign(DRPM (k-l));if abs(RPM)<=0.0001; p fa cl= l; elseif abs(RPM)<=0.001; pfacl=3;elseif abs(RPM)<=0.005; pfacl=2;else pfacl=l;end;end;
%

Check terminal voltage

if abs(Vtdes(k)-vl)<0.001;pfac2=l;eIseif Vtdes(k)-vl>=0.05;pfac2=2;pfacl=l; end;

%pfacl=l;pfac2=l;pfac3=l; %comment this line for self-turning

%Weight coefficients
Q=[pfacl*Kw*120*pi 0 0;0 pfac2*Kv 0;0 0 Kp];R=Ke; P Fl(l:4)=8;PF2(l:4)=l;PFl(k)=pfacl*K w ;PF2(k)=pfac2*K v; % for plot

% Predict system output

128

DDdet(k)=120*pi*FRPM (k-l)*ts; E l= [2 -ts/2/H *kl;0 -k3;2*H/ts -kl]*[FR PM (k-l);DDdet(k)]+[-FRPM (k-2);Vtdes(k)-et;-2*H /ts*FRPM (k-

2 )];
E2=[-ts/2/H*k2;-k4;-k2]*[120*pi*ts];
%

Calculate controlling input

delta_u=-El.'*Q *E2/(E2.'*Q*E2+R); Efd=delta_u*Xadu/Rfd+EfdO; VolI(k)=VolI(k-l)+abs(Vtdes(k)-et);RPM I(k)=RPM I(k-l)+abs(RPM );color=coIore3; end

%delta_u( 1)=0.0164*( Vtdes(k)-v 1)-0.0216*FRPM(k-2)+0.0232*FRPM(k-1);

%

Exciter limitation

if Efd>=Efmax Efd=Efmax;elseif Efd<=Efmin Efd=Efmin;end;efd=Efd*Rfd/Xadu;EFD(k)=Efd;

% Solve the differential equations by fourth-order Runge-Kutta % The first 1/4
Kll=120*pi*(efd+Rfd=i=(fad-ffd)/Xfl)*ts;ffd=ffd-HKll/2; K21=l/2/H*(Tm-Te-KD*RPM )*ts;RPM =RPM +K21/2;py2=120*pi*K21/2/ts; K31=120*pi*(RPM)*ts;delta=delta-i-K31/2; K 41=120*p i*(R ld*(fad -fld )/X ld)*ts;fld =fld +K 41/2; K 51= 120*p i*(R lq*(faq -flq )/X lq)*ts;n q= nq + K 51/2; K61=120*pi*(R2q*(faq-f2q)/X2q)*ts;f2q=f2q+K61/2; K 71=l/T R *(et-vl)*ts;vl= vl+ K 71/2; % Voltage transducer K81=(Kstab/120/pi*py2-v2/TQ)*ts;v2=v2+K81/2;py5=K81/2/ts; % PSS K 91=l/TLG *(TLD*py5+v2-vso)*ts;vso=vso+K 91/2; % PSS

%

Update the state variables

Ebd=Eb*sin(delta);Ebq=Eb*cos(delta);Edpp=Xaqspp*{flq/Xlq+f2q/X2q);Eqpp=Xadspp*(ffd/XfI+fld/X Id); id=(Xtq*(Eqpp-Ebq)-Rt*(Ebd+Edpp))/D;iq=(Rt*(Eqpp-Ebq)+Xtd*(Ebd+Edpp))/D; ed=Ebd-Xe*iq;eq=Ebq-f-Xe*id; Te=(Eb*cos(delta)+Xe*id-i-Ra*iq)*iq-(-Eb*sin(delta)+Xe*iqRa*id)*id;fad=Eb*cos(delta)-i-Xe*id+Ra*iq-HXl*id;

% The second 1/4
K12=120*pi*(efd+Rfd*(fad-ffd)/Xfl)*ts;ffd=ffd+K12/2; K 22=l/2/H *(Tm -Te-K D*RPM )*ts;RPM =RPM +K 22/2;py2=120*pi*(K22+0.00*rand(l))/2/ts; K32=120*pi*(RPM )*ts;delta=delta+K32/2;

129

K 42=120*pi*(R ld*(fad-fld)/X ld)*ts;fld=nd+K 42/2; K 52=120*pi*(R lq*(faq-flq)/X lq)*ts;nq=nq+K 52/2; K62=120*pi*(R2q*(faq-f2q)/X2q)*ts;f2q=f2q+K62/2; K 72=l/TR *(et-vl)*ts;vl=vl+K 72/2; K82=(Kstab/120/pi*py2-v2/TQ)*ts;v2=v2+K82/2;py5=K82/2/ts; K92=l/TLG*(TLD*py5+v2-vso)*ts;vso=vso+K92/2;

^

Ebd=Eb*sin(delta);Ebq=Eb*cos(delta);Edpp=Xaqspp*(nq/Xlq+f2q/X2q);Eqpp=Xadspp*(ffd/Xfl+fld/X Id);

id=(Xtq*(Eqpp-Ebq)-Rt*(Ebd+Edpp))/D;iq=(Rt*(Eqpp-Ebq)+Xtd*(Ebd+Edpp))/D;
ed=Ebd-Xe*iq;eq=Ebq+Xe*id; Te=(Eb*cos(delta)+Xe*id+Ra*iq)*iq-(-Eb*sin(delta)+Xe*iqRa*id)*id;fad=Eb*cos(delta)+Xe*id+Ra*iq+Xi*id;

%The third 1/4
K13=120*pi*(efd+Rfd*(fad-ffd)/Xfl)*ts;ffd=:ffd+K13; K23=l/2/H*(Tm-Te-KD*RPM)*ts;RPM=RPM+K23;py2=120*pi*(K23+0.00*rand(l))/ts; K33=120*pi*(RPM)*ts;delta=delta+K33; K 43=120*pi*(R ld*(fad-fld)/X ld)*ts;fld=fld+K 43; K 53=120*pi*(Rlq*(faq-flq)/Xlq)*ts;flq=flq+K53;K63=120*pi*(R2q*(faq-Oq)/X2q)*ts;f2q=f2q+K63; K 73=l/T R *(et-vl)*ts;vl=vl+K 73; K83=(Kstab/120/pi*py2-v2/TQ)*ts;v2=v2+K83;py5=K83/ts; K93=l/TLG*(TLD*py5+v2-vso)*ts;vso=vso+K93;

Ebd=Eb*sin(delta);Ebq=Eb*cos(deIta);Edpp=Xaqspp*(flq/Xlq+i2q/X2q);Eqpp=Xadspp*(ffd/Xfl+fld/X Id); id=(Xtq*(Eqpp-Ebq)-Rt*(Ebd+Edpp))/D;iq=(Rt*(Eqpp-Ebq)+Xtd*(Ebd+Edpp))/D; ed=Ebd-Xe*iq;eq=Ebq+Xe*id ; Te=(Eb*cos(delta)+Xe*id+Ra*iq)*iq-(-Eb*sin(delta)+Xe*iqRa*id)*id;fad=Eb*cos(delta)+Xe*id+Ra*iq+Xl*id;

% The fourth 1/4
K 14=120*pi*(efd+Rfd*(fad-ffd)/Xfl)*ts;ffd=ffd-Kll/2-K12/2-K13+l/6*(Kll+2*K12+2*K13+K14); K24=l/2/H*(Tm-Te-KD*RPM)*ts;RPM=RPM-K21/2-K22/2K23+l/6*(K21+2*K22+2*K23+K24);py2=120*pi*(K24+0.00*rand(l))/ts; K34=120*pi*(RPM)*ts;delta=delta-K31/2-K32/2-K33+l/6*(K31+2*K32+2*K33+K34); K44=120*pi*(Rld*(fad-nd)/Xld)*ts;fld=fld-K 41/2-K42/2-K 43+l/6*(K 41+2*K 42+2*K 43+K44);

130

K54=120*pi*(Rlq*(faq-flq)/Xlq)*ts;flq=flq-K51/2-K52/2-K53+l/6*(K51+2*K52+2*K53+K54); K64=120*pi*(R2q*(faq-f2q)/X2q)*ts;f2q=f2q-K61/2-K62/2-K63+l/6*(K61+2*K62+2*K63+K64); K74=l/TR*(et-vl)*ts;vl=vl-K71/2-K72/2-K73+l/6*(K71+2*K72+2*K73+K74); K84=(Kstab/120/pi*py2-v2/TQ)*ts;v2=v2-K81/2-K82/2K 83+l/6*(K 81+2*K82+2*K 83+K 84);py5=K 84/ts;

K94=l/TLG*(TLD*py5+v2-vso)*ts;vso=vso-K91/2-K92/2-K93+ l/6*(K91+2*K92+2*K93+K94);

% Store variables for plot
FFD(k)=ffd;FRPM (k)=RPM ;Fdelta(k)=delta;DRPM (k)=RPM -FRPM (k-l); V olI(k)=VolI(k-l)+abs(Vref-et);RPM I(k)=RPM I(k-l)+abs(RPM ); DDDefd(k)=120*pi*(Efd-Efd0)*Rfd/Xadu;DDDir(k)=-120*pi*Rfd*(ifd-ifd0); DDDffd(k)=(FFD(k)-FFD(k-l))/ts;

% Go to the next step time
t=t+ts;k=k+l; end;

% For plot with time
t=0:ts:tmax+ts; if length(t)>iength(FFD);t=0:ts:tm ax-ts;elseif length(t)<length(FFD);t=0:ts:tmax+2*fs;end;

% Show the delta in degree
DeIta=Fdelta*180/pi;

figure(l);% for studying the MPEC subplot(2,2,l);plot(t,FRPM ,color);xlabel(",'FontSize',12); ylabel(",'FontSize',12);title('\it{Speed deviation (pu)}','FontSize',12);hold on subpIot(2,2,2) ;pIot(t,ET,color) ;x la b e l(" FontSize' ,12) ; ylabeI(",'FontSize',12);title('\it{Terminal Voltage (pu)}','FontSize',12);hold on subp!ot(2,2,3);pIot(t,EFD,color);xIabel('time(s)','FontSize',12); yIabei(",TontSize',12);title('\it{Field Voltage (pu)}','FontSize',12);hold on subplot(2,2,4);plot(t,Delta,color);xlabel('tim e(s)','FontSize',12); ylabel('',TontSize',12);title('\it{Power Angle (deg.)}','FontSize',12);hold on

% figure(2); % investigate the power system nonliearity % subplot(2,2,1);plot(t,ET-l ,color);xlabel(",'FontSize', 12);
%

ylabel(",'FontSize',12);titleC\it{Terminal voltage (pu.)}VFontSize',12);hold on

% subplot(2,2,2);plot(t,FRPM,color);xlabel(",'FontSize',12);

131

%ylabel(",'FontSize',12);titleC\it{Rotor Speed (pu.)}','FontSize',12);hold on % subplot(2,2,3);plot(t,Delta,co!or):xlabel('time(s)','FontSize',12); % ylabel(",'FontSize',12);titleC\it{Power angle (deg.)}','FontSize',12);hold on %subpiot(2,2,4);p!ot(t,K2,color);xlabel('time(s)','FontSize',12); % yiabei(",'FontSize',12);tit]e('\it(K2 coefficient )','FontSize',12);hold on
%

figure(3);% for studying the self-turning MPEC

%subplot(2,3,1);plot(t,FRPM,color);xlabel(",'FontSize', 12); %ylabel(",'FontSize',12);title('\it{ Speed deviation (pu)}','FontSize',12);hold on % subplot(2,3,2);plot(t,ET,color);xIabel(",'FontSize', 12);
% %

ylabel(",'FontSize',12);title('\it(Terminal Voltage (pu)}','FontSize',12);hold on subplot(2,3,3);plot(t,EFD,coior);xlabel(",'FontSize', 12);

%ylabel(",'FontSize',12);title('\it|Field Voltage (pu)}','FontSize',12);hold on % subplot(2,3,4);plot(t,Delta,color);xlabel('time(s)','FontSize',12);
%

ylabel(",'FontSize',12);title(' \it(Power Angle (deg.)}VFontSize',12);hold on

%subplot(2,3,5);plot(t,PF 1,color);xlabel('time(s)','FontSize', 12); %ylabel(",'FontSize', 12);title('\it{kp )','FontSize', 12);hold on % subplot(2,3,6);plot(t,PF2,color);xlabel('time(s)','FontSize',12); %ylabel(",'FontSize',12);title('\it(kv}','FontSize',12);hold on %figure(4);% for studying ignoring the field current changes
% %

plot(t,DDDir,'g',t,DDDffd,'b',t,DDDefd,'r');xlabel('time(s)VFontSize',12); ylabel('pu','FontSize',12);title(' \it IEliminating the changes of the field current }','FontSize',12);hold on

%figure(5) % for studying the conflict requirements of voltage adjusting and oscillation damping %plot(t,(ET-l),'b',t,FRPM,'r',t.(TE-0.9)/2/H,'g');xlabel('time(s)','FontSize',12);
%

ylabel('pu','FontSize',12);title(' \it{ Eliminating the changes of the field current }','FontSize',l2);hold on

%figure(6) %plot(t,K4,'g',t,K2,'b');

132

