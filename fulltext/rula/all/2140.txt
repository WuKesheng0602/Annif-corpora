FIVE-LEVEL NPC INVERTER FED BY DUAL 18-PULSE RECTIFIER FOR HIGH-POWER DRIVES

by

Zhongyuan Cheng Bachelor of Engineering, Xi'an Jiaotong University, China

A thesis presented to Ryerson University in partial fulfillment of the requirements for the degree of Master of Applied Science in the Program of Electrical and Computer Engineering

Toronto, Ontario, Canada, 2005 Â©(Zhongyuan Cheng) 2005
PROr-EnWOF RYERSGW LtfiRARV

UMI Number: EC53010

All rights reserved
INFO RM ATION TO USERS

The quality of this reproduction is dependent upon the quality of the copy submitted. Broken or indistinct print, colored or poor quality illustrations and photographs, print bleed-through, substandard margins, and improper alignment can adversely affect reproduction. In the unlikely event that the author did not send a complete manuscript ; and there are missing pages, these will be noted. Also, if unauthorized copyright material had to be removed, a note will indicate the deletion.

UMI
UMI Microform EC53010 Copyright 2008 by ProQuest LLC All rights reserved. This microform edition is protected against unauthorized copying under Title 17, United States Code.

ProQuest LLC 789 East Eisenhower Parkway P.O. Box 1346 Ann Arbor, Ml 48106-1346

Author's Declaration

I hereby declare that I am the sole author of this thesis.

I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research.

I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholar research.

1 1

Borrower's Page
Ryerson University requires the signatures of all persons using or photocopying this thesis. Please sign below, and give address and date. Name Address Signature Date

Ill

Five-Level NPC Inverter Fed by Dual 18-Pulse Rectifier for High-Po' wer Drives

Master of Applied Science 2005 Zhongyuan Cheng Electrical and Computer Engineering Ryerson University, Canada

ABSTRACT

This thesis focuses on the topology of multi-pulse rectifiers and the modulation technique of multilevel inverters for high-power medium voltage drives. A dual 18-pules rectifier topology is proposed. The topology achieves harmonic performance of 36-pulse rectifiers by using relatively simple 18-pulse transformers. It can also neutralize the 5`'' and harmonics

caused by unbalanced secondary windings. Moreover, a novel space vector modulation (SVM) algorithm with flexible three-segment switching sequence is proposed for multilevel inverters. It features: 1) minimized device switching frequency, 2) lower weighted total harmonic distortion due to the increase of the inverter sampling frequency, and 3) easy implementation thanks to the simplified sequence design. The algorithm is applicable to various multilevel inverter topologies. Theoretical analyses and computer simulations are carried out for the proposed topology and algorithm. The harmonic performance is verified by experiments on a lOkVA 5-level NPC/H-bridge inverter fed by a dual 18-pulse rectifier.

IV

ACKNOWLEDGEMENTS

The work presented in the thesis was carried out at the Laboratory of Electric Drive Research and Application (LEDAR) at Ryerson University.

First o f all, I would like to thank Professor Bin Wu for his continuous and paramount support and help during the period when I studied at Ryerson. The precious advices and numerous discussions triggered insightful research and enhanced my academic knowledge and scientific inspiration.

I am grateful to Professor Richard Cheung, Professor David Xu, Dr. Congwei Liu and all the fellow students at LEDAR for their support and friendly atmosphere. My appreciation also goes to Mr. Jim Koch for his help in preparing the gating boards, and Mr. Murat Kaya for his assistance in the experiment.

My sincere gratitude is extended to the engineers of the Power Electronic Group of Rockwell Automation Canada for the beneficial discussions and technical meetings.

I would like to share the joy of achievements with my families, my wife Susan and our little Claire. I am very grateful for my dear wife's long-time understanding and support.

TABLE OF CONTENTS
CHAPTER 1 INTRODUCTION...................................................................................... 1
1.1 O v erv iew ................................................................................................................................................................................... 1 1.2 M u lti-P u lse R e c tifie rs ...........................................................................................................................................................2 1.3 M ultilevel I n v e r te r s .............................................................................................................................................................. 5 1.3.1 N PC Inverters.................................................................................................................................................................. 5 1.3.2 N PC /H -B ridge In v e rte rs.............................................................................................................................................. 7 1.4 H ig h -P o w er M V D riv e s ....................................................................................................................................................... 9 1.5 S pace V ecto r M o d u la tio n o f M ultilevel In v e rte rs .....................................................................................................11 1.5.1 SVM for Tw o-Level In v e rte rs.................................................................................................................................. 11 1.5.2 The Application o f SVM for M ultilevel In v e rte rs................................................................................................ 14 1.6 M otiv atio n an d O b je c tiv e ..................................................................................................................................................16 1.7 T hesis O rg a n iz a tio n ............................................................................................................................................................ 17

CHAPTER 2 DUAL 18-PULSE RECTIFIER............................................................... 19
2.1 P rin c ip le o f H a rm o n ic C a n c e lla tio n ..............................................................................................................................19 2.2 R ed u ctio n o f S eco n d ary W in d in g s ................................................................................................................................ 22 2.3 D ual-18 P ulse R e c tific a tio n .............................................................................................................................................. 24 2.3.1 T opology ........................................................................................................................................................................ 24 2.3.2 Harm onic C an cellatio n ...............................................................................................................................................25 2.4 A p p lic a tio n s...........................................................................................................................................................................27 2.4.1 Configuration o f the DC O u tp u t ................... 27 2.4.2 Harm onic N eutralization Between Two D riv es.................................................................................................... 30 2.4.3 O ther A pplication C oncerns.......................................................................................................................................31 2.5 S im u latio n : W av efo rm s an d S p e c tr a ............................................................................................................................31 2.5.1 Ideal T ransform ers.......................................................................................................................................................32 2.5.2 N on-Ideal T ransform ers..............................................................................................................................................35 2.6 S u m m a r y ................................................................................................................................................................................36

CHAPTER 3 SPACE VECTOR MODULATION.........................................................37
3.1 S im plification o f Sw itching S equence D esig n .............................................................................................................37 3.1.1 Switching Sequence R eproduction..........................................................................................................................37 3.1.2 Sequence D esign by Triangle T ypes.......................................................................................................................39 3.2 S even-S egm ent SV M fo r N P C /H -B rid g e I n v e rte rs .................................................................................................. 40 3.2.1 Selection o f the R edundant Switching States........................................................................................................42 3.2.2 D esign o f Seven-Segm ent Switching Sequence...................................................................................................44 3.2.3 Typical W aveform s.................................................................................................................................................... 46 3.3 SV M w ith Flexible T h ree-S g em en t S equence.............................................................................................................43 3.3.1 Split Sequence and Inverter Sampling Frequency................................................................................................48 3.3.2 Extra S w itchings......................................................................................................................................................... 4 9

VI

3.3.3 D esig n o f T h re e -Segm ent S w itching S e q u e n c e ....................................................................................................... 51 3.3.3.1 P rin cip le o f M inim ization o f D evice Sw itching F re q u e n c y ......................................................................... 51 3.3.3.2 A rran g em en t o f Sw itching S e q u e n c e .................................................................................................................. 53 3.3.3.3 S election o f the First L eading S tate..................................................................................................................... 5 4 3.3.3.4 E xam ples o f T hree-S egm ent S e q u e n ce .............................................................................................................. 55 3.3.4 S im u la tio n ................. 55

3.4 C om parative S tu d y............................................................................................................................................................ Sg
3.4.1 3 .4.2 3.4.3 3 .4 .4 S im u latio n C o n d itio n s.......................................................................................................................................................58 W a v e fo rm s........................................................................................................................................................................... 60 S pectra, T H D and W T H D ................................................................................................................................................61 G atin g P attern and D evice Sw itching F req u en cy ......................................................................................................63

3.5 A pplication o f 3-Segm ent SVM to 9-Level Inverters...............................................................................................64 3.6 S u m m a ry ...............................................................................................................................................................................65

CHAPTER 4 EXPERIMENTS......................................................................................... 67
4.1 E xperim ent S etu p ...............................................................................................................................................................68
4.1.1 4.1.2 4.1.3 4 .1 .4 S y stem C o n fig u ra tio n ....................................................................................................................................................... 68 Planning and T esting o f th e T ra n sfo rm e rs..................................................................................................................70 State D eco d er fo r N P C /H -B rid g e.................................................................................................................................. 72 S im ulink/R T I M odel for the C o n tro lle r.......................................................................................................................74

4.2 E xperim ent R esults............................................................................................................................................................ 75
4.2.1 In p u t C u rren t o f the R e c tifie r..........................................................................................................................................75 4.2 .2 O u tp u t voltag e o f the In v e rte r................. 78

4.3 S u m m a ry ............................................................................................................................................................................... 82

CHAPTER 5 CONCLUSIONS..........................................................................................83 APPENDIX.......................................................................................................................... 87
1. SVM com putation in hexangular coordinates............................................................................................................ 87 2. Sim ulink m odels o f SVM algorith m s............................................................................................................................ 93 3. Perform ance com parison for various a n d / ^ ......................................................................................................101

4. Spectra co m p arison .......................................................................................................................................................... 105

REFERENCE....................................................................................................................'Â·'Â·7

YU

LIST OF FIGURES
Fig.1-1 G eneral topology o f M V m otor drives........................................................................................................................ ^ Fig. 1-2 Topology o f 12-pulse rectifier..................................................................................................................................... ^ F ig. 1-3 Current waveform s and spectra o f 12 -pulse rec tifier.............................................................................................3 Fig. 1-4 Topology o f 18-pulse rectifier.....................................................................................................................................4 Fig. 1-5 Three-level NPC in v erter............................................................................................................................................. ^ Fig. 1-6 Five-level N PC/H -bridge inverter...............................................................................................................................7 Fig. 1-7 Topology o f MV drives fed by 5-level CHB in v erter............................................................................................9 Fig. 1-8 Topology o f 7-level CHB inverter fed M V d riv es................................................................................................10 Fig. 1-9 Topology o f 5-lcvcl N PC/H -bridge inverter fed MV drive..................... 10

Fig.1-10 Circuit diagram and vector plot o f a 2 -level inverter..........................................................................................12

Fig.2-1 Circuit model o f a 6 -pulse rectifier fed by a PST .................................................................................................. 19 Fig.2-2 Topology o f 36-pulse 5-levcl N PC/H-bridge inverter fed drive........................................................................ 23 Fig.2-3 Topology o f dual 18-pulse rectifier..........................................................................................................................24 Fig.2-4 D C connection o f Application Case 1: for 5-level CHB inverters.................................................................... 27 Fig.2-5 Simulated DC output o f Application Case 1 ......................................................................................................... 28 Fig.2-6 DC connection o f Application Case 2: for 3-level NPC inverters.................... 28

Fig.2-7 Simulated DC output o f Application Case 2 ......................................................................................................... 29 Fig.2-8 DC connection o f Application Case 3: for 5-level NPC/H-bridge inverters................................................... 29 Fig.2-9 Simulated DC output o f Application Case 3 ......................................................................................................... 30 Fig.2-10 M atching two 18-pulse drives for harmonic cancellation................................................................................. 30 Fig.2-11 Circuit diagram o f dual 18-pulse rectifiers for sim ulation................................................... ...........................31 Fig.2-12 Simulated current w aveform s..................................................................................................................................33 Fig.2-13 Simulated spectra o f the c u rre n ts...........................................................................................................................34 Fig.2-14 Simulated THD o f the input current versus lo ad ............................................................................................... .35 Fig.2-15 Sim ulated spectra o f the currents o f non-ideal P S T s......................................................................................... 35

Fig.3-1 W aveform sym m etry represented by switching states......................................................................................... 38 Fig.3-2 W aveform presentation o f the 60" sym m etry........................................................................................................ 38 Fig.3-3 The vector plot o f 5-level inverters..........................................................................................................................40 Fig.3-4 The 7-segment switching sequence..........................................................................................................................41 Fig.3-5 M iddle sw itching states.................................................................. 42

Fig.3-6 Sector 1 w ith only middle s ta te s............................................................................................................................... 4 4 Fig.3-7 Sketch topology o f the N PC/H -bridge inverter w ith isolated DC sou rces......................................................45 Fig.3-8 Typical w aveform s o f N PC/H-bridge inverter with 7-segment SV M ..............................................................46 Fig.3-9 Simulated fundam ental voltage versus ma (7-segm ent S V M )............................................................................ 47 Fig.3-10 Simulated W THD versus w,,(7-segment SV M )...................................................................................................47 F ig .3 -1 1 Splitting switching seq u en ces................................................................................................................................ 48 Fig.3-12 Boundaries o f extra switching patterns o f 7-segment SVM (^p//l= 18)......................................................... 50

VUl

F ig .3 -1 3 E x a m p le o f the selection o f leading sta te ....................................................................................................................52 F ig .3 -1 4 T h e train o f sw itching states and th e 1Â® ' leading s ta te ...........................................................................................54 F ig.3 -1 5 E x am p les o f 3 -segm ent se q u e n c e ................................................................................................................................. 5 6 F ig .3 -1 6 T y p ical w aveform s o f N P C /H -bridge inverter w ith 3-segm ent S V M ...............................................................57 F ig.3 -1 7 S im u lated fundam en tal voltage versus (3-segm ent S V M ).............................................................................. 57

F ig .3 -1 8 S im u lated W T H D versus m ^(3-segm ent S V M )........................................................................................................58 F ig .3 -1 9 F ig .3 -2 0 F ig .3-21 F ig .3 -2 2 S im u lated voltage w aveform s o f N P C /H -bridge inverter w ith 7 -segm ent S V M ........................................ 59 S im u lated voltage w aveform s o f N P C /H -bridge inverter with 3 -segm ent S V M ........................................ 59 S im u lated spectra o f line voltage o f N P C /H -bridge inverter w ith 7 -seg m en t S V M ...................................60 S im u lated sp ectra o f line voltage o f N P C /H -bridge inverter w ith 3-segm ent S V M ...................................60 ...................................................................................................................................... 61 ................................................................................................................................. 62

F ig .3 -2 3 C o m p a riso n o f T H D versus F ig .3 -2 4 C o m p a riso n o f W T H D versus

F ig.3 -2 5 G atin g p attern o f 7-segm ent S V M ................................................................................................................................ 62 F ig .3 -2 6 G ating p attern o f 3-segm ent S V M ................................................................................................................................62 F ig .3-27 A ctu al av erage d ev ice sw itching frequency versus nia (/j,,_,yfu/=63GHz)........................................................... 63 F ig .3 -2 8 F ig .3 -29 S im u lated voltage w aveform s o f 9-level C H B in v erter w ith 3-segm ent S V M ............................................ 64 S im u lated sp ectra o f line voltage o f 9-level CH B inverter w ith 3-seg m en t S V M ...................................... 64

F ig.4-1 S y stem b lo c k d iag ram o f th e experim ental s e tu p .......................................................................................................67 F ig .4 -2 P h o to o f th e ex p erim en t s e t u p ..........................................................................................................................................69 F ig .4 -3 W in d in g d iag ram o f th e P S T s ...........................................................................................................................................7 0 F ig .4 -4 P h a so r d iag ram o f the P S T s ...............................................................................................................................................71 Fig .4 -5 P h ase A o f th e N P C /H -b rid g e in v erter........................................................................................................................... 73 F ig .4 -6 B alan ced g atin g signals by sw apping decoding schem es......................................................................................... 74 F ig .4 -7 B lo ck d iag ram o f S im u lin k /R T I m odel o f the inverter c o n tro lle r........................................................................ 75 F ig .4 -8 E x p e rim e n t w aveform s o f the input c u rre n ts............................................................................................................... 78 F ig .4 -9 E x p e rim e n t w aveform s o f inverter output voltage(3-segm ent S V M ,/i= 6 0 H z )................................................ 79 F ig .4 -1 0 E x p e rim e n t w aveform s o f inverter output voltage (7-segm ent F ig .4 -1 1 E x p erim en t w aveform s o f inverter output voltage (3-segm ent F ig .4 -1 2 E x p e rim e n t w aveform s o f inverter output voltage (7-segm ent S V M ,/i= 6 0 H z ) ....................................... 80 S V M ,/i= 3 H z ) ..........................................81 S V M ,/i= 3 H z )..........................................82

F ig.A -1 C o o rd in ate transfo rm atio n from rectangular to hexangular s y s te m ....................

87

F ig .A -2 Id en tificatio n o f the nearest three v ectors.....................................................................................................................9 0 F ig .A -3 D ia g ra m fo r dw ell tim e c alcu latio n ................................................................................................................................ 91 F ig .A -4 B lo c k d ia g ra m o f the SV M co n tro ller for N P C /H -bridge inverter....................................................................... 93 Fig.A -5 S u b sy stem `G ate S ig n a ls ' ................................................................................................................................................. 94 F ig .A -6 S u b sy stem `Tim e B a se ' (fo r 3-seg m ent and 7 -seg m en t)..........................................................................................95 F ig .A -7 S u b sy ste m `Tim e D iv id e r' ................................................................................................................................................ F ig .A -8 S u b sy ste m `S e c to r A d ju stm e n t' (for 3-segm ent and 7 seg m en t)............................................................................ 9 6 F ig .A -9 S u b sy stem `S ta te to P u lse D e c o d e r' (for 3-segm ent and 7 seg m en t)................................................................... 96

IX

NOMENCLATURE
Generic Variable Usage Conventions
Variable Format
F f .,] (.,
. ,)

Meaning
CA PITA LS: peak AC, rm s AC or average DC value LO W ER CASE: instantaneous value SQ U A R E BRA CK ETS: switching states PA R EN TH ESES: coordinate triple, 3-phase instantaneous values B O LD CA PITA LS: vector with tail A and tip B BO LD LO W ER CASE: vector

AB f

Specific Variable Definitions
Variable
a, b, c, o (a, b, c) A ,B ,C C D a, Dg, D c , Dp E, El, Â£ 2, Es /i fexrra finv_sp fsp fsw_actual fswjdeal ig, h) (& U .W h h, h i'l Ãb, Ã 

Meaning
inverter output term inals; transform er secondary terminals three phase variables transform er prim ary term inals DC link capacitance duty cycles step voltage; isolated DC voltages fundam ental frequency extra sw itching frequency inverter sam pling frequency (the center frequency o f the U sideband in spectra o f line-to-line voltage) sam pling frequency o f space vector m odulation algorithm s actual average device switching frequency ideal average device sw itching frequency hexangular coordinates hexangular coordinates o f the base vertex harm onic order currents o f different secondary windings o f PSTs induced currents o f q, q 3-phase currents at the prim ary side 3-phase currents at the secondary side

^aY (.^aÃ)

instantaneous current o f Y (A) windings instantaneous current o f Y (A) w indings referred to the prim ary side

^ces

collector-em itter cut-off current o f IGBTs

ir, h, it Ãx J y J z K Ls
{ m ,n )

secondary coil currents o f zigzag transform ers prim ary coil currents o f zigzag transform ers prim ary to secondary voltage ratio total m ains-side inductance local coordinates in the vector plot am plitude m odulation index norm alized sam pling frequency o f SVM num ber o f turns num ber o f pulses total m ains-side resistance state value; sw itching function; pow er capacity 3-phase sw itching states sw itching states o f N P C arm s dw ell tim es total harm onic distortion sam pling period {T,= \lfsp) unit vectors stationary vectors o f 2-level inverters rm s value o f the fundam ental (/j"' harm onic) m axim um rm s value o f the fundam ental 3-phase voltages line-to-line voltage phase A voltage w ith respect to the 3-phase neutral tt

rria trif N\,N2,Np,Np^NpY,Ns\,N^2 P Rs S [ ^U J -^6, -^c] Raol Rno Ta,Tt,To THD Ts
U, V

^1) Tlrms(^Ttjrms) T\rms max {Va, Vb, W c) ^ah

^aoiyno) V, K ./ ^ref (Va. Vp) W W TH D Ã 6 SS 7

voltage o f N PC arm w ith respect to the D C neutral D C link voltage; rectifier output voltage reference vector m agnitude o f the reference vector coordinates o f ( a , P) plane num ber o f secondary w indings w eighted TH D total state value change phase shift angle phase state value change arbitrary angle argum ent o f the reference vector angular frequency

e
C O

XI

CHAPTER 1 INTRODUCTION
1.1 Overview
High-power medium voltage (MV) motor drives have been used inereasingly in industry and there is still much room for the growth because only 3% of the currently installed MV motors are controlled by drives^
P ow er C onverter
I A C in

!Â»

In p u t -Â» T ransform er W filter

R ectifier D e lin k

Inverter

O utput filter

4-0

[_______________________________

Rectifier control

Inverter control

Fig.1-1 General topology of MV motor drives.

Fig.1-1 shows the block diagram of an MV motor drive. The AC power drawn from the utility is converted by the power converter and supplies the motor in whatever voltage, current and frequency necessary to achieve the desired mechanical performance. The converter includes the optional input/output filters, the transformer, the rectifier, the DC link and the inverter. The DC link may be a group of capacitors if the inverter is voltage source based, or reactor if it is current source based. The transformer normally has multiple phase-shifted secondary windings and accounts for a significant part of the drive cost. Depending on whether it is an active or passive rectifier, the converter may or may not have the rectifier control, but it always has the inverter control. The inverter control is important for the drive to generate desirable waveforms for the motor. The technical requirements and challenges of MV drives mainly come from the following origins^^^: the power quality requirements of the utility, the inverter design and control, the requirements of the interface with the motor, and system requirements of the drives. To meet the utility-side power quality requirements, phase-shifting transformers (PSTs) and multi-pulse rectifiers are used more and more often to limit the line current distortion and

1

improve the power f a c t o r ^ A t the inverter stage, the multilevel topology provides good opportunities to generate high-quality waveforms and to increase the inverter voltage to MV level (up to 6kV) with limited device voltage ratings^'^^^^^^^'^'^l While taking advantage of the harmonic cancellation, the better-shaped output waveforms, and the higher inverter voltage brought by multi-pulse rectifiers and the multilevel inverters, one should keep in mind that high-pulse PSTs are expensive and the control of multilevel inverters are very complex. The thesis focuses on the simplification of the front-end topology and the improvement of the modulation techniques of multilevel inverters.

1.2 Multi-Pulse Rectifiers
The term `multi-pulse' probably comes from the multiple humps per fundamental cycle in the rectifier output. For a conventional 3-phase rectifier there are 6 humps thus it is in fact a 6pulse rectifier. Similarly we have other multi-pulse rectifiers, such as 12-, 18- and 24-pulse rectifiers. For convenience, the PST powering a p-pulse rectifier is called a p-pulse transformer or p-pulse PST in the thesis. The motivation of the adoption of multi-pulse rectifiers is to meet the harmonic regulations set by IEEE Standard 519-1992^^^ and its European counterpart lEC 1000. For example, the current distortion limit set by IEEE 519-1992 for power converters is 5% of the maximum demand load current (15- or 30-minute demand), which can not be achieved by 6pulse rectifiers. The simplest multi-pulse rectifier for harmonic cancellation is the 12-pulse rectifier shown in Fig. 1-2. There are two 6-pulse diode rectifiers whose DC outputs are connected in series. The rectifiers are powered by the two secondary windings of a 12-pulse PST. One of the secondaries is in Y-connection, the other in A. If the phase angle of the primary line-to-line voltage is used as the reference, the phase-shifting angle of the Y-secondary is 0=0Â° and that

of the A-secondary is

30Â°. The secondary terminal currents, iav and Zgj, are referred to the

primary as i aY and i qa, the sum of which is the primary current Ãa 12-pulse PST

I-------

6-pulse R ectifiers

-O +

V w
vc

Fig.1-2 Topology of 12-pulse rectifier

Some of the harmonics in i'av can neutralize those of

leading to lower THD of

Fig. 1-3(a) shows the waveforms of i'aY, i'aA and ^ when the DC load is O.Sp.u., the total supply-side inductance L^=0.15p.u. The waveform of Ia is more sinusoidal than both of i'aY and i'aA- Fig.l-3(b) shows the spectra of the currents. Currents i'aY and i'aA have the same spectra, but some of the harmonic contents are 180Â° out of phase and cancel each other. As a result, these harmonics, such as 5'*', 7'**, 17^ and 19^\ disappear in the spectra of iA- The THD of iA is about 9%, compared to 25% of i'ay and i'aAW aveform s o f i'ar and i'cui (p u.) 0 .4 Fundam ental 100% T H D = 2 4 .6 5 % . sp ectru m o f i'ar a n d i'aA% )

0.2

20

Io A
10
-

5 < h 7 ^ ,
19 I I ..  . - . 1 17& 29& 31"

0.2
-0 .4 W aveform o f (p.u.)

Spectrum o f Fundamental 100%

m (%)

0.8
0 .4

T H D = 8 .9 9 %

ir
-0 .4
-

0.8

1
10 15 20

13*

23& 25` 25 30

35& 3 7 * 35 40

ai
(a) C u rre n t w aveform s

H arm onic order

(b) C u rren t sp ectra

Fig.1-3 Current waveforms and spectra of 12-pulse rectifier

Harmonic cancellation can be further enhanced by PSTs with higher number of pulses. Fig. 1-4 shows the typical topology of an 18-pulse rectifier. There are 3 identical 6-pulse rectifiers power by a PST with 3 secondaries. The secondaries of the PST are connected in A or extended-A, producing phase-shifting angles of 20Â°, 0Â° and -20Â° respectively. Similar to the case of 12-pulse rectifier, some harmonic contents are absent in the spectrum of primary current and the lowest order harmonic is now the 17'*'.
18-pulse PST 6 -pulse Rectifiers

0= 2Q

I

fc -2 0 "

I

I_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ I

Fig.1-4 Topology of 18-pulse rectifier

11"
12

13"

17"

19"

23"

25"

29*

3 f`

35"

37"

41Â«

43""

47*

49*

cancelled

not c a n c e l l e d n o t cancelled not cancelled

cancelled

not cancelled 1 cancelled not cancelled cancelled cancelled not cancelled cancelled not cancelled cancelled

18 24 30 36 Note:

cancelled cancelled

cancelled not cancelled not cancelled

Cancelled Cancelled h: the harm onic order

Generally, for a /7-pulse rectifier, the harmonics lower than (p-l)"' order can be cancelled. Table 1.1 summarizes the cancellation patterns***. Larger p results in better cancellation. For rectifier with 5% per unit (p.u.) supply-side inductance and 0.80 p.u. load current, the input current THD is about 35% for 6-pulse rectifiers, 9% for 12-pulse, 3.8% for 18 pulse and 1.7% for 24-pulse****^*. It can be expected that higher-pulse rectifiers have even better performance.

Multi-pulse rectifiers are commonly used in high-power converters, especially for multilevel converters, which is to be introduced in the next section.

1.3 Multilevel Inverters
Multilevel inverters are used to meet the requirements coming from the motor side. As mentioned before, one of the major advantages of multilevel inverters is the high inverter voltage they can achieve. The inverter voltage is decided by the voltage ratings of the switching devices. The majority of the MV drives from IMW to 4MW work at 3.3kV to 6.6kV voltage levels. However, the voltage ratings of the switching devices are often limited. For MV drives they are often rated at 6kV for GTO/GCT, 1.7kV, 2.5kV, 3.3kV, 4.5kV or 6.5kV for IGBTs. There are generally three methods for higher inverter voltage: connecting devices in

series, using switching devices with higher voltage rating, or adopting multilevel topology. The first method can be used only when the problem of dynamic voltage sharing has been efficiently solved. Otherwise it should be avoided. The choiee of the second and third methods is really a complicated compromise of the cost, reliability and availability. Given limited device voltage ratings, the most effective solution to higher inverter voltage is multilevel topologies. Other benefits coming with multilevel topology include lower output THD, lower dWdt which is beneficial to the motor and increased EMC. However these features are not in the scope of the thesis and will not be discussed in detail.

1.3.1 NPC Inverters
Among the other multilevel topologies, the 3-level neutral point clamped (NPC) topology, which was first proposed by Nabae et has been widely used.

Fig. 1-5 shows the topology of the NPC inverter, where only one DC source Vd is needed. Two capacitors are used to split the DC voltage and provide a neutral point o. Each phase

contains 4 active switches, Ski to SkA, and 2 clamping diodes Dki and Dki,

b or c. The 4

switches are controlled as two complementary pairs. For example, switches 5^1 and Sa3, Sai and SaA are complementary pairs. Each phase can be connected to three potentials: +VJ2, 0 or -Vd/2.
aO b 9 c Q

K

V rf/2 4:

S a4

H

Fig.1-5 Three-level NPC inverter

a

The maximum rms value of the fundamental of the line-to-line voltage Virms_max is the same as that of the 2-level inverters. For SPWM modulation, it is
^ ,r .,_ m a x = 0 .5 ^ y ,= 0 .6 iy ,.

S .

( 1 . 1)

Compared to 2-level inverters, the main feature of NPC inverter is that it can achieve higher inverter voltage. This is because the maximum voltage for each device in the NPC topology is VJ2, while it is Vj in a 2-level topology. For example, if the motor voltage is 2.3kV, the DC link voltage can be calculated to be around 3.3kV. For 2-level topology it requires switching devices rated at around 6.6kV, which hits the 6.5kV upper limit of device voltage ratings (for IGBT) in the market place. If the 3-level NPC topology is used, each switching device blocks only 1700V. Less expensive 3.3kV devices can be used without series connection.

For 3.3kV IGBTs, the highest inverter voltage of the NPC topology can achieve is 2.3kV. If the inverter voltage is more than 2.3kV, for example 3.3kV, the device voltage rating should be more than 5.4kV in the NPC topology. However the voltage of the MV drives is often higher than 2.3kV, with most of them being at 4.16kV level. For the inverters with 4.16kV output voltage, the device rating will be more than 6.8kV for the NPC topology. In other words, if the motor voltage exceeds 2.3kV, the 3.3kV IGBT-base NPC topology can not be used.

1.3.2 NPC/H-Bridge Inverters
NPC/H-bridge inverters is designed for inverter voltage higher than 2.3kV. It can achieve up to 4.16kV inverter voltage with 3.3kV IGBTs.
N P C /H -b rid ge cell

qa
*c2l

c Ã

*a\2

^al2 \i4

'b\2

YI2

'c22

'M 'aI4| V 2 4

Fig.1-6 Five-level NPC/H-bridge inverter.

Fig. 1-6 shows the topology of an NPC/H-bridge inverter. Each phase is an NPC/H-bridge cell composed by two NPC arms. The 4 switches of each NPC arm operate similarly to the NPC inverters. Every phase is powered by an isolated DC source, which is split into halves by capacitors. The NPC arms are 3-level and the difference of the two arms, which is the phase voltage, has five voltage levels; Kf, Vj/2, 0, - Vd/2 and

Each active switching devices must block V^/2 forward voltage, the same as that of NPC inverters. However the output voltage is doubled in comparison with 3-level NPC topology. For NPC/H-bridge inverters with SPWM modulation, the maximum rms value of the fundamental Virms_,nwc is:
(1.2)

Let's consider the 4.16kV inverter with the NPC/H-bridge topology. The required DC link voltage is now 3.4kV and the device voltage will be of the same level. Thus 3.3kV IGBTs can be used without devices in series. Another feature of the NPC/H-bridge topology is that it potentially needs only three isolated DC sources. However this feature is not exploited in MV drives because the PSTs used for multi-pulse rectifiers also provide multiple isolated DC sources, leading to fixed neutral potential and avoiding neutral voltage deviation. The five-level NPC/H-bridge inverters were studied by some researchers and marketed by manufactures. The NPC/H-bridge topology was reported to be used as single phase inverter by C. M. Wu et. al. in 1999^'^^ and was first granted patent to a manufacturer in topology was then used in high-power drives at 3.3kV and 4.2kV levels^^\ To summarize, Table 2.1 compares the NPC and NPC/H-bridge topologies. It can be concluded that if 3.3kV IGBTs are used, the NPC topology is for drives up to 2.3kV and the NPC/H-bridge topology is for drives up to 4.16kV.
Table 1.2 Comparison of NPC and NPC/H-bridge inverters
Item T op o lo g )^^^ N PC N PC/H -bridge Voltage levels 3 5 M ax device voltage Vj / 2 V ,/2 # of # of clam ping diodes f I rms_maj L/) IGBTs 0.61 1.22 12 24 6 12 M ax gain # o f isolated DC source 1 3 M ax inverter voltage with 3.3kV IG B T 2.3kV 4.16kV

The

(

8

1.4 High-Power MV Drives
As was mentioned in Section 1.1, the high-power MV drives must meet the challenges and requirement coming from both the utility side and the motor side. According the requirements from the utility side, drives should draw less harmonic current and operate at near unit power fa c to /'l On the other hand, the motor side requires wavcfomis with desired amplitude and frequency with lower harmonics and lower Ã VIdt. To satisfy the motor's requirements, high-power MV drives are often fed by multilevel inverters, which are powered by multi-pulse rectifiers at the front-end. Fig.1-7 shows the topology of a drive system fed by a 5-level cascaded H-bridge (CHB) inverter*^^'^. Each phase contains two H-bridge cells (shown in the dashed circle) in series. Each H-bridge cell is powered by a 6-pulse rectifier. The two rectifiers of the same phase are powered by two secondary windings with 30Â° phase shift from each other, forming a 12-pulse rectifier. The PST has altogether 6 secondary windings, supplying three 12-pulse rectifiers. _L T _L T _L 1"
Â© -W -Â®
0Â°
H-bridge cell

'< 1

bridge cells

_L T _L T X T

<

Fig.1-7 Topology of MV drives fed by 5-level CHB inverter

To achieve even lower current THD and higher the drive voltage, more complicated topologies are used in industry. Fig. 1-8 shows the topology o f an MV drive fed by 7-level CHB invertei^^^. Each phase contains three H-bridge cells, which are connected to three 6-

pulse rectifiers powered by the secondary windings with 20Â° phase shift from each other, forming 18-pulse rectification. The PST has altogether 9 secondary windings.

18-pulse PST

20"

-

20'

-

20 "

20 "

-

20 "

Hh

H-bridge cells'

Fig.1-8 Topology of 7-level CHB Inverter MV fed drives

24-pulse PST

T \.
,N PC/H-bridge

Flg.1-9 Topology of 5-level NPG/H-brldge Inverter fed MV drive

Fig.1-9 shows the topology of an MV drive fed by 5-level neutral point clamped (NPC) H-bridge inverter^^^. Each bridge is power by a 24-pulse rectifier, which is used to achieve less

10

than 3% input current THD. The PST now has 12 secondary windings, every four of which are combined to power the 24-pulse rectifier. There are altogether 12 rectifiers and 6 groups of DC links capacitors. Table 1.3 is the number of the major parts used by the topology.
Table 1.3 Parts count table of the 5-level NPC/H-bridge drive powered by 24-pulse rectifier
Ite m s P a rts co u n t secondary w indings 12 3-phase diode rectifiers 12 D C -link capacitors 6 A ctive sw itches C lam ping diodes 24 12

The choice of the number of pulse and the number of voltage levels depends on the numerous factors under the economic constraints, such as the input current THD requirements, the rated voltage of the drive, the topology of the inverter and the voltage rating of the devices. The more pulses, the higher number of secondary windings. The higher number of voltage levels, the more complicated control for the inverter.

1.5 Space Vector Modulation of Multilevel Inverters
The control of the multilevel inverter is one of major challenges for MV motor drives. The modulation scheme developed in two lines: sinusoidal PWM (SPWM) and space vector modulation (SVM). SVM has been studied extensively studies since its birth in the mid 1980s. Researches have shown that SVM is equivalent in everyway to the more traditional SPWM^^^^'^^'^^. Adjusting one parameter in SVM is equivalent to adjusting other parameter in SPWM. For example, adjusting the modulation index or the carrier frequency in SPWM is equivalent to adjusting the modulus of the reference vector or sampling frequency in SVM. The major benefit of SVM is the explicit identification of pulse placement as an additional degree o f freedom that can be exploited to achieve harmonic performance and inverter gainsf^'^l Furthermore SVM is commonly recognized as a favourable PWM scheme for digital implementation'^ ^^^^ .

1.5.1 SVM f o r Two-Level Inverters
The principle of space vector modulation will be briefly introduced using a 2-level 11

inverter as an examp W I Fig.1-10 shows the circuit diagram and the vector plot of a 2-level inverter. In Fig.l-lO(a) there are 6 switches, S| to SÃ´, producing 8 switching combinations. For example, if switches 5i, S2 and are turned on, the three phase voltages with reference to

the negative DC bus will be Va=Vd, Vh= Vd and Vc=0, i.e. (v^, v& , Vc)=F^*(l,l,0). We use the triple [1,1,0], which is called switching state, to represent this situation. Similarly the switching states can be found for the other 7 combinations, as listed in Table 1.4. ^2[110]
'9 Load

o

V i [1 0 0 ]

V,

VI

V4

Vs V 6 [1 0 1 ]

Vs

(a) The topology o f 2-level inverters

(b) Vector plot o f 2-level inverters

Fig.1-10 Circuit diagram and vector piot of a 2-ievel inverter.

Now set up a Cartesian 3-D space in Fig. 1-10(b) with three axes v,,, v& and perpendicular to each other and draw all the 8 points representing the switching states shown in Table 1.4. The small cubic block in the diagram is for better comprehension of the 3dimensional vector plot. If the vector plot is viewed as 3-D, the switching states are in fact the coordinates. The 8 points represent the 8 space vectors Vqto Vj.
Table 1.4 Space vector, switching states and on-state switches
On state Switches S i, S3, S5 Switching State Space Vector
[1 ,1 ,1 ] V'o S2, S4, S^ [0 ,0 ,0 ] S i, S ], S5 [1 ,0 ,0 ] Vi S i, S2, S3 [1 ,1 ,0 ] V2 S2, S3, S4 [0 ,1 ,0 ] S3, S4, S5 [0 ,1 ,1 ] S4, S5, Sg [0 ,0 ,1 ] S i, S5, Sg [1 ,0 ,1 ]

V,

V,

V,

Vs

V,

The space vectors is then projected on a plane. For three-phase balanced system, we have the constraint: v,,+Vi+Vc=0. (1.3)

12

which is in fact the equation of plane through the origin and with a normal direction (1,1,1), i.e. the plane parallel to the shaded triangle and thru the origin in Fig. 1-10(b). The plane is called vector plane. By projection, the images of the three axes are 120Â° away from each other. The images of the 8 space vectors are called stationary vectors. Vectors and V^

have the same image, the origin, thus are called zero vectors. The switching states representing the same image are redundant switching states. The images of Vi to are

located at the vertices of a hexagon, which can be divided into 6 sectors. The vector plane can be meshed by the triangles using the tips of stationary vectors as vertices. On the other hand, we need only two axes to form the basis of a plane, which means the three-phase voltage can be represented by a two-phase vector. The Forward Clarke Transformation can be used for such a purpose^'^;

By using the transformation, the stationary vector can be calculated for each switching state. For example, for the switching state [1,1,0], the three phase voltages with respect to the negative DC bus are: vJf)=-Vd, %(t)=V^ and Vc(0=0- Using Eq.(1.4), we have the vector:
V (() = . (1.5)

If we normalize it by 2V^/3, it is exactly Vj. W hile the stationary vectors represent the switching combinations, the three-phase voltage can be represented by a rotating vector, whose magnitude stands for the amplitude of the phase voltage and the angular speed stands for the frequency. The rotating vector is called as reference vector {Vref). Once the plane is meshed by stationary vectors, the reference vector can be approximated by the stationary vectors. If the reference stays at a location for a period of Ts, we can use adjacent stationary vectors, generally the nearest three-vectors (NTVs), to produce the same amount average. In Fig. 1-10(b) the reference vector is located in Sector I,

13

the sampling period Tg can be split among VÃ§)(yi), V\ and V2 based on the so-called voltsecond balance:
r,=r,maSin(-6M-;z/3), (1.6)

T2=Tsm^sine, To =T,-Ti -T2. where nia is the amplitude modulation index, segment assigned to V'l, Vj and

C-7)

C-8) T\, T2 and To are the time

I/?) respectively, which are called dwell times.

The general procedure of implementing SVM is: (a) calculate the switching states of the stationary vectors and mesh the vector plane; (b) define the switching sequences for each triangle; (c) identify the NT Vs; (d) calculate the dwell times; (e) generate gating signal by decoding the switching states in the timed switching sequence.

1.5.2 The Application of SVM for Multilevel Inverters
The application of SVM for multilevel inverters is much more complicated than for 2- or 3-level inverters. The main reason is that there are large number of redundant switching states and stationary vectors for multilevel inverters^'^ ^ ^ ^ ^ ^ ^ Â® ^ '^ ^ ^ ^ . Almost every step in the procedure of using SVM such as identification of the NTVs, the calculation of the dwell times, and the design of the switching sequences becomes computation-intensive and troublesome. Fortunately, the computational burden for the identification of NTVs and calculation of the dwell times is significantly lessened thanks to the contributions of many researchers. One of these is the application of hexangular coordinate system^^^l However, there are still some other problems to be solved related to switching sequence design. The problems can be divided into the selection of redundant switching states and the

14

optimization of the schedule of the sequence, both of which are tedious and tough work for multilevel inverters. Earlier studies showed that it is reasonable to constrain the choice of redundant states to the middle states', which limits the number of switching states to 4 or 5 for each triangle^ Even with this simplification, the switching sequence design is still a

major concern for optimal performance: better THD profile and lower switching loss^*^ Harmonic reduction is the first concern of switching sequence design. For high-power MV motor drives, the switching frequency is often relatively low (about 500Hz) in the consideration of the switching loss^^^. The lower device switching frequency brings negative side-effects to the spectrum of the output voltage. If the first sideband of the spectrum is too close to the fundamental frequency, lower order harmonics such as 5 '* ' and 7 ''', will be great headaches. It is desirable if the switching sequence can be properly designed so that the centre of the first sideband is shifted to higher frequency. The second concern is the reduction of the switching loss. For multilevel inverters, the complexity o f the vector plot often makes extra switchings inevitable. Extra switchings are the switchings that don't contribute to the inverter sampling frequency, which is defined as the centre of the 1^` sideband in the spectrum of the line-to-line voltage. Because high-power converters often work at lower switching frequencies, extra switching is a painful waste. Other concerns include easy implementation. For multilevel inverters, the switching sequence design must be done for each case (triangle), which results in a complex look-up table. This case-study-based design can be improved by a rule-based design, where the selection o f the switching state and the arrangement of switching sequence are implemented in real time according to some simple rules. Moreover, waveform symmetry should also be taken into account. Although it seems that half-wave symmetry is not a big issue for MV motor in most cases, it is critical for rectifiers because the even order harmonics are strictly regulated by IEEE 519-1992, which set the limits o f even harmonic to a quarter of those of odd harmonics.

15

1.6 Motivation and Objective
As mentioned earlier, there are numerous technical challenges and requirements for MV high-power motor drives. Two of them will be addressed in the thesis. The first challenge is how to simplify the topology of the rectifier and to achieve friendlier converter-to-utility interface. As introduced in Section 1.2, multi-pulse rectifiers are often the solution to the reduction of the current THD. However, the more pulses of the rectifier, the more complicated the PST. This is why rectifiers of more than 30-pulse are not used in practice. The second challenge is how to effectively apply SVM to multilevel inverters with desirable THD profile at relatively lower switching frequency. The key issue here is how to efficiently design the switching sequence. Conventionally, switching sequence design is done by predefining the sequence for each triangle in the vector plot. This is a manual job and is really a tedious one for multilevel converter. In brief, the effort devoted to the rectifiers for high-power drives is targeted to: (1) the simplification of the PST. The topology shown in Fig. 1-9 is used as the starting point of the simplification. The standard 18-pulse PST will be used in place of the complex 24-pulse PST. Meanwhile the number of secondary windings is reduced by half, thus the number of DC links and rectifiers can be reduced by half accordingly. (2) the improvement of harmonic cancellation. The topology in Fig. 1-9 features 24-pulse harmonic cancellation. It will be improved to 36-pulse cancellation with reduced secondary windings. The principle can also be used for harmonic cancellation between two different drives or for extra opportunities for harmonic cancellation when the PSTs are non-ideal. The work on the switching sequence of SVM is intended to achieve the following objectives: (3) the improvement of THD profile by increasing the inverter sampling frequency.

16

(4) the decrease of the device switching frequency by reducing the extra switchings. (5) easy sequence design and implementation by rule-based design and mechanism of sequence reproduction. The rule-based design makes the algorithm is applicable to other multilevel inverters. (6 ) W aveform symmetry which enables the algorithm to be used for active rectifiers.

1.7 Thesis Organization
The work of the thesis is organized into 5 chapters. Following the introduction of Chapter 1, Chapter 2 deals with the front-end of the MV motor drives, i.e. multi-pulse rectifiers, for which the dual 18-pulse rectifier is proposed. The dual 18-pulse rectifier features 36-pulse harmonic cancellation with simple 18-pulse PSTs, fewer secondary windings, rectifier bridges and DC capacitors, compared with the 24-pulse rectification shown in Fig. 1-9. Theoretical analysis and computer simulation was given to verify the above features. For the inverter stage, emphasis of Chapter 3 is laid on the control of the multilevel inverters, i.e. the space vector modulation algorithms, for which a flexible 3-segment SVM algorithm is put forward. Compared to conventional 7-segment SVM schemes, the proposed algorithm achieves higher inverter sampling frequency, lower device switching frequency, easy sequence design and digital implementation. The algorithm is also applicable for other high-level inverters or active rectifiers which require half-wave symmetry. The performance of the algorithm is verified by extensive computer simulations in comparison with the 7segment SVM. The experimental verification is given in Chapter 4, in which the experimental setup is introduced and experimental results are discussed in association with the simulations. Chapter 5 is the conclusions which can be drawn from the research in the thesis. Other supporting materials and more detailed waveforms are attached in the appendices.

17

CHAPTER 2 DUAL 18-PULSE RECTIFIER
Multi-pulse rectification is used extensively by manufacturers to reduce the harmonics drawn from the utility. Phase-shifting transformers (PSTs) are the key to the harmonic reduction. Because multilevel rectifiers for high-power drives often require multiple isolated DC sources, thus PSTs with multi secondary windings are frequently found in the literatures. However PSTs with higher pulse numbers are too complicated to be manufactured due to the large number of secondary windings which must be wound with precise phase-shift angles. The highest number of pulses ever seen in practice is 30-pulse. The chapter discusses the possibility to reduce the number of secondary windings and to enhance the harmonic cancellation. A dual 18-pulse rectifier, which utilizes simple 18-pulse PSTs to achieve 36pulse harmonic cancellation, is proposed for high power MV drives'^'^^

c=r

Vd

Fig.2-1 Circuit model of a 6-pulse rectifier fed by a PST.

2.1 Principle of Harmonic Cancellation
First look at a general case: a six pulse rectifier shown in Fig.2-1, where the rectifier is fed by a phase-shifting transformer. The primary winding is connected in A and the secondary in extended-A, producing a phase shift angle S:

Assume the primary to secondary voltage ratio is k^, and Np, N\ and N 2 nre the numbers of turns as shown in Fig.2-1. To achieve the phase shift angle S, the turns ratios should be .

19

Np N,

sin 120Â° (2 .2)

sin^ k. sin 120Â° N^+N^ sin(120 Â° + J) Assume the secondary terminal currents are:

ia=

E ^ /.s in /i(ty t- 120 Â°)
h = \,5 ,l...

(2.3)

^

sin h(Ã»)t + 120 Â°)

where

is the magnitude of the h!^ harmonic, and cy is the fundamental angular frequency.

These terminal currents flow through the extended coils (N2 ). The currents through the secondary A-coils (A^i) are iV , is and as shown in the figure. All these six currents will be

induced in the primary winding inversely proportional to the turns ratios. Thus the coil currents of the primary are

(2.4)

Specifically the primary terminal current of phase A is:
(2.5)

Substituting Eq.(2.4) into Eq.(2.5) yields:

(2 .6 ) Applying Eqs.(2.2) and (2.3) to Eq. (2.6), we have:

20

[sin hcDt sin(l 20 Â° + ^ - sin hicDt + 120 Â°) sin Ã] sin 120 ' /i=i,5,7,,
1

X [sin((/j + 1) Â· 60Â°) sin (W f + ( A - l ) 6 0 Â° - J ) ky sin 120 Â° a = i, 5, 7 ,, - sin((/i - 1) Â·60Â°) sin{ho)t + {h + \)- 60Â° + S)] --jZ^A sin (/i< y r-^ + ^ '^Ã®f,sin{hÃ»)t + Ã´)

(2.7)

A general conclusion can be drawn from Eq.(2.7): when the secondary voltage is shifted by < 5 ^ with respect to the primary, the secondary terminal current can be referred to the primary terminal in a way such that: (1) The positive-sequence harmonics are phase-shifted by - S ; (2) The negative-sequence harmonics are phase shifted by Ã ; (3) The magnitudes are scaled by the same ratio.
Table 2.1 The phase angles o f the harm onic o f 24-pulse PST
5ih
c u r r e n t '- - '^
h

 ylh

I f

13*

17*

19*

2 3 '"

25*

29*

31"

35*

 37*

0
-1 5 -30 -45 -22.5 -22.5 -22.5 -22.5 no

0
-75 -1 5 0 -225 22.5 -67.5 -157.5

0
-105

0
-165 -330 -135 22.5 -157.5 -337.5 -157.5

0
-195 -30 -225 -22.5 -202.5 -22.5 -202.5

0
-255 -150 -45 22.5 -247.5 -157.5 -67.5

0
-285

0
-345 -3 3 0 -315 22.5 22.5 22.5 22.5 no

0
-15 -3 0 -45 -22.5 -22.5 -22.5 -22.5

0
-75 -1 5 0 -225 22.5 -67.5 -157.5 -247.5

0
-105

0
-1 6 5 -3 3 0 -135 22.5 -1 5 7 .5 -3 3 7 .5 -1 5 7 .5

0
-195 -3 0 -225 -22.5 -202.5 -22.5 -2 0 2 .5

1
I

h h

-210
-315 -22.5 -112.5 -202.5 -292.5

-210
-135 -22.5 -292.5 -202.5 -112.5

-210
-315 -22.5 -112.5 -202.5 -2 9 2 .5

*4 'i

i '2
i'i

i I '4
C a n c e ll e d l

1-247.5

i\. the curreitit in th e 2 2 .5 " secondary; i-i- the cu rren t in the 7.5" secondary; (3: the curreint in th e -7.5" secondary; 1 4 : th e current in the -22.5" secondary;

The above conclusions can be used to analyze the harmonic cancellation pattern of multi pulse rectifiers. Let's take the 24-pulse rectifier as an example. Assume the 4 secondary windings are phase-shifted by 22.5Â°, 7.5Â°, -7.5Â° and -22.5Â° with respect to the primary. Using the above results we can quickly figure out the phase angles of the referred currents of each harmonic. For instance, the phase angles of the 5"' harmonic at the secondaries are 0Â°, 5*(15Â°), 5*(-30Â°) and 5*(-45 Â°) respectively. When they are referred to the primary, the phase 21

angles are: 0Â°+22.5", -75"+7.5Â°, -150Â°-7.5", -225Â°-22.5Â°, i.e. 22.5Â°, -67.5Â°, -157.5Â° and -247.5Â°. Because they are referred with the same ratio, the referred currents with 22.5 and -157.5 angles are 180Â° out of phase and cancel each other. It is the same for the other two. The phase angles of all the harmonics in the referred currents are listed until the 37* in Table 2.1, from which we can find the lowest harmonic in the primary current is the 23*.

2.2 Reduction of Secondary Windings
The performance of harmonic reduction is decided by the number of pulses. From Fig. 1-7, Fig. 1-8 and Fig. 1-9, the number of secondary windings, w, is half of the number of pulses for H-bridge-based multilevel converters. For example, the 12-pulse PST has 6 secondary windings and the 24-pulse PST has 12. Can it be reduced or reconfigured for simplicity and better performance? Now, because each secondary produces 6 -humps per fundamental cycle in the DC output, theoretically, for a p-pulse PST, the ideal number of secondary windings w is w=p/6 (2 .8 )

For MV motor drives, the choice of the pulse number p depends on: 1) the input current harmonic requirements and, 2) the number of DC supplies needed by the inverter. Obviously the actual number of secondaries in Fig. 1-7, Fig. 1-8 or Fig. 1-9 is three times the number predicted by Eq.(2.8). The number of secondaries in Fig. 1-7 and Fig. 1-8 cannot be reduced because of the number of isolated DC sources required by the inverter. However, it could be reduced for the topology of Fig. 1-9 where the number of secondaries is more than the number of required DC sources. It should be noted that even though the secondaries in Fig. 1-7 and Fig. 1-8 can not be reduced, according to Eq.(2.8), the number of pulses can be expected to be tripled for better harmonic cancellation. For example, the PST in Fig. 1-7 has 6 secondary windings, thus 36-pulse harmonic cancellation can be achieved theoretically. Now let's focus on Fig. 1-9. We have two alternatives to reconfigure the rectifier: to triple

22

the pulse number or to reduce the secondary number. With 12 secondaries, 72-pulse harmonic cancellation could be expected. However 72-pulse harmonic cancellation is not practical from both the viewing points of the PST manufacturing and IEEE 519-1992 harmonic requirements. Because only 6 DC sources are needed for fixed neutral point potential, the number of secondaries can be halved, leading to a 36-pulse configuration (Fig.2-2), where the secondaries are shifted by 10Â° from each other and y is any angle that is practically meaningful. Table 2.2 compares the major features of the 36-pulse rectifier and 24-pulse rectifiers in Fig. 1-9. Obviously the topology of Fig.2-2 achieves better harmonic cancellation and uses fewer secondary windings although the ripple in the DC may be larger than that of Fig. 1-9. Now the problem is that 36-pulse PSTs are too complex for manufacturing. The problem can be solved by the proposed dual 18-pulse rectification.

36-pulse PST

0Â°

Fig.2-2 Topology of 36-pulse 5-level NPC/H-bridge inverter fed drive.

23

Table 2,2 Comparison of the rectifiers in Fig.1-9 and Fig.2-2
Item Topology 24-pulse (Fig. 1-9) 36-pulse (Fig.2-2) # o f secondaries 12 6 # o f rectifiers and caps 12 6 Lowest dom inant harmonic 23 35 # o f ripples in DC per cycle 24 12

2.3 Dual-18 Pulse Rectification
2.3.1 Topology
The topology of the dual 18-pulse rectifier is shown in Fig.2-3, where two 18-pulse PSTs are used in stead of a bulk 36-pulse PST. The top PST, xmfr 1, is of Y-primary and the secondaries are phase-shifted by y, y-2Ãf and 7-40", where / i s any angle which is practical. The bottom PST, xmfr 2, is of A-primary, which makes its secondaries shifted by additional Â±30Â° from those of the top PST. The six DC outputs DCl to DC 6 can be used to power the multilevel inverters. xfmr 1 -tH0"
Y -2 0 Â°

IT _L T ^

DCl

i

DC2

DC3 Y-4 0 Â°

xfmr 2
YÂ±30Â°

DC4

-m

V fH /
0 1

i
T

_L

- Â°

DC5

n /xo

-%r
Y-40Â°Â±30Â°-----

DC 6

Fig.2-3 Topology of dual 18-pulse rectifier.

24

According to the winding arrangements, PSTs can be o f Y/Z or A/Z configurations: the primary may be in Y- or A-connection and the secondary in zigzag (Z). The Y/Z or A/Z configuration makes no difference to the effect of harmonic cancellation if the PST is used alone. However, if two PST are combined, extra benefit can be achieved.

2.3.2 Harmonic Cancellation
According the theory of Section 2.1, if the line current of a secondary of a zigzag PST is i, = X
h=\

sin h w t ,

the referred current at primary terminal is: h '= - ^ X /ft sin (/ia w -^ + --
A=l,7,13...

'^I,,sm{hcot + S)
A=5,11,17...

(2 -10 )

where S is the phase shift angle. Consider another secondary with phase angle S with respect to i'l, i.e.:
(2 = ]^/ft sin h(Ã»)t + S ) .
h=l

(2 .11)

W hen it is reflected in the primary, it becomes
(2 = --
k y

X
/i= l,7 ,1 3 ...

/ft sin[/z(ftir + J ) - J ] + -- I,^sin[hcot + (h-V)S] + --
1

Ã ,, s\n[h(Ã»)t + S) + S]
A=5,l 1,17... /O 1 0 \

=--
^y

1

^
ft= l,7 ,1 3 ...

"  ^ / ,, sin[/i<y/+ (/i +1)J]
A =5,11,17...

where K is the primary to secondary voltage ratio. From Eq.(2 .12 ), it can be concluded that: if the initial angle of a secondary current is S, the harmonic current referred to the primary is shifted by (/i-l)J fo r positive-sequence harmonics, and by (h+])Sfor negative-sequences. Now use the above conclusions for two 18-pulse transformers: the first transformer, xfmr 1, has three secondaries at -20Â°, 0Â° and 20Â°. The second, xfmr 2, is shifted by a with respect to xfm rl, with the secondary angles -20Â°+% 0Â°+% and 20Â°+% The phase shift angle of the harmonics are calculated and listed in Table 2.3. 25

Table 2.3 Phase angles of the referred harmonics and cancellation patterns of dual 18-pualse rectifiers
II 13 17 19 23 -120 25 120 29 31 35 37 41 43 47 49 53 55 59 61

-20
x fm rl

Â·120 120

120 120
120 -120

120 120
-120
120

120 120

120 120
120

-120 -120

20
20-ra
x fm r2 20-4-0 Pattern 1 Pattern 2 Pattern 3

120 120

120 120

120 120

120

-120 120 120 -120 -120 120 120 -120 120 120 120 36o 36o 18a l 8 o + 4 2 a -4-42o 4-480 4-240k-24a] 4-300 4-300  4-6 a 4-6 a -4-120 -4-120

4480 5 4 o

120

54o

120 120 120 120
4-600 4-600

6a

6a

12o

120

18a 18o 2 4 o 2 4 o 3 0 o 3 0 o 3 6 o 3 6 o 4 2 o 4 2 0 4 8 o 4 8 o 5 4 o 5 4 o 60 o 6 0 o

120
4 -1 2 0

120
4 -420

120
4-600

Note: Pattern 1: harmonic cancellation within transfonners; Pattern 2: inter-tiansfomier cancellation when o = Â± 3 0 "; Pattern 3: inter-transformer cancellation when or =Â±10".

yes: cancellation pattern is effective; no: cancellation patter is ineffective.

Table 2.3 shows 3 patterns for harmonic cancellation; Pattern 1: harmonics are cancelled within the transformers. It is in fact the cancellation pattern of standard 18-pulse rectifiers. Pattern 2: inter-transformer harmonic cancellation in addition to Pattern 1 when ot=Â±30Â°. The 5'*', 7^, 17`^, 19"' ... harmonics are cancelled. Pattern 3: inter-transformer harmonic cancellation in addition to Patter 1 when ot=Â±10Â°. The 17'*', 19**', 53*", 55**' ... harmonics are cancelled. For a standard 36-pulse rectifier, a=Â±10Â°. Patterns 1 and 3 are effective. It is clear from Table 2.3 that the lowest harmonic order is the 35*\ For the proposed dual 18-pulse rectifier, Patterns 1 and 2 are effective. The lowest order harmonic is also the 35**'. To compare the dual 18-pulse rectifier and standard 36-pulse rectifier, it is interesting to consider the following two situations: (1) Ideal PSTs. Ideal means the phase errors are negligible and the windings are well balanced. It is easy to conclude that there is no substantial difference in terms of harmonic profile between standard 36-pulse rectifiers and dual 18-pulse rectifiers. (2) Non-ideal PSTs with either remarkable phase-shifting error or winding balancing problem. No doubt that certain amount of lower order harmonics will appear, depending on

26

how serious the problem is. However, it seems that the performance of dual 18-pulse rectifiers will be superior to that of standard 36-pulse rectifiers. The reason is that Pattern 2 provides more additional opportunities for harmonic cancellation than Pattern 3, especially for the nastiest 5* and 7*. By the way, there are some other harmonic cancellation patterns when ot takes the other values. For example when oc=5Â°, the 35'*' and 37'*' harmonic can be neutralized. However these patters are of litter practical meaning. W hen OJ=Â±30Â°, the two transformers differ in Y- or A-connection, which is good for manufacturing.

2.4 Applications
2.4.1 Configuration of the DC Output
The DC outputs of the 18-pulse rectifier can be configured differently to fit the inverter topologies. Here are three application cases.

H - b r i d ^ cell

-m -O )

Fig.2-4 DC connection of Application Case 1; for 5-level CHB inverters.

A pplication case 1: for cascaded H-bridge (CHB) inverters The DC outputs are connected as isolated sources E\-E(, to supply the six H-bridges of a 5-

27

level CHB inverter (Fig.2-4). The waveform of one of the isolated DC output, E\, is shown in Fig.2-5 for a fundamental period. It is the typical voltage waveform of a 6 -pulse rectifier.
Â£i (p.u.)

F un dam en tal referen ce(p.u .)

-1.0

0

7 1 /2

7t

3 7 1 /2

271

Fig.2-5 Simulated DC output of Application Case 1

Application case 2: for 3-level NPC inverters The DC outputs are used as a 36-pulse DC source E with a neutral o. It is ideal for conventional 3-level NPC inverters (Fig.2-6), where the neutral point of the inverter is connected to the point o with fixed potential. Thus the problem of capacitor voltage deviation is avoided. The waveform of E is shown in Fig.2-7, which is the typical output of 36-pulse rectifiers and contains very little ripple.

0Â°

-I

Hi

Two 18-pulse PSTs

Fig.2-6 DC connection of Application Case 2: for 3-level NPC inverters.

28

0.985

E (p u.)

0.98

0.975

Fundamental reference(p.u.)

1.0

-1.0
0

7 1
Fig.2-7 Simulated DC output of Application Case 2

A pplication case 3; for 5-level NPC/H-bridge inverters The DC outputs are grouped into three pairs, E\ to Â£3 (Fig.2-8) for the three bridge cells of a 5-level NPC/H-bridge inverter. The secondary windings feeding the rectifiers of each pair are o f 30Â° phase shift. The DC voltage waveform of E\ is shown in Fig.2-9, which is the typical output of 12 -pulse rectifiers.

Â® Â« \ i
7 - 2 0 "Â± 3 0 Â°

(z K ii
7 - 4 0 "+ 3 0 "

Fig.2-8 DC connection of Application Case 3: for 5-level NPC/H-bridge inverters.

29

E l (p.u.)

0.9

0,6
F un dam en tal referen cejp.u .)

-1.0

0

jt/2

7C

2jc

Fig.2-9 Simulated DC output of Application Case 3

2.4.2 Harmonic Neutralization Between Two Drives
The principle of dual 18-pulse rectifiers can also be used to achieve harmonic cancellation between two drives. Fig.2-10 shows such as example, where two 18-pulse converters are matched to cancel the balanced portion of the harmonics, leading to better current waveforms at the up-streaming point of common coupling.

1
Converter system 1 YÂ±30Â° Y-20Â°Â±30'

(zF xY -40Â°Â±30Â° Converter system 2

Fig.2-10 Matching two 18-pulse drives for harmonic cancellation.

Another important conclusion drawn from Table 2.3 is that the dual 18-pulse rectification provides additional opportunity for the cancellation of the 5"" and 7 '* ' harmonics, which are the most troublesome contents. This is especially meaningful for some drives with non-ideal or defective secondaries. For example if phase error occurs, the 5"* and 7* harmonics can not be

30

neutralized within the PSTs, but the balanced portion can be cancelled inter-transformer.

2.4.3 Other Application Concerns
It should also be mentioned that one of the shortcomings of dual 18-pulse rectification is that two transformers are needed. It would be certainly better to use 36-pulse PSTs if someday they could be manufactured at reasonable cost because one bulky transformer will be better in terms of core efficiency and converter size. Another price paid by 18-pulse rectifiers is the higher voltage ripples in the DC output compared to the conventional 24-pulse rectifiers. Depending on the tolerance, larger the DC link capacitance may be needed, which is also helpful to decouple the inverter with the rectifier so that non-characteristic harmonics are blocked from entering the mains-side. However, with the 5-level topology, the tolerance of ripples should be higher than lower-level inverters.
iA y ~ ` a l+ i'a 2 + i'o 3

: 1/6MW

20"
w .

,
0"

0"

a5*^^ a6 |

(z X * -20"

_X -

<Ã)

(z > --

Fig.2-11 Circuit diagram of dual 18-pulse rectifiers for simulation.

2.5 Simulation: Waveforms and Spectra
The circuit used for the simulation is shown in Fig.2-11. In Fig.2-11 and the following discussions, subscript A' stands for Phase A of the primary, T ' for the Y/Z PST and 'J ' for

31

A/Z PST. All currents are line currents. The total mains-side line current is
iA = lA Y + iA A ,

-

'

(2-13)

where Iay and Iaa are the primary currents. When the secondary line currents, ia\ to ^ 6, are referred to the primary, the reflected currents are i'ai to satisfying:
i A Y - i 'a l + i 'a 2 + i 'a 3

(2/14)

ÃAA = i 'a4+i 'a5+ i 'a6

Other circuit parameters include:
Rated Load; IM W ; Rated primary voltage: 4160V ; V oltage ratio k^: 4160:1260; Capacitance: lOOpF per rectifier; M ains-side inductance L^: 5% , 10% and 15%p.u. (including the line inductance and the leakage inductance); M ains side total resistance Rs'. 0.5% p.u.;

The DC connection in Fig.2-11 adopts ApplicationCase 1 (Section connection schemesare to

2.4.1).If other DC

besimulated, the connectionsand theload resistanceshould be

adjusted accordingly.

2.5.1 Ideal Transformers
Assume the 18-pulse transformers are ideal: the phase-shifting angles are accurate and the leakage inductances of all the secondary windings are balanced. Fig.2-12 shows the simulated current waveforms when L^=0.15p.u. and the load P =lp.u. All the currents labelled in Fig.2-11 for the PST with Y-primary are shown in Fig.2-12(a). It can be seen that the shape of the reflected currents are different from the primary currents. This is because the PST changes the phase angle of the harmonics. As a result, the primary current Ãay is much more sinusoidal. It is also interesting that the THD of the referred currents are the same as the corresponding secondary currents. Similarly the currents of the PST with D-primary are shown in Fig.2-12(b). Again all the secondary currents and the reflected currents have the same THD and the primary current iAA is more sinusoidal. The total current
32

o f the dual 18-pulse rectifier is shown in Fig.2- 12 (c), from which it can be seen that the shape o f the total current
0.2 0
-0.2

is better than both Iay and IaaTHD=25.9%

0.2

-0.2
0.2 0
-0.2
THD=4.9% THD=25.9%
J i ^

7

0.5

0
-0.5
2k 3jc 4jf

(a) currents in P S T with Y -prim ary(in p.u.)
THD=25

0.2
-0.2

-- Â»

T H D = 2 5 .9 %

0.2 0
-0.2

THD=25.9%

THD=4.9%
0.5

-0.5

0
1.5

J C

2jt

.lit

(b) currents in the P S T with A -prim ary (in p.u.)

1
0.5

0
-0.5

-1
-1.5

2if
(c) the total current(in p.u.)

3n

4n

Fig.2-12 Simulated current waveforms
(L^=0.15p.u. and Ip.u. load)

33

The spectra of the currents are shown in Fig.2-13. All the secondary currents and the reflected currents have the same spectrum, which is shown in Fig.2-13(a) and contains all sorts of non-triplen odd harmonics with a THD of 25.9%. The spectra of the primary currents i^Y and Iaa are the same as shown in Fig.2-13(b). The lowest order is the 17'^ and the THD decreases to 4.9%. The spectrum is typical of 18-pulse rectifiers. The spectrum of in Fig.2-13(c), where the lowest order harmonic is the 35^ and the THD is 1%.
Fundamental=100% THD=25

is shown

30

40

50

Harmonic order

(a) Spectrum o f ia\-iu6 and i'ar i'ai currents
Fundamental=100% THD=4.9%

h= \

17

19

0

10

10

30

40

50

Harmonic order

(b) Spectrum of

h=l

Fundamental=100% THD=I.0%

2-

10

20

30

40

50

60

Harmonic order

(c) Spectrum o f ^

Fig.2-13 Simulated spectra of the currents

The THD of the input current versus the load is shown in Fig.2-14 with

as a parameter.

The THD decreases with the increasing load and inductance. As a conceptual fact, the THD of 34

the dual 18-pulse rectifier is about (1~3)% when the mains-side total inductance is 0.05 to 0.15 p.u. at rated load.
THD (%)

8 6

4

2 0

0

0.2

0.4

0.6

0.8

P(p.U.)

Fig.2-14 Simulated THD of the input current versus load
Fundamental=1009f> T H D = 5.9%

20

30

40

50

60

70

Harmonic order

(a) Spectrum o f i^y and iaA
4

(% )
h=l

F u n d am en tal 100% THD=3.0%

11

13 23 25

U.LL
 ^ 0 10 20 30 40 50 60 70

Harmonic order

(b) Spectrum o f

Fig.2-15 Simulated spectra of the currents of non-ideal PSTs

2.5.2 Non-Ideal Transformers
If the PSTs are non-ideal, i.e. with either phase shifting errors or unbalanced leakage inductances, certain amount of lower order harmonics will appear in the spectra of L ay and

35

To simulate this case, assume each transformer has a defective secondary whose phase shifting angle has a -3 .7 Â° error while the load condition and inductance are kept unchanged, i.e. at rated load with L,Ã§=15%p.u. The simulated spectra of Iay {ÃaÃ) and iA are shown in Fig.215. Lower order harmonics appear in the spectra of Iay and Iaa (Fig.2-15(a)), leading to a THD of 5.9%. However, the spectrum of Ia contains fewer harmonics (Fig.2-15(b)). The harmonics such as 5 * * ', 7'*', 17'*' and 19% are all cancelled. The THD of Ia decreases to 3.0%. This is consistent with the theoretical expectation of Table 2.3: Pattern 2 harmonic cancellations. results in the extra

2.6 Summary
This chapter introduces the dual 18-pulse PST based rectifiers. Compared to the 24-pulse rectifiers or 30-pulse rectifiers which are used in practice, the proposed topology has the following features:
(1) Simpler transformer and reduced secondary windings. Standard 18-pulse PSTs are

used instead of more complicated 24-pulse or 30-pulse PSTs. The total number of windings is decreased to 8 , in comparison with 13 windings of the 24-pulse rectifiers. (2) Improved harmonic cancellation. The dual 18-pulse rectifiers can achieve 36-pulse cancellation for ideal PSTs. When the PSTs are non-ideal, extra harmonic cancellation is available for some important harmonics, such as the 5'*' and 7'*'. (3) The principle of dual 18-pulse rectifiers can also be used to achieve inter-transformer harmonic neutralization for two drives. (4) The topology can be used to power different multilevel inverters, including 3-level NPC inverters, 5-level H-bridge inverters and 5-level NPC/H-bridge inverters. The main drawback of the suggested rectification is that it needs two transformers, and in some cases larger DC link capacitors are needed to suppress voltage ripples and to achieve better decoupling effect.

36

CHAPTER 3 SPACE VECTOR MODULATION
The main challenges of the space vector modulation algorithms for multilevel inverters are originated from the large number of redundant switching states and stationary vectors. The simplification of the switching sequence design, the reduction of device switching frequencies and the optimization of harmonic profile are all the major concerns. This chapter will focus on these concerns. The switching sequence design will be simplified by a `sequence reproduction mechanism and rule-based sequence design. Then it will applied to the

conventional 7-segment SVM for the control of 5-level NPC/H-bridge inverters. A novel SVM scheme with flexible 3-segment sequence will be proposed for multilevel inverters. The proposed SVM reduces the device switching frequencies, achieves better harmonic performance, and is convenient for digital implementation.

3.1 Simplification of Switching Sequence Design
The switching sequence design is to be simplified in two ways. First, a sequence reproduction mechanism is used to obtain the switching sequence for any sampling period by `copying' the sequence which was used 1/6 fundament period (60Â°) ago. The 60Â° angle in the sequence reproduction mechanism coincides with the 60Â° sector span of the vector plot and is convenient to be integrated into the SVM algorithm. Second, the sequence design is based on triangle types rather than specific triangles. Once the rule is designed for several triangle types, the switching sequence can be generated for the numerous triangles in real time.

3.1.1 Switching Sequence Reproduction
It happens frequently that the resultant waveform of SVM contains unwanted triplen harmonics or even-order harmonics. The reason of these harmonics is the lack of three-phase (TP) symmetry or half-wave (HW) symmetry. The best way to ensure waveform symmetry is to reproduce the switching sequence in a symmetrical way. It will be shown later that the 37

`sequence reproduction' mechanism introduced in this section also brings significant simplification to the sequence design. The necessary and sufficient condition for half-wave symmetry of SVM requires that if we use switching state [5^, at certain moment O in sector n (n=l,2,3)> then after 180Â° at

moment Â® in sector n+3, the complementary state -[5a, Sb, 5^ should be used (Fig.3-l(a)).
[^c, S^, S;,]

[ ^ a , Sf,, Sc,

,o

[` 5^1. Sj,,

(a) H alf-w ave sym m etry

(b) Three-phase symmetry

(c) HW and TP sym m etry

Fig.3-1 W aveform sym m etry represented by switching states.

Similarly, the necessary and sufficient condition for three-phase (TP) symmetry requires that if we use switching state [Sa, S'J at certain moment O, then after 120Â° at moment Â®,

the switching state should be [&, Sa, Sb] (Fig.3-l(b)). The above two symmetries can be expressed as a uniform 60Â°-symmetry, i.e. if at certain moment O, the switching state is [5^, Sb, switching state should be -[ Sb, Sc,
[a,Ã¨,c] O 1 y \ / r Â· Y 1 A 1 / \t / V' L........i\. 1\

then after 60Â° at sampling point Â®, the

(Fig.3-l(c)).
-[b,c,a] [ c,a,b] -[a,b,c\ [Ã¨,c,Ã»] -[c,a,b\ V a0 G V bO Â© V c@ 1 y " ~ ''\-b

1 1 1 1 1

1\. A 1 \ 1 V 1 1 v 1 A 1 1 1 / \i 1 , 1/ \c 1/ 1/ ...... .......i f ]/ \J 1\ \ / -C 1\ A \ /I 1 \ /I 1 V 1 V 1 1 A 1 A 1 1/ T-a
60" [ \
180"
j

l\

fa

l\

T \c

i

\

V
0

N

A
i;
360"

Fig.3-2 Waveform presentation of the 60Â° symmetry

38

It is much easier to understand the 60Â°-symmetry by waveform presentation in Fig.3-2, where the 3-phase voltages are marked on the waveforms every 60^. The voltages for the two adjacent moments are of 60Â°-symmetry, for example, the voltage at the moment Â© is [c, a, b], and it is -[a, b, c] at the moment O. The 60 -symmetry can be exploited for switching sequence design: After we finished sequence design in Sector I, the switching sequences for the other sectors can be obtained by `negative rotation', i.e. rotate the switching state of phase B to phase A, C and to B and A to C, then change the sign of result. For example, if a 7-segment sequence,

[ 1 , 1,0 ]" ^ [ 1 ,0 ,0 ]"^ [ 1 ,0 ,- 1] "^[ 0 ,0 ,-!]-> [!, 0,-1 ]->[!, 0 ,0 ]-> [ 1 , 1,0 ] is used for a triangle in Sector I o f a 5-level inverter, then the switching sequence for the corresponding triangle in Sector II can be easily obtained as [-1,0,-1]^ [0,0,-1]-^[0,1,-1]-^[0,1,0]-^[0,1,-1]->[0,0,l]-> [-l,0 ,-l] by `negative rotation'. This process remarkably simplifies the switching sequence design.

3.1.2 Sequence Design by Triangle Types
For high-level inverters, it is a tedious task to design switching sequence even just for Sector I. Fortunately the triangles can be classified^^^l Using the method introduced in Appendix 1, the vector plot of the 5-level NPC/H-bridge inverter can be drawn in Fig.3-3, which utilized hexangular g-h coordinate system. The vector plot contains 125 switching states, which belong to 61 stationary vectors. The switching states are represented by the integral triples in square brackets. The stationary vectors are located on the peripheral of 4 concentric hexagons, which are divided into 6 sectors and partitioned by 64 small regular triangles. The triangles can be categorized into 4 types, T ] to T 4. T| and T 3 represent triangles containing odd number of switching states while T% and T 4 have even number o f switching states. Tj and T 2 are standing upright and T 3 and T 4 up-side-down. The classification is made because the number of switching states in a triangle and its orientation

39

affect the sequence design.



Â·

In the following discussions, the switching sequence design will be based on the triangle types, rather than specific triangles.
Sector II
i-1. 2.-2]
[ 0 . 2 .- 2 ]
[ 1 . 2 .- 2 I

T2 1-2. 2.-1 ]
1- 2 . 1 .- 2 ] I 0 . 1.-2]

:1 k
V

Sector III
T1
[-2 , 2 . 0 ] . 1- 1 . 2 . 11]
1-2. l . - l ]
1- 2 . 11. - 2 ]

T3 / \ T2
.[2 . l . - l ]

Sector I
Â·[2 . 0 . - 2 ]

j ( l . 2 . (1]

1 1. 2 . 0 ] 1 0 . l.-l]

1 1 . 0.-2]

1- 1 . 0 .- 2 ]

T3

10.2, 1 ]
[- 2 , 2 . 1]
1 - 2 . 0 . I]

.1 II. 1 . 0 ]

1-2.-1.-2] 1 2 2,2]
1 0 . 1.
'111. 0. II]
[-2 .- 2 .- 2 ]

Ã Ã®'i, -- i - " --
; 'i .2 ,

.12. 0 . - 1) ________ Â·12. - 1. - 2]

\

/

T2

13

14 y T4

T3
[2 .- l . - l ]

1- 2 . 2 . 2 ]

1-2. 0. 0 ]

[- I .- 2 .- 2 ]

\r,,
1 2. 0 ,

10. - 2 , - 2 ]

11.-2.-2]

- r ,,,

12. - 2 , - 2 ]

10. 1,2] 1-2,11.1]
1-2.-1.D ]
[-' -' Oj

[ 2 . 1. 2 ]

I 0. O' '1 -------- 1 1.0. 1]
[O .-l.ll]
1- 1.- 2 . - 1 ]

1 2 .- 1. 0 ] 1 1 .- 2 .- 1 ]

 1 2 .- 2 . - 1]

1-2 . 0,21

1-1,0,2]
1- 2 . - 1 . 1 ]
I - 2 .- 2 . 0 ]

I 2 . 0 . 2]

[0,-1, 1 ]
I - 1 .- 2 .1 I]

1 2 .- 1. 1]
1 1.-2 . 0 ]

Â·12.-2.0]

1 0 .- 2 . 0 ]

Sector IV
1- 2 . - 1 . 2 ]

Sector VI

-3y i-i -I 7]___1 0-1.2]
^ l- 2 .- 2 .il

1- 1 . - 2

.

1]

 12.-2, 1 ]

1- 2 .- 2 . 2 ]

I-1 .-2 . 2 ]

1 0 .-2 . 2 ]

Sector V

Fig.3-3 The vector plot of 5-level inverters

3.2 Seven-Segment SVM for NPC/H-Bridge Inverters
Depending on how many pieces the sampling cycle is divided into, the switching

sequence can be named differently. Fig.3-4 shows an example of the 7-segment switching sequence for NPC/H-bridge inverters. The reference vector V^/is located in AABC and five of its redundant switching states are shown in Fig.3-4(a). The dwell times of the three vertices

40

are Ta, Tb and Tc. The waveform of three-phase switching states Sa, Sb and Sc are shown in Fig.3-4(b). The whole sampling period is divided into 7-segments. During each piece of

time segment, different switching states are used: state [2, 1,- 1] of vertex C is used in the first time segment, [2,0,-l] of B for the second segment and so on. The switching sequence can be represented by a train of switching states: [2 , 1,- 1] ^ [ 2 ,0 ,- 1] ^ [ 1,0 .- 1] ^ [ 1,0 ,-2 ] ^ [ 1,0 ,Here the switching state of the first time segment is called the leading state of the sequence while the switching state of the last time segment is called the ending state. For the 7-segment sequence, the leading state is same as the ending state.

1 1 C S,,\ 2 5'^ 1
ref

\ j

B 2 0

A . 1 i
0 1 i

C 1
0

A 1

B 2 n
-1

C 2 i 1 l
-1

i 1

1

0 -1
Ã

sA

 A[1, 0,-1]

1 1 ib
1
1

-1 i -1
1 1 Tb ^

-1 1

-2

{

i.
2 2 4

M

' 1 T,

1 j

(a) L o catio n o f the reference vector

(b) 7-segm ent sw itching sequence

Fig.3-4 The 7-segment switching sequence

The 7-segment sequence features the following^ (1) Each phase has 2 -switching transitions per sampling period; (2) Each transition involves only 1 voltage step, indicating there are only two switching devices operating at each transition. (3) The whole sequence involves 4 switching states, two of them are redundant switching states of the same vertex of the triangle; the sequence must start from and end with the same redundant switching state. (4) The sequence is symmetrical about TJ2. It can also be deduced that when the 7 -segment SVM is applied to the NPC/H-bridge

41

inverter, the ideal average device switching frequency for is
f s w - id e a l f sp

(3.1)

The inverter sampling frequency is:
fin v -s p ~ fs p ~ `^ f sw -ideal

(3-2)

Before designing the 7-segment sequences for multilevel inverters, we must decide how to select redundant switching states.

3.2.1 Selection of the Redundant Switching States
For convenience, let's first index the switching states. Define state value of a switching state [Sa, Sb, 5c] as: 5= ^5;
i==a,b,c
.

(3.3)

which actually reflects the level of common mode voltage.
3 Value

States [2, 2, 1] [2,1,1] [2,1,0] [ 1 ,1 ,0 ] . Middle [1,0,0] [1,0,-1] ' S tates [0. 0,-1] I [0,-1,-1] [0, -1,-2] [-1,-1,-2 [-1.-2.-2]]

[2, 2, 1]

Sector I

[1, 1, 0] [0,0,-I]

[-1,-1,
^ T 2 , 1, I]

[1, 0 , 0 ] [0,-l,-l]
[ - 1,- 2 ,- 2 ]

5 4 3 2 1 0 -1 -2 -3 -4 -5

Fig.3-5 Middle switching states

The switching states can be indexed by 5. Fig.3-5 shows a triangle of the vector plot of a 5-level inverter. There are altogether 11 switching states whieh are listed at the right side by descending state values. It can be seen that the state values are an arithmetic sequence. The switching states corresponding to the 5 state values in the middle of the arithmetic sequence are called middle states. In fact the middle states on the list are also the middle states of the corresponding vertex. The vertex with odd number of redundant states has one middle state

42

otherwise it has two. If a vertex has two middle states, the one with larger state value is called large sta te , the other is called small state^^^l Triangles of T] and T 3 types have 5 middle sates and Triangles of T% and T 4 types have 4. The middle states are also the states with the least common mode voltage.
Table 3.1 The middle switching states for Ti to T 4
T, T2

A
#
M id d le State [ft+g+ 2 , h - g + l ,- h - g y i Â© - [ 0 , 1 ,0 ] Â© - [ 1 , 1 ,0 ] Â© - [ 1 , 1, 1 ] Â© - [ 1 ,2 , 1] T,

states

states
Â©

Ã ( T ) Â® A '`> \ @
S Q.5{h-g)+2 0.5ih-g)+\ 0.5{h-g) 0.5 (/i-g)-l 0.5{h-g)-2 T4

Â©
@

@ @

# Â© Â© Â©
Â©

M iddle State [ h + g + 1, h - g + 1,-Ã  -g + 1]/2 Â© - [ 0 ,0 , 1] Â© - [ 0 , 1, 1] Â© - [ 1, 1 , 1]

S 0 .5(/ i-^)- h1.5 0.5(A-g)+0.5 0.5 (h -g y0 .5 0.5(h -g)-l.5

states
Â©@ \ ( g .y Â©

states
Â© \ Â© Â© ( & .y vÂ©

# Â© @ @
Â®

M id d le State [h+g, h-g+2 , - h - g + i y i Â© - [ 0 , 1 ,0 ] Â© - [ 0 , 1, 1] Â© - [ 1 , 1 , 1] Â© - [ 1 , 2 , 1]

S 0.5{h-g)+2 0.5{h-g)+\ 0.5(/t-g) 0.5{h-g)-\ 0.5(/i-g)-2

# Â© Â© Â© Â©

M iddle State [h+g+ ] , / i - g+] ,-h -g+ 1]/2 Â© - [ 1,0 ,0 ] Â© - [ 1, 1 ,0 ] Â© - [ 1, 1 , 1]

S 0 .5(h-g )+ ].5 0.5(h-g)+0.5 0.5{h-g)-0.5

O.S(A-g)-l.S

For a given triangle with a base vertex (g, h) (see Appendix 1 for `base vertex'), the middle states and the corresponding state values can be calculated according to Table 3.1, where the middles states are numbered as (D to (D according to the state value for easy programming. State Â© has the largest state value. The sequence design involves only the middle states in this thesis mainly for two reasons, better THD profiles and smoother transition from one triangle to the other as reported by other researchers^^'^^'^^^^^^'^ in addition to the awareness of common mode voltage indication.

43

Now the focus can be set to Sector I with only middle states, which is shown in Fig.3-6 and is a part of Fig.3-3. The triangles are now numbered from 1 to 16 for convenient citation. The switching sequence for the other sectors can be reproduced by negative rotation.
[2. 1 -2 1

T2

'I'A

Sector I

T2\14
(0.0.- i|

T2

T2\r4

T2

[0. 0. 0]

(1.0.01
[O.-I.-U

I I . - I . -11

[1 - 1 . -II

[2. - 1 -2]

[l.-l -2[

Fig.3-6 Sector I with only middle states Table 3.2 Seven-segment switching sequences for Ti to T 4

Uniform switching sequence for T, to T4:

3.2.2 Design of Seven-Segment Switching Sequence
The sequence-design rule of the 4 types of triangles are shown in Table 3.2, where 4-types of triangles have the uniform switching sequence: Â® -> Â® -> Â® -> Â® -> Â® -> Â® ^Â® . Because the 7-segment switching sequence can only start from the vertices with even redundant switching states, there are two possible switching sequences for T, or
T3.

Since the space vector rotates

counter-clockwisely, the upper vertex is preferred to be used at the beginning and the end of

44

the sequences for smoother transition between triangles. Thus another possible switching sequence involving state C D is not used. For Ti or T4, there is only one switching sequence. The fact that the 7-segment sequence must finally switch back to the leading state is actually a rigid constraint for sequence design. It can be eased by the more flexible 3-segment sequence which is to be discussed in Section 3 .3 . Applying the uniform sequence to Sector I, we have the switching sequence for each triangle listed in Table 3.3. The sequences for the other sectors can be obtained by the `negative rotation' described in Section 3.1.1.

T ria n g le 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 [1,1,0] [1,1,0] [1,0,0] [2,0,-1] [2,0,-1] [2,0,-1] [2,-1,-1] [1,1,0] [2,1,-1] [2,1,-1] [2,1,-1] [2,0,-1] [2 ,2 ,-l] [2 ,2 ,-l] [2,1,-1] [2,2,-1] [1,0,0] [1,0,0] [1 ,0 ,1 ] [1,0,-1] [2,-1,-1] [2,-1,-1] [2 ,-l,-2 ] [1,1,-1] [1,1,-1] [2,0,-1] [2,0,-1] [2,0,-2] [2,1,-1] [2,1,-1] [2,1,-2] [2,2,-2] [0,0,0] [1,0,-1] [1,-1,-1] [1,-1,-1] [1,-1,-1] [2,-1,-2] [2,-2,-2] [1,0,-1] [1,0,-]] [1,0,-1] [2,0,-2] [2,-1,-2] [1,1,-1] [2,1,-2] [2,0,-2] [2,1,-2]

Sequence [0,0,-1] [0,0,-1] [0,0,0] [1 ,0,-]] [1,0,0] [1,0,0] [1,0,-1] [1,0,-1] [2 ,- ],- l] [2,-1,-1] [2,-1,-2] [1,1,-1] [1 ,1 ,1 ] [2 ,0 ,-l] [2,0,-1] [2,0,-2] [2,1.-1] [2 ,l.- l ] [2,1,-2] [2,2,-2] -> [1,1,0] [1,1,0] [1,0,0] [2,0,-1] [2,0,-1] [2,0,-1] [ 2 ,- l,- l] [1,1.0] [2 ,1 ,1 ] [2,1,-1] [2,1,-1] [2,0,-1] [2,2,-1] [2,2,-1] [2,1,-1] [2,2,-1]

[0,0,-1] -3Â» [1,-1,-1] [1,-1,-2] ^ [1,-1,-2] ^ [1,-1,-2] ^ [l,-2 ,-2 ] ^ [0,0,-1] -3Â» [l,0 ,-2 ] [l,0 ,-2 ] [l,0 ,-2 ] [1,-1,-2] ^ [1,1,-2] [1,1,-2] [l,0 ,-2 ] [1,1,-2] -3Â» [1,-1,-1] [1,-1,-1] [2,-1,-2] [2,-2,-2] [1,0,-1] [1,0,-1] [1,0,-1] [2,0,-2] [2,-1,-2] [1,-1,-1] [2,1,-2] [2,0,-2] [2,1,-2]

an J/jll
.
S a il

(0 \
D / ,Ã® \ 5/,22'k 5,2

3 k

Â»

`5 ' a I 2 ^

k ^a?>

'k

Dft l ' k

D cl'k 5(123, D , j3, 5,223k
4'k A233, Drt'Â» Â·^ `^'33, %

Dal' ` ^"1 3 \ 5o 14\

,

 ^ Â« 2 3\ 5 ^2 4' k  ^fcu'k

Dm'Â»

^ 1 )1 *' k

5 r |4

'k

5,24

'

k

Fig.3-7 Sketch topology of the NPC/H-bridge inverter with isolated DC sources

pnorrraYDF 45 uaRAwr

3.2.3 Typical Waveforms
The performance of the 7-segment SVM has been simulated by modulating the 5-level NPC/H-bridge inverter. The topology is re-sketched in Fig.3-7 for convenient viewing, where each bridge is powered by two isolated DC source with equal voltage E.
g a \l
" LT

ga2\

2 %
Fig.3-8 Typical waveforms of NPC/H-bridge inverter with 7-segment SVM

(Wfl=0.87,/jp=720Hz) Fig.3-8 shows a set of typical waveforms. The gating signals for switches San, and Sa2 Aare shown in the top 4 traces. The normalized voltages, VaJE, v J E , VaJE, VbJE, VaiJE are shown in the other traces. It can be seen the voltage of each arm {vaJE or VnJE) is 3-level, the phase voltage (v^,,/Â£ or VbJE) is 5-level and the line voltage is 9-level. The normalized rms value of the fundamental line voltage versus or Vref is shown in

Fig.3-9, where Vref is modulus of the reference vector normalized by 2E/3. For 5-level inverters, m ^, is
(3.4)

iS

46

From Fig.3-9 we can conclude; V ,_ = 2 V 2 m .B = ^ V ,, ,E
0.2
3.0 2.5

(3.5)

0.4

0.6

0.8
2.83

K |

2.0
1.5

1.0

0.5

0

1.0

2.0

3.0

Fig.3-9 Simulated fundamental voltage versus

(7-segment SVM)

To take the frequency response into account when the choppy voltage is imposed on inductive loads, weighted THD (WTHD) is used to evaluate the quality of waveforms^^'^^:

WTHD =
\rms

I h=2

IE '

(3.6)
h

where h is the harmonic order, Vhnns is the rms value of the /i''' harmonic (/i= l,2,3...). 12 0
0.2 0.4

0.6

0.8

8

4

0

0

1.0

2.0

3.0

Fig .3-10 Simulated WTHD versus m^T-segment SVM)

Pig.3-10 shows the WTHD of the line voltage versus Vref with fsp/fi ^ ^ parameter. It can

47

be seen that higher sampling frequency results in lower WTHD. However, the improvement is limited at large modulation index (Vre/>1) when f^plfx increases to more than 24. More simulation results will be given in Section 3.4.

3.3 SVM with Flexible Three-Sgement Sequence
The major motives of the 3-segment SVM are to minimize the device switching frequency and to increase the inverter sampling frequency. The flexibility of the algorithm comes from the adaptive 3-segmeng sequence design, compared to the predefined switching patterns used in 7-segment SVM. ^` (fsp Jstg
c
B

Sa Su Sc

2

B

2

. A

2

C

2

C

2

1 1 1
1 1

C ^ I
-1

.

\ 2
0
i

B

1

1 i0 i 0 i 0
1
"t

I

: \

B 2

. \ I

c

2
1

j
1

!
r i 1

:

-1

-1

L
7-scgm ent sequ en ce 4-scgm en t scq. 3-segm ent scq.

;

-1

1 -1 i -1 i -1 1 1 i 5-segm cnt sequence |

-1

!
I

4-scj'm cnt scq. 3-segm ent scq

3-segm cnt scq.

3-segm ent scq.

Ml

I

(a) Splitting 7-segm ent sequence

(b) Splitting 5-segm ent sequence

Fig.3-11 Splitting switching sequences

3.3.1 Split Sequence and Inverter Sampling Frequency
As was shown in the last section, there are 6 switching transitions bound in each sampling period of a 7-segment sequence. The 6 switching transitions are scheduled based on the dwell times calculated at the beginning of the sampling period. In fact, the dwell times can also be updated at any moment within the sampling period. If they are updated at the centre of the sampling period, the 7-segment sequence is split into two 4-segment sequences, which are in fact equivalent to asymmetrical 7-segment scheme. It has been proven by other researchers that asymmetrical PWM is superior over symmetrical PWM because symmetrical PWM causes additional sideband harmonic components^'^^l Actually the sequence can be spit in different ways. For the reference vector shown in

48

Fig.3-4(a), the conventional switching sequences, such as the 7-segment and 5-segment sequences, can be split as shown in Fig.3-11. The 7-segment switching sequence can be split as two 4 -segment sequences as mentioned earlier, or as two 3-segment sequences as shown in Fig.3-11(a). The 4-segment sequence involves 4 switching states, and it must start at the vertex with even redundant switching states. This constraint will cause extra switchings, just like the 7-segment sequences. The two 3-segment sequences are different sequences and complicated to use because they must be applied alternatively. Fig.3-11(b) shows the splitting of 5-segment SVM. Two 3-segment sequences are obtained and one is the reversal of the other. The whole sampling period(l//,,,_ 5.,^g) is equally divided into two sampling periods (1//,^). Because the 3-segment sequences involve only 3 switching states and are able to start with any switching states of any vertex, they are more flexible. The three-segment sequences shown in Fig.3-11(b) will be adopted to modulate the NPC/H-bridge inverter. The ideal average device switching frequency for the NPC/H-bridge is now
fs w -- ideal fs p

(3 .7)

The inverter sampling frequency, or the centre frequency of the F ` sideband, is:
Jf inv-sp -- Jf s p f l 2 -- 6 Jf sw-ideal

Comparing Eqs. (3.1) and (3.2) we can expect that for the same ideal average device switching frequency, the 3-segment SVM achieves higher inverter sampling frequency.

3.3.2 Extra Switchings
The 7 -segment switching pattern discussed in Section 3.2 is a kind of SVM schemes using predefined switching patterns: the switching sequence doesn t change for the same triangle no matter what modulation indices or sampling frequencies are used. This may cause extra switchings. E x tra switchings happen when the leading state is not same as the ending state of the last sequence. Now let's analyze the extra switchings caused by the 7-segment SVM.

49

Fig.3-12 shows the distribution of the reference vectors w h en ^/fi-1 8 where the reference vector stops at three sampling points A, B and C when it revolves across Sector I. When nia changes, the sampling points move along the sampling lines OX, GY and OZ, involving different triangles. For example, when Vref< oyu the sampling points are located within the innermost circle and only Triangle 1 is involved. If oy\<Vref the sampling points are

within the first innermost circular band, which involves Triangles 1 and 2.

Fig.3-12 Boundaries of extra switching patterns of 7-segment SVM (fsj/fi=18)

Obviously there will be different transition patterns when different triangles are involved. Some transitions may cause extra switchings. Table 3.4 summarizes the switching transitions and maximum voltage change. According to the range of V V e/ listed in the first column, the sampling points A, B and C may be located in different triangles, which are listed in the second column. In the second column, the triangle numbers with a prime, such as AT, is the triangle in sector II in which the reference vector will be landed. The leading and ending states of the sequences are listed in the third column. Extra switching can be calculated by counting the variation of the switching states in this column. Column 4 lists the maximum voltage change occurred in the transitions. From the table it can be concluded that extra switching varies from/i to 2 /i and the maximum voltage transition is 2 voltage levels. 50

Table 3.4 S equence transition from triangle to triangle (f*p/fi=18)
T rian g les involved Vref Vref^oyi A B C Sector II A Sequence transition B C [1,1,0] Sector II [-1,0,-!] Voltage frxlra /sw_aclurai transition //. //l 2 steps 2 steps 2 steps 1 step 1 step 2 steps 2 steps 2 steps 2 steps 2 steps 1 1 I 1 2 2 1.5 1.5 1.5 1.5 5.5 5.5 5.5 5.5 6.5 6.5 6 6 6 6

A1 -> A1 -> A1 A2 A1 ^

AT [1,1,0] AT [1,1,0] A2' [1,1,0] 4 A3' [1,0,0] 4 A3' [1,0,0] 4

[1,1,0] ^ [1,1,0] ^ [1,1,0] 4 [1.1,0] 4 [21-1] 4

Oyi<Vref^OXi A1

[1,1,0] 4- [-1,0,-H [1,1,0] 4 [-1,0,-1] [1,1,0] 4 [1,1,0] 4 [0,0,. 1] [0,0,-1]

OXi<Vre^ 0 X2 A 2 - > A 2 ^ A 2
O X 2< V ,,f< o y 2

A 3 -> A 2

A8 ^ ^
^

Oy2^Vref^OX2 A 3 ^ A 1 0 ^ A 8 OX2<Vre^ OX4 A 4 ^ A 1 0 ^ A 9

A4' [ 2 , 0 , - l ] 4 [2,1,-1] 4 [ 2 , 1 , - 1 ] 4 [0,1,-2] A5' [ 2 , 0 , - l ] 4 [2,1,-1] 4 [ 2 , 2 , - l ] 4 [0,1,-2] A5' [ 2 , 0 ,- l ] 4 [2,1,-1] 4 [ 2 , 2 , - l ] 4 [0,1,-2] A6' [ 2 , 0 , - l ] 4 [2 ,1 ,1 ] 4 [2 ,2 ,-1 ] 4 A T [2-1-1] 4 [2,1,-1] 4 [ 2 , 2 , - l ] 4 [0.1,-2] [11-2]

OX4<VreJ^Oy2 A 5 ^ A 1 0 ^ A 1 3 ^ Oy-i<Vref^ 0 X5 A S ^ A l l ^ OX5<Vre^ OX^ A6 -^ A l 1 A13 ^ A14

OX(<VreJ^ Oy4 A 7 ^ A 1 1 ^ A 1 6 ^

It is easy to understand that when the sampling frequency changes, extra switching will happen in different ways. However no matter what the sampling frequency is, it can be generally concluded that extra switchings of 1.5/i to 2f\ are inevitable and the maximum phase voltage change during the transitions is 2 voltage levels. These conclusions are also true for other SVM with predefined switching sequence, such as 5-segment SVM. The actual average switching frequency is fsw-actual ~fsw-ideal /extra
(3.9)

Extra switching transition makes no contribution to the inverter sampling frequency and increases switching loss. For high power converters which work at relatively low switching frequency, extra switching is especially undesirable.

3.3.3

Design of Three-Segment Switching Sequence

3.3.3.1 Principle of Minimization of Device Switching Frequency
Extra switchings are decided by the difference between the present leading state and the last ending state. If the two sequences are for the same triangles, we can always make the

51

difference zero. Otherwise we can only minimize the difference and achieve minimized extra switchings. The most important part of the design of the 3-segment sequence is to select the leading state which has the least difference from the last ending state. Consider the transition between two sampling periods where the ending state of the first period is [S^, Sf,, and the leading state of the 2"'^ period is [5^0, Sbo, 5co]- Define two

parameters for the transition: total state value change AS and phase state value change ÃS: AS = ^jS ,- --S,-q |,
i=ajb.c

(3.10) (3.11)

Ã S = max(|S,. -S,.o|).
i=aii,c '

The leading state of a switching sequence can be selected in three steps: (1) Find the subset of switching states with minimal AS. This criterion effectively minimizes extra switchings. If there is more than one state in the subset, then (2) Choose the states with minimum 5S from the subset in (1). This criterion is to limit the voltage change during the transition and avoid unreasonable voltage jumps. Generally the leading state can be singled out by these two steps. If there is still more than one state, then (3) Select the state with least state value S for the completeness of the algorithm.

[ 2,2, -n (I. I.-2I

'

Case 1: last ending state [2,0,-1] Subset after Step (1): [2,1,-1]. Case 1; last ending state [2,-1,-2] Subset after Step (1): [2,1,-2] and [1,0,-2], Subset after Step 2; [l,0,-2].

12. - 1.-21

Fig.3-13 Example of the selection of leading state

52

For instance, let's consider the selection of the leading states for Triangle 14 shown in Fig.3-13. The previous sampling point was located in Triangle 6 . The candidate states of Triangle 14 are [2,2,-1], [2,1,-1], [2,1,-2], [l,l,-2] and [1,0,-2]. If the previous sequence in Triangle 6 ended up with [2,0,-1], the state [2,1,-1] will be selected after Step (1). If the ending state was [2,-1,-2], then [2,1,-2] and [1,0,-2] will be the subset after Step (1). After Step (2), [l,0,-2] will be singled out and the transition is limited to 1 voltage level.

3.3 3.2 Arrangement of Switching Sequence
The switching sequence is constrained among the middle states as introduced in Section 3.2. The switching pattern can then be designed in a flexible way to adapt to the leading state.
Table 3.5 Three-segment switching sequences for Ti to T^
T1& T3 T2& T4

3

w
Sequences

States

Sequences

States

D.

Table 3.5 shows the 3 -segment switching sequences for T, to T 4. For T, and T 3, there are five middle states which are all possible to be the leading state. In the second row of the table, the switching sequences are sketched for different triangles. Note that reversal switching sequences, such as the sequences and are drawn only once. All the

possible switching sequences are illustrated by arrows in the bottom rows. For example, if the

53

leading states is Â®, the sequence must be

However, when the leading state is Â®,

the sequence can be designed in two ways: to use the states with higher or lower state value S. Simulation reveals that it make no significant difference to the performance and the two methods can be used arbitrarily. Thus there are 5 kinds of switching sequences for Ti and T 3, and 4 kinds for T 2 and T4. It is obvious from Table 3.5 that the 3-segment sequences can start at any switching states of any vertex, which brings the flexibility for the minimization of extra switchings.

3.3.3 3 Selection of the First Leading State
If the switching sequences (S|,
S 2, S3, . . . )

are placed on the time axis, it is in fact a train of

switching states (Fig.3-17). Each cart of the train represents a sampling cycle and is loaded by of 3 switching states. The leading switching states
( 8 4 , S 7,

..., etc.) of each carriage except the

first one, can be selected as per the discussion in Section 3.3.3.1. The switching states (85 and Sg, Sg and 89, etc.) following the leading states can be selected according to the sequence arrangement in Section 3.3.3.2. The switching states for the following sectors can be reproduced by the negative rotation discussed in Section 3.1. There is still one problem to be solved, i.e. to select ^i, the first leading state, which is the leading state of the first switching sequence in Sector I.
F ' lead in g sta te S3 S, leading states S', S', S', S',

S7

W sp

l//sp
Sector I

yu

1
negative rotation Sector II

Fig.3-14 The train of switching states and the 1Â® ` leading state

Because the reference vector rotates counter-clockwisely, it is preferable to let the first switching sequence end at the uppermost vertex so that it is ready for the next triangle. Table

54

3.6 shows the preferable `first leading state' for the four kinds of triangles.

TI

T3

T2

T4

A

V
Â© (D

A

V
Â® ^Â© ^Â® Â®

Sequence 1 Sequence 2 leading states

Â® for sequence 1 Â® for sequence 2

It should be noted that the sequences in Table 3.6 are `preferable' to initiate the SVM is meaningful in the context that the next sampling point is located in the other triangle, which may not always be case in reality. However simulation reveals that the sequence listed in Table 3.6 yields better performance in most cases. The two preferable sequences for T, provides different performance when Vref <1: when Vre/>1 the WTHD performances are almost the same but the Sequence 1 results lower device switching frequency; when Vre/<1, they produce almost the same device switching frequency but Sequence 2 provides better THD. Thus if Vre/<1, Sequence 2 is used, otherwise Sequence 1 is used.

S.3.3.4 Examples of Three-Segment Sequence
E xam ple 1: f,Jfj= l8, Vr<f=3. The distribution of the sampling points to C is shown in

Fig.3-15(a). Triangles 6, 11 and 14 are involved. The switching states selected for the 3segment sequences are circled and threaded by dashed line according to the order of usage. The switching sequences are listed as follows:
S w itch in g seq u en ce at Point A; [2, - l,- 2 ] - > [ 2 ,- l,- l] " ^ [ 2 ,0,-1], S w itch in g seq u en ce at P oint B: [2 ,0 ,-l]"^ [2 ,0 ,-2 ]-^ [l,0 ,-2 ], S w itch in g seq u en ce at P oint C: [ 1,0 ,-2]Â·^[1,1,-2]"^[2,1,-2].

There are no extra switchings in this case. Each transition involves only one voltage step.

55

\2. 2 .-1 1

( 2 , 1 , -21

Sector I Sector I

2.0,-2] 1,0.2;
12.0,-I .2 . - 1, - 2 ]

| 2, 0 , -21
1, 0 , - 2 )

 2.

Fig.3-15 Examples of 3-segment sequence

Example 2: f,,,lf\=?>6,

Vref=?>.

The distribution of the sampling points A to F is shown in

Fig.3-15(b). Triangles 6, 11 and 14 are involved. The switching states selected for 3-segment sequences are circled. The switching sequences are listed as follows:
Sw itching Sw itching Sw itching Sw itching Sw itching Sw itching sequence sequence sequence sequence sequence sequence at at at at at at Point Point Point Point Point Point A; [2, 0,-1], B: [2, 0, -l]-> [2 ,-l,-I]-^ [2 ,-l,-2 ], C: [1 ,-1 , -2]-> [l,0,-2]-> [2,0,-2], D: [2, 0, -2 ]-> [2 ,G ,-l]-^ [2 ,l,-l], E: [2 ,l,- l]- ^ [2 ,l,- 2 ] -> [l,l,-2 ], F: [1,1,-2 ]-^ [2 ,l,-2 ]-^ [2 ,1,-1].

There is only one extra switching transition which occurs between sampling point B and C. Again, only 1 voltage step is involved for each transition.

3.3.4 Simulation
The performance of the 3-segment SVM has been simulated by modulating the 5-level NPC/H-bridge inverter (Fig.3-7). Fig.3-16 shows a set of typical waveforms. The gating signals for switches Sau, Sau, Saix and 5^24 are in the top 4 traces. The normalized voltages, VaJE, v J E , v J E , v J E , Vab/E are shown by the other traces. It can be seen the voltage of each arm (vaJE or v J E ) is 3-level, the phase voltage (va,,/E or v*,,/Â£) is 5-level and the line voltage is 9-level.

56

g a tI -- U -- UL
g a l4

J-r-T-rr-u-- U L
~ in _ J -- u r o m iru i -- LU

_i_n_n

g a ll

gal4
VaJE

1T L

Ln_

(= gall-gal4) (= gall-gaii)
VaJE

znr
JIT

-Lrnj-i-u -in. ^
JIT

JIT

j-n x i

vJE

JJZLClzu: T~ir n _ n j_ n

ju rL p cn r

O Jl-- _

-LTIT
TLTlo

(.~Vao~Vno)
vJE

iZ iX '

LTunni

V aJE

n

2n

3tc

4n

Fig.3-16 Typical waveforms of NPC/H-brldge Inverter with 3-segment SVM
(m a=0.87,^p=2160H z)

0
3 .0 2.5

0.2

0 .4

0.6

0.8
2.83

1.0

2.0

-

I

1.5

1.0

0.5

0

1.0

2.0

3.0

Fig.3-17 Simulated fundamental voltage versus

(3 -segment SVM)

The rms value of the fundamental voltage (normalized by the step voltage E) is shown in Fig.3-17. It follows the same relationship defined by Eq.(3.4). Fig.3-18 shows the WTHD of the line-to-line voltage versus VVe/with/j;,//! as a parameter. It can be seen higher sampling frequency results in lower WTHD. More simulation results will be given in the next section.

57

12

0.2

0.4

0.6

0.8

8

4

108 144 ,180 216

0

1.0

2.0

3.0

Fig.3-18 Simulated WTHD versus #na(3 -segment SVM)

3.4 Comparative Study
3.4.1 Simulation Conditions
In all simulations, the sampling frequency fsp is limited to be a multiple of 6, which are listed in Table 3.7. It should be noted that some sampling frequencies workable for 3-segment SVM can not be used for 7-segment SVM. The comparisons will be made for the frequencies in the shaded rows, where the two schemes have the same ideal average device switching frequency fsw_ideui-

fJ A

3-segm ent SVM 12 18 24 30 36 42 48

7-segm ent SVM

fsw jdea!

1

M

i

3-segment SVM 120 126 132 138 144 150 156 162 168 174 180 186 192 198 204

7-segm ent SV M
-

fsw_ideal

1

6

1 1.5 2 2.5 3 3.5 4 4.5 5 5.5 6 6.5 7 r 7.5 8

10 10.5 11 11.5 12 12.5 13 13.5 14 14.5 15;:-:::..: 15.5 16 ; 16.5 17

42
-

12

18 24 30 -

48 -

54
60 66 72 78 84 90 96

54
-

60
-

66

-

58

102 108 114

36 -

8.5 9 9.5

210 216 72

17.5 118

For each sampling frequency, the simulations were done for V^e/from 0.01 to 3.46 with 0.01 increment, or equivalent from 2.9x10'^ to 1.0 with 2.9x10'^ increment. The inverter

topology is shown in Fig.3-7. The detailed block diagrams and initialization functions are attached in Appendix 2.
V an (iine-to-neutral voltage)
2E

ffl

V u i,(lin e-to -lin e

voltage)

4Â£

0 2jc
Fig.3-19 Simulated voltage waveforms of NPC/H-bridge inverter with 7-segment SVM
(ina=0.87,/i=60Hz,/Ã§,//i=42,/,,,._w,,,,=630Hz) V an (line-to-neutral voltage)

ab(Hne-to-line voltage)

Fig.3-20 Simulated voltage waveloriris of NPCm-brldge Inverter with S-aegment SVM
(m fl= 0 .8 7 ,/i= 6 0 H z ,/,//i= l - 6 3 0 Hz)

59

3.4.2 Waveforms
While the shapes of the line-to-neutral voltages are different, the line-to-line voltage waveforms are quite similar. Fig.3-19 and Fig.3-20 shows the waveforms. For both schemes the line-to-neutral voltages have 5 voltage levels and the line-to-line voltage is 9-level. It should be noted that there are two transitions with 2-voltage-level jumps each fundament period in Fig.3-19(a) for the 7-segment SVM, which are pointed out by triangular marks. In contrast the transitions in Fig.3-20(a) are always limited to 1 voltage level for the 3segment SVM. This is true for all other modulation index and sampling frequencies.
Fundam ental (60Hz) = 3.458

Fundam ental (60Hz) - 3.458 , THD= 16.01%
/ip=2520H

^ 7 6 5

%

4 3 2 1

-- /-.(lOO*)

uJlii kiuLll
2000 4000 6000

JlJ i iL L
8000

Jll
12000

0

,

10000

2000

3000

4000

5000

Frequency (Hz)
(a) Spectrum over 0-12000H z

Frequency (Hz)
(b) Spectrum over 0-5000H z

Fig.3-21 Simulated spectra of line voltage of NPC/H-bridge inverter with 7-segment SVM

(m,,=0.87,/i=60Hz,/,p//,=42,/j,,.jj^a/=630Hz)
Fundam ental (60Hz) = 3.462 , THD= 14.77%
0.5/,p=3780H

7 6 5

Fundam ental (60Hz) = 3.462
59" - 7,( 100%) 67"'

--7,(100% )
t

4 3 2 1

JjiU
2000 4000 6000 8000

10000

1 1

n 12000

^

0

1000

2000

3000

4000

5000

Frequency (Hz)
(a) Spectrum over 0-12000H z

Frequency (Hz)
(b) Spectrum over 0-5000H z
o f

Fig.3-22 Simulated spectra of line voltage

NPC/H-bridge inverter with 3-segment SVM

(ma=0.87./i=60Hz,/,p//i=126,/,,,_,vj,^=630Hz)

60

3.4.3 Spectra, THD and WTHD
The centre of the first sideband in the spectra of the output voltages is at higher frequency for the 3-segment SVM, as shown in Fig.3-21 and Fig.3-22. Fig.3-21(a) and Fig.3-22(a) are the spectra over a wider frequency range up to 12000Hz, i.e. 200'*' harmonics. The first sideband in Fig.3-21 (a) is centred at 2520Hz, which is the same as the sampling frequency for the 7-segment SVM while it is 3780Hz in Fig.3-22(a), which is half of the sampling frequency of the 3-segment SVM. The centre of the first side band of the 3-segment SVM is 1.5 times that of the 7-segment SVM, which is consistent with Eqs.(3.2) and (3.8). For the above reason, the 7-segment SVM produces more lower-order harmonics as shown in the zoomed spectra in Fig.3-21(b) and Fig.3-22(b). Thus it is reasonable to expect that 3-segment SVM can achieve lower WTHD. It should also be mentioned that both algorithms produces no even harmonics.
0.2 0.4 0.6 0.8 1.0Â« 4

1200 1000
800 zoom Q 600 0.4
0.6

0.8 3-segment SVM 7-segment SVM

--

4 00

2.5

ref

200
2.5

0.5

'ft/

Fig.3-23 Comparison of THD versus

C/i=60Hz, /i,,_fd,a;=630Hz) The above observations about the spectra can also be found for other modulation indices. Fig.3-23 and Fig.3-24 shows the THD and WTHD versus Vref. While the THD is very close to each other, the WTHD o f the 3-segment SVM is better except when Vref is between 0.8-1.0 or

61

1.4-1.6. The superiority of 3-segment in terms of WTHD is true for other sampling frequencies, especially at lower sampling frequencies. For more comparative results, see Appendix 3.
0.2
0 .4

0.6

0.8

1.0/re,

2.5

--

Ssegment SVM 7-segment SVM

0.5

0.5
(/i= 6 0 H z , /j,,.j*a;= 630H z)
18 pulses
S M m fT T T lL

2 .5
mg

Fig.3-24 Comparison of WTHD versus

iiM m iiT Ã¯m
6 pulses
18 pulses

jjiiin im in

go21

T itm n n fm m rm L
6 pulses

go24

It

2jt

3?!

4n

Fig.3-25 Gating pattern of 7-segment SVM
(m,,=0.87,/i=60Hz,X,y/i=42,/s.^_;j,,,,i=630Hz)

16 pulses
g a ll 

jim m n u m
6 pulses

jimiiTU JT

g a l4

16 pulses
ga2l _

J iiiin iiriirL
6 pulses

J im m n in T L

go24

im_
n 2n

37T

4 jc

Flg.3-26 Gating pattern of 3-segment SVM
(m ,,= 0.87,/i= 60H z,/jp//,= 126,/s.,,j*,.; =630H z)

62

3.4.4 G&ting P3ttÂ©rn snd D6vic6 Switching FrÂ©guÂ©ncy
The gating pattern is symmetrical for the left and right arms, but asymmetrical for the top and bottom switches. Fig.3-25 and Fig.3-26 shows the gating signals for the switches 5an, Sai4, Sa2 i ^nd Sa24- Fof the 7-segment SVM, the top switches operate at 1080Hz and the bottom ones at 360Hz. The average switching frequency is 270Hz. For the 3-segment SVM the top switches work at 960Hz and the lower ones at 360Hz. The average switching frequency is 660Hz, The deviation in switching loss caused by asymmetrical switching pattern can be corrected by swapping the coding schemes, which will be depicted in the next Chapter. The conclusion that 3-segment SVM yields lower actual device switching frequency is general for other modulation indices and sampling frequencies. Fig.3-27 shows the normalized actual average device switching frequency versus Vre/ when the ideal switching frequency is 630Hz. It can be seen that the device switching frequency of 3-segment SVM is 0.5/i to 1.5/i less than that of 7-segment SVM. More comparative curves for the other sampling frequencies are included in Appendix 3.
13
0.2

0.4

0.6

0.8

1.0 ffla

3-segment SVM 7-segment SVM -- Ideal switchina freauencv

12

f r
I
2 2.5
n tg

11

10

0.5

1

1.5

3 ((,MLWÂ«a/=630Hz)

Fig.3-27 Actual average device switching frequency versus

63

3.5 Application of 3-Segment SVM to 9-Level Inverters
The proposed 3-segment SVM is generally applicable to any multilevel topologies. As an example, this section will present the simulation results for a 9-level CHB inverter. Fig.3-28 shows the line-to-neutral and line-to-line voltages for one fundamental cycle. The line-toneutral voltage contains 9 levels and the line-to-line voltage is of 15 levels. Fig.3-29 shows the spectrum of the line-to-line voltage when the ideal average switching frequency is 630Hz. The inverter sampling frequency is still O.Sfsp, pushing the centre of the 7650Hz, which is doubled from 5-level NPC/H-bridge inviters.
V an (line-to-neutral voltage)

sideband to

d liO lU T
4Â£

Irn im u iu iy ^ ^

v,,i(line-to-line voltage)
7Â£

0

nJ2

n

2n

Fig.3-28 Simulated voltage waveforms of 9-level CHB inverter with 3-segment SVM
(m .= 0 .8 7 ./,= 6 0 H z .^ ,= 2 5 2 .^ j* n , =630Hz)

Fundam ental (60Hz) = 6.929 , THD= 5.75%

-/id 00%)
0.5/,p=7560Hz

> 1 i l II 11 11

AtW

2000

4000

6000

8000

10000

12000

Frequency (Hz) Fig.3-29 Simulated spectra of line voltage of 9-level CHB inverter with 3-segment SVM

64

3.6 Summary
This chapter presents the simplified sequence design for multilevel inverters. A flexible 3segment SVM scheme is proposed and compared with conventional 7-segment SVM scheme. The proposed 3-segment SVM features: (1) Lower device switching frequency which leads to lower switching losses. Extra switchings caused by the reference vector crossing triangle boundaries are minimized by the flexible 3-segment sequences. (2) Higher inverter sampling frequency which leads to lower WTHD. The center frequency of the first sideband of the 3-segment SVM is 50% high than that of 7-segment SVM. This feature is of particular importance for high-power MV drives that operate at lower switching frequencies. (3) Easy implementation by rule-based sequence design which can be fulfilled in real time. Because the sequence is generated in real time from the information carried by the previous sequence, there is not need to design sequence table for each triangle. (4) General applicability to any multilevel inverters. The algorithm was developed based on the vector plot of multilevel inverters, thus is independent of inverter topology. It can be used for any voltage levels. (5) Half-wave symmetry eliminating even harmonics, which enables it to be used for active rectifiers.

65

CHAPTER 4 EXPERIMENTS

A prototype converter system has been set up to verify the performance of the proposed dual 18-pulse rectifier and the flexible 3-segment SVM. This chapter will introduce the experiment setup, including the system block diagram, the planning and testing of the 18pulse transformers and the coding scheme of space vector modulation for the NPC/H-bridge inverter. The experimental results of the harmonic contents of the input current will be discussed in association with the theoretical expectation of Chapter 2. The SVM schemes with 7-segment and flexible 3-segment switching sequences were implemented via dSpace Rapid Control Prototyping system. The experimental output voltage waveforms and the spectra were compared to the simulation results. The principles of the proposed rectifier topology and the performance of the 3-segment SVM scheme were confirmed by the experimental results.

Diode rectifier N PC /H -bridge cell Diode rectifier
^ g a tin g I

18-pulse PST (A-primary)

I V,

Diode rectifier P rech arg in g circu it N PC /H -bridge cell Diode rectifier

^ , gA || a tin g
-r

I

18-pulse PST (Y-primary)

Diode rectifier

N PC /H -bridge cell

Diode rectifier dc link C P I 103 I/O Box _ gating gating i' Interface board INTo G ating board 1-12 I v,,

IOo-IO |2 tlSVdc

PC with
d S p a c e D S l 103 board

Fig.4-1 System block diagram of the experimental setup

67

4.1 Experiment Setup
4.1.1 System Configuration
The system block diagram of the experimental setup is shown in Fig.4-1. The three-phase utility power is connected to the two 18-pulse PSTs through the precharging circuit, which is used to limit the inmsh current at the startup. Six 3-phase diode rectifiers are powered by two 18-pulse PSTs and their DC outputs are connected according to the application case 3 shown in Fig.2-8 (Section 2.4). Each inverter phase is an NPC/H-bridge cells (see Fig. 1-6). The control of the inverter is based on dSpace hardware-in-the-loop simulation environment, which allows easy prototyping of controllers with the Simulink/RTI and downloading of these controllers to dedicated Digital Signal Processor (DSP) based systems for implementation. The dSpace main board DSl 103 is embedded within the host PC, on which the Simulink/RTI environment is running. Digital I/O bits lOo to lO n are used for the gating signals for the top and bottom switches of the NPC arms. These signals are shifted from TTL level to CMOS level by the interface board. Complementary gating signals for the middle switches are generated by the interface board. All these signals are buffered and sent to the gating boards. The gating signals are reshaped, amplified, isolated and passed to the 12 IGBT modules by 12 gating boards. Semikron SKHI 22B hybrid dual IGBT driver modules are used. The blank-off time is set to 4.3ps and the short-pulse suppress is 500ns. The gating boards also generate error signals in the case of short-circuit, low supply voltage or all-high gating signals. The error signal is passed to the controller running in DSl 103 via ZNTq, provoking service subroutine for fault processing. If an error occurs, all the gating signals at IOq to lO i, will be cleared and a FORBIDDEN signal is sent to the interface board via IO 12, which is then used to block all the complementary gating signals. As a result all the IGBTs will be switched off.

68

The major parts counts of the experimental setup are listed in Table 4.1.
Table 4.1 Parts Count table of the experiment setup Transformer Number
2

Winding
5

Rectifier
6

Cap
6

IGBT module Diode module
12 6

R atin g : 240 :1 2 0 V ; 5kV A each; Primary, P h a se shift: 20Â°, 0Â°, -20Â° Model 240V 5kV A (A -prim ary); (parameter) Secondary: P h ase shift: -10Â°, -30Â°, -50Â° 120V3kVA (Y -prim ary);

Sem ikron SK K D Sem ikron Sem ikron SKM 75F12 SKD 4700pF 75G B 123D (1200V 75A ) 50/12 A3 400V (I200V 75A ) Trr=920ns (1200V 50A )

I

C o n v e rte r cab in et

Kquipment
C P I 103

Flg.4-2 Photo of

the experiment setup

The picture of the experiment setup is shown in Fig.4-2. The converter cabinet stands at the right. It holds the fuses, rectifiers, DC link capacitors, inverters, interface board, gating board, heat sink and so on. The computer equipped with dSpace main board DSl 103 is located in front of the cabinet It is connected to the interface board through I/O box CPI 103. To the left o f the cabinet ate the two 18-pulse PSTs, which power the dual 18-pulse rectifier.

69

4.1.2 Planning and Testing of the Transformers
To achieve dual-18-pulse rectification, the two 18-pulse are designed in a way that one transformer is phase-shifted by 30Â° from the other. The wiring diagram of one PST is shown in Fig.4-3(a), where the primary is in A-connection and secondaries are in extended-A. The phase shift angles of the secondaries are 20Â°, 0Â° and -20Â°. The wiring of the other PST is shown in Fig.4-3(b), where the primary is in Y-connection, and secondaries are also in extended-A to balance the secondary leakage inductance with those of the PST. If the

primary voltage of the 1 * * PST is used as the reference, the phase shift angles are -10Â°, -30Â° and -50Â°.
r Nj2
X j

N ,i r
20Â° (le a d in g )

Â· Xi -1 0 Â°
( l a g g in g )

#

X

X

H i Hi,
P rim ary

.

Y
( l a g g in g )

Hi o --
Primary

Z

(V fl I
(lagging)

W s i N il
Xg

-5 0 " ( l a g g in g )

kv~2:\

Secondary

ki-- 2 .l

Secondary

(a) A-primary PST

(b) Y-prim ary PST
of

Fig.4-3 Winding diagram

the PSTs

The turns ratios can be calculated from the phasor diagrams of Fig.4-4. Take the PST with A-primary as an example. The voltage phasors of the secondary xiX2Xj are shown in the dotted circle at the top right corner of Fig.4-4(a). Apply the Law of Sines in Axixjs : x^s sin 20Â° XfS sin 140Â°'
(4.1)

sin 120Â° Thus

70

N N

s2

2 x ,x ^ ^ --------x^s _ 2 jc, jc2

2 sin 120 Â°

^ = 5.064, sin 20 = _ 1 0 . 5 ~ N ^ ^ / N pA = 3.305.

(4 .2)

pA

N j1

x^x^-x^s

(4.3)

'30"

xyz
-30"

- 20 Â°

-50"

(a) A -prim ary

(b) Y -prim ary

Fig.4-4 Phasor diagram of the PSTs

where Np^ is the turns number of the A-primary, N^i is the turns number of the A-coils of the secondary, and Ns2 is the turns number of the extended-A coil (Fig.4-3(a)). The turns ratio of the Y-primary PST can be calculated in a similar way. The actual transformers are tested to obtain parameters of leakage inductance and phaseshifting angles. The results are shown in Table 4.2. The phase-shifting angles and errors are recorded in the `Phase shift angle' column. It can be seen the PSTs are non-ideal because the maximum phase error is 3.7Â°. The short circuit test results are shown in the right 6 columns in terms of actual unit and per unit. The average leakage reactance is around 1% p.u. and the average copper resistance is about 3.4% p.u. on the basis of the primary parameters (240V5kVA). The short circuit parameters are slightly unbalanced for the 6 secondaries.

71

Table 4.2 Phase Test and short circuit te st results of the PSTs
Phase shift angle 20Â° secondary E Â·a < 0Â° secondary -20Â° secondary -10Â° secondary E a -30Â° secondary -50Â° secondary (17.7Â°, 16.3Â°, 17.3Â°) error: (-2.3, -3.7, -2.7)Â° (-0.1Â°, -0.4Â°, -0.6Â°) error: (-0.1, -0.4, -0.6)Â° (-20.5Â°, 20.5Â°, -20.5Â°) error: (-0.5, 0.5, -0.5)Â° (-10.1Â°, -9 .5 Â°,-1 0 .3 Â°) error: (-0.1, 0.5, -0.3)Â° (-31.1Â°, -31Â°, -30.5Â°) error: (-1.1, -1, -0.5)Â° (-51.3Â°, -50.4Â°, -50.3Â°) error: (-1.3, -0.4, -0.3)Â° A verage Impedance(Z) Q 0.42 0.41 0.37 0.45 0.42 0.38 0.41 p.u. (%) 3.6 3.6 3.4 3.9 3.7 3.3 3.58 Resistance(/Ã) (O ) p.u.(% ) 0.40 0.39 0.37 0.43 0.40 0.37 0.39 3.5% 3.4 3.2 3.8 3.5 3.2 2.86 Reactance/<uL) p.u. (%) Q 0.10 0.13 0.11 0.13 0.14 0.085 0.12 0.87 1.1 0.92 1.1 1.2 0.74 0.99

Note: The per unit values are based on the primary (240V5icVA); Zto.=Vb,,,7Ibasc=VLVS=240*240/5000= 11.52Q.

4.1.3 State Decoder for NPC/H-Bridge
The inverter can be viewed as a coder: the switches are driven to different positions by gating pulses to generate codes (switching states). The modulating process is in fact a decoding process: translating the command voltage into switching sequence which is

composed of a train of switching states, then decoding the switching states to obtain the gating pulses. For example, if the code is [2,-2, 2] for the NPC/H-bridge inverter, it should be decoded in a way such that that 5Â«n, 5 ,,,2, 5^23 and 5^24 are turned on, J^ii, Sb\2 , %23 and 5^4 turned off, and .Scii, &i 2, Sci^ and Scia, turned on (see Fig. 1-6). The other switching devices are operated in complementary ways. Thus the last step of SVM algorithm is to design a decoder which generates gating signals according to the switching states. However, for 5-level NPC/H-bridge inverter, there are different ways to generate codes
1 , 0 and -1 . To illustrate this situation, phase A of the NPC/H-bridge inverter is redrawn

in Fig.4-5. If the switching function of Phase A is S, then
Va,,=5E, (4.4)

72

where 5 = Â±2, Â±1 or 0. The switching function can be implemented in different ways listed in Table 4.3, where Sao and are the switching functions of the NPC arms. There are 2 ways to

decode Â±1 , and 3 ways to decode `O'. Thus there are altogether 12 ways to decode 5, which correspond to the 12 decoder shown in Table 4.4 all'llÂ»

^

Fig.4-5 Phase A of the NPC/H-bridge inverter.

s
^ao Sno

-2 -1 1

-1

0 0 1 -1 -1 0 0 1 1 0 -1

1 1 0

2 1 -1

-1
0

Table 4.4 Different decoding schemes for S and bad transitions
D ec o d e r 1 s
^ao S ,t(? 1

D ecoder 2
Sao 1 , - 1 : ! I Sno 1

D ecoder 3 c i c `-'t/o 1 *-^no
-1

Decoder 4
SaO SnO

D ecoder 5
Sao -1 w Sno

Decoder 6
S<io Sno

-2 -1 0 1 2
S

-1 -1X

1

1

-1

0 0 \
- 1 /

1 0

0

-K i 0 \ i 1 / i 1 i

0 0 0

1 / 1
Sao - K

i / -1-^

1
Sao

1V I
1 Sno

D ecoder 7
Sno 1

D ecoder 8

-1 Decoder 9
SaO 1 SnO

-1 0 0 1
Sao

1 0 0 -1 -1
Sno

-1
- I f .

0

Â·.

-1 -1

u.

0 Â·Â·Â· -1 /

{

D ecoder 10

-2 -1 0 1 2

-1 -1 1 -1 I 1 -U I 1 0 0 0 i 1 1 0 \ i K V 0 \ 0 -L 0 I 0 o \ 1 / i 4i\\ 1/ u - U '.. 0 I V / 0 1 I 0 1 l y o ': 0 I -1 y -1 u* -1 1 1/ -1 / 1 i VI 1 i -1 1 ransitions involving 1 voltage step are marked by arrow s with solid lines; N ote: 1 ) bad t 2 )1 )ad trans itions involving 2 voltage steps are marked by arrows with dotted lines.

-1 / 0 -1 1 / D ecoder 11 5,,,, Sao -1 1 0 i K :

-1 0 *; -1 1/ D ecoder 12 San Snn

u - `v . V I ' -1

For NPC/H-bridges, the maximum voltage change of a single NPC arm for every transition should limited to ONE voltage step, i.e. the transitions of Sao and Sno are limited to 1 voltage-step, otherwise there will be voltage sharing problem. For example, if the voltage

73

change of the left arm in Fig.4-5 is +2 voltage steps, i.e. Vao changes from -E to E, all the four switches in the left arm have to be operated, with and San switched to o ff and and

Sa\4 switched to `on'. In this case dynamic voltage sharing problem will occur, leading to possible device damages. Transitions involving 2 -voltage-step change in a single NPC arm are considered to be bad transitions. Analysis of the switching transitions of Table 4.4 shows that (1) if S is allowed to have 2 -voltage-step jump during the transition, only the 4^*' and 9*'^ decoder are workable. The other decoders cause bad transitions, which are marked by arrows with dotted line. This is important for 7-segment SVM that causes 2-voltage-step change for S. (2) if S is limited to 1-voltage-step jump during the transition, the 3"^^, 4*'', 6 ^ '', 7'^ , 9^^ and 1 0 * * * decoders are workable. Bad transitions in this case are marked by arrows with solid line. This is for flexible 3-segment SVM, which generates transitions with only 1-voltage-step jumps. It can be concluded that decoder 4 and 9 can be used for both 7-segment and 3-segment SVM schemes. It was mentioned in Section 3.4.4 that the unbalanced switching pattern can be corrected by swapping the decoding schemes. In fact Decoder 4 and 9 can be used alternatively to balance the top and bottom switches. Fig.4-6 shows the gating signals of the top and bottom switches of phase A when swapping happens every 3 fundamental cycles. It is clear that the gating patterns are now balanced.
gu ll -ni Lnam o u rn L n im 1 n 1 n_____ i-- im____ in iin i
i n i
i n um

im m
n i
i im rn

m m-n
n.

i--

- u u i m --------- u u ir n _______ in tim
Su2i m n m

m irr

Lium

-I

----------- 1

n ----------

1

n ---------- n i r r i

1

gu24Lm

I

n___ I --n

uinrn

Lium

Fig.4-6 Balanced gating signals by swapping decoding schemes.

4.1.4 Simulink/RTI Model for the Controller
The Simulink/RTI model for the implementation of the SVM schemes are shown in Fig.4-

74

7. The main block diagram of whole model is shown in dashed square at the top left comer. It contains 3 subsystem, modulator , output' and `error detect'. The modulator subsystem implements the 7-segment or 3-segment modulation algorithms and is depicted in Appendix 2 in detail. The other two subsystems are shown Fig.4-7 in separate dotted squares pointed by arrows. The `Output' subsystem assigns the gating signals to the dSpace 1/0 ports, while the `Error detect' subsystem is the interrupt service subroutine for INTo. Execution of the `Error detect' will set the error flag `FORBID', which is read by the `Output' subsystem to clear IOq to lO ii and set IO 12 to high. lO n is then used by the interface board to block all the complementary gating signals. As a result, all gating signals are cleared.
RTI D ata

I

? Double click for detailed information. Tngger FORBID FORBID C onstant D ata S tore Write

Modu ator

gatings Trlggero

Output

Error detect

DSt103M ASTER HWINTM

Subsystem

SA11 SA14 SA21 SA24 ....B&C...
g atings FORBID  'JO T zeros(1,3)

U { E IK E-

3it to Integer C onverter DS1103BIT_OUT8_G0

S.N.
3 1 2

initial s e t to 1 to c le a r gating th e b o ard error

3it to Integer Converter DS1t03BIT_OUT8_G1

11 12
9

SW SA21 SA24 SA11 SA 14 SB21 SB24 SB11 SB14 SC21 SC24

ID ICO lo t 102 103 104 105 106 107 108 109

s o i l I0 1 0

10

SC14 I011

Fig.4-7 Block diagram of Simulink/RTI model of the inverter controller

4.2 Experiment Results
4.2.1 Input Current of the Rectifier
The dual 18-pulse PST based rectifier is tested for the NPC/H-bndge converter system.

75

The test was done for 4kW (0.4 p.u.) resistive load. The current waveforms and spectra are shown in Fig.4-8. The input currents of each PST,
Iaa

&nd

Ia y,

and the total current
i a a

Ã®a

are
Ia ) -

shown in Fig.4-8(a), (c) and (e) (see Fig.2-11 for the definitions of

,

U

y

nnd

Apparently the total current Ia has better shape. The spectra of the three currents are shown in Fig.4-8(b), (d) and (f), from which the THD can be calculated as 7.8%, 7.7% and 2.7% respectively. Considering that no input filter is applied, the 2.7% overall THD is a good index of performance. In the spectra of Ã» and Iaa, some lower order harmonics can be identified. However most of the lower order harmonics are diminished in the spectrum of IaTo compare the details of the current waveforms and the spectra, Fig.4-8(g) displays the current waveform in a single frame and Fig.4-8(h) shows the vertically zoomed spectra. The harmonic cancellation pattern is consistent with theoretical expectation of Table 2.3. Because the non-ideal parameters of the 18-pulse PSTs, non-characteristic harmonics such as the 7`* ^ , 11*'', 13*'', 23***, 25*'' and so on, appear in the spectra of Iaa and Ia y (the top and middle traces of Fig.4-8(h)). However some of these harmonics, such as the 5*'', 7*'', 17*'', 19"' and so on, are neutralized in the spectra of Ãa (bottom trace) due to cancellation Pattern 2 (Section 2.3.2), which is consistent with the simulation results of Fig.2-15. The cancellation of the 5*'' and 7*'' harmonics is a big relief because these two are the nastiest harmonics. It is reasonable to deduce that if the 18-pulse PSTs were defectiveless, the 11*", 13*", 23*" and 25*" harmonics would be neutralized within the PSTs, thus the lowest harmonic should be the 35*". The third harmonic peak is caused by the lack of three phase asymmetry.

76

lOA/div : 2m s/div r
 --- Fundam entals. IA
rH-M-n

250H z/div T H D =7.8%

:

m

L (a) In p u t C u rren t o f P S T w ith A -prim ary(j^j) (b) Spectrum o f

.

......^

lOA/div 2m s/div ;

2A /div 250H z/div T H D = 7 .7 % . . .
Fundamental:^. 1A

ib !6 m v fÂ»

M2 .0 0 ms C h i >

I `Â».4mV

QEIURI

2. 00mv

" 2 5 0 HZ

' W z.bbm s' d i i I ` y

' I J .'in iv

(c) In p u t C u rre n t o f P S T w ith Y -prim ary (lAx)

(d) Spectrum o f lAr

lOA/div 2m s/div

5A /div 250H z/div ,T H D =2.7% . . .
Fundamental: 18.2 A

4-+ 4^

4 -I-M -+

O B

fciz'.btiiis drii J

ii.bmV

(e) T o ta l In p u t C urrent (ia)

(f) Spectrum o f U

77

r'

'''

' ' '"'I
. . . . . ÃÂ· .
. . . . . . .

T
:
i .

4.4%

1(3A/di V 2]Tis/di V

5T

17* . j i 9 ^ "- .................. i > 6^1* '- ' ! _ 23"! 25* 2 9 * 3 1

Â· ijLS /lnns=9.1A(100%)

' ' ' ......

2 .2 % 0

Ã ^

y

M 2'  m
V

i
: Ml-: /lrms=9.1A(100%)

4.4%
2 .2 %

A
M M
'

l"

0
2 .2 %

V.7

11"
13*

250Hz/div
f 23'"25*
1. 1%

.

Â·T J
Ã

:35* 37*

au
I
14.4mV

jU _
n m in '?n(iuv 2S0 Hz M 2.boms citil j

...
I4 .4 m v

0

A H l'

6.6m

CIl2 iÃ.OniVitÂ»-. M i.OOms

(g) AU the input currents (Ã¹ ,

and ÃaJ)

(h) Zoomed Spectra o f i^, i^y and

Fig.4-8 Experiment waveforms of the input currents.

4.2.2 Output voltage of the Inverter
The performance of the flexible 3-segment and 7-segment SVM schemes was compared at difference sampling frequencies and fundamental frequencies. The output line-to-line voltage and their spectra are recorded. Fig.4-9 shows the waveforms and spectra of the output voltages obtained by the 3-segment SVM when the fundamental frequency /i=60Hz. The line-to-neutral voltage Van and line-toline voltage Vab are shown in Fig.4-9(a), where V a,, contains 5 voltage levels and Vab 9 levels. The spectra of the voltages are shown in Fig.4-9(b). To shown relative magnitude of the harmonics, Fig.4-9(c) shows the zoomed spectra, from which the first sideband can be identified. The centre of the first sideband is at 3780Hz, which is 0.5f,p. Fig.4-9(d) shows more detailed spectra over 0-5^:Hz, from which it can been seen that harmonics while v,,b contains only non-triplen odd harmonics. Fig.4-10 shows comparatively the waveforms and spectra obtained by 7-segment SVM when/i=60Hz. The most distinct difference is the centre of the first sideband is now 2520Hz, which is the same as the sampling frequency for 7-segment SVM. It should be noted that the ideal average device switching frequencies are the same for both SVM schemes. Thus it can contains triplen

78

be concluded that the flexible 3-segment SVM can increase the inverter sampling frequency by 50% (3780/2520=1.5). It can also be found that in both case the spectra contain no even harmonics. The waveforms and spectra are consistent with the simulation results of Fig.3-19, Fig.3-20, Fig.3-21 and Fig.3-22.
... ....
--- F u n d a m en ta l= 5 7 .7 V

1' 1' 1' ' ' ' ' 2 0V /div 1.25kH z/div '

:

50V /div 2m s/div

-- F u n d am en tal= 1OOV

25V /div 1.25(tHz/div

;

j
T

lOOV/div 2m s/div M|40.0ms A j cm f 1.00 V

(a) V o ltag e w aveform s 4V /div 1 .2 5 m z /d iv 1

(b) Spectra o f the voltages 4V /div 500H z/div

R h i_ L i

x J jJ u J iiiiU A .

'0.5U
2.5V /div 500H z/div
: Ã.

0 .5 /,^ 3 7 8 0 H z

t
f^ P

2 .5V /div 1 1.25fcHz/div J


40.0ms A t Chi f 1.00 V

M l

I

i

M|4 0 . 0 ms

A| C h i /

J

1 .0 0 V

II

(c)

V e rtic a lly zo o m ed sp ectra over 0 - 12.5kHz

(d)

V ertically zoom ed spectra o v er 0 -5 kH z

Fig.4-9 Experiment waveforms of inverter output voltage(3-segment SVM, f,=60Hz).
= l 2 6 ,U _ i d e a i = 6 3 0 H z a n d m , = 0 . 8 7 )

79

Ã Ã

20V/div

Ã® i i i i i i r i

. 50V/div 2ms/div

1 II

-- Fundaniental=.)7.7V
.

.. ,i ......

Ã

1 -- Lf l- !

Ã

,

O V Fundamental= O lOOV/div 2ms/div 1J 1 I ..I I
M |4 0 . 0 m s A| C h1

}
t t i
M |4 0 .0 m s

25V/d iv 1.251cHz/d

V

I

2 4 ,0 V

A|

C h1

f

2 4 .0 V

(a) Voltage waveforms 4V/div ,25tHz/div

(b) Spectra of the voltages 4V/div 500Hz/div

9

S V /H iv

2.5V/div 500Hz/div

/,^ 2 5 2 0 H z

M |4 0 7 Ã m s

A|

c m

f

2 4 .0 V

M

p Ã´ m s

Ã|

C hl

f

2 4 .0 V

(c) Vertically zoomed spectra over 0-12.5kHz

(d) Vertically zoomed spectra over 0-5kHz

Fig.4-10 Experiment waveforms of inverter output voltage (7-segment SVM, f,=60Hz).
= 42,/,,,._W fa;= 630//z a n d m ^^O .ST)

The sidebands are not easy to be recognized in Fig.4-9 and Fig.4-10 because the normalized sampling frequency is relatively low and the sidebands are merged to some extent. Fig.4-11 and Fig.4-12 show the waveforms and spectra of another case: /i=3Hz and /wj</eaF90Hz. The waveforms obtained by 3-segment SVM are shown in Fig.4-1 1. The sidebands can be clearly identified. The inverter sampling frequency is 540Hz. Fig.4-12 shows the waveforms obtained by conventional 7-segment SVM, the sideband bands can also be clearly identified and the inverter sampling frequency is 360Hz, which is 2/3 of the inverter frequency of the 3-segment SVM.

80

^ FÃ¼hdÃ¢mjiial=57,7V

20V /div 250H z/div

50V /div 40m s/div
t 1 * 1 I I Ã'I 1 I +4-

--- F u n d a m w ta l= 1 0 0 V

25V /div 250H z/div

illlf

lOOV/div 40m s/div
M| 200m s: A| CtiT V"' ' 49.Ã y

R ?

--

M |200m s| Ai C h i jr

- ' ' - -

4 0 .0 V

(a) V o ltag e w aveform s  4V /div 250H z/div

(b) Spectra o f the voltages 4V /div 62.5H z/div

p

lliff

Jtik.

0 .5 /,p = 5 4 0 H z

: 2 .5V /div ; 250H z/div

2.5V /div 62.5H z/div

M 200m s] M C hi y

4 9 .0 V

M 200m s

C hl y

4 0 .0 V

(c) V e rtic a lly zoo m ed spectra over 0-2.5kH z

(d) V ertically zoom ed spectra over 0 -625H z

Fig.4-11 Experiment waveforms of inverter output voltage (3-segment SVM, f|=3Hz).
( L p / f i = 'i^ ^ J s w -J d e a != 9 0 H z a n d m ^ = 0 .8 7 )

, . ,-r-l Â· : T" 1 . T "1 -1 .
--- FLndhmenial=57.7V

 OV/d IV 2 50Hz /d iv

50V /div 40m s/div H-.H!Â» Fu ndamental=IOOV

.- Â·.* --4-4 -4 -+4 44 25V /d
V 3 U H Z /d iv

lOOV/div 40m s/div
M l200m s, A| C h i J~ 8.00 V Ã .......... M[2(

)m*l

A| C h i J-

Â«.OOV

(a ) V o lta g e w aveform s

(b) Spectra o f the voltages

81

.

-- Â· r-

.

1 Ã Ã

4V/div 250Hz/div

1.

' ' t ' ' I ' - 1 - ' *' ' 4V /div

t i i

L .- ,

--

d f iL jj

{ /P

2U f,p= 3m Â»z
I

2.5V/div 250Hz/div

1 j 'J
CN 1

2.5V/ div 62.51 Iz/div

% p ( Ã®

.

%

%
X 00 V

IW

........
A[ C h l y 8- 0 0 V

k

M ]2 0 0 m s]

A[ C tll y

M l'JO O ms

(c) Vertically zoom ed spectra over 0-2.5kHz

(d) Vertically zoomed spectra over 0-625H z

Fig.4-12 Experiment waveforms of inverter output voltage (7-segment SVM, f|=3Hz).
i U ' f i =120,/,H,_,vra/=90Hz an d ma=0.87)

More waveforms and spectra can be found in Appendix 4 for various sampling frequencies.

4.3 Summary
This chapter presents the experimental setup and results. The overall block diagram of the system, the planning and testing of the 18-pulse PSTs, the coding schemes for the NPC/Hbridge inverter and the Simulink/RTI model are introduced in detail. Experiments were carried out to test the dual 18-pulse rectifier and to compare the performance of the conventional 7-segment and flexible 3-segment SVM schemes. It can be concluded from the experiment that: (1) The harmonic cancellation pattern of the dual 18-pulse PST based rectifier is consistent with the theoretical expectation. (2) The proposed rectifier provides additional opportunity to cancel the 5th and 7th harmonics when the 18-pulse transformers are non-ideal. (3) The performance of the proposed 3-segment SVM scheme is verified by the experiment. The inverter sampling frequency is 50% high than that of the 7-segment SVM scheme.

82

CHAPTER 5 CONCLUSIONS

The thesis is devoted to the development of a multi-pulse rectifier and multilevel inverter for high-power medium voltage (MV) drives. The research can be divided into two parts: the space vector modulation scheme for the multilevel inverter and the topology of the multi pulse rectifier, both of which involve extensive theoretical analysis, computer simulation and experimental verification. For the control of multilevel inverters of high-power MV drives, the focus is set on the simplified switching sequence design of space vector modulation. To improve the performance, a flexible 3-segment SVM algorithm is proposed. The design and simulation of the proposed algorithm is introduced in detail. The main contributions are as follows: (1) The flexible 3-segment SVM algorithm can effectively reduce the actual device switching frequency by 0.5/i to 1.5/i, which accounts for a significant percentage of the switching frequency of high-power MV drives. Lower device switching frequency results in lower switching loss. The device switching frequency is reduced because extra switchings at triangle boundaries are minimized. (2) The inverter can achieve higher sampling frequency by the flexible 3-segment SVM, leading to lower WTHD. The inverter sampling frequency is increased by 50% from that of the 7-segment SVM for the same device switching frequency. This is important for highpower drives because their device switching frequency is usually several hundred Hertz and the inverter sampling frequency is close to the fundamental. Raising the inverter sampling frequency helps to depress the lower order harmonics. (3) The algorithm is easy for digital implementation because it uses rule-based switching sequence design and a `sequence reproduction mechanism . The switching sequence can be generated automatically in real time rather than using look-up-table for all the triangles.. (4) The algorithm is generally applicable to inverters of any voltage levels. Although the

83

experiment was performed for the 5-level NPC/H-bridge inverters, the flexible 3-segment SVM can be used for the other multilevel topologies. (5) The algorithm is intrinsically half-wave symmetrical and produces no even harmonics.

It can be used for PWM rectifiers where the even-order harmonics are strictly regulated by IEEE Standard 519-1992. To simplify the multi-pulse rectifier and enhance the harmonic cancellation effect, a dual 18-pulse rectifier topology is proposed for multilevel inverters. Theoretical analyses, simulations and experiments confirm the following features of the dual 18-pulse rectifier. (1) It uses simpler phase-shifting transformers (PSTs). Compared to 24-pulse or 30-pulse rectifiers for advanced high-power MV drives, the proposed rectifier uses standard 18-pulse transformers rather than more complex higher-pulse transformers. (2) It enhances harmonic cancellation. The performance is equivalent to that of the 36pulse rectifier. It also provides additional harmonic cancellation for the 5*'' and 7 * * ' harmonics caused by non-ideal transformers.

84

For the future work, it is suggested to ( 1) further study the modulation schemes which can balance the power flows of different secondary windings of the PSTs; (2 ) compare the performance of the dual 18-pulse rectifier with that of the 36-pulse rectifier.

85

APPENDIX 1. SVM computation in hexangular coordinates
1.1 Hexangular Coordinates
The hexangular coordinate system can be used to simplify the computation involved in SVM. To set up the hexangular system {goh), the lines y=0 and y=xtan60Â° in the rectangular Cartesian system (xoy) are used as the basis for plane, which is shown Fig.A-1.

O
Fig.A-1 Coordinate transformation from rectangular to hexangular system

The coordinate of the point P, (xo, yo) in rectangular form, or (ro, 9q) in polar form, can be converted into hexangular form by applying the Law of Sines in AOPA: yo go = T q sin(^o + 120 Â° ) / sin(l 20 Â° ) - Xq - ^ (A l.l)
7*0 = r o S i n ^ o / s i n ( 1 2 0 Â° ) = ^-^Â°

1.2 Computation of the Stationary Vector Plot
Now apply the transformation to the Forward Clarke Transformation of Eq.(1.4). For a given the switching state [5 q, St, the three-phase voltage are Vio=SxE where i =a, b and c,

and E is the step voltage. From Eq.(1.4), the stationary vector is: V, = |Â£ ( S ,, - 0 . 5 S , - 0 . 5 S , ) (A1.2) V y = --E
x~ y

-(S i, -

87

2 Applying Eq.(A l.l) to Eq.(A1.2) and scaling the result by - E , we have: (A1.3) [h = S ^ - S / where (g, h) is the hexangular coordinates of the stationary vector. It is interesting to note that the hexangular coordinates are in fact the normalized line-to-line voltages Vab and VbcConsider the following two situations related to stationary vectors of multilevel inverters: (1) Given the switching state, find the corresponding stationary vector. The solution is quite straightforward from Eq.(A1.3). For example given the switching state [1,-2, 1], we can quickly figure out it belongs to the stationary vector (3, -3). (2) Given the stationary vector, find all of the redundant switching states. Rewrite Eq.(A1.3) using Sa as the parameter:

C :

It is clear from Eq.(A1.4) that the solution is not unique because we have three unknowns but only the two equations. For a (2/i+l)-level inverter. Sa, Sb and Sc can be any integers from -n to n. Thus the following constraints are imposed upon Eq. (A1.4): -n<S^,S,,S^<n. (AI.5)

For any given stationary vector (g, h), we can use Eqs.(A1.4) and Eq.(AI.5) to decide the switching states. First find all the possible values for Sa. Rewrite (A1.5) into three separate inequalities and substitute Eq.(A1.4) for Sb and Sc, -n< <n , ( a I .6) <n + g + h

- n +g < S ^ < n +g - n + g +h< or

m a x (-n ,-n + g , - n + g + h ) <S^ ^m in(n,n +g , n + g + h ) .

(AI.7)

88

For any given stationary vector (g, h), we can use Eqs. (A1.4) and (A 1.7) to find all the switching states. Table A .l shows the results for the 6 sectors.

Sector I
g>0,h>0 n, rt-1, . . . , (-n+g+h) (Sa, s,,-^, Sa - g -h) (2n+l)-(g+h)

Sector II
g < Q ,h ^ ,g + h ^ (n+g), ( n+g)-l, (-n+g+h)
(Sa, Sa - g , Sa - g -11)

Sector III # < 0 , h> 0 , g + h < 0 (n+g), (n+g)-\, .... -rt
(Sa,Sa-g,Sa-g-h)

( Sa, Sh, Sc)

# o f redundancies

(2n+\)-h

( 2 n+ l ) + g

Sector IV g <0, h <0
( Sa, Sh, Sc )

Sector V
g>0,h<0,g+h<Q (n+g+h), (n+g+h)-l, -n+g
(Sa, Sa - g, Sa - g - h )

Sector VI
g > 0 , h<0, g + hei) n, n- ] , -n+g (Sa, Sa - g , Sa -g -h) ( 2 n + 1)-;?

# o f redundancies

(n+g+h), ( n+g+h)-l, ..., -n (Sa, Sa~g, Sa - g -h) ( 2 n + 1)+g+h

(2n+\)+h

If the inverter has even number of levels, for example 2n levels. Sa, Si, and Sc can be any integers from 0 to 2n, which is shifted from that of odd number of levels by n. We can analyze the case in a similar way. Now some general conclusions are;
(1) For a given switching state [5^, Sb,

the stationary vector is

the

number o f redundant switching states is ((2Â«-I)-(max(5/)-min(5,)), where i=a, b, c. E.g.: Given the state [l,-2,0] of a 5-level inverter, it belongs to the vector (l-(-2), -2-0)=(3,-2) and the number o f redundancies for this vector is 5 -(l-(- 2 ))= 2 . (2) For a given stationary vector (g, max(-- n,
-- n + g , -- n + g + h ) < S ^

h),

the switching states are [5a, Sa-g, 5a-g-/i], where
+ g , n + g + h ) .

<

min(w, n

E.g.: Given the vector (-1,-2)

of a 5 -level inverter, the switching states are [- 1, 0 , 2 ] and [-2 , - 1, 1].

1.3 Detection of NTVs
In the hexangular system, it is easy to find the nearest three vectors (NTVs) for the reference vector. As an
e x a m p le .

Fig.A-2 shows the case when the reference vector OV is

located in Sector I o f a 6-level inverter. The NTVs can be detected by first locating to which parallelogram V belongs then identifying the triangle hy which it is mscnbed.

89

In Fig.A-2 the vertex A(go, ho), which is the closest to the origin, can be determined by (go, Ao)=fix((g, h )), (A 1.8 )

where (g, h) is the coordinates of OV, and function fix(x) rounds the elements of x to the nearest integers towards zero. The other three vertices are ^(go+1, ho), C(go+l, ho+l) and D(go,
ho+l)

Fig.A-2 Identification of the nearest three vectors.

Now further decide in which triangle V is located. In hexangular system, the equation of line BD is g+h = go+ho+l. The points above or on line BD satisfy g+h > go+ho+1 while points below the line satisfy g+h < go+/io+l. Thus if g+h > go+Ao+1, V is in ABCD, otherwise it is in
AABD. In brief, the NTVs can be found in two steps:

(1) Point V is in parallelogram ABCD, whose vertices are A(go, /io)=fix((g, h )), fi(go+l,
ho), C(go+l, ho+l) and D{go, ho+l).

(2) V is in AABD, if g+h < go+ho+1. The NTVs are OA, OB and 0 0 V is in ABCD, if g+h > go+ho+1. The NTVs are 0 0 , 0 8 and 0 0

1.4 Calculation of Dwell Times
The mathematical merit of SVM to represent 01/by the NTVs. Assume at certain moment the reference vector OV is located in AABD, which is standing upright(Fig.A-3(a)). Vector 0 1 /can be expressed as a linear combination of OA, 0 8 and OO

90

OV =OA+AV=OA+mU+nv
=OA+m{OB OA)/AB+n(OD-OA) /AD =( 1-m/AB-nlAD) OA +(mlAB) OB +{n/AD) OD,

^9)

where u and v are the unit vectors along vectors A B and AD, u= A B /AB and v = AD /AD, and mil and wv are components of Al/resolved along u and v, m and n are two scalars.

|u|=lv|=l

mu

nv

|u|=|v|=l

(a) A A B D (Upright)

(b) ABCÂ£)(Up-side-dowii)

Fig.A-3 Diagram for dwell time calculation.

If we multiply both sides of Eq.(A1.9) by the sampling period

we get the so-called

`volt-second balance' equation with the coefficients being the duty cycles of corresponding vectors. In hexangular coordinate system, AB=AD~BD=l. Eq.(A1.9) can be simplified as O l^=( 1-m-n) OA +m O B +n 0 0

(A 1. 10 )

Assume the coordinate of V is (g, K), the coordinate of A is (go, W , then m= g-go, n=h-ho, which are the local coordinates of the point V in the local coordinate system DAB. The duty cycles for OA, O B and OD are:

'Dg=g-go Dp = H --Hq

( A l .l l)

Similarly, when O V is located in up-side-down ABCD (Fig.A-3(b)), the duty cycles for vectors OC, O B and O D are

91

De Dp = g o - g Db = K - h where (go, /iq) is the coordinates of C. E qs.(A l.ll) and (A l.12) are very simple compared to the formulas derived in rectangular coordinate system. Because vertices A and C are the origins of the local coordinate system, they are called the base vertices of the triangles. (Al. 12)

92

2 . Sim ulink models of SVM algorithms 2.1 Block diagrams
The Sim uhnk model is shown m Fig.A-4. The subsystem "Gate Signal' is the main part of the model. The switching sequences and dwell times are calculated in the preload function which initializes the model. The model be used for both 3-segment and 7-segment SVM schemes. However when it used for different SVM schemes, `Gate Signal' and the preload function must be changed.
u[1]-u[4] Subsystem; G ate Signal u[5]-u[8] uab data To Workspacel limited to fix(1/F1/Ts) points

u[9]-ut12]

u[13]-u[16l

Powergui 'Discrete, Ts = ?

fsw_ideal

^

fsw

U U{E) Selector

To Workspaces limited to fix(1/FirTs) points

Fig.A-4 Block diagram of the SVM controller for NPC/H-bridge inverter. (for 3-segment and 7segment) The subsystems `Gate Signal' are shown in Fig.A-5. Fig.A-5 (a) is for the 3-segment SVM. The `Time Base' subsystem is to calculate the section number (SectNo), the real time localized in each sampling period {localj) and the synchronization signal (.yync) for each sampling period. A counter is used to count the number of the sampling periods, which is used by Selectors 1 and 2 to pick up the corresponding switching sequence and dwell times. A `Time Divider' subsystem is used to divide the sampling periods into 3 segments and then drive Selector 3 to select one of the three switching states. The subsystem Sector Adjustment is used to reproduce switching sequences for Sectors II to VI. The subsystem State-to-Pulse

93

Decoder' is used to decode the switching states and generate the gating signals. Similarly the 'Gate Signal' subsystem for 7-segment SVM is shown in Fig.A-5 (b). Subsystem: Gate Signal
Selector 1
lo c a l tr m e S e c tN o

dwtTime local t Clk Up Cnt counter
Uo f
Ts

SW

m om ent

t
s e c tN o s ta t_ o u t s ta ijn  S ta te P u ls e s

T im e D iv id e r

Time Base

pulse

round selector 3 S electo rs T and SEQ are generated by initialization process T: the 1st column:t1 SEQ: columns 1-3: the first state the 2nd column: 12 columns 4-6: the 2nd state the 3rd column:t3 columns 7-9: the 3rd state the nth row lor the nth sampling point In sector 1 the nth row for the nth sampling point In sector 1 D ecoder

(a) `Gate Signals'ior 3-segment SVM Subsystem: Gate Signals
S e c tN o lo c a L t sy n c

u
Clk Up Cnt
* # 01T s ^

l o c a l ti m e d w IT I m S W _m om ent

Time Base

U(R.C) R

time divider
s e c tN o s ta l o u t s ta tin S ta te P u ls e s Â· (

max count: mf/6-

1

)

^rSEQ]--  U
U(R,C) R T and SEQ are generated by initialization process T; the 1st column;t1 the 2nd columnO tBe 3rd column:t3 the nth row Is for the nth sampling point In sector 1 SEQ: colum ns 1-3: the first stale columns 4 -6: the 2nd state columns 7-9: the 3rd state columns 10-12: the 4th state the nth row for the nth sampling point In sector 1

adjustment for sector switching

S tate-to-Pulses D ecoder

select one the 5 states

(b) `Gate Signals'ior 7-segment SVM Fig.A-5 Subsystem `Gate Signals' The subsystem Time Base is shown in Fig.A-6 , via which the real time is converted into SectNo (sector number) signal, lo c a lj (local time within each sampling period) and sync (synchronization pulses). It can be used for both SVM schemes. The subsystem Time Divider is shown in Fig.A-7, which splits the sampling period into 3 segments (Fig.A-7(a)) or 7 segments (Fig.A-7(b)) in accordance with to the dwell times. The signal SWjnoment will be used to decide the moment switching to next state of a sequence.

94

Subsystem : Time B ase
12:34 rem(u,1/Fi)
S ectN o local t

rem (u,1/Fl/m f) mCFI rem(u,2yF1/mf) mf-FI

Fig.A-6 Subsystem `Time B ase' (for 3-segment and 7-segment).

CO local time
dwlTime

Subsystem: Time Divider

OE >

(double) -- SW_momont

(a) `Time Divider'for 3-segment SVM Subsystem: Time Divider
local time
dwITime

Hu)

f(u)
(double) 8 u

- C O

3W_moment
ffu) ffu)

(b) `Time Divider' for 7-segment SVM Fig.A-7 Subsystem `Time Divider'. The subsystem `Sector Adjustm enf is shown in Fig.A-8 , which uses the `negative rotation' to generate switching states for Sectors II to VI. The subsystem can be used for both SVM schemes.

95

Subsystem : Sector Adjustment
sectNo

CT>

CE> statjn

state_in

state_out

stat_out Multiport Switch2

s t a te jn

state_out

r
I statejn Gain

 C D state_out

To rotate the switching states using `negative rotation'

Fig.A-8 Subsystem `Sector Adjustmenf (for 3-segment and /segment). The subsystem `State-to-Pulse Decoder' is shown in Fig.A-9. Two decoding schemes are swapped to balance the gating pattern. The subsystem can be used for both SVM schemes.

S u b sy ste m : S ta te to P u lse D eco d er
+ V dcS ta te

(0111
Pulses
sw ap P h a s e A: 1 to P h a s e B: 9 to 1 6 P h a s e C : 1 7 to 2 4

I I
I I

[021]
I I I I
[D ]--
I

[0121
I

I 1022]

--A

i-- O I (0 2 3 1
I
_ (D ]--

[0 1 3 1
I
-- [D ]--

I

[0 1 4 1 'V dc3-phaseS tate-to-P ulsesD eco d er
1
S ta te ! 1 011 0 Â° 0 0 F irin g p u l s e s 012 0 0 013 1 1 1 1 014 1 1 0 0 0 021 1 0 0 0 0 022 1 1 023 0 1 1 1 1 024 0 0 0 1 1 S ta te

i

[0 2 4 1

i

I I

1
! 1 1 O il 0 0

F ir in g p u l s e s 012 0 1 1 1 1 013 1 1 1 0 0 014 021 022 1 1 0 0 0 1 1 1 0 023 0 0 1 1 1 024 0 0 0 0 1

Â·2 1

-2 -1 0 1 2

1
0 0 0 0

1

0 1
2

1
1

1
0 0

1

Â° 1

I

1

1

0

1

1

Fig.A-9 Subsystem State to Pulse Decodef (for 3-segment and /segment).

96

2.2 Preload function of 3-segment SVM
% T h is p ro g ra m is used to initialize the m odel % It is fo r flex ib le 3 -seg m en t SV M % In p u t p aram eters; f 1, mf, T s, V step, V ref % O u tp u t variab les (w ill be used in the m odel) % S E Q (n ,9 ); save th e 3 states used in a sequence % T (n ,3 ); dw ell tim e for each state in the sequence % In term ed iate v ariables: % S T A T E S (5 ,3 ): save all states o f a triangle; % V E R T IC E S (n ,6 ); save N T V s % in the o rd e r A o r C then B then D % V E R T E X _ O R D E R (n ,3 ): vertex order in seq.: % T: stan d s for p o in t A or C , '2' for B, '3' for D S T A T E S = [] ;V E R T IC E S = [] ;V E X T E X _O R D E R =[] ;S E Q = [];T = []; n= m f/6; % n u m b er o f sam p lin g point each sector for k = l:n alpha= 2*pi7m f*(k-0.5); % initial angle 2 *pi/m f x = sin (p i/3 -alp h a)/sin (2 * p i/3 )* V ref; y = sin (alp h a)/sin (2 * p i/3 )* V ref; x a= flo o r(x );y a= flo o r(y ); % base vertex % % % trian g le ty p es % % % ty p e = l; if ((x + y )> (x a+ y a-HI ))& ((rem (xa+ ya,2)= = 0)) ty p e= 3 ; end if ((x + y )> (x a -ty a + 1))& (-(rem (x a-ty a,2 )= = 0 )) ty p e = 4 ;e n d if ((x + y )< (x a+ y a+ l))& (~ (rem (x a+ y a,2 )= = 0 )) ty p e = 2 ;e n d % % % d w ell tim es % % % tb = (x -x a )/F l/m f;td = (y -y a )/F l/m f; if (ty p e= = 3 )|(ty p e= = 4 ) tb = (y a + 1-y )/F 1/m f;td= (xa+ 1 -x)/F I/m f; end tac= 1/m f/F I -tb -td ; cle a r S; sw itch type % fin d all av ailab le states case 1 S (1 ,1 :3)= [ya+ xa+ 2,ya-xa+ 2,-ya-xa]/2; S (2 ,1 :3 )= S (1 ,1 :3 )-[0 ,1 ,0 ]; S (3 ,1 :3 )= S (1 ,1 :3 )-[1 ,1 ,0 ]; S (4 ,1 :3 )= S (1 ,1 :3 )-[1 ,1 ,1 ]; S (5 ,1 :3 )= S (1 ,1 :3 )-[1 ,2 ,1 ]; case 2 S ( 1,1:3 )= [y a + x a + 1, y a -x a + 1 ,-y a-x a+ 1]/2; S (2 ,1 :3 )= S (1 ,1 :3 )-[0 ,0 ,1 ]; S (3 ,1 ;3 )= S (I,1 :3 )-[0 ,1 ,1 ]; S (4 ,1 :3 )= S (1 ,1 :3 )-[1 ,1 ,1 ]; case 3 S( 1,1:3 )= [y a+ x a+ 2 , ya-xa+ 2,-ya-xa]/2; S (2,1:3)= S (1 ,1 :3 )-[0 ,1 ,0 1 ; S (3 ,l:3 )-S (l,l:3 )-[0 ,1 ,1 ] S (4 ,l:3 )= S (l,l:3 )-[ 1,1,1] S(5,1;3)=S(1,1:3)-[1,2,1] case 4 S ( 1,1:3 )=[ya+xa+3, ya- x a + 1,-y a-x a-1]/2; S(2,1:3)=S(1.1;3)-[1,0,0]; S(3, ] ;3 )-S ( l,l:3 ) - [ 1,1,0], S(4,1:3)=S(1,1:3)-[1,1,1]; end num ber_of_states=5; % if (ty p e = = 2 )|(ty p e = 4 ) num ber_of_states=4;end I the 1St state if k= = l ifV ref< = 0.59 % if V ref< = sqrt(3)/2*((rem (n,2)= = l)+ (rem (n,2)= = 0)*cot( pi/m f)) % if the point is located in triangle 1, use schem e 2 sw itch type case 1 first_state=2; case 2 first_state=4; case 3 first_state=3; case 4 first_state=4; end else % otherw ise use schem e 4 switch type case 1 first_state=3; case 2 first_state=4; case 3 first_state=3; case 4 first_state=4; end end else % search least difference state clear State_change Total_change Single_change; for kl= l:n u m b er_ o f_ states State_change(k 1,:)=abs(S(k 1,:)-S E Q (k -1,7:9)); % abs value for each phase; S E Q U E N C E (k-1,7:9) is the last state o f previous sam pling period T otaL ch an g e(k l)= su m (S tate_ ch an g e(k l,:)); % total voltage level change Single_change(k 1)=m ax(State_change(k 1,;));

97

% m axim um phase voltage level change end T otal_change=m in (T otal_change)==Total_change; % if a state has min total change, assign T Single_change=(1000Single,,change).*Total_change; % only keep those with min total changes Single_change=m ax(Single_change)==Single_chang e; S ingle_change=S i ngie_change. *( 1:number_of_states

vertex_order=[I 2 3]; case 4 vertex_order=[3 I 2]; case 5 vertex_order=[2 3 1]; end if re m (ty p e ,2 )= 0 switch first_state case 1 vertex_order=[ 1 3 case 2 vertex_order=[3 2 case 3 vertex_order=[2 3 case 4 vertex_order=[ 1 2 end end

2]; 1]; 1]; 3];

);
first_state=m ax(Single_change); % pick up the possible state with least state value as first state; end S l= S (first_ state,l :3); % pick up the first state; %% The other two states if first_state < 3 S2=S(first_state+ ],:); S3=S(first_state+2,:); else S2=S(first_state-1,:); S3=S(first_state-2,:); end set the order o f vertex usage switch first_state % for T1 and T3 case 1 vertex_order=[3 2 1]; case 2 vertex_order=[2 1 3]; case 3

SEQ(k, 1:3)=S 1 ;SEQ(k,4:6)=S2;SEQ(k,7:9)=S3; %save sequence for kk= l:3 switch vertex_order(kk) case 1 T(k,kk)=tac; % T (k ,l:3 ) saves dw ell tim es case 2 T(k,kk)=tb; case 3 T(k,kk)=td; end end end

2.3 Preload function of 7-segment SVM
% This program is used to initialize the model % Input param eters: f 1, mf, Ts, Vstep, V ref % Output variables (will be used in the model) % SEQ(n,12): save the 4 states used in a sequence % T(n,3): dwell time for each state in the sequence % Interm ediate variables: % STA TES(5,3): save all states o f a triangle; % V ERTICES(n,6): save NTVs % in the order A or C then B then D % V ERTEX _O RD ER(n,3): vertex order in seq.: % T': stands for point A or C, '2' for B, '3' for D STA TES=[] ;V ERTICES=[] ;VEXTEX_ORDER=[] ;S EQ =[];T=[]; % % % hexangular coordinates %%% n=mf/6; %number o f sam pling point each sector for k= l:n alpha=2*pi/mf*(k-0.5); % angle o f sam pling point, theta0=2*pi/mf x=sin(piy3-alpha)/sin(2*pi/3)*Vref; y=sin(alpha)/sin(2*pi/3)*Vref; xa=floor(x);ya=floor(y); % base vertex %%% triangle types %%% if ((x+y)<=( xa+y a + 1))& ((rem (xa+ya,2)==0)) type= l; vertex=[xa,ya,xa+l,ya,xa,ya+ l]; else if ((x + y )> (xa+ ya+ l))& ((rem (xa+ ya,2)= 0)) type=3;

98

v e rte x = [x a ,y a ,x a ,y a -1,x a -1,ya]; else if ((x + y )< = (x a+ y a+ l))& (~ (rem (x a+ y a, 2 )== 0 )) ty p e= 2 ; v e rte x = [x a ,y a ,x a + l ,y a,x a,y a+ l ]; else ty p e= 4 ; v e rte x = [x a ,y a ,x a ,y a -1,x a -1,ya] ; end % % % d w ell tim es % % % if (ty p e= = 3 )|(ty p e= = 4 ) tb = (y a + 1-y )/F l/m f;td = (x a + l -x )/F l/m f; else tb = (x -x a )/F l/m f;td = (y -y a )/F l/m f; end tac= 1/m f/F 1-tb -td ;

S T A T E S(4,1:3)=ST A TE S( 1,1:3 )-( l, 1,1 ]; S T A T E S (5,1:3)=STA TES( 1,1:3)-( 1,2,1]; case 4 STA TES( 1,1:3)=[ya+xa+3, l]/2; S T A T E S (2,1:3)=ST A TE S( 1,1 3 )-[ 1,0,0] S T A T E S (3,1:3)=STA TES( I , I 3 ) -[ l,1 .0 ] S T A T E S (4,1:3)=STA TES( 1 ,1 3 ) - [ l . ] . l ]
end

ya-xa+ 1,-ya-xa-

if (type==2)l(type==4) o rd e i^ [l 3 2]; % for T 2 and T4 else order=[3 2 1]; % for T1 and T3 end % save sequence S E Q (k ,l:3 )= S T A T E S (l,;); SEQ (k,4:6)=STA TES(2,:); SEQ (k,7:9)=STA TES(3,:); SEQ (k, 10 :1 2)=STA TES(4,:); for k k = l:3 sw itch order(kk) case 1 T (k,kk)=tac; % T (k ,l:3 ) saves dw ell tim es case 2 T(k,kk)=tb; case 3 T(k,kk)=td; end end V ER T lC E S(k,:)=vertex; V E R T E X _O R D E R (k,:)=order; end

sw itch ty p e % find all availab le m iddle states ca se 1 S T A T E S (1 ,1 ;3 )= {ya+xa+2,ya-xa+2,-ya-xa]/2; S T A T E S (2 ,1 ;3 )= ST A T E S(1,1:3)-[0,1,0]; S T A T E S (3 ,1 ;3 )= S T A T E S (l,];3 )-[ 1,1,0]; S T A T E S (4,1;3)= :ST A T E S(1,1:3)-[1,1,1]; S T A T E S (5,1;3)= :ST A T E S(1,1:3)-[1,2,1]; c a se 2 S T A T E S ( 1,1:3)= [ya+xa+1, ya-x a+ l,-yax a + l]/2 ; S T A T E S (2,1:3)= ,ST A T E S(1,1:3)-[0,0,1] S T A T E S (3 ,1 :3 )= ST A T E S(1,1:3)-[0,1,1] S T A T E S (4 ,1 :3 )= S T A T E S(1,1:3)-[1,1,1] c a se 3 S T A T E S ( 1,1:3) [ya+xa+ 2, ya-xa+2,-ya-xa]/2; S T A T E S (2 ,1 :3 )= S T A T E S(1,1:3)-[G ,],0]; S T A T E S (3,1:3)= ,ST A T E S (1,1:3)-[0,1,1];

2.4 Mat lab program for automatic simulation
% P ro g ram to ru n au to m atic sim ulation % th e resu lts are saved as .txt file in the current d irectory % im p o rtan t note; m ake sure th e variable nam e is not the sam e as th a t in the % in itializatio n p relo ad function clc;clear all; for m f= 1 2 :6 :2 1 6 assig n in ('b ase', 'F I', [60]); assig n in ('b ase', 'V step ', [1]); select a sim u latio n step T s ~ lu s facto r= 1 0 0 ; w hile l/F l/m f /6 0 /f a c to r < le - 6 fa c to r= fa c to r-l; i f fa c to r= = l break;
end

end T s= 1/ F 1/m f/60/factor;
k _ind ex= l ; for V ref= 0 .0 1 :0 .0 1 :3 .4 6

clear S data OUT;
sim F ix_S even_segm ent_fast_run _ver2.m dl; %the m odel saves vab data and fsw arrays to workspace; change the file nam e for 3 -seg m en t SV M % get the sw itch in g frequency n=length(fsw ); F SW (k _in d ex,1)= fsw (n ); % record the last data

% to calculate the thd (% ),w thd (% ),V lrm s

99

% The file name o f the input is data, which is generated by To-w orkspace block % For fixed step model, if the sampling time is Ts, fundamental is FI (Hz), % the num ber o f points in data should be fix (l/F l/T s), i.e. one cycle % the dc and rms value of each harmonic are stored in O U T N=length(data);N N =ceil(N /2);S=2*fft(data)/N; O U T (l)=S(l)/2;O U T (2;N N )=S(2;N N );O U T(2:N N )= abs(O U T(2:N N ).*(abs(O U T(2:N N ))>le-6))/sqrt(2); OUT=OUT* Vstep; thd=sqrt(O U T(!)''2+sum (abs(O U T(3;N N ).^2)))/O U T

save(strcat('V 5R M S_m f,num 2str(m f),'_7seg_ver2.txt

'),'V5RMS','-ascii'); save(strcat('V 7RM S_m f,num 2str(m f),'_7seg_ver2.txt '),'V7RM S','-ascii'); save(strcat('V llR M S_m f,num 2str(m f),'_7seg_ver2.t xt'),'V l l RM S','-ascii'); save(strcat('V 13RM S_m f,num 2str(m f),'_7seg_ver2.t xt'),'VI3RM S','-ascii'); save(strcat('V 17RM S_m f,num 2str(m f),'_7seg_ver2.t xt'),'V17RMS','-ascii'); save(strcat('V 19RM S_m f,num 2str(m f),'_7seg_ver2.t xt'),'VI9RM S','-ascii'); save(strcat('V 23RM S_m f,num 2str(m f),'_7seg_ver2.t xt'),'V23RMS','-ascii'); save(strcat('V 25RM S_m f,num 2str(m f),'_7seg_ver2.t xt'),'V25RMS','-ascii'); save(strcat('V 29RM S_m f,num 2str(m f),'_7seg_ver2.t xt'),'V29RMS','-ascii'); save(strcat('V31R M S_m f ,num 2str(m f),'_7seg_ver2.t xt'),'V31 RM S','-ascii'); save(strcat('V 35RM S_m f,num 2str(m f),'_7seg_ver2.t xt'),'V35RM S','-ascii'); save(strcat('V 37RM S_m f,num 2str(m f),'_7seg_ver2.t xt'),'V37RM S','-ascii'); assignin('base',strcat('FSW _m f,num 2str(m f)),FSW ); save(strcat('FSW _m f,num 2str(m f),'_7seg_ver2.txt'),' FSW ','-ascii'); end assignin('base','V ref ,[0.01:0.01:3.46]); save(strcat('V ref,'_7seg_ver2.txt'),'V ref,'-ascii'); disp('$$$$$$$$$$$$$$$$$$$$$$$$$$$$$ Finished

(2)*100;
w thd=sqrt(sum (abs(O U T(3:N N )).*2./(3;NN).*2))/OU T(2)*100; %save thd, wthd and all harmonic rms arrays TH D (k_index, 1)=thd; W TH D (k_index, 1)=wthd ; V 1RM S(k_index, 1)=OUT(2); V5RM S(k_index, 1)= 0U T (6); V 7R M S(k_index,l)=O U T (8); V llR M S (k _ n d ex ,l)= 0 U T (1 2 ) V 13RM S(k_ ndex,l)=O U T (14) V17RM S(k_ n d ex ,l)= 0 U T (1 8 ) V19RMS(k. ndex,l)=O U T (20) V23RMS(k. ndex,l)=O U T (24) V 25RM S(k_ ndex,l)=O U T (26) V29RMS(k. ndex,l)=O U T (30) V31RMS(k. ndex,l)=O U T (32) V 35RM S(k_ ndex,l)=O U T (36) V 37RM S(k_ ndex,l)=O U T (38) k_index=k_index+l ; end assignin('base',strcat('TH D _m f,num 2str(m f)),TH D ); save(strcat('T H D _m f,num 2str(m f),'_7seg_ver2.txt'),' TH D','-ascii'); assignin('base',strcat('W TH D _m f,num 2str(m f)),W T HD); save(strcat('W T H D _m f,num 2str(m f),'_7seg_ver2.txt' ),'W TH D ','-ascii'); assignin('base',strcat('V l R M S _m f ,num 2str(m f)),V lR MS); save(strcat('V 1R M S_m f,num 2str(m f),'_7seg_ver2.txt '),'V lR M SV -ascii');

$$$$$$$$$$$$$$$')

100

3. Performance comparison for various irig and f. 'sp
The simulated curves presented here are to compare the performance of the flexible 3segment and 7-segment SVM schemes for various sampling frequencies and modulation

indices ma- There are 6 scenarios for the comparison, covering ideal average switching frequency from 180Hz to 630Hz. For each scenario, the THD, W T H D , ( n o r m a l i z e d average actual switching frequency) and VxmJE (normalized fundamental voltage) versus ma or
V ref

(magnitude of reference) are compared. The topology of the inverter is 5-level NPC/H-

bridge based and the fundamental frequency /,= 60Hz. Vref -- 2 ma VS
fn/=fsp/f\

Lay out o f the curves:

THD versus Vref

WTHD versus Vref

fsw_actual VCrSUS Vref

Virms versus Vref

101

(

1) f s w j d e a p 180Hz
200
0.2
0 .4

0.6

0.8

n ig

1.0

6 5
4

0.2

0 .4

0.6

0.8
m/=36

1.0

3 - s e g m e n u m ;= 3 6

3 -s e g m e n t,

150
100

7 -s e g m e n U m /= > 2

7 -s e g m e n t, m /= 1 2

3 2
1

0

0

0 . 2 _______ 0 . 4

0 .6

0 .8

M a

l.Q

3

0.2

0 .4

0.6

0.8 nig 1 .0

3 - s e g m e n t, m j= 3 6 7 -s e g m e n t, m /= 1 2

3 - s e g m e n t, m j= 3 6 7 -s e g m e n t, m /= 1 2

J D
ref

1

0

0

1

2

(2)/jw_Wea/=270Hz
200
0.2
0 .4

0.6
-- 3 - s e g m e n t, m j= 5 4 7 -s e g m e n t, m y = 1 8

6
5 4

0.2

0 .4

0.6

0.8 7"a 1 .0

3 -s e g m e n t, m /= 5 4 7 -s e g m e n t, m /= 1 8

150

- -

& 100 H

I

3

2
1

0
ref

0

1

2

3

K

0.2

0.4

0.6

0.8 "la 1.0

0.2

0 .4

0.6

3 - s e g m e n t, in /= 5 4 3 - s e g m e n t, m /= 5 4 7 -s e g m e n t, -- -- 7 -s e g m e n t, m /= 1 8

fsw_!deal^f\

*Ã

1

ref

ref

102

(3)/jw_WeaP=360Hz
200 0.2
0 .4

0.6

0.8 Wg 1.0

0.2

0 .4

0 .6

0 .8

Â»Â»a

1 .0

150

3-segment, m/=72 7-segment, m /=24

-- - -

3 -s e g in e n t, m /- 7 2 7 -s e g m e n l, n y m 2 4

r rf

0

0 .2

0 .4

0 .6

0 .8

m,,

10

3

0.2

0 .4

0.6

0.8 W Ifl 1.0

3 - s e g m e n t, m /= 7 2 - 7 - s e g m e n t , m ^ = 2 `J

3 - s e g m e n t, m /= 7 2 7 -s e g m e n t. m /= 2 4

fswjjÃ¦atifI

1

0

0

1

2

3 V,

200

0.2

0 .4

0.6
3 - s e g m e n t, m /= 9 0

6
5

0.2

0 .4

0.6

0.8 W la 1.0

-- - - -

3 -s e g m e n t, m ;= 9 0 7 -s e g m e n t, m / = 3 0

7 -s e g m e n l, m /= 3 0 150

4
3

2
1 0

0

1

2

3 V rrf
0.8 rtig 1.0

0 .2

0 .4

0 .6

0 .8

1 .0

0.2

0 .4

0.6

10
3 -s e g m e n t, m y= 90 7 - s e g m e n t , m ^ = 3 < (-, fs u r J iU a tlf I 3 - s e g m e n t, /n /= 9 0 7 -s e g m e n t, m / = 3 0

h I

Ã JI m

103

(5)/.M-_Wea/=540Hz
200
0.2

0.4

0.6

0.8

1.0

0.2

0.4

0.6

0.8 W g 1,0

3 - s e g m e n t, m /= 1 0 8

3 -s e g m e n t, m /= 1 0 8 7 -s e g m e n t, m /= 3 6

150

7 -s e g m e n t, m / = 3 6

i

I
rff
0 .2 0 .4 0 .6 0 .8 fM g 1 .0

0.2

0 .4

0.6

0.8

1.0

--------- 3 - s e g m e n t , --------- 7 - s e g m e n t , ......

m/=IOS ij 1 1

3 - s e g m e n t, m /= 1 0 8 7 -s e g m e n t, m /= 3 6

m /= 3 J

fm JÃ©taJf1

W2

1 1 0

II
(6 ) z
200
150

1

lin n
3 V, ref

0.2

0 .4

0.6

0.8 "Ifl 1.0

6
5 4

0.2

0 .4 -- --

0.6

0.8 rrig 1.0

3 -s e g m e n t, m /= l 2 6 7 -s e g m e n t, m /= 4 2

3 - s e g m e n t, m /= 1 2 6 7 -s e g m e n t, m /= 4 2

I 100
g

s2
1 0 0
0.2
0 .4

3

1 0.2
-- - 0 .4

2 0.6

0.6

0.8 lÂ»a 1 .0

3

3 - s e g m e n t, m /= 1 2 6 7 -s e g m e n t,

3 - s e g m e n t, m /= 1 2 6 7 -s e g m e n t, m /= 4 2

0

-- --

fs w jd e a llfl

2 1 00

1
ref

1

2

3 V,

104

4. Spectra comparison
These waveforms appended here are to compare the spectra of the output line-to-iine voltages of the two SVM algorithms. Both simulated and experimental waveforms are included comparatively. Comparisons are done for 11 different ideal average device switching frequencies: /swjdeai= 180Hz, 270Hz, 360Hz, ..., 1080Hz. The modulation index is fixed at ma=0.867 or Vr^=3.0 and the fundamental frequency/i=60Hz. Eight spectra are included for each scenario and are arranged according to the following layout diagram:

Simulated spectrum (0~12.5A:Hz) 3-segment SVM

Simulated and zoomed spectrum(0~5j5:Hz) 3-segment SVM

Simulated spectmm(0~12.5fcHz) 7-segment SVM

Simulated and zoomed spectrum(0~5/:Hz) 7-segment SVM

Experimental waveform and spectrum (0~12.5m z) 3-segment SVM

Experimental waveform and zoomed spectrum (0~5feHz) 3-segment SVM

Experimental waveform and spectrum (0~12.5m z) 7-segment SVM

Experimental waveform and zoomed spectrum(0~5^Hz) 7-segment SVM

105

9

Experiment, 7*segment
-

Experiment, 3-segment
'I f 4 d -

% of Fundamental o

% of F u n d am en tal

----L

^
Ã¯ Ã¯ - i

I
9
e

I , 1 1 1 1 I 1 ,

:
:

i'i
<
Â·

:

E

1

; ÃÃ J
..... 1rr,. 1., ...J.U .,,
% Of F u n d am en tal

g
Experiment, 7-segment Experiment, 3-segment
o

% of Fundamental

cn

o

O

C J l

O

<

% of Fundamental

% of Fundamental o

Experiment, 7-segment

5 r)
; o

Experiment, 3-segment

o

ro

A

O )

C O

:<

0

-n Â§
= --= = ---

X

0Â»
Â§ c % Ã

I
5:
N0 0
% of Fundamental

to

1

~ Â§ X =n_

mX

III
I

|8
ig X --

71
1

w

0

a
Experiment, 7-segment
! 8

% of Fundamental

Experiment, 3-segment

M

0>

OD

O

o

N

^

m O D

t 1 ^ :
t Ã~' V I to

Ã ^ 1



 

r -- --
--

.
ÃS S  <
L Â« .,b ii L k ,

i 8

...

. ,. .

Ã¯=* . ,

1

% of Fundamental

% of Fundamental

Experiment, 7*segment

Experiment, 3-segment

o

ro

^

O)

N CD

g
Experiment, 7-segment Experiment, 3-segment

% of Fundamental

M

4 ! k .

o >
c/)

% of Fundamental
O N> -U O )

I

I
<
T1

Â§

CO

IÂ° I
X
o

r
O )

I II

8<

I

I I w % Y

CD

(4) ,,^w _(d/ea/-- 450Hz
Fundamental (60Hz) = 3.465 , THD= 15.37%

Fundamental (60Hz) = 3.465, THD= 12.69%

Simulation, 3-segm ent

Simulation, 3-segment

0

2000

4000 6000 8000 Frequency (Hz)

10000

12000

1.1...1.I...I.I...I
0 1000 2000 3000 Frequency (Hz) 4000 5000

8

Fundamental (60Hz) = 3.446 , THD= 16.81%

Fundamental (60Hz) = 3.446 , THD= 13.89%

Simulation, 7-segment

Simulation, 7-segment

4

O sS
0
T e k P re V u

2000

4000 6000 8000 Frequency (Hz)

10000

12000
T ek P re V u

1000

2000 3000 Frequency (Hz)

4000

5000

O )

I
Q > E g a. ui

\

lO O V /d iv 2 m s /d iv lO O V W i v 2 m s /d i V

V ,,, ..= 1 0 0 V > ' ! 2 V /d iv 1 .2 5 A H z /d iv

-j-i-t-H2 V /d iv

- I 4I I f
S O O H z /d iv

M |2 0 . O l t i s  c :> tO P 1

A| C h1

y

2 6 .0 V

M |2 0 . l ) m s

A| C h i

y

2 6 .0 V

1 --------------- -----------:

o > E s o > E "C

- v ,, j, \ [ p IJ V LTT

J J T

tr u L .., lO O V /d iv 2 tT K /d iv %

:

lOOV/div 2 m s/div
1 1

V,,,.=100V
2 V /d lv L . 1 .2 5 * H z /d lv :

2V/dlv 500Hz/dlv

I
AÃ..I
1 .1  .....................  . . 1 Â«  1 Â« 

jyiua

ulLi*Iiw Ã
MjZ^Sttif A ( O il I -62.0 V

109

(5 ) ,^M>_(yea/=540Hz
Fundamental (60Hz) = 3.464, THD= 15.14%
7

Fundamental (60Hz) = 3.464, THD= 11.60%

6
5

Simulation, 3-segment

Simulation, 3-segment

I
*5

4 3

2 1 0

0

2000

4000 6000 8000 Frequency (Hz)

10000

12000

0

I.U.I J 1000 2000 3000 Frequency (Hz)

4000

5000

Fundamental (60Hz) = 3.449 , THD= 15.80% 7

Fundamental (60Hz) = 3.449 , THD= 13.36% 7

6

Simulation, 7-segment

6

I4 I 3 o
5 ?2 1 0

1=

#5 iZ 3 o S S2
Ã lJL Ã¼ iL lL
0 2000
I

Simulation, 7 segment

Ii

1
4000 6000 8000 Frequency (Hz)
[

1 1

10000

12000

0

dJU L
0 1000

li.lllilllm llliitllilirlilll

2000 3000 Frequency (Hz)

4000

5000

T e k S to p

0>
lO O V /d iv

n1 1

Vab

1
Ã lO O V /d iv 2 m s /d iv : ^ n jll 2 V /d iv 5 0 0 H z /d iv :

2 m s /d iv

i
Â§ E -c S K.
v , ,, ; ^ i Ã¦ v T M [ T r

Mniu=lOOV
2 V /d iv l.2 5 /:H z /d iv

0
M 2u.oms
A| C h l y 2 6 .0 V T e lc S to p

liJ
M |2 0 . 0 m s A| C h i y 2 6 .0 V

lO O V /d iv lO O V / d i v 2 m s /d iv 2 m s /d iv

V ,TM = IO O V

V ,TM .= 1 0 0 V

g iÃ¼U

2 V /d iv 1 .2 5 A :H z /d iv

2 V /d iv 5 0 0 H z /d iv

*U jJi,
f

Mpo.oms A| chi

-68.0 V

M |2 0 .0 m sA |C hi y - 6 8 .0V

110

>of Fundamental

% of Fundamental
O M W y

Experiment, 7-segment

s

Experiment, 3-segment

Ã

:: <

o\ L Ã

S
m2 N )<

M<

% of Fundamental

% of Fundamental

Experiment, 7-segment

Experiment, 3-segment

ro

w

g< E< : =

o

^ Ã8 o w
X.

I

S<

% of Fundamental

% of Fundamental

Experiment, 7-segment

Experiment, 3-segment

cn

n

a m hJ
o
C

< y >

Oi

S 8 <3 o
I CD N O

CA

cn O )

CO

N<

o o cn

I
SÃ
Experiment, 7-segment Experiment, 3-segment
o o
% of F u n d am en tal
CO

(n

% of Fundam ental ro ^ o)

8

w

Ã

1
r ta I
8< 0Â» 2

I' p g

% of Fundamental

Experiment, 7-segment

Experiment, 3-segment

oi

% of Fundamental

C J l

00

Q.

a
00

:: <
o
-Q

Â« <O
CO

(O
o ro ro o

% of Fundamental

% of Fundamental
o)
o ` r o c o A o i o > N

Experiment, 7-segment

Experiment, 3-segment

ro

C O

A

UI

8<

% of Fundamental

% of Fundamental

Experiment, 7-segment ^

C Jl

Experiment, 3-segment

C J 1

o

I
<
(A

ro
o

f t

(fi ^ o > c o T 3

o > o >

o

5S I (Ã

I
X
<

Â§
8
% of F u n d am en tal

o

ro

% of Fundam ental
ro 03 ^ tn o> vj

Experiment, 7-segment

O

-Â» Â·

ro

03

4^

C Jl

o

C O

Â§
. '

1

!
8
II

2 8 c o

I P
8

:

^

1
Â»

;

I

%O f Fundamental

% of Fundamental
0) Â·vj

Experiment, 7*segment

Experiment, 3-segment

ro

CÃ

4:^

Ã1

iM

oj

A

ui

oe

-'I

s

:i <

15
Â·ti
ll

ll II

I
a: <

If
% of Fundamental % of Fundamental

?

I

Experiment, 7-segment

Experiment, 3-segment

^

tn

I
-1< 2M
CO CO

cn

CÃ CO

|i
OI OI

to

(11) fswjdear1080Hz
8 8

Fundamental (60Hz) = 3.465 , THD= 0.57%

Simulation, 7-segment

Simulation, 3-segment
5 6 

? 4 u.
55

1

-

2

................... ...
2000

.1.1,.1

1 IijI

.. 1. I,.II

I Ili jl
12000

4000 6000 8000 Frequency (Hz)

10000

0

Frequency (Hz) Fundamental (60Hz) = 3.455 , THD= 4.39%

Fundamental (60Hz) = 3.455 , THD= 13.12%

Simulation, 7-segment

Simulation, 7-segment

g 6
0

 5

sS o .hill
2000

Ilk

jk ilJllluiJliMl
10000 12000
0 1000 2000 3000 Frequency (Hz)

4000 6000 8000 Frequency (Hz)

4000

5000

H L m
1 T lO O V /d iv 2 m .s /d iv ^

at

E V
c*>

\ 4l -

Ãª

"v j f

lO O V /d iv : 2 m s /d iv

^

1

J.

' 2 V /d iv l.2 5 tH z /d iv 

.-jH H - t + H ----H -M -I-+ T + -I-W

....................... :

2 V /d iv   5 0 0 H z /d iv :

,
T e le S t o p I (

,

.

!

.
M lSO .O m s

,
A| C h i

.
f

!
N 1 2 0 .0 m s A| C h i
J-

2 0 .0 V

2 0 .0 V

Te

01

at
lO O V /d iv

:

Vtib,

-

it

?
Vin^lOOV

2 n is /d iv

\ E o> % E "C sm
at

l

^ J lr
III lO O V /d iv 2 m s /d iv

v iTM ,= io o v

I

2 V /d iv

1

2 V /d iv S O O H z /d iv

:

t.25A H z/div 1

lij[ llÃ¼llJjLiÃ¼Ã¼iik^
M lzo .o m s A Ch I V - 7 2 .0 V

' ..I  1..I.L .., ,  1 , , i . i . . , ! . . , , 1 .

M |2 0 .0 m s

Aj C h i V - 9 0 . 0 V

116

REFERENCE
[1] B. Wu, High Power Converters and AC Drives, IEEE Press & John Wiley, October 2005, ISBN: 0-4717-3171-4. [2] B. Wu, Y. Li and S. Wei, Multipulse diode rectifiers for high-power multilevel inverter fed drives, 9th IEEE International Power Electronics Congress 2004, pp. 9-14. [3] G. L. Skibinski, N. Guskov and Dong Zhou, Cost effective multi-pulse transformer solutions for harmonie mitigation in AC drives, Industry Applications Conference, 2003. 38th LAS Annual Meeting, Vol. 3, pp. 1488 - 1497. [4] J. Rodriguez, J. Pontt, C. Silva, et al.. Large current rectifiers: State of the art and future trends, IEEE Trans. Ind. Applicat., 52(3), 2005 pp.738-746. [5] P. W. Hammond, A new approach to enhance power quality for medium voltage AC drives, IEEE Trans. Ind. Applicat., 33(1), 1997 pp.202-208. [6] Dura-Bilt5i MY Medium Voltage AC Drive Topology, Toshiba-GE Technical Document, 2003.4 [7] Perfect Harmony Medium Voltage AC Drives, Robicon Technical Document, 2003 [8] IEEE Industry Applications Society/Power Engineering Society, Chapter 10 in IEEE recommended practices and requirements for harmonic control in electrical power systems, IEEE Std.519-1992 [9] J. Rodriguez, J.-S. Lai, and F. Z. Peng, Multilevel inverters : a survey of topologies, controls and applications, IEEE Trans. Ind. Applicat., 49(4), 2002 pp724-738 [10] J. R. Espinoza, Chapter 14 in Power Electronics Handbook, ed. by M. H. Rashid, Academic Press, New York, 2001 [11]J. S. Lai and F. Z. Peng, Multilevel converters- a new bread of power converters, IEEE Trans. Ind. Applicat., Vol.32, 1996 pp.509-517 [12]R. H. Baker, High-voltage converter circuit, US Patent No. 4,203,151, May 1980

117

[13] z. Cheng and B. Wu, Dual 18-pulse rectifier for high-power multilevel inverters, the 31* Annual Conference of the IEEE Industrial Electronics Society, Nov. 2005 [14] A. Nabae, I. Takahashi and H. Akagi, A new neutral-point clamped PWM inverter, Proceedings of the LAS Conference, 1980, pp761-766 [15]T. A. Meynard, H. Foch, Multilevel conversion; high voltage choppers and voltagesource inverters. Proceedings of the IEEE Power Electronics Specialist Conference, 1992 pp397-403 [16]C. Rech, H. A. Grundling, H. L. Hey, H. Pinheiro, J. R. Pinheiro, A generalized design methodology for hybrid multilevel inverters, IEEE 2002 28^ Annual Conf. of the Industrial Electronics Society, Vol. 1, Nov.2002, pp..834-839 [17]B. Lin and D. Chen, Development of single-phase five-level PWM rectifier for integrated power quality compensation based on sliding mode control. Int. J. Electronics, 89(5), 2002 pp.381-401 [18]K. A. Corzine, F A. Hardrich and Y. Familiant, A cascaded multilevel H-bridge inverter utilizing capacitor voltages sources, proceedings of the LASTAD Power Electronics Technology and Applications Conf., Feb 2003 [19]C. M. Wu, W. H. Lau and H. Chung, A five-level neutral-point-clamped H-bridge PWM inverter with superior harmonic suppression: a theoretical analysis, in Proceedings of the 1999 IEEE international Symposium on ISCAS, Vol.5, 1999 pp.V-198-V-20I [20] J. P. Lyons, V. Vlatkovic, P. M. Espelange, A. A. M. Esser and F. F. Want, Five-level high power motor drive converter and control system, US patent number 06, 058, 031, assigned to General Electric Company may 2000 [21] W.A. Hill and C.D. Harbourt, `Performance of Medium Voltage Multilevel Inverters,' IEEE LAS Annual Meeting, Vol.2 , ppl 186-1192, 1999 [22] K. Zhou and D. Wang, Relationship between space-vector modulation and three-phase carries-based PWM: a comprehensive analysis, IEEE Trans, on Industrial Electronics,

118

49(1), 2002 ppl86-196 [23] A. Kwasinski, T. Rrein and P. L. Chapman, Time domain comparison of pulse-widthmodulation schemes, IEEE Power Electronics Letters, 1(3), 2003 pp.64-68 [24] D. G. Holmes and T. A. Lipo, Pulse width modulation for power electronics, IEEE Press, W ile-Interscience, 2003 [25] N. Celanovic D. Boroyevich, A fast space-vector modulation algorithm for multilevel three-phase converters, IEEE Trans, on Industry Applications, 37(2), 2001 pp.637-641 [26] Sanmin Wei, Bin Wu and Qianghua Wang, An improved space vector PWM control algorithm for multilevel inverters. Proceedings of the 4'*' International Power Electronics and Motion Control Conference (IPEMC 2004), Vol.4, 2004 pp. 1124-1129 [27]B. P. McGrath, D.G. Holmes and T. A. Lipo, Optimized space vector switching sequences for multilevel inverters, IEEE Trans, on Power Electronics, 18(6) 2003 pp. 1293-1301 [28] Z. Cheng and B. Wu, Space vector modulation with flexible three-segment switching sequence for five-level inverters, the S'*' International Conference on Electrical Machines and Systems, Sept. 2005 [29] D S1103 PPC Control Board: Installation and Configuration, dSpace technique document, August 2003

119

