N O V E L CYLINDRICAL7SPHERICAL SCANNER CONFIG URATIO N FOR REVERSE ENGINEERING

by

Med hat Samaan B Sc. Electrical Engineering, Ain Shams University, Cairo, Egypt, 1980

A thesis Presented to the Department of Mechanical Engineering In partial fulfillment of the requirements for the degree of Master of Applied Science

DEC 1 3 2004

Ryerson University Toronto, Ontario, Canada, 2004 PROPERTY OF

ffiisonUnlvetsilY>jl>W

Copyright © Medhat Samaan, 2004

UMI Number: EC52975

All rights reserved
IN FO R M A TIO N TO USERS

The quality of this reproduction Is dependent upon the quality of the copy submitted. Broken or indistinct print, colored or poor quality illustrations and photographs, print bleed-through, substandard margins, and improper alignment can adversely affect reproduction. In the unlikely event that the author did not send a complete manuscript and there are missing pages, these will be noted. Also, if unauthorized copyright material had to be removed, a note will indicate the deletion.

UMI

_ _

®

UMI Microform EC 52975 Copyright 2008 by ProQuest LLC All rights reserved. This microform edition Is protected against unauthorized copying under Title 17, United States Code.

ProQuest LLC 789 East Eisenhower Parkway P.O. Box 1346 Ann Arbor, Ml 48106-1346

Author's Declaration

I hereby declare that I am the sole author of this thesis. I authorize Ryerson University to lend this thesis to other institutions or individuals/for the purpose of scholarly research.

M ^ h a t^am aan

I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in totai or in part, at the request of other institutions or individuals for the purpose of scholarly research.

j y i é d ^ t Samaan

1 1

PROPERTY OF

Ryerson University Library

Borrower's Page

Ryerson University requires the signatures of ail persons using or photocopying this thesis. Please sign below, and give address and date.

N am e

Signature

Address

Date

Ill

Abstract

Novel Cyiindrioal/Spherioa! Scanner Configuration for Reverse Engineering

© Medhat Samaan, 2004

Master of Applied Science Department of Mechanical and Industrial Engineering Ryerson University

Laser scanners are often used in geometric reverse engineering to generate a CAD drawing out of an existing physical part. This often requires careful path planning to ensure the correct stand-off distance of the sensor, to prevent any collisions of the sensor with the target object and to prevent any scan occlusions in the resulting data.

A

dedicated

system

was

constructed

to

collect

data

using

a

3-axis

cylindrical/spherical device. The benefit of this scanning system is the ability to scan completely around the target object, including the bottom of the object. A stripe-type laser diode is used along with a C C D camera. The target object sits

IV

on a transparent plexiglass table, which can be rotated 360°. Both the laser and the C C D are mounted on an arm, such that they can be traversed along a linear path, as well as being rotated 360° around the table. This permits the device to scan in either spherical or cylindrical paths with 360° rotation around the target object. This system allows for the quick scanning of any object while minimizing the number of occlusions in the resulting scan data.

pr o per ty o f

Ryerson University library

Acknowledgements

I am especially grateful to my supervisor Dr. Vincent H. Chan of the Department of Mechanical Engineering for his knowledgeable advice, support, and encouragement during the course of this research. This work would not have been possible without his help. I'd also like to thank Deven Ostrom, Technical Officer, of the Department of Mechanical Engineer for his assistance. Last but not least I'd like to express my appreciation to all Ryerson faculty and staff for the knowledge I gained as well as the friendly atmosphere I enjoyed during the period of my study.

VI

PROPERTY OF
jL'y Table of Contents Author's Declaration ................................................................................................ jj Borrower's Page ....................................................................................................... . Abstract ........................................................................................................................ Acknowledgements ..................................................................................................vi Table of Contents --- .............................................................................................. vli List of Figures .............................................................................. ............................. vlii List of Tables ........................... -................................................................................. x List of Equations ....................................................................................................... .. Chapter 1 Introduction ........................................................................................ 1 1.1 Literature Review ........................................................................................ 4 1.2 Proposed New Scanner ............................................................................. 21 Chapter 2 Construction of the Proposed Scanner ....................................... 23 2.1 Control of the Scanner ............................................... -............................... 26 2 .2 Scanning Sensor ......................................................................................... 28 2 .3 Conversion of Pixel Values to XYZ Coordinates .................................. 32 2 .4 Transformation for the Rotary Table and Arm ...................................... 35 2.5 C all Interface Node (CIN) .......................................................................... 37 2 .6 D XF Format ..................................................................................................40 2 .7 M aster Algorithm .................................................-........................................ 42 C hapter 3 Preliminary Result of the Prototype ..............................................45 3.1 Laser Alignment and Separation ...............................................................46 3.2 Motor Control ................................................................................................. 47 3.3 C IN Node ....................................................................................................... 48 3 .4 Im age Processing ........................................................................................ 49 3.5 Full Scan Results ........................................................................................ 54 3.5.1 Cylindrical Scan ............................................................................... 54 3 .5 .2 Spherical Scan ............................................................. 63 3.6 Calibration .....................................................................................................65 3.7 Comparison with Other Machines ........................................................... 66 Chapter 4 Conclusions and Future Work ....................................................... 67

References ................................................................................................................. 69 Appendix Appendix Appendix Appendix Appendix Appendix A B C D E F Build the CIN Node ......................................................................... 71 C Program for the CIN Node (Cylindrical) ---------------------------- 72 Full LabVIEW Program for Cylindrical Scan -------------------------75 C Program for the CIN Node (Spherical) ----------------------------- 84 Full LabVIEW Program for Spherical Scan -------------------------- 86 Technology Comparison Chart -------------------------------------------- 94

vu

List of Figures

Fig 1.1 Fig 1.2 Fig 1.3 Fig 1.4 Fig 1.5 Fig.,1.6 Fig 1.7 Fig 1.8 Fig 1.9 Fig 1.10 Fig 1.11 Fig 1.12 Fig 1.13 Fig 1.14 Fig 1.15 Fig 1.16 Fig 1.17 Fig 1.18 Fig 1.19

CCD directed scanning [1] --------------------------------------------------- 6 Laser light stripe projection [3] -...................................................7 Adjustable light displacement system [4] ------------------------------ 8 Raster Scanning device [5] -------------------------------------------------- 9 Mirror synchronized scanner [6] ------------------------------------------ 10 Orthogonal laser scanner [8] ........................................................ 11 CMM mounted structured light measuring system [9] ----------- 12 Detail of camera orientation [9] - ...................................................12 Fixed camera/rotary table machine vision system [13]------------14 Stereo laser line reconstruction [14] --------------------------------- -- 15 Linear and rotary laser scanner [15] ------------------------------------- 16 Top view, turn-table laser scanner [16] ---------------------------------17 Side view, turn-table laser scanner [16] -------------------------------17 Rotary scanner, showing voids [17] ............................................. 18 Rotary scanner showing (a) first view (b) overlap [17] -----------18 Three Cartesian axis scanner [18] ---------------------------------- -- -1 9 Rotary scanner [18] ......................................................................... 20 Robotic arm scanner [18] ............................................................... 20 Proposed scanner for orthogonal, cylindrical and spherical motions ............................................................................. 22 AutoCAD drawing of the prototype ---------------------------------------24 A photo of the constructed scanner --------------------------------------25 PC interfacing with the scanner components ------------------------26 Motor control box ............................................................................. 26 Motor drive LabVIEW program (front panel) .............................. 27 Motor drive LabVIEW program (block diagram) ........................27 Image capture LabVIEW program (front panel) -------------------- 29 Image capture LabVIEW program (block diagram) ---------------29 Focus adjustment using graph paper ----------------------------------- 30 Adjustment of laser line illumination and alignment -------------- 31 Camera/laser sled -- ..................................................................... 32 Laser camera and object triangle -----------------------------------------33 (.c) file generated by C IN node for cylindrical scan ---------------38 (.c) file generated by CIN node for spherical scan ---------------- 39 Beginning of DXF file format ------------------------------------------------ 40

Fig Fig Fig Fig Fig Fig Fig Fig Fig Fig Fig Fig Fig Fig Fig

2.1 2.2 2.3 2.4 2.5 2.6 2.7 2.8 2.9 2.10 2.13 2.14 2.15 2.16 2.17

V lll

Fig Fig Fig Fig Fig Fig Fig

2 .1 8 2 .1 9 2 .2 0 2.21 2 .2 2 2 .2 3 2 .2 4

C code to generate the beginning of DXF file ------------------------41 Format for displaying a point by DXF file .....................................41 C code to generate a point by the DXF file ................................. 41 End of DXF file format ......................................................................41 C code to generate the end of DXF file ........................................41 Cylindrical scan algorithm flowchart ............................................. 43 Spherical scan algorithm flowchart ............................................... 44 Object with quadric and free form surfaces .................................46 Reflection caused by shiny gage block ........................... 49 G age scan with background reflection from the rotary table -5 0 Gage scan and reflection caused by the rotary table ............... 51 Object scan and reflection caused by the rotary table ............. 51 1-2-3-gage block scan with room light reflection ........................51 Cast object scan with room light reflection .................................. 52 Bottom scan with very low illumination ........................................52 Bottom scan with high illumination ............................................... 53 Skew scan due to unsupported rotary table ................................53 Side scan, before applying the transformation matrix .............. 53 The machine adjusted for the top scan ........................................54 55 Top scan of a 1 -2-3-gage block, where Z = 1 .............. Top scan of a 1-2 -3-gage block, where Z = 3 .............................55 Top scan while the rotary table moves 90° ................................. 55 Top scan while the rotary table moves 180° ............................... 56 Top scan while the rotary table moves 270° ............................... 56 Top scan for cast object with quadric and free form surfaces 56 The machine adjusted for the side scan ......................................57 Side scan for 1 -2-3-gage block while the rotary table at 0° - 58 Side scan for 1-2-3-gage block while the rotary table at 90° 58 Side scan for 1-2-3-gage block while the rotary table at 180° 59 Side scan for 1-2-3-gage block while the rotary table at 270° 59 Side scan for cast object while the rotary table at 0° - .............59 Side scan for cast object while the rotary table at 90° ............. 60 Side scan for cast object while therotary table at 180° --------- 60 Side scan for cast object while therotary table at 270° ---------60 The machine adjusted for the bottom scan .................................61 Bottom scan for 1 -2-3-gage block ................................................ 62 Bottom scan for cast object ........................................................... 62 Spherical scan for 1-2-3-gage block while the arm at 30° -- 63 Spherical scan for 1 -2-3-gage block while the arm at 60° -- 63 Spherical scan for 1-2-3-gage block while the arm at 90° -- 64 Spherical scan for cast object while the arm at 60° ................. 64 Spherical scan for cast object while the arm at 90° -------------- 64

Fig 3.1 Fig 3.2 Fig 3.3 Fig 3.4 Fig 3.5 Fig 3.6 Fig 3 .7 Fig 3 .8 Fig 3 .9 Fig 3 .1 0 Fig 3.11 Fig 3 .1 2 Fig 3 .1 3 Fig 3 .1 4 Fig 3 .1 5 Fig 3 .1 6 Fig 3 .1 7 Fig 3 .1 8 Fig 3 .1 9 Fig 3 .2 0 Fig 3.21 Fig 3 .2 2 Fig 3 .2 3 Fig 3 .2 4 Fig 3 .2 5 Fig 3 .2 6 Fig 3 .2 7 Fig 3 .2 8 Fig 3 .2 9 Fig 3 .3 0 Fig 3.31 Fig 3 .3 2 Fig 3 .3 3 Fig 3 .3 4 Fig 3.3 5

IX

List of Tables

Table 2.1 Mechanical Components of Scanner

24

List of Equations

Equat on Equat on Equat on Equat on Equat on Equat on Equat on Equat on Equat on Equat on Equat on Equat on Equat on Equat on Equat on Equat on Equat on Equat on Equat on Equat on Equat on

1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21

Center of gravity calculation ------------------------------------------------31 Conversion of pixel value to Y coordinate ----------------------------32 X / Z relation -----------------------------------------------------------------------33 Calculation for Z coordinate .................. 33 Calculation for offset in X coordinate -------------------------------33 Resolution in Z direction ................................................................. 33 Resolution in X offset ...................................................................... 33 X-coordinate .....................................................................................34 Y-coordinate .....................................................................................34 Z-coordinate ..................................................................................... 34 Rotation around Z axis transformation matrix... ......................... 35 Rotation around X axis transformation matrix ......................... 35 Total transformation matrix ...........................................................35 X coordinate with respect to the machine reference frame -- 36 Y coordinate with respect to the machine reference frame -- 36 Z coordinate with respect to the machine reference frame -- 36 Rotation angle around X axis ------------------------------------------ 36 Rotation angle around Z axis ------------------------------------------ 36 Number of rows in an array format for CIN node ----------------- 37 Number of columns in an array format for CIN node ------------- 37 Value of element in an array format for CIN node ----------------37

Chapter 1

Introduction

Reverse engineering is the process of generating CAD models out of an existing physical part. The need for CAD models, taken from existing complex sculptured surfaces, is initiated because:

1 - The design of a product starts with a clay model or other hand carved model. 2- CAD models are not available for many parts that were manufactured in the past. 3- The part has been modified from the original design to fit its position or to change its look.

To modify or reproduce such parts in a computer integrated manufacturing (CIM ) environment, CAD models should be created. CAD models are created based on measured data from the part's surfaces. Reverse Engineering is used in industrial environments such as the manufacturing of car bodies, ship hulls, airplane fuselages and wings, propellers, shoe insoles, bottles, and so forth. The CAD models for these parts are often created based on digitized data captured from a physical prototype.

A fully automated reverse engineering process is still under research. Currently, the co-ordinate measuring machine (CMM) is manually used to guide a digitizing sensor to collect surface data points. This slow process, which might take hours to days, requires expensive equipment and well-trained professionals.

Due to the growing number of legacy parts, for which no CAD models exist, there is a growing interest in the representation of the surface geometry and topology of physical objects. Even the most trivial object requires multiple range images to be taken from different vantage points and integrated to form a complete model.

There are two main challenges to develop a fully automated reverse engineering system; the digitization of the scanned object image, and the conversion of the 3D scanned data into a compact form, compatible with CAD/CAM packages.

This

thesis will deal with the digitization of a

physical object.

Machine

configurations and conversion of 2D data into 3D are the two areas that have been developed in this work. To this end, a novel laser scanner configuration for reverse engineering has been developed. The scanner is able to:

1. Automate the reverse engineering system in terms of path planning 2. Scan with access from multiple viewpoints 3. Reduce scan occlusions 4. Scan the bottom of the part

1.1 Literature Review

Scanning

plays an

important role in reverse engineering

since

complex

specifications have to be met for a greater number of products. Contact and noncontact methods are the two categories for scanning operations. The hardware used in sampling the point data from a part surface determines which category of scanning operations Is used.

The most popular contact device is the CMM. These are numerical control (NC) driven and can be efficiently programmed to collect point samples for predefined features. CMMs have also brought a significant increase of productivity in performing scanning operations. They are accurate and efficient for checking dimensions and tolerances of a well-defined part but show difficulty in measuring parts with free-form surfaces. CMMs are inherently slow in acquiring point data since they need to make physical contact with a part surface for every point that Is sampled. Moreover, CMMs can deform the part surface If the part is made of soft material. In industry, there is a great need to have high quality scan of parts with complicated and free-form surfaces. It Is difficult and very time consuming to satisfy this need using traditional contact measuring devices.

The number of products with free-form surfaces is increasing. These are usually expensive parts and any occurrence of defects on the surface can cause costly errors in the final products or in the performance of the entire machine system. In order to perform a complete scan on parts with free-form surfaces, a scanning device needs to be able to quickly obtain a large amount of point data from the part surface.

In recent years, the accuracy of non-contact-type methods, compared to CMM, has been greatly improved and can provide a viable solution for this purpose. In non-contact devices the accessibility of scanned data is controlled by the boundaries of related surfaces with respect to the probe orientation.

Researchers have been working on machine configuration as it plays an important role in the digitization of the scanned object image. Contemporary research is moving towards the direction of line laser scanning using two methods of data collection. The first method employs a single camera while the second, known as stéréovision, uses two cameras.

Chan, Bradley and Vickers [1] used a procedure where two scans were employed using a charge-coupled device (CCD) camera and C M M touch probe as shown in Fig 1.1. A CCD camera determines the location of the part on a C M M bed and recognizes the object's surface. The CCD scan is then used to determine the path for the second scan using a CMM touch probe or a laser scanner. The output of the second scan is then converted to CAD/CAM data using artificial neural networks.

SGI Workstation

CCD CaraeraTouch Probe

nz;
a
o

~r
ir

a

CMM Controller 386 Computer

IF

ur
Data Links

Ccwrdinatc Measuring Machine

Fig 1.1 CCD directed scanning [1]

In another work, Takeuchi, Shimizu and Mukai [2] set a TV camera over a C M M to take an image of the work area. A PC performs additional processing such as matching image data and path generation. The CMM is then directed to begin the measuring operation. Measured data from the touch probe of the CM M are sent back to the computer to evaluate the measurements.

Ozeki, Nakano and Yamamoto [3] used a device consisting of a T V camera, a light stripe projection unit, a light stripe scanning control unit, a signal-processing unit and a microcomputer as shown in Fig 1.2. This experimental set-up detects the range of an object by triangulation. The light stripe is projected onto the object while the T V camera receives the reflected image. The light stripe scanning control unit traverses the scanner over the whole top surface of the object.

l ig h t s t r ip e

TV CAMERA

MIRROR

LASER

I

GALVANOMETER SCANNER

l ig h t

s t r ip e

LIGHT STRIPE SCANNING CONTROL UNIT

CYLINDORICAL LENS

PROJECTING UNIT

LIGHT STRIPE SCANNING COHTROL CIRCUIT

IMAGED POSI TION DETECTING CIRCUIT

COORDINATE CALCULATING CIRCUIT

MICRO COMPUTER

SIGNAL PROCESSING UNIT

Fig 1.2 Laser light stripe projection [3]

Jarvis [4] used a laser beam producing a sheet of light as shown in Fig 1.3. This light is scanned across the scene producing a single light stripe for each position. W hen the light source Is displaced, the camera view of the stripe shows displacements, along a stripe, which is proportional to the depth. The

proportionality constant between the beam displacement and depth is dependent upon the distance of the source from the camera. With this system more accurate depth measurements can be made with larger displacements.

/

Scene

Light S trip e

Ground Plane

/

V ertical Light Sheet

Rotation

Light Source

TV Camera

Displacement

Fig1.3 Adjustable light displacement system [4]

A block diagram of the experimental system, used by Harrison and W eir [5], is shown in Fig 1.4. An image acquisition board having a frame grabber of 256 x 25 6 pixels with 7-bit amplitude resolution was installed to capture images and to provide image output to a monitor. An attenuator wheel having seven attenuation steps was used to accommodate the very large reflectance range of the objects measured. Two translation tables provided steps in multiples of 0.5 mils, with a travel of 25 4 mm [10 inches] on the lower (y) table and 101 mm [4 inches] on the upper (x) table. With this system, all scanning was implemented by translating objects in a straight line or raster path, depending upon the mode of operation.

The angle between illuminating and receiving paths was set at about 30°, and the relative positions and angles of the receiving lens and camera were set experimentally to achieve the desired resolution of 2 mils per pixel at the object base plane, while maintaining a focal plane.

SPATIAL FILTER LASER

CAMERA

VARIABLE . ATTENUATOR

X TABLE Y TABLE

COLOR MONITOR

PC

Figi .4 Raster scanning device [5]

As shown in Fig 1.5, Feng, Liu and Xi [6], [7] used a double-sided scanning mirror to provide synchronization between projection and detection. The

scanning mirror directs a laser beam onto the scanned surface. The diffuse laser light from the scanned surface reflects off the backside of the scanning mirror and is focused onto a CCD array. As the scanning mirror rotates, the incident laser beam sweeps out the scanning plane that intersects with the scanned object surface. From the position of the focused laser image point P on the CC D array, the 3D coordinate on the object's surface can be determined.

CCD Array
I


I

Lens Fixed Mirror

^

;

Mirror ! Incident Laser

/
Diffuse Laser Light

, Laser Source /'

Scanner Body

Scanned Surface
Fig 1.5 Mirror synchronized scanner [6]

10

In M aver and Bajcsy's [8] paper, the depth of the scene is measured by a cam era-laser triangulation system, where the laser unit and the camera look toward the target with an acute angle as shown in Fig 1.6. A C C D camera and a laser unit are coupled and form a fixed sensor unit. The laser beam is spread into an illuminating plane. The illuminating plane intersects with the object surface, forming a laser stripe. A complete range image is obtained by scanning the scene with a series of parallel illuminating planes. This can be achieved by moving the scene support with a constant velocity perpendicular to the

illuminating plane.

of Scan/ y Scanning Plans of Motion Camera-Usor Sensor Unit Directiorfof R ahre Camera Center Origin ofSensor IM t Size of Region Ciwered by Range Image

Illuminating Plane

IF

/y

S u p p o rt
Scene of Interest

' imenection of Camera Field of View wilt) Illuminating Plane

Fig 1.6 Orthogonal laser scanner [8]

11

Aguilar, Torres and Lope [9] have used two cameras attached to a C M M machine as shown in Fig 1.7. The components of the stéréovision system are shown in Fig 1.8. The scan is made by projecting vertical light lines onto the object from a projector with a grating. The cameras detect the lines that cover the surface of the object. From the data collected by the cameras, a 3D model is established.

»uppon object 10 be m easured

Fig 1.7 CMM mounted structured light measuring system [9]

CA M 6B A I

F ig i.8 Detail of camera orientation [9]

12

Cho, Kim and Kim [10] used a vision camera mounted on the end effector of a CM M . Two images, which are needed for the 3D shape construction, are taken at two positions by moving the ram along the x-direction while the y-axis and zcoordinates of the camera remain unchanged. Using their surface

recognition/iocaiization method, the 3D surface is reconstructed.

Son, Kim and Lee [11] employed a laser scanner consisting of two major parts, the laser probe and the positioning system. The laser probe is mounted on a 3axis transportation mechanism and moves along predetermined scan paths.

During scanning, a series of laser stripes is projected onto a surface patch and two C C D cameras detect the reflected beam. When the laser scanner captures an image, the system automatically finds an optical focus. The length of the laser stripe and the stand-off distance cannot be changed by an operator. Since the laser scanner consists of optical sensors and mechanical moving parts, various constraints must be satisfied when measuring a point on the part.

The 3D laser scanning mechanism employed in Lee, Park and Son's research [12] uses a laser stripe scanner that measures one laser stripe at a time. The main part of the laser scanning system is a laser probe, which is fixed on a 3-axis transport mechanism. The laser probe consists of a laser that emits a laser line normal to the x-y plane and two CCD cameras that detect the reflected laser line. The detected laser line is stored as intensity information for each pixel and, by

13

image processing and triangulation of this information, a 3D coordinate value is assigned for each measured point.

Motavalli and Valenzuela [13] used two fixed cameras with a 90° separation while a table on which the object is placed is rotated as shown in Fig 1.9.

TapVlaw

Image csardtnafea
u ' ·

Rotaiy Table Paint eeei from one\

Fig 1.9 Fixed camera/rotary table machine vision system [13]

Saint-Marc, Jezouin and Meioni [14] have designed a physical calibration gauge consisting of horizontal and vertical plates that, when fixed on the linear table, ensures that its axis of translation is perpendicular to the vertical plate or that, when fixed on the rotary table, ensures that its axis rotation lies into the vertical plate. Using two fixed cameras, a stereo image from the laser line is used to reconstruct the part surface Fig 1.10.

14

I
U«r Right Camera Left Camen Object Penona! Computer with Digitizer CoatroUer Traniiation Table

Monitor (left camera)

OH
L

Monitor (right camera)

(a )
Controller

Sheet of light

Penonal Computer with Digitizer Left Camera Rotary Table

T

Laeer

f

Right Camera

Monitor (right camera)

(b)

Fig 1.10 Stereo laser line reconstruction [14]

15

In a paper by Chang and Chang [15], a laser scanner is used as the object measurement system. W hen a laser line projects onto the object surface, the reflected laser image is acquired through two CCD devices. The hardware scheme of the laser scanner is shown in Fig 1.11. The laser scanner used can perform two types of scans, a plane scan and a rotated scan.

shtdcw

Bxiurc probe K t



micTOPfocessor

o to fo m

X

J

step motor

Fig 1.11 Linear and rotary laser scanner [15]

Campion, Dye, King and Ormson [16] are targeting multiple objects using a laser scanner. The basis of the system is a turn-table which supports four target mounts. As the turn-table rotates, the target mounts move radically towards or away from the center of the turn-table depending on the turn-table rotation as shown in Fig 1.12 and 1.13. This enables the focused laser spot to be scanned across a selected target by rotation of the turn-table. After each full rotation of the turn-table, the target mount has moved by about one spot diameter, then a different track across that target is addressed.

16

A: Target

B: Particle shield

C: Tum-tabte

Fig 1.12 Top view, turn-table laser scanner [16]

A: Fixing screw: D: Tuget support

8 : Target mounts E: Bearing mounts

C; Tteget Fi Threaded shaft

O: Fixed bevel gear H: Main turn-table shaft

Fig 1.13 Side view, turn-table laser scanner [16]

17

Pito [17] used laser stripes that rotate around the object collecting several samples to create the 3D image of the object. His algorithm uses the common strategy of keeping track of the "unseen" portions of the viewing volume to identify what needs to be scanned. An area of the viewing volume is "unseen" if it hasn't been scanned due to omission or occlusion. First and second scans are shown in Fig 1.14 and 1.15.

void voium©

object seen
surtace range s c a n n e t 's ^ ^ sampling arsa
ra n g s scan n er

/

A L

viewing volume ot system

Fig 1.14 Rotary scanner, showing voids [17]

Fig 1.15 Rotary scanner showing (a) first view (b) overlap [17]

18

Finally, Lee, W oo and Suk [18] classified the "Current Scan Mechanisms" devices based on the configuration of the machine. Although there are several configurations that have been explored, only three are dominantly used in industry. The three configurations are as follows;

Three Cartesian axis; as shown in Fig 1.16, the design follows the same structure as for CMMs. The inherent stability of the design allows for higher accuracy when compared to other configurations. By using a rotary table, an extra degree of freedom can be added.

Fig 1.16 Three Cartesian axis scanner [18]

Rotary platform on which the object is mounted with a stationary sensor: the sensor is traveling by rotating the platform and by lowering the platform In steps as shown in Fig 1.17.

19

Fig 1.17 Rotary scanner [18]

Robot arm with a sensor attached at the end of the arm: this type has a greater flexibility as it scans most shapes by moving the robot arm as shown in Fig 1.18.

Fig 1.18 Robotic arm scanner [18]

20

1.2 Proposed New Scanner

T h e current scanners have some disadvantages; 1. No single machine can scan six sides of a part, moreover the choice of a machine depends on the characteristics of the part to be scanned and its application. 2. A skiiled operator is required to move the laser head around the part while maintaining fixed spacing between the sensor and the scanned object's surface. 3. 4. An operator needs to plan a collision free path for the scanning device. T h e configuration doesn't allow for bottom scanning.

As the automated system is one of the main problems in reverse engineering, a configuration that will reduce or minimize the number of occlusions must be selected.

It is for these reasons that a new scanner configuration, with the flexibility to move the scanner head in prismatic, cylindrical and spherical motions, was designed. The new design is shown in Fig 1.19.

21

Motor 2

Direction 2<C Sensor Motor 1 Direction 3 [otor 3

Rotary Table Direction 1

Fig 1.19 Proposed scanner for orthogonal, cylindrical and spherical motions

The advantages of the proposed new scanner are: 1. Accessibility: · · · 2. The Table can rotate up to 360° in the X-Y plane. The CCD & laser can scan 360° in the Y-Z plane. The glass table allows for bottom scan.

Automatic scanning: all points are within the depth of focus.Therefore, path planning is not required.

3.

Non-contact laser allows scanning without surfacedamage

of

materials

that are difficult to digitize on a CMM machine, e.g., clay, fabric, wood, foam, plaster, glass and flexible plastics. 4. Scanner can be built from "Off-the-shelf " parts.

22

Chapter 2

Construction of the Proposed Scanner

In order to study the merits of the proposed scanner, an experimental prototype was constructed at the Photonics Lab at Ryerson University. A 1200 x 2400 mm [48 X 96 in] optical table was used as the base of the prototype. Two stands built from melamine covered medium density fibreboard 305 mm [12 in] high and 127 mm [5 in] wide were constructed and mounted on to the optical table.

On the left hand side of the first stand (see Fig 2.1) a 330 mm [13 in] diameter plexiglass table and corresponding ball bearing are supported. The periphery of the rotary table has been precision CNC machined to fit an XL toothed belt. Driving the tooth belt is an Applied Motion from bipolar stepper motor. On the second stand, a pair of pillow blocks support a 19 mm [3/4 in] shaft, also driven by a stepper motor, geared with an anti-backlash gear with a 4.3:1 ratio to

23

provide more torque. Finally, at the end of the rotor arm, two linear guide rods and a lead screw support the prismatic axis of the line laser and CCD sled. A list of the mechanical components can be seen in Table 2.1.

o Top View
1

iMotor 2 M otor 3

Motor 1

]

Fig 2.1 AutoCAD drawing of the prototype

Table 2.1 Mechanical Components of Scanner Name Description

Applied motor stepper Pin # 5023-469 Motor 1 Motor 2 Applied motor stepper Pin # 5023-469 Motor 3 Applied motor stepper Pin # 5023-469 Plexiglass with 208 teeth, 330 mm diameter Rotary Table XL tooth, delrin 13 teeth Drive Sprocket Drive Belt XL Table Bearing Ball Bearing, 330 mm diameter Arm Shaft Bearing Pillow Blocks, 19 mm tooth, 32 D.P. Drive Gear Driven Gear tooth, 32 D.P. anti-backlash Lend Screw Threaded rod 14 -20 UNC Guide Rods 01 Drill rod, 6.35 mm diameter Sled Nut 1 /4 - 20 UNC, delrin

24

A photo of the prototype can be seen in Fig 2.2. The rotary table is surrounded with a toothed belt that allows motor #1 to rotate the platform. Motor #2 controls the movement of the sensor (laser diode and CCD camera) along the x-axis, through the means of the lead screw. The whole sensor can be swung around the plexiglass platform by motor #3. Therefore the following motions can be accomplished:  Scan 360° around the object by rotating the table in the X - Y plane Scan the object 360° in the Y - Z plane by moving motor 3, carrying the sensor, in direction 3  Scan the object along the X-axis by moving the sensor along the linear guides through the control of motor 2

Fig 2.2 A photo of the constructed scanner With these movements, an object placed on the scanning table can be scanned with spherical, prismatic and cylindrical motions. As a result, a complete scan, including the bottom of the object through the clear table, can be performed.

25

2.1 Control of the Scanner

Motion is generated through three applied motion bi-poiar stepper motors rated at 120 oz-ln of torque. In Fig 1.19, along direction #1, the stepper motor provides a resolution of 0.6°, a resolution of 50 pm [0.00125 in] along direction #2 and a 2.3° resolution along direction #3. The stepper motors are all driven with Gecko G201 motor drivers. The drivers are interfaced with a PC, as shown in Fig 2.3, and are controlled through Lab VIEW 5.1 with National instrument's motion control board PCI-7324 and motion module UMI-7764. Fig 2.4 shows the picture of the motor control box.

Sensor ' --^M otor 2 Motor 1 Motor 3( (-)----

Motor Control Box

Fig 2.3 PC interfacing with the scanner components

Fig 2.4 Motor control box

26

A LabV IE W virtual program has been written to control the scanner motion. Fig 2.5 shows the front panel and Fig 2.6 shows the LabVIEW block diagram to drive one motor. Implementing the program for all three motors, all motions of the scanner can be controlled. The motors calibrations are as follows:    Motor 1, 360° represented by 590 steps Motor 2, 25.4 mm [1 In] represented by 800 steps Motor 3, 90° represented by 38 steps
   IB ____
IO l ^ I W T Î Ï l |l3 p t Applicahon Font ^ |g p

See Show VI Inlo.;. under the Wlndow» pulWown menu foi nslruci

g
Motor #

1000-

tt

InitialAceelei »ion

I

'

'

.5 0 0 -

"ecbon -

0

a p p iy a d j u s t I

Sfoppffo

m REVERSE

.9 1 0 -1000

Fig 2.5 Motor drive LabVIEW program (front panel)

M o l o r _ 2 . v it X a g r a m '

û p o ra to

j,o o k

fiiowso

hjejp

I l^pl Application F
ID irectioni

S lot

n
'Rod*'

a
initial Velocityl

D ecelerate)

Ü30 a
Mumeticl

a-

|Velocity Mode IlnitielAccelefeliorij II a n II ]

 ffiP i

M otor #

cn -i

·*(^ IS
i

# O f c y c le s

Fig 2.6 Motor drive LabVIEW program (block diagram)

27

2.2 Scanning Sensor

The scanning sensor is comprised of a B&W CCD camera and a line projecting laser diode. Depth of the target object surface is calculated through triangulation. The camera and laser are placed 203 mm [8 in] apart, with the cam era fixed perpendicular to the direction of travel of motor #2. The laser is pointed at 38° from the axis of the camera. The stand-off distance of the sensor has been selected at 254 mm [10 in].

A black and white (B&W) CCD camera is connected to a LabVIEW P C I-1407 image capture board. An f/8.5 mm lens is used to image the scene below the camera with a red filter to restrict the color of light reaching the CCD. The image size, 640x480 pixels is processed within LabVIEW using its IMAQ software. A LabVIEW virtual program has been written and can be seen in Fig 2.7 showing the front panel, and Fig 2.8 showing the block diagram. This program can capture one image and change it to a 640X480 array representing the illumination value of each pixel. The program also provides a 2X 480 array, which represents the location of the strongest pixel in each row of 640 pixels.

28

it> . V e l o c i l y

F U L L

A < J iu s t m c n t

l <>

f e l l I I i j l 3 pTAppl)caUon Font

ifott» a Ax : a

,  /Ir-tftlal Velocity fiQ tp\l£zaM 6ioa*w«.iorom .- ; « : ; L . {tm g O 1 REVERSE of interest ^0 gp-------CL' îjl32Ô 0d gi$ooo__ '

5CIÎ0 4 .Q Ô jlim .o o " , -IO C

jÎTo'4.00 ; 6 0 3 . 0 0 1 164.60 · 11103.00 " 1104.00 hpam lrt,,oi,GO IT 6s .d 0 # 3 . 00 . h o z T o r i h o o T o d " f îë ïra r " Il 0 2 .0 0 ho 2.Qa Ihpô.oo~ |fio 2:oo  M O & O o" 1 1 0 5 0 0 ' h04TOQ" ' ffô a.D O I h ô i . o o Uïoo.ob liozoo ' l i o 2.c n (l'cSiüo 11101.00 11100.00 iîoe .o o Il o â o o " 662:60 i l 0200 11100.00 60300 , I l h 02 t K Î ~ fi ô i'id o " 1 iâ o io c T " IÏ 0 3 . 0 Û - " }i 0 4 :6 6 " o z O o ' fi 0 2 .0 1 fid i.d o Iftôo .bD I16&66 lio4.od ' 6 6 3 : 6 c f

ttO ZQ O FToa.cra

Ü1O 1.00 IfTozlbb

is â o o 'SÔ.0O @ 9.0 0 (1 0 2,0 0

i l l 0 3 .0 0

ffSTÆo
l ï S a 66" ` 0 6 3 .6 0 :" H 0 3 .0 0

fioa'S a'"ifitÎ4.oe ''

11103:00

601.00 1105.00 1104.00 Il 01.00 05.00 .
1162.60 (1 0 3 .0 0 I l 0 1 .0 0

ffSb.65 ! jïüï.'ooT lid î:b o ` 'i iî6 fo 6 -?
iï 61.00 1 I9 3 .c n S lim .o ij 8

1 1 0 2 .0 0

1 1 0 0 .0 0

1102.66

ii

1 1 0 2 .0 0
Il 62.60 1 1 0 2 :60:

R oîroiS t

iï6ô.061

.:;,N O T E ;,-Y o u m ust h a v a IM A Q V o io n
f t ^ t h is o x a n ^ a .

% 2 4 S o'

O u tp u t A rra y

^ Z J i^ Z

s ize (c}

|24 " " 1365..... |30S 1 % 1 0 !o (22 - - 1 3 6 5 1 2 8 [305 1 3 0 5 la (30 . 1 3 0 5 1 3 1 -=="= " I3ÎS" râ-- - I3Ô 4- : !ô 1 0

Fig 2.7 Image capture LabVIEW program (front panel)

O®

ü p a ra ts

Xoot*

I I I I |l

W l

Jgrowse ^^mdow

ti©lp

_

_

: F Ï W AppiicaÜon Font

EHHT

IRenion of tnterosti

nterraeejNanw

In sall--I

I

IB uf/er N um ber l-lralîM

n ô 5 5 |
|*»One-Shot H
{<  6 bits ^ IT im e o u t f m t j T h is s a m p le w o A s fo r 0 b its p ic lu to . t o u t o k w k h 1 B b its p ic tu re s ; ·M o d ify t h e im a g e ty p e in o u t i n t h e IM A Q C re a te , v< to 1 b bits IMAQ m arneTcAtrayl : ............... "  ................... 

fî^SystenT^

Krravl

nr -

I

eizefsl

;i^ PriWTyne

Fig 2.8 Image capture LabVIEW program (block diagram)

29

Adjusting the focus, illumination, and the alignment of the laser line are required before the scanner can be used to gather data. Adjusting focus is a three-step process. First, the LabView image capture program must be run in continuous mode so that a real time image is visible on the computer screen. The second step is to adjust the aperture to the maximum setting and the focus the CCD camera to get the best visual picture. As shown in Fig 2.9, a sheet of graph paper has been placed under the camera to aid in this adjustment process.

ge ijplAppficationFonI

Edi opérai»
I

ije lp

jsnm

( ë jI I ] f W Il l w l P l c m I W A p p H c o U m F o m I r U j f c i J ' l M l s S t O 'l

lure, to ute It With he IMAQ Deate.vi lo 16 bits

MAO IfnageroAffd^

M B O ' r ioe

bt. ^

IP - ··· - I .z*

Fig 2.9 Focus adjustment using graph paper

30

Finally, the cam era aperture Is reduced to a setting where only the laser line is visible, as demonstrated in Fig 2.10. During this process, ambient room lights must be switched off to eliminate any reflection.
BiSliMIIBiBiHIIfliffiifflifülfl'-- iia#M

fn*

1

E i""Cli«*ri  p il 1 |1 3 p` A ppbcal.onK e n t

i1 j Si-i '

VI-' -,'V IT S· j

teleet S howVI Inlo from'h* W indow: m tnu.
In ie c ra c eN a m e

F o i a rte ;t3 ip lk)n

M eg m nof inieml

#Zl fw

IB

374)0,

Q 2 .0 Û

§ R '. B#Æ |5 H G U L O O r iiïP M Q # ;irô R a ^ i^ à ).:^ > |j9 8 L Ô Q M o o^ ·^ IH S 5 r :.'iiïa io d '' iiim o o riM O O o i)"IB & o o '"'lls k O D a a o Q g e o g jm o o 3 Ô .0 Û I'm&Q 'msa il ^  « fb i'tô i' O b j e c t scanned lâ iÔ Ô -; i^ iÔ Ô _ ________________ iftb W ' iteLOO 130 00 '.aaoo
üaow *fto to o iiflfeoo 137 00 WOO liio£5o 'ilCnOO îiiMjioi'i-^i30UOO:^-jiibbJOO»fi<|{97.00rv-<iiSy.oa'x^::iliiDoi)û'^ ^^ R&cBT'Üsg.oo ( 'â ô E W i f î o t 00 jlîc û $ û ~ |a B Q 8 J fib a o o ttlQfOÔt lo f û o « ^ o û ? t;otf~ititti.off "ji iSLoo jisaoo 'f i o o t o

fïâ ïoe n

lio i ü ) 1024)0 [1ô(Sb, `^Çi-op 1101.00 iio i.b o ' üS^.Oo " jiaa.oo ~ fio i.o o .: iR oaoo: i^ !ô ô ^ - jg B IB ô T n rio i.o o :.

L d

r.

...i« * ,

3 0

1 0 0 ^ 0 0 jî9 a.0 D -> ;S t ^ 1 1 0 1 . 0 0jh T riio o '^ l'oe .o o 9 ao(Fr :S7 .oq ~ il 3 afflj '^Jiioi.O Q "T;fioaoo' jim-oo

,iM o i.ù d '''''|!)b iQ % '''''yid o W "|5 & ' ;iioo.oo'lîim .oo  |:\oi.oo ifToaoo fio io o 1)0100 nonoo i(fbz.Ôo lisaàSt 'H ^ û o .JfTSOo ; 5 â ô ^ ifioaco - |aao o th o o # ihoT;Oo [ft02oo laaoo " jiio o .o o i5gB T~ 99.00 """1fBe.PD'-':!nw.flp. SToov SâôBT

I

Z e r o le v e l lin e

itioaG O ^"^

_____ __

: .ÇnrmaôacftWpfd j QM e d h a L im w D w B k .1 1 R I: Fig 2.10 Adjustment of laser line illumination and alignment {[

3Medh5 Um aoq_J.vi

To enhance the reading when more than one pixel having the same grey level, the following equation has been used [19];
U

= I

UjCi/

I c,

(1)

W here i is from 1 to 640, c is the pixel position and u is the strength of the pixel (reading from the 640X480 array).

The black area has an illumination factor of 95 to 110 while the detected laser line starts from 120 to 255. To reduce noise and extraneous reflections pixels with grey level less than 115 have been thresholded.

31

2.3 Conversion of Pixel Values to XYZ Coordinates

In order to scan an object, the sensor (CCD and laser diode) sled is traversed in the X-direction with predetermined steps. At each step, a frame is taken by the CCD camera in which every 90 pixels represent 1 inch on the Y-axis, at the preset stand-off of the camera. Due to the scanner's mechanical construction, the origin (y = 0) is shifted by 188 pixels towards the Y-axis.

From the above, Y can be calculated as follows: Y = [(the reading in pixels in Y-direction) -1 8 8 ] / 90

(2)

Triangulation is then used to calculate the height "B" of the target's surface by measuring the laser line shift registered on the CCD camera. Fig 2.1 3 is a photo of the actual sensor while the height is shown in Fig 2.14.

Laser Axis

C am era

Axis

Fig 2.13 Camera/laser sled

32

s ..

Fig 2.14 Laser camera and object triangle

From simple triangulation of the geometry in Fig 2.14, the following equations can be derived; Z / X = B /C B = D Z /( D + a X ) C = DX / (D + a X) (3) (4) (5)

W here B and C are unknown, D is the number of pixels in the distance A, and a is the number of pixels per inch.

With a separation distance between the CCD camera and the laser diode, the maximum resolution of the system can be calculated as: Resolution in Z-direction = Z / (1 + a X) Resolution In X offset = X / (1 + a X) (6) (7)

33

Initially, the laser diode and CCD camera were built with a separation distance of 76 mm [3 in]. This resulted in a scanning resolution of 1.003 mm [0.0395 in] in the Z-direction and 0.302 mm [0.0119 in] in the X-direction. In order to increase the resolution and accuracy of the scanner the separation distance was increased to 203 mm [8 in]. The final resolution of the system is 0.381 mm [0.015 in] in Z-direction and 0.304 mm [0.012 in] in X-direction.

Although the resolution went slightly up from 0.302 mm [0.0119 in] to 0.304 mm [0.012 in] in X-direction, it is dramatically improved from 1.003 mm [0.0395 in] to 0.381 mm [0.015 in] in Z-direction.

Therefore, the X, Y and Z locations of each surface data point can be calculated as follows: X = (# of cycles of motor # 2/800)-3{which is the shift in X to the centre)-C (8) Y = [{the reading in pixels in Y-direction) -1 8 8 ] / 90 Z = 10*(shift in X-direction in pixels)/(666+shift in X-direction in pixels) (9) (10)

34

2.4 Transformation for the Rotary Table and Arm

Transformation to the original frame [20] Is needed when the rotary table or the sensor arm is moved. Due to the rotation of the rotary table, the reference frame Is rotated around the Z-axis by angle = 9 The transformation matrix Is:

1
Tz = 0 0

0
cos 0 sin 0

0
-sin 0 cos 0

( 11 )

Due to the rotation of the arm carrying the sensor, the reference frame will rotate around the X-axIs by angle = a. The transformation matrix will be

Tx =

cos a sin a

- sin a cos a

0 0

(12)

0

0

1

The final transformation matrix Is the multiplication of the above two matrixes (11) & ( 12 ):

T = T x *T z=

cos 9 sin 0

0

- sin 0 cos a cos 9 cos a sin a

sin z sin a - cos z sin a cos a

(13)

35

Accordingly, if X', Y', Z ' are calculated with respect to the camera frame and the X, Y, Z are calculated with respect to the machine reference frame, the relations will be as follows:

X = X ' cos 0 - Y' sin 0 cos a + Z ' sin 0 sin a Y = X ' sin 0 + Y' cos 0 cos a - Z ' cos 0 sin a Z = Y ' sin a + Z' cos a

(14) (15) (16)

Where, the angle of rotation around the X and Z-axis can be calculated as follows:

a°=X-axis rotation = (# of cycles in the loop command rotate motor 3)*9 0/38 (17) 0°=Z-axis rotation=(# of cycles in the loop command rotate motor 1 )*360/590 (18)

36

2.5 Call Interface Node (GIN)

Using the GIN node is an alternative method for calling source code written in G language. The creation of the GIN node is done in three steps. The first step is generating a (.c) file by the GIN node from the LabVIEW program. Fig 2.15 and Fig 2.1 6 shows the (.c) files for cylindrical and spherical scans respectively. Adding the code needed where "/* ENTER YOUR CODE HERE */" sentence is shown. The second step is demonstrated In Appendix A, where a (.Isb) file is

generated using Microsoft Visual C++ 6.0. The last step is downloading the (.Isb) file into the GIN node.

It must be noticed that the array format for the typedef struct in Fig 2.15 and Fig 2 .1 6 are as follows: typedef struct { int32 dimSizes[2]; float64 arg1[1]: }T D 1 : typedef TD1 **TD1Hdl; T D IH d l v a rl;

According to the GIN user manual, accessing the element at row I and column J from an array with R rows and C columns, the following formulas are applied: R = (* varl ) G = (* varl ) dimSizes [ 0 ] dimSizes [ 1 ] argi [I * G + J] (19) (20) (21 )

Value = (* varl )

37

1* * CIN source file */

#include "extcode.h"

/* * typedefs */

typedef struct { Int32 dimSizes[2]; float64 arg1[1]; }T D 1 ; typedef TD1 **TD1Hdl;

CIN MgErr C INRun(TD1Hdl v a rl, int32 *var2, float64 *M otor_1, float64 *Motor_3, float64 *Step);

CIN MgErr CINRun(TD1 Hdl v a rl, int32 *var2, float64 *M o tor_1, float64 *Motor_3, float64 *Step) {

/* EN TER YOUR CODE H E R E V

return noErr; } Fig 2.15 (.c) file generated by CIN node for cylindrical scan

38

/* * C IN */

s o u r c e file

# incl ude "extcode.h"

/* * typedefs */

t y p e d e f struct { i nt32 d i m s izes[2]; f l o a t 6 4 a r g 1 [1 ]; } TDI; t y p e d e f T D 1 * * T D 1 Hdl ;

CIN MgErr C IN R u n ( T D 1 H d 1 * M o t o r _ 3 , float64 *Step);

varl ,

i nt 3 2

*var2.

fioat64

CIN MgErr C IN R u n ( T D 1 H d I * M o t o r _ 3 , float64 *Step) {

varl ,

i nt 3 2

*va r 2 ,

fioat64

/* E N T E R Y O U R

C O D E H E R E */

return noErr ; }

Fig 2.16 (.c) file generated by CIN node for spherical scan

39

2.6 DXF Format

This format has been used for the purpose of displaying the result in a professional visual format. For simplicity, Autocad DXF format R 12 has been used [21]. Writing DXF format is performed in three steps. The first step is the beginning of the file, as shown in Fig 2.17, which is generated by the C code shown in Fig 2.18. The second step is displaying a point as shown in Fig 2.19, generated by the C code shown in Fig 2.20. The C code generating the points can be repeated as many times as the number of points to be displayed. The last step is the end of the file which is shown in Fig 2.21, generated by the C code shown in Fig 2.22.

0 S E C T lO N 2 HEADER 0 ENDSEC 0 SECTION 2 TABLES 0 ENDSEC 0 SECTION 2 BLOCKS 0 ENDSEC

Fig 2.17 Beginning of DXF file format

40

fp r i n t f (OUTDXF, 0 \ nSECTI0N\n2\nHEADER\nO\nENDSEC" ) fp r i n t f (OUTDXF, " \ n O \ n S E C T I O N \ n 2 \ n T A B L E S \ n O \ n E NDSEC fp rin tf(O U T D X F , \n O \nSECTI0N\n2\nBLOCKS\nO\nENDSEC

Fig 2.18 C code to generate the beginning of D XF file
0 S EC n o N

POINT

X CO o rd in a te
20

Y CO o rd in a te

30
Z c o 0 rd In a te

ENDSEC

Fig 2.19 Format for displaying a point by DXF file
fprintf(OUTDXF, fprintf(OUTDXF, fprintf(OUTDXF, "\nO\nSECTION\n2\nENTITIES\nO\nPOINT\n8\nO") ; "\nlO\n%f\n20\n%f\n30\n%f",X,Y,Z); "\nO\nENDSEC");

Fig 2.20 C code to generate a point by the DXF file

EOF

Fig 2.21 End of DXF file format

fprintf(OUTDAT,

" \nO\nEOF\n")

;

Fig 2.22 C code to generate the end of DXF file

41

2.7 Master Algorithm

The overall master algorithm that controls the system motion and the CC D frame grabber generates two output files. The first contains the points collected from the object surface in text (TXT) format while the second file have the same points stored in AutoCAD (DXF) format.

A flow chart of the master algorithm for cylindrical scans is shown in Fig 2.23. The cylindrical scan program requires three inputs. The first input is the new angle of the rotary table by motor 1; the second is the rotation angle for the sensor arm in the Z - Y plane; and the third is the step length for the sensor in Xdirection. The sensor must start from the home position.

A flow chart of the master algorithm for spherical scans is shown in Fig 2.24. The spherical scan program also requires two inputs. The first input is the rotation angle for the sensor arm in Z - Y plane while the second is the step for the rotary table angle. The sensor must start from the home position where X = 0 while the rotary table will rotate 360" in steps.

42

Get the movement angle of the Arm, Rotary Table and the step

Move motor 3 (Arm), and motor 1 (Rotary Table) to the position required iS*om the home position

Move motor 2 one step forward

Capture the image, and change it to 640X480 array

Generate the points reflected from the object

Record these points in both data file and DXF format (to be opened using AUTOCAD software)

Is the full scan performed?

No

Yes

End

Fig 2.23 Cylindrical scan algorithm flowchart

43

Get the m ovem ent angle o f the Arm, and the step

M ove motor 3 (Arm), to the position required from the hom e position and motor 2 (sensor) is where X=0

M ove motor 1 one step forward

Capture the image, and change it to 640X 480 array

Generate the points reflected from the object

Record these points in both data file and DXF format (to be opened using A U TO C A D software)

Is the full scan performed?

No

Yes

End

Fig 2.24 Spherical scan algorithm flowchart

44

Chapter 3

Preliminary Results of the Prototype

A number of different gage blocks and angle blocks were used to test and calibrate the system. Cylindrical and spherical scans have been performed on a 1-2-3-gage block and a cast object as shown in Fig 3.1. The sensor was traversed at a set increment then an image was taken at each of those increments. The process was repeated until the complete surface was scanned. Lab V IE W software was used to control the motion of the sensor, the capture and processing of the image set. To complete a scanning pass, approximately 5 minutes are required on a PII-400 MHz PC. The resulting scan data, typically with 5 0 0 0 to 7000 points, can be saved in AutoCAD DXF format and brought into

45

AutoCAD for display purposes. The scan lines are 2.5 mm [0.1 in] apart with points spaced 0.3 mm [0.0125 in] apart within each line.

TOP VIEW

BOTTOM VIEW

Fig 3.1 Cast object with quadric and free form surfaces

3.1 Laser Alignment and Separation

To achieve the alignment, a triangle consisting of the camera, the laser diode and the table, must be at a perfect right angle as previously demonstrated in Fig 2.14. To achieve the alignment, the zero reference (z = x = 0) is adjusted at 294 pixels from the image edge.

It is important for the laser diode to be fixed and positioned as vibrations from the sensor movement can affect its accuracy. To this end, the mounting bolts for the laser housing were tightened and worked with (white-out) to ensure that there was no movement from its original alignment.

46

After some preliminary scans, the accuracy of the scanner was improved from 1.003 mm [0.04 in] to 0.381 mm [0.015 in] by changing the cam era laser distance from 76 mm [3 in] to 203 mm [8 in].

3 .2 Motor Controls

All three motors play an important role in the image accuracy. When motor 2 is moving, the X coordinate is detected (see equation 8). W hen the transformation matrix is applied (see equation 13), the two angles 9 and a are calculated from motors 1 and 3 respectively (see equation 17,18).

T h e motor control is based on an open loop where there is no feedback. This is because the National Instrument's motion control board PC I-7324 allows for only four input/output, where three out of the four are configured as motor outputs.

Tw o calibrations have to be performed as a result of the open loop operation. The first is the home position, which must be done before each scan. The

second is the step calibration, which is made every time the scanner is started.

Motors 1 and 3 move to the final destination in one step while motor 2 moves to the final destination in several steps. Accordingly, the motor calibrations are performed taking into consideration the inertia factor of the sled.

47

3.3 CIN Node

There is a specific method required to compile the CIN node. Starting with the LabVIEW program, a (.c) file is generated. Using the (.c) file as a base for a C++ compiler, specific commands shown in Appendix A must be followed to generate the complete (.Isb) file. Then, the (.Isb) file is downloaded into the CIN node in the LabVIEW program.

Familiarity with the data type is very critical, as Interfacing between the iabVIEW program and CIN node has a special format for data exchange. It must also be observed that using a CIN node customizes the LabVIEW program to fit a specific requirement.

It has also been observed that every time a change is made to the CIN program, the previous CIN node must be deleted and the computer must be booted before the new CIN program is installed. Otherwise, error massages will appear while running the program, as well as wrong results will be obtained.

As the CIN node is a type of Dynamic Link Library, all the errors will occur as run time errors where the CIN node has stopped the LabVIEW program.

48

3.4 Image Processing

In this section, scanning results are displayed on four-window figures using AutoCAD R 14. The top view on each figure is demonstrated on the upper left window, the isometric view on the lower left, the front view on the upper right, and the side view on the lower right.

In Fig 3.2, noise points are visible around the object, especially on the front and side view. This was caused by a reflective highlight on the polished steel 1-2-3 gage block. Rescanning of the block and subsequent scans were done after the gage blocks were spray painted with a iight gray primer.

!!" !! iflHilinilllllll

i : i : i î i i l ü ! i l i i i i i i i
Fig 3.2 Reflections caused by shiny gage block

49

Figs 3.3, 3.4, and 3.5 show scans for the 1-2-3-gage block and the cast object (see Fig 3.1). Again, noise in the scans Is seen under the block. A rough surface finish on the plexiglass table was thought to be the source of this erroneous data. A dulling gray (krylon duli-coat) was applied to the plexiglass in order to reduce laser reflections off the table surface. Although this reduced the amount of noise in each scan, the amount of noise was still not acceptable.

A new clearer plexiglass was machined with special care to protect the surface from scratches and abrasions. This helped to reduce the reflection from the background as only 5,000 to 7,000 points were collected from the object surface, instead of 20,000 to 25,000, where the difference is due to the plexiglass reflection. Storage memory was also reduced from 3M bytes to Vs M bytes.

53

E S I

Fig 3.3 Gage scan with background reflection from the rotary table

50

- E l i : : i l l I I I f.tl i l l

.iMllilll

Fig 3.4 Gage scan and reflection caused by the rotary table

Kill

S' rr

a...;::::::! Fig 3.5 Object scan and reflection caused by the rotary table

. ,{41 t i l

Figs 3.6 and 3.7 show reflections from ambient room light. Shutting off the room lights while the scan is performed, gives better results as shown in section 3.5.

/

H X Q Fig 3 6 i -2-3 -g a g e block scan with room light reflection

51

H

N Fig 3.7 Cast object scan with room light reflection

The most sensitive adjustment in this test is the combination between the focus and aperture of the CCD when a bottom scan of the part is performed through the plexiglass. Two sets of reflections, off the bottom and top surfaces of the plexiglass, usually result. Adjusting the focus and aperture can reduce the intensity value of these reflections. Figs 3.8 and 3.9 are examples of

unsuccessful bottom scans. Aperture settings and the focus were experimented with in order to get acceptable bottom scans.

·

if. f

I Fig 3.8 Bottom scan with very low illumination

52

Fig 3.9 Bottom scan with high illumination

Finally, the rotary table is attached to the scanner body from one side. As a result, the weight of the scanned object can affect the table parallelism. Visibly, as shown in Fig 3.10, there is a slight skew to the resulting scan. One simple corrective action taken was to support the rotary table from both sides. However, this would limit the scanner arm from rotating the full 360° motion. Moreover, the side scan before applying the transformation matrix, is demonstrated on Fig 3.11.
IIIU !

E l

Fig 3.10 Skew scan due to unsupported rotary table

Fig 3.11 Side scan, before applying the transformation matrix 53

3.5 Full Scan Results

A complete scan was achieved after the setup and adjustment had been performed. A 1-2-3-gage block and the cast object were scanned using the cylindrical and spherical methods.

3.5.1 Cylindrical Scan

A Cylindrical scan is performed by traversing the sensor on a set increment, done by motor 2 in direction 2, and taking an image at each increment. This was repeated until the complete surface was scanned. Fig 3.12 shows the machine adjusted for the top scan (arm at 90° from the home position). Figs 3.13 and 3.14 show the top scan of a 1-2-3-gage block in different poses whereas Figs 3.15, 3.16 and 3.17 show the arm in the same position as for the top scan while the rotary table is at 90°, 180° and 270° respectively. Fig 3.18 shows 4 different isometric views of the top scan for the cast object.

Fig 3.12 The machine positioned for a top scan

54

Fig 3.13 Top scan of a 1 -2-3-gage block, where Z = 1

s Fig 3.14 Top scan of a 1-2-3-gage block, where Z = 3

51

Fig 3 15 Top scan while the rotary table at 90®

55

Fig 3.16 Top scan while the rotary table at 180'^

I s

Fig 3.17 Top scan while the rotary table at 270'

Fig 3.18 Top scan for cast object with quadric and free form surfaces

56

Fig 3 .1 9 shows the machine adjusted for a side scan, arm positioned 60° from the home position, while the rotary table is moved clockwise. The side scan of the 1-2-3-gage block is demonstrated by two different isometric views on the left hand side; while the right side shows the front view on the upper window and the side view on lower window. The casting object is demonstrated with three different isometric views. The top left corner always shows the top view.

r

Fig 3.19 The machine adjusted for the side scan

57

Figs 3.20, 3.21, 3.22 and 3.23 show the side scan for a 1-2-3-gage block where the rotary table is positioned at 0°, 90°, 180°, and 270° respectively. Figs 3.24, 3.25, 3.26 and 3.27 show the side scan (arm positioned 60° from the home position) for the cast object while the rotary table is positioned at 0°, 90°, 180°, and 270° respectively.

IIIIIIÜIIII ÜÜ Fig 3.20 Side scan for 1-2-3-gage block while the rotary table at 0°

........... Kl

Kl

Fig 3.21 Side scan for 1 -2-3-gage block while the rotary table at 90°

58

Ülülülll I

Fig 3.2 2 Side scan for 1-2-3-gage block while the rotary table at 180®

11i 11111111iI ii i ! ! I 1 S

' !

s Fig 3.23 Side scan for 1-2-3-gage block while the rotary table at 270°

Fig 3.24 Side scan for cast object while the rotary table at 0

59

T.........." J I " ' ..... ..

Fig 3.25 Side scan for cast object while the rotary table at 90^

lil':
I
11 III III y !

I.

Ill

Fig 3.26 Side scan for cast object while the rotary table at 180'^

&

a ,

.

_ -

Fig 3.27 Side scan for cast object while the rotary table at 270"

60

Fig 3.2 8 shows the machine adjusted for a bottom scan (arm at 270° from the home position). The bottom scan for the 1-2-3-gage block and the cast object is displayed on two different isometric views on the left side windows, while the right side has the front view on the upper window and the side view on lower window. Figs 3.29 and 3.30 show the bottom scan for a 1-2-3-gage block and the cast object respectively.

Fig 3.28 The machine adjusted for the bottom scan

61

Fig 3.29 Bottom scan for 1 -2-3-gage block

I-

..9 #

m

s
Fig 3.30 Bottom scan for cast object

Based on the above results, it is obvious that the cylindrical scan can be used on both the top and the bottom. The percentage of noise points relative to the total points is close to zero on top scan, less than 0.5% on side scan and less than 2% on bottom scan. From the resulting point count, the noise points represent 0% when they were calculated for the experiment result shown in Fig 3.13, and 2% when they were calculated for the experiment result shown in Fig 3.29. As It was very difficult to count the points on the casting object, counting was done on the 1-2-3-gage block only.

62

3.5 .2 Spherical Scan

A spherical scan is performed by traversing the rotary table a set distance by motor 1, and taking an image. This was repeated until the complete surface was scanned. Figs 3.31, 3.32 and 3.33 show spherical scans performed in a 1-2-3gage block, while the arm is at 30°, 60° and 90° respectively from the home position. Figs 3.34 and 3.35 show the spherical scan performed on the cast object, while the arm is at 60° and 90° respectively from the home position.

SI

Fig 3.31 Spherical scan for 1-2-3-gage block while the arm at 30"

51

El

Fig 3.32 Spherical scan for 1-2-3-gage block while the arm at 60

63

..........

........ u. ................. -------- -

E l

E l

Fig 3.33 Spherical scan for 1-2-3-gage block while the arm at 90"

E)

E l

Fig 3.34 Spherical scan for cast object while the arm at 60"

6 5 ^

·S

Fig 3.35 Spherical scan for cast object while the arm at 90°

W hen the spherical scan was performed, a top blank circle appeared with a radius of r = 0.8 B (see equation 3, and Fig 2.14) where B is the height of the scanned object. As the sensor's arm angle was reduced from 90°, as shown in Fig 3.33, to 30°, as shown in Fig 3.31, the blank circle shrunk.

64

3.6 Calibration

Based on the above scans, the percentage of noise points relative to the total points is close to zero on top scan, less than 0.5% on side scan and less than 2% on bottom scan. This noise is detectable when using image segmentation software [1] as, in most cases it represents isolated points. Accordingly, top, side and bottom scans of the object have been successfully performed.

From the actual calibrations, the results are acceptable as the error in Y-axis is ± 0 .2 8 9 mm [0.011 in], which represent ± one pixel in Y-direction and match the practical limitation. The error in Z-axis also matches the practical limitation, which is 0.381 mm [0.015 in] and represents ± one pixel. Due to the open loop in the motor controls, the error in X-direction does not match the practical limitation. It is ± 1.005 mm [0.04 in] (expected to be ± 0.354 mm [0.01325 in] which represents ± one pixel equal to ±0.304 mm [0.012 in] added to the motor resolution which is ± 0 .0 5 0 mm [0.00125 in]).

65

3.7 Comparison with Other Machines

Appendix F Technology Comparison Chart, shows tables for different types of scanners with their expected accuracies. By comparing the prototype to the line laser scanners, it Is easy to realize that the prototype has respectable results.

The above-mentioned table shows the results of the sensors as well as the complete line laser scanners. The accuracy of the sensors are far more better than those of any complete line laser scanner, as the distance for measuring accuracy Is less than one inch. The prototype has respectable resolution and accuracy compared to the complete line laser scanners, which have been Introduced by Cyberware as shown In the same table.

Comparison of the bottom scan results Is not applicable as the Idea Is new.

Finally, the advantage of accessibility and occlusion reduction makes the prototype unique In this area. The accuracy also can be Improved to match the state-of-the art machines.

66

Chapter 4

Conclusions and Future Work

The proposed laser scanning system permits scanning of aii sides of the object. T h e goals of the system are to allow for automated scanning for a wide variety of objects while minimizing the number of occlusions in the resulting scan data. From the results, the system provides scans on all sides of the object without the problems associated with reconstructing the surface from multiple scans, re registration of the datum, or the time consuming problems of manual scanning.

Due to the top blank circle resulting in the sphericai scan, the cylindrical scan is considered to have better surface information. However, the spherical scan can still be employed, as it is much faster with iess adjustment. The spherical scan could also be used in combination with cylindrical scanning for speciai purposes.

67

It is recommended for resolution improvement to have a better resolution CCD camera, as well as DC motors with feed back control. Less reflection can be achieved by using an antireflection coating on both sides of the plexiglass rotary table. By using a bigger size arm and rotary table as well as a better resolution sensor, the restrictions on the scanned object dimensions 127x127x76 mm [5x5x3 in] can be improved.

Future work would include a surface fitting algorithm applied to the scanned data as well as a stéréovision implementation. Automatic focus lenses can be employed with pre-set path to improve resolution as the high accuracy available in the market is attributed to close image capturing, which requires path planning. Additional constraints on the path planning algorithm must ensure that all surfaces being scanned are within the depth of range of the laser scanner and that the path has been optimized to reduce scan overlap.

68

References

[1] V.H . Chan, C. Bradley, G.W . Vickers, A multi-sensor approach to automating co-ordinate measuring machine-based reverse engineering. Computers in Industry, 44, (2001) [2] Y. Takeuchi, H. Shimizu, I. Mukai, Automatic measurement of 3-dimensional coordinate measuring machine by means of CAD and image data. Annals of the C IR P , 39, (1990) [3] O. Ozeki, T. Nakano, and S. Yamamoto, Real-time range measurement device for three-dimensional object recognition, IEEE Transactions on Pattern Analysis and Machine Intelligence, PAMI-8, 4, (1986) [4] R.A. Jarvis, A Perspective on range finding techniques for computer vision, IE E E Transactions on Pattern Analysis and Machine Intelligence, PAMI-5, 2, (1983) [5] D .D. Harrison and M.P. Weir, High-speed triangulation-based 3-D imaging with orthonormal data projections and error detection, IEEE Transactions on Pattern Analysis and Machine Intelligence, 12, 4, (1990) [6] H. - Y . Feng, Y. Liu, F. XI, Analysis of digitizing errors of a laser scanning system. Precision Engineering, Journal of the International Societies for Precision Engineering and Nanotechnology, 25, (2001) [7] F. Xi, Y. Liu and H.-Y. Feng, Error compensation for three-dimensional line laser scanning data. Int. J Adv Manuf Technol, 18 (2001) [8] J. M aver and R. Bajcsy, Occlusions as a guide for planning the next view, lEE Transactions of Pattern Analysis and Machine Intelligence, 15, 5,(1993) [9] J.J. Aguilar, F. Torres, M.A. Lope, Stereo vision for 3D measurement: accuracy analysis, calibration and industrial applications. Measurement, 18, 4, (1996)

69

[10] M.W. Cho, M.K. Kim and K. Kim, Flexible inspection system based on a vision guided coordinate measuring machine, Int. J. Prod. Res., 33, 5, (1995) [11] S. Son, S. Kim, K.H. Lee, Path planning of multi-patched freeform surfaces for laser scanning. Int. J. Adv Manuf Technol, 22, (2003) [12] K.H. Lee, H. Park and S. Son, A Framework for laser scan planning of freeform surfaces, Int J Adv Manuf Technol, 17, (2001) [13] S Motavalli and J. Valenzuela, A system for reverse engineering of prismatic parts using orthographic images. Int. J. Computer Integrated Manufacturing, 11, 2, (1998) [14] P. Saint-Marc, J. L. Jezouin, and G. Medioni, A Versatile PC-based range finding system, IEEE Transactions on Robotics and Automation, 7, 2, (1991) [15] D.-Y. Chang and Y.-M. Chang, A freeform surface modelling system based on laser scan data for reverse engineering, Int J Adv Manuf Technol 20, (2002) [16] R.P. Campion, D.R. Dye, P.J. King and R.G. Ormson, A multiple target system using laser ablation for multi-layer deposition. Vacuum, 47, 1, (1996) [17] R. Pito, A Solution to the next best view problem for automated surface acquisition, IEEE Transactions On Pattern Analysis And Machine Intelligence, 2 1 , 1 0 , (1999) [18] K. H. Lee, H. Woo and T. Suk, Data reduction methods for reverse engineering. The Int. J. Adv. Manuf Technol, 17, (2001) [19] M.A.G. Izquierdo, M.T. Sanchez, A. Ibanez and L.G. Dilate, Sub-pixel measurement of 3D surfaces by laser scanning. Sensors and Actuators, 76 (1999) [20] L. Sciavicco and B. Siciliano, Modelling and control of robot manipulators, Springer, ISBN 1852332212 (1999) [21] O. Ransen, AutoCAD programming in C\C++, Wiley, ISBN 0471963364 (1997)

70

Appendix A

Build the CIN Node (From CIN user manual, of the LabVIEW help menu)

To build CINs using Visual C++ Integrated Development Environment, complete the following steps; 1- From the LabVIEW program, generate (.c) file. 2- C reate a new Dll project. Select File » New » select W in32 DynamicLink Library. Project name should be assigned at this point. 3- Add CIN objects and libraries to the project. Select Project » Add To Project » File and select cin.obj, labview.lib, Ivsb.lib, Ivsbmain.def from the Cintools subdirectory and (.c) file generated from step 1. 4- Add Cintools to the include path. Select Project » Settings and change Setting For to All Configurations. Select the C /C ++ tab and set the category to Preprocessor. Add the path to the Cintools directory in the Additional include directories field. 5- S et alignment to 1 byte. Select Project » Settings and change Settings For to All Configurations. Select the C\C++ tab and set the category to C ode Generation. Select the Struct member alignment tab and select 1 byte. 6- Choose a Run-time Library. Select Project » Setting and change Setting For to All Configurations. Select the C\C++ tab and set the category to C ode Generation. Select Multithreaded DLL in the Use Run-time Library control. 7- M ake a custom build command to run Ivsbutil. Select Project » Settings and change Setting For to All Configurations. Select the Custom Build tab and change the Build command field as follows: "<the path to cintooIs>\ Ivsbutil" $(TargetName) -d " $ (WkspDir) \ $ (OutDir)" C hange Output file field to $(OutDir) $ (TargetName).lsb 8- Compile and Build All to generate (.Isb) file. 9- Load (.Isb) file to the CIN node in the LabVIEW program.

71

Appendix B

C Program for the CIN Node (Cylindrical)

/*

* CIN source file
*/

#include "extcode.h" #include<stdio.h> #include<math.h>

/*

* typedefs
*/

typedef struct { int32 dimSizes[2]; int32 argl[l]; }TD1; typedef TDl **TDlHdl;

CIN MgErr CINRun(TDlHdl varl, int32 *var2, float64 *Motor_l, fioat64 *Motor_3, float64 *Step);

CIN MgErr CINRun(TDlHdI varl, int32 *var2, float64 *Motor_l, float64 *Motor_3, float64 *Step) {

/* ENTER YOUR CODE HERE */
FILE* OUTDXF; FILE* OUTDAT; int32 i ; double X, y, z, X , Y , zl , Z , angz, angx ;

72

double pi = 3.1415926536 ;

OUTDXF = fopen("C:Test.dxf',"a+"); OUTDAT = fopen("C:Test.dat","a+");

angz = (float) *Motor_l * pi/180.0 ; /* z angle */ angx = (float) (*Motor_3 - 90) * pi /180.0 ; /* x angle */

i f (*var2 = 0)

{
^rintf(OUTDXF, "0\nSECTION\n2\nHEADER\nO\nENDSEC"); Ô)rintf(OUTDXF, "\nO\nSECTION\n2\nTABLES\nO\nENDSEC"); Q)rintf(OUTDXF, "\nO\nSECTION\n2\nBLOCKS\nO\nENDSEC");
}

for (i=0 ; i < 480 ; i++)
{

if ((*varl)->argl[(2)*(i)+l] !=0)

{
=(float) (*var2) * (*Step) - 2.5; y =(float)(188 - i)/90 ; z l= (float) 304 - (*varl)->argl[(2)*(i)+l]; X = (float) X - (z 1+4.0)788.0 ; z = (float)10*zl/(zl+252); X = X* C O S (angz) - y * cos (angx) * sin (angz) + z * sin (angx) * sin (angz) ; Y = X * sin (angz) + y * cos (angx) * cos (angz) - z * sin (angx) * cos (angz) ; Z = y * sin (angx) + z * cos (angx) ;
X

if((Z>0)&&(Z<=3.5)&&(X>= -2.5)&&(X<=2.5)&&(Y>= -2.5)&&(Y<=2.5)) Q5rintf(OUTDAT, $rintf(OUTDXF, fprintf(OUTDXF, ^rintf(OUTDXF,

{

"%f, % f, %f \n",X,Y,Z); "\nO\nSECTION\n2\nENTITIES\nO\nPOINT\n8\nO"); "\nl 0\n%f\n20\n%f\n30\n%f',X,Y,Z); "\nO\nENDSEC");

} }
if (*var2 = ((int)((float) 5/(*Step)) - 1)) ^ fprintf(OUTDAT, "EOF\n");

}

73

^rintf(OUTDXF, "\nO\nEOF\n");
}

fclose (OUTDXF); fclose (OUTDAT);

return noErr;
}

74

Appendix C

Full LabVIEW Program for Cylindrical Scan

CyllndricaLFinal.vi LL Snap in IMAQ Vision display acquires an image and displays it in an image window using the Low Level acquisition functions. A snap is appropriate for iow-speed or single-capture applications where ease of programming is essential. IMAQ Init is called to initialize the board. IMAQ Configure List configures the buffer list which contains one buffer. An image is created using IMAQ Create and wired to IMAQ Configure Buffer which configures the buffer in the buffer list. IMAQ Start starts the acquisition. IMAQ Get Buffer returns the image after it is acquired. This image is displayed in an image window using IMAQ WindDraw. IMAQ Close.vi is called to shut down the acquisition. This example is designed to acquire 8-bit images. The IMAQ PCI-1424 can acquire from cameras with greater bit depths. If you are using a camera which outputs 10-, 12-, 14- or 16-bit images, change the image type input of IMAQ Create to 16 bits. If you are using a camera which outputs color images, change the image type input of IMAQ Create to RGB Chunky. NOTE; You must have IMAQ Vision installed to run this example. Connector Pane IH f ti
Demo

Front Panel

75

For a description select Show VI InFo from the Windows menu.

Interface Name jmgO

Region of Interest

1^ W b W b abaooQ Hi32000
NOTE; You must have IMAQ Vision Installed to run this example.

Array

Data is not available, as the program is not running

slze(s)

Numeric Array 2

M otor#!

I
Motor# 3

kP-OO
Step x+y

II

Data IS not available, as the program is not running

boo

76

Block Diagram aoooD naD oooacnaonnnnnnnnnn 0 o n e

0 0 0 go on 0 0

oooooaooooonnoaooaooaoaooaoaoaanaaoi

ie jc n o fin te fa t
juffefWurfiefl-lialll

Inis saiiffe work for 8 bits pict^e, to use t wit) 16btspirtires M l # the W t m e W h t t ie IMAQ Create,vi to IStiits

s

--

H %

o L o o o o o D o o o n i z o o o o o o n n n o o o D Q o o o a o a a o o o o o o a o o o D O N o N o o o o N o n o o o 'ô o

77

inaaDaDnnaaaaoaog[}DDDnnananoaDgaotioaooog<0[0,,3] aDDnaaannnaoaDaDaaQDaDDaaaoDoaDonaDDonD

M o d *

start

B--
start

 3 6 0 , 0 0

3 9 1 . 0 0

GDonongnnnDnnoDDDgnogDonganonnggDgggggggngaggagggnngnnnDgnnnnogggggggDnnnggDgnaDg oïïïï

78

T ru e

H

4 False f

79

^ O O O O O a O O O O O D O Q O O O O O O O D O O O O D O C d 1[0,,2] OOOOOOOOOOOOOaOOOOODOOODOOOOOO

load Mode Mode

Load

iLOOOl

HO.OOl

booamoooooonnnnnhHHUHHoooooooooooonooooonooooDooooaomaooamDooooao

80

ooaoooaooaooooaooooaooooooaciQq^g^i] 2 ^ ^ ITBbboaoooocioüaB'büBObübdüdQOM H T B I

im

1

 a 

dB

  ÛÙb

^ n n r Bi II u u u "g o o o a o o o o o o o o o o o a o o o D o o o o D D O - 0 # o # D o O M # P O O O O Q M

81

jDoannnnaDDODDonanDaoooannnaaaDDnnnnnogDii^fo

3]^|oBnDDaDDDnaDDDnnDDgDnnnDDnDDDnnonngaDan

m L o a d
M o d e

t2 0 0 .Q O l

f l O g p g O D o g DJ_g.g g O O O a g o a g g g o n n g o g n o B g o g g n g o n n n o g g g o a g o o o g g g n n g o o g o n o g o g g n o g n g g n n g n n n g g o i

82

uDanpganaoanaoiiaoQ oabDnS'tianùlltiadflliaailinT'

Lud

lu d /5\
StaH

Load Mode

Load

1000

 3 6 0 , 0 0

3 9 1 , 0 0

 DDDDDDDDnD

ODDODDDgPDnDDOnDDDODDDDDDDDPP^

0 0 0 0 0 0 0 0 0 0 Ou

83

Appendix D

C Program for the CIN Node (Spherical)

/*
* CIN source file
*/

#include "extcode.h" #include<stdio.h> #include<math.h>

/*

* typedefs
*/

typedef struct { int32 dimSizes[2]; float64 argl[l]; } TDl; typedef TDl **TDlHdl; CIN MgErr CINRun{TDlHdl varl, int32 *var2, float64 *Motor_3, float64 *Step); CIN MgErr CINRun{TDlHdl varl, int32 *var2, float64 *Motor_3, float64 *Step) { /* ENTER YOUR CODE HERE */ FILE* OUTDXF; FILE* OUTDAT; int32 i ; double X , y, z, X , Y , zl , double p i = 3.1415926536 ;

Z

, angz , angx

;

OUTDXF = f o p e n ( " C : T e s t . d x f " , " a + " ) ; OUTDAT = f o p e n ( " C : T e s t . d a t " , " a + " ) ;

angz = (float)

(*Step) * (*var2) * pi / 180 ;

/* z angle */

84

angx = (float) if
{

(*Motor_3 - 90) * pi / 180 ;

/*

x angle */

(*var2 == 0) fprintf(OUTDXF, fprintf(OUTDXF, fprintf(OUTDXF, "0\nSECTION\n2\nHEADER\nO\nENDSEC"); "\nO\nSECTION\n2\nTABLES\nO\nENDSEC"); "\nO\nSECTION\n2\nBLOCKS\nO\nENDSEC");

}
for (i=0 ; i < 480 ; i++)

{
//x = (float) (*var2) * (*Step) - 2.5; y = (float)(188 - i ) / 9 1 ; zl= (float) 3 04 - (*varl)->argl[(2)*(i)+1] ; z = (float)10*zl/(zl+666); / / X = (float) 10.00 * z / 8.00; X = 0.00 ; X = X * cos (angz) - y * cos (angx) * sin (-angz) + z * sin (angx) * sin (angz) ; Y = X * sin (-angz) + y * cos (angx) * cos (angz) - z * sin ( · angx) * cos (angz) ; Z = y * sin (-angx) + z * cos (angx) ;

if

( (Z>

0 .02 )& & (Z < = 3 .0 )) " % f , %f , %f \ n " , X , Y , Z ) ; "\n O \n S E C TIO N \n2\nE N TITIES\nO \nPO IN T\n8\nO "); "\n lO \n % f\n 2 0 \n % f\n 3 0 \n % f" , X , Y , Z ); "\nO\nENDSEC") ;

{
fp rin tf(O U T D A T , fprin tf(O U T D X F, fprin tf(O U TD X F, fprin tf(O U T D X F, } }

if

(*var2

>=

( ( i n t ) ( ( flo a t)

3 6 0 /(*S te p ))

-

1))

{
fp rin tf(O U TD A T , fp rin tf(O U T D X F , } "EO F\n"); "\nO\nEO F\n" ) ;

fc lo s e fc lo s e

(OUTDXF); (O UTDAT);

retu rn

noErr;

}

85

Appendix E

Full LabVIEW Program for Spherical Scan

SphericaLFinal.vi LL Snap In IMAQ Vision display acquires an image and displays it in an image window using the Low Level acquisition functions. A snap is appropriate for Iow-speed or single-capture applications where ease of programming is essential. IMAQ Init is called to initialize the board. IMAQ Configure List configures the buffer list which contains one buffer. An Image is created using IMAQ Create and wired to IMAQ Configure Buffer which configures the buffer in the buffer list. IMAQ Start starts the acquisition. IMAQ Get Buffer returns the image after it is acquired. This image Is displayed In an image window using IMAQ WindDraw. IMAQ Close.vi is called to shut down the acquisition. This example is designed to acquire 8-bit images. The IMAQ PCI-1424 can acquire from cameras with greater bit depths. If you are using a camera which outputs 10-, 12-, 14- or 16-blt Images, change the image type input of IMAQ Create to 16 bits. If you are using a camera which outputs color Images, change the image type input of IMAQ Create to RGB Chunky. NOTE: You must have IMAQ Vision Installed to run this example. Connector Pane
Demo

Front Panel

86

For a description select Show VI Info from the Windows menu.

In te rfac e Name
tmqO

Region of interest

515^------ 1 Hjo_____1 B132000 1 Bb2ooo 1
NOTE: You must have IMAQ Vision installed to run this example.

Array

Data IS not available, as the program is not running

Numeric Array 2

Motor# 3

^|0>00
s te p

II

Data is not available, as the program is not running

ib.oo
x+y

II ||

Ib-oo
Numeric 2

1 ^

II 87

88

m m

oooooDODOOOOOonooDOoaDODOODaooDnoonaQOüooonnnnnnoanDnüonaoonoooaaonnoonaaQnooaooaaoo

 GDDnai nabaènDDnDaaDDDODaDDGnnDDociDDDDDDnDDPoanigDDaDanDDDDmDDni

T M l

S

1

sïq 910) !*'3)6So ( M *11 u,

is 3 jq :* ls j!q 9 i ip js s n o i'a ii)]!d s |]9 J 0 jg |m 8 |iiiiK S ^

itis

D IM

aOOODOOn nCOOOGOnGOOGGOGGOOOQDG

D D D D P ap D G n o o o n n an o P D an D D D O P D ii

" 0 ]I tW gonooaoannoaaaG noG oaaG ooooanG O O O O G O ooi looD aoooonaoG O oooaooD nnooD nnooaG O O O O O G O O fe
LUBJBb IQ

>|00|a

68

dflniirid'aônnnnnDaonanoDa'ïïnnDO O onnpaaDanaaPPPPOOPP°o°°POPP'

m

l ooonoooooooooDOOOODOoonooQooooaoooncDn ô'HlZ''l)J OWü

D D O D aaG D D D nnD nDaGDQaanaDnnnaanannDannnni

T ru e

k

F a ls e k

2 2 2 S 2 2 S S 9 8 S 2 S S S 2 2 2 S 2 S S 2 2 2 2 2 ^ S ^ S 2 2 2 Ü S ^ £

90

I   D  Q  0 0 0 0 0

.p 0  0 g_o   0  0  0 0 g o_ g^ l[Q,,2l K ^ ° ° 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 b o n ta û b B B BTH

r o B B T O H

;
[Oi = ^ 0

Decelerate!

n o n n i l n o a n o n n n n m t r r n n n n n n o n o a a o n a a a o g a 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 " 0 0 0 0 # 0 0 0 0-0 0-Q

91

Z6

0 0 0 0 0

ooômoooooDooooaoaDooooDoooôDoooaoooooDOEmiaoDooQOOQo M aW W u

                      O D D O O O O D ? k " 0] T ^3            0_D 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0

6

D O O n n O g D D O P P n n n t i n P n D n n D D D I i n D D D D D D D D D t l D n D DDD

dp

O O O O O n O O O O O O O HD

I

8 1 ? J 9 |9 2 3 C

m m -

fl a a n B 0 D q.a Q J . Q Q D DO_0..D _Q _0 o  n c.g

0 0 0 0 0 0 0 0 0 o w W lZ 'O lz W o D O o a n o o n o o a D o n c n n n n n o ' n n n n n n n o n n D n o n n~5 a

Appendix F

Technology Comparison Chart
Downloaded from "http://home.att.net/~castleisland/scn_08.htm"

is b y n o m e a n s a co m p le te listing. There are many more instruments available in each technology category and from each vendor, and from many additional vendors, as well. Entries were selected to illustrate the general specifications of a technology, or to show the upper and lower bounds of a vendor's offerings. Use the commercial directory pages to explore categories of interest in depth. Representative; Model Vendor Color ; Speed ? Price ! Range!

T h is

Technology

Volume

Accuracy

1
Mechanical Arm Mechanical Arm Mechanical Arm Mechanical Arm ; Faro 1Technologies

Mechanical Touch Probe
FaroArm Advantage FaroArm Platinum MicroScribe ' G2 MicroScribe j G2LX 0.001 inches 0.005 inches Not Applic Not Applic Manual $19,900; operations : Manual operations Manual $3,495 operations j Manual $5,495 operations ;

|

4 feet 12 feet 50 inches (1.27 m) 66 inches (1.67 m)

j Faro ! Technologies 1 Immersion ;
! Immersion [

0.015 Not inches Applic (0.38 mm) ; 0.012 Not inches Applic (0.30 mm) i Minimum scan pitch ; Not Applic of 0.002 inches Minimum scan pitch : Not of 0.002 Applic inches

Guided Probe

Roland DGA Corp.

PIX-4

6 X 4 X 2.4 inches

No info $1,995 I provided ;

1
Guided Probe Roland DGA Corp. | PIX-30 1 1 1 2 x 8 x 2 .4 inches

No info $3,495 i provided i

Strengths

accuracy; low-cost instruments avail.; measures deep slots, pockets; not affected by color or transparency

.Weaknesses! rn.ànual operation; slow for complex surfaces; can distort soft objects

94

I j
Technology Representative Model Vendor
... . . . . . . .. j 1 !

Volume

Accuracy

Color

? ...

i Speed I

Price I Range I

Laser Line Scanner
Not Applic., Measuring head; 3.5 inches stand off distance Not Applic. Measuring head; 7.83 inches stand off distance
+ /-

Laser Meas. Head

i
i

Laser Design, Inc.! RPS-120
1
i

0.00025 in acc.; 0.001 No in resolution +/- 0.001 in acc.; 0.0037 in resolution

14,400 points / sec

-

Laser Meas. Head

!

Laser Design, Inc.! R PS-450

No

1 I j KLS 51
|

14,400 points / sec

-

Laser Meas. Head

KREON Technologies

!

Î

Not Applic. Measuring head; Mtd to resolution No Arm or Mach ^ 42 microns tool / Triangulation ; angle 30 deg Not Applic. Measuring head; Mtd to ; resolution Arm or Mach : 120 microns tool / Triangulation angle 30 deg

Up to 20 000 points/sec I 1 !
1 1

: Laser Meas. : Head

KREON | Technologies

KLS171

No

Up to 20 ; 000 points/sec

!
; Laser Scanner j / Aux. Video

Cyberware

Model 15 Desktop Scanner

Resol: X,Y: 9.84 (X) X 0.012; Z; 5.91 (min Y) x 0.002 to Yes 2.95 (Z) 0.008 inches (inches) Resol: X: 0.01 to 0.04;Y: 0.028; Z: 0.004 min (inches) Resol: X: 0.19;Y: 0.08; Z: 0.019 min (inches)

14,580 points / sec.

-

;

i Laser Scanner 1 / Aux. Video
i

Cyberware


39 (X) X Model Shop 10.25 (min Y) 3D Scanner X 11.82 (Z) 3030RGB/MSi inches Cylindrical FOV; Depth: 47 inches; Height: 79 inches

Yes

4,580 points / sec.

-

1

i Laser Scanner 1 / Aux. Video

Cyberware

Whole Body 4 color 3D Scaner

Yes

60,000 points / sec.

-

95

Laser Scanner / Aux. Video

Minoita

Vivid 700

12.8 x 2.8 to 43.3 X 43.3 i inches

200X200 i X256 Yes points (x,y,z resoi.) +/- 0.008 mm acc.; j +/- 0.008 mm prec. ; i Yes

160,000 points in 0.6 sec. 307,000 1 pixels in 2.5 secs using Fine mode and : tele, lens

1

Laser Scanner Minolta / Aux. Video

i Vivid 910

111 X 84 X 40 mm (tele lens) to 1200 X 903 X 400 mm (wide lens)

1

Laser Scanner

Nextec

Table Top Hawk

Linear travel: Resolution:; 240 mm (9.4 ! 1 micron; Total inch); measuring | No Scanning accuracy: range: +/- 5 10 microns ; mm (+/-0.2 (1 sigma) i inch) 5 mm resol.; +/15 mm 4 to 400 m accuracy range x 80 (averaged) deg vert x 360 deg Rot. I or +/- 25 mm single shot 5 mm resol.; + / 5 mm accuracy (averaged) or +/-10 mm single shot 0.008 inches resol. ;

40 points j per sec j

! 1 Laser Scanner / Aux. Video Riegi LMS-Z210I

12,000 points / sec; up to j Yes, j Optional! 15 deg / j sec for j horiz scan |

; ; | No

Laser Scanner

Riegi i 1
j

LMS-Z420Î

2 to 800 m range x 80 deg vert x 360 deg Rot.

12,000 points / sec; up to ; 15 deg / sec for horiz scan ; No info provided

Laser Scanner

Roland DGA Corp.

! LPX-250 i LM600 System

10 in (dia.) x 16 in (ht.) 600 X 160 X 165 mm

No

!

$9,995

i Laser Scanner ! ShapeGrabber

1 Accuracies I No to 0.03 mm;

15,000 to Î 100,000+ ; points/sec ;

fctrengths 1

non-contacting: fast digitizing of substantial volumes; good accuracy and resolution; color capability available '

|A/éaknessesj possible limitations for colored or transparent surfaces; laser cautions apply j

96

Technology

Representative] Model Vendor

Volume

Accuracy^

Color ^ Speed ?

'

Price 1 R an g e

Other Tvnes of La.«îAr
50 microns resoiution on axis of 1.6m W x 1 .4 turntable; No mH 70 microns at far end of meas range 25 at near end to 70 microns at far end of meas range

1 j Laser time of flight Cailldus Precision ' CT900 j Systems GmbH

4000 points / sec

-

1 Laser time of flight Callidus Precision ' CT180 ! Systems GmbH 350 mm W x 375 mm H

No

4000 points / sec

-

j Automated Laser tracking i Precision, inc. Smart Irak j 6D 40 m range Static acc; 0.001 inches at 16ft No

Up to 2000 meas / second tracking a moving target

-

Strengths W eaknesses

non-contacting; fast digitizing of substantial volumes; good accuracy and resolution; trackers are very precise; iarge stand-off distance for large objects possible limitations for colored or transparent surfaces; trackers are fairly slow and may req targets; laser cautions apply ;

97

............ .......... -.-........- - ---- . -- ...... ........ ------------------------------------------- -- 1Color i Price Representative! Speed Accuracy; ? Volume Model Technology 1 Vendor ! Rangel Trackina Svstems. Other Than Laser Tvoes
0.2 mm mean No volumetric ; acc

iillii
LED-based tracking LED-based tracking ! Metronor j

Bouider j Innovation Group, : 3D Creator i Inc.

1 m Sphere

300 points / second

0.02 to 0.1 : Solo | Measurement 10.5 m range Î mm meas. ; No uncertanty : System 1.3 mm rms; 2.1 500 mm cubic j mm to 95% volume confid. level

Manual operations! 22 to 45 i points / sec depending; on number of ! sensor coils

ij
Magnetic tracking Northern Digital Aurora

No

F ' Strengths

- ; can digitize hidden points in some cases; can be used to track motion of many points simult.; magnetic devices can meas outside line of sight; not affected by color, transparency or surface quality :

' ! requires targets or contacting probes; smaller volumes; lower accuracy; slow Weaknesses] for complex surfaces, ; , /Cv , . ;

98

TI ' 1 ,........ ...... Technology | Representative! M odel V endo r i Color i

........ Price R ange 

Volum e

Accuracy

Speed

?

Structured-liqht and Broadband SniiniA SvstP.mfi Arm-mounted structured white light scanners Arm-mounted structured white light scanners Moire white light pattern Moire white iight pattern Moire white light pattern Moire white light pattern j GOM mbH ATOS II



i

!;..../' ' ! 5 X 4 X 4 to 67 X 53 X 53 inches 6 X 6 X 4 to 80 X 80 X 80 inches 401 X 321 mm i 1140x910 mm 0.003 to 0.039 inches 0.003 to 0.040 inches No 1.3 million points in 7 secs. 4 million points in 8 secs. 1.3 million points in 0.7 sec. 1.3 million points in 0.7 sec. 0.3 million points in 0.4 sec. 0.3 million points in 0.4 sec.

: I

GOM mbH

ATOS III

No

1 Inspeck 3D Mega Capturer 11/ Small Field 3D Mega Capturer II / Large Field

j

X&Y: 0.3 mm; Z: 0.4 Yes mm resol. X&Y: 0.9 mm; Z: 1.0 Yes mm resol. X&Y: 0.6 mm; Z: 0.5 Yes mm resol. X&Y: 1.9 mm; Z: 1.0 Yes mm resol.

j

Inspeck

j Inspeck |

Capturer 11/ 1352 X 264 Smaii Field mm Capturer II / Large Field 1195 mm
X

1

Inspeck

896

G en ex Projected white Technologies, light patterns Inc. 1 ! 1 Moire-coded white iight triangulation i Steinbichier } Optotechnik i GmbH

Rainbow 3D j Camera i

Several customizable models offered with capacities from approximately! a 3 inch cube to more than a 10 inch cube.

Accuracy to 25 microns (0.001 in)

Yes

Captures 768 X 576 pixel image (442,368 ' ! pixels) in < 1 sec.

j Comet

Not specified; Accuracy 2 million to +/- 20 points per microns view

No

Not sped led

-

Strengths

very fast; color available; no laser safety precautions

W eaknesses- somewhat lower accuracy

99

Technology

Representative Model Vendor

Volume

Accuracy;

Color i Speed ? !

i

Price Range

i

Internal Viewina Svstems
1024X 1024 X 1024 pixel : Not ; image; 0.4 I Applic mm resol; 1 0.04 mm acc.

X-ray computed tomography

Aracor

Konoscope 160/200

200 mm dia

No info provided |

X-ray computed tomography

Aracor

ICT 2500

2048 X 2048 Not pixels; 2500 mm dia 1 3mm resol; j Applic 0.25 mm acc. 1

No info j provided i

X-ray computed tomography

X-ray computed tomography

20 line pairs/ mm max i spatial resol; density 600 mm dia; j resol: Bio-Imaging Actis 600/450 unlimited 0.1%: can Research (SIR) height detect 150 micron I flaw, 200 i micron void and 1 10 micron ! crack. ! 16 inches in HYTEC Sensors { 0.005 height; cross i & Imaging Group, | Flash CT inches sectional areal Inc. 1 resolution undefined I i
I

I Not ! Applic :

14 min for scanning 600 mm dia object

I 200 M B / j minute of ; volume i data

J

Not Applic

Destructive / Crosssectional Scanning

Î CGI, Inc. I CSS-300 7x5x9 inches

+ A 0.0008 ! inches (0.0005 to ; 0.010 No inches layer thickness) j + / - 0.0008 inches (0.0005 to 0.010 inches layer thickness)

2 to 3 hours

j

-

j
1 No
\

Destructive / Crosssectional Scanning

CGI, Inc.

CSS-3000

14x 16x 15 inches

No info provided ! !

-

| 

100

Strengths

internal viewing and sample preservation f o r C T

o

g , ! Price 1 Range

W eaknesses radiation safety; sample destruction for CSS; can be slow ' " ^  .............. 1 Representative! Color j Model j Volume Speed Technology 1 Accuracy | ? 1 i Vendor i

101

