NOTE TO USERS

This reproduction is the best copy available.

UMI
Reproduced w ith permission of the copyright owner. Further reproduction prohibited without permission.

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

ADAPTIVE POWER LINE HARMONIC DETECTION FOR ACTIVE FILTER APPLICATIONS
By
WEIDONG LrU (MEng, Northeastern University, China, 1991) (BSc, Northeastern University, China, 1988)

A thesis presented to Ryerson University in partial fiilfillment of the requirements for hie degree of Master of Applied Science in the Program of Electrical and Computer Engineering

Toronto, Ontario, Canada, 2004 © WEIDONG LIU 2004

R Y ER SO N

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

UMI Number: EC52961

INFORMATION TO USERS

The quality of this reproduction is dependent upon the quality of the copy submitted. Broken or indistinct print, colored or poor quality illustrations and photographs, print bleed-through, substandard margins, and improper alignment can adversely affect reproduction. In the unlikely event that the author did not send a complete manuscript and there are missing pages, these will be noted. Also, if unauthorized copyright material had to be removed, a note will indicate the deletion.

UMI
UMI Microform EC52961 Copyright 2008 by ProQuest LLC. All rights reserved. This microform edition is protected against unauthorized copying under Title 17, United States Code. ProQuest LLC 789 E. Eisenhower Parkway PC Box 1346 Ann Arbor, Ml 48106-1346

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Borrower's Page

Ryerson University requires the signatures of all persons using or photocopying this thesis. Please sign below, and give address and date.

Name

Signature

Address

Date

m

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Abstract

Adaptive Power Line Harmonic Detection For Active Filter Applications WEIDONG LIU Master of Applied Science of Electrical and Computer Engineering Ryerson University, Toronto, 2004

Tlie objective of this thesis research is to develop an efficient method for accurate detections of power line harmonic distortions for the control of active filters. The research has achieved its objective with four significant results. First, an adaptive power line harmonic detection method is developed, which is based on the findings of extensive research in the areas of inside and outside of power electronics controls. Second, a simple and practical formulation o f the adaptive harmonic detection method is developed, which is simplified significantly from the original complex design formulations for noise cancellations. Third, vigorous

verifications o f effectiveness o f the adaptive detection method using computer simulations are carried out, which cover the steady state operations, the dynamic operations, normal power line conditions, non-ideal supply and load conditions, etc. Fourth, experimental verifications o f the accuracy o f the adaptive detection method are conducted, which cover typical distorted power line conditions for normal and unbalanced operations. For illustration, this thesis

presents carefully designed computer simulation and experimental case studies that cover a wide range of power line conditions.

IV

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Acknowledgement

The author wishes to express his deep gratitude to his supervisor Professor R, W. Y. Cheung for his expert supervision. The author highly appreciates the valuable advices, guidance, and encouragement from Professor Cheung through tliis thesis research.

The author also wishes to thank Professor B. Wu for his great help and support.

The author would like to convey the warmest thanks to his family and friends, especially Wade, for their support and encouragement

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Contents

Introduction

1 1

1.1 1.2

Background of active power line filtering operations Introduction of contents in this thesis

3

Power Line Harmonics Control Methods

6

2.1 Basic concept of active power hne filtering 2.2 Conventional detection methods for active filters 2.2.1 Instantaneous reactive power detection Synchronous detection

7 9 ll' 14 15. 18
20
21

I
I

2.2.2

2.3 Concept of adaptive noise detection 2.4 Concluding remarks
Adaptive Harmonic Detection Method for Active Filter Controls

3.1 Adaptive harmonic detection algorithm 3.2 Application of adaptive noise cancellation algorithm for hannonic detection 3.3 Uncorrelationship between u and Uomp and between 4 and icomp 3.4 SimuHnk model for adaptive noise cancelling algorithm 3.5 Concluding Remarks

27
29

31 32

I

4

Effectiveness of Adaptive Harmonic Detection Method for Control of Active Filter 33

4.1

Verification using a square wave with known harmonic distortion 4.1.1 Square wave in phase with reference signal

35 35 36 37 37 38 39

4.1.2 Square wave and reference signal not in phase 4.1.3 Square wave with changing amplitude 4.1.4 Performances study with different values of performance factor /i.

4.2 Modeling of power electronic loads for active filtering study 4.2.1 Rectifier with RL load as harmonic source on power line

VI

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

4.2.2 4.2.3

Rectifier with RLC load with higher harmonic injection on power line Unbalanced load as a combination of rectifier and single-phase loads

40 40 41

4.3 Verification o f adaptive harmonic detection method for steady state operations 4.3.1 Harmonics fiom rectifier RL load with normal or unbalanced line voltage 4.3.2 4.3.3 Harmonics tinm rectifier RLC load with unbalanced line voltage Harmonics from rectifier load with unbalanced single-phase loads

42 44 46 47 48 49 50 52

4.4 Verification of adaptive harmonic detection method for dynamic operation 4.5 Comparison with coiiventional detection methods 4.5.1 4.5.2 Comparison under normal power line voltage Comparison for unbalanced power line voltage condition

4.6 Concluding remarks

5

Experimental Verification of Adaptive Harmonic Detection Method

53

5.1 Hardware DSP implementation of adaptive harmonic detection 5.1.1 5.1.2 Digital Signal Processor Control Circuit Active filter power circuit

54 54 58 59 59 60 61 62 64 66 66 68 70

5.2 Software DSP implementation of adaptive harmonic detection 5.2.1 5.2.2 5.2.3 5.2.4 5.2.5 Software setting for analog-to-digital conversion Computation of fundamental power line current Updating weights for adaptive harmonic detection PWM generation Flow chart for DSP software control

5.3 Experimental verification of the adaptive harmonic detection method 5.3.1 5.3.2 5.3.3 5.3.4 RL rectifier load (Case study 1: moderate power line harmonics) RLC rectifier load (Case study 2: more power line harmonics) RC rectifier load (Case study 3: increased power line harmonics) Unbalanced distorted load (Case study 4: unbalanced power line harmonics) 5.4 Concluding remarks

72 74

vu

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

6

Conclusion

76

6.1 6.2 6.3

Major research work completed Major research contributions Future work

76 78 78

Bibliography Appendix A Appendix B Appendix C Simulation Models for Two Conventional Detection Methods Simulation Results of Two Conventional Detection Methods DSP Software Codes for Adaptive Harmonic Detection Method

80 85 87 93

viu

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

List of Figures
Figure 2.1 Figure 2.2 Figure 2.3 Figure 3.1 Figure 3.2 Figure 3.3 A simple circuit block diagram for illustration of active filtering or-/3 coordinates transformation Block diagram for adaptive noise cancellation adaptive linear combiner The adaptive compensator Application of adaptive noise cancellation for power line harmonic detection Figure 3.4 Figure 4.1 Figure 4.2 Model of adaptive noise cancelling algorithm Verification of harmonic detection using a square wave (a) In-phase fundamental component (b) total harmonic plus out-of-phase fundamental component Figure 4.3 Figure 4.4 Figure 4.5 Figure 4.6 Figure 4.7 Figure 4.8 Figure 4.9 Figure 4.11 Harmonic detection of a square wave with changing amplitude Output of the adaptive filter with yU= 2x 10'^ Output of the adaptive filter with fi= 10"'* Active filtering of harmonics generated by rectifier with RL load Active filtering of harmonics generated by rectifier with RLC load Active filtering of harmonics generated by unbalanced nonlinear loads Detection for rectifier RL load under normal line voltage Detection for rectifier RLC load with non-ideal line voltage * 37
38 38 28
12

F F F ï I I I I
1

16
21

25

31 36 36

40 40 41 42 44 45 46 48 55 57 59 61 64 65 67

Figure 4.10 Detection for rectifier RL load under unbalanced line voltage Figure 4.12 Detection for three unequal single-phase loads and a rectifier load Figure 4.13 load current with changing amplitude Figure 5.1 Figure 5.2 Figure 5.3 Figure 5.4 Figure 5.5 Figure 5.6 Figure 5.7 Block diagram of the active filter Block diagram of DSP TM320LF2407 Block diagram of the software Diagram of buffer at step n and step n+1 DSP connections to the inverter of the active filter Flow chart for the adaptive control of active filter Experimental results for Case Study 1

IX

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Figure 5.8 Figure 5.9 Figure 5.10 Figure 5.11 Figure 5.12 Figure 5.13

Simulation results for Case Study 1 Experimental results for Case study 2 Simulation results for Case study 2 Experimental results for Case study 3 Simulation results for Case study 3 Experiment results for Case study 4

68 69 70 71 72 73 74 86 86

Figure 5.14 Simulation results for Case study 4 Figure A1 Figure A2 Figure B1 Model o f instantaneous reactive power method Model of synchronous detection method Detection results of rectifier RL load using instantaneous reactive power method Figure B2 Detection results of rectifier RL load using synchronous detection method , Figure B3 Figure B4 Detection results of unbalanced load using instantaneous reactive power method Detection results of unbalanced load using synchronous detection method Figure B5 Detection results of rectifier RL load using instantaneous reactive power method with unbalanced power line voltage Figure B6 Detection results of rectifier RL load using synchronous detection method with unbalanced power line voltage Figure B7 Detection results of rectifier RLC load using instantaneous reactive power method with unbalanced power line voltage Figure B8 Detection results of rectifier RLC load using synchronous detection method with unbalanced power line voltage

87

88

88

89

90

90

91

92

X

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

List of Tables

Table 4.1: Table 4.2 Table 4.3 Table 4.4 Table 4.5 Table 4.6 Table 4.7 Table 4.8

THD (%) THD (%) THD (%) THD (%) THD (%) THD (%) THD (%) THD (%)

43 44 46 47

50 51 51

XI

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Chapter 1 Introduction
Ideally the electrical supply voltage should be a sine wave of 60 Hz in North America. However, the voltage of some power supplies may considerably depart from the ideal condition due to disturbances on the power line system feeding these supplies. The

disturbances may be caused by the nature such as lightning or by non-linear loads such as large power electronic equipment, for example high power electric drives [1-3]. The

naturally occurred disturbances are usually transients that can be suppressed by protective devices such as surge arresters, and these disturbances usually last for a short duration. On

the other hand, the disturbances caused by non-linear loads will stay in the supply system as long as the non-linear loads are operating. These disturbances can cause abnormal

operations of neighboring equipment or even damage them. Also the disturbances can affect the operation of the equipment that originally creates the disturbances. An objective of this

thesis research is to investigate methods for elimination of these disturbances on the power hne.

1.1

Background of Active Power Line Filtering Operations

This thesis research has found that active power filter can effectively eliminate the harmonic disturbances caused by non-linear loads on the power line. An active filter is basically a

power electronic inverter that, if operates properly, can inject equal-but-opposite amount of compensating harmonics into the power line to cancel the original harmonics [1, 5, 8]. The

focus of this tliesis research is to increase the harmonics elimination capability of active

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

power line filters by improving the accuracy of their harmonic detection ability particularly for real (non-ideal) industrial systems.

An active filter circuit basically consists of the power inverter circuit and a control circuit. The common operation of the active filter is: first the harmonic-detecting unit in the control circuit samples the instantaneous waveform of the power-line voltage and current and then computes the required compensation current. Second, based on the computed compensation Third, according

current, the control unit generates firing signals to drive the inverter circuit

to the firing sequence, the inverter generates the compensating currents and injects them into the power line to cancel its harmonic distortion. This thesis will detail the hardware and

software implementation of the power circuit and the control circuit of the active power line filter.

The concept for the active pov/er filter operation is straight forward that involves two basic steps: measuring the harmonics in the power line, and driving the inverter to cancel them. In practice, however, it is difficult to eliminate all harmonics in the power line completely. One major difficulty found in this thesis research is the inaccurate detection of changing power line harmonics by the conventional detecting methods, due to the interaction of the active filter and the power electronic equipment that generates the original harmonics. This thesis * research has developed an accurate, adaptive harmonic detection method for active filter applications.

Harmonic detection is a very important step for the compensation of power line harmonics. If harmonics are not detected accurately, he power line can be eiüier under-compensated or over- compensated.

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Conventionally, harmonics have been detected and controlled by using frequency-domain compensating method and time-domain compensating metliod. There have been many methods proposed for the detection of harmonics in both frequency-domain and time-domain [6-8]. However, the applications of the existing methods ate very limited because of the restrictions and assumptions made during the development of the theory. Therefore, their

performances vary depending on the mains conditions and power electronic loads. Some methods work \yeU only when the mains voltage is in ideal condition. Others can only deal with certain types of power electronic loads.

In this thesis, an adaptive harmonic detection method is developed to overcome the abovementioned problems. This method adapts very well to the changes of loading and line conditions and provides accurate detections of the power line current distortions.

1.2

Introduction of Contents in This Thesis

The following provides an introduction of the chapters in this thesis.

Chapter 2

presents the concept and methods for the control of power-line harmonics using active filters. The focus of tliis chapter is first to discuss the research findings on state-of-the-art active filtering control methods, and second to present a novel approach for active filter control based on adaptive noise cancellation theory. This theory, which was originally developed for noise signal processing, is applied by this thesis research for the control of the power line active filter. This chapter presents the conventional harmonic detection methods, both in

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

frequency domain and in time domain. insufficiency for the conventional metiiods.

Also this chapter identifies areas of

Chapter 3

presents the adaptive harmonic detection method for the control of active filters. The focus of this chapter is to detail the adaptive harmonic detection algorithm, and to apply this algorithm for the active filter control. The adaptive harmonic

detection algorithm is developed based on the theory of adaptive noise cancellation.

Chapter 4

first presents a vigorous verification of the adaptive harmonic detection method using a square wave current of known harmonic distortion. Second, this chapter verifies the effectiveness of the adaptive detection method for steady state operations under typical power Hne conditions including fine distortion caused by rectifier carrying different loads. Third, this chapter verifies the performance

o f the adaptive detection method for a dynamic operation where two additional rectifier loads are switched in. Fourth, this chapter demonstrates that the

adaptive detection method performs better than two well-known conventional detection methods particularly under abnormal power line conditions.

Chapter 5

provides the experimental vérification of the adaptive harmonic detection method for the control of active power fine filters. This chapter demonstrates

that the adaptive method is successfully implemented using state-of-the-art digital signal processor (DSP). This chapter presents the details of the hardware and the software implementations of the adaptive harmonic detection control. This chapter also presents four case studies; three for typical distorted power Une

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

conditions, and one for unbalanced power line condition. Tlie objective of these case studies is to demonstrate tlie effectiveness of the adaptive harmonic detection method for both balanced and unbalanced distorted power line conditions. demonstration. Experimental results and simulations are provided for the

Chapter 6

presents the conclusion of this thesis research and the future work in active power line filter controls.

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Chapter 2 Power Line Harmonics Control Methods
This chapter presents the concept and methods for the control of power-line harmonics using active filters. The focus of this chapter is first to discuss the research findings on state-of-

flie-art active filtering control methods, and second to present a novel approach for active filter control based on adaptive noise cancellation theory. This theory, which was originally

developed for noise signal processing, is applied by this thesis research for the control of the power line active filter. The following lists the sections in this chapter:

Section 2.1

presents the concept of active power line filtering.

This section provides the

basic operation principle, circuit connection, and compensating formulation.

Section 2.2 reviews the conventional harmonic detection methods used in the control of active filters. This section presents the key formulations for typical

conventional methods, and analyzes the areas of insufficiency that concludes the need of an improved harmonic detection method.

Section 2.3 presents the concept of an adaptive noise cancellation method, based on which an effective harmonic detection ir Tjd is developed in this thesis research for the power line active filtering applications. This section provides the key

information for the adaptive noise cancellation operation.

Section 2.4 provides the concluding remarks for this chapter.

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

2.1

Basic Concept of Active Power Line Filtering

The basic concept of active power line filtering was introduced in [1].

Active filtering

simply uses a power electronic inverter to inject equal-but-opposite amount of harmonics into the power line to cancel the original ones. This concept has been widely accepted and the research activities on active filtering have been increasing rapidly. A typical active filter

circuit is composed of a power circuit and a control circuit. The power circuit is commonly a standard inverter of three-phase bridge configuration with six power electronic switches for the industrial three-phase systems, or with four switches for the single-phase systems. The control circuit, in general, has a harmonics detecting unit, a filter processing unit, and a inverter firing unit The active filter control circuit first samples the instantaneous

waveforms of the power-Hne voltage and current, and then determines the waveform of the compensating current required for elimination of the line harmonics. Based on the computed compensating waveform, the control circuit generates switching signals to the inverter. The

inverter then injects the compensating current into the power line to cancel its harmonics. This thesis develops a novel method for the detection of power Une harmonic distortion.

The basic operation principle of active filter can be illustrated using Figure 2.1 [2].

In this

figure. U s is the utüity voltage source, Ls is the source impedance including the power Hne impedance, is is the supply current, V ; is supply voltage, ic is the compensating current, ii is the load current, and CT is the current transformer or transducer. The nort-linear load

generates harmonics on the power line, and the active filter injects counter-harmonics to cancel them.

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Ls

Vt

is CT

iL

power line

active fiter

linear load

Figure 2.1 : A simple circuit block diagram for illustration of active filtering

The utility source voltage U s is originally sinusoidal, but the voltage on the power line v, becomes distorted when supplying nonr linear loads, particularly large power electronic equipment such as electric motor drives. These voltages can be expressed as: = [/, sin ca Vt (t) = Us (t) + f (il (t))

( 2 . 1. 1)

The distortion of the power line voltage vt is a function of the load current. The non-linear load draws non-sinusoidal current that can be resolved into harmonic components using Fourier transformation. The load current can then be written as: = I,sm(cct+Ç{) + n-2 =^h(() + h (0 where ij is the fundamental current component and ii, is the summation of the high-order harmonic current components. into two parts: 4(0 = :, (0 + 4 ( 0 (2.1.3) The fundamental component ij can be further decomposed sm( ncct + cpj
( 2 . 1.2 )

where 4 is the active current component wliich has the same firequency (60 Hz) and in phase with the source voltage Us, and iq is the reactive current component which is 90 degrees outof-phase of is. Equation (2.1.2) can be rewritten as:

8

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

h i0 = h i0 + h (i) =
= 1 ^ ( 0 + /c,, m p (0

(2.1.4)

where icomp is the current needed to be compensated by the active filter.

As shown Figure 2.1, the active filter measures the current II of the non-linear load througli a current transducer. The active filter processes his current and decomposes it into two: one is the required compensating current icomp to be generated from the active filter, and the other is the resulting non-distorted current 4 to be supplied by the utility source.

2.2

Conventional Detection Methods For Active Filters

Harmonic detection is very cracial to the control of active filters. line are not detected accurately, the

If harmonics in the power

active filter cannot effectively cancel or suppress the Under tliis condition, the active filter

harmonic distortion caused by the non-linear loads.

will inject whatever harmonic current left from the harmonic cancelling operation into the power line. Therefore, this thesis is focused on the development of an effective method for In this section, however, the conventional detection

power line harmonic detections.

methods are presented, key formulations are given, and areas of insufficiency ,'ro discussed that concludes the need of an improved harmonic detection method.

There are two commonly used groups of control methods for active filters, namely the frequency-domain compensating methods and the time-domain compensating methods [3]. They are described in the foUowing.

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Frequency-domain detection:

Frequency-domain methods perform Fourier transformation on the measurements of the distorted power line current to obtain the harmonic contents and then to determine the amount and waveform of the compensating current. These methods utilize the periodicity of

the distorted waveform to produce the compensating output. They are not effective for non periodic power line distortions, but the noit-periodic distortions are often found in the industrial sites. Another drawback of the firequency-domain method is that the Fourier

transformation needs a lot of computations and thus is not time-efficient for real time control.

In general, frequency- domain methods are useful when the power line has a few low-order harmonics and their magnitudes change slowly. However, if the power line has a

considerable amount of high-order, fast-changing harmonics, then the determination of the harmonics must require a lot of small-step calculations to produce accurate compensating signals for driving the active filter.

Time-domain detection:

Time-domain compensating methods are based on the instantaneous measurements of the distorted power line voltage and current to compute the compensating signals, hi principle,

these methods can compensate both periodic and non-periodic power line distortions [11-23].

Many harmonic detection methods in time domain have been reported [3,4].

The typical

ones are: instantaneous reactive power method [5], synchronous detection method [6], fluxbased controller [7], and notch filter method [8], etc. The effectiveness of these methods

10

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

1
varies depending on the assumptions used. Some methods assume the three-phase power Thus, their supply to be balance, the supply voltages to be near perfect sinusoidal, etc. applications are limited. The instantaneous reactive power method and the synchronous

detection method are introduced in the following sections, because these methods are widely used and often appear in the literatures and also they will be used to compare with the method developed in this thesis.

2.2.1

Instantaneous Reactive Power Detection

The instantaneous reactive power transformation method was proposed by Akagi, et. Al. [5]. This method uses a matrix to map the three-phase supply voltage and current into instantaneous power-based space vector. First, the three-phase voltage and current are

expressed as instantaneous space vectors in the a-b-c coordinates. The a, b, and c axes are fixed on the same plane, apart ftom each other by 3r/3 radians, as shown in Figure 2.2. Sa, 6b, and ec, are voltages, and ia, h, and ic, are currents. Second, these vectors can be

transformed into a two-axis, oc-pi, coordinates by using the following matrix:
1 2 1

A
2 1 2 2

S
2 . 11

2

( 2 .2 . 1)

S
2 J

2

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Figure 2.2: CC-/3coordinates transformation.

The instantaneous power can be expressed as:
P = ea*L+^p* H
=

^Ja + ^bh

+

(2.2.3) (2.2.4)

^=

+gg

where p and q are the real and imaginary power space vectors respectively. above equations in matrix form: p Jl. Tlie inverse of (2.2.5) is:
-I

Rewnte the

p "] L'f.

(2.2.5)

ia }P.

^a

p

(2.2.6)

The instantaneous power on « ac:
P = P ,lc +Pac

coordinates are decomposed into two components, dc and

(2.2.7)

The ac component represents the harmonics. Then the current in (2.2.6) can be separated into ac and dc parts:

12

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

-1
P dc

-I
+
_

e.

Jldc

-S p

_9ac

_

(2.2.8)
a _dc

+

'P.ac where

~ he + ^ac

is a - axis instantaneous fundamental current h_ec is a - axis instantaneous harmonic current h_dc is P- axis instantaneous fundamental current ip is p- axis instantaneous harmonic current

Since the ac component in (2.2.8) represents the harmonics in the power line, the active filter can use this component to generate the compensating current. current in
06/3 frame

Therefore the compensating

can be expressed as: -I P ac
_-^p

_ac }p _ac_

(2.2.9)

Ji ac _ and . Second,

First, a high-pass filter can be used to extract the ac power components:

the cx-f3 compensating currents can be obtained using (2.2.9). Third, the Cé-P current can be transformed back to a-b-c fiame using the inverse transformation of (2.2.2), and the threephase currents can be expressed as: %
ah

0
S

^b h = -72/3 ''ch

Y
2

2 V3

(2 .2 . 10)

13

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Finally, the control reference of the three-phase compensating currents for active filter operation is given in (2.2.10).

2.2.2

Synchronous Detection

The synchronous detection method is based on the assumption that tire three-phase supply current is balanced after compensation [6, 19]. The real power consumed by die load can be expressed as: L a =k e J( 2 .2 . 11)

The real power p is sent to a low pass filter to obtain its average value P^c- Using this \alue, the three-phase powers can be obtained as follows:

p --EéÆ a . g.
P ..=

(2 .2 . 12)

where Ea, Eb, and Ec are the amplitudes of the supply voltages, and Es = £'a+ E t + Ec- The desired supply current can be expressed as follows:

1
14
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

i.. =

(2.2.13)

El

The compensating currents can be obtained by subtracting tlie currents of (2.2.13) from the original power line currents, iz, a.b.c^ah - ^ L a ~ ^ a

(2.2.14)

^ch = ^Lc - h Finally, the control reference for the active filter to generate the compensating current required to cancel the power line distortion is given in (2.2.14) [19].

2.3

Concept of Adaptive Noise Detection

The study above has identified areas of insufficiency in the detection of power line harmonics that can conclude the need of an effective detection method. This section presents the concept of an effective, adaptive harmonic detection method that is developed in this thesis research for the power line active filtering appHcations. The adaptive power line

harmonic detection method developed in this thesis is based on the theory of adaptive noise cancellation. The theory was proposed originally for signal processing operation to cancel

the noise combined in a signal or to separate the good signals from the noisy signals [11]. The theory can be illustrated using Figure 2.3.

15

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

P rim ary Input

System O u tp u t

Signal Source

N oise Source
R eference Input

Adaptive Compensator

Figure 2.3: Block diagram for adaptive noise cancellation

A signal is transmitted over a channel to a sensor that receives the signal "s" plus an uncorrelated noise "no". The combined signal and noise "s + no" form the primary input to the noise canceller. A second sensor receives a noise "n;" that is uncorrelated with the signal but correlated in some unknown way with the noise "no". This sensor provides the reference input to the noise canceller. The noise "nj" is used to produce a compensating signal "y" that is close replica o f "no". Then this compensating signal is subtracted from the primary input

"s + no" to produce the system output "s + n o - y ".

The adaptive noise canceller processes the reference input and automatically adjusts the impulse response through a least-squares algorithm such as the least-mean-square algorithm that responds to an error signal dependent on the canceller output With the use of a proper

algorithm, the canceller can operate under changing conditions and can adjust its output continuously to niinirnize the error signal.

The objective of the adaptive noise canceller is to produce a system output "s + no - y" that can best fit in the least-squares sense to the signal "s". This objective can be accomplished

by feeding the system output back to the noise canceller and adjusting the canceller through

16

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

an adaptive algorithm to minimize the total system output power. as the error signal for the adaptive process.

The system output serves

Assume that s, no, ni, and y are statistically stationary and have zero means. Also assume that s is uncorrelated with no and n /, and ni is correlated with no. Then the output becomes: e = s + no~y Squaring both side of (2.3.1), one obtains:
(2.3.2) (2.3.1)

Taking expectations of both sides of (2.3.2), and realizing that s is uncorrelated with no and y, this yields: E[e^ ]=E[s^]+ E[(n, - y Y ] + 2E[s(n, - y)] =E [s^ ]+ E [{n ,-y f] Accordingly, the rninimrim output power is
(2.3.4)

(2.3.3)

When the canceller it. adjusted so that E[e^] is rniriirriized, rrtinirrtized.

is therefore also

The canceller output y is then the best least-squares estimate of the primary From

noise no. Moreover when £[(«(,- y ) ^ ] is rrtiriirnized, Æ^[(e-5 )^] is also rniriirriized.
(2.3.1),
( e -

5)

= (« o -T )

(2.3.5)

Adjusting or adapting the canceller to rrtinirriize the total ou^ut power is thus equivalent to causing the output e to be the best least-squares estimate of the signal s for the given fe structure and adjustability of the adaptive compensator and for the given reference input.
17

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

From (2.3.3), the smallest possible output power is

[e^ ] = ]. When ttiis is

achievable, jE'[(no->' )^] = 0 . Therefore, >;=«(, and e = s . In this case, iiiinirnizing output power causes the output signal to be perfectly free of noise.

Many algorithms can be used for the adaptive noise cancellation.

In this thesis, the least-

mean-squares algorithm has been used for elimination of hamionic distortions in the power line. The detailed fonnulation for adaptive harmonics filtering will be given in Chapter 3.

2,4

Concluding Remarks

The harmonic detection is an important component in the control of active filters.

This

chapter has presented the conventional harmonic detection methods, both in frequency domain and in time domain. The time domain method, in general, can provide a better Areas of insufficiency for the conventional

detection than the frequency domain method. methods have been identified in this chapter.

The time domain methods, for example the instantaneous reactive power method and the synchronous detection method, work well only when the load is balanced and the supply voltage is un-distorted and balanced. The performance of the instantaneous reactive power

method will degrade when the load is unbalanced and/or the supply voltage is distorted or unbalanced The synchronous detection method gives poor results if the load is unbalanced

or the supply voltage is distorted. Also both methods need a low-pass or high-pass filter to extract the power line harmonics. Their performance therefore is affected by the design of

18

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

the low-pass or high-pass filter, of which the output accuracy is largely subjected to the restrictions of bandwidth and to the sensitivity to frequency drift .

This chapter, based on the findings of the study on the conventional harmonic detection methods, has concluded that there is the need for an effective method for power line harmonic detections. This chapter has presented the theory of an adaptive detection method. This theory was proposed originally for signal processing operation to cancel the noise combined in a signal or to separate the good signals from the noisy signals. Based on this

theory, an adaptive detection method for various power line distortion conditions is developed. Chapter 3 will provide the details of the development of the method.

I
I I I

19

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

1
Chapter 3 Adaptive Harmonic Detection Method For Active Filter Controls
This chapter presents tlie adaptive harmonic detection method developed in this thesis research for the control of active filters. The focus of this chapter is to detail the adaptive The harmonic detection algorithm, and to apply this algorithm for active filter control.

adaptive harmonic detection algorithm is developed in tins chapter, based on the theory of adaptive noise cancellation originally designed for signal processing. This thesis research

applies this theory successfully in power engineering application, for the control of active power fine filters.

The following lists the sections in this chuter.

Section 3.1 presents the adaptive harmonic detection method.

In this section, the

formulations for the detection are derived based on the theory of noise cancellation. The focus of this section is to provide simple expressions that can

be easily used in active filters.

Section 3.2 discusses the application of the adaptive algorithm for power line harmonic detection.

Section 3.3 provides the theoretical requirements for the accuracy of the adaptive harmonic detection method. As the conditions of satisfying the requirements, this section

20

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

shows the mathematical xmcorrelationship between the line voltage and the compensating current, as well as the uncorrelationship between the fondamental line current and the compensating current

Section 3.4 presents the Simulink model for the adaptive noise-cancelling algorithm.

Section 3.5 provides the concluding remarks of this chapter.

3.1

Adaptive Harmonic Detection Algorithm

The adaptive harmonic detection method developed in this thesis uses the theory of adaptive noise cancellation to detect the harmonics in the power line. presented in Section 2.3. cancellation algorithm. The basic concept has been

This section presents the formulations for this adaptive noise

The formulations are particularly tailored in the form that can easily

be used for the detection of power line harmonic distortion [ 1 1 ].

The structure of the adaptive noise cancellation algorithm can be illustrated using Figure 3.1. The algorithm can also be referred as an adaptive linear combiner.

W ,k

Figure 3.1: Adaptive linear combiner

21

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Figure 3.1 shows the referenceinput signal vector with elements corresponding vector of adjustable weiglits, output signal, y.

Xq,x,,

,x^,

a

,w^, a summing unit, and a single

For the application of power Une harmonic detection designed in this tliesis research, the input signal vector will contain the sampling data of the power line voltages. The values of

the weiglits vector will be changed adaptively according to the magnitude of the fundamental component of the line current in such a way that the resulting ou^ut signal will be equal to the fundamental line current Then the harmonic distortion of the power Une can be detected by subtracting the output signal from the original distorted Une signal.

Let Xy_ be the reference input vector and

be tlie weight vector. %k has and

L+\

elements taken

from sequential samples for the same reference input

can be written as:

" k

^/t-i ··· Wu ...

z.]

(3.1.1) (3.1.2)

Then the output y can be expressed as:
L

yk^^V k-i
/= 0

(3-1-3)

The adaptive compensator adjusts its weights w according to the error signal, so that its output y becomes the optimal estimate of the distortion. Equation (3.1.3) can be rewritten as follows by using the vector notation:

i

22

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

The basic adaptive operation of the harmonic detection is by changing the vector time index k, changes.

as the

If let d ^ he the distorted signal, the difference between the combiner output and the distorted signal can be defined as:

(3.1.5)

Substituting (3.1.4) into this expression yields: (3.1.6)

Squaring both sides o f (3.1.6) to obtain the instantaneous square error:

^
Assume that

+ W ^X ,X jW -2(/,X lW

(3.1.7)

and Xk are statistically stationary, and take the expected value of (3.1.7)

over the time index k. Then the expected value o f ^ can be expressed as: E [ 4 ] = E[dl] + W ^E [X ,X l]W - 2 E [ d X W (3.1.8)

Note that tire expected value of any sum is the sum of expected values, but that the expected value of a product is the product of expected values when the variables are statistically independent. The signals Xk and dk are not generally independent.

The mean-square-error function can be conveniently expressed as follows. Let R be defined as the square matrix:

23

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

^k^k-l ^k-^k-l _^k^k-L ^k-l ^k-l^k-L

^k^k-2 ^k-l^k-2 ^k-2^k-L

^k^k-L ^k-l^k-L  ' k -L _ (3T.9)

This matrix is designated the "input correlation matrix".

The main diagonal terms are the

mean squares of the input components, and the cross terms are the cross correlations among the input components. Let P be similarly defined as a column vector: P ... d (3.1.10)

Let the mean-square error in (3.1.8) be designated by ^ and express it in terms of (3.1.9) and (3.1.10) as:
MSE=<^ = E[el ] = E{dl ] -t- W R W - 2 P"' W

(3.1.11)

The objective of adaptive operation is to find the value of W such that the mean-square error is minimum. The gradient of the mean-square-error fimction (3.1.11), designated as V(<^)

or simply V, can be obtained by differentiatmg (3.1.11) to obtain the column vector:

V=i l

aw
(3.1.12)

= 2 R W -2 P where R and P are given by (3.1.9) and (3.1.10) respectively.

The mean-square error is minimized if the weight vector can be set at its optimal value W* where the gradient is zero. This condition can be expressed as:

V = 0 = 2 R W * -2 P

(3.1.13)

24

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Several methods can be used to search the optimal value fV*. One method is called steepest descent gradient search method. In this method, the weight vector W is updated at each step according to the following equation:

(3.1.14) where ju is a constant that regulates the step size and is chosen such that:
0 < /!<
1
\

(3.1.15)

where X max is the largest eigenvalue of R. convergent.

The steepest method is general stable and

Recall the adaptive liner combiner as shown in Figure 3.2.

Î
Distorted signal

WIk

I
Figure 3.2: The adaptive compensator

Error c

From (3.1.6), the error signalbetw een the combiner output and the distorted signal is: (3.1.16) To develop the adaptive algorithm from (3.1.14), one needs to estimate the gradient of ^ = E[el ] at each sampling period and update the weight vector W. The estimation can be

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

done by taking differences between short-term averages of e l . However, in the least-meansquares algorithm, el is taken as an estimate of
r T i t T \ 2 _ / J X ' I tT ' V ' \2

(3.1.17)

The estimated gradient can be written as: = o - 2^ ,x ,+ 2 rw % )x , (3.1.18)

aw,,

= - 2 K -W lX J X ,

Then, at each iteration in the adaptive process, the gradient estimate has the form of:

r 9%

1 = 2e,

d e .
9% 9e* 9^0
-2 e^X^ (3.1.19)

With this simple estimate of the gradient, a steepest-descent type of adaptive algorithm is formed. From (3.1.14), one obtains: (3.1.20)

This is the least-mean-squares adaptive algorithm. regulates the speed and stability of adaptation.

jU is tire performance factor which

The adaptive noise cancellation algorithm

shown in Figure 3.2 can now be summarized as follows:

26

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

The output of the adaptive compensator

can be expressed as:

(3 .1 .2 1 )
1=0

I

The output of the system is .served as an error signal as well. Then the error signal is used to adjust the weights of the adaptive compensator, as indicated in (3.1.22). Therefore the error is minirnized.

I
I

= ^ik +

I = 0 ,1 - 1

(3.1.22)

3.2

Application of Adaptive Noise Cancellation Algorithm For Harmonic Detection

In power line harmonic detection, it is difficult to directly determine the amplitude and phase of each harmonic component in power line current prior to carrying out the analysis of the harmonic contents. On the other hand, if the fimdamental component of the power line

current can be obtained, the total harmonic distortion then can be calculated simply by subtracting the fundamental component from the measured power line current Therefore the major task o f the harmonic detection using the adaptive noise cancellation algorithm is to extract the fundamental component from harmonic-polluted power line current.

Let iift) be the power hne current that has been contaminated by harmonics generated by the non-linear loads. transformation:
h (0 = L, sin( ruf -t- q ) -» - ^ /,, sin( « ÛÏ +
n=2

4(2) can' be decomposed into a series of sinusoidal component by Fourier

)

(3.2.1)

= h (0 + 4

( 0

27

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

where i/ is the fundamental component, and U , is the sum of harmonics,

ij (t) can be

decomposed into an active part and a reactive part. Equation (3.2.1) can be rewritten as: z; ( 0 = /, sin( ÛÏ+ < } q) + X ^ sin( « ÛÏ + < p ,,)
n~2

(3.2.2)

where

4

represents the in-phase line current, and icomp represents the harmonic current

component needed to be compensated.

Figure 3.3 shows the block diagram for the active filter control using the adaptive noise cancellation algorithm for power line harmonic detection.
Prim ary Input

Harmonics

Load current

Voltage
R eferen ce Input

u{t) = Us\nat

Adaptive Compensator

Figure 3.3: AppHcation of adaptive noise cancellation for power line harmonic detection

The primary input is the power line current. For the reference input, we can use the source voltage. The adaptive compensator will adjust its weights constantly so that its output y is the best estimate of the fundamental component. y, the harmonics are determined. By subtracting the estimated fundamental part

28

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Recall the algorithm of adaptive noise cancellation, as illustrated in Figure 2.3. conditions for the method to function, i.e. to cancel the noise in a signal, are:

The pre

- The signal s and the noise no are uncorrelated.

I

- The reference input n y is uncorrelated to the signal s, but ny is correlated to the noise hq.

Obviously, in Figure 3.3, the utility voltage u and the Une current 4 are correlated. In order to apply the algorithm of the adaptive noise cancellation successfully, it is necessary to show the following two conditions:

- The Une current 4 and the compensating current icomp are uncorrelated. - The utUity voltage u and the compensating current icomp are uncorrelated.

3,3

Uncorrelationship between « and icomp and between ia and icomp

The following shows that u and icomp are uncorrelated and similarly ia and icomp are also uncorrelated.

In this thesis, u is the power line voltage and can be expressed as:
u ( t) = U sm .C C t

icomp is the compensated current for the elimination of power Une current harmonics and can be written as:
ic o m p = ig

+ 'c 2 + 4 s + ...... + L = 4 +

s in (/z + < jO ,,)

(3.3.2)

where L is the reactive part o f the power line current, 4 ,, is the n harmonic current.

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

u and icomp are definite in [-T/2, T/2], where T is the period of 60 Hz. Assume that there exists a set of constant, Cq , Cj, C j,...
C qU + C ,/, + +

, . . . , such that
..............+ V c n = 0

C 3I3 +

(3.3.3)

CqU

sin cuf + c,!g + ^ c ,, I ,, sin( « û ï + <p,,) = 0
n --2

Multiply (3.3.3) with sincct and perform integration on both sides from -T/2 to T/2, then one can obtain +
= q C / ( s i n 03Yd
=

sin£UfJt+ X C / 2 ^/«sin(«<ij+<p,,)sin cadt
n=2

rTn
t

^14^ ^

+X
n= 2

c

rTH / n

«C ü f + <p,,) sin o jtd t

0 (3.3.4)

From the orthogonal property of sine functions, the second term and third term of (3.3.4) are always zero. Therefore, the first term of (3.3.4) must be zero, that is

c, Because U j if C]=0 (sin ûjfY

(sin c a f =0 for aU te [-T/2, T/2]

(3.3.5)

96

Q (t ^^Q), equation (3.3.5) is true for aU te [-- T/2, T/2] if and only (3.3.6) and perform integration on

Similarly, multiply (3.3.3) withs'z«(«Oï) where n - 2,3 , both sides, then one can obtain c,,=0
fo r

«= 2 , 3 , ...,

00

(3.3.7) Therefore, by

The above tv/o equations show that all the coefficients of (3.3.3) are zeros. mathematical definitions, z/and icomp are independent and they are uncorrelated also.

With a similar approach as tire above, it can be shown that ia and icomp are uncorrelated.

30

Reproduced with permission of the copyright owner. Further reproduction prohibited w ithout permission.

3.4

Simulink Model For Adaptive Noise Cancelling Algorithm

ï The adaptive noise-cancelling algorithm can be simulated using the program Simulink in the computer software MATLAB. canceUing algorithm. Figure 3.4 shows the Simulink model for the adaptive noise-

CD-

Ï
jQ pl/z
Æ 1 / z
r-- % -

~|

W t*x5

1
a _ re f

--

IS

L-CX33
fa

Figure 3.4: Model of adaptive noise cancelling algorithm In this figure, Inputl: Input!: output 1: output!: the load current which is the primary input of the adaptive algorithm, source voltage which is the reference input of the algorithm, the detected harmonic current. the adaptive compensator output which is tire estimated fimdamental component. w 1, w2, ..., w5 are the weights of the adaptive compensator, the error signal.

31

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

jj.

performance factor that regulates the convergence speed and stability of the algorithm

The performance factor //.has a range of 0 < // < 1.

3.5

Concluding Remarks

This chapter has presented an adaptive harmonic detection method for the application of active power line filtering. In this chapter, the formulations for the noise cancellation

operation have been derived in such expressions that can be easily applied for power line harmonic detections.

In the adaptive algorithm presented in this chapter, each component of the gradient vector is obtained fi-om a single data sample without perturbing the weight vector, and the least-meansquare algorithm updates the weights at each step according to the error signal. This

algorithm can be easily implemented in a practical digital processor without squaring, averaging, or differentiation and is elegant in its simplicity and efficiency.

32

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Chapter 4 Effectiveness of Adaptive Harmonic Detection Method For Control of Active Filter
This chapter provides the computer simulation results for demonstrating the effectiveness of the adaptive harmonic detection method developed in this thesis research. The verifications are carried out under different load and supply conditions. The results using the adaptive harmonic detection method are compared with those of two typical methods: the instantaneous reactive power method and the synchronous detection method. The capability of the method for adaptation to load changes is demonstrated in this chapter.

I
This chapter is organized as follows:

Section 4.1 presents the verification of the effectiveness of the adaptive detection using a square wave representing the power line current. This is a vigorous verification where the harmonic distortion of a square wave is known, and therefore the effectiveness of the detection method can be shown easily with a known reference. This section will verify the method for 4 conditions: current in phase with hne voltage, current with a phase shift with the hne voltage, current with changing amphtude, and different detection performance factors.

Section 4.2 shows the circuit configurations used for verification of the effectiveness of the adaptive harmonic detection method. non-linear loads found in the industry. These configurations represent typical

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

"p 

Section 4.3 presents the verification of the adaptive detection method for steady state operations under typical power line conditions. This section will show the

effectiveness of the method for detection of power line distortion caused by rectifier carrying RL load or RLC load in combination with balanced or unbalanced line voltage or with unequal single-phase loads on the three-phase supply system.

Section 4.4 presents the verification of the adaptive detection method for a dynamic operation where two additional rectifier loads are switched in. This section will show the adaptive capability of the detection method developed in this thesis research.

Section 4.5 compares the adaptive detection method with two well-known conventional detection methods: the instantaneous reactive power method and the This section wül show that the adaptive

synchronous detection method.

detection method performs better than the conventional methods particularly when the power line operates under abnormal conditions.

Section 4.6 provides concluding remarks of this chapter.

34

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

4.1

V erification Using a Square W ave W ith Known Harmonic Distortion

This section demonstrates the accuracy of the adaptive harmonic detection method using a square wave. The reason of using a square wave as a test signal is that the harmonics of a square wave are known, and therefore the detection results can be verified easily and accurately.

Four conditions are tested in this section:

1.

Square wave in phase with a reference signal. Square wave with a phase shift to the reference signal. Square wave with changing amplitude. Performances study for typical performance factors //.

I

2. 3. 4.

The reference signal is a sine wave that has the same frequency (60Hz) as the square wave.

4.1.1 Square Wave in Phase With Reference Signal

For convenient verification of the detection method, it is assumed that the measured signal of the load current is a square wave with the frequency of 60 Hz and the amplitude of 1 unit. A 60Hz sine wave in phase with the square wave is used as the reference signal. The detection results are shown in Figure 4.1, where (a) is the estimated fundamental component, and (b) is the detected harmonics of the square wave. This figure shows that the estimated waveforms match the ideal ones, and therefore the adaptive harmonic detection method has detected the harmonics accurately.

35

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

(s)

(0 1

(s)

Figure 4.1: Verification of harmonie detection using a square wave (a) fundamental component, (b) total harmonies
4.1.2 Square Wave and Reference Signal Not in Phase

Another verification of the adaptive detection method deals with a simulation of the practical condition that the power line voltage and current are not in phase. This condition often exists in the industrial system that carries reactive and resistive loads. Figure 4.2 shows the results of verification when the reference sine wave has a phase shift of 36°, which is arbitrarily chosen with respect to the fundamental component of the square wave. verification, it is assumed that the square wave of
1

For convenient

unit represents the load current and the

sine wave represents the power line voltage. The figure shows a good match of the estimated waveform and the ideal waveform.

I

I

§

Figure 4.2:

(a) In-phase fundamental component, (b) Total harmonic plus out-of-phase fundamental component

36

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

4.1.3

Square W ave With C hanging Am plitude

In order to verify that the detection method can adapt to the changes of non-linear loads, a square wave with changing amplitude is used to represent the load current. The results of harmonic detection and the ideal waveforms are given in Figure 4.3. This figure shows that the detection method can adapt to the load changes very well.
.. o u tp u t o l ANC

I
Figure 4.3: Harmonic detection of a square wave with changing amplitude (a) Fundamental component, (b) Total harmonic component

4.1.4

Performances Study With Different Values of Performance Factor //

As given in Section 3.1, jU is the performance factor that regulates the convergence of the adaptive harmonic detection method. If [i is too small, the system will take long time for its output to reach the desired value. On the other hand, if the performance factor is too large, the system will response fast but give large error. Two cases, one with a small performance factor // = 2x10'^ and the other with a large one p =10"', have been tested. The results are shown in Figure 4.4 and Figure 4.5 respectively. Figure 4.4 shows that the system with a small p takes
3

cycles to reach the ideal curve, and after it reaches the desired waveform, the

37

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

error is very small. However, as shown in Figure 4.5, the system with larger /r has a faster response time, but the error is relatively larger.

Q 14 (S)

(a)

Figure 4.4: Output of the adaptive filter with // = 2x10'' ^ (a) Fundamental component, (b) Total harmonics

-t Figure 4.5: Output of the adaptive filter with jj. - 10 (a) Fundamental component, (b) Total harmonics

4.2

Modeling of Power Electronic Loads For Active Filtering Study

The above verification with a square wave has shown that the adaptive harmonic detection method can provide accurate detection results. In industry, there are different types of

38

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

nonlinear loads such as power electronic equipment that could generate higher amount of harmonics than a square-wave source dose. It is useful to verify the effectiveness of the adaptive harmonic detection method using typical power electronic loads with higher harmonic contents. For convenient verification, the following simulation models for typical power electronic loads have been built:

1. 2. 3.

Rectifier with RL load as harmonic source on power line. Rectifier with RLC load with higher harmonic injection on power line. Unbalanced nonlinear load as a combination of rectifier and single-phase loads.

4.2.1 Rectifier With RL Load as Harmonic Source on Power Line

The first non-linear load model built for verification of the adaptive harmonic detection method developed in this thesis research is a power electronic rectifier with RL (resistiveinductive) load. Figure 4.6 shows the connection of an active filter for elimination of

harmonics injected from the rectifier load. An example of this type of loads is the induction heating system used for forging, soldering, cooking, etc. This system can be simplified as a RL (resistive-inductive) load fed by a power electronic rectifier. As the rectifier converts ac power to dc power, it could generate substantial amount of harmonics at its input line [33, 34].

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

V SI

I y

Figure 4.6: Active filtering of harmonics generated by rectifier with RL load
4.2.2 Rectifier With RLC Load With Higher Harmonic Injection on Power Line

The second non-linear load model built to verily the adaptive detection method is a rectifier with RLC (resistive-inductive-capacitive) load. With the capacitor C in the load, the rectifier will generate higher harmonics on the power line than that with the RL load. Active filter can be used to effectively suppress harmonics from this type of non-linear load. Figure 4.7 shows the connection of the active filter and the rectifier load.

V SI

Figure 4.7: Active filtering of harmonics generated by rectifier with RLC load

4.2.3

Unbalanced Load as a Combination o f Rectifier and Single-phase Loads

The third non-linear model built in this thesis research for verification of the detection method is a rectifier with a parallel-connected unbalanced load. This simulates the real

40

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

power system conditions where single-phase loads connected on each of the three phases in the system are not necessary equal. Figure 4.8 shows the connection of an active filter for

I
1

suppression of harmonics under the unbalanced loading conditions.

t

VSI

I
4.3

Figure 4.8: Active filtering of harmonics generated by unbalanced nonlinear loads

Verification Operations

of Adaptive

Harmonic Detection M ethod

for Steady State

This section demonstrates the effectiveness of the adaptive harmonic detection method developed in this thesis research. The demonstration is carried out for typical power line conditions that are simulated as follows:

1. 2 3.

Harmonics from rectifier RL load with normal or unbalanced line voltage Harmonics from rectifier RLC load with unbalanced line voltage Harmonics from rectifier load with unbalanced single-phase loads

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

4.3.1

Harmonies From Rectifier RL Load With Normal or Unbalanced Line Voltage

In this section, the effectiveness of the adaptive detection method is tested for two simulated power line conditions: harmonics injected from a rectifier RL load under normal power line voltage, and harmonics under unbalanced line voltage. Figure 4,6 shows the circuit for the

;

test.

1.

Normal pow er line voltage

Figure 4.9 shows the simulation results for the detection of power line harmonic distortion caused by the rectifier with RL load with the normal balanced line voltage.

0 , 1 6 (s)

O. l S ( s )

0 .1 5 (s )

Figure 4.9: Detection for rectifier RL load under normal line voltage

In Figure 4.9, only the simulation results of Phase "a" are presented because the load is balanced and the results for all three phases are similar. The power line current prior to compensation has a 26.07% total harmonic distortion (THD). The THD of the power line

42

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

current after compensation is reduced to 1.05%. Table 4.1 lists the THD values of the power line current before and after compensation. THD Before compensation After compensation Phase-A 26.07 1.05 Phase-B 26.07 1.04 Phase-C 26.07 1.05

Table 4.1: THD (%) for the waveforms in Figure 4.9

2.

Unbalanced power line voltage

The above shows that the adaptive harmonic detection method has provided accurate detection result when the load is balanced under the normal power line voltage. However, the power line voltage may not be always balanced. This section demonstrates the

effectiveness of the adaptive method for detecting the power line distortion under a fairly severe unbalanced line voltage as shown in Figure 4 .10(a).
untralanced source wKoge

I
10

, -50

0 ISIS)

is) 0 05

I (b)

:

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

C o m p e n s a te d current

0

1 5 (3 )

i
0.15(s)
0 1 S (S )

I
O .iSts)

(c)

(d)

Figure 4.10: Detection for rectifier RL load under unbalanced line voltage

Figure 4.10 shows the rectifier load current in (b), the compensating harmonic distortion in (c), and the compensated power line current in (c). The THD before compensation has an average of 26.4%. After compensation, the THD is reduced to only 2.7%. Table 4.2 shows the values of the THD on each phase.

THD Before compensation After compensation

Phase-A
26.96 2.64

Phase-B 25.01
239

Phase-C 27.20 3.16

Table 4.2: THD (%) for the waveforms in Figure 4.10

4.3.2

Harmonics From Rectifier RLC Load With Unbalanced Line Voltage

In this section, the adaptive harmonic detection method is tested for a severe power line condition with a high harmonic distortion and with unbalanced line voltage. To simulate this condition, a rectifier with RLC load is used and the circuit is shown in Figure 4.7. The detection results are given in Figure 4.11.

44

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

unbalanced so u ire voltage

0.1 5I S )

a. E
·SO

0.15(S)

0

0.025

0.05

0.15(5)

(a)
C o n pensaed c a re rs

0.15(5)

0.15(s)

0.l5(s)

0.15 (s

0.l5(s)

Figure 4.11; Detection for rectifier RLC load with non-ideal line voltage

Figure 4.11 shows the unbalanced line voltages in (a), the uncompensated line current in (b), the current harmonic distortion in (c), and the compensated power line current in (d). Table 4.3 shows the values of the line current THD before and after compensation on each phase. The power line current has an average THD of 42.9% before compensation. The power line current THD is reduced to an average of 3.2% after compensation.

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Am*

THD Before compensation After compensation

Phase-A 4L58 Z76

Phase-B 4L88 L91

Phase-C 42.20 2.86

Table 4.3: THD (%) for the waveforms in Figure 4.11
4.3.3 Harmonics From Rectifier Load With Unbalanced Single-phase Loads

Unbalanced power line current occurs when single-phase loads connected to a three-phase system are not equal on all phases, or when a three-phase load has unbalanced impedances. There may be some other nonlinear loads connected to the same supply system. Harmonics generated by the non-linear loads together with unbalanced currents from single-phase loads may circulate in the supply system and cause overheating problems. Active filter can be used to suppress harmonics and, in some cases, to correct the unbalanced conditions. In this section, the effectiveness of the adaptive harmonic detection method is tested for a special power line condition where unbalanced line current is caused by three unequal single phase RL loads and a rectifier load. Figure 4.8 shows the circuit used for this test. Figure 4.12 shows the simulation results.

CompansatedcurenI

V
OlSts) 005 015(S) 005

0 istt)

oos

0 t5 (t)

005

0 15W

005

(a)

(b)

(c)

Figure 4.12: Detection for three unequal single-phase loads and a rectifier load.

46

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Figure 4.12 shows the load currents in (a), the current harmonic distortions in (b), and the compensated power line currents in (c). Table 4.4 lists the values of current THD on the power line before and after harmonic compensation. The power line current before

compensation has an average THD of 22.8%. The current THD is reduced to an average of 4.5% after compensation. THD Before compensation After compensation Phase-A Z161 3^8 Phase-B 27 93 ^ 4 J9 Phase-C 2Z84 4.64

Table 4.4; THD (%) for waveforms in Figure 4.12

4.4

Verification of Adaptive Harmonic Detection Method For Dynamic Operation

This section demonstrates the adaptive capability of the detection method to the changes of power line condition. To simulate a dynamic condition, it is assumed that a rectifier load is connected on the power line, and after the first load reaches steady state, two rectifier loads (each of 40% of the first load) are connected with a time difference of approximately 4 cycles. This sever power line dynamic condition is used to test the accuracy and adaptive capability of the detection method developed in this thesis.

I Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

0 .1 8 (5 }
1

'c

I
·1

0.1 20

0 .1 8 (s)

I"
-20
0.1

Figure 4.13; load current with changing amplitude

Figure 4.13 shows the

detection results for the simulated severe dynamic power line

condition. This figure shows (a) the changes of the load current after two additional rectifier loads are switched in, condition, and (c) the (b) the detection of harmonic distortions during this dynamic compensated power line current. The figure of (c) clearly

demonstrates the adaptive capacity of the detection method developed in this thesis research.

4.5

Comparison With Conventional Detection Methods

To further demonstrate the effectiveness of the adaptive harmonic detection method, this section provides comparisons with two typical conventional detection methods: the instantaneous reactive power method and -the synchronous detection method. The following power line conditions are used for the comparisons:

1. 2 3. 4.

Harmonics from rectifier RL load Harmonics from rectifier load with unbalanced single-phase loads Harmonics from rectifier RL load with unbalanced line voltage Harmonics from rectifier RLC load with unbalanced line voltage 48

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

4.5.1

Comparison Under Normal Power Line Voltage

I.

Harmonics from rectifier RL load

When the load is balanced and when the power line voltage is normal, aU three methods provide accurate detection results. This can be seen from Table 4.5 and the waveforms of compensated current in Figure 4.9, Figure B 1, and Figure B2 in Appendix B. Table 4.5 shows that the current THD after compenstjition is reduced significantly to about 1% or less from 267c. And the compensated current waveforms are close to sinusoidal. This

demonstrates that aU three methods perform very well. Adaptive harmonic detection 1.05 1.04 1.05 Instantaneous reactive power 0.51 0.51 0.50

THD7c A B C

Before compensation
2&07 26.07 26TM

Synchronous detection
036 0.36 0.36

Phase

Table 4.5: THD (%) of line current under rectifier RL load for three detection methods fe*

f

2.

Harmonics from rectifier load with unbalanced single-phase loads

I
When the load is unbalanced, the adaptive harmonic detection method and the instantaneous reactive power method provide accurate detection results. However, the performance of the synchronous detection method degrades. This can be seen from the waveforms and the THD values of the power line current compensated using these three methods. The waveforms for the adaptive harmonic detection method, the instantaneous reactive power method, and the

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

synchronous detection method are shown in Figure 4.12, Figure B3, and Figure B4 respectively. The THD values are listed in Table 4.6.

THD% A Phase B C

Before compensation 22.61 2Z93 22.84

Adaptive harmonic detection 3.98 4.79 4.64

Instantaneous reactive power 4^7 4a9 4.86

Synchronous detection 6.41 &24 &07

Table 4.6: THD (%) of line current under unbalanced load for three methods

4.5.2

Comparison For Unbalanced Power Line Voltage Condition

When the power line voltage is unbalanced, the adaptive detection method performs well, but the instantaneous reactive power method performs poorly. The performance of the

synchronous method varies depending on different loads. Two illustrating cases are given in the following.

1.

Harmonics from rectifier RL load
\

iî Case 1 assumes the power line voltage is unbalanced and supphes a rectifier with RL load. Simulations are carried out to compare the performances of the three methods. Figure 4.10, Figure B5, and Figure B6 show the simulated results. The adaptive harmonic detection

method performs well. On the other hand, both the instantaneous reactive power method and the synchronous detection method do not perform well, where the power line current is still distorted after compensation. Table 4.7 lists the THD values for the three methods.

50

I'
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

THD% A Phase B C

Before compensation 26.96 25.01 2T20

i
#

Adaptive harmonic detection 2.64 239 3H6

Instantaneous reactive power 11.12 11.30 11.38

Synchronous detection 6.34 7.09 286

Table 4.7: THD (%) of rectifier RL load with unbalanced power line voltage

2.

Harmonics from rectifier RLC load

Case 2 assumes the unbalanced power line voltage feeding a rectifier carrying a RLC load. The power line condition before compensation for this case is poorer than that for Case 1 as shown in Table 4.8. This table shows that the current THD before compensation for Case 2 % has an average of 42.9%, while the average for Case I is 26.4%. The three methods are used to suppress the power line harmonic distortion. The waveforms of the compensated Line currents for the adaptive detection method, the instantaneous reactive power method and the synchronous detection method are given in Figure 5.11, Figure B7 and Figure B8 respectively. The THD values of the compensated line cuiTent by the three methods are

given in Table 4.8. This table shows that the performances of the three methods are similar to those in Case 1 where the adaptive harmonic detection method developed in this thesis performs well, but the other two methods do not perform weU.

THD% A Phase B C

Before compensation
4438

Adaptive harmonic detection 2.76 3.91
286

Instantaneous reactive power 11.46 11.87 11.93

Synchronous detection
638

41.88 42.20

7.67
83 3

Table 4.8: THD (%) of rectifier RLC load with unbalanced power line voltage

51

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

4.6

Concluding Remarks

This chapter, first, has presented a vigorous \ erification of the adaptive harmonic detection method developed in this thesis research using a square wave current of known harmonic
(

distortion.

Second, this chapter has verified the effectiveness of the adaptive detection

method for steady state operations under txpical power line conditions including line distortion caused by rectifier carrying different loads. Third, this chapter has verified the performance of the adaptive detection method for a dynamic operation where two additional rectifier loads are switched in. Fourth, this chapter has concluded that the adaptive detection method performs better than two well-known conventional detection methods particularly under abnormal power line conditions.

la .
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Chapter 5 Experimental Verification of Adaptive Harmonic Detection Method
This chapter shows tlie experimental verification of the adaptive harmonic detection method developed in this thesis research for the control of active power line filters. The adaptive

method has been successftilly implemented using state-of-the-art digital signal processor (DSP). This chapter presents the details of the hardware and the software implementations This chapter also presents four case studies:

o f the adaptive harmonic detection control.

three for typical distorted power line conditions, and one for unbalanced power line condition. The objective of these case studies is to demonstrate the effectiveness of the

adaptive harmonic detection method for both balanced and unbalanced distorted power Une conditions. Experimental results and simulations are provided for the demonstration.

The following lists the sections in this chapter.

Section 5.1

presents the hardware implementation of the adaptive power line harmonic detection. This section describes both control circuit and power circuit This section also details the implementations in major

implementations.

components such as the TMS320LF2407 DSP from Texas Instruments and the 342GD120-316 Skiip converter module from Semikron.

53

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Section 5'.2 presents the software implementation of the adaptive detection.

This section

describes the software for data acquisition, harmonic detection, PWM control signals generation, etc. The flow chart of the software is given.

Section 5.3 presents tlie experimental verification of the adaptive harmonic detection method developed in this thesis research. This section provides experimental

results and simulations for 4 case studies covering typical power line conditions.

Section 5.4 provides concluding remarks of this chapter. L'l
5.1 Hardware DSP Implementation of Adaptive Harmonic Detection

¥ This section describes the hardware DSP implementation of the adaptive harmonic detection method, developed in this thesis research. The filter consists of two main parts: he first part is the control circuit mainly consisting of a digital signal controller, and the second part is the power circuit mainly consisting of a voltage-source power electronic inverter. diagram of the active filter is given in Figure 5.1. The block

5.1.1

Digital Signal Processor Control Circuit

The control circuit mainly consists of one DSP, two voltage sensors, four current sensors, and one interface circuit.

54
à#
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

w

The DSP board of TMS320LF2407 from Texas Instruments (TI) is used to implement the adaptive hamionic detection method for the control a power inverter to cancel the current harmonics from noir-linear. The non-linear load used in the experiments is a three-phase acto-dc converter. The TI DSP has the following features:

16-bit fixed-point micro-controller ADC: 10-bit ±1, 500 ns conversion, 16-channel, analog-to-digital converter General-purpose bi-directional digital 1/0 PWM generator and 12 PWM output channels On board 7.3728-MHz oscillator for 30M1PS operating speed 64K onboard program/data memory RAM 32K on- chip Flash memory 0-3.3V input and output signals

Isolation T ransform er

N on linear load

A ctiv e Filter

Inverter

Interface circuit

sensors

I ^ ^
Personal PC

If------D SP C ontroller TM S320LF2407 'v

\ -- *

Figure 5.1: Block diagram of the active filter.

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

This 16-bit DSP computes the required harmonic compensation using the Q15 format that is the data is processed using 1 sign bit and 15 bits traction representation. Eiglit of the 16 analog-to-digital converter channels are used to measure currents and voltages through current/voltage sensors; 2 channels for monitoring the load currents, 2 for the line voltages, 2 for the active filter output currents, and two for the line currents after filtering.

This TI DSP operates at 30 MHz clock frequency, and it generates switching signals for the inverter control using interrupts set at 15 kHz. Hie DSP uses the measured voltage and

current waveforms to calculate the compensating currents required to cancel the load current harmonics. The DSP then generates switching signals through 6 general-purpose bi

directional digital I/O pins to control the power electronic inverter.

The block diagram of the DSP board is given iii Figure 5.2.

As shown in this figure, tlie The switching signals

currents and voltages are monitored by the DSP through PI and P7.

are outputted from the DSP through P2 and P8 to the drive circuit of the power electronic inverter. The computer communicates through P9 with the DSP.

Voltage/current sensors and sensors-to-DSP interface

The waveforms o f the line voltage and the load current are measured using voltage sensore and current sensors. The output range of the voltage sensors is +/- 3.33 V for +/- lOOV

signals. The output range of the current sensors is +/- 4 V for +/- 10 A signals.

In order to match the 0-3.3V level of the input cliannel of DSP, operational amplifiers are used as sensor-to-DSP interface to convert the output range of the voltage sensor to 0-3.3V

56

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

for a -/+100V signal, and to convert the output range of the current sensor to 0-3.3 for a -/+10A signal.

A

N
A

L 0 1
/ 0 PI I P7

G

From V o lta g e and

DATA
SRAM 64 K. X 16 ProgranV D ata

A n a lo g to D ig ita l C o n v e rte r

Current
Sensors

A d d re s s TM S320LF2407
P arallel P o rt/ JT A G C o n tro ller

JT A G

D ig ita l I/O

PW M I PW M 2 PW M 3

J T A G P 10

PW M 4 PW M 5 PW M 6

To Inverter

Figure 5.2: Block diagram of DSP TM320LF2407

DSP-to-inverter interface

The PWM channel in the DSP provides output signals of 3.3V.

Since the IGBT switches in

the inverter needs switching signals of 15V, a voltage-level shifter MC14504 is used as DSPto-inverter interfece to amplify the PWM output signals from the DSP to the inverter driver circuit.

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

r"

5.1.2

Active Filter Power Circuit

A power electronic converter module Skiip® 342GD120-316 CTV from Semikron ia used in the active filter circuit developed in this thesis research. This module is rated at 1200V and 300A. It consists of a rectifier, a capacitor, an inverter, and a driver. The rectifier is a threephase fijU-bridge diode rectifier. The inverter is a three-phase standard bridge circuit using

IGBT (insulated gate bipolar transistor) switches.

Non-linear rectifier load

The diode rectifier is disconnected from the Skiip module and is served as a non-linear load. The ac terminals o f the rectifier are connected to the power line, and the dc terminals are connected to different loads.

Active filte r inverter

The inverter, its driver and capacitor of the Skiip module is used as the power circuit of the active filter developed in this thesis. The rated cunent of the active filter was set to lOA for demonstration tests.

Isolation transformer and additional line distortion

For the convenience of performance the experiments in Ryerson Power Electronic Laboratory, the active filter is isolated from the utility power system using a transformer. The rating of this transformer is 23.4kVA, 208V and 28A. The impedance of this

58

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

transformer causes additional voltage distortion on the power line connecting the nom linear load. This results in a slightly more challenging line condition for testing the effectiveness of

the active filter operation. This transformer is not needed in the practical implementation.

5.2

Software DSP Implementation of Adaptive Harmonic Detection

The adaptive control o f the active filter developed in this thesis research has been implemented in software using the TMS320LF2407 DSP. Figure 5.3 shows the main parts

o f the active filter control software. The software is discussed in the following.

Calculation

î

ADC

of Fundamental

computation of Harmonics

PWH 'Gener ation

updating weights

Figure 5.3: Block diagram of the software

5.2.1

Software Setting For Analog-to-digital Conversion

Software needs to be set up in the DSP for the conversion of analog signals (currents or voltages) into digital form before those signals can be processed by the DSP. The measured current and voltage signals are converted from analog to digital signals by the ADC unit in the DSP. The results o f conversion are stored in 10-bit Result Registers as unsigned integers. Because the real signal can be positive and negative, the converted results need to be processed so that they can represent both positive and negative signals. This can be done by the following commands: w % 59

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

LACC XOR

ADC_RESULT, 6 #8000h

; load ADC results into accumulator ; convert the results into Q15 format

The result is converted to the Q15 format (1 sign bit and 15 fraction bits) by XOR command Therefore, the range of OOOOh-OSFFh for the Result Register is converted to a range of ~/+l in Q15 format.

5.2.2

Computation of Fundamental Power Line Current

Software is developed to compute the fimdamental component of the power line current. The digital signals of the line voltage and current, after ADC conversion, are used to calculate the fundamental current. noise cancellation algorithm. algorithm. The calculation is carried out according to the adaptive

In this thesis, 5 weights are used in the adaptive filtering Three

Thus, 5 consecutive sampling points of voltage and current are needed.

buffers are used to store the voltage and current samples and the values of the 5 weights. During each sampling period, the fundamental component is computed, and an error signal is obtained by subtracting the fundament component from the measured power line current. At the end o f each sampling period, the oldest sample point of voltage and current are discarded. Each of the remaining four sample points is moved to the next higher address in the buffer so that, at next sampling period, the newest sample point is stored in the top address of the buffer. This process can be illustrated using Figure 5.4.

60
i
Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

K

newest sample"

buffer X(n+1) X (n) X (n-1)

buffer X (n) X(n-1) X(n-2)

1
4 1

X(n-2)
step n+1

X(n-3)
step n X(n-4)

X(n-3)

1

Figure 5.4: Diagram of buffer at step n and step n+1

5.2.3

Updating Weights For Adaptive Harmonic Detection

The weights are updated at each sampling period after the error signal is obtained. updating is carried out according to the equation (3.1.21):
'i(M )

The

=

^ = 0 ,12 ,3,4 . There are 8

The software uses indirect addressing mode to fetch the value of w,^ and

auxiliary registers (AR0-AR7) can be used for indirect addressing mode. This software uses AR2 for the addressing of w,f., and AR3 for . The content of AR2 is set to be the top

address of the weight buffer, while AR3 is set to be the bottom address of the voltage buffer. Then the first new weight is calculated according to (3.2.21). After first calculation, the Then AR2 is

content of AR2 is increased by 1 and the content of AR3 decreased by 1.

pointing to the second value in the weight buffer, and AR3 is pointing to the second last value in voltage buffer. Thus, the second new value of weight is calculated. The process is repeated until AR2 points to the bottom address of the weight buffer and AR3 points to the top address o f the voltage buffer.

61

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

The updated weights are stored to the weight buffer and are used to calculate the fundamental component in next sampling period The old values of the weights are

overwritten with the new ones. After the fundamental component is obtained, the harmonics can be calculated by subtracting the fundairental component from the measured power line > .urrent

5.2.4

PW M Generation

The power line harmonics calculated using the method described above are used to generate tlie PWM signals. The TMS320LF2407 DSP has a built-in PWM generating function, which is controlled by the EV (event manager). The DSP has two event managers, EVA and EVB. These two event managers are exactly identical to each other in terms of functionality. the sake of brevity, only the functionality of EVA is explained following functional blocks: For

Each EV contains the

Two general-purpose (GP) timers. Three compare units. Pulse-width modulation (PWM) circuits Dead-hand generation units Interrupt logic If
IS:

Each EV has two general-purpose timers.

Each timer has a counter register, a 16-bit timer The timer control register sets the counting

period register, and a 16-bit control register.

mode, which can be one of the counting up mode and counting up/down mode. In this thesis, two methods for the generation of PWM inverter switching signals have been implemented

62

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

using Timer 1 of the EVA (event manager A) in the DSP. PWM, and the other is hysteresis comparison PWM.

One is the standard triangular

For the generation of the triangular PWM switching signals, the counting up/down mode is used to produce a symmetrical triangular wave. The counter register stores the value of the counter and keeps increasing or decreasing depending on the direction of counting. The

value in the period register determines the counting period. Le. the period of the triangular waveform. This value also determines the switching frequency of the PWM. In this thesis

research, the period register is set to 1500 to generate a lOkHz PWM switching frequency.

For the generation of the hysteresis comparison PWM signals, the counting up mode is used to set the period for each hysteresis comparison operation. This operation for generating

PWM signals is simply by comparing the feedback current measured at the output of the active filter with the compensating current calculated using the adaptive harmonic detection algorithm developed in this thesis.

There are three compare units (compare units 1, 2, and 3) in the EV module. Each compare unit has a pair of PWM outputs. There are a total of 6 PWM outputs in the compare units. The harmonics of the 3-phases power line are stored in the 3 compare registers. The value of each compare register is constantly compared with the value of counter register of the general-purpose timer. In other words, the harmonics of each phase is constantly compared

with the triangular waveform created by the general-purpose timer. When the values match, a transition (from low to high, or high to low) happens on the associated PWM outputs of the compare units. When a second match is made between the values, another transition (from

high to low, or low to high) happens on the associated output. In this way, an output pulse is

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

5.3

Experimental Verification of the Adaptive Harmonic Detection Method

This section presents the case studies for the verification of the adaptive harmonic detection method developed in this thesis research. The following provides the study, by DSP «at experiments and Simulink simulations, for 4 cases representing typical power line harmonic distortion conditions.

5.3.1

RL Rectifier Load (Case study 1: moderate power line harmonics)

Case study 1: In this case study, a diode rectifier carrying a RL load (30

10 mH) is used

as a source that injects harmonics on the three-phase power line of 110 V. This rectifier RL load is a typical moderate harmonics source found on the industrial power lines.

The experimental result for this case study is given in Figure 5.7.

Part (a) of this figure

shows the distorted power line c irrent at the input of tire rectifier. Part (b) shows tire current harmonic distortion detected by the adaptive method developed hr this thesis research with implementation in TMS320LF2407 DSP. Part (c) shows the current after compensation

where the major lower harmonics are suppressed.

66

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

(a) Load current, lOA/div, O.Ols/div
.

' ' ' '!

- f - r - r - r - f r - i - i

.- t-r-r-

sA/<<«VV%/

\i-V v " iW

(b) Detected harmonic current, lOA/div, O.Ols/div
*  :

Ï -.
J
/ V / / V / \ > r \

T i

: :

:

5 :

;

(c) Current after compensation, lOA/div, O.Ols/div

Figure 5.7 Experimental results for Case Study 1

Figure 5.8 shows tiie computer simulation results. The simulation is implemented usmg the software Simulink, and the detection of the power line harmonic distortion uses the adaptive method developed in this thesis. This figure provides a convenient comparison witli the experimental results in Figure 5.7. The THD of power line current before compensation is 26.17%, and the THD of the current after compensation is reduced to 9.02%.

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

(A) 20

0.1

0 .16

0.2(î)

(a) Simulated load current
(A) 20

0 .2 ( s )

(b) Detected harmonic current
(A) 3 0

0.1

D.15

02 (s)

(c) Simulated current after compensation

Figure 5.8: Simulation results for Case Study 1.

5.3.2

RLC Rectifier Load (Case study 2: more power line harmonics)

Case study 2: In this case study, the diode rectifier carrying a RLC load (300, 2.5mH, 750 jiF) is used as a source that injects harmonics on the three-phase power line. The input current harmonics content in this rectifier RLC load increases with the connection of the capacitor C, as compared witli tliat in the RL rectifier load in Case study 1.

68

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

The experimental result for this case study is given in Figure 5.9. shows the distorted power line current at the rectifier input. harmonic distortion. Part (c) shows tire current after compensation.
q 3

Part (a) of this figure

Part (b) shows the current

w

V
. . . .

(a) Load current, lOA/div, O.Ols/div
n -.-, r-

h;

SAA"

, . : . i : , : , 1i , , !

....

(b) Detected harmonic current, lOA/div, O.Ols/div 4 -:

(c) Current after compensation, lOA/div, O.Ols/div

Figure 5.9: Experimental results for Case study 2

Figure 5.10 shows the computer simulation results using the software Simulink. This figure is provided for tire comparison of the experimental results in Figure 5.9. The THD of power

69

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

line current before compensation is 31.55%, and the THD of the current after compensation is reduced to 9.2%.
(A ) 2 0

-20

0.1

0 .1 3

0.1

e

(O

I

(a) Simulated load current
(A ) 2 0

(b) Detected harmonic current

Iwf ;
·10

·20 0. 1 0 .1 3 0 .1 8

(* )

(c) Simulated current after compensation

Figure 5.10: Simulation results for Case study 2.

5.3.3

RC Rectifier Load (Case study 3: increased power line harmonics)

Case study 3: In this case study, tlie diode rectifier carrying a RC load (30 Q, 330 }xF) is used as a source that injects harmonics on the three-phase power line. The input current

harmonics content in this rectifier RC load increases witli the connection of the capacitor C

70

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

and without the connection of the inductor L, as compared with that in Case study 1 and Case study 2.

The experimental result for this case study is given in Figure 5.11. shows the distorted power line current at tire rectifier input. harmonic distortion. Part (c) shows the current afi:er compensation.

Part (a) of tins figure

Part (b) shows tire current

I
î:

il

(a) Load current, lOA/div, O.Ols/div

$ -% »

(b) Detected harmonic current, 10A/div, O.Ols/div

(c) Current after compensation, lOA/div, O.Ols/div

Figure 5.11: Experimental results for Case study 3.

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

i
Figure 5.12 shows the computer simulation results using the software Simulink. This figure is provided for the comparison of the experimental results in Figure 5.11. The THD of power line current before compensation is 38.36%, and the THD of tire current after compensation is reduced to 8.97%.

(A) 2 0
10

0

-10

-2 0

(s)

(a) Simulated load current

(b) Detected harmonic current
(A ) 20
10

C O (c) Simulated current after compensation Figure 5.12: Simulation results for Case study 3.

5.3.4

Unbalanced Distorted Load (Case study 4: unbalanced power line harmonics)

Case study 4: This case study investigates the performance of the adaptive harmonic detection method in this thesis for tire power line under an unbalanced and distorted loading

72

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

condition.

Tliis condition is established using a hree-phase diode rectifier and a single-phase

load connected between phase "b" and phase "c". The diode rectifier that causes power line distortion carries a load of 30fl and 2.5mH, and the single-phase load that causes the unbalanced loading has a resistance of 40£2.

The experimental result for this case study is given in Figure 5.12.

Part (a) of this figure

shows the distorted three-phase power line currents at the terminals of the combined rectifier load and the single load. This part clearly shows the unbalance on the three phases, where

Phase "b" and Phase "c" draw more currents than Phase "a" does. Part (b) shows the current harmonic distortion. Part (c) shows the current after compensation. Phase "a'' 1 ) Phase "b'   f Phase "c' i

;

\ / \ / v Kt v v W '\ / V 'V V A ,A y\/\j'^\A !
: (a) Load current, lOA/div, O.Ols/div

............. :

:

.

,_

.

!

I

"

!

(b) Harmonic cun'ent, lOA/div, O.Ols/div

W V jV W v v w

w

A A A iw v 1

(c) Current after compensation, lOA/div, O.Ols/div Figure 5.13: Experiment results for Case study 4. 73

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Figure 5.14 shows the computer simulation results using the software Simulink for the unbalance loading condition. This figure is provided for Üie convenience of comparing the

experimental results given in Figure 5.13. Phase "a" Phase "b" Phase "c"

i ; Hi

i i i

; ;

LA

I
LV! ; L J iV 'i ^ /iV i..! . . -J !.. 1.. L ,i._
(a) Simulated load current

iC i ju

iH

i"\

r

»l

u . -- X-- --J - . --i .

1 ,» :; 1 ; :! 1 . I i i i .1 "A

A i

' ______'

(b) Detected harmonie current

j.
0 .1 !

0 .1 !

1 .1!

0 J(O

(c)

Simulated current after compensation

Figure 5.14: Simulation results for Case study 4.

5.4

Concluding Remarks

This chapter has presented the experimental verifications of the adaptive power line harmonic detection method developed in thesis research. Hie hardware and software

74

Reproduced with permission of the copyright owner. Further reproduction prohibited w ithout permission.

implementation of the adaptive harmonic detection has been detailed. implementation has been carried out using state-of-the-art digital signal processor. Four case studies covering typical power line conditions have been

The control

carried out.

Experimental results and simulations have been provided to demonstrate tire effectiveness of the detection method developed in this thesis.

75

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Chapter 6 Conclusions
6.1 Major Research Work Completed

The following presents a summary of the major tasks that has successfully completed to aclrieve the objective of this thesis research for the development of an advanced power line harmonic detection method for effective control of active filters.

I

A.

Extensive research has been conducted on active power line filtering operations. This includes studies of filter circuit configurations, filter control methods, real-time filter control algorithms, state-of-the-art control implementations, etc. In particular, a

detailed study on conventional power line harmonic detection methods has been carried out. Also detection methods in areas outside the power electronics are

studied. Based on the findings of these extensive research studies, a novel method for the active filter control based on noise cancellation theory has been found. This

theory, which was originally developed for noise signal processing, has been applied by this thesis research for the control of power line active filters.

B.

Detailed fomiulations for the adaptive power line harmonic detection method have been developed. This method has been based on noise cancellation theory that was

designed originally for the noise signal processing outside the area of power electronics. . The original formulations for noise cancellation are considerably complex and complicated as compared with the common fonnulations encountered in the control of power electronics. Therefore, extensive research effort has been spent

76

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

first to fiilly understand all formulations for the original noise cancellation control, and second to significantly simply the formulations for the control of power line active filters. Finally, a simple and practical formulation has been derived for filter

control, and the fonnulation can easily be implemented in a digital signal processor.

C.

Vigorous verifications of effectiveness of the adaptive harmonic detection method have been carried out using computer simulations. First, this thesis research has

verified the adaptive detection method using a square wave power line current of known hamionic distortion. Second, this thesis research has verified the

effectiveness of the adaptive detection method for steady state operations under typical power line conditions including line distortion caused by rectifier carrying different loads. Third, this research has verified the performance of the adaptive

detection method for dynamic operations such as switching in additional harmonicrich rectifier loads. Fourth, this research has demonstrated that the adaptive detection method has performed better than two well-known conventional detection methods particularly under abnormal power line conditions.

D.

Experimental verifications of the adaptive harmonic detection method for the control of active power line filters have been conducted. This thesis research has

 it

demonstrated that the adaptive method has been successfully implemented using state-of-the-art digital signal processor. This research has designed the hardware and the software implementations of the adaptive detection control in details. This tliesis

has also presented four case studies: three for typical distorted power line conditions, and one for unbalanced power line condition.

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

6.2

Major Research Contributions

1.

An adaptive pow er line harmonie detection method has been developed, which has

been based on the findings of extensive reseaich in the areas of inside and outside of power electronics controls.

2.

A simple and practical form ulation o f the adaptive harmonic detection method has

been developed, which has been simphfied significantly from tlie original complex design formulations for noise cancellations.

3.

Vigorous verifications o f effectiveness o f the adaptive detection method using computer simulations have been carried out, which have covered the steady state

operations, the dynamic operations, normal power line conditions, non-ideal supply and loading conditions, etc.

4.

Experim ental verifications o f the accuracy o f the adaptive detection method have

been conducted, which have covered typical distorted power line conditions for normal and unbalanced operations. As an illustration, this thesis has presented four

experimental case studies: three for typical distorted power line conditions, and one for unbalanced power line condition.

6.3

· Future Work

The following presents recommended future work on the power line active filtering operations.

78

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

spr

Carry out field tests of the adaptive power line harmonic detection method.

The

results given in this tliesis are obtained in the Power Electronics Laboratory at Ryerson University. It is recommended to conduct the field tests in the industrial

sites which have large power electronic motor drives.

Improve the adaptive harmonic detection method based on the findings of the field tests.

Eliminate the high orders of the power line harmonics. It is a common difficulty that active filters cannot easily eliminate the high-order power line harmonics witliout either operating at very high switching fiequency or using a high-frequency passive filter.

79

Bibliography

[1]

L. Gyugi, E.C. Strycula, "Active AC Power Filter," Conf. Rec. of IEEE-IAS Annual Meeting, Oct. 1976, pp. 529-535

[2]

Luowei Zhou, Zicheng Li. "A Novel Active Power Filter Based on the Least Compensation Current Control Method," IEEE Trans. On Power Electronics, Vol. 15, No. 4, July 2000, pp. 655-659

[3]

Bhim Singh, Kamal ATHaddad. "A review of Active Filters for Power Quality Improvement," IEEE Trans. On Industrial Electronics, Vol. 46, No. 5, Oct 1999, pp. 960-971

[4]

Tai Ling Leung, Sami Vahviita, Seppo J. Ovaska. "Adaptive and delayless Filtering System for Sinusoids with Varying Frequency," Southeastcon '99. Proceediiigs. IEEE , 25-28 March 1999, pp. 149-153

[5]

Hirofumi Akagi, Yoshihira Kanazawa, Akira Nabae. "Instantaneous Reactive Power Compensators Comprising Swithing Device without Energy Storage Components," IEEE trans. On Industry /qrplications, Vol. LA-20, No. 3, May/June 1984, pp 625-631

[6 ]

Chen, C.L., Lin, C.R., Huang, C.L.: "Reactive and Harmonic Current Compensation for Unbalanced Three-phase Systems Using tlie Synchronous detection Method," Elec. Power Syst. Res., 1993, 26, pp 163-170

[7]

S. Bhattacharya, A, Veltman, D. M. Divan, and R. D. Lorenz, "Flux based active filter controller," in Conf. Rec. IEEE-IAS Annu. Meeting, 1995, pp. 2483-2491.

80 M
iroduced with permission of the copyright owner. Further reproduction prohibited without permission.

[8 ]

M. Rastogi, N. Mohan, and A. A. Edris, "Filtering of harmonic currents,damping of resonances in power systems with a hybrid-active filter," in Proc. IEEE APEC'95, 1995,pp. 607-612.

[9]

W.M. Grady, M. Samotyj, A.H. Noyola, "Survey of Active Power line Conditioning Methodologies," IEEE Trans. On Power Delivery, vol. 5, No. 3, July, 1990, pp. 15261542

[10]

W.M. Grady, M. Samotyj, A.H. Noyola, "Improving Power Quality with Active Power Line Conditioners," First International conference on. Power Quality, Paris France, Oct 1991, pp. 213-220

[11]

B. Widrow et al., "Adaptive Signal Processing," Printice HaU, Englewood Cliffs, N.J., 1985

[12]

Wang Qun; Wu Ning; Jiang Zejia; "An adaptive detecting approach of harmonic currents for active power filter," Power System Technology, 1998. Proceedings of POWERCON '98. 1998 International Conference, Vol. 2 , 18-21 Aug. 1998 pp:1528-1532

[13]

Fukuda, S.; Furukawa, Y.; Kamiya, H.; "An adaptive current control technique for active filters," Proceedings of the Power Conversion Conference, 2002. PCC Osaka 2002. vol. 2 , 2-5 April 2002. pp:789 - 794

[14]

Dastfan, A.; Gosbell, V.J.; Platt, D.: "Control of a new active power filter using 3-D vector control," IEEE Trans, on Power Electronics, Vol. 15, Issue: 1 , Jan. 2000 pp: 5 - 1 2

[15]

de Battista, H.; Mantz, R.J.: "Harmonic series compensators in power systems: their control via sliding mode," IEEE Trans on Control Systems Technology, Vol. , Issue:
6 8

, Nov. 2000, pp: 939 - 947

81

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

[16]

Soares, V.; Verdelho, P.; Marques, G.D.: "An instantaneous active and reactive current component method for active filters," IEEE Transactions on Power

Electronics, Vol. 15, Issue; 4 , July 2000, pp:660 --669 [17] Fukuda, S.; Kamiya, H.: "Adaptive learning algoridim assisted current control for active filters," IEEE Conference Record of Industry Applications Conference, 36th IAS Annual Meeting, 2001,Vol. 1 , 30 Sept.-4 Oct.
2 0 0 1

, pp: 179 - 185 vol.l

[18]

J. G. Jiang, Q. Wang: "A Study of Hamronics Reduction, detection and Evaluation," IEEE Proceedings of tlie 3'^'^ World Congress on Intelligent Control and Automation, June 28- July 2, 2000, Hefei, China, pp. 3759-3760

[19]

Jou, H.-L.: "Performance comparison of tlie tliree-phase active-power-filter algorithms," lEE Proceedings of Generation, Transmission and Distribution, Vol. 142, Issue: 6 , Nov. 1995, pp:646 - 652

[20]

M. EI-Habrouk, M.K Darwish, P. Mehta: "Active power filter:; A reviev/," lEE Proc,- Electr. Power AppL, Vol. 147, No. 5, Sept. 2000

[21]

H.Akagi, A. Nabae, and S. Atoh, "Control strategy of active power filters using multiple voltage-source PWM converters," IEEE Trans. Ind. Appl.,vol. LA-22, no.3, pp. 460,1986.

[22]

H, Akagi, F.Z. Peng, A.Nabae, "A Study of active power filters using quad-series Voitage-Source PWM Converters for Hannonic Compensation," IEEE Trans. Power Electron., vol.5, no.l, pp.9, 1990.

[23]

A.Cavallini, G.C.Carlo, "Compensation Strategies for Shunt Active filter control", IEEE Trans. Power Electron.,vol. 9, no. 6 , pp. 587, 1994.

82

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

[24]

Vasco Soares, P.Verdelho, and G.D.Marques, "An Instantaneous Active and Reactive Current Component Method for Active Filters", IEEE Trans. Power Electron.,vol. 15,no.4, pp.660, 2000

[25]

S-J Huang, J-C wu, "A Control Algoritlim for Three-Phase Tliree-wired Active Power Filters Under Nonideal Mains Voltages", IEEE Trans. Power Electron.,vol.l4, no.4, pp.753, 1999.

[26]

L.A.Moran, Juan W. Dixon, R.R.WaIlace, "A Three-Phase Active Power Filter Operating with Fixed Switching Frequency for Reactive Power and Current Harmonic Compensation", IEEE Trans. Ind. Electron., vol.42, no.4, pp.402, 1995

[27]

L.Benchatia, S.Saadate and A.Salem nia. "A Comparison of Voltage Source and Current Source Shunt Active Filter by Simulation and Experimentation", IEEE Trans. Power Systems, vol. 14, no. 2. pp.642 , 1999.

[28]

Juan W.Dixon, J.J.Garcia, and Luis Moran, 'Control System for Three-Phase Active , Power Filter Which Simultaneously Compensates Power Factor and Unbalanced Loads", IEEE Trans.Ind. Electron.,vol.42, no.6 , pp.636, 1995

[29]

J.Sebastian Tepper, Juan W.Dixon, G.Venegas, and Luis Moran, "A Simple Frequency-Independent Method for Calculating the Reactive and Harmonic Current in a Nonlinear Load", IEEE Trans. Ind. Electron., voI.43.,no.6, 1996

[30]

C.KLDufFey, Ray P. Stratford, "Update of Harmonic Standard IEEE-519; IEEE Recommended Practices and Requirements for Harmonic Control in Electric Power Systems", IEEE Trans. Ind.Appli.,vol.25, no.6 ,nov/dec., 1989

[31]

SIMULINK-Dynamic System Simulation for MATLAB® , Using SIMULINK Version 2 ., The Mathworks Inc. 1997

83

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

[32]

N.Mohan, T.M.Undeland and W.P.Robbins, "Power Electronics- converters, applications, and design", 2"^ edition John Wiley & Sons, New York.

[33]

G. Ledwich, P. Doulai, "Multiple Conveiler Performance and Active Filtering," IEEE Tran. On Power Electronics, Vol. 10, No. 3, May 1995, pp. 273-279

[34]

S. Fukuda, T. Endoh, "Control Metliod for a Combined Active Filter System Employing a Current Source Converter and a High Pass Filter," IEEE Industry Applications, Vol. 31, No. 3, May/June 1995, pp. 590-597

[35]

H. Akagi, "Trends in Active Power Line Conditioners," IEEE Trans. On Power Electronics, Vol. 9, No. 3, May 1994, pp 263-268

[36]

A. Flemming, D. Alain, "Adjustable Speed Drive with Active Filtering Capability for Harmonic Current Compensation," IEEE PESC, Vol. 11, 1995, pp. 1137-1143.

84

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Appendix A Simulation Models for Two Conventional Detection Methods

This appendix presents two Simulink models; one for the instantaneous reactive power detection method for the control of active filters, and one for the synchronous detection method.

1

Sim ulink model o f instantaneous reactive power method

Figure A1 illustrates the Simulink model of instantaneous reactive power method. Inputs 1, 2, 3 are 3-phase power line voltages, input 4, 5,
6

are the 3-phase load currents. Output! is . Output2 is shown as q

shown as p in Figure A 1. It is the ac component of the real power

in Figure A l. It is the ac component of imaginary power< 7 ^^. In this model, a low-pass filter has been used as required by the method to extract p^^ and .

2

Sim ulink model o f synchronous detection method

Figure A2 shows the Simulink model for the synchronous detectionmethod. Input 1, 2, and 3 are the 3-phase power line voltages, and mput 4, 5, and
6

are 3-phase loadcurrents. Output

I, 2, and 3 are the harmonics calculated by the synchronous detection method. A low-pass filter is used as required by the method to obtain the average power .

85

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

m

o

--------------------------

M.
36300000000

GD

2:
L U

r

ii
--

Figure A l: Model of instantaneous reactive power method

CD-

ay

>CD

d> C> CZ>

*CD

K Z D w t.e

Figure A2: Model of synclii'onous detection method

86

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Appendix B Simulation Results of Two Conventional Detection Methods

This appendix presents the simulation results of the instantaneous reactive power method and the synchronous detection method. The results are presented as follows;

1

Harmonics from rectifier RL load Harmonics from rectifier load with unbalanced single-phase loads Harmonics from rectifier RL load with unbalanced line voltage Harmonics from rectifier RLC load with unbalanced line voltage

2

3. 4.

Harm onics from rectifier RL load

Instantaneous reactive power method

'\N\I\I\I\, IM S N W r \N \I\N\I Ü . =·
(a) (b)

-i» , ' S

h'\/\A /\/\/\, /W W \2 i-\/\/\A /\/\/
(c)

Figure B l: Detection results of rectifier RL load using instantaneous reactive power method

w ,,

87

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Figure B 1 (a) shows the power line current before compensation.

Figure B i (b) shows the detected harmonics using instantaneous reactive power method. Figure B 1 (c) shows the current after compensation.

Synchronous detection method

'VVAAAA, ii; H 'xATV'f/VAJ ii'
(a) (b)

/VVVVV'
!

\l\l\l\l\l\l
(c)

Figure B2: Detection results of rectifier RL load using synchronous detection method

Figure b . {a'l snows the power line current before compensation. Figure B2 (b) shows the detected harmonics using synchronous detection method. Figure B2 (c) shows the current after compensation.
2 Harmonics from rectifier load with unbalanced single-phase loads

Instantaneous reactive power method

W V W \ I li/VAA/W') 1 V / V W (a) V V i(b)

W VW L AAAAAA \AAAAA/
(c)

Figure B3: Detection results of unbalanced load using instantaneous reactive power method

88

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Figure B3 (a) shows the power line current before compensation.

Figure B3 (b) shows the detected harmonics using instantaneous reactive power method. Figure B3 (c) shows the current after compensation

Synchronous detection method

W / W w

W W w
(a)

W W / w

ii-fiwnwfiwwArwfïi^ j-WAAAAj i'AAAAAA i'; / \ A A / W \ i-V W W V
v S A W V M
(b) (c)

Figure B4: Detection results of unbalanced load using synchronous detection method

Figure B4 (a) shows the power line current before compensation. Figure B4 (b) shows the detected harmonics using synchronous detection method. Figure B4 (c) shows the current after compensation.

89

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

If

3.

Harmonics from rectifier RL load with unbalanced line voltage

Instantaneous reactive power method

'V V V V V ^ J / \ / V / \ / \ A f 'i

if If if
(b)

i

\/v w w
(a)

i «

£

X /^ '

' X /X v /\/X v / (c)

Figure B5: Detection results of rectifier RL load using instantaneous reactive power method with unbalanced power line voltage

Figure B5 (a) shows the power line current before compensation. Figure B5 (b) shows the detected harmonics using instantaneous reactive power method. Figure B5 (c) shows the current after compensation.

Synchronous detection method

i-%WAAAv 'VVVVVL if I -AAAAAA If W W W ifW W W !'W W W (c)
(a) (b) Figure B6; Detection results of rectifier RL load using synchronous detection method with unbalanced power line voltage

90

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Figure B6 (a) shows the power line current before compensation.

Figure B6 (b) shows the detected harmonics using synchronous detection method. Figure B6 (c) shows the current after compensation.

4.

Harmonics from rectifier RLC load with unbalanced line voltage

Instantaneous reactive power method

/w W W
(a) (b)

:V\A/\ N \ AAAAAA ·vW V W
(c)

Figure B7: Detection results of rectifier RLC load using instantaneous reactive power method with unbalanced pov/er line voltage

Figure B7 (a) shows the power line current before compensation. Figure B7 (b) shows the detected harmonics using instantaneous reactive power method. Figure B7 (c) shows the current after compensation.

91
5

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Synchronous detection method

VVVVVVj rVVXAAA AAAAAA | i i ' A A A / V V X VN/VVVV'
(a) (b)
(c)

Figure B8: Detection results of rectifier RLC load using synchronous detection method with unbalanced power line voltage

Figure B8 (a) shows the power line current before compensation. Figure B8 (b) shows the detected harmonics using synchronous detection method. Figure B8 (c) shows the current after compensation.

y

92

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

Appendix C DSP Software Codes for Adaptive Harmonic Detection Method
This appendix lists the DSP codes for adaptive harmonic detection method. The codes are composed using assembly language.

1.

Software module "tstvec.asm"

********************************************************************** FILENAME; DESCRIPTION: STATUS: By: include mmregs tstvec.asm Sets the interrupt vector address and includes Vector needed for real time applications Aug, 20, 2004 Weidong Liu ; Include conditional assembly options, ; Include standard register mnemonics.

* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

"c200mnrLi"

* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

GLOBAL DECLARATIONS
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

global _c_intO, PHANTOM, TI_ISR, NMI_ISR
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

This is the vectors table, to be located at OxOOOO@prog.
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

.sect "vectors" RESET INTI INT2 INT3 INT4 INT5 INT6 B B B B B B B _c_intO PHANTOM T IJ S R PHANTOM PHANTOM PHANTOM PHANTOM 00 02 04 06

08
OA

oc

; macro occupies fourteen words in the vector table. .# ( 1) MON_EINTR mon_eintr_vecs .else ; macro not in vector table. MON EINTR B B MON EINTR 93

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

HUNG 10 HUNG12 HUNG 14 HUNG16 HUNG18 HUNGIA .endif HUNG 1C HUNGIE HUNG20 TRAP NMI

B B B B B B B B B B B

HUNGIO HUNG12 HUNG14 HUNG16 HUNG18 HUNGIA

m

# w

HUNGIC HUNGIE HUNG20 TRAP NMI ISR

;macro occupies eight words in the vector table. J f(l) MON_ETRAP raon_etrap_vecs .else ; macro net in vector table. MON_ETRAP_B B MON_ETRAP HUNG28 B HUNG28 HUNG2A B HUNG2A HUNG2C B HUNG2C .endif HUNG2E B HUNG2E HUNG30 B HUNG30 HUNG32 B HUNG32 HUNG34 B HUNG34 HUNG36 B HUNG36 HUNG38 B HUNG38 HUNG3A B HUNG3A HUNG3C B HUNG3C HUNG3E B HUNG3E .end

94

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

2,

Assembly code linker command file

* Filename: tst2adf2.cmd * Author: Weidong Liu, Ryerson University * Last Modified: Aug, 20,2004 * Description: Assembly code linker command file for LF2407 DSP.

MEMORY { PAGE 0: VECTOR: PROG: BO: PAGE 1: MMRS B2 BOBl SARAM DATA
}

/* Program Memory */ org=00000h, len=00040h /* vectors */ org=00040h, len=07FBCh /* ext mem */ org=0FF00h, len=0100h /* CNF=1 */ /* Data Memory */ : origin = Oh , length = : origin = 0060h , length = : origin = 0200h, length = : origin = OSOOh, length = : origin = 8000h , length =

05Fh 020h 0200h 0800h 8000h

/* MMRS */ ADARAM */ /* EMIF */

SECTIONS { .text: .data: .bss: vectors: stack: sincos: datajog: van: pid_regl: monjnain: mon_j)geO: monjrgst:

> > > > > > > > > > > >

PROG PROG BOBl VECTOR SARAM BOBl BOBl BOBl BOBl PROG B2 B2

PAGEO PAGEO PAGE 1 PAGEO PAGE 1 PAGE 1 PAGE I PAGE 1 PAGE 1 PAGEO PAGE 1 PAGE 1

/* interrupt vectors */ /* stack */ /* sine variables */ /* data log space */ /* parameters */ /* PI control */ /* Main Mon */ !* Used by RT monitor*/ /* Used by RT monitor*/

95

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

3. Main routine and ISR (Interrupt service routine)
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

* Filename; * Author; * Last Modified; * Description; * .include ·global

main3.asm weidong liu Aug, 20, 2004 System and buffers initialization ADC, PWM, and interrupt setup "x24x_app.h" _c_mtO, T IJS R , PHANTOM, N M IJSR .global MON_RT_CNFG DATA_LOG, DATA_LOG_INIT dlog_iptrl, dlog_iptr2 trig_value

* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

.ref .ref .ref Constant definitions d Pjnum sample_TP half_sampl mio_a mio b

.set 150 .set OOOSh .set 2000 .set 750 .set 0200h .set 0200h

delay 4.95us number of sampling points sampling firequency (2000-- >15KHz) half of the period ;performance factor Q15, range 0-1 ;performance factor Q15, range 0-1

Uninitialized global variable definitions w_coeffa w_coeffb vltg_a vltgjb loadja loadjb cm pja cm pjb cm pjc fund_comp_a fund_comp_b fimd_comp_c ;out_adpt_a ;out_adpt_b ;out_adpt_c err_a .usect .usect .usect .usect .usect .usect .usect .usect .usect .usect .usect , .usect .usect .usect .usect .usect "vari", P_num "vari", P_num "vari", P_num "vari", P_num "vari", 1 "vari", 1 "vari", 1 "vari", 1 "vari", 1 "vari", 1 "vari", 1 "vari", 1 "van", 1 "vari", 1 "vari", 1 "vari", 1 tweights of adapter,a ;weights of adapter,b ;phase a voltage ;phase b voltage ;phase a load current ;phase b load current ;phase a compensating current ;pliase b compensating current ;phase c compensating current ;fundamental component, phase a ;fundamental component, phase b ;fundamental component, phase c ;adapter output, phase a ;adapter output, phase b ;adapter output, phase c ;harmonics, pliase a

96

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

"I

err_b err_c mio_err_a mio_errJb tempi sign norm ia__gam ia_offset ib_gain ib_offset cmpa_gain cmpa_offset cmpb_gain cmpb_offset ua_gain ua_offset ub_gain ub_offset .text c intO: Macro defining

.usect .usect .usect .usect .usect .usect .usect .usect .usect .usect .usect .usect .usect .usect .usect .usect .usect .usect .usect

"vari" "vari" "vari" "van" "vari" "vaii" "vari" "vari" "vari" "vari" "vari" "vari" "vari" "vari" "vari" "vari" "vari" "vari" "vari"

;harmonics, phase b ;harmonics, phase c ;2*mio*e(k) in weights update ;2*mio*eO<;) in weights update ;genetal purpose variable

' .MACRO .loop d NOP .endloop .ENDM initia .MACRO LAR LDP MAR .loop SPLK .endloop .ENDM addr A Rl, #addr #addr *,AR1 Pjnum #0000h, *+

;set the delay time

;to 'Os' of phase a voltage

macro for moving data in voltage buffer, voltage result is stored in the buffer, the old data are move to next higher address, so the lastest data is always stored in the first location of the buffer mov .MACRO addrl

97

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

MAR LAR LDP 8AR LACC ADD SUB SACL LAR LDP .loop DMOV .endloop .ENDM

*, ARO ARO, #addrl #templ ARO, tempi tempi #P_num #2 tempi ARO, tempi #addrl Pjnum-1 *_

;ARO as the pointer ;store ARO to tempi ;point to the bottom of the buffer ;move starts at ;the second last data address

;every data is copied to next location

jMacro for fundamental computation Fund MACRO LAR LAR LACC #0 SPM .loop P_num LDP MAR LT LDP MPY APAC .endloop SPM LDP SACH f .ENDM
v ,w ,f AR2,#v AR3,#w 1

;COMPUTE X'*W #v * AR2 *+,AR3 #w *+

0 #f

;Configure tlie System Control and Status Registers POINT_PGO CLRC SETC CLRC SPM ;Clear Sign Extension Mode ;Config Block BO to Data memory.

SXM OVM CNF 0

98

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

initializing data buffer initia initia initia initia LDP SPLK SPLK SPLK SPLK SPLPC SPLK SPLK SPLK SPLK SPLK SPLK SPLK vltg_a vltgjb w_coeffa w_coeffb #ia_gain #lFFFh, ia_gain #0000h, ia_offset #21F0h, ib_gain #0100h, ib_offset #lFFFh, ua_gain #0280h, ua_offset #lF3Fh, ub_gain #0200h, ub_offset #lFFFh, cmpa_gain #0000h, cmpa_offset #lFFFh, cmpb__gain #0000h, cmpb__offset

Q13 Q15 Q15 Q15 Q13 Q15 Q13 Q15 Q13 Q15 Q13 Q15

set configuration registers P0INT_PF1 SPLK #0085h,SCSRl LACC SCSR2 OR #000000000000101 lb AND #0000000000001111b SACL SCSR2 Disable the watchdog POINT_PFl SPLK #0000000011101000b, WDCR LDP #templ SPLK #0000000001000000b, tempi OUT tempi, WSGR

; with 4X clock=30MHz

Configure I/O pins POINT_PF2 SPLK #0000111111000000b, MCRA SPLK #1111111000000000b, MCRB SPLK #0000h, MCRC ;set 6 PWM outputs

99

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

sik je n stk

.set 100 .usect "stack", stk_len.

;setup the software stack

Configure timerl AND PWM POINT_EV SPLK #0000h, TICON SPLK #0000h, T2CON SPLK #0000h, GPTCON SPLK #0000h, TICNT SPLK #sample_TP, TIPER ^ P L K #0000000000000000b, ACTR SPLK #0000101000000000b, COMCON SPLK #1001000001000000b, TICON setup ADC POINT_PF2 reset ADCTRLl SPLK #0100000000000000b, ADCL_CNTL1 Cased, start-stop mode SPLK #0010000000010000b, ADCL_CNTL1 set ADC conversion order SPLK #5, MAXCONV SPLK #6420h, CHSELSEQl SPLK #00A8h, CHSELSEQ2 SPLK #0000h, CHSELSEQ3 SPLK #0, CALIBRATION ;point to stack LAR AR7, #stk ;initialize parameter display function CALL DATA LOG INIT setup core interrupts POINT_PGO SPLK #0000h,IMR CALL MON_RT_CNFG LACC IFR SACL IFR SPLK #0000000001000010b, IMR POINT_EV SPLK #OFFFFh, EVAIFRA SPLK #OFFFFh, EVAIFRB SPLK #OFFFFh, EVAIFRC SPLK #0080h, EVAIMRA SPLK #0000h, EVAIMRB SPLK #0000h, EVAIMRC POINT_EVB SPLK #OFFFFh, EVBIFRA ;RESET CONTROL REGISTERS

6 PWM forced-low initially load ACTR immediately compare action disabled enable timerl, counting up mode

;call realtime monitor routine

;enable INT2 and 7 ;setup the event manager interrupts

;enable timerl period int

100

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

SPLK SFLK SPLK SPLK SPLK CLRC ;main code loop B

#OFFFFh, EVBIFRB #OFFFFh, EVBIFRC #0000h, EVBIMRA #0000h, EVBIMRB #0000h, EVBIMRC INTM

;enable glooal interrupt

loop

****************************************************************** * Interrupt servuce routine T IJ S R * Description: In this ISR, the following functions are implemented * - ADC conversion * - Adaptive algorithm * - PWM generation
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *

XI ISR: SETC POINT_ MAR MAR SST SST SACH SACL POINT_EV LACC SACL mov mov

SXM PGO *+ #1, *+ #0, *+ *+ * EVAIFRA EVAIFRA vltg_a vltg_b

;Context saving ;AR7 is stack pointer ;skip one position ;save STl ;save STO ;save acc high ;save acc low ;clear EVA interrupt flag ;clear EVA interrupt flag ;move voltage buffer

load current conversion of phase a P0INT_PF2 LACC XOR LDP SACL LT MPY PAC ADD

ADC_RESULTO, 6 #8000h #templ tempi ia_gain tempi ia_offset,13

;Ia_gain in Q13 ;Q13xQ15 = Q28 ;add offset in Q28

101

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

LDP SACH

#load_ia load_ia,3

;Convert final result to Q15

load current conversion of phase B POINT_PF2 LACC XOR LDP SACL LT MPY PAC ADD LDP SACH ADC_RESULT1, 6 #8000h #templ tempi ib_gain tempi ib_offset,13 #load_ib load_ib,3

;Ib_gain in Q13 ;Q 1 3 x Q 1 5 = Q 2 8 ;add offset in Q28 ;Convert final result to Q15

conversion of newest a-phase voltage POINT_PF2 LACC XOR LDP SACL LT MPY PAC ADD LDP SACH

ADC_RESULT2, 6 #8000h #templ tempi ua_gain tempi ua_otfset,13 #vltg_a vltg_a,3

;ua_gain in Q13 ;Q 13xQ 15 = Q28 ;add offset in Q28 ;Convert final result to Q15

;conversion of newest b-phase voltage POINT PF2 LACC XOR LDP SACL LT MPY PAC ADD LDP SACH

ADC_RESULT3, 6 #8000h #tempi tempi ub_gain tempi ub_offset,13 #vltg_b vltg_b,3

;ub_gain m Q13 ;Q 1 3 x Q 1 5 = Q 2 8 ;add offset in Q28 ;Convert final result to Q15

102

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

conversion o f output current from active filter

POINT _PF2 LACC XOR LDP SACL LT MPY PAC ADD NEC LDP SACH POINT _PF2 LACC XOR LDP SACL LT MPY PAC ADD NEG LDP LDP LACC LDP ADD NEG LDP SACL

ADC_RESULT4, 6 #8000h #templ tempi cmpa_gain tempi cmpa_offset,13 #cmp_ia cmp_ia,3 ADC_RESULT5, 6 #8000h #templ tempi cmpb_gain tempi cmpb_ofFset,13 #cmp_ib #cmp_ia cmp_ia #cmp_ib cmp_ib #cmp_ic cmp_ic

;Ia_gain in Q13 ;Q13 xQ15 = Q28 ;add offset in Q28

;Convert final result

;Ib_gain in QI3 ;Q13 xQ 15 = Q28 ;add offset in Q28

;calculate cmp_ic ;cmp_ic==- (cmp_ia+cmp_ib)

GOMPUTE FUNDAMENTAL COMPONENTS Fund vltg_a, w_coefFa, fund_comp__a Fund vltg_b, w_coeffb, fund_comp_b LDP #fund_comp_a LACC fimd_comp_a LDP #fund_comp_b ADD fund_comp_b NEG LDP #frmd_comp_c SACL fund_comp_c

103

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

COMPUTE HARMONIC CURRENT FOR A-PHASE LDP LACC LDP SUB SACH #load_ia load_ia, 16 #fund_comp_a ftmd_comp_a,16 err_a

;COMPUTE HARMONIC CURRENT FOR B-PHASE

LDP LACC ^ LDP SUB SACH

#load_ib load_ib, 16 #fund_comp_b fund_comp_b, 16 eiT_b

;COMPUTE HARMONICS CURRENT FOR C-PHASE LDP LACC LDP ADD NEG LDP SACL #eiT_a err_a #err_b err_b #eiT_c err_c

;PWM SWITCHING SIGNAL GENERATION LDP LACC LDP SUB BCND BCND POINT_EV LACC AND SACL delay OR SACL B
Gita

#cmp_ia cmp_ia,16 #err_a err_a,16 Bphase, EQ Grta,GT ACTR #1111111111111100b ACTR #0000000000001100b ACTR Bphase

;openlbtm

;close Itop

POINT_EV LACC

ACTR

104

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

AND SACL delay OR SACL Bphase LDP LACC LDP SUB BCND BCND POINT_EV LACC AND SACL delay OR SACL B Grtb POINT_EV LACC AND SACL delay OR SACL Cphase LDP LACC LDP SUB BCND BCND POINT_EV LACC AND SACL delay OR SACL B Grtc POINT_EV LACC AND

#111 111 111 1110011b ACTR #000000000000001 lb ACTR

;open Itop switch

;close Ibtm switch

#cmp_ib cmp_ib,16 #err_b err_b,16 Cphase, EQ Grtb,GT ACTR #1111111111001111b ACTR #0000000011000000b ACTR Cphase ACTR #111111110011111 lb ACTR #0000000000110000b ACTR #cmp_ic cmp_ic,16 #err_c err_c,16 WW,EQ Grtc,GT ACTR #1111110011111111b ACTR #0000110000000000b ACTR ww ACTR #1111001111111111b

;open 2btra switch ;close 2top switch

;open 2top switch ;close 2btm switch

V ;open 3btm switch

;close 3top switch

;open 3top switch

105

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

SACL delay OR SACL WW

ACTR #00000011OGOOGGGOb ACTR ;close 3btm

;UPDATE COEFFICIENTS LDP LT LACC LDP SACL MPY PAC RPT SFL LDP SACH' LAR LAR SPM .loop MAR LDP LT LDP MPY PAC LDP ADD SACH .endloop SPM ;UPDATE WEIGHTS LDP LT LACC LDP SACL MPY PAC RPT SFL #err_b err_b #mio_b #templ tempi tempi #1 #err_a err_a #mio_a #templ tempi tempi #1 #mio_err_a mio_err_a AR2, #w_coefFa AR3, #vltg a 1 P_num *, AR3 #mio_err_a mio_err_a #vltg_a *+, AR2 #wl.coefFa *,16

;Q15xQ15=Q30 ;ue Q15 ;2ue Q15 ;2ue, Q15

;2ue*X

;Q30 ;W(k+I)=W(k)+2

0

106

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

LDP SACH LAR LAR SPM loop MAR LDP LT LDP MPY PAC LDP ADD SACH .endloop SPM LDP SPLK SPLK SPLK CALL P0INT_PF2 SPLK

#mio_err_b mio_err_b AR2, #w_coefïb AR3, #vltg_b 1 P_num *,AR3 #mio_err_b mio_err_b #vltg_b »+, AR2 #w coeffb *,16 *+ 0 #dlog_iptrl #load_ia, dlog_iptrl #flind_comp_a, dlog_iptr2 #01 OOh,trig_value ;Trigger value DATA_LOG #0110000000000000b, ADCL_CNTL2 ;Reset+SOC SEQl istart next ADC

Context restore POINT_PGO MAR LACL ADDH LST LST CLRC CLRC RET

*, AR7 *_ #0, *#1 ,* INTM SXM

;make stack pointer active ;Restore Acc low ;Restore Acc high ;load STO ;load STl

Reproduced with permission of the copyright owner. Further reproduction prohibited without permission.

