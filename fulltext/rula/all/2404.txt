A D A P T IV E SU BC A R R IER ALLOCATION FO R ORTHOGONAL FR EQ U EN C Y CODE DIV ISIO N M ULTIPLEXING (OFCDM )
by

Ryan B. Caldwell B.Eng., Ryerson University, Toronto, Ontario, Canada, 2004

A thesis presented to Ryerson University in partial fulfilment of the requirement for the degree of Master of Applied Science in the program of Electrical and Computer Engineering

Toronto, Ontario, Canada, 2005 ©Ryan Caldwell 2005

P R O P fR T V 'O F R Y E M O W iJffiV iftSITYL IB fl

U M I N um ber: E C 5 3 0 0 7

All rights reserved INFORMATION TO U S E R S

T h e quality of this reproduction is d e p e n d en t upon th e quality o f th e co p y subm itted. Broken or indistinct print, colored or poor quality illustrations and ph otograp hs, print bleed-through, substandard m argins, and im proper align m en t can a d v e r se ly affect reproduction. In th e unlikely e v e n t that th e author did not se n d a co m p lete m anuscript and there are m issin g p a g e s , t h e s e will b e noted. A lso, if unauthorized copyright m aterial had to b e rem oved , a note will indicate th e deletion.

UMI
UMI Microform E C 5 3 0 0 7 Copyright 2 0 0 8 by P roQ u est LLC All rights reserv ed . T his microform edition is protected a g a in st unauthorized copying under Title 17, United S ta te s C od e.

P roQ u est LLC 7 8 9 E ast E isen h o w er Parkw ay P.O . B ox 1 3 4 6 Ann Arbor, Ml 4 8 1 0 6 -1 3 4 6

A uthor's Declaration
I hereby declare that I am the sole author of this thesis. I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research._____ _ Author's Signature: ^ ___ =_

I further authorize Ryerson University to reproduce this thesis by photocopying or other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. Author's Signature: __ T _

u

A b stract A d a p tiv e Subcarrier A llo ca tio n for O rth ogon al F requ en cy C od e D iv isio n M u ltip lex in g (O F C D M )
© R y a n Caldwell, 2005 M aster o f A pplied Science Electrical and Com puter Engineering R yerson U niversity

In this thesis, a novel adaptive subcarrier allocation algorithm is developed for OFCDM. This algorithm utilizes groups of evenly spaced, non-contiguous sub carriers throughout the spectrum. The users are allocated to subcarriers groups with the intention of minimizing the overall BER. This is accomplished by assigning a user to the set of subcarriers that provides the best Signal to Interference and Noise Ratio (SINR), while producing the least amount of interference to other users accessing the same sub carrier group. The expected interference produced by this user is then utilized to recalculate the SINR for the subcarrier group, and the allocation process continues recursively until all users are assigned to subcarriers. The proposed algorithm is shown to provide a performance improvement ranging from 1.5dB with 2x16 spreading, to 7dB with 16x2 spreading. The algorithm is also shown to maintain or improve the BER floor for each OFCDM spreading configuration.

m

Acknowledgem ent
I would first like to thank my supervisor Dr. Alagan Anpalagan for his excellent guidance, helpful feedback and continuous support throughout my research. I would also like to acknowledge the Department of Electrical and Computer Engineer ing and the School of Graduate Studies at Ryerson University for their support in terms of financial aid, and work experience as a teaching assistant. In addition I would like to thank the committee for the Ontario Graduate Scholarship (QOS) for funding during my Master's degree. Finally, I would like to thank my fiancee Jennifer Hall, and my family for their continu ous support during my Master's degree.

IV

C o n te n ts
1 In tro d u ction 2 O F D M and M ulticarrier C D M A 2.1 Orthogonal Frequency Division M u ltiplexing ........................................................ 2.1.1 OFDM T ra n sm itte r....................................................................................... 2.1.2 Wireless OFDM T ran sm issio n .................................................................... 2.1.3 OFDM R eceiver.............................................................................................. 2.2 Code Division Multiple Access (CDMA) .............................................................. 2.2.1 PN Sequence S e le c tio n ................................................................................. 2.2.2 Multiple A c c e s s .............................................................................................. 2.3 Multicarrier C D M A .................................................................................................... 2.3.1 Multicarrier CDMA (M C-CD M A).......................... 2.3.2 Multicarrier Direct-Sequence CDMA (M C -D S -C D M A )........................ 2.3.3 Orthogonal Frequency Code Division Multiplexing (OFCDM) . . . . L iterature Survey 3.1 Adaptive M C -C D M A ................................................................................................. 3.2 Adaptive M C-DS-CDM A........................................................................................... 3.3 O F C D M ........................................................................................................................ A d a p tiv e Subceirrier A llocation 4.1 Subcarrier G r o u p in g ................................................................................................. 4.2 Adaptive OFCDM System M o d e l........................................................................... 4.2.1 Adaptive OFCDM T r a n s m itte r ................................................................. 4.2.2 Channel M o d e l .............................................................................................. 4.2.3 Adaptive OFCDM R e c e iv e r........................................................................ 4.2.4 SINR C a lc u la tio n ........................................................................................... 4.2.5 BER Perform ance........................................................................................... 4.3 Sub carrier Allocation A lg o rith m .............................................................................. 4.3.1 The Algorithm ............................................................................. 1 6 7 8 12 13 15 19 21 22 23 26 27 30 31 34 36 40 41 43 43 45 46 49 50 51 53

3

4

5 Numerical Results and Discussion 5.1 System P aram eters............................................................................................. 5.2 Results and Discussion....................................................................................... 6 Conclusions and Future Research 6.1 Conclusions......................................................................................................... 6.2 Future Research...................................................................................................

57 57 59 66 66 67

VI

L ist o f T ab les
5.1 Spreading Factor Configurations............................................................................. 58

Vll

List of Figures
2.1 2.2 2.3 2.4 2.5 2.6 2.7 2.8 2.9 2.10 2.11 2.12 2.13 OFDM Spectrum with 4 Subcarriers ................................................................ Oscillator-Based OFDM Block Diagram .......................................................... IFFT-Based OFDM Block D iagram ................................................................... Cyclic Prefix F o rm a t........................................................................................... RF Transmitter, Channel, and Receiver............................................................. Oscillator-Based OFDM Receiver Block Diagram ........................................... FFT-Based OFDM Receiver Block D ia g ra m .................................................... Spread Spectrum System ...................................................................... Example of a Spread Spectrum System with = 4 7 ^ ..................................... Oscillator-Based MC-CDMA Block D iag ram .................................................... Oscillator-Based MC-CDMA Receiver Block D iagram ..................................... Oscillator-Based MC-DS-CDMA Block D iagram .............................................. Oscillator-Based OFCDM Block D iagram .......................................................... 7 8 10 11 12 14 15 17 18 24 25 27 28 32 33 38 42 44 46 55 60 61 62 63 64 65

3.1 Spectral Allocation for 32 Subcarrier FD-M C-CDM A..................................... 3.2 Sub carrier Allocation Groups for Frequency Hopping M C -C D M A ............... 3.3 Required Eb/Ng to achieve a PER of 10"^ for Adaptive OFCDM [21] . . . . 4.1 4.2 4.3 4.4 5.1 5.2 5.3 5.4 5.5 5.6 Subcarrier Allocation with 4 Subcarrier G r o u p s .............................................. Block Diagram for the Adaptive OFGDM S y s te m ........................................... Block Diagram for Adaptive OFCDM Receiver................................................ Adaptive Subcarrier Allocation Flowchart ....................................................... BER vs. Eb/No for non-adaptive OFCDM with various spreading factors . . BER vs. Eb/No with 16x2 spreading .................................................................. BER vs. Eb/No with 8x4 sp re ad in g ................................................................... BER vs. Eb/No with 4x8 sp read in g ................................................................... BER vs. Eb/No with 2x16 spreading .................................................................. BER vs.Eb/No for adaptive OFCDM with various spreading factors...............

vm

C h a p ter 1 In tr o d u c tio n
At the present time, mobile handheld communications devices are one of the most im portant necessities in personal life, business, and entertainment. Wireless devices are used for voice services, push-to-talk {PTT)[1], email, text messaging, mobile television (MobiTV)[2], and a variety of other applications. As time goes on, however, the demand for more complex and bandwidth intensive applications will continually increase. In the near future, users will require access to high speed internet, multimedia, and high definition streaming video on handheld wireless devices. These services generally require throughput in the Mbps range, which cannot be supported by the current wireless systems. Second Generation (2G) systems such as IS-95 and GSM originally provided a through put of 9.6kbps. W ith more advanced protocols such as IS-95B and GPRS implemented in addition, the throughput of these systems has been increased to 115.2kbps and 171.2kbps respectively [3], These data rates are not high enough to support demanding applications, such as multimedia or streaming video. There are a variety of Third Generation (3G) sys tems th at are currently being introduced, such as CDMA2000, WCDMA and TD-SCDMA. These technologies are required to provide a throughput of 2Mbps for fixed or pedestrian users and 384kbps for users with mobility [3]. Although throughput is improved considerably over 2G systems, it may still be insufficient to support the more demanding requirements

of streaming video and multimedia, especially when users are mobile. As a result, Fourth Generation (40) systems are being developed that can provide higher throughput for these demanding applications. In the area of fixed access wireless communications, such as WLAN, high throughput applications are quite common. Users access the internet, multimedia and streaming video on a regular basis with high reliability. The problem with these services, however, is that they are fixed within a building or localized area. Recently, some of these technologies have been considered for mobile communications systems. In particular, Orthogonal Frequency Division Multiplexing (OFDM), which is utilized in 802.11a and 802.11g, has been proposed as a likely candidate for 40 systems. This signalling method uses a parallel transmission of several low rate signals, each modulated to a different carrier frequency. The basis behind this idea is that the low rate subcarriers experience very little Intersymbol Interference (ISI) when transmitted through a multipath channel. Since excessive ISI is one of the most

significant impediments in a wireless environment, higher data rates are possible if ISI is reduced. A variety of 4G systems have been proposed that are based on OFDM. In Orthogonal Frequency Division Multiple Access (OFDMA) each user is assigned one or more low-rate subcarriers, allowing them to achieve resistance to ISI, and multiple access simultaneously [4]. Other variants include those which utilize Code Division Multiple Access (CDMA), the technology that is utilized in IS-95 and all 3G wireless systems. This technology allows multiple users to share the identical bandwidth by assigning user-specific code sequences with low cross correlation. These user-specific codes provide enhanced privacy, minimize the susceptibility to intentional jamming attacks, and minimize interference between users [3] Code spreading in the time domain, commonly known as direct-sequence CDMA, has beer combined with OFDM to produce Multicarrier Direct-Sequence CDMA (MC-DS-CDMA) [7]

In this modulation scheme, each subcarrier contains a DS-CDMA signal, and can accom modate several code-division users simultaneously with low Multiuser Access Interference (MAI). Another combination of CDMA and OFDM is Multicarrier CDMA (MC-CDMA) [8]-[10], W ith this scheme, spreading is performed across several sub carriers. Each adja cent subcarrier is allocated one chip from a particular spreading sequence, allowing users to be assigned to identical subcarriers that are spread orthogonally in the frequency domain. In addition to providing multiple access, this scheme benefits from the frequency diversity gained by transm itting over several independently faded sub carriers. A thorough description of MC-CDMA and MC-DS-CDMA is provided in sections 2.3.1 and 2.3.2 respectively. A recently introduced variant of Multicarrier CDMA combines the time and frequency domain spreading utilized in MC-CDMA and MC-DS-CDMA simultaneously [11]-[13]. This has been shown to provide more favorable bit error rate (BER) characteristics than utilizing time or frequency domain spreading independently. This occurs because frequency diversity is gained from spreading in the frequency domain, while multipath diversity and lower MAI may be achieved with time domain spreading. This technology, frequently named Orthogonal Frequency Code Division Multiplexing (OFCDM), is the technology that is examined in this thesis. The theoretical information regarding OFCDM is provided in section 2.3.3. W ith the introduction of OFDM and several variants of multicarrier CDMA for 4 0 sys tems, there has been much research that deals with methods to assign subcarriers th at maximize system performance [14]-[20]. Many of these papers examine the fading character istics of each subcarrier, channel loading, interference, and a variety of other characteristics, and assign the most favorable sub carriers to users such that the overall system performance is maximized. In this study, we develop a novel, low complexity adaptive subcarrier allocation algo rithm for OFCDM. The intention of this algorithm is to improve the BER performance

of OFCDM for all time and frequency domain spreading factors. To the best of the au thor's knowledge, this is the first adaptive subcarrier allocation algorithm to be developed for OFCDM. The proposed algorithm divides the spectrum into several groups of equally spaced, non-contiguous subcarriers. This is done to maximize gains from frequency diver sity, and to minimize MAI. Adaptive sub carrier allocation is then performed to minimize the overall BER of the cell. The subcarrier group with the largest SINR is assigned to the user that is expected to cause the lowest amount of MAI to other users accessing the same sub carrier set. The expected interference power caused by the user is then utilized to recalculate the SINR on the corresponding subcarrier group, and the next user is assigned to subcarriers with the same methodology. This algorithm continues recursively until all users are assigned to subcarrier gi'oups. In this thesis, the algorithm is shown to provide substantial performance improvements over non-adaptive OFCDM with various spreading factors, because the most favorable group of subcarriers is selected during each transmission interval. This report is organized as follows. In Chapter 2, we introduce the theory behind OFDM and CDMA, as well as several variants of multicarrier CDMA. This theory is used as a basis to discuss multicarrier CDMA with simultaneous time and frequency domain spreading. Detailed theory of each technology is discussed, as well as applications of each of these transmission methods. Following the theoretical information on OFDM and multicarrier CDMA, a literature survey is provided in Chapter 3. In this section, a summary of previous subcarrier alloca tion algorithms for both MC-CDMA and MC-DS-CDMA is provided, and their limitations are emphasized. There is also a review of papers that have examined the performance o multicarrier CDMA with various time and frequency domain spreading factors. The pro posed scheme is related to this previous research to form a basis for the subcarrier adaptatioi

strategy used in this thesis. In C h apter 4, the novel subcarrier allocation algorithm is presented for OFCDM. A thorough description of the sub carrier grouping strategy is provided, as well as the system model for the proposed system. This is followed by a detailed analysis of the transm itted and received signals, as well as the SINR and BER performance of the system. Following this, an explanation of the adaptive subcarrier allocation algorithm for OFCDM is provided. The system param eters and numerical results for this algorithm are provided in C hapter 5. This includes the BER performance of the proposed system with various spreading factors. These results are compared to current non-adaptive OFCDM systems to reinforce the benefits of the proposed algorithm. We conclude in C h a p te r 6 , where we summarize the benefits of the proposed algorithm, and point out directions for future research.

C on tribu tion s In this thesis, we present several unique contributions to improve the performance of OFCDM, and to quantify the effectiveness of the proposed algorithm. In particular, we · develop a subcarrier grouping strategy to maximize gains from frequency diversity · derive a closed-form solution for the BER performance of the OFCDM system with adaptive sub carrier allocation · propose a novel, low complexity adaptive subcarrier allocation for OFCDM · evaluate the performance of the proposed algorithm, and compare the results with non-adaptive OFCDM with various time and frequency domain spreading factors

Chapter 2 OFDM and M ulticarrier C D M A
As mentioned in the previous chapter, one of the main requirements for future wireless systems is to support high data rate applications including multimedia, streaming video and internet access. In order to support the demanding throughput requirements of these services, a very large bandwidth is required. This bandwidth requirement has yet to be defined for 4G systems, but it is expected to be as large as lOOMHz for the forward link, and up to 20MHz for the reverse link. Traditionally, a wideband single carrier has been utilized to support high data rates. This is evident in technologies such as High-Speed Downlink Packet Access (HSDPA) for WCDMA, and 3xRTT for CDMA2000, which utilize 5MHz and 3.75MHz bandwidths re spectively [3]. As the throughput requirements increase beyond those of 30 systems, ISI becomes more significant because the bit duration decreases with increasing bandwidth. This can also be viewed from the frequency domain, where a wider bandwidth experiences more frequency selectivity. This generally creates a BER floor caused by pulse distortion in single carrier systems [5]. As a result of these impediments, OFDM and several variant of Multicarrier CDMA have been proposed for 4C systems. These multicarrier systems ar

excellent candidates to support these large bandwidths because they utilize a parallel trans mission of low rate signals, each modulated to a different carrier frequency. This increases the pulse duration of the signal proportionally to the number of subcarriers, and as a result, it is much more resistant to ISI than wideband single carrier systems. The remainder of this chapter is organized as follows. In section 2.1, OFDM is discussed in detail, followed by an overview of CDMA technologj^ in section 2.2. A detailed description of various multicarrier CDMA systems is discussed in section 2.3. This includes the benefits and drawbacks of MC-CDMA and MC-DS-CDMA, and a description of OFCDM, which is the primary technology explored in this thesis.

2 .1

O r th o g o n a l F r eq u e n c y D iv is io n M u ltip le x in g

Orthogonal frequency division multiplexing is implemented by transm itting low-rate signals in parallel over several densely packed sub carriers. This is done with the intention of reducing the amount of frequency selectivity, or equivalently ISI, by utilizing narrowband subcarriers. Figure 2.1 shows an example of an OFDM spectrum with four subcarriers.

Figure 2.1; OFDM Spectrum with 4 Subcarriers

Each sine function in this frequency domain spectrum is generated by multiplying a complex rectangular time domain signal with a sinusoid at the frequency of the corresponding subcarrier. This rectangular function is generally a complex symbol modulated with PSK or QAM. Each of these sub carriers is spaced by a frequency of l/Tb, where T5 is the OFDM symbol duration. This ensures that orthogonality is maintained between subcarriers, because the peak of each subcarrier corresponds to nulls of all other adjacent subcarriers. It is evident from this figure that when transmitting over a frequency selective channel, increasing the number of subcarriers in the allocated bandwidth reduces the amplitude vari ations over each subcarrier. If the number of subcarriers is selected such that the subcarrier bandwidth is less than the channel's coherence bandwidth (l/Tj, < Bg), flat fading results on each subcarrier and there is no distortion. This is equivalent to selecting the bit duration to be larger than the RMS delay spread of the channel, which eliminates ISI. The following section discusses the OFDM signal generation.

2.1.1

OFDM Transmitter

Figure 2.2 shows the block diagram for a typical OFDM modulator. The incoming binary

-x E y V2cos(o,/)

Impulse Modulator

4 ,

Pulse Shaping

s/p

V 2cos(a,/)

s(t)

Cyclic Prefix

Æ cos(û),,/) Figure 2.2: Oscillator-Based OFDM Block Diagram

data stream, b« ^ ±1, zeN, is first impulse modulated with PSK or QAM to form a sequence of complex modulated symbols, d,. This sequence carries the amplitude and phase of the transm itted symbols. This is passed through a pulse shaping filter with response p{t -- This filter shape is generally rectangular for OFDM systems to ensure th at orthogonality is maintained between subcarriers. Each AI complex modulated symbols are then converted from Serial (S) into Parallel (P) format , where M is the number of subcarriers. The resulting parallel symbols on each subcarrier are denoted dj^rn, which represents the ^'th complex symbol on the m t h sub carrier. This operation increases the symbol duration by a factor of M , resulting in the pulse shape

0

otherwise. m e{l, 2 , , M},

These symbols are then modulated to sinusoidal subcarriers at frequencies

where m is the sub carrier index. This modulation is performed by multiplying each parallel symbol by a cosine function at the frequency of the intended subcarrier. These orthogonal subcarriers are then summed to produce the OFDM signal

g(() = = where
£b

- ;7b)cOs(a,m() ~ jTb)cOs{tOmt + Idj^rn),

is the energy per bit and TJ, is the OFDM symbol duration. If BPSK modulation is

utilized on the subcarriers, as is done in this thesis, this simplifies the transm itted signal to
M s{t)

= x/Sëï ^ 2 5 3 j rn=l

~ j ' Pb ) c O s { u J r n t) f

(2-3)

where bj^m is the jth bit on the mth subcarrier. At this point, a cyclic prefix can be added to ensure that orthogonality is maintained between subcarriers, and to aid with synchronization at the receiver. The cyclic prefix is discussed later in this section.

M odulation by IFFT One problem that has limited the implementation of OFDM systems in the past is the large number of subcarriers necessary to ensure resistance to frequency selectivity. In the past, hundreds, if not thousands, of precise, phase-coherent oscillators were required to modulate the signal to the subcarrier frequencies. If there were errors in the carrier frequencies of the oscillators, Intersubcarrier Interference (ICI) would result, reducing the system's per formance [5]. With advances in Digital Signal Processing (DSP), the Inverse Fast Fourier Transform (IFFT) has become an excellent method of OFDM modulation. This operation is equivalent to multiplying each bit by the desired subcarrier frequency, however, it ensures exact frequency spacing and phase coherence between subcarriers. The OFDM signal, s{t), is generated by performing the IFFT operation on the sequence of complex modulated sym bols, dj. This sequence represents the M complex symbols during the jth signal element. The block diagram for the IFFT modulator is shown in figure 2.3, and the signal is expressed

Impulse Modulator

S/P

IFFT

P/S

sit)

Cyclic Prefix

Figure 2.3: IFFT-Based OFDM Block Diagram

10

m athem atically for the j th signal element as
M

Sj { t )

=
m =l

t ` = M ·I F F T { d j ) ,

(2.4)

where i -- \ /

T. After the IFFT is used to modulate the complex symbols to their carrier

frequencies, the result is converted into a serial stream and a cyclic prefix is added. For simplicity of further sections, it is assumed th at the IFFT can be utilized as an alternative to the oscillator-based OFDM block diagrams. C yclic P refix The cyclic prefix is appended to the OFDM symbol for various reasons. Firstly, if the IFFT is utilized for OFDM modulation, the cyclic prefix is required to utilize a finite point IFFT in the frequency domain. This is necessary because the signal is assumed to be repeated infinitely in the time domain when a finite number of frequency domain points are used with the IFF T [5]. Since this is not practical, the time domain signal is repeated for the memory length of the channel. Figure 2.4 shows the operation of appending the cyclic prefix. In this operation, the last Mg (< M) samples of the current OFDM symbol are copied to the beginning of the frame. Another benefit of the cyclic prefix is that it theoretically eliminates Intersymbol Inter-

Cyclic Prefix (M S am ples)

OFDM Sym bol (M Sam ples)

Figure 2.4: Cyclic Prefix Format

11

ference (ISI). Since the duration of the cyclic prefix is at least equal to the channel's memory length, all ISI occurs during the cyclic prefix, leaving the OFDM symbol completely unaf fected by ISI. Finally, the cyclic prefix aids in synchronization at the receiver because it can be utilized to identify the beginning of an OFDM symbol. The only drawback is the reduc tion in spectral efficiency to a factor of M / (M 4- Mg) of its original value. Since Mg « the reduction in spectral efficiency is generally negligible. M,

2.1.2

W ireless OFDM Transmission

After OFDM modulation and the cyclic extension is added, the signal is transmitted through the wireless channel according to figure 2.5. The signal is first upconverted to the wireless carrier frequency. Although the specifications are not yet defined, 40 systems are expected to utilize a carrier frequency between 3GHz and 6GHz. If we assume that s'{t) is real, the RF transmitted signal is SRF{t) = s'{t)V2cos{2'ïïfct), where fc is the carrier frequency in Hz. The signal is then transmitted through a wireless channel. For demonstration purposes, it is assumed that the coherence bandwidth of the channel is equivalent to the subcarrier (2.5)

BPF

LPF

RF Transmitter

RF Receiver

Figure 2.5; RF Transmitter, Channel, and Receiver

12

bandwidth (l/T), -- Be). Based on this assumption, the channel model for the m th subcarrier during the j t h transm itted bit is flat, with the frequency domain response

^j,m =

(2.6)

where aj^m is the fading gain, and ipj^rn is the phase shift of the m th subcarrier during the j t h transm itted bit. The therm al noise on the channel is assumed to be Additive W hite Gaussian Noise (AWGN), with a double-sided Power Spectral Density (PSD) of Noj2. The received signal is rRrit) = SRF{t) * h{t) + (2.7)

where rj[t) is the AWGN noise signal, and h{t) represents the total impulse response over the M subcarriers. Referring to figure 2.5, the receiver passes the RF signal through a bandpass filter to limit the amount of noise entering the system. It is then downconverted by multiplying with a sinusoid at the carrier frequency, followed by low pass filtering to remove the image signal caused by demodulation. This recovers the noisy version of the transm itted baseband signal, r'{t). The cyclic prefix is removed, which recovers the noisy OFDM signal
M

r{t) =

y/2Sb
j

0!j,mbj,mP{t -- jTf,)cOs{uJrnt
m =l

+

^ j,m )

+

Vi ^)-

(2 8)

This signal is detected with the OFDM receiver discussed in the next section.

2 .1 .3

O F D M R eceiv er

The received OFDM signal, r{t), is processed with the block diagram shown in figure 2.6. The signal is first converted into parallel format, and restored to the baseband by multiplying 13

LPF

Remove Cyclic Prefix

» LPF

Figure 2.6: Oscillator-Based OFDM Receiver Block Diagram

with cosine functions matched to the frequency {umt --

This phase shift is used to

ensure that the phase shift produced by the channel is cancelled. This demodulation can also be accomplished by utilizing the Fast Fourier Transform (FFT) operation, which is shown in figure 2.7. The signal is then integrated over the bit period and sampled to generate the test statistic for the jth bit on the mth subcarrier

=

jr

r{t)V2cOs{uJmt ~ (fj,m)dt

(2.9)
-- y/^Olj,mbj,m
T

Vj,mi

where

is the noise component during the jth transmitted bit on the mth subcarrier. An is based on the test statistic, Zj^rn, as follows

estimate of the received bit,

+ 1 if Zj^rn > 0, bj,m -- * if  Z j-.m < 0. Based on the result in equation (2.9), the signal power at the output of the integrator i £b{ocj,m)^, and the noise power is No by definition. This yields an SNR, of the jth bi
( 2 . 10 )

14

in=C /+l)M
R em o v e Cyclic Prefix S /P FFT

*b

m - ( j - h l)Af

JM

Figure 2.7: FFT-Based OFDM Receiver Block Diagram

on the m th subcarrier to be T/.t
( 2 . 11)

By substituting this value into the BER equation, the resulting probability of bit error during the j t h signal element on the m th sub carrier is

( 2 . 12)

It is evident from this result that the probability of bit error for an OFDM system is equiva lent to the BER performance of traditional single carrier BPSK modulation in a flat channel with gain of aj^m-

2 .2

C o d e D iv is io n M u ltip le A c c e s s (C D M A )

Code division multiple access is a spread spectrum (88) communication technique for the transmission of digital information. A distinguishing characteristic of 88 systems is th at they utilize a much larger bandwidth than necessary. This is done by spreading the message signal 15

over a large bandwidth with a PseudoNoise (PN) code. At the receiver, the identical PN code is utilized to restore the original message signal. In SS systems, the PN sequence is only known by the intended user, and the SS signal appears as wideband noise to unintended receivers. As a result, privacy is inherent in SS systems. Spread spectrum systems also benefit from a low power spectral density, which makes these systems very difficult to detect by an unintended user. In addition, the spectral properties of the PN codes make signals very resistant to intentional jammers. As a result of these benefits, SS systems were originally used in military applications such as communications and guidance, where privacy and jamming protection are imperative. In the early 1990s, spread spectrum systems were introduced into the commercial market by Qualcomm, in the form of Direct-Sequence Code Division Multiple Access (DS-CDMA). These systems were standardized under the name IS-95. Direct sequence CDMA systems provide multiple access by assigning users PN codes with low cross correlation. As a result, many users can share the same bandwidth, because the users remain orthogonal due to the cross correlation properties of the PN codes. These systems have performed very well in cellular environments, and provide increased capacity over other multiple access techniques, such as Frequency Division Multiple Access (FDMA) and Time Division Multiple Access (TDMA) [3]. Spread spectrum signals are generated my modulating a baseband message signal, m{t), with a PN sequence, c{t). At the receiver, a synchronized version of the identical PN sequence is utilized for demodulation. The system block diagram for a typical SS system is shown in figure 2.8. We let the message signal be represented as

=

jTb),

(2.1c

16

C h an n el

S S T ra n sm itter

S S R eceiver

Figure 2.8: Spread Spectrum System

where the sequence bj = ± 1, in equation (2.1).

and p{t -- jTf,) is the rectangular pulse shape defined

For simplicity of notation, the spreading signal is denoted Cj, which

represents the continuous time PN sequence over the j th bit interval. This is expressed as
N Cj

=
n=l

- ( j N + n)Tc),

(2.14)

where

is the nth chip in the PN sequence during the jth bit interval. The param eter

N is the length of the PN code, and Tc is the duration of the PN chip. Since the spreading sequence is designed to produce a signal with a wider power spectral density (PSD) than the message signal, Tc is much less than 7),. The ratio of Tf, to Tc is referred to as the processing gain. This can also be expressed in terms of the chip rate of the PN sequence and the message signal as t: p
...

(2.15) As mentioned previously, the transm itted signal, s(t), is generated by multiplying the mes sage signal with the PN sequence as shown in figure 2.8. This results in the SS signal
N

s(t) = j n=l

(jW + n)Tc) = j

(2.16)

Figure 2.9 shows an example of signals m (t), c(t) and s{t), as well as the power spectral

17

m(t)

c(t)

C(f)

1/Tc
3 ( 1)

Figure 2.9: Example of a Spread Spectrum System with Ti, = 4Tc

density (PSD), for a processing gain of four (T), = 47),). After applying the spreading sequence, the SS signal is upconverted to the carrier fre quency, and transmitted over a channel. This is done according to figure 2.5. An AWGN channel with a unity gain is used in this analysis for demonstration purposes, resulting in the received RF signal being expressed as

rRr(t) = sgrit)+r/(t).

(2.17)

At the receiver, the signal is downconverted and filtered according to figure 2.5, which recovers a noisy version of the transmitted baseband signal. The AWGN corrupted signal, r(t), is correlated with the synchronized PN sequence, Cj, to recover the message signal during the jth signal element. The test statistic for the j th signal element at the output of the correlator receiver is

_
=

1

(2.18) //iyy*{cyc,}d(+ i cfliit.

18

where to

is the energy of the PN chip. Since

= NTc, this equation simplifies

1 fU+i)n Zj = N^/ë^bj + -- / Cjr}jdt.
Jt=jTb

(2.19)

An estim ation of the transm itted bit,

is then made based on the test statistic as follows

+1 bj-i -1

if Zj > 0, (2.20) if Zj < 0.

Since the noise and the PN sequence are uncorrelated, we can show th at the probability of bit error, for a BPSK modulated signal in AWGN noise is

P b - Q {

\ / j ^

I

(2 .2 1 )

This result is identical to the probability of bit error for single carrier transmission with BPSK modulation, as well as OFDM transm itted in a unity gain channel with AWGN noise. Consequently, the SS signal can achieve benefits such as privacy and jamming protection without impacting the BER performance.

2.2.1

P N S eq u en ce S electio n

The selection of a PN sequence is the most important aspect of SS communications. This is the fundam ental component of the system that provides the favorable qualities of CDMA systems, such as privacy, jamming protection and multiple access. Some properties of PN codes th a t are desirable for SS systems include a null DC bias, and a sharp autocorrelation

19

peak [27]. These two characteristics are shown below respectively:
N

E E '
n=l

= 0,

( 2 . 22 )

and R c{l) = E[CnCn+,] - N 5 {l), (2.23)

where E[-] is the expected value, Rc{i) is the autocorrelation function, and 5(t) is the impulse function. A sharp autocorrelation peak is required to ensure that synchronization occurs at the correct chip in the PN sequence at the receiver. If the autocorrelation function, Rc{i), does not meet this criteria, the code may synchronize at the incorrect PN chip, and cause bit errors. Another important property of the PN sequence is the cross correlation function. It is desired that user-specific codes have very low cross correlation to allow multiple access to occur through code division. If there is high cross correlation between users, the interference power will be large, which degrades the performance of the system. We let the number of users that utilize the SS channel simultaneously to be K, where the Mh user has the despreading signal Ideally, the PN sequences possess the cross correlation function [27]

N
n+t n=l

N,
0,

k --k', i -- 0 , k = k',0 < k ^ k',
|i|

< N,

(2.24)

0, where

is the PN chip of the k'th user, shifted by l chips with respect to

Equation (2.24) indicates that shifted versions of both the identical code, and other user codes, produce a cross correlation of zero. This ensures that there is no interference when

20

transm itting in a multi-user environment without m ultipath fading. In practice, however, there are no codes th at satisfy all of these properties. The second condition can be achieved by employing m-sequences, which produce a sharp autocorrelation peak. The problem with these sequences is th at they experience high levels of cross correlation, which results in multiple access interference. To achieve better cross correlation properties, Walsh codes can be utilized, which provide complete orthogonality between users, provided the sequences are perfectly synchronized.

2.2 .2

M u ltip le A ccess

One of the most desirable characteristics of SS systems is the ability to provide multiple access. Multiple access is performed by assigning user-specific codes with low cross correla tion to different users occupying the same bandwidth. When the signals are received, the orthogonality properties of the PN sequences allow them to be recovered independently. If we assume th a t there are K users to be multiplexed onto a channel, each with an orthogonal PN sequence, the total transm itted signal during the j t h bit is

= k=l where

(2.25)

is used for simplicity to denote the continuous time PN sequence for the kth user

during the j t h signal element. Assuming th at the signal is transm itted over the a channel with AWGN noise, and that the received signal is synchronized with the local PN sequence, the j t h received signal element is

»·,(*) = k=l

(2 28)

21

To receive the signal of the user 1, we correlate the received signal with the intended user's PN sequence, to construct the decision variable

H

fU T

Since

% 0 for all k is implied in equation (2.24), and

=

NTc, we further simplify this equation to yield

z j" «

^

c fn jd t.

(2.28)

This result indicates that the user is able to recover the intended signal by correlating with the identical, synchronized PN sequence. It is also evident that since the cross correlation between user codes is null, there is no interference caused by other users. As a result, many users can share the identical bandwidth by utilizing orthogonal user-specific spreading se quences, and yield the BER performance shown in equation (2.21). In practical scenarios there is typically interference present from spreading sequences that are not perfectly orthog onal, loss of synchronization, and fading. This has been shown to increase the probability of bit error in the system [6].

2.3

M ulticarrier C D M A

As mentioned previously, combinations of OFDM and CDMA are becoming popular because they possess the inherent benefits of OFDM, which includes a resistance to ISI at high data rates. The use of CDMA allows more granular and flexible multiple access, and may provide a variety of other benefits such as increased privacy and diversity. We present various OFDM

22

and CDMA combinations in the following sections.

2.3.1

M u ltica rrier C D M A (M C -C D M A )

The first combination of OFDM and CDMA to be proposed was Multicarrier CDMA (MCCDMA) [7]-[9]. In this multicarrier system, code spreading occurs in the frequency domain. Each successive chip of the user-specific PN code is modulated to an adjacent sub carrier. As a result, users transm it each bit on several parallel subcarriers simultaneously. The transm itter architecture for MC-CDMA is shown in figure 2.10, and the transm itted signal of the k th user is
M

(() = Æ

^
j

^
m=l

- jTb)cos(w_(),

(2.29)

where

is the m th chip in the frequency domain spreading sequence for the fcth user

during the j t h signal element. Since PN codes are selected th at satisfy the cross correlation properties denoted in equation (2.24), several users can occupy the identical subcarriers, because orthogonality is provided by the user-specific PN sequences. If we assume th at the signal (() is transm itted through the channel model described

in equation (2.6), the received baseband signal is

r{ t) =Æ E E E
k=\ j

K

M

' ? (<- m c o s { c u ,, t + ^fX )+#), (2 .3 0 )
is the phase shift on the m th subcarrier for the kth

m=l

where user.

is the fading gain and

The received signal, r(t), is recovered with the block diagram shown in

figure 2.11.

This signal is first converted into parallel format, where each branch is multiplied by a 23

PROPERTY OF

RYERMMmwaWIY UBSiNVf

F(lr)

impulse Modulator

Pulse Shaping

m

Cyclic Prefix

''jM

Æ cos(ffl,,/)

Figure 2.10; Oscillator-Based MC-CDMA Block Diagram

cosine function and filtered to demodulate each subcarrier. In order to recover the signal transmitted by user 1, we multiply the received signal on the mth branch with the PN chip for user 1, The result is then multiplied by an independent gain for each subcarrier.

In order to maximize the SNR at the output of the correlator, Maximal Ratio Combining (MRC) is employed to give more weight to subcarriers that experience more favorable fading characteristics. In this combining algorithm, the weight given to the mth sub carrier is equivalent to the gain on the mth OFDM subcarrier, The result is then summed and

integrated over the period to recover the bit, bj^\ If we assume that there are no other users accessing the channel, or if the interference term is null, the decision variable for user 1 is dl) M
m =l
1

"(i+l)Tt rU+^)n

M

(2.31)
^

where

is the AWGN noise term on the mth subcarrier. Based on this result, the SNR

at the output of the correlator during the jth signal element is M T "; - Yo
771=1

(2.32)

24

V2 oos(û\/-ç?Jj')

h ¥n
(x) H LPF

fef

f=U +l)71

;Jk f Figure 2.11: Oscillator-Based MC-CDMA Receiver Block Diagram

M ulticarrier CDMA systems are able to increase the SNR at the output of the integrator when each subcarrier experiences independent fading. This occurs when the separation be tween subcarriers is less than or equal to the coherence bandwidth of the channel (l/T), < Be). This effect is referred to as frequency diversity, because each transm itted bit is signaled over various independently faded frequency bands. The BER for a system employing frequency diversity is [6]
M M-1

a = where /i is defined as

E
i= 0

5 ( 1 +M)

(2.33)

In / 1+ ^ ' and ^

(2.34)

is the average SINR per subcarrier. This value depends on the signal power, as

well as the interference caused by other users and the AWGN noise. If we assume th at the interference power is null, the average SNR per channel is

(2.35)

where

is the average squared fading gain on. the m th sub carrier. 25

The problem with MC-CDMA systems is that an excessive amount of MAI may be expe rienced when transmitting through a channel with frequency selectivity. This occurs because PN sequences lose orthogonality if the amplitude level of the PN chips is altered during the bit period. Since each subcarrier experiences independent fading, and each subcarrier is multiplied by one chip from the PN sequence, a loss of orthogonality is common. This inter ference power is further amplified as each user is added to the channel. As a result of this excessive MAI, the performance of MC-CDMA systems have been shown to degrade with high channel loads [22].

2.3.2

Multicarrier Direct-Sequence CDM A (M C-DS-CDM A)

Another combination of OFDM and CDMA is Multicarrier Direct-Sequence CDMA (MCDS-CDMA) [7]. In this scheme, narrowband DS-CDMA signals are transmitted in parallel over OFDM subcarriers. Figure 2.12 shows the block diagram for the MC-DS-CDMA system, and the transmitted signal is
M N

(t) = j where subcarrier.

E 4^cos(wmt) ^
m=l n=l

- UN + n)TU ,

(2.36)

is the nth chip in the time domain PN sequence for the Mh user on the mth

If we assume that the signal is transmitted through the channel model described in equation (2.6), the received signal is
K M N

r(() = Æ

^
fc=l

^ ^ 6(%aj%cos(w^( -k y,j.^) g j , ( ( _ (;W -b n)TL) -b 77((), (2.37) j m=l n=l

where there are a total of K users occupying the channel. This signal can be detected by 26

im p u ise M oduiator

P u lse S h ap in g

S /P

Cyclic Prefix

Figure 2.12: Oscillator-Based MC-DS-CDMA Block Diagram

utilizing the DS-CDMA receiver shown in figure 2.8, in each branch of the typical OFDM demodulator. If we assume that there is no interference between users, the BER performance is identical to a typical OFDM system shown in equation (2.12). The benefit of MC-DS-CDMA is th at it can provide a performance increase over DSCDMA systems th at operate in wideband channels, because the narrowband subcarriers are resistant to ISI. They are also very effective at providing multiple access with very low MAI. This occurs because the coherence time of the channel is generally much larger than the duration of each transm itted bit. This allows the PN codes to retain orthogonality, unlike MC-CDMA systems discussed in the previous section. It has been shown th at MC-DSCDMA systems are able to outperform MC-CDMA systems when there are several users accessing the channel simultaneously. Under low loads, however, the frequency diversity gained by MC-CDMA allows it to achieve superior BER performance [22].

2 .3 .3

O rth o g o n a l F requ en cy C od e D ivision M u ltip lex in g (O F C D M )

The third and most recently introduced combination of OFDM and CDMA is Orthogonal Frequency Code Division Multiplexing (OFCDM). W ith this modulation scheme, spread27

\Jk)

Impulse Modulator

Pulse Shaping

S/P

Cyclic Prefix

Figure 2.13: Oscillator-Based OFCDM Block Diagram

ing occurs in the time and frequency domains simultaneously. The block diagram for the OFCDM transmitter is shown in figure 2.13, and the transmitted signal of the kth user is
M

N
n=l

m=l

The analysis of the received signal, SINR and BER performance of OFCDM is postponed until chapter 4. This analysis is one of the main contributions of this thesis. Since OFCDM employs time and frequency domain spreading simultaneously, it expe riences the favorable qualities of MC-CDMA and MC-DS-CDMA systems discussed in the previous sections. The use of frequency domain spreading allows the system to benefit from frequency diversity, while time domain spreading allows multiple access to occur with low MAI. As a result of these benefits, OFCDM has been shown to provide more favorable BER performance than MC-CDMA and MC-DS-CDMA systems [11]-[13]. There are a variety of papers that have utilized simulations to examine spreading factors that are favorable under different operating conditions for OFCDM [21]-[25] . In general, these papers have found that a high frequency domain spreading factor is superior under

28

low channel loads. This occurs because frequency diversity is achieved, while MAI remains small because only few users access the channel simultaneously. If there is a requirement to support a large capacity of users, however, time domain spreading should be prioritized to minimize MAI. These papers have concluded that there are particular time and frequency domain spreading factors that are the most favorable under various conditions. These results are summarized in section 3.3. The proposed adaptive sub carrier allocation algorithm is utilized to further improve the performance of OFCDM by allocating users to subcarriers that achieve a favorable SINR, while minimizing MAI. Since OFCDM systems are capable of operating with diflFerent spread ing factors, it is the goal to improve BER performance under all configurations.

29

Chapter 3 Literature Survey
Over the past years, a considerable amount of research has been performed regarding adap tive subcarrier allocation methods for Multicarrier CDMA and OFDM. In general, the goal of this research has been to maximize throughput and minimize the BER by assigning users to subcarriers that provide the best transmission characteristics. It is noticed that when utilizing multicarrier modulation schemes, several bit errors occur on subcarriers that expe rience high levels of noise, or high attenuation. Conversely, a very low BER is observed on subcarriers that experience favorable conditions. As a result, the poor subcarriers tend to dictate the overall BER experienced by these systems. To overcome these problems, many systems incorporate adaptive subcarrier allocation to avoid or limit transmission on poor subcarriers. In a cellular environment, this idea can be extended to multiple users. Since the fading characteristics of the subcarriers are independent for users in different spatial locations, a particular subcarrier may be favorable for one user, while it may increase the BER for other users. Consequently, adaptive sub carrier allocation can be utilized to optimize the overall throughput and BER for a particular cell. In this chapter, a literature survey regarding several adaptive subcarrier allocation meth-

30

ods is discussed. Section 3.1 deals with adaptive subcarrier allocation algorithms for MCCDMA systems, which achieve multiple access with frequency domain spreading. In section 3.2, adaptive MC-DS-CDMA systems are evaluated, which employ time domain spreading. This is followed by a review of papers that explore combined time and frequency domain spreading in section 3.3.

3 .1

A d a p t iv e M C -C D M A

In traditional MC-CDMA systems, frequency domain spreading is used to transm it data over contiguous sub carriers throughout the entire spectrum. Although this maximizes per formance gains from frequency diversity, high MAI may be present. This occurs because all users are multiplexed onto the same set of subcarriers. Although the subcarriers are orthogo nal when there is no m ultipath fading, the frequency selective channel destroys orthogonality between spreading codes. In addition, the BER may be increased by transm itting on poor subcarriers. As a result, adaptive MC-CDMA has been proposed, where a limited number of favorable subcarriers are employed to overcome these problems. In this section, various adaptive subcarrier allocation algorithms for MC-CDMA are discussed in detail, and are related to the algorithm proposed in this thesis. In [14], a frequency division MC-CDMA (FD-MC-CDMA) system is developed that em ploys adaptive subcarrier allocation and frequency domain spreading. Instead of utilizing every subcarrier in the spectrum, this scheme assigns each user to a fraction of the total subcarriers, which are equally spaced throughout the spectrum. This spectral allocation is shown in figure 3.1. This scheme produces a performance improvement over employing adjacent subcarriers. The lower spreading factor reduces MAI because fewer users share the same set of subcarriers. Also, since the subcarriers are separated throughout the entire spec-

31

12 subcarrier set 1

I

8 9 10

16 17 18 subcarrier set 2

24 25 26 subcarrier set 8

1
32

Figure 3.1: Spectral Allocation for 32 Sub carrier FD-MC-CDMA

trum, each subcarrier is likely to achieve completely independent fading. This characteristic is necessary for the system to maximize the benefit from frequency diversity. Simulation results indicate that for a target BER of 10"^, the required Eh/No of the system is reduced by more than 2dB compared with a traditional MC-CDMA system. This result is significant because the system is able to provide a performance improvement simply by reducing the number of subcarriers in each group, and by spacing them non-contiguously throughout the spectrum. Another MC-CDMA system is examined in [15], which involves adaptive band selection with frequency domain spreading. In this system, users are permitted to select the set of non contiguous subcarriers where the best fading conditions exist. It is found that when users select only the best one or two subcarriers, an improvement of 8dB is yielded at a target BER of 10"^, compared with traditional MC-CDMA systems that utilize the entire bandwidth. It is also found that as more subcarriers are utilized in each group, the performance is degraded due to excessive MAI. In [16], two adaptive MC-CDMA schemes are proposed that allow frequency hopping and frequency domain spreading. At each frequency hop interval, users select a different set of equally spaced subcarriers from the available bandwidth. This allocation strategy is shown in figure 3.2, at three different hopping intervals. In the first proposed scheme users 32

a)

·

·

subcarrier set 1



b)

·

·

subcarrier set 2

c)

·

·

subcarrier set 3

Figure 3.2; Subcarrier Allocation Groups for Frequency Hopping MC-CDMA a) first hop, b) second hop, c) third hop

randomly select the frequency group, and in the second scheme selection is done such th at the number of users in each group is equalized. The results indicate that with 32 mobile users utilizing a spreading factor of 64, the BER error floor is reduced from 3x10"" ^ to 3x10"® when the number of users in each group is equalized. This occurs because heavily loaded subcarrier groups produce considerably more MAI than less occupied groups, and this tends to dictate the overall BER performance. It is also found that BER improvement is more pronounced when MAI is limited by selecting a fewer number of subcarriers in each frequency hopping group. In particular, the system is able to reduce the BER floor to 2x10"® when the spreading factor is reduced to 32. In [17], an analysis of the BER performance is determined for MC-CDMA as the frequency domain spreading factor is varied. The results indicate that if MAI is neglected, the BER performance improves as the spreading factor is increased. This is a result of improved frequency diversity as the CDMA signal is transmitted over several parallel subcarriers, which each experience independent fading. Although MAI is neglected in this experiment, it is expressed th a t a balance must be found between increasing the frequency diversity and the resulting MAI. This study also examines the use of frequency hopping with frequency

33

domain spreading, and concludes that while frequency hopping allows the system to reach the theoretical limit for frequency diversity, it also amplifies the problems with MAI. In each of these papers, adaptive MC-CDMA is investigated. It is generally determined that more favorable performance occurs when fewer sub carriers are utilized in each group, and when users adapt to the best subcarriers. Based on the performance improvements realized with these schemes, several of these ideas are incorporated into the proposed sys tem. Firstly, due to the performance improvement realized in [14], small subcarrier groups are spread throughout the spectrum to ensure independent fading and minimal MAI. The proposed system also selects the group of subcarriers that has the best SINR characteristics. This is based on the results found in [15] and [16]. In [15], it is found that equalizing the interference power in each group provides improved BER performance, while [16] found that choosing subcarriers with high fading gains produces better performance. With the proposed algorithm, the SINR is utilized to assign users to subcarriers with high fading gains, while minimizing MAI simultaneously.

3.2

A d ap tive M C -D S -C D M A

In MC-DS-CDMA, DS-CDMA signals are transmitted in parallel over each of the sub carriers. Although this limits MAI caused by the frequency selective channel, there is no additional frequency diversity because only one subcarrier is utilized during each transmission interval. Consequently, if a destructive fade occurs on the user's subcarrier, the entire transmission may be corrupted. As a result, a substantial amount of research has been performed on adaptive subcarrier allocation for MC-DS-CDMA to improve BER performance. In this section, various proposed schemes are discussed in detail. In [18], a reverse link MC-DS-CDMA system is proposed where each user transmits

34

a single DS-CDMA waveform, which hops to the subcarrier that is expected to minimize the overall BER for the cell. Since it is possible for many users to select the identical subcarrier, a high spreading factor is utilized so users can be uniquely identified. This paper indicates th at while it may seem logical for each user to select the subcarrier with the best fading gain, this may cause a large amount of interference to other users that select the identical subcarrier. As a result, this algorithm utilizes the water-filling principle to select subcarriers th at minimize the BER for the entire system. With this strategy, users are recursively assigned to subcarriers with the highest fading gain, while the interference caused by other users is minimized. The results indicate that the proposed system improves BER performance by approximately 2dB compared with single carrier CDMA systems. A very similar approach to [18] is taken for the forward link in [19], where a single DS-CDMA waveform is transm itted over the subcarrier that exhibits the best fading char acteristics. In this algorithm, the authors claim that users must be assigned to subcarriers with the best fading gain, because the SINR is not known at the mobile terminal. The simulation results suggest that the proposed system achieves a performance improvement of approximately 4dB at a BER of lO"'^. Again, these results indicate that transm itting over only the best subcarrier can improve the BER compared with traditional MC-DS-CDMA systems. In [20], another forward link MC-DS-CDMA structure is investigated. The users in this system signal the gain of each subcarrier to the Base Station BS), where a sub-optimal subcarrier allocation method is performed thereafter. This suboptimal assignment strategy assumes th at other users continue to utilize subcarriers from the previous transmission inter val, while assigning current users to the subcarriers that provide the best SINR. The results indicate th a t the system experiences a BER improvement over the results from [19] when a large number of users are present in the system, but is outperformed with fewer users. 35

This improvement occurs because [20] considers the interference generated by other users. One source of uncertainty in this paper is the assumption that the channel quality matrix is constant over several transmission intervals. Although this is a fair assumption in a slow fading environment, BER performance may be degraded at high user velocities. In each of these papers, it is shown that transmitting a DS-CDMA waveform over only the most favorable subcarriers improves performance considerably over non-adaptive MC-DSCDMA. These articles also indicate that the BER performance of the system is maximized when the interference caused by other users sharing the subcarriers is considered when allocating subcarriers. As a result, the proposed algorithm utilizes a variation of the waterfilling principle that is employed in [18] to minimize the BER of the cell. This allows the system to account for the fading characteristics and interference power caused to other users simultaneously.

3.3

O FC D M

As mentioned previously, the objective of this thesis is to develop a novel adaptive sub car rier allocation algorithm for multicarrier CDMA with time and frequency domain spreading. While adaptive subcarrier allocation is a popular research area for MC-CDMA and MC-DSCDMA systems, this is the first algorithm to be developed for OFCDM. This technology has recently become the focus of much research, as it has been shown to provide excellent per formance in wideband wireless channels. In this section, we provide a summary of previous work done in this area. Multicarrier CDMA with time and frequency domain spreading was originally proposed by Xiao et. al. in [11]. In this paper, the concept of two-dimensional spreading is proposed, and the BER performance is evaluated with different diversity combining strategies. The

36

results indicate th at two-dimensional spreading provides a performance improvement over signalling with time or frequency domain spreading individually. They conclude th at perfor mance is improved over MC-DS-CDMA because the frequency domain spreading provides an anti-fading capability due to frequency diversity. In addition, time domain spreading reduces MAI, which allows the system to outperform MC-CDMA. Another evaluation of OFCDM is provided by You et. al. in [12], where closed-form BER performance evaluations are performed considering various time and frequency do main spreading factors. This research indicates that OFCDM performs better than MC-DSCDMA systems due to enhanced frequency diversity. This study also examines the scenario where m ultipath components are received on the sub carriers. In this case, the RAKE receiver is shown to improve BER performance due to multipath diversity. In [13], numerical performance measures are derived for OFCDM with a similar method ology as was done in [12]. The performance is evaluated under different channel loads and users velocities. The results indicate that two-dimensional spreading provides superior per formance for all channel loads because MAI is minimized with time domain spreading. In addition, better performance is achieved with high Doppler frequencies, liecause time diver sity is achieved from spreading in the time domain. W ith the favorable results presented in this area, there has been several papers that utilize simulations to evaluate spreading factors that provide the best performance in different channel conditions. In [21], simulations are performed to determine the effect of time domain spreading on an OFCDM system. These simulation results from this study are shown in figure 3.3. The findings indicate that when there are few users in a cell, the frequency domain spreading should be prioritized because frequency diversity is achieved with minimal MAI. W hen more users are added to the system, it is necessary to utilize a larger time domain spreading factor to reduce MAI. This paper indicates that if the number of users is moderate, 37

18.0
" ^ " 3 0 C 0d6S

B 16.0

ê
U 1 14.0

codos - o - 1 code

^ 12.0
f 10.0
8.0
1x32 2x16 4x8 8x4 16x2 32x1 Spreading Code Mapping ( freq. x lime )

Figure 3.3: Required E^/No to achieve a PER of 10"^ for Adaptive OFCDM [21]

a combination of time and frequency domain spreading provides a reasonable compromise between diversity and MAI. These results are further emphasized in [22], where a more quantitative analysis of the spreading factors is examined considering the delay spread and Doppler frequency of the channel. The results indicate that under heavy channel loads with a small delay spread, the frequency domain spreading factor can be increased in order to benefit from improved frequency diversity. If the delay spread of the channel becomes too large, however, the spreading factor should be reduced to ensure MAI is minimized. This paper also found that a higher frequency domain spreading factor should be utilized under light channel loads. The time domain spreading factor is also investigated. Simulations are performed with Doppler frequencies ranging from 20Hz to 1500Hz. The results suggest that for low Doppler frequencies, a large time domain spreading factor can be employed, regardless of the channel load. When the Doppler frequency is increased to 1500Hz, which corresponds to a user

38

velocity of approximately 300km/h, the time domain spreading factor should be reduced to between 4 and 8. In each of these papers, the performance of OFCDM is evaluated. It is determined th at the combination of time and frequency domain spreading improves performance over MCCDMA and MC-DS-CDMA systems because of improved frequency diversity and a reduction of MAI. The lim itation of these systems is that users are assigned to subcarriers randomly. This reduces system performance because users may be assigned to subcarrier groups th at have poor fading characteristics, or high levels of MAI. In order to improve the performance of OFCDM, we develop an adaptive subcarrier allocation algorithm to minimize the overall BER of the system. This is accomplished by assigning users to subcarriers based on the fading conditions and MAI experienced on the subcarriers. W ith the proposed algorithm, we are able to improve BER performance regardless of the spreading factor employed by the system.

39

Chapter 4 A daptive Subcarrier A llocation
In chapter 3, various adaptive subcarrier allocation algorithms are presented for MC-CDMA and MC-DS-CDMA systems. Many of these algorithms are able to significantly outperform the respective non-adaptive systems in terms of BER performance. In many cases, a reduc tion in the BER floor is achieved, as well as improvement in the noise limited region of the BER curve. These papers have found that when MC-CDMA systems are heavily loaded, small subcarrier groups perform better because less MAI is produced. It is also found that selecting the best subcarriers and equalizing the interference in each group provides an im provement in BER performance. For the adaptive MC-DS-CDMA systems, performance improvements are achieved when subcarriers with the best fading conditions are used for each transmitted bit, and when sub carrier allocation minimizes MAI to other users on the same subcarriers. Based on these favorable results, a reverse link adaptive subcarrier allocation algorithm is developed for OFCDM. To the best of the author's knowledge, this is the first work that deals with adaptively allocating subcarriers for OFCDM. This algorithm is developed with the intention of minimizing the overall BER for OFCDM under all spreading factors.

40

Since OFCDM achieves its favorable performance by employing time and frequency do main spreading simultaneously, the proposed algorithm combines several ideas that are effec tive in MC-CDMA and MC-DS-CDMA systems. The basis behind the proposed algorithm is to separate the total spectrum into small groups of non-contiguous subcarriers as was done in [14]. This is done to maximize gains from frequency diversity, and to minimize MAI th at may be caused from frequency domain spreading. At the base station, the users are assigned to subcarriers based on the instantaneous SINR characteristics of the subcarriers in each non-contiguous group. This methodology is similar to the adaptive MC-DS-CDMA intro duced in [18], however it is extended to a group of subcarriers. As a result, users are assigned to sub carriers such th at the average SINR of the system is maximized. This is accomplished by allocating users to subcarrier groups with the most favorable fading conditions, while interference caused to other users is minimized simultaneously. In section 4.1, we discuss the subcarrier grouping strategy that is utilized to maximize frequency diversity and minimize MAI. Following this, we provide the system model for the adaptive OFCDM system in section 4.2. This includes a description of the transm itter and receiver, as well as the channel model used in the simulations. This section also derives the closed form expression for the SINR and BER performance of the adaptive system. Finally, in section 4.3 we present a detailed explanation of the adaptive sub carrier allocation algorithm for OFCDM.

4 .1

S u b c a r r ie r G r o u p in g

As shown in [14], utilizing small sub carrier groups can provide a significant performance improvement in MC-CDMA systems th at employ frequency diversity. As a result of these findings, the proposed algorithm divides the subcarriers into several small, non-contiguous

41

groups of that are equally spaced throughout the spectrum. The user groups, denoted Gy] ye{l, 2, . . . , y }, contain the following subcarriers

(S'! --{rui,

T n.14.2^, · )mi-j-Afi/i}') (4.1)

G2 -- {m2, m2_|_^, m.2-1 -2^, · · · > m2+A/2/i{>

where there are My subcarriers in group y, and /r is the spectral separation between subcar riers. There are a total of Y subcarrier groups in the system, where in general, the spectral separation of subcarriers is identical to the number of subcarrier groups. A graphical example of the subcarrier grouping strategy is shown in figure 4.1, with four subcarrier groups. Since the subcarriers in each group are separated equally throughout the provisioned bandwidth, the frequency spacing is likely to be larger than the coherence bandwidth of the channel. This ensures that there is uncorrelated fading on all subcarriers in any given group, allowing the system to achieve the maximum benefit from frequency diversity. Also, since the number of subcarriers in each group is small, the amount of MAI caused by frequency domain

·

·

·

Group 1

Group 2

Group 3

Group 4

Figure 4.1: Subcarrier Allocation with 4 Subcarrier Groups

42

spreading is minimized, because fewer users access the same subcarriers simultaneously. In this thesis, we evaluate the proposed algorithm with various spreading factors, which each utilize a different number of sub carriers in each group. These results are presented in chapter 5.

4 .2

A d a p t iv e O F C D M S y s te m M o d e l

In this section, the system model for the adaptive OFCDM system is presented. Since this adaptive system operates in the reverse link, the OFCDM transm itter is located at the mobile terminal, and the receiver is at the base station.

4.2 .1

A d a p tiv e O F C D M T ransm itter

The adaptive OFCDM transm itter architecture is similar to the block diagram presented in section 2.3.3, however it incorporates an adaptive subcarrier allocation block th at allows sub carriers to be selected adaptively based on the channel conditions. utilized by this block, The parameters

are determined by the adaptive subcarrier allocation algorithm

th at occurs at the base station. The block diagram for the transm itter of the /rth user is shown in figure 4.2. The bit stream, symbols, is first impulse modulated with BPSK to form a sequence of complex modulated . Since BPSK modulation is utilized, the sequence dj^^ = ±1, jeK. This se

quence is sent through the rectangular pulse shaping filter with the response p { t --{ j N + n ) T c ) , where is the duration of the PN chip. The resulting continuous-time signal is then passed ^ onto the

through the adaptive subcarrier selector block. This block places copies of

subcarriers defined by the adaptive subcarrier allocation algorithm. Following this, each subcarrier is multiplied by the m th chip in the user's frequency domain spreading sequence, 43

Impulse Modulator

Pulse Shaping

Adaptive Subcarrier Selector
).m

/(* )

;M

Figure 4.2; Block Diagram for the Adaptive OFCDM System

^^rn- Time domain spreading is then performed by multiplying each sub carrier with the user-specific time-domain PN chip, After spreading is performed, the signals on each

parallel branch are modulated to the corresponding subcarrier frequencies, u/m- Finally, the result is summed to produce the transmitted signal for the kth. user M
m=l

N
n=l

where the parameter

is defined as

1 if the mth subcarrier is selected for user k, (4.3) 0 otherwise.

More specifically,

= 1 if the mth sub carrier is assigned to the kth. user by the adaptive = 0. In

subcarrier allocation algorithm. If the mth subcarrier not assigned to user k, this case, the A:th user does not transmit data over the mth subcarrier.

After the baseband signal is generated the signal is upconverted to the carrier frequency

44

according to figure 2.5. This produces the RF modulated OFCDM signal for the kth user, M {t).

4 .2 .2

C h an n el M o d el

In this experiment, we assume that the channel is slowly varying with respect to the OFCDM bit duration, Tf,. This is a valid assumption for 4G systems because the Doppler spread is generally much smaller than the subcarrier bandwidth. We also assume that the chip duration, Tg, is equivalent to the RMS delay spread of the channel. This indicates that each subcarrier experiences independent, frequency non-selective fading. The resulting frequency domain response on the m th subcarrier for the kth user is

=

(4.4)

where

is the Rayleigh fading gain for the A:th user, on the m th subcarrier during the j t h

transm itted bit. This value is independent for all K users and M subcarriers. The phase, is a uniformly distributed random variable over [0, 27t), which is independent for each bit, subcarrier and user. Since all mobile terminals transm it simultaneously, the RF signal received at the base station is a summation of all users signals transmitted during the j th signal element. These signals are all corrupted by independent fading conditions, as well as AWGN noise. Conse quently, the received signal is expressed as
K

rRF{t) = fc=i where

W*

+ri(t),

(4.5)

represents the time domain impulse response across all subcarriers for user k.

45

4.2.3

Adaptive OFCDM Receiver

At the base station, the RF modulated signal, rRpit), is downconverted with the block diagram shown in figure 2.5. This recovers the noisy baseband signal

(4.6)

The transmitted data is then recovered with the base station receiver block diagram shown in figure 4.3. If we wish to recover the data transmitted by user 1, we first convert r(t) into parallel format and multiply by the subcarrier allocation coefficients for user 1, This ensures that only the allocated sub carriers are detected at the base station. Following this, the signal on each subcarrier is restored to the baseband by multiplying with a sinusoid matched to the carrier frequency. This is followed by low pass filtering to remove the image frequency caused by demodulation. We then correlate the received signal with the synchronized time and frequency domain PN sequences for user 1. The signal on the mth subcarrier is first correlated with the synchronized time domain PN sequence for user 1, cjm . The output of each time domain correlator is then multiplied by the frequency

> ( x ) -------- > L P F - » ( x ) -- » ( ? ) -- 

\/2cos(0|/-p]*,b

*
e

r(/).

Adaptive Subcarrier Selector

· «
L P F [-- » ( x y ^ { x ) -- >

I

f = 0 + 1)7-,

Vz cos(<o,,,

_r(t)

/ (*)

Figure 4.3: Block Diagram for Adaptive OFCDM Receiver

46

domain PN chip of user 1,

U , to remove the frequency domain spreading. The output

of this stage is multiplied by the path weight for the corresponding subcarrier. Since this receiver uses the MRC algorithm defined in section 2.3.1 to maximize the SNR at the output of the correlator, the gain for each subcarrier is equivalent to the fading gain, This

value is determined by estimating the fading gains at the receiver. The output from the subcarriers is summed, integrated over the bit period, and sampled to produce the decision variable

c Jt-- jTb

(4.7)

For simplicity of further calculations, the decision variable is expressed in terms of the desired signal, interference term, and the noise term, r]j^\ As a result, the decision variable

during the j t h signal element for user 1 is simplified to _ ^ { 1) ^ ^ji) + (4.8)

To determine the desired signal for user 1, we consider the received time and frequency domain PN sequences th at correspond to the user. The chips from these sequences are denoted signal is and respectively. At the output of the correlator, the resulting desired

Df> = 1
T c J .^ ,n Since and

Z

- UN + n)TMt.
(4.g) are constant over Tb, they can be taken outside the integral.

For simplicity, we can also convert the integral over Tb into a sum over individual chips. The

47

resulting desired signal is
M

1

N

(jAT+,,+i)Tc

Df = ^

p(t-{jN+n)TM t. (4.10)

The rectangular function,

p{t -- { j N

+

n)Tc),

has a constant amplitude of unity over

In

addition, since the system PN codes are synchronized at the receiver, = P Consequently, the decision variable is simplified to

= 1 and

D<`> =

y

.

(4.11)

m eGy

where

meGy

represents the set of subcarriers that are in group

y.

The interference term is the unwanted noise from other users. In this calculation, we omit correlation with the intended user's PN sequence, and consider the correlation between user 1 and the remaining users in group y. Ideally the interference term is null because of the cross correlation properties of the PN sequences shown in equation (2.24). In practice, however, the fading channel destroys orthogonality between spreading sequences. This results in the interference term

=jT6 where
k e Gy

r^fi- - fnM
y

is the set of users that utilize group
y{t),

simultaneously.

The received noise term,

is processed through the demodulator with the identical

steps as the desired and interference terms. Consequently, it is multiplied by the time and frequency domain PN sequences, as well as the finger weights for each subcarrier. The

48

resulting noise term at the output of the correlator is
M ^ r(j+ l)T b ^

^ E m=l

Y

'^i-jTb

^ n=l

+ n)Tc)LPF{n{t)y/2cos{uJmt -

(4.13) 4 .2 .4 S IN R C alcu lation

In order to determine the BER performance of the proposed system, the SINR is calculated for each transm itted bit. This SINR calculation is also performed at the base station for the adaptive subcarrier allocation algorithm proposed in this thesis. The SINR during the j t h signal element, 7j, is defined as the signal power divided by the interference and noise power. This relationship is expressed mathematically as

= fT y fT , where P4 . is the power of the desired signal. Pi- is the interference power, and noise power. The power of the desired signal is determined by finding the variance of

(4-14) is the

at the

output of the correlator. Since the desired signal has zero mean, the resulting signal power is ft, =
var[D f^]

=

N h.

(4.15) meGii

The interference power can be calculated with a similar method, however it can be approximated as a Gaussian random variable for OFCDM systems [12],[13]. Under this assumption, the interference power is calculated by dividing the total signal power from all interfering users by the total processing gain of the system. This is found to be a valid approximation when the number of subcarriers in the system is moderate to large, and the 49

input data symbols are random [12],[18]. Based on this assumption, the resulting interference power is

P i, = N ^ K , - 1 ) P [ ( q ,) " J ^
m eGy

(4 .1 6 )

where Ky is the number of users occupying group y simultaneously, and £'[(0;^)^] is the average fading gain for the Ky users and My subcarriers in group y. Finally, the noise power is calculated by finding the variance ofthe noise signal, i j p . The resulting noise power is

P,, = V ar[r,f] = N N , ^
meGy

(4.17)

Based on these terms, the SINR for user 1 can be calculated on each group during the jth signal element. The resulting SINR on subcarrier set Gy for user 1 is (1| ^ ^gcEm,G,(°jm)^ {Ky + N,,' , ' '

g.

It is evident from this equation that the SINR is dependent on the fading gain of the trans mitting user, the number of other users in group y, and the average fading gain of the other users accessing the group. The goal of the adaptive subcarrier allocation algorithm is to utilize these parameters to maximize the average SINR in the cell.

4.2.5

BER Performance

The BER is an important performance measure for any digital communication system. This is calculated based on the SINR at the output of the correlator for each user. The probability

50

of bit error for user 1, on sub carrier set

is calculated with the equation

= Although the random variable

(4.19)

follows a Rayleigh distribution, only the group of

sub carriers th at maximize the average SINR is utilized during any given Transmission Time Interval (TTI). As a result, the adaptivity of the system prevents us from further simplifying equation (4.19). Instead, a Monte Carlo analysis is performed with values generated from a Rayleigh distribution. These results are shown in chapter 5 for various spreading factors.

4 .3

S u b c a r r ie r A llo c a tio n A lg o r ith m

In this section we describe the novel adaptive subcarrier allocation algorithm for OFCDM. As mentioned previously, the goal of this algorithm is to assign users to sub carriers th at maximize the overall BER performance of the system. If we examine the SINR equation for OFCDM provided in (4.18), it is evident that SINR is dependent on the fading gain of the intended user, the number of users in each group, as well as the average fading gain for the subcarriers in the set. It may seem logical to assign each user to the group of subcarriers that provides the highest SINR. The problem with this methodology, however, is that while it maximizes the SINR for the intended user, the interference caused to other users is maximized as well. This occurs because the expected value of the fading gain in each group, A'[(o;j^)^], is increased by selecting the set of sub carriers with the largest Instead, in this algorithm we assign

users to sub carrier groups that provide the highest possible SINR, while simultaneously minimizing the interference caused to other users accessing the same subcarrier set. To produce this desired effect, we base the proposed algorithm on the water-filling prin 51

ciple as was done in [18]. In this paper, the sub carrier adaptation algorithm was shown to effectively minimize the overall BER for the cell, while requiring a low computational com plexity. Although this algorithm is shown to be slightly suboptimal at high values of Ef,/No, it is significantly less complex than using an optimal strategy such as Goal Attainment (GA). The water-filling principle states that given parallel channels with Gaussian noise, informa tion should be first provisioned to channels with lower levels of noise to achieve maximum channel capacity. Since the interference power is modelled with a Gaussian distribution for OFCDM systems, we can apply the water-filling principle recursively to assign users to subcarrier sets. With this algorithm, the SINR for each possible user-group combination is calculated based on equation (4.18). The subcarrier group with the highest SINR is then identified for each user. This represents the subcarrier group that will produce the best BER performance for each user. Instead of assigning each user to the most favorable group, the user with the most favorable group with the lowest SINR is provisioned to the subcarrier group first. This is done to reduce the average fading gain in the group, and consequently reduce the amount of interference to other users. The interference caused by this user is then utilized to recalculate the SINR for the subcarrier group that was previously assigned. This process continues recursively until all users are assigned to subcarriers. The result of this algorithm is that each user has the ability to select the most favorable subcarrier, however priority is given to users that produce the lowest amount of interference at the output of the base station's correlator receiver. The flow chart for this algorithm is shown in figure 4.4. Before subcarrier allocation is performed at the base station, the fading gains for each user is required. In this thesis, we assume that the fading gains are perfectly estimated at the base station. This can be accomplished with a variety of methods, such as decision directed estimation, training sequences and pilot signals [5]. We do not discuss these principles here 52

as they are beyond the scope of this thesis.

4 .3 .1

T h e A lg o rith m

S te p 1: Determine the fading gain of each subcarrier for all K users. These gains are expressed as
( 1) aM (2) aM

A=

(4.20)

(K) aM where am^ is the gain of the m th sub carrier for the kth user.

S te p 2: Calculate the SINR on each group for all K users. Since there are no users assigned to subcarriers at the beginning of the algorithm, the interference power is null. In this case, the SINR simplifies to the SNR (k) \2 Nn This process yields the SNR for each user-group combination as (4.21)

7I*'

72^' 7f ( 4 .2 2 )

c=

7P>

i r

7 f>

7 ^

S t e p 3 : D e f in e t h e s e t

Q=
53

w h e r e ;»<*> is t h e m a x im u m n u m b e r o f

substreams that can be transmitted by the Mh user.

Step 4: Find the subcarrier group that has the largest with the maximum SINR for user k is found as

jy

^ for all

K

users. The group

Æ =
If

, 72''^ -- , 7y 4-

(4-23)

= 0 we avoid this user because there are no remaining substreams available for allo

cation. We record the index of the subcarrier group that produces the largest value for all K users. This index is denoted ymL-

Step 5: Find the smallest value in the set jmL- This corresponds to the subcarrier group with the best fading gain, which causes the lowest amount of MAI to other users.

7m m = m i n { 7 ^ , 7 2 , , - - , 7 2 , }

(4 24)

Record the index of the user with the lowest SINR value, denoted k^m-

Step 6: Assign user kmi,, to the sub carrier group

This effectively assigns the sub

carrier group with the highest SINR for user kj^in- Since it is the smallest value in the set jm L, it minimizes the interference to other users.

Step 7: Recalculate the SINR for the subcarrier group that corresponds to ymax"'^- The SINR is recalculated by incrementing parameter Ky to reflect the additional user occupy ing subcarrier set y. The SINR for the entire column representing group 7/2"^ of ( is

54

recalculated according to the SINR equation

'y

K y ,E [{a yy]+ N o '

( 4 .2 5 )

for fce{l,2 , . . . , K} . The term £ '[(o:^*^)2] is updated as

w

i

= ^

E

E

( "2>)^-

(4.26)

^ keGy m eG y

S te p 8 : Decrement the number of available substreams for user kj^in^ If the entire set Q = 0 , return to S te p 1. Otherwise return to ste p 4.

Determine the subcarrier gains

Calculate the SNR for each user/group

Define the num ber of substreams for each user

Find the group with the iargest SINR for each user

Identify the user with the sm allest SINR group

Y es

No Decrement the available substream s to the assigned user Recalculate the SINR for the subcarrier group Allocate the user to the subcarrier group

C heck If all substream s are assigned

Figure 4.4: Adaptive Subcarrier Allocation Flowchart

After all substreams for each user are allocated to subcarriers, the base station signals the subcarrier allocation parameters to the mobile terminals on the forward link. These parameters include the index of the subcarrier group and spreading code. The /cth mobile terminal then translates the group index into parameters 55 2 before the signal is modulated.

As a result, if group y is provisioned to the user,

= 1 for m e G y . Following this, the mobile

terminal transmits data to the base station for the duration of the sub carrier adaptation update period. At the next update time, the next set of subcarriers is assigned based on the algorithm above. As mentioned previously, one of the main benefits of the proposed algorithm is that it assigns users to subcarriers with low complexity. It is evident from the algorithm that one substream is assigned during each iteration. Since the kth user has the algorithm is guaranteed to converge after substreams,

iterations. If we assume that each

user is assigned /? substreams to achieve the same throughput, the number of iterations simplifies to K  13. Since the complexity of the system varies linearly with the total number of substreams, the algorithm can be easily implemented at a cellular base station.

56

C h ap ter 5 N u m erica l R esu lts and D iscu ssion
In this chapter, a Monte Carlo analysis is utilized to evaluate the BER performance of the adaptive subcarrier allocation algorithm for OFCDM. We compare the performance of adaptive OFCDM with traditional OFCDM under various spreading factors to examine the effectiveness of the proposed algorithm. This chapter is organized as follows. In section 5.1, the system parameters and channel model are presented. The BER performance of the adaptive and non-adaptive OFCDM systems is then evaluated with various spreading factors in section 5.2.

5 .1

S y s te m P a r a m eter s

To emulate the performance of the proposed algorithm, parameters are chosen for the OFCDM system that are typical for 4G wireless systems. As a result, the carrier frequency of the system, fc, is selected to be 5GHz. The reverse link channel bandwidth is 20MHz, which is sufficient to support the uplink requirements of high data rate applications that may be utilized in 4G systems. There are a total of 128 sub carriers within the allocated

57

frequency band. The resulting sub carrier bandwidth, 1/Tc, is 156.25kHz, which corresponds to a PN chip duration of 6.4/is. In these results, the performance of the adaptive subcarrier allocation algorithm is eval uated under various spreading factor configurations. These different settings can be used by a provider to provide different levels of frequency diversity, or to minimize MAI in the event of high channel utilization. To represent a case with high time domain spreading, a spreading factor of 16 is utilized in the time domain, with a processing gain of 2 in the frequency domain. This spreading factor is denoted 16x2 for the remainder of the chapter. Simulations are also performed with spreading factors of 8x4, 4x8, to show the benefit of the algorithm for OFCDM systems that employ moderate levels of time and frequency do main spreading. Finally, a case with 2x16 spreading is presented, where frequency domain spreading is prioritized. Each of these configurations utilizes a total spreading factor of 32 to provide a suitable performance comparison. In this simulation 32 users are provisioned to the channel simultaneously, each with the identical spreading factor. In order to provide an identical level of throughput for each spreading factor, 2N substreams are transmitted simultaneously for each user. This is done because N PN chip durations are required to transmit each bit when time domain spreading is employed. By making the number of substreams a multiple of the spreading factor, the data rate is identical in each analysis. The four OFCDM spreading configurations are summarized below. Configuration A B C D ` S'Fiime SFfreq 16 2 8 4 4 8 2 16 Substreams 32 16 8 4

Table 5.1: Spreading Factor Configurations

58

The channel model utilized in the analysis is also characteristic of a typical 4G wireless system. We assume that each subcarrier experiences frequency non-selective fading, and th at fading is uncorrelated between adjacent subcarriers. Consequently, evaluations are

performed with an RMS delay spread of 6.4/rs, which is common for densely populated urban areas [18]. In this case, the delay spread is identical to the chip duration, Tc, indicating there is no ISI produced by the channel. This allows us to utilize independent, identically distributed Rayleigh variables to represent the gain of each subcarrier. Since the channel parameters are defined for a densely populated area, the user velocity is assumed to be 5km/h. This represents a suitable velocity for pedestrian or non-mobile users. This corresponds to a Doppler frequency, -- v/X, of 23.14Hz. Based on this Doppler

frequency, the coherence time of the channel can be approximated as 18ms. To ensure th at the channel is constant over the update period of the adaptive subcarrier allocation algorithm, we select the update period to be equivalent to the coherence time. As a result, each user has the opportunity to transmit 5625 bits before new subcarriers are allocated by the base station.

5 .2

R e s u lts an d D isc u ssio n

In this section, we provide a performance comparison between non-adaptive OFCDM and OFCDM employing the proposed adaptive subcarrier allocation algorithm. In figure 5.1, we present a baseline measurement for the performance of the non-adaptive OFCDM system with each of the spreading factors. The BER vs. E b /K curve yielded in this simulation closely matches the results presented in [12], where the closed-form performance of OFCDM was initially evaluated. It is evident from this figure that under the defined channel con ditions, the higher frequency domain spreading factor produces more favorable conditions

59

HI

- a - 16x2 - e - 8x4 - 9- 4x8 -- 2x16 -10 Eb/No (dB)

Figure 5.1; BER vs. E^/No for non-adaptive OFCDM with various spreading factors

because of the additional frequency diversity gained by transmitting over independently faded subcarriers. Now that a baseline BER measurement is established for the OFCDM system, we compare the result from [12] with OFCDM employing the proposed adaptive subcarrier allocation algorithm. In figure 5.2, we present the BER vs. Eb/No curve for the adaptive and nonadaptive OFCDM systems with a spreading factor of 16x2. The result indicates that the adaptive subcarrier allocation algorithm produces an improvement of 7dB for a target BER of 10"F The algorithm also reduces the BER floor from approximately 6x10" ^ to 2.5x10"^. It is evident from this results that the performance is improved considerably in both the noise and interference limited regions of the curve. This occurs because users are assigned to sub carriers with the best SINR, while the interference caused to other users is minimized.

60

n

y 10*

a
Q D Q o <I

-- B-- OFCDM (You et. al.)  Adaptive OFCDM -10 Eb/No (dB)

Figure 5.2: BER vs. Ef,/No with 16x2 spreading

In figures 5.3 and 5.4, we present the BER vs. Ei/N ^ curves for the OFCDM systems with 8x4 and 4x8 spreading respectively. The results indicate that for both spreading fac

tors, the proposed algorithm reduces the BER floor, and improves performance in the noise limited region of the BER curve. More specifically, a 4dB gain is achieved with 8x4 spreading at a BER of 10" ^. When 4x8 spreading is employed, the performance gain is reduced to 2.5dB, and the reduction in the BER floor is less pronounced. These results suggest that the adaptive sub carrier allocation algorithm provides more significant performance improve ments with a higher time domain spreading factor. This result is expected because there are more available subcarrier groups, which provides a better opportunity to locate subcarriers with the best fading characteristics, which simultaneously minimize MAI. In addition, it is found th at frequency diversity moderates the SINR achieved on each subcarrier. This

61

 ! ......

i

5

G G

O

- ô - OFCDM (You et. al.) o Adaptive OFCDM -10 Eb/No (dB)

Figure 5.3: BER vs. Eb/No with 8x4 spreading

reduces the performance improvement because each subcarrier group experiences a similar total fading gain. In figure 5.5, we plot the BER vs. Eb/No curve for the adaptive and non-adaptive OFCDM system with 2x16 spreading. This result indicates that the algorithm improves the performance in the noise limited region by approximately 1.5dB. Again, this performance gain is less significant than utilizing a higher time domain spreading factor, because there are only 8 subcarrier groups available with 2x16 spreading. Another interesting characteristic of this curve is that there is no reduction in the BER floor with the proposed algorithm. This occurs because the frequency diversity improves signal power with respect to the noise, and subcarrier adaptation simply increases the interference power proportionally to the signal power. In addition, since there are 4 substreams for each user, some substreams may not be

62

y -10

OFCDM (You et. al.) Adaptive OFCDM

ElVNo (dB)

y _ ..

Figure 5.4: BER vs. E^/No with 4x8 spreading

allocated to groups where the best conditions exist. In figure 5.6, we plot the BER vs. E^/No curve for the adaptive OFCDM systems with different spreading factors. This figure presents an interesting characteristic of the adaptive subcarrier allocation algorithm. At small values of E^/No, the absolute performance is

superior when a high time domain spreading factor is utilized. This result is expected because there are more subcarrier groups available to maximize the average SINR of the system. The opposite result occurs at high Eb/No values. To explain this phenomenon, we refer to the results provided in [18], where the performance of the water-filling algorithm is originally evaluated for single subcarrier allocation. In this paper, it is found that the algorithm is suboptimal at higher values of Eb/No- This occurs because the system performance is limited by MAI, and selecting sub carriers with large SINR values provides a negligible gain

63

-- '-- OFCDM (You et. al.) - Adaptive OFCDM Eti/No (dB)

Figure 5.5; BER vs. Eb/Ng with 2x16 spreading

with respect to the AWGN noise power. Also, since more substreams are utilized for higher time domain spreading factors, several substreams are assigned to less favorable subcarriers. In this case, our results indicate that the frequency diversity gained by transmitting over independently faded subcarriers produces a more favorable results at high levels of Eb/Ng. It is evident from this curve that there is a distinct threshold above 2.5dB, where a higher frequency domain spreading factor is superior. This represents the transition of the OFCDM system from being limited by thermal noise, to being interference-limited. As a result, when high bit energies are employed, a high frequency domain spreading factor should be employed to maximize the absolute performance. At lower levels of EblNg, time domain spreading should be prioritized to improve performance. The results presented in this section show that the adaptive subcarrier allocation al-

64

i

- B - 16x2 - e - 8x4 - 94x8 -- 2x16

-10
Eb/No (dB)

Figure 5.6: BER vs. E^/No for adaptive OFCDM with various spreading factors

gorithm is effective at reducing the BER for OFCDM systems. It is generally determined th at the performance improvement is more significant when a higher time domain spreading factor is employed, because there are more subcarrier groups that can be utilized by the al gorithm to maximize performance. We also find that while a higher time domain spreading factor is effective at improving the BER performance in the noise limited region of the BER curve, it performs worse at high levels of Eb/No- In this case, frequency diversity allows the system to achieve higher absolute performance. Overall, the results indicate that the adaptive subcarrier allocation algorithm is effective at improving the BER performance of OFCDM with various spreading factors.

65

Chapter 6 Conclusions and Future Research

6.1

C onclusions

In the fourth generation of wireless systems, users will require access to high data rate ap plications such as streaming video, multimedia and internet access. Since these applications generally require a large bandwidth, OFCDM is a viable option to support the demanding requirements of these services. This scheme accommodates a large bandwidth by employing several narrowband subcarriers that are inherently resistant to ISI. In addition, the time and frequency domain spreading employed by this system allows it to achieve higher performance than systems that employ one dimensional spreading. The frequency domain spreading fac tor can be increased to maximize gains from frequency diversity, while multipath diversity and minimal MAI can be provided with time domain spreading. In this thesis, an adaptive subcarrier allocation algorithm is developed to further improve the BER performance of OFCDM. The proposed algorithm allocates sub carriers to users that such that the overall BER of the cell is minimized. This is accomplished by assigning users to subcarriers that produce the best SINR characteristics, while producing the minimal amount

66

of MAI to other users. The proposed algorithm is shown to provide an improvement in the BER performance of OFCDM under all spreading factors. More specifically, when a high time domain spread ing factor is employed, the adaptive OFCDM system is shown to outperform traditional OFCDM by 7dB in the noise limited region of the BER curve, and is able to significantly reduce the BER floor. As the frequency domain spreading factor is increased, the perfor mance improvement is less significant. When 8x4 spreading and 4x8 spreading are employed, the performance improvement is limited to 4dB and 2.5dB respectively. Finally, when 2x16 spreading is utilized, the performance gain is l.SdB. This performance improvement is re duced because there are fewer groups available to the subcarrier adaptation algorithm to maximize the system performance. In addition, the frequency diversity gained by the sys tem effectively moderates the SINR for each subcarrier group. Overall, the proposed adaptive subcarrier allocation algorithm is shown to be very effec tive at improving the BER performance of OFCDM with various spreading factors. Since this algorithm is relatively simple to implement, it is an excellent method of improving the performance of OFCDM, with a minimal amount of additional complexity.

6 .2

F u tu re R esea rch

The favorable results provided by the adaptive subcarrier allocation algorithm proposed in this report bring several new ideas that could further improve performance. Some future research on this topic is listed below · The adaptive sub carrier allocation algorithm proposed in this thesis utilizes a spreading factor th at can be changed based on the conditions that exist in the cell. This includes characteristics such as the Doppler frequency and delay spread of the channel. In a 67

practical environment, users may each travel at a different velocity, or experience a different delay spread. As a result, an adaptive subcarrier allocation can be developed with groups that utilize different spreading factors. This would accommodate users with different fading characteristics. The purpose of OFCDM is to provide a flexible system that can provide the highest throughput possible. In this thesis, adaptive sub carrier allocation is utilized only with BPSK modulation. A further improvement to the proposed system would be to incorporate adaptive modulation and coding and adaptive subcarrier allocation simultaneously. This would allow the system to experience higher throughput, while experiencing better BER performance. In 4G systems, the forward link is required to provide much higher throughput than the reverse link, due to asymmetrical traffic experienced applications that utilize Internet Protocol (IP). As a result, a variation of the proposed algorithm can be adapted to improve the performance of OFCDM in the forward link.

68

B ib liograp h y
[1] A. Parthasarathy. "Push-to-Talk over Cellular (PoC) Server." 2005 IEEE Networking, Sensing and Control, pp. 772 - 776, Mar. 19, 2005. [2] K. Parkas and G. Hunt. ''New Products." IEEE Pervasive Computing, Vol 3, No. 2, pp. 10 - 11, April 2004. [3] T. S. Rappaport. ''Wireless Communications: Principles and Practice, Second Edi tion." Prentice Hall. Upper Saddle River, NJ, 2002. [4] B. Parsaee and A. Yarali. ''OFDMA for the 4th Generation Cellular Networks." Cana dian Conference on Electrical and Computer Engineering, Vol. 4, May 2, 2005, pp. 2325 - 2330. [5] L. Hanzo, M. Munster, B. J. Choi and T. Keller. ''OFDM and MC-CDMA for Broad band Multi-User Communications, WLANs and Broadcasting," John Wiley & Sons Ltd., West Sussex, England, 2003. [6] J. G. Proakis. ''Digital Communications, Fourth Edition." McGraw Hill, New York,
2001 .

69

[7] V.M DaSilva and E. S. Sousa. ''Performance of Orthogonal CDMA Codes for QuasiSynchronous Communication Systems." Proc. of IEEE ICUPC1993^ Ottawa, Canada, Oct. 1993, pp. 995 - 999. [8] N. Yee, J-P. Linnartz and G. Fettweis, ''Multicarrier CDMA in Indoor Wireless Radio Networks," Proc. of IEEE PIMRC 1993, Yokohama, Japan, Sept. 1993, pp. 109 - 113. [9] K. Fazel and L. Papke, "0n the Performance of Convolutionally Coded CDMA/OFDM for Mobile Communication Systems," Proc. of IEEE PIMRC 1993, Yokohama, Japan, Sept. 1993, pp. 468 - 472. [10] A. Chouly, A. Brajal and S. Jourdan, ''Orthogonal Muticarrier Techniques Applied to Direct Sequence Spread Spectrum CDMA Systems," Proc. of IEEE GLOBECOM 1993, Houston, USA, Nov. 1993, pp. 1723 - 1728. [11] L. Xiao and Q. Liang. "A Novel MC-2D-CDMA Communication System and Its De tection Methods," IEEE International Conference on Communications, 2000, Vol. 3, New Orleans, USA, June 2000, pp. 1223 - 1227. [12] C. W. You and D. S. Hong. ''Multicarrier CDMA Systems Using Time-Domain and Prequency-Domain Spreading Codes," IEEE Transactions on Communications, Vol. 51, No. 1, Jan. 2003, pp. 17 - 21. [13] K. Zheng, G. Zeng, and W. Wang. ''Performance Analysis for OFDM-CDMA with Joint Frequency-Time Spreading," IEEE Transactions on Broadcasting, Vol. 51, No. 1, Mar. 2005, pp. 144 - 148. [14] Z. Wu, C. R. Nassar and B. Natarajan. " FD-MC-CDMA : A Frequency Based Multiple Access Architecture for High Performance Wireless Communication." IEEE Radio and Wireless Conference, pp. 169 - 172, Aug. 2001. 70

[15] J. Kim, C. N. Georghiades and G. M. Huang. "Adaptive Data Transmission Based on Band-Selection for MG-CDMA" IEEE Global Telecommunications Conference 2001, Vol. 5, pp 3125 - 3129, Nov. 2001. [16] M. Elkashlan and C. Leung. "Performance of Frequency-Hopping Multicarrier CDMA on an Uplink with Correlated Rayleigh Fading," IEEE Global Telecommunications Conference 2003, Vol. 6, pp. 3407 - 3411, Dec. 2003. [17] T. Lestable, L. Husson, J. Antoine, and A. Wautier. ''Performance of Adaptive MCCDMA in HiperLAN/2-|-+," 2002 IEEE 56th Vehicular Technology Conference, Vol. 2, pp. 1091 - 1095, Sept. 2002. [18] Q. Chen, E. S. Sousa and S. Pasupathy. ''Multicarrier CDMA with Adaptive Frequency Hopping for Mobile Radio Systems," IEEE Journal on Selected Areas in Communica tions, Vol. 14, No. 9, pp. 1852 - 1858, Dec. 1996. [19] Y. H. Kim, I. Song, S. Yoon, and S. R. Park. "A Multicarrier CDMA System with Adaptive Subchannel Allocation for Forward Links,'' IEEE Transactions on Vehicular Technology, Vol. 48, No. 5, pp. 1428 - 1436, Sept. 1999. [20] H. Long and Y. H. Chew. "An Adaptive Subcarrier Allocation Scheme for MC-DSCDMA Systems in the Presence of Multiple Access Interference," 2004 IEEE Interna tional Conference on Communications, Vol. 5, pp. 2894 - 2898, June 2004. [21] A. Matsumoto, K. Miyoshi, M. Uesugi, and O. Kato. "A Study on Time Domain Spreading for OFCDM," The 5th International Symposium on Wireless Personal Mul timedia Communications, 2002, Vol. 2, pp. 725 - 728, Oct. 2002. [22] N. Maeda, Y. Kishiyama, H. Atarashi, and M. Sawashashi. ''Variable Spreading FactorOFCDM with Two Dimensional Spreading that Prioritizes Time Domain Spreading 71

for Forward Link Broadband Wireless Access," The 57th IEEE Semiannual Vehicular Technology Conference, 2003, Vol. 1, pp. 127 - 132, April 2003. [23] M. Tan and Y, Bar-Ness. ''Performance Comparison of the Multi-Code Fixed Spread ing Length (MFSL) Scheme and Variable Spreading Length (VSL) Scheme for MultiRate MC-CDMA," 2002 IEEE Seventh International Symposium on Spread Spectrum Techniques and Applications, Vol. 1, pp. 108 - 112, 2002. [24] M. Elkashlan and C. Leung. ''Performance of Frequency Hopping Multicarrier CDMA in Rayleigh Fading," IEEE 56th Vehicular Technology Conference, Vol. 1, pp. 341 345, Sept. 2002. [25] Y. Kishiyama, N. Maeda, K. Higuchi, H. Atarashi and M. Sawahashi. ''Experiments on Throughput Performance Above 100-Mbps in Forward Link for VSF-OFCDM Broad band Wireless Access," IEEE 58th Vehicular Technology Conference, Vol. 3, pp. 1863 - 1868, Oct. 2003. [26] H. Atarashi, N. Maeda, S. Abeta and M. Sawahashi. "Broadband Packet Wireless Access Based on VSF-OFCDM and MC/DS-CDMA," The 13th IEEE International Symposium on Personal, Indoor and Mobile Radio Communications, Vol. 3, pp. 992 997, Sept. 2002. [27] S. Erkucuk. ''Time-Frequency Analysis of Spread Spectrum Based Communication and Audio Watermarking Systems," Ryerson University Thesis, Toronto, Canada, 2003. [28] R. Caldwell and A. Anpalagan. "HSDPA - An Overview". IEEE Canadian Review, Spring 2004, No. 46, pp. 22 - 24.

72

[29] R. Caldwell and A. Anpalagan. ''Adaptive Subcarrier Allocation for Orthogonal Fre quency Code Division Mutliplexing (OFCDM); Reverse Link Analysis." To be submit ted to IEEE Transactions on Vehicular Technology.

73

