Development and Performance Characterization of Colour Star Trackers

by

Geoffrey McVittie MASc. of Aerospace Engineering Ryerson University, 2007

A thesis presented to Ryerson University in partial fulfilment of the requirements for the degree of Doctorate of Philosophy in the Program of Aerospace Engineering

Toronto, Ontario, Canada, 2013 c Geoffrey McVittie 2013

I hereby declare that I am the sole author of this thesis. I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research.

I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

iii

Development and Performance Characterization of Colour Star Trackers Geoffrey McVittie, Doctorate of Philosophy, Aerospace Engineering, 2013 Ryerson University

Abstract
Star trackers provide an essential component to a satellite mission requiring high-precision and high-accuracy attitude measurements. A star tracker operates by taking pictures of the celestial sphere and attempting to identify the stars in the image using a combination of the geometric and brightness patterns. The star-positions in the image then determine the attitude of the sensor in the inertial frame. I propose extending the capability of star trackers by including the colour properties of the stars into the star identification process; hence, colour star tracking. Current generation star trackers exist in a variety of forms, with a variety of additional potential designs and operational algorithms proposed in the literature. However, they all share the common trait of using a combination of geometric and monochrome brightness derived patterns to identify stars. Including colour information with the geometric and brightness properties into the identification process represents a new branch in the field of star tracker design. The process of measuring colour also causes a reduction in the amount of light gathered by the sensor, decreasing the number of stars observed. The challenge in colour star tracking becomes establishing that the additional information provided by colour to star patterns is greater than the loss of observable stars due to the measurement process. While superficially brief, accomplishing it touches upon a wide range of topic areas. This includes most research developed for monochromatic star trackers including imaging hardware, optics, noise rejection, parameter estimation, signal detection, data mining, pattern matching, and astronomy. Additionally, using colour necessitates introducing the topics of stellar photometry, spectral filtering, and colour imaging. The approach to colour star tracker development, presented here, considers three aspects to the operation of the technology: colour measurement, star detection, and star pattern v

matching. In the measurement of colour analysis, a new set of estimation techniques are developed to estimate the colour and position of stars using colour-filter-array and trichroic prism cameras. Validation of the proposed techniques is achieved through a combination of laboratory and nigh-sky testing of hardware prototypes. The detection performance of the colour star tracker designs centres on a comparison with equivalent monochrome designs. By considering primitive detection algorithms, essentially raw thresholding, allows for a fair determination of the relative performance. Numerical simulations of potential designs examine the percentage of the celestial sphere where sufficient quantity of stars can be observed to yield an identification. Finally, extending the results of the detection analysis allows for a determination of the ambiguity within observed star scenes. While not explicitly pattern matching, this analysis establishes a baseline for the performance to be expected from practical pattern matching algorithms. Together, the combined results establish the overall expected increase in performance of colour star tracking over equivalent monochrome designs. A critical goal of any star tracker design is to maximize the region of sky where the star tracker can successfully return an attitude solution. Additionally, the reliability of achieving correct attitude solutions must also be a factor. The work presented demonstrates that, given the correct design circumstances, colour star trackers can supersede their monochrome counterparts in these two aspects. Specifically by resolving formerly ambiguous scenes and increasing the total number of scenes that can yield a solution. As a consequence, colour measurement should now become a viable and explicit consideration in future star tracker design processes.

vi

Acknowledgements
First and foremost, I would like to thank my advisor Dr. John Enright. It has been an honour to be the first of what will no doubt be many PhD students. His insight into theoretical development, experimental procedures, and technical writing in the field of star trackers has provided me with a standard of practice that will remain with me for any future career path in the fields of engineering or science. Furthermore, his always positive attitude and willingness to help assist in any research problem encountered made the completion of this thesis possible. Next, I would like to thank the esteemed members of my thesis defence. Dr. Anton de Ruiter for his expertise on parameter estimation and thoroughness in his review of work and writing. Dr. David Greatrix for his general advice on technical writing and presentation; particularly, to write in the third person. Dr. Matthew Kyan for his review of the pattern identification and ambiguity analysis portions of my thesis. The external examiner, Dr. Brendan Quine, for his specific expertise on star trackers and their design. Beside those above, I also want to thank the many faculty and staff of the Ryerson Aerospace Engineering department who helped me towards completing this thesis. Kim Gallo and Leah Rogan who always have smiles, even when I was submitting documentation at the last minute or late. Primoz Cresnik and Peter Bradley who could always help me get access to parts, equipment, or late-night machining in order to finish experimental results. I would like to acknowledge the many friends and co-workers who have shared in my academic journey. In particular, Tom Dzamba, who as fellow colleague under Dr. Enright, shared in the many days of intense work as well as the days where video games were the norm. Although, his impact on the local atmosphere (literally) could be very distracting, the constant jokes and buffoonery he brought to the laboratory was always for the best. Dmitri Ignakov, who also worked alongside Tom and I, was always ready to help out and investigate research avenues that no one else would dare go near. Furthermore, the boredom of research would usually be broken by Dmitri attempts to incite Tom into a conflict where no victory would be possible. I would also like to offer a thanks two vii

friends, Rupauk Sircar and Adrian Marek, who's support and advice on life helped get me through some rough spots during the course of the PhD program. Finally, the greatest thanks go towards my family. To my mother for always encouraging me and watching out for my well-being, even when I was not. To my father whom I can always count on for help and support with any problem no matter how bad. And to my 'little' brother who forced me to be a role model and will likely follow me to the top of academia.

viii

Dedication
This dissertation is lovingly dedicated to my mother, father, and brother. Without their love and support I would never have been able to go so far.

ix

Contents
Declaration . . . . Abstract . . . . . . Acknowledgements Dedication . . . . . List of Figures . . List of Tables . . . List of Acronyms . Nomenclature . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Page . iii . v . vii . ix . xvii . xix . xix . xxi 1 3 4 5 6 7 7 9 9 10 11 11 12 13

1 Introduction 1.1 Motivation . . . . . . . . . . . . . 1.2 Goals and Objectives . . . . . . . 1.2.1 Contributions . . . . . . . 1.2.2 Methodology . . . . . . . 1.2.3 Implementation Problems 1.3 Outline . . . . . . . . . . . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

2 Background and Literature Review 2.1 Camera Model . . . . . . . . . . . . 2.1.1 Pinhole Camera Model . . . 2.1.2 Point Spread Function . . . 2.1.3 Incident Photon Flux . . . . 2.1.4 Field of View . . . . . . . . 2.2 Image Detectors . . . . . . . . . . . xi

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

2.3

2.4

2.5

2.2.1 Photon Measurement Model . . . 2.2.2 Noise Model . . . . . . . . . . . . 2.2.3 Detector Technologies . . . . . . Star Trackers . . . . . . . . . . . . . . . 2.3.1 Image Acquisition . . . . . . . . . 2.3.2 Image Filtering . . . . . . . . . . 2.3.3 Star Identification . . . . . . . . . 2.3.4 Attitude Estimation and Filtering Spectrophotometry . . . . . . . . . . . . 2.4.1 Spectral Flux and Magnitude . . 2.4.2 Star Classification Systems . . . . 2.4.3 Astronomical Catalogues . . . . . 2.4.4 Atmospheric Attenuation . . . . . Conclusion . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

13 14 15 16 17 18 20 26 26 26 28 29 30 31 33 34 35 37 39 43 43 44 44 45 46 46 46 49 51 51 52 53 55

3 Colour Filter Array Star Tracker 3.1 Principles of Operation . . . . . . . . . . . . . . . . . . . . 3.2 Star Parameter Estimation . . . . . . . . . . . . . . . . . . 3.2.1 Arithmetic Estimation . . . . . . . . . . . . . . . . 3.2.2 Curve-Fitting Point Spread Function (PSF) Models 3.2.3 Curve-Fitting Estimation . . . . . . . . . . . . . . . 3.3 Calibration . . . . . . . . . . . . . . . . . . . . . . . . . . 3.3.1 Geometric . . . . . . . . . . . . . . . . . . . . . . . 3.3.2 PSF Scale and Shape . . . . . . . . . . . . . . . . . 3.3.3 Local Pixel Variation . . . . . . . . . . . . . . . . . 3.4 Laboratory Testing and Validation . . . . . . . . . . . . . 3.4.1 Laboratory Facility . . . . . . . . . . . . . . . . . . 3.4.2 Calibration Results . . . . . . . . . . . . . . . . . . 3.4.3 Parameter Estimation Performance . . . . . . . . . 3.5 Field Images . . . . . . . . . . . . . . . . . . . . . . . . . . 3.5.1 Stargazing Site . . . . . . . . . . . . . . . . . . . . 3.5.2 Star Colour Estimates . . . . . . . . . . . . . . . . 3.6 Analysis and Further Improvements . . . . . . . . . . . . . 3.7 Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . xii

. . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . .

4 Trichroic Filtered Prism Colour Star Tracker 4.1 Principle of Operation . . . . . . . . . . . . . 4.2 Star Parameter Estimation . . . . . . . . . . . 4.2.1 Arithmetic . . . . . . . . . . . . . . . . 4.2.2 Curve-Fitting Model . . . . . . . . . . 4.2.3 Curve-Fitting Estimation . . . . . . . . 4.3 Calibration . . . . . . . . . . . . . . . . . . . 4.3.1 Geometric . . . . . . . . . . . . . . . . 4.3.2 Vignetting . . . . . . . . . . . . . . . . 4.4 Laboratory Testing . . . . . . . . . . . . . . . 4.4.1 Calibration Results . . . . . . . . . . . 4.4.2 Performance of Parameter Estimation . 4.5 Field Validation . . . . . . . . . . . . . . . . . 4.6 Analysis and Future Improvements . . . . . . 4.7 Conclusion . . . . . . . . . . . . . . . . . . . . 5 Star Detection Trade Study 5.1 Detection Algorithms . . . . . . . . . . . . . . 5.1.1 Single Image Detection . . . . . . . . . 5.1.2 Multi Image Detection . . . . . . . . . 5.2 Sensor Design Framework . . . . . . . . . . . 5.2.1 Sky Coverage . . . . . . . . . . . . . . 5.2.2 False Detection Rate . . . . . . . . . . 5.2.3 Colour Filters Constraint . . . . . . . . 5.2.4 Candidate Filters . . . . . . . . . . . . 5.3 Methodology of Performance Simulations . . . 5.3.1 Numerical Modelling of False Detection 5.3.2 Composite Star Catalogue . . . . . . . 5.3.3 Estimation of Detection Sensitivity . . 5.3.4 Modelling Star Scene Detection . . . . 5.4 Simulation Results . . . . . . . . . . . . . . . 5.4.1 False Detection Rate . . . . . . . . . . 5.4.2 Detection Sensitivity . . . . . . . . . . 5.4.3 Comparison of Sky Coverage . . . . . . xiii

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

57 58 59 59 62 63 63 64 64 65 65 66 67 69 72 73 73 74 75 76 77 77 78 82 84 85 87 88 90 91 92 93 94

. . . . . . . . . . . . . . . . . . . . . . . . . . . Rate . . . . . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . .

5.5

5.4.4 Analysis and Design Verdict . . . . . . . . . . . . . . . . . . . . . Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

94 98 101 102 102 103 104 105 106 106 108 109 110 110 111 111 112 112 113 114 119 121 121 122 122 123 124 124 125 125 126 126

6 Colour Star Patterns 6.1 Pattern Catalogue Design . . . . . . . . . 6.1.1 Characterizing Star Pairs . . . . . . 6.1.2 Comparison of Star Pairs . . . . . . 6.1.3 Star Pattern Catalogue Entries . . 6.2 Pattern Identification and Ambiguity . . . 6.2.1 Pattern Ambiguity . . . . . . . . . 6.2.2 Pair Matching . . . . . . . . . . . . 6.2.3 Scene Matching . . . . . . . . . . . 6.2.4 Classifier Error . . . . . . . . . . . 6.3 Simulation Methodology . . . . . . . . . . 6.3.1 Scene Simulation and Identification 6.3.2 Ambiguity Assessment . . . . . . . 6.3.3 Sensor Configurations . . . . . . . 6.4 Results . . . . . . . . . . . . . . . . . . . . 6.4.1 Single Sensor Sky Coverage . . . . 6.4.2 Design Performance Survey . . . . 6.5 Analysis and Further Improvements . . . . 6.6 Conclusions . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . .

7 Conclusion 7.1 Empirical Findings . . . . . . . . . . . . . . . 7.1.1 Colour Measurement Characteristics . 7.1.2 Detection Sensitivity Trade Study . . . 7.1.3 Colour Star Pattern Ambiguity . . . . 7.2 Implications to Star Tracker Technology . . . 7.2.1 Basic Techniques . . . . . . . . . . . . 7.2.2 Development and Analysis Framework 7.2.3 Forecast of Break-Even Performance . 7.3 Recommendations for Future Research . . . . 7.3.1 Hardware and Parameter Estimation . xiv

. . . . . . . . . .

. . . . . . . . . .

. . . . . . . . . .

. . . . . . . . . .

. . . . . . . . . .

. . . . . . . . . .

. . . . . . . . . .

. . . . . . . . . .

. . . . . . . . . .

. . . . . . . . . .

. . . . . . . . . .

. . . . . . . . . .

. . . . . . . . . .

. . . . . . . . . .

. . . . . . . . . .

7.4

7.3.2 Star Detection Techniques . . 7.3.3 Colour Filter Design . . . . . 7.3.4 Star Identification Techniques Conclusion . . . . . . . . . . . . . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

126 127 127 128 129 129 129 131 131 132 132 141

A Geometric Calibration Model A.1 Model Parameters . . . . . . . . . . . . . . . A.2 Frame Transformations . . . . . . . . . . . . A.2.1 Lab­End Effector Transformation . . A.2.2 End Effector­Mount Transformation A.2.3 Mount-Detector Transformations . . A.3 Inverse Model . . . . . . . . . . . . . . . . . References

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

xv

List of Figures
1.1 2.1 2.2 2.3 2.4 2.5 2.6 2.7 3.1 3.2 3.3 3.4 3.5 3.6 3.7 3.8 3.9 ST-16 Commercial Star Trackers . . . . . . . . . . . . . . . . . . . . . . 1 12 17 21 23 24 29 31 35 36 37 38 42 47 49 50 54 59 60 61

Pinhole camera model for star point source at infinity. . . . . . . . . . . . Functional flow diagram of star tracker processing chain [Spratling & Mortari 2009]. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Star identification process flow diagram . . . . . . . . . . . . . . . . . . . The geometry of the polygon star pattern matching algorithms. . . . . . Simplified model of the grid algorithm. . . . . . . . . . . . . . . . . . . . Contribution of spectral classes and luminosity types derived from Sky2000 stellar catalogue (approximately 6 × 103 stars). . . . . . . . . . . . . . . Atmospheric transmittance response for incident star light. . . . . . . . . Filter Response Profiles of the MT9P031-M and -C Detectors. . . . . . . Hot (blue) star mosaic image response. . . . . . . . . . . . . . . . . . . . Cold (red) star mosaic image response. . . . . . . . . . . . . . . . . . . . Development hardware of the MT9P031 . . . . . . . . . . . . . . . . . . Comparison of PSF Model Shapes . . . . . . . . . . . . . . . . . . . . . . Star tracker testing facility . . . . . . . . . . . . . . . . . . . . . . . . . . Spatial response of raw colour estimates for rg colour ratio. . . . . . . . Statistical response for correction of rg colour ratio. . . . . . . . . . . . Subset of field CFA colour ratio estimates with raw values in pastel, mean in colour, and expected catalogue value in black. . . . . . . . . . . . . . . Schematic diagram of photon path through trichroic camera. . . . . . . . JAI AT-200ge camera. . . . . . . . . . . . . . . . . . . . . . . . . . . . . Spectral pass bands of the JAI AT-200ge camera. . . . . . . . . . . . . . xvii

4.1 4.2 4.3

4.4 4.5 4.6

Vignetting response for the green component image. . . . . . . . . . . . . Stationary centroid estimation. . . . . . . . . . . . . . . . . . . . . . . . Subset of field TFP colour ratio estimates with raw values in pastel, mean in colour, and expected catalogue value in black. . . . . . . . . . . . . . . Connectivity-4 and -8 cluster detection. . . . . . . . . . . . . . . . Photon flux magnitude to number of detectable stars. . . . . . . . Custom CFA filter arrangement. . . . . . . . . . . . . . . . . . . . Custom DFP filter response. . . . . . . . . . . . . . . . . . . . . . Estimated photon response curves for stars of type V intensity. . Simulated star image. . . . . . . . . . . . . . . . . . . . . . . . . . Star Scene Detection Probability Map . . . . . . . . . . . . . . . . False detection rate estimation. . . . . . . . . . . . . . . . . . . . Detection sensitivity rates of catalogued stars. . . . . . . . . . . . Star Density up to mq = 6 at f = 16mm. . . . . . . . . . . . . . Detection coverage of the celestial sphere using Monochrome CST. Detection coverage of the celestial sphere using CFA-CST. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

67 69 71 75 83 84 85 89 90 92 93 96 97 98 99 114 116 117 118

5.1 5.2 5.3 5.4 5.5 5.6 5.7 5.8 5.9 5.10 5.11 5.12 6.1 6.2 6.3 6.4

Spatial probability of ambiguity for monochrome sensor, f = 16 mm. Spatial probability of ambiguity of Colour Filter Array (CFA) sensor, f 16 mm. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Spatial probability of ambiguity for monochrome sensor, f = 16 mm. Spatial probability of ambiguity of CFA sensor, f = 16 mm. . . . . .

. . = . . . . . .

xviii

List of Tables
3.1 3.2 3.3 3.4 4.1 4.2 4.3 4.4 5.1 5.2 5.3 6.1 6.2 Comparison of statistical colour estimates. . . . . . . . . . . Calibration Results for the MT9P031 Hardware Prototype. . Comparison of stationary and local translation of star image. Observed Star Parameter Estimates . . . . . . . . . . . . . . Calibration Results for the JAI200 Hardware Prototype. . . Comparison of stationary and local translation of star image. Colour Estimates of Star Field Survey. . . . . . . . . . . . . Measurements from Star Pair:  Umi and  Umi . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48 51 51 53 66 68 70 70 86 86 95

Comparison of expected detection performance. . . . . . . . . . . . . . . Sensor Configuration Parameters . . . . . . . . . . . . . . . . . . . . . . Comparative Sky Coverage Performance Survey of Sensor Designs . . . .

Star parameter measurement noise values. . . . . . . . . . . . . . . . . . 112 Comparison of ambiguity in colour and monochrome star tracker designs. 115

A.1 Star Tracker Geometric Parameters . . . . . . . . . . . . . . . . . . . . . 130

xix

List of Acronyms
ADC APS CCD CFA CMOS CST DC DFP FDR FOV LIS MLE MST OA PE PSF QE RN SNR TFP Analogue to Digital Converter Active Pixel Array Charge Coupled Device Colour Filter Array Complementary Metal Oxide Semiconductor Colour Star Tracker Dark Current Dichroic Filter Prism False Detection Rate Field of View Lost In Space Maximum Likelihood Estimator Monochrome Star Tracker Optical Axis Photo-Electron Point Spread Function Quantum Efficiency Read Noise Signal to Noise Ratio Trichroic Filter Prism

xxi

Nomenclature
 A (a1 , a2 ) (b1 , b2 ) Bij c Cij Eph ( ) f F/# F ( ) F0 ( ) fGAUSS (x, y ) fLORENTZ (x, y ) Spatial scaling parameter of Moffat function. Active area of pixel. Angular distortion coefficients. Radial distortion coefficients. Background noise at ij . Speed of light. Catalogue star pair ij . Energy of photon. Focal length. Lens F-number. Spectral flux density. Reference spectral flux density. Gaussian function. Lorentz function. xxiii

fMOFFAT (x, y ) fLWR (x, y ) gij (x) gLSB/e- h Iij I0 (Ir , Ig , Ib ) IM ICFA ITFP kloss k mq mod Mr , Mg , Mb mM mCFA mTFP

Moffat function. Locally weighted regression function. Classifier rule. Electron to detector count conversion gain. Planck's constant. Intensity of pixel ij . Total intensity. Intensity of the red, green, and blue responses. Monochrome intensity. Colour filter array intensity. Trichroic filter prism intensity. Attenuation from colour measurement. Relative threshold coefficient. Photoelectric magnitude. Modulo operator. Spatial Sampling functions. Monochrome magnitude. Colour filter array magnitude. Trichroic filter prism magnitude. xxiv

nq () NM nPE () nDC N NC perror P (x, y ) r sD sB TOPTICS () TATM () tEXP () Traw u V ( ) Vk (xc , yc ) (xc , yc )

Photon count rate. Total number of stars observable using monochrome sensor. Total photoelectrons. Total dark current electrons. Normally distributed random variable. Number of classes. Probability of matching error. Pixelation correction function. Distance from optical axis. Star direction vector in detector frame. Star direction vector in sensor body frame. Optical transmittance. Atmospheric transmittance. Exposure time. Raw detection threshold. Least-squares parameter vector. Visible magnitude filter. Vignetting response for component image k . Centroid location on detector. xxv

(xOA , yOA ) (xij , yij ) xij   Do ij 
loss

Intersection of optical axis with detector. Location of pixel ij . Star pair representation vector. Shape parameter of the Moffat function. Pixel pitch. Primary lens diameter. Mahalanobis distance. Least-squares fitting error. Attenuation from prism. Spatial scaling parameter of Lorentz function. Wavelength. Colour ratio. Vector of colour ratios. Expected catalogue value. Quantum efficiency. Frequency. Angular offset from optical axis. Photon flux density. Angular distance between stars ij . xxvi

  ...  µij  ()   q () ij

ij ...   FOV 

Intersection angle formed by star triplet. Standard deviation where subscript denotes variable. Cross-covariance matrix. Rotation angle of centroid on detector xy -plane. Angular field of view. Spatial scaling of the Gaussian function.

xxvii

Chapter 1 Introduction
Star trackers provide a unique component in any satellite attitude determination system; specifically a high-precision, high-accuracy, full attitude estimates. In simplest terms, a star tracker takes a picture of the sky, identifies the stars in the image, and relates their observed position in the image to their true position in the inertial frame to determine the attitude of the sensor. Figure 1.1 shows a picture of a conventional star tracker. This thesis investigates expanding upon the fundamental performance of star trackers by considering the additional feature of star colour in combination with the geometric features of star patterns.

Figure 1.1: ST-16 Commercial Star Trackers 1

Chapter 1. Introduction Star trackers typically employ two primary modes of operation: acquisition and tracking. The tracking mode simply updates the attitude estimates by observing the movement of the stars from one image to the next. Therefore, assuming no cross-checking of the observed star pattern, the tracking mode can operates with fast update rate and a minimal computational burden. In contrast, the acquisition mode determines an initial attitude estimate starting from a Lost In Space (LIS) condition; specifically a state with no a priori attitude information is made available. This condition requires the star tracker to rely entirely on the information that it gathers through image observations (e.g. star pattern geometry and brightness) to determine an attitude solution. When only using pattern geometry, the fundamental limit for a unique star identification to occur is a minimum of three or more stars to be within the image or Field of View (FOV) . The reason for the limit can be illustrated by the two star scene. With only the distance between the two stars available, the ordering of the star pair cannot be determined. As a result, at minimum the correct attitude and a second diametrically opposed incorrect solution. Therefore, any scene containing fewer than three stars, without star brightness information, is unresolvable, yielding a minimum of two or more valid attitude solutions for the sensor. Star scenes containing three or more stars can also yield incorrect solutions when the observed star pattern can be matched to multiple entries within the catalogue. Star patterns that cannot reliably produce a unique attitude solution are defined as ambiguous. A variety of different methods can quantify the star patterns; most are chosen to reduce the number of ambiguous views. The more notable metrics include, groups of star pairs, oriented triangles and higher order polygons, areas of star triangles, etc. A few star patterns include the brightness of the star, or more formally the apparent photometric magnitude, to further dissociate the star patterns [Spratling & Mortari 2009] The overall performance of a star tracker is defined by several features: attitude accuracy and precision, update rate, and sky coverage. Sky coverage defines the percentage of the celestial sphere where a star tracker can determine an unambiguous attitude solution starting while in the acquisition mode. Therefore, maximizing the number of resolvable scenes and minimizing ambiguity of star patterns in them is a primary method for improving the performance of a star tracker. 2

1.1. Motivation

1.1

Motivation

As an intrinsic property, colour provides an additional, independent feature to star patterns that can potentially reduce the number of ambiguous scenes over the celestial sphere. The reduction in ambiguity results from changing the fundamental limit of three stars required by conventional or Monochrome Star Trackers (MSTs) to two for Colour Star Trackers (CSTs). The requirement for only two stars can be illustrated through an example. Given a twostar scene, where one star is blue (e.g. Rigel) and the other is red (e.g. Betelgeuse), a distinct ordering of the stars is present despite similar levels of brightness. As a result, a two star scene becomes the fundamental limit for unique star identification for CST. Furthermore, formerly ambiguous star patterns containing three or more stars can be potentially be uniquely identified with the additional colour information. While the additional information provided by colour can potentially reduce ambiguity in observed star scenes, a design cost is incurred. The colour measurement process causes a loss in the total amount of light collected by the sensor. As a result, a CST will see fewer total number of stars than an optically equivalent MST. In general, the problem of CSTs can then be summarized by the two properties · Colour information reduces the number of stars needed for an identification. · Measuring colour reduces the number of stars available. Through careful examination of these properties, one beneficial and other detrimental, a variety of potential colour star tracker designs can be proposed. Among them, the possibility exists for a subset to demonstrate improved performance (i.e. greater sky coverage and reduction of ambiguous views) over conventional, MST designs. Successful validation of this assertion will justify star colour as a viable and valuable feature for consideration in star tracker design. 3

Chapter 1. Introduction

1.2

Goals and Objectives

As a nascent technology, the study colour star tracking is open-ended incorporating the fields of noise filtering, astronomy, stellar photometry, pattern identification, data mining, computational optimization, hardware/software integration, and system design. The goals of this thesis are to answer the following sets of questions: (1) How can a star tracker be designed to measure colour? How well can colour be measured? (2) Does measuring colour increase or decrease the number of stars that can be seen? Can enough stars be seen when measuring colour to be useful? (3) Can star patterns with colour be better identified than those without? Does measuring colour allow more patterns to be correctly identified? In developing answers to these questions also provides an answer to the primary question of this thesis: does including colour into star tracker designs improve and expand the technology? Answering these questions defines a clear set of objectives. The objectives are as follows: · Characterize the colour measurement performance using available colour detector hardware technologies. Particular attention will be establishing the precision, accuracy, and reliability of the colour and position measurements. · Characterize the limiting sky coverage (i.e. three stars for MST and two stars for CST) between equivalent MST and CST technologies. This determines the upper bound on overall performance · Establish a high-level performance prediction of star identification capabilities. Together with an equivalent analysis of monochrome star scene ambiguity provides a means of defining the improvement in sensor performance resulting from colour measurement. · Assessing the first three objectives collectively allows for the determination overall benefit provided by the inclusion of colour information on star tracker design. The following subsections will expand upon the objectives to define the specific contributions and methodologies developed to achieve them. Additionally, some of the more notable implementations problems are provided. 4

1.2. Goals and Objectives

1.2.1

Contributions

Accomplishing the objectives listed above, generated several major contributions to the field of star tracker design and research. Their details are listed as follows: Colour Parameter Estimation A new set of estimation techniques were specially developed for the colour sensor hardware to determine the parameters of star image centroid, colours, and brightness. The particular implementation of the techniques depends on the hardware design. Two sensor configurations were developed: the Colour Filter Array (CFA) and multi-detector sensor. In the sensors', both the practical estimation performances and specific features are characterized. Included within this contribution is an initial calibration methodology for the sensors. Detection A comparative detection sensitivity survey establishes the relative performance improvement in fundamental sky coverage (i.e. scenes meeting the minimum star density requirements) for CST over MST designs. This also includes the formulation of a coarse lower bound on the required sensitivity of the colour filters used in the sensors. Matching Assessing the ambiguity of the colour star patterns prompted the development of a new pattern parametrization that extends monochrome star pair model to include colour. Since most other star pattern parametrizations derive from combinations and representations of star pair, evaluations using this new parametrization provides sufficient assessment of the potential ambiguity to be seen in colour star patterns. Trade Studies Achieving a fair analysis of the different sensor configurations produced a comparative means for evaluating performance. The framework considers two features: the rate of false star detections and percentage of the sky meeting minimum requirements for an attitude solution. Despite the differences in construction (e.g. single vs multiple detectors) or the number of stars required for attitude estimation (e.g. two for colour or three for monochrome), given equivalent optics and electronics, the sensors can be compared upon an equal footing. 5

Chapter 1. Introduction Framework In combination, this study presents a basic framework for assessing the potential performance of a CST. Specifically, addressing the key features of star detection, parameter estimation, and pattern matching using colour allows for the long-term development of the technology.

1.2.2

Methodology

To quantitatively characterize the performance and potential of CST necessitates an evaluation methodology. The methods of evaluation are divided into four main groups: hardware laboratory tests, hardware field tests, low level detection simulation, and highlevel pattern ambiguity simulations. These are summarized as follows: Laboratory Tests A series of laboratory tests evaluate the performance of the sensor hardware and parameter estimation techniques. The tests directly examine the quality of the estimated parameters when an artificial star (i.e. point source of light). The laboratory also allows for the calibration of the hardware prototypes to remove any systematic errors. Field Tests Field testing, as the name suggests, consists of gathering images of night sky star scenes with the prototype hardware. A sufficient number of star images are collected to effectively evaluate the estimation techniques and hardware for a variety of different star types. Although the presence of Earth's atmosphere corrupts these ground based observations, many of these features can be sufficiently modelled to provide accurate assessment of what would be seen while in orbit. Hardware Level Simulations A series of simulations evaluate different sensor configurations. The simulation numerically estimates three characteristics: the false detection rate, the probability of detecting the stars within the catalogue, and the probability of detecting a specific number of stars within the sensors FOV. Together, they establish the detection performance boundaries. High Level Simulation Observed star scenes are modelled through simulation and compared, without a priori, to a catalogue of all possible star pattern feature sets 6

1.3. Outline using a Bayesian classifier. The scenes observed and quality of the colour and centroid estimates are drawn from the hardware tests and detection sensitivity simulations. The ambiguity survey simulations are conducted over a range of optical configurations and in parallel to equivalent monochrome star tracker designs.

1.2.3

Implementation Problems

Colour Star Catalogue To properly model the expected colour intensities of stars prompted the development of a custom star catalogue. Combining both astronomical and photometric databases, the resulting custom catalogue provides both spatial coordinates of stars and the expected photon flux for a given sensor. Sensor Calibration As with any sensor, the hardware of the prototype colour star tracker will exhibit a variety of non-ideal characteristics. The signal of the image sensor is corrupted by spatial and temporal noise and offsets. Lenses cause changes in the observed position and intensity from the expected response. Using the temporally invariant property of these characteristics, a calibration model is applied to allow for the sensor to return accurate parameter estimates of the star colour and centroid. Bayesian Statistical Ambiguity A Bayesian classifier provides a method for determining the probability of an observed star pair belonging to a specific reference catalogue star pair. The pair classifier is extended to colour patterns; effectively a primitive pattern matching algorithm. Through simulations, it will be shown that for most cases the approximated classifier error is sufficient for gauging the ambiguity in an observed star pattern.

1.3

Outline

The thesis is organized in the following manner. Chapter 2 reviews the fundamental topics necessary for the development of CST; these include detailed operation of conventional star trackers, parameter estimation, geometric pattern identification, and stellar 7

Chapter 1. Introduction photometry. Chapter 3 examines the benchmarking of a CFA hardware prototype. Chapter 4 follows with the characterization of the multi-detector Trichroic Filter Prism (TFP) hardware prototype. Chapter 5 presents the development and findings of the detection sensitivity trade study for the different CST and MST configurations. Chapter 6 analyses the change in ambiguity within the expected star patterns brought about by the inclusion of star colour. Finally, Chapter 7 concludes with the significant results of the study and the best anticipated directions for future research in the new field of CSTs.

8

Chapter 2 Background and Literature Review

This chapter provides a thorough review of the necessary topics relevant for the CST technology; including the current state of star tracker technology. First, a review presents the basic principles of electronic imaging exploited by most modern star trackers and the standard hardware choices used in their manufacture. Second, all the phases of operation of a monochrome star tracker are examined, with particular attention on the techniques and features used in determining the star identity. Third, the most pertinent topics from the field spectrophotometry with regards to CST are presented.

2.1

Camera Model

This section provides background on the operational principles of optical imaging. The basic model for the design of infinite distance imaging in star trackers is established. Then, the Point Spread Function (PSF) is defined, with a review of the greatest factors that governing its characteristics. 9

Chapter 2. Background and Literature Review

2.1.1

Pinhole Camera Model

The pinhole camera model approximates the star tracker optical system. [Liebe 2002a] presents a useful description of the pinhole camera model applied to star trackers. Figure 2.1 shows this optical model for a sample star and its respective image. A star direction vector in the detector frame, sD , is defined with respect to the detector axes and Optical Axis (OA)1 . The starlight, passing through the pinhole, projects onto the detector at a particular centroid location, (xC , yC ). The centroid is distance from the OA is a function of the focal length, f , of the optics. Defining the distance on the detector away from the OA as:

r=

(xC - xOA )2 + (yC - yOA )2

(2.1)

then the angular offset of the direction vector from the OA becomes:

 = arctan

r f

(2.2)

The rotation angle of the direction vector on the xy -plane can similarly be defined as:

 = arctan

yC - yOA xC - xOA

(2.3)

Therefore, given a known star image centroid and focal length, star vector in the detector frame can be determined by the trigonometric relations:

 cos() - cos(  - ) 2   sD =  sin() - cos(  - )  2 sin(  - ) 2
1



(2.4)

The OA defines the reference frame for most optical systems, colloquially referred to as the boresight.

10

2.1. Camera Model Therefore, assuming accurate centroid estimates, the star direction vectors can be determined in the detector frame, requiring only a rotation transform to be aligned back to the inertial reference frame.

2.1.2

Point Spread Function

A PSF is the analytical transform function of a point source imaged by an optical system at an effectively infinite distance. Stars can be considered point sources of light, so the PSF then describes the shape of the star image on the detector; specifically, the observed diffraction pattern. The PSF can be fully modelled using Fourier optics; an infinite series of ordered-weighted Bessel functions. The weighting of the component Bessel functions varies the shape of the PSF from the ideal diffraction pattern; these variations are known as optical aberrations [Born & Wolf 2003]. In a star tracker, precision modelling of the PSF most often will not yield significant improvements in determining the star centroid. Instead, functional approximations (e.g. Gaussian or Moffat) can sufficiently model the PSF without the computational requirements of Fourier optics.

2.1.3

Incident Photon Flux

The pinhole camera model allows for an estimation of the total intensity of the PSF striking the image detector. Following [Holst & Lomheim 2007], the photon count for a star imaged by the star tracker optics becomes:

nq () =

 2 q () Do TOPTICS () TATM () 4

(2.5)

where q () is the photon flux density, Do is the effective diameter of the primary lens, TOPTICS () is the systems optical transmittance, and TATM () is the intervening atmospheric transmittance (see Section 2.4.4). 11

Chapter 2. Background and Literature Review

z Optical Axis (Boresight) 

sD

Focal Length (f)

y

(xc,yc)
Image Plane (Detector) (xOA,yOA)



x

Figure 2.1: Pinhole camera model for star point source at infinity.

2.1.4

Field of View

The focal length, f , of the optics combined with the detector dimensions determine the FOV. Effectively the area of the sky contained within in the image. Smaller focal lengths produce larger FOVs and can increase the number of stars detected. An important constraint on the lens design is the F-number:

F/# =

f Do

(2.6)

Smaller F-number lenses collect more photons but below 1.2 they become increasingly complex to design and manufacture. Furthermore, low F-numbers introduce increasing 12

2.2. Image Detectors amounts of optical aberrations restricting; generally detrimental to star detection and centroid estimation.

2.2

Image Detectors

Image detectors perform the vital role of transforming the incident photons striking the detector into equivalent digital signal measurements. This section highlights the model for a detector response to incident light presented by [Holst & Lomheim 2007]. Also included is a quick synopsis of the detection hardware.

2.2.1

Photon Measurement Model

The detector consists of a grid of charge collection wells which convert and store the incident photons as Photo-Electrons (PEs). For a given pixel, the PE count can be described by the expression:

nPE =
 A

fPSF (x, y ) () nq () tEXP dAd

(2.7)

where fPSF (x, y ) is the PSF, nq () is total incident photons,  () is the Quantum Efficiency (QE) of the detector, A is the active area of the pixel, tEXP is the exposure time, and  is the wavelength. The QE determines the conversion ratio of photons to PE for all wavelengths of the detector. For monochrome detectors this typically approximates the response of the human eye with peak sensitivity centred around the green wavelengths. The topic of quantum efficiency for colour sensors will be explicitly addressed in Chapter 3 and 4. The detector hardware amplifies and converts the collected PEs into equivalent digital measurement:

LSB = gLSB/e- · nPE 13

(2.8)

Chapter 2. Background and Literature Review where gLSB/e- is the electron to least-significant bit detector count conversion gain.

2.2.2

Noise Model

A variety of sources contribute to the total noise observed in electronic images. The noise model presented here can be applied equally to both Charge Coupled Device (CCD) and Active Pixel Array (APS) technologies, with variations only appearing in the specific values of the noise parameters. The sources of noise in a typical detector include Dark Current (DC) offset, shot noise, pattern noise, and quantization error. Thermal processes in the integrated circuit substrate produce electrons. Getting absorbed into the detector charge wells, they are interpreted as PEs. The collection thermalelectrons create the DC offset. DC is an additive photo-electron count, nDC , dependent on exposure time and temperature. If the star tracker uses a fixed exposure time and regulated temperature, nDC can be assumed constant. Correcting the DC current requires taking the temporal mean of a series of dark images and subtracting the mean result from and observation image. Shot noise occurs due to the quantum (i.e. discrete) nature of electrons. The statistical model for electron accumulation is the Poisson distribution. As electrons in the pixel charge well consist of both DC and PEs, the variance of the shot noise becomes:

2 2 2 SHOT = PE + DC = nPE + nDC

(2.9)

where nPE and nDC are the number of electrons generated from photon and thermal processes, respectively. Manufacturers typically group the component of the shot noise resulting from the dark current with the remaining temporal noise sources into a single parameter: Read Noise (RN). A combination of multiple statistical distributions of varying weights, RN can 2 generally be approximated to a normal distribution; the variance denoted as RN . The dominant component of the shot noise, thermally generated electrons, can be reduced 14

2.2. Image Detectors by cooling the detector; a technique employed by many star trackers and telescopes. Techniques exist for reducing the observed photon shot noise and RN of an image. These techniques generally require spatial filtering which can alter the expected position of star PSFs impacting the precision and accuracy of the star centroids. Typically, most star detection and parameter estimation techniques must contend with the read noise as a limiting characteristic. Imperfections in the manufacturing process can also cause spatial variation in the pixel response and offsets; effects known as photo-response non-uniformity and fixed pattern noise. Typically, increasing manufacturing quality and miniaturization allows more uniform construction of pixels within the detector array. The resulting spatial variation in current generation detectors is sufficiently small relative to other effects to be ignored. However, techniques are available for calibrating detectors with significant pattern noise [Healey & Kondepudy 1994].

2.2.3

Detector Technologies

Image detectors fall into two broad categories: CCD and APS. The differences between the technologies mostly concerns their physical operation and construction. They both follow the same models for photon collection and noise defined above.

Charge Coupled Devices The CCD operates using a charge collection well at each pixel. During the exposure time, PEs collect in the charge well. When the exposure completes, the charge packets are shifted from one well to the next until they are read-out by an external Analogue to Digital Converter (ADC). Since the area of the pixel only collects and stores the PEs, the active area (i.e. the region that collects light) can occupy almost the entire pixel; thereby maximizing the photon collection. This arrangement comes at the cost of needing additional circuitry. The resulting increase in the footprint of the detector combined with the greater power requirements can be problematic for star trackers. CCD sensors are a mature technology, and while minor improvements remain possible, it is unlikely that any significant improvements to their performance will occur [Holst & Lomheim 2007]. 15

Chapter 2. Background and Literature Review Active Pixel Sensors

APS combine the charge accumulation well, ADC, and data transfer bus into the structure of a single pixel. This results in the entire image sensor being constructed into a single integrated circuit; typically using the Complementary Metal Oxide Semiconductor (CMOS) construction. The benefits of combining the entire process into a single integrated circuit is a significant reduction in power requirements, minimal spatial foot print of the detector, and the ability to access particular regions of the detector without reading out the entire image, thereby saving significant processing time. The drawback of sharing the pixel space is that the active area of the pixel is limited by the space requirements of the other components [Holst & Lomheim 2007].

2.3

Star Trackers

A star tracker provides high-precision and high-accuracy attitude estimates for a satellite attitude determination and control system using stars as inertial attitude markers. Star trackers can operate in one of two scenarios: LIS or tracking. In the LIS scenario, no a priori attitude information is available. The star tracker must determine the attitude using the information gathered from sky images it collects. The LIS scenario usually occurs at on-orbit initialization of the star tracker. The tracking mode, in contrast, uses previous attitude estimates to update the current estimate. This tends to reduce the complexity and computational requirements of the tracking scenario.

Starting from a LIS scenario, the process of acquiring the attitude follows a relatively straight forward process. Figure 2.2 shows a block diagram of the attitude determination process. The process divides into five phases: image acquisition, image filtering, star identification, attitude estimation, and attitude filtering [Spratling & Mortari 2009]. These phases are examined in detail below. 16

2.3. Star Trackers

Tracking Mode Image Acquisition Raw Image Image Filtering Body Vectors Star ID Inertial Vectors Attitude Estimation Attitude Filtering

Attitude Parameters

Figure 2.2: Functional flow diagram of star tracker processing chain [Spratling & Mortari 2009].

2.3.1

Image Acquisition

The image acquisition phase depends entirely on the hardware and determines the physical constraints on the performance. The optics determine the amount of photons collected from a star source. The detector converts the photons into PEs but corrupts the image with noise. The addition of a baffle around the lens prevents light from non-stellar sources (e.g. Sun, Moon, or Earth) from corrupting the image.

The primary lens diameter and exposure time determine the number of photons from a star that reach the detector according to equation 2.5. The detector converts a portion of these photons into PEs but adds shot and read noise in the process. Longer exposure times allow for additional photon collection but also tend to increase the image noise.

The logarithm of the total number of stars in the sky above a particular intensity varies logarithmically to the intensity[Carroll & Ostlie 1996].

Therefore, the majority of stars observed within a star tracker image are dim and near the noise floor. Therefore, the ratio of the PEs to the image detector noise defines a fundamental limit of the minimum observable magnitude. 17

Chapter 2. Background and Literature Review

2.3.2

Image Filtering

The image filtering phase transforms the information contained within the raw image into a set of body referenced star direction vectors. This phase follows three distinct steps: star detection and direction vector estimation.

Star Detection

Detection of stars within an image requires isolating the cluster of star PEs from the surrounding image noise. The simplest detection techniques apply a fixed threshold to each pixel generating a candidate list of potential pixels containing stars. Adjacent candidate pixels are grouped together into single clusters to form a candidate star detection. Incorrectly detecting image noise as a star is known as a false detection. False detections degrade star tracker performance as the additional false star can cause the observed star pattern to be misidentified, yielding an incorrect attitude solution. The detection algorithm must be tuned to maximize the number of true star detections while minimizing the false detection. This involves evaluating multiple detection thresholds and limiting the minimum number of pixels within a candidate star cluster.

Centroid Estimation

After detecting candidate stars from the image, precise centroids and magnitude estimates need to be determined from the observed pixel intensity pattern. Two methods exist to determine the star parameters: first moment and curve-fitting. First moment estimation determines the centroid by spatially weighting the pixel intensities and normalizing by the total intensity:

xc =

i

j

xij Iij

I0 18

(2.10)

2.3. Star Trackers

yc =

i

j

yij Iij

I0

(2.11)

where Iij is the pixel intensity, xij and yij are the positions of the pixels [Liebe 2002b, Zhai & Nemati 2011] and the total integrated intensity:

I0 =
i j

Iij

(2.12)

First moment estimations takes advantage of numerical efficiency, requiring only summations of the observed pixel intensities. Unfortunately, the technique tends to break down as the signal level approaches the noise floor, causing large variations in the estimated parameters. To overcome this deficiency, the centroid and intensity can instead be estimated by fitting an approximation of the PSF model to the observed pixel intensity pattern. By far the most common approximation is the weighted Gaussian function,

Iij =

I0 (xij - xc )2 + (yij - yc )2 exp - 2 2 2 2

(2.13)

where  defines the spatial scale of the PSF. The Gaussian function requires minimal tuning and comes with a long history of successful application in the astronomical field. The Moffat function approximation, also drawn from the field of astronomy, shares a similar profile to the Gaussian but includes a set of flares at the extremities. Specifically, the Moffat function:
-

I0 ( - 1) Iij = 2

(xij - xc )2 + (yij - yc )2 1+ 2

(2.14)

where  define the spatial scale and  determines the size of the flares, which account for the fringes observed in a true PSF[Bendinelli et al. 1988]. 19

Chapter 2. Background and Literature Review [Quine & Hornsey 2007] suggest using the error function to account for the spatial integration of the incident photons over the active area of the pixel. [Rufino & Accardo 2003] propose a PSF model derived from numerically evaluating an approximation of the optical transfer function; this method produces a "pill-box" shape to better account for the features produced from defocus. Finally, the PSF can be explicitly modelled using the diffraction integrals. However, the computational requirements would constrain its use only for purpose of off-line calibration [Zhai & Nemati 2011]. The fitting uses a non-linear least squares (NLSQ) minimization between the modelled and true pixel values. Any efficient NLSQ minimization algorithm can be applied (e.g. Levenberg-Marquardt). Curve fitting consistently produces estimates of centroid and intensity with less variance; while error in the mean depends upon the quality of the PSF approximation to the true PSF. The superior estimates thereby offset the additional computational costs. To reduce the time, the curve-fitting can be initialized with the first moment estimates. After determining the centroids, they can easily be converted to their equivalent body vector representations using (2.4).

2.3.3

Star Identification

The star identification phase assigns labels to the stars detected during the image filtering phase. Figure 2.3 shows a block diagram of the identification process. First, body referenced star vectors combine to form feature sets for each star pair or star group. Second, a search of an on-board database finds groups of similar feature sets generating a list of candidate star labels (i.e. possible matches). Third, the "most likely" candidate feature set to the scene is returned as the scene. In the event of finding no matches or multiple equally likely matches, the error check can also decide that no sufficient solution exists rather than returning an incorrect identification. An optional fourth step can label additional stars vectors not included in the original database search. As the phase with the highest computational burden and risk associated with errors (i.e. incorrect pattern match), star identification receives significant research and design attention. The geometry of the star pattern presents a variety of features that can be used in the identification process. By choosing to identify the stars using a particular 20

Image

Vectors

Vectors

Parameters

2.3. Star Trackers

Image Acquisition Body Vectors "Features" or "Parameters"

Image Filtering Possible Matches

Star ID

Attitude Estimation Inertial Vectors

Figure 2.3: Star identification process flow diagram feature set can reduce the ambiguity within the database, decreasing the likelihood of an incorrect pattern match. Furthermore, certain feature patterns combine with efficient search and data management techniques to reduce the computational requirements of the algorithm. In all cases the identification relies on the geometric features of the star pattern; several techniques also include the visible magnitude into the identifying parameter set2 . The following paragraphs review the major identifying feature sets and search techniques used in star trackers or proposed in the literature. Additional reviews of most star identification and pattern matching algorithms can also be found in [Spratling & Mortari 2009, Silani & Lovera 2006, Na & Jia 2006, Padgett & Udomkesmalee 1997].

Pair and Polygon Matching

The first group of identification algorithms derive their feature sets from spherical geometry of the star vectors. Figure 2.4 shows a diagram of the basic spherical geometry properties for a typical 3 star pattern. Angular distance between two stars is defined as:

cos ij = sT B,i sB,j

(2.15)

where sB is a unit star direction vector in the body frame. In the case of a star triplet (i.e. triangle), the angular distance can be referred to as a side length. The intersection
2

Visible magnitude is a normalized logarithmic representation of star irradiance

21

Chapter 2. Background and Literature Review angle formed at the corner of a star triplet can be defined using the spherical cosine law: cos ij - cos ik cos jk sin ik sin jk

cos ij =

(2.16)

In the feature set, many algorithms express the angular distances and intersection angles as the cosine values instead of the actual angle to reduce numerical errors introduced by the inversion of trigonometric functions. All other geometric features can be derived from a combination of these two features. [van Boozijen 1989] proposed the simplest pattern matching techniques choosing the angular distance and magnitudes of the brightest star pairs (e.g. guide stars) as the identifying feature set. An additional error check of the algorithms compares one intersection angle from each star triplet in the group of guide stars. [Groth 1986] considered the side lengths and intersection angles of a star triplet, the first implementation of the side-angle-side (SAS) feature set. [Liebe 1993] expanded the SAS identification by discretizing the three angular values significantly reducing computation time. [Ketchum & Tolson 1995] divide the pattern database into regional sub-groups with centres defined by the brightest star in the group. [Scholl 1995] considers a method using six features of a star triplet, three side lengths (SSS) and visible magnitudes. [Quine & DurrantWhyte 1996] define the feature as a combination of side lengths, symmetry measures, and visible magnitudes. [Mortari & Neta 2000] derive a new approach for catalogue searching using the k-vector technique. [Daniele Mortari & Junkins 2004] extend the SSS triangle technique considering a four star pyramid combination. As alternatives to side-length and intersection angle combinations, [Cole & Crassidis 2004, Cole & Crassidis 2006] use the area and second moment of the triangle formed by a particular star triplet. [Samaan & Mortari 2006] propose a spatially non-dimensional star pattern match independent of the lens focal length.

Grid Matching The grid matching algorithm represents a departure from the framework of the pair/polygon algorithm. Figure 2.5 shows a simplified diagram of the grid algorithm. Consider the 22

2.3. Star Trackers

sB,i

z

ij

sB,k
ik jk x y
Figure 2.4: The geometry of the polygon star pattern matching algorithms. reference stars (i.e. brightest stars) within equally spaced intervals around the celestial sphere. Using two reference stars, one as the origin and other as an alignment vector, a g × g grid is over-layed onto the star pattern. Any grid element containing a star then gets a value of one. Unwrapping the grid into a g 2 length vector creates a binary identifier for each reference star. Applying the grid to the brightest stars in an image form an identifier to be matched to the catalogue, identifying the stars. Computationally faster and less sensitive to noise, the grid algorithm requires significantly more stars in the FOV than the polygon algorithm. The choice of using the grid algorithm thus depends heavily on the hardware performance. [Padgett & Udomkesmalee 1997, Padgett & Kreutz-Delgado 1997] proposed the first instance of the grid algorithm, as described above. [Clouse & Langenbacher 1997, Clouse & Padgett 2000] modify the grid algorithm to use Bayesian theory to establish a decision threshold for choosing the star identity. [Lee & Bang 2007] propose replacing the square 23

sB,j

Chapter 2. Background and Literature Review

(a) Selection of guide star.

(b) Centering of frame.

(c) Grid alignment.

(d) Binary conversion.

Figure 2.5: Simplified model of the grid algorithm.

24

2.3. Star Trackers grid with a polar grid.

Adaptive Algorithms

A small portion of proposed star identification algorithms can be categorized as trained or adaptive algorithms. Rather than a fixed search algorithm, the identification process adapts through simulation and training datasets. The result is generally a shorter time in identifying the star pattern, but at a cost of increased memory requirements and uncertainty regarding the impact of ambiguous star patterns. [Lindsey et al. 1997] presents the first instance of using a neural network for identifying an observed star pattern. The side lengths between a guide star and its neighbours were used to train the neural network. [Paladugu et al. 2006] propose using a Genetic Algorithm (GA) for conducting the catalogue search. The star feature set consists of a reference star at the centre and the polar positions of the surrounding stars. [Zhang et al. 2008] consider the application of Fuzzy-logic and Bayesian decision theory in the catalogue search to reduce exponential computational burden introduced by increasing numbers of observed stars. [Quan & Fang 2010] propose using an adaptive ant colony (AAC) algorithm to generate a shortest path among a star group. This composite length vector then acts as the identifier for the central star.

Other Algorithms

Several other specialized algorithms exist beyond those noted above; including the use of graph-theory [Chen et al. 2000, Chen & Hao 2000], Knuth-Morris-Praa (KMP) algorithm [Li et al. 2004b, Li et al. 2004a], and bit-matching algorithm [Li et al. 2005]. In one novel study, [Juang et al. 2003] develop an approach using a singular value decomposition (SVD), combining the identification and attitude estimation. While many of these algorithms present interesting treatments of the identification problem, they still only use a combination of geometric and visible magnitude features. 25

Chapter 2. Background and Literature Review

2.3.4

Attitude Estimation and Filtering

The attitude estimation step determines the transformation between the observed star position vectors in the sensor frame to their positions in the Earth Centred Inertial (ECI) frame; either as a direction cosine matrix or quaternion representation. The most common formulations attempt to find a transformation to solve the Wahba problem; a least squares minimization of the vectors represented in both frames [Wahba 1965]. One of the earliest technique for solving the Wahba problem is Davenport's q-method [Davenport 1968]. Although no longer used in practice, several other techniques including QUaternion ESTimator (QUEST), EStimators of the Optimal Quaternion (ESOQ-1 and ESOQ-2) are developed directly from the q-method [Markley & Mortari 2000]. Attitude filtering processes attitude estimates, either smoothing and deriving velocity estimates. As the introduction of colour information does not impact the determination of the attitude transformation or attitude filtering phases, these approaches will not be explicitly developed or analysed in this study.

2.4

Spectrophotometry

Spectrophotometry is the measurement of the wavelength dependent flux emission of different stellar bodies (e.g. stars). This section considers the most relevant topics of spectrophotometry needed for colour star tracker design. These topics include the definitions and measurement scales of spectral flux and magnitude; star spectra classification; star and spectral flux catalogues; and, Earth's atmospheric attenuation.

2.4.1

Spectral Flux and Magnitude

A star behaves as a point source defined by the irradiant spectral flux density, F ( ), where  is the photon frequency. The spectral flux density describes the amount of 26

2.4. Spectrophotometry energy per second, per unit frequency striking a unit area of the star tracker. The unit frequency can be converted to unit wavelength as:

F () = F ( )

c 2

(2.17)

where  is the wavelength and c is the speed of light. Planck's law can act as a basic approximation for the spectral flux density, but fails to include the non-ideal features of the star spectra[Carroll & Ostlie 1996]. These features include atomic emission lines, attenuation due to interstellar material, Balmer discontinuity, and chemical impurities in the star. Instead of approximating the spectral flux density, it makes more sense to use empirical datasets (e.g. spectral catalogues). Spectral flux density, observed from Earth, varies significantly making comparisons between stars difficult. The visual magnitude system resolves the difficulty using a logarithm of spectral flux density ratios as observed over through visual bandpass filter:

mV = -2.5 log10

V ( ) F ( ) d V ( ) F0 ( ) d

(2.18)

where F0 ( ) is the reference spectral flux density and V ( ) is the visible magnitude filter [Carroll & Ostlie 1996]. The original reference star for the visual magnitude system was  Lyr (Vega). However, this value has since been superseded by a theoretical source that defines a spectral flux density for star of mV = 0 in the centre of the visual filter band as F0 ( ) = 3.64 × 10-23 J · s-1 · m-2 · Hz-1 [Bessell 1979]. For electronic sensors, it can often be more advantageous to express the magnitude as the ratio of photon flux instead of spectral flux density. Given the photon energy of Eph ( ) = h , the photon flux density becomes:

q =

F ( ) Eph ( ) 27

 () d

(2.19)

Chapter 2. Background and Literature Review

q =

F ( ) Eph ( )

 () d

(2.20)

The resulting photoelectric magnitude becomes:

mq = -2.5 log10

q q,0

(2.21)

where q,0 is the photon flux for the same reference star used for the visual magnitude system [Roy & Clarke 2003].

2.4.2

Star Classification Systems

While not typically relevant for MST, star classification methods provide a useful means of aggregating data for the analysis. The Morgan-Keenan-Kellman (MKK) system is the primary method of broadly classifying stars according to their spectral and physical properties [Morgan & Keenan 1973]. The MKK system divides the classification based on two physical parameters: temperature and luminosity. The temperature classification scale divides the stars into seven primary groups (e.g. O, B, A, F, G, K, and M), each with approximately ten numerical subgroups. Luminosity types consider five primary groups, expressed as Roman numerals (e.g. I, II, III, IV, and V) and define star size ranging from super-giant to normal. Figure 2.6 shows the relative distribution of stars in the MKK classification system to a magnitude of mV = 6.0. From direct observation, the largest star groups centre around the AV, green main-sequence star, and KIII, red giant-sequence star. The remainder of the stars are grouped randomly among the other classes. This relatively even distribution of star classes, and by extension star colour, suggests that colour will be a useful property in identification. 28

2.4. Spectrophotometry

Figure 2.6: Contribution of spectral classes and luminosity types derived from Sky2000 stellar catalogue (approximately 6 × 103 stars).

2.4.3

Astronomical Catalogues

CST requires both spatial and spectral information to identify stars. A wide variety of astronomical catalogues can provide the spatial position and visible magnitude of the stars on the celestial sphere. The Sky 2000 (Sky2K) is a useful example of such catalogues, with nearly complete star entries of mV < 6.0 and containing star entries up to mV  10. Besides the star position, the catalogue also contains the MKK classification; although, many of the higher magnitude entries are incomplete or missing. Since most star trackers would operate with star magnitudes of mV < 6.0, the missing entries are usually not a 29

Chapter 2. Background and Literature Review problem. A second group of specialized catalogues provide reference stellar spectra for the various star classes, subclasses and luminosity types. A prominent example is the Pickles Atlas, a combination of multiple earlier catalogues [Pickles 1998]. The Pickles Atlas contains a total of 131 spectral entries evenly sampled across multiple star classes. Although only providing a reference subset of stellar spectra, many of the intermediate response can be approximated.

2.4.4

Atmospheric Attenuation

Although not a concern on orbit, Earth's atmosphere imparts three effects onto ground based observations: refraction, diffraction, and attenuation. The effect of atmospheric refraction, as shift of the position, becomes negligible for observations taken near zenith. Atmospheric diffraction causes the PSF to be spread out and vary with air movement, an effect known as scintillation3 . For simple optical systems, only by observing from high altitudes (i.e. less atmosphere) can diffraction be minimized. The Earth's atmosphere contains a variety of chemical and particulate substances causing attenuation or scattering of photons of certain wavelengths. [Bird & Riordan 1986] present a empirical model for the transmittance of the atmosphere on incident solar flux density, and by extension star flux density:

T (, ) = Tr (, ) Ta (, ) Tw (, ) To (, ) Tu (, )

(2.22)

where as the elevation angle and considers the effects of molecular (Rayleigh) scattering Tr , aerosol attenuation Ta , water vapour absorption Tw , ozone absorption To , and uniformly mixed gas absorption (oxygen, carbon dioxide, methane, nitrous oxide) Tu . Figure 2.7 shows a sample attenuation response for a view at zenith, Z = 0, and a total precipitable water of 1.5 mm at standard temperature-pressure.
3

Scintillation is the "twinkling" effect of stars observed from the eye.

30

2.5. Conclusion
100

90

80

70

Transmittance [%]

60

50

40

30

20

10

Rayleigh Aerosol Ozone Water Vapor Uniform Gas Total 0.4 0.5 0.6 0.7 0.8 Wavelength [µm] 0.9 1 1.1 1.2

0 0.3

Figure 2.7: Atmospheric transmittance response for incident star light.

2.5

Conclusion

From this literature review the design and development of CST can proceed. It should be noted that some more general topics used in this thesis, such as Bayesian statistics and least squares minimization, were not explicitly reviewed here. Of particular significance was the complete absence of the possibility of using spectral information in the star tracker process within the literature review, despite spectral photometry having a mature development in the field of astronomy. Therefore, to the authors best knowledge, the topic of CST is a novel field of research. 31

Chapter 3 Colour Filter Array Star Tracker

To begin the investigation into CSTs, consider the CFA detector. A CFA shares many physical design characteristics in common with conventional monochromatic image detectors. The CFA measures colour by applying a mosaic of different filters to the pixels of the detector, generating simultaneous sub-sampled colour images of the observed scene. Due to nearly identical physical construction, many of the techniques developed for MSTs can be easily adapted to a CFA. This chapter investigates characterizing the hardware of a CFA detector for potential use as a CST; specifically, the process of estimating the critical parameters of colour and star centroid positions. The sections of this chapter can be summarized as follows. Section 2 provides an overview of the physical construction and design of a CFA detector. Section 3 extends methods for estimating the star parameters (i.e. centroid, intensity) developed for MST to include colour response from a CFA detector. Section 4 considers a three part calibration of the CFA hardware to address the geometric distortion, constraint of the PSF shape, and effects introduced by the CFA at the pixel level. Section 5 reviews the results of the calibration and validation using laboratory facility. Section 6 presents the performance of the CFA hardware using actual night-time sky observations. Section 7 concludes with some specific remarks on the CFA as a potential detector for colour star trackers and possible directions for further development of the hardware. 33

Chapter 3. Colour Filter Array Star Tracker

3.1

Principles of Operation

As mentioned above, the CFA detector has a filter applied to each pixel to isolate a particular portion of the visible spectrum. Figure 3.1 shows a sample set of filter response curves for a commercially available CFA detector. The spectral region allowing the transmission of light is known as the filter pass-band. Arranging the filters of different colours into a repeating mosaic pattern allows sub-sampled images of different colours to be simultaneously taken of a same scene. CFA detectors only tend to differ from their monochrome counterparts by the addition of the filters. A variety of CFA mosaic patterns have been proposed [Lukac & Plataniotis 2005]. Figure 3.2 and 3.3 shows examples of two star PSFs imaged using the most common CFA mosaic arrangement: the Bayer pattern. Consisting of two green pixels on the diagonal with a red and blue pixel completing the two-by-two cell, the green pixels occur twice as frequently to approximate the natural sensitivity of the human eye [Holst & Lomheim 2007]. Two technologies exist for filtering the pixels of the CFA detector. The majority of detectors use layers of transmissive dyes. Choice and combination of dyes determines the portion of the spectrum observed [Lukac & Plataniotis 2005]. A new technology, developed by Ocean Optics, applies an interference filter coating producing sharp transitions at the pass-band edges with low signal loss in the pass-band. Interference filters for CFA represent a prime candidate for CST for long term development. For common availability, a Bayer patterned CFA detector is chosen as the hardware prototype. The specific sensor selected is the Aptina MT9P031-C[apt ]. Selection of this model coincides with the development of the ST-16 star tracker; the ST-16 uses the monochromatic counterpart of the sensor (i.e. MT9P031M). Figure 3.4 shows the prototype hardware for the MT9P031-C developed by Aptina. The filter responses of the detectors using dyes often suffer from a non-negligible loss of light in the pass bands. This effect can be seen in the colour pass bands responses of the MT9P031-C shown in Figure 3.1. The signal loss may prevent the CFA detector from being a viable long-term choice for CSTs. Despite this issue, most of properties and characteristics observed with this detector would likely appear using the alternative 34

3.2. Star Parameter Estimation

Figure 3.1: Filter Response Profiles of the MT9P031-M and -C Detectors. interference filters. Therefore, the MT9P031-C is a suitable prototype to demonstrate concepts of star parameters estimation, but may not be sensitive enough for a deployed system.

3.2

Star Parameter Estimation

After isolating the stars from the noise of the image, precise estimates of the position, colour, and magnitude of these stars can be determined. Each pixel filters one of three colours resulting in three sub-sampled component images. The star image response is 35

Chapter 3. Colour Filter Array Star Tracker

4000 3500 3000 Detector Count 2500 2000 1500 1000 500 8 0 8 6 7 6 5 5 4 4 3 3 2 2 1 1 y-pixel 7

x-pixel

Figure 3.2: Hot (blue) star mosaic image response.

modelled as three overlaid PSF functions whose intensities represent the relative contribution of the incident photons for colour. Figure 3.2 shows a sample of two CFA colour star images of two, spectrally different (i.e. red and blue) stars. It can noted from direct inspection that the hot star has a significantly values for the blue and green pixels, while the cold star is dominated by red and green.

To determine the parameters of the observed star images, we modify and extend existing estimation techniques developed for monochrome star trackers. Parameter estimation techniques can be grouped into two categories: arithmetic and curve-fitting. The following subsections examine these techniques. 36

3.2. Star Parameter Estimation

4000 3500 3000 Detector Count 2500 2000 1500 1000 500 8 0 8 6 7 6 5 5 4 4 3 3 2 2 1 1 y-pixel 7

x-pixel

Figure 3.3: Cold (red) star mosaic image response.

3.2.1

Arithmetic Estimation

The arithmetic estimation of the centroid of the star image is determined by the spatial first order moment of the pixels. Despite the mosaicked form of the image, the centroid estimation technique developed for the MST sensors can be applied directly to the CFA images. Specifically, the numerical mean using a summation of the intensity weighted pixel locations over a region of interest:

xc =

i i

j

xij Iij j Iij

(3.1)

37

Chapter 3. Colour Filter Array Star Tracker

Figure 3.4: Development hardware of the MT9P031

yc =

i i

j

yij Iij j Iij

(3.2)

where Iij is the pixel value, and (xij , yij ) is the pixel coordinate.

In a monochrome image, the star intensity can be estimated by summing the pixels intensities over the region containing the star; effectively integrating the photons contained in the PSF. A CFA image sub-samples the PSF according to the layout of the filter mosaic. Recognizing the percentage of the true PSF each sub-sampled image observed allows for a weighting of the summed response to produce the estimates of the component colour 38

3.2. Star Parameter Estimation intensities. For a Bayer patterned CFA, the colour intensity estimates become:

Ir = 4 Ig = 2 Ib = 4

i i i

Iij,r j Iij,g j Iij,b
j

(3.3)

where the weighting coefficients result from green pixels occupying half the detector while red and blue are only a quarter. The arithmetic estimation techniques are computationally simple. They also do not take into account the non-ideal effects of the PSF produced by the optics; specifically, the proper shape of the PSF. If the centroid occurs on a pixel of a particular filter colour, the remaining colour estimates can potentially be undervalued. Similar to the arithmetic monochrome estimators, these techniques suffer from amplifying noise due to the multiplication of large pixel coordinates. The estimates determined using the arithmetic methods, rather than being used explicitly in the pattern identification process, can instead serve as initial estimates for the more precise, curve-fitting estimation techniques.

3.2.2

Curve-Fitting PSF Models

To achieve improved precision of centroid and colour intensity estimates, a model the PSF can be fitted to the observed pixel response. Before considering the specific properties of fitting to the CFA mosaic, consider the model of the PSF. Several models have been proposed to approximate the PSF of a star tracker. In an initial study, [McVittie & Enright 2012] proposed a generalized PSF model. Based on the bivariate Gaussian function, the model

fGAUSS =

1 2x y 1 - 2

exp -

(x - xc )2 2 (x - xc ) (y - yc ) (y - yc )2 - + 2 2 x x y 2y 39

(3.4)

Chapter 3. Colour Filter Array Star Tracker where x and y are the scaling parameters in the horizontal and vertical directions, respectively, and  is the rotation parameter of the PSF. The generalized nature of the model can be primarily attributed to the quality of the lens; which suffered from a strong astigmatic aberration. As a result, the PSF would tend to form an ellipse aligned with the radial vector emanating away from the OA; hence, the two scaling and rotation parameters. While using this model some promising initial results were found. However, the large number of parameters describing the PSF caused estimation to be poorly-conditioned resulting in large variations of the estimates. To improve upon these results, a reduction in the number of parameters is necessary. Improving the quality of the optics (i.e. replacing the lens) eliminates the astigmatism, removing the need for rotation and multiple scaling parameters. Instead of (3.4), three standard symmetric models are considered; specifically, the Gaussian, Lorentzian, and Moffat functions. The symmetric Gaussian function is expressed as:

fGAUSS (x, y, xc , yc ,  ) =

(x - xc )2 + (y - yc )2 1 exp - 2 2 2 2

(3.5)

where  defines the spatial scaling. Similarly, the Lorentz function is given by the expression:

fLORENTZ (x, y, xc , yc ,  ) =

 (x - xc )2 + (y - yc )2 +  2 2

3 -2

(3.6)

where  determines both the shape and scale of the PSF. Finally, generalizing the Lorentz to the Moffat function produces the expression:

( - 1) fMOFFAT (x, y, xc , yc , ,  ) = 2 40

(x - xc )2 + (y - yc )2 1+ 2

-

(3.7)

3.2. Star Parameter Estimation where  defines the spatial scaling and  determines the shape of the PSF. Figure 3.5 shows a cross-section of the three model responses. The choice of approximation depends upon the specific shape of the PSF observed on the detector. For example, the Moffat and Lorentz models both provide large flares around the base of the PSF to better approximate the true diffraction model of the optics. The Gaussian and Lorentz models require only a single parameter to define their shape and scale; which can aid numerical conditioning during fitting. To account for the mosaic of the CFA detector, consider the observed response as a spatial sub-sampling of three stacked PSFs; one for each colour pass-band. Assuming a Bayer patterned CFA, a mosaic sampling function for the red pixels can be defined as:

Mr =

1 for red pixels 0 otherwise

(3.8)

Similar expressions can be derived for the green and blue pixels. Combining (3.8) with (3.5), (3.6), or (3.7) and multiplying by an intensity for each colour provides the functional model of the image response:

I (x, y ) = Ir · Mr · f (x, y, xc , yc , · · · ) + Ig · Mg · f (x, y, xc , yc , · · · ) + Ib · Mb · f (x, y, xc , yc , · · · )

(3.9)

where the scaling parameters (, , ,  ) of the PSF are defined independently for each colour. To achieve improved the performance using iterative numerical optimizers, (3.9) can be rewritten as ratios of colours with an absolute intensity:

I (x, y ) = I0 [rg · Mr (x, y ) · f (x, y, xc , yc , · · · ) + Mg (x, y ) · f (x, y, xc , yc , · · · ) + bg · Mb (x, y ) · f (x, y, xc , yc , · · · )] 41

(3.10)

Chapter 3. Colour Filter Array Star Tracker
1 Gaussian Moffat Lorentzian

0.9

0.8

0.7 Normalized response

0.6

0.5

0.4

0.3

0.2

0.1

0 -5

-4

-3

-2

-1

0 Pixel position

1

2

3

4

5

Figure 3.5: Comparison of PSF Model Shapes where f (...) is the PSF model chosen, rg = Ir /Ig , bg = Ib /Ig , and I0 now represents the absolute green intensity. While the green response does not precisely match the visible magnitude, it can provide coarse estimate with which to check the performance. Assuming a Gaussian function representation of the PSF, the model for the image response is defined by eight parameters (xc , yc , I0 , rg , bg , r , g , b ); similar parameter sets can be derived for Moffat and Lorentz PSF models. The optics of the sensor determine PSF shape parameters. To simplify the estimation process, the shape parameters can be determined off-line through a calibration and held constant for the estimation. Therefore, all models can be defined by five parameters: centroid and component intensities. 42

3.3. Calibration

3.2.3

Curve-Fitting Estimation

To actually determine the model parameters, requires application of a minimum least squares optimization. The cost function is defined as:
m n

 (u) =
i j

(I (xij , yij , u) - Iij )2

(3.11)

where u = [xc , yc , I0 , RG , BG ] is the parameter vector to be fit. Mapping 3.11 to a single vector representation:
mn

 (u) =
i

(I (xi , yi , u) - Ii )2

(3.12)

allows standard least squares optimizers to be applied to determine the parameters of u. Many least squares optimization algorithms are available, for this study the heuristic, Levenberg-Marquadt (LM) solver was chosen [Levenberg 1944]. While not guaranteed to yield a solution, the computational efficiency and practical reliability of the LM is sufficient for the online estimation of the star parameters.

3.3

Calibration

Most sensors require some calibration and correction of the observed results to account for non-ideal characteristics and variances in the manufacturing process of the components. The two major components of the star tracker in the observation process is the optical lens and image detector. Calibration of the detector for features such dark offset or fixed pattern noise does not differ from monochrome detectors and need not be explicitly developed1
[Healey & Kondepudy 1994] present an efficient method for calibration of a image sensor that has been considered for the monochrome ST-16 star tracker.
1

43

Chapter 3. Colour Filter Array Star Tracker Practical star tracker optics impose three non-ideal, generally non-linear, variations on the observed star images: position, PSF shape, and intensity. The shift in the observed position of the star from the true direction vector is known as distortion. Changes in the PSF shape result from a variation in the focus over the image plane. Variation of intensity, generally decreasing towards the boundary of the detector is known as vignetting. To correct these non-ideal characteristics to produce accurate estimated, we present three calibration procedures aimed at removing systematic errors and to constrain the parameter estimation.

3.3.1

Geometric

Correct identification of stars and attitude estimation of the sensor requires accurate estimates of the observed star direction vectors. These factors necessitate development of a model of the sensor with accounting for focal length of the lens, intersection of the optical axis with the detector, transformation to the star tracker chassis, and distortion (i.e. centroid shifts). Appendix A presents the geometric calibration model, originally developed for the ST-16 star tracker, it is applied directly to the prototype CFA hardware. Determination of the geometric model parameters follows a relatively simple procedure. By imaging a point light source at a known direction relative to the star tracker chassis allows a mapping to observed detector vector. Surveying a large set of point positions with equivalent sensor attitude vectors allows the parameters of the model can be determined using a non-linear least squares minimization.

3.3.2

PSF Scale and Shape

The estimation of colour attempts to extract five parameters (i.e. xc , yc , rg , bg , and I0 ) from a limited number of useful pixels composing the PSF response. If the parameters defining the shape and scale of the PSF (i.e.,  , ,  , and  ) are included in the on-line estimation the high number of parameters can cause variability in the convergence of the estimates [McVittie & Enright 2012]. The scale and shape parameters of the PSF are 44

3.3. Calibration dependent on the optics and remain effectively constant over local regions. As a result, these parameters can be estimated off-line. The on-line estimation uses either a constant value or a lookup table for the region where the PSF is located. Currently, the analysis is restricted 500 pixel diameter area around the OA. In this region, the scale and shape parameters are assumed constant. Their estimation is achieved by fitting the PSF model to a subset of the pinhole survey. While each PSF uses a distinct centroid and set of intensities, the shape and scale parameters are common for all pinhole images.

3.3.3

Local Pixel Variation

A unique feature of the CFA is a local variation in the observed PSF intensities resulting from the sub-sampling of the colour images. Specifically, the estimated intensity peaks when centroid is located on a pixel of the same colour. The variation can be influenced by many factors, including the choice of PSF model, presence of micro-lenses on the pixels, and dimensions of the active-pixel area. As a function of the mosaic, the variation of intensity within a region is periodic over the area of the Bayer pattern of the CFA. Again, consider the restricted area around the OA. Using another subset of the pinhole survey, a heuristic model of the variation is derived using a two-dimensional locallyweighted regression of the observed colour ratios at the modulo-2 of the centroid positions[Cleveland 1981]. The model is then normalized to the mean colour ratio of all samples. Specifically,

P (x, y ) =

fLW R (xmod2, y mod2) ¯ f LW R

(3.13)

where fLW R is the locally weighted regression function and mod is the modulo operator. The on-line estimates are corrected by dividing the colour ratios by P (x, y ). 45

Chapter 3. Colour Filter Array Star Tracker

3.4

Laboratory Testing and Validation

This section examines the laboratory testing and validation of the CFA-CST hardware prototype. First, the laboratory facility and performance characteristics used in testing the prototype CFA hardware is described. Second, a review of the calibration resulted is presented. Third, the performance of the hardware and parameter estimation techniques are thoroughly examined to characterize for the expected performance in the field.

3.4.1

Laboratory Facility

The laboratory calibration and testing facility must allow for precise, accurate, and repeatable measurements. The SAIL facility was designed with the specific intention for the calibration, testing, and validation of sun sensors (e.g. SS-411) and monochrome star trackers (e.g. ST-16). The SAIL facility also serves to prototype and evaluate new sensor technologies, such as the colour star tracker. The SAIL laboratory consists of a high-precision three-axis gimbaled platform and an artificial star light source. Figure 3.6 shows a picture of the laboratory facility. Mounting the star tracker hardware module to the gimbaled platform allows the sensor to be pointed in any direction and the star image to be accurately positioned anywhere on the image plane. The artificial star source is created by inverting a telescope with a fiber-optic fed pinhole at the normal image plane location. Using a 400mm focal length and 50µm pinhole aperture approximates the angular dimensions of a star (e.g. Betelgeuse) as would be observed in the field. To remove external vibrations on the optical assembly, both the gimbal and telescope are mounted to an air cushioned, inertially isolated table. Containing entire assembly in a sealed dark room eliminates external light sources.

3.4.2

Calibration Results

From the calibration model described in Section 3.3 when combined with the model of laboratory facility allow for determination of correction factors for the prototype hard46

3.4. Laboratory Testing and Validation

x

End Effector

y

z

3-Axis Gimbal

rlL Inverted Telescope

Figure 3.6: Star tracker testing facility

47

Chapter 3. Colour Filter Array Star Tracker ware. The following subsections describe the specific results obtained from the MT9P031 hardware module.

Colour Correction

As shown in Figure 3.7, a strong spatial influence exists for the observed colour response. The peak intensity of the red-green ratio, located at modulo-2 pixel coordinates(1.1, 0.9), coincides almost directly with the location of the centre of the red pixel. The slight offset in position can most likely be attributed to the non-photosensitive region of the CMOS pixel.

Correcting to the raw colour ratio estimates of the validation subset of the pinhole survey results in significant improvement of the statistical behaviour of the measurement. Figure 3.8 shows the statistical behaviour of the raw and corrected response. The correction transforms the response to an effectively normal distribution with a significant reduction in the variance.

Applying these corrections to the remaining portion of the spatial survey produces the estimates of the colour ratios derived with the PSF models shown in Table 3.1. The Moffat PSF model, following the application of the colour ratio correction, demonstrates the minimum standard deviation in the estimates. As a result, the Moffat model can be considered exclusively for the remainder of the analysis. Table 3.1: Comparison of statistical colour estimates. PSF Model Arithmetic Gauss Moffat Lorentz Shape Parameter(s) n/a  = 1.2856  = 0.6163  = 1.0022  = 1.3315 Original 0.120 0.2667 0.1203 0.1595 48 rg Calibrated 0.0899 0.0894 0.0694 0.0909 Original 0.1198 0.2784 0.1191 0.1657 bg Calibrated 0.0864 0.0882 0.0656 0.0874

3.4. Laboratory Testing and Validation
2

1.8 1.05 1.6 Blue 1.4 Green Blue 1 Intensity Correction

y mod 2 [pixels]

1.2

1

0.95

0.8 0.9 Green 0.4 0.85 0.2 Blue 0 0.2 Green 0.6 Blue 1.6 Red Green

0.6

0

0.4

0.8 1 1.2 x mod 2 [pixels]

1.4

1.8

2

Figure 3.7: Spatial response of raw colour estimates for rg colour ratio. Spatial Calibration The results of the spatial calibration of the prototype hardware are shown in Table 3.2. As the characteristics are without any particular note, the geometric correction can be expected to perform at a level equivalent to a typical MST.

3.4.3

Parameter Estimation Performance

Following from the calibration, the performance of the centroid and colour estimators can be evaluated in the laboratory. Consider two special performance cases: stationary 49

Chapter 3. Colour Filter Array Star Tracker
0.08 Original rg 0.07 Corrected rg

0.06

0.05 Probability

0.04

0.03

0.02

0.01

0

0.8

1

1.2 1.4 Colour Ratio rg

1.6

1.8

2

Figure 3.8: Statistical response for correction of rg colour ratio. and translating point source. The stationary point source provides an expectation of the ideal measurement performance free of pixel effects. Similarly, the translating point source reveals the impact of sub-sampling pixel effects of the CFA. Table 3.3 shows the comparison of the colour estimates for the two cases. The mean and standard deviation of the estimates are determined using a set of 100 images. A Moffat PSF model is used in both cases. The translation of the pinhole point source across a local region of detector has a higher standard deviation in the colour estimates. This can again be attributed to the modelling of the PSF shape as a simple Moffat distribution. It would be reasonable to assume that an improved PSF function model could reduce the estimation noise below the current 50

3.5. Field Images Table 3.2: Calibration Results for the MT9P031 Hardware Prototype. Parameter Focal Distance Sensor Dimensions Nominal Pixel Dimension f-number Radial Distortion Coefficients Distortion Angles Optical Centre Location values established here. Symbol f w×h  F/# b1 , b2 a1 , a2 xOA , yOA Values 16.05 (2592, 1944) 2.2 1.4 (-13.0076, -1.3388) (-4.3792 × 10-4 , 7.4298 × 10-4 ) (1273.91, 918.42) Units mm pixels µm none none none pixels

3.5

Field Images

To establish a true gauge of CFA star colour estimation performance, it is necessary to image actual stars. This section considers the collection of the true star field images and analysis of the parameter estimation capability with real data. First, we describe the selection process for the observation site and collection method of the star images. Second, we process the images by reducing the image noise, running the proposed detection algorithm, and applying estimation techniques. Third, we compare the observed performance with the expected values derived from the catalogue.

3.5.1

Stargazing Site

The sites chosen to gather star images should maximize the amount of starlight while minimizing the impact of deteriorating effects. These effects can include night time Table 3.3: Comparison of stationary and local translation of star image. Test Stationary Translation µ 0.79004 0.75362 bg  0.068503 0.079834 51 µ 1.0449 1.037 rg  0.060692 0.074265

Chapter 3. Colour Filter Array Star Tracker sky-glow, when near an urban area, jet contrails, that while invisible to the naked eye increase the particulate matter in the atmosphere causing greater scattering for shorter wavelengths. The final observation site was located in Mississauga, a suburb of Toronto. While the optical conditions are not ideal for validation of actual launch hardware; the sky observations at that locations are sufficient for proof-of-concept of the hardware.

3.5.2

Star Colour Estimates

Over the period of several nights, a total of 12 stars, of various spectral classes, were observed and imaged over regions of the sky. Table 3.4 shows the list of stars and their associated colour ratio estimates. A sub set of the star parameter estimates are shown in Figure 3.9. A trend can be observed through the mean colour ratios, as the pair of colour ratio shifts from being predominantly blue for the B class stars to red for the K class stars. When compared to the expected colour ratios, a definitive shift in the response exists for the mean estimate. For the case of the bg the values are very similar, with the observed response slightly larger than the expected ratio. In contrast, the observation of rg demonstrate consistently higher values than the expectation. The most likely explanation for this behaviour stems from the viewing location, which while near a city, will attenuate the starlight significantly at shorter wavelengths due to particulate scattering from pollution and additional clouds formed from jet contrails. As a result, the red filter response tends to be the highest. The particular filters of the MT9P031C also impact the ratios since the pass-bands have significant common overlap (see Figure 3.1), particularly in the infra-red. The results also show an increase in the standard deviation compared to the laboratory tests. This increase in variation is also presumed to be caused by atmospheric effects, such as scintillation. Despite the increase, [Enright & McVittie 2013] preliminary analysis suggested that identification could be reliably achieved at a standard deviation of 0.1 or less, whereas the results here achieve approximately 0.06 or better. Values sufficient for distinguishing at minimum the major spectral class of the star. 52

3.6. Analysis and Further Improvements Table 3.4: Observed Star Parameter Estimates Star Name Deneb Ruchbah Altair Caph Sadr Alshain Shedir Gienah Tarazed Spectral Class B0IV A2I A5V A7IV-V F2III-IV F8I G0V G8IV K0II-III K0III K3III K5I Colour Ratio Observations rg bg µ  E (bg ) µ 1.056 0.066 1.285 1.185 1.027 0.059 1.042 1.236 1.052 0.049 1.001 1.098 1.053 0.071 0.977 1.141 1.064 0.046 0.909 1.087 1.151 0.051 0.859 0.953 1.183 0.083 0.862 0.989 1.242 0.079 0.798 0.917 1.327 0.089 0.783 0.894 1.250 0.063 0.783 0.917 1.307 0.073 0.745 0.854 1.311 0.077 0.786 0.830

Constellation  Cas  Cyg  Cas  Aql  Cas  Cyg  Cas  Aql  Cas  Cyg  Aql  Cyg

E (rg ) 0.780 0.839 0.8610 0.872 0.930 0.961 0.974 1.043 1.066 1.066 1.145 1.054

 0.075 0.072 0.067 0.054 0.060 0.057 0.070 0.069 0.069 0.044 0.041 0.050

While the current size of the field survey dataset is too small to draw any explicit results on the accuracy of the colour ratio measurements, some important observations can be noted. The offset is consistent among most of the entries. This indicates a systematic error that can be corrected through an additional calibration or procedure. The choice of observation site has a significant impact on the observations. In long term development, field data must be collected at locations with minimal atmospheric disruption, ideally at higher altitudes.

3.6

Analysis and Further Improvements

The current methodology chosen for estimating the star parameters is relatively simple; particularly, the use of basic PSF approximation models such as the Gaussian and Moffat functions. Despite this fact the combination of laboratory testing and field observations show that CFA image detectors are capable of measuring both the star position and colour ratios. Typically, the colour ratio measurements demonstrate a standard deviation of approximately 0.07; enough to distinguish between some of the major star classes, but unlikely to provide detail for the star subclass. 53

Chapter 3. Colour Filter Array Star Tracker
1.4  Cas (B0IV) Ruchbah (A5V) Sadr (F8I) Alshain (G8IV) Tarazed (K3III)

1.3

1.2

1.1 
bg

1

0.9

0.8

0.7 0.7

0.8

0.9

1

1.1 rg

1.2

1.3

1.4

1.5

Figure 3.9: Subset of field CFA colour ratio estimates with raw values in pastel, mean in colour, and expected catalogue value in black. Additionally, the sub-sampled nature of the CFA produces a strong spatial variation at the pixel level. With a basic correction, the variation was sufficiently removed to produce normally distributed colour ratio statistics. This would indicate that following the correction, the quality of the measurements would primarily dependent on the read and shot noise of the detector, rather than the PSF location. A variety of further improvements can be considered to better CFA detector parameter estimation techniques. We list these as follows: · Refinements can be made to the approximations of the PSF. The PSF model could be directly modelled using the optical design (e.g. ray-tracing) and taking explicit 54

3.7. Conclusion consideration of detector active area or presence of micro-lenses. Improved PSF modelling would tend to negate the sub-sampled nature of the CFA mosaic images. · The calibration procedure can be expanded to the entire detector, taking into account other effects introduced by optical aberrations or intensity loss (i.e. vignetting). · Improved quality of optics chosen, ideally minimizing the impact of aberrations on the PSF could also improve the performance of the estimator. · Increasing the pixel density of the detector would allow a greater sampling of the PSF, again offsetting the impact of the mosaic images. · Larger sky surveys, conducted in regions with little light pollution and at higher altitudes, would provide a more accurate measure of the possible on-orbit performance. The application of any of these suggested improvements will likely increase the estimation quality to a level capable of providing strict star class and probable subclass identification.

3.7

Conclusion

In conclusion, the CFA hardware has achieved the first requirement of colour star tracking: successful measurement of star colour using hardware optically and electronically equivalent to a conventional monochrome sensor. While several issues specific to the operation of the CFA had been encountered, the overall results are very promising with further improvements likely to yield performance necessary for long term development of this hardware technology as a basis for colour star trackers.

55

Chapter 4

Trichroic Filtered Prism Colour Star Tracker

From the development of the CFA detector sensor, the techniques can be adapted to the TFP hardware. The TFP-CST a departure from the single detector designs of the monochrome and CFA colour sensors. Specifically, through a combination of refractive optics (i.e. prism) and specialized filters, light entering the camera is divided by colour between multiple detectors. The particular goal of this chapter will be to characterize the estimation potential of the critical star parameters: position, magnitude, and colour.

This section is organized in the following form. Section 1 reviews the operating principles of the TFP camera. Section 2 shows the development of the star parameter estimation techniques. Section 3 develops a two part calibration, addressing the geometric and vignetting effects of the optics and sensor. Section 4 presents the results of the calibration and validation testing using a laboratory facility and prototype camera hardware. Section 5 examines the night-sky observations. Section 6 concludes with a brief analysis of the overall performance and further directions that could be made to improve the technology. 57

Chapter 4. Trichroic Filtered Prism Colour Star Tracker

4.1

Principle of Operation

The TFP camera is subset of a wider variety of cameras that use multiple detectors and prism assemblies to spectrally divide the light among the detectors. Consider a two detector configuration. A composite prism is constructed by cementing two prisms together with a dichroic filter at the interface [Born & Wolf 2003]. After light enters the front face of the prism and reaching the dichroic interface, part of the light is transmitted to the adjoining prism while the remainder is reflected as a function of the wavelength. Careful selection of the angle of intersection directs the reflected light toward to an exit facet of the prism where a monochrome image detector is attached. Similarly, the transmitted light can be observed by a second monochromatic detector at another exit facet. The combination of the detectors images produces a full-resolution, multi-colour image of the scene. As shown in Figure 4.1, the sensor construction can be easily expanded to a three detector configuration. This design typically divides the light into the three primary colours (i.e. red, green, and blue). Two properties result directly from this design. First, each colour component image has the same pixel density as a monochrome sensor. This allows complete imaging of the photon response. Second, the signal is split between the three detectors with the only loss resulting from transmission through the prism and quality of the dichroics. This does come at the cost of increased image noise as each detector produces the noise equivalent to a single monochrome sensor. The prototype for this study is the JAI AT-200ge camera by Pulnix as shown in Figure 4.2, can also demonstrate another important property of the TFP configuration. Figure 4.3 shows the filter pass bands of the prototype hardware. The property of interest is the narrow transition between the pass bands and stop bands. This directly benefits colour observations providing distinct and independent measurements of different portions of the visible spectrum. Finally, the choice of the red, green, and blue passband filters are purely a decision of the manufacturer. While a more thorough discussion of the choice of filter pass bands will be reserved for Chapter 5, the pass bands of a custom manufactured camera can be chosen to meet most design configurations. 58

4.2. Star Parameter Estimation
Red Detector Lens Incident Light Green Detector

Green Dichroic Filter

Prism Assembly Yellow Dichroic Filter

Blue Detector

Figure 4.1: Schematic diagram of photon path through trichroic camera.

4.2

Star Parameter Estimation

This section presents process of estimating star parameters from the raw image generated by TFP-CST hardware. First, we consider the detection criteria for a multi-detector camera and propose an algorithm to take advantage of its particular characteristics. Second, we consider two parameter estimation techniques for determining the properties of the observed star images.

4.2.1

Arithmetic

An arithmetic estimation determines the centroid as the intensity weighted spatial mean of the pixels. Treating each component colour image independently, the arithmetic parameter estimation does not change from monochrome estimation. Specifically, the spa59

Chapter 4. Trichroic Filtered Prism Colour Star Tracker

Figure 4.2: JAI AT-200ge camera. tial mean can be expressed as:

xc,k =

i i

j

xijk Iijk j Iijk

(4.1)

yc,k =

i i

j

yijk Iijk j Iijk

(4.2)

where Iijk is the pixel value for the k-th component image, and (xijk , yijk ) is the pixel coordinate. As each image generates a respective centroid, the individual centroids estimates can be individually calibrated for distortion. Treating each image independently, the colour intensities are equivalent to the observed intensity from a single image. In functional form:

I0,k =
i j

Iijk

(4.3)

60

4.2. Star Parameter Estimation

Figure 4.3: Spectral pass bands of the JAI AT-200ge camera. where k is the index of the colour component. Similar to the CFA sensor, star colour can be represented independently of the absolute magnitude by taking the ratios of the colour intensities. Considering the TFP, the ratios can be expressed as: Ig Ir Ib Ig

gr =

(4.4)

bg =

(4.5)

Using the colour intensity estimates, the final centroid estimate by weighting the indi61

Chapter 4. Trichroic Filtered Prism Colour Star Tracker vidual centroids based on the relative colour intensity:
n k Ik xc,k n k Ik

xc =

(4.6)

yc =

n k Ik yc,k n k Ik

(4.7)

The increased number of sample points making up the TFP image can improve the performance of the arithmetic estimator. However, these techniques suffer from amplifying noise due to the multiplication of large pixel coordinates. The computational efficiency of the arithmetic estimator make them ideal in determining initial estimates for the more precise, curve-fitting estimation techniques.

4.2.2

Curve-Fitting Model

The curve-fitting estimation again draws from the independent nature of the TFP detectors. Considering a single component colour image, an approximation of the PSF response can be fit to the observed pixel intensity pattern as if it were a monochrome image. Due to the full resolution of the component images, a Gaussian function can sufficiently approximate the PSF:

fGAUSS (x, y, xc , yc ,  ) =

1 (x - xc )2 + (y - yc )2 exp - 2 2 2 2

(4.8)

where  defines the spatial scaling of the PSF. The pixel response of the image can be modelled by weighting the PSF model by the colour intensity and treating the coordinates as integers. This can be given as:

Iijk = I0,k · f (xi , yj , xc,k , yc,k , k ) 62

(4.9)

4.3. Calibration where k again notes the index of the component image. The determination of the colour ratios follows from (4.4).

4.2.3

Curve-Fitting Estimation

The model parameters are determined using a minimum least squares optimization. Define the least squares cost function as:

m

n

 (uk ) =
i j

(I (xij , yij , uk ) - Iijk )2

(4.10)

where uk = [xc,k , yc,k , Ak , k ] is the parameter vector to be fit. Mapping (4.10) to a single vector representation:

mn

 (uk ) =
i

(I (xi , yi , uk ) - Iik )2

(4.11)

allows standard least squares optimizers to be applied to determine the parameters of uk . The Levenburg-Marquadt solver is again sufficient for the on-line parameter estimation. Following directly from the arithmetic estimator development, the final star centroid estimate is determined by (4.6) with the colour ratios defined by (4.4). It is important to note that the scaling parameters k is determined on-line, again due to the high pixel density.

4.3

Calibration

The TFP camera calibration is identical to single monochrome techniques applied separately to each component colour image. The calibration consists of determining corrections for geometric and intensity of the observed stars. 63

Chapter 4. Trichroic Filtered Prism Colour Star Tracker

4.3.1

Geometric

The geometric calibration procedure follows directly from Chapter 3, determining values for the intersection of the OA with the detector, focal length, and centroid position distortion parameters. The calibration model can be found in Appendix A. The pinhole point survey is collected simultaneously for all three detectors, guaranteeing their respective alignments both to the hardware chassis and each other.

4.3.2

Vignetting

Practical optical systems also suffer from a large scale spatial variation in observed intensity known as vignetting. Four types of vignetting can potentially be present in the TFP: mechanical, optical, natural, and pixel. While the cause of the vignetting arises from distinct sources in the imaging assembly, the combined effect is a radial drop-off in the observed intensity from optical axis intersection with the detector. The CST requires a correction to provide accurate colour ratios independent of the spatial position on the detector. 1 Using the same laboratory facility used for the spatial correction, an illuminated matte white surface replaces the inverted telescope; approximating a Lambertian reflectance. This provides a nearly uniform intensity field for the CST. Averaging a series images of the surface, taken from different angles, minimizes any non-Lambertian imperfections in the surface [Healey & Kondepudy 1994]. The variations in intensity due to the vignetting and prism are gradual. By convolving the previous image with a uniform filter and normalizing the image, such that the maximum is 1, results in an empirical representation of the intensity pattern. Storing the complete intensity images on-board would require a significant portion of the available memory. Instead, the intensity pattern is approximated by a piecewise linear interpolation generated from a sub-sampled version of the empirical intensity pattern. Following the spatial correction, the colour measurements
While the CFA also suffers from vignetting, that analysis had been restricted to a small region around the OA where the effect would be at a minimum and with negligible impact.
1

64

4.4. Laboratory Testing derived from the parameter estimation are corrected rather than the raw image:

~0,k = I

I0,k Vk (xc , yc )

(4.12)

where Vk (xc , yc ) is the vignetting response at the star centroid position for the k component colour image. The ratios are then determined from the corrected intensity values.

4.4

Laboratory Testing

This section presents the calibration results of the sensor hardware and the laboratory testing to determining the capability to estimate the sensor performance to estimate star parameters. The laboratory testing also serves as a basic validation prior to the evaluation using field observations.

4.4.1

Calibration Results

As described above, calibration of the sensor consists of the geometric and vignetting intensity corrections. The results of the spatial calibration of the prototype hardware are shown in Table 4.1. Most of the characteristics are not noteworthy and can be directly attributed to the quality of the lens and camera hardware chosen for the prototype. Figure 4.4 shows the vignetting response for the green component image. As expected, the general trend is a radial reduction in the total intensity. The red and blue colour images follow similar behaviours. It is important to recognize that a simple radially weighted vignetting model could be considered, a radial correction cannot correct for the asymmetrical differences in path lengths of light through the TFP assembly. To correctly model those features would require explicit knowledge of the prism manufacture and assembly, typically proprietary information. 65

Chapter 4. Trichroic Filtered Prism Colour Star Tracker Table 4.1: Calibration Results for the JAI200 Hardware Prototype. Parameter Focal Distance Sensor Dimensions Nominal Pixel Dimension F/# Radial Distortion Coefficients Distortion Angles Optical Centre Location Symbol f (m, n) x f-number b1 , b2 a1 , a2 x0 , y0 Values 25.0948 (1620, 1236) 4.4 1.8 (-4.0229, 0.1962) (-4.7149 × 10-5 , -2.7310 × 10-5 ) (798.46, 617.13) Units mm pixels µm none none none pixels

4.4.2

Performance of Parameter Estimation

Two laboratory tests are considered: imaging of a stationary and small translation point source. Statistics are determined by applying the on-line parameter estimation to a sequence of 50 pinhole images. Table 4.2 shows the estimated parameters from these two tests. When compared to the tests of the CFA, many interesting features are revealed. The mean colour ratios demonstrate significantly different values. This can be attributed to the difference in the filter pass-bands of the two sensors, where the MT9P031-C has a common infra-red component and significant overlap between the different colours resulting in values closer to 1.00. In contrast, the JAI200 shows distinct, relatively independent pass-bands resulting in the bg colour ratio to be very small since the source is dominant within the red to green portions of the spectra. Of more significant note, the standard deviations of the TFP colour ratios are significantly reduced, by nearly an order of magnitude, compared to the CFA. This different results from the sampling density of the two detectors, specifically the TFP has three times the number of useful lit pixels with which to determine the star parameters. The limited impact of the point source translation can also be attributed to the pixel; an issue that required a special correction of the CFA to correct. Additionally, we consider the stationary centroid distributions shown in Figure 4.5. All three colour centroids are contained almost entirely within a half pixel, with the blue 66

4.5. Field Validation
1 0.95 200 0.9 0.85 400 Vertical [pixels] 0.8 0.75 0.7 800 0.65 0.6 1000 0.55 0.5 200 400 600 800 1000 Horizontal [pixels] 1200 1400 1600 VG(x,y)

600

1200

Figure 4.4: Vignetting response for the green component image. centroids exhibiting a greater variance due to the low intensity of the source at the higher wavelengths.

4.5

Field Validation

The final set of observations taken by the TFP were of actual stars. All images in the set were taken entirely within the span of 2 hours; allowing us to assume constant atmospheric conditions for the period of all the observations. The images were again taken in the city of Mississauga, a suburban area near Toronto. 67

Chapter 4. Trichroic Filtered Prism Colour Star Tracker Table 4.2: Comparison of stationary and local translation of star image. Test Stationary Translation bg µ 0.2127 0.2203  0.0167 0.0197 gr µ 0.3801 0.3789  0.0089 0.0126

Table 4.3 shows the set of stars and the resulting estimates of the colour ratios. To better illustrate the performance, Figure 4.6 shows a subset of the estimated colour ratios. On first inspection, the behaviour of the estimates are consistent with the observations from the laboratory. The increase in variability of the estimates most likely results from the effect of the atmospheric scintillation. Despite the increase, the variation in the estimation more than satisfies the requirements set forth by [Enright & McVittie 2013]. Examining the difference between the averaged observation and the expected catalogue values of the colour ratios, an important trend can be observed. The observed colour ratios are consistently lower than those expected. This can be attributed again to the effects of atmosphere, causing shorter wavelengths to be dispersed, resulting in lower intensities for the blue and green response compared to the red. Of particular importance is the offset error is relatively consistent among all the stars observed which, assuming the effect is not due to the observation cite, could be calibrated out as a systematic error. Thereby providing accurate measurements of the colour ratios. As a final test, a more detailed inspection examines the behaviour of two stars within the set; specifically  Umi and  Umi. Appearing very close to each other, the two stars can be observed within the same image. Applying the sensor model and intensity corrections to the raw star parameter estimates, we can observe the quality of the estimates of colour and arc-length produced by the TFP hardware. Table 4.4 provides the measurements found for this trial. Both the measurement accuracy and precision of the arc-length are either equivalent or less than absolute error of the spatial calibration. The offset error in the colour ratio with respect to the catalogues is higher than expected. Since the errors are consistently positive, this indicates greater attenuation of the shorter wavelengths (i.e. blue). This effect can be attributed to the atmospheric conditions at the observation site; which suffers from proximity to city 68

4.6. Analysis and Future Improvements
618.1 Red Green Blue Mean

618.05

618

617.95 Vertical [pixels]

617.9

617.85

617.8

617.75

617.7 820.5

820.55

820.6

820.65

820.7 820.75 Horizontal [pixels]

820.8

820.85

820.9

Figure 4.5: Stationary centroid estimation. lights, high humidity, and jet contrails. Future validation studies will require a more judicious choice of the observation site. Despite the error in the colour ratios, the star pair measurements satisfy the positional requirements for both CST and MST with colour ratios giving a definite orientation to the star pair.

4.6

Analysis and Future Improvements

From the combination of the the laboratory and field tests, several important observations can be drawn. The TFP camera produces colour ratio estimates of actual star 69

Chapter 4. Trichroic Filtered Prism Colour Star Tracker Table 4.3: Colour Estimates of Star Field Survey. Star Name Alkaid Deneb Pherkad Sarin Rasalhague Seginus Alderamin Sadr ­ Kornephoros Al Dhibain Gienah Celbalrai Kochab Etamin Constellation  UMa  Cyg  Umi  Her  Oph  Boo  Cep  Cyg  Her  Her  Dra Cyg  Oph  Umi  Dra Spectral Class B3V A2I A3III A3IV A5III A7III A7IV F8I F9IV G8III G8III K0III K2III K4III K5III E (bg ) 1.222 1.003 0.9451 0.993 0.917 0.897 0.900 0.6979 0.685 0.534 0.530 0.520 0.469 0.391 0.368 bg µ 0.844 0.835 0.769 0.783 0.749 0.703 0.735 0.849 0.553 0.477 0.474 0.449 0.415 0.356 0.353  0.038 0.026 0.054 0.034 0.027 0.040 0.027 0.017 0.033 0.027 0.018 0.026 0.027 0.023 0.020 E (gr ) 1.581 1.412 1.377 1.378 1.349 1.304 1.308 1.108 1.0874 0.941 0.933 0.909 0.847 0.762 0.729 gr µ 1.287 0.729 1.129 1.167 1.131 1.037 1.098 1.216 0.897 0.775 0.770 0.729 0.664 0.562 0.568  0.063 0.025 0.061 0.058 0.058 0.056 0.039 0.035 0.050 0.045 0.035 0.025 0.037 0.027 0.027

observations within a standard deviation of 0.05, with many cases demonstrating values less than 0.03. As ground observations subject to atmospheric effects, it can be expected that on orbit performance will approach the noise statistics of the laboratory measurements. Recalling the difference between the CFA and TFP hardware (i.e. colour filter curves and detector noise), a limited comparison can be made between the two devices. The CFA colour ratio measurements typically perform with a standard deviation of 0.06, even under ideal circumstances. In contrast, the TFP demonstrates improved performance, Table 4.4: Measurements from Star Pair:  Umi and  Umi  Umi bg gr 0.425 0.883 0.356 0.562 0.069 0.321 0.023 0.027  Umi bg gr 1.026 1.605 0.769 1.129 0.257 0.476 0.054 0.061 70 Arclength  [rad] 5.5685 × 10-2 5.5660 × 10-2 2.53 × 10-5 1.28 × 10-5

Catalogue Mean Error Std.

4.6. Analysis and Future Improvements
1.6 Alkaid (B3V) Seginus (A7III)  Hercules (F9IV) Al Dhibain (G8III) Etamin (K5III)

1.4

1.2

1 
bg

0.8

0.6

0.4

0.2 0.2

0.4

0.6

0.8

gr

1

1.2

1.4

1.6

Figure 4.6: Subset of field TFP colour ratio estimates with raw values in pastel, mean in colour, and expected catalogue value in black. even under poor observation conditions, with an improvement in measurement precision approaching an order of magnitude. More significantly, only a limited calibration similar to monochromatic sensors is required to achieve colour estimates significantly better than what has been seen with the CFA sensor (Chapter 3). Despite the quality results, further improvements can potentially be made in the estimation and calibration of the TFP hardware. These improvements include: · More refined modelling of the PSF response, taking into consideration variations in the PSF shape at different locations on the detector. The Gaussian function model 71

Chapter 4. Trichroic Filtered Prism Colour Star Tracker has been sufficient, but explicit consideration of the optics and detector could only serve to improve the estimates. · Investigate the impact of magnitude on the quality of the parameter estimates. It would be expected that dimmer stars, as they approach the noise floor of the detector, would produce larger variations in their parameter estimates. · Larger survey of star images at an improved location (i.e. higher altitudes, away from cities) allowing for possible modelling of the detection performance of the hardware and improved validation of the estimation techniques.

4.7

Conclusion

This chapter has established clear evidence for the measurement potential of the TFP sensor. This included developing techniques for the precise and accurate estimation of star colour ratios and centroid in the detector from the raw images. Expanding a basic calibration procedure, sub-pixel angular distance measurements were achieved, sufficient for MST identifications. Therefore, the TFP imaging technologies merit further investigation and could easily serve as a basis for further colour star tracker prototype development.

72

Chapter 5 Star Detection Trade Study
The detection of stars defines the absolute limits on attitude determination capabilities. Specifically, MSTs require a minimum of three stars within their FOV to potentially determine a unique attitude solution. In contrast, a CST requires a minimum two stars for a potentially unique attitude solution but at the cost of lost light resulting from the measurement process. From this standpoint, the trade study sets a framework for comparison of CST and MST designs to characterize the contribution of colour on the detection performance. This chapter presents an examination and comparative trade study of detection performance for several potential CST designs. Organization of the chapter proceeds as follows. Section 2 presents a set of detection algorithms tailored for the particular CST designs. Section 3 describes the operation of the full sky detection survey simulations and the sensor configurations used within the study. Section 4 examines the detection performance of the sensor configurations and merit of particular designs. Finally, some conclusions on the detection process and possible improvements to be made to the sensor designs and simulations.

5.1

Detection Algorithms

Most detection algorithms divide into two groups: single image detection and multi-image detection. The single image detection must detect stars from the background image 73

Chapter 5. Star Detection Trade Study noise of a single image; typically applied to CFA designs and monochrome sensors. The multi-image detection algorithm examines combination of images to maximize the photon counts. This algorithm applies to the multi-detector designs such as a Dichroic Filter Prism (DFP) or TFP. Although a variety of detection algorithms exist, those chosen consider a relatively simple approach. Motivation for this choice stems from the need to compare the performance of colour star tracker designs to their monochrome counterparts. Since most single image algorithms would potentially produce equivalent incremental performance increases to both sensor types, the additional algorithm complexity would only serve to increase simulation time. In the presentation of these algorithms, it is assumed that the image already has passed a preprocessing phase to eliminate specific detector effects (e.g. dark-offset) [Healey & Kondepudy 1994].

5.1.1

Single Image Detection

The basic detection method applies a raw threshold filter to the image. Any pixels exceeding the raw threshold are treated as candidate stars. A star PSF provides several additional properties that can be exploited by the detection algorithm. For instance, the PSF of a star generally produces a cluster of pixels while a merely noisy pixel is surrounded by background intensity pixels. To identify clusters of pixels, the threshold image is raster scanned. Pixels with adjacent lit neighbours are grouped into a single cluster; a process known as connected-component labelling [Di Stefano & Bulgarelli 1999]. Figure 5.1 shows an example of the two connectivity arrangements: four and eight. In 4-connectivity arrangement, pixels must be vertically or horizontally adjacent to be considered part of the group; 8-connectivity extends the arrangement to include diagonally adjacent pixels. Applying a minimum pixel constraint to the candidate clusters removes small groups of pixels, potentially generated by the image noise, from the detection. The choice of arrangement depends strongly on the detector. Monochrome sensors produce a unbroken circular group of lit pixels at the star position; ideal for the 4-connectivity clustering. The CFA detector also produces a circular group of lit pixels. However, the different filters of the CFA can cause certain pixels with the group to be unlit due to a low star intensity in that passband. For example, a red M-class star will have fewer or even no lit blue pixels with the group, while the red and green pixels would be lit. In 74

5.1. Detection Algorithms

Figure 5.1: Connectivity-4 and -8 cluster detection. these cases, using 8-connectivity clustering would appear to be the better choice. However, including diagonal pixels also increases the chance of a group of noisy pixels being falsely detected as a star. The choice of connectivity then becomes a trade-off between the additional star detections and impact of false star detections. At this stage of the development, the detection processes are not developed for realtime hardware. As a result, we can avoid explicit analysis of the detection algorithm's computational performance and be somewhat lenient of the efficiency requirements for programming. Despite this fact, the raw-threshold and connected-component labelling remains one of the fastest single-image detection algorithms available, allowing for easy implementation onto actual star tracker hardware.

5.1.2

Multi Image Detection

Prism based colour star trackers spectrally divide the incident star photons among multiple, independent image detectors with uncorrelated noise. With the exception of the transmission loss through the prism, the entirety of photon signal can be recovered but with the combined noise of three detectors. 75

Chapter 5. Star Detection Trade Study The simplest multi-image detection algorithm adds the component colour images to form a single image. As an example, consider the TFP images:

Iij,t =

loss

(Iij,r + Iij,g + Iij,b )

(5.1)

where loss is the transmission loss of the prism. Since the detector noise can be approximated to a normal distribution and as all the detectors can be assumed to be of the same model, the noise variance of the combined image becomes: 

2 2 2 2 ij,t = ij,r + ij,g + ij,b 

2 3RN

(5.2)

where RN is the single image read noise. The detection algorithm is then be applied to the composite image. A specialized prism configuration chooses filter pass bands such that one component image receives a significantly larger portion of the incident photon flux. Applying the single image detection algorithm, previously described, the centroid and absolute magnitude can be found for that particular pass band. After correcting for optical distortion between the two images, the absolute magnitude in the other passband can be found by a reduced curve-fit to PSF using the centroid determined from the primary image; reducing the parameters in the estimation.

5.2

Sensor Design Framework

The design of the colour star tracker must consider the aspects of MST design; these include detector noise, lens focal length, field of view, lens F/#, and exposure exposure time. The aspects of the colour sensors, particularly the choice of filter pass bands, must be considered in tandem. Due to differences in design and operation of the colour and monochrome star trackers, selection of these terms can no longer be defined by a single parameter such as maximum star magnitude. The quality of the detection algorithm 76

5.2. Sensor Design Framework can instead be characterized by two characteristics: percentage sky coverage and False Detection Rate (FDR). From these, a simple metric is derived for choosing potential colour filter pass bands.

5.2.1

Sky Coverage

Sky coverage is the percentage of the attitude views where a star tracker can detect a the number of stars required for an identification to occur. Two types of successful views can be considered. A marginal view occurs when only the minimum number of stars can be detected. For a monochrome star tracker three stars defines the marginal case while only two stars are needed for the colour star tracker. As a result, the minimum detectable star intensity need not necessarily that of a MST for a CST to start outperforming in the pattern identification process. Although the marginal case meets the necessary requirements for an identification and attitude solution to occur, views of this types can still be ambiguous and yield multiple solutions. A 'good' view occurs when a greater than marginal number of stars can be detected within the scene. In these cases, the additional stars reduce the chance of pattern ambiguity and can generally be assumed to be uniquely identifiable. The remaining attitude views of the star tracker contain insufficient star and fundamentally cannot be identified. A measure of a star trackers performance is the percentage of attitudes, given no a priori information, where a successful identification can occur. Therefore, a star tracker with a greater number of "good" views can be considered an improvement over one with fewer. The easiest method for detecting a greater number of stars, and by extension increasing the number of "good" views, is to decrease the raw detection threshold.

5.2.2

False Detection Rate

The event of a star detection occurring due to noise rather than an actual star is a false detection (i.e. type 1 error)[Sheskin 2003]. False detections are particularly detrimental 77

Chapter 5. Star Detection Trade Study for star trackers. The presence of an additional, invalid point into the observed star pattern can result in the pattern being incorrectly identified. The misinterpreted pattern could produce a significantly different attitude solutions than that of sensor. Minimizing the number of false detections within any detection algorithm becomes a primary concern. We can then define the FDR as the mean number of false-detections per image. The selection of detection threshold now becomes a trade-off between maximizing the number of true stars observed while minimizing the FDR. Assume that false detections are equally detrimental for both colour as monochrome star trackers. Under this assumption, the FDR provides the second measure for comparing the detection performance of the various star trackers. Together with the sky coverage, sensors of different designs can be compared on an equal footing independently of their specific operations.

5.2.3

Colour Filters Constraint

The majority of the parameters that determine detection performance impact both the monochrome and colour star designs. To gain relative improvements between the sensors requires examining the colour pass bands, a design parameter unique to the colour star tracker. Prior to developing specific filter combinations and arrangements, consider a simpler evaluation metric. The observed photon count for a given photon magnitude using a monochrome star tracker can be defined as:

IM = I0 · 10-mM /2.5

(5.3)

where I0 is the absolute photon count for the reference star and mM is the star photon magnitude[Carroll & Ostlie 1996]. The colour measurement process divides the monochrome QE spectral response into different regions based on wavelength known as filter pass-bands. The intensity for the 78

5.2. Sensor Design Framework CFA-CST can then be defined as:

ICFA = kI0 · 10-mCFA /2.5

(5.4)

where k is the attenuation resulting from the colour filtering process. Since the CFA uses a mosaic of filters, the attenuation of the detector can be approximated to the average of the individual filter band-pass attenuations. Star detection relies on selecting groups of pixels within the PSF that exceed a particular raw threshold. The detection also requires a number of pixels to be included, we can approximate the minimum threshold Signal to Noise Ratio (SNR) for a detection as: IM T

SNRM =

(5.5)

where IM is the total detector count star intensity for the monochrome image and T is the total noise of the detection process. This approximation of the SNR is too simple to accurately model the absolute detection threshold. However, as both the monochrome and CFA detectors are physically equivalent, the approximation can effectively represent the relative detection threshold between the two sensor types. Assuming an equal minimum SNR necessary for star detection, through algebraic manipulation the relative colour magnitude can be derived as: IM ICFA = T T

SNR =

(5.6)

Substituting 5.4 and 5.3 into 5.6 and simplifying resolves to

mCFA = mM + 2.5 log10 k

(5.7)

The loss in detection magnitude between the CFA and monochrome designs can be approximated to a scaled version of the filter pass-band loss. 79

Chapter 5. Star Detection Trade Study The bound on the detection performance of the TFP star tracker considers the single image formed by (5.1). The intensity of light received by the TFP can be expressed as:

ITFP = I0 · 10-mTFP /2.5

(5.8)

Assume the total noise of the detection process scales linearly relative to the read noise. Using (5.2), the SNR for the TFP becomes: ITFP SNRTFP =  3T Again, by assuming equivalent SNR ratios: IM ITFP = T 3T

(5.9)

SNR =

(5.10)

Substituting (5.1) and (5.8) into (5.10), results in the expression:  mTFP = mM - 1.25 log10 ( 3) + 2.5 log10 (

loss )

(5.11)

The last two terms of (5.11) can be combined to produce the same style of equation as (5.7); specifically:

mTFP = mM + 2.5 log10 (k )

(5.12)

The other DFP-CST is developed such that one detector receives the majority of the incident photons. Treating it as a monochrome sensor, then the relative detection bound is given by (5.7). A CST requires the detection of a minimum of two stars while a MST needs three to be capable of identifying the stars in the scene. This difference in detection requirements 80

5.2. Sensor Design Framework allows for a coarse estimate of the maximum sensitivity loss that can be tolerated by the colour filter sets. Recalling that the total number of stars less than a given photon flux magnitude for the monochrome sensor forms an approximately logarithmic relationship:

log10 (NM )  const. + g · mM

(5.13)

where NM is the number of stars detected by the MST and g is the fitted linear ratio parameter [Carroll & Ostlie 1996]. A similar expression can be derived for a CST as:

log10 (NC )  const. + g · mC

(5.14)

A CST requires the detection of a minimum of two stars while a MST needs three to be capable of identifying the stars in the scene. This difference in detection requirements allows for a coarse estimate of the maximum sensitivity loss that can be tolerated by the colour filter sets. Constructing this minimum ratio:

2 NC  NM 3

(5.15)

where 2/3 results from the ratio of stars needed to meet he minimum detection requirements. Combining (5.15), (5.13), (5.14), and (5.7), with some algebraic rearrangement, yields the expression for the required minimum filter sensitivity:

k > 10log10 ( 3 )/2.5g A similar expression for the TFP simplifies to:


2

(5.16)

 > 10log10 ( 3 + 81

2

3)/2.5g

(5.17)

Chapter 5. Star Detection Trade Study Together these relations determine a coarse lower bound for the sensitivity of the colour filters needed to achieve competitive detection performance between a CST and MST.

5.2.4

Candidate Filters

The monochrome filter response of the MT9P031 detector serves as a baseline for the filter selection. Figure 5.2 shows the approximate curve-fit between the number of stars and maximum detectable magnitude; a linear regression estimates the slope of g = 0.5035. Using 5.16, the colour filter arrangement must take in a minimum of 72.3% of the incident photons compared to an equivalent monochrome star tracker. A variety of potential star tracker designs can be considered. For this study we opt to examine four specific designs. The first and second potential designs use the filter arrangements of the MT9P031c and AT200-ge cameras examined in Chapters 3 and 4, respectively. The third design chooses an modifies the CFA by using an additive colour filter set as shown in Figure 5.3. Specifically, two monochrome pixels are positioned on the diagonal of a two-by-two mosaic, with a yellow and cyan pixel filling the remaining two pixels. The CFA is assumed to be constructed using dichroic filters applied to the pixels1 . The final design consists of a DFP with one passband receiving a significant portion of the total intensity; Figure 5.4 shows the filter set. In this case, the larger yellow filtered detector is treated as a monochrome sensor, with colour information taken from the other detector following the detection of the stars. The filter pass-bands for the proposed CST are chosen either from the manufacturer's specifications or coarsely tuned to exceed 5.16 and 5.17. Table 5.1 shows the comparison of the detection sensitivity of different star tracker filter designs. Direct inspection reveals that manufacturer designs (i.e. MT9P031 and JAI200), fail to meet the minimum sensitivity requirements needed of a CST. Greater sensitivity of the MT9P031-C sensor compared to the JAI200 can be attributed to the common infra-red component of all the colour filters. The remaining custom designs show an improvement over the minimum requirement. Despite no optimization in their choice, the custom filters demonstrate that reaching the minimum sensitivity bound is achievable.
Ocean Optics Inc. has developed a proprietary technique for the precision application of interference filters at pixel level scale.
1

82

5.2. Sensor Design Framework

10

4

Number of detectable stars, Nstar

10

3

10

2

Cataloged Stars Linear Approximation 3 3.5 4 4.5 5 5.5 6 6.5 Maximum detectable magnitude, mq 7 7.5 8

Figure 5.2: Photon flux magnitude to number of detectable stars.

This study compares the performance of colour compared to monochrome star tracking, not the optimization of a specific design. Several of the sensor parameters are fixed to constant values. For simplicity, we assume the same underlying image detector for all the designs. The only difference is the addition of the band-pass filters or of a prism and additional detectors which do not effect any other characteristics. The particular choice of sensor the MT9P031 detector. Table 5.2 shows the specific characteristics of the sensor. These parameters are very similar to those of the ST-16 star tracker. 83

Chapter 5. Star Detection Trade Study
0.7 Monochrome Yellow Cyan 0.6

Quantum Efficiency [e-/photon]

0.5

0.4

0.3

0.2

0.1

0 300

400

500

600 700 Wavelength  [nm]

800

900

1000

Figure 5.3: Custom CFA filter arrangement.

5.3

Methodology of Performance Simulations

To determine the precise detection capability of the viable colour star trackers relative to their monochrome counterparts requires explicitly simulating the detection operation. A variety of methods can be used to simulate the detection operation. For the analysis presented here, the operation is divided into four major segments: numerical modelling of FDR, construction of composite star catalogue, estimation of detection sensitivity, and star scene simulation. 84

5.3. Methodology of Performance Simulations
70 White Cyan Red 60

50 Quantum Efficiency (%)

40

30

20

10

0 300

400

500

600 700 Wavelength [nm]

800

900

1000

Figure 5.4: Custom DFP filter response.

5.3.1

Numerical Modelling of False Detection Rate

The FDR for a given raw detection threshold and cluster size can be estimated by a numerical survey of 'star-free' background images. Image noise is the detector read-noise, which combines several noise sources. These sources include shot noise, quantization, and amplifier noise. As the shot noise tends to dominate, the background noise can be represented as:

2 Bij = N 0, RN

(5.18)

85

Chapter 5. Star Detection Trade Study Table 5.1: Comparison of expected detection performance. Design 0 1 2 3 4 Technology Conventional MT9P031-C JAI200 Custom-CFA Custom-DFP Filter Set Monochrome Red, Green, Blue Red, Green, Blue Mono, Yellow, Cyan Yellow, Cyan Sensitivity (k ) 1.0000 0.4414 0.3727 0.8494 0.8016

Table 5.2: Sensor Configuration Parameters Parameter F-number Detector Dimension Pixel Width ADC Conversion Ratio Focal Length Read Noise Exposure/Integration Time Active pixel area Symbol F/# w×h  gLSB/e- f RN tEXP A Value 1.8 2048 × 2048 2.2 6.5 12-25 25 100 75 Units none none µm none mm LSB ms %

where RN is the standard deviation of the read-noise. Other noise sources within the image, such as photo-response non-uniformity (PRNU), fixed pattern noise (FPN), or dark offset, are not modelled. Typically, these factors are eliminated during a pre-processing step prior to the application of the detection algorithm. When the detection algorithm is applied to the simulated background images, any star detections can be treated as false detections. By simulating a large number of images, a FDR can be determined for each raw threshold:

Traw = k RN

(5.19)

where k is the relative threshold coefficient and connectivity arrangement (i.e. 4 or 8). After simulating all the desired detection combinations, a maximum FDR bound is determined. The raw threshold that produces a FDR of 10-2 false detections per image on the maximum bound becomes the detection threshold for the catalogue star sensitivity analysis. 86

5.3. Methodology of Performance Simulations The choice to numerically model the FDR results from the complexity of the detection process. Although the models considered in this study are relatively simple, most star trackers would make numerous modifications and enhancements to algorithm and hardware. Making analytical modelling of each detection algorithm tedious with the model useful only for a small subset of sensor designs.

5.3.2

Composite Star Catalogue

A ready made catalogue for the purpose of comparing different star tracker technologies does not exist. The creation of such a catalogue requires consideration of a variety of factors dependent on both the observable stellar spectra, intensity, and visible magnitude combined with the specific characterization of the sensors being examined. A variety of existing star characteristic catalogues, developed by astronomical and astrophysical research communities, can be combined to form a composite catalogue for the observation made using star trackers. The desired including accurate estimates of both spatial and spectral properties. To construct the composite star catalogue requires merging the Sky2000 and Pickles Atlas to form a list of entries containing the stellar positions (i.e. RA and DEC) together with the photon flux for each detector passband. As all entries in the Pickles Atlas are normalized and scaled corresponding to a zero visible magnitude. The photon flux can be determined from the spectral flux using (2.19), where the QE is chosen for the particular colour pass-band. Since the visible magnitude number is not dependent on the wavelength, it can be separated from the photon flux resulting in the expression:

q = 10-mv /2.5 q,0 where q,0 is a zero visible magnitude photon flux.

(5.20)

Currently, the Pickles catalogue only contains 131 entries, resulting in numerous spectral class and intensity types unresolved. The missing values can be determined by approximating the response using the available photon flux estimates. Figure 5.5 shows the 87

Chapter 5. Star Detection Trade Study photon flux curve with respect to the spectral class of the most common luminosity type (i.e. type V); the values assume a constant visible magnitude. The sharp increase towards the M class stars results from the nearly even distribution of the photon spectral flux over the pass-bands with the peak near the lower boundary of the filter passband. Using the interpolated photon flux response curves and visible magnitudes of the Sky2000 catalogue, the incident photon flux is determined for all valid catalogue entries. Future refinement of the composite catalogue will supplement the missing entries with additional catalogue and field data sources.

5.3.3

Estimation of Detection Sensitivity

To determine the detection sensitivity requires explicitly generating images of stars. Figure 5.6 shows a sample of a simulated star image. The star is modelled as a symmetrical Gaussian function weighted by the expected photon count: D2 · tEXP · ph,incident · fGAUSS (x, y, xc , yc ,  ) 4

Nph (x, y ) =

(5.21)

where D is the diameter of the primary lens and tEXP is the camera exposure time. The photon noise of the PSF is in the form of a Poisson distribution. As the photons counts are typically large, Nphotons 10, the noise can be represented by a Gaussian distribution of the form:

2 Nph,observed  N µph , ph

(5.22)

2 where µph = Nph and ph = Nph approximate the characteristics of the Poisson statistics [Hubbard 1970]. A single star image then can be approximated as:

IDetector = (Nph + B ) · gLSB/e- where B is from (5.18) and gLSB/e- is the sensor conversion factor. 88

(5.23)

5.3. Methodology of Performance Simulations

7

x 10

6

6

Mono. Red Green Blue

5

Photonss-1cm-2

4

3

2

1

0

O

B

A

F MK Spectral Class

G

K

M

Figure 5.5: Estimated photon response curves for stars of type V intensity.

Rather than generating complete star scene images, a sequence of single star images with centroids evenly distributed within a two-by-two pixel area is generated for each catalogue entry. Applying the detection algorithms to each image in the sequence and averaging the number of successful detections, provides an estimate of the detection probability for that particular entry. The two-by-two size results from a need to estimate the impact of the CFA pattern. A survey of the catalogue can be conducted for each proposed sensor configuration. The threshold for the detection is chosen from the FDR analysis to satisfy a rate of 100 images per false detection. 89

Chapter 5. Star Detection Trade Study

Figure 5.6: Simulated star image.

5.3.4

Modelling Star Scene Detection

With the probability of detection available for all valid star entries of the catalogue, the probability of particular star scenes can be derived. The limiting constraint on whether a star scene can be identified is the requirement to observe two stars in a colour image or three in a monochrome image; the marginal detection case. The probability of a scene detection for a given attitude is determined by the following procedure: · All stars that fall within the field-of-view of the sensor for that given attitude form a list of candidate detections · Candidate list is sorted by decreasing probability of detection. 90

5.4. Simulation Results · Starting from the first star in the list, any other stars in the list closer than a minimum distance are removed from the list. This eliminates binaries from the detection, which would be observed as a single star by the detection algorithm. · Probability of a marginal detection for the scene is determined as the product of probabilities of the first two stars for colour sensors and 3 stars for monochrome. · Probability of a "good" pattern detection is the product of the first three stars for colour or four stars for monochrome sensors. Figure 5.7 shows a sample response for an image of the Orion system. It is important to note that despite a significant number of stars within the scene, only a small group achieve detection rates high enough to be considered in the scene. A set of equally spaced points over the celestial sphere determine the attitude vectors for observation [E. SAFF and A. KUIJLAARS]. The sensor performance is the ratio of the number of attitudes where the probability of detection satisfying the marginal or 'good' cases is greater than 99% over the total number of attitudes considered. By definition, any view that is 'good' also satisfies the 'marginal' requirement.

5.4

Simulation Results

This section examines the results gathered from the full sky survey simulations previously described. The examination can be divided into two forms. First, the cumulative detection performance, with regards to sky coverage, compares the overall coverage improvement gained by the measurement of colour information. Second, specific designs consider the specific improvement in spatial coverage over the celestial sphere. Following the analyses of the simulated data, a general design verdict on the detection performance for the proposed CST designs is made. Included within this verdict are possible directions on improving the detection performance beyond what has been established. 91

Chapter 5. Star Detection Trade Study

8

1

6

0.9

4

0.8

0.7 2 Declination [deg] 0.6 0 0.5 -2 0.4 -4 0.3 -6 Probability of Detection

0.2

-8

0.1

-10

74

76

78

80 82 84 Right Ascension [deg]

86

88

90

92

0

Figure 5.7: Star Scene Detection Probability Map

5.4.1

False Detection Rate

The FDR rates are determined for the two types of connected-component arrangements. In both cases, the detection is restricted to cluster sizes of six or more pixels. Figure 5.8 shows the FDRs and bounding curves for a range of raw thresholds. Direct inspection reveals a logarithmic decrease in the FDR for higher thresholds. The pattern within the estimates can be attributed to the discrete nature of the cluster detections. To achieve the desired FDR of 10-2 , k = 2.04 for type four connectivity and k = 2.06 for type eight connectivity (see Section 5.3.1). 92

5.4. Simulation Results
10
-1

Four Label FDR Estimate Four Label FDR Bound Eight Label FDR Estimate Eight Label FDR Bound

False Detection Rate

10

-2

10

-3

2

2.05

2.1

2.15

2.2

2.25 k

2.3

2.35

2.4

2.45

2.5

Figure 5.8: False detection rate estimation.

5.4.2

Detection Sensitivity

From the chosen thresholds, the detection sensitivity for the particular sensor designs are determined. Figure 5.9 shows an example the detection rate as a function of the star photon flux magnitude for a f = 16 mm design with type four connected component labelling. The transition between the successful detections and undetectable stars follows smooth consistent pattern for both the colour and monochrome sensors. Only the absolute photon magnitude changes between the sensors. Assuming a detection rate greater than 95%, the limiting photon flux for the monochrome and colour sensors are mq = 5.0 and mq = 4.75, respectively. For the monochrome sensor, this equates to an 93

Chapter 5. Star Detection Trade Study approximate visible magnitudes of mv = 5.25; consistent with the performance shown by the S3S star tracker.

5.4.3

Comparison of Sky Coverage

To acquire a better understanding of the performance of the monochrome and colour detection requires an analysis of the specific spatial improvement over the celestial sphere. Figure 5.10 shows a map of the star density over the celestial sphere. The high-density sinusoidal band across the celestial sphere is the galactic equator. Figures 5.11 and 5.12 show the coverage of "good" and marginal views over the celestial sphere. Both sensors exhibit a small failure region near (RA = 0h 51m 26s, DEC = -27d 7m 42s) which coincides with the galactic south pole; a particularity low density star region. Table 5.3 shows the complete survey of the possible sensor and detection algorithm configurations considered. Of foremost significance is the improvement shown in the total percentage sky coverage between the colour star tracker designs and monochrome counterpart. For most configurations, the number of 'good' views in the colour designs exceeds the combined number of 'good' and marginal views of the monochrome sensors.

5.4.4

Analysis and Design Verdict

From the results presented above some significant assessments can be drawn about the colour star tracker hardware. Both the CFA and DFP designs showed improvement in sky coverage performance compared to their monochrome star tracker counterpart. This suggests that, assuming equivalent LIS scenarios, a colour star tracker could outperform the monochrome having a better chance of determining initial attitude given any random orientation. Since the performance improvement results from the selection of the colour filters, then the improvement is an inherent property resulting from the addition of star colour. The overall performance of both the monochrome and colour star trackers presented here is nothing truly spectacular for the technology. This can be attributed mostly to 94

5.4. Simulation Results

Table 5.3: Comparative Sky Coverage Performance Survey of Sensor Designs

Detection Type

95

4

8

f (mm) 12 16 20 25 12 16 20 25

Monochrome Good Marginal Total 0.4687 0.1824 0.6512 0.6077 0.1703 0.7780 0.6739 0.1532 0.8271 0.7403 0.1339 0.8742 0.4692 0.1904 0.6596 0.5890 0.1820 0.7710 0.6688 0.1521 0.8210 0.7378 0.1347 0.8725

Additive Colour Good Marginal 0.5541 0.2026 0.6481 0.1898 0.7329 0.1598 0.7730 0.1381 0.5314 0.2098 0.6352 0.1944 0.7120 0.1656 0.7678 0.1370

CFA Total 0.7567 0.8380 0.8928 0.9111 0.7411 0.8296 0.8776 0.9048

Dichroic Prism Good Marginal Total 0.5046 0.2250 0.7296 0.6124 0.2018 0.8142 0.6854 0.1727 0.8581 0.7500 0.1470 0.8969 0.5149 0.2234 0.7383 0.6314 0.1977 0.8291 0.6814 0.1720 0.8534 0.7472 0.1450 0.8922

Chapter 5. Star Detection Trade Study
100 Monochrome Custom CFA Dichroic Prism

90

80

70 Probability of Detection [%]

60

50

40

30

20

10

0

4

4.5

5

5.5 6 Photon Magnitude Responnse, mq

6.5

7

7.5

Figure 5.9: Detection sensitivity rates of catalogued stars. the rather simple detection schemes applied. Improved algorithms could be applied to further refine the detection process. These include: · Thresholding of the arithmetic estimation of integrated intensity as a check to reduce false detections. · Application of spatial filtering to reduce the noise in the image (e.g. PSF convolutions). · Combining multiple, sequential images to increase the photon count relative to the image noise. 96

5.4. Simulation Results

Figure 5.10: Star Density up to mq = 6 at f = 16mm. As these improvements are likely to equally impact both the monochrome and colour detection sensitivities, the intrinsic improvement gained by colour measurement would be retained. Additional algorithm improvements that specifically target the colour properties and sensor technologies, such as: · Correlation between the star images detected from the (tri)dichroic prism filtered colour sensor could reduce the detection threshold for equivalent FDRs. · Direct consideration of the observed colour ratios, identifying false stars since they do not conform to any known catalogue entry. Since these algorithm changes specifically target the colour sensors, the improvements would only further increase the performance gain in shown in colour. The specific topic of maximizing detection performance of colour star trackers will be left for future researchers. 97

Chapter 5. Star Detection Trade Study

Figure 5.11: Detection coverage of the celestial sphere using Monochrome CST. Finally, developing the model of the detection process we chose to ignore some characteristics of the observed star scene image. The characteristics of particular note are vignetting and variation in PSF shape across the detector. Despite leaving these features out of the model, the performance improvements demonstrated remain valid as these non-ideal effects would equally degrade the monochrome sensor performance. For designs directed towards practical on-orbit deployment, these characteristics would need to be included into the sensitivity analysis.

5.5

Conclusions

The performance of the proposed colour star trackers designs show a definitive improvement in raw detection capability compared to an optically and electronically equivalent monochrome designs. Of particular note are the formally unresolvable star scenes, due to insufficient stars, that can now potentially be generate an attitude solution. The 98

5.5. Conclusions

Figure 5.12: Detection coverage of the celestial sphere using CFA-CST. standard "off-the-shelf" colour sensors proved to be drastically insufficient to meet the performance needed to compete with the monochrome sensors. Due the development of the coarse analysis procedure, a larger variety of colour designs can now be investigated without significant amount of investment. More significantly, in none of the proposed designs has any explicit optimization of filters or data correlation been considered. This suggests that colour star tracker detection performance can continue to improve beyond the current results. Attention must still be paid to the fact that the minimum number of stars needed in a colour pattern match (i.e. 2 stars) and that of a geometric pattern match (i.e. 3 stars), does not directly address the question of ambiguity within those patterns. Although increased star detection does not necessarily guarantee a reduction of unambiguous star patterns, the reduction in fundamentally ambiguous star scenes does set the performance framework for the explicit analysis of colour star pattern ambiguity.

99

Chapter 6 Colour Star Patterns
The explicit development of star identification algorithms using colour encompasses a large field of investigation. This can include modification of existing identification algorithms and development of algorithms unique to access of colour information. In a joint preliminary study, [Enright & McVittie 2013] developed initial assessments of colour star pattern ambiguity and proposed a prototype identification algorithm. This chapter extends this preliminary study to assess the ambiguity within star patterns expected from the viable CST designs proposed in Chapter 5. Restricting the study to star pair matching, the potential limits of star identification using colour information can be defined without direct dependence on a particular search algorithm. Additionally, the analysis also provides a useful comparison to the performance of equivalent monochrome pattern identification. The chapter divides into the following sections. Section 2 describes the design of the potential star pattern catalogue; particular emphasis applied to the structure of the star pair feature set. Section 3, through the application of Bayesian statistics, presents of method for quantifying ambiguity within observed star pairs and scenes (i.e. 3 or more stars in FOV). Section 4 describes possible star pair parametrizations, the method for simulating the expected star scenes and quantifying the ambiguity relative to the candidate hardware. Section 5 presents the results of the statistical simulations; with particular emphasis regarding the relative performance to equivalent MST sensors. 101

Chapter 6. Colour Star Patterns

6.1

Pattern Catalogue Design

Designing a catalogue of star patterns requires determining an effective quantifiable representation of the star patterns. The choice of pattern must also consider the methods used to search, compare, and distinguish the star pattern within the catalogue; often achieved by eliminating redundant information and parameters within the pattern representation. This section proposes a possible representation for the star pattern information and considers a method for effective catalogue comparisons.

6.1.1

Characterizing Star Pairs

From Chapter 2, a wide variety of star pattern representations already exist in the literature. Star pattern representations include those composed from star triplets (e.g. side-side-side, side-angle-side, and triangle areas), those with larger star groupings (e.g. flower algorithm and grid algorithm). Introducing star colour characteristics into these pattern representations presents an entire new avenue of research. This study provides the groundwork for these future developments by applying the properties of star colour to the most primitive star pattern available, a star pair. The only geometric feature of a star pair is the angular distance between the two stars. Angular distance between two stars is defined as:

ij = arccos sT i sj

(6.1)

where si and sj are the unit direction vectors observed in an image. While not explicitly considered in this study, computational efficiency can be gained by storing the angular distance as cos ij rather than explicit angle, removing the requirement to calculate the inverse trigonometric function. Adding star colour characteristics into the pattern representation, a star pair pattern contains three unique characteristics: the star colours 102

6.1. Pattern Catalogue Design (one for each star) and the angular distance between the two stars. The star pattern representation can be stated as:

xij = [ i ij j ]T with the colour characteristics defined by the vector:

(6.2)

i = [ bg rg ]i

(6.3)

where bg and rg are the ratios of star colour intensities for star i (see Sections 3.2.2 and 4.2.1). In this instance, the colour characteristic vector, , contains two ratios of colour intensities. However, the colour vector can be easily extended to include an arbitrary number of colour ratios and absolute colour intensities; allowing magnitude to also be a feature of the star pair identity. Using this formulation, the star pair now contains both an angular separation distance and, resulting from the colour, a direction. As a result, a star pair can potentially be uniquely defined within the catalogue of possible star pairs. In the special case where no spectral information is used or available, the star pair vector, xij , degenerates to the classical monochrome angular separation formulation.

6.1.2

Comparison of Star Pairs

Direct comparison of angular distances, such as the case of MST, requires no special treatment. Introducing colour characteristics in the star pair representation no longer allows for simple comparisons since the measurement of angles and colour ratios do not share common units. To resolve this problem, comparison of star pairs can be made using the Mahalanobis distance:

T -1 2 ij = (x - µij )  (x - µij )

(6.4)

103

Chapter 6. Colour Star Patterns where  is the covariance matrix of the estimates and µij is the expected value of star pair being compared. In this form, the angular distance and colour ratios are weighted according to their uncertainty, allowing both measurements to be justifiably used together. Assuming that the angular distance and colour estimates are statistically independent, then the Mahalanobis distance simplifies to a normalized Euclidean distance. Specifically, removing the cross-covariance terms representing the noise matrix as follows:

 = diag

2 2 2    

(6.5)

The variance of the angular distance and colour characteristics can be determined from empirical testing and evaluation (see Sections 3.4.3 and 4.4.2).

6.1.3

Star Pattern Catalogue Entries

The actual star pattern catalogue can be constructed following a simple set of rules for of all the entries. A particular star pair entry in the catalogue, defined as Cij , follows directly from the definition of the star pair representation vector:

Cij = [ i ij j ]T

(6.6)

where the colour ratios and angular distance are determined from available star spectral and astronomical data catalogues (see Chapter 5 - sec. 3.2). For a practical implementation, the catalogue entries can be arranged into a descending order either based on the angular distance or colour allowing for a hash table implementation to quickly eliminate large portions of the catalogue without the need for direct comparisons. To reduce the size of the catalogue, several entries can be eliminated. Star pairs with angular distances greater than the FOV need not be included as they can not practically occur within an image. Star pairs sufficiently close together (e.g. binary pair) can be 104

6.2. Pattern Identification and Ambiguity removed to eliminate the possibility of an observed pair of star PSFs being merged and interpreted as a single star. Formally, any star pair not satisfying the constraint:

FOV  ij  FOV 500

(6.7)

need not be included into the catalogue. The choice of 1/500, while arbitrary, proves to be sufficient for the catalogue of the S3S MST and will be adopted here.

While the majority of stars included within the catalogue, observed using broadband colour filters, have effectively constant spectral properties, a small percentage of stars demonstrate variability in their spectral and intensity emissions (i.e. variable stars). For the analyses presented in this study, the star spectral emission are assumed constant; as is the catalogue of star pairs. In a practical implementation, the spectral emission behaviour of variable of stars are well defined, with the period of spectral oscillation (e.g. greater than 1 h) significantly longer than the update rate of a typical star tracker. As a result, any star pair entry within the catalogue containing a variable would be dynamically defined relative to the current time and date.

6.2

Pattern Identification and Ambiguity

While directly developing a pattern identification algorithm can be useful; to validate the effectiveness of CST, more significant insight can be drawn from analysing the ambiguity within the potential star scenes. This section examines the method for classifying a star pair observation to a particular catalogue entry or group of entries. The pattern identification process and determination of ambiguity within a particular pattern derives from Bayesian decision boundaries. Identification of a colour star scene can be divided into two cases: the two star and multi-star scenes. 105

Chapter 6. Colour Star Patterns

6.2.1

Pattern Ambiguity

Before direct analysis of the pattern matching operation, it is useful to define the particular types of ambiguity. Star scene ambiguity can be defined as any scene for which an identification cannot be uniquely determined with minimum probability. Two major types of ambiguous star scenes can be defined. The first type of ambiguous star scene results from an insufficient number of stars to allow for an identification. For a colour star tracker, a two star scene represents the minimum identifiable case. A monochrome star tracker similarly requires a minimum of three stars. Any fewer stars and the scene cannot be uniquely identified. For example, a monochromatic two star scene cannot be uniquely determined as the sequence of the image stars cannot be identified producing at least two solutions with a roll difference of 180o . Ambiguity scenes of this type do not present significant problems for pattern identification as they fundamentally not be matched, they can be easily flagged with no attitude solution returned. This type ambiguity has already been developed in Chapter 5 and determined primarily by the star tracker hardware. The second type of ambiguous star scene occurs when two catalogue star scenes are sufficiently close to be interchanged. Certain scenes of this type can be easily identified and flagged as ambiguous being nearly identically represented in the pattern catalogue. Partly dependent on the quality of the parameter measurements, outlying measurements can cause a scene to be occasionally misidentified. These scenes are the most detrimental as the incorrect attitude solution would be passed to the attitude and control navigation system as purportedly as correct.

6.2.2

Pair Matching

The classification follows a Bayesian, maximum likelihood estimator [Duda et al. 2001]. A formulation for the generalized Bayesian classifier error then determines the true ambiguity of the two star scene; with the final goal to determine the effectiveness of the binary classifier ambiguity in identifying the scene. The multi-star identification simply extends the two-star case to determine ambiguity for a scene involving more stars. The 106

6.2. Pattern Identification and Ambiguity method presented here, while technically a scene matching algorithm, takes no explicit consideration of false detections and developed primarily as a tool for determining star scenes where a proper, on-line pattern matching algorithm could experience ambiguity in the observed scene. The classifier determines the "best" match for an observed star pair pattern. The classifier, more formally, defines a decision where the catalogue pair with the highest probability of being observed is returned. We can express the classifier as the probability that observation x belongs to star pair ij ; stating the Bayesian theorem as: the probability of being in class Cij , given the observation x, P (x|Cij ) p (Cij ) p ( x)

P (Cij |x) =

(6.8)

where P (x|Cij ) is the probability of x occurring given it came from class Cij , p (Cij ) is the probability of class Cij occurring, and p (x) the absolute probability of the observation x. Assuming a LIS scenario, then all star pairs share an equal probability of occurring within the FOV:

p (Cij ) = 1/NC

(6.9)

where NC is the total number of classes. Substituting (6.9) into (6.8) and expanding the denominator: P (x|Cij ) N1C
Cij

P (Cij |x) =

P (x|Cij )

1 NC

=

P (x|Cij ) Cij P (x|Cij )

The classifier rule then becomes:

gij (x) = argmax (P (Cij |x))

(6.10)

which states that x will be classified based on the match with greatest probability. 107

Chapter 6. Colour Star Patterns From Chapters 4 and 5, the statistics of the star pair observations can be interpreted as normally distributed with known characteristics. A Mahalanobis distance between the observed and catalogue star pair parameter vectors provides an easy method of normalizing the relative contribution of colour and distance information. Expressed as a natural logarithm, the Bayes classifier rule using a Mahalanobis distance mapping rule becomes:

gij (x) = argmax(-

1 x - µij 2

T

1 x - µij - - ij

1 1 log (|ij |) - log (P (Cij ))) (6.11) 2 2

Again, assuming an equally probable chance of the star pair belonging to any one catalogue pair the final term of (6.11) can be removed:

gij (x) = argmax(-

1 x - µij 2

T

1 - x - µij - ij

1 log (|ij |)) 2

(6.12)

Furthermore, assuming a constant covariance matrix for all catalogue star pairs reduces (6.12) to:

gij (x) = argmax(-

1 x - µij 2

T

1 - x - µij ) ij

(6.13)

The resulting rule the chooses the catalogue pair with the minimum Mahalanobis distance to the observation vector.

6.2.3

Scene Matching

To match a star scene only requires extending the pair matching routine to map groups of star pairs. All stars within the scene set are assigned a label, e.g the first star will be labelled a. Stars a and b are considered as the first scene star pair, Sab , with the measurement vector xab . The value xab is compared to the catalogues values to determine 108

6.2. Pattern Identification and Ambiguity the Mahalanobis distance to all possible star pairs. This process repeats for all observed star pair combinations. The candidate scene match is chosen such that all the local star labels match uniquely to the catalogue star labels and minimize the total Mahalanobis distance mapping error. For three stars, a scene match is the catalogue star triplet (i, j, k ) that maximize the decision rule:
T

1 xab - µij xab - µij - gijk (xab , xac , xbc ) = argmax(- 1 ij 2 T -1 1 - 2 (xac - µik ) ik (xac - µik ) T 1 1 -2 xbc - µjk - jk xbc - µjk )

(6.14)

As the star pair catalogue can often be quite large, the number of entries checked can be reduced by making note of the statistics of the measurement vector x. Assume  takes the form of a diagonal matrix (i.e. colour and angular distance are uncorrelated).

6.2.4

Classifier Error

Determining the probability of a star pair or scene being incorrectly identified by extension determines the ambiguity of the scene. Consider the probability of error for an observed star pair that came from catalogue pair Cij . The Bayesian classifier error rate is defined as:

perror =
Cij =Cmax x H ij

P (x|Cij ) p (Cij ) dx

(6.15)

where Hij is the region that the classifier function classifies as Cij and Cmax is the greatest classifier[Duda et al. 2001]. To determine the probability of the incorrect identification occurring, treat each star pair catalogue match as an independent event. As a result, given true scene identity the probability of identifying each pair for the incorrect scene match is known, the probability of incorrectly identifying the scene is the product of the individual error probabilities. Specifically, 109

Chapter 6. Colour Star Patterns

perror =

P (Cmn |xij ) · P (Cmo |xik ) · ... · P (Cno |xjk )  {m, n, o} = {i, j, k }

From this formulation, it is apparent that the probability of error for matching a scene would require incorrectly matching the component star pairs. The probability of incorrectly matching a multi-star scene will be significantly lower than the single star pair observation. As star pair observations take the form of an n-dimensional normal distributions, with varying decision boundaries, no analytical solution for the probability error can be derived [Cox & Wermouth 1991]. Instead, we consider generating an artificial validation set to determine the probability of error in classification.

6.3

Simulation Methodology

To determine the ambiguity measures defined above requires simulating and pattern matching the expected star scenes. This process is divided into three main operations: scene simulation, pattern matching, and ambiguity analysis. Together, these operations define the potential star identification capabilities of the proposed colour star tracker designs developed in Chapter 5. Again, the equivalent monochrome designs are tested in tandem to determine the overall increase in performance provided by adding colour information. The operations are examined in more detail.

6.3.1

Scene Simulation and Identification

In Chapter 5, a dataset was developed of the probability of star detections for given sensor configurations. For a particular attitude, a set of stars are obtained from the intersection of stars within the FOV and exceeding a minimum detection probability; all cases assume 99% or greater. Choosing four stars with the highest probability of detection and brightness creates the set of stars to be matched. The set of stars is transformed into a set of star pair parameter vectors. 110

6.3. Simulation Methodology For each star pair set, the parameter vector is corrupted by the expected noise response of the sensor. Repeating this process multiple times for each star scene forms a basis for analysing the ambiguity expected by a matching routine at that scene. Choosing a sufficiently dense set of attitude vectors evenly spaced over the celestial sphere approximates a random initial LIS start-up condition[Saff & Kuijlaars 1997]. Given a sample image observation set, the pattern matching transforms the observed star parameters into the star pair metric (6.4). Following the matching procedure defined previously, a list of the most likely candidate star pair matches is returned with the probability of the identification. The possible identifications are then compared to the true star identities. Repeating the process for each corrupted image in the set, the probability of correct identification can be founds as the average of the true identifications to the total number of samples in the set.

6.3.2

Ambiguity Assessment

Generating a set of images, N = 102 , any matching technique can be applied a sufficient number of times to determine the probability of that scene being correctly identified. A successful identification occurs when the probability for the given scene being correctly identified is greater than 99%. Combined with the detection sensitivity analysis of Chapter 5, the absolute ambiguity over the celestial sphere is determined.

6.3.3

Sensor Configurations

Following Chapter 5, consider the two colour sensor configurations: DFP and CFA. The DFP uses a two colour model that results in a single colour ratio for each star. Combined with the angular separation distance, each star pair is represented by a three parameter vector. Similarly, star pairs observed on the CFA sensor are characterized by a five parameter vector. This consists of two pairs of colour ratios for each star and the angular distance between the star vectors. 111

Chapter 6. Colour Star Patterns In determining the ambiguity performance, consider two sets of measurement noise statistics: experimental and ideal. Table 6.1 shows the chosen measurement statistics used for the ambiguity analysis. The experimental statistics follow directly from the results obtained from the CFA (see Chapter 3) and the DFP (see Chapter 4) prototype hardware. The ideal measurement statistics represent an order of magnitude improvement over the experimental measurements. At present, the physical hardware at the current level of development cannot achieve this performance level. It does, however, establish a target for long term development and viability of the CST technology.

6.4

Results

This section presents the results of the sky survey simulation for determining pattern matching ambiguity. Three major sensor configurations are examined. First, a conventional MST establishes a performance baseline with which to compare the CST. Second, a CFA-CST is presented based upon the custom CFA filter response . The third design is a DFP-CFA, again based on the custom filter response (see Section 5.2.4). This is followed by a general comparison of multiple sensor configurations to determine impact of colour in star pattern matching ambiguity.

6.4.1

Single Sensor Sky Coverage

Consider the ambiguity survey of a single sensor with the experimental statistics. Figure 6.1 shows a spatial distribution of the scene ambiguity for the MST sensor with a focal length of f = 16 mm. Almost all the MST sensor scenes demonstrate either zero or Table 6.1: Star parameter measurement noise values. Measurement Source Experimental Ideal Angular Distance  2 arctan 2 arctan
0.1pix fl 0.05pix fl

Colour Ratio  5.00 × 10-2 5.00 × 10-3

112

6.4. Results perfect detection probabilities. This property stems from the ambiguity of three star scenes which despite containing only the minimum number of stars needed for a pattern match still provide sufficient information for a unique solution. Figure 6.2 shows the spatial probability survey of correctly identifying the observed star scenes for the CFA sensor. Unlike the monochrome response, the CFA spatial probability distribution demonstrates minor variations particularly in the regions occupied by marginal scenes (i.e. 2 stars). This behaviour is expected as a lone star-pair can have many neighbouring catalogue entries, causing an observation to be misidentified. If the star tracker is allowed to return estimates with less than 99% probability, many additional star scenes can potentially be identified. Consider now the performance of the MST when using the improved statistics, as shown in Figure 6.3. Compared to the previous response, very little improvement has been gained. This results directly form the limiting three star requirement. In contrast, the coverage of CST with the improved measurements increases significantly, as shown in Figure 6.4. This increase is particularly noticeable near the centre, which coincides with the south galatic pole (see Figure 5.10). In this area, while a many attitude exist containing two detectable stars, very few contain three. As result, the CST can capture and identify regions of the sky fundamentally inaccessible to equivalent MST designs.

6.4.2

Design Performance Survey

From the single design considered previously, the performance analysis can be extended to a field of candidate colour star tracker designs. Table 6.2 presents the resulting sky coverage for colour and monochrome star trackers of varying focal lengths. Direct inspection shows that using the experimental star pair measurement statistics with a probability of correct identification of 99% of better, the colour star trackers cannot achieve sufficient sky coverage to match the performance of the monochrome sensor. Even with a reduction in the probability of identification to 90%, produces little significant increase in sky coverage for the colour sensors while the monochrome performance remains relatively unchanged. The performance increase results from the limited number of marginal star scenes for the monochrome sensor. 113

Chapter 6. Colour Star Patterns

90o 67.5 45o
o o

22.5

0o

-180

o

-135

o

-90

o

-45

o

0

o

45

o

90

o

135

o

180

o

-22.5o -45o -67.5o -90o

0

0.1

0.2

0.3

0.4 0.5 0.6 Probability of Correct Identification

0.7

0.8

0.9

1

Figure 6.1: Spatial probability of ambiguity for monochrome sensor, f = 16 mm. When the measurement statistics are assumed to be at a higher level of precision (i.e. ideal estimates). The gap between the CST and MST designs closes to near equal value. There is also a noticeable performance difference between the CFA and DFP, with the CFA ahead. This can be directly attributed to the difference in dimensionality of the star pair metric. Where the DFP only has one colour per star, the CFA has two.

6.5

Analysis and Further Improvements

From the results presented above, several important properties of potential colour star tracker performance can be derived. Assuming optically equivalent designs, the colour star tracker can approach monochrome star trackers in terms of total sky area where a true and unambiguous attitude solution can be found. The absolute performance of the 114

Table 6.2: Comparison of ambiguity in colour and monochrome star tracker designs.

6.5. Analysis and Further Improvements

Sensor Type Monochrome

115 CFA

Dichroic Prism

Focal Length f [mm] 12 16 20 25 12 16 20 25 12 16 20 25

Distribution of Star Scenes Good Marginal 0.4765 0.1820 0.6255 0.1540 0.6655 0.1635 0.7440 0.1280 0.5545 0.2020 0.6515 0.1905 0.7245 0.1620 0.7550 0.1360 0.5125 0.2180 0.6135 0.2050 0.6805 0.1765 0.7500 0.1450

Experimental Unambiguous Scenes P  0.99 P  0.90 0.6215 0.6495 0.7430 0.7685 0.7550 0.8005 0.8025 0.8430 0.5545 0.5545 0.6515 0.6515 0.7245 0.7245 0.7750 0.7750 0.5125 0.5130 0.6140 0.6155 0.6805 0.6810 0.7505 0.7505

Ideal Unambiguous Scenes P  0.99 P  0.90 0.6530 0.6580 0.7710 0.7775 0.8085 0.8235 0.8540 0.8670 0.7030 0.7380 0.7055 0.7590 0.7565 0.7935 0.8000 0.8260 0.5945 0.6490 0.6135 0.6155 0.6955 0.7085 0.7615 0.7700

Chapter 6. Colour Star Patterns

90o 67.5 45o
o o

22.5

0o

-180

o

-135

o

-90

o

-45

o

0

o

45

o

90

o

135

o

180

o

-22.5o -45o -67.5o -90o

0

0.1

0.2

0.3

0.4 0.5 0.6 Probability of Correct Identification

0.7

0.8

0.9

1

Figure 6.2: Spatial probability of ambiguity of CFA sensor, f = 16 mm. star tracker design considered is below practical levels. The gains offered by colour scale with any improvements made to equivalent monochrome star trackers. Since minimizing the total number of ambiguous views fundamentally improves star tracker, star colour in the identification process becomes a potential design feature; regardless of the optics or manufacture of the detector. The pattern matching used in the simulations does not formally constitute a star identification algorithm. However, very little would be required to adapt the identification method into a proper algorithm. The majority of development in this area would centre on efficiency in the pair and pattern matching, particularly searching the catalogue which has increased in size due to the colour information. Specific improvements offered from using colour in the star identification process, while currently limited, do suggest greater potential from the identification process. 116

6.5. Analysis and Further Improvements

90o 67.5 45o
o o

22.5

0o

-180

o

-135

o

-90

o

-45

o

0

o

45

o

90

o

135

o

180

o

-22.5o -45o -67.5o -90o

0

0.1

0.2

0.3

0.4 0.5 0.6 Probability of Correct Identification

0.7

0.8

0.9

1

Figure 6.3: Spatial probability of ambiguity for monochrome sensor, f = 16 mm. · The current evaluation considers a fixed parameter covariance matrix, , rather than a variable response resulting from differences in photon star magnitude, colour, or angular distance. Modelling these additional parameters would allow for a more consistent fit to the PSF response. · The effect could potentially allow bright star pairs, formerly ambiguous due to similar dim star pairs, to remove the ambiguity of the pattern and be uniquely identified. · The current development has not dealt with the topic of false star rejection. As with monochrome star trackers, many methods can potentially identify false stars within a scene. The colour star tracker contains all possible star colour combinations within the on-board catalogue. Observed stars that do not fall within a certain range of colour combinations could be flagged as false stars prior to the pattern 117

Chapter 6. Colour Star Patterns

90o 67.5 45o
o o

22.5

0o

-180

o

-135

o

-90

o

-45

o

0

o

45

o

90

o

135

o

180

o

-22.5o -45o -67.5o -90o

0

0.1

0.2

0.3

0.4 0.5 0.6 Probability of Correct Identification

0.7

0.8

0.9

1

Figure 6.4: Spatial probability of ambiguity of CFA sensor, f = 16 mm. matching phase. A feature that would be unique to colour star trackers and provide additional robustness in the pattern matching phase. · Ambiguity of two star scenes could be further reduced by considering if the identified pair should be within a dense clustering of stars. If no neighbouring stars exist, the identification would be labelled as a false identification and the next best match would be taken. Finally, none of the proposed star tracker designs make use of the other intrinsic star property: visible or photon magnitude. It is already been established that including visible magnitude into the identification process of monochrome star trackers will tend to reduce ambiguity in the observed star scenes. Therefore, combining absolute photon magnitude with colour ratios would allow additional star scenes to be uniquely identified where formerly ambiguous. This feature would be particularly 118

6.6. Conclusions

6.6

Conclusions

Demonstrated in this chapter is both the potential and current limitation in resolving star scene ambiguity by introducing colour. With the current estimation statistics the CST cannot compete directly with equivalent MST designs. However, allowing for additional improvements in the parameter estimation, CST has been shown to approach the performance of the MST. Thereby establishing the framework for the development of true colour matching algorithms.

119

Chapter 7 Conclusion

This thesis investigated the possibility of improving the fundamental performance of star trackers by including the property of star colour in combination with geometric features of star patterns. Together with brightness and position, star colour is an intrinsic feature of any star scene. Star colour thereby provides an additional, independent dimension of information on a star scene that can be used to disassociate otherwise similar stars. This also comes at a loss in star brightness which translates directly to a decrease in the number of stars observed. With fewer stars available, star patterns become more difficult to correctly identify; reducing the percentage of the sky with unique attitude solutions.

7.1

Empirical Findings

Accomplishing the objectives of this thesis produced a significant collection of empirical findings and properties. Collectively, they establish the performance and capabilities, both current and expected, for CSTs. The specific findings are summarized in the following subsections. 121

Chapter 7. Conclusion

7.1.1

Colour Measurement Characteristics

Two practical hardware technologies were considered: CFA and TFP The CFA used adapted monochrome parameter estimation techniques, accounting for the mosaic arrangement of the pixel filters to extract three colours and, by extension, two colour ratios. The ratios revealed a periodic variation due to the mosaic pattern, corrected using a simple spatial weighting factor. A combination of laboratory and night-sky tests demonstrated consistent measurements, showing approximately normal statistical distribution. The TFP creates three simultaneous full-resolution colour scene images. Conventional monochrome parameter estimation techniques were applied to each image independently. Colour ratios formed from the absolute intensities of each image. Again, a combination of laboratory and field tests demonstrated consistent and accurate measurement quality. Together, the CFA and TFP characterize the expected performance of the CST. Both technologies demonstrate the ability to measure colour to a degree capable of distinguishing star classes, but not necessarily the subclass. Between the two sensors, the TFP showed precision in the colour ratio estimates, which can be directly attributed to the higher pixel density compared to the CFA design

7.1.2

Detection Sensitivity Trade Study

Characterizing the detection sensitivity of the CST necessitated the development a method of comparison with MSTs to establish the fundamental improvement or loss imparted by colour measurement. Using the assumption that a false star detection is equally detrimental an achieving a correct attitude solution, a necessary condition for success of a CST was determined. Formally, the combinations of the CST filters must exceed a minimum value in order for greater two star sky coverage to exceed the limiting regions of three star for the MST. For the detectors chosen in this study, the colour filters must exceed a minimum of 72.3% sensitivity. Applying this relation, it was determined that the filter responses for the practical hardware prototypes (i.e. red, green, and blue colours) were insufficient. This prompted the 122

7.1. Empirical Findings design of an additional CFA (i.e. yellow, white, and cyan) and DFP (i.e. yellow and red) filter sets. In both cases, the predicted response exceeded the necessary minimum condition. A trade study between the MST and the two proposed CST was examined for several optical designs; specifically a variation in wavelength. The assessment numerically modelled the star imaging and detection process to determine the expected number of stars that would be within the sensor FOV over an approximately even distribution of views around the celestial sphere. Despite a simple raw threshold and connected component label star detection scheme, the simulations demonstrated a definitive increase in the number of 'good' and 'marginal' views for both CFA and DFP compared to an optically equivalent MST. To correctly simulate the expected detection performance of the different sensor configurations also required the construction of a custom colour star catalogue. Merging the Sky2000 astronomical and Pickles spectral databases, formed a unified star catalogue containing the inertial star position, photon spectral magnitude, and expected colour ratios for the different filter responses. While the catalogue is incomplete for increasing stellar magnitudes, the method deriving the expected colour ratios can be applied to the missing entries with additional stellar database sources.

7.1.3

Colour Star Pattern Ambiguity

Determining the ambiguity of the star patterns prompted the development of a primitive colour pattern matching, extending directly upon the original pair identification technique. Using a basic Bayesian Maximum Likelihood Estimator (MLE), the pattern matching routine was applied to a series of simulated star scenes with the measurements corrupted by parameter estimation noise. Two types of noise were considered: expected statistics as observed from the experimental hardware testing and a set of refined statistics that could be anticipated from improvements in hardware design and PSF modelling. Using the hardware measurement statistics, the majority of the 'marginal' patterns in the proposed CST could not be uniquely identified with sufficient reliability to be deemed 123

Chapter 7. Conclusion unambiguous. When compared to the success rate with the 'marginal' scenes for the MST, current CSTs designs cannot achieve the same total sky coverage. When the refined measurement statistics were considered, a subset of the CST designs demonstrated an increase in sky coverage compared to their MST counterparts. Additionally, many of the lone star pair scene, while unable to meet the 99% probability of correct identification, were able to be correctly identified with a 90% probability.

7.2

Implications to Star Tracker Technology

The introduction of colour features, as developed in this thesis, has been a novel concept in the field of star tracker design. The ultimate goal of improved performance for CSTs over equivalent MST designs has yet to be achieved. Despite this fact, the collection of empirical results already demonstrates independent solutions to many of component issues needed to achieve this goal. These solutions are summarized as follows.

7.2.1

Basic Techniques

Using only basic techniques for parameter estimation, detection, and pattern matching a significant amount of insight into the problem of colour star tracking has been gleamed. Estimates of the colour intensities and ratios depend strongly on the detector construction and PSF model approximation; particularly for the CFA based sensors. Yet, the colour ratio estimates were already approaching the precision necessary for a competitive increase in sky coverage for CST. The detection sensitivity, considering only a raw threshold and pixel clustering technique, achieved consistently greater detection rates for percentage of potentially unambiguous star scenes for the CSTs compared to equivalent MSTs. The ambiguity study showed that many of these potential scenes remained ambiguous. However, the filters were not optimized for the ambiguity but coarsely tuned to satisfy the detection requirements, significant improvement would be expected in this area. 124

7.2. Implications to Star Tracker Technology Only a limited subset of the proposed optical-filter-detector designs showed a reduction in the total number of ambiguous views and only when considering somewhat idealized measurement statistics. The ambiguity assessment considers a star pair matching routine, that while unable to resolve many of the lone star pairs, demonstrated perfect identification of three or more star groups. As the ambiguity analysis did not take into account other star scene features, expanding the pattern matching with particular attention directed towards resolving the two star scenes could see the CST gaining the increased sky coverage predicted by the detection surveys.

7.2.2

Development and Analysis Framework

A significant by-product of this study was the development of a design framework for CST. Included in this framework are assessments of hardware, determining expected detection rates, and estimation of star scene ambiguity. Additionally, this framework also allows for a side-by-side comparison with the expected performance from optically and electronically equivalent monochromatic star trackers. It is from this framework and additional research that colour star trackers could be easily be brought to a level of on orbit deployment.

7.2.3

Forecast of Break-Even Performance

Foremost, the majority of the techniques considered within the body of this (e.g. parameter estimation, detection, and pattern matching) were developed at a basic level on which to establish a foundation for CST operation. As such, the necessary improvements in the quality of the measurement statistics, detection sensitivity, filter design and pattern ambiguity required for the gain in sensor performance could be readily achieved by expanding on the techniques proposed in this thesis. While not achieving the desired improvement in star tracker performance, this study has demonstrated that colour star tracking has significant potential as a technology. Minor improvements to the hardware and algorithms presented could easily see colour 125

Chapter 7. Conclusion star tracker technology achieving this goal of increased unambiguous sky coverage area. Furthermore, if performance above that of a monochrome star tracker can be achieved, the improvement will be independent of the specifics of the design. As result, any new star tracker development project should consider colour as a possible and potentially viable design feature.

7.3

Recommendations for Future Research

The techniques and results developed for colour star trackers in this thesis already show significant promise for the potential of CST. Due to the scope of the work, many potential topics were not explicitly considered but would likely yield further improvements to the current development. The following subsections describe the most promising future research directions for the design and extension of CSTs.

7.3.1

Hardware and Parameter Estimation

The PSF models considered for both the CFA and TFP were approximations to the true response. Refined models of the PSF could improve the precision of the parameter estimates, specifically the colour ratios. The new model should explicitly consider the hardware detector features such as micro-lenses and integration over the active area of the pixel. Also, a thorough modelling of the optics using techniques such as raytracing, Fourier-optics, and high-resolution reconstruction would produce a significantly more accurate representation of the PSF. These improvements would likely yield the best results with the CFA where the colour image sub-sampling is particularly detrimental.

7.3.2

Star Detection Techniques

Several improvements can be put forward for the star detection process in CSTs. A variety of techniques for reducing false detections in MST already exist. One example is 126

7.3. Recommendations for Future Research calculating the summed response around the central pixel of the PSF to eliminate hot pixels. Most of these techniques, however, would likely equally improve both MST and CST designs. A detection characteristic distinct to the CST is the colour ratios, which for most stars only fall within a particular region of possible colours. Any star not residing within the expected ratio regions could be rejected as a false detection. This rejection could allow a lower detection threshold for the CST compared to the MST. The TFP sensor has a unique possibility for improvement. Since each image is statistically independent, a star detection would be required to simultaneously occur within all three images. As a result, lower detection thresholds could be applied relative to a single detector. This could allow more stars to be observed despite each detector only receiving a fraction of the total light of the MST.

7.3.3

Colour Filter Design

The choice of colour filters thus far has been a combination a manufactured specifications or coarsely tuned responses to satisfy the detection requirements. No formal optimization of the filter selection has occurred. In selecting the next arrangement of pass-bands, the detection sensitivity and pattern ambiguity should be evaluated in tandem. Specifically, while reducing the number of marginal and 'good' star scenes to provide more distinct colours, the ambiguity of those remaining should decrease. At present only two and three colour models have been considered. As demonstrated in the results, the increase in colour dimension saw a reduction in the total number of ambiguous star scenes. Therefore, a new filter arrangement for the CFA should consider a four colour model, such as cyan, magenta, yellow, and white. Together producing a possible six ratios, but most likely experiencing some degree of statistical correlation.

7.3.4

Star Identification Techniques

The star identification assessment considered only the basic ambiguity properties of a star pairs. A large variety of star identification techniques developed for MST could 127

Chapter 7. Conclusion be easily expanded to incorporate the colour features of the patterns. From this point, preliminary investigations into computational efficiency using colour can commence. A point of particular interest is the ambiguity of the lone star pair scenes; currently the limiting factor in the success of the CST. Several possibilities exist for reducing the ambiguity of the two star scenes. As mentioned, additional colours can be included to expand the star pair parameter vector. Including, absolute star magnitude or intensity would again decrease scene ambiguity. However, this feature would also have to be applied to MST designs which could redefine the three star limit for those sensors. Star magnitude and pattern density could also be considered as a means of removing invalid matches. Specifically, if a lone star pair is identified as being in a star dense region of sky, the lack of other obvious stars within the image would allow that potential match to be rejected in favour the true identity.

7.4

Conclusion

Colour star tracking has presented a unique and interesting direction for star tracker design and development. From the research presented, it is expected that CST will become a viable piece of sensor hardware and valuable component to many future spacecraft attitude systems. systems

128

Appendix A Geometric Calibration Model
This appendix outlines the model for star tracker geometric calibration. The model is derived from the calibration model of the ST-16 star tracker, which shares most features, including the testing environment, in common with the CST prototypes.

A.1

Model Parameters

Table A.1 summarizes the parameters and constants used in this model. In total, there are 11 intrinsic model parameters and 6 external alignment parameters. If i are unavailable, set them their nominal values. In this case a small constant bias rotation will be present in the sensor calibration.

A.2

Frame Transformations

The basic frame transformations are unchanged from earlier versions of this calibration note, however we do not distinguish between optical and detector frames (i.e., the  parameters from earlier versions of the model have been eliminated). 129

Appendix A. Geometric Calibration Model

Table A.1: Star Tracker Geometric Parameters Parameter Joint Angles Mount Rotations Detector Rotations Lamp Position Focal Distance Nominal Pixel Dimension Y-axis scale factor Radial Distortion Coefficients rlL = f  gy b1 , b 2
T

Symbol 1 ,2 , 3 1 , 2 , 3 1 ,  2 ,  3 rlx rly 1

Typical Values [0, 0, /2] (rad) [0, 0, 0] (rad) 16 × 10-3 (m) 2.2 × 10-6 (m) 1 On the order of of 107 and 103 , respectively 0 [1000, 1250]

Sensor Sensor

Calibration Fit Calibration Fit

Distortion Angles Optical Centre Location

a1 , a 2 m0 , n0

Sensor Sensor

Calibration Fit Yes

130

Parameter Type Position Alignment Sensor Lab Sensor Constant

Basis for value Test input Autocollimator alignment Calibration Fit Test-Stand Alignment Calibration Fit Assumed value

A.2. Frame Transformations

A.2.1

Lab­End Effector Transformation

The rotations from the lab to mount reference frame follows a simple X-Y-Z Euler angle set, but the sense of the first and third axes are reversed. Thus if i is the commanded angle to Joint-i then the transformation is:

CLE

 c2 c3 c2 s 3 s2   = Rx (-1 ) Ry (2 ) Rz (-3 ) =  -s1 s2 c3 - c1 s3 -s1 s2 s3 + c1 c3 s1 c2  (A.1) -c1 s2 c3 + s1 s3 -c1 s2 s3 - s1 c3 c1 c2



Note that for this expression we use the shorthand ci  cos i , and likewise for si . The lamp position is expressed in arbitrary units of the form:

 rlx   rlL =  rly  1 

(A.2)

A.2.2

End Effector­Mount Transformation

This rotation captures a static rotational bias between the rotational platform and the sensor mounting plate. These rotations cannot be determined by the conventional sensor calibration procedure; they must be measured by a special facility alignment procedure. The choice of representation is arbitrary, so for simplicity we adopt another X-Y-Z rotation:

CEM

 c2 c3 -c2 s3 s2   = Rx (1 ) Ry (2 ) Rz (3 ) =  s1 s2 c3 + c1 s3 -s1 s2 s3 + c1 c3 -s1 c2  -c1 s2 c3 + s1 s3 c1 s2 s3 + s1 c3 c1 c2 131



(A.3)

Appendix A. Geometric Calibration Model Nominally, the first two rotations should be near zero, and the third is approximately /2.

A.2.3

Mount-Detector Transformations

This transform takes us from the physical mounting on the interface plate, into the detector. The origin of the detector (and sensor) frames is at the theoretical lens pinhole. We allow an arbitrary tip-tilt-roll rotation between these frames:

CM D

 c2 c3 - c2 s 3 s2   = Rx (1 ) Ry (2 ) Rz (3 ) =  s1 s2 c3 + c1 s3 -s1 s2 s3 + c1 c3 -s1 c2  (A.4) -c1 s2 c3 + s1 s3 c1 s2 s3 + s1 c3 c1 c2 

The translation vector between the centre of rotation and the origin is expressed in the same scale of rl above. It is most naturally expressed in frame D.

rsD

 rsx   =  rsy  rsz 

(A.5)

Roughly speaking all three of these angles should be close to zero.

A.3

Inverse Model

To calculate the star vector, given chief-ray intersection point, we formulate this model in reverse. The calibration model presented here is an inverted version of the model presented by [Wang et al. 2008]. These are the calculations that we actually need to 132

A.3. Inverse Model perform on-line, to determine the unit vectors to the stars. Starting with the detected centroid location, we calculate the detector-plane displacements from the optical centre.

u v

=

x (mc - m0 ) gy y (nc - n0 )

(A.6)

We apply a distortion correction to compensate for the de-centering and prism effects. This is modelled as:

U=

u·f a1 v - a2 u + f

(A.7)

V =

v·f a1 v - a2 u + f

(A.8)

From the intermediate coordinates, we calculate a radial correction.

=



U2 + V 2

(A.9)

B = 1 + b1 4 + b2 2

(A.10)

We then have two points on the ray to the star, the focal point:



 0    0  -f 133

(A.11)

Appendix A. Geometric Calibration Model and the focal plane intersection:



 BU    BV  0 Therefore the direction to the star is:

(A.12)

 BU   rD =  BV  f We can then normalize this vector to arrive at sD .



(A.13)

sD =

rD rD

(A.14)

In operational use we will typically transform this vector to frame M .

134

References
[apt ] "Image Sensors MT9P031I12STM Aptina Imaging," http://www.aptina.com/products/image sensors/ mt9p031i12stm/. .

[Bendinelli et al. 1988] Bendinelli, O., Zavatti, F., & Parmeggiani, G., "CCD star images - On the determination of Moffat's PSF shape parameters," Journal of Astrophysics and Astronomy, Vol. 9, March, 1988, Pages: 17­24. [Bessell 1979] Bessell, M. S., "UBVRI Photometry II - The Cousins VRI system, its temperature and absolute flux calibration, and relevance for two-dimensional photometry," Astronomical Society of the Pacific, Vol. 91, 1979, Pages: 589­607. [Bird & Riordan 1986] Bird, R. E., & Riordan, C., "Simple Solar Spectral Model for Direct and Diffuse Irradiance on Horizontal and Tilted Planes at the Earth's Surface for Cloudless Atmopsheres," American Meteorological Society, Vol. 25, 1986, Pages: 87 ­ 97. [Born & Wolf 2003] Born, Max, & Wolf, Emil, Principles of Optics, Press Syndicate of the University of Cambridge, 7 ´ edition, 2003. [Carroll & Ostlie 1996] Carroll, B. W., & Ostlie, D. A., Introduction to Modern Astrophysics, Addison-Wesley Publishing Company, Inc., 1996. [Chen & Hao 2000] Chen, Y. Z., & Hao, Z. H., "A stellar map identification method suitable for star sensor," Opto-Electronic Engineering, Vol. 27, No. 5, October, 2000, Pages: 5­10. 135

References [Chen et al. 2000] Chen, Y. Z., Hao, S. G., & Hao, Z. H., "Method for star identification using connection cluster," Optics and Precision Engineering, Vol. 8, No. 3, June, 2000, Pages: 217­220. [Cleveland 1981] Cleveland, William S., "LOWESS: A Program for Smoothing Scatterplots by Robust Locally Weighted Regression," The American Statistician, Vol. 35, 1981. [Clouse & Langenbacher 1997] Clouse, D., Padgett C., & Langenbacher, H. "Bayesian decision theory applied to deep sky star identification," . Rapport technique, Center for Space Microelectronics technology Jet Propulsion Laboratory, California Institute of Technology, Pasedena, California, April, 1997. [Clouse & Padgett 2000] Clouse, D.S., & Padgett, C.W., "Small field-of-view star identification using Bayesian decision theory," Aerospace and Electronic Systems, IEEE Transactions on, Vol. 36, No. 3, jul, 2000, Pages: 773 ­783. [Cole & Crassidis 2004] Cole, Craig L., & Crassidis, John L., "Fast Star Pattern Recognition Using Spherical Triangles," AIAA/AAS Astrodynamics Specialist Conference and Exhibit, 2004. [Cole & Crassidis 2006] Cole, Craig L., & Crassidis, John L., "Fast Star-Pattern Recognition Using Planar Triangles," Journal of Guidance, Control, and Dynamics, Vol. 29, No. 1, January-February, 2006, Pages: 64­71. [Cox & Wermouth 1991] Cox, D. R., & Wermouth, Nanny, "A Simple Approximation for Bivariate and Trivariate Normal Integrals," International Statistical Review, Vol. 59, No. 2, 1991, Pages: 263 ­ 269. [Daniele Mortari & Junkins 2004] Daniele Mortari, Malak A. Samaan, Christian Bruccoleri, & Junkins, John L., "The Pyramid Star Identification Technique," NAVIGATION, Vol. 51, No. 3, 2004, Pages: 171 ­ 184. [Davenport 1968] Davenport, P B. A vector approach to the algebra of rotations with applications, 1968. 136

References [Di Stefano & Bulgarelli 1999] Di Stefano, L., & Bulgarelli, A., "A simple and efficient connected components labeling algorithm," Image Analysis and Processing, 1999. Proceedings. International Conference on, 1999, Pages: 322­327. [Duda et al. 2001] Duda, R. O., Hart, P. E., & Stork, D. G., Pattern Classification, John Wiley and Sons, 2001. [Enright & McVittie 2013] Enright, J., & McVittie, G. R., "Color star tracking II: matching," Optical Engineering, Vol. 52, No. 1, January, 2013, Page: 014406. [Groth 1986] Groth, Edward J., "A Pattern Matching Algorithm for Two-dimensional coordinate lists," The Astronomical Jounal, Vol. 91, 1986, Pages: 1244­1248. [Healey & Kondepudy 1994] Healey, Glenn E., & Kondepudy, Raghava, "Radiometric CCD Camera Calibration and Noise Estimation," IEEE Transactions On Pattern Analysis And Machine Intelligence, Vol. 16, No. 3, March, 1994, Pages: 267 ­ 276. [Holst & Lomheim 2007] Holst, Gerald C., & Lomheim, Terrence S., CMOS/CCD Sensors and Camera Systems, JCD Publishing and Spie Press, 2007. [Hubbard 1970] Hubbard, W.M., "The approximation of a Poisson distribution by a Gaussian distribution," Proceedings of the IEEE, Vol. 58, No. 9, 1970, Pages: 1374 ­ 1375. [Juang et al. 2003] Juang, J., Kim, H. Y., & Junkins, J. L. "An Efficient And Robust Singular Value Method for Star Pattern Recognition and Attitude Determination," . Rapport technique, NASA, 2003. [Ketchum & Tolson 1995] Ketchum, E. A., & Tolson, R. H., "Onboard star identification without a priori attitude information," Journal of Guidance, Control, and Dynamics, Vol. 18, March, 1995, Pages: 242­246. [Lee & Bang 2007] Lee, Hyunjae, & Bang, Hyochoong, "Star Pattern Identification Technique by Modified Grid Algorithm," IEEE Transactions on Aerospace and Electronic Systems, Vol. 43, No. 3, November, 2007, Pages: 1112 ­ 1116. 137

References [Levenberg 1944] Levenberg, K, "A method for the solution of certain problems in least squares," Quarterly Applied Math, Vol. 2, 1944, Pages: 164 ­ 168. [Li et al. 2004a] Li, B. H., Zhang, C.Y., Xu, S. W., & Li, H. Y., "Improvement for star map recognition of star sensor with KMP algorithm," Opto-Electronic Engineering, Vol. 31, No. 2, February, 2004, Pages: 19­21. [Li et al. 2004b] Li, B. H., Zhang, Y. C., Li, H. Y., & Xu, S. W., "A star map recognition method of star sensor with KMP algorithm," Opto-Electronic Engineering, Vol. 31, No. 1, February, 2004, Pages: 9­11. [Li et al. 2005] Li, Bao-Hua, Zhang, Ying-Chun, Li, Hua-Yi, & Xu, Shi-Wen, "An autonomous star pattern recognition algorithm using bit match," Machine Learning and Cybernetics, 2005. Proceedings of 2005 International Conference on, Vol. 8, aug., 2005, Pages: 4818 ­4823 Vol. 8. [Liebe 1993] Liebe, Carl Christian, "Pattern Recognition of Star Constellations for Spacecraft Applications," IEEE Aerospace and Electronic Systems Magazine, Vol. 8, 1993, Pages: 31 ­ 39. [Liebe 2002a] Liebe, C. C., "Accuracy performance of star trackers - a tutorial," IEEE Transactions on Aerospace and Electronic Systems, Vol. 38, apr, 2002, Pages: 587­599. Provided by the SAO/NASA Astrophysics Data System. [Liebe 2002b] Liebe, Carl Christian, "Accuracy Performance of Star Trackers - A Tutorial," IEEE Transactions on Aerospace and Electronic Systems, Vol. 38, No. 2, April, 2002, Pages: 587 ­ 599. [Lindsey et al. 1997] Lindsey, Clark S., Lindblad, Thomas, & Eide, Age J., "Method for star identification using neural networks," . Vol. 3077. SPIE, 1997, Pages: 471­478. [Lukac & Plataniotis 2005] Lukac, Rastislav, & Plataniotis, Konstantinos N., "Colour Filter Array: Design and Performance Analysis," IEEE Transactions on Consumer Electronics, Vol. 51, No. 4, November, 2005, Pages: 1260 ­ 1267. 138

References [Markley & Mortari 2000] Markley, F. L., & Mortari, D., "Spacecraft Attitude Estimation Using Vector Observations," Journal of the Astronautical Sciences, Vol. 48, No. 2, 2000, Pages: 359 ­ 380. [McVittie & Enright 2012] McVittie, G. R., & Enright, J., "Color star tracking I: star measurement," Optical Engineering, Vol. 51, No. 8, August, 2012, Page: 084402. [Morgan & Keenan 1973] Morgan, W. W., & Keenan, P. C., "Spectral Classification," Annual Review of Astronomy and Astrophysics, Vol. 11, No. 1, 1973, Pages: 29­ 50. [Mortari & Neta 2000] Mortari, D., & Neta, B., "k-vector Range Searching Techniques," 10th Annual AIAA/AAS Space Flight Mechanics Meeting., num´ ero AAS 00-128, Clearwater, FL., January 23-26, 2000. [Na & Jia 2006] Na, Meng, & Jia, Peifa, "A survey of all-sky autonomous star identification algorithms," 1st International Symposium on Systems and Control in Aerospace and Astronautics, January, 2006. [Padgett & Kreutz-Delgado 1997] Padgett, C., & Kreutz-Delgado, K., "A grid algorithm for autonomous star identification," Aerospace and Electronic Systems, IEEE Transactions on, Vol. 33, No. 1, jan., 1997, Pages: 202 ­213. [Padgett & Udomkesmalee 1997] Padgett, C., Kreutz-Delgado K., & Udomkesmalee, S., "Evaluation of Star Identication Techniques," Journal of Guidance, Control, and Dynamics, Vol. 20, No. 2, March-April, 1997, Pages: 259­267. [Paladugu et al. 2006] Paladugu, L., Seisie-Amoasi, E., Williams, B. G., & Schoen, M. P., "Intelligent Star Pattern Recognition for Attitude Determination: the 'Lost in Space' Problem," Journal of Aerospace Computing, Information, and Commuincation, Vol. 3, 2006, Pages: 538­549. [Pickles 1998] Pickles, A. J., "A Stellar Spectral Flux Library: 1150-25000 A," The Publications of the Astronomical Society of the Pacific, Vol. 110, No. 749, August, 1998, Pages: 863 ­ 878. 139

References [Quan & Fang 2010] Quan, W., & Fang, J., "A Star Recognition Method Based on the Adaptive Ant Colony Algorithm for Star Sensors," sensors, Vol. 10, 2010, Pages: 1955­1966. [Quine & Durrant-Whyte 1996] Quine, B. M., & Durrant-Whyte, H. F., "A Fast Autonomous Star-Acquisition Algorithm for Spacecraft," Elsevier Control Engineering Practice, Vol. 4, 1996, Pages: 1735 ­ 1740. [Quine & Hornsey 2007] Quine, B., Tarasyuk-V. Mebrahtu H., & Hornsey, R., "Determining star-image location: A new sub-pixel interpolation technique to process image centroids," Elsevier Computer Physics Communications, Vol. 177, No. 9, 2007, Page: 700 706. [Roy & Clarke 2003] Roy, A. E., & Clarke, D., Astronomy Principles and Practice, Institute of Physics Publishing, 4 ´ edition, 2003. [Rufino & Accardo 2003] Rufino, G., & Accardo, D., "Enhancement of the centroiding algorithm for star tracker measure refinement," Acta Astronautica, Vol. 53, July, 2003, Pages: 135­147. [Saff & Kuijlaars 1997] Saff, E. B., & Kuijlaars, A. B. J., "Distributing Many Points on a Sphere," The Mathematical Intelligencer, Vol. 19, No. 1, 1997, Pages: 5 ­ 11. [Samaan & Mortari 2006] Samaan, M. A., & Mortari, D., Junkins J., "Nondimensional Star Identification for Uncalibrated Star Cameras," The Journal of Astronautical Sciences, Vol. 54, 2006, Pages: 1 ­ 16. [Scholl 1995] Scholl, M. S., "Star-Field Identification for Autonomous Attitude Determination," Journal of Guidance, Control, and Dynamics, Vol. 18, No. 1, January February, 1995, Pages: 61 ­ 65. [Sheskin 2003] Sheskin, David J., Handbook of Parametric and Nonparametric Statistical Procedures, CRC Press, 3 ´ edition, 2003. [Silani & Lovera 2006] Silani, E., & Lovera, M., "Star identification algorithms: novel approach comparison study," Aerospace and Electronic Systems, IEEE Transactions on, Vol. 42, No. 4, october, 2006, Pages: 1275 ­1288. 140

References [Spratling & Mortari 2009] Spratling, Benjamin B., & Mortari, Daniele, "A Survey on Star Identification Algorithms," Algorithms, Vol. 2, No. 1, 2009, Pages: 93 ­ 107. [van Boozijen 1989] van Boozijen, Roelof H. D. "Automated Star Pattern Recognition," . PhD thesis, Stanford University, 1989. [Wahba 1965] Wahba, Grace, "Problem 65-1: A Least Squares Estimate of Satellite Attitude.," Society for Industrial and Applied Mathematics (SIAM) Review, Vol. 7, No. 3, 1965, Page: 409. [Wang et al. 2008] Wang, J., Shi, F., Zhang, J., & Liu, Y., "A new calibration model of camera lens distortion," Elsevier Pattern Recognition, Vol. 41, 2008, Pages: 607­615. [Zhai & Nemati 2011] Zhai, C., Shao M. Goullioud R., & Nemati, B., "Micro-pixel accuracy centroid displacement estimation and detector calibration," Proceedings of the Royal Society A: Mathematical, Physical and Engineering Sciences, Vol. 467, No. 2136, December, 2011, Pages: 3550 ­ 3569. [Zhang et al. 2008] Zhang, Hua, Sang, Hongshi, & Shen, Xubang, "Fuzzy Decision-Based Star Identification Algorithm Using Star Magnitudes," Computational Intelligence and Design, 2008. ISCID '08. International Symposium on, Vol. 1, oct., 2008, Pages: 116 ­119.

141


