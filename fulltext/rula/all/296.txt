Ryerson University

Digital Commons @ Ryerson
Economics Publications and Research Economics

11-27-2009

Introducing CGE Models to the Classroom Using EXCEL
Amy Peng
Ryerson University

Follow this and additional works at: http://digitalcommons.ryerson.ca/economics Part of the Economics Commons Recommended Citation
Peng, Amy, "Introducing CGE Models to the Classroom Using EXCEL" (2009). Economics Publications and Research. Paper 37. http://digitalcommons.ryerson.ca/economics/37

This Working Paper is brought to you for free and open access by the Economics at Digital Commons @ Ryerson. It has been accepted for inclusion in Economics Publications and Research by an authorized administrator of Digital Commons @ Ryerson. For more information, please contact bcameron@ryerson.ca.

Introducing CGE Models to the Classroom Using EXCEL

Amy Peng1 Ryerson University November 27, 2009

1 Contact :

Department of Economics, Ryerson University, 350 Victoria Street, Toronto, Ontario,

Canada, M5B 2K3. Phone: (416)979-5000 ext. 4795. Email: apeng@ryerson.ca

Abstract

This paper demonstrates how simple general equilibrium models can be solved with the help of Microsoft Excel. Two different general equilibrium models for tax incidence analysis are used as illustrative examples. The methods presented here are intended to be beneficial to both students and teachers working with general equilibrium theory in the classroom and can easily be extended to various policy analysis term projects. The techniques presented here are simple and effective tools for inclusion in any student's toolkit. Key words: Excel, Solver, General Equilibrium, Optimization, Newton's Method JEL classification: A22, A23, C61, D58

The history of general equilibrium (GE) theory can be traced back more than 100 years to the work of Leon Walras (1874). However, only recently have computable general equilibrium (CGE) models become widely used in policy applications1 . Since GE models are often thought to be too complicated to implement in a classroom setting and GE related computing packages are relatively expensive with significant learning curves, only a handful of instructors have taken CGE models into the classroom (for example, Professor Peter Wilcoxen at Syracuse University). This paper demonstrates how to build and solve simple CGE models using standard features in EXCEL. It is important to point out that there is growing need to expose students to applied GE analysis. These models are not only an important part of applied economic research, they have been widely adopted by different levels of federal and provincial/state governments and the private sector as a useful tool for tax and environmental policy analysis. I have surveyed a number of economics instructors in terms of their teaching methods related to GE models. For those who have incorporated some kind of general equilibrium theory into their intermediate/advanced Micro (mostly undergraduate) courses, none of them have considered showing applications of the theory in simplified but practical settings. It is understandable that students who lack analytical math skills cannot easily understand the complicated structure of such models, the calibration process and the solution techniques used in applied GE models. However, teaching the abstract form of GE models, and existence proofs, involves even deeper mathematical sophistication and is of little practical relevance to non-specialists.
1

A brief historical survey of developments in GE theory and CGE applications including Jones (1965),

Scarf (1969), Shoven and Whalley (1984, 1992) may be of interest to students.

1

When faced with students with little programming experience (in software such as Matlab or SAS), instructors feel that it is necessary to avoid introducing computable solutions to economic problems, especially in the case of general equilibrium analysis, which typically only receives two or three weeks of coverage and usually at the end of the semester. If we could adopt an easy-to-use platform, such as EXCEL, to show how to construct simple GE models for policy analysis, it would give students an opportunity to fill in the gap between the formal theory and numerical reality of practical general equilibrium analysis. Teaching economics with EXCEL has received growing attention. For example, studies such as Barreto (2001), Cheng and Fan (2003), Tohamy and Mixon (2003) and Naevdal (2003) are important examples of this trend2 . The models I choose to demonstrate in this paper are 1) an example in the review by Shoven and Whalley (Journal of Economics Literature, 1984) and 2) a teaching example by Wilcoxen on the implementation of the Harberger's (1962) Model 3 . The first example is very straightforward and students (readers) who are familiar with basic spreadsheet calculations and the EXCEL tool "Solver" can easily implement it. The second example demonstrates the use of Newton's method as a solution technique in computable general equilibrium models which involve some simple Macro/VBA programming. I choose these two studies based on two considerations4 : 1) both studies are well-known and provide benchmarks upon which our results can easily be compared; 2) I choose the tax policy area since it is easy for students to relate to and we can draw important
2

A

list

of

papers

using

EXCEL

to

teach

economics

can

be

found

at

http://econltsn.ilrt.bris.ac.uk/advice/spreadsheets.htm
3 4

http://wilcoxen.cp.maxwell.syr.edu/pages/371.html Although, this framework can be easily extended to more complicated examples of computable general

equilibrium models, such as the examples given in Kehoe and Kehoe (1994)

2

policy implications from the results. The methods I present here are used in teaching a math review class for incoming master's students majoring in economics. The math review course is a preliminary course that is intended to acquaint students with some mathematical and economic methodologies typically used in graduate teaching. I usually spend a 3-hour lecture (in a computer lab) showing students the general framework of the CGE model and provide some spreadsheet examples. At the end of the class, quite a few of the students have indicated that this method is very effective and greatly improved their understanding of GE theory since they were given an opportunity for hands-on work with the model changing different parameter values and finding numerical solutions. For instructors who are interested in teaching GE theory and its applications, I also suggest a term paper be assigned to the students following the lectures. This will offer students an opportunity to improve their analytical skills.

1

CES Technology Model

The CES technology model corresponds to the original Arrow-Debreu model, elaborated on in Arrow and Hahn (1971) and then introduced as an applied study by Shoven and Whalley in their publication "Applied General - Equilibrium Models of Taxation and International Trade: an Introduction and Survey" in the Journal of Economics Literature (Vol. XXII, 1984). In this economy, we have two final goods (manufacturing and nonmanufacturing), two factors of production (capital and labor) and two types of consumer (rich, capital owners, and poor laborers). Consumers maximize their CES utility function U =
c

" 2 X
i=1

c ai

1 c

·

c Xi

 c -1 c

c #  - 1 c

(1)

3

subject to household budget constraints
c c + P2 X2  PL Lc + PK K c = I c P1 X1

(2)

and the firms minimize their production costs subject to their CES production technology  ¸  - i  i -1  i -1 i 1 i i + (1 -  i )Ki Qi = i  i Li A list of parameters is given by c i c i i i Ic Pi PL,K share parameters i = 1, 2 substitution elasticity scale parameter, i = 1, 2 distribution parameter, i = 1, 2 elasticity of factor substitution, i = 1, 2 income of consumer c price of good i price of labor and capital respectively (3)

Lc , K c consumer's endowment of labor and capital Utility maximization subject to budget constraints given the following product demand functions Xic =
c c iI

Pic (c 1 P1

(1- c )

+ c 2 P2

(1- c )

)

(4)

similarly, factor demands can be derived from cost minimization:
1 Li = - i Qi

"

 i Pk  i + (1 -  i ) (1 -  i )PL 



i ¸(1-i ) # 1- i

(5)

and

1 Ki = - i Qi (1 -  i ) +  i

"

(1 -  i )PL  i PK

i ¸(1-i ) # 1- i

(6)

4

The equilibrium conditions in the models are found by choosing all prices {P1 , P2 , Pk , PL }
1 1 2 2 and quantities {X1 , X2 , X1 , X2 , K1 , K2 , L1 , L2 } so that (1) Factor Markets clear

K1 + K2 = K L1 + L2 = L (2) Goods Markets clear
1 2 X1 + X1 = Q1 1 2 + X2 = Q2 X2

(7) (8)

(9) (10)

and (3) Zero Profit Conditions are met: PK K1 + PL L1 = P1 Q1 PK K2 + PL L2 = P2 Q2 (11) (12)

In actuality, only the relative price of capital needs to be defined as the product prices come from the zero profit conditions. In order to use EXCEL's "Solver" to find an equilibrium solution to the model we consider this problem as an optimization program. We can minimize the sum of three market clearing conditions (Factor and Goods market demand minus supply equals to zero as well as zero profit condition) by changing our choices of prices and quantities. The first step is to set up the appropriate parameter values. In order to compare my results, I use the same parameter values as in Shoven and Whalley (1984, table I, p1011). The household and production parameters are set up in the spreadsheet as Table 1 Insert Table 1 here The second step is to set up the minimization problem as in Table 2: Insert Table 2 here 5

I have organized the minimization problem into three sections: solution variables (A26:B31), market clearing conditions (A33: D45) and the minimization cell (D46). The problem can be interpreted as minimizing the sum of square errors of three market-clearing conditions by choosing solution variables {Pk , Q1 , Q2 }. I choose to select optimal values of Q1 and Q2 instead of factor demand and production demand variables specified in equation (1) to (12) to simplify the setting. PL is normalized to 1 as in Shoven and Whalley (1984). Since there are 3 variables to solve, I have specified them into three market-clearing equations so that the system is just identified. The supply (or TR) and demand (or TC) are calculated as follows: Insert Table 3 here Table 3 shows the spreadsheet section which defines the calculation process for the general equilibrium conditions. Formulas are input based on equation (1) to (12). For example, cell 28 specifies the capital demand in equation (5) using all the parameters and variables that I have already set up in Table 1 and 2. (Cell B22, C22 and D22 are specified in Table 1; Cell B29 and B30 are the solution variables specified in Table 2). Factor supply is simply the capital and labor endowments from the households. Product demands are calculated
c c based on equation (4) and the variable P I , I c , P1 ,and P2 are price indices and income

functions (specified in equation (2) and (4)) used in the calculation of product demands. Product supplies are given by production amounts {Q1 , Q2 } and Total Revenues and Total Costs are given by equation (11) and (12). In Column I, I sum up the factor demand and product supply for both manufactured and non-manufactured goods, factor supply and product demand for both rich and poor households and total income from the production process.

6

The final step is to use "Solver" to solve the problem: Insert Figure 1 here The Target Cell reference is set to cell D26 which represents the minimization equation and the Changing Cells are the solution variables (B27:B31). In Table 2, I have set up the starting values, I choose to set all price variables to 1 as the starting values. If we used up all the capital (25 units) and labor (60 units) in the economy to only produce manufactured goods (based on equation (3)), we can produce approximately 66 units, so I have set the starting value for Q1 as 66 units and Q2 equal to 05 . I have further specified a constraint in the "Solver" utility so that all the solution variables are greater than or equal to 0. Insert Table 4 here The exact values after the Solver process finished are given in Table 4. As can be seen, at the optimal solution, all the market-clearing conditions are met. The equilibrium solutions calculated from the "Solver" application are exactly the same as reported in Table 2 in Shoven and Whalley (page1012, 1984). The manufactured goods are selling at a higher price than the non-manufactured goods and the economy will produce more non-manufactured goods. All capital and labor is used up. The "poor" household will receive a higher income than the "rich" household. To illustrate how a general-equilibrium model can be adapted for policy evaluation, Shoven and Whalley further incorporate a tax policy regime into their baseline model. For a given tax program (it could be a tax imposed on capital, labor or manufactured/nonmanufactured product), I need to modify the baseline model to incorporate these changes.
5

We could choose other starting values for the above specified equations. However, the starting values

need to be reasonable, otherwise, the system may converge to corner solutions with no production or not coverage at all.

7

The example shown in Shoven and Whalley's paper is based on a 50 percent tax rate on capital income generated in the manufactured goods sector. I would like to present a more generalized tax-policy model which includes seven tax parameters. Insert table 5 here t1 and t2 are taxes imposed on manufactured and non-manufactured products respectively, tL and tK are taxes imposed on labor and capital,  is a output tax and  k1 and  k2 are taxes imposed on capital income generated in manufactured and non-manufactured product sectors. I also add a new parameter  in the household parameter section to indicate the distribution of tax revenue6 . As in Shoven and Whalley, I assume that the rich household receives 40 percent or the tax revenue with the remaining 60 percent going to the poor household. In order to incorporate the tax policy parameters, I need to modify equations (4) to (6) as follows: Xic = and I c = (1 - tL )PL Lc + (1 - tK )PK K c i " ¸(1-i ) # 1-  i  i (PK +  Ki ) -1 Li = i Qi  i + (1 -  i ) (1 -  i )PL and "  (1 -  i )PL  i (PK +  Ki )
i ¸(1-i ) # 1- i

c c iI (1- c ) ) + c (t + P )(1-c ) )] Pic [c 2 1 (t1 + P1 ) 2 2

(4a)

(2a) (5a)

1 Ki = - i Qi (1 -  i ) +  i
6

(6a)

In this case, the government simply collects and redistributes revenue. In other models, the government

may also consume goods and services.

8

Total revenue and total cost functions change to (1 +  K1 )PK K1 + PL L1 = (1 -  )P1 Q1 (1 +  K2 )PK K2 + PL L2 = (1 -  )P2 Q2 (11a) (12a)

Given the above parameters, the total tax revenue the government collects is given by the sum of the tax from the consumer T c = P (ti Pi Xic )+ tL PL Lc + tK PK K c and from the producer P ( Pi Qi +  ki Pk Ki ).

of manufactured and non-manufactured products T s =

I assume the same values of the parameters and exogenous variables as given in the baseline model. In order to solve the model including the tax policy parameters, I add a new solution variable T to the minimization problem and an additional constraint that T is equal to the total revenue specified above. Table 6 illustrates the modified minimization program. Insert Table 6 here As can be seen, the tax variables are added in cell B32 and the new constraint is added in row 48. Then we simply run the "Solver" utility again. The new equilibrium solution is shown in Table 7. Insert Table 7 here Comparing Table 4 and Table 77 , one can illustrate how a simple general equilibrium framework can be used in tax policy analysis. After a 50 percent tax on manufacturing capital is imposed, the marginal cost of capital increases, leading to a higher price for manufactured products (1.474 vs. 1.399) and a lower price for non-manufactured products (1.093 vs. 1.105)
7

Our results in Table 7 slightly differ from the numbers reported in Table 3 of Shoven and Whalley (1984,

p1013). Some form of calculation or transcription error is present in the Shoven and Whalley results such that the market clearing conditions are violated.

9

and the price of capital after tax falls (1.153 vs. 1.373). In the household sector, the rich household, which owns capital, receives lower income so its demand for both manufactured and non-manufactured goods decreases. The poor household receives higher transfers of tax revenue from the government, its income rises and demand for both manufactured and nonmanufactured goods increases. Due to a lower price and a lower demand for manufactured goods, total revenue from manufactured goods also falls and only 2.428 worth of taxes are collected8 . A frequent question policy makers ask is whether or not a proposed policy is welfare improving. We can utilize widely employed measures to follow up on the above analysis. The measures used here are Hicksian compensating variation and equivalent variation (CV and EV) associated with the household utilities and incomes before and after the tax policy at their equilibrium solutions. CV is given by
U A -U B A I , UA

superscripts A and B denote "After"

and "Before" the policy changes. CV tells how much income is lost or gained compared to utility level before the change. EV is given by
U A -U B B I , UB

so we use the income and utility

level before the change as the base value. For a tax policy to be welfare improving, we would observe CV and EV having a positive sign. The result of the simple welfare analysis is reported in Table 8. As can be seen, although the capital tax has increased the income of the poor household, the total effect on welfare is a loss. This is due to the fact that this tax policy cannot raise enough tax revenue to distribute to the poor at the same time, it has also lowered total production of manufactured goods in the economy, which in turn, substantially affects income and the utility of the rich.
8

Naively, a student may think that a 50 percent capital tax will generate half of the capital income in

the baseline case (0.5 × 1.373 × 6.212 = 4.265). However, only 2.428 is collected as tax revenue. This is an opporunity for the class to discuss distortions introduced by the tax system.

10

Insert Table 8 here After introducing the model, we can further ask students to experiment with the model by changing parameters and initiate group discussions9 . For example, if we change the endowment of capital and labor for the poor and the rich, or the elasticity of substitution of the two products, the corresponding equilibrium solution will change and will result in different welfare values. We also can ask students to change the tax parameters to conduct further policy analysis. For example, instead of a 50 percent capital tax on the manufactured product, students can simply impose the 50 percent tax on capital used in both manufactured and non-manufactured products, or on output or on the manufactured product itself. They can see easily if taxes are imposed on capital used to produce the non-manufactured product, it will increase tax revenue, but still lead to welfare losses. However, a 50 percent output tax can increase the price of both products substantially, raise tax revenue substantially and through the transfer program, increase the income of both rich and poor. Although there is no welfare loss at the society level, poor households can afford smaller amounts of manufactured and non-manufactured products and their utilities fall. We can easily separate students into different groups, and ask them to discuss the pros and cons of different tax policies and ask them to provide comments and suggestions to improve the design of the tax system. Therefore, a simple CGE model is a very effective teaching tool. If we allow students to engage in constructing and experimenting with the model, instead of lecturing based on mathematical equations, it will enhance their analytical abilities especially as it relates what they have learned to a more practical setting.
9

All of the results for the following discussion questions are available upon request.

11

2

The Harberger Model

The Harberger model was originally developed by Arnold C. Harberger (1962, the Journal of Political Economy). The specification I am using here is based on the computable version developed by Peter J. Wilcoxen (2005, Syracuse University). The documentation for this model is available at http://wilcoxen.cp.maxwell.syr.edu/pages/2141/harberger-doc.pdf as maintained by Professor Wilcoxen. The Harberger model is very similar in setting as the CES model in the previous section. I still use a CES production technology in two business sectors X and Y, X is the capital intensive sector and Y is the labor intensive sector. The cost of capital may vary by sector (r, the rental rate of the capital, is the same for both sectors apart from the fact that the capital tax rates may be different for different sectors). Households also have CES utility functions, but instead of two, we have four types of households A, B, C and D. A and B are "rich" households which own both labor and capital. C and D are "poor" households which own only labor. Four types of households have different preferences: A and C have preferences for the capital intensive product X, while B and D have preferences for the labor intensive product Y. Government, the fifth household "G" can impose different taxes : a tax on capital, output or income with the total revenue given by the sum of the taxes collected from different sectors. In this model, the government uses tax revenue to purchase goods for its own consumption. In equilibrium, we choose appropriate prices and quantities so that factor markets and product markets clear. Since the basic set up of the model is very similar to the CES model above, I will not waste space and the reader's time to explain how to fill in the spreadsheet with all the parameters, variables and formulas again. The detailed spreadsheet and its explanation can be found in Appendix 1. It demonstrates that, we can choose to solve for the price of 12

capital (rental rate, r) and the quantity of production from sector X (qx )and sector Y (qy ) by minimizing the sum of square errors of three market conditions: capital market equilibrium and two-product market equilibrium. This model can also be easily solved using "Solver" as in the previous case. However, for a more advanced level class, students may be interested to see how the equilibrium can be reached through alternative methods. This model can be used as a perfect example to demonstrate how to use Newton's method to compute the equilibrium solutions. The general concept of Newton's method is easy to illustrate: Insert Figure 2 here Assume a function f (x) actually has a root. In order to find the root of f (x), construct a tangent line through the point (X0 , f (X0 )) with the slope f 0 (X0 ). This line intercepts the x - axis at the point X1 which may be a better approximation to the root than X0 . We iterate according to the relation Xn+1 = Xn -
f (Xn ) f 0 (Xn )

until convergence occurs. In the case

of the Harberger model, there are three variables to solve for, the rental rate of capital, r, and the outputs qx and qy . Unlike the univariate case above, x is the vector of (r, qx , qy )0 and f (x) is a vector valued function of equilibrium conditions. The derivative is replaced by its multivariate analogy, the Jacobian. The set up of the model is illustrated in Table 9. I used a centered difference formula to approximate the partial derivatives (cell B51: H53) with a step size of 0.02. The partial derivative estimates (H51:H53) are copied into the corresponding columns of the Jacobian matrix (B57:D59). I then use an EXCEL matrix function to invert the Jacobian (B64:D66). The vector dx is calculated based on the rule dx = -J -1 (Xn )f (Xn ) (see cells F64:F66). Finally Xn+1 is updated using Xn+1 = Xn + dx

13

(see cells H64:H66)10 . The above procedure completes one Jacobian iteration step. In order to automate the iteration step, a simple VBA Macro program is used to construct the Jacobian matrix and shuffle numbers between designated cells. The detailed program can be found in Appendix 2. Insert Table 9 here An iteration step starts with a Macro key combination of CTRL-j, students will be able to observe how the solutions are reached through each iteration. With the starting value set to (1, 100, 100)0 , the program converges within 10-15 iteration steps. After setting up the model, we can conduct different kinds of policy analysis to compare any baseline model and alternative tax schemes (please refer to appendix 1, cells B6:D11). I chose a similar tax policy as in section 2 - imposing a 50 percent capital tax on the capital intensive industry X, however in this case, the government will keep all of the tax revenue and use it for its own consumption. The solution is obtained by taking Jacobian steps, by pressing CTRL-j, until convergence occurs followed by CTRL-s to copy selected statistics to the analysis page. Once the base and alternative case have been solved (and statistics copied to the analysis page) using CTRL-r will calculate and report various welfare measures. The summary of the experimental results are calculated by VBA Macro and reported in Table 1011 . Insert Table 10 here The baseline case (no capital tax) is compared to the alternative case (50 percent capital tax). The first section of the results shows the price and quantity variables before and after imposing the tax. As can be seen, the price of the capital-intensive product X is increased while the price of the labor-intensive product Y is decreased, in the meantime, output of X
10 11

 is used to smooth convergence by taking smaller steps than would otherwise be called for. The detailed program can be found in Appendix 3.

14

is falling while that of Y is rising. Row 8 to Row 10 show three different kinds of price index measures, Paasche, Laspeyres and Fisher price indices. All of them indicate rising inflation after the tax change. Based on the total output and price index, we can calculate how real GDP is affected by the tax policy change. Row 19 to 21 report that although nominal GDP is increased from the baseline model to the alternative case, there is a loss of real GDP due to the rising price of capital intensive product X. Lastly, I also compute the welfare change for both cases. In order to take into consideration the effect of the price and output changes, I choose a different approach from the previous section. Equivalent Variation (EV) is calculated as £ ¤ 1 0 1- 0 1- - -1 EVi = (Px ) + (1 - )(Py ) ui , superscript 0 refers to the base case prices, and Compensating Variation (CV) is calculated as £ ¤ 1 1 1- 1 1- - -1 ) + (1 - )(Py ) ui , superscript 1 refers to the alternate case prices. CVi = (Px Column B and C report the utility changes from the baseline case to the alternative case. Imposing the capital tax has lowered the utility level of households A, B and C. The utility loss of A and B comes from their income loss resulting from the capital tax and an additional utility loss for A and C comes from their consumption loss on the capital intensive product X. It is not hard to show that both EV and CV have a negative sign for households A, B and C but A has the biggest welfare loss. The only household type that benefits from the tax change is household D (as well as the government sector.) However, a deadweight loss incurs since the sum of the EVs or CVs is negative which indicates that there is an overall deadweight loss resulting from this tax change. To further this analysis, one could ask students to plot out the utility maximization 15

problem of the households from this excise. Figures 3 and 4 show an example for this question. Given the amount of good X and Y consumed, we can easily calculate the utility and budget constraint based on the parameters chosen above. The solid curves represent the baseline case while the dotted curves represent the alternative case. Since household A and B have the same endowment, their utility functions are subject to the same budget constraint. Given the budget constraint and household preferences, household A will always consume more of X than Y and household B will always consume more Y than X. Similarly, households C and D follow the same pattern. Imposing a capital tax of 50 percent is equivalent to a price increase so the budget constraints rotate down. We can observe that the indifference curves of households A, B and C all shift down while D's shifts upward moderately, illustrating the fact that it is the only household that is better off as a result of this tax change. This is primarily due to the fact that household D does not care as much about the taxable good as the other households do. We can also draw the conclusion that the tax burden does not only affect households which own the taxable factor, it also affects households who have preferences for the goods that depend most on that factor. Tax incidence is more complicated than the statutory incidence would otherwise suggest. This provides another excellent opportunity for class discussion.

3

Conclusion

Computable general equilibrium models have received growing attention from policy makers and academic researchers. However, in the past, teaching general equilibrium theory often focussed on a more abstract approach based on difficult mathematical equations and reason-

16

ing. Such an approach affords students lacking programing skills little chance to experiment with a computable general equilibrium framework and develop improved understanding of what is being taught. This paper provides a simple method to illustrate the use of general equilibrium models in tax policy analysis with the help of EXCEL. Two classic models are introduced and solved with two alternative methods: optimization based on the "Solver" and an iterative solution using a multidimensional Newton's method. Since EXCEL is one of the most widely used applications in the world, and it has an user friendly interface and tools for great graphic presentations, students or researchers will definitely benefit from adopting the method presented here to further their understanding of general equilibrium theory and to conduct simple policy analysis.

References
[1] Barreto, Humberto (2001), "Teaching Comparative Statics with Microsoft Excel", Journal of Economic Education, Vol. 32, No. 4, p397. [2] Cheng, Wai-yan and C. Fan (2001) "Comparison Study of Different Implementations of Derivative Pricing Models", Journal of Economic Education, Vol. 32, No. 2, p192. [3] Harberger, Arnold C. (1962), "The incidence of Corporation Income Tax", Journal of Political Economy, Vol. 70, No. 3, p215-240. [4] Jones, Ronald W. (1965), "The Structure of Simple General Equilibrium Models," Journal of Political Economy, Vol. 73, No. 6, p 557-72.

17

[5] Kehoe, Patrick J. and Timothy J. Kehoe (1994), "A Primer on Static Applied General Equilibrium Models," Federal Reserve Bank of Minneapolis Quarterly Review, Spring, Vol. 18, No. 1. [6] Naevdal, Eric (2003), "Solving Continuous-time Optimal-Control Problems with a Spreadsheet", Journal of Economic Education, Vol. 34, No. 2, p99-121. [7] Scarf, Herbert (1969), "An Example of an Algorithm for Calculating General Equilibrium Prices," American Economic Review, September, Vol. 59, No. 4, part 1, p 669-77. [8] Shoven, John B. and J. Whalley (1984), "Applied General-Equilibrium Models of Taxation and International Trade", Journal of Economic Literature, Vol. XXI, p1007-1051. [9] Shoven, John B. and John Whalley (1992), Applying General Equilibrium, Cambridge University Press. [10] Tohamy, Soumaya M. ad J. W. Mixon, Jr. (2003), "Lessons from the Specific Factors Model of International trade", Journal of Economic Education, p139-150. [11] Wilcoxen, Peter J. (2005), "A Numerical Implementation of the Harberger Model", http://wilcoxen.cp.maxwell.syr.edu/pages/2141/harberger-doc.pdf.

18

Table 1: Household and Production Parameters A 14 Household Parameters 15 c 16 Rich Households 17 Poor Households 18 19 20 Production Parameters 21 22 23 i Manufacturing Nonmanufacturing B C D E Kc 25 0 F Lc 0 60

 1c
0.5 0.3

 2c
0.5 0.7

c
1.5 0.75

i
1.5 2

i
0.6 0.7

i
2 0.5

Table 2: The Minimization Problem A Sol'n Variables P1 P2 PK Q1 Q2 B Values 1 1 1 66 0 C D

26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44

Goods Market Eq'm i Supply 1 =G37 2 =H37 Factor Market Eq'm i Supply K =I31 L =I32 Zero Profit Condition i TR =G39

Demand =I34 =I35

Minimization =B35-C35 =B36-C36

Demand =I28 =I29

=B40-C40 =B41-C41

TC =G40 SSE log10 SSE =B45-C45 =SUMPRODUCT(D35:D45,D35:D45) =LN(D46)/LN(10)

45 1 46 Minimization 47

Table 3: Calculating the Market Clearing Conditions

26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47

F Variable Factor Demand Ki Li Factor Supply c K L Product Demand X1c X2c Product Supply Qi Profit Maximization TR TC Other related variables PI Ic P1
c c
c

G

H

I

Manufacturing Nonmanufacturing Sum =B22^(-1)*B30*(C22*((1-C22)*1/C22/B =B23^(-1)*B31*(C23*((1-C23)*1/C23/B=G28+H28 =B22^(-1)*B30*(C22+(1-C22)*(C22*B2=B23^(-1)*B31*(C23+(1-C23)*(C23*B2=G29+H29 Rich Poor =E16 =E17 =G31+H31 =E17 =F17 =G32+H32 Rich Poor =B16*G43/G44/G42 =B17*H43/H44/H42 =G34+H34 =C16*G43/G45/G42 =C17*H43/H45/H42 =G35+H35 Manufacturing Nonmanufacturing =B30 =B31 =B27*B30 =B29*G28+1*G29 =B28*B31 =B29*H28+1*H29

=B16*B27^(1-D16)+C16*B28^(1-D16) =B17*B27^(1-D17)+C17*B28^(1-D17) =1*F16+B29*E16 =1*F17+B29*E17 =G43+H43 =B27^D16 =B27^D17 =B28^D16 =B28^D17 =(B16^(1/D16)*G34^((D16-1)/D16)+C1=(B17^(1/D17)*H34^((D17-1)/D17)+C1

P2 c U

Table 4: Equilibrium Solution for the CES Technology Model

26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44

A Sol'n Variables P1 P2 PK Q1 Q2

B Values 1.399 1.093 1.373 24.943 54.378

C

D

E

Goods Market Eq'm i Supply Demand Minimization 1 24.943 24.942 0.000 2 54.378 54.378 0.000 Factor Market Eq'm i Supply Demand K 25.000 25.000 L 60.000 60.000 Zero Profit Conditions i TR 34.897 TC 34.897 0.000 SSE 2.30391E-09 log10 SSE -8.637534191

0.000 0.000

F G H I Variable Factor Demand Manufacturing Nonmanufacturing Sum 6.212 18.788 25.000 Ki 26.366 33.634 60.000 Li Factor Supply Rich Poor Kc 25.000 0.000 25.000 c L 0.000 60.000 60.000 Product Deman Rich Poor 11.515 13.428 24.942 X1c X2c 16.674 37.704 54.378 Product Supply Manufacturing Nonmanufacturing 24.943 54.378 Qi Profit Maximization 34.897 59.439 TR TC 34.897 59.439 Other related variables PI 0.901 1.042 Ic 34.337 60.000 94.337 P1
c c

1.655 1.143 27.872

1.286 1.069 50.891

45 1 46 Minimization 47

P2 Uc

Table 5: Tax Parameters A 4 Tax Parameters 5 t1 t2 6 tL 7 8 tK 9 10 B Value 0 0 0 0 0 0.5 0 C D E F G

 K1

K2 11 12 13 14 Household Parameters
15 16 17 c Rich Households Poor Households

 1c
0.5 0.3

 2c
0.5 0.7


0.4 0.6

c
1.5 0.75

Kc 25 0

Lc 0 60

Table 6: Minimization Problem with 50 percent Capital Tax A Sol'n Variables P1 P2 PK Q1 Q2 T Goods Market Eq'm i 1 2 Factor Market Eq'm i K L B Values 1 1 1 66 0 1 C D

26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43

Supply =G37 =H37

Demand Minimization =I34 =B36-C36 =I35 =B37-C37

Supply =I31 =I32

Demand =I28 =B41-C41 =I29 =B42-C42

44 Zero Profit Conditions i 45 46 1 47 Tax 48 49 Minimization 50 TR =G39 =B32 TC =G40 =B46-C46

=I50 =B48-C48 SSE =SUMPRODUCT(D36:D48,D36:D48) log10 SSE =LN(D49)/LN(10)

Table 7: Equilibrium Solution with 50 percent Capital Tax

A B C D 26 Sol'n Variables Values 1.474 27 P1 1.015 P2 28 1.153 PK 29 22.512 Q1 30 Q2 57.216 31 T 2.428 32 33 34 Goods Market Eq'm i Supply Demand Minimization 35 1 22.512 22.512 0.000 36 2 57.216 57.216 0.000 37 38 39 Factor Market Eq'm i Supply Demand 40 K 25.000 25.000 0.000 41 L 60.000 60.000 0.000 42 43 44 Zero Profit Conditions i 45 1 46 47 Tax 48 49 Minimization 50 TR 33.179 2.428 TC 33.179 0.000

E

F Variable Factor Demand Ki Li Factor Supply Kc

G

H

I

Lc Product Demand c X1 X2c Product Supply Qi Profit Maximization TR TC Other related variables Rich PI Ic P1
c c

Manufacturing Nonmanufacturing Sum 4.210 20.790 25.000 25.895 34.105 60.000 Rich Poor 25.000 0.000 25.000 0.000 60.000 60.000 Rich Poor 9.171 13.341 22.512 16.044 41.172 57.216 Manufacturing Nonmanufacturing 22.512 57.216 33.179 33.179 Poor 0.908 29.804 1.789 1.023 24.579 2.428 0.000 1.033 61.457 1.338 1.011 53.934 0.000 2.42797 0.000 0 2.42797 91.261 58.082 58.082

P2 c U Tax Ti c T

2.428 0.000 SSE 3.83721E-09 log10 SSE -8.415984203

Table 8: Welfare Analysis on the Tax Policy A B Welfare Analysis C D

1 2 3 4 5 6 7 8 9 10 11 12

URich UPoor IRich IPoor

Base Alternate Difference 27.872 24.579 -3.293 50.891 53.934 3.043 34.337 29.804 -4.532 60.000 61.457 1.457 CV EV -3.993 3.467 -0.525 -4.056 3.588 -0.469

Rich Poor

Table 9: Newton's Method

A 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66
Step Name r qX qY 0.02

B

C

D

E

F

G

H

x 1 100 100 x 0 0 0.01 dx

Condition f(x) k-mkt =F17-C30 l-mkt =G17-B30 qY =B48-H30 x+dx =B51+C51 =B52+C52 =B53+C53 f(x+dx) =B51-C51 =B52-C52 =B53-C53 x-dx

SSE log10 SSE

=SUMPRODUCT(E =LN(H46)/LN(10)

Iteration r 1 qX 100 100 qY Jacobian, J 1 1 2 3

f(x-dx)

df

2

3

CTRL-j CTRL-s CTRL-r

Run a jacobian iteration Copy stats Report results

 J 1 2 3
-1

0.75 xn+1 =B51-$H$61*F64 =B52-$H$61*F65 =B53-$H$61*F66

1 =MINVERSE(B57:D59) =MINVERSE(B57:D59) =MINVERSE(B57:D59)

2 3 =MINVERSE( =MINVERSE( =MINVERSE( =MINVERSE( =MINVERSE( =MINVERSE(

dx =MMULT(B64:D66,E46:E48) =MMULT(B64:D66,E46:E48) =MMULT(B64:D66,E46:E48)

Table 10: Equilibrium Solutions for the Harberger Model A B C Summary of Experimental Results Base pX pY qX qY pP pL pF Household A B C D G Output GDP RGDP 1.439 1.710 599.133 518.989 1.000 1.000 1.000 Alternate 1.524 1.628 571.692 541.012 1.002 1.004 1.003 D E

1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22

Alternate EV CV Base 445.045 411.579 -50.760 -67.482 415.359 400.792 -23.675 -11.631 131.860 128.673 -4.835 -9.789 123.064 125.300 3.633 7.201 0.000 45.945 72.143 72.143 Base Alternate 1750.053 1751.832 1750.053 1746.176

Figure 1: Set up "Solver"

Figure 2: Illustration of Newton's Method

Figure 3: Impact of Capital Tax Applied in Sector X

400 Household B 350 300 Amount of Good Y 250 200 150 100 50 0 0 100 200 300 400 500 Amount of Good X Household A

Figure 4: Impact of Capital Tax Applied in Sector X

120 Household D 100

80 Amount of Good Y

60

40

Household C 20

0 0 20 40 60 80 100 120 140 Amount of Good X

Appendix 1
Parameter and Variable Explanation (The Harberger Model) Parameter specifications
 kX  kY w X Y m h  w kh lh i i Capital Tax on product in Sector X Capital Tax on product in Sector Y Tax on labour income Tax on production in Sector X Tax on production in Sector Y Tax on Capital Income Share parameter in household utility function Subsitution elasticity in utility function, identical across households wage rate, normalize to 1 Capital endowment for the households Labour endowment for the households Substitution elasticity in production function Share parameter in production function

Variable specifications
· Business Sector (i = X, Y )
1- i 1- i 1-i CES Cost function Ci = ( i ri + (1 -  i )wi )
1

Cost of Capital ri = r +  ki , r, capital rental rate, solution variable ³ ´i i Capital Demand ki =  i C qi , qi, output in section i, solution variables ri ³ ´i i Labour Demand li = (1 -  i ) C qi ri Price pi = Ci +  i

· Household Sector (i = A, B, C and D) CES Utility function ui = (i xi  + (1 - i )  yi-1 ) Budget Constraint mh = rkh + w(1 -  w )lh
1 -1 1   -1 

Demand for product in sector X xi = Demand for product in sector Y yi =

i mi pch  pch ( px ) (1-i) mi pch  ( py ) pch
1

- - 1- Price index pch = (i p1 + (1 - i )p1 ) x y

Government Budget mg =  kx kx +  ky ky +  w w

P

li +  x qx +  y qy

Appendix 1 (Table): Set up the Harburger Model
A B C D 1 Harberger Model 2 Based on specification provided by Peter Wilcoxen, Syracuse University 3 4 Policy Parameters 5 Used Base Alternate kX =C6+$F$6*(D6-C6) 0 0.5 6 7 8 9 10 E F G H I J

Switch 1

=C11+$F$6*(D11-C11) 11 12 13 Sectors i i 14 X 0.8 15 Y 0.8 16 Sum 17 18 X 19 Y 20 Sum 21 22 23 Households and Government h lh 24 A 200 25 B 200 26 C 200 27 D 200 28 G 0 29 Sum =SUM(B25:B29) 30 31 h mcapital 32 A =$B$46*C25 33 B =$B$46*C26 34 C =$B$46*C27 35 D =$B$46*C28 36 G =$B$46*C29 37 Sum =SUM(B33:B37) 38

kY w x y m

=C7+$F$6*(D7-C7) =C8+$F$6*(D8-C8) =C9+$F$6*(D9-C9) =C10+$F$6*(D10-C10)

0 0 0 0 0

0 0 0 0 0

Switch between the base and the alternative

i
0.4 0.6

ci

ri

ki

li

qi

pi
=D15+B9 =D16+B10 Fact.Pay. =F19+G19+H19 =F20+G20+H20 =I19+I20

=(C15*E15^(1-B15=$B$46+B6 =(C16*E16^(1-B16=$B$46+B7 TR =I15*H15 =I16*H16 =D19+D20 TC =D15*H15 =D16*H16 =E19+E20

=C15*(D15/E15)^ =(1-C15)*(D15/$B=B47 =C16*(D16/E16)^ =(1-C16)*(D16/$B=B48 =F15+F16 =G15+G16 rK wl tax =B46*F15 =B41*G15 =B6*F15 =B46*F16 =B41*G16 =B7*F16 =F19+F20 =G19+G20 =H19+H20

kh
200 200 0 0 0 =SUM(C25:C29) 0.7 0.3 0.7 0.3 0.5

h

mh

pch

xh

yh

=(1-$B$11)*$B$46=(D25*$I$15^(1-$ =D25*E25/F25*(F =(1-D25)*E25/F25*( =(1-$B$11)*$B$46=(D26*$I$15^(1-$ =D26*E26/F26*(F =(1-D26)*E26/F26*( =(1-$B$11)*$B$46=(D27*$I$15^(1-$ =D27*E27/F27*(F =(1-D27)*E27/F27*( =(1-$B$11)*$B$46=(D28*$I$15^(1-$ =D28*E28/F28*(F =(1-D28)*E28/F28*( =B6*F15+B7*F16+=(D29*$I$15^(1-$ =D29*E29/F29*(F =(1-D29)*E29/F29*( =SUM(E25:E29) =SUM(G25:G29) =SUM(H25:H29)

mlabour

mtotal

kX

kY

tw

tX

tY
=$B$10*H25 =$B$10*H26 =$B$10*H27 =$B$10*H28 0 =SUM(I33:I37)

t-mcapital
=$B$11*$B$46*C25 =$B$11*$B$46*C26 =$B$11*$B$46*C27 =$B$11*$B$46*C28 0 =SUM(J33:J37)

=(1-$B$8)*$B$41*=B33+C33 =(1-$B$8)*$B$41*=B34+C34 =(1-$B$8)*$B$41*=B35+C35 =(1-$B$8)*$B$41*=B36+C36 =(1-$B$8)*$B$41*=SUM(E38:I38) =SUM(C33:C37) =SUM(D33:D37)

=$B$6*$F$15*C25=$B$7*$F$16*C2 =$B$8*($G$15+$ =$B$9*G25 =$B$6*$F$15*C26=$B$7*$F$16*C2 =$B$8*($G$15+$ =$B$9*G26 =$B$6*$F$15*C27=$B$7*$F$16*C2 =$B$8*($G$15+$ =$B$9*G27 =$B$6*$F$15*C28=$B$7*$F$16*C2 =$B$8*($G$15+$ =$B$9*G28 0 0 0 0 =SUM(E33:E37) =SUM(F33:F37) =SUM(G33:G37) =SUM(H33:H37)

Appendix 2
VBA Macro Code
Option Explicit Public Sub CalcJacobian() Dim src As Range Dim i As Integer, j As Integer, k As Integer, iter As Integer Dim sum As Double Set src = Range("Sheet1!$A$1") For i = 46 To 48 'set increment For j = 46 To 48 If i = j Then src.Cells(j + 5, 3).Value = src.Cells(43, 2).Value / 2 Else src.Cells(j + 5, 3).Value = 0 End If Next j 'copy x+dx to x For j = 46 To 48 src.Cells(j, 2).Value = src.Cells(j + 5, 4).Value Next j 'copy f(x) to f(x+dx) For j = 46 To 48 src.Cells(j + 5, 5).Value = src.Cells(j, 5).Value Next j 'copy x-dx to x For j = 46 To 48 src.Cells(j, 2).Value = src.Cells(j + 5, 6).Value Next j 'copy f(x) to f(x-dx) For j = 46 To 48 src.Cells(j + 5, 7).Value = src.Cells(j, 5).Value Next j 'calculate df For j = 46 To 48 src.Cells(j + 5, 8).Value = (src.Cells(j + 5, 5).Value - src.Cells(j + 5, 7).Value) / src.Cells(43, 2).Value Next j 'copy df to jacobian For j = 46 To 48 src.Cells(j + 11, i - 44).Value = src.Cells(j + 5, 8).Value Next j Next i 'copy x back For i = 46 To 48 src.Cells(i, 2).Value = src.Cells(i + 5, 2).Value Next i 'copy update to x For i = 46 To 48 src.Cells(i + 5, 2).Value = src.Cells(i + 18, 8).Value Next i End Sub

Public Sub CopyStats() Dim src As Range, dst As Range Dim sw As Integer, i As Integer Dim alpha As Double, sigma As Double, x As Double, y As Double Dim siginv As Double, sm1os As Double, sosm1 As Double Set src = Range("Sheet1!$A$1") Set dst = Range("Sheet2!$A$1") If src.Cells(6, 6).Value > 0.5 Then sw = 1 Else sw = 0 'copy px, py, qx dst.Cells(4, 2 + dst.Cells(5, 2 + dst.Cells(6, 2 + dst.Cells(7, 2 + and qy to sw).Value sw).Value sw).Value sw).Value summary area = src.Cells(15, = src.Cells(16, = src.Cells(15, = src.Cells(16,

9).Value 9).Value 8).Value 8).Value

'calculate utility for each household sigma = src.Cells(40, 2).Value siginv = 1 / sigma sm1os = (sigma - 1) / sigma sosm1 = 1 / sm1os For i = 25 To 29 alpha = src.Cells(i, 4).Value x = src.Cells(i, 7).Value y = src.Cells(i, 8).Value If (x > 0) And (y > 0) Then dst.Cells(i - 12, 2 + sw).Value = (alpha ^ siginv * x ^ sm1os + (1 - alpha) ^ siginv * y ^ sm1os) ^ sosm1 Else dst.Cells(i - 12, 2 + sw).Value = 0 End If Next i End Sub Public Sub CalcResults() Dim src As Range, dst As Range Dim alpha As Double, sigma As Double, s1 As Double, s2 As Double, U0 As Double, U1 As Double Dim px0 As Double, px1 As Double, py0 As Double, py1 As Double Dim qx0 As Double, qx1 As Double, qy0 As Double, qy1 As Double Dim PNum As Double, PDen As Double, LNum As Double, LDen As Double Dim eP0U0 As Double, eP0U1 As Double, eP1U0 As Double, eP1U1 As Double Dim i As Integer Set src = Range("Sheet1!$A$1") Set dst = Range("Sheet2!$A$1") px0 py0 qx0 qy0 = = = = dst.Cells(4, dst.Cells(5, dst.Cells(6, dst.Cells(7, 2).Value: 2).Value: 2).Value: 2).Value: px1 py1 qx1 qy1 = = = = dst.Cells(4, dst.Cells(5, dst.Cells(6, dst.Cells(7, 3).Value 3).Value 3).Value 3).Value

PNum = px1 * qx1 + py1 * qy1: PDen = px0 * qx1 + py0 * qy1 LNum = px1 * qx0 + py1 * qy0: LDen = px0 * qx0 + py0 * qy0 'Report price indices dst.Cells(8, 2).Value = 1 dst.Cells(9, 2).Value = 1 dst.Cells(10, 2).Value = 1 'Paasche index If PDen > 0.0001 Then dst.Cells(8, 3).Value = PNum / PDen Else dst.Cells(8, 3).Value = 0 End If

'Laspeyres index If LDen > 0.0001 Then dst.Cells(9, 3).Value = LNum / LDen Else dst.Cells(9, 3).Value = 0 End If 'Fisher index dst.Cells(10, 3).Value = Sqr(dst.Cells(8, 3).Value * dst.Cells(9, 3).Value) 'Calculate GDP & RGDP dst.Cells(20, 2).Value = px0 * qx0 + py0 * qy0 dst.Cells(21, 2).Value = dst.Cells(20, 2).Value dst.Cells(20, 3).Value = px1 * qx1 + py1 * qy1 dst.Cells(21, 3).Value = dst.Cells(20, 3).Value / dst.Cells(10, 3).Value 'Calculate EV & CV sigma = src.Cells(40, 2).Value s1 = 1 - sigma s2 = 1 / s1 For i = 1 To 5 alpha = src.Cells(i + 24, 4).Value U1 = dst.Cells(i + 12, 3).Value U0 = dst.Cells(i + 12, 2).Value eP0U0 eP0U1 eP1U0 eP1U1 = = = = (alpha (alpha (alpha (alpha * * * * px0 px0 px1 px1 ^ ^ ^ ^ s1 s1 s1 s1 + + + + (1 (1 (1 (1 alpha) alpha) alpha) alpha) * * * * py0 py0 py1 py1 ^ ^ ^ ^ s1) s1) s1) s1) ^ ^ ^ ^ s1 s1 s1 s1 * * * * U0 U1 U0 U1

dst.Cells(i + 12, 4).Value = eP0U1 - eP0U0 dst.Cells(i + 12, 5).Value = eP1U1 - eP1U0 Next i End Sub


