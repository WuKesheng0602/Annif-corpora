POWER ALLOCATION IN OFDM-BASED COGNITIVE RADIO SYSTEMS
by

Shibiao Zhao B.Sc., Jilin University, Changchun, P.R.China, 1992

A thesis Presented to the Yeates School of Graduate Studies at Ryerson University in partial fulfilment of the requirements for the degree of Master of Applied Science in the Program of Electrical and Computer Engineering

Toronto, Ontario, Canada, 2014 c Shibiao Zhao 2014 

Author's Declaration
I hereby declare that I am the sole author of this thesis. This is a true copy of the thesis, including any required final revisions, as accepted by my examiners. I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research. I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. I understand that my thesis may be made electronically available to the public.

ii

Abstract Power Allocation in OFDM-Based Cognitive Radio Systems
c Shibiao Zhao, 2013  Master of Applied Science Electrical and Computer Engineering Ryerson University

In this thesis, we develop an subcarrier transmission suboptimal power allocation algorithm and an underlay subcarrier transmission optimal power allocation algorithm for the orthogonal frequency division multiplexing (OFDM)-based cognitive radio (CR) systems with different statistical interference constraints imposed by different primary users (PUs). Given the fact that the interference constraints are met in a statistical manner, the CR transmitter does not require the instantaneous channel quality feed-back from the PU receivers. First an alternative subcarrier transmission suboptimal algorithm with reduced complexity has been proposed and the performance has been investigated. Presented numerical results show that with our proposed suboptimal power allocation algorithm CR user can achieve 10 percent higher transmission capacity for given statistical interference constraints and a given power budget compared to the traditional suboptimal power allocation algorithms, uniform and water-filling power allocation algorithms. The proposed suboptimal algorithm outperforms traditional suboptimal algorithm, water-filling algorithm and uniform power loading algorithm. Second,We introduce an underlay subcarrier transmission optimal power allocation algorithms which allows the secondary users use the bandwidth used by Pus. And at the same time we consider the individual peak power constraint as the forth constraint added to the objective function which is the transmission capacity rate of the secondary users.Third, we propose suboptimal algorithm using GWF which has less complexity level than traditional water-filling algorithm instead of conventional water-filling algorithm in calculating the assigned power while considering the satisfaction of the total power constraint. The proposed suboptimal algorithm gives an option of using a low complexity power allocation algorithm where complexity is an issue.

iii

Acknowledgement

I would like to express my sincere gratitude to my supervisor, Prof. Lian Zhao for her continuous encouragement and support. She was always generous with her invaluable time and always motivating me and teaching me by example how to become competent and professional. It was a great privilege to work with her. I would like to acknowledge the Department of Electrical and Computer Engineering and the School of Graduate Studies at Ryerson University for their support in terms of financial aid, and work experience as a graduate assistant. I would also like to thank my defense committee for taking the time and effort to review my work and provide me with their insightful comments. Thanks are also due to my colleagues in the Wireless Communication group present and past, I am lucky to be a part of this group where a team spirit truly prevails. I would especially like to thank Peter He for his help in the early stages of this work. I can never find the words to thank my Son, Matthew Zhao, who was amazingly sweet and charming and who helped me through the most difficult times of my life. He not only believed in me and was always supportive but he also offered me his smile and his valuable love whenever I needed it. My special thanks go to my parents, especially my mother Siqi Wang who is always a great source of love and motivation, I could never thank her enough for everything she has done for me. I would also like to thank my father Ge Zhao and my siblings Guang Zhao and Feng Zhao for their love and encouragement. My deepest love and gratitude is to my grandmother Fu Guo, if it were not for her, I would not be where I am today. Thank you for all the little and great things you have done for me, you will forever live in my heart. Last but not least, I would like to thank again to my son, Matthew Zhao, who is my constant source of joy and who always gives me a reason to smile. iv

Contents

1 INTRODUCTION 1.1 Background . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1.1.1 1.1.2 1.1.3 1.2 1.3 1.4 Cognitive Radio . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Multicarrier Modulation . . . . . . . . . . . . . . . . . . . . . . . . . OFDM . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

1 1 2 6 6 8 8 9 11 12 13 16 17 22 22 23 23 24 25

Thesis Contributions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Thesis Organization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Chapter Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

2 LITERATURE REVIEW 2.1 2.2 2.3 2.4 2.5 2.6 Cognitive Radio and Spectrum sharing . . . . . . . . . . . . . . . . . . . . . Three Communication Models in Cognitive Radio Systems . . . . . . . . . . Interference Constraint Due to Imperfect Sensing . . . . . . . . . . . . . . . Power Allocation Algorithms in Cognitive Radio Systems . . . . . . . . . . . Geometric Water Filling Algorithm . . . . . . . . . . . . . . . . . . . . . . . Chapter Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

3 SYSTEM MODEL 3.1 Underlay Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3.1.1 3.1.2 Interference introduced to PU by SU . . . . . . . . . . . . . . . . . . Interference introduced to SU by PU . . . . . . . . . . . . . . . . . . v

3.2 3.3

Geometric Water-Filling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Chapter Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

25 30

4 SUBOPTIMAL POWER ALLOCATION ALGORITHMS USING NULLING METHOD 4.1 4.2 Problem Formulation and Optimal Power Allocation . . . . . . . . . . . . . Proposed Suboptimal Power Loading Schemes . . . . . . . . . . . . . . . . . 4.2.1 4.2.2 4.2.3 4.2.4 4.3 4.4 Step 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Step 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Step 3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Complexity of Different Algorithms . . . . . . . . . . . . . . . . . . . 31 31 33 34 36 37 38 38 42

Simulation Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Chapter Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

5 SUBCARRIER POWER ALLOCATION WITH TOTAL POWER, INTERFERENCE AND INDIVIDUAL PEAK POWER CONSTRAINTS 5.1 5.2 5.3 Adding Individual Peak Power Constraint in Underlay Power Systems . . . . Problem Formulation and Optimal Power Loading Algorithm . . . . . . . . . Proposed suboptimal algorithms . . . . . . . . . . . . . . . . . . . . . . . . . 5.3.1 5.3.2 5.3.3 5.4 5.5 Step 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Step 2 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Step 3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43 44 45 49 49 50 52 52 55 58 58 59

Simulation Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Chapter Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

6 CONCLUSIONS AND FUTURE WORK 6.1 6.2 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Future work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

vi

List of Figures
1.1 1.2 3.1 3.2 Co-existence of CR users and PU users in the spatial domain . . . . . . . . . Thesis outline . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Illustration for Underlay Model . . . . . . . . . . . . . . . . . . . . . . . . . Illustration for the Geometric Water-Filling (GWF) algorithm. (a) Illustration of water level step k  = 3, allocated power for the third step s 3 , and step/stair depth di = 1/ai . (b) Illustration of P2 (k ) (shadowed area, representing the total water/power above step k ) when k = 2. (c) Illustration of P2 (k ) when k = 3. (d) Illustration of the weighted case [1]. . . . . . . . . . . 4.1 4.2 Illustration for the proposed suboptimal power loading scheme . . . . . . . . Maximum transmitted data rate vs. power budget (Total Power Constraint) for CR users . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.3 Transmission data rate of the CR user vs. interference threshold for 2nd PU
2 band, Ith . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

2 10 24

28 34

39

40

4.4

Transmission rate of the CR user vs. probability,  with which instantaneous interference introduced to the PU band remains below interference threshold, I th . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41

5.1

Transmission rate of the CR user vs. Individual power constraints, with which instantaneous interference introduced to the PU band remains below interference threshold, I th . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54

vii

5.2 5.3

Maximum transmitted data rate vs. power budget (PT) for CR users . . . . Transmission data rate of the CR user vs. interference threshold for the 2nd
2 PU band, Ith

55

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

56

5.4

Transmission rate of the CR user vs. probability,  with which instantaneous interference introduced to the PU band remains below interference threshold, I th . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57

viii

List of Tables
4.1 Complexity of Different Algorithms . . . . . . . . . . . . . . . . . . . . . . . 38

ix

List of Abbreviations
ACI AWGN BER CCI CDMA CR BPSK DFT FCC FDMA FFT ICI IFFT i.i.d ISI MAI Adjacent channel interference Additive White Gaussian Noise Bit Error Rate Co-Channel interference Code Division Multiple Access Cognitive Radio Binary Phase Shift Keying Discrete Fourier Transform Federal Communications Commission Frequency Division Multiple Access Fast Fourier Transform Intercarrier Interference Inverse Fast Fourier Transform independent identically distributed Intersymbol Interference Multiple Access Interference

MC-CDMA Multicarrier CDMA OFCDM OFDM PU SU Orthogonal Frequency And Code Division Multiplexing Orthogonal Frequency Division Multiplexing Primary User Secondary User

x

P/S pdf PSD PSK QAM QoS QPSK SF SINR SNR S/P

Parallel-to-Serial probability density function Power Spectral Density Phase Shift Keying Quadrature Amplitude Modulation Quality of Service Quadrature Phase Shift Keying Spreading Factor Signal to Interference and Noise Ratio Signal to Noise Ratio Serial-to-Parallel

TDMA Time Division Multiple Access VSF Variable Spreading Factor

WLAN Wireless Local Area Network

xi

Chapter 1 INTRODUCTION
A Cognitive radio (CR) network means that a frequency band used by one or multiple primary users in a primary network can be operated by a secondary network which consists of one or multiple secondary users. To ensure the quality of service (QoS) of the Primary User (PU) and to maximize the transmission rate of the secondary users are one of the most important design issues for a Cognitive radio system. [2]. Orthogonal frequency division multiplexing (OFDM) is a promising candidate for cognitive radio systems. With OFDM, the SU has the ability to flexibly fill the spectral gaps left by PUs. In this thesis, we present optimal power allocation algorithms for subcarrier power allocation with total power, interference, and individual peak power constraints. We also present suboptimal power allocation algorithms to reduce the complexity of the computation.

1.1

Background

In this section, we discuss the advantages of using Cognitive Radio, Multicarrier Modulation and Orthogonal Frequency Division Multiplexing (OFDM) techniques.

1

1.1.1

Cognitive Radio

A cognitive radio system can be intelligently programmed and dynamically configured. CRs transceiver can use the best wireless channels close to it. As shown in Figure 1.1: in spatial domain, different PUs and CRs may be located in different geographical locations.

SU d PU1

R

PU2

PU TX SU TX PU RX SU RX
Figure 1.1: Co-existence of CR users and PU users in the spatial domain The CR can change its transmission/reception parameters by automatically detecting

2

channel information in order to use the unutilized or less utilized spectrum band. This is a form of dynamic spectrum management process. The CR can configure radio system parameters including waveform, protocol, operating frequency, and networking in order to follow the operators commands. It can exchange information about the environment with the network it works in, and it can monitor its own performance. We can determine the RF environment, channel conditions, output performance by using this information and meet the service of quality requirement from the PUs and hold the related constraints by changing the CRs settings. The demand for spectral capacity is increasing significantly, because the new wireless applications and devices continue to develop. Demand of capacity is fundamentally experiencing a dramatic increase in the number of discrete applications, the rapid rise in the deployment of these applications, the growth in the amount of time each application is utilized, and the radical growth in the data rates used when these applications are operating. At the same time, related studies [3] [4] have shown that most of the spectrum at most of the time and in most of places is not efficiently utilized, or even unused sometimes. This under used resource situation requires facilitating a new dynamic spectrum sharing (DSS) system to be developed and to be used to solve the current spectrum low efficiency use issue. FCC also found that Cellular network bands are overused, however military, amateur radio and paging frequencies are inefficiently used. The rarely used frequency band assigned to PUs can hardly be used due to fixed spectrum allocation, even though the unlicensed users would not cause harmful interference to the PUs. Now cognitive radio technique on dynamic spectrum access provides an approach to utilize these rarely used spectrums. Cognitive radio has two main types according to the transmission and reception parameters. One is full cognitive radio, which uses wireless node to observe possible parameters. Another is spectrum-sensing cognitive radio, which considers radio-frequency spectrum only [5]. There are other types of CR including: Licensed-Band Cognitive Radio which uses bands

3

assigned to licensed users; Unlicensed-Band Cognitive Radio, which uses unlicensed parts of the radio frequency spectrum; Spectrum mobility, in which secondary user changes its operation frequency; Spectrum Sharing, which can be classified into split-phase, dedicated control channel, and frequency hopping methods. The main challenge in cognitive radio is designing high-quality spectrum-sensing devices and algorithms to exchange spectrum-sensing data between nodes. Increasing the number of cooperative sensing nodes can improve the accuracy detection of signal presence because a single energy detector cannot guarantee the accurate detection. A spectrum pooling system was proposed in [6], where OFDM subbands can immediately fill the free bands. Spectrumsensing cognitive radio can be applied in emergency-network and WLAN. Cognitive radio has three main functions including: Spectrum sensing, which detects unused spectrum and share it by detecting the PUs; Power Control, which is used for opportunistic spectrum access and spectrum sharing to support the channel allocation and protect PUs by imposing peak power constraints; Spectrum management, which can locate the highest quality spectrum to transmit the signal for SUs while keep the interference to the PUs under limits [6]. CR should be designed to be able to detect spectrum holes and be able to use them while keeping the interference to the licensed user under specific limits. It also can determine its location, sense spectrum used by other devices, and change frequency, adjust output power or even alter transmission parameters and characteristics. It can meet the SUs communication needs while holding the FCC rules in US. Cognitive radio has three major tasks including: Radio scene analysis in which CR can detect spectrum holes, lightly used band and interference temperature; Channel state estimation, in which CR determine the channel capacity and the state of the channel; Spectrum management, in which CR make the spectrum sharing efficient. In order to do power allocation analysis we need first detect spectrum holes or lightly used band with fast changing environments; second we need to predict a vacant spectrum in

4

the future for the faster dynamic spectrum access. There are five main research challenges in spectrum management: · The main challenge is to find the optimal transmission power levels. The more transmission power, the higher is the transmission data rate. Increasing the transmission power also increase the interference to other users. · Total transmission power constraint which can protect the primary users by keeping the total interference due to all CR users at PUs below a threshold. · Hand-off: the CR user needs to vacate the band or use the band but keep the interference introduced to primary user under a given threshold. In this case, the CR user may use other frequency band which is known as Hand-off. · Channel allocation scheme including: orthogonal transmission which is only one CR user can transmit on a channel at a time; interference transmission which allow multiple CR users transmit on the same channel at the same time. Each CR user in interference transmission mode needs less power than in orthogonal transmission mode to achieve the same transmission data rate because in interference transmission mode each CR user has more channels to use. However the interference also increase when there are many CR users in each channel resulting in an inefficient channel usage. An balanced algorithm between orthogonal and interference transmission mode is needed. · A common control channel is needed to set up a communication link between the transmitter and the receiver and to communicate with a central unit or other CR users. In this thesis our work is focused on determining the optimal transmission power levers and suboptimal algorithms which be able to meet the interference constraint, total power constraint and individual peak power constraint.

5

1.1.2

Multicarrier Modulation

Mobile radio channels introduce severe multipath propagation due to multiple scattering from objects in the vicinity of the mobile unit. This scattering introduces rapid fluctuation of the received signal envelope as well as phase variations. The envelope of the received signal is typically modelled as Rayleigh distributed. Also the motion of the mobile unit introduces Doppler shift which causes a broadening of the signal spectrum [7]. The multipath channel can also be frequency selective where the fading envelope of the received signal at one frequency might not be correlated with the envelope at another frequency. This is due to the fact that the symbol duration might be less than the maximum delay spread. As a result, the received signal consists of overlapping versions of the transmitted symbols resulting in Inter-symbol Interference(ISI). In a conventional serial data transmission, the symbols are transmitted sequentially with the frequency spectrum of each transmitted symbol occupying the entire bandwidth available. The delay spread of the channel dictates the symbol duration or alternatively the data rate that can be achieved to prevent the effects of the ISI. The idea behind multicarrier transmission is to split the data stream into substreams of lower data rates and transmit these data substreams on adjacent subcarriers. This can be regarded as a parallel transmission in the frequency domain, and it does not affect the total bandwidth that is needed. The main advantage of this approach is that the parallel transmission increases the symbol duration by modulating the symbols into narrow subchannels which makes them more robust to the channel delay spread effects and therefore, allows for a higher data rate for a given delay spread [8].

1.1.3

OFDM

Orthogonal Frequency Division Multiplexing (OFDM) is a special form of multicarrier transmission. In OFDM, the available bandwidth is split into several narrow bands and 6

data can be modulated into different subcarriers centered at these bands. The use of parallel transmission effectively increases the symbol duration and considerably reduces ISI [8]. By choosing the subcarrier bandwidth to be less than the coherence bandwidth of the channel, they experience almost flat fading which makes equalization very simple. The subcarriers used in OFDM systems are orthogonal, to ensure proper retrieval of data at the receiver end and to minimize interference. The orthogonality of the subcarriers allows the spectra of individual subcarriers to overlap each other without any significant interference which allows for more efficient use of the bandwidth. Also, OFDM is very robust to narrow band interference because such interference can only affect a small percentage of the subcarriers. The subcarriers are separated by a frequency of 1/Ts , where Ts is the symbol duration to ensure that the subcarriers are orthogonal over a symbol duration (in the absence of channel distortion). If the channel is slowly time varying, the capacity can be enhanced significantly by adapting the data rate per subcarrier according to the Signal to Noise Ratio (SNR) of that subcarrier [9]. The main difficulty in using the parallel data system is the complexity of the equipment needed for the implementation of the system. This is because OFDM requires very accurate frequency synchronization between the receiver and the transmitter; with frequency deviation, the subcarriers will no longer be orthogonal, causing Intercarrier Interference (ICI) which will reduce the system performance [10]. The employment of the Discrete Fourier Transform (DFT) to replace the banks of sinusoidal generators and the demodulators can significantly reduce the implementation complexity of OFDM modems [11]. This operation is equivalent to multiplying each bit by the desired subcarrier frequency; however, it ensures exact frequency spacing and phase coherence between subcarriers. The discrete Fourier transform can in turn be implemented using a Fast Fourier Transform (FFT) algorithm particularly when the number of subcarriers is large. The total number of subcarriers translates into the number of points of the 7

FFT. In the later chapter, we will discuss in details the system model for the OFDM system used in our work as well as the rationale behind some of the assumptions made in our analysis.

1.2

Thesis Contributions

The key contributions of this thesis can be summarized in the following points: ­ We develop an suboptimal power allocation algorithm for the orthogonal frequency division multiplexing (OFDM) based cognitive radio (CR) systems with statistical interference constraint and total power constraint imposed by different primary users (PUs). ­ We introduce subcarrier power allocation for the cognitive radio (CR) systems with different statistical interference constraints, total power constraint and individual peak power constraint. We propose an optimal power allocation solution for this system. We also propose a suboptimal power allocation algorithm to reduce computation complexity. ­ We use Geometric Water Filling(GWF) [1] in our proposed two suboptimal algorithms, which has less computation complexity than traditional water-filling algorithm in calculating the assigned power while considering the satisfaction of the total power constraint.

1.3

Thesis Organization

In the remaining of the thesis, it is organized as: In Chapter 2, related literature review is presented; 8

In Chapter 3, we present in details the system model used in this thesis. We discuss the subcarrier grouping strategy that is used in our work. We also provide system model for the OFDM system. This includes a description of the transmitter and receiver, the adaptive subcarrier allocation scheme used, as well as the channel model. We also introduce GWF power allocation algorithm. In Chapter 4, we propose an interwave suboptimal power loading algorithm that maximizes the downlink transmission rate of a CR user while keeping the total interference introduced to different PU receivers below a specified threshold. The results of using this power loading algorithm are also presented in this chapter. In Chapter 5, we propose an underlay optimal power allocation algorithm which allows secondary users use the band with the primary users together but keep the interference introduced to the primary user bellow a certain threshold. We also propose low complexity alternative suboptimal and three classical algorithms that are used for conventional OFDM systems. Selected numerical results and complexity analysis of various algorithms under consideration are presented in this chapter. In Chapter 6, we conclude the thesis with a highlight on the important results and their interpretations. Also, possible future work is presented in this chapter. The outline of the Thesis is given in Figure 1.2.

1.4

Chapter Summary

In this chapter we introduce the concept of CR, Multicarrier Modulation and OFDM. We summary the contributions of the thesis and give the organization of the thesis.

9

Power Allocation in OFDM-Based Cognitive Radio Systems

Introduction Literature Review Model [Ch.3] [Ch.2]

[Ch.1]

Power Allocation for Total Power and Interference Constraint [Ch.4]

Power Allocation for Total, Individul Peak Power and Interference Constraints [Ch.5]

Figure 1.2: Thesis outline

10
CR Spectrum Sharing Underlay Overlay Interwave Geometric Water Filling System Model

CR

Multicarrier Modulation

Problem Formulation Optimal Power Allocation

Suboptimal Power Loading Schemes

Adding Individual Peak Power Constrain

Problem Formulation Optimal Power Allocation

OFDM

Complexity of Different Algorithms

Suboptimal Power Loading Algorithms

Chapter 2 LITERATURE REVIEW
The public mobile radio spectrum has become a scarce resource while wide spectral ranges are not efficiently used. Traditional wireless communication techniques give good data rates but their performance is limited when many users want to use the limited resource bands. To improve the spectrum utilization, cognitive radio (CR) has been proposed that can provide adaptability for wireless transmission on licensed spectrums. A cognitive radio (CR) network refers to a secondary network operation in a frequency band originally licensed/allocated to a primary network consisting of one or multiple primary users (PUs). A fundamental challenge for realizing such a system is to ensure the quality of service (QoS) of the PUs as well as to maximize the throughput or ensure the QoS, such as signal-to-interference-plus-noise ratios (SINRs), of the secondary users (SUs). Improved performance in unoccupied or not fully occupied channel conditions, high data rates and efficient use of the bandwidth are the primary advantages of Cognitive Radio networks.

11

2.1

Cognitive Radio and Spectrum sharing

By sensing and adapting surrounding environment, cognitive radio promises a low cost, highly flexible alternative to the classic wireless system. CR system can fill voids in the wireless spectrum and can significantly improve the spectral efficiency [12]. Secondary users can ensure the quality of service on the premise of generating tolerable interference to PUs by holding the power constraints like total power constraint and individual peak power constraint. By using OFDM which is a potential technology for CR systems, Cognitive Radio (CR) can promise concept for improving the utilization of scarce radio spectrum resource. A subcarrier and power allocation algorithm based on the linear waterfilling (LWF) scheme can be used to maximize the transmission capacity of the CR systems at the same time to keep the QoS of the PUs [13]. The CR transmitter can know the fading gains between the CR transmitter and its receiver through feedback channel. Sometimes other instantaneous channel information from the CR transmitter to both CR and PU receivers can be obtained at the CR transmitter. By assuming knowing channel state information at both the transmitter and the receiver, an orthogonal decomposition of a general wide band space-time frequency selective channel is derived. In practice the instantaneous channel fading gains between the CR transmitter and the PU receivers cannot be obtained. Cognitive Radio (CR) systems use the peak power constraint to protect the primary users which are undetectable because of long distance between SU and PU. Under total power constraint and individual power constraint, the optimal power allocation algorithm which needs to apply Newton's method to solve the OFDM-based CR systems has very high computing complexity and is not suitable to determine the power distribution in real time [14]. The computational complexity in iterative water-filling is very high. The data rate of a multiuser OFDM system is maximized when each subcarrier is assigned to only one user with the best channel

12

gain for that subcarrier and the transmit power is distributed over the subcarriers by the water-filling policy [15]. More recently, research has been conducted on spectrum sharing in the CR technology. Compared to spectrum sharing in other technologies, the noticeable factors in the CR technology are the presence of PUs and how the CR users take measures to protect the PU users. Generally, there is an interference limit that primary users (PU) can tolerate or the CR user may employ some pricing or coding techniques to mitigate the interference to PUs. At the same time, the CR users must maximize their own efficiency. In [16] the author assumes that the CR transmitter can have information about the statistics of the channel fading gain among the CR transmitter and the PU receivers and use a probabilistic interference constraint model for OFDM-based CR systems. They propose a suboptimal power allocation algorithm that increases the transmission rate of the CR user and reduces operational complexity. Based on these constraints, the spectrum sharing algorithms are designed in the CR technology.

2.2

Three Communication Models in Cognitive Ra-

dio Systems
Along with the classifications mentioned above, spectrum sharing in CR can be further divided into three communication models [17], based on how the CR users access the spectrum: underlay, overlay and interweave. 1) In the underlay model, the CR users can transmit simultaneously with the PU users provided that the interference they cause at the PUs receiver is below a certain acceptable threshold. In [3] and [18], authors consider the subcarrier sidelobes for a general case and propose a general power allocation algorithm. [19] describes the problem of subcarriers, bit and power allocation to a CR user employing an OFDM

13

modulation technique. The resource allocation is formulated as a multidimensional knapsack problem under constraints of limited available power to the CR user and the tolerable interference of the PU. The authors [20] design a max-min algorithm to solve this problem in a network consisting of four PU users and one CR user and achieve close to optimal solution. In [19], the scenario of multiple CR users coexisting in a network is discussed. In [21], coexistence of multiple CR users is considered. The authors introduce two distributed algorithms for interference transmission in a non-cooperative game under two constraints, limited available power to each user and tolerable interference of the PU. The efficiency of the solution is improved by using pricing techniques. Similar to [22], a user dependent pricing factor is employed. The pricing factor is derived by comparing individual user optimization problem with social optimization problem with the help of the Lagrange multipliers technique. The pricing factor for each user is calculated using the information exchanged with other users. The Pareto optimal solution is obtained by the price based iterative water-filling algorithm (PIWF). There are two versions of PIWF, one is the sequential price based iterative water-filling algorithm (SPIWF) and the other is the parallel price based iterative water- filling algorithm (PPIWF). In the SPIWF algorithm, the power allocations of the CR users are evaluated in a sequential order and each CR user updates its power allocation sequentially. While in PPIWF, the CR users update their power allocation simultaneously. As [19] and [21] follow the underlay model, interference from PUs is considered during the evaluation of the algorithm. In [23], the author presents an algorithm for joint channel and power allocation. Different from [21], this paper is based on the centralized architecture and for orthogonal transmission. There is an access point controlling the transmissions of CR users and this access point also has the information about the vacant channels, power gains of the channels for different users and acceptable amount of interference at the receiver of PU users due to CR users. The author designs an explicit channel allocation algorithm, which is implemented

14

at the access point. Under the constraints of limited available power and tolerable interference to PU, each CR user allocates power to its assigned channels by employing the water-filling solution. 2) In the overlay model, the CR users can transmit simultaneously but in this model the CR users either assist the PU transmissions or make use of the PU users messages for its benefit. [12] studies the achievable rate region when the simultaneous transmission of CR user and PU user is allowed. The CR user has the knowledge of the PU user's message and uses this information to improve its own data rate. CR user employs the dirty paper coding technique to mitigate the interference at its receiver. Similar to [12], [24] discusses the achievable rate of a CR user, when both PU and CR user coexist in a channel. But the CR user uses a portion of its power to relay the PU user's signal to PU user's receiver and the remaining power to transmit its own signal. The CR user employs the dirty paper coding technique to reduce the interference at its receiver, caused by the PU user's transmitter. 3) In the interweave model, the CR users access the spectrum opportunistically when the PU is not transmitting. In some cases, the spectrum bands are not efficiently utilized because licensed users do not always occupy their spectrum. The CR users take advantage of this temporarily vacant spectrum to communicate with other CR users. [18] considers the per subchannel power constraint instead of total subchannel power interference constraint to the PU users. An iterative portioned water-filling algorithm is proposed to get the optimal power allocation to replace the traditional water-filling which needs to solve Langrage equations. In [5], Haykin extends the idea in [25] to a cognitive radio network and designs a distributed iterative water-filling algorithm for channel and power allocation. With no pricing technique employed, the solution is an inefficient solution. In [26], the authors make two modifications to the utility function introduced in [27]. The utility is a function of the efficiency function and the efficiency function varies with the bit error rate. As there are different bit error rate 15

expressions for different modulation techniques, there are different efficiency functions. The first modification is that, a common sigmoid efficiency function is employed for all modulation techniques. The advantage of this common sigmoid efficiency function is that, irrespective of the type of modulation, all the users have a common efficiency function and it depends only on the users signal to interference ratio. The second modification is that, the pricing function is a function of the channel gain. The new pricing function essentially means that each user pays a price proportional to the amount of power it transmits with and also the channel gain from the user to the base station. Each user maximizes this new utility and finds the power allocation solution. There is obvious improvement in the result but still the solution is not Pareto-optimal.

2.3 ing

Interference Constraint Due to Imperfect Sens-

For imperfect sensing, in a recent paper [28], the authors have considered the interference caused due to imperfect sensing. Power allocation schemes have been designed where transmission capacity is maximized while keeping the interference due to missing detection below a limit. In [29], the authors investigated capacity maximization and the total interference introduced by both PU and CR bands and missed detection caused by sensing errors within a prescribed limit. [30] investigates joint sensing and power allocation schemes for OFDM-based cognitive radio (CR) systems by employing cooperative sensing based on energy detection. A subset of sensors is assigned to each primary user (PU) band and equal gain combining is used at the access point to detect the PU presence. In order to maximize the throughput of the CR system and at the same time hold the total transmit power, CR quality of service (QoS) constraints, and interference introduced to the PU, an algorithm to jointly allocate sensing thresholds at the access point and power at the CR transmitters is proposed in [30]. 16

Sometimes the channel quality feedback from the PU receivers is not instantaneously available. The statistical interference constraints imposed by different primary users can be used to develop an power allocation algorithm for orthogonal frequency division multiplexsing (OFDM)-based cognitive radio (CR) systems [16].

2.4

Power Allocation Algorithms in Cognitive Ra-

dio Systems
Dynamic resource allocation for OFDM-based systems has received lots of attention. In [18], power allocation in OFDM-based cognitive radio systems is discussed. The authors proposed iterative partitioned water-filling algorithm to enforce the interference limit from CRs to be within the limit. Later on, in [31], [3], the sidelobes of subcarriers are considered . Besides the constraints used in [18], the factor of spectrum distance between the CR band and PU band needs to be taken into account. Due to high complexity of optimal solutions, different suboptimal algorithms were discussed and performance being compared with the optimal allocations. In [32], taking the maximization of the expected sum rate of secondary multicast groups as the design objective, an efficient joint subcarrier and power allocation scheme is proposed. Specifically, the design problem is solved via a dual optimization method under constraints on the tolerable interference thresholds at individual primary user's frequency bands. [33] investigated subcarrier and power allocation problem for a joint overlay and underlay spectrum access mechanism based on OFDMA-based CR systems. A solution is proposed in [34] to maximize the link capacity while keeping the total interference generated to the PUs under limits by considering subcarrier availability. The battery life can be saved significantly by selectively allocating power to under utilized subcarriers. Authors formulate a convex optimization problem which incorporates a linear average rate loss function in the optimization objective to include the effect of 17

subcarrier availability through a risk return model. The suboptimal schemes, namely, the step ladder, nulling, and scaling schemes are presented to reduce the computation complexity. An optimal power allocation algorithm is investigated in [31] by solving Langrage equation using the Newtons method. The power loading algorithm maximizes the downlink transmission capacity of the CR user at the same time keeping the interference introduced to the primary user (PU) remains within a tolerable range. A nulling mechanism on the performance of the different algorithms under consideration is proposed. In [35] the authors propose a suboptimal algorithm for subcarrier allocation and an optimal power allocation based on the proposed suboptimal algorithm subcarrier solution for joint subcarrier and power allocation problem which is a non-convex interger problem and is difficult to find a close form solution. In [36], the new strategy called spectrum pooling is considered. It aims at enabling public access to these spectral ranges without sacrificing the transmission quality of the actual license owners. A subcarrier and power allocation problem is investigated in [35] for an OFDM-based multiuser cognitive radio (CR) system. First, a suboptimal subcarrier algorithm is proposed that allocates subcarriers to CR users that not only increase the capacity, but also reduces the interference introduced to the primary user (PU) band. Further, for a given subcarrier allocation an optimal power loading algorithm is proposed that maximizes the capacity of CR users while keeping the interference introduced to the PU band and the total power below a threshold. In [30], a CR system employing cooperative sensing based on energy detection is considered. For such a system, authors propose algorithms to jointly allocate sensing thresholds at the access point and power at the CR transmitters so that the throughput of the CR system is maximized while taking total transmit power, CR quality of service (QoS) constraints, and interference introduced to the PU band into consideration. Subcarrier and power allocation schemes are proposed in [33] for a joint overlay and underlay spectrum access mechanism. A solution is presented in [34] to an energy efficient resource allocation

18

problem which maximizes the cognitive radio (i.e., secondary) link capacity taking into account the availability of the subcarriers (and hence the reliability of transmission by cognitive radios) and the limits on total interference generated to the PUs. Power allocation schemes are investigated in [29] for OFDM-based cognitive radio (CR) systems while taking errors due to imperfect sensing of primary user (PU) into account. The interference is introduced into PU band by CR user not only because of co-existence in side-by-side bands but also by missed detection due to imperfect sensing. Single input multiple output multiple access channels (SIMO-MAC) are studied in [37] for the CR network. Subject to interference constraints for the PUs as well as peak power constraints for the SUs, two optimization problems involving a joint beamforming and power allocation for the CR network are considered: the sum-rate maximization problem and the SINR balancing problem. The waterfilling results existing in the literature from a unified viewpoint are overviewed in [38] and it bridges the gap between a wide family of waterfilling solutions and their efficient implementation in practice. And it provides a practical algorithm to evaluate numerically a general waterfilling solution, which includes the currently existing waterfilling solutions and others that may possibly appear in future problems. An optimal power allocation algorithm for the OFDM-based cognitive radio (CR) systems with different statistical interference constraints imposed by different PUs is developed in [38]. Given the fact that the interference constraints are met in a statistical manner, the CR transmitter does not require the instantaneous channel quality feedback from the PU receivers. A suboptimal algorithm with reduced complexity is proposed and the performance is investigated. In OFDM-based cognitive radio systems, the interference power limits of the PUs introduce subchannel transmit power constraints for the SU. The power allocation among the subcarriers of SU should be subject to both the sum transmit power constraint as well as the transmit power constraint of each subchannel. Different from previous works, a general power allocation algorithm is proposed in [3] to obtain the 19

optimal solution that maximizes the capacity while satisfying both the sum and subchannel transmit power constraints. The optimal power allocation strategy that aims at maximizing the capacity in OFDM based cognitive radio systems is investigated in [18]. it shows that the traditional water-filling algorithm applied in general OFDM systems needs to be modified due to per subchannel power constraints in such systems. An iterative partitioned water-filling algorithm is proposed and proved to be optimal based on the convex optimization theory. An optimal power allocation algorithm for OFDM-based cognitive radio is investigated in [4]. In the model of power allocation, the authors set the interference constraints for each primary user, and also take subcarrier sidelobes interference (adjacent channel interference (ACI)) into account. When the authors use the optimal power allocation algorithm, the transmission capacity of SU is maximized while the interference introduced to the PU is within a certain range. An efficient power allocation algorithm is investigated in [39] for multiuser OFDM CR systems that uses the peak power constraint to protect the primary users. Under this constraint, the high-complexity optimal power allocation algorithm for OFDM-based CR systems is not suited to determine the power distribution because the algorithm must iteratively perform the standard water-filling (WF) to determine whether or not the power in each assigned subcarrier is greater than the peak power. Instead of using the WF algorithm, it uses the conditions that the optimal power distribution should be satisfied to design a simple method for fulfilling the peak power constraint in each assigned subcarrier and then updating the water level. The subcarrier and power allocation algorithms which are to maximize secondary users transmitted data rate while adjusting the interference introduced to the PU band below a threshold and maintaining the total power under a limit is investigated in [40]. The issue of subcarrier allocation in multiuser CR networks is firstly discussed. Secondly, three suboptimal power allocation algorithms based on LWF (linear water-filling algorithm) which have less complexity than the optimal algorithm are proposed. The 20

subcarrier and power allocation problem in CR systems is investigated in [41], where primary and CR users co-exist in adjacent bands, while keeping the total interference introduced to the PU band below a certain threshold and the total power allocated to the CR users under a constraint. According to the different purposes of the resource allocation, several suboptimal subcarrier allocation algorithms are investigated, which are termed as Max-Rate, Min-Interference and Fair-Rate subcarrier allocation algorithm, separately. The conventional water-filling algorithm cannot be directly employed for power allocation in a cognitive radio system, because there are more power constraints in the cognitive radio power allocation problem than in the classic Water-filling problems. In [42], a novel algorithm based on iterative water-filling is presented to overcome such limitations. Features of the water-filling algorithm are explored in [43], and a low-complexity algorithm is proposed by using power-increment or power-decrement water-filling processes. The optimal power allocation strategy that aims at maximizing the channel throughput in OFDM-based cognitive radio systems is investigated in [44]. An optimal power allocation algorithm is developed in [16] for the OFDM-based CR systems with different statistical interference constraints imposed by different primary users (PUs). Joint sensing and power allocation schemes are investigated in [30] for OFDM-based CR systems. The effect of a subcarrier nulling mechanism on the performance of the different algorithms under consideration is studied in [31] and [19]. The drawback of the static allocation policy is the inefficient usage of the available spectrum [45]. The power control algorithms have been studied with different objective functions such as maximization of the sum data rate [23] and the sum utility function [46].

21

2.5

Geometric Water Filling Algorithm

In [1], a simple and elegant geometric waterfilling (GWF) approach is proposed to solve the unweighted and weighted radio resource allocation problems. Unlike the conventional water-filling (CWF) algorithm, it eliminates the step to find the water level through solving a non-linear system from the Karush-Kuhn-Tucker conditions of the target problem. The proposed GWF requires less computation than the CWF algorithm, under the same memory requirement and sorted parameters.

2.6

Chapter Summary

In this chapter, we list the papers which are related to the power allocation of the OFDM-based CR systems including geometric water-filling algorithm. We discuss the ideas given in these papers in this chapter.

22

Chapter 3 SYSTEM MODEL
In this chapter, first, we discuss the subcarrier grouping strategy that is used to maximize the transmission rate and minimize interference. Second, we outline in details the system model used in this thesis. This includes a description of the transmitter and receiver, the adaptive subcarrier allocation scheme used in our work, as well as the channel model used in the analysis.

3.1

Underlay Model

We consider a downlink transmission scenario. It is assumed that the frequency bands of bandwidth B1, B2, ... , BL have been occupied by PU1, PU2, ... , PUL. As in Figure 3.1, SUs can occupy either the spectrum of PUs or the adjacent spectrum of PUs. The available bandwidth for CR transmission is divided into N subcarriers based OFDM system, and the bandwidth for each subcarrier is f Hz . In the downlink transmission scenario, there are three instantaneous fading gains: between the SUs transmitter and SUs receiver for the ith subcarrier denoted as hss i ; between the SUs transmitter and lth PU receiver denoted as hsp l ; between l th PUs

23

PU1

PU2

PUL

1 2

N

B1
f

B2

BL

Figure 3.1: Illustration for Underlay Model

transmitter and SUs receiver denoted as hps l . We assume that these instantaneous fading gains are perfectly known at the SUs transmitter.

3.1.1

Interference introduced to PU by SU

We assume that the signal transmitted on the subcarrier is an ideal Nyquist pulse. According to [47], the power spectrum density of the ith subcarrier can be written as: (
(f ) Xi

= Pi Ts

sin f Ts f Ts

)2 (3.1)

where Pi is the total transmit power in the ith subcarrier and Ts is the symbol duration. Then the interference introduced to the lth PU band by the ith subcarrier is : 
(l) Ii (Pi )

=

2 Pi |hsp l | Ts

dil +Bl /2

(

dil -Bl /2

sin f Ts f Ts

)2 df, (3.2)

where dil is the distance in frequency between the ith subcarrier and the lth PU band, and Bl represents occupied bandwidth by the lth PU.

24

3.1.2

Interference introduced to SU by PU

According to [47], the power spectrum density of the PU signal after M-fast Fourier transform (FFT) processing can be expressed as:  ( ) ( )2 dy, (3.3)

1 E [IN ( )] = 2M



-

XP U e

j

sin( - y )M/2 sin( - y )/2

where XP U (ej ) is the power spectrum density of the PU signal. The PU signal has been taken to be an elliptically filtered white noise process with an amplitude PP U [47]. According to [36], the interference introduced to the ith subcarrier by the lth PU band can be written as: 
(l ) Ji

(PP U ) =

2 |hsp l |

dil +f /2

dil -f /2

E [IN ( )] d,

(3.4)

3.2

Geometric Water-Filling

In [1], a simple and elegant geometric waterfilling (GWF) approach is proposed to solve the unweighted and weighted radio resource allocation problems. Unlike the conventional water-filling (CWF) algorithm, it eliminated the step to find the water level through solving a non-linear system from the Karush-Kuhn-Tucker conditions of the target problem. The proposed GWF requires less computation than the CWF algorithm, under the same memory requirement and sorted parameters. A. Problem Formation and Traditional Water-Filling The water-filling problem can be abstracted and generalized into the following problem: given P > 0, as the total power or volume of the water; the allocated power and the propagation path gain for the ith channel are given as si and ai respectively, i = 1 . . . K ; and K is the total number of channels. Let {ai }K i=1 be a sorted sequence, which is 25

positive and monotonically decreasing, find that max{si }K i=1 K
i=1

log(1 + ai si ) (3.5)

subject to: 0  si , i; K i=1 si = P.

Since the constraints are that (i) the allocated power to be nonnegative; (ii) the sum of the power equals P , the problem (3.5) is called the water-filling (problem) with sum power constraint. To find the solution to problem (3.5), we usually start from the Karush-Kuhn-Tucker (KKT) conditions of the problem, as a group of the optimality conditions, and derive the system (3.6) below from the KKT conditions,  ( )+  1  s = µ - , for i = 1, . . . , K,  i ai   K i=1 si = P,      µ  0,

(3.6)

where (x)+ = max {0, x}. µ is the water level chosen to satisfy the power sum con straints with equality ( K i=1 si = P ). The solution to (3.6) is referred as a solution of the CWF problem (3.5). It can be seen that the implied system (3.6) has been used to find the optimal solution. The existence of its Lagrange multipliers and the implication mentioned above determine that enumeration can be utilized to find the water level µ. Complexity of the non-geometric approach to solve the problem (3.5) will be discussed in Section IV. In the sequel of the paper, when water-filling problem is mentioned, the power sum constraint is always included. B. Geometric Water-Filling (GWF) Approach In [1], a novel approach is proposed to solve problem (3.5) based on geometric view. 26

The Geometric Water-Filling (GWF) approach eliminates the procedure to solve the non-linear system for the water level, and provides explicit solutions and helpful insights to the problem and the solution. Figs. 3.2(a)-(c) give an illustration of the GWF algorithm. Suppose there are 4 steps/stairs (K = 4) with unit width inside a water tank. For the conventional approach, the dashed horizontal line, which is the water level µ, needs to be determined first and then the power allocated (water volume) above is solved. Let us use di to denote the "step depth" of the ith stair which is the height of the ith step to the bottom of the tank, and is given as 1 , for i = 1, 2, . . . , K. ai

di =

(3.7)

Since the sequence ai is sorted as monotonically decreasing, the step depth of the stairs indexed as [1, · · · , K ] is monotonically increasing. We further define i,j as the "step depth difference" of the ith and the j th stairs, expressed as

di = 1/ai , for i = 1, 2, . . . , K.

(3.8)

Since the sequence ai is sorted as monotonically decreasing, the step depth of the stairs indexed as [1, · · · , K ] is monotonically increasing. We further define i,j as the "step depth difference" of the ith and the j th stairs, expressed as

i,j = di - dj = 1/ai - 1/aj , as i  j and 1  i, j  K.

(3.9)

Instead of trying to determine the water level µ, which is a real nonnegative number, we aim to determine water level step, which is an integer number from 1 to K , denoted by k  , as the highest step under water. Based on the result of k  , we can write out the solutions for power allocation instantly. 27

µ

1

4 00 11 1 0 00 11 0000 1111 0 1 00 11 3 1111 0000 0 1 s 1 0 0 1 0 1 2 0 1 0 1 d1 = 0 0 1 0 1
2 2 1 a2

s 3

1111111111111 0000000000000 3 0000000000000 1111111111111 3 0000000000000 1111111111111 0000000000000 1111111111111 0000000000000 1111111111111 2 0000000000000 1111111111111 2
1 (b)

µ

4

(a)

µ 111111111111 000000000000 000000000000 111111111111 0 1 000000000000 111111111111 3 0 1 0 1  0 1 2 0 1 0 1 1 1 0 0 1
4
3,1

µ

(c)

1 0 0 1 0 1

w1
1

1 0 0 1 3 0 1 s /w 0 1 0 1 0 2 1 0 1 0 1 0 1 0 d 1 = 1/a w 0 1 0 (d) 1
2 2 2 2

4

2

Figure 3.2: Illustration for the Geometric Water-Filling (GWF) algorithm. (a) Illustration of water level step k  = 3, allocated power for the third step s 3 , and step/stair depth di = 1/ai . (b) Illustration of P2 (k ) (shadowed area, representing the total water/power above step k ) when k = 2. (c) Illustration of P2 (k ) when k = 3. (d) Illustration of the weighted case [1].

In the following, we explain how to find the water level step k  without the knowledge of the water level µ. Let P2 (k ) denote the water volume above step k or zero, whichever is greater. The value of P2 (k ) can be solved by subtracting the volume of the water under step k from the total power P , as { [ ( )]}+ k -1 1 1 P2 (k ) = P- -a i=1 ak { [ ]}+ i k -1 = P- , for k = 1, . . . , K. i=1 k,i

(3.10)

Due to the definition of P2 (k ) being the power (water volume) above step k , it cann't be a negative number. Therefore we use {·}+ in (3.10) to assign 0 to P2 (k ) if the result inside the bracket is negative. The corresponding geometric meaning is that the k th level is above water. Fig. 3.2(b) and Fig. 3.2(c) illustrate the concept of P2 (k ) for k = 2 and k = 3 respectively by the shadowed area. As an example of Fig.1(c), the water volume under step 3 can be expressed as the sum of the two terms: (i) the step depth difference between the 3rd and the 1st step, 3,1 , and (ii) the step depth

28

difference between the 3rd and the 2nd step, 3,2 . Thus, P2 (k = 3) can be written as P2 (k = 3) = [P - 3,1 - 3,2 ]+

and the above result is the shadowed area in Fig. 1(c), which is also an expansion of the composite form of (3.10). Then, we are ready to have the following proposition: Proposition 3.1. The explicit solution to (3.5) is:    sk + (dk - di ) si =   0, where the water level step k  is given as { } k = max k P2 (k ) > 0, 1  k  K


1  i  k k  < i  K,

(3.11)

(3.12)

and the power level for this step is 1 P2 (k  ).  k

sk =

(3.13)

It is easy to interpret Proposition 3.1 from Fig. 3.2. The first step of the approach is to find the water level step k  . From Fig. 1, we can find that k = 3 is the maximal index that makes P2 (k ) greater than zero. Therefore, based on (3.12), k  = 3 can be determined. Then the power at this step sk can be determined based on (3.13). For those steps with index higher than k  , no power is assigned. For those steps with index lower than k  , their power levels are obtained by adding sk with the corresponding level depth difference with the k  th step as shown in (3.11). Proposition 3.1 provides an explicit constructed solution rather than the implicit solution. The procedure eliminates solving the nonlinear equation as shown in (3.6)

29

and the real number water level µ.

3.3

Chapter Summary

In this chapter we give the model which is used in the thesis. We also give the concept of Geometric Water-Filling algorithm and detailed explanation.

30

Chapter 4 SUBOPTIMAL POWER ALLOCATION ALGORITHMS USING NULLING METHOD
In this chapter, we investigate the nulling method and GWF algorithms to the OFDM based subcarrier power allocation problems.

4.1

Problem Formulation and Optimal Power Al-

location
Our design goal is to find power values for each subcarrier, Pi (i = 1, 2, . . . , N ) for given
sp instantaneous fading gains hss l , given fading statistics of hl and the total transmit

power budget PT . As such the total transmission rate of the CR user, C is maximized while the probability that the interference introduced to lth (l = 1, 2, . . . , L) PU band is
l kept below the threshold Ith (l = 1, 2, . . . , L), respectively, with the probability value 

or above. Mathematically, the problem can be formulated as a constrained optimization 31

problem as follows

C = max
Pi

N  i=1

2 |hss i | log 1 +  (l ) 2 + L l=1 Ji

(

) , (4.1)

subject to: ( Pr
N  i=1

) Ii (dil , Pi )  Ith
(l ) (l )

 ,

l,

(4.2)

Pi  0,

l,

(4.3)

N  i=1

Pi  PT ,

(4.4)

where Pr . denotes the probability. Now the probabilistic interference constraint in Eq.(4.2) can be written as ( Pr
2 |hsp l | N  i=1

) Ki Pi  Ith
(l) (l )

 ,

l,

(4.5)

where Ki

(l)

= Ts

 dil +Bl /2 ( sin f Ts )2
dil -Bl /2 f Ts

df . Since |hsp l | is assumed to be Rayleigh dis-

2 tributed with a known parameter l , the distribution of |hsp l | corresponds to expo-

nential distribution with parameter 2 l . The constraint in Eq.(4.5) can be evaluated in closed-form for the Rayleigh fading case as follows
(l) I th N (l) 2 2 P K i=1 i i l

1-e

-

 ,

l,

(4.6)

After some mathematical manipulations, Eq.(4.6) can be written as 32

N  i=1

(l) Pi Ki

Ith  2 , 2l (- ln(1 - ))

(l)

l,

(4.7)

The optimal power of the ith subcarrier is given by: [ Pi = + ]  (l) + 2 + L J l=1 i - 2 |hss i |

L

1
(l )

(4.8)

l=1 l Ki

where l and  are Lagrange multipliers. To solve Pi , we need to use Newton's method, Lagrange equations and KKT conditions. The computation complexity is very high. We develop a suboptimal power loading schemes which reduces the computation complexity for this problem.

4.2

Proposed Suboptimal Power Loading Schemes

Nulling Mechanism was discussed in [36]. The authors studied the effect of nulling the subcarriers and showed that the interference introduced to the PU band can be reduced by nulling those subcarriers (i.e., allocating zero power) that are adjacent to the PU band, since the adjacent subcarriers produce the maximum amount of interference. This procedure implies that for a given interference threshold, more power can be allocated to the far apart subcarriers than to the neighboring subcarriers. Thus, one would expect that a higher transmission rate can be achieved using the same power. However, nulling the adjacent subcarriers loses frequency diversity, as the adjacent subcarrier is assigned with zero power even when it has a very good channel gain. Therefore, nulling creates a trade-off. Hence, here we study our proposed suboptimal scheme and classical uniform loading and water-filling schemes with the effect of nulling. It should be noted that we do not study effect of nulling on the optimal scheme, as it is already optimal, and automatically nulls the subcarriers that need to be nulled.

33

By nulling we mean that for each side of the PU band, we null one subcarrier that is adjacent to it. Without loss of generality, we assume that each CR user band occupies N subcarriers. We assume the subcarriers are positioned around the PUs, as in Figure 4.1 . Hence, we null 2L - 1 subcarriers, namely,
PU1 PU2 PUL

1 2

N

B1
f

B2

BL

Figure 4.1: Illustration for the proposed suboptimal power loading scheme

{ Ø

} N N 2N 2N ( ), ( + 1), ( ), ( + 1), · · · , (N ) L L L L

(4.9)

Now for studying the nulling mechanism, we load zero power in the subcarriers listed in (4.9). For the remaining subcarriers, we load powers according to the scheme under study, such that the total interference introduced to the primary user band is equal to I th, and the power profile for the schemes can be derived accordingly.

4.2.1

Step 1

The power has to be assigned to N CR subcarriers such that the transmission rate of CR user can be maximized while all L + 1 total power constraint from Eq. (4.4) and L interference constraints from Eq. (4.7) are to be satisfied. The complexity of the optimal algorithm comes from the fact that these L + 1 constraints have to be met 34

simultaneously. In order to reduce such complexity, we follow a three step procedure as follows. First, we keep only one of the L + 1 constraints and find power allocation suboptimally in each subcarrier. Without loss of generality, let us denote that the allocated power in the ith subcarrier due to the lth constraint by Pi . In order to satisfy lth interference constraint given in Eq. (4.7), power is allocated according to nulling mechanism and ladder profile as in [31]. It is based on the heuristics that if a subcarrier is closer to a PU band, it introduces more interference. Hence, less power should be allocated to that particular subcarrier. We allocate zero power to the subcarrier which is the nearest to the PUs. In particular, we propose to allocate power in each CR subcarrier such that the allocated power is inversely proportional to the factor Ki
(l) (l)

that depends on the spectral distance between the ith CR subcarrier

and the lth PU band. The allocated power in the ith subcarrier because of the lth interference constraint is written as

Pi = P/Ki ,

(l )

(l)

l,

(4.10)

By using Eq.(4.7), after nulling (2L - 1) subcarriers P can be calculated by assuming strict equality in the lth interference constraint in Eq. (4.7). Using Eq. (4.10), this equality constraint can be written as
N 

(l ) Pi Ki

Ith = 2 2l (- ln(1 - a))

(l)

(4.11)

i = ( N , N + 1, · · · , N ) L L i=1 We can derive

Ith P = 2(N - 2L + 1)2 l (- ln(1 - a)) 35

(l)

(4.12)

Through Eq.(4.9), (4.10), and(4.12), we can get Pi
(l)

(l )

as following

Pi =

(l)

Ith
(l)

2Ki (N - 2L + 1)2 l (- ln(1 - a))

(4.13)

4.2.2

Step 2

In step 1 we calculate the L constraints from interference point of view. In step 2 we will calculate power values PiL+1 according to the total power constraint. In order to reduce the computation complexity we use GWF instead of standard water-filling algorithm. According to the GWF described in Chapter 3.3, we can get following results: The value of P2 (k ) can be solved by subtracting the volume of the water under step k from the total power P , as          P2 (k ) =                          P      - N  i=1   i, k = ( N ,N L L      - N  i=1   i, k = ( N ,N L L +        ) ( 1 1  - ai  ak         + 1, · · · , N ) +          k,i          + 1, · · · , N )

(4.14)

=

P

where ai is the channel fading gain, it is expressed as follow
2 |hss i | L l=1

ai =

2 +

Ji

(l)

i = 1, · · · , k ( N ) i = N , + 1 , · · · , N L L 36

(4.15)

Due to the definition of P2 (k ) being the power (water volume) above step k , it cann't be a negative number. Therefore we use {·}+ to assign 0 to P2 (k ) if the result inside the bracket is negative. The corresponding geometric meaning is that the k th level is above water. The explicit solution is    sk + (dk - di ) si =   0, where the water level step k  is given as { } k  = max k P2 (k ) > 0, 1  k  K 1  i  k k  < i  K,

(4.16)

(4.17)

and the power level for this step is 1 P2 (k  ). k

sk =

(4.18)

Then, the power value which satisfied the total power constraint in ith subchannel can be derive as

Pi

(l+1)

= [0, si ]+

i,

(4.19)

4.2.3

Step 3

The final allocated power according to our proposed suboptimal algorithm is the minimum of the power we obtained from Eq.(4.13) and Eq.(4.19) as follow

Pisubopt = min{Pi , Pi , · · · , Pi , Pi

(1)

(2)

(L)

(L+1)

} i,

(4.20)

Through our proposed suboptimal algorithm, the resulted allocated power value se37

lected from L+1 power values can satisfy both the interference and total power constraints.

4.3

Simulation Results

In this section we present simulation results where we assume that there are three PU bands (L=3), and there are twelve OFDM subcarriers (N = 12) for the CR user. The values of Ts , f, B1 , B2 , and B3 have been assigned to be 4 seconds, 0.3125 MHz, 1 MHz, 2 MHz, and 5 MHz, respectively. AWGN variance, ( 2 ) is assumed to be equal to 10-8 W and the channel fading gains are assumed to follow Rayleigh distribution. The
sp 2 sp 2 sp 2 2 average channel power gains for |hss i | , |h1 | , |h2 | and |h3 | are assumed to be -10 dB,

-5 dB, -7 dB, and -10 dB, respectively. The values of Ji are generated randomly with an average value of 1 × 10-6 W . The values of Ith , and Ith have been assumed to be
(1) (3)

(l)

1 × 10-6 W , and 5 × 10-6 W , respectively. Average transmitted data rates for different algorithms under consideration are obtained from 30, 000 independent simulation runs. In Figure 4.2, we plot the achievable maximum transmission rate for the CR user versus the total power budget for various algorithms. The value of Ith has been fixed to 2 × 10-6 W , and the value of  has been considered to be 0.95. The highest curve is made by using nulling method. The curve below it is made using the method in [16]. The third curve is made by water-filling method, the lowest curve is made by using uniform power allocation method. From this figure, we observe that the proposed suboptimal algorithm is able to achieve higher transmission rate for a given power budget than the conventional suboptimal algorithms. It should be noted that as we increase the power budget for CR user, the interference constraint becomes dominant and the transmission rate of CR user does not increase as the power budget increases. This is expected as in this region the CR system operates in an interference limited scenario. 38
(2)

18 16 14 12 10 8 6 4 2 0

x 10

5

Transmission date rate of CR User(in bps)

Proposed Suboptimal Existing Suboptimal [16] Water-filling Uniform

0

0.2

0.4 0.6 Power budget(in watts)

0.8 x 10

1
-3

Figure 4.2: Maximum transmitted data rate vs. power budget (Total Power Constraint) for CR users In Figure 4.3, we plot the achievable transmission data rate for the CR user versus interference threshold for second PU band, (Ith ) for all the algorithms under consideration. The value of total transmit power, PT has been assumed to be 5 × 10-4 W. Again, we observe that the proposed suboptimal algorithm achieves highest transmission rate over other algorithms. Further, water-filling algorithm achieves higher transmission rate than the uniform algorithm. The transmission rate versus interference threshold curve saturates after a certain value of (Ith ). The reason is that although (Ith ) is relaxed by increasing its value, other constraints ((Ith ),(Ith ), and PT ) becomes dominant. In Figure 4.4, we plot achievable transmission rate for the CR user versus probability , the values of PT , and (Ith ), is assumed to be 5 × 10-4 W , and 2 × 10-6 W , re(2) (1) (3) (2) (2) (2)

39

15

x 10

5

Transmission date rate of CR User(in bps)

10

Proposed Suboptimal Existing Suboptimal [16] Water-filling Uniform

5

0

0

0.2 0.4 0.6 0.8 Interference introduced to 2nd PU band(in watts)

1 x 10
-5

Figure 4.3: Transmission data rate of the CR user vs. interference threshold for 2nd PU
2 band, Ith

spectively. As expected, we observe that the proposed suboptimal algorithm performs better than other algorithms. Also, suboptimal algorithm outperforms water-filling algorithm, which performs better than the uniform power loading algorithm. It is observed from Figure 4.3 that as the value of  increases, the achievable transmission rate of CR user decreases for a given power budget and interference thresholds.

4.4

Chapter Summary

In this chapter we give a suboptimal power allocation algorithm using Nulling Mechanism. The simulation results show that the proposed suboptimal power allocation

40

15

x 10

5

Transmission date rate of CR User(in bps)

10

5 Proposed Suboptimal Existing Suboptimal [16] Water-filling Uniform 0 0.75 0.8 0.85 0.9 Probability, 0.95 1

Figure 4.4: Transmission rate of the CR user vs. probability,  with which instantaneous interference introduced to the PU band remains below interference threshold, I th algorithm performs better than existing suboptimal power allocation methods and water-filling and uniform power allocation methods. It also has lower computation complexity.

41

Chapter 5 SUBCARRIER POWER ALLOCATION WITH TOTAL POWER, INTERFERENCE AND INDIVIDUAL PEAK POWER CONSTRAINTS
In this chapter, we propose an optimal power allocation algorithm for subcarrier power allocation with total power constraint, interference constraint and individual peak power constraint using underlay model where the SUs can use the band when the primary user uses the same band, but we keep the interference to the primary user under a threshold. Furthermore, a suboptimal power allocation algorithm is proposed for this problem.

42

5.1

Adding Individual Peak Power Constraint in

Underlay Power Systems
In the cognitive radio systems, the interference between PU and SU is one of the main obstacles preventing from the improvement of the system performance. In [48], the authors have shown that there are two types of interference between PU and SU: adjacent channel interference (ACI) and co-channel interference (CCI). The mutual interference between PU and SU is caused by the non orthogonality of the transmitted signals. In order to explore power allocation of the cognitive OFDM systems, the authors in [36] proposed an optimal and two suboptimal power loading algorithms, and showed that the amount of interference introduced to the PUs band by a CR user subcarrier depends on the power allocated in that subcarrier as well as the spectral distance between that particular subcarrier and the PUs band. However, in the model of [36], secondary users can not occupy the spectrum band of primary users, and can only occupy the adjacent spectrum band of primary users, which can not fully reflect the characteristics of cognitive radio; Besides, it doesn't set an individual primary users interference threshold, but the total interference threshold. Secondary users can use the spectrum of primary users as long as the interference introduced to the PU by SU is not beyond the total interference threshold. However, certain primary user may be seriously affected by secondary users at that time, and others are almost unaffected, even though the interference from SUs is within the total interference threshold. In [31], the optimal power loading algorithm that the authors proposed did not take the subcarrier sidelobes interference into account, and also did not consider the interference introduced to secondary users by primary users. The power loading algorithm in [49] is an improvement on the power loading algorithm in [31], where the subcarrier sidelobes interference is considered, but it did not take the interference introduced to the secondary users by primary users into account. Based on [36] [31] [49], we 43

add an individual peak power constraint to CR to further protect primary user by restricting the secondary user. We propose an optimal power loading algorithm for OFDM-based cognitive radio systems with total power, interference, and individual peak power constraints. Because of the high complexity of the optimal power loading algorithm, we also propose a suboptimal loading algorithm that is less complicated.

5.2

Problem Formulation and Optimal Power Load-

ing Algorithm
According to Shannon capacity formula, the transmission rate at the ith subcarrier is given by: ( ) , (5.1)

2 |hss i | Ri (Pi ) = log 1 +  (l) 2 + L l=1 Ji

where  2 denotes the additive white Gaussian noise (AWGN) variance (we assume that the noise of each subcarrier is AWGN). Our objective is to maximize the total transmission rate of SUs, expressing mathematically as:

C = max
Pi

N  i=1

2 |hss i | log 1 +  (l ) 2 + L l=1 Ji

(

) , (5.2)

Subject to: ( Pr
N  i=1

) Ii (dil , Pi )  Ith
(l ) (l )

 ,

l,

(5.3)

44

Pi  0,

l,

(5.4)

N  i=1

Pi  PT ,

(5.5)

Pi  Gi

(5.6)

where Gi is the Individual Peak Power Constraint, C is the total transmission capacity of SUs, N is the total number of OFDM subcarriers, where Pr . denotes the probability. Now the probabilistic interference constraint in Eq.(5.3) can be written as ( Pr
(l ) 2 |hsp l | N  i=1

) Ki Pi  Ith
(l) (l )

 ,

l,

(5.7)

where Ki

= Ts

 dil +Bl /2 ( sin f Ts )2
dil -Bl /2 f Ts

df .

And |hsp l | is assumed to be Rayleigh dis-

2 tributed with a known parameter l , the distribution of |hsp l | corresponds to an expo-

nential distribution with parameter 2 l . The constraint in Eq.(5.7) can be evaluated in closed-form for the Rayleigh fading case as follows
(l) I th N (l) 2 2 P K i=1 i i l

1-e

-

 ,

l

(5.8)

After some mathematical manipulations, Eq.(5.8) can be written as
N  i=1

(l) P i Ki

Ith ,  2 2l (- ln(1 - ))

(l )

l

(5.9)

It is clear that this is a problem of convex optimization. (5.5) is a concave function, Ii (P i) is a convex function. According to convex optimization theory, when the total transmission capacity is maximized, the optimal power of the ith subcarrier is given 45
(l)

by: [ Pi = ++ ]  (l) + 2 + L J l=1 i - 2 |hss i |

1 L

l=1 l Ki

(l )

(5.10)

where l , vi ,  and  are Lagrange multipliers. Proof: The optimal problem of (5.5)(5.7) satisfies the Karush- Kuhn-Tucker (KKT) conditions. Assume that:

Pi  0,

l,

(5.11)

N  i=1

Pi - PT  0 ,

(5.12)

N  i=1

Pi Ki -

(l )

Ith  0, 2 2l (-ln(1 - ))

(l)

l,

(5.13)

Pi - Gi  0,

(5.14)

vi  0,

(5.15)

  0,

(5.16)

l  0,

(5.17)

  0, 46

(5.18)

vi P i = 0 , (  ( l ) Pi - PT = 0, ) = 0, l,

(5.19)

N  i=1

(5.20)

N  i=1

(l ) Pi Ki

Ith - 2 2l (-ln(1 - ))

(l)

(5.21)

(Pi - Gi ) = 0,   1 -  ( 2 +L J (l)
l=1 2 |hss i | i

(5.22)


L   (l)  )  - vi +  +  + l Ki = 0, l=1

(5.23)

+ pi

By eliminating vi , we get   1 (  2 +L J (l)
l=1 2 |hss i | i


L   (l)  )   +  +  l Ki , l=1

(5.24)

+ pi 

  - ( Pi
 (l) 2 + L l=1 Ji 2 |hss | i

+ pi

L   (l) ) + P  + P  + P l Ki = 0, i i i  l=1

(5.25)

 If  +  + L
(l) l=1 l Ki


(l) J l=1 i |hss |2 i

 1   ( 2 +L
L 1

) ,



then Eq.(5.24) can only hold if Pi  0. Then ]+ . If  + + L
(l ) l=1 l Ki

[ we can get Pi =
 + +

(l) l=1 l Ki

-

 (l) 2 + L l=1 Ji ss 2 |hi |



(

then Pi  0. Then the optimal power Pi is the following

 (l) 2 + L J l=1 i |hss |2 i

1

),

47

[ Pi = ++

1 L

l=1 l Ki

(l)

]  (l ) + 2 + L J l=1 i - , 2 |hss i |

(5.26)

So the proof of Eq.(5.10) is completed.

5.3

Proposed suboptimal algorithms

By nulling we mean that for each side of the PU band, we null one subcarrier that is adjacent to it. Without loss of generality, we assume that each CR user band occupies N subcarriers. Hence, we null 2L - 1 subcarriers, namely, { Ø } N N 2N 2N ( ), ( + 1), ( ), ( + 1), · · · , (N ) L L L L

(5.27)

5.3.1

Step 1

The power has to be assigned to N CR subcarriers such that the transmission rate of CR user can be maximized while all L + 1 (total power constraint from Eq. (5.3) and L interference constraints from Eq. (5.5) are to be satisfied. The complexity of the optimal algorithm comes from the fact that these L + 1 constraints have to be met simultaneously. In order to reduce such complexity, we follow a three step procedure as follows. First, we keep only one of the L +1 constraints and find power allocation suboptimally in each subcarrier. Without loss of generality, let us denote that the allocated power in the ith subcarrier due to the lth constraint by Pi . In order to satisfy lth interference constraint given in Eq. (5.9), power is allocated according to nulling mechanism and ladder profile as in [31]. It is based on the heuristics that if a subcarrier is closer to a PU band, it introduces more interference. Hence, less power should be allocated to that particular subcarrier. We allocate zero power to the subcarrier which is the nearest to the PUs. In particular, we propose to allocate power 48
(l )

in each CR subcarrier such that the allocated power is inversely proportional to the factor Ki
(l )

that depends on the spectral distance between ith CR subcarrier and the

lth PU band. The allocated power in the ith subcarrier because of the lth interference constraint is written as

Pi = P/Ki ,

(l )

(l)

l,

(5.28)

By using Eq.(5.27), after nulling (2L-1) subcarriers P can be calculated by assuming strict equality in the lth interference constraint in Eq. (5.9). Using Eq. (5.28), in this equality constraint
N 

Pi Ki =

(l )

Ith 2 2l (- ln(1 - a))

(l)

(5.29)

i = ( N , N + 1, · · · , N ) L L i=1

We can derive

P =

Ith 2(N - 2L + 1)2 l (- ln(1 - a))
(l)

(l)

(5.30)

Through Eq.(5.27), (5.28), and (5.30), we can get Pi
(l)

as following

Pi =

(l)

Ith
(l)

2Ki (N - 2L + 1)2 l (- ln(1 - a))

(5.31)

5.3.2

Step 2

In step 1 we calculate the L constraints from interference point of view. In step 2 we will calculate Power values PiL+1 according to the total power constraint. In order to reduce the computation complexity we use GWF instead of standard water-filling 49

algorithm. According to the GWF algorithm described in Chapter 3.2, we can get the following results: The value of P2 (k ) can be solved by subtracting the volume of the water under step k from the total power P , as { [ ( )]}+ N 1 1 P- - i=1 ak a { [ ]}+ i N = P- i=1 k,i

P2 (k ) =

(5.32)

where ai is the channel fading gain, it is expressed as follow
2 |hss i |  (l) 2 + L l=1 Ji

ai =

i = 1, · · · , k ( N ) i, k = N , + 1, · · · , N L L

(5.33)

Due to the definition of P2 (k ), being the power (water volume) above step k , it cann't be a negative number. Therefore we use {·}+ in (5.32) to assign 0 to P2 (k ) if the result inside the bracket is negative. The corresponding geometric meaning is that the kth level is above water. The explicit solution to    sk + (dk - di ) si =   0, where the water level step k  is given as } { k  = max k P2 (k ) > 0, 1  k  K 1  i  k k < i  K,


(5.34)

(5.35)

50

and the power level for this step is 1 P2 (k  ). k

sk =

(5.36)

Then, the power value which satisfies the total power constraint in the ith subchannel can be derive as Pi
(l+1)

= max{0, si } i,

(5.37)

5.3.3

Step 3

The final allocated power according to our proposed suboptimal algorithm is the minimum of the powers we have solved from Eq.(5.31), Eq.(5.37),and Gi as follow

Pisubopt = min{Pi , Pi , · · · , Pi , Pi

(1)

(2)

(L)

(L+1)

, Gi } i,

(5.38)

Gi is the individual power constraint set for every subcarrier. Through our proposed suboptimal algorithm, the resulted allocated power value selected from L+1 power values can satisfy both the interference, total power and individual peak power constraints.

5.4

Simulation Results

In this section we present a numerical example where we assume that there are three PU bands (L=3), and there are twelve OFDM subcarriers (N = 12) for the CR user. The values of Ts , f, B1 , B2 , and B3 have been assigned to be 4 seconds, 0.3125 MHz, 1 MHz, 2 MHz, and 5 MHz, respectively. AWGN variance,( 2 ) is assumed to be equal to 10-8 W and the channel fading gains are assumed to follow rayleigh distribution. The
sp 2 sp 2 sp 2 2 average channel power gains for |hss i | , |h1 | , |h2 | and |h3 | are assumed to be -10 dB,

51

-5 dB, -7 dB, and -10 dB, respectively. The values of Ji are generated randomly with an average value of 1 × 10-6 W . The values of Ith , and Ith have been assumed to be
(1) (3)

(l)

1 × 10-6 W , and 5 × 10-6 W , respectively. Average transmitted data rates for different algorithms under consideration are obtained from 30, 000 independent simulation runs. In Figure 5.1, we plot the achievable maximum transmission rate for the CR user versus individual power constraints for various algorithms. The value of Ith has been fixed to 2 × 10-6 W , the total power PT has been fixed to be 5 × 10-4 W, and the value of  has been considered to be 0.95. From this figure, we observe that the proposed optimal algorithm is able to achieve higher transmission rate for a given power budget than the suboptimal algorithm. It should be noted that as we increase the individual power constraint for CR user, the transmission rate of CR user does increase as the individual peak power constraint increases. This is expected as individual subcarrier can be allocated more power. In Figure 5.2, we plot the achievable maximum transmission rate for the CR user versus the total power budget for various algorithms. The value of Ith has been fixed to 2 × 10-6 W , the individual peak power constraint Gj has been fixed to 2 × 10-6 W , and the value of  has been considered to be 0.95. From this figure, we observe that the proposed optimal algorithm is able to achieve higher transmission rate for a given power budget than the suboptimal algorithm. It should be noted that as we increase the power budget for CR user, the interference constraint becomes dominant and the transmission rate of CR user does not increase as the power budget increases. This is expected as in this region the CR system operates in an interference limited scenario. In Figure 5.3, we plot the achievable transmission data rate for the CR user versus interference threshold for the second PU band, (Ith ) for all the algorithms under consideration. The value of total transmit power, PT has been assumed to be 5 × 10-4 W, the individual peak power constraint Gj has been fixed to 2 × 10-6 W , and the value of  has been considered to be 0.95. Again, we observe that the proposed 52
(2) (2) (2)

2 1.8 Transmission date rate of CR User(in bps) 1.6 1.4 1.2 1 0.8 0.6 0.4 0.2 0

x 10

6

Optimal Suboptimal Water-filling Uniform

0

0.5

1 1.5 2 2.5 Individual Peak Power Constraints (in watts)

3 x 10
-6

Figure 5.1: Transmission rate of the CR user vs. Individual power constraints, with which instantaneous interference introduced to the PU band remains below interference threshold, I th optimal algorithm achieves higher transmission rate than that of other algorithms. The proposed suboptimal algorithm performs better than classical algorithms. Further, water-filling algorithm achieves higher transmission rate than the uniform algorithm. The transmission rate versus interference threshold curve saturates after a certain value of (Ith ). The reason is that although (Ith ) is relaxed by increasing its value, other constraints ((Ith ),(Ith ), and PT ) becomes dominant. In Figure 5.4, we plot achievable transmission rate for the CR user versus probability . The individual peak power constraint Gj has been fixed to 2 × 10-6 W , the values of PT , and (Ith ), is assumed to be 5 × 10-4 W , and 2 × 10-6 W , respectively. As expected,
(2) (1) (3) (2) (2)

we observe that the proposed optimal algorithm performs best over other algorithms. 53

12

x 10

5

Transmission date rate of CR User(in bps)

10

8

6

4

2

0

optimal Suboptimal Water-filling Uniform 0 0.2 0.4 0.6 Power budget(in watts) 0.8 x 10 1
-3

Figure 5.2: Maximum transmitted data rate vs. power budget (PT) for CR users Also, suboptimal algorithm outperforms better than the water-filling algorithm, which performs better than the uniform power loading algorithm. It is observed from Figure 5.4 that as expected as the value of  increases, the achievable transmission rate of CR user decreases for a given power budget, individual peak power constraint, and interference thresholds.

5.5

Chapter Summary

In this chapter, we add an peak power constraint in a SU of CR systems to further protect PUs. We give an optimal solution and also give an suboptimal solution which reduces the computation complexity. The simulation results show the peak power

54

12

x 10

5

Transmission date rate of CR User(in bps)

10

Optimal Suboptimal Water-filling Uniform

8

6

4

2

0

0

0.2 0.4 0.6 0.8 Interference introduced to 2nd PU band(in watts)

1 x 10
-5

Figure 5.3: Transmission data rate of the CR user vs. interference threshold for the 2nd PU
2 band, Ith

constrain can further protect the PUs and the suboptimal solution performs better than water-filling and uniform power allocation algorithms.

55

12

x 10

5

Transmission date rate of CR User(in bps)

10

8

6

4

2

0 0.75

Optimal Suboptimal Water-filling Uniform 0.8 0.85 0.9 Probability, 0.95 1

Figure 5.4: Transmission rate of the CR user vs. probability,  with which instantaneous interference introduced to the PU band remains below interference threshold, I th

56

Chapter 6 CONCLUSIONS AND FUTURE WORK

6.1

Conclusions

In this thesis, first we develop an novel cognitive radio concept using underlay channel band and an optimal power allocation algorithm for the orthogonal frequency division multiplexing (OFDM)-based CR system with total power, interference and individual peak power constraints. Also we developed an suboptimal power allocation algorithm using nulling method for this problem in order to reduce the complexity of computation. As such the transmission rate of the CR user is maximized for a given total power budget, probabilistic interference and individual peak power constraints. Instead of instantaneous channel fading gains between the PU receivers and the CR transmitter, the developed power allocation algorithm requires the fading statistics and corresponding parameters to be known at the CR transmitter. Second, we propose and investigate performance of a low complexity suboptimal power allocation algorithm for subcarrier power allocation with total power and interference

57

constraints. Simulation results have shown that our proposed optimal and suboptimal power allocation algorithms can achieve higher transmission rate for CR user compared to the existing power allocation algorithms namely, the uniform and water-filling power allocation algorithms. The proposed low complexity suboptimal algorithm achieves better performance than existing suboptimal, uniform and water-filling power loading algorithms.

6.2

Future work

Based on this work, some open areas and potential research directions that might be interesting to pursue in the future are listed below. ­ We solve the optimal solution using Langrange Equation, KKT conditions and Newton's method. It may be solved by a faster and low complexity method which is under investigation. ­ We estimate suboptimal power allocation algorithms. It is worthy to investigate other suboptimal algorithms which can lower the complexity and approach the performance limit of optimal solutions. ­ We assume that the probability of the channel states information is known in our analysis. This work can be extended to study the impact of other imperfect sensing conditions for the case of CR transmission. ­ We use fixed threshold to be one of the constraints. It would be interesting to investigate methods of adaptively changing the threshold levels to further optimize the performance.

58

Bibliography
[1] P. He, L. Zhao, S. Zhou, and Z. S. Niu, "Water-filling: A Geometric Approach and Its Application to Solve Generalized Radio Resource Allocation Problems," IEEE Trans. Wireless Communications, vol. 12, pp. 3637­3647, July 2013. [2] L. Zhang, Y. C. Liang, and Y. Xin, "Joint Beamforming and Power Allocation for Multiple Access Channels in Cognitive Radio Networks," IEEE J. Select. Areas Communications, vol. 26, pp. 38 ­ 51, Aug. 2008. [3] P. Wang, X. F. Zhong, L. M. Xiao, S. D. Zhou, and J. Wang, "A General Power Allocation Algorithm for OFDM-Based Cognitive Radio Systems ," IEEE International Conference on Communications Workshops, pp. 1­5, 2009. [4] S. C. Yan, P. Y. Ren, and F. S. Lv, "Power Allocation Algorithms for OFDMBased Cognitive Radio Systems ," IEEE International Conference on Wireless Communications Networking and Mobile Computing(WiCOM), pp. 1­4, 2010. [5] S. Haykin, "Cognitive radio: Brain Empowered Wireless Communications," IEEE J. Selet. Areas Communications, vol. 23, pp. 201­205, Feb. 2005. [6] I. F. Akyildiz, W. Y. Lee, M. C. Vuran, and S. Mohanty, "Next generation/dynamic spectrum access/cognitive radio wireless networks: A survey," Computer Networks Journal, vol. 50, pp. 2127­2159, May 2006. [7] W. C. Jakes, Microwave Mobile Communications. New York, Wiley, 1993.

59

[8] Y. Nasser, M. des Noes, L. Ros, and G. Jourdain, "Sensitivity of OFDM-CDMA Systems to Carrier Frequency Offset," in IEEE International Conference on Communications, vol. 10, pp. 4577­4582, June 2006. [9] R. Nee and R. Prasad, OFDM for Wireless Multimedia Communications. Artech House Publishers, 2000. [10] L. Hanzo, M. Munster, B. J. Choi, and T. Keller, OFDM and MC-CDMA for Broadband Multi-User Communications, WLANs and Broadcasting. John Wiley and Sons Ltd., West Sussex, England, 2003. [11] S. B. Weinstein and P. M. Ebert, "Data Transmission by Frequency Division Multiplexing Using the Discrete Fourier Transform," IEEE Transactions on Communications, vol. 19, pp. 628­634, October 1971. [12] N. Devroye, P. Mitran, and V. Tarokh, "Achievable Rates in Cognitive Radio Channels," IEEE Trans. Info. Theory, vol. 52, pp. 1813­1827, May 2006. [13] J. Wu, L. Yang, and L. Xu, "Resource Allocation Based on Linear Waterfilling Algorithm in CR Systems," IEEE International Conference on Wireless Communications, Networking and Mobile Computing (WiCOM), pp. 1­4, 2011. [14] C. H. Chen and C. L. Wang, "An efficient power allocation algorithm for multiuser ofdm-based cognitive radio systems," in Proc. IEEE Wireless Communications and Networking Conf., pp. 1­6, 2010. [15] J. Jang and K. B. Lee, "Transmit power adaptation for multiuser OFDM systems," IEEE J. Select. Areas Communications, vol. 21, pp. 171 ­ 178, 2003. [16] G. Bansal, J. Hossain, and V. K. Bhargava, "Adaptive Power Loading for OFDMBased Cognitive Radio Systems with Statistical Interference Constraint," IEEE Trans. Communications, vol. 10, pp. 2786 ­ 2791, July 2011.

60

[17] A. Goldsmith, S. Jafar, I. Maric, and S. Srinivasa, "Breaking spectrum gridlock with cognitive radios: An information theoretic perspective," IEEE J. Select. Areas Communications, vol. 97, pp. 894­914, May 2009. [18] P. Wang, M. Zhao, X. F. Zhong, L. M. Xiao, S. D. Zhou, and J. Wang, "Power Allocation in OFDM-Based Cognitive Radio Systems ," IEEE Global Telecommunications Conference, pp. 4065­4065, 2007. [19] Z. Yonghong and C. Leung, "Resource Allocation in an OFDM-Based Cognitive Radio System," IEEE Transactions on Communications, vol. 57, pp. 1928­1931, July 2009. [20] H. Yaiche, R. R. Mazumdar, and C. Rosenberg, "A game theoretic framework for bandwidth allocation and pricing in broadband networks," IEEE/ACM Trans. Netw., vol. 8, pp. 667­668, Oct. 2000. [21] F. Wang, M. Krunz, and S. Cui, "Price-Based Spectrum Management in Cognitive Radio Networks," IEEE Journal of Selected Topics in Signal Processing, vol. 2, Feb. 2008. [22] C. Shi, R. Berr, and M. Honig, "Distributed interference pricing for OFDM wireless networks with non-separable utilities," Information Sciences and Systems, pp. 755­760, Mar. 2008. [23] F. F. Digham, "Joint Power and Channel allocation for Cognitive Radios," IEEE International Conference on Wirealess Communications and Networking, pp. 882 ­ 88, Apr. 2008. [24] A. Jovicic and P. Viswanath, "Cognitive radio: An information-theoretic perspective," IEEE Interational Conference on Infermation Theory, pp. 2413­2417, July 2006. [25] W. Yu, G. Ginis, and J. Cioffi, "Distributed Multiuser Power Control for Digital Subscriber Lines," IEEE J. Select. Areas Commun., vol. 20, pp. 1105­1115, June 61

2002. [26] X. Wang and Q. Zhu, "Power control for cognitive radio base on game theory," IEEE International Conference on Wireless Communications, Networking and Mobile Computing, pp. 1256­1259, Sept. 2007. [27] D. J. Goodman and N. B. Mandayam, "Power control for wireless data," IEEE Personal Communications Magazine, vol. 7, pp. 48­54, Apr. 2000. [28] S. M. Almalfouh and G. L. Stuber, "A two-step resource allocation algorithm in multicarrier based cognitive radio systems," IEEE International Conference on Wireless Communications and Networking, vol. 60, pp. 1699­1713, Apr. 2011. [29] P. Kaligineedi, G. Bansal, and V. K. Bhargava, "Power Loading Algorithms for OFDM-Based Cognitive Radio Systems with Imperfect Sensing," IEEE Trans. Wireless Communications, vol. 11, pp. 4225­4230, Dec. 2012. [30] G. Bansal, P. Kaligineedi, and V. K. Bhargava, "Joint Sensing and Power Loading Algorithms for OFDM-Based Cognitive Radio Systems ," in Proc. IEEE Wireless Communications and Networking Conf., pp. 1­5, Apr. 2010. [31] G. Bansal, J. Hossain, and V. K. Bhargava, "Optimal and Suboptimal Power Allocation Schemes for OFDM-based Cognitive Radio Systems," IEEE Trans. Communications, vol. 7, pp. 4710 ­ 4718, Nov. 2008. [32] D. T. Ngo, C. Tellumbra, and H. H. Nguyen, "Resource allocation for OFDMbased cognitive radio multicast networks with primary user activity consideration," IEEE Transaction on Vehicular Technology, vol. 59, pp. 1668­1679, May 2010. [33] G. Bansal, M. J. Hossain, V. K. Bhargava, and T. Le-Ngoc, "Subcarrier and Power Allocation for OFDMA-Based Cognitive Radio Systems With Joint Overlay and Underlay Spectrum Access Mechanism," IEEE Trans. Vehicular Tech., vol. 62, pp. 1111­1112, Mar. 2013. 62

[34] Z. Hasan, G. Bansal, E. Hossain, and V. K. Bhargava, "Energy-efficient power allocation in OFDM-based cognitive radio systems: A risk-return model ," IEEE Trans. Wireless Communications, vol. 8, pp. 6078­6088, Dec. 2009. [35] G. Bansal, Z. Hasan, J. Hossain, and V. K. Bhargava, "Subcarrier and power adaptation for multiuser OFDM-based cognitive radio systems," National Conference on Communications(NCC), pp. 1­5, Jan. 2010. [36] T. Weiss, J. Hillenbrand, A. Krohn, and F. K. Jondral, "Mutual interference in OFDM-based spectrum pooling systems," IEEE Vehicular Technol. Conf., vol. 4, pp. 1873­1877, May 2004. [37] L. Zhang, Y. C. Liang, and Y. Xin, "Joint Beamforming and Power Allocation for Multiple Access Channels in Cognitive Radio Networks ," IEEE Journal on Selected Areas in Communications, vol. 26, pp. 38­51, 2008. [38] D. P. Palomar and J. R. Fonollosa, "Practical algorithms for a family of waterfilling solutions ," IEEE Transactions on Signal Processing, vol. 53, pp. 686­695, 2005. [39] C. H. Chen and C. L. Wang, "An Efficient Power Allocation Algorithm for Multiuser OFDM-Based Cognitive Radio Systems," IEEE Wireless Communications and Networking Conference (WCNC), pp. 1­6, 2010. [40] J. Wu, L. X. Yang, and X. Liu, "Subcarrier and Power Allocation in OFDM Based Cognitive Radio Systems ," IEEE International Conference on Intelligent Computation Technology and Automation (ICICTA), vol. 2, pp. 728­731, 2011. [41] P. Zhang, L. X. Yang, and X. Liu, "Subcarrier and Power Allocation in OFDM Based Cognitive Radio Systems ," International Journal of Computer Network and Information Security, vol. 1, pp. 24­30, 2010. [42] Q. L. Qi, A. Minturn, and Y. Q. Yang, "An efficient water-filling algorithm for power allocation in OFDM-based cognitive radio systems," IEEE International Conference on Systems and Informatics (ICSAI), pp. 2069­2073, 2012. 63

[43] Q. Qi, A. Minturn, and Y. Yang, "An efficient water-filling algorithm for power allocation in OFDM-based cognitive radio systems," Systems and Informatics (ICSAI), pp. 2069 ­ 2073, 2012. [44] J. Liu, Y. Song, S. Yang, J. Song, and B. Ning, "Optimal power allocation in OFDM-based cognitive radio systems," Cross Strait Quad-Regional Radio Science and Wireless Technology Conference (CSQRWC), vol. 2, pp. 877 ­ 880, Sept. 2011. [45] M. A. McHenry, "NSF Spectrum Occupancy Measurements Projects Summary," Shared Spectrum Company Report, Nov. 2005. [46] S. G. Glistic, Advanced Wireless Commuincations, Second Edition. John Wiley Sons, Ltd., 2007. [47] G. Bansal, J. Hossain, and V. K. Bhargava, "Adaptive Power Loading for OFDM Based Cognitive Radio Systems," IEEE International Conference on Communications, pp. 5137­5142, June 2007. [48] A. Wyglinski, "Effects of bit allocation on non-contiguous multicarrierbased cognitive radio transceivers," IEEE Vehicular Technol. Conf., pp. 1­5, Sept. 2006. [49] P. Cheng, Z. Zhang, H. Huang, and P. Qiu, "A distributed algorithm for optimal resource allocation in cognitive OFDMA systems," IEEE International Conf. on Commun., pp. 4718­4723, May 2008.

64

