POWER FACTOR CONTROL IN A WIND ENERGY CONVERSION SYSTEM VIA SYNCHRONOUS GENERATOR EXCITATION

By Murad Jafari

MSc. Electrical Engineering, Odessa Polytechnic Institute, Odessa, Ukraine, 1993

A project report presented to Ryerson University in partial fulfillment of the requirements of the degree of Master of Engineering in the program of Electrical and Computer Engineering

Toronto, Ontario, Canada, 2014 © Murad Jafari, 2014

Author's Declaration

I hereby declare that I am the sole author of this project report. I authorize Ryerson University to lend this project report to other institutions or individuals for the purpose of scholarly research

I further authorize Ryerson University to reproduce this project report by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

I understand that my project report may be made electronically available to the public.

i

POWER FACTOR CONTROL IN A WIND ENERGY CONVERSION SYSTEM VIA SYNCHRONOUS GENERATOR EXCITATION
Murad Jafari Master of Engineering Electrical and Computer Engineering Ryerson University, Toronto 2014

Abstract

For high power wind turbines current sources converter (CSC) topologies offer favourable features such as a simple structure, grid friendly waveforms, and reliable grid short circuit protection. Several topologies have been proposed to achieve maximum power point tracking (MPPT) in a wind energy conversion system (WECS) and control the output power factor within a wide range of wind speeds. Some of these topologies are reviewed and a novel approach and control strategy is proposed. The proposed system consists of an electrically excited synchronous generator (EESG), a diode rectifier on the generator-side, and a pulse wave modulated (PWM) current source inverter (CSI) on the grid-side. In the proposed control scheme, the diode rectifier does not offer any control freedoms, therefore controlling the output power and the power factor falls on the EESG and the PWM CSI. The generator excitation is controlled according to the wind speed value to improve operation range whereby the desired grid side power factor can be maintained, while the control freedoms of the CSI are used to regulate the power output of the WECS and to perform maximum power point tracking (MPPT). ii

Theoretical analysis was conducted to investigate the feasibility and limits of this approach and the factors affecting it, and computer simulations confirmed the validity of this approach, showing an improved wind speed range where the desired power factor was maintained.

iii

Acknowledgements
I would like to express my deep gratitude to my supervisor, Professors Bin Wu for his invaluable guidance, generous support, and consistent kindness throughout the course of the work.

I would like also to thank my friend, Dr. Mitesh Popat, for his assistance and all of the interesting discussions we have had regarding this project and other matters. I wish him good luck in his future endeavours.

My sincere thanks also go to the Program Director Dr. Lian Zhao. Thank you for supporting me as I continued my master's program after moving to Thunder Bay.

Many thanks go as well to the kind professors and staff at Lakehead University for their guidance and support. I would like to name among them Dr. Wilson Wang, Dr. Basel Ismael, and Dr. Abdelhamid Tayebi.

iv

Publication
[1] M. Jafari, B. Wu and M. Popat, "POWER FACTOR CONTROL IN A WIND ENERGY CONVERSION SYSTEM VIA SYNCHRONOUS GENERATOR EXCITATION," in CCECE2013, Regina, Saskatchewan, 2013.

v

Table of Contents
Author's Declaration Abstract Acknowledgements Publication Table of Contents List of Tables List of Figures Glossary Acronyms Variables and Parameters Chapter 1 Introduction 1.1 Background about Wind Energy Conversion Systems 1.2 Gearbox Coupled Systems with DFIG 1.3 Direct Drive WECS 1.4 Voltage Source Converter vs. Current Source Converter based WECS 1.5 Introduction to Subsequent Chapters Chapter 2 Motivation and Proposal 2.1 Motivation of the Project 2.2 Project Proposal 2.3 Chapter Summary Chapter 3 Theoretical Analysis 3.1 The Generator side 3.2 The Grid side 3.3 Chapter Summary vi i ii iv v vi viii ix xi xi xii 1 1 3 4 5 8 9 9 10 11 12 12 18 23

Chapter 4 Modeling and Analysis of the System 4.1 System Configuration 4.2 The Current Source Inverter 4.3 The DC Link 4.4 The Grid Side 4.5 State Space Representation of the Grid Side 4.6 Small Signal Model 4.7 System Stability & Transfer Function Derivation 4.8 Grid Side Model and Controller Design 4.9 Grid Side Reactive Power Control 4.10 Excitation Control 4.11 Control Scheme 4.12 Chapter Summary Chapter 5 Simulation Verification 5.1. System Response to Changes in Wind Speed and PF Control Range 5.2 Steady State Waveforms on the Grid Side 5.3 Steady State Waveforms on the Generator Side 5.4 Chapter Summary Chapter 6 Conclusions References Appendix A Appendix B Appendix C Appendix D

24 24 26 28 29 29 30 31 32 36 38 38 39 41 41 44 45 49 50 52 54 55 56 57

vii

List of Tables
Table 1 Closed loop pole values Table 2 Simulation system parameters: Table 3 Look-up table for excitation current 34 54 56

viii

List of Figures
Figure 1 Typical components of a WECS Figure 2 Simple representation of the DFIG based WECS Figure 3 A direct drive WECS with PMSG Figure 4A direct drive WECS with EESG Figure 5 per phase diagram of typical MV MSC topologies [2] Figure 6 ABB PCS 6000 using medium-voltage neutral point clamped converter [4] Figure 7 a CSC based WECS with a diode rectifier and a PWM inverter Figure 8 CSC WECS using PWM CSI assisted with a diode rectifier and buck converter [5] Figure 9 proposed system configuration Figure 10 a voltage source connected to a diode rectifier Figure 11 the relationship between the output phase voltage and Vdc [6] Figure 12 the effect of source inductance on commutation in a 3 phase diode rectifier [7] Figure 13 simplified three phase synchronous generator connected to a diode rectifier Figure 14 wind speed vs. the generator speed and power under MPPT Figure 15 the effect of different values of the internal inductance of the dc current 2 3 5 5 6 7 7 9 10 12 13 13 14 15 16

Figure 16 calculated dc current values for a diode rectifier connected to a simplified synchronous generator Figure 17 dc current vs. wind speed at different values for excitation Figure 18 a PWM CSI with a capacitor bank on the grid side Figure 19 phasor diagrams for different cases of the PF Figure 20 grid side requirement for Idc at ma=1 for various PF values Figure 21 operating range at different values of the generator excitation current and a unity output power factor Figure 22 Excitation control to keep the dc current just above the grid side requirement Figure 23 system configuration Figure 24 calculation of dc current reference Figure 25 FFT analysis of the grid current at wind speed = 1pu Figure 26 dc link Figure 27 grid side Figure 28 CSI ­ dc link current control loop ix 22 23 24 25 27 28 29 33 17 18 19 19 21

Figure 29 Open loop bode plot Figure 30 Root locus plot Figure 31Step response Figure 32 Simulated step response of the grid side controller. Figure 33 Control loop for reactive power Figure 34 bode plot for the reactive power open loop transfer function with a controller Figure 35 Block diagram of the control scheme for the system Figure 36 Dc link current tracking Figure 37 Active and reactive power tracking Figure 38 Simulation wind speed profile Figure 39 Dc current response to the wind profile Figure 40 Grid side power factor response to the wind profile Figure 41 Simulated power factor control range with and without excitation control Figure 42 Grid current waveform and FFT at w =1pu Figure 43 Grid current waveform and FFT at w = 0.5pu Figure 44 Generator current at a wind speed of 1pu Figure 45 Generator voltage at a wind speed of 1pu Figure 46 Generator torque in pu at a wind speed of 1pu Figure 47 Generator current at a wind speed of 0.5pu Figure 48 Generator voltage at wind speed of 0.5pu Figure 49 Generator torque at a wind speed of 0.5pu Figure 50 Simulation model

34 35 35 36 37 38 39 41 42 42 43 43 44 44 45 46 46 47 47 48 48 57

x

Glossary
Acronyms
CSC DFIG DPF DPLL DSP EESG EMF FFT LV MPPT MV PF PLL PMSG EESG PWM SVM THD VSC WECS Current Source Converter Doubly-Fed Induction Generator Displacement Power Factor Digital Phase-Locked Loop Digital Signal Processor Electrically Excited Synchronous Generator Electro-Motive Force Fast Fourier Transformation Low Voltage Maximum Power Point Tracking Medium Voltage Power Factor Phase-Locked Loop Permanent Magnet Synchronous Machine Electrically Excited Synchronous Generator Pulse-Width Modulation Space Vector Modulation Total Harmonic Distortion Voltage Source Converter Wind Energy Conversion System

xi

Variables and Parameters
     () () () () () ()     () ()      Generator excitation current DC link current Voltage across the dc link inductor Rectifier side dc link voltage Inverter side dc link voltage Grid side inverter abc phase currents Grid side inverter dq reference frame currents Capacitor abc phase currents Capacitor dq reference frame currents Grid abc phase currents Grid dq reference frame currents DC link inductance Generator synchronous inductance Grid side line inductance Generator stator resistance Grid abc line voltages Grid dq reference frame voltages Generator active power output DC link active power Active power delivered to the grid xii

  PF    w  * 

Generator reactive power output Reactive power delivered to the grid Power factor (on the grid side) Gating angle Modulation index (for the SVM of the inverter) Reference frame angle (grid side) Wind speed Grid side angular frequency Reference value Small perturbation

xiii

Chapter 1 Introduction
Wind energy continues to experience growth in terms of both capital investment and installed capacity despite the recent economic crisis. Canada will enjoy another record year for wind energy development in 2012 with the addition of approximately 1,500 MW of new installed capacity [1].

The main drive for the rapid growth in the development of wind energy generation, in terms of the technology employed for generation and control as well as turbine sizes, is the desire to switch to a more sustainable and environmentally responsible source of energy.

Since wind speed is not constant the amount of power that can be extracted is not reliable, which for large turbines or wind farms connected to the grid can cause grid stability issues. As a result grid operators started to impose codes on large scale wind farms and wind turbines to allow for the integration of wind energy without compromising the stability of the grid.

Connectivity to the grid requires that the output voltage, frequency and power factor be controlled within a wide range of wind speed. To achieve that various means are employed, including using multistage gearboxes to couple the generator to the turbine and/or use power electronic converters in various modifications and control schemes, each offering certain advantages. A more detailed analysis of some of the more common systems is discussed further in this chapter.

1.1 Background about Wind Energy Conversion Systems
A wind energy conversion system (WECS) typically consists of a generator coupled with a wind turbine either directly, which results in a variable speed system rotating at a slow speed, or via a gearbox, which allows to use more compact generators with a lower number of poles due to

1

higher rotation speed. On the output side the generator is connected via a power converter and a step up transformer to the grid. Such a configuration is displayed in figure 1.

Figure 1 Typical components of a WECS

The wind generally blows at variable speeds and directions, and consequently the wind turbine rotates at variable speeds delivering different values of power to the generator. The output of the generator in terms of frequency and magnitude is a function of that wind speed, since to extract the maximum amount of energy from the wind, it is advisable that the tip speed ratio of the turbine, which equals the ratio of the linear speed at the tip of the turbine blade to the speed of the wind, be kept constant at a certain value. Such power signal cannot be delivered directly to the grid, since to synchronize the system with the grid requires matching the grid frequency and voltage, in addition to the phase sequence.

To achieve all of the above variables, power converters are used, which allow controlling the generator speed such that the tip speed ratio is kept at the maximum power point tracking (MPPT) value, as well as match the grid frequency and voltage and meet the operator's required output power factor within a wide range of wind speeds.

As stated above, the generator could be coupled directly with the turbine or via a gear box. One configuration where the generator is coupled via a gearbox with the turbine employs using doubly fed induction generators (DFIG), whereas for direct drive systems, synchronous generators are typically used in the form of either permanent magnet synchronous generators 2

(PMSG) or electrically excited synchronous generators (EESG), each configuration has its advantages and disadvantages, and below is a brief discussion of some of these configurations.

1.2 Gearbox Coupled Systems with DFIG
The generator is coupled with the turbine via a step up gearbox. The generator itself is an induction generator with a wound rotor and contact rings. The stator is directly connected to the grid via a transformer, and the majority of power transfer to the grid goes through this route. To achieve control of the voltage and frequency at the output of the generator, the rotor windings are powered by a power converter, which controls the frequency of the rotor currents and allows controlling the speed up to its maximum capacity. Since this converter carries only a small fraction of the power, it is usually smaller and less costly than a full rating one. The DFIG system topology is illustrated in figure 2.

Figure 2 Simple representation of the DFIG based WECS

This configuration is a rather popular one in wind energy generation since the capital investment required to build it is very competitive largely due to the reduced cost of the fractional rating power converter. On the other hand, however, the use of a generator with a wound rotor requires contact rings and brushes which require regular costly maintenance. Furthermore, the multistage gearbox required to boost the rotation speed of the turbine also requires frequent maintenance. This can be costly and reflects poorly on system reliability. On top of that due to the fact the 3

power converter has only fractional rating, the control range of this configuration is somewhat limited. [2]

1.3 Direct Drive WECS
Variable speed direct drive synchronous generators raise great interest because of their higher efficiency and reliability due to the absence of the gearbox, which requires frequent maintenance. For large scale turbines this technology is very commonly used. In such systems full rating power converters are needed to connect to the grid. This allows controlling the power output of the turbine to achieve MPPT as well as control the power factor on the grid side and match the frequency of the grid in a wide range of wind speeds. On the other hand, full rating power converters can be costly and require complex control schemes, and directly coupled generators tend to be large.

Since in direct drive systems the generator is directly coupled with the wind turbine, it rotates at the same speed as the turbine, which typically rotates at a low speed in the range of 10-15 rpm. At low speeds and high torques, large diameter synchronous generators with a high number of poles are typically used.

Both PMSG and EESG find application in direct drive systems (Figures 3, 4 respectively). The EESG has the added feature of an additional control freedom by adjusting the excitation of the generator, which is not possible in PMSG. That said, EESG suffer from the same drawback that affects DFIG in terms of the need to frequently maintain the brushes and contact rings supplying the rotor windings. PMSG on other hand are very efficient and require little maintenance but offer no control freedoms.

As stated above, direct-drive configurations require a full-rating power converter between the stator circuit and the grid to enable generator speed control. Full rating converters can be costly and not as efficient as the partially rated converter in DFIG. That said, the absence of the gearbox offsets the increased cost of the power converter and improves the reliability of the system. The full-rating power converter also brings full control capability which can be utilized 4

to improve the fault ride-through capability of the WECS. Consequently, the direct-drive configuration with full-rating power converter is a favorable option for megawatt WECS [3].

Figure 3 A direct drive WECS with PMSG

Figure 4A direct drive WECS with EESG

1.4 Voltage Source Converter vs. Current Source Converter based WECS
Voltage source converters (VSC) in different configurations are widely used in WECS and current source converter (CSC) systems were also proposed. Below is a brief description of some of these configurations.

Low voltage (LV) converters are very commonly used in wind generation applications. That said at megawatt level, at LV the output current tends to be significant, reaching thousands of amperes. This results in more difficult commutation, increased losses and bulky cables. 5

Typically a number of converters are connected in parallel to split the current between them, which results in a bulky system with a complex control scheme.

Recently using medium voltage (MV) converter systems became more favourable due to the reduced currents resulting in lower losses, higher efficiencies and improved size and cost. That said, at MV, to avoid high voltage stresses across devices, several devices have to be connected in series which creates the complication of having to synchronize the switching of the gates of the individual converters to properly share the voltage drop. There are several such configurations, which include diode clamped converters, cascaded H-bridge converters and flying capacitor converters, figure 5. Multilevel VSCs in general comprise more devices to help produce more favourable ac voltage waveforms with lower dv/dt and more steps and better total harmonic distortion (THD) [2] .

a- diode clamped

b- cascaded H-bridge

c- flying capacitor

Figure 5 per phase diagram of typical MV MSC topologies [2]

Of the above topologies, the diode clamped one is the one that finds most wide spread application in large wind turbine systems [3]. Figure 6 illustrates the neutral point commutated (NPC) topology of a back to back diode clamped converter used by ABB and Converteam. 6

Figure 6 ABB PCS 6000 using medium-voltage neutral point clamped converter [4]

Recently CSC based WECS gained a lot of attention, since they appear to be promising solutions for high power applications, featuring a compact topology, simple control scheme and grid friendly waveforms. CSC rely on inductors rather than capacitors to keep the dc current steady. The typical topology of a CSC based WECS is illustrated in figure 7.

Figure 7 a CSC based WECS with a diode rectifier and a PWM inverter

Current source inverters (CSI) require capacitors at the output to facilitate device commutation and improve the THD to meet grid requirements. There are several control schemes of CSC for WECS, and among these are:  Pulse wave modulated (PWM) current source rectifier (CSR) on the generator side and PWM current source inverter (CSI) on the grid side, which gives most control freedoms, but the cost of the switching devices is relatively high and the control scheme design is complex. 7



Diode rectifier on the generator side and thyristor inverter on the grid side is a wellestablished and reliable scheme but has poor grid waveforms, lack of reactive power control, and extra investment in the compensation system will more or less counteract its low cost advantage in modern WECS.



Diode rectifier and PWM CSI inverter, where both active and reactive powers transferred to the grid can be controlled but with limited range. The system is simple and less expensive than its counterparts. To improve the control range of this topology, a buck converter was proposed to be added to the dc link to boost the dc current and decouple the grid side from the generator side requirement for the dc current.

1.5 Introduction to Subsequent Chapters
Chapter 2 explains the motivation for the project and outlines the proposed approach and methodology.

Chapter 3 includes a theoretical analysis of the proposed control strategy to determine whether it allows in principle to control the power factor at the grid side of the system within a wide range of wind speeds and to identify that wind speed range and the system parameters that have an impact on the ability of the system to function properly and deliver the expected output.

Chapter 4 goes into detail about the modelling and analysis of the proposed system discussing the system configuration, the individual components, developing the model that describes the system behaviour, linearizing the system around an operating point, developing a small signal model, a transfer function, designing the controllers, and developing the control scheme based on the steady state equations.

Chapter 5 outlines the results of the computer simulations that were conducted to verify the validity of the concept and the designed control scheme. This chapter also includes the conclusions that were reached as a result of this project.

8

Chapter 2 Motivation and Proposal
Chapter 2 explains the motivation of the project going over the advantages of using CSC for megawatt systems and briefly describing the limitations of using a diode rectifier on the grid side. It then moves on to briefly describe the proposed system and how it proposes to address the aforementioned limitations.

2.1 Motivation of the Project
The objective of development in control systems generally is to produce more economical systems with better efficiency and simpler control schemes. The system configuration of a CSC based WECS utilizing a PMSG, a diode rectifier on the generator side and a PWM inverter on the grid side has the advantage of simplicity and economy, though it suffers from the inability of the diode rectifier to apply any control freedoms, leaving all the control objectives to be managed by the grid side PWM CSI, which is adequate for a narrow range of wind speeds.

To address this matter and improve the control range of the system, it was proposed to use a buck converter in the dc link to delink the grid side from the generator side dc current requirements, effectively adding another control freedom to the system and improving the control range by allowing the grid side dc link current value to be above the grid requirement for a desired power factor within a wider operation range [5]. The system configuration is illustrated in figure 8.

Figure 8 CSC WECS using PWM CSI assisted with a diode rectifier and buck converter [5]

9

In this configuration, the PWM controls the active and reactive power components to meet the desired output power factor, whereas the buck converter is tasked with tracking the reference generator speed to achieve MPPT.

2.2 Project Proposal
The system proposed in this project is inspired by the above mentioned configurations to achieve the control objectives with a different configuration and simpler control scheme by eliminating the buck converter, but using an EESG instead of the PMSG, which allows controlling the excitation and thus the generator output voltage and current. The configuration of the proposed system is illustrated in figure 9.

Figure 9 proposed system configuration

The objective of this project is to perform a theoretical analysis to explore the technical feasibility of such a system, identifying the possible operation range and the parameters it would depend on. Furthermore, a goal of the project is to devise a control scheme for such a system and perform computer simulations to verify the results of the theoretical analysis.

The premise of the proposed concept is: Use excitation control to try to keep the dc current level above the grid side requirement.

10

-

Use the PWM CSI to control power output to the grid (active and reactive) and consequently achieve MPPT and control the PF on the grid side.

In this context the excitation control plays a supporting role to the CSI to help improve the range within which the control objectives can be achieved under this configuration. The next chapter will address the theoretical analysis of the EESG-diode rectifier-PWM CSI-grid configuration to help understand the variables at play and how they affect the system.

2.3 Chapter Summary
This chapter discusses the motivation of the project with reference to the advantages of using CSC based systems and the related configurations developed to date and builds on that to introduce the proposed system for this project, which is a CSC based system that uses a diode rectifier on the generator side and a CSI on the grid side. The proposed system uses an EESG instead of a PMSG with the intention of using excitation control to help improve the wind speed range within which the power factor can be controlled on the grid side.

11

Chapter 3 Theoretical Analysis
As stated above, the proposed system consists of an EESG connected to a 3 phase diode rectifier at its output, an inductor in the dc link, and a PWM CSI on the grid side. This chapter aims to explore the physical processes that take place on both the generator and the grid sides of the dc link, analyze the parameters involved and how they impact key values such as the dc current, and draw conclusions on how these parameters will affect the performance of the system.

The outcomes of this chapter can help assess the theoretical viability and understand the limitations of the proposed system. It can also help define the expected control range and other characteristics of the system.

3.1 The Generator side
The generator can be represented by a voltage source with an internal inductance. To simplify matters further, it may be helpful to understand the relationship between the output dc voltage (Vdc) and the input line to line voltage on the generator (or source terminals) while ignoring for the time being the source inductance, as represented in figure 10 below.

Figure 10 a voltage source connected to a diode rectifier

The relationship between the generator output voltage and Vdc can be obtained by calculating the area under the curve and dividing that by the period. This can be seen in figure 11 below.

12

Figure 11 the relationship between the output phase voltage and Vdc [6] 32  = 1.35    

 =

(3-1) (3-2)

PF= 0.955, assuming a displacement power factor (DPF) =1

In reality though, the source inductance cannot be ignored since it impacts the commutation in the diodes, resulting in a reduction of the output voltage and a corresponding increase in the dc current. Figure 12 illustrates the effect source inductance has on diode rectifier commutation. This effect is a result of the fact that due to the inductance when voltage polarity switches the forward biased diodes cannot abruptly switch off and disrupt the current.

Figure 12 the effect of source inductance on commutation in a 3 phase diode rectifier [7]

Assuming that the generator connected to diode rectifier is represented by a 3phase voltage source with an internal source inductance connected to the rectifier, as represented in figure 13, the dc voltage can be calculated according to equation 3-3 below, which reflects the voltage drop from delayed commutation due to source inductance. The commutation angle can be calculated by equation 3-4 below.

13

Figure 13 simplified three phase synchronous generator connected to a diode rectifier

 =

32 3 () -     

(3-3)

2   (3-4) ) () It can be observed from the above equations that the commutation angle is a function of the  =  -1 (1 - source inductance and the dc current, among other things, whereby the higher the source inductance and dc current, the bigger the commutation angle. It is desirable that the commutation angle be not large, since we can see that the higher the commutation angle is, the lower the output voltage is and consequently the higher the dc current is. This is not a feasible mode of operation and should be avoided [7]. The relationship between the dc current and voltage is that their product, ignoring losses in the rectifier, equals the output power of the generator.  =   =   is understood that MPPT can be achieved by maintaining the generator speed at values that would allow the optimal tip speed ratio to be maintained at any wind speed within the operation range. This means that the relationship between the generator speed and wind speed is a linear one. On the other hand research has showed that when MPPT is observed, the generated power is proportional to the cube of the wind speed, which stands to reason given that the average wind power density is proportional to the cube of the wind speed, as can be seen in equation 3-6  = 0.5   3 (Where  is the air density) (3-6) (3-5)

14

1 0.9 0.8 0.7 0.6 0.5 0.4 0.3 0.2 0.1 0 0 0.2 0.4 0.6

Wind speed

0.8

1

Figure 14 wind speed vs. the generator speed and power under MPPT

Given that, it is possible to create reference for the power that can be achieved via MPPT in per unit is equal to the cube of the wind speed in per unit.

By defining Vdc in terms of Pdc and Idc from equation 3-5 above and substituting for Vdc in 3-3, the expression for Idc can be obtained, as expressed in 3-8 below [7].  =  ( 32 3  -   )   (3-7)



32 32 12  ± (   )2 -     = 12  

(3-8)

Clearly, there is a range of parameters (    ) within which it is possible to obtain real values for the solution of  , and beyond that the solution is complex and therefore is not acceptable. In other words, for each source inductance there is a wind speed range where a real solution can be obtained for the dc current. Analysis has showed that with higher values of the source inductance, this range of wind speeds becomes more limited, as can be seen in figure 15. The curves in figure 15 were obtained for a hypothetical 2.5MW generator.

15

7000 6000 5000 Ls=0.2pu Ls=0.4pu 4000 3000 2000 1000 0 0 0.2 0.4 0.6 0.8 1 Wind speed, pu Ls=0.6pu Ls=0.8pu Ls=1pu

Figure 15 the effect of different values of the internal inductance of the dc current

It is noticeable that with lower values of Ls, the value of the dc current is lower at any wind speed, and with higher values of Ls, it is not possible to obtain a real value of the dc current at close to rated wind speed, which means with higher values of source inductance commutation is such that the system will not function properly.

Meanwhile within the range where a real value of the dc current can be obtained, given that the solution for equation 3-7 is that of a quadratic equation, two values can be obtained, one far greater than the other and hence is rejected since it is an unreasonable value of the dc current resulting in significantly more losses. Figure 16 displays the two solutions of the quadratic equation for the dc current. The calculation is based on the simulation system parameters in Appendix A.

dc current, A

16

Idc, pu
12 10 8 Idc(-) 6 4 2 0 0 0.2 0.4 0.6 0.8 Idc(+)

, pu
1

Figure 16 calculated dc current values for a diode rectifier connected to a simplified synchronous generator

By examining the expression in equation 3-8, it is clear that another variable that could affect the value of the dc current is the electro-motive force (EMF) induced in the stator winding. In a PMSG, this is only a function of the rotation speed and, therefore, is not an independent variable. In an EESG, however, the value of the EMF (ELL) can be also adjusted by controlling the excitation current. Theoretically, at any wind speed if MPPT is observed, the output power is a function of the wind speed as stated earlier.

To simplify analysis, the saturation of the core is ignored, and this to an extent can be validated since the analysis is conducted primarily for lower values of excitation currents. Under these conditions the relationship between the excitation current and the magnetic flux, and consequently the generated EMF, can be deemed linear. Consequently a decrease in the excitation current results in an equal decrease in generated EMF, so long as the rotation speed, and consequently generated power ­ per MPPT, is kept constant.

Given this assumption and equation 3-8, it is possible to analyze the relationship between the dc current and wind speed for different values of excitation current. This relationship is showed in 17

figure 17 where it is clear that lowering the excitation current results in an increase in the dc current at a given wind speed. It is also noticeable that at lower excitation values and wind speeds, obtaining a real value for the dc current becomes impossible since the value of the first term under the radical in equation 3-8 becomes less than that of the second term. The calculations for figure 17 are based on the simulation generator which parameters are in Appendix A.

Idc, A
7000 6000 5000 4000 3000 2000 1000 0 0 0.2 0.4 0.6 0.8 If=1 pu If=0.8 pu If=0.6 pu If=0.4 pu

, pu
1

Figure 17 dc current vs. wind speed at different values for excitation Based on the results demonstrated in figures 15 and 17 above, it is possible by controlling excitation, for a generator with a value of Ls below 0.4 pu, to adjust the value of the dc current at different values of the wind speed going all the way up to the rated value.

3.2 The Grid side
As shown in figure 18 below, the grid side converter is a PWM CSI that connects directly to the grid. The capacitor bank at the output is necessary for proper commutation of the switching devices and to help improve the signal THD [2]. That said the capacitor bank also consumes considerable reactive power which needs to be compensated for by the inverter to meet grid required power factor.

18

Vc Iwi Ic Igr

LLine

Vgr

Figure 18 a PWM CSI with a capacitor bank on the grid side

Assuming that the reference frame for the grid side voltages and currents is aligned with the grid voltage, and that the voltage drop across the line inductance is minimal, it is possible to assume that the capacitor voltage is equal to the grid voltage, in which case the capacitor current would be leading by 90 degrees and be independent of the wind speed, since the grid is assumed to be stiff and the voltage on the grid side constant.

For different scenarios of the grid side power factor (leading, lagging and unity), it is possible to build phasor diagrams to identify the grid side requirement for the CSI output current for each of these situations. Figure 19 demonstrates these phasor diagrams for the same value of active power output.

Figure 19 phasor diagrams for different cases of the PF If we align the reference frame to the phase voltages of the grid, the d-axis component of the voltage is equal to the magnitude of the phase voltage, while the q-axis component is equal to

19

zero. Accordingly, the s and q-axis components of the grid side current can be calculated as follows: - =   1.5-  1.5- (3-9)

- = -

(3-10)

The steady state capacitor currents can be calculated, if we ignore the line voltage drop, according to the capacitor voltage which is considered equal to the grid voltage.  = - -  0  = - With that assumption the capacitor current is basically assumed to be equal to its d-axis component since the q-axis component of the grid voltage is, as stated above, equal to zero. The grid side inverter d and q-axis currents are equal to the sum of their respective capacitor and grid currents, or:  = - +   = - +  (3-13) (3-14) (3-11) (3-12)

And the grid side required dc current is equal to the total grid side inverter current divided by the modulation index: - = 1 2  2 +    (3-13)

It is possible to see from figure 19 that grid required current is lowest in the case of the lagging power factor and highest in the case of the leading power factor. Based on these conclusions and assuming the value of the modulation index of the inverter (ma= 1) to maintain the lowest possible value of the dc current, calculations were run for different values of the wind speed at the rated grid voltage value and other system parameters as indicated in Appendix A, the output power was defined as a function of the wind speed, assuming no system losses, and the value of the grid current was calculated for different values of PF. Figure 20 illustrates the results of these

20

calculations and confirms that the grid required current is highest for leading power factors and lowest for lagging power factors.
Idc,A 4500
4000 3500 3000 2500 2000 1500 1000 500 0 0 0.2 0.4 0.6 0.8 PF=0.95 Leading PF=1 PF=0.95 Lagging

,pu
1

Figure 20 grid side requirement for Idc at ma=1 for various PF values

It is noticeable from figure 20 that at lower wind speeds the power factor value has little effect on the dc current required by the grid, and that at =0 the grid side required dc current does not drop to 0 since the capacitor will still require reactive current.

To be able to support the grid required PF at the output, the generator side has to be able to supply the grid required value of the dc current. By overlaying figures 17 and 20, it is possible to determine the wind speed range within which the desired PF can be supported, as can be seen in figure 21. It is clear that for a diode rectifier without excitation control this range is limited

21

Figure 21 operating range at different values of the generator excitation current and a unity output power factor

As can be seen from the figure above, the operating range of the system is the range wherein the generator side is able to supply a dc current at least equal to that required by the grid. For different values of excitation that range is different; lower values of excitation at lower wind speeds, at least in theory, help improve the operating range. That said, at higher wind speeds it is advisable to keep the excitation current higher to keep the dc current at the lowest possible value to reduce dc link losses.

The goal of the control scheme would be to control the power delivered to grid using the grid side PWM CSI and to use excitation to maximize the operating range for the grid side desired power factor. For simplicity it will be assumed that unity PF is desired on the grid side. Figure 22 below demonstrates the principle of using excitation to maintain the dc current at values close to those required by the grid for each wind speed.

22

Figure 22 Excitation control to keep the dc current just above the grid side requirement

3.3 Chapter Summary
This chapter discussed the relationship between wind speed and the generator power that is expected while adhering to MPPT. It also established the relationship between the dc current produced by a 3 phase diode rectifier connected to a generator driven by a wind turbine, exploring the impact of commutation due to the generator source inductance on the dc current and voltage and developing an equation that reflects the impact of the synchronous inductance and generator excitation on the dc current for a given wind speed.

On the grid side - in addition to explaining the configuration and the relationships between the grid side inverter current, the current of the capacitor which is used to improve commutation in the inverter and the THD on the grid side, and the grid current - the grid side driven value of the dc current as a function of wind speed is derived. By contrasting the generator and grid side driven values of the dc current, it is demonstrated how this impacts the control range and how excitation can help improve that range.

23

Chapter 4 Modeling and Analysis of the System
In this chapter the dynamic and steady state modeling of the proposed system will be explored. Small signal modeling will be conducted and transfer functions developed leading to the design of a controller for the system.

4.1 System Configuration
Gen-Side Converter Grid Side Converter

Pg g

VLdc Idc Ldc Vdcr Vdci

Vc Iwi Igr

Vgr

Ic

Pgr Qgr C

Figure 23 system configuration

Figure 23 shows the system configuration. As explained earlier the EESG is directly connected to the wind turbine, and its terminals are connected to a three phase diode rectifier, which offers no control freedoms. Achieving MPPT requires control of the turbine, or the generator rotor, speed such that the tip speed ratio remains constant and equal to the optimal value. Generally this is achieved by using the wind speed as reference and comparing the measured rotor speed with it to create a reference for the q-axis current of the generator, while the d-axis component is compared with 0 (assuming unity power factor). This approach would be used to calculate the modulation index and angle shift for the SVM gating signal generator of the CSR on the generator side. However, since there is a diode rectifier on the generator side, this approach cannot be used.

Furthermore, the Simulink model for an EESG allows two types of input: speed or power, and choosing speed automatically sets the rotation speed of the turbine (rotor) to the reference value. 24

It is clear that controlling the power delivered to the grid and the dc current falls to the CSI on the grid side. That said these two functions can be combined, if the reference for the dc current is obtained analytically for a given wind speed and given excitation.

The following assumptions are made: The system is lossless, i.e. the power delivered to the grid is equal to the power generated. The rated power (1 pu) at the rated wind speed (1 pu) represents the maximum power that can be obtained at that speed, and with MPPT in place, generally P  3 . In other words, in per unit, for any wind speed the maximum power that can be extracted is equal to the cube of that wind speed, or if standard units, equal the cube of the wind speeds in per unit multiplied by the rated power. MPPT is achieved in steady state operation. The power factor on the grid side is maintained at unity.

Figure 24 calculation of dc current reference

Based on this it is possible to define the reference value of the dc current using equation 3.8, as seen in figure 24 above, which takes into account wind speed and generator excitation. This simplified arrangement ignores generator saturation.

By comparing the measured value of the dc current with this reference and multiplying with the measured value of the dc current, reference for the active power is created.

On the grid side both the 3 phase voltage and current are measured. Using phased locked loop (PLL) abc values are transformed into dq values, as stated earlier, in a reference frame aligned with the phase voltage. The d-axis component of the current represents active power, since it is in phase with the voltage, whereas the q-axis component represents reactive power. 25

The transformation from abc to qd for a balanced 3 phase system, whether on the grid side or the generator side, is done knowing the phase shift angle () between the reference frame d-axis and the phase (a) axis. cos( - 2/3) - sin( - 2/3) cos( - 4/3)  ] [ ] -( - 4/3) 

2 cos()  [ ] = [ 3 - sin() 

(4-1)

Here X denotes a system variable, such as current and voltage, etc. Where there are differential terms, such as in the relationship between the voltage and current across an inductor:  =    (4-2)

Applying dq transformation to the differential term results in added terms that include , which is the derivative of  [8].

 [] 0  +[   

- [] ]  0

(4-3)

Where : [] = [   ] , and [] = [  ]

4.2 The Current Source Inverter
The space vector pulse wave modulator (SVPWM) employed creates ac waveforms that exhibit low 5th and 7th harmonics in the order of 2%, as can be seen in figure 25 below.

26

Figure 25 FFT analysis of the grid current at wind speed = 1pu

Any higher order harmonics are taken care of by the LC filter. With this in mind the relationship between the grid side inverter current and the dc current can be expressed as [3]: [ ] = [ ]  or, [ ] = [ ]   cos( - ) 2 = [ cos( -  - /3)],  cos( -  + 2/3) (4-4-1) (4-4-2)

Where: [ ]

and  is the fundamental frequency and  is the delay angle of the grid side inverter current. If we ignore the losses in the CSI, the power [3]:   = [ ]  [ ] Or from the above two equations:
  = [ ]  [ ] = 1.5[ ] [ ]

(4-5)

(4-6)

And since the capacitor current is equal to the capacitance times the derivative of the voltage: [ ]  The grid current would be equal to the inverter current minus the capacitor current: [ ] =  [ ] = [ ] - [ ] 27 (4-7)

(4-8)

Transforming 4-7 into d-q using 4-1    0 [ ] =  ( [  ] + [       -   -  ] [  ]) = [  ]   0  +     -      [ ] = [ ]  - [ ] = [ ]  - [  ]       +    1  = (  -  ) +     1  = (  -  ) -   

(4-9)

(4-10)

(4-11) (4-12)

4.3 The DC Link
Figure 26 below represents the dc link of the system, which is an inductor that connects the rectifier with the inverter.

Figure 26 dc link The voltage drop across the inductor is clearly equal to the difference between the voltages on the rectifier and the inverter and is equal to:  =   =  -  =  - 1.5[ ]  [ ]  (4-13)

 1  = ( - 1.5[ ] [ ]  )   28

(4-14)

4.4 The Grid Side
Disregarding active losses in the line, the remaining voltage drop along the line occurs due to the line inductance, as per figure 27 below.

Figure 27 grid side Based on the above diagram, it is possible to write to the voltage equation for the grid side as:  =   =  -   (4-15)

The above equation in dq representation can be transformed into:
       

=  ( -  +  )


1

(4-16) (4-17)

=  ( -  -  )


1

4.5 State Space Representation of the Grid Side
The state space representation in matrix form has the following expression:   =  +    =  +  Where x is the matrix of the state variables, and u is the matrix of the state inputs, and y is the system output. In this case:  = [     ] 29 (4-19)

(4-18)

 = [  0 -  -1  =  0 [ 0   0 0 -1  0 1  0 0

   ] 0 -1   0 -1.5  0 0     0 ]

(4-20)

(4-21)

- -1.5  -1  0 0 0 0

0 0  = 0 0 1 [

0 -1  0 0 0

0 0 0 0 0

0 0 0 0 0 ] (4-22)

The value of C and D depends on the selected output of the system.

4.6 Small Signal Model
A typical approach to study the stability of a nonlinear system is to linearize the system within a small range around an operating point, similar to approximating a nonlinear curve into very small linear segments that represent the derivative of the approximated function at adjacent points.

Thus equation 4.18 within this linearized sample is transformed into:  ( + ) = ( + ) + ( + )  (4-23)

30

Or   () () = () +   (4-24)

Likewise:  ()  =  () +  (4-25)

 ,  ,   represent the system variables within the small interval around the operating point ,   are listed in Appendix B where the small signal model is derived. The values of the matrices , 

4.7 System Stability & Transfer Function Derivation
It is possible to assess system stability either by transforming the state space representation into a transfer function or directly in state space representation for the linearized small signal model. To transfer the state space system of equations represented by 4-24, 4-25 into a transfer function, Laplace Transform is applied to both equations, and a transfer function that represents the ratio of the output of the system to the system input is derived. Such an open loop transfer function has the form of: () = () =

()  ()  +   = =  ( - )-1  ()  ()

(4-27)

Where I is the identity matrix. System stability depends on the poles of the system, which can be found by equating the determinant of ( - ) to zero. If these poles (or the eiganvalues of matrix A) are on the left hand side of the complex plane (LHP), then the system is stable. If the real part of one or more poles or eiganvalues is positive then the system is unstable. A real part equal to 0 indicates marginal stability. Overall the complex part of conjugate poles indicates the frequency of the oscillation of the system response.

Based on design objectives, such as percentage overshoot and settling time, it is possible to calculate the natural frequency and damping ratio of the desired transfer function, and thus it is

31

possible to calculate the controller gains such that the closed loop transfer function is equal to the desired function.

4.8 Grid Side Model and Controller Design
The process used to design a controller for the grid side converter follows typical steps, namely: Derive a dynamic model for the system. This was performed in 4.4 and 4.5 above. Perform small signal analysis and create a small signal model to linearize the system at an operating point. This was carried out in 4.6 above. Calculate stead state parameters at the operating point. Define the control objectives and control loop. This includes deciding what inputs and outputs the system will have, etc. Derive the transfer function of the plant. Design the controller to achieve system stability and the desired performance in a negative feedback closed loop system. Verify the design.

The grid side model is composed of the rectified voltage on the dc link side of the diode rectifier, the dc link inductance, a current source inverter connected to the grid via the line inductance and a capacitor bank with a small internal resistance connected in parallel to provide damping to the LC resonances on the grid side. The parameters of the simulation system are in Appendix A.

As mentioned earlier, the control objectives of the grid side controller, since the diode rectifier is a passive element, are to control the delivery of the active and reactive power to the grid, to achieve MPPT. Excitation control is used to improve the range of wind speeds within which the control objectives of the CSI could be achieved, as discussed earlier. Detailed analysis of how that was implemented will follow later.

As discussed in 4.1 the reference for the dc current is set using active power values calculated based on achieving MPPT. On the grid side, since the reference frame is aligned with the phase voltage, the active power is delivered to the grid via the d-axis component of the current _ .

32

With this in mind, the dc current controller can be used to provide reference for  . Figure 24 below shows the simplified control loop of the dc current using the grid side CSI. The steady
  state equation to calculate  from  is derived from 4-4-2 and 4-10.

A

B

C

Figure 28 CSI ­ dc link current control loop

The plant transfer function is derived from the small signal model of the grid side converter using the Matlab command ss2tf at rated operating parameters which are used for the simulation model; these parameters are detailed in Appendix A. The small signal model accounts for passive damping of the LC resonance. The plant transfer function derived thus is: 3.847 5  4 + 3.217 8  3 + 4.894 15  2 + 4.092 18  + 8.143 20  5 + 60.32 4 + 1.272 10  3 + 7.674 11  2 + 7.243 15  + 1.636 17 The closed loop transfer function is easily derived from the above system and equations:    1 +   

(4-28)

  =

(4-29)

The Matlab SISOTOOL was used for the above plant open loop transfer function to study the system and optimize the controller. The transfer function was obtained at two operating points: = 1 and 0.5pu. The bode plot was obtained for the two transfer functions, and the control loop appears to be stable for both operating points, as can be seen in figure 29 below.

33

Figure 29 Open loop bode plot

From the bode plot in figure 29, it is noticeable that due to damping at a bandwidth of 10Hz with a phase margin of 41 degrees, the two resonance peaks have magnitudes at and below 0dB. The system is stable and there should be no resonance issues due to the device sampling frequency of about 1KHz.The closed loop poles on the root-locus plot can be seen in figure 30 below.

Table 1 Closed loop pole values Pole Value -1.79e-007 +/- 1.13e+005i -15.1 +/- 769i -22.9 +/- 58.6i Damping 1.59E-12 0.0196 0.364 Frequency 1.80E+04 122 10

34

Figure 30 Root locus plot

Two conjugate poles appear very close to the imaginary axis, it was noticeable however that the increase in gain had no impact on system stability. The system step response is demonstrated in figure 31.

Figure 31Step response

35

The step response shows a rise time of about 24ms and a settling time of 167ms. The percentage overshoot (PO) is at 33%. The PO and minor oscillations could be improved by reducing the gain slightly, which would slow down the process. In any case finer tuning is possible for the controller.

A closed loop Simulink model was built to represent the grid side controller. In the simulation model the grid side converter and the PWM gating signal generator were treated as a black box representing the state space system on the grid side. The input is the rectified dc voltage and the dq-axes values of the grid voltage, and the output is the dc current, for which the step response in the reference value of the dc current is evaluated. The resulting step response displayed in figure 32 below looks very similar to the response obtained from the SISOTOOL.

Figure 32 Simulated step response of the grid side controller.

4.9 Grid Side Reactive Power Control
The reactive power is delivered to the grid via the q-axis component of the grid current, which in a reference frame aligned with the phase voltage and with a power factor equal to unity, is equal to zero. The value of the q-axis current vs. the reactive power is defined in 4-30 below.

36

  =-

  1.5

(4-30)

The control loop for reactive power control with the grid side converter is displayed in figure 33 below.

Figure 33 Control loop for reactive power

The plant transfer function is extracted from the same small signal model derived earlier. The only difference is the selection of inputs and outputs, which impacts matrices C and D. In this instance:  = [0 1 0 0 0]  = [0 0 0 0 1] The transfer function of the plant derived from this system at wind speed = 1 pu is: -6.391 13  2 + 3.319 16  + 1.063 18  5 + 60.32 4 + 1.272 10  3 + 7.674 11  2 + 7.243 15  + 1.636 17 (4-31)

(4-32)

The bode plots of the transfer functions of the small signal models at two operating points with a wind speed equal to unity and 0.5 per unit, with a PI controller, is displayed in figure 34 below. The bandwidth is about 2.5Hz, at which the phase angle is close to-90 , so there are no stability issues related to the phase margin in either case.

37

w= 1pu w= 0.5pu

Figure 34 bode plot for the reactive power open loop transfer function with a controller

4.10 Excitation Control
As discussed in paragraph 3.2 above and displayed in figure 22, the purpose of excitation control is adjust the generator side dc current level to be just above the grid side requirement at each wind speed.

The method chosen to achieve that is a look-up table where for each range of wind speeds a corresponding value of the excitation current is chosen. The trial and error look-up table chosen is shown in Appendix C. The results of using this approach are demonstrated in Chapter 5 ­ the simulation results.

4.11 Control Scheme
The control scheme is derived from the steady state equations that were obtained by eliminating the derivative portions of the equations that comprise the state space representation described above. It is based on a tried and tested design described in [3]. The reference for the dc current was explained in section 4-1 and figure 22 above. 38

Grid voltage phase-locked loop (PLL) is used to obtain the reference frame angle and the frequency which is used to do reference frame transformations from abc to dq. Two separate control loops are used for active and reactive power control.

The reference for active power translates into a reference for the d-axis grid side inverter current, whereas the reference for the reactive power creates a reference for the q-axis component of the grid side inverter current. By dividing by the measured value of the dc current, the dq axis components of the modulation index are obtained and then are translated from Cartesian to polar to obtain the modulation index and angle which are used for SVM.

The control loop for the excitation current is simple and is explained in 4.10 above.

Figure 35 Block diagram of the control scheme for the system

4.12 Chapter Summary
This chapter developed the dynamic model of the system, focusing on the grid side inverter since it is there that the active and reactive power is controlled. The dynamic equations developed in dq-axis reference frame were used to compile the state space representation of the system, which 39

for the grid side is a 5th degree model. This state space representation was linearized at an operating point using small signal analysis. The small signal model was then converted into an open loop plant transfer functions, for both active and reactive power. The stability and performance of the plant were analyzed, and a controller was designed. The chapter includes controller verification at a different operating point.

Using the steady state equations extracted from the dynamic model by eliminating the derivative components, the inverter side control scheme was developed. This chapter also builds on the previous chapter to establish a control methodology for the excitation current.

40

Chapter 5 Simulation Verification
The objective of this chapter is to explore via computer simulation in Matlab, using the model developed in the previous chapter, the behaviour of the system:  in response to variations in the input (wind speed): o to help identify the dynamic stability of the system o to help identify the ability of the system to control the output (power factor) under both controlled and fixed excitation  in steady state conditions ­ to study the waveforms at the output and input at selected operating points to assess the THD and harmonic composition and whether the system complies with grid codes or not or if the THD is too high on the generator side then this could have an impact on losses in the generator.

5.1. System Response to Changes in Wind Speed and PF Control Range
The system response to a wind speed step from 1 to 0.6 pu was evaluated, and figures 36 and 37 demonstrate that the system tracks well both the reference dc current and the active and reactive power under these conditions.

Figure 36 Dc link current tracking

41

Figure 37 Active and reactive power tracking Bearing in mind that excitation control works by boosting the generator output current such that the dc current level meets or slightly exceeds the grid side requirement, simulations were run for the wind profile demonstrated in figure 38, and the impact on the dc current as well as the grid side power factor was evaluated under unity power factor requirements.

Figure 38 Simulation wind speed profile

42

The dc link simulated current values with and without excitation control are displayed in figure 39 (a,b) respectively. It is clear that excitation control is effective at boosting the dc current level at each wind speed. The black line represents the reference value for the dc current, whereas the green line represents the simulated value of the dc current.

Figure 39 Dc current response to the wind profile a- With excitation control b- Without excitation control The corresponding impact on the grid side power factor can be seen in figure 40 below, again with and without excitation control. It is clear that excitation control results in stable and high power factor on the grid side even at wind speeds close to 0.5 pu.

Figure 40 Figure 40 Grid side power factor response to the wind profile a- With excitation control b- Without excitation control To summarize, figure 41 demonstrates the improvement in the wind speed range within which the grid power factor can be maintained close to unity as a result of employing excitation control.

43

Figure 41 Simulated power factor control range with and without excitation control

It is noticeable that with excitation control, even at a wind speed of 0.4pu, the power factor value remained as high as 0.9, whereas without excitation control it plummeted down to close 0.1.

5.2 Steady State Waveforms on the Grid Side
The waveforms of the voltage and current on both the generator and grid sides were observed and evaluated as well as the generator torque at a wind speed equal to unity and 0.5pu. Naturally due to the stiff grid, the voltage on the grid side is wind speed is independent, and the waveform of the voltage is sinusoidal. It is important though that the current waveform on the grid side has a THD that complies with grid requirements. At a wind speed of 1 pu, the waveform of the grid current is illustrated in figure 42.

Figure 42 Grid current waveform and FFT at w =1pu 44

The THD of the grid current waveform is 2.48%, with the 5th and 7th harmonics being the most prominent. Meanwhile at a wind speed of 0.5pu, the THD is higher (still below 5%), but even order harmonics can be seen due to the half-period asymmetry of the waveforms as shown in figure 43. The presence of these undesirable harmonics in the lower range of the frequency spectrum makes it difficult to filter them out since they are close to the fundamental frequency.

Figure 43 Grid current waveform and FFT at w = 0.5pu

5.3 Steady State Waveforms on the Generator Side
On the generator side the presence of harmonics is more noticeable, and even though there might be no grid requirements to stipulate the acceptable level of THD, the abundance of higher harmonics would lead to significant losses.

The figures for the generator current, voltage and torque at a wind speed of 1pu are displayed in figures 44 to 46 below.

45

Figure 44 Generator current at a wind speed of 1pu

Figure 45 Generator voltage at a wind speed of 1pu

As far as the generator torque, it is tracking the reference value of 1pu at 1pu wind speed. This can be seen in figure 46 below.

46

Figure 46 Generator torque in pu at a wind speed of 1pu

At a wind speed of 0.5pu, the THD goes noticeably up, which further exacerbates the situation with losses in the generator.

Figure 47 Generator current at a wind speed of 0.5pu

47

Figure 48 Generator voltage at wind speed of 0.5pu

Figure 49 Generator torque at a wind speed of 0.5pu

In both cases, the generator torque is tracking the expected value, as can be seen in figure 49 above, but the issue with the THD on the generator side could pose a problem and ultimately limit the control range since with the reduction of the wind speed the THD goes up significantly, and the one way to fight that is to select a generator with a higher synchronous inductance, but this could make it impossible to reach a real value for the dc current at the wind speeds close to unity in per unit. The issue with the THD in this configuration was referred to in [3].

48

5.4 Chapter Summary
This chapter explores the response of the system to changes in wind speed, verifying the ability of the system to track the reference signals derived from MPPT equations.

Furthermore, a wind speed profile applied to the system under excitation control and no control was used to analyze the ability of the proposed control scheme to control the dc current levels, as planned, and thereby confirm that excitation control does help improve the control range in this system topology.

A study of the steady state waveforms revealed an impact on the harmonic profile of the grid side current at lower wind speeds whereby the THD is increased, and even order harmonics are noticed.

49

Chapter 6 Conclusions
In this report, the application of current source converters (CSCs) in a megawatt electrically excited synchronous generator (EESG) based WECS is proposed. A comprehensive study of the proposed system has been carried out. The main contributions and conclusions of this project can be summarized as follows: 

A diode rectifier and PWM current-source inverter based topology is proposed for an electrically excited synchronous generator based WECS.

The proposed configuration provides simple topology and a low cost solution. The gridside power factor of the system may drop at low wind speeds due to the lack of control freedoms of the generator-side diode rectifier as well as the impact of commutation in the diode rectifier on the dc link current. 

The impact of generator parameters on commutation in the diode rectifier and excitation adjustment on the dc current were investigated.

The synchronous inductance can impact the dc current value at different wind speeds and rated excitation to such an extent that a real value may not be obtained. That impact was assessed, and the values that can yield a feasible range were identified. 

A novel control scheme, which uses generator excitation to improve the power factor over a wide range of wind speed, was developed:

The unity power factor is achieved for the wind speed range from 1pu to 0.6pu. In contrast, without excitation control, the grid-side power factors dips once wind speed falls below 0.8pu.

50



The feasibility of the proposed control scheme is verified through detailed simulation. The proposed control scheme does deliver the expected outcomes of improving the wind speed range within which the PF can be maintained close to the reference value.



Steady state waveforms at two operating points were studied: There is a challenge in using this approach which is related to a high value of generator current THD as well as the presence of even order harmonics on the grid side at lower wind speeds. This could have an impact on the control range of the system. This remains to be evaluated.

51

References
[1] "Canwea Media Centre," [Online]. Available: http://www.canwea.ca/media/release/release_e.php?newsId=147. [Accessed 22 July 2013]. [2] B. Wu, High-Power Converters and AC Drives, Hoboken, New Jersey: John Wiley & Sons, Inc., 2006. [3] J. Dai, "CURRENT SOURCE CONVERTERS FOR MEGAWATT WIND ENERGY CONVERSION SYSTEMS," Toronto, 2010. [4] M. Eichler, P. Maibach and A. Faulstich, "Full Size Voltage Converters for 5MW Offshore Wind Power Generators," ABB Switzerland Lt., Turgi, Switzerland. [5] J. Dai, B. Wu and D. Xu, "A Novel Control Scheme for Current-Source-Converter-Based PMSG Wind Energy Cinversion Systems," Power Electronics, IEEE Transactions, pp. 963972, 2009. [6] D. Xu, Lecture Notes: Diode and Thyristor Rectifiers, Toronto. [7] N. Mohan, T. M. Undeland and W. P. Robbins, Power Electronics: Converters, Applications, and Design, New York: John Wiley & Sons, Inc., 2002. [8] P. C. Krause, O. Wasynczuk and S. D. Sudhoff, Analysis of Electric Machinery and Drive Systems, Second Edition, Wiley Inter-Science. [9] X. Tan, J. Dai and B. Wu, "A Novel Converter Configuration for Wind Applications Using PWM CSI with Diode Rectifier and Buck Converter," in IEEE International Electric Machines & Drives Conference, 2011. [10] W. Quincy and C. Liuchen, "An intelligent maximum power extraction algorithm for inverter based variable speed wind turbine systems," Power Electronics, IEEE Transactions, vol. 19, pp. 1242-1249, 2004. [11] M. Jafari, B. Wu and M. Popat, "POWER FACTOR CONTROL IN A WIND ENERGY CONVERSION SYSTEM VIA SYNCHRONOUS GENERATOR EXCITATION," in CCECE2013, Regina, Saskatchewan, 2013. [12] J. Dai, B. Wu, D. Xu, N. R. Zargari and J. Wang, "Low Cost Current Source Converter Solutions for Variable Speed Wind Energy Conversion Systems," in IEEE International 52

Electric Machines and Drives Conference, 2011. [13] F. Blaabjerg and Z. Chen, Power Electronics for Modern Wind Turbines, Morgan & Claypool Publishers, 2006. [14] T. Xiaotian, J. Dai and B. Wu, "A Novel Converter Configuration for Wind Applications Using PWM CSI with Diode Rectifier and Buck Converter," in IEEE International Electrical Machines and Drives Conference (IEMDC), 2011.

53

Appendix A
Table 2 Simulation system parameters: Parameter Grid Voltage Generator rated power Grid frequency Synchronous inductance Synchronous resistance Poles Line capacitance Line Inductance DC link inductance Value 3000V 2.5MW 60Hz 0.4pu 2e-2pu 4 0.5pu 0.3pu 1pu

54

Appendix B
Small signal model

 = [     ]  = [     ]

0 -  -1  =  0 [ 0

  0 0 -1  0

1  0 0 - -1.5 

0 -1   0 -1.5 

0 0     0 ]

0 0 =  0 0 1 [

-1  0 0 0 0

0 -1  0 0 0

0 0 0 0 -1.5 

0 0 0   -1.5   ]

55

Appendix C
Table 3 Look-up table for excitation current Wind Speed Range (pu) 0.9 ­ 1 0.8 ­ 0.9 0.7 ­ 0.8 0.6 ­ 0.7 0.5 ­ 0.6 0.4 ­ 0.5 0.3 ­ 0.4 0.2 ­ 0.3 0.1 ­ 0.2 0 ­ 0.1 Excitation Current (pu) 1 0.9 0.8 0.7 0.6 0.5 0.4 0.3 0.2 0.1

56

Appendix D
Simulation Model

Figure 50 Simulation model

57

