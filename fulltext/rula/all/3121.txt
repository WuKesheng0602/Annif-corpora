Wavelet OFDM for Power Line Communication

By

Sagar Chandra Kar
B.Sc, Daffodil International University, Dhaka, Bangladesh, 2010

A Project presented to Ryerson University in partial fulfillment of the requirements for the degree of

Master of Engineering

In the Program of Electrical and Computer Engineering Toronto, Ontario, Canada, 2014 ©Sagar Chandra Kar 2014

AUTHOR'S DECLARATION FOR ELECTRONIC SUBMISSION OF A THESIS

I hereby declare that I am the sole author of this project. This is a true copy of the project, including any required final revisions, as accepted by my examiners. I authorize Ryerson University to lend this project to other institutions or individuals for the purpose of scholarly research. I further authorize Ryerson University to reproduce this project by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. I understand that my project may be made electronically available to the public.

ii

Wavelet OFDM for Power Line Communication Master of Engineering 2014 Sagar Chandra Kar Electrical and Computer Engineering Ryerson University

Abstract
Power line Communication (PLC) system offers cheaper mode of signal communication facilities. In fast Fourier transform (FFT) based multicarrier PLC system, a cyclic prefix (CP) of the same length of the channel impulse response is added to each symbol in order to transmit data. As a result, there is always an inherent wastage of bandwidth and resources. This research presents a wavelet transform based orthogonal frequency division multiplexing (WTOFDM) approach that eliminates the need for these cyclic prefix and improves the efficiency of the PLC transmission. The presented PLC model is designed for faster and efficient transmission over the power line. The obtained results indicate that the proposed approach enhances the transmission throughput; provides better performance for impulsive noise, and increases the efficiency of the PLC system as a whole. In the end a performance comparison of different wavelet techniques have also been incorporated.

iii

Acknowledgments
I would like to express my sincere appreciation to my supervisor, Dr. Xavier Fernando, for his excellent guidance and immense patience throughout this work. I want to thank him for all the long technical conversations which had a significant impact on the research conducted in this work and I would like to thank him for his understanding, support and during the difficult time of my studies. I would like to thank Dr. Kaamran Raahemifar for serving as my committee members and reviewing my research project. I would like to thank all my friends and colleagues who were really helpful to me throughout the work. Most importantly I would like to thank my families who have always been a source of encouragement throughout my life. Finally, I would also like to thanks the Department of Electrical and Computer Engineering, Center for Urban Energy (CUE), Mitacs, Toronto Hydro Electric System for funding this research work.

iv

Contents
1. Introduction 1.1 Power Line Communication 1.2 Wavelet Transform 1.3 Wavelet Transform in PLC 1.4 Previous Research Work 1.5 Organization of the Report 2. OFDM and Power Line Channel 2.1 Modulation Scheme for PLC 2.2 OFDM 2.2.1 OFDM Spectral Overlap 2.2.2 OFDM Symbol Structure 2.2.3 OFDM System 2.2.4 OFDM System Design 2.2.5 Advantage of OFDM 2.2.6 Problems of OFDM 2.3 Noise in PLC 2.4 Power Line Channel 2.5 Response of Filter 2.6 Model Configuration 3. Wavelet Transform 3.1 Wavelet Transform 3.2 Wavelet OFDM over PLC 3.3 Multiresolution 3.4 Advantage of Wavelet Transform 4. Wavelet Filter 4.1 Haar Wavelet 4.2 Daubechies Wavelet 4.3 Bi-orthogonal Wavelet 4.4 Reverse Bi-orthogonal Wavelet 01 01 02 02 03 05 08 08 10 12 13 13 14 15 16 18 21 22 23 26 26 30 31 32 35 35 37 38 43

v

5. Simulation & Result 5.1 Simulation of Different Wavelet Filter 5.2 Simulation Model 5.4 Performance against Noise

44 44 45 48

6. Conclusion 6.1 Conclusion Bibliography

51 51 52

vi

List of Figures
1.1: Frequency Characteristics of PLC 2.1: Single Carrier Technique of PLC 2.2: Spreading Carrier Technique of PLC 2.3: OFDM Technique for PLC 2.4: Bandwidth Comparison of OFDM and FDM 2.5: OFDM Symbol Structure 2.6: OFDM Signal 2.7: Noise scenario of PLC 2.8: Model of the Power Line Channel 3.1: A Two Channel Filter Bank 3.2: Wavelet Decomposition Process 4.1: Haar Scaling and Wavelet Function 4.2: Daubechies Scaling and Wavelet Function 4.3: Daubechies Low Pass & High Pass Filter 4.4: Bi-orthogonal High Pass and Low Pass Filter 4.5: Reconstruction Wavelet Function of Bi-orthogonal Filter 4.6: Reconstruction Scaling Function 4.7: Decomposition Wavelet Function 4.8: Decomposition Scaling Function 4.9: Reverse Bi-orthogonal High Pass and Low Pass Filter 5.1: Simulation Model of Power Line Channel 5.2: Subchannel Selector 5.3: Wavelet based Transmitter 5.4: Graphical Representation of Wavelet Transform for BER 5.5: BER Performance against Noise (Bi-orthogonal 3.9) 5.6: BER Performance against Noise (Db2) 5.7: BER performance conventional OFDM and Wavelet OFDM 02 09 10 11 12 13 18 19 25 26 31 36 37 38 39 40 41 42 42 43 45 46 46 48 49 49 50

vii

Table of Abbreviations
AWGN BER BPSK CP CDMA DIFFT IEEE IFFT IDWT ISI MAC NLOS OFDM PAM PSK PLC PHY QAM SNR UWB WTOFDM Additive White Gaussian Noise Bit Error Rate Binary Phase Shift Keying Cyclic Prefix Code Division Multiple Access Discrete Inverse Fourier Transform Institute of Electrical and Electronics Engineers Inverse Fast Fourier Transform Inverse Discrete Wavelet Transform Inter Symbol Interference Media Access Control Non Line of Sight Orthogonal Frequency Division Modulation Pulse Amplitude Modulation Phase Shift Keying Power Line Communication Physical Layer Quadrature Amplitude Modulation Signal to Noise Ratio Ultra Wide Band Wavelet Orthogonal Frequency Division Modulation

viii

Chapter 1: Introduction
1. Introduction
Transmission of digital data through existing electric network which can reach the end user over the low voltage AC lines is a new concept. The core competency of PLC systems lies in the advantage that it does not involve in any additional interference that may impact the power transmission quality as whole. Power line communication (PLC) technology is well suited for the challenges posed by smart grid, multimedia and utilities i.e., broadband internet services, smart home security and audio/video streaming. With the advancement of PLC technologies the international committees like IEEE and ITU have already acknowledged the PLC standard under the umbrella of IEEE as IEEE 1901.

1.1 Power Line Communication:
PLC is an economical and practically implementable technology that provides often high speed internet access while consuming less power. It also provides utility applications such as vehicle data communication, advance metering, real time energy pricing control, peak shaving, monitoring, distributed energy generating, traffic light and street light control and other municipal applications. This technology has been also used for smart grid application. A PLC system consists of a broadband and narrowband communication. Broadband PLC provides faster internet access and supports small Local area networking [1], while narrowband serves specific applications such as central management of power consumption, remote meter reading, commanding and many more. The primary differences between narrowband (low speed) and broadband (high speed) PLC are bandwidth and carrier frequency. Narrow band PLC uses carrier frequencies lower than 500 KHz, which have higher noise. While broadband PLC uses higher frequency, which have lower noises in comparison to lower frequencies. The higher frequency range improves the data rate for transmissions over longer distances. In figure 1 it shows the transfer characteristics of the power line channel. In this figure we have shown that high frequency has lower noise.

1

Figure 1.1: Transfer characteristics of PLC [2]

1.2 Wavelet Transform
Wavelet transform is a mathematical analysis when signal frequency varies over time. For certain classes of signals and images, wavelet analysis provides more precise information about signal data than other signal analysis techniques. Common applications of wavelet transforms include speech and audio processing, image and video processing and biomedical imaging applications in communications and geophysics

1.3 Wavelet Transform in PLC
Conventionally PLC is carried out by FFT, an important numerical algorithm, which computes the Discrete Fourier Transform (DFT) of the transmitter signals before carries the digital data over the existing electric network. Due to some disadvantages of FFT such as adequate guard interval, poor spectral properties for high degree of spectral leakage, poor narrowband interference and transmission inefficiency (due to GI and produce low data rate). Wavelet is an alternative transformation technique that can be used in PLC system. Wavelet transform is a mathematical analysis that extracts information from many different kinds of data, including ­ but certainly not limited to ­ audio signals and images. For certain classes of signals, wavelet
2

analysis provides more precise information about signal data than other signal analysis techniques such as FFT. Discrete wavelet transform (DWT) is the sampled version of the continuous wavelet which is based on sub-band coding and is known for its fast computation of Wavelet Transform. DWT is easy to implement and provides substantial reduction in computation time and resources required for representing digital signals. Common applications of DWT are video compressing, internet communications, object reorganization, numerical analysis, biomedical imaging applications in communications and geophysics [9]. In wavelet-based OFDM, the wavelet transform replaces FFT block. WTOFDM system has better spectrum efficiency over the conventional OFDM since the subcarriers are necessarily need no guard interval and no pilot tones as required in conventional. WTOFDM can be designed in such a way that can meet the concept of smart grid, home multimedia, and several utilities such as broadband internet services. It offers an excellent performance in different signal transmission environment and for this reason it is considered as a potential candidate for PLC systems. Due to the fact that delay spreads in the power line are much smaller compared to other environments, the transmission symbols in WTOFDM can be made much shorter and, therefore, WTOFDM offers much better robustness to impulse noise. Furthermore, WTOFDM provides higher transmission efficiency, deeper notches, and lower circuit cost, time frequency localization and robustness against impulse noise. In the next section we will discuss the previous research work of this field.

1.4 Previous Research Work:
This research work has been done to study better transmission efficiency for power line communication. In this research work, we have modeled the PLC system with wavelet transform to provide better transmission efficiency. PLC system is used for alternative data channel because of the importance of the networking at homes and offices, business buildings. In [1], they have mentioned the uniqueness and standard of the power line communication. Testing and verification standards

3

for the commonly used hardware, primarily couplers, enclosures for broadband over power line (BPL) installations and installation methods to enable compliance with applicable codes. In [2], the authors provide detail idea of the development of power line communication systems, channel properties, interference scenario and suitable transmission method. Their work also provides a basic estimation of the power line channel capacity and clearly demonstrates enormous potential for high speed communication purpose. The authors also present evaluation of different modulation schemes which is carried to optimize PLC system design. Their work also provides the idea of developing PLC systems which utilize the high channel capacity and brief description of the interference scenario. In [3], authors present the idea that PLC is an excellent candidate for providing broadband connectivity as it exploits an already existing infrastructure. They have also mentioned that this infrastructure is much more pervasive than any other wired alternative and it allows virtually every line powered device to become the target of value added device. They also discuss the importance of standardization in the PLC context and provide an overview of the current activities of the IEEE 1901 also describes some of the technical challenges that the future 1901 must address to ensure the success of PLC in the marketplace. In [4], authors present the standardization activities for broadband over power line networks. They also mentioned that the standard is designed to meet both in home and multimedia and utility application requirements including smart grid and also describes the aspects of PLC technologies designed to address the access cluster. They also explained differences between accesses in home applications, including addressing methods, clock synchronization, smart repletion, quality of service, power saving and other access unique mechanism. In [6], authors present a PLC technology is seemed as an alternative data channel. In their paper they have approached an OFDM communication model, model of power lines and noise model. Their model of power lines are modeled as an environment of multipath signal propagation. Moreover, the model is designed for sample network topology and resulting channel model was constructed consisting of power line model and the source of interference. Their work provides computer apparatus for creating models and modeling power lines for the
4

simulation of data transmission over power line. Their model offers to carry out the investigations in different network topologies and study their system on communication system. Their PLC communication model can be used for comparison of the performance of different modulation and coding schemes and for future standardization. In [7], authors compared OFDM and WTOFDM with respect to some specific aspects of the power line channel. On the basis of their investigation, they have concluded that W-OFDM is a better MCM scheme compared to OFDM because it exhibits higher transmission efficiency, deeper notches, and lower circuit cost as fewer carriers than in conventional or windowed OFDM. In [8], authors analyze the application of wavelet transform as an alternative to the conventional Fourier-based multicarrier UWB systems. In Fourier based multicarrier UWB systems a cyclic prefix (CP) with the same length of the channel impulse response must be added to each symbol in order to convert linear convolution into circular convolution. The CP must consist of identical copies of the transmitted data in each symbol and therefore is a waste of bandwidth and resources. They present a framework for wavelet based multicarrier UWB systems and it is shown that they do not require the cyclic prefix for transmission and hence throughput increases. Moreover, a closed form formula is derived to represent convolution counterpart in the wavelet domain. Finally, a performance comparison of both techniques is provided. In [10], authors presents a model of the complex frequency response of PLC links for the frequency range from 500 kHz to 20 MHz has been derived from physical effects, namely multipath signal propagation and typical cable losses. This paper also deals with attenuation profiles.

In [12], authors present an experimental study of indoor power line channel in high frequency range, and a system level simulation model for very broadband power line communication, at a very high bit rate of 200Mbit/s. Their system model is based on the MBOFDM proposal submitted to the IEEE 802.15.3a standard group and the concept used in UWB communication is applied to the power line channel. An extensive measurement campaign has been carried out and a 500 MHz band width in 50 - 550 MHz range has been defined or the use
5

of data transmission over broadband power line channel. Based on the measured power line channel transfer function, the modified MB-OFDM simulation model and the BER performance of different power line channels has been simulated under AWGN. Their works show that high transmission rate can be achieved over the broadband power line channel even when electrical loads are connected. All their results indicate that the power line provides a promising path for very high data rate transmission. In [13], authors present a model of the complex frequency response of PLC links for the frequency range from 500 kHz to 20 MHz and it has been derived from physical effects, namely multipath signal propagation and typical cable losses. Measurements at a test network with wellknown parameters prove good agreement between simulation and measurement results. They also demonstrated the applicability of the model to real world networks. Their presented model offers the possibility to carry out investigations for different network topologies and to study their impact on PLC system performance by means of simulations. They also explain attenuation profiles and detailed models for individual links can be set up and reference models of typical channels of PLC. In [16], authors present a deterministic model describing the magnitude and phase of complex transfer functions of power-line networks using only one parameter. They also perform time­frequency analysis in both frequency bands 30 kHz­100 MHz and 2 MHz­100 MHz. Their investigation is aimed to show that the PLC channel studies in a band starting from a frequency lower than 2 MHz distorts the real values that an implementer should take, as the PLC modem only sees frequencies from 2 MHz. This report investigates transmission efficiency of power line communication and simulates power line model with Simulink. It presents a PLC model that is designed for faster, higher throughput and more efficient transmission over the power line.

6

1.5 Organization of the Report:
This report is organized as follows. Chapter 1 begins with the brief introduction of power line communication and also discuss about the previous research work of this field. Chapter 2 describes about the details about the OFDM and modulation scheme of PLC. It also includes the power line channel. Chapter 3 includes the wavelet transforms and mathematical derivation of wavelets. Chapter 4 presents different kinds of wavelet filters and filter structure of those wavelets. Chapter 5 summarizes our results and chapter 6 concludes this report with suggestions for future work.

7

Chapter 2: OFDM and Power Line Channel
In this chapter we have studied about the modulation schemes of PLC and details about the OFDM. This chapter also includes the details of power line channel.

2.1 Modulation Schemes for PLC:
Power line channels differ significantly from other well-known channels, special care is necessary to select a modulation scheme that uses the high capacity of these channels optimally and offers good noise robustness. The next section analyzes some modulation schemes that come into consideration to find an optimal solution for PLC systems. Additional important step is the selection of suitable modulation schemes and their adaptation toward an optimal PLC system. The adaptation can be performed within the transmitter or receiver or both. Single transmitter adaptation allows frequency ranges with low attenuation and interference to be selected in order to improve the realizable data rate. PLC systems design can be observed as a highly challenging task as the engineer has to deal with very limited resources in a hostile environment, which in no way has been or could be prepared for communications purposes. For enhancements of the data rate it is not possible to extend bandwidth or assign new frequency ranges. Only more sophisticated modulation schemes with improved spectral efficiency or adaptation strategies such as impulsive noise cancellation can push technology forward. However, economic clearance is also narrow, as most of the PLC applications fall into low-cost ranges. Transmission method for Power line Communication Channel:  Single carrier technology  Spread spectrum  OFDM technology Single Carrier Technique for PLC: In this technique information is encoded in amplitude, phase or frequency changes of the carrier. A modulation scheme can be characterized for example by its spectral efficiency. Single carrier modulation does not provide high data rates but PLC technology often aim at high data rate and maximum spectral efficiency (How many bits transferred in 1Hz). In figure 2.1 we have shown the diagram of a single carrier PLC
8

transmission system. Moreover, implementing high data rates results in the generation of contiguous wideband transmission signals generally centered on the carrier. Due to notches and the low pass character of the channel such signals are seriously affected, so the performance is poor. In the access domain where typical delay spreads are around 10µs dramatic inter-symbol interference would occur already for data rates far below 100kb/s [3].The system which is used single carrier transmission, an equalizer might be required to mitigate the effect of channel distortion. The complexity of the equalizer depends upon the severity of the channel distortion and there are usually issues such as equalizer non linarite and poor propagation etc, which cause additional trouble.

Figure 2.1: Single carrier technique of PLC

Spread Spectrum Technique: Spread spectrum techniques (SST) seem to be a good choice for PLC due to their immunity against selective attenuation and all kinds of narrowband interference. An additional interesting feature of SST, which is the low power density for the transmitting signals. Moreover, media access can be accomplished by code division multiple access. In this technique, the carrier is conventionally modulated with the data stream. Thereby a spectrum of approximately the doubled the message bandwidth is generated. A further modulator inserts fast 0°/180° phase hops according to pseudo noise sequence. After that the transmission signal exhibits a bandwidth of approximately twice the clock frequency. At the receiver the same frequency must be available, synchronized to the received signal. If narrow band interference is appears at the receiver, it is subject to spreading the process, it is subject to the spreading process, on only a small portion corresponding to the
9

message bandwidth can impair the desired signal. As with CDMA, the entire frequency band is open to each participant, so access does not need to be coordinated. Each active participant increases the background noise for all users. The more participants become active, than the probability is higher for mutual disturbance. Therefore there is a tradeoff between quality of service and permissible number of active participants. In figure 2.2 we have shown the diagram of a spread spectrum technique for PLC transmission system. More sophisticated modulation scheme with improved spectral efficiency and ability to cancel the impulsive noise can push this technology further. This is the reason; most experts in the field have concentrated on multicarrier techniques, in particular orthogonal frequency division multiplexing (OFDM).

Figure 2.2: Spread spectrum technique of PLC

2.2 OFDM (Orthogonal Frequency Division Multiplexing):
OFDM is a well-established multi carrier technique and special case of FDM (frequency division multiplexing). This technology is used in PLC. Orthogonally of all sub carriers lead to high spectral efficiency which is the key element of a successful high speed PLC and it provides proper demodulation of the symbol streams without the requirement of non-overlapping spectra. OFDM exhibits robustness against various kinds of interference and enable multiple accesses. In compare to SST the spectrum used by OFDM is used by OFDM is segmented into several narrow sub-channels.

10

Due to the sub-channel narrowband property, attenuation and group delay are constant within each channel. Moreover, the orthogonal property of the carriers provides the outstanding spectral efficiency and the success of high speed PLC. Another advantage of OFDM is adaptability and in the future it is expected that OFDM will become the most favorable modulation scheme in all PLC application field. In figure 2.3 we have shown the diagram of OFDM technique for PLC transmission system.

Figure 2.3: OFDM technique for PLC

Orthogonal Frequency Division Multiplexing (OFDM) is a technique that divides the bandwidth into multiple frequency subcarriers. In an OFDM system, the input data stream is divided into several parallel sub streams of reduced data rate and each sub-stream is modulated and transmitted on a separate orthogonal subcarrier. The increased symbol duration improves the robustness of OFDM to delay spread. OFDM also uses multiple subcarriers but the subcarriers are closely spaced each other without causing interference, removing guard bands between adjacent subcarrier. In OFDM, subcarriers are spaced by 1/ and all the subcarriers are orthogonal to each other.OFDM waveform eliminates the inter symbol interference problems and the complexities of adaptive equalization. Two periodic signals are orthogonal when the integral of their product, over the period is equal to zero. Two signals 1 () and 2 () are said to be orthogonal over the period  if

 0

1   2   = 0

(2.1)
11

In order to for this orthogonally to be preserved the following must be true  The receiver and the transmitter must be perfectly synchronized. This mean they both must assume exactly the same modulation frequency and the same time scale for transmission.  There should be no multipath channel. 2.2.1 OFDM Spectral Overlap: OFDM is similar to FDM but much more spectrally efficient by spacing the sub-channels much closer together. This is done by finding frequencies that are orthogonal, which means that they are perpendicular in a mathematical sense. It is allowing the spectrum of each sub-channel to overlap another without interfering with it. In figure 2.4 the effect of spectral overlap is seen as the required bandwidth is greatly reduced by removing guard bands and allowing signals to overlap. For conventional OFDM Discrete Fourier transform and Inverse Discrete Fast Fourier transform are needed.

Figure 2.4: Bandwidth comparison of OFDM and FDMA

12

2.2.2 OFDM Symbol Structure: An OFDM signal is a sum of sub-carriers that are individually modulated by different modulation scheme. In this report, we have used 256 subcarriers with 192 data subcarriers, 8 pilot subcarriers and 56 nulls. Modulation scheme (PSK, QAM) is typically employed to increase the data throughput. A data stream would be split into 192 parallel data streams each at 1/192 of the original rate. Each stream is then mapped to the individual data subcarrier and modulated using wish modulation scheme (QAM, PSK). Pilot sub carriers provide a reference to minimize frequency and phase shifts during the transmission while null carriers allow for guard bands and the DC carrier (center frequency). All the sub carriers are sent at the same time. In figure 2.5 we have shown the OFDM symbol structure.

Figure 2.5: OFDM symbol structure

2.2.3 Conventional OFDM System Implementation: The implementation of OFDM system is achieved through the mathematical operations called Discrete Fourier transform and its counterpart Inverse Discrete Fourier transform. These two operations are extensively used for transforming data between the time domain and frequency domain. In OFDM, these transforms can be seen as mapping data on to orthogonal subcarriers. So the transmitted signal is,   =
-1  =0 

   2 /

(2.2)

where,  is the transmitted symbol and  is the transmitted signal.

13

If the received signal of OFDM is  ,  denotes the channel impulse response and  denotes the noise,   =
-1  =0 

 -    +  

(2.3)

If the received signal of OFDM in frequency domain denoted by   ,  () =  () +  () +  ( ) Now channel frequency response is denoted by  ,  () =  ( )/ () (2.5) (2.4)

Above equations describes the frequency domain data and time domain data. IDFT correlates the frequency input data with its orthogonal basis function, which are sinusoids at certain frequencies. In other ways, the correlation is equivalent to mapping the input data onto the sinusoidal basis functions. At the transmitter side, an OFDM system treats the source symbols as though they are in the frequency domain. These symbols are feed to an IFFT which brings the signal into the time domain. In OFDM, a very high rate data stream is divided into multiple low rate data streams. Each smaller data stream is then mapped to individual data subcarrier and modulated using some sorts of modulation scheme (PSK, QAM, BPSK, QPSK, 16-QAM, 64-QAM). The term OFDM is frequently followed by the number that depicts the potential number of subcarriers (including guard band subcarriers) in the signal. At the receiver side, The OFDM receiver uses a time and frequency synchronized FFT to convert the OFDM time waveform back into the frequency domain. In this process the FFT picks up the discrete frequency samples, corresponding to just the peaks of the carrier. 2.2.4 OFDM System Design: To design a system involves a lot of tradeoff and requirements. The following are the most important design parameters of an OFDM system. The following are most important design parameters of an OFDM system. Guard Time: Guard time is an OFDM system usually results in SNR loss in OFDM system, since it carries no information. The choice of the guard time is straightforward once the multi14

path delay spread is known. The guard time must be least 2-4 times the RMS (root mean square) delay spread of the multi-path channel. Further, higher order modulation schemes are more sensitive to ISI and ICI than simple schemes like QPSK and BPSK. This factor must also be taken into account while deciding on the guard time. Symbol Duration: To minimize the SNR loss due to the guard time, the symbol duration must be set much larger than the guard time. But an increase in the symbol time implies a corresponding increase in the number of subcarriers and thus an increase in the system complexity. A practical design choice for the symbol time is to be at least five times the guard time, which leads to an SNR loss that is reasonable. Number of Subcarriers: Once the symbol duration is determined, the number of subcarriers required can be calculated by first calculating the subcarrier spacing which is just the inverse of the symbol time (less the guard period). The number of subcarriers is the available bandwidth divided by the subcarrier spacing. Modulation and Coding Choices: The 1st step in deciding on the coding and modulation techniques is determining the number of bits carried by an OFDM symbol. Then, a suitable combination of modulation and coding techniques can be selected to fit the input data rate into the OFDM symbols and at the same time, satisfying the bit error rate requirements. 2.2.5 Advantages of OFDM: Multipath Delay Spread Tolerance: In OFDM, the symbol time is increased by N times (N is the number of subcarriers), which leads to corresponding increase in the effectiveness of OFDM against the ISI caused due to multipath delay spread. Using cyclic extension process and proper design, ISI can completely eliminate from the system. Effectiveness against Channel Distortion: In addition to delay variations in the channel, the lack of amplitude flatness in the frequency response of the channel also causes ISI in digital communication systems. In OFDM system the bandwidth of the subcarrier is very small; the amplitude response over this narrow bandwidth will be basically flat. Even in the case of extreme amplitude distortion, an equalizer of very simple structure will be enough to correct the distortion in each subcarrier.
15

Throughput Maximization: The use of subcarrier modulation improves the flexibility of OFDM to channel fading and distortion and makes it possible for the system to transmit at maximum possible capacity using a technique called channel loading. Suppose the transmission channel has a fading notch in a certain frequency range corresponding to a certain subcarrier. If we can detect the presence of this notch by using channel estimation schemes and assuming that the notch does not very fast enough compared to the symbol duration of the OFDM symbol, it can be possible to change the modulation and coding schemes for this particular subcarrier, so that capacity as a whole is maximized over all the subcarriers. However, this requires the data from the channel estimation algorithms. Robustness against Impulsive Noise: Impulsive noise is usually a burst of interference caused in channels such as power line cables, twisted pair cables and wireless channels affected by atmospheric phenomena such as lighting. It is common for the length of the interference waveform to exceed the symbol duration of a typical digital communication system. OFDM systems are inherently robust against impulse noise, since the symbol duration of the OFDM signal is much larger than that of the corresponding single carrier system and thus less likely that impulse noise might cause symbol errors. Frequency Diversity: OFDM is the best place to employ frequency diversity. It is inherently present in the system. This system provides several advantages for transmission. There are some problems in OFDM which is discussed below: 2.2.6 Problems in OFDM Peak Power problem in OFDM: One of the major problems in OFDM transmission is that, it exhibits a high peak to average ratio. The OFDM symbol is basically sum of N complex random variables, each of which can be considered as a complex modulated signal as different frequencies. In some cases, all the signal components can add up in phase and produce a large output and in some other cases they may cancel each other producing zero output. The problem of peak to average ratio (power) is more serious in the transmitter. In order to avoid clipping of the transmitted waveform, the power amplifier at the transmitter frontend must have a wide linear range to include the peaks of the transmitted waveform. Building power amplifiers which such wide linear ranges is a costly affair.
16

Error Control Coding: One of the problems with clipping is the degradation in BER. Specifically, the symbols that have a large PAR ratio are vulnerable to errors. To reduce this effect, forward error correction method (FEC) can applied across several OFDM symbols. When FEC is applied, the error caused due to large PAR in particular symbols can be corrected by the surroundings symbol. Peak Cancellation: Another method of removing the peaks in a OFDM signal is to subtract a time shifted and scaled reference function such that each subtracted reference function such that each subtracted reference function reduces the peak power of at least one signal sample. It is desirable to choose a signal with approximately the same bandwidth as the transmitted signal. The most commonly used peak cancelling function is the sine function because of its desired frequency domain properties. The sine function can be time-limited by multiplying raised cosine window. It can be shown that the peak cancelation will result in a lesser out of band interference than the clipping and windowing technique. PAR Reduction Codes: A more elegant solutions to the PAR problem is the use of coding techniques. The PAR can be reduced by using a code that only produces OFDM symbols for which the PAR is below in desired level. The more the reduction in the PAR, the smaller is the coding rate. A lot of research papers have been published on the usages of Golary codes for OFDM transmission that deals with the efficient generation of PAR reduction code and the optimal and suboptimal decoding and other properties. 2.2.7 Synchronization in OFDM Systems: Another important issue in OFDM transmission is synchronization. There are basically three issues 1. The receiver has to estimate the symbol boundaries and optimal timing instants that minimize the effects of inter carrier interference and inter symbol interference. 2. In an OFDM system, the subcarriers are exactly orthogonal only if the transmitter and the receiver use exactly the same frequencies. Thus receiver has to estimate and correct for the carrier frequency offset of the received signal. 3. The phase information must be recovered if coherent demodulation is employed. In figure 2.6 we have shown the OFDM signal.
17

Figure 2.6: OFDM signal

2.3 Noise in PLC:
Noise is major issue of power line communication. PLC is subjected to impulsive noise and narrow band interference. Power lines do not represent additive white Gaussian noise (AWGN) channels. The interference scenario is rather complicated as not only colored broadband noise but also narrowband interference and different types of impulsive disturbance occur. Figure 2.7 presents an overview of the noise scenario. After passing the channel with the impulse response h(t) the transmitted signal s(t), where a variety of interference n(t) is added, before the signal r(t) arrives at the receiver. According to [2], the interference scenario can be roughly separated into five classes, denoted colored background noise, narrowband noise, periodic impulsive noise synchronous or asynchronous to the mains frequency (usually 50 or 60 Hz), and asynchronous a periodic impulsive noise. A similar classification in background, narrowband, and impulsive noise can be found in [2].Colored background noise is characterized by a fairly low power spectral density, which significantly increases toward lower frequencies. This kind of noise can be approximated by several sources of white noise in non-overlapping frequency bands with different noise amplitudes [2]. It is caused for example such as household appliances like computers or hair dryers, which can cause disturbances in the frequency range of up to 30 MHz.

18

Periodic impulsive noise(syn)

Narrow band Noise

Periodic Impulsive noise (asyn)

(+)
Colored Noise Asynchronous Impulsive Noise

S(t)

H(f)

R(t)

Figure 2.7: Noise scenario of PLC

Narrowband interference normally consists of modulated sinusoids, the origin of which are broadcast radio stations in the frequency range of 1­22 MHz (typical) [2]. Figure 2.7 includes an example of a measurement showing colored background noise together with typical narrowband interference. Impulsive noise can be classified as periodic and a periodic. Periodic impulsive noise is further divided into interference synchronous or asynchronous to the mains frequency. The synchronous portions are mainly caused by rectifiers within DC power supplies and appliances. The periodic asynchronous portions exhibit considerably higher repetition rates of 50­200 kHz. Such interferences mainly caused by extended use of switching power supplies found in various household appliances today. Asynchronous impulsive noise is mainly caused by switching transients, which occur all over a power supply network at irregular intervals. In this report we have used two different kinds of noise for modeling the PLC. We have used Gaussian noise and Rician noise.

19

The probability density function   of a Gaussian random variable is given by,    =
1  2

 

-

- 2 2  2

(2.6)

where,  is the mean and  is the standard deviation. The Rician Noise generates Rician distributed noise. The Rician probability density function is given by,   =
  2

0

  2

 -

 2 + 2 2 2

(2.7)

where,  is the standard deviation of the Gaussian distribution that underlies the Rician
2 2 distribution noise and 2 = 1 +  , where m1 and mq are the mean values of two

independent Gaussian components I0 is the modified 0th-order Bessel function. Another issue is that power line cables are shared medium and power lines do not provide dedicated links to the subscriber. Normally power line cables connect low voltage transformer to set up individual homes or multiple house units. Power line cables are shared among a set of users. The signal which is generated from one source may interfere with the signals that are generated from the adjacent sources. Correspondingly several sources together in a geographical area create high interference in power line cables. As we know when interference increases the data rate decreases because of the packet collision. This incident also happens for wireless and other medium. In the next section we are describing about power line channel.

20

2.4 Power Line Channel:
Power line channels differ significantly from other well-known channels, special care is necessary to select a modulation scheme that uses the high capacity of these channels optimally and offers good noise robustness. The next section analyzes some modulation schemes that come into consideration to find an optimal solution for PLC systems. Additional important step is the selection of suitable modulation schemes and their adaptation toward an optimal PLC system. The adaptation can be performed within the transmitter or receiver or both. Single transmitter adaptation allows frequency ranges with low attenuation and interference to be selected in order to improve the realizable data rate. In power line communication, channel is a very important factor which is often used for high speed data communication. Various kinds of application can be possible by power line channel. At the beginning, only few kilobits are transferred in a second. Due to high speed data communication feature of power line channel, researchers now days finding it interesting to further develop this technology. The idea of the power line channel is using the electric power distribution grid for communication purpose. It is also called last mile solution. The basic idea is using the cables between the transformer substation and the customers which will work as an access medium for high speed internet. The complex transfer function of the power line channel [2] is,   =
 - 2    =1  

(2.8)

where, the impulse response is multiplied by the complex factor  and delayed by time  . Normally PLC channel represents the superposition of signals from N different paths each of which is weighting factor  , length  and frequency dependent attenuation parameters are  , 1 and k [2].The power line channel is characterized as well for impulsive noise, synchronous and asynchronous noise, narrow band noise and attenuation.   =
  =1 

 -  0 + 1   . 

- 

 2 

(2.9)

where,  represents the echo scenario  , 1 and k represent the frequency dependent attenuation. The impulse response gives the information about the time delay of each path which
21

is proportional to  and the weighting factors  can be obtained from the amplitude of each impulse [2]. Design of power line channel is discussed below. Now we can design the low pass filter for power line channel with Simulink.  Hann window function   = 0.5  [1 -   Condition 0     - 1 or 0 otherwise.  (2/ - 1) =   Using low pass FIR digital filter and its linear characteristics.  Low pass filter coefficient [] =  [].  []  Now  [] = [( - )]/( - ) n is not equal to M  n ranges from 0 to N and M is a constant which is  = /2 Transfer function of designed filter, (  ) =
 [] -  =0 2 

-1 ]

(2.10)

2.5 Response of Filter:
Response of the channel is shown in the time domain and frequency domain. To sustain the characteristics of power line channel, we have used Hann window (where the channel consists a low pass digital FIR filter).The advantage of the Hann window is slower aliasing and lower resolution tradeoff (widening of the main lobe). Impulse response of the Filter: The peak impulse response is the mean delay of the system. When we implement the filter in a system a delay needs to be added as well. Adding delay to the system will match the transmitted and received bits. Magnitude response and Phase response of the Channel: The phase response is linear and filter allows the frequency up to 2MHz. It also satisfies the condition of PLC. In PLC, there are

22

lots of frequency bands. Among them 2MHz band is recommended by many researchers because of its high data transfer rate.

2.6 Model Configuration:
In this PLC model (the result is shown in chapter 5), a Bernoulli Binary generator is used for the data source. It generates random binary number according to the Bernoulli distribution. The Bernoulli distribution produces "zero" with probability "p" and "one" with probability "1-p". The Bernoulli distribution has mean value "1-p" and variance "p (1-p)" [9]. In the PLC model, the probability is considered as .5 and output is frame based. After generating the data from Bernoulli distribution, we have encoded the data. At first we have done the convolution coding and then interleaving. The convolution encoder uses a constituent encoder with a constraint length 7 and native code rate ½. The output of the randomizer is encoded using this constituent encoder. The tail-biting convolution code encoder of OFDMA (simply known as CC) works as follows: the convolution encoder memories are initialized by the (six) last data bits of the FEC block being encoded .This OFDMA PHY convolution encoder may employ the Zero-Tailing Convolution Coding (ZT CC) technique. In this case, a single 0 × 00 tail byte is appended at the end of each burst. This tail byte is appended after randomization [9]. The convolution of the two signals is denoted by ,  =     =
 =0   =0

   -  

(2.11)

Interleaving is used to protect the transmission against long sequences of consecutive errors, which are very difficult to correct. These long sequences of error may affect a lot of bits in a row and can then cause many transmitted burst losses. Interleaving can facilitate error correction. The encoded data bits are interleaved by a block inter-leaver with a block size corresponding to the number of coded bits per allocated sub channels per OFDM symbol. The interleaver is made of two steps:  Distribute the coded bits over subcarriers. A first permutation ensures that adjacent coded bits are mapped on to nonadjacent subcarriers.

23

 The second permutation insures that adjacent coded bits are mapped alternately on to less or more significant bits of the constellation, thus avoiding long runs of bits of low reliability. After encoding the data, the modulation is performed. In this simulation, various modulation schemes are used such as BPSK, QPSK and QAM. BPSK: It shifts the carrier signal by 0 or 180 degree depending upon the bits to be transferred. If 0 degree represents 1 then 180 degree will represent 0.   =  20     for 1 and () = -2 0    . QPSK: Instead of utilizing 2 variations of signal 4 variations is used. Here the phases are/4, 3/4, 5/4 and 7/4. QAM: Quadrature amplitude modulation is a combination of ASK and PSK. Maximum bit can be transferred in 64 QAM. 64 QAM has the highest data rate. After modulation process, the orthogonal frequency division multiplexing is performed. After OFDM transmission the data is passed through the PLC channel which consists a Low pass digital filter (FIR). It has the characteristics of low pass FIR filter. Figure 2.8 is the diagram of the power line channel with noise.

24

Figure 2.8: Model of the power line channel

From figure 2.8, we have seen that the channel model of the PLC channel. In this channel model we have considered Gaussian noise and Rician noise to construct the channel. In the later part of the report we have simulated the model and analyze the result.

25

Chapter 3: Wavelet Transform
3.1 Wavelet Transform:
As we have discussed about wavelet transform in chapter 1. In this chapter we briefly describe about important properties of wavelet and mathematical derivation of wavelet. Important Properties of Wavelet Transform:  Frequency and time localization.  Symmetric or asymmetric wavelet transforms. Wavelet has perfect reconstruction filters which have linear phase.  Number of vanishing moments. Wavelets with increasing number of vanishing moments result in sparse representations for a large class of signals and images [9].  Regularity of the wavelet. Smoother wavelets provide sharper frequency resolution. Additionally, iterative algorithms for wavelet construction converge faster.  Existence of a scaling function, . General Wavelet Transform: To demonstrate a general transform, we use figure 3.1 below, where, an input signal feeds to two channels, each with a pair of FIR filters. We call this structure a two-channel filter bank.

Figure 3.1: A two channel filter bank

The left half of figure 3.1 performs the forward transform, also called analysis, while the right half corresponds to the inverse transform, also called synthesis. Doing the forward and inverse transforms together, we expect that the output of the two-channel filter bank (y[n]) is exactly the same as the input (x[n]), with the possible exception of a time delay, such as [] = [ - ], where k = 1 for two coefficients. The complementary filters of a filter bank divide the signal into
26

subsignals of low-frequency components and one of high-frequency components. This approach is called subband coding. This is the general system diagram of the wavelet transform. Normally DFT breaks the signal into sinusoidal and discrete wavelet transform generates little waves from a signal. These waves can be added together to reform the signal. There are two steps in the wavelet transform one is decomposition and other is reconstruction. With these two process wavelet transform reconstruct the signal [10].

Down sampling and up sampling: The down sampling operation only keeps the even indexed values. The inverse operation which is known as upsampling usually used by inserting 0 between two consecutive samples. The effect of down sampler followed by an up sampler is that every other value will be 0.

Theory of Wavelet Transform: In this section, we describe the mathematical derivation of continues wavelet transform and discrete wavelet transform. The discrete wavelet transform convolves the input by the shifts (translation in time) and scales (dilations or contractions) of the wavelet. Below variables are commonly used in wavelet theory  represents the high-pass (wavelet) filter  represents the low-pass (scaling) filter  is the total number of octaves  is the current octave (used as an index. 1 <=  <=  ) is the total number of inputs  is the current input (used as an index. 1 <=  <=  ) is the width of the filter (number of taps)  is the current wavelet coefficient  (a, b) represents the continuous wavelet transform (CWT) of function   [j, n] represents the discrete wavelet transform of function   [j, n], represents the discrete scaling function of f, except:  [0, n], which is the input signal.

The continuous wavelet transform is represented by equation (3.1),
27

 ,  =

    +  

(3.1)

where, ()the function to analyze is the wavelet and   +  is the shifted and scaled version of the wavelet at time b and scale a. An alternate form of the equation is,  ,  =
 -

()     -  

(3.2)

where,  is the wavelet, while the wavelet family is shown above as  (  -  ) shifted by u and scaled by . We can rewrite the wavelet transform as an inner product,  ,  =   ,    -  (3.3)

The inner product of that equation is essentially computed by the filter. The relationship between the wavelets and the filter banks that implement the wavelet transform. The scaling function determined ø() is determined through recursively applying the filter coefficient and multiresoluation recursively convolutes the input vector after shifting and scaling convolutes the input after shifting and scaling. All the information about the scaling and wavelet functions is found by the coefficients of the scaling function and the wavelet function,   = 2


   2 - 

(3.4)

The wavelet function is denoted by   ,   = 2


[]  2 - 

(3.5)

There is a finite set of coefficient   and [], with these coefficients allowing designing low-pass and high-pass filter. Equations of these coefficients are given below  ø =   =
 

 ø  -   ø  - 

(3.6) (3.7)

Discrete wavelet transform is used in a variety of signal processing applications such as video compressing, internet communications, object reorganization and numerical analysis. The wavelet transform can represent the short term signal with only a few terms. This transform is discrete in time scale and achieve the popularity within the picture compression which
28

incorporates multiresoluation analysis. Resolution process needs both low pass filter and high pass filter. Each filter has a down sampler in it. A low pass filter produces the average signal and the high pass filter produces the detail signal. Basic steps of Discrete Wavelet Transform:  Wavelet transform works with IDWT and DWT  Decomposition (analysis) is done DWT.  Reconstruction (synthesis) is done IDWT.  Low pass and High pass filter are both used in decomposition and reconstruction.  In IDWT upsampling operation is done (inserting a 0 between each two successive samples).  Down sampling is done in DWT (squeezes the signal).  The effect of aliasing is removed by the decomposition and reconstruction process.  Ideal spectral efficiency is provided by wavelet transform. The discrete wavelet transform is represented by,
 +-1   = - 

 ,  = 1/ 

 

(3.8)

where, the wavelet is replaced by function , which is obtained from sampling of the continuous wavelet function. For the discrete case, we let a = 2k and require that the parameters (a; b) as well as  be integers. To make this clearer, we replace a and b (which represent real numbers above) with j and n (which represent whole numbers). In the discrete case, redundancy is not required in the transformed signal. To reduce redundancy, the wavelet equation must satisfy certain conditions. We must introduce an orthogonal scaling function, which allows us to have an approximation at the last level of resolution. The functions that produce these coefficients are also dependent on one another. The representation of the signal at octave j must have all the information of the signal at octave  + 1, which makes sense the input signal has more information than the first approximation of this signal. The function x[n] is thus changed to W[j1,m], which is the scaling function's decomposition from the previous level of resolution, with m as an index after J levels of resolution, the result of the scaling function on the signal will be 0. After repeatedly viewing a signal at coarser and coarser approximations, eventually the scaling
29

function will not produce any useful information. The scaling function allows us to approximate any given signal with a variable amount of precision [7]. The scaling function h, gives us an approximation of the signal via the following equation. This is also known as the low-pass filter output and which describes in equation (3.9).  ,  =
-1  =0 

 - 1,   2 - 

(3.9)

The wavelet function gives us the detail signal which is called high-pass filter,  ,  =
-1  =0 

 - 1,   2 - 

(3.10)

The n term gives us the shift, the starting points for the wavelet calculations. The index (2 - ) incorporates the scaling, resulting in half the outputs for octave compared to the previous octave  - 1.

3.2 Wavelet-OFDM Over PLC:
The WTOFDM transform equation is given by for synthesis filter bank and analysis filter bank [7],  () =   =
-1  [] -  =0  -1   =0 

,0   < 

(3.11) (3.12)

  - , 0   < 

In the above equation  () represents the reconstruction filter bank and  is the decomposition filter bank. Where M indicates number of sub channel and N represents length of each filter and 0   < . WTOFDM is implemented with perfect reconstruction filter banks. Perfect reconstruction means that the output is equal to the input part from a gain and a delay. Relation between analysis and synthesis filter bank is   =   - 1 -  (3.13) where,  = 0,1 ... .  - 1

30

3.3 Multiresolution Analysis:
The Discrete wavelet transform provides sufficient information both for analysis and synthesis of the original signal with the significant reduction in the computation time. Multiresolution is one of the key processes of wavelet transform. This is the process of taking the output from one channel and transfers it through another pair of filter. This process is performed with up and down sampling.

Filter is one of the most commonly used signal processing functions. Wavelets can be realized by iteration of filters which is called multi resolution. The resolution of the signal measures the detail information of the signal. This process is done by upsampling and down sampling operation. The DWT operation is computed by successive low pass and high pass filter of the discrete time domain signal.

Figure 3.2: Wavelet decomposition process

From the figure 3.2, we have shown that both high pass and low pass filter takes the signal where g[n] is the high pass filter and h[n] is the low pass filter .When the signal passes
31

through the high pass and low pass filter, down sampling operation is performed. When the signal goes through to low pass filter, resolution process is done. That means it again passes through with another pair of filter as we know that the high pass filter produces detail information and low pass filter produces coarse approximation. High pass filter is associated with the wavelet function and low pass filter is associated with scaling function. High pass filter provides the wavelet coefficient. The resolution of the signal which measures the detail information and the signal is changed by the filtering operations. Scaling function is changed by the upsampling and down sampling (subsampling) operation. Subsampling is the process which decomposed the signal and also rejecting the error. Reconstruction is the reverse process of decomposition. In this process upsampling is used. When the signal is passed through with filters then added 0 between two consecutive samples, this incident is called upsampling. Subsampling is the reverse process.

3.4 Advantage of Wavelet Transform:
As we know that wavelet transform is free from cyclic prefix which provides better efficiency in transmission. We have already mentioned other advantages .We can proof this mathematically from reference [8]. where, [] is the received signal, [] =
-1  =0

    -  +  []

(3.13)

 [] is the transmission sequence multipath channel [ ] = {[0], [1], ... ... . [ - 1], r[n] is the output of the channel. The received signal r (t) in time domain,  () =  ()   () +  (). Fourier transform makes the circular convolution in time domain, so the signal will be [] =
-1  =0

  ( - )

(3.14)

Because of the circular convolution property we need to add cyclic prefix. This cyclic prefix makes the linear convolution appear as a circular convolution and for that reason we need to add extra symbol to achieve circular convolution using linear convolution and represents a
32

loss in the achievable data rate that becomes significant in highly-dispersive channels. The matrix representation of equation 3.14 in the form of circular convolution and also consider equation 3.13 is  =  + 
(3.15)

r0 h[0]  r1  =  : h[1]  h l - 1 r[M - 1]

h l - 1 0 ...0  ... h[0]

s N-L S N-L+1 : S N-1 : S N-1 S0 : S[N - 1]

v N-L v N-L+1 : v N-1 + v0 : v[N - 1]

(3.16)

where, M is the transmitted block size and which is equal to  -  + 1. In this matrix equation which the circular matrix where the last element of a row becomes the 1st element of the next row. In the transmitted sequence S, L is the extra symbol which is actually required for circular convolution and remaining N elements represent the linear convolution. Now for the discrete wavelet transform, with length N with the same size which is a circular convolution between the sequence and wavelet function. In the formula [] and [] are the low pass filter coefficient and high pass filter coefficient and j is the level of decomposition. Equation (3.17) and (3.18) are showing the decomposition and reconstruction function.

 [] (ø) =  []() =  -1 [ ] =



  - 2   - 1 []   - 2   - 1 []   .   - 2 +   .   - 2

(3.17)





(3.18)

33

The relation between low pass and high pass filter is, [] = -1
-

[ -  ]

(3.19)

So we can rewrite the equation (3.13, 3.17, and 3.19) in a matrix format which is represent in equation (3.20),
  =   
-1 -1

=

-1 =0

  .   - 2
-1 -1

-1  =0



 .   - 2

=
(3.20)

    -  .   - 2
 =0  =0  =0  =0

    -  .  ]

- 2  Now, assuming  -  =  so we can write that, RDWT[k] = DWT(r[n]) =
-1  =0 -1  =0 

   -  .   - 2

-1  =0

-1  =0 

   -  .  ] - 2



(3.21)

We can see from the equation (3.21) that the transmitted signal s[i] is circular convoluted with low pass filter and high pass filter coefficients respectively. From equation 3.13, 3.17 and 3.19, we can say that wavelet based transform does not need cyclic prefix. Fast Fourier transform does not robust against impulse noise (BER is high compare to DWT) but it provides similar performance in terms of Gaussian noise. Wavelet transform provides better spectral efficiency in terms of FFT. When the FFT signal is sampled, the window interval may or may not have integer number of cycles. Spectral leakage occurs in case of not having integer number of cycles. For spectral leakage the side lobe is appeared as a real frequency and it creates distortion. This problem is solved by wavelet transform. This is the reason why we have used wavelet transform in PLC.

34

Chapter 4: Wavelet Filters
As discussed the wavelet transform in chapter 3. In this chapter different kinds of wavelet filters are studied. The choice of wavelet is dictated by the signal or image characteristics and the environment of the application. Wavelet families are varying in terms of several important properties. The most important properties of Wavelet come as follow:

Orthogonal and vanishing order (VO) is the most important property of wavelet. Orthogonal filters lead to orthogonal wavelet basis functions; hence, the resulting wavelet transform is energy preserving. This implies that the mean square error (MSE) introduced during the quantization of the DWT coefficients is equal to the MSE in the reconstructed signal. This is desirable since it implies that the quantized can be designed in the transform domain to take advantage of the wavelet decomposition structure. For orthogonal filter banks, the synthesis filters are transposes of analysis filters. However, in the case of bi-orthogonal wavelets, the basis functions are not orthogonal. Vanishing order (VO) is a measure of the compaction property of the wavelets. It corresponds to the number of zeroes. The synthesis wavelet, (t) that is orthogonal to the analysis scaling functions has p vanishing moments. In the case of orthogonal wavelets, the analysis wavelet function is same as the synthesis wavelet function. Thus, the syntheses as well as the analysis wavelets have the same vanishing moment. However, for bi-orthogonal wavelets, the analysis wavelet function is different from the synthesis function. Thus, the VO corresponds to p vanishing moments for synthesis wavelet only. A higher vanishing moment corresponds to better accuracy of approximation at a particular resolution. Different kinds of wavelet come as follow:

4.1 Haar Wavelet:
Haar wavelet is a sequence of rescaled square shaped function. The Haar sequence is now recognized as the first known wavelet basis. The Db1 wavelet is also known as the Haar wavelet. The Haar wavelet transform is used to obtain information that is more discriminating by providing a different resolution at different parts of the time­frequency plane. The wavelet
35

transforms allow the partitioning of the time-frequency domain into non uniform tiles in connection with the time spectral contents of the signal. The wavelet methods are strongly connected with classical basis of the Haar functions, scaling and dilation of a basic wavelet can generate the basis Haar functions. The Haar wavelet is the only orthogonal wavelet with linear phase. The Haar scaling function defined as,   = The Haar wavelet function is defined as, 1, 0   < 1/2   = -1, 0   < 1 0, 
Haar Scaling Function 1.5

1, if 0  x < 1 0, otherwise

(4.2)

1

0.5

0

0

0.2

0.4

0.6

0.8

1

1.2

1.4

Haar Wavelet 2 1 0 -1 -2

0

0.2

0.4

0.6

0.8

1

1.2

1.4

Figure 4.1: Haar wavelet and scaling function

The Daubechies wavelets are actually a generalization of the Harr transform. Daubechies actually has a family of wavelets, we will discuss in the following section.
36

4.2 Daubechies Wavelet Transform:
The DbN wavelets are the Daubechies extremely phase wavelets. N refers to the number of vanishing moments. These filters are also referred to in the literature by the number of filter taps, which is 2N. From the figure 4.2 we can see the wavelet and scaling function [9] of Db2. The Daubechies scaling function defined as,  ( ) =
-1  =0  (2

- )

(4.3)

The Daubechies wavelet function is defined as,   =
1  =2- 

2 - 

(4.4)

db2 Scaling Function 2
Amplitude

1 0 -1

0

0.5

1

1.5 Number db2 Wavelet

2

2.5

3

2
Amplitude

0

-2

0

0.5

1

1.5 Number

2

2.5

3

Figure 4.2: Db2 wavelet and scaling function

Low Pass and High Pass Filter Structure: Figure 4.2 implies the low pass and high pass filter of Db2 wavelet. The pair of the synthesis filters used for reconstruction where the vanishing moment is 2.The pair of analysis filter is used for decomposition and vanishing moment is same. We can make the moments of wavelet function to be zero up to a certain order K-1, for any polynomial with order lower than K, all its wavelet coefficients will be zero, or be vanishing.

37

The scaling function has power to represent polynomials of degree up to K. Such a wavelet system is said to have vanishing wavelet moments. Making a wavelet system to have vanishing wavelet moments up to order K is equivalent to put regularity on its scaling filter. The wavelet function  has K has vanishing moments if      = 0 (4.5)

This wavelet actually introduced the scaling function and satisfying the property of vanishing moment. For the Daubechies wavelet filter vanishing moment is half of the filter width. In the Db2 wavelet filter the filter width is 4 and vanishing moment is 2.
Lowpass Analysis Filter 1 1 Highpass Analysis Filter

Amplitude

0.5

Amplitude
1 2 3 4

0.5

0

0

-0.5

-0.5

1

Number Lowpass Synthesis Filter 1 1

3 Number Highpass Synthesis Filter

2

4

Amplitude

0.5

Amplitude
1 2 Number 3 4

0.5

0

0

-0.5

-0.5

1

2 Number

3

4

Figure 4.3: Db2 Low pass and High pass Filter

4.3 Bi-orthogonal Wavelet Filter Properties:
Bi-orthogonal wavelet has reconstruction and decomposition filters. Different cut of frequencies are used to analyze the signal at different scale. Filter characteristics is symmetric and linear phase. Symmetric filter structure decomposes the high pass and low pass filter in each level

38

which is the structure of the discrete wavelet packet transform (DWPT)[9]. It has dual decomposition and reconstruction function.

Bi-orthogonal filter is efficient because orthogonal property provides limitation to construct wavelet. This filter is more flexible and it has dual scaling and wavelet function that generates Multiresolution analysis. Bi-orthogonal wavelets are shorter than orthogonal wavelets. It has faster algorithm for data compression and accuracy. This filter has decomposed the data and rejecting the noise. For this reason we get low BER in Bi-orthogonal filter and result is discussed in the simulation.

Bi-orthogonal High Pass and Low Pass Filter Structure: This figure (4.4) implies low pass and high pass filter structure of the Bi-orthogonal filter 3.9, where the filter length is 20.
Dec. low-pass filter bior3.9 1 1 0.5 0.5 0 0 -0.5 -0.5 -1 Dec. high-pass filter bior3.9

0

5

10

15

20

0

5

10

15

20

Rec. low-pass filter bior3.9 0.8 0.6 0.4 0.2 0 1 0.5 0 -0.5 -1

Rec. high-pass filter bior3.9

0

5

10

15

20

0

5

10

15

20

Figure 4.4: Bi-orthogonal high pass and low pass filter

39

As we know that Bi-orthogonal filter has dual scaling and wavelet function. It has 9 vanishing moment for decomposition and 3 for reconstruction.

Construction & Reconstruction: The following equation represents the wavelet reconstruction function, where  the low is pass filter and  is the high pass filter. Wavelet function is called mother wavelet.

  = 2



  + 2  +1  + [  + 2 ] ( +1 

(4.6)

Figure 4.5 represents the reconstruction wavelet function of Bi-orthogonal filter 3.9.
Reconstruction of the wavelet bior3.9 for 1 to 1 iterations 1.5

1

0.5

Amplitude

0

-0.5

-1

-1.5

0

2

4

6

8

10 Number

12

14

16

18

20

Figure 4.5: Reconstruction wavelet function of Bi-orthogonal filter

Reconstruction Scaling Function:

Figure 4.6 implies that scaling function of Bi-orthogonal filter (3.9).This scaling function is scaling the signal.

40

Reconstruction of the scaling bior3.9 for 1 to 1 iterations 0.8 0.7 0.6 0.5

Amplitude

0.4 0.3 0.2 0.1 0

0

2

4

6

8

10 Number

12

14

16

18

20

Figure 4.6: Reconstruction scaling function

Decomposition wavelet function (),


() =



  ø   +
 =1



   ] 

(4.7)

Where, Ø  represents scaling function,   represents wavelet function,  is the number of levels in the decomposition,   is wavelet coefficient,   is scaling coefficient and ( ) is the signal. Figure 4.7 indicates the decomposition wavelet function of the Bi-orthogonal filter (3.9).
Decomposition of the wavelet bior3.9 for 1 to 1 iterations 0.8 0.6 0.4 0.2

Amplitude

0 -0.2 -0.4 -0.6 -0.8

0

2

4

6

8

10 Number

12

14

16

18

20

Figure 4.7: Decomposition wavelet function

41

Decomposition Scaling Function: Figure 4.8 implies the decomposition scaling function of Biorthogonal filter (3.9).
Decomposition of the scaling bior3.9 for 1 to 1 iterations 1.4 1.2 1 0.8 0.6

Amplitude

0.4 0.2 0 -0.2 -0.4 -0.6

0

2

4

6

8

10 Number

12

14

16

18

20

Figure 4.8: Decomposition scaling function

42

4.4 Reverse Bi-orthogonal Filter: This wavelet is obtained from the Bi-orthogonal filter.
This wavelet is reverse of Bi-orthogonal filter. In the following figure we have shown the diagram of low-pass and high-pass filter structure of Reverse Bi-orthogonal filter.
Dec. low-pass filter rbio3.9 0.8 0.6 0.4 0.2 0 1 0.5 0 -0.5 -1 Dec. high-pass filter rbio3.9

0

5

10

15

20

0

5

10

15

20

Rec. low-pass filter rbio3.9 1 1 0.5 0 0 -0.5 -1

Rec. high-pass filter rbio3.9

0.5

-0.5

0

5

10

15

20

0

5

10

15

20

Figure 4.9: Reverse Bi-orthogonal high pass and low pass filter

In this wavelet filter, scaling and wavelet function are just reverse from Bi-orthogonal filter which is discussed in earlier section.

43

Chapter 5: Simulation& Result
5.1 Simulation result of Different Wavelet Filter:
The goal of the system simulation is to study the system performance. This work is done for based on knowledge of the wavelet transform and OFDM technology. Wavelet based OFDM for PLC simulation is studied in Matlab @ Simulink and modeled designed in a flexible manner, so that we can test different kinds of wavelet filter. We have tested different wavelet filters in the simulation model where total transmitted bits are 1.76e06. We have also added the noise in the simulation model. We have calculated the bit error rate in terms of different wavelet filters. Our finding from the simulation shows that Bi-orthogonal filter (3.9) generates low bit error rate. Noise parameter has been considered as a Gaussian variance 3 and sigma (Rician Noise) 1.5.

Table 1: Simulation table of different wavelet filter

Wavelet Filter Haar Ribiro(3.3) sym2 bior(5.5) bior(1.1) bior(3.3) bior(3.5) bior(3.7) bior(3.9) bior(4.4) bior(6.8) db1 db2 db3 db4 db5 db6 db7 db8 db9 coif5 coif2

Bit error rate 9.57E-05 0.000558 8.71E-05 0.0001498 9.57E-05 3.53E-05 3.13E-05 4.67E-05 2.79E-05 0.0001162 5.97E-05 9.57E-05 8.71E-05 0.0001019 9.28E-05 6.95E-05 9.91E-05 6.95E-05 0.0001014 9.34E-05 0.001472 8.31E-05

Error bits 168 980 153 263 168 63 55 82 49 204 105 168 153 179 103 122 174 122 178 164 2585 146

Transmitted bits 1.76E+06 1.76E+06 1.76E+06 1.76E+06 1.76E+06 1.76E+06 1.76E+06 1.76E+06 1.76E+06 1.76E+06 1.76E+06 1.76E+06 1.76E+06 1.76E+06 1.76E+06 1.76E+06 1.76E+06 1.76E+06 1.76E+06 1.76E+06 1.76E+06 1.76E+06 44

5.2 Simulation Model for PLC:
We have modeled the following PLC model. In figure 5.1 we have shown the wavelet based power line communication model.

Figure 5.1: Simulation model of power line channel

As we have mentioned in chapter 3, Bernoulli binary is the random data source in this model and OFDM is done with different kinds of wavelet filter. In table 1 we have shown the bit error rate of different kinds of wavelet filter. In this model a single frame consist 864 samples and sampling time is 2.32 -7 .

45

Sub Channel Selector: In figure 5.2 we have shown that the selection process of subchannel in OFDM. In OFDM we have used subchannel. In this figure we have shown how subchannel is selected on Simulink. In this model there are 16 subchannels and 1 subchannel consists 12 data carrier. Data carrier actually carries the signal.
Pi l ot Generator Add Pi l ots

-1

-1 1 In R S/P Sel ect Rows compl ex(0,0)*ones(1,1) -1 -1 1 Out

Subchannel Sel ector

1 Input Packi ng

Figure 5.2: Subchannel selector

OFDM Transmitter: In figure 5.3we have shown the wavelet based OFDM transmission. In conventional OFDM IFFT is used.

complex(0,0)*ones(28,2)

pshort U 1 In1 2 Insert Preamble1 complex(0,0)*ones(27,2) 1 Add Guard Bands1 Y MAT LAB Function IDWT -K1 Out

Reorder [0,...,Fs]

Figure 5.3: Wavelet based OFDM transmitter

46

But in this work we have used IDWT which is shown in this figure. In the IDWT block we can vary different kinds of wavelet filter which we have done in the simulation.

Simulation Parameter:              1 OFDM symbol : Depends on MCS Number of subchannel=16 Data carrier per subchannel=12 1 subchannel : 6bit Number of total subcarrier : 256 Number of used subcarrier : 200 Number of Data subcarrier : 192 Sampling Frequency  : 4.3MHz Channel B/W:2MHz OFDM duration of symbol= [1/( /)(1 +  )] = 2.78  10-5  where N=256,G=8/7, 1 Frame : 864 samples Total transmitted bits : 1.76e06 Total Frame : (1.76 e06/864) =2037

47

Graphical Data Representation: This is the graphical presentation of the data table. X-axis represents the different wavelet filter and Y-axis represents the bit error rate.

Number of bit error for different wavelet
3000 2500 2000 1500 1000 500 0 Haar Ribiro(3.3) sym2 bior(5.5) bior(1.1) bior(3.3) bior(3.5) bior(3.7) bior(3.9) bior(4.4) bior(6.8) db1 db2 db3 db4 db5 db6 db7 db8 db9 coif5 coif2 Figure 5.4: Graphical representation of wavelet transform for BER Error bits

Figure 5.4 implies that number of error bits for different kinds of wavelets. From the figure 5.4 we have seen that Coiflte wavelet provides more bit error rate among others. For power line communication Bi-orthogonal filter group provides low bit error rate for its characteristics.

5.4 Bi-orthogonal (3.9) and Db2 Filter against Noise:
Figure 5.5 implies that the BER against different kind of noise (Gaussian noise and Rician Noise). The performance of both the wavelet filter against Gaussian noise is almost same. From the graph we can say that Bi-orthogonal filter has low bit error rate in terms of impulse noise as this noise is the key factor for PLC. Bi-orthogonal filter (3.9) has the lowest bit error rate among all wavelets. In Biorthogonal 3.9, wavelet filter has 9 vanishing moment for decomposition and 3 for reconstruction. Fewer vanishing moment in reconstruction provides low error rate which results greater vanishing moment for decomposition and smoother wavelet for reconstruction.

48

Bior (3.9) Bit Error Performance against Noise: In figure 5.5 we have shown the graph of bit error performance against noise of Bi-orthogonal wavelet.
x 10
-4

biorthogonal noise Gussain Noise Rician Noise

2

Ber
1 0 1.5

2

2.5

3 3.5 Noise parameter

4

4.5

5

Figure 5.5: BER performance against noise (Bi-orthogonal3.9)

DB2 Bit Error Performance against Noise: In figure 5.6 figure we have shown the graph of bit error performance against noise of Db2 wavelet.
8 x 10
-4

Dd noise Guassian Noise Rician Noise

7

6

5
Ber

4

3

2

1

0 1.5

2

2.5

3 3.5 noise parameter

4

4.5

5

Figure 5.6: BER performance against noise (Db2)

49

Both the figures (5.5 & 5.6) are the comparison of bit error rate for different wavelets (Db2 & Bior 3.9). From both the figure we have seen that Bior (3.9) has low bit error rate in noise (Rician & Gaussian noise). In the next section we discuss about the BER performance of conventional OFDM and wavelet OFDM.
10
0

Wavelet OFDM Conventional OFDM 10
-1

10

-2

Bit Error Rate

10

-3

10

-4

10

-5

10

-6

4

6

8

10

12 SNR

14

16

18

20

Figure 5.7: BER performance conventional OFDM and wavelet OFDM

In figure 5.7 shown the comparison bit error rate performance of the conventional OFDM and wavelet based OFDM system. As it can be observed from the figure, both the plots have same characteristics and behavior. In [3], the authors also mentioned the same characteristics of the bit error rate performance of WTOFDM and conventional OFDM. Although wavelet OFDM has a higher slope which means low bit error rate in terms of SNR. When we increase the SNR, we get lower bit error rate for the WTOFDM system. In conclusion we can say that, in PLC system wavelet OFDM has much better output than conventional OFDM. As a result, we can design the WTOFDM such a way which can use variety of PLC applications.

50

Chapter 6: Conclusion
In this thesis, we examine power line communication system with wavelet transform and this system provides better transmission. This thesis shows the advantage of wavelet transform interms of fast Fourier transform. To save the bandwidth in the PLC system we have used wavelet transform.

The PLC model is composed of the OFDM communication model. This research actually provides the detail idea about the wavelet transform and a detailed knowledge of the characteristics of the power line channel. The channel attenuation and noise scenario determine the capacity that can be used for communication. Capacity estimation for typical power line links, indicate that work toward much higher data rates can available today can be considered as rewarding. To develop PLC which exploits the high channel capacity, modulation scheme must be selected with care to cope with the peculiar properties of power lines. From today's point of view, WTOFDM based multicarrier signaling definitely appears most promising.

In FFT cyclic prefix imparts inefficiency in transmission whereas wavelet transform is free from cyclic prefix which makes it faster and efficient as the result, better performance in the case of impulsive noise is expected. As 2 MHz bandwidth is standard for PLC we had to manage our channel to be designed in that layout. The research work reveals the fact that Bi-orthogonal wavelet transform provides lower bit error rate among all the wavelets by virtue of its characteristics.

Future work can be done choosing different wavelets of PLC band for different application and the corresponding bit error rate can be measured. It is necessary to develop to the next generation of PLC communication systems with high data rates. This PLC communication model can be used comparison of the performance of different modulation and coding schemes and for future standardization. The results of simulations based on the model will be compared with the measurements of a real system in the future work.

51

Bibliography
1. 2. 3. 4. 5. IEEE standard 1901, "Draft standard for broadband over power line networks: Medium Access Control and Physical Layer Specifications," [online]. Available: http://grouper.ieee.org/groups/1901/index.html, 2009. M. Rapp and Klaus Dostert, "Power line channel characteristics and their effect on communication system design,'' IEEE Communications Magazine, vol. 42, no. 4, pp. 78-86, April 2004. S. Galli and O. Logvinov, "Recent developments in the standardization of power line communications," IEEE Communication Magazine, vol. 46, no. 7, pp. 64­71, July 2008. S. Goldfisher and Shinji Tanabe, "IEEE 1901 Access System: An overview of its uniqueness and motivation," IEEE Communications Magazine, vol. 48, no. 10, pp. 150-157, October 2010. Md. Rahman, Jaejo Lee, Md. Abdur Razzaque, Jin Hyuk Kim, "Medium Access Control for power line communications: An overview of the IEEE 1901 and ITU-T G.hn standards," IEEE Communication Magazine vol. 49, no. 6, pp. 183-191, June 2011. 6. 7. P. Mlynek, Martin Koutny, Jiri Misurec, "Multipath channel model of power lines," Electrorevue, vol. 1, no. 2, pp. 48-53, June 2010. S. Galli, H. Koga and N. Kodama, "Advanced signal processing for PLCs: Wavelet-OFDM," in Proc. IEEE International Symposium International Symposium Power Line Communication 2008, no. 1, vol. 1, pp. 187192, April 2008. 8. 9. R. Dilghamani, R. Ghavami, "Wavelet vs Fourier based UWB system," in Proc. 18th International Symposium, pp. 1-7, September 2007. The Math Works, [Online]. Available: http://www.mathworks.com/discovery/wavelet-transforms.html. 10. Michel weeks, Digital Signal processing using Matlab and wavelets, Infinity science press LLC, 2007, ch. The Wavelet Transform, pp. 300-361. 11. S. Chen, Xuedong Chen, "Measurement and simulation of power line channel using OFDM for UWB communication," in Proc. International Symposium Power Line Communication 2009, pp. 79-84, April 2009. 12. M. Zimmermand Klaus Dostert, "A multipath model for the power line channel," IEEE Communications Magazine, vol. 50, no. 4, pp. 553-559, April 2002. 13. B. Danovic, M. Siemens, Osijek, Croatia, "Power line communication system modeling based on coded OFDM," in Proc. 35th IEEE international convention MIPRO, pp.760-764, May 2012. 14. K.. Dostert, "Power Lines as high speed data transmission channels modeling the physical limits," in Proc. 5th IEEE international Symposium, pp. 585-589, September 1998. 15. A. Zeddam Febienne Moulin and Frederic Gauthier, "Indoor power line communications channel characterization up to 100 MHz-Part 1: One parameter deterministic model," Power Delivery IEEE Transactions, vol. 23, no. 3, pp. 1392 ­ 1401, July 2008. 16. S. Galli, "A simplified model for the indoor power line channel", in Proc. 2009 Integrated power and load control, pp. 13-19, April 2009.

52

