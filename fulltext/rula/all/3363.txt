FUSING MAGNETIC RESONANCE IMAGING DATA FOR STUDYING VENTRICULAR FIBRILLATION
by Karl Magtibay B.Eng., Ryerson University, 2012

A thesis presented to Ryerson University in partial fulfillment of the requirements for the degree of Master of Applied Science in Electrical and Computer Engineering

Toronto, ON, Canada c Karl Magtibay 2014

AUTHOR'S DECLARATION FOR ELECTRONIC SUBMISSION OF A THESIS I hereby declare that I am the sole author of this thesis. This is a true copy of the thesis, including any required final revisions, as accepted by my examiners. I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research. I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. I understand that my thesis may be made electronically available to the public.

i

Abstract
Fusing Magnetic Resonance Imaging Data for Ventricular Fibrillation Studies Master of Applied Science, 2014 Karl Magtibay Department of Electrical and Computer Engineering, Ryerson University Ventricular Fibrillation (VF) has been described as seemingly random activations on the ventricles of the mammalian heart and is one of the causes of Sudden Cardiac Deaths (SCD). Medical imaging techniques, such as Magnetic Resonance Imaging (MRI), could potentially provide a better way of collecting data and understanding the true nature of VF than the techniques that are currently being employed. In addition, as there is a wide variety of MR techniques, fusing and jointly analyzing complementary data sets could also prove beneficial in providing parameters that are informative in studying VF and are otherwise unobservable by inspection. In this thesis, the author explores the quantification of the combination of MRI techniques, Current Density Imaging (CDI) and Diffusion Tensor Imaging (DTI), as novel tools for studying VF. This was accomplished by performing two feature-based data fusion techniques, Joint Independent Component Analysis (jICA) and Canonical Correlation Analysis (CCA). Using 12 imaging data sets from 10 live porcine heart experiments, both data fusion techniques provided unique ways from which the variations of CDI and DTI data sets were used to distinguish cardiac states. The results obtained by the jICA approach demonstrated discrimination between VF and non-VF subjects (p = 0.020) using the jICA loadings with evidence of a significant increase in the mutual information post fusion. For the CCA approach, using the pairwise mixing profiles, we observed discrimination between VF and non-VF subjects (p = 0.023) with a 7.25% increase in average correlation between the modalities, post fusion. The results of the study demonstrate that the fusion of CDI and DTI data sets captures and enhances the variations in electrical current pathways in relation to a myocardial structure that are unique to a cardiac state, such as VF. This study serves as a strong precursor for exploring MRI and data fusion techniques in studying VF. Such a study could provide greater insights on VF characteristics inspiring better treatment options for patients vulnerable to VF.

ii

Acknowledgment
I would like to express my deepest gratitude to the following people who made tremendous efforts for the realization of this study: to my supervisors, Drs. Umapathy and Krishnan, without whose guidance and insights, this work would not have come to fruition; to Dr. Foomany and Mr. Beheshti, being an integral part of our team, who went on great lengths on breaking ground and optimizing experimental protocols for our live porcine heart studies; to Mr. Koch, who assisted us through preparing and improving our technical set up; to Mr. Spiller, for providing the team time and his expertise on MR scanners; to Mr. Masse, Mr. Lai, Mr. Asta, Dr. Zamiri, and Dr. Nanthakumar for providing their clinical expertise and performing the experiments; last but not the least, to Mr. Balasundaram for providing me critical feedback with regards to my thesis and technical processes.

iii

To my beloved parents, to my brother, and to my best friend.

iv

Contents
1 Introduction 1.1 Cardiac Electrophysiology . . . . 1.2 Cardiovascular Disease . . . . . . 1.3 Types of Ventricular Arrhythmias . 1.3.1 Ventricular Tachycardia . 1.3.2 Ventricular Fibrillation . . 1.4 Motivation . . . . . . . . . . . . . 1.5 Outline . . . . . . . . . . . . . . 1 2 3 5 5 6 7 10 13 14 14 19 23 26 28 29 33 35 37 38 38 40 44 45 47 48 51 51 55 56

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

2

Background 2.1 Magnetic Resonance Imaging . . . . . . . . . . 2.1.1 Magnetic Resonance Theory . . . . . . 2.2 Current Density Imaging . . . . . . . . . . . . 2.3 Diffusion Tensor Imaging . . . . . . . . . . . . 2.4 Data Fusion . . . . . . . . . . . . . . . . . . . 2.4.1 Pixel-Based vs. Feature-Based Fusion . 2.4.2 Feature-based Data Fusion Techniques 2.4.3 Dimension Reduction . . . . . . . . . 2.5 Summary . . . . . . . . . . . . . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

3

Feature-Based Data Fusion - Joint Independent Component Analysis 3.1 Porcine Heart Experiments - Data Acquisition . . . . . . . . . . . . 3.1.1 Experimental Protocol . . . . . . . . . . . . . . . . . . . . 3.1.2 Experimental Setup . . . . . . . . . . . . . . . . . . . . . . 3.1.3 MRI Imaging Parameters . . . . . . . . . . . . . . . . . . . 3.2 Experimental Procedure . . . . . . . . . . . . . . . . . . . . . . . . 3.3 Calculation of Current Density Images . . . . . . . . . . . . . . . . 3.4 Calculation of Diffusion Tensor Images . . . . . . . . . . . . . . . 3.5 CDI and DTI Registration and Batch Matching . . . . . . . . . . . 3.5.1 CDI and DTI Batch Matching . . . . . . . . . . . . . . . . 3.5.2 CDI and DTI Registration . . . . . . . . . . . . . . . . . . 3.6 Joint Independent Component Analysis . . . . . . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

v

3.7

3.8 4

3.6.1 Data Pre-processing . . . . . . . . 3.6.2 Dimension Reduction . . . . . . . 3.6.3 Information Maximization for jICA 3.6.4 Image Reconstruction . . . . . . . Review of Results - jICA . . . . . . . . . . 3.7.1 jICA Loadings . . . . . . . . . . . 3.7.2 Joint Histograms . . . . . . . . . . 3.7.3 Data Fusion Metrics . . . . . . . . Summary . . . . . . . . . . . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

. . . . . . . . .

56 56 59 60 60 60 63 65 69 72 73 73 73 76 77 77 77 78 82 84

Feature-Based Data Fusion - Canonical Correlation Analysis 4.1 Canonical Correlation Analysis . . . . . . . . . . . . . . . 4.1.1 Data Pre-processing . . . . . . . . . . . . . . . . 4.1.2 Dimension Reduction . . . . . . . . . . . . . . . 4.1.3 Canonical Correlation Analysis . . . . . . . . . . 4.1.4 Image Reconstruction . . . . . . . . . . . . . . . 4.2 Review of Results . . . . . . . . . . . . . . . . . . . . . . 4.2.1 CCA Weights . . . . . . . . . . . . . . . . . . . . 4.2.2 Joint Histograms . . . . . . . . . . . . . . . . . . 4.2.3 Data Fusion Metrics . . . . . . . . . . . . . . . . 4.3 Summary . . . . . . . . . . . . . . . . . . . . . . . . . .

. . . . . . . . . .

. . . . . . . . . .

. . . . . . . . . .

. . . . . . . . . .

. . . . . . . . . .

. . . . . . . . . .

. . . . . . . . . .

. . . . . . . . . .

. . . . . . . . . .

. . . . . . . . . .

. . . . . . . . . .

. . . . . . . . . .

. . . . . . . . . .

5

Conclusions and Future Work 86 5.1 Summary and Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 86 5.2 Directions for Future Work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 88

A Auxillary Notes on jICA and CCA 90 A.1 Information Maximization Verification . . . . . . . . . . . . . . . . . . . . . . . . 90 A.2 Canonical Correlation Analysis Algorithm Verification . . . . . . . . . . . . . . . 91 B Publications 93 B.1 Conferences . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 93 B.2 Abstracts . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 94

vi

List of Figures
1.1 1.2 1.3 2.1 A) Anatomy of a human heart; B) Conduction system of a human heart [1] c ElsevierSaunders 2014 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3 Sequential process of cardiac activation [2] c McGraw-Hill 2014 . . . . . . . . . . 4 Flow chart for Data Fusion and Analysis . . . . . . . . . . . . . . . . . . . . . . . 12

Difference of spin orientation of atomic nuclei in the presence and absence of an external magnetic field B0 ; blue elements are in a low energy state (spin up) while red elements are in a high energy state (spin down); arrow heads represent the north pole and arrow tails represent the south pole of a magnet [3] . . . . . . . . . . . . 2.2 MR signal generation seen from Laboratory Frame of reference . . . . . . . . . . . 2.3 MR signal generation seen from Rotating Frame of reference . . . . . . . . . . . . 2.4 Free Induction Decay from Laboratory and Rotating frames of reference . . . . . . 2.5 Spin echo CDI pulse sequences: Tc is the total electrical current pulse duration, A is the amplitude, D is the delay between pulses, significances of which are described in [4] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.6 Collection of Bx , By , and Bz components; Green square is the slice of interest; Red dot is used to indicate different orientations . . . . . . . . . . . . . . . . . . . 2.7 Example of CDI images of an asystolic porcine heart: (left to right) displays the Jx , Jy , and Jz components of the injected current . . . . . . . . . . . . . . . . . . 2.8 An ellipsoid that represents molecular diffusion from which a diffusion tensor is derived; 1 , 2 , and 3 are the principal diffusion axes . . . . . . . . . . . . . . . . 2.9 Example of a DTI image of slice from an asystolic porcine heart. Colors represent the direction of the primary eigenvector of the diffusion tensor which represents fibre orientations: Red channel represents medial-lateral fibres; Green channel represents anterior-posterior fibres; and Blue channel represents superior-inferior fibres 2.10 jICA Data Organization; association of components, sources, and subject covariation are highlighted in red . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.11 CCA Data Organization; association of components, sources, and subject covariation are highlited in red . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3.1 3.2

15 16 17 18

20 21 23 25

26 30 33

Experimental Protocol - Timeline . . . . . . . . . . . . . . . . . . . . . . . . . . . 39 Mobile Langendorff System; R: Tyrode Reservoir; Pu: Aquatic Pump; BT1: Bubble Trap 1; BT2: Bubble Trap 2; H: Heart; Ph: Phantom . . . . . . . . . . . . . . . 40

vii

3.3 3.4 3.5 3.6 3.7 3.8

3.9 3.10

3.11 3.12 3.13

3.14 3.15 3.16 3.17

3.18 3.19 3.20 3.21

3.22

Porcine Heart and Electrode Placement; C: current injection electrode; E/D: ECG and defibrillation electrode; S: stimulation electrode . . . . . . . . . . . . . . . . . CDI Electronics; T: Trigger; V1 : microcontroller voltage output; V2 : amplifier voltage output; G: ground . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . MRI Phantom used for Porcine Heart Experiments . . . . . . . . . . . . . . . . . Histogram of a magnitude image . . . . . . . . . . . . . . . . . . . . . . . . . . . CDI image calculation process . . . . . . . . . . . . . . . . . . . . . . . . . . . . Jz component for each slice for each subject: From the top, the first four image sets are from the state of VF; the second four image sets are from the state of AS; the last four image sets are from the state of NM . . . . . . . . . . . . . . . . . . . DTI Images showing the approximate fibre orientation with views of the A) Sagittal, B) Coronal, and C) Transverse planes derived from 21 slices . . . . . . . . . . Original blue channel images used for fusion: From the top, the first four image sets are from the state of VF; the second four image sets are from the state of AS; the last four image sets are from the state of NM . . . . . . . . . . . . . . . . . . . CDI to DTI Batch Matching Scheme: to match CDI and DTI slices, mask areas from the two modalities were compared by mask area-ratio variance . . . . . . . . Original DTI and CDI masks to be matched; AR: area ratio . . . . . . . . . . . . . Optimization curve: the DTI batch that has the lowest area variance is matched to the CDI batch. In the case of Jan 27 VF, the 13th shift offers the lowest area variance therefore DTI slices 13 to 18 are matched with CDI slices 1 to 6 . . . . . Example of matched and registered CDI and DTI images . . . . . . . . . . . . . . Implemented branches of the study for the following sections of jICA . . . . . . . Process of A)Dimension Reduction, B)jICA feature matrix preparation, and C)Slice reconstruction for performing jICA according to [5] . . . . . . . . . . . . . . . . . jICA loadings: A) VF vs. non-VF loadings, B) NM vs. AS loadings; and comparison of average joint histograms of all reconstructed components: D) VF vs. non-VF, E) NM vs. AS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ICA weights of separate imaging data sets, CDI (top) and DTI (bottom) for pairwise comparison . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Reconstructed CDI and DTI images from jICA; the pixel values in this display are converted to z -values and are thresholded at |z | = 3 . . . . . . . . . . . . . . . . . Comparison of Joint Histograms Before(top) and After(bottom) jICA . . . . . . . An example of the distribution of averaged skewness of joint histograms of the CDI and DTI components from VF and non-VF comparison before (left column) and after (right column) jICA fusion . . . . . . . . . . . . . . . . . . . . . . . . . An example of the distribution of averaged mutual information of joint histograms of the CDI and DTI components from VF and non-VF state comparison before (left column) and after (right column) jICA fusion . . . . . . . . . . . . . . . . . .

42 43 44 47 49

50 51

52 53 53

54 55 57 58

61 62 64 66

68

70

4.1

Preliminary examinations of Correlations of the different components of CDI (Jx , Jy , and Jz ) and DTI (R,G, and B) . . . . . . . . . . . . . . . . . . . . . . . . . . 73

viii

4.2 4.3

4.4 4.5 4.6 4.7 4.8

Implemented branches of the study for the following sections of CCA . . . . . . . 74 Process of A)Dimension reduction per subject and feature matrix generation, B)Dimension reduction of feature matrix and CCA performance, C)Feature matrix projection and D) Image reconstruction per subject [6] . . . . . . . . . . . . . . . . . . . . . 75 Scatter plots of the CCA loadings of CDI and DTI components for ANOVA tests on A) VF vs. non-VF subjects and B) NM vs. VF . . . . . . . . . . . . . . . . . . 79 Original CDI and DTI images and Reconstructed CDI and DTI images from CCA; pixel values in this display are converted to z -values and are thresholded at |z | = 3 80 Joint Histograms from the A)VF vs. B)non-VF comparison and the C)NM vs. D)AS comparison . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81 An example of the distribution of skew values comparison before (left column) and after (right column) CCA fusion . . . . . . . . . . . . . . . . . . . . . . . . . . . 83 An example of the correlations of CDI and DTI histograms before and after CCA fusion from an NM vs. VF pairwise comparison . . . . . . . . . . . . . . . . . . . 84

A.1 IM Algorithm Verification . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91 A.2 Comparison of designed and calculated correlations of the columns of the mixing and demixing matrices, respectively . . . . . . . . . . . . . . . . . . . . . . . . . 92

ix

List of Tables
3.1 3.2 4.1 Summary of Number of Subjects per Cardiac State . . . . . . . . . . . . . . . . . 38 Cross validation using linear discriminate analysis with LOO method for JICA . . 63 Cross validation using linear discriminate analysis with LOO method for CCA . . . 78

A.1 Correlation between estimated and original sound files . . . . . . . . . . . . . . . 90

x

Chapter 1 Introduction

T

HE heart is responsible for delivering adequate blood flow throughout the human body. The heart sustains all other parts of the body with important nutrients to properly function. Al-

though the physiology of the heart is relatively well understood, the same cannot be said to its afflictions. Cardiovascular diseases plague both patients and researchers; researchers have studied the heart's pathologies to improve patient lives to only come up short of understanding the true nature of such diseases. Although human knowledge and technology have come far from their predecessor's accomplishments, there is still much left to learn from cardiovascular diseases. Cardiac arrhythmias are generally the primary result of cardiovascular diseases and have been one of the major global health concerns. Ventricular Fibrillation (VF) is one type of cardiac arrhythmia that has remained elusive amongst all other types of cardiac arrhythmias despite of strong research efforts in understanding its true nature amidst its seemingly chaotic dynamics and complex physiology. VF is one of the most lethal form of cardiac arrhythmias as it has an extremely narrow window of opportunity (5 to 10 minutes) for emergency treatment [1] application before irrecoverable bodily damage settles in or results to a sudden cardiac death. In this Chapter, a review of the basic anatomy and physiology of the human heart is presented. Cardiovascular diseases and a focus on the types ventricular arrhythmia will be briefly discussed, with a special focus on VF. The motivation for this graduate thesis will be introduced, comparing those methodologies in previous VF studies with the proposed technique.

1

1.1

Cardiac Electrophysiology

The human heart is the core of the circulatory system. It is the biological pump that is responsible to the delivery of sufficient nutrition to the different organs of the body with blood as a medium. The human heart, as shown in Figure 1.1A, is composed of the four chambers: the left and right atria and the left and right ventricles. The chambers on the left and right are separated by a muscle wall called septum while the atria and ventricles are separated by valves (the right atria and right ventricle is separated by the tricuspid valve while the left atria and left ventricle is separated by the bicuspid valve). The human heart has its own conductive system (Figure 1.1B); it is composed of the sinoatrial (SA) node, atrioventricular (AV) node, atrioventricular bundles, the left and right bundles of branches, and Purkinje fibres, all in sequence from the top of the right atrium to the apex of the ventricles then around the ventricle walls, respectively. In normal physiological circumstances, myocardial cell activation is primarily influenced by pacemaker cells at the SA node. As a result of tissue metabolism, oxygen-depleted blood is delivered through two major veins, the superior and inferior vena cava, to the right atrium. At the same time, oxygen-rich blood is delivered from the lungs, through the pulmonary arteries, in to the left atrium. As the atria are being filled with blood and the SA node begins to excite the atria, depolarizing them (Figure 1.2a). Subsequently, the pressure builds up in the atria and the contraction of the atrial muscles opens the tricuspid valve, for the right atrium, and the bicuspid valve, for the left atrium. Blood from the atria rushes in to the ventricles until they are filled up. At this time, electrical impulses travel from the atrial walls (Figure 1.2b) and converge at the AV node (Figure 1.2c). After a short pause (Figure 1.2d), the electrical impulses travel again this time through the AV bundles, through the left and right bundle branches, then finally to the Purkinje fibres (Figure 1.2e). The atria, at this point, has relaxed or repolarized. While the electrical impulses travel towards the myocardial walls, pressure builds up inside the ventricles and its walls expand for a short time. As a result of electrical excitation (Figure 1.2f) coupled with increased pressure, the semilunar valves above the ventricles opens (pulmonary seminlunar valve for the right ventricle and aortic semilunar valve for the left ventricle). Blood is ejected out of the right ventricle through the pulmonary veins towards the lungs to be oxygenated; oxygenated blood from the left ventricle is ejected through aorta towards 2

Figure 1.1: A) Anatomy of a human heart; B) Conduction system of a human heart [1] c Elsevier-Saunders 2014 the rest of the body to provide nutrition to the other organs of the body. The ventricles then slowly repolarizes from the bottom to its top section, relaxing the myocardial muscles (Figure 1.2g). The heart then prepares itself for the next cycle, filling the left and right atrium of oxygenated and deoxygenated blood. All of these processes constitutes one heart beat although heart beats are more associated to the ejection of blood out of the ventricles. On average, an adult human heart beats 75 times per minute [2]. A summary of the human heart's electrophysiology is summarized in Figure 1.2.

1.2

Cardiovascular Disease

Cardiovascular diseases generally refer to diseases that develop from the change in condition of the circulatory system which prevents it to function normally [1]: delivery of oxygen- and nutrient-rich blood and oxygen-poor and cell-by-products to and away from tissues, respectively. Consequences vary depending on many factors: organs affected, age, lifestyle, and diet among others. Thus the term cardiovascular diseases is an umbrella to various resulting diseases. When compared to cancer, cardiovascular disease has claimed significantly more lives each

3

Figure 1.2: Sequential process of cardiac activation [2] c McGraw-Hill 2014

4

year. According to a 2010 review of the American Heart Association, there are 2300 reported deaths from cardiovascular disease each day in the United States which translates to a mortality rate of 1 death for every 38 seconds [7]. Most of the prevalent cardiovascular diseases invoke cardiac arrhythmia that could be lethal if not treated immediately. Although some types of arrhythmia can persist in a long period of time without an individual being aware of it, they have long lasting, life-altering physiological effects. The types of cardiac arrhythmia that are considered fatal are those that afflict the ventricles of the heart. Since the ventricles function to pump blood out to the organs of the body, it is the most vital part of the heart. Here, two types of ventricular arrhythmia will be briefly discussed: Ventricular Tachycardia (VT) and Ventricular Fibrillation (VF).

1.3
1.3.1

Types of Ventricular Arrhythmias
Ventricular Tachycardia

Ventricular Tachycardia (VT) is described as abnormally rapid heart beats caused by ectopic pacemaker cells developed on the ventricles of the heart. Ectopic pacemaker cells are described as cells other than the SA node that assume a pacemaker function [2]. VTs that terminate after sometime are non-sustained VTs while VTs that lasts longer than 30 seconds are sustained [8]. VT has been characterized to two major types based on electrocardiogram profiles: Monomorphic Ventricular Tachycardia (MVT) and Polymorphyic Ventricular Tachycardia (PVT). MVT commonly results from re-entrant circuits around an infarcted region (oxygen-starved) of the myocardium [9]. It can be described as a succession of QRS waves which suggests a static origin on myocardium, usually around the infarcted regions. On the other hand, PVT irregularly changes morphology from one heart beat to the next. This suggests changing activation sequences of the ectopic pacemakers cells on the myocardium. Unlike MVT, PVT does not need regions of infarction on the myocardium in order to occur [9]. PVT can be associated from acute coronary ischemia and is the type of VT that eventually evolves to a more lethal form, VF.

5

1.3.2

Ventricular Fibrillation

Ventricular Fibrillation (VF) is regarded as the most lethal cardiac arrhythmia, claiming lives by the hundreds of thousands each year. VF has been described as unorganized or random regional activations of the ventricles which results to its uncoordinated contractions. In explanted hearts, quivering of the ventricles is the usual sign of a heart going in to a state of VF. While the heart is in VF, the ventricles are unable to pump out blood to the rest of the body as there is no synchrony in ventricular activation and muscle contraction present; much of the body is starved off of oxygen and is slowly degraded by its own by-products. The human brain, for example, is in constant need of oxygenation by the circulatory system. Without being provided with adequate oxygen, the human brain can degenerate in a matter of minutes. VF is believed to stem from the development of multiple ectopic pacemaker cells on the ventricles. These cells activate different regions of the ventricles at different times resulting in asyncrhonous contractions. Electrical current propagation resulting from these activations travel through the ventricular mass by exciting one region after another in a seemingly random fashion. While some of the regions of the ventricles are active, an approximate number of regions are in or about to reach a relaxed state. Eventually, the excitations reach its origin, activating it again and the cycle repeats. This phenomenon forms re-entrant circuits on the ventricles which are also known as Circus Movements (CM) [2]. According to [1], the initiation of fibrillation can be described with the effect of application of a 60 Hz alternating current to the surface of the ventricles. On application of the first cycle, the tissue right below a stimulating electrode are excited. The resulting electrical impulses then travel in all directions on the ventricles while the origin has entered a complete refractory state (unexcitable state). Most of the activated regions would begin to phase out of its refractory state after some time, however, some regions will be delayed and some will have long transitioned out. With subsequent excitations from the electrode at the origin, these differences in the state of refractoriness in the ventricles will cause electrical impulses to travel only in certain directions. It is important to note that those tissues that block impulse propagation are not necessarily in refractory state and that they could be damaged or infarcted. Tissues that are in refractory state or infarcted could facilitate a 6

roundabout for impulses travelling in between unexcitable tissues creating CMs. The propagation of impulses throughout the heart in only some directions is also a precursor to the development of CMs. Finally, as the electrical activations traverse through the ventricles, and with the increasing number of smaller roundabout regions, the initial macro-excitation breaks off to numerous microexcitations propagating in different directions. These excitations are further broken off to much smaller area of excitations forming a chain reaction. This sustains fibrillation by significantly lengthening the conduction pathways brought by many circuitous routes for impulses to propagate. Emergency treatments such as electrical defibrillation, cardiopulmonary resuscitation (CPR), and drug induction (epinehrine injections) have been known to have some success in disrupting VF, however, the number of fatalities is still overwhelming. This may be due to the relatively small window of time to apply such emergency treatments before asystole settles in. Several studies have shown that the time and manner of treatment application has played crucial roles in the survival of an individual undergoing VF [10­12]. Nonetheless, if people do ever survive an episode of VF, bodily damages are usually severe or even irrecoverable.

1.4

Motivation

As a result of the complex and random electrophysiological characteristics of VF, it has been a topic of great interest for researchers in the field of engineering and medicine. Perhaps it owes its lethality from it being the least understood cardiac arrhythmia. Although there is a tremendous research effort being invested by academics on VF, it is still far from being completely understood. As the nature of VF dictates, it is currently challenging to study VF's characteristics within a living subject. VF studies generally require access to the surface and sub-surface of the heart usually to collect region-specific electrograms, application of external intervention such as pacing and cardiac defribrillation, or histological examinations. Hence, the risk of dying for living subjects from such studies are extremely high and brings ethical issues on to the table. Hence, most VF studies have been done ex-vivo [13­15], harvesting a heart from a chosen subject after proper consent and protocol has been achieved. There have been numerous ex-vivo studies that include the mapping of the electrical activations 7

on the surfaces of the mammalian hearts (i.e. rabbit, canine, porcine, rodent, and humans) to study VF. Primarily, surface activation mapping is accomplished by either optical or electrical mapping. Optical mapping is primarily performed by injecting voltage-sensitive dye in to the heart's circulation, which fluoresce in the presence of propagating electrical impulses [13, 16­18]. The light it gives off are collected by a charged-coupled device (CCD) to project a two-dimensional map of the surface activation. As for electrical mapping, a sock mesh laden with conductive electrodes is used to capture electrical surface activation, which are then spatially mapped to match a ventricle's anatomy [14, 15, 19­21]. However, methods such as these limit the description of VF on a two-dimensional scale rather than in a three-dimensional media that is the heart. These give an incomplete picture of cardiac phenomena. In an attempt to capture sub-surface electrical activations of the ventricles, intramural and transmural studies have been conducted by [22­25] to characterize VF in a three-dimensional structure. Although such methods provide an extra dimension of information, data collected from these studies are limited in only a few regions of the ventricles depicting a fragmented three-dimensional electrical activation scheme. In addition, the procedure that is involved these types of study are invasive as it requires the piercing of the myocardium to gain access to ventricular sub-surface activity. Procedures like this do alter the structure of the myocardium and may affect the overall electrophysiological process of ventricular arrhythmia. In order to complete such a fragmented depiction of VF, interpolation techniques could be applied or a more mathematical approach may be undertaken. Cardiac models that can simulate both structural and functional aspects of a mammalian heart have been developed to provide a more theoretical but complete picture of cardiac electrophysiology. Some of the well-known cardiac models that have been used to characterize VF are the Fitzhugh-Nagumo model [26, 27], BeelerReuter model [28], Fenton-Karma model [29], and Aliev-Panfilov model [30, 31]. In most cases, such mathematical models have proven to be computationally expensive in terms of physical (i.e. memory and storage) resources and execution time. In addition, these models are strongly influenced by the assumptions made which may over-simplify real electrophysiological and mechanical phenomena.

8

The techniques introduced above present a general limitation: researchers are not able to obtain a complete physiological and anatomical picture of cardiac conditions. Since previous techniques have been focused on visualizing myocardial activities and structures, medical imaging techniques may be able to provide the missing pieces of information which could be the key in understanding VF. In the past, it has been shown that medical imaging techniques can be used to gather real and complete sets of functional and structural images, which reflect certain pathophysiologies such as Alzheimer's and Schizophrenia [32­35]. Magnetic Resonance Imaging (MRI), and the various techniques which branched out from it, has proved to be of great utility in conducting studies on structural and physiological aspects of certain diseases. Current Density Imaging (CDI), one of the MRI techniques, has been previously used in subject-level studies, primarily mapping electrical current pathways on biological subjects such as a pig torso for electrical fibrillation studies [36] or for electrochemotheraphy on mice tumours [37]; Diffusion Tensor Imaging (DTI) has been primarily used to examine the effects of alteration of water diffusion pathways in tissues in relation to certain afflictions such as stroke and brain tumours [38­40]. Furthermore some of the notable cardiac studies using DTI to characterize anatomical substrates for VF were previously performed by [41­43]. Usually, functional and structural imaging data were analyzed separately, creating only qualitative associations between two data sets provided there is an a priori knowledge of data sets. It is important to note that pathophysiologies are neither solely dependent on dynamic nor static static characteristics of tissues [44, 45] hence fusing two complementary data sets could prove vital to the further our understanding of the disorders of the human body. Data fusion techniques have been extremely helpful in providing quantitative means of combining two or more different sets of data, making various types of joint analysis possible [46, 47]. In the case of using medical imaging for VF studies, by fusing both functional and structural cardiac imaging data can bring to light the association of static and dynamic characteristics of different cardiac conditions. This in turn, can provide a greater understanding of VF from both physiological and anatomical perspective, which is otherwise unattainable with current techniques employed in studying VF.

9

The objective of this study is to two-fold: first, validate the novel approach of using the combination of MRI techniques, CDI and DTI, to study cardiac arrhythmia, such as VF. To do so, and secondly, we explore the utility of data fusion techniques to detect variations in the static and dynamic aspects of cardiac states (VF, normal (NM), and asystole (AS)) from CDI and DTI data. Through these approaches, the study is expected to arrive at quantifiable means to associate electrical current pathways and muscle fiber arrangements that are unique to a cardiac state. A flow chart of the work implemented in this thesis is shown in Figure 1.3.

1.5

Outline

This thesis is outlined as follows: · Chapter 2 -- Background. In this chapter, the theory behind MRI will be briefly discussed. The two MRI techniques which will be the focus of this thesis: CDI and DTI as means to collect information on the structural and functional information of a mammalian heart. Subsequently, Data fusion methods will be reviewed and contrasted to justify the proposed fusion method. Some of the existing works on using data fusion will also be briefly discussed. Finally, the mathematical background of the feature extraction, dimension reduction, and feature-based data fusion techniques will be introduced. · Chapter 3 -- Feature-Based Data Fusion - Joint Independent Component Analysis. Data acquisition processes will be outlined, including hardware design (i.e. mechanical and electrical), MR imaging parameters, and algorithms for image processing. A feature-based fusion technique called Joint Independent Component Analysis (jICA) will be reviewed; processes involved such as data pre-processing, dimension reduction, and image reconstruction shall be introduced; Finally, the results gathered from jICA shall be presented and discussed as part of data analysis and method evaluation. · Chapter 4 -- Feature-Based Data Fusion - Canonical Correlation Analysis. This chapter will present the fusion of image data sets from experiments described in Chapter 3 using Canonical Correlation Analysis (CCA). Similar to chapter 3, the processes of data pre10

processing, dimension reduction, and image reconstruction used for CCA will be presented. Results gathered from this work will be presented and discussed as part of data analysis and method evaluation. · Chapter 5 -- Conclusions and Future Work. Thesis will be summarized. Future works planned for the improvement and expansion of feature-based fusion and medical imaging for VF studies will be outlined.

11

Figure 1.3: Flow chart for Data Fusion and Analysis 12

Chapter 2 Background

M

EDICAL imaging has profoundly changed the face of medicine. The manner in which various diseases are detected and diagnosed have been revolutionized by medical imaging

techniques, making it possible for physicians to improve diagnoses and treat patients more safely and efficiently. Informative images can now be produced from medical imaging modalities, which enables doctors to study and treat health problems in a non-invasive manner. Therefore, modern medicine has been regarded as one of the marvelous products of medical imaging. There are numerous medical imaging techniques used in medicine; each technique used for unique methods of detecting diseases or abnormalities in a living individual. By utilizing physical phenomena, such as interaction of light beams to materials, anatomical and/or physiological information can be obtained in the form of images: X-rays for Radiography, high frequency sounds for Ultrasound (US), positrons for Positron Emission Tomography (PET), and energetic photons for Computed Tomography (CT). However, the raw information collected from such imaging modalities is meaningless without proper processing. Information arrives to a computing terminal in the form of signals, such as the Free Induction Decay (FID) in MRI, which require application of mathematical tools in order to construct images that best represent a targeted anatomy or physiology. Constructed images can be further processed in order to capture desired features in said images. This is true to all imaging modalities as well as for MRI. MRI has been heavily used for neurological studies from both a functional and structural perspective. In addition, the analysis of static and dynamic data

13

from MRI studies have only been performed through data-specific methods and very rarely jointly analyzed. In the case of cardiac arrhythmia, to the best of the author's knowledge, the application of medical imaging techniques to observe the relation and influence of cardiac electrophysiology and structure to cardiac arrhythmia is a novel process in itself. In this Chapter, the physics of MRI will be introduced: a brief overview of the theory behind magnetic resonance and the process of MR signal collection will be presented. In addition, the ideas behind the two main MRI techniques for our research (CDI and DTI) that are used in this thesis as sources of imaging data sets will be presented. Subsequently, data fusion methods utilized for cardiac imaging data fusion will be introduced along with feature extraction/dimension reduction techniques.

2.1

Magnetic Resonance Imaging

MRI utilizes the magnetic properties of the nuclei of atoms that makes up materials to produce images. Unlike X-ray, CT, or US, MRI is able to obtain high quality images of the human body regardless of the targeted structure. However, MRI is best for acquiring images of soft tissues as it provides better contrast differentiation. Unlike other imaging systems, MRI systems do not produce any type of radiation that could potentially harm a subject. So far, there have been no reports of magnetic fields produced by a MRI machine dealing serious harm to patients. Not only MRI systems can obtain anatomical images but it can also obtain functional images that can depict the physiological state of a targeted organ [48].

2.1.1

Magnetic Resonance Theory

The following is an excerpt from [3], introducing some of the necessary concepts of MR imaging: In medical imaging, the signals that are used to construct MR images are acquired from the water molecules, which make up most of a living organism. For every water molecule there are two hydrogen atoms and one oxygen atom. The nuclei of these atoms have their own magnetic properties as such can be treated as magnets. In normal conditions, each of these small magnets are arranged in random order, scattered in a biological sample. However, in the presence of a 14

Figure 2.1: Difference of spin orientation of atomic nuclei in the presence and absence of an external magnetic field B0 ; blue elements are in a low energy state (spin up) while red elements are in a high energy state (spin down); arrow heads represent the north pole and arrow tails represent the south pole of a magnet [3] strong external magnetic field, these small magnets align either parallel or anti-parallel to the main magnetic field (B0 ; such a magnetic field is measured in Tesla (T)). The elements that are parallel to B0 are said to be in a lower energy state (spin up) where as anti-parallel elements are said to be in a higher energy state (spin down) [3]. The number of elements that are parallel to B0 compared to those that are anti-parallel is usually greater. The net magnetization vector (NMV) is the vector that results from the difference between the number of spin up and spin down elements. Figure 2.1 shows the assembly of these elements in the absence and presence of an external magnetic field. It is important to note that each atoms rotate or precess about the B0 axis, hence having their own angular momentum. As a result, the NMV will be precessing as well. The rate at which the precession of the NMV is defined by the Larmor Frequency (0 ) which can be expressed as 0 = B0 (2.1)

where  is a specific gyromagnetic ratio of a nuclei and is measured in Megahertz per Tesla (MHz/T).  has different values for different kinds of nuclei. In the case of MRI used for medical imaging, hydrogen atoms are the main targets of resonance because of its abundance in living tissues. The gyromagnetic ratio of a hydrogen nucleus is 42.58 MHz/T. Therefore, its Larmor 15

Figure 2.2: MR signal generation seen from Laboratory Frame of reference frequency or rate of precession is 64 MHz under a 1.5T MRI system [3]. In order to create an MR signal, the NMV must be tilted towards the plane that is perpendicular to the B0 axis. This is accomplished by applying a secondary rotating magnetic field, B1 , for a short period of time. B1 rotates about the B0 axis. B1 , also called the 90  -pulse, has the same frequency as 0 in order for the NMV to reach a resonant stage. After B1 is withdrawn and because of the constant presence of B0 , NMV will undergo a relaxation stage to return to its original position. Through this process, an FID signal is generated. There are two ways to represent the relaxation of the NMV: 1) through a laboratory frame of reference and 2) a rotating frame of reference. In the laboratory frame of reference, in which a three-dimensional Cartesian coordinate plane is used, as B1 rotates about the B0 axis (Figure 2.2A), the relaxation of NMV can be observed as it gradually precesses about the B0 axis until it realigns itself with its original position (Figure 2.2B). On the other hand, in the rotating frame of reference, B1 is treated as a static magnetic field that is perpendicular to B0 (Figure 2.3A). The NMV then gradually positions itself back from the perpendicular plane directly towards the B0 axis without the precession about the B0 being apparent (Figure 2.3B). The MR signal is collected by placing a coil of conductive wire over the transverse axis. Following Faraday's law of magnetic induction, the precessing NMV will create some voltage as it passes under the coil [3]. The voltage collected from the coil is the MR signal and its magnitude depends on the length of the NMV component on the transverse axis . When one looks at the

16

Figure 2.3: MR signal generation seen from Rotating Frame of reference relaxation of NMV from the laboratory frame of reference, the precession of the NMV towards the B0 axis under the coil is represented as the FID signal. However, if one observes the relaxation of the NMV within the rotating frame of reference, only the envelope of the absolute value of the FID signal can be observed. These are both shown in Figure 2.4. In both signals, it can be seen that their amplitudes exponentially decrease over time as this is a result of the decrease in the portion of the NMV that traverses under the coil as it returns to its original position. It is important to note, that the amplitude of the FID signal is relative to the location of the NMV to a coil. If the NMV is far from a coil, the amplitude of the FID will be small whereas if the NMV is placed just under a coil, the amplitude of the FID will be large. At the moment of the application of B1 , the nuclei of the hydrogen atoms contained in water molecules, will precess at the same speed. Since these elements are close enough to influence each other's precession, each of these elements will then precess at different rates some time after the application of B1 . Because of the spin-spin interactions, dephasing occurs. NMV is now unseen from the transverse axis, and the MR signal collected from the coils is exponentially decreased. This type of relaxation is called the T2 relaxation and is described by the following equation: Mxy (t) = Mxy(t=0) e-t/T2 where Mxy is the length of the NMV on the transverse plane, or its projection, and t is time. An inherent inhomogeneity in the B0 field also adds to the cause of element dephasing during

(2.2)

17

Figure 2.4: Free Induction Decay from Laboratory and Rotating frames of reference NMV relaxation. Such inhomogeneity causes individual spins to precesses at different rates, on top of the spin-spin interactions. This causes a faster rate of element dephasing hence having a much faster MR signal decay. This type of relaxation that incorporates the spin-spin interactions
 as well as B0 inhomogeneity is called the T2 relaxation and is expressed as

Mxy (t) = Mxy(t=0) e-t/T2



(2.3)

 is that the latter occurs faster than the former. In addition, The difference between T2 and T2  with only the 90  -pulse initiating the process of NMV relaxation, T2 relaxation is the one that is

captured. Spin echo sequence, which will be discussed in the next section, is a way to exploit the dephasing process in order to capture the T2 relaxation. Another type of NMV relaxation times is the T1 relaxation. Instead of looking at the time NMV dephases on the transverse plane, this relaxation time focuses more on the recovery of the NMV along the B0 axis. Such a relaxation time is associated with the elements giving off their acquired energy from B1 to other elements and their surroundings hence it is also called the spin lattice relaxation. Compared to T2 and T2 , T1 relaxation occurs at a slow rate as described by the

18

equation Mz (t) = Mz(t=0) [1 - e-t/T1 ] (2.4)

Where Mz is the length of the NMV on the B0 axis. Equation (2.4) shows that the NMV exponentially increases over time compared to the other relaxation times. Note that MR signals can only be collected if the NMV has some component on the transverse axis, if there is a delay in the collection of MR signals, there might not be enough signal amplitude for an image to be formed. Because of the nature of the relaxation times of different types of tissues T1 - and T2 -weighted images are used for different purposes; T1 -weighted images are mainly used for anatomical surveying as they demonstrate high SNR, while T2 -weighted images are more applicable to most tissue pathologies, such as tumours, as some develop their own vasculature which involves an increased water content and therefore can be easily identified. In cardiovascular, MRI images are primarily used for detection of vascular masses, congenital heart disease, as well as valve and pericardial disease. MRI images are also used to detect cardiomyopathy and ischemic heart disease, which have been previously known as precursors to the initiation of VF [49, 50].

2.2

Current Density Imaging

There are some specialized techniques that have been developed for MR imaging in order to obtain specific information on either targeted anatomy or physiology. Some of these techniques have been used in research and medical diagnosis such as functional MRI (fMRI) [51], magnetic resonance angiography (MRA) [52], and magnetic transfer MRI [53]. The details of which are described elsewhere. A specialized MR application known as CDI has been developed by [4] in order to obtain three-dimensional information of the electrical current pathways in conductive materials, such as biological tissues. The idea behind the use of CDI, is that excitable tissues conduct electrical current which can be detected with MRI. Such electrical currents, when passing through a magnetic field provided by an MR scanner, produce magnetic field inhomogeneities which can be detected by the scanner. Depending on regional tissue properties, different areas will have varying electrical 19

Figure 2.5: Spin echo CDI pulse sequences: Tc is the total electrical current pulse duration, A is the amplitude, D is the delay between pulses, significances of which are described in [4] current passing through. Usually, a spin-echo pulse sequence [3] is used with this type of MR application with which an injected modulating electrical current is synchronized as shown in Figure 2.5. Inhomogeneities generated from this can be described by the resulting magnetic flux density (B) created within the conducting tissues. The magnetic flux densities can be observed from the phase component () of collected MR images such that B=  Tc (2.5)

where Tc is the duration of the injected electrical current. It is important to note that B is described as a vector and has three components, Bx , By , and Bz [4]. These are calculated from three sets of distinct phase images obtained by performing scans of a subject in three different orientations, as shown in Figure 2.6. Note that for each orientation, two current Phase Cycles (PCs) are applied on the subject. One phase cycle is shown in Figure 2.5 (PC1) and an equal but reversed current 20

Figure 2.6: Collection of Bx , By , and Bz components; Green square is the slice of interest; Red dot is used to indicate different orientations polarity is another Phase Cycle (PC2). For example, if Bx is required, the phase images collected for PC1 and PC2, P1,x and P2,x respectively, are unwrapped first (usually from - to  ). The magnetic flux associated for these PCs are calculated by (2.5), P1,x Tc P2,x B2 = Tc B1 = B1 and B2 are then averaged with each other to form Bx Bx = B1 - B2 2 (2.8) (2.6) (2.7)

From these components, an electrical current vector J is obtained by using Maxwell's equation [4] J=× B µ0 (2.9)

where µ0 is the permeability of free space. J can be expanded to show the three components of the electrical currents calculated from the curl of the components of B J = J x + Jy + J z 1 Bx Bz + - µ0 z x 21 (2.10) + 1 µ0 Bx By - y x (2.11)

J=

1 µ0

Bz By - y z

The partial differential terms are calculated by convolving the magnetic flux density components with a pre-defined template. For example, if Jz is desired,
Bx y

and

By x

are calculated in

such a way that the following matrices, which are edge-preserving or gradient-preserving filters, are convolved with Bx and By
Bx y By x

= conv (Bx , Tx ) = conv (By , Ty )  1 2 1 1  0 0 0  8x -1 -2 -1 

(2.12)

Where [4]  -1 0 1 1  -2 0 2  Ty = Tx = 8 y -1 0 1  (2.13)

Where y and x are the physical distances of subsequent pixels from each other in millimeter. This is determined by y =
F OV No. of Pixels on y-axis

x =

F OV No. of Pixels on x-axis

(2.14)

Sometimes, the resulting CDI images contain high pixel values around the edges of an object primarily because of the convolution of the templates shown on Equation 2.13. These may not be representative of the true CDI map (which are determined when the overall current passing through the image slice is calculated) so they are then excluded from the calculation of the total current passing through a slice by masking them off the object. An example of Jx , Jy , and Jz calculated from the MR scans performed on an asystolic pig's heart is shown in Figure 2.7. The colour of the pixels in Figure 2.7 represents the current density (A/m2 ) in an image slice . With the spatial mapping capabilities of CDI, it has been used in studies such as electrochemotherapy in mice tumours [37], determining conduction pathways in pig torso during defibrillation [36], and spatial distribution of electrical currents in a post-mortem human arm [54]. So far, CDI has neither been used to track electrical current pathways in a mammalian heart nor in any organlevel experiments. The application of CDI in this context can potentially depict the differences in electrical current pathways in a mammalian heart under different cardiac conditions.

22

Figure 2.7: Example of CDI images of an asystolic porcine heart: (left to right) displays the Jx , Jy , and Jz components of the injected current

2.3

Diffusion Tensor Imaging

DTI is a technique derived from the MRI method of Diffusion Weighted Imaging (DWI). As discussed before, living tissues are abundant with water molecules and are distributed all over its structure. These molecules move in a random fashion and such motion is characterized as a Brownian diffusion: over time water molecules undergo a randomly oriented displacement [55]. Molecular displacement in living tissue could be anisotropic(directional) or isotropic(non-directional) depending on the structure of the tissue itself hence DWI can provide structural information of a subject. An MRI system can capture the macroscopic diffusion of water molecules in tissues by the rapid use of different combinations of orientations of relatively weak magnetic fields (usually added or subtracted to B0 depending on a location in the main magnetic field) known as MR gradients [3]. As with CDI, a spin-echo paradigm is primarily used to gather diffusion weighted images. Naturally, there are modifications on the spin-echo pulse sequence that are applied such that an additional encoding process is involved [55]. In order to create a diffusion weighted image, two equal strength but opposite gradient pulses are applied before and after the 180  -pulse. Because of the inherent movement of water molecules in the subject, the molecules will experience varying gradient strengths during the first and second gradient application and the rephasing pro-

23

cess in a standard spin-echo sequence cannot be achieved. This results in a signal loss (S ) which is described by the equation [55] S = S0 e-b(ADC ) (2.15)

Where S0 is the original MR signal if b is zero; ADC is the apparent diffusion coefficient which pertains to molecular diffusivity affected by physical restrictions such as viscosity and spatial barriers; b is a parameter that describes the degree of diffusion weighting, which is determined by the gradient scheme parameters [55] b =  2 G2  2 ( - /3) (2.16)

Where,  is the gyromagnetic ratio, G is the strength of the gradient,  is the duration of gradient application, and  is the time between the two gradient applications. It shows that the MR signal collected during DWI is decreased significantly with increasing gradient strength and longer duration; this is also true with increasing time gap between gradients. Then MR signal loss can be directly attributed to ADC values which can be used to construct an image, being ADC values as pixel intensities. The contrast of an ADC image is dependent on the direction of the measurement or the direction in which gradients are applied. With the application of different combinations of gradients, images with orientation-dependent contrast can be generated reflecting the directionality of water molecule diffusion. As it is rare for real biological samples to have a completely ordered structure, diffusion is then measured relatively: using the x-,y-, and z-gradients along an oblique angle with respect to the original orientation of the biological structure. The axial measurements heavily depend on the orientation of an object in an anisotropic media. An ADC alone does not suffice to describe such anisotropy hence the need for DTI emerges. An ellipsoid (shown in Figure 2.8) is usually used to characterize such a diffusion from which a, three-dimensional voxel property, diffusion tensor (D), is constructed   Dxx Dxy Dxz D = Dyx Dyy Dyz  Dzx Dzy Dzz

(2.17)

Where Dij describes the diffusion variances of a water molecule along the ij-th axes and Dii describes the diffusion variances of a water molecule along the x-, y-, and z-axis [56]. If the structure 24

Figure 2.8: An ellipsoid that represents molecular diffusion from which a diffusion tensor is derived; 1 , 2 , and 3 are the principal diffusion axes happens to be isotropic (non-directional), one value of D is enough to describe the diffusion in an object. However for anisotropic structures in which the ellipsoid paradigm is applicable, most of the elements of the tensor D is non-zero. In addition, the major axes that describe the ellipsoid (i.e. longest, middle, and shortest) can be obtained by calculating the eigenvalues () and eigenvectors (v) of the tensor D Dv = v       e1 1 0 0 e1 Dxx Dxy Dxz Dyx Dyy Dyz  e2  =  0 2 0  e2  0 0 3 Dzx Dzy Dzz e3 e3 (2.18) (2.19)

An example of a DTI image slice and an accompanying tractography of an asystolic porcine heart is shown in Figure 2.9. The DTI image is usually encoded as an RGB-image and each colour channel contains a particular component of the main eigenvector of the diffusion tensor, D. This eigenvector approximately describes the orientation of muscle fibres, in the case of a porcine heart. From an initial study conducted by the author's team, the following fibre orientation convention was established for CDI studies that followed: red channel contains those medial-lateral fibres; green channel contains anterior-posterior fibres; blue channel contains the superior-inferior fibres [57]. 25

Figure 2.9: Example of a DTI image of slice from an asystolic porcine heart. Colors represent the direction of the primary eigenvector of the diffusion tensor which represents fibre orientations: Red channel represents medial-lateral fibres; Green channel represents anterior-posterior fibres; and Blue channel represents superior-inferior fibres DTI has been extensively used for white matter fibre tracking in the human brain to study an array of human brain pathologies such as stroke or schizophrenia [58]. Since these pathologies have been found to alter the natural structure of the human brain, DWI along with DTI has been able to localize changes hence bringing about a greater understanding of such diseases. Information gained from a DTI of a mammalian heart can provide additional information about structures that can be associated to cardiac pathologies, such as ischemia or infarction [39, 59­61], which have been shown as a contributing factor to the initiation of VF.

2.4

Data Fusion

Data Fusion has been used to provide a rounded perspective of provided data sets. In its essence, data fusion is used to combine two or more data sets in order to yield a new set of data which can contain the relationship between the original data sets. It is not to be confused with data integration in which there is one primary data set and other data sets that are related to it are used to improve the quality or add information to what is previously known. There are many data fusion 26

architectures [62] that have been developed throughout the years and have established different levels and categories in which data fusion may be applied; there is the signal/pixel level, the feature level, and the decision level. The signal/pixel level is most developed category in data fusion as most complementary data sets are readily fusible with each other. It is the easiest manner in which fusion can be performed as well since data sets need not be pre-processed for feature extraction unlike for the upper levels of fusion. Feature and decision level fusion have been mainly used for complementary but disparate forms of data such as image-to-signal or signal-to-decision, or imageto-decision. Note that disparity is not only limited to differences in data types; data types can be of the same nature however differ in some respects such as misregistered images or unique signal sources (i.e. electroencephalograph from the brain and electromyograph from skeletal muscles). The visualization of spatial information have been very helpful in diagnosing and establishing treatment plans for patients such as those that are affected by stroke or cancer tumours, for example. In MRI studies of the human brain [38, 48, 56], observations have been made on white matter tract changes (by DWI and DTI) and its effects on the human motor, perceptual, temporal, visual, and cognitive functions (by fMRI). Such information from different MR techniques are complementary with each other however have not been jointly analyzed in a quantitative manner. The joint analysis of such data sets could prove useful and, as cited above, reveal associations that are not available by separate analysis. Data fusion techniques are then extremely useful in such cases. Most of the previous biomedical studies using data fusion have been exclusively applied to the human brain [6, 63­67]. It may be that the data collection process involved in studying the human brain is relatively simpler than those that are involved in studying the human heart, especially those studies that are focused on cardiac arrhythmia. So far, static and dynamic parametric fusion of a mammalian heart have been limited to models [68] and less focus invested on fusion of real cardiac data. Biomedical imaging techniques, such as CDI and DTI, have been proved to be valuable in aiding in the visualization of some of the aspects of human heart pathologies. However, a joint analysis of such data sets could provide new sets of information that would have otherwise not be available through a separate analysis. An image-to-image feature level fusion will be the primary focus of this thesis. Using two

27

different types of image data sets to study VF: those from CDI, to reflect the dynamic features, and those from DTI, to reflect the static features of the mammalian heart. It is expected that through fusion, a quantitative measure could be produced from the underlying associations of such modalities to aid in cardiac state classification. This would support, however indirectly, that the variation in the current distribution during different cardiac states could be quantified using medical imaging.

2.4.1

Pixel-Based vs. Feature-Based Fusion

Pixel-Based fusion techniques have been around for quite some time and have been extensively used in medical image fusion to study different human pathophysiologies. Techniques such as Principal Component Analysis (PCA), Discrete Wavelet Transform (DWT), Intensity-Hue-Saturation (IHS), Brovey Transform (BT), and combinations of such techniques (i.e. IHS+PCA) have proved very useful in fusing images of the brain [69]. The goal of these pixel-based fusion techniques is to spatially combine the structural information (S) of an organ with its functional information (F). Although such information can be collected from two different domains, the overlaying of a structural image over a functional image given that proper registration techniques have been implemented is, by and large, acceptable. The reason for this is because each pixel in image S is approximately spatially equal to image F. For situations in which a point-by-point association cannot be approximated with sufficient certainty, feature-based fusion techniques are more useful than pixel-based ones; techniques such as jICA and CCA are employed primarily on representations (or features) of the original data sets hence bypassing the challenge of forming intravoxel associations. Not only that feature-based fusion is suitable for non-pixel-based association, it also uncovers some hidden relationships between the two or more data sets that are otherwise unobservable from a pixel-to-pixel perspective [65]. Furthermore, feature-based fusion makes it possible to collectively analyze all of the available subject data in order to study how subjects interact with one another. Feature-based fusion also allows the study of not only multi-subject, but also multi-state co-variation which provides a means to identify physiological states from each other. Because of the nature of the experiments conducted

28

for this thesis as well as the amount of data collected per experiment, it is more reasonable to implement a feature-level data fusion: not only such a technique collectively perform joint analysis on two modalities (i.e. CDI and DTI) to yield new information, it also has the ability to account inter-subject variation.

2.4.2

Feature-based Data Fusion Techniques

Joint Independent Component Analysis Joint Independent Component Analysis (jICA) is a feature-based data fusion technique that utilizes the concepts of a nerual network algorithm, Independent Component Analysis (ICA), which reveals the underlying or cross-information between two data sets as well as inter-subject and inter-state variations [65]. jICA is based on the idea of its predecessor, ICA: given a mixture of n number of signals, an n × n weight matrix can be estimated in order to separate the mixture to n independent signals. This is also known as the cocktail party problem: n number of independent speakers speak at the same time which creates a mixture of speeches. Just by hearing such a mixture, it is impossible to tell whose voice belonged to whom without an a priori knowledge of the independent speakers themselves [70]. ICA also assumes a generative type model with which the heard mixture of speeches from independent speakers are linearly mixed [65]. As outlined in [65], mathematically, given x = As (2.20)

where x is a mixture of n × m statistically independent signals, s, and A is an n × n mixing matrix. ICA estimates a n × n demixing matrix W through an unsupervised learning algorithm such that W = A-1 Then, an estimate, y, of the original independent components, s, can be extracted such that y = Wx where each row of y are maximally independent from each other. (2.22) (2.21)

29

Figure 2.10: jICA Data Organization; association of components, sources, and subject covariation are highlighted in red With jICA, given two feature data sets, XA and XB with dimensionalities N × V1 and N × V2 , respectively, and XJ as the concatenation of XA and XB with an N × V dimension where V = V1 + V2 , a joint demixing matrix can be estimated through a maximum likelihood function such as
N V

L(W) =
n=1 v =1

pJ,n (uJ,v )

(2.23)

where uJ = WxJ . Equation (2.23) can be expanded to show the contributions of the two given data sets in the estimation of the demixing matrix, W, that is
N V1 V2

L(W) =
n=1 v1 =1

pA,n (uA,v1 )
v2 =1

pB,n (uB,v2 )

(2.24)

From such a demixing matrix, W, the original mixing matrix, A, could be calculated from which component loadings (or better known as jICA loadings) can be calculated. From these loading parameters the components estimated through jICA can be evaluated as shown in [71], where the jICA loadings were used for group inferences. Although jICA provides a common platform for two different types of data, there are some constraints and assumptions that are needed to be taken in to account [65]: jICA assumes that the data sets that are being fused modulate in the same manner throughout the N number of subjects; jICA constrains the contributions of two different data types to be similar for the estimation of W which in turn means that each data type must be independently normalized. Figure 2.10 shows the data organization for jICA. So far, jICA has been primarily used for feature-based data fusion of brain data such as T2 -weighted images, fMRI, DTI, and EEG to study various neurological 30

diseases such as schizophrenia and Alzheimer's [63­65]. To the best of the author's knowledge, this is the first application of jICA to cardiac data. Canonical Correlation Analysis Canonical correlation Analysis (CCA) is a multivariate, statistical method used to identify linear relationships between two or more variables by obtaining maximally correlated matrices of projection vectors for each data set being fused [72]. As a feature-based data fusion technique, CCA have been primarily used to fuse signal and/or image data sets (i.e. EEG, fMRI, and structural MRI) collected from human brain studies [6, 66]. As explained in [72], given two feature data sets, XA and XB , with dimensionalities of N × V1 and N × V2 , respectively, CCA aims to estimate said projection vectors, KA and KB , which are also called canonical variates obtained from
T KT A = PXA T KT B = QXB

(2.25) (2.26)

in such a way that the correlation of the columns of KA and KB are maximized. In group inferences, these canonical variates are also considered as mixing profiles from which CCA loadings are obtained as pairwise columns between KA and KB [6]. The correlations between these mixing profiles are maximized through the following equation
T max corr(PXT A , QXB ) =

PA,B QT (PA PT )(QB QT )

(2.27)

In order for Equation 2.27 to be maximized, PA PT and QB QT must be constrained to I; P and Q are the scaled eigenvectors of the Lagrange multipliers as follows
-1 0 .5 - 0 .5 (- - rI)Q = 0 A AB B BA A 0 .5 1 -0.5 (- BA - - rI)P = 0 B A AB B -0.5 P = A P 1 Q = - B BA P

(2.28) (2.29) (2.30) (2.31)

31

where r contains the squared canonical correlations; I is an identity matrix; A and B are the auto-covariance matrices of data sets XA and XB , respectively; BA is the cross-covariance matrix between data sets XA and XB and AB = T BA . For data fusion, CCA follows a generative model in which the given data sets are assumed to be linear mixtures of independent sources. With its implementation, CCA will decompose the given feature data sets, XA and XB , to another set of components, CA and CB , using the derived canonical variates from Equation 2.25. The relationship between the canonical variates is reflected on the square root of r which contains the true correlations of each column of the canonical variate matrices. If the columns within a canonical variate matrix are uncorrelated, a one to one association of components contained in CA and CB can be inferred. The generative model for CCA can be written as Xk = Kk Ck for k = A,B (2.32)

where the canonical variates, Kk , and components, Ck , have dimensions of N × D and D × Vk , respectively; Vk is the number of variables in Xk , N is the number of observations in Xk , and D = min(rank(XA , XB )). The canonical variates must then satisfy the following constraints
T E [K1i , K2 i]  0 T E [K1i , K2 j ]  0 for i = j T E [Kki , Kkj ]  0 for i = j, k = A, B

(2.33a) (2.33b) (2.33c)

With the derivation of the canonical variates, Ck can be approximated through least-squares given by
-1 T Kk Xk for k = A, B Ck = (KT k Kk )

(2.34)

Figure 2.11 depicts the data organization of feature data sets for CCA. As with jICA and as mentioned before, CCA and its variations have been heavily used in neurological studies such as for schizophrenia and bipolar disorder [73] in discovering associative networks in the human brain which may help in devising treatment options for patients afflicted with those disorders. Not only has CCA been used for fusing two modalities of the same nature (image-to-image) but for three or

32

Figure 2.11: CCA Data Organization; association of components, sources, and subject covariation are highlited in red more modalities as well [66]. Similar to jICA, the application of CCA on functional and structural cardiac data is the first of its kind.

2.4.3

Dimension Reduction

Since the fusion of images from multiple subjects is the main focus of this thesis, it is a requirement to perform a dimension reduction step in order to simplify and lighten the computational requirements of these algorithm. It is needed, however, that the reduced data set can still uniquely represent and be reconstructed to the original image data sets. A simple variance-based technique, called Principal Component Analysis (PCA), has been used in [74] before performing data fusion. Unlike other dimension reduction techniques, PCA can provide an approximation or a projection of the linear relationship between multiple sets of variables in such a way that much of their shared information is preserved. In general, PCA is used to reduce the dimensionality of a given data set using vectors known as principal components (PComps) [74]. These PComps are uncorrelated and orthogonal from each other. To perform PCA [74] on a given data set X, with N rows and M columns (N × M ), the

33

covariance matrix ()of the data set is calculated by i,j = cov (Xi , Xj ) i,j = E[(Xi - µi )(Xj - µj )] for i, j = 1, 2, ..., N where µi = E (Xi ). The equation above can be generalized through the following equation  = E[(X - E[X])(X - E[X])T ] (2.36) (2.35)

 will have the size of an N × N matrix. PComps are then extracted from  by calculating its eigenvalues () and eigenvectors (v) ( - I)v = 0 v - Iv = 0 v = Iv (2.37)

where I is an identity matrix; v has the size M × M and I has the size N × M . The matrix v containing all the eigenvectors are treated as the PCs. The eigenvalues are usually arranged in a descending order which is indicative of the amount of variance that is reserved to an associated eigenvector. Usually, it is the first eigenvector (v1 ) that is used to project the original data on to for data reduction as this vector maintains the highest variance of the original data set. Projection is as follows
T Y = v1 X

(2.38)

Y yields a 1 × M vector that is representative of the original data set X. With an increased size of data sets, the computation of the covariance matrices from which PCs are derived can be computationally expensive as well as time consuming. Therefore, an alternative means to calculate such PCs must be used; Singular Value Decomposition (SVD) offers such a utility. SVD is used to decompose a given data set to three components such that X = USVT (2.39)

where U is a N × L matrix of left singular vectors, V is a M × L matrix of right singular vectors, and S is a L × L diagonal matrix of singular values. The details of SVD derivation and the proof 34

of the relationship between SVD and PCA is discussed elsewhere [72]. With dimension reduction, it is usually the vectors of the right singular matrix that are treated to be the eigenvectors of the original data. The following are important steps to be followed before an SVD is performed on the original data set in order to obtain comparable results with PCA: F = X - E [ X] F M -1 G = USVT G= 
T

(2.40) (2.41)

The first column, v1 , of the V matrix can then be used as the first eigenvector to reduce the dimension of X from N × M to 1 × M as in Equation (2.38).

2.5

Summary

In this chapter, the necessary theoretical/mathematical background for the techniques which are used in this thesis were discussed in brief. A basic understanding of MRI is crucial in order to understand the extending MR techniques (CDI and DTI), from which data are collected. CDI and DTI serve as calculated features from the original MR images and undergo different preprocessing stages that affect general appearance of objects in images. With this, feature-based data fusion techniques are more applicable than pixel-based methods. jICA is a feature-based data fusion techniques that have been primarily used in neurological studies and are yet to be used on cardiac data. jICA not only takes into account the joint analysis between two given data sets, it also expands its analysis with relationships within data sets (i.e. inter-subject and inter-modality information). Another feature-based data fusion method, CCA, a multivariate statistical method which has also been used in neurological studies by utilizing it as a data fusion tool. CCA finds a pair of maximally correlated matrices upon which two given feature data sets are projected. The resulting component matrices are then associated to each other through their projection matrices only if the matrices themselves satisfy the constraints and assumptions in performing CCA. Because of the sheer number of subjects as well as of data sets in which subject information are contained, dimen35

sion reduction is an important step to relieve otherwise computationally heavy calculations. Using a number of PCs from PCA, the dimensions of the original data sets can be reduced. However, even with the amount of information reduced per subject, the number of subjects can still prove problematic in calculating the covariance matrix, ; SVD can be used as an alternative to PCA for this reason.

36

Chapter 3 Feature-Based Data Fusion - Joint Independent Component Analysis

D

ATA acquisition is an important part of this thesis. Although there are some databases for DTI images of mammalian hearts, because of the novelty of this study, there are currently

no known databases for CDI images of such subjects especially for cardiac arrhythmia studies. Each data set that were diligently collected for this study is a rare and valuable resource as there is no a priori knowledge of electrical current distributions in the heart during normal sinus, cardiac arrhythmia, or even in asystole. Hence, it is quite challenging to produce synthetic current distributions in different cardiac conditions simulating a CDI image without any real data to base upon. In addition, to the best of the author's knowledge, this is the first attempt to fuse structural (DTI) and functional (CDI) components of a mammalian heart in order to identify key features that are unique to a cardiac condition (i.e. NM, VF, or AS). Although there is an expected change in the functional components between two cardiac states, the assumption that the structural component is static is made in this study because of experimental limitations. In this Chapter, the instruments and procedures that were used to collect image data sets will be briefly discussed: the design of a mobile Langendorff system, imaging phantom design, MRI electronics, and MRI imaging parameters; a sample calculation of a CDI image will be shown as well as the acquisition of a DTI image. Finally, the methodology for jICA data fusion, results, and analysis will be presented, respectively.

37

3.1
3.1.1

Porcine Heart Experiments - Data Acquisition
Experimental Protocol

Overall, ten live porcine heart experiments were performed over the course of a year. Months of preparation, extensive instrument testing, and multiple numbers of experimental dry-runs have been done before to ensure that for each live porcine heart experiment, viable sets of data can be obtained. A team of engineers, including the author, scientists, and doctors were involved in a collaboration between Ryerson University and Toronto General Hospital (TGH) to perform this study. All data that were used in this thesis were collected from porcine hearts. Under an approved Animal Use Protocol (AUP) drawn at Toronto General Hospital (TGH), the beating hearts were harvested from healthy porcine subjects while under deep anesthesia. All of the animal operations were performed at the Animal Resource Centre (ARC) at TGH. The goal for each experiment was to collect at least a pair of cardiac states. However it has not always been possible to get pairs of cardiac states. Some experiments only yielded states of VF, while others only with AS, and others only with NM. Each cardiac state was treated as one subject. There was a total of twelve subjects obtained from all of the experiments performed, as shown in Table 3.1. Requiring extensive preparation, coordination, and collaboration of numerous departments in both TGH and Ryerson University, each experiment lasted 2.5 to 4 hours depending on the heart's condition at the time. A timeline of the experimental protocol followed in each of the experiments peformed is shown in Figure 3.1. VF 4 3 3 AS 4 3 3 NM 4 3 3

No. of Subjects No. of CDI Slices used per Subject No. of DTI Slices used per Subject

Table 3.1: Summary of Number of Subjects per Cardiac State

38

39 Figure 3.1: Experimental Protocol - Timeline

Figure 3.2: Mobile Langendorff System; R: Tyrode Reservoir; Pu: Aquatic Pump; BT1: Bubble Trap 1; BT2: Bubble Trap 2; H: Heart; Ph: Phantom

3.1.2

Experimental Setup

Mobile Langendorff System A Langendorff system, introduced by Oskar Langendorff in 1897, is a perfusion system designed to keep an explanted heart alive after it is harvested from a subject. Because of the proximity of the wet lab to the MRI wing of TGH, a mobile version of the system had to be designed by the author's team. The mobile Langendorff system used in the experiments is shown in Figure 3.2. The perfusate used is a solution called Tyrode that has all the essential chemicals that enable an explanted heart to beat for an extended amount of time. The Tyrode solution [14] is infused with 40

carbogen (95% O2 , 5% CO2 ) in order to satisfy the gas exchange requirements of the myocardial cells. The temperature of the perfusate was monitored and was kept at an average of 37  C. The temperature was regulated through an external heater as well with an aquarium heater as an additional heat source in cases when time constraints were strict. Temperature regulation was done in the reservoir of Tyrode solution and was pumped to a bubble trap. A bubble trap prevents the passage of bubbles towards the porcine heart which is detrimental. As part of the Langendorff system, a smaller bubble trap was installed inside the MRI phantom (discussed in the next subsection), preventing bubbles that are introduced in between the first bubble trap and the heart, creating a bubble-proof mobile Langendorff system. In the case of perfusate build-up in the MRI phantom, a hand pump was attached to the draining tubes to force drainage of the perfusate when gravity is not enough. During transport, an uninterruptible power supply (UPS) was used to power the pump and heating instruments to keep the heart beating. The perfusate was allowed to be circulated through the system in order to maintain an average pressure (65 mmHg/1.2 PSI), an average flow of (350 mL/min), and temperature (37  ) before canulating the heart to the system. Usually, experiments were performed on aortically canulated hearts (perfusion tubes are required to be connected to the aorta of the heart for an aortic canulation). It takes approximately 30 to 45 minutes to set-up and circulate the perfusate until the temperature and flow have stabilized, all bubbles have been eliminated, and when the heart is safe, it takes another 15 to 20 minutes to carefully transport the heart from the wet lab to the MRI scanner at TGH. The Porcine Heart and Electrode Placement Figure 3.3 shows the orientation and the placement of electrodes on a porcine heart. A canulated porcine heart has three (3) pairs of electrodes attached to it throughout an experiment. One pair of electrodes is for current injection (CI) for CDI. One of the CIs is pierced through the base and one is pierced through the apex of the ventricles; one pair of electrodes are used for stimulation (Stim) in cases where there is a needed change for a cardiac state. A 9-V battery can be attached to these electrodes to induce VF; finally, ECG electrodes are attached on a velcro strap and are strapped

41

Figure 3.3: Porcine Heart and Electrode Placement; C: current injection electrode; E/D: ECG and defibrillation electrode; S: stimulation electrode on the heart during an experiment. The ECG electrodes have sufficient surface area to also act as defibrillating pads in case a change in cardiac state is needed. All of the electrodes were tested accordingly and were ensured to be non-magnetic and minimally affect image quality: both CI and Stim electrodes were shaped out of copper hooks and the ECG/defibrillating pads were shaped from silver plates. CDI Electronics The electrical current waveforms that were used to inject PC1 and PC2 in to a porcine heart were generated using an microcontroller (32-bit Arduino Uno). The board was programmed in a way that it can receive an external trigger from the MRI system, which then signals the board to produce either PC1 or PC2 in voltage waveform, depending on the current protocol being executed. Since the Arduino Uno can only produce a maximum of 5V, an external amplifier is needed to produce the right amount of voltage for the desired amount electrical current. The output of the amplifier is then connected to the current electrode at the base (C, from Figure 3.3) and the ground of the amplifier to a 10  resistor, which is in turn connected to the current electrode at the apex of the

42

Figure 3.4: CDI Electronics; T: Trigger; V1 : microcontroller voltage output; V2 : amplifier voltage output; G: ground ventricles. Depending on the measured resistance of the heart, the voltage output from the amplifier was adjusted to maintain a constant electrical current amplitude passing through the heart, which is monitored at the 10  through an oscilloscope. A block diagram of the electronic elements used in each experiment is shown in Figure 3.4. MRI Phantom Design MRI phantoms are materials that are usually built to mimic biological structures or to calibrate MRI systems before imaging. In some cases MRI phantoms can also serve some functional or structural support depending on the experiments being conducted. In the case of the experiments performed, an inert MRI phantom (undetectable under an MRI) was constructed with acrylic plastic in order to protect the MRI system, contain a porcine heart, and circulate the perfusate through the Langendorff system. The MRI phantom (shown in Figure 3.5) enable the experimenters to satisfy the physical rotations that are needed for CDI imaging as previously shown in Figure 2.6. The phantom was built with access points on its cover for CDI, stimulation, and ECG electrodes that are attached to the heart during an experiment. Furthermore, the cover and the edges of the phantom were lined with silicon in order to prevent any perfusate leakages that might damage the MRI system

43

Figure 3.5: MRI Phantom used for Porcine Heart Experiments Inside the phantom is a small transparent box that is roughly the size of an average porcine heart. This phantom is lined with bubble wrap in order to fit a porcine heart in and prevent any movements that may cause slice relocalization. Furthermore, this smaller phantom is placed on a pedestal to avoid imaging any water build up at the bottom of the phantom and focus only on the heart. Draining holes that were attached to long plastic tubes were located at the bottom of the phantom to recirculate extra perfusate from the heart back to the reservoir. This is to avoid any waste in the Tyrode solution as only a set amount is prepared for every experiment.

3.1.3

MRI Imaging Parameters

The following subsections outline the MRI imaging parameters that were used to collect CDI and DTI data sets from a 1.5T GE Signa MRI system. For each experiment, constrained by the CDI and DTI sequence parameters, we acquired six (6) image slices for CDI and twenty one (21) image slices DTI encompassing the volume covered by the six CDI slices. CDI Imaging Parameters · Number of Excitations (NEX): 2 to 3 44

· Repetition Time (TR): 700 ms · Echo Time (TE): 40 ms · Slice Thickness: 7 mm · Slice Spacing: 0 mm · FOV: 15 cm · No. of Orientations: 2 (Bx and By ) · Average Current Injection Amplitude: 25 mA DTI Imaging Parameters · Number of Excitations (NEX): 6 · Repetition Time (TR): 8300 ms · Slice Thickness: 7 mm · Slice Spacing: 0 mm · FOV: 15 cm · b-value: 1000 mm2 /s

3.2

Experimental Procedure

Elaborating on Figure 3.1, the experimental procedure for porcine heart goes as follows: After the heart is harvested from a porcine subject, it is delivered to a wet lab 10 to 15 minutes away from the operating room. After the heart arrives, the heart is prepared cutting out excess tissues (i.e. lung or fat tissue) that may still be attached to the organ. After cleaning the heart out, depending on the availability of access points, the heart is either perfused by the Langendorff system through its aorta (aortic canulation) or through its coronaries (coronary canulation). In most cases, however, aortic 45

canulation has been the preferred method. After the pressure, flow, and temperature of the Tyrode solution are set, the heart is then pumped with the solution and was allowed to beat for some time. The electrodes shown in Figure 3.3 were then set up and were connected to their corresponding electronic devices. The ECG of the heart was constantly monitored. After the heart is deemed fit for imaging, the heart is then placed inside the MRI phantom, ensuring that it is snug fit inside the smaller phantom box in order to prevent any movement. The heart is then brought to the MRI scanner. At the MRI room, the Langendorff parts are placed sufficiently far away from the machine so as to minimally affect both the quality of the images that will be collected and the working machines of the Langendorff system itself. Movements of the heart were of concern since it will create image artifacts however because of the nature of VF, extremely rapid contractions of the myocardium were undetectable; a heart under the state of AS is passive hence no movements were observed in this state; finally during NM, due to the design of the set up which restricted the heart's movement and the heart's weak contractions, we did not observe significant motion artifacts. The bed and the surroundings of the MRI bore are protected by a water proof sheet below a plastic tray where the phantom is placed. This is to protect the MRI from any accidental leakage of the perfusate from the phantom. Depending on the state of the heart, CDI protocol is then executed for this first cardiac state, implementing the imaging processes as described in [54]. After the first set of CDI images for the first cardiac state is collected, the state of the heart is checked: if the heart is in the state of VF, it is paced and defibrillated a few times with defibrillating pads with energies ranging from 30 J to 70 J; if the heart is in the state of NM, it is shocked or paced for some time in an attempt to disrupt its normal conduction and push it in to a VF state. However, if the ECG of the heart has been displaying weaker and weaker activity that it is no longer feasible to work with, it is left to go in to an AS state. After at least two cardiac states were collected for the CDI protocol, the electrodes attached to the heart were removed and the DTI protocol is executed, gathering DWI images for 30 directions.

46

Figure 3.6: Histogram of a magnitude image

3.3

Calculation of Current Density Images

It is important to note that this thesis will only focus on the fusion of two-dimensional images. In the case of CDI, the Jz component is of interest as the current experimental set-up can only collect the image components associated to the Jz component of CDI. To solve for Jz , the magnetic flux components, Bx and By , are needed to be calculated. Following, Equation (2.5), the magnitude (M) and phase (P) components of the MRI DICOM images must be extracted for each component. Please refer to Chapter 2, section 2.2 for the details on calculating Jz . In order to separate the object from the background in an image, masks (Mmask ) are created for the two flux components. The masks are created in a such a way that a threshold is selected from the image histogram of the M component of a DICOM image. Usually, the image histograms are composed of two curves, one for the background (non-object part of the image) and one for the object (slice of the myocardium) as shown in Figure 3.5. The pixel value on which these two curves intersect is selected as the threshold background 47

(Tintersect ). Masking is then performed by Mmask (i, j ) = 1, if M (i, j )  Tintersect 0, otherwise (3.1)

It is important to note that in order for By to match Bx , By and its corresponding mask must be rotated 90  clockwise. Translations up or down or left to right are performed as needed. After the image for Jz is calculated, the combination of Mmasks created for the two flux components is eroded and is applied to the resulting Jz image. This is to eliminate unrealistic electrical current values around the edges of the object in the image so as to compute a relatively accurate value of the overall current passing through a slice. A 5 × 5 median filter was applied on each of the Jz slices to reduce any impulsive noise in the object but preserve its edges. The summary of the steps involved in this process is shown in Figure 3.7 while the resulting Jz for each slice for each subject is shown in Figure 3.8. Note that for display, the pixels are scaled so that it is converted to z-values. Any pixel that is greater or lower than the mean of the image in addition to its variance is thresholded to a maximum value. All of the CDI images used in this thesis are shown in Figure 3.8.

3.4

Calculation of Diffusion Tensor Images

DTI images were calculated by using collected DICOM images containing DWI images from MRI experiments. Calculations were performed through an MR program, 3D Slicer [75]. Shown in Figure 3.9 is the result of tensor calculations by 3D Slicer. The DTI images shown in Figure 3.9 is the RGB depiction of the components of the primary eigenvectors of the diffusion tensor describing molecular diffusion per pixel. As stated before, the red channel contains the mediallateral component, green channel contains the anterior-posterior component, and blue contains the superior-inferior component of the primary eigenvector. Since the author is only concerned of the Jz component of the CDI images, only the blue channel of the DTI images shall be used in this thesis to pair with the CDI images. Figure 3.10 shows all of blue channel components extracted from all of the subjects' DTI images. Note that for display, the pixels are scaled so that it is converted to z-values. Any pixel 48

Figure 3.7: CDI image calculation process 49

Figure 3.8: Jz component for each slice for each subject: From the top, the first four image sets are from the state of VF; the second four image sets are from the state of AS; the last four image sets are from the state of NM 50

Figure 3.9: DTI Images showing the approximate fibre orientation with views of the A) Sagittal, B) Coronal, and C) Transverse planes derived from 21 slices that is greater or lower than the mean of the image in addition to its variance is thresholded to a maximum/minimum value.

3.5
3.5.1

CDI and DTI Registration and Batch Matching
CDI and DTI Batch Matching

Every time the heart is moved or scanning is stopped, the MR technician has to re-evaluate and replan the selection of slices on the subject. However, the new slice selection plan does not guarantee to scan the originally selected slices after moving a subject in the MRI machine. This may result to not having the exact same slices from CDI and DTI to fuse although these slices were taken from comparable areas with the same slice spacing. Therefore, a slice matching method must be implemented in order to determine which consecutive sets of DTI images closely match. The original masks to be matched are shown in Figure 3.11 and the batch matching scheme is shown in Figure 3.12. The ratio of the areas of Mmask and the Otsu masks Motsu [76], generated from 3D slicer for DTI image calculation, were compared in order to account for scaling. ri = Amask,i for i = 1, 2, ..., N, j = 1, 2, ..., M - N Aotsu,j :j +N (3.2)

Where N is the maximum number of slices for DTI and M is the maximum number of slices for CDI.

51

Figure 3.10: Original blue channel images used for fusion: From the top, the first four image sets are from the state of VF; the second four image sets are from the state of AS; the last four image sets are from the state of NM 52

Figure 3.11: CDI to DTI Batch Matching Scheme: to match CDI and DTI slices, mask areas from the two modalities were compared by mask area-ratio variance

Figure 3.12: Original DTI and CDI masks to be matched; AR: area ratio

53

Figure 3.13: Optimization curve: the DTI batch that has the lowest area variance is matched to the CDI batch. In the case of Jan 27 VF, the 13th shift offers the lowest area variance therefore DTI slices 13 to 18 are matched with CDI slices 1 to 6 Since there were 21 slices for DTI data set and only 6 slices for CDI, the first 6 slices of DTI images were compared to the 6 slices of CDI images. With 6 area ratios, the variance of such ratios for the first batch of DTI images were calculated. The subsequent variance ratio calculations goes the same way however the second batch will consist of 2nd to 7th slices, the third batch will consist of 3rd to 8th slices, and so on. The DTI batch that has the lowest variance in area ratio was determined to be the batch that best matches the CDI images. Figure 3.13 shows a batch matching graph on one of the data sets used in this study and the associated slices that were matched to each other are shown in Figure 3.14. Although the masks of the CDI and DTI that were matched have some differences between them, the results of area variance optimization has been verified to be the same with the MRI

54

Figure 3.14: Example of matched and registered CDI and DTI images technician's selected slices. Hence, the matched DTI images were deemed to be from the same section of the heart as with the matched CDI images.

3.5.2

CDI and DTI Registration

In an experiment, the CDI images are first collected then DTI images. During the acquisition of CDI images, obtaining data sets requires the movement of the porcine heart in MRI machine. In addition, scanning needs to be stopped and movement of the porcine heart is once again required if a batch of DTI images is to be acquired. There are spatial differences that are incurred at this point hence a CDI to DTI image registration is needed. The CDI to DTI registration was performed between Mmask and Motsu . A simple two-dimensional cross-correlation method [77] was performed on the masks of each matched slices in order to calculate the coordinates from which both masks have maximum cross-correlation (xpeak , ypeak ) = max abs(2Dcrosscorr (Motsu , Mmask )) (3.3)

The values of xpeak and ypeak were converted in to image coordinates, which then identifies the x and y translations needed to register CDI images to DTI images. All of the CDI and DTI images are accordingly matched as well as registered to each other.

55

3.6

Joint Independent Component Analysis

The highlighted branches of the flowchart shown in Figure 3.15 were implemented for this section of the thesis.

3.6.1

Data Pre-processing

Before jICA can be applied to image data sets, CDI and DTI images must be normalized in order to keep the contributions of each modality similar. The normalization process for CDI and DTI were performed as follows ICDI = IDT I Jz max(abs(Jz )) Bluechannel = max(abs(Bluechannel )) (3.4) (3.5)

CDI and DTI images were to scaled the values of all pixels relative to the maximum pixel value within the object in the image. This is so that all of pixel values will then be scaled relative to a maximum value of 1. Additionally, because of the RGB nature of DTI images, IDT I only consists of positive pixel values. To even out the contributions of ICDI and IDT I , some of the pixels of IDT I were inverted in such a way that its mean is zero so as to prevent large contributions from pixels with no diffusion [63].

3.6.2

Dimension Reduction

Each subject consists of 6 ICDI and IDT I each a size of N × M however, because of the placement of the electrodes on the base and apex of the heart, the top and bottom slices are usually unreliable. Hence, in this study, the author only took into account the third to fifth slices. Each of these images are vectorized and are concatenated side by side, creating a 3 × 2N M data matrix P. A representative row P must be generated for each subject in such a way that the input matrix to jICA will have a size of 12 × 2N M . This was accomplished through SVD [78] using a column vector (E) from the right singular value matrix to the project the data on to. A summary of these

56

Figure 3.15: Implemented branches of the study for the following sections of jICA 57

Figure 3.16: Process of A)Dimension Reduction, B)jICA feature matrix preparation, and C)Slice reconstruction for performing jICA according to [5] 58

steps are illustrated on Figure 3.16A. To express this step mathematically, P i = ET i Pi for i = 1, 2, ..., 12 (3.6)

The Pi for each subjects were stacked on top each other forming a feature data matrix, X, with a size of 12 × 2N M . Figure 3.16A summarizes this dimension reduction scheme for jICA. Figure 3.16B shows the organization of the feature matrix, X, for the jICA algorithm

3.6.3

Information Maximization for jICA

Equation (2.24) demands that a probability function for feature data matrices must be known in order to estimate the demixing matrix, W. Unfortunately, such functions are not available especially for the feature data matrix. Following [63], an Information-Maximization (IM) algorithm was used to estimate W. It is important to note that it has been mathematically proven in [79] that the same results can be achieved through IM compared to equation (2.24). Developed by [80], the IM algorithm maximizes the mutual information (MI) between the estimated component matrix, (Y), and the feature data matrix, (X), while minimizing the mutual information between the components (Qi ) within a component data matrix Y achieving independence from each other. The IM algorithm learns the optimal weights through a neural network by the equation W = WT
-1

+  (1 - 2U) XT

(3.7)

where  is the learning rate. U is calculated through a sigmoid function U = g (Y ) = 1 1 + e-Y (3.8)

where Y = WX. It is important to note that X is utilized portion by portion (pre-determined size) to the very end of the matrix. The algorithm passes through the data matrix X coming up with a set of weights contained within W. IM algorithm can be repeated or passed through the data matrix multiple times until there is minimal change observed on the demixing matrix W. A verification of the functionality of the algorithm used in this portion is shown on appendix A section 1. In the case of our cardiac imaging data, W was used to extract the underlying sources from the original concatenated image features, in relation to other subjects. 59

3.6.4

Image Reconstruction

Subject partitioning were performed as follows: with the estimation of the components, Qi , within the component data matrix Y, the previous 3 images for both CDI and DTI images for a subject can be reconstructed from the Qi components using the same eigenvector Ei that was used to reduce the original concatenated, vectorized images. By implementing an inverse PCA, Qi = Ei Qi for i = 1, 2, ..., 12 (3.9)

3 corresponding CDI (JCDI ) and DTI(JDT I ) can be recovered for each subject included on which different types of analysis can be performed. Figure 3.16C shows a depiction of data disorganization, from the component data matrix towards the reconstruction of associated image modalities pertaining to a subject.

3.7
3.7.1

Review of Results - jICA
jICA Loadings

Through existing studies where the jICA technique was applied [5,63,65], the primary analysis for group inference was made on the jICA loadings with which each component Qi from the feature data matrix Y are assigned to. The loadings were calculated from the weights of the inverse of W, A; two-sample t-tests were performed on each component to find which component is significantly different from the others for group inference: it was found that the third component was starkly different from the others for separating VF from non-VF (p = 0.02). With this component, a two-stage binary classification scheme was subsequently performed to, first, identify VF subjects from non-VF subjects (Figure 3.17A) and, second, segregate NM and AS subjects from each other (Figure 3.17B). Although NM and AS are not statistically different from each other as indicated by their p-value (p = 0.13), a qualitative separation can be observed between the two groups. This may be attributed to the limited amount of subjects involved in the comparison. Even so, jICA proves to be a valuable tool in producing a discriminative feature for the binary classification of cardiac states.

60

Figure 3.17: jICA loadings: A) VF vs. non-VF loadings, B) NM vs. AS loadings; and comparison of average joint histograms of all reconstructed components: D) VF vs. non-VF, E) NM vs. AS

61

Figure 3.18: ICA weights of separate imaging data sets, CDI (top) and DTI (bottom) for pairwise comparison In addition, and as shown in Figure 3.18, ICA was performed on CDI data sets and DTI data sets separately. This is to show that without fusing imaging data sets, the cardiac states NM, AS, and VF would not be as distinguishable from one another based on their ICA loadings which is evident by the overlapping ICA loadings without fusion. This suggests that there is a uniqueness in the variations between CDI and DTI components within a cardiac state. Using the jICA loadings as a feature, we performed an Linear-Discriminant-Analysis(LDA) classification for VF and non-VF subjects [81] then validating its results by leave-one-out(LOO) method. In the LOO method [82], the classifier is trained with all the samples except one, and

62

Method CV %

Groups VF Non-VF VF Non-VF

VF 3 1 75 12.5

Non-VF 1 7 25 87.5

Total 4 8 100 100

Table 3.2: Cross validation using linear discriminate analysis with LOO method for JICA the left out sample is used as a testing set. This process is repeated for all samples. The LOObased validation is highly suitable for a small database such as the one presented here. Table 3.2 shows the results of such classification, achieving an overall 83.3% accuracy in separating VF from non-VF subjects.

3.7.2

Joint Histograms

An example of the reconstructed images from VF vs. non-VF (AS and NM in this case) comparison is shown in the Figure 3.19. By quick inspection of the fused and reconstructed DTI component, one can say that there are stark differences that can be observed between a heart in VF versus a heart in AS in this particular example. However, as observed from the quality of the reconstructed images, it is challenging to make any inferences about the spatial contributions and the physiological significance of DTI and CDI components by direct observation. An alternative way of looking at the variations of CDI and DTI components between cardiac states is through averaged joint histograms (i.e. p(Jcdi , Jdti ); as shown in Figure 3.17C-D). The joint histograms were calculated by obtaining the marginal estimated distributions for both a CDI (p(Jcdi )) and a DTI (p(Jdti )) image for 50 pixel values such that p(Jcdi ) = p(Jdti ) = p(Jcdi , Jdti ) p(Jcdi , Jdti ) (3.10) (3.11)

Note that only the object within the image was considered during the calculation of p(Jcdi ) and p(Jdti ). The joint histogram was then calculated as follows: p(Jcdi , Jdti ) = p(Jcdi )T p(Jdti ) 63 (3.12)

Figure 3.19: Reconstructed CDI and DTI images from jICA; the pixel values in this display are converted to z -values and are thresholded at |z | = 3

64

The joint histograms of all subjects for each cardiac states were then averaged to come up with a representative joint histogram for each cardiac states. For VF vs. non-VF, it is shown by the spread of the pixel bins that participation of CDI and DTI under the VF state is significantly larger compared to that of non-VF state in both respects. This shows that there are more associated pixels or regions from CDI and DTI images during VF compared to a normal or asystolic heart. As cited before, VF is a result of numerous ectopic pacemaker cells that fire independently. With the involvement of such pacemaker cells, a great number of regions in the heart are subsequently activated modifying electrical current pathways. Differences can also be seen in the case of NM vs. AS. Although it seems that subjects under the AS state have a wider spread of pixel values along the DTI axis compared to their NM counterparts, they are of lesser pixel intensities and are not as concentrated as that of NM. It was expected that the average joint histogram for NM will have a greater CDI-DTI variation that of AS since AS is already considered as an unresponsive state. The variations between CDI and DTI as seen through their pixel value distribution has also been helpful in distinguishing cardiac states from one another. Without the use of jICA, however, one of the imaging data sets can overpower the other yielding a distribution that is unrepresentative and unidentifiable from other cardiac states. An example of averaged joint histograms from the AS and VF comparison before (A) and after (B) the application of jICA is shown in Figure 3.20. Although there already is an observable difference between the averaged joint histograms of VF and non-VF before fusion, the involvement of DTI in both cardiac states could be misleading since it has a much greater range of pixel values involved. Comparing these to the joint histograms after fusion, the effect of jICA can be clearly seen: the contributions of the both imaging modalities are equalized, providing a sufficient range of pixel values for CDI and DTI for a cardiac state to be well represented.

3.7.3

Data Fusion Metrics

Features were calculated in order to further analyze the results of jICA and the advantages of performing data fusion on complementary imaging data sets. Included in the auxiliary results are

65

Figure 3.20: Comparison of Joint Histograms Before(top) and After(bottom) jICA

66

the comparison of skewness of distribution and mutual information (MI) between CDI and DTI before and after fusion. Skewness Before and after jICA was used to fuse CDI and DTI, the average skewness of the histograms of the CDI and DTI images for each subject included were calculated; skewness was used to indirectly quantify if there was a change in the histogram distribution before and after fusion. The skewness of the histograms of CDI (Ncdi ) and DTI (Ndti ) images were calculated as [83]

Ncdi = Ndti =

E(p(Jcdi ) - µp(Jcdi ) )3 3 p (Jcdi E(p(Jdti ) - µp(Jdti ) )3 3 p (Jdti )

(3.13) (3.14)

The calculated skews of CDI and DTI histograms were then plotted to against each other. The reader is reminded that high skew values correspond to distributions that are spread towards to the right of the mean of the distribution and that low skew values correspond to distributions that are spread closer towards the mean. Since most of distributions are arranged from a descending fashion, from the low pixel value bin to the high pixel value bin, high skew values portray a wider spread of pixels towards high pixel values while low skew values portray a concentrated spread of pixels towards the low pixel values. Figure 3.21 shows that there is a change in the pixel distribution between CDI and DTI images before and after fusion between VF and non-VF subjects as depicted in Figure 3.20 which coincides with the analysis made on their corresponding joint histograms. Mutual Information Finally, average MIs of the histograms between the CDI and DTI images per subject within a pairwise comparison were also calculated before and after jICA. The goal of this process is to place a quantitative measure on how well the data sets are fused together, primarily pertaining to how much information they share through the process of data fusion [84]. MI was calculated using 67

Figure 3.21: An example of the distribution of averaged skewness of joint histograms of the CDI and DTI components from VF and non-VF comparison before (left column) and after (right column) jICA fusion

68

the following equation M I = Hcdi + Hdti - H(cdi,dti) (3.15)

Where Hcdi , Hdti , and H(cdi,dti) are the CDI entropy, DTI entropy, and CDI-DTI joint entropy, respectively. These terms are expressed as Hcdi = - Hdti = - H(cdi,dti) = - p(Jcdi ) log10 p(Jcdi ) p(Jdti ) log10 p(Jdti ) p(Jcdi , Jdti ) log10 p(Jcdi , Jdti ) (3.16) (3.17) (3.18)

As an example, shown in the left column of Figure 3.22 is the distribution of the average MI per subject before and after fusion from a binary classification of VF and non-VF. Before fusion, CDI and DTI started with a relatively low MI at approximately 0.5 bits regardless of which cardiac state pairs are being compared. From this it can be initially inferred that both static and dynamic characteristics of cardiac states already have evidence of some relationship between them. However, after fusion, a significant increase was observed in the MI between CDI and DTI across the cardiac state pairs: jICA boosts the initially observed relationship between CDI and DTI significantly, creating a common platform for the two distinct modalities. Hence, this measure can be used to show the melding of structural and physiological aspects of cardiac states.

3.8

Summary

In this chapter, the technical aspects of data acquisition, processing, and fusion have been outlined. In order to collect a single set of data from a porcine experiment, a tremendous amount of technical preparation and coordination has to be done. A single experiment alone could take hours of planning and execution. Once data sets have been collected, image processing techniques have been implemented in order to collect the desired features of the data sets. In order to perform data fusion through jICA, a normalization process must be followed in order to ensure that the contributions of each modality is similar with each other. Because of the sheer size of the data sets that need to be fused, a dimension reduction step is imperative in order to simplify computational requirements,

69

Figure 3.22: An example of the distribution of averaged mutual information of joint histograms of the CDI and DTI components from VF and non-VF state comparison before (left column) and after (right column) jICA fusion at which point only then jICA can be implemented. It is important to note that each row of a feature data matrix input to the jICA represents information about a single subject. After estimating a demixing matrix through the IM algorithm, the feature data matrix input is processed to yield a component data matrix which contains independent components. Such components pertain to fused data sets for the subjects. Images from modalities that were associated to these subjects can be reconstructed using the same parameters used to reduce the dimensions of the original data set. By using the jICA loadings of the estimated components, it is possible to distinguish the cardiac states from each other. Although jICA constrains the contributions between imaging modalities within a cardiac state to be the similar, the variations of CDI and DTI between cardiac states is clearly observable through the spread of pixels in their joint histograms. Joint histograms are currently more readily analyzed than the reconstructed images as it is challenging to spatially identify which parts of the reconstructed CDI and DTI are associated to each other (even though there are some associations and differences that can be qualitatively pointed out). In addition, MI

70

can be used as a metric to evaluate the performance of jICA, as shown in previous figures; MI provides a means to quantify how well and how much the two data sets were fused together.

71

Chapter 4 Feature-Based Data Fusion - Canonical Correlation Analysis

B

ASED on our earlier attempts to fuse CDI and DTI data sets from previous experiments conducted on asystolic porcine hearts, it was found that there is some correlation between

the components of CDI and DTI [57]. Further analysis of recent data sets (which were also used in this thesis) yielded results with significantly higher correlations as seen in Figure 4.1. Figure 4.1 provides information on the relationship of fiber directions in DTI and electrical current pathways in CDI for a subject. This implies that in an asystolic heart, the electrical current pathways follow the fiber orientations within a myocardium. Since this relationship has been brought to light, there must be corresponding correlation values between CDI and DTI components depending on which cardiac state a subject is under. Preliminary results suggests that in the case of cardiac studies, correlation can prove to be an intuitive way through which data fusion is performed while keeping in mind the main goal of the graduate thesis: quantifying variations between the imaging modalities at hand and identifying key features that can distinguish cardiac states from one another to validate the combined use of CDI and DTI. In this Chapter, the methodologies used to apply CCA as a feature-based data fusion method will be discussed; using the same CDI and DTI imaging data sets collected from experiments, matched, and registered, as described in Chapter 3, the steps for data pre-processing, dimension reduction, and image reconstruction for CCA will be outlined. Finally, an analysis of the results and a comparison between CCA and data fusion metrics used will be presented.

72

Figure 4.1: Preliminary examinations of Correlations of the different components of CDI (Jx , Jy , and Jz ) and DTI (R,G, and B)

4.1

Canonical Correlation Analysis

The highlighted branches of the flowchart shown in Figure 4.2 were implemented for this section of the thesis.

4.1.1

Data Pre-processing

CCA does not require any normalizations on the original data sets since correlation is independent of scaling. This allows the image data sets to retain their own uniqueness. Therefore, in the case of CCA, the notation that will be used for Jz will be Scdi and for Bluechannel will be Sdti .

4.1.2

Dimension Reduction

As with jICA, each subject consists of 6 SCDI and SDT I each a size of N × M . Only the third to fifth image slices were used as explained in Chapter 3 as well as to be consistent with the jICA analysis. Each of these images are vectorized creating two 3 × N M data matrices, V1 and V2 . PCA by SVD was applied to these matrices, using principal components that are unique to their corresponding matrices, in order to obtain a feature vector per modality, V1 and V2 , for each 73

Figure 4.2: Implemented branches of the study for the following sections of CCA 74

Figure 4.3: Process of A)Dimension reduction per subject and feature matrix generation, B)Dimension reduction of feature matrix and CCA performance, C)Feature matrix projection and D) Image reconstruction per subject [6]

75

subject, expressed as V1 = E T 1,i V1,i for i = 1, 2, ..., 12 V2 = E T 2,i V2,i for i = 1, 2, ..., 12 (4.1) (4.2)

This was done for each subject included until two feature matrices, X1 and X2 , of size 12 × N M were obtained. These steps are summarized in Figure 4.3A.

4.1.3

Canonical Correlation Analysis

In this section, the process in which Equations 2.28 and 2.29 are calculated will be elaborated. The size of the two feature matrices are extremely large for calculating the auto-covariance and cross-covariance matrices required for Langrange multipliers. Further dimension reduction was performed on X1 and X2 through SVD [85], using the left singular value matrix, as follows SVD(XT i ) = Ui Si Vi for i = 1, 2 Yi = Xi Ui for i = 1, 2 (4.3) (4.4)

Yi has a dimension of 12 × 12, as only the first 12 columns of Ui were considered to contain most of the original data sets' variance. These matrices were then used to calculate the canonical variates from their Lagrange multipliers. Following the requirements for creating a CCA algorithm described in chapter 2 section 2.4.2, Y1 and Y2 were arranged as follows Y= Y1 Y2 (4.5)

The covariance matrix, , of Y was then calculated in order to obtain the auto-covariances and cross-covariances which are mapped in  itself such that Y = Y1 Y1,2 Y2,1 Y2 (4.6)

. Using the calculated auto- and cross-covariances, the eigenvectors-eigenvalues pairs, P, Q, and r (of sizes L × L, L × L, and 1 × L, respectively), of their Lagrange multipliers were obtained by

76

utilizing the method described in Chapter 2, section 2.4.2. Then, to obtain the canonical variates, K1 and K2 ,
T KT 1 = PY1 T KT 2 = QY2

(4.7) (4.8)

With the canonical variates, the associated components of CDI and DTI, C1 and C2 , respectively, are calculated through least-squares approximation as described in Equation 2.34. The processes described above are summarized in Figure 4.3B-C. A verification of the functionality of the algorithm used in this portion is shown on Appendix A.2.

4.1.4

Image Reconstruction

To reconstruct the associated images of CDI and DTI, each row of the estimated component matrices, C1 and C2 , were multiplied with the same eigenvectors that were originally used to calculate their corresponding feature rows to obtain matrices, U1 and U2 , containing vectorized images of CDI and DTI images such that U1 = E1,i C1,i for i = 1, 2, ..., 12 U2 = E2,i C2,i for i = 1, 2, ..., 12 (4.9) (4.10)

This was performed on all the rows of the two estimated component matrices. The resulting matrices U1 and U2 contain the associated CDI and DTI images, which were reshaped back to an N × M image and were masked using their corresponding Mmask and Motsu to remove outliers on the image object. The procedure for image reconstruction is summarized in Figure 4.3D.

4.2
4.2.1

Review of Results
CCA Weights

The primary means of evaluating the differences between two cardiac states in a pairwise comparison is through their CCA loadings from their mixing profiles. The CCA loadings were obtained from the inverse of the canonical variates from each modality; each component within the resulting 77

Method CV %

Groups VF Non-VF VF Non-VF

VF 4 3 100 37.5

Non-VF 0 5 0 62.5

Total 4 8 100 100

Table 4.1: Cross validation using linear discriminate analysis with LOO method for CCA matrix were subjected to a two-sample t-test in order to determine the component that is significantly different from the others. A pair of mixing profile columns were chosen based on the t-test significance in such a way that at least one of the components demonstrate significance for the discrimination of cardiac states. Based on this approach, we found the first component to be appropriate for VF and non-VF classification and the third component for NM and AS classification. Note that for CCA analysis, the pairwise mixing profiles make up a two-dimensional feature. Figure 4.4A shows the scatter plot of the CCA loadings of the pairwise mixing profile for VF and non-VF discrimination. Figure 4.4B shows the scatter plot of the pairwise mixing profile for NM and VF. As seen in the figure, the two-dimensional scatter plot does indicate separation for VF and non-VF and NM and AS subjects. In order to quantify the joint significance of the pairwise components, we computed the LDA-based discriminant scores and performed Analysis of Variance (ANOVA) on the scores and obtained a p = 0.023 for VF and non-VF and a p = 0.024 for NM and AS. Using the the discriminant scores obtained from the CCA loadings, we performed an LDAbased LOO classification for VF and non-VF subjects. Table 4.1 shows the classification results reporting an overall accuracy of 75.0%.

4.2.2

Joint Histograms

An example of reconstructed images (from AS and VF comparison) after the performance of CCA is shown in Figure 4.5. By inspection, there are certain differences that can be said about the reconstructed CDI and DTI components in association to a cardiac state. As with the reconstructed images from jICA, it is challenging to infer physiological associations between the two pairs of 78

Figure 4.4: Scatter plots of the CCA loadings of CDI and DTI components for ANOVA tests on A) VF vs. non-VF subjects and B) NM vs. VF

79

Figure 4.5: Original CDI and DTI images and Reconstructed CDI and DTI images from CCA; pixel values in this display are converted to z -values and are thresholded at |z | = 3 reconstructed images. Therefore, as an alternative, the joint histograms of the reconstructed images can be examined. Figure 4.6A-D shows the average joint histograms from binary classification of cardiac states. Under VF and non-VF comparison, it can be seen that from Figure 4.6A that VF subjects have a concentrated high pixel values along the CDI axis and a relatively wide spread of pixels along the DTI axis. In contrast, non-VF subjects have a wider spread of pixel values in both CDI and DTI axes when compared to the VF subjects (Figure 4.6B). To further the comparison of two cardiac state, we examine the average joint histograms between NM and AS subjects. Since a heart in AS state is considered physiologically inactive, it is expected to have much less spread and concentration of pixels in both CDI and DTI axes however,

80

Figure 4.6: Joint Histograms from the A)VF vs. B)non-VF comparison and the C)NM vs. D)AS comparison

81

this is not fully reflected in its joint histogram (Figure 4.6D). As for the case of NM, it can be seen from their joint histograms (Figure 4.6C) that the participation of CDI in relation to DTI is more spread and includes more pixels than those of AS. CCA makes it possible to distinguish each cardiac states from each other based on the variation of the pixel distributions the reconstructed CDI and DTI images. It is noteworthy, that CCA does not attempt to equalize the variations of CDI and DTI within a cardiac state, as seen from their joint histograms. In the next sections, the quantification of these pixel concentrations and spreads will be presented to verify the visual observations made from the joint histograms.

4.2.3

Data Fusion Metrics

In order to assess the performance of CCA, metrics such as correlations and skewness were calculated from the histograms of the reconstructed CDI and DTI images. The following subsections discuss the results in the examination of such metrics. Skewness As discussed before, skew values place a quantitative measure on the variation of the CDI and DTI pixel distributions. This metric allows for a analysis of the joint histograms shown in Figure 4.6. As an example of such measures, Figure 4.7 shows the calculated skew values for a comparison between VF and non-VF subjects. It can be seen on the skew values that the previous observations made on the joint histograms are supported by their skew values. Correlation Another metric can be used to evaluate the performance of CCA is the correlation between the reconstructed CDI and DTI images (Figure 4.8). According to the correlations of the histograms of the reconstructed CDI and DTI images, CCA further increases the already high correlations of CDI and DTI across all cardiac states (average increase of 7.25%). This may suggest that the reconstructed images now contain an adequate representation of the spatial association of the diffusion values in DTI to the electrical current pathways seen in CDI. Such an observation can be 82

Figure 4.7: An example of the distribution of skew values comparison before (left column) and after (right column) CCA fusion

83

Figure 4.8: An example of the correlations of CDI and DTI histograms before and after CCA fusion from an NM vs. VF pairwise comparison seen from the reconstructed images in Figure 4.5, which have some shared or similar patterns in the spatial distribution of diffusion and electrical current values.

4.3

Summary

In this chapter the use of CCA as a feature-based data fusion technique was introduced. In essence, CCA reveals the linear relationships between two modalities by linking two different data sets through estimation of two matrices which have their columns' correlations maximized. By multiplying such matrices to the original data sets, an estimate of the associated components for the

84

two modalities being fused are obtained. CCA does not require any normalization of data sets as correlation is inherently independent of scaling; CCA also does not assume that the two modalities being fused have the same mixing matrices and does not assume that both modalities modulate in the same manner through subjects; CCA retains the uniqueness of each data sets at the same time it considers the inter-subject commonality within a modality. The rationale in implementing a correlation-based feature fusion method is the evidence of correlations of electrical current pathways in CDI to diffusion patterns in DTI. The goal was to maximize the linear relationship between the two imaging modalities and differentiate the cardiac states in question as per this thesis' primary objective. As evident from the result, the CCA approach does demonstrate discrimination in their CCA loading between cardiac states and provide improvement between the data sets of the two modalities post fusion.

85

Chapter 5 Conclusions and Future Work
5.1 Summary and Conclusions

In this graduate thesis, the author has explored the utility of feature-based data fusion methods for identifying different cardiac states based on the variations of electrical current pathways (CDI) and anatomical structure within a myocardium (DTI). The limitations of the current techniques in studying the dynamics of cardiac arrhythmia have bolstered the need to find alternative means of collecting data: medical imaging, specifically, MRIbased techniques. Based on past studies, CDI provides a visual depiction of the electrical current pathways through a targeted subject or tissue. In addition, DTI shows the spatial organization and orientation of muscle fibers providing an approximate model of the structure of an organ. In this thesis, both MRI-based techniques were used to collect static and dynamic information within a myocardium during the different cardiac states of NM, VF, and AS. An ex-vivo protocol is usually followed for studying VF because of ethical constraints involving live subjects. Therefore, following an approved AUP, data were collected from explanted porcine hearts, which were canulated and perfused through a mobile Langendorff system. Equipments such as an MRI phantom, CDI electronics, and electrode placements were customized accordingly in order to satisfy experimental constrains/requirements. Due to the complexity and the logistical demands of each of the experiments conducted, ten (10) porcine hearts were harvested for over a year, before which months of intensive testing equipment and protocol testings were performed. For each cardiac state that was collected from a porcine heart, it was treated as one subject and categorized accordingly. After 86

imaging data sets were collected, calculations of CDI and DTI components were performed after which rudimentary image batch matching and image registration methods were performed on the images obtained. The results of these procedures were used as input data sets for feature-based fusion methods. Two feature-based fusion methods were utilized in this graduate thesis: jICA and CCA. On one hand, jICA assumes that both imaging modalities share a common mixing matrix such that the subjects involved in a pairwise comparison are modulated with each other. On the other hand, CCA exposes the linear relationships between two data sets by generating unique de-mixing matrices for each data set, which are maximally correlated to each other. In the case of jICA, it constrains the contributions of each modality to be similar, which is the reason why a normalization process is crucial before performing such an algorithm. CCA relaxes the constrains of jICA in such a way that it does not assume a common mixing between two modalities and that it does not require input data normalization. In addition, CCA allows subject data interaction within only one modality for a pairwise comparison. The results of jICA and CCA were both primarily evaluated from their loadings. For a binary classification, by performing a t-test on the two groups of loadings, it was found that jICA and CCA loadings can be used to distinguish cardiac states from one another. Although some comparisons (NM vs. AS) yielded high p-values for jICA between the loadings of two cardiac states being compared, this could be the result of low number of samples for each state. In general, cardiac states are distinguished quantitatively and qualitatively through their component loadings. It is currently challenging to ascertain which parts of the CDI and DTI images are associated to each other just by inspection. However, the degree of association between the two imaging modalities can be quantified through their averaged joint histograms. Furthermore, these can be used as a mean of identifying the involvement of an imaging modality within a cardiac state. For jICA, the joint histograms reflect its equalizing state in which it forces the contributions of both imaging modalities to be similar. This was seen through the variation of the average pixel value distributions. For CCA, the variations of the average CDI and DTI histograms are unique to each other as well as unique between cardiac states. CCA allows for the analysis of which modality

87

has greater or lesser contributions within a cardiac state while still allowing for the identification between them. Data fusion metrics such as skewness, mutual information (exclusively for jICA), and correlation (exclusively for CCA) were used to evaluate the performance of data fusion. Conclusions for this study is two-fold; first, based on the results presented, it is possible to detect and quantify the variations of the static and dynamic aspects of cardiac states. This is achieved by fusing structural and functional imaging data sets using feature-based methods. Such results also indicate that under different cardiac states, the combination electrical current pathways and their associated anatomical structure can exhibit unique patterns. Hence, both MR-based techniques prove to be instrumental in providing a relatively complete picture of the static and dynamic aspects of a cardiac state. Therefore, and second, medical imaging techniques can be used to further improve studies on VF, expand sources of information, and explore different ways for analyzing cardiac data.

5.2

Directions for Future Work

There are other avenues of study that can be pursued from this graduate thesis: although the reconstructed images are currently not suitable for a volumetric depiction of the association of electrical current pathways and fiber orientations, the creation of a data-based, three-dimensional model of the images as a result of fusion could prove useful in studying cardiac arrhythmia. After some needed processing, such three-dimensional models can provide a depiction of the areas that are associated to each other from both electrophysiological and structural point of view. These would produce two volumetric models which can still be analyzed. An additional step could be taken by providing a means of fusing two imaging data sets at the pixel level by maximizing a function depending on a pre-determined requirement. From such a procedure, a unifying, data-based, threedimensional model can be obtained, which can assist in identifying regions in the myocardium that maybe unique to a cardiac state. This thesis could also expand on the number of types of cardiac data that can be fused together using more suitable types of data fusion techniques. A good addition to CDI and DTI data would be the electrical cardiac mapping data, which could complete the overall picture of the electrical 88

current pathways in the myocardium. However, this type of data set is measured in voltages and hence additional processing is required in order to match it's units with those of CDI. Furthermore, an association of the electrical current pathways and fiber orientations on a microscopic scale could be made possible with such a setup. These models can provide a better understanding of the relation of electrophysiology and structure within the myocardium, which can be associated to specific cardiac diseases and arrhythmia, especially for VF. Such a process gives physicians new and improved tools to better medical treatment options as well as deliver effective emergency treatments for patients, decreasing the overall number of SCD occurrence.

89

Appendix A Auxillary Notes on jICA and CCA
A.1 Information Maximization Verification

In order to verify the functionality of the author's jICA algorithm, the IM algorithm was implemented to a mixture of sound files obtained from a free-database. The mixture consisted of sound files from a cello, a rock concert, a gust of wind, and male and female voices. For simplicity, each sound file was downsampled from 40 kHz to 4 kHz and were arranged stacked on top of each other creating a 5 × N matrix. A mixing matrix composed of random numbers with a size of 5 × 5 was created in order to create a mixture of the sound files. The results of the estimation of the original sound files by IM are shown in Figure A.1. To verify these results, the correlation between the estimated and original sources are shown on Table A.1. original/estimated cello female male rock wind cello 0.99 0.006 0.0079 -0.01 -0.007 female 0.004 1.00 0.00 0.00 -0.003 male -0.0014 0.002 1.0 0.002 0.009 rock -0.02 0.004 0.00 0.99 -0.0045 wind -0.005 0.009 0.00 0.01 0.99

Table A.1: Correlation between estimated and original sound files As shown in Figure A.1, that after estimating the sources by IM algorithm from a given mixture of signals the order of the estimated sources is not identical as it was previously arranged. However, in the case of jICA and as indicated in [5], an estimated row component from the result90

Figure A.1: IM Algorithm Verification ing component matrix from the IM algorithm can be directly associated to its corresponding row feature from the original feature matrix. In other words a one-to-one correspondence can be made between the estimated components and the original feature matrix [5].

A.2

Canonical Correlation Analysis Algorithm Verification

In order to verify the functionality of the author's CCA algorithm, the covariance-based CCA algorithm was implemented on two sets of six (6) 25 × 25 test images. Each set of test images were considered as a unique image modality. Two mixing matrices of size 100 × 6 were created for each set of test images such that each column within a matrix are orthogonal and that the correlation (r) between corresponding columns of both matrices are correlated i.e. r = [0.9, 0.7, 0.5, 0.3, 0.1, 0]. It is important to note that the values from the mixing matrices were randomly generated from a normal distribution. For each set, the images were vectorized and were stacked on top of each other creating two 6 × 625 matrices. They were then mixed with each other using the two generated mixing matrices creating two 100 × 625 matrices. As with the dimension reduction procedure introduced in section 4.1.2, the two matrices were reduced to 100 × 100 matrices on which CCA

91

Figure A.2: Comparison of designed and calculated correlations of the columns of the mixing and demixing matrices, respectively was performed. As shown on Figure A.2, the designed correlations of the mixing matrices were closely approximated by CCA with a 95% similarity. Note that CCA, in this context, is not used as a blind source separation method which may be one of the reasons why there are no close resemblances of the original images to the reconstructed ones: CCA mandates that each estimated components may be uncorrelated to each other however this does not ensure independence from each other.

92

Appendix B Publications
List of Publications related to this thesis work

B.1

Conferences

1. K. Magtibay, M. Behesti, F. H. Foomany, K. Balasundaram, S. Masse, P. Lai, J. Asta, N. Zamiri, D.A. Jaffray, K. Nanthakumar, S. Krishnan, and K. Umapathy. "Fusion of Structural and Functional Cardiac Magnetic Resonance Imaging Data for Studying Ventricular Fibrillation". 36th Annual International Conference of the IEEE Engineering in Medicine and Biology Society (EMBC), Chicago, Illinois, August 2014. 2. F. H. Foomany, M. Beheshti, K. Magtibay, S. Masse, P. Lai, J. Asta, N. Zamiri, D.A. Jaffray, S. Krishnan, K. Nanthakumar, and K. Umapathy. "A Novel Approach to Quantification of Real and Artefactual Components of Current Density Imaging for Phantom and Live Hearts". 36th Annual International Conference of the IEEE Engineering in Medicine and Biology Society (EMBC), Chicago, Illinois, August 2014. 3. Foomany, F. H., M. Beheshti, K. Magtibay, S. Masse, W. Foltz, E. Sevaptsidis, P. Lai et al. "Analysis of reliability metrics and quality enhancement measures in current density imaging." In Engineering in Medicine and Biology Society (EMBC), 2013 35th Annual International Conference of the IEEE, pp. 4394-4397. IEEE, 2013.

93

B.2

Abstracts

1. F.H. Foomany, M. Beheshti, K. Magtibay, S. Masse, W. Foltz, E. Sevaptsidis, P. Lai, T. Farid, N. Krishnakumar, D.A. Jaffray, S. Krishnan, K. Nanthakumar, K. Umapathy. "Correlating Current Pathways With Myocardial Fiber Orientation Through Fusion of Data From Current Density and Diffusion Tensor Imaging". Canadian Journal of Cardiology - September 2012 Vol. 28, Issue 5, Supplement, Pages S372-S373

94

Bibliography
[1] John Hall and Arthur Guyton. Cardiac arrhythmias and their electrocardiographic interpretation. In Textbook of Medical Physiology. Saunders-Elseivier, Philadelphia, PA, USA, 12th edition, 2011. [2] Stuart Ira Fox. Blood, heart, and circulation. In Human Physiology. McGraw-Hill, New York, NY, USA, 11th edition, 2009. [3] Raymond Kwong. Basic MRI physics by A. Alteras. In Cardiovascular Magnetic Resonance Imaging. Humana Press, Totowa, NJ, USA, 2008. [4] Greig Scott, Mike Joy, Robin Armstrong, and Mark Henkelman. Measurement of nonuniform current density by magnetic resonance. Medical Imaging, IEEE Transactions on, 10(3):362­ 374, 1991. [5] Vince Calhoun, Tulay Adali, Godfrey Pearlson, and James Pekar. A method for making group inferences from functional MRI data using independent component analysis. Human brain mapping, 14(3):140­151, 2001. [6] Nicolle M Correa, Tulay Adali, Yi-Ou Li, and Vince D Calhoun. Canonical correlation analysis for data fusion and group inferences. Signal Processing Magazine, IEEE, 27(4):39­ 50, 2010. [7] Donald Lloyd-Jones, Robert J Adams, Todd M Brown, Mercedes Carnethon, Shifan Dai, Giovanni De Simone, T Bruce Ferguson, Earl Ford, Karen Furie, Cathleen Gillespie, et al.

95

Heart disease and stroke statistics 2010 update: A report from the American Heart Association. Circulation, 121(7):e46­e215, 2010. [8] Bruce A Koplan and William G Stevenson. Ventricular tachycardia and sudden cardiac death. In Mayo Clinic Proceedings, volume 84, pages 289­297. Elsevier, 2009. [9] Roy M John, Usha B Tedrow, Bruce A Koplan, Christine M Albert, Laurence M Epstein, Michael O Sweeney, Amy Leigh Miller, Gregory F Michaud, and William G Stevenson. Ventricular arrhythmias and sudden cardiac death. The Lancet, 380(9852):1520­1529, 2012. [10] Laura S Gold, Carol E Fahrenbruch, Thomas D Rea, and Mickey S Eisenberg. The relationship between time to arrival of emergency medical services (EMS) and survival from out-of-hospital ventricular fibrillation cardiac arrest. Resuscitation, 81(5):622­625, 2010. [11] Thomas D Rea, Mickey S Eisenberg, Greg Sinibaldi, and Roger D White. Incidence of EMS-treated out-of-hospital cardiac arrest in the United States. Resuscitation, 63(1):17­24, 2004. [12] Laurie J Morrison, Mark P Angelini, Marian J Vermeulen, and Brian Schwartz. Measuring the ems patient access time interval andthe impact of responding to high-rise buildings. Prehospital Emergency Care, 9(1):14­18, 2005. [13] Kumaraswamy Nanthakumar, Jos´ e Jalife, St´ ephane Mass´ e, Eugene Downar, Mihaela Pop, John Asta, Heather Ross, Vivek Rao, Sergey Mironov, Elias Sevaptsidis, et al. Optical mapping of Langendorff-perfused human hearts: establishing a model for the study of ventricular fibrillation in humans. American Journal of Physiology-Heart and Circulatory Physiology, 293(1):H875­H880, 2007. [14] St´ ephane Mass´ e, Eugene Downar, Vijay Chauhan, Elias Sevaptsidis, and Kumaraswamy Nanthakumar. Ventricular fibrillation in myopathic human hearts: mechanistic insights from in vivo global endocardial and epicardial mapping. American Journal of Physiology-Heart and Circulatory Physiology, 292(6):H2589­H2597, 2007. 96

[15] Karthikeyan Umapathy, Stephane Masse, Elias Sevaptsidis, John Asta, Sridhar Krishnan, and Kumaraswamy Nanthakumar. Spatiotemporal frequency analysis of ventricular fibrillation in explanted human hearts. Biomedical Engineering, IEEE Transactions on, 56(2):328­335, 2009. [16] Mina Attin and William T Clusin. Basic concepts of optical mapping techniques in cardiac electrophysiology. Biological research for nursing, 11(2):195­207, 2009. [17] Tsu-Juey Wu, Shien-Fong Lin, James N Weiss, Chih-Tai Ting, and Peng-Sheng Chen. Two types of ventricular fibrillation in isolated rabbit hearts importance of excitability and action potential duration restitution. Circulation, 106(14):1859­1866, 2002. [18] Ravi Mandapati, Yukio Asano, William T Baxter, Richard Gray, Jorge Davidenko, and Jos´ e Jalife. Quantification of effects of global ischemia on dynamics of ventricular fibrillation in isolated rabbit heart. Circulation, 98(16):1688­1696, 1998. [19] Karthikeyan Umapathy, Krishnakumar Nair, Stephane Masse, Sridhar Krishnan, Jack Rogers, Martyn P Nash, and Kumaraswamy Nanthakumar. Phase mapping of cardiac fibrillation. Circulation: Arrhythmia and Electrophysiology, 3(1):105­114, 2010. [20] Joyce Jeyaratnam, Karthikeyan Umapathy, Stephane Masse, Krishnakumar Nair, Talha Farid, Sridhar Krishnan, and K Nanthakumar. Relating spatial heterogeneities to rotor formation in studying human ventricular fibrillation. In Engineering in Medicine and Biology Society, EMBC, 2011 Annual International Conference of the IEEE, pages 231­234. IEEE, 2011. [21] K Umapathy, S Mass´ e, E Sevaptisidis, J Asta, T Farid, E Shokrollahi, K Nair, HJ Ross, RJ Cusimano, S Krishnan, and K Nanthakumar. Dominant frequency gradients and rotors during human ventricular fibrillation. In Canadian Cardiovascular Congress, CCC, 2008 Annual Meeting of the Canadian Cardiovascular Society, page 0729. CCC, 2008. [22] David W Frazier, Patrick D Wolf, J Marcus Wharton, AS Tang, William M Smith, and Raymond E Ideker. Stimulus-induced critical point. mechanism for electrical initiation of reentry in normal canine myocardium. Journal of Clinical Investigation, 83(3):1039, 1989. 97

[23] Krishnakumar Nair, Karthikeyan Umapathy, Talha Farid, Stephane Masse, Erin Mueller, Radhika V Sivanandan, Kwaku Poku, Vivek Rao, Vidhya Nair, Jagdish Butany, et al. Intramural activation during early human ventricular fibrillation. Circulation: Arrhythmia and Electrophysiology, 4(5):692­703, 2011. [24] Li Li, Qi Jin, Jian Huang, Kang-An Cheng, and Raymond E Ideker. Intramural foci during long duration fibrillation in the pig ventricle. Circulation research, 102(10):1256­1264, 2008. [25] Miguel Valderr´ abano, Moon-Hyoung Lee, Toshihiko Ohara, Angela C Lai, Michael C Fishbein, Shien-Fong Lin, Hrayr S Karagueuzian, and Peng-Sheng Chen. Dynamics of intramural and transmural reentry during ventricular fibrillation in isolated swine ventricles. Circulation research, 88(8):839­848, 2001. [26] Richard FitzHugh. Impulses and physiological states in theoretical models of nerve membrane. Biophysical journal, 1(6):445­466, 1961. [27] Jinichi Nagumo, S Arimoto, and S Yoshizawa. An active pulse transmission line simulating nerve axon. Proceedings of the IRE, 50(10):2061­2070, 1962. [28] Go W Beeler and H Reuter. Reconstruction of the action potential of ventricular myocardial fibres. The Journal of physiology, 268(1):177­210, 1977. [29] Flavio Fenton and Alain Karma. Vortex dynamics in three-dimensional continuous myocardium with fiber rotation: filament instability and fibrillation. Chaos: An Interdisciplinary Journal of Nonlinear Science, 8(1):20­47, 1998. [30] Rubin R Aliev and Alexander V Panfilov. A simple two-variable model of cardiac excitation. Chaos, Solitons & Fractals, 7(3):293­301, 1996. [31] Rubin R Aliev and Alexander V Panfilov. Modeling of heart excitation patterns caused by a local inhomogeneity. Journal of theoretical biology, 181(1):33­40, 1996. [32] Adrian Raine, Todd Lencz, Gavin P Reynolds, Glynn Harrison, Charlotte Sheard, Lindsey M Reynolds, John E Cooper, et al. An evaluation of structural and functional prefrontal deficits 98

in schizophrenia: MRI and neuropsychological measures. Psychiatry Research: Neuroimaging, 45(2):123­137, 1992. [33] Paul G Nestor, Toshiaki Onitsuka, Ronald J Gurrera, Margaret Niznikiewicz, Melissa Frumin, Martha E Shenton, and Robert W McCarley. Dissociable contributions of MRI volume reductions of superior temporal and fusiform gyri to symptoms and neuropsychology in schizophrenia. Schizophrenia research, 91(1):103­106, 2007. [34] Michael D Greicius, Gaurav Srivastava, Allan L Reiss, and Vinod Menon. Default-mode network activity distinguishes alzheimer's disease from healthy aging: evidence from functional mri. Proceedings of the National Academy of Sciences of the United States of America, 101(13):4637­4642, 2004. [35] Clifford R Jack, Ronald C Petersen, Yue Cheng Xu, Stephen C Waring, Peter C O'Brien, Eric G Tangalos, Glenn E Smith, Robert J Ivnik, and Emre Kokmen. Medial temporal atrophy on MRI in normal aging and very mild alzheimer's disease. Neurology, 49(3):786­794, 1997. [36] Richard S Yoon, Tim P DeMonte, Karshi F Hasanov, Dawn B Jorgenson, and Michael LG Joy. Measurement of thoracic current flow in pigs for the study of defibrillation and cardioversion. Biomedical Engineering, IEEE Transactions on, 50(10):1167­1173, 2003. [37] Igor Ser sa, Katarina Beravs, Nick JF Dodd, Sha Zhao, Damijan Miklav ci c, and Franci Demsar. Electric current density imaging of mice tumors. Magnetic resonance in medicine, 37(3):404­409, 1997. [38] G¨ otz Thomalla, Volkmar Glauche, Martin A Koch, Christian Beaulieu, Cornelius Weiller, and Joachim R¨ other. Diffusion tensor imaging detects early wallerian degeneration of the pyramidal tract after ischemic stroke. Neuroimage, 22(4):1767­1774, 2004. [39] David J Werring, Ahmed T Toosy, Christopher A Clark, Geoffrey JM Parker, Gareth J Barker, David H Miller, and Alan J Thompson. Diffusion tensor imaging can detect and quantify corticospinal tract degeneration after stroke. Journal of Neurology, Neurosurgery & Psychiatry, 69(2):269­272, 2000. 99

[40] U Wieshmann, M Symms, G Parker, C Clark, L Lemieux, G Barker, and S Shorvon. Diffusion tensor imaging demonstrates deviation of fibres in normal appearing white matter adjacent to a brain tumour. Journal of neurology, neurosurgery, and psychiatry, 68(4):501, 2000. [41] Jacques MT de Bakker, Mera Stein, and Harold VM van Rijen. Three-dimensional anatomic structure as substrate for ventricular tachycardia/ventricular fibrillation. 2(7):777­779, 2005. [42] Bryan J Caldwell, Mark L Trew, Gregory B Sands, Darren A Hooks, Ian J LeGrice, and Bruce H Smaill. Three distinct directions of intramural activation reveal nonuniform side-toside electrical coupling of ventricular myocytes. Circulation: Arrhythmia and Electrophysiology, 2(4):433­440, 2009. [43] Kirsten HWJ Ten Tusscher, Alexander V Panfilov, et al. Organization of ventricular fibrillation in the human heart. Circulation research, 100(12):e87­e101, 2007. [44] Nancy C Andreasen, Peg Nopoulos, Daniel S OLeary, Del D Miller, Thomas Wassink, and Michael Flaum. Defining the phenotype of schizophrenia: cognitive dysmetria and its neural mechanisms. Biological psychiatry, 46(7):908­920, 1999. [45] Alexander A Stevens, Patricia S Goldman-Rakic, John C Gore, Robert K Fulbright, and Bruce E Wexler. Cortical dysfunction in schizophrenia during auditory word and tone working memory demonstrated by functional magnetic resonance imaging. Archives of General Psychiatry, 55(12):1097­1103, 1998. [46] Florin Savopol and Costas Armenakis. Merging of heterogeneous data for emergency mapping: Data integration or data fusion? International Archives of Photogrammetry Remote Sensing and Spatial Information Sciences, 34(4):668­674, 2002. [47] Christoph Arndt and Otmar Loffeld. Information gained by data fusion. In Lasers, Optics, and Vision for Productivity in Manufacturing I, pages 32­40. International Society for Optics and Photonics, 1996. 100 Heart Rhythm,

[48] Bharat Biswal, F Zerrin Yetkin, Victor M Haughton, and James S Hyde. Functional connectivity in the motor cortex of resting human brain using echo-planar MRI. Magnetic resonance in medicine, 34(4):537­541, 1995. [49] Elena Belloni, Francesco De Cobelli, Antonio Esposito, Renata Mellone, Gianluca Perseghin, Tamara Canu, and Alessandro Del Maschio. MRI of cardiomyopathy. American journal of roentgenology, 191(6):1702­1710, 2008. [50] Oliver Wieben, Christopher Francois, and Scott B Reeder. Cardiac MRI of ischemic heart disease at 3t: potential and challenges. European journal of radiology, 65(1):15­28, 2008. [51] Karl J Friston, P Fletcher, O Josephs, A Holmes, MD Rugg, and R Turner. Event-related fMRI: characterizing differential responses. Neuroimage, 7(1):30­40, 1998. [52] Charles L Dumoulin and HR Hart Jr. 161(3):717­720, 1986. [53] Massimo Filippi, Giuseppe Iannucci, Carla Tortorella, Laura Minicucci, Mark Horsfield, Barbara Colombo, Mariapia Sormani, and Giancarlo Comi. Comparison of MS clinical phenotypes using conventional and magnetization transfer MRI. Neurology, 52(3):588­588, 1999. [54] Mike Joy, Greig Scott, and Mark Henkelman. In vivo detection of applied electric currents by magnetic resonance imaging. Magnetic resonance imaging, 7(1):89­94, 1989. [55] Susumu Mori and Peter B Barker. Diffusion magnetic resonance imaging: its principle and applications. The Anatomical Record, 257(3):102­109, 1999. [56] Andrew L Alexander, Jee Eun Lee, Mariana Lazar, and Aaron S Field. Diffusion tensor imaging of the brain. Neurotherapeutics, 4(3):316­329, 2007. [57] Farbod Foomany, Mohammadali Beheshti, Karl Magtibay, Stephane Masse, Warren Foltz, Elias Sevaptsidis, Patrick Lai, Talha Farid, Nanthakumar Krishnakumar, David Jaffray, et al. Correlating current pathways with myocardial fiber orientation through fusion of data from Magnetic resonance angiography. Radiology,

101

current density and diffusion tensor imaging. Canadian Journal of Cardiology, 28(5):S372­ S373, 2012. [58] Yaniv Assaf and Ofer Pasternak. Diffusion tensor imaging DTI-based white matter mapping in brain research: a review. Journal of Molecular Neuroscience, 34(1):51­61, 2008. [59] David F Scollan, Alex Holmes, Raimond Winslow, and John Forder. Histological validation of myocardial microstructure obtained from diffusion tensor magnetic resonance imaging. American Journal of Physiology-Heart and Circulatory Physiology, 275(6):H2308­H2318, 1998. [60] Gustav J Strijkers, Annemiek Bouts, W Matthijs Blankesteijn, Tim HJM Peeters, Anna Vilanova, Mischa C van Prooijen, Honorius MHF Sanders, Edwin Heijman, and Klaas Nicolay. Diffusion tensor imaging of left ventricular remodeling in response to myocardial infarction in the mouse. NMR in biomedicine, 22(2):182­190, 2009. [61] Ming-Ting Wu, Mao-Yuan M Su, Yi-Luan Huang, Kuan-Rau Chiou, Pinchen Yang, HuayBen Pan, Timothy G Reese, Van J Wedeen, and Wen-Yih I Tseng. Sequential changes of myocardial microstructure in patients postmyocardial infarction by diffusion-tensor cardiac mr correlation with left ventricular structure and function. Circulation: Cardiovascular Imaging, 2(1):32­40, 2009. [62] Othman Sidek and Syed Quadri. A review of data fusion models and systems. International Journal of Image and Data Fusion, 3(1):3­21, 2012. [63] Vince Calhoun, Tulay Adali, Nicole Giuliani, James Pekar, Kent Kiehl, and Godfrey Pearlson. Method for multimodal analysis of independent source differences in schizophrenia: combining gray matter structural and auditory oddball functional data. Human brain mapping, 27(1):47­62, 2006. [64] Vince D Calhoun, Tulay Adali, Godfrey Pearlson, and Kent Kiehl. Neuronal chronometry of target detection: fusion of hemodynamic and event-related potential data. Neuroimage, 30(2):544­553, 2006. 102

[65] Vince D Calhoun and T¨ ulay Adali. Feature-based fusion of medical imaging data. Information Technology in Biomedicine, IEEE Transactions on, 13(5):711­720, 2009. [66] Nicolle M Correa, Tom Eichele, T¨ ulay Adali, Yi-Ou Li, and Vince D Calhoun. Multi-set canonical correlation analysis for the fusion of concurrent single trial erp and functional mri. Neuroimage, 50(4):1438­1445, 2010. [67] Jing Sui, T¨ ulay Adali, Godfrey Pearlson, Honghui Yang, Scott R Sponheim, Tonya White, and Vince D Calhoun. A CCA+ICA based model for multi-task brain imaging data fusion and its application to schizophrenia. Neuroimage, 51(1):123­134, 2010. [68] Natalia A Trayanova. Whole-heart modeling applications to cardiac electrophysiology and electromechanics. Circulation Research, 108(1):113­128, 2011. [69] Changtao He, Quanxi Liu, Hongliang Li, and Haixu Wang. Multimodal medical image fusion based on ihs and pca. Procedia Engineering, 7:280­285, 2010. [70] Aapo Hyv¨ arinen and Erkki Oja. Independent component analysis: algorithms and applications. Neural networks, 13(4):411­430, 2000. [71] Jing Sui, T¨ ulay Adali, Godfrey D Pearlson, Vincent P Clark, and Vince D Calhoun. A method for accurate group difference detection by constraining the mixing coefficients in an ica framework. Human brain mapping, 30(9):2953­2970, 2009. [72] Alvin C Rencher and William F Christensen. Methods of multivariate analysis, volume 709. John Wiley & Sons, 2012. [73] Jing Sui, Godfrey Pearlson, Arvind Caprihan, T¨ ulay Adali, Kent A Kiehl, Jingyu Liu, Jeremy Yamamoto, and Vince D Calhoun. Discriminating schizophrenia and bipolar disorder by fusing fMRI and DTI in a multimodal CCA+ joint ica model. Neuroimage, 57(3):839­855, 2011. [74] Herv´ e Abdi and Lynne J Williams. Principal component analysis. Wiley Interdisciplinary Reviews: Computational Statistics, 2(4):433­459, 2010. 103

[75] Steve Pieper, Michael Halle, and Ron Kikinis. 3d slicer. In Biomedical Imaging: Nano to Macro, 2004. IEEE International Symposium on, pages 632­635. IEEE, 2004. [76] Nobuyuki Otsu and Takio Kurita. A new scheme for practical flexible and intelligent vision systems. In MVA, pages 431­435, 1988. [77] Lisa Gottesfeld Brown. A survey of image registration techniques. ACM computing surveys (CSUR), 24(4):325­376, 1992. [78] David Lay. Symmetric matrices and quadratic forms. In Linear Algebra and Its Applications. Pearson, Maryland, USA, 3rd edition, 2006. [79] Jean-Francois Cardoso. Infomax and maximum likelihood for blind source separation. IEEE Signal processing letters, 1997. [80] Anthony J Bell and Terrence J Sejnowski. Blind separation and blind deconvolution: an information-theoretic approach. In Acoustics, Speech, and Signal Processing, 1995. ICASSP95., 1995 International Conference on, volume 5, pages 3415­3418. IEEE, 1995. [81] Richard O Duda, Peter E Hart, and David G Stork. Pattern classification. John Wiley & Sons, 2012. [82] Keinosuke Fukunaga. Introduction to statistical pattern recognition. Academic press, 1990. [83] N Balakrishnan, N Johnson, and S Kotz. Continuous univariate distributions, 1994. [84] Mohammad Bagher Akbari Haghighat, Ali Aghagolzadeh, and Hadi Seyedarabi. A nonreference image fusion metric based on mutual information of image features. Computers & Electrical Engineering, 37(5):744­756, 2011. [85] Nicolle M Correa, Yi-Ou Li, T¨ ulay Adali, and Vincent D Calhoun. Canonical correlation analysis for feature-based fusion of biomedical imaging modalities and its application to detection of associative networks in schizophrenia. Selected Topics in Signal Processing, IEEE Journal of, 2(6):998­1007, 2008.

104


