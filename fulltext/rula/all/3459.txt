PREDICTIVE CONTROL OF MULTILEVEL CONVERTERS FOR MEGAWATT WIND ENERGY CONVERSION SYSTEMS
By

Venkata Narasimha Rao Yaramasu

B. Tech., J. N. T. University, Hyderabad, India, 2005 M. E., S. G. S. Institute of Technology and Science, Indore, India, 2008

A dissertation presented to Ryerson University in partial fulfillment of the requirements for the degree of Doctor of Philosophy in the Program of Electrical and Computer Engineering

Toronto, Ontario, Canada, 2014 c Venkata Narasimha Rao Yaramasu, 2014

[This page intentionally left blank]

Author's Declaration
I hereby declare that I am the sole author of this dissertation. This is a true copy of the dissertation, including any required final revisions, as accepted by my examiners. I authorize Ryerson University to lend this dissertation to other institutions or individuals for the purpose of scholarly research.

I further authorize Ryerson University to reproduce this dissertation by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

I understand that my dissertation may be made electronically available to the public.

iii

[This page intentionally left blank]

Predictive Control of Multilevel Converters for Megawatt Wind Energy Conversion Systems
Venkata Narasimha Rao Yaramasu Doctor of Philosophy Electrical and Computer Engineering Ryerson University, Toronto, 2014

Abstract
This dissertation proposes two novel medium voltage (MV) multilevel converter configurations for use with permanent magnet synchronous generator (PMSG) based megawatt (MW) wind energy conversion systems (WECS). The classical control techniques, based on linear PI regulators and low band-width modulation, present several technical issues during lower switching frequency operation. To overcome these issues, a high performance finite control-set model predictive control (FCS-MPC) strategy is proposed to control the power converters employed in the MW-PMSG-WECS. The proposed three-level and four-level converters combine the advantages of proven wind turbine technologies, such as low-cost generator-side passive converters, and efficient gridside multilevel converters. The intermediate dc-dc multilevel converters ensure balancing of the capacitor voltages during all operating conditions. With this feature, the grid-side multilevel converters produce better grid current waveforms compared to the back-to-back connected converters. A generalized approach for the predictive control of an n-level diode-clamped converter was investigated. The FCS-MPC strategy for current control and decoupled active/reactive power regulation of grid-connected multilevel converters was also analyzed. The major v

WECS requirements such as maximum power point tracking, balancing of dc-link capacitor voltages, switching frequency minimization, common-mode voltage mitigation, regulation of net dc-bus voltage, and grid reactive power control have been modeled in terms of power converter switching states. These control objectives have been accomplished during each sampling interval by selecting the switching states which minimize the generator- and grid-side cost functions. Issues related to the weighting factors selection, control delay compensation, accurate extrapolation of references, control of variable switching frequency nature, prediction of variables over two samples with reduced computational burden, and robustness analysis, are also addressed in this dissertation. To keep the dc-bus voltage constant during low voltage ride-through operation, predictive control scheme is proposed for the power converters while storing surplus energy in the turbine-generator rotor inertia. The generation and exchange of reference control variables during symmetrical grid voltage dips is suggested to meet the grid code requirements. The proposed solution is efficient as no energy is dissipated in the dc-link crowbar. The simulation and experimental results validate the proposed MV converters and predictive control schemes.

vi

Acknowledgement
I express my deep sense of gratitude and heart-felt thanks to my supervisor, Professor Bin Wu, for his invaluable guidance, patience, kindness and consistent encouragement throughout the course of this work. I am very grateful to him for always treating me as his special student. I am very glad that I have pursued my doctoral studies under his excellent supervision. I am very thankful to my good friend and fellow researcher Dr. Marco Rivera (Universidad de Talca, Chile), and Prof. Jose Rodriguez (Universidad Tecnica Federico Santa Maria, Chile) for their support during the early stage of my research on predictive control. I would like to thank my collaborative research team members Drs. Samir Kouro (Universidad Tecnica Federico Santa Maria) and Salvador Alepuz (Technical University of Catalonia, Spain) for many interesting discussions. I am grateful to Drs. Dewei Xu and Amir Yazdani for their kind suggestions and helpful tips in developing prototype converters. I would like to acknowledge very good suggestions given by them during my PhD dissertation preliminary and final defence examinations. I am very thankful to Drs. Jin Jiang (Western University, Canada), Krishnan Venkatakrishnan (Ryerson University) and David Naylor (Ryerson University) for providing me valuable suggestions and comments during my final defence examination. I would like to thank all my friends in LEDAR, especially Mehdi Narimani, Moya Dai, Jason Wang, Ning Zhu, Jin Chen, Mitesh Popat, Sasan Mostafaei, Sebastian Rivera, Ahmad Yafaoui, Liangyu Tang, Anping Hu, Shivkumar Iyer, Srinivas Karanki and Sivaprasad Jaladanki for memorable time and fruitful discussions. My special thanks to Apparao Dekka for his great assistance in performing the experimental tests.

(Continued on the next page..)

vii

I express my respect and intense gratitude to my parents who were the source of inspiration and support all through my life. Special thanks to my brother Anil Kumar who supported me in every possible way to see the completion of this work. My research would not have been possible without his help. I am so thankful to all those people with whom I am close, especially Beverly, Kartheek, Saiprasanth, Gangadhar, Lakshmikanth and Nitin Goel for always being by my side and helping me. Financial support from Prof. Bin Wu, Department of ELCE, Center for Urban Energy (CUE), Toronto Hydro, Hydro One, Connect Canada program, Wind Energy Strategic Network (WESNet) and Ryerson University are gratefully acknowledged. Thanks are extended to Wendy Thornton for providing professional editing to my research publications and dissertation.

V. Yaramasu Toronto, Ontario, Canada 23, January, 2014

viii

Dedicated to my mother Subbayamma and father Veeraiah

ix

[This page intentionally left blank]

List of Publications
Papers in Refereed Journals1
Papers Published
[1] V. Yaramasu, M. Rivera, B. Wu, and J. Rodriguez, "Model Predictive Current Control of TwoLevel Four-Leg Inverters ­ Part I: Concept, Algorithm and Simulation Analysis," IEEE Trans. Power Electron., vol. 28, no. 7, pp. 3459-3468, Jul. 2013. [2] M. Rivera, V. Yaramasu, J. Rodriguez, and B. Wu, "Model Predictive Current Control of Two-Level Four-Leg Inverters ­ Part II: Experimental Implementation and Validation," IEEE Trans. Power Electron., vol. 28, no. 7, pp. 3469-3478, Jul. 2013. [3] M. Rivera, V. Yaramasu, A. Llor, J. Rodriguez, B. Wu, and M. Fadel, "Digital Predictive Current Control of a Three-Phase Four-Leg Inverter," IEEE Trans. Ind. Electron., vol. 60, no. 11, pp. 4903-4912, Nov. 2013.

Papers Accepted for Publication
[4] V. Yaramasu, B. Wu, and J. Chen, "Model Predictive Control of Grid-Tied Four-Level DiodeClamped Inverters for High Power Wind Energy Conversion Systems," IEEE Trans. Power Electron., 2013, DOI: 10.1109/TPEL.2013.2276120.

1 Impact Factor of Journals as of 23, Jan. 2014: IEEE Transactions on Industrial Electronics = 5.165 IEEE Transactions on Power Electronics = 4.08 IEEE Transactions on Industrial Informatics = 3.381 Proceedings of the IEEE = 6.911 Journal of Electric Power Systems Research = 1.694 IEEE Journal of Emerging and Selected Topics in Power Electronics = 0 (new journal)

xi

[5] V. Yaramasu, and B. Wu, "A Model Predictive Decoupled Active and Reactive Power Control for High Power Grid-Connected Four-Level Diode-Clamped Inverters," IEEE Trans. Ind. Electron., 2013, DOI: 10.1109/TIE.2013.2278959. [6] V. Yaramasu, and B. Wu, "Predictive Control of a Three-Level Boost Converter and an NPC Inverter for High-Power PMSG-Based Medium Voltage Wind Energy Conversion Systems," IEEE Trans. Power Electron., 2013, DOI: 10.1109/TPEL.2013.2292068. [7] V. Yaramasu, B. Wu, M. Rivera, and J. Rodriguez, "A New Power Conversion System for Megawatt PMSG Wind Turbines using Four-Level Converters and a Simple Control Scheme Based on Two-Step Model Predictive Strategy ­ Part I: Modeling and Theoretical Analysis," IEEE J. Emerging and Selected Topics in Power Electron., 2013, DOI: 10.1109/JESTPE.2013.2294920. [8] V. Yaramasu, B. Wu, M. Rivera, and J. Rodriguez, "A New Power Conversion System for Megawatt PMSG Wind Turbines using Four-Level Converters and a Simple Control Scheme Based on Two-Step Model Predictive Strategy ­ Part II: Simulation and Experimental Analysis," IEEE J. Emerging and Selected Topics in Power Electron., 2013, DOI: 10.1109/JESTPE.2013.2294922. [9] V. Yaramasu, M. Rivera, M. Narimani, B. Wu, and J. Rodriguez, "Model Predictive Approach for a Simple and Effective Load Voltage Control of Four-Leg Inverter with an Output LC Filter," IEEE Trans. Ind. Electron., 2013, DOI: 10.1109/TIE.2013.2297291. [10] C. Baier, J. Espinoza, J. Munoz, P. Melin, M. Rivera, B. Wu, and V. Yaramasu, "Improving Power Quality in Cascade Multilevel Converters Based on Single-Phase Non-Regenerative Power Cells," IEEE Trans. Ind. Electron., 2013, DOI: 10.1109/TIE.2013.2289866.

Papers in Revision and Review
[11] V. Yaramasu, B. Wu, S. Alepuz, and S. Kouro, "Predictive Control for Low Voltage Ride-Through Enhancement of Three-Level Boost and NPC Converters based PMSG Wind Turbines," IEEE Trans. Ind. Electron., 2013. (Minor revision submitted for review)

xii

[12] V. Yaramasu, M. Rivera, M. Narimani, J. Rodriguez, and B. Wu, "Current Regulation of Four-Leg NPC Converters using Two-Step Finite States Model Predictive Control Strategy," IEEE Trans. Ind. Informat., 2013. (Manuscript submitted for review) [13] V. Yaramasu, B. Wu, P. Sen, S. Kouro, and M. Narimani, "High-Power Wind Energy Conversion Systems: State-of-the-Art and Emerging Technologies," Proc. IEEE, 2013. (Proposal submitted to the EIC) [14] M. Narimani, V. Yaramasu, B. Wu, N. Zargari, G. Moschopoulos, and G. Cheng, "Simplified DCLink Capacitor Current Calculation for Voltage Balancing of n-Level Diode-Clamped Converters using Space Vector Modulation," IEEE Trans. Power Electron., 2013. (Manuscript submitted for review) [15] L. Tang, B. Wu, V. Yaramasu, W. Chen, and H. S. Athab, "Novel DC/DC Choppers with Circuit Breaker Functionality for HVDC Transmission Lines," J. Electric Power Systems Research, 2013. (Manuscript submitted for review)

Papers in Preparation2
[16] V. Yaramasu, B. Wu, M. Narimani, M. Rivera, and J. Wang, "Comparative Assessment of Classical and Predictive Control Techniques for Two-Level Voltage Source Converters Based High-Power PMSG Wind Turbines," IEEE Trans. Power Electron., 2014. [17] V. Yaramasu, and B. Wu, "Predictive Control of PMSG Wind Energy Conversion Systems Employing Back-to-Back Connected NPC Converters," IEEE Trans. Ind. Electron., 2014. [18] V. Yaramasu, M. Rivera, M. Narimani, B. Wu, and J. Rodriguez, "High-Performance Two-Step FCS-MPC Strategy for Four-Pole NPC Inverter Based UPS Applications," IEEE Trans. Ind. Electron., 2014.

2 Simulation and experimental results have been obtained for all the journal papers which are in preparation stage.

xiii

[19] V. Yaramasu, B. Wu, M. Narimani, S. Kouro, M. Rivera, and J. Rodriguez, "Generalized Approach for Predictive Control with Common-Mode Voltage Mitigation in Multilevel Diode-Clamped Converters," IEEE Trans. Power Electron., 2014. [20] M. Narimani, V. Yaramasu, B. Wu, N. Zargari, and G. Cheng, "A Nested Neutral Point Clamped (NNPC) Converter using Simple Single-Phase Modulator," IEEE Trans. Ind. Electron., 2014. [21] M. Narimani, V. Yaramasu, B. Wu, N. Zargari, and G. Cheng, "Predictive Control with CommonMode Voltage Reduction in Nested Neutral Point Clamped (NNPC) Converter," IEEE Trans. Power Electron., 2014. [22] S. Rivera, B. Wu, S. Kouro, V. Yaramasu, and J. Wang, "Electric Vehicle Charging Station using a Neutral Point Clamped Converter with Bipolar dc Bus," IEEE Trans. Ind. Electron., 2014.

Papers in Refereed Conference Proceedings
Papers Published
[23] M. Narimani, V. Yaramasu, B. Wu, N. Zargari, G. Cheng, and G. Moschopoulos, "A Simple Method for Capacitor Voltages Balancing of Diode-Clamped Multilevel Converters using Space Vector Modulation," in IEEE Ind. Electron. Society (IECON), Nov. 2013, pp. 310-315, Vienna, Austria. [24] P. Zavala, M. Rivera, S. Kouro, J. Rodriguez, B. Wu, V. Yaramasu, C. Baier, J. Munoz, J. Espinoza, and P. Melin, "Predictive Control of a Current Source Rectifier with Imposed Sinusoidal Input Currents," in IEEE Ind. Electron. Society (IECON), Nov. 2013, pp. 5842-5847, Vienna, Austria. [25] V. Yaramasu, B. Wu, M. Rivera, and J. Rodriguez, "Predictive Current Control and DC-Link Capacitors Balancing for Four-Leg NPC Inverters," in IEEE Int. Symp. on Ind. Electron. (ISIE), May. 2013, pp. 1-6, Taipei, Taiwan. [26] M. Rivera, J. Rodriguez, V. Yaramasu, and B. Wu, "A Simple Current Control Strategy for TwoLevel Four-Leg Inverters: The Model Predictive Approach," in IEEE Int. Conf. on Power Eng. Energy and Elect. Drives (POWERENG), May. 2013, pp. 46-51, Istanbul, Turkey.

xiv

[27] M. Rivera, S. Kouro, J. Rodriguez, B. Wu, V. Yaramasu, J. Espinoza, and P. Melin, "Predictive Current Control in a Current Source Inverter Operating with Low Switching Frequency," in IEEE Int. Conf. on Power Eng. Energy and Elect. Drives (POWERENG), May. 2013, pp. 334-339, Istanbul, Turkey. [28] M. Rivera, J. Rodriguez, J. Munoz, C. Baier, J. Espinoza, V. Yaramasu, B. Wu, and P. Wheeler, "A Simple Predictive Current Control of a Single-Phase Matrix Converter," in IEEE Int. Conf. on Power Eng. Energy and Elect. Drives (POWERENG), May. 2013, pp. 235-239, Istanbul, Turkey. [29] V. Yaramasu, and B. Wu, "Predictive Power Control of Grid-Connected Four-Level Inverters in Stationary Reference Frame," in IEEE Int. Conf. on Circuits, Power and Computing Tech. (ICCPCT), Mar. 2013, pp. 636-641, Kumaracoil, India. [30] V. Yaramasu, B. Wu, M. Rivera, and J. Rodriguez, "Enhanced Model Predictive Voltage Control of Four-Leg Inverters With Switching Frequency Reduction for Standalone Power Systems," in Int. Power Electron. and Motion Control Conf. (EPE/PEMC), Sep. 2012, pp. DS2c.6-1-DS2c.6-5, Novi Sad, Serbia. [31] M. Rivera, J. Rodriguez, V. Yaramasu, and B. Wu, "Predictive Load Voltage and Capacitor Balancing Control for a Four-Leg NPC Inverter," in Int. Power Electron. and Motion Control Conf. (EPE/PEMC), Sep. 2012, pp. DS3c.8-1-DS3c.8-5, Novi Sad, Serbia. [32] V. Yaramasu, B. Wu, M. Rivera, J. Rodriguez, and A. Wilson, "Cost-Function Based Predictive Voltage Control of Two-Level Four-Leg Inverters using Two Step Prediction Horizon for Standalone Power Systems," in IEEE Appl. Power Electron. Conf. Expo. (APEC), Feb. 2012, pp. 128-135, Orlando, Florida, USA. [33] V. Yaramasu, and B. Wu, "Three-Level Boost Converter Based Medium Voltage Megawatt PMSG Wind Energy Conversion Systems," in IEEE Energy Conversion Congr. and Expo. (ECCE), Sep. 2011, pp. 561-567, Phoenix, Arizona, USA.

xv

[34] J. Rodriguez, B. Wu, M. Rivera, C. Rojas, V. Yaramasu, and A. Wilson, "Predictive Current Control of Three-Phase Two-Level Four-Leg Inverter," in Int. Power Electron. and Motion Control Conf. (EPE/PEMC), Sep. 2010, pp. T3-106-T3-110, Ohrid, Republic of Macedonia. [35] V. Yaramasu, J. Rodriguez, B. Wu, M. Rivera, A. Wilson, and C. Rojas, "A Simple and Effective Solution for Superior Performance in Two-Level Four-Leg Voltage Source Inverters: Predictive Voltage Control," in IEEE Int. Symp. on Ind. Electron. (ISIE), Jul. 2010, pp. 3127-3132, Bari, Italy. [36] J. Rodriguez, B. Wu, M. Rivera, A. Wilson, V. Yaramasu, and C. Rojas, "Model Predictive Control of Three-Phase Four-Leg Neutral-Point-Clamped Inverter," in Int. Power Electron. Conf. (IPEC), Jun. 2010, pp. 3112-3116, Sapporo, Japan.

Papers Accepted for Presentation
[37] L. Tang, B. Wu, V. Yaramasu, W. Chen, and H. S. Athab, "Fast Acting DC Circuit Breaker for HVDC Transmission Line Based on DC/DC Chopper," in Int. Power Electron. Conf. (IPEC), May. 2014, Hiroshima, Japan.

Papers in Review Process
[38] M. Narimani, V. Yaramasu, B. Wu, and N. Zargari, "A New Simplified Approach for Capacitor Voltage Balancing of Flying Capacitor Multilevel Converters using Space Vector Modulation," in European Conf. on Power Electron. and Appl. (EPE'14-ECCE Europe), Aug. 2014, Lappeenranta, Finland.

xvi

Contents
Abstract Acknowledgement List of Publications Table of Contents List of Figures List of Tables Glossary of Acronyms and Symbols 1 Introduction 1.1 Overview of Wind Energy Conversion Systems . . . . . . . . . . . . . . . . . 1.1.1 1.1.2 1.1.3 1.1.4 1.1.5 1.1.6 1.1.7 1.2 1.2.1 1.2.2 1.3 1.3.1 1.3.2 1.4 Installed Wind Power Capacity and Growth Rate . . . . . . . . . . . Global Perspective of WECS . . . . . . . . . . . . . . . . . . . . . . . Evolution of Megawatt WECS . . . . . . . . . . . . . . . . . . . . . . Major Components of Grid-Connected WECS . . . . . . . . . . . . . Classification of WECS Operating Voltages . . . . . . . . . . . . . . . Grid Code Requirements . . . . . . . . . . . . . . . . . . . . . . . . . Commercial Configurations of WECS . . . . . . . . . . . . . . . . . . Motivation from the Power Converters' Perspective . . . . . . . . . . Motivation from the Control Schemes' Perspective . . . . . . . . . . . Investigation of Next-Generation Power Converters . . . . . . . . . . Investigation of Next-Generation Control Schemes . . . . . . . . . . . v vii xi xvii xxii xxviii xxx 1 2 3 3 4 5 7 8 11 14 14 17 19 19 21 23

Motivation for Dissertation Research . . . . . . . . . . . . . . . . . . . . . .

Dissertation Objectives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

Outline of Dissertation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xvii

2 Review of Power Converters for High Power Wind Turbines 2.1 Back-to-Back Connected Converters . . . . . . . . . . . . . . . . 2.1.1 Low Voltage (LV) Converters . . . . . . . . . . . . . . . 2.1.2 Medium Voltage (MV) Converters . . . . . . . . . . . . . 2.2 Passive Generator-side Converters . . . . . . . . . . . . . . . . . 2.3 Converters for Six-Phase Machine Based WECS . . . . . . . . . 2.4 Converters for Open Winding Machine Based WECS . . . . . . 2.5 Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3 Review of Control Techniques in Power Converters 3.1 The Past, Present and Future of Control Platforms . 3.2 Overview of Digital Control Techniques . . . . . . . . 3.2.1 Hysteresis Control Technique . . . . . . . . . 3.2.2 Linear Control Technique . . . . . . . . . . . 3.2.3 Sliding Mode Control Technique . . . . . . . . 3.2.4 Intelligent Control Techniques . . . . . . . . . 3.2.5 Predictive Control Techniques . . . . . . . . . 3.3 Finite Control-Set Model Predictive Control . . . . . 3.3.1 Operating Principle and Design Procedure . . 3.3.2 Cost Function Flexibility . . . . . . . . . . . . 3.3.3 Delay Compensation Methods . . . . . . . . . 3.3.4 Extrapolation Methods . . . . . . . . . . . . . 3.4 Comparison of FCS-MPC with Linear Control . . . . 3.5 Conclusion . . . . . . . . . . . . . . . . . . . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

. . . . . . .

25 26 27 28 34 40 44 46 47 48 49 52 52 54 54 55 56 57 61 62 65 67 68

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

. . . . . . . . . . . . . .

4 Generalized Approach for Predictive Control in High-Performance Multilevel Diode-Clamped Converters 4.1 Control Requirements and Challenges . . . . . . . . . . . . . . . . . . . . . . 4.2 Review of Multilevel DCCs . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.3 Generalized Model of Multilevel DCCs . . . . . . . . . . . . . . . . . . . . . 4.3.1 Model of Load/Motor/Grid Currents . . . . . . . . . . . . . . . . . . 4.3.2 Model of DC-link Capacitor Voltages . . . . . . . . . . . . . . . . . . 4.3.3 Model of Common-Mode Voltage . . . . . . . . . . . . . . . . . . . . 4.4 Predictive Control of Multilevel Diode-Clamped Converters . . . . . . . . . . 4.4.1 Definition of Cost Function . . . . . . . . . . . . . . . . . . . . . . . 4.4.2 Selection of Weighting Factors . . . . . . . . . . . . . . . . . . . . . . 4.4.3 Selection of Prediction Horizon -h . . . . . . . . . . . . . . . . . . . 4.4.4 Control Algorithm . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.5 Simulation Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . xviii

69 70 72 74 74 78 81 82 82 84 85 86 87

4.6 4.7

4.5.1 Transient Analysis . . . . . . . . . . . . . 4.5.2 Robustness against DC-link Perturbations 4.5.3 Switching Frequency Reduction . . . . . . 4.5.4 Common-Mode Voltage Mitigation . . . . Experimental Results . . . . . . . . . . . . . . . . Conclusion . . . . . . . . . . . . . . . . . . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

. . . . . .

87 88 89 91 94 98 99 100 102 103 103 104 106 107 108 111 112 114 115 116 118 118 119 122 122 126

5 Predictive Current Control of Grid-Tied Diode-Clamped Inverters 5.1 Overview of Grid-Tied Inverters . . . . . . . . . . . . . . . . . . . . . . 5.1.1 Definition of Grid-side Control Variables . . . . . . . . . . . . . 5.1.2 Classical Control Schemes for Grid-Tied Inverters . . . . . . . . 5.1.3 Grid Voltage Orientation . . . . . . . . . . . . . . . . . . . . . . 5.2 Grid-Tied Four-Level Inverter Model . . . . . . . . . . . . . . . . . . . 5.2.1 Modeling of Grid Currents in Synchronous Frame . . . . . . . . 5.2.2 Modeling of DC-link Capacitor Voltages . . . . . . . . . . . . . 5.3 Model Predictive Control . . . . . . . . . . . . . . . . . . . . . . . . . . 5.4 Simulation Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.4.1 Steady-state Analysis . . . . . . . . . . . . . . . . . . . . . . . . 5.4.2 Transient Analysis . . . . . . . . . . . . . . . . . . . . . . . . . 5.4.3 DC-link Dynamics . . . . . . . . . . . . . . . . . . . . . . . . . 5.4.4 Switching Frequency Regulation . . . . . . . . . . . . . . . . . . 5.5 Experimental Implementation and Validation . . . . . . . . . . . . . . 5.5.1 Experimental Setup . . . . . . . . . . . . . . . . . . . . . . . . . 5.5.2 Delay Compensation . . . . . . . . . . . . . . . . . . . . . . . . 5.5.3 Selection of Sampling Time . . . . . . . . . . . . . . . . . . . . 5.5.4 Experimental Results . . . . . . . . . . . . . . . . . . . . . . . . 5.6 Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6 Model Predictive Decoupled Active and Reactive Power Control Tied Diode-Clamped Inverters 6.1 Proposed Control Strategy . . . . . . . . . . . . . . . . . . . . . . . 6.2 Simulation Results . . . . . . . . . . . . . . . . . . . . . . . . . . . 6.2.1 Transient Analysis . . . . . . . . . . . . . . . . . . . . . . . 6.2.2 Steady-state Analysis . . . . . . . . . . . . . . . . . . . . . . 6.2.3 Comparison to Classical VOC . . . . . . . . . . . . . . . . . 6.2.4 Comparison to Lagrange Extrapolation . . . . . . . . . . . . 6.2.5 Capacitor Voltages Balancing . . . . . . . . . . . . . . . . . 6.2.6 Robustness Analysis . . . . . . . . . . . . . . . . . . . . . . 6.3 Experimental Results . . . . . . . . . . . . . . . . . . . . . . . . . . xix

. . . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . . .

for Grid127 . . . . . 128 . . . . . 132 . . . . . 132 . . . . . 134 . . . . . 134 . . . . . 137 . . . . . 139 . . . . . 139 . . . . . 141

6.4

Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 146

7 Predictive Control of Three-Level Boost and NPC Converters Based PMSGWECS 147 7.1 Modeling of Complete WECS . . . . . . . . . . . . . . . . . . . . . . . . . . 149 7.1.1 Grid-Tied NPC Inverter Model . . . . . . . . . . . . . . . . . . . . . 150 7.1.2 Three-Level Boost Converter Model . . . . . . . . . . . . . . . . . . . 151 7.2 Control System for Proposed PMSG-WECS . . . . . . . . . . . . . . . . . . 156 7.2.1 Predictive Control of Three-Level Boost Converter . . . . . . . . . . 156 7.2.2 Predictive Control of NPC Inverter . . . . . . . . . . . . . . . . . . . 158 7.3 Simulation Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 160 7.4 Experimental Implementation and Validation . . . . . . . . . . . . . . . . . 167 7.5 Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 172 8 Predictive Control of Four-Level Converters Based PMSG-WECS 8.1 Configuration and Modeling of Proposed WECS . . . . . . . . . . . . . 8.1.1 Continuous-Time Modeling of Four-Level Inverter . . . . . . . . 8.1.2 Continuous-Time Modeling of Four-Level Boost Converter . . . 8.2 Discrete-Time Modeling and Two-Step Prediction . . . . . . . . . . . . 8.3 Proposed Model Predictive Control Strategy . . . . . . . . . . . . . . . 8.3.1 Control System for Four-Level Boost Converter . . . . . . . . . 8.3.2 Control System for Four-Level Inverter . . . . . . . . . . . . . . 8.4 Simulation Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8.4.1 Steady-state Analysis . . . . . . . . . . . . . . . . . . . . . . . . 8.4.2 Harmonic Analysis . . . . . . . . . . . . . . . . . . . . . . . . . 8.4.3 Switching Frequency Minimization . . . . . . . . . . . . . . . . 8.4.4 Common-Mode Voltage Minimization . . . . . . . . . . . . . . . 8.4.5 DC-link Perturbations . . . . . . . . . . . . . . . . . . . . . . . 8.4.6 Step-Change in Wind Speed Condition . . . . . . . . . . . . . . 8.4.7 Step-Changes in Grid Reactive Power Reference . . . . . . . . . 8.5 Experimental Implementation . . . . . . . . . . . . . . . . . . . . . . . 8.5.1 Experimental Platform . . . . . . . . . . . . . . . . . . . . . . . 8.5.2 Experimental Results . . . . . . . . . . . . . . . . . . . . . . . . 8.6 Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 173 174 174 176 180 183 183 186 189 189 190 192 192 194 195 197 199 199 199 206

. . . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . . .

9 Predictive Control for Low Voltage Ride-Through Enhancement of ThreeLevel Converter Based WECS 207 9.1 State-of-the-art LVRT Enhancement Methods . . . . . . . . . . . . . . . . . 208 9.2 Configuration of the PMSG-WECS . . . . . . . . . . . . . . . . . . . . . . . 209 xx

9.3 9.4

9.5

9.6

9.7 9.8

Storage of Surplus Energy in Turbine-Generator Rotor Inertia . Control System for the PMSG-WECS . . . . . . . . . . . . . . . 9.4.1 Generator-side Converter Controller . . . . . . . . . . . . 9.4.2 Grid-side Inverter Controller . . . . . . . . . . . . . . . . Generation of Reference Control Variables . . . . . . . . . . . . 9.5.1 Normal Operation . . . . . . . . . . . . . . . . . . . . . 9.5.2 LVRT Operation . . . . . . . . . . . . . . . . . . . . . . Simulation Results . . . . . . . . . . . . . . . . . . . . . . . . . 9.6.1 Analysis with Generator-side LVRT Controller Disabled . 9.6.2 Analysis with Generator-side LVRT Controller Enabled . Experimental Results . . . . . . . . . . . . . . . . . . . . . . . . Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

. . . . . . . . . . . .

. . . . . . . . . . . .

. . . . . . . . . . . .

. . . . . . . . . . . .

. . . . . . . . . . . .

. . . . . . . . . . . .

. . . . . . . . . . . .

211 212 212 214 215 215 215 216 216 220 225 230

10 Conclusions 231 10.1 Summary of Major Contributions . . . . . . . . . . . . . . . . . . . . . . . . 232 10.2 Future Works . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 236 A List of Commercial Wind Turbines B System Modeling B.1 Notation of Per-Unit Values . . . B.2 Reference Frame Transformation B.3 Wind Turbine Model . . . . . . . B.4 Phase-Locked Loop (PLL) Model C Performance Assessment Bibliography 237 239 239 240 241 243 244 246

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

xxi

List of Figures
1.1 1.2 1.3 1.4 1.5 1.6 1.7 Global annual and cumulative installed wind power from 1996 to 2012 [source: Global Wind Energy Council (GWEC)]. . . . . . . . . . . . . . . . . . . . . Top 10 countries in the installed wind power capacity. . . . . . . . . . . . . . Evolution in the wind turbine size (: rotor diameter, H: height). . . . . . . Basic configuration of a grid-connected WECS. . . . . . . . . . . . . . . . . Overview of different LVRT profiles. . . . . . . . . . . . . . . . . . . . . . . . State-of-the-art electric generator and power converter configurations for the commercial WECS. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Summary of top 10 wind turbine manufacturers and their market share by Dec. 2012. [source: REN21 and GWEC] (2S/3S = two-/three-stage gearbox, DD = direct-drive). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Classification of full-scale power converters used in Type-4 wind turbines. . . Review of commercial power converters for PMSG-WECS. . . . . . . . . . . Classification of control techniques used for the power converters. . . . . . . Summary of dissertation research directions and objectives. . . . . . . . . . . Next-generation power converters for the MW-MV-PMSG-WECS. . . . . . . Organization of dissertation research. . . . . . . . . . . . . . . . . . . . . . . Classification employed in this chapter for full-scale power converters. . . Classification of back-to-back connected converters. . . . . . . . . . . . . WECS with BTB connected 2L voltage source converters. . . . . . . . . Parallel connected BTB 2L-VSCs and open winding transformer. . . . . . WECS with BTB connected 3L diode-clamped converters. . . . . . . . . WECS with BTB connected 4L diode-clamped converters. . . . . . . . . WECS with BTB connected 3L active neutral point clamped converters. WECS with BTB connected 3L flying capacitor converters. . . . . . . . . WECS with BTB connected current source converters. . . . . . . . . . . WECS with diode rectifier, 2L boost converter and 2L-VSI. . . . . . . . . WECS with diode rectifier, two-channel boost converter and 2L-VSI. . . WECS with diode rectifier, 2L boost converter and 3L-VSI. . . . . . . . . xxii . . . . . . . . . . . . . . . . . . . . . . . . 2 3 4 5 9 10

1.8 1.9 1.10 1.11 1.12 1.13 2.1 2.2 2.3 2.4 2.5 2.6 2.7 2.8 2.9 2.10 2.11 2.12

13 15 15 17 19 19 23 25 26 26 27 30 31 32 32 33 35 35 36

2.13 2.14 2.15 2.16 2.17 2.18 2.19 2.20 2.21 2.22 2.23 2.24 2.25 2.26 2.27 2.28 3.1 3.2 3.3 3.4 3.5 3.6 3.7 3.8 3.9 3.10 3.11 3.12 3.13 4.1 4.2 4.3 4.4 4.5 4.6 4.7

WECS with diode rectifier, 3L-boost converter and 3L-VSI. . . . . . . . . . . WECS with diode rectifier, 4L-boost converter and 4L-VSI. . . . . . . . . . . WECS with diode rectifier, 3L-boost converter and 3L-ANPCI. . . . . . . . . WECS with diode rectifier, 3L-buck converter and CSI. . . . . . . . . . . . . WECS with diode rectifier, 3L-boost converter and multilevel ANPC. . . . . Six-phase machine based WECS with parallel 2L-VSC modules. . . . . . . . Six-phase machine based WECS with parallel 2L-boost + 2L-VSC modules. Series connected 2L-VSRs at generator-side and 3L-VSI at grid-side. . . . . . Series connected 2L boost converters at generator-side and 3L-VSI at grid-side. Series connected diode rectifiers, 3L-boost converter and 3L-VSI at grid-side. Series connected 2L-buck converters at generator-side and CSI at grid-side. . Open winding machine based WECS with multiple 2L VSC modules. . . . . Open winding machine based WECS with cascaded converters. . . . . . . . . BTB connected 3L- and 5L-HB converters based module. . . . . . . . . . . . Back-to-back connected 3L H-bridge converters and MFT based module. . . Diode rectifier, 3L-boost and 5L-HB converter based module. . . . . . . . . . Hysteresis current control scheme for 3- load/motor/grid (L/M/G). . . . . Linear current control scheme using PI regulators and SVM. . . . . . . . . . Sliding mode current control scheme using SVM. . . . . . . . . . . . . . . . . Fuzzy logic current control scheme using SVM. . . . . . . . . . . . . . . . . . ANN based current control scheme. . . . . . . . . . . . . . . . . . . . . . . . Fuzzy logic current control scheme using ANN modulation. . . . . . . . . . . Deadbeat predictive current control with SVM. . . . . . . . . . . . . . . . . Finite control-set model predictive control (FCS-MPC) scheme. . . . . . . . FCS-MPC strategy with one-step prediction horizon. . . . . . . . . . . . . . Overview of cost function definition with primary and secondary objectives. . Delay compensation method­1 using modified one-step prediction horizon. . Delay compensation method­2 using standard two-step prediction horizon. . Delay compensation method­3 using simplified two-step prediction horizon. . Overview of state-of-the-art and proposed solutions for high performance control in MLDCCs. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Per-phase diagram of multi-level diode-clamped converters. . . . . . . . . . . Space vectors generated by the multilevel diode-clamped converter. . . . . . Topology of multi-level diode-clamped converter with RLE load. . . . . . . . Simplified representation of the power circuit model for a 5L-DCC. . . . . . FCS-MPC scheme for multilevel diode-clamped converter. . . . . . . . . . . Prediction of control variables for a 4L-DCC. . . . . . . . . . . . . . . . . . . xxiii

36 37 38 38 39 40 40 41 41 42 43 43 43 44 45 45 50 50 50 50 51 51 51 51 60 61 63 63 63

71 73 74 75 77 82 85

4.8 4.9

Two-step predictive control algorithm for an m-level DCC. . . . . . . . . . . Simulation results during step-change in reference load current. . . . . . . .

86 88 89 90 92 93 95 96 97 98

4.10 Simulation results for dc-link capacitor voltages behavior with and without the weighting factor dc . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.11 Simulation results for switching frequency minimization using the weighting factor swc. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.12 Simulation results for common-mode voltage minimization of odd-level converters using the weighting factor cmv . . . . . . . . . . . . . . . . . . . . . . 4.13 Simulation results for common-mode voltage minimization of even-level converters using the weighting factor cmv . . . . . . . . . . . . . . . . . . . . . . 4.14 Experimental results during step-change in reference to load current. . . . . 4.15 Experimental results for dc-link capacitor voltages behavior with and without the weighting factor dc . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.16 Experimental results for switching frequency minimization using the weighting factor swc. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.17 Experimental results for common-mode voltage reduction using the weighting factor cmv . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.1 5.2 5.3 5.4 5.5 5.6 5.7 5.8 5.9

Configuration of Type-4 WECS with full-scale power converters. . . . . . . . 101 Simplified representation of Type-4 WECS. . . . . . . . . . . . . . . . . . . . 101 Topology of grid-tied 4L-DCI in MV-WECS. . . . . . . . . . . . . . . . . . . 104 Space vector diagram and switching states for a four-level inverter. . . . . . . 105 Proposed model predictive control algorithm for grid-tied four-level inverter. 109 Simulation results during steady-state operation. . . . . . . . . . . . . . . . . 113 Simulation results during transient operation. . . . . . . . . . . . . . . . . . 114 Simulation analysis for dc-link capacitor voltages balancing. . . . . . . . . . 115
 Simulation results for switching frequency variation with respect to i dg and Qg .117

5.10 Comparison of %THD for 4L-inverter with grid-tied and resistive load cases.

117

5.11 Photograph of experimental setup. . . . . . . . . . . . . . . . . . . . . . . . 118 5.12 Prediction of four-level inverter control variables. . . . . . . . . . . . . . . . 119 5.13 Predictive current control and dc-link capacitor voltages balancing algorithm with delay compensation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 120 5.14 Experimental results during steady-state operation. . . . . . . . . . . . . . . 123 5.15 Experimental results during transient operation. . . . . . . . . . . . . . . . . 124 5.16 Experimental results for dc-link capacitor voltages balancing. . . . . . . . . . 125 5.17 Experimental results for switching frequency variation with respect to i dg and  Qg . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 125 xxiv

6.1 6.2 6.3 6.4 6.5 6.6 6.7 6.8 6.9

Proposed decoupled active and reactive power control with dc-link capacitor voltages balancing for a grid-tied 4L-DCI. . . . . . . . . . . . . . . . . . . . 128 Simulation results with dynamic active and reactive power references. . . . . 133 Simulation results for active and reactive powers tracking with classical VOC. 135 Simulation results for active and reactive powers tracking with predictive control.135 Simulation results for inverter line-line voltage and it's FFT with the classical decoupled voltage-oriented control. . . . . . . . . . . . . . . . . . . . . . . . 136 Simulation results for inverter line-line voltage and it's FFT with the proposed predictive control. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 136 Simulation results for phase-a grid current, and it's FFT with the classical decoupled voltage-oriented control. . . . . . . . . . . . . . . . . . . . . . . . 136 Simulation results for phase-a grid current, and its FFT with the proposed predictive control. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 137 Simulation results for step-change in active power with Lagrange extrapolation.138

6.10 Simulation results for step-change in active power with proposed extrapolation.138 6.11 Simulation results for dc-link capacitor voltages balancing with perturbations to the system model. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139 6.12 Simulation results with grid filter parameter variations (CF: changes to filter, and CCF: changes to controller and filter.) . . . . . . . . . . . . . . . . . . . 140 6.13 Proposed predictive power control algorithm with delay compensation. . . . 141 6.14 Experimental results with dynamic active and reactive power references. . . 143 6.15 Experimental results during the step change in active power reference. . . . . 144 6.16 Experimental results for dc-link capacitor voltages balancing with the perturbations in system model. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 144 6.17 Experimental analysis with grid filter parameter variations (CF: changes to filter, and CCF: changes to controller and filter). . . . . . . . . . . . . . . . . 145 7.1 7.2 7.3 7.4 7.5 7.6 7.7 7.8 Configuration of TLB-NPC converters based medium voltage PMSG-WECS. 148 Simplified power circuit of the dc-dc TLB converter stage. . . . . . . . . . . 152 Modes of operation for three-level boost converter. . . . . . . . . . . . . . . . 152 Proposed model predictive control scheme for three-level boost and NPC converter based PMSG-WECS. . . . . . . . . . . . . . . . . . . . . . . . . . . . 155 Simulation results with step change in wind speed and programmed changes in reactive power reference (first part of figure). . . . . . . . . . . . . . . . . 162 Simulation results with step change in wind speed and programmed changes in reactive power reference (second part of figure). . . . . . . . . . . . . . . . 163 Simulation results for capacitor voltages balancing with a resistor across Cdc1 . 164 Simulation results for NPC fsw minimization with BTB NPC converters. . . 166 xxv

7.9 Simulation results for NPC fsw minimization with proposed topology. . . . . 7.10 Block diagram of the experimental setup. . . . . . . . . . . . . . . . . . . . . 7.11 Proposed predictive control algorithm with delay compensation for: (a) TLB converter, and (b) NPC inverter. . . . . . . . . . . . . . . . . . . . . . . . . 7.12 Experimental results for programmed changes in m and Q g. . . . . . . . . . 7.13 Experimental results for capacitor voltages balancing with a resistor across Cdc1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7.14 Experimental results for inverter switching frequency minimization. . . . . . 8.1 8.2 8.3 8.4 8.5 8.6 8.7 8.8 8.9 8.10 8.11 8.12 8.13 8.14 8.15 8.16 8.17 8.18 8.19 8.20 8.21 8.22 9.1 9.2

166 167 169 170 171 171

Configuration of proposed high power PMSG wind energy system. . . . . . . 175 Operating modes for the four-level boost converter: (a) mode-I, (b) mode-II, (c) mode-III, (d) mode-IV, and (e) mode-V. . . . . . . . . . . . . . . . . . . 177 Representation of virtual resistors and the inverter. . . . . . . . . . . . . . . 179 Prediction of control variables using one-step prediction. . . . . . . . . . . . 182 Prediction of control variables using modified two-step prediction . . . . . . . 182 Block diagram of the complete control system. . . . . . . . . . . . . . . . . . 184 Proposed predictive control scheme for 4L-converter based PMSG-WECS. . . 185 Proposed two-step predictive control algorithm for: (a) four-level boost converter, and (b) four-level diode-clamped inverter. . . . . . . . . . . . . . . . 187 Comparison of simulation results during rated wind speed condition using two different prediction methods. . . . . . . . . . . . . . . . . . . . . . . . . . . . 191 Simulation FFT analysis of inverter line-line voltage and grid currents using two different prediction methods. . . . . . . . . . . . . . . . . . . . . . . . . 191 Simulation results for grid-tied inverter switching frequency minimization. . . 193 Simulation results for grid-tied inverter common-mode voltage minimization. 193 Simulation results with step-connection of capacitor Cext across Cdc2 . . . . . 194 Simulation results with step change in wind speed from 12 m/s to 9.6 m/s. . 196 Simulation results with step-changes in grid reactive power reference. . . . . 198 Photographs of the experimental setup. . . . . . . . . . . . . . . . . . . . . . 200 Comparison of experimental results during rated wind speed condition. . . . 201 Experimental results for grid-tied inverter switching frequency minimization. 201 Experimental results for grid-tied inverter common-mode voltage minimization.203 Experimental results with step-connection of capacitor Cext across Cdc2 . . . . 203  Experimental results with step change in m from 1.0 to 0.8 p.u.. . . . . . . 204 Experimental results with step-changes in grid reactive power reference. . . . 205 Configuration of three-level boost converter and NPC inverter based MW-MV PMSG-WECS. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 210 Proposed model predictive controller for the generator-side converter. . . . . 213 xxvi

Proposed model predictive controller for grid-side inverter. . . . . . . . . . . Generation of reference control variables during normal and LVRT operation. Simulation results during three-phase grid voltage dip with the generator-side LVRT controller disabled (Part­I). . . . . . . . . . . . . . . . . . . . . . . . 9.6 Simulation results during three-phase grid voltage dip with the generator-side LVRT controller disabled (Part­II). . . . . . . . . . . . . . . . . . . . . . . . 9.7 Simulation results during three-phase grid voltage dip with the generator-side LVRT controller enabled (Part-I). . . . . . . . . . . . . . . . . . . . . . . . . 9.8 Simulation results during three-phase grid voltage dip with the generator-side LVRT controller enabled (Part-II). . . . . . . . . . . . . . . . . . . . . . . . 9.9 Simulation result for input dc voltage vin during three-phase grid voltage dip with the generator-side LVRT controller enabled and Cin = 820 F. . . . . . 9.10 Experimental setup. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9.11 Experimental results during three-phase grid voltage dip with the generatorside LVRT controller enabled (Part-I). . . . . . . . . . . . . . . . . . . . . . 9.12 Experimental results during three-phase grid voltage dip with the generatorside LVRT controller enabled (Part-II). . . . . . . . . . . . . . . . . . . . . . B.1 B.2 B.3 B.4 MATLAB/Simulink model of wind turbine. . . . . . . . . . . MATLAB/Simulink model of pitch control system. . . . . . Simplified model for grid voltage angle estimation. . . . . . . Standard SRF-PLL model for grid voltage angle estimation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

9.3 9.4 9.5

213 214 218 219 221 222 224 225 227 228 242 242 243 243

xxvii

List of Tables
1.1 1.2 1.3 1.4 1.5 2.1 2.2 2.3 3.1 3.2 4.1 4.2 4.3 4.4 4.5 4.6 4.7 4.8 5.1 5.2 5.3 5.4 6.1 6.2 6.3 Advantages and disadvantages of wind generators [source: J. al. (2007)] . . . . . . . . . . . . . . . . . . . . . . . . . . . . Voltage classifications by region [source: NREL (2012)] . . . Summary of national grid codes and different LVRT profiles Summary of four types of wind turbine configurations . . . . List of few commercial PMSG wind turbines . . . . . . . . . A. . . . . . . . . . . Baroudi et. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6 7 9 14 16 29 33 34 66 67 72 72 79 83 87 91 94 95 105 111 111 122

Summary of LV and MV operation for a 6 MW wind turbine . . . . . . . . . Comparison of BTB connected converters for megawatt wind turbines . . . . Summary of active and passive generator-side converters for WECS . . . . . Coefficients for two-samples ahead (k + 2) Lagrange extrapolation method . Comparison between classical linear control and FCS-MPC . . . . . . . . . . Components, switching states and voltage vectors count for MLDCC . . . . MLDCC terminal voltages versus switching states (x = a, b, c) . . . . . . . . Relationship between switching states and coefficients of capacitor currents for a 5L-DCC (x = a, b, c) . . . . . . . . . . . . . . . . . . . . . . . . . . . . Calculation of number of switch changes for MLDCC (x = a, b, c) . . . . . . Parameters of the MLDCC and controller . . . . . . . . . . . . . . . . . . . Simulation analysis during fsw minimization . . . . . . . . . . . . . . . . . . Computational burden with MLDCCs . . . . . . . . . . . . . . . . . . . . . Experimental analysis during fsw minimization . . . . . . . . . . . . . . . . . Switching states and inverter terminal voltages . . . . Grid-tied four-level inverter and controller parameters Summary of simulation steady-state analysis . . . . . Summary of experimental steady-state analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

Grid-tied four-level inverter parameters . . . . . . . . . . . . . . . . . . . . . 132 Steady-state analysis with simulation results . . . . . . . . . . . . . . . . . . 134 Steady-state analysis with experimental results . . . . . . . . . . . . . . . . . 142 xxviii

7.1 7.2 8.1 8.2 9.1

Switching states and NPC inverter terminal voltages (x = a, b, c) . . . . . . . 150 Parameters of the proposed wind energy conversion system . . . . . . . . . . 160 Summary of four-level boost converter switching states . . . . . . . . . . . . 176 Parameters of the proposed power conversion system . . . . . . . . . . . . . 188 Parameters of the proposed PMSG-WECS . . . . . . . . . . . . . . . . . . . 217

A.1 Future development of full-scale converters based MW wind turbines . . . . 237 A.2 List of commercial wind turbines using full-scale converters . . . . . . . . . . 238

xxix

Glossary of Acronyms and Symbols

Abbreviations
3L Three-Level 4L Four-Level AC Alternating Current ADC Analog-to-Digital Conversion ANPCC Active Neutral-Point Clamped Converter ANPCI Active Neutral-Point Clamped Inverter ANPCR Active Neutral-Point Clamped Rectifier BC Boost Converter BTB Back-to-Back Connected CCF Changes to Controller and Filter CCM Continuous Current Mode CF Changes to Filter CHB Cascaded H-Bridge CMOS Complementary Metal-Oxide-Semiconductor CMV Common-Mode Voltage CSC Current Source Converter CSI Current Source Inverter CSR Current Source Rectifier DAC Digital-to-Analog Conversion DC Direct Current DCC Diode-Clamped Converter DCI Diode-Clamped Inverter DCM Discontinuous Current Mode DCR Diode-Clamped Rectifier DD Direct-Driven xxx

DFIG DSO DSP DTC EMF FC FCC FCI FCR FCS-MPC FFT FOC FPGA FRT FSC GB GCR GCT GTI HB HBI HBR IG IGBT IGCT IM I/O IPD LCI LV LVRT ML MLDCC MPC MPP MPPT

Doubly-Fed Induction Generator Distribution System Operator Digital Signal Processor Direct Torque Control Electro-Motive Force Flying Capacitor Flying Capacitor Converter Flying Capacitor Inverter Flying Capacitor Rectifier Finite Control-Set Model Predictive Control Fast Fourier Transform Field Oriented Control Field-Programmable Gate Array Fault Ride-Through Full-Scale Converter Gear Box Grid-Code Requirements Gate-Controlled Thyristor Grid-Tied Inverter H-Bridge H-Bridge Inverter H-Bridge Rectifier Induction Generator Insulated Gate Bipolar Transistor Integrated Gate-Commutated Thyristor Induction Machine Input/Output In-Phase Disposition Load Commutated Inverter Low Voltage Low Voltage Ride-Through Multi-Level Multi-Level Diode-Clamped Converter Model Predictive Control Maximum Power Point Maximum Power Point Tracking

xxxi

MSC MV MW NPC OTSR PC PCC PE PF PPC PVC PI PLL PMSG PWM RPG RTI SCIG SGCT SHE SRF SS SVM TLB THD TSO TTL UPF VOC VSC VSI VSR WECS WRIG WRSG WT

Machine-side Converter Medium Voltage Megawatt Neutral-Point Clamped Optimal Tip-Speed Ratio Predictive Control Predictive Current Control Power Electronics Power Factor Predictive Power Control Predictive Voltage Control Proportional-Integral Phase-Locked Loop Permanent Magnet Synchronous Generator Pulse Width Modulation Reactive Power Generation Real-Time Interface Squirrel Cage Induction Generator Symmetric Gate-Controlled Thyristor Selective Harmonic Elimination Synchronous Reference Frame Steady-state Space Vector Modulation Three-Level Boost Total Harmonic Distortion Transmission System Operator Transistor-Transistor Logic Unity Power Factor Voltage Oriented Control Voltage Source Converter Voltage Source Inverter Voltage Source Rectifier Wind Energy Conversion Systems Wound Rotor Induction Generator Wound Rotor Synchronous Generator Wind Turbine

xxxii

Voltage Quantities
vg vgl vag , vbg , vcg vdg , vqg van , vbn , vcn vaN , vbN , vcN vdi , vqi vs vsl vas , vbs , vcs vds , vqs ea , eb , ec vdc  vdc vcj Grid rms phase-neutral voltage (V) Grid rms line-line voltage (V) Three-phase grid voltages (V) d and q -axis grid voltages (V) Three-phase inverter voltages with respect to grid/load neutral (V) Three-phase inverter voltages with respect to negative dc-rail (V) d and q -axis inverter voltages (V) Generator rms phase-neutral voltage (V) Generator rms line-line voltage (V) Three-phase generator voltages (V) d and q -axis generator voltages (V) Three-phase motor back emf (V) Net dc-bus voltage (V) Reference dc-bus voltage (V) Voltage across dc-link capacitors j = 1, 2, · · · (V)

Current Quantities
ig iag , ibg , icg idg , iqg idc icj Grid rms current (A) Three-phase grid currents (A) d and q -axis grid currents (A) DC current (A) Current through dc-link capacitors j = 1, 2, · · · (A)

Power Quantities
Sg Pg Qg Q g PM Pm Ss Ps Qs Pdc Grid apparent power (VA) Grid active power (W) Grid reactive power (VAR) Reference grid reactive power (VAR) Power output of wind turbine (W) Mechanical input power to wind generator (W) Wind generator apparent power output (VA) Wind generator active power output (W) Wind generator reactive power output (VAR) Power stored in the dc-link elements (W) xxxiii

Torque Quantities
TM Tm Te Te Torque output of wind turbine (N.m) Mechanical input torque to wind generator (N.m) Electromagnetic torque of wind generator (N.m) Reference electromagnetic torque for wind generator (N.m)

RLC Quantities
Rg Rdc Lg Ld , Lq Ldc Cdcj Cin Internal resistance of grid-side inductive filter () Internal resistance of dc inductive filter () Inductance of grid-side harmonic filter (H) d and q -axis generator inductance (H) Inductance of dc filter (H) Capacitance of dc-link capacitors j = 1, 2, · · · (F) Capacitance of input dc-link capacitor (F)

Frequency and Time Quantities
fg fs fsw g s m g m Ts Grid frequency (Hz) Generator frequency (Hz) Device switching frequency of power converter (Hz) Grid angular frequency (rad/s) Generator electrical angular frequency (rad/s) Generator mechanical angular frequency (rad/s) Grid voltage angle (rad) Generator mechanical position (rad) Controller sampling time (s)

Generator Quantities
J H P Fs PP nm Moment of inertia (kg.m2 ) Inertia time constant (s) Power factor Number of pole pairs Generator speed (rpm)

xxxiv

Wind Turbine Quantities
Rgb  rT Cp T nM vw Gearbox ratio Air density (kg.m2 ) Turbine rotor radius (m) Turbine power coefficient Turbine tip-speed ratio Turbine speed (rpm) Wind speed (m/s)

Predictive Controller Quantities
h g s k k-1 k+1 t dc swc cmv
d dt

Sx Sjx swcx P, N

Prediction horizon Cost function Laplace operator (when not used as a subscript) Discrete-time present sampling instant Discrete-time past sampling instant Discrete-time future sampling instant Continuous-time Weighting factor for dc-link capacitor voltages balancing Weighting factor for switching frequency reduction Weighting factor for common-mode voltage reduction Derivative operator Level of voltage vector of phase x = a, b, c Switching states of phase x = a, b, c, j = 1, 2, · · · Number of switch changes in inverter phase x = a, b, c Positive and negative dc bus of a power converter

Vector Quantities
vg ig vi vs is vc ic Grid voltage vector Grid current vector Inverter voltage vector Generator voltage vector Generator current vector dc-link voltage vector dc-link current vector [vag vbg vcg ]T [iag ibg icg ]T [van vbn vcn ]T [vas vbs vcs ]T [ias ibs ics ]T [vc1 vc2 · · · ]T [ic1 ic2 · · · ]T

xxxv

Base Quantities
vbg ibg vbgp ibgp Zbg Lbg Cbg vbs ibs vbsp ibsp Zbs Lbs Cbs bs Grid-side base voltage (V) Grid-side base current (A) Grid-side peak base voltage (V) Grid-side peak base current (A) Grid-side base impedance () Grid-side base inductance (H) Grid-side base capacitance (F) Generator-side base voltage (V) Generator-side base current (A) Generator-side peak base voltage (V) Generator-side peak base current (A) Generator-side base impedance () Generator-side base inductance (H) Generator-side base capacitance (F) Generator-side base flux-linkage (Wb)

Superscripts
p e x ^  Predicted quantity Estimated quantity Estimation of x Reference quantity

Subscripts
a, b, c d, q ,  R op g dc s, m T, M Natural frame quantities Synchronous frame quantities Stationary frame quantities Rated quantity Optimal quantity Grid-side quantity dc quantity Generator-side quantity Turbine quantity

xxxvi

Chapter 1 Introduction
Due to depleting fossil fuels and environmental concerns, electricity production from renewable energy sources has attracted great attention in recent years. By 2012, the power production from renewable energy sources worldwide exceeded 1470 gigawatt (GW) representing approximately 19 % of global energy consumption [1]. Among all the renewable energy sources, wind energy is increasingly becoming mainstream and competitive with conventional sources of energy. This success is mainly propelled by technological advancements, cost reduction and government incentive programs [2]. As of 2012, approximately 83 countries are using wind energy on a commercial basis to generate electricity [1]. The electricity production from wind turbines started during the 1980's. Over the past three decades, the size of wind turbines has steadily increased and currently reached a level of 7.5 megawatt (MW) per unit [3]. Due to the rapid integration of wind power into the electric grid, many concerns emerged related to the stable and secure operation of the existing electric power system. The grid codes have been updated and enforced in many countries on the grid-connection of large-scale wind turbines or wind farms. The power electronic converters have been used in commercial wind turbines since the beginning of grid-connected operation, and this technology has changed dramatically over the past 30 years [4]. Since the 1980's, various combinations of wind generators and power electronic converters have been developed in commercial wind turbines to achieve fixedspeed, semi-variable and full-variable-speed operation. The latter has emerged as a successful configuration to increase wind energy conversion efficiency, improve grid power quality and to meet the grid codes. The power converter and its control are very crucial in the successful and efficient operation of variable-speed wind turbines. 1

In this dissertation, two novel power converter topologies have been proposed aimed at wind turbines rated at MW-level. The proposed power conversion systems were designed by combining the best qualities of existing solutions from the commercial wind turbine manufacturers. A qualitative analysis in terms of cost, weight, complexity, reliability and efficiency was carried out by comparing the proposed configurations with the existing technologies. To achieve high performance operation for the proposed converters based variable-speed wind turbines, an advanced control system founded on a finite control-set model predictive strategy is proposed. The theoretical analysis, discrete-time modeling, control scheme development and real-time implementation have been investigated in detail. The organization of this Chapter is as follows: the overview of Wind Energy Conversion System (WECS) is given in Section 1.1 and the motivation for the Dissertation research is outlined in Section 1.2. The objectives of this Dissertation are presented in Section 1.3. Finally, in Section 1.4, the outline of the Dissertation is summarized.

1.1

Overview of Wind Energy Conversion Systems

In this section, the installed wind power capacity, global perspectives of WECS, evolution in the increase of turbine power rating, major components of grid-connected WECS, classification of WECS operating voltages, overview of grid code requirements and commercial configurations of WECS are discussed in detail.
300 250 200 158.9 150 120.6 100 73.9 50 0 6.1 7.6 23.9 10.2 13.6 17.4 31.1 39.4 47.6 59.1 93.9 Cumulative Annual 198.0 238.1 282.6

Installed Capacity (GW)

1996 1997 1998 1999 2000 2001 2002 2003 2004 2005 2006 2007 2008 2009

2010 2011 2012

Year

Figure 1.1: Global annual and cumulative installed wind power from 1996 to 2012 [source: Global Wind Energy Council (GWEC)].

2

1.1.1

Installed Wind Power Capacity and Growth Rate

The annual and cumulative installed wind power capacity worldwide is shown in Fig. 1.1 [5]. The cumulative installed capacity increased exponentially from 6100 MW in 1996 to 282.6 GW by 2012. It was anticipated on a moderate scale that the cumulative wind capacity would reach 760 GW by 2020 [1]. In 2012, approximately 45 GWs of new wind power was installed which represents investments of about e56 billion [5]. The wind energy industry demonstrated an excellent growth rate of more than 19 % by the end of 2012. The technological advancements in terms of wind turbine design, generator and power converters are some of the key reasons behind this impressive growth rate.

Rest of the world 14.1 % PR China 26.7 % Portugal 1.6 % Canada 2.2 % Italy 2.9 % UK 3.0 % India 6.5 % Spain 8.1 % Germany 11.1 %

Rest of the world 15 % USA 29.3 % Romania 2.1 % Canada 2.1 % Brazil 2.4 % Spain 2.5 % Italy 2.8 % UK 4.2 % India 5.2 %

France 2.7 %

USA 21.2 %

PR China 28.9 %

Germany 5.4 %

100 % = 282,587 MW

100 % = 44,799 MW

(a) Cumulative capacity (by Dec. 2012)

(b) New capacity (Jan.­Dec. 2012)

Figure 1.2: Top 10 countries in the installed wind power capacity.

1.1.2

Global Perspective of WECS

The top 10 countries in the cumulative and annual installed wind power capacity are shown in Fig. 1.2 [1,5]. The Chinese market maintained its top position in global cumulative installed wind power by tripling its capacity from 25.8 GW in 2009 to 75.3 GW by the end of 2012. The USA gained the top spot in 2012 by adding approximately 13.1 GWs of new wind power from 190 projects. 3

Approximately 24 countries have more than 1 GW cumulative installed wind power capacity, including 16 in Europe, 4 in the Asia-Pacific area (China, India, Japan, Australia), 3 in North America (Canada, Mexico, US) and 1 in Latin America (Brazil) [5]. Some countries have the highest penetration by wind power. For example, in Denmark more than 30 % of electricity consumption is covered from wind energy [4]. Canada is ranked top 9th in both cumulative and new installed capacity. The cumulative installed wind power capacity in Canada steadily increased from 137 MW in 2000 to 6.2 GW by the end of 2012. More than 2000 MW wind power has been installed in Ontario which accounts for 3 % of the province's electricity demand. Canada has ambitious plans to supply 20 % of net electricity consumption from wind by 2025.

1.1.3

Evolution of Megawatt WECS

The power output of a wind turbine is proportional to the square of a rotor diameter and a cubic of wind speed (refer to B.7). The large turbines can capture higher wind power with lower installation and maintenance costs compared to the group of small turbines. Owing to this fact, the size of commercial wind turbines has exponentially increased over the past 30 years as demonstrated in Fig. 1.3. The turbine size increased from 50 kW in 1980 to 7.5 MW in 2010 [2, 3, 6]. It is anticipated that 10-15 MW turbines will be developed in the near future with rotor diameters exceeding 150 m, which is approximately twice the length of a Boeing 747 airplane. The off-shore wind turbines are also gaining more attention now-a-days because the power production can be increased with the help of stronger and steady wind.
Boeing 747

1980 1985

1990 1995 Statue

2000

of 2MW 50kW 100kW 500kW 800kW  15m  20m  40m  50m Liberty  80m H 24m H 43m H 54m H 80m H 92m H 104m

2005 5MW  124m H 114m

2010 7.5MW  126m H 138m

London Gherkin H 180m

2015 10MW  145m H 180m

2020 15-20MW  150-200m H 200-250m

Figure 1.3: Evolution in the wind turbine size (: rotor diameter, H: height).

4

1.1.4

Major Components of Grid-Connected WECS

The basic configuration of grid-connected MW-WECS is depicted in Fig. 1.4. The WECS is composed of several components that convert wind kinetic-energy into electric-energy in a controlled, reliable and efficient manner. The major components of a WECS can be broadly classified as mechanical and electrical. The mechanical components include tower, nacelle, rotor blades, rotor hub, gearbox, pitch drives, yaw drives, wind speed sensors, drive-train and mechanical brakes. The electrical components include electric generator, power electronic converter, generator-side harmonic filter, grid-side harmonic filter, step-up transformer and three-phase grid (collection-point). The wind kinetic-energy is first converted to mechanical-energy with the help of rotor blades. The tower, nacelle and rotor hubs provide mechanical support to the rotor blades. The kinetic to mechanical energy conversion efficiency depends on many factors such as the shape of rotor blades, angle of blades, wind speed velocity, air density, etc. The wind velocity and direction are measured with the help of sensors, and a yaw drive is used to move the rotor blades along with nacelle towards the wind to extract the maximum possible energy. When the wind speed is more than the rated value, the pitch drives are used to change the angle of blades such that the electric power output is limited to the rated value. The MW wind turbines usually run at very low speed (typically 6-20 rpm) and high torque [2, 6]. An electric generator is used to convert rotational mechanical-energy into electric-energy. Many different wind generators such as the squirrel-cage induction generator (SCIG), wound rotor induction generator (WRIG), doubly-fed induction generator (DFIG), permanent magnet synchronous generator (PMSG) and wound rotor synchronous generator (WRSG) have
Wind Turbine

SCIG WRIG/DFIG

Gear Box

PMSG WRSG Wind Generator Generator-side Harmonic Filter Power Electronic Converter

Step-up Transformer Grid-side Harmonic Filter

Three-Phase Grid

Figure 1.4: Basic configuration of a grid-connected WECS.

5

been developed over the past 30 years. The main features and disadvantages of each of these generators is summarized in Table 1.1. The IG's usually operate at high rotational speeds, while the SG's can operate at low, medium or high speeds. To couple the low-speed, high-torque turbine shaft with the highspeed, low-torque IG/SG-shaft, a multi-stage (usually three-stage) gearbox is used. The gearbox presents with several serious issues such as high initial cost, high audible noise, extensive wear and tear, reduced life span, reduced efficiency and need for regular maintenance [2, 3]. The elimination of the gearbox (often referred to as gearless or direct-drive technology) helps to overcome the aforementioned problems, especially in off-shore wind turbines [7]. In recent years, many turbine manufacturers have used direct-drive technology in their commercial products. By matching the generator speed with the wind turbine speed, the need for the gearbox can be eliminated. In order to achieve lower operational speed, the generator needs to be equipped with a large number of poles, which is a feasible solution with SG's. In accommodating the large number of poles, the stator radius becomes 6 times larger and 4.5 times heavier compared to the three-stage gearbox based SCIG/WRIG/DFIG [2, 3, 8, 9]. To make a compromise between the high-speed and low-speed operation, a medium-speed SG can be used with the help of single-stage gear box. The list of few commercial turbines along with the gearbox details are given in Appendix A.

Table 1.1: Advantages and disadvantages of wind generators [source: J. A. Baroudi et. al. (2007)]
Generator SCIG Advantages · Simple and rugged in construction · Lower initial and maintenance cost · Lower torque oscillations · Widely available for MW application · Reduced converter cost · Reduced losses and improved efficiency · Flexible reactive power compensation · Independent active and reactive power control · High torque operation can be achieved · Eliminates the need for gearbox · High power density with simple design · High torque operation can be achieved · Eliminates the need for slip rings, excitation and gearbox · Lower maintenance cost · Lower rotor losses and high efficiency Disadvantages · Requires reactive power compensation · Large in-rush current during grid connection · Requires gearbox · Increased losses and control complexity · High capital and maintenance cost · Sip rings are sensitive and need maintenance · Susceptible to grid disturbances · High capital and maintenance cost · Requires additional excitation circuit · Huge weight if used as direct-drive · High capital cost due to PMs · Possible demagnetization of PMs · High weight if used as direct-drive

WRIG/ DFIG WRSG

PMSG

6

The generator output voltage and frequency change with respect to the wind speed. The generator can be directly coupled to the grid or it can be interfaced through a power electronic converter. As shall be detailed in Section 1.1.7, different combinations of electric generators and power electronic converters can be used to form a wide variety of WECS configurations. The switching harmonics are inevitable when using power converters, and to solve this issue, harmonic filters are used in generator- and grid-side converters. The harmonic filter on the generator side helps to reduce harmonic distortion of the generator currents and voltages. This leads to a reduction in harmonic losses incurred in the generator's magnetic core and winding. The harmonic filter in the grid-side converter helps to meet strict harmonic requirements specified by the grid codes [2, 10]. The output of the grid-side harmonic filter is connected to a three-phase grid (collectionpoint) through a step-up transformer. The regional classification of WECS operating voltages will be presented in Section 1.1.5. By operating the power electronic converter at collectionpoint voltage level, the need for the step-up transformer can be avoided.

1.1.5

Classification of WECS Operating Voltages

The definition of WECS operating voltages in the North American and European market is summarized in Table 1.2 [11]. These operating voltages are further classified according to low voltage (LV) and medium voltage (MV) operation. Due to the participation of European manufacturers in North America and vice versa, these regional classifications are becoming less important [11]. The North American collection-points are rated at 6.9/12.47/13.8/34.5 kV, while European collection-points are designed for 6.6/11/22/33 kV. The commercial wind turbines can be connected to the transmission lines through step-up transformers irrespective of the regional voltage classes. Table 1.2: Voltage classifications by region [source: NREL (2012)]
Region Standard Voltage Class Low Voltage (< 1000 V) · 220, 400, 690 V Medium Voltage (1 - 35 kV) · 3.3, 6.6, 11, 22, 33 kV Low Voltage (< 600 V) · 208, 120/240, 480, 575 V Medium Voltage (600 V-35 kV) · 2.4, 4.16, 6.9, 12.47, 13.8, 21, 34.5 kV

Europe

IEC 60038

North America

ANSI C84.1

7

1.1.6

Grid Code Requirements

Due to the rapid development of wind power generation worldwide and its integration into the existing electric power system, many specific technical requirements often called as "grid codes" have been developed and regularly updated [4, 12­15]. The transmission and distribution system operators (TSOs and DSOs) of various regions and countries have defined grid codes based on the experience acquired through the operation of their power systems. These grid codes are based on the regional and geographical conditions, and they vary from one utility operator to another, and from one country to another [2]. These grid codes usually refer to large-scale wind turbines/farms which are connected to MV transmission networks [12]. These codes stipulate that despite the fluctuating and unpredictable nature of wind energy, the large wind turbines/farms should behave as active power generation units similar to the conventional power plants [4]. The main elements in grid codes include active/reactive power regulation, frequency/voltage control, power factor control, power quality, low voltage ride-through (LVRT) operation and system protection. The correct interpretation of these codes is crucial for wind turbine manufacturers as well as utility operators [16]. The grid disturbances, such as three-phase short-circuit faults, cause severe voltage drop/dips which might lead to disconnection of large-scale wind power generation units. The sudden disconnection of generation units stimulates instability of the utility network. The grid codes have dictated some special requirements such as LVRT operation to overcome the aforementioned scenario. Among all the grid codes, the LVRT, also called fault ride-through, is the major concern for the wind turbine/ power converter manufacturers. According to LVRT requirements, during grid faults, the WECS should remain connected to the grid regardless of the turbine/generator/converter configuration being used, and must supply reactive power to help the grid to recover from the voltage dip. The TSOs and DSOs of diverse countries issued different LVRT profiles [13] as shown in Fig. 1.5. These profiles can be broadly classified into six different categories based on depth and duration of the grid voltage dips as summarized in Table 1.3. Despite their different shapes, they all share a common purpose and background, i.e., to keep the electric power system stable and secure during the grid fault conditions. Among all the LVRT profiles, the German Transmission and Distribution Utility (E.ON) regulation is likely to set the standard [17]. According to this code, the LVRT function should start when the grid voltage 8

falls below 90 % of its nominal value. Recently considerable research has been carried out addressing this issue [18­23]. Apart from the LVRT operation, another important requirement for WECS is that it should perform "reactive power control" similar to the conventional power plant. Many reactive power profiles are defined by diverse TSOs similar to the LVRT profiles [4, 12­15]. As an example, according to Danish grid code, when the WECS delivers rated (1.0 p.u.) active power, it should be able to supply ± 0.33 p.u. reactive power to support grid voltage. This case implies that the WECS should be able to adjust the grid power factor anywhere from 0.95 lagging to 0.95 leading when it delivers rated active power. This requirement can be easily fulfilled by properly designing the grid-side converter [2].
v0 v1 Grid voltage % v2 v3 v4 v5 0 tv5 tv4 tv3 tv2 Time (ms) tv1 tv0 A F E C B D

Figure 1.5: Overview of different LVRT profiles.

Table 1.3: Summary of national grid codes and different LVRT profiles
Grid voltages ( %) Pattern Country Denmark TSO Ireland E. ON Germany A USA AESO Alberta (Canada) IESO Ontario (Canada) B* C D E Spain Italy Great Britain DSO Ireland v0 100 100 100 100 100 100 100 100 100 100 v1 75 90 90 90 90 - 95 90 90 90 v2 NA NA NA NA NA NA 80 75 85 80 v3 NA NA NA NA NA NA NA NA 80 30 v4 NA NA NA NA NA NA NA NA NA NA v5 25 15 0 15 15 15 20 20 15 15 tv5 100 625 150 625 625 625 500 500 140 625 tv4 NA NA NA NA NA NA NA NA NA NA Time (ms) tv3 NA NA NA NA NA NA NA NA 1200 1000 tv2 NA NA NA NA NA NA 1000 800 2500 2600 tv1 750 2800 1500 2800 3000 - 15000 2000 3000 2800 tv0 10000 - - - - - - - - -

F Hydro Quebec (Canada) 100 90 85 75 25 0 150 1000 NA 2000 3000 - NA = Not applicable, - = Not available, * = same as A, but, with different slopes during tv5 to tv2 , and tv2 to tv1

9

Wind Turbine SCIG Bypass Switch Step-up Transformer

Three-Phase Grid

Gear Box

Soft Starter

PF Compensator

(a) Type-1: Fixed-speed (± 1 %) WECS with SCIG
Wind Turbine WRIG Bypass Switch Step-up Transformer Three-Phase Grid

Soft Starter Gear Box Variable Resistor

PF Compensator

(b) Type-2: Semi variable-speed (± 10 %) WECS with WRIG
Wind Turbine DFIG Step-up Transformer Three-Phase Grid

Gear Box Reduced Capacity Power Converter

(c) Type-3: Semi variable-speed (± 30 %) WECS with DFIG
Wind Turbine SCIG Step-up Transformer PMSG

Three-Phase Grid

Gear Box

100 % Capacity Power Converter WRSG

(d) Type-4: Full variable-speed (0­100 %) WECS with SCIG or PMSG or WRSG

Figure 1.6: State-of-the-art electric generator and power converter configurations for the commercial WECS.

10

1.1.7

Commercial Configurations of WECS

The major electrical components in WECS are the generator and power electronic converter. As shown in Fig. 1.6, using different designs and combinations with these two components, a wide variety of WECS configurations can be achieved such as [6, 8, 24­26]: · Type-1: SCIG based WECS with ± 1 % speed-range · Type-2: WRIG based WECS with ± 10 % speed-range · Type-3: DFIG based WECS with ± 30 % speed-range · Type-4: PMSG/WRSG/SCIG based WECS with 0­100 % speed-range A fixed-speed SCIG-based WECS without power converter interface (Type-1 turbine) is illustrated in Fig. 1.6(a), where the generator is connected to the grid through a soft starter and step-up transformer [6, 27]. The generator speed varies within 1 % range at different wind speeds, and thus this configuration is called fixed-speed WECS. A gearbox is normally required to match the speed difference between the turbine and generator. After the start-up procedure, the soft-starter is bypassed by a switch, and the system essentially works without any power converter. The SCIG draws reactive power from the grid and to compensate for this, three-phase capacitor banks are usually employed [28]. This configuration features simplicity, low initial costs, and reliable operation. The major drawbacks include: (i) lower wind energy conversion efficiency, (ii) changes in the wind speed are reflected to the grid, and (iii) the grid faults cause severe stress on the mechanical components of the wind turbine [29]. The fixed-speed wind turbines are equipped with additional hardware, such as STATCOM, to comply with the grid codes [30]. Despite its drawbacks, this configuration has been accepted by the wind industry and commercial solutions are available in MW range such as (i) Vestas V82, 1.65 MW and (ii) Siemens SWT 2.3-101, 2.3 MW [2]. The variable-speed operation of the wind turbine increases the energy conversion efficiency, and reduces mechanical stress caused by wind gusts, reduces the wear-and-tear of gearbox and bearings, reduces the maintenance requirements, and increases the life cycle. The semi variable-speed WECS using WRIG and partial rated (10 %) power converter is shown in Fig. 1.6(b) (Type-2 turbine). The change in the rotor resistance affects the torque/speed characteristic of the generator, enabling variable-speed operation of the turbine, and this configuration is often called Optislip control [31]. The rotor resistance is 11

normally made adjustable by a power converter composed of a diode-rectifier and chopper [32, 33]. The speed adjustment range is typically limited to about ± 10 % of its rated speed. With variable-speed operation, the system can capture more power from the wind, but also has energy losses in the rotor resistance. This configuration also requires a gearbox, soft starter and reactive power compensation. The WRIG with variable rotor resistance has been on the market since the mid 1990's with a power rating up to a couple of megawatts. A few examples of commercial solutions are: (i) Vestas V90-3.0 MW, and (ii) Suzlon Energy S88-2.1 MW [2]. Another semi variable-speed WECS using DFIG is shown in Fig. 1.6(c) (Type-3 turbine) [34]. As the name implies, the power from the generator is fed to the grid through both stator and rotor windings [35, 36]. A partial rated (30 %) power converter is employed in the rotor circuit to process the slip power, which is approximately 30 % of the rated generator power. Similar to those in Type-1 and 2 turbines, this configuration also uses the gearbox, but there is no need for a soft starter and reactive power compensation [37]. The use of the converters also allows bidirectional power flow in the rotor circuit and increases the speed range of the generator. This system features improved overall power conversion efficiency, extended speed range (± 30 %), enhanced dynamic performance and robustness against power system disturbances compared to the Type-1 and 2 turbines [38­40]. These features have made the DFIG WECS one of the dominating technologies in today's wind industry with a market share of approximately 50 % [3]. A few high power DFIG turbines are: (i) Repower 6M, 6.0 MW, (ii) Bard 5.0, 5 MW, and (iii) Acconica AW-100/3000, 3 MW [20]. The performance of WECS can be greatly enhanced with the use of full-scale (100 %) power converters as shown in Fig. 1.6(d) (Type-4 turbine) [41­46]. The PMSG, WRSG, and SCIG have all found applications in this type of configuration with a power rating of up to several megawatts [8, 26, 47, 48]. With the use of the power converter, the generator is fully decoupled from the grid, and can operate at full speed range [49­51]. This also enables the system to perform reactive power compensation and smooth grid connection [18, 21, 23, 50­52]. The main drawback is a more complex system with increased costs. The need for the gearbox can be eliminated by using a high-pole number PMSG/WRSG. This configuration is more robust against power system faults compared to the Type-1, 2 and 3 turbines [2, 14, 53, 54]. The typical commercial turbines include: (i) Enercon E126, 7.5 MW, (ii) Multibrid M5000, 5 MW, and (iii) Vestas V-112, 3 MW [2]. 12

The top 10 wind turbine manufacturers as of Dec. 2012 and their main turbine configurations are summarized in Fig. 1.7. They account for approximately 77 % of the 45 GWs installed wind power capacity in 2012 [1, 5]. The details about the turbine configurations are obtained from the respective company product brochures and details from the previous survey papers [3,20,55­59]. The Type-3 turbines (DFIG) hold the highest market share and this technology has been used by 7 manufacturers among the top 10. Approximately 100 different DFIG turbine models are available from all the wind turbine manufacturers. The Type-4 turbines are produced by 6 manufacturers, while 4 of them are offering direct-drive solutions. This implies that the wind energy market is making progress towards full-scale power converters based on variable-speed technology. The summary of all four types of turbines is given in Table 1.4. They are compared using power converters employed; speed-range achievable; requirement for soft-starter, gearbox and external reactive power compensation needed; and maximum power point tracking (MPPT) ability. Overall, the Type-4 turbines with gearless drive-train are most favorable for next generation MW-level wind turbines.
GE (USA) 15.5 % Type-3, 4 (3S, DD)

Rest of the world 22.6 % Type-1 to 4

Vestas (Denmark) 14 % Type-3, 4 (3S)

Mingyang (China) 2.7 % Type-3 Sinovel (China) 3.2 % Type-3 United Power (China) 4.7 % Type-3 Goldwind (China) 6.0 % Type-4 (DD) Suzlon (India) Gamesa (Spain) 6.1 % 7.4 % Type-3, 4 (2S) Type-3

Siemens (Germany) 9.5 % Type-4 (3S, DD)

Enercon (Germany) 8.2 % Type-4 (DD)

100 % = 44,799 MW

Figure 1.7: Summary of top 10 wind turbine manufacturers and their market share by Dec. 2012. [source: REN21 and GWEC] (2S/3S = two-/three-stage gearbox, DD = direct-drive).

13

Table 1.4: Summary of four types of wind turbine configurations
Fixed-Speed, Type-1 Turbine SCIG Power Converter Converter Capacity Speed Range Soft Starter Gear Box Aerodynamic Power Control External Reactive Power Compensation MPPT Operation Not applicable Limited Achievable Achievable Achievable None 0% ±1% Required 3-stage Active Stall, Stall, Pitch Needed Needed Not Needed Not Needed Not Needed Semi-Variable Speed, Type-2 and 3 Turbines WRIG Diode + Chopper 10 % ± 10 % Required 3-stage Pitch DFIG SCIG Variable-Speed, Type-4 Turbine PMSG WRSG

AC/DC+DC/AC (or) AC/DC+DC/DC+DC/AC (or) AC/AC 30 % ± 30 % Not Required 3-stage Pitch 100 % 0­100 % Not Required 3-stage Pitch 100 % 0­100 % Not Required 3- or 2- or 1- or 0-stage Pitch

1.2

Motivation for Dissertation Research

The motivation for this dissertation research is to study the state-of-the-art power converter configurations and control schemes, and to propose new technologies to: (1) absorb the best features of the practical technologies, (2) mitigate the problems associated with the current technologies, (3) decrease cost associated with the power converters, (4) improve wind energy conversion efficiency, and (5) achieve high-performance operation. In this section, both the power converters and control schemes are studied in detail.

1.2.1

Motivation from the Power Converters' Perspective

To enable the grid connection of Type-4 wind turbines, the variable voltage/frequency of the wind generator should be converted to fixed voltage/frequency. To accomplish this, a wide variety of power conversion stages can be employed as summarized in Fig. 1.8. Some of these configurations are adopted from the electric drives industry, while some other topologies have been proposed in literature with promising features for future development. A detailed discussion about these converters will be presented in Chapter 2. The most common fullscale converters employed in the present PMSG wind turbines are summarized in Fig. 1.9. This classification is carried out based on low voltage (LV) versus medium voltage (MV) operation, and generator-side active (PWM) converters versus passive converters. A list of the few commercial wind turbines employing these converters is given in Table 1.5.

14

Full-Scale Power Converters

AC/AC Converters

DC/DC Converters

AC/DC Converters

DC/AC Converters

Cycloconverter

Matrix Converter

Cascaded MC

Passive Controlled

Hybrid Controlled

Full Controlled

Current Source

Voltage Source

Buck

Boost

Parallel Boost

Multilevel Buck/Boost

LCI

PWM

Two-Level

Multilevel

DiodeClamped

Flying Capacitor

Cascaded H-Bridge

Hybrid

Figure 1.8: Classification of full-scale power converters used in Type-4 wind turbines.

2LVSR LVPMSG

2LVSI

Generator-side Active Converters

Filter
LVGrid

3LVSR MVPMSG

3LVSI

Filter

MVGrid

(Topology-1) Low Voltage (LV) (Topology-3)
2LBoost LVPMSG 2LVSI

(Topology-2) Medium Voltage (MV)

Filter

Generator-side Passive Converters

LVGrid

Not explored yet

Figure 1.9: Review of commercial power converters for PMSG-WECS.

15

Table 1.5: List of few commercial PMSG wind turbines
Manufacturer Model Rating Topology Enercon E126 7.5 MW, 690 V Gamesa G128 4.5 MW, 690 V Winwind WWD3 3.0 MW, 660 V 1 GE 2.5XL 2.5 MW, 690 V Avantis AV928 2.5 MW, 690 V Areva M5000 5.0 MW, 3300 V Converteam· MV7000 7.0 MW, 3300 V 2 ABB· PCS6000 6.0 MW, 3300 V Clipper C89 2.5 MW, 690 V Vensys V70/77 1.5 MW, 690 V 3 Goldwind GW70/77 1.5 MW, 690 V · = Converter suppliers,  = Without boost converter

The LV (typical rating is 690 V) two-level (2L) back-to-back (BTB) connected voltage source converters (VSCs) [43] (Topology-1 of Fig. 1.9) configuration is very popular and this technology is successfully applied by many manufacturers as summarized in Table 1.5. The voltage source rectifier (VSR) and voltage source inverter (VSI) are linked through a dc-link and thus decoupled operation can be achieved. At higher power levels, the use of MV (typically 3-4 kV) converters offers many benefits over LV converters: reduced voltage ratings for the switches, better grid code compliance and higher efficiency [60, 61]. A detailed comparison between LV and MV operation of WECS will be presented in Chapter 2. Currently only one MV turbine is operational, using BTB 3L-VSCs (most popularly known as neutral-point clamped (NPC) converters) (Topology-2 of Fig. 1.9) [45, 62­67], but many manufacturers have announced their future projects based on MV technology (refer to Appendix A). In WECS, the power flow is always unidirectional, i.e., from the generator to grid. To decrease the cost and complexity of the system, passive converters can be used at the generatorside instead of active converters, as shown in Topology 3 of Fig. 1.9. The passive converters are more reliable and economical compared to the generator-side active converters [68]. These active and passive generator-side converters will be compared in more detail in Chapter 2. The use of passive converters is feasible with the PMSG generation system as the machine does not need magnetizing current [47]. This technology is also being used by many manufacturers at the LV-level as summarized in Table 1.5. As shown in Fig. 1.9, for MV-PMSG-WECS, the use of passive generator-side converters have not been explored yet. This gap in the commercial power converters is the motivation for the first direction explored by this dissertation research. 16

1.2.2

Motivation from the Control Schemes' Perspective

As mentioned earlier, development of sophisticated control schemes is crucial in increasing WECS efficiency and to comply with the grid code requirements. The development of control techniques for the power converters is an ongoing research topic. A summary of the most established control techniques is summarized in Fig. 1.10. The classical control methods include hysteresis and linear control, while the sliding-mode, intelligent and predictive control methods belong to the advanced control category. The classical control techniques are widely accepted by the power electronics and wind energy industry. Many scholarly works have been presented based on classical control

techniques for the multilevel converters based WECS [2, 14, 67, 69­73]. The classical control approach uses cascaded linear PI regulators and pulse width/ space vector modulation (PWM/SVM). The favorable approach to using the classical control method with PWM/SVM is fixed switching frequency. The lower switching frequency operation is an important requirement at MW-level to minimize switching losses. During such a condition, the classical control techniques impose several technical/operational challenges such as: · Non-symmetrical performance characteristics due to the predominant nonlinear nature of power converters

Converter Control Techniques

Hysteresis Control

Linear Control

Sliding Mode Control

Intelligent Control

Predictive Control

Current Control

Current Control

Current Control

Fuzzy Logic Control Artificial Neural Network Based Control (ANN)

Deadbeat Control

Model Predictive Control (MPC)

Direct Torque Control (DTC)

Field Oriented Control (FOC)

Voltage Control

Hysteresis Based Control

MPC With Continuous Control Set (CCS) MPC With Finite Control Set (FCS)

Direct Power Control (DPC)

Voltage Oriented Control (VOC)

Fuzzy-ANN Control

Trajectory Based Control

Classical Control Techniques

Advanced Control Techniques

Figure 1.10: Classification of control techniques used for the power converters.

17

· Significant lower order harmonics which cause poor power quality and conflict to the grid codes [74] · Sluggish transient response due to low-bandwidth modulation stage [75] · Coupling of control variables such as d- and q -axis grid currents · Degraded performance due to the grid voltage harmonics and control delay [76] · Complicated approach to include system constraints in the design of controller [77] The family of predictive control (PC) techniques includes deadbeat PC, hysteresis-based PC, trajectory-based PC and model-based PC (MPC) [78]. Recently, a finite control-set model predictive control (FCS-MPC) strategy appeared as an intuitive and promising alternative to control the power converters [75, 77, 79], and this method eliminates the need for linear regulators and modulators. The FCS-MPC is a nonlinear control method and provides a better suited approach to control the power converters while mitigating the aforementioned disadvantages associated with the classical control method [80,81]. With an appropriate definition of cost function, several constraints and technical requirements can be incorporated in a straight-forward manner to the design and operation of the controller. The cost which is paid to use FCS-MPC is a higher computational burden, but the modern digital signal processors can perform large amount of calculations at low cost. Most scholarly works on predictive control are related to the power electronics and motor drive applications. The modeling, design and analysis of the FCS-MPC strategy for the power converters employed in the MW-WECS have not been studied yet. Despite the simple and attractive nature of FCS-MPC strategy, several challenges exist in the state-of-the-art research which includes, but is not limited to: (1) accurate modeling of multilevel converters, (2) appropriate selection of weighting factors, (3) control delay compensation, (4) accurate extrapolation of references, (5) control of variable switching frequency nature, (6) prediction of variables over two samples with reduced computational burden, and (7) enhancement of robustness. All these issues have been motivations to investigate the high-performance FCS-MPC strategy for megawatt wind energy systems.

18

1.3

Dissertation Objectives

The target application for this dissertation research is DD-PMSG based MV-MW wind turbines. As summarized in Fig. 1.11, the research directions for this dissertation are twofold: the first one is to investigate next generation power converters; and the second one is to explore high-performance control schemes.
Dissertation Directions/Objectives DD-PMSG Based MV-MW-WECS

Investigation of Next-Generation Power Converters

Investigation of Next-Generation Control Schemes

Figure 1.11: Summary of dissertation research directions and objectives.

1.3.1

Investigation of Next-Generation Power Converters

The first direction for the dissertation objectives is to investigate the next-generation power converters. The initiative of this work is to combine the advantages of proven wind turbine technologies (listed in Fig. 1.9) such as low-cost generator-side passive converters and efficient grid-side multilevel converters.

3LBoost MVPMSG

3LNPC

4LBoost

4LDCC

Filter

MVGrid

MVPMSG

Filter

MVGrid

(a) Three-level converter-based PMSG-WECS

(b) Four-level converter-based PMSG-WECS

Figure 1.12: Next-generation power converters for the MW-MV-PMSG-WECS.

19

The dissertation objectives in this regard are summarized as follows: 1) Investigation of novel power converters for 3­4 kV class WECS As demonstrated in Fig. 1.12(a), a diode rectifier, three-level boost (TLB) converter and neutral-point-clamped (NPC) inverter can be used for 3­4 kV class WECS without connecting the switching devices in a series. This configuration would be very promising if the dc-link capacitor voltages were balanced during all the operating conditions with the help of a TLB converter. This feature would help to simplify the control system for the NPC inverter while improving the grid current shape compared to the BTB-NPC converters. The first objective is to investigate the feasibility of applying this configuration in megawatt wind energy systems, and to compare its performance with the BTB-NPC converters. Further studies must be performed to investigate the performance of converters during grid fault conditions. The maximum power point tracking (MPPT) must also be investigated with this configuration. 2) Investigation of novel power converters for 4­10 kV class WECS Unlike the MV drives, which are fed by standard utility voltages of 2.3, 3.3, 4.16, 6.0, 6.6, 6.9, 7.2, 10, 11 and 13.8 kV, there is no such standard for wind turbines. To meet the future generation of 4­10 kV class WECS (as defined in [82]), four-level converters can be used as shown in Fig. 1.12(b). The requirement for the step-up transformer can be eliminated by directly connecting the wind turbine to 4­10 kV three-phase grid (collection-point). Compared to the three-level converters, the requirement for the grid-side filter is lower to achieve similar levels of grid power quality. Balancing the dc-link capacitor voltages is difficult with the four-level converters compared to threelevel converters [83, 84]. However, similar to the TLB converter, the four-level boost (FLB) converter can balance the dc-link capacitor voltages during all the operating conditions. In addition to the aforementioned objectives, the feasibility and performance of the four-level converters should be analyzed for wind energy application. The objectives are extended to compare the performance of four-level converters with the three-level converters [Fig. 1.12(a)] and BTB-NPC converters. 20

1.3.2

Investigation of Next-Generation Control Schemes

The FCS-MPC method is anticipated to be one of the next generation control tools, and thus is considered secondary subject matter for this dissertation. The main objectives with respect to the development of control schemes for the megawatt WECS are summarized as follows: 3) Continuous- and discrete-time modeling of power converters and WECS The optimal control actions of the predictive control strategy are mainly based on the model of the system. A poor modeling of the system will lead to an inferior control performance. The continuous-time models should be converted to discrete-time with a suitable method such that control delay and prediction horizon can be incorporated. In this work, the third objective is set to accurately model different control variables in terms of converter switching states. 4) Performance improvement of predictive control strategy Despite many best features of FCS-MPC strategy, several challenges are reported in the state-of-the-art literature. A few examples include: weighting factors selection, control delay compensation, accurate extrapolation of reference control variables, variable switching frequency nature, prediction of variables over two or more samples with reduced computational burden, and enhancement of robustness against perturbations in the system model. In this dissertation, the next objective is defined to address the above challenges, and to promote the FCS-MPC strategy as the one of the next generation control tools. 5) Development of generalized control strategy for multilevel diode-clamped converters (MLDCCs) In this work, 3L and 4L converters are proposed for the MW-WECS, and thus the control scheme developed for one converter should work for the other, too. In classical control (which is a mature subject matter), many works have been presented to generalize the control of load current, dc-link capacitor voltages and common-mode voltage in MLDCCs. But in the current predictive control research area, this issue is not addressed yet. 21

Development of a generalized approach for the predictive control of MLDCCs is defined as the next objective. All the control goals must be treated in the modeling and design of the controller. 6) Development of efficient controllers for the grid-tied MLDCCs The grid-tied MLDCCs play a crucial role in dispatching wind power and also to meet grid codes. The control techniques for the grid-side converter should perform multiple tasks to ensure proper and reliable operation of WECS. The next objective is specified to design efficient controllers such that grid-tied MLDCC control requirements such as net dc-bus voltage/grid active power control, reactive power generation to meet grid operator request, dc-link capacitor voltages balancing, and lower switching frequency operation can be fulfilled simultaneously. 7) Design of decoupled control system for the PMSG-WECS In order to achieve decoupled operation for the generator- and grid-side converters, the control systems should be properly designed. In addition to the aforementioned gridside control requirements, the MPPT operation should be performed by the generatorside converter. The control systems should generate reference control variables in order for the WECS to operate at higher efficiency. The next objective of this work is the design and implementation of sophisticated control systems for efficient operation of three-level and four-level converter-based WECS. 8) LVRT enhancement for the proposed WECS using FCS-MPC strategy The state-of-the-art LVRT solutions for PMSG-WECS include pitch control system, over sizing of dc-link capacitors, dissipation of surplus energy in dc-link crowbar (resistor), storage of surplus energy in the battery banks and fly-wheel systems, use of power quality conditioning devices. The surplus energy can be stored in the mechanical system inertia during the grid voltage dips, and this issue is previously analyzed with CSC and NPC converters, and with classical control techniques. The complete WECS response with passive generator-side converters has not been explored yet. The last objective is defined to develop a FCS-MPC control system such that the power converters operate in a safe mode (by maintaining constant dc-bus voltage), while meeting the grid code requirements. 22

1.4

Outline of Dissertation

The research presented in this dissertation is organized into 10 chapters. The outline of the research is summarized in Fig. 1.13. The work carried out in each chapter is summarized as follows:
Chapters 2 and 3 Review of Full-Scale Power Converters and State-of-the-Art Control Schemes Chapter 4 Generalized Approach for Predictive Control in Multilevel Diode-Clamped Converters DD-PMSG Based MV-MW-WECS Chapters 5 and 6 Predictive Control of Grid-Tied Multilevel Inverters Chapters 7 and 8 Predictive Control of 3L and 4L Converter-based PMSG-WECS Chapter 9 Predictive Control for LVRT Enhancement of 3L Converter-based PMSG-WECS

Figure 1.13: Organization of dissertation research.

Chapter­1: An overview of WECS is presented with additional details about major components of wind turbines, regional classification of operating voltages, grid code requirements and generator-converter configurations. Novel converters are investigated by combining the generator-side passive converters and grid-side multilevel inverters. Chapter­2: This chapter reviews the state-of-the-art full-scale power converters employed in the Type-4 wind turbines. The BTB converters, passive generator-side converters, and converters for six-phase and open winding generators are presented and analyzed for megawatt application. The possible extensions to the proposed converters are also presented in each category. Chapter­3: An overview of state-of-the-art converter control schemes are presented in this chapter and compared based on a simple example of load current control. The operating principle, design procedure, cost function flexibility, delay compensation strategies and extrapolation methods are presented for the FCS-MPC strategy. 23

Chapter­4: This chapter proposes a generalized approach based on FCS-MPC strategy for the current control, dc-link capacitor voltages balancing, switching frequency reduction and common-mode voltage mitigation in multilevel diode-clamped converters. The feasibility of the proposed method is verified by simulations in 3L- to 6L-converters, and by experiments in 3L- and 4L-converters. Chapter­5: In this chapter, a model predictive control of MV, grid-tied 4L-inverter for use in MW-WECS is presented, assuming that the MPPT is performed by the generatorside converter. The regulation of net dc-bus voltage, reactive power generation to meet the grid operator request, dc-link capacitor voltages balancing, and switching frequency minimization, is discussed in detail. Chapter­6: A FCS-MPC method is proposed in this chapter to directly control the active and reactive grid powers assuming that the grid-tied inverter performs the MPPT operation. Chapter­7: This chapter introduces a three-level converter-based MV-MW-PMSG-WECS. The discrete-time modeling and control scheme development are discussed. The proposed topology and control strategy are verified through MATLAB simulations on 3 MW/3000 V/577 A system and dSPACE DS1103 based experiments on 3.6 kW/208 V/10 A prototype. Chapter­8: The four-level converter-based WECS is presented in this chapter. The continuousand discrete-time modeling of the proposed power conversion system is presented and analyzed. A two-step predictive scheme is developed to control the generator- and grid-side converters independently. Chapter­9: In this chapter, a predictive control scheme is proposed for LVRT enhancement of DD-PMSG based MW-WECS. The power conversion system is realized using the three-level converters introduced in Chapter-7. Simulation and experimental results are presented to validate the proposed strategy. Chapter­10: The main contributions of this dissertation are summarized. Possible extensions to the research presented in this dissertation are suggested.

24

Chapter 2 Review of Power Converters for High Power Wind Turbines
Many generator-converter configurations were developed over the past decades with the aim of increasing WECS efficiency, decreasing production costs and complying with grid code requirements. A summary of different power conversion stages has been previously analyzed in Fig. 1.8. The classification of wind turbine power converters is a complex matter and it is not possible to classify all the converters based on one parameter/operation. As shown in Fig. 2.1, the converter configurations are classified here into four different groups to facilitate easier discussion. Most of the power conversion stages have found commercial applications, and some have been proposed in the literature with promising features for future development. Based on the existing knowledge, new converter configurations are also proposed in each category. The power converters discussed in the Fig. 1.8 can be employed with the PMSG and WRSG, but SCIG has restrictions on using passive generator-side converters. The gearbox model is not shown in all the figures, but a 3-stage gearbox is mandatory for SCIG. The main features and drawbacks of each configuration are also discussed in the following sections, with important survey results tabulated.
Full-Scale Power Converters

Back-to-Back Connected Converters

Passive Generator-side Converters

Converters for Six-Phase Machines

Converters for Open-Winding Machines

Figure 2.1: Classification employed in this chapter for full-scale power converters.

25

2.1

Back-to-Back Connected Converters

The power converters, which are identical on both the generator- and grid-side, and linked through a dc-link, are classified as back-to-back (BTB) connected converters. Different BTB converters which can be used in the commercial WECS are summarized in Fig. 2.2. They perform a conversion of variable voltage/frequency output of the generator to dc, and then dc to ac, with fixed voltage/frequency for the grid connection. The power flow is bidirectional, and thus the BTB converters can be used with SCIG, PMSG and WRSG. The BTB converters are classified as low voltage (< 1 kV) and medium voltage (1 - 35 kV) converters according to IEC 60038 standard given in Table 1.2. The most standard voltages used by many commercial wind turbine manufacturers for the LV grid connection are 690 V and 575 V.
Back-to-Back Connected Converters

Low Voltage Converters

Medium Voltage Converters

2L VSC

Parallel Switches

Parallel Modules

Current Source Converters

Voltage Source Converters

Series Switches

3L and 4L DCC

3L Active NPC

3L and 4L FC

Figure 2.2: Classification of back-to-back connected converters.

SCIG (LV)

Step-up Transformer

PMSG LCL

(LV) Utility Grid

WRSG

2L-VSR

DC-link

2L-VSI

Figure 2.3: WECS with BTB connected 2L voltage source converters.

26

2.1.1

Low Voltage (LV) Converters

A typical WECS using BTB connected two-level (2L) voltage source converters (VSCs) is shown in Fig. 2.3 [41, 85]. The voltage source rectifier (VSR) and voltage source inverter (VSI) are linked by a dc-link composed of series/parallel connected capacitors [86]. The dclink capacitors provide decoupling between the generator and grid, and thus the transients in the generator do not appear on the grid-side [42,86]. The semiconductor switching devices are realized using LV Insulated Gate Bipolar Transistors (LV-IGBTs). The PMSG, WRSG [41, 85] and SCIG [87, 88] generators can be used with this configuration. This is the most widely used topology for high power wind turbines rated below 0.75 MW [2]. The switching frequency of VSR and VSI is maintained at 1­3 kHz to achieve lower switching losses [41, 66]. The grid current contains higher total harmonic distortion, and to meet the grid codes, LCL filters are used on the grid-side [10]. The generator-side harmonic filter is not shown. Due to the mass production of three-phase converter modules, the cost of these converters is low. One of the most widely used commercial VSC modules is SKiiP by Semikron which is equipped with its own heat sink, semiconductor switching devices and gate drivers, and thus they feature compact design with high power density [89, 90].

(LV)

SCIG

Open Winding Transformer

PMSG

(LV)

WRSG

2L-VSR

2L-VSI

Filter

Figure 2.4: Parallel connected BTB 2L-VSCs and open winding transformer.

For power ratings greater than 0.75 MW, the current carrying capability can be increased by connecting IGBT modules in parallel. Some manufacturers such as Semikron provide IGBT modules for the parallel operation in order to reach megawatt-level [2, 90]. This configuration leads to derating of the power converter due to a mismatch in IGBT characteristics and non-symmetrical layout of the converter circuits. To minimize the circu27

lating currents among the switches, many design considerations such as static and dynamic sharing of IGBT's, and physical layout of gate drivers, IGBT modules and dc-link capacitors, should be properly treated. The circulating currents flow through the IGBT switches, increase losses in them and perhaps damage them. To avoid the above-mentioned problems, the three-phase VSC converters along with harmonic filters can be connected in parallel instead of through IGBT modules. For example, two BTB VSC modules can be connected in parallel to achieve a power rating of 1.5 MW. For higher power ratings, more converter modules can be connected in parallel as shown in Fig. 2.4. The dc-link can also be configured as a common element for all the converters to reduce cost and space [91]. This configuration offers energy efficiency and redundancy. For example, when the wind speed is low, one or more converters can be turned-off leading to higher system efficiency. When a converter fails, other converters can still deliver the power, but with reduced capacity. Moreover, by operating converters in interleaving mode, the equivalent converter switching frequency can be increased, therefore producing less total harmonic distortion in generator- and grid-side currents. Due to a mismatch in converter and grid-side filter parameters, the circulating currents exist in both the generator and grid-side converters and this issue should be considered in the design of the controller. On the generator side, L filters are connected between each converter to reduce the circulating currents. Another alternative to reduce circulating currents is to use open-winding generators, which will be discussed in Section 2.4. To minimize the circulating currents, open winding transformers can also be used at the grid-side.

2.1.2

Medium Voltage (MV) Converters

The LV converters discussed before are efficient and cost effective at power levels lower than 3 MW. As the power rating increases, the number of converter modules increases and as a result, the size, cost and complexity of the system also increases. A summary is provided between the LV and MV operation of a 6 MW wind turbine in Table 2.1, where it has been noticed that the MV operation of WECS is the most suitable and economical approach for power ratings greater than 3 MW. The MV operation is a mature technology in the electric drive industry [92], but wind turbine manufacturers are reluctant to move from LV to MV technology due to the limited availability of MV generators and less knowledge available for the MV operation of turbines. In [11], a detailed cost analysis has been carried out between 28

the LV and MV operation of wind turbines, and the results show that the cost of energy production can be decreased by 2-4 % with MV operation. Currently only a few MV turbines are operational, but many manufacturers have announced their future projects based on MV technology (refer to Appendix A). The two-level VSC shown in Fig 2.3 can also be used for MV applications by connecting the switching devices in a series. This is a simple solution for MV operation, but due to the mismatch in IGBT characteristics, the converter capacity decreases. The grid current quality does not improve compared to the standard two-level VSC, because the converter's output is essentially two-level.

Table 2.1: Summary of LV and MV operation for a 6 MW wind turbine
Typical Converter Recommended for [2] Typical Voltage (V) Number of Converters Active Switches Switching Device [92] Clamping Diodes DC Voltage (V) [2] DC-link Capacitors Converter Complexity Controller Complexity Type of Generator Cost of Generator Rated Current (A) Circulating Currents Cable Type Cable Size Cable Cost Transformer Size Grid-Filter Size Power Quality Grid Code Compliance Converter Location [3] Nacelle Weight [3] Converter Weight Cost of Production [11] Maintenance Cost [11] Redundancy WECS Efficiency Market Status Turbines LV WECS BTB 2L-VSC 0.5­3 MW 690 8 96 LV-IGBT 0 1200 8 High Medium LV Medium 5020 High LV Very High Very High High High Medium Good In Nacelle High Very High 100 % Low High Medium Mature Enercon E-126 * Based on 1200 V Rating MV WECS BTB 3L-VSC 3­6 MW 3000 1 24 MV-IGBT/IGCT IGET/GCT/SGCT 12 5300 5 Low Low-Medium MV Medium-High 1155 None MV Low Low Medium Medium Good Excellent Bottom of Tower Low Medium 96­98 % Low Low High Available/ Emerging Multibrid M5000

29

The neutral-point-clamped (NPC) converter has been widely studied in literature [45,61, 62, 64, 67, 93­95]. As shown in Fig. 2.5, the NPC converters are used in commercial wind turbines, where the system power rating has reached 6 MW without connecting switching devices in series or parallel [62]. The switching devices, such as HV-IGBT or Insulated Gate-Commutated Thyristor (IGCT) with a voltage rating of 4.5­6.5 kV can be used. In the commercial wind turbines, the NPC converters are reported to have been used with the PMSG, but they can also be used with WRSG and SCIG. The switching actions of the semiconductor switches lead to the drift in the capacitor voltages. If the capacitor voltages are not balanced, it leads to higher stress on the semiconductor switches and damages them. To ensure equal voltage among the dc-link capacitors, external hardware can be used [96]. It is also possible that the carrier-based pulse with modulation (PWM) with zero-sequence voltage injection [97] or space vector modulation (SVM) with redundant switching states selection [98­105] can be used to balance the capacitor voltages.

SCIG (MV)

PMSG

(MV)

WRSG

3L-VSR

DC-link

3L-VSI

Figure 2.5: WECS with BTB connected 3L diode-clamped converters.

The NPC converters are most suitable for 3-4 kV class MV operation. To connect to the MV collection point of 6.9 kV (North America Standard) or 6.6 kV (Europe Standard) without using a step-up transformer, the switching devices in a NPC converter should be connected in a series [84, 106], but this approach leads to derating the converter. As shown in Fig. 2.6, a four-level (4L) diode-clamped converter (DCC) is proposed in this work to achieve higher levels of MV operation. In comparison to the three-level (3L) DCC (NPC converter), the 4L-DCC offers added benefits such as: MV operation with greatly reduced device voltage rating, increased equivalent switching frequency, lower values for the gridside filter, grid friendly waveforms, and better grid code compliance. However, the dc-link 30

capacitor voltages balancing becomes more complex and sophisticated, and therefore control techniques or external hardware should be used [81, 107, 108]. The semiconductor device count also increases. In particular, the clamping diodes increase from 12 to 36 in comparison to the BTB NPC converters. The four-level converters are not commercialized yet, but the basic power semiconductor switches are readily available in the market.

(MV)

SCIG

PMSG

(MV)

WRSG

4L-VSR

DC-link

4L-VSI

Figure 2.6: WECS with BTB connected 4L diode-clamped converters.

The semiconductor devices in the NPC converter operate with different switching frequencies and thus cause uneven power losses and heat dissipation. This leads to a difficulty in the design of the mechanical layout of the semiconductor switches. This problem can be solved by using active neutral-point clamped (ANPC) converters as discussed in [109]. This configuration is successfully applied in the MV drives industry, but not yet studied for WECS. The clamped diodes in the BTB NPC converters can be replaced by the flying capacitors (FC) as shown in Fig. 2.8. This configuration offers a simplified structure and more redundant switching states in order to achieve easier control for the capacitor voltage balancing [110, 111]. This configuration requires a large number of capacitors and each of them requires pre-charging circuit. The diodes are more reliable than the capacitors, and thus this configuration has not found its commercial application in the wind energy industry yet, even though a successful topology in MV drives industry. The control scheme requires a greater number of sensors to send feedback signals from the FC's and these add cost and complexity to the system. 31

Proposed Topology

SCIG (MV)

PMSG

(MV)

WRSG

3L-ANPCR

DC-link

3L-ANPCI

Figure 2.7: WECS with BTB connected 3L active neutral point clamped converters.

SCIG (MV)

PMSG

(MV)

WRSG

3L-FCR

DC-link

3L-FCI

Figure 2.8: WECS with BTB connected 3L flying capacitor converters.

The previously discussed topologies belong to voltage source converters. The current source converters (CSC) can also be used in wind turbines as shown in Fig. 2.9. The topology consists of PWM current source rectifier (CSR) and current source inverter (CSI). The CSR and CSI are linked by a dc-choke and thus, similar to the VSCs, decoupling between the generator and grid can be achieved [49]. Three-phase capacitor banks are used on the ac-sides of CSR and CSI to assist the commutation of semiconductor devices and also to mitigate the switching harmonics. This topology features a simple structure, low dv/dt at the output terminals of the converter, and reliable short-circuit protection. In VSCs, the dclink capacitors are bulky components, whereas in CSC, the dc-choke is the bulky component. The dynamic response of the CSC converters is slower compared to the VSC converters due to bulky dc-choke and lower switching frequency operation. The cost of CSC production is 1-2 % lower compared to the VSC converters [11]. The CSC technology is successfully applied to the multi-megawatt MV drives [112], but it is not yet used in the MV-WECS. 32

SCIG

Common-mode Choke

(MV)

PMSG

(MV)

WRSG

Filter

CSR

DC-link

CSI

Filter

Figure 2.9: WECS with BTB connected current source converters.

Table 2.2: Comparison of BTB connected converters for megawatt wind turbines
2L-VSC (Fig. 2.4) Number of Converters Active Switches Clamping Switches Clamping Diodes Clamping Capacitors Voltage Stress Operation Voltage (kV) Operation Power (MW) Power Quality Converter Complexity Controller Complexity Reliability Switching Devices 4 48 0 0 0 vdc 0.69 3 Med. High Med. High LV-IGBT 3L-DCC (Fig. 2.5) 1 24 0 12 0
vdc 2

3L-ANPC (Fig. 2.7) 1 24 12 0 0
vdc 2

3L-FCC (Fig. 2.8) 1 24 0 0 12
vdc 2

4L-DCC (Fig. 2.6) 1 36 0 36 0
vdc 3

CSC (Fig. 2.9) 1 24 0 0 0
vdc 2

3­4 3­6 Good Med. Med.-High Med. MV-IGBT IGCT

3­4 3­6 Good Med.-High Med.-High Med.-High MV-IGBT IGCT PCS8000

3­4 3­6 Good Low-Med. Med. Low-Med. MV-IGBT IGCT VDM6000

3­7 3­7 Excellent Med.-High Med.-High Med. MV-IGBT IGCT ­

3­4 3­10 Good Low Med.-High High GTO SGCT PF7000

Commercial Products

Enercon E126 Vestas V-112

PCS6000 MV7000

* denotes clamping devices,  denotes a product from electric drives industry, vdc is net dc-bus voltage.

33

2.2

Passive Generator-side Converters

The previously discussed BTB topologies enable a four-quadrant operation. But in the WECS, the power flow is unidirectional i.e., from the generator to the grid. To decrease the cost and complexity of the system, passive converters can be used at generator-side instead of PWM active converters. The diode-rectifiers are inherently more reliable than the PWM converters. It should be noted that the PMSG and WRSG do not need magnetizing current, and thus passive converters can be used [68]. The summary of comparison between the active and passive generator-side converters is given in Table 2.3. The control system development for the MPPT is less complicated with the passive converters. Due to the greatly reduced control complexity, a low cost control platform can be used. The cost and complexity associated with the gate drivers also decrease as the active switches decrease from 6 to 1. The only disadvantage with the diode rectifiers is that the generator torque contains higher ripples due to significant 5th and 7th harmonics in the generator current [113, 114]. However, due to decoupling offered by the dc-link, these ripples do not cause any conflict to the grid-codes.

Table 2.3: Summary of active and passive generator-side converters for WECS
Active Generator-side Converters Typical Converter Cost Reliability Converter Complexity Controller Complexity MPPT Generator Size Gen. Torque Ripple Gen. Current Nacelle Weight Converter Weight Maintenance Cost Market Status Turbines VSC/CSC High Medium High High Achievable 100 % Low Sinusoidal High High Low Mature Enercon E-126 * Using Boost Converter Passive Generator-side Converters Diodes Low High Low Low Achievable 105 % Medium Non-Sinusoidal Low Medium Very Low Available Vensys V70/77

34

The WECS with diode-rectifier, boost converter and PWM inverter is shown in Fig. 2.10. The variable output voltage of the generator is converted to dc by the diode-rectifier and the boost converter performs the maximum power point tracking, which increases the energy capture and thus improves overall system efficiency [115,116]. The boost converter increases the unregulated dc-link voltage to a higher level that is suitable for the PWM inverter. To decrease the size of the dc choke, a two-channel boost converter [117] can be used as shown in Fig. 2.11. By using interleaving operation for the two channels, the inductor current ripple can be minimized. The voltage rating of the semiconductor switches is the same as of the dc-link voltage, but the current carrying capacity becomes half. The three-channel boost converters are also employed in commercial wind turbines (Vensys 70/77).

(LV)

PMSG

(LV)

WRSG

2L-Boost Converter

2L-VSI

Figure 2.10: WECS with diode rectifier, 2L boost converter and 2L-VSI.

(LV)

PMSG

(LV)

WRSG

2-Channel Boost Converter

2L-VSI

Figure 2.11: WECS with diode rectifier, two-channel boost converter and 2L-VSI.

35

The diode-rectifiers can also be used in MV WECS. As shown in Fig. 2.12, the generatorside NPC rectifier can be replaced with a diode-rectifier to achieve lower cost compared to the BTB NPC converters and to the parallel 2L-VSC converters. A standard two-level boost converter can be included as an intermediate stage to improve the wind energy conversion efficiency [94]. The voltage stress for the active switch and diodes used in the two-level boost converter is the same as the net dc-bus voltage, and thus they should be connected in a series. Using the same number of active switches and diodes, the 2L-boost converter can be modified to 3L-boost converter as shown in Fig. 2.13. With this topology, the advantages of generator-side passive converters and grid-side multilevel converters are combined. The voltage rating for the IGBT/IGCT switch and diode are half of the net dc-bus voltage.

(MV)

PMSG

(MV)

WRSG

2L-Boost Converter

3L-VSI

Figure 2.12: WECS with diode rectifier, 2L boost converter and 3L-VSI.

(MV)

PMSG

(MV)

WRSG

3L-Boost Converter

3L-VSI

Figure 2.13: WECS with diode rectifier, 3L-boost converter and 3L-VSI.

36

Proposed Topology

The three-level boost converter offers many befits compared to the standard boost converter: reduced switching losses and reduced reverse recovery losses [118]. Compared to the BTB NPC converters introduced in Fig. 2.5, the number of active switches in generator-side converter decrease from 12 to 2, and it leads to a cost-effective solution for MV turbines. The number of switching states also decrease from 27 to 4, and thus the control complexity and computational burden greatly decreases. As described in [67], in the BTB NPC converterbased WECS, both the generator- and grid-side converters should take precise switching actions so that the dc capacitor voltages are balanced. However with the proposed configuration, the dc capacitor voltages are controlled by the three-level boost converter during all the operating conditions, and this gives control flexibility for the NPC inverter to effectively track to the grid current references. This feature also leads to enhanced grid power quality and better compliance to the grid codes.

(MV)

PMSG

(MV)

WRSG

4L-Boost Converter

4L-VSI

Figure 2.14: WECS with diode rectifier, 4L-boost converter and 4L-VSI.

Similar to the 3L boost converter, a 4L-boost converter can be used in conjunction with the four-level diode-clamped inverter as shown in Fig. 2.14. As mentioned earlier, the balancing of the dc-link capacitor voltages with the 4L-DCC is very complicated compared to the NPC converter [83, 84]. But the intermediate 4L-boost converter ensures balancing of the dc-link capacitor voltages during all the operating conditions. The 4L-boost converter is composed of three active switches and four diodes. The voltage rating of these devices 37

Proposed Topology

is one third of those used in the standard boost converter. Thus the cost of this converter is approximately the same as that of a standard boost converter [119]. In comparison to the BTB 4L converters shown in Fig. 2.6, this configuration decreases the number of active switches and clamping diodes significantly in the generator-side converter. Even with the higher number of clamping diodes in the grid-side converter, the cost of this configuration becomes approximately equal to the 3L BTB converters.

(MV)

PMSG

(MV)

WRSG

3L-Boost Converter

3L-ANPCI

Figure 2.15: WECS with diode rectifier, 3L-boost converter and 3L-ANPCI.

(MV)

PMSG CL Filter

(MV)

WRSG

3L-Buck Converter

CSI

Figure 2.16: WECS with diode rectifier, 3L-buck converter and CSI.

38

Proposed Topology

Proposed Topology

To overcome the problem of uneven power losses and heat dissipation associated with the NPC converters, the grid-tied NPC converter can be replaced by the ANPC converter, as shown in Fig. 2.15. Since the capacitor voltages are balanced by the 3L-boost converter, the ANPC converter will have more control freedom in selecting the switching states which leads to better even power losses and heat dissipation. The cost and complexity of this configuration is much lower compared to the BTB-ANPC converters presented in Fig. 2.7. The CSCs can also be designed with a passive generator-side converters as demonstrated in [120­122]. In VSCs the dc-link voltage should be boosted, while in CSCs, the dc-link current should be boosted. The duality of the proposed 3L-boost converter is a 3L-buck converter. The configuration using 3L-buck converter and CSI is shown in Fig. 2.16. The high grid current quality is more important to comply with the grid codes and to achieve this 5L to 9L-ANPC converters can be used as demonstrated in [60, 123]. These configurations lead to excellent power quality and a filterless grid connection. However, in these configurations, the dc-link capacitor voltages need to be controlled by the grid-tied inverter. As mentioned earlier, this leads to higher control complexity for the grid-tied inverter. To overcome this challenge, a 3L-boost converter can be employed to directly fit the two dc-link capacitors of the grid-tied ANPC converter (shown in Fig. 2.17). In comparison to the works presented in [60, 123], the proposed configuration leads to a less complicated control scheme and grid-friendly waveforms.

PMSG (MV)

WRSG 3L-Boost Converter 5L-ANPC 7L-ANPC 9L-ANPC

Figure 2.17: WECS with diode rectifier, 3L-boost converter and multilevel ANPC.

39

Proposed Topology

(MV)

2.3

Converters for Six-Phase Machine Based WECS

The six-phase machines are also used in the commercial wind turbines. With the two sets of windings, the insulation level for each winding decreases. The power handling capacity can be improved two times as each set of winding carries half the rated current. A six-phase WRSG (PMSG) based WECS is shown in Fig. 2.18. The stator windings are separated by 30 and thus the stator voltages are phase shifted by 30 . This leads to cancelation of lower order harmonics in the stator currents with which the torque ripples can be minimized. Lower sized filters can then be used on the generator side. Since these two windings are separated, no circulating current flows and thus the complexity of control system decreases.
6-Phase Machine (LV) SCIG 30

(LV) PMSG

WRSG

2L VSR

2L-VSI

Figure 2.18: Six-phase machine based WECS with parallel 2L-VSC modules.

6-Phase Machine (LV)

30

(LV) PMSG

WRSG

2L Boost Converter

2L-VSI

Figure 2.19: Six-phase machine based WECS with parallel 2L-boost + 2L-VSC modules.

40

A similar six-phase configuration with a passive generator-side converters is shown in Fig. 2.19 [124]. The disadvantage of high torque ripples with the diode rectifiers can be mitigated by employing a six-phase configuration with 30 phase shift. The MV operation of wind turbines is cost effective and a promising solution for megawatt wind turbines. But, one of the shortcomings in the current wind energy industry is the lack of availability of the MV generators. The use of LV converters at the generator-side and MV converters at the grid side represents a very promising approach. A configuration with series-connected LV converters on the generator-side and the NPC converter on the grid-side is shown in Fig. 2.20 [73]. The LV outputs of the generator-side converters are connected in a series to achieve higher dc-link voltage. The capacitor voltages are balanced by the NPC converter. This configuration may not work during the whole wind speed range.

SCIG 30

PMSG (LV)

(MV)

WRSG

Series 2L-VSRs

DC-link

3L-VSI

Figure 2.20: Series connected 2L-VSRs at generator-side and 3L-VSI at grid-side.

6-Phase Machine

30

PMSG (LV)

(MV)

WRSG

Series 2L-Boost

3L-VSI

Figure 2.21: Series connected 2L boost converters at generator-side and 3L-VSI at grid-side.

41

As shown in Fig. 2.21, a passive generator-side converters can also be used to decrease the cost of the turbine and to operate during the whole wind speed range [125]. The torque ripples can be minimized while performing LV-MV operation. This configuration is more promising compared to the active generator-side converters because during low wind speed operation, the boost converters can operate with a higher duty cycle. As discussed in [125], the capacitor voltages are controlled by the boost converter and this leads to higher complexity for the NPC converter. To overcome the problem of dc-link capacitor voltages balancing while performing LVMV conversion, a new converter configuration is proposed as shown in Fig. 2.22. Instead of a series connection of 2L-boost converters, the outputs of the diode-rectifiers are connected in a series. The output voltage of the series-connected diode bridge rectifiers form the MV input dc-link [126]. The 3L-boost converter performs the MPPT with additional freedom to control the dc-link capacitor voltages with minimal switching and reverse recovery losses. Similar to the VSC converters discussed, the LV to MV conversion can also be achieved by CSC converters as shown in Fig. 2.23. The CSI configuration is much simpler and there are no issues related to the balancing, unlike those in the NPC converters presented in Fig. 2.21. This configuration has already been introduced in the MV drives industry [127], and it is very promising for high power wind turbines.

PMSG (LV)

(MV)

WRSG

Series Diodes

3L-Boost

3L-VSI

Figure 2.22: Series connected diode rectifiers, 3L-boost converter and 3L-VSI at grid-side.

42

Proposed Topology

6-Phase Machine

30

PMSG (LV)

(MV)

WRSG

Series 2L-Buck

CSI

Figure 2.23: Series connected 2L-buck converters at generator-side and CSI at grid-side.
Open Winding Machine

SCIG (LV)

Open Winding Transformer

PMSG

(LV)

WRSG

2L-VSR

DC-link

2L-VSI

Filter

Figure 2.24: Open winding machine based WECS with multiple 2L VSC modules.
Open Winding Machine To Machine Phase-b Terminals To Machine Phase-c Terminals

SCIG (LV)

Optional

PMSG

(MV)

WRSG

Phase-a

Phase-b

Phase-c

Figure 2.25: Open winding machine based WECS with cascaded converters.

43

Proposed Topology

6-Phase Machine

30

2.4

Converters for Open Winding Machine Based WECS

Wind generators with open-winding structure are also used in the present wind turbines. The generator is equipped with more than one set of windings and offers new possibilities to connect the converters in different configurations [8, 128, 129]. One of the practical wind turbines, which use six sets of three-phase windings, is shown in Fig. 2.24. In comparison to the parallel VSC modules discussed earlier, the circulating currents in the generator-side converters can be eliminated. With zero circulating current, the power rating of the overall system increases, in proportion to the number of channels employed. The megawatt wind turbines can be realized using low power, mass produced VSC converters. The distributed windings also provide insulation between the converters. These generators are specially designed at a higher cost. A higher power MV wind turbine using cascaded converters is shown in Fig. 2.25. The converters are connected in a cascaded connection to increase the system voltage and power rating. This configuration requires a generator with multiple sets of two-phase windings with a phase displacement of 90 . Each module can be realized using the power converters introduced in Figs. 2.26 [128,129] to 2.27 [8]. The transformerless grid connection is possible with this configurations as system voltages of 10-35 kV can be reached by connecting more modules in the series. The modularity and redundancy are other added advantages of this configuration.

Module Output

3L-HBR (a)

3L-HBI

5L-HBR (b)

5L-HBI

Figure 2.26: BTB connected 3L- and 5L-HB converters based module.

A three-level H-bridge converter is shown in Fig. 2.26(a). It is a simple structure and its output contains three levels. This converter can be realized by mass produced two-level VSCs. To achieve the higher system voltage operation with a lower number of modules, NPC 44

Module Output

Module Input

Module Input

H-bridge modules can be used to form a 5L-HB converter as shown in Fig. 2.26(b). In this case, the generator windings should also be designed for medium voltage operation. The cost associated with the generator-side active converters can be decreased by using single-phase diode-rectifier and boost converter similar to the topology presented in Fig. 2.10 [128]. Another possibility is to use medium frequency transformers (MFTs) in the BTB Hbridge modules (Fig. 2.27). The transformer operates at several kHz to decrease its size [8]. Due to the increase in the number of components, the reliability is lower with this configuration. As shown in Fig. 2.28, the module can also be realized using a single-phase diode bridge rectifier, 3L-boost converter and 5L-HB converter to decrease the cost of the overall system. Since several modules are used in cascaded connection, the overall cost of the converter becomes lower compared to the BTB converters shown in Fig. 2.26. Moreover, the dc-link capacitor voltages are well regulated by the 3L-boost converter in each module, and thus the control system complexity for 5L-HB becomes simplified.

MFT 3L-HBR 3L-HBI

Figure 2.27: Back-to-back connected 3L H-bridge converters and MFT based module.

3L-Boost Converter

5L-HBI

Figure 2.28: Diode rectifier, 3L-boost and 5L-HB converter based module.

45

Proposed Topology

Module Output

Module Input

Module Output

Module Input

2.5

Conclusion

In this chapter, an overview on WECS is presented with the main focus on full-scale power converters employed with a squirrel cage, permanent magnet and wound rotor synchronous generators. With the combination of different types of generators and power converters, a variety of WECS configurations have been investigated. The most common configurations for practical and emerging wind turbines are discussed. Various technical issues related to these configurations were discussed, including generator types, power converter topologies, active power control, energy conversion efficiency, and grid-side reactive power compensation. The back-to-back connected converters, passive generator-side converters, and converters for six-phase and open winding generators are presented, and their features and drawbacks are analyzed. In each category, new converter configurations are proposed based on the existing literature and commercial technologies.

46

Chapter 3 Review of Control Techniques in Power Converters
In efficient energy conversion, three main research areas play a crucial role: (1) semiconductor devices, (2) arrangement of these devices (called power converter configuration), and proper turn on/off of these devices (called the control scheme). In Chapter 2, the semiconductor devices and power converter configurations have been analyzed. The power converters' control is a very active research topic and is constantly evolving according to the technological developments in semiconductor devices and control platforms, control requirements, power quality standards, and grid code requirements, etc. [3, 4, 8, 9, 16, 24, 26, 28, 61, 92, 106, 112, 130­148]. An overview of classical and advanced digital control techniques is presented in Chapter 1. In this chapter, the state-of-the-art converter control techniques, such as hysteresis control, linear control, sliding mode control, fuzzy logic control, artificial neural network (ANN) based control, deadbeat predictive control and finite control-set model predictive control (FCS-MPC) are discussed. The operating principle of these techniques is analyzed with an intuitive example of load current control. Various classes of the predictive control techniques are discussed along with their merits and demerits. The operating principle and design procedure of FCS-MPC strategy is discussed with an example of first-order system. The cost function flexibility to incorporate several primary and secondary control objectives is discussed. The delay compensation and extrapolation methods are discussed along with their advantages and disadvantages. The FCS-MPC method is compared with the classical control approach, and important observations are tabulated.

47

3.1

The Past, Present and Future of Control Platforms

In a search to obtain the ideal characteristics of a switch, many semiconductor devices have been developed [84, 149­151]. The diode rectifiers which belong to the first generation of semiconductor devices use natural commutation and do not need any control platform. In the second generation semiconductor devices, the gating terminals have been incorporated to turn on/off the switches according to the desired performance. As a result, many power switches have been developed and one of the earlier developments is the thyristor. During the 1960s, analog control platforms based on operational amplifiers and passive components were developed to control the firing angles of thyristors in order for the output voltage to be controlled [77]. With thyristors, the turn-on instant can be controlled, but the turn-off instant is uncontrollable and is dependent on the line frequency. In an effort to achieve controllable turn-off, insulated-gate bipolar transistors (IGBTs) have been developed [84]. A simple example of using IGBT to achieve controllable performance is a buck converter whose output voltage can be regulated by adjusting the duty cycle [152]. For this converter, analog control circuits have been used in the past, where a single-phase pulse width modulator or hysteresis controller generates the gating signals. Analog control platforms present several drawbacks such as a large number of components, reduced system reliability and poor computational capability to name a few [153]. To achieve a high performance operation, digital control techniques were developed during the 1970s which involve powerful calculations, complex strategies and math-intensive algorithms [77, 153]. Introduction of digital signal processors (DSPs) by Texas Instruments in 1983 has brought the base to implement the digital control techniques. One example of the earlier DSPs is TMS320C14 which features a 16-bit processor and operational power of 10 million instructions per second (MIPS) [153]. To date, the technological advancements in semiconductor devices have resulted in many switching devices such as the power metaloxide semiconductor field effect transistor (MOSFET), emitter turn-off thyristor (ETO), MOS-controlled thyristor (MCT), static induction thyristor (SIT), silicon-controlled rectifier (SCR), gate turn-off thyristor (GTO), insulated-gate bipolar transistor (IGBT), reverse blocking (RB) IGBT, injection-enhanced gate transistor (IEGT), gate commutated thyristor (GCT), insulated gate commutated thyristor (IGCT) and symmetrical gate commutated thyristor (SGCT). The digital control platforms also evolved rapidly and revolutionized the 48

industrial control area by allowing the user to develop sophisticated control algorithms. A few examples of modern real-time (RT) digital control platforms include: microcontrollers, DSP, field programmable gate array (FPGA), rapid prototyping systems. These platforms have been used widely in the control of various power electronic converters [153­159] and they feature low cost, more reliability and high computational power. For example, rapid prototyping controller dSPACE DS1103 performs 2500 MIPS which is very powerful compared to the earlier versions of DSP (TMS320C14). It is anticipated that in the future more powerful digital control platforms will be developed leading to much lower costs and higher computational capacity. The user will not have to worry about the computational power needed to develop more advanced control schemes, and can incorporate many constraints to improve the system response. In industry, fixed-point processors are used mainly due to cost considerations and computational power, but in academia, floating-point processors and rapid prototyping platforms are used to achieve flexibility in programming and RT implementation. In this dissertation, a DS1103 rapid prototyping platform is used to perform all the experimental tests. Since this platform uses the same microprocessor of industrial products, the software programming can be transferred to the industry "as is" or with slight modification [77, 153].

3.2

Overview of Digital Control Techniques

The development of control techniques for the power electronic converters is an ongoing research topic. A summary of the most established control techniques, and also those which are promising for future development are shown in Fig. 1.10. The hysteresis and linear controllers are widely accepted by the power electronics industry. The advanced control techniques include sliding-mode, intelligent and predictive control techniques. The block diagrams of these control techniques are shown in Figs. 3.1 to 3.8 to show their main principle, but many other classes or variations are available in each category. A two-level converter which is connected to the load/motor/grid is used as an example for the discussion of control techniques. The harmonic filter on the load/motor/grid side is not shown to simplify the diagrams 3.1 to 3.8. The control of variables is shown in natural frame (abc) to better compare the different controllers, but as demonstrated in the literature, it is also possible to control the variables in stationary ( ) or synchronous (dq ) reference frames. 49

i a (k )

Hysteresis Controller
+ -

Sa e i b (k )
+ -

Inverter

ia (k )

Hysteresis Controller

3- L/M/G

Sb e i c (k )
+ -

ib (k )

Hysteresis Controller

Sc

e

ic (k )

Figure 3.1: Hysteresis current control scheme for 3- load/motor/grid (L/M/G).
i (k ) e
+ -

v  (k ) PI Pulse Width/ Space Vector

Sa Sb Sc

Inverter

3- L/M/G

i(k ) Carrier Signal vcr (k )

Modulation (PWM/SVM)

Figure 3.2: Linear current control scheme using PI regulators and SVM.
i (k ) e
+ -

Sliding Mode Controller

v  (k ) Pulse Width/ Space Vector

Sa Sb Sc

Inverter

3- L/M/G

i(k ) Carrier Signal vcr (k )

Modulation (PWM/SVM)

Figure 3.3: Sliding mode current control scheme using SVM.
i (k ) e
+ -
d dt

v  (k ) Pulse Width/
Fuzzy Controller

Sa Space Vector Modulation (PWM/SVM) Sc Sb

Inverter

i(k )

3- L/M/G

Carrier Signal

vcr (k )

Figure 3.4: Fuzzy logic current control scheme using SVM.

50

Sa i (k ) e
+ -

Inverter

3- L/M/G

K

Sb Sc ANN

i(k )

Figure 3.5: ANN based current control scheme.
Inverter 3- L/M/G

Sa i (k ) e
+ -
d dt

Sb
Fuzzy Controller

i(k )

Sc ANN based Modulator

Figure 3.6: Fuzzy logic current control scheme using ANN modulation.
i (k ) i(k ) v  (k ) Pulse Width/ Space Vector vcr (k ) Modulation (PWM/SVM) Sc Sb Inverter 3- L/M/G

Deadbeat Predictive Controller Carrier Signal

Sa

Figure 3.7: Deadbeat predictive current control with SVM.
i (k ) i (k + 1) Extrapolation Cost Function i(k ) Predictive Model ip (k + 1) Minimization gk Sc Sb Inverter 3- L/M/G

Sa

Figure 3.8: Finite control-set model predictive control (FCS-MPC) scheme.

51

3.2.1

Hysteresis Control Technique

A hysteresis current control scheme is shown in Fig. 3.1. This controller is recognized as a nonlinear method [149, 150, 160­164]. The measured currents are compared to the reference currents with the help of hysteresis (bang­bang) controllers, and the gating signals are generated based on the reference tracking. The error in reference tracking can be reduced by reducing the hysteresis band width. This is a simple concept and has been used since the era of analog control platforms. It is important to note that no modulator is required with this method and thus the converter's switching frequency varies according to the filter parameters, operating conditions and hysteresis band width [77]. The uncontrollable switching frequency is one of the major drawbacks of this controller and many works have been presented in an effort to improve this controller. More advanced versions of this method include direct torque control (DTC) [84, 149, 150, 165] and direct power control (DPC) [70, 71, 156]. In the DTC method, the torque and flux of the drive system are controlled, while in DPC the grid active and reactive power are controlled directly. The hysteresis controllers produce error signals and a look-up generates the switching signals to the converter based on the relative magnitudes of the error signals (torque and flux in DTC; active and reactive powers in DPC). In order to implement these methods on digital platforms, a very high-sampling frequency is needed to force the variables within the hysteresis band limits. In addition, the switching losses are higher with this method, and thus it is not suitable for high power applications [77].

3.2.2

Linear Control Technique

In an attempt to solve the major drawbacks of the hysteresis controller, linear control techniques have been proposed which linearize the nonlinear converter. To achieve this, cascaded linear regulators, usually proportional-integral (PI) controllers and a modulation stage have been developed. The most commonly used modulation schemes are pulse width modulation (PWM), space vector modulation (SVM) and selective harmonic elimination (SHE) [97­105,108,166­195]. A linear current control technique using SVM is shown in Fig. 3.2. The load currents are compared to their references, and the error signal is processed by the PI regulators, and the reference load voltage is generated accordingly. With PWM modulation, the reference signal v  (k ) is compared with the triangular signal to generate the 52

gating signals for the converter [97, 166­176]. The SVM is recognized as an efficient method as it offers better harmonic performance and enhanced dc-bus voltage utilization compared to the PWM [84, 149]. With the SVM, the closest vectors to the reference voltage vector are selected based on dwell time calculation and switching scheme design [98­105, 108, 177­190]. The SVM involves several design steps and complex modeling, which leads to a higher computational burden compared to the PWM. The SHE is mainly based on switching angles calculation such that specific lower order harmonics in the output current can be eliminated [191­195]. The linear control scheme using PWM/SVM/SHE operates with fixed-switching frequency, and this value is dictated by the carrier frequency. The error value is minimal in dq frame compared to the  and abc frames. The PI parameters are designed for one operating condition (usually rated condition), and if the converter operates at different operating conditions, then the control performance deteriorates, and stability-related problems arise [76,196]. Since the linear controller is applied to the power converter which is nonlinear in nature, the performance obtained is unsymmetrical and it varies according to the operating condition [77]. The assumption of the linear model gives favorable performance only if a high band-width modulation is used. This scenario leads to a high switching frequency operation which consequently increases the switching losses. Moreover, when the converter operates at lower switching frequency, the magnitude of the lower order harmonics increases significantly and causes poor power quality [74]. Many research works have been carried out to solve this issue, and research is ongoing. The linear control techniques have been used widely used in the drives industry and energy systems. To control the motor torque and flux in a decoupled manner, field oriented control (FOC) is used. This involves reference frame transformations, several PI controllers, low pass filters and modulation stage. Similar to the FOC, voltage oriented control (VOC) is used to control the grid-connected converter [2, 14, 72]. Using the VOC scheme, decoupled control of the net dc-bus voltage and grid reactive power can be achieved. In VOC, the grid voltage harmonics deteriorate the control performance [76]. With both the hysteresis and linear control techniques, the system constraints and technical requirements such as maximum current, load voltage spectrum shaping, switching losses reduction and total harmonic distortion (THD) minimization, cannot be incorporated easily in the design of control scheme. 53

3.2.3

Sliding Mode Control Technique

The sliding mode control is an advanced power converter control technique and belongs to the family of variable structure control and adaptive control [197­201]. This control technique is nonlinear in nature and it can be applied to linear or nonlinear systems [197]. A sliding mode control method along with the PWM/SVM is shown in Fig. 3.2.3. The load voltage references are generated through the sliding controller. As the name implies, the control variable (load current) is forced to track or slide along the predefined trajectory [202­204]. With this method, the structure of the controller is intentionally changed to achieve robust and stable response even during the system parameter variations and load disturbances [151]. This control method gives robust response compared to the classical controllers discussed earlier.

3.2.4

Intelligent Control Techniques

The expert systems, fuzzy logic, artificial neutral network (ANN), and genetic algorithms belong to the family of intelligent control techniques [151,205­207]. As demonstrated in Fig. 3.4, in this control approach, the PI controller is replaced by the fuzzy logic controller. The load current reference tracking error and its derivative are used as the input to the fuzzy controller. This controller embeds the experience, knowledge and intuition of the converter operator/designer in the form of membership functions. Since the power converters are nonlinear in nature, the robustness of the system during parameter variations can be improved by using the fuzzy controller without knowing the exact converter model. It is also a class of nonlinear control techniques, and positively the best among the adaptive controllers [151, 205­207]. The ANN represents the most generic form of the human thinking process compared to the other intelligent controllers [151]. The ANN based load current regulation is shown in Fig. 3.5 [149, 208]. The tracking error signals are given as inputs to the ANN through a suitable gain or scaling factor (K), and the ANN controller produces switching signals to the power converter. A constant switching frequency operation can be achieved with this approach. The advantages of fuzzy and ANN can be combined as shown in Fig. 3.6 to achieve better control performance [151, 205, 206]. Even though the intelligent controllers do not need a converter model, they require precise knowledge about the converter operation/behavior. 54

3.2.5

Predictive Control Techniques

The predictive control (PC) uses the system model to predict the future responses of a plant. These predictions are then used to generate the optimal control action [209­216]. This control philosophy emerged during the 1970s for the process control which are normally very slow in nature [217]. With this approach, a systematic solution was provided to the multivariable constrained control problems of the oil and chemical industries, and due to its simplicity it was immediately welcomed by the industry [218­220]. The application of predictive control in power electronics is a rather recent topic due to the fast processing time required to control the electric variables [77]. With the evolution in DSPs, a wide range of predictive controllers have been developed which includes deadbeat PC, hysteresis-based PC, trajectory-based PC, and model-based PC (MPC) [78]. A deadbeat predictive control technique is shown in Fig. 3.7, where the PI regulators are replaced by the predictive controller to make the tracking error close to zero [221­241]. This is achievable by generating an appropriate reference load voltage during each sampling instant. A PWM/SVM modulator is then used to generate the gating signals to the power converter. This control strategy gives a better transient response compared to the classical controllers, but the system parameter variations and perturbations deteriorates the control performance. The system nonlinearities and constraints cannot be included in a straightforward way in the design of this controller [78]. The hysteresis and trajectory-based PC techniques combine hysteresis and sliding-mode controllers with the predictive controllers, and operate at variable switching frequency [75, 77, 78]. The MPC with continuous control-set [76] is similar to the deadbeat predictive control in terms of design and implementation [78]. The FCS-MPC is a simple and powerful control strategy that has been recently applied to power converters. A FCS-MPC strategy for the load current regulation is shown in Fig. 3.8. Compared to the classical control techniques, this scheme eliminates the need for linear PI regulators and the modulation stage, and offers a conceptually different approach to control the power converters. This is truly a model-based optimization control strategy, and involves a large number of calculations [75, 77, 78, 242­244]. However, the computational issue is not prominent due to the advanced digital control platforms (DSPs and FPGAs) available in the market. It is anticipated that this will be one of the next generation control tools, and thus is considered in this dissertation as a subject to control the megawatt WECS.

55

3.3

Finite Control-Set Model Predictive Control

To design an efficient controller, one needs to know about the true nature/behavior of the plant to be controlled. A power electronic converter exhibits the following properties, constraints and requirements [75, 77]: · Nonlinear nature especially during low switching frequency · Contains finite number of switching states, for example 8 switching states are available for 2L-VSC. · Imposes restrictions on the maximum current, switching frequency, efficiency and THD, etc., to achieve safe and reliable operation · Demands faster response for the electric control variables · Favors discrete-time implementation using the industry standard digital control platforms The FCS-MPC strategy has proved one of the best methods for treating all the above properties and conditions. Recent scholarly works demonstrated that FCS-MPC can easily be applied to a wide range of power converters, drives, power quality applications and energy systems [79]. The main features and challenges of the FCS-MPC are summarized as follows: Main Features of FCS-MPC: · Uses simple concepts and is easy to understand · An intuitive approach for real-time implementation · Uses the inherent discrete nature of the power converters · Treats the power converter as a discontinuous and nonlinear model which is the closest approximation to the real-time scenario · Optimizations are greatly simplified due to finite number of switching states · Can be applied to a wide variety of systems · Can handle multivariable control programs in a decoupled manner · System perturbations and dead times can be compensated 56

· System nonlinearities and limitations can be incorporated in a straight forward manner in the model · Constraint handling is naturally accommodated by the method · Many technical and control requirements can be fulfilled at the same time · This methodology is open to include modifications and extensions depending on specific applications Challenges of FCS-MPC: · Requires a large number of calculations · Operates with the variable switching frequency · Selection of weighting factors is not analytical or numerical · Control performance will be poor if the model of the system and prediction horizon is not formulated correctly The first challenge can be surpassed with the commercially available fast processors such as DSPs and FPGAs. The other control challenges are investigated rigorously in this dissertation research, and many solutions have been developed to promote the FCS-MPC strategy as the next generation high performance control tool.

3.3.1

Operating Principle and Design Procedure

Fig. 3.8 is considered here again to explain the operating principle and design procedure of the FCS-MPC scheme. Note that the explanation given here for the FCS-MPC is described in a broad sense, and not specific for the current control. It uses the system model to predict the future behavior of the variables to be controlled. The controller uses this information to obtain the optimal actuation, according to a predefined optimization criterion. A step-bystep procedure for the implementation is given below, which is intuitive to understand and easier to implement: Design Step­1: Measurements Obtain the feedback signals as per the requirement of predictive model or references generation. 57

Design Step­2: References Generation Generate the reference control variable x (k ) according to the specific application. Design Step­3: Extrapolation of References Extrapolate the reference control variable to (k + 1) instant. Different extrapolation methods will be discussed in the next section. Design Step­4: Development of Continuous-Time Models In this example, it is assumed that the power converter continuous-time model is of first-order nature: dx = Ax+ B u dt (3.1)

where A and B denotes the parameters of the converter (filter inductance, load resistance, dc-link capacitance, etc.), x represents the variable to be controlled (voltage, current, power, torque, flux, etc.), and u is input variable (dc-voltage, grid voltage, etc.). Design Step­5: Development of Discrete-Time Models The FCS-MPC is basically an optimization algorithm. To implement this strategy on digital control platforms, the continuous-time models should be converted to discretetime. In the control theory, many discretization methods are available such as: forward difference, backward difference, bilinear transformations (combination of forward and backward difference), impulse-invariant and zero-order hold [245]. Due to the first order nature of the state equations that describe the model in (3.1), a first-order approximation for the derivative can be obtained by forward or backward Euler method. The forward Euler method considers the future sample (k + 1) and present sample (k ) as described bellow: Forward Euler Method: where Ts is the discretization sampling time. By substituting (3.2) into (3.1), the discrete-time model for the control variable can be obtained as: x(k + 1) - x(k ) = A x(k ) + B u(k ) Ts x(k + 1) = (1 + ATs ) x(k ) + BTs u(k ). 58 x(k + 1) - x(k ) dx = dt Ts (3.2)

(3.3)

The backward Euler method provides approximation for the derivative by considering present (k ) and past (k - 1) samples: Backward Euler Method: dx x(k ) - x(k - 1) . = dt Ts (3.4)

Using the derivative approximation given in (3.4), the continuous-time system in (3.1) can be converted to discrete-time as: x(k ) - x(k - 1) = A x(k ) + B u(k ) Ts 1 BTs x(k ) = x(k - 1) + u (k ). (1 - ATs ) (1 - ATs ) By shifting the above variables into one future sample, x(k + 1) = BTs 1 x(k ) + u(k + 1) (1 - ATs ) (1 - ATs ) (3.6)

(3.5)

where u(k +1) is the extrapolated input. More details about the extrapolation methods will be given in Section 3.3.4. The forward Euler method presents a simple approach for the discrete-time conversion, but stable poles in the s plane of continuous-time system may be mapped to unstable poles in z plane of discrete-time system. In other words, the positive real continuous system may be converted to non-positive real discrete-time system. However, the backward Euler method can convert stable poles in s plane to stable poles in z plane, and marginally stable poles to asymptotically stable poles. The non-positive real continuous system can also be transformed to a positive real discrete system with the backward Euler method [245, 246]. For this reason, in this dissertation, the backward Euler method is considered to convert the continuous-time systems to discrete-time. Design Step­6: Prediction of Variables Using the discrete-time models, present sampling instant (k ) measurements and past sample optimal variable xp op (k ), predict the future behavior of the control variables. The operating principle for the prediction of variables using a one-step prediction horizon is shown in Fig. 3.9, assuming that the converter possesses 5 switching states. The 5 possible switching states lead to 5 predictions for the variable to be controlled (refer to 59

equation [3.6)]. Compared to the classical control techniques which observe past and present values of the variable, the FCS-MPC strategy observes the past, present and future of the variable. Design Step­7: Cost Function Minimization
p p p As a final stage, the predicted variables xp 1 (k + 1), x2 (k + 1), x3 (k + 1), x4 (k + 1) and  xp 5 (k +1) are compared with their reference x (k +1) using a cost function gk as follows:

gk = ||x (k + 1) - xp (k + 1)||.

(3.7)

The goal of cost function optimization is to achieve g value close to zero. The switching state which minimizes the cost function is chosen and then applied at the next sampling instant. As shown in the next section, additional constraints can also be incorporated into the cost function. During each sampling instant, the minimum value of g is selected from the 5 function values. At the (k th ) instant, the algorithm selects a switching state which would minimize the cost function at the (k + 1) instant, and then applies this optimal switching state during the whole (k + 1) period. As a final note, the FCS-MPC method uses only the model of system. Unlike in classical control schemes, this method does not require any internal current control loops or a modulation stage.

x x xp op (k - 1)

Past Sample

1st -Step

2nd -Step

Ts xp op (k ) S1 S2 S3 S4 S5

Ts S1 S2 S3 S4 S5 xp 1 (k + 1) xp 2 (k + 1) xp 3 (k + 1) p x4 (k + 1) xp 5 (k + 1)

Ts

tk-1

tk

tk+1

tk+2

t

Figure 3.9: FCS-MPC strategy with one-step prediction horizon.

60

3.3.2

Cost Function Flexibility

One of the best features of FCS-MPC strategy is that several control objectives can be fulfilled at the same time as long as they are a mathematical function of the converter switching states. As demonstrated in Fig. 3.10, with an appropriate definition of cost function, a better control flexibility can be obtained with the optimization of several control goals. The control objectives for the power converter can be broadly classified as primary and secondary goals. The primary objectives include, but are not limited to, load current/voltage control, grid active/reactive power control, and machine torque/flux control. The fulfilment
Secondary Objectives

Capacitor Voltages Balancing p p dc  |vc 1 - vc2 | p vc = f (Sk+1 ) Filter Resonance Mitigation r  |W1 ip | ip = f (Sk+1 )

dc

Weighting Factors

Switching Frequency Reduction swc  nswc nswc = f (Sk+1 )

r
Primary Objectives p p   p |i a - ia | + |ib - ib | + |ic - ic |
p  p   p |va - va | + |vb - vb | + |vc - vc |

swc

Peak Current Limitation lim  |ip | < imax ip = f (Sk+1 )

lim

|P  - P p | |Q - Qp | |Te - Tep |
 p |s - s |

cmv

Common-Mode Voltage Minimization cmv  cmv cmv = f (Sk+1 )

vdc

ss

Net dc-bus Voltage Control p  - vdc | vdc  |vdc p vdc = f (Sk+1 )

swl

Spectrum Shaping ss  |F (i - ip )| ss  |DF T (i - ip )| ip = f (Sk+1 )

Switching Losses Reduction swl  Eswl Eswl = f (Sk+1 )

Figure 3.10: Overview of cost function definition with primary and secondary objectives.

61

of the primary objectives is essential to ensure the proper operation of a system involving the power converter. The cost function is shown as an absolute minimization function, but quadratic function can also be used to achieve over-proportionate control action against the reference tracking [75]. To improve the performance of the converter or to meet particular control/technical requirements, many secondary objectives such as the dc-link capacitor voltages balancing, switching frequency reduction in one or all phases, common-mode voltage minimization, load waveform spectrum shaping, switching losses reduction of any particular switch or whole converter, net dc-bus voltage control in the grid-connected case, peak current limitation in motor drives, and LC/LCL filter resonance mitigation can be easily included in the cost function as demonstrated in Fig. 3.10 [75, 77­79]. The relative importance of one objective over the other can be set through the weighting factors. Since the control variables possess a different physical nature (current, voltage, power, torque, flux, frequency, losses, etc.), they lead to coupling effects, and thus the selection of suitable weighting factors becomes tedious. The analytical or numerical procedure for the weighting factor selection is still an open topic for research. In [247], some guidelines are presented for the selection of the weighting factor. In this dissertation, a detailed empirical procedure for the selection of weighting factors is presented to help the reader develop a similar strategy in his/her works.

3.3.3

Delay Compensation Methods

The cost function presented earlier in Fig. 3.9 considers the minimization at (k + 1) sampling instant which is suitable for computer simulations. The FCS-MPC strategy uses optimization algorithm and thus incurs a large number of online calculations. The computer simulations represent an ideal case where the time taken to compute these online calculations is zero [77]. According to this approach, the switching state which minimizes the error at the (k + 1) instant is selected and applied at the (k th ) instant. This method is most commonly referred to as a one-step or one sample-ahead (h = 1) predictive controller. In the real-time implementation of FCS-MPC algorithm, the large number of online calculations introduce a considerable time delay in the actuation [77, 248­252]. The delay caused by the digital signal processor is most significant and it must be compensated for. The delays associated with the response of the gate drive circuitry, sensors and switching of the devices can be disregarded due to their small magnitude, even for high sampling rates. The 62

x x xp op (k - 1)

Past Sample

1st -Step

2nd -Step

Ts xp op (k ) S1 S2 S3 S4 S5

Ts x ^(k + 1)

Ts xp 1 (k + 2) xp 2 (k + 2) xp 3 (k + 2) p x4 (k + 2) xp 5 (k + 2)

S1 S2 S3 S4 S5

tk-1

tk

tk+1

tk+2

t

Figure 3.11: Delay compensation method­1 using modified one-step prediction horizon.
x x xp op (k - 1)
Past Sample 1st -Step 2nd -Step

Ts xp op (k ) S1 S2 S3 S4 S5

Ts S1 S2 S3 S4 S5

Ts S1,1 . . . S5,4 S5,5 xp 25 (k + 2) tk+2 t xp 1 (k + 2)

. . .

tk-1

tk

tk+1

Figure 3.12: Delay compensation method­2 using standard two-step prediction horizon.
x x xp op (k - 1)
Past Sample 1st -Step 2nd -Step

Ts xp op (k ) S1 S2 S3 S4 S5

Ts

Ts S1 S2 S3 S4 S5 xp 5 (k + 2) xp 1 (k + 2) p x2 (k + 2) xp 3 (k + 2) p x4 (k + 2)

tk-1

tk

tk+1

tk+2

t

Figure 3.13: Delay compensation method­3 using simplified two-step prediction horizon.

63

computational delay deteriorates the performance of the system if it is not considered in the design of the controller. This delay can be compensated by calculating the cost function for two-samples ahead (k + 2). This approach allows one sampling period (Ts ) for the control delay and another sampling period for the optimization algorithm. The selected optimal switching state can be applied at (k + 1) sampling instant. To achieve this, three different methods can be used as shown in Figs. 3.11, 3.12, and 3.13. Delay Compensation Method­1: A modified one-step prediction as shown in Fig. 3.11 has been proposed in [248­252] to compensate the delay. According to this approach, the optimal switching state from the previous iteration [xp op (k )] is used to estimate the variables at (k + 1) instant [^ x(k + 1)], and all the possible switching states are used to predict the variables at (k + 2) instant. The estimation of x ^(k + 1) leads to higher number of calculations and thus increases the switching frequency of power converter. Delay Compensation Method­2: A standard two-step predictive horizon-based FCSMPC strategy has been proposed in the literature [253­256] to achieve high control performance. As given in Fig. 3.12, this approach can also be used to compensate the delay, but with a higher computational burden. For example, if the converter has 5 switching states, then the number of (k + 2) predictions would become 25 (52 ). This approach is suitable for converters having a lower number of switching states, but is impractical for multilevel converters which have a large number of switching states. For an NPC converter, 729 (272 ) different combinations exist and the current DSPs cannot handle these large numbers of calculations. Delay Compensation Method­3: A modification to the standard two-step prediction horizon is proposed in this dissertation. As shown in Fig. 3.13, the proposed approach minimizes the number of calculations while preserving the two-step prediction horizon. The predictions are projected to (k + 2) sampling instant, meaning that the same switching states are used in both (k + 1) and (k + 2) predictions. As shall be demonstrated in the next chapters, this approach gives a better performance than Method 1, and a performance almost similar to that of Method 2. The switching frequency obtained with the proposed approach is less than the one obtained with Methods 1 and 2. Even though the number of calculations is higher compared to Method 1, the switching frequency is lower because the calculations are performed over two samples. 64

The computational requirement is only a few s higher than Method 1, and thus this approach can be implemented using the DSPs available in the market. In the research being carried out over the past 5 years, both Methods 1 and 3 have been used in the experimental validation of FCS-MPC algorithms. The works presented in Chapters 5, 6 and 7 use Method 1, while the Chapters 4, 8 and 9 use Method 3.

3.3.4

Extrapolation Methods

One of the important requirements in the FCS-MPC strategy is reference tracking. The switching state which minimizes the reference tracking error in (k + 1) or (k + 2) sampling instant is selected and applied to the power electronic converter directly. When the sampling time Ts is sufficiently small (< 20 s), no extrapolation is required. This implies that the sampling frequency is much higher than the fundamental frequency of the variables which need to be controlled. When the FCS-MPC strategy works with higher sampling times (lower sampling frequencies), the references should be extrapolated to (k + 1) or (k + 2) sampling instant to effectively minimize the tracking error. In the dq frame, the variables are dc in nature and thus no extrapolation is required during steady-state operation. However, during transient operation, a delay occurs between the reference and variable to be controlled, and to overcome this issue an extrapolation method should be used. In the state-of-the-art FCS-MPC strategy, Lagrange and vector angle methods are used for the extrapolation of variables [77, 221, 257­261]. A third-order Lagrange method for one sample ahead (k + 1) extrapolation is given as follows [77, 221]. This method uses present and two past sample values of the variable that needs to be extrapolated. The variable x represents either voltage, current or power. The estimated quantity is noted as x ^. x ^(k + 1) = 3 x(k ) - 3 x(k - 1) + x(k - 2). (3.8)

For two-sample ahead (k + 2) extrapolation, the following Lagrange method can be used: x ^(k + 2) = 3 x ^(k + 1) - 3 x(k ) + x(k - 1). (3.9)

65

By substituting (3.8) in (3.9), the future value can be estimated using present and past sample values as demonstrated below: x ^(k + 2) = 6 x(k ) - 8 x(k - 1) + 3 x(k - 2). (3.10)

To increase the performance of FCS-MPC strategy, a higher-order extrapolation method can be employed [257­260]. A fourth-order Lagrange method for (k + 1) and (k + 2) extrapolation is given as follows [258, 259]: x ^(k + 1) = 4 x(k ) - 6 x(k - 1) + 4 x(k - 2) - x(k - 3) x ^(k + 2) = 10 x(k ) - 20 x(k - 1) + 15 x(k - 2) - 4 x(k - 3). (3.11) (3.12)

For two-samples ahead (k +2) extrapolation, the coefficients employed in two- and higherorder Lagrange methods are summarized in Table 3.1 [260]. Table 3.1: Coefficients for two-samples ahead (k + 2) Lagrange extrapolation method
Order ax 2 3 4 5 6 7 3 6 10 15 21 ax-1 2 -8 -20 -40 -70 ax-2 0 3 15 45 105 210 ax-3 0 0 -4 -24 -84 -224 ax-4 ax-5 ax-6 0 0 0 5 35 140 0 0 0 0 -6 -48 0 0 0 0 0 7

28 -112

Another possible approach for the extrapolation is the vector angle method. In this approach, during each sampling interval, the change in vector angle of the three-phase variables is considered as the basis for extrapolation. A nth order vector angle extrapolation is given as follows [77]: x ^(k + h) = x(k ) ej h  T s (3.13)

where  is the angular frequency of three-phase variables, and h is prediction horizon length. 66

The x(k ) in (3.13) can be a complex variable with real and imaginary quantities. This approach is best suited for the stationary frame ( ) variables [261]. This method cannot be used in single-phase systems [77].

3.4

Comparison of FCS-MPC with Linear Control

A comparison between the classical and FCS-MPC strategy is performed based on the research results presented in the literature and summarized as shown in Table 3.2. The analysis suggests that the FCS-MPC strategy is an intuitive and powerful tool to control the power converters compared to the classical linear methods.

Table 3.2: Comparison between classical linear control and FCS-MPC
Description Control diagram Model [262] Classical Fig. 3.2 Linear load model for PI & Inverter model for SVM Controller design [75] PI adjustment (root locus) + Modulator design Nature of controller [78] Implementation platform [75] Modulation Switching frequency [75] Multivariable [77] Constraints inclusion Complexity of concept [263] Steady-state performance [77] Transient performance [264, 265] Computational burden Robustness of controller [77, 266] Stability of controller [260, 267] Linear Analog or digital PWM/SVM/SHE Fixed Coupled Not possible High with SVM Good in dq frame Moderate High with SVM Poor Moderate Nonlinear Digital Not required Variable (but controllable) Decoupled easy to include Simple and intuitive Good in abc,  and dq frames Excellent High Excellent Excellent FCS-MPC Fig. 3.8 Discrete-time model of the complete system Cost function definition

67

3.5

Conclusion

In this chapter, the state-of-the-art converter control techniques are reviewed, followed by the explanation of different classes of the predictive control techniques. The implementation of different control techniques for the output current control is presented along with their main features and challenges. The operating principle of the FCS-MPC strategy is presented for ideal and implementation cases. The cost function flexibility and potentiality in achieving different control and technical requirements is discussed. The issues and challenges related to the FCS-MPC strategy, such as the computational burden, development of control algorithm, delay compensation, and extrapolation of reference variables is discussed in detail. The analysis presented in this chapter favors the FCS-MPC strategy as the next generation control tool to achieve high performance operation for the power converters.

68

Chapter 4 Generalized Approach for Predictive Control in High-Performance Multilevel Diode-Clamped Converters
Multilevel converters are recognized as among the most suitable and efficient candidates to be used in high-power, medium-voltage (MV) industrial applications [8, 61]. They can synthesize near sinusoidal voltages while increasing the number of levels, leading to good power quality and smaller output filters. In addition, higher levels of MV operation can be achieved without connecting the switching devices in a series. The most popular and well-known multilevel topologies are flying capacitor, cascade H-bridge and diode-clamped converters (DCCs) [84, 106]. By using clamping diodes to divide the dc-link voltage among several capacitors, different configurations, ranging from three-level (3L) to m-level (ML) DCCs can be obtained. This chapter proposes a generalized approach based on a finite control-set model predictive strategy for the current control, dc-link capacitor voltages balancing, switching frequency reduction and common-mode voltage mitigation in MLDCCs. The discrete-time model of an m-level DCC is presented, where all the control objectives are formulated in terms of the switching states. The control goals are expressed as a cost function and its minimization is used as a criterion to choose the best switching state which would be applied to the converter during the next sampling interval. The real-time digital control issues such as computational burden and delay compensation are also discussed. The feasibility of the proposed method is verified by simulations in 3- to 6-level converters and by experiments in 3- and 4-level converters. 69

4.1

Control Requirements and Challenges

The MLDCCs are suitable for many industrial applications such as: STATCOM, train traction, ship propulsion, regenerative conveyors, wind and photovoltaic energy systems, and general MV motor drive applications (pumps, fans, etc.) [84,106]. In these applications, current control is one of the most important issues and it has been widely studied in literature [104, 105, 160, 268, 269]. The most popular classical methods as introduced in Chapter 3 are: hysteresis control [160] and linear control (PI) with the space vector modulation (SVM) or pulse width modulation (PWM) [104, 105, 268, 269]. The SVM method gives the best harmonic profile compared to the PWM approach, but its computational burden and complexity increases with the number of levels in DCC. Especially when the number of levels in DCC increase, the switching actions in the MLDCCs leads to an imbalance among the dc-link capacitor voltages [270]. In order to solve this issue, many methods have been proposed in the literature which can be classified as: use of external hardware [96], SVM with the redundant switching states selection [171], and PWM with zero sequence voltage injection [97]. All of these methods have widely been studied for 3L- to 6L-DCCs as reported in [104, 105, 268, 269] where a generalized classical approach to control the MLDCCs have been proposed. Another important challenge for MLDCCs is the operation at low switching frequency in order to minimize the switching losses and to allow proper heat dissipation [271]. This requirement can be accomplished with the PWM and SVM techniques by simply changing the carrier frequency. Unfortunately, low order harmonics are produced by the PWM and SVM techniques when operated below 1 kHZ leading to poor output current quality [74]. One more critical issue with the MLDCCs is that the fast switching actions of the semiconductor devices cause high dv/dt in the converter output voltages and this leads to higher common-mode voltage (CMV). The CMV is undesirable when the MLDCC is used in motor drive and grid-connected applications [272­274]. The hardware (common-mode choke) [275, 276] and/or software reconfigurations are considered as possible solutions for the CMV mitigation in MLDCCs. The latter process, with the improvement to PWM/SVM techniques, is a cost effective and attractive solution, and it is widely studied for MLDCCs [272­274, 277, 278]. The complexity of the improved SVM increases with the number of levels in DCC. 70

As mentioned in Chapter 3, the finite control-set model predictive control (FCS-MPC) takes over the functions of linear regulators and SVM/PWM modulators. To accomplish the aforementioned control requirements, many works based on FCS-MPC have already been reported for 3L-DCC [279, 280], 4L-DCC [80, 81, 107, 281], and 5L-DCC [282, 283]. The state-of-the-art research work being carried out for high performance control in the MLDCCs is summarized in Fig. 4.1. The software reconfiguration (changes to computer program) to achieve the control goals in MLDCCs is a recommended solution than the hardware reconfiguration (use of external hardware). The software reconfiguration using classical control methods has been widely studied in literature [104, 105, 268, 269]. Similar to the classical methods, the predictive control for the MLDCCs can be generalized, but this issue has not been addressed yet. In this chapter, a generalized approach for the predictive control of MLDCCs is proposed. The discrete-time model of the converters and dc-link capacitor currents estimation is presented such that they can be applied to m-level DCC. The load/motor/grid current control, dc-link capacitor voltages balancing, lower switching frequency operation, and CMV reduction are expressed as a cost function. With the help of weighting factors, these control goals are met simultaneously.
HighPerformance MLDCCs

Control Requirement

Load/Grid Current Regulation

Balancing of DC-link Cap. Voltages

Switching Frequency Reduction

Common-Mode

Voltage Minimization

Possible Solutions

Software
Reconfiguration

Software
Reconfiguration

Hardware
Reconfiguration

Software
Reconfiguration

Software
Reconfiguration

Hardware
Reconfiguration

Recommended Solution

Generalized Approach

Existing Solution Proposed Solution

Classical
PWM/SVM Generalized FCS-MPC

Figure 4.1: Overview of state-of-the-art and proposed solutions for high performance control in MLDCCs.

71

4.2

Review of Multilevel DCCs

To facilitate the discussions leading to the generalized modeling and control in this section, a brief review of MLDCCs is presented. The per-phase diagram of 3L to 6L converters is shown in Fig. 4.2. For a given dc-link voltage rating, the voltage rating of active switches, clamping diodes and dc capacitors decreases with the increase in the number of levels. The clamping diodes are connected in a series to withstand the different reverse blocking voltages [84]. The component count and switching states of the MLDCCs are summarized in Table 4.1. As the number of converter voltage levels increase, the switching states increase proportionately and this leads to higher computational burden with the classical or predictive control method. The space vectors generated by an m-level converter is shown in Fig. 4.3 and it can be observed that the outer-most voltage vector contains only one redundancy. The switching states and corresponding converter terminal voltages are given in Table 4.2, where Sx represents the voltage level of the converter.

Table 4.1: Components, switching states and voltage vectors count for MLDCC
Voltage Active Levels Switches 3 4 5 6 . . . m 12 18 24 30 . . . Clamping Diodes 6 18 36 60 . . . DC-link Neutral Switching Capacitors Points States 2 3 4 5 . . . m-1 1 2 3 4 . . . m-2 27 64 125 216 . . . m3 Voltage Vectors 19 37 61 91 . . . m3 - (m - 1)3

6(m - 1) 6(m - 1) (m - 2)

Table 4.2: MLDCC terminal voltages versus switching states (x = a, b, c)
Sx S(m-1)x S(m-2)x S(m-3)x S(m-4)x S(m-5)x · · · 0 1 2 3 4 5 . . . 0 1 1 1 1 1 . . . 0 0 1 1 1 1 . . . 0 0 0 1 1 1 . . . 0 0 0 0 1 1 . . . 0 0 0 0 0 1 . . . vxN

··· 0 ··· vc 1 ··· vc1 + vc2 ··· vc1 + vc2 + vc3 ··· vc1 + vc2 + vc3 + vc4 · · · vc1 + vc2 + vc3 + vc4 + vc5 . . . . . .

72

+

(2)

P S1a S2a

+

(3)

P S1a S2a S3a

vc3

+ -

vc2

+ -

(2)

vdc

ia
(1)

a
+

vdc vc2

+ -

ia

a
+

vc1

+ - (1)

vaN S 1a vc1
- + -

v S 1a aN S 2a S 3a
(0)

-

S 2a
(0)

N

-

N

-

(a) Three-level (m = 3) DCC
(4)

(b) Four-level (m = 4) DCC
(5)

+

P S1a S2a S3a

+

P S1a S2a S3a S4a S5a ia S 1a S 2a v S 3a aN S 4a S 5a N
-

vc4

+

- (3)

vc5

+

- (4) + -

vc4

vc3

+ -

S4a ia

(3) + -

vdc

(2)

a
+

vdc

vc3

a
+

(2)

vc2

+ -

S 1a v S 2a aN

vc2

+ -

vc1
-

(1) + - (0)

S 3a S 4a N
- -

vc1

(1) + - (0)

(c) Five-level (m = 5) DCC

(d) Six-level (m = 6) DCC

Figure 4.2: Per-phase diagram of multi-level diode-clamped converters.

73

4.3

Generalized Model of Multilevel DCCs

The FCS-MPC approach works on a different conceptual approach to control the power converters, and eliminates the need for linear regulators and SVM/PWM modulators. This approach is basically an optimization algorithm whose actions mainly depend on the discretetime model of the converter, load/grid and dc-link. In this section, a generalized discrete-time model of the MLDCC is formulated.

4.3.1

Model of Load/Motor/Grid Currents

One of the important requirements for the MLDCCs is regulation of converter output current. Most of the applications, such as motor drives and grid-connected systems, can be simply represented as a RLE load. A MLDCC with such a load is shown in Fig. 4.4, where, Lf and Rf represents the load filter inductance and its leakage resistance, respectively. Load resistance and back emf are represented as R and e respectively. To reduce the number of calculations, load current modeling is carried out in a stationary reference frame ( ) [77].
j
Number of Redundancies
=m =m-1 =m-2 =m-3 =m-4 =1



Figure 4.3: Space vectors generated by the multilevel diode-clamped converter.

74

Phase­a
+ (m - 1) + vc(m-1) - z(m-2) + vc(m-2) - z(m-3) vc(m-3) - z(m-4) vc(m-4) - z1 + vc1 - - + +
Cdc(m-1)

P S1a
×1 ×(m - 4) ×(m - 2) ×(m - 3)

(m - 2)

S2a S3a

Cdc(m-2)

(m - 3) S(m-1)a

vdc

Cdc(m-3)

×(m - 2)

(m - 4) ×(m - 3)

Phase­c

a

Phase­b

ia

Rf a , Lf a

Ra

ea

Cdc(m-4)

×(m - 4)

S 1a S 2a S 3a

ib

Rf b , Lf b

Rb

eb

n

(1) ×1
Cdc1

ic

Rf c , Lf c

Rc

ec

S (m-1)a

Back emf/ Grid

(0)

N

Figure 4.4: Topology of multi-level diode-clamped converter with RLE load.

The load currents can be represented as follows by applying the Kirchhoff's law to the Fig. 4.4 [262, 279]: 1 d i = [v - e - (Rf + R) i ] dt Lf 1 d i = [v - e - (Rf + R) i ] . dt Lf (4.1)

In (4.1), the three-phase measured load currents (ia , ib , ic ) and back emf (ea , eb , ec ) are converted to  frame. For the motor drives application, the back emf can be estimated using the guidelines given in [262, 279]. v and v are stationary frame inverter voltages and they are obtained from the transformation of three-phase voltages (with respect to negative dc-rail N ) given as follows:       Sa == (m - 1) Sa == 1 vaN        vbN  = [vc1 ]  Sb == 1  + · · · + vc1 + · · · + vc(m-1)  Sb == (m - 1)  vcN Sc == 1 Sc == (m - 1)

(4.2)

where vc1 and vc(m-1) are dc capacitor voltages. Sa , Sb and Sc represents the voltage levels of a three-phase converter. For a 5L-DCC, the relation between the Sx and switching states 75

can be summarized as: Sx == 0 if S 1x S 2x S 3x S 4x = 1 Sx == 1 if S 1x S 2x S 3x S4x = 1 Sx == 2 if S 1x S 2x S3x S4x = 1 Sx == 3 if S 1x S2x S3x S4x = 1 Sx == 4 if S1x S2x S3x S4x = 1 where S1x , S2x , S3x and S4x are the switching signals of the phase x = a, b, c. The switching pairs (S1x , S 1x ), (S2x , S 2x ), (S3x , S 3x ) and (S4x , S 4x ) are complementary in nature. Similar analysis can be carried out for other MLDCCs. The continuous-time model can be converted to discrete-time by approximating the derivative using the backward Euler method [258, 262, 279]: dx x(k ) - x(k - 1) = dt Ts where Ts is the sampling time used in the discrete-time conversion and control. By substituting (4.4) in (4.1), the discrete-time model for the load currents can be obtained as [77, 258]: i (k ) - i (k - 1) 1 = [v (k ) - e (k ) - (Rf + R) i (k )] Ts Lf i (k ) - i (k - 1) 1 = [v (k ) - e (k ) - (Rf + R) i (k )] . Ts Lf The above expression can be simplified as, i (k ) = Kv [v (k ) - e (k )] - Ki i (k - 1) i (k ) = Kv [v (k ) - e (k )] - Ki i (k - 1) where Kv and Ki are defined as [258]: Kv = Ts Lf + (Rf + R)Ts Lf Ki = . Lf + (Rf + R)Ts (4.4) (4.3)

(4.5)

(4.6)

(4.7)

By shifting the variables in (4.6) one-sample forward, the following system can be ob76

tained:

i (k + 1) = Kv [v (k + 1) - e (k + 1)] - Ki i (k ) i (k + 1) = Kv [v (k + 1) - e (k + 1)] - Ki i (k )

(4.8)

where e (k + 1) and e (k + 1) are extrapolated back emf values [77]. The variables in (4.8) can be expressed for a prediction horizon h as: i (k + h) = Kv [v (k + h) - e (k + h)] - Ki i (k + h - 1) i (k + h) = Kv [v (k + h) - e (k + h)] - Ki i (k + h - 1).

(4.9)

The models in (4.1) to (4.9) correlate the output currents to the switching signals, and with the appropriate selection of switching signals, the converter output currents can be regulated precisely. Note that the model given in (4.7) and (4.9) can be used for grid connection as well, where the load inductor and resistor are replaced by the inductive grid filter and its internal resistance, and the back emf by the grid voltage (which is usually measured for synchronization).

idc P(4) ic4
C4
(3)

i4
Sa == 3 Sa == 2 Sa == 4

Sa == 1

i3 ic3

ia
Sa == 0 Sb == 4

C3
(2)

i2 ic2

Sb == 3 Sb == 2 Sb == 1

ib
Sb == 0

C2
(1)

i1 ic1

Sc == 3 Sc == 2 Sc == 1

Sc == 4

ic
Sc == 0

C1

i0
N(0)

Figure 4.5: Simplified representation of the power circuit model for a 5L-DCC.

77

4.3.2

Model of DC-link Capacitor Voltages

Another important requirement in the MLDCCs is to balance the dc-link capacitor voltages; otherwise the semiconductor device voltage stress increases. To facilitate the discussion, a 5L-DCC is considered and its simplified dc-link model is represented in Fig. 4.5. The relationship between inverter branch currents (i1 , i2 , i3 , i4 ) and capacitor currents (ic1 , ic2 , ic3 , ic4 ) can be expressed as follows considering the representation given in Fig. 4.5: ic4 = idc - i4 , ic2 = ic3 - i2 , ic3 = ic4 - i3

ic1 = ic2 - i1 .

(4.10)

By solving the system in (4.10), the capacitor current can be given as: ic4 = idc - i4 ic3 = idc - i4 - i3 ic2 = idc - i4 - i3 - i2 ic1 = idc - i4 - i3 - i2 - i1 . The common current idc does not contribute to the voltage drift of the capacitors, therefore, (4.11) can be simplified as: ic4 = -i4 ic3 = -i4 - i3 ic2 = -i4 - i3 - i2 ic1 = -i4 - i3 - i2 - i1 . The inverter branch currents (i1 , i2 , i3 , i4 ) can be expressed in terms of load currents (ia , ib , ic ) and MLDCC switching states as follows: i4 = (Sa == 4) ia + (Sb == 4) ib + (Sc == 4) ic i3 = (Sa == 3) ia + (Sb == 3) ib + (Sc == 3) ic i2 = (Sa == 2) ia + (Sb == 2) ib + (Sc == 2) ic i1 = (Sa == 1) ia + (Sb == 1) ib + (Sc == 1) ic . By substituting (4.13) in (4.12), the capacitor currents can be related to the load currents 78 (4.13) (4.12) (4.11)

as: ic4 = K4a ia + K4b ib + K4c ic ic3 = K3a ia + K3b ib + K3c ic ic2 = K2a ia + K2b ib + K2c ic ic1 = K1a ia + K1b ib + K1c ic . The gains K4x , K3x , K2x , K1x are a function of voltage level of the phase x = a, b, c as shown in Table 4.3. This approach can be summarized for an m-level DCC as follows: icj =
x=a,b,c

(4.14)

Kjx ix . j = 1, · · · , m - 1.

(4.15)

The gains Kjx for phase x = a, b, c can be generalized as: K1x K2x K3x . . . = = = sgn (0 - Sx ) sgn (1 - Sx ) sgn (Sx ) sgn (2 - Sx ) sgn (Sx ) sgn (Sx - 1) . . .

(4.16)

K(m-2)x = sgn ((m - 3) - Sx ) sgn (Sx ) sgn (Sx - 1) · · · sgn (Sx - (m - 4)) K(m-1)x = sgn ((m - 2) - Sx ) sgn (Sx ) sgn (Sx - 1) · · · sgn (Sx - (m - 3)) where sgn(.) is a signum function:     -1 sgn (x) = 0    1 if x < 0 if x = 0 if x > 0. (4.17)

Table 4.3: Relationship between switching states and coefficients of capacitor currents for a 5L-DCC (x = a, b, c)
Sx 4 3 2 1 0 S1x 1 0 0 0 0 S2x 1 1 0 0 0 S3x 1 1 1 0 0 S4x 1 1 1 1 0 vxN vc4 + vc3 + vc2 + vc1 vc3 + vc2 + vc1 vc2 + vc1 vc 1 0 K1x -1 -1 -1 -1 0 K2x -1 -1 -1 0 0 K3x -1 -1 0 0 0 K4x -1 0 0 0 0

79

The relation between the dc-link capacitor voltages and currents can be expressed in continuous time as: 1 vc1 ic1 = dt C1 . . . . . . vc(m-1) 1 = ic(m-1) dt C( m - 1)

. . .

(4.18)

where ic1 and ic(m-1) are the currents through the capacitors C1 and C(m-1) , respectively. The above model can be expressed in discrete time as [81, 279, 281]: vc1 (k ) = vc1 (k - 1) + . . . . . . Ts ic1 (k ) C1 . . . Ts C(m-1) ic(m-1) (k )

(4.19)

vc(m-1) (k ) = vc(m-1) (k - 1) + and,

Ts ic1 (k + 1) C1 . . . . . . . . . Ts vc(m-1) (k + 1) = vc(m-1) (k ) + ic(m-1) (k + 1) C(m-1) vc1 (k + 1) = vc1 (k ) + The above expression can be generalized for a prediction horizon h as: vc1 (k + h) = vc1 (k + h - 1) + . . . . . . Ts ic1 (k + h) C1 . . . Ts C(m-1) ic(m-1) (k + h)

(4.20)

(4.21)

vc(m-1) (k + h) = vc(m-1) (k + h - 1) +

These currents ic1 and ic(m-1) can be estimated using the measured load/grid currents (ia , ib , ic ) and switching states of the converter [81, 279, 281]. The generalized calculation for an m-level DCC is as follows: icj (k + h) =
x=a,b,c

Kjx (k + h) ix (k + h). j = 1, · · · , m - 1.

(4.22)

The dynamics in (4.16)-(4.22) suggests that the dc-link capacitor voltages are also a function of switching signals. The proper selection of switching signal leads to accurate balancing of the capacitor voltages. 80

4.3.3

Model of Common-Mode Voltage

The modeling of common-mode voltage (CMV) is different for odd-level (3L and 5L) and even-level (4L and 6L) DCCs. In odd-level DCCs, the CMV exists between the neutral-point of the load/motor/grid (n) and the mid-point of dc-link capacitors (o) [274, 277]. The CMV in odd-level DCC can be expressed in terms of switching states as follows: vcm = vno 1 = m-1
m-1

vcj
1

1 3

Sx - m + 1 . 2 x=a,b,c

(4.23)

For a 3L-DCC, the above expression can be simplified as: vcm = vno = vc1 + vc2 (Sa - 2) + (Sb - 2) + (Sc - 2) . 2 6 (4.24)

In even-level DCCs, the number of dc-link capacitors is odd and there exists no midpoint. The CMV is measured between the neutral-point of the load/motor/grid (n) and the negative dc-rail (N ) [276]: vcm = vnN = vaN + vbN + vcN 3 (4.25)

where vaN , vbN and vcN are inverter terminal voltages [refer to Eq.(4.2)]. The systems in (4.2), (4.23) and (4.25) depict that the CMV is related to the switching signals. In odd-level DCCs, the CMV can be reduced to zero value with the proper selection of switching signals. In the even-level DCCs, there exists no switching state which would achieve a zero CMV value [276], but it can be reduced to some extent with the optimal selection of switching states. Additional hardware such as common-mode choke is required in even-level DCCs to reduce the CMV to zero.

81

4.4

Predictive Control of Multilevel Diode-Clamped Converters

Based on the generalized model discussed before, a predictive control approach is presented in this section for an m-level converter. The proposed predictive control scheme is shown in Fig. 4.6. As displayed, no PI controllers or modulators are used in the control loop. The main parts of the predictive control are discussed as follows:

4.4.1

Definition of Cost Function

All the control objectives are expressed as cost functions. By minimizing the cost functions during each sampling interval, the control goals can be met.

MLDCC

ia (k ) vc(m-1)
P

Rf a , Lf a Ra

ea

vdc

vc(m-2) vc(m-3) vc1
N 6 × (m - 1)

ib (k )

Rf b , Lf b Rb

eb

n ic (k ) Rf c , Lf c Rc
ec

Back emf/ S(k) Grid

i  (k + 2)
Cost function Minimization

i  (k + 2)

Extrapolation

vc1 (k. + 2) . . vc(m-1) (k + 2)
Predictive S(k) Controller

i (k + 2) i (k + 2) i  (k ) i  (k )

i (k ) i (k )

vc1.(k ) . . vc(m-1) (k )

Figure 4.6: FCS-MPC scheme for multilevel diode-clamped converter.

82

The main objective for the DCC is to regulate the load/motor/grid current which is expressed as:
2  gtrack (k ) = [i  (k + h) - i (k + h)] + i (k + h) - i (k + h) 2

(4.26)

 where i  (k + h) and i (k + h) are the extrapolated references to the h-state. This can be

performed using Lagrange or vector angle extrapolation [77, 258]. The dc-link capacitor voltages balancing objective is expressed as another cost function: gdc (k ) = dc
j =1,··· ,m-1

[vcj (k + h) - vcj +1(k + h)]2

(4.27)

where dc is the weighting factor for the dc capacitor voltages balancing task. The switching frequency minimization can be achieved by penalizing the cost function as: gswc (k ) = swc
x=a,b,c

swcx

(4.28)

where swc is the weighting factor for the switching frequency minimization. swcx represents the number of switch changes involved in phase x = a, b, c, and they can be calculated as shown in Table 4.4. Sx,op (k ) is the optimal voltage vector in the previous sample.

Table 4.4: Calculation of number of switch changes for MLDCC (x = a, b, c)
Sx (k + 1) swcx Sx,op (k ) = 0 Sx,op (k ) = 1 Sx,op (k ) = 2 Sx,op (k ) = 3 Sx,op (k ) = 4 Sx,op (k ) = 5 . . . 0 0 2 4 6 8 10 . . . 1 2 0 2 4 6 8 . . . 2 4 2 0 2 4 6 . . . 3 6 4 2 0 2 4 . . . 4 8 6 4 2 0 2 . . . 5 10 8 6 4 2 0 . . . · · · (m - 1) · · · 2(m - 1) · · · 2(m - 2) · · · 2(m - 3) · · · 2(m - 4) · · · 2(m - 5) · · · 2(m - 6) . . . . . . 0

Sx,op (k ) = (m - 1) 2(m - 1) 2(m - 2) 2(m - 3) 2(m - 4) 2(m - 5) 2(m - 6) · · ·

83

The CMV minimization objective can be expressed as: gcmv (k ) = cmv |vcm | where cmv is the weighting factor for CMV reduction. The final cost function combining (4.26)-(4.29) is given as: g (k ) = gtrack (k ) + gdc (k ) + gswc(k ) + gcmv (k ). (4.30) (4.29)

4.4.2

Selection of Weighting Factors

The selection of values for the weighting factors is very important. Unfortunately, in state-of-the-art predictive control, no analytical or numerical formulas are available for the calculation of weighting factor values, but the guidelines given in [247] can be used. The main objective of the controller is to regulate the load current, and thus the track value can be set to 1 [262, 279]. The second requirement is balancing the dc-link capacitor voltages. A very high value for dc will create perfect balance in the capacitor voltages, but with higher tracking errors and THD for the load currents. Similarly, a low value for dc leads to a drift in the capacitor voltages, but very good regulation of load currents. A good compromise is to select dc such that the drift in capacitor voltages is around 2 % of nominal dc-link voltage. The selection of swc is specific to the applications involving the MLDCCs. For megawattlevel applications, the device switching frequency should be maintained below 1 kHZ to allow proper heat dissipation [271]. From Table 4.4, it can be discerned that the number of switch changes increase with the increase in number of levels in the DCCs. To achieve a switching frequency value, the weighting factor swc decreases with the increase in number of levels. In odd-level MLDCCs, a minimal value of cmv should be selected such that the CMV becomes zero. In even-level MLDCCs, the selection criteria for cmv should consider the load current tracking error and THD limit imposed by the application.

84

4.4.3

Selection of Prediction Horizon -h

Many FCS-MPC applications are reported to use the one-step prediction horizon (h = 1) [shown in Fig. 4.7(a)] along with the delay compensation method introduced in Fig. 3.11, as this approach involves a lower computational burden [77, 279, 281­283]. To compensate the computational delay caused by the digital signal processor, another approach based on a simplified two-step prediction horizon (h = 2) can be used, and this method is given in Fig. 4.7(b). With this approach, the switching state which minimizes the cost function at the (k + 2) instant is selected and applied at the sampling instant (k ). As shown in Fig. 4.7(b), the same voltage vectors are used in the (k + 1) and (k + 2) predictions to reduce the number of calculations: v (k + 2) = v (k ) v (k + 2) = v (k ) Kjx (k + 2) = Kjx (k ). To facilitate the two-step predictive strategy, the control variable behavior at the (k + 2) instant should be predicted using all the possible switching states of the converter. The model in (4.9) is used to predict the future load/grid currents, i (k + 2) and i (k + 2). The inverter voltages v (k ) and v (k ) are obtained by converting the natural frame variables given in Eq.(4.2). The (k + 2) instant dc-link capacitor voltages [vc1 (k + 2) · · · vc(m-1) (k + 2)] are obtained according to the discrete-time models given in (4.21) and (4.22). (4.31)

1 1 1

64

64 64

k

k+1

k+2

k

k+1

k+2

(a) Classical one-step prediction

(b) Proposed two-step prediction

Figure 4.7: Prediction of control variables for a 4L-DCC.

85

4.4.4

Control Algorithm

The control algorithm with the two-step prediction is shown in Fig. 4.8. The measured load/grid currents and dc-link capacitor voltages are used by the predictive controller. The algorithm is initialized by setting the switching state number i to 0 and optimal g value to . Then the algorithm enters the loop. The variables at the (k + 1) and (k + 2) instant are predicted using all the possible switching states of the converter. The predicted variables at the (k + 2) instant are evaluated by a cost function g (k ). The optimal voltage vector in the previous sampling instant is used by the sub-cost function gswc(k ). The switching state which produces a minimal value of gop is chosen and applied to the converter directly. It should be emphasized that the proposed method can be applied to any level DCC without any change in the software configuration, except the switching states definition in the initialization file.

Measurement: ia (k ), ib (k ), ic (k ), vc1 (k ), · · · vc(m-1) (k ) Obtain: i ,  (k + 2), i,  (k ), e,  (k ), e,  (k + 1)

i = 0,

gop = 

i=i+1

Prediction of (k + 1) variables using (4.9) and (4.21)

Prediction of (k + 2) variables using (4.9) and (4.21)

Minimization of cost function, g (k ) using (4.30) No

i  m3
Yes

gop = min {gi }i=1...m3 iop = i |gop Generate optimal gating signals S1a , S1b , S1c , · · · S(m-1)a , S(m-1)b , S(m-1)c

Figure 4.8: Two-step predictive control algorithm for an m-level DCC.

86

4.5

Simulation Results

To validate the proposed method, simulations are carried using MATLAB/Simulink software with the parameters as indicated in Table 4.5. To be able to validate experimental results under same conditions, low power converter parameters are used. The proposed approach can also be used for megawatt-level systems without any software modification. The sampling time is considered as Ts = 100 s. A two-step prediction horizon (h = 2) is used and the control delay is ignored. The simulation results are presented for 3L- to 6L-DCCs under the same operating conditions. The load/grid current tracking error (ei ), total harmonic distortion (THD) and average device switching frequency (fsw ) are calculated according to the guidelines given in Appendix C. Table 4.5: Parameters of the MLDCC and controller
Variable C Rf Lf i f R Ts h dc Description dc-link capacitors value Filter leakage resistance Filter inductance Nominal reference load current Nominal reference frequency Nominal load resistance Sampling time Prediction horizon Weighting factor Value 1000 (F) 0.045 () 10 (mH) 10 (A rms) 60 (Hz) 10 () 100 (s) 2 0.1

4.5.1

Transient Analysis

The transient response with a step-change in load currents is studied for 3L- to 6L-DCCs and presented in Fig. 4.9. The switching frequency reduction and CMV suppression are not included in the cost function. The dc-link voltage vdc is set to 300 V. At time t = 0.0458 s, a step change in i  is applied from 10 to 5 A (rms). The load currents show good response in reference tracking. The i is continued to track to its reference and it is not affected by the changes in i . The dc capacitor voltages are well balanced before and after the step-change in load current. Due to the unbalanced load currents, the dc capacitor currents oscillate [refer to (4.22)], and as a consequence the dc capacitor voltages also oscillate [refer to (4.21)]. But the magnitude of the oscillations is very small and can be ignored. 87

20 10 0 -20 -10 160 155 150 145 140 0

i  i vc1 vc2

i 

i

20 10 0 -20 -10 110 105 100 95 90

i  i vc1 vc2
0 1/60

i 

i vc3

1/60

Time (s)

2/60

3/60

Time (s)

2/60

3/60

(a) 3L-DCC
20 10 0 -20 -10 85 80 75 70 65 0

(b) 4L-DCC
i 
20 10 0 -20 -10

i  i vc1 vc2
1/60

i  i vc1 vc2
0 1/60

i 

i vc4 vc3 Time (s)
2/60 3/60

i vc3 vc4 Time (s)
2/60 3/60

70 65 60 55 50

vc5

(c) 5L-DCC

(d) 6L-DCC

Figure 4.9: Simulation results during step-change in reference load current.

4.5.2

Robustness against DC-link Perturbations

In order to evaluate the performance of the controller, a resistor Rx (200 ) is connected in parallel with the top dc-link capacitor of 3L- to 6L-DCCs and the results are presented in Fig. 4.10. The weighting factors associated with the switching frequency and CMV reduction are set to zero. The vdc and i are set to 300 V and 15 A (rms), respectively. Compared to the results presented in Fig. 4.9, the dc-link capacitor voltages contain a low frequency ripple due to the Rx . Even with the perturbation in the dc-link model, the controller chooses an optimal switching state leading to the minimum value of the cost function gdc (k ) and thus accurate balancing of the dc-link capacitor voltages. As demonstrated in Fig. 4.10(a) for 3L-DCC, when the weighting factor is deactivated (means dc = 0), the voltage across the top capacitor starts to discharge through the resistor Rx , while the bottom capacitor voltage starts to rise. At t = 0.4 s, the weighting factor is activated again (dc = 0.1), and the dc-link capacitor voltages become balanced within a short interval. Similar analysis 88

dc = 0.1
300

dc = 0 vc1

dc = 0.1

150

0 200

vc2
(a) 3L-DCC

vc1

100

0 150

vc3
(b) 4L-DCC

vc2

vc1

vc3

75

vc4
0 (c) 5L-DCC 120

vc2 vc4

vc1

vc2

60

0 0 0 .1

vc3
0 .2 Time (s) (d) 6L-DCC 0 .3 0.4

vc5
0.5

Figure 4.10: Simulation results for dc-link capacitor voltages behavior with and without the weighting factor dc .

can be carried out for 4L- to 6L-DCCs. It should be noted that the recovery time from an unbalanced to a balanced condition is approximately the same for all the DCCs. This test verifies that similar to the classical controls, the predictive control method can also be generalized and can be applied to any level DCC.

4.5.3

Switching Frequency Reduction

The switching frequency versus the weighting factor swc is studied for 3L- to 6L-DCCs and presented in Fig. 4.11. In order to facilitate the discussion of fsw minimization and its impact on the converter output current quality among different DCCs, the dc-link voltages are assumed to be balanced (by external hardware) and thus dc = 0. The CMV reduction 89

is also not considered. The vdc and i are set to 300 V and 10 A (rms), respectively. At time t = 2/60 s, the weighting factor swc is changed from 0 to a value suitable for each DCC. Referring to Table 4.4, the cumulative number of switch changes (swcx ) increase with the number of levels in DCC. For this reason, the weighting factors used for each DCC are different. The performance of the DCC before and after switching frequency minimization is summarized in Table 4.6. It can be seen from Fig. 4.11, as the number of levels increases, the fsw decreases along with the ei and THD. For all DCCs, as the weighting factor swc increases, the fsw decreases, with a slight increase in ei and THD.

swc Deactivated
400

swc Activated
20

vab

vab (V)

0

0

-200

ia
(a) 3L-DCC

-10 -20

-400 400

vab

20

vab (V)

0

0

-200

ia
(b) 4L-DCC

-10 -20

-400 400

vab (V)

0

0

-200

ia
(c) 5L-DCC

-10 -20 20

-400 400

vab (V)

0

0

-200 0 1/60

ia
2/60 3/60

-10 -20 4/60

-400

Time (s)
(d) 6L-DCC

Figure 4.11: Simulation results for switching frequency minimization using the weighting factor swc .

90

ia (A)

200

vab

i a

10

ia (A)

200

vab

20

i a

10

ia (A)

200

i a

10

ia (A)

200

i a

10

Table 4.6: Simulation analysis during fsw minimization
DCC Level swc ei (%) THD (%) fsw (Hz) 3L 0 0.5 4L 0 0.2 5L 0 0.1 6L 0 0.05 2.71 3.47 2.35 2.79 2.17 2.44 2.02 2.12 2.11 3.29 1.41 2.07 1.14 1.51 1.01 1.24 938 442 657 364 421 239 266 134

4.5.4

Common-Mode Voltage Mitigation

The CMV mitigation with odd-level (3L and 5L) DCCs are shown in Fig. 4.12, where it has been demonstrated that the CMV can be reduced to zero by choosing a best switching state. The dc supply voltage and load current references are set as 400 V and 10 A (rms), respectively. At t = 2/60 s, the cmv is changed from 0 to 0.12 and the CMV is dramatically decreased. At t = 4/60 s, the cmv is further increased to 0.24 and zero values for the CMV is achieved with 3L and 5L DCCs. The phase-a load current is shown, where it can be observed that the reference tracking is good even with zero CMV. The THD in load currents increase slightly due to the additional weighting term cmv . The capacitor voltages are affected due to the CMV reduction, and to maintain them within the ± 5 V range, the weighting factor dc is changed from 0.1 to 0.2 at t = 4/60 s. The CMV issue with even-level (4L and 6L) DCCs are presented in Fig. 4.13. The CMV is reduced to some extent with the help of cmv . This helps to minimize the rating of additional CMV hardware circuitry (choke). It should be noted that non-zero CMV is the inherent property of even-level DCCs. 91

cmv = 0
200 100 0 -100 -200 20 10 0 -10 -20 210 205 200 195 190 0 1/60 2/60

cmv = 0.12

cmv = 0.24

(a) Common-mode voltage, vcm

i a

ia
(b) Load current and its reference

vc2

vc1
3/60 4/60 5/60 6/60

Time (s)
(c) dc-link capacitor voltages

(a) 3L-DCC

cmv = 0
200 100 0 -100 -200 20 10 0 -10 -20 110 105 100 95 90 0 1/60 2/60

cmv = 0.12

cmv = 0.24

(a) Common-mode voltage, vcm

i a

ia
(b) Load current and its reference

vc1

vc4

vc2
3/60 4/60

vc3
5/60 6/60

Time (s)
(c) dc-link capacitor voltages

(b) 5L-DCC

Figure 4.12: Simulation results for common-mode voltage minimization of odd-level converters using the weighting factor cmv .

92

cmv = 0
400 300 200 100 0 -100 20 10 0 -10 -20 143.3 138.3 133.3 128.3 123.3 0 1/60 2/60

cmv = 0.02

cmv = 0.05

(a) Common-mode voltage, vcm

i a

ia
(b) Load current and its reference

vc1 vc2
3/60 4/60

vc3

5/60

6/60

Time (s)
(c) dc-link capacitor voltages

(a) 4L-DCC

cmv = 0
400 300 200 100 0 -100 20 10 0 -10 -20 90 85 80 75 70 0 1/60 2/60

cmv = 0.02

cmv = 0.05

(a) Common-mode voltage, vcm

i a

ia
(b) Load current and its reference

vc1 vc2

vc3 vc4
3/60 4/60

vc5

5/60

6/60

Time (s)
(c) dc-link capacitor voltages

(b) 6L-DCC

Figure 4.13: Simulation results for common-mode voltage minimization of even-level converters using the weighting factor cmv .

93

4.6

Experimental Results

The experimental tests are carried out with one odd-level DCC (3L) and one even-level DCC (4L). The complete system parameters are indicated in Table 4.5 which are the same as the ones used in simulation tests. As in the simulations, a two-step prediction horizon (h = 2) is used. As the number of levels in the DCCs increase, the computational burden increases. The minimum sampling time (Ts ) required to implement the proposed algorithm for 3L- to 6L-DCCs is noted and summarized in Table 4.7. The analysis also shows that the current DSPs can handle the computational requirement, even for 6L-DCC. Table 4.7: Computational burden with MLDCCs
DCC Level Number of Switching States Minimum Ts (s) 3L 27 18 4L 64 44 5L 125 93 6L 216 221

The experimental results with a step-change in i  from 10 to 5 A (rms) are presented for 3L- and 4L-DCCs in Figs. 4.14(a) and 4.14(b). Again, as in the simulations, load currents track their references accurately. The dc-link capacitor voltages are also balanced with small oscillation (due to unbalanced load currents) after the step-change. The tracking error and load current THD are found to be a little higher than in simulations. This is due to the dead-time caused by the voltage and current transducers, IGBT gate drivers, and ADC units. These results validate the theory and simulation results presented earlier. The robustness of the predictive controller in overcoming the system perturbations is experimentally validated for 3L- and 4L-DCCs, and presented in Figs. 4.15(a) and 4.15(b). A resistor of 200  can be deliberately connected in parallel with the top dc-link capacitor to modify the system model. Even with the changes to the system model, the predictive controller works on the selection of best switching state which leads to the minimal value of the cost function. With this phenomenon, the load currents follow their references, and the dc-link capacitor voltages are balanced within set limits. When the controller deactivates, the capacitor voltages diverge similar to the results presented in Fig. 4.10. When the controller is activated, they become balanced with a small recovery time. This test validates that the proposed algorithm is robust and can be applied for any-level DCC. 94

i 

i 

i 

i 

i i
Ch1 to Ch4: 10 A/div, t=5 ms/div

i

i
Ch1 to Ch4: 10 A/div, t=5 ms/div

vc1

vc2 vc1 vc2 vc3

Ch1 to Ch2: 50 V/div, t=5 ms/div

Ch1 to Ch3: 50 V/div, t=5 ms/div

(a) 3L-DCC

(b) 4L-DCC

Figure 4.14: Experimental results during step-change in reference to load current.

The switching frequency minimization algorithm is experimentally validated with the 3L- and 4L-DCCs and the results are presented in Figs. 4.16(a) and 4.16(b). The dc-link capacitor voltages are externally controlled and the weighting factor dc is set to zero. With the increase in swc , the switching frequency decreases with a slight increase in the ei and %THD in converter output current. The analysis with 3L- and 4L-DCCs is summarized in Table 4.8. These results are in a close relation to the simulation analysis presented in Table 4.6. Table 4.8: Experimental analysis during fsw minimization
DCC Level swc ei (%) THD (%) fsw (Hz) 3L 0 3.2 3.0 817 0.5 4.3 4.0 417 4L 0 2.83 2.25 612 0.2 3.41 3.18 306

95

dc = 0.1

dc = 0

dc = 0.1

vc1

vc2
Ch1 to Ch2: 50 V/div, t=50 ms/div

(a) 3L-DCC

dc = 0.1

dc = 0

dc = 0.1

vc1

vc3

vc2

Ch1 to Ch3: 50 V/div, t=50 ms/div

(b) 4L-DCC

Figure 4.15: Experimental results for dc-link capacitor voltages behavior with and without the weighting factor dc .

The CMV suppression for 3L-DCC is presented in Fig. 4.17(a), where, with the help of the weighting factor cmv , the CMV is reduced to zero. The value of the weighting factor and the system parameters are exactly the same as in simulation tests. While minimizing the CMV, the ei , %THD and drift in capacitor voltages increased slightly. The experimental results with 4L-DCC are presented in Fig. 4.17(b) and thus, it is demonstrated that the CMV can be reduced to some lower value. These results validate the proposed CMV algorithm. 96

swc = 0

swc = 0.5

i a

vab

ia

Ch1 to Ch2: 10 A/div, Ch4: 200 V/div, t=5 ms/div

(a) 3L-DCC

swc = 0

swc = 0.2

i a

vab

ia

Ch1 to Ch2: 10 A/div, Ch4: 200 V/div, t=5 ms/div

(b) 4L-DCC

Figure 4.16: Experimental results for switching frequency minimization using the weighting factor swc .

97

cmv = 0

cmv = 0.12

cmv = 0.24

cmv = 0

cmv = 0.02

cmv = 0.05

vcm

vcm

i 

i

i 

i

Ch1: 100 V/div, Ch2 to Ch3: 10 A/div, t=10 ms/div

Ch1: 100 V/div, Ch2 to Ch3: 10 A/div, t=10 ms/div

vc1

vc2 vc1 vc2 vc3

Ch1 to Ch2: 50 V/div, t=10 ms/div

Ch1 to Ch2: 50 V/div, t=10 ms/div

(a) 3L-DCC

(b) 4L-DCC

Figure 4.17: Experimental results for common-mode voltage reduction using the weighting factor cmv .

4.7

Conclusion

In this chapter, a generalized approach based on finite control set model predictive strategy has been presented for multilevel diode-clamped converters. The dynamics of the load/motor/grid currents, dc-link capacitor voltages, switching frequency and common-mode voltage are formulated in terms of switching states and the mathematical model of the converter. A proper selection of switching state leads to a minimum value of cost function and with this, all four control objectives are accomplished simultaneously. The common-mode voltage is completely suppressed in odd-level converters by just adding a constraint to the cost function. The proposed method shows an intuitive and promising approach to balance the dc-link capacitor voltages, even with the perturbations in the system model and parameters.

98

Chapter 5 Predictive Current Control of Grid-Tied Diode-Clamped Inverters

In the Chapter 4, a generalized method for the predictive control of multilevel (ML) diode-clamped converters was presented. In this chapter, the predictive control approach is extended to the grid-tied diode-clamped inverters (DCIs). As discussed in Chapter 2, the three-level (3L) and four-level (4L) DCIs are the most suitable candidates for the grid connection of a medium voltage (MV) wind energy conversion systems (WECS). The implementation of predictive control is the same for 3L and 4L-DCIs as discussed in Chapter 4, and this is true for the grid-tied case as well. In comparison to the 3L-DCI [62, 72], the 4L-DCI for high power WECS offers added benefits such as: MV operation with greatly reduced device voltage rating [106], increased equivalent switching frequency [84], lower values for the grid-side filter, grid friendly waveforms, and grid code compliance. However, the complexity of control system increases compared to the 3L-DCI. In this chapter, predictive control of a grid-tied 4L-DCI is presented. The control objectives, such as regulation of net dc-bus voltage, reactive power generation, dc-link capacitor voltages balancing, and switching frequency minimization are included in the cost function. During different operating conditions, the switching frequency is regulated between 750 and 850 Hz with the help of a lookup table based on the weighting factor. To validate the proposed method, MATLAB simulations are carried out on 4 MVA/4000 V system and dSPACE DS1103 based experiments are performed on 5 kVA/208 V prototype. 99

5.1

Overview of Grid-Tied Inverters

The configuration of Type-4 variable-speed WECS with full-scale power converters (twolevel or multilevel) is shown in Fig. 5.1. The generator-side ac/dc converter is used to harvest more energy from wind, while the grid-tied dc/ac inverter is employed to deliver the generated power to a three-phase grid/collection point. The ac/dc power conversion can be achieved by active or passive generator-side converters as discussed in Chapter 2. The grid connection is usually performed through a harmonic filter Lg to reduce the grid current distortion, and a step-up transformer (not shown to simplify the figure) to increase the inverter output voltage to transmission level. In commercial wind turbines, the harmonic filter Lg value (combined with the leakage inductance of the transformer, if any) is chosen to be in the range of 0.1-0.25 p.u. [2, 10, 14]. The internal resistance of the harmonic filter is represented as Rg . The grid-tied inverter is a crucial element in wind turbines to comply with the stringent grid-codes. In this chapter, a detailed analysis is given related to the operation of grid-tied inverters. The analysis presented here is valid for two-level and multilevel converters. In a complete WECS composed of full-scale power converters, the following variables needs to be regulated to achieve high-performance operation: · Active power control · Grid reactive power control · Net dc-bus voltage control · Balancing of dc-link capacitor voltages (in multilevel converters) As shown in Fig. 5.1, the generator-side ac/dc converter performs the maximum power point tracking (MPPT) to harvest more energy from the wind. This operation is called active power control. More details about the MPPT algorithms can be found in [2,6,14,47,51,284­ 289]. The grid reactive power and net dc-bus voltage are controlled by the grid-tied dc/ac inverter. The dc-link capacitor voltages are controlled by both ac/dc and dc/ac converters if back-to-back connected converters are employed [67]. If the generator-side power conversion is realized by a diode-rectifier, then the capacitor voltages control is performed by the dc/ac inverter alone. In this chapter, the analysis has been carried out assuming that the dc/ac inverter is responsible solely for balancing of dc-link capacitor voltages. 100

PMSG WRSG SCIG

Active/Passive Converters

Wind Turbine

AC/DC Converter

DC-link

DC/AC Inverter

Harmonic Filter

vdc
Gear Box
Active Power Control DC-Cap. Control Net dc Voltage Control Reactive Power Control DC-Cap. Control


Three-Phase Grid = in Multilevel Converters only

Figure 5.1: Configuration of Type-4 WECS with full-scale power converters.
DC/AC Inverter

idc
Rdc E

Harmonic Filter

vdc
DC-link Three-Phase Grid  = in Multilevel Converters only

WECS with Active Power Control (MPPT)

Net dc Voltage Control Reactive Power Control DC-Cap. Control

Figure 5.2: Simplified representation of Type-4 WECS.

In order to perform detailed analysis on the grid-tied inverter, a simplified Type-4 WECS is developed as shown in Fig. 5.2. In the complete WECS as represented in Fig. 5.1, the generator-side ac/dc converter, along with the active power control, injects current idc according to the maximum energy harvested from the wind. When the wind turbine operates below cut-in wind speed, the idc supplied by the generator-side converter is zero. Similarly, when the turbine operates at rated wind speed, the idc is rated. In order to simulate such a variable-speed wind energy system, a variable dc-current source is generated with the help of battery supply E and a resistor Rdc [2, 14]. The amount of active power injected into the grid can be varied by changing the value of idc . When the battery voltage E > vdc , the idc [=(E - vdc )/Rdc ] becomes positive and power flows from the inverter to the grid, which is the usual case in WECS. For a given value of Rdc , by adjusting E value, the active power generation can be adjusted. During different active power levels, the grid-tied inverter should control the net dc-bus voltage and grid reactive power. 101

5.1.1

Definition of Grid-side Control Variables

In this section, the selection of grid-tied inverter control variables is discussed: · Definition of dc-link Voltage Reference: To ensure the proper operation of the grid-tied inverter, the dc-bus voltage should be higher than the grid line-line voltage.
 is selected such that the inverter operates In this work, the dc-bus voltage reference vdc

with a 0.8 modulation index, leaving a 20 % margin for adjustment during transients
 and grid voltage variations. Following this discussion, the vdc is defined as,

 vdc

 6 vg 6 vg = 3.062 × vg = = ma 0.8



(5.1)

where vg is rms value of the grid phase voltage, and ma is the modulation index of the inverter. The control scheme for the grid-tied inverter should ensure that the vdc is maintained at its reference value during all the operating conditions. · Definition of Grid Power Factor: The power flow is bidirectional for the grid-tied inverter, but in WECS the power flow is unidirectional (from the dc-link to the grid). The active and reactive powers delivered to the grid can be calculated as: Pg = 3 Vg Ig cosg Qg = 3 Vg Ig sing where g is the grid power factor angle. The angle between the grid voltage and current vectors is measured as g . The grid power factor can be unity, lagging or leading based on the power factor angle: Unity Power Factor: if g = 0 Lagging Power Factor: if g = 0 - 90 lagging Leading Power Factor: if g = 0 - 90 leading Following this assumption, the reference grid reactive power Q g can be set as follows: Unity Power Factor: if Q g = 0 Lagging Power Factor: if Q g = positive Leading Power Factor: if Q g = negative 102

(5.2)

5.1.2

Classical Control Schemes for Grid-Tied Inverters

The well-established classical control techniques for grid-tied inverters are the virtual flux-oriented control [69], direct power control [70, 71] and decoupled voltage-oriented control (VOC) [2, 14, 72]. The decoupled VOC has been widely adopted by the wind energy industry. The above-mentioned control techniques use PI regulators in their internal current control loop and a modulation stage to generate the gating signals. A complex modulation technique along with the dc-link capacitor voltages balancing [96, 290] is required to apply these techniques to multilevel inverters. The most common modulation techniques for the four-level inverters are: carrier-based pulse width modulation (PWM) [169, 269] and space vector modulation (SVM) [108, 270]. The device switching frequency reduction to below 1 kHz is another important issue at the megawatt-level to minimize the switching losses and to allow proper heat dissipation [271]. The PWM and SVM techniques produce significantly lower order harmonics when operated below 1 kHz and this causes poor power quality [74]. Moreover, the grid voltage harmonics and control delay will degrade the performance of the PWM/SVM-based controller [76]. The main idea of this work is to replace the PI controllers and modulation stage by predictive controller to achieve high performance operation. The reference control variables are generated similar to the classical VOC scheme.

5.1.3

Grid Voltage Orientation

In order to achieve grid voltage orientation as in VOC, the d-axis of the synchronous reference frame (SRF) is aligned with the grid voltage vector and as a result q -axis grid voltage becomes zero [2]. With this approach, the decoupled control for the grid active and reactive powers can be achieved. Moreover, the calculation of grid active and reactive powers becomes easier as demonstrated below:  3 3  (vdg idg + vqg iqg ) = + vdg idg  2 2 3 3  Qg = (vqg idg - vdg iqg ) = - vdg iqg  2 2 Pg =

vqg = 0

(5.3)

where vdg and vqg are d- and q -axis grid voltages, respectively. idg and iqg are d- and q -axis grid currents, respectively. 103

5.2

Grid-Tied Four-Level Inverter Model

A simplified configuration of grid-tied 4L-DCI is shown in Fig. 5.3. The inverter is composed of 18 active switches and 18 clamping diodes. The clamping diodes withstand different reverse blocking voltages, and if the voltage rating for all the clamping diodes is selected to be same as the active switches, then a series connection of two diodes is necessary [84] as shown in Fig. 5.3. To simplify the analysis, the following assumptions are made: Rag vag = Rbg + vbg = Rcg + vcg = Rg , = 0, Lag iag = Lbg + ibg = Lcg + icg = Lg , = 0.

(5.4)

The switching states and the corresponding inverter terminal voltages are shown in Table 5.1, where it can be noted that: (a) only three switches conduct at any time, and (b) switch pairs (S1x , S 1x ), (S2x , S 2x ) and (S3x , S 3x ) operate in a complementary manner [84]. As shown in Fig. 5.4, for a 4L-DCI, 64 switching combinations and 37 voltage vectors are available.
idc P(3)
S1a

vc3
Rdc

+

-

ic3 cdc3

S1b S2b S3b

S1c S2c S3c

S2a S3a

z2 (2)

vdc
E

vc2

+ -

ic2 cdc2

a
S 1a

b
S 1b S 2b S 3b

c
S 1c S 2c S 3c

z1 (1)

vc1

+

-

ic1 cdc1

S 2a S 3a

N(0)

iag Rag Lag
+

ibg Rbg Lbg
+

icg Rcg Lcg
+

vag

-

vbg

-

vcg n

-

Figure 5.3: Topology of grid-tied 4L-DCI in MV-WECS.

104

Table 5.1: Switching states and inverter terminal voltages Sx S1x S2x S3x S 1x S 2x S 3x vxN 3 1 1 1 0 0 0 vc1 + vc2 + vc3 2 0 1 1 1 0 0 vc1 + vc2 1 0 0 1 1 1 0 vc1 0 0 0 0 1 1 1 0
vbN v25
030

v24
130

j

v23
230

v22
330

v26
031

v11
131 020

v10
231 120

v9
331 220

v21
320

v27
032

v12
132 021

v3
232 121 010

v2
332 211 110
000 111 222 333

v8
321 210

v20
310

v28
033

v13
133 022

v4
233 122 011

v0

v1
322 211 100

v7
311 200

300

v19 v aN 

v29
023

v14
012 123

v5
001 112 223

v6
101 212 323

v18
201 312

v36
301

v30
013

v15
002 113

v16
102 213

v17
202 313

v35
302

v31
003

v32
103

v33
203

v34
303

vcN

Figure 5.4: Space vector diagram and switching states for a four-level inverter.

As given in Table. 5.1, the voltage in any phase-x of the inverter, measured from the negative point of the dc-link (N ), can be expressed in terms of switching signals and dc-link capacitor voltages as follows [108]: vxN = (Sx == 0) (0) + (Sx == 1) (vc1 )

(5.5)

+ (Sx == 2) (vc1 + vc2 ) + (Sx == 3) (vc1 + vc2 + vc3 ). x = a, b, c. With respect to the grid neutral (n) these inverter voltages can be expressed as [77]: van vbn vcn 2 1 1 = + vaN - vbN - vcN 3 3 3 1 2 1 = - vaN + vbN - vcN 3 3 3 1 1 2 = - vaN - vbN + vcN . 3 3 3 105

(5.6)

5.2.1

Modeling of Grid Currents in Synchronous Frame

The grid currents can be expressed in terms of inverter voltages, grid voltages and filter inductance in a natural frame (abc) as [291]: d ig 1 [vi - vg - Rg ig ]. = dt Lg (5.7)

In order to facilitate easier design and control, the measured natural frame grid voltages and currents are converted to synchronous frame. The above natural frame currents can be converted to synchronous frame (dq ) and expressed in state-space form as follows [14]: idg vdi vdg d idg =A + Bi + Bg dt iqg iqg vqi vqg where A=
-Rg Lg

(5.8)

-g
1 Lg

g -Rg Lg 0 (5.9) 0
1 Lg

Bi = Bg =

0

1 Lg

1 -L g

0

-

.

vdi and vqi are the estimated d- and q -axis inverter voltages, respectively. They are obtained by applying abc/dq transformation (for more details refer to Appendix B.2) to the natural frame inverter voltages, van , vbn , and vcn given in (5.6). The discrete-time model for d and q -axis grid currents can be obtained from (5.8) for a one-step prediction as follows: idg (k + 1) vdi (k ) vdg (k ) idg (k ) = + i + g iqg (k + 1) iqg (k ) vqi (k ) vqg (k ) where =
Ts

(5.10)

eATs eATs Bi d =A-1 ( - I2x2 )Bi eATs Bg d =A-1 ( - I2x2 )Bg . 106 (5.11)

i =
0 Ts

g =
0

5.2.2

Modeling of DC-link Capacitor Voltages

From the modeling presented in the Chapter 4, the discrete-time model for dc-link capacitor voltages can be obtained for j = 1, 2, 3 as: vcj (k + 1) = vcj (k ) + Ts icj (k + 1) Cdcj (5.12)

where Ts is sampling time, and Cdc corresponds to the capacitance of dc-capacitors. The current through the dc-capacitors is denoted as icj . The dc-link capacitor currents can be expressed in terms of three-phase grid currents and gains K1x , K2x , and K3x as follows: ic3 (k + 1) =
x=a,b,c

K3x (k + 1) ixg (k + 1) K2x (k + 1) ixg (k + 1)
x=a,b,c

ic2 (k + 1) = ic1 (k + 1) =
x=a,b,c

(5.13)

K1x (k + 1) ixg (k + 1).

The gains K1x , K2x , and K3x are based on the inverter switching states as demonstrated below: K1x = sgn (0 - Sx ) K2x = sgn (1 - Sx ) sgn (Sx - 0) K3x = sgn (2 - Sx ) sgn (Sx - 0) sgn (Sx - 1) where sgn is a Signum function whose output value corresponds to -1 or 0 or +1. The performance of the model in [281] and the model presented here are the same in terms of the dc-link capacitor voltages balancing, but the number of online calculations can be reduced with the presented method. The reason is that the gains K1x , K2x , and K3x can be defined off-line along with the switching states. From (5.10), it can be noticed that, the grid d and q -axis currents are a function of inverter voltages, vdi and vqi . These inverter voltages (in natural frame) are related to the switching signals as described in (5.5). Similarly, the models in (5.12)-(5.14) demonstrate that the dc-link capacitor voltages are related to the switching signals. From the modeling presented in this section, it can be concluded that, the grid currents and capacitor voltages can be controlled by properly choosing a switching state. 107 (5.14)

5.3

Model Predictive Control

The proposed model predictive control scheme as represented in Fig. 5.5 is very easy and intuitive to understand. The implementation procedure is presented as follows: · Measure grid voltages, vag (k ) and vbg (k ), [vcg (k ) = -vag (k ) - vbg (k )]; grid currents iag (k ) and ibg (k ), [icg (k ) = -iag (k ) - ibg (k )]; and dc-link capacitor voltages vc1 (k ), vc2 (k ), vc3 (k ). In total 5 voltage sensors and two current sensors are required for a three-phase balanced system (symmetrical grid voltages). · Obtain grid voltage angle, g (k ) using synchronous reference frame phase-locked loop (SRF-PLL) [14] (for details refer to Appendix B.4). · Convert grid voltages and currents from natural (abc) frame to synchronous (dq ) frame, vdg (k ), vqg (k ), idg (k ), iqg (k ).
  · Obtain q -axis reference current i qg (k ) from Qg (k ). By referring to (5.3), the iqg (k ) can

be calculated as: i qg (k )

Q g (k ) . = -1.5 vdg (k )

(5.15)

· Obtain d-axis reference current i dg (k ) which represents the active power of the system. Neglecting losses in the inverter, the active power Pg on ac-side equals dc-power and it is expressed as follows [2]: 3 Pg = vdg idg = vdc idc . 2 (5.16)

During steady-state, the net dc-bus voltage, vdc is maintained at its reference value
 vdc by the PI controller. The i dg (k ) is generated by this PI controller according to the

operating conditions. · Extrapolate reference currents from k th state to (k + 1) state. The fourth-order Lagrange extrapolation method introduced in Section 3.3.4 is considered: i dg (k + 1) =
   4 i dg (k ) - 6 idg (k - 1) + 4 idg (k - 2) - idg (k - 3)

    i qg (k + 1) = 4 iqg (k ) - 6 iqg (k - 1) + 4 iqg (k - 2) - iqg (k - 3).

(5.17)

108

idc
via
Rbg Lbg

Four-level Inverter Rag Lag

iag

vag

+

Rdc vib
Rcg Lcg

vc3 (k ) ibg vbg

- +

vc2 (k ) icg

n
vcg

E vic
18 Sjx (k ) i dg (k + 1) Lagrange + 1) Extrapolation i qg (k ) ÷
-1.5vdg (k )

- +

-

vc1 (k )

Power flow

Power flow SRF-PLL
iag (k ) ibg (k ) vag (k ) vbg (k )

i dg (k + 1) Minimization i dg (k ) PI
- +
 vdc (k ) p.u.

dc
Cost Function i qg (k

109
idg (k + 1) iqg (k + 1) vc1 (k + 1) vc2 (k + 1) vc3 (k + 1) Q g (k ) Predictive Model
+ + +

swc

abc/dq

i qg (k

+ 1)

Look-Up Table

g (k )

Transformation

Sjx (k - 1)

g (k )

vc1 (k ) vc2 (k ) vc3 (k )
vdg (k ) vqg (k ) idg (k ) iqg (k )

vc1 (k ) p.u. vc2 (k ) p.u. vc3 (k ) p.u.

idg (k ) iqg (k ) vdg (k ) vqg (k )

Figure 5.5: Proposed model predictive control algorithm for grid-tied four-level inverter.

· Predict the future behavior of the d and q -axis grid currents and dc-link capacitor voltages for all the possible switching states of the inverter using (5.10) and (5.12).
 · Estimate swc based on extrapolated reference currents i dg (k + 1) and iqg (k + 1).

· The predicted variables idg (k + 1), iqg (k + 1), vc1 (k + 1), vc2 (k + 1), vc3 (k + 1), which are a function of switching signals, are used in the cost function. The gating signal Sjx (k ) (j = 1, 2, 3, x = a, b, c) which minimizes the cost function is chosen and applied to the inverter directly. It should be noted that any additional modulation stage is not required, unlike in the classical control techniques [2, 14, 69­71, 94, 292]. The control objectives of the proposed method are: (i) regulation of active power for which the d-axis current is controlled; (ii) regulation of reactive power for which q -axis current is controlled; (iii) balancing of dc-link capacitor voltages; and (iv) minimization of switching frequency for which the number of switch changes are penalized. All these goals are included in a quadratic cost function for one-step prediction as follows:
2 ggrid (k ) = (i dg (k + 1) - idg (k + 1)) 2 + (i qg (k + 1) - iqg (k + 1))

+ dc  [vc1 (k + 1) - vc2 (k + 1)]2 + dc  [vc2 (k + 1) - vc3 (k + 1)]2 + dc  [vc1 (k + 1) - vc3 (k + 1)]2 + swc 
x=a,b,c

(5.18)

swcx

where dc , and swc are weighting factors for the dc-link capacitor voltages balancing and switching frequency reduction, respectively. The swcx is the number of semiconductor commutations involved in phase-x, which can be calculated as follows [77]: swcx =| Sjx (k ) - Sjx,op(k ) |, j = 1, 2, 3, x = a, b, c (5.19)

where Sjx (k ) is the predicted gating signal of phase-x, and Sjx,op(k ) = Sjx (k - 1) is the optimal gating signal of phase-x in the previous sample. When swc > 0, the switching frequency reduction can be achieved. In a similar manner, the dc-link capacitor voltages balancing can be accomplished with dc > 0. 110

5.4

Simulation Results

To validate the proposed control scheme, simulations are carried out using Simulink software for different operating conditions with the parameters as indicated in Table 5.2. A one-step prediction horizon is considered in all the simulation tests. Unless otherwise stated, the cost function includes all four variables as mentioned in (5.18). Table 5.2: Grid-tied four-level inverter and controller parameters
Simulation Description SI p.u. Apparent Power (kVA) 4000 1.0 Grid L-L rms Voltage (V) 4000 ­ Grid rms Current (A) 577.35 1.0 Grid Frequency (Hz) 60 1.0 Filter Resistance () 0.042 0.0105 Filter Inductance (mH) 2.1 0.2 DC-link Capacitance (F) 2596 3.914 Ref dc-bus Voltage (V) 7071 3.062 DC-link Resistance () 0.4624 0.1156 External Resistance () 46.24 11.56 Weight Factor 0.5 ­ PI Parameters 1&200 ­ Sampling Time (s) 90  ­ Base Values Base rms Voltage (V) 2309.4 1.0 Base rms Current (A) 577.35 1.0 Base Impedance () 4.0 1.0 Base Inductance (mH) 10.6 1.0 Base Capacitance (F) 663.15 1.0 Experimental SI p.u. 5 1.0 208 ­ 13.88 1.0 60 1.0 0.091 0.0105 4.6 0.2 1200 3.914 368.0 3.062 1 0.1156 100 11.56 0.25 ­ 1&200 ­ 90  ­ 120 13.88 8.6528 23.0 306.56 1.0 1.0 1.0 1.0 1.0

Variable Sg vg ig fg Rg Lg Cdc  vdc Rdc Rx dc kP , kI Ts vbg ibg Zbg Lbg Cbg

Table 5.3: Summary of simulation steady-state analysis
 Case i dg (p.u.) Qg (p.u.) A1 1.0 0 A2 0.8 -0.6 A3 0.8 0.6 A4 0 0 A5 0 -1 A6 0 1

%eig %THD %evc fsw (Hz) 3.26 3.20 1.02 798 3.68 3.88 1.41 799 3.09 2.92 1.39 804 -- -- 0.03 798 2.18 2.07 0.96 804 4.19 3.15 1.78 800

111

5.4.1

Steady-state Analysis

The steady-state analysis has been carried out for different d and q -axis reference currents as summarized in Table 5.3. The performance assessment parameters %eig , %THD, %evc and fsw are calculated according to the guidelines given in Appendix C. The battery voltage E is adjusted as follows to obtain different d-axis reference currents:
 + [i E = vdc dg (p.u.) × ibg × Rdc ].

(5.20)

With the grid voltage orientation, the vdg equals to the peak grid voltage and vqg becomes zero during all operating conditions as shown in Fig. 5.6. The inverter phase voltage [refer to (5.5)] is also shown where it contains four levels: 0, vdc /3, 2vdc /3 and vdc . The operating condition A1 corresponds to the pure active power injection into the grid, which is the most common scenario in WECS [2]. The grid current is maintained in phase with the grid voltage as shown in Fig. 5.6(a)-(i). The active power component of the grid current, idg equals peak grid current and the reactive power component of grid current, iqg becomes zero as demonstrated in Fig. 5.6(a)-(i). With Qg = 0, the grid apparent power, Sg becomes equal to the grid active power, Pg as shown in Fig. 5.6(a)-(ii). The net dc-bus voltage, vdc is maintained at its reference value with the perfect balancing of the capacitor voltages as shown in Fig. 5.6(a)-(iii). The dc-link capacitor voltage deviation can be further reduced by increasing the dc , but at the expense of higher %eig and %THD. With swc = 0, the switching frequency is found to be 1338 Hz. By using swc = 1280 (obtained from look-up table), the switching frequency, fsw is reduced to 798 Hz. The reduced active power delivery with leading and lagging power factors are analyzed in Case A2 and A3, respectively. Case A4 corresponds to the operation of the WECS below the cut-in wind speed, where the active power generated and delivered to the grid is zero. The fault ride-through capability of the proposed inverter is shown in Case A5. According to the grid codes [12, 17], the high power WECS should remain connected to the grid during the grid faults and inject pure leading reactive power to help the grid recover from the fault [293]. The detection of grid fault and generation of corresponding current references [67] is beyond the scope of this paper. For simplicity, the current references are set by the user. The grid current leads the voltage by 90 as shown in Fig. 5.6(b)-(i). The idg becomes zero and the iqg becomes equal to the peak grid current. The active power is maintained at zero as 112

shown in Fig. 5.6(b)-(ii), and the grid apparent power becomes equal to the absolute reactive power. The dc-link capacitor voltages are well-balanced, as shown in Fig. 5.6(b)(iii). This demonstrates the effectiveness of the proposed method to meet the grid codes. The injection of pure lagging reactive power, although rare in WECS, has been studied in A6. The inverter switching frequency fsw variation is maintained in the range of 750-850 Hz during all the operating conditions while maintaining acceptable power quality and reference tracking.

+1kA

+2kV g =0 0

vdg vqg iqg iag

+2kV 0

vdg vqg idg

0

0

i ag
-2kV

-1kA

-2kV

i ag

iag
g =90 lead

(i)
+4M +2M 0 -2M -4M +4M +2M 0 -2M -4M

(i) Pg Q g Qg

Pg Q g Qg

Sg

Sg

vdc 2vdc /3 vdc /3 0
8kV 6kV 4kV 2kV
 vdc

vaN (ii)

vdc 2vdc /3 vdc /3 0
8kV

vaN (ii)

vdc

6kV 4kV 2kV

 vdc

vdc

vc1
0

vc2
3

vc3
6

vc1
0

Scale: k=10 , M=10 , T=1/60 0 0.5T T 2T 1.5T Time (s) (iii) 2.5T 3T

vc2 vc3 Scale: k=103 , M=106 , T=1/60 T 2T 1.5T Time (s) (iii) 2.5T 3T

0

0.5T

 (a) case-A1: i dg = 1.0 p.u. and Qg = 0 p.u.

 (b) case-A5: i dg = 0 p.u. and Qg = -1.0 p.u.

Figure 5.6: Simulation results during steady-state operation.

113

-1kA

+1kA

vag idg

vag iqg

5.4.2

Transient Analysis

To analyze the decoupled nature of the d and q -axis currents, transient analysis has been carried out with trapezoidal changes in the Q g . The d-axis reference current is set to 0.8 p.u. As shown in Fig. 5.7(a), the grid power factor changes in the order of: unity-leadingunity-lagging. The grid reactive power tracks to its reference within small interval and no overshoots. The decoupled control for active and reactive powers (thus for d and q -axis currents, respectively) has been achieved, as shown in 5.7(b). The net dc-bus voltage control and dc-link capacitor voltages balancing have been achieved as shown in 5.7(c).
vag
+2kV 0 -2kV

idg

vdg vqg
g =0


0 -1kA

i ag

iag
g =36.8 lead


iqg

g =36.8 lag

(a)
+4M +2M 0 -2M -4M

Pg

Sg

vdc 2vdc /3 vdc /3 0
8kV 6kV 4kV 2kV 0

Q g

Qg

vaN (b)

 vdc

vdc

vc1

vc3 vc2 3 Scale: k=10 , M=106 , T=1/60 T 2T 1.5T Time (s) (c) 2.5T 3T

0

0.5T

Figure 5.7: Simulation results during transient operation.

114

+1kA

5.4.3

DC-link Dynamics

The dc-link dynamics are studied and presented in Fig. 5.8. In order to verify the proposed dc-link capacitor voltages balancing algorithm, an external resistor Rx (11.46 p.u.) is deliberately connected across the dc-link capacitor Cdc3 at time t = 1/60 s. The d and q -axis current references are the same as in the Case A1. Even with the step-connection of the resistor, the controller takes action in a few sampling instants, and thus the capacitor voltages continue to be balanced as shown in Fig. 5.8(a). The current through the resistor, iRx is found to be 11.33 % of the base current. It is important to note that the grid currents continue to track to their references during this process. As shown in Fig. 5.8(b), another test has been conducted where the weighting factor dc is suddenly changed from 0.5 to zero at t = 0.2 s. With no penalty to the dc-link capacitor voltages balancing, the vc1 and vc3 gradually increases and vc2 gradually decreases and becomes zero at t = 0.24 s. At the time t = 0.5 s, the weighting factor has been changed to 0.5 and the dc-link capacitor voltages become balanced, with an acceptable recovery time of 0.06 s. These results validate the proposed dc-link modeling and control.
8kV 6kV 8kV

vdc iRx

 vdc

60A

6kV

vdc

 vdc

4kV

40A

4kV

2kV

vc1
0 0 0.5T T

vc2
2T

vc3
2.5T

20A 0

2kV

vc1 vc2
0 0 .1 0.2 0.3

vc3
0.4 0.5 Time (s) 0 .6 0 .7 0.8

1.5T Time (s)

3T

0

(a) With a resistor across Cdc3

(b) With and without the weighting factor dc

Figure 5.8: Simulation analysis for dc-link capacitor voltages balancing.

115

5.4.4

Switching Frequency Regulation

The variable switching frequency nature of the predictive control is studied with respect
 to the i dg and Qg , and presented in Fig. 5.9. The switching frequency increases linearly with

the d-axis grid current. The fsw becomes greater with the negative reactive power compared to the positive reactive power. Without the weight factor swc , the switching frequency is found to vary in a range of 1800-900 Hz as shown in Fig. 5.9(a). To overcome this issue, weighting factors are designed as shown in Fig. 5.9(c). The knowledge for the design has been obtained from the Fig. 5.9(a) and guidelines given in [247]. Observation demonstrates that these values hold a linear relation to the active and reactive powers. These values are stored in a lookup table, for online use, and as a result the switching frequency has been maintained within the 750-850 Hz range, during all the operating conditions, as shown in Fig. 5.9(b). It should be noted that the previously discussed steady-state results are obtained by including this online look-up table, and thus the switching frequency is maintained in the range of 750-850 Hz during all operating conditions as summarized in Table 5.3. The %THD performance of a four-level inverter with respect to the switching frequency for the proposed grid-tied and resistive load [281] cases are investigated and presented in Fig. 5.10. The case-A1 is considered for grid-tied application. For a resistive load, the controller is implemented in a stationary reference frame ( ) with the parameters as provided in Table 5.2. The load resistance value is set as a base impedance (Zbg ) of the system. For the gridtied case, the weighting factor swc is changed from 0-20000 and the switching frequency is reduced from 1338 to 105 Hz and the THD is increased from 2.27 % to 14 %. For the resistive load case, the swc is changed from 0-10000. The fsw is reduced from 1333 to 102 Hz with the increase in THD from 2.18 % to 14 %. The difference between both cases is found to be small during the entire switching frequency range. It should be noted, for both the cases, that a significant reduction in switching frequency from 1330 to 600 Hz has been achieved, with a slight increase in THD from 2.2 % to 4.1 %.

116

fsw (Hz)

fsw (Hz)

2000 1500 1000 500 0

2000 1500 1000 500 0

1.0

0.8 .6 0

id 
g

(p u .u.  (p. ) Qg (a) Without swc

0.4 .2 0 0

- - -0. 0.2 - 0 4 - 0. .6 1. 8 .) 0

0 1. 0. .8 0 0 6 0 .4 0 .2

1.0

0.8 .6 0

id 
g

(p .u. )

0.4 .2 0 0

- - -0. 0.2 - 0 4 - 0. .6 1. 8 0 .u.)

0 1. 0. .8 0 0 6 0 .4 0 .2

Qg



(p

(b) With swc

2000 1500

swc

1000 500 0

1.0 .8 0 .6 0

id 
g

(p .u.  (p ) Qg (c) Weighting factor swc

0.4 .2 0 0

- - -0. 0.2 - 0 4 - 0. .6 1. 8 0 .u.)

0 1. 0. .8 0 0 6 . 0 4 0 .2

 Figure 5.9: Simulation results for switching frequency variation with respect to i dg and Qg .

20 16 12

With Grid Connection

%THD

8

4 With Resistive Load 0 1400 1200 1000 800 600 400 200

Switching Frequency, fsw

Figure 5.10: Comparison of %THD for 4L-inverter with grid-tied and resistive load cases.

117

5.5
5.5.1

Experimental Implementation and Validation
Experimental Setup

The experimental setup for the grid-tied four-level inverter is shown in Fig. 5.11 with the parameters as indicated in Table 5.2. The control algorithm has been implemented using a host PC running with MATLAB-Simulink 2006a software through Real-Time Interface (RTI). The dSPACE DS1103 controller is used to handle the control processes such as grid current prediction, dc-link capacitor voltages balancing and cost function minimization. The grid currents and dc-link voltages are measured by LEM LA55-P and LV25-P transducers, respectively. Feedback from the sensors has been sent to the controller through the CP1103 I/O connector. The prototype has been built by Semikron SKM75GB123D dual-pack IGBT modules. The IGBT gate drivers are based on four SKHI22B dual cores which are powered with a 0/15 V supply. An interface board with MC14504BCP and TLP521-4 is used between the dSPACE and SKHI22B gate drivers for TTL to CMOS logic conversion and signal isolation, respectively. The dc power supply (E ) has been obtained by Xantrex XDC-60020. The inverter is connected to the grid through an isolation transformer and its impedance is added to the filter values.
Host PC 4-Level Inverter Interface Board Sensors CP1103

Oscilloscopes

DS1103 R&D controller

3-Phase Grid

Isolation Transformer

DC Power Supply

L Filter

Figure 5.11: Photograph of experimental setup.

118

5.5.2

Delay Compensation

To verify the predictive control algorithm through MATLAB simulations [281], one-step prediction can be used as shown in Fig. 5.12(a). This is ideal case where the delay is zero between the instant measurements are made and the instant new switching state is applied [77]. The switching state which minimizes the error at (k + 1) instant is selected and applied at (k ) instant. In the experimental verification, the delay provided by the digital signal processor, gate drivers, and switching devices is inevitable. The computational delay provided by the digital signal processor is most significant, and this must be compensated for. This delay can easily be compensated for by calculating the cost function with a modified one-step prediction [248,249] as shown in Fig. 5.12(b). The optimal switching state from the previous iteration is used to "estimate" the variables at (k + 1) instant and all the possible switching states are used to "predict" the variables at (k + 2) instant. The switching state which minimizes the error at the (k + 2) instant is selected and applied at sampling instant (k + 1). With this approach, one sampling period will be available for calculations.

1

1

1

64 k k+1 k+2 k

64 k+1

64 k+2

(a) Without delay compensation [281]

(b) With delay compensation [248, 249]

Figure 5.12: Prediction of four-level inverter control variables.

The control algorithm with this approach of control delay compensation is shown in Fig. 5.13. The measured grid and dc-link signals, along with the optimal gating signals, are used by the predictive controller. The variables at (k + 1) instant are estimated using the optimal values obtained from the previous iteration. This is demonstrated as follows: 119

Measurement vc (k ), vg (k ), ig (k ) Estimate g (k ), vdg (k ), vqg (k ) idg (k ), iqg (k ) Apply Sjx,op (k ), j = 1, 2, 3, x = a, b, c K1x,op (k ), K2x,op (k ), K3x,op (k ) vdi,op (k ), vqi,op (k )

Estimation of Variables at (k + 1) Instant ^ iqg (k + 1), v ^c (k + 1) idg (k + 1), ^ Using (5.21) and (5.22)

i=0 gop =  i=i+1

Predictive Variables at (k + 2) Instant idg (k + 2), iqg (k + 2), vc (k + 2) Using (5.23) and (5.24)

Calculation of Cost Function ggrid (k + 1) Using (5.25) No i = 64? Yes Select iop gop = min {gi }i=1...64 iop = i |gop

Figure 5.13: Predictive current control and dc-link capacitor voltages balancing algorithm with delay compensation.

120

^ idg (k ) idg (k + 1) vdi,op (k ) vdg (k ) = + i + g ^ iqg (k + 1) iqg (k ) vqi,op (k ) vqg (k ) v ^cj (k + 1) = vcj (k ) + Ts Cdcj Kjx,op ixg .
x=a,b,c

(5.21)

(5.22)

The algorithm is initialized by setting the switching state number i to 0 and optimal g value to . The algorithm then enters the loop. The predictive variables at (k + 2) instant are calculated as follows: ^ idg (k + 1) vdi (k + 1) vdg (k + 1) idg (k + 2) = + i + g ^ iqg (k + 2) vqi (k + 1) vqg (k + 1) iqg (k + 1) vcj (k + 2) = v ^cj (k + 1) + Ts Cdcj Kjx ixg .
x=a,b,c

(5.23)

(5.24)

In (5.23), vdg (k +1) and vqg (k +1) are extrapolated grid voltages and they can be obtained similar to (5.17). For stiff-grid, vdg (k ) = vdg (k + 1) and vqg (k ) = vqg (k + 1) and thus no extrapolation is needed. The predicted variables at (k + 2) instant are evaluated 64 times by a cost function ggrid (k + 1). The switching state, which produces a minimal value of gop , is chosen and applied to the inverter directly. The cost function ggrid (k + 1) can be calculated by shifting the variable in (5.19) one-step forward as follows:
2 ggrid (k + 1) = (i dg (k + 2) - idg (k + 2)) 2 + (i qg (k + 2) - iqg (k + 2))

+ dc  [vc1 (k + 2) - vc2 (k + 2)]2 + dc  [vc2 (k + 2) - vc3 (k + 2)]2 + dc  [vc1 (k + 2) - vc3 (k + 2)]2 + swc 
x=a,b,c

(5.25)

swcx .

The reference currents at (k + 2) instant can be obtained by the Lagrange extrapolation as follows [259]: i dg (k + 2) = i qg (k + 2) =
   10 i dg (k ) - 20 idg (k - 1) + 15 idg (k - 2) - 4 idg (k - 3)

10 i qg (k )

-

20 i qg (k

- 1) +

15 i qg (k

- 2) -

4 i qg (k

- 3).

(5.26)

121

5.5.3

Selection of Sampling Time

For a four-level inverter, 64 switching states are available and the proposed predictive control method incurs a large number of calculations to predict the future behavior of grid currents and dc-link capacitor voltages. The execution times for a two-level inverter with 8 switching states [262] and three-level inverter with 27 switching states [279] are reported as 7 s and 52 s, respectively. The minimum execution time of 63 s is achieved for the proposed control system. It is observed that the predictive control algorithm as shown in Fig. 5.13 took 31 s only. The tasks such as measurement of signals, grid voltage orientation, detection of grid voltage angle, online estimation of weighting factors, calculation of reference currents, and online performance assessment took 32 s. The authors in [294] suggested that the weighting factor-based switching frequency reduction is more efficient compared to the selection of higher sampling times. With this recommendation, and considering a high power application, the sampling time (Ts ) of 90 s or 11.11 kHz sampling frequency is selected.

5.5.4

Experimental Results

The experimental results are obtained with the modified one-step prediction [Fig. 5.12(b)]. Since the predictive controller uses the SI parameters, the weighting factors used in the experiments are different from the simulations, but their impact on the controller remains the same. The steady-state analysis has been carried out similar to the simulations and summarized in Table. 5.4. Table 5.4: Summary of experimental steady-state analysis
 Case i dg (p.u.) Qg (p.u.) %eig %THD %evc fsw (Hz)

A1 A2 A3 A4 A5 A6

1.0 0.8 0.8 0 0 0

0 -0.6 0.6 0 -1 1

4.83 4.55 3.76 -- 3.35 4.97

4.16 4.41 3.74 -- 3.58 4.03

0.58 0.71 0.59 0.13 0.29 0.79

804 796 811 800 808 807

Due to the modified one-step prediction, the number of calculations are increased, and as a result, the switching frequency is increased in all the cases [248]. For instance, for Case A1 with swc = 0, the fsw through simulation studies is 1338 Hz and in the experimental 122

implementation it is found to be 1736 Hz. By using swc = 1.9 (obtained through the lookup table) in experiments, the switching frequency is reduced to 804 Hz. The higher current tracking error in experiments can be attributed to the delay provided by the sensors and IGBT gate drivers and losses in the system. The experimental results presented in Figs. 5.14(a), 5.14(b), and 5.15 are similar to the simulation results with the perfect regulation of the dc-link voltages and grid currents.

vag idg

vag iqg

iqg iag

g =0

idg

iag

g =90 lead

Ch1: 50 V/div, Ch2 to Ch4: 20 A/div, t=5 ms/div

Ch1: 50 V/div, Ch2 to Ch4: 20 A/div, t=5 ms/div

(i)

(i)

Sg

Pg

Qg

Sg

Pg

vaN

vaN

Qg

Ch1 to Ch3: 2500 V/div, Ch4: 200 V/div, t=5 ms/div

Ch1 to Ch3: 2500 V/div, Ch4: 200 V/div, t=5 ms/div

(ii)

(ii)

vdc

vdc

vc1

vc2

vc3

vc1

vc2

vc3

Ch1 to Ch3: 50 V/div, Ch4: 100 V/div, t=5 ms/div

Ch1 to Ch3: 50 V/div, Ch4: 100 V/div, t=5 ms/div

(iii)
 (a) Case-A1: i dg = 1.0 p.u. and Qg = 0 p.u.

(iii)
 (b) Case-A5: i dg = 0 p.u. and Qg = -1.0 p.u.

Figure 5.14: Experimental results during steady-state operation.

123

vag iqg

g =36.8o lead

idg

iag

g =0o g =36.8o lag

Ch1: 50 V/div, Ch2 to Ch4: 20 A/div, t=5 ms/div

(i)

Sg

Pg Qg

vaN

Ch1 to Ch3: 2500 V/div, Ch4: 200 V/div, t=5 ms/div

(ii)

vdc

vc1

vc2

vc3

Ch1 to Ch3: 50 V/div, Ch4: 100 V/div, t=5 ms/div

(iii)

Figure 5.15: Experimental results during transient operation.

The dc-link dynamics, with the external resistor Rx across Cdc1 , is shown in Fig. 5.16(a). Similar to the simulations, the balancing of the dc-link capacitor voltages have been maintained even with the step-connection of the resistor. During the step change, transients can be noticed by looking into the current waveform iRx . The dc-link voltage drops slightly and recovers back to normal within 1 ms. Similar to the simulations, the current iRx is found to be 11.33 % of the base current. 124

Ch1 to Ch3: 50 V/div, Ch4: 200 mA/div, t=5 ms/div

Ch1 to Ch3: 50 V/div, Ch4: 100 V/div, t=80 ms/div

iRx

vdc

vc2 vc1 vc2 vc3 vc1 vc3

(a) With a resistor across Cdc3

(b) With and without the weighting factor dc

Figure 5.16: Experimental results for dc-link capacitor voltages balancing.

fsw (Hz)

2000 1000 0

fsw (Hz)
0 1. 0 . .8 0 0 6 . 0 4 0 .2

4000 3000

2000 1500 1000 500 0

1.0

0.8 .6 0

id 
g

(p .u.  (p ) Qg (a) Without swc

0.4 .2 0 0

- - -0. 0.2 - 0 4 - 0. .6 1. 8 0 .u.)

1.0 .8 0 .6 0

id 
g

(p .u. )

0.4 .2 0 0

- - -0. 0.2 - 0 4 - 0. .6 1. 8 0 .u.)

0 1. 0. .8 0 0 6 . 0 4 0 .2

Qg



(p

(b) With swc

4 3

swc

2 1 0

1.0 .8 0 .6 0 .4 0 id  0.2 0 g

(p .u.  (p ) Qg (c) Weighting factor swc

- - -0. 0.2 - 0 4 - 0. .6 1. 8 0 .u.)

0 1. 0. .8 0 0 . 0 .4 6 0 2

Figure 5.17: Experimental results for switching frequency variation with respect to i dg and  Qg .

125

The relation between the dc and the capacitors balancing have been verified experimentally and presented in Fig. 5.16(b). The divergence and convergence of capacitor voltages are similar to the simulation results. The settling time of capacitor voltages is found to be the same as those of the simulations.
 The switching frequency variation with respect to the i dg and Qg is presented in Fig.

5.17(a) and it is noticed to vary in the range of 1000-2580 Hz. To deal with the lower power prototype, a scaling has been done to evaluate the weighting factor swc as presented in Fig. 5.17(c). Similar to the simulations, the switching frequency is maintained in the range of 750-850 Hz as shown in Fig. 5.17(b).

5.6

Conclusion

In this chapter, a voltage-oriented FCS-MPC strategy is proposed for the grid-tied 4Linverter for use in high power WECS. The proposed methodology can be simply extended for any level grid-tied inverter. The future behavior of the control variables for each of the 64 possible switching states has been predicted. The switching state which minimizes the cost function is selected and then applied directly to the inverter gating terminals. The simulation and experimental results are in a close relationship and thus validate the proposed methodology. The major contributions of this work are summarized as follows: · The d and q -axis grid currents are tightly regulated during different active and reactive power conditions using an intuitive approach. The internal current PI controllers and modulation stage are eliminated and as a result, a good dynamic response has been achieved. · An intuitive modeling and control for the dc-link capacitor voltages balancing is presented and verified. · A lookup table based weighting factor design is proposed by which the switching frequency is regulated between 750 and 850 Hz during different active and reactive power references, and this has been achieved without any software or hardware reconfiguration.

126

Chapter 6 Model Predictive Decoupled Active and Reactive Power Control for Grid-Tied Diode-Clamped Inverters
In the Chapter 5, the predictive current control of grid-tied diode-clamped inverters (DCIs) was presented. In this chapter, another approach is proposed to directly control the grid active and reactive powers, assuming that the generator-side converter regulates the net dc-bus voltage. A 4L-DCI is considered to present the analysis and results, and the proposed concept can easily be extended to any-level DCI using the guidelines given in Chapter 4. To predict the future behavior of active and reactive grid powers, dc-link capacitor voltages, and number of switch changes, a discrete-time model of the inverter is developed in synchronous reference frame (SRF). The controller uses all the possible switching states of the inverter for the prediction and evaluates them using a cost function. During a step change in reference control variables, the vector angle extrapolation method [261] exhibits better performance than the Lagrange extrapolation method [221]. However it is not suitable for the SRF references. In this chapter, a novel extrapolation method is presented to deal with the extrapolation of SRF references. This method is analyzed during step-changes in grid active and reactive power references. The performance of the proposed method is investigated with the perturbations in the grid-side filter and dc-link parameters. The feasibility of the proposed method is verified through simulation and experimental results showing good dynamic and steady-state performance.

127

6.1

Proposed Control Strategy

The proposed model predictive decoupled active and reactive power control scheme is shown in Fig. 6.1. The wind turbine, generator, and rectifier with the net dc-bus voltage control are represented by a constant dc-voltage source (battery). A diode is inserted between the battery and dc-link to perform isolation and unidirectional power flow. In commercial wind turbines, there is no need to incorporate the diode in the circuit. The top capacitor voltage corresponds to vc1 which is a different notation from the works presented in the Chapters 4 and 5. The reference reactive power command (Q g ) is provided by the grid operator, and the active power reference (Pg ) is obtained by the maximum power point tracking (MPPT) algorithm. In commercial wind turbines, the MPPT is performed using the wind turbine characteristics and measured (using Anemometer) wind speed.
Generator-side Converter with Net dc-bus Voltage Control a, b, c vc1 (k ) D vc2 (k ) E idg (k ) vc3 (k ) 18
S(k)

Lg

MV Grid

ig (k )

vg (k )

abc/dq
g (k )

SRF PLL

iqg (k ) vdg (k )
Pg (k + 1)

vqg (k )

Cost Function Minimization

Extrapolation

Q g (k

+ 1)

vc1 (k + 1) vc2 (k + 1) vc3 (k + 1)
S(k)
g (k )

Pg (k + 1) Qg (k + 1)

Q g (k )

Pg (k )
MPPT

Discrete-time Predictive Controller

Grid Operator

vc1 (k ) vc2 (k ) vc3 (k ) idg (k ) iqg (k )
Anemometer

vw (k )

vdg (k + 1) vqg (k + 1)

vdg (k ) vqg (k )

Figure 6.1: Proposed decoupled active and reactive power control with dc-link capacitor voltages balancing for a grid-tied 4L-DCI.

128

To simplify the analysis, the per-unit (p.u.) Pg is considered to be a cubic of per-unit wind speed [2]:
3 (k ). p.u. Pg (k )  p.u. vw

(6.1)

From the continuous time models given for the grid active and reactive powers in eq.(5.3), the discrete-time models can be derived for a one-step horizon time (k + 1) as demonstrated 3 Pg (k + 1) = [vdg (k + 1) idg (k + 1)] 2 (6.2) 3 Qg (k + 1) = [vdg (k + 1) iqg (k + 1)] 2 where vdg (k +1) and vqg (k +1) are the extrapolated grid voltages. For a stiff grid, vdg (k +1) = vdg (k ) and vqg (k + 1) = vqg (k ), and thus no extrapolation is needed. For weak grids the fourth-order Lagrange extrapolation method given in eq.(5.17) can be used. idg (k + 1) and iqg (k + 1) are the predicted dq -axis grid currents: idg (k ) vdi (k + 1) vdg (k ) idg (k + 1) = + i + g iqg (k + 1) iqg (k ) vqi (k + 1) vqg (k ) (6.3) below:

where vdi (k + 1) and vqi (k + 1) are the predicted inverter voltages in (k + 1) state using the 64 possible switching states. The , i and g are discrete-time parameter matrices which can be computed off-line as given in (5.11). The calculation of three-phase inverter voltages is presented below for the capacitor voltages notation used in this work: vaN vbN vcN = vc1 S1a + vc2 S2a + vc3 S3a = vc1 S1b + vc2 S2b + vc3 S3b (6.4)

= vc1 S1c + vc2 S2c + vc3 S3c .

The above natural frame (abc) inverter voltages can be converted to synchronous frame (dq ) using the transformation matrix given in Appendix B.2. The discrete-time model for dc-link voltages is given as follows: Ts ic1 (k + 1) Cdc1 Ts vc2 (k + 1) = vc2 (k ) + ic2 (k + 1) Cdc2 Ts vc3 (k + 1) = vc3 (k ) + ic3 (k + 1) Cdc3 vc1 (k + 1) = vc1 (k ) + 129

(6.5)

where ic1 (k + 1), ic2 (k + 1), and ic3 (k + 1) are predicted dc-link currents which can be calculated as follows: ic1 = K1d idg + K1q iqg ic2 = K2d idg + K2q iqg ic3 = K3d idg + K3q iqg where K1d , K1q , K2d , K2q , K3d , and K3q are variables in SRF and they can be obtained from natural frame gains and grid voltage angle, g . It should be noted that the capacitor currents are mean values. The natural frame gains can be expressed in terms of switching states as follows: K1x = sgn (3 - Sx ) K2x = sgn (2 - Sx ) K3x = sgn (1 - Sx ) where x = a, b, c. K1x , K2x , K3x  {-1, 0, 1} and sgn is a Signum function. The modeling of dc-link voltages in SRF gives flexibility in digital implementation. This will be further discussed in Section 6.3. The control objectives, such as regulation of active and reactive powers, dc-link capacitor voltages balancing and switching frequency minimization are included in a cost function as follows: ggrid (k + 1) = ||Pg(k + 1) - Pgp (k + 1)||
p + ||Q g (k + 1) - Qg (k + 1)|| p p 2 + dc  ([vc 1 (k + 1) - vc2 (k + 1)] p p 2 + [vc 2 (k + 1) - vc3 (k + 1)] p p 2 + [vc 3 (k + 1) - vc1 (k + 1)] )

(6.6)

(6.7)

(6.8)

+ swc  (swca + swcb + swcc ) where dc and swc are weighting factors for the capacitor voltages balancing and switching frequency reduction, respectively. The swcx is the number of semiconductor commutations involved in phase-x, which can be calculated as given in Table. 4.4. The cost function requires reference powers in the (k + 1) state. When the sampling time Ts is sufficiently small (< 20 s), no extrapolation is required. In this work, a sampling time of 100 s is used to deal with the 64 switching states. At this higher sampling time, the 130

reference powers should be extrapolated to the (k + 1) state for high performance control. During the steady-state operation, no extrapolation is required, as the reference powers are dc quantities. In practical WECS, the wind speed, and thus the active power reference, changes dynamically and as a result an extrapolation method should be used. The Lagrange extrapolation [221, 257] can be used. However, this method produces unnecessary spikes during the step changes [77]. The vector angle extrapolation [261] method overcomes this issue [77]. But this method is based on real and imaginary (stationary frame, , ) quantities. To use vector angle extrapolation to manage active and reactive powers, the following procedure should be used:
   · Estimate i dg (k ) and iqg (k ) from Pg (k ) and Qg (k ) using (5.3)    · Estimate i g (k ) and ig (k ) from idg (k ) and iqg (k )    · Extrapolate i g (k ) and ig (k ) to ig (k + 1) and ig (k + 1) using vector angle method    · Estimate i dg (k + 1) and iqg (k + 1) from ig (k + 1) and ig (k + 1), and   · Estimate Pg(k + 1) and Q g (k + 1) from idg (k + 1) and iqg (k + 1) using (5.3)

As shown in the above example, this is a complex approach and increases the computational burden. To overcome this issue, a simplified extrapolation method is proposed. Since the reference active and reactive powers are of dc quantities, they can be simply extrapolated to the (k + 1) state as follows: Pg (k + 1) = Pg (k - 1)
 Q g (k + 1) = Qg (k - 1)

(6.9)

Comparing the proposed approach with the Lagrange extrapolation given in (5.17), this uses only one a past value, which can be simply implemented using the "Variable Time Delay" block in the MATLAB/Simulink environment. This approach gives the same result as the vector angle extrapolation, but with a lower computational burden, especially in SRF.

131

6.2

Simulation Results

To validate the proposed control scheme, simulations are carried out using MATLAB/Simulink software with the parameters as indicated in Table 6.1. The dc-link diode (D ) is assumed to be ideal with the zero forward voltage drop. Unless otherwise stated, the cost function includes all four variables as mentioned in (6.8).

Table 6.1: Grid-tied four-level inverter parameters
Simulation Experimental Description SI p.u. SI p.u. Apparent Power (kVA) 4000 1.0 5 1.0 Grid L-L rms Voltage (V) 4000 ­ 208 ­ Grid rms Current (A) 577.35 1.0 13.88 1.0 Grid Frequency (Hz) 60 1.0 60 1.0 Filter Resistance () 0.042 0.0105 0.091 0.0105 Filter Inductance (mH) 2.1 0.2 4.6 0.2 DC-link Capacitance (F) 10200 15.33 4700 15.33 Ref dc-link Voltage (V) 7071 3.062 367 3.062 Battery Voltage (V) 7071 3.062 373 3.108 External Resistance () 46.24 11.56 100 11.56 External Capacitance (F) 10200 15.33 4700 15.33 Weight Factor 500 ­ 150 ­ Weight Factor 30000 ­ 5 ­ Sampling Time (s) 100  ­ 100  ­ Base Values Base rms Voltage (V) 2309.4 1.0 120 1.0 Base Impedance () 4.0 1.0 8.6528 1.0 Base Inductance (mH) 10.6 1.0 23.0 1.0 Base Capacitance (F) 663.15 1.0 306.56 1.0

Variable Sg vg ig fg Rg Lg Cdc  vdc E Rx Cx dc swc Ts vbg Zbg Lbg Cbg

6.2.1

Transient Analysis

The simulation results with different active and reactive power references are shown in Fig. 6.2. The wind speed (vw ) profile is shown in Fig. 6.2(a), and it increases linearly from a cut-in wind speed of 3 m/s (0.25 p.u.) and reaches the rated value of 12 m/s (1 p.u.) at t = 0.6 s. A step change in wind speed from 12 to 10.12 m/s (0.8434 p.u.) is applied at t = 0.8 s. 132

The reference active power Pg and measured active power Pg are shown in Fig. 6.2(b). The Pg is proportional to the wind speed and changes from 4 MW (1 p.u.) to 2.4 MW (0.6 p.u.) at t = 0.8 s. The active power tracks to its reference very well during the transient and steady-state conditions. The reference and grid reactive powers are depicted in Fig. 6.2(c). A step change in Q g from 0 to 1.2 MVAR (0.3 p.u.) is applied at t = 1.0 s. At t = 1.5 s, another step change in Q g is applied from 0 to -2.8 MVAR (-0.7 p.u.). During the time intervals, (1 to 1.3s) and (1.5 to 1.8s), the grid apparent power, Sg is found to be 2.6833 MVA (0.671 p.u.) and 3.6878 MVA (0.922 p.u.), respectively. The phase-a grid current, iag magnitude is proportional to the Sg as shown in Fig. 6.2(d). The net dc-bus voltage, vdc is maintained at its reference value by the battery supply as shown in Fig. 6.2(e). The balancing of capacitor voltages has been achieved during different active and reactive power references as demonstrated in Fig. 6.2(f). From these results, it can be established that the grid active and reactive powers can be controlled in a decoupled manner, similar to the classical control schemes, but with a simpler approach.
15 6 SS2 Pg , Pg (MW) SS1 4 2 0 Pg Pg

vw (m/s)

10 5 0 -5

vw

-2

(a) Wind speed profile
4 Q g , Qg (MVAR) 1 SS3 2 0 -2 -4 Qg Q g 0 .5 0

(b) Active power and its reference

SS4

iag (kA)

-0.5 -1

iag

(c) Reactive power and its reference
vc1 , vc2 , vc3 (kV)
8
 vdc , vdc (kV)

(d) Phase-a grid current
3.0 2.4 1.8 1.2 0.6 0 0 0.4 0.8 1.2 Time (s) 1.6 2 .0

vc1 vc3 vc2

7.5 7 6.5 6 0 0.4 0 .8 1 .2 Time (s) 1 .6 2 .0

vdc

 vdc

(e) Net dc-bus voltage and its reference

(f) dc-link capacitor voltages

Figure 6.2: Simulation results with dynamic active and reactive power references.

133

6.2.2

Steady-state Analysis

The performance of the proposed controller during four steady-state operating conditions (denoted as SS1-SS4 in Fig. 6.2) is summarized in Table 6.2. The performance assessment parameters are defined in Appendix C. The reference tracking errors, epg and eqg are maintained below 5 %, and thus they validate the proposed control scheme. The capacitor voltages are well balanced with an error magnitude of less than 1 %. This facilitates the reduced voltage stress on the semiconductor switches. The THD is maintained below 5 % except for SS3, where the switching frequency is much lower (776 Hz) than the other operating conditions. The switching frequency is maintained below 1 kHZ and this enhances the reliability of the switches. Table 6.2: Steady-state analysis with simulation results
 (p.u.) Q (p.u.) %e Case Pg pg %eqg %evc %THD fsw (Hz) g

SS1 SS2 SS3 SS4

1.0 0.6 0.6 0.6

0 0 0.3 -0.7

4.90 3.91 4.85 3.45

1.63 1.37 2.98 3.20

0.45 0.75 0.66 0.38

3.41 4.80 5.36 3.29

854 886 776 991

6.2.3

Comparison to Classical VOC

The proposed predictive control method is compared with the classical decoupled voltage oriented control [2,144] in steady-state and the results are presented in Figs. 6.3 to 6.8. The active and reactive power references are considered to be 1.0 p.u. (4 MW) and 0 p.u., respectively (case SS1). The dc-link capacitor voltages are assumed to be balanced and thus the weighting factor dc is set to zero. With this assumption, the number of calculations for the predictive control decreased and as a result, the device switching frequency fsw is decreased from 854 to 680 Hz. In addition, no weighting factor is used for the switching frequency minimization. The in-phase disposition (IPD) modulation, which gives the best harmonic profile [84] is used in the decoupled voltage-oriented control. In order to make the device switching frequency the same as the predictive control, the carrier frequency is set to 2040 Hz (= 680 Hz × 3). 134

The comparison between the classical and proposed method in terms of reference tracking is presented in Figs. 6.3 and 6.4. The proposed method exhibits better performance compared to the classical method. The epg and eqg for the classical method are 1.1 %, and 0.8 %, whereas, for the proposed method they are 0.98 %, and 0.75 %, respectively. The inverter line-line voltage, viab and its Fast Fourier Transform (FFT) with the classical and proposed method are shown in Figs. 6.5 and 6.6. The classical method produces harmonics around the carrier frequency and its multiples, whereas the proposed method produces harmonics spread over the whole FFT window. But, the magnitude of harmonics with the proposed method is less compared to the classical, and as a result less THD is observed. The phase-a grid current, iag and its FFT are depicted in Figs. 6.7 and 6.8, where the THD is found to be lower for the proposed method in contrast to the classical controller. Despite the lower switching frequency compared to the operating condition SS1 depicted in Table 6.2, the THD is lower, because the cost function includes only reference tracking.
6 Q g , Qg (MVAR) Pg , Pg (MW) 4 2 0 -2 Pg (k ) Pg (k ) Q g (k ) Qg (k )

0

1/60 Time (s)

2/60

3/60

Figure 6.3: Simulation results for active and reactive powers tracking with classical VOC.

6 Q g , Qg (MVAR) Pg , Pg (MW) 4 2 0 -2 Pg (k ) Pg (k ) Q g (k ) Qg (k )

0

1/60 Time (s)

2/60

3/60

Figure 6.4: Simulation results for active and reactive powers tracking with predictive control.

135

viab (kV)

10 0 -10 0.0 10 8 6 4 2 0 0 20 40 60 80 100 120 140 160 180 200 Harmonic Order 0.01 0.02 0.03 Time (s) 0.04 THD = 23.93 % 0.05

Figure 6.5: Simulation results for inverter line-line voltage and it's FFT with the classical decoupled voltage-oriented control.
viab (kV)
10 0 -10 0.0 10 8 6 4 2 0 0 20 40 60 80 100 120 140 160 180 200 Harmonic Order 0.01 0.02 0.03 Time (s) 0.04 THD = 13.36 % 0.05

Figure 6.6: Simulation results for inverter line-line voltage and it's FFT with the proposed predictive control.
iag (kA)
1 0 -1 0.0 0.01 2 .0 0.02 0.03 Time (s) 0.04 THD = 2.30 % 0.05

Mag (% of Fundamental)

FFT of viab Mag (% of Fundamental) FFT of iag

FFT of viab Mag (% of Fundamental)

1 .5

1.0

0.5 0 0 20 40 60 80 100 120 140 160 180 200 Harmonic Order

Figure 6.7: Simulation results for phase-a grid current, and it's FFT with the classical decoupled voltage-oriented control.

136

iag (kA)

1 0 -1 0.0 2.0 1.5 1.0 0.5 0 0 20 40 60 80 100 120 Harmonic Order 140 160 180 200 THD = 1.29 % 0.01 0.02 0.03 Time (s) 0.04 0.05

Figure 6.8: Simulation results for phase-a grid current, and its FFT with the proposed predictive control.

6.2.4

Comparison to Lagrange Extrapolation

The performance of the Lagrange and the proposed extrapolation methods are analyzed and compared as shown in Figs. 6.9 and 6.10. With a step change in the reference active power from 0.2 to 0.4 p.u., the Lagrange extrapolation method produces a dip in the active power, which in turn produces a spike in the inverter output line-line voltage as shown in Fig. 6.9. This voltage spike is undesirable because it will damage the semiconductor switches. It is important to note that the voltage spike is produced due to the oscillations in the extrapolated reference active power, Pg(k + 1), which is shown in the box of Fig. 6.9. The Lagrange method uses three present and past values for the calculation of future value [refer to (5.17)] and this leads to oscillations in the extrapolated reference power. The extrapolated
e p (k + 1)] and predicted grid currents [ip grid voltage [vdg dg (k + 1), iqg (k + 1)] do not contribute

to this voltage spike [refer to (6.2)]. The voltage spike occurs even for a small step change in reference active and reactive powers and thus it is not advisable to use Lagrange extrapolation method. This problem has been rectified with the proposed extrapolation method, as shown in Fig. 6.10, and thus it guarantees safe operation of the semiconductor devices. The proposed method uses only one past value and eliminates the oscillations in Pg (k + 1) as shown in the box in Fig. 6.10. Similar performance can be observed for a step change in the reference reactive power. 137

Mag (% of Fundamental)

FFT of iag

6 Pg , Pg (MW) 4 2 0
(I)

Pg (k )

Pg (k + 1)

Pg (k )

-2 10 5 viab (kV) 0 -5 -10 0
Voltage Spike (II)

1/60

2/60 Time (s)

3/60

4/60

Figure 6.9: Simulation results for step-change in active power with Lagrange extrapolation.
6 Pg , Pg (MW) 4 Pg (k ) 2 0 -2 10 5 viab (kV) 0 -5 -10 0 1/60
(II)

Pg (k + 1)
(I)

Pg (k )

2/60 Time (s)

3/60

4/60

Figure 6.10: Simulation results for step-change in active power with proposed extrapolation.

138

6.2.5

Capacitor Voltages Balancing

In order to verify the proposed dc-link balancing algorithm, two cases are considered by connecting an external resistor Rx (11.46 p.u.) and capacitor Cx (15.33 p.u.) across the dclink capacitor Cdc2 at a time of t = 0.7 s. Even with the step-connection of the resistor, the controller takes action in a few sampling instants, and thus the capacitor voltages continue to be balanced as shown in Fig. 6.11(a). With the step connection of Cx , the capacitor voltages diverge as shown in Fig. 6.11(b), but the controller forces the capacitor voltages to be balanced, while maintaining the grid powers at their reference values (of SS1). As a consequence, the capacitor voltages become balanced, with a recovery time of 0.4 s. This case may happen when any of the dc-link capacitors are damaged while they are in the parallel connection. The currents through Rx and Cx are also shown in Figs. 6.11(a) and 6.11(b), respectively. These results validate that the proposed controller can work very well even with the dc-link parameter variations.
3.0

vc1 vc3 vc2 iRx

100

3.0

vc1 vc3 vc2 iCx

100 80

vc1 , vc2 , vc3 (kV)

1.8 1.2 0.6 0 -0.6 0.6

vc1 , vc2 , vc3 (kV)

2.4

80

2 .4 1.8 1 .2 0 .6 0 0.65 0 .7 Time (s) 0.75

40 20 0

40 20 0

0.65

0.7 Time (s)

0.75

-20 0.8

-0.6 0.6

-20 0.8

(a) With external Rx across Cdc2

(b) With external Cx across Cdc2

Figure 6.11: Simulation results for dc-link capacitor voltages balancing with perturbations to the system model.

6.2.6

Robustness Analysis

To demonstrate the robustness of predictive control with the filter parameter variations, two cases are considered: in the first case (CF: changes to the filter), the filter inductance is considered to change from 143.5 % to 56.5 %, but this information is not provided to the controller. The control algorithm uses a rated filter inductance value of 100 % (0.2 p.u.=2.1 mH). This is the typical case in a grid-tied system, where the power system impedance changes randomly, and as a consequence, the equivalent filter value changes. 139

iCx (A)

iRx (A)

60

60

In the second case (CCF: changes to the controller and filter), the correct values of the filter are given to the controller for the purpose of comparison. To simplify the analysis, the switching frequency minimization is not considered, and thus swc = 0. Even though the filter parameters change, the controller chooses a switching state that produces the minimal error in the reference tracking and capacitor voltages balancing. As shown in Figs. 6.12(a) and 6.12(b), the difference between the CF and CCF conditions is found to be very small, in the Lg variation range of 130 % to 70 %.
10
%epg %epg %eqg %eqg with CF with CCF with CF with CCF

1 .0

8

0.8

%evc with CF

% epg , % eqg

%evc with CCF

6

0.6

4

0 .4

2

0.2

0 143.5 % 121.7 % 100 % 67.4 % 56.5 % Filter Inductance, Lg

0

(a) Comparison of %epg , %eqg and %evc
10
%THD with CF %THD with CCF fsw with CF fsw with CCF

2800

8

2000

4

800

2

400

0 143.5 % 121.7 % 100 % 67.4 % 56.5 % Filter Inductance, Lg

0

(b) Comparison of %THD and fsw (Hz)

Figure 6.12: Simulation results with grid filter parameter variations (CF: changes to filter, and CCF: changes to controller and filter.)

140

fsw (Hz)

6

1200

%THD

% evc

6.3

Experimental Results

In order to verify the performance of the proposed control strategy, experimental results are presented using a 5 kVA/208 V 4L-DCC prototype and dSPACE DS1003 control platform. More details about the experimental set-up can be found in the Section 5.5.1. The inverter and controller parameters are listed in Table 6.1. To compensate for the computational delay, the cost function is calculated using the guidelines given in Chapter 5.5.2. The control algorithm with delay compensation is shown in Fig. 6.13. Because of the SRF modeling of dc-link voltages, the idg (k + 1) and iqg (k + 1) can be used directly in the prediction of ic1 (k + 2), ic2 (k + 2) and ic3 (k + 2) [refer to (6.6)]. If the modeling of capacitor voltages is done in a natural frame, then the idg (k + 1) and iqg (k + 1) should be converted to iag (k + 1), ibg (k + 1), and icg (k + 1) during each sampling interval, and this will increase the computational burden. Due to the (k + 2) predictions, and the SI parameter values, the weighting factors obtained in the experiments are different from the simulations, but their impact on the controller remains the same.
Estimate Measurement
m vc (k ), m vg (k )

g (k )
m m vdg (k ), vqg (k ) m m idg (k ), iqg (k ) e (k vdg,qg

Apply
Sik op , i = 1...18

Delay Compensation Pgp (k + 1), Qp g (k + 1)
p vc 1,2,3 (k + 1)

gop = 

im g (k )

+ 1)

Gating Signals to 4L-Inverter

Select kop gop = min {gk }k=1...64 kop = k |gop Yes No Sx = 3?

for
Sx = 0 : 3

Derive S1x , S2x , S3x from Sx

Minimization of Cost Function ggrid (k + 1)

Predictive Model
Pgp (k + 2), Qp g (k + 2)
p vc 1,2,3 (k + 2)

Figure 6.13: Proposed predictive power control algorithm with delay compensation.

141

The experimental results with the different active and reactive power references are shown in Fig. 6.14. Similar to the simulations, the decoupled control of active and reactive powers is achieved with a good dynamic response and less steady-state error. The dc-link capacitor voltages are balanced during all the operating conditions. The steady-state analysis has been carried out and summarized in Table. 6.3. The higher tracking errors in experiments can be attributed to the delay provided by the sensors and the IGBT gate drivers. Since the predictions are in (k + 2), the evc is found to be smaller than in simulations. Table 6.3: Steady-state analysis with experimental results
 (p.u.) Q (p.u.) %e Case Pg pg %eqg %evc %THD fsw (Hz) g

SS1 SS2 SS3 SS4

1.0 0.6 0.6 0.6

0 0 0.3 -0.7

5.08 4.05 4.56 3.87

2.59 2.34 3.25 3.89

0.39 0.63 0.51 0.29

3.82 5.23 4.88 3.70

845 900 731 998

The Lagrange and proposed extrapolation methods are experimentally analyzed and compared as shown in Fig. 6.15. As confirmed by the simulations, the Lagrange extrapolation method produces a dip in the active power and a spike in the inverter output voltage as shown in Fig. 6.15(a). The oscillations in the extrapolated reference active power Pg (k + 2) are also shown in Fig. 6.15(a). The proposed extrapolation method eliminates the voltage spike as shown in Fig. 6.15(b) and protects the semiconductor switches. The dc-link dynamics with the external resistor Rx and capacitor Cx across Cdc2 , are given in Figs. 6.16(a) and 6.16(b), respectively. Similar to the simulations, the balancing of the dc-link capacitor voltages have been maintained even with the step-connection of Rx and Cx . The recovery time is found to be 1.3 s with Cx , which is higher compared to the simulations. This difference is established due to the different weighting factors and SI values of the grid current and the dc-link capacitor used in the prototype. The effect of the filter parameter variations on the proposed controller is experimentally analyzed and presented in Figs. 6.17(a) and 6.17(b). Only a small difference is observed between the CF and CCF cases which are similar to the simulation results, when the Lg variation is in a range of 130 % to 70 %. These results validate the robustness of the proposed controller. 142

vw

iag

Pg

Qg
Ch1: 5 (m/s)/div, Ch2: 20 A/div Ch3: 5 kW/div, Ch4: 5 kVAR/div, t=200 ms/div
(a)

vdc vc3

vc1

vc2

Ch1: 50 V/div, Ch2: 50 V/div Ch3: 50 V/div, Ch4: 100 V/div, t=200 ms/div
(b)

Figure 6.14: Experimental results with dynamic active and reactive power references.

143

Ch1: 2.5 kW/div, Ch2: 5 kW/div Ch3: 2.5 kW/div, Ch4: 200 V/div, t=5 ms/div

Pg (k ) Pg (k ) Pg (k + 2)

Voltage Spike

viab

(a) With Lagrange extrapolation
Ch1: 2.5 kW/div, Ch2: 5 kW/div Ch3: 2.5 kW/div, Ch4: 200 V/div, t=5 ms/div

Pg (k ) Pg (k ) Pg (k + 2)

viab
(b) With the proposed extrapolation

Figure 6.15: Experimental results during the step change in active power reference.

vc1

vc2

vc3

vc3

vc1

vc2

iRx
Ch1: 25 V/div, Ch2: 25 V/div Ch3: 25 V/div, Ch4: 600 mA/div, t=100 ms/div

iCx
Ch1: 25 V/div, Ch2: 25 V/div, Ch3: 25 V/div, Ch4: 600 mA/div, t=500 ms/div

(a) External Rx across Cdc2

(b) External Cx across Cdc2

Figure 6.16: Experimental results for dc-link capacitor voltages balancing with the perturbations in system model.

144

10

8

% epg , % eqg

% epg with CF % epg with CCF % eqg with CF % eqg with CCF % evc with CF % evc with CCF

1.0

0.8

6

0.6 % evc

4

0.4

2

0.2

0 143.5 % 121.7 % 100 % 67.4 % 56.5 %

0

Filter Inductance, Lg
(a) Comparison of %epg , %eqg and %evc

10
%THD with CF %THD with CCF fsw with CF fsw with CCF

2800

8

2000

4

800

2

400

0 143.5 % 121.7 % 100 % 67.4 % 56.5 %

0

Filter Inductance, Lg
(b) Comparison of %THD and fsw (Hz)

Figure 6.17: Experimental analysis with grid filter parameter variations (CF: changes to filter, and CCF: changes to controller and filter).

145

fsw (Hz)

6
%THD

1200

6.4

Conclusion

In this chapter, an intuitive approach using model predictive control is presented in a synchronous reference frame for the decoupled active and reactive power regulation of a gridtied 4L-DCC. The major contributions of the work presented in this chapter are summarized as follows: · The decoupled active and reactive power control, along with the dc-link capacitor voltages balancing, have been achieved during all operating conditions. The proposed methodology can be easily extended to other level DCCs. · The dynamic response has been improved by eliminating the internal current control loops and modulators. Compared with the classical decoupled voltage-oriented control, a better reference tracking and grid current waveforms have been achieved. · The switching loss of the semiconductor devices is minimized by maintaining the switching frequency below 1 kHz. · The proposed extrapolation method can extrapolate SRF references to future state without any oscillations (in reference control variables) during the transient conditions. Moreover, this method is computationally inexpensive compared to Lagrange extrapolation as it uses only one past sample value for the extrapolation. · The control scheme can compensate for perturbations in the dc-link and grid filter parameter changes, while the grid active and reactive powers continue to effectively track their references.

146

Chapter 7 Predictive Control of Three-Level Boost and NPC Converters Based PMSG-WECS
In this chapter, a novel medium voltage (MV) converter using a diode rectifier, threelevel boost (TLB) converter and neutral-point-clamped (NPC) inverter is proposed for a high power permanent magnet synchronous generator (PMSG) based wind energy conversion system (WECS). A model predictive strategy is introduced to control the complete WECS. The major tasks being carried out in this chapter are summarized as follows: · Continuous- and discrete-time modeling of the complete WECS including TLB and NPC converters is presented; · Independent control loops are presented for the TLB and NPC converters. The strategy presented here for the grid-tied converter control is different from the one discussed in Chapters 5 and 6. · The average semiconductor device switching frequencies are minimized and maintained below 1.5 kHZ and 1 kHz, respectively for the TLB and NPC converters. · Effectiveness of the boost converter in controlling the neutral-point voltage with the perturbations in the dc-link is investigated. · Feasibility of the proposed converter and control scheme is verified through MATLAB simulations on 3 MW/3000 V/577 A system and dSPACE DS1103-based experiments on a 3.6 kW/208 V/10 A prototype. 147

idc Rdc ,Ldc
P(1) Wind Turbine

D1

ip
S1a S1b

S1c
+ -

S1

ic1
C1

vc1

ias ibs
Cin
+

S2a
Z(0)

S2b

S2c Rg , Lg

MV Grid

iz

ics
Direct Driven MV PMSG

-

vin

iag ibg ic2

icg
S2 D2
+

vg C2
-

vc2

S 1a S 2a
Three-Level Boost Converter N(-1) dc-Link

S 1b S 2b

S 1c

S 2c

Diode Rectifier

in

Three-Level NPC Converter

Figure 7.1: Configuration of TLB-NPC converters based medium voltage PMSG-WECS.

148

7.1

Modeling of Complete WECS

The power conversion system for the direct-driven PMSG-based WECS is shown in Fig. 7.1. It consists of three stages: ac/dc, dc/dc and dc/ac, and these are implemented using a diode rectifier, TLB converter and NPC inverter, respectively. The diode rectifier limits the direction of power flow, and only the generating mode is possible which is the typical requirement in a WECS. The diode rectifier features series connected diodes due to the MV generator. The output of the diode rectifier, vin remains unregulated but is limited by the rated speed of the turbine, which defines the voltage rating of the capacitor. The TLB converter enables MV operation for the dc-dc stage. The WECS can be operated efficiently in the complete wind speed range by controlling the gating signals for the TLB converter [115]. The output of the TLB directly fits the two dc-link capacitors of the grid-tied NPC inverter. This second dc-link provides decoupling for the generator- and grid-side converters and thus individual control loops can be developed. The inverter is composed of 12 active switches and 6 clamping diodes. The dc-link consists of two capacitors, and ideally they will share equal voltages (vc1 = vc2 = vc ). The NPC inverter is connected to the MV grid through an L filter. The NPC multilevel and medium voltage operation at grid-side improves the power quality and efficiency of the system compared to the two-level converters [2, 3, 14]. It is important to note that both the generator and grid are rated for MV operation. In the proposed megawatt-level WECS, the following four variables need to be regulated: · Maximum power point tracking (MPPT) during all wind speed conditions to improve wind energy conversion efficiency · Balancing of the dc-link capacitor voltages in order to reduce the device voltage stress and improve power quality · Net dc-bus voltage control to ensure proper operation for the grid-tied inverter · Reactive power generation to meet the grid codes The first two variables are regulated by the TLB converter, and the last two variables are handled by the NPC inverter. In this section, the modeling is presented to demonstrate that the proposed power converters accomplish the above-mentioned control requirements. 149

7.1.1

Grid-Tied NPC Inverter Model

The mathematical modeling of the NPC inverter was previously analyzed in [279]. In this chapter, a simplified modeling is achieved owing to the fact that the NPC inverter need not control the dc capacitor voltages. The grid-tied inverter control was proposed in synchronous reference frame in Chapters 5 and 6. In this chapter, the model is presented in a stationary frame to reduce the number of online calculations incurred in the discrete-time predictive controller. The switching states and the corresponding inverter voltages are shown in Table 7.1, where, it can be noted that: (a) only two switches conduct at any time, (b) switch pairs (S1x , S 1x ), and (S2x , S 2x ) operate in a complementary manner, and (c) a total of 19 voltage vectors with 27 (33 ) switching combinations are available [84].

Table 7.1: Switching states and NPC inverter terminal voltages (x = a, b, c) Sx 1 0 -1 S1x S2x S 1x S 2x 1 0 0 1 1 0 0 1 1 0 0 1 vxN vc1 + vc2 vc2 0

The inverter ac-side voltages (with respect to the negative dc-rail, N ) can be expressed in terms of switching signals and dc-side voltages as follows:       vaN S1a S2a        vbN  = vc1  S1b  + vc2  S2b  vcN S1c S2c

(7.1)

where vc1 and vc2 are dc-link capacitor voltages. S1a , S2a , S1b , S2b , S1c , and S2c are the switching signals. The grid current dynamics can be expressed in terms of inverter voltages, grid voltages and filter inductance as, in the following: d ig 1 [vi - vg - Rg ig ] = dt Lg where Lg is the grid filter inductance and Rg is the internal resistance of the inductor. 150 (7.2)

The current and voltage vectors are defined as: ig vi vg = = = [ig ig ]T = [Kabc ] [iag ibg icg ]T

[vi vi ]T [vg vg ]T

= [Kabc ] [vaN vbN vcN ]T = [Kabc ] [vag vbg vcg ]T

where [Kabc ] is the transformation matrix [refer to (B.1)]. The discrete-time model for grid currents can be obtained from (7.2) for one-step prediction as follows [refer to (4.8)] [258, 259]: ig (k + 1) = Cv [vi (k + 1) + vg (k )] + Ci ig (k ) where Cv and Ci are constants as defined by, Cv = Ts , Lg + Rg Ts Ci = Lg Lg + Rg Ts (7.4) (7.3)

where Ts is the sampling time. The prediction of inverter voltage uses the 27 possible switching states and the measured dc-link capacitor voltages, as demonstrated in (7.1). From (7.1) and (7.3), it can be understood that the future behavior of the grid currents can be controlled by properly choosing an optimal one among the 27 switching states.

7.1.2

Three-Level Boost Converter Model

The discrete-time modeling and control of a standard 2L-boost converter was analyzed in [295]. In this paper, a similar approach is used for the modeling and control of the TLB converter. A simplified WECS as shown in Fig. 7.2 is derived to facilitate the modeling of the TLB converter [72]. The PMSG, along with the diode rectifier and capacitive filter, Cin can be represented as a variable dc voltage source, vin , and the grid-tied inverter can be represented by two variable resistive loads (R1 and R2 ) as shown in Fig. 7.3. The Rdc represents the internal resistance of the inductor Ldc . In a 2L-boost converter only one active switch is used, and this leads to 2 (2number of active switches = 21 ) operating modes (0 or 1). In the TLB converter, two active switches (S1 and S2 ) are used as shown in Figs. 7.1 to 7.3 and consequently 4 (2number of active switches = 22 ) modes are available (00, 01, 10, 11) [118, 296­298]. The increase in the operating modes and thus switching states will lead to an additional control freedom to charge and discharge the dc-link capacitors independently. 151

Virtual Resistors

Rdc , Ldc

D1

P(1)
NPC Inverter

idc
S1 C1
Z(0)

ip
R1

io1

vin
S2 D2

iz io2
R2

C2

iag ibg icg

in
N(-1)

Figure 7.2: Simplified power circuit of the dc-dc TLB converter stage.

Rdc ,Ldc D1

Rdc ,Ldc D1

Rdc ,Ldc D1

Rdc ,Ldc D1

idc
S1

ic1
C1

io1
vc1
R1

idc
S1

ic1
C1

io1
vc1
R1

idc
S1

ic1
C1

io1
vc1
R1

idc
S1

ic1
C1

io1
vc1
R1

vin

vin

vin

vin

ic2
S2 C2 D2

io2
vc2
R2 S2

ic2
C2 D2

io2
vc2
R2 S2

ic2
C2 D2

io2
vc2
R2 S2

ic2
C2 D2

io2
vc2
R2

(a) Mode-I

(b) Mode-II

(c) Mode-III

(d) Mode-IV

Figure 7.3: Modes of operation for three-level boost converter.

· Mode-I: [Fig. 7.3(a)] The S1 , S2 are ON and D1 , D2 are OFF. The dc-current, idc flows through the Ldc , S1 and S2 and thus energy is stored in the inductor only and the dc-link capacitors are not charged. The energy which is already stored in the capacitors C1 and C2 is discharged to the virtual loads R1 and R2 , respectively. The output currents through these loads can be represented as io1 and io2 . During this mode, the inductor current and dc-link voltages can be represented as follows: d idc vin - Rdc idc = , dt Ldc io1 d vc1 =- , dt C1 152 io2 d vc2 =- . dt C2 (7.5)

· Mode-II: [Fig. 7.3(b)] The S1 , D2 are ON and S2 , D1 are OFF. The dc-current flows through the Ldc , S1 , C2 , R2 and D2 and thus stored inductor energy is transferred to the C2 and R2 . The energy in capacitor C1 is discharged to the load R1 . The resulting equations can be given as: d idc vin - Rdc idc - vc2 , = dt Ldc d vc1 io1 =- dt C1 , d vc2 io2 idc - . = dt C2 C2 (7.6)

· Mode-III: [Fig. 7.3(c)] The S2 , D1 are ON and S1 , D2 are OFF. The dc-current flows through the Ldc , D1 , C1 , R1 and S2 and thus stored inductor energy is transferred to C1 and R1 . The energy in capacitor C2 is discharged to the load R2 . The subsequent equations are: vin - Rdc idc - vc1 d idc = , dt Ldc idc d vc1 io1 = - , dt C1 C1 io2 d vc2 =- . dt C2 (7.7)

· Mode-IV: [Fig. 7.3(d)] The D1 , D2 are ON and S1 , S2 are OFF. The dc-current flows through the Ldc , D1 , C1 , R1 , C2 , R2 and D2 and thus inductor energy is transferred to the capacitors C1 , C2 and loads R1 , R2 . The dynamic system is as follows: vin - Rdc idc - vc1 - vc2 d idc = , dt Ldc idc d vc1 io1 = - , dt C1 C1 idc d vc2 io2 = - . (7.8) dt C2 C2

By combining the dynamic equations in (7.5)-(7.8), the continuous-time system describing inductor current and dc-link capacitor voltages can be obtained as:    1   R   S1t ) (1-S2t ) dc - (1- - 0 0 - Ldc i vin idc dc Ldc Ldc L d    (1-S1t )     dc   1 0 0  vc1  +  0 - C1 0   io1  vc1  =  C1 dt (1-S2t ) 1 vc2 vc2 io2 0 0 -C 0 0 C2 2 

(7.9)

where S1t and S2t are the switching signals applied to the switches S1 and S2 respectively. It is important to note that there is no need to measure the output currents, io1 and io2 of the three-level boost converter. They can be calculated using the three-phase grid currents and switching states of the NPC inverter (refer to Table 7.1). This is demonstrated as follows: io1 = ip io2 = ip + iz = S1a S2a · iag + S1b S2b · ibg + S1c S2c · icg = S1a S2a · iag + S1b S2b · ibg + S1c S2c · icg +S 1a S2a · iag + S 1b S2b · ibg + S 1c S2c · icg . 153 (7.10)

The currents ip and iz are shown in Fig. 7.2. From the continuous-time system described in (7.9), the discrete-time model for the three-level boost converter can be derived as:     12 (1 - S1t ) 13 (1 - S2t ) idc (k ) idc (k + 1) 11      22 23  vc1 (k ) vc1 (k + 1) = 21 (1 - S1t ) vc2 (k + 1) vc2 (k ) 31 (1 - S2t ) 32 33    vin (k ) 11 12 13    + 21 22 23   io1 (k )  . 31 32 33 io2 (k ) 

(7.11)

Since the continuous-time parameter matrix A contains the switching signals of the boost converter, the discrete-time conversion is not straight forward. The gating signals S1t and S2t are set to zero during the process of discrete-time conversion.  11  21 31  11  21 31 where  12 13 ~  22 23  = eATs 32 33  12 13 ~  ~ -1 A (e Ts - I3x3 )B 22 23  = A 32 33   R 1 dc - L1 - - Ldc Ldc dc  1 ~ = A 0 0 .  C 1 1 0 0 C2

(7.12)

(7.13)

From (7.11), it can be established that using the measured and estimated quantities in k th instant [idc (k ), vc1 (k ), vc2 (k ), vin (k ), io1 (k ), io2 (k )] and 4 possible switching states, the future behavior of the dc inductor current [idc (k + 1)] and dc-link capacitor voltages [vc1 (k + 1), vc2 (k +1)] can be obtained. In contrast to the NPC rectifier, with the proposed configuration, the number of switching states are decreased from 27 to 4, leading to a lower computational burden. Moreover, the proposed approach does not require the model of PMSG and wind turbine, and thus the complexity of modeling and control is greatly simplified compared to the BTB NPC converters.

154

Wind Three-Level Three-Level NPC Converter dc-Link Diode Rectifier Boost Converter

Turbine

Rg , Lg a, b, c

MV Grid

Direct-Driven

vg (k )

MV PMSG

idc (k ) vin (k ) vc2 (k ) ig (k ) ig (k )

vc1 (k )

ig (k ) abc/ abc/dq
PLL

 m (k )

2

i dc (k )
Extrapolation Minimization Cost function, ggen (k )

i dc (k + 1)

Sr (k)

Si (k)

12

 Cost function, ggrid (k ) ig (k + 1)

vg (k ) vdg (k ) vg (k )
Extrapolation

g (k )

Sr (k - 1)

Si (k - 1)

155
idc (k + 1)
vc2 (k + 1) vc1 (k + 1)

Minimization

i g (k + 1)

ig (k + 1) ig (k + 1)
Predictive Control of NPC Inverter

i g (k ) i g (k ) dq / i qg (k )
-1.5vdg (k )

vin (k ) io1 (k )
Predictive Control of Boost Converter Boost Output Currents Calculator

÷

×

 Pdc (k )

g (k ) i dg (k ) vc1 (k ) vc2 (k ) vg (k ) vg (k ) ig (k ) ig (k )
÷ ×

io2 (k )
12

 m (k ) ig (k )
Si (k)

 vdc (k )

PI Q g (k )

+ -

MPPT

vin (k )

idc (k )

vdc (k )

Figure 7.4: Proposed model predictive control scheme for three-level boost and NPC converter based PMSG-WECS.

7.2

Control System for Proposed PMSG-WECS

The complete control system for the proposed PMSG-WECS is shown in Fig. 7.4. Two individual control loops are developed due to the decoupled nature of the TLB converter and the NPC inverter.

7.2.1

Predictive Control of Three-Level Boost Converter

From the TLB converter perspective, the dc-link is treated as a constant voltage source, as the net dc-bus voltage is well controlled by the grid-tied NPC inverter. With this condition, the PMSG stator current, and thus the electromagnetic torque, can be regulated by controlling the gating signals for the TLB converter. A step-by-step procedure for the generation of TLB gating signals is given as follows: · The first step in the implementation of a control system for the TLB converter is to develop the MPPT algorithm. To enable the variable speed operation of WECS, MPPT algorithm is used. In this paper, an optimum power control MPPT algorithm [47] is employed. The advanced, efficient and sophisticated MPPT algorithms proposed in literature can be readily applied to this TLB converter to increase the WECS efficiency. · Develop a look-up table containing the generator mechanical speed (m ) versus output
 3  m ) using the rated turbine parameters. power reference (Pdc  (k ) using the look-up · Measure m (k ) with the help of shaft encoders and compute Pdc

table designed in the previous step. · The input power to the TLB converter is a product of the input dc voltage and dc (k )] with inductor current (Pdc = vin · idc ). By dividing the input power reference [Pdc

the measured input voltage [vin (k )], the reference dc-inductor current can be obtained
 [i dc (k ) = Pdc (k )/vin (k )]. With the varying wind speed conditions, this reference current

changes, and the MPPT operation can be achieved by tracking to this quantity. · Estimate the future value of the reference dc current, i dc (k + 1) using the fourth-order Lagrange extrapolation induced in Section 3.3.4.
    i dc (k + 1) = 4 idc (k ) - 6 idc (k - 1) + 4 idc (k - 2) - idc (k - 3).

(7.14)

156

· Develop an initialization file containing the parameter matrices  and . · Measure the three-phase grid currents and NPC inverter gating signals during the k th sampling instant. Estimate io1 (k ) and io2 (k ) using (7.10). · Measure idc (k ), vc1 (k ), vc2 (k ) and vin (k ). By using (7.11), obtain the future behavior of the inductor current [idc (k +1)] and dc-link capacitor voltages [vc1 (k +1) and vc2 (k +1)]. · Define a cost function for the TLB converter as follows by incorporating its control objectives:
2 ggen (k ) = [i dc (k + 1) - idc (k + 1)]

+ dc,b  [vc1 (k + 1) - vc2 (k + 1)]2 + swc,b 
j =1,2

(7.15)

| Sjt (k ) - Sjt,op (k ) |

where dc,b and swc,b are weighting factors for the dc-link capacitor voltages balancing and switching frequency reduction, respectively. S1t (k ) and S2t (k ) are the predicted gating signals. S1t,op (k ) = S1t (k - 1) and S2t,op (k ) = S2t (k - 1) are the optimal gating signals in the previous sample. · During each sampling instant, the switching signals S1t (k ) and S2t (k ), which minimize the cost function (7.15), are chosen and applied to the TLB converter directly. It should be noted that the linear regulators and PWM modulator are eliminated with the proposed approach. In (7.15), the primary control goal is to force the inductor current to follow its reference, and thus the weighting factor associated with this term is 1. The secondary goal is to balance the dc-link capacitor voltages. A weighting factor dc,b is defined such that the importance for the secondary goal can be adjusted according to the desired performance. When dc,b = 1, the secondary goal will be given equal importance compared to the primary goal, and thus a very good balancing of the dc-link capacitor voltages can be obtained, but at the expense of a higher inductor current tracking error. When dc,b = 0, the dc-link capacitor voltages are not controlled, but the inductor current shows excellent reference tracking. Unfortunately, in the state-of-the-art predictive control, no analytical or numerical methods are available for the calculation of weighting factor values, but the guidelines given in [247] can be used. 157

The best approach is to select dc,b = 1 in the initial trial, and reduce this value in small steps until the drift in capacitor voltages reach 2 % of its nominal dc-link voltage. Another secondary goal is switching frequency minimization. Its importance can be altered by changing the swc,b value. When swc,b > 0, the switching frequency reduction can be obtained, but at the expense of a higher inductor current tracking error and drift in capacitor voltages. The cost function in (7.15) includes more than one control goal, and under such conditions the quadratic cost function gives better performance than the absolute cost function [77].

7.2.2

Predictive Control of NPC Inverter

From the NPC inverter perspective, the dc-link is treated as a variable dc current source whose magnitude is proportional to the active power extracted from the wind. Under these conditions, the net dc-bus voltage and reactive power to the grid can be regulated by properly generating the gating signals for the grid-tied NPC inverter [81]. The control system implementation procedure is as follows: · Measure the grid voltages, currents and dc-link capacitor voltages, and estimate the grid voltage angle, g using a SRF phase-locked loop (SRF-PLL) using guidelines given in Appendix B.4. · Convert measured grid voltages and currents to  and dq frames.
   · Generate i dg and iqg from vdc and Qg loops, respectively. More details about the

definition of grid-side reference control variables can be found in Chapter 5.
   · Convert the SRF references (i dg and iqg ) to stationary frame (ig and ig ) using the

grid voltage angle g . · Estimate the future value (k + 1) of reference grid currents as shown below. The vector angle extrapolation introduced in the Chapter 3 is used here.
 i g (k + 1) jg T s ig (k ) = e i i g (k + 1) g (k )

(7.16)

where g is grid angular frequency. 158

· Using the measured quantities and off-line computed Cv and Ci values, predict the future behavior of  grid currents during each iteration according to (7.3). · The grid-side cost function, developed so that control goals could be met, is defined as follows: ggrid (k ) = i g (k + 1) - ig (k + 1) + swc,i 
j =1, 2 x=a,b,c 2

+ i g (k + 1) - ig (k + 1)

2

| Sjx (k ) - Sjx,op (k ) |

(7.17)

where swc,i is the weighting factor for switching frequency reduction of the NPC inverter. · During each iteration, the predicted variables are compared with the extrapolated references. The switching state (among 27) which minimizes the cost function is chosen and applied to the NPC inverter gating terminals during the next sampling interval. The selection of the weighting factor and cost function type for the NPC inverter is similar to the TLB converter presented earlier. Compared to the works in [80, 81, 279, 280, 299], the grid-side cost function here deals with one primary objective (reference tracking of grid currents) and one secondary objective (switching frequency minimization) only. The dc-link capacitor voltages are not considered in the inverter cost function. Since the cost function has fewer numbers of objectives, the computational burden becomes lower. The selection of the best switching state (among 27) becomes easier and more straightforward (without any weighting factor designs for the dc-link capacitor voltages unlike in [80, 81, 279, 280, 299]). The quality of the primary control goal (reference tracking) greatly improves as the number of secondary control goals is reduced. The analysis presented here is also applicable for the classical control techniques which utilize space vector modulation (SVM). The selection of the closest vector in the SVM method is decided according to the minimal value of the cost function [183]. Since the dclink capacitor voltages do not need to be controlled by the SVM, the output power quality of the NPC inverter can be greatly enhanced. Instead of SVM, a simplified pulse width modulation can also be employed for the NPC inverter. The performance comparison of the proposed predictive controller with the simplified SVM and PWM methods will be considered as part of future work. 159

7.3

Simulation Results

The power converter topology and control scheme given in Figs. 7.1 and 7.4 are simulated in MATLAB/Simulink environment with the 3 MW/3000 V/577 A WECS parameters as indicated in Table 7.2. The PMSG is assumed to have surface mount magnets by which Ld = Lq . A one-step prediction horizon is considered in all the simulation tests. Table 7.2: Parameters of the proposed wind energy conversion system
Simulation Experimental Variable Description SI p.u. SI p.u. Permanent Magnet Synchronous Generator Parameters Pm Rated Mechanical Power (kW) 3000 3.6 vsl Rated Line-Line Voltage (V) 3000 208 vs Rated Phase Voltage (V) 1732.2 1.0 120.1 1.0 is Rated Stator Current (A) 582 1.0 10 1.0 fs Rated Stator Frequency (Hz) 9.75 1.0 20 1.0 P Fs Rated Power Factor 0.98 0.98 nm Rated Rotor Speed (rpm) 22.5 1.0 150 1.0 PP Number of Pole Pairs 26 8 Tm Rated Mechanical Torque (kN.m) 1273.24 1.0 0.2292 1.0 r Rated rms Rotor Flux Linkage (Wb) 28.059 1.0 0.956 1.0 Rs Stator Winding Resistance (m) 37.521 0.013 245 0.021 Ld d-axis Synchronous Inductance (mH) 9.75 0.2 19.1 0.2 Lq q -axis Synchronous Inductance (mH) 9.75 0.2 19.1 0.2 Medium Voltage Grid Parameters Sg Rated Apparent Power (kVA) 3000 1.0 3.6 1.0 vgl Rated Line-Line Voltage (V) 3000 208 vg Rated Phase Voltage (V) 1732.2 1.0 120.1 1.0 ig Rated Stator Current (A) 577.35 1.0 10 1.0 fg Rated Stator Frequency (Hz) 60 1.0 60 1.0 Zbg Base Impedance () 3 1.0 12.018 1.0 Lbg Base Inductance (mH) 7.96 1.0 31.88 1.0 Cbg Base Capacitance (F) 884.19 1.0 220.72 1.0 Rectifier and Inverter Parameters Cin Input dc-link Capacitance (F) 38937 7.40 4700 7.40 Cdc Output dc-link Capacitance (F) 4006 4.53 1000 4.53 Rdc Boost Filter Leakage Resistance () 0.3 0.01 0.12 0.01 Ldc Boost Filter Inductance (mH) 7.5 0.94 30 0.94 Rg Grid-side Filter Resistance () 0.027 0.009 0.108 0.009 Lg Grid-side Filter Inductance (mH) 1.65 0.207 6.6 0.207 Controller Parameters Ts Sampling Time (s) 100  100  dc,b Weighting Factor 0.1 0.1 sw,b Weighting Factor 100 1.5 sw,i Weighting Factor 100 0.05  vdc Reference dc-bus Voltage (V) 5304 3.062 367 3.062 kP,dc DC-link Controller Proportional Gain 1 1 kI,dc DC-link Controller Integral Gain 200 200

160

Figs. 7.5 and 7.6 shows the simulation waveforms with different wind speeds and reactive power references. Initially the wind speed is considered to be 12 m/s (1 p.u.) and the generator operates at its rated speed. The PMSG stator voltage and current waveforms are distorted due to the natural commutation of the diodes. The fundamental components of the stator voltage and current are in-phase (not shown in figure), and thus a unity power factor operation is achieved for the PMSG. The electromagnetic torque, Te contains ripples due to the harmonics in the generator three-phase currents. The dc-link current, idc is maintained at its reference value by the boost converter, while the net dc-bus voltage and reactive power are regulated at their reference values by the grid-side inverter. The grid current is noted to be 560 A with a total harmonic distortion (THD) of 2.76 % and the phase angle between the grid voltage and current is zero (not shown in figure) due to the zero reactive power reference. The active power and apparent powers are noted 2.91 MW and 2.91 MVAR, respectively. It is important to note that the rated output of the generator is lower than the mechanical input power (3 MW). During this operating condition, the switching frequencies of the boost converter and NPC inverters are found to be 1400 and 900 Hz, respectively. At t = 0.5 s, a gradual change in wind speed is applied from 12 m/s (1 p.u.) to 10.8 m/s (0.9 p.u.), and the generator speed, generator current, electromagnetic torque and boost converter input voltage settled to a new operating point after short transients. With the changes in the generator speed, the MPPT algorithm generated a new reference for the dclink current, and the controller forced the dc-link current to track to its reference, meaning that MPPT is obtained with varying wind speed conditions. The grid currents magnitude (409 A with 3.61 % THD) and thus active power (2.13 MW) delivered to the grid are changed according to the reduced wind speed condition. The switching frequencies are 1022 Hz and 890 Hz respectively for the boost converter and NPC inverter. At t = 0.7 s, a step change in Q g is applied from 0 to -2.055 MVAR (-0.685 p.u.). A good transient response is achieved as demonstrated through the grid current and reactive power waveforms. The grid current magnitude, grid current THD, grid power factor and inverter switching frequency are found to be 567 A, 2.67 %, 0.73 leading, and 840 Hz, respectively. The boost converter switching frequency is unchanged (1022 Hz). The grid current leads the grid voltage by 43.22 . The grid apparent power (Sg = MVA. Pg2 + Q2 g ) is noted to be 2.96

161

2.5 2.25 2.0

(a) PMSG mechanical speed, m (rad/s)
2 1 0
 (b) PMSG electromagnetic torque, Te and its reference Te , (MN.m)

5 0 -5

(c) PMSG line-line voltage, vs,ab (kV)
1 0 -1

(d) PMSG phase-a line current, ias (kA)
4 3.5 3

(e) Boost converter input voltage, vin (V)
1 0.7 0.4

(f) Boost converter inductor current, idc and its reference i dc (kA)
2.75 2.65 2.55

(g) dc-link capacitor voltages, vc1 and vc2 (kV)
5.35 5.3 5.25 0.4

0.5

0.6

0.7

0.8

0.9

1.0

Time (s)
 (h) Net dc-bus voltage, vdc and its reference vdc (kV)

Figure 7.5: Simulation results with step change in wind speed and programmed changes in reactive power reference (first part of figure).

162

4 2 0

(a) Grid active power, Pg (MW)
3 0 -3

(b) Grid reactive power, Qg and its reference Q g (MVAR)
4 2 0

(c) Grid apparent power, Sg (MVA)
8 0 -8

(d) NPC line-line voltage, vi,ab (kV)
1 0 -1 0.4 0.5 0.6 0.7 0.8 0.9 1.0

Time (s)

(e) Grid phase-a current, iag (kA)

Figure 7.6: Simulation results with step change in wind speed and programmed changes in reactive power reference (second part of figure).

From 0.8 to 0.9 s, the Q g value is changed linearly from -2.055 MVAR (-0.685 p.u.) to 1.584 MVAR (0.528 p.u.), and during this interval the net dc-bus voltage and reactive power are regulated at their reference values, and this operation demonstrates an excellent transient response of the proposed predictive controller. From t = 0.9 s onwards, the Q g value is maintained at 1.584 MVAR (0.528 p.u.). The grid current magnitude, grid current THD, grid power factor, inverter switching frequency and grid apparent power are found to be 511 A, 3.25 %, 0.81 lagging, 784 Hz, and 2.65 MVA, respectively. During all the operating conditions including transient conditions: (a) the dc-link current tracks to its reference, (b) the dc-link capacitor voltages are very well-balanced, (c) the net dc-bus is maintained at its reference value, and (d) reactive power is supplied as requested by the grid operator. 163

The capability of the boost converter in balancing the dc-link capacitor voltages is demonstrated in Fig. 7.7. The rated wind speed condition is used. A resistor, Rx (8.32 p.u.) is connected on purpose across the dc-link capacitor C1 at time t = 1/40 s. The dc-link capacitor voltages are shown in Fig. 7.7(a) and perfect balancing is noticed even with the perturbations in the dc-link. The predictive controller operates with a sampling time of 100 s and the control action has been taken in a few sampling instants. With the proposed controller, no transients are noticed. The current through the parallel resistor is shown in Fig. 7.7(b), and its value is noted as 106 A (0.184 p.u.). As shown in Fig. 7.7(c), the threephase grid currents continue to track to their references even with the parallel resistor. Due to the power dissipated in the resistor Rx (282 kW), the magnitude of the current delivered to the grid is decreased. This test verifies that the proposed three-level boost converter performs very well in controlling the neutral-point voltage.
2.75 2.70 2.65 2.60 2.55

(a) dc-link capacitor voltages, vc1 and vc2 (kV)
120 90 60 30 0

(b) Current through the parallel resistor, Rx (A)
1 0.5 0 -0.5 -1 0 1/120 1/60 1/40 2/60 1/24 3/60

Time (s)

(c) Three-phase grid currents, iag , ibg , icg (kA)

Figure 7.7: Simulation results for capacitor voltages balancing with a resistor across Cdc1 .

164

The comparison between the proposed topology and back-to-back (BTB) connected NPC converters topology equivalent during inverter switching frequency minimization is presented in Figs. 7.8 and 7.9. For these topologies, rated wind speed and zero reactive power condition is considered. The simulation results, with the BTB NPC topology, is presented in Fig. 7.8. In the BTB NPC topology, the grid-tied NPC inverter performs three jobs: (a) control of the net dc-bus voltage, (b) balancing of dc-link capacitors, and (c) reactive power regulation. To derive an equivalent topology for the BTB NPC converters, the control algorithm given in Fig. 7.4 is modified in such a way that the balancing of the dc-link capacitor voltages is achieved by the grid-tied NPC inverter (in addition to the reference current tracking and switching frequency minimization), and the weighting factor dc,b is set to zero. This is also the case with the standard two-level boost converter + NPC inverter based WECS [125,300]. For the balancing of the dc-link capacitor voltages with the help of the NPC inverter, the methodology presented in [279] is used. At time t = 2/60 s, the weighting factor for switching frequency minimization, sw,i is changed from 0 to 5500, and with this the fsw is changed from 1190 to 385 Hz. This can be noticed by looking into the number of switch changes in the inverter line-line voltage waveform [Fig. 7.8(ii)]. With the introduction of switching frequency minimization terms to the cost function, two other variables (balancing of dc-link capacitor voltages and reference tracking) are affected, as seen in Figs. 7.8(i) and (iii). The grid current THD with sw,i = 0 and sw,i = 5500 are 3.16 % and 6.64 %, respectively. The fast Fourier transform (FFT) of phase-a grid current is shown in Fig. 7.8(iv). The harmonics are spread over the whole FFT window with a peak magnitude of 2.5 % of the fundamental component. The simulation results with the proposed topology are shown in Fig. 7.9, where perfect balancing of the dc-link capacitor voltages is achieved, irrespective of the NPC inverter switching frequency minimization. With the change in the weighting factor sw,i from 0 to 5000, the NPC inverter switching frequency is decreased from 1169 to 385 Hz and the grid current THD is increased from 2.63 % to 4.82 %. These values are lower compared to the one obtained by the BTB NPC topology. The peak magnitude of the harmonics is also lower compared to the BTB NPC topology, as shown in Fig. 7.9(iv). The cost function for the NPC inverter of the proposed topology includes only the reference tracking and switching frequency minimization, and thus better performance is achieved in terms of dc-link capacitor voltages balancing and grid current quality. 165

3.0 2.8 2.6 2.4 2.2 2.0 8 4 0 -4 -8 1 0.5 0 -0.5 -1
Mag (% of Fundamental)

(i)

(ii)

0 4 3 2 1 0

1/60

Time (s) (iii) THD = 6.64 %

2/60

3/60

4/60

0

10 20 30 40 50 60 70 80 90 100
Harmonic Order (iv)

Figure 7.8: Simulation results for NPC fsw minimization with BTB NPC converters.
3.0 2.8 2.6 2.4 2.2 2.0 8 4 0 -4 -8 1 0.5 0 -0.5 -1
Mag (% of Fundamental)

(i)

(ii)

0 4 3 2 1 0

1/60

Time (s) (iii) THD = 4.82 %

2/60

3/60

4/60

0

10 20 30 40 50 60 70 80 90 100
Harmonic Order (iv)

Figure 7.9: Simulation results for NPC fsw minimization with proposed topology.

166

7.4

Experimental Implementation and Validation

As shown in Fig. 7.10, a low power prototype of PMSG-WECS using the proposed power converters has been developed. The complete system parameters are indicated in Table 7.2 which are the same simulation parameters except for the generator frequency and stator winding resistance. Two mechanically coupled PMSGs are used. The first PMSG along with the DSP/FPGA controller is used as a prime mover to provide the required speed to the second PMSG. The TLB converter and NPC inverter are controlled by a dSPACE DS1003 rapid prototyping board. The MATLAB/Simulink, Real-Time Workshop and dSPACE Control Desk are used together to handle the control algorithm. The prototype has been built by Semikron SKM75GB123D dual-pack IGBT modules, SKKD75F12 dual-pack diode modules and SKHI22B dual core gate drivers. The inverter is connected to the grid through an isolation transformer and its impedance is added to the filter values.

C

D E

F

G

B

H I K

M

A L

J

(A) keyboard, (B) DSP/FPGA based wind turbine simulator, (C) prime mover, (D) direct-driven PMSG, (E) diode rectifier and three-level boost converter, (F) NPC inverter, (G) interface board, (H) L filter, (I) isolation transformer, (J) three-phase grid, (K) voltage and current sensors, (L) DS1103 R&D controller and CP1103 connector, and (M) Oscilloscopes.

Figure 7.10: Block diagram of the experimental setup.

167

In the experimental verification, the computational delay caused by the digital signal processor is compensated for by calculating the cost functions at (k + 2) instant. The switching states which minimize the cost functions at (k + 2) instant are selected and applied at sampling instant (k + 1). With this approach, one sampling period will be available for calculations. The control algorithms with this approach using delay compensation are shown in Fig. 7.11. The experimental results with the variation in generator speed from 1 to 0.9 p.u. are presented in Fig. 7.12(a), where the response of the system is noted to be similar to the simulation results presented in Figs. 7.5 and 7.6. The grid current, its THD, fsw of boost converter and inverter during (1 p.u.) and (0.9 p.u.) wind speeds are: (9.0 A, 3.84 %, 1550 Hz, 995 Hz) and (6.6 A, 4.73 %, 1150 Hz, 953 Hz), respectively. The fsw is higher than in simulations due to the delay compensation method employed [81, 248]. The reactive power reference tracking capability and good transient response of the proposed controller is demonstrated in Fig. 7.12(b). The grid current, its THD, power factor, fsw of inverter during (-0.685 p.u.) and (0.528 p.u.) Q g are noted as: (9.1 A, 3.38 %, 0.73 leading, 910 Hz) and (8.3 A, 4.52 %, 0.81 lagging, 790 Hz), respectively. The capacitor voltages are well balanced during all the operating conditions in addition to the reference tracking. The effect of the dc-link perturbations on the performance of a three-level boost converter is investigated experimentally and presented in Fig. 7.13. The dc-link capacitor voltages are well balanced by the three-level boost converter, irrespective of the step-connection of 100  resistor (8.32 p.u.). The transient duration is noted to be 5 ms only. The grid currents magnitude is decreased, but they continue to track to their references. The inverter switching frequency minimization and its impact on the dc-link capacitor voltages is experimentally verified with the proposed topology and presented in Fig. 7.14. The experimental weighting factor sw,i is changed from 0 to 1.2, and the (fsw ) and (THD of grid currents) is changed to (1055 Hz to 394 Hz) and (3.11 % to 5.45 %), respectively. As shown in Fig. 7.14, the dc-link capacitor voltages, which are controlled by the boost converter, are not affected by the inverter switching frequency reduction algorithm. The NPC inverter line-line voltage waveform, as demonstrated in Figs. 7.12(a), 7.12(b) and 7.14 contain five levels, whereas a 2L inverter (Fig. 2.4) produces three-levels [84]. The increase in the number of output voltage levels from 3 to 5 leads to smaller voltage 168

References Calculation with MPPT i dc (k + 2) Estimate io1 (k ) io2 (k ) Measurement vc (k ), ig (k ) vin (k ), idc (k )

Apply Sb,op (k ) idc,op (k ) vc,op (k ) Select iop gop = min {gi }i=1...4 iop = i |gop Yes
i4

Estimation at (k + 1) Instant ^ idc (k + 1) v ^c (k + 1)

i=0 gop = 

No
i=i+1

Input Output

Calculation of Cost Function ggen (k + 1)

Prediction at (k + 2) Instant idc (k + 2) vc (k + 2)

(a)
References Calculation i g (k + 2) i g (k + 2) Estimate g (k ), vdg (k ) vg (k ), vg (k ) ig (k ), ig (k ) Measurement vc (k ), vg (k ) ig (k ) Calculation of Cost Function ggrid (k + 1) Output Prediction at (k + 2) Instant ig (k + 2) ig (k + 2) Apply Si,op (k ) v,op (k ) v,op (k ) Select iop gop = min {gi }i=1...27 iop = i |gop Yes
i  27

Estimation at (k + 1) Instant ^ ig (k + 1) ^ ig (k + 1)

i=0 gop = 

No
i=i+1

Input

(b)

Figure 7.11: Proposed predictive control algorithm with delay compensation for: (a) TLB converter, and (b) NPC inverter.

steps and thus lower dv/dt. Moreover, with the NPC inverter, the output current ripple becomes 4 times lower compared to the 2L-inverter for the same device-switching frequency [62]. For a given value of the grid-side filter, this reduction in the current ripple leads to very good power quality. In other words, the 2L inverter requires a large, grid-side filter to achieve a power quality which is comparable to the NPC inverter. Many scholarly works 169

have been presented in recent years focusing on the multilevel operation of the grid-side inverter [60, 80, 81, 123, 128]. A different inverter configuration was proposed such as 5L, 7L and 9L ANPC [60,123], and 5L H-bridge (HB) inverter [128] to achieve smaller voltage steps in the output voltage waveform. Reduction in the grid-side filter size, while improving the grid power quality, represents a common interest in all these works.

m vin ias

m vin vs,ab

ias vs,ab (i) idc idc vc1 vdc (ii) Pg Qg vc2 vc1 vdc (ii) Pg vc2 (i)

vi,ab

Qg

vi,ab

iag (iii)
(a) Programmed change in m from 1.0 to 0.9 p.u.

iag (iii)
(b) Programmed change in Q g

Figure 7.12: Experimental results for programmed changes in m and Q g.

170

vc1

vc2

vdc

iag

Figure 7.13: Experimental results for capacitor voltages balancing with a resistor across Cdc1 .

vc1

vc2

vi,ab

iag sw,i = 0 sw,i = 1.2

Figure 7.14: Experimental results for inverter switching frequency minimization.

The proposed TLB converter has many potential applications and possible extensions to use in MV-WECS. Since the output of the TLB converter directly fits the dc-link capacitors, different inverter configurations can be developed on the grid-side with reduced control complexity. The 5L to 9L ANPCs introduced in [60, 123] have two split dc-link capacitors similar to the NPC inverter. By using these ANPCs in conjunction with the TLB converter, the grid current quality can be improved further (this is true with the predictive control or classical control based on SVM/PWM). 171

7.5

Conclusion

A novel medium voltage power converter topology, consisting of a diode rectifier, threelevel boost converter and neutral-point-clamped inverter is proposed for high power PMSGWECS. The proposed configuration combines the advantages of passive generator-side converters and grid-side multilevel operation. Compared to the BTB-NPC converters, the proposed configuration uses less number of active switches and thus the overall cost and control system complexity is lower. The added benefit of this configuration is that the dc-link capacitor voltages are balanced during all operating conditions by the TLB converter, and thus there is no need to develop a complex control system for the NPC inverter to handle the dc-link capacitor voltages balancing task. A model predictive control strategy is proposed to control the complete wind energy system. Compared to the BTB-NPC converters, with the proposed topology, the number of switching states is decreased from 54 to 31, and thus a lower computational burden has been accomplished. Using the discrete-time model of the system, two individual control loops are developed, and they generate the gating signals to the TLB converter and NPC inverter based on minimization of cost functions. The use of linear controllers and modulation stage are eliminated with the proposed FCS-MPC strategy, and as a result, good dynamic response has been obtained. The MPPT and neutral point voltage are effectively controlled by the TLB converter, while net dc-bus voltage and reactive power are regulated by the NPC inverter. Because of the control freedom for the NPC inverter, a significant improvement in the grid power quality has been achieved. Through the simulation and experimental results, it has been demonstrated that the FCS-MPC strategy performs very well in achieving the control goals for the complete wind energy system.

172

Chapter 8 Predictive Control of Four-Level Converters Based PMSG-WECS
Considering the state-of-the-art wind energy market and its trend towards medium voltage (MV) technology, the initiative of this work is to combine passive generator-side converters with the grid-side multilevel inverters. To meet the future generation of 1-10 kV class (as defined in [82]) PMSG wind turbines, a four-level diode-clamped inverter (4L-DCI) is proposed at the grid-side. Compared with the 3L-DCI, the 4L-DCI offers many benefits as discussed in Chapters 2, 4 and 5. However, the balancing of dc-link capacitor voltages with the 4L-DCI is much more difficult and complicated compared to the 3L-DCI [83, 84]. To overcome this problem, a four-level boost converter (4L-BC) is proposed, with which the balancing of the dc-link capacitor voltages can be achieved during all the operating conditions. In this research, the continuous- and discrete-time modeling of the proposed power conversion system is analyzed. To achieve an optimal control performance, a modified two-step model predictive strategy is proposed. The high power wind turbine requirements, such as maximum energy harvesting, balancing of dc-link capacitor voltages, net dc-bus voltage control, regulation of grid reactive power, and minimization of switching frequency and common-mode voltage are expressed as cost functions. Best switching states are chosen and applied to the power converters during each sampling interval based on the minimization of cost functions. The feasibility of the proposed configuration and control scheme are verified through MATLAB/Simulink tests on a high power (5 MVA/4160 V/694A) system and dSPACE experiments on a low power (3.6 kVA/208 V/10 A) prototype. 173

8.1

Configuration and Modeling of Proposed WECS

The configuration of the proposed variable-speed WECS is shown in Fig. 8.1. The proposed configuration consists of MV-PMSG connected to a low cost three-phase diode bridge rectifier, a dc-dc 4L-boost converter as an intermediate stage, and a 4L-DCI at the grid-side. The output voltage of the diode rectifier changes with respect to the varying wind speed conditions and this represents an unregulated dc-link. A regulated dc-link is used at the inverter terminals to ensure proper operation of the system. The 4L-BC is composed of three active switches and four diodes. The voltage rating of these devices is one third of those used in the standard boost converter, and thus the cost of this 4L-BC is approximately the same as that of a standard boost converter [119]. The 4L-DCI uses 18 active switches and 18 clamping diodes. The active switches can be realized using the MV-IGBT or IGCT. Three capacitors are used in the regulated dc-link, and the total dc-link voltage is divided among these capacitors (vc1 = vc2 = vc3 =
vdc ). 3

The regulated dc-link isolates the 4L-BC

and 4L-DCI, and thus the operation of one converter does not affect the other. As shall be shown in the following subsections, this feature facilitates easier modeling and control.

8.1.1

Continuous-Time Modeling of Four-Level Inverter

The four-level diode-clamped inverter as grid-interfacing unit needs to control the net dcbus voltage and reactive power requested by the grid operator. From the detailed modeling presented for the grid-tied inverter in Chapter 5, the synchronous reference frame (SRF) grid currents are expressed in state-space form as follows:
g d idg Lg = dt iqg -g

-R

g
-Rg Lg Pi

idg + iqg

1 Lg

0
1 Lg Qi

0

vdi + vqi

-1 Lg

0
-1 Lg Ri

0

vdg vqg

(8.1)

where vdi and vqi are SRF inverter voltages and they can be calculated from the three-phase inverter voltages given below:         S1a S2a S3a vaN          vbN  = vc1  S1b  + vc2  S2b  + vc3  S3b  vcN S1c S2c S3c 174

(8.2)

Rdc ,Ldc
P(3)

D1 S1a
+ -

idc ic1
vc1
S1 C1 D2 X(2) S3a
+

S1b S2b S3b

S1c S2c S3c
Rag , Lag

S2a

ias ic2
vin
Cin

vag
Rbg , Lbg

vc2

ibs ics
D3
Y(1)
- -

+

S2 C2

iag ibg
S 1a S 1b S 2b S 3a S 3b

vbg

n

icg
S 1c S 2c

Rcg , Lcg

vcg
+

C3
-

vc3

175
ic3
S3 D4
N(0) Diode Rectifier Unregulated dc-Link 4L Boost Converter Regulated dc-Link

S 2a

S 3c

Turbine + PMSG

4L Diode-Clamped Inverter

L Filter

MV Grid

Figure 8.1: Configuration of proposed high power PMSG wind energy system.

where vc1 , vc2 and vc3 are dc-link capacitor voltages. S1a , S2a , S3a , S1b , S2b , S3b , S1c , S2c , and S3c are the switching signals of 4L-DCI. The common-mode voltage (CMV) can be represented as the voltage between the neutralpoint of the grid (n) and the negative dc-rail (N ) [276, 301]: vnN = vcm = vaN + vbN + vcN . 3 (8.3)

The systems in (8.1), (8.2) and (8.3) depict a situation wherein the grid currents and CMV are related to the switching signals. By properly selecting a switching state among 64, the grid currents can be controlled while minimizing the CMV.

8.1.2

Continuous-Time Modeling of Four-Level Boost Converter

The MPPT can be effectively achieved by controlling the inductor current of the fourlevel boost converter. The dc-link capacitor voltages can also be balanced by the 4L-BC with the proper selection of switching states. To facilitate the controller design, modeling of inductor current and dc-link capacitor voltages is performed in this section. The model of a standard boost converter is presented in [295] for a single-phase power factor correction application. Similar modeling is performed for the 4L-BC, treating an unregulated dc-link as the input voltage source and the four-level inverter as three virtual resistive loads. As demonstrated in Fig. 8.2, the boost converter operates in five modes [119]. In comparison to the standard boost converter, which operates in mode I and V only, the additional modes help in the charging and discharging of each capacitor. The 4L-BC switching states and the corresponding status of active switches, diodes and capacitors are summarized in Table 8.1. The Rdc represents the internal resistance of the inductor Ldc . Table 8.1: Summary of four-level boost converter switching states
Mode I II III IV V S1 ON ON ON OFF OFF S2 ON OFF OFF OFF OFF S3 ON ON OFF ON OFF D1 OFF OFF OFF ON ON D2 OFF ON ON OFF OFF D3 OFF ON OFF ON OFF D4 OFF OFF ON OFF ON C1 Discharge Discharge Discharge Charge Charge C2 Discharge Charge Charge Charge Charge C3 Discharge Discharge Charge Discharge Charge

176

Rdc ,Ldc

D1

Rdc ,Ldc

D1

Rdc ,Ldc

D1

vc1

vc1

S1

C1

Ro1

S1

C1

Ro1

vc1

idc

idc io1 vin
C2 Ro2 S2

idc
S1

C1

Ro1

D2

D2

io1 vin
C2 Ro2 S2

D2

io1
C2 Ro2

vin

vc2

vc2

D3

io2
C3 Ro3 S3

D3

io2
C3 Ro3 S3

D3

vc2 vc3

S2

io2
C3 Ro3

vc3

D4

io3

vc3

S3

D4

io3

D4

io3

(a)
Rdc ,Ldc D1

(b)
Rdc ,Ldc D1

(c)

idc vc1
S1 C1 Ro1 D2

idc vc1
S1 C1 Ro1

io1 vin
C2 Ro2 S2

D2

io1
C2 Ro2

vin

vc2

D3

io2
C3 Ro3 S3

D3

vc2 vc3

S2

io2
C3 Ro3

vc3

S3

D4

io3

D4

io3

(d)

(e)

Figure 8.2: Operating modes for the four-level boost converter: (a) mode-I, (b) mode-II, (c) mode-III, (d) mode-IV, and (e) mode-V.

The operating modes presented in the Fig. 8.2 can be analyzed with Kirchhoff's law and the dynamic equations for the inductor current idc can represented as: Mode-I : Mode-II : Mode-III : Mode-IV : Mode-V : d idc dt d idc dt d idc dt d idc dt d idc dt = = = = = vin - Rdc idc Ldc vin - Rdc idc - vc2 Ldc vin - Rdc idc - vc2 - vc3 Ldc vin - Rdc idc - vc1 - vc2 Ldc vin - Rdc idc - vc1 - vc2 - vc3 . Ldc 177

(8.4)

Similarly, the dc-link capacitor voltage dynamics can be obtained as: Mode-I : Mode-II : Mode-III : Mode-IV : Mode-V : d vc1 dt d vc1 dt d vc1 dt d vc1 dt d vc1 dt = = = = = d vc2 d vc3 0 - io1 0 - io2 0 - io3 , , , = = C1 dt C2 dt C3 0 - io1 idc - io2 0 - io3 d vc2 d vc3 = = , , , C1 dt C2 dt C3 0 - io1 idc - io2 idc - io3 d vc2 d vc3 = = , , , C1 dt C2 dt C3 idc - io1 idc - io2 0 - io3 d vc2 d vc3 = = , , , C1 dt C2 dt C3 d vc2 d vc3 idc - io1 idc - io2 idc - io3 , , . = = C1 dt C2 dt C3

(8.5)

By combining the dynamic equations in (8.4) and (8.5), the continuous-time system describing the inductor current and dc-link capacitor voltages can be obtained as:    Rdc  (1-S1f ) (1-S2f ) (1-S3f )  - Ldc - Ldc - Ldc - Ldc idc idc     (1-S1f )  vc1  d  0 0 0 vc1   C1    = (1-S2f )  v  dt vc2   0 0 0  c2  C2 (1-S3f ) vc3 vc3 0 0 0 C3  
1 Ldc

  0 +  0  0

  0 0 0 vin   1 io1  - C1 0 0      1 0 - C2 0   io2  1 io2 0 0 -C 3
Qb

Pb

(8.6)

where S1f , S2f and S3f are the switching signals applied to the 4L-BC active switches S1 , S2 and S3 , respectively. In deriving the above dynamic system, the inverter is replaced by three virtual resistive loads as shown in the Fig. 8.3. The measurement of output currents, io1 , io2 and io3 is not recommended as it increases the complexity as well as the cost. Rather these variables can be estimated using the measured grid currents and 4L-DCI switching signals. The relation between the output currents and inverter branch currents can be demonstrated as follows with the help of Fig. 8.3: io1 = ip io2 = io1 + ix = ip + ix io3 = io2 + iy = ip + ix + iy . 178 (8.7)

io1
C1
X(2)

Sa == 2 Sa == 1

Sa == 3

P(3)

ip

Ro1

iag
Sb == 3

ix io2

Sa == 0 Sb == 2 Sb == 1

C2
Y(1)

Ro2

ibg
Sb == 0 Sc == 3

iy io3

Sc == 2 Sc == 1

C3
N(0)

Ro3

icg
Sc == 0

in

Figure 8.3: Representation of virtual resistors and the inverter.

The inverter branch currents ip , ix and iy can be estimated based on inverter voltage vector levels Sa , Sb and Sc , and measured grid currents as [108, 281, 302]:         ip Sb == 3 Sc == 3 Sa == 3         ix  = Sa == 2 iag + Sb == 2 ibg + Sc == 2 icg . iy Sa == 1 Sb == 1 Sc == 1

(8.8)

By substituting the Sa , Sb and Sc values given in Table. 5.1, the above expression can be described in terms of 4L-DCI switching signals. This is shown as follows:         S1b S2b S3b S1c S2c S3c ip S1a S2a S3a         ix  =  S 1a S2a S3a  iag + S 1b S2b S3b  ibg + S 1c S2c S3c  icg . iy S 1a S 2a S3a S 1b S 2b S3b S 1c S 2c S3c

(8.9)

As demonstrated in this section, the proposed approach does not require the dynamic model and parameters of the PMSG. Moreover, the PMSG rotor position is also not required. This greatly simplifies the complexity of the control system. From (8.7), it can be understood that the inductor current and dc-link capacitor voltages can be effectively controlled by the optimal selection of switching signals. 179

8.2

Discrete-Time Modeling and Two-Step Prediction

The discrete-time dynamic system for SRF grid currents can be obtained from (8.1) as follows: idg (k + h - 1) vdi (k + h - 1) vdg (k + h - 1) idg (k + h) = + + iqg (k + h) iqg (k + h - 1) vqi (k + h - 1) vqg (k + h - 1) where  = ePi Ts ,  = Pi -1 ( - I2x2 )Qi ,  = Pi -1 ( - I2x2 )Ri . (8.11) (8.10)

In the above systems, h is the prediction horizon and Ts is the controller sampling time. The continuous-time system for the boost converter which is described in (8.6) can also be converted to a discrete-time domain as:       idc (k + h) idc (k + h - 1) vin (k + h - 1) v (k + h) v (k + h - 1)  i (k + h - 1)   c1   c1   o1    =  +   vc2 (k + h) vc2 (k + h - 1)  io2 (k + h - 1)  vc3 (k + h) where  = ePb Ts ,  = Pb -1 ( - I4x4 )Qb . (8.13) vc3 (k + h - 1) io3 (k + h - 1)

(8.12)

The parameter matrix, Pb contains gating signals S1f , S2f and S3f . These signals are set to zero during the off-line discrete-time conversion. As shown in Figs. 8.4(a) and 8.4(b), the prediction of control variables at (k + 1) uses 5 and 64 switching states for the 4L-BC and 4L-DCI, respectively. This is essentially called one-step prediction (h = 1) and this methodology is used in many works [79, 281, 295] to simplify the analysis and digital implementation computations. The works in [253­255] suggest the use of a two-step prediction (h = 2) for an optimal performance. But this leads to a higher computational burden for 4L-BC and 4L-DCI caused by 25 (52 ) and 4096 (642 ) predictions, respectively. To reduce the number of calculations while achieving better performance compared to the one-step prediction, a modified two-step prediction is previously analyzed in [303]. But its feasibility has not been tested by digital implementation. In this paper, the modified two-step prediction is extended for the control of proposed power converters and this concept is shown in Figs. 8.5(a) and 8.5(b). Similar to one-step prediction, 180

this approach uses 5 and 64 switching states for 4L-BC and 4L-DCI, respectively. But the predictions are projected to (k + 2) sampling instant, and with this approach the advantages of lower computations of one-step prediction and optimal performance of two-step prediction can be combined. The discrete-time model for the two-step prediction of grid currents is as follows: idg (k + 1) vdi (k ) vdg (k + 1) idg (k + 2) = + + iqg (k + 2) iqg (k + 1) vqi (k ) vqg (k + 1) (8.14)

where vdg (k +1) and vqg (k +1) are extrapolated [77,258,259] grid voltages. The idg (k +1) and idg (k + 1) are predicted grid currents in (k + 1) sampling instant, and they can be obtained as: idg (k ) vdi (k ) vdg (k ) idg (k + 1) = + + iqg (k + 1) iqg (k ) vqi (k ) vqg (k ) (8.15)

where vdg (k ) and vqg (k ) are measured grid voltages. idg (k ) and iqg (k ) are measured grid currents. By observing (8.14) and (8.15), it can be noticed that the same inverter voltages [vdi (k ), vqi (k )] are used in (k + 1) and (k + 2) prediction of grid currents. Compared to one-step prediction, the number of calculations are higher, but significantly lower compared to the standard two-step prediction. Similarly, the two-step prediction model for the 4L-boost converter can be obtained as:    11 idc (k + 2) 12 [1 - S1f (k )] 13 [1 - S2f (k )] 14 [1 - S3f (k )] v (k + 2)  [1 - S (k )]  22 23 24   21  c1  1f =   vc2 (k + 2) 31 [1 - S2f (k )]  32 33 34  vc3 (k + 2)  41 [1 - S3f (k )]  42 43 44 (8.16)

  vin (k + 1) idc (k + 1)  i (k + 1)  v (k + 1)  o1  c1     +    io2 (k + 1)  vc2 (k + 1) vc3 (k + 1) io3 (k + 1)

where vin (k + 1), io1 (k + 1), io2 (k + 1) and io3 (k + 1) are extrapolated quantities. ij with i = 1, 2, 3, 4 and j = 1, 2, 3, 4 are the elements of the matrix  defined in (8.13). idc (k + 1), vc1 (k + 1), vc2 (k + 1), and vc3 (k + 1) are predicted quantities during (k + 1) sampling instant 181

as:    12 [1 - S1f (k )] 13 [1 - S2f (k )] 14 [1 - S3f (k )] 11 idc (k + 1)  v (k + 1)  [1 - S (k )] 22 23 24   21   c1 1f =    vc2 (k + 1) 31 [1 - S2f (k )] 32 33 34  vc3 (k + 1)  41 [1 - S3f (k )]   vin (k ) idc (k )  i (k )  v (k )  o1   c1   +     io2 (k )  vc2 (k )  vc3 (k ) io3 (k ) 42 43 44 (8.17)

where vin (k ), idc (k ), vc1 (k ), vc2 (k ), and vc3 (k ) are measured variables and io1 (k ), io2 (k ), and io3 (k ) are calculated in terms of grid currents and 4L-DCI gating signals [refer to (8.9)]. Similar to the two-step prediction of 4L-DCI, the (k + 1) and (k + 2) predictions are carried out using the same 4L-BC switching signals [S1f (k ), S2f (k ), and S3f (k )].
Sr
1

Si
1

5 k k+1 k+2 k

64 k+1 k+2

(a) For 4L-boost

(b) For 4L-inverter

Figure 8.4: Prediction of control variables using one-step prediction.

Sr
1

1

Si
1

1

5 k k+1 5 k+2 k

64 k+1 64 k+2

(a) For 4L-boost

(b) For 4L-inverter

Figure 8.5: Prediction of control variables using modified two-step prediction .

182

8.3

Proposed Model Predictive Control Strategy

The proposed control scheme using two-step prediction is shown in Fig. 8.6. As shown in Fig. 8.6, independent control loops are developed for 4L-BC and 4L-DCI and the control objectives are set for both of them. This is further clarified in the following subsections:

8.3.1

Control System for Four-Level Boost Converter

The control system for 4L-BC is depicted in Fig. 8.7(a). The MPPT algorithm provides reference speed to the generator based on varying wind speed conditions. A PI controller
 as follows: generates the input active power reference, Pin   (k ) = (Kp + Ki /S ) [m (k ) - m (k )] Pin

(8.18)

where Kp and Ki are the PI controller proportional and integral gains. By tracking to this reference variable, the MPPT can be achieved in such a way that the generator speed, current and electromagnetic torque can be regulated. This control objective is expressed as the following cost function:
 (k + 2) - Pin (k + 2)]2 gtrack,b(k ) = [Pin  (k + 2) is the extrapolated reference variable. where Pin

(8.19)

The two-step prediction for the input active power is obtained using extrapolated input voltage, vin (k + 2) and a predicted dc-link current, idc (k + 2) (according to [8.16)]. This is depicted as follows: Pin (k + 2) = vin (k + 2) · idc (k + 2). (8.20)

Another important control objective is to balance the dc-link capacitor voltages. This is expressed as follows: gdc,b (k ) = dc,b  [vc1 (k + 2) - vc2 (k + 2)]2 + dc,b  [vc2 (k + 2) - vc3 (k + 2)]2 + dc,b  [vc1 (k + 2) - vc3 (k + 2)]2 where dc,b is the weighting factor used for the capacitor voltages balancing task. (8.21)

183

Diode Rectifier dc-Link C1
- + +

Four-Level Boost Converter

Four-Level Inverter

Filter Rg , Lg

Direct-Driven MV PMSG

MV Grid

idc (k )
+ -

vc1 (k )

iag (k ) vag (k )
-

vin (k )

C2 C3

vc2 (k )
+ -

 m (k )

vc3 (k )

ibg (k )

vbg (k )

icg (k )
Wind Turbine MPPT
 m (k )

vcg (k )
Sr (k) 18 Si (k)

 m (k )
- +
 Pin (k )

3

PI |vc1 - vc2 | + |vc2 - vc3 | + |vc1 - vc3 | = 0

Control System for Four-Level Boost Converter

Control System for Four-Level Diode-Clamped Inverter

 vdc (k )

vw (k )

 Qg (k )

Anemometer

iag (k ) ibg (k ) icg (k )

vc1 (k ) vc2 (k ) vc3 (k ) vin (k ) idc (k )
Si (k)

iag (k ) ibg (k ) icg (k )

vag (k ) vbg (k ) vcg (k )

vc1 (k ) vc2 (k ) vc3 (k )

Figure 8.6: Block diagram of the complete control system.

184

 Pin (k )

 (k + 2) Pin

Extrapolation

|vc1 - vc2 | + |vc2 - vc3 | + |vc1 - vc3 | = 0 idc (k + 2)
Si (k)

Cost Function

ggen (k )
Minimization using (8.23) dc-Link Output Currents Calculation using (8.9) Discrete-Time Model Predictive

Sr (k)

iag (k ) ibg (k ) icg (k )

io1 (k ) io2 (k ) io3 (k )

Controller using (8.16)

vin (k )

vc1 (k ) idc (k ) vc2 (k ) vc3 (k )

vc1 (k + 2) vc2 (k + 2) vc3 (k + 2)

(a) Control system for four-level boost converter

 vdc (k )

i dg (k )
+ -

PI
×

i dg (k + 2)
Extrapolation

vc1 (k ) vc2 (k ) vc3 (k ) vag (k ) vbg (k ) vcg (k ) iag (k ) ibg (k ) icg (k )

i qg (k )
÷

Q g (k )

i qg (k + 2)

Cost Function

-1.5vdg (k )
PLL and abc/dq Transformation

vdg (k ) vqg (k )
Discrete-Time Model Predictive Controller using (8.14)

ggrid (k )
idg (k + 2) iqg (k + 2)
Minimization using (8.27)

Si (k)

idg (k ) iqg (k )

g (k )

vc1 (k ) vc2 (k ) vc3 (k )

(b) Control system for four-level diode-clamped inverter

Figure 8.7: Proposed predictive control scheme for 4L-converter based PMSG-WECS.

The device switching frequency reduction is penalized in the cost function, gswc,b: gswc,b(k ) = swc,b 
x=1,2,3

| Sxf (k ) - Sxf,op (k ) |

(8.22)

where swc,b is the corresponding weighting factor. Sxf,op (k ) is the optimal 4L-BC switching signal in the previous iteration. This switching frequency minimization algorithm anticipates and minimizes the number of switch changes compared to the previous sampling instant. 185

All these control objectives for the 4L-BC are merged into a cost function as: ggen (k ) = gtrack,b(k ) + gdc,b(k ) + gswc,b(k ). (8.23)

The control algorithm for the digital implementation two-step prediction for the 4L-BC is shown in Fig. 8.8(a). The algorithm is initialized by setting the switching state number i to 0 and optimal g value to . At this point, the algorithm enters the loop. The measured quantities and 5 switching states are used in the prediction of (k + 1) instant variables. The predicted variables at (k + 1) instant and the extrapolated quantities are used in the prediction of (k + 2) variables. It is important to note that the number of predictions at (k + 1) and (k + 2) instants are 5 only. The cost function minimization is based on the (k + 2) variables only. The switching state, which produces minimal value of gop is chosen and applied to the 4L-BC gating terminals directly. The current regulators and modulation are eliminated with the proposed approach.

8.3.2

Control System for Four-Level Inverter

The 4L-DCI control system is shown in the Fig. 8.7(b). The two control objectives can be met by forcing the grid currents to track to their references. This is defined as: gtrack,i (k ) = i dg (k + 2) - idg (k + 2)
2

+ i qg (k + 2) - iqg (k + 2)

2

(8.24)

 where i dg (k +2) and iqg (k +2) are the extrapolated reference currents. The two-step prediction

for the grid currents are obtained according to (8.14). The switching frequency reduction objective is expressed as: gswc,i(k ) = swc,i 
x=1, 2, 3 j =a,b,c

| Sxj (k ) - Sxj,op (k ) |

(8.25)

where swc,i is a weighting factor. Sxj,op(k ) is the optimal 4L-DCI switching signal in the previous sampling instant. The common-mode voltage can be minimized by penalizing the following cost function: gcmv,i (k ) = cmv,i  | vcm (k ) | where cmv,i is the weighting factor for CMV minimization. 186 (8.26)

Measurement vc1 (k ), vc2 (k ), vc3 (k ) iag (k ), ibg (k ), icg (k ) vin (k ), idc (k ) Estimate io1 (k ), io2 (k ), io2 (k ) io1 (k + 1), io2 (k + 1), io2 (k + 1) vin (k + 1), vin (k + 2)  Pin (k + 2) i=0 gop = 
i=i+1

Measurement vc1 (k ), vc2 (k ), vc3 (k ) iag (k ), ibg (k ), icg (k ) vag (k ), vbg (k ), vcg (k ) Estimate g (k ), vdg (k ), vqg (k ) idg (k ), iqg (k ) vdg (k + 1), vqg (k + 1)  i dg (k + 2), iqg (k + 2) i=0 gop = 
i=i+1

Prediction of (k + 1) Variables idc (k + 1), vc1 (k + 1), vc2 (k + 1), vc3 (k + 1) using (8.17) Prediction of (k + 2) Variables idc (k + 2), vc1 (k + 2), vc2 (k + 2), vc3 (k + 2) using (8.16) Minimization of Cost Function, ggen (k ) using (8.23) Yes

Prediction of (k + 1) Variables idg (k + 1), iqg (k + 1) using (8.15) Prediction of (k + 2) Variables idg (k + 2), iqg (k + 2) using (8.14) Minimization of Cost Function, ggrid (k ) using (8.27) Yes

i5 No gop

i  64 No gop

Select iop = min {gi }i=1...5 iop = i |gop

Select iop = min {gi }i=1...64 iop = i |gop

Generate Optimal Gating Signals S1f , S2f , S3f and Apply to the 4L-BC

Generate Optimal Gating Signals S1a , S2a , S3a , S1b , S2b , S3b , S1c , S2c , S3c and Apply to the 4L-DCI

(a)

(b)

Figure 8.8: Proposed two-step predictive control algorithm for: (a) four-level boost converter, and (b) four-level diode-clamped inverter.

187

The final cost function for the 4L-DCI is defined as: ggrid (k ) = gtrack,i (k ) + gswc,i(k ) + gcmv,i (k ). (8.27)

The control algorithm for the 4L-DCI is shown in Fig. 8.8(b) and it is similar to the boost converter's algorithm in terms of the implementation. During each iteration, the future behavior of the control variables are predicted using the 64 switching states. The switching state (among 64) which minimizes the cost function ggrid (k ) is chosen and applied to the 4L-DCI. The linear regulators (PI) are eliminated in the internal current control loops and there is no need to design the pulse width or space vector modulation. Table 8.2: Parameters of the proposed power conversion system
Variable PT TT NT Rgb rT  Cp,op T,op Pm vsl vs is fs P Fs nm PP Tm r Rs Ld Lq J Sg vgl vg ig fg Zbg Lbg Cbg Cin Cdc Rdc Ldc Rg Lg Ts dc,b  vdc Simulation Experimental Description SI p.u. SI p.u. Rated Power (kW) 5000 1.0 3.6 1.0 Rated Torque (kN.m) 318.31 1.0 0.2292 1.0 Rated Speed (rpm) 150 1.0 150 1.0 Gear Ratio 1 1 Rotor Radius (m) 55.97 ­ Air Density (kg.m2 ) 1.225 ­ Optimal Power Coefficient 0.48 ­ Optimal Tip Speed Ratio 73.267 ­ Permanent Magnet Synchronous Generator Parameters Rated Mechanical Power (kW) 5000 3.6 Rated Line-Line Voltage (V) 4160 208 Rated Phase Voltage (V) 2402 1.0 120 1.0 Rated Stator Current (A) 700 1.0 10 1.0 Rated Stator Frequency (Hz) 20 1.0 20 1.0 Rated Power Factor 0.98 0.98 Rated Rotor Speed (rpm) 150 1.0 150 1.0 Number of Pole Pairs 8 8 Rated Mechanical Torque (kN.m) 318.31 1.0 0.2292 1.0 Rated rms Rotor Flux Linkage (Wb) 18.92 1.0 0.956 1.0 Stator Winding Resistance (m) 34.4 0.013 245 0.021 d-axis Synchronous Inductance (mH) 5.475 0.2 19.1 0.2 q -axis Synchronous Inductance (mH) 5.475 0.2 19.1 0.2 Moment of Inertia (kg.m2 ) 237.93 Medium Voltage Grid Parameters Rated Apparent Power (kVA) 5000 1.0 3.6 1.0 Rated Line-Line Voltage (V) 4160 208 Rated Phase Voltage (V) 2402 1.0 120 1.0 Rated Stator Current (A) 694 1.0 10 1.0 Rated Stator Frequency (Hz) 60 1.0 60 1.0 Base Impedance () 3.46 1.0 12.018 1.0 Base Inductance (mH) 9.18 1.0 31.88 1.0 Base Capacitance (F) 766.39 1.0 220.72 1.0 Power Electronic Converter Parameters Input Capacitance (F) 8300 10.87 2400 10.87 Output dc-link Capacitance (F) 3500 4.53 1000 4.53 Boost Filter Leakage Resistance () 0.04 0.01 0.12 0.01 Boost Filter Inductance (mH) 2.9 0.314 10 0.314 Grid-side Filter Resistance () 0.031 0.009 0.108 0.009 Grid-side Filter Inductance (mH) 1.9 0.207 6.6 0.207 Controller Parameters Sampling Time (s) 100  100  Weighting Factor 100 2 Reference dc-link Voltage (V) 7354 3.062 367 3.062

188

8.4

Simulation Results

Various tests were carried out using MATLAB/Simulink software to effectively demonstrate the advantages of proposed topology and control strategy. The parameters of the high power (5 MW/4160 V/694 A) PMSG power conversion system are shown in Table 8.2. The one-step prediction strategy is shown in Fig. 8.4 and it implies the ideal case where the time taken for the computations is zero. This means that the switching state, which minimizes the error at the (k + 1) instant, is selected and applied at the k th instant. But in the real-systems, zero computation time can never be achieved. All the digital signal processor platforms require some computational time. To effectively compare the one-step and twostep methods, treat real-time scenario, and better correlate the simulation and experimental results, the digital signal processor control delay is included in the simulation models. The computational delay is set to one sampling period Ts .

8.4.1

Steady-state Analysis

The steady-state analysis is carried out at rated wind speed condition, vw = 12 m/s, and presented in Fig. 8.9. Without the control delay, using one-step prediction, the 4L-BC and 4L-DCI switching frequencies are found to be 806 and 910 Hz, respectively. The grid current reference tracking error, eig and total harmonic distortion (THD) are found to be 1.1 % and 1.95 %, respectively. The fsw , eig and THD are calculated according to the guidelines given in Appendix C. In the presence of the control delay, the performance of the one-step predictive control algorithm deteriorates. To overcome this challenge, a modified one-step prediction is developed using the guidelines given in [248, 249]. With this approach, the best switching state in the previous iteration is used to estimate the control variables at (k + 1) instant. The prediction of (k +2) variables is carried out using all the switching states of power converters. The switching state, which minimizes the error at (k + 2) instant, is selected and applied. The simulation results with the modified one-step prediction and proposed method are presented in Figs. 8.9(a) and 8.9(b), respectively and they can compensate the control delay. With one-step prediction, the number of calculations are increased due to the estimation (not prediction) of (k + 1) variables. For this reason, the fsw for 4L-BC and 4L-DCI are increased to 980 and 1350 Hz, respectively. To make a fair comparison with the proposed method, 189

the fsw for 4L-BC and 4L-DCI are decreased to 420 and 580 Hz by using weighting factors swc,b = 3 and swc,i = 20, respectively. As shown in Fig. 8.9(a), the boost converter input power Pin contains a large ripple mainly caused by the inductor current. This high ripple is not a problem because the inductor current is filtered by the dc-link capacitors. The dc-link capacitor voltages are balanced, but present a higher steady-state error. The inverter lineline voltage waveform contains high dv /dt's and this is reflected to grid currents as higher tracking error and THD. The simulation results with the modified two-step prediction are presented in Fig. 8.9(b). The fsw and CMV minimization is not considered in the two-step prediction test and thus swc,b = swc,i = cmv,i = 0. Even without employing any switching frequency reduction algorithm, the fsw is noted as 408 and 565 Hz for 4L-BC and 4L-DCI, respectively. It is important to note that no delay compensation is needed with the proposed modified two-step prediction. As shown in Fig. 8.9(b) (i), the Pin contains less ripple and this indicates the use of a lower rated dc-link capacitive filter compared to the modified one-step prediction. The dc-link capacitor voltages are perfectly balanced and this improves the reliability of the semiconductor switches. The inverter voltage waveform contains less dv /dt's. The grid currents track to their references with a lower steady-state error of 1.8 % in comparison to the 2.95 % for modified one-step prediction. The grid current THD is found to be 3.29 % which is lower compared to the modified one-step prediction value of 5.05 %. These results validate that by using the proposed strategy, an optimal control performance can be obtained in the complex systems which involve a large number of computations.

8.4.2

Harmonic Analysis

The harmonic analysis and comparison between the modified one-step and proposed method is presented in Fig. 8.10. The fast fourier transform (FFT) of inverter line-line voltage (vi,ab ) and phase-a grid current are analyzed. In comparison to the PWM and SVM methods, which produce harmonics around the carrier frequency and its multiples, the predictive control method produces harmonics spread over the whole FFT window [262,279]. The proposed method produces low THD values for vi,ab and iag in comparison to the onestep prediction. The reason is that the peak amplitude of the harmonics is lower compared to the one-step prediction. The results validate that the proposed method is most suitable for high power applications, where power quality is a major concern. 190

8 6 4 2 0 3.0 2.75 2.50 2.25 2.0 8 4 0 -4 -8 1.5 1.0 0.5 0 -0.5 -1.0 -1.5 0

 (i) Pin and its reference (Pin ) (MW)

 (i) Pin and its reference (Pin ) (MW)

vc1

vc2 vc3

vc1

vc2 vc3

(ii) dc-link capacitor voltages (kV)

(ii) dc-link capacitor voltages (kV)

(iii) 4L-DCI line-line voltage, vi,ab (kV)

(iii) 4L-DCI line-line voltage, vi,ab (kV)

iag i ag
1/60 2/60 3/60 4/60 0 1/60

iag i ag
2/60 3/60 4/60

Time (s) (iv) Phase-a grid current (iag ) and its reference (i ag ) (kA)

Time (s) (iv) Phase-a grid current (iag ) and its reference (i ag ) (kA)

(a) Modified one-step prediction

(b) Proposed two-step prediction

Figure 8.9: Comparison of simulation results during rated wind speed condition using two different prediction methods.

Mag (% of Fund.)

20 15 10 5 0 5 4 3 2 1 0 0 20 40 THD = 5.05 % THD = 3.29 % THD = 26.47 % THD = 17.32 %

FFT of vi,ab FFT of iag

Mag (% of Fund.)

60 80 100 120 140 160 180 200 Harmonic Order

0

20

40

60 80 100 120 140 160 180 200 Harmonic Order

(a) Modified one-step prediction

(b) Proposed two-step prediction

Figure 8.10: Simulation FFT analysis of inverter line-line voltage and grid currents using two different prediction methods.

191

8.4.3

Switching Frequency Minimization

The simulation results for the fsw minimization of 4L-DCI and its impact on the grid current quality and capacitor voltages is analyzed and presented in Fig. 8.11. From t = 0 to 2/60 s, no penalty is applied for the switching frequency reduction and thus swc,i = 0. During this condition, the fsw , grid current reference tracking error eig , and grid current THD are 565 Hz, 1.8 % and 3.29 %, respectively. The capacitor voltages are well balanced by the 4L-BC. At t = 2/60 s, the weighting factor, swc,i is changed to 50, and the fsw is decreased to 364 Hz, but with an increase in the reference tracking error (2.4 %) and current THD (4.55 %). The inverter phase voltage waveform vaN clearly shows the reduced number of switch changes. The swc,i is changed to 4000 at t = 4/60 s, and the switching frequency is further minimized to 161 Hz. The eig , and THD are 3.1 % and 5.83 %, respectively. Even though the fsw is significantly decreased from 565 to 161 Hz, the grid current THD is marginally increased. The reason is that the 4L-DCI does not control the capacitor voltages, and thus it has a control freedom in choosing the best switching state which will generate lower current tracking error and switching frequency. This is one of the best features of the proposed power conversion system. The 4L-BC switching frequency can also be minimized by including swc,b in the cost function, ggen . By increasing swc,b from 0 to 5, the boost converter switching frequency is minimized from 408 to 360 Hz, but with a slight increase in the Pin tracking error and capacitor voltages balancing error.

8.4.4

Common-Mode Voltage Minimization

The CMV can be minimized by imposing a weighting factor cmv,i to the cost function ggrid and this is demonstrated in Fig. 8.12. The rated wind speed condition is considered in this test. The swc,i is set to zero to clearly show the effectiveness of the CMV minimization algorithm. At t = 3/60 s, the cmv,i is changed from 0 to 10 and the CMV is dramatically decreased as shown in Fig. 8.12(a). But, the grid current tracking error increases from 1.8 % to 3.2 %, and also the THD increases from 3.29 % to 4.89 %. The capacitor voltages are well balanced by the 4L-BC, but they contain a higher ripple to the increased grid current THD. This test verifies that CMV in 4L-DCI can be minimized to a certain level without using any additional hardware circuitry such as common-mode choke.

192

swc,i = 0
10 7.5 5.0 2 .5 0 1.5 1 .0 0.5 0 -0.5 -1.0 -1.5 3.0 2.75 2.5 2.25 2 .0 0 1/60 2/60

swc,i = 50

swc,i = 4000

(a) Inverter phase-a voltage, vaN (kV)

iag i ag
(b) Phase-a grid current (iag ) and its reference (i ag ) (kA)

vc1

vc2

vc3
3/60 4/60 5/60 6/60

Time (s) (c) dc-link capacitor voltages (kV)

Figure 8.11: Simulation results for grid-tied inverter switching frequency minimization.
cmv,i = 0
7.5 5 .0 2.5 0 1 .5 1 .0 0.5 0 -0.5 -1.0 -1.5 3.0 2.75 2 .5 2.25 2.0 0 1/60 2/60 3/60 4/60 5/60 6/60

cmv,i = 10

(a) Common mode voltage (kV)

iag i ag
(b) Phase-a grid current (iag ) and its reference (i ag ) (kA)

vc1

vc2

vc3
Time (s) (c) dc-link capacitor voltages (kV)

Figure 8.12: Simulation results for grid-tied inverter common-mode voltage minimization.

193

8.4.5

DC-link Perturbations

The effectiveness of the four-level boost converter and predictive control algorithm are analyzed in this section. Rated wind speed condition is considered in this test. The switching frequency and CMV minimization are not considered to clearly describe the dc-link capacitor voltages balancing. A perturbation is created on purpose by connecting an external capacitor Cext across the dc-link capacitor-2. In real systems, in order to achieve rated capacitance and voltage rating, the dc-link capacitors are connected as series-parallel strings. The perturbation assumed here resembles the faulty condition in one of the dc-link parallel strings. The simulation results with such faulty condition are shown in Fig. 8.13. The Cext rating is assumed to be same as of Cdc (4.53 p.u.).

Cext is OFF
4 3 2 1 2 1 0 -1 1.5 1.0 0.5 0 -0.5 -1.0 -1.5 10 5 0 -5 -10 0 2/60 4/60

Cext is ON

vc1 vc2

vc3

(a) dc-link capacitor voltages (kV)

(b) Current through the external capacitor, Cext (kA)

iag

i ag
(c) Phase-a grid current (iag ) and its reference (i ag ) (kA)

6/60

8/60

10/60

Time (s) (d) 4L-DCI line-line voltage, vi,ab (kV)

Figure 8.13: Simulation results with step-connection of capacitor Cext across Cdc2 .

194

With the step-connection of Cext at t = 2/60 s, the vc2 suddenly drops due to the large current flowing through the Cext [Fig. 8.13(b)]. But the predictive control algorithm selects appropriate switching states to make the capacitor voltages balanced, and as a consequence the vc2 reaches the voltage level of vc1 and vc3 in a quarter of a fundamental cycle.
 The net dc-bus voltage vdc deviates from its reference vdc due to the faulty condition

and also due to an imbalance in the capacitor voltages. At t = 8/60 s, the vdc recovers back to its reference value with the help of a dc-link PI controller. The capacitor voltages are maintained as balanced even during this transient period (2/60 to 8/60 s). From this operating condition, it can be concluded that the proposed control strategy is robust, and can mitigate the perturbations in the dc-link. Moreover, the reference tracking algorithm is not affected by this faulty condition. The grid currents continue to track to their references as shown in Fig. 8.13(c). As demonstrated in Fig. 8.13(d), during a transient condition, a three-level waveform is noticed due to the divergence of vdc from its reference. But at t = 8/60 s, normal operation is restored.

8.4.6

Step-Change in Wind Speed Condition

The dynamic response of the system to a step-change in wind speed is investigated in this section. It is assumed that the system is operating at rated condition until t = 1.0 s. The fsw and CMV minimization terms are not included in the cost functions. As shown in Fig. 8.14, until t = 1.0 s, the system operates in steady-state, and rated power is delivered to the grid. All the control variables are maintained at the reference values. The mechanical system of the wind turbine is much slower compared to the electrical system, and to better represent the results, a very low moment of inertia (J = 16.381 kg.m2 which is 14.5 times lower than the original value) is used in the simulations, but this will not affect the system performance [2]. At t = 1.25 s, a step change in wind speed is applied from 12 m/s (1.0 p.u.) to 9.6 m/s (0.8 p.u.). Due to the sudden decrease in the wind speed, the MPPT algorithm produces a
 new speed reference (m = T,op rT

· vw ) of 12.57 rad/s. This step change in wind speed sets a

new electromagnetic torque reference, Te , but the Te is maintained at its current value to allow the PMSG to decelerate. When the PMSG speed m reaches its reference value, the Te starts to build up and reaches its new reference value. The electromagnetic torque contains higher torque ripple due to the significant 5th and 7th harmonics in the PMSG currents. 195

 m = 1.0 p.u.

 m = 0.8 p.u.

20 15 10
 m

m

(a) PMSG mechanical speed and its reference (rad/s)
0 -0.25 -0.5 8 0 -8 8 4 0
 Pin

Te Te

(b) PMSG electromagnetic torque and its reference (MN.m)

ias × 3 vs,ab
(c) PMSG line-line voltage (kV) and phase current (kA)
Pin

(d) 4L-boost converter input power and its reference (MW)
9.0 7 .5 6.0

vdc

 vdc

(e) Net dc-link voltage and its reference (kV)
3.0 2 .5 2.0

vc1

vc2

vc3

(f) dc-link capacitor voltages (kV)
8 4 0

(g) Grid active power, Pg (MW)
1.5 0 -1.5 1.00 1.25 1.50 1.75 2.00 2.25 2.50

Time (s)

(h) Grid phase-a current, iag (kA)

Figure 8.14: Simulation results with step change in wind speed from 12 m/s to 9.6 m/s.

196

These higher harmonics are caused by the diode-bridge rectifier. This is the only disadvantage of using diode-rectifiers for the PMSG turbines. Due to the decoupled nature of the power converters, these harmonics are not reflected to the grid and thus they do not cause any conflict to the grid codes. During the time interval 1.25-1.6 s, where the PMSG decelerates to a new reference value, the PMSG line current ias , line-line voltage vs,ab , boost converter input power Pin , grid power Pg and grid currents decrease at a slow rate. When the PMSG speed reaches new reference value, the Pin and Pg settle to a new steady-state value. During this interval, the net dc-bus voltage deviates from its reference value, but the dc-link capacitor voltages are well balanced by the boost converter. The system reaches a new steady-state at t = 2.25 s and all the control variables are maintained at the new steady-state operating condition.

8.4.7

Step-Changes in Grid Reactive Power Reference

The grid codes [17] indicate that the wind turbine system should support the grid reactive power when ever requested by the grid operator. The ability of the proposed system to supply unity power factor (UPF), leading power factor and lagging power factor is studied in this section. The simulation results with the step change in grid reactive power reference is shown in Fig. 8.15. The wind speed is considered to be 9.6 m/s (0.8 p.u.), and the active power generated is approximately 2.56 MW (0.83 p.u.). The fsw and CMV minimization is not considered. A step change in Q g is applied from 0 to -3.075 MVAR (-0.615 p.u.) at t = 1/60 s changing the grid power factor from UPF to leading. The grid current leads the grid voltage as shown in Fig. 8.15(b). At t = 3/60 s, another step change in Q g is applied from -3.075 MVAR (-0.615 p.u.) to 3.075 MVAR (0.615 p.u.). The grid power is changed from leading to the lagging and the grid current lags the grid voltage [Fig. 8.15(b)]. An excellent dynamic response is noticed for the grid reactive power and currents tracking. During all the operating conditions, the capacitor voltages are well balanced by the boost converter.

197

Unity PF
6 3 0 -3 -6

Leading PF

Lagging PF

Unity PF

Qg

Q g

(a) Grid reactive power and its reference (MVAR)
1.5 1.0 0.5 0 -0.5 -1.0 -1.5
vag 3

iag

i ag
(b) Phase-a grid voltage (kV) and current (kA)

8 4 0 -4 -8

(c) 4L-DCI line-line voltage, vi,ab (kV)
3.0 2.75 2.5 2.25 2.0 0 1/60 2/60 3/60

vc1

vc2

vc3
4/60 5/60 6/60

Time (s) (d) dc-link capacitor voltages (kV)

Figure 8.15: Simulation results with step-changes in grid reactive power reference.

198

8.5
8.5.1

Experimental Implementation
Experimental Platform

As shown in Fig. 8.16, a low power (3.6 kW/208 V/10 A) prototype of PMSG-WECS using the proposed power conversion system is developed. The parameters of the system are given in Table 8.2. Two mechanically coupled PMSGs are used, where initially the PMSG, along with the DSP/FPGA controller, is used as a prime mover to provide the required torque to the second PMSG. The 4L-BC and 4L-DCI are controlled by a dSPACE DS1003 R&D controller. The control algorithm has been implemented using a host PC running with MATLAB-Simulink software through Real-Time Interface (RTI). The required current and voltage measurements are made by LEM LA55-P and LV25-P sensors, respectively, and sent to the controller through a CP1103 I/O connector. The prototype has been built by Semikron SKM75GB123D dualpack IGBT modules, SKKD75F12 dual-pack diode modules and SKHI22B dual core gate drivers. The inverter is connected to the grid through an isolation transformer and its impedance is added to the filter values.

8.5.2

Experimental Results

The experimental comparison between one-step prediction and proposed method is presented in Fig. 8.17. With a one-step prediction, and without any fsw minimization algorithm, the switching frequencies for 4L-BC and 4L-DCI are found to 993 and 1380 Hz, respectively. By using a weighting factor of swc,b = 0.5, the fsw for the 4L-boost converter is decreased to 465 Hz. The fsw of 4L-DCI is decreased to 595 Hz by using a swc,i = 1.2. The switching frequencies with the proposed method are noted as 482 and 583 Hz for the 4L-BC and 4L-DCI, respectively. Similar to the simulation results, the proposed method clearly shows better performance compared to the modified one-step prediction. The Pin contains lower ripple, the capacitor voltages are well balanced, and lower dv /dt's are obtained in the inverter waveform compared to the one-step prediction. The peak magnitude of the harmonics is also lower with the proposed method. The eig and THD with the one-step prediction are: 3.8 % and 6.2 %, where, for the proposed method they represent: 2.9 % and 4.35 %, respectively. The tracking 199

error and THD with the proposed method are higher compared to the simulations due to the delay offered by the current and voltage transducers, dead-time of gate drivers, and losses in the system. These results confirm that the proposed method gives an optimal performance compared to the one-step prediction. Through these results, it has been demonstrated that the current digital platforms can handle the computational capacity of the proposed method. Having the one-step predictive model of the system, the proposed method can be easily extended to any complex system to achieve optimal performance with good quality of the control variables.

A1

B4

C2 B5 C1 C2 B3

B5 B1 B2 A2

B4

C2

(a) Wind Turbine Simulator

(b) Four-Level Boost Converter

(c) 4L-Inverter

D4 D1 D2

D5

D7 D3 D6 D8 D9

D10

(A1) DSP/FPGA controller, (A2) key board, (B1) three-phase diode-rectifier, (B2) input capacitor, (B3) dc inductor, (B4) semiconductor switches, (B5) IGBT gate drivers, (C1) interface board, (C2) dc-link capacitors, (D1) prime mover, (D2) non-salient pole PMSG, (D3) isolation transformer, (D4) three-phase grid, (D5) power converters, (D6) grid-side filters, (D7) voltage and current transducers, (D8) DS1103 R&D controller, (D9) measurement system, and (D10) MATLAB/Simulink and control desk.

(d) Complete Experimental Platform

Figure 8.16: Photographs of the experimental setup.

200

 Pin

Pin i ag

 Pin

Pin i ag

FFT of iag

iag

FFT of iag

iag

(i)

(i)

vc1

vc2

vc3

vc1

vc2

vc3

vi,ab FFT of vi,ab FFT of vi,ab

vi,ab

(ii)
(a) Modified one-step prediction

(ii)
(b) Proposed two-step prediction

Figure 8.17: Comparison of experimental results during rated wind speed condition.
swc,i = 0 swc,i = 0.05 swc,i = 2.0 swc,i = 0 swc,i = 0.05 swc,i = 2.0

vaN

vc1 i ag

vc2

vc3

iag (a) (b)

Figure 8.18: Experimental results for grid-tied inverter switching frequency minimization.

201

The switching frequency minimization algorithm is experimentally tested and presented in Fig. 8.18. The weighting factor swc,i is changed in the order of: 0, 0.05 and 2. The switching frequencies are minimized in the order of: 583, 375, 146 Hz; eig is increased in the order of: 2.9 %, 3.7 %, 4.8 %; and THD is increased in the order of: 4.35 %, 5.86 %, 6.72 %. This switching frequency minimization is achieved without any software or hardware reconfiguration. As explained in the simulation results section, the dc-link capacitor voltages are not balanced by the 4L-DCI. This gives fewer numbers of restrictions in the selection of the best switching state. As a result, the power quality is maintained at an acceptable level while minimizing the device switching frequency. This test clearly exhibits that the proposed power conversion system and control strategy is most suitable for megawatt-level applications, where a lower switching frequency operation and high power quality are mandatory. The CMV minimization is experimentally evaluated and its impact on the grid currents is studied. As shown in Fig. 8.19, with the increase of weighting factor cmv,i from 0 to 0.0008, the CMV is drastically decreased, but, with little increase in the grid currents reference tracking error (2.9 % to 4.3 %) and THD (4.35 % to 5.63 %). The capacitor voltages are not affected by this CMV minimization algorithm. These experimental results validate the proposed CMV minimization algorithm. This test verifies that the CMV can be minimized to a certain level with the penalization of cost function. This leads to the lower rating and thus lower cost for the external hardware used for the CMV minimization. The experimental study of the dc-link capacitor voltages balancing algorithm with the faulty dc-link is carried out as shown in Fig. 8.20. The external capacitor Cext is deliberately connected across the dc-link capacitor-2 to resemble the faulty condition. The Cext value is the same as that of Cdc . The voltage vc2 dropped with the step connection, and recovers back to the voltage level of vc1 and vc3 . This operation is similar to the simulation results presented in Fig. 8.13. A fast recovery time of 12 ms is noticed. Even during the transient period, where the net dc-bus voltage recovers back to its reference value, the dc-link capacitor voltages are well balanced. Similar to the simulations, the grid currents effectively track to their references even with the faulty dc-link. A robust performance is obtained for the capacitor voltages balancing, and this test validates the simulation results.

202

cmv,i = 0

cmv,i = 0.0008

cmv,i = 0

cmv,i = 0.0008

vcmv

vc1 i ag iag (a)

vc2

vc3

(b)

Figure 8.19: Experimental results for grid-tied inverter common-mode voltage minimization.
Cext is OFF Cext is ON

ic,ext

i ag

iag (a)

vc1 vc2 vi,ab

vc3

(b)

Figure 8.20: Experimental results with step-connection of capacitor Cext across Cdc2 .

203

 m = 1.0 p.u.

 m = 0.8 p.u.

m
 m

vas

ias (a)

 Pin

Pin vdc Pg

(b)

vc1 i ag

vc2

vc3

(c)
 Figure 8.21: Experimental results with step change in m from 1.0 to 0.8 p.u..

The experimental dynamic response of the system for a step-change in PMSG speed reference is investigated and presented in Fig. 8.21. The moment of inertia for the PMSG used in the experimental tests is very low compared to the simulations. Due to this, the transient duration is lower compared to the simulations. The time duration of the simulation and experimental tests is 1.5 and 1.0 s, respectively. The reference speed command is directly given by the user. A step change in the speed reference from 1.0 to 0.8 p.u. is provided from the control desk. A similar dynamic response is observed in the experimental test. The control variables shifted their steady-state operation from 1.0 to 0.8 p.u.. The dc-link capacitor voltages are well balanced even during the transient condition. 204

The experimental results with the step changes in the Q g is presented in Fig. 8.22. The fsw and CMV minimization is not considered. The mechanical speed of the PMSG is maintained at 0.8 p.u. which produces 0.512 p.u. active power. The Q g pattern is similar to the simulation results presented in Fig. 8.15. Also similar to the simulation results, the grid reactive power and currents are tracked to their reference with an excellent dynamic response and no overshoots. The capacitor voltages are well-balanced by the boost converter during all the reactive power conditions. A slight error between the Q g and Qg results because of the losses in the system. This test verifies that the proposed power converters and control scheme can be used in high power wind turbines to meet the grid code requirements.

Unity PF

Leading PF

Lagging PF

Unity PF

Qg Q g vag

iag (a)

vc1

vc2 vi,ab

vc3

(b)

Figure 8.22: Experimental results with step-changes in grid reactive power reference.

205

8.6

Conclusion

In this chapter, a novel medium voltage power conversion system consisting of diode rectifier, four-level boost converter and four-level diode-clamped inverter is proposed for megawatt-level PMSG wind turbines. The proposed topology combines the advantages of low cost passive generator-side converters and efficient grid-side multilevel operation. The four-level boost converter ensures the balancing of the dc-link capacitor voltages during all the operating conditions. Since the capacitor voltages are balanced by the boost converter, the grid-tied four-level inverter has a control freedom in choosing a best switching state. With this feature, a significant improvement in the grid power quality has been achieved, even with the lower switching frequency operation. The proposed algorithm can also mitigate the perturbations in the dc-link. A good dynamic and robust response is achieved for capacitor voltages balancing during all operating conditions. A two-step model predictive strategy is proposed and an optimal performance is obtained compared to the one-step prediction. The results also indicate that the current digital signal processors can handle the computational requirement of the proposed two-step prediction. All the control goals are well achieved by minimizing the cost functions during each sampling interval. The proposed methodology appears as a promising tool to control high power converters where the power quality is a major concern. In order to comply with the high power application, the device switching frequencies and common-mode voltages are minimized without involving any external hardware.

206

Chapter 9 Predictive Control for Low Voltage Ride-Through Enhancement of Three-Level Converter Based WECS
As discussed in Chapter 1, among all the grid codes, the low voltage ride-through (LVRT), also called as fault ride-through, is the major concern for the wind turbine/power converter manufacturers [12­14]. According to LVRT requirements, during grid faults, the wind energy conversion system (WECS) should remain connected to the grid regardless of the turbine/generator/converter configuration being used, and must supply reactive power to help the grid to recover from the voltage dip. In this chapter, a predictive control scheme is proposed for the LVRT enhancement of direct-driven permanent magnet synchronous generator (PMSG)-based megawatt-level wind turbine. The proposed method uses the turbine-generator rotor inertia to store the surplus energy during the grid voltage dips. The power conversion system is realized using the three-level configuration introduced in Chapter 7. The wind turbine requirements, such as maximum power point tracking, net dc-bus voltage control, balancing of the dc-link capacitor voltages, and reactive power generation, are modeled as the reference control variables. During each sampling interval, these control goals are achieved based on the minimization of generator- and grid-side cost functions. The coordination of generator- and grid-side converters and the exchange of references during normal and LVRT operation is formulated such that the net dc-bus voltage is maintained constant (so as to protect the power converters) while meeting the grid code requirements. Simulation and experimental results are presented to validate the proposed strategy. 207

9.1

State-of-the-art LVRT Enhancement Methods

Many methods are proposed in literature for the LVRT enhancement of PMSG wind turbines such as [18, 304]: pitch control system, over sizing of dc-link capacitors, dissipation of surplus energy in dc-link crowbar (resistor), storage of surplus energy in the battery banks and fly-wheel systems, use of power quality conditioning devices, and relevant control of power electronic converters. The latter concept has found increased acceptance by industry and academia [52, 67, 293]. Owing to the large moment of inertia, the mechanical system response of the MW direct-driven wind turbines is much slower compared to the electrical system response [2]. Using this feature, the surplus energy can be stored in the mechanical system inertia during the grid voltage dips [67, 293, 305, 306]. This attractive solution, combined with the converter control, is previously analyzed using back-to-back (BTB) connected NPC converters [67] and current source converters [293, 305]. The same concept is studied in [306] for a standard boost converter-based WECS. However, its feasibility is not proved experimentally. The previously analyzed converter control solutions [67,72,293,305,306] are based on the classical approach of using cascaded linear regulators and pulse width/ space vector modulation. The predictive control approach for the LVRT enhancement of the grid-tied NPC inverter was previously studied in [299,307] through simulations. However, the generator-side control and complete WECS response during the grid voltage dips is not analyzed. In this work, the three-level boost (TLB)-NPC converters are used to realize the power conversion system for PMSG-WECS. The turbine-generator inertia, along with the converter control-based system on predictive control is used to enhance the LVRT capability. The continuous- and discrete-time models of the power converters are presented. The generation of reference control variables and the coordination between the TLB and NPC converters during the normal and LVRT operation is presented. The control objectives for the TLB converter are expressed as generator-side cost function, while the grid-side cost function deals with the NPC inverter control requirements. During each sampling interval, these cost functions are minimized using the actual measurements and predicted quantities (using switching states of the converters). The switching states which minimize these cost functions have been chosen and applied to the TLB and NPC converters directly. To achieve an optimal control performance, as suggested by [303], a two-step predictive model is utilized. 208

9.2

Configuration of the PMSG-WECS

The power conversion system for the direct-driven PMSG based WECS is shown in Fig. 9.1. More details about the converters are given in Chapter 7. The pitch control system regulates the output power of the turbine when the wind speed is above its rated value. The magnitude, phase and frequency of the grid voltages are monitored by the grid integration supervisory system. It sends appropriate control signals to the references generation system in the event of grid faults [293]. During the normal and LVRT operation, with the help of the reference generation system, the reference inductor current is generated for the TLB converter, while the reference dq -axis currents are generated for the NPC inverter. The control objectives for the power converters include: · TLB Converter: ­ regulation of inductor current, idc  to achieve maximum power point tracking (MPPT) during normal operation  to store the surplus energy in the turbine-generator rotor inertia during LVRT operation ­ balancing of dc capacitor voltages during all operating conditions to maintain semiconductor device voltage stress within safe limits · NPC Inverter: ­ regulation of d-axis grid current  to maintain net dc-bus voltage, vdc at its reference value during normal operation  to limit the active power output, Pg during LVRT operation ­ regulation of q -axis grid current to generate reactive power to the grid ­ grid synchronization The generator- and grid-side controllers take appropriate switching actions in order for the above-mentioned control objectives to be met during normal and LVRT operation. The grid synchronization is carried out as per the guidelines given in [14]. 209

Diode Rectifier DC Link-2

Three-Level DC Link-1 Boost Converter Three-Level NPC Inverter

Ps Rdc , Ldc
P(1)

Pdc D1 S1a C1
-

idc
Pw S1 Pm
Wind

S1b S2b

S1c
Filter

vc1

+

ic1
S2a vdc

Grid Integration

ias ibs
+

S2c Rg , Lg

Pg , Qg

ics
Direct Driven MV PMSG

Cin
- +

vin

Z(0)

iag ibg icg

C2 D2

Wind Turbine

-

vc2

S2

S 2a
N(-1) TLB Gating Signals, Sr

S 2b

S 2c

vag vbg vcg

ic2

S 1a

S 1b

S 1c

2

12

NPC Gating Signals, Si

Wind Turbine Pitch Controller

Generator-side Converter Controller
 idc

Grid-side Inverter Controller
 idg  iqg

Generator Integration

Supervisory System

|vc1 - vc2 | = 0

Generation of Reference Control Variables

Control System

Figure 9.1: Configuration of three-level boost converter and NPC inverter based MW-MV PMSG-WECS.

210

9.3

Storage of Surplus Energy in Turbine-Generator Rotor Inertia

As discussed in the previous sections, during grid faults the active power injected to the grid is zero (Pg = 0). The surplus energy must be managed by the wind turbine system and power converters. By referring to Fig. 9.1, the following analysis can be made: Pw - Ps = Pm =  m J d m dt (9.1)

where Pw is power captured from the wind, Pm is mechanical input power to the electric generator, Ps is active power output of the generator, J is turbine-generator moment of inertia, and m is mechanical shaft speed. If Ps is decreased without altering the power captured from the wind (Pw ), then the mechanical power (Pm = Pw - Ps ) increases, and this scenario leads to an increase in the turbine-generator shaft-speed from m,R to m,max [67]: 1 2 2 - m,R Pm dt = J m,max 2 (9.2)

where m,max is the maximum value of shaft speed during grid fault, and m,R is rated shaft speed. The relation between maximum shaft-speed m,max and fault duration (dt = tf ) can be obtained from (9.2) as follows: m,max = 2 Pm tf 2 + m,R . J (9.3)

In the practical MW direct-driven wind turbines, the value of inertia constant H (=
2 Jm,R

2Pm

) is in the range of 5-6 seconds [2, 67, 293, 305], and it will maintain the shaft speed to

a safe limit.

211

9.4

Control System for the PMSG-WECS

The control systems for the generator- and grid-side converters are presented here. They force the converters to track to the references during normal and LVRT operation.

9.4.1

Generator-side Converter Controller

The proposed control system for the generator-side converter control is shown in Fig. 9.2. The control objectives for the TLB converter are included in the generator-side cost function as follows:
2 ggen (k ) = [i dc (k + 2) - idc (k + 2)]

+ dc  [vc1 (k + 2) - vc2 (k + 2)]

2

(9.4)

where i dc (k + 2) is the extrapolated reference inductor current, idc (k + 2) is the predicted inductor current, vc1 (k + 2) and vc2 (k + 2) are the predicted dc-link capacitor voltages, and dc is the weighting factor for the balancing of capacitor voltages. The weighting factor dc substantiates the importance of the secondary objective (balancing of dc-link capacitor voltages) over the primary control requirement (regulation of idc ). Equal importance will be given to primary and secondary objectives when dc = 1, but this scenario leads to a poor performance for the primary goal. By setting dc = 0, a very good response can be obtained for the primary objective, but the dc-link capacitor voltages cannot be regulated. In this work, the value for dc is chosen as 0.1 to ensure acceptable balancing for the dc-link capacitor voltages and good reference tracking for idc . Predictions for the future behavior of the inductor current and dc capacitor voltages can be obtained as follows:       idc (k + h - 1) vin (k + h - 1) idc (k + h)       vc1 (k + h) = b vc1 (k + h - 1) + b  io1 (k + h - 1)  vc2 (k + h) vc2 (k + h - 1) io2 (k + h - 1) where h is the prediction horizon length. b and b are given in (7.11). The dynamic systems in (9.5) suggests that the generator-side control variables (idc , vc1 and vc2 ) do not require the model of the PMSG and the wind turbine. This feature greatly simplifies the complexity of the control system compared to the one used with the BTB-NPC 212

(9.5)

converters. The current state (k ) measurements and the four switching states are used in the prediction of future behavior of the control variables. With the optimal selection of switching signals, the control variables can be effectively controlled.
i dc (k + 2) i dc (k )
Extrapolation Generator-side Cost Function Sr (k)

|vc1 - vc2 | = 0
Si (k) Output Currents Calculation (7.10)

ggen (k )
Minimization using (9.4)

iag (k ) ibg (k ) icg (k )

io1 (k ) io2 (k )
io1 (k + 1) io2 (k + 1)

idc (k + 2)
Generator-side Predictive Controller using (9.5)

vc1 (k + 2) vc2 (k + 2)

vin (k )

Extrapolation

vin (k + 1) vc1 (k ) idc (k ) vin (k ) vc2 (k )

Figure 9.2: Proposed model predictive controller for the generator-side converter.

i dg (k )
Extrapolation

i dg (k + 2)
Grid-side

i qg (k )

i qg (k + 2)

Cost Function

Si (k)

ggrid, (k )
Minimization (9.6)

vag (k ) vbg (k ) vcg (k ) iag (k ) ibg (k ) icg (k )

vdg (k ) vqg (k )
SRF-PLL and abc/dq Transformation

idg (k + 2)
Grid-side Predictive Controller using (8.14)

iqg (k + 2)

idg (k ) iqg (k )

g (k ) vc1 (k ) vc2 (k ) vdg (k + 1) vqg (k + 1)

Figure 9.3: Proposed model predictive controller for grid-side inverter.

213

9.4.2

Grid-side Inverter Controller

The proposed grid-side inverter controller is shown in Fig. 9.3. The grid-side inverter is used to control the d- and q -axis currents. This control objective is expressed as a grid-side cost function: ggrid (k ) = i dg (k + 2) - idg (k + 2)
2

+ i qg (k + 2) - iqg (k + 2)

2

(9.6)

 where i dg (k + 2) and iqg (k + 2) are the extrapolated reference currents, and idg (k + 2) and

iqg (k + 2) are the predicted dq -axis currents. The prediction for dq -axis grid currents is obtained according to the models given in Chapter 8.
LVRT

MPPT
T,op ×vw (k ) rT

Signal

 (k ) m

+ -

PI

i dc,N ORM (k )

0 1

i dc (k )

vw (k )

i dc,LV RT (k )

 m (k )
Anemometer
 vdc (k ) LVRT Signal

3.062 × vbg

+ -

PI vdc (k )

i dg,N ORM (k )

0 1

i dg (k )

vc1 (k ) vc2 (k )
ibg ·  2

i dg,LV RT (k ) +

(· )2 (· )2 Q g (k )
×

(· )
i qg,LV RT (k )
Grid Integration Supervisory System

- i qg,N ORM (k ) 0 ÷ i qg,LV RT (k ) 1

LVRT Signal

vdg,pu (k )

i qg (k )

 0.9
LVRT Signal

-1.5 vdg (k ) vdg (k )
Look-up Table

0 = NORM 1 = LVRT

Figure 9.4: Generation of reference control variables during normal and LVRT operation.

214

9.5

Generation of Reference Control Variables

In the previous section, the generator- and grid-side cost functions are designed based on the assumption that the references are readily available. The generation of such references is very important in order to allow for the safe operation of power converters and wind turbines, and also to meet the grid codes. The block diagram of the references generation system is shown in Fig. 9.4.

9.5.1

Normal Operation

The maximum power point tracking (MPPT) is an important issue in variable speed WECS. In this research an optimal tip-speed-ratio (OTSR) MPPT algorithm [51] is used. This algorithm provides reference speed based on the measured wind speed. As shown in Fig. 9.4, a speed regulator (PI) generates the corresponding inductor current reference. The PMSG speed, current and electromagnetic torque can be regulated by tracking this reference. The dq -axis grid current references are generated by a method similar to the classical voltage oriented control [2]. Through the PI controller-based regulation of net dc-bus voltage, the d-axis reference current is generated. With the Q g command provided by the grid operator, the q -axis reference current is obtained.

9.5.2

LVRT Operation

The TSOs and DSOs of diverse countries issue different LVRT profiles [13] based on the experience acquired through the operation of their power systems. The LVRT profiles can be broadly classified into six different categories as shown in Fig. 1.5. Despite their different shapes, they all share a common purpose and background, i.e., to keep the electric power system stable and secure during the grid fault conditions. Among all the LVRT profiles, the German Transmission and Distribution Utility (E.ON) regulation [17] is likely to set the standard. According to this grid code, the LVRT function should start when the grid voltage falls below 90 % of its nominal value. For the grid voltages in the range of 50 - 90 %, the generation system should provide 2 % reactive current for each 1 % voltage dip, and when the grid voltage falls below 50 %, the system should provide 100 % reactive current. In this work, the dq -axis reference grid currents are produced according to the E.ON grid code and shown in Fig. 9.4. 215

9.6

Simulation Results

To validate the proposed converter and control scheme during grid voltage dips, simulation results are presented using MATLAB/Simulink. The parameters of the PMSG-WECS are shown in Table 9.1. To better compare the simulation and experimental results, the computational delay caused by the real-time digital signal processor is considered in the simulation tests, and this value is set to one sampling period, Ts . Two-step predictive models are used in all the tests. To reduce simulation run time, the original moment of inertia is reduced to 14.5 %. The PMSG-WECS is assumed to be operating at the rated wind speed condition. The average switching frequencies for the TLB and NPC converters are noted as: 253 and 740 Hz, respectively. The average switching frequencies can be minimized to lower values by including extra constraint in the cost functions ggen (k ) and ggrid (k ). The grid current THD is found to be 4.41 %.

9.6.1

Analysis with Generator-side LVRT Controller Disabled

In the first test, as demonstrated in Figs. 9.5 and 9.6, the generator-side LVRT controller
 is disabled meaning that i dc (k ) = idc,N ORM (k ), and the grid-side LVRT controller is enabled    ([i dg (k ) = idg,LV RT (k ) and iqg (k ) = iqg,LV RT (k )](refer to Fig. 9.4). As shown in Fig. 9.5(a),

a dip in the grid voltage is applied from 100 % to 10 % at t = 2.0 s, with a duration of 150 ms. Since the generator-side references correspond to the MPPT operation, the PMSG shaft speed (m ), electromagnetic torque (Te ), stator voltage (vs,ab ), stator current (ias ) and input dc voltage (vin ) do not respond to the LVRT operation as depicted in Fig. 9.6. The PMSG currents contain significant 5th and 7th harmonics (mainly caused by the diode-bridge rectifier) which leads to higher ripple in Te . The use of diode rectifier also leads to the clipping of the generator terminal voltage. The shape of the generator voltage changes according to the configuration of the diode rectifier, Cin value and the operating condition [68]. This is the only disadvantage of using diode-rectifiers for the PMSG turbines. Due to the decoupled nature of the power converters, these harmonics are not reflected to the grid, and thus they do not cause any conflict to the grid codes. During the voltage dip, the active power injected to the grid is zero [i dg (k ) = 0] [Fig. 9.5(b)], but, the PMSG injects rated power into the dc-link. According to the power balance 216

Table 9.1: Parameters of the proposed PMSG-WECS
Variable PM TM NM Rgb rT  Cp,op T,op Pm Ps vsl vs is fs P Fs nm,R PP Tm,R r Rs Ld Lq J H bs Zbs Lbs Cbs vbs,peak ibs,peak Sg vgl vg ig fg Zbg Lbg Cbg vbg,peak ibg,peak Cin Cdc Rdc Ldc Rg Lg h Ts dc  vdc Simulation Experimental SI p.u. SI p.u. Wind Turbine Parameters Rated Power (kW) 3000 1.0 3.6 1.0 Rated Torque (kN.m) 1273.3 1.0 0.2292 1.0 Rated Speed (rpm) 22.5 1.0 150 1.0 Gear Ratio 1 1 Rotor Radius (m) 43.3553 ­ Air Density (kg.m2 ) 1.225 ­ Optimal Power Coefficient 0.48 ­ Optimal Tip Speed Ratio 8.5128 ­ Permanent Magnet Synchronous Generator Parameters Rated Mechanical Power (kW) 3000 3.6 Rated Output Active Power (kW) 2962 3.527 Rated Line-Line Voltage (V) 3000 208 Rated Phase Voltage (V) 1732.2 1.0 120 1.0 Rated Stator Current (A) 582 1.0 10 1.0 Rated Stator Frequency (Hz) 9.75 1.0 20 1.0 Rated Power Factor 0.98 0.98 Rated Rotor Speed (rpm) 22.5 1.0 150 1.0 Number of Pole Pairs 26 8 Rated Mechanical Torque (kN.m) 1273.24 1.0 0.2292 1.0 Rated rms Rotor Flux Linkage (Wb) 28.059 1.0 0.956 1.0 Stator Winding Resistance (m) 37.521 0.013 245 0.021 d-axis Synchronous Inductance (mH) 9.75 0.2 19.1 0.2 q -axis Synchronous Inductance (mH) 9.75 0.2 19.1 0.2 Moment of Inertia (kg.m2 ) 6327 Inertia Time Constant (s) 5.81 Base Flux Linkage (Wb) 28.059 1.0 0.956 1.0 Base Impedance () 2.978 1.0 12.024 1.0 Base Inductance (mH) 48.606 1.0 95.683 1.0 Base Capacitance (F) 5481.9 1.0 661.83 1.0 Peak Base Voltage (V) 2449.7 1.414 169.9 1.414 Peak Base Current (A) 823.1 1.414 14.14 1.414 Medium Voltage Grid Parameters Rated Apparent Power (kVA) 3000 1.0 3.6 1.0 Rated Line-Line Voltage (V) 3000 208 Rated Phase Voltage (V) 1732.2 1.0 120 1.0 Rated Stator Current (A) 577.35 1.0 10 1.0 Rated Stator Frequency (Hz) 60 1.0 60 1.0 Base Impedance () 3 1.0 12.018 1.0 Base Inductance (mH) 7.96 1.0 31.88 1.0 Base Capacitance (F) 884.19 1.0 220.72 1.0 Peak Base Voltage (V) 2449.7 1.414 169.9 1.414 Peak Base Current (A) 816.5 1.414 14.14 1.414 Rectifier and Inverter Parameters Input Capacitance (base: Cbs ) (F) 18828 3.43 4700 3.43 Output dc-link Capacitance (F) 4006 4.53 1000 4.53 Boost Filter Leakage Resistance () 0.3 0.01 0.12 0.01 Boost Filter Inductance (mH) 2.5 0.31 10 0.31 Grid-side Filter Resistance () 0.027 0.009 0.108 0.009 Grid-side Filter Inductance (mH) 1.65 0.207 6.6 0.207 Controller Parameters Prediction horizon length 2 2 Sampling Time (s) 100  100  Weighting Factor 0.1 0.1 Reference dc-link Voltage (V) 5304 3.062 367 3.062 Description

217

Normal

LVRT

Recovery from LVRT

Normal (Theoretical Only)

1 0 -1

vdg

Scale = 1/vbg,peak

vqg
(a)

vag

vbg

vcg

3 2 1 0 -1 -2 -3

idg

Scale = 1/ibg,peak

iqg
(b)

iag

ibg

icg

5 4 3 2 1 0 (c) 3 2
 vdc

 Scale = 1/vdc

vdc

vc1 vc2

 Scale = 1/vdc

1 0 (d) 3 2 1 0 -1 -2 -3 1 .9 2 .1 2.3 2 .5 2.7
 Scale = 1/vdc

vi,ab
3 .1 2.9 Time (s) (e) 3.3 3 .5 3.7 3.9 4 .1

Figure 9.5: Simulation results during three-phase grid voltage dip with the generator-side LVRT controller disabled (Part­I).

218

Normal LVRT

Recovery from LVRT

Normal (Theoretical Only)

1 0 -1

vdg

Scale = 1/vbg,peak

vqg
(a)

vag

vbg

vcg

2 1 0 -1 -2 (b) 2

Te /Tm,R

m /m,R

Scale = 1/ibs,peak

1

i dc
0 (c) 2 1 0 -1 -2 2

idc

vs,ab /vbs,peak
(d)

ias /ibs,peak
Scale = 1/vbs,peak

1

vin
0 1 .9 2.1 2 .3 2.5 2.7 3.1 2.9 Time (s) (e) 3 .3 3.5 3.7 3.9 4.1

Figure 9.6: Simulation results during three-phase grid voltage dip with the generator-side LVRT controller disabled (Part­II).

219

theorem, the surplus energy should be stored in the dc-bus. As a consequence, the net dc-bus voltage is increased to 4 times its rated value [Fig. 9.5(c)], and in real systems, this will destroy both the TLB and NPC converters. For this reason, some works proposed to dissipate this surplus energy using a resistor in the dc-link (crowbar), and some other works proposed to store this energy in the battery banks [18, 304]. As shown in Fig. 9.5(d), the vc1 and vc2 are balanced by the TLB converter even during the divergence period (t = 2.0 to 2.15 s). Due to the significant increase in vc1 and vc2 , the inverter voltage magnitude [refer to Eq. (7.1)], the ripple in inductor current [Eq. (9.5)], and the ripple in dq -axis grid currents [Eq. (8.14)] increases. This scenario leads to noncompliance of grid codes, in addition to the failure of power converters. At t = 2.15 s, the grid voltages recover back to its normal operating condition. The saturation limits of the dc-bus PI controller is set to 1.5 times ibg,peak . This helps to quickly discharge the capacitor voltages by injecting more active power to the grid. In theory, the system returns back to its normal operation at t = 2.8 s (only if the power converters do not fail during the LVRT operation).

9.6.2

Analysis with Generator-side LVRT Controller Enabled

The simulation results using the generator-side LVRT controller are presented in Figs.
   9.7 and 9.8. The reference control variables are: i dc (k ) = idc,LV RT (k ), idg (k ) = idg,LV RT (k )  and i qg (k ) = iqg,LV RT (k ). The profile of grid voltage is similar to the previous case. Since the

PMSG speed control loop is disabled, the surplus energy is stored in the inertia of turbine and generator. As shown in Fig. 9.8(b), with the reduced inertia constant H = 0.4, the PMSG speed increases to 17 % above its rated value. This can be theoretically conformed as: m,R = nm,R × 2 ×  = 2.3562 rad/s 60 H × 2 × Pm J= = 432.3 kg.m2 2 m,R

m,max =

2 Pm 150 × 10-3 2 = 2.7629 rad/s + m,R J m,max - m,R × 100 = 17.3 %. m,R

By using the original value of H = 5 [2, 67, 293, 305], the percentage increase in m can be obtained as 1.48 % and 6.02 % for the fault durations of 150 ms and 625 ms, respectively. 220

Normal

LVRT

Recovery from LVRT

Normal

1 0 -1

vdg

Scale = 1/vbg,peak

vqg
(a)

vag

vbg

vcg

3 2 1 0 -1 -2 -3

idg

Scale = 1/ibg,peak

iqg
(b)

iag

ibg

icg

5 4 3 2 1 0 (c) 3 2 1 0 (d) 3 2 1 0 -1 -2 -3 1 .9 2.1
 vdc

 Scale = 1/vdc

vdc

 Scale = 1/vdc

vc1

vc2

 Scale = 1/vdc

vi,ab
2.3 2.5 2.7 3.1 2 .9 Time (s) (e) 3.3 3.5 3.7 3 .9 4.1

Figure 9.7: Simulation results during three-phase grid voltage dip with the generator-side LVRT controller enabled (Part-I).

221

Normal

LVRT

Recovery from LVRT

Normal

1 0 -1

vdg

Scale = 1/vbg,peak

vqg
(a)

vag

vbg

vcg

2 1 0 -1 -2 (b) 2

Te /Tm,R

m /m,R

Scale = 1/ibs,peak

1

i dc
0 (c) 2 1 0 -1 -2 (d) 2

idc vs,ab /vbs,peak

ias /ibs,peak
Scale = 1/vbs,peak

1

vin

0 1.9 2.1 2.3 2 .5 2.7 3.1 2.9 Time (s) (e) 3.3 3.5 3.7 3.9 4 .1

Figure 9.8: Simulation results during three-phase grid voltage dip with the generator-side LVRT controller enabled (Part-II).

222

This analysis conforms that the turbine-side mechanical system response is much slower compared to the grid-side electrical system response. During the LVRT interval, t = 2.0 to 2.15 s, the electromagnetic torque is maintained at zero to allow the PMSG to accelerate as shown in Fig. 9.8(b). The active power generated by the PMSG is zero, and this can be understood from the zero values of PMSG and inductor currents [Fig. 9.8(d)]. The magnitude of the net dc-bus voltage is maintained within safe limits, and the dq -axis grid currents track to their reference values with minimal ripple. During the step-change in references at t = 2.0 s, the inductor and grid currents follow their references accurately (shown in box). The input dc voltage magnitude increases with respect to the generator speed, but, this increase is in the acceptable limits. During the recovery from the LVRT operation (t = 2.15 s onwards), the inductor current reference is maintained at its higher saturation level to help the PMSG to decelerate rapidly. At t = 3.8 s, the system recovers back to normal operation without causing any failures to the power electronic converters. These results confirm that the proposed converters and predictive control can be used efficiently in the MW PMSG-WECS. For the compliance with new grid code requirements, the rather old concept of storing energy in the inertia of rotating masses is applied to wind energy system, and this approach eliminates the cost and complexity associated with the conventional approach of dc-link crowbar. This method is more efficient because no energy is dissipated in the crowbar. Moreover, the proposed approach is safe because most of the commercial wind turbines are equipped with the over-speed capability. For example, the Yaskawa R is offering a MV DD-PMSGs (Enewin-Generators) for wind turbines in the power ratings of 2­5 MW@3000 V. These generators have over-speed capability of 130 % for 2 minutes. When the fault duration is too long, the generator may cross the threshold level of overspeed capability, and the output voltage of diode-rectifier vin ( 1.35 × vsl ) may exceed its threshold limit. When this scenario happens, which ever is first, the pitch mechanism and brake enter into action to trip the turbine. It should be noted that the vin does not increase significantly compared to the vdc . As shown in the summary of the state-of-the-art national grid codes in Table 1.3, the maximum grid voltage sag duration, without allowing wind turbine tripping is 625 ms. The previous analysis indicates that the increase in vin for the maximum fault duration is 6.02 % only. Therefore, according to Table 1.3, beyond 625 ms 223

the turbine is allowed to be disconnected from the point of view of grid-connected WECS.
Normal LVRT 3 Recovery from LVRT Normal

Scale = 1/vbs,peak
2 1

Filtered vin
0 1.9 2.1 2.3 2 .5 2.7 2.9

vin
3 .1 3.3 3.5 3.7 3 .9 4.1

Time (s)

Figure 9.9: Simulation result for input dc voltage vin during three-phase grid voltage dip with the generator-side LVRT controller enabled and Cin = 820 F.

For the simulation results presented in Figs. 9.5, 9.6, 9.7 and 9.8, the value of Cin is chosen as 3.43 p.u.. The generator-side base capacitance Cbs is much larger compared to the grid-side base capacitance Cbg due to the lower fundamental frequency of PMSG (refer to Table 9.1). Due to this reason, the Cin value is much larger compared to Cdc . The Cin has less impact on the system performance, and thus its value can be decreased significantly to further reduce the cost and size of overall power converter. The simulation results shown in Figs. 9.7 and 9.8 are repeated with Cin = 820 F (0.15 p.u.) and the waveform for vin is presented in Fig. 9.9. Due to lower value of Cin , the ripple in vin increases, but by using filtered vin in the control scheme (refer to Fig. 9.2) the system response during normal and LVRT operation becomes similar to Figs. 9.7 and 9.8. The voltage rating for the Cin is decided according to the maximum rise in the mechanical shaft speed m,max . To fulfill the state-of-the-art LVRT requirements with the maximum fault duration of 625 ms, the voltage rating of Cin becomes approximately 4293 V (=1.35 × 3000 × 1.06) [84]. To realize input dc-link, 10 units of 8200 F, 450 V capacitors can be connected in series. It should be noted that the cost of input dc-link is very low ($470) compared to the cost of one 6.6 kV, 1200 A IGCT ($1800) [11]. The work in [113] demonstrated that the power conversion system can also work without employing Cin . The elimination of Cin , and the analysis of its impact on torque ripple, grid-side converter control and LVRT operation is considered as future work.

224

9.7

Experimental Results

A low power prototype model is developed as shown in Fig. 9.10.
Wind Turbine Emulator Power Conversion System Grid Fault Emulator

DSP/ FPGA Controller

dSPACE DS1103 Controller-2 dc Power Supply Unit

MATLAB/ Simulink & Control Desk

Gate Drivers & Interface Unit

DS1103 Controller-1

CP1103 Connecter

(a) Block diagram
E B

L K

m vin idc vc1 vc2 vag vbg iag ibg

J A D F C G H I

(A) key board, (B) DSP/FPGA controller, (C) prime mover, (D) non-salient pole PMSG, (E) NPC inverter, (F) three-level boost converter, (G) grid-side filter, (H) voltage and current transducers, (I) DS1103 R&D controller, (J) measurement system, (K) control desk, and (L) three-phase grid fault simulator.

(b) Photograph of complete setup

Figure 9.10: Experimental setup.

225

Two mechanically coupled PMSGs are used. The first PMSG, along with a DSP/FPGA controller, is used as a prime mover to provide the required mechanical torque emulating the wind for the second PMSG. These machines have been obtained from a real wind farm, and they feature over-speed capability similar to the MW-DD generators. The TLB and NPC converters are controlled by a dSPACE DS1003 rapid prototyping board. The grid fault emulator is developed based on a two-level inverter with an output LC filter, which is controlled using another DS1103 platform. More details about the experimental setup can be found in Section 7.4. It should be noted that slower switching times of the IGBTs does not affect the predictive control strategy. In the predictive control approach, sampling time (Ts ) is selected based on the minimum execution time required to perform the optimization algorithm during each sampling interval [81, 279]. Unlike in the classical modulation-based control techniques [67], the selection of Ts is not related to the switching frequency [81, 279]. In other words, for a given value of Ts , the predictive controller can operate with a wide range of switching frequencies by just including a constraint in the cost function. In the present experimental tests, the dSPACE controller can handle all the calculations and two-step predictions related to the proposed method within 100 s. The moment of inertia of the PMSG used in the experimental set-up is very low, which means that, during grid fault condition, it reaches the over-speed threshold quickly compared to the PMSG used in simulation analysis. To avoid an unexpected increase in speed, the fault duration is reduced from 150 to 75 ms, but the depth of the voltage dip is same as of simulations. Even though the duration of grid fault is different in the simulations and experiment, the operating principle remains same. Due to hardware restrictions, the saturation limit of the dc-bus PI controller is set to 1.2 times ibg,peak . The experimental results with the proposed strategy are presented in Figs. 9.11 and 9.12. The PMSG operates at rated condition and the average switching frequencies for the TLB and NPC are noted as 280 and 760 Hz, respectively. The THD of the grid currents is measured as 5.2 %. The transient responses during the grid voltage dip from 100 % to 10 % are shown in boxes. The voltages generated by the grid fault simulator contain less THD. But it has been demonstrated in Chapters 5 to 8 that the predictive control technique is robust against grid voltage harmonics and also grid-side filter parameter variations. During the LVRT interval, the generator shaft speed and input dc voltage are increased 226

Normal

LVRT

Recovery from LVRT

Normal

vdg

vag

vbg (a)

vcg

iag

idg

iqg vdc

(b)
Figure 9.11: Experimental results during three-phase grid voltage dip with the generator-side LVRT controller enabled (Part-I).

227

Normal

LVRT

Recovery from LVRT

Normal

vc1

vc2

vi,ab

m

(a) idc

ias

vs,ab vin (b)
Figure 9.12: Experimental results during three-phase grid voltage dip with the generator-side LVRT controller enabled (Part-II).

228

similar to the simulation results. Due to the low moment of inertia, the percentage of speed increase is high compared to the simulation. This would not be the case with MW turbines. During this time frame, the inductor current and stator currents are maintained at zero value. The grid currents corresponding to the active and reactive power are maintained at their reference values during normal and LVRT operation. The net dc bus voltage is maintained within safe limits and the dc-link capacitor voltages are well balanced during all the operating conditions. A delay time of 3 ms is noticed from the instant the grid voltages become zero and the reactive current becomes 100 %. This is mainly due to the dead-time caused by the voltage and current sensors, gate drivers and controller. The E.ON grid codes indicate that the control actions should be taken within 20 ms if the grid voltage drops below 90 %. The response time of 3 ms provides excellent compliance with the grid codes. Similar to the simulations, the grid and inductor currents track their references accurately (shown in box). This is made possible due to the elimination of the linear regulators and modulation stage in the controller design. The experimental results presented here confirm that the LVRT compliance can be enhanced efficiently using the proposed power converters and control scheme. This analysis considers symmetrical grid fault conditions, but it is also possible to include unsymmetrical grid faults as outlined in [299]. The system analysis with unsymmetrical grid faults is considered as a possibility for future work.

229

9.8

Conclusion

A model predictive control scheme is proposed for the LVRT enhancement of megawatt direct-driven PMSG wind turbines. The proposed approach is based on the storage of surplus energy in the turbine-generator shaft inertia during the grid faults. The reference control variables are exchanged during the LVRT operation to protect the power converters (by limiting the dc-bus voltage to safe limits), while meeting the grid code requirements. This method is most favorable for megawatt direct-driven wind turbines which possess extensive moment of inertia. The proposed solution is verified for a medium voltage PMSG-WECS based on a three-level boost and NPC converters. The experimental results indicate that during the grid faults the proposed predictive control provides smooth transition between normal and LVRT operation with a response time of 3 ms.

230

Chapter 10 Conclusions
The present wind energy industry indicates a trend towards the research and development of megawatt-level wind turbines. The major interests of the current wind turbine manufacturers include: variable-speed (Type-4) technology, direct-driven (DD) permanent magnet synchronous generator (PMSG), medium voltage (MV) operation and development of sophisticated control systems to increase the wind energy conversion efficiency and to meet stringent grid codes. In this work, by incorporating the aforementioned wind industry interests as basic components, two novel power converter configurations, and various model predictive control schemes, have been developed and validated aimed at next generation 3­15 MW wind turbines. The outcome of the research work presented in this dissertation has brought several major innovations in the development of next generation converter configurations and control schemes for the megawatt wind energy systems. The proposed configurations are very promising for the future development as they have been designed by combining the best features of the existing commercial wind turbine solutions. The research results presented here also promote the predictive control strategy as a simple, efficient and high performance control tool for megawatt power converters which operate at a very low (< 1 kHz) switching frequency. Various control objectives such as grid/inductor currents, dc-link capacitor voltages, switch changes, common-mode voltage, net dc-bus voltage, grid active power and grid reactive power are included in the design and operation of the predictive controller. The modeling and analysis presented in this work can be used in other power electronics and energy system applications.

231

10.1

Summary of Major Contributions

The major contributions and conclusions of this research work are summarized as follows. 1) A review of the wind energy industry, full-scale power converters and digital control schemes is presented · An extensive survey on the past, present and future trends of the wind energy market is presented to fill gaps in the existing literature, · A review of practical and emerging full-scale power converters is presented. Various technical issues, features and drawbacks are analyzed, and important survey results are summarized by tables, and · Various classical and advanced control techniques are discussed and compared based on an intuitive example of load current control. 2) Novel three-level converters are proposed for 3­4 kV WECS In this dissertation, a novel power converter topology using a diode rectifier, threelevel boost converter and neutral-point-clamped (NPC) inverter is proposed for the next-generation DD-PMSG based 3­4 kV class WECS. Compared to the commercially available back-to-back (BTB) connected NPC converter, the proposed configuration uses less number of active switches and thus it is less expensive and reliable. The dc-link capacitor voltages are balanced during all operating conditions by the boost converter. Because of the control freedom for the NPC inverter, the grid current harmonic distortion is noted to be lower compared to the BTB-NPC converters. 3) Four-level converters are proposed for 4­10 kV WECS A new power conversion system based on four-level converters is explored aimed at the next generation 4­10 kV class WECS. The grid current quality has been increased significantly compared to the three-level converters. To solve the problem of the dc-link capacitor voltages balancing, which is more complicated compared to the three-level converters, a four-level boost converter is proposed as an intermediate stage. Despite the large number of active switches and clamping diodes used in the four-level inverter, the cost of this configuration is approximately the same as that of the BTB-NPC converter. 232

4) Continuous- and discrete-time models are presented In this work, the continuous-time model of the variables to be controlled is presented in terms of power converter switching states. Several variables, such as load/grid/inductor currents, dc-link capacitor voltages, switching frequency, common-mode voltage, net dc-bus voltage, active power and reactive power, are incorporated in the design of the system model. All the continuous-time models have been converted to discrete-time so as to incorporate the control delay and prediction horizon. 5) A generalized method is proposed to control the multilevel diode-clamped converters (MLDCCs) In this dissertation, similar to those in the classical control methods, a generalized approach based on FCS-MPC strategy is presented for the load/motor/grid current control, dc-link capacitor voltages balancing, switching frequency reduction and commonmode voltage mitigation in MLDCCs. The proposed method shows a promising solution to controlling the converters with diverse control objectives and constraints. 6) Two advanced techniques are proposed to control the grid-tied converters The grid-tied multilevel converters are crucial to the dispatch of generated power and also in meeting the grid codes. In this dissertation, two advanced control schemes based on FCS-MPC are proposed: · In the first control strategy, the net dc-bus voltage and grid reactive power are controlled, assuming that the generator-side converter performs MPPT; · In the second strategy, the grid active and reactive powers are controlled with an assumption that the generator-side converter regulates the net-dc bus voltage; · In both methods, the voltage stress and switching losses of the semiconductor switches are reduced by balancing the dc-link capacitor voltages and by minimizing the switching frequency below 1 kHZ, respectively; · An excellent dynamic response has been achieved by eliminating the internal current control loops and modulators; and · Compared with the classical decoupled voltage-oriented control, a better reference tracking and power quality has been achieved. 233

7) Complete control systems have been built for the 3L and 4L converters based WECS A step-by-step procedure for the design of a complete control system for the proposed 3L and 4L converters based MW-MV-DD-PMSG-WECS is presented. The objectives such as MPPT, dc-link capacitor voltages balancing, regulation of net dc-bus voltage, reactive power generation, lower switching frequency operation, and common-mode voltage minimization are considered in the design of generator- and grid-side cost functions. The proposed solutions can be easily extended to other WECS configurations and motor drive applications. 8) FCS-MPC strategy is proposed for the low voltage ride-through (LVRT) enhancement of PMSG wind turbines A predictive control scheme is proposed for the LVRT enhancement of DD-PMSG wind turbines. The proposed approach is based on the storage of surplus energy in the turbine-generator shaft inertia during the grid faults, and thus no additional dc-link crowbar (resistor) is required. The exchange of reference control variables between normal and LVRT operation is suggested to protect the power converters (by limiting the dc-bus voltage to safe limits), while meeting the grid code requirements. The proposed method is most favorable for the high power wind turbines which possess large moment of inertia. The E.ON grid code indicates that the control actions should be taken within 20 ms if the grid voltage drops below 90 %. In this work, a response time of 3 ms is achieved to switch from the normal to LVRT operation mode. 9) Various challenges related to the FCS-MPC strategy are addressed · In order to solve the variable switching frequency nature of the predictive control strategy, a look-up table based on weighting factor selection is proposed and verified. This approach guarantees the regulation of switching frequency within the set boundary limits (for example 750-850 Hz); · A detailed empirical procedure for the selection of weighting factors is presented to fill the gap in literature; · A novel extrapolation method is proposed to estimate the future values of the synchronous reference frame variables. The proposed method eliminates the os234

cillations in the reference active and reactive powers (which are control variables for the case study considered), and the spike in the inverter line-line voltage. This method leads to safe and reliable operation for the semiconductor devices during step-changes in the reference control variables; · A simplified two-step predictive control strategy is proposed to improve the performance and also to reduce the computational burden involved in the real-time implementation. The proposed solution offers accurate tracking to the reference control variable, lower dv/dt in the output voltage waveform and lower switching frequency compared to the standard one-step and two-step prediction methods; · A novel delay compensation technique is introduced for the FCS-MPC. Compared to the state-of-the-art works which compensate the control delay at the expense of higher switching frequency, the proposed technique shows a better solution without increasing the converter switching frequency. The proposed solution is promising for high power applications where lower switching frequency operation is mandatory; and · Performance of the proposed predictive control techniques are investigated with the perturbations in the grid-side filter and dc-link parameters. The results indicate that the proposed controllers are robust and can compensate for the system perturbations, while the control variables continue to effectively track to their references. 10) Simulation and experimental studies are conducted to verify the system operations All the simulation studies are carried out using MATLAB/Simulink software. The predictive control algorithms are developed using MATLAB S-Builder function for an easy transfer of code to real-time implementation. Several low power prototype converters have been built such as BTB 2L-, 3L- and 4LVSCs; and 2L-, 3L- and 4L-boost converters. All the theory, control system design and simulation results are validated through the experimental tests. A dSPACE DS1103 rapid prototyping controller based test platform has been developed. A grid-fault simulator based on 2L-4Leg-VSC is developed which can generate different symmetrical and unsymmetrical output voltage waveforms. 235

10.2

Future Works

The following future research works are suggested as an extension to the knowledge presented in this dissertation. 1) Comparison of proposed controllers with the classical control techniques To contribute to the ongoing research on predictive control, and to clearly distinguish this method from classical control techniques, comparison studies can be carried out. 2) Active damping of the LCL filters employed in the grid-connection The variable switching frequency operation with the FCS-MPC method causes grid current harmonics to spread over the whole spectrum. These harmonics cause more challenges for the operation of grid-connected converter even during normal operation. The proper design of predictive controller with LCL filters should be studied. 3) Investigation of other multilevel converters for wind energy Since the dc-link capacitor voltages are controlled by the intermediate dc-dc converter, other multilevel converter configurations can be used to reduce or completely eliminate the grid-side filter. 4) Operation of the proposed WECS under unbalanced grid voltage dips Investigation of PMSG-WECS behavior under unbalanced grid fault conditions and development of new control systems represent a very good research direction to meet the emerging grid code requirements. 5) Study of stability issues with the predictive control The stability issues with the FCS-MPC strategy should be studied by employing different discretization methods and prediction horizons. 6) Application of proposed control philosophies to other power electronic converters The generalized modeling and control approach presented in this dissertation can be extended to flying capacitor, active NPC and novel power electronic converters.

236

Appendix A List of Commercial Wind Turbines
The megawatt-level projects based on SCIG/PMSG/WRSG/HTS-SG which are in the development stage are summarized in Table. A.1.

Table A.1: Future development of full-scale converters based MW wind turbines
Manufacturer China Energine United Power Marvento Envision Energy Siemens XEMC-Darwind CSIC Goldwind Hyosung Gamesa AMSC-Hyundai Goldwind Siemens Alstom Power Nordex MingYang Condor Ltd. Bard GmbH Daewoo Ltd. Mitsubishi Siemens Vestas Clipper Sway Turbine AS AMSC GE Energy Model CE2 MW UP100 - 3000 M3.6 - 118 E128 - 3.6 MW SWT4.0 - 130 XE/DD115 CSIC5 MW GW5 MW Hyosung5 MW G128 - 5.0 MW HQ5500/140 GW6 MW SWT6.0 - 154 Haliade150 - 6 MW N150/6000 SCD6.5 Condor6 BARD6.5 DSME7.0 SeaAngel 7.0 MW SWT7.0 - 171 V164 - 8.0 MW Britannia ST10 SeaTitan GE15 MW Gear and Generator Direct Drive PMSG Direct Drive PMSG Direct Drive PMSG Dual Drive PMSG Geared SCIG PMSG PMSG Direct Drive PMSG PMSG Medium Speed PMSG PMSG Direct Drive PMSG Direct Drive PMSG Direct Drive PMSG Direct Drive PMSG PMSG Geared MV SCIG Dual Drive MV PMSG PMSG Dual Drive Brushless SG PMSG Medium Speed PMSG Quantum Drive PMSG Axial Flux PMSG Direct Drive HTS Direct Drive HTS Rating 2.0 MW 3.0 MW, 690 V 3.6 MW, 3900 V 1.9 MW×2, 730 V 4.0 MW 5.0 MW, 3000 V 5.0 MW 5.0 MW 5.0 MW 5.0 MW 5.5 MW 6.0 MW 6.0 MW, 690 V 6.0 MW, 900 V 6.0 MW, 3300 V 6.5 MW 6.6 MW, 3300 V 3.4 MW×2 7.0 MW 3.5 MW×2 7.0 MW, 3300V 8.0 MW 2.6 MW×4, 3600 V 10 MW, 3500 V 10 MW, 690 V 15 MW Rotor (m) 93 101 118 128 130 115 154 - 136 128 140 - 154 150 150 140 125 122 160 165 171 164 150 164 190 180 Release By 2014 - 2014 2014 2015 2014 - 2014 - 2014 2014 2014 2014 2014 2015 2014 2015 2014 2014 2015 2014 2016 2015 2015 2015 2016

237

The summary of few commercial wind turbines which use SCIG/PMSG/WRSG and full-scale power converters is given in Table A.2. Table A.2: List of commercial wind turbines using full-scale converters
Generator Power (MW) Gear Steps Height (m) Rotor Converter Figure Other (Supplier) Voltage (V) Gear Ratio Dia (m) Speed (rpm) (Supplier) Models M5000 PMSG 5.0 1 90 4.5 - 14.8 ABB PCS Fig. 2.5 M5000-135 (ABB) 3300 1 : 10 116 6000 E126/7580 WRSG 7.5 DD 135 5 - 11.7 2L­VSC Fig. 2.4 E126/7500, 690 1:1 127 7000,6000 Enercon GmbH E101/3000 WRSG 3.0 DD 99/135/ 4 - 14.5 2L­VSC Fig. 2.4 E82/3000 Germany 690 1:1 149; 101 E82/2000 WRSG 2.0 DD 75/85/98/ 6 - 18 2L­VSC Fig. 2.4 E66/2000 400 1:1 108/138; 82 E70/2000 WWD-1-D60 PMSG 1.0 1 56/66/70 8 - 26 2L­VSC Fig. 2.4 D56 WinWinD Ltd. (ABB) 690 -- 60 Finland WWD-3-D90 PMSG 3.0 2 80/88/90/ 5 - 18 2L­VSC Fig. 2.4 D100, D103 (ABB) 690 1 : 26.66 100; 90 D109, D120 Vensys70 PMSG 1.5 DD 65/85 9 - 19 Boost+ Fig. 2.11 77/82/87 690 1:1 70 2L­VSC Vensys AG Vensys100 PMSG 2.5 DD 100 6.5 - 14.5 2L­VSC Fig. 2.4 109/112 Germany 690 1:1 100 Vensys120 PMSG 3.0 DD 90/140 6.5 - 12.8 2L­VSC Fig. 2.4 112- 690 1:1 120 3000 G128 PMSG 4.5 2 81/120/140 448 2L­VSC Fig. 2.4 G136 Gamesa 690 1 : 37.88 128 Spain G128 - 5.0 PMSG 5.0 2 80/94 490 2L­VSC Fig. 2.4 G11X/5000 690 1 : 41.405 128 Avantis AV928 PMSG 2.5 DD 80/100 16 ABB ACS Fig. 2.4 China 690 1:1 93.2 800 Manufacturer Country AREVA Wind Germany Model

238

Appendix B System Modeling
In this Appendix, a brief description about various system models and notation employed in this dissertation is presented.

B.1

Notation of Per-Unit Values

The following notation is employed in representing per-unit (p.u.) values. The rated values of wind turbine or power converter are selected as base values. · Base apparent power SB represents the rated power of generator or power converter · Base active power PB represents the rated generator mechanical input power or rated converter output power · Base voltage VB represents the phase voltage of generator or grid · Base frequency B = 2f represents the rated frequency of generator or grid. · Base current IB =
SB 3×VB VB IB ZB B 1 B ×Z B VB B

· Base impedance ZB = · Base inductance LB =

· Base capacitance CB = · Base flux-linkage B = · Base torque TB =
PB B

239

B.2

Reference Frame Transformation

The reference frame theory helps to simplify the modeling, analysis, simulation and digital implementation of control schemes employed in the WECS. In this dissertation, the following three reference frames were used: · Natural reference frame (abc) · Stationary reference frame ( ) · Synchronous reference frame (dq ) The transformation of variables between these reference frames is presented below. The variable x represents either voltage, current or flux linkage.
1 x -1 2 1 - 2 2  = 3 0 23 - 23 x

  xa   ·  xb  xc

(B.1)

    1 0 xa    1 3  x ·  xb  = - 2 2  x 1 3 xc -2 - 2   xa   cos( - 23 ) cos( - 43 ) 2 cos   = ·  xb    3 -sin -sin( - 23 ) -sin( - 43 ) xc     cos -sin xa xd       ) -sin( - 23 ) ·  xb  = cos( - 23 xq   xc ) -sin( - 43 ) cos( - 43

(B.2)

xd xq

(B.3)

(B.4)

x cos -sin xd · = x xq sin cos

(B.5)

x xd cos sin · = -sin cos xq x 240

(B.6)

B.3

Wind Turbine Model

The model of the wind turbine is important for the study of the WECS response during dynamic changes in wind speed and also during grid faults. The model of the wind turbine also helps to effectively design MPPT algorithms. In this subsection, the model of the wind turbine is given with additional details about MATLAB/Simulink implementation. The mechanical output power of a wind turbine can be given as: PM = 1 3 Cp  A vw 2 (B.7)

where  is air density (typical value is 1.225 kg/m3 ), A is rotor swept area, and vw is wind speed velocity. Cp represents the power coefficient of a blade and it has a theoretical maximum value of 0.59 according to Betz limit. The Cp value varies between 0.2 and 0.5 for most of the MW-level commercial wind turbines. The Cp can be defined in terms of turbine coefficients C1 to C7 as: Cp = C1
C C2 - 6 - C 3  - C 4  2 - C 5 e  i + C 7 T i

(B.8)

where  is the pitch angle which is adjusted by the pitch control system according to the wind speed. The  value is zero when wind speed is below its rated value. T corresponds to optimal tip-speed-ratio (TSR) as defined below: T = T,op
 × rT nM,R × 2 60 = vw,R

(B.9)

where rT is radius of turbine, nM,R is rated speed of turbine, and vw,R is rated wind speed. The wind turbine operates at its optimal TSR (T,op ) during all the wind speed conditions. In (B.8), i is intermittent TSR and it is related to T and  as demonstrated below: 1 1 0.035 = - 3 . i T + 0.08  - 1 The turbine output torque can be estimated as: TM = PM M (B.11) (B.10)

where M is turbine shaft speed which can be estimated as follows: M = m rgb (B.12)

241

where m is measured generator speed and rgb is gearbox ratio. The MATLAB/Simulink model of a wind turbine is shown in Fig. B.1, where the inputs are wind speed velocity vw , pitch angle  and generator speed m , while the output is mechanical torque. The model given here can be used for SCIG, PMSG or WRSG. Fig. B.2 depicts the MATLAB/Simulink model of the pitch control system. This system maintains generator active power output at its rated value by producing suitable  value. Based on the measured generator output voltages and currents, the active power output is computed and its value is compared to the reference active power which is always 1.0 p.u.. The error is processed by a PI controller whose output value is  which is applied gradually (through a rate limiter) to the turbine. It is important to recall that the  value becomes more than 0 only when the generator output power exceeds its rated value.

Figure B.1: MATLAB/Simulink model of wind turbine.

Figure B.2: MATLAB/Simulink model of pitch control system.

242

B.4

Phase-Locked Loop (PLL) Model

The grid synchronization is one of the most important issues in WECS in order to allow the grid and grid-tied inverter to work in unison. PLL is a widely accepted method to generate the reference variable (grid voltage angle g ) for the grid synchronization. In this dissertation, three-phase symmetrical grid voltages are considered (vag + vbg + vcg = 0). The grid voltage angle g is also crucial in the transformation of variables between abc and dq frames, and in the operation of grid-side control system. For an ideal grid (used in the MATLAB simulations), the following method can be used to estimate g : v (B.13) g = tan-1 v where v and v are stationary frame grid voltages, and they can be estimated from the three-phase grid voltages using (B.1). A simplified model for the system is shown in Fig. B.3. In real-time, the grid voltages contain harmonics and they are distorted. In such cases, SRF-PLL can be used as shown in Fig. B.4. This method uses a PI controller to force the q -axis grid voltage vqg to zero value. A feed-forward frequency term g (= 2fg ) is added to the output of the PI controller to improve initial dynamic performance. An integrator is then employed to convert g to g . To ensure that the g changes between 0 and 2 , a modulus function is used.

Figure B.3: Simplified model for grid voltage angle estimation.

Figure B.4: Standard SRF-PLL model for grid voltage angle estimation.

243

Appendix C Performance Assessment
In order to assess the performance of FCS-MPC scheme, various parameters are defined in this appendix. The percentage mean absolute current reference tracking error %eig is defined as the absolute difference between the reference and load/grid currents with respect to the rms value of load/grid current: %eig =
1 m m k =0

i g (k ) - ig (k ) × 100 rms(ig (k ))

(C.1)

where m represents number of samples. In the simulation and experimental tests, 25000 samples are considered, which corresponds to 15 fundamental cycles. Similarly, the active and reactive power tracking errors are defined with respect to the base apparent power Sg as: %epg = %eqg =
1 m 1 m m k =0 m k =0

Pg (k ) - Pg (k ) × 100 Sg Q g (k ) - Qg (k ) × 100. Sg

(C.2) (C.3)

The percentage mean absolute dc-link capacitor voltages deviation %evc is formulated for 3L converter as: m 1 |vc1 (k ) - vc2 (k )| %evc = m k=0 × 100. (C.4)  vdc For a 4L-converter, the %evc is determined as follows: %evc =
1 m m k =0 i=1,2,3, j =2,3,1 |vci (k )  3 × vdc

- vcj (k )|

× 100.

(C.5)

244

A similar approach can be used to calculate capacitor voltages deviations in other multilevel converters. The percentage of total harmonic distortion (THD) is described as follows: 1 % THD = · 3 x=a,b,c
2 2 i2 2,x + i3,x + .. + in,x

i1,x

× 100

(C.6)

where in,x and i1,x are nth order harmonic and fundamental components of phase-x load/grid currents, respectively. The average device switching frequency of a 3L-converter is calculated below: fsw = fsw,1x + fsw,2x . 6 x=a,b,c (C.7)

The switching frequency of each upper switch is calculated by measuring the number of switching changes in the gating signals for 15 fundamental cycles. Similarly, for a 4Lconverter, the average switching frequency is calculated as: fsw = fsw,1x + fsw,2x + fsw,3x . 9 x=a,b,c (C.8)

The switching frequencies of other multilevel converters can be calculated in a similar manner.

245

Bibliography
[1] Renewable Energy Policy Network for the 21st Centuray (REN21), "Renewables global status report," 2013, available at: http://www.ren21.net, accessed on Aug. 2013. [2] B. Wu, Y. Lang, N. Zargari, and S. Kouro, Power Conversion and Control of Wind Energy Systems, 1st ed., ser. IEEE Press Series on Power Engineering. Hoboken, NJ: John Wiley & Sons, Inc., Jul. 2011. [3] M. Liserre, R. Cardenas, M. Molinas, and J. Rodriguez, "Overview of multi-MW wind turbines and wind parks," IEEE Trans. Ind. Electron., vol. 58, no. 4, pp. 1081­1095, Apr. 2011. [4] F. Blaabjerg and K. Ma, "Future on power electronics for wind turbine systems," IEEE J. Emerging and Selected Topics in Power Electron., vol. 1, no. 3, pp. 139­152, Sep. 2013. [5] Global Wind Energy Council (GWEC), "Wind report," 2012, available at: http://www.gwec.net, accessed on Aug. 2013. [6] F. Blaabjerg and Z. Chen, Power Electronics for Modern Wind Turbines., ser. Synthesis Lectures on Power Electronics. Morgan & Claypool Publishers, 2006. [7] H. Polinder, F. van der Pijl, G.-J. de Vilder, and P. Tavner, "Comparison of direct-drive and geared generator concepts for wind turbines," IEEE Trans. Energy Convers., vol. 21, no. 3, pp. 725­733, 2006. [8] F. Blaabjerg, M. Liserre, and K. Ma, "Power electronics converters for wind turbine systems," IEEE Trans. Ind. Appl., vol. 48, no. 2, pp. 708­719, Mar. 2012. [9] Z. Chen, J. Guerrero, and F. Blaabjerg, "A review of the state of the art of power electronics for wind turbines," IEEE Trans. Power Electron., vol. 24, no. 8, pp. 1859­1875, Aug. 2009. [10] A. Rockhill, M. Liserre, R. Teodorescu, and P. Rodriguez, "Grid-filter design for a multimegawatt medium-voltage voltage-source inverter," IEEE Trans. Ind. Electron., vol. 58, no. 4, pp. 1205­1217, Apr. 2011. [11] W. Erdman and M. Behnke, Low Wind Speed Turbine Project Phase II: The Application of Medium-Voltage Electrical Apparatus to the Class of Variable Speed Multi-Megawatt Low Wind Speed Turbines. National Renewable Energy Laboratory (N.R.E.L.), 2012. [12] M. Tsili and S. Papathanassiou, "A review of grid code technical requirements for wind farms," IET Renew. Power Gener., vol. 3, no. 3, pp. 308­332, Sep. 2009. [13] A. D. H. F. Iov, P. Sorensen, and N. A. Cutululis, "Mapping of grid faults and grid codes," Riso Nat. Lab., Tech. Univ. Denmark, Roskilde, Denmark, Tech. Rep. Riso-R-1617(EN), Jul. 2007. [14] R. Teodorescu, M. Liserre, and P. Rodriguez, Grid Converters for Photovoltaic and Wind Power Systems. UK: Wiley-IEEE Press, Jan. 2011. Chichester,

[15] M. Altin, O. Goksu, R. Teodorescu, P. Rodriguez, B.-B. Jensen, and L. Helle, "Overview of recent grid codes for wind power integration," in Int. Conf. on Optimization of Elect. and Electron. Equipment (OPTIM), 2010, pp. 1152­1160. [16] J. Carrasco, L. Franquelo, J. Bialasiewicz, E. Galvan, R. Guisado, M. Prats, J. Leon, and N. Moreno-Alfonso, "Powerelectronic systems for the grid integration of renewable energy sources: A survey," IEEE Trans. Ind. Electron., vol. 53, no. 4, pp. 1002­1016, Jun. 2006. [17] E.ON Netz Gmbh, "Grid code - high and extra high voltage," Apr. 2006, available at: http://www.thewindpower.net. [18] R. A. Ibrahim, M. S. Hamad, Y. Dessouky, and B. Williams, "A review on recent low voltage ride-through solutions for PMSG wind turbine," in IEEE Int. Symp. on Power Electron., Elect. Drives, Automat. and Motion (SPEEDAM), 2012, pp. 265­270.

246

[19] S. Alepuz, S. Busquets, J. Bordonau, J. Pontt, C. Silva, and J. Rodriguez, "Comparison of control strategies to meet low voltage ride-through requirements in distributed power generation systems," in IEEE Int. Symp. on Ind. Electron. (ISIE), 2007, pp. 2619­2624. [20] R. Cardenas, R. Pena, S. Alepuz, and G. Asher, "Overview of control systems for the operation of DFIGs in wind energy applications," IEEE Trans. Ind. Electron., vol. 60, no. 7, pp. 2776­2798, 2013. [21] A. Teninge, D. Roye, S. Bacha, and J. Duval, "Low voltage ride-through capabilities of wind plant combining different turbine technologies," in IEEE Eur. Conf. on Power Electron. and Appl. (EPE), 2009, pp. 1­9. [22] J. Rong, S. Xinfu, and L. Jun, "Research on low voltage ride through technology for symmetrical grid fault," in Int. Conf. on Sustainable Power Generation and Supply (SUPERGEN), 2009, pp. 1­6. [23] G. Joos, "Wind turbine generator low voltage ride through requirements and solutions," in IEEE Power Eng. Soc. (PES) General Meeting, 2008, pp. 1­7. [24] F. Blaabjerg, Z. Chen, and S. Kjaer, "Power electronics as efficient interface in dispersed power generation systems," IEEE Trans. Power Electron., vol. 19, no. 5, pp. 1184­1194, Sep. 2004. [25] Y. Duan and R. Harley, "Present and future trends in wind turbine generator designs," in IEEE Symp. on Power Electron. and Mach. in Wind Applicat. (PEMWA), Jun. 2009, pp. 1­6. [26] X. Yang, D. Patterson, and J. Hudgins, "Permanent magnet generator design and control for large wind turbines," in IEEE Symp. on Power Electron. and Mach. in Wind Applicat. (PEMWA), 2012, pp. 1­5. [27] H. Li and Z. Chen, "Overview of different wind generator systems and their comparisons," IET Renew. Power Gener., vol. 2, no. 2, pp. 123­138, Jun. 2008. [28] J. Dixon, L. Moran, J. Rodriguez, and R. Domke, "Reactive power compensation technologies: State-of-the-art review," Proc. IEEE, vol. 93, no. 12, pp. 2144­2164, 2005. [29] S. Papathanassiou and M. Papadopoulos, "Mechanical stresses in fixed-speed wind turbines due to network disturbances," IEEE Trans. Energy Convers., vol. 16, no. 4, pp. 361­367, Dec. 2001. [30] M. Slepchenkov, K. Smedley, and J. Wen, "Hexagram-converter-based STATCOM for voltage support in fixed-speed wind turbine generation systems," IEEE Trans. Ind. Electron., vol. 58, no. 4, pp. 1120­1131, Apr. 2011. [31] M. Khadraoui and M. Elleuch, "Comparison between optislip and fixed speed wind energy conversion systems," in IEEE Int. Multi-Conf. on Syst. Signals and Devices (SSD), 2008, pp. 1­6. [32] D. J. Burnham, S. Santoso, and E. Muljadi, "Variable rotor-resistance control of wind turbine generators," in IEEE Power Eng. Soc. (PES) General Meeting, 2009, pp. 1­6. [33] P. Jatinkumar, S. Gupta, and S. Singh, "Comparison of control techniques for rotor current control of line-excited slip-ring IG for WECS," in Int. Conf. on Comput. Intelligence and Commun. Networks (CICN), 2010, pp. 669­674. [34] J. Lopez, P. Sanchis, X. Roboam, and L. Marroyo, "Dynamic behavior of the doubly fed induction generator during three-phase voltage dips," IEEE Trans. Energy Convers., vol. 22, no. 3, pp. 709­717, 2007. [35] R. Pena, J. Clare, and G. Asher, "Doubly fed induction generator using back-to-back PWM converters and its application to variable-speed wind-energy generation," IEE Proc. Electr. Power Appl., vol. 143, no. 3, pp. 231­241, 1996. [36] S. Muller, M. Deicke, and R. De Doncker, "Doubly fed induction generator systems for wind turbines," IEEE Ind. Appl. Mag., vol. 8, no. 3, pp. 26­33, 2002. [37] L. Xu and P. Cartwright, "Direct active and reactive power control of DFIG for wind energy generation," IEEE Trans. Energy Convers., vol. 21, no. 3, pp. 750­758, 2006. [38] J. Ekanayake and N. Jenkins, "Comparison of the response of doubly fed and fixed-speed induction generator wind turbines to changes in network frequency," IEEE Trans. Energy Convers., vol. 19, no. 4, pp. 800­802, 2004. [39] L. Holdsworth, X. Wu, J. Ekanayake, and N. Jenkins, "Comparison of fixed speed and doubly-fed induction wind turbines during power system disturbances," IET Gener. Transm. Distrib., vol. 150, no. 3, pp. 343­352, 2003. [40] P. Flannery and G. Venkataramanan, "A fault tolerant doubly fed induction generator wind turbine using a parallel grid side rectifier and series grid side converter," IEEE Trans. Power Electron., vol. 23, no. 3, pp. 1126­1135, 2008. [41] M. Chinchilla, S. Arnaltes, and J. Burgos, "Control of permanent-magnet generators applied to variable-speed windenergy systems connected to the grid," IEEE Trans. Energy Convers., vol. 21, no. 1, pp. 130­135, 2006.

247

[42] H. Geng, D. Xu, B. Wu, and G. Yang, "Active damping for PMSG-based WECS with DC-link current estimation," IEEE Trans. Ind. Electron., vol. 58, no. 4, pp. 1110­1119, 2011. [43] S. Li, T. Haskew, R. Swatloski, and W. Gathings, "Optimal and direct-current vector control of direct-driven PMSG wind turbines," IEEE Trans. Power Electron., vol. 27, no. 5, pp. 2325­2337, May. 2012. [44] H. Geng, G. Yang, D. Xu, and B. Wu, "Unified power control for PMSG-based WECS operating under different grid conditions," IEEE Trans. Energy Convers., vol. 26, no. 3, pp. 822­830, 2011. [45] E. Bueno, S. Cobreces, F. Rodriguez, A. Hernandez, and F. Espinosa, "Design of a back-to-back NPC converter interface for wind turbines with squirrel-cage induction generator," IEEE Trans. Energy Convers., vol. 23, no. 3, pp. 932­945, 2008. [46] D. Alexa, I. Pletea, A. Sirbu, and A. Lazar, "Wind energy conversion into electricity by means of the rectifier with near sinusoidal input current-1 converter," IET Renew. Power Gener., vol. 7, no. 5, pp. 1­1, 2013. [47] J. Wang, D. Xu, B. Wu, and Z. Luo, "A low-cost rectifier topology for variable-speed high-power PMSG wind turbines," IEEE Trans. Power Electron., vol. 26, no. 8, pp. 2192­2200, 2011. [48] V. Agarwal, R. Aggarwal, P. Patidar, and C. Patki, "A novel scheme for rapid tracking of maximum power point in wind energy generation systems," IEEE Trans. Energy Convers., vol. 25, no. 1, pp. 228­236, 2010. [49] J. Dai, D. Xu, and B. Wu, "A novel control scheme for current-source-converter-based PMSG wind energy conversion systems," IEEE Trans. Power Electron., vol. 24, no. 4, pp. 963­972, Apr. 2009. [50] M. Haque, M. Negnevitsky, and K. Muttaqi, "A novel control strategy for a variable-speed wind turbine with a permanentmagnet synchronous generator," IEEE Trans. Ind. Appl., vol. 46, no. 1, pp. 331­339, 2010. [51] K. Tan and S. Islam, "Optimum control strategies in energy conversion of PMSG wind turbine system without mechanical sensors," IEEE Trans. Energy Convers., vol. 19, no. 2, pp. 392­399, 2004. [52] K.-H. Kim, Y.-C. Jeung, D.-C. Lee, and H.-G. Kim, "LVRT scheme of PMSG wind power systems based on feedback linearization," IEEE Trans. Power Electron., vol. 27, no. 5, pp. 2376­2384, 2012. [53] J. Conroy and R. Watson, "Frequency response capability of full converter wind turbine generators in comparison to conventional generation," IEEE Trans. Power Syst., vol. 23, no. 2, pp. 649­656, 2008. [54] S. Zhang, K.-J. Tseng, D. Vilathgamuwa, T. D. Nguyen, and X.-Y. Wang, "Design of a robust grid interface system for PMSG-based wind turbine generators," IEEE Trans. Ind. Electron., vol. 58, no. 1, pp. 316­328, 2011. [55] Erneuerbare Energien (Renewable Energy), "Wind turbine market," 2010, Special Rep. [56] Wind Turbines and Wind Farms Database, "Turbines list," available at: http://www.thewindpower.net, accessed on Jul. 2013. [57] The Portal of Wind Turbines and Models, "Wind turbines," available at: http://en.wind-turbine-models.com, accessed on Jul. 2013. [58] 4 C Offshore, "Offshore turbine database," available at: http://www.4coffshore.com, accessed on Jul. 2013. [59] L. Greedy, "Review of electric drive-train topologies," Garrad Hassan and Partners Ltd., 11593/BR/01, May. 2007, available at: http://www.upwind.eu. [60] J. Li, S. Bhattacharya, and A. Huang, "A new nine-level active NPC (ANPC) converter for grid connection of large wind turbines for distributed generation," IEEE Trans. Power Electron., vol. 26, no. 3, pp. 961­972, Mar. 2011. [61] J. Rodriguez, S. Bernet, P. Steimer, and I. Lizama, "A survey on neutral-point-clamped inverters," IEEE Trans. Ind. Electron., vol. 57, no. 7, pp. 2219­2230, Jul. 2010. [62] A. Faulstich, J. Stinke, and F. Wittwer, "Medium voltage converter for permanent magnet wind power generators up to 5MW," in IEEE Eur. Conf. on Power Electron. and Appl. (EPE), 2005, pp. P.1­P.9. [63] P. Maibach, A. Faulstich, M. Eichler, and S. Dewar, "Full-scale medium-voltage converters for wind power generators up to 7 MVA," 2010, available at: http://www.abb.com. [64] A. Yazdani and R. Iravani, "A neutral-point clamped converter system for direct-drive variable-speed wind power unit," IEEE Trans. Energy Convers., vol. 21, no. 2, pp. 596­607, 2006.

248

[65] O. Senturk, L. Helle, S. Munk-Nielsen, P. Rodriguez, and R. Teodorescu, "Medium voltage three-level converters for the grid connection of a multi-MW wind turbine," in IEEE Eur. Conf. on Power Electron. and Appl. (EPE), 2009, pp. 1­8. [66] X. Zeng, Z. Chen, and F. Blaabjerg, "Design and comparison of full-size converters for large variable-speed wind turbines," in IEEE Eur. Conf. on Power Electron. and Appl. (EPE), 2007, pp. 1­10. [67] S. Alepuz, A. Calle, S. Busquets-Monge, S. Kouro, and B. Wu, "Use of stored energy in PMSG rotor inertia for lowvoltage ride-through in back-to-back NPC converter-based wind power systems," IEEE Trans. Ind. Electron., vol. 60, no. 5, pp. 1787­1796, 2013. [68] A. Di Gerlando, G. Foglia, M. Iacchetti, and R. Perini, "Analysis and test of diode rectifier solutions in grid-connected wind energy conversion systems employing modular permanent-magnet synchronous generators," IEEE Trans. Ind. Electron., vol. 59, no. 5, pp. 2135­2146, May. 2012. [69] J. Suul, A. Luna, P. Rodriguez, and T. Undeland, "Virtual-flux-based voltage-sensor-less power control for unbalanced grid conditions," IEEE Trans. Power Electron., vol. 27, no. 9, pp. 4071­4087, Sep. 2012. [70] J. Hu and Z. Zhu, "Investigation on switching patterns of direct power control strategies for grid-connected DC-AC converters based on power variation rates," IEEE Trans. Power Electron., vol. 26, no. 12, pp. 3582­3598, Dec. 2011. [71] A. Bouafia, J. Gaubert, and F. Krim, "Predictive direct power control of three-phase pulsewidth modulation (PWM) rectifier using space-vector modulation (SVM)," IEEE Trans. Power Electron., vol. 25, no. 1, pp. 228­236, Jan. 2010. [72] V. Yaramasu and B. Wu, "Three-level boost converter based medium voltage megawatt PMSG wind energy conversion systems," in IEEE Energy Conversion Congr. and Expo. (ECCE), Sep. 2011, pp. 561­567, Phoenix, AZ, USA. [73] M. Duran, S. Kouro, B. Wu, E. Levi, F. Barrero, and S. Alepuz, "Six-phase PMSG wind energy conversion system based on medium-voltage multilevel converter," in IEEE Eur. Conf. on Power Electron. and Appl. (EPE), Sep. 2011, pp. 1­10. [74] S. Kouro, B. La Rocca, P. Cortes, S. Alepuz, B. Wu, and J. Rodriguez, "Predictive control based selective harmonic elimination with low switching frequency for multilevel converters," in IEEE Energy Conversion Congr. and Expo. (ECCE), Sep. 2009, pp. 3130­3136, San Jose, CA, USA. [75] S. Kouro, P. Cortes, R. Vargas, U. Ammann, and J. Rodriguez, "Model predictive control-A simple and powerful method to control power converters," IEEE Trans. Ind. Electron., vol. 56, no. 6, pp. 1826­1838, Jun. 2009. [76] Q. Zeng and L. Chang, "An advanced SVPWM-based predictive current controller for three-phase inverters in distributed generation systems," IEEE Trans. Ind. Electron., vol. 55, no. 3, pp. 1235­1246, Mar. 2008. [77] J. Rodriguez and P. Cortes, Predictive Control of Power Converters and Electrical Drives, 1st ed. IEEE Wiley press, Mar. 2012. Chichester, UK:

[78] P. Cortes, M. Kazmierkowski, R. Kennel, D. Quevedo, and J. Rodriguez, "Predictive control in power electronics and drives," IEEE Trans. Ind. Electron., vol. 55, no. 12, pp. 4312­4324, Dec. 2008. [79] J. Rodriguez, M. P. Kazmierkowski, J. R. Espinoza, P. Zanchetta, H. Abu-Rub, H. A. Young, and C. A. Rojas, "State of the art of finite control set model predictive control in power electronics," IEEE Trans. Ind. Informat., vol. 9, no. 2, pp. 1003­1016, May. 2013. [80] V. Yaramasu and B. Wu, "A model predictive decoupled active and reactive power control for high power grid-connected four-level diode-clamped inverters," IEEE Trans. Ind. Electron., vol. PP, no. 99, pp. 1­1, 2013, [early access article, DOI: 10.1109/TIE.2013.2278959]. [81] V. Yaramasu, B. Wu, and J. Chen, "Model predictive control of grid-tied four-level diode-clamped inverters for high power wind energy conversion systems," IEEE Trans. Power Electron., vol. PP, no. 99, pp. 1­1, 2013, [early access article, DOI: 10.1109/TPEL.2013.2276120]. [82] K. Ma, F. Blaabjerg, and M. Liserre, "Thermal analysis of multilevel grid-side converters for 10-MW wind turbines under low-voltage ride through," IEEE Trans. Ind. Appl., vol. 49, no. 2, pp. 909­921, 2013. [83] J. Pou, R. Pindado, and D. Boroyevich, "Voltage-balance limits in four-level diode-clamped converters with passive front ends," IEEE Trans. Ind. Electron., vol. 52, no. 1, pp. 190­196, Feb. 2005. [84] B. Wu, High-power converters and AC drives, 1st ed., ser. Wiley-IEEE Press. John Wiley & Sons, Inc., 2006.

[85] W. Xin, C. Mingfeng, Q. Li, C. Lulu, and Q. Bin, "Control of direct-drive permanent-magnet wind power system gridconnected using back-to-back PWM converter," in Int. Conf. on Intelligent Syst. Design and Eng. Appl. (ISDEA), 2013, pp. 478­481.

249

[86] Z. Chen and E. Spooner, "Grid interface options for variable-speed, permanent-magnet generators," IEE Proc. Electr. Power Appl., vol. 145, no. 4, pp. 273­283, 1998. [87] B. Kedjar and K. Al-Haddad, "Optimal control of a grid connected variable speed wind energy conversion system based on squirrel cage induction generator," in IEEE Ind. Electron. Conf. (IECON), 2012, pp. 3560­3565. [88] J. Ferreira, I. R. Machado, E. Watanabe, and L. G. B. Rolim, "Wind power system based on squirrel cage induction generator," in Brazilian Power Electron. Conf. (COBEP), 2011, pp. 943­948. [89] Semikron, "Power modules," Dec. 2012, available at: http://www.semikron.com, accessed on Aug. 2013. [90] D. Schreiber, "New power semiconductor technology for renewable energy sources application," May. 2005, Sevilla (Online Report). [91] Z. Xu, R. Li, H. Zhu, D. Xu, and C. Zhang, "Control of parallel multiple converters for direct-drive permanent-magnet wind power generation systems," IEEE Trans. Power Electron., vol. 27, no. 3, pp. 1259­1270, Mar. 2012. [92] S. Kouro, J. Rodriguez, B. Wu, S. Bernet, and M. Perez, "Powering the future of industry: High-power adjustable speed drive topologies," IEEE Ind. Appl. Mag., vol. 18, no. 4, pp. 26­39, 2012. [93] S. Alepuz, S. Busquets-Monge, J. Bordonau, J. Gago, D. Gonzalez, and J. Balcells, "Interfacing renewable energy sources to the utility grid using a three-level inverter," IEEE Trans. Ind. Electron., vol. 53, no. 5, pp. 1504­1511, Oct. 2006. [94] M. Malinowski, S. Stynski, W. Kolomyjski, and M. Kazmierkowski, "Control of three-level PWM converter applied to variable-speed-type turbines," IEEE Trans. Ind. Electron., vol. 56, no. 1, pp. 69­77, Jan. 2009. [95] S. Alepuz, S. Busquets-Monge, J. Bordonau, J. Martinez-Velasco, C. Silva, J. Pontt, and J. Rodriguez, "Control strategies based on symmetrical components for grid-connected converters under voltage dips," IEEE Trans. Ind. Electron., vol. 56, no. 6, pp. 2162­2173, Jun. 2009. [96] Z. Shu, X. He, Z. Wang, D. Qiu, and Y. Jing, "Voltage balancing approaches for diode-clamped multilevel converters using auxiliary capacitor-based circuits," IEEE Trans. Power Electron., vol. 28, no. 5, pp. 2111­2124, May. 2013. [97] J. Pou, J. Zaragoza, S. Ceballos, M. Saeedifard, and D. Boroyevich, "A carrier-based PWM strategy with zero-sequence voltage injection for a three-level neutral-point-clamped converter," IEEE Trans. Power Electron., vol. 27, no. 2, pp. 642­651, Feb. 2012. [98] N. Celanovic and D. Boroyevich, "A fast space-vector modulation algorithm for multilevel three-phase converters," IEEE Trans. Ind. Appl., vol. 37, no. 2, pp. 637­641, Mar. 2001. [99] J. Fernando Silva, N. Rodrigues, and J. Costa, "Space vector alpha-beta sliding mode current controllers for three-phase multilevel inverters," in IEEE Power Electron. Spec. Conf. (PESC), vol. 1, 2000, pp. 133­138. [100] R. S. Kanchan, K. Gopakumar, and R. Kennel, "Synchronised carrier-based SVPWM signal generation scheme for the entire modulation range extending up to six-step mode using the sampled amplitudes of reference phase voltages," IEE Proc. Electr. Power Appl., vol. 1, no. 3, pp. 407­415, 2007. [101] M. Saeedifard, A. Bakhshai, and G. Joos, "Low switching frequency space vector modulators for high power multimodule converters," IEEE Trans. Power Electron., vol. 20, no. 6, pp. 1310­1318, 2005. [102] A. Gopinath, A. Mohamed, and M. R. Baiju, "Fractal based space vector PWM for multilevel inverters ­ a novel approach," IEEE Trans. Ind. Electron., vol. 56, no. 4, pp. 1230­1237, 2009. [103] S. Mekhilef and M. Abdul Kadir, "Voltage control of three-stage hybrid multilevel inverter using vector transformation," IEEE Trans. Power Electron., vol. 25, no. 10, pp. 2599­2606, 2010. [104] J. Leon, S. Vazquez, R. Portillo, L. Franquelo, J. Carrasco, P. Wheeler, and A. Watson, "Three-dimensional feedforward space vector modulation applied to multilevel diode-clamped converters," IEEE Trans. Ind. Electron., vol. 56, no. 1, pp. 101­109, 2009. [105] M. Aneesh, A. Gopinath, and M. R. Baiju, "A simple space vector PWM generation scheme for any general n ­ level inverter," IEEE Trans. Ind. Electron., vol. 56, no. 5, pp. 1649­1656, 2009. [106] S. Kouro, M. Malinowski, K. Gopakumar, J. Pou, L. Franquelo, B. Wu, J. Rodriguez, M. Perez, and J. Leon, "Recent advances and industrial applications of multilevel converters," IEEE Trans. Ind. Electron., vol. 57, no. 8, pp. 2553­2580, Aug. 2010. [107] V. Yaramasu and B. Wu, "Predictive power control of grid-connected four-level inverters in stationary reference frame," in IEEE Int. Conf. on Circuits, Power and Computing Tech. (ICCPCT), Mar. 2013, pp. 636­641, Kumaracoil, India.

250

[108] M. Saeedifard, R. Iravani, and J. Pou, "A space vector modulation approach for a back-to-back connected four-level converter," in IEEE Power Electron. Spec. Conf. (PESC), Jun. 2007, pp. 2043­2049. [109] D. Andler, M. Perez, J. Rodriguez, and S. Bernet, "Predictive control of three-level active NPC converter with evenly energy losses distribution," in Int. Power Electron. Conf. (IPEC), 2010, pp. 754­759. [110] K. Antoniewicz, M. Jasinski, and S. Stynski, "Flying capacitor converter as a wind turbine interface ­ modulation and MPPT issues," in IEEE Int. Symp. on Ind. Electron. (ISIE), 2012, pp. 1985­1990. [111] S. Jayasinghe and D. Vilathgamuwa, "Flying supercapacitors as power smoothing elements in wind generation," IEEE Trans. Ind. Electron., vol. 60, no. 7, pp. 2909­2918, 2013. [112] B. Wu, J. Pontt, J. Rodriguez, S. Bernet, and S. Kouro, "Current-source converter and cycloconverter topologies for industrial medium-voltage drives," IEEE Trans. Ind. Electron., vol. 55, no. 7, pp. 2786­2797, Jul. 2008. [113] Y. Xia, J. Fletcher, S. Finney, K. Ahmed, and B. Williams, "Torque ripple analysis and reduction for wind energy conversion systems using uncontrolled rectifier and boost converter," IET Renew. Power Gener., vol. 5, no. 5, pp. 377­386, 2011. [114] Y. Xia, K. Ahmed, and B. Williams, "Different torque ripple reduction methods for wind energy conversion systems using diode rectifier and boost converter," in IEEE Int. Electric Mach. and Drives Conf. (IEMDC), 2011, pp. 729­734. [115] K. Ohyama, S. Arinaga, and Y. Yamashita, "Modeling and simulation of variable speed wind generator system using boost converter of permanent magnet synchronous generator," in IEEE Eur. Conf. on Power Electron. and Appl. (EPE), 2007, pp. 1­9. [116] R. Sharma, T. Rasmussen, and B. Jensen, "Application of a synchronous generator with a boost converter in wind turbines: an experimental overview," IET Renew. Power Gener., vol. 6, no. 6, pp. 414­423, 2012. [117] W. Shi, H. Liang, and J. Jiang, "Analysis and implementation of instantaneous current control for multiple boost converter in WECS," in IEEE Appl. Power Electron. Conf. Expo. (APEC), 2008, pp. 1490­1495. [118] J.-M. Kwon, B.-H. Kwon, and K.-H. Nam, "Three-phase photovoltaic system with three-level boosting MPPT control," IEEE Trans. Power Electron., vol. 23, no. 5, pp. 2319­2327, 2008. [119] K. Corzine and S. Majeethia, "Analysis of a novel four-level dc/dc boost converter," IEEE Trans. Ind. Appl., vol. 36, no. 5, pp. 1342­1350, 2000. [120] J. Wang, J. Dai, B. Wu, D. Xu, and N. Zargari, "Megawatt wind energy conversion system with diode rectifier and multilevel current source inverter," in IEEE Energy Conversion Congr. and Expo. (ECCE), Sep. 2011, pp. 871­876. [121] J. Dai, J. Wang, B. Wu, D. Xu, and N. Zargari, "Low cost current source converter solutions for variable speed wind energy conversion systems," in IEEE Int. Electric Mach. and Drives Conf. (IEMDC), May. 2011, pp. 825­830. [122] X. Tan, J. Dai, and B. Wu, "A novel converter configuration for wind applications using PWM CSI with diode rectifier and buck converter," in IEEE Int. Electric Mach. and Drives Conf. (IEMDC), May. 2011, pp. 359­364. [123] S. Pulikanti, K. Muttaqi, and D. Suntanto, "Control of five-level flying capacitor based active-neutral-point-clamped converter for grid connected wind energy applications," in IEEE Ind. Appl. Soc. (IAS) Annu. Meeting, 2012, pp. 1­9. [124] X. Xin and L. Hui, "Research on multiple boost converter based on MW-level wind energy conversion system," in Int. Conf. on Elect. Mach. and Syst. (ICEMS), vol. 2, 2005, pp. 1046­1049. [125] G. Estay, L. Vattuone, S. Kouro, M. Duran, and B. Wu, "Dual-boost-NPC converter for a dual three-phase PMSG wind energy conversion system," in IEEE Int. Conf. on Power Electron., Drives and Energy Syst. (PEDES), 2012, pp. 1­6. [126] H. S. Che, W. P. Hew, N. Rahim, E. Levi, M. Jones, and M. Duran, "A six-phase wind energy induction generator system with series-connected DC-links," in IEEE Int. Symp. on Power Electron. for Distributed Generation Syst. (PEDG), 2012, pp. 26­33. [127] M. Zhang, B. Wu, Y. Xiao, F. Dewinter, and R. Sotudeh, "A multilevel buck converter based rectifier with sinusoidal inputs and unity power factor for medium voltage (4160-7200 V) applications," IEEE Trans. Power Electron., vol. 17, no. 6, pp. 853­863, 2002. [128] X. Yuan, J. Chai, and Y. Li, "A transformer-less high-power converter for large permanent magnet wind generator systems," IEEE Trans. Sustainable Energy, vol. 3, no. 3, pp. 318­329, 2012. [129] M. Parker, C. Ng, and L. Ran, "Fault-tolerant control for a modular generator-converter scheme for direct-drive wind turbines," IEEE Trans. Ind. Electron., vol. 58, no. 1, pp. 305­315, 2011.

251

[130] J. Rodriguez, L. Franquelo, S. Kouro, J. Leon, R. Portillo, M. Prats, and M. Perez, "Multilevel converters: An enabling technology for high-power applications," Proc. IEEE, vol. 97, no. 11, pp. 1786­1817, Nov. 2009. [131] J. Rodriguez, S. Bernet, B. Wu, J. Pontt, and S. Kouro, "Multilevel voltage-source-converter topologies for industrial medium-voltage drives," IEEE Trans. Ind. Electron., vol. 54, no. 6, pp. 2930­2945, Dec. 2007. [132] L. Franquelo, J. Rodriguez, J. Leon, S. Kouro, R. Portillo, and M. Prats, "The age of multilevel converters arrives," IEEE Ind. Electron. Mag., vol. 2, no. 2, pp. 28­39, Jun. 2008. [133] M. Marchesoni and M. Mazzucchelli, "Multilevel converters for high power AC drives: a review," in IEEE Int. Symp. on Ind. Electron. (ISIE), 1993, pp. 38­43. [134] F. Peng, W. Qian, and D. Cao, "Recent advances in multilevel converter/inverter topologies and applications," in Int. Power Electron. Conf. (IPEC), Jun. 2010, pp. 492­501. [135] Y. Shakweh and E. Lewis, "Assessment of medium voltage PWM VSI topologies for multi-megawatt variable speed drive applications," in IEEE Power Electron. Spec. Conf. (PESC), vol. 2, 1999, pp. 965­971. [136] J. Rodriguez, J. Pontt, R. Huerta, G. Alzamora, N. Becker, S. Kouro, P. Cortes, and P. Lezana, "Resonances in a high-power active-front-end rectifier system," IEEE Trans. Ind. Electron., vol. 52, no. 2, pp. 482­488, 2005. [137] J. Rodriguez, J. Pontt, C. Silva, E. Wiechmann, P. Hammond, F. Santucci, R. Alvarez, R. Musalem, S. Kouro, and P. Lezana, "Large current rectifiers: State of the art and future trends," IEEE Trans. Ind. Electron., vol. 52, no. 3, pp. 738­746, 2005. [138] R. Osman, "A medium-voltage drive utilizing series-cell multilevel topology for outstanding power quality," in IEEE Ind. Appl. Soc. (IAS) Annu. Meeting, vol. 4, 1999, pp. 2662­2669. [139] S. Tenconi, M. Carpita, C. Bacigalupo, and R. Cali, "Multilevel voltage source converters for medium voltage adjustable speed drives," in IEEE Int. Symp. on Ind. Electron. (ISIE), vol. 1, 1995, pp. 91­98. [140] A. Chattopadhyay, "High power high performance industrial AC drives - A technology status review," in IEEE Int. Conf. on Ind. and Inform. Syst. (ICIIS), Dec. 2008, pp. 1­2. [141] D. Krug, S. Bernet, S. Fazel, K. Jalili, and M. Malinowski, "Comparison of 2.3-kv medium-voltage multilevel converters for industrial medium-voltage drives," IEEE Trans. Ind. Electron., vol. 54, no. 6, pp. 2979­2992, Dec. 2007. [142] L. Tolbert, F. Z. Peng, and T. Habetler, "Multilevel converters for large electric drives," IEEE Trans. Ind. Appl., vol. 35, no. 1, pp. 36­44, 1999. [143] S. Kjaer, J. Pedersen, and F. Blaabjerg, "A review of single-phase grid-connected inverters for photovoltaic modules," IEEE Trans. Ind. Appl., vol. 41, no. 5, pp. 1292­1306, 2005. [144] F. Blaabjerg, R. Teodorescu, M. Liserre, and A. Timbus, "Overview of control and grid synchronization for distributed power generation systems," IEEE Trans. Ind. Electron., vol. 53, no. 5, pp. 1398­1409, Oct. 2006. [145] J. Baroudi, V. Dinavahi, and A. Knight, "A review of power converter topologies for wind generators," in IEEE Int. Electric Mach. and Drives Conf. (IEMDC), May. 2005, pp. 458­465. [146] J. A. Baroudi, V. Dinavahi, and A. M. Knight, "A review of power converter topologies for wind generators," Renewable Energy, vol. 32, no. 14, pp. 2369­2385, 2007. [147] L. Hansen, P. Madsen, F. Blaabjerg, H. Christensen, U. Lindhard, and K. Eskildsen, "Generators and power electronics technology for wind turbines," in IEEE Ind. Electron. Conf. (IECON), vol. 3, 2001, pp. 2000­2005. [148] L. H. Hansen, L. Helle, F. Blaabjerg, E. Ritchie, S. Munk-Nielsen, H. Bindner, P. Sorensen, and B. Bak-Jensen, "Conceptual survey of generators and power electronics for wind turbines," Riso National Laboratory, Roskilde, Denmark, Riso-R-1205(EN), Dec. 2001, available at: http://orbit.dtu.dk. [149] B. Bose, Power Electronics and Motor Drives: Recent Advances and Trends. Academic Press, 2006. San Diego, USA:

[150] M. Kazmierkowski, R. Krishnan, and F. Blaabjerg, Control in Power Electronics: Selected Problems. Academic Press, 2002. [151] B. Bose, Modern power electronics and AC drives. Prentice-Hall, 2002.

[152] N. Mohan, T. Undeland, and W. Robbins, Power electronics: converters, applications, and design.

Wiley, 1995.

252

[153] C. Buccella, C. Cecati, and H. Latafat, "Digital control of power converters - A survey," IEEE Trans. Ind. Informat., vol. 8, no. 3, pp. 437­447, 2012. [154] T. Atalik, M. Deniz, E. Koc, C. Gercek, B. Gultekin, M. Ermis, and I. Cadirci, "Multi-DSP and -FPGA-based fully digital control system for cascaded multilevel converters used in FACTS applications," IEEE Trans. Ind. Informat., vol. 8, no. 3, pp. 511­527, 2012. [155] A. Sanchez, A. De Castro, and J. Garrido, "A comparison of simulation and hardware-in-the- loop alternatives for digital control of power converters," IEEE Trans. Ind. Informat., vol. 8, no. 3, pp. 491­500, 2012. [156] M. Kazmierkowski, M. Jasinski, and G. Wrona, "DSP-based control of grid-connected power converters operating under grid distortions," IEEE Trans. Ind. Informat., vol. 7, no. 2, pp. 204­211, 2011. [157] E. Monmasson, L. Idkhajine, M. Cirstea, I. Bahri, A. Tisan, and M.-w. Naouar, "FPGAs in industrial control applications," IEEE Trans. Ind. Informat., vol. 7, no. 2, pp. 224­243, 2011. [158] B. Alecsa, M. Cirstea, and A. Onea, "Simulink modeling and design of an efficient hardware-constrained FPGA-based PMSM speed controller," IEEE Trans. Ind. Informat., vol. 8, no. 3, pp. 554­562, 2012. [159] K. Kim, M. Sung, and H.-W. Jin, "Design and implementation of a delay-guaranteed motor drive for precision motion control," IEEE Trans. Ind. Informat., vol. 8, no. 2, pp. 351­365, 2012. [160] A. Shukla, A. Ghosh, and A. Joshi, "Hysteresis modulation of multilevel inverters," IEEE Trans. Power Electron., vol. 26, no. 5, pp. 1396 ­1409, May. 2011. [161] N. Prabhakar and M. Mishra, "Dynamic hysteresis current control to minimize switching for three-phase four-leg VSI topology to compensate nonlinear load," IEEE Power Electron. Lett., vol. 25, no. 8, pp. 1935­1942, Aug. 2010. [162] X. Zhang, J. Wang, and C. Li, "Three-phase four-leg inverter based on voltage hysteresis control," in Int. Conf. on Elect. and Control Eng. (ICECE), Jun. 2010, pp. 4482­4485, Dhaka, Bangladesh. [163] P. Verdelho and G. Marques, "Four-wire current-regulated PWM voltage converter," IEEE Trans. Ind. Electron., vol. 45, no. 5, pp. 761­770, Oct. 1998. [164] S. Ali and M. Kazmierkowski, "Current regulation of four-leg PWM/VSI," in IEEE Ind. Electron. Conf. (IECON), vol. 3, Sep. 1998, pp. 1853­1858, Aachen, Germany. [165] C. Martins, X. Roboam, T. Meynard, and A. Carvalho, "Switching frequency imposition and ripple reduction in DTC drives by using a multilevel converter," IEEE Trans. Power Electron., vol. 17, no. 2, pp. 286­297, Mar. 2002. [166] B. Tamyurek, "A high-performance SPWM controller for three-phase UPS systems operating under highly nonlinear loads," IEEE Trans. Power Electron., vol. 28, no. 8, pp. 3689­3701, Aug. 2012. [167] X. Guo, M. Cavalcanti, A. Farias, and J. Guerrero, "Single-carrier modulation for neutral-point-clamped inverters in three-phase transformerless photovoltaic systems," IEEE Trans. Power Electron., vol. 28, no. 6, pp. 2635­2637, Jun. 2012. [168] J. Chivite-Zabalza, P. Izurza, D. Madariaga, G. Calvo, and M. Rodriguez, "Voltage balancing control in 3-level neutralpoint clamped inverters using trian-gular carrier PWM modulation for FACTS applications," IEEE Trans. Power Electron., vol. 28, no. 10, pp. 4473­4484, 2013. [169] S. Busquets Monge, J. Bordonau, and J. Rocabert, "A virtual-vector pulsewidth modulation for the four-level diodeclamped DC-AC converter," IEEE Trans. Power Electron., vol. 23, no. 4, pp. 1964­1972, Jul. 2008. [170] B. McGrath and D. Holmes, "Multicarrier PWM strategies for multilevel inverters," IEEE Trans. Ind. Electron., vol. 49, no. 4, pp. 858­867, Aug. 2002. [171] S. Busquets-Monge, J. Bordonau, and J. Rocabert, "Extension of the nearest-three virtual-space-vector PWM to the four-level diode-clamped dc-ac converter," in IEEE Power Electron. Spec. Conf. (PESC), Jun. 2007, pp. 1892­1898. [172] K. Corzine and J. Baker, "Multilevel voltage-source duty-cycle modulation: analysis and implementation," IEEE Trans. Ind. Electron., vol. 49, no. 5, pp. 1009­1016, Oct. 2002. [173] S. Kouro, P. Lezana, M. Angulo, and J. Rodriguez, "Multicarrier PWM with DC-link ripple feedforward compensation for multilevel inverters," IEEE Trans. Power Electron., vol. 23, no. 1, pp. 52­59, 2008. [174] G. Carrara, S. Gardella, M. Marchesoni, R. Salutari, and G. Sciutto, "A new multilevel PWM method: a theoretical analysis," IEEE Trans. Power Electron., vol. 7, no. 3, pp. 497­505, 1992.

253

[175] A. Gupta and A. Khambadkone, "A general space vector PWM algorithm for multilevel inverters, including operation in overmodulation range," IEEE Trans. Power Electron., vol. 22, no. 2, pp. 517­526, 2007. [176] B. Vafakhah, J. Ewanchuk, and J. Salmon, "Multicarrier interleaved PWM strategies for a five-level NPC inverter using a three-phase coupled inductor," IEEE Trans. Ind. Appl., vol. 47, no. 6, pp. 2549­2558, 2011. [177] S. Kouro, J. Rebolledo, and J. Rodriguez, "Reduced switching-frequency-modulation algorithm for high-power multilevel inverters," IEEE Trans. Ind. Electron., vol. 54, no. 5, pp. 2894­2901, 2007. [178] J. Leon, S. Kouro, S. Vazquez, R. Portillo, L. Franquelo, J. Carrasco, and J. Rodriguez, "Multidimensional modulation technique for cascaded multilevel converters," IEEE Trans. Ind. Electron., vol. 58, no. 2, pp. 412­420, 2011. [179] J. Leon, S. Vazquez, S. Kouro, L. Franquelo, J. Carrasco, and J. Rodriguez, "Unidimensional modulation technique for cascaded multilevel converters," IEEE Trans. Ind. Electron., vol. 56, no. 8, pp. 2981­2986, 2009. [180] A. Cataliotti, F. Genduso, A. Raciti, and G. Galluzzo, "Generalized PWM-VSI control algorithm based on a universal duty-cycle expression: Theoretical analysis, simulation results, and experimental validations," IEEE Trans. Ind. Electron., vol. 54, no. 3, pp. 1569­1580, 2007. [181] M. Ben Smida and F. Ben Ammar, "Modeling and DBC-PSC-PWM control of a three-phase flying-capacitor stacked multilevel voltage source inverter," IEEE Trans. Ind. Electron., vol. 57, no. 7, pp. 2231­2239, 2010. [182] W. Song, X. Feng, and K. Smedley, "A carrier-based PWM strategy with the offset voltage injection for single-phase three-level neutral-point-clamped converters," IEEE Trans. Power Electron., vol. 28, no. 3, pp. 1083­1095, Mar. 2012. [183] M. Saeedifard, H. Nikkhajoei, and R. Iravani, "A space vector modulated STATCOM based on a three-level neutral point clamped converter," IEEE Trans. Power Del., vol. 22, no. 2, pp. 1029­1039, 2007. [184] O. Lopez, J. Alvarez, J. Doval-Gandoy, and F. Freijedo, "Multilevel multiphase space vector PWM algorithm with switching state redundancy," IEEE Trans. Ind. Electron., vol. 56, no. 3, pp. 792­804, 2009. [185] O. Dordevic, E. Levi, and M. Jones, "A vector space decomposition based space vector PWM algorithm for a three-level seven-phase voltage source inverter," IEEE Trans. Power Electron., vol. 28, no. 2, pp. 637­649, Feb. 2012. [186] O. Lopez, J. Alvarez, J. Doval-Gandoy, and F. Freijedo, "Multilevel multiphase space vector PWM algorithm," IEEE Trans. Ind. Electron., vol. 55, no. 5, pp. 1933­1942, 2008. [187] O. Lopez, J. Alvarez, F. Freijedo, A. Yepes, P. Fernandez-Comesana, J. Malvar, J. Doval-Gandoy, A. Nogueiras, A. Lago, and C. Penalver, "Multilevel multiphase space vector PWM algorithm with switching state redundancy applied to threephase converters," in IEEE Ind. Electron. Conf. (IECON), 2009, pp. 651­657. [188] C. Govindaraju, "Efficient sequential switching hybrid modulation techniques for multiphase multilevel inverters," IET Pwr Electr., vol. 4, no. 5, pp. 557­569, 2011. [189] J. Alvarez, O. Lopez, F. Freijedo, and J. Doval-Gandoy, "Digital parameterizable VHDL module for multilevel multiphase space vector PWM," IEEE Trans. Ind. Electron., vol. 58, no. 9, pp. 3946­3957, 2011. [190] F. Patkar, E. Levi, and M. Jones, "A six-phase multilevel space vector PWM algorithm for a dual-inverter supplied drive," in IET Int. Conf. on Power Electron. Machines and Drives (PEMD), 2012, pp. 1­5. [191] D. Ahmadi, K. Zou, C. Li, Y. Huang, and J. Wang, "A universal selective harmonic elimination method for high-power inverters," IEEE Trans. Power Electron., vol. 26, no. 10, pp. 2743 ­2752, Oct. 2011. [192] Z. Du, L. Tolbert, J. Chiasson, and B. Ozpineci, "Reduced switching-frequency active harmonic elimination for multilevel converters," IEEE Trans. Ind. Electron., vol. 55, no. 4, pp. 1761­1770, 2008. [193] M. S. A. Dahidah and V. Agelidis, "Selective harmonic elimination PWM control for cascaded multilevel voltage source converters: A generalized formula," IEEE Trans. Power Electron., vol. 23, no. 4, pp. 1620­1630, 2008. [194] D. Kostic, Z. Avramovic, and N. Ciric, "A new approach to theoretical analysis of harmonic content of PWM waveforms of single- and multiple-frequency modulators," IEEE Trans. Power Electron., vol. 28, no. 10, pp. 4557­4567, 2013. [195] G. Orfanoudakis, M. Yuratich, and S. Sharkh, "Hybrid modulation strategies for eliminating low-frequency neutral-point voltage oscillations in the neutral-point-clamped converter," IEEE Trans. Power Electron., vol. 28, no. 8, pp. 3653­3658, Aug. 2012. [196] K. Astrom and T. Hagglund, PID Controllers: Theory, Design and Tuning, 1st ed. 1995. Instrument Society of America,

254

[197] J. Hung, W. Gao, and J. Hung, "Variable structure control: a survey," IEEE Trans. Ind. Electron., vol. 40, no. 1, pp. 2­22, 1993. [198] K. Tsang and W. Chan, "Adaptive control of power factor correction converter using nonlinear system identification," IEE Proc. Electr. Power Appl., vol. 152, no. 3, pp. 627­633, 2005. [199] J. Massing, M. Stefanello, H. Grundling, and H. Pinheiro, "Adaptive current control for grid-connected converters with LCL filter," IEEE Trans. Ind. Electron., vol. 59, no. 12, pp. 4681­4693, Dec. 2012. [200] M. Herran, J. Fischer, S. Gonzalez, M. Judewicz, and D. Carrica, "Adaptive dead-time compensation for grid-connected PWM inverters of single-stage PV systems," IEEE Trans. Power Electron., vol. 28, no. 6, pp. 2816­2825, Jun. 2013. [201] Y.-R. Mohamed, "Mitigation of converter-grid resonance, grid-induced distortion, and parametric instabilities in converter-based distributed generation," IEEE Trans. Power Electron., vol. 26, no. 3, pp. 983­996, Mar. 2011. [202] S.-C. Tan, Y. Lai, and C. Tse, "Indirect sliding mode control of power converters via double integral sliding surface," IEEE Trans. Power Electron., vol. 23, no. 2, pp. 600­611, 2008. [203] F. Cupertino, A. Lattanzi, and L. Salvatore, "Sliding mode control of an induction motor," in IET Int. Conf. on Power Electron. and Variable-Speed Drives, 2000, pp. 206­211. [204] F. Fuchs, J. Dannehl, and F. Fuchs, "Discrete sliding mode current control of grid-connected three-phase PWM converters with LCL filter," in IEEE Int. Symp. on Ind. Electron. (ISIE), 2010, pp. 779­785. [205] M. Cirstea, Neural and Fuzzy Logic Control of Drives and Power Systems. San Diego, CA: Elsevier, 2002.

[206] P. Vas, Artificial-Intelligence-based Electrical Machines and Drives: Application of Fuzzy, Neural, Fuzzy-neural, and Genetic-algorithm-based Techniques. OUP Oxford, 1999. [207] P. Vas, A. Stronach, and M. Neuroth, "DSP-controlled intelligent high-performance AC drives present and future," in IEE Colloquium on Vector Control and Direct Torque Control of Induction Motors, 1995, pp. 7/1­7/8. [208] P. Alsina and N. Gehlot, "Neuro-adaptive control of induction motor stator current," in IEEE Ind. Electron. Conf. (IECON), vol. 2, 1995, pp. 1434­1439. [209] M. Bacic, U. of Oxford. Mathematical, and P. S. Division, Model predictive control. University of Oxford, 2004.

[210] L. Wang, Model Predictive Control System Design and Implementation using MATLAB, ser. Advances in Industrial Control. Springer-Verlag, 2009. [211] E. Zafiriou, Model predictive control, ser. Journal of process control. Butterworth-Heinemann, 1993.

[212] J. Maciejowski, Predictive Control With Constraints, ser. Pearson Education. Upper Saddle River: Prentice-Hall, 2002. [213] R. Soeterboek, Predictive control: a unified approach, ser. Prentice-Hall international series in systems and control engineering. Prentice-Hall, 1992. [214] W. Kwon, S. Han, and S. Han, Receding Horizon Control: Model Predictive Control for State Models, ser. Advanced Textbooks in Control and Signal Processing. Berlin, Germany: Springer-Verlag, 2005. [215] J. Rossiter, Model-based predictive control: a practical approach, ser. CRC Press control series. CRC Press, 2003.

[216] E. Camacho and C. Bordons, Model Predictive Control, 2nd ed., ser. Advanced Textbooks in Control and Signal Processing. London: Springer London, 2004. [217] M. Morari and J. H. Lee, "Model predictive control: past, present and future," Comp. Chem. Eng., vol. 23, no. 4-5, pp. 667­682, 1999. [218] J. H. Lee, "Model predictive control: Review of the three decades of development," Int. J. Contr. Autom. Syst. (IJCAS), vol. 9, no. 3, pp. 415­424, 2011. [219] G. Goodwin, D. Carrasco, and M. Seron, "Predictive control: a historical perspective," Int. J. of Robust and Nonlinear Control, vol. 22, no. 12, pp. 1296­1313, 2012. [220] M. Nikolaou, "Model predictive controllers: A critical synthesis of theory and industrial needs," Advances in Chemical Engineering, vol. 26, pp. 131­204, 2001. [221] O. Kukrer, "Discrete-time current control of voltage-fed three-phase PWM inverters," IEEE Trans. Power Electron., vol. 11, no. 2, pp. 260­269, Mar. 1996.

255

[222] J. Hu, "Improved dead-beat predictive DPC strategy of grid-connected dc-ac converters with switching loss minimization and delay compensations," IEEE Trans. Ind. Informat., vol. 9, no. 2, pp. 728­738, 2013. [223] J. Hu and Z. Zhu, "Improved voltage-vector sequences on dead-beat predictive direct power control of reversible threephase grid-connected voltage-source converters," IEEE Trans. Power Electron., vol. 28, no. 1, pp. 254­267, Jan. 2013. [224] J. Moreno, J. Huerta, R. Gil, and S. Gonzalez, "A robust predictive current control for three-phase grid-connected inverters," IEEE Trans. Ind. Electron., vol. 56, no. 6, pp. 1993­2004, Jun. 2009. [225] R. Betz, B. Cook, and S. Henriksen, "A digital current controller for three phase voltage source inverters," in IEEE Ind. Appl. Soc. (IAS) Annu. Meeting, vol. 1, 1997, pp. 722­729. [226] G. Bode, P. C. Loh, M. Newman, and D. Holmes, "An improved robust predictive current regulation algorithm," IEEE Trans. Ind. Appl., vol. 41, no. 6, pp. 1720­1733, 2005. [227] H. Abu-Rub, J. Guzinski, Z. Krzeminski, and H. Toliyat, "Predictive current control of voltage-source inverters," IEEE Trans. Ind. Electron., vol. 51, no. 3, pp. 585­593, 2004. [228] L. Malesani, P. Mattavelli, and S. Buso, "Robust dead-beat current control for PWM rectifiers and active filters," IEEE Trans. Ind. Appl., vol. 35, no. 3, pp. 613­620, 1999. [229] Y. Nishida, O. Miyashita, T. Haneyoshi, H. Tomita, and A. Maeda, "A predictive instantaneous-current PWM controlled rectifier with AC-side harmonic current reduction," IEEE Trans. Ind. Electron., vol. 44, no. 3, pp. 337­343, 1997. [230] S.-G. Jeong and M.-H. Woo, "DSP-based active power filter with predictive current control," IEEE Trans. Ind. Electron., vol. 44, no. 3, pp. 329­336, 1997. [231] J. Mossoba and P. Lehn, "A controller architecture for high bandwidth active power filters," IEEE Trans. Power Electron., vol. 18, no. 1, pp. 317­325, 2003. [232] S. Buso, S. Fasolo, and P. Mattavelli, "Uninterruptible power supply multiloop control employing digital predictive voltage and current regulators," IEEE Trans. Ind. Appl., vol. 37, no. 6, pp. 1846­1854, 2001. [233] J. Chen, A. Prodic, R. Erickson, and D. Maksimovic, "Predictive digital current programmed control," IEEE Trans. Power Electron., vol. 18, no. 1, pp. 411­419, Jan. 2003. [234] S. Saggini, W. Stefanutti, E. Tedeschi, and P. Mattavelli, "Digital deadbeat control tuning for dc-dc converters using error correlation," IEEE Trans. Power Electron., vol. 22, no. 4, pp. 1566­1570, 2007. [235] A. Nasiri, "Digital control of three-phase series-parallel uninterruptible power supply systems," IEEE Trans. Power Electron., vol. 22, no. 4, pp. 1116­1127, 2007. [236] P. Mattavelli, "An improved deadbeat control for UPS using disturbance observers," IEEE Trans. Ind. Electron., vol. 52, no. 1, pp. 206­212, 2005. [237] H. Le-Huy, K. Slimani, and P. Viarouge, "Analysis and implementation of a real-time predictive current controller for permanent-magnet synchronous servo drives," IEEE Trans. Ind. Electron., vol. 41, no. 1, pp. 110­117, Feb. 1994. [238] H.-T. Moon, H.-S. Kim, and M.-J. Youn, "A discrete-time predictive current control for PMSM," IEEE Trans. Power Electron., vol. 18, no. 1, pp. 464­472, 2003. [239] L. Springob and J. Holtz, "High-bandwidth current control for torque-ripple compensation in PM synchronous machines," IEEE Trans. Ind. Electron., vol. 45, no. 5, pp. 713­721, 1998. [240] S.-M. Yang and C.-H. Lee, "A deadbeat current controller for field oriented induction motor drives," IEEE Trans. Power Electron., vol. 17, no. 5, pp. 772­778, 2002. [241] P. Correa, M. Pacas, and J. Rodriguez, "Predictive torque control for inverter-fed induction machines," IEEE Trans. Ind. Electron., vol. 54, no. 2, pp. 1073­1079, Apr. 2007. [242] T. Vyncke, S. Thielemans, and J. Melkebeek, "Finite-set model-based predictive control for flying-capacitor converters: Cost function design and efficient FPGA implementation," IEEE Trans. Ind. Informat., vol. 9, no. 2, pp. 1113­1121, 2013. [243] P. Martin Sanchez, O. Machado, E. Bueno, F. J. Rodriguez, and F. J. Meca, "FPGA-based implementation of a predictive current controller for power converters," IEEE Trans. Ind. Informat., vol. 9, no. 3, pp. 1312­1321, 2013.

256

[244] A. Damiano, G. Gatto, I. Marongiu, A. Perfetto, and A. Serpi, "Operating constraints management of a surface-mounted PM synchronous machine by means of an FPGA-based model predictive control algorithm," IEEE Trans. Ind. Informat., vol. 10, no. 1, pp. 243­255, Feb. 2014. [245] J. Jiang, "Preservations of positive realness under discretizations," Journal of the Franklin Institute, vol. 330, no. 4, pp. 721­734, 1993. [Online]. Available: http://www.sciencedirect.com/science/article/pii/0016003293900505 [246] A. Bemporad, "Lecture in automatic control: http://cse.lab.imtlucca.it, accessed on Jul. 2013. Sampling," 2011, university of Trento, Available at:

[247] P. Cortes, S. Kouro, B. La Rocca, R. Vargas, J. Rodriguez, J. Leon, S. Vazquez, and L. Franquelo, "Guidelines for weighting factors design in model predictive control of power converters and drives," in IEEE Int. Conf. on Ind. Tech. (ICIT), Feb. 2009, pp. 1­7, Gippsland, Australia. [248] P. Cortes, J. Rodriguez, C. Silva, and A. Flores, "Delay compensation in model predictive current control of a three-phase inverter," IEEE Trans. Ind. Electron., vol. 59, no. 2, pp. 1323­1325, Feb. 2012. [249] P. Cortes, J. Rodriguez, D. Quevedo, and C. Silva, "Predictive current control strategy with imposed load current spectrum," IEEE Trans. Power Electron., vol. 23, no. 2, pp. 612­618, Mar. 2008. [250] P. Cortes, G. Ortiz, J. Yuz, J. Rodriguez, S. Vazquez, and L. Franquelo, "Model predictive control of an inverter with output LC filter for UPS applications," IEEE Trans. Ind. Electron., vol. 56, no. 6, pp. 1875­1883, Jun. 2009. [251] P. Cortes, J. Rodriguez, P. Antoniewicz, and M. Kazmierkowski, "Direct power control of an AFE using predictive control," IEEE Trans. Power Electron., vol. 23, no. 5, pp. 2516­2523, Sep. 2008. [252] H. Miranda, P. Cortes, J. Yuz, and J. Rodriguez, "Predictive torque control of induction machines based on state-space models," IEEE Trans. Ind. Electron., vol. 56, no. 6, pp. 1916­1924, Jun. 2009. [253] V. Yaramasu, B. Wu, M. Rivera, J. Rodriguez, and A. Wilson, "Cost-function based predictive voltage control of two-level four-leg inverters using two step prediction horizon for standalone power systems," in IEEE Appl. Power Electron. Conf. Expo. (APEC), Feb. 2012, pp. 128­135, Oelando, FL, USA. [254] P. Cortes, J. Rodriguez, S. Vazquez, and L. Franquelo, "Predictive control of a three-phase UPS inverter using two steps prediction horizon," in IEEE Int. Conf. on Ind. Tech. (ICIT), Mar. 2010, pp. 1283­1288, Vi~ na del Mar, Chile. [255] T. Geyer, "Generalized model predictive direct torque control: Long prediction horizons and minimization of switching losses," in IEEE Chin. Control Conf. (CCC), Dec. 2009, pp. 6799­6804, Shanghai, China. [256] S. Davari, D. Khaburi, and R. Kennel, "Using a weighting factor table for FCS-MPC of induction motors with extended prediction horizon," in IEEE Ind. Electron. Conf. (IECON), 2012, pp. 2086­2091. [257] M. Rivera, V. Yaramasu, A. Llor, J. Rodriguez, B. Wu, and M. Fadel, "Digital predictive current control of a three-phase four-leg inverter," IEEE Trans. Ind. Electron., vol. 60, no. 11, pp. 4903­4912, Nov. 2013. [258] V. Yaramasu, M. Rivera, B. Wu, and J. Rodriguez, "Model predictive current control of two-level four-leg inverters ­ Part I: Concept, algorithm and simulation analysis," IEEE Trans. Power Electron., vol. 28, no. 7, pp. 3459­3468, Jul. 2013. [259] M. Rivera, V. Yaramasu, J. Rodriguez, and B. Wu, "Model predictive current control of two-level four-leg inverters ­ Part II: Experimental implementation and validation," IEEE Trans. Power Electron., vol. 28, no. 7, pp. 3469­3478, Jul. 2013. [260] M. Odavic, V. Biagini, P. Zanchetta, M. Sumner, and M. Degano, "One-sample-period-ahead predictive current control for high-performance active shunt power filters," IET Pwr Electr., vol. 4, no. 4, pp. 414­423, 2011. [261] P. Cortes, F. Quiroz, and J. Rodriguez, "Predictive control of a grid-connected cascaded H-bridge multilevel converter," in IEEE Eur. Conf. on Power Electron. and Appl. (EPE), Sep. 2011, pp. 1­7, Birmingham, UK. [262] J. Rodriguez, J. Pontt, C. A. Silva, P. Correa, P. Lezana, P. Cortes, and U. Ammann, "Predictive current control of a voltage source inverter," IEEE Trans. Ind. Electron., vol. 54, no. 1, pp. 495­503, Feb. 2007. [263] M. Rivera, A. Wilson, C. Rojas, J. Rodriguez, J. Espinoza, P. Wheeler, and L. Empringham, "A comparative assessment of model predictive current control and space vector modulation in a direct matrix converter," IEEE Trans. Ind. Electron., vol. 60, no. 2, pp. 578­588, 2013. [264] J. Rodriguez, R. Kennel, J. Espinoza, M. Trincado, C. Silva, and C. Rojas, "High-performance control strategies for electrical drives: An experimental assessment," IEEE Trans. Ind. Electron., vol. 59, no. 2, pp. 812­820, 2012.

257

[265] T. Geyer, "A comparison of control and modulation schemes for medium-voltage drives: Emerging predictive control concepts versus PWM-based schemes," IEEE Trans. Ind. Appl., vol. 47, no. 3, pp. 1380­1389, 2011. [266] K.-J. Lee, B.-G. Park, R.-Y. Kim, and D.-S. Hyun, "Robust predictive current controller based on a disturbance estimator in a three-phase grid-connected inverter," IEEE Trans. Power Electron., vol. 27, no. 1, pp. 276­283, Jan. 2012. [267] R. P. A. Echeverria, "Model predictive control of power converters: Theory and practice," Ph.D. dissertation, The University of Newcastle, Callaghan, Australia, 2012. [268] Z. Shu, N. Ding, J. Chen, H. Zhu, and X. He, "Multilevel SVPWM with DC-link capacitor voltage balancing control for diode-clamped multilevel converter based STATCOM," IEEE Trans. Ind. Electron., vol. 60, no. 5, pp. 1884­1896, 2013. [269] F. Grigoletto and H. Pinheiro, "Generalised pulse width modulation approach for DC capacitor voltage balancing in diode-clamped multilevel converters," IET Pwr Electr., vol. 4, no. 1, pp. 89­100, Jan. 2011. [270] S. Busquets-Monge, S. Alepuz, J. Bordonau, and J. Peracaula, "Voltage balancing control of diode-clamped multilevel converters with passive front-ends," IEEE Trans. Power Electron., vol. 23, no. 4, pp. 1751­1758, Jul. 2008. [271] S. Rivera, S. Kouro, P. Cortes, S. Alepuz, M. Malinowski, B. Wu, and J. Rodriguez, "Generalized direct power control for grid connected multilevel converters," in IEEE Int. Conf. on Ind. Tech. (ICIT), Mar. 2010, pp. 1351­1358. [272] M. Renge and H. Suryawanshi, "Three-dimensional space-vector modulation to reduce common-mode voltage for multilevel inverter," IEEE Trans. Ind. Electron., vol. 57, no. 7, pp. 2324­2331, 2010. [273] C.-C. Hou, C.-C. Shih, P.-T. Cheng, and A. M. Hava, "Common-mode voltage reduction pulsewidth modulation techniques for three-phase grid-connected converters," IEEE Trans. Power Electron., vol. 28, no. 4, pp. 1971­1979, 2013. [274] M. Renge and H. Suryawanshi, "Five-level diode clamped inverter to eliminatecommon mode voltage and reduce dv/dt in medium voltage rating induction motor drives," IEEE Trans. Power Electron., vol. 23, no. 4, pp. 1598­1607, 2008. [275] A. Von Jouanne, S. Dai, and H. Zhang, "A multilevel inverter approach providing DC-link balancing, ride-through enhancement, and common-mode voltage elimination," IEEE Trans. Ind. Electron., vol. 49, no. 4, pp. 739­745, 2002. [276] P. Pairodamonchai, S. Suwankawin, and S. Sangwongwanich, "Design and implementation of a hybrid output EMI filter for high-frequency common-mode voltage compensation in PWM inverters," IEEE Trans. Ind. Appl., vol. 45, no. 5, pp. 1647­1659, 2009. [277] H.-J. Kim, H.-D. Lee, and S.-K. Sul, "A new PWM strategy for common-mode voltage reduction in neutral-point-clamped inverter-fed AC motor drives," IEEE Trans. Ind. Appl., vol. 37, no. 6, pp. 1840­1845, 2001. [278] N. Rashidi-rad, A. Rahmati, A. Abrishamifar, and M. Arasteh, "Reduction of common-mode voltage in an even level inverter by a new SVM method," Int. J. Adv. Comput. Sci., vol. 2, no. 9, pp. 343­347, Sep. 2012. [279] R. Vargas, P. Cortes, U. Ammann, J. Rodriguez, and J. Pontt, "Predictive control of a three-phase neutral-point-clamped inverter," IEEE Trans. Ind. Electron., vol. 54, no. 5, pp. 2697­2705, Oct. 2007. [280] J. Barros, J. Silva, and E. Jesus, "Fast-predictive optimal control of NPC multilevel converters," IEEE Trans. Ind. Electron., vol. 60, no. 2, pp. 619­627, Feb. 2013. [281] P. Cortes, J. Rodriguez, S. Alepuz, S. Busquets-Monge, and J. Bordonau, "Finite-states model predictive control of a four-level diode-clamped inverter," in IEEE Power Electron. Spec. Conf. (PESC), Jun. 2008, pp. 2203­2208, Rhodes, Greece. [282] J. Qin and M. Saeedifard, "Capacitor voltage balancing of a five-level diode-clamped converter based on a predictive current control strategy," in IEEE Appl. Power Electron. Conf. Expo. (APEC), 2011, pp. 1656­1660. [283] M. Chaves, E. Margato, J. Silva, S. Pinto, and J. Santana, "Fast optimum-predictive control and capacitor voltage balancing strategy for bipolar back-to-back NPC converters in high-voltage direct current transmission systems," IET Gener. Transm. Distrib., vol. 5, no. 3, pp. 368­375, 2011. [284] Q. Wang and L. Chang, "An intelligent maximum power extraction algorithm for inverter-based variable speed wind turbine systems," IEEE Trans. Power Electron., vol. 19, no. 5, pp. 1242­1249, Sep. 2004. [285] S. Morimoto, H. Nakayama, M. Sanada, and Y. Takeda, "Sensorless output maximization control for variable-speed wind generation system using IPMSG," IEEE Trans. Ind. Appl., vol. 41, no. 1, pp. 60­67, 2005. [286] G. Hua and Y. Geng, "A novel control strategy of MPPT taking dynamics of wind turbine into account," in IEEE Power Electron. Spec. Conf. (PESC), 2006, pp. 1­6.

258

[287] S. Bhowmik, R. Spee, and J. H. R. Enslin, "Performance optimization for doubly fed wind power generation systems," IEEE Trans. Ind. Appl., vol. 35, no. 4, pp. 949­958, 1999. [288] Y. Xia, K. Ahmed, and B. Williams, "A new maximum power point tracking technique for permanent magnet synchronous generator based wind energy conversion system," IEEE Trans. Power Electron., vol. 26, no. 12, pp. 3609­3620, Dec. 2011. [289] Y. Park, S.-K. Sul, C.-H. Lim, W.-C. Kim, and S.-H. Lee, "Asymmetric control of DC-link voltages for separate MPPTs in three-level inverters," IEEE Trans. Power Electron., vol. 28, no. 6, pp. 2760­2769, Jun. 2012. [290] M. Marchesoni and P. Tenca, "Diode-clamped multilevel converters: a practicable way to balance DC-link voltages," IEEE Trans. Ind. Electron., vol. 49, no. 4, pp. 752­765, Aug. 2002. [291] J. Hu, L. Shang, Y. He, and Z. Zhu, "Direct active and reactive power regulation of grid-connected DC/AC converters using sliding mode control approach," IEEE Trans. Power Electron., vol. 26, no. 1, pp. 210­222, Jan. 2011. [292] M. Malinowski, M. Kazmierkowski, and A. Trzynadlowski, "A comparative study of control techniques for PWM rectifiers in AC adjustable speed drives," IEEE Trans. Power Electron., vol. 18, no. 6, pp. 1390­1396, Nov. 2003. [293] J. Dai, D. Xu, B. Wu, and N. Zargari, "Unified DC-link current control for low-voltage ride-through in current-sourceconverter-based wind energy conversion systems," IEEE Trans. Power Electron., vol. 26, no. 1, pp. 288­297, 2011. [294] P. Cortes, L. Vattuone, and J. Rodriguez, "A comparative study of predictive current control for three-phase voltage source inverters based on switching frequency and current error," in IEEE Eur. Conf. on Power Electron. and Appl. (EPE), Sep. 2011, pp. 1­8, Birmingham, UK. [295] M. Perez, J. Rodriguez, and A. Coccia, "Predictive current control in a single phase PFC boost rectifier," in IEEE Int. Conf. on Ind. Tech. (ICIT), Feb. 2009, pp. 1­6, Gippsland, Australia. [296] J. Baggio, H. Hey, H. Grundling, H. Pinheiro, and J. Pinheiro, "Discrete control for three-level boost PFC converter," in Int. Telecommun. Energy Conf. (INTELEC), 2002, pp. 627­633. [297] H. Chen and J. Liao, "Design and implementation of sensorless capacitor voltage balancing control for three-level boosting PFC converter," IEEE Trans. Power Electron., vol. PP, no. 99, pp. 1­1, 2013, [early access article, DOI: 10.1109/TPEL.2013.2279718]. [298] H.-C. Chen and W.-J. Lin, "MPPT and voltage balancing control with sensing only inductor current for photovoltaic-fed, three-level, boost-type converters," IEEE Trans. Power Electron., vol. 29, no. 1, pp. 29­35, 2014. [299] S. Alepuz, S. Busquets-Monge, J. Bordonau, P. Cortes, J. Rodriguez, and R. Vargas, "Predictive current control of gridconnected neutral-point-clamped converters to meet low voltage ride-through requirements," in IEEE Power Electron. Spec. Conf. (PESC), Jun. 2008, pp. 2423­2428, Rhodes, Greece. [300] M. Molina and P. Mercado, "A new control strategy of variable speed wind turbine generator for three-phase gridconnected applications," in IEEE/PES Transmission and Distribution Conference and Exposition: Latin America, 2008, pp. 1­8. [301] R. Vargas, U. Ammann, J. Rodriguez, and J. Pontt, "Predictive strategy to control common-mode voltage in loads fed by matrix converters," IEEE Trans. Ind. Electron., vol. 55, no. 12, pp. 4372­4380, 2008. [302] G. Sinha and T. Lipo, "A four-level inverter based drive with a passive front end," IEEE Trans. Power Electron., vol. 15, no. 2, pp. 285­294, Mar. 2000. [303] V. Yaramasu, B. Wu, M. Rivera, and J. Rodriguez, "Enhanced model predictive voltage control of four-leg inverters with switching frequency reduction for standalone power systems," in IEEE Int. Power Electron. and Motion Control Conf. (EPE/PEMC), Sep. 2012, pp. DS2c.6­1­DS2c.6­5, Novi Sad, Serbia. [304] J. Conroy and R. Watson, "Low-voltage ride-through of a full converter wind turbine with permanent magnet generator," IET Renew. Power Gener., vol. 1, no. 3, pp. 182­189, 2007. [305] M. Popat, B. Wu, and N. R. Zargari, "Fault ride-through capability of cascaded current-source converter-based offshore wind farm," IEEE Trans. Sustainable Energy, vol. 4, no. 2, pp. 314­323, 2013. [306] F. Deng and Z. Chen, "Low-voltage ride-through of variable speed wind turbines with permanent magnet synchronous generator," in IEEE Ind. Electron. Conf. (IECON), 2009, pp. 621­626. [307] S. Alepuz, S. Busquets-Monge, J. Bordonau, P. Cortes, and S. Kouro, "Control methods for low voltage ride-through compliance in grid-connected NPC converter based wind power systems using predictive control," in IEEE Energy Conversion Congr. and Expo. (ECCE), Sep. 2009, pp. 363­369, San Jose, CA, USA.

259

