INJECTION-LOCK AND RECONFIGURABLE CHARGE-DOMAIN SAMPLING MIXERS/FILTERS FOR DATA COMMUNICATIONS OVER WIRELESS CHANNELS

by

Yushi Zhou Bachelor of Engineering, University of Electronic Science and Technology of China, 2000

A dissertation presented to Ryerson University in partial fulfillment of the requirements for the degree of Doctor of Philosophy in the Program of Electrical and Computer Engineering

Toronto, Ontario, Canada, 2015 c Yushi Zhou 2015

AUTHOR'S DECLARATION FOR ELECTRONIC SUBMISSION OF A DISSERTATION

I hereby declare that I am the sole author of this dissertation. This is a true copy of the dissertation, including any required final revisions, as accepted by my examiners. I authorize Ryerson University to lend this dissertation to other institutions or individuals for the purpose of scholarly research. I further authorize Ryerson University to reproduce this dissertation by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. I understand that my dissertation may be made electronically available to the public.

ii

ABSTRACT Yushi Zhou Injection-Lock and Reconfigurable Charge-Domain Sampling Mixers/Filters for Data Communications Over Wireless Channels Doctor of Philosophy, Electrical and Computer Engineering, Ryerson University, 2015

This thesis provides a theoretical and experimental study of injection locking and reconfigurable charge-domain sampling mixers and filters for data communications over wireless channels. On injection-locking, the intrinsic relation between the characteristics of injection signals such as sinusoidal or square, single-tone or multi-tone, the type of oscillators under injection such as harmonic oscillators (passive or active LC oscillators) or non-harmonic oscillators (ring or relaxation oscillators), and the lock range of the oscillators under injection was investigated. For the very first time, we discovered the intrinsic relation between the lock range and the phase of multiple injections of harmonic oscillators. In addition, we obtained the closed-form expression of the lock range of harmonic oscillators with square-wave injections. Moreover, we obtained the distinct characteristics of the lock range of harmonic and non-harmonic oscillators and that of different types of non-harmonic oscillators. These theoretical findings were not known before and were validated using simulation results. On reconfigurable charge-domain sampling mixers and filters for software-defined radio, a novel quadrature charge-domain down-conversion sampling mixer with embedded finite-impulse-response (FIR), infinite-impulse-response (IIR), and 4-path bandpass filters was developed. An in-depth investigation of the principles of periodic impulse sampling, periodic windowed sampling, and periodic N-path windowed sampling was presented and a detailed mathematical treatment of charge-domain windowed samplers with built-in sinc, FIR and IIR filters was provided. The proposed quadrature charge-domain sampler with embedded FIR, IIR, and 4-path band-pass filters was implemented in IBM 130 nm 1.2V CMOS

iii

technology and its performance was validated both using simulation results and on-wafer measurement.

iv

ACKNOWLEDGMENTS

First and foremost, I would like to express my most sincere gratitude to my advisor, Professor Fei Yuan, for his kind guidance, helpful discussions and constructive suggestions throughout my study. I could not have completed this work without his support and enthusiasm. I also thank the other committee members, Professor Andy Ye, Professor Vadim Geurkov, Professor GuangJun Liu and Professor Wai Tung Ng from University of Toronto for their invaluable feedback. I wish to thank my fellow students in the Integrated Circuits and Systems Research Group, who were sitting around me and made the long journey of the study enjoyable. Special acknowledgements go to Young Jun Park, Alaa AL-Taee, Guangyu Zhu, Shaul Peker, Xiongliang Lai for their helpful discussions and suggestions for my research and career. I also would like to take the opportunity to thank the former members, Dr. Adrian Tang and Dr. Dominic DiClemente for their effort in establishing the test facilities, and Tarek Khan for creating the Cadence simulation environments. I am also indebted to staffs Jason Naughton, Dan Giannitelli and Bruce Derwin for their timely technical support. Thanks to the Canadian Microelectronics Corporation (CMC) for making the fabrication of my chips. Also, I am grateful to the Natural Sciences and Engineering Research Council of Canada (NSERC), a significant funding source supporting my study (Canada Graduate Scholarships-CGS2) during 2013-2015. Most importantly, I must thank my parents, brothers for providing me with much needed support and guidance over the years. Very special thanks to my wife, Zhaoying for her love and understanding throughout this endeavour. Finally, I wish to offer my gratitude to my lovely son, Alex, bringing joyfulness to me.

v

Table of Contents
Table of Contents List of Tables List of Figures List of Symbols 1 INTRODUCTION 1.1 1.2 Background . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Motivation and Objectives for Injection-Locked Oscillators . . . . . . . . . . 1.2.1 1.2.2 1.3 Injection-Locked Active Inductor Oscillators . . . . . . . . . . . . . . Injection-Locked Non-Harmonic Oscillators . . . . . . . . . . . . . . . vi ix x xv 1 1 7 7 8

Motivation and Objectives for Charge-Domain Sampling Circuits with Tunable Band-Pass Filter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Contributions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1.4.1 1.4.2 Injection-Locked Oscillators . . . . . . . . . . . . . . . . . . . . . . .

10 12 12

1.4

Tunable Band-Pass Filter Embedded Charge-Domain Sampling Circuits 12 13 15 15 18

1.5

Thesis Organization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

2 Injection-Locked Active Inductor Oscillators 2.1 2.2 Injection-Locked Oscillators . . . . . . . . . . . . . . . . . . . . . . . . . . . Active Inductor Oscillators . . . . . . . . . . . . . . . . . . . . . . . . . . . . vi

2.3 2.4 2.5 2.6 3

Lock Range of Generic LC Oscillators . . . . . . . . . . . . . . . . . . . . . . Lock Range and Tank Impedance Variation . . . . . . . . . . . . . . . . . .

20 24

Comparison of Injection-Locked LC Oscillators and Active Inductor Oscillators 27 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32 34 34 36 36 37 39 41

Multiple Multi-Tone Injection-Locked Oscillators 3.1 3.2 Representation of Non-Harmonic Oscillators . . . . . . . . . . . . . . . . . . Representation of Injection-Locked Non-harmonic Oscillators . . . . . . . . . 3.2.1 3.2.2 3.3 3.4 3.5 3.6 3.7 3.8 3.9 Single-Tone Injection . . . . . . . . . . . . . . . . . . . . . . . . . . . Multi-Tone Injection . . . . . . . . . . . . . . . . . . . . . . . . . . .

Harmonic Oscillators with Multiple Injections . . . . . . . . . . . . . . . . . Non-Harmonic Oscillators with Multiple Injections . . . . . . . . . . . . . . .

Lock Range of Non-Harmonic Oscillators with Multiple Single-Tone Injections 42 Simulations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Lock Range of Non-Harmonic Oscillators with Multiple Multi-Tone Injections Simulations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 48 49 58 62

4 A Quadrature Charge-Domain Sampling Mixer with Embedded FIR, IIR, and N-Path Filters 64 4.1 N-path Filters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.1.1 4.1.2 4.1.3 4.2 Periodic Impulse Sampling . . . . . . . . . . . . . . . . . . . . . . . . Periodic Windowed Sampling . . . . . . . . . . . . . . . . . . . . . . Periodic N-Path Windowed Sampling . . . . . . . . . . . . . . . . . . 65 65 66 68 73 73

Charge-Domain Windowed Sampling . . . . . . . . . . . . . . . . . . . . . . 4.2.1 Sinc Low-Pass Filter . . . . . . . . . . . . . . . . . . . . . . . . . . .

vii

4.2.2 4.2.3 4.3

FIR Filter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . IIR Filter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

78 82 86 88 90 94 97

Circuit Design and Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.3.1 4.3.2 4.3.3 Performance . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Noise . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Effect of Nonidealities . . . . . . . . . . . . . . . . . . . . . . . . . .

4.4 4.5

Measurement Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 104

5 A Cascaded Charge-domain Sampling Mixer with Embedded sinc3 FIR and N-Path Filters 106 5.1 5.2 Hight-Order FIR Filter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 106 Circuit Design and Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . 108 5.2.1 5.3 5.4 Performance . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109

Simulation Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 111 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 112 115

6 Conclusions and Future Work 6.1 6.2

Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 115 Future Work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 116 118

Bibliography

viii

List of Tables
3.1 4.1 Lock Range Coefficient d . . . . . . . . . . . . . . . . . . . . . . . . . . . . Noise Bandwidth of Sampling Mixer with 4-path Bandpass, sinc, FIR, and IIR Filters Considered Individually. . . . . . . . . . . . . . . . . . . . . . . . 47

93

4.2 5.1

Performance Summary of Sampling Mixer . . . . . . . . . . . . . . . . . . . 105 Performance Comparison . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 114

ix

List of Figures
1.1 Three receiver architectures: (a) Super-heterodyne receiver, (b) Zero-IF receiver, and (c) SDR receiver. . . . . . . . . . . . . . . . . . . . . . . . . . . . Spectrum allocation for wireless communications. . . . . . . . . . . . . . . . A feedback system. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

5 7 15

1.2 2.1 2.2

Injection locked procedure represented in simplified spectrum diagram. (a)Unlocked, (b) Fast beat, and (c) Locked. . . . . . . . . . . . . . . . . . . . . . . . . . 17 Single-ended active inductor. . . . . . . . . . . . . . . . . . . . . . . . . . . . Examples of active inductors. (a) Wu current reuse active inductor , (b) Lin active inductor , and (c) Hara active inductor . . . . . . . . . . . . . . . . . 19

2.3 2.4

20

2.5 2.6 2.7

(a) Injection-locked oscillators. (b) Block diagram of injection-locked oscillators. 21 Impedance of the LC tank of injection-locked LC oscillators. . . . . . . . . . (a) Injection-locked oscillators. (b) Equivalent circuit of injection-locked oscillators. The dotted line represents the real injection signal, which has been merged into the variation of the LC tank. . . . . . . . . . . . . . . . . . . . . Injection-locked passive LC oscillator. C1 and C2 are accumulation MOS varactors. Circuit parameters : W1,2 = 10µm; W3 = 15µm, W4,5 = 1µm, Vc = 1.2 V, Vb = 0.66 V, Ids3 = 1.42 mA. . . . . . . . . . . . . . . . . . . . . Schematic of injection-locked active-inductor VCO with Wu active inductors. Circuits parameters :W1a,1b = 40µm, W2a,2b = 18.9µm, W3a,3b = 4µm, W4,5 = 10µm, W6 = 15µm, W7,8 = 1µm, Vb1 = 0.34 V, Vb2 = 0.48 V, Vb3 = 0.7 V, Ids3 = 131µA, Ids6 = 1.42 mA. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22

25

2.8

27

2.9

29 31 31 32

2.10 Simulated phase noise of passive LC oscillator Iinj /Io = 0.05.

2.11 Simulated phase noise of active-inductor LC oscillator Iinj /Io = 0.05. . . . . 2.12 Simulated lock range. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . x

2.13 Asymmetry of the lock range of injection-locked active-inductor oscillator. 3.1 3.2

.

33 35

Waveform and spectrum of non-harmonic oscillators. . . . . . . . . . . . . . Representation of injection-locked non-harmonic oscillators with a single-tone injection. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Injection-locked harmonic oscillators with multiple injections. . . . . . . . . .

37 40

3.3 3.4

Representation of injection-locked non-harmonic oscillators with multiple singletone injections. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42 Schematic of relaxation oscillator with injection-locking. Circuit parameters: W1,2,6,7,10,11 = 0.5µm,W3,4 = 1.2µm, W8,9,12,13 = 1.25µm, W5 = 2µm, Supply voltage VDD = 0.9V, Vref = 0.31 V, Ib =253 nA, Vb = 0.62 V . . . . . . . . . Simulated spectrum of relaxation oscillator without injection. Top - Fundamental. Middle : 3rd harmonic. Bottom : 5th harmonic. . . . . . . . . . . . Simulated spectrum of relaxation oscillator in fast beat. Top - Fundamental. Middle : 3rd harmonic. Bottom : 5th harmonic. . . . . . . . . . . . . . . . . Simulated spectrum of relaxation oscillator in quasi-lock. Top - Fundamental. Middle : 3rd harmonic. Bottom : 5th harmonic. . . . . . . . . . . . . . . . . Simulated spectrum of relaxation oscillator in lock state. Top - Fundamental. Middle : 3rd harmonic. Bottom : 5th harmonic. . . . . . . . . . . . . . . . .

3.5

48

3.6

50

3.7

51

3.8

52

3.9

53

3.10 Simulated dependence of the lock range of relaxation oscillator with a sinusoidal injection and double sinusoidal injections whose phase difference is 180 degree on injection strength. . . . . . . . . . . . . . . . . . . . . . . . . . . .

54

3.11 Representation of injection-locked non-harmonic oscillators with multiple multitone injections. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55 3.12 Simulated dependence of the lock range of relaxation oscillator with a single square-wave injection and with double square-wave injections whose phase difference is 180 degree on injection strength. . . . . . . . . . . . . . . . . . . 3.13 Simulated dependence of the lock range of relaxation oscillator with differential square-wave injection on injection strength. . . . . . . . . . . . . . . . . 3.14 Simulated dependence of the lock range of relaxation oscillator with a single sinusoidal injection, a single square-wave injection, and a single dual-tone (two-sinusoids) injection on injection strength. . . . . . . . . . . . . . . . . .

59

60

60

xi

3.15 Simulated dependence of the lock range of relaxation oscillator with double square-wave injections on the phase difference of the injection signals. The injection ratio is 0.1. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3.16 Simulated dependence of the lock range of relaxation oscillator with a two-tone sinusoidal injection and double two-tone injections on injection strength. . . 3.17 Simulated dependence of the lock range of relaxation oscillator with double single-tone injections, double two-tone injections, and double square-wave injections on injection strength. . . . . . . . . . . . . . . . . . . . . . . . . . . 4.1 4.2 Periodic impulse sampling of band-limited signals. . . . . . . . . . . . . . . . (a) Periodic impulse sampling of band-limited signals. Baseband signal at  is replicated to sidebands at  + ns . (b) Periodic impulse sampling of broadband signals. The sideband components of input at  + ns are aliased back to the baseband at  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Periodic windowed sampling of band-limited signals. . . . . . . . . . . . . . . (a) Periodic windowed sampling of narrow-band signals without interferences. (b) Periodic windowed sampling of band-limited signals with interferences. Interferences at  + ns are aliased back to the desired baseband. . . . . . . N-path filter. Sampling mixers are implemented using switches drived by a sampling clock with N non-overlapping phases. Non-overlapping uniform sampling pulse width:  = Ts /N . k = k-1 +  and k-1 = nTs + (k - 1) . . Single-ended 4-path filter. . . . . . . . . . . . . . . . . . . . . . . . . . . . . Single-ended 4-path filter. . . . . . . . . . . . . . . . . . . . . . . . . . . . . Frequency response of single-ended 4-path filter in Fig. 4.6. . . . . . . . . . . Charge-domain sampling. Solid line : Small Ti . Dashed line : Large Ti . . . .

61

61

62 65

66 67

4.3 4.4

68

4.5

69 72 73 74 74 75 77 78

4.6 4.7 4.8 4.9

4.10 Gain-normalized transfer function of sinc. . . . . . . . . . . . . . . . . . . . . 4.11 Time interleaved charge-domain sampling. . . . . . . . . . . . . . . . . . . . 4.12 Charge-domain sampler with built-in FIR filter. . . . . . . . . . . . . . . . . 4.13 Spectrum of charge-domain windowed sampler with FIR filtering. Parameters: fs =10 MHz, N =10 and Tf = Ts /N . . . . . . . . . . . . . . . . . . . . . . . 4.14 Spectrum of charge-domain windowed sampler with FIR filtering. Parameters: fs =20 MHz, N =5 and Tf = Ts /N . . . . . . . . . . . . . . . . . . . . . . . . xii

80

81

4.15 Spectrum of charge-domain windowed sampler with CT sinc low-pass filter. fi =200 MHz, fs =10 MHz, N =10 and Tf = Ts /N . . . . . . . . . . . . . . . . 4.16 Charge-domain sampler with a build-in FIR and IIR filter and its timing scheme. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.17 Time interleaved charge-domain sampler with a build-in FIR and IIR filter and its timing scheme. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.18 Spectrum of charge-domain windowed sampler with first-order IIR filter. fs =10 MHz. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.19 Quadrature Charge-Domain Sampler with 4-path bandpass filter. Circuit Parameters: W1,2 = 20µm, W3,4,5 = 15µm, W6,7 = 10µm, L = 0.36µm, Ib = 150µA., Vb1 =0.67 V, Vb2 =0.65 V. . . . . . . . . . . . . . . . . . . . . . . 4.20 (a) Differential 4-path band-pass filter, (b) Clocking scheme. . . . . . . . . . 4.21 Simulated differential 4-path band-pass filter with Ts = TLO = 100 MHz. . . 4.22 (a) Differential charge-domain sampler (only half of the circuit is shown), (b) Clocking scheme. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.23 Simulated transfer function (normalized) of quadrature charge-domain sampler. Ideal transconductor with gm = 0.5 mS and ideal switches with Ron = 1 and Rof f = 1T are used. The input is a 100 MHz sinusoid. The sampling frequency is 100 MHz with 25% duty cycle. Voltage gain provided by the sampler is 15 dB. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.24 Noise analysis of proposed charge-domain sampling mixer. . . . . . . . . . . 4.25 Noise analysis of N-path filter. . . . . . . . . . . . . . . . . . . . . . . . . . . 4.26 Simulated effect of ON-resistance of switches on 4-path bandpass filter. Ron is varied from 5  to 200 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.27 Simulated frequency response (normalized) of quadrature charge-domain sampler with embedded 4-path bandpass filter at process corners. The input frequency is 100 MHz, the output baseband sampling frequency is 25 MHz (Two 12.5 MHz interleaved clocks with 50% duty-cycle). Legends: TT (typical nMOS/typical pMOS), SS (slow nMOS/slow pMOS), FS (fast nMOS/slow pMOS), SF (slow nMOS/fast pMOS), and FF (fast nMOS/fast pMOS). . . . 4.28 Simulated frequency tuning range. The input frequency is varied from 50 MHz to 250 MHz. The sampling frequency is also varied accordingly such that the output frequency remains unchanged. . . . . . . . . . . . . . . . . . . . . . .

81

82

83

85

86 87 87

88

89 90 92

94

95

97

xiii

4.29 Die microphotograph of quadrature charge-domain sampler(1x2 mm2 ). . . . 4.30 (a) Active balun. (b) Output buffer. Circuit parameters of active balun: W1,2 = 300µm, Rs1 , RD1 , RD2 = 200. Circuit parameters of source follower : W = 300µm. Rs =1k. Length of all transistors is 0.13 µm. . . . . . . . . . . 4.31 Die photo-micrograph of charge-domain sampler with embedded 4-path bandpass filter with probes in place for on-wafer measurement. . . . . . . . . . .

98

99

99

4.32 Measurement set-up. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 100 4.33 Measured quadrature output voltage of mixing sampler with input at 100.1 MHz. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 102 4.34 Measured and simulated normalized transfer function of mixing sampler. . . 102 4.35 Measured tuning range of mixing sampler. . . . . . . . . . . . . . . . . . . . 103 4.36 Post-layout simulated IIP3. . . . . . . . . . . . . . . . . . . . . . . . . . . . 103 4.37 Simulated P1dB . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 104 4.38 Post-layout simulated IMR. . . . . . . . . . . . . . . . . . . . . . . . . . . . 104 5.1 Frequency response of sinc, sinc2 and sinc3 . fs,f ir =10 MHz, decimation ratio is 2. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 107 Advanced charge-domain sampler with embedded N-path band-pass filter.Circuit Parameters: gm1 = 2mS,gm4 = 1.5mS, gm6 = 4.5mS, Ib1 = 150µA, Ib3 = 235µA, Ib5 = 700µA, Vb = 335mV. . . . . . . . . . . . . . . . . . . . . . . . 108 Response of 4-path band-pass filter in Fig. 5.2 (vo1 excluding M3-M6 and CDS).109 High-order windowed charge-domain sampler. Circuit Parameters: gm =1.5 mS, CS 1 =10 pF, CS 2 =1 pF. . . . . . . . . . . . . . . . . . . . . . . . . . . . 110 Simulated gain-normalized transfer function of proposed charge-domain windowed sampler with 100 MHz input. . . . . . . . . . . . . . . . . . . . . . . 111 Simulated time response of the output signal with Vin = 50mV , fin = 100.2 MHz, Vout = 170 mV, fout = 200 KHz, fs,out = 25 MHz. . . . . . . . . . . . . 112 Simulated time response of the output signal with Vin =50 mV, fin = 100.2 MHz, Vout = 170 mV, fout = 200 KHz, fs,out = 25 MHz. . . . . . . . . . . . . 113 Post-simulated time response of the output signal with Vin =40 mV, fin = 100.2 MHz, Vout = 140 mV, fout = 200 KHz, fs,out = 25 MHz. . . . . . . . . . 113 xiv

5.2

5.3 5.4

5.5

5.6

5.7

5.8

List of Symbols
ADS AI AM BP CAD CDS CHF CM OS dBm EM EP C FF FM FS F SK IM F ILAIO ILO Advanced Design Systems Active Inductor Amplitude Modulation Band-Pass Computer-Aided Design Charge-Domain-Sampler Channel Selection Filter Complementary Metal-Oxide Semiconductor Decibel power with respect to 1 Milliwatt Electromagnetic Gen2 Electronic Product Code Generation 2 (nMOS)Fast-(pMOS)Fast Frequency Modulation (nMOS)Fast-(pMOS)Slow Frequency-Shift Keying Image Rejection Filter Injection-Locked Active Inductor Oscillator Injection-Locked Oscillator

xv

ILF D ISM ISO LC LN A LO LP M IM (-cap) nM OS P LL pM OS P OR PV T RF RF ID RLC SAW SDR SF SS TT U HF V CO

Injection-Locked Frequency Divider Industrial Scientific Medical (radio bands) International Organization for Standardization Inductor-Capacitor Low Noise Amplifier Local Oscillator Low-Pass Metal-Insulator-Metal (Capacitor) n-channel Metal-Oxide Semiconductor Phase-Locked Loop p-channel Metal-Oxide Semiconductor Power-ON Reset Process (supply-)Voltage Temperature Radio Frequency Radio Frequency Identification system Resistor-Inductor-Capacitor Surface Acoustic Wave Software Defined Radio (nMOS)Slow-(pMOS)Fast (nMOS)Slow-(pMOS)Slow (nMOS)Typical-(pMOS)Typical Ultra High Frequency Voltage-Controlled Oscillator xvi

xvii

Chapter 1
INTRODUCTION
1.1 Background
Communication systems are the foundation of information transfer. Based on the transmission media, communication systems are generally categorized into wireless and wireline communications. Wireline communications is often referring to high speed signaling through cables, or micro-strip, which is used in a wide variety of digital systems, i.e. the computer, digital television, sensor networks and data storage center, to name a few. It is now the dominant method for long distance telecommunications and extremely high speed data transmission in short range, e.g. field programmable gate arrays (FPGA) to memory, graphics processing unit (GPU) to memory and Gigabit Ethernet. Oscillators are widely used as local clock generators in phase-lock loop and clock distributions network. Unlike wireline communications, wireless communications is usually making use of radio to transfer information between two or more points which are not physically connected via any electrical conductors. The dramatically increased demand from cell phones and portable mobile products is a drive force to make wireless communications to be the fastest growing segment of the communications industry in the past two decades [1]. The design of low-power, low-cost and high performance radio frequency (RF) transceivers becomes a challenge. Most of the transceivers extensively use filters and oscillators as local oscillators, RF filters, intermediate frequency (IF) filters and channel selection filters, which cover the frequencies from 200 KHz to multi-GHz, depending on their locations in the transceivers [2].

1

One of the key components in transceivers is the frequency synthesizer, synthesizing various RF frequency according to the architecture of transceivers and communication standards. In the integer-N frequency synthesizer, the pre-scalar is the first stage to lower the frequency by integer division. In general, pre-scalars are implemented in a digital form by two static latches connected in a negative feedback loop. It can also be implemented by dynamic latches, e.g. true single-phase clock (TSPC) based divider. The popularity of these two types of digital dividers in RF transceivers is because it is widely believed that the simple structure, the larger bandwidth, and the better robustness of digital dividers over process variations outperform their analog counterparts, e.g. Miller frequency divider [3, 4] and parametric frequency divider [5]. For both static and dynamic pre-scalars, however, a trade-off between the speed and power consumption becomes more critical as the speed increases. The solution to balance the performance and power dissipation is to use injection-locked oscillators to substitute the conventional digital divider. When an incident signal is applied to the oscillator, it is changed from a free-running oscillator to a forced oscillator. The free-running frequency shifts towards the frequency of the incident signal under a certain condition. The detailed description will be given in Chapter 2.1. A simple injection-locked frequency divider (ILFD), so called super-harmonic injection-locked oscillator, is an negative resistor pair LC tank oscillator. The incident signal with higher frequency is injected into the tail transistor. The output of the differential pair shows that the frequency is divided by 2, which fulfils the function of pre-scalar. This structure was analyzed in terms of phase limited and amplitude limited locking range and the noise characteristics in [6]. It achieved locking range by 12.3% at 3 GHz, and later it was used as a pre-scalar to construct a PLL in [7]. Instead of injecting the signal to the tail transistor, the injection signal can be directly injected into the LC tank. [8] proposed a low power quadrature generation circuit by injecting signals to two identical ILFDs. A hard switching model was conceived to give rise to simple expressions for the lock range and output amplitude. [9] presented a wider lock-range high-speed pre-scalar at 50 GHz with a combination of injection-locked oscillators. Except for divide-by-2, odd number superharmonic ILFD was reported [10, 11, 12, 13, 14, 15]. In [14] and [15], the author presented a divided-by-3 pre-scalar, running at higher than 100 GHz frequency. For these designs, 2

one extra inductor or even more inductors were required to create high impedance at 3o (o is the fundamental frequency). A current-mode logic frequency divider was described in [16], which showed 4.1 GHz lock range at 24 GHz frequency. The divide-by-4 was obtained through two divider stages with 0.8 V power supply. It overcame the constrain that the low power supply limits the highest achievable frequency of current mode logic. Apart from injection-locked frequency divider, quadrature injection-locked oscillators are exceptional candidates that can be employed in the low-power high-performance quadrature clock generators [17, 18, 19, 20, 21, 22]. Injection-locked oscillators can also be found in the wireline communications, e.g. reducing timing jitter and clock deskew [23, 24, 25, 26, 27, 28]. Among these applications, the majority is the LC tank based oscillators due to their better noise performance and lower power dissipation. Moreover, there are some other kinds of oscillators for different applications, such as ring oscillators and relaxation oscillators. Owing to their sensitivity to temperature variation and supply voltage fluctuation, non-harmonic oscillators such as relaxation oscillators are widely used in passive wireless microsystems (PWMs) such as implanted medical devices, embedded sensors, and radiofrequency identification tags to generate system clocks that control both the operation of PWMs and their communications with base stations. A stringent frequency requirement for the system clock exists. For example, EPC radio-frequency identity protocols class-1 generation-2 UHF RFID protocols require that the accuracy of the frequency of the backscattered data be bounded by ±4% [29]. Arising from the effect of process spread, supply voltage fluctuation, and temperature variation (PVT), the frequency of these oscillators exhibits a large degree of uncertainty. For example, the variation of the frequency of a free-running oscillator can be as large as ±20% [30]. The uncertainty of the frequency of the system clock of PWMs is further escalated due to the fact that these systems are usually fabricated using low-cost CMOS technologies, which typically have a high degree of process spread. Calibrating the system clock of PWMs prior to their operation is required to ensure the proper operation of PWMs. The effect of supply voltage fluctuation and temperature variation can be compensated using bang-gap circuits [31, 32], their effectiveness is largely hindered by the limited power resources of PWMs, which severely limits the degree of the complexity of compensation circuitry subsequently their performance. Although a number of techniques 3

such as digital trimming [33] and phase-locked loops [34] were used to perform the remote calibration of system clocks, both suffer from a long calibration time and high power consumption. Injection-locking that offers the intrinsic advantage of fast-locking, high frequency accuracy, small fluctuation in power flow, and improved phase noise performance emerged as a power-efficient method to calibrate the system clock of PWMs. Both the carrier [35] and envelope [36] of the signal from the base station were used as injection-locking signals. Injection-locking was also used in calibration of power oscillators for inductive power links [37], the fine frequency tuning of quadrature oscillators [38], self-cascade body-coupled oscillators for biomedical temeletry [39], wake-up receivers for wireless body area networks [40], and FSK transceivers for body sensor networks [41], to name a few. Because the maximum emission power from the base station is regulated, for example, in both EPC and ISO 18000-4, it is 4 watts EIRP (Equivalent Isotropically Radiated Power) and RF power drops quadratically with the distance between transmitters and receivers, the voltage generated by the antenna of PWMs for injection-locking is rather low. As a result, the success of injection-lock based remote frequency calibration is critically determined by the lock range of oscillators. Oscillators with a large lock range are highly desirable. The other part that determines the performance of the transceivers is the architecture of the RF transceivers. Fig. 1.1 shows three possible architectures of the receivers. The most widely used architecture in RF world that has been for many decades is the super-heterodyne receiver, invented by Armstrong in 1917 [42]. It needs two analog mixers to complete two stages frequency translation, in which, at the first stage RF is translated to IF, and then in the second stage it is from IF to baseband signal. The diagram of this receiver is illustrated in Fig. 1.1(a). In the super-heterodyne receiver, the incoming signal is selected by the high-Q bandselected filter and then amplified by the low-noise amplifier (LNA). To reject the strong signals in order to avoid blocking of the receiver, such a filter must be designed to have very high Q-factor, e.g. Q is larger than 100 for digital TV broadcasting. The discrete components, Surface Acoustic Wave (SAW) filters, are more common to be employed to meet the stringent requirements. An image rejection filter (IMF) is indispensable to be

4

IMF
LNA

CHF Lo 1 Lo 2

ADC

(a) ADC I ADC Q (b)

LNA

ADC S ( c)
Figure 1.1: Three receiver architectures: (a) Super-heterodyne receiver, (b) Zero-IF receiver, and (c) SDR receiver.

inserted between LNA and Mixer to filter out the image signal. The signal at the output of the mixer is translated to a lower frequency, where analog or digital processing is easier to perform. A channel selection filter (CHF) performs channel selection at the IF. The last stage is to ensure that the desired signal is in baseband following by an analog-to-digital converter (ADC) to eventually quantize analog signal [43, 44, 45, 46]. Although the super-heterodyne receivers are quite successful because of their simple structure and high selectivity, they suffer from several drawbacks, e.g. less attractive for highly integrated receiver because of external filters, extra rejections for image signals and impedance matching network in the intermediate stage requiring more design effort. To eliminate the extra image rejection filters, zero-IF receivers is then proposed in Fig. 1.1(b). The key concept of this type receiver is to make LO's frequency same as RF signal, converting modulated RF signal to DC directly, thereby resolving image signal 5

problem. The selected RF signal is multiplied by I/Q clock, generated from quadrature LO, to allow the receiver to choose high-side or low-side injection [47, 48, 49]. In [49], an ultra wide band receiver to cover frequency, 3 - 10 GHz, was presented. A LNA with embedded notch filter, providing average -25 dB gain over wide frequency band, with tuning capability to attenuate other interferences was introduced. One step frequency translation and unnecessary image rejection filters are the major benefits of zero-IF receivers. However, the unavoidable drawbacks, e.g. DC offset errors because of LO-self mixing, LO leakage due to parasitic paths, intrinsic flicker noise of MOSFET transistors adding on top of the desired signal and I/Q mismatch [2, 50], existing in this architecture are still concerns. The rapid advance of CMOS technologies has reached the level that analog RF systems can be implemented in such a way that sampled-data and digital signal processing techniques that traditionally championed in low-frequency applications can be utilized in design of RF front-end to reduce cost, improve performance, and enhance reconfigurability. Therefore, the optimal receiver with maximum flexibility and lowest cost for a receiver can be realized by pushing ADC towards antenna, Fig. 1.1(c). The RF signal will be directly sampled and quantized through ADC, introducing baseband digital signal processing into RF. The ADC must be very linear and is capable to deal with large variation of signal range. Unlike analog mixers, the frequency translation can be done in digital domain, minimizing phase and gain error over wideband, which is the inherent obstacle in analog mixers. Such a concept, defined as software-defined radio (SDR) and was first proposed by Mitola in 1995 [51], and become more important recently. The importance of this architecture also stems from more complex spectrum planning, which was specified by different organizations (ITU, IEEE, 3GPP and etc.). Fig. 1.2 shows a couple of examples in the spectrum of 50 MHz to 4 GHz, including short-range communication standards RFID, mobile digital TV standard DVB-T, cellular standards GSM, UMTS, and LTE, and the wireless networking standards Wi-Fi and WiMAX. However, design such an ADC, meeting all the requirements, become more challenge. For example, ADC, applying to SDR receiver directly, must have sufficient dynamic range and handle both low and high power signals without any high-Q filtering [52]. As a result,

6

TV Ch FM/AM

DVB-T

RFID GSM

Bluetooth LTE DCS WiFi PCS GPS UMTS LTE

WiMAX

54M

470M

1G

2G

3G

4G

Figure 1.2: Spectrum allocation for wireless communications.

unacceptable power dissipation, usually in Watts, overwhelms benefits of the architecture. In comparison with pushing ADC towards antenna, as transceivers can be loosely partitioned into RF analog front-end and digital back-end with the digital back-end fully programmable, to have reconfigurable RF analog front-ends is more attractive.

1.2

Motivation and Objectives for Injection-Locked Oscillators

1.2.1

Injection-Locked Active Inductor Oscillators The oscillators that are employed in data communications over wireless systems are

typically LC oscillators with spiral inductors or transformers, owing to the stringent phase noise requirements. On the other hand, LC oscillators suffer from small lock range without paralleling a number of varactors due to the passive components, e.g. passive inductors and capacitors, which also lead to large silicon consumption. One way to combat these problems is to use active devices, which provide a large tuning range of impedance, to substitute the passive devices, especially the large inductors are replaced with active inductors (AI), and varators are removed thereby saving a large amount of silicon area. Active-inductor-based oscillators, however, exhibit poor noise performance attributed to the more noisy devices being used. [53] showed that phase noise of an injection-locked oscillator can be reduced to the level comparable to that of the injecting signal in the lock state. The ability to lower the phase noise of injection-locked active inductor oscillators (ILAIO) to the level of the external "clean" signal and the large frequency tuning range make active inductor oscillators particularly attractive for injection-locked frequency dividers [54, 55, 13, 56, 57, 58]. Also 7

the relative poor phase noise of injection-locked active inductor oscillators is not of a critical concern for some applications, e.g. phase shifters [59] and limiting amplifiers [60]. The analytical study of phenomenon of injection locked oscillators was first presented by Adler [61]. Later Razavi derived the well-known equations of lock range for CMOS oscillators in [53] by making use of a phasor domain approach. Recent published papers [62, 63, 64], using different approaches to explain the locking process, continue to disclose new findings. None of them, however, can be applied to the injection-locked active inductor oscillators thereby deeply exploring the lock range. The mechanism of why ILAIOs provide large lock range is still unclear although it has been reported in many publications. Therefore, there is no doubt that the need to explore the relation between the lock range and the active inductor oscillator is of interest. In this dissertation these issues will be resolved by exploiting 1) the intrinsic relation between the lock range and the injection-induced variation of the impedance of LC tank, 2) the lock range of injection-locked active inductor oscillators attributed to both the low quality factor and the large injection-induced variation of impedance. In addition, a simple but effective approach to derive the expression of the lock range will be presented.

1.2.2

Injection-Locked Non-Harmonic Oscillators The preceding introduction for different applications of injection-locked oscillators

will eventually come to the most widely studied subject: How to increase the lock range of injection-locked oscillators. A number of novel design techniques emerged to increase the lock range of injection-locked LC frequency dividers. Chang et al. showed that the lock range can be increased if the dc component of the voltage of the output of the oscillator is used to tune the varactor of the oscillator [65]. This is essentially a varactor-tracking technique that automatically forces the varactor voltage to track the control voltage of the oscillator so as to achieve an effective large lock range even though the absolute lock range of the oscillator is not increased. Since the lock range of injection-locked LC oscillators is inversely proportional to the quality factor of the oscillators, lowering the quality factor of the oscillators will effectively increase the lock range. Both series resistance [66] and shunt 8

resistance [67] methods emerged to achieve this. To increase the lock range, the strength of internal locking signals that actually mixes with the output of the LC tank and determines the lock range must be maximized. Wu and Hajimiri showed that although the strength of an external injection signal is high, its strength is severely attenuated by the parasitic capacitances of the path over which the actual locking signal is generated. As a result, only a small lock range can be achieved in spite of a strong external injection signal [68]. To combat this, the internal locking signal must be maximized prior to mixing. Inductive series-peaking [69], sub-threshold mixing [10], and transformer positive feedback [70] have been proposed for this purpose. To determine the lock range of ring oscillators, a time-domain approach was given in [71]. Although a ring oscillator can lock to a locking signal injected to only one node of the oscillator, a larger lock range can be obtained if the locking signal is injected into the multiple stages of the oscillator simultaneously [72, 73]. The lock range can be further increased if the phase of each of the multiple injections is properly chosen [69, 74]. Jin et al. showed that the lock range of injection-locked ring oscillators can be improved by employing a feedback resistor between the input and output of the oscillators [75]. The inserted resistance effectively lowers the quality factor of the oscillators so as to boost the lock range. Injection-locked relaxation oscillators were also studied in [76, 77, 78]. Soltani and Yuan showed that integrating feedback that integrates the difference between the frequency of the injection-locking signal and that of relaxation oscillators improves lock range [36]. The preceding narrow-band techniques for lock range enhancement of LC oscillators are not applicable to non-harmonic oscillators due to the fact that an infinite number of frequency components exist at the output of non-harmonic oscillators whereas only a singlefrequency component exists at the output of LC oscillators. The latter permits the use of impedance peaking techniques at a selected frequency and location to maximize the effective internal locking signal so as to achieve a large lock range. Although ring oscillators in several designs have been demonstrated to be able to yield a larger lock range, an in-depth study of the mechanism and factors that determine the lock range of non-harmonic oscillators and methods that increase the lock range of these oscillators are critically needed but not available yet.

9

In this dissertation, the missing points will be added in the following chapters, including 1) an analytical treatment of the intrinsic relation between the phases of the multiple injection signals, which is essential in design of non-harmonic oscillators with multiple injections in order to yield a large lock range, 2) the intrinsic relation between the lock range of non-harmonic oscillators with single injection and that with multiple injections, though fundamentally important in understanding why non-harmonic oscillators with multiple injections can yield a large lock range, and 3) a comprehensive study of lock range for single-tone and multi-tone injections for non-harmonic oscillators, which was not appeared in any publications.

1.3

Motivation and Objectives for Charge-Domain Sampling Circuits with Tunable Band-Pass Filter
To handle different requirements for signal bandwidths and data rates, the most of

commercial transceivers are often realized either by integrating multiple silicon component cores optimized for individual wireless standard on the same substrate or be packaging multiple silicon chip sets. Both approaches are costly. In addition, they provide inflexibility in coping with new standards in wireless communications. To overcome it, a number of design techniques have emerged for silicon implementation of SDR. Among them, charge-domain windowed sampling that provides an inherent sinc low-pass characteristic with FIR filtering to attenuate unwanted channels, suppresses the fold-over of broadband noise to the desired baseband, and nulling out aliasing interferences while exhibiting a low sensitivity to clock jitter and consuming less power is a promising technique [79]. Muhammad and Staszewski showed that IIR filtering from the recursive operation of a history capacitor(charge residual) and rotating capacitors(charge shared) provide an additional 20 dB stop-band attenuation [80, 81]. However, it can only be applied to the bluetooth frequency band. By changing the sampling frequency, the ratio of the capacitance of the history capacitor to that of the rotating capacitors, and the number of the rotating capacitors, the characteristics of built-in low-pass and anti-aliasing filter can be made programmable [82, 83]. Unfortunately, these

10

designs are less attractive because of the necessary of the external pre-selection for the suppression of out-of-band interferences. The active integrators employed in the designs also degrade the noise figure and linearity. Because a channel typically occupies a frequency band rather than a single frequency, the suppression of unwanted tones provided by these filters in the neighbor of the nulls is often insufficient [84, 85]. Increasing the sampling frequency, though improving the suppression of unwanted tones in the vicinity of the nulls to a certain extent, increases power consumption. Mrizaei et al. showed that anti-aliasing and low-pass filtering from charge-domain windowed sampling can be improved simultaneously by employing sinc2 filtering [52, 74, 86]. Yoshizawa and Iida proposed a wide-band chargedomain baseband filter [87]. However, fixed-centre-frequency band-pass filter is still required in those receivers, making charge-domain sampling circuits less attractive for the increasing complexity of frequency bands. Recently, N-path filters widely popular in switched-capacitor band-pass filters have attracted a great interest to realize programmable high-Q band-pass filters [88, 89, 90]. The tunable center frequency and bandwidth, low cost, and full compatibility with digital CMOS make these filters particularly attractive for SDR. The common issue for the presented design is the lack of sufficient attenuation for the undesired signal accompanying with wanted signal deteriorates signal-to-noise ratio(SNR). In particular if the aliasing signal is on top of the desired signal, there is no doubt that the sensitivity of the receiver is lowered. The worst case is a large out of band or in band interference will block the receiver, severely degrading the performance of the overall RF communication system. In this dissertation, the lack of filtering functions will be tackled by proposing new architectures, including 1) a new charge-domain quadrature downconversion circuit with a tunable band pass filter, 2) a new charge-domain sampling circuit with high-order FIR filter embedded. The sufficient study of principles of periodic impulse sampling, periodic windowed sampling, and periodic N-path windowed sampling will also be provided. Detailed mathematical treatments of charge-domain windowed samplers will be given.

11

1.4

Contributions
The original contributions of the dissertation are summarized in this section.

1.4.1

Injection-Locked Oscillators In this dissertation, the indispensable mathematical treatments for enlarging the lock-

range of the ILAIOs are given, exploring the mechanism of how ILAOs are able to offer large lock range thereby providing a clear guidance of deigning ILAIOs. In addition, a systematic and in-depth investigation for the injection-locked non-harmonic oscillators are completed. Several approaches are proposed to widen the lock range of non-harmonic oscillators, making them particularly attractive for applications such as PWMs where the accuracy of the frequency generated from the local oscillator is heavily affected by PVT. The contributions are listed as below: 1. Formalized the intrinsic relation between the lock range and the injection-induced variation of the impedance of LC tank. 2. Explored the mechanism of enlarging the ILAIOs. 3. Proposed a simple but effective approach to analyze the injection-locked oscillators. 4. Proposed a new approach to widen the lock range of the injection-locked non-harmonic oscillators. 5. Formalized the impacts on the lock range from different phase and tones of injections. Extensive simulation results associated with the injection-locked active inductors and non-harmonic oscillators are presented.

1.4.2

Tunable Band-Pass Filter Embedded Charge-Domain Sampling Circuits A novel sampling mixer with programmable centre frequency of the band-selection

filter and -3 dB frequency of the anti-aliasing filters are proposed, providing a large freedom 12

of selection of any frequency band signals without using discrete components. The timeinterleaved structure are utilized to achieve the optimal aliasing rejection. And the -3 dB frequency is controlled by the sampling clock. The contributions include: 1. Proposed a novel architecture for software-defined radio. 2. Proposed a high-order embedded FIR filter in the sampling circuit. 3. Completed a in-depth study of periodical N-path sampling and charge-domain sampling. 4. Provided a unique noise analysis for the new architecture. The detailed mathematical analysis and circuit simulation results of the proposed circuits are given. The layout and on-chip wafer measurement results of the circuits are provided.

1.5

Thesis Organization
The rest of the thesis is organized as follows:

· Chapter 2 presents a systematic study for the injection-locked active inductor oscillators. In the mean time, an novel approach to analyze the lock range of the injection-locked oscillators is also provided. The relation between the lock range and the impedance variation of active inductor oscillators is given. · Chapter 3 presents a detailed investigations on injection-locked non-harmonic oscillators. The lock range of multiple multi-tone injection-locked oscillators is formalized. An example, relaxation oscillator, is used to verify the findings. · Chapter 4 presents a low-power tunable band-pass filter embedded quadrature downconversion sampling circuit for SDR. In this chapter, mathematical derivation for the sampling network is provided and circuit implementation is shown. 13

· Chapter 5 presents an alternative charge-domain sampling circuit with high-order sinc filter embedded. The circuit implementation is given, accompanied with simulations and measurements. · Chapter 6 draws conclusions and brings some future research directions.

14

Chapter 2
Injection-Locked Active Inductor Oscillators
In this chapter, the lock range of injection-locked active inductor oscillators is derived in analogous to the analysis of oscillators in a linear feedback system. Making use of this novel approach, the relation between injection ratio and impedance variation of injectionlocked oscillators and lock range is analyzed analytically. The remaining of the chapter is organized as the follows: This chapter starts from introduction of injection-locked oscillators in Section 2.1. It is followed by a brief description of active inductor oscillators in Section 2.2. A study of lock range for LC tank oscillators is given in Section 2.3. Section 2.4 explores the intrinsic relation between lock range and impedance variation of injection-locked oscillators. A case study is presented in Section 2.5. A summary is provided in Section 2.6.

2.1

Injection-Locked Oscillators

Vin

Ho
Figure 2.1: A feedback system.

Vout

A typical feedback system with unity loop gain is illustrated in 2.1, the transfer function is given as 15

Ho (j ) Vout (j ) = Vin 1 + Ho (j )

(2.1)

Unlike an amplifier with negative feedback, which is often to set enough phase margin at the unity-gain frequency to make the feedback stable, in the self-sustaining autonomous system, a unstable negative feedback is desired. From 2.1, if Ho (jo )=-1, the loop gain approaches infinity. A noise component at o experiences a total gain of unity and a phase shift of 180 , returning to the subtractor as a reversed input signal. The output of subtractor becomes larger and continuous to grow. As a result, an oscillating signal is obtained. In general, if a negative-feedback system with loop gain satisfies "Barkhausen criteria". |Ho (jo )|  1 Ho (jo ) = 180 the feedback system may oscillate at o . In an ideal "LC tank" circuit, a charged capacitor is connected to an inductor, this charge will flow back and forth between the inductor and capacitor, causing voltage across  the capacitor to oscillate at the frequency of o =1/ LC . In other words, the impedance of the inductor and the capacitor are equal and opposite, resulting open-circuit at o ideally. In reality, real inductor and capacitor are always associated with parasitic resistances in which partial energy is absorbed, yielding a decayed waveform. To maintain oscillation, negative resistances are placed in the tank to compensate the parasitic resistances. Such a circuit configuration is given a name as cross-coupled LC oscillator [91]. If an incident signal, Iinj , operating at inj , is injected into the tank, the tank is under perturbation, which is so called injection process, as shown in Fig. 2.2. As the injection signal is increased from weak to relatively strong, and the frequency of the injection signal is close enough to 0 , the output of the oscillator is starting to be


(2.2)

16

|Vinj|

|Vo|

wo Dw

winj w
(a)

wo Dw Dw

w

wo Dw

winj w
(b)

wo Dw Dw

w

wo Dw

winj w
( c)

wo Dw Dw

w

Figure 2.2: Injection locked procedure represented in simplified spectrum diagram. (a)Unlocked, (b) Fast beat, and (c) Locked.

pulled towards the injection signal and eventually is synchronized with it. The condition for the synchronization was first examined by Alder [61] in 1946.

E1  = 2Q . E 0

(2.3)

Where E1 and E are the impressed voltage and the oscillating voltage respectively. Q denotes the quality factor of the tank. 0 and  are free-running frequency and the maximum difference between the frequency of the injection signal and the free-running frequency of the oscillator over which a lock state can be established. Although the pioneering work of Adler on injection-locking in oscillators has been widely accredited, the phasor domain treatment of the injection-locking and pulling of oscillators by Razavi provides the much

17

needed insight of the locking and pulling processes of oscillators under injection [53].  = o Iinj 2Q Io 1 1-
Iinj Io 2

(2.4)

where Iinj is the amplitude of the injection current, and Io is the amplitude of the current of the LC tank. If Iinj Io , i.e. weak injection, (2.4) is simplified to

 

o Iinj . 2Q Io

(2.5)

It is seen from (2.5) that the lock range of the oscillator is directly proportional to the strength of the injection signal and inversely proportional to the current and quality factor of the LC tank.

2.2

Active Inductor Oscillators
CMOS active inductors are active networks that consist mainly of MOS transistors.

As compared with their spiral counterparts, CMOS active inductors offer many advantages, e.g. a large amount of silicon area saving, large and tunable inductance and more compatibility with digital CMOS technologies [92]. Passive capacitors may be added in the circuits to change frequency. Sometimes resistors are used as feedback elements to improve performance of active inductors. When the active networks are biased properly, the networks exhibit an inductive characteristic at a specific frequency range. Fig. 2.3 shows an active inductor network, where C1 and Go1 , C2 and Go2 denote the total capacitances and conductances at nodes 1 and 2 respectively. The admittance looking into port 2 of the network is shown as:

18

G m1 V 2 V in 2 G m2 V 1 G o2 C2 V1 G o1 C1 I in V2 1

V in

I in

Rs Rp Cp L
V in

Rs Cp L I in

Figure 2.3: Single-ended active inductor.

Y =

Iin V2 1 s
C1 Gm1 Gm2

= sC2 + Go2 +

+

Go1 G m1 G m2

.

(2.6)

(2.6) can be represented by equivalent RCL circuit in Fig. 2.3 with its parameters given by

Rp =

1 Go2

Cp = C2 Rs = L=
Go1 Gm1 Gm2 C1 . G m1 G m2

(2.7)

19

It can see from (2.7), the resonant frequency is 0 =

(Gm1 /C1 )(Gm2 /C2 ). And also the

tuning range of the inductance is determined by C1 , Gm1 and Gm2 , which in general Gm1,2 is controlled by DC biasing voltage. Fig. 2.4 lists some of examples. In Fig. 2.4(a), Wu current reuse active inductor will be used to construct an oscillator for the rest of study [93]. Fig. 2.4(b) use NMOS and PMOS to form an inductor [94]. The simplest active inductor [95] is illustrated in Fig. 2.4(c).

M1

Vb2
M2

Vin

M2

M1

R

Vin Vb1 M4
M3

Vb1

Vb2

M1

M3

Vin
(b) (C)

(a)

Figure 2.4: Examples of active inductors. (a) Wu current reuse active inductor , (b) Lin active inductor , and (c) Hara active inductor

.

2.3

Lock Range of Generic LC Oscillators
Consider the simplified schematic of an injection-locked LC oscillator shown in Fig.

2.5(a). The inverting buffer is needed in order to satisfy Barkhausen criteria. Let Iinj denote the injection signal and ZT denote the impedance looking into the LC tank. Since Io + IT = Iinj and Io = -gm ZT IT where gm is the transconductance of the transistor, the injection-locked oscillator can be represented by the familiar block diagram used in control systems shown in Fig. 2.5(b) with Iinj the input, IT the output. Note that Fig. 2.5(b) is a linear system when locked. When the injection signal is absent, the oscillator is an autonomous system that oscillates at o , the self-resonance frequency of the LC tank. When a sinusoidal signal of frequency inj = o +  is injected and the oscillator is locked to the injection signal, it will oscillate at o +  . Since inj =o , the impedance of 20

R

L

C

IT -1
(a)

Iinj Iinj

IT

Io

Ho

Io

(b)

Figure 2.5: (a) Injection-locked oscillators. (b) Block diagram of injection-locked oscillators.

the LC tank at o +  will deviate from its value at o , as illustrated graphically in Fig. 2.6. Clearly ZT (o +  ) = ZT (o ) - ZT (2.8)

where ZT is the injection-induced impedance variation of the LC tank. Since  is caused by Iinj , ZT is also a function of Iinj . Further, since  and ZT are determined by Barkhausen criteria for oscillation, the same amount of phase and impedance variation is required to satisfy Barkhausen criteria regardless whether the quality factor of the LC tank is high or low. As a result, for the same injection signal, the high the quality factor of the LC tank, the smaller the frequency variation  , as illustrated graphically in Fig. 2.6. Now let us consider the control system of Fig. 2.5(b). When the oscillator is locked to the injection signal, it will oscillate at o +  and Io (o +  ) = Ho (o +  ) Iinj (o +  ). 1 + Ho (o +  ) (2.9)

Note that in (2.9) the oscillating frequency is explicitly stated as we are only interested in the behavior of the oscillator in the lock state. Assume that  o , which is often the

21

ZT

DZ T

ZT DZ T

wo ZT Df

f ZT

wo

f

Df f f Dw (b) Low Q

Dw (a) High Q

Figure 2.6: Impedance of the LC tank of injection-locked LC oscillators.

case, the first-order approximation Ho (o +  )Ho (o ) + Ho ( )  
o

(2.10)

can be utilized to simplify (2.9) Io (o +  ) Ho (o +  ) Ho ( ) 1 + Ho (o ) +  Iinj (o +  ). 
o

(2.11)

The first-order approximation is only valid if the injection is weak. Since the injection signal is absent, 1 + Ho (o ) = 0, i.e. Barkhausen criteria, (2.11) is simplified to Io (o +  ) Ho (o +  )
Ho ( ) 

Iinj (o +  ).

(2.12)


o

Focusing on the amplitude only |Io (o +  )|  |Ho (o +  )|
Ho ( ) 

|Iinj (o +  )|.

(2.13)

| |
o

22

Given Ho ( ) = Aej , we have Ho ( ) =  A  + Aj   ej (2.14)

As |A(o )| = 1 because of 1 + Ho (o ) = 0,

Ho ( ) 

=
o

A 

2

+

 

2

(2.15)

Making use of the definition of the quality factor [96] o 2 A 
2

Q=

+
o

 

2

(2.16)
o

We arrive at Ho ( )  Substituting (2.17) into (2.13) =
o

2Q . o

(2.17)

|Io (o +  )|

|Ho (o +  )| |Iinj (o +  )|. 2Q | | o

(2.18)

Further from Fig. 2.5, |Io (o +  )| = |Ho (o +  )||IT (o +  )| (2.19)

equating (2.18) and (2.19) yields | | = o Iinj (o +  ) . 2Q IT (o +  ) 23 (2.20)

It is of interest to comment above results : 1. When the injection is weak, i.e., Iinj Io , Io IT follows. As a result, (2.20) is the same

as (2.5). Note that the latter was derived in a simple but efficient way in comparison with the approaches used in the previous published papers. 2. The preceding results are derived on the condition that the oscillator is locked to the injection signal. | | quantifies the maximum frequency deviation from o upon which lock holds. It is therefore the lock range of the oscillator for given Iinj . 3. (2.20) is only valid when (2.10) holds. This typically occurs when the amplitude of the injection signal is small with respect to the Io . This agrees well with the condition upon which (2.5) was derived. 4. Since | | = |inj - o |, the lock range is only symmetrical if IT (o +  ) = IT (o -  ), otherwise, asymmetric lock ranges exist. As the ratio of injection current to oscillator current increases, this condition will no longer be valid. This is especially true for low-Q oscillators, such as active-inductor oscillators [97] 5. A small Q will result in a large lock range. This echoes early findings on the relation between the impedance variation and Q of the LC tank in Fig. 2.6.

2.4

Lock Range and Tank Impedance Variation
It was pointed out earlier that the injection signal causes the variation of the impedance

of the tank. This observation reveals that an intrinsic relation between the injection signal and the variation of the impedance of the resonant tank exists. To quantify the relation between the injection signal and the variation of the impedance of the tank, consider Fig. 2.7. In Fig. 2.7(a), a current Iinj of frequency o +  is injected to node 2 of the oscillator. The oscillator is locked to the injection signal and oscillates at o +  . In Fig. 2.7(b), the effect of the injection signal on the oscillator is represented by the variation of the impedance of the LC tank (assume gm -cell is constant). Note that Fig. 2.7(a) is a forced oscillator while 24

Fig. 2.7(b) is a free-running oscillator, in which the impact of the injection signal has been merged into the LC tank, denoting by Z .

gm ZT

Io,a I T,a

2 -1 Iinj

gm ZT + DZ

Io,b I T,b

2

-1 Iinj

(a)

(b )

Figure 2.7: (a) Injection-locked oscillators. (b) Equivalent circuit of injection-locked oscillators. The dotted line represents the real injection signal, which has been merged into the variation of the LC tank.

Fig. 2.7(a) and Fig. 2.7(b) are said to be equivalent only if the voltages at node 2 of the two systems are identical. Since V2,a = ZT (Iinj - Io,a ) and V2,b = (ZT + ZT ) (-Io,b ) where ZT is evaluated at o +  , from V2,a = V2,a , we have Io,a = Io,b = Io . As a result, ZT Iinj (o +  ) = . ZT IT (o +  ) (2.21)

(2.21) reveals that the effect of the injection signal can be quantified by the variation of the impedance of the tank. Substituting (2.21) into (2.20) yields | | = o ZT . 2Q ZT (2.22)

The preceding results are commented as : 1. For passive LC oscillators, since the quality factor of varactors is typically much higher(minimum Q is 80 in IBM CMRF8SF 130 nm technology) as compared with that of spiral inductors(maximum Q of differential inductor is 25 in IBM CMRF8SF 130 nm technology), the quality factor of passive LC tanks is dominated by that of the spiral inductors. Since passive LC tanks exhibit a large quality factor as compared 25

with that of active inductors, injection-locked passive LC oscillators have a small lock range while that of active-inductor oscillators have a large lock range. 2. The larger the normalized variation of the tank impedance induced by the injection signal, the larger the lock range. For spiral LC oscillators, since the effect of the injection signal on the capacitance of the varactors of these oscillators is small, ZT /ZT is small as well. As a result, the lock range of these oscillators is small. This is in addition to the effect of the high quality factor of passive LC tanks, which also gives rise to a small lock range. 3. The inductance of active inductors varies with the injection signal especially when the injection signal is strong, ZT /ZT of active inductors is large. As a result, activeinductor oscillators exhibit a large lock range. This is on top of the effect of the low quality factor of active inductors, which contributes to the large lock range of these oscillators. 4. The symmetry of the lock range is clearly determined by the symmetry of |ZT |. Since active inductors are gyrator-based whose operating points are bias-dependent and injection signals affect the bias conditions, active-inductor oscillators will exhibit more asymmetrical lock ranges. 5. For passive LC oscillators, an injection signal will cause the capacitor of the varactors to change. For active-inductor oscillators, it is the inductance of the active inductors that will change with the injection signal. Consider an LC tank with its C changed to C + C . Let ZRL = R||sL, where "||" denotes ^ c = 1/s(C + C ) = Xc - Xc , where Xc = Xc (C/C ) and parallel connection. Since X Xc = 1/sC . The impedance of the tank is obtained from

^T ZT 1 + Z

ZRL Xc (ZRL + Xc )Xc

(2.23)

26

from which we arrive at ZT  ZRL ZT Xc . (ZRL + Xc )Xc (2.24)

Note that first-order approximation was utilized in derivation of (2.23). In a similar manner, one can show that when L is changed to L + L, we have ZT  ZRC ZT XL (ZRC + XL )XL (2.25)

where ZRC = R||(1/sC ), XL = sL, and XL = XL (L/L). The preceding results demonstrate that ZT is directly related to C or L.

2.5

Comparison of Injection-Locked LC Oscillators and Active Inductor Oscillators
In this section, it will be given that C of injection-locked passive LC oscillators

or L of injection-locked active-inductor LC oscillators are indeed caused by the injection signal. Two oscillators are designed running at 2.4 GHz for the comparison purpose.

L1 C1

Vc

L2 C2

vo1

vo+
2
M2 M5

vinj+
M4 M1

vinj-

Vb

M3

Figure 2.8: Injection-locked passive LC oscillator. C1 and C2 are accumulation MOS varactors. Circuit parameters : W1,2 = 10µm; W3 = 15µm, W4,5 = 1µm, Vc = 1.2 V, Vb = 0.66 V, Ids3 = 1.42 mA.

27

Passive LC Oscillators Consider the injection-locked passive LC oscillator in Fig. 2.8. Assume that the variation of the capacitance at nodes 1 and 2 is dominated by change of the capacitance of the varactors. Let the voltage across varactor C1 be Vc1 = V - Vc + V , where V is the dc voltage of node 1, and V is the variation of the voltage across C1 due to both injection and oscillation. Similarly, the voltage across C2 is given by Vc2 = V - Vc - V . The corresponding capacitances of varactors 1 and 2 are given by C1 = C + Cosc + Cinj and C2 = C - Cosc - Cinj , where C is the capacitance of the varactors in the dc steady state, Cosc is the oscillation-inducted capacitance variation and Cinj is the injection-induced capacitance variation. Assume Cosc , Cinj denoted by C12 , is obtained from C . The capacitance between nodes 1 and 2,

C12 =

C (Cosc + Cinj )2 1- . 2 C2

(2.26)

From (2.26), it can be seen that the parentheses term indicates the variation of the overall capacitance due to the injection signal and oscillation. Since the capacitance looking into the negative resistor network and the capacitance of the injection transistors are rather constant, the total capacitance variation at nodes 1 and 2 is largely reduced, resulting in a narrow lock range. Active Inductor Oscillators Consider the injection-locked active inductor oscillator in Fig. 2.9 that employs Wu currentreuse active inductors reported and shown in the shade area. Wu active inductor can be represented by an RLC equivalent circuit with Cp = Cgs2 , Rp = 1/gm2 , Rs = (go2 + go3 )/(gm1 gm2 ),and L = Cgs1 /(gm1 gm2 ), where gm and go are the transconductance and output conductance of M1, respectively [92]. It is evident that L, Rp , and Rs of the active inductor can be varied by adjusting the current of M1 and M2. Since the current of M2 is constant, it is reasonable to assume that gm2 is constant. As a result, Vg,2 = Vs,1 are also constant. gm1 , however, varies with both oscillation and the 28

Figure 2.9: Schematic of injection-locked active-inductor VCO with Wu active inductors. Circuits parameters :W1a,1b = 40µm, W2a,2b = 18.9µm, W3a,3b = 4µm, W4,5 = 10µm, W6 = 15µm, W7,8 = 1µm, Vb1 = 0.34 V, Vb2 = 0.48 V, Vb3 = 0.7 V, Ids3 = 131µA, Ids6 = 1.42 mA.

injection signal. Because ID1 = J1 + iinj + inr , where inr is the current of the negative resistor and iinj is the injection current. Let VT = VT N = |VT P |, we have gm1 = gm1,DC 1 + iinj inr + J1 J1 (2.27)

where gm1,DC = 2J1 /(VSG1 - VT ) is the transconductance of M1 in the dc steady state. Let
- i+ nr = I + I and inr = I - I where I = J2 /2. The inductance of the active inductor is

given by LDC 1 + JI1 1 1+
iinj +I J1 +I

L1 =

(2.28)

where LDC = Cgs1 /(gm1,DC gm2,DC ). Similarly, LDC 1 + JI1 1 1-
iinj +I J1 +I

L2 =

(2.29)

29

Since active inductors L1 and L2 are connected in series, the inductance looking into nodes 1 and 2 is given by 2LDC 1+ 1 + JI1 I + iinj J1 + I
2

L12 =

.

(2.30)

The variation of the overall inductance is due to the injection signal and the oscillation. Since iinj directly affect L12 while in the injection-locked passive LC oscillator, the injection current impacts the capacitance of the varactors through the voltage of nodes 1 and 2, the injection signal will have a large impact on the inductance of the injection-locked active-inductor oscillator subsequently a large lock range. The passive LC tank oscillator shown in Fig. 2.8 and the active-inductor LC oscillator shown in Fig. 2.9 are utilized to validate the results derived earlier. Simulations are done in Cadence SpectreRF. The incident power of injection signal for both oscillators is a -18 dBm, the ratio of Iinj /Io = 0.05 2.40205 GHz sinusoid with phase noise -126 dBc/Hz at 1 MHz frequency offset. Fig. 2.10 plots the phase noise of the passive LC oscillator. The phase noise of the oscillator without injection-locking is -102 dBc/Hz at 1 MHz frequency offset and -124 dBc/Hz when locked. Fig. 2.11 plots the phase noise of the active-inductor oscillator, simulated in Cadence Spectre. The phase noise of the oscillator without the injection-locking reference is -70 dBc/Hz at 1 MHz frequency offset and is reduced to -118 dBc/Hz when locked. To provide a fair comparison of the lock range, the negative resistors of the oscillators are biased at the same level. The swing of the output voltage of the oscillators is also made identical. Fig. 2.12 is dependence of the lock range on the injection signal. It is observed that the lock range is directly proportional to the injection signal. This agrees well with the theoretical results. Also observed is that the lock range of injection-locked active inductor oscillator is much larger as compared with that of the injection-locked passive LC oscillator. To demonstrate the larger lock rang of the active inductor oscillator is not only due to the

30

0 -20 -40 Phase Noise (dBc/Hz) -60 -80 -100 -120 -140 -160 -180

W/O Injection Under Injection Injection Reference

10

2

10

4

10 Frequency (Hz)

6

10

8

Figure 2.10: Simulated phase noise of passive LC oscillator Iinj /Io = 0.05.

0 -20 -40 Phase Noise (dBc/Hz) -60 -80 -100 -120 -140 -160 -180
2 4 6

W/O Injection Under Injection Injection Reference

10

10

10 Frequency (Hz)

10

8

Figure 2.11: Simulated phase noise of active-inductor LC oscillator Iinj /Io = 0.05.

low quality factor but injection-induced impedance variation, the re-sized passive oscillator by inserting series resistors to lower Q-factor, which is in the comparable level to the active inductor oscillator, is simulated. The lock range of passive one is still less than the active one.

31

Lock Range Vs Iinj/Iosc 1400 AI VCO (Q=1.4) Passive VCO (Q=5) Passive VCO (Q=1.6)

1200

1000 Lock Range (MHz)

800

600

400

200

0

0

0.02

0.04

0.06

0.08

0.1 Iinj/Iosc

0.12

0.14

0.16

0.18

0.2

Figure 2.12: Simulated lock range.

Active inductor oscillators are low-Q systems. When injection ratio increases, not only lock range will increase, the asymmetry of the lock range of these oscillators will also becomes more prominent. This is evident in Fig. 2.13 where the positive and negative lock ranges of the active inductor oscillator investigated in this paper are plotted. The asymmetry of the lock range is evident.

2.6

Summary
In this chapter, an in-depth investigation of the lock range of injection-locked LC os-

cillators using a control system approach has been presented. The intrinsic relation between the lock range of these oscillators and the injection-induced variation of the impedance of the LC tank of these oscillators has been explored. The large lock range of injection-locked active-inductor oscillators is attributed to both the low quality factor and the large injectioninduced variation of the inductance of active inductors.

32

Up-side & Down-side lock range Vs Iinj/Iosc 1200 Up-side Lock Range Down-side Lock Range 1000

Lock Range (MHz)

800

600

400

200

0

0

0.05

0.1

0.15 Iinj/Iosc

0.2

0.25

0.3

0.35

Figure 2.13: Asymmetry of the lock range of injection-locked active-inductor oscillator.

33

Chapter 3
Multiple Multi-Tone Injection-Locked Oscillators
In general, Volterra series can be used to analyze a non-linear behaviour. In this chapter, an approach similar to Volterra series is employed to explore the non-harmonic injection-locked oscillators. The oscillators can be analyzed by applying a set of linear circuits, having the same topology and element values but different inputs. The analytical study of the lock range is also given in detail. The remaining of the chapter is organized as the follows: Section 3.1 presents a simplified mode of injection-locked non-harmonic oscillators. Section 3.2 investigates the single-tone and multi-tone injections for non-harmonic oscillators. Section 3.3 gives an analysis for harmonic injection-locked oscillators with multiple injections. Section 3.4 examines the non-harmonic injection-locked oscillators with multiple injections. Section 3.5 shows the study of lock range of non-harmonic oscillators with multiple singletone injections. A relaxation oscillator is given as an example in Section 3.6. A study of lock range of non-harmonic oscillators with multiple multi-tone injections is presented in Section 3.7, followed by simulations in Section 3.8. A summary is provided in Section 3.9.

3.1

Representation of Non-Harmonic Oscillators
The waveform of the output voltage of LC oscillators is sinusoidal whereas that of

non-harmonic oscillators is typically square-like. To capture the essence of non-harmonic oscillators, assume that the output of these oscillators is a purely square wave such that it 34

can be represented by a Fourier series with the fundamental frequency o = 2/To where To is the frequency of the oscillator. If the waveform of the output of the oscillator is shown in Fig.3.1(a), then its spectrum will only contain the fundamental and odd harmonics. Since the spectrum of the output of the oscillator only consists of a train of impulses at o , 3o , 5o , ..., the oscillator can be considered as the assembly of ideal harmonic oscillators whose frequency spectrum only contains single tones at o , 3o , 5o , ... When the noise and loss of the non-harmonic oscillator are considered, the square waveform of the non-harmonic oscillator is replaced with those shown in Fig.3.1(b). In this case, the impulses are replaced with skirts.

Figure 3.1: Waveform and spectrum of non-harmonic oscillators.

Neglect the loss and noise of the oscillator, the output of the non-harmonic oscillator can be represented by



Io =
n=1,3,...

Io,n (no ) ( - no )

(3.1)

where  (.) is the discrete-time impulse also known as the unit impulse [98]. Note that  ( - o ) = 1 if  = o and 0 otherwise. The use of the discrete-time impulse enables us to conveniently capture the multi-tone characteristics of the spectrum of Io (t).

35

3.2

Representation of Injection-Locked Non-harmonic Oscillators

3.2.1

Single-Tone Injection When a single-tone signal Iinj (t), such as a sinusoid, is injected to a non-harmonic

oscillator with its frequency within the lock range of the non-harmonic oscillator for the given injection strength, the frequency of the oscillator will be shifted from its free-running frequency o to that of Iinj (t) and the oscillator is locked to Iinj . If Iinj (t) is a single-tone at inj , it can be represented by

Iinj (t) = Iinj ejinj t .

(3.2)

When the non-harmonic oscillator is locked to Iinj (t), the frequency of the harmonic oscillators representing the non-harmonic oscillator are changed to inj , 3inj , ..., accordingly. This observation reveals that the single-tone input of the non-harmonic oscillator Iinj (t) will affect the input of the representing harmonic oscillators. The injection-locked non-harmonic oscillator with a single-tone injection at inj can therefore be equivalent to a set of injectionlocked harmonic oscillators with injections at inj , 3inj , ..., as shown in Fig. 3.2. The preceding representation of an injection-locked non-harmonic oscillator with a set of injection-locked harmonic oscillators bears a strong resemblance to Volterra series analysis of nonlinear circuits. It is well understood that a nonlinear time-invariant circuit can be represented by a set of linear time-invariant circuits called Volterra circuits that have the same topology but distinct inputs determined by the nonlinearities of the circuits [99, 100]. Similarly, it was demonstrated in [101, 102, 103] that a periodically nonlinear time-varying circuit can be represented by a set of periodically linear time-varying circuits of the same topology but different inputs set by the nonlinearities of the circuits. In both cases, methods for analysis of linear systems such as Fourier transform can be applied to

36

I o,1 I inj,1 w inj I inj,3 3w inj H o,3 H o,1 w inj Io,3 3w inj Io

I o,n I inj,n nw inj H o,n nw inj

Figure 3.2: Representation of injection-locked non-harmonic oscillators with a single-tone injection.

analyze nonlinear circuits. As a result, non-harmonic oscillators fall into the category of periodically linear time-varying circuits.

3.2.2

Multi-Tone Injection If the injection signal Iinj (t) is a multi-tone signal, such as a square wave of frequency

inj , it will contain multiple frequency components at frequencies ninj , n = 1, 3,...(Assume Iinj (t) has the waveform shown in Fig. 3.1). In this case, Iinj (t) can be represented by



Iinj (t) =
n=1,3,...

Iinj,n ejninj t .

(3.3)

The impact of Iinj (t) on the oscillator can be analyzed by evaluating the effect of each frequency component of Iinj (t) individually in a similar way as that with a single-tone injection. This approach clearly is valid because although injection-locking is a nonlinear process, in the vicinity of the lock state the injection-locked non-harmonic oscillator can well be represented by a linear system.

37

A short discussion associated with new definition of quality factor of harmonic oscillators and some of related equations, which will be used for the lock range study of multiple multi-tone injection-locked oscillators, are given as below. The definition of the quality factor of harmonic oscillators, (2.16), is extended to nth-order harmonic oscillators representing the non-harmonic oscillator. no Qn = 2 An 
2

+
no

n 

2

.
no

(3.4)

Assume that the injection signal Iinj (t) causes the frequency of a non-harmonic oscillator to shift from its natural frequency o to o +  in the lock state with o o typically. If

the injection is a single-tone at inj , we will have inj = o +  in the lock state. If the injection signal is a multi-tone, such as a square wave, with its fundamental frequency inj , inj = o +  will hold in the lock state. Using the first-order Taylor series approximation, we obtain the loop gain of nth harmonic oscillator

Ho,n [n(o + o )] Ho,n (no ) + Let Ho,n = An ejn . Because

Ho,n 

(n ).
no

(3.5)

Ho,n An n = ejn + jAn     Ho,n A n n = e-jn - jAn    where the superscript * denotes the complex conjugate operator, we have
 Ho,n Ho,n =  

(3.6)

An 

2

+ A2 n

n 

2

.

(3.7)

38

Evaluating (3.7) at  = no and noting that each harmonic oscillator satisfies Barhausen criteria 1 + Ho,n (no ) = 0 n = 1, 3, 5, ... (3.8)

where Ho,n (no ) is the loop gain of nth harmonic oscillator, we arrive at
 Ho,n Ho,n  

=
no

An 

2

+
no

n 

2

(3.9)
no

Making use of (3.4), (3.9) can be written as
 Ho,n Ho,n  

=
no

2Qn no

2

.

(3.10)

(3.10) will be utilized in analysis of the lock range of non-harmonic oscillators.

3.3

Harmonic Oscillators with Multiple Injections
Consider the LC oscillator in Fig. 3.3 where Iinj 1 and Iinj 2 represent the two currents

injected at two different nodes of the oscillator. The injection-locked oscillator in the vicinity of the lock state is represented by the block diagram shown in Fig. 3.3 with gm1 and gm2 the transconductance of M1 and M2, respectively. Write KCL at the output nodes of the transconductors

Io2 = [(Io1 - Iinj 1 ) ZL1 ] gm2 Io1 = - [(Io2 - Iinj 2 ) ZL2 ] gm1

(3.11)

1 1 where ZL1 = sL1 || sC and ZL2 = sL2 || sC . Let Ho1 = gm2 ZL1 and Ho2 = gm1 ZL2 , (3.11) can 1 2

be written as

39

Figure 3.3: Injection-locked harmonic oscillators with multiple injections.

Io1 =

Ho1 Ho2 1 + Ho1 Ho2 Ho1 Ho2 1 + Ho1 Ho2

Iinj 1 +

Ho2 1 + Ho1 Ho2 Ho1 1 + Ho1 Ho2

Iinj 2 . (3.12)

Io2 =

Iinj 2 +

Iinj 1 .

It is evident from (3.12) that the injection-locked oscillator can be represented by the linear control system shown in Fig. 3.3. Eq.(3.11) can also be written as

40

Io2 = Ho1 Io1 - Ho1 Iinj 1 , Io1 = -Ho2 Io2 + Ho2 Iinj 2 .

(3.13)

When the injection signals are absent, we have Io1 = -Ho2 Io2 and Io2 = Ho1 Io1 . Since Io1 and Io2 are out of phase with the same magnitude, we conclude

Ho1 = ej Ho2 = -ej .

(3.14)

The results given in (3.14) are important as they will be used to quantify the contribution of the double injections to the lock range of the non-harmonic oscillators.

3.4

Non-Harmonic Oscillators with Multiple Injections
Let us extend the control system presentation of harmonic oscillators with multiple

injections presented earlier to non-harmonic oscillators with multiple injections. Consider a non-harmonic oscillator with injections Iinj 1 and Iinj 2 . In the vicinity of the lock state, the injection-locked oscillator is represented by the block diagram shown in Fig. 3.4. Iinj 1 (t) affects the oscillator through Iinj 1,1 at inj , Iinj 1,3 at 3inj ... and Iinj 2 (t) affects the oscillator through Iinj 2,1 at inj , Iinj 2,3 at 3inj , ... The output of the non-harmonic oscillator in the lock state is obtained from

Io =

Ho1 Iinj 1,1 Ho1 Iinj 2,1 +  ( - inj ) 1 + Ho1 Ho1,1 (1 + Ho1 ) Ho3 Iinj 1,3 Ho3 Iinj 2,3 +  ( - 3inj ) + 1 + Ho3 Ho1,3 (1 + Ho3 ) + ...

(3.15)

41

Figure 3.4: Representation of injection-locked non-harmonic oscillators with multiple singletone injections.

where Ho1 = Ho1,1 Ho2,1 and Ho3 = Ho1,3 Ho2,3 are the loop gain of the first-order and 3rdorder harmonic oscillators, respectively.

3.5

Lock Range of Non-Harmonic Oscillators with Multiple Single-Tone Injections
Assume that single-tone injection signals Iinj 1 (t) and Iinj 2 (t) of the same frequency

inj cause the frequency of a non-harmonic oscillator to shift from its natural frequency o o . Using the first-order Taylor series apHo,n (n ), proximation given in (3.5) and noting that Ho,n (no ) = -1, Ho,n (no )  no and 1 + Ho,n (o + n )0, the output of the oscillator in the lock state can be obtained from (3.15) to inj = o +  in the lock state with o

42

Io  + + ...

-Iinj 1,1 1 + Ho1  Ho1,1  o -Iinj 1,3 Ho3 3  3o +

-Iinj 2,1  ( - inj ) Ho1    o -Iinj 2,3 Ho3 3  3o  ( - 3inj ) (3.16)

1 Ho1,3

It follows from (3.16) that 
  Io   -Iinj 1,1
 Ho 1

 + 
o  -Iinj 1,3
 Ho 3 



1  Ho 1,1

 -Iinj 2,1
 Ho 1




o

   ( - inj )  (3.17)

  + + ... 1 +  (3 ) Ho1,3
 -Iinj 2,3
 Ho 3 

(3 )
3o

   ( - 3inj )

3o

Because  ( - m ) ( - n ) = 1 if m = n and 0 otherwise, we have
 Io1 Io 1

|Iinj 1,1 |2
 Ho1 Ho1  

+ ( )2

1 |Ho1,1 |2

|Iinj 2,1 |2
 Ho1 Ho1  

( )2
o

o

+
 Ho 1 ,1

 Iinj 1,1 Iinj 2,1
 Ho1 Ho1  

1 + ( )2 Ho1,1 + 1 |Ho1,3 + (3 )2 |2

 Iinj 1,1 Iinj 2,1
 Ho1 Ho1  

 ( - inj ) (3.18)

( )2
o

o 2

+

|Iinj 1,3 |
 Ho3 Ho3  

|Iinj 2,3 |2
 Ho3 Ho3  

(3 )2
3o

(3 )2
3o

+
 Ho 1 ,3

 Iinj 1,3 Iinj 2,3
 Ho3 Ho3  

1 Ho1,3

 Iinj 1,3 Iinj 2,3
 Ho3 Ho3  

 ( - 3inj )

(3 )2
3o

3o

+ ...

43

Utilizing (3.10), we can write (3.18) as
 = Io Io

o 2Q1 o 2Q3

2

  Iinj 1 |Iinj 2,1 |2 Iinj 1,1 Iinj 1,1 Iinj 2,1 2 ,1 2 | I | + +  ( - inj ) + inj 1,1  2 2 ( ) |Ho1,1 | Ho1,1 Ho1,1   Iinj 1 |Iinj 2,3 |2 Iinj 1,3 Iinj (3.19) 1,3 Iinj 2,3 2,3 2 | I | + +  ( - 3inj ) + inj 1,3  2 2 ( ) |Ho1,3 | Ho1,3 Ho1,3

2

+ + ...

Matching the terms in (3.19) that have the same frequency yields o 2Q1 o 2Q3
2   Iinj 1 |Iinj 2,1 |2 Iinj 1,1 Iinj 2 ,1 1,1 Iinj 2,1 2 | I | + + + inj 1 , 1  2 2 ( ) |Ho1,1 | Ho1,1 Ho1,1   Iinj |Iinj 2,3 |2 Iinj 1,3 Iinj 1 2 ,3 1,3 Iinj 2,3 2 | I | + + + inj 1 , 3  2 2 ( ) |Ho1,3 | Ho1,3 Ho1,3

2 Io, 1

= = ...

2

2 Io, 3

(3.20)

Let Iinj 1 (t) and Iinj 2 (t) have the same amplitude Iinj but different phases Iinj 1 (t) = Iinj ej (inj t+1 ) , Iinj 2 (t) = Iinj ej (inj t+2 ) . (3.21) (3.22)

Also, let the magnitude of the injection signals of first-order, 3rd-order, and nth-order harmonic oscillators due to Iinj 1 (t) be denoted by Iinj,1 , Iinj,3 , ..., Iinj,n , respectively. Similar notations apply to Iinj 2 (t) as well. Further, let  = 1 - 2 be the phase difference between Iinj 1 (t) and Iinj 2 (t). Since (3.14) holds for harmonic oscillators with double injections, it will also hold for nth-order harmonic oscillator

Ho1,n = ej Ho2,n = -ej

(3.23)

44

n = 1, 3, 5, .... (3.20) becomes
2 Io, 1

=

o 2Q1 o 2Q3

2

2

2 Io, 3 =

2 Iinj, 1 2 + ej (+) + e-j (+) ( )2 2 Iinj, 3 2 + ej (+) + e-j (+) 2 ( )

(3.24)

... Since Io,1 , Io,3 ,... are the magnitude of the fundamental and harmonics of Io (t), respectively. As

2 2 2 2 Io = Io, 1 + Io,3 + Io,5 + ...

(3.25)

is the output power of the oscillator. The summation of the expressions in (3.24) yields

( )2 =

o 2Q1

2

2 Iinj, 1 + 2 Io

o 2Q3

2

2 Iinj, 3 + ... 2 Io

2 + ej (+) + e-j (+) . Define |n | = o 2Qn Iinj,n . Io

(3.26)

(3.27)

The denominator of (3.27) is the total output current of the oscillator. (3.27) thus quantifies the contribution of nth-order harmonic oscillator Iinj,n to the overall lock range of the nonharmonic oscillator. (3.26) can be written as



| | = d
n=1,3,...

(n )2

(3.28)

45

where d = Since


2 + ej (+) + e-j (+) .

(3.29)

|s | =
n=1,3,...

(n )2

(3.30)

is the lock range of the non-harmonic oscillator with a single injection, the lock range of the oscillator with double injections given by (3.28) can be written as |d | = d |s |. (3.31)

The preceding developments are summarised as: 1. (3.25) quantifies the output power of the non-harmonic oscillator (assume 1  load). This can be best explained using Fourier series representation of periodic functions.


Consider a periodic function i(t) and represent it with the Fourier series i(t) =
n=1,3,...

In cos(nt)

where  = 2/T and T is the period of i(t). The average power of i(t), denoted Pavg , is obtained from [104]

Pavg =

1 T

T



i2 (t)dt
0

=
n=1,3,...

I n 2

2

(3.32)

Clearly the average power of i(t) is the sum of that of each harmonic of i(t). Since i(t) contains an infinite number of frequency components, its power is distributed across the entire frequency spectrum. The actual profile of the distribution of the power of i(t) is determined by the characteristics of i(t). For example, if i(t) is a sinusoid of

46

frequency o , its power will only be concentrated at o . If i(t) is a square wave, its power will mainly be concentrated at the fundamental and low-order harmonics. 2. n is the lock range of nth-harmonic oscillator with a single injection. (3.30) thus quantifies the relation between the lock range of the harmonic oscillators and that of the non-harmonic oscillators. For example, if the harmonic oscillator is injectionlocked to an external signal, only fundamental frequency will be taken into account. And therefore (3.30) is simplified to (3.33) |s | = same as (2.5). 3. d quantifies the effect of the phase relation between the two injection signals on the lock range of the non-harmonic oscillator. Table 3.1 tabulates d for several special cases. It is evident that the lock range of non-harmonic oscillators with multiple single-tone injections will be large than that with a single-tone injection, if the phases of these injection signals are properly chosen. This finding can also be applied to injection-locked harmonic oscillators. o 2Q Iinj Io (3.33)

Table 3.1: Lock Range Coefficient d

Phase difference ()  = 0  = /4  = /2  = 3/4  = 

Lock range coeff. (d ) d = 0 d = d =  2 1 - cos  4 2

d = 2 1 + cos  4 d = 2

47

3.6

Simulations
Relaxation oscillators are widely encountered in passive wireless microsystems owing

to their low sensitivity to supply voltage fluctuation as the charging and discharging currents are well defined by the current references, and their low sensitivity to temperature variation as its performance is largely determined by passive components and digital components. The harsh nonlinear elements of relaxation oscillators are comparators and the switching instants of the comparator are known a prior in the steady state, the comparators, therefore, can be modelled as periodically-operated switches that connect the output of the comparators to either VDD or ground. If no other nonlinearities are considered, relaxation oscillators can be modelled as periodically time-varying linear circuits. If nonlinearities other than comparators are also considered, relaxation oscillators are periodically time-varying nonlinear circuits. An injection-locked dual-comparator relaxation oscillator shown in Fig. 3.5, operating in the sub-threshold mode with 13 MHz frequency for power saving, to verify all the findings presented earlier and later. The oscillator is designed in IBM 130 nm 1.2V CMOS technology and analyzed using Cadence Spectre.

VDD

VDD Vb M5 I_b

VDD

M12

M13

M3 Iinj Ct1

M4

M8

M9

Ct2 M2 M6 M7 Vref

Vref

M10

M11

M1

Q

Figure 3.5: Schematic of relaxation oscillator with injection-locking. Circuit parameters: W1,2,6,7,10,11 = 0.5µm,W3,4 = 1.2µm, W8,9,12,13 = 1.25µm, W5 = 2µm, Supply voltage VDD = 0.9V, Vref = 0.31 V, Ib =253 nA, Vb = 0.62 V

S

48

R

Q

Fig. 3.6 shows free-running frequency of the relaxation oscillator without disturbance of the injecting signal. The spectrum of the oscillator is used to determine whether the oscillator is locked or not. The locking of an oscillator could be fast beat (inj is far away from o and outside the lock range), quasi lock (inj is very close to o but outside the lock range), and lock (inj is in the lock range) [53]. The spectrum of the oscillator in fast beat consists of a train of tones separated with a large frequency spacing while that of the oscillator in quasi lock is made of a train of tones separated with a small frequency spacing. When the oscillator is locked to the injection signal, only tones at the frequencies of the injection signal will exist [105, 106, 107, 108]. One therefore can determine whether a lock state is established or not by examining the spectrum of the oscillator. Figs.3.7, 3.8, and 3.9 show the spectrum of the relaxation oscillator (taken at the output of the comparators) in fast beat, quasi-lock, and lock states with a square-wave injection of injection ratio 0.1. Injection ratio is defined as the ratio of the injection current Iinj to the tail current Ib . Double injection is obtained by injecting a current source from the drain of M1 to the drain of M2. In this case, the two injection currents have the same frequency and amplitude but a 180 degree phase difference. Fig. 3.10 presents the dependence of the lock range on the strength of the injection signal with a sinusoidal injection and double sinusoidal injections whose phase difference is 180 phase. It is seen that increasing injection signal strength yields a larger lock range. Also observed is that for the same injection strength, the lock range of the oscillator with double sinusoidal injections is twice that with a single sinusoidal injection. This agrees well with the theoretical findings presented in Table 3.1.

3.7

Lock Range of Non-Harmonic Oscillators with Multiple Multi-Tone Injections
If injection signals are multi-tones, the output of the oscillator can be obtained by

considering the effect of each of the harmonic components of the injection signals. Consider a non-harmonic oscillator with two multi-tone injection signals Iinj 1 (t) and Iinj 2 (t), such as 49

0 -10 -20 Free Running Frequency

Free Running

Magnitude (dB)

-30 -40 -50 -60 -70 -80 10 11 12 13 14 15 16

Frquency (MHz)

-10 -20 3rd Harmonic -30

Free Running

Magnitude (dB)

-40 -50 -60 -70 -80 36 37 38 39 40 41 42

Frquency (MHz)

Free Running -20 5th Harmonic

-30

Magnitude (dB)

-40

-50

-60

-70

-80

62

63

64

65

66

67

68

69

Frquency (MHz)

Figure 3.6: Simulated spectrum of relaxation oscillator without injection. Top - Fundamental. Middle : 3rd harmonic. Bottom : 5th harmonic.

50

INJ Freq 11.5MHz 0 INJ FREQ 11.5MHz

-10

13MHZ 14.6MHz

Magnitude (dB)

-20

-30

-40

-50

-60

10.5

11

11.5

12

12.5

13

13.5

14

14.5

15

15.5

Frquency (MHz)

-10 37.6MHz -20 39MHz 40.7MHz

INJ Freq 11.5MHz

42.2MHz -30 36MHz 43.8MHz 34.5MHz -50

Magnitude (dB)

-40

-60

-70

-80 34 35 36 37 38 39 40 41 42 43 44

Frquency (MHz)

-20 65MHz -30

INJ Freq 11.5MHz

-40

Magnitude (dB)

-50 57.5MHz -60

-70

-80

-90 58 60 62 64 66 68 70 72

Frquency (MHz)

Figure 3.7: Simulated spectrum of relaxation oscillator in fast beat. Top - Fundamental. Middle : 3rd harmonic. Bottom : 5th harmonic.

51

0 INJ FREQ 12.1MHz -10 -20 13MHz

INJ Freq:12.1MHz

Magnitude (dB)

-30 -40 -50 -60 -70 11 12 13 14 15 16 17 18

Frequency(MHz)

INJ Freq 12.1MHz -20 39MHz

-30 36.3MHz

Magnitude(dB)

-40

-50

-60

-70

-80 36

37

38

39

40

41

42

43

44

Frequency(MHz)

INJ Freq 12.1MHz -20 -30 -40 60.5MHz -50 -60 -70 -80 -90 60 62 64 66 68 70 72 65MHz

Magnitude (dB)

Frquency (MHz)

Figure 3.8: Simulated spectrum of relaxation oscillator in quasi-lock. Top - Fundamental. Middle : 3rd harmonic. Bottom : 5th harmonic.

52

0 -10 INJ FREQ 12.99MHz -20

INJ Freq 12.99MHz

Magnitude (dB)

-30 -40 -50 -60 -70 -80 -90 11.5 12 12.5 13 13.5 14 14.5

Frquency (MHz)

-10 -20 38.99MHz -30

INJ Freq 12.99MHz

Magnitude (dB)

-40 -50 -60 -70 -80 -90

37.5

38

38.5

39

39.5

40

40.5

Frquency (MHz)

-20 -30 -40 64.99MHz

INJ Freq 12.99MHz

Magnitude (dB)

-50 -60 -70 -80 -90 63.5 64 64.5 65 65.5 66 66.5

Frquency (MHz)

Figure 3.9: Simulated spectrum of relaxation oscillator in lock state. Top - Fundamental. Middle : 3rd harmonic. Bottom : 5th harmonic.

53

2.5 Single Injection Differential Injection 2

Lock Range (MHz)

1.5

1

0.5

0 0.1

0.15

0.2

0.25 0.3 Injection Ratio (Iinj/Iosc)

0.35

0.4

Figure 3.10: Simulated dependence of the lock range of relaxation oscillator with a sinusoidal injection and double sinusoidal injections whose phase difference is 180 degree on injection strength.

square waves. Iinj 1 (t) contains singe-tone frequency components Iinj 1,1 , Iinj 1,3 , ... Iinj,n at inj , 3inj ,..., ninj , respectively. The same for Iinj 2 (t) as well. The effect of Iinj 1,1 can be analyzed in a similar way as that for injection-locked non-harmonic oscillators with a singletone injection presented earlier. Specifically, assume that the injection signals of first-order, 3rd-order, ..., nth-order harmonic oscillators due to Iinj 1,1 are Iinj 1,11 , Iinj 1,31 , ..., Iinj 1,n1 , respectively. Similar notations are used for Iinj 2 , as shown graphically in Fig. 3.11. The input of first-order harmonic oscillator due to Iinj 1 (t) is obtained by summing up Iinj 1,11 , Iinj 1,13 ,..., and Iinj 1,1n . It is evident that

Io  +

-(Iinj 1,11 + Iinj 1,13 + ...) 1 -(Iinj 2,11 + Iinj 2,13 + ...)  ( - inj ) + Ho1 Ho1 H     o 1 , 1  o  o -(Iinj 1,31 + Iinj 1,33 + ...) 1 -(Iinj 2,31 + Iinj 2,33 + ...) +  ( - 3inj ) Ho3 Ho3 H 3  3  o 1 , 3  3o  3o (3.34)

+ ...

54

Figure 3.11: Representation of injection-locked non-harmonic oscillators with multiple multitone injections.

It follows from (3.34) that
 Io    -(Iinj 1,11 + Iinj 1,13 + ...)
 Ho 1 

+


o  Iinj 1,33 3o

  1 -(Iinj 2,11 + Iinj 2,13 + ...)  ( - inj )   Ho Ho 1 1,1   o  + Iinj 2,33 + ...)  -(Iinj 2,31

+

 -(Iinj 1,31

+

+ ...)

 Ho 3 

3

1 +  Ho1,3

 Ho 3 

 ( - 3inj )

(3.35)

3
3o

+ ...

55

As a result,
 Io Io    (Iinj 1,11 + Iinj 1,13 + ...)(Iinj 1,11 + Iinj 1,13 + ...)
 Ho1 Ho1  

( )2
 + Iinj 2,13 + ...)

+

(Iinj 1,11 + Iinj 1,13 + Ho1,1

o  ...)(Iinj 2,11 o

 Ho1 Ho1  

( )2

+

  (Iinj 1,11 + Iinj 1,13 + ...)(Iinj 2,11 + Iinj 2,13 + ...)

Ho1,1 +

 Ho1 Ho1  

( )2
o

  (Iinj 2,11 + Iinj 2,13 + ...)(Iinj 2,11 + Iinj 2,13 + ...)

|Ho1,1 |2 +

 Ho1 Ho1  

 ( - winj ) (3.36)

( )2
o  + Iinj 1,33 + ...)

(Iinj 1,31 + Iinj 1,33 +


 ...)(Iinj 1,31

 Ho3 Ho3

+

(Iinj 1,31 + Iinj 1,33 + Ho3,1

o  ...)(Iinj 2,31 o



(3 )2
 + Iinj 2,33 + ...)

 Ho3 Ho3  

(3 )2

+

  (Iinj 1,31 + Iinj 1,33 + ...)(Iinj 2,31 + Iinj 2,33 + ...)

Ho3,1 +

 Ho3 Ho3  

(3 )2
o

  (Iinj 2,31 + Iinj 2,33 + ...)(Iinj 2,31 + Iinj 2,33 + ...)

|Ho3,1 |2 + ...

 Ho3 Ho3  

 ( - 3winj )

(3 )2
o

Matching the components that have the same frequency in (3.36) yields

56

2 Io 1 =

o 2Q1

2

1   (Iinj 1,11 + Iinj 1,13 + ...)(Iinj 1,11 + Iinj 1,13 + ...) 2 ( )

  (Iinj 1,11 + Iinj 1,13 + ...)(Iinj 2,11 + Iinj 2,13 + ...) +  Ho 1,1   (Iinj 1,11 + Iinj 1,13 + ...)(Iinj 2,11 + Iinj 2,13 + ...) + Ho1,1   (Iinj 2,11 + Iinj 2,13 + ...)(Iinj 2,11 + Iinj 2,13 + ...) + |Ho1,1 |2

(3.37)

=

o 2Q1

2

1 ^2 I , ( )2 o1

2 ^o where I 1 represents the sum of the terms in the bracket in (3.37). Similarly, we have

2 Ion =

o 2Qn

2

1 ^2 I , ( )2 on

n = 1, 3, 5, ...

(3.38)

The summation of the expressions in (3.38) with utilization of (3.25) yields

( )2 = Define

o 2Q1

2

2 ^o I 1 + 2 Io

o 2Q3

2

2 ^o I 3 + ... 2 Io

(3.39)

(n )2 = we arrive at


o 2Q1

2

2 ^on I , 2 Io

(3.40)

| | =
n=1,3,5,...

(n )2

(3.41)

57

Since the square-wave injections are represented by a set of harmonic single-tone injections, (3.20) will also hold. The lock range of non-harmonic oscillators with double square-wave injections is maximized if the phase difference between the injection signals is
2 180 degree. A direct comparison of (3.20) with (3.37) reveals that Ion , n = 1, 3, 5, ... of

the non-harmonic oscillator with multiple multi-tone injections is larger than that of the non-harmonic oscillator with multiple single-tone injections if the phases of these injections are properly chosen. The large lock range is due to the effect of the harmonic tones of the injection signals.

3.8

Simulations
Using same relaxation oscillator in Fig. 3.5 to validate the theoretical analysis.

Three different injection signals, namely (i) sinusoidal currents (single-tone injection) Iinj = A sin(inj t), (ii) dual-sinusoidal currents (dual-tone injections) Iinj (t) = I1 sin(inj t)+I3 sin(3inj t) with I3 = I1 /3, and (iii) square-wave currents (multi-tone injections) are used to lock the oscillators. Both single injection and double injections are considered. Fig. 3.12 investigates the dependence of the lock range of the relaxation oscillator on the strength of the injection signal with a single square-wave injection and with double square-wave injections whose phase difference is 180 degree. It is seen that the lock range of the oscillator with double square-wave injections is twice that with a single square-wave injection. This observation also agrees well with the theoretical findings presented earlier. To investigate whether the dependence of the lock of the relaxation oscillator on injection strength is linear or nonlinear over a large range of injection ratio, the lock range of the relaxation oscillator with a differential square-wave injection is obtained over the injection ratio 0.10.5 and the results are plotted in Fig. 3.13. It is observed that the dependence of the lock range on the injection ratio is approximately linear over the investigated injection ratio range. It is well known that LC-oscillators typically exhibit a nonlinear lock range characteristics when injection is strong [109, 64]. The nonlinear characteristics of the lock range of these oscillators is largely determined by the frequency selectivity or equivalently the

58

3.5 Sinlge Injection Differential Injection 3

2.5 Lock Range (MHz)

2

1.5

1

0.5

0 0.1

0.15

0.2

0.25 0.3 Injection Ratio (Iinj/Iosc)

0.35

0.4

Figure 3.12: Simulated dependence of the lock range of relaxation oscillator with a single square-wave injection and with double square-wave injections whose phase difference is 180 degree on injection strength.

quality factor of the LC tank [110]. It is also known that non-harmonic oscillators typically exhibit a lower quality factor, reflected by their inferior phase noise performance as compared with harmonic oscillators. The low quality factor might contribute to the large lock range subsequently better lock range linearity. This is observed in injection-locked active-inductor LC oscillators, which have a larger lock range as compared with their spiral LC counterparts. The sub-threshold operation of the relaxation oscillator investigated might also contribute to the large lock range and better lock range linearity as the current of MOSFETs is an exponential rather than a second-order function of the over-drive voltage. Fig. 3.14 compares the lock range of the oscillator with a single sinusoidal injection, a single square-wave injection, and a single dual-tone (two-sinusoids) injection. It is seen that the oscillator with a square-wave injection yields the largest lock range whereas that with a single sinusoidal injection has the smallest lock range. These results echo the theoretical findings given earlier well. Fig. 3.15 plots the dependence of the lock range of the oscillator with double squarewave injections on the phase difference of the injection signals. It is evident that the lock range increases monotonically with the phase difference and reaches its maximum when the phase difference is 180 degree. This agrees well with the theoretical results derived earlier.

59

4 Differential Square Wave Injection 3.5 3

Lock Range (MHz)

2.5 2 1.5 1 0.5 0 0.05

0.1

0.15

0.2

0.25

0.3

0.35

0.4

0.45

0.5

Injection Ratio (Iinj/Iosc)

Figure 3.13: Simulated dependence of the lock range of relaxation oscillator with differential square-wave injection on injection strength.

1.8 1.6 1.4 Lock Range (MHz) 1.2 1 0.8 0.6 0.4 0.2 0.1 Two-tone Injection Square-wave Injection Sine-wave Injection

0.15

0.2

0.25 0.3 Injection Ratio (Iinj/Iosc)

0.35

0.4

Figure 3.14: Simulated dependence of the lock range of relaxation oscillator with a single sinusoidal injection, a single square-wave injection, and a single dual-tone (two-sinusoids) injection on injection strength.

Fig. 3.16 compares the lock range of the relaxation oscillator with a two-tone sinusoidal injection and double two-tone injections whose phase difference is 180 degree. It is seen that for the same injection strength, the lock range of the oscillator with double two-

60

0.8 0.7 0.6 Lock Range (MHz) 0.5 0.4 0.3 0.2 0.1 0

Simulated Lock Range

0

50

100 150 Phase Difference (Degree)

200

250

Figure 3.15: Simulated dependence of the lock range of relaxation oscillator with double square-wave injections on the phase difference of the injection signals. The injection ratio is 0.1.

tone injections is twice that with a single two-tone injection. This observation agrees with the theoretical findings presented earlier.

3 Single Injection Differential Injection 2.5

Lock Range (MHz)

2

1.5

1

0.5

0 0.1

0.15

0.2

0.25 0.3 Injection Ratio (Iinj/Iosc)

0.35

0.4

Figure 3.16: Simulated dependence of the lock range of relaxation oscillator with a two-tone sinusoidal injection and double two-tone injections on injection strength.

61

Fig. 3.17 compares the lock range of the relaxation oscillator with double single-tone injections, double two-tone injections, and double square-wave injections, all with a 180 degree phase difference. It is seen that the lock range of the oscillator with double squarewave injections is the largest while that with double single-tone injections is the lowest. These observations are in a good agreement with the theoretical results derived earlier.

3.5 Two-tone Injection Square-wave Injection Sine-wave Injection

3

Lock Range (MHz)

2.5

2

1.5

1

0.5 0.1

0.15

0.2

0.25 0.3 Injection Ratio (Iinj/Iosc)

0.35

0.4

Figure 3.17: Simulated dependence of the lock range of relaxation oscillator with double single-tone injections, double two-tone injections, and double square-wave injections on injection strength.

3.9

Summary
By representing non-harmonic oscillators with a set of harmonic oscillators, and using

similar approach presented in Chapter 2, the intrinsic relation between the lock range of harmonic oscillators and that of non-harmonic oscillators is obtained. Also, the resemblance of Volterra series analysis for nonlinear circuits is applied to show non-harmonic oscillators with a multi-tone injection exhibit a larger lock range as compared with that with a single-tone injection. Further demonstration shows that non-harmonic oscillators with multiple singletone injections exhibit a larger lock range as compared with that with a single single-tone

62

injection. The condition upon which non-harmonic oscillators with multiple single-tone injections exhibits a larger lock range as compared with those with a single-tone injection was obtained. The condition upon which non-harmonic oscillators with multiple multi-tone injections exhibits a larger lock range as compared with those with a single multi-tone injection has also been derived. The above study is critical for some applications. In particular, when the non-harmonic oscillators are employed in passive wireless communications and wireless sensor transceivers, where the power supply is not stabilized, the calibration for local oscillators requires the lock range which has to be wide enough to overcome the frequency drifting. As the characteristics of the oscillating signals are exhibiting more harmonic components, the multiple multi-tones injections are essentially useful to enlarge the lock range.

63

Chapter 4
A Quadrature Charge-Domain Sampling Mixer with Embedded FIR, IIR, and N-Path Filters
In zero-IF or low-IF RF receivers, a quadrature mixer is commonly employed. The SAW band-pass filter with fixed centre frequency or with a narrow tuning range has to be eliminated for SDR applications. A switched-capacitor based network can be utilized to substitute the SAW filter while proving tunable centre frequency by sampling frequency. A RF receiver employed the windowed integration sampling provides improved attenuation for aliasing and stop-band frequency. In this chapter, a programmable quadrature chargedomain sampling mixer with embedded FIR, IIR, and 4-path band-pass filters is designed. The remainder of the chapter is organized as the followings: Section 4.1 investigates the principles of periodic impulse sampling, periodic windowed sampling, and periodic N-path windowed sampling, and their characteristics are compared. Section 4.2 provides a detailed mathematical treatment of charge-domain windowed samplers. In Section 4.3, a quadrature charge-domain sampler with embedded FIR, IIR, and 4-path band-pass filters is proposed and its performance is investigated in detail. Section 4.4 presents the measurement results. A summary is provided in Section 4.5.

64

4.1
4.1.1

N-path Filters
Periodic Impulse Sampling Consider the time-varying network shown in Fig. 4.1 where the output of the linear

time-invariant (LTI) network with impulse response hBB (t) and bandwidth  is sampled


by periodic impulse function T (t) =
n=-

 (t - nTs ) where  (t) = 1 if t = 0 and 0 otherwise,


2 and Ts is the period. Because F [T (t)] = Ts operator and s = 2/Ts .

 ( - ns ) where F [] is Fourier transform
n=-

dT h BB dT
0 Ts 2Ts 3Ts
Figure 4.1: Periodic impulse sampling of band-limited signals.

vo

1

The output is given by Vo ( ) = HBB ( )F [T (t)] where  is convolution operator and HBB ( ) is the Fourier transform of hBB (t). It follows that Vo ( ) = 2 Ts


HBB ( - ns ).
n=-

(4.1)

If s 2 , the frequency characteristic of the LTI network will repeat every s with no spectrum overlap, as shown in Fig. 4.2(a). Periodic impulse sampling converts a low-pass filer to band-pass filters. The spectral profile of the band-pass filters (bandwidth, stop-band attenuation,...) is identical to that of the low-pass while the center frequency can be tuned by varying s . The band-pass filter with its center frequency at s will have quality factor Q = s /(2 ). For example, if f = 1 MHz and fs =1 GHz, we have Q = 500.

65

Wanted freq. Translation

U n w a n t ed alias in g

HBB(w) Dw 0 0

Vo (w) Dw ws 2ws

Vo (w)

w-ws

w

w+ws w+2ws

(a)

(b)

Figure 4.2: (a) Periodic impulse sampling of band-limited signals. Baseband signal at  is replicated to sidebands at  + ns . (b) Periodic impulse sampling of broadband signals. The sideband components of input at  + ns are aliased back to the baseband at  .

Consider that the input at  and with bandwidth  s /2 and at the same time other unwanted tones exist at  + ns . Assume the desired output is at  - s obtained via mixing. Tones at  + ns will be aliased back to  - s , as shown in Fig. 4.2(b). Mechanisms that suppress the effect of the aliasing tones are needed.

4.1.2

Periodic Windowed Sampling A time-varying network is shown in Fig. 4.3 where the output of the LTI network

having a low-pass characteristic with bandwidth B is sampled by periodic windowed function sT (t) = 1 if nTs + k-1 t < nTs + k and 0 otherwise. k and k-1 are explicitly defined in Fig. 4.3. Since sT (t) is periodic with period Ts , it can be represented by Fourier series



sT (t) =
n=-

Sn ejns t

(4.2)

where

Sn =

1 Ts sT (t)e-jns t dt Ts 0  -jns k-1 -jns  /Ts = e e sinc Ts 66

n Ts

.

(4.3)

sT

sk sk-1

sk sk-1 (n+1)Ts (n+2)Ts

t
nTs

h BB

vo sT

Figure 4.3: Periodic windowed sampling of band-limited signals.

Fourier transform of sT (t) can be obtained directly through (4.2) and (4.3) 2 ST ( ) = Ts


e-jns k-1 e-jns  /Ts sinc
n=-

n Ts (4.4)

 ( - ns ). Fourier transform of vo (t) = hBB (t)sT (t) is obtained from Vo ( ) = HBB ( )  ST ( )  = Ts


e-jns k-1 e-jns  /2 sinc
n=-

n Ts (4.5)

HBB ( - ns ).

Consider s 2 without interferences. Periodic windowed sampling converts it to a set of band-pass filters. Unlike periodic impulse sampling that has a uniform scaling factor 2/Ts , periodic windowed sampling has a low-pass scaling factor sinc (n /Ts ), as shown in Fig. 4.4(a). For the case of s 2 with interferences at  + ns (n = 1), if the desired output is at  + s , the baseband tone at  and the interferences at  + ns will be converted to the desired output at  + s . Since |e-jns k-1 | = e-jns  /2 = 1, the aliasing effect at  + ns will be magnitude-shaped by the scaling factor sinc (n /Ts ). Unlike periodic impulse sampling, periodic windowed sampling introduces nulls. For the interferences reside at the nulls, they will be completely suppressed (ideally). As usual, the desired channel occupies a frequency band  rather than a single frequency, although 67

HBB(w)

Vo (w)

0

0

ws 2ws 3ws (a)
Small ws Large ws

Vo (w) Dw Dw

w

w+ws

w+2ws (b)

w+3ws

Figure 4.4: (a) Periodic windowed sampling of narrow-band signals without interferences. (b) Periodic windowed sampling of band-limited signals with interferences. Interferences at  + ns are aliased back to the desired baseband.

nulls will be most effective in suppressing aliasing tones at  + ns , those in the vicinity of  + ns will be suppressed but with less attenuation, as illustrated graphically in Fig. 4.4(b). Also, increasing s will improve the attenuation of tones in the vicinity of the nulls. This, however, is at the cost of increased power consumption.

4.1.3

Periodic N-Path Windowed Sampling N-path filters introduced in 1960s [111] offer the intrinsic advantages of a programmable

center frequency, programmable bandwidth, low-cost, and an interleaved operation enabling low-speed circuits to process high-frequency inputs. An interleaved N-path filter is shown in Fig. 4.5 with a total of N identical networks sampled by window function sk (t) defined as sk (t) = 1 if nTs + k-1 t < nTs + k and 0 otherwise. Since sk (t) is periodic with period Ts ,


we have sk (t) =
n=-

Sk,n ejns t where Sk,n =

1 sinc N

n N

ej N e-j

n

2nk N

. Note that  = Ts /N

68

was utilized. Fourier transform of sk (t) is given by 2 Sk ( ) = N


sinc
n=-

n j n -j 2nk e N e N  ( - ns ). N

(4.6)

vi

s1 vi,1 s2 vi,2

hBB(t) hBB(t)

x1 x2

s1 s2

vo

t s1 s2 sk t t

sN vi,N

hBB(t)

xN

sN sN nTs

sk-1

sk

t (n+1)Ts

Figure 4.5: N-path filter. Sampling mixers are implemented using switches drived by a sampling clock with N non-overlapping phases. Non-overlapping uniform sampling pulse width:  = Ts /N . k = k-1 +  and k-1 = nTs + (k - 1) .

Fourier transform of vi,k = vi (t)sk (t) is obtained from convolution 1 N


Vi,k ( ) =

sinc
n=-

n j n -j 2nk e N e N Vi ( - ns ) N

(4.7)

where Vi ( ) is the Fourier transform of vi (t). The output of k th LTI block before the second mixer xk (t) is given by xk (t) = vi,k (t)  hBB (t) and its Fourier transform Xk ( ) is given by 1 Xk ( ) = N


sinc
n=-

n j n -j 2nk e Ne N N (4.8)

Vi ( - ns )HBB ( ).

69

The output in k th phase is obtained from vo,k (t) = xk (t)sk (t) 1 = N


sinc
m=-

m j m -j 2mk e N e N xk (t)ejms t . N (4.9)

The index m associated with the second set of switches is used in (4.9). It is straightforward to show that
N

Vo ( ) = 1 N = e
-j N k=1 

F [vo,k (t)] sinc m j m -j 2mk e N e N Xk ( - ms ) N sinc
k=1 m,n=-

k=1 m=-

1 N

2 N



m n j (m+n) sinc e N N N

2(m+n)k N

Vi [ - (m + n)s ]HBB ( - ns ), (m + n = KN, K = 0, 1, 2, ...). (4.10)

Since ej (m+n)/N = 1 and e-j 2(m+n)k/N = 1, we obtain the magnitude of Vo ( ) from (4.10) 1 Vo,m ( ) = N2


sinc
m,n=-

m n sinc N N

Vi [ - (m + n)s ]HBB ( - ns ), (m + n = KN, K = 0, 1, 2, ...). (4.11) The transfer function of the N-path filter at  is obtained by letting m + n = 0 Vo ( ) 1 HBP ( ) = = 2 Vi ( ) N


sinc2
n=-

n HBB ( - ns ). N

(4.12)

As compared with periodic windowed sampling, 1. Periodic N-path windowed sampling provides a sinc2 low-pass characteristic with -40 dB/dec attenuation to suppress unwanted tones while periodically windowed sampling provides a sinc low-pass characteristic with -20 dB/dec attenuation. 70

2. Both periodically windowed sampling and periodic N-path windowed sampling provide nulls to suppress aliasing interferences at and in the vicinity of nulls. 3. For periodic N-path windowed sampling from (4.12), the N-path sampling can be applied to select frequency components near by s in a manner analogous to employing a band-pass filter at the high frequency. Meanwhile the quality factor of the band-pass filter ideally is only determined by the base-band spectral profile, e.g. HBB is a low-pass filter. The center of the band-pass filter is precisely controlled by the s . 4. Apart from the band-pass filtering at the desired frequency, s , there are also response peaks around all the other harmonics of the switching frequency. In other words, the unwanted signals will be accompanied with the wanted tones through the switching systems. The severe drawback, which can be observed from (4.11), is the folding of interferences at some harmonics of s on the top of the desired signal at s . For example, if N is 4 and the desired signal is located at s + , the closest harmonic, which will introduce aliasing signals, is located at 3s . And the next will be 5s . 5. The location of the nulls in periodic N-path windowed sampling is heavily depending on the number of the paths. In other words, increasing the number of paths moves nulls to high frequencies, lowering the overall fold-over effect of aliasing interferences at and near the nulls due to the increasing attenuation of these unwanted tones at high frequencies. It is of interest to notice that the harmonic rejection at all the other harmonics is also decreased by increasing the number of paths. Take a 4-path and 8-path filter for example, the 3rd -harmonic of the 4-path filter is located at 0.754s with 20 dB insertion loss. The 3rd -harmonic of the 8-path filter, however, is located at 0.3758s with only 4 dB attenuation. The following example shown in Fig. 4.6(a) [90] illustrates a simplified single-ended N-path filter, where N is 4 and  is Ts /4. The targeting signal is at in the vicinity of s . The input voltage vi is converted to current ii first. ii is then switched by sk (t) and integrated onto CB . Fig. 4.6(b) shows the non-overlapping multi-phase clocking scheme for the switching system. In other words, for every periodic switching, only one capacitor is being charged or 71

discharged. The the output impedance of the transconductor and single-ended capacitors form a low-pass filter with time constant B = Rout CB where Rout is the output impedance of the transconductor, if the ON-resistance of the switches is sufficiently small. From 4.12, Rout HBB is denoted by a first-order integrator, HBB = . 1 + jRout CB

s1 s2

i i,1 v i,1 v i,2 v i,3 v i,4 s1 s2

t t t s3 t s4 nTs (n+1)Ts (n+2)Ts (b)

vi Gm

ii

Rout

CB i i,2 vo s3 CB i i,3 s4 CB i i,4 CB (a)

Figure 4.6: Single-ended 4-path filter.

A careful inspection of Fig. 4.6 reveals that it realizes the same function as Fig. 4.5 does. The sampled current ii,k (t) = ii (t)sk (t) produces voltage vi,k (t) = ii,k (t)  zB (t) across the capacitor where zB (t) is the impulse response of the load. As the charge on each capacitor has nowhere to flow except for flowing back to the input port of the switch, which is same as xk in Fig. 4.5 passing through second mixer. vi,k (t) is then sampled by the switches to
4

produce vo (t) : vo (t) =
k=1

vi,k (t)sk (t). vo (t) can be obtained by the network shown in Fig.

4.7. The whole concept of substituting the conventional band-pass filter can be understood in the form of impedance looking into the input the switching system. If the baseband impedance around DC presents a very large value, the impedance at s will be very large due to the switching system. From Fig. 4.6, the baseband low-pass filter is then converted to a highfrequency band-pass filter. The out of band of the band-pass filter exhibits a low impedance path to those interferences residing at the frequency offsets from s while the desired signal

72

s1 v i,1 t s2 v i,2
vo ii

s1 t s2 t s3 t s4 nTs (n+1)Ts (n+2)Ts
vo ii

s3 v i,3 s4 v i,4

LO

f

LO

f

Figure 4.7: Single-ended 4-path filter.

will be picked up. The quality factor of this type filter is feasible to be designed over 1000 depending on the bandwidth and the center frequency. Fig. 4.8 plots the simulated PSS-PAC frequency response of the 4-path band-pass filter shown in Fig. 4.7 with Gm =1 mS, fs = 100 MHz with 25% duty cycle, and CB =40 pF. It is seen that the 4th and 8th harmonics vanish due to the frequency-shaping in (4.12). Also observed is the sinc envelope of the frequency response with notches at 4fs , 8fs ,... The 4-path band-pass filter can also be implemented differentially. In this case, the differential form removes all even number harmonics components and DC.

4.2
4.2.1

Charge-Domain Windowed Sampling
Sinc Low-Pass Filter This section examines the operation of the charge-domain sampler shown in Fig. 4.9.

The input voltage signal is converted to a current through a Gm cell with the transconductance gain Gm , followed by a switched-capacitor(SC) circuit. It is worth to mention that the realization of integrator is possible to use OPAMP-based integrator. Each period of the sampling clock consists of three phases : the reset phase (sr = 1) where sampling capacitor Cs is reset, the integration phase (si = 1) where the output current of the transconductor is integrated onto the sampling capacitor, Cs , over Ti period, and the readout phase (so = 1) at a rate fs = 1/Ts , as shown in Fig. 4.9. The reset operation ensures that there is no relation between the output of the sampler at the end of adjacent sampling periods. Let 73

0 -5

0

1 2

-10 -15 Magnitude (dB) -20 -25 -30 -35 -40 -45 -50 0
4 8 5 6 3

7 9

100

200

300

400 500 600 Frequency (MHz)

700

800

900

1000

Figure 4.8: Frequency response of single-ended 4-path filter in Fig. 4.6.

vi (t) = ejt . Because vi (t) is a single tone of unit amplitude, the corresponding output is the transfer function of the system. The output voltage at the end of the integration phase Ti is given by

vi

Gm

ii si
Cs

so sr

vo

si sr so (n-1)Ts

Ti
Integration Reset Readout

H(j w ) GmTi Cs
-20 dB/dec

nTs

0

p Ti

2p Ti

3p Ti

4p Ti

w

Figure 4.9: Charge-domain sampling. Solid line : Small Ti . Dashed line : Large Ti .

74

vo (nTs ) =

Gm nTs jt e dt Cs nTs -Ti Gm Ti jnTs -jTi /2 = e e sinc Cs

Ti 2

.

(4.13)

The ideal frequency response of the output signal as a function of input signal from (4.13) can be expressed as Hsinc (j ) = Gm Ti sinc Cs Ti 2 . (4.14)

|Hsinc (j )| is sketched in Fig. 4.9. It is of interest to notice that the charge-domain windowed sampling process can be represented by two independent signal processing operations, a continuous-time (CT) sinc filtering due to integration of the signal current within a widowed period and a sampling process at the rate, fs = 1/Ts . The preceding results are commented as:

1. Charge-domain windowed sampling provides a sinc low-pass characteristic with nulls at  = n/Ti and a -20 dB/dec attenuation. The signal bandwidth is determined by Ti , and is approximately 0.44/Ti , shown in Fig. 4.10.

0 -10 Magnitude (dB) -20 -30 -40 -50 -60
X: 0.4436 Y: -3.02

-4

-3

-2

-1 0 1 Frequency ()

2

3

4

Figure 4.10: Gain-normalized transfer function of sinc.

75

2. The gain of the filter in the passband 0f 0.44/Ti is not constant but rather drops with frequency in a sinc fashion. The low-pass obtained from charge-domain windowed sampling therefore does not have a flat passband. 3. The largest gain occurs at DC and is given by Gm Ti /Cs . Increasing Ti not only reduces the bandwidth of the charge-domain sampler, it also boosts the DC gain. Also the larger the sampling capacitor, the lower the gain. On the other hand, the larger the transconductance, the larger the gain. The latter, however, is accompanied with more power consumption. 4. Since nature of sinc function is low-pass and the attenuation in the main lobe is small, the desired output should be placed inside the main lobe, preferably close to DC. This requires that  null. 5. For a given input at frequency  , if the desired output is at DC, the sampling frequency s = 2/Ts is chosen such that  - s = 0. Since Ts = Tr + Ti + To where Tr and To are the reset time and readout time, respectively, Ti will therefore vary with Ts . This will in turn affect the gain of the sampler given by Hsinc (0) = Gm Ti /Cs unless Gm is also varied accordingly such that Gm Ti remains unchanged. Since most receivers require an Automatic Gain Control (AGC), this gain variation can be tuned out as part of the AGC function. As a result, no additional hardware is needed. Alternatively, the gain of the transconductor can also be varied.. 6. If the desired output is at DC, assume Ti =Ts , aliasing interferences at ni will be fully attenuated. If the desired signal is close to DC, aliasing interferences are located near the nulls and will also be attenuated by the nulls, however, by a less amount. 7. As demonstrated in [86, 112], the depth of the nulls is greatly affected by the imperfection of the sampler, specifically, the finite output impedance of the transconductor as the finite output impedance of the transconductor reduces the effective current integrated onto the sampling capacitor. As a result, the effectiveness of the nulls in suppressing aliasing interferers is reduced. 76 i or equivalently Ti T where i = /Ti is the frequency of the first

The importance of the concept of the charge-domain sampler in Fig. 4.9 is that the current integration provides an elementary low-pass sinc response and the input signal bandwidth is primarily set by integrating time, Ti . On the contrary, in voltage sampler, the input signal bandwidth is limited by the time constant,  = RC , where R is the ONresistance of the switches and C is the sampling capacitance. Given the same bandwidth for both two samplers, the performance of low-pass sinc filter ideally outperforms the simple low-pass RC filter as the unwanted signal at the notches can be suppressed significantly. The simple structure of charge-domain sampler in Fig. 4.9, however, does not take full advantage of anti-aliasing sinc filter since the Ti is directly related to Ts , i.e. Ts is not equal to Ti . In theory, Ti and Ts are two distinct parameters. Ts determines the spectral location and Nyquist bandwidth of the sampled signal while Ti sets the nulls. To minimize the fold-over signal on top of the desired signal, it is preferable to set Ti = Ts when the sampler is utilized in the baseband sampling. The need of reset and read out period in sampling operations, however, cannot be avoided. This issue is resolved by using time interleaved charge-domain sampling circuits, illustrated in Fig. 4.11.

si1 vi
Gm

so1 s r1 vo so2 s r2 si1 so1 sr1 si2 so2 sr2 (n-1)Ts

Ti
Integration Readout Reset

ii

Cs

si2
Cs

Ti
Integration Readout Reset

nTs

(n + 1)T s

Figure 4.11: Time interleaved charge-domain sampling.

In this case, one integrator is involved in integrating the input current while the other one is in the phase of read out and reset and vice versa. Therefore, the charges in every integration

77

period is transferred to the subsequent stage. As a result, the sampling period of the sampler is Ts = Ti , leading to place the notches of the sinc response on top of the multiples of 1/Ts , which ideally remove the aliasing effect near by DC. If longer time slots for read out and reset are required, more than two paths can be used to further relax the timing requirement.

4.2.2

FIR Filter -20 dB/dec attenuation provided by elementary charge-domain windowed sampling

is inadequate in suppressing unwanted channels. It was shown in [112] that sinc low-pass provided by the charge-domain windowed sampling can be greatly enhanced by partitioning the integrating phase into multiple sub-integration phases, as shown in Fig. 4.12. Further, for k th integration phase, a weighting factor hk is assigned. The current to be integrated on the sampling capacitor Cs during k th sub-phase is given by ii,k (t) = Gm vi hk . Let vi (t) = ejt . The output voltage of the sampling capacitor at the end of nth sampling period is given by

vi

Gm

ii hk

si
Cs

so sr

vo

Ti Si Sr So (n-1)Ts
Reset

NTf
Successive integration

Tf

Readout

nTs

Figure 4.12: Charge-domain sampler with built-in FIR filter.

78

vo (nTs ) =

Gm Cs

N -1

nTs -kTf

hk
k=0 nTs -kTf -Ti N -1

ejt dt hk ejnTs e-jkTf .
k=0

Gm 1 - e-jTi = jCs

(4.15) Defining z = ejTf and noting ejnTs = 1, we obtain magnitude transfer function Gm Ti |H (j )| = sinc Cs Ti 2
N -1

hk z -k = Hsinc HF IR
k=0 N -1

(4.16)

where Hsinc was defined in (4.14) and HF IR =
k=0

hk z -k . Eq.(4.16) shows that two distinct

filtering functions, namely, a CT sinc low-pass and a DT FIR filter of order N , are realized simultaneously. The continuous-time sinc low-pass is due to the continuous integration of the input current over [0, Ti ] while the discrete time FIR is due to multiple integrations in one Ts . A special case is when hk = 1, k = 0, 1, 2, ..., the unity tap weight of the FIR filter gives rise to a temporal moving average characteristic. Assume Tf /T 1. This is often

true since Ts is chosen close to T in order to generate a near DC output while Ts = N Tf with N typically large in order to increase the order of the FIR filter. It follows that z -1 = e-j 2Tf /T  1 - j 2 Tf . As a result, Eq.(4.16) becomes HF IR = 1 - z -N Tf = N e-jN Tf /T sinc N  - 1 1-z T . (4.17)
T

Eq.(4.17) shows that the temporal moving average filter implements a sinc low-pass with nulls at  = (n/N )f where f = 2/Tf and n = 1, 2, 3, ..., which is often used in the decimation as anti-aliasing filter. There are total N-1 zeros evenly distributed in the frequency range from DC to 1/Tf , resulting in multiple notches. The optimal output sampling rate is located at the multiple zeros. Therefore, the number of N limits the decimation ratio. Also, it is evident that the larger the value of N , the narrower the nulls and the less the suppression of unwanted channels in the vicinity of the nulls. Reducing N , though improving attenuation, 79

increases the readout rate. Also observed from (4.17) is that the larger the value of N , the larger the voltage gain provided by the temporal moving average filter. Fig. 4.13 and Fig. 4.14 show the comparison of N=10 and N=5. The overall magnitude transfer function of Fig. 4.12 is given by |H (j )| = N Gm Ti sinc Cs Ti 2 sinc N Tf T .
Ti 2

(4.18)

and is plotted in Fig. 4.15. It can be expected that the joint effect of sinc sinc
N Tf T

and

will not only increase the attenuation in the stop-band, thereby improving the

suppression of unwanted channels, it will also increase the depth of the nulls, improving the suppression of aliasing interferers at and in the vicinity of the nulls.

0 -10 |sinc(NTi/T)|(dB) -20 -30 -40 -50 -60 0

50

100 150 200 Frequency (MHz)

250

300

Figure 4.13: Spectrum of charge-domain windowed sampler with FIR filtering. Parameters: fs =10 MHz, N =10 and Tf = Ts /N .

In conclusion, the CT sinc low-pass response from the current windowed integration nevertheless produces zeros at the multiples of the frequency 1/Ti . The first sidelobe provides maximal 13 dB attenuation on unwanted signal. Like conventional DT filters, the passband of the embedded FIR filter from multiple windowed integration of the current signal in charge-domain sampling circuits is repeated at intervals of its sampling frequency, 1/Tf . 80

0 -10 |sinc(NTi/T)|(dB) -20 -30 -40 -50 -60 0

50

100 150 200 Frequency (MHz)

250

300

Figure 4.14: Spectrum of charge-domain windowed sampler with FIR filtering. Parameters: fs =20 MHz, N =5 and Tf = Ts /N .

0 -5 -10

sinc(Ti/T) sinc(NTf/T

X: 284.9 Y: -13.2

Magnitude

-15 -20 -25 -30 -35 -40

0

50

100

150

200

250

300

350

400

Frequency (MHz)

Figure 4.15: Spectrum of charge-domain windowed sampler with CT sinc low-pass filter. fi =200 MHz, fs =10 MHz, N =10 and Tf = Ts /N .

The final readout rate of the sampler is set at Ts = N Tf . In addition, the phase response of CT and DT sinc filters are ideally linear and can be denoted by group delay in time-domain response.

81

4.2.3

IIR Filter The build-in CT sinc and DT sinc low-pass filter of the charge-domain sampler devel-

oped in above limit the input bandwidth of the sampler and suppress the aliasing signal at the integer multiples of 1/Ti and N/Tf , which effectively provide anti-aliasing filtering function for the sampler. It is worth to note that the selectivity for channel selection, however, is merely elementary and limited. High order or more advanced FIR filter can be implemented to improve the filtering functions, e.g. sharper frequency transition band, and larger attenuation in sidelobs. The cost is increased complexity of the circuit and power consumption. In comparison with FIR filter, a infinite impulse response (IIR) filter is efficient to provide same frequency response while consuming less arithmetic resources. It was shown in [80] a IIR low-pass characteristic can be obtained by employing the recursive operation of a history capacitor and rotating capacitors, as shown in Fig. 4.16. The time interleaved structure is shown in Fig. 4.17.

vi

Gm

ii si
CH

SR CR1

so vo sr

Ti Si SR Sr So (n-1)Ts
Reset

NTf Tf

Successive integration

Readout

nTs

Figure 4.16: Charge-domain sampler with a build-in FIR and IIR filter and its timing scheme.

82

SR1

S o1

vi

Gm

ii Si CH

CR1 S R2 CR2

sr1
So2

vo

sr2

Ti SR1 S o1 S r1 NTf S R2 So2
Readout Reset

NTf
Readout Reset

Sr2 (n-1)Ts

nTs

(n + 1)T s

Figure 4.17: Time interleaved charge-domain sampler with a build-in FIR and IIR filter and its timing scheme.

From Fig. 4.17, the integration capacitor is partitioned into history capacitor CH and rotation capacitors CR1 and CR2 . CH is always charged by the windowed current from the transconductor, and it is never discharged to entirely. While the rotation capacitors are sharing the charges with CH and discharging entirely. CR1,2 are switched between reset/integration and read-out operation. Assume CH = aCs and CR1,R2 = (1 - a)Cs , the total integration capacitance seen by ii (t) is always Cs = CH + CR1,R2 . Consider (n - 1)th phase and assume SR1 =1 and SR2 =0. The current is integrated onto CH + CR1 = Cs while the charge of CR2 is transferred to the load. Let the total charge stored in the integration capacitors CH and CR1 in (n - 1)th phase be Q(n - 1). In the following nth phase where SR1 =0 and SR2 =1, the charge stored in CR1 is transferred to the load. Since CR1 and CR2 are always reset before they are connected to CH , the loss of the charge of the integration capacitors will be the charge of CR1 . If the total charge stored in the integration capacitors

83

CH and CR2 at the end of nth phase is Q(n), the amount of the charge provided by the transconductor during nth phase, denoted by Qin (n), is equal to the charge of CR1 and is therefore given by Q(n) - aQ(n - 1), i.e.

Q(n) = aQ(n - 1) + Qin (n).

(4.19)

Or equivalently, it can be expressed in the z-domain as:

Qz 1 = . Qin 1 - az -1

(4.20)

CH , a value which is always smaller than unity. Since Q(n) = Cs Vo,IIR (n), CH + CR1,R2 Q(n - 1) = Cs Vo,IIR (n - 1), and Qin (n) = Cs Vo,F IR (n), note that the output of the FIR filter where a = is the input of the IIR filter as

Vo,IIR (n) = aVo,IIR (n - 1) + Vo,F IR (n).

(4.21)

Eq.(4.21) is a first-order IIR filter. It can be shown from z -1 = esTs 1 - sTs that

HIIR (s)

1 1-as

1
aTs 1-a

-1

.

(4.22)

The pole of the first-order IIR filter is given by p,IIR =

1 Ts

1 a

- 1 and the gain of the IIR

filter is maximized at DC and is given by 1/(1 - a). It is seen that the larger a is, the larger the gain of the IIR filter and the smaller the pole frequency subsequently the more the attenuation. In other words, a plays a key role in input bandwidth and attenuation.

84

This agrees well with the simulated results in Fig. 4.18, showing a frequency response of first-order IIR low-pass filter for different capacitance ratio values .

0

-10 Magnitude (dB)

-20

-30

a=0.7

a=0.8 a=0.9 a=0.99

-40

-50 0

5

10

15 20 25 Frequency (MHz)

30

35

40

Figure 4.18: Spectrum of charge-domain windowed sampler with first-order IIR filter. fs =10 MHz.

In conclusion, a partial channel select filter is carried out by using first-order DT IIR low-pass filter in the charge-domain sampler with acceptable modification. The IIR filtering operation is taking place at the output sampling rate, fs = 1/Ts . The pole location of the CH IIR filter is merely determined by the capacitor value ratio, a = , which can CH + CR1,R2 be precisely controlled by layout, and fs . The passbands of the IIR filter are repeated at intervals of kfs . It is noticed that in Fig. 4.17, there are a total number of three filters taking place in the signal path, i.e. the first-order CT sinc filter, the first-order DT sinc filter, and the first-order DT integrator.

85

VDD M6 V b1 M7 QCDS M3 V b2 4-path Filter V in+ M1 Ib M5 M2 V inM4 I +Q +-

Figure 4.19: Quadrature Charge-Domain Sampler with 4-path bandpass filter. Circuit Parameters: W1,2 = 20µm, W3,4,5 = 15µm, W6,7 = 10µm, L = 0.36µm, Ib = 150µA., Vb1 =0.67 V, Vb2 =0.65 V.

4.3

Circuit Design and Analysis
The quadrature charge-domain sampler is implemented in a fully-differential config-

uration, shown in Fig. 4.19. The differential input voltage is converted to a current by the transconductor formed by M1 and M2. The signal then passes through the 4-path band-pass filter where aliasing interferences and unwanted signals are attenuated. Transistors M3/M4 form a current buffer with a low input resistance 1/gm3,4 . Transistors M3/M4 form a current buffer with a low input resistance 1/gm3,4 . A large output resistance at the drain of M3/M4 and M6/M7 can be obtained only in the band of the 4-path filter. In other words, the resistance exhibits a relatively low value at out of the band of the 4-path filter. The schematic of differential 4-path filter is shown in Fig. 4.20 . As differential structure, the selectivity of the band-pass filter at the even harmonics of the clock is suppressed. Each path is includes one grounded capacitor connected to two anti-phase driven switches. A 4-phase 25% duty cycle clock provides all required clocks. The switches are implemented by using transmission gate (TG) with large size to minimize the ON-resistance, which affects the profile of the band-pass frequency response. On the

86

s0 s90 s180 vi+ viGm
+ -

CB CB TLO s0 CB s90 s180 s270 CB (b) TLO

s270 s180 s270 s0 s90 (a)

Figure 4.20: (a) Differential 4-path band-pass filter, (b) Clocking scheme.

other hand, the large parasitic capacitors because of the large TG can be merged into the capacitance of base-band capacitors, CB . The PSS-PAC simulated result is shown in Fig. 4.21.

0 -5 -10 Magnitude (dB) -15 -20 -25 -30 -35 -40

100

200 300 400 Frequency (MHz)

500

600

Figure 4.21: Simulated differential 4-path band-pass filter with Ts = TLO = 100 MHz.

87

A complete circuit schematic of I channel of quadrature charge-domain sampler (QCDS) is shown in Fig. 4.22. The schematic for Q channel is identical except that FLO90 and FLO270 are used in Q channel. The QCDS is fully differential, and for each of I and Q channels, the signal path is further split into two paths as time interleaved configuration. Since both the 4-path band-pass filter and quadrature charge-domain sampler contain only capacitors and switches, and the currents of the transconductor M1/M2 are re-used by the quadrature charge-domain sampler, minimizing power consumption.

FLO0 VRFp
C_H

Fdec C_R Fdec

Frd Frst Frd Frst

N FLO Iout+ FLO0

FLO270 Fdec Fdec

Vinp Vinn
+ + Gm - -

FLO180

VRFn

FLO0
C_H

Fdec C_R Fdec

Frd Frst Frd

Iout-

Frd Frd Frst

Frst

Frst

(a)

(b)

Figure 4.22: (a) Differential charge-domain sampler (only half of the circuit is shown), (b) Clocking scheme.

4.3.1

Performance The entire system consists of four distinct functional blocks, namely, a 4-path band-

pass filter, a continuous-time sinc low-pass filter, a FIR filter, and an IIR low-pass filter with transfer function HBP , Hsinc , HF IR , and HIIR , respectively. The overall transfer function is given by H = HBP Hsinc HF IR HIIR . The 4-path bandpass HBP provides a maximum of -40/dec dB attenuation. The continuous-time sinc low-pass obtained from the continuous integration of the input over Ti provides -20/dec dB attenuation. The IIR filter provides another -20/dec dB attenuation. Finally, the attenuation provided by the FIR filter is determined by the number of integration phases and the weight factors. Although the overall

88

attenuation is large, since -3dB frequency of these filters differ and it is likely not possible to have all the filters to have the same -3 dB frequency, the attenuation in the desired stop-band is rather small. The nonidealities of devices further reduces the attenuation. Fig. 4.23 shows the output of the quadrature charge-domain sampler with different history capacitor. It can be seen that increasing the capacitance of the history capacitor improves the attenuation in the stop band and the depth of the nulls. Attenuation is further increased when the 4-path bandpass filter is added. Also, the depth of the nulls of the sampler with the 4-path bandpass filter are much deeper as compared with that without the 4-path bandpass filter. This observation reveals that the 4-path bandpass filter not only attenuates the tones in the stop-band, qualifying it as a band select filter to suppress blockers, it also improves the suppression of aliasing interferences.

0 -20 -40 -60 Magnitude (dB) -80 W/O 4-path C-H=50pF W/O 4-path C-H=10pF With 4-path C-B=40pF, C-H=10pF

-100 -120 -50 -60 -140 -70 -80 -160 -90

-100 -180 -110 24 -200 0

25 50

26 100 Frequency (MHz) 150 200

Figure 4.23: Simulated transfer function (normalized) of quadrature charge-domain sampler. Ideal transconductor with gm = 0.5 mS and ideal switches with Ron = 1 and Rof f = 1T are used. The input is a 100 MHz sinusoid. The sampling frequency is 100 MHz with 25% duty cycle. Voltage gain provided by the sampler is 15 dB.

89

4.3.2

Noise An explicit noise analysis of the quadrature charge-domain sampling circuit is crucial

as the noise contribution to the total system Noise Figure can be significant due to the limited gain of the preceding LNA. In order to evaluate the noise performance of the circuit, follow the approach in [113]. Let the power of the input-referred noise-voltage generator of the sampling mixer be v 2 n . The power of input-referred noise-current generator of the sampling mixer is negligible. The total input noise is obtained from v 2 n,in = v 2 n,Rs + v 2 n where v 2 n,Rs is the noise power of the source resistor.

v2 n, in H BP
4-path bandpass

H sinc

HFIR
Charge-domain sampler

HIIR

v2 n,o

Figure 4.24: Noise analysis of proposed charge-domain sampling mixer.

From the schematic of the sampling mixer, except for the noise voltage from source, there are two noise sources existing, e.g. modelled thermal noise of output impedance of the transconductor and the thermal noise of switch resistors. Compared with output impedance of transconductor, Ron is typically small. For example, in Fig. 4.20, Rout  10 k and Ron =15. Since Rout Ron , the noise voltage of switch resistors is significantly smaller than

that of Rout . Therefore, the noise voltage of switch resistors can be ignored and only modelled noise voltage of output impedance is related to v 2 n . As shown in Fig. 4.24, the input noise is first shaped by the 4-path bandpass filter. It then passes through the charge-domain sampler that provides a continuous-time first-order sinc low-pass Hsinc (j ), a discrete-time FIR filter HF IR (j ) from the multiple sub-integration phases, and the first-order IIR filter HIIR (j ) from the history and rotation capacitors. The total power of the output noise is obtained from

90

 2 = vo 0

|HBP Hsinc HF IR HIIR |2 v 2 n,in d.

(4.23)

To quantify the effect of HBP , Hsinc , HF IR , and HIIR , the noise bandwidth of the sampling mixer with HBP , Hsinc , HF IR , and HIIR are considered individually. To simplify analysis, assume v 2 n,in is white, and the noise of interferences is not taken into consider.

Noise Bandwidth With HBP Considered Consider the effect of the N-path bandpass only. For the 4-path filter shown in Fig. 4.20, the baseband block is a first-order low-pass with transfer function HBB = 1/(s/B + 1) where B = 1/(Rout CB ) is -3 dB frequency and Rout is the output impedance of the transconductor. The transfer function of the N-path band-pass filter was derived earlier in (4.12), where the thermal noise, attenuated by the periodical band-pass filtering at the multiple s and is folded back to the desired signal. In the design, Rout  10k  and CB = 40 pF, -3 dB frequency is 398 KHz while the sampling frequency is 100 MHz and the first notch is located 400 MHz. As a result, the input noise voltage is folded at 300 MHz with 20 dB attenuation, 30 dB attenuation at 500 MHz and etc. This is evident in (4.24) where output noise power of the 4-path filter at  - s is computed and illustrated graphically in Fig. 4.25.

2 4 2 ( -  ) = 0.0625 |H vn,o s BB ( - s )| + sinc

 |HBB ( )|2 4 (4.24)
6 4

+ sinc4 Since sinc4 sinc4
7 4  4

2 4

|HBB ( + s )|2 + ... v 2 n,in .
3 4

0.656, sinc4

 2

0.16, sinc4

0.009, sinc4

5 4

0.001, sinc4

0.002,

0.0003,..., the folding effect can be approximated by only considering the first

2 ( -  ) = two terms of (4.24). As a result, the output noise power at  - s is given by vn,o s

0.074v 2 n,in .

91

HBB(w-ws)

HBB(w)

HBB(w+ws)
HBB(w+2w s )

HBB

2 vn, in

0 w-ws

w

w+ws

w+2ws

w+3ws

(p/2)wB

Figure 4.25: Noise analysis of N-path filter.

The noise bandwidth of the baseband block is given by   . To find out the noise 2 B bandwidth of the sampling mixer with only HBP considered, the calculated total output noise power of the sampling mixer is given by
 2 vno

=
0

2 |HBP |2 vn,in d

=

1 N2

2



sinc4
n=-

n N

 B v 2 n,in 2 (4.25)

  0.074 B v 2 n,in . 2 Note N = 4 was utilized in (4.25).

Noise Bandwidth With Hsinc Considered Consider the effect of Hsinc only. Utilizing (4.14), we obtain from (4.23)
2 vo

1 = 2

Gm Ti Cs

2 0



sinc2

Ti 2

v 2 n,in d

(4.26)

2 2 2  2 = Gm Ti v 2 2 = Gm Ti v 2 , Eq.(4.26) becomes vo . Since v n,in n,in N,sinc 2 2 o Cs 2 Cs 2 0 i = f where N,sinc is the noise bandwidth when only Hsinc is considered, we have N,sinc =  2



Since

sinc2 (x)dx =

where i = 2/Ti .

92

Noise Bandwidth With HF IR Considered Consider the effect of HF IR only. Utilizing (4.17), we have from (4.23)
 2 = vo 0

sinc2 (N Tf f ) v 2 n,in df =

N 2 v n,in . 2Tf

(4.27)

Since
2 = N v2 vo n,in N,F IR

(4.28)
f 2

where N,F IR is the noise bandwidth when only HF IR is considered, we have N,F IR = where f = 2/Tf .

Noise Bandwidth With HIIR Considered Consider the effect of HIIR only. Since HIIR is a first-order low-pass with pole frequency IIR =
1 Ts 1 a

- 1 , the noise bandwidth due to HIIR is given by N,IIR = Tr , To , we have Ts  N Tf . As a result, N,IIR  41 N

  . 2 IIR 1 a

Since Ts = Tr +To +N Tf , if N Tf

- 1 f .

Table 4.1: Noise Bandwidth of Sampling Mixer with 4-path Bandpass, sinc, FIR, and IIR Filters Considered Individually.

Filter N-path bandpass sinc low-pass FIR filter IIR filter

Noise bandwidth N,BP = /2B N,sinc = f , f = i /2 N,F IR = f /2, f = i /N N,IIR = 1/4N (1/a - 1) f

Table 4.1 tabulates the noise bandwidth of the sampling mixer with the 4-path bandpass, sinc, FIR, and IIR filters considered individually. In the design, N =4, CH =10 pF, CR =1 pF. Thus, a = 0.9 and IIR = f /(16 × 9) N,F IR , N,sinc . Compared the noise bandwidth of four, N,BP and N,IIR is much smaller than the other two. The total output noise of

93

the sampling mixer can therefore be obtained from v 2 no N,IIR v 2 n,in and v 2 no N,BP v 2 n,in .

4.3.3

Effect of Nonidealities Fig. 4.26 investigates the effect of the ON-resistance of the switches on the per-

formance of the 4th-path band-bass filter. It is seen that the larger the resistance of the switches, the less the attenuation in the stop band, revealing that minimizing the channel resistance of the switches is essential.

0 -5 -10 Magnitude (dB) -15 -20 -25 -30 -35 -40 -45 0 100 200 300 Frequency (MHz) 400 500 Ron=5 Ohm
Ron=200 Ohm

Figure 4.26: Simulated effect of ON-resistance of switches on 4-path bandpass filter. Ron is varied from 5  to 200 .

Since the parasitic capacitances of switches are absorbed into the large sampling capacitors (40 pF) of the 4-path bandpass filter, their effect on the performance of the filter is rather small. The parasitic capacitances of the switches, however, lower the gain of the charge-domain sampler. Unlike the 4-path bandpass filter, the ON-resistance of switches has a less detrimental effect on the charge-domain sampler [86]. To maximize the gain, small switches are used in QCDS. Fig. 4.27 shows the normalized transfer function of the quadrature charge-domain sampling receiver with embedded FIR, IIR, and 4-path bandpass

94

filters at process corners. It is observed that the variation of attenuation due to process spread is within 10 dB. The voltage gain is 6.9 dB for slow nMOS/slow pMOS (SS) and 14.4 dB for fast nMOS/fast pMOS (FF).

0 -20 Magnitude (dB) -40 -60 -80 -100 -120 0 50

-60 -65 -70 -75 -80 -85 -90 22 24 26 28

TT FF SS FS SF

100 150 Frequency (MHz)

200

Figure 4.27: Simulated frequency response (normalized) of quadrature charge-domain sampler with embedded 4-path bandpass filter at process corners. The input frequency is 100 MHz, the output baseband sampling frequency is 25 MHz (Two 12.5 MHz interleaved clocks with 50% duty-cycle). Legends: TT (typical nMOS/typical pMOS), SS (slow nMOS/slow pMOS), FS (fast nMOS/slow pMOS), SF (slow nMOS/fast pMOS), and FF (fast nMOS/fast pMOS).

Not like simple sampling systems, the effect of the non-ideal clock is more clear. Since the design is a multiple sampling system, the impacts from sampling clocks are complex but critical. clock phase noise - To simply analysis, let us only consider the desired signal frequency, fin . For 4-path filter, if ideal sampling clocks, fs , are applied to each of paths, only frequency component located at fin will be first translated into the baseband and integrated on the capacitor. The capacitor is acting as a low-pass filter to short any unwanted signal out of filter bandwidth to the ground. On the contrary, the signal nearby DC will be held on the capacitor and then be translated back to the original frequency because of the second time ON-OFF of the switches. However, if the sampling clock is non-ideal, a skirt profile in spectrum, all the frequency components inside the skirt will be down-converted to baseband 95

except for the desired signal. The baseband signal then will be up-converted to the desired frequency again where the unwanted components are added on top of the desired signal, deteriorating SNR. The worse case is there is large blocker signal falling in the skirt. This blocker will lower the SNR significantly as it will be added into the desired signal and the low-pass filter in the baseband fails to filter it out. As a result, the phase noise results in increasing noise figure. Similarly, in the charge-domain sampling circuit, phase noise of sampling clock has a detriment on the overall SNR. However, since the frequency translation is accompanied by a continuous-time and a discrete-time since low-pass anti-aliasing filter, which create notches at the sampling frequency, these notches will greatly suppress the effects from the clock phase noise. Meanwhile, the noise on the clock in time domain is denoted by jitter. The clock jitter will change the integration time for a charge-domain sampler, causing error in the final output voltage. While, the clock jitter will has less detrimental to the SNR in a certain frequency range in comparison with voltage sampler. The range is heavily depending on the integration time, Ti . clock phase imbalance - There are two cases for N-path filter. Consider the variation of the duty cycle, if duty cycle is less than 25%(4-path) for each of path, as we can expect the attenuation on the harmonics will be less. The notches associated with the number of the path will be shifted to higher frequency. Therefore, the harmonics, which are still at the same location, will get less attenuation. As a result, higher fold-over components will be added on the desired signal, deteriorating SNR. For the case of duty cycle is more than 25%, charge sharing between each of the baseband capacitor is occurred. This charge sharing will significantly degrade the filtering function. Take the extreme case for example, duty cycle is 100%, at the same moment, all the capacitors in the 4-path filter are sharing the same incoming charges. The characteristics of the N-path network will be entirely disappeared. The more overlapping, the more filtering function will be lost. In a conclusion, the case of more than 25% duty cycle is even worse than the case of less than 25%. In addition, the imbalanced phase between each of the paths could lead to less image rejection and harmonic folding. For the charge-domain sampler, the clock phase imbalance could result in mismatch in the time-interleaved configuration and subsequently introduce pattern noise located at fs /4, fs /2.... which are highly undesirable. 96

The frequency tuning of the sampling mixer is shown in Fig. 4.28. For each input frequency i , the sampling frequency s is adjusted such that the output frequency of the sampling mixer remains unchanged. Since Ts = Tr + To + N Ti , Ti will also change. Thus, when i increases, s will increase, resulting in a reduction in Ti . Since the gain of the charge-domain sampler at DC is given by Gm Ti /Cs , the gain will drop when i increases. This agrees well with the simulation results in Fig. 4.28.

18 16 Simulated Conversion Gain (dB) 14 12 10 8 6 4 2

50

100

150 IF Frequency (MHz)

200

250

Figure 4.28: Simulated frequency tuning range. The input frequency is varied from 50 MHz to 250 MHz. The sampling frequency is also varied accordingly such that the output frequency remains unchanged.

4.4

Measurement Results
The quadrature charge-domain sampler with embedded FIR, IIR, and 4-path band-

pass filters was implemented in IBM cmrf8sf 130 nm 1.2 V CMOS technology. Fig. 4.31 shows the layout of the circuit. The entire chip is 1x2 mm2 . The capacitors in the 4-path filter are two-layer MIM capacitors that provide a higher capacitance density as compared with normal MIM capacitors. Capacitors in the charge-domain sampler are normal MIM capacitors that use only one mask between two metal layers. In addition, to provide an enough driving capability for the switches in the filter blocks, the clock output buffers were 97

designed to drive a 200 fF load capacitance using D flip-flops (DFFs) implemented using TSPC (True-Single-Phase Clocked) logic. The single-ended input signal from the RF signal generator is fed to the active balun shown in Fig. 4.30 where the single-ended input is
+ converted to a differential input (vin to vo via a non-inverting common-gate amplifier and - vin to vo via an inverting common-source amplifier). The balance of the gain of the two halves

of the active balun can be obtained by adjusting Vb of the common-gate. The differential signal is then fed to the transconductor of the 4-path filter. The output of the sampling mixer is fed to a source-follower buffer in order to drive an off-chip RF spectrum analyzer with a 50 input impedance.

Figure 4.29: Die microphotograph of quadrature charge-domain sampler(1x2 mm2 ).

Fig. 4.31 shows the photo-micrograph of the fabricated chip, with probes in place for on-wafer measurement. On-wafer probing was conducted using a Microtech RF-1 microwave probe station (with a Faraday cage) to minimize the effect of package parasitics and external electromagnetic interferers. The pads were arranged based on the configuration of the probes and available silicon area. A Microtech DCQ-06 dc probe, with six ceramic bladed needles configured as SGSSGS (S=signal and G=ground), was used to supply the required dc bias voltages to the chip. Two, single-ended, Microtech ACP-40-D-GSG-150 RF probes were used for the clock and input. One differential Microtech ACP-40-D-GSGSG-150 RF probe

98

RD1
+ vo

RD2
vo

Vb vin Rs1

M1 M2

vin vo Rs

(a)

(b)

Figure 4.30: (a) Active balun. (b) Output buffer. Circuit parameters of active balun: W1,2 = 300µm, Rs1 , RD1 , RD2 = 200. Circuit parameters of source follower : W = 300µm. Rs =1k. Length of all transistors is 0.13 µm.

was used to probe the I and Q outputs. Because the center-to-center pitch of the tips of all probes is 150 µm, the dimensions of all bonding pads are 100 µm × 100 µm. This leaves a 50 µm space between neighboring pads. Flexible RF cables were used to connect the probes including dc probes and test equipment in order to minimize cable loss. The cable loss, including connectors and adapters, was measured and found to be approximately 0.5 dB at 100 MHz.

CKIN IOUT IN QOUT Vb1 Vb2 Vdd Vb3

Figure 4.31: Die photo-micrograph of charge-domain sampler with embedded 4-path bandpass filter with probes in place for on-wafer measurement.

99

The test set-up is shown in Fig. 4.32. Two BK precision 9124 programmable DC power supplies were used in the test set up. One for VDD , dc biasing of the 4-path bandpass filter and common-mode voltage of charge-domain sampler, and the other one is for biasing the on-chip active balun. The ground terminals of all dc power supplies were wired to a common ground plane, in a star configuration, to avoid forming ground loops. All ground pads are connected together, on chip, to avoid any on-chip ground loops. The 100 MHz input signal was generated using an Agilent E4420B 250 kHz  2.0 GHz RF signal generator. The master clock was generated from an Agilent 81130A pattern generator. The clocks used in the 4-path bandpass filter and charge domain sampler were generated from the master clock using an on-chip clock generator. The output waveforms of the quadrature chargedomain sampler were captured using an Agilent MOS-X 3024A 200 MHz oscilloscope. The spectrum of the output of the quadrature charge-domain sampler was measured using an Agilent N9320B 9 kHz  3.0 GHz spectrum analyzer.

Agilent 81130A

Agilent N9320B Agilent E4420B

Agilent 3024A BK 9124 BK 9124

Figure 4.32: Measurement set-up.

The quadrature output signals were captured and are shown in Fig. 4.33. The measured stop-band attenuation and aliasing-band attenuation is around 40 dB, as shown in Fig. 4.34. This was measured by sweeping the input frequency from 100 MHz to 150 MHz. The simulated transfer function and measured transfer function are both plotted in this figure and normalized for comparison. It can be seen that, the measured frequency

100

response matches simulation results closely, up to about 10 MHz. After this, the measured transfer function starts to deviate from the simulation. There are two reasons for this. The loss of the gain and the clock crosstalk. The measured gain is about -9 dB rather than typical case, +14.4 dB or the worst case, +6.9 dB obtained in corner simulation. Given the input is -35 dBm and the limitation of the dynamic range of the spectrum analyzer, without noiseless pre-amplifier providing sufficient gain, it is hard to evaluate the characteristic of the filters, which are designed to provide maximum 80 dB attenuation for aliasing, and 60 dB attenuation for stop-band interferences. The reasons for the low gain is largely due to the improper on-chip biasing. The shifted operating points of the transistors break the impedance matching network. Therefore loss can be from the active balun providing input termination and the source follower output buffer that is connected to the spectrum analyzer whose input impedance is only 50 . In addition, the degraded transconductor contributes the other part of the gain loss. The clock crosstalk also increases the difficulty of getting accurate profile of the filters. Since the limited silicon space, the improper shielding clock induces the coupled clock into the main signal path. The switching noise from the clock generator can eventually affect the VT H thereby changing the bias condition of the transistors. As the design is a multi-sampling system, the pattern noises located at fs /4, fs /2 ... from gain and phase mismatch may degrade the filter performance.The large spikes were observed at the multiple of 12.5 MHz from measurements. The measured tuning range of 25 MHz to 250 MHz is shown in Fig. 4.35. For a 100 MHz input signal, the simulated and measured stop band attenuation is 60 dB and 40 dB, respectively. The simulated and measured aliasing rejection is 70 dB and 42 dB, respectively. A simplified IIP3 measurement was done without using extrapolation approach. For a given sufficient small desired signal at 100.2 MHz with -40 dBm, the two tones, 100.4 MHz and 100.5 MHz with -30 dBm amplitude, was used to calculate IIP3. The post-layout simulation is illustrated in Fig. 4.36. The 1 dB compression point is where the output of the amplifier is deviated from the ideal gain by 1 dB. The simulated 1 dB compression point is -27 dB, shown in Fig. 4.37.

101

Figure 4.33: Measured quadrature output voltage of mixing sampler with input at 100.1 MHz.

0

Simulated TF Measured TF

-20 Magnitude (dB)

-40

-60

-80

-100 0

10

20 30 Frequency (MHz)

40

50

Figure 4.34: Measured and simulated normalized transfer function of mixing sampler.

From PIIP 3 = late signal and Pf und

P + Pf und where P is the difference between input and intermodu2 is the fundamental signal [2], IIP3 is obtained as -17 dBm. The image

rejection was simulated by applying the input frequencies 100 MHz ± 0.2 MHz. The 90 degree phase shift was done in Matlab. By combining the I and Q path output, the quadrature down-conversion results in an image rejection of 43 dB. The post-layout simulation of IMR is shown in Fig. 4.38

102

0

-5 Conversion Gain (dB)

-10

-15

-20

-25 0

50

100 150 Frequency (MHz)

200

250

Figure 4.35: Measured tuning range of mixing sampler.

-40 -60 Magnitude (dBm) -80 -100 -120 -140 -160 0.5

400 KHz and 500 KHz -30 dBm

300 KHz 600 KHz

1 1.5 Frequency (MHz)

2

Figure 4.36: Post-layout simulated IIP3.

The chip consumes 180 µW from a 1.2 V power supply excluding active balun and output buffer. Table 4.2 compares the performance of the design presented in this chapter to that of other published works.

103

-8

-10

Output Power (dBm)

-12

-14

-16

1 dB

-18

-20 -36

-34

-32

-30 -28 Input Power (dBm)

-26

-24

-22

Figure 4.37: Simulated P1dB .

0 -10 -20 Magnitude (dB) -30 -40 Image signal -50 -60 -70 -80 0 Desired signal 43 dB

0.1

0.2 0.3 Frequency (MHz)

0.4

0.5

Figure 4.38: Post-layout simulated IMR.

4.5

Summary
The analysis and design of a low-power charge-domain quadrature down-conversion

sampling mixer with embedded FIR, IIR, and 4-path bandpass filters suitable for band selection, frequency down conversion, and channel selection, are presented. Detailed inves104

Table 4.2: Performance Summary of Sampling Mixer

Parameters This Work [112] [87] Technology 0.13µm 0.35µm 90 nm IF Frequency 100 MHz 100 MHz Base band Output Rate fsout 25 MHz 1.85 MHz 30 MHz Signal Bandwidth 800 KHz 923 KHz 250 MHz IIP3 -17 dBm (simulation) -2 dBm -22 dBm P1dB -27 dBm (simulation) NA -32 dBm NF 19.5 dB (simulation) NA 19 dB Aliasing Rejection 70 dB (simulation) 40 dB (measurement) 18 dB NA Stop Band Att. 60 dB (simulation) 42 dB (measurement) 13 dB 42 dB

[114] 90 nm 268 MHz 120 MHz 20 MHz 0 dBm NA 21.8 dB 32.5 dB 53 dB

tigations of the principles of periodic impulse sampling, periodic windowed sampling, and periodic N-path windowed sampling are presented. Their characteristics, with respect to the suppression of aliasing interferers and attenuation of unwanted channels, are compared. A detailed mathematical treatment of charge-domain windowed samplers with built-in sinc, FIR and IIR filters is provided. A quadrature charge-domain sampler with embedded FIR, IIR, and 4-path bandpass filters is proposed and designed. It is shown that the 4-path bandpass filter preceding the quadrature charge-domain sampling mixer provides sufficient attenuation of unwanted channels and nulls out aliasing interferers. The intrinsic sinc characteristics, FIR filtering from multi-phase integration, and IIR filtering (from the recursive operation of the history and rotating capacitors of the charge-domain sampler) provide further suppression of unwanted channels and aliasing interferers. The reused current configuration, of the 4-path bandpass filter and quadrature charge-domain sampling mixer, helps minimizing overall power consumption. The design is applicable to zero-IF or low-IF receivers and suppresses aliasing signals, out-of-band blockers and IF image signals. Although the presented design implemented a first-order sinc and first-order FIR and IIR filters, high-order FIR filters can be implemented to provide better performance.

105

Chapter 5
A Cascaded Charge-domain Sampling Mixer with Embedded sinc3 FIR and N-Path Filters
In general, a sampling mixer along with an anti-aliasing filter demands large attenuations on aliasing signal and out-of-band signal for RF receivers operating on zero-IF or low-IF topology. In Chapter 4, a charge-domain sampler embedded with CT sinc, elementary DT sinc, first-order DT IIR low-pass and band-pass filters is introduced. An evolution of previous design is implemented in this chapter. A high-order sinc FIR and 4-path band-pass filters embedded charge-domain sampling mixer is presented. The chapter is organized as following: Section 5.1 investigates the advantages of the high-order FIR filter in terms of attenuation at the notches. Section 5.2 exams the proposed sampling circuit. Simulation results are shown in the Section 5.3. A summary is provided in Section 5.4..

5.1

Hight-Order FIR Filter
The FIR filter which is described in Chapter 4 is to provide elementary low-pass

sinc filtering function since the coefficients of the filter are all one. The first sidelob of this type filter is merely 13 dB attenuation. In other words, out-of-band interferences that are within the first sidelobe, are lowered by 13 dB, which is not sufficient for most of the wireless applications. the null depth is heavily depending on the sampling frequency fs . The sampling rate fs must be large enough to get the desired attenuation around fs . On the other hand, high order filter, which use low fs , achieve same performance. [115], [83] and 106

[116] incorporated programmed coefficients of FIR filters to obtain advanced filter function in the sampler. However, the easiest approach is to utilize high-order sinc. For example. a second-order sinc in time domain is the convolution of two first-order sinc. A comparison of sinc, sinc2 and sinc3 is shown in Fig. 5.1.

0 -10 -20 -30 Magnitude (dB) -40 -50 -60 -70 -80 -90 -100 0 2 4 6 Frequency (MHz) 8 10 sinc sinc2 sinc3

Figure 5.1: Frequency response of sinc, sinc2 and sinc3 . fs,f ir =10 MHz, decimation ratio is 2.

The corresponding s-domain transfer function is as follows:

H (s) =

1 - e-sTs sTs

N

.

(5.1)

where N is the order of the filter and Ts is the sampling frequency. It can be seen that the higher-order of the sinc, the wider of the notch. Therefore more attenuation is added on the aliasing signals around fs .

107

5.2

Circuit Design and Analysis
The architecture of the charge-domain sampling mixer is shown in Fig. 5.2. Similar

to the quadrature charge-domain sampler in Chapter 4, the input voltage is processed by the 4-path band-pass filter formed by M1 and a switched capacitor network that performs band selection. The band-selected output voltage obtained by diode-connected M2 is then fed to a pair of trans-conductors formed by M4 and M6 with gm6 = 3gm3 . The output currents of the trans-conductors are fed to a windowed charge-domain sampler (CDS) that functions as a low-pass filter to perform channel selection. Although a single-ended configuration is presented here, the proposed architecture is readily expendable to differential configurations to cancel out the even harmonic components and reject the common-mode signal ideally.

M2 s1 i i,1 v i,1 M4 s2 i i,2 v i,2
vo1 vo
CDS

M6

s3 i i,3 v i,3 s4 i i,4 v i,4

s1 s2 s3 s4 nTs M5

Ts/4

ii

CB M1 v in Vb

(n+1)Ts

M3

Figure 5.2: Advanced charge-domain sampler with embedded N-path band-pass filter.Circuit Parameters: gm1 = 2mS,gm4 = 1.5mS, gm6 = 4.5mS, Ib1 = 150µA, Ib3 = 235µA, Ib5 = 700µA, Vb = 335mV.

108

5.2.1

Performance Fig. 5.2 shows the 4-path bandpass filter, which is the single-ended version of Fig.

4.20. vin is converted to ii by M1. ii is then routed to capacitors CB by sk (t) and integrated onto CB . The switched current ii,k (t) = ii (t)sk (t) produces voltage vi,k (t) = ii,k (t)  zB (t) across the capacitors where zB (t) is the impulse response of the load and  denotes convolution. vi,k (t) is then sampled by sk (t) to produce vo (t). For the sake of convenience, simulated frequency response of the single-ended 4-path filter is re-plotted in Fig. 5.3. It is seen that the absence of 4th and 8th harmonics and the sinc-envelope are due to the frequency-shaping. It should be mentioned again that the larger the number of paths, the less attenuation on interferences located at harmonic frequencies.

0
1

-5 Magnitude (dB)

-10

2

-15

3 6 7 8

-20 0 200

5 4

400 600 Frequency (MHz)

800

1000

Figure 5.3: Response of 4-path band-pass filter in Fig. 5.2 (vo1 excluding M3-M6 and CDS).

Fig. 5.4 shows the simplified schematic of the proposed high-order windowed chargedomain sampler. The CDS implements three distinct filters : a continuous-time (CT) sinc low-pass, a discrete-time (DT) sinc3 low-pass, and a DT sinc low-pass. The CT low-pass filtering is obtained by current integration on sampling capacitors CS 1 with its notches determined by the integration period. To widen the nulls so as to provide a better suppression of interferences in the neighborhood of the notches, a 3rd -order sinc with the coefficients(1 109

3 3 1) that are the results of the convolution of (1 1),(1 1) and (1 1) is implemented by weighted input currents. The simple coefficients limit the decimation ratio to 2 to avoid aliasing, which is achieved by time-interleaved operation Fig. 5.4(b). The second stage performs another decimation of 2. As a result, the sampling frequency is decreased by 4 times. Using a similar approach described in Chapter 4, we obtain the transfer function of the CT low-pass filter and DT filter

Gm Ti H (j ) = sinc CS 1

Ti 2

N -1

N -1

hk1 z
k=0

-k k=0

hk2 z -k = Hsinc HF IR1 HF IR2

(5.2)

where Ti is the pulse width of ai or bi , i = 1, 2, 3, hk1 and hk2 are (1 3 3 1) and (1 1) respectively.

v in

gm 3gm

i in a1 3iin b1
a2 b2 a3 b3

CS1
rt1

rd1

d1 d2 d3

C S2
r1

f1

vout

rd2 rt2 rd3 rt3 (a)

r1 f2 r2 r2

d4

a1 b1 a2 b2 a3 b3 2 3 rd 2 3 3 1 2 1 3 3 3 2 1 2 1 2 rt d 1 3 3 2 4 1 2 4 f 1 2 1 2 r 1 2 1 2 T4 T1 T2 T3
(b)

Figure 5.4: High-order windowed charge-domain sampler. Circuit Parameters: gm =1.5 mS, CS 1 =10 pF, CS 2 =1 pF.

110

It is observed that the entire circuit provides the joint effect of band-pass and highorder sinc low-pass. Not only can a steep stop-band attenuation be obtained, the depth of notches will also be increased, yielding a better suppression of aliasing interferences and those in the vicinity of the notches.

5.3

Simulation Results
The proposed sampling mixer was designed in an IBM 130 nm 1.2V CMOS and

analyzed using Spectre from Cadence. Fig. 5.5 shows the normalized frequency response of the sampling mixer with a zoom-in view of the first and second notches. It is seen that the suppression of aliasing interferences at the closest notch is 80 dB at 920 KHz -3 dB frequency band. Moreover, the wider aliasing band rejection at the second notch caused by sinc3 filter further improves the rejection close to 90 dB. The minimum stop-band attenuation is 57 dB. The gain is 9.2 dB compared to the calculated value of 12 dB. The loss of the gain is mainly due to the finite output impedance of the transconductors and the non-zero ON-resistance of the switches. Fig. 5.6 shows the time response of the sampler with the 100.2 MHz IF input.

0 1st-order sinc -20 -40 Magnitude (dB) -60 -80 -100 -120 -140 0 3rd-order sinc -60 -80 -100 -120 20 40 60

50

100

150 200 Frequency (MHz)

250

300

350

Figure 5.5: Simulated gain-normalized transfer function of proposed charge-domain windowed sampler with 100 MHz input.

111

0.65

Amplitude (mV)

0.6 170 mV

0.55

0.5

0.45

0.4 0

5

10 Time (µ S)

15

20

Figure 5.6: Simulated time response of the output signal with Vin = 50mV , fin = 100.2 MHz, Vout = 170 mV, fout = 200 KHz, fs,out = 25 MHz.

Fig. 5.7 shows the layout of the circuit. The entire chip is 1x2 mm2 . The output of the sampling mixer is fed to a common-source buffer in order to drive an off-chip RF spectrum analyzer with a 50  input impedance. Fig. 5.8 is the post simulation result. It can be observed that the amplitude of the output signal from post-layout simulation is smaller than that of the schematic simulation. It is mainly due to the voltage drop through the signal path in the layout. The chip consumes 1.3 mW from a 1.2 V power supply excluding output buffer. Table 5.1 summarizes the performance of the proposed sampler and compares with that of some reported designs.

5.4

Summary
A charge-domain down-conversion sampling mixer with an embedded 4-path bandpass

filter for band selection, a sinc3 FIR and a 1st -order sinc FIR with decimation of 4 for channel selection is presented. The sinc3 low-pass is obtained via signal weighting and time112

CLK GEN

Vin

B

Vout 4-path sinc
3

Figure 5.7: Simulated time response of the output signal with Vin =50 mV, fin = 100.2 MHz, Vout = 170 mV, fout = 200 KHz, fs,out = 25 MHz.

0.55

0.5 Amplitude (mV)

0.45 120mV 0.4

0.35

0.3 0

1

2

3 Time (µ S)

4

5

6

Figure 5.8: Post-simulated time response of the output signal with Vin =40 mV, fin = 100.2 MHz, Vout = 140 mV, fout = 200 KHz, fs,out = 25 MHz.

interleaving operation. It is shown that the larger attenuation on the aliasing frequency and stop-band frequency is obtained by the combination of multiple filtering functions. The sampler performs decimation by 2 with wider notches and a steeper side-lob attenuation. The total decimation by 4 is obtained by an another sinc filter following sinc3 stage. The

113

Table 5.1: Performance Comparison

This Work Tech. 0.13µm Input Freq. (MHz) 100 Bandwidth (KHz) 920 Output Sampling Freq. (MHz) 25 P1dB (dBm) -16 IIP3 (dBm) -5 Aliasing Reject (dB) -80 Stop Band Att. (dB) -57

[112] 0.35µm 50 12900 25 NA NA -55 -35

[116] 90 nm 200 850 100 NA -25 -50 NA

sampling mixer designed in an IBM 130 nm 1.2V CMOS with 100 MHz input exhibits 80 dB suppression of aliasing interferences and 57 dB stop band attenuation.

114

Chapter 6
Conclusions and Future Work
6.1 Conclusions
A new theoretical approach, clearly elaborating the phenomena of injection lock for harmonic oscillators, is presented. By applying it to analyze injection-lock process, the expression of lock range of the injection-locked harmonic oscillators is derived and validated in Cadence SpectreRF based on IBM 130 nm technology. In addition, the work that explores the intrinsic relation between large impedance variations of active inductors and the lock range of injection-locked active inductor oscillators is completed. The theoretical findings and the demonstrated example result in good understanding of improving the lock range of injection-locked oscillators in terms of design parameters [117, 118, 119]. The multiple multi-tone injection-locked oscillators are also explored. The in-depth investigation of injection-locked non-harmonic oscillators is carried out by utilizing an approach similar to Volterra series. The larger lock range of non-harmonic oscillators with a multi-tone injection can be expected as compared with that with a single-tone injection. For the case of multiple injections, the lock range is studied analytically. And also the proper phase assigned for each of the multiple injections is given. The theoretical analysis is validated using simulation [120, 121, 122, 123]. Two novel receivers for the application of software defined radio (SDR) are presented. The digital signal processing is performed in the analog form, resulting in reconfigurable RF

115

analog front-end. The receivers resolve the issue of using discrete components, e.g. SAW filter, which is commonly employed in the conventional radio frequency receivers to select the desired frequency band. The centre frequency of this filter in designs is controlled by on-chip clocks. In comparison with the traditional design, the needed anti-aliasing filter before analog-to-digital converter is integrated in the receiver and the cut-off frequency of the filter can also be tuned by changing the sampling clocks. As a result, the entire receiver becomes fully digital controlled. The quadrature sampler has the combination of CT sinc, DT sinc, DT IIR and 4-path bandpass filter. The other one has CT sinc, DT sinc3 , DT sinc and 4-path bandpass filter included.The expecting functions of the fabricated chip have been validated on the wafer station in the lab [124, 125, 126]. Although the chips are targeting IF frequency, the conceptional design can be applied to the high frequency range.

6.2

Future Work
With regard to injection-locked oscillators, the extension could be further increasing

the lock range of the relaxation oscillators through feedback signal, representing the frequency offset from the injection signal, to adjust the tail current of the relaxation oscillators. Since the sensitivity of the frequency of the relaxation oscillator is primarily determined by the charging and discharging current, e.g. f = Itail /2(CVref ), given the fixed capacitor value and threshold voltage of the comparator, changing current gives rise to frequency variation. The only issue is how to detect the injection signal to determine whether it is high-injection or low-injection as they give the same frequency difference. If this difficulty can be resolved, much wider lock range can be expected. In addition, implementing the exemplified circuits on chip and testing them in the lab could be the future work as well. Extensive simulations for the theoretical analysis have been carried out. However, the measurement results will provide more solid support for the findings. Also, the example is originally intended for lowpower passive wireless communications. The relaxation oscillator is designed in subthreshold region, resulting in relatively low frequency, 13 MHz. Since the analysis is not limited to low frequency, a regular oscillator with RF band frequency can be developed to further prove the study in this thesis. The other important performance of injection-locked oscillators, 116

which is not discussed, is the lock time. For multiple injections, the impacts of the phases difference between the injection signals and the oscillating signals should be clearly observed from simulations. The multiple injections leads to faster lock time in comparison with the single injection can be expected. However, these are only surmise, which need to be further investigated. There are also more possible extensions for the programmable receivers. Future design could be focusing on the linearity and noise performance of the transconductor, which dominants the linearity and noise for the entire design. Multiple gates, source degeneration and feedback configuration can be used to improve linearity. Furthermore, one more direction is to incorporate  ADC, which offers exceptional performance for high resolution applications. For the 4-path, in stead of bandpass filtering function, itself is a quadrature mixer. In other words, the output of DAC in the  ADC can be applied to 4-path network to translate baseband signal back to RF. The whole loop includes bandpass filter, quadrature mixer for feedback signal, and charge domain sampling mixer with anti-aliasing and channel selection filter. The highly integrated and better linearity can be expected. In addition, the on-wafer measurement is not able to show the entire filtering functions due to some faulty layouts for some critical signal paths, e.g. biasing voltage, receiving signal paths and etc. Since the multiple signal paths are adopted, the matching for each of path becomes essential. The leakage clock signal is observed in the post-layout simulation because of the mismatches of signal paths and improper shielding. It is worth paying close attention on the layout techniques to get better performance.

117

Bibliography
[1] A. Goldsmith, Wireless communications. 2005. Cambridge: Cambridge University Press,

[2] B. Razavi, RF microelectronics. New York: Pearson education, 2012. [3] R. Miller, "Fractional-frequency generators utilizing regenerative modulation," Proc. IRE, pp. 446­457, Jul. 1939. [4] R. Harrison, "Theory of regenerative frequency dividers using double-balanced mixers," Proc. IEEE Int'l Microwave Symp., pp. 459­462, 1989. [5] ----, "A broad-band frequency divider using microwave varactors," IEEE Trans. Microwave Theory Tech., vol. 25, no. 12, pp. 1055­1059, Dec. 1977. [6] H. Rategh and T. H. Lee, "Superharmonic injection-locked frequency dividers," IEEE J. Solid-State Circuits, vol. 34, no. 6, pp. 813­821, Jun. 1999. [7] H. Rategh, H. Samavati, and T. H. Lee, "A CMOS frequency synthesizer with an injection-locked frequency divider for a 5 GHz wireless LAN receiver," IEEE J. SolidState Circuits, vol. 35, no. 5, pp. 780­787, May. 2000. [8] A. Mazzanti, P. Uggetti, and F. Svelto, "Analysis and design of injection-locked LC dividers for quadrature generation," IEEE J. Solid-State Circuits, vol. 39, no. 9, pp. 1425­1433, Sept. 2004. [9] C. Cao and Y. Ding, "A 50-GHz phase-locked loop in 0.13-µm CMOS," IEEE J. Solid-State Circuits, vol. 42, no. 8, pp. 1649­1656, Aug. 2007. [10] H. Wu and L. Zhang, "A 16 to 18 GHz 0.18 µm EPI-CMOS divid-by-3 injectionlocked frequency divider," IEEE Int'l Solid-State Circuits Conf., Digest Tech. Papers, pp. 602­603, 2006. [11] C. Wang, C. Chen, M. Lei, M. Chuang, and H. Wang, "A 66-72 GHz divide-by-3 injection-locked frequency divider in 0.13µm CMOS technology," Proc. IEEE Asian Solid-State Circuits Conference, pp. 344­347, Nov. 2007. [12] C. L. S. Jang and W. Yeh, "A divide-by-3 injection locked frequency divider with single-ended input," IEEE Microwave and Wireless Lett., vol. 18, no. 2, pp. 142­144, Feb. 2008.

118

[13] C. Zhou, L. Zhang, L. Zhang, Y. Wang, and Q. H. Z. Yu, "A 50% duty cycle widelocking range divide-by-3 divider up to 6GHz," Proc. IEEE Radio Frequency Integrated Circuits Symp., pp. 1­4, 2011. [14] I. T. Lee, C. H. Wang, and S. I. Liu, "Current-reused divide-by-3 injection-locked frequency divider in 65 nm cmos," IET Electronics Letters, vol. 47, no. 18, pp. 1029­ 1030, Sept. 2011. [15] I. Lee, C. Wang, J. Sha, Y. Juang, and S. Liu, "D-band divide-by-3 injection-locked frequency divider in 65 nm CMOS," IET Electronics Letters, vol. 48, no. 17, pp. 1041­ 1042, Aug. 2012. [16] Z. Huang, C. Wu, and B. Huang, "Design of 24-GHz 0.8-V 1.51-mW coupling currentmode injection-locked frequency divider with wide locking range," IEEE Trans. Microwave Theory Tech., vol. 57, no. 8, pp. 1948­1958, Aug. 2009. [17] A. Mirzaei, M. Heidari, R. Bagheriand, S. Chehrai, and A. Abidi, "The quadrature LC oscillator: A complete portrait based on injection locking," IEEE J. Solid-State Circuits, vol. 42, no. 9, pp. 1916­1932, Sept. 2007. [18] J.Lee and H. Wang, "Study of subharmonically injection-locked PLLs," IEEE J. SolidState Circuits, vol. 44, no. 5, pp. 1539­1553, May. 2009. [19] A. Musa, R. Murakami, T. Sato, W. Chaivipas, K. Okada, and A. Matsuzawa, "A low phase noise quadrature injection locked frequency synthesizer for mm-wave applications," IEEE J. Solid-State Circuits, vol. 46, no. 11, pp. 2635­2649, Nov. 2011. [20] J. Lu, N. Wang, and M. Chang, "A compact and low power 5 -10 GHz quadrature local oscillator for cognitive radio applications," IEEE J. Solid-State Circuits, vol. 47, no. 5, pp. 1131­1140, May 2012. [21] G. Mangraviti, B. Parvais, V. Vidojkovic, K. Vaesen, V. Szortyka, K. Khalaf, C. Soens, G. Vandersteen, and P. Wambacq, "A 52-66 GHz subharmonically injection-locked quadrature oscillator with 10 GHz locking range in 40nm LP CMOS," Proc. IEEE Radio Frequency Integrated Circuits Symp. (RFIC), pp. 309­312, Jun. 2012. [22] T. Siriburanon, T. Ueno, K. Kimura, S. Kondo, D. Wei, K. Okada, and A. Matsuzawa, "A 60-GHz sub-sampling frequency synthesizer using sub-harmonic injection-locked quadrature oscillators," Proc. IEEE Radio Frequency Integrated Circuits Symposium, pp. 105­108, Jun. 2014. [23] F. Mahony, C. Yue, M. Horowitz, and S. Wong, "A 10-GHz global clock distribution using coupled standing-wave oscillators," IEEE J. Solid-State Circuits, vol. 38, no. 11, pp. 1813­1820, Nov. 2003. [24] L. Zhang, B. Ciftcioglu, M. Huang, and H. Wu, "Injection-locked clocking: A new GHz clock distribution scheme," pp. 785­788, Sept. 2006.

119

[25] L. Z. andA. Carpenter, B. Ciftcioglu, A. Garg, M. Huang, and H. Wu, "Injectionlocked clocking: A low-power clock distribution scheme for high-performance microprocessors," IEEE Trans. Very Large Scale Integration (VLSI) Systems, vol. 16, no. 9, pp. 1251­1256, Sept. 2008. [26] L. Zhang, B. Ciftcioglu, and H. Wu, "Active deskew in injection-locked clocking," in proc. IEEE Custom Integrated Circuits Conf., Sept. 2008, pp. 567­570. [27] M. Hossain and A. Carusone, "CMOS oscillators for clock distribution and injectionlocked deskew," IEEE J. Solid-State Circuits, vol. 44, no. 8, pp. 2138­2153, Aug. 2009. [28] Z. Bai, X. Zhou, R. Mason, and G. Allan, "Low phase noise clock distribution network using rotary traveling wave oscillators and built-in self-test phase tuning technique," IEEE Trans. Circuits and Systems II: Express Briefs(early access), vol. PP, no. 99, pp. 1­1, Oct. 2014. [29] "EPC radio-frequency identity protocols class-1 generation-2 UHF RFID protocol for communications at 860 MHz - 960 MHz, version 1.0.9," EPCglobal Inc., 2005. [30] C. Chan, K. Pun, K. Leung, J. Guo, L. Lincoln, and C. Choy, "A low-power continuously-calibrated clock recovery circuit for UHF RFID IC class-1 generation2 transponders," IEEE J. Solid-State Circuits, vol. 45, no. 3, pp. 587­599, March 2010. [31] F. Marraccini, G. D. Vita, S. Pascoli, and G. Iannaccone, "Low-voltage nanopower clock generator for RFID applications," Microelectronics J., vol. 39, pp. 1736­1739, 2008. [32] H. Lee and S. Mohammadi, "A subthreshold low phase noise cmos lc vco for ultra low power applications," IEEE Microwave and Wireless Components Letters, vol. 17, no. 11, pp. 796­798, Nov. 2007. [33] N. Tran, B. Lee, and J. Lee, "Development of long-range UHF-band RFID tag chip using Schottky diodes in standard CMOS technology,," Proc. IEEE Radio Frequency Integrated Circuits Symp., pp. 281­284, Sept. 2007. [34] B. Fan, Y. Dai, X. Zhang, and Y. Lu, "Low power clock recovery circuit for passive HF RFID tag," Analog Integrated Circuits and Signal Processing, vol. 59, pp. 207­214, 2009. [35] F. Kocer and M. Flynn, "A new transponder architecture with on-chip ADC for longrange telemetry applications," IEEE J. Solid-State Circuits, vol. 41, no. 5, pp. 1142­ 1148, May. 2006. [36] N. Soltani and F. Yuan, "Analysis and design of non-harmonic injection-locked phaselocked loops with applications in remote frequency calibration of passive wireless transponders," IEEE Trans. Circuits and Systems-I: Redular papers, vol. 57, no. 12, pp. 2381­2393, Sept. 2010. 120

[37] Q. Ma, M. Haider, and Y. Massoud, "Robust power oscillator design for inductivepower link applications," in Proc. IEEE Int'l Conf. Electronics, Circuits and Systems, 2011, pp. 109­112. [38] A.Visweswaran, R. Staszewski, J. Long, and A. Akhnoukh, "Fine frequency tuning using injection-control in a 1.2v 65nm CMOS quadrature oscillator," in Proc. IEEE Radio Frequency Integrated Ccicuits Symp., 2012, pp. 293­296. [39] M.Haider, S. Islam, and M. Mahfouz, "Power-efficient injection-locked oscillator for biomedical telemetry applications," IET Electronics Letters, vol. 46, no. 18, pp. 1252­ 1254, Sept. 2010. [40] H. Cho, J. Bae, and H. Yoo, "A 37.5 µw body channel communication wake-up receiver with injection-locking ring oscillator for wireless body area network," IEEE Trans. Circuits Syst. I, vol. 60, no. 5, pp. 1200­1208, May 2013. [41] J. Bae, L. Yan, and H. Yoo, "A low energy injection-locked FSK transceiver with frequency-to-amplitude conversion for body sensor applications," IEEE J. Solid-State Circuits, vol. 46, no. 4, pp. 928­937, April 2011. [42] T. H. Lee, The design of CMOS Radio-Frequency integrated circuits. Cambridge University Press, 2004. Cambridge:

[43] M. McDonald, "A 2.5 GHz BiCMOS image-reject front end," IEEE Int'l Solid-State Circuits Conf., Digest Tech. Papers, pp. 144­145, 1993. [44] A. Hairapetian, "An 81 MHz IF receiver in CMOS," Solid-State Circuits, IEEE Journal of, vol. 31, no. 12, pp. 1981­1986, Dec. 1996. [45] L. Longo, R. Halim, B. Horng, K. Hsu, and D. Shamlou, "A cellular analog front end with a 98 db IF receiver," IEEE Int'l Solid-State Circuits Conf., Digest Tech. Papers, pp. 36­37, 1994. [46] A. Mirzaei, H. Darabi, and D. Murphy, "A low-power process-scalable superheterodyne receiver with integrated high- Q filters," IEEE J. Solid-State Circuits, vol. 46, no. 12, pp. 2920­2932, Dec. 2011. [47] A. Rofougaran, J. Chang, M. Rofougaran, and A. A. Abidi, "A 1 GHz CMOS RF front-end IC for a direct-conversion wireless receiver," IEEE J. Solid-State Circuits, vol. 31, no. 7, pp. 880­889, Jul. 1996. [48] B. Razavi, "A 5.2-GHz cmos receiver with 62-db image rejection," IEEE J. Solid-State Circuits, vol. 36, no. 5, pp. 810­815, May. 2001. [49] A. Garcia, C. Mishra, F. Bahmani, J. Silva-Martinez, and E. Sanchez-Sinencio, "An 11band 3 -10 GHz receiver in Sige BiCMOS for multiband OFDM UWB communication," IEEE J. Solid-State Circuits, vol. 42, no. 4, pp. 935­948, Apr. 2007.

121

[50] A. Abidi, "Rf CMOS comes of age," IEEE J. Solid-State Circuits, vol. 39, no. 4, pp. 549­561, Apr. 2004. [51] J. Mitola, "The software radio architecture," IEEE Communications Mag., vol. 33, no. 5, pp. 26­38, May 1995. [52] A. Abidi, "The path to the software-defined radio receiver," IEEE J. Solid-State Circuits, vol. 42, no. 5, pp. 954 ­ 966, May 2007. [53] B. Razavi, "A study of injection locking and pulling in oscillators," IEEE J. Solid-State Circuits, vol. 39, no. 9, pp. 1415­1424, Sept. 2004. [54] S. Jang, C. Lin, C. Liu, and M. Juang, "An active-inductor injection locked frequency divider with variable division ratio," IEEE Microwave and Wireless Lett., vol. 19, no. 1, pp. 39­41, Jan. 2009. [55] S. Jang, C. Liu, and C. Chuang, "A tail-injected divide-by-4 siGe HBT injection-locked frequency divider," IEEE Microwave and Wireless Lett., vol. 19, no. 4, pp. 236­238, Apr. 2009. [56] C. Zhou, L. Zhang, L. Zhang, Y. Wang, and Q. H. Z. Yu, "Injection-lcoking-based power and speed optimization of CML dividers," IEEE Trans. on Circuits and Systems II - Express Briefs., vol. 58, no. 9, pp. 565­569, Sept. 2011. [57] S. Jang, C. Chang, C. Cheng, C. Hsue, and C. Hsu, "A wide-locking range sige bicmos divide-by-3 injection locked oscillators," pp. 1­4, Apr. 2011. [58] J. Kang, X. Yu, and J. Zhou, "Optimization of injection locked frequency divider with tunable active inductor," proc. IEEE Symp. Radio-Frequency Integration Technology (RFIT), pp. 74­76, Nov. 2012. [59] M. Tsai and H. Wang, "A 0.3-2.5 GHz ultra-wideband mixer using commercial 0.18µm CMOS technology," IEEE Microwave and Wireless Component Lett., vol. 14, no. 11, pp. 522­524, Nov. 2004. [60] E. Sackinger and W. Fischer, "A 3-GHz 32-dB CMOS limiting amplifier for SONET OC-48 receivers," IEEE J. Solid-State Circuits, vol. 35, no. 12, pp. 1884­1888, Dec. 2000. [61] R.Adler, "A study of locking phenomena in oscillators," Proc. of IEEE (reproduced from 1946 version. [62] L. N, S. Patnaik, and R. Harjani, "Understanding the transient behavior of injection lcoked LC oscillators," Proc. IEEE Custom Integrated Circuits Conf., pp. 667­670, 2007. [63] P. Maffezzoni, D. Amore, S. Daneshgar, and M. Kennedy, "Analysis and design of injection locked frequency dividers by means of a phase domain macromodel," IEEE Trans. Circuits and Systems-I: Redular papers, vol. 57, no. 11, pp. 2956­2966, Nov. 2010. 122

[64] I. Ali, A. Banerjee, A. Mukherjee, and B. Biswas, "Study of injection locking with amplitude perturbation and its effect on pulling of oscillator," IEEE Trans. Circuits and Systems-I: Redular papers, vol. 59, no. 1, pp. 137­147, Jan. 2012. [65] H. Chang, A. Borgioli, P. Yeh, and R. York, "Analysis of oscillators with external feedback loop for improved locking rang and noise reduction," IEEE J. Solid-State Circuits, vol. 47, no. 8, pp. 1535­1543, Aug. 1999. [66] H. Chen, D. Chang, Y. Juang, and S. Lu, "A 30-GHz wideband low-power CMOS injection-locked frequency divider for 60-GHz wireless-LAN," IEEE Microwave and Wireless Components Letters, vol. 18, no. 2, pp. 145­147, Feb. 2008. [67] X. Yu, H. Cheema, R. Mahmoudi, A. van Roermund, and X. Yan, "A 3 mW 54.6 GHz divide-by-3 injection locked frequency divider with resistive harmonic enhancement," IEEE Microwave and Wireless Components Letters, vol. 19, no. 9, pp. 575­577, Sept. 2009. [68] H. Wu and A. Hajimiri, "A 19 GHz, 0.5mW, 0.35 µm CMOS frequency divider with shunt-peaking locking range enhancement," IEEE Int'l Solid-State Circuits Conf., Digest Tech. Papers, pp. 412­413, 2001. [69] J. Chien and L. Lu, "Analysis and design of wideband injection-locked ring oscillators with multiple-input injection," IEEE J. Solid-State Circuits, vol. 42, no. 9, pp. 1906­ 1915, Mar. 2007. [70] K. Yamamoto and M. Fujishima, "70 GHz CMOS harmonic injection-locked divider," 2006, pp. 2472­2481. [71] G. G. ad P. Kinget, "Time-domain model for injection locking in nonhamronic oscillators," IEEE Trans. Circuits Syst. I, vol. 55, no. 6, pp. 1648­1658, July 2008. [72] H. Tong, S. Cheng, A. Karsilayan, and J. Martinez, "An injection-locked frequency divider with multiple highly nonlinear injection stages and large division ratios," IEEE Trans. Circuits Syst. II, vol. 54, no. 4, pp. 313­317, April 2007. [73] P. Deng and J. Kiang, "A 5-GHz CMOS frequency synthesizer with an injecton-locked frequency divider and differential switched capacitors," IEEE Trans. Circuits Syst. I, vol. 56, no. 2, pp. 320­326, Feb. 2009. [74] A. Mirzaei, S. Chehrazi, R. Bagheri, and A. Abidi, "Analysis of first-order anti-aliasing integration sampler," IEEE Trans. on Circuits and Systems I., vol. 55, no. 10, pp. 2994 ­ 3005, 2008. [75] J. Jin, X. Yu, J. Zhou, and T. Yan, "Gigahertz range injection locked frequency dividers with band-width enhancement and supply rejection," IEE Electronics Letters, vol. 44, no. 17, pp. 999­1000, Aug. 2008. [76] C. Bos and C. Verhoeven, "Frequency division using an injection-locked relaxation oscillator," in Proc. IEEE Int'l Symp. Circuits Syst., vol. 5, 2002, pp. 517­580. 123

[77] K. Zhu, S. Islam, J. Holleman, and S. Yuan, "A low-power dual-modulus injectionlocked frequency divider for medical implants," in Proc. IEEE Radio and Wireless Symp., 2011, pp. 414­417. [78] K. Zhu, S. Islam, M. Roksharifi, M. Hasan, and I. Mahbub, "A divide-by-3 0.4-1.4 GHz injection-locked frequency divider based on relaxation oscillator," IEEE Microwave and Wireless Components Letters, vol. 23, no. 7, pp. 368­370, July 2013. [79] J. Yuan, "A charge sampling mixer with embedded filter function for wireless applications," Proc. ICMMT, pp. 315­318, 2000. [80] R. Staszewski, K. Muhammad, D. Leipold, C. Hung, Y. Ho, J. Wallberg, C. Fernando, K. Maggio, R. Staszewski, T. Jung, J. Koh, S. John, I. Deng, V. Sarda, O. MoreiraTamayo, V. Mayega, R. Katz, O. Friedman, O. Eliezer, E. De-Obaldia, and P. Balsara, "All-digital TX frequency synthesizer and discrete-time receiver for Bluetooth radio in 130 nm CMOS," IEEE J. Solid-State Circuits, vol. 39, no. 12, pp. 2278 ­ 2291, December 2004. [81] K. Muhammad, R. Staszewski, and D. Leipold, "Digital RF processing: toward lowcost reconfigurable radios," IEEE Communication Mag., vol. 43, no. 8, pp. 105 ­ 113, August 2006. [82] S. Karvonen, T. Riley, and J. Kostamovaara, "Charge-domain FIR sampler with programmable filtering coefficients," IEEE Trans. on Circuits and Systems II., vol. 53, no. 3, pp. 192 ­ 196, March 2006. [83] S. Karvonen, T. Riley, S. Kurtti, and J. Kostamovaara, "A quadrature charge-domain sampler with embedded FIR and IIR filtering functions," IEEE J. Solid-State Circuits, vol. 41, no. 2, pp. 507 ­ 515, Feb. 2006. [84] R. Bagheri, A. Mirzaei, S. Chehrazi, M. Heidari, M. Lee, M. Mikhemar, W. Tang, and A. Abidi, "An 800 MHz - 6 GHz software-defined wireless receiver in 90-nm CMOS," IEEE J. Solid-State Circuits, vol. 41, no. 12, pp. 2860­2876, Dec. 2006. [85] R. Bagheri, A. Mirzaei, M. Heidari, S. Chehrazi, M. Lee, M. Mikhemar, W. Tang, and A. Abidi, "Software-defined radio receivers: dream to reality," IEEE Communications Mag., vol. 44, no. 8, pp. 111 ­ 118, August 2006. [86] A. Mirzaei, S. Chehrazi, R. Bagheri, and A. Abidi, "A second-order anti-aliasing prefilter for a software-defined radio receiver," IEEE Trans. on Circuits and Systems I., vol. 56, no. 7, pp. 1513 ­ 1524, 2009. [87] A. Yoshizawa and S. Iida, "A 250-MHz cutoff charge-domain baseband filter with improved stop-band attenuations," IEEE Radio Frequency Integrated Circuits Symp., Dig. Papers, pp. 491­494, 2009.

124

[88] M. Darvishi, R. V. D. Zee, E. Klumperink, and B. Nauta, "A 0.3-to-1.2 GHz tunable 4th-order switched gm -C bandpass filter with 55 dB ultimate rejection and out-ofband IIP3 of +29 dBm," IEEE Int'l Solid-State Circuits Conf., Dig. Tech. Papers, pp. 358­361, 2011. [89] A. Ghaffari, E. Klumperink, M. Soer, and B. Nauta, "Tunable high-Q N-path bandpass filters: modeling and verification," IEEE J. Solid-State Circuits, vol. 46, no. 5, pp. 998­1011, May 2011. [90] A. Mirzaei, H. Darabi, and D. Murph, "Architectural evolution of integrated M-phase high-Q bandpass filters," IEEE Trans. on Circuits and Systems I., vol. 59, no. 1, pp. 52­65, Jan. 2012. [91] B. Razavi, Design of Analog CMOS Integrated Circuits. 2001. New York: McGraw-Hill,

[92] F. Yuan, CMOS active inductors and transformers - principle, implementation, and applications. New York: Springer, 2008. [93] Y. Wu, X. Ding, M. Ismail, and H. Olsson, "RF bandpass filter design based on cmos active inductors," IEEE Trans. Circuits and Systems-II: Express briefs, vol. 50, no. 12, pp. 942­949, Dec. 2003. [94] T. Lin and A. Payne, "Design of a low-voltage, low-power, wide-tuning integrated oscillator," Proc. IEEE Int'l Symp. Circuits and Systems, vol. 5, pp. 629­632, 2000. [95] S. Hara, T. Tokumitsu, T. Tanaka, and M. Aikawa, "Lossless broad-band monolithic microwave active inductors," IEEE Trans. Microwave theory and applications, vol. 37, no. 12, pp. 1979­1984, Dec. 1989. [96] B. Razavi, "A study of phase noise in CMOS oscillators," IEEE J. Solid-State Circuits, vol. 31, no. 3, pp. 331­343, Mar. 1996. [97] S. Shekhar, M. Mansuri, F. O'Mahony, G. Balamurugan, J. Jaussi, J.Kennedy, D. J. Allstot, R. Mooney, and B. Casper, "Strong injection locking in low-Q LC oscillators: Modeling and application in a forwarded-clock I/O receiver," IEEE Trans. Circuits and Systems-I: Redular papers, vol. 56, no. 8, pp. 1818­1829, Aug. 2009. [98] S. Mitra, Digital Signal Processing : A Computer-Based Approach. Boston: McGrawHill, 2006. [99] M. Schetzen, The Volterra and Wiener Theory of Nonlinear Systems. John Wileys and Sons, 1981. New York:

[100] P. Wampacq and W. Sansen, Distortion Analysis of Analog Integrated Circuits. Boston: Kluwer Academic Publishers, 1998. [101] F. Yuan and A. Opal, "Distortion analysis of periodically switched nonlinear circuits using time-varying volterra series," IEEE Trans. on Circuits and Systems I - Fundamental Theory and Applications, vol. 48, no. 6, pp. 726­738, Jun. 2001. 125

[102] ----, "An efficient transient analysis algorithm for mildly nonlinear circuits," IEEE Trans. on Computer-Aided Design of Integrated Circuits Syst., vol. 21, no. 6, pp. 662­ 673, Jun. 2002. [103] Q. Li and F. Yuan, "Time domain response and sensitivity of periodically switched nonlinear circuits," IEEE Trans. on Circuits and Systems I - Fundamental Theory and Applications, vol. 50, no. 11, pp. 1436­1446, Nov. 2003. [104] R. Thomas and A. Rosa, The Analysis and Design of Linear Circuits. John Wileys and Sons, 2001. New York:

[105] A. Foyt and T. Quist, "Phase-locked gaas cw microwave oscillators," IEEE Trans. on Electron Devices., vol. 13, pp. 662­673, Jan. 1966. [106] H. Stover, "Theoretical explanation for the output spectra of unlocked driven oscillators," Proceedings of the IEEE, vol. 54, pp. 310­311, Feb. 1966. [107] C. Stancampiano and S. Shapiro, "Power spectrum of an injection-locked josephon oscillator," IEEE Trans. on Magnetics., vol. MAG-11, pp. 800­803, Mar. 1975. [108] C. Campbell, "Beat frequency spectra in a driven unlocked multimode saw cmob oscillator," Proc. Ultrasonic Symp., pp. 69­71, 1987. [109] K. Tsai, J. Wu, and S. Liu, "Frequency dividers with enhanced locking range,," Proc. IEEE Radio Frequency Integrated Circuits Symp., pp. 661­664, 2008. [110] Y. Wan, X. Lai, and J. Roychowdhury, "Understanding injection locking in negativeresistance lc oscillators intuitively using nonlinear feedback analysis," Proc. IEEE Custom Integrated Circuits Conf., pp. 729­732, 2005. [111] L. Franks and I. Sandberg, "An alternative approach to the realization of network transfer functions: The N-path filters," Bell Systems Tech. J., vol. 39, pp. 1321­1350, Sept. 1960. [112] S. Karvonen, T. Riley, and J. Kostamovarra, "A CMOS quadrature charge-domain sampling circuit with 66-dB SFDR up to 100 MHz," IEEE Trans. on Circuits and Systems I, vol. 52, no. 2, pp. 292 ­ 304, Feb. 2005. [113] S. Karvonen, T. Riley, and J. Kostamovaara, "A low noise quadrature subsampling mixer," Proc. IEEE Int'l Symp. on Circuits and Systems, vol. 3, pp. 790­793, 2001. [114] M.Huang and T. Chiu, "A quadrature charge-domain filter with freqyency downconversion for RF receivers," IEEE Trans. on Microwave Theory and Techniques, vol. 58, no. 5, pp. 1323­1332, May. 2010. [115] D.Jakonis, K. Folkesson, J. Dabrowski, P. Eriksson, and C. Svensson, "A 2.4 GHz RF sampling receiver front-end in 0.18 µm CMOS," IEEE J. Solid-State Circuits, vol. 40, no. 6, pp. 1265­1277, Jun. 2005.

126

[116] N. Nguten, H. Jung, H. Min, J. Lee, G. Lee, S. Eo, and K. Yu, "A low power discretetime receiver for triple-band FM/T-DMB/DAB system-on-chip," Proc. IEEE CICC, pp. 311­314, 2011. [117] Y. Zhou and F. Yuan, "Subthreshold CMOS active inductors with applications to low-power injection-locked oscillators for passive wireless microsystems," Proc. IEEE Mid-West Symp. Circuits Syst, pp. 885­888, Aug. 2010. [118] ----, "A comparative study of lock range of injection-locked active inductor oscillators," Proc. IEEE Mid-West Symp. Circuits Syst, pp. 793­796, Aug. 2010. [119] ----, "A study of lock range of injection-locked CMOS active-inductor oscillators using a linear control system approach," IEEE Trans. on Circuits and Systems II - Express Briefs., vol. 58, no. 10, pp. 627­631, Oct. 2011. [120] ----, "A freuqncy-domain study of lock range of harmonic oscillators with multiple injections," Proc. IEEE North-East Workshop. Circuits Syst, pp. 29­32, Apr. 2012. [121] F. Yuan and Y. Zhou, "A phasor-domain study of lock range of harmonic oscillators with multiple injections," IEEE Trans. on Circuits and Systems II - Express Briefs., vol. 59, no. 8, pp. 466­470, Oct. 2012. [122] ----, "Frequency-domain study of lock range of non-harmonic oscillators with multiple multi-tone injections," IEEE Trans. on Circuits and Systems I - Regular Papers, vol. 60, no. 6, pp. 1395­1406, Jun. 2013. [123] Y. Zhou and F. Yuan, "A study of injection-locked non-harmonic oscillators using Volterra series," IET Circuits Devices and Systems(accepted for publication), 2014. [124] Y. Zhou, N. Filiol, and F. Yuan, "Low-power programmable charge-domain sampling mixer with embedded N-path bandpass filter for software-defined radio," Proc. IEEE Int'l Symp. Circuits Syst, pp. 1934­1937, May. 2013. [125] Y. Zhou and F. Yuan, "Cascaded charge-domain sampling mixer with embedded 3rdorder sinc FIR and 4-path filters for software-defined radio," IET Electronics Letters, pp. 216­218, Jan. 2014. [126] ----, "Current reuse quadrature charge-domain sampling mixer with embedded FIR, IIR, and N-path filters," IEEE Trans. on Circuits and Systems I - Regular Papers (under revision), 2014.

127


