MODELLING OF TALL-STRUCTURE LIGHTNING RETURN-STROKE CURRENT USING THE ELECTROMAGNETIC TRANSIENTS PROGRAM
by Mohammadsadegh Rahimian Emam M.Sc., Amirkabir University of Technology, Tehran, Iran, 2001 B.Sc., University of Tehran, Tehran, Iran, 1996
A dissertation presented to Ryerson University in partial fulfillment of the requirements for the degree of Doctor of Philosophy in the program of Electrical and Computer Engineering Toronto, Ontario, Canada, 2015

Â© Mohammadsadegh Rahimian Emam 2015

Author's Declaration

I hereby declare that I am the sole author of this dissertation. This is a true copy of the dissertation, including any required final revisions, as accepted by my examiners. I authorize Ryerson University to lend this dissertation to other institutions or individuals for the purpose of scholarly research. I further authorize Ryerson University to reproduce this dissertation by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. I understand that my dissertation may be made electronically available to the public.

Signature

ii

ABSTRACT

Modelling of Tall-Structure Lightning Return-Stroke Current Using the Electromagnetic Transients Program

Mohammadsadegh Rahimian Emam Doctor of Philosophy, Department of Electrical and Computer Engineering, Ryerson University, Toronto, 2015

The main aim of this PhD work is to advance tall-structure lightning return-stroke current modelling. The Alternative Transients Program (ATP), a version of the Electromagnetic Transients program (EMTP), is used to model the lightning current distribution within a tall structure and the attached lightning channel. The tall structure, namely the CN Tower, is modeled as three or five transmission line sections connected in series. The lightning channel is represented by a transmission line with a continuously expanding length. The presented model takes into account reflections within the tower and within the lightning channel. Locations of reflections, current reflection coefficients and the parameters of the current simulation function are calculated based on the time analysis of the current derivative signal, measured at the tower. The decay parameters of the simulation function are first determined by curve fitting the decaying part of the current obtained from measurement. The other parameters are determined by curve fitting the measured initial current derivative impulse with the derivative of the simulation function, before the arrival of reflections. The simulation results substantially succeeded in reproducing the fine structure of the measured current derivative signal. The model allows for the computation of the lightning current at any point along the current path (the tower and the

iii

attached channel), which is required for the calculation of the associated electromagnetic field. Using the three-section model of the tower, the presented return-stroke current model enables the determination of a discrete return-stroke velocity profile, demonstrating that the velocity generally decays with time. Furthermore, based on the five-section model, the proposed approach enables taking into account the existence of upward-connecting leaders, which allowed, for the first time, the determination of upward-connecting leader lengths and returnstroke velocity variation profiles with more details. The return-stroke velocity profile is found to initially increase rapidly with time, reaching a peak, and then decrease less rapidly. The proposed model is also experimentally verified based on the comparison between the computed and measured electromagnetic fields. The simulated electric and magnetic field waveforms are found to reproduce important details of the measured fields, including initial split peaks that appear due to channel-front reflections in the presence of upward-connecting leaders.

Keywords: ATP-EMTP, lightning current, lightning electromagnetic pulse (LEMP), lightning return-stroke models, return-stroke velocity, tall-structure lightning, upward-connecting leader.

iv

ACKNOWLEDGMENTS

I am heartily thankful to my supervisor Prof. Ali M. Hussein for his help during the course of this work. His continuous guidance, encouragement and financial support are appreciated. I would like to thank the Department of Electrical and Computer Engineering and the School of Graduate Studies at Ryerson University for their support during the course of this work. I am also grateful to Dr. Mariusz Milewski, former Postdoctoral Fellow at the Electrical Engineering Department, Ryerson University, for helpful discussions. A special thank you goes to my wife Shideh for her continuous support and tender encouragement throughout my years of studies. My son Arya: I owe you lots and lots of fun hours. I couldn't imagine doing my PhD without you; you really gave me the reason to continue. Words never express how grateful I am to both of you.

v

Table of Contents

1 Introduction .............................................................................................................................. 1 1.1 Preface ................................................................................................................................... 1 1.2 Statement of the Problem ...................................................................................................... 2 1.3 The Proposed Modelling Procedure ...................................................................................... 4 1.4 Organization of the Thesis..................................................................................................... 6 2 Lightning Return-Stroke Current Models ............................................................................. 9 2.1 Lightning Discharge .............................................................................................................. 9 2.2 Cloud-to-Ground Lightning................................................................................................. 10 2.3 Tall-Structure Lightning ...................................................................................................... 13 2.4 CN Tower Lightning Measurement Systems ...................................................................... 15 2.5 Types of Lightning Return-Stroke Current Models ............................................................ 19 2.6 Engineering Transmission Line Models .............................................................................. 22 2.7 Lightning Attachment Process for Tall-Structure Lightning............................................... 23 2.8 Literature Review ................................................................................................................ 26 2.9 Conclusions ......................................................................................................................... 29 3 Transmission Line Modelling of CN Tower Lightning Return-Stroke............................. 30 3.1 Transmission Line Model of the Tower .............................................................................. 30 3.1.1 Three-Section Model of the Tower ......................................................................... 30 3.1.2 Five-Section Model of the Tower ........................................................................... 31 3.2 Transmission Line Model of the Lightning Channel .......................................................... 32 3.3 Reflections along the Lightning Path .................................................................................. 33 3.4 Current Reflection Coefficients ........................................................................................... 36 3.5 Characteristic Impedances ................................................................................................... 40

vi

3.6 Locations of Reflections ...................................................................................................... 44 3.7 Conclusions ......................................................................................................................... 48 4 Calculation of Lightning Current Simulation Function Parameters ................................ 49 4.1 Analytical Representation of the Injected Current .............................................................. 50 4.2 Analysis of Decaying Part of the Current Waveform to Determine Decay Time Constants ............................................................................................................................................. 51 4.3 Simulating the Measred Current Derivative Signal before the Arrival of Reflections ....... 56 4.4 Computation of Simulation Function Parameters Using Particle Swarm Optimization Technique ............................................................................................................................ 63 4.4.1 Theory ..................................................................................................................... 64 4.4.2 Definition of Cost Function .................................................................................... 65 4.4.3 Implementation of PSO Algorithm to Compute Lightning Current Simulation Function Parameters.......................................................................................................... 67 4.5 Conclusions ......................................................................................................................... 72 5 ATP Modelling of Tall-Structure Lightning Current ......................................................... 73 5.1 Computatianal Model In ATP ............................................................................................. 75 5.2 Return-Stroke Channel Model ............................................................................................. 77 5.3 Simulation Results Using CN Tower Three-Section Model (Return-Stroke Velocity Variation)............................................................................................................................. 81 5.4 Simulation Results Using CN Tower Five-Section Model ................................................. 85 5.5 Determining The Lightning Return-Stroke Valocity Variation (Five-Section Model with Existence of an Upward-Connecting Leader) ..................................................................... 86 5.5.1 First Channel-Front Reflection ............................................................................... 89 5.5.2 Channel-Front Reflection Originated from the Top of Space Deck ....................... 91 5.5.3 Channel-Front Reflection Originated from the Bottom of Space Deck ................. 91 5.5.4 Channel-Front Reflection Originated from the Top of Skypod .............................. 92 5.5.5 Channel-Front Reflection Originated from the Bottom of Skypod ........................ 93 vii

5.5.6 Channel-Front Reflection Originated from Ground ............................................... 94 5.6 Conclusions ....................................................................................................................... 103 6 Computation of Lightning Electric and Magnetic Fields ................................................. 105 6.1 Development of Expressions for Electric and Magnetic Fields at a Distance .................. 106 6.2 Simulation of Electric and Magnetic Fields ...................................................................... 112 6.3 Conclusions ....................................................................................................................... 119 7 Conclusions ........................................................................................................................... 120 Appendix A Lightning Current Distribution based on CN Tower Three-Section Model Using Lattice Diagrams .................................................................................................................... 123 Appendix B An Introduction to ATP-EMTP Program .............................................................. 141 Appendix C Publications during the PhD Work ........................................................................ 144 References .................................................................................................................................. 145 Nomenclature ............................................................................................................................ 159

viii

List of Tables
Table 2.1. Current distributions and line charge density for transmission line models. .............. 22 Table 3.1. Computation of reflection coefficients. ...................................................................... 39 Table 3.2. Reflecton coefficients for three-section model. .......................................................... 42 Table 3.3. Reflection coefficients for five-section model............................................................ 42 Table 3.4. Reflection coefficients and characteristic impedances for three-section model. ........ 42 Table 3.5. Reflection coefficients and characteristic impedances for five-section model........... 43 Table 3.6. Normalized characteristic impedances for three-section model. ................................ 43 Table 3.7. Normalized characteristic impedances for five-section model. .................................. 43 Table 3.8. Time difference between impulses for different ......................................................... 46 Table 3.9. Locations of CN Tower structural discontinuities based on time analysis (in m). ..... 46 Table 3.10. Locations of CN Tower structural discontinuities used in simulations (in m). ........ 47 Table 4.1. Four different time windows and corresponding curve fitting results. ....................... 55 Table 4.2. Parameters of single-term Heidler function obtained by curve fitting. ...................... 59 Table 4.3. Parameters of double-term Heidler function obtained by curve fitting. ..................... 59 Table 4.4. PSO parameters used in simulation. ........................................................................... 70 Table 4.5. Optimum values obtained by PSO algorithm. ............................................................ 70 Table 4.6. Optimum values obtained by PSO algorithm for double-term Heidler function. ....... 71 Table 5.1. Determination of upward-connecting leader length and locations of channel-front reflections...................................................................................................................................... 96 Table 5.2. Times of occurrence of channel-front reflections at the coil position (in s). ............ 97 Table 5.3. Average return-stroke velocities. ................................................................................ 97 Table 5.4. Times of occurrence of channel-front reflections at the coil position (in s) ............. 97 Table 5.5. Length of the upward-connecting leader and locations of channel-front reflections (in m)............................................................................................................................................. 97 Table 5.6. Average return-stroke velocities (in m/s) ................................................................. 98 Table 5.7. Times of occurrence of channel-front reflections (in s). .......................................... 98 Table 5.8. Heidler function parameters representing the best fit for estimated return-stroke velocities. ...................................................................................................................................... 99

ix

List of Figures
Figure 2.1. Types of cloud-to-ground lightning discharge. ......................................................... 11 Figure 2.2. Development of negative cloud-to-ground lightning discharge. ............................... 12 Figure 2.3. CN Tower and locations of current sensing and recording systems. ........................ 17 Figure 2.4. Typical images of lightning flashes striking the CN Tower recorded by: (a) Phantom v2.0 digital high-speed camera (adapted from [5]), (b) VHS camera (adapted from [13]). ......... 18 Figure 2.5. Recorded (a) Current derivative signal, (b) current waveform, (c) the magnetic field and (d) the electrc field corresponding to the return stroke of the flash presented in Figure 2.4 (a) [5]. ................................................................................................................................................. 18 Figure 2.6. Current distribution along the lightning channel for TL model. ............................... 23 Figure 2.7. Current distribution along the lightning channel for MTLL model. ......................... 24 Figure 2.8. Current distribution along the lightning channel for MTLE model. ......................... 24 Figure 2.9. Geometry of lumped voltage source modelling [38]. ................................................ 27 Figure 3.1. CN Tower three-section model with lightning channel and leader. .......................... 31 Figure 3.2. CN Tower five-section model with lightning channel and leader. ............................ 32 Figure 3.3. Measured current derivative signal, showing locations of reflections along the lightning current path, Event #1.................................................................................................... 35 Figure 3.4. Measured current waveform obtained by numerical integration of Event #1. .......... 35 Figure 3.5. Measured current derivative signal, Event #2. ........................................................... 37 Figure 3.6. Measured current waveform obtained by numerical integration of Event #2. .......... 37 Figure 3.7. Lattice diagram for determining different reflection coefficients. ............................ 38 Figure 3.8. Measured current derivative signal, showing amplitude of reflections at main discontinuities, including the channel front, Event #1. ................................................................. 39 Figure 3.9. The return-stroke current derivative signal with high peak and low risetime used for calculating the Space-Deck reflection coefficients (Event #3). The current derivative signal of Event #1 is included for comparison puspose............................................................................... 41 Figure 3.10. CN Tower and its structural discontinuities. ........................................................... 44 Figure 3.11. Time differences between the initial impulse and reflected impulses, Event #1. ... 45

x

Figure 3.12. Initial impulse of Event #3 showing reflections from the Space Deck and the Dampers. ....................................................................................................................................... 47 Figure 4.1. Double-term Heidler function simulating the current of Event #2, before the arrival of reflections, (Figure 3.6). ........................................................................................................... 52 Figure 4.2. Double-term Heidler function simulating the current derivative of Event #2, before the arrival of reflections, (derivative of current function, Figure 4.1). ......................................... 52 Figure 4.3. Single-term Heidler function simulating the decaying part of the current obtained from measurement. ....................................................................................................................... 53 Figure 4.4. Double-term Heidler function simulating the decaying part of the current obtained from measurement, event #2 (21=105 Âµs and 22=120 Âµs). .......................................................... 55 Figure 4.5. Simulation of initial impulse, before arrival of reflections for Event #1. ................. 60 Figure 4.6. Simulated initial injected current using double-term Heidler function, compared with measurement, for Event #1. .......................................................................................................... 60 Figure 4.7. Simulation of initial impulse, before arrival of reflections for Event #2. ................. 61 Figure 4.8. Simulated initial injected current using double-term Heidler function, compared with measurement, for Event #2. .......................................................................................................... 61 Figure 4.9. Comparison of simulated current by proposed method (21 = 105 s, 22 = 120 s) and previous work (21 = 1180 s, 22 = 21.96 s) [71] for Event # 2. ......................................... 63 Figure 4.10. Measured current derivative and current obtained by numerical integration used for defining PSO cost function. .......................................................................................................... 66 Figure 4.11. Flowchart of PSO process. ...................................................................................... 68 Figure 4.12. Convergence tendency of PSO algorithm for Event #2. ......................................... 70 Figure 4.13. Measured and simulated current derivatives using PSO algorithm with the doubleterm Heidler function for Event #2. .............................................................................................. 71 Figure 5.1. CN Tower and locations of instruments. ................................................................... 76 Figure 5.2. Circuit model of CN Tower and the attached channel (channel and leader). ............ 77 Figure 5.3. ATP simplified circuit model, neglecting channel-front reflections. ........................ 77 Figure 5.4. ATP model taking into account channel-front reflections. ....................................... 78 Figure 5.5. Measured current derivative showing major reflections from channel front (Event #1). ................................................................................................................................................ 82 xi

Figure 5.6. Measured and simulated current derivatives using the three-section model and a return-stroke velocity of 87 m/Âµs, as well as the simulated current derivative ignoring channelfront (CF) reflections, Event #1. ................................................................................................... 83 Figure 5.7. Simulated current derivative (using the three-section model and the discrete velocity variation) compared with measurement. ....................................................................................... 84 Figure 5.8. Computed lightning current waveforms (800 m, 1000 m and 1500 m). ................... 85 Figure 5.9. CN Tower (CNT) and channel-front (CF) reflections. ............................................. 86 Figure 5.10. Measured and simulated current derivative for five-section and three-section models taking into account the discrete return-stroke velocity variation. .................................... 87 Figure 5.11. Lattice diagram of return-stroke current multiple reflections along the tower and the channel, assuming the return-stroke channel is initiated at height ha above the tower's tip. ........ 88 Figure 5.12. Lattice diagram showing the first channel-front reflection, assuming the returnstroke channel is initiated at height ha above the tower's tip. ....................................................... 90 Figure 5.13. Computed return-stroke velocity variation for different events. ............................. 98 Figure 5.14. Measured and simulated current derivative waveforms using the five-section model, taking into account the 13.75 m-long upward-connecting leader (Event #1). ................ 100 Figure 5.15. Measured and simulated lightning current waveforms using the five-section model, taking into account the 13.75 m-long upward-connecting leader (Event #1). ............................ 100 Figure 5.16. Measured and simulated current derivative waveforms using the five-section model, taking into account the 15.25 m-long upward-connecting leader (Event #2). ................ 101 Figure 5.17. Measured and simulated lightning current waveforms using the five-section model, taking into account the 15.25 m-long upward-connecting leader (Event #2). ............................ 101 Figure 5.18. Measured and simulated lightning current derivative for the three-section and fivesection models, Event #1. ........................................................................................................... 102 Figure 5.19. Measured and simulated lightning current for the three-section and five-section models, Event #1. ........................................................................................................................ 103 Figure 6.1. The geometry used for calculating the electric and magnetic fields. ...................... 107 Figure 6.2. Measured and simulated magnetic fields, 2 km north of the tower, Event #1. ....... 113 Figure 6.3. Measured and simulated magnetic fields, 2 km north of the tower, Event #2. ....... 113 Figure 6.4. Measured and simulated magnetic fields for Event #1 (10s time window). ......... 115 xii

Figure 6.5. Measured and simulated magnetic fields for Event #2 (10s time window). ......... 115 Figure 6.6. Measured and simulated electric fields, 2 km north of the tower, Event #1. .......... 116 Figure 6.7. Measured and simulated electric fields, 2 km north of the tower, Event #2. .......... 116 Figure 6.8. Measured and simulated electric fields for Event #1 (10s time window). ............ 117 Figure 6.9. Measured and simulated electric fields for Event #2 (10s time window). ............ 117 Figure 6.10. Measured and simulated magnetic fields, 2 km north of the tower, for Event #2 (Figure 6.5), compared with previous work [71]. ....................................................................... 118 Figure A.1. CN Tower and its three-section model. .................................................................. 123 Figure A.2. Reflections given by equations (A.1) and (A.2). .................................................... 124 Figure A.3. Reflections given by equations (A.3) and (A.4). .................................................... 125 Figure A.4. Reflections given by equations (A.5) and (A.6). .................................................... 125 Figure A.5. Reflections given by equations (A.7) and (A.8). .................................................... 126 Figure A.6. Reflections given by equations (A.9) and (A.10). .................................................. 126 Figure A.7. Reflections given by equations (A.11) and (A.12). ................................................ 127 Figure A.8. Reflections given by equations (A.13) and (A.14). ................................................ 127 Figure A.9. Reflections given by equations (A.15) and (A.16). ................................................ 128 Figure A.10. Reflections given by equations (A.17) and (A.18). .............................................. 128 Figure A.11. Reflections given by equations (A.19) and (A.20). .............................................. 129 Figure A.12. Reflections given by equations (A.21) and (A.22). .............................................. 129 Figure A.13. Reflections given by equations (A.23) and (A.24). .............................................. 130 Figure A.14. Reflections given by equations (A.25) and (A.26). .............................................. 130 Figure A.15. Reflections given by equations (A.27) and (A.28). .............................................. 131 Figure A.16. Reflections given by equations (A.29) and (A.30). .............................................. 131 Figure A.17. Reflections given by equations (A.31) and (A.32). .............................................. 132 Figure A.18. Reflections given by equations (A.33) and (A.34). .............................................. 132 Figure A.19. Reflections given by equations (A.35) and (A.36). ............................................. 133 Figure A.20. Reflections given by equations (A.37) and (A.38). .............................................. 133

xiii

Figure A.21. Reflections given by equations (A.39) and (A.40). .............................................. 134 Figure A.22. Reflections given by equations (A.41) and (A.42). .............................................. 134 Figure A.23. Reflections given by equations (A.43) and (A.44). .............................................. 135 Figure A.24. Reflections given by equations (A.45) and (A.46). .............................................. 135 Figure A.25. Reflections given by equations (A.47) and (A.48). .............................................. 136 Figure A.26. Current contribution iup given by equation (A.49). ............................................... 137 Figure A.27. Current contribution iT1 given by equation (A.50). .............................................. 137 Figure A.28. Current contribution iT2 given by equation (A.51). .............................................. 138 Figure A.29. Current contribution iT3 given by equation (A.52). .............................................. 138 Figure A.30. Reflections given by equations (A.53) and (A.54). .............................................. 139 Figure A.31. Reflections given by equations (A.55) and (A.56). .............................................. 139 Figure A.32. Reflections given by equations (A.57) and (A.58). .............................................. 140 Figure B.1. Functional diagram of ATP. .................................................................................... 143

xiv

Chapter 1 Introduction 1 Introduction
1.1 PREFACE
In ancient cultures lightning was viewed both as a weapon of the gods, used by them to punish humans, and as a message from heaven used to influence state affairs. Lightning has been a source of fear and respect among people since beginning of times. Systematic studies of thunderstorm electricity began in 1752 when an experiment proposed by Benjamin Franklin was conducted in France. He flew his now famous electrical kite to prove that lightning is some form of electrical discharge. A charged cloud caused the kite to be charged and a spark jumped from a key tied to the bottom of the string to knuckles of Franklin's hand. His body was insulated from the kite's conducting string by silk insulating string. Franklin also showed that a metallic rod connected to ground can protect a structure from lightning damage. Not only kites but also balloons, mortars and, more recently, rockets have been used to extend conducting string into the electric field of clouds [1]. Nowadays lightning and its electromagnetic effects represent a major issue in protection and electromagnetic compatibility (EMC). Lightning can have direct and indirect effects depending on whether it strikes a structure directly or not. For direct lightning strikes, the electric current flowing in the lightning channel is totally injected into the strike point [1], [2]. The danger of lightning is also represented by its nearby effects, due to the induced overvoltages produced when electromagnetic fields radiated by remote strikes couple with sensitive electronic loads or power distribution lines [3], [4]. 1

The main aim of the presented work is to advance tall-structure lightning return-stroke current modelling. The outcomes of the model are the determination of the electric and magnetic fields at
any location. This model can be easily adapted for any other tall and complex structure.

1.2 STATEMENT OF THE PROBLEM
Statistical distributions of the lightning current is required for studying the interaction of lightning electromagnetic fields with electrical systems as well as the design of effective protection. Lightning current can be measured at the channel base using either instrumented towers or rockets trailing wires. Numerical modelling and observations of lightning have shown that the presence of a tall object struck by lightning affects the measured current such that the measurement is dependent on the geometry of the structure. On the other hand, the inverse source problem, which is the estimation of lightning current parameters based on the easily measured lightning-generated electromagnetic pulse (LEMP), has grown in importance in the past few decades [5]-[8]. LEMP is continually recorded by the widely distributed lightning location systems. Lightning location and detection networks such as the North American Lightning Detection Network (NALDN) and the Austrian Lightning Detection and Information System (ALDIS) are examples for the use of the measured electric and magnetic fields of return-strokes, along with some models in order to estimate current peaks and their polarities [9]. NALDN uses an algorithm to estimate the lightning current peak based on the measured magnetic field peak. An important step towards reaching the goal of solving the inverse source problem is the establishment of an accurate field-current relationship that is based on experimental data and proper modelling of the return-stroke current. The correct estimation of

2

the magnetic field waveform is very important if one wants to correctly estimate the lightning current characteristics. The electric fields are used to determine the polarity of return strokes. The above statements constitute the motivation for the present work, whose aim is to improve tall-structure lightning return-stroke current modelling using ATP (Alternative Transients Program) version of Electromagnetic Transients Program (EMTP). The considered tall structure in this work is the 553-m tall Canadian National (CN) Tower. Based on the obtained return-stroke velocity variation and the length of the upward-connecting leader, the current distribution along the lightning path is determined, then the corresponding electric and magnetic fields, 2 km north of the tower, are computed. It is essential to be able to accurately simulate the current at all points along the lightning current path, for reliably computing the electromagnetic field associated with a tall-structure lightning return-stroke. In order to determine the current distribution along the lightning path, the incident current is usually injected at the attachment point, either at the tall-structure strike point or at the tip of an upward-connecting leader. Then, based on a multi-reflection lattice diagram, most current reflections that have considerable amplitude relative to the original injected current are identified. Therefore, the current at any point along the lightning path is determined. In most previous works, it is assumed that all multiple reflections are included in the simulation unless peaks of reflected pulses are smaller than 1% of the initial injected current. However, since these neglected pulses are numerous, the error could be considerable. Furthermore, assuming a constant return-stroke velocity, researchers determined reflection coefficients and parameters of the lightning current simulation function by trial-and-error in order to obtain the best match with the measured current.

3

Instead of the tedious calculation using the lattice diagram, the current is easily computed by transient software programs, such as ATP, with some computational considerations. ATP greatly simplifies the tedious process of utilizing multi-reflection lattice diagrams. The main objective of this work is to advance tall-structure lightning return-stroke current modelling in order to describe the current distribution along the tall structure and the lightning channel, taking into account the existence of upward-connecting leaders. In this thesis, for the first time, the length of the upward-connecting leader as well as the detailed return-stroke velocity variation are determined based on the times of occurrence of channel-front reflections. This includes the use of the derivative of an analytical function to simulate the lightning current derivative measured at the CN Tower, as well as the computation of the corresponding electromagnetic field. A quantitative comparison between the simulated and the measured fields is to be presented. The novelty of this study is the ability of calculating the return-stroke velocity variation. Therefore, instead of using the so-called Automatic Lightning Discharge Progressing Feature Observation System (ALPS) [10], a multi-million dollars system, the presented computational method provides the ability of evaluating return-stroke velocity profile with no hardware cost.

1.3 THE PROPOSED MODELLING PROCEDURE
In the modelling approach, reflections from the channel front and tower's structural discontinuities are taking into consideration. The different steps of the modelling procedure, such as the determination of locations of reflections, reflection coefficients, characteristic impedances and double-term Heidler function parameters of the current, initially injected into the tower, are described. Locations of reflections and reflection coefficients are determined by analyzing the

4

measured current derivative signal. By curve fitting the decaying part of the current from the measured signal and the simulated current, two decay-related constants of a double-term Heidler function (current simulation function) are determined. Other parameters of the simulation function are obtained by curve fitting the simulated current derivative to the measured signal, before the arrival of reflections. Using the three-section model of the tower, the return-stroke velocity profile is determined. The result demonstrates that the velocity decays with time. Furthermore, using the CN Tower five-section model, the proposed approach enables taking into account the existence upwardconnecting leader. It calculates the length of the upward-connecting leader, and determines the return-stroke velocity time variation with more details. The results show that the return-stroke velocity initially increases rapidly with time (or height), reaching a peak, and then decreases less rapidly with time. The lightning current-derivative simulation produces very successfully the fine structure of the measured current derivative signal. Also, the lightning current simulation succeeds in replicating the current obtained by numerically integrating the recoded current derivative signal. These results reveal that ATP is an appropriate tool for such applications and demonstrate the necessity of using the five-section model to replicate the early zero crossing that proves to be a result of the existence of an upward-connecting leader. Simultaneous measurements of the return-stroke current derivative at the CN Tower and the corresponding lightning electromagnetic pulse, measured 2 km north of the tower, enabled the quantitative assessment of lightning return-stroke models. When compared with measurements, the simulated electric and magnetic fields succeed in replicating important details, including the initial split peaks.

5

The research work presented in the thesis has important application in lightning protection, lightning detection, and inverse source problem.

1.4 ORGANIZATION OF THE THESIS
Aside from the introductory chapter (Chapter 1), this thesis is divided into six more chapters: Chapter 2 introduces the lightning phenomenon, different types of cloud-to-ground lightning and the developmental process of a lightning flash. Tall-structure lightning with some detailed descriptions of lightning measurement instruments is included. Typical CN Tower lightning return-stroke including trajectory images as well as current derivative, current, electric and magnetic field waveforms are shown. Furthermore, a review of different modeling approaches to study this natural phenomenon is presented. Among these, the engineering model, which will be employed throughout this thesis, is discussed in details, starting first by their early formulation, for modelling ground initiated return strokes and then describing its extension to take into account the presence of an elevated strike object. Chapter 3 describes the methodology for calculating current reflection coefficients at different structural discontinuities along the CN Tower as well as the channel extremities. Normalized characteristic impedances for different sections of the tower and the attached channel are also determined based on the measured current derivative signals. Also, the exact locations of discontinuities along the tower and the channel are determined using the times of occurrence of related reflections. Chapter 4 presents a method for calculating the parameters of the simulation function, representing the incident current, as well as the initially injected current into the tower. In order to model the spatial-temporal distribution of the lightning return-stroke current along the CN

6

Tower and the attached channel, the parameters of the chosen analytical function (as a current source) are determined in two steps. First, by curve fitting the decaying part of measured and simulated current, two decay constants of the double-term Heidler function (current simulation function) are determined. Other parameters of the simulation function are obtained based on curve fitting the current derivative of the measured signal with the derivative of the simulation function, before the arrival of reflections. This chapter also introduces a method based on particle swarm optimization (PSO) and the lightning return-stroke current derivative, measured at the CN Tower, to calculate incident current parameters. This approach is an alternative method to evaluate the primary lightning return-stroke current parameters as well as reflection coefficients at major structural discontinuities. The PSO technique can generate a high-quality solution within shorter calculation time and stable convergence characteristic than other stochastic method. For this method, the CN Tower is considered as three lossless transmission-line sections connected in series. In Chapter 5, based on the calculated reflection coefficients and parameters of Heidler function (from Chapters 3 and 4), the simulated current derivative and current, using ATP, are obtained. For comparison purpose, a review of previous research on lightning to tall towers, including the CN Tower, is presented. In ATP, the CN Tower is modeled as either three-section or five-section transmission lines. The proposed approach for modelling the lightning channel, as a transmission line, and all reflections within the channel are described. A decreasing returnstroke velocity profile is estimated for the three-section model. The application of the fivesection model enables the determination of more details for return-stroke velocity variation. The proposed model is used not only for estimating the return-stroke velocity variation profile, but

7

also for determining the length of the upward-connecting leader. The simulation results are found to be in good agreement with measurements. They also verify that the return-stroke velocity initially increases rapidly with time, reaching a peak, and then decreases less rapidly. In Chapter 6, the electric and magnetic field associated with the measured CN Tower lightning current derivative signals are computed and compared with measurement. Finally, the conclusions of this study as well as proposed future work are presented in Chapter 7.

8

Chapter 2 Lightning Return-Stroke Current Models 2 Lightning Return-Stroke Current Models
This chapter introduces the lightning phenomenon, and different types of cloud-to-ground lightning, including tall-structure lightning. The lightning current measurement system installed at the CN Tower is described in details. A review of the different modelling approaches to study the lightning phenomenon is presented. Among these, the engineering model, which will be employed throughout this thesis, is discussed in details, starting first by their early formulation, for modelling ground initiated return strokes and then describing its extension to take into account the presence of an elevated strike object.

2.1 LIGHTNING DISCHARGE
The lightning discharge is a natural phenomenon whose very complex physics is not fully understood. Lightning could be defined as a transient, high current electric discharge over a path length in the order of kilometers. The primary producer of lightning is the cumulonimbus thundercloud [1]. Most lightning discharges occur inside thunderclouds or between them. Lightning or the lightning discharge, in its entirety, whether it strikes ground or not, is usually termed a "lightning flash" or just a "flash" and has average time duration of about half a second. A lightning discharge that involves an object on ground or in the atmosphere is sometimes referred to as a "lightning strike". The term "stroke" or "component stroke" apply only to components of cloud-

9

to-ground discharges. Each stroke lasts normally less than one millisecond, the separation time between strokes being typically a few tens of milliseconds [1]. From the observed polarity of the charge effectively lowered to ground and the direction of propagation of the initial leader, four different types of lightning discharges between cloud and earth have been identified. The four types of lightning, illustrated in Figure 2.1, are (a) downward-initiated negative lightning, (b) upward-initiated negative lightning, (c) downwardinitiated positive lightning, and (d) upward-initiated positive lightning. Discharges of all four types can be viewed as effectively transporting cloud charge to the ground and therefore are usually termed cloud-to-ground discharges. It is believed that downward-initiated negative lightning flashes, type (a), account for about 90 percent or more of global cloud-to-ground lightning, and that 10 percent or less of cloud-to-ground discharges are downward-initiated positive lightning flashes, type (c). Upward-initiated lightning discharges, types (b) and (d), are thought to occur only from tall objects (higher than 100 m or so) or from objects of moderate height located on mountain tops [1]. Rocket-triggered lightning is similar in its phenomenology to tall-structure upward initiated lightning. Indeed, most published researches related to the Toronto 553-m tall CN Tower lightning strikes, are the upward-initiated type [11].

2.2 CLOUD-TO-GROUND LIGHTNING
This is the most common type of lightning discharge from cloud to ground and thus will be reviewed in some more detail below. Lightning of this type is striking short or flat objects. It is very typical for negative cloud-to-ground lightning to exhibit downward branching. In some cases more than one branch is contacting the ground at the same time. The processes involved in cloud-to-ground lightning are explained using the idealized

10

+ + + + + -- + + - + + - - - - - + - - - - - - - - - + + +
a)

+ + +

+

+ + + + + -- + + - + - + - - - - + - + + + + + + + + + + + + + +
b) Upward-initiated negative lightning

Downward-initiated negative lightning

+ + + -- + + - - - - +

+ + + -- + - + + + + + +

+ + +
c)

+ + -----

+ + + + + + -+- + + - - - - - - + - - - - - - - - + + + + + -----
d) Upward-initiated positive lightning

Downward-initiated positive lightning

Figure 2.1. Types of cloud-to-ground lightning discharge.

lightning flash time development diagram shown in Figure 2.2. The whole process is started by - the stepped leader, which initiates the first stroke of a flash by jumping in a series of discrete steps from cloud to ground. The stepped leader is initiated by a preliminary breakdown within the cloud. This breakdown process is believed to take place in the lower regions between the smaller positive charge and the negative charge. It preconditions the area for the stepped leader to take place. The stepped leader steps are usually some tens of meters long and their duration is in the order of 1s. Stops between individual steps are in the order of 50s and the average speed of stepped leader propagation is around 2Ã105 m/s [1], [12].

11

+

- - + -+

+ + + + + - + - -- +

+

- - - -+

+ + + + + - + - -- +

+

- - - -+

+ + + + + - + - -- +

+

CLOUD CHARGE DISTRIBUTION

PRILIMINARY BREAKDOWN

STEPPED LEADER

- - - -+ -

+ + + + + - + - -- +

+

- - - -+ - -

+ + + + + - + - -- +

+ + + + +t = + 0

+

+ + + + + t += 1.00 + ms
+ + + + + - + - -- +

+ + + + + t+ + ms = 1.10
+ + + + + - + - -- +

+ + + + + t+= 1.15 + ms
+ + + + + - + - -- +

+ + + + + t+ + ms = 1.20
+ + + + + - + -- + + + + +

+

- - - -+ - + +

+ + + + + - + - -- +

+

+

+

+

- - - -+ - - - ATTACHMENT
+ + + +
PROCESS

- - - -+ - FIRST RETURN
+ + +
STROKE

- - - -+ + + + + +

- - -+
+

+ + + + + t+ + ms = 19.00
+ + + + - + +
K AND J PROCESSES

+ + + + + t+ + ms = 20.00
+ + + + - +

+ + + + + t+ + ms = 20.10
+ + + + - +

+ + + + + t+ + ms = 20.15
+ + + + - +

+ + + + + t+= 20.20 + ms
+ + + + - +

+

+

- + - - --+

- + - - -- - + LEADER +
DART

+

+

- + - - --- - + +

+

- + - - --- +

+

- + - - --SECOND
+ + +
RETURN STROKE

+ + + + + +

+

t = 40.00 ms

+ + + + + +

+

t = 60.00 ms

+ + + + + +

+

t = 61.00 ms

+ + + + + +

+

t = 62.00 ms

+ + + + + +

+

t = 62.05 ms

Figure 2.2. Development of negative cloud-to-ground lightning discharge.

The average stepped leader current is estimated to be in the range of 100-1000 A. The associated radiated electric and magnetic fields have duration of about 1s and risetime 0.1s or less. The electric potential at the bottom of the negatively charged stepped leader channel with
7

respect to the potential of ground is in the order of 10 V. This high potential difference drives the 12

local electric field at ground level and near the grounded objects to rise in excess of the air breakdown value. Consequently, one or even several upward moving discharges are created and the attachment process begins. As soon as one of these upwards extending branches contacts the downward moving stepped leader, at some tens of meters above ground, the final jump occurs and the leader is effectively connected to ground. This initiates the flow of the first return-stroke current, which propagates upwards in the lightning channel path already ionized by the stepped leader and reaches the top of the lightning channel in about 100s [1]. A lightning flash could contain just one stroke or several (up to 20) strokes. If the charge lowered to ground in the first stroke depleted the available cloud charge, there might not be any further subsequent strokes. On the other hand, if there was still additional charge available in the cloud after the first-stroke took place, and this charge was conveniently located close to the top of the already ionized lightning channel path, a dart leader might be formed that would propagate down the residual channel without branching and initiate a subsequent stroke. The time between subsequent strokes belonging to a flash is several milliseconds.

2.3 TALL-STRUCTURE LIGHTNING
It is assumed that grounded objects that are rising above 500m above ground level experience only upward-initiated flashes, objects of 100-500m height experience both downward- and upward-initiated flashes [1]. The tall structure initiated lightning is predominantly of the upward initiated type. The return stroke current neutralizes most often negative cloud charge through several strokes. Those strokes usually resemble subsequent strokes to flat ground since they feature fast risetimes and peak currents in the order of only tens of kA. Lightning to tall structures is one very interesting

13

area of research involving type 2 and type 4 lightning events (Figure 2.1). It is a relatively new field of study, since very tall towers started to become necessary for broadcasting of radio and TV programming some tens of years ago. Tall structures are usually frequently struck by lightning and can be instrumented to directly measure lightning current. Lightning researchers realized the convenience of such tall objects for performing lightning studies and started taking advantage of the situation. A few telecommunication towers around the world have been equipped permanently, others temporarily with current measuring equipment and were used to perform different studies throughout the years. For example, a Rogowski coil was mounted on the CN Tower in Toronto soon after its completion back in the 70's. Currently, there are two permanently mounted Rogowski coils on the tower and lightning current derivative is routinely captured at that site some 50-70 times per year. Very soon, after performing the very first measurements, it was noticed that lightning at tall structures is somewhat different from lightning to flat ground and this is due to the propagation processes that take place inside the structure. Tall towers have considerable influence upon the recorded lightning current and consequently upon the radiated electric and magnetic fields. Empire State Building (ESB) in New York City and Ostankino Tower in Moscow are the other examples for lightning studies. Tall structures are often struck by lightning and this is mostly because of the involved mechanism of discharge initiation. This mechanism is quite similar to the analogous one involved when "classical" rocket initiated lightning is considered. Essentially, at the tip of the tall structure the electric field is intensified and positive charges may form a positively charged leader or leaders that in turn may propagate upwards some tens to hundreds of meters. From the other end, there might be just enough negative charge, attracting

14

even further the developing positive leaders. That charge could be easily neutralized under the existing favorable conditions (short distance to the grounded object and presence of upwards propagating positive leaders). In case one of the positive leaders found its way up to the negatively charged region of the cloud, a continuous current would start flowing and neutralizing some of the available charge. At this time, if more charge were available a number of flashes could take place.

2.4 CN TOWER LIGHTNING MEASUREMENT SYSTEMS
The Toronto CN Tower, standing at a height of 553m, presents an ideal object for studying tallstructure lightning. Although the lightning flash density (number of flashes per square kilometer per year) in Toronto is 2, the CN Tower usually receives several tens of lightning flashes each year [13]. Lightning flashes to the CN Tower have been observed for more than 3 decades. In 1989, a major phase of CN Tower lightning observation commenced. By 1990, five measurement stations were in operation to simultaneously record: the return-stroke current derivative at the tower using a 3-m-long, 40-MHz Rogowski coil connected to a 10 bit, 10 ns double channel digitizer (Tektronix RTD 710A) via a tri-axial cable; the vertical component of the electric field and the two horizontal components of the magnetic field, 2km north of the tower, using three broadband active sensors and two RTD 710A digitizers; and two 2dimensional images of the lightning trajectory using VHS cameras [14], [15]. Expansions of CN Tower lightning measurement capabilities have since continued [5], [16]. The current measurement system located at the CN Tower consists of two Rogowski coils, a double channel LeCroy LT342L digitizer with 1 Mpoint memory per channel, Pentium based PC, tri-axial cable connection for one coil (old coil), optical fiber connection for the other coil

15

(new coil) and a TrueTime GPS computer card. The two Rogowski coils are used to measure the derivative of the lightning current. The electric field sensor measures the vertical component of the electric field (Ez ) and the magnetic field sensor measures the azimuthal component of the magnetic field (H ). A Vision Research Phantom v5.0 digital high-speed camera (HSC) is used to record the visual parameters of lightning strikes to the tower. A 1000-frame/s high-speed camera (HSC) Phantom v2.0 digital high-speed camera was acquired in 1996. In 2006, a Phantom v5.0 new digital high-speed camera was also acquired to record the visual parameters of lightning strikes to the tower. The locations of the CN tower current sensing and recording systems are shown in Figure 2.3 [5]. A typical digital high-speed camera record of a flash striking the CN Tower is depicted in Figure 2.4 (a) captured on August 19, 2005 [5]. Figure 2.4 (b) depicts a typical camera record of lightning flash trajectory captured on June 30, 1998 [13]. Figure 2.5 shows the current derivative, current, and the electric and magnetic fields of the sixth return stroke of the flash presented in Figure 2.4 (a). The corresponding lightning current waveform, shown in Figure 2.5 (b), is obtained by numerical integration [5].

16

Figure 2.3. CN Tower and locations of current sensing and recording systems.

17

(a)

(b)

Figure 2.4. Typical images of lightning flashes striking the CN Tower recorded by: (a) Phantom v2.0 digital high-speed camera (adapted from [5]), (b) VHS camera (adapted from [13]).

(a)

(b)

(c)

(d)

Figure 2.5. Recorded (a) Current derivative signal, (b) current waveform, (c) the magnetic field and (d) the electric field corresponding to the return stroke of the flash presented in Figure 2.4 (a) [5]. 18

2.5 TYPES OF LIGHTNING RETURN-STROKE CURRENT MODELS
Four major classes of lightning return-stroke models have been defined. In actual fact, most of the published readily available models could be classified under one of these classes. They are briefly introduced below [1], [19]. The first class of models is "gas-dynamic" or "physical" model, which is primarily concerned with the radial evolution of a short segment of the lightning channel and its associated shock wave. Principal model's outputs include temperature, pressure, and mass density as a function of the radial coordinate and time [2], [20]-[27]. A few of the gas dynamic models were initially developed to describe laboratory discharges in air but were later applied to the lightning discharge process [20]-[22]. In some recent works, the physical modeling approach assumes that the
plasma column is straight and cylindrically symmetrical, the algebraic sum of positive and negative charges in any volume element is "zero", and local thermodynamic equilibrium exists at all times [23]-[27].

The second class is the "electromagnetic" model that is usually based on a lossy, thin-wire antenna approximation of the lightning channel. The solution of the electromagnetic model is obtained by solving Maxwell's equations using the method of moments (MOM) in order to find the lightning return-stroke current distribution [28]-[32]. Kordi et al. [33] used antenna theory model for modelling the interaction of lightning with the CN Tower. They represented the tower by a lossless wire structure and modeled the return-stroke channel as a lossy vertical antenna attached to the tower top. The voltage source at the top of the strike object determines by the desired current waveform at the channel base and by the input impedances of the lightning channel and the tower. In the AT model the employed electric field integral equation is solved numerically using the method of moments [34]. The modified AT model which is a nonlinear variation of the AT model is also extended to the case of lightning strike to tall towers [35]. 19

The third class of models is the "distributed-circuit" model, also called RLC transmission line model. It can be viewed as an approximation to the electromagnetic models and it represent the lightning discharge as a transient process on a transmission line characterized by resistance, inductance and capacitance, all per unit length. This model is used to determine the channel current versus time and height and can therefore also be used for the computation of remote electromagnetic fields [36]-[39]. The fourth type of lightning return-stroke model, which is the most widely used, is the "engineering" model. In this model, the spatial and temporal distribution of the channel current is specified based on such observed lightning return-stroke characteristics as the current at the channel base and the speed of the upward-propagating front [40], [41]. In this type of model, the return-stroke current is simulated by a current pulse driven by a voltage source or a current source placed at the lightning attachment point, usually the top of a tall structure [37], [44]. For lightning strikes to elevated objects the current pulse propagates along the channel with velocity v and the same current pulse propagates along the tall structure with velocity of light, c. The return-stroke velocity v is less than the speed of light (usually 30%-50% of the speed of light) due to the fact that during the leader phase the lightning channel is not sufficiently ionized for the current to propagate at the speed of light in the channel [19], [36], [43]. The engineering models do not focus on the physics of lightning but rather on obtaining a good agreement between the measured and simulated electromagnetic fields. The engineering models can be divided into two main subcategories, the transmission line (TL) equivalent models and the travelling current source (TCS) models [19], [45]. Boev and Janischweskyj [46] used a modified transmission line modeling approach to model the lightning path. The associated discontinuity at the lightning channel front is treated by

20

introducing reflected and transmitted components, with constituents that are less influential omitted. The CN Tower was represented by one, three, or five transmission line sections connected in series. Assuming a constant return-stroke velocity, they found the reflection coefficients and parameters of lightning current using a trial-and-error approach to obtain the best match with the measured current. The use of the transmission line modeling approach requires the determination of reflection coefficients at the extremities of the strike object, its major internal structural discontinuities, and at the channel front which is not always an easy task. In this study we focus on the engineering models that are based on the transmission line representation of the lightning return-stroke. Bermudez et al. [47] showed that transmission line
modeling approach is quite adequate and useful to model Lightning events at tall structures. These

models are mainly divided into the transmission line (TL) model [19], [48], the modified transmission line model with linear current decay with height (MTLL) [44], and the modified transmission line model with exponential current decay with height (MTLE) [43], [48]. The engineering models based on the travelling current source representation can be divided into original traveling current source model introduced by Heidler [49], Diendorfer-Uman (DU) model [50] and the Bruce-Golde (BG) model, which can be viewed mathematically as special case of TCS or TL model in which the current wave propagates at infinitely large speed while the return-stroke velocity is still finite [51]. The main distinction in terms of current between the two engineering models, TL and TCS, is that in the transmission line model the current wave propagates upward at a finite speed v = vf while in the travelling current source model the current wave propagates downward at a speed of light.

21

2.6 ENGINEERING TRANSMISSION LINE MODELS
The engineering return-stroke model is defined by an equation relating the channel current I(z',t) at any height z' and any time t to the current at the lightning channel base (z'= 0). The
Engineering model could be also defined in terms of line charge density L(z',t) along the channel using the continuity equation [52]. Table 2.1 shows the current distribution as well as line charge

density at any time t and any height z' for the three transmission line models. In this Table, H is total channel height,  is current decay constant (assumed to be 2000 m [43]), c is the speed of light and v is the upward propagating return-stroke speed. u(t- z/v) is Heaviside function equal to
unity for t  z/v and zero for t  z/v. The definition of Q(z,t) is as follows:

Q( z',t )   I (0,  z' / v)d
z' / v

t

(2.1)

Table 2.1. Current distributions and line charge density for transmission line models [7], [39]. Model I(z, t) , L(z,t)
I (z' , t )  I (0, t  z' / v ) u (t  z' / v)

TL

 L (z' , t )   

 I (0, t  z' / v )   v 

I (z' , t )  (1  z' / H ) I (0, t  z' / v) u (t  z' / v)

MTLL

 L (z' , t )  (1 - z' /H ) 
I (z' , t )  e
 z'

 I (0, t  z' / v )  Q ( z',t )   v H  



I (0, t  z' / v) u (t  z' / v)
 z'

MTLE
 L ( z' , t )  e


z'



 I (0, t  z' / v )  e    v   



Q ( z',t )

22

Figures 2.6, 2.7 and 2.8 show the current distribution along the channel in case of lightning to ground for three different TL models.

2.7 LIGHTNING ATTACHMENT PROCESS FOR TALL-STRUCTURE LIGHTNING
When lightning attaches to a tower, two current waves propagate simultaneously away from the attachment point; one upwards into the channel and the other downwards into the tall structure. The return stroke current within the structure propagates at a speed very near the speed of light, while the return stroke velocity within the channel is less than the speed of light (usually 1/3-2/3 the speed of light) due to the fact that during the leader phase the lightning channel is not sufficiently ionized for the current to propagate at the speed of light in the channel [53], [54].

16 14 12

Current (kA)

10 8 6 4 2 0 0
Ground Level 1 km 2 km 3 km 4 km 5 km

5

10

15

20 Time (s)

25

30

35

40

Figure 2.6. Current distribution along the lightning channel for TL model.

23

16 14 12

Current (kA)

10 8 6 4 2 0 0
Ground Level 1 km 2 km 3 km 4 km 5 km

5

10

15

20 Time (s)

25

30

35

40

Figure 2.7. Current distribution along the lightning channel for MTLL model.

16 14 12

Current (kA)

10 8 6 4 2 0 0
Ground Level

1 km

2 km

3 km

4 km

5 km

5

10

15

20 Time (s)

25

30

35

40

Figure 2.8. Current distribution along the lightning channel for MTLE model.

24

Based on the relationship between return stroke velocity and field magnitudes it is reasonable to expect the presence of a tall structure in the lightning path to enhance the radiated fields. In fact the presence of a grounded elevated strike object in the lightning path does have a significant effect on the return stroke current waveform and on the electromagnetic fields radiated [33]. Lightning to a tall structure has been found to result in an increase in both the electromagnetic field peak and maximum steepness compared to lightning strikes to ground with similar current parameters [1], [55]. In the case of lightning striking the CN Tower it was experimentally determined that the field peak associated with a lightning strike to the tower was 2 to 3 times as large as that associated with a similar strike to ground [55], [56]. In such cases, the current wave that travels downward towards the ground is reflected at the bottom and after its round trip to the tip of the tall object it is transmitted into the fully-Ionized channel, prepared by the upward propagating wave. The wave reflected from the bottom of the tall object and transmitted into the lightning channel continues upwards at the speed of light until it catches up with the propagating at a lower speed return stroke channel-front wave. At this point the first, faster propagating, current wave is assumed to vanish and it does not have any contribution in the region beyond the channel front. The associated discontinuity should be considered when computing electromagnetic fields. One way to do so is by introducing an additional term ("turn-on" term) [57]-[61] in the relations for Electric and Magnetic Fields.
In the present thesis the discontinuity is treated in a different way. Instead of forcing the transmitted components into the channel front to be zero, parts of them are allowed to be reflected at the channel front and other parts are transmitted and continue upwards together with the initial wave at the same slower speed. More details are found in the presented ATP models later in the thesis.

25

2.8 LITERATURE REVIEW
Baba et al. presented a lumped voltage source to model the lightning attachment process resulting from a strike to a tall structure and accounting for reflections due to structural discontinuities of the tower [38]. Another model was proposed by Rachidi et al. using distributed shunt current source [62]. Both of these methods provide the same end results while taking different approaches. In the method proposed by Rachidi a current is injected at the top of the lightning channel and travels down the channel with a speed of v. Once the current reaches the tip of the tower, part of it is reflected back from the tip and travels up the channel at a speed of vref (Rachidi assumes vref = c, c is the speed of light) while the other part is transmitted to the tower and travels within the tower with the speed of light, c. Baba proposes a method based on lossless transmission line representation of the lightning channel and the tower, in which a lumped voltage source, Vo(h,t), is inserted between the bottom of the lightning channel and the tip of the tower [38], [63]. Initially the same current is injected into the tall object and the lightning channel as Vo(h,t) / (Zch+Zob), where Zch is the characteristic impedance of the channel and Zob is the characteristic impedance of the object being struck. The current reflection coefficient at the tip for upward propagating waves (t) and the current reflection coefficient at ground for downward propagating waves (g) can be expressed as:

t 

Z ob  Z ch Z ob  Z ch

(2.2)

g 

Z ob  Z g Z ob  Z g

(2.3)

where Zg is lumped grounding impedance. It is assumed that the speed of propagation in the channel as well as speed of ground reflections that are transmitted to the channel is equal to v,

26

while the speed of propagation in the tower is assumed to be equal to the speed of light, c [38], [63]. Figure 2.9 shows the geometry of lumped voltage source modelling. The reflection coefficients for lightning strikes to tall structures are usually evaluated from the lightning return-stroke current waveforms [64], [65]. For example, Beierl used simplified traveling wave model to estimate the current reflection coefficients. In his model the tower was represented by an ideal transmission line, the ground impedance of the tower was modeled by a pure resistor and the current waveform was modeled by an ideal current source with its constant parallel resistance. Using this simple model the current reflection coefficient at the bottom of the tower for downward propagating waves and current reflection coefficient at top of the tower for upward propagating waves are easily determined [65].

Zch

Vo(h,t)

+ t

Zob

h

g Zg Reference Ground Figure 2.9. Geometry of lumped voltage source modelling [38]. 27

The distributed shunt current source modeling proposed by Rachidi et al. [62] uses same approach of Figure 2.9 but instead of voltage source, an initial current source is injected as an incident current and lightning channel represented by distributed current sources along the channel. Generally, the presence of an elevated strike object has been included in two classes of return-stroke models, namely the engineering models and the electromagnetic or antenna-theory (AT) models [19]. Cooray and Rakov [66] used a return-stroke model based on the physics associated with the effects of corona on a current pulse propagating along a transmission line, and predicted the variations of return-stroke velocity along the channel. Baba and Rakov [67] investigated the influence of the presence of a tall strike object and an upward-connecting leader on lightning currents and electromagnetic fields. Mosaddeghi et al. [68], [69] proposed an extension of the engineering models for return-strokes to tall-structures that take into account the reflections at the return-stroke wavefront and the upward-connecting leader. They assumed a constant return-stroke velocity and modeled CN Tower structure as a transmission line. Boev and Janischweskyj [46] used a modified transmission line modeling approach to model the lightning path. The associated discontinuity at the lightning channel front is treated by introducing reflected and transmitted components, with constituents that are less influential omitted. The CN Tower was represented by one, three, or five transmission line sections connected in series. Assuming a constant return-stroke velocity, they found the reflection coefficients and parameters of lightning current using a trial-and-error approach to obtain the best match with the measured current. The use of the transmission line modeling approach requires the determination of reflection coefficients at the extremities of the strike object, its major internal structural discontinuities, and

28

at the channel front which is not always an easy task. The purpose of this work is to introduce a computational method using ATP-EMTP software for modelling a tall structure lightning return-stroke. The model used in this approach is based on transmission line theory. Bermudez et al. [47] showed that the TL modelling approach is quite adequate and useful to model lightning events at tall structures. The CN Tower is represented by either three or five lossless uniform transmission line sections connected in series. The lightning channel and the leader are modeled as lossy transmission line sections using the MTLE model. This method models the variable lengths of channel, in order to simulate the reflected currents from the continuously moving channel front. The reflection coefficients at different discontinuities and the parameters of simulation function, as an initially injected current into the tower, are calculated by analyzing the measured current derivative signal [70], [71]. All computations are performed in the time domain. The presented approach enables the calculation of the upward-connecting leader length and the determination of return-stroke velocity variations along the channel, using the time of occurrence of channel-front reflections recorded by the Rogowski coil.

2.9 CONCLUSIONS
This chapter introduced phenomenology of cloud-to-ground lightning, different types of ground lightning and tall-structure lightning. Among the different return-stroke models, the engineering model, which will be employed throughout this thesis, were presented in details, starting first by their early formulations, introduced ground initiated return strokes and then described their extension to take into account the presence of an elevated strike object.

29

Chapter 3 Transmission Line Modelling of of CN Tower Lightning 3 Transmission Line Modelling CN Tower Return-Stroke Lightning Return-Stroke
This chapter describes the method for calculating current reflection coefficients at different discontinuities along the lightning current path for the three-section and five-section models of the CN Tower. Characteristic impedances for the tower and the attached channel are also determined based on the measured current derivative at the CN Tower. Since the physical dimensions of the tower don't represent the actual locations of reflections, the locations of discontinuities are determined using the time of occurrence of the corresponding reflections. The obtained current reflection coefficients will be used for ATP modelling of the tower as well as attached channel in Chapter 5.

3.1 TRANSMISSION LINE MODEL OF THE TOWER
3.1.1 THREE-SECTION MODEL OF THE TOWER The three-section model of the tower is shown in Figure 3.1. This model represented by three uniform transmission lines: the upper section (with characteristic impedance Z1) extends from the top of the Skypod (restaurant) to the tower's tip; the middle section is between the top and bottom of the Skypod (Z2); and the lower section is between the bottom of the Skypod and ground (Z3). The reflection coefficient at each discontinuity is shown in Figure 3.1.

30

Leader (partially ionized) Z Channel (fully ionized)

ch

Zch

Tip of Tower (553m)

t
Z1

Rogowski Coil (474m)

12
Top of Skypod (365m) Bottom of Skypod (335m)

23

Z2

Z3

g
Ground Level Zg

Figure 3.1. CN Tower three-section model with lightning channel and leader.

3.1.2 FIVE-SECTION MODEL OF THE TOWER The five-section model of the tower is shown in Figure 3.2. This model represented by five uniform transmission lines (TL): the first section (with characteristic impedance Z1) extends from the top of the Space Deck to the tower's tip; the second section is between the top and bottom of the Space Deck (Z2); the third section is between the bottom of the Space Deck and the top of Skypod (Z3); the forth section is between the top and bottom of the Skypod (Z4); and the lower section is between the bottom of the Skypod and ground (Z5).

31

Leader (partially ionized) Z Channel (fully ionized)

ch

Zch

Tip of Tower (553m)

t 12
23

Z1 Z2 Z3 Z4

Rogowski Coil (474m) Space Deck Top of Skypod (365m) Bottom of Skypod (335m)

34 45

Z5

g
Ground Level Zg

Figure 3.2. CN Tower five-section model with lightning channel and leader.

3.2 TRANSMISSION LINE MODEL OF THE LIGHTNING CHANNEL
The two parts of the entire lightning channel are modeled as transmission line sections. The upper part is represents the leader that has been previously partially ionized. It is modeled as a TL with characteristic impedance Z. The lower part, which is up to where the return stroke has already ascended and has caused full ionization of the channel, is modeled as a TL with characteristic impedance Zch [46], [70]. 32

It is assumed that a current pulse, associated with the return-stroke process, is injected at the lightning attachment point producing two current pulses, one into the strike object and one into the channel. The upward-moving wave propagates along the channel at the return-stroke speed v as specified by the return-stroke model and the downward-moving wave propagates at the speed of light c along the strike object.

3.3 REFLECTIONS ALONG THE LIGHTNING PATH
It has always been observed that the return-stroke current derivative signal, measured at the CN Tower, is contaminated by reflections resulting from various discontinuities along the lightning current path (e.g. Figure 2.5). The lightning current wave obviously encounters abrupt changes in the surge impedances within the tower and the attached channel. These changes in the surge impedances can be investigated in great details, because of the sufficient height of the tower and the attached channel. The determination of the exact locations of current reflections, as well as the reflection coefficients is fundamental to modelling the current path as a series of transmission sections. Obviously, the choice of current derivative signal displaying the highest possible peak of the initial impulse with the narrowest pulse width enables the determination of the exact locations of various reflections as well as the final evaluation of reflection coefficients. Figure 3.3 shows a CN Tower lightning return-stroke current derivative signal that was especially selected from among hundreds of signals because of the high peak and narrow pulse width of its initial impulse. This signal represents one of the multi return-stroke flash that was recorded at the tower on June 10, 1996. It is referred to in this thesis as Event #1. Figure 3.4

33

displays the corresponding current of the selected current derivative signal, obtained by numerical integration. The initial impulse of the measured current derivative (Figure 3.3) is denoted by (1). The reflections from top and bottom of the Skypod are denoted by (2) and (3), respectively. The reflection from ground is denoted by (4), while the reflection from ground that is reflected from tip of the CN Tower and goes back to the coil location is denoted by (5). After analyzing many recorded current derivative waveforms, the origin of the sixth reflection (6) has been characterized as a reflection from the lightning channel wavefront [70], [71]. It is a major reflection that results from the first ground reflection, when it reflects back from the channel front. Other channel-front reflections are not as distinguishable in the current derivative waveform. In Figure 3.3, the effect of reflections from top and bottom of the Space Deck is noticed as a bend in the initial impulse. Since these last two reflections are spaced very closely in time, they are not easily discernible on the timescale of Figure 3.3. Also, in order to capture and consider their effect upon the computed current derivative and current waveforms, one should use a high-resolution time step because they are coming from points of reflections, which are only 9 m apart (see Figure 3.2). The first three reflections along with the main peak can be also seen in the current waveform; however the reflections denoted by (5) and (6) are not as distinguishable (Figure 3.4). Also, it is very difficult to determine the reflection coefficients based on the current waveform due to the fact that current waveform is much slower as compared to the current derivative and it does not have zero crossings.

34

60
(1)

50

Current Derivative (kA/s)

40 30 20 10 0 -10 0 1 2
(3)

The effect of Space Deck reflections

(4)

(2)

(5)

(6)

3

4

5 Time (s)

6

7

8

9

10

Figure 3.3. Measured current derivative signal, showing locations of reflections along the lightning current path, Event #1.
20
(2) (1) (4)

15

Current (kA)

(5)

10

(6)

5

(3)

0

0

2

4

6

8

10 Time (s)

12

14

16

18

20

Figure 3.4. Measured current waveform obtained by numerical integration of Event #1.

35

Figure 3.5 shows another important return-stroke current derivative signal, displaying the second best signal found for modelling purpose. It belongs to the same CN Tower flash of June 10, 1996. It is referred to as Event #2 [71]. Its corresponding current is showing in Figure 3.6.

3.4 CURRENT REFLECTION COEFFICIENTS
In order to calculate the values of reflection coefficients, a simple diagram has been developed (Figure 3.7). In this diagram, the initially injected current pulse into the CN Tower, io(t), is the simulated current pulse that has been matched to the measured initial current pulse. The injected current pulse represents a current waveform that is not diluted with any reflections [46], [71]. This figure displays the main structural discontinuities of the three-section model of the tower as well as the channel-front discontinuity that continuously moves on the upward direction. The corresponding reflections in the measured current derivative waveform are shown in Figure 3.8. The amplitude of initial impulse is denoted by f1. The amplitudes of reflections from top and bottom of the Skypod are denoted by f2 and f3, respectively. The amplitude of the reflection from ground is denoted by f4, whereas the reflection from ground that reflects from tip of the tower and goes back to the coil location is denoted by f5. Also, the amplitude of reflection from the lightning channel wavefront, which originates from ground reflection, is denoted by f6. Based on Figure 3.7, each reflection can be calculated in terms of coefficients and initially injected current and then reflection coefficients are determined. The equations for calculating different refection coefficients for three-section model of the tower are presented in Table 3.1. For the five-section model of the tower, two more reflection coefficients are defined at the top and bottom of the Space Deck. Since these two reflections are spaced very closely in the decaying portion of initial impulse, they are not easily discerned as two pulses with zero crossing

36

40

Current Derivative (kA/ s)

30

20

10

0

-10 0

2

4

6

8

10 Time (s)

12

14

16

18

20

Figure 3.5. Measured current derivative signal, Event #2.

12 10 8

Current (kA)

6 4 2 0 0

2

4

6

8

10 Time (s)

12

14

16

18

20

Figure 3.6. Measured current waveform obtained by numerical integration of Event #2.

37

ch

t
io(t)

f5 f2 f3 f4

f6

12 23

f1

g Figure 3.7. Lattice diagram for determining different reflection coefficients.

as displayed for other major reflections (Figure 3.3). In order to determine the Space Deckrelated reflection coefficients, another signal was thought to provide such fine details. Figure 3.9 shows a third signal (Event #3) belonging to the same CN Tower flash on June 10, 1996. The current derivative of Event #1 (Figure 3.3) is included in the figure for comparison purposes. Although Event #3 initial impulse peak was not recorded because its peak substantially exceeded the recording digitizer set limit, this high-amplitude signal is utilized here to show clearly the current reflections from the top (positive) and the bottom (negative) of the Space

38

Deck. The missed initial peak was estimated to be 88.9 kA/Âµs based on the known ground and Skypod reflection coefficients [73].

60 50
f1

Current Derivative (kA/s)

40
f2

30 20 10 0 -10 0 1 2
f3

f4

f5

f6

3

4

5 Time (s)

6

7

8

9

10

Figure 3.8. Measured current derivative signal, showing amplitude of reflections at main discontinuities, including the channel front, Event #1.

Table 3.1. Computation of reflection coefficients. Reflection Top of the Skypod Bottom of the Skypod Ground Tip of the CN Tower Channel Front Equation for calculation
12 
f2 f1

 23 
g 

f3 1 f 1 (1  12 2 )
f4 1 f1 (1  12 2 )(1   232 )

t 
 ch 

f5 1 f1 (1  12 2 )(1   23 2 )  g
f6 1 f1 (1  12 2 )(1   23 2 )(1   t 2 )  g

39

Tables 3.2 and 3.3 show the calculated reflection coefficients for three-section and five-section models of the CN Tower, respectively. These coefficients are determined based on Event #1 and Event #2 of the same flash. It is worth mentioning that reflection coefficients determined from the measurement may vary slightly from one initial impulse to another. It is expected to have better estimation for reflection coefficients when the initial current derivative impulse has a high peak and lower impulse width. In this case the location of reflections would be more accurately determined as well as the reflection coefficients because of lesser overlapping.

3.5 CHARACTERISTIC IMPEDANCES For three-section and five-section models of the tower, the reflection coefficients are expressed in terms of the characteristic impedances in Table 3.4 and Table 3.5, respectively. In these relationships, Zch and Zl represent the characteristic impedances of the channel and the leader, respectively. For ATP simulation purpose, it is assumed that the impedance of the grounding system is a simple resistance with Zg = 40 , which has been found to represent reasonably well the observed current reflections [46]. Based on the assumed ground impedance and the obtained reflection coefficients, all other tower and channel impedances are obtained (Tables 3.4 and 3.5). As expected, it has been found that the simulated current and fields are independent on the assumed numerical value of the ground impedance. Tables 3.6 and 3.7 represent the normalized characteristic impedances for three-section and five-section models, respectively

40

60
Event #1

50 40
Current Derivative (kA/s)

Reflections from Space Deck

Event #3

30 20 10 0 -10 -20 0

1

2

3 Time (s)

4

5

6

7

Figure 3.9. The return-stroke current derivative signal with high peak and low risetime used for calculating the Space-Deck reflection coefficients (Event #3). The current derivative signal of Event #1 is included for comparison puspose.

41

Table 3.2. Reflecton coefficients for three-section model. g Event #1 Event #2 0.462 0.483 t -0.345 -0.346 12 0.199 0.198 23 -0.211 -0.203 ch -0.255 -0.258

Table 3.3. Reflection coefficients for five-section model. g Event #1 Event #2 0.458 0.471 t -0.351 -0.362 12 0.145 0.140 23 -0.115 -0.125 34 0.195 0.187 45 -0.220 -0.234 ch -0.261 -0.265

Table 3.4. Reflection coefficients and characteristic impedances for three-section model. Reflection Coefficient
g 
 23 
Z3  Z g Z3  Z g
Z2  Z3 Z2  Z3

Characteristic Impedance
1  g Z3  Zg 1  g
1   g 1   23 Z2  Zg 1   g 1   23

12 
t 
 ch 

Z1  Z 2 Z1  Z 2
Z1  Z ch Z1  Z ch
Z ch  Z  Z ch  Z 

1   g 1   23 1  12 Z1  Zg 1   g 1   23 1  12

1   g 1   23 1  12 1   t Z ch  Zg 1   g 1   23 1  12 1  t

1   g 1   23 1  12 1   t 1   ch Z  Zg 1   g 1   23 1  12 1   t 1   ch

42

Table 3.5. Reflection coefficients and characteristic impedances for five-section model. Reflection Coefficient
g 
Z5  Z g Z5  Z g

Characteristic Impedance
Z5 1   g  Zg 1 g

 45   34 

Z 4  Z5 Z 4  Z5 Z3  Z4 Z3  Z 4

Z 4 1   g 1   45  Z g 1   g 1   45
Z 3 1   g 1   45 1  34  Z g 1   g 1   45 1  34

 23 
12 

Z 2  Z3 Z2  Z3
Z1  Z 2 Z1  Z 2

Z 2 1   g 1   45 1  34 1   23  Z g 1   g 1   45 1  34 1   23
Z1 1   g 1   45 1  34 1   23 1  12  Z g 1   g 1   45 1  34 1   23 1  12

t 
 ch 

Z1  Z ch Z1  Z ch
Z ch  Z  Z ch  Z 

Z ch 1   g 1   45 1   34 1   23 1  12 1   t  Z g 1   g 1   45 1   34 1   23 1  12 1   t

Z  1   g 1   45 1  34 1   23 1  12 1  t 1   ch  Z g 1   g 1   45 1  34 1   23 1  12 1  t 1   ch

Table 3.6. Normalized characteristic impedances for three-section model. Z1/Zg Event #1 Event #2 2.650 2.580 Z2/Zg 1.775 1.720 Z3/Zg 2.700 2.650 Zch/Zg 5.440 5.250 Z/Zg 9.160 8.950

Table 3.7. Normalized characteristic impedances for five-section model. Z1/Zg Event #1 Event #2 2.714 2.585 Z2/Zg 2.026 1.952 Z3/Zg 2.553 2.510 Z4/Zg 1.720 1.725 Z5/Zg 2.690 2.780 Zch/Zg 5.650 5.524 Z/Zg 9.640 9.510

43

3.6 LOCATIONS OF REFLECTIONS The measured current derivative signals are used to determine the actual locations of the reflections along the CN Tower. The actual dimensions are obtained by time differences between reflections peaks, assuming that the lightning current wave propagates with speed of light. The grounding of the CN Tower consists of six 15-m-long grounding rods [55]. The actual electrical ground level, where downward propagating waves reflected from, is obtained to be lower than street level ground. Figure 3.10 shows the structural discontinuities of the CN Tower. The reflections produced in the current derivative signal and the corresponding times are shown in Figure 3.11. By measuring the time differences between the initial impulse and subsequent impulses, the distance between the sensing coil location and locations of corresponding reflections are obtained.

Dampers Coil position L1 L4 Space Deck

L2

Skypod

L3

Street ground level Actual ground level

Figure 3.10. CN Tower and its structural discontinuities. 44

60 50
Current Derivative (kA/ s)
t1 t2

40 30 20 10 0 -10 0 1

t3 t4 t5

t6

2

3

4

5 Time (s)

6

7

8

9

10

Figure 3.11. Time differences between the initial impulse and reflected impulses, Event #1.

Event #3 is specifically used to calculate the location of the Space Deck. Table 3.8 presents the measured time differences for Events #1 and #2. Table 3.9 shows the calculated distances for three different events. The optimum distances obtained by fine tuning of simulation results are presented in Table 3.10. As discussed earlier in this chapter, reflections due to the Space Deck (SD) are clearly recognizable in Event #3. A close view is displayed in Figured 3.12. In the decaying part of the initial impulse, two sets of reflections can be seen: reflections due to mechanical dampers and reflections due to the Space Deck. It is worth noting that in the upper part of the tower, two heavy hula-hoop dampers are installed to counter wind-related motion of the tower (Figure 3.10). The lower and upper dampers are located at 497.08 m and 512.28 m AGL, respectively. The very first reflections

45

Table 3.8. Time difference between impulses for different events (in Âµs). Event #1 t1 t2 t3 t4 t5 t6 0.72 1.01 0.29 3.19 3.76 0.57 Event #2 0.72 1.01 0.29 3.19 3.77 0.57

Table 3.9. Locations of CN Tower structural discontinuities based on time analysis (in m). Event #1 Coil to Skypod top Coil to Skypod bottom Coil to ground Coil to tower's tip L1 L2 L3 Height of tower 108 151.5 478.5 85.5 193.5 43.5 327 564 Event #2 108 151.5 478.5 85.5 195 43.5 327 564

46

(after initial peak and prior to any reflections) detected by coil can be attributed to these dampers. Figure 3.12 shows these reflections. By time analysis, the following dimensions are obtained: Coil-to- SD top=19.5m (21.64m by simulation) SD top-to-SD bottom=12m (9m by simulation)

Table 3.10. Locations of CN Tower structural discontinuities used in simulations (in m). Coil to Skypod top 108.5 Coil to Skypod bottom 151.5 Coil to ground 480 Coil to tower's tip 83.5 L1 192 L2 43 L3 328.5 Height of tower 563.5

70
0.13 s

60
Current Derivative (kA/ s)

0.08 s

50 40 30 20
Due to Dampers Due to Space Deck

10 0 0.2 0.3 0.4 0.5 0.6 0.7 0.8 Time (s) 0.9 1 1.1 1.2

Figure 3.12. Initial impulse of Event #3 showing reflections from the Space Deck and the Dampers. 47

3.7 CONCLUSIONS
This chapter describes the methodology for calculating current reflection coefficients at different discontinuities along the lightning current path for the three-section and five-section models of the CN Tower. Characteristic impedances for the tower and the attached channel were determined based on the measured current derivative at the CN Tower. The actual locations of discontinuities were determined using the time of occurrence of the corresponding reflections. The calculated characteristic impedances of different sections of current path are to be used in Chapter 5 for ATP modelling of the tower as well as attached channel.

48

Chapter 4 4 Calculation Lightning Current Simulation Calculation of of Lightning Current Simulation Function Parameters Function Parameters
This chapter presents a method for calculating the parameters of the CN tower initially injected lightning current into the tower, which propagates in the tower at the speed of light. In order to model the spatial-temporal distribution of the lightning return-stroke current along the CN Tower and the attached channel, the parameters of the current simulation function, representing the injected current, must be determined. The obtained simulation function is to be used in Chapter 5. First, by curve fitting the decaying part of measured and simulated current, two decay constants of the double-term Heidler function (current simulation function) are determined. Other parameters of the simulation function are obtained based on curve fitting the current derivative of the measured signal with the derivative of the simulation function, before the arrival of reflections. Accuracy and speed of curve fitting process depend on the number of unknown parameters. In this chapter, another method, based on particle swarm optimization (PSO) technique, is also introduced for calculating the current simulation function parameters. In PSO algorithm, both current and current derivative waveforms are used for identifying an efficient cost function. The results show that PSO algorithm prompts convergence quickly and provides good evaluation values.

49

4.1 ANALYTICAL REPRESENTATION OF THE INJECTED CURRENT
The analytical expression usually adopted to represent the injected current io(t) is Heidler function [74], defined as:
( io (t )  I t

1

)n t )
n

e 2

 t

(4.1)

1 (

1

Where I is a control of the current amplitude 1 is the front time constant 2 is the decay time constant n is an exponent having values between 1.1 to 20

Heidler function has been introduced because it satisfies many desired constraints: it features a zero second-order time derivative at t = 0, consistent with measured return-stroke current waveshapes and, additionally, it allows precise and easy adjustment of the current amplitude, maximum current derivative and electrical charge transferred nearly independently by varying I, 1 and 2 [1]. Sum of two Heidler functions is also used in order to reproduce a specific return-stroke waveform obtained by measurements. It is referred to as the double-term Heidler function throughout this thesis [44], [69]:
( io (t )  I1 t

 11

) n1 )
n1

1 (

t

e  21  I 2



t

(

t t

 12

) n2 )
n2

e  22



t

 11

1 (

(4.2)

 12

The eight parameters of the double-term Heidler function are: I1 and I2 (for controlling the current impulse amplitude), 11, 12 (front time constants), 21, 22 (decay time constants), and n1 50

and n2 (exponents that control the steepness). Heidler function satisfies the two basic requirements needed for the lightning current simulation, i.e. the current and current derivative do not have discontinuity at t = 0. These requirements exist, provided that n > 1. Typical waveforms of Heidler function current and its derivative in the range of 0-10 s are shown in Figures 4.1 and 4.2, respectively. The parameters of the double-term Heidler function, representing these waveforms, are I1=1.2 kA, 11=0.30 Âµs, 21=105 Âµs, n1=14, I2=7.1 kA, 12=0.37 Âµs, 22=120 Âµs, and n2=6.4. In Figures 4.1 and 4.2, Imax is the maximum current that occurred at tmc and Idmax is maximum steepness (maximum amplitude of current derivative) that occurred at tms. In the next sections we will see that these figures represent the current and current derivative of Event #2, before the arrival of reflections (the initial injected current into the tower).

4.2 ANALYSIS OF DECAYING PART OF THE CURRENT WAVEFORM TO DETERMINE DECAY TIME CONSTANTS
Figure 4.3 shows the measured current of Event #2 in the time window of 60Âµs. The decaying part of the measured current (t >> 1) can be represented by a simple exponential function, in the case of single-term Heidler function simulation. In the other words, the single-term Heidler function of equation (4.1) is simplified to an exponential function when t >> 1:

i (t )  k I e



t

2

(4.3)

where k 1. Assuming magnitude of measured lightning current at arbitrary times of t1 and t2 in the decaying part are Im1 and Im2, respectively, equation (4.3) gives:

51

10
Imax

8
Current (kA)

6

4

2
tmc

0 0

1

2

3

4

5 Time (s)

6

7

8

9

10

Figure 4.1. Double-term Heidler function simulating the current of Event #2, before the arrival of reflections, (Figure 3.6).

40
(dio/dt)max=Idmax

Current Derivative(kA/s)

30

20

10

0
tms

-10 0

1

2

3

4

5 Time (s)

6

7

8

9

10

Figure 4.2. Double-term Heidler function simulating the current derivative of Event #2, before the arrival of reflections, (derivative of current function, Figure 4.1). 52

12
Measured

10 8 6 4 2 0 0

Curve fitting of decaying part

Current (kA)

7.34 kA 6.11 kA

10

20

30 Time (s)

40

50

60

Figure 4.3. Single-term Heidler function simulating the decaying part of the current obtained from measurement.

I m1  k I e



2
t2

t1

I m2  k I e



2

(4.4)

From (4.4), the decay time constant 2 is obtained as:

2 

t 2  t1 ln( I m1 / I m 2 )

(4.5)

Based on Figure 4.3, the values of current obtained from measurement are: Im1=7.34 kA at t1=30 Âµs and Im2=6.11 kA at t2=50 Âµs. Using (4.5) gives 2=109 Âµs. Alternatively the current decaying-part analysis for determining the decay time constant can be done by curve fitting of a single exponential function with the measured current at the decaying part. Curve fitting was performed using Curve Fitting Toolbox of Matlab in the time 53

range of 30Âµs-50Âµs. The decay time constant 2 is found to be 105 Âµs with R-Square value of 0.9235. The value of R2 represents the quality of fit. The obtained R2 is close to 1, indicating a good fit. Since sum of two Heidler functions is usually used in order to reproduce the current obtained from measurement, we are to apply decaying-part approach to simulate the decaying portion of the measured current with two exponential functions. The function that simulates the decaying part of the current is presented as:
 t  t

i (t )  I1e

 21

 I 2e

 22

(4.6)

The curve fitting of the decaying portion of current was done to compare the difference and sensitivity of the result with time range. Table 4.1 presents the curve fitting results for four different time ranges, Event #2. It can be seen that there are not major differences between results determined with different time ranges. However, we chose the decay time constants 21=105 Âµs and 22=120 Âµs which are obtained by curve fitting in the wide range of decaying part. Figure 4.4 shows the simulation result compared with the measured current at the decaying part [73]. For Event #1, these decay time constants have been determined ( 21=350 Âµs and 22=330 Âµs).

54

Table 4.1. Four different time windows and corresponding curve fitting results. Time Window 1 2 3 4 15-60 s 25-60 s 35-60 s 45-60 s 21 (s) 105 112 109 103 22 (s) 120 118 120 115 R2 0.9211 0.9228 0.9286 0.9321

12
Measured

10 8 6 4 2 0 0

Curve fitting of dacying part

Current (kA)

10

20

30 Time (s)

40

50

60

Figure 4.4. Double-term Heidler function simulating the decaying part of the current obtained from measurement, event #2 (21=105 Âµs and 22=120 Âµs).

55

4.3 SIMULATING THE MEASRED CURRENT DERIVATIVE SIGNAL BEFORE THE ARRIVAL OF REFLECTIONS
The derivative of Heidler function has been used to match the first impulse of the measured lightning return-stroke current derivative signal, before the arrival of reflections, using curve fitting method to find the other parameters. The derivative of the single-term and double-term Heidler functions, are respectively given by:
 n 1 dio (t ) nt n 1  tn  io (t )    I e 2  n n dt t n   1n   t  2 1  t   t

n 1 nt n 1      n n t    t   2 1  
t

(4.7)

  n dio (t ) n t n1 1  t n1 1 t n2  22  I1 e  21  1   1  I e  2 n n n n n n 1 1 2 1 1 2 dt t   11 t   12   t  21  11  t  

t

 n2 n 2 t n2 1 1    n2 n2   t  22  12  t

   

(4.8) The following constraints can be used for curve fitting to decrease the process time:

io (t mc )  I max
dio (t ) dt t t dio (t ) dt t t  I d max
ms

(4.9) (4.10)

0
mc

(4.11)

d 2 io (t ) dt 2
t tms

0

(4.12)

where Imax is the maximum current which occurs at tmc. Idmax is maximum steepness (maximum amplitude of the current derivative) that occurrs at tms. The second derivative of the single and double-term Heidler functions are respectively given by:

56

d 2 io (t ) dt 2

n n 1 2 n t n1 2n t n1 3n  1 2 1   io (t )  (  ) n ( n   ) 2 t  2 1  t n 1  t n t 2 2  t 

(4.13)

d 2 io (t ) dt 2

 I1

t n1 t n1   11 n1
 t



e

t  21

 n1 n1  1 2 n1 t n1 1 2 n1 t n1 1 3 n1  1 2 1  (  )  (   )    t  21  11 n1  t n1  11 n1  t n1 t  21  21 2   t

 I2

t n2 t n2   12 n2

e

 22

 n2 n2  1 n2 t n2 1 2n2 t n2 1 3n2  1 2 2 1  (  )  (   )    t  22  11 n2  t n2  11 n2  t n2 t  22  22 2   t 

(4.14) It is obvious that the second derivative is zero at tms, which is the time when the maximum steepness occurs, Equation (4.12). For the single-term Heidler function this equation applies on (4.13):
d 2 io (t ) dt 2
t tms

 n n 1 2 2n t ms n 1 n t ms n 1 3n  1 2 1   io (t ms )  (  ) (   )   0 (4.15) n n n n 2 t t  t    t   t  ms ms 2 ms 2  1 ms 1 ms 2  

Since io(tms) could not be zero; io(tms) 0 then:
 n n 1 2 n t ms n1 2n t ms n1 3n  1 2 1  (  )  (   )  0  n n n n t ms  2  22   t ms t ms  2  1  t ms  1  t ms 

(4.16)

Equation (4.16) can be formed as follows:
 2n t ms 2 t ms 2  n  2  ( 1  t ms n ) 2  2n 2 t ms 2n  n(3n  1)t ms n ( 1n  t ms n ) n(n  1)  2 2    
 2n t ms n1 ( 1n  t ms n )  0

2

  2n  t ms t ms 2t ms n 2  n 6n n n 1 n ( n  1 )  (  2 n )    n ( n  1 ) t  t    1 ms ms   1 2 2 2     2   2  



4n t ms 2n1

2



t ms 2n 2

 22

0

(4.17)

57

By solving the above quadratic equation, (4.17), 1 is obtained as below:
 1  t ms 
6n 2t ms
2 2   2t  t  t t t  6n  n(n  1)  t ms  ms  4 ms n(n  1)  ms ( ms  2n) 4n  ms  2  2 2  2 2 2  2      2

n(n  1) 
n

2

t ms 

 22

  t t 2 n(n  1)  ms ( ms  2n) 2 2  

(4.18)

Since the maximum steepness of the current occurs at the rising edge, equation (4.18) can be simplified by eliminating the decay parameter of the current, 2. Equation (4.19) shows the simplified solution after eliminating 2 ( 2   ).This approximate solution has been discussed in [75].

 1  t ms n

n 1 n 1

(4.19)

Equation (4.19) can be used as another constraint for curve fitting in the case of single-term Heidler function. For double-term Heidler function, finding a closed form equation for 1 was not possible but still (4.12) could be applied. For Event #1, the curve fitting was done in the range of 0 Â­ 0.67 s using Curve Fitting Toolbox in Matlab software. This range was chosen so that the used portion of the measured signal is free from reflections. Using constraints (4.9)-(4-15), help to reduce the number of variables for curve fitting which is a tedious task. The only constraint or condition that actually used was equation (4.12) that forces the maximum steepness to occur at the known tms. Table 4.2 presents the parameters of the single-term Heidler function for Event #1 and Event #2. The parameters of the double-term Heidler function are shown in Table 4.3.

58

Table 4.2. Parameters of single-term Heidler function obtained by curve fitting. I (kA) Event #1 Event #2 11.054 8.152 1 (s) 0.360 0.353 2 (s) 350 109 n 5.50 6.37 R2 0.9790 0.9815

Table 4.3. Parameters of double-term Heidler function obtained by curve fitting. I1(kA) Event #1 Event #2 2.825 1.161 11(s) 0.336 0.296 21(s) 350 105 n1 13.10 13.95 I2(kA) 6.901 6.900 12(s) 0.381 0.374 22(s) 330 120 n2 5.70 6.40 R2 0.9942 0.9950

Figure 4.5 shows the measured and simulated first impulse of the lightning return-stroke current derivative for Event #1. The results shown in this figure confirm that using the derivative of the double-term Heidler function provides the best fit. In the simulation of the initial impulse of the measured current derivative signal, it is important to produce accurate results since any errors introduced at this initial stage will result in more inaccuracies when structural discontinuities are taken into account in the simulation. The corresponding simulated current waveform (numerical integration of the simulated initial pulse) presents the initially injected current into the tower. It is shown in Figure 4.6 and compared with the measured current, obtained from measurement. Although the double-term Heidler function markedly succeeded in simulating the current waveform, before the arrival of reflections, it could be modified to better simulate the initial slow current rise before the wavefront substantial fast rise. The same process has been followed Event #2. The simulation of the initial current derivative impulse is applied in the range of 0 Â­ 0.52 s (Figure 4.7). The corresponding current waveform is also shown in Figure 4.8.

59

60
Measured

50
Current Derivative (kA/s)

Double-term Heidler function Single-term Heidler function

40 30 20 10 0

0-0.67 s

0.5 0.6 0.7 0.8 0.9 Time (s) Figure 4.5. Simulation of initial impulse, before arrival of reflections for Event #1.

-10 0

0.1

0.2

0.3

0.4

1

20

15
Current (kA)

10

5
Measured (Event #1) Simulated injected current

0 0

2

4

6

8

10 Time (s)

12

14

16

18

20

Figure 4.6. Simulated initial injected current using double-term Heidler function, compared with measurement, for Event #1.

60

40 35
Current Derivative (kA/s)
Measured Double-term Heidler function Single-term Heidler function

30 25 20 15 10 5 0 0 0.1 0.2
0-0.52 s

0.3 0.4 Time (s)

0.5

0.6

0.7

Figure 4.7. Simulation of initial impulse, before arrival of reflections for Event #2.

12 10 8 6 4 2 0 0

Current (kA)

Measured (Event #2) Simulated injected current

2

4

6

8

10 Time (s)

12

14

16

18

20

Figure 4.8. Simulated initial injected current using double-term Heidler function, compared with measurement, for Event #2. 61

In Chapter 5 we will use these simulated injected currents in order to determine the lightning current distributions along the lightning path. It is worth noting that simulation of the current derivative of the initial impulse is not an efficient method for determining the decay time constants (21 and 22). In fact, these two decay time constants don't affect significantly the initial impulse. For this reason, the decay constants are determined first by analyzing the decaying part of the current waveform. Then, other parameters are efficiently calculated by simulating the measured current derivative initial impulse, before the arrival of the reflections, using curve fitting technique. Combining these two steps increases the accuracy and speed of the process for determining the simulation function parameters. Figure 4.9 shows a comparison between the current waveform using the proposed method and that simulated in [71]. The current, obtained by measurement, is also shown in the figure. It can be seen that the simulated waveforms at the rising edge are similar, whereas the decaying part are simulated differently. The proposed method markedly succeeded in simulating the decaying in comparison with the previous work [71]. It is worth mentioning that there is a considerable difference between two approaches. 21 and 22 obtained by [71] are 1180 s and 21.96 s, respectively, whereas these decay time constants obtained by proposed method found to be 105 s and 120 s. The other Heidler function parameters in two approaches are found to be similar.

62

12 10 8 6 4 2 0 0
Measured Simulated Previous work [71]

Current (kA)

1

2

3

4

5 Time (s)

6

7

8

9

10

Figure 4.9. Comparison of simulated current by proposed method (21 = 105 s, 22 = 120 s) and previous work (21 = 1180 s, 22 = 21.96 s) [71] for Event # 2.

4.4 COMPUTATION OF SIMULATION FUNCTION PARAMETERS USING PARTICLE SWARM OPTIMIZATION TECHNIQUE
Particle swarm optimization (PSO) technique employs lightning return-stroke current derivative, measured at the CN Tower, to calculate the parameters of current simulation function as incident current. This approach is an alternative method to evaluate the simulation function parameters as well as reflection coefficients at major structural discontinuities. Particle swarm optimization as one of the modern heuristic algorithms has been found to be robust in solving nonlinear optimization problems. The PSO technique can generate a high-quality solution within shorter calculation time and stable convergence characteristic than other stochastic method [76].

63

PSO is a technique used to explore the search space of a given problem to find the settings or parameters required to optimize a particular objective. This technique optimizes a problem by iteratively trying to improve a candidate solution with regard to a given measure of quality. This method originates from two separate concepts: the idea of swarm intelligence based on the observation of swarming habits by certain kinds of animals (such as birds and fish), and the field of evolutionary computation [77].

4.4.1 THEORY The PSO algorithm works by simultaneously maintaining several candidate solutions in the search space. In each iteration of the algorithm, each candidate solution that can be thought of as a particle flies through the search space to find the maximum or minimum of the cost function (fitness value). Initially, the PSO algorithm chooses candidate solutions randomly within the search space. Each particle maintains its position, composed of the candidate solution and its evaluated cost function, and its velocity. Additionally, it remembers the best fitness value it has achieved thus far during the operation of the algorithm, referred to as the individual best fitness, and the candidate solution that achieved this fitness, referred to as the individual best position. Finally, the PSO algorithm maintains the best fitness value achieved among all particles in the swarm, called the global best fitness, and the candidate solution that achieved this fitness, called the global best position [78]- [82]. For a multidimensional problem, the velocity and position of each particle in the swarm are updated using the following equations:
v j , g (t  1)  .v j , g (t )  c1r1[ pbestj , g (t )  x j , g (t )]  c2 r2 [ gbestg (t )  x j , g (t )]

(4.20)

64

x j , g (t  1)  x j , g (t )  v j , g (t  1)

(4.21)

where j = 1, 2,...n and g = 1, 2,...m and n number of particles in the swarm (or population);

m dimension of problem; t current iteration number;

vj,g(t) velocity of particle j (dimension g) at iteration t;  xj,g(t) inertia weight factor; current position of particle j at iteration t; the individual best position of particle j until iteration t; the best particle in the swarm at iteration t.

pbest j,g(t) gbest g(t)

The parameters , c1, and c2 are user-supplied coefficients. The values r1 and r2 (0  r1  1 and 0  r2  1) are random values regenerated for each velocity update [80]-[83].

4.4.2 DEFINITION OF COST FUNCTION The proposed cost function in the PSO algorithm employs specific values of the measured and calculated lightning current and their derivatives. Figure 4.10 shows the return-stroke lightning current derivative signal, measured at the CN Tower by Rogowski coil located at 474 m above ground level. This figure also presents the corresponding current obtained by numerical integration. The current derivative ( I' ) and current ( I ) waveforms demonstrate the effects of discontinuities that happen at corresponding times. In this figure: I1m main impulse; I2m reflection from the top of Skypod (restaurant); I3m reflection from the bottom of Skypod (restaurant);

65

60 50
Current Derivative (kA/s)
I'1m

40 30 20 10 0 -10 -20 0 1 2
I'3m I'2m

I'4m

I'5m

I'6m

3

4

5 Time (s)

6

7

8

9

10

20
I2m I5m I1m

15
Current (kA)

10
I4m

5

I3m

0

0

1

2

3

4

5 Time (s)

6

7

8

9

10

Figure 4.10. Measured current derivative and current obtained by numerical integration used for defining PSO cost function.

66

I4m reflection from the ground; I5m reflection from the tip; and I6m reflection from the channel front. As for the current waveform, five distinguishable current values are denoted by Im1, Im2, Im3, Im4 and Im5. The subscript m indicates the measurement values. If we use subscript c for the corresponding calculated values, the cost function is defined as [76]:

Fmin    I 'im  I 'ic     I im  I ic 
i 1 i 1

6

5

(4.22)

where  and  are the weighting factors. The values of I'ic and Iic must be calculated in each iteration, and used in the cost function to minimize it.

4.4.3 IMPLEMENTATION OF PSO ALGORITHM TO COMPUTE LIGHTNING CURRENT SIMULATION FUNCTION PARAMETERS The purpose of PSO algorithm in this application is to estimate nine unknown parameters (five reflection coefficients described in Chapter 3 and four current parameters as I, 1, 2 and n for single-term Heidler function discussed earlier in current chapter). Figure 4.11 shows the flowchart of the searching procedure of the implemented PSO algorithm. Both PSO program and lightning current calculation program have been written by Matlab software. The program for lightning current calculation was developed based on the CN Tower three-section model using lattice diagram explained in Appendix A. Each program uses the outputs of other program as its inputs in a reciprocal relation in each iteration. The lightning current calculation code is a parametric program that takes into account all possible reflections along the tower as well as lightning channel and utilizes five reflections coefficients and four lightning current parameters estimated by PSO code. Applying the tight constraints of positions and velocities keeps each 67

Start

Initialize randomly the individuals of the population including searching points, velocities and pbests.

Run lightning current evaluation program and calculate the current at prescribed observation point.

Calculate Iic (i = 1,2 ,...,5) and I'ic (i = 1,2,...,6) and evaluate the cost function.

Select pbest and gbest.

Update particles velocities and positions.

No

Termination condition achieved?

Yes Stop

Figure 4.11. Flowchart of PSO process.

iteration results in the search space. For example we have applied the following constraints for the velocity in each iteration: If vj,g(t + 1) > vgmax, then vj,g(t + 1) = vgmax. If vj,g(t + 1) < vgmin, then vj,g(t + 1) = vgmin. The PSO parameters that are used by the algorithm for determining the lightning current specifications are shown in Table 4.4. Inertia weight factor is often set such that it is decreased linearly from its maximum to the minimum value as follows:

68

   max 

 max   min
itermax

 iter

(4.23)

where max = 0.9, min = 0.3, itermax = 700 is the maximum number of iterations in this simulation, and iter is the number of iteration. For these settings, the simulation results that show the best solution for lightning returnstroke current parameters and reflection coefficients are presented in Table 4.5 for Event #1 and Event #2. The return-stroke velocity was assumed 65 m/s, in order to simulate the major channel-front reflection at 6 s (from ground) accurately. The reason for this selection will be explained in Chapter 5. It took about 25 minutes on a 2 GHz personal computer with 3 GB RAM. The results are repeatable with unique answers. The convergence characteristic of the PSO approach is shown in Figure 4.11 for Event #2. As we can see in this figure, through about 360 steps, the PSO algorithm can prompt convergence and obtain good evaluation values. In lightning studies the injected current is usually represented by double-term Heidler function which includes eight parameters. Applying the proposed approach to estimate thirteen unknown parameters (five reflection coefficients and eight current parameters) makes it unstable with non-unique results in each execution. In order to overcome this problem we solved the problem in two steps. First with single-term Heidler function we determined the reflection coefficients as we discussed before, then with these constant reflection coefficients we calculated the eight parameters of double-term Heidler functions. This method presents the lightning current parameters as shown in Table 4.6. Figure 4.13 shows the simulated current derivative waveform for Event #2 using Matlab program and compares it with the measured signal. As it can be seen in this figure, the main characteristics of the measured current derivative are well reproduced by the simulation. 69

Table 4.4. PSO parameters used in simulation. PSO Parameters Values  0.5  0.5 n (Population size) 50 c1 2 c2 2

Table 4.5. Optimum values obtained by PSO algorithm. t Event #1 Event #2 -0.341 -0.348 g 0.451 0.492 12 0.213 0.201 23 ch I(kA) 11.158 8.342 1(s) 0.369 0.361 2(s) 335 111 n 5.60 6.49

-0.221 -0.263 -0.215 -0.249

40 35 30
Evaluation Value

25 20 15 10 5 0 0 100 200 300 400 Iterations 500 600 700

Figure 4.12. Convergence tendency of PSO algorithm for Event #2.

70

Table 4.6. Optimum values obtained by PSO algorithm for double-term Heidler function. I1(kA) Event #1 Event #2 2.905 1.171 11(s) 0.327 0.289 21(s) 330 110 n1 13.40 14.15 I2(kA) 6.851 6.950 12(s) 0.377 0.382 22(s) 330 122 n2 5.81 6.10

40
Measured Simulated

Current Derivative (kA/s)

30

20

10

0

-10 0

1

2

3

4

5 Time (s)

6

7

8

9

10

Figure 4.13. Measured and simulated current derivatives using PSO algorithm with the double-term Heidler function for Event #2.

71

4.5 CONCLUSIONS
This chapter presented a method for calculating the parameters of the CN Tower initially injected lightning current. In order to model the spatial-temporal distribution of the lightning returnstroke current along the CN Tower and the attached channel, the parameters of the current simulation function, representing the injected current, must be determined. First, by curve fitting the decaying part of the measured and simulated current, two decay constants of the double-term Heidler function (current simulation function) were determined. Having at hand these two constants, other parameters of the simulation function were obtained using curve fitting the simulated and measured current derivative waveforms, before the arrival of reflections. Accuracy and speed of curve fitting process depend on the number of unknown parameters. The curve fitting of the simulated and measured current derivative of the initial impulse is not an efficient method in determining the decay time constants (21 and 22). In fact, these two decay constants don't affect significantly the initial impulse. For this reason, the determination of the decay constants must be first determined by analyzing the decaying part of current waveform. Then, other parameters can be calculated by curve fitting the simulated current derivative to the measured current derivative before arrival of the reflections. Combining these two steps increases the accuracy and speeds up the process computation. The calculated simulation function is to be used in Chapter 5, as representing the initially injected current to the tower. An alternative method based on particle swarm optimization (PSO) technique was also introduced for calculating the simulation function parameters. In PSO algorithm both current and current derivative waveforms were used for defining an efficient cost function. The PSO algorithm prompted convergence quickly and obtained good evaluation values.

72

Chapter 5 5 ATP Modelling Tall-Structure Lightning Current ATP Modelling of of Tall-Structure Lightning Current
This chapter, based on the obtained locations of reflections and the reflection coefficients (Chapter 3), as well as the parameters of the double-term Heidler function (Chapter 4) that simulates the injected current derivative and current are presented. The current distribution along the urrent path (the tower and the attached channel) are to be determined [55], [62]. A review of the lightning research on tall towers, including the CN Tower, is presented in [84]. The lattice diagram is usually used to simulate the current along the lightning current path while the incident lightning current is injected at the attachment point, either at the tall-structure strike point or at the tip of an upward-connecting leader. Then, assuming a constant return-stroke velocity, most of current components that have considerable amplitude relative to the original injected current are identified. In previous work, taking into account all reflections has not been possible and it is usually assumed that all multiple reflections are included in the simulation unless peaks of reflected pulses are smaller than 1% of the initial injected current [84], [85]. On the other hand, since these neglected pulses are numerous, the total influences could be considerable. Full details of the lattice diagrams and related current calculations for three-section model of the tower are found in Appendix A. In this appendix, most reflections that have major effects have been considered. Instead of the tedious calculations using the lattice diagram, the current can be easily computed by transient software programs, such as ATP with some computational considerations.

73

This approach is based on the so-called distributed-source approach and uses modified transmission line with exponential decay (MTLE) to model the lightning channel [62]. ATP (Alternative Transients Program), a well-known powerful tool for the analysis of transients in power systems, has been used for evaluating overvoltages on transmission and distribution lines due to direct or nearby lightning strikes. In direct lightning strike studies, most researchers use a pre-defined function, such as Heidler function, to simulate the lightning current strike to a transmission line or a wind turbine. They then investigate the propagation of the lightning current wave through power system components [86]-[88]. For a nearby lightning strike, the electromagnetic coupling with the overhead line is computed and the overvoltages due to this coupling are evaluated [89], [90]. For the first time, ATP as a precise tool is being used in this work for return-stroke current modelling. A brief introduction to ATP is presented in Appendix B. It is shown that a constant return-stroke velocity would not satisfy the times of occurrence of major channel-front reflections. An estimated return-stroke velocity profile, using the threesection model of the tower, is determined and it demonstrates that the velocity decays with time. Furthermore, using the CN Tower five-section model, the proposed approach enables taking into account the existence of an upward-connecting leader. It calculates the length of the upwardconnecting leader, and estimates the return-stroke velocity variation with time. The results verify that the return-stroke velocity initially increases rapidly with time, reaching a peak, and then decreases less rapidly. The simulated current at different points along the current path will be used to compute the corresponding electric and magnetic fields in Chapter 6.

74

5.1 COMPUTATIANAL MODEL IN ATP
The overall structure of the CN Tower, as well as the locations of the Rogowski coil, placed at 474-m AGL, and the current recording system are shown in Figure 5.1. Since the length of partially-ionized leader is continuously decreasing and the length of fully-ionized channel is continuously increasing during the return-stroke phase, finding a circuit model which is applicable as a computational model is difficult. Figure 5.2 shows the equivalent circuit model of the tower as a three-section transmission line, the continuously growing channel and the continuously shrinking leader. In transient software package such as ATP, using switching techniques for simulating these variable lengths of transmission lines produces unwanted overvoltages. Neglecting channel-front reflections, Figure 5.3 shows a simplified ATP model representing the tower as three transmission line segments connected in series. In this figure, the reflections from the lightning channel front are neglected. In the figure, Z1, Z2, and Z3, respectively, represent the characteristic impedances of the three sections: from top of the Skypod to the tower's tip (length L1), between top and bottom of the Skypod (length L2), and between bottom of the Skypod and ground (length L3). Zch represents the characteristic impedance of the lightning channel. The full length of the lightning channel (Lch) is assumed to be 8 km and no reflections are assumed at its end. The simple model presented in Figure 5.3, is used throughout the thesis for simulating CN Tower three-section model and the ATP approach for modelling the return-stroke channel is proposed based on this circuit model. The incident current, which is injected at the attachment point, is determined by a point-bypoint user-defined current source (type-1 in ATP) using Heidler function. The incident current is chosen on the basis of coordination with the current recorded at the tower. This empiricallydefined current source, or any other current source that may be required in the simulation

75

Lightning Flash Trajectory (Leader, partially ionized)

Lightning Flash Trajectory (Channel, fully ionized) Tip of Tower (553m) Space Deck Top (456m) Rogowski Coil (474m) Space Deck Bottom (447m) Top of Skypod (365m) Bottom of Skypod (335m) Current Recording System (403m)

Ground Level

Figure 5.1. CN Tower and locations of instruments.

process, is generated at each time step of the simulation by Matlab. Employing ATPDraw, as a graphical preprocessor to ATP, provides predefined current sources and user can skip the stage of preparing the empirical function [91]. The constant-parameter transmission line model in ATP is used in this work. The length of the line, the characteristic impedance and the propagation velocity are required for this model [92].

76

Z

Zch

Z1

Z2

Z3

Z

Decreasing length of leader Increasing length of channel

L1

L2

L3

Zg Incident Current

Figure 5.2. Circuit model of CN Tower and the attached channel (channel and leader).

io ... ... Zch Z1 Z2 Z3

Lch

L1

L2

L3

Zch

Incident current

Zg Coil location

Figure 5.3. ATP simplified circuit model, neglecting channel-front reflections.

5.2 RETURN-STROKE CHANNEL MODEL
On the assumption of the absence of an upward-connecting leader, the channel that extends from the tower's tip to the return-stroke channel front is modeled as a transmission line (TL) with characteristic impedance Zch. The leader is modeled as a TL with characteristic impedance Z. Figure 5.4 presents the three-section model of the CN Tower and schematically shows reflections from the continuously moving channel front. Accordingly, the lightning incident current is correlated to the injected current as follows [70]:

iincident (t )  (1 

Z1 )io (t ) Z ch

(5.1)

77

z Zch . . .

hm
h3

. . .

i3 Zch i2

h2 h1

i1 v t io coil location 12 Z2 23 h Z1 io iincident

Z3

g

Zg

Figure 5.4. ATP model taking into account channel-front reflections.

where Z1 is the characteristic impedance of tower upper TL section and io(t) is the current initially injected into the tower. The rest of the incident current that propagates in the upward direction is (Z1/Zch)io(t). This upward-propagating current causes leader ionization and thus reduces its impedance to Zch. For modelling purpose, the continuously-expanding channel as well as the leader are simulated as a single transmission line with characteristic impedance Zch. However, at every

78

point at which a reflection is expected we inject a current source to take into consideration the channel-leader reflection (it is termed channel-front reflection throughout this thesis), as depicted in Figure 5.4. For example, in order to simulate channel reflections, the source currents i1, i2, i3, ... are injected at heights h1, h2, h3, ..., respectively. These source currents are determined for the three-section model as follows:

i1 (t )  2 12 (1   t )  ch io (t 
2

2 L1 ) cv
L1  L2 ) cv
2h ) cv

(5.2)

i2 (t )  2  23 (1  12 )(1   t )  ch io (t  2
2 2

(5.3)

i3 (t )  2  g (1  12 )(1   23 )(1   t )  ch io (t 

(5.4)

where h is the height of the tower, v is the speed of propagation of the channel front (the returnstroke velocity). The propagation within the channel and the tower is at the speed of light c. Every reflection from the continuously-propagating channel front is taken into account with this approach. The locations of the simulated current sources are given by:

...

h1  h  2 L1

v cv v cv

(5.5)

h2  h  2( L1  L2 ) h3  h  2h v cv

(5.6)

(5.7)

... 79

In the circuit model of Figure 5.4, at the connection of each lumped current source, one-half of the source current propagates downward, which simulates truly the channel-front reflection. The other half of the source current, which propagates in the upward direction, does not model the transmitted current correctly. For determination of the simulated electromagnetic field, it is essential to compute the actual transmitted current. For example, at location h1 one-half of the current i1 propagates downward as:
i1 2 L1  12 (1   t )  ch io (t  ) 2 cv

(5.8)

which simulates exactly the actual reflected current at this point. The other half of the current that propagates in the upward direction does not correctly simulate the actual transmitted current at this point. The actual transmitted current at location h1 is:
itrans1  12 (1   t )(1   ch )io (t  2 L1 ) cv

(5.9)

A compensation current at this location is determined by subtracting (5.9) from (5.8), which gives:
icomp trans1  12 (1   t )io (t  2 L1 i ) 1 cv 2  ch

(5.10)

This process is applied to each injected current. In order to correctly simulate the transmitted current at location hm along the channel, we add the total compensation current, icomp-trans, as follows (hm > hi):

icomp trans 

1 2  ch

 ii (t 
i

hm  hi ) v

(5.11)

80

Equations (5.1) to (5.11) have been derived based on the geometry shown in Figure 5.4. For each current source, the time delay at the specific instant is applied by a time delay switch in ATPDraw or using proper ATP empirical source in the corresponding card. Finally, in order to compute the channel current using MTLE model at each point along the channel hm, the calculated current is multiplied by exp[-(hm-h)/]. A value of 2000 m was assumed for the current decay constant  [55].

5.3 SIMULATION RESULTS USING CN TOWER THREE-SECTION MODEL (RETURN-STROKE VELOCITY VARIATION)
In addition to reflection coefficients and the parameters of the simulation function, the returnstroke velocity is required to simulate the full current derivative signal. It actually determines the expanding rate of the channel front, which significantly affects the locations of channel-front reflections. It is usually assumed a constant return-stroke velocity for tall-structure lightning modelling presented by different researchers [46], [72], [93], [94]. As a matter of fact returnstroke velocity is a function of height/time and changes with a specific profile [14], [66]. By analyzing the recorded lightning return-stroke current derivative of Event #1, shown in Figure 5.5, a distinguishable channel-front reflection is found to occur at 6.21 Âµs. This reflection can not be attributed to any of CN Tower structural discontinuities. The reflection is clearly due to the main ground reflection when it reflects back from channel front. Two other channel-front reflections, resulting from Skypod top and bottom, are visible in the figure, occurring at 3.07 Âµs and 3.45 Âµs, respectively. The analysis proved that a constant return-stroke velocity would not satisfy the time occurrence of the three above mentioned reflections. For example, assuming a constant return-stroke velocity of 87 m/Âµs, Figure 5.6 displays the measured and simulated

81

60 50
Current Derivative (kA/s)

40 30 20 10 0 -10 0 1 2

Channel Front Reflection (Skypod Bottom) Channel Front Reflection (Ground) Channel Front Reflection (Skypod Top)

3

4

5 Time (s)

6

7

8

9

10

Figure 5.5. Measured current derivative showing major reflections from channel front (Event #1). current derivative waveforms. In order to better identifying channel-front reflections, the case of neglecting channel-front reflections is also included in the figure. Figure 5.6 shows the simulated channel reflection due to Skypod bottom occurring at the expected time. However, the simulated channel-front reflection, originated from Skypod top, occurs earlier than the measured one. Also, the simulated channel-front reflection resulting from the major ground reflection displays a significant delay from the correspondingly measured reflection. This analysis shows that a constant return-stroke velocity can not satisfy the time of occurrence of all channel reflections, which necessitates a time-varying velocity. Detailed analysis of the times of occurrence of three channel-front reflections results in average velocities of 93 m/Âµs within the time range 0-3.07 Âµs, 38.5 m/Âµs within the range 3.07-3.45 Âµs, and 37.5 m/Âµs within the range 3.45-6.21 Âµs. The determined average velocities are summarized as follows [73]:

82

60
Measured

50 40
Current Derivative (kA/ s)

Simulated with v=87 m/s Simulated with no channel front reflection Measured and Simulated CF Reflection (Skypod Bottom)

30 20 10 0 -10
Simulated CF Reflection (Skypod Top) Measured CF Reflection (Skypod Top) Simualted CF Reflection (Ground) Measured CF Reflection (Ground)

-20 0

1

2

3

4

5 Time (s)

6

7

8

9

10

Figure 5.6. Measured and simulated current derivatives using the three-section model and a return-stroke velocity of 87 m/Âµs, as well as the simulated current derivative ignoring channel-front (CF) reflections, Event #1. 83

 v avg [0 - 3.07 Âµs]  93 m/Âµs   v avg [3.07 - 3.45 Âµs]  38.5 m/Âµs  v [3.45 - 6.21Âµs]  37.5 m/Âµs  avg

(5.12)

Equation (5.12) represents that lightning return-stroke velocity decrease with time (height). Taking into consideration the above-mentioned decreasing velocity profile, the simulated current derivative waveform is determined and shown in Figure 5.7. It can be seen that all classified channel reflections occurred at the expected time. Based on the velocity profile, given by (5.12), the lightning current at 800 m, 1000 m and 1500m above ground level are computed. Figure 5.8 shows these results by eliminating the time delay due to related heights.

60
Measured

Current Derivative (kA/s)

50 40 30 20 10 0 -10 0 1 2 3 4 5 Time (s) 6 7

Three-section model

8

9

10

Figure 5.7. Simulated current derivative (using the three-section model and the discrete velocity variation) compared with measurement.

84

10

8
Current (kA)

6

4

2

Current at 1500 m AGL Current at 1000 m AGL Current at 800 m AGL

0 0

1

2

3

4

5 Time (s)

6

7

8

9

10

Figure 5.8. Computed lightning current waveforms (800 m, 1000 m and 1500 m).

5.4 SIMULATION RESULTS USING CN TOWER FIVE-SECTION MODEL
In order to improve the simulation of the current derivative signal, the CN Tower is modeled as five TL sections. In this case, the Space Deck (SD), which is 9-m tall (Figure 5.1) is included. The effect of the inclusion of SD reflections on the current derivative waveform proved to be substantial, especially in the decay portion of the initial pulse, which is shown in Figure 5.9. Figure 5.10 shows the simulated current derivative at the measurement location (474 m AGL), for the five-section model using the return-stroke velocity variation described by (5.12), and compares it with simulated result obtained by the three-section model (Figure 5.7). It can be seen that the five-section model is capable of very closely simulating the waveshape of the current derivative signal observed by instrumentation at the tower. 85

5.5 DETERMINING THE LIGHTNING RETURN-STROKE VALOCITY VARIATION (FIVE-SECTION MODEL WITH EXISTENCE OF AN UPWARD-CONNECTING LEADER)
As shown clearly in Figure 5.9, there is an early zero crossing around 0.91 s in the recorded current derivative signal. It is characterized as an early reflection from channel front initiated from an upward-connecting leader attachment point, which reflects back from the tower tip. In Figure 5.11, the main reflections from channel front in the five-section model are illustrated using a lattice diagram, when the attachment point is assumed to be at a height ha above the tower's tip. In this case, the incident current is injected at the attachment point and is assumed to be equally divided into two current waves propagating in the downward and upward directions with average initial speed of v0.

60 50
Current Derivative (kA/ s)
Initial Peak Space Deck Top and Bottom

40 30 20 10 0 -10 -20 -30 0 1
Early zero crossing

CF (Attachement Point

CNT Top)

CF (Space Deck Top and Bottom) Ground Skypod Top Ground CNT Top Ground CNT Top

CF (Skypod Top and Bottom) CNT Top

Ground CF (Ground)

CNT Top

Ground

Skypod Bottom

2

3

4

5 Time (s)

6

7

8

9

10

Figure 5.9. CN Tower (CNT) and channel-front (CF) reflections.

86

60
Measured Five-section model

50

Three-section model

Current Derivative (kA/ s)

40

30

20

10

0

-10 0

1

2

3

4

5 Time (s)

6

7

8

9

10

Figure 5.10. Measured and simulated current derivative for five-section and three-section models taking into account the discrete return-stroke velocity variation. 87

The downward-propagating current partially reflects at the tower's tip and travels in the upward direction with the speed of light and later reflects at the channel front. This reflection represents the first channel-front reflection. In the diagram of Figure 5.11, hri and tri (i=1, 2, 3, 4, 5 and 6) are the heights and times of occurrence of channel-front reflections along the channel,

tr6 tr3 v2 v2 v1 ha ha v0 v0 c t1 Space Deck t2 t3 t4 t5 t6 h hc hST hSB c tr4 v4 v3 tr5 hr4 hr2 hr5 hr3 hr1 v5 hr6

tr2 tr1 t0

hRT Skypod hRB

Ground Level

Figure 5.11. Lattice diagram of return-stroke current multiple reflections along the tower and the channel, assuming the return-stroke channel is initiated at height ha above the tower's tip.

88

respectively. ti (i=1, 2, 3, 4, 5 and 6) are the times of occurrence of channel-front reflections recorded by the coil and hc is height of the coil location from ground. Also, hST, hSB, hRT, and hRB are the locations of Space-Deck top, Space-Deck bottom, Skypod (Restaurant) top and Skypod (Restaurant) bottom, respectively. It is assumed that the average initial return-stroke velocity within t0=ha/v0 in both directions (upward and downward) is v0. Then, the return-stroke velocity within the range t0 - tr1 is v1, within the range t1 - tr3 is v2, within the range tr3 - tr4 is v3, within the range tr3 - tr4 is v4, and within the range tr4 - tr5 is v5. We assume that the average velocity within the small time range of tr2 - tr3, which corresponds to the current waves reflected back from Space-Deck top and bottom (a 9-m distance), remains constant as v2. By analyzing the lattice diagram, the expressions for ha, the heights and the times of occurrence of channel-front reflections are developed. It is worth to mention that the time reference for measured signals is obviously the coil position but in the reflections tracing and calculation based on Figure 5.11, the tower's tip is assumed to be the time reference. The time difference between these two references is (h-hc)/c which will be considered in final calculations.

5.5.1 FIRST CHANNEL-FRONT REFLECTION Figure 5.12 shows the first channel-front reflection detected by Rogowski coil which is initiated from attachment point at height ha above tower's tip. First reflection at channel front occurs at time tr1 (started from attachment point) and height hr1. This time can be found by tracing the original upward and downward propagated current as follow:

Upward-propagating current:

t r1 

ha hr1  2ha  h  v0 v1

(5.13)

89

Downward-propagating current reflected at tower's tip: By equating these two expressions, hr1 is obtained as:

t r1 

ha hr1  h  v0 c

(5.14)

hr1  h  2ha

c c  v1

(5.15)

The equation for t1 is developed by tracing the downward-propagating current reflected from tower's tip and then reflected back from channel front:

t1  2

(hr1  h) h  hc  c c

(5.16)

Substituting (5.15) into (5.16) gives:

t1  4

ha h  hc  c  v1 c

(5.17)

From (5.17), ha is derived as:

ha  (t1 

h  hc c  v1 ) c 4

(5.18)

tr1 t0 v1 ha ha v0 v0 c hr1 c h t1 Space Deck hc

Figure 5.12. Lattice diagram showing the first channel-front reflection, assuming the return- stroke channel is initiated at height ha above the tower's tip. 90

5.5.2 CHANNEL-FRONT REFLECTION ORIGINATED FROM THE TOP OF SPACE DECK As shown in Figure 5.11, the downward-propagating current enters into the tower, reflects back at the top of Space Deck and propagates towards channel with the speed of light. When this upward current wave reaches the return-stroke wavefront, second main channel-front reflection occurs at time tr2 and height hr2. Following equations are developed from Figure 5.11:

tr 2 

ha h  hST h h  2( )  r2 v0 c c

(5.19)

hr 2  hr1  v2 (t r 2  t r1 )
Equation (5.20) gives hr2 by using (5.14), (5.15) and (5.19) for tr1, hr1 and tr2, respectively:

(5.20)

hr 2  hr1  2( h  hST )

v2 c  v2

(5.21)

hr 2  2( h  hST )

v2 c  2ha h c  v2 c  v1

(5.22)

t2 is also expressed as follows:

t 2  2(

h  hST c  v 2 h h  hc )( )4 a  c c  v2 c  v1 c

(5.23)

5.5.3 CHANNEL-FRONT REFLECTION ORIGINATED FROM THE BOTTOM OF SPACE DECK Third main channel-front reflection occurs at time tr3 and height hr3. Following equations are developed from Figure 5.11:

tr3 

ha h  hSB h h  2( )  r3 v0 c c

(5.24)

91

hr 3  hr 2  v2 (t r 3  t r 2 )
Substituting (5.19), (5.22) and (5.24) into (5.25) gives:

(5.25)

hr 3  hr 2  2( hSB  hST )

v2 c  v2

(5.26)

hr 3  2(hSB  hST )

v2 v c  2(h  hST ) 2  2ha h c  v2 c  v2 c  v1

(5.27)

t3 is also expressed as follows:

t 3  2(

h  hSB c  v 2 h h  hc )( )4 a  c c  v2 c  v1 c

(5.28)

Combining (5.17), (5.23) and (5.28) after a few manipulating yields the equation for v0, v1 and v2:

v0  4

ha c(c  v1 ) ct1  2(hr1  h) c  v 1

(5.29)

v1 

c (t 3  t 2  t1 )  2( hST  hSB ) c . c (t 3  t 2  t1 )  2( hST  hSB ) 2

(5.30)

v2 

c(t 3  t1 )  2(h  hSB ) c c(t 3  t1 )  2( h  hSB )

(5.31)

5.5.4 CHANNEL-FRONT REFLECTION ORIGINATED FROM THE TOP OF SKYPOD As shown in Figure 5.11, the fourth main channel-front reflection occurs at time tr4 and height hr4. Following equations are developed for corresponding time of occurrence of channel-front reflection and average return-stroke velocity:

tr 4 

ha h  hRT h h  2( )  r4 v0 c c

(5.32)

92

hr 4  hr 3  v3 (t r 4  t r 3 )
Substituting (5.24), (5.27) and (5.32) into (5.33) gives:

(5.33)

hr 4  hr 3  2(hSB  hRT )

v3 c  v3

(5.34)

hr 4  2( hSB  hRT )

v3 v c  2( h  hSB ) 2  2ha h c  v3 c  v2 c  v1

(5.35)

t4 is also expressed as follows:

t 4  2(

hSB  hRT c  v3 h  hSB c  v2 h h  hc )( )  2( )( )4 a  c c  v3 c c  v2 c  v1 c

(5.36)

Using (5.28) into (5.36) gives v3 as follows:

v3 

c(t 4  t 3 )  2( hSB  hRT ) c c(t 4  t 3 )  2( hSB  hRT )

(5.37)

5.5.5 CHANNEL-FRONT REFLECTION ORIGINATED FROM THE BOTTOM OF SKYPOD The fifth main channel-front reflection occurs at time tr5 and height hr5. By tracing the reflected current at Skypod bottom, following equations are obtained for corresponding time of occurrence of channel-front reflection and average return-stroke velocity:

tr5 

ha h h h  hRB  2( )  r5 v0 c c

(5.38)

hr 5  hr 4  v4 (t r 5  t r 4 )
Substituting (5.32), (5.35) and (5.38) into (5.39) gives:

(5.39)

93

hr 5  hr 4  2( hRT  hRB )

v4 c  v4

(5.40)

hr 5  2( hRT  hRB )

v v4 v c  2( hSB  hRT ) 3  2( h  hSB ) 2  2ha h c  v4 c  v3 c  v2 c  v1

(5.41)

t5 is also expressed as follows:

t 5  2(

h  hRT c  v3 h  hSB c  v 2 hRT  hRB c  v 4 )( )  2( SB )( )  2( )( ) c c  v4 c c  v3 c c  v2
4 ha h  hc  c  v1 c

(5.42)

Using (5.36) into (5.42) gives v4 as follows:

v4 

c (t 5  t 4 )  2( hRT  hRB ) c c (t 5  t 4 )  2( hRT  hRB )

(5.43)

5.5.6 CHANNEL-FRONT REFLECTION ORIGINATED FROM GROUND The sixth reflection from channel is the most distinguishable channel-front reflection in the measured current derivative signal which is originated from ground. As shown in Figure 5.11, it occurs at time tr6 and height hr6:

tr6 

ha h h h  2  r6 v0 c c

(5.44)

hr 6  hr 5  v5 (t r 6  t r 5 )
Substituting (5.38), (5.41) and (5.44) into (5.45) gives:

(5.45)

94

hr 6  hr 5  2hRB

v5 c  v5

(5.46)

hr 6  2hRB

v5 v v v  2( hRT  hRB ) 4  2( hSB  hRT ) 3  2(h  hSB ) 2 c  v5 c  v4 c  v3 c  v2
 2 ha c h c  v1

(5.47)

t6 is developed as follows:

t 6  2(

h  hRT c  v3 h  hSB c  v 2 hRB c  v5 h  hRB c  v 4 )( )  2( RT )( )  2( SB )( )  2( )( ) c c  v5 c c  v4 c c  v3 c c  v2
4 ha h  hc  c  v1 c
(5.48)

Using (5.42) into (5.48) gives v5 as follows:

v5 

c (t 6  t 5 )  2hRB c c(t 6  t 5 )  2hRB

(5.49)

Tables 5.1 to 5.3 summarize the equations for heights and times of occurrence of channel-front reflections along the channel as well as the average return-stroke velocity, respectively. The values of ti (i=1, 2, 3, 4, 5 and 6), the times of occurrence of channel-front reflections, extracted from the recorded current derivatives of Event #1 and Event #2 are shown in Table 5.4. Using the recorded current derivative signals of Event #1 and Event #2, the length of the upward-connecting leader ha is determined to be 13.75 m and 15.25 m, respectively. Tables 5.5 and 5.6 show the calculated heights of channel-front reflections as well as average return-stroke velocities within the defined time intervals, respectively. The calculated times of occurrence of channel-front reflections along the channel are presented in Table 5.7.

95

Table 5.1. Determination of upward-connecting leader length and locations of channel-front reflections.

ha  (t1 

h  hc c  v1 ) c 4
c c  v1
v2 c  2ha h c  v2 c  v1 v2 v c  2(h  hST ) 2  2ha h c  v2 c  v2 c  v1
v3 v c  2( h  hSB ) 2  2ha h c  v3 c  v2 c  v1 v v4 v c  2( hSB  hRT ) 3  2( h  hSB ) 2  2ha h c  v4 c  v3 c  v2 c  v1

hr1  h  2ha

hr 2  2( h  hST )

hr 3  2(hSB  hST )
hr 4  2( hSB  hRT ) hr 5  2( hRT  hRB )

hr 6  2hRB

v5 v v v  2( hRT  hRB ) 4  2( hSB  hRT ) 3  2(h  hSB ) 2 c  v5 c  v4 c  v3 c  v2
 2 ha c h c  v1

Figure 5.13 displays the return-stroke velocity as a function of time for Events #1 and #2. For each event, this figure shows six velocities at six time points, which are assumed to be located at mid-points of the defined time intervals, Table 5.7. The velocity profile shows that the returnstroke velocity initially increases quite rapidly, with time reaching a peak, and then decreases at a lower rate. It was found that a single-term Heidler function, (5.50), describes the velocity variation very nicely. The parameters of Heidler function that represents the best fit of the six data points are presented in Table 5.8 for both events. It can be seen that the fits produced high R-Square.

96

Table 5.2. Times of occurrence of channelfront reflections along the channel.

Table 5.3. Average return-stroke velocities.
ha c(c  v1 ) ct1  2(hr1  h) c  v
1

t r1 

ha hr1  h  v0 c
ha h  hST h h  2( )  r2 v0 c c

v0  4

tr 2 

v1 

c (t 3  t 2  t1 )  2( hST  hSB ) c . c (t 3  t 2  t1 )  2( hST  hSB ) 2

tr3 

ha h  hSB h h  2( )  r3 v0 c c
ha h  hRT h h  2( )  r4 v0 c c

v2 

c(t 3  t1 )  2(h  hSB ) c c(t 3  t1 )  2( h  hSB )
c(t 4  t 3 )  2( hSB  hRT ) c c(t 4  t 3 )  2( hSB  hRT ) c (t 5  t 4 )  2( hRT  hRB ) c c (t 5  t 4 )  2( hRT  hRB )

tr 4 

v3 

tr5 

ha h h h  hRB  2( )  r5 v0 c c
ha h h h  2  r6 v0 c c

v4 

tr6 

v5 

c (t 6  t 5 )  2hRB c c(t 6  t 5 )  2hRB

Table 5.4. Times of occurrence of channel-front reflections at the coil position (in s). t1 Event #1 Event #2 0.58 0.56 t2 2.28 2.07 t3 2.37 2.16 t4 2.78 2.57 t5 3.38 3.48 t6 5.98 5.75

Table 5.5. Length of the upward-connecting leader and locations of channel-front reflections (in m). ha Event #1 Event #2 13.75 15.25 hr1 610.75 613.75 hr2 774.75 764.25 hr3 788.87 781.65 hr4 861.87 842.65 hr5 893.87 872.65 hr6 1044.95 1022.00

97

Table 5.6. Average return-stroke velocities (in m/s). v0 Event #1 Event #2 82.05 66.15 v1 125.34 117.86 v2 131.90 119.60 v3 95.22 92.93 v4 81.36 73.52 v5 56.10 47.29

Table 5.7. Times of occurrence of channel-front reflections (in s). t0 Event #1 Event #2 0.17 0.18 tr1 0.33 0.34 tr2 1.67 1.50 tr3 2.44 1.90 tr4 2.84 2.11 tr5 2.84 3.05 tr6 5.53 5.01

140
Event #1

120 100
Velocity (m/s)

Event #2

c)

80 60 40 20 0 0 0.5 1 1.5 2 2.5 Time (s) 3 3.5 4 4.5 5

Figure 5.13. Computed return-stroke velocity variation for different events.
t

( v (t )  V

1

)n t e )
n



t

2

(5.50)

1 (

1

98

Table 5.8. Heidler function parameters representing the best fit for estimated return-stroke velocities. V (m/s) Event #1 Event #2 186.1 199.6 1 (s) 0.125 0.157 2 (s) 3.416 2.710 n 1.180 1.326 R-Square 0.995 0.993

Figure 5.14 shows the simulated current derivative for Event #1 using the return-stroke velocity profile of Figure 5.13, and with the presence of a 13.75 m long upward-connecting leader. It can be seen that the early zero-crossing in the current derivative waveform, which corresponds to the first reflection from channel front, as well as subsequent channel reflections are simulated properly at the expected times. Figure 5.15 represents the corresponding lightning current obtained by numerical integration of Figure 5.14. The simulation results for Event #2 are presented in Figures 5.16 and 5.17. These results are obtained based on the presence of a 15.25-m-long upward-connecting leader. The early zerocrossing in the current derivative waveform of Event #2, is also simulated properly at the expected times. Figures 5.18 and 5.19 compare the simulated current derivative and their corresponding current waveforms of Event #1 with those recorded at the tower, for three-section and fivesection models. Definitely, representing the CN Tower as five-section TLs and taking into consideration the varying return-stroke velocity and the estimated length of the upwardconnecting leader produced a simulation that is quite close to the measured current derivative signal.

99

60
Measured

50
Current Derivative (kA/s)

Five-section model Event #1

40 30 20 10 0 -10 0 1 2 3 4 5 Time (s) 6 7 8 9 10

Figure 5.14. Measured and simulated current derivative waveforms using the five-section model, taking into account the 13.75 m-long upward-connecting leader (Event #1).

20

15
Current (kA)

10

5
Event #1 Measured Five-section model

0 0

1

2

3

4

5 Time (s)

6

7

8

9

10

Figure 5.15. Measured and simulated lightning current waveforms using the five-section model, taking into account the 13.75 m-long upward-connecting leader (Event #1).

100

40
Measured Simulated

Current Derivative (kA/s)

30

Event #2

20

10

0

-10 0

1

2

3

4

5 Time (s)

6

7

8

9

10

Figure 5.16. Measured and simulated current derivative waveforms using the five-section model, taking into account the 15.25 m-long upward-connecting leader (Event #2).

12 10 8 6 4 2 0 0
Event #2 Measured Simulated

Current (kA)

1

2

3

4

5 Time (s)

6

7

8

9

10

Figure 5.17. Measured and simulated lightning current waveforms using the five-section model, taking into account the 15.25 m-long upward-connecting leader (Event #2).

101

60
Measured Three-section model Five-section model

50

Current Derivative (kA/ s)

40

30

20

10

0

-10 0

1

2

3

4

5 Time (s)

6

7

8

9

10

Figure 5.18. Measured and simulated lightning current derivative for the three-section and five-section models, Event #1.

102

20

15
Current (kA)

10

5
Measured Three-section model Five-section model

0 0

1

2

3

4

5 Time (s)

6

7

8

9

10

Figure 5.19. Measured and simulated lightning current for the three-section and five-section models, Event #1.

5.6 CONCLUSIONS
It was shown that a constant return-stroke velocity would not satisfy the time occurrence of all channel-front reflections. An estimated return-stroke velocity profile, using the three-section model of the tower, was determined and it demonstrated that the velocity decays with height. Furthermore, using CN Tower five-section model, the proposed approach enabled taking into account the upward-connecting leader. It calculated the length of the upward-connecting leader, and computed the return-stroke velocity variations along the channel with more details. The results verified that the return-stroke velocity initially increases rapidly with time, reaching a peak, and then decreases less rapidly.

103

The lightning current-derivative simulation produced very successfully the fine structure of the measured current derivative signal. Also, the lightning current simulation succeeded in replicating the current obtained by numerical integration of the recoded current derivative signal. The results reveal that ATP is an appropriate tool for such applications. Simulation results also demonstrated the necessity of applying the five-section model to replicate the early zero crossing that proved to be a result of the existence of an upward-connecting leader.

104

Chapter 6 Computation of Lightning Electric and Magnetic 6 Computation of Lightning Electric and Magnetic Fields Fields
In the work presented in this thesis, the ATP lightning return-stroke model was developed. The simulated current and current derivative waveforms were compared with the return-stroke current and current derivative signals measured at the tower. The quantitative evaluation of a lightning return-stroke current model is usually accomplished by comparing the simulated lightning-generated fields, using a particular return-stroke model, with the measured fields. The azimuthal component of the magnetic field (H) and the vertical component of the electric field (Ez) that correspond to Events #1 and #2 are presented in this thesis. They were measured 2 km north of the CN Tower using broadband active sensors [5]. In this chapter, the electric and magnetic fields associated Events #1 and #2 are computed. The electric and magnetic fields resulting from a vertical antenna, representing the tower and the attached lightning channel, are obtained using Maxwell's equations. When compared with measurements, the simulated fields markedly succeed in replicating important details, including the initial split peak when the field was fully recorded. This experimentally-based verification points out clearly to the validity of the proposed return-stroke model. The initial split peak of simulated electric field is found to be relatively lower than the measured one, possibly due to the enhancement effect of a 40-m tall building on which the field sensors were placed.

105

6.1 DEVELOPMENT OF EXPRESSIONS FOR ELECTRIC AND MAGNETIC FIELDS AT A DISTANCE
The time-domain expressions for the electric and magnetic fields, at a general point on the ground, due to a vertical antenna (lightning current path) placed above perfectly conducting ground in free space are derived. The geometry of the problem is shown in Figure 6.1, where P(,,z) is the point of observation that is located at ground level, R is the distance between the point of observation and the location of the differential current element, and  is the horizontal distance from the point of observation to the lightning current path, dz' is the length of the differential current element located at z', which has a current i(z',t). The total height of the current path (tower and channel) is assumed to be H. Since a prefect ground is assumed to satisfy the boundary conditions, an image of lightning current path is added below the perfectly conducting ground [95], [96]. Maxwell's equations for time varying fields in free space are given by (6.1)-(6.4) [97]:
B  E   t
 

(6.1)


D  H  J  t
  D  v




 i

(6.2)

(6.3) (6.4)

 B  0







Where E is the electric field intensity [V/m] and H is the magnetic field intensity [A/m].

106

z z' dz'

h

i(z,t) R

P(, , z)
Perfect Ground

Image

Figure 6.1. The geometry used for calculating the electric and magnetic fields.



D


Electric flux density [C/m2] Magnetic flux density [Wb/m2] Impressed Current density [A/m2]

B

J

 i

107

v
 
D  o E
 

Charge density [C/m3] The curl operator [1/m] The divergence operator [1/m]

Constitutive relations in free space
B  o H
 

o
o


Permittivity constant of free space Permeability constant of free space


Magnetic flux density B can be expressed in terms of the vector potential A as follows:
B   A
 

(6.5)

Substituting the constitutive relations into (6.2) leads:
E   B   o J   o o t
  i 

(6.6)

Using (6.5), equation (6.1) can be expressed as follows:
 (  A)  E   t
 

(6.7)

    A   E  0  t   

(6.8)

A E  V t




(6.9)

V is the scalar potential. Combining (6.5) and (6.6) gives:

108

E     A   o J   o o t




 i



(6.10)
  

Replacing E using (6.9) and utilizing the vector identity     A   (  A)   2 A give:
  A V   2 A  o o    o J i     A   o  o  t t  
  

(6.11)

In (6.11), the term inside the square brackets is assumed to be zero, Lorentz's condition ([97], [98]), which results in the following simplified expression:
A  2 A  o  o  o J i t
  

(6.12)


The solution to (6.12) for a differential current element idL  is given by:


d A

 o [i ] dL 
4 r  r 
 



(6.13)

Based on the geometry shown in Figure 6.1 the parameters of (6.13) are as follow:


^ r  a

^z r   z a



^z dL   dz a
R  r  r    2  z2
 



The differential retarded vector potential and the magnetic field are given by:
d A


o R ^z i ( z , t  )dz  a 4R c

(6.14)

109

dH 



1

o

d A 



 dz   1 i i R  ^  2 a  4  R  R   

(6.15)

where c is the speed of light. The following relationships are used to simplify the magnetic fields expression:
R 2   2  z  2 then
R    R

(6.16)

i i R  i    R  R R

(6.17)

i  R

i R  (t  ) c

 (t 

R ) c  1 R c

i R  (t  ) c



1 i c t

(6.18)

Substituting these relations into (6.15), and considering the contribution of the image of the lightning path gives a new equation for the differential of magnetic field in the azimuthal direction by:
R   i ( z , t  )   dz    R  c a dH   3 i ( z , t  )   ^ 2 2  R c cR t   


(6.19)

The total azimuthal magnetic field at the point of observation P is obtained by integrating (6.19) along lightning current path (H):
R  , t  )   i ( z  dz   R  c a H   3 i ( z , t  )   ^ 2  R c cR 2 t 0   
 H

(6.20)

The first term of the magnetic field is called the "induction term" whereas the second term is called "radiation term."

110

The vertical electric field can be obtained from:
 dE   d H  o t
 

 0


(6.21)

 dE ^z   o ^z (  d H )  a a t


(6.22)

Taking the curl of the differential magnetic field in the az direction results in the following expression for the electric field:

R   ) 2 2 t 2 2 2 i ( z , t   dz  2 z    R 2z   R  c ^z E i ( z ,  )d  i ( z , t  )  2 3  a  2 o  R 5 c c t cR 4 c R R 0  c  
 H

(6.23)

The first term in (6.23), which is proportional to the time integral of the current, is the "electrostatic term," the second term is called the "induction term," while the third term is the "radiation term." In the far field, when the distance to the tower is much larger than the height of the current path, the radiation terms of the magnetic and electric fields are dominant. In the far-field zone, the equations (6.20) and (6.23) reduce to:



H

far  field

R   i ( z , t  )  dz    c a   2  ^ 2  cR  t 0    
H

(6.24)



E far  field

R   i ( z , t  )  dz    2 c a   2 3  ^z 2   t c R o  0   
H

(6.25)

111

6.2 SIMULATION OF ELECTRIC AND MAGNETIC FIELDS
It is not possible to use ATP to directly compute the electric and magnetic fields based on the geometry of Figure 6.1. In order to calculate the fields, all simulated current data along the lightning current path, obtained by ATP, are transferred into the Matlab software and then the electric and magnetic fields are calculated using (6.20) and (6.23), respectively. ATP computes the lightning current at each simulation time step and at different heights (with pre-defined segments) along the current path, which extends from ground to the cloud. The accuracy of simulation results depend on the size of the pre-define segment. Field computations with smaller segments produce more accurate results that are closer to measured fields. The simulation time step is selected to be 10 ns in order to match the 10 ns resolution of the measured current derivative and field signals via Tektronix 710A recording digitizers. For an 8 km lightning current path with 1-m segments and 40s simulation time, the current data would be an 8000Ã4000 matrix. This volume of data increases the time of simulation for the electric and magnetic fields. For example, it typically takes about 7 hours on a 2 GHz personal computer with 3 GB RAM. Since the lightning current flowing in a tall structure is responsible for a major portion of the electromagnetic field, especially at shorter distances, it exerts a profound influence upon the magnitudes and waveshapes of the electric and magnetic fields [55], [99]. For this reason, instead of assuming an 8-km channel length, a 2.5-km channel length with 0.5-m segment size was used for the simulation, which decreased the computation time to 3 hours. The computed magnetic fields for Event #1 and Event #2 are compared with those measured, as shown in Figures 6.2 and 6.3, respectively. The initial peak of the measured magnetic field for Event #1 exceeded the recording digitizer set limit. It can be seen from Figure 6.3 that the initial

112

2
Magnetic Field (A/m), Event #1
Measured Simulated

1.5

1

0.5

0

-0.5

0

5

10

15

20 Time (s)

25

30

35

40

Figure 6.2. Measured and simulated magnetic fields, 2 km north of the tower, Event #1.

1.5
Measured

Magnetic Field (A/m), Event #2

Simulated

1

0.5

0

-0.5

0

5

10

15

20 Time (s)

25

30

35

40

Figure 6.3. Measured and simulated magnetic fields, 2 km north of the tower, Event #2.

113

split peak in the measured magnetic field is reproduced in the computed field. This split peak is due to the upward-connecting leader that results in the first reflection from channel front. The peak of the simulated magnetic field was found to be about 85% of the measured one. Figures 6.4 and 6.5 present the two magnetic field signals within a 10Âµs time windows in order to show the simulation details, which replicate important changes in the measured fields. The simulated magnetic fields produce very successfully the general structure of the measured fields. Figures 6.6 and 6.7 show comparisons between simulated and measured electric fields for Events #1 and #2, respectively. Figures 6.8 and 6.9 present the electric fields within 10Âµs time windows in order to show field signal details properly. It can be seen from Figures 6.4, 6.5, 6.8 and 6.9 that ATP computed results, using the MTLE model, are in reasonable agreement with experimental observations. The initial split peaks, as well as other important changes, in the measured fields are well reproduced by the model. However, the simulated electric field peaks are found to be about 75% of the measured ones. The building's enhancement effects are assumed to be responsible for this discrepancy [100]-[103]. Measured electric-fields are influenced by enhancement effects of the buildings on which electric field sensors are located. It is worth mentioning that the CN Tower electric field sensor was placed on the roof of a 40-m tall building during 1989-2000. Electric and magnetic field sensors are often placed on the top of buildings. Steel beams and other metallic structures are expected to cause field enhancements. Rubinstein et al. [101] used simultaneous measurements of lightning electric fields at the top of a 17-floor building and at ground level. They observed an enhancement factor of about 1.5 for the electric field measured at the top of the building in comparison with the field measured at the ground level. BonyadiRam et al. [102] presented a computational model in which the building is represented by a

114

1.6
Magnetic Field (A/m), Event #1

1.4 1.2 1 0.8 0.6 0.4 0.2 0 -1 0 1 2 3 4 5 Time (s) 6 7 8

Measured Simulated

9

10

Figure 6.4. Measured and simulated magnetic fields for Event #1 (10s time window).

1.5
Magnetic Field (A/m), Event #2
Measured Simulated

1

0.5

0

-0.5 -1

0

1

2

3

4 5 Time (s)

6

7

8

9

10

Figure 6.5. Measured and simulated magnetic fields for Event #2 (10s time window). 115

800 700
Electric Field (V/m), Event #1
Measured Simulated

600 500 400 300 200 100 0 -100 0 5 10 15 20 Time (s) 25 30 35 40

Figure 6.6. Measured and simulated electric fields, 2 km north of the tower, Event #1.

600
Electric Field (V/m), Event #2

500 400 300 200 100 0 -100 0 5 10 15 20 Time (s) 25 30

Measured Simulated

35

40

Figure 6.7. Measured and simulated electric fields, 2 km north of the tower, Event #2.

116

800 700
Electric Field (V/m), Event #1
Measured Simulated

600 500 400 300 200 100 0 -100 -1 0 1 2 3 4 5 Time (s) 6 7 8 9 10

Figure 6.8. Measured and simulated electric fields for Event #1 (10s time window).

600
Electric Field (V/m), Event #2

500 400 300 200 100 0 -100 -1 0 1 2 3 4 5 Time (s) 6 7 8

Measured Simulated

9

10

Figure 6.9. Measured and simulated electric fields for Event #2 (10s time window).

117

metallic wire-grid. They suggested an enhancement factor for the electric field of about 2.3 for a 10-m high building. Mosaddeghi et al. [103] presented measured electric and magnetic field waveforms from distant natural lightning recorded on the roof of a 9-m building and at the ground level. Their results suggested that the measured electric field on the roof of the building can be enhanced by a factor of 1.7 to 1.9. The measured magnetic field, however, showed minimal differences. Figure 6.10 presents the same measured and simulated magnetic fields for Event #2 (Figure 6.3) within a 14 s time window in order to compare it with previous work [71] utilizing the current derivative signal of Event #2. The previously simulated magnetic field is based on the multi-reflection lattice diagram and the three-section model of the tower. Although the previous simulation of the same event assumes a two step return-stroke velocity profile (96 m/s and 60 m/s), the comparison is clearly shows the merits of the more superior field simulation developed in this thesis.

1.4
Magnetic Field (A/m), Event #2

Measured Simulated Previous work [71]

1.2 1 0.8 0.6 0.4 0.2 0 -0.2 0 2 4 6 Time (s) 8 10

12

14

Figure 6.10. Measured and simulated magnetic fields, 2 km north of the tower, for Event #2 (Figure 6.5), compared with previous work [71]. 118

6.3 CONCLUSIONS
Quantitative evaluation of lightning return-stroke models are usually accomplished by comparing the simulated lightning-generated fields with the measured ones. The electric and magnetic fields resulting from a vertical antenna, representing the tower and the attached lightning channel, were obtained using Maxwell's equations. When compared with measurements, the simulated electromagnetic fields markedly succeeded in replicating important details, including the initial split peak when the field was fully recorded. This experimentally-based verification points out clearly to the validity of the proposed return-stroke model. The initial split peak of simulated electric field was found to be lower than the measured one, possibly due to field-enhancement effects of the building on which the electric field sensor was placed.

119

Chapter 7 Conclusions 7 Conclusions
In this thesis an Alternative Transients program (ATP) application was applied for determining the lightning current along a tall-structure (CN Tower) and the attached channel, taking into account all relevant current reflections. In the modelling approach, reflections from the channel front and tower's structural discontinuities were taken into consideration. The different steps of the modelling approach, such as the determination of the locations of reflections, reflection coefficients, characteristic impedances and the double-term Heidler function parameters of the current, initially injected into the tower, were described. Locations of reflections and reflection coefficients were calculated by analyzing the measured current derivative signal. By curve fitting the decaying part of the simulated current with measurement, the two decay constants of the double-term Heidler function (current simulation function) were determined. The other parameters of the simulation function were obtained by curve fitting the measured current derivative signal before the arrival of reflections. An estimated return-stroke velocity profile, using a three-section model of the tower, was determined and it demonstrated that the velocity decays with time. Furthermore, using a fivesection model of the tower, the proposed approach enabled taking into account the upwardconnecting leader, which allows, for the first time, the determination of the upward-connecting leader lengths, and the return-stroke velocity variation profiles with more details. The returnstroke velocity profile is found to initially increase rapidly with time, reaching a peak, and then decrease less rapidly. A single-term Heidler function was found to accurately describe the time

120

variation of the return-stroke velocity. The lightning current-derivative simulation produced very successfully the fine structure of the measured current derivative signal. Also, the lightning current simulation succeeded in replicating the current obtained by numerical integration of the measured current derivative signal. The results reveal that ATP is an appropriate tool for such applications. The thesis also demonstrates the necessity of applying the five-section model to replicate the early zero crossing that proved to be a result of the existence of an upward-connecting leader. When compared with measurements, the simulated electric and magnetic fields markedly succeeded in replicating important details, including the initial split peak. This experimental field verification process points out clearly to the validity of the proposed return-stroke model. It is noted that the simulated electric field peak is only 75% of the measured one. The electric field enhancement effect due to the 40-m tall building, on which the electric field sensor was located, is assumed to be a result of this discrepancy. The ATP model enables, for the first time, the determination of the return-stroke velocity profile and the length of the upward-connected leader based on the measured current derivative signal. In the presented approach, all possible current reflections have been taken into consideration. It is worth mentioning that from among hundreds of recorded signals, it was possible to select a number of return-stroke current derivative signals, displaying high current peaks and low risetimes. For the selected signals, it was possible to accurately locate and identify all relevant reflections, including channel front reflections. The quality of these signals enabled the calculation of reflection coefficients and thus the difficult trial-and-error task of proposing an upward-connecting leader, channel and ground impedances have become unnecessary.

121

Although very appropriate, the double-term Heidler function, used for current simulation, it needs to be modified or possibly replaced because of its inability to simulate the initial slow current rise before the wavefront substantial fast rise. Furthermore, it is important to upgrade the CN Tower current derivative recording system to 1 ns time resolution and 12 bit vertical resolution in order to accurately locate channel wavefront reflections, as well as to precisely calculate current reflection coefficients.

122

Appendix A Lightning Current Distribution Based on CN Tower Three-Section Model Using Lattice Diagrams
In this Appendix, the developed expressions for lightning currents at any time and height along the current path (the tower and the lightning channel) for three-section model of the tower are
presented using the lattice diagrams.

A three-section TL representation of the CN Tower is shown in Figure A.1. In this Figure, h is

Z (m) Leader (partially ionized) Channel (fully ionized) ch v Tip of Tower (553m) Rogowski Coil (474m) 12 Top of Skypod (365m) Bottom of Skypod (335m) L3 23 L2 h t L1

Ground Level

g

0m

Figure A.1. CN Tower and its three-section model.

123

the height of the CN Tower taken from the ground level, L1 is the length of the first TL section (tower's tip to top of Skypod), L2 is the length of second TL section (top to bottom of Skypod), L3 is the length of third TL section (bottom of Skypod to the ground). The current equations in each of the three sections were derived for the reflections that occur in that particular section. For each equation a diagram is shown to illustrate the reflection for which the equation is derived. The derived equations will be used in the selected program, such as Matlab, in order to calculate the lightning current at any point along the lightning path. It is assumed that the speed of propagation of channel front (the return-stroke velocity) is v. The propagation within the channel and the tower is at the speed of light c. Definitions: L12=L1+L2; L23=L2+L3



v cv

 

cv cv
16

A.1 CURRENT EQUATIONS INSIDE L1 [ i ( z , t )   ik ,L1 ]
k 0

Z (m)

t 12 23

i1 i2

L1 L2

L3 g

Figure A.2. Reflections given by equations (A.1) and (A.2).

124

 h  z 2 L1  n n  i1,L1   12  t io  t   n n 0 c c  

(A.1)

i2,L1   12
n 0



n 1

 t nio  t 

 

2 L1  h  z 2 L1   n c c 

(A.2)

Z (m)

t i3 12 23 i4 L1 L2

L3 g

Figure A.3. Reflections given by equations (A.3) and (A.4).
 2 L  h  z 2 L12  2 n n 1  i3,L1   (1  12 ) n1  t  23 io  t  12  n n 0 c c  

(A.3)

i4, L1   (1  12 ) n 1t
2 n0



n 1

 23n 1io  t 

 

2 L12  h  z 2 L12  c c

 n 

(A.4)

Z (m)

t i5 12 23 i6 L1 L2

L3 g

Figure A.4. Reflections given by equations (A.5) and (A.6).

125

i5,L1   (1  12 ) n1 (1   23 ) n1  g
2 2 n 0 



n 1

 t nio  t 
 

 

h  z 2h   n c c  3h  z 2h   n c c 

(A.5)

i6, L1   (1  12 ) n 1 (1   23 ) n 1  g
2 2 n0

n 1

t n 1io  t 

(A.6)

Z (m)

t i7 12 23 L2 i8 L1

L3 g

Figure A.5. Reflections given by equations (A.7) and (A.8).
i7 ,L1   (1  12 ) 23 12
2 n 0  n 1

 t n1io  t 
 

 

2( L12  L1 )  h  z 2 L1   n c c  2( L12  L1 )  h  z 2 L1   n c c 

(A.7)

i8,L1   (1  12 ) 23 12
2 n 0



n 1

 t n2io  t 

(A.8)

Z (m)

t i9 12 23 i10 L1 L2

L3 g

Figure A.6. Reflections given by equations (A.9) and (A.10).

126

i9,L1   (1  12 )(1   23 )  g 12
2 2 n 0  2 2



n 1

 t n1io  t 
 

 

2( h  L1 )  h  z 2 L1   n c c  2( h  L1 )  h  z 2 L1   n c c 

(A.9)

i10,L1   (1  12 )(1   23 )  g 12
n 0

n 1

 t n2io  t 

(A.10)

Z (m)

t 12 23 i11

i12

L1 L2

L3 g

Figure A.7. Reflections given by equations (A.11) and (A.12).
i11,L1   12
n 0   n 1

2 L   h  z 2 L1  2 n  (1   t ) ch  t io  t  1  n c c  

(A.11)

i12,L1   12
n 0

n 2

2 L   2 L1  h  z 2 L1  2 n  (1   t ) ch  t io  t  1  n c c  

(A.12)

Z (m)

t 12 23 i13

i14

L1 L2

L3 g

Figure A.8. Reflections given by equations (A.13) and (A.14). 127

 2 L   h  z 2 L1  2 2 n n  i13,L1   (1  12 )  23 (1   t )  ch 12  t io  t  12  n n 0 c c  

(A.13)

i14,L1   (1  12 )  23 (1   t )  ch 12
2 2 n 0



n 1

 t nio  t 

 

2 L12   2 L12  h  z 2 L1   n c c  (A.14)

Z (m)

t 12 23 i15

i16

L1 L2 L3

g

Figure A.9. Reflections given by equations (A.15) and (A.16).
 2h  h  z 2 L1  2 2 2 n n  i15,L1   (1  12 )(1   23 )  g (1   t )  ch 12  t io  t   n n 0 c c  

(A.15)

i16,L1   (1  12 )(1   23 )  g (1   t )  ch 12
2 2 2 n 0



n 1

 t nio  t 

 

2h  2 L1  h  z 2 L1   n c c 

(A.16)

A.2 CURRENT EQUATIONS INSIDE L2 [ i ( z, t )   ik ,L2 ]
k 0

14

Z (m)

t 12 23 i1 i2 L1 L2 L3 g

Figure A.10. Reflections given by equations (A.17) and (A.18).

128

 h  z 2h  2 2 n n  i1,L2   (1  12 )(1  12 ) n (1   23 ) n  g  t io  t   n n 0 c c  

(A.17)

i2,L2   (1  12 )(1  12 ) n (1   23 ) n1  g
2 2 n 0



n 1

 t nio  t 

 

h  z 2h   n c c 

(A.18)

Z (m)

t L1 12 23 i3 i4 L2

L3 g

Figure A.11. Reflections given by equations (A.19) and (A.20).


i3,L2   12  t
n 0 

n 1

2 L  h  z 2h  2 2 n  (1  12 )(1  12 ) n (1   23 ) n  g io  t  1  n c c  
2 2 n 1

(A.19)

i4,L2   12  t
n 0

n 1

(1  12 )(1  12 ) n (1   23 ) n  g

2 L  h  z 2h   io  t  1  n c c  

(A.20)

Z (m)

t L1 12 23
i5 i6

L2

L3 g

Figure A.12. Reflections given by equations (A.21) and (A.22).

129

i5,L2   (1  12 )  23
n 0 



n 1

h  z  2 L3 2 L2   (  12 ) nio  t   n c c   h  2 L2  z 2 L2   (  12 ) n1io  t   n c c  

(A.21)

i6,L2   (1  12 )  23
n 0

n 1

(A.22)

Z (m)

t L1 12 23
i7 i8

L2

L3 g

Figure A.13. Reflections given by equations (A.23) and (A.24).
 h  2 L23  z 2 L2  2 n  i7 ,L2   (1  12 )(1   23 )  g (  12 ) n1  23 io  t   n n 0 c c    h  2 L2  z 2 L2  2 n 1  i8,L2   (1  12 )(1   23 )  g (  12 ) n1  23 io  t   n n 0 c c  

(A.23)

(A.24)

Z (m)

t 12 23
i9 i10

L1 L2

L3 g

Figure A.14. Reflections given by equations (A.25) and (A.26).

130

 2 L   h  z 2 L2   2 n i9,L2   12 (1   t )  ch (1  12 )  23 (  12 ) nio  t  1  n n 0 c c  

(A.25)

i10,L2   12 (1   t )  ch (1  12 )  23
2 n 0



n 1

2 L   h  2 L3  z 2 L2   (  12 ) nio  t  1  n c c  

A.26)

Z (m)

t 12 23
i11 i12

L1 L2

L3 g

Figure A.15. Reflections given by equations (A.27) and (A.28).
 2 L   h  z 2 L2  2 2 n i11,L2   (1  12 )  23 (1   t )  ch (1  12 )  23 (  12 ) n io  t  12  n 0 c c 

 n 

(A.27)
 n 

i12,L2   (1  12 )  23 (1   t )  ch (1  12 )  23
2 2 n 0



n 1

 2 L   h  2 L3  z 2 L2 ( 12 ) n io  t  12  c c 

(A.28)

Z (m)

t 12 23
i13 i14

L1 L2 L3

g

Figure A.16. Reflections given by equations (A.29) and (A.30).

131

  2h  h  z 2 L2 2 2 2 n i13,L2   (1  12 )(1   23 )  g (1   t )  ch (1  12 )  23 ( 12 ) nio  t   n 0 c c 

 n 

(A.29)

  2h  h  2 L3  z 2 L2  2 2 2 n 1 i14, L2   (1  12 )(1   23 )  g (1   t )  ch (1  12 )  23 ( 12 ) n io  t   n n 0 c c  (A.30) 

A.3 CURRENT EQUATIONS INSIDE L3 [ i ( z, t )   ik ,L3 ]
k 0

18

Z (m)

t 12 23 i1 g L1 L2 L3

i2

Figure A.17. Reflections given by equations (A.31) and (A.32).
  h  z 2 L3  n i1,L3   (1  12 )(1   23 )  g (  23 ) nio  t   n n 0 c c  

(A.31)

i2,L3   (1  12 )(1   23 )  g
n 0



n 1

 h  z 2 L3  (  23 ) nio  t   n c c  

(A.32)

Z (m)

t 12 23 i3 g L1 L2 L3

i4

Figure A.18. Reflections given by equations (A.33) and (A.34).

132

  h  2 L2  z 2 L3 n i3,L3   (1  12 )  23 ( 12 )(1   23 )  g (  23 ) nio  t   n 0 c c 

 n 

(A.33)

i4,L3   (1  12 )  23 ( 12 )(1   23 )  g
n 0



n 1

 h  2 L2  z 2 L3  (  23 ) nio  t   n c c  

(A.34)

Z (m)

t 12 23 i5 g L1 L2 L3

i6

Figure A.19. Reflections given by equations (A.35) and (A.36).

  h  2 L1  z 2 L3  n i5,L3   12  t (1  12 )(1   23 )  23  g (  23 ) nio  t   n n 0 c c  

(A.35)

i6,L3   12  t (1  12 )(1   23 )  23  g
n 0



n 1

 h  2 L1  z 2 L3  (  23 ) n io  t   n c c  

(A.36)

Z (m)

t 12 23 i7 g L1 L2 L3

i8

Figure A.20. Reflections given by equations (A.37) and (A.38).

133

  h  2 L12  z 2 L3 2 n i7 ,L3   (1  12 )  23  t (1  12 )(1   23 )  g (  23 ) n io  t   n 0 c c 

 n 

(A.37)

i8,L3   (1  12 )  23  t (1  12 )(1   23 )  g
2 n 0



n 1

 h  2 L12  z 2 L3  (  23 ) n io  t   n c c  

(A.38)

Z (m)

t 12 23 L1 L2

i9 g

i10

L3

Figure A.21. Reflections given by equations (A.39) and (A.40).

  h  4 L1  z 2 L3 2 2 n i9,L3   12  t (1  12 )(1   23 )  g (  23 ) nio  t   n 0 c c 

 n 

(A.39)

i10,L3   12  t (1  12 )(1   23 )  g
2 2 n 0



n 1

 h  4 L1  z 2 L3  (  23 ) nio  t   n c c  

(A.40)

Z (m)

t L1 12 23 L2

i11 g

i12

L3

Figure A.22. Reflections given by equations (A.41) and (A.42).

134

i11,L3   (1  12 ) n1 (1   23 )(1  12 )(1   23 ) n1  g
2 2 n 0



n 1

 t n1io  t 

 

3h  z 2h   n c c 

(A.41)

i12,L3   (1  12 ) n1 (1   23 )(1  12 )(1   23 ) n1  g
2 2 n 0



n2

 t n1io  t 

 

3h  z 2h   n c c 

(A.42)

Z (m)

t 12 23 i13 g L1 L2 L3

i14

Figure A.23. Reflections given by equations (A.43) and (A.44).
  2 L   h  z 2 L3 2 n i13,L3   12 (1   t )  ch (1  12 )(1   23 )  g (   23 ) n io  t  1  n 0 c c 

 n 

(A.43)

i14,L3   12 (1   t )  ch (1  12 )(1   23 )  g
2 n 0



n 1

 2 L   h  z 2 L3  (  23 ) nio  t  1  n c c  

(A.44)

Z (m)

t 12 23 L1 L2 L3

i15 g

i16

Figure A.24. Reflections given by equations (A.45) and (A.46).

135

  2 L   h  z 2 L3 2 2 n i15,L3   (1  12 )  23 (1   t )  ch (1  12 )(1   23 )  g (  23 ) n io  t  12  n 0 c c 

 n 

(A.45)

i16,L3   (1  12 )  23 (1   t )  ch (1  12 )(1   23 )  g
2 2 n 0



n 1

 2 L   h  z 2 L3  (  23 ) nio  t  12  n c c  

(A.46)

Z (m)

t L1 12 23 L2

i17 g

L3 i18

Figure A.25. Reflections given by equations (A.47) and (A.48).

i17,L3   (1  12 )(1   23 )(1   t )  ch (1  12 )(1   23 )  g
2 2 2 n 0  2 2 2



n 1

 2h  h  z 2 L3  (  23 ) nio  t   n c c    2h  h  z 2 L3  (  23 ) n io  t   n c c  

(A.47)

i18, L3   (1  12 )(1   23 )(1   t )  ch (1  12 )(1   23 )  g
n 0

n2

(A.48)

136

A.4 CURRENT EQUATIONS FOR UPWARD-PROPAGATING AND TRANSMITTED COMPONENTS IN THE LIGHTNING CHANNEL

Z (m)

iup (with speed v)
t 12 23

Zch

io (with speed of light c)

L1, Z1 L2 L3

g

Figure A.26. Current contribution iup given by equation (A.49).

iup 

Z1 Z ch

 z h ( io  t  e v  

z h ) 

for z  h

(A.49)

where  is the current decay constant and usually assumed to be 2000m in order to simulate the channel current using MTLE model [55].`

Z (m)

iT1
t 12 23 L1 L2 L3 g

Figure A.27. Current contribution iT1 given by equation (A.50). 137

2L z  h  2 L1  (  iT 1  12 (1   t )(1   ch )io  t  1  e v  cv 

z h ) 

(A.50)

for h+2L1 < z < 

Z (m)

iT2
t 12 23 L1 L2 L3 g

Figure A.28. Current contribution iT2 given by equation (A.51).

iT 2

z  h  2 L12  (  2L  (1  12 )  23 (1   t )(1   ch )io  t  12  e v  cv 
2

z h ) 

(A.51)

for h+2L1 < z < 

Z (m)

iT3

t 12 23 L1 L2 L3 g

Figure A.29. Current contribution iT3 given by equation (A.52).

138

iT 3  (1  12 )(1   23
2

2

2h z  h  2h  (  )  g (1   t )(1   ch )io  t   e v  cv 

z h ) 

(A.52)

for h+2h < z < 

A.5 EQUATIONS FOR INTERNAL COMPONENTS IN THE LIGHTNING CHANNEL

Z (m) ich1 t 12 23 L1 L2 L3 g ich2

Figure A.30. Reflections given by equations (A.53) and (A.54).
 2L z h  n ich1   12 (1   t )  ch (  t ) n io  t  1  n   n 0 c c  

(A.53)

ich 2   12 (1   t )  ch
n 0



n 1

 2 L1 n h  2 L1 n  z   (  t ) n io  t   cv    c  

(A.54)

Z (m)
ich4 ich3

t 12 23 L1 L2 L3 g

Figure A.31. Reflections given by equations (A.55) and (A.56). 139

 zh  2L 2 n ich 3   (1  12 )  23 (1   t )  ch (   t ) n io  t  12  n   n 0 c c  

(A.55)

ich 4   (1  12 )  23 (1  t )  ch
2 n 0



n1

 2 L12 n h  2 L12 n  z   ( t ) nio  t   cv    c  

(A.56)

Z (m)
ich5 ich6

t 12 23 L1 L2 L3 g

Figure A.32. Reflections given by equations (A.57) and (A.58).

  2h n z  h  2 2 n ich 5   (1  12 )(1   23 )  g (1   t )  ch (  t ) n io  t     n 0 c c  

(A.57)

ich 6   (1  12 )(1   23 )  g (1  t )  ch
2 2 n 0



n1

 2h n h  2h n  z   ( t ) nio  t   cv    c  

(A.58)

140

Appendix B An Introduction to ATP-EMTP Program
The EMTP (Electromagnetic Transients Program) is a well-known powerful tool and probably the most popular computer software package used for simulation analysis of power systems includes studying switching transients and overvoltages, short term analysis of disturbances, overcurrent calculations, protection analysis, power quality estimation, control of electric drives and many others. EMTP was developed in early 60s by a group of programmers directed by Prof. Herman Dommel at sponsorship of BPA (Bonneville Power Administration, Canada) [104]. The first version was based on Fortran source code and data format. Some of these features are used up till now. On the basis of EMTP experience many professional programs for similar applications were developed. Alternative Transients Program (ATP) is the version available in public domain and being continuously developed by regional groups of users on all continents. The ATP-EMTP is now used on all up-to-date computers and is provided with handy graphical interface ATPDraw. The ATP-EMTP program can be run under all nowadays-used operational systems, such as MS DOS (version Salford ATP), MS Windows (version Watcom ATP), and Linux (version GNU Mingw32). The ATP-EMTP program capacity is as follow: Number of nodes- 6000 Number of branches- 10000 Number of switches- 1200 141

Number of sources- 900 Number of nonlinear elements- 2250 Number of synchronous machines- 90 It is a universal program system for digital simulation of transient phenomena of electromagnetic as well as electromechanical nature. With this digital program, complex networks and control systems of arbitrary structure can be simulated. Analysis of control systems, harmonic studies, power electronics equipment and components with nonlinear characteristics such as arcs and corona are also possible [105]-[109]. Symmetric or asymmetric disturbances are allowed, such as faults, lightning surges, or any kind of switching operations [109]. Calculation of the frequency response of phasor networks is also supported [111], [112]. ATP has extensive modelling capabilities and additional important features besides the computation of transients. Figure B.1 shows the functional diagram of ATP and its output link to Matlab. The ATP program calculates variables of interest within electric power systems as functions of time, typically started by some disturbances. Fundamentally, the trapezoidal rule of integration is used to solve the differential equations of system components in the time domain. Non-zero initial conditions can be determined either automatically by a steady state, phasor solution or they can be entered by the user for some components [92]. Comparing ATP with Matlab presents that both tools are capable of simulating the same class of problems, since it is possible to build user defined elements in both cases. There are however some differences between the predefined components. ATP-EMTP is designed to simulate the physical processes of transmission lines and transformers quickly and in a convenient way but Matlab offers more possibilities in power electronics, signal processing and control [91].

142

Input Data Editor (Notepad or any other text editor)

ATP-EMTP Program

Calculations

Output Data Processor

Matlab

Memory

Plots

Figure B.1. Functional diagram of ATP.

143

Appendix C Publications during the PhD Work
[1] M. Sadegh Rahimian and A. M. Hussein, "ATP modelling of tall-structure lightning current: Estimation of return-stroke velocity variation and upward-connecting leader length," IEEE Transactions on Electromagnetic Compatibility, accepted for publication on September 15, 2014 (18 IEEE transaction pages). [2] M. Sadegh Rahimian and A. M. Hussein, "ATP modelling of the lightning current within a tall structure and the attached channel," in proc. 31st, International Conference on Lightning Protection, doi: 10.1109/ICLP.2012.6344390, Vienna, Austria, September 2012. [3] M. Sadegh Rahimian and Ali M. Hussein, "Calculation of tall-structure lightning current parameters using particle swarm optimization technique," in Proc. 31st International Conference on Lightning Protection, doi:10.1109/ICLP.2012.6344391 , Vienna, Austria, September 2012. [4] M. Sadegh Rahimian and K. Raahemifar, "Optimal PID controller design for AVR system using particle swarm optimization algorithm," in Proc. 24th Canadian Conference on Electrical Engineering (CCECE), pp. 337-340, Niagara Falls, Canada, May 2011. [5] M. Sadegh Rahimian and Ali M. Hussein, "Modelling the lightning current distribution within the CN tower using ATP-EMTP," presented at Cage Club Student Conference on High Voltage Engineering and Electrostatics, University of Waterloo, Waterloo, Canada, August 16, 2011. [6] M. Sadegh Rahimian and Ali M. Hussein, "ATP modelling of the lightning current within the CN Tower and attached channel," Ryerson Graduate Research Symposium, Ryerson University, Toronto, Canada, 2012.

144

REFERENCES
Vladimir A. Rakov and Martin A. Uman, "Lightning Â­ Physics and Effects," New York, N.Y: Cambridge University Press, 2003. [2] V. A. Rakov and F. Rachidi, "Overview of recent progress in lightning research and lightning protection" IEEE Transactions on Electromagnetic Compatibility, vol. 51, no. 3, August 2009. [3] A. Borghetti, C. A. Nucci, and M. Paolone , "Indirect-lightning performance of overhead distribution networks with complex topology," IEEE Transactions On Power Delivery, vol. 24, no. 4, pp. 2206 - 2213, October 2009. [4] M. Paolone, F. Rachidi, A. Borghetti, C. A. Nucci, M. Rubinstein, V. A. Rakov, and M. A. Uman, "Lightning electromagnetic field coupling to overhead lines: theory, numerical simulations, and experimental validation", IEEE Transactions on Electromagnetic Compatibility, vol. 51, no. 3, pp. 532 - 547, August 2009. [5] A. M. Hussein, M. Milewski, and W. Janischewskyj, "Correlating the characteristics of the CN Tower lightning return-stroke current with those of its generated electromagnetic pulse," IEEE Transactions on Electromagnetic Compatibility, vol. 50, no. 3, pp. 642-650, August 2008. [6] V. Cooray and C. Gomes, "Estimation of peak return stroke currents, current time derivative and return stroke velocities from measured fields,"Journal of Electrostatics, vol. 43, no. 3, pp. 163-172, May 1998. [7] F. Rachidi, J. L. Bermudez, M. Rubinstein and V. A. Rakov, "On the estimation of lightning peak currents from measured fields using lightning location systems," Journal of Electrostatics, vol. 60, no. 2-4, pp. 121-129, March 2004.

[1]

145

[8]

D. Pavanello, F. Rachidi, W. Janischewskyj, M. Rubinstein, V. O. Shostak, C. A. Nucci, K. L. Cummins, A. M. Hussein, and J. S. Chang, "On the current peak estimates provided by lightning detection networks for lightning return strokes to tall towers," IEEE

Transactions on Electromagnetic Compatibility, vol. 51, no. 3, pp. 453-458, August 2009. [9] A. Lafkovici, A. M. Hussein, W. Janischewskyj, and K. L. Cummins, "Evaluation of the performance characteristics of the North American Llightning Detection Network based on tall-structure lightning," IEEE Transactions on Electromagnetic Compatibility, vol. 50, no. 3, pp. 630-641, August 2008. [10] D. Wang, V. A. Rakov, N. Takagi, and T. Watanabe, "A discussion of travelling waves involved in the lightning return stroke process," Journal of Atmospheric Electricity, vol. 28, no. 2, pp. 71-77, 2008. [11] A. Hussein, W. Janischewskyj, M. Milewski, V. Shostak, J.-S. Chang, and W. Chisholm, "Current waveform parameters of CN Tower lightning return strokes," Journal of Electrostatics, vol. 60, no. 2-4, pp. 149-162, March 2004. [12] Martin A. Uman, "The Lightning Discharge," Orlando, FL: Academic Press Inc., 1987. [13] A. M. Hussein, M. Milewski, A. Abdelraziq, W. Janischewskyj, and F. Jabbar, "Visual characteristics of CN Tower lightning flashes," in Proc. 28th International Conference on Lightning Protection, pp. 89-94, Kanazawa, Japan, September 18-22, 2006. [14] A. M. Hussein, W. Janischewskyj, J. S. Chang, V. Shostak, W. A. Chisholm, P. Dzurevych, and Z. I. Kawazaki, "Simultaneous measurement of lightning paramet ers for strokes to the Toronto Canadian National Tower," Journal of Geophysical Research: Atmosphere., vol. 100, no. 5, pp. 8853-8861, May 1995. [15] W. Janischewskyj, A. M. Hussein, V. Shostak, I. Rusan, J.-X. Li, and J. S. Chang, "Statistics of lightning strikes to the Toronto CN Tower (1978-1995)," IEEE Transactions on Power Delivery., vol. 2, no. 3, pp. 1210Â­1221, July 1997.

146

[16] A. M. Hussein, "CN Tower lightning parameters," in Proc. 10th International symposium on Lightning Protection (X SIPDA), pp. 107-133, Curitiba, Brazil, November, 2009. [17] A. M. Hussein, W. Janischewskyj, M. Milewski, V. Shostak, and J. S. Chang, "Waveform parameters of fields generated by lightning strokes to the CN Tower and to objects in its vicinity," in Proc. IEEE Bologna Power Tech. Conference., Bologna, Italy, pp. 1-8, June 23Â­26, 2003. [18] A. M. Hussein, W. Janischewskyj, and M. Milewski, "waveform parameters of the electromagnetic pulse generated by first and subsequent lightning return strokes to the CN Tower," in Proc. 17th Int. Symp. Electromagnetic Compatibility, Wroclaw, Poland, pp. 394-399, June 29Â­July 1, 2004. [19] V. A. Rakov and M. A. Uman, "Review and evaluation of lightning return stroke models including some aspects of their application," IEEE Transactions on Electromagnetic Compatibility, vol. 40, no. 4, pp. 403-426, November 1998. [20] M. N. Plooster, "Shock waves from line sources. Numerical solutions and experimental measurements," Physics of Fluids, vol. 13, no. 11, pp. 2665-2675, November 1970. [21] M. N. Plooster, "Numerical model of the return stroke of the lightning discharge," Physics of Fluids, vol. 14, no. 10, pp. 2124-2133, October 1971. [22] M. N. Plooster, "Numerical simulation of spark discharges in air," Physics of Fluids, vol. 14, no. 10, pp. 2111-2123, October 1971. [23] R. D. Hill, "Channel heating in return stroke lightning," Journal of Geophysical Research, vol. 76, no. 3, pp. 637-645, January 1971. [24] R. D. Hill, "Energy dissipation in lightning," Journal of Geophysical Research, vol. 82, no. 31, pp. 4967Â­4968, October 1977. [25] A. H. Paxton, R. L. Gardner, and L. Baker, "Lightning return stroke: A numerical calculation of the optical radiation," Physics of Fluids, vol. 29, no. 8, pp. 2736Â­2741, August 1986. 147

[26] A. S. Bizjaev, V. P. Larionov, and E. H. Prokhorov, "Energetic characteristi cs of lightning channel," in Proc. 20th International Conference on Lightning Protection, pp. 1.1-1-3, Interlaken, Switzerland, September 1990. [27] E. I. Dubovoy, M. S. Mikhailov, A. L. Ogonkov, and V. I. Pryazhinsky, "Measurement and numerical of radio sounding reflection from a lightning channel," Journal of Geophysical Research, vol. 100, no. D1, pp. 1497Â­1502, January 1995. [28] Y. Baba and M. Ishii, "Numerical electromagnetic field analysis of tower surge response," IEEE Transaction on Power Delivery, vol. 12, no.1, pp. 483Â­488, January 1997. [29] R. Moini, B. Kordi, G. Z. Rafi, and V. A. Rakov, "A new lightning return stroke model based on antenna theory," Journal of Geophysical Research, vol. 105, no. D24, pp. 2969329702, December 2000. [30] Y. Baba and M. Ishii, " Numerical electromagnetic field analysis of lightning current in tall structures," IEEE Transaction on Power Delivery, vol. 16, no.2, pp. 324Â­328, April 2001. [31] E. Petrache, F. Rachidi, D. Pavanello, W. Janischewskyj, A. M. Hussein, M. Rubinstein, V. Shostak, W. A. Chisholm, and J. S. Chang, "Lightning strikes to elevated structures: influence of conditions on currents and electromagnetic fields," in proc. IEEE International Symposium on Electromagnetic Compatibility, vol. 2, pp. 377-381, Chicago, August 2005. [32] E. Petrache, F. Rachidi, D. Pavanello, W. Janischewskyj, M. Rubinstein, W. A. Chisholm, A. M. Hussein, V. Shostak, and J. S. Chang, "Influence of the finite ground conductivity on the transient response to lightning of a tower and its grounding", 28th General Assembly of International Union of Radio Science (URSI), New Delhi, India, pp. 1-4, October 23-29, 2005. [33] B. Kordi, R. Moini, W. Janischewskyj, A. M. Hussein, V. Shostak and V. A. Rakov, "Application of antenna theory model to a tall tower struck by lightning," Journal of Geophysical Research, vol. 108, no. D17, pp. ACL7-1-9, September 2003.

148

[34] A. Shoory, R. Moini, S. H. H. Sadeghi, and V. A, Rakov, "Analysis of lightning-radiated electromagnetic fields in the vicinity of lossy ground," IEEE Transactions on Electromagnetic Compatibility, vol. 47, no. 1, pp. 131-145, February 2005. [35] S. H. S. Moosavi, R. Moini, S. H. H. Sadeghi, and B. Kordi, " Application of the nonlinear antenna theory model to a tall tower struck by lightning for the evaluation of return stroke channel current and radiated electromagnetic fields," J. Geophy. Res., vol. 116, no. D11, pp. D11118 (11 pp.), June 2011. [36] Little, P. F., "Transmission line representation of a lightning return stroke", Journal of Physics D (Applied Physics), vol. 11, no. 13, pp. 1893-1910, September 1978. [37] G. H. Price and E. T. Pierce, "The modeling of channel current in the lightning return stroke," Radio science, vol. 12, no. 3, pp. 381-388, May-June 1972. [38] Y. Baba and V. A. Rakov, "On the use of lumped sources in lightning return stroke models," Journal of Geophysical Research, vol. 110, no. D3, pp. 10-16, February 2005. [39] V. A. Rakov and M. A. Uman, "Review and evaluation of lightning return stroke models including some aspects of their application," IEEE Transactions on Electromagnetic Compatibility, vol. 40, no. 4, pp. 403 Â­ 426, November 1998. [40] C. Gomes and V. Cooray, "Concepts of lightning return stroke models", IEEE Transactions on Electromagnetic Compatibility, vol. 42, no. 1, pp. 82-96, February 2000. [41] C. A. Nucci, G. Diendorfer, M. Uman, F. Rachidi, M. Ianoz, and C. Mazzetti, "Lightning return-stroke current models with specified channel-base current: a review and comparison," Journal of Geophysical Research, vol. 95, no. D12, 20395-20408, 1990. [42] V. A. Rakov, "Lightning electromagnetic fields: modeling and measurements," in Proc. 12th International Symposium on Electromagnetic Compatibility, Zurich, Switzerland, pp. 59Â­64, February 1997.

149

[43] C. A. Nucci, C. Mazzetti, F. Rachidi, and M. Ianoz, "On lightning return stroke models for LEMP calculations," in Proc. 19th International Conference on Lightning Protection, Graz, Austria, April 1988. [44] Y. Baba, S. Miyazaki, and M. Ishii, "Reproduction of lightning electromagnetic field waveforms by engineering model of return stroke," IEEE Transactions on Electromagnetic compatibility, vol. 46, no. 1, pp. 130-133, February 2004. [45] K. Bitner and A. M. Hussein, "Modeling of the CN Tower lightning return-stroke current derivative," in Proc. 28th International Conference on Lightning Protection, pp. 261-266, Kanazawa, Japan, September 18-22, 2006. [46] I. Boev and W. Janischewskyi, "Determination of current within lightning path in the case of lightning to a tall object," IEEE Transactions on Electromagnetic Compatibility, vol. 53, no. 1, pp. 131-139, February 2011. [47] J. L. Bermudez, F. Rachidi, W. A. Chisholm, M. Rubinstein, W. Janischewskyi, A. M. Hussein, V. Shostak, and J. S. Chang, "On the use of transmission line theory to represent a nonuniform vertically-extended object struck by lightning," in Proc. IEEE Interntional Symposium on Electromagneic Compatibility, pp. 501Â­504, 2003. [48] M. Uman and D. K. McLain, " Magnetic field of lightning return stroke," Journal of Geogphysical Research, vol. 74, no. 28, pp. 6899-6910, December 1969. [49] F. Heidler, "Travelling current source model for LEMP calculation," in Proc. 6th International Symposium on Electromagnetic Compatibility, pp.157-162, Zurich, Switzerland, 1985. [50] G. Diendorfer and M. A. Uman, "An improved return-stroke model with specified channelbased current," Journal of Geophysical Research, vol. 95, no. D9, pp. 13,621-13,644, August 1990. [51] C. E. R. Bruce and R. H. Golde, "The lightning discharge," Journal of Institute of Electrical Engineers, vol. 88, no. 2, pp. 487-520, 1941.

150

[52] R. Thottappillil, V. A. Rakov, and M. A. Uman, "Distribution of charge along the lightning channel: relation to remote electric and magnetic fields and to return stroke models," Journal of Geophysical Research, vol. 102, no. D6, pp. 6887Â­7006, March 1997. [53] D. M. Mach and W. D. Rust, "Photoelectric return-stroke velocity and peak current estimates in natural and triggered lightning," Journal of Geophysical Research, vol. 94, no. D11, pp. 13,237-13,247, September 1989. [54] D. Wang, Z. I. Kawasaki, K. Yamamoto, K. Matsuura, J.-S. Chang, and W. Janischewskyj, "Luminous propagation of lightning attachment to CN Tower," Journal of Geophysical Research, vol. 100, no. D6, pp. 11,661-11,667, June 1995. [55] F. Rachidi, W. Janischewskyj, A. M. Hussein, C.A. Nucci, S. Cuerrieri, B. Kordi, and J. S. Chang , "Current and electromagnetic field associated with lightning return strokes to tall towers," IEEE Transactions on Electromagnetic Compatibility, vol. 43, no. 3, pp. 356-365, August 2001. [56] V. Shostak, W. Janischewskyj, and A. M. Hussein, "Expanding the modified transmission line to model to account for reflections within the continuously growing lightning returnstroke channel," in Proc. the IEEE Power Engineering Society Summer Meeting, vol 4, pp. 2,589-2,602, 2000. [57] D. M. Le Vine and J. C. Willett, "Comment on the transmission line model for computing radiation from lightning," Journal of Geophysical Research, vol.97, no. D2, 2601-2610, 1992. [58] C. A. Nucci, G. Diendorfer, M. Uman, F. Rachidi, M. Ianoz, and C. Mazzetti, "Lightning return stroke current models with specified channel-base current: a review and comparison," Journal of Geophysical Research, vol. 95, no. D12, 20395-20408, 1990. [59] M. Rubinstein and M. A. Uman, "On the radiation field turn-on term associated with travelling current discontinuities in lightning" Journal of Geophysical Research, 95, no. D4, 3711-3713, March 1990.

151

[60] D. Pavanello, F. Rachidi, M. Rubinstein, J. L. Bermudez, and C. A. Nucci, "Electromagnetic field radiated by lightning to tall towers: treatment of the discontinuity at the return stroke wave front," Journal of Geophysical Research, vol. 109, no. D6, pp. D06114 (7 pp.), 2004. [61] D. Pavanello, F. Rachidi, V. A. Rakov, C. A. Nucci, and J. L. Bermudez, "Return stroke current profiles and electromagnetic fields associated with lightning strikes to tall towers: Comparison engineering models," Journal of Electrostatics, vol. 65, no. 5-6 SPEC ISS, pp. 316-321, 2007. [62] F. Rachidi, V. A. Rakov, C. A. Nucci, and J. L. Bermudez, "Effect of vertically-extended strike object on the distribution of current along the lightning channel," Journal of Geophysical Research, vol. 107, no. D23, pp. ACL 16-1-6, December 2002. [63] Y. Baba and V. A. Rakov, "Lightning electromagnetic environment in the presence of tall grounded strike object," Journal of Geophysical Research, vol. 110, no. D09108, doi: 10.1029/2004JD005505, 2005. [64] W. Janischewskyj, V. Shostak, J. Barrat, A. M. Hussein, I. Rusan, and J.-S. Chang, "Collection and use of lightning return stroke parameters taking into account characteristics of the struck object," in Proc. 23rd International Conference on Lightning Protection, pp. 16-23, Florence, Italy, September 1996. [65] O. Beirel, "Front shape parameters of negative subsequent strokes measured at the Peissenberg Tower," in Proc. 21st International Conference on Lightning Protection, pp. 1.4-1-6, Berlin, Germany, September 1992. [66] V. Cooray and V. A. Rakov, "Engineering lightning return-stroke models incorporating current reflection from ground and finitely conducting ground effects," IEEE Transactions on Electromagnetic Compatibility, vol. 53, no. 3, pp. 773Â­781, August 2011.

152

[67] Y. Baba and V. A. Rakov, "Influences of the presence of a tall grounded strike object and an upward connecting leader on lightning currents and electromagnetic fields," IEEE Transactions on Electromagnetic Compatibility, vol. 49, no. 4, pp. 886Â­892, November 2007. [68] A. Mosaddeghi, F. Rachidi, M. Rubinstein, F. Napolitano, D. Pavanello, V. Shostak, W. Janischewskyj, and M. Nyffeler, "Radiated fields from lightning strikes to tall structures: effect of upward-connecting leader and reflections at the return stroke wavefront," IEEE Transactions on Electromagnetic Compatibility, vol. 53, no. 2, pp. 437-445, May 2011. [69] A. Mosaddeghi, F. Rachidi, M. Rubinstein, D. Pavanello, V. Shostak, W. Janischewskyj, and E. Petrache, "On the effect of possible reflections at the return-stroke wavefront on radiated fields from lightning strikes to tall structures," in Proc. 10th International symposium on Lightning Protection (X SIPDA), pp. 457-461, Curitiba, Brazil, November, 2009. [70] M. Sadegh Rahimian and A. M. Hussein, "ATP modelling of the lightning current within a tall structure and the attached channel," in proc. 31st International Conference Lightning Protection, doi: 10.1109/ICLP.2012.6344390, Vienna, Austria, September 2012. [71] M. Milewski and A. M. Hussein, "Tall-structure return-stroke modelling," in Proc. 14th International Middle East Power System Conference (MEPCON'10), Paper ID 313, pp. 947-952, Cairo University, Egypt, December 2010. [72] D. Pavanello, F. Rachidi, M. Rubinstein, W. Janischewskyj, V. Shostak, A. M. Hussein, and J.S. Chang, "On return-stroke currents and remote electromagnetic fields associated with lightning strikes to tall structures: Computational models," Journal of Geophysical Research, vol. 112, no. D13101, pp. 1-16, July 2007. [73] M. Sadegh Rahimian and A. M. Hussein, "ATP modelling of tall-structure lightning current: Estimation of return-stroke velocity variation and upward-connecting leader length," IEEE Transactions on Electromagnetic Compatibility, accepted for publication on September 15, 2014.

153

[74] F. Heidler, J. M. Cvetic, and B. V. Statnic, "Calculation of lightning current parameters," IEEE Transaction on Power Delivery, vol. 14, no. 2, pp. 399-404, April 1999. [75] K. Elrodesly and A.M. Hussein, "CN Tower lightning return-stroke current simulation," Journal of Lightning Research, vol. 4 (Suppl 2: M3), pp. 60-70, July 2012. [76] M. Sadegh Rahimian and A. M. Hussein, "Calculation of tall-structure lightning current parameters using particle swarm optimization technique," in Proc. 31st International Conference on Lightning Protection, doi:10.1109/ICLP.2012.6344391 , Vienna, Austria, September 2012. [77] J. Kennedy and R. C. Eberhart, "Particle swarm optimization," in Proc. IEEE International Conference on Neural Networks, pp. 1942Â­1948, Perth, Australia, November 1995. [78] M. Sadegh Rahimian and K. Raahemifar, "Optimal PID controller design for AVR system using particle swarm optimization algorithm," in Proc. 24th Canadian Conference on Electrical Engineering (CCECE), pp. 337-340, Niagara Falls, Canada, May 2011. [79] Y. Shi and R. C. Eberhart, "A modified particle swarm optimizer," in Proc. IEEE International Conference on Evelutionary Computation, Cat. No.98TH836, pp. 69-73, 1998. [80] Y. Shi and R. C. Eberhart, "Parameter selection in particle swarm optimization," Lecture Notes in Computer Science, vol. 1447, pp. 591, 1998. [81] L. Zhang, H. Yu, and S. Hu, "Optimal choice of parameters for particle swarm optimization," Journal of Zhejiang University SCIENCE, 6A (6), pp. 528-534, 2005. [82] Y. Shi and R. C. Eberhart, "Particle swarm optimization: Developments, applications and resources," in Proc. Gongress on Evelutionary Computation, vol. 1, pp. 81-86, May 2001. [83] V. A. Rakov, "Transient response of a tall object to lightning," IEEE Transactions on Electromagnetic Compatibility, vol. 43, no. 4, pp. 654Â­661, November 2001.

154

[84] I. Boev, "Radiated electric and magnetic fields caused by lightning return strokes to the Toronto CN Tower," PhD thesis, University of Toronto, Toronto, Canada, 2010. [85] M. Milewski, "Lightning return-stroke transmission line modelling based on the derivative of Heidler function and CN Tower data," PhD thesis, Ryerson University, Toronto, Canada, 2009. [86] C. T. Mata, M. I. Fernandez, V. A. Rakov, and M. A. Uman, "EMTP modeling of a triggered-lightning strike to the phase conductor of an overhead distribution line," IEEE Transactions on. Power Delivery, vol. 15, no. 4, pp. 1175-1181, October 2000. [87] M. A. Omidiora, M. Lehtonen, and R. J. Millar, "EMTP simulation of lightning overvoltage discharge to medium voltage overhead lines with covered conductors," in Proc. 20th International Conference on Electricity Distribution, Paper no. 0652, Prague, June 2009. [88] R. J. Cabral, D. S. Gazzana, R. C. Leborgne, A. S. Bretas, and G. A. D. Dias, and M. Tello, "Analysis of distribution lines performance against lightning using ATP-EMTP," in Proc. 2012 International Symposium on Electromagnetic Compatibility, doi:10.1109/EMC Europe.2012.6396751, pp. 1-6. September 2012. [89] M. Sadegh Rahimian, S. H. H. Sadeghi, and R. Moini, "LEMP coupling with medium voltage overhead lines and its effects on low voltage networks with power electronic devices," in Proc. 3rd International Symposium on Electromagnetic Compatibility, pp.115118, China, 2002. [90] A. Borghetti, C. A. Nucci, and M. Paolone, "Indirect-lightning performance of overhead distribution networks with complex topology," IEEE Transactions on Power Delivery, vol. 24, no. 4, October 2009. [91] M. Ceraolo and S. Barsali, "Simulation of electromagnetic transients in power systems: A comparison between ATP/ATPDRAW and SIMULINKK/PSB environments," in Proc. International Conference on Power System Transients, IPST2001, pp. 698-703, Rio de Janeiro, Brazil, June 2001. 155

[92] Alternative Transients Program (ATP) Rule Book, Canadian/American EMTP User's Group, 1987-2010. [93] A. Mosaddeghi, F. Rachidi, M. Rubinstein,F. Napolitano, D. Pavanello, V. Shostak,W. Janischewskyj, and Markus Nyffeler, "Radiated fields from lightning strikes to tall structures: effect of upward-connecting leader and reflections at the return stroke wavefront," IEEE Transactions on Electromagnetic Compatibility, vol. 53, no. 2, pp. 437445, May 2011. [94] A. Mosaddeghi, A. Shoory, F. Rachidi, M. Rubinstein, F. G. Diendorfer, H. Pichler, and D. Pavanello, "Lightning return strokes to tall towers: ability of engineering and electromagnetic models to reproduce nearby electromagnetic fields," IEEE Transactions on Electromagnetic Compatibility, vol. 54, no. 4, pp. 889-893, August 2012. [95] M. A. Uman, D. K. McLain, and E. P. Krider, "The electromagnetic radiation from finite antenna," American Journal of Physics, vol. 43, pp. 33-38, January 1975. [96] R. Thottappillil, "Computation of electromagnetic fields from lightning discharge," in The Lightning Flash, Ed. V. Corray, pp. 241-279, IEE, London, U.K, 2003. [97] M. Sadiku, "Elements of Electromagnetics," 5th edition, Oxford, 2010. [98] W.H. Hayt, and J.A. Buck, "Engineering Electromagnetics," 6th edition, McGraw-Hill, 2001. [99] S. Guerrieri, F. Heidler, C.A. Nucci, F. Rachidi, and M. Rubinstein, "Extension of two return stroke models to consider the influence of elevated strike objects on the lightning return stroke current and the radiated electric field", in Proc. International Symposium on. Electromagnetic Compatibility,vol. 2, pp. 701-706, September 1996. [100] J. L. Bermudez, F.Rachidi, M. Rubinstein, W. Janischewskyj, V. Shostak, D. Pavanello, J. S. Chang, A. M. Hussein, C. A. Nucci, and M. Paolone, "Far-fieldÂ­current relationship based on the TL model for lightning return strokes to elevated strike objects", IEEE Transactions on Electromagnetic Compatibility, vol. 47, no. 1, pp. 146Â­158, February 2005. 156

[101] M. Rubinstein, E. Montandon, and M. Ianoz, "Analysis of multi-station cloud lightning electric field pulses recorded with the Swiss LPATS network," in Proc. 22nd International Conference on Lightning Protection, Budapest, Hungary, 1994. [102] S. Bonyadi-Ram, R. Moini, S. H. H.Sadeghi, and A. Mahanfar, "The effects of tall buildings on the measurement of electromagnetic fields due to lightning return stroke," in proc. 2001 IEEE International symposium on electromagnetic compatibility, doi: 10.1109/ISEMC.2001.950533, vol. 2, pp. 1000-1004, Montreal, Canada, 2001. [103] A. Mosaddeghi, D. Pavanello , F. Rachidi, M. Rubinstein, and P. ZweiackerF, "Distortion of electric and magnetic fields from lightning due to close-by metallic structures," in Proc. 7th International Symposium on. Electromagnetic Compatibility and Electromagnetic Ecology, doi: 10.1109/EMCECO.2007.4371702 , pp. 249-253, June 2007. [104] H. W. Dommel, "EMTP Theory Book," 2nd edition, Microtran Power system Analysis Corporation, Vancouver, British Colombia, Canada, May 1992. [105] S. Lefebvre and J. Mahseredjian, "Improved control systems simulation in the EMTP through compensation," IEEE Transactions on Power Delivery, vol. 9, no. 3, pp. 16541662, July 1994. [106] G. Murere, S. Lefebvre, and X. Do, "Generalized harmonic balance method for EMTP initialization," IEEE Transactions on Power Delivery, vol. 10, no. 3, pp. 1353-1359, July 1995. [107] L. Cheng-Tsung and C. Wen-Lin, "synchronized solution of power electronics system equation using flexible MODELS component connected to the EMTP," IEEE Transactions on Power Delivery, vol. 11, no. 4, pp. 1868-1873, October 1994. [108] I. M. Dudurych, T. J. Gallagher, and E. Rosolowski, "Arc effect on single phase reclosing time of a UHV power transmission line," IEEE Transactions on Power Delivery, vol. 19, no. 2, pp. 854-860, April 2004.

157

[109] T. J. Gallagher and I. M. Dudurych, "Model of corona for an EMTP study of surge propagation along HV transmission lines," in Proc. IEE Generation, Transmission and Distribution, vol. 151, no. 1, pp.61-66, January 2004. [110] L. Prikler, G. Ban and G. Banfai, "EMTP models for simulation of shunt reactor switching transients," International Journal of Electrical Power & Energy Systems, vol. 19, no. 4, pp. 235-240, May 1997. [111] L. Guishu, D. Huaying, W. Xiaohui, Z. Xile, S. Haifeng , and C. Xiang, "High -frequency EMTP model of transformer windings," in Proc. 7th International Symposium on Electromagnetic Compatibility, pp. 662-665, Singapore, March 2006. [112] A. S. Morched, J. H. Ottevangers, and L. Marti, "Multi-port frequency dependent network equivalents for the EMTP," IEEE Transactions on Power Delivery, vol. 8, no. 3, pp. 14021412, July 1993.

158

NOMENCLATURE
c EZ H h ha hc hr1 to hr6 hRB hRT hSB hST H I I1, I2 Idmax Imax io(t) n n1, n2 t1 to t6 tmc tms tr1 to tr6 The speed of light (m/s) Vertical component of electric field (V/m) Length of lightning current path, cloud to ground (m) Height of the tower (m) Length of upward-connecting leader (m) Location of Rogowski coil with respect to ground (m) Locations of channel-front reflections with respect to ground (m) Location of Skypod (restaurant) bottom with respect to ground (m) Location of Skypod (restaurant) top with respect to ground (m) Location of Space-Deck bottom with respect to ground (m) Location of Space-Deck top with respect to ground (m) Azimutal component of magnetic field (A/m) Control the current amplitude in single-term Heidler function (kA) Controls the current amplitude in double-term Heidler function (kA) Maximum steepness, (kA/s) Maximum current (kA) Heidler function simulating initially injected current into the tower An exponent in single-term Heidler function Exponents in double -term Heidler function Times of occurrence of channel-front reflections recorded by coil (s) Time of occurrence of maximum current (s) Time of occurrence of maximum steepness (s) Times of occurrence of channel-front reflections along the channel (s)

159

v v0 to v6 Z1 Z2 Z3 Z4 Z5 Zch Zg Z Zob 12 23 34 g L t 1 11, 12 2 21, 22 

Return-stroke velocity (m/s) Average return-stroke velocity in different sections of channel (m/s) Characteristic impedance of first section of the tower () Characteristic impedance of second section of the tower () Characteristic impedance of third section of the tower () Characteristic impedance of fourth section of the tower () Characteristic impedance of fifth section of the tower () Characteristic impedance of channel () Characteristic impedance of ground () Characteristic impedance of leader () Characteristic impedance of the object being struck by lightning () Reflection coefficient at the boundary of sections 1 and 2 Reflection coefficient at the boundary of sections 2 and 3 Reflection coefficient at the boundary of sections 3 and 4 Reflection coefficient at ground Line charge density (C/m) Reflection coefficient at the tower's tip Front time constant in single-term Heidler function (s) Front time constants in double -term Heidler function (s) Decay time constant in single-term Heidler function (s) Decay time constants in double e-term Heidler function (s) Current decay constant (m)

Parameters of PSO algorithm: c1, c2 gbest g(t) User-supplied coefficients The best particle in the swarm at iteration t

160

pbest j,g(t) r1 , r2 vj,g(t) xj,g(t) 

The individual best position of particle j until iteration t Random values regenerated for each velocity update (0  r1 and r2  1) Velocity of particle j (dimension g) at iteration t; Current position of particle j at iteration t Inertia weight factor

161


