APPLIANCE SCHEDULING OPTIMIZATION WITH MICRO-GRID IN SMART HOME NETWORK
by

Fatima Abdul Qayyum B.S., Sir Syed Engineering University, Karachi, Pakistan, 1998

A Thesis Presented to Ryerson University in partial fulfillment of the requirements for the degree of Master of Applied Science in the Program of Electrical and Computer Engineering

Toronto, Ontario, Canada. c Fatima Abdul Qayyum 2015

Author's Declaration
I hereby declare that I am the sole author of this thesis. This is a true copy of the thesis, including any required final revisions, as accepted by my examiners. I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research. I further authorize Ryerson University to reproduce this thesis by photocopying or any other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. I understand that my thesis may be made electronically available to the public.

ii

Abstract Appliance Scheduling Optimization with Micro-Grid in Smart Home Network
c Fatima Abdul Qayyum, 2015 Master of Applied Science Electrical and Computer Engineering Ryerson University

The fast emerging smart grid technology provides greater information flow, flexibility and control to both electricity consumers and electricity suppliers. Of these benefits, the two way flow of information between consumer and electricity producer in smart grid opened new vistas of applications. Smart home appliances are connected to home area network (HAN) to co-ordinate power usage demanded for the home under control. We are, therefore, witnessing an increasing interest in smart homes from the point of view of optimal energy management, renewable green energy sources and smart appliances. Hence, the problem of scheduling of smart appliances operations in a given time range with set of energy sources like national grid and local generation micro-grid is investigated in this thesis. Renewable energy source that is adopted in this thesis is a photovoltaic panel as a power producing appliance. Appliance operation is modeled in terms of un-interruptible sequence phases, given in load demand profile with a goal of minimizing electricity cost fulfilling duration, energy requirement, and user preference constraints. An optimization algorithm which can provide a schedule plan for smart home appliances usage is proposed based on the mixed integer linear programming technique. The effect of adding a photovoltaic system in the home results in reduction of electricity bill and the peak demand of the home and export of energy to the national grid in times when solar energy production is more than the demand of the home. The situation is modeled using Matlab with Yalmip library to exploit the state-of-the-art Gurobi solver for obtaining the timing of appliance scheduling in the smart home in comparable time to be true as real time process for demand side management.

iii

Acknowledgement

I am availing this opportunity to sincerely acknowledge my supervisor, Professor Alagan Anpalagan for his able guidance, timely support and generous dealing as a mentor. I am extending my gratitude for his patience in teaching and his contribution in my research and for making me believe that I could do research work. I would like to acknowledge the Department of Electrical and Computer Engineering and the School of Graduate Studies at Ryerson University for their support in terms of financial aid, and Opportunity to work as a Research Assistant. Thanks are also due to my colleagues in the WAN group present and past, I am lucky to be a part of this group where a team spirit truly prevails. I can never reciprocate the efforts and love to thank my husband, Abdul Basit, who was amazingly patient, supportive and coped with me in most difficult times of my life. He believed in me more than I do and takes pride in my academic achievements. Also, words would not justify my feelings to convey my gratitude for my father Mohammad Abdul Qayyum for his extraordinary love for education and making me realized importance of academics. His unconditional support in my studies and home makes me able to achieve my goal. He was confident about me even in times when I doubted myself. My special love goes for my mother whose determination and positive attitude towards life makes me steadfast and consistent in my endeavors. Last but not the least, I would like to thank my son, Basim, whose presence around me brightens up my spirit and motivates me to start all over again with greater zeal.

iv

Contents
1 Introduction 1.1 1.2 1.3 1.4 1.5 Energy Management Levels . . . . . . . . . . . . . . . . . . . . . . . . . . . Load Shaping Techniques in DSM . . . . . . . . . . . . . . . . . . . . . . . . Related Work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Thesis Contribution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Thesis Organization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1 3 5 6 7 8 9 9 12 13 13 15 16 20 21 29 33 33

2 Demand Response 2.1 2.2 Dynamic Pricing/Smart Pricing Signal . . . . . . . . . . . . . . . . . . . . . Dynamic Pricing for Micro-Grid . . . . . . . . . . . . . . . . . . . . . . . . .

3 Demand Side Management 3.1 3.2 3.3 Characteristics and Type of Load . . . . . . . . . . . . . . . . . . . . . . . . Central Controlling Device . . . . . . . . . . . . . . . . . . . . . . . . . . . . Sources of Energy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4 Residential Demand Response Optimization 4.1 4.2 Description of Major Home Appliances . . . . . . . . . . . . . . . . . . . . . Scheduling Home Appliances . . . . . . . . . . . . . . . . . . . . . . . . . . .

5 Appliance Scheduling Optimization Problem Formulation and Solution 5.1 Defining Problem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . v

5.2 5.3 5.4 5.5

Decision Variables . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Objective Function . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Constraints . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Mathematical Programming Approach . . . . . . . . . . . . . . . . . . . . .

34 35 37 40 46 48 53 55 58 60 65

6 Optimization of Energy Cost and Peak Load Results 6.1 6.2 6.3 6.4 6.5 Appliances Assigned to the Full Time Range . . . . . . . . . . . . . . . . . . Appliances with Fixed Time Range . . . . . . . . . . . . . . . . . . . . . . . Appliances with Mixed Time Range . . . . . . . . . . . . . . . . . . . . . . . Appliances with Fixed Time Range with PV Panel . . . . . . . . . . . . . . Appliances with Mixed Time Range with PV Panel . . . . . . . . . . . . . .

7 Conclusion and Future Work

vi

List of Figures
1.1 1.2 3.1 4.1 4.2 4.3 4.4 4.5 4.6 4.7 4.8 4.9 Contribution of various technologies to demand side management . . . . . . Possible load-shape objectives [3] . . . . . . . . . . . . . . . . . . . . . . . . Possible energy sources contributing in relying less on conventional system . Load profile of dishwasher [25] . . . . . . . . . . . . . . . . . . . . . . . . . . Load profile of cloth washer & dryer [25] . . . . . . . . . . . . . . . . . . . . Load profile of refrigerator [25] . . . . . . . . . . . . . . . . . . . . . . . . . . Load profile for air-conditioner [25] . . . . . . . . . . . . . . . . . . . . . . . Load profile for oven used in morning hours [25] . . . . . . . . . . . . . . . . Load profile for oven used in evening hours [25] . . . . . . . . . . . . . . . . Load profile for electric vehicle [29] . . . . . . . . . . . . . . . . . . . . . . . Locally generated PV panel profile [30] . . . . . . . . . . . . . . . . . . . . . HAN model for appliance scheduling . . . . . . . . . . . . . . . . . . . . . . 3 5 18 23 23 25 25 26 27 28 29 30

4.10 Representation of slots over the scale of a day with each interval of 15 minutes 31 5.1 5.2 Time of use tariff [4] . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Flow chart for scheduling of appliances for minimization of energy cost (P1) and peak load (P2) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6.1 Load pattern of appliances while minimizing peak load over full time range of slots from 1 - 96 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50 45 35

vii

6.2

Load pattern of appliances while minimizing cost of energy over full time range of 1 - 96 slots . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51

6.3

Load pattern of appliances operating on fixed time range equal to the load profile . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55 58 59

6.4 6.5 6.6

Load pattern of appliances operating on mixed time range . . . . . . . . . . Load pattern of appliances and PV generation operating on fixed time range Net load demand from the grid and PV export at minimizing energy cost in fixed time range . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

60

6.7

Load pattern of appliances and PV generation at minimizing cost in mixed time range . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62

6.8

The net load demand from the grid and PV export at minimizing energy cost in a mixed time range . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62 64

6.9

Occupancy of appliances vs time . . . . . . . . . . . . . . . . . . . . . . . . .

viii

List of Tables
2.1 2.2 3.1 5.1 6.1 6.2 Summer weekdays TOU rates applicable by Hydro One [4] . . . . . . . . . . PV panel energy selling rate . . . . . . . . . . . . . . . . . . . . . . . . . . . Different types of load . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Symbols used in problem formulation . . . . . . . . . . . . . . . . . . . . . . Range of time constraints given for appliances . . . . . . . . . . . . . . . . . Appliances starting and ending times for minimizing peak load over a full time range . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6.3 Appliances starting and ending times for minimizing cost of energy over a full time range . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6.4 6.5 6.6 6.7 6.8 Range of time constraints given for appliances in fixed range . . . . . . . . . Appliance with fixed schedule (time range = length of a load profile) . . . . Range of time constraints given for appliances in mixed range . . . . . . . . Appliances starting and ending times for mixed time range schedule . . . . . Optimized appliances starting and ending times for mixed time range schedule with micro-grid (PV panel) . . . . . . . . . . . . . . . . . . . . . . . . . . . 63 52 53 54 56 57 49 11 12 14 34 49

ix

List of Abbreviations
AC ADR AMI BMS CCD CPP DER DR DSM ECS EV FIT HAN HRES IBR kWh LPG NAN PTR PV RES RTP Air Conditioner Automatic Demand Response Automatic Meter Infrastructure Battery Management System Centralized Controlling Device Critical Peak Pricing Distributed Energy Resources Demand Response Demand Side Management Energy Consumption Scheduling Electric Vehicle Feed-In Tariff Home Area Network Hybrid Renewable Energy System Inclining Block Rate Kilo Watt Hour Liquified Petroleum Gas Neighborhood Area Network Peak Time Rebate Photovoltaic Renewable Energy Soucres Real Time Pricing

x

SSOD TOU TOUP VPP V2G WAN

Sum Square of Deviation Time of Use Time of Use pricing Variable Peal Pricing Vehicle-to-Grid Wide Area Network

xi

Chapter 1 Introduction
As per the Ontario government's Green Energy Green Economy Act (GEGEA), conserving energy not only saves money for the consumers and businesses but also lowers the demand on the electricity system and helps reduce greenhouse gas emissions [1]. Importance given to home area network (HAN) layer of smart grid gets more attention when utilities are finding ways to promote small scale renewable energy generations and ways to keep demand response in line with the supply during peak timings of usage. There are programs that are being worked upon to tie up and motivate the consumers to strictly abide with the program features, which are: 1) Making consumer well aware with the Time of Use (TOU) features and rates, 2) Effective demand response programs to help reduce the consumption during peak demand and 3) Innovative energy efficiency and cost effective programs for residential, commercial and industrial sectors and offering alternative options and incentives to consumers who cooperate with the utility and assists in demand side management (DSM). Therefore, as depicted in Figure 1.1 among the offered applications of smart grid, automatic meter infrastructure (AMI), distributed energy resources (DER), electric vehicle (EV) and storages comes under the umbrella of demand side management (DSM). Within the concept of demand-side energy management, residential energy management is recently attracting increasing interest from the research community. The traditional grid

1

has demand response programs for large-scale consumers such as industrial plants or commercial buildings; however, it does not have a similar mechanism for the residential consumers mostly due to two reasons. First, it has been hard to handle the large number of residential units without communication, sensors, and efficient automation tools. Second, the impact of demand response programs has been considered to be relatively small when compared with their implementation cost. However, in the smart grid, smart meters, low-cost sensors, smart appliances, and communications set the stage for novel residential energy management techniques that involve communications and interaction between consumers, devices, and the grid [7]. Recent advances in smart metering technology enable bidirectional communication between the utility operator and the end-users and facilitate the option of dynamic load adaptation. Toward this direction, demand-response (DR) programs provide incentives to major consumers of electricity, usually in the form of monetary rewards, to reduce their electricity consumption in peak-demand periods. DR can take place at a very fast timescale, almost real-time; it leads to a more stable power grid system and significantly reduces electricity generation cost and CO2 emissions [1].

Load balancing today occurs primarily via supply side adjustments, whereas demand side opportunities remain under-exploited. Electricity suppliers have for a long time used sophisticated methods to estimate near-future grid loads and correspondingly adapt electricity production across different sites as well as trading electricity across national borders. Direct response actions on the demand side (called peak shaving or peak clipping) have so far been largely limited to industrial customers. This approach has some limitations as some industrial processes are harder to turn on or off due to the critical and strategic processes involved and high stakes of financial repercussions. Demand response management is therefore expanding rapidly to encompass further commercial and residential; customers. In the study of dynamic demand side management, different techniques and algorithms have been proposed, where the basic idea has been to reduce the energy bill corresponding

2

Figure 1.1: Contribution of various technologies to demand side management

to the TOU and billing incentives offered by the utility [5], [6]. Consumers can also generate renewable energy, consume some portion of it locally, and sell the excess energy to the utility companies. For example, Ontario government's micro feed-in tariff (FIT) program allows home owners to sell locally generated energy [1], [2], [7].

1.1

Energy Management Levels

Theoretically, energy management in smart grid is done in three levels, each by the utility provider, aggregator and consumer respectively.

Utility Provider in WAN
Being the `first mile', the command and control of the electricity generation and distribution rests upon provider. Among the many tools available to utility provider over the large geographical area, dynamic pricing is one to communicate with the connected consumers. Utility provider depending upon energy demands announces the pricing signals and policies 3

for neighborhood area network (NAN) and home area network (HAN).

Aggregator in NAN
Residential consumers are also typically not considered as a target population for DR programs due to the energy consumption level by individual dwelling units. It is envisioned that aggregating the demand from individual residential customers will enable to expand DR programs to residential customers. Also when it comes to consumer active participation, emphasizing on individual consumer will not yield any visible difference rather going to group or community of consumers will make large impact and produce desirable results. Thus the idea of aggregator evolves which are new entities in the electricity market act as mediators / brokers between users and the utility operator. Aggregators possess the technology to perform DR and are responsible for the installation of the communication and control devices (i.e. smart meters) at end-user premises. Since each aggregator represents a significant amount of total demand in the DR market, it can negotiate on behalf of the home users with the operator more efficiently [8]. Theoretically, aggregator resides in the NAN layer of smart grid and facilitates consumer by forwarding utility information such as price-volume signals, TOU, peak demand signals and utility offered incentives. On the other hand, it conveys consumer energy pattern and, if energy saved by the consumer, it could reprofile the saved energy to be used in the high load areas of the distribution network [5].

Consumer in HAN
According to one study [32] atleast 30% of smart grid benefits will come by getting consumers engaged in the process. No technology will deliver a truly smart grid without having the consumer onboard. Smart grid means smart consumer, hence active and real time pricing information updated by the utility provider is in fact directly related to the consumer/user. HAN receives this pricing signal along with other input signals such as weather forecast and installed appliance information and delivers the best optimized plan suited for the consumer. 4

AMI resides in the HAN and makes use of smart meter (or any other centre controlling device) to act as a bridge between HAN and NAN (aggregator).

1.2

Load Shaping Techniques in DSM

Demand side management (DSM) works to reduce electricity consumption in homes, offices, and factories by continually monitoring and actively managing how appliances consume energy. It consists of DR programs, smart meters, dynamic electricity pricing, smart buildings with smart appliances, and energy dashboards. DSM manipulates residential electricity usage to reduce cost by altering the system load shape. Common techniques used for load shaping are [3]:

Figure 1.2: Possible load-shape objectives [3]

1. Peak Clipping: Reduction of grid load mainly during peak demand periods. 2. Valley Filling: Improvement of system load factors by increasing load during off-peak periods. 5

3. Load Shifting: Reduction of grid load during peak demand and simultaneously building load across off-peak periods. 4. Conservation: Reducing the load throughout the day by utilizing more energy efficient appliances or by reducing overall consumption. 5. Load building: Increasing the load throughout the day by increasing the overall consumption. 6. Flexible load shape: Specific contracts and tariffs with the possibility of flexibly controlling consumer's equipment.

1.3

Related Work

In [7], an linear programming model is proposed to minimized the total cost of electricity usage at home. Four appliances were considered for comparing two optimization algorithms. Optimization based residential energy management (OREM) was developed using external solver IBM CPLEX. Results obtained lacks near to real scenario based on appliances input data used. In the study average consumption value for complete operating cycle of an appliance is assumed. Therefore, averaging the energy consumption of an appliance directly effects the robustness of results. Similarly [5] discusses a model in which objective function encompasses three different criteria's; cost minimization, maximization of scheduling preferences and maximization of climatic comfort. A mathematical programming problem is defined using a weighted objective function base upon the importance given by the user. Since the computational complexity of the problem is NP-hard, an heuristic algorithm (implemented in Java) has been proposed to derive suboptimal solutions within a limited computational time. As such demand side management is closely related to mathematical programming and optimization of electrical appliances wit in the home. Among the various proposed algorithms

6

linear programming (LP) and convex programming (CP) algorithms are very efficient because of the generated solution in polynomial time and optimality of results. In [11], optimization of scheduled based appliances for a single home is done using convex programming framework. Since the on/off status of appliances can be gauge by the binary decision variables. By relaxing decision variables from integer to continuous values, the mixed integer linear problem can be formulated as a new convex programming problem.

1.4

Thesis Contribution

The key contributions of this thesis can be summarized in the following points: · We investigated the problem of scheduling of smart appliances operations in a given time range with set of energy sources like national grid and local generation micro-grid. We formulated this problem as a dual objective functions problem. The first objective minimizes total energy cost and the second objective minimizes the peak load of all the home appliances used in a day. · We proposed a solution based on the mixed integer linear programming technique. We used MATLAB with Yalmip library to exploit the state-of-the-art GUROBI solver for obtaining the timing of appliance scheduling in the smart home. · We evaluated the performance of a residential energy model and optimized the performance of different types of load associated within. Unlike existing literature, we took into consideration real load profiles of the appliances and generated a plan meeting all the time and energy constraints given by the user. · We specifically generated starting and ending times of the appliances that indicated the net import and export of energies to meet the demand of the home area network. · Our proposed solution can be used for generating appliance scheduling plan in comparable time to be true as a real time process for demand side management. 7

1.5

Thesis Organization

This thesis is organized as follows: In chapter 2, description of demand response and various pricing signal used by utility companies to maneuver consumer pattern of energy consumption are discussed. In chapter 3, components that are necessary for the effective implementation of demand side management are discussed. Characterization of different types of load, different sources of energy utilized by a smart home and module to efficiently carry out the optimization and utility driven instructions are explained. In chapter 4, the residential appliances considered in a HAN for the optimization algorithm are elaborated. Load vector of each appliance used as well as photo-voltaic (PV) panel are shown. In chapter 5, we outline in detail the system model used in this study. Thesis optimization model is explained and various consideration taken during the course of execution of problem are briefed. In chapter 6, we present the results under different scenarios, showing minimization of peak load and energy cost with and without the availability of micro-grid photo-voltaic panel. In chapter 7, we conclude the thesis with a highlight on the important results and their interpretation. Also, possible future work is presented in this chapter.

8

Chapter 2 Demand Response
Demand Response (DR) is a term used for programs designed to encourage end-users to make short-term reductions in energy demand in response to a price signal from the electricity hourly market, or a trigger initiated by the electricity grid operator. There are two ways by which utility energy companies can maneuver the demand response in line with the generation and supply of energy. One approach is direct load control in which there is an agreement between consumer and the utility or an aggregator to directly control the operation of appliances to shift or shed the load. The second approach is to go for the dynamic smart pricing, where users are encouraged to individually and voluntarily manage their loads and offer incentives in terms of rebate or tariff for adjusting the load pattern as the way utility company wants the consumer to do it [12].

2.1

Dynamic Pricing/Smart Pricing Signal

In the traditional electrical network, the energy price is fixed. Users are not interested in how they use energy, any way they do it they always pay the same, so they do it in the most convenient way. Introducing a dynamic pricing would make the users aware of ways to use energy: the simplest way is to divide the tariff on the basis of identifying the high load time periods and low load time periods which is actually used by Hydro One in Ontario, e.g., 9

the Time-of-Use (TOU) pricing tariff differentiates the price in peak hours and non-peak hours. This way, the users are encouraged to use some of their appliances when energy is less expensive. Of course some activities need to be done at fixed time, e.g., users will likely continue to use the electric stove at lunch and dinner time, but some other activities will be shifted, for instance, users may decide to do the laundry or charging of electric vehicle (EV) at late evening. Dynamic pricing stands to change the way energy is delivered around the world, bringing bottom line benefits in the present and advancing a smarter grid long term. The main purpose for dynamic pricing is to smoothen the energy demand curve by shaving the peaks and filling the valleys. The development of customer cost-rate plans can be sub-divided into, i) Critical Peak Pricing, ii) TOU Pricing, iii) Peak-Time Rebate (PTR), and iv) Real Time Pricing (RTP) [13]. A smart grid communication network permits automatic meter reading at scheduled intervals during which the utilities can provide time and demand-based pricing including the following:

Time of Use Pricing (TOUP)
In TOU pricing, the rate of electricity varies in on-peak, mid-peak and off-peak hours. For example, during peak hours, the load on the grid becomes higher than the base load. Since it is not feasible for a power plant to generate power at the peak load level and store it when the load is lower, peaker plants are used to accommodate the peak load. To compensate the costs of peak generation, the price of electricity becomes higher in the peak hours [9]. We have used TOU pricing rates from [4] for all the energy cost calculations presented in this thesis as shown in Table 2.1.

Critical Peak Pricing (CPP)
In CPP, utilities can communicate pricing changes to consumers at spikes in high peak demand time brackets. Critical peak prices are assessed for certain hours on event days 10

Table 2.1: Summer weekdays TOU rates applicable by Hydro One [4] Sr.No Time TOU Price in cents per kWh 1 2 3 4 07:00PM to 07:00AM OFF Peak 07:00AM to 11:00AM MID Peak 11:00AM to 05:00PM ON Peak 05:00PM to 07:00PM MID Peak 7.5 11.2 13.5 11.2

(often limited to 10-15 per year). Sometimes it is combined with TOU rate, and prices can be 3-10 times as much during these few critical high demand hours [14].

Peak Time Rebate (PTR)
A variant of CPP is peak time rebate (PTR), in which the standard rate applies at all hours but customers can earn a rebate by reducing usage during the critical peak hours [13].

Real Time Pricing (RTP)
Real-time pricing (RTP) is specified at regular interval based on, say, the wholesale market rates. Pricing rates generally apply to usage on an hourly basis [11].

Variable Peak Pricing (VPP)
The price during the critical peak hours is based on real-time conditions, yielding variable peak pricing (VPP). It is the hybrid of CPP and RTP [13].

Inclining Block rate (IBR)
Here in IBR, the marginal price increases by the total quantity of consumed energy. That is, beyond a certain threshold in the total monthly/daily/hourly residential load, the electricity price will increase to a higher value. This creates incentives for end-users to conserve or distribute their load over different times of the day in order to avoid paying for electricity at higher rates. In addition, IBR helps in load balancing and reducing the peak-to-average 11

ratio (PAR). In Canada, the British Columbia Hydro Company currently uses a 2-level conservation rate structure with 40% higher prices at the second level [26].

2.2

Dynamic Pricing for Micro-Grid

The above mentioned types of dynamic pricing are all for influencing customer's demand response pattern to get the power from the national grid. However, with the recent growth of micro-grid infrastructure and installation, there was a need of another type of pricing model related to customers who act as energy producers. At any point in time, consumers in excess of energy that is locally produced by renewable energy sources (RES) can feed to the system for sale, then the pricing model would be entirely different. The feed-in tariff (FIT) program was launched in 2009 as part of the Ontario government's effort to increase renewable energy in the province. For generation of electricity under 10kW, the FIT program has a small scale program called micro-fit for homeowners to develop a small or "micro" RES generation project (10 kilowatts (kW) or less in size) on their property [2]. The benefits of Table 2.2: PV panel energy selling rate PV Panel Type Price per kWh PV Panel capacity Rooftop 39.617 cents 3 kilowatts

Sr. No 1

micro-fit include getting paid for the power one produces, with prices that are designed to cover the costs of a typical project and allow one to earn a reasonable rate of return on their investment over the term of the contract. Also contributing towards a healthier environment by utilizing renewable energy sources such as wind, solar, water etc. Pricing model used in the research for exporting the excess energy is shown in Table 2.2.

12

Chapter 3 Demand Side Management
3.1 Characteristics and Type of Load

In residential energy management system, scheduling of different types of load can only be realized after having complete data of load type and their characteristics including cycle durations, energy consumed in every mode. In a particular home area network (HAN), load may include: · Appliances · Electric vehicle (EV) · Energy storage devices or battery management system (BMS). Appliance load can be further sub-categorized into manageable and non-manageable loads as shown in Table 3.1. Mostly in the literature of energy management system, it is a manageable load which has all the focus mainly because of its high energy consumption and predictability in its operation. In [5] and [15], manageable load has been further categorized as: 1. Shiftable load (flexible delay having certain consumption cycle with specified energy consumption profile). 13

2. Interruptible load (for example, water heater and refrigerator they are either ON with fixed energy consumption or OFF. However, their ON cycle duration depends upon user preference setting). 3. Weather based load (such as air conditioner and electric heaters which depend upon weather and power absorption of premises).

Table 3.1: Different types of load Sr. No Category Type of Load Home Appliance 1 Manageable Shiftable Washing Machine, Dish Washer 2 Manageable Interruptible Water heater, Refrigerator 3 Manageable Weather Based Air Conditioner, Electric Heater 4 Non-manageable Auxiliary TV, laptops, lights

Also electric vehicle (EV) and batteries for energy storage depending upon their operation act as load as well as energy source in distributed energy resources (DER). New emerging class of appliances such as electric vehicles (EV) have both delay and power consumption flexibility [15]. As long as the EV battery is charged above a certain level, it can serve as the energy source during peak load hours to avoid dependence on the traditional grid by the concept of vehicle-to-grid (V2G) [10]. But V2G comes with a few challenges as charging them currently takes a while (30 minutes to a few hours), charging can add considerably to a home's overall electricity use, and when scaled up to thousands or millions of homes then charging places a lot of extra demand on an electrical grid [16]. In [11], alongside the above appliance type, the authors have considered battery-assisted appliances which refer to the class of appliances where an internal battery is equipped. The advantages of which include their ability to offer additional energy source during the peak hours and hence more efficient use of the overall energy. Response of renewable energy source (RES) does not depend upon energy demand rather on energy factor. Therefore, energy storage systems are required to avoid wasting the fraction of the produced energy which is not immediately used. Therefore, the problem of energy 14

storage becomes more and more crucial as its development may increase the diffusion, the effectiveness and the profitableness of renewable energy plants. Actually, the main problem of the RES plants is that electricity generation cannot be fully forecast and does not usually match the demand pattern over time. This is the case, for example, of a wind farm where, in relation to a certain (future) time horizon, the energy produced depends on the wind speed, whose prediction is clearly affected by uncertainty [17], which necessitates the need of energy storage medium (batteries). While battery technology is growing very quickly with higher power and energy densities, it is equally important to improve the performance of the battery management system (BMS) to make the battery system a safer, more reliable and cost-efficient solution. The specific characteristics and needs of smart grid, as well as electric vehicles (EVs), intensify the need for a more effective BMS [18].

3.2

Central Controlling Device

Another unit which is mandatory in load scheduling and connectivity with renewable energy generation units or smart devices within the network, is some kind of centrally installed intelligent device. For example, mentioned as energy box (eBox) [5], master energy controller (MEC) [6], smart device controller (SDC) [10] and building energy management controller (BEMC) [15]. Although the flexibility associated with appliances and time varying prices can achieve tangible benefits for customers, current residential load control activities are mainly operated manually, which posts great challenges to customers in optimally scheduling the operations of their appliances. Some customers may not have time to make such scheduling decisions and if prices vary fast and frequently, scheduling may be too complex. Hence, an intelligent centrally located automated device is necessary to optimize the appliances and load operation on behalf of customers, in [15] it is automated building energy management controller (BEMC). Energy box referred in [5] considers to have a computing ability and must have

15

the optimization and control module. eBox does the computation keeping in mind all the parameters and demands consumers to strictly adhere to the suggested pattern. In [6], the implementation of the intelligent residential energy manager is done through a master energy controller (MEC). The personalized home energy management system seamlessly manages all configurations at the customer-end to control various home appliances either remotely or locally through the MEC. At each residential unit in HAN, as outlined in [10], smart device controller (SDC) coordinates the energy demand and supply processes based on a communication infrastructure that can detect energy demand of the load associated within the HAN and check the availability of supply to address the demand.

Functions of Central Controlling Device (CCD)
Other than the appliance load, these centrally controlling units are also responsible for gathering information from: 1. Aggregator for the utility instructions, TOU and incentives. 2. User for selecting and opting for comfort choices. 3. Home temperature monitor for regulating home temperatures. 4. Weather forecast for anticipating advance thermal demands. 5. Checking renewable energy sources (RES) or micro-grid for detecting available energy scale to meet current demand.

3.3

Sources of Energy

Demand side management (DSM) techniques such as demand dispatch provide round-theclock deployment and assessment, thereby providing a qualitative approach to balancing energy generation and load for the electric grid. DSM plays a vital role in facilitating 16

greater connection of intermittent renewable generation [19]. The future of the overall energy scenario will constitute the increased utilization of small distributed energy resources for generating electricity [20]. With the increasing growth of small scale renewable energy generation units into the residential domain, consumer is becoming self-sufficient with the sources of energy for its local use. The energy may be provided to the user from four possible sources: 1. Traditional power grid (utility provider) 2. Distributed energy resources or micro-grid (a) Renewable energy sources (local energy generation from wind / solar or water turbines) (b) Electric vehicle batteries using V2G concept or from available battery management system (c) Any commodity with in neighborhood area network willing to sell energy

Distributed Energy Resources (DER)
One of the key promises of the smart grid is better and more uniform integration of distributed energy resources (DER) into the grid, most notably on-grid renewable energy sources (RES). Also moving from traditional one-way communication and energy flow to two-way flow, infrastructure requires robustness and stability. In some areas, RES are already working and experiencing tremendous growth. DER, however, extends beyond renewable energy (wind/solar), and may include electric vehicle batteries, combined heat and power (CHP), un-interruptible power supplies (UPS), utility-scale energy storage (USES) and community energy storage (CES). It is also an option that household would start generating power for their own use by solar or wind turbines, and if they generate in excess they have the option to sell back to the utilities, which in turn will disseminate the energy towards high load regions.

17

Figure 3.1: Possible energy sources contributing in relying less on conventional system

While the focus is often on these smaller-scale applications, the control of larger distributed generation sites, for example, commercial-scale wind turbine farms, will also require new communications to tie them into existing communications systems, as they are often located in remote locations, far from existing utility infrastructure. A typical micro-grid for buildings integrates the operation of electrical and thermal energy supply and demand. The supply may include energy sources from distribution grid, autonomous power generators such as fuel cells, combined heat and power (CHP) systems, renewable energy sources such as PV solar panels and wind powers, and energy storage devices such as batteries and water tanks [21]. The combination of these energy sources in different patterns result in multiple designs of hybrid renewable energy systems (HRES). As depicted in Figure 3.1, this system technology can be generalized as a system that utilizes energy from both conventional and renewable sources. In comparison to conventional power systems, HRES reduces fuel consumption and emissions thereby making the system cost-effective, green, and highly reliable in terms

18

of producing power. Utilizing renewable energy sources is the first step towards becoming energy aware and relying less on the traditional power grid and exploiting the use of batteries and electric vehicle during peak load hours [10], [17].

19

Chapter 4 Residential Demand Response Optimization
Recent studies [22], [26], [29] have shown that despite several advantages of various advanced pricing techniques, the lack of knowledge among the end users about how to respond to time varying prices and the lack of effective home automation systems are the two major barriers for not fully utilizing the benefits of these indirect demand side management programs. The fact is most of the current residential load control activities are carried out manually. This makes it inefficient for the users to optimally schedule the operation of their appliances in response to the pricing signal they may receive from the aggregator or utility provider in an advanced demand-side management program. In order to let the users participate in the demand response (DR) program and maneuver their consumption pattern through pricing signal, studies have suggested employing automated household energy management strategies. This can be done using different approaches, for example, via the Internet, where software on a PC can manage the household's energy consumption. Consider a scenario where automated energy consumption scheduling is done at smart meters as part of an advanced metering system (or advanced metering infrastructure, AMI). Also hypothesis is made here that all the home electric devices (appliances) are smart appliances where imme-

20

diately after powered on and connection to the HAN, they will exchange their handshake signals with the centralized controlling device (CCD). Here, a smart meter can also serve the same purpose, where smart meter is assumed to be equipped with an automated energy consumption scheduling (ECS) function and all the appliance operating features in terms of operation cycle, power consumption and energy ID will get through the HAN to NAN and finally to the national grid (WAN). The CCD function is programmed based on the user's energy consumption needs, then it automatically controls the operation of various appliances such as the batteries of electric vehicles, washer, dryer and dish washer. Residential consumers are also typically not considered as a target population for DR programs due to the energy consumption level by individual dwelling units. It is envisioned that aggregating the demand from individual residential customers will enable to expand the DR programs to residential customers. Available DR optimization schemes are implemented through either incentive based rates or time based rates [11]. Time-of-Use (TOU) pricing has been shown to have a significant influence on ensuring a stable and optimal operation of a power system. By implementing a closed-loop integrated solution, customer participation in DR programs can be increased and thus, the cost of energy production can be controlled. The net result of this can be presented as a pricing policy that maximizes the benefit to the user. A residential customer's daily activities are characterized by a list of tasks to be scheduled at preferred time intervals. Some of these tasks are persistent, as they consume electricity throughout the day (for example, refrigerator); others can be scheduled according to the user-specified constraints and the pricing offered by the utility company to achieve cost savings and peak demand reduction [6].

4.1

Description of Major Home Appliances

In this thesis, for the purpose of load profiles of appliances, a mid-size home is considered with the following major electricity consuming appliances in any working day of a week

21

in a summer season. The home also has on-grid photo voltaic (PV) panels for electricity generation. Heating of water and home, if required, is done through oil or liquified petroleum gas (LPG) as it is practised in many parts of North America. It is known that different appliances have definite timing of completion of their cycles and thus have definite power consumption vector which can be ascertained either from the appliance specifications or measuring demand experimentally at equal time intervals till the completion of cycles. We have adopted the power vectors of the appliances from a study done at Virginia Tech., Advance Research Institute [25]. The time-dependant power assignments are called load profiles. Appliances with major contribution in terms of energy consumptions such as dishwasher, washing machine with dryer, refrigerators, air conditioners and electric vehicle, are considered in our model to study their demand response and optimize their operation over a period of time to minimize the total energy cost and level the load curve.

Dishwasher
The dishwasher has three main operating cycles: wash, rinse and dry and it takes approximately 105 minutes to complete all the cycles on average. During the working of 1.75 hours of dish washer, load varies from maximum 1.2 kW to minimum 0.6 kW as shown in Figure 4.1. The energy consumption is about 1.44 kWh for one complete cycle of dishwasher. Dishwasher is classified in category of shiftable load.

Cloth Washer and Dryer, Working in Tandem
This is a case of two appliances working in sequence. Cloth washing machine precedes the dryer. Cloth washing machine like dishwasher has three cycles of operation: wash, rinse and spin which takes 45 minutes to complete all the cycles. The power load varies between 0.52 kW to 0.65 kW. Then after lapse of 15 minutes, dryer starts which takes 60 minutes to dry the clothes. The load of dryer varies from 2.97 kW to 0.19 kW. New types of washing 22

1-Dishwasher Load Profile 2 1.8 1.6 1.4 1.2

kW

1 0.8 0.6 0.4 0.2 0 0 1 2 3 4 5 6 Time: 1unit=15 Mnts 7 8 9

Figure 4.1: Load profile of dishwasher [25]

2-Cloth washer & Dryer Load Profile 4 3.5 3 2.5 2

kW

1.5 1 0.5 0 -0.5 -1 1 2 3 4 5 6 7 Time: 1unit=15 Mnts 8 9 10

Figure 4.2: Load profile of cloth washer & dryer [25]

23

machines with combined dryers started to arrive in markets recently. Such machines are also called washer and dryer combo that do not need human interaction to put the cloths in dryer after washing. Clothes are washed and dried in one tumbler. To emulate the load profile of such machine, the load profile of clothes washing machine and dryer combined to ensure that dryer will start after the end of washing machine and the profile is shown in Figure 4.2. The energy consumption of the combined appliances is 2.68 kWh per operation. Cloth washing machine and dryer are classified in the category of shiftable load.

Refrigerator, 15.6-cuft with Top Freezer
Refrigerator falls in the category of appliances which works 24 hours a day, continuously. The only time compressor rests when inside temperature is lower or equal to the set temperature of the refrigerator. The compressor also rests when defrost heating starts. The load profile of the refrigerator is shown in Figure 4.3, which is marked by spikes at regular intervals reaching 0.37 kW, is due to defrosting of the refrigerator. The maximum and minimum load during the operation of the refrigerator is 0.37 kW and 0 kW respectively. The electricity energy consumption is 3.43 kWh/day. Refrigerator is classified as continuous non-shiftable load (also interruptible load).

Central Air-conditioner (AC)
The load profile of the central air-conditioner (AC) is shown in Figure 4.4 which resembles like a series of square wave train showing peak load of 2.75 kW when compressor of AC is working and, 0.25 kW when the compressor is off. This occurs when inside room temperature is equal or below the set room temperature. However, air fan continues to work for circulation of air. The energy consumption of 2.5-ton AC is around 31.15 kWh per day. AC is classified as continuous non-shiftable load with sub-classification as weather based load.

24

3-Refrigerator Load Profile 0.4 0.35 0.3 0.25 0.2

kW

0.15 0.1 0.05 0 -0.05 0 20 40 60 Time: 1unit=15 Mnts 80 100

Figure 4.3: Load profile of refrigerator [25]

4-A/C-2.5T Load Profile 3

2.5

2

kW

1.5

1

0.5

0

0

20

40 60 Time: Each slot of 15 Mnts

80

100

Figure 4.4: Load profile for air-conditioner [25]

25

5-Oven-1 for Morn. Load Profile 1.5 1.4 1.3 1.2 1.1

kW

1 0.9 0.8 0.7 0.6 0.5 0 0.5 1 1.5 2 Time: 1unit=15 Mnts 2.5 3 3.5

Figure 4.5: Load profile for oven used in morning hours [25]

Oven for Morning
The use of cooking ovens falls into the category of appliances which are used more than once in a day. For instance, an oven used in the morning and in the evening can be treated as two separate appliances. The use of oven in the morning is of short duration and usually finishes in 30 minutes. The load varies from 1.28 kW to 0.83 kW as shown in Figure 4.5. The electricity consumption is estimated to be 0.53 kWh. Oven is considered as shiftable load to user specified time preference.

Oven for Evening
The use of oven in evening is extended and usually two burners are used. The evening oven runs for 1.5 hours, during which times the load varies between 2.35 kW and 0.75 kW as shown in Figure 4.6. The electricity consumption is 1.72 kWh.

26

6-Oven-2 for Evening Load Profile 2.5

2

kW

1.5

1

0.5

0

1

2

3 4 5 Time: 1unit=15 Mnts.

6

7

8

Figure 4.6: Load profile for oven used in evening hours [25]

Electrical Vehicle (EV)
Electrical vehicles are slowly gaining popularity and automobile manufacturers are producing hybrid vehicles which work both on gas and electric batteries. The batteries are charged through home electricity. The EV takes 2.5 hours to charge fully at a constant 3 kW load and immediately tapers off to zero. The consumption of EV is estimated to be 7.50 kWh. EV is considered as shiftable load to user preference time when TOU tariff is the lowest like between 7 PM to 7 AM. The load vector for EV used in this thesis model is taken from the data used in the publication [29] and shown in Figure 4.7.

Micro-Grid
With the advent of smart grid and smart meters, installation of local energy generation (micro-grid) and its integration with national grid has become possible. Consequently, recording of import and export of energy flow to a home is realizable. For the purpose of this thesis, we have considered a micro-grid of 3kW photo-voltaic (PV)/solar panel system with on grid connection in which direct current produced by PV 27

7-Electric Vehicale (EV) Load Profile 4

3.5

3

kW

2.5

2

1.5

1

0

2

4

6 8 Time: 1unit=15 Mnts

10

12

Figure 4.7: Load profile for electric vehicle [29]

panels is directly converted to alternating current (as per national AC standards) by smart inverters and fed into a home's existing wiring after proper synchronization of the two network frequencies. On grid connection means that PV panels are connected to the national grid. The expensive backup battery packs are omitted. The grid becomes a backup system when the sun is not shining or when the home uses more electricity than PV panels can produce. Electricity generated by the PV system will be consumed in home. If during any instance of time, PV produced electricity is more than the demand of home, the surplus electricity will be exported to the national grid. Also when electricity produced by PV is less than the demand of the home, the balance electricity will be imported from the national grid. Power profile of a typical 3kW solar panel is shown in Figure 4.8, according to which power varies from 2.9 kW to 0 and energy production on sunny day is 23.11 kWh.

28

8-Photo Voltaic(PV) Generation Profile 3 2.5 2
kW

Curve showing Power Generation in typical Summer Day

1.5 1 0.5 0 0 10 20 30 40 50 60 Time: 1unit=15 Mnts. 70 80 90 100

Figure 4.8: Locally generated PV panel profile [30]

Other Appliances
There are appliances that are in home use such as TV, lights, clock, phones, computers etc. Their loads compared to the major load discussed above are insignificant and not power consuming. Moreover, these appliances are interactive and have little scheduling flexibilities.

4.2

Scheduling Home Appliances

Cumulative load demand of appliances depend how they are scheduled (used) over the time. For example, if all appliances start at the same time, the coincident demand could be very high to surpass the maximum limits imposed by the electricity distributers and sometimes adversely affect the home electrical system. Therefore, the appliance use should be spread properly over the time to keep the peak demand to minimum and also usage cost of electricity to minimum and yet comfort is not sacrificed. Figure 4.9 shows the proposed configuration of appliances and micro-grid linked to the central controlling device or smart meter (futuristic model of smart meter will eventually include the schedule optimization module) for convenient operation of appliances to avoid high energy cost. 29

Figure 4.9: HAN model for appliance scheduling

To define the scheduling of home appliance load as to when appliances start and end (called appliance window) in 24-hour time scale in a day, we define the following terms:

Set of Appliances
The set of electrical appliances used in the home is represented by A. Then, A= {dishwasher, cloth washer and dryer, refrigerator, AC, oven-1, oven-2, EV, PV panels}. In this case i denotes the index of the appliance shown in the set A.

Duration of Operation
A day of 24 hours is divided into 96 time slots. Thus each time slot represents an interval of 15 minutes. The appliances can be set to start at any time within this time frame and end its cycle of operation before or on 96th time slot; surely not later this time. All the time slots are represented by their starting times. The end time of slot will be obtained by adding 15 minutes to the starting time. For example, for the time slot 2, the starting time is 06:15AM and ends at 06:30AM. The same is illustrated in the Figure 4.10.

30

Figure 4.10: Representation of slots over the scale of a day with each interval of 15 minutes

Execution Window of each Operation
Appliances must start in a user-specified window. Therefore, users specify a desired execution window for each appliance i.e., the interval when the appliance can run. More precisely, for each appliance, there is a minimal starting time (before that it cannot start), and a maximal ending time (by then it has to be finished). For instance, if user comes home at 05:00PM and wants to end dinner not later than 08:30PM, then the oven may be scheduled on any time after 05:15PM and has to finish by 07:45PM. We limit the case where each appliance is executed exactly once during the day, no re-use or skip is taken into consideration. This is not a limitation as explained below: 1. If an appliance should run twice or more, it is enough to introduce two or more identical appliances with non-overlapping execution windows. 2. If an appliance should not run during a day, it is enough to set its length to zero. The scheduler is free to switch on the appliances on any time as long as it respects the starting and ending time constraints within the range.

Load Phases of Appliances
An appliance operation process follows a load profile, comprising a set of sequential load phases. For example, when i = 1, load profile of dishwasher in kW is [1.2, 1.2, 0.2, 1.1,

31

0.68, 0.8, 0.6] spaced at 15 minutes apart and it has 7 load phases. The whole cycle of dishwashing takes 105 minutes. The dishwasher has three sub-cycles: wash, rinse and dry which is carried sequentially in that order. The first 45 minutes associated with wash cycle, next 30 minutes for rinse and the remaining 30 minutes are spent in washing. A load phase is, therefore, un-interruptible. It means that once an appliance is started, it should continue to work till it is finished. The load phases are sequential, because the next appliance sub-task cannot begin until the previous sub-task is completed. While all load phases associated with an appliance must run serially, there can be delays between the load phases as long as the energy phase ordering is preserved (e.g. the washing machine agitator must start within 5 minutes after filling of basin). There can be additional inter-appliance operational constraints. A certain appliance cannot start before some other appliance finishes. (e.g. dryer cannot start before completion of washing). More importantly, due to safety reasons, the sum total of loads of all the appliances at any point of time cannot exceed a pre-defined peak load. Finally, there can be user specific time preferences that certain appliances must run within desired time interval (e.g. operating dishwasher between 04:00PM to 06:00PM). To put the appliance load phases in operation with operational constraints, the appliance's scheduler determines the load assignments, as a function of time in a day with the objective to find the least energy cost of the appliances and/or a flat demand curve (minimizing peak load). While we focus on minimizing the total cost in a fully dynamic pricing policy scenario, global flat demand curve is achieved as a side effect, since prices rise during peak hours and fall during valley hours. The question remains how to minimize the cost of electricity and peak load under certain constraints with appliance scheduling in deterministic way as realistic as possible. Hence, simplified analytical and linear programming based tools are not sufficient. We intentionally explore the modeling power of mixed integer linear programming (MILP) which is explained in the next chapter.

32

Chapter 5 Appliance Scheduling Optimization Problem Formulation and Solution
In this chapter, appliance scheduling is formulated using MILP technique for which use of decision variable and auxiliary binary decision variables are defined and applied. YALMIP, an extension to MATLAB, is used to interface with GUROBI solver for obtaining optimized scheduling of appliances for minimizing peak load and cost of energy.

5.1

Defining Problem

The appliance execution period of 24 hours is considered here which is divided into m = 96 time slots of 15 minutes each. The set of number of appliances for scheduling are denoted by N and their corresponding number of set of un-interruptible load profile for each appliance is denoted by ni for i = 1, 2, 3, .........N. If a single oven is to be used on more than one occasion at different times, it will be treated as differently like oven-1 and oven-2, with the same load profile or different. We are now equipped to define appliance use by name (having its fixed corresponding load profile),
k that is number of load phases j in use of appliance i during time slot k. Therefore, Pij

represents load variable assigned to an appliance i having load phase j during time slot 33

k. Table 5.1 defines the symbols and notations used in the entire thesis for the purpose of problem formulation. Table 5.1: Symbols used in problem formulation Symbol Definition i Index of appliance to be scheduled Time slot over a given period of a day k j Index of number of load phases associated with in each appliance ni Set of number of un-interruptible load phases associated with each appliance i N Set of number of appliances for scheduling m Maximum number of time slot available in a day k Pij Load variable assigned to an appliance i, having load phase j during time slot k k C Tariff in dollars in the time slot k k Xij A binary decision variable with value 1, if ith appliance with load phase j in the time slot k is processed; otherwise 0.

5.2

Decision Variables

k The typical unit for Pij is kW, but when this is multiplied by a factor of (15/60=0.25), k its unit will be changed into kWh. The load profiles Pij are real (i.e., continuous) decision k variables. In addition to Pij we need the support of auxiliary binary decision variable to

indicate whether a particular load profile is being processed or not. Binary decision variables
k k is denoted by Xij  {0,1}. Xij = 1, if an appliance i and its load phase j is being processed k during the time slot k, otherwise Xij = 0. It can be, alternatively, stated that in the time k interval of operation of appliances in their respective windows, the binary variable Xij =1 k and beyond the window, it is Xij = 0. Similarly, we can introduce other auxiliary binary k variable Sij = 1 indicating an appliance i, load phase j is already finished by time slot k. It

34

9-Electricity TOU Tariff 0.2 0.18 0.16 0.14 0.12
$/KwH

ON Peak MID Peak

OFF Peak 0.1 0.08 0.06 0.04 0.02 0 0 10 20 30 40 50 60 Time: 1unit=15 Mnts 70 80 90 100

Figure 5.1: Time of use tariff [4]

k k means Xij and Sij are complementary. i.e.,

k k Xij + Sij =1

(5.1)

k k It means that either binary variables Xij = 1 or Sij = 1, not both could be 1.

5.3

Objective Function

The first objective of the load scheduler is to minimize the total electricity cost for operating the appliances based on 24-hours ahead TOU electricity tariff. The tariff curve applicable in this case is shown in Figure 5.1 (taken from Hydro One Ontario [4]). Let C k denote electricity TOU tariff for time slot k. Then the total cost of electricity consumption function fC is given by the following equation:
m N ni k k Pij Xij i=1 j =1

P 1A :

fC = min
X k =1

C

k

(5.2)

k Pij represents continuous decision variable which is used to indicate the load assigned to

35

phase j of appliance i during time slot k. Once first load phase starts it will sequentially
k complete all the phases, un-interruptedly. The corresponding auxiliary binary variable Xij k  {0,1} is used with Pij as on/off switch to estimate the time slot k, when the appliance first

phase starts till all its load phases end. The appliance will start once in the time scale and
k will not restart again. Therefore, optimization will be on binary variable Xij for all values

of {i, j, k } of which appliance i and its load phases (load profile) j are known and only k is unknown. This will provide optimal layout of appliances with their respective start and end slot time with the objective to minimize energy cost in TOU tariff and to minimize and level peak demand of the appliances by using equation (5.2), (5.3) and (5.4). The above equation (5.2) has a different variant if micro-grid (G) is added:
m N ni k k k C k Pij Xij - g k Gk ij Xij k =1 i=1 j =1

P 1B :

fC = min
X

(5.3)

where C and g represent TOU tariff and feed-in tariff. Gk ij is the power produced by PV panel consisting of different phases j at time k. As micro-grid component in the objective function is constant as it has only assigned fixed possible starting and ending time. The optimization will be achieved through appliance scheduling only. The PV profile will be superimposed on the demand curve of the appliances. It makes easy to determine time-wise usage of power either to supplement appliance demand to reduce load or export power where possible, when PV supply load is more than the appliances demand. The second objective is to minimize the maximum peak load function fL of the home
m N ni k k Pij Xij k =1 i=1 j =1 2

P2 :

fL = min
X

-q

(5.4)

36

where q is the average load of all the appliances considered and is given by equation (5.5).

1 4

N i=1

ni j =1 Pij

q=

24

(5.5)

Here Pij is the variable to indicate assigned load of appliance i having phase j. This infact translates to minimizing the sum of squared of deviation (SSOD) from the average value of the appliances load. SSOD is a measure of leveling effect in the load demand curve. The squared of deviation from the average results lower and higher peaks to higher deviation values. When the peaks in the demand pattern decrease and the gaps are filled, SSOD of the load curve will reduce. It is always better to achieve lower values of SSOD showing better leveling in the demand curve.

5.4

Constraints

The constraints are grouped into energy constraints and timing constraints.

Energy constraints
To make sure that load phases of appliances fulfill their energy requirements, the following constraint is imposed: 1 4
m k Pij k =1

= Eij

 {i, j }

(5.6)

where Eij is the energy requirement for appliance i with load phase j and m is the available time slots in a day (in our case m = 96). These are technical specifications from the appliances. Time interval of load profile readings is 15 minutes each (=0.25hr). The load safety constraint puts upper limit to the peak coincident load demand of all appliances not exceeding a certain pre-defined limit  .

37

N

ni k Pij  k

 {k }

(5.7)

i=1 j =1

The peak signal  is provided by the grid operator, which is a demand response signal.

Timing constraints
Un-interruptible operation A load phase being un-interruptible means that it cannot be resumed again once it is started and completed its operation. Then this situation can be modeled by the constraint that,
k for all i and j, Xij = 0. This can also be explained by the following auxiliary constraint

equations.
k k Xij + Sij  1

 {i, j, k }

(5.8)

k If Sij = 1, then at time = k, load phase j in appliance i is already finished. Hence k k k corresponding Xij =0. The condition triggering Sij = 1 is that Xij switches from 1 to 0,

i.e., the load profile just finished. This situation is shown as:

k -1 k k Xij - Xij  Sij

 {i, j },  {k = 2, 3, 4, .......m}

(5.9)

Also the constraint
k -1 k Sij  Sij

 {i, j },  {k = 2, 3, 4, .......m}

(5.10)

where m is the number of available time slots in a day (in our case m = 96). This means
k that Sij should remain unity.

38

Sequential processing Sequential processing of load phases in a load profile of an appliance means that a load phase cannot start unless its preceding phases have finished. This requirement can be described
k using the auxiliary decision variable Sij as follows:

k Xij  Sik(j -1)

 {i, j },  {k = 2, 3, 4, .......m}

(5.11)

User time preferences The appliance user can setup the time preference constraints specifying the time interval an appliance must be finished within. It means that appliance cannot be run outside of the time preference interval. tst - tend   where, tst is the starting time of the range selected by the user, tend is the ending time of the range selected by the user, and  is the length of the load profile of an appliance. The number of cycles or positions that can be available for starting an appliance are given by: cyc = tend - tst -  + 2 (5.13) (5.12)

39

For example consider an appliance load profile of the dishwasher which has the following load profile
ni

Pi,j = 1.2 1.2 0.2 1.1 0.68 0.8 0.6
j =1

where i = 1 refers to the dishwasher. Also  = 7 is the length of the load profile consisting of number of load phases in an appliance load. Also user time range constraints for starting and ending of appliance is given as tst = 2 (06:15AM) and tend = 14 (09:15AM). Since we are working on the time slots given with respect to the hour of the day, we consider time slot number for all our calculations of available time positions for allocating an appliance. Using (5.13) we get the result as cyc = 7, which is the available number of time slots in a day in which an appliance can be operated.

5.5

Mathematical Programming Approach

Objective function given in (5.2) has integer and non-integer values. Therefore, it can be solved using a mixed integer linear programming (MILP) technique, which is similar to an LP model, but here some of the variables have integer domain. In our thesis, time scale is divided in 96 time slots. This is determined in MILP through binary decision variable X, when its value is 1 at one particular slot and 0 for all the remaining slots. The major difficulty that arises in MILP problem is due to the combinational nature of the domain of X variables. Any choice for 0 and 1 for the elements of the vector X results in a LP problem on the P variable which can be solved for its best solution. In principle, it is possible to solve MILP problems using brute force approach of enumerating fully all possible combinations of binary variables for the element of the X vector. But such an approach grows exponentially in time with respect to its computational effort [33]. For instance if we consider one hundred binary X variables then we would have 2100 possible combinations. As a result we may have to solve 2100 LP problems. The best feasible solution among all combinations gives the optimum result, but it becomes prohibitive. 40

In this thesis, an optimized algorithm is developed using a mixed integer linear programming (MILP) technique. To solve the appliance scheduling problem optimally, there is a need of a mathematical programming language and a solver. There are many mathematical programming languages such as AMPL, TOMLAB, and YALMIP (A Toolbox for Modeling and Optimization in MATLAB [27]). YALMIP solves both convex and non-convex problems, and is available as gratis, while others are costly. The solvers such as IBM CPLEX and GUROBI are state-of-the-art solvers for linear programming (LP), quadratic programming (QP) and mixed-integer programming (MIP) and mixed integer quadratic programming (MIQP). GUROBI/CPLEX can solve MILP problems with a number of binary variables of a reasonable large size. In this work, there is need for 8x96 binary variables for describing the scheduling of appliances. The main motivation for using YALMIP is rapid algorithm development. The language is consistent with standard MATLAB syntax, thus making it extremely simple to use for anyone familiar with MATLAB. Only four functions from YALMIP have been used in the development of MILP model. The first one and most important function is "sdpvar()", which is used to define YALMIP's symbolic decision variables. The second function is "binvar()", which defines binary variable constrained to binary (0 or 1). The third function being "double()", is used to extract the numerical value of a decision variable after optimization. The fourth function is "solvesdp()" which with objective function and constraints solves standard optimization problems. YALMIP inherently solves for minimizing the objective function. To maximize the objective function, it is set as negative. A large number of real world planning problems called combinatorial optimization problems share the following properties. They are optimization problems, are easy to state and have a finite but usually very large number of feasible solutions. While some of these optimization problems have polynomial algorithms, the majority of the problems in addition share the property that no polynomial method for their solution is known, such as vehicle routing, production planning and appliance scheduling. All of these problems are NP-hard.

41

Solving NP-hard discrete optimization problems optimally is often an immense job requiring very efficient algorithms and the branch and bound (B&B) paradigm is one of the main tools in construction of these. The B&B method is the basic algorithm technique for solving MILP programming problems [31]. GUROBI solver uses a B&B algorithm, searches the complete space of solutions for a given problem for the best solution. The B&B method is the basic algorithm technique for solving MILP programming problems. The method is based on the observation that the enumeration of integer solutions has a tree structure. Now the main idea in branch and bound is to avoid growing the whole tree as much as possible, because the entire tree is just too big in any real problem. Instead branch and bound grows the tree in stages, and grows only the most promising nodes at any stage. It determines which node is the most promising by estimating a bound on the best value of the objective function that can be obtained by growing that node to later stages. The name of the method comes from the branching that happens when a node is selected for further growth and the next generation of children of that node is created. The bounding comes in when the bound on the best value attained by growing a node is estimated. We hope that in the end we will have grown only a very small fraction of the full enumeration tree. In addition to these an initial good feasible solution is normally produced using a heuristic whenever this is possible in order to facilitate fathoming of nodes as early as possible [28]. A heuristic is a method that is not guaranteed to find the optimum, but usually gives the very good solution, though it cannot be guaranteed to do that every time you run the optimization problem.

MILP Optimization Algorithm Formulation
Mixed integer linear program can be customized for the appliance scheduling problems, when some or all of the variables are integers and the objective function and all of its constraints are linear. In our case time scale of 24 hours in a day is divided into 96 time slots. Each slot represents 15 minutes duration. The appliances can be assigned at any starting and ending 42

time over the time scale starting from 1 to 96. Depending on the length of load profile, the number of time slots (or cycles) that are available for starting the appliance are given by (5.13). For example for i = 1, the appliance referred to is dishwasher which has the following load profile.
ni

P1,j = 1.2 1.2 0.2 1.1 0.68 0.8 0.6
j =1

If starting slot time of the appliance = 1 and the ending time slot = 96, then by using equation (5.13), we have 90 time slots available for starting the appliance. Therefore, 90 binary variables are required for the assignment of the dishwasher at 90 different starting time slots.

Let y1 = sdpvar [1,96] This declares y1 as YALMIPs symbolic decision variables. Then
1 2 3 90 1 2 3 89 90 y1 = [K1 K1 K1 .........K1 ] *[P1 j P1j P1j ..........P1j P1j ] 



{j}

where K are binary variable which is either 1 or 0 (equivalent to binvar in YALMIP) and all Ps are 1 × 96 matrices and represented as:
1 2 3 89 90 y1 = binvar [1,90 ]* [P1 j P1j P1j ......................P1j P1j ] 

where
1 P1 ,j =

1.2 1.2 0.2 1.1 0.68 0.8 0.6 0 0 0 · · · 0 0 0 0

 {j }

2 P1 ,j =

0 1.2 1.2 0.2 1.1 0.68 0.8 0.6 0 0 · · · 0 0 0 0 0 0 1.2 1.2 0.2 1.1 0.68 0.8 0.6 0 · · · 0 0 0 0 0 0 0 1.2 1.2 0.2 1.1 0.68 0.8 0.6 0 · · · 0 0 0 · 43

 {j }  {j }  {j }

3 P1 ,j =

4 P1 ,j =

· · ·
90 P1 ,j =

0 0 0 0 0 0 · · · 0 1.2 1.2 0.2 1.1 0.68 0.8 0.6

 {j }

subject to constraint
90 k K1 = 1 k =1

(5.14)

The above constraint (5.14) instructs the optimization solver to select only one time slot out of available 90 time slots (for assigning the starting time to the dishwasher) to obtain the objective as defined in the objective function in equations (5.2) and (5.4). The same methodology as explained above is applied to determine sdpvar for all the appliances separately. For the PV panel sdpvar variable y8 will be negative as it is not load consuming appliance but a local source of power. Then the objective function for minimizing peak load is expressed in Matlab syntax as FL = sum y1 + y2 + y3 ..................+ y7 - y8 - q .^ 2

Minimizing cost of energy is expressed in Matlab syntax as

FC =

y1 + y2 +y3 ..................+y7 -y8

* 0.25

[T OU ]

where TOU = time of use tariff vector. The objective functions and constraints are solved through YALMIP function "solvesdp". The optimized values `sdpvar' variables are extracted through "double( )". Flow chart shown in Figure 5.2 depicts the steps involved in writing the Matlab/YALMIP programming code for minimization of cost of energy and as well as minimizing the peak load. 44

Figure 5.2: Flow chart for scheduling of appliances for minimization of energy cost (P1) and peak load (P2)

45

Chapter 6 Optimization of Energy Cost and Peak Load Results
We run our MILP program code to schedule appliances for minimizing the energy cost (lower utility bill) and minimizing the peak load based on equations (5.2) and (5.4) for the following five cases: 1. Appliances assigned to full time range available in a day i.e., started at time slot 1 and ends at slot 96. 2. Appliances assigned to fixed range equal to the length of load profiles. 3. Appliances with mixed time range equal to or greater than the load profiles. 4. Case 2 above with PV panels. 5. Case 3 above with PV panels. Scheduling of the appliances for minimizing peak load in home has little relevance when electricity provider globally controls the peak load level through the time-of-use (TOU) tariff. In TOU pricing means that the electricity price per kWh varies for different times of the day to fill the valleys and reduce the peak load for more horizontal load distribution. 46

However, the maximum peak load in home is controlled through an additional constraint that the sum of loads at any time be always equal to or less than 5.5 kW in our case. The maximum peak is always assigned by the electricity provider. Reducing the cost of electricity bill is important and relevant in this research. Therefore, the effect on cost energy will be studied for the five different appliances scheduling scenario shown above.

Calculation of energy consumption and cost
Electricity consumption (kWh) of any appliance is determined by calculating the area under the curve of load (kW) profile P versus operation time in k hours. Electricity consumption of appliance i, is given as Pi · dk ; where Pi is the load profile vector of appliance i.

If load varies with time, the electricity consumption is approximated as area under the curve comprising summation of area of series of rectangles formed on time slots. The smaller the size of time slot, the better is the approximation for the calculation of the area under the curve. In this thesis, we are considering time slot of 15 minutes each. Reducing the cost of electricity bill under TOU tariff is achieved through scheduling appliances at different times of day when tariff is low. The optimized scheduling of appliances under TOU and different constraints is obtained through using mixed integer linear programming as explained in chapter 5. After having established the starting and ending times of the appliances associated with their respective load profile on the time scale having 96 time slots with zeros in unoccupied/unassigned slots, we are in position to calculate the optimized cost of electricity as under: Let Pik denotes the load profile vector of appliance i for all different starting time k of appliances, on time scale of 96 slots then sum of energy (kWh) of N appliances is given as
7

0.25 ·
i=1

Pik

The energy (kWh) summation is vector of order 1 × 96 and TOU ($/kWh) is also vector

47

of order 1 × 96. Therefore, the following equation gives total cost of energy used by all appliances in a day and all energy requirements are met from the national grid.
7 

Energy cost = 0.25 ·
i=1

Pik

· T OU

In case when a part of electricity energy is being met through micro-grid like PV panels. Then power imports from the national grid will be reduced equal to the amount of the power supplied by the PV panels and in times where power generated by PV panels is more than the power required by the appliances, the power will exported to the national grid. When load vector of PV panel Gk is subtracted from appliance total load vector
7 i=1

Pik ,

we get 1 × 96 vector containing some positive values and some negative values. If we further filter out positive and negative values of the load, we will get two vectors of order 1 × 96, one vector containing positive values showing power import from the grid and the other containing negative values showing export of power to the grid.

6.1

Appliances Assigned to the Full Time Range

Running the optimization algorithm for minimizing peak load and minimizing cost of energy, separately i.e, P1A and P2, with appliances range available from time slot 1 (06:00 AM) to time slot 96 (06:00AM), it is found that scheduler assigns some appliances to inconvenient time slots to start and operate them. The input time constraints for this scenario (for both the cases minimization of peak load and energy cost) are given in Table 6.1:

48

Table 6.1: Range of time constraints given for appliances Sr. No 1 2 3 4 5 6 7 Appliance Dishwasher Clothes Washer Dryer Refrigerator A/C Oven-1 (Morning) Oven-2 (Evening) Electrical Vehicle Profile Length 7 8 96 96 2 6 10 Time Range 1 - 96 1 - 96 1 - 96 1 - 96 1 - 96 1 - 96 1 - 96 Available starting slots 90 89 1 1 95 91 87

Minimization of peak load
In case of peak load minimizing, the emphasize is on allocating the appliance operation over time scale where there will be leveling of peak loads over the given range of time. For this scenario, we are optimizing equation (5.4) over a given full time range of 24 hours divided in to 96 slots. Therefore, load graph of all the appliances run over the day would tend to be levelled irrespective of the utility pricing signal (TOU) as shown in Figure 6.1. The starting and ending time of appliances in this case is shown in Table 6.2. Table 6.2: Appliances starting and ending times for minimizing peak load over a full time range Sr. No Appliance Start Time End Time 1 Dishwasher 17(10:00 AM) 23(11:30 AM) 2 Clothes Washer Dryer 5(7:00 AM) 12(8:45 AM) 3 Refrigerator 1(6:00 AM) 96(05:45 AM) 4 A/C 1(6:00 AM) 96(05:45 AM) 5 Oven-1 (Morning) 68(10:45 PM) 69(11:00 AM)) 6 Oven-2 (Evening) 87(3:30 AM) 92(05:45 AM)) 7 Electrical Vehicle 57(8:00 PM) 66(10:15 PM))

The following result is also obtained for the appliances configuration when the peak load is

49

Load of Appliances & TOU Tariff V/S Time of Day at Minimization of Peak Load 10 Appliance Load TOU Peak Load at time slot 60 0.15

Load (kW)

5

0.1

0

0

0.05 10 20 30 40 50 60 70 80 90 100 Time: Starting 1 (06:00 Hours) to 96 (05:45 Hours): Each Time Slot=15 minutes

Figure 6.1: Load pattern of appliances while minimizing peak load over full time range of slots from 1 - 96

minimized:
1. Total Energy Consumption of Appliances= 48.45 kWh 2. Energy Cost = $ 4.63 based on TOU Tariff 3. Energy Exported in kWh = 0 4. Maximum Peak Load = 5.61 KW and occurs at time slot 60 at 8:45 PM 5. Sum of Squared Deviation for (q=2.0) = 156.98

As shown in Table 6.2, scheduled time of dishwasher to start operating from 10:00 AM and ending at 11:45 AM is not preferable. Dishwasher rather should be scheduled to operate after dinner time. Similarly, the timing of oven-1 (Morning) starting at 10:45 AM is too late and oven-2 (Evening) starting at 3:30 AM is too early. Appliance scheduling as a result of peak load minimizing under full time range (1 - 96) are, therefore, inconvenient and not adoptable. It is to be noted that the objective of peak load minimization level is reflected 50

$/kWh

from the value of SSOD which is 156.98, being the lowest (lower the value of SSOD, the better is load minimization level).

Minimization of Energy Cost
In this scenario, using objective function equation (5.2), we want to consider the appliances in HAN to operate while minimizing the cost of energy used based on time range starting from slot 1 to time slot 96. Appliance dynamic responses are maneuvered by utility TOU signal as shown in Figure 6.2. Table 6.3 shows the starting and ending time of appliances when minimizing the energy bill.
Appliances Load & TOU Tariff V/S Time of Day at Minimizing Energy Cost 10 Appliance Load TOU Peak Load at time slot 75(12:30AM) Load (kW) 0.15

5

0.1

0.05 0 20 40 60 80 100 Time: Starting 1 (06:00 Hours) to 96 (05:45 Hours): Each Time Slot=15 minutes

0

Figure 6.2: Load pattern of appliances while minimizing cost of energy over full time range of 1 - 96 slots

51

TOU Tariff ($/kWh)

Table 6.3: Appliances starting and ending times for minimizing cost of energy over a full time range Sr. No 1 2 3 4 5 6 7 Appliance Dishwasher Clothes washer Dryer Refrigerator A/C Oven-1 (morning) Oven-2 (Evening) Electrical Vehicle Start Time 80(1:45 AM) 58(8:15 PM) 1(6:00 AM) 1(6:00 AM) 75(12:30 AM) 91(4:30 AM) 66(10:15 PM) End Time 86(3:15 AM) 65(10:00 PM) 96(05:45 AM) 96(05:45 AM) 76(12:45 AM)) 96(05:45 AM) 75(12:30 AM)

Following results are also obtained when energy cost is minimized:
1. Total Energy Consumption= 48.45kWh 2. Energy Cost = $4.46 based on TOU Tariff 3. Energy Exported in kWh = 0 4. Maximum Peak Load = 6.79kW and occurs at time slot 75 at 12:30 AM 5. Sum of Squared Deviation for (q=2.0) = 238.80

Figure 6.2 shows that while minimizing cost of energy, the scheduling of appliances have moved in time range where TOU tariff is low. The maximum peak load is 6.79kW which occurs at time slot 75 (12:30 AM). As expected the cost of electricity in case of minimization of energy cost is indeed lower than the case of minimization of peak load. The cost of electricity when minimizing peak load is $4.63 as shown earlier. The cost of energy when minimizing energy cost is $4.46 showing energy cost reduction of 3.6%. The reduction of energy cost came at increase in peak load level distortion (SSOD). Sum Square of Deviation (SSOD) increased from 156.98 to 238.80 (increase of 52.7%) in minimizing peak load and minimizing energy cost respectively. Time allocations for dishwasher, oven-1 (Morning) at time slot 75 (12:30 AM) and oven-2 (Evening) to time slot 91 (4:30 AM) to operate are still inconvenient timings. Therefore, 52

there arises a need to review the constraints of time slot range assignment of the appliances for its operations keeping its time of suitability and convenience. Also it is to be noted that peak load has increased significantly. It has to be restricted to a limit.

6.2

Appliances with Fixed Time Range

Consider a scenario where an unconcerned consumer may likely use appliances without giving due considerations to TOU tariff and limit to peak load. He tends to use appliances to his convenience, which could result in higher peak load and also higher cost of electricity. Such a situation is described as a worst case. In this connection, consider a home where appliances operate on the fixed time range equal to the length of load profile as per schedule given in Table 6.4. Here, the starting time of the appliances given by the consumer is fixed and there is no room for operating the appliances other than the time given by the user irrespective of the TOU. Table 6.4: Range of time constraints given for appliances in fixed range Sr. No 1 2 3 4 5 6 7 Appliance Dishwasher Clothes Washer Dryer Refrigerator A/C Oven-1 (Morning) Oven-2 (Evening) Electrical Vehicle Load Profile Length 7 8 96 96 2 6 10 Range 61 - 67 21 - 28 1 - 96 1 - 96 5-6 49 - 54 45 - 54 No. of slots allocation 1 1 1 1 1 1 1

Based on the input range given in Table 6.4, the following Table 6.5 gives starting and ending time of the appliances. These were obtained using the proposed optimization algorithm.

53

Table 6.5: Appliance with fixed schedule (time range = length of a load profile) Sr. No 1 2 3 4 5 6 7 Appliance Dishwasher Clothes washer Dryer Refrigerator A/C Oven-1 (Morning) Oven-2 (Evening) Electrical Vehicle Start Time 61(09:00 PM) 21(11:00 AM) 1(6:00 AM) 1(6:00 AM) 5(7:00 AM) 49(6:00 PM) 45(5:00 PM) End Time 67(10:30 PM) 28(12:45 PM) 96(05:45 AM) 96(05:45 AM) 6(7:15 AM) 54(7:15 PM) 54(7:15 PM)

For this scenario where appliance allocation is fixed, we get the following results:
1. Total Energy Consumption of Appliances = 48.45kWh 2. Energy Cost = $ 4.92 based on TOU tariff 3. Energy Exported in kWh = 0 4. Maximum Peak Load = 6.78kW and occurs at time slot 51 at 6:30 PM 5. Sum of Squared Deviation for (q=2.0) = 291.31

54

Appliances Load & TOU Tariff V/S Time of Day with Fixed Time Range=length of Load Profile 10 0.15 Appliance Load TOU

5

0.1

0

0

0.05 10 20 30 40 50 60 70 80 90 100 Time: Starting 1 (06:00 Hours) to 96 (05:45 Hours): Each Time Slot=15 minutes

Figure 6.3: Load pattern of appliances operating on fixed time range equal to the load profile

Demand curve of the above situation is shown in the Demand Response Figure 6.3, along with TOU tariff curve. This shows that most of the appliances are scheduled in the region of peak and mid peak of TOU tariff. The peak load of 6.78 kW occurs at time slot 51 (6:30 PM), which is in mid-peak TOU tariff.

6.3

Appliances with Mixed Time Range

In this case, time range space has been provided in Table 6.6 for optimizing the scheduling of appliances as per convenience of its operations. The time range provided is either equal or greater than the length of the load profiles to give flexibility for appliance scheduling and more time slots options for allocating appliances. Only refrigerator and air conditioner have fixed range equal to their respective load profiles.

55

TOU Tariff ($/kWh)

Peak Load at time slot 51 (06:30PM) Load (kW)

Table 6.6: Range of time constraints given for appliances in mixed range Sr. No 1 2 3 4 5 6 7 Appliance Dishwasher Clothes Washer Dryer Refrigerator A/C Oven-1 (Morning) Oven-2 (Evening) Electrical Vehicle Profile Length 7 8 96 96 2 6 10 Time Range Available Time slots 67 - 96 17 - 96 1 - 96 1 - 96 3-7 53 - 61 73 - 96 24 73 1 1 4 4 15

It is noted that energy demand of appliances being constant, reduction of peak demand and electricity cost could occur by appropriately shifting loads away from the peak TOU tariff timings. We also seek optimization scheduler to determine the minimum energy cost with additional constraint that peak load be lesser or equal to 5.5 kW at any instant of the time range. The combined appliances load distribution is shown in Figure 6.4 and the recommended starting and ending time of the appliances is given in Table 6.7 obtained using the proposed algorithm. We also obtained the following additional result:
1. Total Energy Consumption of Appliances = 48.45kWh 2. Energy Cost = $4.46 based on TOU tariff 3. Energy exported in kWh = 0 4. Maximum Peak Load = 5.50KW and occurs at time slot 86 at 3:15 AM 5. Sum of Squared Deviation for (q=2.0) = 201.53

The electricity consumption is 48.45kWh which remains constant and its cost is reduced from $4.92 as shown in section 6.2 to $4.46 based on TOU Tariff and reduction in peak load from 6.78kW to 5.5kW (18.9%). The load curve shows that shiftable loads under flexible time range move to region where tariff is low as evident from Figure 6.4.

56

Table 6.7: Appliances starting and ending times for mixed time range schedule Sr.No Appliance Start Time End Time Allowed Time (Time slot (Time slot Range and Time of and Time of the day) the day) 1 Dishwasher 68(10:45PM) 74(12:15AM) [67 to 96] 10:30PM to 05:45AM 2 Clothes Washer Dryer 60(8:45PM) 68(10:45PM) [17 to 96] 10:00 AM to 05:45AM

3

Refrigerator 1(6:00AM)

96(05:45AM)

[1 to 96] 6:00 AM to 05:45AM [1 to 96] 6:00 AM to 05:45AM [3 to 7] 6:30AM to 07:30AM [53 to 7:00PM 9:00PM [73 to 12:00AM 6:00AM 61] to

4

A/C

1(6:00AM)

96(05:45AM)

5

Oven-1 (Morning) Oven-2 (Evening)

3(6:30AM)

4(06:45AM)

6

54(7:15PM)

59(8:30PM)

7

Electrical Vehicle

80(1:45AM)

90(4:15AM)

96] to

57

Appliances Load & TOU Tariff V/S Time of Day at Minimizing Energy Cost with Mixed Time Ranges 10 0.15 Appliance Load TOU

Peak Load at time slot 86 (3:15AM) TOU Tariff ($/kWh) Load (kW)

5

0.1

0

0

0.05 10 20 30 40 50 60 70 80 90 100 Time: Starting 1 (06:00 Hours) to 96 (05:45 Hours): Each Time Slot=15 minutes

Figure 6.4: Load pattern of appliances operating on mixed time range

6.4

Appliances with Fixed Time Range with PV Panel

Now let us study the effect of local electricity generation through installation of 3kW photovoltaic (PV) panels and integrating its inverter to HAN electrical circuits. PV panels will generate power as co-power supplier in addition to supply from the national grid. At any instant of time, if local generation is higher than the local demand, power will be exported to national grid and also when local generation is not enough, the power will be imported from national grid. The effect of local generation is to lower the peak demand and as well as to lower the cost of electricity. Consider the same appliance configuration used in section 6.2 shown in Table 6.5 with 3kW photovoltaic panels. Then we get the following results through he proposed optimization algorithm with the objective function P1B:
1. Total Energy Consumption of Appliances = 48.45kWh & Energy cost = $4.92 based on TOU tariff 2. Energy Demand of Appliances after PV Supply = 34.11kWh and its cost= $3.11 based on TOU tariff

58

3. Sales Proceed from Export of -8.77kWh PV Energy, is $3.47 based on FIT tariff ($0.396/kWh) 4. Net Energy Cost [2-3] = -$0.37 5. Maximum Peak Load = 6.34kW and occurs at time slot 53 at 7:00 PM 6. Sum of Squared Deviation for (q=2.0) = 499.68

Load Demand of Appliances,PV Generation & TOU V/S Time of a Day at Minimizing Energy Cost with PV 10 0.15 Appliance Load PV Generation TOU TOU Tariff ($/kWh)

Load (kW)

5

0.1

0

0

0.05 10 20 30 40 50 60 70 80 90 100 Time: Starting 1 (06:00 Hours) to 96 (05:45 Hours): One Unit of Time=15 minutes

Figure 6.5: Load pattern of appliances and PV generation operating on fixed time range

The results show that amount of energy and total electricity cost is the same as in scenario considered in section 6.2. But if we take the effect of PV panel generation, the net import from national grid decreased from 48.45kWh to 34.11kWh. Therefore, the cost of energy decreased from $4.92 to $3.11 based on TOU tariff. The home simultaneously exported 8.77kWh to national grid. The expected sales proceed from the export of energy is $3.47 based on feed in tariff (FIT) $0.396/kWh as of 2014 [2]. Instead of payment, the net amount receivables from the electricity supplier is $0.36. The net cost of energy is -$0.37 as against $4.92 (showing energy cost reduction of 107.5%). Peak demand is reduced from 6.78kW to 6.34kW (showing a reduction of 6.4%). 59

Net Load Demand from Grid and PV Export at Minimizing Energy Cost with PV 6 5 4 Load(kW) 3 2 1 0 -1 -2 0 10 20 30 40 50 60 70 80 90 100 Time: Starting 1 (06:00 Hours) to 96 (05:45 Hours): One Unit of Time=15 minutes Peak Load at Time slot 53 (07:00PM) Appliance Load Energy Export

Figure 6.6: Net load demand from the grid and PV export at minimizing energy cost in fixed time range

The lower reduction in peak demand is due to the reason that peak is occurring at tail end of solar generation time. The demand of appliances with locally generated power on time-wise basis is shown in Figure 6.5. The net demand of load from the national grid and export of power to the utility grid are shown in Figure 6.6.

6.5

Appliances with Mixed Time Range with PV Panel

If we optimize the scheduling of appliances on the basis of minimizing energy cost subject to the same constraints in section 6.3 given in Table 6.6 and adding additional constraint that load at any time be always less than or equal to 5.5kW with 3kW photovoltaic panels, we get the following results using objective function P1B:
1. Energy Demand of Appliances = 48.45kWh & its cost = $4.46 based on TOU tariff 2. Energy Demand of Appliances after PV Supply = 35.54kWh and its cost = $2.84 based on TOU tariff 3. Sales Proceed from Export of -10.20kWh PV Energy, is $4.04 Based on FIT tariff ($0.396/kWh)

60

4. Net Energy Cost [2-3] = -$1.20 5. Maximum Peak Load = 5.50kW and occurs at time slot 86 at 3:15 AM 6. Sum of Squared Deviation for (q=2.0) = 524.77

The results show that amount of energy and total electricity cost is the same as in the case discussed in section 6.3. But if we take the effect of PV panel generation, the net import from national grid decreased from 48.45kWh to 35.54kWh. Therefore, the cost of energy decreased from $4.46 to $2.84 based on TOU tariff. The HAN simultaneously exported -10.20kWh to national grid. The expected sales proceed from the export of energy is $4.04 based on feed in tariff (FIT) $0.396/kWh as of 2014 [2]. Instead of payment, the net amount receivables from the electricity supplier is $1.20. The net cost of energy is -$1.20 as against $4.46 (showing energy cost reduction of 126.9%). Peak demand remained the same at 5.5kW due to the constraint that peak load at any time must not go above 5.5kW. The scheduling of appliances comes to be the same as the scenario discussed in section 6.3, but final demand curves are totally different because of the effect power supply by PV panels. There is a mix of import and export of electric power from and to national grid. Figure 6.7 shows the demand of appliances and supply of power from PV panels. The flexible loads have shifted to low tariff portion of TOU curve. Figure 6.8 shows the net flow of load. The upper portion of the graph shows import from the national grid and lower part of the graph shows export to the national grid. Appliance deployment chart for the scenario where appliance deployment is based on mixed time range with PV panels. There are 7 appliances which are energy consuming and 8th appliance PV panel is energy producing appliance. Figure 6.9 depicts that the energy consuming shiftable appliances depending upon the constraints, move to low tariff timings. A branch and bound optimization algorithm applied through GUROBI optimizer is used to schedule all the appliances in the smart home network and to hand over the consumer the optimized plan to run the appliances, getting the possible minimum energy cost and 61

Load Demand of Appliances, PV Generation & TOU V/S Time of a Day at Minimizing Energy Cost with PV 10 0.15 Appliance Load ON Peak PV Generation TOU
TOU Tariff ($/kWh)

MID Peak
Load (kW)

OFF Peak 5 0.1

0

0

0.05 10 20 30 40 50 60 70 80 90 100 Time: Starting 1 (06:00 Hours) to 96 (05:45 Hours): One Unit of Time=15 minutes

Figure 6.7: Load pattern of appliances and PV generation at minimizing cost in mixed time range

Net Load Demand from Grid and PV Export at Minimizing Energy Cost with PV Peak Load = 5.5kW at time slot 86 (03:15AM) 5 4 3
Load(kW)

2 1 0 -1 -2 0 Appliance Load Export of Energy 10 20 30 40 50 60 70 80 90 100 Time: Starting 1 (06:00 Hours) to 96 (05:45 Hours): One Unit of Time=15 minutes

Figure 6.8: The net load demand from the grid and PV export at minimizing energy cost in a mixed time range

62

Table 6.8: Optimized appliances starting and with micro-grid (PV panel) Sr.No Appliance Start Time (Time slot and Time of the day) 1 Dishwasher 68(10:45PM)

ending times for mixed time range schedule End Time (Time Allowed slot and Time of Range the day) 74(12:30AM) [67 to 10:30PM 6:00AM Time

96] to

2

Clothes washer Dryer Refrigerator

60(8:45PM)

67(10:45PM)

[17 to 96] 10:00 AM to 6:00AM

3

1(6:00AM)

96(6:00AM)

[1 to 96] 6:00 AM to 6:00AM [1 to 96] 6:00 AM to 6:00AM [1 to 8] 6:00AM to 07:45AM [53 to 61] 7:00PM to 9:15PM [73 to 12:00AM 6:00AM 96] to

4

A/C

1(6:00AM)

96(6:00AM)

5

Oven-1 (morning) Oven-2 (Evening) Electrical Vehicle

3(6:30AM)

4(7:00AM)

6

54(7:15PM)

59(8:45PM)

7

80(1:45AM)

89(4:15AM)

peak load. We solved the problem P1A, P1B and P2 using the optimizer GUROBI with the aid of the flowchart given in Figure 5.2. We Integrated micro-grid such as photo voltaic panels to serve as the provider for some time of the day and becoming self reliance in generating energy for self use or selling to the national grid. Moreover, a wide variety of appliances with different characteristics can be flexibly incorporated. Result shows that the energy scheduling of appliances can be determined simultaneously using the proposed MILP algorithm. Also exporting the electricity locally generated gives more reduction in cost than if it is consumed with in the home. Rates for TOU tariffs for home is on the lower end than

63

Figure 6.9: Occupancy of appliances vs time

the rates for exporting electricity to the national grid. The aim of the proposed algorithm is to demonstrate customer-driven demand side management operation, and calculate an estimate for home electricity energy consumption and at the same time reducing energy bill.

64

Chapter 7 Conclusion and Future Work
Optimized appliance load scheduling is an effective way of reducing both peak load as well as cost of electricity in time-of-use tariff. The objective function for minimizing the cost of energy in time varying tariff and minimizing peak load for leveling of appliance demand curve are given as problems in P1A and P2 respectively. These equations can be solved in at least more than one way. These equations could be solved through Brute Force optimizing method. This involves several loops while moving appliances load vectors in time horizon slots serially and retaining the calculation in memory on each step of loop while comparing results to identify the minimum value of the functions. This inherently is time consuming and requires large memory as addition of constraints makes it longer to process. This method, therefore, cannot be used for real time demand side management. We, therefore, adopted mixed integer linear programming (MILP) with solver GUROBI (which uses heuristic, linear relaxation followed by branch and bound) to make use of the computational power of multiprocessing technique. The result is obtained in core i3 processor in short time (in most cases less than 5 seconds); good enough for real time demand side management. If a computer with more powerful processor such as core i7 with multi-threading and high capacity RAM is used, the computation time for the MILP will reduce considerably. Addition of renewable energy sources such as PV panels with on grid-tie system, provides

65

resource for greater reduction in peak demand and far greater reduction in energy cost as evident from the results discussed in Chapter 6. Planning the start and end time range of appliances on the time scale from the point of convenience of appliance usage is very important. If one assigns full time range to the appliances, the objective of minimizing the energy cost will be achieved, but some appliance's will start and end at a very inconvenient time to take benefit of optimized appliance scheduling. The problem for appliance scheduling is formulated as a mixed integer linear programming (MILP) with the decision variable for power ON and OFF of an appliance is binary, thus making our optimization problem type a non-convex. We have used seven appliances of different shiftable types of load and one micro-grid i.e., PV panels but within the same algorithm developed; the number of appliances can be increased to add more types of appliances in a home area network (HAN). Optimized appliance scheduling can be studied with the other existing dynamic pricing models. As a single mid-sized home is considered here for the study, therefore, the present existing applicable time-of-use pricing model is used. Including inclining block rate (IBR) and other models require to study more than one home unit for showing effectiveness of the optimized plans for the home units. In our case, solar panel starts at time slot 2 (06:15 AM) continues till time slot 57 (08:00 PM) during a summer season. The PV panels reduce dependence on national grid by reducing the import of electricity energy from the national grid. And at times when PV panel generation is more than the demand of appliance, the excess energy is exported to the national grid at a lucrative feed-in-tariff (FIT) price ($0.396/kWh) as against $0.135/kWh ON peak TOU tariff. The high FIT is incentive to encourage production of clean/green energy. Due to the lucrative FIT price on export of energy, the electricity usage cost is expected to get reduced electricity bill. In our study, it shows that a mid-sized home without PV panels has to pay $4.46/day. With PV panels installed, we expect a receipt of $1.20/day from the utility company.

66

We can effectively enforce a rule that any time coincident peak demand of load does not increase beyond a certain limit as announced by the utility company from time to time. In our study we put a limit of 5.5kW on total demand of load. In this thesis, we considered two appliances, refrigerator and air-conditioner, which works 24 hours a day and occupy entire time scale. There is no reduction in load or cost as evident in using these appliances unless we go for reduction in energy usage by allowing to lower comfortable temperature say from 20 C to either 22 C to 26 C with increased air movement in case of air-conditioning. There is a need of creating load profiles of AC operating at cut off temperatures at 22 C, 24 C and 26C. Similarly for refrigerator, we can live comfortably by increasing the inside cut-off temperature from 3C to 6C for a few hours without effecting the food in a fridge. For this reason, there is a need to formulate load profiles at different operating temperatures. Once these are available, the present research can easily be extended to include the selection of load profiles for reducing the cost of electricity in peak TOU tariff. The future research can include other renewable energy source such as small wind mill in homes beside PV panel. PV panel discussed in this work is a grid-tie system, does not have the battery management system to store and reserve the energy to be used during the later part of the day or when the appliances need to be operated during on-peak hours. Cost effectiveness of both types of on-grid and off-grid PV panel can be studied to formulate a comprehensive backup energy resource at home. It is to be noted that off-grid system is very expensive to own and operate, mostly due to the cost of batteries. The cost of PV panels is going down every year, so the cost of appliances connected to solar energy generation. There is a requirement to determine internal rate of return and cost benefit analysis on the establishment of PV panels while taking into account amount of reduction of carbon foot prints in using this kind of clean energy.

67

Bibliography
[1] Ontario Ministry of Energy, "Ontario's Long-Term Energy Plan", Province Conservation activities, 2010. [2] Ontario Power Authority, http://microfit.powerauthority.on.ca/solar-photovoltaic-pv, OPA Micro Feed-In Tariff(FIT) Program. [3] Electric Power Research Institute, "Demand-side management: Utility options for the future", EPRI Reports, CU. 3028.10.89, 2006. [4] Hydro One, http://www.hydroone.com/RegulatoryAffairs/RatesPrices/Pages/Default.aspx, Electricity prices. [5] A. Agnetis, G. Pascale, P. Detti and A. Vicino, "Load Scheduling for Household Energy Consumption Optimization", IEEE Transactions on Smart Grid, vol. 4, no.4, pp. 23642373, 2013. [6] Y. Ozturk, P. Jha, S. Kumar and G. Lee, "A personalized home energy management system for residential demand response", in Proc. 4th International Conference on Power Engineering, Energy and Electrical Drives, pp. 1241-1246, May 2013. [7] M. Erol-Kantarci and H. Mouftah, "Wireless Sensor Networks for Cost-Efficient Residential Energy Management in the Smart Grid", IEEE Transactions on Smart Grid, vol. 2, no. 2, pp. 314-325, 2011.

68

[8] L. Gkatzikis, I. Koutsopoulos and T. Salonidis, "The Role of Aggregators in Smart Grid Demand Response Markets", IEEE Journal on Selected Areas in Communications, vol. 31, no. 7, pp. 1247-1257, 2013. [9] M. Erol-Kantarci and H. Mouftah, "TOU-Aware Energy Management and Wireless Sensor Networks for Reducing Peak Load in Smart Grids", in Proc. IEEE Vehicular Technology Conference, pp. 1-5, Sept. 2010. [10] R. Oviedo, F. Zhong, S. Gormus, P. Kulkarni and D. Kaleshi, "Residential energy demand management in smart grids", in Proc. IEEE Transmission and Distribution Conference and Exposition, pp. 1-8, May 2012. [11] K. Tsui and S. Chan, "Demand Response Optimization for Smart Home Scheduling Under Real-Time Pricing", IEEE Transactions on Smart Grid, vol.3, no.4, pp. 1812-1821, 2012. [12] A-H. Mohsenian-Rad, V. Wong, J. Jatskevich, R. Schober and A. Leon-Garcia, "Autonomous Demand-Side Management Based on Game-Theoretic Energy Consumption Scheduling for the Future Smart Grid", IEEE Transactions on Smart Grid, vol. 1, no. 3, pp. 320-331, 2010. [13] A. Faruqi and J. Palmer, "Dynamic Pricing and Its Discontents", Regulation, vol. 34, no. 3, pp. 1-6, 2011. [14] A. Faruqui, S. Sergici and L. Akaba, "Dynamic pricing of electricity for residential customers: the evidence from Michigan", Energy Efficiency, pp. 571584 2013. [15] C. Chen, J. Wang, Y. Heo and S. Kishore, "MPC-Based Appliance Scheduling for Residential Building Energy Management Controller", IEEE Transactions on Smart Grid, vol. 4, no. 3, pp. 1401-1410, 2013.

69

[16] J. Romm, "Combining Electric Cars with Smart Grid Technology", in Social Media Today Community, www.theenergycollective.com, 2013. [17] H. Dagdougui, R. Minciardi, A. Ouammi, M. Robba and R. Sacile, "A Dynamic Decision Model for the Real-Time Control of Hybrid Renewable Energy Production Systems", IEEE Systems Journal, vol.4, no.3, pp. 323-333, 2010. [18] H. Rahimi-Eichi, U. Ojha, F. Baronti and M. Chow, "Battery Management System: An Overview of Its Application in the Smart Grid and Electric Vehicles", IEEE Industrial Electronics Magazine, vol.7, no.2, pp.4-16, Jun. 2013 [19] C. Xiaodao, W. Tongquan and H. Shiyan, "Uncertainty-Aware Household Appliance Scheduling Considering Dynamic Electricity Pricing in Smart Home", IEEE Transactions on Smart Grid, vol.4, no.2, pp. 932-941, Jun. 2013. [20] K. Nygard, S. Ghosn, M. Chowdhury, D. Loegering, R. McCulloch and P. Ranganathan, "Optimization models for energy reallocation in a smart grid", in Proc. IEEE Conference on Computer Communications Workshops, pp.186-190, Apr. 2011. [21] M. Tasdighi, P. Jambor Salamati, A. Rahimikian and H. Ghasemi, "Energy management in a smart residential building", in Proc. 11th International Conference on Environment and Electrical Engineering, pp. 128-133, 2012. [22] M. Pedrasa, T. Spooner and I. MacGill, "Coordinated Scheduling of Residential Distributed Energy Resources to Optimize Smart Home Energy Services", IEEE Transactions on Smart Grid, vol. 1, no. 2, pp. 134-143, 2010. [23] T. Ahamed, S. Maqbool, E. Al-Ammar and N. Malik, "A simulated annealing algorithm for demand response", in Proc. 2nd IEEE PES International Conference and Exhibition on Innovative Smart Grid Technologies, pp. 1-4, Dec. 2011.

70

[24] M. Jacomino and M. Le, "Robust energy planning in buildings with energy and comfort costs", 4OR, vol. 10, no. 1, pp. 81-103, 2012. [25] VirginiaTech Advanced Research Institute, http://www.ari.vt.edu/research-data/, Appliance Data, 2013. [26] A-H. Mohsenian-Rad, V. Wong, J. Jatskevich and R. Schober, "Optimal and autonomous incentive-based energy consumption scheduling algorithm for smart grid", in Proc. Innovative Smart Grid Technologies, pp. 1-6, Jan. 2010. [27] J. Lofberg, "YALMIP : a toolbox for modeling and optimization in MATLAB", in Proc. IEEE International Symposium on Computer Aided Control Systems Design, pp. 284-289, Sept. 2004. [28] Mixed Integer programming Basics, http://www.gurobi.com/resources/getting-

started/mip-basics, Gurobi Optimization, Inc., 2014. [29] M. Pipattanasomporn, M. Kuzlu and S. Rahman, "An Algorithm for Intelligent Home Energy Management and Demand Response Analysis", IEEE Transactions on Smart Grid, vol.3, no.4, pp. 2166-2173, 2012. [30] M. Bozchalui,"Optimal Operation of Energy Hubs in the Context of Smart Grids", PhD thesis, Universty of Waterloo, 2011. [31] J. Clausen, "Branch and Bound Algorithm - Principles and Examples", Department of Computer Science, University of Copenhagen, 1999. [32] A. Malletta, R. Reibera, D. Rosenblooma, X. Philionb and M. Jegenb, "When Push Comes to Shove: Canadian smart grids experiences through the media", in Proc. Canadian Political Science Association Annual Conference, May 2014. [33] C. A. Floudas, "Nonlinear and Mixed-Integer Optimization: Fundamentals and Applications", Published by Oxford University Press, Oct 1995. 71

