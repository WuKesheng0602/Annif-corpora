INTEGRATION OF MULTI-CONSTELLATION GNSS PRECISE POINT POSITIONING AND MEMS-BASED INERTIAL SYSTEM FOR PRECISE APPLICATIONS

by Mahmoud Abd Rabbou M.Sc, Cairo University, Giza, Egypt, 2010 B.Sc, Cairo University, Giza, Egypt, 2007

A dissertation presented to Ryerson University in partial fulfillment of the requirements for the degree of Doctor of Philosophy in the Program of Department of Civil Engineering

Toronto, Ontario, Canada, 2015 © Mahmoud Abd Rabbou 2015

DECLARATION I hereby declare that I am the sole author of this dissertation. This is a true copy of the dissertation, including any required final revisions, as accepted by my examiners. I authorize Ryerson University to lend this dissertation to other institutions or individuals for the purpose of scholarly research I further authorize Ryerson University to reproduce this dissertation by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. I understand that my dissertation may be made electronically available to the public.

ii

ABSTRACT

Mahmoud Abd Rabbou

INTEGRATION OF MULTI-COSNTELLATION GNSS PRECISE POINT POSITIONING AND MEMS-BASED INERTIAL SYSTEM FOR PRECISE APPLICATIONS Ph.D. of Civil Engineering, Ryerson University 2015

This dissertation develops a low-cost integrated navigation system, which integrates multiconstellation global navigation satellite system (GNSS) precise point positioning (PPP) with a low-cost micro-electro-mechanical sensor (MEMS)-based inertial system for precise applications. Both undifferenced and between-satellite single-difference (BSSD) ionospherefree linear combinations of pseudorange and carrier phase measurements from three GNSS constellations, namely GPS, GLONASS and Galileo, are processed. An improved version of the PF, the unscented particle filter (UPF), which combines the UKF and the PF, is developed to merge the corrected GNSS satellite difference observations and inertial measurements and estimate inertial measurements biases and errors. The performance of the proposed integrated system is analyzed using real test scenarios. A tightly coupled GPS PPP/MEMS-based inertial system is first developed using EKF, which shows that decimeter-level positioning accuracy is achievable with both undifferenced and BSSD modes. However, in general, better positioning precision is obtained when BSSD linear combination is used. During GPS outages, the integrated system shows submeter-level accuracy in most cases when a 60-second outage is introduced. However, the positioning

iii

accuracy is improved to a few decimeter- and decimeter-level accuracy when 30- and 10second GPS outages are introduced, respectively. The use of UPF, on the other hand, reduces the number of samples significantly, in comparison with the traditional PF. Additionally, in comparison with EKF, the use of UPF improves the positioning accuracy during the 60second GPS outages by 14%, 13% and 15% in latitude, longitude and altitude, respectively. The addition of GLONASS and Galileo observations to the developed integrated system shows that decimeter- to centimeter-level positioning accuracy is achievable when the GNSS measurement updates are available. In comparison with the GPS-based integrated system, the multi-constellation GNSS PPP/MEMS-based inertial system improves the latitude, longitude and altitude components precision by 24%, 41% and 41%, respectively. In addition, the use of BSSD mode improves the precision of the latitude, longitude and altitude components by 23%, 15% and 13%, respectively, in comparison with the undifferenced mode. During complete GNSS outages, the developed integrated system continues to achieve decimeterlevel accuracy for up to 30 seconds, while it achieves submeter-level accuracy when a 60second outage is introduced.

iv

DEDICATION

To the people who praise nothing but noble values and deserve vast respect My mother, my brothers and sisters

v

ACKNOWLEDGEMENTS

Above all, I am in debt to ALLAH who has given me the health, strength and patience, and granted me the opportunity to complete my graduate studies at Ryerson University.

First, I would like to express my special thanks and gratitude to my distinguished supervisor, Professor Dr. Ahmed El-Rabbany, for his professional supervision, encouragement, valuable suggestions, guidance, and proposed ideas throughout my study and this research. His abundant cooperation and understanding deserve unbounded appreciation. It was my great pleasure working under his supervision. In addition, I wish to extend my appreciation and thanks to the committee members, Dr. Mike Chapman, Dr. Darko Joksimovic, Dr. Alex Ferwron and Prof. Marcelo C. Santos for dedicating their valuable times to review my dissertation. Appreciation is given to the International GNSS Service (IGS) and the Multi-GNSS Experiment (MGEX) for providing the precise GNSS products. Also, I would like to thank Dr. Aboelmagd Noureldin of the Royal Military College of Canada and his team for providing the kinematic data set used in this research. I must express my gratitude and special thanks to Dr. Ahmed Shaker and Dr. Mohamed ElSobeiey for their valuable support throughout my graduate studies. Finally, many thanks go to all my colleagues in the department of Civil Engineering for the unforgettable moments, the friendship, and the support I received throughout the entire course of my research: Akram Afifi, Salem Morsy, Kamil Faisl, Dr. Wai Yeung Yan, Rana Morsy, Mona El-Mosallamy, Hassan Ibrahim, Dr. Nagwa El-Ashmawy and Mohamed Abdel Azem.

vi

TABLE OF CONTENTS

DECLARATION .......................................................................................................................ii ABSTRACT ............................................................................................................................. iii DEDICATION ........................................................................................................................... v ACKNOWLEDGEMENTS ...................................................................................................... vi TABLE OF CONTENTS .........................................................................................................vii TABLE OF TABLES ................................................................................................................ x TABLE OF FIGURES .............................................................................................................. xi ABBREVIATIONS ................................................................................................................ xiv 1. Introduction ........................................................................................................................ 1 1.1. 1.2. 1.3. 1.4. 2. Background ................................................................................................................. 1 Research Objectives .................................................................................................... 6 Research Contributions ............................................................................................... 7 Dissertation Outlines ................................................................................................... 9

Tightly Coupled Integration of GPS Precise Point Positioning and MEMS-Based Inertial

Systems .................................................................................................................................... 11 2.1. 2.2. 2.3. Introduction ............................................................................................................... 12 GPS-PPP Ionosphere-free Linear Combinations ...................................................... 14 GPS-PPP/MEMS-based IMU Tightly-coupled Implementation .............................. 16 Process Model .................................................................................................... 18 Measurement Model .......................................................................................... 19 vii

2.3.1. 2.3.2.

2.4. 2.5. 2.6. 3.

Trajectory Test and Result Analysis ......................................................................... 21 Conclusions ............................................................................................................... 30 References ................................................................................................................. 31

Integration of GPS Precise Point Positioning and MEMS-based INS using Unscented

Particle filter............................................................................................................................. 33 3.1. 3.2. 3.3. Introduction ............................................................................................................... 35 GPS PPP/MEMS measurement and motion models ................................................. 37 Estimation Filters ...................................................................................................... 42 Unscented Kalman Filter (UKF) ........................................................................ 42 Particle Filter PF ................................................................................................ 44 Unscented Particle Filter (UPF) ......................................................................... 45

3.3.1. 3.3.2. 3.3.3. 3.4. 3.5. 3.6. 4.

Trajectory Test and Result Analysis ......................................................................... 46 Conclusions ............................................................................................................... 54 References ................................................................................................................. 54

Precise Point Positioning using Multi-Constellation GNSS Observations for Kinematic

Applications ............................................................................................................................. 59 4.1. 4.2. 4.3. 4.4. 4.5. 4.6. Introduction ............................................................................................................... 60 Multi-constellation GNSS PPP Mathematical Model ............................................... 62 Sources of GNSS Time Offsets and Biases .............................................................. 66 Process Model ........................................................................................................... 70 Kinematic Tand Results Analysis ............................................................................. 73 Conclusions ............................................................................................................... 78 viii

4.7. 5.

References ................................................................................................................. 78

Integration of Multi-Constellation GNSS Precise Point Positioning and MEMS-Based

Inertial Systems Using Tightly Coupled Mechanization ......................................................... 81 5.1. 5.2. 5.3. 5.4. Introduction ............................................................................................................... 83 Multi-constellation GNSS-PPP Measurement Models ............................................. 85 GNSS-PPP/MEMS-based IMU Implementation ...................................................... 88 Tests and Results Analysis ........................................................................................ 95 First Trajectory................................................................................................... 96 Second Trajectory .............................................................................................. 99

5.4.1. 5.4.2. 5.5. 5.6. 6.

Conclusions ............................................................................................................. 103 References ............................................................................................................... 104

Conclusions and Recommendations .............................................................................. 106 6.1. 6.2. Conclusions ............................................................................................................. 106 Recommendations ................................................................................................... 108

7.

References ...................................................................................................................... 109

ix

TABLE OF TABLES Table 2. 1--Statistical analysis of positioning errors during full satellite availability. ............ 25

Table 4. 1-Different GNSS biases affecting the GNSS observations and their definitions ..... 65 Table 4. 2-EKF state vector initial variances and process noise variances ............................. 73 Table 4. 3-Statistical parameters for GNSS PPP solutions for the Kingston Trajectory ......... 77

Table 5. 1-Statistical analysis of GNSS positioning precision for the first trajectory, with no outages inserted ........................................................................................................................ 98 Table 5. 2-Average maximum positioning errors during GNSS simulated outages for the first trajectory .................................................................................................................................. 99 Table 5. 3-Statistical analysis of GNSS positioning precision for the second trajectory, with no outages inserted ................................................................................................................. 101 Table 5. 4-Average maximum positioning errors during GNSS simulated outages for the second trajectory .................................................................................................................... 103

x

TABLE OF FIGURES Figure 2. 1-Tightly coupled GPS-PPP/INS implementation. .................................................. 17 Figure 2. 2-Trajectory test with the locations of simulated GPS outages. ............................... 22 Figure 2. 3-Equipment setup. ................................................................................................... 22 Figure 2. 4-Number of visible satellites during the test. .......................................................... 23 Figure 2. 5-Undifferenced IF positioning errors from Ryerson model. ................................... 24 Figure 2. 6-Undifferenced IF positioning errors from NRCan's GPSPace forward estimation. .................................................................................................................................................. 24 Figure 2. 7-Undifferenced IF positioning errors from NovAtel Inertial Explorer forward ..... 24 Figure 2. 8-BSSD model Positioning errors from Ryerson model. ......................................... 25 Figure 2. 9--Velocity errors of BSSD model. .......................................................................... 26 Figure 2. 10-Velocity errors of undifferenced model. ............................................................. 27 Figure 2. 11-BSSD IF positioning errors with 60 sec GPS outages. ....................................... 28 Figure 2. 12-Undifferenced if positioning errors with 60 sec GPS outages. ........................... 28 Figure 2. 13-BSSD IF positioning errors with 30 sec GPS outages. ....................................... 28 Figure 2. 14-Undifferenced IF positioning errors with 30 sec GPS outages. .......................... 29 Figure 2. 15-BSSD IF positioning errors with 10 sec GPS outages. ....................................... 29 Figure 2. 16-Undifferenced IF positioning errors with 10 sec GPS outages. .......................... 29 Figure 2. 17-BSSD IF average maximum errors during outages............................................. 30 Figure 2. 18-Undifferenced IF average maximum errors during outages. .............................. 30

Figure 3. 1-flow chart of the proposed tightly coupled GPS PPP/MEMS integrated system. 42 Figure 3. 2-Vehicle test trajectory and simulated complete GPS outages. .............................. 47 Figure 3. 3-Positioning errors for various filters, with no GPS outages inserted. a. Positioning errors in latitude; b. Positioning errors in longitude; c. Positioning errors in altitude. ............ 48

xi

Figure 3. 4-Velocity estimation errors. .................................................................................... 49 Figure 3. 5-Difference between UKF,PF and UPF east velocity estimation results and the altitude estimated using EKF. .................................................................................................. 49 Figure 3. 6-Attitude estimation errors using EKF referenced to differential mode based integrated system. .................................................................................................................... 50 Figure 3. 7-Difference between UKF,PF and UPF roll estimation results and the estimated roll using EKF. ......................................................................................................................... 50 Figure 3. 8-Pitch angle based on PF estimation function of number of samples..................... 51 Figure 3. 9- Pitch angle based on UPF estimation function of UPF number of samples ........ 52 Figure 3. 10- Positioning accuracy during GPS outages for latitude, longitude, and altitude. Outage 2 (a, d, g); outage 5 (b, e, h) and outage 6 (c, f, i). ...................................................... 53 Figure 3. 11-The average of maximum error for different estimation filters during GPS outages. .................................................................................................................................... 54

Figure 4. 1-Difference between two provider GLONASS satellite clock corrections, a. comparison between IGS and MGEX clock corrections for PRN 02 and b. difference between the two clock correction products. ........................................................................................... 67 Figure 4. 2-GPS/Galileo ISBs products published by MGEX-IGS ......................................... 70 Figure 4. 3-Visible GNSS satellites during the tests: a. Kingston kinematic trajectory test and b. Toronto static test ................................................................................................................. 74 Figure 4. 4-.GNSS ISBs based on PPP estimation .................................................................. 75 Figure 4. 5-Positioning accuracy based on undifferenced and BSSD ionosphere-free PPP techniques using GPS only, combined GPS and GLONASS, and combined GPS, GLONASS and Galileo. .............................................................................................................................. 77

xii

Figure 5. 1-GNSS PPP/MEMS based IMU integration mechanism ....................................... 90 Figure 5. 2-Test area and simulated complete GNSS outages for the first trajectory ............. 96 Figure 5. 3-GNSS satellites availability during the first trajectory test ................................... 96 Figure 5. 4-Positioning accuracy for the first trajectory with no outages inserted .................. 97 Figure 5. 5-Positioning accuracy for the first trajectory with simulated complete GNSS outages inserted ........................................................................................................................ 98 Figure 5. 6-Test area and simulated complete GNSS outages for the second trajectory ....... 100 Figure 5. 7-GNSS satellite availability during the second trajectory test .............................. 100 Figure 5. 8-Positioning accuracy for the second trajectory with no outages inserted ........... 101 Figure 5. 9-Positioning accuracy for the second trajectory with simulated complete GNSS outages inserted ...................................................................................................................... 102

xiii

ABBREVIATIONS

BSSD DCB DGPS DPB ECEF ECI EKF ENU EPF FOC GIOVE GLONASS GM GNSS GPS IEKF IF IGS IM INS IOV ISB JPL MEMS MGEX

Between-Satellite-Single-Difference Differential Code Bias Differential GPS Differential Phase Bias Earth-Centered Earth-Fixed Frame Earth-Centered Inertial Frame Extended Kalman Filter East, North and Up Reference Frame Extended Particle Filter Final Operational Capability Galileo In-Orbit Validation Element Russian Global Navigation satellite System Gaussian Markov process Global Navigation satellite system Global Positioning System Iterated Extended Kalman Filter Ionosphere-Free International GNSS Service Inertial Measurement Unit Inertial Navigation System In-Orbit Validation Inter-System Bias Jet Propulsion Laboratory Micro-Electro-Mechanical-Sensor Multi-GNSS EXperiment xiv

PF PPP RMSE SSDM TC UKF UPF VC

Particle Filter Precise Point Positioning Root Mean Square Error Satellite Single-Difference Matrix Tightly Coupled Unscented Kalman Filter Unscented Particle Filter Variance-covariance Matrix

xv

1.

Introduction

This chapter introduces the work included in this dissertation. Section 1.1 summarizes the necessary background for this research with emphasis on the limitations of previous work. Section 1.2 describes the motivations of this research. Section 1.3 describes the objectives of this research. Section 1.4 highlights the contributions of this research. Section 1.5 briefly outlines the contents of Chapters 2 to 6. 1.1. Background

Most current integrated GNSS/INS systems employ differential GPS (DGPS), along with high-end inertial sensors, such as navigation and tactical grades, for precise positioning and navigation applications (El-Sheimy et al., 1995; Brzezinska et al., 1998; Petovello, 2003; Nassar, 2003). The GPS positioning solution is obtained through carrier-phase observables in differential mode, involving two or more GPS receivers. Unfortunately, the requirement of a base station is usually problematic for some applications, as it controls the operational range of the system and increases the system cost and complexity. However, these problems can potentially be overcome through the use of a precise point positioning (PPP) technique. Commonly, precise point positioning (PPP) employed undifferenced ionosphere-free linear combinations of GPS code and phase measurements to cancel out the first-order ionospheric delay. The satellite orbit and clock errors are typically accounted for through the use of IGS orbital and clock products. The tropospheric error component can sufficiently be accounted for using an empirical model, such as the Saastamoinen or the Hopfield model (Hofmann et al., 2007). Alternatively, a regional tropospheric correction model such as the NOAATrop model can be used (Gutman et al., 2003). The effects of ocean loading, earth tide, carrierphase windup, sagnac, relativity, and satellite antenna phase-center variations can be

1

rigorously modeled (see, for example, Kouba, 2009). Based on the quality of observations, satellite availability and geometry, as well as the correct resolution of the integer ambiguity parameters, centimeter- and decimeter-level positioning accuracy can be achieved in static and kinematic modes, respectively, using GPS PPP. However, as a result of the limited satellite availability, GPS PPP solution may not always be available in urban canyons and the downtown core. As well, a drawback of the PPP technique is the relatively long convergence time, which the PPP solution takes to reach a sub-decimeter level positioning accuracy. This is mainly attributed to the poor satellite geometry and the existence of un-calibrated errors and biases, such as the satellite and receiver code biases. The above limitations, however, can partially be overcome through the addition of more observations from other GNSS constellations, such as GLONASS and Galileo. The importance of using multi-constellation GNSS is mainly noticed in challenging environments, such as urban areas, where the signals are either partially blocked by urban obstacles or are contaminated by multipath interference. In addition, the measurements from multiple GNSS constellations not only improve the satellite geometry, but also increase the redundancy, which in turn improves the positioning accuracy and convergence time. However, the additional GNSS observations introduce additional biases such as inter-system biases, which can be treated as additional unknowns in the estimation filter. The drawback of this strategy is that the number of unknowns will be increased by one for each GNSS system added. For GNSS applications in dense areas, increasing the number of unknowns might be critical in obtaining a good solution. As well, additional un-calibrated GNSS biases such as receiver and satellites differential code biases will be encountered, which, unless properly handled, will degrade the positioning accuracy. To enhance the GNSS PPP positioning accuracy and convergence time, the uncalibrated biases should be taken into considerations. These biases are typically combined with the 2

ambiguity parameters, which slow down their convergence to the correct values. In the absence of a multipath, the receiver-related biases can be removed from the code and phase GNSS observations by using per-constellation between-satellite-single-difference (BSSD) linear combinations. However, in BSSD PPP, the ambiguity parameters might still be affected by the dissimilarities of the satellite code biases, which result from employing different spectral methods in the filtering and correlation processes (Phelts, 2007). Although it improves the accuracy and availability of the positioning solution, multiconstellation PPP may still suffer from limitations (e.g., when the signal is completely blocked as a result of passing under a bridge). The addition of an environmental-independent system such as the inertial system can help overcome these limitations. As indicated above, high-end inertial sensors have traditionally been used to bridge the complete GNSS outages for precise applications (see, for example, Cannon, 1992; Schwarz et al., 1993, El-Sheimy et al. 1995; Brzezinska et al. 1998; Nassar and El-Sheimy 2003). The availability of high-end INS position and velocity information can shorten the ambiguity search time after short GPS data outages by feeding GPS with accurate position and position variance-covariance matrix (Sukkarieh, 2000; Petovello, 2004). Unfortunately, as stated earlier, these systems typically use differential GPS techniques, which limit the range of the system and increase its cost and complexity. Recent advances in micro-electro-mechanical sensors (MEMS) provide the development of a generation of low-cost inertial sensors which make them attractive to many users. However, in general, MEMS inertial sensors have poorer performance and stability than high-end INS due to the high noise level and severe biases and drifts affecting the MEMS-based inertial sensors. A number of researchers have investigated the integration of GPS with MEMS-based inertial sensors (e.g., Nayak, 2000; Shin, 2005; Mezentsev, 2005; Abdel-Hamid, 2005; Godha, 2006). However, several meter-level accuracy are obtained during the complete GPS 3

outages. This is mainly attributed to the large gyros drift biases. As such, these developed systems are not suitable for precise applications. To overcome the limitations of the performance of the low cost inertial sensors during GPS outages, more attention should be given to the inertial sensor's biases and errors through the estimation filtering technique employed. Commonly, the extended Kalman filter (EKF) is considered as the estimation filter for GPS/INS integration (e.g., Petovello, 2004; Nassar, 2005; Abd Rabbou and El-Rabbany, 2014). In EKF, the nonlinear system and observation models are linearized at the updated dynamic navigation parameters using the first-order Taylor series expansion under the assumption that the noise is Gaussian. However, as a result of neglecting higher order terms, the EKF might fail to produce a reliable estimation solution, especially during GPS outages. This is particularly the case when low-cost MEMS-based inertial measurement units (IMU) are used. To enhance the navigation system performance, alternatives to the standard EKF should be considered. The unscented Kalman filter (UKF) was introduced by Julier et al. (1995) as a linear regression estimation filter. Shin (2005) used the UKF to develop a low-cost INS aided by DGPS measurements. Unfortunately, similar to EKF, the UKF algorithm also assumes the Gaussian distribution for the probability density function of both motion and measurement systems, which sometimes cannot simulate the real probability distribution of the motion model. This is particularly the case during GNSS outages with the low performance MEMS-based sensors. In contrast to linearization filters, a particle filter (PF) avoids the linearization of the system models. It rather obtains an approximate estimation solution for the nonlinear motion and measurement models (e.g., Yi and Brzezinska 2006; Giremus et al. 2005; Caron et al. 2007; Georgy et al. 2010). A drawback of the PF, however, is that it involves a large computational cost, which represents the main limitation in practical use.

4

To overcome the computational cost of the particle filter, Georgy et al. (2010) applied an improved version of PF, known as mixture particle filter, for low-cost INS/Odometer/GPS integration in land vehicles. Recent research focused on fusing the PF with either of the EKF or the UKF to form the extended particle filter (EPF) or the unscented particle filter (UPF) (Haug, 2005; Simon, 2006). Haug (2005) used EKF and UKF to produce a posteriori mean and covariance estimates, which are then employed to produce the PF importance density function for particle generation. In addition, the particle normalized importance weights are calculated to refine the system a posteriori estimates. Although this technique significantly reduces the number of particles and processing time compared with the traditional PF, it confines the PF importance density function to a Gaussian distribution. As such, the expected enhancement can be considered limited (Zhou et al. 2010). According to Simon (2006), a bank of EKFs or UKFs can used for each particle, combined with the likelihood function, to derive the system a posteriori estimates. This technique can significantly reduce the number of needed particles while respecting the non-Gaussian nature of the system noise. Recently, PPP was introduced into tightly-coupled integration systems with a tactical grade INS (Zhang and Gao, 2005, Roesler and Martell 2009). The reported positioning accuracy of these systems is about 10 cm and 15 cm for the horizontal and vertical directions, respectively. More recently, the PPP technique was used for tightly-coupled integration with MEMS-based INS (Du, 2010, Abd Rabbou and El-Rabbany 2014 and Abd Rabbou and ElRabbany 2015). Du (2010) proposed a new cycle slip detection technique based on MEMSbased INS in a tightly-coupled PPP/INS integration mode. Abd Rabbou and El-Rabbany (2014) introduced the between satellite single difference (BSSD)-based PPP into the tightly coupled PPP/MEMS-based INS integrated system. In addition, they introduce the unscented particle filter (UPF) for their developed PPP/MEMS-based INS integrated system (Abd

5

Rabbou and El-Rabbany, 2015). However, the related studies were limited to the GPS-only observations. Considering the recent advances in MEMS-based accelerometers, the up to date GNSS constellations and the advances in PPP techniques, this research aims to develop a new integrated navigation system for precise positioning and navigation applications. MEMSbased accelerometers equipped with fiber optic gyros, which limit the orientation errors during the complete GNSS outages, are used. GNSS-based PPP including GPS, GLONASS and Galileo systems observations are used to update the system through a tightly coupled mechanism. Additionally, for further confining the positioning errors during the GNSS complete outages, a UPF is developed, based on the approach proposed by Simon (2006), to merge the GNSS measurements, through undifferenced PPP technique and the inertial sensor measurements. The performance of the developed filter is compared with that of the common filters, including the standard EKF, UKF and PF, both when GNSS is available and when there is a complete outage. The contribution of the developed PPP techniques, nonlinear estimation filters and the additional GNSS observations obtained from GLONASS and Galileo is assessed using real trajectory data in urban areas. 1.2. Research Objectives

The main objective of this research is to develop algorithms and estimation methodologies for a GNSS PPP/MEMS-based inertial system, which meets the accuracy requirements for precise navigations applications. This will be fulfilled through a number of tasks, which can be summarized as follows: 1. Developing GPS PPP models considering rigorous deterministic and stochastic modelling of different GPS errors. Both undifferenced and between-satellite-single-difference ionosphere-free PPP techniques are developed.

6

1.1.Developing GPS PPP/MEMS-based inertial sensors for precise applications considering the developed GPS PPP techniques and rigorous stochastic models for inertial sensors biases and scale factors. 2. Enhancing the developed integrated system performance and alternative to the standard extended Kalman filter (EKF) are investigated. This includes 2.1.Comparing between the traditional linear and nonlinear estimation filters such as the EKF, unscented Kalman filter UKF and particle filter PF. 2.2.Developing the integrated unscented particle filter (UPF) which integrates the UKF and PF. 2.3.Investigating the real performance of the proposed estimated filters during GPS outages using real test scenarios. 3. Developing combined GNSS PPP models for kinematic applications including GPS, GLONASS and Galileo satellite navigation systems. This includes 3.1.Investigating the contribution of the additional GNSS observations on PPP positioning accuracy compared with the traditional GPS PPP. 3.2.Studying the GNSS inter-system biases stability. 3.3.Developing between-satellite-single-difference GNSS PPP technique and investigate its positioning accuracy compared with undifferenced ionosphere-free GNSS technique. 4. Developing GNSS PPP/MEMS-based inertial sensors integrated navigation system model considering the GNSS PPP techniques developed. The process and measurement models are extended to include the additional GNSS biases. 1.3. Research Contributions

This research aims to develop an integrated system, which integrates a multi-constellation GNSS, including GPS, GLONASS and Galileo, and MEMS-based inertial sensors for precise 7

positioning and navigation applications. The major contributions of this research can be summarized as follows: 1. Development of tightly coupled integration algorithms for the integrated PPP GPS/MEMS-based inertial systems. The algorithms are developed for both undifferenced and between-satellite single difference ionosphere-free PPP techniques. The EKF is used as the estimation filter to merge the GPS PPP observations and inertial sensor records. This research contribution is published in Abd Rabbou, M. and El-Rabbany, A, (2014), Tightly coupled integration of GPS precise point positioning and MEMS- based inertial systems. GPS solution, doi:10.1007/s10291-0140415-3 2. Development of tightly coupled integration algorithms for the integrated PPP GPS/MEMS-based inertial systems with nonlinear estimation techniques. An unscented particle filter which integrates both unscented Kalman filter and particle filter is developed to merge the GPS PPP observations and inertial sensors record. The developed estimation filter is compared with the traditional estimation filters such as the standard EKF, UKF and PF. The contribution of the new developed estimation filter is shown during GPS availability and outages. This research contribution is published in Abd Rabbou, M., and El-Rabbany, A. (2015). Integration of GPS Precise Point Positioning and MEMS-Based INS Using Unscented Particle Filter. Sensors, 15(4), 7228-7245. 3. Development of multi-constellation GNSS PPP for precise kinematic applications combining observations from three GNSS systems, namely GPS, GLONASS and Galileo. Both undifferenced and between-satellite single difference GNSS PPP techniques are developed and compared. The inter-system biases between the GPS and other GNSS systems are also studied.

8

This research contribution is published in Abd Rabbou, M., and El-Rabbany, A. (2015). Precise Point Positioning using Multi-

Constellation GNSS Observations for Kinematic Applications. Journal of Applied Geodesy, 9(1), 15-26. 4. Development of tightly coupled integration algorithms for the integrated multiconstellation GNSS PPP/MEMS-based inertial systems. The algorithms are developed for both undifferenced and between-satellite single difference ionosphere-free PPP techniques. The EKF is used as the estimation filter to merge the GPS PPP observations and inertial sensor records. The contribution of the additional GNSS observations is investigated during GNSS observations availability and complete outages with two sets of trajectory data. This research contribution is submitted in Abd Rabbou and M., El-Rabbany, A, (2014), Integration of Multi-Constellation GNSS Precise Point Positioning and MEMS-Based Inertial Systems Using Tightly Coupled Mechanization, Sensor, submitted. 1.4. Dissertation Outlines

This dissertation follows a manuscript style approach, with each chapter representing a published paper. Chapter 1 presents an introduction, dissertation motivations, objectives, contribution, outlines, and literature review. This dissertation is based on the following publications: Chapter 2 Abd Rabbou, M., El-Rabbany, A, (2014), Tightly coupled integration of GPS precise point positioning and MEMSbased inertial systems. GPS solution,

doi:10.1007/s10291-014-0415-3. 9

Chapter 3 Abd Rabbou, M., and El-Rabbany, A. (2015). Integration of GPS Precise Point Positioning and MEMS-Based INS Using Unscented Particle Filter. Sensors, 15(4), 72287245. Chapter 4 Abd Rabbou, M., and El-Rabbany, A. (2015). Precise Point Positioning using Multi-Constellation GNSS Observations for Kinematic Applications. Journal of Applied Geodesy, 9(1), 15-26. Chapter 5 Abd Rabbou, M. and El-Rabbany, A, (2014), Integration of Multi-Constellation GNSS Precise Point Positioning and MEMS-Based Inertial Systems Using Tightly Coupled Mechanization, Sensors, Submitted. Chapter 6 presents general conclusions of this research, and suggests some recommendations for future research. It should be pointed out that modifications to the original manuscript were made only for proper identification of sections, figures and tables to assure uniformity within this dissertation.

10

2. Tightly Coupled Integration of GPS Precise Point Positioning and MEMS-Based Inertial Systems © 2014 by the authors; licensee Springer Berlin Heidelberg In this chapter, tightly-coupled integration algorithms for PPP GPS/MEMS-based inertial systems are developed. The algorithms are developed for both undifferenced and betweensatellite single difference ionosphere-free modes. EKF is used as the estimation filter to merge the GPS observations and inertial sensor records. The following manuscript was originally published as:

Abd Rabbou, M. and El-Rabbany, A, (2014), Tightly coupled integration of GPS precise point positioning and MEMS- based inertial systems. GPS solution, doi: 10.1007/s10291014-0415-3

Modifications to the original manuscript were made only for proper identification of sections, figures and tables to assure uniformity within this dissertation.

11

Tightly Coupled Integration of GPS Precise Point Positioning and MEMS-Based Inertial Systems Abstract We develop a new integrated navigation system, which integrates GPS Precise Point Positioning (PPP) with low-cost micro-electro-mechanical sensors (MEMS) inertial system, for precise positioning applications. Currently, most common GPS PPP techniques employ undifferenced ionosphere-free (IF) linear combination. In this work, both undifferenced and between-satellite-single-difference (BSSD) IF linear combinations of pseudorange and carrier measurements are considered. IGS precise orbital and clock products are used to correct for satellite orbit and clock errors. Rigorous models are used to account for tropospheric delay, ocean loading, earth tide, carrier phase windup, relativity, and satellite antenna phase-center variations. To integrate GPS PPP and MEMS-based inertial systems, the process and measurement models are developed. Tightly coupled mechanization is adopted, which is carried out in the raw measurements domain. Extended Kalman filter is developed to merge the corrected GPS satellite difference observations and inertial measurements and estimate inertial measurements biases and errors. A Matlab-based computer program is developed to carry out the tightly coupled integration. The performance of the proposed integrated system is analyzed using a real test situation. It is shown that decimeter-level positioning accuracy is achievable with both undifferenced and BSSD integrated systems. However, in general better positioning accuracy is obtained with BSSD integrated system Keywords; GPS, PPP, GPS/INS integration, Extended Kalman Filter, Tightly Coupled Integration. 2.1. Introduction

Global positioning system (GPS) and inertial navigation system (INS) integrated system has been investigated for several decades in different applications. Most of the integrated

12

GNSS/INS systems implement differential GPS due to its inherent high accuracy (El-Sheimy et al. 1995, Brzezinska et al. 1998, Petovello et al. 2004, Nassar and El-Sheimy 2003). A number of researchers have investigated this topic considering high-end inertial sensors, for example, navigation-grade (El-Sheimy et al. 1995 and Brzezinska et al. 1998) and tacticalgrade inertial systems (Petovello et al. 2004, Nassar and El-Sheimy 2005). Generally, high­ end INS was used to enhance the GPS solution such as speeding up the integer ambiguity resolution. Owing to their price and size, high-end INS is generally confined to only highaccuracy applications. The great advances in micro-electro-mechanical sensors (MEMS) provide the development of a generation of low cost inertial sensors. MEMS sensors are characterized by light weight, small size and low cost compared with high-end inertial sensors. Generally, MEMS sensors have poorer performance and stability compared with high-end INS due to the high noise level and severe biases and drifts affecting the MEMSbased inertial sensors. Several researchers have investigated the integration of GPS system with MEMS-based inertial sensors such as Shin et al. (2005), Mezentsev (2005), AbdelHamid et al. (2006) and Godha and Cannon (2007). In those studies differential GPS (DGPS) was used to update the low-cost MEMS measurements to achieve acceptable accuracy. However, the requirement of a base station is usually problematic for some applications as it limits the operational range of the system to about 15 km and increases the system cost and complexity. Comparable positioning accuracy, without requiring extra infrastructure, can be achieved through a technique commonly known as precise point positioning (PPP). PPP uses undifferenced or between-satellite difference carrier phase and pseudorange observations from a single receiver, in addition to precise orbit and clock data. PPP processing technique was introduced by Zumberge et al. (1997) and was further developed by Kouba and Heroux (2001). Zumberge et al. (1997) proposed a method for calculating the clock data and orbit using a subset of International GNSS Service (IGS) network. Their research focused on the 13

use ionosphere-free linear combinations of pseudorange and carrier phase observations. They used precise satellite clock and orbital data with intervals of 30 seconds and 15 minutes, respectively, and were able to achieve promising results. At present, several organizations, such as IGS and Jet Propulsion Laboratory (JPL), provide precise GPS orbit and clock products. In this research, GPS PPP is integrated with low-cost MEMS inertial system. Both undifferenced and between-satellite single-difference (BSSD) ionosphere-free (IF) linear combinations of pseudorange and carrier phase measurements are considered. Precise error mitigation models, including correction models for tropospheric delay, ocean loading, earth tide, carrier phase windup, relativity, and satellite antenna phase-center variations, are used to correct the raw GPS measurements. In addition, IGS final products for precise satellite orbit and clock are used. It is shown that decimeter-level positioning accuracy and centimeter-level velocity accuracy are achievable with both undifferenced and BSSD IF integrated systems. The following sections briefly describe the measurement and process models for the proposed integrated system and show the trajectory test results and analysis. 2.2. GPS-PPP Ionosphere-free Linear Combinations

The most widely used PPP model is the undifferenced ionosphere-free combination of code pseudorange and carrier phases (Hofmann-Wellenhof et al. 2008). The mathematical model for ionosphere-free PPP can be written as:
f12 P  f22 P r s 1 2 =  +c( d tr - d t s ) +T +c( BP - BP ) +eP3 3 3 2 f1  f 2 2 f121  f 2 22 r s = +c(dtr -dt s )+T +c(B3 -B3 )+N+e3 f12  f 2 2

P = 3

2.1

3=

2.2

where 1 and 2 are pseudorange measurements on L1 and L2 , 1 and 2 are the carrier phase measurements on L1 and L2 in meters,  and   are the clock errors for receiver

14

  and satellite, T is the tropospheric delay, 3 and 3 are frequency-dependent differential   code bias (DCB) for receiver and satellite, 3 and 3 are frequency-dependent differential

phase bias (DPB) for receiver and satellite, 3, 3 are relevant system noise and unmodeled is the ambiguity term between the receiver and satellite on phase residual errors, and  measurements. For the undifferenced ionosphere free linear combination, this term is not
1 - 2 2 2  = 1 1 2 integer due to the non-integer nature of the combination coefficients,   -2 1 2 2 2

and the lumped receiver and satellite biases, c is the speed of light in vacuum, and  is the true geometric range from the antenna phase center of the receiver at reception time to the antenna phase center of the satellite at transmission time. Between-satellite single-difference (BSSD) model is also used in PPP, which represents a difference between two-satellite ionosphere-free linear combinations. BSSD has the advantage of canceling out the receiver hardware delay, receiver clock error, and the nonzero initial carrier phase bias of the receiver oscillator. The ionosphere-free BSSD for satellites (k) and (l) can be written as:

15

kl k l P    kl  c( dt sl  dt sk )  c( BP  Bp )  T k  T l  ekl 3 3 3 p3

2.3

k l kl 3kl =kl +c(dt sl -dt sk )+c(B3 -B3 )+(N k -N l )+T k -T l +e3

2.4

    where 3 and 3 are the ionosphere-free differential code bias (DCB) and 3 , 3 are

the ionosphere-free differential phase bias (DPB), respectively. Mathematical correlations are produced among the observations when BSSD is performed, which must be taken into account when forming the covariance matrix of the observations. Assuming that the number of visible satellites is ns, the relative weight matrix PBSSD can be described by (Elsobeiey and El-Rabbany 2014):
 ( ns  1 )  1 1 1 1    1 ( n  1) 1 1 1  s   f12  f 22  1   1  1 ( ns  1 )  1 1     2  f  f 2   2n  1 1  1 ( ns  1 ) 1  2  s  1      1  1  1  1 ( n  1 )   s  

PBSSD

2.5

where  is the standard deviation of GPS measurements. As can be seen in (3.5), the observation weight matrix for BSSD at a particular epoch is fully populated. 2.3. GPS-PPP/MEMS-based IMU Tightly-coupled Implementation

In this research, the tightly coupled (TC) architecture is implemented adopting an extended Kalman filter (EKF). GPS pseudorange, carrier phase and Doppler measurements as well as INS-derived observations are processed to produce estimates of the state vector including position, velocity and attitude. Final IGS precise orbital and clock products are used to correct for satellite orbit and clock errors (Kouba 2009). The UNB3 tropospheric model which consists of the Saastamoinen vertical propagation delay model and the Niell mapping function is used to account for the tropospheric dry components (Leandro et al. 2008). The troposphere wet component is considered as additional unknown in the error state vector.

16

Figure 3.1 shows the tightly coupled GPS PPP/INS implementation flowchart. Given the precise GPS Satellites ephemeris, the outputs of position  and velocity   from the INS mechanization are used to predict the pseudorange  , phase  and Doppler  measurements. The corrected pseudorange , phase  and Doppler   measurements from GPS are differenced with the INS-predicted measurements. Then the integration filter directly processes those residuals, namely ,  and , to estimate the INS error state vector. Finally, the obtained INS error estimates, i.e., the inertial sensor bias drifts  and , and scale factors  and  , are fed back to the INS mechanization to correct for the inertial sensor forces   and   using the closed loop approach. The estimated error states, namely position errors  , velocity errors   and attitude errors   are directly
  applied to the INS-derived position  , velocity  and attitude   solutions.

Figure 2. 1-Tightly coupled GPS-PPP/INS implementation. Based on the tightly coupled mechanism, the error state vector is defined and the process and measurement models are developed.

17

2.3.1.

Process Model

The basic state vector consists of the nine navigation parameter errors, namely three position errors, three velocity errors and three attitude errors. Additional states are added to the INS error model in order to account for the effects of the inertial sensor and GPS errors. The complete state vector consists of 24 states describing the nine navigation parameter errors, twelve inertial sensor errors, namely the bias drift and scale factor errors for accelerometers and gyros, and three errors unique to the GPS measurements, namely the troposphere wet delay and the receiver clock offset and drift. It should be pointed out that the receiver clock offset and drift are cancelled out when forming the BSSD ionosphere-free model. The complete state vector can be written as:
 x  [ r n ,  v n ,  n ,  ba ,  bg ,  Sa ,  S g , Tw ,  toff ,  tdri ]
2.6

where   is a three-dimensional vector representing the positioning errors in latitude, longitude and altitude,   is a three-dimensional vector representing the velocity errors in east, north and up,   is a three-dimensional vector representing the attitude errors in roll, pitch and azimuth,  is a three-dimensional vector representing the accelerometer biases drift in x, y and z,  is a three-dimensional vector representing the gyro biases drift in x, y and z,  is a three-dimensional vector representing the accelerometer scale factors errors in x, y and z,  is a three-dimensional vector representing the gyro scale factors errors in x, y and z.  is the troposphere wet delay,  and  are the GPS receiver clock offset and drift, respectively. The process model can be derived from the perturbations of the INS mechanization equations, which can be found, for example, in Jekeli (2001) and Noureldin et al. (2013). The process model considering a first order GM process for sensor errors can be represented through: 18

 x  F( t ) x  G( t ) w( t )
 rn  vn n  ba  bg  Sa  Sg  Tw  to f f  td r i

2.7



Fr r Fr v Fr 03 03 03 03 n n b Fv r Fv v Fv Rb 03 Rb F 03 n n F r F v F  03 Rb 03 Rb Wb 03 03 03 b a 03 03 03 03 03 03 03 b a 03 03 03 03 03 03 03 sa 03 03 03 03 03 03 03 s a 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0

0 0 0 0 0 0 0 0 0 0

0 0 0 0 0 0 0 0 1 0

0 0 0 0 0 0 0 0 0 0

 rn  vn n  ba  bg  Sa  Sg  Tw  to f f  td r i

03 n Rb 03 03  03 03 03 0 0 0

03 03 n Rb 03 03 03 03 0 0 0

03 03 03 I3 03 03 03 0 0 0

03 03 03 03 I3 03 03 0 0 0

03 03 03 03 03 I3 03 0 0 0

03 03 03 03 03 03 I3 0 0 0

0 0 0 0 0 0 0 1 0 0

0 0 0 0 0 0 0 0 1 0

0 0 0 0 0 0 0 0 0 1

wa wg wb a wb g ws a ws g wt w wo f f wd r i

2.8

where   ,   ,   ,   ,   ,   ,   ,   and   are system dynamics matrices, which
 represents the relationship between the position, velocity and attitude state errors,  is the

transformation matrix from the body frame to the navigation frame,   is a diagonal matrix of the accelerometers forces in body frame and   is a diagonal matrix of the gyro forces in body frame, w represents the system input white noise, G is the associated coefficient matrix and   1/  , where  is the correlation time for the accelerometers and gyros for first order GM process. The full derivation and definition of F elements can be found in Jekeli (2001).
2.3.2. Measurement Model

The measurement model of the GPS/INS filter in the tightly coupled architecture has the typical form:
z  H  x  
2.9

The measurement vector z consists of the differences between the corrected GPS and the predicted INS measurements. The measurement vector when undifferenced ionosphere-free model is used can be defined as:
G PS P  P IN S i iG PS   IN S z  G PS P  P IN S i

2.10

19

H is the geometry matrix containing factors defined according to the GPS mathematical model used. The geometry matrix is arranged with columns corresponding to the states unique to inertial sensors errors such as  ,  ,  and  , which are filled with zeroes. H can be defined as:
Ai 0 0 0 0 0 0 m ei 1 0 0 H  Bi 0 0 0 0 0 0 m ei 1 0  0 Ci 0 0 0 0 0 0 0 1 0

2.11
   

where  =  ,  =

,  =  are the partial derivatives of the pseudorange, phase and

Doppler, respectively, with respect to the receiver position X and velocity V;  =
1 ()

is the mapping function for the troposphere wet delay component. The error

state vector x is the same as that in (6) with additional states related to the float ambiguity parameters Ni, i.e.

 x  [ r n ,  v n ,  n ,  ba ,  bg ,  Sa ,  Sg ,Tw ,  toff ,  tdri , N1 , N2 , ....]

2.12

To form the BSSD measurement model, satellite single-difference matrix (SSDM) should be defined based on the selected reference satellite
1 0 0 0 0 1 0 0 0 0 0  1 SSDM  0 0 0 0

1 1 1 1 1 1 1 0 1

0

0

0

0

0 1 0 0 0 0 0 1 0 0 0 0 1

2.13

ns  1* ns

20

HBSSD  SSDM * Hun  di f f

2.14

 ZBSSD  SSDM *  Zun  di f f
RBSSD  SSDM * Run  diff * SSDM T

2.15

2.16

where  is the geometric BSSD matrix,  is the BSSD observation vector and  is the BSSD observation variance-covariance (VC) matrix considering the mathematical correlation. The error state vector for BSSD integrated system is defined as:
 x  [ r n ,  vn ,  n ,  ba ,  bg ,  Sa ,  S g ,  Tw1i , N1i , N2i , ....]

2.17

where 1 and 2 are the float single differenced float ambiguity parameters. 2.4. Trajectory Test and Result Analysis

Real vehicular test was conducted to evaluate the performance of the developed integrated GPS PPP/MEMS-based IMU system. The vehicular test was carried out through in downtown Kingston, Ontario (Canada), which was designed to represent challenging situations for satellite navigation with actual frequent partial GPS outages of several seconds. NovAtel SPAN-CPT system and the Trimble R10 receiver were used to collect the data used in this work. The SPAN-CPT system consists of the NovAtel OEM4 receiver and a MEMSbased IMU, which contains three MEMS-based accelerometers and three fiber optic gyros. Only the positioning and velocity performance are assessed in this work. Carrier phase-based differential GPS (DGPS) solution is used as a reference. In order to create this reference solution, a Trimble R7 receiver was setup at a nearby station with precisely known coordinates, which was used as a base station. The raw dual-frequency GPS pseudorange, carrier phase and Doppler measurements were collected at a 1 Hz rate, while the IMU raw data was logged at a rate of 100 Hz. The duration of the trajectory test was set for about 55 minutes. The trajectory test area is shown in Figure 2.2 with the locations of simulated 21

outages, Figure 2.3 shows the equipment setup and Figure 2.4 shows the satellite availability during the observation time span.

Figure 2. 2-Trajectory test with the locations of simulated GPS outages.

Figure 2. 3-Equipment setup.

22

Figure 2. 4-Number of visible satellites during the test. In order to assess the results of our Ryerson PPP models, a comparison was made with existing software packages, namely NRCan's GPSPace software and NovAtel Inertial Explorer software. In both software packages, only undifferenced ionosphere-free observations are employed. The trajectory data are processed using the two software packages and their results are compared with our Ryerson undifferenced and BSSD ionosphere-free processing results. Figures 2.5 through 2.8 show the positioning results from the various software packages.

23

Figure 2. 5-Undifferenced IF positioning errors from Ryerson model.

Figure 2. 6-Undifferenced IF positioning errors from NRCan's GPSPace forward estimation.

Figure 2. 7-Undifferenced IF positioning errors from NovAtel Inertial Explorer forward estimation.

24

Figure 2. 8-BSSD model Positioning errors from Ryerson model. As can be seen in Figures 3.5 through 3.8, decimeter-level positioning accuracy is achievable through all tested PPP software packages. However, it can be seen that the positioning results of the Ryerson PPP/INS model are better than those of existing software packages. It can also be seen that the positioning results of BSSD model are better than those of the undifferenced model. Table 2.1 summarizes the statistical analysis for each solution. Table 2. 1--Statistical analysis of positioning errors during full satellite availability. Software Positioning RMSE (m) Maximum error (m) Software Positioning RMSE (m) Maximum error (m) latitude 0.069 0.437 Ryerson (undifferenced mode) latitude 0.101 0.184 longitude 0.150 0.303 IE-Forward longitude 0.208 0.419 altitude 0.160 0.849 altitude 0.103 0.416 NRCan's GPSPace -forward latitude longitude altitude 0.154 0.348 0.162 0.324 0.181 0.803

Ryerson (BSSD mode) latitude longitude altitude 0.052 0.121 0.090 0.179 0.082 0.306

As shown Table 2.1, comparing the values of the RMSE of each solution, it can be seen that the PPP solution is improved by 35, 7.5 and 43% in the latitude, longitude and altitude, respectively, when our Ryerson undifferenced model is used, in comparison with the CSRS forward PPP solution. When compared with Inertial Explorer PPP solution, it can be seen that 25

the PPP solution is improved by 27 and 35% in the longitude and altitude, respectively, through the Ryerson undifferenced model. However, for latitude, the RMSE is smaller through Inertial Explorer, while the maximum error is smaller through Ryerson undifferenced model. As can be seen, further improvement is obtained when the Ryerson BSSD IF PPP model is used. In comparison with Ryerson undifferenced PPP model, the RMSE values are improved by 48, 40 and 20% in the latitude, longitude and altitude components, respectively. In addition, the maximum error or the BSSD solution is smaller than that of the undifferenced mode. In comparison with the CSRS and Inertial Explorer solutions, Ryerson BSSD solution is superior in all components. Figures 2.9 and 2.10 show the velocity errors for the BSSD and undifferenced models. The Doppler measurements are corrected for the differential tropospheric delay. Final IGS orbital and satellite clock correction products are employed to estimate the precise satellites velocities. The results show that centimeter/sec accuracy level can be achieved in the velocity component using both models. It also can be seen that the results of BSSD and undifferenced mode, are comparable, which is expected since the receiver differential code bias which cancels by satellite observation differencing, does not exist in the Doppler measurements.

Figure 2. 9--Velocity errors of BSSD model.

26

Figure 2. 10-Velocity errors of undifferenced model. To mimic the challenging positioning conditions in urban areas, including complete blockage of the GPS satellites, twelve simulated satellite outages of 60s, 30s and 10s were introduced. The outages were distributed along the trajectory test as shown in Figure 2 including vehicle turns. The data were processed using our Ryerson PPP GPS/INS software in the undifferenced and BSSD modes. Figures 2.11 through 2.16 show the positioning errors during the outages referenced to carrier-based DGPS solution with full satellite availability. As can be seen, both of the undifferenced and BSSD models produce similar positioning accuracy during the outages. In the 60-second GPS outage the maximum positioning error reached submeter level in most cases, while it reached a decimeter level in 10-seccond outage. Figures 2.17 and 2.18 show the average maximum positioning errors in latitude, longitude and altitude, respectively during the three simulated GPS outages for both BSSD and undifferenced ionosphere-free models.

27

Figure 2. 11-BSSD IF positioning errors with 60 sec GPS outages.

Figure 2. 12-Undifferenced if positioning errors with 60 sec GPS outages.

Figure 2. 13-BSSD IF positioning errors with 30 sec GPS outages.

28

Figure 2. 14-Undifferenced IF positioning errors with 30 sec GPS outages.

Figure 2. 15-BSSD IF positioning errors with 10 sec GPS outages.

Figure 2. 16-Undifferenced IF positioning errors with 10 sec GPS outages.

29

Figure 2. 17-BSSD IF average maximum errors during outages.

Figure 2. 18-Undifferenced IF average maximum errors during outages. 2.5. Conclusions

We developed new algorithms for the integration of GPS PPP and MEMS-based inertial system. Both undifferenced and between-satellite single-difference ionosphere-free linear combinations of carrier phase and code measurements were considered. Tightly coupled mechanism was implemented and extended Kalman filter (EKF) technique was developed to merge the GPS and inertial measurements. The performance of the newly developed models was analyzed using a real test situation. The positioning results of the integrated system showed that decimeter-level accuracy is achievable while the velocity results showed that 30

centimeter/sec-level accuracy is possible. Better positioning accuracy was obtained with BSSD IF model, in comparison with the undifferenced IF model. During the GPS outages, the integrated system showed submeter-level accuracy in most cases when a 60-second outage was introduced. However, the positioning accuracy was improved to a few decimeter and decimeter-level accuracy when 30- and 10-second GPS outages were introduced, respectively. Comparable results were obtained from both BSSD and undifferenced models under GPS outages. 2.6. References

Abdel-Hamid, W., Abdelazim, T., El-Sheimy, N., and Lachapelle, G. (2006). Improvement of MEMS-IMU/GPS performance using fuzzy modeling. GPS Solutions, 10(1), 1-11. El-Sheimy, N., Schwarz, K. P., Wei, M., and Lavigne, M. (1995). VISAT: a mobile city survey system of high accuracy. In Proceedings of the 8th International Technical Meeting of the Satellite Division of The Institute of Navigation, Palm Springs, CA, pp. 1307-1315). Elsobeiey, M., and El-Rabbany, A. (2013). Efficient between-satellite single-difference precise point positioning model. Journal of Surveying Engineering, 140(2). Godha, S., and Cannon, M. E. (2007). GPS/MEMS INS integrated system for navigation in urban areas. GPS Solutions, 11(3), 193-203. Grejner-Brzezinska, D. A., Da, R., and Toth, C. (1998). GPS error modeling and OTF ambiguity resolution for high-accuracy GPS/INS integrated system. Journal of Geodesy, 72(11), 626-638. Hofmann-Wellenhof, B., Lichtenegger, H., and Wasle, E. (2007). GNSS­global navigation satellite systems: GPS, GLONASS, Galileo, and more. Springer Science & Business Media. Chicago

31

Jekeli, C. (2001). Inertial navigation systems with geodetic applications. Walter de Gruyter. Kouba, J. (2009). A guide to using International GNSS Service (IGS) products. International GNSS. Kouba, J., and Héroux, P. (2001). Precise point positioning using IGS orbit and clock products. GPS solutions, 5(2), 12-28. Leandro, R. F., Langley, R. B., and Santos, M. C. (2008). UNB3m_pack: a neutral atmosphere delay package for radiometric space techniques. GPS Solutions, 12(1), 65-70. Mezentsev O (2005) Sensor aiding of HSGPS pedestrian navigation. Dissertation, University of Calgary. Nassar, S., and El-Sheimy, N. (2005). Wavelet analysis for improving INS and INS/DGPS navigation accuracy. Journal of Navigation, 58(01), 119-134. Noureldin, A., Karamat, T. B., and Georgy, J. (2012). Fundamentals of inertial navigation, satellite-based positioning and their integration. Springer Science & Business Media. Petovello, M. G., Cannon, M. E., and Lachapelle, G. (2004). Benefits of Using a Tactical Grade IMU for High Accuracy Positioning. Navigation, 51(1), 1-12. Shin, E. H., Niu, X., and El-Sheimy, N. (2001, May). Performance comparison of the extended and the unscented Kalman filter for integrated GPS and MEMS-based inertial systems. In Proceedings of the 2005 National Technical Meeting of The Institute of Navigation, San Diego, pp. 961-969. Zumberge, J. F., Heflin, M. B., Jefferson, D. C., Watkins, M. M., and Webb, F. H. (1997). Precise point positioning for the efficient and robust analysis of GPS data from large networks. Journal of Geophysical Research: Solid Earth (1978­2012), 102(B3), 50055017.

32

3. Integration of GPS Precise Point Positioning and MEMS-based INS using Unscented Particle filter © 2015 by the authors; licensee MDPI, Basel, Switzerland

In this chapter, tightly-coupled integration algorithms for PPP GPS/MEMS-based inertial systems with nonlinear estimation techniques are developed. An unscented particle filter, which integrates both unscented Kalman filter and particle filter is developed to merge the GPS observations and inertial sensor records. The results of the developed estimation filter are compared with those of traditional estimation filters such as the standard EKF, UKF and PF. The performance of the newly developed estimation filter is examined both when GPS is available and during GPS outages. It should be pointed that the trajectory data used to validate the developed algorithms is the same as the one used in Chapter two.

The following manuscript was originally published as:

Abd Rabbou, M., and El-Rabbany, A. (2015). Integration of GPS Precise Point Positioning and MEMS-Based INS Using Unscented Particle Filter. Sensors, 15(4), 7228-7245.

Modifications to the original manuscript were made only for proper identification of sections, figures and tables to assure uniformity within this dissertation.

33

Integration of GPS Precise Point Positioning and MEMS-based INS using Unscented Particle filter Abstract Integration of Global Positioning System (GPS) and Inertial Navigation System (INS) integrated system involves nonlinear motion state and measurement models. However, the extended Kalman filter (EKF) is commonly used as the estimation filter, which might lead to solution divergence. This is usually encountered during GPS outages, when low-cost microelectro-mechanical sensors (MEMS) inertial sensors are used. To enhance the navigation system performance, alternatives to the standard EKF should be considered. Particle filtering (PF) is commonly considered as a nonlinear estimation technique to accommodate severe MEMS inertial sensor biases and noise behavior. However, the computation burden of PF limits its use. In this study, an improved version of PF, the unscented particle filter (UPF), is utilized, which combines the unscented Kalman filter (UKF) and PF for the integration of GPS precise point positioning and MEMS-based inertial systems. The proposed filter is examined and compared with traditional estimation filters, namely EKF, UKF and PF. Tightly coupled mechanization is adopted, which is developed in the raw GPS and INS measurement domain. Undifferenced ionosphere-free linear combinations of pseudorange and carrier-phase measurements are used for PPP. The performance of the UPF is analyzed using a real test scenario in downtown Kingston, Ontario. It is shown that the use of UPF reduces the number of samples needed to produce an accurate solution, in comparison with the traditional PF, which in turn reduces the processing time. In addition, UPF enhances the positioning accuracy by up to 15% during GPS outages, in comparison with EKF. However, all filters produce comparable results when the GPS measurement updates are available.
Keywords: GPS, PPP, INS, EKF, UKF, UPF, Tightly coupled

34

3.1.

Introduction

Traditionally, differential GPS with tactical or high-end inertial sensors are used in Global Positioning System (GPS) and Inertial Navigation System (INS) integration for precise navigation applications (El-Sheimy et al. 1995, Brzezinska et al. 1998, Petovello 2004 and Nassar 2005). This is mainly due to the inherited high accuracy of differential GPS in comparison with standalone GPS mode. Unfortunately, this requires a relatively nearby base station, which limits the navigation range and increases the cost and complexity of the system. Precise point positioning (PPP) technique is capable of providing decimeter positioning accuracy without the need for a base receiver (Zumberge et al. 1997). PPP has been the focus of a number of research groups in the last two decades (see for example, Kouba and Heroux 2001, Gao and Chen, 2004, Collins et al., 2010). To speed up the PPP solution convergence time, a number of PPP ambiguity resolution techniques have been developed (Ge et al, 2008, Geng et al., 2012 and Shi et al., 2014). PPP has been used in a number of applications, including precise surveying, disaster monitoring, offshore exploration, and others (Geng et al., 2013, Xu et al., 2013 and Abd Rabbou and El-Rabbany, 2015). On the inertial side, recent advances in micro-electro-mechanical sensors (MEMS) technology enabled the development of a generation of low-cost inertial sensors. MEMS sensors are characterized by their small size, light weight and low cost, in comparison with high-end inertial sensors. However, MEMS sensors have generally poorer performance compared with high-end inertial navigation unit (IMU) due to the significantly higher biases and errors affecting these low-cost inertial sensors. Commonly, the extended Kalman filter (EKF) is considered as the estimation filter for GPS/INS integration (e.g,, Petovello 2004, Nassar 2005 and Abd Rabbou and El-Rabbany 2014). In EKF, the nonlinear system and observation models are linearized around the updated dynamic navigation parameters using the first-order Taylor series expansion under 35

the assumption that the noise is Gaussian. However, as a result of neglecting higher order terms, EKF might fail to produce a reliable estimation solution, especially during GPS outages. This is particularly the case when low-cost MEMS-based inertial measurement units (IMU) are used. The iterated extended Kalman filter (IEKF) was considered by a number of researchers, e.g., Teunissen (1991) and Steffen (2008), which attempts to improve the linear approximation of the observation model through iterative re-linearization. Unfortunately, the IEKF does not overcome the convergence problem completely. The unscented Kalman filter (UKF), on the other hand, was introduced by Julier et al. (1995) as a linear regression estimation filter. UKF propagates a deterministically a fixed set of sigma points with appropriate weights through the non-linear motion and observation models to capture the system a posteriori mean and covariance estimates (Bergman 2001). However, similar to EKF, the algorithm is still dealing with the assumption of Gaussian distribution. In contrast to linearization filters, Particle filtering (PF) avoids the linearization of the system models. It rather obtains an approximate estimation solution for the nonlinear model. In addition, PF can accommodate non-Gaussian distributions noise. As a result, it can be considered as a non-parametric estimation method for non-linear/non-Gaussian applications. A drawback of the PF, however, is that it is featured by a large computational cost, which represents the main limitation in practical use. Nevertheless, with the advances in computer technology, a number of researchers successfully used it for GPS/INS integration (e.g., Yi and Brzezinska 2006; Giremus et al. 2005; Caron et al. 2007; Georgy et al. 2010). To overcome the linearization and computational cost problems, recent research focused on fusing the PF with either of the EKF or UKF to form the extended particle filter (EPF) or the unscented particle filter (UPF), respectively (Haug, 2005; Simon, 2006). Haug (2005) used EKF or UKF to produce a posteriori mean and covariance estimates, which are then 36

employed to produce the PF importance density function for particle generation. Then, the normalized importance weights of the particles are calculated to refine the system posteriori estimates. Although, this technique significantly reduces the number of particles and processing time compared with traditional PF, it confines the PF importance density function to Gaussian distribution. As such, the expected enhancement can be considered limited (Zhou et al. 2010). According to Simon (2006), a bank of EKFs or UKFs can used for each particle combined with the likelihood function to derive the system a posteriori estimates. This technique can significantly reduce the number of needed particles while reserving the non-Gaussian natural of the system noise. In this research, a UPF is developed, based on the approach proposed by Simon (2006), to merge the GPS measurements, through undifferenced PPP technique and the inertial sensor measurements. All of the available GPS observations, including pseudorange, carrier-phase and corrected Doppler observations, are used. The performance of the developed filter is compared with that of the traditional filters, including the standard EKF, UKF and PF, both when GPS is available and when there is a complete outage. The results show that during the GPS availability the estimation filters present comparable positioning accuracy. However, during GPS outages the UPF is showing to give superior accuracy compared with the tradition estimating filters. The UPF enhances the positioning accuracy by average 15% compared with EKF estimation accuracy. In addition, the number of particles needed is decreased significantly compared with the traditional PF which reduce the computational cost of the Monte Carlo based estimation filtering. 3.2. GPS PPP/MEMS measurement and motion models

Tightly coupled (TC) architecture is implemented in this research, adopting a central filter to process the GPS raw measurements (pseudorange, carrier-phase and Doppler) and the IMU 37

measurements to produce estimates of the state vector including position, velocity and attitude. The mathematical model of the inertial navigation system is commonly described in the framework of linear dynamic systems. The dynamic behavior of such systems can be described using a state-space representation. For this purpose, a system of nonlinear firstorder differential equations can be described as (Jekeli 2001):
 rn    D  Vn  n   n b n n n n  V  R f  ( 2    )  V  g    b  ie en  n   Rb n ( nib  bin ) R   b    

3.1

where, r n is the position vector, latitude, longitude and altitude; V n is the velocity vector in the East, North and Up (ENU) reference frame, V n is the kinematic acceleration vector in the
n ENU reference frame; n en . V represents the effect of the motion of the ENU frame with n n respect to the ECEF frame; 2n ie . V is the Coriolis acceleration vector; g is the gravity

vector, including the gravitation term and the centripetal term related to the Earth rotation; and f b is the specific force vector in the body frame, which is measured by the accelerometers. The matrix n ie is the skew-symmetric matrix of rotation rate vector of the Earth, which can be expressed in the ENU frame as:
0  n ie  0 0 
3.2

0  cos  0

    sin    0 0

The matrix n en is the skew-symmetric matrix of the rotation rate vector of the ENU frame with respect to ECEF frame, expressed in the ENU frame as:

38

n en

 Vn M  h     0   0  

0 VE N h 0

    0   VE tan   N h   0

3.3

The matrix b ib is the skew-symmetric matrix of the rotation rate vector of the body frame with respect to the ECI frame b ib , expressed in the body reference, which is measured by the gyros. The matrix b in is the skew-symmetric matrix of the rotation rate of the navigation frame with respect to inertial frame b in expressed in the body frame, which is computed
n combining n ie and en transforming the result in the body frame as follows:

inb  Rnb  ( ien  enn )

3.4

The bias and scale factor drifts are modeled as a first-order Gauss-Markov process, which can be formed as follows:
1

 bai  

 bai
1

 bai  wbai

3.5

 bgi  

 bgi
1

 bgi  wbgi

3.6

 Sai  

 Sai
1

 Sai  wSai

3.7

 S gi  

 Sgi

 S gi  wSgi

3.8

where the subscript "i" indicates the axis;  and  are the correlation times for the accelerometers and gyros, respectively; and  and  are the Gauss-Markov process

driving noises, whose spectral densities are  and  . The clock errors unique to the GPS measurements, including the clock offset and drift are modeled by (Brown and Hwang 1997):
 ( c tof f set )   ( c tdri f t )  wof f set

3.9

39

 ( c tdri f t )  wdri f t

3.10

where  and  are the clock offset and drift driving noise with spectral density  and  , respectively. The measurement model of the GPS/INS filter in the TC architecture has the typical form:
yk  h( xk )  w

3.11

where  is the corrected undifferenced ionosphere-free GPS measurements; h( ) is the nonlinear measurement model which relates the stated vector x with the observation vector y and w is the Gaussian white noise with zero mean and covariance matrix Py . The mathematical model for the undifferenced ionosphere-free combination of code and carrier phase measurements can be written as:
2 f12 P 1  f2 P 2

P3=

f12  f 22 f121 -f 2 22 f12 -f 2 2

=  +cdtr -cdt s +T+c(Ad r1 -Bd r 2 )  c(Ad s1 -Bd s 2 )+e

3.12

3 =

= +cdtr -cdt s +T+c(Ar1 -Br2 )-c(A s1 -B s2 )+( N )+

3.13

where P1 and P2 are GNSS pseudorange measurements on L1 and L2 , respectively; 1 and 2 are the GNSS carrier phase measurements on L1 and L2 , respectively; dt r and dt s are the clock errors for receiver and satellite, respectively; dr and ds are frequency-dependent code hardware delay for receiver and satellite, respectively; r and s are frequency-dependent carrier phase hardware delay for receiver and satellite, respectively; e,  are relevant system noise and un-modeled residual errors; and  N is the ambiguity term for phase measurements. For the undifferenced ionosphere free linear combination, this term is not integer due to the
1 -f2 2 N2  = f1 1 N2 non-integer nature of the combination coefficients, N , where N1 and N2 are f -f2 1 2 2 2

the L1 and L2 non-integer ambiguity parameters, including the initial phase biases at the 40

satellite and the receiver, respectively; 1 and 2 are the wavelengths of the L1 and L2 carrier frequencies, respectively; c is the speed of light in vacuum; T is the tropospheric delay component;  is the true geometric range from the antenna phase center of the receiver at reception time to the antenna phase center of the satellite at transmission time. A and B are
1 2 frequency dependent factors A= 2 - 2 and B =  2 - 2 . 1 2 1 2

 2

 2

With the availability of the final IGS orbital products corrected for the effect of earth rotation during signal transit, the outputs of position and velocity from the INS mechanization are used to predict the pseudorange, phase and Doppler measurements through the nonlinear observation equations. The UNB3 tropospheric model, consisting of the Saastamoinen vertical propagation delay model and Niell mapping function, is used to account for the tropospheric error (Leandro et al. 2008). The effects of ocean loading, Earth tide, carrierphase windup, sagnac, relativity, and satellite antenna phase-center variations are accounted for using existing models (Kouba 2009). In addition, the satellite clock error is accounted for using the final IGS clock products. Considering the above corrections, the corrected pseudorange, carrier phase and Doppler measurements from GPS as well as the INSpredicted measurements, are processed by the integration filter to estimate the INS state vector. Finally, the obtained INS state estimates are fed back to the INS mechanization using the closed loop approach. The architecture of the proposed tightly coupled integrated system is shown in Figure 3.1.

41

Figure 3. 1-flow chart of the proposed tightly coupled GPS PPP/MEMS integrated system. 3.3. Estimation Filters

Nonlinear estimation filtering techniques are employed to estimate the state vector of the proposed integrated GPS PPP/MEMS-based inertial system. In this section, the algorithms of the UKF and the PF are first briefly described. Then the proposed unscented particle filter (UPF) is introduced. 3.3.1. Unscented Kalman Filter (UKF) In UKF, number of points with appropriate weights called sigma points are deterministically selected to simulate the system probability density function under the assumption of Gaussian distribution. According to Bergman (2001), the sigma points can capture the mean and covariance of a random vector up to the third order accuracy. Comparing with the traditional EKF, in which the higher order terms in Tylor expansion series are neglected, the UKF should provide superior performance in simulating the Gaussian distribution and the nonlinearity behavior of the systems. The sigma points with zero mean can be generated based on a given squared dimension covariance matrix. As our distribution has a desired mean , a symmetric of 2n points is generated around the mean state vector. The generated 42

points are propagated through the motion model yielding the predicted mean and covariance. Finally, the updated mean and covariance are estimated based on the GPS observations updating. The unscented Kalman filter can be defined according to Bergman (2001) as follows: 1. Initialize with (k=0);
x0  E[ x0 ]
T P 0  E[ ( x0  x0 ) ( x0  x0 ) ]

2. Define sigma points;
i xk 1  x 

( n   )Px , Wi 

1 2( n   )

in xk 1  x 

( n   )Px ,Wi  n 

1 2( n   )

Where i=1:n, are the sigma points and n is the dimension of the state vector. The parameter  is a scaling parameter. 3. Motion model update step;
i i xk ,k 1  f (xk 1 , ui )  wk

4. Measurement update;
i Zk ,k 1



i h(xk ,k 1 ), Z k ,k 1



W Z
i 0

2n

i i k ,k 1

xk ,k 1 
Pzk 

W x
i 0

2n

i i k ,k 1

 W (Z
i i 0

2n

k ,k 1

i i T  Zk ,k 1 )(Z k ,k 1  Z k ,k 1 )

Pxk ,k 1 

 W (x
i i 0

2n

k ,k 1

i i T  xk ,k 1 )(xk ,k 1  xk ,k 1 )

Pxk ,k 1 

 W (x
i i 0

2n

k ,k 1

i i T  xk ,k 1 )(Z k ,k 1  Z k ,k 1 )

K k  Pxzk ,k 1 Pzk  1
xk  xk ,k 1  Kk (zk  zk ,k 1 )

Pxk  Pxk ,k 1  Kk Pzk Kk T

where 0 and 0 are the initial state vector and variance-covariance matrix, respectively;   and   are the state and observation vectors for the corresponding sigma points; f and h are the nonlinear motion and observation models, respectively; ,-1 , ,-1and  ,-1 are the time prediction state vector, observation vector and variance-covariance matrix,

43

respectively;  , and   are the time update state vector and variance-covariance matrix, respectively. 3.3.2. Particle Filter PF In contrast with the deterministic sigma points which are simulating Gaussian probability assumption in UKF, PF uses Monte Carlo simulation technique to approximate the nonGaussian probability distribution through a set of weighted samples called particles around the mean state vector  (Doucet et al. 2000). The simulated particles are propagated through the nonlinear motion model yielding the prior probabilistic density which works as an importance density function. Then, the observation probability density function which is obtained from passes the predicted particles through the nonlinear observation model is used to update the importance density particles. Finally, a resampling step is applied to remove the samples with low weights and the posterior probability is redistributed according to the new selected weights. The particles and the corresponding weights prediction and updating are described as follows: 1. Initialize with (k=0)
x0  x0 , wi 0  1 N

 For i =1 ...N, the filter particles are drawn for    from prior P(  ); where,    and P(  ) are the initial state vector and variance-covariance matrix. 2. Importance sampling (k=1: ) The prior probabilistic motion density is used as an importance density by passing the state vector samples through the nonlinear mechanization equations

xi k ,k 1

q(xt : x0:k 1 , y1:k 1 )

3. Measurement updating In the measurements updating step, the time updating samples are passing through the nonlinear measurements system to create the observation probability density;
(Z i : zk ,k 1 )
i P( y1:k : x1 :k 1 )

For i =1 ...N, the importance weight is evaluated as follow;
i i wk  wk 1 * i i i p( yk : x1 :k 1 )p( xt : xk 1 ) q(xk : x0:k 1 , y1:k 1 )

i p( xti : xk 1 )  (f(xk 1 , 0 ), Qk 1 )

44

Normalize the importance weights;
i i wk  wk [

w ]
i k i 1

N

1

Estimation the mean state vector;
xk 



N i 1

i i wk xk ,k 1

4. Resampling step In this step, the samples with high weights are selected and redistributed. The multinomial distribution resampling technique is applied as pointed out by Carpenter et al. (1999).

3.3.3. Unscented Particle Filter (UPF) In addition to the computational cost of employing the traditional PF due to the large samples needed to fit the posterior probability distribution, the major drawbacks of using the traditional PF, is the use of the prior probabilistic motion density as an importance density function. The motion importance density may fail to move the weighted particles toward the high likelihood regions due to the high drift of low-cost inertial sensors, especially during GPS outages. To overcome these limitations, bank of UKFs (sigma points generating) is used for each particle to generate the importance density functions. The UKF based importance density is leading to move the particles   towards the high likelihood regions by producing new particles   with included knowledge about the latest observation. The importance sampling step can be modeled as stated below (Simon 2006). 1. For each particle i=1...N, a set of sigma points are defined for j=1...n as follow:
i, j i xk 1  xk 1 

( n   )Pi k 1 , wi, j 

1 2( n   )

i, j  n i i i, j xk  1  xk 1  ( n   )P k 1 , w

1 2( n   )

2. Sample propagation for each sigma point (time update)
i, j i, j i, j zk ,k 1  h( xk ,k 1 ), zk ,k 1 

w
j 0

2n

i, j

i, j yk ,k 1

i, j xk ,k 1 

w
j 0

2n

i, j

i, j xk ,k 1

45

,j Pzik,k 1 

w
j 0

2n

i, j

i, j i ( zk ,k 1

i, j i, j i, j T  zk ,k 1 ) ( zk ,k 1  zk ,k 1 )

i, j pk,k 1




w
j 0
2n j 0

2n

i, j

i i T (xk ,k 1  xk ,k 1 )(xk ,k 1  xk ,k 1 )

j p xz i, k,k 1

w

i, j

i, j i, j i T (xk ,k 1  xk ,k 1 )(zk ,k 1  zk ,k 1 )

3. Sample update for each sigma point (measurement update)
K ik 
,j i, j 1 p x zi k ,k 1 P z k ,k 1

i, j i i xk  xk ,k 1  Kk (zk  zk ,k 1 )
i, j i T Pki  Pk,k 1  Kk P zk Kk
i xk

q(xt : x0:k 1 , z1:k 1 )

3.4.

Trajectory Test and Result Analysis

A vehicular test was conducted in downtown Kingston, Ontario, to evaluate the performance of the developed integrated GPS-PPP/MEMS-based inertial system. The equipment used comprises the NovAtel SPAN-CPT system and the Trimble R10 GNSS receiver. The SPANCPT system consists of NovAtel OEM4 GPS receiver and a MEMS IMU containing three MEMS-based accelerometers and three fiber optic gyros. Differential carrier phase-based GPS/MEMS-based INS solution was obtained to provide the reference solution. In order to create this reference solution, a Trimble R7 GNSS receiver was setup at a point with precisely known coordinates, which was used as a base station. Dual-frequency raw GPS pseudorange, carrier phase and Doppler measurements were logged at a 1 Hz rate, while the IMU raw data were logged at a 100 Hz rate. The duration of the trajectory test was approximately 55 minutes. Figure 3.2 shows the trajectory test area.

46

Figure 3. 2-Vehicle test trajectory and simulated complete GPS outages. Figure 3.3 shows the positioning solution of the newly developed integrated system for latitude, longitude and altitude, which is compared with the reference solution. As can be seen, all filters can achieve decimeter-level positioning accuracy when no GPS outages are inserted. The results obtained by the various filters agree to the few-centimeter level, which indicate that the effect of nonlinearity on the positioning accuracy is marginal. This means that the use of EKF, which is relatively easier to implement, would be advantageous from the estimation cost point of view.

47

Figure 3. 3-Positioning errors for various filters, with no GPS outages inserted. a. Positioning errors in latitude; b. Positioning errors in longitude; c. Positioning errors in altitude. Figure 3.4 shows the velocity errors in east, north and up directions, respectively, using EKF as a central filter. In comparison with the differential mode, the results show that centimeter/sec-level accuracy can be achieved using a single receiver. Figure 3.5 shows that the difference between the east component of the velocity solutions obtained through PF and 48

UKF, respectively, and that of EKF. As can be seen, the solutions agree to millimeter/sec level. Similar results are obtained for the other two components.

Figure 3. 4-Velocity estimation errors.

Figure 3. 5-Difference between UKF,PF and UPF east velocity estimation results and the altitude estimated using EKF. For attitude determination, because of the absence of external aid in our case, its accuracy depends mainly on the velocity estimation. This is especially correct for the roll and pitch components because of their strong coupling with the horizontal velocities in east and north directions. The accuracy of the estimated azimuth depends mainly on the quality of the gyros used. Figure 3.6 shows the results of the attitude components, differenced from the differential-based solution. As can be seen, both solutions are comparable to a high degree of accuracy.

49

Figure 3. 6-Attitude estimation errors using EKF referenced to differential mode based integrated system.

Figure 3. 7-Difference between UKF,PF and UPF roll estimation results and the estimated roll using EKF. The same criteria are applied for the estimation of the attitude using nonlinear filters. Figure 3.7 compares the results of nonlinear filter with those of EKF. Similar to the velocity solution, all three filters provide comparable attitude results. As a result, based on the positioning, velocities and attitude results during the GPS observations availability, we can conclude that the contribution of using cost computations nonlinear filters such as PF and UPF is not significant and it has marginal effect on navigation parameters estimation. In other words, EKF is extremely significant and more practical considering the simplicity of the filter 50

implementations, for merge the GPS observations and MEMS reading during the availability of GPS observations. However, the benefit of using UPF compared to PF is reducing the number of particles needed to capture high accurate estimation. Both UPF speeded up the navigation parameters estimation with small number of particles needed. Figures 3.8 and 3.9 show the estimation of the pitch angle as an example related to the number of samples needed for PF, UPF. While 500 particles needed for PF to detect the best value for the parameter, the UPF reduced the number of particles to only 100 particles. For UPF, increasing the number of particles is not significantly enhances the estimation accuracy.

Figure 3. 8-Pitch angle based on PF estimation function of number of samples.

51

Figure 3. 9- Pitch angle based on UPF estimation function of UPF number of samples To simulate the challenging conditions of the trajectory trip including high and slow speeds, twelve simulated GPS outages of 60 seconds are introduced. The locations of the outages are shown in figure 3.2. Figure 3.10 shows the positioning errors during GPS outages 2, 5 and 6 as examples. It can be clearly note that meter-level positioning accuracy can be fulfilled for all estimation filters.

(a)

(b)

(c)

(d)

(e)

(f)

52

(g) (h) (i) Figure 3. 10- Positioning accuracy during GPS outages for latitude, longitude, and altitude. Outage 2 (a, d, g); outage 5 (b, e, h) and outage 6 (c, f, i). It can be also seen that the UPF slightly enhanced the positioning accuracy during the GPS outages compared with the tradition estimation filters. In addition, the nonlinear estimation filters failed to present significant improvement in the positioning accuracy compared with the traditional EKF. This is essentially attributed to the use of linear stochastic models, i.e. first order Gaussian Markov process, for all filters to present a unified comparison between the linear and nonlinear estimation filters. In addition, we used fiber optic gyros, as opposed to MEMS-based gyros, which exhibit significantly better behavior. Figure 3.11 shows the average of maximum positioning errors referenced to the DGPS solution during 60s GPS outages. It can be notes that the UPF enhances the positioning accuracy during the GPS outages compared with the EKF by 14%, 13% and 15% in latitude, longitude and altitude, respectively. However, compared with PF the improvements are 6%, 5% and 7% in latitude, longitude and altitude, respectively. It can also be seen that both UKF and EKF present comparable positioning accuracy for the three positioning directions.

53

Figure 3. 11-The average of maximum error for different estimation filters during GPS outages. 3.5. Conclusions

This paper examined the performance of UPF and compared its results with those of UKF, traditional nonlinear PF, and the EKF for tightly-coupled PPP GPS/MEMS-based INS integration. A field trial was conducted to evaluate the performance of the developed system. It has been shown that all estimation filters obtain comparable results in positioning, velocity and attitude, as long as no GPS outages are encountered. However, in comparison with the traditional PF, the use of UPF significantly reduces the number of particles needed to obtain an accurate solution, which speeds up the estimation of navigation parameters. When a complete GPS outage is encountered, the use of UPF enhances the positioning accuracy by up to average 15%, in comparison with other estimation filters. 3.6. References

Bergman, N. (2001). Posterior Cramér-Rao bounds for sequential estimation. In Sequential Monte Carlo methods in practice. Springer: New York, NY, USA, pp. 321­338. Brown, R. G., and Hwang, P. Y. (1992). Introduction to random signals and applied Kalman filtering (Vol. 3), John Wiley & Sons: New York, NY, USA.. 54

Caron, F., Davy, M., Duflos, E., and Vanheeghe, P. (2007). Particle filtering for multisensor data fusion with switching observation models: Application to land vehicle positioning. Signal Processing, IEEE Transactions on, 55(6), 2703-2719. Carpenter, J., Clifford, P., andFearnhead, P. (1999). Improved particle filter for nonlinear problems. IEE Proceedings-Radar, Sonar and Navigation, 146(1), 2-7. Collins, P., Bisnath, S., Lahaye, F., and Héroux, P. (2010). Undifferenced GPS ambiguity resolution using the decoupled clock model and ambiguity datum fixing. Navigation, 57(2), 123-135. Doucet, A., Godsill, S., and Andrieu, C. (2000). On sequential Monte Carlo sampling methods for Bayesian filtering. Statistics and computing, 10(3), 197-208. El-Sheimy, N., Schwarz, K. P., Wei, M., and Lavigne, M. (1995). VISAT: a mobile city survey system of high accuracy. In Proceedings of the 8th International Technical Meeting of the Satellite Division of The Institute of Navigation, Palm Springs, CA, pp. 1307-1315). Gao, Y., and Chen, K. (2004). Performance analysis of precise point positioning using reatime orbit and clock products. Journal of Global Positioning System, 3, 95-100. Ge, M., Gendt, G., Rothacher, M., Shi, C., and Liu, J. (2008). Resolution of GPS carrierphase ambiguities in precise point positioning (PPP) with daily observations. Journal of Geodesy, 82(7), 389-399. Geng, J., Bock, Y., Melgar, D., Crowell, B. W., and Haase, J. S. (2013). A new seismogeodetic approach applied to GPS and accelerometer observations of the 2012 Brawley seismic swarm: Implications for earthquake early warning. Geochemistry, Geophysics, Geosystems, 14(7), 2124-2142.

55

Geng, J., Shi, C., Ge, M., Dodson, A. H., Lou, Y., Zhao, Q., and Liu, J. (2012). Improving the estimation of fractional-cycle biases for ambiguity resolution in precise point positioning. Journal of Geodesy, 86(8), 579-589. Georgy, J., Noureldin, A., Korenberg, M. J., and Bayoumi, M. M. (2010). Low-cost threedimensional navigation solution for RISS/GPS integration using mixture particle filter. Vehicular Technology, IEEE Transactions on, 59(2), 599-615. Giremus, A., Tourneret, J. Y., and Djuric, P. M. (2005, June). An improved regularized particle filter for GPS/INS integration. In Signal Processing Advances in Wireless Communications, 2005 IEEE 6th Workshop on (pp. 1013-1017). Grejner-Brzezinska, D. A., Da, R., and Toth, C. (1998). GPS error modeling and OTF ambiguity resolution for high-accuracy GPS/INS integrated system. Journal of Geodesy, 72(11), 626-638. Haug, A. J. (2005). A tutorial on Bayesian estimation and tracking techniques applicable to nonlinear and non-Gaussian processes. MITRE Corporation, McLean. Jekeli, C. (2001). Inertial navigation systems with geodetic applications. Walter de Gruyter. Julier, S. J., Uhlmann, J. K., and Durrant-Whyte, H. F. (1995, June). A new approach for filtering nonlinear systems. Vol. 3, In American Control Conference, Proceedings of the 1995 Seattle, WA, USA, pp. 1628-1632. Kouba, J. (2009). A guide to using International GNSS Service (IGS) products. International GNSS. Online Publication at IGS Website, May 2009. Available online:

ftp://ftp.igs.org/pub/resource/pubs/UsingIGSProductsVer21.pdf. Kouba, J., and Héroux, P. (2001). Precise point positioning using IGS orbit and clock products. GPS solutions, 5(2), 12-28.

56

Leandro, R. F., Langley, R. B., and Santos, M. C. (2008). UNB3m_pack: a neutral atmosphere delay package for radiometric space techniques. GPS Solutions, 12(1), 65-70. Nassar, S., and El-Sheimy, N. (2005). Wavelet analysis for improving INS and INS/DGPS navigation accuracy. Journal of Navigation, 58(01), 119-134. Petovello, M. G., Cannon, M. E., and Lachapelle, G. (2004). Benefits of Using a Tactical Grade IMU for HighAccuracy Positioning. Navigation, 51(1), 1-12. Rabbou, M. A., and El-Rabbany, A. (2014). Tightly coupled integration of GPS precise point positioning and MEMS-based inertial systems. GPS Solutions, 1-9, doi:10.1007/s10291014-0415-3. Rabbou, M. A., and El-Rabbany, A. (2015). Precise Point Positioning using MultiConstellation GNSS Observations for Kinematic Applications. Journal of Applied Geodesy, 9(1), 15-26. Shi, J., and Gao, Y. (2014). A comparison of three PPP integer ambiguity resolution methods. GPS Solutions, 18(4), 519-528. Simon, D. (2006). Optimal state estimation: Kalman, H infinity, and nonlinear approaches. John Wiley & Sons,Hoboken, NJ, USA. Steffen, R. (2008). A Robust Iterative Kalman Filter Based On Implicit Measurement Equations. Technical Report 8, University of Bonn, Department of Photogrammetry, Institute of Geodesy and Geoinformation. Teunissen, P., (1991). On the Local Convergence of the Iterated Extended Kalman Filter. Available http://saegnss1.curtin.edu.au/Publications/1991/Teunissen1991local.pdf. Xu, P., Shi, C., Fang, R., Liu, J., Niu, X., Zhang, Q., and Yanagidani, T. (2013). High-rate precise point positioning (PPP) to measure seismic wave motions: an experimental 57 online:

comparison of GPS PPP with inertial measurement units. Journal of Geodesy, 87(4), 361372. Yi, Y., and Grejner-Brzezinska, D., A. (2006). Tightly-coupled GPS/INS integration using unscented Kalman filter and particle filter. In Proceedings of the 19th International Technical Meeting of the Satellite Division of the Institute of Navigation, Fort Worth, TX, USA, pp. 2182­2191. Zhou, J., Knedlik, S., and Loffeld, O. (2010). INS/GPS tightly-coupled integration using adaptive unscented particle filter. Journal of Navigation, 63(03), 491-511. Zumberge, J. F., Heflin, M. B., Jefferson, D. C., Watkins, M. M., and Webb, F. H. (1997). Precise point positioning for the efficient and robust analysis of GPS data from large networks. Journal of Geophysical Research: Solid Earth (1978­2012), 102(B3), 50055017.

58

4. Precise Point Positioning using Multi-Constellation GNSS Observations for Kinematic Applications © 2015 by the authors; licensee De Gruyter, Berlin, German In this chapter, multi-constellation GNSS PPP algorithms for precise kinematic applications, which combine observations from three GNSS systems, namely GPS, GLONASS and Galileo are developed. Both undifferenced and between-satellite single difference GNSS PPP techniques are developed and compared. The inter-system biases between the GPS and other GNSS systems are also studied.

The following manuscript was originally published as:

Abd Rabbou, M., and

El-Rabbany, A. (2015). Precise Point Positioning using Multi-

Constellation GNSS Observations for Kinematic Applications. Journal of Applied Geodesy, 9(1), 15-26.

Modifications to the original manuscript were made only for proper identification of sections, figures and tables to assure uniformity within this dissertation.

59

Precise Point Positioning using Multi-Constellation GNSS Observations for Kinematic Applications Abstract Traditional precise point positioning (PPP) is commonly based on undifferenced ionospherefree linear combination of Global Positioning System (GPS) observations. Unfortunately, for kinematic applications, GPS often experiences poor satellite visibility or weak satellite geometry in urban areas. To overcome this limitation, we developed a PPP model, which combines the observations of three global navigation satellite systems (GNSS), namely GPS, GLONASS and Galileo. Both undifferenced and between-satellite single-difference (BSSD) ionosphere-free linear combinations of pseudorange and carrier phase GNSS measurements are processed. The performance of the combined GNSS PPP solution is compared with the GPS-only PPP solution using a real test scenario in downtown Kingston, Ontario. Intersystem biases between GPS and the other two systems are also studied and obtained as a byproduct of the PPP solution. It is shown that the addition of GLONASS observations improves the kinematic PPP solution accuracy in comparison with that of GPS-only solution. However, the contribution of adding Galileo observations is not significant due to the limited number of Galileo satellites launched up to date. In addition, BSSD solution is found to be superior to that of traditional undifferenced model. Keywords: GNSS, GPS, GLONASS, Galileo, PPP, Inter-system bias 4.1. Introduction

Precise point positioning (PPP) utilizes observations from a single receiver and can obtain positioning accuracy comparable to that of differential positioning. Depending on the quality of observations, satellite availability and geometry, and resolution of integer ambiguity parameters, centimeter and decimeter level positioning accuracy can be achieved for static 60

and kinematic applications, respectively. Unfortunately, GPS PPP accuracy and solution availability are severely degraded in urban canyons and downtown areas as a result of limited satellite availability and poor geometry. This limitation, however, can be overcome through the addition of more observations from other GNSS systems, such as GLONASS and Galileo. With the availability of multi-constellation precise orbit and clock products from the new IGS project known as IGS-MGEX (Montenbruck et al. 2014), GNSS PPP, which combines GPS, GLONASS, and Galileo observations, becomes feasible. Previous PPP studies combined GPS and GLONASS observations using undifferenced ionosphere-free linear combination. The results of those studies showed that, when a limited number of GPS satellites were visible, the accuracy of kinematic PPP could be improved through the addition of GLONASS observations (Cai and Gao 2007 and Choy et al. 2013). However, when enough GPS satellites with good geometry were available, the addition of GLONASS satellites had a marginal effect on the daily static PPP. A number of researchers investigated the contribution of adding Galileo observations on the GPS/Galileo ambiguity resolution using simulated Galileo observations (e.g., Zhang et al. 2003 and Julien et al. 2004). Following the launch of the two experimental Galileo In-Orbit Validation Element (GIOVE) satellites, namely GIOVE-A in December 2005 and GIOVE-B in April 2008, other researchers investigated the combinations between GPS and GIOVE observations (e.g., Píriz et al. 2008; Montenbruck et al. 2011; and Steigenberger et al. 2011). The main focus of those studies was on the determination of the GPS/GIOVE time offset (GGTO) and inter-system bias (ISB) between the two satellite systems. Due to the limited number of Galileo satellites, the expected contribution of adding Galileo satellites on the positioning solution was marginal. More recently, four in-orbit validation (IOV) Galileo satellites were launched on October 21, 2011 and October 12, 2012, respectively, which 61

allowed for satellite positioning using Galileo-only signals. On August 22, 2014, the first two Galileo final operational capability (FOC) satellites were launched. Unfortunately, however, due to a launch problem the two satellites were inserted into the wrong orbits. In this paper, a PPP model is developed, which combines the observations of GPS, GLONASS and Galileo systems, for kinematic applications. Both undifferenced and BSSD ionosphere-free linear combinations of pseudorange and carrier phase GNSS measurements are processed using precise clock and orbital products obtained from the multi-GNSS experiment MGEX (Montenbruck et al. 2014). However, because the unavailability of

GLONASS satellite clock corrections from the IGS-MGEX on the test day, IGS GLONASS satellite clock corrections are used to account for GLONASS satellite clock errors. The performance of the developed PPP model is assessed using a kinematic dataset, which was collected in downtown Kingston, Ontario. It is shown that the positioning accuracy is improved when the observations of the three constellations are combined. In addition, the positioning accuracy of BSSD IF model is superior to that of the traditional undifferenced model. 4.2. Multi-constellation GNSS PPP Mathematical Model

In this research, both undifferenced and between-satellite single difference ionosphere-free models are considered. The general ionosphere-free pseudorange and carrier-phase observation equations for a GNSS receiver r and a satellite s can be written as (HofmannWellenhof et. al. 2008):
2 fi 2 P i  f j Pj

P 3=

fi 2  f j 2

=  +cd tr - cd t s +T +c( Ad r i - Bd r j )  c( Ad s i - Bd s j ) +e

4.1

62

3 =

fi 2i -f j 2 j fi 2  f j 2

= +cdtr -cdt s +T +c(A r i -B r j )  c(A s i -B s j )+(  N )+

4.2

where i and j refer to the frequencies used in forming the ionosphere-free linear combination;  and  are pseudorange measurements on Li and Lj , respectively;  and  are the carrier phase on Li and Lj , respectively;  and   are the receiver and satellite clock errors, respectively;  and   are frequency-dependent code hardware delay for receiver and satellite, respectively;  and   are frequency-dependent carrier phase hardware delay for receiver and satellite, respectively; e,  are relevant system noise and un-modeled residual  is ionosphere-free combination of the ambiguity term for phase errors; and  measurements. For the undifferenced ionosphere free linear combination, this term is not  =  integer due to the non-integer nature of the combination coefficients, 
2

  -2   2 -2

,

where  and  are the  and  non-integer ambiguity parameters, including the initial phase biases at the satellite and the receiver, respectively;  and  are the wavelengths of the  and  carrier frequencies, respectively; c is the speed of light in vacuum; T is the tropospheric delay component;  is the true geometric range from the antenna phase center of the receiver at reception time to the antenna phase center of the satellite at transmission time.
  A and B are frequency dependent factors A= 2 - 2 and B =  2 -2 . Using Equations (1) and (2)    

 2

 2

and taking the GPS time as the common reference time for all receiver measurements, the general ionosphere-free linear combinations of GPS, GLONASS and Galileo observations can be written as:
s s1 s2 P ] +eG 3G = G +cdtr -cdt G +TG +c[A G d r1 -BG d r 2 ] -c[AG d -BG d

4.3 4.4 4.5 4.6

s s1 s5 P 3E = E +cdtr -cdt E +TE +c[AE d r1 -BE d r 5 ]-c[AE d -BE d ]+GEoff  eE s s1 s2 P ] +GRoff +eR 3R = R +cdtr -cdt R +TR +c[AR d r1 -BR d r 2 ] -c[AR d -BR d

3G =G +cdtr -cdt sG +TG +c[AG r1 -BG r2 ] -c[AG s1 -BG s 2 ] +(  N )G + G

63

3E =E +cdtr -cdt s E +TE +c[AE  r1 -BE r 5 ]E -c[AE  s1 -BE  s5 ] +GEoff  (  N )E + E 3R =R +cdtr -cdt s R +TR +c[AR r1 -BR r 2 ] -c[AR s1 -BR s 2 ] +GRoff +(  N )R + R
4.8

4.7

where G, R and E refer to GPS, GLONASS and Galileo systems, respectively;  and  are the GPS/GLONASS and GPS/Galileo system offsets, respectively, which result from differences in the system time frames. To avoid a rank-defect system, some parameters are lumped together in our model. In our combination model, to ensure consistency, only one receiver clock error lumped with ionosphere-free combination of GPS differential code bias, is considered as unknown for all GNSS systems. Therefore, both  and  will be lumped with the GPS/GLONASS and GPS/Galileo code biases difference, respectively, leading to inter-system code bias  and  in pseudorange measurement. For phase measurements,  and  will be lumped to GPS/GLONASS and GPS/Galileo receiver phase biases difference, respectively, leading to inter-system phase bias  and  . Unfortunately, both  and  cannot be estimated separately as the system will be underdetermine. Only  =  and  =  will be estimated as a common inter-system bias unknowns in both code and phase measurements of GLONASS and Galileo, respectively. Also, as the phase and code measurements for the three GNSS systems are combined, considering one receiver clock unknown lumped with ionosphere-free combination of GPS differential code bias in both measurement types, each GNSS ambiguity parameters will be combined with each system ionosphere free combination of the receiver code biases. Moreover, considering the IGS satellite clock corrections, which are estimated based on code measurements for the three GNSS systems and are combined with the satellite code biases, an additional ionosphere-free combination of satellite code biases will be lumped with the ambiguity parameters. With the above considerations,

Equations (4.3) to (4.8) may be written in a more compact and simplified form as:

64

r s s P 3G = G +c[dtr +IFCD G ] -c[dt G +IFCD G ] +TG +eG
r s s P 3E = E +c[dtr +IFCD G ] -c[dt E +IFCD E ] +TE +c[ISBE ] +eE r s s P 3R = R +c[dtr +IFCD G ] -c[dt R +IFCD R ] +TR +c[ISBR ] +eR

4.9 4.10 4.11 4.12 4.13 4.14

3G =G +c[ dtr +IFCDr G ] -c[ dt sG +IFCD sG ] +TG +(  N+IFBD r -IFB Ds )G + G

3E =E +c[dtr +IFCDr G ] -c[dt s E +IFCD s E ] +TE +c[ISBE ] +(  N+I FBDr -IFBDs )E + E

3R =R +c[dtr +IFCDr G ] -c[dt s R +IFCD s R ] +TE +c[ISBR ] +(  N+I FBDr -IFPDs )R + R

where IFCDr , IFCDs , ISB and IFBDr are different GNSS biases components which described on Table 4.1. Table 4. 1-Different GNSS biases affecting the GNSS observations and their definitions
GNSS biases
IFCDr G =[AG dr1 -BG dr 2 ] & IFCD sG  [AG d s1 -BG d s 2 ]
IFPDr G =[AG r1 -BG r 2 ] & IFPDsG  [AG s1 -BG s 2 ]

Definition Ionosphere-free differential code biases for GPS receiver and satellite, respectively Ionosphere-free differential phase biases for GPS receiver and satellite, respectively Ionosphere-free differential code biases for Galileo receiver and satellite, respectively Ionosphere-free differential phase biases for Galileo receiver and satellite, respectively Ionosphere-free differential free code biases for GLONASS receiver and satellite, respectively Ionosphere-free differential phase biases for GLONASS receiver and satellite, respectively GPS/Galileo inter phase bias GPS/GLONASS inter phase bias GPS/Galileo inter-system bias GPS/GLONASS inter-system bias Difference between ionosphere-free differential receiver code and phase biases Difference between ionosphere-free differential satellite code and phase biases

IFCDr E =[AE dr1 -BE dr 5 ] & IFCD s E  [AE d s1 -BE d s5 ]

IFPDr E =[AE r1 -BE r 5 ] & IFPDs E  [AE s1 -BE s5 ]

IFCDr R =[AR dr1 -BR dr 2 ] & IFCDs R  [AR d s1 -BR d s 2 ]

IFPDr R =[AR r1 -BR r 2 ] & IFPDs R  [AR s1 -BR s 2 ]
ISPBE =[IFPDr G -IFPD r E ] +GEoff ISPBR =[IFPDr G -IFPD r R ] +GRoff ISBE =[IFCDr G -IFCDr E ]+GEoff ISBR =[IFCDr G -IFCDr R ] +GRoff
I FBDr =c [ I FPDr - I FCD r ]
I F B D s =c [ I F P D s - I F C D s ]

To develop the mathematical equations for BSSD, we refer to the GPS satellite by k, Galileo satellite by m, and GLONASS satellite by n. GPS satellite l is taken as the reference satellite to form BSSD ionosphere-free linear combination.
l k l s s k s s l k l k l Pk 3G -P 3G = G -G -c[(dt G +IFCD G ) -(dt G +IFCD G ) ] +TG -TG +eG -eG

4.15

65

m l m l s s m s s l m l m l P E -P G = E - G -c[(dt E +IFCD E ) -(dtG +IFCD G ) ] +TE -TG +c[IS BE ] +eE -eG
n l n l s s n s s l n l n l P R -P G = R - G -c[(dtR +IFCD R ) -(dtG +IFCD G ) ] +TR -TG +c[IS BE ] +eR -eG
k l k l s s k s s l k l 3 G - 3 G = G - G - c [ ( d t G + I F C D G ) - ( d t G + I F C D G ) ] + TG - TG k l + [ (  N - I F B D s )k - (  N - I F B D s )l ]   G - G

4.16 4.17 4.18

m l m l m l E - G = E - G - c [ ( d t E s + I F C D s E )m - ( d tG s + I F C D s G )l ] + TE - TG + c [ I S BE ] m l m l + [ (  N+ I F B D r - I F B D s )E -(  N+ I F B D r - I F B D s )G ]  E - G

4.19

n l m l n l R - G = R - G - c [ ( d t R s + I F C D s R )n - ( d tG s + I F C D s G )l ] + TR - TG + c [ I S BR ] n l n l + [ (  N+ I F B D r - I F B D s )R -(  N+ I F B D r - I F B D s )G ]  R - G

4.20

Other form of BSSD model may be obtained by taking a reference satellite from each system. Unfortunately, due to the limited number of Galileo satellites at present, which was dropped to one satellite during our observation time, this way of forming BSSD is not adopted in this paper. Also, due to the dissimilarities of GLONASS satellite frequencies, taking a GLONASS satellite as a reference will not completely cancel out the GLONASS receiver errors and biases. However, as can be seen in Equations 4.15 through 4.20, the receiverrelated errors and biases such as the clock offset and code biases are cancelled out for the GPS system observations and are expected to be reduced for GLONASS and Galileo observations when forming our BSSD mathematical equations. Nevertheless, forming BSSD leads to mathematical correlations among the observations, which must be taken into account when the covariance matrix of the observations is formed (El-Sobeiey and El-Rabbany 2014). 4.3. Sources of GNSS Time Offsets and Biases

Differences in GNSS system time scales and coordinate reference frames, as well as intersystem biases among the GNSS systems must be taken into account in order to make effective use of the additional information. Each GNSS system operates on an independent time scale and reference frame. This means that the satellite clock corrections for a particular GNSS system are estimated on an individual time scale based on the corresponding broadcast ephemeris; thus, creating different receiver clock offsets for each set of GNSS system 66

observations. In order to deal with this challenge, receiver clock offsets can be estimated for each system separately. However, the drawback of this technique is that the number of unknowns will be increased by one for each GNSS system added. The minimum number of satellites for the combined GNSS solution will be (3+j), where j is the number of systems used. For kinematic applications, especially in dense areas, increasing the number of unknowns might be critical and might create difficulties in obtaining a good solution. Another option is to estimate the satellite clock corrections for all GNSS on a single time scale, which avoids differing GNSS time offsets. Fortunately, MGEX precise orbit and clock corrections for all GNSS systems are estimated using a single reference time scale and reference frame (Steigenberger et al. 2014). However, different time scales are considered when the traditional IGS clock products are estimated for GPS and GLONASS systems. Figure 4.1.a shows a comparison between IGS and MGEX GLONASS clock correction for PRN2 at DOY 1 year 2014 while Figure 4.1.b shows the GPS/GLONASS system time offset which obtained from the difference between the two clock correction products for number of GLONASS satellites.

Figure 4. 1-Difference between two provider GLONASS satellite clock corrections, a. comparison between IGS and MGEX clock corrections for PRN 02 and b. difference between the two clock correction products.

67

On the other hand, the user receiver must reference all GNSS signals to the same oscillator and receiver clock. Otherwise system biases will result in a different receiver clock offset for each system. Fortunately, to the authors' knowledge, all modernized GNSS receivers reference all GNSS measurements to the same receiver clock. As a result, the GNSS time scale offsets originated in the GNSS user receiver should be mitigated, up to small residual errors, before the GNSS data is processed. The signal path through the antenna, splitter, cabling, and amplifier produces hardware signal biases; however, these biases can be considered insignificant, especially their effects on the system biases. The remaining sources of system biases originate from the GNSS receiver processing filtering and correlators differences handling GNSS signal modulation and bandwidth dissimilarities (Phelts 2007). These biases are highly aggravated based on the receiver characteristics such as receiver type, firmware used, correlation spacing, and receiver filter characteristics. Even in a single GNSS system, signals with different frequencies produce different receiver biases through receiver filtering processing; thus, creating the bulk of receiver code hardware delay,  and phase hardware delay  . The same criteria are applied to the different satellite signals, which lead to the satellite code hardware delay,   and phase hardware delay   . Although satellite signals have the same frequencies in some GNSS systems, such as GPS and Galileo, satellite signal bias exists due to the slight spectrum differences of the correlation function for each PRN satellite (Phelts 2007). Both the receiver and satellite biases are experienced at much higher values for code compared with carrier phase observations. As a result, we can conclude that the system biases between different GNSS system observations have similar values found in code and carrier observations. These are represented in Equations (4.4), (4.5), (4.7) and (4.8) as  and  , which represent the 68

GPS/GLONASS and GPS/Galileo system offsets, respectively. Along with employing modernized GNSS receivers which reference all GNSS measurements to the same receiver clock oscillator, these biases will be existed when multi-time scales based GNSS clock corrections are used such as the classic IGS GPS and GLONASS clock products. However, these biases are accounted for when IGS-MGEX clock corrections are used for both Galileo and GLONASS as only GPS time scale is used as a reference. As a single receiver clock unknown is estimated herein,  and  are lumped with the difference of ionospherefree combination of the receiver code biases between GPS and GLONASS, and GPS and Galileo, respectively creating  and  respectively as stated in Equations (4.10), (4.11), (4.13) and (4.14) and shown in our results. GPS/GLONASS ISB based on PPP estimation with different receiver types was studied by Cai and Gao (2008). They confirmed the presence of GPS/GLONASS inter-system bias, which varies depending on the receiver type with a discrepancy among the receivers of up to 170 ns. MGEX has been producing daily GPS/Galileo inter-system bias for its GNSS station network, which uses different receiver types. Figure 4.2 shows the inter-system bias for a number of MGEX stations for different days in 2012. As shown in Figures 4. 2 a, b, and c, the GPS/Galileo ISB is receiver-dependent. Significant ISB increase for all stations is noted on December 12, 2012 (DOY 347), as can be seen in Figure 4.2 b. Coincidentally, our vehicular test was conducted on the same day, DOY 347. The same ISB was also noted when we analyzed our vehicular test data using the newly developed algorithm. To confirm the obtained anomalous ISB results, we made a personal contact with the European GNSS service center through its website contact form. The center confirmed the anomalous ISB on DOY 347 and indicated that Galileo satellites were still completing their in-orbit tests (GSC 2014). Figure 2.d shows the change of GPS/Galileo ISBs for the same receiver type (Station CUT0) over time. It can be seen that both DOY 347 and 355 are featured with significant ISB 69

values, which suggest that these significant values may be a result of the satellite clock frequency jumps on that day, which often occur to newly launched systems, as stated in Heo et al. (2012).

Figure 4. 2-GPS/Galileo ISBs products published by MGEX-IGS 4.4. Process Model

The GNSS raw pseudorange and phase measurements are processed to produce estimates of the extended Kalman filter (EKF) state vector. Except for GLONASS, the IGS-MGEX final precise orbital and clock products are used to mitigate the satellite orbit and clock errors (Montenbruck et al. 2014). The IGS clock products are used to correct for the GLONASS clock errors due to the unavailability of MGEX GLONASS clock corrections for the test days. The UNB3 tropospheric model, consisting of the Saastamoinen vertical propagation delay model and Niell mapping function, is used to account for the dry tropospheric component (Leandro et al. 2008). The effects of ocean loading, Earth tide, carrier-phase windup, sagnac, relativity, and satellite antenna phase-centre variations are rigorously 70

modeled as detailed in Kouba (2009). EKF is employed to process different GNSS measurements as presented in Jekeli (2001). For undifferenced model, the estimation state vector consists of the three GNSS receiver positions mainly latitude, longitude, and altitude, receiver clock, wet component of zenith tropospheric delay, GPS/GLONASS inter-system bias, GPS/Galileo inter-system bias, and the float ambiguity parameters. However in BSSD model, the receiver clock is eliminated. Two key steps are applied to EKF: prediction step and update step. These steps are described in Jekeli (2001) and are summarized here as follows: The prediction step is given by
 xk ,k 1  k ,k 1 xk 1
T P k ,k 1  k ,k 1 P k 1k ,k 1  Qk

4.1 4.22

The update step is given by
T T 1 1 Kk  Pk ,k 1H k ( H k Pk ,k 1H k  P obs )

4.23 4.24 4.25

Pk  ( I  Kk H k )Pk ,k 1

 xk   xk ,k 1  Kk (  Zk  H k  xk ,k 1 )

where xk,k-1is the updated error state vector. The complete state vector for the undifferenced model can be written as:
 xk ,k 1  [ ,  ,  h, Tw , cdtr , cISBR , cISBE , N1 , . . N n ]
4.26

where  ,  and h are a three-dimensional vector representing the positioning errors in latitude, longitude and altitude.  is the wet component of the tropospheric delay,  is the GPS receiver clock offset lumped by the GPS receiver ionosphere-free combination of code biases as stated on Section 2. Both  and c are GPS/GLONASS and GPS/Galileo inter-system biases in meters as defined in Table 4.1. However, the GPS/Galileo time offset 71

is eliminated from  as IGS MGEX satellite clock corrections are used for Galileo system  is the float ambiguity in meters lumped by receiver and satellite code bias herein.  combinations terms as described in Section 4.2.  is the covariance matrix for the GNSS measurements state.  is the Kalman gain, where k is the epoch number. ,-1is the variance-covariance matrix for the prediction state.  is the process noise covariance matrix. ,-1 is the EKF state transition matrix which is defined as the identity matrix. The positioning errors, the receiver clock error, troposphere wet component and the ISB parameters are modeled as a random walk process (Cai and Gao, 2008). The initial state vector variances and process noise variances are described in Table 4.2. The ISBs are estimated as time-varying parameters to examine their stability over time. Therefore, they are assigned large process noise variances.  is the design matrix, which relates the measurement vector by the error state vector for the undifferenced model. It is described by:
 AG  R A  AE     G B   BR  E B   mG 1 0 0 0 mG 1 1 0 0 mG 1 0 1 0 mG 1 0 0 1 m 11 0 0 mG 1 0 1 0
G

Hk

0  0 0   0  0  1  

4.27

where  = ,  =



 

, are the partial derivatives of the pseudorange and carrier-phase

measurements, respectively, with respect to the receiver position p. To form BSSD, observation single difference should be applied on the design matrix. Also, the mathematical correlation between GNSS observations should be taken into account when the relative observation variance covariance matrix is formed. Both the BSSD design matrix and

72

observation variance covariance matrix can be defined as in Abd Rabbou and El-Rabbany, 2014. Table 4. 2-EKF state vector initial variances and process noise variances States Latitude Longitude Altitude Receiver clock Troposphere wet component GPS/GLONASS ISB GPS/Galileo ISB Ambiguity parameters Initial variance 1e-10  2 1e-10  2 1000 2 100000 2 100 2 10002 10002 1002 Process noise variance 1e-20  2 / 1e-20  2 / 50 2 / 100 2 / 1e-4 2 / 10 2 / 10 2 / 0

4.5.

Kinematic Tand Results Analysis

A vehicular test was conducted in order to evaluate the performance of the developed combined GNSS PPP models for kinematic applications. The test was carried out in the downtown core of the City of Kingston, Ontario, on December 12, 2012. Trimble R10 GNSS receiver was employed to collect the kinematic GNSS observations. The positioning accuracy was assessed with reference to the carrier-phase-based differential GNSS (DGNSS) solution. In order to create this reference solution, a GNSS Trimble R7 receiver was setup as a nearby base station with precisely known coordinates. To investigate the variations in GNSS ISBs corresponding to different receiver types both GNSS Trimble R10 kinematic data and GNSS Trimble R7 static data are processed. As, the GNSS Trimble R7 is not tracking Galileo satellites, a static test was carried out in Toronto, Ontario, on December 13, 2012 using both Trimble R10 and Trimble R7 GNSS receivers. The second test was performed to show the variation in GNSS ISB corresponding to different days using the same receiver types. The raw dual-frequency GNSS pseudorange and carrier phase were collected at a rate of 1 Hz. The satellite availability for both kinematic and static tests is shown in Figure 4.3. As can be 73

seen, the satellite availability during the second half of the kinematic test exhibits high variations, which is typical in urban areas due to obstructions and signal blockage.

Figure 4. 3-Visible GNSS satellites during the tests: a. Kingston kinematic trajectory test and b. Toronto static test Figure 4.4 shows the GPS/GLONASS and GPS/Galileo ISBs results based on PPP kinematic estimation through our indifference model. Figure 4.4.a and b show the GPS/GLONASS ISB for the Kingston data set on DOY 347 and Toronto data set on DOY 348 for GNSS Trimble R10 and GNSS Trimble R7, respectively. Figure 4.4.c and d, on the other hand, show the GPS/Galileo ISB for GNSS Trimble R10 for the Kingston data sets on DOY 347 and Toronto data set on DOY 348, respectively. As shown in Figure 4.4, both GPS/GLONASS and GPS/Galileo ISBs are largely stable over the test period, exhibiting small variations with RMS values of 2.5 cm and 3.0 cm for the R7 and R10 receivers, respectively. In addition, it can be seen through comparison of Figure 4.a and b that GPS/GLONASS ISB has changed significantly with different receiver types. It should be emphasized that the GPS/GLONASS ISB includes the GPS/GLONASS system offset as the classic IGS GLONASS clock products are used, which are referenced to GLONASS time frame. However, as the system time offset is almost constant over a short time span and independent of the receiver type, the significant difference between the values of the  for Trimble R7 and R10 as shown in Figure 4 is likely due to the difference in the correlators of the two receiver generations. As well, comparing the GPS/Galileo ISB for DOY 348, with Trimble R10 receiver used (Figure 74

4.4.d), with the GPS/Galileo ISB for station CUT0, with Trimble NET R9 receiver used (Figure 4.2.c), indicates that GPS/Galileo ISB is also receiver type dependent. Moreover, although the same receiver type is used, the GPS/Galileo ISB on DOY 347 is much higher than that on DOY 348 (Figure 4.4.c and d), which conforms to the IGS-MGEX ISB estimation presented in Section 4.2 (Figure 4.2 b). The high ISB values on DOY 347 are due to the Galileo system clock anomaly on that day as outlined in Section 4.3. As well, the results of the inter-system biases for two successive days, namely DOY 347 and DOY 348, are showing different ISB mean values for the same receiver type which conforms to the IGS-MGEX ISB daily estimation presented in Section 4.2 (Figure 4.2 a, b and c).

Figure 4. 4-.GNSS ISBs based on PPP estimation Figure 4.5 shows the GNSS PPP positioning results for the Kingston data set based on both our undifferenced and BSSD ionosphere-free PPP algorithms. Three GNSS combinations were studied: GPS only, combined GPS and GLONASS, and combined GPS, GLONASS and 75

Galileo. Figures 5.a, b and c show the GNSS positioning accuracy for latitude and longitude and altitude, respectively, using the undifferenced ionosphere-free PPP algorithm, while Figures 4.5.d, e and f show the GNSS positioning accuracy for latitude and longitude and altitude, respectively, using the BSSD ionosphere-free PPP algorithm. As can be seen, the results of both algorithms show decimetre-level positioning accuracy. However, it can be seen that the BSSD IF model slightly enhances the positioning accuracy in comparison to the undifferenced model. As expected, due to the limited number of visible Galileo satellites, which varied between one and two satellites during the test, the contribution of Galileo observations is not significant. It can also be seen that the accuracy of the PPP solution has improved through the addition of GLONASS observations. However, as shown in Figure 4.5, the improvement in the PPP solution is not consistent over the test period, which might be attributed to the changes in the relative geometry of the visible GPS and GLONASS satellites.

76

Figure 4. 5-Positioning accuracy based on undifferenced and BSSD ionosphere-free PPP techniques using GPS only, combined GPS and GLONASS, and combined GPS, GLONASS and Galileo. Table 4.3 shows the statistical characteristics, including the maximum error, the mean errors, and the root mean square errors (RMSE), of the various GNSS combinations for both undifferenced and BSSD ionosphere-free PPP solutions for the Kingston data set. Comparing the mean errors and the RMSE for all GNSS combinations, it can be seen that the positioning precision has generally improved by adding GLONASS and Galileo observations. In addition, the BSSD model is found to be superior to that of the traditional undifferenced model. Table 4. 3-Statistical parameters for GNSS PPP solutions for the Kingston Trajectory
PPP-Technique GNSS systems Positioning max (m) mean(m) RMSE(m) PPP-Technique GNSS systems Positioning max(m) mean(m) RMSE(m) GPS+GLONASS+Galileo Latitude 0.101 -0.032 0.038 longitude 0.077 -0.012 0.030 Altitude 0.093 -0.043 0.057 latitude 0.103 -0.034 0.042 GPS+GLONASS+Galileo Latitude 0.109 -0.008 0.029 longitude 0.170 0.016 0.051 Altitude 0.226 0.004 0.062 latitude 0.105 -0.019 0.036 undifferenced Ionosphere-free PPP GPS+GLONASS longitude 0.146 0.034 0.056 altitude 0.238 0.010 0.064 latitude 0.118 0.011 0.042 GPS longitude 0.232 0.099 0.103 altitude 0.268 0.110 0.117

BSSSD Ionosphere-free PPP GPS+GLONASS longitude 0.084 -0.006 0.029 altitude 0.075 -0.054 0.062 latitude 0.123 0.003 0.040 GPS longitude 0.172 0.039 0.059 altitude 0.255 0.029 0.074

77

4.6.

Conclusions

We developed a PPP model, which combines the observations of multi-constellations GNSS systems, including GPS, GLONASS, and Galileo for kinematic applications. Both GPS/GLONASS and GPS/Galileo ISBs are studied based on PPP kinematic estimation. The results show that both ISBs are system and receiver dependent, with significant differences between the ISBs of different receiver types. To examine the contributions of adding GLONASS and Galileo observations to existing GPS PPP model, a vehicular test was carried out in the downtown core of Kingston, Ontario. Both undifferenced and BSSD ionospherefree linear combinations of code and carrier phase measurements are considered. The PPP solutions of three GNSS scenarios are examined, namely GPS only, combined GPS and GLONASS, and finally combined GPS, GLONASS and Galileo. The results show that the contribution of adding Galileo system observations is not significant due to the limited number of available Galileo satellites. However, the positioning accuracy is generally improved when adding GLONASS observations. The results also indicate that BSSD IF model enhances the positioning accuracy in comparison with the undifferenced counterpart. 4.7. References

Rabbou, M. A., and El-Rabbany, A. (2014). Tightly coupled integration of GPS precise point positioning and MEMS-based inertial systems. GPS Solutions, 1-9, doi:10.1007/s10291014-0415-3. Cai, C., and Gao, Y. (2007). Precise point positioning using combined GPS and GLONASS observations. Positioning, 1(11). Cai, C., and Gao, Y. (2008, September). Estimation of GPS-GLONASS system time difference with application to PPP. Proceedings of the 21st International Technical Meeting of the Satellite Division of The Institute of Navigation September 2008, pp. 2880-2887. Savannah, GA,

78

Choy, S., Zhang, S., Lahaye, F., and Héroux, P. (2013). A comparison between GPS-only and combined GPS+ GLONASS Precise Point Positioning. Journal of Spatial Science, 58(2), 169-190. Elsobeiey, M., and El-Rabbany, A. (2013). Efficient between-satellite single-difference precise point positioning model. Journal of Surveying Engineering, 140(2). European GNSS service center (GSC) (2014) Personal Communication, March 3rd. Heo, Y. J., Cho, J., and Heo, M. B. (2012). An approach for GPS clock jump detection using carrier phase measurements in real-time. Journal of Electrical Engineering & Technology, 7(3), 429-435. Hofmann-Wellenhof, B., Lichtenegger, H., and Wasle, E. (2007). GNSS­global navigation satellite systems: GPS, GLONASS, Galileo, and more. Springer Science & Business Media. Chicago Jekeli, C., (2001). Inertial navigation systems with geodetic applications. Walter de Gruyter. Julien, O., Alves, P., Cannon, M. E., and Lachapelle, G. (2004, January). Improved triplefrequency GPS/Galileo carrier phase ambiguity resolution using a stochastic ionosphere modeling. Proceedings of the 2004 National Technical Meeting of The Institute of Navigation, San Diego, CA, pp. 441-452. Kouba, J. (2009). A guide to using International GNSS Service (IGS) products. International GNSS. Online Publication at IGS Website, May 2009. Available online:

ftp://ftp.igs.org/pub/resource/pubs/UsingIGSProductsVer21.pdf. Leandro, R. F., Langley, R. B., and Santos, M. C. (2008). UNB3m_pack: a neutral atmosphere delay package for radiometric space techniques. GPS Solutions, 12(1), 65-70. Montenbruck, O., Hauschild, A., and Hessels, U. (2011). Characterization of GPS/GIOVE sensor stations in the CONGO network. GPS solutions, 15(3), 193-205. Montenbruck, O., Steigenberger, P., Khachikyan, R., Weber, G., Langley, R, B., Mervart, L., and Hugentobler, U. (2014). IGS-MGEX: Preparing the Ground for Multi-Constellation GNSS Science, Inside GNSS, 9(1), 42-49. Phelts, R, E. (2007). Range Biases on Modernized GNSS Codes, Proceedings of European Navigation Conference GNSS/TimeNav, Geneva, Switzerland.

http://waas.stanford.edu/~wwu/papers/gps/PDF/PheltsENC07.pdf.

79

Píriz, R., García, Á, M., Tobías, G., Fernández, V., Tavella, P., Sesia, I., and Hahn, J. (2008). GNSS interoperability: offset between reference time scales and timing

biases. Metrologia, 45(6), S87. Steigenberger, P., Hugentobler, U., Loyer, S., Perosanz, F., Prang, L., Dach, R., Uhlemann, M., Gendt, G., and Montenbruck, O. (2014). Galileo Orbit and Clock Quality of the IGS Multi-GNSS Experiment, Advances in Space Research, doi: 10.1016/j.asr.2014.06.030. Steigenberger, P., Hugentobler, U., Montenbruck, O., Hauschild, A. (2011). Precise orbit determination of GIOVE-B based on the CONGO network. Journal of Geodesy, 85(6), 357-365. Zhang, W., Cannon, M, E., Julien, O., and Alves, P. (2003). Investigation of combined GPS/GALILEO cascading ambiguity resolution schemes. Proceedings of ION GPS/GNSS, Institute of Navigation, Portland, OR, pp. 2599-2610.

80

5. Integration of Multi-Constellation GNSS Precise Point Positioning and MEMSBased Inertial Systems Using Tightly Coupled Mechanization

In this chapter, tightly-coupled integration algorithms for multi-constellation GNSS PPP/MEMS-based inertial systems are developed. The algorithms are developed for both undifferenced and between-satellite single difference ionosphere-free PPP techniques. The EKF is used as the estimation filter to merge the GNSS observations and inertial sensor records. The contribution of the additional GNSS observations from GLONASS and Galileo systems is investigated during partial, complete and no outages with two sets of trajectory data.

The following manuscript was originally published as:

Abd Rabbou and M., El-Rabbany, A, (2014), Integration of Multi-Constellation GNSS Precise Point Positioning and MEMS-Based Inertial Systems Using Tightly Coupled Mechanization, Sensors, submitted.

Modifications to the original manuscript were made only for proper identification of sections, figures and tables to assure uniformity within this dissertation.

81

Integration of Multi-Constellation GNSS Precise Point Positioning and MEMS-Based Inertial Systems Using Tightly Coupled Mechanization Abstract: We develop a new integrated navigation system, which integrates multi-constellations GNSS precise point positioning (PPP), including GPS, GLONASS and Galileo, with low-cost micro-electro-mechanical sensor (MEMS) inertial system, for precise positioning applications. To integrate GNSS and the MEMS-based inertial system, the process and measurement models are developed. Tightly coupled mechanism is adopted, which is carried out in the GNSS raw measurements domain. Both undifferenced and between-satellite singledifference (BSSD) ionosphere-free linear combinations of pseudorange and carrier phase GNSS measurements are processed. Rigorous models are employed to correct for GNSS errors and biases. The GNSS inter-system biases are considered as additional unknowns in the integrated error state vector. The developed stochastic model for inertial sensors errors and biases are defined based on first order Gaussian Markov process. Extended Kalman filter is developed to integrate GNSS and inertial measurements and estimate inertial measurements biases and errors. Two field experiments are executed, which represent different real-world scenarios in land-based navigation. The data are processed using our developed Ryerson PPP GNSS/MEMS software. The results indicate that the proposed integrated system achieves decimeter to centimeter level positioning accuracy when the measurement updates from GNSS are available. During complete GNSS outages the developed integrated system continues to achieve decimeter level accuracy for up to 30 seconds, while it achieves meter-level accuracy when a 60-second outage is introduced. Keywords: GNSS, GPS, Galileo, GLONASS, MEMS, PPP, Tightly Coupled 82

5.1.

Introduction

Global navigation satellite systems (GNSS) provide worldwide positioning, velocity and time synchronization. Traditionally, highly accurate GNSS positioning solution is obtained through carrier-phase observables in differential mode involving two or more receivers. However, the requirement of a base station is usually problematic for some applications. Comparable positioning accuracy, without requiring extra infrastructure, can be achieved through precise point positioning (PPP) technique (Zumberge et al. 1997). PPP uses either undifferenced or between-satellite single difference carrier-frequency and pseudorange observations from a single receiver, in addition to precise orbit and clock products. PPP commonly employs undifferenced ionosphere-free linear combination of GPS observations. Unfortunately, GPS often experiences poor satellite visibility or weak constellation geometry in urban areas. This limitation can be overcome through combining multi-constellation GNSS, which is not simply achieved by adding the additional measurements to existing GPS observation models. Inter-system biases exist, which must be taken into account in order to make effective use of the additional GNSS observation. Employing multi-GNSS systems, in contrast to GPS only, decreases the probability of partial GNSS outages due to the availability of a large number of satellites observations. However, GNSS positioning solution may not always be available due to complete GNSS outages in urban canyons. These limitations can be overcome through integrating the GNSS observations with a relatively environment-independent system, the inertial navigation system (INS). Differential GPS are traditionally used for precise positioning applications with different grade levels of inertial sensors such as a navigation grade inertial system (e.g. ElSheimy et al., 1995; Brzezinska et al., 1998), and a tactical grade INS (e.g. Petovello, 2003; 83

Nassar, 2003). Typically, previous research employed high-end INS to enhance the GPS solution. Petovello (2003) used high-end INS to shorten the ambiguity search time following brief GPS data outages by feeding the estimation filter with position and position variancecovariance matrix. As well, inertial sensor measurements were used to identify the GPS cycle slip, which in turn improves GPS reliability (Cannon, 1992). Unfortunately, high-end inertial sensors are expensive and may not provide a cost effective solution. Advances in micro-electro-mechanical sensors (MEMS) provide the development of a generation of lowcost inertial sensors, which make them attractive to many users. However, in general, MEMS sensors have poorer performance and stability compared with high-end INS due to the high noise level and severe biases and drifts affecting the MEMS-based inertial sensors. A number of researchers have investigated the integration of GPS system with MEMS-based inertial sensors (e.g. Shin 2005, Mezentsev 2005, Abdel-Hamid 2005 and Abd Rabbou and ElRabbany 2014). Most of the previous research either employed the differential or classical single point positioning GPS. As such, severe positioning errors were introduced during the GPS outages, which restricted the applications of those systems. More recently, Abd Rabbou and El-Rabbany (2014) developed a GPS PPP/MEMS-based system for precise positioning applications. However, their system was based on the pseudorange and carrier phase observations of a single GNSS constellation, namely GPS. Considering the recent advances in MEMS-based accelerometers, the up to date GNSS constellations and the advances in PPP techniques, this research aims to develop a new integrated navigation system for precise positioning and navigation applications. MEMSbased accelerometers equipped with fiber optic gyros, which limit the orientation errors, are used. GNSS-based PPP including GPS, GLONASS and Galileo systems observations are used to update the system through a tightly coupled mechanism. The developed integrated system shows decimetre to centimetre level accuracy when GNSS observations are available. 84

It is shown that the additional GNSS observations enhance the positioning accuracy in comparison with the traditional GPS kinematic positioning solution. Better positioning accuracy was obtained with BSSD ionosphere-free model, in comparison with the traditional undifferenced ionosphere-free model. In addition, the developed integrated system continues achieve decimeter level accuracy for up to 30 seconds, while it achieves meter-level accuracy when a 60-second outage is introduced. 5.2. Multi-constellation GNSS-PPP Measurement Models

In this study, both undifferenced and between-satellite single differenced ionosphere-free models are considered. Pseudorange and carrier phase observations of three GNSS systems are processed, namely GPS, GLONASS and Galileo. Following Hofmann-Wellenhof et al. (2008), the general ionosphere-free GPS observation equations for pseudorange and carrierphase are extended considering the multi-constellation GNSS systems as follow:
P3G = G +c[dtr +IFCDr G ]-c[dt sG +IFCDsG ]+TG +eG
r s s P 3E = E +c[dtr +IFCD G ] -c[dt E +IFCD E ] +TE +c[ISBE ] +eE r s s P 3R = R +c[dtr +IFCD G ] -c[dt R +IFCD R ] +TR +c[ISBR ] +eR

5.1 5.2 5.3 5.4 5.5 5.6

3G = G +c[dtr +IFCDr G ] -c[dt sG +IFCD sG ] +TG +(  N+IFCD r -IFCD s )G + G

3E = E +c[dtr +IFCDr G ] -c[dt s E +IFCD s E ] +TE +c[ISBE ] +(  N+IF CDr -IFCDs )E + E

3R = R +c[dtr +IFCDr G ] -c[dt s R +IFCD s R ] +TE +c[ISBR ] +(  N+IF CDr -IFCDs )R + R

-

G, R and E refer to GPS, GLONASS and Galileo systems observations, respectively. P3 and 3 are the undifferenced ionosphere-free pseudorange and carrier phase

measurements, respectively.
-

 is the true geometric range from the antenna phase center of the receiver at reception time to the antenna phase center of the satellite at transmission time.

-

 and   are the clock errors for receiver and satellite, respectively. T is the tropospheric error. 85

-

 and   are ionosphere-free differential code bias for the receiver and satellite, respectively, which can be expressed as:

IFCDr =c[adr1 -bdr 2 ]

5.7 5.8

IFCDs  c[ad s1 -bd s 2 ]

where dr and ds are frequency-dependent code hardware delay for receiver and satellite, respectively. a and b are frequency dependent factors a = speed of light.
2 1 2 2 1 -2 2 and b = 2 - 2 and c is the 1 2

 2

e and  are relevant system noise and un-modeled residual errors for undifferenced ionosphere-free code and carrier phase measurements, respectively.

-

  is the ambiguity term for phase measurements. For the undifferenced ionosphere free linear combination, this term is not integer due to the non-integer nature of the
-2 2 2  = 1 1 1 combination coefficients,  , where 1 and 2 are the L1 and L2 non2  -2
1 2 2 2

integer ambiguity parameters, including the initial phase biases at the satellite and the receiver, respectively; 1 and 2 are the wavelengths of the L1 and L2 carrier frequencies, respectively.
-

 and  are the GPS/GLONASS and GPS/Galileo inter-system biases, respectively. These systems biases can be expressed as

ISBE =[IFCDr G -IFCDr E ] +GEoff

5.9 5.10

ISBR =[IFCDr G -IFCDr R ] +GRoff

where  and  are the GPS/GLONASS and GPS/Galileo system time offsets, respectively, which result from the differences in the time scales of the GNSS systems. To avoid a rank-defect system, some parameters must be lumped together. The receiver clock error  is lumped with the GPS differential code bias as stated through Equations  is (5.1) to (5.6), leading to a receiver clock offset unknown  . The ambiguity term  86

lumped with the receiver differential code biases  and   , creating a float ambiguity parameter unknown B. The final IGS GNSS satellite clock corrections are biased by the GNSS satellite differential code biases, which are used herein to correct for the satellite clock errors. The dry tropospheric delay component as well as other PPP errors such as sagnac, relativity, and satellite antenna phase-center variations is rigorously modeled using existing models (Kouba, 2009). With the above consideration, the GNSS measurement model can be written in more simplified form as:
P 3G 
P 3E  P 3R 
s 2 s 2 s 2 ( xr - X G )  ( yr - YG )  ( zr - Z G ) s  cdtr  mG Tw  eG

5.11 5.12 5.13 5.14 5.15 5.16

s 2 s 2 s 2 ( xr - X E )  ( yr - YE )  ( zr - Z E )

s  cdtr  mE Tw  c[ ISBE ] +eE

s 2 s 2 s 2 ( xr - X R )  ( yr - YR )  ( zr - Z R )

s  cdtr  mR Tw  c[ ISBR ] +eR

3G 
3E  3R 

s 2 s 2 s 2 s ( xr - X G )  ( yr - YG )  ( zr - Z G )  cdtr  mG Tw  NG   G
s 2 s 2 s 2 s ( xr - X E )  ( yr - YE )  ( zr - Z E )  cdtr  mE Tw+c[ISBE ] +N E + E s 2 s 2 s 2 s ( xr - X R )  ( yr - YR )  ( zr - Z R )  cdtr  mR Tw  c[ ISBR ] +N R + R

3 and where 3 are the corrected pseudorange and carrier phase measurements, respectively;  ,  and  are the receiver unknown coordinates;   ,   and   are the satellite coordinates computed using the IGS-MEGX orbital products and corrected for the effect of earth rotation during signal transit;   is receiver clock error lumped with GPS receiver differential code bias;   = () is the mapping function for the troposphere wet  is the float ambiguity in meters lumped by receiver and satellite code delay component  .  bias combinations terms. To develop the mathematical equations for BSSD, we refer to the GPS satellite by k, Galileo satellite by h, and GLONASS satellite by o. GPS satellite l is taken as the reference satellite to form BSSD ionosphere-free linear combination.
1

87

k l P 3G - P 3G 

k 2 k 2 k 2 ( xr - X G )  ( yr - YG )  ( zr - Z G ) k k k l  ( mG  mG )Tw  eG -eG

l 2 l 2 l 2 ( xr - X G )  ( yr - YG )  ( zr - Z G )

6.17

h l P 3E  P 3G 

h 2 h 2 h 2 ( xr - X E )  ( yr - YE )  ( zr - Z E ) h l h l  ( mE  mG )Tw  c[ I S BE ] +eE - eG

l 2 l 2 l 2 ( xr - X G )  ( y r - YG )  ( zr - ZG )

5.18

o l P 3R  P 3G 

o 2 o 2 o 2 ( xr - X R )  ( yr - YR )  ( zr - Z R ) o l o l  ( mR  mG )Tw  c[ I S BR ] +eR - eG

l 2 l 2 l 2 ( xr - X G )  ( yr - YG )  ( zr - Z G )

5.19

k l 3 G - 3G 

k 2 k 2 k 2 l 2 l 2 l 2 ( xr - X G )  ( yr - YG )  ( zr - Z G ) - ( xr - X G )  ( yr - YG )  ( zr - ZG ) k k k l k l  ( mG  mG )Tw  NG -NG  G - G

5.20

h l 3 E  3G 

h 2 h 2 h 2 l 2 l 2 l 2 ( xr - X E )  ( yr - YE )  ( zr - Z E ) - ( xr - X G )  ( yr - YG )  ( zr - Z G )

h l h l h l  ( mE  mG )Tw  c[ISBE ] +N E -N G + E - G o l 3 R  3G  o 2 o 2 o 2 l 2 l 2 l 2 ( xr - X R )  ( yr - YR )  ( zr - Z R ) - ( xr - X G )  ( yr - YG )  ( zr - Z G )

5.21

o l o l o l  ( mR  mG )Tw  c[ISBR ] +N R -NG + R - G

5.22

It can be seen that the receiver clock offset is cancelled out when forming our BSSD mathematical equations. Additionally, the receiver differential code and phase biases are cancelled out for the GPS system observations while these receiver biases are reduced significantly for GLONASS and Galileo observations. However, forming BSSD leads to mathematical correlations among the observations, which must be taken into account when the covariance matrix of the observations is formed. Equations (5.11) through (5.16) and (5.17) through (5.22) are used to develop the measurement models of the proposed GNSS/INS integrated system for both undifferenced and between satellites single differences modes, respectively. 5.3. GNSS-PPP/MEMS-based IMU Implementation

To build the proposed GNSS/INS integrated navigation system, tightly coupled architecture is implemented adopting extended Kalman filter (EKF). GNSS pseudorange, carrier phase and Doppler measurements as well as INS-derived observations are processed to produce estimates of the state vector including position, velocity and attitude. Except for GLONASS, 88

the IGS-MGEX final precise orbital and clock products are used to mitigate the satellite orbit and clock errors (Montenbruck et al. 2014). The IGS clock products are used to correct for the GLONASS clock errors due to the unavailability of MGEX GLONASS clock corrections for the test days. The UNB3 tropospheric model, which employs the Saastamoinen vertical propagation delay model and the Niell mapping function, is used to account for the tropospheric dry components (Leandro et al. 2006). The troposphere wet component  is treated as an additional unknown in the error state vector as seen in Equations (5.11) to (5.22). The effects of ocean loading, Earth tide, carrier-phase windup, sagnac, relativity, and satellite antenna phase-center variations are rigorously modeled using existing models (Kouba. 2009). The precise GNSS ephemerides as well as the outputs of position  and velocity   from the inertial sensors mechanization as described in Jekili (2001) are used to predict the INS  measurements. The corrected GNSS pseudorange  , phase  and Doppler   pseudorange  , phase  and Doppler  measurements are differenced with the INS-predicted measurements. The residuals ,  and  are then directly processed by the integration filter to estimate the system error state vector. The obtained INS error estimates, such as the inertial sensors bias drifts  and , and scale factors  and  , are fed back to the INS mechanization to correct for the inertial sensors forces   and   using the closed loop approach. The estimated error states such as position errors   , velocity errors   and
  attitude errors   are directly applied to the INS-derived position  , velocity  and

attitude   solutions. States unique to GNSS such as the clock offset  , clock drift  , internal system biases ISB and ambiguity parameters N, are fed back to continue correct for the GNSS observations using additional closed loop technique. A priori estimation constrains are applied on GPS/GLONASS and GPS/Galileo internal system biases (ISBs) to 89

continue benefits from additional GNSS satellites when the number of GLONASS or Galileo satellites drops to one satellite. Figure 5.1 shows the tightly coupled GNSS PPP/INS implementation flowchart.

Figure 5. 1-GNSS PPP/MEMS based IMU integration mechanism To implement the mechanization of the developed integrated system, two main steps are applied on EKF, namely prediction step and update step as described in Jekeli (2001). The prediction step;
 xk ,k 1  Fk ,k 1 xk 1
T P k ,k 1  F k ,k 1 P k 1 F k ,k 1  Qk

5.23 5.24

The update step;
T T 1 1 Kk  P k ,k 1 H k ( H k P k ,k 1 H k  P obs )

5.25 5.26

Pk  ( I  Kk H k )Pk ,k 1

90

 xk   xk ,k 1  Kk (  Zk  H k  xk ,k 1 )
-

5.27

xk,k-1 is estimation state vector. The complete state vector consists of 26+n states where n is the number of satellites, describing the basic state vector including the nine navigation parameter errors, the inertial sensors errors including the bias drift and scale factor, and errors unique to the GNSS measurements, which are mainly the receiver clock offset and drift, the troposphere wet delay component, the GPS/GLONASS ISB and GPS/Galileo ISB with additional n states related to the float ambiguity parameters Bi where i is the satellite number. The complete state vector for undifferenced ionospherefree technique can be written as.
 x  [ r n ,  vn ,  n ,  ba ,  bg ,  Sa ,  S g ,Tw , cdtr , c  tdri , cISBR , cISBE , NkG , N hE , NoR .. . Nn ]
5.28

where   is a three-dimensional vector representing the positioning errors in latitude, longitude and altitude,   is a three-dimensional vector representing the velocity errors in east, north and up,   is a three-dimensional vector representing the attitude errors in roll, pitch and azimuth,  is a three-dimensional vector representing the accelerometer biases drift in x, y and z,  is a three-dimensional vector representing the gyro biases drift in x, y and z,  is a three-dimensional vector representing the accelerometer scale factors errors in x, y and z,  is a three-dimensional vector representing the gyro scale factors errors in x, y and z.  is the wet component of the tropospheric delay,   and  are the GPS receiver clock offset and drift in meters, respectively. Both  and c are GPS/GLONASS and GPS/Galileo inter-system biases in meters. It should be pointed out that the receiver clock offset and drift are cancelled out when forming BSSD ionosphere-free model.
-

 is the Kalman gain, k is the epoch number, ,-1is the state-transition matrix derived from the perturbations of the INS mechanization equations, which can be found, for example, in Jekeli (2001) and Noureldin et al. (2013). Equation (29) shows the structure 91

of the transition matrix, which is extended to include the additional GNSS parameters in addition to the float ambiguity terms.
 Frr  Fvr   F r  03     03  0       0  Frv Fvv F v 03 03 0 Fr  Fv F 03 03 03 0 0 n n b Rb 03 Rb F 03 n n b 03 Rb 03 Rb W ba 03 03 03 03 ba 03 03 03  sa 03 03 03 03 03  sa 0 0 0 0 0 0 0 1 0 0 0              0 0 0 0 0 0 0 ( 26  n

Fk ,k 1

5.29

0

0

0

0

0

0

s

)* ( 26  ns )

where   ,   ,   ,   ,   ,   ,   ,   and   are system dynamics matrices, which
 represent the relationship between the position, velocity and attitude state errors,  is the

transformation matrix from the body frame to the navigation frame,   is a diagonal matrix of the accelerometers forces in body frame and   is a diagonal matrix of the gyro forces in body frame, w represents the system input white noise, G is the associated coefficient matrix and   1/  , where  is the correlation time for the accelerometers and gyros for first order GM process. The full derivation and definition of ,-1 elements can be found in Jekeli (2001).
-

,-1 is the variance-covariance matrix for the prediction state,  is the process noise variance matrix, and  is variance covariance matrix for the GNSS measurements state. Considering the mathematical correlation between GNSS observations when forming BSSD, the relative weight matrix  =  can be described as (Elsobeiey and ElRabbany 2014):

92

 f 2  f 22 Pobs  PBSSD   12  f  f2 2  1

   

 ( ns  1 )  1 1 1 1   1 ( n  1) 1 1 1  s   1  1  1 ( ns  1 )  1 1  2    1  1  1 ( n  1 )  1  ns s      1  1  1  1 ( n  1 )   s  

5.30

where  is the standard deviation of the undifferenced GNSS observations and ns the number of visible satellites. Equation (30) shows that the observations relative weight matrix in the BSSD mathematical model is no longer diagonal matrix. It is fully populated because of the correlation between the observables.
-

Z is the measurement vector consisting of the differences between the corrected GNSS and the predicted INS measurements. When undifferenced ionosphere-free model is used Z can be defined as:
G P i  PR  oE P h   G  iR   Z   oE   h  G P i  PR  oE P h   ins  P i ins  P o ins  P n

 ii n s  oi n s  hi n s
ins  P i ins  P o ins  P h

                

5.31

-

 is the design matrix containing geometry factors defined according to the GNSS mathematical model used. The design matrix is arranged with columns corresponding to the states unique to inertial sensors errors such as  ,  ,  and  which filled with zeroes. Hk can be formed as:

93

Hk

 AiG  R  Ao E  Ah    BG  i  BR   o E  Bh    0  0   0  

0 0 0 0 0 0 mi 1 0 0 0 0 0 0 0 0 0 0 mo 1 0 1 0 0 0 0 0 0 0 0 mh 0 0 0 0 0 0 mi 0 0 0 0 0 0 mo 0 0 0 0 0 0 mh CiG 0 0 0 0 0 0 CoR 0 0 0 0 0 0
E Ch 00000 0

    10010   10001 0 0    10100  10010 1   01000   01000   01000  

5.32

where  =  ,  =



 

,  =  are the partial derivatives of the pseudorange, phase and



Doppler measurements, respectively, with respect to the receiver position X and velocity V. To form the BSSD measurement model, between-satellite single difference matrix  should be defined based on the selected reference satellite.
1 0 0 0 0 1 0 0 0 0 0 1  0 0
5.33

M bssd

0

0

1 1 1 1 1 1 1 0 1

0

0

0

0

0 1 0 0 0 0 0 1 0 0 0 0 1

ns  1* ns

HBS S D  Mb s s d * Hu n d i f f
5.34

 Zbssd  Mbssd *  Zun  di f f
5.35

where  is the design matrix for BSSD model,  is the BSSD observation vector. The error state vector for BSSD based integrated system is defined as:

94

GG GE GR  x  [ r n ,  vn ,  n ,  ba ,  bg ,  Sa ,  Sg ,  Tw1i , cISBR , cISBE , Nlk , Nlh , Nlo , ....]

5.36

 is the single differenced float ambiguity terms with reference satellite l. where  5.4. Tests and Results Analysis

Two real vehicular tests were conducted to evaluate the performance of the developed integrated GNSS-PPP/MEMS-based INS system. The vehicular tests were carried out through downtown Kingston, Ontario, Canada, which was designed to represent challenging situations for real GNSS satellite navigation availability including turns, straight portions, high speed, and slow speeds. The NovAtel SPAN-CPT system and the GNSS Trimble R10 receiver were used to collect the navigation data. The SPAN-CPT system consists of the NovAtel OEM4 receiver and a MEMS-based IMU, which contains three MEMS-based accelerometers and three fiber optic gyros. Carrier phase-based differential GNSS (DGNSS) solution is used as a reference solution. In order to create this reference solution, a GNSS Trimble R7 receiver was setup at a nearby station with precisely known coordinates. The raw dual-frequency GNSS pseudorange, carrier phase and Doppler measurements were collected at a 1 Hz rate, while the IMU raw data was logged at a rate of 100 Hz. The duration of the first trajectory test was set for about 55 minutes while the duration of the second test was 34 minutes. Four scenarios are considered in this research. The traditional GPS-based integrated system and the developed GNSS-based integrated system including GPS, GLONASS and Galileo, are studied to investigate the contribution of the additional GNSS systems to the positioning accuracy of the integrated system. Both undifferenced and BSSD ionosphere-free PPP techniques are adopted for GPS-based and GNSS-based integrated systems. To investigate the positioning accuracy of the integrated system during complete GNSS outages, a number of simulated outages is introduced for each trajectory test. The data were processed using our Ryerson PPP GNSS/MEMS software in undifference and BSSD modes. 95

5.4.1. First Trajectory The first trajectory test area is shown in Figure 5.2 with the locations of simulated outages. Figure 5.3 shows the GNSS satellite availability during the observation time.

Figure 5. 2-Test area and simulated complete GNSS outages for the first trajectory

Figure 5. 3-GNSS satellites availability during the first trajectory test Figure 5.4 shows the positioning accuracy of the developed integrated system when the observations of all GNSS satellites are included in the solution, i.e., no outages are inserted. It 96

can be seen that the addition of GLONASS and Galileo observations enhances the positioning accuracy in comparison with the GPS-only positioning solution. Further improvement is attained in the positioning solution through BSSD ionosphere-free linear combination model, in comparison with the traditional undifferenced counterpart.

Figure 5. 4-Positioning accuracy for the first trajectory with no outages inserted Table 5.1 summarizes the statistical characteristics, mainly the root mean square error (RMSE) and the maximum error, for the four PPP integrated system scenarios mentioned above. Comparing the RMSE values for each scenario, it can be seen that the positioning precision is improved by 23%, 41% and 41% for latitude, longitude and altitude in the multiconstellation GNSS PPP solution compared with the GPS-only PPP solution. In addition, using BSSD ionosphere-free PPP technique improves the positioning precision case by 24%, 15% and 13% for latitude, longitude and altitude, in comparison with the traditional undifferenced ionosphere-free PPP technique.

97

Table 5. 1-Statistical analysis of GNSS positioning precision for the first trajectory, with no outages inserted
PPP techniques Positioning RMSE (m) Maximum error PPP techniques Positioning RMSE Maximum error GPS (un-differenced mode) latitude 0.101 0.184 latitude 0.065 0.108 longitude 0.160 0.303 longitude 0.094 0.178 altitude 0.103 0.416 altitude 0.079 0.245 GPS (BSSD mode) Latitude 0.052 0.121 Latitude 0.034 0.072 Longitude 0.090 0.179 Longitude 0.059 0.106 altitude 0.082 0.306 altitude 0.058 0.180

GNSS (un-differenced mode)

GNSS (BSSD mode)

Figure 5. 5-Positioning accuracy for the first trajectory with simulated complete GNSS outages inserted To mimic challenging positioning conditions in urban areas, including complete blockage of the GNSS satellites, twelve simulated complete satellite outages of 60s, 30s and 10s were introduced in the first trajectory. Figure 5.5 shows the positioning errors during the various outages, referenced to carrier-based DGPS solution with full satellite availability. As can be seen, both of the undifference and BSSD models produce similar positioning accuracy during the outages. In addition the contribution of the additional GNSS systems observation can be 98

considered marginal, as the positioning error during a complete GNSS outage depends on the accuracy of the positioning solution just before the occurrence of outage. As well, the additional GNSS observations can only slightly improve the inertial sensor bias estimation, compared with that of GPS-only. In the 60-second GNSS outage the maximum positioning error reached sub-meter level in most cases, while it reached a decimeter level in 10-seccond outage. Table 5.2 shows the average maximum positioning errors in latitude, longitude and altitude, respectively, during the three simulated GNSS outages for both BSSD and undifferenced ionosphere-free models for the first trajectory. Table 5. 2-Average maximum positioning errors during GNSS simulated outages for the first trajectory
PPP technique outages (sec) latitude (m) longitude (m) altitude (m) PPP technique outages (sec) latitude (m) longitude (m) altitude (m) Un-differenced-GPS 60s 30s 10s 0.517 0.334 0.201 0.716 0.429 0.214 0.402 0.310 0.159 Un-differenced-GNSS 60s 30s 10s 0.483 0.296 0.175 0.681 0.396 0.186 0.376 0.273 0.137 BSSD-GPS 60s 30s 10s 0.501 0.327 0.199 0.699 0.428 0.210 0.393 0.305 0.160 BSSD-GNSS 60s 30s 10s 0.472 0.268 0.146 0.670 0.363 0.159 0.357 0.245 0.104

5.4.2. Second Trajectory The second trajectory test area is shown in Figure 5.6 with the locations of simulated outages. Similar to the first trajectory, the locations of the simulated outages were selected to present different driving conditions. Figure 5.7 shows the satellite availability during the observation time.

99

Figure 5. 6-Test area and simulated complete GNSS outages for the second trajectory

Figure 5. 7-GNSS satellite availability during the second trajectory test

100

Figure 5. 8-Positioning accuracy for the second trajectory with no outages inserted Figure 5.8 shows the positioning accuracy for the developed integrated system when the observations of all GNSS satellites are included in the solution, i.e., no outages are inserted. Table 5.3 summaries the statistical analysis for the results of the four scenarios, as described earlier. It can be seen that the solution characteristics of the second trajectory are similar to those of the first trajectory, which confirms the consistency of the positioning solution. Table 5. 3-Statistical analysis of GNSS positioning precision for the second trajectory, with no outages inserted
PPP techniques Positioning RMSE (m) Maximum error PPP techniques Positioning RMSE Maximum error GPS (un-differenced mode) latitude 0.042 0.118 longitude 0.103 0.232 altitude 0.117 0.268 GPS (BSSD mode) Latitude 0.040 0.123 Longitude 0.059 0.172 Altitude 0.074 0.255

GNSS (un-differenced mode) latitude 0.029 0.109 longitude 0.051 0.170 altitude 0.062 0.226

GNSS (BSSD mode) Latitude 0.038 0.095 Longitude 0.030 0.077 Altitude 0.057 0.093

101

Eight simulated GNSS outages, each with duration of 60 s, 30 s and 10 s, respectively, were introduced such that they encompass all conditions of the trajectory, including straight portions and turns. Figure 5.9 shows the positioning errors during the GNSS simulated outages, which presents comparable positioning accuracy with the results of the first trajectory.

Figure 5. 9-Positioning accuracy for the second trajectory with simulated complete GNSS outages inserted Table 5.4 shows the average maximum positioning errors in latitude, longitude and altitude, respectively, during the three simulated GNSS outages for both BSSD and undifferenced ionosphere-free models for the second trajectory. As can be seen the outputs results of the second trajectory confirms the positioning accuracy for the second trajectory during the complete GNSS outages, Similar to those of the first trajectory, the average maximum

102

positioning error reached sub-meter level during the 60-second GNSS outage, while it reached a decimeter level in 10-seccond outage. Table 5. 4-Average maximum positioning errors during GNSS simulated outages for the second trajectory
PPP technique outages (sec) latitude (m) longitude (m) altitude (m) PPP technique outages (sec) latitude (m) longitude (m) altitude (m) Undifferenced-GPS 60s 30s 10s 0.638 0.414 0.124 0.650 0.423 0.127 0.675 0.439 0.132 Undifferenced-GNSS 60s 30s 10s 0.624 0.362 0.108 0.637 0.371 0.110 0.662 0.387 0.115 60s 0.635 0.606 0.632 60s 0.634 0.606 0.632 BSSD-GPS 30s 0.412 0.379 0.396 BSSD-GNSS 30s 0.383 0.350 0.368 10s 0.122 0.083 0.089 10s 0.104 0.065 0.072

5.5.

Conclusions

We developed new algorithms for the integration of multi-constellation GNSS PPP, including GPS, GLONASS and Galileo systems, and MEMS-based inertial system. Both undifferenced and between-satellite single difference ionosphere-free linear combinations of carrier phase and code GNSS measurements were considered. Tightly coupled mechanism was implemented and extended Kalman filter (EKF) technique was developed to merge the GNSS and inertial measurements. The performance of the newly developed models was analyzed using two real trajectory tests. The positioning results of the integrated system showed that centimeter to decimeter-level accuracy are achievable when the GNSS satellite were available. The addition of GLONASS and Galileo observations enhanced the positioning accuracy in comparison with standalone GPS-based solution. Better positioning accuracy was obtained with BSSD IF model, in comparison with the undifferenced IF model for both of GPS- and GNSS-based models. During the GNSS outages, the integrated system showed submeter-level accuracy in most cases when a 60-second outage was introduced. However, the positioning accuracy was improved to a few decimeter and decimeter-level accuracy 103

when 30- and 10-second GPS outages were introduced, respectively. Comparable results were obtained from both BSSD and undifferenced models under GNSS outages. 5.6. References

Rabbou, M. A., and El-Rabbany, A. (2014). Tightly coupled integration of GPS precise point positioning and MEMS-based inertial systems. GPS Solutions, 1-9, doi:10.1007/s10291014-0415-3. Abdel-Hamid, W., Abdelazim, T., El-Sheimy, N., and Lachapelle, G. (2006). Improvement of MEMS-IMU/GPS performance using fuzzy modeling. GPS Solutions, 10(1), 1-11. Cannon, M. E. (1992). Integrated GPS-INS for high-accuracy road positioning.Journal of surveying engineering, 118(4), 103-117. El-Sheimy N, Schwarz K P, Wei M, and Lavigne M (1995, September) VISAT: a mobile city survey system of high accuracy. Proc. ION GPS 1995, Institute of Navigation, Palm Springs, CA, 1307-1315 Elsobeiey M, and El-Rabbany A (2014) Efficient between-Satellite single-difference precise point positioning model. Journal of Surveying Engineering, 140(2), 04014007. Grejner-Brzezinska D A, Da R, and Toth C (1998) GPS error modeling and OTF ambiguity resolution for high-accuracy GPS/INS integrated system. Journal of Geodesy, 72(11), 626-638. Hofmann-Wellenhof B, Lichtenegger H, and Wasle E (2007). GNSS ­global navigation satellite systems: GPS, GLONASS, Galileo, and more. Springer. Jekeli, C. (2001). Inertial navigation systems with geodetic applications. Walter de Gruyter. Kouba, J. (2009). A guide to using International GNSS Service (IGS) products. International GNSS. Online Publication at IGS Website, May 2009. Available online:

ftp://ftp.igs.org/pub/resource/pubs/UsingIGSProductsVer21.pdf. Leandro, R. F., Langley, R. B., and Santos, M. C. (2008). UNB3m_pack: a neutral atmosphere delay package for radiometric space techniques. GPS Solutions, 12(1), 65-70. Mezentsev O (2005) Sensor aiding of HSGPS pedestrian navigation. Dissertation, University of Calgary. 104

Nassar, S., and El-Sheimy, N. (2005). Wavelet analysis for improving INS and INS/DGPS navigation accuracy. Journal of Navigation, 58(01), 119-134. Noureldin, A., Karamat, T. B., and Georgy, J. (2012). Fundamentals of inertial navigation, satellite-based positioning and their integration. Springer Science & Business Media. Petovello, M. G., Cannon, M. E., and Lachapelle, G. (2004). Benefits of Using a Tactical Grade IMU for HighAccuracy Positioning. Navigation, 51(1), 1-12. Shin, E. H., Niu, X., and El-Sheimy, N. (2001, May). Performance comparison of the extended and the unscented Kalman filter for integrated GPS and MEMS-based inertial systems. In Proceedings of the 2005 National Technical Meeting of The Institute of Navigation, San Diego, pp. 961-969. Montenbruck, O., Steigenberger, P., Khachikyan, R., Weber, G., Langley, R, B., Mervart, L., and Hugentobler, U. (2014). IGS-MGEX: Preparing the Ground for Multi-Constellation GNSS Science, Inside GNSS, 9(1), 42-49. Zumberge, J. F., Heflin, M. B., Jefferson, D. C., Watkins, M. M., and Webb, F. H. (1997). Precise point positioning for the efficient and robust analysis of GPS data from large networks. Journal of Geophysical Research: Solid Earth (1978­2012), 102(B3), 50055017.

105

6. Conclusions and Recommendations 6.1. Conclusions

This dissertation developed new models for an autonomous positioning and navigation system, which integrates the measurements of multi-constellation GNSS, including GPS, GLONASS and Galileo satellite systems, and MEMS-based inertial sensors. Both undifferenced and between-satellite single difference (BSSD) ionosphere-free precise point positioning PPP models were developed. A tightly-coupled mechanization was adopted, which is carried out in the raw measurements domain. A number of linear and nonlinear estimation filters, including the extended Kalman filter (EKF), the unscented Kalman filter (UKF), the particle filter (PF), and the unscented particle filter (UPF), were developed to merge the corrected GPS satellite difference observations and the inertial measurements. A Matlab-based computer program was developed to carry out the tightly-coupled integration. The performance of the proposed integrated system was analyzed using real test trajectories in Kingston, Ontario. It has been shown that the GPS PPP/MEMS-based INS integrated system, with the EKF being the estimation filter, achieves decimeter- and centimeter/sec-level accuracy for positioning and velocity, respectively. Better positioning precision has been obtained with the BSSD IF model, in comparison with the undifferenced IF model. On average, the positioning accuracy is improved by 48%, 40% and 20% in the latitude, longitude and altitude components, respectively, when the BSSD model is used. This improvement is mainly attributed to the elimination of the receiver differential code biases through the BSSD technique. During GPS outages, the integrated system showed submeter-level positioning accuracy in most cases when a 60-second outage was introduced. However, the positioning accuracy was improved to a few decimeters and decimeter-level accuracy when 30- and 10second GPS outages were introduced, respectively. Comparable results were obtained from 106

both the BSSD and undifferenced models under GPS outages. The results obtained from three nonlinear filters, namely UKF, PF, UPF, were comparable to those of EKF, as long as no GPS outages are encountered. When GPS is available, the performance of the integrated system depends on GPS positioning accuracy. As such, the contribution of the nonlinear filter is expected to be marginal as the effect of the nonlinear terms can be neglected in the positioning parameters. In comparison with the traditional PF, the use of UPF significantly reduces the number of particles needed to obtain an accurate solution, which speeds up the estimation of navigation parameters. During GPS outages, the nonlinearity of the inertial sensor records controls the performance of the integrated system. When a complete GPS outage is encountered, the use of UPF enhances the positioning accuracy by up to 15%, in comparison with the standard EKF. The developed multi-constellation GNSS PPP/MEMS-based inertial sensor integrated system achieves centimeter- to decimeter-level accuracy when the GNSS satellite observations are available. The addition of GLONASS and Galileo observations enhanced the positioning accuracy in comparison with a standalone GPS-based solution. It has been shown that the additional GNSS observations improve the positioning accuracy by 24%, 41% and 41% for latitude, longitude and altitude, respectively, in comparison with the GPS-based integrated system. The positioning accuracy is further enhanced by 23%, 15% and 13% in the latitude, longitude and altitude directions, respectively, when the BSSD mode is employed. During the GNSS outages, the integrated system showed submeter-level accuracy in most cases when a 60-second outage was introduced. However, the positioning accuracy was improved to a few decimeter and decimeter-level accuracy when 30- and 10-second GPS outages were introduced, respectively. Both the undifferenced and BSSD models produce similar positioning accuracy during the outages. In addition, the contribution of the additional observations from other GNSS systems can be considered marginal. This is mainly because 107

the positioning error during a complete GNSS outage depends essentially on the accuracy of the positioning solution just prior to the occurrence of the outage. As well, the additional GNSS observations can only slightly improve the inertial sensor bias estimation, compared with that of GPS-only. 6.2. Recommendations

To further improve the findings of this dissertation, additional research is needed in the following areas:  Incorporating the measurements of the Chinese BeiDou GNSS system can potentially improve the performance of the GNSS PPP/MEMS-based inertial system.  Further research is needed on multi-constellation PPP integer ambiguity resolution, which is expected to further improve the system accuracy during the GNSS availability.  Considering triple-frequency GNSS measurements for the GNSS PPP/MEMS-based inertial system can potentially help resolve the integer ambiguity parameters.  The stochastic model used in research is limited to, a first-order Gauss-Markov process, which is considered to be linear. Considering nonlinear stochastic models or higher-order Gauss-Markov stochastic process can enhance the accuracy and reliability of nonlinear estimation, compared with the standard EKF.   Further research is needed that makes use of low-cost MEMS-based gyros. A very low-cost land navigation system should be developed, which integrates single frequency GNSS PPP with reduced inertial systems consisting of two accelerometers and one gyro, as well as the vehicle odometer.

108

7. References Abdel-Hamid, W., Abdelazim, T., El-Sheimy, N., & Lachapelle, G. (2006). Improvement of MEMS-IMU/GPS performance using fuzzy modeling. GPS Solutions, 10(1), 1-11. Bergman, N. (2001). Posterior Cramér-Rao bounds for sequential estimation. In Sequential Monte Carlo methods in practice. Springer: New York, NY, USA, pp. 321­338. Brown, R. G., & Hwang, P. Y. (1992). Introduction to random signals and applied Kalman filtering (Vol. 3), John Wiley & Sons: New York, NY, USA.. Cai, C., & Gao, Y. (2007). Precise point positioning using combined GPS and GLONASS observations. Positioning, 1(11). Cai, C., & Gao, Y. (2008, September). Estimation of GPS-GLONASS system time difference with application to PPP. Proceedings of the 21st International Technical Meeting of the Satellite Division of The Institute of Navigation Savannah, GA, September 2008, pp. 2880-2887. Cannon, M. E. (1992). Integrated GPS-INS for high-accuracy road positioning.Journal of surveying engineering, 118(4), 103-117. Cannon, M.E. (1991). Airborne GPS/INS with an Application to Aero triangulation. UCGO Report #20040, Department of Geomatics Engineering, University of Calgary. Caron, F., Davy, M., Duflos, E., & Vanheeghe, P. (2007). Particle filtering for multisensor data fusion with switching observation models: Application to land vehicle positioning. Signal Processing, IEEE Transactions on, 55(6), 2703-2719. Carpenter, J., Clifford, P., & Fearnhead, P. (1999). Improved particle filter for nonlinear problems. IEE Proceedings-Radar, Sonar and Navigation, 146(1), 2-7. Choy, S., Zhang, S., Lahaye, F., & Héroux, P. (2013). A comparison between GPS-only and combined GPS+ GLONASS Precise Point Positioning. Journal of Spatial Science, 58(2), 169-190. 109

Collins, P., Bisnath, S., Lahaye, F., & Héroux, P. (2010). Undifferenced GPS ambiguity resolution using the decoupled clock model and ambiguity datum fixing. Navigation, 57(2), 123-135. Doucet, A., Godsill, S., & Andrieu, C. (2000). On sequential Monte Carlo sampling methods for Bayesian filtering. Statistics and computing, 10(3), 197-208. El-Sheimy N, Schwarz K P, Wei M, and Lavigne M (1995, September) VISAT: a mobile city survey system of high accuracy. Proc. ION GPS 1995, Institute of Navigation, Palm Springs, CA, 1307-1315 Elsobeiey, M., & El-Rabbany, A. (2013). Efficient between-satellite single-difference precise point positioning model. Journal of Surveying Engineering, 140(2). European GNSS service center (GSC) (2014) Personal Communication, March 3rd. Gao, Y., & Chen, K. (2004). Performance analysis of precise point positioning using rea-time orbit and clock products. Journal of Global Positioning System, 3, 95-100. Ge, M., Gendt, G., Rothacher, M., Shi, C., & Liu, J. (2008). Resolution of GPS carrier-phase ambiguities in precise point positioning (PPP) with daily observations. Journal of Geodesy, 82(7), 389-399. Geng, J., Bock, Y., Melgar, D., Crowell, B. W., & Haase, J. S. (2013). A new seismogeodetic approach applied to GPS and accelerometer observations of the 2012 Brawley seismic swarm: Implications for earthquake early warning. Geochemistry, Geophysics, Geosystems, 14(7), 2124-2142. Geng, J., Shi, C., Ge, M., Dodson, A. H., Lou, Y., Zhao, Q., & Liu, J. (2012). Improving the estimation of fractional-cycle biases for ambiguity resolution in precise point positioning. Journal of Geodesy, 86(8), 579-589. Georgy, J., Noureldin, A., Korenberg, M. J., & Bayoumi, M. M. (2010). Low-cost threedimensional navigation solution for RISS/GPS integration using mixture particle filter. Vehicular Technology, IEEE Transactions on, 59(2), 599-615. 110

Giremus, A., Tourneret, J. Y., & Djuric, P. M. (2005, June). An improved regularized particle filter for GPS/INS integration. In Signal Processing Advances in Wireless Communications, 2005 IEEE 6th Workshop on (pp. 1013-1017). Grejner-Brzezinska, D. A., Da, R., & Toth, C. (1998). GPS error modeling and OTF ambiguity resolution for high-accuracy GPS/INS integrated system. Journal of Geodesy, 72(11), 626-638. Haug, A. J. (2005). A tutorial on Bayesian estimation and tracking techniques applicable to nonlinear and non-Gaussian processes. MITRE Corporation, McLean. Heo, Y. J., Cho, J., & Heo, M. B. (2012). An approach for GPS clock jump detection using carrier phase measurements in real-time. Journal of Electrical Engineering & Technology, 7(3), 429-435. Hofmann-Wellenhof, B., Lichtenegger, H., & Wasle, E. (2007). GNSS­global navigation satellite systems: GPS, GLONASS, Galileo, and more. Springer Science & Business Media. Chicago Jekeli, C., (2001). Inertial navigation systems with geodetic applications. Walter de Gruyter. Julien, O., Alves, P., Cannon, M. E., & Lachapelle, G. (2004, January). Improved triplefrequency GPS/Galileo carrier phase ambiguity resolution using a stochastic ionosphere modeling. Proceedings of the 2004 National Technical Meeting of The Institute of Navigation, San Diego, CA, pp. 441-452. Julier, S. J., Uhlmann, J. K., and Durrant-Whyte, H. F. (1995, June). A new approach for filtering nonlinear systems. Vol. 3, In American Control Conference, Proceedings of the 1995 Seattle, WA, USA, pp. 1628-1632. Kouba, J. (2009). A guide to using International GNSS Service (IGS) products. International GNSS. Online Publication at IGS Website, May 2009. Available online:

ftp://ftp.igs.org/pub/resource/pubs/UsingIGSProductsVer21.pdf. Kouba, J., and Héroux, P. (2001). Precise point positioning using IGS orbit and clock products. GPS solutions, 5(2), 12-28.

111

Leandro, R. F., Langley, R. B., and Santos, M. C. (2008). UNB3m_pack: a neutral atmosphere delay package for radiometric space techniques. GPS Solutions, 12(1), 65-70. Mezentsev, O. (2005). Sensor Aiding of HSGPS Pedestrian Navigation. PhD Thesis, Department of Geomatics Engineering, University of Calgary, Canada Montenbruck, O., Hauschild, A., and Hessels, U. (2011). Characterization of GPS/GIOVE sensor stations in the CONGO network. GPS solutions, 15(3), 193-205. Montenbruck, O., Steigenberger, P., Khachikyan, R., Weber, G., Langley, R, B., Mervart, L., and Hugentobler, U. (2014). IGS-MGEX: Preparing the Ground for Multi-Constellation GNSS Science, Inside GNSS, 9(1), 42-49. Nassar, S., and El-Sheimy, N. (2005). Wavelet analysis for improving INS and INS/DGPS navigation accuracy. Journal of Navigation, 58(01), 119-134. Nayak, R. A. (2000). Reliable and Continuous Urban Navigation Using Multiple GPS Antennas and a Low Cost IMU, MSc Thesis, Department of Geomatics Engineering, University of Calgary, Canada. Noureldin, A., Karamat, T. B., and Georgy, J. (2012). Fundamentals of inertial navigation, satellite-based positioning and their integration. Springer Science & Business Media. Petovello, M. G., Cannon, M. E., and Lachapelle, G. (2004). Benefits of Using a Tactical Grade IMU for HighAccuracy Positioning. Navigation, 51(1), 1-12. Phelts, R, E. (2007). Range Biases on Modernized GNSS Codes, Proceedings of European Navigation Conference GNSS/TimeNav, Geneva, Switzerland.

http://waas.stanford.edu/~wwu/papers/gps/PDF/PheltsENC07.pdf. Píriz, R., García, Á, M., Tobías, G., Fernández, V., Tavella, P., Sesia, I., and Hahn, J. (2008). GNSS interoperability: offset between reference time scales and timing

biases. Metrologia, 45(6), S87. Rabbou, M. A., and El-Rabbany, A. (2014). Tightly coupled integration of GPS precise point positioning and MEMS-based inertial systems. GPS Solutions, 1-9, doi:10.1007/s10291014-0415-3.

112

Rabbou, M. A., and El-Rabbany, A. (2015). Integration of GPS Precise Point Positioning and MEMS-Based INS Using Unscented Particle Filter. Sensors, 15(4), 7228-7245. Rabbou, M. A., and El-Rabbany, A. (2015). Precise Point Positioning using MultiConstellation GNSS Observations for Kinematic Applications. Journal of Applied Geodesy, 9(1), 15-26. Roesler, G.; Martell, H. Tightly Coupled Processing of Precise Point Position (PPP) and INS Data. In Proceedings of the 22nd International Meeting of the Satellite Division of the Institute of Navigation, Savannah, GA, USA; 2009; pp. 1898­1905. Schwarz, K. P. and M. Wei (2000). INS/GPS Integration for Geodetic Applications. ENGO623 Lecture Notes, Department of Geomatics Engineering, The University of Calgary, Canada. Shi, J., and Gao, Y. (2014). A comparison of three PPP integer ambiguity resolution methods. GPS Solutions, 18(4), 519-528. Shin, E. (2005). Estimation Techniques for Low-Cost Inertial Navigation, PhD Thesis, Department of Geomatics Engineering, University of Calgary, Canada. Shin, E. H., Niu, X., and El-Sheimy, N. (2001, May). Performance comparison of the extended and the unscented Kalman filter for integrated GPS and MEMS-based inertial systems. In Proceedings of the 2005 National Technical Meeting of The Institute of Navigation, San Diego, pp. 961-969. Simon, D. (2006). Optimal state estimation: Kalman, H infinity, and nonlinear approaches. John Wiley & Sons,Hoboken, NJ, USA. Steffen, R. (2008). A Robust Iterative Kalman Filter Based On Implicit Measurement Equations. Technical Report 8, University of Bonn, Department of Photogrammetry, Institute of Geodesy and Geoinformation.

113

Steigenberger, P., Hugentobler, U., Loyer, S., Perosanz, F., Prang, L., Dach, R., Uhlemann, M., Gendt, G., and Montenbruck, O. (2014). Galileo Orbit and Clock Quality of the IGS Multi-GNSS Experiment, Advances in Space Research, doi: 10.1016/j.asr.2014.06.030. Steigenberger, P., Hugentobler, U., Montenbruck, O., and Hauschild, A. (2011). Precise orbit determination of GIOVE-B based on the CONGO network. Journal of Geodesy, 85(6), 357-365. Sukkarieh, S. (2000). Low Cost, High Integrity, Aided Inertial Navigation Systems for Autonomous Land Vehicles, Ph.D. Thesis, Australian Centre for Field Robotics, Dept. of Mechanical and Mechatronic Engineering, The University of Sydney, Sydney, Australia. Teunissen, P., (1991). On the Local Convergence of the Iterated Extended Kalman Filter. Available http://saegnss1.curtin.edu.au/Publications/1991/Teunissen1991local.pdf. Xu, P., Shi, C., Fang, R., Liu, J., Niu, X., Zhang, Q., and Yanagidani, T. (2013). High-rate precise point positioning (PPP) to measure seismic wave motions: an experimental comparison of GPS PPP with inertial measurement units. Journal of Geodesy, 87(4), 361372. Yi, Y., and Grejner-Brzezinska, D., A. (2006). Tightly-coupled GPS/INS integration using unscented Kalman filter and particle filter. In Proceedings of the 19th International Technical Meeting of the Satellite Division of the Institute of Navigation, Fort Worth, TX, USA, pp. 2182­2191. Zhang, W., Cannon, M, E., Julien, O., and Alves, P. (2003). Investigation of combined GPS/GALILEO cascading ambiguity resolution schemes. Proceedings of ION GPS/GNSS, Institute of Navigation, Portland, OR, pp. 2599-2610. Zhang, Y.; Gao, Y. Performance Analysis of a Tightly Coupled Kalman Filter for the Integration of un-Differenced GPS and Inertial Data. In Proceedings of the 2005 National Technical Meeting of the Institute of Navigation, San Diego, CA, USA, 24­26 January 2005; pp. 270­275. 114 online:

Zhou, J., Knedlik, S., and Loffeld, O. (2010). INS/GPS tightly-coupled integration using adaptive unscented particle filter. Journal of Navigation, 63(03), 491-511. Zumberge, J. F., Heflin, M. B., Jefferson, D. C., Watkins, M. M., and Webb, F. H. (1997). Precise point positioning for the efficient and robust analysis of GPS data from large networks. Journal of Geophysical Research: Solid Earth (1978­2012), 102(B3), 50055017.

115

