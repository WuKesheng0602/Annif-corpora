Ryerson University

Digital Commons @ Ryerson
Theses and dissertations

1-1-2006

Enhancement of CN Tower lightning current derivative signals using a modified power spectral subtraction method
Huma Mehmud
Ryerson University

Follow this and additional works at: http://digitalcommons.ryerson.ca/dissertations Part of the Signal Processing Commons Recommended Citation
Mehmud, Huma, "Enhancement of CN Tower lightning current derivative signals using a modified power spectral subtraction method" (2006). Theses and dissertations. Paper 146.

This Thesis Project is brought to you for free and open access by Digital Commons @ Ryerson. It has been accepted for inclusion in Theses and dissertations by an authorized administrator of Digital Commons @ Ryerson. For more information, please contact bcameron@ryerson.ca.

ENHANCEMENT OF CNTOWER
LIGHTNING CURRENT DERIVATIVE SIGNALS USING A MODIFIED POWER SPECTRAL SUBTRACTION METHOD

By

HumaMehmud
Bachelor of Engineering Ryerson University Toronto, Ontario, Canada, 2003

A Project presented to Ryerson University in partial fulfillment of the requirement for the degree of Master of Engineering in the Program of Electrical and Computer Engineering.

School of Graduate Studies Ryerson University Toronto, Ontario, Canada, 2006

© Huma Mehmud, 2006
PROPERn' OF _ fiVERSON UM'J:i\~I1Y liBRARY

Claim of Authorship
I, Huma Mehmud hereby declare that I am the sole author of this project. The material and work contained in this report was researched and developed by myself.

I authorize Ryerson University to lend this project to other institutions or individuals for the purpose of scholarly research.

HlImn Mehmllcl

I further authorize Ryerson University to reproduce this project by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

HumaMehmud

11

Instructions for Borrowers
Ryerson University requires the signatures of all persons using or photocopying this project. Please sign below, and give address and date.

Name

Signature

Address

Date

111

Abstract
Enhancement of CN Tower Lightning Current Derivative Signals Using a Modified Power Spectral Subtraction Method
© Huma Mehmud 2006
Master of Engineering Department of Electrical and Computer Engineering Ryerson University
Lightning current measurements are possible using instrumented tall structures or rocket-triggered lightning. The

eN Tower has been a source oflightning current data for the past 15 years. A major portion of research

on the natural lightning is focused on developing lightning protection systems, and in order to do so, an accurate knowledge of the characteristics oflightning, including the return-stroke current, is required. The

eN

Tower is a transmission tower and it is expected that the recorded lightning current signals be corrupted with different kinds of noise. This makes it difficult to extract the return-stroke current waveform parameters (peak, 10-90% rise-time to peak, maximum steepness, pulse width, etc) from the measured waveforms. In this project, an over-subtraction and residual noise reduction based power spectral subtraction method has been developed in order to de-noise the lighting return-stroke current derivative signals measured at the

eN

Tower. In order to evaluate the proposed de-noising technique, the derivative of Heidler function is used to model the measured return-stroke current derivative signal. The measured current derivative signal is simulated using the Heidler derivative model after artificially corrupting it with noise signals measured at the eN Tower in the absence oflightning. A modified spectral subtraction method (MSS) is proposed and applied to de-noise the simulated current derivative signal and the resultant waveform is compared with the Heidler derivative model, which enabled accurate evaluation of the proposed method. The results of the evaluation show a substantial improvement in the signal peak-to-noise peak ratio (SPNPR) of up to 32 dB depending on the level of the noise signal, which is added to the Heidler derivative function. Furthermore, 95.7%-98.5% recovery of the peak of the original Heidler derivative function was obtained. For further evaluation of the new MSS method, the conventional spectral subtraction (SS) method is applied for de-noising the same simulated current derivative signals, which produced a substantially lower SPNPR of up to 16 dB with a peak recovery of93.3%-97.5% of the original Heidler derivative model. The proposed method is successfully used to substantially remove the noise from the lightning current derivative signals measured at the

eN Tower.

IV

Acknowledgements
First, and foremost, I would like to express my deepest thanks to Allah, God Almighty, for helping me get this far.

I would like to thank my project supervisor, Dr. Ali M. Hussein for his insight, constant guidance and encouragement.

I would like to thank my parents and siblings for their immeasurable love and support throughout the course of my studies.

Very special thanks to PhD students Ouarda Nedjah and Mariusz Milewski for their great assistance and guidance.

I would also like to thank the Department of Electrical and Computer Engineering and the School of Graduate Studies for giving me a chance to continue my studies beyond Bachelors of Engineering.

v

To my parents

VI

Contents
Symbols Abbreviations 1 Introduction 1.1. 1.2. 1.3. 1.4. 2
Xll

xiv

1

Sources of Lightning ............................................................................ .2 Types of Lightning Discharge .................................................................. 2 Negative Cloud to Ground (CG) Lightning .................................................. .3 Lightning Protection ............................................................................. 5 6

Lightning Studies at the eN Tower 2.1 2.2 2.3

2.4 2.5 2.6
3

Instruments used to Study Lightning to the CN Tower ..................................... 6 Current Measurement System at the CN Tower ........................................................... 8 Current associated with Lightning Strokes to the CN Tower .............................. 9 2.3.1 Current Characteristics ........................................................... 9 2.3.2 Effect of Height of Struck Object on the Lightning Current Parameters .................................................................................. .12 Different Kinds of Noise Affecting Lightning Current Derivative Signals Measured at the eN Tower. .................................................................................. 13 Objectives of this Project ...................................................................... 15 Outline of the Project.. ........................................................................ .15

Lightning channel-base current function model and the calculation of its parameters 16 3.1 Lightning channel-base current function .................................................... 16 3.1.1 The double exponential function .............................................. 16 3.1.2 Heidler Function ................................................................. 17 3.1.3 Pulse Function ................................................................... 19 3.2 Calculation of the lightning current parameters ............................................ 19 Analysis of non-stationary signals 28 4.1 Continuous Time Fourier Transform (CTFT) ............................................. .28 4.1.1 Sampling and Aliasing .......................................................... 29 4.2 Discrete Time Fourier Transform (DTFT) and Fast Fourier Transform (FFT) ....... .30 4.3 Short Time Fourier Transform (STFT) ..................................................... .34 4.3.1 Basis of Short Time Fourier Transform (STFT) ............................ .34 4.3.2 Window Selection ............................................................... .38 4.3.3 Choice ofFFT Length .......................................................... .40 4.3.4 Number of Overlapping Points ............................................... .40

4

vii

5

Noise Reduction Techniques - A Literature Review 41 5.1 Spectral Subtraction ........................................................................... .42 5.1.1 Conventional Spectral Subtraction ........................................... .42 5.1.2 Power Spectral Subtraction .................................................... .46 5.1.3 Limitations to Spectral Subtraction .......................................... .48 5.2 Modifications to Spectral Subtraction ...................................................... .49 5.2.1 Spectral Subtraction using Over-Subtraction and Spectral Floor ......... 49 5.2.2 Nonlinear Spectral Subtraction ................................................ 50 5.2.3 Extended Spectral Subtraction ................................................. 51 Noise Reduction Techniques - A Literature Review 53 6.1 Power Spectral Subtraction with Over-Subtraction and Residual Noise Reduction ... 53 6.1.1 Assumptions made throughout the development of the Proposed Method ................................................................................................ 53 6.1.2 Development of the Proposed Algorithm .................................... 54 6.1.3 Half Wave Rectification and Residual Noise Reduction .................... 57 6.1.4 Other Important Enhancement Factors ........................................ 58 6.2 Overview of the Proposed System and its Implementation .............................. 60 Results and Performance Evaluation of the Proposed Method 62 7.1 Heidler Function ............................................................................... 62 7.2 Windowing and Frequency Analysis ........................................................ 66 7.3 Performance Evaluation ofthe Proposed Method ......................................... 68 7.3.1 Performance evaluation of the proposed method on the Heidler derivative model corrupted with frequency modulated noise signaL ........................... 68 7.3.2 Performance evaluation of the proposed method on Heidler derivative model corrupted with different levels ofCN Tower noise only signal. ................... 70 7.3.3 Waveform parameters from the de-noised Heidler derivative function and its corresponding Heidler function for different noise level ............................. 75 7.4 Comparative results of the proposed and conventional spectral subtraction methods .......................................................................................... 77 7.5 De-noising the lightning current derivative signals measured at the CN Tower ...... 79 7.6 Summary of Results ........................................................................... 92 Conclusions and Future Research 93 8.1 Conclusions ...................................................................................... 93 8.2 Future Research ................................................................................. 94

6

7

8

Bibliography

96

Vlll

List of Tables
Table 2.1: Summary of statistics of current waveform parameters (1992-2001) [9] ..................... 11 Table 2.2: Summary of cumulative distribution of current steepness for CN Tower and data from other tall structures, and from rocket-triggered lightning in Florida [10] ............................. 12 Table 2.3: Summary of cumulative distribution of absolute current peak for CN Tower and data from other tall structures as well as from rocket-triggered lightning in New Mexico and Florida [10] ........................................................................................................................... 13 Table 3.1: Waveform Parameters ofa typical CN Tower lightning current signal [File: G0363096.788] ..................................................................................................................... 23 Table 3.2: Calculated values of the lightning current parameters ................................................. 26 Table 4.1: Properties of the different window functions [20] ...................................................... 39 Table 7.1: Effect of different sizes of Hanning window on the shape and SPNPR of the de-noised Heidler derivative waveform and its corresponding current waveform ................................ 67 Table 7.2: Waveform parameters of the de-noised Heidler derivative function for different levels of noise .................................................................................................................................. 76 Table 7.3: Waveform parameters of the Heidler function corresponding to the de-noised Heidler derivative function for the different levels of noise .............................................................. 76 Table 7.4: Comparison analysis of the conventional spectral subtraction (SS) and the proposed spectral subtraction (MSS) methods applied on the Heidler Derivative function under different noise levels ............................................................................................................. 78 Table 7.5: De-noised Heidler current (corresponding to the de-noised Heidler derivative function in Table 7.4) waveform parameters for different levels of noise .......................................... 78 Table 7.6: SPNPR and Peak values of the lightning current derivative signal and its corresponding current waveform (Figure 7.19) before and after the application of the proposed method (MSS) [File: G0363096.788] .................................................................... 82 Table 7.7: SPNPR and Peak values of the lightning current derivative signal and its corresponding current waveform (Figure 7.23) before and after the application of the proposed method (MSS) [File: DI146339.192] .................................................................... 84 Table 7.8: SPNPR and Peak values of the lightning current derivative signal and its corresponding current waveform (Figure 7.27) before and after the application of the proposed method (MSS) [File: A0280824.252] .................................................................... 87 Table 7.9: SPNPR and Peak values of the lightning current derivative signal and its corresponding current waveform before and after the application of the conventional spectral subtraction method (SS) [File: G0363096.788] ....................................................... 88 Table 7.10: SPNPR and Peak values of the lightning current derivative signal and its corresponding current waveform before and after the application of the conventional spectral subtraction method (SS) [File: D 1146339 .192] ....................................................... 88 Table 7.11: SPNPR and Peak values of the lightning current derivative signal and its corresponding current waveform before and after the application of the conventional spectral subtraction method (SS) [File: A0280824.252] ....................................................... 88

IX

List of Figures
Figure 1.1: Thundercloud charge distribution and categorization of the four types of lightning between cloud and ground [2], [6] .......................................................................................... 3 Figure 1.2: Various processes that make up a negative CG lightning discharge [2], [6]. ................ 4 Figure 2.1: The CN Tower and location of instruments [9]. ............................................................ 7 Figure 2.2: The old Rogowski coil and its location [9]. .................................................................. 8 Figure 2.3: A typical current derivative waveform captured at the CN Tower (a) and its corresponding current waveform (b) obtained by integration ............................................... 10 Figure 3.1: Heidler function waveform ......................................................................................... 18 Figure 3.2: Heidler derivative function ......................................................................................... 18 Figure 3.3: Current peak correction factor 1] vs. '&'2/'&'1 .............................................................. 22 Figure 3.4: Lightning current derivative (a) and its corresponding current waveform (b) .......... 24 Figure 3.5: Dimensionless function 1; as a function of the quotient'&'2 / '&'1. Here, current steepness factor k is used as a parameter............................................................................... 25 Figure 3.6: Dimensionless function r; as a function of quotient '&'2 / '&'1. The current steepness factor k is used as a parameter ............................................................................................... 25 Figure 3.7: The dimensionless function I; as a function of the quotient'&'2 / '&'1. The current steepness factor k is used as a parameter ............................................................................... 26 Figure 3.8: Heidler derivative function (a) and its integration (b) waveforms corresponding to the parameter values shown in Table 3.2 .................................................................................... 27 Figure 4.1: Continuous time signal and its corresponding sampled signaL ................................ 29 Figure 4.2: The windowing operation for a given frame [26] ....................................................... 35 Figure 4.3: Illustration of segmentation ofa signal (with a missing gap or frame skip) for spectral-time representation [24] ........................................................................................... 36 Figure 4.4: Spectral-time representation of a signal with a missing gap [24]. ............................. 36 Figure 4.5: The overlap and add method ....................................................................................... 37 Figure 4.6: The overlap and add procedure showing the sum of three overlapping frames .......... 38 Figure 5.1: Block diagram of the overall spectral subtraction system ........................................... 44 Figure 5.2: Block diagram representing the Extended Spectral Subtraction method [33] ........... 52 Figure 6.1: Block diagram representation ofthe overall proposed spectral subtraction ................ 61 Figure 7.1: Heidler derivative (a) and its corresponding current waveforms (b) .......................... 63 Figure 7.2: Typical noise signal measured at the CN Tower (a), and its integration (b) ............... 64 Figure 7.3: Frequency spectrum of the noise signal shown in Figure 7.2 (a) ................................ 64 Figure 7.4: Low frequency content of the noise signal shown in Figure 7.2 (a) ........................... 64 Figure 7.5: Corrupted Heidler current derivative waveform (a) and its corresponding Heidler current waveform (b) obtained by numerical integration ...................................................... 65 Figure 7.6: Heidler function derivative corrupted with the modulated noise (a) and its corresponding Heidler function (b) ....................................................................................... 68 Figure 7.7: Frequency content of the corrupted Heidler derivative function ................................. 69 Figure 7.8: De-noised Heidler derivative signal (a) and its corresponding current waveform (b). 69 Figure 7.9: Heidler derivative function (before and after de-noising) using the proposed MSS method ................................................................................................................................... 70 Figure 7.10: Corrupted Heidler current derivative waveform (a) and its corresponding Heidler current waveform (b) obtained by numerical integration ...................................................... 71 Figure 7.11: De-noised Heidler derivative function and its corresponding current waveform (obtained by integration) using the proposed de-noising method ......................................... 71

x

Figure 7.12: De-noised Heidler derivative function (close up view of Figure 7.11) ..................... 72 Figure 7.13: Heidler derivative signal corrupted with the noise signal measured at the CN Tower in the absence of lightning .................................................................................................... 73 Figure 7.14: De-noised Heidler derivative signal using the MSS method ..................................... 74 Figure 7.15: De-noised Heidler derivative signal using SS method .............................................. 74 Figure 7.16: Comparison of the values of SPNPR of the noised Heidler derivative signal with the values of SPNPR of the de-noised Heidler derivative signal using MSS and SS methods for different noise levels ............................................................................................................. 79 Figure 7.17: Lightning current derivative (a) measured at the CN Tower and its corresponding current waveforms (b) [File: G0363096.788]. ...................................................................... 80 Figure 7.18: The lightning current derivative signal after the removal of a dc shift (a) and its corresponding current waveform (b) [File: G0363096.788] ................................................. 80 Figure 7.19: De-noised lightning current derivative (a) and its corresponding current waveforms (b) (de-noised of Figure 7.18) [File: G0363096.788] ........................................................... 81 Figure 7.20: A Close up view of Figure 7.19 [File: G0363096.788] ............................................. 81 Figure 7.21: Lightning current derivative measured at the CN Tower (a) and its corresponding current waveform (b) [File: Dl146339.192]. ........................................................................ 82 Figure 7.22: Lightning current derivative with dc noise removed (a) and its corresponding current waveform (b) [File: Dl146339.192]. .................................................................................... 83 Figure 7.23: De-noised lightning current derivative (a) and its corresponding current waveform (b) (de-noised of Figure 7.22) [File: Dl146339.192] ........................................................... 83 Figure 7.24: A Close up view of Figure 7.23 [File: Dl146339.192] ............................................ 84 Figure 7.25: Lightning current derivative and measured at the CN Tower (a) its corresponding current waveform (b) [File: A0280824.252]. ........................................................................ 85 Figure 7.26: Lightning current derivative with dc noise removed (a) and its corresponding current waveform (b) [File: A0280824.252]. .................................................................................... 85 Figure 7.27: De-noised lightning current derivative (a) and its corresponding current waveform (b) (de-noised of Figure 7.26) [File: A0280824.252]. .......................................................... 86 Figure 7.28: A close up view of Figure 7.27 [File: A0280824.252]. ............................................. 86 Figure 7.29: De-noised lightning current derivative (a) and its corresponding current waveform (b) (using MSS) [File: Dl146339.192] ................................................................................. 89 Figure 7.30: A close up view of Figure 7.29 [File: Dl146339.192]. ............................................. 89 Figure 7.31: De-noised lightning current derivative (a) and its corresponding current waveform (b) (using SS) [File: Dl146339.192]. .................................................................................... 90 Figure 7.32: A close up view of Figure 7.31 [File: D1l46339.192]. ............................................ 90 Figure 7.33: Comparison of the current derivative signal de-noised using MSS and SS (for Figure 7.30 and Figure 7.32) ............................................................................................................ 91 Figure 7.34: Comparison of the values ofSPNPR of the original current derivative signals measured at the CN Tower with the values of SPNPR after applying MSS and SS methods . ............................................................................................................................................... 91

Xl

Symbols
a a {SNR}
a(e illJ ) f3
Current peak correction factor Over-subtraction factor as a function of signal to noise ratio SNR Value of a {SNR} at 0 dB SNR Frequency dependent over-subtraction factor Spectral floor Noise signal Windowed noise signal Frequency spectrum of dw(n) Estimated time-average noise spectrum of dw(n) Estimated power spectrum of dw (n) Spectral error Expectation operator Frequency variable Maximum value of the current peak Window length DFT length In the order of (N square) Total charge transfer Frame spacing Clean signal Estimated clean signal Windowed clean signal Frequency spectrum of
Sw (n)

den)
dw(n) Dw(e illJ ) Dw(e illJ ), Dw(e illJ ) 1Dw(e illJ ) 12 ew(e illJ ) E[.]

f
M N O(N2)

Qo
S

sen)

sen)
sw(n) Sw(e illJ ) Sw(e illJ )
S~(eillJ)

Estimate of clean signal frequency spectrum Modified estimated spectrum of sw(n) Estimated power spectrum of Sw (e lllJ ) Current rise time to peak Current decay time

1Sw(e lllJ ) 12

Ily

Mean of the noisy signal Mean of the noise signal Estimated time-average of dw(n) frequency spectrum Cross correlation factor Current peak correction factor Phase of Yw(n)

Ild
Ilw(e lllJ )

8
1]

oyw (e lllJ )

XlI

ed

w

(e laJ )

Phase of dw(n) Nonlinear function Frequency dependent signal to noise ratio Variance of the noisy signal Variance of the noise signal Window function Noisy signal Windowed frame of noisy signal Frequency spectrum of signal x(n) Cross correlation between the noisy signal and the noise signal Noisy signal Windowed noisy signal Frequency spectrum of yw(n) i 'h windowed transform of yen) Average of Yw (e laJ ) Estimated power spectrum of y w (n)

rpw (e laJ )
p(e laJ )
(J'2 (J'2
y
d

wen)

x(n) xm(n)
X(f)
Xyd

yen)

Yw(n) Yw(e laJ )

Y;w (e laJ )
Yw(e laJ )
1Yw(e laJ ) 12

X111

Abbreviations
A AID AGL CG CNT CTFT dB DFT DTFT ESB FFT GPS HSC Hz IC

IEC IFFT LEMP Max Min NSNR OLA RSV SNR SPNPR STFT V VHS

Amps Analogue to Digital conversion Above Ground Level Cloud to ground discharges Canadian National Tower Continuous Time Fourier Transform Decibels: 10 10gIO (power ratio) Discrete Fourier Transform Discrete Time Fourier Transform Empire State Building Fast Fourier Transform Global Positioning System High Speed Camera Hertz, unit of frequency in cycles per second Intracloud discharges International Electrotechnical Commission (International standards) Inverse Fast Fourier Transform Lightning Electromagnetic Pulse Maximum value Minimum value Segmental Noisy Signal to Noise Ratio Overlap and Add method Return Stroke Velocity Signal to Noise Ratio Signal peak to noise peak ratio Short Time Fourier Transform Volts Video Home System

XIV

Chapter 1

Introduction and Motivation
Lightning is one of the most beautiful natural wonders, but one of the most deadly natural phenomena known to man. Lightning has a bolt temperature 4-5 times hotter than the surface of the sun and shockwaves beaming out in all directions. Natural lightning was proved to be an electrical discharge by Benjamin Franklin more than 200 years ago. He also measured the sign of the cloud charge that produced it and found that lightning is nothing more than a very long spark which discharges regions of excess electrical charge developed in thunderclouds [1].

In the 1930's lightning research was motivated due to the need to reduce the effects of lightning on electric power systems and to understand an important metrological process. In 1960's the research was primarily based on unexpected vulnerability of solid state electronics to damage from lightning-induced voltages and currents with resultant hazards to both modern ground-based and airborne systems [2]. The most exposed of these are the electric power lines, telecommunication systems, aircrafts and spacecrafts. The lightning arresters do not dissipate all the energy from lightning surges to ground and therefore protection devices must be installed on the equipments [3].

Consequently a major portion of research on the natural lightning is focused on developing lightning protection systems, and in order to do so, a precise knowledge of the characteristics of lightning, including the current waveform parameters is required.

The sophisticated measuring instruments and advanced analysis methods made great improvements in the precision and efficiency of the study of lightning, but due to the physical limitations of the measuring systems, the captured signal is susceptible to many types of noise. In order to suppress these different types of noise, software based de-noising technique is proposed in this project, which is flexible in operation and is free of any internal noise.

1

1.1

Sources of Lightning

Most of the research to date is focused on the thundercloud known as cumulonimbus because this cloud produces most of the lightning discharges [2]. There are other types of clouds such as stratus, stratocumulus, cumulus, nimbostratus, altocumulus, altostratus, and cirrus that potentially produces lightning or long sparks (I-100m), but there is a limited research done on these type of clouds [2], [4].

In 1920's and 1930's the classic model for the charge structure of a thundercloud was developed. This model describes a thundercloud that forms a positive electric dipole as shown in Figure 1.1. In an electrical storm, the thundercloud is charged like a giant capacitor in the sky. The primary positive charge region is found above the primary negative charge region as shown in Figure 1.1 [2], [4].

1.2

Types of Lightning Discharge

Natural lightning discharge consists of four categories: cloud-to-cloud, cloud-to-air, intra-cloud, cloud-to-ground or ground-to-cloud. Over half of all flashes occur within the cloud, which are known as intra-could discharges (lC) [2], [4], [5]. Most of the research is done on the commonly occurring cloud-to-ground (CG) electric discharge because of its practical importance such as the cause of injuries and death, disturbances in power and communication systems, and the ignition of forest fires. Occurrence of cloud-to-cloud and cloud-to-air discharges is very rare compared to that ofIC and CG [2], [4].

Furthermore, there are four different types of lightning between cloud and earth (ground) and these are shown in Figure 1.2. First type of CG lightning is initiated by a downward moving negatively charged leader, in other words, the negative charge from the cloud is lowered to the earth [4]. Statistical research shows that 90% of the CG lightning discharge worldwide is of this type (Figure 1.1, category 1). While 10% of the worldwide cloud-to-ground lightning is initiated by a downward moving positively charged leader (Figure 1.1, category 3), that is, the positive charge is lowered from the cloud to ground [4]. The third type oflighting is initiated by an upward moving positively charged leader (Figure 1.1, category 2) while the fourth type is initiated by an upward moving negatively charged leader (Figure 1.1, category 4). These upwards

2

initiated flashes are relatively rare and usually occur from mountain peaks and tall man-made structures such as the Canadian National (CN) Tower.

E
w ·

.-. . . · 7
~-::
..
~:-

+-. --'""_::

=-~

_ _~

CL::t;
~~
3

~.
4

{:~~~~f;-~

Figure 1.1: Thundercloud charge distribution and categorization of the four types of lightning between cloud and ground [2), [6].

1.3

Negative Cloud to Ground (CG) Lightning

Negative CG lightning begins in the cloud and effectively lowers to earth tens of coulombs of negative cloud charge. The total discharge is termed a flash. A flash is made up of various discharge components among which are typically 3-4 high-current pulses called strokes. A flash lasts about half a second with one stroke lasting typically around a millisecond. The separation between the strokes is around several tens of millisecond [2], [5].

The initiating downward traveling spark is called the "stepped leader" [1]. The stepped leader is itself initiated by a preliminary breakdown within the cloud [2], [4].The stepped leader is a lowluminosity traveling spark which moves from the cloud to the ground in rapid steps of about 1 micro-second each, tens of meters in length and having a pause time between the steps of 20-50 micro-seconds. The stepped leader is not visible to the eye. The visible light is seen when a stepped leader connects to the ground lowering around 10 C or more of a negative charge in tens of milliseconds. The average downward speed of a leader is about 2 X 105 m/s. The average

3

leader current is between 100 and 1000 A, and the leader steps have peak pulse currents of at least lkA [2]. Figure 1.2 shows various processes that make up a negative CG lightning discharge.

There exists a potential difference between the lower portion of the negatively charged leader and the ground (earth) that has a magnitude of more than 107 V [4]. When the tip of the leader is near the ground, the electric field at sharp objects on the ground or at irregularities on the surface increases until it exceeds the breakdown strength of air. When the breakdown occurs, one or more of the upward moving discharges are initiated from those points and the thus the attachment process begins [2], [4]. The downward moving leader connects to the upward moving discharges and the leader channel is then discharged by an ionizing wave of ground potential that propagates up the previously charged leader channel. This process is called the first return stroke [1], [2], [4]. The speed of this upward traveling stroke near ground is typically one-third to one-half of the speed of light, and the speed decreases with height. The total transit time between ground-tocloud is about 100 microseconds [4]. The peak current produced by the first return stroke is typically 30kA at the ground, with a time from zero to peak of a few microseconds. This current peak value measured at ground decreases to half in about 50 microseconds [2].

~~~~.
~......

"" 1.00 _

..

~~~~
1.15 ms

.... r:;:;;r
19.00 ma

20.00 ms

20.10 ms

20.15

rna

20.20 ma

..

.

-

~

.. .....

.-~

/:....

IItAHO ..
PJIOCESSEe

0/

&£.COHD 'tinURN .TflOKE

:~"" ..... :~

~~~.

-'"'

40.00 ms

60.00 ma

61.00 ms

62.00 ma

62.05 ma

Figure 1.2: Various processes that make up a negative CG lightning discharge [2], [6].

4

The rapid release of the return-stroke-energy heats the leader channel to a temperature of above 30,000 K and produces a high pressure channel that expands and creates a shock wave. This shock wave causes the sound we hear that is called thunder [4].

1.4

Lightning Protection

Since 1920s many investigations have been carried out on the effects of lightning on powertransmission lines and on methods of protection [7], [8]. The study oflightning for the purpose of power-line protection has been the basis of the principles that have been evolved for the protection of all other systems and structures. Although protection methods are well developed, lightning still causes frequent power interruptions and causes disturbances in the modern electronic systems [7].

The two important factors in order to build protection system described in [2] are: 1) 2) to identify and perhaps avoid the hazard and Harden the system of interest to withstand the effects of nearby and direct strikes.

The lightning protection systems can not be properly designed without proper statistics of the lightning current waveform parameters. Therefore statistical analysis of lightning current characteristics is very important for building lightning protection systems.

5

Chapter 2

Lightning Studies at the CN Tower
The Toronto Canadian National (CN) Tower is the tallest man-made freestanding structures in the world. It was built in 1976 with the height of 553 meters.

The local lightning flash density (number of flashes per square kilometer per year) in Toronto is about 2 and the Tower receives many tens of strikes each year. VHS video records show that the CN Tower was hit with 77 flashes during the lightning season of 1991, 24 of which occurred within 100 minutes [9], [10]. Lightning strikes to the CN Tower have been observed since 1978. Since then, the CN Tower is being used for the purpose of studying the physics of the lighting phenomenon and to collect characteristics of the parameters, of currents, and of the lightninggenerated electric and magnetic fields [10].

The CN Tower is one of the best sites in the world to observe and study lightning, and is a great source of lightning date to produce statistical results in order to assist in the establishment of more sophisticated protective measures against lightning hazards [9].

2.1

Instruments used to Study Lightning Strikes to the

eN Tower

In summer 1991, five measurement stations were in operation to simultaneously capture the most important lightning parameters: the return-stroke current derivative at the Tower (using a Rogowski coil), the vertical component of the electric field, the two horizontal components of the magnetic field and the return-stroke velocity. In order to establish the three dimensional images of lightning flash trajectories, two VHS video systems were installed at two different locations to record flashes [10]. Figure 2.1 shows the location of various instruments placed at and around the CN Tower. In 1996, a 1000 frame/s High-Speed Camera (HSC) was acquired. In 1997, a noiseprotected current derivative measuring system was installed at the Tower. Furthermore, four Global Positioning Systems (GPS) are recently acquired for the time synchronization of all measurement stations at the CN Tower [9].

6

Tower Tip (553 m) _____

New Rogowski Coil (509 m) - _ Old Rogowski Coil (474 m ) - -

Recording Instrumentation - -

VHS HSC RSV

West

Figure 2.1: The eN Tower and location of instruments [9].

7

The simultaneous measurements of the CN Tower lightning return-stroke currents and their generated electromagnetic fields have been performed since 1991 using large-bandwidth and high-resolution equipment. The instruments used for this purpose are three 10-bit, 10-ns computer controlled double-channel digitizers with segmented memories (Tektronix RTD710A). The vertical component of the electric field and two horizontal components of the magnetic field are measured using three field sensors having bandwidths exceeding 100 MHz [9].

2.2

Current Measurement System at the CN Tower

For the purpose of measuring the lightning current derivative, a measuring system was installed at the CN Tower in 1990, which consists of a 3-m, 40-MHz Rogowski current sensing coil. The coil encircles one fifth of the Tower's steel structure (see figure 2.2) at the 474-m above ground level (AGL) [9].

Rogowski coil

eN Tower's steel structure
.500 0UI:plL

Figure 2.2: The old Rogowski coil and its location [9].

Since the old Rogowski coil encircles one fifth of the Tower's steel structure, the captured signal is therefore assumed to correspond to 20% of the total current. The Rogowski coil is connected, via a tri-axial cable, to a recording station at 403-m above ground level (AGL) which captures up to eight return strokes per flash. The Rogowski coil has a rise time of 8.7ns. The overall rise time

8

of the measurement system is estimated to be about 20ns [9].

In 1997, a noise-protected current derivative measurement system was installed. This new sensing coil is a 6-m, 20-MHz Rogowski coil surrounding the entire steel structure of the Tower at the 509-m AGL (Figure 2.2). This coil is connected, via an optical fiber link to a recording station [9]. The current sensors are placed as far as from the Tower's main structural discontinuities (the tip of the Tower, the space Deck, the top and bottom of the main observation Deck, and the ground) to avoid reflections [9].

Most of the statistical analysis on the waveform parameters is based on the current derivative measurements done using the old Rogowski coil. The new coil has not been properly functioning for several years [9].

2.3

Current associated with Lightning Strokes to the CN Tower

2.3.1 Current Characteristics

The current is not directly measured at the CN Tower but instead the current derivative is measured using a Rogowski coil. The Rogowski coil (Inductive coil) measures the variation of current flow, which provides the current derivative, and thus it makes it possible to obtain the current waveform indirectly. The lightning current waveform is obtained by numerically integrating the captured current derivative signal. Using hardware to integrate the lightning current derivative signal may distort the signal due to the frequency response of the integrator and will therefore not give accurate results.

A typical current derivative (di/dt) waveform captured at the CN Tower by the old coil and its corresponding current (obtained through time integration) is shown in Figure 2.3. Each di/dt record contains 16 kilobytes of data, which is acquired at 100 MHz (l0 ns) resolution and is digitally stored.

9

Jul 03/1999,17:31:36,3 out of4 stroke(s), Channel A, G0363096.363
10

o
-10~--~----~----~----~--~----~----~----~--~----~

-60

-40

-20

0

20

40 Time [J,ls]

60

80

100

120

140

8,----.----,----,----.----,----,---~----~----,_--~

6
4 2

o
·~~0---.4~0~-.~2~0--~0--~20~--4~0--~60~-.8~0---1~0~0--~1~20~~140
Tim e lJ,ls]
Figure 2.3: A typical current derivative waveform captured at the eN Tower (a) and its corresponding current waveform (b) obtained by integration.

There are five important lightning current waveform parameters that should be studied well in order to build sophisticated protection measures. These parameters are [9]:

1. Maximum wavefront steepness 2. Rise time to maximum steepness 3. Wavefront peak 4. Rise time to wavefront peak 5. Absolute peak, which includes current reflection from ground that depends on the characteristics of the struck object and the location of the current sensing instrument

The statistical analysis of lightning current derivative using an old Rogowski coil is based on the collected data during 10 years (1992-2001). These data represent 116 flashes to the CN Tower having 387 return strokes. The results of the statistical analysis over this period are [9]:

·

Based on the VHS video records analysis, almost all lightning return strokes to the CN Tower were found to be negative and upward-initiated, that is, out of308 confirmed flashes, only two were proved to be downward initiated [9].

10

·

50% of the current waveform records show that [9]:

· · · ·
·

The current wavefront maximum steepness exceeds 18.8 kA//lS

· The rise-time (10-90%) to maximum steepness exceeds 138ns
The current wavefront peak exceeds 5kA The rise time to wavefront peak exceeds 636ns The current absolute peak exceeds 7.2 kA

First strokes generally exhibit lower current steepness, higher current peak, larger rise time and lower current derivative to current peak ratio [9].

·

The first return stroke has lower current steepness and higher current peak compared to the subsequent return strokes [9].

These results are presented in Table 2.1.

Table 2.1: Summary of statistics of current waveform parameters (1992-2001) [9]

Min. Max. Steepness (kA/Jls) Risetime to max. steepness (ns) Wavefront peak (kA) Risetime to peak (ns) Absolute peak (kA) 2.16 47.4 0.69 77.1 1.01

95%
3.78 57.2 1.27 194.5 2.17

50%
18.81 138.1 5.06 646.0 7.19

Avg. 19.38 311.6 6.38 861.4 9.00

5%
36.99 1025.3 15.95 2882.5 23.28

Max. 55.53 4255.2 41.72 6984.6 59.19

The range of variation of the lightning current parameters at the CN Tower, based on the statistical analysis from 1992-2001 are [9]:

· · · ·

Wavefront peak: 0.7-42kA Current wavefront maximum steepness: 2.2-56 kA//lS Rise time to maximum steepness: 47ns-4/ls Rise time to wavefront peak: 77ns-7/ls

11

·

Absolute peak: exceeded the wavefront peak by about 40% and varied from 1.0 - 59kA

Keeping in mind these variations in lightning current parameters, special measures must be applied for protection from the direct and indirect hazards of lightning (especially at elevated structures) [9].

2.3.2 Effect of Height of Struck Object on the Lightning Current Parameters
The current waveform parameters are greatly influenced by the height ofthe struck object. In [10], eN Tower data (1992-2001) is compared with data from other tall structures as well as from rocket-triggered lightning facilities in Florida and New Mexico. The elevated structures used for comparison are: two towers on Mount San Salvatore in Switzerland, the 160m tower on Hoher Peissenberg Mountain in Germany, and the New York Empire State Building (ESB) [10].

The statistical analysis based on the comparative study shows that as the height of the elevated struck object increases, the current peak decreases and also the current wavefront steepness decreases [10]. These results are presented in Table 2.2 and Table 2.3.

Table 2.2: Summary of cumulative distribution of current steepness for eN Tower and data from other tall structures, and from rocket-triggered lightning in Florida [101

Maximum Steepness [kA/Jls] Min. CNT ESB German Tower Florida
2.2 0.3 1.55 44

Max.
55.5 40 162.2 260

Mean
19.4

95%
3.8 1.17 2.65 62.78

50%
18.8 13.0 25.94 100

5%
36.9 38.29 120 219.7

36.96 111.4

12

Table 2.3: Summary of cumulative distribution of absolute current peak for eN Tower and data from other tall structures as well as from rocket-triggered lightning in New Mexico and Florida [10]

Absolute Current Peak [kA] Min. CNT ESB Berger German Tower New Mexico Florida
1.01 2.5 1.9 1.57 0.1 5

Max.
59.2 60 101.6 21.1 40.0 49

Mean
9.0

95%

50%

5%

2.2 4.17 3.5 2.53 3.47 6.14

7.2 9.99 12.1 8.05 18.26 11.75

23.3 33.91 63.8 17.89 37.73 38.47

8.49 17.94 13.48

Table 2.2 and Table 2.3 present the comparison between different towers and the effect of their heights on the maximum steepness and the absolute current peak. It is important to note that the current parameters also depend on whether the structure is erected on flat ground or in mountainous area. Also, the location of the current sensors must be considered for proper comparison [10].

Another study in [11] shows that there is a substantial higher increase of the field magnitude for the subsequent return strokes, which are characterized by much faster rise times compared to first return strokes.

2.4

Different kinds of Noise Affecting the Lightning Current Derivative Captured at the CN Tower

The lightning current derivative captured at the CN Tower as seen in Figure 2.3 is corrupted by different types of noise. These different kinds of noise that make it hard to extract the parameters of the current derivative (di/dt) as well as that of the current waveform are [12]:

1.

DC offset

There is a noticeable DC offset present in the dildt waveform which gives rise to a noticeable ramp after integration in the current waveform. Among all the noise listed, DC offset is the easiest to remove.

13

2.

High-Frequency Noise

The high frequency noise makes the current derivative waveform shape unclear. High frequency noise does not have much of an effect on waveforms with high peak values of di/dt. The source of the high-frequency noise is the broad cast antennas.

3.

Low-Frequency Noise around 100 kHz

Low frequency noise is the most important of all other the noise listed since it makes the calculation of the waveform parameters difficult. The source of this type of noise was unknown until recently. The 100 kHz noise is discovered to be the Loran-C signal interfering with the lightning signal. Loran-C is a radionavigaton system using the frequency band of 90-11 0 kHz [13].

4.

Reflections

When the lightning current wave propagates through the Tower, several reflections in the di/dt waveform are caused due to the discontinuities of the tower's structure. This type of noise can be dealt with by using the transmission line model of the tower.

The noise that causes most of the problems is the low frequency noise and therefore we are more interested in removing this noise. Others can be removed relatively easily. The high frequency noise is minimized by the integration of di/dt waveform. The DC offset is removed by subtracting the average of the pre-stroke portion of the current derivative signal from the whole current derivative signal. This does not cause any change in the original signal and therefore the DC offset noise is removed easily.

The low frequency noise is the hardest one to remove. Due to the fact that the lightning current waveform has a broad frequency spectrum, it is generally difficult to remove the noise without losing some part of the original signal.

14

2.5

Objectives of this Project

The objectives of this project are to:

1. Research and develop a method to de-noise the current derivative waveform measured at the CN Tower 2. Apply the proposed method on the derivative of Heidler function artificially corrupted with additive noise. Heidler function represents lightning current waveform and is ideal for testing purposes. Details on Heidler function are given in chapter 3 3. Evaluate the proposed method by comparing it with the previously developed methods 4. Research and analyze a method to extract the parameters of the lightning current derivative signal and its corresponding current waveform by using Heidler function 5. Determine the waveform parameters of the de-noised lightning waveforms

2.6

Outline of this Project

This project is divided into eight chapters. In Chapter 3, detailed description of the Heidler Function along with the method of extracting parameters of the lightning signal waveforms using Heidler model function is given.

In chapter 4, the properties of the non-stationary signals, Continuous Time Fourier transform (CTFT), Discrete Fourier Transform (DFT), Fast Fourier Transform (FFT), Aliasing and Nyquist theorem are described.

Chapter 5 presents a literature review of different spectral subtraction based de-noising techniques.

In chapter 6, a modified spectral subtraction based method is proposed and discussed in detail. In chapter 7, the proposed method is evaluated by comparing the results derived by the proposed method with the results obtained by using some techniques described in chapter 5.

Finally in chapter 8, conclusions, discussions, major contributions, and areas of concern and the recommendation of the future work are reported.

15

Chapter 3

Lightning Channel-base Current Function Model and the Calculation of its Parameters
Considerable amount of research has been done on the modeling of the lightning channel-base current function. To date, there are several functions that can represent the lightning channel-base current. The reason for having an adequate channel-base current function is to yield simultaneously a good approximation to the observed shape of the current at the base of the return stroke channel and to determine lightning current waveform parameters such as the peak, maximum steepness, risetime to peak, charge transfer, etc [14].

The most frequently used lightning current functions to represent lightning channel-base current are: 1. The double exponential function

2. Heidler function
3. Pulse function

3.1

Lightning Channel-base Current Functions
3.1.1 The Double Exponential Function

The most frequently used current function is described as the double exponential function, and is given as [14]:

for t > 0

(3.1)

16

Where 10 is the maximum value of the current, 77 is the correction factor of the current peak, Tj and T2 are the time constants that determine current rise and current decay times as well as the maximum current steepness. This function well describes the lightning current but fails to properly describe the radiated lightning electromagnetic pulse (LEMP) [14]. This is due to the fact that this function has a discontinuity of the first derivative at the time onset t
=

O.

3.1.2

Heidler Function

Heidler function is a simulation of a lightning current stroke signal and is given by [15]:

Where,
101 , 2 = maximum value of the current (current peak)
0.

= correction factor of the current peak

'I and '3 are the time constants determining the current rise while '2 and '4 are current decay time
k determines the maximum steepness of the current.

Heidler function is relatively a new function as compared to the exponential function and has become very popular in lightning studies. The reason for its popularity is that it overcomes the shortcoming of double exponential function, that is, its derivative is continuous. It satisfies the continuity of the first current derivative at time onset t steepness factor k > 1 [14].

= 0 for the minimum value of the current

The waveform of Heidler function is presented in Figure 3.1 when plotted using the following typical values of the parameters:

0.

= 0.90
k=4

'] = '3 = 0.23
'2= 5 f..ls

f..ls

'4= 5 ms

17

Heidler Current

10

8

t S

6

4

2

0

-2 -10

-5

o

5

10

15
Time [j..ls]

20

25

30

35

40

Figure 3.1: Heidler function waveform.

The Heidler derivative is obtained by differentiating the Heidler current function, and is given as:

di(t)

Tt=

2:

I [

(k / 'r )(e-tITZ ) 1+ 2(tI'rl) + (tl'rlt+l] [(tI'r1r k+

for t > 0

(3.3)

The waveform of Heidler derivative function is shown in Figure 3.2.
Heidler Current Derivative
50

40

I
~

t

30

20

10

0 -10 -5

o

5

10

20

25

30

35

40

Figure 3.2: Heidler derivative function.

18

Since Heidler function describes the lightning current signal well, it is used in this project to carry out all the analysis. In order to study and evaluate the techniques to de-noise the lightning signal captured at the CN Tower, Heidler derivative function is used to model the lightning current derivative signal. This Heidler derivative function is then corrupted by adding to it a typical noise signal recorded by the CN Tower current measurement system and several de-noising techniques are applied on the corrupted Heidler derivative model. This process is explained in detail in the later chapters.

3.1.3

Pulse Function

The Pulse function is a new function to represent the lightning return-stroke current that is especially formulated to qualify for LEMP studies [16]. The pulse function is mathematically defined as [16]:

i(t) = 10 [1- e- tlr1

a

r e-

tlr2

for t> 0

(3.4)

Where,

10 is the current peak
a is the current peak correction factor and is given as a

= [n1' 2 1(1'] + n1' 2)f [1'] 1(1'] + n1' 2 ))'llr,

n is the steepness factor
1'1 1'2

is the current rise time constant and is the current decay time constant.

3.2

Calculation of the Lightning Current Parameters

Calculation of the parameters is of great importance in lightning study and from engineering point of view, it is desired to have a very fast and easy way of calculating the current parameters. It is often required to solve a set of four or five differential equations to simultaneously calculate all the current parameters [14]. These parameters are namely the risetime and decay time constants, current steepness factor and the current peak correction factor [14].

19

Heidler function can be used to investigate the lightning quantities by changing its parameters independently instead of the need to solve four to five differential equations simultaneously. Due to this feature of Heidler function, the calculation of parameters in this project is based on the Heidler current model.

The current function given by equation (3.5) is very frequently used in lightning research, e.g. it is proposed by CIGRE, Working Group 33.01 [17]. In several standards as in IEC 61312-1 [18], the lightning currents are based on this function. Therefore, for simplicity, Heidler function shown in equation (3.5) is considered to calculate the current parameters. This simpler version of the Heidler function is given by equation 3.5 [14]:

for t > 0

(3.5)

The numerical differentiation of equation (3.5) gives Heidler derivative function, which is given as:

Where,

1]

is the peak correction factor

k is the steepness factor
r 1 is the current rise time constant and

r 2 is the current decay time constant.

In [14], F. Heidler and his colleagues proposed a graphical method to calculate the lightning
parameters efficiently. The calculation of the parameters is based on the simpler version of the Heidler function described in equation (3.5).

20

!'

The correction factor of the current peak 17 is found in [14], [19] by evaluating the derivative of Heidler function given in equation (3.6) at the time when current attains the peak value and by letting it equal to zero. The time when the current attains its peak value is simultaneously equal to the risetime of the channel-base current, and is derived as:

T' p

== ,.",. 1(k T' 2 / T'1 )1I(k+1)

(3.7)

The correction factor is thus found to be:

1]

(3.8)

For large values of the current steepness factor k» 1, and ('2/

'1»> 1, the correction factors

converges to 1 [14], [19]. To illustrate this, equation (3.8) was plotted as a function of'2 / '1' while keeping k as a parameter. This was done using MA TLAB and the result is given in Figure 3.3. The relative error of the correction factor becomes very small (around 1%) when the values of the steepness factor k> 4 and the quotient ( '2 /

'1 )> 10.

21

0.9

------------,--------,----- --- --

--f+i-~-------, ~ ,,~:,~:~~;:;~(~:tn--------------~-------~-----~----;---;)--;: :~': ~/~ : : : : : : :::: : : :
/,/:

::""'r./
:!0~
, ,

:

:

: '

y'/.,,// ..

0.8

------------.--------,----- --- -7/

/'~: ~/---/-----;-------+-----r---+--1--+-H-;-------------+------+---1----;---[--H-·
'

//:

~"''''::

:

//:

: : : : ::::::::::
, , , , ,

:

:

:

:

:

: :

:::
,,"

: : : :

: : : :: ::::::
, , ,

:

:

:

I
-

I"

0.7

----------k;ii--l\=rr
I

i

k=1~

-~%~ - ,- '7"r--~-j-i--------------r--------r-----r---i---j--i--i--r-j--------------~-------i-----j----j---H--r-:

//,/ , : )/: : ?'1, y,{ i i i

I'

" , '

i i : : : : :: iii:: i : :

:::: : : iii i : i :

------------ i ---- i':
k=7 :

:,,&14 : /i iii i i i i i i iii i i i i i i iii v/v/,(, /,: ':: :::: : : : : : :::: : : : : tJ % : : ~=~:: :::: : : : : : :::: : : : : ---i-- ~=5(i-j-i--------------[-------"i-----i---j---j---(i--i-[--------------i-------:-----:----:---:--j--:-i

c ~ 0.5
~

ilt<i
----------- r, :

:

~/ ,

-;
:

:

ko4:

:

: : :

: : : :

:

: : :

::::

:

:

: :

()

[%;~
!
I

tf-'\--kiLr--l---r--r-j-j--------------j--------r-----:---- --j---:--j--j-j------- -----r-------j-----j----j ---j--j--j-l
:
:

i i i iii i i i i i i iii
:
:

i i i iii i i
:
:

k=2:

:
:

: : : :
: : : :

: : : :
: : : :

:
:

: : :
: : :

::::
: : : :

: : :
: : :

0.4

I i , i i i iii i i i i , iii i ii i i i iii i ---i- ----- -- ---- - -- --i - --:- -- --i - --:- -------- --- --r--------:----i - - - - - - - - - - -- - -:- - - - - - - --: - - - - - i - - - - i --- -- -- r--:
~ ~
I

~

~
I

-r - - - -:- - -

~

- - -:- --:- I

~

-

~
I

~

I

,

I

I

I

,

I

"

'"

,

,

I

I

I

I

I

I

I

'!r""i'i.l-~u'ILI'I'iii
Figure 3.3: Current peak correction factor 1]
VS. T 2 / Tl ·

The calculation of the lightning parameters is made by using three dimensionless variables given as [14]:
~

= (Tp / Io)(di / dt)max
1; =Qo1] /(JoT2)
~

(3.9)
(3_10)

= Qo /(JoTp)

(3.11)

Where,

Qois the charge transfer in coulombs which is obtained by the integration of i(t).

(di / dt)max is the maximum current steepness and is derived as [14]:

(3_12)

22

where, (3.13)

The equation (3.12) reduces to (di/ dt)max = (10 I 7J)[k 1(4'1)] when k»
k»I,J;~1.

1, because when

Equations (3.9)-(3.11) are used to plot the dimensionless variables ~, ~ and the quotient

1'; as functions of

'2 1'1 and the current steepness factor k. These graphs are then used for the fast
eN Tower lightning current signal

calculations of the lightning current parameters.

Parameters of the

One of the objectives of this project is to calculate the lightning current parameters. The four quantities that are usually readily available to be measured are: current peak, maximum of the current steepness (di I dt) max' risetime to peak r p , and the charge transfer Qo .

To serve this purpose of the project, the values of lightning current quantities mentioned above are extracted from a typical lightning current derivative signal measured at the eN Tower on July 3, 1999 at 17:31 :36. The lightning current derivative waveform and its corresponding current waveform obtained by numerical integration are shown in Figure 3.4. The waveform parameters ofthis lightning current signal are presented in Table 3.1.

Table 3.1: Waveform Parameters of a typical eN Tower lightning current signal [File: G0363096.788]

ImaJkA]
7.028

(dio I dt)maJkAl ,us]
23.87

r p[,us]
0.67

Qo[mC]
42

23

Jul 03/1999,17:31:36,8 out of8 stroke(s), Channel A, G0363096.788

W

30~------~------~--------~------~------~--------,

~
Q)

::1.

20 10
O~~~~~~~~~

:§: ~
.t::

>
Q)

"0

C
~

'-'

~ -10~------~------~--------~------~------~------~

-20

-10

0

10 Time [~s]

20

30

40

8,-------,-------,--------,-------,--------,-------,

6

-.a

~
~
t::
:::J

4
2
Ol---_...----~

-

U

____.-

~L-------~-------L------~------~--------L-----~

-20

-10

o

10 Time [~s]

20

30

40

Figure 3.4: Lightning current derivative (a) and its corresponding current waveform (b).

The three dimensionless variables ~ ,1; and

1';

as functions of the quotient

"2 /"1 and the current

steepness factor k are plotted using MATLAB.

Using the data from table 3.1,

~

is found to be equal to 2.785, and 1'; equal to 7.46.

From Figure 3.5 the steepness factor k is found to be 4, from Figure 3.7 "2/"1 (at k = 4 and 1';=7.46) is found to be 14.34, and 17 is found to be 0.855 from Figure 3.3.

From Figure 3.6,

1; is found to be 0.869 and thus by using equation (3.10)

"2 is found to be 6.02

I-lS and

"1 to be 0.421-ls . These results are presented in Table 3.2.

24

[
" , ,

- - -- ~\\,- - ~\,- k; b~:- - -\~<

-- -----------j--- ----j-----i----:----( --1- --:---------- -------- " , , , , ,

~----

--------\------- -1------i-----:- ---: ---t---tI I , , I I I

"
"

I
I

I
,
~

,
I

I I _____ II ____ ,·____ I1 , _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ -1 " _ _ _ _ _ _ _ _ _ _ _ _I - - - - -1_____ ... ___ , __ ....

I

, ,
I "

,

I

,

I

,

,

"

"
"
I

I,
"
I I I ,

"

,

I

,

,

,

,

I

., - - - - -,... - - - -,- - - -,- - -

I

,

I

,

1
~

- -.,- - - - - - - - - - - - - - - - - - - -., - - - - - - -

,

"

- - - -,- - - - - - - -., - - - - - - r - - - - -,- - - -., - - -

"

"

, T - - -

r-

> .: ··.\\.···

-- _'"0.,_ ------ --- ---- --- r-- -'·>:,-""'::k~,~- -- ---·~·::-r~··--"~~-~~:-.~. -~.-i,~.~.
: ' __ ,

:::~~t:,~l$?lil±~~=~;==~~~j:;'J=frt r
_2'~_~

k=4 _

3.5

.t- ---------------~_ ~_ ~.j_~,.~._~r~_ :":;~~__ :;~::-=-~. ~"~ -~ :, __ L __ ~ "':~L:): __________________ :; ___________ i_ __ _ ~~~~, __ ~
7..

.. - - - -

~

- ---

-:---'-:';:''''~'~''''::'F - -~7
I I ,/ I

"~~~."

I

:

I

:

:

:

:

_.. _.:"

f-,---~~--:.-~-=-~-+-..;........:.---:-'...;...'
2.5

-------+-~--;.-=-=.:i.::=i:_:_:_:.::f::.:::.±-.+~~"":-.::1·-~-~~---------i--------i------f------,-, --:-, ,
,

__~~-t-~-~-L_~ _ ;___________ ~.~4t+~-:~~::J~!f~~~::=,........ .. :
:~

';A~

Figure 3.5: Dimensionless function ~ as a function of the quotient factor k is used as a parameter.

'2 /'\ .Here, current steepness

, ,

, ,
I I I I I I I I I

0.9

I

I

----~------------

_L __________ J

-----~-f------~----~----~---i---~--{---I I

0.8

---

0.7

- - - - - - - - - - - - - - - - - - - ~ - - - - - - - k;c1-1; --

~

0.6

----------

0.5

-------

0.4

Figure 3.6: Dimensionless function

1';

as a function of quotient '2/ '\. The current steepness factor

k is used as a parameter.

25

10

2L-________

~

____

~

___ L_ _

~_L~~_L~

_ _ _ _ _ _ _ _ _ L_ _ _ _

~

__

~

__

_L~

__

~~~

1~

1~
tit1

1~

Figure 3.7: The dimensionless function 1; as a function of the quotient factor k is used as a parameter.

'2 /'I' The current steepness

The results obtained from the above analysis are presented in Table 3.2.

Table 3.2: Calculated values of the lightning current parameters

fJkA]
7.0284

7J
0.855

k
4

'I [,us ]
0.42

,J,us]
5.92

The calculated vales of the lightning current parameters obtained from this graphical method are not 100% accurate, but gives a good approximate of the actual lightning waveforms. The waveform of Heidler derivative function and its corresponding current waveforms obtained by using the values given in Table 3.2 are shown in Figure 3.8.

26

Heidler Current Derivati-.e

......, 30 (f)
~
~

«

~

'-'" ·c
Q)

,....... ro ro >
0

> :;:;

Q)

20 10 0 ---20 -10 0 10
lime [Ils] Heidler Current

+-'

s:::::

~

u

::J

20

30

40

8
6
~
~
~

,....... +-'

.0

-Q)

s:::::

4 2 0
I I I

''-

U

::J

-20

-10

0

10
lime [Ils]

20

30

40

Figure 3.8: Heidler derivative function (a) and its integration (b) waveforms corresponding to the parameter values shown in Table 3.2.

27

Chapter 4

Analysis of Non-Stationary Signals
Non-stationary signals are divided into continuous and transient types. Examples of nonstationary continuous signals are the vibration produced by a jackhammer and the sound of a fireworks display. Transient signals are defined as signals which start and end at zero level and last a finite amount oftime (short or long). An example of transient signals is the signal of a hammer blow and in particular, the lightning current signal measured at the eN Tower.

4.1

Continuous Time Fourier Transform (CTFT)

The Fourier Transform is used to transform a continuous time function into a continuous spectrum of its frequency components, and the inverse transform synthesizes a function from its spectrum of frequency components. The Fourier transform is defined for signals which are continuous in time, and finite or infinite in duration. A signal is a continuous-valued signal if it takes on all possible values on a finite or an infinite range. If a signal takes on values from a finite set of possible values, it is said to be a discrete-valued signal. When time is discrete, the frequency axis is finite, and vice versa [20]. The Fourier transform of a continuous-time signal x(t) is defined as [20]:

X(f) = (x(t)e- J27rft dt

(4.l)

The inverse Fourier Transform is defined as:

x(t) =

(X (f)e

j27r /t

df

(4.2)

In order to digitally process a signal of the continuous time nature, it is necessary to convert it into a digital form because digital computers cannot deal with analog continuous functions. A

28

discrete-time signal which has a set of discrete values is called a digital signal. A continuous time signal is turned into a discrete time signal by sampling it in discrete time and by analog to digital conversion (AID).

4.1.1

Sampling and Aliasing

To convert a signal from continuous !ime to discrete time, a process called sampling is used. The value ofthe signal is measured at certain intervals in time. Each measurement is referred to as a sample.

When the continuous analog signal is sampled at a frequency Fs=lITs, the resulting discrete signal has more frequency components than does the analog signal. To be precise, the frequency components of the analog signal are repeated at the sampling rate. That is, in the discrete frequency response these are seen at their original position, and are also seen centered around +/Fs, and around +/- 2Fs, etc. Figure 4.1 illustrates the continuous time signal and its corresponding sampled signal [20].

IJ1GITAl ANALYSIS Of

SiGNAL

Figure 4.1: Continuous time signal and its corresponding sampled signal.

Unfortunately, sampling can introduce aliasing, a nonlinear process which shifts frequencies. Aliasing is the transformation of high frequency information into false low frequencies that were not present in the original signal. Aliasing is an inevitable result of both sampling and sample rate conversIOn.

29

The Nyquist Theorem

The Nyquist sampling theorem defines a minimum sampling frequency to completely represent a continuous signal with a discrete one. If the Nyquist condition is met, the whole information content of the signal is preserved despite the sampling. If it is not met, then the discrete time signal obtained by sampling is a distorted version of the original one. Such a distortion is called aliasing [20].

Nyquist theorem states that the sampling frequency should be at least twice the highest frequency in the continuous baseband signal so that the samples can be used to exactly reconstruct the continuous signal. Aliasing occurs because signal frequencies can overlap if the sampling frequency is too low.

Aliasing is irreversible. There is no way to examine the samples and determine which content to ignore because it came from aliased high frequencies. Therefore to avoid aliasing, the sampling frequency must meet the criteria of the Nyquist theorem.

The highest frequency components of a signal are sometimes simply noise, or do not contain useful information. To prevent aliasing of these frequencies, these components must be filtered out before sampling. This process of filtering out of high frequency components and letting lower frequency components through, this is known as low-pass filtering.

4.2

Discrete Time Fourier Transform (DTFT) and Fast Fourier Transform (FFT)

The Discrete Time Fourier Transform (DTFT) is the member of the Fourier transform family that operates on aperiodic, discrete signals. The DTFT relates an aperiodic, discrete signal, with a periodic, continuous frequency spectrum. Since the DTFT involves infinite summations and integrals, it cannot be calculated with a digital computer. Its main use is in theoretical problems as an alternative to the DFT. It is defined by [21]:

30

X(e jW ) =

L x(n)e- jwn
n=-oo

00

(4.3)

And its inverse is defined as:

x(n)

= _1_ [
2n
7r

X(ejW)ejwndm

(4.4)

The Discrete Fourier Transform (DFT) is one of the most important tools in digital signal processing, and it serves a number of purposes [21]. First, the DFT can calculate a signal's frequency spectrum. This is a direct examination of information encoded in the frequency, phase, and amplitude of the component sinusoids. Second, the DFT can find the system's frequency response from the system's impulse response, and vice versa. This allows systems to be analyzed in the frequency domain, just as convolution allows systems to be analyzed in the time domain. Third, the DFT can be used as an intermediate step in more elaborate signal processing techniques [21]. DFT is used in the case where both the time and the frequency variables are discrete and finite in length. The digital computers can only take the discrete and finite length values to perform the analysis. The simplest relation between the finite length sequence x( n) , defined for

oS n S N -I , and its DTFT X (elm) is obtained by uniformly sampling
between O:s::
(0

X (elm) on the

OJ -axis

:s:: 2;r at

(Ok

= 2;r k / N , where

0Sk

s N -I . Therefore from equation (4.4), the

DFT of x(n) becomes [20]:

N-I jW X(k) = X(e ) Iw=27rkIN= Lx(n)e-j27rknIN, n=O
The inverse discrete Fourier Transform (IDFT) is given by:

OsksN-I

(4.5)

31

..

x(n)

=-.!. ~X(k)d2n!nl
Nk=o

N

'

O~n~N-l

(4.6)

The above two equations can be rewritten using the most commonly used notation WN Therefore equation (4.5) and (4.6) becomes:

= e- J2 1!IN.

N-l

X(k) = Lx(n) WN kn ,
n=O

O~k~N-l

(4.7)

and
(4.8)

Fast Fourier Transform (FFT)
In practice for a large series it can take considerable time to compute, the time taken being proportional to the square of the number on points in the series. A much faster algorithm has been developed by Cooley and Tukey in 1965 called the FFT (Fast Fourier Transform) [22]. The Fast Fourier Transform (FFT) is an efficient implementation of the Discrete Fourier Transform (DFT). It is incredibly more efficient, often reducing the computation time by a number of hundred computations. When N is a power of2, the computational complexity drops from O(N2) (for the DFT) down to O(Nlog2 N) for the FFT, where 1~g2 N denotes the logarithm-base-2 ofN [22].

Approximation of Continuous Time Transforms with the DFT

The DFT is generally used to approximate the Fourier Transform of a continuous time process, and it is necessary to understand some of the limitations inherent in this approach. The errors between the computed and the desired transform are due to three phenomena known as: aliasing, leakage and picket-fence effect [22], [23].

32

Leakage

This problem arises because of the practical requirement that we must limit observation of the signal to a finite interval. The process of terminating the signal after a finite number of terms is equivalent to multiplying the signal by a window function. The net effect is a distortion of the spectrum. There is a spreading or leakage of the spectral components away from the correct frequency, resulting in an undesirable modification of the total spectrum [23]. The leakage effect cannot always be isolated from the aliasing effect because leakage may also lead to aliasing. Since leakage results in a spreading of the spectrum, the upper frequency may move beyond the Nyquist frequency and result in aliasing. The best approach to ease the leakage effect is to choose a suitable window function that minimizes the spectrum spreading [23].
Picket-Fence Effect

The DFT spectrum is a discrete spectrum, containing information only at the specific frequencies that are decided upon by setting the DFT analyzer analysis parameters. The true spectrum of the signal being analyzed may have peaks at frequencies between the lines of the DFT spectrum, and the peaks in the DFT spectrum will not be at exactly the correct frequencies. This is called Resolution Bias Error, or the Picket Fence Effect. The name arises because looking at DFT spectrum is something like looking at a mountain range through a picket fence [23].

One procedure for reducing the picket-fence effect is to vary the number of points in a time period by adding zeros at the end of the original record, while maintaining the original record intact. This process artificially changes the period, which in turn changes the locations of the spectral lines without altering the continuous form of the original spectrum. In this manner, spectral components originally hidden from view can be shifted to points where they can be observed [23].

33

4.3

Short Time Fourier Transform (STFT)
4.3.1 Basis of Short Time Fourier Transform

One ofthe shortcomings ofthe Fourier Transform is that it does not give any information on the time at which a frequency component occurs. This is not a problem for "stationary" signals but does leave room for improvement when non-stationary signals are involved. One approach which can give information on the time resolution ofthe spectrum is the short time Fourier Transform (STFT) [24], [25]. The STFT represents a sort of compromise between the time- and frequency-based views of a signal. It provides some information about both when and at what frequencies a signal event occurs. The STFT formulation represents sequences of any length Mby breaking them into shorter overlapping blocks or frames of N samples, and it is assumed that the signal frequency composition is time-invariant within the duration of each block, but it may vary across the blocks [24].

Each frame is windowed prior to discrete Fourier transformation on each block, to reduce the spectral leakage due to the effects of discontinuities at the edges of the block. The length of each window M should be less than or equal to the length N of the DFT, i-e, M
~

N . The resulting

sequences of length M each can now be represented completely by length N DFTs. The windowed frame of data can be represented by [26]:

Xm(n) - x(n)w(n-mS)
Where, m is the frame number and S is the frame spacing or frame-skip number of samples advanced between the frames [26].

(4.9)

Figure 4.2 shows the windowing operation that chops the signal into short frames.

34

o

100

200

300

400

500

800

700

800

gOO

1000

w[n-mS]

0.5

0

0

100

200

300

400

500

800

700

800

gOO

1000

x[n]'w[n-mS]
0.05 0 -0.05 0

100

200

300

400

500

800

700

800

gOO

1000

Figure 4.2: The windowing operation for a given frame [26].

The fixed-time-origin sequence is defined as [26]:

Xm(n)
where,

=x(n + mS)w(n)
forn~O,n~M.

(4.10)

w(n)=O

Equation (4.10) is illustrated in Figure 4.3, and Figure 4.4 illustrates the spectral-time representation of a signal with a gap of missing samples. The reason for including missing samples between the blocks is to fill in the signal gap such that, at the beginning and at the end of the gap, the continuity of both the magnitude and the phase of each frequency component of the signal is maintained [24].

35

~

Block length ....... · Block ...... overlap

Figure 4.3: Illustration of segmentation of a signal (with a missing gap or frame skip) for spectraltime representation [24].

~~
,§l-fl';"

IV
1
I

I

I

I

V
I 1/

~'l.;O:;

l LV t / I I Y Y 1 7 1 ~~~ II 1 II II I Y Y I/ V I I Y .j I Y Y I JI Y Y ! I 1 ~ ! ! I I
I

II
I

l

I 1

J,
,/

V

V

~

~'l.J'

V
I

,V

c,,1:tr

7
I

I
/
I

I

~~

I,V III J LI lLV 7 I I I
IV

I

V

J

V

J

I

V

I IV
I

II

sf

:;:;:.

I

I

I

IY

Time (Blocks)
Figure 4.4: Spectral-time representation of a signal with a missing gap [24].

The STFT of x( n) is basically the DFT ofthe sequence [26]:
N-l

xm (n) , and is mathematically defined as

Xm(k)

= LXm(n)e-iwkn
n=O
36

(4.11 )

Where k is the frequency index and m is the frame index. From equation (4.11) it can be seen that the STFT expresses a signal x(n) as a series ofDFTs of windowed frames ofx(n) . Now in the frequency domain, each block of the signal is processed, for example in this project, the eN Tower lightning current derivative signal is de-noised using the techniques mentioned later in this project. After the processing of the signal blocks, the signal has to be reconstructed back to continuous time domain. In order to fully reconstruct the signal, a condition called "Overlap Add (OLA)" must be met. The OLA condition is defined as [12]:
00

L
m=-oo

w(n-mS)=l

(4.12)

If the OLA condition is met, then [12]:

x(n) = x(n)

L
m=-oo

00

w(n-mS) =

L
m=-oo

00

xm(n-mS)

(4.13)

The STFT process for a noisy signal is illustrated in Figure 4.5 and Figure 4.6 is a graphical illustration of the signal reconstruction using overlap and add method.

Noisy signal

Window Frequency Domain Modification Overlap and Add

Modified signal

Figure 4.5: The overlap and add method.

37

-0.05

":[
0

?Mf!flnl:~ln_SI

:
100 200 300 400

:
500

OJ
SOO
'00

aoo

gOO

1000

-0.05

'~[
0 100 200

~s:
300 400 500

SOO

:

:
'00

aoo
,

:

gOO

:

OJ
1000

-0.05

":[
0 100

'ln~
:
200
: 300

400

500

SOO

:
'00

aoo

gOO

:

OJ
1000

-0.05

":[
0

:
100

?M~I
200 300 400 500

:
'00

SOO

aoo

gOO

:

1000

J

Figure 4.6: The overlap and add procedure showing the sum of three overlapping frames.

4.3.2

Window Selection

The window selection plays a vital role in the STFT analysis of non-stationary signals. Therefore it is important to carefully choose the length and shape of the window.

A decrease in the window length increases the time resolution property of the STFT while, on the other hand, the frequency resolution property of the STFT increases with the increase in the window length. Therefore, a shorter window provides a wideband spectrogram, whereas a longer window results in a narrowband spectrogram [12], [24].

The parameters characterizing the DTFT of a window are the main lobe width relative side lobe amplitude As1 ' The parameter
/).ML

/).ML

and the

determines the ability of the window to
Asl

resolve the signal components in the vicinity of each other and

controls the degree of leakage

of one component into a nearby signal component. Therefore, in order to obtain a reasonably

38

good estimate of the frequency spectrum of a time-varying signal, the window should be chosen to have a very small As, with a length chosen based on the acceptable accuracy of the frequency and time resolutions [24]. The reason for choosing narrow main lobe and very low amplitude side lobes is to avoid the "smearing" or "spreading" of the spectrum which eventually reduces the frequency resolution. Another point to be noted when choosing the window is that the shape and length of the window must satisfy the OLA condition.

The windows with the best frequency selectivity that do not satisfy the OLA condition are Hamming and Kaiser window, and the three most common windows that meet the OLA conditions are the rectangular window, the triangular window and the Hanning window [24]. However, the rectangular window has an additional undesirable property: large side lobes, which distort the DFT by adding harmonic noise. In other words, although the sinusoid is at a particular frequency, some additional components are measured at other frequencies. The solution to this problem comes in a trade-off: more smearing (wider window DFT) but much smaller side lobes. This trade-off is achieved by using weighted windows, such as Hanning or Hamming, windows. Also, to avoid smearing and leakage effect, the signal is zero-padded. Zero padding consists of extending a signal (or its spectrum) with zeros to extend its time (or frequency band) limits. It maps a length N signal to a length M> N signal. Table 4.1 lists the properties of various window functions [20].

Table 4.1: Properties ofthe different window functions [20]

Window Name

wen)
O~n~N-I

Main lobe width
L1ML

Relative side lobe level As,

Rectangular

1

-

47Z" N

-13 dB

Hanning

~ [1-00'( ~~I)]
27Z"n O.S4-0.46cos ( -) N-I

-

87Z" N 87Z" N

-32 dB

Hamming

-

-43 dB

39

Considering the requirements of the side lobe and the main lobe width, Hanning window is found to be the best choice for analyzing the CN Tower lightning current derivative signal.

4.3.3

Choice of FFT Length
~

The size of the FFT should be greater or equal to the size of the window, that is, N

M , with

additional samples being produced via zero-padding. To take advantage of the computational efficiency of the FFT algorithm, it is recommended that N to be taken as a power of 2, such as 256,512,1024,2048 etc.

4.3.4

Number of Overlapping Points

The number of overlapping points is application dependent. If the signal is a transient signal such as the lightning current derivative signal, then the overlapping points are required because the overlapped portion contains the transients for better results. Usually the length of overlapped points is half of the window length that is Ml2.

40

Chapter 5

Noise Reduction Techniques - A Literature Review
As mentioned earlier in this project that, in order to analyze and extract information from the lightning current signals captured at the

eN Tower, it is necessary to filter out all different types

of noise affecting that signal. A considerable amount of research has been done in the area of noise reduction, especially in acoustics (speech, sound processing).

Over the years, researchers and engineers have developed a number of methods to address the problem of noise reduction. Yet, due to complexities of the signals, this area of research still poses a considerable challenge. It is usually difficult to reduce the noise without distorting the signal and thus, the performance is limited by the tradeoff between signal distortion and noise reduction.

The spectral subtraction method has been one ofthe most well-known techniques for noise reduction in acoustics [27], [28]. Spectral subtraction was developed in 1979 by Boll [28] and a literature search reveals an abundance of research papers, both past and recent, that have investigated the application of spectral subtraction as well as the optimization of the algorithm itself. The spectral subtraction method basically estimates the magnitude or the power spectrum of clean signal by explicitly subtracting the noise power spectrum from the noisy signal power spectrum. Due to its minimal complexity and relative ease in implementation, it has enjoyed a great deal of attention over the past years. The majority of recent literature with a spectral subtraction theme focuses on automatic speech recognition applications.

Since the lightning current signal is a transient signal, and is therefore non-stationary, the spectral subtraction method can successfully be applied to it [12]. In this project, we propose a modified spectral subtraction method that allows better and more suppression of the noise.

41

In this chapter, the basic principle of spectral subtraction method along with other subtractivetype algorithms, their limitations and drawback are discussed in detail. The proposed spectral subtraction based algorithm, which overcomes the drawbacks of the conventional spectral subtraction, is discussed in detail in the following chapter.

5.1

Spectral Subtraction

5.1.1

Conventional Spectral Subtraction

As an overview, this method is based on Short Term Fourier Transform (STFT), and works by converting the signal into successive short segments using a window function. These segments are then converted into the frequency domain by the use of Fast Fourier Transform (FFT), where the noise is removed by adjusting the discrete frequency bins on a frame by frame basis. The noise spectrum is estimated from the periods when the lightning signal is absent and only the noise is present. The number of frames taken into consideration (noise-only-frames) depends on the stationarity of the noise. The spectral subtraction method is based on an assumption that the background noise (additive noise) is stationary [28]. After the modification process, the signal is reconstructed using Inverse Fourier Transform (IFFT) and overlap-and-add (OLA) method as explained in Chapter 4.

To explain the spectral subtraction process, we assume that y( n) , the discrete noise corrupted input signal, is composed of the clean signal sen) and the uncorrelated additive noise den) . The noisy signal can then be represented as [28], [29]:

yen) = sen) + den)
This assumption is based on the fact that sen) is a stationary signal, but the signal is nonstationary in reality. As explained earlier, in order to process a non stationary signal in the

(5.1 )

frequency domain, it is important to carry out the analysis on a short-time basis (frame-by-frame). Therefore, a time-limited window is applied to the original signal, the noisy signal and the noise only signal. Thus, the windowed signal can be represented as:

42

(5.2)

(Note that the subscript Ow' is the short-time (windowed) representation of a signal throughout this project).

In the frequency domain, the equation (5.2) is given as [28]:

(5.3)

Where,

N-l

Y(e iW ) = Ly(n)e- iwn
n=O

Now, after windowing the signal and taking its Fourier transform, signal is processed and modified using spectral subtraction method. The estimated signal at a given frequency bin is given as [28]:

(5.4) where,

and

But unfortunately in reality, we do not know the correct phase therefore it is replaced with the phase
(}Yw

(}dw

(e l "') of the noise signal;

(e l "') of the noisy signal. The magnitude of the noise

43

signal is also replaced by its estimated average value

f.1w (e jW )

taken during the non signal activity

frames [28]. Thus, the estimated signal spectrum is given as [28]:

(5.5)
or

(5.6)
where,

(5.7)

and fiw (e jm ) = E

[I D

w

(e jm )

I] is the average of the noise taken during the non-signal activity

frames. The spectral error is then given as [28]:

(5.8)

The block diagram of the overall basic spectral subtraction is shown in Figure 5.1.

Noise estimate
L----.J

l
Spectral Subtraction

Windowing Operation

FFT

I Y(m) I

yen)
Noisy Signal

I S(m) I
IFFT & Overlap and add

A

LY(m)
Phase Information

r-------------------~

sen)
Processed Signal

Figure 5.1: Block diagram of the overall spectral subtraction system.

44

In [28], a number of modifications are proposed in order to minimize the spectral error. These modifications are:

1. Magnitude Averaging 2. Half-wave rectification

Magnitude Averaging

The error can be reduced by taking the local average of the spectral magnitude I Yw (e jW ) I[28]. That is, the error is reduced by replacing I Yw (e lW ) I by its average I Yw (e jW )

I, where,

(5.9)

and ~w (e jm )

=

ith

windowed transform of y( n) .

Using equation (5.9) in equation (5.5), we get the modified estimated signal spectrum as [28]:

(5.10)

The rationale behind averaging is that the spectral error becomes approximately [28]:

(5.11 )

where,

45

Therefore, the sample mean of I Dw(e lm ) Iwill converge to Jiw(e lm ) as the average is taken over more frames. But since the signal is non stationary, only limited time averaging is allowed.

Half-Wave Rectification

When the magnitude of the noisy signal I Yw(elm) Iis less than the average noise magnitude

Jiw (elm) , the output is negative after subtraction. These outputs are then set to zero, and this is
implemented using half-wave rectification of H w (elm) . The estimator is given as [28]:

(5.12)

where,

Therefore, the purpose of the half-wave rectification is to bias down the magnitude spectrum at each frequency bin by the noise bias determined at that frequency. The advantage of half-wave rectification is that the noise floor is reduced to Jiw (elm) , when the sum of the noise plus the signal at a frequency bin is less than Jiw (elm) [28].

5.1.2

Power Spectral Subtraction

Power spectral subtraction is the same as the magnitude spectral subtraction except that the power spectrum of a noisy signal is taken into consideration instead of the magnitude spectrum. The subtraction process can be in power terms or in magnitude terms. Both forms of magnitude subtraction occur frequently in the literature and perhaps for practical reasons little or no reference is made to the phase. Power spectral subtraction is adopted here as it is more common in the literature and since experimental evidence suggests there is little difference between the two [30].

46

The instantaneous power spectrum of the noisy signal is obtained by squaring both sides of equation (5.3) can be approximated as [31]:

1Yw(e jOJ ) 12 = 1Sw (e jOJ ) 12

+ 1Dw (e jOJ ) 12 +Sw (e jOJ ). Dw * (e jOJ ) + Sw * (e jOJ ). Dw (e jOJ )
(5.13)

where, Dw*Cej{J)) and Sw*Cej{J)) represent the complex conjugates of DwCej{J)) and SwCej{J)) , respectively.

The terms 1DwCej{J)) 12 , SwCej{J)).Dw*Cej{J)) and Sw*Cej{J)).DwCej{J)) can not be obtained directly and are approximated asE[I DwCej{J)) 12 ] ,

E[ SwCej{J)).Dw*Cej{J)) ] andE[ Sw* Cej{J)).DwCej{J)) J,
E[ SwCej{J)).Dw*Cej{J)) ]
and

where E[.] denotes the expectation operator [31]. Since the noise d C n) is assumed to have zero mean and is assumed to be uncorrelated withsCn) , the terms

E[ Sw*Cej{J)).DwCej{J)) ] reduce to zero.
Therefore equation (5.13) can be written as [29], [31]:

From above, the estimated short-time power spectrum of the clean signal is then given as [29]:

1Sw(e iOJ ) 12 = 1Yw(e iOJ ) 12
or

-E[I Dw(e iOJ ) 12]
(5.15)

1Sw{e jOJ ) 12 = 1Yw{e jOJ ) 12

-I Dw{e jOJ ) 12

Therefore, in general, the estimated clean signal is given as:

47

(5.16)

where exponent a is equal to 1 for magnitude subtraction and 2 for power subtraction.

5.1.3

Limitations of Spectral Subtraction

Estimating the noise itself limits the accuracy of performance, but the main problem with the spectral subtraction method is the processing distortions caused by random variations of the noise spectrum. In [24], three sources have been attributed to the distortion of the instantaneous estimate of the magnitude:

1. the finite variance of the instantaneous noise spectrum (which leads to residual noise)

2. the cross-product terms 3. the non-linear mapping for the spectral estimates that fall below a threshold (half-wave rectification), since the magnitude cannot be negative for instances where noise has been overestimated.

Irrespective of the methods used for estimating the noise statistics, the true short-time-spectrum of the noise for a specific segment being processed will always have a finite variance, and thus the noise estimate will always be over or under the estimate of the true noise level. Therefore, the spectral subtraction may result in some randomly located negative values for the estimated clean signal magnitude when the noisy signal level is near the level of the estimated noise spectrum. This results in the estimated magnitude spectrum to consist of a succession of randomly spaced spectral peaks, which leads to disturbing residual noise.

Most of the recent and past decade research has been focused on ways to combat the problem of residual noise. Some of the methods that minimize the effect of the residual noise and the spectral error are discussed in the next section.

48

5.2

Modifications to Spectral Subtraction

Over the past years, a tremendous amount of research has been focused on improving the performance of spectral subtraction based enhancement methods. Regardless of its evident limitations and drawbacks, it is still a conceptually simple technique with relatively low cost implementations. Some of these modified spectral subtraction methods are described briefly in the next sections.

5.2.1

Spectral Subtraction using Over-Subtraction and Spectral Floor

This modification was proposed by M. Berouti in [27] in order to reduce the effect ofthe residual or musical noise. The residual noise spectrum, as explained earlier, consists of peaks and valleys of random occurrences. This method subtracts an overestimate of the noise power spectrum, and prevents the resultant spectral components from going below a preset minimum level (spectral floor). The method can automatically adapt to a wide range of signal to noise ratios (SNRs) as long as a reasonable estimate of the noise spectrum can be obtained [27].

The estimate of the clean signal power spectrum is given as [27]:

~
1

.

2
1

{I ~(ejlll)
=

1.2 -

a{SNR} 1Dw(eilll ) 12
(5.17)
else

Sw(e1ll1 )

PI Dw(ellV ) 12

where a {SNR} is the over-subtraction factor in order to "overestimate" the noise spectrum and

Pis the spectral floor. The value of a {SNR} is a function of the estimated segmental SNR and
is given as [27]:

3 a {SNR} =ao --SNR

20

- 5dB ~ SNR

~

20dB

(5.18)

where a o is the desired value of a {SNR} at 0 dB SNR, a {SNR} ~ 1 and 0 < ~« 1.

49

rlO?E~TY OF -RYERSGiJ !JAij\;~nY Ua:1Afff'

If the value of a { SNR} is too large, it will suppress too many components that need not to be suppressed. In [27], Berouti found out that the optimal value of a o is between 3 and 6 to prevent both the residual noise and too much signal distortion. The desired value f3 (the spectral floor) is found to be in the range of 0.02 to 0.06 for high noise levels (SNR= -5 dB), and in the range of 0.005 to 0.02 for lower noise levels (SNR=O or +5 dB) [27]. -

5.2.2

Nonlinear Spectral Subtraction

Nonlinear spectral subtraction is based on the notion that the fixed subtraction parameters are unable to adapt well to the varying noise levels and characteristics. The nonlinear spectral subtraction method in [32] by Lockwood and Boudy is a modification of the method proposed by Berouti in [27]. In this method, the over subtraction factor is made frequency dependent and the

,

subtraction process is non linear. At lower SNR, larger values are subtracted while at higher SNR the subtraction is minimal. The estimated clean signal power spectrum is given as [32]:

else
(5.19)

where I Yw(eia.» respectively.

I and I Dw(eia.» Iare the smoothed estimates of noisy signal and noise,

tPw (eJa.» is a non linear function calculated for each frame and is dependent on the following
parameters [32]: (5.20)

where a( eJa.» is the frequency dependent over subtraction factor, and p( eia.» is frequency dependent signal-to-noise ratio.

50

The over subtraction factor a(e jW ) is computed for each frame i as the maximum noise spectrum estimated during noise only frames [32]:

(5.21)

p(e jW ) is computed as follows:

(5.22)

where 1 Yw(e jW )

Ip is the smoothed noisy signal spectrum [32].

5.2.3

Extended Spectral Subtraction

The Extended Spectral Subtraction method is a combination of adaptive Wiener filtering and spectral subtraction proposed by Sovaka in [33]. The Wiener filter is used to get an estimate of noise, and is given as:

(5.23)

jW ) 12 and 1Sn-l (e jW ) 12 are the smoothed estimation of the noise power spectrum where, 1D _ n 1 (e

and the clean signal power spectrum at frame n-1 respectively. The equation (5.23) is a form of an iterative Wiener filter since it is approximated at time instant n-1 and applied at the current time instant n.

The estimated noise is obtained by applying Wiener filter to the noisy signal, and is given as:

(5.24)

51

The estimated clean signal is then given as:

(5.25)

The block diagram of the overall extended spectral subtraction is given in Figure 5.2.

yen)

.

Y(ej(l)

+

FFT

L
-

sen)
IFFT

~

Wiener Filter

D(ej(l)

r
Figure 5.2: Block diagram representing the Extended Spectral Subtraction method [33].

52

Chapter 6

Proposed Spectral Subtraction Method
In this project, we propose a modified spectral subtraction approach that allows better and more noise suppression. In addition, the proposed method also attempts to find the best tradeoff between signal distortion and noise reduction. The current derivative and its corresponding current peaks are two of the most important parameters, and it is desired to design a noise reduction technique such that there is minimal reduction in the value of current derivative and its corresponding current peaks after applying the de-noising technique.

6.1

Power Spectral Subtraction with Over-Subtraction and Residual Noise Reduction

The proposed power spectral subtraction technique is based on over-subtraction and residual noise reduction. This method gives a superior performance as compared to the conventional spectral subtraction method.

6.1.1

Assumptions made throughout the Development of the Proposed Method

The noise spectrum is obtained from the measured signal in the absence of the lightning to the eN Tower. The following assumptions were made in developing the proposed algorithm:

1.

The background noise (always present at the current derivative recording digitizer) is added to the Heidler derivative function

2.

The background noise environment remains locally stationary to the degree that the expected value of spectral magnitude prior to signal activity equals its expected value during signal activity

53

6.1.2

Development of the Proposed Algorithm

In this de-noising technique, we assume that y( n) , the discrete noise corrupted input signal, is composed ofthe clean signal s( n) and the uncorrelated additive noise signal d (n) . The noisy signal can then be represented as [28], [29]:

yen) = sen) + den)

(6.1 )

This assumption is based on the fact that s( n) is a stationary signal, but the lightning signal is non-stationary in reality. As explained earlier, in order to process a non stationary signal in the frequency domain, it is important to carry out the analysis on a short-time basis (frame-by-frame). Therefore, a time-limited window is applied to the original signal, the noisy signal and the noise only signal. Thus, the windowed signal can be represented as:

(6.2)

(Note that the subscript 'w' is the short-time (windowed) representation of a signal throughout this project).

In the frequency domain, the equation (6.2) is given as:

(6.3)

Power spectral subtraction is adopted here as it is more common in the literature [30]. The instantaneous power spectrum of the noisy signal is obtained by squaring both sides of equation (5.4) (see Chapter 5) can be approximated as [31]:

where Dw*(eJro)and Sw*(e Jro ) represent the complex conjugates of Dw(eJQ)) and

Sw(e Jro ) respectively.

54

The terms 1 Dw (e lill ) 12 , Sw (elill).Dw * (e lill ) and Sw * (elill).Dw (e lill ) can not be obtained directly
2 ] , E [ Sw (e lill ).Dw * (e lill ) ] and E [ Sw * (e lill ).D (e lill ) ] ' and are approximated as E [I Dw (e lill ) 1 w

where E[.] denotes the expectation operator [31]. Since the noise den) is assumed to have a zero mean and is assumed to be uncorrelated withs(n), the terms

E[ Sw(elill).Dw·(e lill ) ]

and

E[ Sw' (elill).Dw (e lill ) ] reduce to zero.
Therefore equation (6.4) can be written as [29], [31]:

(6.5)

From above, the estimated short-time power spectrum of the clean signal is then given as [29]:

or

(6.6)

However in reality, these cross terms might not be negligible compared to the values of the power spectrum amplitudes of the signal and noise. Because of the above assumption that the cross terms are negligible compared to the other terms, spectral subtractive type algorithms do not perform as well with correlated noise. Therefore to avoid errors, we will consider these cross terms in our analysis. A cross-correlation technique for enhancing the signal corrupted with correlated noise is proposed in [3 I]. The cross terms, which represent cross correlations between

dw(n) and Sw (n) ,that isE[ Sw (elill).Dw* (e lill ) ] and

E[ Sw·(elill).Dw(e lill ) J, cannot be estimated

directly since we do not have access to the clean signal s( n) . Therefore, instead we can estimate these cross-correlations between the corrupted signal y w (n) and d w (n) , that is

E[ Yw(ejm).D w· (e Jm )] and E [Yw ' (elill).Dw(eJill)

J.
55

Therefore, by including a short-time estimate of the cross terms of yw(n) and dw(n) , the shorttime power spectrum of the clean signal is given as [31]:

~

{I YwCe
1W )

1W )

12 - a {SNR} DwCe 1W ) 12 - 81 YwCe 1W ) 1.1 DwCe 1W )

I

I
else
(6.7)

I SwCe

12=
fJ I DwCe 1W ) 12

where

a {SNR} is the over subtraction factor, f3 is the spectral floor parameter [27], and 8 is a

cross-correlation coefficient which provides an estimate of the correlation between corrupted, signal and noise in the current window frame, and is incorporated such that 0 calculated frame-by-frame as follows [31]:

~ 8 ~ 1 and is

(

8
where,
Xyd

= Xyd - fly·fld
(6.8)
(J"y.(J"d

=

(NIl 2) (NIl 2)

~I Yw(k) 1·1 Dw(k) I

J.1y J.1d

=

~I Yw(k) I

=

(Nl/2)~IDwCk)1
(N I 2) ~
1

(7'2 y (7' d

"[I Yw(k) 1-J.1yJ2

2 = (NI2)~ 1 "[ D ~ J2 I w(k)I-J.1d

for 0 ~ k ~ N 12 , where N is the FFT size.

56

Equation (6.7) reduces to equation (6.9) when the cross correlation factor 8 is set to zero.

~
ISwCe1/lJ) 12=

{1Y,., c eJ /lJ)1 2 - a{SNR} IDwCeJ/lJ) 12
(6.9)

PI DwCeJ/lJ) 12

else

The frame-by-frame value of the over subtraction factor a {SNR} depends on the segmental noisy signal-to-noise ratio SNR, and is given as [27], [34], [35]:

5

SNR <-5 - 5dB ::; SNR ::; 20dB SNR>20
(6.10)

a {SNR}

3 = a o --SNR 20
1

where the value of a 0

= 4 is the desired value of a {SNR} at 0 dB SNR. The segmental SNR is

calculated as follows [34], [35]:

N-J

II YCk) 12
SNRC dB) = 10 logJO
k=O
N-J

(6.11 )

IIDCk)1 2
k=O

6.1.3

Half Wave Rectification and Residual Noise Reduction

As discussed earlier in Chapter 5, when the noisy signal power spectrum 1Yw(e JaJ ) 12 is less than the average noise power spectrum

I Dw(ei 12 at a given frame, the output is negative after
W )

subtraction. These negative values are set to zero. This is called half wave rectification. In the absence of signal activity the difference between the actual noise power spectrum and the estimated noise power spectrum is called the noise residual [28], and for uncorrelated noise it exhibit itself in the spectrum as randomly spaced narrow bands of magnitude spikes [28]. This

57

noise residual has a magnitude between zero and a maximum value measured during non-signal activity period [28].

The residual noise reduction can be achieved by taking advantage of its frame to frame randomness. Since the noise residual will randomly fluctuate in amplitude at each analysis frame, it can be suppressed by replacing its current value, at a given frequency bin, with its minimum value chosen from the adjacent analysis frames [28], [34]:

1S;(e jOJ ) 1= min {I Sj(e jOJ ) I, j = i-I, i, i + I}
for 1 S/e jOJ ) 1 < max 1 DR (e jOJ ) 1

(6.12)

where {max 1 DR (e jOJ ) I} is the maximum value of noise residual measured during non-signal activity period. This replacement is done only if 1 S;(e jOJ ) 1 is less than the maximum noise residual calculated during non-signal activity period.

6.1.4

Other Important Enhancement Factors

Aside from the factors discussed above, we investigated several other parameters that affect the performance of the proposed spectral subtraction technique. All of these parameters interact with each other and are interrelated. These factors are:

a)

Window type

The window type (Hanning, Hamming, etc) is application dependent. In our application, the lighting current derivative (di/dt) is segmented and windowed such that in the absence of spectral modifications, if the synthesized segments are added together, the resulting overall system should satisfy the overlap and add (aLA) condition [12]. Although there are a number of useful windows with different frequency and time characteristics, however in most implementations of the spectral subtraction, a Hanning window is used [24]. It was also shown in [12] that the Hanning window satisfies the aLA condition and is the best choice for our application.

58

b)

The FFT order

The FFT size is set equal to the size of the window. In [26], it is shown that the spectral modifications followed by inverse transformation can distort the time waveform due to temporal aliasing caused by circular convolution with the time response of the modification. The aliasing effect is minimized by augmenting the input time waveform with zeros before applying the spectral modifications.

In general, enough zeros are appended at each end of the windowed data prior to obtaining the DFT, such that the total number of points is a power of2 and, thus, an FFT routine can be used [27]. Thus we needed to investigate adding more zeros and using a higher order FFT. The total length of the lightning current derivative signal is 16 kB, with 2 kB zeros added to it making its total size 8 kB (18432 sample points).

c)

The window size

The choice of the window length for spectral analysis is a compromise between the conflicting requirements of the time resolution and the spectral resolution. The frequency resolution of the spectrum is directly proportional to the number of samples, N. A larger value of N produces a better estimate of the spectrum. The conflicting requirement is that, owing to the non-stationary nature of the signal under analysis, the window length should not be too large, so that shortduration events are not obscured [24].

The CN Tower current derivative signal is recorded at a sampling rate of 100 MHz, and the total length of the signal is 16 kB. Different window and FFT sizes are analyzed and finally window and FFT size of 2048 is chosen. This choice is based on a trade-off between signal distortion and SNR. The details are presented in Chapter 7

d)

The amount of overlap between the frames (window overlap)

Associated with the frame size is the amount of overlap between consecutive frames. The overlap is necessary to prevent discontinuities at frame boundaries. The amount of overlap is usually taken to be 50% -75% of the frame size [24]. In this project, the analysis is based on a window of length 2048 with 50% overlap between frames.

59

6.2

Overview of the Proposed Method and its Implementation

The block diagram of the proposed method is presented in Figure 6.1. The main functional blocks of the whole system are:

a)

Spectral Decompositions

The noisy signal is windowed and is converted into frequency domain using FFT. In the frequency domain, the noise power spectrum is estimated by taking the average of the noise-onlyframes. Also, the power spectrum of the noisy signal and the angle of the noisy signal are obtained.

b)

Spectral Subtraction

The noise is then suppressed from the corrupted signal to get an estimate of the clean signal spectrum by applying the proposed spectral subtraction technique.

c)

Residual Noise Reduction

The estimated clean signal is further processed to reduce the affect of residual noise.

d)

Inverse Fourier Transform

The modified estimate of the clean signal spectrum is then combined with the original noisy signal phase and converted back to time domain by using IFFT.

e)

Signal reconstruction using overlap add (OLA) method

The enhanced signal is finally reconstructed using the overlap and add (OLA) method as discussed in Chapter 4.

60

Estimated noise

Signal Power Spectrum

Cross-correlation

Noise Power

Phase of the noisy signal

sen)
Figure 6.1: Block diagram representation of the overall proposed spectral subtraction.

61

Chapter 7

Results and Performance Evaluation of the Proposed Spectral Subtraction Method
In this Chapter the detailed implementation and analysis of the proposed spectral subtraction method is presented. The comparative analysis of the conventional spectral subtraction method discussed in Chapter 5 and the proposed spectral subtraction method is presented towards the end of this Chapter.

7.1

Heidler Function

In order to evaluate the proposed de-noising method, the Heidler function model was initially used to represent the lightning current waveform, given as [15]:

for t > 0

(7.1)

The derivative of the Heidler function is obtained by taking the derivative of equation (7.1) and is gIven as:

diet) _ 101 [

dt-

(klrl)(e-liT2) (tlr l )k e-11r2 ] 1+2(tlrl )+(tlrl)k+I] - r 2[1+(tlrl )k] 2a [(tIr1r k+

+ 102 [ 2a [(t 1r3

r

(k 1r3)(e-liT4) _ (t 1r3)k e- 1iT4 ] , k +1 + 2(t I rJ + (t IrJk+I] r4[1 + (t 1r3)k]

for t > 0

(7.2)

Heidler derivative function is matched to a typical lightning current derivative signal measured at the CN Tower in order to determine Heidler function parameters, which are given by [12]:

62

A

= 0.90
0.23 !lS

k=4
"2 =

"1 = 0.23 Ils
"3 =

5 Ils

"4 = 5 ms

I o1 =10kA

The derivative of Heidler function and its corresponding current waveforms obtained by using the above parameter values are shown in Figure 7.1

Heidler Current Derivati've
tJ)

~
Q)

~ 40

....... ~ co co > 20 ~'C

~

O~--------------~L~--~---------------------------1

-20

-10

o

10

20

30

40

Time [Ils]
Heidler Current

10
~
~
.0

.......

~Q)

c t:
::::I

5

()

0 -20 -10

o

10

20

30

40

Time [Ils]

Figure 7.1: Heidler derivative (a) and its corresponding current waveforms (b).

A typical noise only signal (in the absence of lightning) measured at the

eN Tower is shown in

Figure 7.2, and its frequency content is shown in Figure 7.3 and Figure 7.4.

63

Jul 02/1999, 13:19:18, 1 out of4 stroke(s), Channel A, G0247958.801
2,-----,----,------,----,-----,-----,-----,-----,-----,-----,

c ~ <3

_2L-____~____ -60 -40 -20

_ L_ _ _ _

~_ _ _ _ _ _L __ _ _ _~_ _ _ __ L_ _ _ _~_ _ _ _ _ _L __ _ _ _~_ _ _ _~

0

20

40 60 Time [J..1s1

80

100

120

140

0.4,----,-----,-----,----,-----,-----,----,-----,-----,----~

:;2

0.2

eai t:
<3

a
-0.2
-0.4 -60
L.......-_ _- - '_ _ _ _- - '_ _ _ _- - '_ _ _ _.......J._ _ _ _.......J._ _ _ _...-L_ _ _ _.-...L_ _ _ _.-...L_ _ _ _.-...L_ _ _ _---'

-40

-20

o

20

40 60 Time [J..1s1

80

100

120

140

Figure 7.2: Typical noise signal measured at the eN Tower (a), and its integration (b).

Frequency content of the noise signal

2000
1800 1600
1400 1200

1000

800 600 400 200

o

o

~ II

.1

10

~

20

30 'frequency (MHz)

40

I so

60

Figure 7.3: Frequency spectrum of the noise signal shown in Figure 7.2 (a).
Frequency content of the noise signa.l

1200,-----.------r----~------r_----,------r----~------r_----._----~

1000

800

600

400

20:

a

V
0.1

Vv\
0.2
0.3

0.4

O.s

0.6

0.7

O.B

0.9

"frequency (MHz)

Figure 7.4: Low frequency content of the noise signal shown in Figure 7.2 (a).

64

Figure 7.3 shows the full frequency spectrum of the noise signal shown in Figure 7.2 (b). The high frequency noise is substantially removed after the integration process and what remains is the low frequency noise that makes it difficult to calculate the lightning signal parameters. In Figure 7.4, the noise components in the vicinity of 100 kHz are very prominent. This noise is recently discovered to be related to the Loran-C signal [13]. Loran-C is a radionavigation system using the frequency band of 90-11 0 kHz. Although it is known that lightning is the main source of the noise in the reception of the Loran-C, it is shown in [13] that Loran-C signals are the source of a low-frequency noise corrupting the lightning current derivative measured at the CN Tower.

In this project, the derivative of Heidler function is artificially corrupted by adding to it the noise signal shown in Figure 7.2(a). The waveforms of the corrupted Heidler derivative function and its corresponding current are shown in Figure 7.5. In Figure 7.5 (b), it can be seen that the high frequency noise is minimized after the integration process while the low frequency noise still remains.

en

60~~~~~~~~~,-~~~~,-~~~-,~~~~-,~~~~

f
~

40 20

§:~

~

~ O~~~~~~~~~
-20 -10 0 10 20 30

40

Time [J..lsl
15,-------,-------~------~------_,--------~----~

~

10

~~

5

o r-----~~~_~~---~-20 -10 o

10 Time [J..lsl

20

30

40

Figure 7.5: Corrupted Heidler current derivative waveform (a) and its corresponding Heidler current waveform (b) obtained by numerical integration.

65

In [12] it is shown that better results are obtained by applying the de-noising technique to the Heidler current derivative (di/dt) model than applying it on the Heidler current model. Therefore, the proposed modified spectral subtraction technique is evaluated by applying it to the Heidler derivative signal (di/dt) and its corresponding current waveform is derived from the di/dt through time integration.

7.2

Windowing and Frequency Analysis

As discussed in Chapter 6, Hanning window is proved to give the best performance for the lightning current derivative signal. Therefore, Hanning window is used to segment the Heidler current derivative signal. Shorter windows give high time resolution and larger window gives high frequency resolution. Since the size of the window is a trade-off between the frequency and time resolution, great care is taken in order to choose the optimal size of the window. The window overlap is chosen to be 50% of the window size as discussed in Chapter 6, and the size of the window is set equal to the frame size.

The factors that are important in our study are the signal-to-noise ratio, peak, maximum steepness and rise time to peak of both current derivative signal and its corresponding current waveform obtained by integration. Therefore, an optimal window size is chosen based on all these factors. It is desired to have a high signal-to-noise ratio for both the current and current derivative waveforms, while maintaining the shape of the signal. The signal-to-noise ratio used in our application is signal peak-to-noise peak ratio in decibels (dB), and is donated as SPNPR [12]. It is defined as the signal peak to 50% of peak-to-peak noise ratio (SPNPR), where the noise is calculated before the arrival of the lightning current return stroke [12].

The SPNPR in decibels is computed as:

SPNPR [dB] = 20.l0 g 10(

peak of the signal 50% of peak - to - peak noise

J

(7.3)

The proposed modified spectral subtraction (MSS) algorithm is evaluated for different sizes of the Hanning window: 256, 512, 1024,2048 and 3072.

66

The effect of different sizes of the Hanning window on SPNPR and the shape of the Heidler current waveform as well as on its derivative waveform are presented in Table 7.1.

Table 7.1: Effect of different sizes of Hanning window on the shape and SPNPR of the de-noised Heidler derivative waveform and its corresponding current waveform

Hanning window size

Current derivative SPNPR(dB)

Shape of the denoised current derivative waveform

Current SPNPR(dB)

Shape of the de-noised current waveform

256

64.4

Follows that of the original (including the peak)

65.35

Decay does not follow that of the original (worse case)

512

59.5

Follows that of the original but the peak decreases

62.57

Decay does not follow that of the original

1024

58.65

Follows that of the original but the peak decreases

57.04

Decay does not follow that of the original

2048

58.2

Follows that of the original (best case)

55.95

Follows that of the original (best case)

3072

45.1

Shape does not follow well

49.56

Shape does not follow well

It is noticed from the above analysis that as the window size decreases, the signal-to-noise ratio of
both Heidler derivative and its corresponding current increases but at the same time the Heidler current waveform gets distorted. These results show that the window size 2048 is the best for our application.

67

7.3

Performance Evaluation of the Proposed Method

7.3.1

Performance evaluation of the proposed method on the Heidler derivative model corrupted with frequency modulated noise signal

The performance of the proposed spectral subtraction method is evaluated by applying it to the Heidler current derivative model shown in Figure 7.1 corrupted with a frequency modulated noise with carrier frequency

fc

of 100 kHz and a modulating frequency

1m of 20 kHz. The motivation

behind taking carrier frequency of 100 kHz and a modulating frequency of 20 kHz is because the most troublesome low frequency noise exists around 100 kHz. In order to evaluate the proposed method, the modulated noise given in equation (7.4) is added to the Heidler current derivative function.

Noise signal = sin(27r fct + sin(27r fmt))

(7.4)

The corrupted Heidler derivative signal and its corresponding current waveform are shown in Figure 7.6 and the frequency content of the corrupted Heidler derivative signal is shown in Figure 7.7. The de-noised Heidler derivative signal and its corresponding current waveform are shown in Figure 7.8.
Cii"

r
~
~

40

~

20

~
[

0 -20 -10

o

10 Time [IJ-s]

20

30

40

10

~~

5 0 ·20 ·1 0

o

20

30

40

Figure 7.6: Heidler function derivative corrupted with the modulated noise (a) and its corresponding Heidler function (b).

68

6000~--~--~~~~~--~----~--~----~----~----~~~----,

Freq-u.ency spectr1..1rrl. <3£ t h e cCJrr-u.ptecl :I--'[eicller cleri"",a.ti"",c s i g n a l

5000

4000

3000

2000

1DOO~
o

I
5 "10

a

15

20

25
freq-u.ency

3D
(~)

35

40

45

50

55

Figure 7.7: Frequency content of the corrupted Heidler derivative function.

en

!
~

40 20 0 -20 -10 0 10
lime [J.ts]

~~ ~

~
~

20

30

40

10

8:~

5

0 -20 -10 0 10
Time [J.ts]

20

30

40

Figure 7.8: De-noised Heidler derivative signal (a) and its corresponding current waveform (b).

From Figure 7.8 it can be clearly seen that the high frequency noise as well as the low frequency noise is substantially removed.

Figure 7.9 shows the close up view of the Heidler derivative function before and after the application of the proposed de-noising technique. From Figure 7.9 it can be seen that the proposed method is successful in removing both the high frequency and low frequency noise.

The peak of the de-noised Heidler derivative is 48.9, and that of the original Heidler derivative is 50. Therefore, almost 98% of the peak is recovered after the de-noising process. Also, the SPNPR

69

improved tremendously. The SPNPR of the noised Heidler derivative is 27.96 dB and after denoising process it becomes 52.7 dB, which implies an improvement of almost 25 dB.

50 40 en :::t

noised ------.----- de-noised
--~

original

~
Q)

~
.;::

> >

30 20 10 0
'-

Q)

"0

....-

c:

{g
::J

0

noised

---

-0.4

-0.2

o

0.2

0.4 Time [f.ls]

0.6

0.8

1

1.2

Figure 7.9: Heidler derivative function (before and after de-noising) using the proposed MSS method.

7.3.2

Performance evaluation of the proposed method on Heidler derivative model corrupted with different levels of eN Tower noise only signal

The performance of the proposed spectral subtraction method is then evaluated by applying it to Heidler derivative model shown in Figure 7.1 corrupted with different levels of the noise signal captured at the

eN Tower in the absence of lightning. The noise signal that is added to Heidler

derivative model is shown in Figure 7.2 (a). The corrupted Heidler derivative signal and its corresponding current waveform is shown in Figure 7.10. Figure 7.11 shows the de-noised Heidler derivative signal and its corresponding current waveform, and Figure 7.12 shows the close up view of the de-noised Heidler derivative.

70

tn

60r--------,---------,---------,--------~--------,_------~

f g1
§:~
~

40
20

~ O~~~~~~~~~ 40 -10 o 10 30
-20 20
Time [f..l.sj
15,-------,-------,--------.-------,-------,------~

~ 10

;e: ~

5

o r---~~-~~-~--20 -10 o
Figure 7.10:

10 Time [f..l.sj

20

30

40

Corrupted Heidler current derivative waveform (a) and its corresponding Heidler current waveform (b) obtained by numerical integration.

tn 50

f g1

40 30 20 10 0 -20 -10 0 10
Time [f..l.sj

~

~ ~

20

30

40

10

~

~

5

0 -20 -10 0 10
Time
[f..l.sj

20

30

40

Figure 7.11: De-noised Heidler derivative function and its corresponding current waveform (obtained by integration) using the proposed de-noising method

71

From Figure 7.11 it can be seen that there is a tremendous amount of reduction in the high and low frequency noise compared to that of the corrupted Heidler derivative signal and its corresponding current waveform shown in Figure 7.10.

Figure 7.12 shows the close up view of the de-noised Heidler derivative function with respect to the original Heidler derivative function. It can be seen from this figure that the peak of the signal as well as the shape of the signal follows well the shape and peak of the original Heidler derivative function.

The SPNPR of the noised Heidler derivative function becomes 31.3 dB, and after the de-noising process it improves to 58.2 dB, which implies an improvement of 30 dB. Also, there is a 98% recovery of Heidler derivative signal.

50
Iii' 40 :::1.

----- de-noised --original

~
~ >
>
Q)

30 20 10 0
-~-

.~

""C

c:

~ ::l

0

-0.4

-0.2

o

0.2

0.4 1ime [l-tsj

0.6

0.8

1.2

Figure 7.12: De-noised Heidler derivative function (close up view of Figure 7.11).

Comparison of the proposed modified spectral subtraction (MSS) method with the conventional spectral subtraction (SS) method

In order to illustrate the superior performance of the proposed de-nosing method, the results obtained by the application of the proposed method on artificially corrupted Heidler derivative signal with a higher level of noise are compared with the results obtained by applying the

72

conventional spectral subtraction method to the same corrupted Heidler derivative signal. Figure 7.13 shows Heidler derivative signal corrupted with the noise signal measured at the

eN Tower in

the absence of lightning multiplied with a factor of 4 to increase the level of noise. Figure 7.14 shows a close up view of Heidler derivative signal de-noised using the proposed (MSS) method while Figure 7.15 shows a close of view of Heidler derivative signal de-noised using the conventional spectral subtraction (SS) method.

It can be clearly seen from Figure 7.14 that the MSS method is successful in increasing the

signal-to-noise ratio while maintaining the shape and peak of the Heidler derivative signal. While from Figure 7.15 it can be seen that the SS method compared to the MSS method is not very successful since the peak and the shape of the signal is following the corrupted Heidler derivative signal rather than following the original Heidler derivative signal, and therefore the improvement in the signal-to-noise ratio is not substantial.

Vi'

60 40 20 0 -20 -60 15 -40 -20
,,,.1,,
'"'I'~'II'tt"NIII'"

~

::1.

Q)

~

> >

'1::: Q)

'tJ

1,1"""
"''''1'

C ~

()

::J

0

20

40
lime
[~sl

60

80

100

120

140

()

~
c

10 5 0 -5 -60 -40 -20 0 20 40
Time [~sl

~ ::J

60

80

100

120

140

Figure 7.13: Heidler derivative signal corrupted with the noise signal measured at the eN Tower in the absence of lightning.

73

50
~
(/)

original

noised ... de-noised
--~

original

40

~
> z
Q.l

:t

30

ro

.1::

>

~ :::J () 10

~ ...... c

20

noised

-0.4

-0.2

o

0.2

0.4

0.6

0.8

lime [J..lsl

Figure 7.14: De-noised Heidler derivative signal using the MSS method.

50
~~~~~

noised de-noised original

--~

~
(/)

40

"J:
~

> ~ > ·c ~ 20
......

Q.l

30

~ :::J () 10

I::

noised

-0.4

-0.2

o

0.2

0.4

0.6

0.8

Figure 7.15: De-noised Heidler derivative signal using SS method.

74

7.3.3

Waveform parameters from the de-noised Heidler derivative function and its corresponding Heidler function for different noise levels

The proposed method was applied to Heidler derivative function corrupted with different noise levels in order to further evaluate the performance of the proposed method. The levels of noise (peak-to-peak) that are used in the analysis are:

· · · ·

Noise level#1 (NLJ) = 2.72 kA/f.!S Noise level#2 (NL2) = 5.44 kA/f.!s Noise level#3 (NL3) = 8.16 kA/f.!s Noise level#4 (NL4) = 10.88 kA/f.!s

The parameters of the de-noised Heidler derivative function and its corresponding Heidler function are presented in Tables 7.2 and 7.3. It can be seen from Table 7.2 that for all levels of noise the proposed method works very well. At noise level#l, the improvement in SPNPR is 26.9 dB. For the purpose of comparison, in Table 7.2 the values in the brackets in the SPNPR row represent the SPNPR of the corrupted Heidler derivative signal. In Table 7.3, the values in the brackets in the SPNPR row represent the SPNPR of the current waveform corresponding to the corrupted Heidler derivative signal.

From Table 7.2 it can be seen that the recovery of the de-noised Heidler derivative signal peak value is around 98.4% of the original Heidler derivative signal peak value. At noise level#2, the improvement in the signal-to-noise ratio is 30.8 dB, and the peak value is 97.54% of the original. At noise level#3, the improvement in SPNPR is 30.74 dB, and the peak is 96.7% of the original peak value. At noise level#4, the improvement in SPNPR is around 30.4 dB and the peak is recovered at 95.7% of the original peak value. Other important parameters like the risetime and pulse width remain almost unchanged for all four levels of noise after the application of the proposed de-noising method.

From Table 7.3, tremendous improvements can be seen in the values of SPNPR, peak and risetime of the current waveform corresponding to the de-noised Heidler derivative signal for different levels of noise. The improvement in SPNPR of the current waveform is from 24.75 dB26.75 dB, and the peak recovery is around 99.8% of the original.

75

Table 7.2: Waveform parameters of the de-noised Heidler derivative function for different levels of noise Heidler current derivative (di/dt) Pulse width Peak (kA/Jls) Maximum steepness (kA/JlS)2 Risetime (Jls) SPNPR [dB] Original Heidler current derivative Function 0.19

De-noised Heidler derivative NLl
0.19

NL2
0.19

NL3
0.19

NL4
0.19

50.03

49.16

48.77

48.35

47.85

483.83

464.4

458.7

453

446.7

0.10

0.10

0.10

0.10

0.105

Infinity

58.2 (31.3)

56.1 (25.3)

52.5 (21.76)

49.54 (19.27)

Table 7.3: Waveform parameters of the Heidler function corresponding to the de-noised Heidler derivative function for the different levels of noise

Current

Original Heidler Current Function

Current corresponding to the de-noised Heidler derivative in Table 7.2

NLl Peak
(kA)

NL2
10.253

NL3
10.251

NL4
10.24

10.27

10.255

Maximum steepness (kA/Jls) Risetime (Jls) SPNPR [dB]

50.03

49.16

48.77

48.35

47.85

0.23

0.23

0.23

0.24

0.24

Infinity

55.95 (31.2)

52.35 (25.91)

49.26 (22.38)

46.14 (19.89)

76

7.4 Comparative results of the proposed and conventional spectral subtraction methods
The performance of the proposed de-noising method was compared with the conventional spectral subtraction method. The proposed spectral subtraction method proved to outperform the conventional spectral subtraction method in terms of the signal to noise ratio and the peak of both the Heidler current and its derivative waveforms. The results of the de-noised Heidler derivative and its corresponding Heidler current corrupted with different levels of noise are presented in the Table 7.4 and Table 7.5. In these tables, SS represents the conventional Spectral Subtraction method and MSS represents the proposed Modified Spectral Subtraction method.

From these two tables it can be clearly seen that the proposed modified spectral subtraction method outperformed the conventional spectral subtraction method in terms of signal-to-noise ratio, and the peak of both Heidler derivative and its corresponding current waveforms for all levels of noise. The noise levels are described in section 7.3.3.

The improvement in the signal to noise ratio is 27 dB - 30 dB and with 95.7% - 98% of the peak recovery for the de-noised Heidler derivative by using the proposed method, while the improvement in the signal to noise ratio is 10.5 dB - 16 dB with a peak recovery of93.3% -97.5% for the conventional spectral subtraction method.

77

Table 7.4: Comparison analysis of the conventional spectral subtraction (SS) and the proposed spectral subtraction (MSS) methods applied on the Heidler Derivative function under different noise levels

Heidler current derivative (di/dt) Pulse width Peak
(kA/lJs)

Original Heidler derivative SS
0.19 0.19

De-noised Heidler derivative NLI MSS
0.19

NL2 SS
0.19

NL3 MSS
0.19

NL4 MSS
0.19

SS
0.19

SS
0.19

MSS
0.19

50.03

48.77

49.16

48.1

48.77

47.6

48.35

46.68

47.85

Maximum steepness (kAllJsi Risetime (lJs) SPNPR [dB]

483.83

457.9

464.4

446.2

458.7

436.8

453

431.6

446.7

0.10

0.10

0.10

0.10

0.10

0.11

0.10

0.11

0.105

Infinity

42.24 (31.3)

58.2 (31.3)

40.2 (25.3)

56.1 (25.3)

38.32 (21.76)

52.5 (21.76)

35.61 (19.27)

49.54 (19.27)

Table 7.5: De-noised Heidler current (corresponding to the de-noised Heidler derivative function in Table 7.4) waveform parameters for different levels of noise Current Original Heidler Current Function SS Peak
(kA)

Current corresponding to the de-noised Heidler derivative in Table 7.2

NLl MSS
10.255

NL2 SS
10.23

NL3 MSS
10.253

NL4 MSS
10.251

SS
10.20

SS
10.14

MSS
10.24

10.27

10.24

Maximum steepness (kAlIJS)2 Risetime (lJs) SPNPR [dB)

50.03

48.77

49.16

48.1

48.77

47.6

48.35

46.68

47.85

0.23

0.24

0.23

0.24

0.23

0.25

0.24

0.25

0.24

Infinity

44.91 (31.2)

55.95 (31.2)

40.12 (25.91)

52.35 (25.91)

39.90 (22.38)

49.26 (22.38)

37.48 (19.89)

46.14 (19.89)

78

Figure 7.16 shows the improvement in the SPNPR after applying MSS and SS to the Heidler derivative signal corrupted with different levels of noise.
70 60 50
a:; 40
~

noised de-noised using SS de-noised using MSS

a.. z a.. en

0::

30 20 10 0
~ ~

NL1

NL2

-

-

-

~

~

NL3

NL4

Figure 7.16: Comparison of the values ofSPNPR ofthe noised Heidler derivative signal with the values of SPNPR of the de-noised Heidler derivative signal using MSS and SS methods for different noise levels.

7.5 De-noising the lightning current derivative signals measured at the CNTower
The proposed spectral subtraction method is applied to the measured lightning current derivative waveforms recorded at the

eN Tower and its corresponding current waveform is derived by the

time integration of the current derivative waveform.

Figure 7.17 shows a measured current derivative signal recorded on July 03, 1999 at 17:31 :36, and its corresponding current waveform. Figure 7.18 shows the waveforms of Figure 7.17 after the removal of the dc shift, and Figure 7.19 shows the de-noised lightning current derivative and its corresponding current waveform. A close up view of Figure 7.19 is presented in Figure 7.20. The results of SPNPR and the peak of the lightning derivative and its corresponding current waveform before and after de-noising are presented in Table 7.6.

79

Jul 03/1999,17:31:36,8 out of8 stroke(s), Channel A, G0363096.788
7ii'

30 20 10 0 -10

[

.~ ~~

~

S
~S
~

~"~
0 10 lime [!J.sl

.,"

-10 -20

20

30

40

-5 -10 -15 -20

-2~20

-10

0

10 Time [!J.sl

20

30

40

Figure 7.17: Lightning current derivative (a) measured at the eN Tower and its corresponding current waveforms (b) [File: G0363096.788].

Jul 03/1999,17:31:36,8 out of8 stroke(s), Channel A, G0363096.788
~

.~ (0"16 '-' >

t
~

30,--------r-------,--------,--------,--------,-------~

20

10

~

O~~MW~~~~~~~
-20

'"

-10L-------~------~--------~------~--------~------~

-10

o

10 lime [!J.sl

20

30

40

8r-------,--------,-------,--------,-------,-------~

6

-~70-------1~0------~0~----~1~0------~20~----~3~0----~40

Time [!J.sl

Figure 7.18: The lightning current derivative signal after the removal of a dc shift (a) and its corresponding current waveform (b) [File: G0363096.7881.

80

00

30,-~~~~~~~~~~~~~~~~~~~~~~~~~~

t

20

'-" >

roW

~

10

~

~

O~--~~~~~.~~~~~~
-10

_10L-~~~-L~~~~L-~~~-L~~~~~~~~-L~~~~

-20

o

10
Time [).!s]

20

30

40

8'-~~~-r~~~~'-~~~~~~~-''-~~~-r~~~-'

6

2
OF----~~~~~~~~

-10

o

20

30

40

Figure 7.19: De-noised lightning current derivative (a) and its corresponding current waveforms (b) (de-noised of Figure 7.18) [File: G0363096.788].

t
'-" "'C

Iii'

30 20 10 0 -10 -1 6 -0.8 -0.6 -0.4 -0.2 0
Time [).ls]

> ~ > _"i:: co Q)
c:
Q)

Q)

..... .....

::l ()

0.2

0.4

0.6

0.8

'-"c
::l

..0

~c: Q)

-

~ 4

()

2 0 -1

-0.8

-0.6

-0.4

-0.2

0
Time [).lS]

0.2

0.4

0.6

0.8

Figure 7.20: A Close up view of Figure 7.19 [File: G0363096.788].

81

Table 7.6: SPNPR and Peak values of the lightning current derivative signal and its corresponding current waveform (Figure 7.19) before and after the application of the proposed method (MSS) [File: G0363096.788] Before de-noising Peak Current derivative Current SPNPR After de-noising Peak SPNPR

23.85 [kA/J.ls] 5.639 [kA]

25.56 [dB] 30.43 [dB]

22.64 [kAIJ.ls] 5.514 [kA]

52.27 [dB] 54.81 [dB]

In Table 7.6, it is clear that the proposed de-noising method (MSS) increased the SPNPR of both current derivative and its current waveforms tremendously while keeping the peak of both signals within acceptable levels.

Figure 7.21 shows a measured current derivative signal recorded at the eN Tower on April 11,
1999 at 12:53: 19, and its corresponding current waveform. Figure 7.22 shows the waveforms of

Figure 7.22 after the removal of dc shift, and Figure 7.23 shows the de-noised lightning current derivative signal and its corresponding current waveform. A close up view of Figure 7.23 is presented in Figure 7.24. The SPNPR and the peak of the lightning derivative and its corresponding current waveform before and after de-noising are presented in Table 7.7.

Apr 11/1999,12:53:19,2 out of4 stroke(s), Channel A, D1146399.192
'U)

~
ro~ ~ >

::1.

8
6

~

4
2 0 -2 -20

~
e:~

~

Time [f-tsl

-5

!

-10 -15 -20 -20

-10

o

10 Time [f-tsl

20

30

40

Figure 7.21: Lightning current derivative measured at the CN Tower (a) and its corresponding current waveform (b) [File: D1146339.192].

82

Apr 11/1999, 12:53:19, 2 out of 4 stroke(s), Channel A, D1146399.192
U)'

r
.~

8 6

4 2 0 -2 -20 -10 0 10
Time [J,.ls]

§:~

~

~

20

30

40

6

8:~

~

4 2 0 -20 -10 0 10 Tim e [J,.ls] 20 30 40

Figure 7.22: Lightning current derivative with dc noise removed (a) and its corresponding current waveform (b) [File: D1146339.192].

_2L-______- L_ _ _ _ _ _ _ _L -_ _ _ _ _ _
-20
-10

~

________

~

______

~

______

~

o

10

20

30

40

Time [J..lsl
6~------~--------~------~--------,_------_,------__,

o F-----------~
-20 -10

o

10 Time [J..lsl

20

30

40

Figure 7.23: De-noised lightning current derivative (a) and its corresponding current waveform (b) (de-noised of Figure 7.22) [File: D1146339.192].

83

Ci)

f
~j
.~

6
4

2

~
I

0
-2 -2

-1.5

-1

-0.5

0
Time [ ....5]

0.5

1

1.5

2

6

4

~~

2

0
-2

-1.5

-1

-0.5

0
Time [ ....5]

0.5

1.5

2

Figure 7.24: A Close up view of Figure 7.23 [File: D1146339.192].

Table 7.7: SPNPR and Peak values of the lightning current derivative signal and its corresponding current waveform (Figure 7.23) before and after the application of the proposed method (MSS) [File: D1146339.192]

Before de-noising Peak Current derivative Current
6.41 [kA/Jls] 3.166 [kA]

After de-noising Peak
5.805 [kA/Jls] 3.118 [kA]

SPNPR
15.96 [dB] 29.20 [dB]

SPNPR
40.47 [dB] 41.09 [dB]

Table 7.7 presents the lightning derivative and its corresponding current with low values of peak and SPNPR. From this table, it is clear that the proposed de-noising method increased the SPNPR of both di/dt and the current waveforms tremendously while keeping the peak of both signals within acceptable levels. This implies that the proposed method also work well with the signals with low SPNPR and peak values.

Figure 7.25 shows the measured current derivative signal recorded at the eN Tower on January 2, 1999 at 22:27:04, and its corresponding current signal. Figure 7.26 shows the waveforms of

84

Figure 7.25 with a dc shift removed from it, and Figure 7.27 shows the de-noised lightning current derivative and its corresponding current waveform. A close up view of Figure 7.27 is shown in Figure 7.28. The results of SPNPR and the peak of the lightning derivative and its corresponding current waveform before and after de-noising are presented in Table 7.8.

Vi"

t

Jan 02/1999,22:27:04,2 out of4 stroke(s), Channel A, A0280824.252

40

I

I

I

I

I

Q)

1U 20 >
·c
Q)

>

'0

<3

'E ~ ....

0
-20 30 -10

~~.I
o
10 lime [J..Ls] 20 30 40

~ 20 'E Q) .... .... 10 ::J
0
~

0 -20

-10

0

10 lime [J..Ls]

20

30

40

Figure 7.25: Lightning current derivative and measured at the eN Tower (a) its corresponding current waveform (b) [File: A0280824.252].

Iii'

t

Jan 02/1999,22:27:04,2 out of4 stroke(s), Channel A, A0280824.252 40 20
I I

I

I

I

-~ C'D >
_·c

~

Q.l

c: ~ 8

'0

0
-20 -10

o

~~~V

10 Time [J,.I.s]

20

30

40

~ :C--C:
-~
::J

0

8 6 4 2 0 -2 -20

-10

0

10 Time [J,.I.s]

20

30

40

Figure 7.26: Lightning current derivative with dc noise removed (a) and its corresponding current waveform (b) [File: A0280824.252].

85

t
<tl
-

en
Q)

40 30 20 10 0 -10 -20 -10

~<tl

"'" >
"t:
Q)

>

""C

~ ::::l u

c:

o

10

20

30

40

Time [J.1s1
8 6

~
~

e~
U

c:
::::l

4 2 0 -2 -20 -10

o

20

30

40

Figure 7.27: De-noised lightning current derivative (a) and its corresponding current waveform (b) (de-noised of Figure 7.26) [File: A0280824.252].

Vi'

40 20 0

[

Q)

ro~
~~

.~

i -20 a -1
6
:;!; 4
~

-0.8

-0.6

-0.4

-0.2

0
Time [J.1sJ

0.2

0.4

0.6

0.8

1

e~

c:
::::l

u

2
0

-1

-0.8

-0.6

-0.4

-0.2

0
Time [J.1sJ

0.2

0.4

0.6

0.8

Figure 7.28: A close up view of Figure 7.27 [File: A0280824.252].

86

Table 7.8: SPNPR and Peak values of the lightning current derivative signal and its corresponding current waveform (Figure 7.27) before and after the application of the proposed method (MSS) [File: A0280824.252] Before de-noising Peak Current derivative Current
34.76 [kA/lls] 4.82 [kA]

After de-noising Peak
33.21 [kA/lls] 4.79 [kA]

SPNPR
27.33 [dB] 17.4 [dB]

SPNPR
44.4 [dB] 44.82 [dB]

Table 7.8 corresponds to the lightning derivative and current with high peak and SPNPR values. From this table, it is clear that the proposed de-noising method increased the SPNPR of both current derivative and the current waveforms tremendously while keeping the peak of both signals within acceptable levels.

Comparison of the results with the results obtained by applying the conventional spectral subtraction method (SS) on the lightning current derivative signals

The conventional spectral subtraction (SS) method is also applied on the lightning current derivative signal at the eN Tower in order to compare its performance with the proposed modified spectral subtraction (MSS) method. The SS method is applied on the same lightning current derivative signals and by doing so, it is proved that the proposed MSS method outperforms the SS method in terms of the SPNPR, shape, and the peak of the lightning current derivative signals and its corresponding current waveforms.

The lightning signals shown in Figure 7.18, 7.22 and 7.26 are de-noised by using the SS method and the results of the SPNPR and peak values of the current derivative signal and its corresponding current waveform before and after de-noising are presented in Tables 7.9-7.11.

87

Table 7.9: SPNPR and Peak values of the lightning current derivative signal and its corresponding current waveform before and after the application of the conventional spectral subtraction method (SS) [File: G0363096.788]

Before de-noising Peak Current derivative Current 23.85
[kA/~s]

After de-noising Peak 22.51
[kA/~s]

SPNPR 25.56 [dB] 30.43 [dB]

SPNPR 45.6 [dB] 42.5 [dB]

5.639 [kA]

5.18 [kA]

Table 7.10: SPNPR and Peak values of the lightning current derivative signal and its corresponding current waveform before and after the application of the conventional spectral subtraction method (SS) [File: D1146339.192]

Before de-noising Peak Current derivative Current 6.41
[kA/~s]

After de-noising Peak 5.98
[kA/~s]

SPNPR 15.96 [dB] 29.20 [dB]

SPNPR 32.1 [dB] 32.4 [dB]

3.166 [kA]

3.04 [kA]

Table 7.11: SPNPR and Peak values of the lightning current derivative signal and its corresponding current waveform before and after the application of the conventional spectral subtraction method (SS) [File: A0280824.252] Before de-noising Peak Current derivative Current 34.76
[kA/~s]

After de-noising Peak 33.24
[kA/~s]

SPNPR 27.33 [dB] 17.4 [dB]

SPNPR 34.9 [dB] 33.6 [dB]

4.82 [kA]

4.68 [kA]

From the above three tables, it is obvious that the proposed MSS method outperforms the SS method.

88

Detailed comparison of MSS with SS

It can be clearly seen from Tables 7.6-7.8, and Tables 7.9-7.11 that the proposed spectral

subtraction method (MSS) is superior to the conventional spectral subtraction (SS) method. Figure 7.29 shows the de-noised (MSS) versus the corrupted Heidler derivative signal and its corresponding current waveforms. Figure 7.30 shows the close up view of Figure 7.29.

(j) :::1.

8
6

~
~rn
~

w 4 ~
.~
0-

rn

2 0 -2 -20 -10 0 10 20 30 40

"0

W

C

~
~

()

Time [j.ls]

4
~~

measured de-noised

..0 -

~~ 2
~-

c

~
~

()

0

-""-----~----:-:'-,-:-;;-';--~

-20

-10

0

10

20

30

40

Time [j.ls]

Figure 7.29: De-noised lightning current derivative (a) and its corresponding current waveform (b) (using MSS) [File: D1l46339.192].

(jj'

8 6 4 2 0 -2
-1

[
·c
Q) ""C
~

ro "'" >

>

Q)

~~
:l ()

c

-0.8

-0.6

-0.4

-0.2

0
Time [j.lsl

0.2

0.4

0.6

0.8

4 3
measured ..... de-noised

~
..c
~

c

2

~I=

Q)

:l

()

0

-1

-0.8

-0.6

-0.4

-0.2

0
Time [j.lsl

0.2

0.4

0.6

0.8

Figure 7.30: A close up view of Figure 7.29 [File: D1l46339.192].

89

Figure 7.31 shows the de-noised (SS) versus the corrupted Heidler derivative signal and its corresponding current waveforms. Figure 7.32 show the close up view of Figure 7.31. By comparing Figures 7.30 and 7.32 we can see that the proposed (MSS) method is successful in suppressing more noise compared to the conventional spectral subtraction (SS) method. This comparison is shown in Figure 7.33.

7ii"

8 6
measured
~de-noised

::1.

~
.2::
.~
0>

4 2
0
"
,
,," I

ro
::;
L..

-

_0>

ro"'C ...... c
0>

-2 -20

-10

0

10
Time [/ls]

20

30

40

0

4
_c

measured - - - de-noised

~ ......
::::J

e~
0

2 0 -20 -10 0 10
Time [/ls]

20

30

40

Figure 7.31: De-noised lightning current derivative (a) and its corresponding current waveform (b) (using SS) [File: D1146339.192].

7ii" 10 ::1.

-

~ 0> .2:: ro > .;::
0> L..
L..

5

measured -- de-noised

0
-5

_0>

ro"'C ...... c
::::J

-1

-0.8

-0.6

-0.4

-0.2

o
Time [/lsl

0.2

0.4

0.6

0.8

0

4

.0 0> _L..
L..

...... _c
0

~
::::J

3 2

measured -.. ---------- de-noised

0 -1

-0.8

-0.6

-0.4

-0.2

o
Time [/lsl

0.2

0.4

0.6

0.8

Figure 7.32: A close up view of Figure 7.31 [File: D1146339.192].

90

6
5
Vi'

MSS ---+/}

- - - de-noised using MSS de-noised using SS

t

4
3

> ~ > '1::

Q)

-c

Q)

2

C ~

()

::J

SS
-1 -1
-0.8

-0.6

-0.4

-0.2

o
Time [Ils]

0.2

0.4

0.6

0.8

Figure 7.33: Comparison of the current derivative signal de-noised using MSS and SS (for Figure 7.30 and Figure 7.32).

Figure 7.34 shows the comparison of SPNPR of the original signals with the SPNPR obtained by applying MSS and SS methods to these signals. In this figure, Sl corresponds to the signal shown in Figure 7. 17(a), S2 corresponds to the signal shown in Figure 7.21(a), and S2 corresponds to the signal shown in Figure 7.2S(a).1t can be clearly seen in this figure that there is a substantial improvement in the SPNPR obtained by de-noising all three signals (Sl, S2 and S3) using the MSS method.
60 50 40 30 20 10 0
measured de-noised using SS de-no,ised using MSS
~

iii'
a.. z a..
0:::

~

Cf.)

i

-

-

-

~

-

-

S 1

S 2

S3

Figure 7.34: Comparison of the values of SPNPR of the original current derivative signals measured at the CN Tower with the values of SPNPR after applying MSS and SS methods.

91

7.6

Summary of Results

In this chapter the proposed spectral subtraction method (MSS) is evaluated and its performance is compared with that of the conventional spectral subtraction method (SS).

It is proved from the analysis that the proposed de-noising method successfully removes the low-

frequency noise signal (Loran-C related), which substantially affects the determination of current and current derivative waveform parameters. The dc shift is easily removed by taking the average of the pre-return stroke portion of the signal and subtracting it from the whole signal. The high frequency noise is very much reduced in the current waveform because of the integration process. The frequency oscillating around 100 kHz is successfully removed using the proposed (MSS) method making it easy to extract waveform parameters of the current derivative signal and its corresponding current waveform.

92

Chapter 8

Conclusions and Future Research
The eN Tower has been an excellent source of comprehensive lightning data since 1991. The lightning current derivative signal captured at the eN Tower is the most valuable because of the difficulty of direct measurement of lightning currents. However, the eN Tower current derivative signal is corrupted with different kinds of noise and must be de-noised to make the extraction of the current waveform parameters possible which are essential for protection purposes. Although the installation of the new Rogowski coil with a fiber link at the eN Tower in 1997 substantially reduced the effect of noise in the lightning current signals, the data captured by the new coil is too limited to produce useful statistics for current waveform parameters. In this project we proposed a Modified Spectral Subtraction (MSS) method for enhancing the lightning current derivative signal measured at the eN Tower. This implementation uses oversubtraction method for power spectral subtraction and a residual noise reduction algorithm.

8.1

Conclusions

Spectral subtraction is a popular method for enhancing the quality of a non-stationary signal such as the lightning current derivative signal corrupted by additive noise. Implementation of the spectral subtraction method requires an available estimate of the corrupting noise. The spectrum of the noise is estimated during a period oftime known to be signal free. This estimate is then assumed to remain stationary over the entire noisy lightning current derivative signal.

The proposed modified spectral subtraction method, unlike other non-stationary signal enhancement techniques which assume that signal and noise are uncorrelated, takes into account possible correlation between signal and noise. The proposed method was then evaluated using Heidler derivative function artificially corrupted by additive noise signal measured at the eN Tower in the absence of lightning. A Hanning window of size 2048 was used for the analysis with

93

SO% overlap between frames. The final enhanced signal was reconstructed by computing the inverse FFT of the estimated spectral amplitude combined with the phase of the corrupted signal, and using the standard overlap-and-add method.

Performance of the algorithm was compared with the conventional spectral subtraction method. The proposed method performed substantially better than the conventional spectral subtraction method in terms of the signal-to-noise ratio and recovery of all the waveform parameters within acceptable levels.

The improvement in the signal-to-noise ratio was found to be in the range of27 dB - 30 dB with 9S.7% - 98% of the peak recovery for the de-noised Heidler derivative by using the proposed method, while the improvement in the signal-to-noise ratio was found to be in the range of 10.S dB - 16 dB with a peak recovery of93.3% -97.S% for the conventional spectral subtraction method.

8.2

Future Research

In spite of the success of the proposed spectral subtraction method, there is still a need to improve the performance of the modified spectral subtraction method in terms of signal-to-noise ratio and the recovery of both the current derivative and current peaks.

Since spectral subtraction is a popular method in speech processing, a tremendous amount of research has been done to further improve its performance including combining spectral subtraction method with other de-noising methods. For example:

·

A wiener filter can be combined with the spectral subtraction method that has proved to perform very well in speech processing.

·

A wavelet transform based spectral subtraction has proved to perform well in speech processing.

94

·

Another technique used in the enhancement of speech is based on the spectral subtraction using spectral harmonics of speech, especially designed to perform well at low signal-to-noise ratio in noisy environments.

Other speech enhancement methods can be applied to the lightning signals due to the fact that both speech and lightning signals are of non stationary nature.

Another important factor that limits the performance of the spectral subtraction techniques is the estimation of the noise during the non-signal activity periods. In case of the lightning signal, the performance of the proposed method would greatly improve if the number of data points before the arrival of the lightning signal is increased. That is by increasing the amount of recorded noise signal data before the arrival of the lightning signal would give a better estimate of the noise during the non-signal activity and will eventually improve the performance of the proposed spectral subtraction technique.

95

Bibliography
[1] M. A. Uman, All about Lightning, Dover publications, Inc., New York, 1986.

[2] M. A. Uman, "Natural Lightning," IEEE transactions on industry applications. Vol. 30, No.3, May/June 1994.

[4] M. A. Uman, The Lightning Discharge, Academic press, Inc., Harcourt Brace Jovanovich, publishers, New York, 1987.

[3] N.K. Trehan, "Consequences of Lightning Strikes On Nuclear Power Generating Stations," IEEE Nuclear Science Symposium Conference Record, Vol. 3, pp. 27/11-27/15, 15-20 October 2000.

[5] R.H.Golde, Lightning, Academic Press, New York, 1977.

[6] M. E. Bazelian and Y. P. Raizer, Lightning Physics and Lightning Protection, lOP publishing Ltd 2000, Bristol and Philadelphia.

[7] J.L. Marshall, Lightning Protection, John Wiley and Sons, Inc., USA, 1973.

[8] W. W.Lewis, Protection of Transmission Systems against Lightning, Dover publications, New York, 1965.

[9] A.M. Hussein, W. Janischewskyj, M. Milewski, V. Shostak, W. Chisholm and J.S. Chang, "Current waveform parameters ofCN tower lightning return strokes," Journal of Electrostatics, Vol. 60, Nos. 24, pp 149-162, March 2004.

[10] A.M. Hussein, W. Janischewskyj, M. Milewski, V. Shostak, F. Rachidi and J.S. Chang, "Comparison of Current Characteristics of Lightning Strokes Measured at the CN Tower and at Other Elevated Objects," IEEE transactions 2003.

[11] A.M. Hussein, W. Janischewskyj and M. Milewski, "Waveform parameters of the electromagnetic pulse generated by first and subsequent lightning return strokes to the CN Tower," Electromagnetic compatibility, Wroclaw, 29 June - 1 July 2004.

96

[12] MJ. Islam and A.M. Hussein, "De-Noising the CN tower lightning current derivative signal using short term Fourier transform-based spectral subtraction," Proceedings of the 17 th International Symposium and Exhibition on Electromagnetic compatibility, pp. 400-406, Wroclaw, Poland, June 29 - July 1,2004.

[13] P. Liatos and A.M. Hussein, "Characterization of 100-kHz Noise in the Lightning Current Derivative Signals Measured at the CN Tower," IEEE Transactions on Electromagnetic Compatibility (EMC), Vol. 47, No.4, pp. 986-997, November 2005.

[14] F. Heidler, J.M. Cvetic and B.V. Stanic, "Calculation of Lightning Current Parameters," IEEE Transactions on Power Delivery, Vol. 14, No.2, April 1999.

[15] K. Bitner, "Modeling of the Lightning Return Stroke Current at a Tall Structure Using the Derivative of the HEIDLER Function," MASc Thesis, Ryerson University, Toronto, September 2004.

[16] Y. Chen, S. Liu, X. Wu and F. Zhang, "A new kind of Lightning Channel-base Current Function," 3rd International Symposium on Electromagnetic Compatibility, pp. 304-307, May 2002. [17] C.A. Nucci: Lightning-induced voltages on overhead power lines. Part I: Return stroke models with specified channel-base for the evaluation of the return stroke electromagnetic field, Electra, vol. 161, pp. 74-102,1995.

[18] IEC 61312-1, 2/95: Protection against lightning electromagnetic impulse, Part 1: General principles [19] F. Heidler and J.M Cvetic, "A Class of Analytical Functions to Study the Lightning Effects Associated With the Current Front," ETEP Vol. 12, No.2, MarchiApril2002. [20] J. G. Proakis and D. G. Manolakis, Digital Signal Processing: Principles, Algorithms, and Applications, Prentice hall Inc., New Jersey, 1996.

[21] S. W. Smith, The Scientist and Engineer's Guide to Digital Signal Processing: Chapter 12 - The Fast Fourier Transform, 1997-1998.

[22] J. W. Cooley and J. W. Tukey, "An algorithm for the machine calculation of complex Fourier series," Math. Comput. 19,297-301 (1965).

[23] R. N. Bracewell, The Fourier transform and its applications, Boston, McGraw Hill, 3rd edition, Toronto, 2000.

97

[24] S. V. Vaseghi, Advanced Digital Signal Processing and Noise Reduction, John Wiley and Sons Ltd., UK,2006.

[25] J.B. Allen, "Short Term Spectral Analysis, Synthesis, and Modification by Discrete Fourier Transform," IEEE Transactions On Acoustics, Speech and Signal Processing, Vol. ASSP-25, No.3, pp. 235-238, 1977.

[26] J.B. Allen and L.R. Rabiner, "A Unified Approach to Short Time Fourier Analysis and Synthesis," IEEE Transactions On Acoustics, Speech and Signal Processing, Vol. 65, No. 11, pp.1558-1564, 1977.

[27] M. Berouti, R. Schwartz and J. Makhoul, "Enhancement of speech corrupted by acoustic noise," Proc. IEEE ICASSP, pp. 208-211, Washington DC, Apri11979.

[28] S.F. Boll, "Suppression of acoustic noise in speech using spectral subtraction," IEEE Transactions On Acoustics., Speech and Signal Processing., Vol. ASSP-27, No.2, pp.113-120, Apri11979.

[29] S. M. McOlash, R. J. Niederjohn and J. A. Heinen, "A Spectral Subtraction Method for the Enhancement of Speech Corrupted by Non-White, Non-Stationary Noise," Proc IEEE. Int. Conference.
on Industrial Electronics, Control, and Instrumentation, Vol. 2, pp. 872.877,1995.

[30] N. W. D. Evans, Spectral Subtraction for Speech Enhancement and Automatic Speech Recognition,. PhD Thesis, University of Wales Swansea, 2003.

[31] Y. Hu, M. Bhatnagar and P. C. Loizou, "A Cross-Correlation Technique for Enhancing Speech Corrupted with Correlated Noise," IEEE International Conference on Acoustics, Speech, and Signal Processing, Vol. 1, pp. 673 - 676, May 2001

[32] P. Lockwood and J. Boudy, "Experiments with a Non-linear Spectral Subtractor (NSS), Hidden Markov Models and the projections, for robust recognition in cars," Speech Communications, Vol. 11, No. 2-3, pp 215-228, June 1992.

[33] P. Sovka, P. Pollak and J. Kybic, "Extended Spectral Subtraction," Proc. Of European Conf. Signal Proc. And Communication, Trieste, pp 963-966, September 1996.

98

[34] R. M Udrea and S. Ciochinri, "Speech Enhancement using Spectral Oversubtraction and Residual Noise Reduction," International Symposium on Signals, Circuits and Systems (SCS), Vol. 1, pp. 165 168, July 2003.

[35] R. M. Udrea, S. Ciochina and D. N. Vizireanu, "Reduction of Background Noise from affected Speech using a Spectral Subtraction Algorithm based on Masking Properties of the Human Ear," 7th International Conference on Telecommunications in Modem Satellite, Cable and Broadcasting Services, Vol. 1, pp. 135-138, September 2005.

99

,

