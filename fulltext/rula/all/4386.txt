Energies 2009, 2, 851-872; doi:10.3390/en20400851
OPEN ACCESS

energies
ISSN 1996-1073 www.mdpi.com/journal/energies Article

A Novel Technique to Determine Concentration-Dependent Solvent Dispersion in Vapex
Hadil Abukhalifeh, Ali Lohi and Simant Ranjan Upreti * Department of Chemical Engineering, Ryerson University, 350 Victoria Street, Toronto, Ontario, M5B 2K3, Canada; E-Mails: habukhal@ryerson.ca (H.A.); alohi@ryerson.ca (A.L.) * Author to whom correspondence should be addressed; E-Mail: supreti@ryerson.ca; Tel.: +1-416-979-5000 ext. 6344; Fax: +1-416-979-5083. Received: 1 September 2009 / Accepted: 20 September 2009 / Published: 12 October 2009

Abstract: Vapex (vapor extraction of heavy oil and bitumen) is a promising recovery technology because it consumes low energy, and is very environmentally-friendly. The dispersion of solvents into heavy oil and bitumen is a crucial transport property governing Vapex. The accurate determination of solvent dispersion in Vapex is essential to effectively predict the amount and time scale of oil recovery as well to optimize the field operations. In this work, a novel technique is developed to experimentally determine the concentration-dependent dispersion coefficient of a solvent in Vapex process. The principles of variational calculus are utilized in conjunction with a mass transfer model of the experimental Vapex process. A computational algorithm is developed to optimally compute solvent dispersion as a function of its concentration in heavy oil. The developed technique is applied to Vapex utilizing propane as a solvent. The results show that dispersion of propane is a unimodal function of its concentration in bitumen. Keywords: concentration-dependent dispersion; Vapex; propane; heavy oil and bitumen; variational calculus; mathematical modeling

1. Introduction The enormous heavy oil and bitumen deposits in the World are estimated to be approximately 6 trillion barrels [1]. Canada and Venezuela have the major parts of these resources. These huge reserves are so attractive that many attempts have been made to invent numerous schemes to recover

Energies 2009, 2

852

these heavy oil and bitumen resources. In Canada, steam-based methods are often employed to improve heavy oil recovery by reducing the viscosity of in-situ heavy oil. However, these methods are ineffective and uneconomical for reservoirs with thin pay zones, underlying bottom water, overlying gas caps, low rock conductivities, and high water saturations [2]. On the other hand, solvent based methods provide a better alternative for heavy oil recovery that can eliminate several problems associated with steam based methods such as water and energy requirements, emissions of greenhouse gases and wastewater generation [3]. Vapex is one of the most promising heavy oil solvent based recovery methods [4]. In Vapex, vaporized solvents at pressures close to dew point are injected into a heavy oil reservoir through an upper horizontal well to reduce the viscosity of the native heavy oil. The diluted oil flows to the lower horizontal well under the action of gravity. The transport mechanism involved in Vapex is dispersion, i.e. the combination of molecular diffusion of solvent into the heavy oil, and its convection under the action of gravity aided by viscosity reduction, concentration gradient, and capillary action. Live oil mobility and its convection are also influenced by the action of gravity and surface renewal [3]. Investigators had to use dispersion coefficients that are up to four orders of magnitudes higher than the diffusion coefficients in order to predict the actual production rates [5 ­8]. Solvent dispersion is the reason for the high oil production rates in porous media. The movement of solvent in a porous medium is facilitated by convection, and the mass transfer is higher than that due to diffusion alone [9]. Oil production in Vapex depends on the viscosity of live oil, i.e. the liquid phase consisting of solvent and heavy oil. This viscosity influences the movement of the live oil in the reservoir. The solvent concentration within the heavy oil depends on the thermodynamic properties of the solvent, operating conditions, and solvent dispersion in the heavy oil. According to Upreti et al. [4] accurate concentration-dependent dispersion data for solvent-heavy oil and bitumen systems are necessary to determine: 1. The amount and flow rate of solvent required to mobilize the heavy oil. 2. The extent of heavy oil and bitumen reserves that would undergo viscosity reduction. 3. The time required to mobilize the heavy oil and bitumen for drainage under gravity. 4. The production rate of live oil. A few studies exist on the determination of dispersion of various solvents used in Vapex. Boustani and Maini [10] have shown a strong concentration dependence of dispersion, as observed in the case of molecular diffusion by Upreti and Mehrotra [11,12]. Kapadia et al. [7] developed and simulated a mathematical model with a linear concentration-dependent dispersion to determine gas dispersion during the vapor extraction of Cold Lake bitumen from a rectangular block of homogeneous porous medium using butane. The dispersion coefficient was found to be four orders of magnitude higher than reported molecular diffusion. Using a linear dispersion model, El-Haj et al. [8] conducted Vapex experiments, which were simulated by a mathematical model to determine the dispersion coefficient of butane gas into Athabasca bitumen. The dispersion coefficient obtained was two to three orders of magnitude higher than molecular diffusivity reported earlier. The above findings coupled with the paucity of dispersion data in the literature make it imperative to determine the concentration-dependent dispersion for various solvents in heavy oil and bitumen. For this purpose, we have developed a new technique which is based on variational calculus. The salient

Energies 2009, 2

853

feature of this technique is that it does not impose any functional form on dispersion as a function of concentration, but allows its realistic determination. 2. Experimental Setup Figure 1 shows the schematic diagram of the experimental setup used. The setup comprises of a cylindrical pressure vessel of 55 cm height and 15 cm internal diameter inside a temperature-controlled water bath. Figure 1. Schematic diagram of the experimental setup.
to vent resistance temperature. Detector RTD1 needle thermocouple pressure transducer

propane supply

load cell

physical model water bath pressure vessel

gas measurement unit
vaccum pump flash tank RTD2

differential pressure tranducer capillary tube viscosity measurement unit

dead oil

The vessel holds the physical model of Vapex. The physical model comprises a cylindrical wire mesh filled with glass beads saturated with heavy oil. The physical model is suspended from a load cell, and kept in contact with the solvent vapor at constant pressure. The load cell records the mass of the physical model with time. The mass decreases in an experiment as live oil drains away from the model due to solvent absorption. The drained oil is directed to a calibrated 25 cm3 collection tube. The tube is connected to a viscosity measurement unit to measure the online live oil viscosity. The viscosity measurement unit comprises a 50 cm long stainless steel capillary tube of 0.1016 cm internal diameter equipped with a differential pressure transducer. The capillary tube is connected to a stainless steel flash tank of 300 cm3 capacity. The flash tank is wrapped with an electrical heating tape. The volume of propane separated from the live oil inside the flash tank is measured by a gas measurement unit. It is composed of two cylinders of respective capacities 2,600 cm3 and 2,900 cm3. A

Energies 2009, 2

854

needle thermocouple and two resistance temperature detectors respectively measure the temperature of the packed medium, propane gas, and the flash separation tank. A data acquisition system records the system properties online. 2.1. Experimental Procedure A sample of heavy oil (from Imperial oil; of 200,000 mPas viscosity, and 1 ,001 kg/m3 density at 22 ° C) was heated to 60 ° C. Glass beads of known permeability were gradually added to the heated heavy oil ensuring proper mixing without trapping air bubbles. The saturated mixture of the heavy oil and glass beads was packed into a cylindrical wire mesh of 25 cm height, and 6 cm diameter. During this operation, the mesh lay inside an ice bath to prevent the bitumen from oozing out. The cylindrical packed medium, i.e., the physical model of Vapex, of heavy oil saturated with glass beads was weighed, and left at room temperature for one day to reach thermal equilibrium prior to an experiment. Before starting an experiment, the vessel was pressurized with air and left for 24 hrs to test any leaks. The physical model was suspended from the load cell inside the pressure vessel. Research grade propane of purity 99.99% was used. The vessel was flushed with propane of about twice its volume and vacuumed to 15 mmHg. Propane was injected into the vessel at constant pressure. The injection pressure was controlled through the pressure regulator installed on the supply propane cylinder. The water bath temperature was kept 1­2 ° C higher than the dew point temperature of propane. The experiment was carried out for 5 hrs. Propane upon being injected diffused into the physical model from its exposed outer surface. The heavy oil became less viscous and began to drain and produce as live oil. The load cell recorded the decrease in the mass of the physical model every minute as the oil production continued. The live oil was collected for the measurement of viscosity and flow rate. When about 15 cm3 of live oil was collected, the oil was drained through a capillary tube into the flash tank. The propane liberated from the live oil in the flash tank was directed to the gas-measurement unit filled initially with water. The displaced volume of water determined the propane volume. The propane-free oil residual in the flash tank was weighed. The amount of live oil produced with time was recorded. Table 1 provides the experimental parameters and operating conditions. Table 1. Experimental parameters and operating conditions. Parameter permeability( ), Darcy porosity ( ) temperature,º C pressure, MPa 3. Theoretical Development The technique developed in this work relies on the mass transfer model of vapor extraction of heavy oil using a solvent. The model has an undetermined concentration-dependent dispersion function. Value 204 0.38 21 0.689

Energies 2009, 2

855

Incorporating this function in the mass transfer model, the calculated mass of oil produced should be equal to its experimental value obtained from the experiments. 3.1. Mass Transfer Model A mathematical model is developed here to describe the mass transfer process based on the vapor extraction experiments. The assumptions involved are as follows: 1. Vapex is carried out at constant temperature and pressure. 2. Solvent dispersion is along the radial direction only. 3. The velocity of the live oil along the vertical direction is governed by Darcy law in a porous medium. 4. The porous medium has uniform porosity and permeability. 5. There are no chemical reactions. 6. Any volume change results and corresponds to drainage of the live oil. 7. The heavy oil is non-volatile. The unsteady state mass balance for solvent propane over a differential element of the medium (see Figure 2) is given by

d V    A z z   A z    J f S r r    J f S r dt

(1)

where V  2 r r z is the volume of the element, A  2 r r is the area transverse to the live oil velocity  in the vertical direction, and S  2 r z is the area transverse to the dispersive flux J f in the radial direction. Figure 2. Differential element of the physical model.

v Jf
 z

z

 r
r
In Equation(1), the diffusive flux along the vertical direction is assumed insignificant in comparison with the convective flux. Assuming constant live oil density; the radial flux can be written as

J f   D

d dr

(2)

Energies 2009, 2

856

where D is the undetermined concentration-dependent dispersion coefficient of propane in the porous medium. Taking the limits of  r and  z to zero, the above equations yield the following mass transfer model:
2   2   1      D     1            r  D    rD            2   t r    r      z      z   r    r 

(3)

where (t , r, z) is the mass fraction of solvent in bitumen, which is a function of time, radius and height of the porous medium. The velocity of the live oil along the vertical direction is the Darcy velocity given by

 

KK r  g



(4)

where K r is relative permeability of the medium, K is its permeability,  is the density of live oil, g is gravity, and  is the live oil viscosity. Experimental live oil viscosity and propane solubility data were best fitted to obtain the live oil viscosity concentration-dependent model. The empirical correlation for the propane-heavy oil system during the process at the operating temperature and pressure is    0 2 with a high value of 0.982 for the r2-coefficient of determination. The live oil drainage with time reduces the height of the bitumen, Z (t, r) , in the packed medium. The change in the height with time at any radial location is given by
Z    t , r , 0  t

(5)

where  t , r ,0 is Darcy velocity at the bottom of the model at a given r . Initially there is no gas inside the packing and no production of the live oil. The initial height of the bitumen sample is Z 0 . The packing surface has the solvent gas concentration equal to its interface saturation concentration under prevailing temperature and pressure. Thus, the initial conditions at t  0 are as follows:
0,   int ,  0  z  Z 0 and 0  r  R at z  0 and   at r  R z  Z0

(6)

At all times, the entire exposed circumference and the bottom face of the cylinder is saturated with gas. The solvent ­heavy oil interface at the top moves down and the height of the bitumen, Z (r ) , decreases with time due to live oil drainage. Thus, we have a moving boundary problem which is described by Equation (5). The heavy oil at the moving interface is saturated with gas at all times. Consequently, the boundary conditions are

[t , r, Z (t )]  t , R, z   t , r,0  int

(7)

Energies 2009, 2 Because of symmetry

857

  0 at r  0 r
at all times. 3.2. The Mathematical Objective

(8)

It is desired to find the optimal dispersion function, D( ) , such that the difference between the model-calculated and experimental cumulative live oil produced is minimum. Mathematically, the objective functional can be written as
I   mc (t )  me (t ) d t
2 0 T

(9)

where I is the objective functional that needs to be minimized using the control function D  D t , r, z  ; me (t ) is the experimental cumulative mass of the live oil produced at any time t , and mc (t ) is the model cumulative predicted mass of the live oil produced at any time t . The calculated mass mc (t ) is given by
mc    2 r ( Z 0  Z )d r
0 R

(10)

Now, Equation (9) can be written as
 R  I   mc (t )  me (t ) d t     2 r ( Z 0  Z )d r  me (t ) d t 0 0 0 
T T 2 2

(11)

subject to Equation (3), which in turn can be written as

  f1  G(t , r , z )  0 t
where

(12)

f1  

  2   D    32    D       D      r 2       r    z  r  r      
Z  f 2  F (t , r )  0 t

2

(13)

and subject to Equation (5), which can be written as (14)

where

f 2   (t , r ,0)   [ (t , r ,0)]2

(15)

Equation (12) and Equation (14) are the constraints for Equation (9), and D is the control function. Equation (12) and Equation (14) are highly non-linear partial differential equations. Therefore, two

Energies 2009, 2

858

undetermined adjoint variables  (t , r , z ) and  (t , r ) are introduced into Equation (9) to yield the following unconstrained objective functional:
J  I      (t , r , z ) G (t , r , z ) d z d r dt     (t , r ) F (t , r ) d r dt
0 0 0 0 0 T RZ T R

(16)

Substituting for G(t , r, z) and F (t , r ) in the above equation yields

  3  2     D       2   D    2  J    mc (t )  me (t ) dt            d zdrdt       D  t    z  r   r    r 2       r   0 0 0 0  
T T RZ 2

(17)
 Z         [ (t , r ,0)]2 d rdt t  0 0 
T R

The minimization of J is now equivalent to the minimization of I . The variational derivative of J with respect to the optimization variable D will provide the conditions necessary for the minimum of J . 3.3. Determination of Necessary Conditions In this section, we derive the necessary conditions for the minimum of J . Consider the variation of J as follows

 J   I      (t , r , z )  G (t , r , z )d zd rdt     (t , r )  F (t , r ) d rdt
0 0 0 0 0

T RZ

T R

(18)

where

 I   2   mc  t   me  t     2  r  Zd r d t
0 T R 0

T

R

    4   r   mc  t   me  t     Zd r d t
0 0

(19)

G 

 f1 (  )  f1         t  z   

  f1  z       r

  f1  r       rr

  f1    rr   D  D    

(20)

F 

( Z )   f2 t

(21)

Substitution of Equations (19), (20), and (21) into Equation (18) yields

 J     4   r   mc  t   me  t     Zdt
0 0

T R

+   
0 0 0

T R Z

T R Z T R Z  f  (  )  f  d zd rdt       1   d zd rdt       1 t      z 0 0 0 0 0 0

  z d zd rdt 

(22)

Energies 2009, 2
T R Z  f  1  r 0 0 0 T R Z   f  d z d r d t   1  r      rr 0 0 0 T R Z   f   d z d r d t    1   D d zd rd t  rr     D   0 0 0

859

 ( Z )    d rdt     f 2 d rdt t 0 0 0 0
T R T R

Integration by parts of the second integral of the above equation yields
T R Z


0 0 0

   t

T    d zd rdt      0 d zd r        dt d zd r  t   0 0 0 0 0 R Z R Z T

(23)

The first integral on the right hand side in Equation (23) is eliminated based on the nature of the process as follows: Because the solvent mass fraction is known at t  0 , its variation is ruled out, i.e.,

 0, r, z   0

(24)

The final mass fraction of solvent in bitumen is not specified. Thus, the variation due to the mass fraction is eliminated if its multiplicative term is forced to zero, i.e.

 T , r , z   0
Substitution of Equation (24) and Equation (25) into Equation (23) results in
T RZ

(25)


0 0 0

   t

   d zd rd t         d zd rdt t  0 0 0
T RZ

(26)

Integration by parts of the fourth integral of Equation (22) yields
T RZ Z T R Z    f1    f1     f1        z d zd rdt                dz d rdt    z   0 0 z  z   z  0 0 0 0 0     

(27)

Since the solvent mass fraction in bitumen is specified for all r and t , the variation    t , r , Z   0. Hence
T RZ T R T RZ   f1    f1    f1       d z d r d t     ( t , r , 0)      z     d zd rdt         z  z  z    z  0 0 0 0 0  0 0 0

(28)

Integration by parts of the fifth integral of Equation (22) yields
T RZ R T Z    f1   R   f1   f1     d z d r d t        d r   d zdt   r             r   r r  r      0 0 0 0 0 0   0 

(29)

Since the solvent mass fraction in bitumen,  t, R, z  , is known for all z and t , the variation is zero. The mass fraction of solvent in bitumen,  t,0, z  , is not specified. Variation due to  t,0, z  is eliminated if its multiplicative term is forced to zero, i.e.

  t , 0, z   0
The above equation leads to

(30)

Energies 2009, 2
T RZ T Z R   f1    f1     d z d r d t    r    d zd rdt     r     r  r  0 0 0 0 0 0

860

(31)

T RZ

Integration by parts of the sixth integral of Equation (22) yields  f    1  rr d zd rdt      rr  0 0 0
R R        f1   R  2  f1   f1       r           d r  d zdt    2     r    r     rr rr  rr  0     0 0  0 0    T Z

(32)

Application of Equation (30) eliminates the second term on right hand side of Equation (32). To eliminate the first term on right hand side of Equation (32), the multiplicative term is forced to zero, i.e.

  t , R, z   0
The above conditions reduce Equation (32) to
T RZ T Z R  f1   2  f1   rr d zd rdt      2    d zd rdt      r  rr   rr  0 0 0 0 0 0

(33)

(34)

Integration by parts of the eight integral of Equation (22) yields
T R

  
0 0

R T     ( Z )  T d r d t   Z   Z d t     dr 0    t  t   0  0 

(35)

The first integral on right hand side in Equation (35) is eliminated as follows. The initial height of bitumen, Z 0, r  , is known, then the variation of Z 0, r  is ruled out, i.e.

 Z 0, r   0
if its multiplicative term is forced to zero, i.e.

(36)

The final height of bitumen, Z T , r  , is not specified. Variation due to the final height is eliminated

 T , r   0
Substitution of Equation (36) and Equation (37) in Equation (35) results in
T R

(37)

  
0 0

   ( Z )  d rdt      Z d rdt t  t  0 0
RT

(38)

The last integral of Equation (22) yields
T R T R   f 2     f 2 d rdt         (t , r , 0) d rdt   (t , r , 0)  0 0 0 0

(39)

Finally, substitution of Equations (26), (28), (31), (34), (38) and (39) into Equation (22) results in

Energies 2009, 2
 J     4  r  mc (t )  me (t )  
0 T R

861
 t    Z d r dt 

 0 

T RZ    f    f        1    1 t    z  z 0 0 0 

   f1    r  r

 2  2  r

 f1   rr

    d z d r dt 

   f1        z (t , r , 0)  0 0  
T R
T R Z

  f 2     (t , r , 0) d r dt   (t , r , 0)  

(40)

  f          1    D d z d r dt D   0 0 0  

At the minimum,  J given by Equation (40) should be zero. That is only possible when the variational derivative of J with respect to D is

f J   1  0 D D
subject to the following adjoint equations:
  f    f    1     1 t    z  z    f1     r  r   2  f1    2     r  rr 

(41)

(42)

  4    mc (t )  me (t ) r t

(43)

 f1   f 2       0  z  z 0    z 0

(44)

Thus, Equation (41) is the necessary condition for the minimization of J when the continuity equation, as well as the adjoint equations [Equations (42)­(44)] are satisfied. 3.4. Adjoint Equations Using Equations (13), (15), (42) and (44) we obtain
  2   3 2     D D        D  2    2 t   r  r   z  r  r 

(45)

3 [ (t , r, 0)]2


The boundary conditions for Equation (45) are

 2 [ (t , r, 0)]

(46)

Energies 2009, 2

862

(T , r, z)  0
(t,0, z)  (t, R, z)  0
The boundary condition for Equation (43) is

(47)

(48)

 (T , r)  0
4. Computational Algorithm

(49)

Since Equations (12), (14), (43) and (45) are nonlinear partial differential equations, an analytical solution is not possible. Therefore, the problem is solved numerically. Based on the necessary conditions for the minimum of J , the following computational algorithm is applied to minimize J , and determine the concentration-dependent solvent dispersion function: 1. Initialize dispersion function. 2. Simultaneously integrate the continuity equation [Equation (12)] and Equation (14), subject to the initial and boundary conditions, to obtain the values of  t , r , z  and Z t , r  for each node. 3. Calculate the objective function given by Equation (9). 4. Simultaneously integrate Equation (43) and Equation (45) backward, subject to the final boundary conditions, using stored values of  and Z to get the values of   t , r , z  and   t , r  for each grid point. 5. Improve D  using the gradient correction given by Equation (41). 6. Go to Step 2 until the improvement in J is negligible. 4.1. Implementation The gradient correction for D  was calculated as follows:

J D  (t , r , z ) 

J    2   2 D r r r

(50)

In addition, the gradient correction J D was scaled to the magnitude of current dispersion values as follows:

J DS  k    2
where 
2

JD k  JD

D ; k  1,2,..,n

(51)

is a small adjustable parameter, J DS k  is the scaled gradient correction at a specified gas

mass fraction of the dispersion function, and n is the number of specified gas mass fractions of the dispersion function. Using the scaled gradient correction, the iterative improvement in the value of D  was given by

Di 1  Di   i J DS,i

(52)

where  i is the optimal step length along the search direction in the i th iteration. The dispersion was considered to be discrete function, D  , at specified gas mass fractions between zero and the

Energies 2009, 2

863

maximum concentration of the solvent in bitumen. D  was initialized to a uniform value as high as possible without causing mc (t ) to intersect me (t ) . Equations (12), (14), (43), and (45) were finitedifferenced along r and z directions. The resulting set of ordinary differential equations written for corresponding grid points are given in Appendix A. The details of the variational derivative of J with respect to D are provided in Appendix B. With an accuracy of 10 6 in the time domain, the equations were numerically integrated using semiimplicit Bader-Deuflhard algorithm, and adaptive step size control [13]. Analytical Jacobian of Equations (12), (14), (43), and (45) was employed in the calculations. To fix the number of grid points along the r and z directions, N r and N z , the equations were integrated with increasing the number of grid points until the changes in the solution became negligible. The gradient correction in D  was applied to the dispersion using Broyden-Fletcher-Goldfarb-Shanno algorithm [14,15]. Programmed in C++ language, the developed algorithm was implemented on Itanium 2/ Intel Itanium processor (1.5 GHz, 15.9 GB of RAM) with Intel C++ compiler. The algorithm took about 20 h to converge. During the computations, cubic splines were used to interpolate D  as well as its

first and second derivatives with respect to  ; mc (t ) and me (t ) ;  t  and Z t  ; and the variational derivative J D at each specified solvent mass fraction. 5. Results and Discussion The above computational algorithm was applied to the experimental vapor extraction of heavy oil by propane. The experimental data of live oil production were used in the simulation of the developed model to determine the concentration-dependent dispersion function of propane in heavy oil. Table 2 lists the various parameters used in the simulation of the mathematical model. Table 2. Model parameters. Parameter Value 0.38 1


Kr
K , m2 R,m

2.013 10 10
0.03 0.25

Z0 , m

0 , kg/m· s
 , kg/m³

1.158 103
830

The objective function [Equation (9)] was obtained by solving Equations (A-1) to (A-26) with various values of int in the range of 0.70­0.9 and the initial uniform dispersion function D  in the range of 107  2.5 105 m2/s. In order to obtain the optimal value for propane mass fraction at the interface to solve equations, the minimum resultant objective functions were plotted against int as

Energies 2009, 2

864

shown in Figure 3. The optimal propane interface mass fraction int was found to be 0.76. The above value of int was used to determine the dispersion of propane as a function of its concentration in heavy oil. The results are presented in Figures 4­6. With int  0.76 , the application of the algorithm resulted in an iterative reduction of the objective function accompanied by a corresponding improvement in D  . The objective function decreased monotonically to the minimum as shown in Figure 4. The final optimal function D  was obtained in 29 iterations after which no further improvement was observed. The initial and final D  are plotted Figure 5. It shows that the final, optimally determined D  rises to a maximum value, and then drops toward the end. The maximum value of propane dispersion is 4.048 10 5 m2/s at the propane mass fraction of 0.336. This result is for the propane­heavy oil system at 21­22 ° C and 0.689 MPa. Figure 6 compares the experimental live oil production to the calculated one with the optimally determined propane dispersion. It is observed that the experimental and calculated live oil productions agree very well. The calculated production follows experimental production very closely during the operation time of about 60 minutes. Figure 3. Solvent interface mass fraction versus objective function.

The concentration dependence of dispersion coefficient is expected since the phenomenon of diffusivity embodied in dispersion is strongly affected by solvent concentration. The maximum in the concentration-dependent dispersion function could be explained as follows. Initially when higher concentration gradients are present in the heavy oil, the diffusion of solvent molecules is higher. It subsides later on with a gradual reduction in the concentration gradients as more and more solvent molecules penetrate the medium. When that happens, the diffusion of solvent molecules is restricted by their own abundance, thus decreasing the overall dispersion. Thus, at some intermediate stage, the diffusion coefficient is at its maximum. It has to be noted that we did not specify, or constrain the form of concentration-dependent dispersion function, but enabled its natural and realistic determination. In comparison to the molecular diffusion coefficient of propane in heavy oil [16­18], the average dispersion coefficient obtained in this work is up to four orders of magnitude higher, and underscores the strong effect of gravity-induced convection in Vapex.

Energies 2009, 2 Figure 4. Objective function versus iteration.

865

Figure 5. Dispersion coefficient of propane in heavy oil at 21 ° C and 0.689 MPa (diamond: the final, optimal dispersion coefficient, square: initial guess)

The above outcome has a direct bearing on the optimal operations of Vapex implementations. For example, to maximize solvent uptake by the reservoir and oil production as a consequence, solvent injection rates should be such that the average solvent mass fraction in the reservoir (at 21­22 ° C and 0.689 MPa) is close to the optimal solvent mass fraction (0.336) corresponding to the peak value of dispersion ( 4.048 10 5 m2/s; about twice the average value of dispersion). Hence, in addition to enabling more accurate reservoir simulations, the concentration-dependent dispersion function provide insights into optimizing Vapex operations as well.

Energies 2009, 2 Figure 6. Experimental and calculated mass of live oil produced with time (diamond: experimental mass, line: calculated mass).

866

6. Conclusions A new technique was developed for the determination of concentration-dependent solvent dispersion in heavy oil. This technique was used to determine the dispersion coefficient of propane in heavy oil. The necessary conditions were derived for the match of the experimental cumulative oil produced with cumulative oil produced calculated from a Vapex mass transfer model. A computational algorithm was implemented to optimally compute dispersion coefficient as a function of the solvent mass fraction in heavy oil. The dispersion coefficient of propane in heavy oil was found to be a unimodal function of its mass fraction in heavy oil. The framework of optimal control, and the computational algorithm developed in this work could be applied to determine the concentration-dependent dispersion of other solvents used in the recovery of heavy oil and bitumen. Dispersion data will enable engineers to optimize oil production by operating Vapex close to the optimal solvent concentration corresponding to peak solvent dispersion. Acknowledgments The financial support of the Natural Sciences and Engineering Research Council of Canada (NSERC), the Ontario Graduate Scholarships (OGS), and the Department of Chemical Engineering at Ryerson University is gratefully acknowledged. Nomenclature

A area, m2 D dispersion coefficient of solvent in medium, m² /s g gravity, m/s²

Energies 2009, 2

867

I J
Jf

objective functional defined by Equation (9) augmented objective functional defined by Equation (11) dispersive flux of solvent in the medium along the radial direction, kg/m2· s

K permeability of the medium, m2 K r relative permeability of the medium m c calculated mass of the produced live oil, kg

m e experimental mass of the produced live oil, kg
distance along the radial direction, m R radius of cylindrical medium, m S surface area, m2 t time, s V volume of a finite element in the medium, m3 v Darcy velocity, m/s z distance along the vertical direction, m Z bitumen height in the medium at a given r and t , m Z0 initial height, cm Greek Symbols
r

    0 

porosity of the medium adjoint variable defined by Equation (43) adjoint variable defined by Equation (45) viscosity of the live oil, kg/m.s viscosity coefficient of the live oil, kg/m· s density of the live oil, kg/m³

 mass fraction of solvent in bitumen int mass fraction of solvent at the solvent­heavy oil interface

Appendix A Here we present the ordinary differential equations obtained after finite-differencing the mathematical model [Equations (3) and (5)], and the adjoint equations [Equations (45) and (43)]. A.1. The Mathematical Model For intermediate grid points, i.e., for 0  i   N r  1 and j   N z  1

d i , j dt

 1  i 1, j   i 1, j  i 1, j  2 i , j   i 1, j   D   2r r 2  ri  K r Kg cos  2   i , j 1   i , j 1  D   i 1, j   i 1, j   i, j    3    2r   2z i 0   
2

(A-1)

For axial grid points, i.e.,

Energies 2009, 2 a. for i  0 and 0  j   N z  1
d 0 , j dt  3 K r Kg cos 

868

 0

2 0 ,j 

  0 , j 1   0 , j 1   2z 0  

(A-2)

b. for i  0 and j  0

d 0 , 0 dt

 3

K r Kg cos 

 0

2 0 ,0 

  0 ,1   int    2z 0 

(A-3)

c. for i  0 and j   N z  1

d 0, N z 1 dt

 3

K r Kg cos 

 0

2 0 ,N

z 1

  int   0, N z  2    2z 0  

(A-4)

For the right most grid points, i.e., a. for i  ( Nr  1) and j  0
d N r 1, 0 dt  1 int   N r  2, 0 int  2 N r 1, 0   N r  2, 0   D   2 r 2  r  r   N  1  r    N r 1,1  int  D  int   N r  2, 0  K r Kg cos 2  3   N r 1, 0      2r 0  2z N r 1    
2

(A-5)

b. for i  ( Nr  1) and 0 < j  ( Nz  1)

d N r 1 , j dt

 1 int   N r  2 , j int  2 N r 1 , j   N r  2 , j   D   2r r 2  rN r 1    D    N r 1 , j 1   N r 1 , j 1   int   N r  2 , j  K r Kg cos  2  3   N r 1 , j    2r 0 2  z     N  1 r  
2

(A-6)

c. for i  ( Nr  1) and j  ( Nz  1)

d N r 1, N z 1 dt

 1 int   N r  2, N z 1 int  2 N r 1, N z 1   N r  2, N z 1   D   2r r 2  rN r 1   
2

 int   N r 1, N z  2  D  int   N r  2, N z 1  K r Kg cos 2  3   N r 1, N z 1      2r 0 2  z    N  1 r  
For the lower most intermediate grid points, i.e. for 0  i  ( Nr  1) and j  0

(A-7)

Energies 2009, 2

869

d i , 0 dt

 1  i 1, 0   i 1, 0  i 1, 0  2 i , 0   i 1, 0   D   2 r 2  r  r  i  K r Kg cos  2   i ,1   int  D   i 1, 0   i 1, 0   3  i ,0       2r    2z N r 1   0  
2

(A-8)

For the upper most intermediate grid points, i.e., for 0  i  ( Nr  1) and j  ( Nz  1)

i , N z 1 t

 1 i 1, N z 1  I 1, N z 1 i 1, N z 1  2i , N z 1  i 1, N z 1   D   2r r 2  ri  D  i 1, N z 1  i 1, N z 1  K r Kg cos 2  int  i , N z  2  i , N z 1     3   2r   2zi  0  
2

(A-9)

The change in height for 0  i  ( N r  1) is given by

dZi K Kg cos  i ,0  i 1,0  2int   vi   r   dt 0 4  

2

(A-10)

dZ N r 1 dt

 v N r 1

K Kg cos    N r 1,0  3 int   r   0 4  

2

(A-11)

A.2. The Adjoint Equations For intermediate grid points, i.e., for 0  i   N r  1 and j   N z  1

d i , j dt

 1  i 1, j   i 1, j  i 1, j  2 i , j   i 1, j   D   2r r 2  ri   i, j  K Kg cos  2   i , j 1   i , j 1  D 2   3 r i, j     2z i r 0    i 

(A-12)

For axial grid points, i.e., i  0 and 0  j   N z  1

d0, 0 dt
For the right most grid points, i.e., a. for i  ( Nr  1) and j  0



d0, j dt



d0, N z 1 dt

0

(A-13)

d N r 1, 0 dt

 1   N r  2, 0  2 N r 1, 0   N r  2, 0   D   2 r 2  r  r  N r 1      N 1, 0    N r 1,1  K r Kg cos  2 D 2 r  N r 1, 0   3   0  2z N r 1, 0    rN r 1, 0    

(A-14)

Energies 2009, 2 b. for i  ( Nr  1) and 0<j  ( Nz  1)

870

d N r 1, j dt

 1   N r  2, j  2 N r 1, j   N r  2, j   D   2 r 2  r  r  N r 1      N 1, j    N 1, j   N r 1, j 1  K r Kg cos  2 D  2r  N r 1, j  r  3   0 2z N r 1    rN r 1       1   N r  2, N z 1  2 N r 1, N z 1   N r  2, N z 1   D   2 r 2  r  r   N  1  r    N 1, N 1     N r 1, N z  2  K Kg cos  2 D r 2 z   3 r  N r 1, N z 1     2  z r     0 N  1 N  1 r   r  
 1  i 1, 0   i 1, 0  i 1, 0  2 i , 0   i 1, 0   D   2r r 2  ri   i ,0  K Kg cos  2   i ,1  D 2   3 r  i ,0    0  2z i   ri 

(A-15)

c. for i  ( Nr  1) and j  ( Nz  1)

d N r 1, N z 1 dt

(A-16)

For the lower most intermediate grid points, i.e., for 0  i  ( Nr  1) and j  0
d i , 0 dt

(A-17)

For the upper most intermediate grid points, i.e., for 0  i  ( Nr  1) and j  ( Nz  1)

d i , N z 1 dt

 1  i 1, N z 1   i 1, N z 1  i 1, N z 1  2 i , N z 1   i 1, N z 1   D   2r r 2  ri    i , N z 1    i, N z  2  K r Kg cos  2 D  3    i , N z 1  2  0  ri   2z i 

(A-18)

The equations for the second adjoint variable are

d i  4   ri 1[mc (t )  me (t )], 0  i  ( N r  1) dt
Appendix B

(A-19)

0  i   N r  1 and j   N z  1

Here we present the variational derivative of dispersion. For intermediate grid points, i.e., for
 1  i 1, j   i 1, j    i 1, j  2 i , j   i 1, j   J      i , j    i , j   2r r 2  D  i , j    ri 

(B-1)

For axial grid points, i.e., i  0 and 0  j   N z  1

 J   J   J  0        D  0, 0  D  0, j  D  0, N z 1

(B-2)

Energies 2009, 2 For the right most grid points, i.e. a. for i  ( Nr  1) and j  0
 1 int  i  2, 0   int  2 N r 1, 0   N r  2, 0   J    N r 1, 0       N r 1, 0   2r r 2  D  N r 1, 0  rN r 1     

871

(B-3)

b. for i  ( Nr  1) and 0<j  ( Nz  1)
 1 int   N r 2, j   int  2 N r 1, j   N r  2, j   J    N r 1, j       N r 1, j   2r r 2  D  N r 1, j      rN r 1 

(B-4)

c. for i  ( Nr  1) and j  ( Nz  1)

 1 int  Nr  2, Nz 1   J      N r 1, N z 1    r 2  r  D  Nr 1, Nz 1   N  1  r   int  2 Nr 1, Nz 1   Nr  2, Nz 1   Nr 1, Nz 1   r 2  
For the lower most intermediate grid points, i.e., for 0  i  ( Nr  1) and j  0
 1  i 1, 0   i 1, 0    i 1, 0  2 i , 0   i 1, 0   J      i , 0    i , 0   2r r 2  D  i , 0    ri 

(B-5)

(B-6)

For the upper most intermediate grid points, i.e., for 0  i  ( N r  1) and j  ( N z  1)
 1 i 1,i , N z 1  i 1,i , N z 1   J   i ,i , Nz 1     2r  D i , N z 1  ri   i 1,i , N z 1  2i , N z 1  i 1,i , N z 1   i ,i , N z 1   r 2  

(B-7)

References 1. Meyer, R.F.; Attanasi, E.D.; Freeman, P.A. Heavy oil and natural bitumen resources in geological basins of the world. U.S. Geological Survey Open-File Report, 2007-1084. Available online: http://pubs.usgs.gov/of/2007/1084/(accessed March 22, 2009). Yazdani, J.A.; Maini, B.B. Effect of drainage height and grain size on the convective dispersion in the Vapex process: experimental study. Paper SPE 89409, SPE/DOE Symposium on Improved Oil Recovery, Tulsa, OK, USA, April 17­21, 2004. Das, S.K.; Butler, R.M. Mechanism of the vapor extraction process for heavy oil and bitumen. J. Pet. Sc. Eng. 1998, 21, 43­59. Upreti, S.R.; Lohi, A.; Kapadia, R.; El-Haj, R. Vapor extraction of heavy oil and bitumen: A review. Energ. Fuel. 2007, 21, 1562­1574. Dunn, S.G.; Nenniger, E.H.; Rajan, V.S.V. A study of bitumen recovery by gravity drainage using low temperature soluble gas injection. Can. J. Chem. Eng. 1989, 67, 978­991.

2.

3. 4. 5.

Energies 2009, 2 6. 7. 8. 9. 10. 11. 12. 13.

872

14. 15. 16. 17. 18.

Oduntan, A.R. Heavy oil recovery using the VAPEX process: Scale-up and mass transfer issues. Master's thesis, University of Waterloo: Waterloo, Canada, 2001. Kapadia, R.; Upreti, S.R.; Lohi, A.; Chatzis, I. Determination of gas dispersion in vapor extraction of heavy oil and bitumen. J. Pet. Sc. Eng. 2006, 51, 214­222. El-Haj, R.; Lohi, A.; Upreti, S.R. Experimental determination of butane dispersion in vapor extraction of heavy oil and bitumen. J. Pet. Sc. Eng. 2009, 67, 41­47. Perkins, T.K.; Johnston, O.C. A review of diffusion and dispersion in porous media. SPE J. 1963, 3, 70­84. Boustani, A.; Maini, B.B. The role of diffusion and convective dispersion in vapor extraction process. J. Can. Pet. Tech. 2001, 40, 68­77. Upreti, S.R.; Mehrotra, A.K. Experimental measurement of gas diffusivity in bitumen: Results for carbon dioxide. Ind. Eng. Chem. Res. 2000, 39, 1080­1087. Upreti, S.R.; Mehrotra, A.K. Diffusivity of CO2, CH4, C2 H6 and N2 in Athabasca Bitumen. Can. J. Chem. Eng. 2002, 80, 116­125. Press, W.H.; Teukolsky, S.A.; Vetterling, W.T.; Flannery, B.P. Numerical recipes in C++. The Art of Scientific Computing, 2nd ed.; Cambridge University Press: New York, NY, USA, 2002; pp. 719­727. Jacobs, D.A.H. The State of the Art in Numerical Analysis; Academic Press: London, UK, 1977; Chapter III.1, pp. 3­6. Dennis, J.E.; Schnabel, R.B. Numerical Methods for Unconstrained Optimization and Non-Linear Equations; S.I.A.M.(reprinted 1996): Philadelphia, PA, USA, 1983. Das, S.K.; Butler, R.M. Diffusion coefficients of propane and butane in Peace River Bitumen. Can. J. Chem. Eng. 1996, 74, 985­992. Ramakrishnan,V. In-situ Recovery of Heavy Oil by Vapex Using Propane. Master's thesis, University of Waterloo: Waterloo, Canada, 2003. Luo, P.; Yang, C.; Gu, Y. Enhanced solvent dissolution into in-situ upgraded heavy oil under different pressures. Fluid. Phase. Equilibria 2007, 252, 143­151.

© 2009 by the authors; licensee Molecular Diversity Preservation International, Basel, Switzerland. This article is an open-access article distributed under the terms and conditions of the Creative Commons Attribution license (http://creativecommons.org/licenses/by/3.0/).

