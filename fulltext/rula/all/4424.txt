Sensors 2014, 14, 24305-24328; doi:10.3390/s141224305

sensors
ISSN 1424-8220 www.mdpi.com/journal/sensors Article

OPEN ACCESS

Effective Low-Power Wearable Wireless Surface EMG Sensor Design Based on Analog-Compressed Sensing
Mohammadreza Balouchestani * and Sridhar Krishnan Electrical and Computer Engineering Department, Ryerson University, 350 Victoria Street, Toronto, ON M5B2K3, Canada; E-Mail: krishnan@ryerson.ca * Author to whom correspondence should be addressed; E-Mail: mbalouch@ryerson.ca; Tel.: +1-416-490-6603. External Editor: Nauman Aslam Received: 11 October 2014; in revised form: 29 November 2014 / Accepted: 5 December 2014 / Published: 17 December 2014

Abstract: Surface Electromyography (sEMG) is a non-invasive measurement process that does not involve tools and instruments to break the skin or physically enter the body to investigate and evaluate the muscular activities produced by skeletal muscles. The main drawbacks of existing sEMG systems are: (1) they are not able to provide real-time monitoring; (2) they suffer from long processing time and low speed; (3) they are not effective for wireless healthcare systems because they consume huge power. In this work, we present an analog-based Compressed Sensing (CS) architecture, which consists of three novel algorithms for design and implementation of wearable wireless sEMG bio-sensor. At the transmitter side, two new algorithms are presented in order to apply the analog-CS theory before Analog to Digital Converter (ADC). At the receiver side, a robust reconstruction algorithm based on a combination of 1 - 1 -optimization and Block Sparse Bayesian Learning (BSBL) framework is presented to reconstruct the original bio-signals from the compressed bio-signals. The proposed architecture allows reducing the sampling rate to 25% of Nyquist Rate (NR). In addition, the proposed architecture reduces the power consumption to 40%, Percentage Residual Difference (PRD) to 24%, Root Mean Squared Error (RMSE) to 2%, and the computation time from 22 s to 9.01 s, which provide good background for establishing wearable wireless healthcare systems. The proposed architecture achieves robust performance in low Signal-to-Noise Ratio (SNR) for the reconstruction process.

Sensors 2014, 14 Keywords: sEMG bio-signal; reconstruction process; sparsity compressed sensing;

24306 random sensing dictionary;

1. Introduction Today's healthcare systems are effective for an individual measurement from the human body, but are not integrated into comprehensive Body Area Networks (BANs), wherein simultaneous biomedical sensors work on a test subject. Furthermore, there is a need for increasing patient mobility because in many cases biomedical sensors for medical monitoring are not wireless yet [1]. This creates the need for the implementation of new wireless healthcare systems with a common architecture and the capacity to handle multiple wearable wireless bio-sensors, monitoring different body signals, with different requirements. Using wireless healthcare systems based on low-power wearable wireless bio-sensors has two aspects [1]. Firstly the use of new wireless technological solutions enables individually based, multi-parameter monitoring at home. Thus patients with chronic diseases, as well as a constantly growing number of seniors, will profit from treatment and medical monitoring at home or workplace. Moreover, unlimited mobility implies the use of wireless and even implanted bio-sensors, which greatly enhance home monitoring and follow-up of medical conditions. The second aspect emphasizes with increasing the efficiency of treatments at hospital and medical centers. The rising healthcare costs also make it an urgent need to develop ambulatory systems to reduce hospital visits. Therefore, it is necessary to design portable, low power, low sampling rate, and high-performance wireless health care systems that deliver healthcare services at any location 24/7. The sEMG method is a non-invasive and convenient procedure to record signal and machine-based estimation of force of muscle contraction or for assessing muscle fatigue with large number of rehabilitation and other applications such as myoelectric control, sensors placement, fatigue detection, and voice recognition [2]. Existing sEMG systems are based on wired/fixed sensors, and they suffer of long processing time, low speed, limited mobility, high cost, and large size [3,4]. These limits create real need for the implementation of new wearable wireless sEMG sensors that deliver healthcare services anywhere at any time [5]. The sEMG bio-signals can be processed to detect medical abnormalities or to analyze the biomechanics of the human or animal movement [6,7]. There are three important features in the sEMG bio-signals, i.e., amplitude (ranging from 1 µV to 50 mV), frequency, and phase. The sEMG signals exhibit good level of sparsity in the time and frequency domains [7]. The existing and conventional data acquisition approaches have traditionally relied on the Shannon sampling theorem [7]. This theory says a signal must be sampled at least twice its bandwidth in order to be represented without error. The traditional approaches have two major drawbacks. Firstly, they generate huge intolerable number of samples for many applications with a large bandwidth. Secondly, even for low signal bandwidths, including some biomedical signals, they produce a large amount of redundant digital samples. That is why it is desirable to reduce the number of acquired samples by utilizing sparsity. Compressive sampling (CS) is a random data acquisition procedure that requires only a few incoherent random linear measurements to compress signals that are sparse in some domain [7]. The CS theory is an optimal solution for this purpose. Specifically, the application of analog-CS before the ADC achieves

Sensors 2014, 14

24307

compression of the data with a proportionate savings in energy. After an exhaustive search, we did not find any new study that aims at an effective random sampling rate data acquisition algorithm for wireless sEMG systems. This paper aims to apply analog-CS theory to establish low power and low sampling rate algorithms for a wearable wireless sEMG sensor for long-term recording of sEMG signals, which is a very useful tool for detection of various pathologies. This work is novel in four aspects: (1) compressing sEMG bio-signal at the sensing step before ADC; (2) digitalizing only compressed sEMG bio-signal; (3) transmitting the sEMG bio-data only when a significant event is detected; (4) reducing the number of bits transmitted to minimize the average radio power while maintaining the captured signal information. In this paper, we firstly apply the analog-CS theory as a new and random data acquisition procedure to the transmitter side before ADC in order to compress analog input signal. Secondly, we apply the Sensing Matrix Selection (SMS) method at the transmitter side in order to determine the best fit for random sensing matrix in the CS scenario. Thirdly, the reconstruction algorithm based on the contribution of 1 - 1 -optimization and BSBL framework is applied to the receiver side in order to recover the original sEMG bio-signals. The proposed architecture allows reducing the sampling rate to 25% of NR. In addition, the proposed architecture reduces the power consumption to 40%, PRD to 24%, RMSE to 2%, and the computation time from 22 s to 9.01 s, which provide good backgrounds for providing low sampling rate wireless healthcare services. Furthermore, the proposed architecture achieves robust performance in low SNR for the reconstruction algorithm. The proposed algorithms are created by C, HSPICE, and MATLAB/Simulink toolboxes. The proposed algorithms are tested over several hours of clinical sEMG bio-signals from the following databases: (1) PhysioNet (PhysioBank ATM) [8]; (2) EMG Bank [9]; (3) EMG project lab [10]. The structure of this paper is organized as follows: In Section II, an overview about CS theory as a random data acquisition method is presented. In Section III, the proposed system architecture and our novel algorithms for the transmitter and receiver sides of wireless sEMG sensor are presented. In Section IV, the results on sampling rate, power consumption, computation time, and reconstruction process are illustrated. The conclusion is given in Section V and future works are discussed in Section VI. 2. Overview of Compressed Sensing Theory The need for compression of sEMG bio-signals arises in the following areas: (1) large sEMG database in the hospital; (2) long-term sEMG recording; (3) ambulatory (24 h) monitoring of sEMG bio-signals; (4) limits on hardware memory and delay; (5) establishing ultra low power and low sampling rate wireless healthcare sEMG systems [11­13]. The existing compression techniques rely on the Shannon sampling theorem and have two major drawbacks. Firstly, they generate large number of samples for many applications with a large bandwidth. Secondly, even for the bio-signals with low bandwidth, they produce a large amount of redundant digital samples. Table 1 compares the existing and random data acquisition methods based on the CS theory in terms of sampling frequency (fs ), sampling rate, Compression Ratio (CR), and distortion degree [14]. Highlighted in Table 1 are the lower values for sampling rate and higher values for CR obtained by the analog-CS theory. The CS theory is a mathematical framework in acquiring and recovering for sparse signals with the help of an incoherent projecting basis that provides insight into how a high resolution

Sensors 2014, 14

24308

dataset can be inferred from a relatively small and random number of measurements using simple random linear process. The basic idea of the CS theory as a new and random sampling approach is that when the biomedical signal is sparse or nearly sparse in terms of the number of non-zero coefficients, relatively few well-chosen observations suffice to reconstruct the original signal. In fact, CS is a new approach for the acquisition and recovery of sparse or compressive biomedical signals significantly below the classical Nyquist rate. Any signal can be expressed as [15]:
N

D=
i=1

(Si i )

(1)

where S is the coefficient vector for D under the basis  = [1 , 2 , ..., N ]. If D has the most compact representation in , then D can be compressed in the proper basis [16]. The CS theory also proposes that rather than acquiring the entire signal and then performing compression, it should be possible to capture only a part of the signal's useful information. In the CS theory, we have a M × N measurement matrix  and biomedical signal D with N × 1 dimension such that M N ; therefore, the compressed signal C can be expressed as [17]: [C ]M ×1 = []M ×N [D]N ×1 (2) The original signals can be exactly reconstructed, with a high level of accuracy and probability via norm by solving the following convex optimization problem [18]: min D
1 1

s.t C = D

(3)

where D 1 is defined as D 1 = n Dn with D  N . However, certain conditions must be met to guarantee the accuracy of the reconstruction process [19,20]. Table 1. Compression techniques.
Technique Existing methods CS method Sampling Rate 2fs fs /CR Distortion Medium Low CR Medium High

2.1. Digital and Analog-CS Scenarios The applications of wireless and wearable healthcare systems are constrained by the available energy, which imposes strict energy requirements on the bio-sensor circuits. That is why the following items are important to minimize power consumption: (1) compress bio-signal at the sensing step; (2) digitize only compressed bio-signal; (3) transmit data only when a significant event is detected; (4) reduce the number of bits transmitted to minimize the average radio power while maintaining the captured bio-signal information. Most of the power (78%) of the total power in an sEMG bio-sensor is dissipated in the transmitter side [21]. Therefore, there is a real need to decrease the amount of data to be transmitted and reduce the duty cycle of the transmitter to establish ultralow power bio-sensors. The analog-CS theory is an optimal solution that achieves significant improvements in minimizing sampling load as well as power consumption. Figure 1 shows the difference between analog-CS and digital-CS scenarios.

Sensors 2014, 14 Figure 1. CS scenarios: (A) Digital (B) Analog.

24309

It can be seen in Figure 1 that the analog-CS scenario is based on Random demodulation (RD) using Gilbert multiplier [22]. This scenario consists of the following steps. (1) The analog bio-signal multiplies with the random sensing matrix  based on Gilbert approach [22,23]; (2) The output signal of multiplier goes to an active integrator; (3) The M × 1 dimension compressed version of the input bio-signal is generated at the transmitter side. Therefore, in the analog-CS scenario at the transmitter side, the input analog sEMG bio-signal [D]N ×1 is compressed to output analog bio-signal [C ]M ×1 such that M N and then, the ADC needs to digitize a smaller amount of data [24,25]. In the wireless sEMG systems, real-time sEMG bio-data is transmitted to a personal base station (e.g., a smart-phone, personal computer, or any portable device) and then transmitted to hospital, medical centers, and healthcare provider via the Internet. 3. The Proposed System Architecture Figure 2 illustrates the proposed block diagrams based on the analog-CS theory for the transmitter and receiver sides of an ultralow power wireless sEMG sensor. The transmitter side consists of the following parts: (1) sEMG amplifier including Low Noise Amplifier (LNA) and Variable Gain Amplifier (VGA) with variable gain in 60­80 dB for frequency range from 15 Hz to 1 kHz [26,27] (in our work, MD3880 for VGA and INA329 for LNA have been used); (2) an Analog-Front-End (AFE) (in our work, ADS1298 has been used); (3) an analog-CS step based on two proposed algorithms; (4) 16 bits ADC to digitize the analog compressed sEMG; (5) the transmitter to send the compressed bio-signals via wireless networks to the receiver (in our work the TeleMyo 2400T G2 Transmitter at a sampling rate of 1500 samples per second has been used). The suitable CR level of a raw sEMG bio-signal for diagnosis and treatment purposes is between 10 and 30, which requires a resolution of 8­12 bits [28]. (In our work, CR = 25 with 10-bits resolution has been adopted). On the other hand, to control the CR level, the sparsity

Sensors 2014, 14

24310

level of the bio-signal can be adjusted by applying a robust dynamic thresholding approach to the input signal [29]. We use the dynamic approaches based on the following steps: (1) the DC level of the bio-signal computes a sliding average over a window of length w (w has selected between 5 and 10 in our work); (2) set the threshold level as a fraction of the peak-to-peak amplitude; (3) control sparsity level by careful selection of the sparsifying domain [30]. At the receiver side, the original bio-signal is reconstructed by applying a robust reconstruction algorithm based on a contribution of 1 - 1 -optimization and BSBL framework for diagnostic and treatment purposes. Figure 2. The proposed system architecture (A) Transmitter (B) Receiver.

4. The Proposed Algorithms Three new algorithms for the transmitter and receiver sides are presented. The purpose of Algorithms I and II is to generate analog compressed sEMG bio-signal at the transmitter side. The main objective of Algorithm III is to recover the original sEMG bio-signal from the compressed bio-signal at the receiver side. 4.1. Transmitter Algorithms The fundamental purpose of Algorithm I is to generate the analog compressed sEMG bio-signal based on random sensing dictionary  obtained from the SMS method in Algorithm II. This Algorithm consists

Sensors 2014, 14

24311

of the following steps: (1) get the random sensing matrix  from Algorithm II [30]; (2) examine the Restricted Isometry Property (RIP) for the selected matrix; (3) calculate the sparsity level; (4) generate the compressed bio-signal. The flowchart of Algorithm II is shown in Figure 3. The main objective of Algorithm II is to select the best candidate for the random sensing matrix  in the CS scenario to ensure high accuracy in the reconstruction process. This algorithm comprises of the following steps. (1) Apply dynamic thresholding to the raw sEMG bio-signal; (2) Select the initial square matrix; (3) Employ the row selection scheme [31]; (4) Generate sparse coding based on Orthogonal Matching Pursuit (OMP) [32]; (5) Update the initial matrix; (6) Compare the updated matrix with the Binary Toeplitz (BT) matrix [33]; (7) Verify the incoherence degree between the updated matrix and the sparsity bases; (8) Nominate the best candidate for the random sensing matrix  in order to generate the compressed analog bio-signal at the transmitter side of the wearable wireless sEMG sensor. Tables 2 and 3 show the pseudo-codes for Algorithms I and II, which are applied to the transmitter side of sEMG sensor. Figure 3. Flowchart for Algorithm II.

Sensors 2014, 14 Table 2. Algorithm I: compressed sEMG bio-signal.
Input: sEMG bio-signal [D]N ×1 , Sparsity matrix []N ×N , Random matrix []M ×N , Threshold Value (TV) Step 1. 2. 3. 4. 5. 6. 7. 8. 9. 10. 11. 12. 13. 14. Output: Compressed bio-signla [C ]M ×1

24312

Process If [] has RIP Property else P = 0.01 While [] not RIP Property P = P + 0.2 end While Calculate Sparsity level (SP ) = (N/N - K ) If SP  0.98 , M Klog (N/M ) else While SP  0.98 T V = T V + 0.01 end While end Generate compressed bio-signal [C ]M ×1

Table 3. Algorithm II: sensing matrix [].
Input: Raw sEMG bio-signal [D]N ×1 Sparsity matrix []N ×N Step 1. 2. 3. 4. 5. 6. 7. 8. Output: Random sensing matrix [] Process Apply dynamic thresholding approach Select initial square matrix Apply row selection scheme Determine sparse coding based on OMP Update selected dictionary based on SVD Compare with Binary Topeltiz (BT) matrix Verify the incoherence degree with [] Nominate the selected dictionary as []

4.2. Receiver Algorithm The main objective of the robust reconstruction algorithm based on a combination of 1 - 1 -optimization and BSBL framework is to recover the original bio-signal from the compressed bio-signal at the receiver side. Based on the sparsity level of the sEMG signal, the reconstruction process at the receiver side could be selected as either 1 -optimization or 1 - 1 -optimization and BSBL framework in order to reconstruct the received bio-signal with high probability and enough accuracy [34].

Sensors 2014, 14

24313

The 1 - 1 -optimization is applied to the received sEMG-neuropathy signals, which are sparse in the frequency domain as [34]: min( D
1

+ |F D 1 ) s.t.

C - D

2


1 - 1 -optimization

(4) idea

where  is a positive constant and F is a N × N Fourier transform matrix. The comes from multi- 1 -optimization, which can expressed as [34,35]:
N

min(
i=1

(i i D 1 ) s.t.

C - D

2



(5)

where i is a positive constant. In the frequency domain  is changed to F , which is an N × N Fourier transform matrix. In another scenario, if the transmitter receives sEMG-healthy or sEMG-myopathy signals that are sparse in the time domain, the 1 -optimization is applied to the received bio-signal in order to reconstruct the original bio-signal. The 1 -optimization is defined as [35]: min( D 1 ) s.t. C - D Table 4 shows the pseudo-code for Algorithms III. Table 4. Algorithm III: robust reconstruction process.
Input: Raw sEMG bio-signal [D]N ×1 , Sparsity matrix []N ×N , Random matrix []M ×N Step 1. 2. 3. 4. 5. 6. 7. 8. 9. 10. 11. 12. 13. 14. 15. 14. Output: Reconstructed sEMG bio-signal
2



(6)

Process If [D] is sparse in time or frequency If [D] is sEMG-Neuropathy signal P = 0.01 Apply 1 -optimization by min D 1 s.t C = D Determine reconstructed bio-signal endif elseif [D] is sEMG-Healthy or sEMG-Myopathy Apply 1 - 1 -optimization If SP  0.98 , M Klog (N/M ) Determine reconstructed bio-signal endif elseif [D] is sparse in tems of K non-zero blocks Calculate hyper parameters (,  ) Obtain 0 = diag (,  ) Initial estimation of [D] N (0, 0 ) Apply MAP approach Determine reconstructed bio-signal endif end

In the last scenario, the BSBL framework is applied to the received bio-signals that are not sparse in the time or frequency domains but are sparse in terms of non-zero blocks. This framework divides

Sensors 2014, 14

24314

the non-sparse bio-signal into a set of non-overlapping blocks with a few non-zero blocks [36]. By employing this framework, a non-sparse signal can be partitioned into a concatenation of non-overlapping blocks of which only a few blocks are non-zero [37]. Therefore, the main structure of this framework is to explore and exploit the intra-block-correlation in terms of entry values within each block [38,39]. The flowchart of Algorithm III is shown in Figure 4. This framework consists of the following steps [40,41]. (1) Define the input bio-signal into a set of non-overlapping blocks with only non-zero blocks and mutually uncorrelated to each other; (2) Determine the Gaussian distribution property for each non-zero block with two hyperparameters that can control the block-sparsity level; (3) Estimate the posterior of the original bio-signal by applying the Maximum-A-Posteriori (MAP) approach [42­44]; (4) Update the initial original bio-signal by applying two learning rules for hyperparameters based on Auto-Regressive (AR) method [45,46]. Figure 4. Flowchart for Algorithm III.

As a result, the reconstruction algorithm at the receiver side consists of the following steps. (1) Check the sparsity in terms of either the number of non-zero coefficients in the time or frequency domains or the number of non-zero blocks; (2) Apply 1 -optimization for healthy and myopathy bio-signals (as they are sparse in the frequency domain) and 1 - 1 -optimization for neuropathy bio-signals; (3) Apply BSBL framework for sparsity in terms of number of non-zero blocks. Figure 5 illustrates four types of sEMG signals with the length of N = 350 to 500 and the average computing time is equal to 15.26 s.

Sensors 2014, 14 Figure 5. Healthy, neuropathy and myopathy sEMG signals.

24315

5. Simulation Results For the simulation results, several hours of sEMG bio-signals that are sparse in time or frequency domains are selected from the following databases: (1) PhysioNet (PhysioBank ATM including EMG-healthy, EMG-myopathy, and EMG-neuropathy bio-signals and annotations) [8]; (2) EMG Bank [9]; (3) EMG project lab [10]. For simulation results, the following assumptions have been made. (1) The Analog-CS approach was performed using 250 × 1024 BT matrix ; (2) Length of window for dynamic thresholding is chosen between 5 and 10; (3) The sEMG healthy (H), neuropathy (N), and myopathy (M) signals with 1024 samples dynamically threshold at 10% to control the sparsity level; (4) CR = 25% with 10 bits of resolution. Table 5 depicts a comparison on the analog-CS and the digital-CS in terms of sensitivity (SEN) and specificity (SPE). The SEN and SPE are calculated by the following equations [35]: SEN = TP /(TP + TN ), SP E = TN /(TN + FP ) where TP is true positive, TN true negative, FP is false positive, and FN is false negative. Table 5. Comparison of analog-CS and digital-CS.
Algorithm Proposed analog-CS (Transmitter) Current digital-CS (Transmitter) Proposed analog-CS (Receiver) Current digital-CS (Receiver) SEN. % 99.9 87.2 99.2 84.2 SPE. % 98.2 86.2 97.2 85.6

(7)

It should be noted that the proposed analog-CS algorithm shows very high SEN and SPE compared with current digital-CS. Figure 6 compares the quality of reconstruction process with Fs = 2 kHz for

Sensors 2014, 14

24316

three types of sEMG signals. It can be observed from Figure 6 that the proposed reconstruction process exhibits very good level of accuracy at the receiver side for recovering the original bio-signal. Figure 7 plots the Computation Time (CT), which is an important factor to minimize the power consumption vs. the sparsity level. Figure 6. Performance of reconstruction process.

It can be noted from Figure 7 that increasing the sparsity level reduces the CT (in our work to 9.01 s at sparsity level of 98.9%). Figure 7. Computation time.

Sensors 2014, 14

24317

Figure 8 shows the SNR versus of sparsity level. It can be observed from Figure 8 that the proposed algorithms exhibit excellent performance in SNR (in our work to 89.2 dB at sparsity level of 98.9%). Figure 9 plots the sparsity level versus of the threshold value. As mentioned earlier, the suitable value of the thresholding process increases the sparsity level for the sEMG bio-signal, which is an important parameter in the CS scenario. It can be noted that the good level sparsity is obtained by increasing the threshold value (in our work the threshold percentage was selected at 30%). Figure 8. SNR for three types of sEMG signals.

Figure 9. Sparsity level.

Figure 10 shows the sampling rate (percentage of NR) vs. the reconstruction accuracy for three types of sEMG bio-signals. It can be seen from Figure 10 that the sampling rate can be reduced to 25% of NR without sacrificing of the performance in the reconstruction process. Figure 11 plots the Normalized Power Consumption (NPC) vs. CR for three types of sEMG bio-signals. It can be seen from Figure 11

Sensors 2014, 14

24318

that power consumption can be minimized to 40% at CR = 25 in our work. Figure 12 plots the RMSE in terms of Sub-Sampling Ratio (SSR), which is 1/CR, for three types of sEMG bio-signals. The RMSE is calculated via the following formula [34]:
L

( D1 - D 2 / D 2 )
l=1

(8)

where Dl is the normalized original sEMG bio-signal in the lth Monte Carlo Simulation (MCS), D is the normalized estimated sEMG bio-signal in the lth MCS, and L is the number of Monte Carlo Simulation, which is selected to be 50 in our simulation. It can be seen from Figure 12 that all RMSE values decrease with decrease of CR or the increase of sub-sampling ratio. The MCS is a method for obtaining numerical results, which relies on many simulations by varying parameters within statistical constraints [35]. Figure 10. Sampling rate.

Figure 11. Normalized power consumption.

Sensors 2014, 14 Figure 12. RMSE.

24319

Figure 13 shows the PRD vs. Compression Factor (CF) for three types of sEMG bio-signals sampled at 8 kHz and digitized with 4 bytes/sample. The P RD are defined as [35]:
N N

P RD =

(
i=1

(D[i] - D[i])2 /(
i=1

D2 [i]

(9)

where D[i] is the original sEMG bio-signal, D[i] is the reconstructed sEMG bio-signal, and N is the total number of samples. The CF is calculated by: CF = Db - Cb /Db  100 (10)

where Db is the number of bits for the original sEMG bio-signal and Cb is the amount of bits necessary for processing the compressed sEMG bio-signal. It can be seen from Figure 13 that decreasing CF minimizes the PRD, which means good PRD level is achieved at smaller number of bits necessary for storing the original sEMG bio-signal. Highlighted in Figure 13 are the lower PRD values obtained with smaller CF. Table 6 summarizes the results on SSR and RMSE for three types of sEMG signals. Since processing long-term sEMG bio-signals involves sampling frequency from 0.5 kHz to 6 kHz and quantization with 4 byte/sample and generates huge bits of information, coding with fewer bits based on the analog-CS theory is an optimal simulation for minimizing the power consumption and sampling rate. Table 7 summarizes the results on CT in seconds and SNR in dB for three types of sEMG signals. Measurements in Table 7 illustrate values of 98.82 dB, 96.83 dB, and 94.46 dB for SNR at the sparsity level of 98.99%. Table 8 summarizes the results on NPC, Sampling-Rare Reduction (SRD), and Accuracy (A) of the reconstruction process at the receiver side for three types of sEMG signals. Measurements in Table 8 illustrate values of 0.42, 0.41, 0.40 for NPC at SRD = 25%.

Sensors 2014, 14 Figure 13. PRD.

24320

Table 6. Comparison on RMSE.
SSR 0 0.2 0.4 0.6 0.8 1 1.2 RMSE(H) 0.0200 0.0168 0.0144 0.0130 0.0120 0.0108 0.0108 RMSE(N) 0.0200 0.0144 0.0120 0.0110 0.0102 0.0102 0.0102 RMSE(M) 0.0200 0.0125 0.0110 0.0105 0.0100 0.0102 0.0102

Table 7. Comparison on SNR and CT.
Sparsity % 60 65 70 75 80 85 90 95 100 SNR(H) 8 36 46 55 65 76 87 96 99 CT(H) 45 45 35 28 22 12 8 7 6 SNR(N) 4 32 42 51 61 72 82 92 97 CT(N) 44 37 34 27 21 11 7 6 5 SNR(M) 2 30 40 49 58 69 80 90 95 CT(M) 43 36 33 26 20 10 6 5 4

Sensors 2014, 14 Table 8. Comparison on accuracy and NPC.
SRD% 10 15 20 25 30 35 40 45 50 A %(H) 100 100 100 92 78 60 45 35 25 A %(N) 100 100 95 90 74 58 44 31 21 A %(M) 100 100 94 88 70 55 40 30 20 NPC(H) 1 0.90 0.70 0.42 0.30 0.18 0.17 0.16 0.15 NPC(N) 1 0.85 0.65 0.41 0.28 0.16 0.15 0.15 0.14 NPC(M) 1 0.84 0.64 0.40 0.25 0.15 0.14 0.14 0.13

24321

6. Discussion The existing long-term sEMG monitoring systems with multiple channels suffer from serious problems such as very large amount of data from sampling, limited processing capacity, limited storage, low transmission rate and power, bulky size, poor mobility, and high power consumption. Therefore, they are not suitable for wearable wireless applications that must have small size, excellent mobility, low power consumption, and high transmission rate. As most of the power in a wearable wireless sEMG sensor is dissipated for transmitting bio-data to the receiver, which may reside in a smartphone or any portable device, an optimal solution for minimizing the power consumption is to decrease the amount of bio-data and reduce the duty cycle. Therefore, real-time analog data compression plays an important role for wireless portable devices. Wearable wireless sEMG sensors based on the analog-CS theory aim to establish low power and low sampling rate algorithms for the long-term recording of the electrical activity produced by muscles, which are very useful for treatment and diagnostic purposes as well as for detection of various pathologies. In the analog-CS scenario at the transmitter side, the input analog sEMG bio-signal [D]N ×1 is compressed to output analog bio-signal [D]M ×1 with M N . This work has presented a novel approach based on the analog-CS theory, which consists of three algorithms for the acquisition and reconstruction of analog data for a wearable wireless sEMG sensor. At the transmitter side, two new algorithms have presented in order to apply the analog-CS theory before ADC. At the receiver side, a reconstruction algorithm based on a combination of either 1 - 1 -optimization or 1 -optimization and BSBL framework has presented to reconstruct the original signals from the compressed signals with high probability and enough accuracy. The proposed algorithms enable recovery of the full sEMG bio-signal while simultaneously compressing the amount of collected analog data at the transmitter side and relaxing the noise at the receiver side. The proposed architecture has offered lower energy consumption compared with the digital-CS scheme and enabled analog data compression. Tables 9­11 demonstrate the comparisons on power consumption, accuracy, SNR, CT, and Classification Accuracy (CA) based on K-Nearest Neighbor (K-NN) [47] for three types of sEMG bio-signals for the digital-CS and analog-CS scenarios. The highlights in Tables 9­11 can be classified as follows. (1) By applying Algorithms I and II at the

Sensors 2014, 14

24322

receiver side of the sEMG bio-sensor, lower values for PRD and CT are obtained; (2) By employing the robust reconstruction algorithm based on a combination of multi- 1 -optimization and BSBL framework at the receiver side of the sEMG bio-sensor, lower values for SNR and PC as well as higher values for classification and reconstruction accuracy are obtained. Based on the results in Tables 9­11, the analog-CS approach is an optimal solution for establishing low power wireless portable sEMG long-term recording systems. Table 12 presents a comparison on Power Reduction (PR) at the transmitter and receiver sides for the digital-CS approach based on 1 -optimization in terms of different values of CR. Table 13 demonstrates the PR at the transmitter and receiver sides for the analog-CS approach based on 1 - 1 -optimization and BSBL framework for three types of sEMG signals. Table 9. Comparison on healthy sEMG signals.
Algorithm Digital-CS Analog-CS Existing Approach PRD% 0.0350 0.0108 0.056 SNR(dB) 87.3 98.9 82.1 NPC 0.820 0.420 0.93 CT (s) 18.02 6.02 28.30 CA% 93.24 98.23 91.85 Reconstruction Accuracy% 95.52 99.98 87.24

Table 10. Comparison on myopathy sEMG signals.
Algorithm Digital-CS Analog-CS Existing Approach PRD% 0.0341 0.0102 0.053 SNR (dB) 85.2 96.7 80.15 NPC 0.815 0.415 0.91 CT (s) 19.25 5.24 29.90 CA% 92.85 98.89 91.23 Reconstruction Accuracy % 94.92 99.97 89.34

Table 11. Comparison on neuropathy sEMG signals.
Algorithm Digital-CS Analog-CS Existing Approach PRD % 0.0362 0.0100 0.067 SNR (dB) 84.1 95.9 79.8 NPC 0.831 0.400 0.94 CT (s) 20.22 4.27 29.90 CA % 93.99 99.01 91.11 Reconstruction Accuracy % 94.83 99.12 86.99

Table 12. Comparison on Power Reduction based on digital-CS.
CR % 55 50 45 40 35 30 25 20 T. PR (H) % 7 6 5 3 2 1.5 1 0.5 T. PR (H) (N) % 12 10 9 7 6 5.25 4 3 T. PR (M) % 13 12 10 8 7 6 5 4 R. PR (H) % 21 20 18 10 8 7 6 5 R. PR (N)% 25 24 21 11 9 8 7 6 R. PR (M) % 26 25 24 12 10 9 8 7

Sensors 2014, 14 Table 13. Comparison on power reduction based on analog-CS.
CR % 55 50 45 40 35 30 25 20 T. PR (H) % 17 15 10 9 8 7 6 5 T. PR (H) (N) % 21 20 18 10 7 8 7 6 T. PR (M) % 21 20 19 15 13 12 10 8 R. PR (H) % 37 35 34 16 10 9 8 7 R. PR (N) % 45 41 40 18 15 12 10 9

24323

R. PR (M) % 45 43 41 22 18 15 12 10

It can be seen from Table 13 that greater reduction of power consumption is achieved by applying analog-CS to the transmitter and receiver sides of a sEMG bio-sensor. Measurements in Table 13 show 17%, 37%, 21% and 45% power reduction at 50% NR and 7% , 12%, 9% and 15% power reduction at 25% NR for three types of sEMG bio-signals, respectively. 7. Conclusions Today's healthcare systems are based on wired/fixed sensors because in many cases biomedical sensors for medical monitoring are not yet wireless. This creates the need for the implementation of new wireless bio-sensors for long-term recording and monitoring of bio-signals. The benefit of using wireless healthcare systems based on wearable wireless bio-sensors can be divided into two areas. One area is the use of new wireless technological solutions for individually based multi-parameter monitoring at home. It means patients with chronic diseases, as well as the constantly growing population of seniors, will benefit from treatment and medical monitoring at home or workplace. Moreover, unrestricted freedom of movement implies the use of wireless and even implanted biomedical sensors that greatly enhance home monitoring and follow-up of medical conditions. The second area of benefit rests in increasing the efficiency of treatments at hospital and medical centers. The ambulatory systems based on new technologies can become lighter, smaller, and capable of recording multiple signals up to 48 h. The recorded signals are saved in flash-type memories, which can be transferred to the hospital and medical centers for further actions. On the other hand, the increase of heath costs urgently prompts the development of ambulatory systems to reduce the number of patients going to hospital and medical centers. Therefore, it is necessary to design portable, low power, low sampling rate, high performance wireless health care systems that can deliver healthcare services anywhere at any time. This paper has presented an analog-based CS theory procedure that consists of three novel algorithms to design and implement the wearable wireless sEMG bio-sensor architecture for sEMG bio-signals, which are sparse in both the time and the frequency domains. At the transmitter side, two new algorithms have been presented in order to apply the analog-CS theory before ADC to maximize the processing speed by minimizing both the load of processing time and the duty cycle. At the receiver side, a faithful reconstruction algorithm based on the combination of multi- 1 -optimization and BSBL framework has been presented

Sensors 2014, 14

24324

to reconstruct the original bio-signals from the compressed bio-signals with high accuracy. In addition, this work has presented an analog-based CS theory procedure that consists of two interesting properties: (1) reduction in power consumption, which significantly lowers the average bio-sensor power; (2) a reconstruction process robust to noise, because the noise is not sparse on the sparsity basis. Therefore, the resolution of the data acquisition step, and hence the ADC, can be relaxed without undermining the quality of the reconstruction. The proposed architecture has reduced the sampling rate down to 25% of NR, power consumption to 40%, PRD to 24%, RMSE to 2%,and total computation time from 22 s to 9.01 s, which provide good background for establishing wearable wireless healthcare systems. In addition, the proposed architecture simultaneously has recovered the original bio-signals with good level of accuracy and SNR greater than 95.8 dB. Wireless sEMG systems based on the proposed architecture and the three novel proposed algorithms will be able to improve healthcare services for patients not only in hospital or at medical center but also at their homes and workplaces, to improve the overall quality of life and to minimize healthcare costs. 8. Future Works We intend to develop the tools for wireless sEMG bio-sensor and provide them to the web-based portals. The developed tools can be designed to access the valuable data stored on medical servers. Furthermore, we will develop a hybrid reconstruction algorithm based on multi- 1 -optimization and BSBL framework for other types of multi-sparse bio-signals to decrease the computational complexity at the receiver side. Acknowledgments The authors would like to thank NSERC and Canada Research Chair's programs for funding this work. Author Contributions M. Balouchestani and S. Krishnan designed three algorithms and performed research. M. Balouchestani and S. Krishnan read and approved the final manuscripts. Conflicts of Interests The authors declare no conflict of interest. References 1. Balouchestani, M.; Krishnan, S. Advanced k-means clustering algorithm for large ECG datasets based on a collaboration of compressed sensing theory and K-SVD approach. Signal Image Video Process. 2014, doi:10.1007/s11760-014-0709-5. 2. Arjunan, P.S.; Kumber, D.K.; Naik, G. Computation and evaluation of features of surface electromyogram to identify the force of muscle contraction and muscle fatigue. BioMed Res. Int. 2014, 2014, 1­6.

Sensors 2014, 14

24325

3. Vavrinsky, E.; Daricek, M.; Donoval, M.; Rendek, K.; Horinek, F. ; Horniak, M.; Donoval, D. Design of EMG wireless sensor system. In Proceedings of the 2011 International Conference on Applied Electronics (AE), Pilsen, Czech Republic, 7­8 September 2011; pp. 1­4. 4. Zhang, X.; Chen, X.; Li, Y.; Lantz, V.; Wang, K.; Yang, J. A framework for hand gesture recognition based on accelerometer and emg sensors. IEEE Trans. Syst. Man Cybern. Part A Syst. Hum. 2011, 41, 1064­1076 . 5. Yang, D.; Zhao, J.; Gu, Y.; Jiang, L.; Liu, H. EMG pattern recognition and grasping force estimation: Improvement to the myocontrol of multi-dof prosthetic hands. In Proceedings of the IEEE/RSJ International Conference on Intelligent Robots and Systems (IROS), St. Louis, MI, USA, 10­15 October 2009; pp. 516­521. 6. Artemiadis, P.; Kyriakopoulos, K. An EMG-Based robot control scheme robust to time-varying emg signal features. IEEE Trans. Inf. Technol. Biomed. 2010, 14, 582­588. 7. Wang, Q.; Zhang, X.; Chen, X.; Chen, R.; Chen, W.; Chen, Y. A novel pedestrian dead reckoning algorithm using wearable emg sensors to measure walking strides. In Proceedings of the Ubiquitous Positioning Indoor Navigation and Location Based Service (UPINLBS), Kirkkonummi, Finland, 14­15 October 2010; pp. 1­8. 8. PhysioNet. Available online: http://www.physionet.org (accessed on 5 August 2014). 9. EMG DATABASE. Available online: http://www.emgdatabank.psu.ac.th (accessed on 15 August 2014). 10. EMGLAB. Available online: http://www.emglab.net (accessed on 25 August 2014). 11. Hughes, E.; Bell, A. A wireless surface electromyography system. In Proceedings of the IEEE on SoutheastCon., Richmond, VA, USA, 22­25 March 2007; pp. 253­253. 12. Fu, J.; Chen, J.; Shi, Y.; Li, Y. Design of a low-cost wireless surface EMG acquisition system. In Proceedings of the 2013 6th International IEEE/EMBS Conference on Neural Engineering (NER), San Diego, CA, USA, 6­8 November 2013; pp. 699­702. 13. Makino, Y.; Ogawa, S.; Shinoda, H. EMG sensor integration based on two dimensional communication. In Proceedings of the 5th International Conference on Networked Sensing Systems (INSS), Kanazawa, Japan, 17­19 June 2008; pp. 257­257. 14. Dixon, A.; Allstot, E.; Gangopadhyay, D.; Allstot, D. Compressed sensing system considerations for ECG and EMG wireless biosensors. IEEE Trans. Biomed. Circ. Syst. 2012, 6, 156­166. 15. Balouchestani, M.; Raahemifar, K.; Krishnan, S. Low power wireless body area networks with compressed sensing theory. In Proceedings of the 2012 IEEE 55th International Midwest Symposium on Circuits and Systems (MWSCAS), Boise, ID, USA, 5­8 August 2012; pp. 916­919. 16. Mamaghanian, H.; Khaled, N.; Atienza, D.; Vandergheynst, P. Compressed sensing for real-time energy-efficient ECG compression on wireless body sensor nodes. IEEE Trans. Biomed. Eng. 2011, 58, 2456­2466. 17. Balouchestani, M.; Raahemifar, K.; Krishnan, S. New sampling approach for wireless ECG systems with compressed sensing theory. In Proceedings of the 2013 IEEE International Symposium on Medical Measurements and Applications Proceedings (MeMeA), Gatineau, QC, Canada, 4­5 May 2013; pp. 213­218.

Sensors 2014, 14

24326

18. Chen, F.; Chandrakasan, A.; Stojanovic, V. Design and analysis of a hardware-efficient compressed sensing architecture for data compression in wireless sensors. IEEE J. Solid State Circ. 2012, 47, 744­756. 19. Yang, X.; Tao, X.; Dutkiewicz, E.; Huang, X.; Guo, Y.; Cui, Q. Energy-efficient distributed data storage for wireless sensor networks based on compressed sensing and network coding. IEEE Trans. Wirel. Commun. 2013, 12, 5087­5099. 20. Liu, Y.; Gligorijevic, I.; Matic, V.; de Vos, M.; van Huffel, S. Multi-sparse signal recovery for compressive sensing. In Proceedings of the 2012 Annual International Conference of the IEEE on Engineering in Medicine and Biology Society (EMBC), San Diego, CA, USA, 28 August­1 September 2012; pp. 1053­1056. 21. Chen, F.; Chandrakasan, A.; Stojanovic, V. A signal-agnostic compressed sensing acquisition system for wireless and implantable sensors. In Proceedings of 2010 IEEE on Custom Integrated Circuits Conference (CICC), San Jose, CA, USA, 19­22 September 2010; pp. 1­4. 22. Mishali, M.; Eldar, Y.; Elron, A. Xampling: Signal acquisition and processing in union of subspaces. IEEE Trans. Signal Process. 2011, 59, 4719­4734 . 23. Mishali, M.; Eldar, Y. Xampling: Analog data compression. In Proceedings of the Data Compression Conference (DCC), Snowbird, UT, USA, 24­26 March 2010; pp. 366­375. 24. Salman, A.; Allstot, E.; Chen, A.; Dixon, A.; Gangopadhyay, D.; Allstot, D. Compressive sampling of EMG bio-signals. In Proceedings of the 2011 IEEE International Symposium on Circuits and Systems (ISCAS), Rio de Janeiro, Brazil, 15­18 May 2011; pp. 2095­2098. 25. Xue, T.; Dong, X.; Shi, Y. Multiple access and data reconstruction in wireless sensor networks based on compressed sensing. IEEE Trans. Wirel. Commun. 2013, 12, 3399­3411. 26. Yang, X.; Guo, Y.; Cui, Q.; Tao, X.; Huang, X. Random circulant orthogonal matrix based analog compressed sensing. In Proceedings of the 2012 IEEE Global Communications Conference (GLOBECOM), Anaheim, CA, USA, 3­7 December 2012; pp. 3605­3609. 27. Li, S.; Ge, G. Deterministic sensing matrices arising from near orthogonal systems. IEEE Trans. Inf. Theory 2014, 60, 2291­2302. 28. Ermis, E.; Saligrama, V. Dynamic thresholding for distributed multiple hypotheses testing. In Proceedings of the IEEE/SP 14th Workshop on Statistical Signal Processing (SSP'07), Madison, WI, USA, 26­29 August 2007; pp. 675­679. 29. Zhang, P.; Cao, T.Y.; Zhu, T. A novel hybrid motion detection algorithm based on dynamic thresholding segmentation. In Proceedings of the 12th IEEE International Conference on Communication Technology (ICCT), Nanjing, China, 11­14 November 2010; pp. 853­856. 30. Rashed, E.; Wang, Z.; Kudo, H. Adaptive thresholding for robust iterative image reconstruction from limited views projection data. In Proceedings of the 2011 IEEE on Nuclear Science Symposium and Medical Imaging Conference (NSS/MIC), Valencia, Spain, 23­29 October 2011; pp. 4249­4252. 31. Lin, H.M.; Li, J.C.M. Column parity and row selection (cprs): A bist diagnosis technique for multiple errors in multiple scan chains. In Proceedings of the IEEE International Test Conference (ITC), Austin, TX, USA, 8 November 2005; pp. 1119­1117.

Sensors 2014, 14

24327

32. Soussen, C.; Gribonval, R.; Idier, J.; Herzet, C. Joint k-step analysis of orthogonal matching pursuit and orthogonal least squares. IEEE Trans. Inf. Theory 2013, 59, 3158­3174. 33. Abramovich, Y.; Johnson, B.; Spencer, N. Two-dimensional multivariate parametric models for radar applications 2014; Part I: Maximum-entropy extensions for toeplitz-block matrices. IEEE Trans. Signal Process. 2008, 56, 5509­5526. 34. Liu, Y.; Gligorijevic, I.; Matic, V.; de Vos, M.; van Huffel, S. Multi-sparse signal recovery for compressive sensing. In Proceedings of the 2012 Annual International Conference of the IEEE on Engineering in Medicine and Biology Society (EMBC), San Diego, CA, USA, 28 August­1 September 2012; pp. 1053­1056. 35. Trabuco, M.; Costa, M.; Nascimento, F. Effect of the amount of sub-bands in the performance of discrete wavelet transform based dynamic s-emg signals encoder. In Proceedings of the 2014 Pan American Health Care Exchanges (PAHCE), Brasilia, Brazil, 7­12 April 2014; pp. 1­6. 36. Zhang, Z.; Jung, T.P.; Makeig, S.; Rao, B. Compressed sensing for energy-efficient wireless telemonitoring of noninvasive fetal ECG via block sparse Bayesian learning. IEEE Trans. Biomed. Eng. 2013, 60, 300­309. 37. Zhang, Z.; Rao, B. Recovery of block sparse signals using the framework of block sparse bayesian learning. In Proceedings of the 2012 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP), Kyoto, Japan, 25­30 March 2012; pp. 3345­3348. 38. Prasad, R.; Murthy, C.; Rao, B. Nested sparse Bayesian learning for block-sparse signals with intra-block correlation. In Proceedings of the 2014 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP), Florence, Italy, 4­9 May 2014; pp. 7183­7187. 39. Shen, Y.; Duan, H.; Fang, J.; Li, H. Pattern-coupled sparse Bayesian learning for recovery of block-sparse signals. In Proceedings of the 2014 IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP), Florence, Italy, 4­9 May 2014; pp. 1896­1900. 40. Wang, Y.G.; Qu, J.S.; Liu, Z.; Jiang, W.L. A multitask recovery algorithm for block-sparse signals. In Proceedings of the 2013 International Conference on Wireless Communications Signal Processing (WCSP), Hangzhou, China, 24­26 October 2013; pp. 1­6. 41. Tan, X.; Li, J. Compressed sensing via sparse Bayesian learning and Gibbs sampling. In Proceedings of the IEEE 13th Digital Signal Processing Workshop and 5th IEEE Signal Processing Education Workshop, Marco Island, FL, USA, 4­7 January 2009; pp. 690­695. 42. Jakubiec, F.; Ribeiro, A. D-Map: Distributed maximum a posteriori probability estimation of dynamic systems. IEEE Trans. Signal Process. 2013, 61, 450­466. 43. Lee, B.; Kalker, T. Maximum a posteriori estimation of time delay. In Proceedings of the 2nd IEEE International Workshop on Computational Advances in Multi-Sensor Adaptive Processing, St. Thomas, VI, USA, 12­14 December 2007; pp. 285­288. 44. Hyder, M.; Mahata, K. Maximum a posteriori estimation approach to sparse recovery. In Proceedings of the 2011 17th International Conference on Digital Signal Processing (DSP), Corfu, Greek, 6­8 July 2011; pp. 1­6. 45. Zhang, Y.; Zhao, D.; Ma, S.; Wang, R.; Gao, W. A motion-aligned auto-regressive model for frame rate up conversion. IEEE Trans. Image Process. 2010, 19, 1248­1258.

Sensors 2014, 14

24328

46. Fei, W.; Bai, L. Auto-regressive models of non-stationary time series with finite length. Tsinghua Sci. Technol. 2005, 10, 162­168. 47. Balouchestani, M.; Krishnan, S. Fast clustering algorithm for large ECG data sets based on CS theory in combination with PCA and K-NN methods. In Proceedings of the 2014 36th Annual International Conference of the IEEE on Engineering in Medicine and Biology Society (EMBC), Chicago, IL, USA, 26­30 August 2014; pp. 98­101. c 2014 by the authors; licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution license (http://creativecommons.org/licenses/by/4.0/).

