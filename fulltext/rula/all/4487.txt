Hindawi Publishing Corporation Journal of Applied Mathematics Volume 2015, Article ID 567275, 10 pages http://dx.doi.org/10.1155/2015/567275

Research Article Adaptive Time-Stepping Using Control Theory for the Chemical Langevin Equation
Silvana Ilie1 and Monjur Morshed2
1 2

Department of Mathematics, Ryerson University, Toronto, ON, Canada M5B 2K3 Department of Applied Mathematics, University of Waterloo, Waterloo, ON, Canada N2L 3G1

Correspondence should be addressed to Silvana Ilie; silvana@ryerson.ca Received 15 October 2014; Accepted 16 January 2015 Academic Editor: Yun-Bo Zhao Copyright © 2015 S. Ilie and M. Morshed. This is an open access article distributed under the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited. Stochastic modeling of biochemical systems has been the subject of intense research in recent years due to the large number of important applications of these systems. A critical stochastic model of well-stirred biochemical systems in the regime of relatively large molecular numbers, far from the thermodynamic limit, is the chemical Langevin equation. This model is represented as a system of stochastic differential equations, with multiplicative and noncommutative noise. Often biochemical systems in applications evolve on multiple time-scales; examples include slow transcription and fast dimerization reactions. The existence of multiple time-scales leads to mathematical stiffness, which is a major challenge for the numerical simulation. Consequently, there is a demand for efficient and accurate numerical methods to approximate the solution of these models. In this paper, we design an adaptive time-stepping method, based on control theory, for the numerical solution of the chemical Langevin equation. The underlying approximation method is the Milstein scheme. The adaptive strategy is tested on several models of interest and is shown to have improved efficiency and accuracy compared with the existing variable and constant-step methods.

1. Introduction
Stochastic modelling is essential for studying key biological processes, such as signaling chemical pathways in a cell, when some molecular species are in low numbers. The random fluctuations due to low amounts of certain biochemically reacting species have been observed experimentally [1­3]. Mathematically, the behaviour of such biochemical systems is accurately described in terms of Markov processes. For systems which may be assumed to be well-stirred, the dynamics of the system is governed by the chemical master equation [4]. While exact simulation algorithms for the chemical master equation exist in the literature [5, 6] they are typically quite intensive computationally, and therefore approximate simulation strategies were proposed [7­10]. However, the level of detail provided by the chemical master equation is often not necessary. In particular, when all reacting species are present in relatively large numbers, an approximate model, the chemical Langevin equation [11], is more computationally attractive to simulate that the chemical master equation.

The chemical Langevin equation (CLE) is a stochastic differential equation (SDE) of dimension equal to the number of reacting biochemical species in the system. It has noncommutative multiplicative noise. Moreover, the biochemical systems arising in applications usually evolve on several time scales, meaning their models are mathematically stiff. Stiffness is a serious challenge for the numerical solution of deterministic models, and even more so of stochastic ones. Indeed, in the regions where the problem is stiff, the explicit numerical integrators are forced to drastically reduce the time-step to satisfy the accuracy criteria. This leads to a highly inefficient simulation when fixed step size algorithms are employed. By contrast, adaptive timestepping strategies reduce the step size in the regions where stiffness is present such that the error is maintained below the required tolerance, but relax the time-step as soon as the integration exists these regions. This significantly reduces the computational cost of the simulation, while preserving the desired accuracy of the numerical solution. In the literature, the numerical solution of the chemical Langevin

2 equation is generally computed using the Milstein scheme [12, 13]. The Milstein scheme is a strong order one numerical method [14]. Gaines and Lyons [15] proved that numerical techniques of at least strong order of accuracy one are required to guarantee that the numerical solution computed with adaptive time-stepping strategies converges to the exact solution for noncommutative SDE and in particular for the CLE. Techniques for adapting the time-step for the weak solution of stochastic differential equations were proposed by Szepessy et al. [16]. For the strong numerical solution of stochastic differential equations with multidimensional Wiener processes, most of the existing adaptive time-stepping strategies were designed for systems with commutative noise (see [17­19]). Gaines and Lyons [15] developed an adaptive scheme for the strong solution of SDE, but the scheme is quite restrictive. It is based on a Brownian tree structure and the only variations in the step size allowed are doubling or halving. We note that the chemical Langevin equation belongs to the class of noncommutative SDEs, which are more challenging to solve numerically. A variable timestepping method for the chemical Langevin equation using the Brownian tree structure of Gaines and Lyons [15] was introduced by Sotiropoulos and Kaznessis [20] and showed to be expensive. Ilie and Teslya [21] developed an adaptive technique for the mean-square numerical solution of the chemical Langevin equation with small noise. This paper proposes a variable time-stepping strategy for the strong numerical solution of the chemical Langevin equation, based on proportional integral- (PI-) control. Similar to the existing adaptive methods [13, 20, 21], we employ the Milstein scheme to advance the integration. The technique uses estimates of the local error, based on the work by Sotiropoulos and Kaznessis [20]. This variable time-stepping method may be applied to any biochemical system which can be modelled with the chemical Langevin equation, having an arbitrary magnitude of the random fluctuations. To the best of our knowledge, this is the first PI-controller for noncommutative stochastic differential equations. This approach extends to a class of noncommutative It^ o SDE, the chemical Langevin equation model, and the work on PI-controllers for ODE by S¨ oderlind [22, 23] and for commutative Stratonovich SDE by Burrage et al. [17]. In addition, the PI-control of the step size outperforms the integral- (I-) control considered by the previous works for the chemical Langevin equation [13, 21]. Finally, our strategy allows rejection of the time-step when the error is above the tolerance, while guaranteeing that the statistics of the numerical solution is not biased. An outline of the paper is given below. Section 2 presents a stochastic continuous model of well-stirred biochemical kinetics, the chemical Langevin equation. Section 3 gives a brief description of the strong numerical solution of It^ o stochastic differential equations. In Section 4, we design an adaptive numerical technique for the chemical Langevin equation. The advantages of the proposed variable step size method over the existing methods are illustrated on several models of biochemical systems of interest in applications, in Section 5. The conclusions are given in Section 6.

Journal of Applied Mathematics

2. Chemical Langevin Equation
Assume  biochemical species 1 , . . . ,  participate in  reaction channels 1 , . . . , . The biochemical system, held at constant temperature, is homogeneous. The system state at time   0 is denoted by X() = [1 (), . . . , ()] , where  () represents the number of  molecules at time , for any  = 1, . . . , . Mathematically, the system state is modelled as a Markov process. When one reaction  fires, the state of the system is updated using a vector ^ called the state-change vector corresponding to the reaction  . This is an dimensional vector with entries ] , denoting the variation in the  molecular species caused by one reaction  . Then,  = {] }1,1 is the stoichiometric matrix of the biochemical system. To each reaction  it corresponds a propensity  (x) defined as follows: for an infinitesimal time increment ,  (x) is the probability that, given the state x at time , one reaction  happens during [,  + ). For a unimolecular reaction      the propensity function is  (X) bimolecular reaction  +     
 

(1) =   , while for a (2)

the propensity is of the form  (X) =    when  =  and  (X) =   ( - 1)/2 when  = . The system state may be represented as X () = X (0) + ^  (  (X ()) ) ,
=1 0  

(3)

where  are independent unit rate Poisson processes [24]. Assume that the leap condition is satisfied: there exists a time step  small enough such that  (X ())  constant in the interval [,  + ] , (4)

for each 1    . Under this assumption, the representation (3) may be approximated by X ( + ) = X () +  ^  ( (X ())  ) .
=1 

(5)

Equation (5), due to Gillespie, is known as the tau-leaping formula [8]. A further reduction is possible if, in addition,  may be chosen large enough such that each reaction  fires many times in the interval [,  + ]. More precisely,  exists such that  (X ())   1 (6)

for any 1    . A step size  exists for which conditions (4) and (6) are simultaneously satisfied when all molecular species are present in large amounts in the biochemical system. In this case, the Poisson variables in (5) may be approximated by

Journal of Applied Mathematics normal random variables with the same mean and variance, since (6) holds. Consequently, the tau-leaping formula (5) yields X ( + ) = X () +  ^ [ (X ())  +  (X ())  (0, 1)] ,
=1 

3 approximation of the moments of the exact solution are desired, weak numerical approximations are employed. The numerical approximation on [0, ] of the exact solution X() of (9), after  steps with step-size  = /, is denoted by X . This approximation is said to have strong order of convergence  > 0 if there exists a constant  > 0, independent of  and  > 0, such that the following inequality holds for any   (0, ):  )   , X ( ) - X   ( (13)    where    is some norm of a vector of dimension  and () is the expectation of a random variable. Numerical methods of strong order of accuracy 1 for a noncommutative SDE require, on each subinterval on each interval [,  + ], the simulation of the Wiener increments  =  ( + ) -  () ,
+ +

(7) where  (0, 1) are normal random variables with mean 0 and variance 1. Regarding the step-size  as an infinitesimal  in (7) leads to the following equation: X () = ^  (X ())  +  ^  (X ()) () ,
=1 =1  

(8)

1    

(14)

where ( )1 are independent Wiener processes. Equation (8) is called the chemical Langevin equation (CLE) [11]. It is a noncommutative It^ o SDE with multiplicative noise. Note that the dynamical state of the system X() is represented in (8) as a continuous Markov process.

and of either the double It^ o integrals  [19],  = 






 ()  () ,

1  ,   ,

(15)

3. Numerical Methods for SDE
Consider a general system of It^ o stochastic differential equations driven by an -dimensional Wiener process,  = (1 , 2 , . . . , ), in the form X () =  (, X ())  +   (, X ())  () .
=1 

or the Levy areas. Approximations of the double It^ o integrals , for 1  ,   , using the truncation after  terms of their KarhunenLo` eve or Fourier series expansion [14, p. 198­203] (see also [19]), are computed as 1 1   , =   -  (,  - ,  ) +  , . 2 2 For 1  ,   , and 1    ,  =   , , , ,   (0, 1) (16)

(9)

(17)

In the differential equation (9), X denotes an -dimensional stochastic process and (, X()) and  (, X()) are dimensional drift and diffusion coefficients, respectively. The initial condition is X (0) = x0 (10)

are independent normally distributed random variables with mean 0 and variance 1. Here the following notation is used:  , =


1 1  (  - , , ) , 2 =1  , ,




for  = 0. The SDE is assumed to have noncommutative noise, as is the case of the chemical Langevin equation model. If the differential operator   is defined as   =  ,
=1 

1 1 ,0 = - 2 , - 2 , ,  =1   = 1 1 1 - 2 2. 12 2 =1 


(18)

 , 

 = 1, . . . , 

(11)

then the SDE is called noncommutative if for some 1 , 2 = 1, . . . , , with 1 = 2 , 1 2 = 2 1 . (12)

An accurate simulation of the double It^ o integrals requires a minimum value  = 5 (see also [19]). Now, let us introduce a numerical method of strong order of accuracy 1, typically used in the literature to simulate the CLE, namely, the Milstein scheme [14]. The Milstein method on the time interval [ ,  + ] computes X+1 = X +  ( , X )  +  ( , X ) 
=1 

It is called a commutative SDE otherwise (see [14, p. 348]). Below, we discuss briefly the strong numerical solution of SDE, with a focus on a numerical method of strong order of accuracy one. The strong numerical solution of an SDE is computed when approximations of the exact solution of individual paths are of interest. By contrast, when the

+

   1 2 ( , X ) ( , ) , 1 2 1 ,2 =1



(19)

4 where   is defined in (11) and the Wiener increments are  =  ( + ) -  ( ).

Journal of Applied Mathematics In this paper we adhere to the usual practice of controlling the local error. The accuracy criterion is the local error on each Brownian path that, over each step, should be below the user-prescribed tolerance. Hence, the numerical integration may generate different time-step sequences on different paths. To apply the above error criterion, accurate estimates of the (pathwise) local error need to be computed. Let (X ,  ,  ) be the estimation of the local error for the time interval [ , +1 ], on some Brownian trajectory. The local error may be approximated by the sum of a drift part and a diffusion part. The drift term of the local error is estimated by   1       2  ( ) ( ) X drift (X ,  ) =  (23)         2    for a drift (X) given by (20). According to Sotiropoulos and Kaznessis [20], one can estimate the diffusion part of the pathwise local error produced by the Milstein scheme as   ,(3)            diffusion (X ,  ,  ) =       (X )    6   (24)       ×  () (X )  with  (X) =   (X)^
=1 

4. Variable Step-Size Control in the Simulation of the Chemical Langevin Equation
An adaptive time-stepping technique for the strong (pathwise) numerical solution of the chemical Langevin equation is proposed below. The underlying numerical technique is the Milstein scheme. Since the Milstein method is of strong order of accuracy one, numerical solutions employing it on variable time-step meshes converge to the exact solution of the chemical Langevin equation, as the step size converges to zero [15]. Recall that the CLE is a noncommutative SDE; hence the adaptive schemes developed in [17, 19] for commutative SDE do not apply. While the Brownian tree approach to adaptivity due to Gaines and Lyons [15] may be utilized, it has been shown to be quite expensive by Sotiropoulos and Kaznessis [20]. For the proposed method, the sequence of time steps depends on the particular trajectory and is obtained using proportional-integral- (PI-) control [22]. Step rejections are allowed when the error is above the prescribed tolerance. When a step is rejected, we apply a strategy that guarantees that the correct Brownian path is followed [13, 19]. This strategy ensures that the numerical solution is not biased. 4.1. Milstein Scheme for the Chemical Langevin Equation. We will apply below a numerical technique, due to Milstein, to the stochastic model of well-stirred biochemical kinetics considered above. Remark that the chemical Langevin equation (8) is an It^ o SDE of the form (9), with the drift coefficient of the form  (X) =  (X) ^
=1 

(25)

and  being the Jacobian of . Here ,(3) denotes a column vector with the th entry being ( )3 . 4.2. Adaptive PI-Control for CLE. The local error committed by the discretization method, the Milstein scheme (22), for the CLE is required to be smaller than a prescribed tolerance, , at each step and on each Brownian path; that is,  (X ,  ,  )  . (26)

(20)

and the diffusion coefficients  (X) =  (X)^ (21) for 1    . Substituting the drift (20) and diffusion coefficients (21) in the numerical scheme (19) for a generic SDE leads to the Milstein method for the stochastic continuous model (8). The Milstein strategy employed to the CLE (8), on a time-interval [ , +1 ], becomes
+1   =  + ],  (X )  =1  

Before describing the proposed adaptive time-stepping strategy, let us discuss the important problem of step rejection in the numerical integration of an SDE, when the desired accuracy is not achieved. For SDE, a step rejection must be performed such that the statistics of the approximate solution is not biased. More precisely, when the numerical solution is advanced on a particular Brownian path and a step is rejected as it failed to satisfy the accuracy requirement, the subsequent steps must be chosen such that the same Brownian path is maintained. In this work, this is achieved using a Brownian bridge [18]. If the step  is tried and rejected on the current interval, [,  + ], its corresponding Wiener increments,  =  ( + ) -  ()     (0, 1) , (27) were sampled. Denote the sampled value  =  . Then, a smaller time-step is tried,  < , and the corresponding Wiener increments on the subintervals [, +] and [+, +] are created  =  ( + ) -  () , - =  ( + ) -  ( + ) . (28)

+ ],  (X )
=1

+

  (X ) 1      [  ],1 ],2 2 (X )]  1  (1 ,2 ) , 2 1 =1 2 =1 =1  2 (X ) (22)

for any  = 1, . . . , .

Journal of Applied Mathematics To ensure that the integration preserves the already created Brownian path, a Brownian bridge is employed:  = - =  ( - )   +   ,    ( - )  -   -   .   2 - (1 -  -  )  -  = 0.

5 which is similar to an adaptive procedure for the numerical solution of ODE [25]. Note that the factors  max > 1 and  min < 1 ensure that the next step does not increase or decrease too much, so that fewer steps are rejected. A similar conservative technique is applied to the I-controller (30). The characteristic equation of the PI-controller (31) is

(29)

Here  denotes a new normally distributed random variable with mean 0 and variance 1. One step-size change method is the integral- (I-) controller for predicting the future step, +1 , based on the current step  and the current local error (X ,  ,  ). The I-controller is +1 =  (    )  (X ,  ,  )
1/K

(33)

,

(30)

for some constant K. The safety factor   1 is introduced to reduce the number of rejected steps. The values considered in our simulations are  = 0.8 and K = 2. Nonetheless, some step rejects may occur since the local error depends on the particular Brownian path; hence the principal error function has random values. To reduce the number of step rejections, we propose a proportional integral- (PI-) controller for varying the step size in the numerical CLE solving. Based on control theory, these PI-controllers present several advantages over the classical I-controllers, including improved efficiency and computational stability of the numerical solution. For more details on the control theory approach to adaptive timestepping, we refer the reader to [22]. The PI-controller is given by +1 =  (    )  ( ,  ,  )


 Here  is the order of the local error, ( ,  ,  ) =   , where  is the principal error function. For the PI-controller to be stable, the roots of its characteristic polynomial should be located inside the unit circle [22]. The parameters  , referred to as the integral gain, and  , known as the proportional gain, are chosen to obtain the desired properties of the controller. Numerical testing on many problems showed that the following parameter values of the PI-controller give excellent results for mildly stiff models of biochemical systems: ( ,  ) = (0.1, 0.2). Remark that the controller is stable, since its roots are within the unit circle. The PI-controllers for ODE, which were designed to produce smooth sequences of time-steps, do not perform well on SDE, where the goals are to increase the accuracy and reduce the number of rejected steps.

5. Numerical Experiments
We test the adaptive time-stepping technique, based on control theory, developed above for solving numerically the CLE on three interesting models of biochemical systems. The performance of the PI-controllers is compared to that of the I-controller and of the existing constant-step methods. The comparison is done as follows: for each of the PI- or I-controller the algorithm is run with a certain tolerance and the number of attempted (i.e., of accepted and rejected) steps is stored. Then the fixed step size method is applied with the largest number of attempted steps, between the Iand PI-adaptive schemes, and its local error is measured. In our experiments, we choose the following values for the parameters:  min = 0.5 and  max = 2. In order to validate the accuracy of our variable step size strategy for the numerical solution of the CLE, we compare the histogram generated with our scheme for the CLE with that computed with the exact algorithm for the chemical master equation due to Gillespie [5, 6]. Although chemical Langevin equation approximates the chemical master equation (CME) model, and thus some error in modelling exists, we obtain a very good agreement between the histograms using Gillespie's algorithm for the CME and our adaptive strategy for the CLE. This shows the excellent accuracy of the proposed method.

×(

 (-1 , -1 , -1 )  ( ,  ,  )



(31)

) .

For a further reduction of number of step rejections, the adaptive algorithm employs a more conservative approach to controlling the time-step: +1 =  min ( max,    )  ( ,  ,  )


max ( min, (

×(

 (-1 , -1 , -1 )  ( ,  ,  )



) )) , (32)

6
Table 1: The stiff model: the number of steps taken by the I-adaptive, PI-adaptive, and fixed step-size methods on the time-interval [0, 2 × 10-2 ].  1 Method I-adapt. PI-adapt. Fixed I-adapt. PI-adapt. Fixed I-adapt. PI-adapt. Fixed Tried steps 1943 1800 1943 5298 4926 5298 14590 13816 14590 Accepted steps 1357 1652 -- 3910 4587 -- 11543 13061 -- Failed steps 585 148 -- 1388 339 -- 3046 755 -- Error/ 0.9985 0.9971 56.7290 0.9995 0.9990 76.2772 0.9998 0.9997 100.6531

Journal of Applied Mathematics it decreases as the tolerance decreases. For the I-adaptive technique the same ratio of rejected to attempted steps is much larger, between 20% and 30% for the tolerances tried. The fixed step size method produces a local error of up to 100 times larger than the adaptive methods, for the same computational cost. To verify the accuracy of the proposed PI-controller for adapting the time-step when simulating the CLE, we compare the histograms at time  = 2×10-2 obtained with the Milstein PI-adaptive scheme and the Gillespie algorithms, respectively. The histograms, plotted in Figure 1, show an excellent agreement between our method and the exact algorithm; consequently our scheme is very accurate. 5.2. Schl¨ ogl Model. The Schl¨ ogl model [26] is well-known for its bistable behavior. While for the reaction rate equation model the trajectories converge to one of the two stable states, for the chemical Langevin equation, the trajectories may switch between the two stable states due to the noise in the system. The Schl¨ ogl model consists of the following reactions:  + 2  3,   ,
3 1

10-1

10-2

5.1. Stiff Biochemical Reaction Model. Consider the following stiff and nonlinear biochemical reaction system 1 + 2  3 , 1 + 3  2 , 3 + 2  1 ,
5 3 1

3  1 + 2 , 2  1 + 3 , 1  3 + 2 .
6 4

2

(34)

3   + 2,   .
4

2

(37)

The propensities characterizing these reactions are 1 (X) = 1 1 2 , 3 (X) = 3 1 3 , 5 (X) = 5 2 3 , The stoichiometric matrix -1 1 -1 1 1 -1 [ ] [ ] [  = [-1 1 1 -1 -1 1 ] ] [ ] 1 -1 -1 1 -1 1 [ ] 2 (X) = 2 3 , 4 (X) = 4 2 , 6 (X) = 6 1 . (35)

The reaction rate constants take the values 1 = 3 × 10-7 , 2 = 10-4 , 3 = 10-3 , and 4 = 3.5. The state change vectors of the reactions in the Schl¨ ogl model are the corresponding columns of the stoichiometric matrix: 1 -1 1 -1 [ ] [ ] ]. -1 1 0 0  = [ [ ] [ ] 0 0 -1 1 [ ] The reaction propensities may be computed as (36) 1 (X) = 2 (X) = 1  ( - 1) , 2 2  ( - 1) ( - 2) , 6 4 (X) = 4 . (39)

(38)

has as columns the state-change vectors of the reactions above. The system parameters are as follows: 1 = 100, 2 = 104 , 3 = 10-4 , 4 = 10-2 , 5 = 10, and 6 = 103 for the reaction rate constants, and (0) = [100, 1000, 100] for the initial conditions. The interval of integration is [0, 2 × 10-2 ]. We simulated 10, 000 trajectories with the integral (I), the proposed proportional integral- (PI-) adaptive and the fixed step size algorithms of the CLE for the sequence of tolerances 1, 10-1 , and 10-2 . The total number of attempted, accepted, and rejected steps as well as the corresponding errors is stored in Table 1. Also, we present the error generated with the fixed time-step method with the same total number of steps as the most expensive between I- and the PI-strategies, for the same tolerance. Remark that the PI-controller takes fewer attempted steps compared with the I-controller, for the same , being thus more efficient. The ratio of rejected to attempted steps for the PI- adaptive scheme ranges from 5% to 8% and

3 (X) = 3 ,

The numbers of molecules of the species  and  have constant values,  = 105 and  = 2×105 . The initial condition for the molecular number of the species  is (0) = 250. The system is integrated on the time-interval [0, 40]. The simulations of our PI-adaptive, the existing I-adaptive, and the constant-step schemes used for the CLE and of the SSA are done for 10,000 trajectories. The total number of attempted, accepted, and rejected steps and the measured error for the proposed PI-adaptive and the I-adaptive algorithms, as well as the error committed by the constant-step scheme, are depicted in Table 2. The simulations are performed for the tolerances  = 10-1 ,  = 10-2 , and  = 10-3 . The proposed variable time-stepping algorithm produces an

Journal of Applied Mathematics
0.35 0.3 Probability distribution Probability distribution 0.25 0.2 0.15 0.1 0.05 0 70 0.35 0.3 0.25 0.2 0.15 0.1 0.05 0 60

7

80

90 100 110 Number of X1 molecules 0.35 0.3 Probability distribution 0.25 0.2 0.15 0.1 0.05 0 60

120

130

70

80

90 100 110 120 Number of X2 molecules

130

140

70

80

90

100

110

120

130

Number of X3 molecules SSA CLE PI-adapt: tol = 10-1 CLE PI-adapt: tol = 10-2

Figure 1: The stiff model: the histograms at  = 2 × 10-2 for the species 1 , 2 , and 3 obtained with the SSA (green) and the PI-adaptive method for the CLE with tolerances  = 10-1 (blue) and  = 10-2 (red). The simulation uses 10,000 paths.

error of up to 19 smaller than that of the fixed-step-size method. Furthermore, the ratio of the number of rejected steps to the total number of steps tried for our PI-controlled time-step method is very small, between 3% and 5%, while for the I-adaptive scheme ranges from 11% to 23%. In Figure 2 we show the evolution in time of the error scaled by the tolerance, on a sample path, for the tolerance 10-3 for both our variable time-step and the existing fixedstep schemes. Moreover, we examined the accuracy of the numerical solution obtained with our adaptive method in Figure 3. We compared the probability distribution at time  = 40 for the species  computed with the PI-adaptive method for the CLE with  = 10-2 and  = 10-3 and with the SSA. The histograms agree very accurately. 5.3. Decay-Dimerization Model. The final system used to investigate the behaviour of our variable step-size algorithm

is the decay-dimerization model [8]. This model consists of three molecular species involved in four reactions: 1  0, 2  1 + 1 ,
3 1

1 + 1  2 , 2  3 .
4

2

(40)

The propensity functions corresponding to these reactions are 1 (X) = 1 1 , 3 (X) = 3 2 , 2 (X) = 2 1 (1 - 1) , 2

(41)

4 (X) = 4 2 ,

with the reaction rate parameter values 1 = 1, 2 = 0.002, 3 = 0.5, and 4 = 0.04. The solution of this biochemical reaction model is subject to the initial conditions 1 (0) = 2 (0) = 104

8
Table 2: The Schl¨ ogl model: the number of steps taken by the I-adaptive, PI-adaptive, and fixed stepsize methods on the timeinterval [0, 40].  10-1 Method I-adapt. PI-adapt. Fixed I-adapt. PI-adapt. Fixed I-adapt. PI-adapt. Fixed Error/ 0.9976 0.9942 10.7990 0.9992 0.9981 14.6088 0.9997 0.9993 18.7245
Probability distribution

Journal of Applied Mathematics

0.25 0.2 0.15 0.1 0.05 0

Tried steps 1235 1198 1235 3472 3334 3472 9724 9587 9724

Accepted steps 950 1123 -- 2869 3179 -- 8617 9275 --
Tolerance 10-3

Failed steps 285 75 -- 603 155 -- 1107 312 --

10-2

10-3

0

100

200

300 400 500 600 Number of X molecules

700

800

40 35 30 Local error/tol 25 20 15 10 5 0 0 5 10

SSA CLE PI-adapt: tol = 10-2 CLE PI-adapt: tol = 10-3

Figure 3: The Schl¨ ogl model: the histogram at time  = 40 of the species  obtained with the SSA (green) and the PI-adaptive method for the CLE with tolerances  = 10-2 (blue) and  = 10-3 (red). The simulation uses 10,000 paths.

Table 3: The decay-dimerization model: the number of steps taken by the I-adaptive, PI-adaptive, and fixed stepsize methods on the time-interval [0, 5]. 
15 20 Time t CLE fixed: error CLE PI-adaptive: error 25 30 35 40

Method I-adapt. PI-adapt. Fixed I-adapt. PI-adapt. Fixed I-adapt. PI-adapt. Fixed

Tried steps 1344 1321 1344 3888 3852 3888 11509 11496 11509

Accepted steps 1150 1275 -- 3505 3752 -- 10831 11298 --

Failed steps 194 46 -- 383 100 -- 678 198 --

Error/ 0.9980 0.9952 573.9135 0.9992 0.9984 685.7963 0.9996 0.9994 782.6674

10-1

10-2

Figure 2: The Schl¨ ogl model: the local error/tol versus time for the adaptive and fixed step-size algorithms on a sample trajectory, with tol = 10-3 on [0, 40].

10-3

and 3 (0) = 100. The integration is performed on the timeinterval [0, 5]. In addition, the stoichiometric matrix for this system is [ [  = [ [0 [ [0 -1 -2 2 ] ] 1 -1 -1] ]. ] 0 0 1] 0

(42)

To analyze the efficiency of the proposed method, we simulated our PI-adaptive, the I-adaptive, and the existing constant-step algorithms on 10,000 paths. Table 3 reports the numerical results: the number of attempted, accepted, and rejected steps of each of the variable step-size strategies, for tolerances  = 10-1 , 10-2 , and 10-3 , respectively. In addition, Table 3 records the local errors for each of the above schemes,

for a given tolerance. Moreover, it shows the local error obtained using the fixed time-step method with the same total number of attempted time-steps as the most expensive technique, the integral- (I-) controller one (being thus of similar computational cost with it). Observe that the Icontroller attempts more steps than our PI-controller, for the same tolerance; therefore it is more expensive. Likewise, the I-adaptive technique has a ratio of rejected to attempted steps between 6% and 14%, while the same step rejection ratio for our PI-adaptive scheme is below 3% and is decreasing with the decrease of tolerance. It is important to remark that the existing fixed step-size method yields a local error which is up to 780 times larger than the proposed variable time-stepping method. Consequently, our variable step-size algorithm is

Journal of Applied Mathematics
0.25 0.3 0.2 Probability distribution Probability distribution 0.25 0.2 0.15 0.1 0.05 0 6700 6750 6800 6850 6900 6950 7000 7050 7100 7150 Number of X2 molecules

9

0.15

0.1

0.05

0 1450

1500

1550 1600 1650 1700 Number of X1 molecules 0.3 0.25 Probability distribution 0.2 0.15 0.1 0.05 0 1900

1750

1800

1950

2000 2050 2100 2150 Number of X3 molecules

2200

2250

SSA CLE PI-adapt: tol = 10-2 CLE PI-adapt: tol = 10-3

Figure 4: The decay-dimerization model: the histograms at  = 5 for the species 1 , 2 , and 3 obtained with the SSA (green) and the PI-adaptive method for the CLE with tolerances  = 10-2 (blue) and  = 10-3 (red). The simulation uses 10,000 paths.

much more accurate than the constant time-step method, for a similar computational cost. To assess the accuracy of the proposed variable step size method, we perform simulations for 10,000 trajectories with the PI-adaptive Milstein method for the CLE with tolerances 10-2 and 10-3 and with Gillespie's algorithm. The histograms generated with these algorithms at time  = 5 for each of the species are plotted in Figure 4. Again, the accuracy of our variable step size strategy is excellent.

6. Conclusion
Variable step size control is critical for efficient approximation of the solution of stochastic differential equations and in particular for models which exhibit stiffness. The objective is to minimize the computational effort of the simulation,

while maintaining the desired accuracy of the numerical solution. When the numerical integration enters a region of stiffness, an adaptive algorithm lowers the step size to satisfy the accuracy requirement. However, outside these regions of stiffness the algorithm relaxes the step size, thus gaining in efficiency. This paper developed a variable time-stepping strategy, based on control theory, for the strong numerical solution of a stochastic continuous model of biochemical kinetics. More precisely, we designed the first PI-controller for adapting the step size for a class of stochastic differential equations with noncommutative multiplicative noise, known as the chemical Langevin equation. The underlying numerical technique is a higher order of accuracy method due to Milstein. The controller, which uses low cost estimates of the local error generated by Milstein scheme, is recommended for models of biochemical systems which are mildly stiff. Unlike other

10 variable time-stepping strategies [20] which alter the step only by halving or doubling, our technique allows for a flexible variation of the time-step. Furthermore, when a step is rejected as it does not satisfy the error criteria, the method guarantees that the statistics of the numerical solution are not biased. Numerical experiments show that the proposed PIcontroller for adapting the step size is significantly more accurate than the existing constant-step algorithms, for the same computational cost. Additionally, it has improved computational stability. Compared to the variable timestepping method using integral control, our PI-adaptive strategy reduces greatly the number of step rejections, having a reduced computational effort for the same prescribed tolerance. Our future work will investigate how to efficiently control the time-step in the weak numerical solution of the chemical Langevin equation.

Journal of Applied Mathematics
algorithm," Journal of Chemical Physics, vol. 118, no. 11, pp. 4999­ 5010, 2003. [10] A. Samant and D. G. Vlachos, "Overcoming stiffness in stochastic simulation stemming from partial equilibrium: a multiscale Monte Carlo algorithm," Journal of Chemical Physics, vol. 123, no. 14, Article ID 144114, 2005. [11] D. T. Gillespie, "The Chemical Langevin equation," Journal of Chemical Physics, vol. 113, no. 1, pp. 297­306, 2000. [12] H. Salis, V. Sotiropoulos, and Y. N. Kaznessis, "Multiscale Hy3S: hybrid stochastic simulation for supercomputers," BMC Bioinformatics, vol. 7, article 93, 2006. [13] S. Ilie, "Variable time-stepping in the pathwise numerical solution of the Chemical Langevin equation," Journal of Chemical Physics, vol. 137, no. 23, Article ID 234110, 2012. [14] P. E. Kloeden and E. Platen, Numerical Solution of Stochastic Differential Equations, vol. 23 of Applications of Mathematics (New York), Springer, Berlin, Germany, 1999. [15] J. G. Gaines and T. J. Lyons, "Variable step size control in the numerical solution of stochastic differential equations," SIAM Journal on Applied Mathematics, vol. 57, no. 5, pp. 1455­1484, 1997. [16] A. Szepessy, R. Tempone, and G. . Zouraris, "Adaptive weak approximation of stochastic differential equations," Communications on Pure and Applied Mathematics, vol. 54, no. 10, pp. 1169­1214, 2001. [17] P. M. Burrage, R. Herdiana, and K. Burrage, "Adaptive stepsize based on control theory for stochastic differential equations," Journal of Computational and Applied Mathematics, vol. 170, no. 2, pp. 317­336, 2004. [18] K. Burrage and P. M. Burrage, "A variable stepsize implementation for stochastic differential equations," SIAM Journal on Scientific Computing, vol. 24, no. 3, pp. 848­864, 2002. [19] K. Burrage, P. M. Burrage, and T. Tian, "Numerical methods for strong solutions of stochastic differential equations: an overview," Proceedings of The Royal Society of London Series A, vol. 460, no. 2041, pp. 373­402, 2004. [20] V. Sotiropoulos and Y. N. Kaznessis, "An adaptive time step scheme for a system of stochastic differential equations with multiple multiplicative noise: chemical Langevin equation, a proof of concept," Journal of Chemical Physics, vol. 128, no. 1, Article ID 014103, 2008. [21] S. Ilie and A. Teslya, "An adaptive stepsize method for the chemical Langevin equation," Journal of Chemical Physics, vol. 136, no. 18, Article ID 184101, 2012. [22] G. S¨ oderlind, "Automatic control and adaptive time-stepping," Numerical Algorithms, vol. 31, no. 1­4, pp. 281­310, 2002. [23] G. S¨ oderlind, "Digital filters in adaptive time-stepping," ACM Transactions on Mathematical Software, vol. 29, no. 1, pp. 1­26, 2003. [24] T. G. Kurtz, "Strong approximation theorems for density dependent Markov chains," Stochastic Processes and Their Applications, vol. 6, no. 3, pp. 223­240, 1978. [25] E. Hairer, G. Wanner, and S. P. Nørsett, Solving Ordinary Differential Equations I, Springer, Berlin, Germany, 2nd edition, 2009. [26] Y. Cao, L. R. Petzold, M. Rathinam, and D. T. Gillespie, "The numerical stability of leaping methods for stochastic simulation of chemically reacting systems," Journal of Chemical Physics, vol. 121, no. 24, pp. 12169­12178,2004.

Conflict of Interests
The authors declare that there is no conflict of interests regarding the publication of this paper.

Acknowledgment
This work was supported in part by a grant from the Natural Sciences and Engineering Research Council of Canada (NSERC).

References
[1] A. Arkin, J. Ross, and H. H. McAdams, "Stochastic kinetic analysis of developmental pathway bifurcation in phage infected Escherichia coli cells," Genetics, vol. 149, no. 4, pp. 1633­ 1648, 1998. [2] W. J. Blake, M. Kærn, C. R. Cantor, and J. J. Collins, "Noise in eukaryotic gene expression," Nature, vol. 422, no. 6932, pp. 633­ 637, 2003. [3] M. B. Elowitz, A. J. Levine, E. D. Siggia, and P. S. Swain, "Stochastic gene expression in a single cell," Science, vol. 297, no. 5584, pp. 1183­1186, 2002. [4] D. T. Gillespie, "A rigorous derivation of the chemical master equation," Physica A: Statistical Mechanics and its Applications, vol. 188, no. 1­3, pp. 404­425, 1992. [5] D. T. Gillespie, "A general method for numerically simulating the stochastic time evolution of coupled chemical reactions," Journal of Computational Physics, vol. 22, no. 4, pp. 403­434, 1976. [6] D. T. Gillespie, "Exact stochastic simulation of coupled chemical reactions," Journal of Physical Chemistry, vol. 81, no. 25, pp. 2340­2361, 1977. [7] Y. Cao, D. T. Gillespie, and L. R. Petzold, "The slow-scale stochastic simulation algorithm," The Journal of Chemical Physics, vol. 122, no. 1, Article ID 014116, 2005. [8] D. T. Gillespie, "Approximate accelerated stochastic simulation of chemically reacting systems," Journal of Chemical Physics, vol. 115, no. 4, pp. 1716­1733, 2001. [9] C. V. Rao and A. P. Arkin, "Stochastic chemical kinetics and the quasi-steady-state assumption: application to the Gillespie

Operations Research
Hindawi Publishing Corporation http://www.hindawi.com Volume 2014

Advances in

Decision Sciences
Hindawi Publishing Corporation http://www.hindawi.com Volume 2014

Advances in

Applied Mathematics
Hindawi Publishing Corporation http://www.hindawi.com Volume 2014

Journal of

Algebra
Hindawi Publishing Corporation http://www.hindawi.com Volume 2014

Probability and Statistics
Hindawi Publishing Corporation http://www.hindawi.com Volume 2014

Journal of

The Scientific World Journal
Hindawi Publishing Corporation http://www.hindawi.com Volume 2014

Differential Equations
Hindawi Publishing Corporation http://www.hindawi.com Volume 2014

International Journal of

Submit your manuscripts at http://www.hindawi.com
International Journal of
Hindawi Publishing Corporation http://www.hindawi.com

Combinatorics
Volume 2014

Mathematical Physics
Hindawi Publishing Corporation http://www.hindawi.com Volume 2014

Advances in

Complex Analysis
Hindawi Publishing Corporation http://www.hindawi.com Volume 2014

Journal of

Mathematics
Hindawi Publishing Corporation http://www.hindawi.com Volume 2014

Journal of

Mathematical Problems in Engineering
Hindawi Publishing Corporation http://www.hindawi.com Volume 2014

Abstract and Applied Analysis
Hindawi Publishing Corporation http://www.hindawi.com Volume 2014

Discrete Dynamics in Nature and Society
Hindawi Publishing Corporation http://www.hindawi.com Volume 2014

International Journal of Mathematics and Mathematical Sciences

Discrete Mathematics

Journal of

Function Spaces
Hindawi Publishing Corporation http://www.hindawi.com Volume 2014
Hindawi Publishing Corporation http://www.hindawi.com Volume 2014

Journal of
Hindawi Publishing Corporation http://www.hindawi.com

International Journal of
Hindawi Publishing Corporation http://www.hindawi.com

Stochastic Analysis
Volume 2014

Optimization
Hindawi Publishing Corporation http://www.hindawi.com Volume 2014

Journal of

Volume 2014


