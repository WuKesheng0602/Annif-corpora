Ryerson University

Digital Commons @ Ryerson
Theses and dissertations

1-1-2008

High accuracy positioning with low-cost singlefrequency GPS system in multipath environments
Abdulla Al-Naqbi
Ryerson University

Follow this and additional works at: http://digitalcommons.ryerson.ca/dissertations Part of the Civil Engineering Commons Recommended Citation
Al-Naqbi, Abdulla, "High accuracy positioning with low-cost single-frequency GPS system in multipath environments" (2008). Theses and dissertations. Paper 482.

This Thesis is brought to you for free and open access by Digital Commons @ Ryerson. It has been accepted for inclusion in Theses and dissertations by an authorized administrator of Digital Commons @ Ryerson. For more information, please contact bcameron@ryerson.ca.

HIGH ACCURACY POSITIONING WITH LOW-COST SINGLE-FREQUENCY GPS SYSTEM IN MULTIPATH ENVIRONMENTS

by
Abdulla Al-Naqbi

Bachelor of Science in Surveying Engineering California State University, Fresno
22 December 1995

A thesis

presented to Ryerson University
in partial fulfillment of the

requirements for the degree of
Master of Applied Science in the program of Civil Engineering

Toronto, Ontario, Canada, 2008
© Abdulla Al-Naqbi 2008

PROPERTY OF

DECLARATION

I hereby declare that I am the sole author of the thesis. I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research. I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or part, at the request of other institutions or individuals for the purpose of
scholarly research. »

Abdulla AI-Naqbi

11

ABSTRACT

Abdulla Al-Naqbi

HIGH ACCURACY POSITIONING WITH LOW-COST SINGLE-FREQUENCY GPS SYSTEM IN MULTIPATH ENVIRONMENTS

MASc, Civil Engineering, Ryerson University
2008

Positioning using low-cost, single-frequency GPS receivers provides an economical solution, but these receivers are subject to biases leading to degradation of the accuracy
required. Factors contributing to degradation in the accuracy of low-cost systems are

ionospheric delay, multipath, and measurement noise. Unless carefully addressed, these errors distort the ambiguity resolution process, and result in less accurate positioning
solutions. However, with the modern hardware improvements, measurement noise is now

almost negligible. Ionospheric delay has been dramatically reduced with the availability
of global or local ionospheric maps produced by various organizations Je.g., International GNSS Service (IGS), and National Oceanic and Atmospheric Administration (NOAA)). The major remaining constraint and challenging problem is multipath. This is because

multipath is environmentally dependant, difficult to model mathematically, and cannot be
reduced through differential positioning. This research proposes a new approach to identify multipath-contaminated LI measurements. The approach is based on wavelet

111

analysis using Daubechies family wavelets. First, the difference between the code and
carrier phase measurements was estimated, leaving essentially twice the ionospheric

delay, multipath and system noise. The ionospheric delay is largely removed by using
high resolution ionospheric delay maps produced by NOAA. The remaining residuals

contain mainly low-frequency multipath, if existed, and high-frequency system noise,
which were decomposed using db8-wavelets. A satellite signal was identified as

contaminated by multipath based on the standard deviation of the low frequency part of the residual component described above. The LI measurements obtained from the satellites with the lowest multipath were used to compute the final positions using Trimble Total Control (TTC) and Bernese scientific processing software packages. The AC 12 single-frequency GPS receiver was extensively tested in static and kinematic modes. Accuracies within 5 cm were demonstrated for baselines up to 65 km under various multipath environments.

IV

ACKNOWLEDGEMENTS

Above all, I am in debt to ALLAH who has given me the health, strength and patience, and granted me the opportunity to complete my graduate studies at Ryerson University.

First, I would like to express my special thanks and gratitude to my distinguished
supervisor, Professor Dr. Ahmed El-Rabbany, for his professional supervision,

encouragement, valuable suggestions, guidance, and proposed ideas throughout my study
and this research. His abundant cooperation and understanding deserve unbounded
appreciation. It was my great pleasure working under his supervision.

In addition, I wish to extend my appreciation and thanks to the committee members, Dr.
Grace Luk, Dr. Songnian Li, and Dr. Ahmed Shaker for dedicating their valuable times to
review my thesis.

Also, I am greatly indebted to Brigadier Dr. Khalifa Al-Rumaithi for his unlimited
support, encouragement and precious guidance throughout my carrier life in Military
Survey Department, UAE. Without him, I would never have had the opportunity to
complete my graduate studies.

Also, my thanks and gratitude are extended to Dr. Adel Al-Shamsi for his guidance,
continuous support and encouragement throughout this research.

Many thanks go to all my colleagues in the department of Civil Engineering for the unforgettable moments, the friendship, and the support I received throughout the entire course of my research: Hamad Yousif, Mohamed El-Sebeay, Hassan Ibrahim and Amit Joshi. I must express a special thanks to Mohamed El-Diasty and Mahmoud AbdelGalil
for their valuable support and precious ideas through out my graduate studies.

I am very grateful to Shigo Saeed for his support and time throughout the field data

collection. Without him, I would not have been able to gather all the data necessary to
complete this research.

Other individuals from the GPS community are deeply thanked for their technical support, for providing the essential equipment with which to accomplish this work, and
for their invaluable advice and solutions to the many problems encountered during the

course

of this

research.

These

individuals

include:

Rob

Ragsdale

from Trimble

Navigation; Art Sauer from Magellan Professional; Lou Estey from UNAVCO; Peter Walser and Rolf Dach from the Astronomical Institute, University of Bern; and Dilip Lai
from Sokkia Corporation, Canada.

Finally, my sincere thanks are also extended to Dr. Larbi Lezzam, my academic advisor in the UAE military attache, Washington DC, USA for his continuous and unlimited support. Without his help, my graduate studies would never have been completed.

VI

DEDICATION

To the people who praise nothing but noble values and deserve vast respect My parents, my wife, and my children

vn

Table of Contents

DECLARATION
ABSTRACT
ACKNOWLEDGEMENT

ii
iii
v

DEDICATION TABLE OF CONTENTS

vii viii

LIST OF TABLES

t.

xii

LIST OF FIGURES
ABBREVIATIONS
1 INTRODUCTION 1.1 1.2 Motivation Previous Studies

*

xv
xix
1 1 3

1.3 1.4
1.5 2

Methodology Thesis Outline
Research Contribution

6 8
9 10 11
12

GPS OVERVIEW 2.1
2.1.1

GPS Satellite Signals
Traditional GPS Satellites

2.1.2

Modernized GPS Satellites

16

2.2
2.2.1
2.2.2

Observables
Code Pseudoranges
Carrier Phase Measurements

16
17
19

2.3

GPS Measurement Errors and Biases

21

vm

2.3.1 2.3.2 2.3.3 2.3.4
2.3.5

Satellite Clock Errors Receiver Clock Errors Satellite Ephemeris Errors Ionospheric Refraction
Tropospheric Refraction

22 23 23 24
28

2.3.6
2.3.7 2.3.8 2.3.9
3

Multipath
Receiver Noise Satellite Geometry Hardware Delay

30
32 33 33
35

MULTIPATH EFFECTS ON GPS MEASUREMENTS

3.1
3.2
3.3

Introduction
Causes of Multipath
Characteristics of Multipath

35
36
38

3.3.1 3.3.2
3.3.3
3.3.4

Magnitude Repeatability
Satellite Elevation
Signal-to-Noise Ratio (SNR)

39 39
40
40

3.4
3.5
3.5.1 3.5.2 3.5.3
4

Mathematical Model
Mitigation Techniques
Antenna-Based Mitigation Improved Receiver Technology Signal and Data Processing

>

·#,,.

41
44
44 47 49
51

FIELD WORK AND DATA PRE-ANALYSIS

IX

4.1 4.2
4.3

Description of Equipment Description of Test Setup
Field Data Collection

52 55
56

4.3.1 4.3.2 4.3.3
4.4

The Two Base Stations The Four Data Collection Points for the Static Baseline Tests Kinematic Baseline Test
Computation of Code-Minus-Carrier Residuals a

56 57 63
64

4.5
4.5.1 4.5.2 5

Ionospheric Correction
United States Total Electron Content (USTEC) Procedures used to Reduce Ionospheric Delay

69
70 71 82

MULTIPATH IDENTIFICATION USING WAVELET ANALYSIS

5.1
5.2

Fourier Analysis
What is a Wavelet Transform?

82
83

5.3 5.4
5.5

Continuous Wavelet Transform Discrete Wavelet Transform
Multi-Resolution Analysis (MRA)

84 86
87

5.6 Family

Proposed Algorithm: Multi-Resolution Analysis based on the Daubechies 89

5.7
5.7.1 5.7.2 5.7.3 5.7.4

Results
Results for Point PIER Results for Point Ryerson Results for Point Steel Results for Point Milton

92
92 100 103 106

5.7.5

Comparison of the Four Data Collection Points

109

6

RESULTS AND DISCUSSION

m

6.1
6.1.1

Results for Static Baselines
Reference Receiver Coordinates (Truth-Data)

116
116

6.1.2

Short Baseline Test Results

I18

6.1.3
6.2

Long Baseline Test Results
Results for Precise Point Positioning

132
138

6.3
7

Results for Kinematic Baseline

140
145

CONCLUSIONS AND RECOMMENDATIONS

7.1
8

Conclusions

145
I48
155

REFERENCES

APPENDIX: SUPPLEMENTARY PPP RESULTS

l.PPP results for point STEEL 2. PPP results for point MILTON
3. PPP results for point RYERSON..

·

I55 I56
157

4. PPP results for point PIER

I58

XI

List of Tables

Table 2.1 Table 5.1

Satellite Signal Components for Traditional Satellites Standard Deviations for Code Residuals Before and After Multipath

15

Correction and the Approximated Multipath using db8-Wavelet-PIER

99

Table 5.2

Standard Deviations for Code Residuals Before and After Multipath
103

Correction and the Approximated Multipath using db8-Wavelet-Ryerson Table 5.3 Standard Deviations for Code Residuals Before and After Multipath

Correction and the Approximated Multipath using db8-Wavelet-Steel

106

Table 5.4

Standard Deviations for Code Residuals Before and After Multipath
109

Correction and the Approximated Multipath using db8-Wavelet-Milton Table 6.1 Coordinates for the Reference Receiver using Bernese Software (Known

Coordinates) Table 6.2 Ryerson Coordinates and Difference from Known Coordinates Before

118

Isolating Severely Multipath Contaminated Satellites derived by TTC Software
121

Table 6.3

Ryerson Coordinates and Difference from Known Coordinates after Isolating
121

Severely Multipath Contaminated Satellites derived by TTC Software Table 6.4 Ryerson Coordinates and Difference from Known Coordinates Before

Isolating Severely Multipath Contaminated Satellites derived by Bernese Software 121

Table 6.5

Ryerson Coordinates and Difference from Known Coordinates After Isolating 122

Severely Multipath Contaminated Satellites derived by Bernese Software

Xll

Table 6.6 Improvement Achieved for Ryerson Coordinates After Isolating Severely
Multipath Contaminated Satellites Derived by TTC and Bernese Software 122

Table 6.7 PIER Coordinates and Difference from Known Coordinates Before Isolating Severely Multipath Contaminated Satellites derived by TTC Software Table 6.8 PIER Coordinates and Difference from Known Coordinates After Isolating 125

Severely Multipath Contaminated Satellites derived by TTC Software

125

Table 6.9 PIER Coordinates and Difference from Known Coordinates Before Isolating

Severely Multipath Contaminated Satellites derived by Bernese Software

125

Table 6.10 PIER Coordinates and Difference from Known Coordinates After Isolating

Severely Multipath Contaminated Satellites derived by Bernese Software Table 6.11 Improvement Achieved for PIER Coordinates After Isolating Severely

125

Multipath Contaminated Satellites derived by TTC and Bernese Software

126

Table 6.12 Steel Coordinates and Difference from Known Coordinates Before Isolating
Severely Multipath Contaminated Satellites derived by TTC Software Table 6.13 128

Steel Coordinates and Difference from Known Coordinates After Isolating 129

Severely Multipath Contaminated Satellites derived by TTC Software

Table 6.14 Steel Coordinates and Difference from Known Coordinates Before Isolating
Severely Multipath Contaminated Satellites derived by Bernese^Software 129

Table 6.15

Steel Coordinates and Difference from Known Coordinates After Isolating
129

Severely Multipath Contaminated Satellites derived by Bernese Software Table 6.16 Improvement Achieved for Steel Coordinates After Isolating Severely

Multipath Contaminated Satellites derived by TTC and Bernese Software

130

Table 6.17 Milton Coordinates as derived by TTC Software

131

xin

Table 6.18 Table 6.19
Table 6.20

MILTON Coordinates as derived by Bernese Software Coordinates derived by Bernese Software using the
Kinematic Coordinates Difference Results

131 137
144

xiv

List of Figures

Figure 2.1 Biphase Modulation of the GPS Signal (from Dach et al., 2007)

12

Figure 2.2 Multipath Effect
Figure 3.1 Specular and Diffuse Multipath
Figure 3.2 A chock-ring antenna (courtesy of Trimble Navigation. Available at

31
38

http://www.trimble.com/gnsschokering.shtml)

46

Figure 4.1 Trimble-R8 GPS Receiver
Figure 4.2 NovAtel-ProPack-V3 Dual-Frequency Receiver

52
53

Figure 4.3 AC12 Ll-GPS Receiver
Figure 4.4 Field Data Collection Set-Up

54
55

Figure 4.5 Toronto Base Station
Figure 4.6 Approximate Baseline Lengths when using Toronto Base Station Figure 4.7 Approximate Baseline Lengths when using PWEL Base Station

57
58 59

Figure 4.8 The Steel Data Collection Point
Figure 4.9 The Ryerson Data Collection Point

60
61

Figure 4.10 The PIER Data Collection Point
Figure 4.11 The Milton Data Collection Point * »

62
62
63 64 67

Figure 4.12 Antenna Set-Up for Kinematic Observation Figure 4.13 Receivers Set-Up for Kinematic Observation Figure 4.14 Residual for PRN31, observed at Ryerson

Figure 4.15 Residual for PRN31, observed at PIER
Figure 4.16 Residual for PRN03, observed at Steel

68
69

xv

Figure 4.17 Two-Dimensional Spatial Interpolation Figure 4.18 Ionospheric Corrections for PRN 05, observed at Ryerson Figure 4.19 Cross-Correlation Function for PRN05 Ionospheric Correction Figure 4.20 Ionospheric Corrections for PRN 20, observed at Steel Figure 4.21 Cross-Correlation Function for PRN 20 Ionospheric Correction Figure 4.22 Residual for PRN31 Before and After Removing the ionospheric effect, observed at Ryerson *

72 76 77 77 78

79

Figure 4.23 Residual for PRN31 With and Without the ionospheric effect, observed at
PIER Figure 4.24 Residual for PRN 03 With and Without the ionospheric effect, observed at 80

Steel
Figure 5.1 Wavelet Analysis Scheme (from Misiti et al., 2007)

81
84

Figure 5.2 Multi-Resolution Analysis (from Elhabiby, 2007) Figure 5.3 Multi-Resolution Analysis Scheme (from Satirapod and Rizos, 2005)
Figure 5.4 Wavelet Decomposition Tree for db8-Level 6

89 91
93

Figure 5.5 Wavelet Approximation Levels for PRNOl Residual Figure 5.6 Approximated Multipath for PRNOlResidual using Level-6 Figure 5.7 Multipath for PRNOl Determined by Wavelet and TEQ

94 95 96

Figure 5.8 Cross-Correlation Function for PRNOl Multipath as Determined by Wavelet and TEQC for Dual-Frequency LI Data, observed at Point PIER Figure 5.9 Auto-Correlation Functions for PRNOl Residual 96 98

Figure 5.10 Wavelet Approximation Levels for PRN05 Residual, observed at Point Ryerson 100

xvi

Figure 5.11 Approximated Multipath for PRN05 Residual, observed at Point RyersonlOl

Figure 5.12 Multipath for PRN05 determined by Wavelet and TEQC, observed at Point

Ryerson

1"2

Figure 5.13 Cross-Correlation Function for PRN05 Multipath as Determined by Wavelet
and TEQC for Dual-Frequency LI Data, observed at Point Ryerson Figure 5.14 Wavelet Approximation Levels for PRN06 Residual, observed at 102 104

Figure 5.15 Approximated Multipath for PRN06 Residual observed at Point Steel

105

Figure 5.16 Approximated Multipath for PRN13 Residual, observed at Point Steel.... 105
Figure 5.17 Wavelet Approximation Levels for PRN12 Residual, observed at Point

Milton

107

Figure 5.18 Approximated Multipath for PRN12 Residual, observed at Point Milton. 108 Figure 5.19 Approximated Multipath for PRN22 Residual, observed at Point Milton. 108
Figure 5.20 Standard Deviation Values for the Approximated Multipath 110

Figure 6.1 Difference between Published PIER Coordinates and Coordinates Derived by
Dual-Frequency Receiver and computed by TTC and Bernese Software Figure 6.2 Point Ryerson Coordinates Differences (from known coordinates) Before 117

Isolating Multipath Contaminated Satellites
Figure 6.3 Point Ryerson Coordinates Differences (from known coordinates) After

119

Isolating Multipath Contaminated Satellites
Figure 6.4 PIER Coordinates Differences (from known coordinates) Before Isolating

120

Multipath Contaminated Satellites
Figure 6.5 PIER Coordinates Differences (from known coordinates) After Isolating

123

Multipath Contaminated Satellites

124

xvu

Figure 6.6 Steel Coordinates Differences (from Known Coordinates) Before Isolating
Multipath Contaminated Satellites Figure 6.7 Steel Coordinates Differences (from Known Coordinates) After Isolating
Multipath Contaminated Satellites 128

127

Figure 6.8 Milton Coordinates Differences (from known coordinates) Figure 6.9 Steel Coordinates Differences at Two Reference Stations using Bernese
Software ;»

131

133

Figure 6.10 Milton Coordinates Differences using Bernese Software Figure 6.11 Ryerson Coordinates Differences using Bernese Software
Figure 6.12 PIER Coordinates Differences using Bernese Software Figure 6.13 PPP-Results for Points with Minimal Multipath Effect Figure 6.14 PPP-Results for Points with Severe Multipath Effect Figure 6.15 Vehicle Track during the Data Collection Figure 6.16 Final Track derived by Carrier Phase Observation for

134 135
136 139 140 141 143

Figure 6.17 Differences in Positioning Components for the observed Trajectory by AC12 sensor Figure 1. PPP results for point STEEL 144 155

Figure 2. PPP results for point MILTON
Figure 3. PPP results for point RYERSON Figure 4. PPP results for point PIER

156
157 158

xvm

Abbreviations

ACS AFS
BCE BPSK

Active Control Station

Atomic Frequency Standards
Broadcast Ephemerides

Bi-Phase Shift Key Modulation
Coarse/ Acquisition

C/A code
CODE CSRS CWT DCB DD DoD

Centre for Orbit Determination in Europe
Canadian Spatial Reference System

Continuous Wavelet Transform
Differential Code Biases

Double Difference

Department of Defence

DOP
DWT

Dilution of Precision Discrete Wavelet Transform

ECEF
FFT

Earth Centered Earth Fixed
Fast Fourier Transform Geodetic Base Station Software
Global Ionosphere Maps

GBSS
GM

GLONASS

Global'naya Navigatsionnaya Sputnikov; (Global Navigation Satellite System)

GNSS GPS

Global NavigationSatellite System Global Positioning System

XIX

HDOP
HPF HOW
IFFT

Horizontal Dilution of Precision

High-pass fliter
Hand Over Word Inverse Fast Fourier Transform

IGS
IONEX ITRF JPL

International GNSS Service
IONosphere Exchange format International Terrestrial Reference Frame Jet Propulsion Laboratory Linear Combination Left Handed Circularly Polarized Line-of-Sight Low-pass filter Master Control Station Multipath Elimination Delay Lock loop
Multipath

»

LC LHCP
LOS LPF MCS MEDLL MP MRA

Multi-Resolution Analysis
National American Datum 1983

NAD83 NAVSTAR NOAA NRCan

NAVigational System using Timing and Ranging National Oceanic and Atmospheric Administration
Natural Resources Canada

OEM OTF

Original Equipment Manufacturer
On-The-Fly Pulse Aperture Correlator

PAC

xx

P-code PDOP PPP PPS PRN
PVT

Precise

Position Dilution of Precision
Precise Point Positioning pulse per second
Pseudorandom Noise
Position-Velocity-Time

RHCP
RINEX RTK

Right-Handed Circularly Polarized
Receiver-Independent Exchange Format Real Time Kinematic

SBAS
SNR STFT SVN TEC TLM

Satellite Based Augmentation System Signal to Noise ratio
Short-Time Fourier Transform Space Vehicle Number
Total Electron Content

Telemetry Word

TTC UTC VDOP USTEC WGS84

Trimble Total Control Universal Time Coordinated

Vertical Dilution of Precision
United States Total Electron Content World Geodetic System 1984

xxi

1

INTRODUCTION

Chapter 1 of this thesis explains the motivation (Section 1.1) for this research into lowcost, high accuracy positioning using single-frequency receiver. Section 1.2 explains the approach adopted with reference to previous research. Section 1.3 briefly outlines the research methodology. Section 1.4 introduces the content of Chapters 2 to 7, and Section 1.5 highlights the areas in which this thesis makes a contribution to research.

1.1

Motivation

Many survey and industrial companies are increasingly calling for low-cost positioning

systems for their daily applications. Global Positioning Systems (GPS) technology today plays a very major role in dominating major sectors engaged in engineering works,
mapping, and geodetic applications. GPS is basically used to find the 3-D position of

various features on the Earth, at sea, and in the air. The positioning is accomplished by a complicated signal transmitted from each GPS satellite antenna and receiving the signal
by the antennas of various GPS receivers.

GPS satellites traditionally transmit two carrier waves, LI and L2. These two carrier waves are modulated by two Pseudo-Random Noise (PRN) codes, (the P(Y)-code and the
C/A-code), and by the navigation message. Modernization plans include adding two new

civil codes to the L2-carrier. The two new codes are known as the L2 civil-long (L2 CL) code, and the L2 civil-moderate (L2 CM) code. The modernization plans also include adding two new military codes on both frequencies (El-Rabbany, 2006b).

GPS receivers are generally classified either as single-frequency (LI) GPS receivers or as

dual-frequency (LI and L2) GPS receivers. The classification depends on the tracking
capabilities of the GPS receiver. Dual-frequency receivers are the most accurate receivers

due to their inherited capabilities for eliminating a major error component (the ionospheric effect) by forming a linear combination using both frequencies (LI and L2)
to form the ionosphere free linear combination (L3) observable. Dual-frequency receivers can deliver millimetre accuracy if proper procedures are followed, but these receivers are

very expensive and therefore not very attractive to many professionals. The low cost of single-frequency receivers is attractive, but these receivers are not suitable for
applications demanding high accuracies.

With the rapid improvements in the satellites constellation and the availability of precise

products, such as precise ephemeris and ionospheric correction maps produced by the

International

GNSS

Service

(IGS)

or the

National

Oceanic

and Atmospheric

Administration (NOAA), it should now be feasible to derive accurate solutions using low-cost single-frequency GPS receivers. Multipath disturbance however, appreciably
reduces GPS accuracies, and will remain a majpr challenge. Multipath disturbance affects

solutions derived by precise point positioning, relative positioning, and kinematic positioning. It is difficult to model multipath disturbance mathematically due to its
localized nature and due to its being environmentally dependant.

Various studies have been initiated to check the possibilities of improving the accuracy of the information derived from single-frequency GPS receivers. This research investigates
the possibility of using single-frequency GPS sensors in both kinematic and static modes over different baselines (up to 65 km) for various applications. To improve the accuracy

of the single-frequency systems in multipath environments, this research proposes the use
of a mitigation technique based on wavelet analysis using Daubechies family wavelets. In this research, wavelet analysis using db8-wavelets is used to decompose the code minus

carrier residuals into a low-frequency bias and high-frequency noise terms. The analysis
identifies the amount of multipath disturbance in each observed satellite's signal. The best satellites (in terms of multipath standard deviation values) are used to compute the final positions.

1.2

Previous Studies

The possibility of using single-frequency (LI) receivers for precise applications has
received significant attention in recent years. Masella (1997) tested the capability of implementing a low-cost single-frequency receiver for real-time kinematic (RTK)

applications. The results showed that the proposed system could achieve 10 cm accuracy for short baselines with relatively short initialization time. For kinematic applications, simulation tests suggested the possibility of obtaining 20 cm accuracy. Rizos et al.

(1998) investigated the potential use of the Canadian Marconi Allstar OEM GPS singlefrequency receiver board for surveying applications. Millimetre accuracies were reported in static mode for baselines shorter than 6.5 km with short observation periods (10 to 20 minutes). In the kinematic tests, centimetre accuracies were obtained for baselines shorter

than 5.2 km when a static initialization procedure was implemented. On-the-fly (OTF)
procedure was only capable of delivering accuracies in the range of 1 to 2 decimetres.

Soderholm (2005) used an iTrax03 OEM GPS receiver and also reported the possibility

of obtaining centimetre-level accuracy for short baselines. Saeki and Hori (2006)
demonstrated the reliability of low-cost-GPS systems with patch antenna for wireless

network sensing systems, and also for displacement monitoring of civil structures. The
potential for using LI GPS receivers for surveying applications over longer baselines was

investigated by Alkan et al., (2007) using a OEM GPS sensor board. They reported accuracies of less than a decimetre with their system for baselines up to 51 km in static
mode.

The value of wavelet analysis has recently been demonstrated in various geodetic

applications, including GPS data processing and geoid computations. Fu et al. (1997)
applied the Daubechies orthonormal wavelet family to GPS data processing. Their tests

concentrated on data smoothing, outlier detection, bias separation, and data compression using data collected by dual-frequency GPS receivers. The results demonstrated the

capability of their proposed wavelet algorithm for decomposing GPS signals (Double
Difference) into low-frequency bias terms (multipath) and high frequency observation
noise.

Aram et al. (2007) tackled the identification of the multipath effect on data collected by a single-frequency GPS receiver. Code and carrier-phase measurements were collected in
15-minutes sessions using a single-frequency (LI), stationary, navigation-grade receiver

in a high-multipath environment. Wavelet analysis based on db-7 at 5 decomposition
levels was used to identify satellites signals contaminated with multipath, and to isolate the contaminated signals from the computed positions.

Souza et al. (2004) proposed a wavelet shrinkage approach for mitigating high frequency multipath disturbance from carrier phase double differences (DD) observations. They used the Symlet wavelet to decompose the pseudorange and carriei? phase DD signals,

and to separate the signal into high frequency multipath (caused by long delays), and short frequency multipath (caused by short delays). The data were collected using a dualfrequency GPS receiver over a relatively very short baseline of about 800 m. As a result
of the short baseline, the noise level was assumed to be negligible and other errors due to

ionosphere, troposphere, and orbits were essentially eliminated. Finally, Souza et al.
reconstructed the DD signals without the high frequency effects. Souza et al.,'s proposed

technique demonstrated improvements of about 30% in pseudorange average residuals
and 24% in carrier phases average residuals.

In research conducted by Satirapod and Rizos (2005), Symlet wavelets were implemented to remove carrier phase multipath from GPS observations collected by three dual-

frequency GPS receivers. To check the noise levels on the proposed receivers, two dualfrequency GPS receivers connected to the same antenna were used to collect data at a site
considered to be multipath-free, and a third GPS receiver collected data simultaneously at a severely multipath site located about 8 m from the base station. The data were collected

with a sampling rate of 15-seconds for four consecutive days. The approach used the

repeatability characteristic of multipath to check for multipath disturbance.

The DD

carrier phase observations were then decomposed into low frequency bias and high
frequency noise terms for different satellite pairs. Finally, the multipath error was removed from the DD carrier phase observations. The test demonstrated an improvement

in the computed positions, and confirmed that wavelet analysis can potentially be used to
remove carrier phase multipath from GPS observations collected at permanent GPS
stations.

1.3

Methodology

In this research, single- and dual-frequency GPS receivers were used simultaneously to collect static data from the same antenna via an antenna splitter. Data were collected at several locations under various multipath environments with different baseline lengths using a sampling rate of 1 Hz. To test the applicability of the proposed low-cost system in

the kinematic mode, kinematic data were also collected. The same receivers were used
for the static and kinematic data.

To improve positioning accuracy, a wavelet-based technique was used to identify GPS

satellites severely affected by multipath. These satellites were isolated from the final
processing to correct for the final derived positions. This was accomplished by
computing the code minuscarrier residuals for measurements pertaining to all satellites in

view. This computation essentially eliminated errors due to troposphere, satellite and receiver clocks, and ephemeris error. The remaining terms include multipath effects in both the carrier and the code measurements, twice the ionospheric effect (the ionospheric

effect is the same in both observables (code and carrier phase) with opposite signs) and
the ambiguity term, plus hardware delay, and receiver noise. The carrier phase multipath

and noise are negligible and removed from the residuals. The effect of integer cycle
ambiguity can be removed by subtracting the mean of the residuals, providing that no cycle slips exist in the observations. The ionospheric error was removed by using the high resolution United States Total Electron Content (USTEC) maps produced by NOAA. The final residuals, which contain mainly code multipath and observation noise, were fed into db-8 wavelet using six decomposition levels (level 6) to approximate the

multipath effect exists in each satellite's signal. The best satellites were then selected
(using the lowest multipath standard deviation values) and implemented in the final data
processing.

Two different GPS processing software packages (Bernese and Trimble Total Control)

were used to process the observations and compute the final geodetic positions in terms of latitudes, longitudes, and ellipsoidal-heights for the data collected by the single and the
dual-frequency sensors using two different base stations. One of the base stations is

called Toronto (located in Etobicoke, Ontario), and was used for short-baselines estimation. The second base station is called PWEL (located in Port Weller, Saint
Catharine's, Ontario), and was used for long-baselines estimation. The coordinates derived by the dual-frequency receiver (which was simultaneously logging data with the

single-frequency receiver via an antenna splitter) were used as truth data. These coordinates are called "known coordinates" in this thesis. The Precise Point Positioning

(PPP) was computed using the online service provided by Natural Resources Canada
(NRCan).

1.4

Thesis Outline

The research undertaken in this thesis is presented in Chapters 2 to 7:



Chapter 2 provides the GPS background information necessary to support the
research. The chapter addresses GPS signals, observables, and the errors that
contribute to GPS measurements.



Chapter 3 discusses the effect of multipath on GPS measurements in detail,

including the causes and characteristics of multipath, a mathematical model of
multipath, and the mitigation techniques available.



Chapter 4 presents the methodology adopted to fulfill the objectives of the
research. Field data collection, the equipment used, and the residual computations
procedure are described in detail.



Chapter 5 is devoted to the wavelet analysis and its implementation in signal processing. Wavelet analysis is introduced and explored in some detail, and an algorithm based on the Daubechies wavelets is proposed to approximate the multipath exists on the computed code minus carrier residuals. The results obtained from the wavelet analysis are analyzed, and the satellites contaminated
with multipath are,identified (using the multipath standard deviation values).



In Chapter 6, the final positioning solution for each observed session is computed based on the results obtained from the wavelet analysis. The results are compared

in terms of the processing software packages used to compute the final positions,
and in terms of the effect of various baseline lengths on the final solutions.  Chapter 7 presents the conclusions of this research, and makes recommendations
for future research. 1.5 Research Contribution

The contributions made by the research undertaken in this thesis can be summarized as
follows. The research: *

·

Explores a new ionospheric correction strategy based on high resolution ionospheric
maps produced by NOAA.

·

Develops a novel approach for multipath mitigation based on wavelet analysis.

·

Provides a cost effective solution for users demanding high accuracies with stringent
cost requirements.

·

Demonstrates that the accuracies delivered by a single-frequency GPS receiver under multipath environments are comparable to those delivered by dual frequency geodetic
receivers.

2

GPS OVERVIEW

Global Positioning System (GPS) is a satellite-based navigation system developed by the United States Department of Defense (DoD) in the early 1970s. The system provides the user with a great deal of valuable information including position, velocity, and time in a
common reference system, anywhere on or near the surface of the Earth under all weather
conditions.

The GPS nominal constellation consists of 24 satellites arranged on six orbital planes

with 55° inclination to the equator. The satellites are located 20,200 km above the surface

of the Earth with orbital periods of approximately 11 hours 58 minutes (half a sidereal
day). The full constellation provides global coverage with four to eight simultaneously
observable satellites above 15° elevation everywhere on the Earth at all times (Hofmann-

Wellenhof et al., 2008). The recent addition of five more satellites in Block IIR, and Block IIR-M brings the nominal 24-satellites constellation to a total of 29 GPS satellites
(El-Rabbany, 2006b).

The accuracy of GPS measurements is influenced and degraded by both systematic and

non-systematic errors. This chapter outlines the understanding of GPS systems required
to conduct this research. The discussion is divided into three main sections: satellite signals (Section 2.1), observables (Section 2.2), and measurement errors and biases
(Section 2.3).

10

2.1

GPS Satellite Signals

Each GPS satellite transmits a microwave radio signal centred on two L-band carrier frequencies of the electromagnetic spectrum. The carrier frequencies are identified as the LI signal with a frequency of 1575.42 MHz, and the L2 signal at a frequency of 1227.60 MHz. The satellite signal consists of the two L-band carrier frequencies, the ranging codes modulated on these carrier waves, and the navigation message.

All signals transmitted by the GPS satellites are derived from the fundamental frequency / =10.23 MHz, generated by the atomic clocks aboard the satellites. Atomic clocks are based on atomic frequency standards (AFS) which produce the reference frequency by stimulated radiation. Atomic clocks are the key to the accuracy of satellite navigation (Hofmann-Wellenhof et al., 2008). The LI and L2 carrier frequencies are generated by

multiplying

the

fundamental

frequency

by

154

and

120,

respectively.

Their

corresponding wavelengths are approximately 19 cm and 24 cm, respectively. Signals at
these microwave frequencies are highly directional, and hence easily blocked and

reflected by solid objects and water surface (Rizos, 1996). The carrier waves provide the means by which the ranging codes and navigation message are transmitted from the
satellites to the user.

A clear distinction should be made between traditional satellites and modernized
satellites when describing GPS satellite signals. Traditional satellites include Blocks II,

IIA, and IIR GPS satellites, while modernized satellites include Block IIR-M and
subsequent blocks of GPS satellites (El-Rabbany, 2006b).

11

2.1.1

Traditional GPS Satellites

Traditional GPS satellites transmit two ranging codes known as Coarse/Acquisition, (or

C/A-code) and Precise (or P-code). These codes are pseudorandom noise (PRN) codes.
The C/A-code is modulated onto the LI carrier only, while the P-code is modulated onto both the LI and the L2 carriers (Hofmann-Wellenhof et al., 2008). The PRN codes

consist of a unique sequence of binary values (zeros and ones) that are generated according to a special mathematical algorithm using devices known as Tapped Feedback
Shift Registers.

The C/A- and P-codes are used to measure the one-way range from the satellite to the GPS receiver. These codes along with the navigation message are modulated onto the
carrier frequencies using the Bi-Phase Shift Key Modulation (BPSK) technique as shown
in Figure 2.1 (Dach et al., 2007):

original carrier

code

modulated carrier

Figure 2.1 Biphase Modulation of the GPS Signal (from Dach et al., 2007)

12

(a)

The C/A-Code

The C/A code is a sequence of 1,023 binary chips (zeros and ones) with a basic frequency

of 1.023 MHz that repeats itself every millisecond, and a corresponding wavelength of about 300 m. The total sequence length is therefore about 300 km.

A unique C/A code is assigned to each GPS satellite. This enables the GPS receiver to identify which satellite is transmitting a particular code (Teunissen ettal., 1998). The C/A code is accessible by all civilian users.

(b)

The P-Code

The P-code is a very long sequence of binary digits, approximately 266 days or 38.058 weeks long (Hofmann-Wellenhof et al., 2008). The P-code is transmitted at a

fundamental frequency 10.23 MHz and a corresponding wavelength of about 30 m, which is 10 times the resolution of the C/A-code.

The P-code is divided into 38 unique code segments. Each satellite transmits a one-week
segment of the P-code which is initialized every Saturday/Sunday midnight crossing (ElRabbany, 2006b). P-code segments are used to identify individual GPS satellites by

assigning each satellite a PRN number which is equivalent to one week segment of the Pcode. Since the P-code was primarily designed for military applications, it was encrypted through the modulation of an unknown W-code. The sum is referred to as the Y-code, and is then modulated in the normal way onto the LI and L2 carrier waves.

13

(c)

The Navigation Message

The navigation message is a low-rate binary digits transmitted at a rate of 50 bps (bits per

second). A complete navigation message is composed of 25 frames of 1,500 bits each,
and takes 30 seconds to be transmitted. Each frame is divided into five sub-frames of 300 bits each. The total length of a complete navigation message is therefore 37,500 bits, and
takes 12.5 minutes to be transmitted.

The navigation message is transmitted on both L-band carrier frequencies (LI and L2),

and contains very valuable information for the user. Sub-frame 1 provides the GPS
transmission week number, the satellite clock correction parameters, and the satellite vehicle accuracy and health. Sub-frames 2 and 3 include the osculating Keplerian orbital elements that allow the users' equipment to precisely determine the satellite's location. This part of the navigation message is known as the broadcast ephemerides. The broadcast ephemeris take a maximum of 3 minutes (180 seconds) to be completed, and is
updated every hour (Rizos, 1996).

Sub-frames 4 and 5 contain almanac and health data for all satellites, ionospheric
correction parameters for single-frequency users, and transformation parameters to

convert from GPS system time to UTC. Almanac data provides lower accuracy orbital

information about satellites. The data are used for planning purposes and for helping the receiver to rapidly lock to satellite signals. The Almanac file is updated weekly. Each

sub-frame begins with two words: the telemetry word (TLM), and the hand over word
(HOW). The HOW is used by the receiver to identify which satellite (or which part of the

14

P or Y-code) is being transmitted, and allows the receiver to lock rapidly to it. The resulting signals can be represented by the following (Hofmann-Wellenhof et al., 2008):

Ll(t) = alP(t)D(t)cos(o\t)+a2C(t)D(t)sm(o)lt)

(2.1)

L2{t) = a3P(t)D(t) cos,(o)2t)

(2.2)

where

flj, a2, a3 denote the amplitudes of the signals,

*

a\ and (O2 represent the circular frequency of each carrier (a) = 2?tf )
P(t),C(t), and D(t) respectively. Table 2.1 summarizes the satellite signal components for traditional satellites: Table 2.1 Satellite Signal Components for Traditional Satellites represent the P-code, C/A- code, and the navigation message

FREQUENCY COMPONENT (MHz) Fundamental frequency Carrier LI

WAVELENGTH

/.=10.23 /,= 154/. =1575.42
/2=120/.=1227.60
19.0 cm

Carrier L2

24.0 cm

C/A code

/./10=1.023
/.=10.23

300 m

P-code

30 m

Navigation message

/. 7204600= 50 *10~6

15

2.1.2

Modernized GPS Satellites

Modernized GPS sa.eUi.es differ from traditional GPS sa,e.li.es. Modernized satellites

transmit a third carrier frequency called L5 a, a chipping rate of 1,176.45 MHz, and they
have several new ranging codes on the LI and L2 carrier links (Hofmann-WeUenhof e.
al., 2008).

The new L5 srgnal has been especially designed for civil aviation safe.y-of-lifc

applications. The L5 signal will be modulated with two PRN rangmg codes: the I5-code
and the Q5-code.

The new ranging codes on the LI and L2 carrier links are (El-Rabbany, 2006b):

. Two new eivil codes on the L2 frequency - the L2 civil-moderate (L2 CM) code,
and the L2 civil-long (L2 CL) code

. Two new military codes (M-codes) on both the LI and the L2 frequencies.

2.2

Observables

Two types of observables are obtained by GPS signals: eode pseudoranges, and phase

measurements. Both observables (eode pseudoranges, and phase measures) are used
in GPS navigation to compute position, velocity and time (PVT) information, and both
have a role in the specialized data processing that characterizes GPS surveying.

These observables are based on measured time or phase differences between the emitted
satellite signals and the receiver-generated signals. Since these observations are based on

16

two different unsynchronized clocks (the satellite clock, and the receiver clock), they are
known as pseudoranges.

2.2.1

Code Pseudoranges

The pseudorange is the "distance" between the GPS satellite at signal transmit time and
the receiver at signal reception time. Ranges, measured either by the C/A-code or by the P-code, are essential for position computation. A code tracking loop is used to track the C/A-code and/or P-code within a GPS receiver. The transmitted satellite signal (LI carrier modulated by the C/A code) is aligned with a receiver generated replica of the C/A-code by the code tracking loop, and the signal transit time is computed (difference

between time of transmission and time of reception). Multiplying this time difference by
the speed of light (299,729,458 m/s) yields the pseudorange measurements. This

measured pseudorange is, however, shifted by an error that is due to the different

reference time systems (time scales) used by the satellite and receiver clocks with respect
to the GPS time system.

In addition to the clock errors introduced to the measured range by the receiver and by the satellite, various other errors contribute to the accuracy budget of the measured pseudorange. These errors are summarized in the equation below (El-Rabbany, 2006a):

(2.3)

17

with

pi =
where P

(2.4)

is the measured pseudorange (m)

P

is the geometric distance between the antennas of satellite j and
receiver i (m)

(X,Y,Z)
c

are the ECEF receiver and satellite coordinates

is the speed of light in a vacuum (299,729,458 m/s)

dt.it)

is the receiver clock error with respect to GPS time (sec)
is the GPS time (sec)

t

T

is the signal travel time (sec)

dtj(t-T)

is the satellite clock error with respect to GPS time (sec)
is the tropospheric delay error (rn) is the ionospheric delay error (m)

dtrop
ion

d,(t)

is the signal delay at the receiver (hardware delay) (m) is the signal delay at the satellite (hardware delay) (m)
is the code rajige multipath error (m)
is the receiver code noise (m)

dJ(t-T)

mp

18

The anticipated precision derived by the C/A-code is about 3 m. This is 10 times less than the P-code's anticipated accuracy of about 0.3 m. Recent developments, however, demonstrate that a precision of about 0.1% of the chip length is possible (HofmannWellenhof et al., 2008). As mentioned earlier, the P-code is only accessible by military receivers or by techniques (such as Z-tracking and cross-correlation techniques) invented by GPS vendors to overcome the encryption problems. The main advantages of ranging
with the P-code rather than the C/A code are: *

·

More accurate position fix. The P-code has a higher measurement precision due to
the higher shipping rate (10.23 MHz).

·

Significantly reduced ionospheric error. The ionospheric error is significantly
reduced by the P-code's forming of a linear combination between the LI and L2 carriers emitted by the traditional satellites.

· · ·

Better suited to high dynamic environments (Rizos, 1996) Better able to resist signal jamming (Rizos, 1996) Reduced effect of multipath. The multipath effect is reduced on P-code

measurements because multipath is inversely proportional to the signal frequency.

2.2.2

Carrier Phase Measurements

The second type of observable is the carrier phase measurement. The carrier phase of the signal is the basis for GPS surveying, and for high-precision kinematic and static
positioning. Carrier phase measurements are more accurate than pseudorange

measurements. This is due to the high resolution of carrier observations (19 cm and 24

19

cm for LI and L2, respectively). So, implementing measurement precision of 1 % of the
chip length leads to millimetre level noise (1-3 mm).

This technique is based on counting the number of full carrier cycles existing between the receiver and the satellite, adding the fractional cycles at the receiver and the satellite, and
then multiplying by the wave length of each individual carrier. In reality, when the

receiver is first switched on, it is able to measure only a fraction of the cycle, so the initial
number of complete cycles remains unknown or ambiguous. The receiver will, however,

keep counting the accumulated phase differences between arriving satellite phases and

internally generated receiver phases, which reflect the changes in distance to the satellite.
This observation will be continuous with the same initial cycle ambiguity as long as no

loss of lock or cycle slips occur. If, however, a cycle slip occurs, a new integer ambiguity
constant is introduced for the new observations.

Various techniques are used to recover the carrier wave from the incoming modulated signal. The techniques include the signal reconstruction method which is based on a code demodulation technique that removes the ranging code and navigation message using the
correlation between the received signal and the signal replica generated by the receiver.
Other techniques include squaring and cross-correlation techniques (see HofmannWellenhof et al, 2008 for further details).

Equation 2.5 defines the carrier phase observation in meters. The measurement is similar

to the code pseudorange measurement except for the added ambiguity number, carrier

20

phase multipath, noise, and equipment delays, and for the ionospheric error being
negative in Equation 2.5. The negative ionospheric error means that the ionosphere

advances the carrier measurement and delays the code measurement (El-Rabbany,
2006a):

(2.5)

where the expressions different from the pseudorange are:
O X is the measured carrier phase (m) is the carrier wavelength (m)

N St (t)

is the integer cycle ambiguity (cycles) is the carrier phase delay at the receiver

S' (t -- t)

is the carrier phase delay at the satellite
is the carrier phase multipath error (m), and

mpi

£

is the receiver carrier phase noise (m).

2.3

GPS Measurement Errors and Biases

Although GPS is clearly the most accurate global navigation system yet developed, it exhibits significant errors and biases. The accuracy derived by GPS is governed by various contributing factors. Factors causing these errors could be attributed to the satellites including satellite clock errors and orbital errors, to the propagation of the signal
due to the atmospheric effects (ionosphere and troposphere) and multipath, to the

receiver/antenna configuration, such as receiver clock bias, interchannel bias, and

21

Phase center, to the -ion

ion (coordinates, polar motion, earth oody **

(geome,nc effects,. In the fotlowmg sections, the major errors

--ting to the GPS

accuracy budget are explored in some more details.

2 3.1

Satellite Clock Errors

Satellites carry highly accurate atomic clocks th, are carefully monitored by the master

in range observations.

speed o( the satemte vehrcle and decreased gravity. The error is carefu.ly monitored hy

minimum.

Satemte c,ock errors can he modeW and corrected using the coefficents transmit in

(a2). The equation for the satellite clock errors is:
(2.6)

where f and tc denote the time of the

observation epoch and the satellite clock reference
to all receivers observing the

Spoch respectively. As the satellite clock error is common
22

same satellite, the errors can be removed using between-receivers single-difference (ElRabbany, 2006a).

2.3.2

Receiver Clock Errors

GPS receivers use inexpensive crystal clocks (El-Rabbany, 2006b). These clocks are

sensitive to temperature changes, shocks and vibrations, and are not as stable as atomic satellite clocks. Receiver clocks are not synchronized with satellite clocks or with GPS time. Receiver clock error is larger than satellite clock error. The error can be removed by differencing between satellites. It can also be removed in the estimation process if it is
treated as an additional unknown parameter.

2.3.3

Satellite Ephemeris Errors

Ephemeris errors are caused by the imperfect modeling of the forces that act on GPS satellites. Satellite ephemerides are determined by the MCS, and broadcast to users via the navigation message. Broadcast ephemerides errors are reported to be in the order of 1.6 m (El-Rabbany, 2006b). The error can be eliminated by differencing observations for short baselines, but when the baseline increases, differencing observations will not completely remove the error because each satellite is viewed at different angles by the
various ground receivers.

For precise GPS applications, precise ephemeris data should be implemented in the data

processing rather than in the broadcast ephemeris. Precise ephemerides are produced by

23

organizations such as the International GNSS Service (IGS), Jet Propulsion Laboratory

(JPL), and NRCan. Precise ephemerides are made available online at no cost, and deliver

accuracies that range from less than 5 cm when final precise orbits are used to about 10
cm when ultra-rapid orbits are used (El-Rabbany, 2006b).

2.3.4

Ionospheric Refraction

The ionosphere is part of the Earth's atmosphere, extending in various layers from about 50 km up to about 1,000 km or more above the Earth (Hofmann-Wellenhof et al., 2008).

Ionospheric disturbance is considered the largest error source in the GPS error budget, and a major cause of accuracy deterioration in GPS measurement, especially for singlefrequency users.

The ionosphere affects the speed, frequency, direction, and polarization of GPS signals,
and introduces phase and amplitude scintillation (Klobuchar, 1996). The ionosphere

causes GPS signal delays proportional to the total electron content (TEC) along the path
from the GPS satellite to the receiver. It also causes a delay in code pseudorange
measurement and advances the phase measurement by the same amount.

The magnitude of the ionospheric effect is inversely proportional to the signal frequency.

This means that GPS measurements made on L2 are more susceptible to the ionospheric

effect than are GPS measurements made on LI. The error introduced on the measured
range can vary from a few meters to many tens of meters at the zenith (Klobuchar, 1996).

24

The ionospheric error is highly unpredictable in extreme conditions. The error is a
function of various factors, such as: 1. Time of day. The greatest ionospheric delay is observed at midday (an increase of about 5 times), and the smallest delay is observed between midnight and early
morning. 2. Latitude of observer. Observers in equatorial and polar regions are subjected to more ionospheric disturbance than are observers in mid-latitude regions. 3. Time of year. Lower electron density levels are observed in the summer than in the winter (El-Rabbany, 2006b).

4.

Period within 11 year sunspot cycle. The sun passes through sunspot cycles of
about 11 years. The solar maximum occurs on average of 4.3 years during the cycle, and the time span between the solar maximum and the solar minimum is

approximately 6.6 years (Corcoran, 1998). The solar maximum is caused by an increase in sunspot activity accompanied by solar flares. A solar flare is an abrupt emission of high energy electrons from the sun into the solar atmosphere. The flare changes the electron density of the ionosphere, and results in degraded GPS positioning accuracy. We are currently (2008) at the beginning of solar cycle number 24, and the next solar maximum is expected in late 2011 or mid-2012.

5.

Elevation angle to the satellite. Satellites observed at low elevations (near the
horizon) are subjected to more ionospheric error than are satellites observed overhead
at the zenith.

25

6. Frequency of the transmitted signal. The ionospheric effect is inversely

proportional to the frequency of the transmitted signal. This means that LI
observations are less affected by ionospheric disturbance than are L2 observations.

The ionospheric effect must be corrected to derive an accurate result from GPS
measurements. The following five techniques are considered effective in reducing and/or
accounting for ionospheric error:

1. Relatively short baselines (less than 10 km) observations. Because ionospheric error

is highly correlated at both ends and is significantly minimized, relatively short baselines
lead to accurate relative positioning.

2. Using dual-frequency receivers
minimum

,. If data are being collected during periods of

solar activity, using dual-frequency receivers and combining carrier or pseudo-

range measurements from the dual-frequency receivers removes most of the ionospheric delay in the observation, and the remaining residual is almost negligible. The ionospheric
delay is removed by forming a linear combination observable (called L3) using data

collected at both frequencies (LI and L2), The linear combination of carrier and code
measurements is expressed in Equations 2.7 and 2.8 respectively (El-Rabbany, 2006a):
(2.7)

L3 = -

(2.8)

26

The draw-back of the linear combination (L3) is that it distorts the integer nature of the ambiguity parameter, and introduces more noise than do LI or L2. As the technique is also very expensive and not suitable for users with stringent cost requirements, singlefrequency users cannot benefit from using dual-frequency receivers and must rely on ionospheric models to count for this bias. Three ionospheric models are discussed below.

3. Klobuchar model. The Klobuchar model is a harmonics base model which uses a thin shell model of the ionosphere (Brown et al., 2001). The model uses the ionospheric coefficients transmitted as part of the GPS navigation message from each of the satellites. The draw-back of the model is that it assumes a fixed height of the ionosphere (at 350 km) although the height of the ionosphere varies (as mentioned at the beginning of
Section 2.3.4). Because of this drawback, the Klobuchar model will correct only for

about 50% of ionospheric delay. The detailed mathematical model can be found in
Hofmann-Wellenhof et al. (2008).

4. Regional or local ionospheric models. Various research initiatives have modeled

ionospheric delay at the local or regional level. This approach is considered an efficient
solution for accounting for the ionospheric effect for both short and long baselines. The
approach also improves the resolution of integer ambiguities. A new ionospheric model

was recently launched by the NOAA Space Environment Center. This regional model is

known as United States Total Electron Content (USTEC) maps, and cover regions across
the contiguous United States extending from latitude 10° to 60° North, and from

27

longitude 50° to 150° West (Rowell, 2005). USTEC maps have a spatial resolution of 1°
x 1°. More details about USTEC are provided in Chapter 4.

5. Global ionospheric models (IONEX). The IONosphere Exchange (IONEX) format was developed by IGS for the exchange of global ionosphere maps (GIM) (Schaer et al.,

1998b). GMs are generated on a daily basis at the Center for Orbit Determination in
Europe (CODE) using data from about 200 GPS/GLONASS sites of IGS and other
institutions. The maps are created by processing the double-difference carrier phase or

phase-smoothed code observations using the Bernese Processing Engine, and then analyzing the geometry-free linear combination (LC) which primarily contains ionospheric information (Schaer et al., 1998a). Instrumental biases (known as differential code biases) are estimated as constant values for each day for all GPS satellites and
ground stations. GMs are produced with 2-hours temporal resolutions.

IONEX files are produced on a daily basis as rapid global maps. The rapid global maps

are available with a delay of about 12 hours, and the final maps are available with a delay
of three days (Schaer et al., 1998a).

2.3.5

Tropospheric Refraction

The troposphere is the lower part of the atmosphere. It extends from the Earth's surface

up to about 50 km (the base of the ionospheric layer), and is composed of dry gases and
water vapour.

28

Tropospheric refraction is not frequency dependant, and has equal effects on carrier phase and code measurements, i.e., tropospheric refraction delays carrier phase and code

measurements by the same amount. The ranges that result are longer than the actual
geometrical distance (El-Rabbany, 2006b).

The delay is a function of temperature, pressure, and humidity along the signal propagation path. The effect is also governed by the satellite elevation angle, and by the altitude of the observer. The delay reaches its maximum value when the satellite is near
the user's horizon, and at its minimum value when the satellite is at the user's zenith.

Tropospheric delays can be attributed to dry or wet components. Dry tropospheric delay contributes about 90% of total tropospheric error, and wet tropospheric delay contributes about 10%. Various standard tropospheric models, such as the Hopfield and

Saastamoinen model, can be used to account for the dry component, but the wet
component is much more difficult to model due to temporal and spatial variations in water vapour (Hofmann-Wellenhof et al., 2008).

Tropospheric delay error could be significantly reduced by differencing observations between sites observed with relatively short baselines. Uncertainty in modeling the
troposphere will degrade the accuracy of the height component, and it will have smaller

effect on latitude and longitude (Rizos, 1996).

29

2.3.6

Multipath

Multipath is the phenomenon by which the signal reaches the receiver via more than one

path after being reflected or diffracted from various objects near the receiver (Braasch,
1996). Multipath is a major source of error in GPS positioning (Leick, 2004) and, as
mentioned in Section 1.1, multipath disturbance is a major challenge to GPS accuracy.

Multipath is mainly caused by reflecting surfaces near the receiver, but secondary cause

for multipath can be attributed to the reflections at the satellite, which is called satellite multipath (Hofmann-Wellenhof et al., 2008). Receiver multipath is more sever and
defined as the signal entering the antenna from different paths. These paths can be direct
line-of-sight signal and reflected signals from objects surrounding the receiver antenna
(El-Rabbany, 2006).

As multipath is localized and environmentally dependent, modeling multipath is a

complicated task, and the effect of multipath cannot be removed by differential
positioning. The path traveled by the reflected signal is always longer than the direct
path, as shown in Figure 2.2.

30

Reflecting

object Direct
Path

Receiving Antenna

Figure 2.2 Multipath Effect

Multipath can also be classified as long delay multipath or short delay multipath. Long delay multipath has little effect on GPS positioning, and can be resolved by the correlation function in the receiver. Short delay multipath, however, is caused by objects near to the receiver, and has a greater distorting effect on GPS positioning and navigation. This is because short delay multipath deteriorates the correlation function

between the contaminated signal and the locally generated reference in the receiver
(Kaplan, 2006). The effect of short delay multipath can, however, be estimated using a

combination of /, and f2 code and carrier phase measurements from a dual-frequency
receiver. (It is not possible to estimate short delay multipath when using a singlefrequency receiver.)

Various techniques and methodologies have been implemented to mitigate the effect of
multipath, including careful site selection, using special antenna types (such as choke-

ring), and using modern GPS receivers that employ mitigation algorithms at the receiver

31

signal processing level. The Multipath Elimination Delay Lock Loop (MEDLL) is an
example of a mitigation algorithm. However, Antenna and receiver mitigation techniques are less efficient for short delay multipath signals introduced by close-by reflectors,
located within 30 meters from the GPS antenna (Zhong et al., 2007).

Various new techniques and algorithms have recently been developed to mitigate
multipath effect in GPS measurements at post-reception level (i.e., after data collection).

The techniques include mapping the multipath environment surrounding the GPS antenna, analyzing the signal-to-noise-ratio (SNR) values of GPS signals, and employing
frequency domain analysis and comprehensive spectrum analysis techniques, including
wavelet transforms for GPS signals (Linyuan, 2004). More details about multipath are
provided in Chapter 3.

2.3.7

Receiver Noise

Receiver noise error is caused by the limitations of the individual receiver's electronics,

and is unique to each receiver. The limitations and associated errors may be due to the
receiver oscillator and/or other hardware components.

The effect of receiver noise error can be dramatically reduced by selecting a good quality
GPS receiver. The receiver noise error of modern receivers is, however, only about a decimetre or less, and can be ignored in most GPS applications (Kaplan et al., 2006).

32

2.3.8

Satellite Geometry

Satellite geometry describes the geometric locations of GPS satellites as seen by different users. Good satellite geometry is obtained when the tracked satellites are spread out in the
sky (El-Rabbany, 2006b).

Satellite geometry can be measured instantaneously by the Dilution of Precision (DOP)
factor (Hofmann-Wellenhof et al., 2008). Lower DOP values result iri more accurate GPS measurements, and vice versa. The effect of satellite geometry on the three-dimensional user's position (latitude, longitude, and height) is known as Position Dilution of Precision
(PDOP). PDOP can be broken into two components: HDOP which represents the

geometry effect on the horizontal component of the computed position, and VDOP which
represents the effect on the vertical component. As the geometry of satellites can be

predicted (using the user's approximate location and a recent almanac file), the effect of satellite geometry on the accuracy of the range solutions can be calculated using most
GPS software packages.

2.3.9

Hardware Delay

Hardware delay refers to time delays that occur during transmission of the GPS signal by

the satellite, and during reception of the signal by the receiver. Hardware delay errors are
classified as either satellite hardware delay or as receiver hardware delay.

Satellite hardware delay is defined as the delay that occurs between signal generation

inside the satellite signal generator and signal transmission by the satellite antenna (El-

33

Rabbany, 2006b). Receiver hardware delay is defined as the delay that occurs in the GPS
signal as the signal passes through the receiver-antenna, the analog hardware, and the
digital processing to the point where pseudorange and carrier phase measurements are

physically made within the digital receiver channel (Kaplan et al., 2006).

Hardware delays differ for carrier phase and pseudorange measurements because the
delays are frequency-dependant.

Hardware delay errors can be ignored for most dual-frequency users by forming the
ionospheric-free linear combination observable using measurements on both frequencies.
The errors can also be eliminated by differencing the observations between two stations

and two satellites (double differences solutions). Single-frequency users of C/A code observations can, however, only mitigate hardware delay errors by applying differential
code bias corrections (Cl-Pl) produced by IGS (El-Rabbany, 2006b).

34

3

MULTIPATH EFFECTS ON GPS MEASUREMENTS

Multipath is a major source of GPS error, and affects both pseudorange and carrier phase measurements. It is considered a challenging problem in many static and kinematic
applications.

This Chapter expands on the discussion of multipath provided in Section 2.4.6. Section 3.1 introduces the major features of multipath. Section 3.2 summarizes the causes of multipath, and Section 3.3 considers four characteristics of multipath (magnitude, satellite elevation, and signal-to-noise ratio). Section 3.4 presents a

repeatability,

mathematical model of multipath. Finally, Section 3.5 examines the main mitigation techniques available (antenna-based mitigation, improved receiver technology, and signal and data processing).

3.1

Introduction

Multipath is caused by signals being reflected or diffracted from objects close to the receiver and then being received by the antenna along with direct signals. The reflected or diffracted signals are phase shifted with respect to the originally transmitted signals, and result in degraded positioning and navigation solutions (Linyuan, 2004). Multipath

distorts the signal modulation, and degrades the accuracy in conventional and differential
systems (Braash, 1996).

35

Multipath is a localized and environmentally dependant phenomenon that cannot be mathematically modeled at the present time, and cannot be eliminated through
differential positioning. Differential carrier phase observations often use pseudoranges for initialization, but multipath corrupted pseudoranges can increase the time required for
ambiguity resolution, and can lead to the fixing of ambiguities to wrong values (Ray,
2000).

Various research studies have investigated remedies for the effects of multipath in GPS measurements. Careful site selection is the best strategy, and should be adopted to mitigate or avoid the effects of multipath, but ideal sites are not always possible especially in cities or built-up areas where multipath is highly prevalent. Consequently,
various hardware and software based solutions have been developed for multipath mitigation. Hardware based solutions include the use of special antenna types (such as choke ring antennas) during data collection, and employing receivers with built-in mitigation techniques such as narrow cross-correlator and Multipath Elimination Delay lock Loop (MEDLL) techniques. Software based solutions address multipath mitigation

at post-reception stage, and are categorized as geometrical modeling, time domain
modeling, frequency domain analysis, and comprehensive spectrum processing (Linyuan,
2004). '

3.2

Causes of Multipath

Multipath is caused by reflective physical, objects, such as trees, buildings and super structures, in the vicinity of the GPS receiver. These objects create reflected signals that

36

interfere with the direct line-of-sight signals transmitted by the satellites, and cause
biased range measurements when reaching the antenna.

Reflective surfaces could be classified to either smooth or rough surfaces. Smooth surfaces, such as the bodies of waters, can cause specular reflections which introduce
fluctuation of phase and amplitude of the received signal. In the case of specular

multipath the reflected signal is characterized by very little fluctuation in phase and
amplitude and therefore it is deterministic in nature (Ray, 2000).

On the other hand, rough surfaces, such as rocky ground, cause the reflected signal to be
scattered in all directions. This is known as diffuse multipath (Ray, 2000). Diffuse

multipath may be caused by a group of electrically small objects. The individual effect of
each object is almost negligible, but when summed together the effect could be in the

order of receiver noise (Braasch, 1996). Diffuse multipath is non-deterministic or
random, and consequently hard to model. It is treated like noise in many applications
(Ray, 2000).

Figure 3.1 shows the difference between specular and diffuse multipath.

37

Specular

Diffuse

Multipath

Multipath

Figure 3.1 Specular and Diffuse Multipath

Multipath errors of code pseudorange and carrier phase can be grouped into three classes
(Hofmann-Wellenhof et aL, 2008):

1. Diffuse forward scattering from a widely distributed area (e.g., the signal passes
through a cluttered metallic environment)

2. Specular reflection from well-defined objects or reflective surfaces in the vicinity of
the antenna

3. Fluctuations of very low frequency usually associated with reflection from the surface
of water

Multipath effect is frequency dependant, and its magnitude is inversely proportional to the frequency. As a result, code pseudorange measurements are more affected by multipath disturbance than are carrier phase measurements. Multipath disturbance for
code pseudorange measurement can reach several meters.

3.3

Characteristics of Multipath

It is important to have a good understanding of the characteristics of multipath

disturbance in order to prevent the phenomenon, mitigate its effects, or correct affected

38

signals.

This

section

discusses

the

magnitude

of multipath

(Section

3.3.1),

the

repeatability of multipath (Section 3.3.2), the impact of satellite elevation (Section 3.3.3), and the impact of signal-to-noise ratio (Section 3.3.4),

3.3.1

Magnitude frequency dependant, multipath has a greater effect on the

Because multipath is

pseudorange measurement than on the carrier phase measurement. Theoretically, the maximum multipath error in the pseudorange measurement can reach up to half of the

chip length of the code, i.e., the multipath error can reach about 150 m for C/A code
ranges, and about 15 m for the P (Y) code range. With the rapid development in receiver technology, however, typical multipath errors for the C/A and P (Y) codes are now much lower (generally less than 10 m). The maximum multipath error in carrier phase

measurements does not exceed one quarter of the wavelength, i.e., 4.8 cm for LI, and 6.1 cm for L2.

3.3.2

Repeatability

The repeatability of multipath disturbance is clearly evident when we consider the case of a GPS base station. Multipath disturbance follows a periodic pattern that is repeated each sidereal day (23h 56 min) for a static receiver (assuming that the antenna environment

remains the same). Because the satellite orbits the earth twice each sidereal day, the satellite returns to the same location four minutes earlier each day (Braasch, 1996). For consecutive days, the pattern of multipath disturbance appears very similar.

39

The repeatability of multipath disturbance can be used to build maps of multipath patterns at specific locations. These maps provide multipath corrections for each satellite
signal as a function of its azimuth and elevation (Axelrad et al., 1996).

3.3.3

Satellite Elevation

Satellites observed at low elevation angles are more susceptible to multipath disturbance

than are satellites observed higher in the sky (usually above 15°) or directly overhead (at
zenith). This is because multipath is affected by receiver-satellite geometry, and receiversatellite geometry is influenced mainly by reflecting objects (such as metallic fences, buildings, trees, and superstructures) in the vicinity of the observation site.

As satellites at higher elevations are less susceptible to multipath, these satellites are more reliable. Mask angles (either at the data collection or the post-processing stage)

should be set to observe higher satellites in order to obtain the cleanest and most reliable
measurements.

3.3.4

Signal-to-Noise Ratio (SNR)

SNR is a measure of the power gain of a system. It is the ratio of a given transmitted GPS signal to the background noise of the transmission medium:

SNR(dB) = lOlog

signal
10 noise

(3.1)

40

Higher SNR values indicate a cleaner signal. As a result higher SNR for the received

GPS signal indicates cleaner data compared to the reflected signal.

The power of the

reflected signal is attenuated and results in a delay to the signal reception time at the receiver. This is due to the longer path traveled by the reflected signal.

The SNR value could be used in the receiver design to reject signals that have a lower SNR than specified threshold.. Further details about this approach can be found in
Axelrad et al. (1996) and in Christopher et al. (1998).

3.4

Mathematical Model

The direct line-of-sight signal broadcast by the satellite can, for simplicity, be represented
by Equation 3.2 (Hofmann-Wellenhof et al., 2008):

SD = Acos<p

(3.2)

and the signal reflected by multipath can be represented by Equation 3.3:

SMP =fiAcos((p+A(p)

(3.3)

where A q> is the amplitude or power of the direct line-of-sight signal is the phase of the direct signal

J3

is the amplitude attenuation (or dumping factor) which is always in the range of
0 < J3 < 1, and is represented as the ratio of the reflected signal amplitude and the

amplitude of the direct signal (/? = --)
A

41

A<p

represents the total multipath phase shift which is a function of the geometric
configuration and mathematically expressed as:

where

/ is the frequency, Aris the multipath time delay, and 6 is the fractional
phase shift

From the above equations, we can see that the error introduced by multipath is characterized by four parameters: 1) amplitude; 2) time delay; 3) phase; 4) phase rate of change (Braasch, 1996). The composite signal reaching the antenna is the sum of the
direct and reflected signal (Hofmann-Wellenhof et al., 2008):
S -- SD + SMP
(3.5)

= Acos<p+j3Acos(<p+A<p)

where

cos((p+A(p) =
Accordingly, Equation 3.5 can be rewritten as
S = Acos,(p+fiAcostpcosAp-

(3.6)

Applying some rearrangement to Equation 3.6 yields
(3.7)

The resultant signal may be represented as

42

= fiMAcos(<p+A<pM)

(3.8)

where subscript M indicates the multipath. Applying the cosine-role gives

= (fiMcosA(pM)Acos<p-(j3MsmA<pM)Asin<p

(3.9)

Comparing the coefficients for A cos <p and Asin<p in Equation 3.7 and Equation 3.9
leads to the following relation:

j8M cos A<pM =

(3.10)

j3M sin A(pM -- fi sin Aq>

(3.H)

where fiM and Aq>M represent the desired multipath parameters explained at the beginning
of this section.

Solving for the values of /3M and AcpM gives

cos A<p

(3.12)

A(pM = tan"1

(3.13)

From the last two expressions, we can conclude that the zero multipath (direct signal)

will occur at (/? =0)and (A<pM =0°), and that the largest effect of multipath can be expected at (/? = l)and (A^M =90°) which equals a quarter of a cycle. Hence the
maximum multipath effect in LI is equal to 4.8 cm, and in L2 is equal to 6.1 cm.

43

3.5

Mitigation Techniques

As stated earlier, the best remedy for multipath disturbance is to prevent it by selecting sites that are free of multipath, but this solution is not always feasible. In structural
monitoring applications, it is especially difficult to find suitable antenna sites that are not
susceptible to multipath (Satirapod and Rizos, 2005).

Ray (2000) classified mitigation techniques into three groups:
1. Antenna-based mitigation

2.

Improved receiver technology

3.

Signal and data processing

3.5.1

Antenna-Based Mitigation

Antenna-based mitigation implies the use of special antenna types, the design of which gives special consideration to multipath disturbance. This section discusses four
approaches to antenna-based mitigation.

(a)

Shaping the Gain Pattern of the Antenna

The first approach is shaping the gain pattern of the antenna. This approach is based on

the fact that the signals received by the GPS antenna come from various directions and
are emitted from different satellites at various elevations.

L

The technique reduces multipath by designing antennas with low gain for signals coming
from satellites at low angles of elevation. As satellites at low elevation are more

44

susceptible to multipath interference, the technique attenuates and rejects all signals
coming from these satellites.

(b)

Using Antenna with Polarization Discrimination Technology

The second approach takes advantage of polarization discrimination technology. A GPS line-of-sight signal is a right-handed circularly-polarized (RHCP) transverse

electromagnetic wave (Ray, 2000). On the other hand, the reflected signal is left-handed
circularly polarized (LHCP).

An antenna with polarization discrimination technology will reject any signal that does
not match the polarization of the line-of-sight (RHCP) GPS signal. If, however, the reflected (LHCP) GPS signal is reflected twice, the signal will reach the antenna as a

RHCP signal, and the polarization discrimination capability of the antenna will be
ineffective in detecting the reflected signal (El-Rabbany, 2006b).

(c)

Chock-Ring Antenna

The third approach uses a chock ring antenna. A chock ring antenna is built with a ground plane that consists of several rings, or metallic circular grooves, with quarterwavelength depth (Leick, 2004). Chock rings are very effective and can significantly eliminate multipath signals reflected from objects below the antenna (i.e., signals reflected from the ground), but signals reflected from objects above the antenna (e.g., tall buildings, trees) still present a significant challenge for antenna designers.

45

Figure 3.2 shows an example of chock-ring antenna.

Figure 3.2 A chock-ring antenna (courtesy of Trimble Navigation. Available at
http://www.trimble.com/gnsschokering.shtml)

Chock rings can also feature increased antenna gain in the direction of the zenith. Ordinary chock ring antennas are designed to work with only a single frequency, either LI or L2, but dual frequency choke ring antennas can provide good multipath rejection for both LI and L2 bands. Dual frequency choke ring antennas were introduced by
Philipovetal. (1999).

(d)

Using Arrays of Antennas in Close Proximity

The fourth approach uses arrays of closely-spaced antennas to mitigate multipath. Ray
(2000) used six antennas mounted together on a thick aluminum plate. The antennas were

46

spaced about 5 to 10 cm apart, and used to estimate the multipath error and remove it
from the raw measurements.

The closely-spaced antennas technique is based on the correlation nature of multipath, along with the known geometry among the antennas to estimate the parameters of the
composite signal and isolate the error due to all multipath signals. In this method, the multipath is seen by each antenna differently because of varying multipath geometry. Consequently, the signals coming from all antennas will be

processed together to mitigate the multipath disturbance (Leick, 2004).

Intensive field tests have demonstrated the efficiency of using arrays of antennas in close proximity. The method removes up to 73% of multipath in code, and up to 70% of multipath in the carrier residuals (Ray, 2000).

3.5.2

Improved Receiver Technology

Manufacturers of GPS receivers have also considered the issue of multipath by carefully addressing the design of their receivers. Rapid developments have been made in the
receivers' processing algorithms. Most receivers' multipath mitigation techniques are based on the maximum likelihood estimation theory (Sahmoudi et al., 2006). These mitigation techniques employ special signal processing of the autocorrelation function to separate the received GPS signal into direct line-of-sight and multipath components, and

then to measure the autocorrelation function.

47

Several techniques are available. Three major techniques are:

-

The Narrow Correlator technique was developed to separate the line-of-sight and multipath signals. The technique attempts to reduce or eliminate the effect of
multipath by tracking only the line-of-sight signal. Narrow Correlator has a 0.1
chip spacing, and efficiently mitigates long delay multipath (Ray, 2000).

-

The Multipath Elimination Technique (MET) was developed by Townsend and
Fenton (1994) to improve the performance of the Narrow Correlator technique.

MET estimates the parameters of the line-of-sight and multipath signals, and
approximates their combined effects on the tracking errors.

-

The Multipath Estimation Delay Lock Loop (MEDLL) technique. MEDLL
employs multiple narrow-spaced correlators to simultaneously estimate the

parameters of the line-of-sight and multipath signals, and to remove the multipath
from the autocorrelation function (Richard et aL, 1994). Extensive field tests have

demonstrated the robustness of MEDLL in reducing the GPS code and carrier
multipath errors by 90%, as compared to receivers with a small early-late spacing
(Townsend et al., 2000).

Other techniques include the Multiple Signal Classification (MUSIC) technique, the
Edge Correlator technique, the Strobe Correlator, and Pulse Aperture Correlator
technology (PAC) introduced by Novatel Inc. These four multipath mitigation

techniques can be very effective in mitigating long delay multipath, but their
performance is degraded for short delay multipath introduced by objects close to the
GPS antenna (e.g., less than 30 meters).

48

3.5.3

Signal and Data Processing

Software approaches for mitigating multipath disturbance in recorded GPS observables have been widely explored in recent years. The approaches included addressing SNR
values, spectral analysis, and wavelet analysis.

One software approach addresses SNR values (Axelrad et al. 1996). The technique is based on the fact that direct-line-of-sight signals have high SNR value's which indicate their power level. SNR values that fall below a specified threshold can be attributed to
multipath, but the approach requires knowledge of the antenna gain pattern, and can only work well with slow or short delay multipath.

The spectral analysis-based technique explores the effect of multipath in the frequency
domain. The measured signal is transformed from the time domain to the frequency

domain using Fast Fourier Transform (FFT), and the multipath effect is detected and reduced using amplitude filtering. The clean data is then transformed back from the frequency domain to the time domain using Inverse Fast Fourier Transform (IFFT)
(Hofmann-Wellenhof et al., 2008).

A novel software approach based on wavelet analysis was recently introduced to mitigate multipath in GPS signals. The technique is based on decomposing the GPS signal
(residuals or double difference solutions) into high frequency noise and low frequency bias. The multipath effect is then identified from the low-frequency approximation output of the decomposition, and excluded from the final solution. Various researchers have

49

confirmed the potential use of this method in mitigating the effect of multipath on GPS
measurements (Linyuan et al, 2001; Satirapod and Rizos, 2005; Aram, et al., 2007).

50

4

FIELD WORK AND DATA PRE-ANALYSIS

This Chapter addresses the details of the methodology adopted to meet the objectives of

the research: to use db-8 wavelet analysis to investigate the multipath effect in satellite signals with a view to developing a low-cost, high accuracy, single-frequency global
positioning system under multipath environments. Section 4.1 describes the equipment and software used. Section 4.2 describes how the equipment was set up in the field.
Section 4.3 provides information about the collection of the field data. The two base stations and the four data collection points used in the static baseline tests are described. The four data collection points were selected to illustrate a variety of typical multipath situations so that multipath effect on observations could be analyzed in detail. Section 4.3
also introduces the equipment used in the kinematic baseline test.

The data pre-analysis is discussed in Sections 4.4 and 4.5. Section 4.4 provides a detailed

discussion of the computation of the code-minus-carrier residuals for each satellite. The analysis gives special attention to ionospheric delay and multipath disturbance. Section
4.5 explains the ionospheric corrections undertaken in this study. The analysis uses NOAA ionospheric maps based on spatial and temporal interpolation methods to model the ionospheric delay in the LI measurements. The ionospheric corrections are applied to the computed code-minus-carrier residuals to generate ionospheric-free residuals, and the
results are quality-control tested to check their reliability. The ionospheric-free residuals

are used as input-data for the proposed wavelet algorithm (Chapter 5).

51

4.1

Description of Equipment

Three receivers were used to collect the data required for the proposed research: the
Trimble R8 dual-frequency receiver, the NovAtel ProPack-V3 dual-frequency receiver,
and the AC 12 single-frequency GPS receiver.

Trimble R8 Dual Frequency Receiver

The Trimble R8 dual-frequency receiver is a 24-channel, dual-frequency GPS receiver,
GPS antenna, and data-link radio combined in one compact unit with low power

consumption. It is shown in Figure 4.1 (Trimble, 2007b). The Trimble R8 was used to log
data at the Toronto base-station for the entire period of field data collection.

Figure 4.1 Trimble-R8 GPS Receiver

NovAtel ProPack-V3 Dual-Frequency Receiver

The NovAtel ProPack-V3 is a high performance geodetic GPS dual-frequency receiver with built in multipath mitigation using Pulse Aperture Correlator (PAC) technology. PAC technology offers superior multipath detection to eliminate the effect of multipath

and flag poor signal quality (Jones et al., 2004). This receiver was used to collect the
truth data (known coordinates) at all sites observed in static mode (Steel, Milton, Ryerson

and PIER), and to collect the reference trajectory data observed in kinematic mode. The
52

unit also simultaneously logged data with the AC 12 single-frequency receiver (Section
4.1.3) via an antenna splitter during the whole period of field data collection.

Translating, Editing, and Quality Checking (TEQC) software was used to analyze the

data collected by the NovAtel ProPack-V3, to compute the multipath effect on the Lifrequency, and to use it as the truth data against the multipath approximation derived by the proposed wavelet algorithm (db8).

The NovAtel receiver is shown in Figure 4.2.

Figure 4.2 NovAtel-ProPack-V3 Dual-Frequency Receiver

AC 12 Single-Frequency GPS Receiver The AC 12 single-frequency GPS receiver was selected as a low-cost GPS suitable for collecting the LI-measurements necessary for this research. The AC 12 is a rugged lowcost sensor with precise carrier phase tracking and raw data output capabilities (i.e., code and carrier phase on LI). Figure 4.3 shows the AC 12 GPS receiver.

53

Figure 4.3 AC 12 Ll-GPS Receiver

The AC 12 receiver is a 12-channel GPS receiver which tracks and processes data from up

to 12 satellites. The programmable data rate ranges from 1 to 99 seconds. The unit is
capable of outputting navigation information, including position, velocity, time, receiver

and satellites status, and 1 pulse per second (PPS) timing output. The receiver has low power consumption (1-watt), compact size (111.2 x 104.6 x 29.5 mm) and a small weight
(240 grams). It can be used with either low-cost navigational or geodetic GPS antennas.

The receiver can output raw data through RS-232 interface cable and should be
connected to a data logger or a laptop.

Windows-based Geodetic Base Station Software (GBSS) software was used to receive,

display and log the raw data (both pseudorange and carrier phase). GBSS supports the creation of various file types, including RINEX, and outputs them to a user pre-defined directory. GBSS can be used to configure the receiver settings, such as logging interval and elevation mask, to uploading site data to the GPS receiver, and to enter site-specific data into the receiver. Site-specific data include site name, antenna height, and the WGS84 position of the site. GBSS is also used to display the status of the data collection,

54

information about individual satellites being tracked, and the geodetic and ECEF position windows. Further details about the AC 12 receiver and GBSS software are available in
Magellangps (2007) and GBSS (2007), respectively.

4.2 The

Description of Test Setup AC 12 single-frequency low-cost GPS receiver and the NovAtel ProPack-V3

geodetic dual-frequency GPS receiver were connected to a common dual-frequency NovAtel geodetic antenna to collect the data simultaneously. The data were logged to
both GPS receivers via an antenna splitter. Data were collected at a recording rate of lHz

for 2 hours in static mode. This was done to ensure that enough observables were collected to meet the objective of the proposed research. Figure 4.4 shows the data
collection setup: the two GPS receivers connected via an antenna splitter to the same antenna, a lap-top used as a data logger, and an external power source.

Figure 4.4 Field Data Collection Set-Up

55

4.3

Field Data Collection

The field data collection began on July 31, 2007 with the collection of both static and
kinematic data at various locations for three consecutive days. Section 4.3.1 discusses the two base stations, and Section 4.3.2 discusses the four data collection points used in the
static baseline tests. Section 4.3.2 outlines the set up for the kinematic baseline test.

4.3.1

The Two Base Stations

As mentioned in Section 1.3, the data were collected at two base stations: Toronto

(located in Etobicoke, Ontario), and PWEL (located across Lake Ontario in Port Weller, Ontario). The base stations served as reference stations, and were carefully selected to be
of minimal multipath or interference and with accurately determined coordinates. The

Toronto base station was used for short-baselines estimation, and PWEL was used for
long-baselines estimation.

The Toronto base station is located on the top of a hill inside the grounds of Humber
College of Applied Arts and Technology in Etobicoke, Ontario. The station is a concrete

pillar with a steel top plate which was established by the Geodetic Survey Division
NRCan. The Trimble R8 dual-frequency GPS receiver was installed on the concrete pillar
when static and kinematic data were being collected.

56

The Toronto station is shown in Figure 4.5.

Figure 4.5 Toronto Base Station

The PWEL base station is located in Port Weller, Saint Catharine's, Ontario. This station was also established by the Geodetic Survey Division of NRCan, and serves as a

continuous tracking site for the Canadian Active Control System (CACS) network. In this
research the PWEL site was chosen to test the performance of the proposed low-cost

system with longer baselines, and to enhance the low-cost concept by eliminating the
need of running a separate base station.

4.3.2

The Four Data Collection Points for the Static Baseline Tests

Four different data collection points located at various distances from the proposed base

stations (Toronto and PWEL) were selected for the static GPS observations: Steel,
Ryerson (downtown Toronto), PIER, and Milton. The distance between the base stations
and the points ranged from 10 km to 65 km.

57

Figures 4.6 and 4.7 show the locations of the data collection points and their approximate
baselines to the two base stations: Toronto and PWEL respectively.

20 km

TORONTO

10 km

20 km
.o
Brampton

Toronto Island'

Mississauga

® 2008 TumHere, Inc 2008 European Space Agency

Figure 4.6 Approximate Baseline Lengths when using Toronto Base Station

58

Richmond Hill

Markham

65 km

PickeringoAjax

58 km

Brampton
(onto, sand

63 km

q Mississauga

Halton Regional Municipn

O Oakville

'v

v ,,,

q Burlington

008 Europa Technologiet



Figure 4.7 Approximate Baseline Lengths when using PWEL Base Station

The data collection points were selected to verify the effectiveness of the proposed lowcost system at different locations by testing a variety of baseline lengths and multipath environments. The multipath environments represented different built-up densities (from

rural to downtown Toronto). The sections that follow discuss each data collection point.

59

(a)

Steel. The Steel data collection point was located in a parking lot at the

intersection of Yonge and Steeles streets. See Figure 4.8. The point was selected to represent a small to moderate multipath environment: trees and some buildings. The point
is located about 20 km from the Toronto reference station, and about 65 km from the
PWEL reference station.

Figure 4.8 The Steel Data Collection Point

(b)

Ryerson. The Ryerson data collection point was located at the intersection of

Jarvis and Gerrard streets in the heart of downtown Toronto. It is located about 70 m
from the civil engineering building of Ryerson University. See Figure 4.9. The point was selected to represent a very harsh multipath environment: surrounded by tall buildings
and various structures. The point is located about 21 km from the Toronto reference
station, and about 49 km from the PWEL reference station.

60

Figure 4.9 The Ryerson Data Collection Point

(c)

PIER. The PIER data collection point was located at the MTC complex, 1201

Wilson AVE, Downsview, ONTARIO. The point is a concrete pillar established by the
Geodetic Survey Division of NRCan with precisely known coordinates on both NAD83

and ITRF reference systems. The point was selected to examine the effect of foliage or
dense trees on receiver performance. See Figure 4.10. Foliage is known to cause excess

attenuation of the direct path, and this is known as shadowing (Kaplan et Al., 2006). If the reflected signal is not subject to the same attenuation as the direct signal, the received

power of the reflected signal (multipath) may be greater than the received power of the
shadowed direct path. This will introduce errors in the pseudorange and carrier phase

measurements, leading to errors in the position determined for the observed point. The PIER data collection point is located about 10 km from the Toronto reference station, and
about 58 km from the PWEL reference station.

61

Figure 4.10 The PIER Data Collection Point

(d)

Milton. The Milton data collection point was located in an open rural area. This

type of area was selected to represent areas with minimal multipath effect. The major multipath was introduced by the parked vehicle. Figure 4.11 shows the rural nature of the
Milton data collection point and the parked vehicle. The Milton data collection point is

located about 26 km from the Toronto reference station, and about 63 km from the PWEL
reference station.

Figure 4.11 The Milton Data Collection Point

62

4.3.3

Kinematic Baseline Test

To test the performance of the AC 12 single-frequency receiver in kinematic mode, the
receiver was connected to a geodetic-quality antenna mounted on the roof of a vehicle, as shown in Figure 4.12. A dual frequency receiver was collecting data simultaneously from the same antenna using an antenna splitter, as shown in Figure 4.13. The kinematic data collected by the dual frequency receiver were used as a reference (truth data) to check the performance of the low-cost AC 12 single-frequency GPS sensor. The data were logged at
a recording rate of 1 Hz.

Figure 4.12 Antenna Set-Up for Kinematic Observation

63

Figure 4.13 Receivers Set-Up for Kinematic Observation

4.4

Computation of Code-Minus-Carrier Residuals

At the end of each day of observations, the data were downloaded from the base station receiver using Trimble Data Transfer Utility software. All the observation files were then

converted to RINEX format using TEQC software. This section explains the detailed procedure for computing the code-minus-carner residual using LI-observations collected
by the single-frequency sensor.

The code-minus-carrier residual is computed by subtracting the LI carrier-phase from the

LI pseudorange measurements. Equations 4.1 and 4.2 represent the pseudorange and carrier phase observations respectively. (Pseudorange and carrier phase are explained in
Chapter 2.)

= p(t,t-T)+c[dt,(t)-dt' (t -T)]+dtmp +d,m +c[d,(t)+dJ(t-r)]+dmp + ep
(4.1)

64

= P(t,t -z)+c[dti{t)-dti (t -t)]+AN +dtmp-dion+c[Si(t) + Sj (t -r)]+Smp+e0
(4.2)

When we take the difference (code-carrier) between the two observables, relativistic
effects and the effects of geometry, tropospheric delay, satellite and receiver clock errors,

and antenna phase centre variations are eliminated. The terms that remain include the
multipath effect in both the carrier phase and the code measurements, twice the

ionospheric effect, the ambiguity term, the hardware delay, and the receiver noise, as
shown in Equation 4.3:

«2rfta -XN+c\dt (t)+dJ (t -tj]+dnp +£p The carrier phase multipath and noise are negligible when compared to the code multipath and noise (Braasch, 1996), and could be removed from Equation 4.3. The

hardware delay is caused by the equipment delay at the satellite emission and the signal
reception at the receiver. The differential hardware delay is very stable over time and can be removed by taking the mean of the residual (El-Rabbany, 2006a). As a result,
Equation 4.3 can be simplified as shown in Equation 4.4:
(4.4)

The terms in Equation 4.4 represent twice the ionospheric effect, and the C/A code
multipath and noise, offset by a constant DC-component due to the carrier phase

ambiguity (Langley, 1998). When the measurement is clean and has no cycle slips, the range due to the differential integer ambiguity is constant over time, and hence the effect

65

of integer cycle ambiguity can be removed by subtracting the mean of the residuals. The
remaining residual is then represented by Equation 4.5:

inn

^*^twn

^^T)

\

*

/

After removing the ambiguity term, the remaining residual now mainly represents the

multipath and twice the ionospheric effect as low frequency errors beside some other high frequency noises. A Matlab code was used to analyze all the observations. (The Matlab code arranges the corresponding observables (code and carrier) for each satellite into separate columns and saves them for further analysis.) Figures 4.14 to Figure 4.16
show the computed residuals for selected satellites before applying the ionospheric
correction.

Figure 4.14 shows the PRN31 residual collected using the AC 12 single-frequency GPS receiver at point Ryerson. Point Ryerson is surrounded by tall buildings and road signs (as shown in Figure 4.9). Additional multipath was introduced by passing vehicles. The residual for PRN31 shows large fluctuations at large magnitudes. These large fluctuations indicate a dominant multipath effect on the residual as compared to the slowly varying ionospheric delay. The peak-to-peak variation for this satellite is about 3.5 metres.

66

Residual for PRN31\*ithout iono correction

1.5
1

l

1,

0.5
0

-0.5
-1

T

V il J n

1!
2000 4000
Epochs in Seconds

-1.5

6000

8000

Figure 4.14 Residual for PRN31, observed at Ryerson

Figures 4.15 and 4.16 show the residuals for PRN31 (Point PIER) and PRN03 (Point Steeles) respectively. The two figures show low-frequency noise components related to

multipath and ionospheric delay, and high-frequency noise components attributed to

observation noise. The ionosphere is typically a long-term drift, and can easily be
distinguished from the higher frequency multipath errors (Braasch, 1996).

Figure 4.15 shows a clear upward trend in the residual. This trend could be attributed to
the ionospheric delay.

67

Residuals for PRN31 Wthout iono correction-PIER

-3

0

1000

2000

3000

4000

5000

6000

Epochs in seconds

Figure 4.15 Residual for PRN31, observed at PIER

Figure 4.16 shows large fluctuations. These fluctuations indicate a dominant multipath
effect on the residual as compared to the slowly varying ionospheric delay. The peak-topeak variation for this satellite is about 4.5 metres.

68

Residuals for PRN03 without iono correction-Steel
i

0

P Mn
fV
500 1000 1500 Epochs in seconds 2000

-1

-2

-3

0

Figure 4.16 Residual for PRN03, observed at Steel

4.5

Ionospheric Correction

As discussed in Chapter 2, if we are to obtain accurate GPS measurements, we must correct for the ionospheric effect. Ionospheric disturbance is the largest source of GPS measurement error, especially, for single-frequency users, and observers whose baselines
are more than about 10 km.

For dual-frequency users, ionospheric delay can be removed by forming the L3 linear combination observable (combining LI and L2 data), but this approach is very expensive, distorts the ambiguity parameter, and introduces additional noise. Single-frequency users

must account for ionospheric effects by using ionospheric models. (The models are
introduced in Chapter 2.)

69

In this study, ionospheric error was removed using the high resolution USTEC
ionospheric maps produced by NOAA. Section 4.5.1 describes the USTEC maps. Section
4.5.2 describes the procedure used to reduce ionospheric disturbance.

4.5.1

United States Total Electron Content (USTEC)

The USTEC maps fall into the category of regional and local ionospheric models (see

Chapter 2). The maps are produced by the Space Environment Center (SEC) of NOAA. The technique used to create the maps is based on the Kalman Filter based data
assimilation algorithm. The technique images the Earth's ionosphere in four dimensions

using data from ground-based dual-frequency GPS receivers (NOAA, 2007b). USTEC
ASCH files contain the vertical Total Electron Content (VTEC) and the slant line-of-sight electron content (STEC) to each satellite. The files are produced every 15 minutes, and

cover all the satellites in view within the spatial coverage. The maps have a spatial
resolution of 1° x 1° and cover regions across the contiguous United States extending from latitude 10° to 60° North, and from longitude 50° to 150° West (NOAA, 2007a). The expected accuracy of the USTEC maps is in the range of 1 to 3 TEC units. The differential vertical TEC has an average root mean square error of 1.7 TEC units, which

is equivalent to less than 30 cm of signal delay at the GPS LI frequency, while The differential slant TEC has an average root mean square error of 2.4 TEC units, which is
equivalent to less than 40 cm of signal delay at the GPS LI frequency (Rowell, 2005).
These maps can be downloaded from the SEC web page at

" http://www.sec.noaa.gov/ustec.

70

4.5.2

Procedures used to Reduce Ionospheric Delay

To compute the amount of ionospheric correction necessary for the data collected by the

single-frequency receiver at each location in this study, it is first necessary to compute
the TEC values that correspond to the locations of the data collection points, and match
the time and rate of data collection. Unfortunately, the study's data collection points may

not lie exactly on the TEC grid provided by NOAA, and it is therefore necessary to interpolate the point's value using a two-dimensional spatial interpolation procedure.
Time must also be considered. The USTEC grid file may not corresponds exactly to the

time and rate of data collection. This problem is overcome by temporal interpolation
using the Lagrange interpolation method. The following sections describe the

interpolation methods used in this research to reduce ionospheric disturbance.

(a)

Two-Dimensional Spatial Interpolation

The two-dimensional spatial interpolation was a three step process.

The first step was to use the latitude and longitude of the data collection point to locate
the point within the grid of the USTEC downloaded file, as shown in Figure 4.17.

71

En (<Pi, fa)

E"(<p,fa)

E22 (<P2, fa)

Figure 4.17 Two-Dimensional Spatial Interpolation

where

(<Pk Aj)

is the latitude and longitude values at the four corners (known)

is the latitude and longitude values at the desired point (known)
is the TEC value at /, j corner (known)
E

is the required TEC value at the data collection point (unknown) are TEC values at points ((p, fa) and ((p, fa) respectively (unknown)

E',E"

The second step computed the values of E' and E." These values are aligned at the same level of latitude with the data collection point, and were determined by linear
interpolation on the vertical level as follows:

E'=\
(4.6)

\{E22-En) + E12

(4.7)

72

The third step computed the desired TEC values at the observed point by linear
interpolation on the horizontal level as follows:

E=\

(4.8)

(b)

Temporal Interpolation using the Lagrange Method

The USTEC files are released at 15-minute intervals, but the data were collected at one
second intervals. As a result, the study's observation epochs may not coincide with the time of the USTEC file, and interpolation may be required. The Lagrange method was
used in this research.

The Lagrange formula is a mathematic expression that fits a particular data set to a

polynomial curve which can be used later for interpolation purposes. Let/ft fi, f2, ...,/,, be
the values of the given data at times to, th t2, ..., tn, respectively. The approximated value of the function p(t) at a particular instant t is given by Equation 4.9 (Yousif and ElRabbany, 2007):

^ +-+anfn

=
i=0

(4.9)

where:

ti -ti+l)-(ti -tn)

(4.10)

73

Since the at coefficient is a function of t, it can also be referred to as U(t). U(t) is called
the Lagrange operator. Substituting t by t0, h, t2,....tn in Equation 4.10, we get:

(4.11)
0 otherwise

Going back to Equation 4.9, and substituting t by t0, tut2,...-tn again, we get:

P(to) =f0 , P(tl) =fl > P(h) =/2 , - . PM =fn

It is important to note that the accuracy of Lagrange interpolation degrades at the boundaries. Applying the Lagrange formula in its regular form may develop appreciable

spikes near the boundaries, but an algorithm can be applied to reduce the error. In this
study, a hybrid of linear interpolation at the boundaries was carried out in addition to the
Lagrange interpolation procedure (Yousif and El-Rabbany, 2007).

Finally, the interpolated TEC values were converted to meters before applying them to

the computed residuals. The following equations were used to convert the TEC values to
meters:

40.3TEC
Tl /l

(4.13)

TECU =

10

electrons
m

(4.14)

40.3(M016)
iono

(4.15)

(1575420000)'

/i fi c a ^tr\r\nr\\ 2

74

1 TECU = 0.16237244751 meter

Before these ionospheric corrections were applied, quality control tests were conducted to verify the Effectiveness of the interpolation methods. The results of the quality control tests are shown in Figures 4.18 to 4.21. hi the quality control tests, the study's dualfrequency data were used to compute the ionospheric correction (ionospheric differential
delay) using the linear combination, as shown in Equation 4.16: '-

f2
ionol

J\

f -- J2 f'

(4.16)

where Co contains the phase multipath, hardware delay and phase noise:

Q. =

{noisetb2 -noise

m

(4.17)

hi Equations 4.16 and 4.17, the values of the integer carrier phase ambiguities, hardware delay, carrier phase multipath and noise are not exactly known. The contribution of these terms is, however, considered constant over time (assuming clean measurement and no cycle slips), and is removed by subtracting the average of the computed values. Hence
Equation 4.16 can be rewritten as:

wnui

U. --

2

,2

(4.18)

:1.5457(<D1-O2)

(4.19)

75

Figure 4.18 shows the ionospheric correction derived for PRN05 observed at Ryerson on day 214. The average difference between the ionospheric errors computed using the two strategies (L1-L2 IONO and NOAA IONO) and shown in Figure 4.18 is 7.744 cm. This
result verifies the success of the interpolation method.
Ionosphric error in Ll-data fo PRN 05-Ryerson
-x

L1-L2IONO

2.9
2.8 2.7

NOAAIONO

2.6
2.5 2.4

4/
/
f
'^^^ 1
I

r

/

2.3
t >

1 1

0

500

1000

Epochs hi seconds

1500

2000

2500

3000

3500

Figure 4.18 Ionospheric Corrections for PRN 05, observed at Ryerson

Figure 4.19 shows the cross-correlation function between the interpolated and computed
ionospheric corrections determined above. As expected, the correlation is high.

76

-o..

500

1000

Time lags in seconds

1500

2000

2500

3000

3500

Figure 4.19 Cross-Correlation Function for PRN05 Ionospheric Correction

Figure 4.20 shows the ionospheric correction computed for PRN20 observed at Steel on day 212. The average difference between the two variables plotted is 3.219 cm, clearly
indicating that the interpolation was successful.
IONOSPHERIC ERROR IN L1 for PRN 20-STEEL
L1-L2 IONO

NOAA IONO

1000

2000

3000

Epochs in seconds

4000

5000

6000

7000

8000

Figure 4.20 Ionospheric Corrections for PRN 20, observed at Steel

77

Figure 4.21 shows the high correlation between the interpolated and computed
ionospheric corrections for PRN20.

\

1

l_

\
"°'4O

J*

1000 2000 3000 4000 5000 6000 7000 8000
Lags in second

Figure 4.21 Cross-Correlation Function for PRN 20 Ionospheric Correction

The results showed that the correlations between the interpolated ionospheric values and the ionospheric correction determined by the linear combination were very high. The ionospheric correction interpolated from the USTEC model was then used to account for the ionospheric delay in all satellite residuals pertaining to Ll-observations. The
ionospheric effect was subtracted from the residuals in order to generate ionospheric-free

i J41-

i

--

i

--

i i 1

--

--i

--

i

i

i

residuals and use them as inputs for multipath approximation using wavelet analysis.

The remaining terms then represent mainly the code multipath and receiver noise, as
shown in Equation 4.20:

H
78

"

<4'20)

Figure 4.22 shows the PRN31 residual observed at Ryerson on day 214 before and after
applying the ionospheric correction. The range and standard deviation of the applied

ionospheric correction are 1.067 m and 0.255 m, respectively. The ionospheric delay is
small because the satellite was at a high elevation during the observation period (rising from 52° to 80°), and ionospheric delay is small at high elevation angles. The standard deviation for the PRN31 residual before and after applying the ionospheric correction is
0.543 m and 0.446 m respectively. <

Residuals for PRN31 with & Wo iono correction
2 1.5
1
r I

Residual Wo iono correction

Residual with iono correction
i i

i

8 0.5

-0.5
-1
I

^B-^MB JjL

f

-1.5

r
2000 4000
Epochs in Seconds

-2

0

6000

8000

Figure 4.22 Residual for PRN31 Before and After Removing the Ionospheric Effect,
observed at Ryerson

Figure 4.23 shows the residual for PRN31 observed at PIER before and after removing the ionospheric effect. As this satellite was setting during the observation period (44° -

0°), the magnitude of the ionospheric delay is higher than that of satellites at higher
elevations. The ionospheric correction range and standard deviation for this satellite are

79

Figure 4.21 shows the high correlation between the interpolated and computed
ionospheric corrections for PRN20.

~°-40

1000 2000 3000 4000 5000 6000 7000 8000
Lags in second

Figure 4.21 Cross-Correlation Function for PRN 20 Ionospheric Correction

The results showed that the correlations between the interpolated ionospheric values and
the ionospheric correction determined by the linear combination were very high. The

ionospheric correction interpolated from the USTEC model was then used to account for
the ionospheric delay in all satellite residuals pertaining to LI-observations. The ionospheric effect was subtracted from the residuals in order to generate ionospheric-free

residuals and use them as inputs for multipath approximation using wavelet analysis.

The remaining terms then represent mainly the code multipath and receiver noise, as
shown in Equation 4.20:

-^H

(420)

78

Figure 4.22 shows the PRN31 residual observed at Ryerson on day 214 before and after applying the ionospheric correction. The range and standard deviation of the applied
ionospheric correction are 1.067 m and 0.255 m, respectively. The ionospheric delay is

small because the satellite was at a high elevation during the observation period (rising from 52° to 80°), and ionospheric delay is small at high elevation angles. The standard

deviation for the PRN31 residual before and after applying the ionospheric correction is 0.543 m and 0.446 m respectively. Residuals for PRN31 with & Wo iono correction
2

 Residual Wo iono correction

1.5
1

Residual vwth iono correction

0.5
0

\ -0.5
-1 -1.5 -2 0

2000

4000

6000

8000

Epochs in Seconds
Figure 4.22 Residual for PRN31 Before and After Removing the Ionospheric Effect, observed at Ryerson

Figure 4.23 shows the residual for PRN31 observed at PIER before and after removing the ionospheric effect. As this satellite was setting during the observation period (44° -

0°), the magnitude of the ionospheric delay is higher than that of satellites at higher

elevations. The ionospheric correction range and standard deviation for this satellite are

79

5.654 m and 1.621 m respectively. We can see that the upward trend in the residual was

caused by the ionospheric delay. This upward trend was successfully removed when the ionospheric correction was applied to the residual. The standard deviation for this
residual before and after applying the ionospheric correction is 1.691 m and 0.519 m,
respectively.

Residuals for PRN31\*ith & Wo iono correction-PIER
Residual Wo iono correction
4
3h

1

Residual with iono correction
<

.£

"30

1000

2000

Enochs in second

3000

4000

5000

6000

Figure 4.23 Residual for PRN31 With and Without the Ionospheric Effect, observed at
PIER

Figure 4.24 shows the residual for PRN03 observed at Steel. As this satellite was just rising during the observation period (0° - 25°) and was still at very low elevations, the
range and standard deviation of the ionospheric correction is high: 4.228 m and 1.219 m,

respectively. Figure 4.24 shows that large fluctuations still exist in the residual even after applying the ionospheric correction. This is an indication for the presence of multipath

80

disturbance. The standard deviation for this residual before and after applying the ionospheric correction is 1.108 m and 0.799 m, respectively.
Residuals for PRN03 with & Wo iono correction
-- Residual Wo iono correction

Residual vwth iono correction

500

1000
Epochs in seconds

1500

2000

Figure 4.24 Residual for PRN 03 With and Without the Ionospheric Effect, observed at
Steel

The residuals that remain at this stage of the ionospheric correction analysis are

considered a very good indicator of the observation noise and the pseudorange code
multipath errors. These residuals are analyzed further in Chapter 5 to identify the amount of multipath in each observed satellite at various locations.

81

RYERSOW UNIVERSITY LIBRARY

PROPERTY OF -

MULTIPATH IDENTIFICATION USING WAVELET ANALYSIS

This Chapter provides information on signal processing, and shows how wavelet analysis
can be used to identify the multipath disturbance in each ionospheric-free residual
computed in Chapter 4. Section 5.1 introduces traditional Fourier analysis. Sections 5.2 to

5.5 provide a detailed description of wavelet analysis, continuous and discrete wavelet

transforms, and multi-resolution analysis. Section 5.6 presents the wavelet algorithm used
in this study, and Section 5.7 presents the results of the wavelet analysis.

5.1

Fourier Analysis

Most real world signals, including GPS signals, are non-stationary signals. This means

that the statistical characteristics of the signals change over time. Signals often have
frequencies content which can change over time, or the signals may be intermittent,
transient, or noisy.

Traditional analysis, which decomposes the signal into an infinite sum of periodic
complex exponential functions of different frequencies, is based on Fast Fourier
Transform (FFT). Fourier analysis assumes that the signal is stationary whereas most

signals are non-stationary. FFT is also localized in frequency, but cannot tell us when certain a frequency or event took place in time. To overcome this deficiency, a short-time
Fourier transform (STFT) was introduced to represent the signal in the time-frequency

4omain. STFT is based on windowing the signal at constant length, but accuracy is

limited by the size and the shape of the window: short time windowing gives us good

82

time resolution, but poor frequency resolution, and longer time intervals gives us better
frequency resolution, but sacrifice time resolution.

In recent years, wavelet analysis has been developed as a new alternative technique.

Wavelet analysis is localized in both frequency and time, and can analyze any nonstationary signal with the required resolution. In wavelet analysis, higher frequencies are
better resolved in time, while lower-frequencies are better resolved in frequency.

5.2

What is a Wavelet Transform?

A wavelet transform is a new signal processing tool that can provide time and frequency

information of a signal sequence, simultaneously (Satirapod and Rizos, 2005). The
wavelet transform can cut data, functions, and operators into different frequency

component so that each component can be studied with the resolution that matches the
component's scale (Daubechies, 1992). The wavelet transform's strength lies in its ability to identify and reduce noise while maintaining valuable information in time series data.

The wavelet transform has potential applications in filtering, sub-band coding, data
compression, and multi-resolution signal processing.

A wavelet is a waveform of limited duration that has an average value of zero. While sinusoids theoretically extend from minus to plus infinity, wavelets tend to have a
beginning and an end (Fugal, 2007). This characteristic implies that any event that starts

and stops within a signal can be efficiently described. Wavelets can be stretched and

83

shifted in time to line up with the desired event in the signal, and to indicate the event's
frequency and location in time.

Wavelet analysis is based on decomposition in which the signal is split into two parts

using low-pass and high-pass filters. The low-pass filter produces approximation
coefficients, and the high-pass filter produces details information. The approximation

coefficients denote the low frequency part of the signal, and the details denote the higher frequency part. Wavelets have time-widths adapted to their frequencies. This means that higher frequency wavelets are very narrow, and that low-frequency wavelets are much
broader (Daubechies, 1992). Figure 5.1 shows the productivity of wavelets in describing various frequency bands. In this Figure, wider windows are used to describe the lower

frequency part of the signal, and narrower windows are used to describe the highfrequency information.

"5-

B

--

Time

Time

Wavelet Analysis

Figure 5.1 Wavelet Analysis Scheme (from Misiti et al., 2007)

5.3

Continuous Wavelet Transform

The principle underlying the continuous wavelet transform (CWT) is based on correlating the wavelet at different scales with the desired frequency at the investigated signal. The

84

CWT is defined as the sum over all time of the signal multiplied by scaled and shifted
versions of the basis wavelet function (Misiti et al., 2007). The wavelet transform of a
signal / is described by Daubechies (1992):

(5.1)

where:

|; a,beR,
a

(5.2)

In Equation 5.1, *F(f)is the transforming function, or mother wavelet,

y/ is the complex

conjugate of*F, a is the dilation parameter (or the scale), and b is the translation

parameter that are (a and b) continuous over R (the real number). The --j= is used for

y

the purposes of energy normalization to ensure that the transformed signal has the same
energy at every scale.

Therefore, the wavelet transform of a continuous signal / can be written as:

CWT(a,b)=

Jt-b

\dt

(5.3)

The translation parameter corresponds to the time information in the transform domain. The parameter represents how the window function is shifted through the signal along the

85

x-axis. The scale parameter is defined as the inverse of the frequency. It is represented
along the y-axis.

The definition of CWT tells us that wavelet analysis is a measure of the similarity
between the basis function (wavelets) and the signal itself (Elhabiby, 2007). From

Equation 5.3, we see that the CWT decomposes signals at every possible scale or

resolution, and this results in a large amount of redundant information which burdens the
computation process and might mean that computer implementation is not feasible. As a

result, for most practical applications the discrete wavelet transform is considerably
easier to implement than is the CWT.

5.4

Discrete Wavelet Transform

The discrete wavelet transform (DWT) analyzes the signal at a finite number of points.
This approach improves computational efficiency. The DWT analyzes signals over a

discrete set of scales usually sampled in a dyadic sequence. The DWT's dyadic wavelets
were developed by Daubechies (1992). A family of wavelet functions, known as daughter

wavelets, is generated from a single prototype, also known as the mother wavelet
(Elhabiby, 2007). In DWT analysis, dyadic a and b are usually used, and define^ as:
= 2m and
= n2

where m and neZ, and Z are the set of positive integers.

Hence, the DWT is given as Equation 5.4 (Zhonget al., 2007):
(5.4)

DWTvf(m,n)=

86

where x¥mn(t) = 2 m/2*F(2 mt-n)is the dilated and translated version of the mother
wavelet ¥(0-

The DWT analyzes the signal at different frequency bands with different resolutions by
decomposing the signal into a coarse approximation and details information. The DWT employs two sets of functions: wavelet functions and scaling functions. These functions

are associated with high-pass and low-pass filters, respectively. Equation 5.4 can be
simplified to become (Aram et al., 2007):

(5.5)

where f[k] is the digitized version of the analogue signal with sample index k.

By choosing various values of m, different geometric scalings are obtained:

2 '* * *

As it has, however, been proved practically that the best value of aois 2, the signal is

decomposed into components at different frequency levels that are related by powers of
two (Aram et al., 2007).

5.5

Multi-Resolution Analysis (MRA)

Multi-resolution analysis (MRA) can be used to analyze any given signal at different frequencies with different resolutions. In MRA, the wavelet function can be manipulated
to detect the required information in a particular signal.

87

When a low-frequency signal component is required, the method delivers good frequency

resolution but the time resolution is poor. This is done by stretching the wavelet along the x-axis until it matches the low-frequency component of the signal. On the other hand,
When a high-frequency signal component is required, the method delivers good time resolution, but the frequency resolution is poor. This is done by dilating (compressing) the wavelet along the x-axis until it matches the high-frequency component of the signal.
This is because most of the time, low frequency components of the signal last for longer

time than the higher frequency components. High frequency components are usually of
short duration.

MRA uses various window widths (different scales) to compute the required spectral
component of the signal, and this results in different time and frequency resolutions.

Higher frequencies are better resolved in time (narrow window), and lower frequencies
are better resolved in frequencies (wider window), as shown in Figure 5.2

0) 3

Time

Figure 5.2 Multi-Resolution Analysis (from Elhabiby, 2007)

5.6

Proposed Algorithm: Multi-Resolution Analysis based on the Daubechies
Family

No general criteria are available to guide the selection of the appropriate wavelet for
analyzing a certain type of data. This is because the selection of the wavelet requires

knowledge of the exact behaviour of the signal at hand (frequency-band), and this knowledge is unlikely to be available. The selection of the wavelet that best fits a specific
signal remains a research topic of its own (Satirapod and Rizos, 2005).

In general terms, however, it has been proved that GPS bias terms such as multipath and ionospheric delay behave like low-frequency noise, and GPS measurement noise behaves like high frequency noise (Fu et al., 1997). As these basic principles indicate that

multipath is concentrated in the narrow low-frequency band, a high frequency resolution

89

is needed to be identified. Therefore, MRA based on the Daubechies family (dbN) was

chosen to approximate the multipath values for all the datasets collected during the field
observations of the observed satellites.

dbN is a series of compactly supported orthogonal wavelets. N specifies the order of the mother wavelet and is related to the number of coefficients necessary to represent the associated low-pass and high-pass filters in the dyadic filter tree implementation. The
"db" is the "surname" of the wavelet. The Daubechies basis is the cornerstone of many
wavelet applications today.

In this research, db8 is selected as the mother wavelet, and the decomposition level is considered to be six. The main consideration is being able to filter out as much of the higher frequency observation noise as possible, and being left mainly with the lowfrequency multipath bias. To achieve this, the remaining residuals were fed into the
proposed algorithm (db8-level 6) to approximate the multipath values. The input data (the remaining residuals) were decomposed into low-frequency bias and high-frequency noise for each observed satellite. This decomposition process is accomplished by successive high-pass and low-pass filtering of the residuals (time domain signals). Each jesidual is

first passed through a half band high-pass filter h[n] and a low-pass filter /[»]. This
filtering process was followed by a sub-sampling operation. The signal (residual) was

sub-sampled by two, i.e., half of the samples on the signal were discarded because they
are considered redundant according to Nyquist's rule. This process completed one

decomposition level, and is expressed mathematically in Equations 5.6 and 5.7:

90

(5.6)

(5.7)

where ResMgh[k] and Reslow[k] axe the outputs of the high-pass and low-pass filters
respectively, after sub-sampling by a factor of two.

This decomposition process results in half the time resolution, and twice the frequency resolution. The process was then repeated for further decomposition. At each subsequent level, the filtering and sub-sampling yields half the number of points (and hence half the time resolution) and half the frequency band spanned, doubling the frequency resolution. The process is shown in Figure 5.3.

Pathl

High
Frequency

Term

HPF

LPF

--

HPF Low Frequency Term

Path 2

LPF

HPF I
LPF

Figure 5.3 Multi-Resolution Analysis Scheme (from Satirapod and Rizos, 2005)

91

5.7

Results

This section explains how the adopted approach (db8, level 6) was tested and validated,
and presents the results of applying the approach to the residuals for satellites observed at
each of the four data collection points.

5.7.1

Results for Point PIER

Figure 5.4 shows the wavelet decomposition tree using the db8 wavelet at six decomposition levels. In this Figure, S represents the input signal, al- a6 are the details
from level 1 to 6, and dl- d6 are the respective approximations.

Figure 5.5 shows the wavelet multipath approximation results obtained for PRN01 residuals as a result of passing the residuals into the db8 wavelet using the six
decomposition levels. As it is clear that the successive approximations became less noisy and resulted in higher frequency resolution, level 6 approximation was adopted for
approximating the multipath disturbance in the observations.

92

Figure 5.4 Wavelet Decomposition Tree for db8-Level 6

93

level-1

level-4

0

200

400

600

800 1000

0

200

400

600

800 1000

level-2

level-5

1

g

0

200

400

level-3

600

800 1000

0

200

400

600

800 1000

level-6

0

-2

0

200

400

600

800 1000

0

200

400

600

800 1000

Epochs in seconds

Figure 5.5 Wavelet Approximation Levels for PRN01 Residual

Figure 5.6 shows the approximated multipath for PRN01 using db8 (level 6). The
approximated multipath is represented as a smooth trace superimposed over the input

residual

which

exhibits

more

fluctuations.

This

satellite

was

setting

during

the

observation period (elevation angles between 37° and 0°). The standard deviation of the
approximated multipath is 0.7529 m.

94

Approximated mdtipath for PRN01-PIER214
Residual 1.5 Approximation

0

200

400 600 800 Epochs in seconds

1000

Figure 5.6 Approximated Multipath for PRN01 Residual using Level-6

To validate the reliability of the proposed algorithm, the db8 wavelet was used to decompose the residuals for the LI data obtained from the dual-frequency receiver. The multipath approximated by the wavelet approach was compared with the multipath determined by TEQC software for the same dual-frequency data. The results showed good correlation between the two methods, and verified the productivity and applicability of the proposed wavelet algorithm for identifying multipath effect in satellites signals.

Figure 5.7 compares the multipath determined by the wavelet and with the multipath

determined by TEQC software for the LI dual-frequency data for PRN01. Figure 5.8 shows the cross-correlation function for the multipath derived from the two approaches.

95

PRN01-db8 MP-dual

200

400

600

800

1000

PRNOl-Teqc MP -dual

200

400 600 800 Enochs in seconds

1000

Figure 5.7 Multipath for PRN01 Determined by Wavelet and TEQ for LI DualFrequency Data

Cross-correlation function for PRNOl-dual
0.4
[

0.2

I
-0.2

i /

A

A

n

*

-0.4

/

-0.6 0

200

400 600 800 Time lags in seconds

1000

Figure 5.8 Cross-Correlation Function for PRN01 Multipath as Determined by Wavelet and TEQC for Dual-Frequency LI Data, observed at Point PIER

96

The auto-correlation functions for the residuals before and after removing the multipath effect were computed. Auto-correlation is defined as the cross-correlation of a signal with
a shifted version of itself. It is used to find repeating patterns in a signal, for example, to establish the presence of a periodic signal, such as a low-frequency signal, which has
been buried under the noise.

The first graph in Figure 5.9 clearly shows a high auto-correlatiofi for the signal before the multipath bias has been determined and removed by the wavelet algorithm. This high
correlation can be interpreted to indicate the presence of a low frequency signal. In our
case of course, the high correlation indicates the presence of multipath.

The second graph in Figure 5.9 shows the auto-correlation function for the signal after the multipath bias has been determined and removed by the wavelet algorithm. We can see that the auto-correlation drops dramatically and then oscillates rapidly along the zero line indicating low autocorrelation. This low auto-correlation pattern can be interpreted to indicate that no low frequency signal is present. As we know that the multipath has been
removed, the remaining auto-correlation shown in the graph is attributed to noise. The results shown in this graph also confirm the reliability of the db8 wavelet in identifying
the presence of multipath in satellite signals.

97

-0.S;

200

400

600

800

1000

-0.5

200

400

600

800

1000

Epochs in Seconds

Figure 5.9 Auto-Correlation Functions for PRN01 Residual Before (upper graph) and
After (lower graph) Isolating the Multipath, Point PIER

The above decomposition and de-noising procedure was adopted for all the remaining satellites observed at point PIER.

The final step was to derive a criterion on which to base the rejection of particular satellite. The criterion was based on each signal's standard deviation of the approximated multipath. Signals with the largest multipath standard deviation values were excluded from the final data processing and computation of the coordinates of the observed points. The standard deviation of all residuals before and after applying the multipath corrections were also computed to show the improvement achieved when the multipath identified by

the wavelet algorithm was removed from the signal. Table 5.1 shows the standard

deviations for the residuals, approximated multipath, and elevation angles for each

98

observed satellite . The Table clearly confirms the relationship between satellite elevation
and multipath effect.

Table 5.1 Standard Deviations for Code Residuals Before and After Multipath Correction and the Approximated Multipath using db8-Wavelet-PIER
Residuals before
Residuals after

Improvement

Multipath

PRN

Elevation

MP-correction

MP-Correction

(m)

(m)

(%)

(m)

1

37°- 0°

0.7773 0.899 3.281 0.7281
0.4087 0.581

0.1867 0.2822

75.981

0.7529 0.8421

3
7

14°-66° 23°-1° 21°-61°
84°- 32°

68.610 62.725
78.739

1.223 0.1548
0.0914

2.548
0.707

13
16

77.636
71.670 62.312

0.3983 0.5573 0.4506 0.3159 1.295
1.482

19 20
23 25 27

0°- 45°
32°- 0° 70°- 47° 5°- 53°

0.1646 0.1829
0.1102 0.6134 0.8394

0.4853
0.3381 1.508

67.406
59.324 55.775 69.771

0°-31°
44°- 0°

1.898
0.5187

31

0.1568

0.4946

99

5.7.2

Results for Point Ryerson

Figure 5.10 shows the wavelet multipath approximation results, using different

decompositions levels from 1 to 6, for the residuals obtained for PRN05 as a result of
passing the residuals through the db8 wavelet.

level-1

leveI-4

0

500

1000 1500 2000 2500

0

500

1000 1500 2000 2500

level-2

level-5

·5 -50

500

1000 1500 2000 2500

0

500

1000 1500 2000 2500

levd-3

Ievd-6

-5

0

500 1000 1500 2000 2500

0

500 1000 1500 2000 2500

Epochs in seconds

Figure 5.10 Wavelet Approximation Levels for PRN05 Residual, observed at Point
Ryerson

Figure 5.11 show the multipath approximation using the db8 wavelet (level 6). In this Figure, we can readily see the periodic changes on the signal's large peaks, clearly
indicating multipath. The peak-to-peak difference is more than 6 meters. This high

multipath is expected for two reasons: 1) the satellite elevation angle decreased from 39
to 0 degrees during the observation time span; and 2) the point was observed in a severe
multipath environment.

100

Approximated multipath for PRN05-RYER214

~ Approximation
in seconds

.

1500

2000

2500

Figure 5.11 Approximated Multipath for PRN05 Residual, observed at Point Ryerson

The db8 wavelet was also applied to the LI data collected by the dual-frequency receiver.
Figure 5.12 compares the multipath determined by the wavelet with the multipath determined by TEQC software for the LI dual-frequency data for PRN05. Figure 5.13

shows the cross-correlation function for the multipath derived from the two approaches.
The cross- correlation indicates good correlation between the two methods.

101

PRN05-db8 MP-dual

=

o

500

1000

1500

2000

2500

PRN05-Teqc MP-dual

0

500

1000

1500

2000

2500

lOpochs in seconds

Figure 5.12 Multipath for PRN05 determined by Wavelet and TEQC, observed at Point
Ryerson

Cross-correlation function forr PRN05-dual

0

500

1000

1500

2000

2500

Time lags in seconds

Figure 5.13 Cross-Correlation Function for PRN05 Multipath as Determined by Wavelet
and TEQC for Dual-Frequency LI Data, observed at Point Ryerson

102

Table 5.2 summarizes the final results (standard deviations) for the approximated
multipath values for point Ryerson.

Table 5.2 Standard Deviations for Code Residuals Before and After Multipath Correction and the Approximated Multipath using db8-Wavelet-Ryerson

PRN

Elevation

Before Correction (m)

After Correction (m)

Improvement

Multipath (m)

(%)

1

54°-79°
39°-0°
0°-22°

0.6182 1.238

0.1544

75.024
69.822

0.5966
1.155

5 6
7

0.3736 1.088
1.372

7.811
17.13 5.721

86.071 91.991

7.49
16.39

0°-25°
27°-0°
71 °-24° 0°-54°

12 14 16 20 22

0.8929
0.2187

84.393
65.264 75.275

5.413
0.5867
3.404

0.6296
3.782 5.47
12.54

0.9351
1.949

5°-43°
44°-0°

64.369 82.791
72.452

4.181
11.38
1.514

2.158 0.4416 0.1418

30 31

46°-11°
52°-80°

1.603 0.4456

68.178

0.422

5.7.3 Figure

Results for Point Steel 5.14 shows the wavelet multipath approximation results, using different

decompositions levels from 1 to 6, for the residuals obtained for PRN06 as a result of

103

passing the residuals through the db8 wavelet using six different decomposition levels. Figure 5.14 is for data from point Steel.

level-1

level-4

500

1000

1500

2000

500

1000

1500

2000

level-2

level-5

500

1000

1500

2000

500

1000

1500

2000

level-3

level-6

0

500

1000

1500

2000

0

500

1000

1500

2000

Epochs in seconds
Figure 5.14 Wavelet Approximation Levels for PRN06 Residual, observed at Point Steel

104

Figures 5.15 and 5.16 show the approximated multipath using db8 (level 6) for PRN06
and PRN13 respectively.

Approximated multipath for PRN06-STEEL

Residual

Approximation
0

500

1000 1500 Epochs in seconds

2000

Figure 5.15 Approximated Multipath for PRN06 Residual observed at Point Steel

Approximated multipath for PRN13-STTEEL
1 [ :

1 if W
=

-1

-2

Residual

Approximation

0

500

1000

1500

2000

2500

3000

Epochs in seconds

Figure 5.16 Approximated Multipath for PRN13 Residual, observed at Point Steel

105

Table 5.3 summarizes the final results (standard deviations) for the approximated
multipath values for point Steel.

Table 5.3 Standard Deviations for Code Residuals Before and After Multipath
Correction and the Approximated Multipath using db8-Wavelet-Steel

PRN

Elevation

Before Correction (m)

After

Correction (m)

Improvement

Multipath (m)

(%)

1

79°-25°

0.4559
0.7997

0.1216 0.3439 0.2275 0.3128 0.2775
0.1034

73.327

0.4396 0.7184 1.509 0.9222 0.6867

3 6
13 14 16

0°-25°
22°-11°

56.996 85.111
67.971
62.817

1.528 0.9766 0.7463 0.3878 0.6663
0.7844

0°-33° 42°-0°
31°-84° 43°-22°
7°-61°

73.337 70.314 66.012 65.654

0.3738
0.6369

20 23 25 30
31

0.1978
0.2666 0.4441 0.3384

0.7295
1.217

0°-14°

1.293 1.015 0.3446

28°-0°
80°-34°

66.660
64.277

0.9689 0.3218

0.1231

5.7.4

Results for Point Milton

Figure

5.17

shows

the

wavelet

multipath

approximation

results,

using

different

decompositions levels from 1 to 6, for the residuals obtained for PRN12 as a result of

106

passing the residuals through the db8 wavelet using six different decomposition levels.
Figure 5.17 is for data from point Milton.

level-1

level-4

300

600

900

300

600

900

Ievel-2
3
1.5 0 -1.5

leveI-5

0

300

600

900

-3 0

300

600

900

level-3

level-6

300

600

900

Epochs in seconds

300

600

900

Figure 5.17 Wavelet Approximation Levels for PRN 12 Residual, observed at Point
Milton

Figure 5.18 shows the final approximation (level 6) and the original signal for PRN12.

Figure 5.19 shows the final approximation (level 6) and the original signal for PRN22.

107

Approximated railti path for PRN12-MILT213
2.5
1 --|

R esidual

A pproximation

.5

0.5

A
\
150
ft ml " ~
------.

/

1

°
-0.5 -1

-1.5

0

300

f

450 600 750 Epochs in seconds

900

1050

Figure 5.18 Approximated Multipath for PRN12 Residual, observed at Point Milton

Approximated mdtipath for PRN22-MILT213

1 :
I 1

k

.9
·a

o
-l
i

Vi*  i / I

[I

-2

--

Residual Approximation

v
i

-3. 0

500

1000 1500 Epochs in seconds

2000

Figure 5.19 Approximated Multipath for PRN22 Residual, observed at Point Milton

108

Table 5.4 summarizes the final results (standard deviations) for the approximated multipath values for point Milton. Table 5.4 Standard Deviations for Code Residuals Before and After Multipath
Correction and the Approximated Multipath using db8-Wavelet-Milton

Before
PRN Elevation

After

Correction (m)

Correction (m)

Improvement

(%)
88.427 61.242

Multipath (m)

1

79°-52°

0.4044

0.0468 0.1610
0.1297
0.1574

0.4016

5

31°-0°
1 °-22° 1 °-26°

0.4154

0.3815
0.3167

6
7

0.3428
0.3409

62.165 53.828
78.88

0.2931
0.7381 0.4347 0.6491

12 14

17°-0° 61°-13° 7°-69°
17°-43° 28°-0° 0°-36° 43°-0°

0.7448 0.4456 0.6673
0.4113 0.7039 0.6736 0.4848

0.1573 0.0975
0.1524 0.1033 0.1446
0.2782

78.119
77.162

16
20 22

74.885
79.457

0.398
0.6873
0.5884 0.4704

23 30

58.7

0.1165

75.969

5.7.5

Comparison of the Four Data Collection Points

Figure 5.20 shows the standard deviation values for the approximated multipath using the proposed wavelet algorithm. It is clear that point Ryerson has the most multipath

109

disturbance. This is result is to be expected as point Ryerson is located in the heart of
downtown Toronto. The second highest multipath effect is found at point PIER. Point
PIER is located almost under a belt of dense trees. These trees are cause of the multipath error. The other two points (Milton and Steel) has relatively smaller multipath effects
than those of Ryerson and Pier.
PIER214

MILT0N213

0.

*

1

5

6

7

12 14 16 20 22 23 30
RYER9ON214

[ Illl-H .11.
1 3 7 13 16 19 20 23 25 27 31
STEEL212 1.5

20

14
S 10

I

as

1

5

6

7

12 14

16 20 22 30 31

mill
3 6 13

14 16 20 23 25 30 31

PRNNumber

PRN Number

ill.

Figure 5.20 Standard Deviation Values for the Approximated Multipath

110

6

RESULTS AND DISCUSSION

In this Chapter, the productivity of the multipath identification technique developed in this research is verified using the final coordinates computed from the single-frequency
receiver's LI measurements. The longitude, latitude, and ellipsoidal height coordinates are computed using all satellites for all four data collection points using three different processing software packages: Trimble Total Control (TTC), Bernese Scientific software, and NRCan online Precise Point Positioning (PPP). Multipath contaminated satellites are then isolated, and the longitude, latitude, and ellipsoidal height coordinates for all data collection points are computed and compared against the first set of coordinates to demonstrate the improvement achieved. Finally, the kinematic results for the trajectory
observed using the LI single-frequency receiver are presented and analyzed.

Trimble Total Control Trimble Total Control (TTC) is a powerful data processing software package for GPS and total station data. The software can process GPS and Global Navigation Satellite System (GLONASS) data. It is very easy to use, and can process data collected in static,

rapid static, and kinematic modes. TTC has the capability to implement precise
ephemeris and global ionospheric maps (IONEX) by automatically downloading these files from the Internet. TTC also supports various raw GPS data formats collected by

different GPS receivers, and RINEX format. In addition, the software provides information about the quality of collected data in graphical and tabular formats. Further details can be found in Trimble (2007a).

111

Bernese Scientific Software

Bernese is an advanced scientific processing tool for GPS and Global Navigation Satellite
System (GNSS) receivers. The tool was developed by the Astronomical Institute of the University of Bern, Switzerland, and has been implemented in various applications that

demand the highest possible accuracy. These applications include precise geodetic
applications and structure deformation monitoring. Bernese is very widely used by educational and research institutions, and by organizations running permanent GPS
networks.

The software's robustness results from the accuracy of its rigorous algorithms. Code pseudorange and carrier phase measurements collected by single- or dual-frequency receivers can be efficiently processed using the software. Bernese includes the following
features:

·

When

processing

dual-frequency

data,

the

software

forms

various

linear

combination observables, such as the ionosphere free-linear combination (L3), the wide-lane linear combination (L5), and the so-called Melbourne-Wiibbena linear combination (L6). These linear combination observables help to remove biases
including ionospheric path delay, detect and repair of cycle slips, and enhance
ambiguity resolution procedure.

·

Global ionospheric maps (IONEX files) can be implemented to account for
ionospheric effect in single-frequency observations.

·

Precise ephemeris and precise clock data are used to account for satellite-related
errors.

112

·

Earth rotation parameters, tropospheric effects, and other biases are accurately
modeled.

·

Differential code biases (DCB) are used to account for instrumental biases related
to satellites.

·

Various algorithms are used to handle the ambiguities whether dual-or singlefrequency data are processed.

·

Baselines up to 2,000 km can be efficiently determined (Dach et al., 2007).

·

Bad observations of particular satellites may be excluded by adding a "bad data"
entry in the satellite problem file (SAT.CRX).

The steps adapted by Bernese to process static data collected from single- frequency receivers are outlined below:

1.

A separate campaign was defined for each day when the relevant directories were

created. In each directory, the necessary input files were created. These files include the

raw data in RINEX format, the station a priori coordinates, precise orbits, and global
ionospheric maps (IONEX).

2. RINEX files were transformed to Bernese format using the RNXGRA program. As a

result, Bernese-formatted code and carrier zero difference observation files were created
for each station.

3.

The code single point positioning was computed using the CODSPP program.

CODSPP is used to compute the receiver clock corrections, and to estimate improved a priori geocentric coordinates for the new stations.

113

4. The SNGDIF program was run to form the baseline between the observed stations,

and single-difference files were created. At this stage the satellite clock bias was
cancelled by forming between-receiver single-difference.

5.

The single difference observation files were screened for cycle slips using the

MAUPRP program and LI carrier phase measurements. At this stage, the double
difference observables were formed, and the satellite and receivers clock errors were

eliminated. Double differences are the basic observables in Bernese software. Triple
difference observables were constructed by differencing double differences observations over two consecutive epochs, and carrier phase ambiguities are eliminated if no cycle slip was encountered. Tropospheric refraction error is considerably reduced due to the fact
that it doesn't change rapidly with time.

6.

The final program used was GPSEST. This program was used to resolve the

ambiguities using the SIGMA algorithm and compute the final baseline components. The
station coordinates were then determined.

Dach et al. (2007) provide further details about the steps followed by Bernese Scientific
Software.

NRCan Online Precise Point Positioning Software

The online Precise Point Positioning (PPP) service was developed by NRCan to meet

various users' application requirements. The PPP service can be used to process data collected by any single- or dual-frequency receiver, and the data may be observed in

114

static or kinematic modes. PPP is accessible via the Internet by logging into the NRCan
website (http://www.geod.nrcan.gc.ca/online_data_e.php).

As PPP implements precise GPS orbit and clock products of the IGS, the service can be used with any GPS data observed at any location on the surface of the earth. Furthermore, PPP internally implements an ionospheric delay grid for correcting the ionospheric error
for single-frequency data. The source of ionospheric corrections selected for the LI processing by the on-line application is the combined global ionospheric maps produced at 2-hour intervals in IONEX format by IGS. Tropospheric delay is modeled by the default meteorological data stored in an internal file, and takes into account the a priori
station ellipsoidal height. LI processing uses a tropospheric model along with default

surface meteorological data and an elevation mapping function to correct the along path tropospheric delay (NRCan, 2007). NRCan online PPP uses only pseudorange

measurements (C/A code data) to estimate the position components (latitude, longitude, ellipsoidal height) for data collected by single-frequency receivers.

To derive a reliable and accurate coordinates, various thresholds and rejection criteria parameters are implemented internally in the server. The thresholds apply to cycle slip detection, multipath, and the computed residuals for each observable (code or carrier). The coordinates derived can be referenced to NAD83 (CSRS), the standard Canadian national reference frame, or the global International Terrestrial Reference Frame (ITRF),
depending on the user's selection.

115

6.1

Results for Static Baselines

All of this study's GPS observations were processed using TTC and Bernese software.

The elevation cut-off angle was set to 15°. Global ionospheric maps produced by IGS
(IONEX) were used to correct for the ionospheric effects in single-frequency

measurements, and the linear combination using LI and L2 measurements was used to compute the reference coordinates collected by the dual-frequency receiver. For tropospheric delay bias, the Saastamoinen model was applied. The final precise ephemeris was downloaded from the IGS website and used to correct for orbital errors.
All observation files were processed using two different reference stations for the purpose of examining the effect of various baseline lengths. One of the reference stations was

selected from the Canadian Active Control System (CACS) network operated by NRCan,
and the observation was downloaded from the Internet.

6.1.1

Reference Receiver Coordinates (Truth-Data)

The first step was to compute the coordinates for the data collected by the dual-frequency

receiver for all the observations to be used as truth data. The dual-frequency receiver was simultaneously logging data via an antenna splitter during all field data collection. The reference coordinates were computed using both TTC and Bernese software. As the results derived from the Bernese scientific software are more accurate, these results are
used in this research. They are referred to as the "known coordinates".

The Coordinates derived for point PIER by both the TTC and Bernese software

were

checked against the published coordinates. Millimetre accuracy was achieved for both the

116

horizontal and the vertical coordinates. Figure 6.1 shows the difference between the
published coordinates for point PIER and the coordinates derived from the dualfrequency receiver using the TTC and Bernese software.

2.5 LatDiff
2.043 cm

Loii&Diff

"s
TTC Bernese Processing Software

Figure 6.1 Difference between Published PIER Coordinates and Coordinates Derived by
Dual-Frequency Receiver and computed by TTC and Bernese Software

Table 6.1 shows the geographic coordinates for all four locations (Steel, Milton, Ryerson, and PIER) as derived by the dual-frequency receiver and processed using Bernese
software.

117

Table 6.1 Coordinates for the Reference Receiver using Bernese Software (Known
Coordinates) Ellipsoidal Point Steel Milton
Ryerson

Latitude

Longitude

height
118.2495m
158.4227m

N43°48' 15.615986"

W 79° 23' 37.994765"
W 79° 50'37.124103" W 79° 22'36.696172"

N 43° 33' 54.945925"
N 43° 39'36.557617"
N 43° 43'31.600874"

57.2050m
136.7749m

PIER

W79°29' 10.612134"

6.1.2

Short Baseline Test Results

The Toronto base station (located in Etobicoke) was used for the short baseline testing.

The data were processed using TTC and Bernese software in two stages. Firstly, all the
measurements were processed without isolating any of the satellites. The measurements

were then processed using the results obtained from the wavelet algorithm discussed in Chapter 5. The processing involved disabling the satellites with the maximum multipath
disturbance, as assessed by standard deviation values computed in Chapter 5.

(a)

Ryerson. Figure 6.2 shows the results derived by the AC 12 single-frequency

receiver for point Ryerson before isolating multipath contaminated satellites. Figure 6.3 shows the results after isolating multipath contaminated satellites. The baseline length for point Ryerson is 20 km (Figure 4.6). The scale for Figure 6.2 is in metres whereas the
scale for Figure 6.3 is in centimetres.

Point Ryerson was observed under severe multipath conditions. In addition, more than 50% of the observed satellites were either at very low elevations or setting during the

observation period (as shown in Table 5.2). Figure 6.2 clearly shows the severe effect of
118

multipath at point Ryerson, and the resulting deterioration in the positioning accuracy

obtained from the GPS technology. The Figure shows the effects of multipath on all three
positioning components: latitude, longitude, and ellipsoidal height. The deterioration in positioning caused by multipath is very clear, especially for the height component which
reached 9.29 m (Bernese software). This demonstrated that multipath plays a significant rule in deteriorating the ambiguity resolution, even for short baselines. It has a crucial effect on contaminating both the station coordinates and the ambiguities. ( HofmannWellenhof et al., 2008).

10

|Lat.Diff

lLong.Diff

IffightDiff

S

6

I 4

0.285 m

0

TTC
Processing Software

Bernese

Figure 6.2 Point Ryerson Coordinates Differences (from known coordinates) Before Isolating Multipath Contaminated Satellites

Figure 6.3 shows the very substantial improvements in accuracy achieved for all three
positioning components when the severely multipath contaminated satellites were

removed from the final data processing. The differences dropped from metres to a few

119

centimetres. All the differences were less than 5 cm except for the longitudinal
component determined by TTC which was 16.95 cm. This result may be attributed to a

deficiency in the TTC software regarding the correction of some cycle slips in the data.

lLat.Diff

lLong.Diff

|Hight.Diff

4.24 cm

4.32 cm

TTC
Processing Software

Bernese

Figure 6.3 Point Ryerson Coordinates Differences (from known coordinates) After
Isolating Multipath Contaminated Satellites

Tables 6.2 and 6.3 respectively show the coordinates for point Ryerson derived by TTC software before and after isolating severely multipath contaminated satellites. The Tables
show the computed coordinates and the differences from the known coordinates in
seconds and metres or centimetres.

120

Table 6.2 Ryerson Coordinates and Difference from Known Coordinates Before
Isolating Severely Multipath Contaminated Satellites derived by TTC Software
Ryerson Latitude Longitude

AC12 Single
N43°39' 36.57032"

Diff(sec)
0.0127 0.16636

Diff(m)
0.28518
3.73482 8.86

W 79° 22'36.52981"
66.073

Ellipsoidal
height

Table 6.3 Ryerson Coordinates and Difference from Known Coordinates after Isolating
Severely Multipath Contaminated Satellites derived by TTC Software
Ryerson Latitude Longitude Ellipsoidal
height 57.2395m 3.45

AC12 Single
N 43° 39'36.55783"
W 79° 22' 36.70372"

Diff(sec)
0.00021

Diff(cm) 0.478185 16.94526

0.007548

Tables 6.4 and 6.5 respectively show the coordinates for point Ryerson derived by Bernese software before and after isolating severely multipath contaminated satellites.
The Tables show the computed coordinates and the differences from the known
coordinates in seconds and metres or centimetres.

Table 6.4 Ryerson Coordinates and Difference from Known Coordinates Before Isolating Severely Multipath Contaminated Satellites derived by Bernese Software
Ryerson

AC12 Single
N 43° 39' 36.526437"

Diff(sec)
0.03118 0.20393

Diff(m) 0.69999
4.5782

Latitude Longitude Ellipsoidal
height

W 79° 22' 36.492240" 66.4972m

9.29

121

Table 6.5 Ryerson Coordinates and Difference from Known Coordinates After Isolating
Severely Multipath Contaminated Satellites derived by Bernese Software
Ryerson

AC12 Single N 43° 39' 36.556976"
W 79° 22' 36.694283"
57.2482m

Diff (sec)
0.000641 0.001889

Diff (cm)
1.439045

Latitude
Longitude

4.240805 4.32

Ellipsoidal
height

Table 6.6 shows the improvement in all positions after removing the satellites that were

severely contaminated with multipath. Both the TTC and the Bernese software brought
about improvements of more than 95 %. Most improvements were around 98 or 99 %. These improvements demonstrate the significance of the proposed wavelet analysis in
identifying the multipath effect in GPS data.

Table 6.6 Improvement Achieved for Ryerson Coordinates After Isolating Severely
Multipath Contaminated Satellites Derived by TTC and Bernese Software
s/w

TTC
98.32%

Bernese

Latitude
Longitude

97.94%
99.07%

95.46% 99.61%

Ellipsoidal
height

99.53%

(b)

PIER. Figure 6.4 shows the results derived by the AC 12 single-frequency

receiver for point PIER before isolating severely multipath contaminated satellites.

Figure 6.5 shows the results after isolating multipath contaminated satellites. The
baseline length for point PIER is 10 km (Figure 4.6). The scale for Figure 6.4 is in metres
whereas the scale for Figure 6.5 is in centimetres.

122

Although the baseline is only 10 km, multipath dramatically deteriorated the accuracy of
all positioning components. The deterioration is especially clear for the corrupted data

handled by Bernese software where the error in the longitudinal component reached
15.74 m. This result reflects the weakness of Bernese software in handling corrupted data collected by single-frequency receivers. Bernese software was initially designed for

processing high quality GPS measurements, mainly collected by dual-frequency receivers
for scientific applications.

18
16 14

 LatDiff

1

 Long.Diff

15j74m

 ffight.Diff

12 10
o

u

8
6

I

4

2.99 m

2

0

0.210 ,, 1 ^^^h 

UO m

1 «££»  ^HH

1 ^m 
Bernese

1.22 m

TTC Processing Software

Figure 6.4 PIER Coordinates Differences (from known coordinates) Before Isolating
Multipath Contaminated Satellites

Figure 6.5 again shows the efficiency of the db8 wavelet proposed in Chapter 5 for

multipath identification: both the TTC and Bernese software demonstrate very substantial improvements in the accuracy achieved for all three positioning components when the

severely multipath contaminated satellites were removed from the final data processing.

123

The results obtained using Bernese software show a dramatic improvement in all three

components. The largest error using Bernese software is 5.16 cm for the height component. The largest error using TTC software is 62 cm for the longitudinal component. This result might be attributed to the inability of TTC software to properly
detect and correct for cycle slips in this particular situation.

Lat.Diff
Long.Diff Hight.Diff

TTC Processing Software

Bernese

Figure 6.5 PIER Coordinates Differences (from known coordinates) After Isolating
Multipath Contaminated Satellites

Tables 6.7 through 6.10 show the difference in the coordinates derived by TTC and
Bernese software for point PIER before and after isolating satellites with severe multipath. The Tables show the computed coordinates and the differences from the
known coordinates in seconds and metres or centimetres.

124

Table 6.7 PIER Coordinates and Difference from Known Coordinates Before Isolating
Severely Multipath Contaminated Satellites derived by TTC Software
PIER

AC12 Single
N43°43' 31.59153"
W 79° 29' 10.55424" 137.382m

Diff (sec)
0.009344 0.057894

Diff(m)
0.2097
1.2997

Latitude Longitude Ellipsoidal
height

0.6071

Table 6.8 PIER Coordinates and Difference from Known Coordinates After Isolating Severely Multipath Contaminated Satellites derived by TTC Software
PIER Latitude

AC12 Single
N 43° 43'31.59903"
W79°29' 10.58441" 136.8280m

Diff (sec)
0.001844 0.027724

Diff (cm) 4.13978 62.24038
5.31

Longitude
Ellipsoidal height

Table 6.9 PIER Coordinates and Difference from Known Coordinates Before Isolating Severely Multipath Contaminated Satellites derived by Bernese Software
PIER

AC12 Single
N43°43' 31.732796" W79°29' 11.313057"
137.9937m

Diff (sec)
0.133418

Diff(m)
2.99523 15.7357 1.218

Latitude

Longitude Ellipsoidal
height

0.700923

Table 6.10 PIER Coordinates and Difference from Known Coordinates After Isolating
Severely Multipath Contaminated Satellites derived by Bernese Software
PIER Latitude Longitude Ellipsoidal height

AC12 Single
N 43° 43'31.600804"

Diff (sec)
0.00007 0.001214

Diff (cm)
0.15715 2.72543

W79°29' 10.610920" 136.7233m

5.16

125

Table 6.11 shows the improvement in all positions after removing the satellites that were severely contaminated with multipath. The TTC's improvements ranged from 52 % to 91 %. The Bernese software's improvements exceeded 95 % and reached almost 100 %.
Table 6.11 Improvement Achieved for PIER Coordinates After Isolating Severely Multipath Contaminated Satellites derived by TTC and Bernese Software
s/w

TTC
80.26% 52.11% 91.25%

Bernese 99.95%
99.83% 95.76%

Latitude
Longitude

Ellipsoidal
height

(c)

Steel. Figure 6.6 shows the results derived by the AC 12 single-frequency receiver

for point Steel before isolating severely multipath contaminated satellites. Figure 6.7
shows the results after isolating multipath contaminated satellites. The baseline length for

point Steel is 20 km (Figure 4.6). The scale for both Figure 6.6 and Figure 6.7 is in
centimetres.

As the data collected for point Steel were obtained under a moderate multipath
environment, the results obtained even before isolating any satellites are more accurate

when compared to the results obtained for points Ryerson and PIER. The results obtained

by the TTC software were worse than the results derived by the Bernese software,
especially for height component (27.25 cm with the TTC software).

126

30
27.25 cm

T~
1 1

25
U

LatDiff HLong.Diff  Hight.Diff

S20

Is .£ 15

I 10

[-

M ^1

11.66 cm ^^H
4

ll

4.66 cm ^|

3.06 cm

H ^^^H

0.222 cm 0.17 5 cm
Bernese

^^^^^|

TTC

Processing Software

Figure 6.6 Steel Coordinates Differences (from Known Coordinates) Before Isolating
Multipath Contaminated Satellites

Figure 6.7 clearly shows an improvement in all three components (latitude, longitude,
ellipsoidal height) after the multipath disturbance in each GPS signal was successfully

identified by the proposed wavelet algorithm and multipath contaminated satellites were isolated from the final processing. The largest error was less than 4 cm (see height
component derived by the TTC software). The accuracy of all the latitude and longitude

results derived by both the TTC and Bernese software is less than half a centimetre.

The results shown in Figure 6.7 indicate that both software packages can be used to
process data collected by a single-frequency receiver under a moderate multipath

environment, providing that multipath contaminated satellites are identified and removed
from the final processing.

127

4

3j7«cm

 Lat.Diff

3.5

 Long.Diff  HightDiff

3

jj 2.5
S 2
1.5
1 0.5
0.43

I

1.26 cm

8 cm 1

H 1

0

0.036 cm 1
TTC

0.139 cm

1

0.312 cm 1

Bernese Processing Software

Figure 6.7 Steel Coordinates Differences (from Known Coordinates) After Isolating Multipath Contaminated Satellites

Tables 6.12 through 6.15 show the difference between the coordinates derived by TTC and Bernese software for point Steel before and after isolating satellites with severe multipath. The Tables show the computed coordinates and the differences from the known coordinates in seconds and centimetres. Table 6.12 Steel Coordinates and Difference from Known Coordinates Before Isolating Severely Multipath Contaminated Satellites derived by TTC Software Steel Latitude

AC12 Single
N43°48' 15.61391" W 79° 23' 37.98957"
118.522m

Diff (sec) 0.002076
0.005195

Diff (cm) 4.6606 11.66277 27.25

Longitude
Ellipsoidal

height

128

Table 6.13 Steel Coordinates and Difference from Known Coordinates After Isolating
Severely Multipath Contaminated Satellites derived by TTC Software
Steel

AC12 Single N43°48' 15.61597"
W 79° 23' 37.99457"
118.2119m

Diff (sec) 0.000016 0.000195

Diff (cm)
0.03592

Latitude Longitude Ellipsoidal
height

0.437775
3.76

Table 6.14 Steel Coordinates and Difference from Known Coordinates Before Isolating
Severely Multipath Contaminated Satellites derived by Bernese Software
Steel Latitude

AC12 Single
N43°48' 15.616085"

Diff (sec) 0.000099
0.000078

Diff (cm)
0.2222 0.17511 3.06

Longitude Ellipsoidal
height

W 79° 23' 37.994687"
118.2801m

Table 6.15 Steel Coordinates and Difference from Known Coordinates After Isolating
Severely Multipath Contaminated Satellites derived by Bernese Software
Steel Latitude

AC12 Single N43°48' 15.616048" W 79° 23' 37.994626"
118.2369m

Diff (sec)
0.000062

Diff (cm) 0.13919 0.312055
1.26

Longitude
Ellipsoidal height

0.000139

129

Table 6.16 shows the improvement in all positions after removing the satellites that were severely contaminated with multipath. The Bernese software's improvements ranged
from 37 % to 59 %. The only exception is in the longitudinal component which was

degraded by 0.14 cm. The TTC software's improvements exceeded 86 % and reached
almost 99 %.

Table 6.16 Improvement Achieved for Steel Coordinates After Isolating Severely Multipath Contaminated Satellites derived by TTC and Bernese Software
s/w
Latitude

TTC
99.23%

Bernese 37.36%

Longitude Ellipsoidal height

96.25%
86.20% 58.82%

(d)

Milton. Figure 6.8 shows the results derived by the AC 12 single-frequency

receiver for point Milton. The baseline length for point Milton is 26 km (Figure 4.6). The
scale for Figure 6.8 is in centimetres. Point Milton was located in a relatively open area,

and the multipath was introduced by a parked vehicle. As the multipath effect was very

minimal, no satellite was removed from the data processing, to preserve the geometry of
the satellites.

The TTC and Bernese software gave good results. The largest error is the height

component derived by TTC (5.26 cm). The accuracy of all the latitude and longitude
results derived by both the TTC and Bernese software is less than 2 cm. These results
support the applicability of the single-frequency sensor for precise applications.

130

LatDiff

Long.Diff
HightDiff
4)

'8
c

I

TTC

Processing Software

Bernese

Figure 6.8 Milton Coordinates Differences (from known coordinates)

Tables 6.17 and 6.18 show the coordinate differences derived for point MILTON using
TTC and Bernese software. The Tables show the computed coordinates and the differences from the known coordinates in seconds and centimetres.
Table 6.17 Milton Coordinates as derived by TTC Software
Milton Latitude Longitude

AC12 Single N 43° 33'54.94634" W 79° 50' 37.12427"
158.3701

Diff(sec)
0.000415

Diff(cm)
0.931675 0.374915
5.26

0.000167

Ellipsoidal
height

Table 6.18 MILTON Coordinates as derived by Bernese Software
Milton

AC12 Single N 43° 33'54.946566"

Diff(sec)
0.000641 0.000198

Diff(cm)
1.439045

Latitude
Longitude

W 79° 50'37.123905"
158.4006

0.44451
2.21

Ellipsoidal
height

131

6.1.3

Long Baseline Test Results

This section compares the solution derived for each data collection point from the two
different reference stations used in this research. The two reference stations (which are described in Section 4.3.1) were Toronto (located in Etobicoke), and PWEL (located

across Lake Ontario in Port Weller). As the purpose of the comparison is to examine the
effect of baseline distance, the analysis was restricted to the satellites with the least

multipath effect, and only Bernese software was used. Bernese software was preferred to
TTC software due to its robustness in deriving more reliable coordinates for most of the

positions at the data collection points (especially at points Ryerson and PIER), as discussed in Section 6.2.1. The PWEL reference station is part of the Canadian Active
Control (CAC) network, so the data were downloaded in RINEX format from the NRCan
website.

(a)

Steel. Figure 6.9 compares the results obtained for point Steel using baselines of

20 km and 65 km, respectively. The coordinates difference obtained for all three positioning components (latitude, longitude, and ellipsoidal height) are less than 1.6 cm. This result shows that the data collected with the single-frequency receiver at this point for two different baseline lengths were reliable. The largest error is found in the latitudinal component (1.59 cm) for the PWEL reference station (baseline of 65 km).

132

ILatDiff
1.6

lLong.Diff JHight.Diff

TORONTO (20 KM)

Reference Station

PWEL (65 KM)

Figure 6.9 Steel Coordinates Differences at Two Reference Stations using Bernese
Software

(b)

Milton. Figure 6.10 compares the results obtained for point Milton. The baselines

are 26 km and 63 km, respectively. The results shown in Figure 6.10 also demonstrate the reliability of the single-frequency sensor in delivering high accuracies for short and long

baselines. The accuracy for all three positioning components is within 2.5 cm. When the baseline is increased from 26 km to 63 km, the loss of accuracy is minimal for the latitudinal and longitudinal components, but the results for the height component show an improvement. This result for the height component might be due to different
environments at the two reference stations or to the accuracy of reference station
coordinates. This issue should be further investigated in future research.

133

LatDiff Long.Diff Hight.Diff

TORONTO (26 KM)
Reference Station

PWEL (63 KM)

Figure 6.10 Milton Coordinates Differences using Bernese Software

(c)

Ryerson. Figure 6.11 compares the baseline results obtained for point Ryerson in

downtown Toronto. The baselines are 21 km and 49 km, respectively.

Figure 6.11 shows that the accuracy derived for the long baseline was less than the
accuracy for the short baseline, especially for the latitudinal and height components, i.e.,

isolating the severely contaminated satellites was more effective in improving the results for the short baseline than for the long baseline. Bernese software employs the SIGMA technique to resolve ambiguity for single-frequency observations, but two conditions must be observed and met precisely in order to implement the SIGMA algorithm (Dach et
al., 2007):

1.
*

The single frequency data should be collected with long sessions (time), and short
baselines (less than 20 km).

134

2.

High quality code measurements with long sessions are required if long baselines
are observed.

The second condition was clearly not met in the case of the Ryerson long baseline data.
The multipath corrupted the code measurements and distorted the ambiguity. An accurate

fixed solution requires high-quality measurements over a long period of time, good DOP,
and multipath-free observations. The accuracy at point Ryerson may also have been
degraded by atmospheric conditions and orbital biases at both ends of the baseline (base

and rover).

Despite these problems, the coordinates differences for the latitudinal and longitudinal
components are less than 9 cm for both the short and the long baselines. This is a good

result for a 49 km baseline using single-frequency receiver in a severe multipath
environment. The largest error is 33 cm in the height component.

35
30

I LatDiff

33.0 cm

I Long.Diff I Hight.Diff

I 25
.5
u

20

s

TORONTO (21 KM) PWEL (49 KM) Reference Station

Figure 6.11 Ryerson Coordinates Differences using Bernese Software

135

(d)

PIER. Figure 6.12 compares the coordinate differences for point PIER for the 10 km and 59 km, respectively. The

short and long baselines. The baselines are

differences for the short baseline and for the latitudinal component of the long baseline
are small (up to 5.16 cm), but the differences for longitudinal and height components of the long baseline are very much larger (around 20 cm). The largest error is the long baseline's longitudinal component (22.8 cm). This result could again be due to the effect of the remaining multipath on the process of ambiguity resolution for the long baseline.

25

lLat.Diff

22.85

lLong.Diff
20

Might. DifT

u

4>

O 4>

10

5.16 cm

0

TORONTO (10 KM)

PWEL (59 KM)

Reference Station

Figure 6.12 PIER Coordinates Differences using Bernese Software

(e)

Summary of Long Baseline Test Results. Table 6.19 summarizes the

coordinates derived by Bernese software for the long baselines investigated using the PWEL reference station. The Table shows the computed coordinates and the differences

from the known coordinates in seconds and metres.

136

The differences at points Steel and Milton are small and mostly about 1 cm. The
differences at points Ryerson and PIER are very much larger: at PIER, the height
component reached an error of 18.16 cm, and 22.85 cm in the longitudinal component;

while the largest error at Ryerson was for the height component (33 cm).
Table 6.19 Coordinates derived by Bernese Software using the
PWEL Reference Station

Steel
Latitude Longitude

AC12 Single N 43° 48' 15.616694" W 79° 23' 37.994816"
118.2372m

Diff (sec)
0.000708 0.000051

Diff (cm) 1.58946 0.114495

Ellipsoidal height 1.23

Milton
Latitude Longitude Ellipsoidal height

AC12 Single N 43° 33' 54.946568" W 79° 50' 37.124494"
158.4286

Diff (sec) 0.000643 0.000391

Diff (cm)

1.443535
0.877795 0.59

Ryerson

AC12 Single N 43° 39' 36.554017" W 79° 22' 36.693455"
56.8593m

Diff (sec) 0.0036
0.002717

Diff (cm) 8.499 5.729 33

Latitude Longitude Ellipsoidal height

PIER Latitude

AC12 Single N 43° 43' 31.599378" W 79° 29' 10.601954" 136.9565m

Diff (sec) 0.001496
0.01018

Diff (cm) 3.35852 22.8541 18.16

Longitude
Ellipsoidal height

137

6.2

Results for Precise Point Positioning

Online NRCan PPP can be used only to process code measurements when data are collected by single-frequency receivers, while phase data are used to process observations

collected by dual- frequency receivers (NRCan, 2007). The following comments can be
drawn for PPP using single-frequency measurement:

·

The accuracy of the final positions obtained for single-frequency measurements

will be less than the accuracy obtained for dual-frequency data because having two frequencies allows dual-frequency users to eliminate ionospheric error by
forming ionospheric free linear combination. In the case of single-frequency data,

global ionospheric maps produced by IGS are used by PPP to handle the
ionospheric effect.

·

The resolution of the LI-code measurements is significantly less than the one for
the carrier phase measurements.

·

Tropospheric delay may also degrade PPP results. This is because the total zenith
delay is estimated with millimetre precision when dual-frequency measurements

are

available,

but by

NRCan using a

PPP

accounts

for

tropospheric along with

delay default

in

LI

measurements

tropospheric

model

surface

meteorological data and an elevation mapping function (NRCan, 2007).

·

LI-code is more affected than carrier phase data by multipath, and multipath
effects have a major role on degrading the accuracy of the estimated coordinates.

Figures 6.13 and 6.14 show the accuracies obtained for all four points observed in static mode using single-frequency receiver. Figure 6.13 shows the results for the

138

points with minimal multipath effect (Steel and Milton). Figure 6.14 shows the results for the points with severe multipath effect (Ryerson and PIER).

Figures 6.13 and 6.14 show that the PPP results do not deliver clear cut differences between the points with minimal and severe multipath effect. The user does not have the option of disabling the unwanted satellites. If this option was available, it would improve the accuracy of the coordinates derived after removing the severely

multipath contaminated satellites identified by the wavelet analysis in Chapter 5.
COORDINATES DIFFERENCE - AC12 SENSOR

1.2

H Nil.Dill
^Long.Diff

0.8

1

Hlfiuhl.Difl

0.6

0.4

0.2

STEEL Point

MILTON

1

Figure 6.13 PPP-Results for Points with Minimal Multipath Effect

139

I - AC12 sensor 1.4 ILatDiff

1.2

|Long.Diff

RYERSON Point

PIER

Figure 6.14 PPP-Results for Points with Severe Multipath Effect

6.3

Results for Kinematic Baseline

Section 4.3.3 introduced the equipment used in the kinematic test. Trimble Total Control (TTC) software was used to process the data collected by the single- and dual-frequency

receivers using the On-The-Fly (OTF) ambiguity resolution technique. The ionospheric
bias was corrected by applying the IGS ionospheric maps for the period of observation.

The Saastamoinen tropospheric model (see Section 2.4.5) was used to account for the tropospheric delay, and the IGS final precise ephemeris was implemented to correct for
the ephemeris error.

The initial results indicated that most of the positioning derived along the track was driven by code data rather than by carrier phase data. This was because the cycle slips

140

and the continuous loss of locks encountered during the observations distorted the OTF
ambiguity resolution. Of the 8,165 epochs recorded, only 2,755 were derived by carrier phase positioning. Figure 6.15 shows the vehicle track during the data collection.

43.84

43.82

43.8

43.78

=

I 43.76
43.74

43.

-79.6

-79.55

-79.5

-79.45

-79.4

-79.35

Longitudes in decimal degrees

Figure 6.15 Vehicle Track during the Data Collection

The OTF technique is the most advanced technique available for resolving carrier phase ambiguities during motion. The technique requires continuous lock on at least five satellites for a sufficient period of time (Hofmann-Wellenhof et al., 2008). The time

interval required is usually from 10 seconds to 1 minute for dual- frequency data, and from 5 to 10 minutes for single-frequency data (Trimble, 2007a). The exact time

requirements for OTF ambiguity resolution depend very much on the number of tracked

satellites, the satellite geometry, and the signal multipath.

141

The following comments are based on the results obtained by the dual- and singlefrequency receivers:

1.

Since OTF uses code pseudoranges to define the search space for ambiguity
resolution (Hofmann-Wellenhof et al., 2008), this code solution should be as accurate as possible. The accuracy is directly related to the type of receiver used for data collection. The use of a dual-frequency receiver that is internally equipped with a multipath mitigation technique, such as the Narrow Correlator (see Section 3.5.2) will produce better code resolution than will a standard code
receiver.

2.

The ability of dual-frequency receivers to use measurements collected by LI and
L2 frequencies to form linear combinations such as the ionosphere-free linear combination and the wide-lane linear combination tremendously reduces the search time required for ambiguity resolution. This feature is not available for single- frequency users.

When loss of lock occurred, dual-frequency receiver provided faster initialization and

required less tracking time than did the single-frequency receiver.

For single-frequency

receivers, ambiguity resolution at the beginning of the observation session and after a cycle slip is a major concern, and causes many problems.

142

The final coordinates of the kinematic baseline were based on 30 minutes of carrier phase
measurements. The baseline extends about 10 km in the east-west direction and about 7.5 km in the north-south direction, as shown in Figure 6.16. Track derived by single-frequency receiver

43.85

43.8

43.75

-79.52

-79.5

-79.48

-79.46

-79.44

-79.42

43.85

Track derived by dual-frequency receiver

43.8

43.75

-



-79.54

-79.52

-79.5

-79.48

-79.46

-79.44

-79.42

Longitudes in decimal degrees

Figure 6.16 Final Track derived by Carrier Phase Observation for Single- and DualFrequency Receivers

Table 6.20 summarizes the statistics for the kinematic coordinates derived for latitude, longitude and ellipsoidal height for the test track. The average difference between the reference coordinates and the results derived by the single-frequency receiver for the horizontal components (latitude and longitude) is less than 6 cm, and the corresponding standard deviations are smaller than 10 cm. The average difference in the ellipsoidal height component is 11.05 cm, and the corresponding standard deviation is 25.5 cm. The

143

results support the possibility of implementing single-frequency receivers for various
precise kinematic applications.

Table 6.20 Kinematic Coordinates Difference Results
Standard
deviation (cm)

Parameter

Maximum (cm) 10.51 19.56
47.10

Minimum
(cm) -9.38

Mean (cm)
0.73 5.93 11.05

Latitude diff
Longitude diff
Ellipsoidal

4.68 9.20 25.55

-10.59
-77.9

height diff

Figure 6.17 shows the difference in the three positioning components (latitude, longitude

and ellipsoidal height) from the reference receiver.

1800

-0.2. 0

300

600

900

1200

1500

1800

300

600

900

1200

1500

1800

Epoclis in seconds

Figure 6.17 Differences in Positioning Components for the Observed Trajectory
s by AC 12 sensor

144

7

CONCLUSIONS AND RECOMMENDATIONS

7.1

Conclusions

Precise positioning using single-frequency GPS receivers under various multipath

environments have been extensively investigated in this research. The LI code minus carrier residuals, with ionospheric delay removed, was estimated for each satellite signal, leaving essentially multipath and system noise. A wavelet-based multipath identification
technique was successfully implemented to identify the code multipath in the residuals.

The reliability of the proposed multipath identification technique was demonstrated
through the improvement in the user position estimation at various locations with
moderate to high multipath environments. It has been shown that the positioning

accuracy was improved by up to 99% when wavelet-identified multipath-contaminated satellites were isolated from the final data processing. The improvement is more
significant when the multipath error is large. The achieved results convincingly

demonstrated the reliability of the wavelet analysis technique in identifying the multipath-contaminated satellite signal. This technique furnished the ground to isolate the multipath-contaminated satellites from the baseline processing, which results in speeding
up the ambiguity resolution and improving the accuracy of the estimated baseline
components.

Various static baselines with lengths ranging from 10 to 65 km were processed with both
the Bernese and the TTC software packages to validate our proposed multipath identification strategy and to examine the performance of the low-cost systems. The end

145

points of the baselines were located at various multipath environments. In all cases, the final coordinates obtained with the Bernese scientific software package were used as the
ground truth. Prior to removing the multipath-contaminated satellites, the obtained accuracy of the horizontal components ranged from 0.69 m to 15.7 m when data were processed with Bernese software, while the accuracy of the vertical component ranged
from 1.2 m to 9.3 m. On the other hand, the accuracy of the horizontal components determined by TTC software ranged from 0.21 m to 3.5 m, and the vertical component

accuracy ranged from 0.61 m to 8.9 m. This, however, was improved to 0.16 cm and 5.2 cm for both the horizontal and vertical components, respectively after isolating the
multipath-contaminated satellites identified with our wavelet-based method. The low-cost system was also tested in kinematic mode, where on-the-fly technique was implemented for ambiguity resolution. The data collected by the system suffered from continuous lose of lock which distorted the ambiguity resolution and most of the derived positioning was code-based solution instead of carrier phase.

7.2

Recommendations

Based on the results achieved in this research, further issues need to be investigated in future research. Among these are the following: ^

·

To investigate the possibility of modeling the other remaining errors in the
residuals, e.g. hardware delay, to be able to identify multipath in more rigorous
manner.

146

·

To improve the productivity of low-cost systems in multipath environment, a
more rigorous wavelet-based method is needed to automatically identify
multipath-contaminated satellite signals.

·

More work is required to examine our proposed multipath identification strategy
in the kinematic mode.

·

With the availability of real-time precise orbit and satellite clock corrections from
several organizations such as IGS and NRCan, the performance df low-cost
systems should be evaluated in real-time PPP mode.

·

In this research geodetic-quality antenna was implemented. Therefore, additional
tests are required to determine the suitability of using low-cost antennas for both
static and kinematic positioning.

·

Since the achieved results are appealing for various single-frequency GPS users,

other low-cost receivers, such as Garmin and Ublox need to be examined in future
research.

·

Further work should be done to examine the temporal correlations of system noise
of low-cost GPS receivers.

·

Finally, the effect of ionospheric disturbance can be significantly reduced,
especially for longer baselines if higher resolutions ionospheric maps are

implemented in the GPS post-processing softwares, for example NOAA USTEC
ionospheric maps.

147

8

REFERENCES

Alkan, R.M., El-Rabbany, A. and Saka, M.H. (2006). Assessment of Low-Cost Garmin
OEM GPS Receiver for Surveying Applications, Ontario Professional Surveyor,
49 (4), pp. 14-16.

Aram, M., A. El-Rabbany, and S. Krishnan (2007); "Single frequency Multipath Mitigation Based on Wavelet Analysis". The Journal of Navigation. Vol. 60. No.
2. pp. 281-290.

Axelrad, P., C.J. Comp, and P.F. MacDoran (1996), "SNR Based Multipath Error
Correction for GPS Differential Phase". IEEE Transactions on Aerospace & Electronic Systems, Vol. 32, No. 2, April, pp. 650-660.

Braash, M.S. (1996). "Multipath effects". Global Positioning System: theory and
applications, vol 1, ed. B.W. Parkinson and J.J. Spilker Jr., American Institute of Aeronautics and Astronautics, Washington DC, pp. 547-568.

Brown, A., A. Jovancevic, S. Ganguly, M. Kirchner and S. Zigic (2001). "Ionospheric
Correction Improvements for Single Frequency GPS Receivers". Proceeding of
ION 57th Annual Meeting/CIGTF 20th Biennial Guidance Test Symposium,
Albuquerque, NM, pp. 376-381.

Christopher., C, and P. Axelrad (1998)."Adaptive SNR-Based Carrier Phase Multipath
Mitigation Technique". IEEE Transactions on Aerospace & Electronic Systems,
Vol. 34, No. 1, January, pp.264-276.

148

Corcoran, W., (2008). "GPS Q &A," Earth Observation Magazine

(http://www.eomonline.com/Common/Archives/1998mav/98may gps.html).

Accessed on March 19th, 2008.
Dach, R., Hugentobler U., Fridez P. and Meindl M. (2007). "Bernese GPS Software Version 5.0 Manual, Astronomical Institute", University of Bern.
Daubechies, I. (1992). "Ten lectures on wavelets". Society for Industrial and Applied Mathematics (SLAM), Philadelphia, Pennsylvania. ·»

Elhabiby, M. (2007). "Wavelet Representation of Geodetic Operators". Ph.D. Thesis,

UCGE No. 20250, Department of Geomatics Engineering, The University of
Calgary, Calgary, Alberta, Canada, January, 148 pp. El-Rabbany, A. (2006a) "Advanced Satellite Positioning". Unpublished Lecture Notes, Department of Civil Engineering, Ryerson University. El-Rabbany, A. (2006b). "Introduction to GPS: The Global Positioning System". Artech
House Inc.

Estey, L. and C. Meertens (1999). "TEQC: the multi-purpose toolkit for GPS/GLONASS data". GPS Solutions, Vol.3 (1), pp. 42^9.

Fugal, Lee (2008). "Conseptual Wavelets in Digital Signal Processing", electronic
version; (http://www.conceptualwavelets.com/book.html). Accessed on March

19th, 2008.
Fu, W. and C. Rizos (1997). "The applications of wavelets to GPS signal processing".
Proceeding of the 10th Int. Tech. Meeting of the Satellite Division of the U.S.

Inst. of Navigation, Kansas City, Missouri, 16-19 September, pp. 1385-1388.

149

GBSS (2007). "ASHTECH Geodetic Base Station Software User's Manual V 3.2.0.pdf". Magellan Corporation. Hofmann-Wellenhof-Wellenhof, B., H. Lichtenegger, and E. Wasle (2008). "GNSS Global Navigation Satellite Systems; GPS, GLONASS, GALILEO & more".
Springer Wien New York.

Jones, J., and P. C. Fenton (2008). "The Theory and Performance of NovAtel Inc.'s
Vision Correlator". NovAtel Inc. (http://www.novatel.ca). Accessed on March

16th, 2008.
Jones, J., P. Fenton and B. Smith (2004) "Theory and Performance of the Pulse Aperture

Correlator." Internet:(http://www.novatel.ca). Accessed on March 16th, 2008.
Kaplan, E., and H. Christopher (2006). "Understanding GPS Principles and
Applications", Artech House Inc.

Langley RB (1998). "GPS Receivers and the Observables". In: Teunissen PJG, Kleusberg
A (Eds) GPS for Geodesy. Springer, pp. 151-185. Leick, A., (2004). "GPS Satellite Surveying". 3rd ed., New York: Wiley.

Linyuan, X. (2004) "Multipath in GPS navigation and positioning". GPS Solutions, vol.
8, no 2, Springer-Verlag, pp. 49-50.

Linyuan, X. and J. Liu (2001). "Approach for Multipath Reduction Using Wavelet
Algorithm". In:Proceedings of ION GPS-2001, Salt Lake City, UT, September
ll-14,pp.2134-2143. Magellangps (2007). "A12, B12 & AC12",

,tt.

(ftp://ftp.magellangps.com./OEM.%20Sensor%20%26%20ADU/A12,%20%20Bl

150

2.%20%26%20AC12/Reference%20Material/A12,%20B12%20%26%20AC12%

20RM%20rev%20E.pdf). Accessed on February 13th, 2007.
Masella, E., M. Gonthier, and M. Dumaine (1997). "The RT-Star: Features and Performance of a Low-Cost RTK OEM Sensor". In: proceeding of the ION GPS'97, The International Technical Meeting of the Satellite Division of the ION,
Kansas City, Missouri, pp. 53-59. Misiti, M., Y. Misisti, G. Oppenheim, and J. Poggi (2007). "Wavelet Toolbox 4 User's Guide". The MathWorks, Inc. Nee, V., J. Siereveld, P. Fenton, and B. Townsend (1994). "The Multipath Estimating Delay Lock Loop: Approaching Theoretical Accuracy Limits". Proceedings of the
IEEE Position, Location and Navigation Symposium, Las Vegas, NV, USA. NOAA (2007a). "Real-Time US Total Electron Content Product Description

Document.pdf". (http://www.sec.noaa.gov/ustec/). Accessed on September 9th,
2007.
NOAA (2007b). "US-TEC Techical Document.pdf. Accessed at

http://www.sec.noaa.gov/ustec/docs/Doc.pdfon September 9th, 2007.
NOAA (2007c). "US-TEC Validation Document.pdf (2006)".

(http://www.sec.noaa.gov/ustec/docs/). Accessed on September 9th, 2007.
NRCan (2007). "On-line Precise Point Positioning; How To Use Document".

(www.geod.nrcan.gc.ca), Accessed on March 10th, 2007.
Orus, R., M. Hernandez-Pajares, J.M. Juan, J. Sanz, and M. Garcia-fernandez (2002). "Performance of Different TEC models to provide GPS ionospheric corrections."

151

Journal of Atmospheric and solar-Terrestrial physics", vol 64, PERGAMON, pp.
2055-2062.

Philippov, V., I. Sutiagin and Ashjae (1999). "Measured characteristics of dual depth dual frequency chock ring for multipath rejection in GPS receivers".
In:Proceedings of ION GPS-99, 12th International Technical Meeting of the Satellite Division of the Institute of Navigation, Nashville, Tennessee, September
14-17, pp. 793-796.

Ray, J. (2000). "Mitigation of GPS Code and Carrier Phase Multipath Effects Using a Multi-Antenna System". Ph.D. Thesis, UCGE No. 20136, Department of Geomatics Engineering, The University of Calgary, Calgary, Alberta, Canada,
March, 260 pp.

Richard, DJ., V. Nee, J. Siereveld, J. Fenton and B. Townsend (1994). "The Multipath
Estimating Delay Lock Loop: Approaching Theoretiacal Accuracy limits". IEEE Position, Location and Navigation Symposium, Las Vegas, Nevada.

Rizos, C. (1996). "Principles And Practice Of GPS Surveying". GMAT5222 Course
Notes, School of Geomatics Engineering, The University of New South Wales, Sydney, NSW 2052 Australia.

Rizos, C, S. Han and X. Han (1998). "Performance Analysis of a Single-Frequency^ Low-Cost GPS Surveying System". In: Proc. Of 1 lth Int. Tech. Meeting of the
Satellite Division of the US ION, GPS ION'98, Nashville, Tennessee, pp.427435.

152

Rowell, T. F. (2005). "USTEC: a new product from the Space Environment Center
characterizing the ionospheric total electron content," GPS Solutions, SpringerVerlag. Vol. 9, pp. 236-239.

Saeki, M. and M. Hori (2006). "Development of an Accurate Positioning System Using
Low-Cost LI GPS Receivers". Computer-Aided Civil and Infrastructure
Engineering, 21 (4), pp. 258-267.

Sahmoudi, M. and M. Amin (2006). "Improved Maximum-Likelihood Time Delay
Estimation for GPS Positioning in Multipath, Interference and Low SNR Environments". In:Proceeding of PLANS 2006; IEEE/ION Position, Location And Navigation Symposium; San Diego, CA, April 25-27; pp. 876-882.

Satirapod, C. and C. Rizos (2005). "Multipath mitigation by wavelet analysis for GPS base station applications". Surv Rev 38(295),pp.2-10.
Schaer, S., G. Beutler, and M. Rothacher (1998a). "Mapping And Predicting The Ionosphere", in Proceedings of the IGS Analysis Center Workshop, Darmstadt, Germany, February 9-11. Schaer, S., W. Gurtner, and J. Feltens (1998b). "IONEX: The IONosphere Map

EXchange FormatVersion 1". in Proceedings of the IGS Analysis CenterWorkshop, edited by J.M. Dow et al, pp. 233-247, ESA/ESOC,
Darmstadt, Germany, February 9-11.

Souza, E. M. and J. F. Monico (2004). "Wavelet shrinkage: high frequency multipath

reduction from GPS relative positioning". GPS Solutions, Vol 8, pp. 152-159.

153

Soderholm, S. (2005). "GPS LI Carrier Phase Double Difference Solution Using Low
Cost Receivers". In: Proc. Of ION GNSS 18th International Technical Meeting of the Satellite Division, Long Beach, CA, pp. 376-380.

Teunissen, P. J. G. and A. Kleusberg (1998). " GPS for Geodesy". 2nd Ed., New
York: Springer-Verlag.

Trimble (2007a) "Trimble Total Control User,s Manual.pdf", accessed at http://
www.trimble.com on 28 Feb 2007.

Trimble (2007b) "Trimble R8 GPS System data sheet.pdf", accessed at http://
www.trimble.com on 28 June 2007.

Townsend, B. and P. Fenton (1994). "A Practical Approach to the Reduction of
Pseudorange Multipath Errors in a LI GPS Receiver". Proceedings of ION GPS94,Sa\t Lake City, September 20-23, pp. 143-148.

Townsend, B., J. Wiebe, A. Jakab, M. Clayton, and Murfin, T (2000). "Analysis of the
Multipath Meter Performance in Environments with Multiple Interferers". In:Proceedings of ION GPS-2000, Salt Lake City, UT, September 19-22:480-488.

Van Dierendonck, A. J., P. Fenton and T. Ford (1992). "Theory and Performance of Narrow Correlator Spacing in a GPS Receiver". Journal of the Institute of
Navigation, Vol. 39, No. 3, 1992.

Yousif, H. and A. El-Rabbany (2007). "Assessment of Several Interpolation Methods for

Precise GPS Orbit", Journal of Navigation Vol. 60, pp. 443 - 455.
Zhong, P., X. Ding, D. Zheng and W. Chen (2007). "Adaptive wavelet transform based

on cross-validation method and its application to GPS multipath mitigation". GPS solution. Springer-Verlag.Vol. 12, No. 2 pp. 109-117.

154

APPENDIX: SUPPLEMENTARY PPP RESULTS

1. PPP results for point STEEL
Pseudo-Range Residuals ( 17:21:10 UTC 2007/07/31 )

17:40

18:00

18:20

18:40

19:00

19:20

I PRK 01

] PRN 30

 PRN 31

D PP." 03

D PKN 06

D PRN 13

 PRH 14

 PRN 16

D PRN 20

 PRN 23

 PRN 2S

Latitude Differences ( 17:21:10 UTC 2007/07/31 )

-1.4

17:40

18:00

18:20

18:40

19:00

 Latitude Latitude (nux,«in) = (-0.681, -1,385)

Longitude Differences ( 17:21:10 UTC 2007/07/31 )

17:40

18:00

18:20

18:40

19:00

 Longitude Longitude («iax,min) = (-0.748, -1.494)

Height Differences ( 17:21:10 UTC 2007/07/31 )

17:40  Height

18:00

18:20

18:40

-18:00

19:20

Height (max,Bin) = (3,080, 0.761)

Figure 1. PPP results for point STEEL

155

2. PPP results for point MILTON

Pseudo-Range Residuals 1
2 0

IS :25 26 UTC 2007/OvOI )

·

0 0

& IS IN

*&

___

-2 0

1
-4 0

-6 0

·

16:40

17:00

17:20

17:40

18:00

16:20

 PRH 01 D PR* 23

D PRK 06  PRN 30

D PUN 06  PRN 31

 PP.N 07

 PRH 12

 PR» 14

D PRN 16

 PRK 20

 PRN 22

Latitude Differences ( 16:25:26 ITC 2007/08/01 )

16:40

17:00

17:20

17:40

18:00

18:20

 Latitude

Latitude (wx,«in) - (-0.186, -1.007)

Longitude Differences ( 16:25:26 UTC 2007/08/01 )

 Longitude
Longitude (MX,»in) - (-0.707, -1.421)

Height Differences ( 16:25:26 ITC 2007/08/01 )

16:40

17:00

17:20

17:40

18:00

18120

 Height Height (nax.ain)  (4.069, 2.754)

Figure 2. PPP results for point MILTON

156

3. PPP results for point RYERSON
Pseudo-Range Residuals I
15:44:49 UTC 2007/08/02

)

10

E

0

-6

r
: ;
16:00

law I m\
:
16:20 16:40 17:00 17:20 17:40

' i 1



ilk

v

i -10 I PRN 01
I PRN 30

D PRN 06
 PRN 31

D PRN 06

D PRN 07

 PRN 12

 PRN 14

 PRN 16

 PRN 20

I

Latitude Differences ( 15:44:49 UTC 2007/08/02 )
-10 f |

t

;. | j
-20

I
;

I4IXXIII
-30 ·

16:00

16 20

16:40

17:00

17:20

17:40

: j

 Latitude Latitude (nax,min)  (-8.184, -31 505)

L Longitude Differences ( 15:44:49 UTC 2007/08/02 )
25

20
vt

...,iv

15

i
10

5 16:00 16:20 16:40 17:00 17:20 17:40

 Longitude Longitude (nax,»in) - (24.154, 5.540)

Height Differences ( 15:44:49 UTC 2007/08/02 )

16:00

16:20

16:40

17:00

17:20

17:40

 Height Height (max,nin) « (11.012, -0.153)

Figure 3. PPP results for point RYERSON

157

4. PPP results for point PIER

Pseudo-Range Residuals ( 19:01:27 UTC 2007/08/02 )

-10

^

13:20

13:40

20:00

20:20

20:40

21:00

 PRN 01
HI PRN 27

D PRN 03
 PRN 31

 PRN 07

O PR* 13

 PRN 16

 PRN 19

D PRN 20

 PRN 23

 PRN 26

Latitude Differences ( 19:01:27 UTC 2007/08/02 )

19:20

19:40

20:00

20:20

20:40

 Latitude
Latitude (wx,nin) - (2.534, 0.003)

Longitude Differences ( 19:01:27 UTC 2007/08/02 )

19:20

19:40

20:00

20:20

20:40

21:00

 Longitude Longitude (MX,«in) - (0.036, -0.929)

Height Differences ( 19:01:27 ITC 2007/08/02 )

 Height Height (max,*in) - (S.320, 4,200)

Figure 4. PPP results for point PIER

158

