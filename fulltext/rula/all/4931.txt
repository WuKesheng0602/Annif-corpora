Higher Dimensional Probability of Default in Structural Models

by

Julie Ao Honours Bachelor of Science, McMaster University, 2013

A thesis presented to Ryerson University

in partial fulfillment of the requirements for the degree of Master of Science in the Program of Applied Mathematics

Toronto, Ontario, Canada, 2016 ©Julie Ao 2016

AUTHOR'S DECLARATION FOR ELECTRONIC SUBMISSION OF A THESIS
I hereby declare that I am the sole author of this thesis. This is a true copy of the thesis, including any required final revisions, as accepted by my examiners. I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research. I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. I understand that my thesis may be made electronically available to the public.

ii

Abstract
Higher Dimensional Probability of Default in Structural Models Master of Science 2016 Julie Ao Applied Mathematics Ryerson University This thesis describes the joint probability distribution of defaults in two, three and four dimensions. In particular, default as defined by Merton and Black and Cox using analytical and simulated Monte Carlo approaches. Our analytical approach in a Merton setting, utilizes the multivariate normal to compute the joint probability distribution in any dimension. In a Black-Cox setting, analytical solutions are defined in specific dimensions, therefore we rely on a simulated approach. The precision of our simulated approaches are evaluated using 104 , 107 and up to 107.5 paths 1 . We use our results to compare the probability of defaults in both settings as well as tail dependence, portfolio value and value at risk. Tail dependence is evaluated in two and three dimensions with =0.3 and =0.9. We define covariance parameters in four dimensions; "normal" and "crisis" market conditions, to evaluate portfolio value in a credit and market portfolio and value at risk.

1 the

greatest integer function returns the largest integer less than or equal 107.5

iii

Acknowledgements
I would first like to thank my supervisor, Dr. Marcos Escobar, for his patience and guidance in helping me complete this thesis. I also appreciate the advice and time of Dr. Sebastian Ferrando, Dr. Pablo Olivares, Dr. Alexander Alvarez and my fellow classmates. Finally, it is with the support of my family and friends that I was able to pursue my education.

iv

Dedication

To my mom, dad and sister.

v

Contents
Abstract List of Tables List of Figures List of Appendices 1 Introduction 1.1 Objectives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1.2 Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . iii viii x xi 1 1 3 7 7 9 9 11 12 18 19 23

2 Types of Default 2.1 2.2 Multidimensional Lognormal Wiener Process . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.1.1 Euler's Discretization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Defaults as per Merton . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.2.1 2.2.2 2.3 2.3.1 2.3.2 Multivariate Normal Distribution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Comparison Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Connection to PDE's and known solutions . . . . . . . . . . . . . . . . . . . . . . . . . Simulation Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

Defaults as per Black and Cox . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

3 Discretization Methods 30 3.1 Finite Difference Methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31 3.1.1 One Spatial Dimension Heat Parabolic . . . . . . . . . . . . . . . . . . . . . . . . . . . 3.1.2 Two Spatial Dimensions Heat Parabolic . . . . . . . . . . . . . . . . . . . . . . . . . . Finite Element Method . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3.2.1 3.2.2 3.3 3.3.1 One Spatial Dimension Heat Parabolic . . . . . . . . . . . . . . . . . . . . . . . . . . . Two Spatial Dimensions Heat Parabolic . . . . . . . . . . . . . . . . . . . . . . . . . . Getfem++ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32 34 36 36 38 39 39

3.2

Computational Tools . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

vi

3.3.2

FreeFem++ . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

40 41 41 49 49 53 58 59 63 68 72 106

4 Analysis of Joint Probabilities 4.1 4.2 Merton vs Black-Cox Settings . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Tail Dependence . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.2.1 Two Dimensions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.2.2 Three Dimensions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

5 Portfolio Analysis 5.1 5.2 5.3 Credit Portfolio Distribution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Market Portfolio Distribution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Risk Measures of a Portfolio . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

6 Conclusion References

vii

List of Tables
2.1 2.2 2.3 2.4 2.5 2.6 2.7 2.8 2.9 4.1 4.2 4.3 4.4 4.5 4.6 4.7 4.8 4.9 5.1 5.2 5.3 5.4 The probability distribution of defaults in a two dimensional Merton setting . . . . . . . . . . Error of the joint probability distribution in a two dimensional Merton setting . . . . . . . . The probability distribution of defaults in a three dimensional Merton setting . . . . . . . . . Error of the joint probability distribution in a three dimensional Merton setting . . . . . . . . Comparison of running time using our Monte Carlo approach and analytical approach . . . . The probability distribution of defaults in a two dimensional Black-Cox setting . . . . . . . . Error of the joint probability distribution in two dimensional Black-Cox setting . . . . . . . . The probability distribution of defaults in a three dimensional Black-Cox setting . . . . . . . Error of the joint probability distribution in a three Dimensional Black-Cox setting . . . . . . Comparison of error in a two dimensional setting . . . . . . . . . . . . . . . . . . . . . . . . . Ratio comparison in a two dimensional setting . . . . . . . . . . . . . . . . . . . . . . . . . . Comparison of error in a three dimensional setting . . . . . . . . . . . . . . . . . . . . . . . . Ratio comparison in a three dimensional setting . . . . . . . . . . . . . . . . . . . . . . . . . . Comparison of running time in a Merton and Black-Cox setting . . . . . . . . . . . . . . . . . Marginal probability of Company 2 defaulting in two dimensions . . . . . . . . . . . . . . . . Confidence Intervals describing tail dependence in a two dimensional setting . . . . . . . . . Marginal probability of Company 2 defaulting in three dimensions . . . . . . . . . . . . . . . Confidence Intervals describing tail dependence in a three dimensional setting . . . . . . . . 12 13 14 14 16 26 26 27 28 42 43 45 46 48 51 52 54 56 69 69 70 70 74 75 76 77 78

Value at risk of our credit portfolio in a "normal" market . . . . . . . . . . . . . . . . . . . . Value at risk of our market portfolio in a "normal" market . . . . . . . . . . . . . . . . . . . Value at risk of our credit portfolio in a "crisis" market . . . . . . . . . . . . . . . . . . . . . Value at risk of our market portfolio in a "crisis" market . . . . . . . . . . . . . . . . . . . . .

A.1 The probability distribution of defaults in a four dimensional Merton setting . . . . . . . . . A.2 Error of the joint probability distribution in a four dimensional Merton setting . . . . . . . . B.1 The probability distribution of defaults in a four dimensional Black-Cox setting . . . . . . . . B.2 Error of the joint probability distribution in a four dimensional Black-Cox setting . . . . . . . C.1 Comparison of error in a four dimensional setting . . . . . . . . . . . . . . . . . . . . . . . . . viii

C.2 Ratio comparison in a four dimensional setting . . . . . . . . . . . . . . . . . . . . . . . . . . D.1 The probability distribution of defaults in a four dimensional "normal" Merton setting . . . . D.2 The probability distribution of defaults in a four dimensional "normal" Black-Cox setting . . E.1 The probability distribution of defaults in a four dimensional "crisis" Merton setting . . . . . E.2 The probability distribution of defaults in a four dimensional "crisis" Black-Cox setting . . .

79 80 80 81 81

ix

List of Figures
2.1 2.2 4.1 4.2 4.3 5.1 5.2 5.3 5.4 5.5 5.6 5.7 Convergence of the joint probability distribution using a debt of $90 . . . . . . . . . . . . . . Convergence of the joint probability distribution using a debt of $60 . . . . . . . . . . . . . . Ratio comparison in a two dimensional setting for debt $60 to $90 . . . . . . . . . . . . . . . Tail dependence in a two dimensional setting . . . . . . . . . . . . . . . . . . . . . . . . . . . Tail dependence in a three dimensional setting . . . . . . . . . . . . . . . . . . . . . . . . . . Distribution of a four dimensional credit portfolio in a "normal" market . . . . . . . . . . . . Distribution of a four dimensional credit portfolio in a "crisis" market . . . . . . . . . . . . . Distribution of a four dimensional market portfolio in a "normal" market . . . . . . . . . . . Distribution of X1 in a four dimensional market portfolio in a "normal" market . . . . . . . . Distribution of a four dimensional market portfolio value in a "crisis" market . . . . . . . . . Distribution of Xi in a Merton setting using a market portfolio in a "crisis" market . . . . . . Distribution of Xi in a Black-Cox setting using a market portfolio in a "crisis" market . . . . 24 25 43 50 54 61 62 64 65 65 66 67

x

List of Appendices
Appendix A - Four Dimensional Results in a Merton setting 74 A.1 Probability Distribution of Defaults . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 74 A.2 Error of the Probability Distribution of Defaults . . . . . . . . . . . . . . . . . . . . . . . . . . Appendix B - Four Dimensional Results in a Black-Cox setting B.1 Probability Distribution of Defaults . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . B.2 Error of the Probability Distribution of Defaults . . . . . . . . . . . . . . . . . . . . . . . . . . 74 76 76 77

Appendix C - Comparison between Structural Models in Four Dimensions 78 C.1 Error of the Joint Probability Distribution in a Merton and Black-Cox setting . . . . . . . . . 78 C.2 Ratio Comparision in a Merton and Black-Cox setting . . . . . . . . . . . . . . . . . . . . . . . Appendix D - Joint Probabiliy Distribution under "Normal" Market Conditions Appendix E - Joint Probability Distribution under "Crisis" Market Conditions 78 80 81

Appendix F - Numerical Code in Two Dimensions 82 F.1 Merton Setting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83 F.2 Black-Cox Setting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Appendix G - Numerical Code in Three Dimensions G.1 Merton Setting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . G.2 Black-Cox Setting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84 86 86 88

Appendix H - Numerical Code in Four Dimensions 90 H.1 Merton Setting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 90 H.2 Black-Cox Setting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98

xi

Chapter 1

Introduction
Events with low probability have the capacity to impact financial markets globally. Financial experts are usually able to predict events with a large to medium likelihood either by estimating reasonable models or with an intuitive understanding of markets. However, there are many circumstances with low probability that escape their analysis. Recent events such as the near-default situation in Greece since 2010 or the stock market recession in 2008, have demonstrated the global impact of extreme default-type events. The stock market collapse in 2008, began in the housing market, expanding to companies in the stock market simultaneously. The 2008 recession displayed the clear relationship between the behaviour of several companies and multiple defaults. The incorrect modeling of codependence between companies and the simplistic noneconomical approach to measuring default was a part of the flawed assessment of asset risk. Additionally, the impact of Greece's declining economical situation is still being felt today, six years later. Repercussions of this crisis include the continuous bailout by several European nations and the possible withdrawal of Greece from the European Union and the Euro. These scenarios may result in a significantly altered global financial/economical structures with unknown consequences on the financial markets worldwide. As a result, these events have renewed the interest in economically meaningful definitions of default and risk assessment.

1.1

Objectives

In this thesis, we take economically reliable approaches to defining default in the financial market and study their implications to better assess financial default. As unpredictable as the financial market is, we attempt to model aspects of risk measure and default in order to construct a realistic simulation. We focus specifically on the structural models defined by Merton (see[10]) and Black and Cox (see[3]) in dimensions two, three and four. In the Merton model, default is triggered when the asset value becomes less than the debt due at the time of maturity. The Black-Cox model can be seen as an extension of the Merton model, where default is

1

CHAPTER 1. INTRODUCTION

1.1. OBJECTIVES

measured with the minimum asset value over time. If the value of debt is greater than the minimum asset value, we conclude that default has occurred prior to maturity. This is interpreted as a default barrier in a Black-Cox setting. Previous papers have examined the effects of a number of barriers on the joint probability of default in specific dimensions. Efficiently pricing double barrier derivatives in stochastic volatility models by M. Escobar, P. Hieber, and M. Scherer (see[7]) describes a one dimensional case with two barriers, while Pricing two-assets barrier options under stochastic correlation via perturbation theory (see[5]) analyzes a two dimensional scenario with two barriers under stochastic correlation. Additionally in The method of images in the pricing of barrier derivatives in three dimensions by X. Wan (see[15]), the closed-form solution in three dimensions with three barriers is presented. Closed-solutions for n dimensions and n barriers with particular values of correlation is also provided in A note on the distribution of multivariate brownian extrema by M. Escobar and J. Hernandez (see[6]). In this thesis, we will evaluate and compare structural default with 2 models; Merton (see[10]) and Black-Cox (see[3]). This comparison allows us to study many probabilistic aspects such as the joint probabilities of default, tail dependence, distribution of portfolio value and value at risk in these two settings. One important aspect associated with default is its joint probability distribution. The joint probability distribution will display as a by-product, the likelihood of joint defaults in our settings. The analytical method in a Merton setting is commonly used, as it involves the multivariate normal, allowing us to evaluate default in any dimension. In a Black-Cox setting, the analysis of the joint probability of default can be approached analytically in some cases and through simulations in any dimension. In [15] and [8], an analytical approach is established using the joint probability density and distribution function in dimensions one and two. Note, results are only defined in three dimensions for specific correlation values, (see[15]). Through the integration of the joint probability density and distribution function, the joint probability of non-default is obtained. However, results using this approach can not be applied in higher dimensions. Additionally, numerical discretization methods can be used to evaluate the Fokker-Planck equation and hence the joint probability distribution in a Black-Cox setting. Finite Difference and Finite Element Methods provide numerical techniques that are capable of solving the Fokker-Planck equation in any dimension. These methodologies are not fully available in software or a variety of interfaces for dimensions larger than two or three, therefore in the context of this thesis, we rely on a simulated approach to approximate the joint probability distribution in a Black-Cox setting in higher dimensions. Additionally, the probability of default will be used to construct a popular measure named "tail dependence". Tail dependence is another aspect of codependence between companies that evaluates the likelihood of large joint movements, hence it can be associated to the concept of default. We will conduct a comparison between our two structural approaches in terms of tail dependence. This thesis also outlines the risk measures of a higher dimensional portfolio as well as its practical applications in evaluating portfolio value. Our approach analyzes the probability distribution of portfolio value in four dimensions, examining its risk assessment in the financial market with the well known concept of value at risk. Using a Monte Carlo approach, we simulate portfolio value and value at risk with 2 sets of covariance and debt parameters; one set will simulate "normal" market conditions and another a "crisis" market. Portfolio value may be defined in 2

CHAPTER 1. INTRODUCTION

1.2. RESULTS

numerous ways, however we focus on 2 practical and popular settings. One case describes a credit portfolio, allocating value to the portfolio in the event of non-default. The second case represents a market portfolio which depends on asset values as well as weight/allocations. Using the previous parameters and settings of our portfolio construction, we define the value at risk associated with our credit and market portfolios. Using the probability distribution of portfolio value and its value at risk, we gain a better understanding of risk measure and defaults regarding portfolios in a Merton and Black-Cox setting.

1.2

Results

In Chapter 2, we introduce 2 structural definitions of default; Merton (see[10]) and Black-Cox (see[3]). In both settings, we evaluate the joint probability distribution of defaults in dimensions two, three and four using debt of $90, correlation 0.3 and volatility 0.2. In Section 2.1; a Merton setting, we use both an analytical multivariate normal and simulated Monte Carlo approach to evaluate the joint probability distribution of default. Additionally, we compare the joint probability distribution of our 2 approaches using the error obtained with our simulated approach using 104 and 107 paths. Our error analysis shows that a simulated distribution using 104 paths will not provide a reasonable approximation to our analytical results while 107 paths provides an more precise approximation. We also compare the running time of our simulated and analytical approaches in dimensions three, four, five and six. In dimensions two, three and four, the running time of the analytical approach is lower than our simulated approach, however in dimensions five and six, our Monte Carlo simulation has a lower running time than our analytical approach. Our analytical approach evaluates nn multivariate normal calculations since we utilize a multidimensional vector to evaluate the joint probability distribution. However there are only 2n probabilistic events of default, resulting in many duplicated multivariate normal calculations in our analytical approach. In lower dimensions, the running time of our analytical approach will not be significantly affected by the number of duplicated calculations, however in higher dimensions the number of duplicated multivariate normal calculations increases. In five dimensions, our analytically approach evaluates 55 =3125 multivariate calculations, however there are only 25 =32 joint probabilities of default. In six dimensions, there are 26 =64 joint probabilities of default but our analytical approach evaluates 66 =46656 multivariate calculations. Thus in higher dimensions, our analytical approach will evaluate several duplicated joint probabilities, extending the running time in comparison to our Monte Carlo simulation using 107 paths. In Section 2.2, we extend the definition of default to a Black-Cox setting. We also introduce known solutions that are obtained from analytically evaluating the joint probability distribution as a probability density function. The analytical approach in a Black-Cox setting evaluates the Fokker-Planck equation with arbitrary initial and boundary conditions to present an expression for the joint probability of non-default. However, the solution to this PDE is only explicitly defined in dimensions one and two, (see[8]). Additionally, the solution to the Fokker-Planck equation in three dimensions is only defined for specific correlation values, (see[15]). The solution to the Fokker-Planck equation is presented as the joint probability density and distribution function, which can be integrated to obtain the joint probability of non-default. Extending

3

CHAPTER 1. INTRODUCTION

1.2. RESULTS

this approach to higher dimensions will require significant computational effort as solutions are not explicitly defined. Hence, we rely on a simulated Monte Carlo approach to approximate the joint probability distribution in a Black-Cox setting in dimensions two, three and four using 104 , 107 and 107.5  paths1 . We also evaluate the joint probability distribution using a debt of $60, to evaluate the precision of our simulation when using 104 , 107 and 107.5  paths. We conclude that 107 paths will provide a precise approximation of

the joint probability distribution using a debt of $60. Additionally, using the joint probability distribution with a debt of $90 and 107.5  paths we compare the error of our simulated approaches and conclude that 107 paths provides a reasonable approximation. In Chapter 3, we introduce 2 discretization methods capable of evaluating higher order n dimensional PDE's; the Finite Difference and Finite Element Methods. These methods can be used to numerically evaluate the Fokker-Planck equation and thus the joint probability of non-default in a Black-Cox setting. Explicit solutions to the Fokker-Planck equation are only defined in dimensions one and two and certain cases in three dimensions, therefore we can alternatively utilize discretization methods to obtain numerical solutions in any dimension. The Finite Difference Method utilizes a computational grid and approximation schemes to evaluate the solution to a given PDE at any grid point. There are several finite schemes that can be used, they include FTCS (Forward in Time, Centered in Space), BTCS (Backward in Time, Centered in Space) and CN (Crank-Nicolson). We also introduce the heat equation in one and two dimensions to demonstrate the Finite Difference Method since it can be obtained from the Fokker-Planck equation though a transformation of the boundary condition. Another discretization method that can be used to numerically evaluate the joint probability distribution in a Black-Cox setting is the Finite Element Method. This method evaluates a PDE in its integral form to approximate the solution as well as allowing discretizing the boundary condition into elements. The use of elements is beneficial when discretizing complexly shaped boundary conditions. Similarly to our use of the Finite Difference Method, we introduce the solution to the heat equation in one and two dimensions using the Finite Element Method to demonstrate this discretization method. In this chapter, we also describe 2 computational tools; Getfem++ and FreeFem++ , that can help in evaluating the joint probability distribution in a Black-Cox setting. Both tools are mainly utilized in C++, therefore the interfaces of these programs limits our usage of each software. Both tools are capable of evaluating PDE's with arbitrary initial and boundary conditions in at least dimensions two and three. In Chapter 4, we compare the joint probability distributions obtained in Chapter 2; a Merton and BlackCox setting as well as evaluate a known measure between random variables called "tail dependence". In dimensions two, three and four, we compare the joint probability distributions in a Merton and Black-Cox setting using a ratio of our distributions. In dimensions two, three and four, our ratio displays a large difference of the probability of non-default and all companies defaulting. Therefore, there is a large variation measured between the joint probability of all companies defaulting and non-default in a Merton and BlackCox setting. The measure of tail dependence can be seen as a proxy for the likelihood of default between several companies. We compute it using the joint probability distributions obtained in Chapter 2 via the
1 the

greatest integer function returns the largest integer less than or equal 107.5

4

CHAPTER 1. INTRODUCTION

1.2. RESULTS

ratio of our results in a Merton and Black-Cox setting. We are able to graphically model tail dependence in a Merton and Black-Cox setting in two and three dimensions using 2 values of correlation; =0.3 and =0.9 and a debt of $[37, 65]. These 2 values of correlation are used to simulate positive values of correlation that may be observed in financial markets. The tail dependence in both two and three dimensions display greater dependence in a Black-Cox setting than in a Merton setting. Additionally, both measures of tail dependence are also tending towards 0 as the value of debt approaches $37. We also construct confidence intervals for various values of debt using correlation =0.3 and =0.9 with a 95% accuracy to conclude that for values of debt greater than $55, the tail dependence in a Black-Cox setting is greater than in a Merton setting in both dimensions two and three. Also in three dimensions, the value of tail dependence is tending towards 0 faster than in two dimensions in both a Merton and Black-Cox setting. In Chapter 5, we evaluate the distribution of portfolio value and risk measures of a credit and market portfolio. In Section 5.1 we assess the distribution of a credit and market portfolio under "normal" and "crisis" conditions in four dimensions. Under "normal" market conditions, we define the optimal asset allocation
1 =0.25 for i =0.2 and =0.3, to simulate covariance parameters in current market conditions. In of ai = n

"crisis" conditions, we define an asset allocation using the Minimum Variance Optimal Allocation equation as defined by Markowitz based on our covariance parameters. Using 1 =0.25, 2 =0.20, 3 =0.15 and 4 =0.10 and =0.9, the asset allocation is a1 =-0.0026, a2 =0.0582, a3 =0.2140 and a4 =0.7304 in our "crisis" market. Additionally, we define debt in a "normal" market of $70 and $90 in our "crisis" market as well as µi =0.04 in both market conditions. For our "crisis" market conditions, we define covariance and debt parameters that simulate a market with a high probability of multiple companies defaulting. A credit portfolio allocates weight/allocation to our portfolio in the event of non-default while a market portfolio uses the asset value as well as the weight to evaluate portfolio value. We simulate the distribution of a credit and market portfolio in a Merton and Black-Cox setting in both "normal" and "crisis" market conditions. In both a "normal" market and "crisis" market conditions using a credit portfolio, the distribution of portfolio value in a Merton and Black-Cox setting in negatively skewed. Using a market portfolio under "normal" and "crisis" conditions, the portfolio value distribution in a Merton setting is positively skewed while the distribution is negatively skewed in a Black-Cox setting. In Section 5.2, we evaluate the value at risk associated with our portfolios with =0.1, 0.05 and 0.01 probability using our credit and market portfolios under "normal" and "crisis" conditions. In "normal" market conditions with a credit portfolio, there is a 1% probability that portfolio value decreases by more than $0.75 in both a Merton and Black-Cox setting. Additionally, there is a 5% probability of a $0.5 decrease in our credit portfolio value in both a Merton and Black-Cox setting and a 10% probability of a $0.25 decrease in a Merton setting and $0.5 decrease in a Black-Cox setting, implying greater risk with our credit portfolio in the mid-tail of our distribution. Therefore with a 1% and 5% probability, the potential loss is alike in a credit portfolio under "normal" conditions in a Merton and Black-Cox setting. In "normal" market conditions with a market portfolio, there is a 10% and 5% probability that our portfolio value will decrease by -$19.96 in a Merton setting and -$25 in a Black-Cox setting. Also there is a 1% probability of a -$36.5 decrease in portfolio value in a Merton setting and -$30 in a Black-Cox setting, implying there is greater risk farther in the tail of our distribution in both a Merton and Black-Cox setting under "normal" market conditions of a market portfolio. Under "crisis" market conditions 5

CHAPTER 1. INTRODUCTION

1.2. RESULTS

using a credit portfolio, there is a 1% and 5% probability that our portfolio value decreases by $1.0026 in both a Merton and Black-Cox setting. With a 10% probability, our credit portfolio value may decrease by $0.2722 in a Merton setting and $1.0026 in a Black-Cox setting. Thus, under "crisis" market conditions of a credit portfolio, the potential loss is similar in both a Merton and Black-Cox setting with a 1% and 5% probability and there is greater risk in a Black-Cox setting with a 10% probability. In "crisis" market conditions with a market portfolio, there is a 1% probability of our portfolio value decreasing by -$30.32 in a Merton setting and -$22.18 in a Black-Cox setting. There is also a 5% and 10% probability that market portfolio value decreases by -$ 16.40 in a Merton setting and -$17.73 in a Black-Cox setting. Thus for a market portfolio using "crisis" market conditions, there is a 5% and 10% probability of less potential loss than a 1% probability in both a Merton and Black-Cox setting. This implies there is greater risk farther in the tail of our distribution.

6

Chapter 2

Types of Default
In this chapter, we introduce the 2 structural models which are the main focus in this thesis. Our first model will rely on Merton's model (see[10]) to define default. In this setting, we are able to evaluate the joint probability distribution of defaults analytically as well as use a simulated approach. The results of our simulated and analytically methods are displayed in dimensions two, three and four. The running time of these two methods in a Merton setting are compared as well as the accuracy of our simulation using 104 and 107 paths. We also define default in a Black-Cox setting (see[3]) for dimensions two, three and four. Within this structural setting, we use a simulated approach using 104 and 107 paths to approximate the joint probability distribution as closed-form solutions are rare. The objective of this section is to evaluate the joint probability distribution of default in a Merton and Black-Cox setting. In a Merton setting, we are able to use an analytical approach using the multivariate normal and compare the results to a simulated approach using 104 and 107 paths. This allows us to approximate the error of our simulated approach and evaluate its accuracy. In a Black-Cox setting, we approximate the joint probability distribution through simulations displaying the error of our approximation via a comparison to a larger number of paths.

2.1

Multidimensional Lognormal Wiener Process

To begin our analysis of asset value Si , we need to mathematically define a process to simulate its value. The value of Si is affected by the drift, µi and volatility, i between each company. In the following analysis, we assume that i and µi are constant. We use a Geometric Brownian process to represent the asset value, Si as: dSi = µi dt + i dWi Si i = 1...n

where Wi is a Wiener process and correlation d < Wi , Wj >= ij dt. To construct a lognormal Wiener process to model Si , we assume that f (Si ) = log (Si ) for i = 1, . . . , n for n dimensions. This process is 7

CHAPTER 2. TYPES OF DEFAULT 2.1. MULTIDIMENSIONAL LOGNORMAL WIENER PROCESS described below as: 1 2 2 dlog (Si ) = f  (Si )ds + f  (Si )Si i dt 2 1 1 2 2 1 i dt = dSi + (- 2 ) Si Si Si 2 1 2 dlog (Si ) = i dWi + µi dt - i dt 2  t  t  t 1 2 ( µ i - i i dWi + dlog (Si ) = )dt 2 0 0 0 2 log (Si (t)) = (µi - i )t + log (Si (0)) + i Wi (t) 2 see([14]). We construct multidimensional lognormal processes with: corr(Wi (t), Wj (t)) = ij where (Wi (t), . . . , Wj (t))  N (0, R) with covariance matrix, R = (ij ). Additionally, we establish expressions

for mean µ ~i and variance  ~i 2 using our lognormal Wiener process: µ ~i = E [log (Si (t))] = E [(µi - = (µi -

2 i )t + log (Si (0)) + i Wi (t)] 2

2 i )t + log (Si (0)) + E [i Wi (t)] 2 2 = (µi - i )t + log (Si (0)) 2

 ~i 2 = V ar[log (Si (t))]
2 i )t + log (Si (0)) + i Wi (t)] 2 = V ar[i Wi (t)]

= V ar[(µi -

2 = i V ar[Wi (t)] 2 = i t

see([13]). Using the results described above, we establish a process log (Si (t)): log (Si (t))  N ((µi -
2 i 2 )t + log (Si (0)), i t) 2

for every t. We will use normal random variables, log (Si (t)), to represent the asset value in our 2 structural models of default; Merton and Black-Cox. In the expressions defined above, it is assumed that µi and i were constant, however we will redefine volatility and mean to simulate our normal random variables in the

8

CHAPTER 2. TYPES OF DEFAULT next section.

2.2. DEFAULTS AS PER MERTON

2.1.1

Euler's Discretization

The asset value is typically represented with a continuous time stochastic process, therefore to simulate the value Si (t), we discretize time using an Euler discretization. Previously, we defined Si (t) with a stochastic differential equation that assumed µi and i were constants. We now assume that mean, µi , and volatility, i , are functions of Si (t) and t, allowing us to redefine our stochastic differential equation as: dSi (t) = µi (Si (t), t)dt + i (Si (t), t)dWi (t) S i ( t) where Wi (t) is a Brownian motion/Wiener process. As a result, we are able to simulate Si (t) over the time interval [0, T ] discretized by h in t  {0, h, 2h . . . , T }. Note that the results in this thesis utilizes a value of
1 h= 250 to discretize our time interval. This allows us to simulate the value of Si (t) as a lognormal process

as:

dSi (t) = µi (Si (t), t)dt + i (Si (t), t)dWi (t) S i ( t)  Let Xi = logSi (t)  t+h  t+h  i ( Xi , s) 2  µ i ( Xi , s) - dXi =  i ( X i , s ) W i ( t) ds + 2 t t t  i ( X i , s) 2  h + i (Xi , s)Wi (t) X i ( t + h)  X i ( t) + µ i ( X i , s ) - 2
t+h

lognormal process Xi in multiple dimensions using:

where Wi (t)  N (0, h), t  {0, h, 2h, . . . , T } and Wi (t) = Wi (t + h) - Wi (t). From this, we simulate the

corr(Wi (t), Wj (t)) = ij where (Wi (t), . . . , Wj (t))  N (0, h · R) with covariance matrix, R = (ij ). Additionally, we will use our discretization to approximate the value of Xi (t) with discrete time steps.

2.2

Defaults as per Merton

One of the most popular approaches to assessing default was defined by Merton in 1974. This setting specifies that a Company i defaults if the value of its assets at time of maturity T , is less than the debt due at T . If at T , the total value of the firm's assets is greater than the debt, the debt can be repaid in full and

9

CHAPTER 2. TYPES OF DEFAULT no default occurs. We can define: i : the time of default of Company i T : time to maturity Si : asset value of Company i Di : debt of Company i

2.2. DEFAULTS AS PER MERTON

Therefore we define a non-default event, measured at the time of maturity T for Company i as: {i > T }  {Si (T ) > Di } Similarly, a default event is defined as: {i  T }  {Si (T )  Di } This model is mainly utilized in the context of lognormal processes, therefore it is assumed that the total value of a firm's assets, Si (t), follow a geometric Brownian motion defined as: dSi (t) = µi Si (t)dt + i Si (t)dWi (t) with Si (0)  0, drift, µi and volatility, i . We extend the probability of non-default and default in a one dimensional setting to n dimensions utilizing joint probabilities. The probability events we are interested in examining in n dimensions include: P (1 > T ) = P (S1 (T ) > D1 ) : Company 1 has not defaulted P (1 > T, 2 > T ) = P (S1 (T ) > D1 , S2 (T ) > D2 ) : Company 1 and Company 2 have not defaulted In general: P (1 > T, . . . , n > T ) = P (S1 (T ) > D1 , . . . Sn (T ) > Dn ) : Companies 1, . . . , n have not defaulted for any n We also describe similar relationships when a particular group of companies have defaulted. For example: P (1  T ) = P (S1 (T )  D1 ) : Company 1 has defaulted P (1  T, . . . , j  T, j +1 > T, . . . , n > T ) = P (S1 (T )  D1 , . . . , Sj (T )  Dj , Sj +1 (T ) > Dj +1 , . . . , Sn (T ) > Dn ) : Companies 1, . . . , j have defaulted and Companies j+1 ,. . . , n have not defaulted

10

CHAPTER 2. TYPES OF DEFAULT

2.2. DEFAULTS AS PER MERTON

2.2.1

Multivariate Normal Distribution

To analytically evaluate the joint probability distribution in dimensions two, three and four, we use the multivariate normal to evaluate the cumulative distribution function and describe the joint probability distribution. Within a Merton setting, the joint probability distribution of defaults can be calculated analytically since it is assumed that the value of each firms assets Si , follow a Geometric Brownian process. We will use the lognormal process, log (Si (t)) as defined in Section 1.2 to represent the asset value of Company i. We also define a normal distribution for n random variables with i, j  n with:
2 i )t + log (Si (0)) 2

µ ~i = (µi -
2  ~i 2 = i t

Firstly, we consider a bivariate normal distribution with n = 2 and extend the result to n dimensions. With 2 random variables: X1 = log (S1 (t)) X2 = log (S2 (t)) we define the joint probability density function as: fX1 ,X2 (x1 , x2 ) = 1 
~2 ) e 2(1- -1

 ~ij = 

< dlog (Si (0)), dlog (Sj (0)) > < dlog (Si (0)) > · < dlog (Sj (0)) >

[(

x 1 -µ ~ x -µ ~ 1 )2 - 2 1 ~( 1  ~ ~ 1 1

)(

x 2 -µ ~ 2  ~ 2

)+(

x 2 -µ ~ 2 )2 )]  ~ 2

2 2 2  ~1 ~2

1-

 ~2

for all xi , µ ~i  R,  ~i > 0, and -1   ~  1. In higher dimensions, we can use vector notation to describe the ~ in vector joint probability density. Therefore, using our random variables X1 and X2 , we reestablish µ ~,  notation as:  X1 , X= X2   x1 , x= x2   µ ~1 , µ ~= µ ~2  ~=    ~1 2  ~ ~1  ~2  ~ ~1  ~2  ~2 

~ is the covariance matrix. As a result, the where the vector µ ~, contains the mean of X1 and X2 and  probability density function for a two dimensional random vector, fX (x), can be expressed as: fX ( x) = 1 ~|1 2 (2 ) |
2 2

~) e - 2 (x - µ

1

T

~ -1 ( x - µ  ~)

for all x. This can be easily extended to n dimensions using n random variables. In this thesis, we use the multivariate normal to evaluate the joint probability distribution in dimensions two, three and four. Our analytical approach will allow us to measure the error and accuracy of our simulated Monte Carlo approach. Note that in this thesis, we evaluate the multivariate normal using a function within MATLAB® called 11

CHAPTER 2. TYPES OF DEFAULT

2.2. DEFAULTS AS PER MERTON

mvncdf. This function evaluates the multivariate normal cumulative probability over a rectangle defined with lower and upper bounds. This allows us to compute the multivariate normal up to a dimension size of twenty-five.

2.2.2

Comparison Results

The use of Gaussian random variables within the Merton setting allows us to compute the joint probability distributions using the multivariate normal. We use the joint probability distributions obtained analytically to create a comparison with our simulated results using 104 and 107 paths to evaluate the precision of this approach. Additionally, the running time of these 2 approaches will be compared. The parameters for the following calculations are: Si = 100 i = 0.2 µi = 0.04 ij = 0.3 Di = 90 for i = 1 . . . n, j = 1 . . . n with n = 2, 3 and 4. Our initial set of covariance parameters we define represent realistic market conditions i.e. volatility, correlation and interest rate. Additionally the value of debt $90 simulates an approximately A rated company (see[12]). The first set of results using a Monte Carlo (MC) simulation with 104 and 107 paths and using an analytical (AN) approach are outlined in two dimensions:
1 Default MC Company 1 2 paths 104 107 104 107 0.1589 0.1607 0.1678 0.1604 0.1605 0.1605 AN Company 1, 2 104 107 2 Defaults MC paths 0.1021 0.1048 0.1049 AN Company 104 107 No Default MC paths 0.5712 0.5739 0.5741 AN

Table 2.1: The probability distribution of defaults in a two dimensional Merton setting In Table 2.1, there is a high probability of non-default in our simulated joint probability distribution; 0.5712 using 104 paths, 0.5739 using 107 paths and 0.5741 using an analytical approach. The lowest joint probability we obtained using our Monte Carlo simulation and analytical approach is the joint probability of 2 defaults, 0.1021 using 104 paths, 0.1048 using 107 paths and 0.1049 using an analytical approach. From our 2 simulated number of paths, 104 and 107 , there is a low absolute difference between the joint probabilities obtained, between 0.0018 and 0.0027.

12

CHAPTER 2. TYPES OF DEFAULT

2.2. DEFAULTS AS PER MERTON

Using our analytically calculated joint probability distribution, we can compare the accuracy of our simulated Monte Carlo results using 104 and 107 paths. We define error in a Merton setting as: |p ~ - pAN | |pAN | (2.1)

where p ~ represents our simulated joint probability and pAN is obtained with our analytical approach. We ~107 . The error of our two dimensional joint probability distinguish p ~ for our 2 number of paths;p ~104 and p distribution is described in the following table:
1 Default Company 1 2 paths 10 10 10
4 7 4

2 Defaults Company 0.9968% 0.1246% 4.548% 0.0623% 1, 2 paths 10 10
4 7

No Default Company 2.6692% 0.0953% paths 104 10
7

0.5051% 0.0348%

107

Table 2.2: Error of the joint probability distribution in a two dimensional Merton setting In two, three and four dimensions, we will compare the error obtained when simulating the joint probability of 1 default to determine the accuracy of our probability distribution using 104 and 107 paths. In two dimensions with 104 paths, the error is 0.9968% and 0.1246% with 107 paths for only Company 1 defaulting. However, the error of only Company 2 defaulting is 4.548% using 104 paths and 0.0623% using 107 paths, implying a low level of accuracy using 104 paths. Additionally, an increase in the number of paths to 107 decreases error to less than 1% for each joint probability in our distribution. This can be observed in the error of 2 defaults, where there is significantly higher value of error using 104 paths, 2.6692% and 0.0953% using 107 paths. Therefore for the parameters defined in this setting, we conclude that 107 paths will provide a reasonably accurate estimation of the probability distribution in a two dimensional Merton setting. We also record the running time of our Monte Carlo simulation in dimension two, three and four. In two dimensions, we observed a running time of 0.520785 sec using 104 paths and 314.1941 sec using 107 paths in our Monte Carlo simulation. We further extend our joint probability distribution analysis and error analysis to higher dimensions in the next tables. In the following table, the simulated Monte Carlo approach using 104 and 107 paths and our analytical approach are both used to evaluate the joint probability distribution in three dimensions.

13

CHAPTER 2. TYPES OF DEFAULT
1 Default MC Company 1 2 3 paths 104 107 104 10
7

2.2. DEFAULTS AS PER MERTON
3 Defaults AN Company 0.0525 0.0533 0.0522 0.0535 0.0550 0.0533 0.0534 0.0534 0.0534 1, 2, 3 104 107 MC paths 0.0564 0.0515 0.0514 AN Company 104 107 No Default MC paths 0.4552 0.4670 0.4669 AN

2 Defaults AN Company 0.1071 0.1071 0.1071 1, 2 1, 3 2, 3 104 107 104 107 104 107 MC paths

0.1104 0.1069 0.1098 0.1071 0.1085 0.1070

104 107

Table 2.3: The probability distribution of defaults in a three dimensional Merton setting In Table 2.3 there is a high probability of non-default; 0.4542 using 104 paths, 0.4670 using 107 paths and 0.4669 using an analytical approach. Also, the lowest joint probability using our Monte Carlo simulation and analytical approach is the joint probability of 3 defaults. In our Monte Carlo approach, the joint probability of 3 defaults is 0.0564 using 104 paths, 0.0515 using 107 paths and 0.0514 using our analytical approach. From Table 2.3, there is also a low probability of 2 defaults, which varies from 0.0522 to 0.0550 using 104 paths, approximately 0.0533 using 107 paths using our Monte Carlo simulation and 0.0534 using our analytical approach. Additionally, the absolute difference of our Monte Carlo simulations using 104 and 107 paths is low, between 0.0008 and 0.0118.
1 Default Company 1 2 3 paths 104 107 10
4

2 Defaults Company 3.081% 0.1867% 2.521% 0 1.3071% 0.0933% 2, 3 1, 3 1, 2 paths 104 107 10
4

3 Defaults Company 1.685% 0.1872% 2.247% 0.1872% 2.996% 0.1872% 1, 2, 3 paths 104 107 9.7276% 0.1945%

No Default Company paths 104 107 2.5058% 0.0214%

107 104 107

107 104 107

Table 2.4: Error of the joint probability distribution in a three dimensional Merton setting Similarly to our analysis in two dimensions, we analyze the error of our three dimensional results for the case of a single company defaulting. Using 104 paths, the error observed is 3.081% with 104 paths and 0.18674% with 107 paths for only Company 1 defaulting. The error of only Company 2 defaulting displays an error of 2.521% using 104 paths and 0% using 107 paths. The error of only Company 3 defaulting has an error of 1.3071% using 104 paths and 0.0933% using 107 paths. Note that in principle due to the symmetry of the parameters, all these probabilities should be similar. The use of 104 paths produces several values of error greater than 2% in our simulated joint probability distribution, such as the error of Company 1 and 3 defaulting, Company 1, 2 and 3 defaulting and non-default. Previously in two dimensions, we observed that 107 paths provided a sufficient level of accuracy between our analytical and simulated results. In three dimensions, 107 paths also provides a more precise approximation to our analytical probability distribution than 104 paths, decreasing the error to less than 1%. The running time of our simulated approach was 0.777 sec using 104 paths and 525.931 sec using 107 paths.

14

CHAPTER 2. TYPES OF DEFAULT

2.2. DEFAULTS AS PER MERTON

We continue extending our analysis of the probability distribution of defaults in Merton's model to four dimensions. In Appendix A.1, we evaluate the joint probability distribution using both an analytical approach and simulated Monte Carlo approach using 104 and 107 paths. As in Table 2.1 and Table 2.3, there is a high probability of non-default; 0.3975 using 104 paths, 0.3906 using 107 paths and 0.3906 using our analytical approach. There is also a low joint probability of 4, 3, 2 and 1 defaults in both our Monte Carlo and analytical approaches, where the lowest joint probabilities are 4 and 3 defaults. The joint probabilities obtained using a Monte Carlo simulation of 4 defaults was 0.0286 using 104 paths, 0.0289 using 107 paths and 0.0289 using our analytical approach. The joint probability of 3 defaults varies from 0.0217 to 0.0240 using 104 paths, approximately 0.0225 using 107 paths in our Monte Carlo simulation and 0.0225 using our analytical approach. Additionally, the absolute difference using 104 and 107 paths in our Monte Carlo simulation is low, between 0.0001 and 0.0069. Using the results seen in Appendix A.1, Table 2.3 and Table 2.1 for dimensions two, three and four, there was a high joint probability of non-default using both our Monte Carlo and analytical approaches. Using 107 paths in our two dimensional Monte Carlo simulation, the probability of non-default is 0.5739, 0.4670 in three dimensions and 0.3906 in four dimensions. The joint probability of non-default is 0.5741 in two dimensions, 0.4669 in three dimensions and 0.3906 in four dimensions using our analytical method. Also in dimensions two, three and four, there was a low probability of all companies defaulting using both Monte Carlo and analytical methods. In two dimensions, the joint probability of 2 defaults was 0.1048, a joint probability of 0.0515 for 3 defaults in three dimensions and 0.0289 for 4 defaults in four dimensions using our Monte Carlo method using 107 paths. Using our analytical approach, the joint probability of all companies defaulting was 0.1049 in two dimensions, 0.0514 in three dimensions and 0.0289 in four dimensions. Additionally in dimensions two, three and four, there was a low absolute difference between the joint probability distributions using 104 and 107 paths in our Monte Carlo simulation. In two dimensions the absolute difference between simulations using 104 and 107 paths was between 0.0018 to 0.0027, 0.0008 to 0.0118 in three dimensions and 0.0001 to 0.0069 in four dimensions. Similarly to our previous analysis in dimensions two and three, we use our Monte Carlo and analytical approaches to evaluate the precision of 104 and 107 paths in our simulation. Appendix A.2 describes the error of our simulated Monte Carlo approach using 104 and 107 paths. The errors in four dimensions show that 107 paths will reasonably approximate the analytical probability distribution. The error obtained with 104 paths is 1.8372% and 0.2624% with 107 paths for only Company 1 defaulting. The error of only Company 2 defaulting is 1.3106% using 104 paths and 0.13106% using 107 paths. Additionally, the error of only Company 3 defaulting is 2.3622% using 104 paths and 0% using 107 paths. Lastly, the error of only Company 4 defaulting is 1.9659% using 104 paths and 0% using 107 paths. 104 paths produces several simulated results with error greater than 2%, such as the error of only Company 3 defaulting, Company 2 and 4 defaulting, Company 1, 2 and 3 defaulting, Company 1, 2 and 4 defaulting and Company 2, 3 and 4 defaulting. The error significantly decreases to less than 1% with the use of a higher number of paths, implying 107 paths is a reasonable number of paths to achieve high precision. As expected, there also was an increase in running time as dimension size increased from dimensions two, three and four. In four dimensions, 15

CHAPTER 2. TYPES OF DEFAULT

2.2. DEFAULTS AS PER MERTON

the running time of our Monte Carlo approach was 1.277 sec using 104 paths and 691.177 sec using 107 paths. Using our error analysis in dimensions two, three and four, we conclude that 104 paths will not provide an accurate simulation of the joint probability distribution of defaults. Using 104 paths, the error of various joint probabilities in each dimension size is greater than 1%, while the error decreases to less than 1% using 107 paths. We compare the running time of our simulated Monte Carlo and analytical approaches in the following table in dimensions three, four, five and six. This table evaluates the effect that dimension size and number of paths has on the running time of our simulated and analytical approaches. We use the same parameters that are outlined at the beginning of this section to simulate and evaluate the joint probability distribution for each method.
Dimension Paths 104 3 105 106 107 104 4 10 106 107 10 5
4 5

Time Monte Carlo (sec) 0.77253 4.420221 50.164061 525.93177 1.277659 5.888973 62.297806 691.1777 2.804857 6.817001 85.178890 929.35833 3.110969 11.009738 110.471979 1131.96129

Time Analytical (sec) 2.702934

5.685258

105 106 107 10
4

84.555450

6

105 106 107

2371.373875

Table 2.5: Comparison of running time using our Monte Carlo approach and analytical approach Our running time analysis shows that in a lower dimensional setting, our analytical approach requires less time in comparison to a simulated approach. From our results in a three dimensional setting, the running time for our analytical approach is lower than the running time of our Monte Carlo simulation using a number of paths greater than 105 . However as previously mentioned, 104 paths will not provide an accurate simulation of the joint probability distribution in a three dimensional setting. To simulate an accurate probability distribution in three dimensions using 107 paths, there is a significantly larger running time than our analytical approach; 525.9377 sec vs 2.702934 sec. Our results in a four dimensional setting also display similar results. In four dimensions, our analytical method requires a lower running time than our simulated method using 105 paths. However, the use of 104 paths has a high value of error as analyzed previously. Therefore a higher value of paths such as 107 is required in four dimensions, implying our analytical ap16

CHAPTER 2. TYPES OF DEFAULT

2.2. DEFAULTS AS PER MERTON

proach requires less time for a more precise result compared to our Monte Carlo simulation in three and four dimensions. The running time of our analytical method also displays an increase in dimensions four to five. This increase in time affects our comparison between the use of a Monte Carlo simulation and our analytical approach. In five dimensions, our analytical approach has a running time of approximately 84.555 sec, which is similar to the running time of a Monte Carlo approach using 106 paths. However, in five dimensions it is expected that a higher number of paths is required for an accurate approximation of the joint probability distribution. As a result it may be more beneficial in lower dimensions like three, four and five to use an analytical approach since there is a considerably lower running time required to achieve a precise approximation of the joint probability distribution. There is also an increase in the running time of our analytical method measured from dimensions five to six. The running time of our analytical approach in six dimensions is greater than the running time using a Monte Carlo method for 107 paths. Therefore a simulated approach may be more convenient than our analytical approach for higher dimensions since there is a lower running time required. For our analytical approach using the multivariate normal, we modeled a multidimensional vector with n = 2, 3, 4, 5 and 6. In two dimensions, we used a two dimensional vector to evaluate the multivariate normal and 22 =4 probabilistic events of default. Additionally, the joint probability distribution in two dimensions contains 22 =4 joint probabilities of default. Thus, the probabilities simulated with our multidimensional vector coincided with the 4 joint probabilities of default in our probability distribution. In a three dimensional setting, our analytical approach simulated a three dimensional vector where the multivariate normal evaluated 33 =27 probabilities of default. However in three dimensions, our probability distribution contains only 23 =9 joint probabilities of default implying our analytical approach evaluates several duplicated joint probabilities. Despite this, the running time of the analytical approach is approximately 5.685 sec. In a four dimensional setting, our analytical approach evaluated 44 =256 multivariate normal calculations and 55 =3125 in five dimensions, resulting in a significant increase in the running time of our analytical approach from dimensions four to five. Additionally, there are only 24 =16 joint probabilities of default in four dimensions and 25 =32 in five dimensions. Therefore, there are a large number of joint probabilities of default that are evaluated multiple times in dimensions four and five using our analytical approach. As we extend this approach to higher dimensions, our analytical solution simulates an n dimensional vector to evaluate the multivariate normal in n dimensions. As a result for each dimension n, our analytical method evaluates nn multivariate normal calculations, however there are only 2n joint probabilities of default contained in each joint probability distribution. Thus, there are a significantly large number of joint probabilities that are duplicated as dimension size increases, affecting the running time of our analytical method. In a six dimensional setting, there is a large increase in running time of our analytical approach compared to the results in lower dimensions. Our analytical approach in six dimensions requires the evaluation of 66 = 46656 multivariate normal calculations. However, the joint probability distribution only contains 26 =64 joint probabilities of default. Thus, there is a significant increase in the number of multivariate normal 17

CHAPTER 2. TYPES OF DEFAULT

2.3. DEFAULTS AS PER BLACK AND COX

calculations evaluated in six dimensions than in five dimensions; 46656 vs 3125 respectively. As a result, the time required to compute solutions analytically grows exponentially in dimensions five to six. Concluding, for higher dimensions it is more time effective to use a Monte Carlo simulated approach as a simulated approach may reach the same level of accuracy compared to an analytically model with less computational effort.

2.3

Defaults as per Black and Cox

An extension to the Merton model outlined in Section 2.1, was established in 1976 by Black and Cox (see[3]). The Black-Cox model specifies default as the first time the firm's asset value Si , drops below a debt threshold, Di . This allows default to take place at any time t, not only at time of maturity T . Although Black and Cox considered a time dependent default threshold, our analysis will assume a constant default threshold Di . As a result, we define a non-default event as: {i > T }  {Si (T ) > Di } where Si (T ) = min Si (t). We also describe the time of default, i as:
0 t  T

i = inf {t > 0 : Si (t)  Di } Similarly to Section 2.1, we can define the joint probability distribution of defaults in a one dimensional setting and extend this result to higher dimensions, allowing us to evaluate default and non-default as well as combinations of both events. We begin with the joint probability of non-default which we can relate to the time of default, i as: P (1 > T ) = P (S1 (T ) > D1 ) : Company 1 has not defaulted P (1 > T, 2 > T ) = P (S1 (T ) > D1 , S2 (T ) > D2 ) : Company 1 and Company 2 have not defaulted In general: P (1 > T, . . . , n > T ) = P (S1 (T ) > D1 , . . . Sn (T ) > Dn ) : Companies 1, . . . , n have not defaulted We can use the definition of default in a Black-Cox setting to describe the joint probability distribution of defaults in n dimensions. In this scenario, we describe default in one dimension and extend this to higher dimensional combinations of default and non-default. Similarly to our description of non-default, we can also relate the joint probability of default to the time of default, i . For example: P (1  T ) = P (S1 (T )  D1 ) : Company 1 has defaulted P (1  T, . . . , j  T, j +1 > T, . . . , n > T ) = P (S1 (T )  D1 , . . . , Sj (T )  Dj , Sj +1 (T ) > Dj +1 , . . . , Sn (T ) > Dn ) : Companies 1,. . . , j have defaulted and Companies j+1 ,. . . , n have not defaulted 18

CHAPTER 2. TYPES OF DEFAULT

2.3. DEFAULTS AS PER BLACK AND COX

It is possible to modify the Black-Cox model to account for stochastic interest rates, time dependent or stochastic default barriers and jumps in asset value processes. These extensions introduce more realistic situations into the model, however the analytical complexity increases as well. Additionally, none of these cases lead to closed-form solutions in two dimensions and higher. Also the default threshold, Di can be interpreted in various ways, it can act as a measure of the firm's debt allowing bondholders to control the company once its asset value has reached this level. It could also act as a protection mechanism for bondholders against unsatisfactory corporate performance. In these cases, the threshold would be fixed when the firm's debt is issued.

2.3.1

Connection to PDE's and known solutions

The joint probability of non-default can be obtained analytically in a Black-Cox setting, however it is only defined in one and two dimensions (see[8]) and for specific correlation values in three dimensions (see[15]). The correlation values described in [15] in three dimensions are:     (-cos(   3 ), -cos( 3 ), 0)    (-cos(  ), -cos(  ), 0) 4 3 =     ( - cos ( ) , - cos (  5 3 ), 0)    (-cos(  ), 0, 0) N

12 , 13 , 23

for N  2. The analytical method uses a higher order mixed parabolic partial differential equation; the Fokker-Planck equation with boundary and initial conditions to evaluate the joint probability of non-default via the probability density and distribution function. In this section, we study the analytical solutions of the following Fokker-Planck equation in one and two dimensions. Firstly, we redefine our discretization in Section 1.2.1 with assumed initial conditions to analyze the results that are outlined in dimension one and two, (see[8]). We define the following stochastic differential equation to describe the asset value Si : dSi (t) = µi dt + i dWi (t) S i ( t) with Xi (t) = logSi (t) dXi (t) = (µi -
2 i )dt + i dWi 2 2 Xi (t) = Xi (0) + (µi - i )t + i Wi (t) 2

Additionally, using the assumptions that: Xi (0) = 0 ( µi -
2 i ) = i 2

19

CHAPTER 2. TYPES OF DEFAULT

2.3. DEFAULTS AS PER BLACK AND COX

we relate the joint probability of non-default with the results outlined in [8] and [15] given that the process Xi (t) in a one dimensional setting is defined as: X1 (t) = min X1 (s)
0<s<t

Beginning in one dimension, the Fokker-Planck equation is described as: g 1 2 2g g (x1 , t) = -1 (x1 , t) + 1 (x1 , t) t x1 2 x2 1 with 1 = (µ1 -
2 1 2 ),

(2.2)

t = 0, X1 (0) = log(S1 (0)) = 0 and initial condition: g (x1 , t = 0) =  (x1 )

where  (x) is the Dirac delta function with a spike at x = 0. We also add a boundary condition with the debt threshold, log (D1 ): g (x1 = log (D1 ), t) = 0 Using this notation, the function g satisfies equation (2.2) and represents the probability density and distribution function. Integrating the density dependence from the probability density and distribution function, we obtain the probability distribution function which allows us to define the joint probability of non-default. Following the results from [8] where log (D1 ) represents the debt threshold of X1 , drift µ1 and T time of maturity, the probability density and distribution function, P (X1 (t)  dx1 , X1 (t) > log (D1 )) in one dimension is described as: P (X1 (t)  dx1 , X1 (t) > log (D1 )) = g (x1 , log (D1 ), T ; µ1 )dx1 where xi > log (Di ) and log (Di ) < 0. Additionally, the function g (x1 , log (D1 ), T ; µ1 ) is defined as: g (x1 , log (D1 ), T ; µ1 ) =
2 2 -x + µ T 1  ( 1  1 )(1 - e-(4(log(D1 )) -4log(D1 )x1 )/21 T ) 1 T 1 T

The probability density and distribution function, g, describes density with respect to x1 and distribution with respect to X1 . We obtain the probability distribution function, G, through the integration of the density dependence, dx1 . This is defined in one dimension as: P (X1 (t) > log (D1 )) =  g (x1 , log (D1 ), T ; µ1 )dx1
log (D1 )

= G(log (D1 ), T ; µ1 ) Upon integrating the probability density and distribution function, we define the probability of non-default, 20

CHAPTER 2. TYPES OF DEFAULT

2.3. DEFAULTS AS PER BLACK AND COX

G. Using [8], the function G(log (D1 ), T ; µ1 ) is explictly defined as: G(log (D1 ), T ; µ1 ) = N (
2 -log (D1 ) + µ1 T log (D1 ) + µ1 T   ) - e2µ1 log(D1 )/1 N ( ) 1 T 1 T

 where (z ) = exp(-z 2 /2)/ 2 is the standard normal density, and N (·) is the corresponding distribution function. Extending the Fokker-Planck equation to two dimensions, we also obtain an analytical solution to the joint probability of non-default. In two dimensions, the Fokker-Planck equation with i = 2 is described as:
2 2   g 2g g 1  2 2g i j ij i 2 (xi , t) + i (xi , t) + (xi , t) (xi , t) = - t xi 2 i=1 xi xi xj i<j i=1

(2.3)

with i = (µi -

2 i 2 ),

t = 0, Xi (0) = log(Si (0)) = 0 for i=1,2 and initial condition: g (x1 , x2 , t = 0) =  (x1 ) (x2 )

and the boundary conditions: g (x1 = log (D1 ), x2 , t) g (x1 , x2 = log (D2 ), t) =0 =0

Similarly to the results in one dimension, in two dimensions we analyze the probability density and distribution function of two correlated Brownian motions X1 (t) and X2 (t) such that: Xi (t) = min Xi (s)
0<s<t

In two dimensions, we define the probability density and distribution function, g, to measure density with respect to dx1 and dx2 as well as distribution with respect to X1 and X2 . Using this notation, g will satisfy equation (2.3). Upon defining g and integrating the density dependence, the joint probability distribution function, G will represent the joint probability of non-default. Additionally, we consider xi > log (Di ) and log (Di ) < 0 for the debt thresholds log (D1 ) and log (D2 ). In two dimensions, the probability density and distribution function is defined as: P (X1 (t)  dx1 , X2 (t)  dx2 , X1 (t) > log (D1 ), X2 (t) > log (D2 )) = g (x1 , x2 , log (D1 ), log (D2 ), T ; µ1 , µ2 )dx1 dx2 where

21

CHAPTER 2. TYPES OF DEFAULT g (x1 , x2 , log (D1 ), log (D2 ), T ; µ1 , µ2 ) =

2.3. DEFAULTS AS PER BLACK AND COX

and a1 , a2 , b and h(x1 , x2 , T ; log (D1 ), log (D2 ), µ1 , µ2 , 1 , 2 , ) are defined in [8]. Similarly to the one dimensional results, by integrating over the probability density and distribution function and applying a change of polar-coordinates, the joint probability of non-default G is obtained. P (X1 (t) > log (D1 ), X2 (t) > log (D2 )) =   g (x1 , x2 , log (D1 ), log (D2 ), T ; µ1 , µ2 )dx1 dx2
log (D1 )

ea1 x1 +a2 x2 +bT  h(x1 , x2 , T ; log (D1 ), log (D2 ), µ1 , µ2 , 1 , 2 , )  1  2 1 - 2

log (D2 )

= G(log (D1 ), log (D2 ), T ; µ1 , µ2 ) Where G(log (D1 ), log (D2 ), T ; µ1 , µ2 ) = ea1 log(D1 )+a2 log(D2 )+bT f (r ,  , T ) given that: a1 = -µ1 2 + µ2 1 2 (1 - 2 )1 2 a2 = -µ2 1 + µ1 2 2 (1 - 2 )1 2

1 2 2 1 2 2 a1 + 1 2 a1 a2 + 2 a2 b = µ 1 a 1 + µ2 a 2 + 1 2 2    2  n n -r2 µ   2 T f (r ,  , T ) =  sin(  )gn ()d sin(  )e µ T n=1 µ µ 0 with gn ( ) = and
1  log (D )2 1 2log (D1 )log (D2 ) log (D2 )2  2 1 r =  - + 2 2 1 1 2 2 1 - 2





re
0

-r 2 2T

( e-b1 rcos(+µ)-b2 rsin(+µ) I n µ

rr )dr T

 =  + µ tan(µ) =   1 - 2

cos() =

b1 = a 1  1 + a 2  2 

Using the results from [8] in dimension one and two, we use G(log (D1 ), T ; µ1 ) and G(log (D1 ), log (D2 ), T ; µ1 , µ2 ) to evaluate the joint probability of non-default. As previously mentioned in Section 2.2, we can relate the 22

-log (D1 ) 1 r   µ = µ + 2  b 2 = a 2  2 1 - 2

CHAPTER 2. TYPES OF DEFAULT

2.3. DEFAULTS AS PER BLACK AND COX

joint probability of non-default with the time of default, i for Company i. Therefore from the results above, we define random variables 1 and 2 for i = 1, 2 as well as the probabilities of non-default in dimension one and two as: P (1 > T ) = P (X1 (t) > log (D1 ))  + = g (x1 , log (D1 ), T ; µ1 )dx1
log (D1 )

= G(log (D1 ), T ; µ1 ) P (1 > T, 2 > T ) = P (X1 (t) > log (D1 ), X2 (t) > log (D2 ))  +  + = g (x1 , x2 , log (D1 ), log (D2 ), T ; µ1 , µ2 )dx1 dx2
log (D2 ) log (D1 )

= G(log (D1 ), log (D2 ), T ; µ1 , µ2 ) for log (Di ) < 0. This result allows us to analytically evaluate the joint probability of non-default using the Fokker-Planck equation; equation (2.2) and equation (2.3) in a Black-Cox setting in one and two dimensions. In one dimension, the analytical solution to equation (2.2) requires integrating the density dependence, dx1 from the the probability density and distribution function, g to define the probability of non-default G(log (D1 ), T ; µ1 ). In two dimensions we integrate 2 density dependencies, dx1 and dx2 from the probability density and distribution function, g to obtain the joint probability of non-default G(log (D1 ), log (D2 ), T ; µ1 , µ2 ). We are able to define G explicitly in dimensions one and two (see[8]), allowing us to analytically evaluate the joint probability of non-default. Analytical solutions are also defined in three dimensions for the specific correlation values, (see[15]). As a result, for higher dimensional settings such as three and four, we must rely on a simulated approach to approximate the joint probability distribution.

2.3.2

Simulation Results

In a Black-Cox setting, we rely on Monte Carlo simulations to approximate the joint probability distribution in two, three and four dimensions since analytical solutions are not well known. Our Monte Carlo simulations rely on a variety of parameters such as the number of paths, debt, volatility, correlation and mean, however we will focus on the parameters of paths and debt in our analysis of default. As discussed previously in Section 2.1.2, the number of paths affected the accuracy of our results in a Merton setting, in this section we study the effect in a Black-Cox setting. We also evaluate the joint probability distribution using a debt of $90 as well as $60 to evaluate the precision of the number of paths used in our simulation of default. Our methodology is based on simulating the joint probability distribution in two dimensions and then graphically displaying the convergence as the number of paths increase using both a debt of $90 and

23

CHAPTER 2. TYPES OF DEFAULT

2.3. DEFAULTS AS PER BLACK AND COX

$60. Firstly, the parameters used are the same as defined in Section 2.1.2 with a debt of $90: Si = 100 i = 0.2 µi = 0.04 ij = 0.3 for i = 1, 2, j = 1, 2 in two dimensions.
0.26 0.34 0.259 0.339 0.209

0.258

0.338

0.208

0.257 Probability of Default Probability Default

0.337

0.207 Probability Default 4 4.5 5 5.5 paths 10x 6 6.5 7 7.5

0.256

0.336

0.206

0.255

0.335

0.205

0.254

0.334

0.204

0.253

0.333

0.203

0.252

0.332

0.202

0.251

0.331

0.201

0.25 3.5

4

4.5

5

5.5 paths 10x

6

6.5

7

7.5

0.33 3.5

0.2 3.5

4

4.5

5

5.5 paths 10x

6

6.5

7

7.5

(a) non-default
0.209

(b) all companies defaulting

(c) Only Company 1 defaulting

0.208

0.207 Probability Default

0.206

0.205

0.204

0.203

0.202

0.201

0.2 3.5

4

4.5

5

5.5 x paths 10

6

6.5

7

7.5

(d) Only Company 2 defaulting

Figure 2.1: Convergence of the joint probability distribution using a debt of $90 From Figure (2.1), there is a large variation of the joint probability distribution simulated using 103.5 to 105.5  paths. For 105.5  paths there is less variation, however there are discrepancies seen in Figure (2.1d) and Figure (2.1b) between the simulated values using 105.5  and a higher number of paths. As a result of the variation seen in Figure (2.1d) and Figure (2.1b) using 105.5  paths, we examine the use of 107 paths to

accurately simulated the joint probability distribution. We use the measure of absolute difference between our simulated joint probabilities using 107 and 107.5  paths to evaluate the precision of our results, this is defined as:   p107.5  - p107 

In Figure (2.1a) the absolute difference between the simulated joint probability of non-default and only Company 2 defaulting using 107 and 107.5  paths is 0.0001. The absolute difference of the joint probability of both companies defaulting as well as only Company 1 defaulting is 0. This implies a very minimal differ24

CHAPTER 2. TYPES OF DEFAULT

2.3. DEFAULTS AS PER BLACK AND COX

results and the absolute difference, 107 paths provides a reasonable convergence of the probability distribution of defaults for this given parametric set. Since there are several factors that may affect the accuracy of our simulation results, we analyze the

ence between the simulated joint probability distribution using 107 and 107.5  paths. Using our graphically

convergence of our probability distribution with a redefined debt parameter of Di =60. In the following figures, we simulate the convergence of the joint probability distribution using a debt of $60 as the the number of paths increases.
4.3 x 10
-3

x 10 3.9

-3

0.9898

3.85

4.2
0.9896

3.8 3.75 Probability of Default

0.9894

4.1
Probability of Default 0.9892

Probability of Default

3.7 3.65

0.989

4

0.9888

3.6

0.9886

3.9
3.55 3.5

0.9884

3.8
0.9882

3.45

0.988

4

4.5

5

5.5

6 x paths 10

6.5

7

7.5

3.7

3.4

4

4.5

5

5.5

6 x paths 10

6.5

7

7.5

4

4.5

5

5.5

6 x paths 10

6.5

7

7.5

(a) non-default
4

(b) all companies defaulting
x 10
-3

(c) Only Company 1 defaulting

3.9

3.8 Probability of Default

3.7

3.6

3.5

3.4

3.3

4

4.5

5

5.5

6 x paths 10

6.5

7

7.5

(d) Only Company 2 defaulting

Figure 2.2: Convergence of the joint probability distribution using a debt of $60 From the results of our convergence analysis with Di = 60, we also conclude that 107 paths provides an accurate approximation. In Figure (2.2a), the use of 106.5  paths produces a large variation of the simu-

lated joint probability of non-default. However, the absolute difference of our simulated joint probability of non-default using 107 and 107.5  paths is minimal, 8.925e-5. Similarly as in Figure (2.2a), in Figure (2.2b) there is a large variation with 106.5  paths. The absolute difference between the simulated joint probability of all companies defaulting using 107 and 107.5  paths is 9.578e-7. In Figure (2.2c), the absolute difference of the joint probability of only Company 1 defaulting between 107 and 107.5  paths is 3.583e-5 and the absolute difference of only Company 2 defaulting is 0.438e-5. Thus, the absolute difference between 107

and 107.5  paths is minimal with a debt of $60, implying 107 paths will provide a precise approximation. Therefore, graphically as well as using the absolute difference, we conclude that 107 paths provides a precise approximation using both a value of debt $90 and $60. 25

CHAPTER 2. TYPES OF DEFAULT

2.3. DEFAULTS AS PER BLACK AND COX

Outlined below are the joint simulated probability distributions with Di =90, for various dimension sizes in a Black-Cox setting. Similarly to a Merton setting, we focus on dimensions two, three and four. We will use the simulated joint probability distributions using 107.5  paths to analyze the error of our distribution using 104 and 107 paths. In the following table, the joint probability distribution in a Black-Cox setting using a debt of $90 is described as:
1 Default MC Company 1 paths 104 107 2 107.5  104 107 107.5  0.2025 0.2041 0.2044 0.2040 0.2045 0.2044 Company 1, 2 104 107 107.5  2 Defaults MC paths 0.3397 0.3375 0.3364 Company 104 107 107.5  No Default MC paths 0.2533 0.2544 0.2548

Table 2.6: The probability distribution of defaults in a two dimensional Black-Cox setting From Table 2.6, there is a high joint probability of both companies defaulting, approximately 0.3397 using 104 paths, 0.3375 with 107 paths and 0.2548 using 107.5  paths. From our simulated results, there is a low joint probability of 1 default, varying from 0.2025 to 0.2040 using 104 paths, approximately 0.2040 using 107 paths and 0.2044 using 107.5  paths. Additionally, the probability of non-default is approximately

0.2533 using 104 paths, 0.2544 using 107 paths and 0.3364 using 107.5  paths. Also from our Monte Carlo simulation, the simulated distribution using 104 paths does not vary significantly from the results obtained with 107 paths. The absolute difference between the joint probability distributions using 104 and 107 paths is low, between 0.0005 and 0.0022. Using our simulated Monte Carlo joint probability distribution with 104 and 107 paths, we evaluate the error using 107.5  paths. We define the error of our simulated joint probability distribution as:   p ~ - p107.5     p107.5   (2.4)

where p ~ represents the joint probability distribution using 104 or 107 paths. Using equation (2.4), the error of our simulated distribution in two dimensions is:
1 Default Company 1 2 paths 104 10
7

2 Defaults Company 0.9295% 0.1467% 0.1956% 0.0489% 1, 2 paths 104 10
7

No Default Company 0.9809% 0.3269% paths 104 107 0.5886% 0.1569%

104 107

Table 2.7: Error of the joint probability distribution in two dimensional Black-Cox setting 26

CHAPTER 2. TYPES OF DEFAULT

2.3. DEFAULTS AS PER BLACK AND COX

We will focus on the error of 1 default in dimensions two, three and four, allowing us to compare the accuracy of 104 and 107 paths in several dimensions. In two dimensions, the error of only Company 1 defaulting is 0.9295% using 104 paths and 0.14677% using 107 paths. The error of only Company 2 defaulting is 0.0489% using 104 paths and 0.1956% using 107 paths. Similarly to the symmetry of the joint probability of 1 default in a Merton setting, it is expected that the error of only Company 1 defaulting and only Company 2 defaulting should be similar due to the symmetries of our parameters. From our results, there is a slight difference between the errors of 1 default using a 107 paths. This may be a result of the relatively low number of paths used in our simulation; 107 . For each joint probability of default, the error using 104 and 107 is both low and less than 1%, however, the error decreases significantly with an increase in the number of paths. Therefore in two dimensions, we conclude that our Monte Carlo simulation using with 107 paths will provide a reasonable approximation for a debt of $90. Additionally, the running time of our simulated approach in a Black-Cox setting was 0.818492 sec using 104 paths and 443.400 sec using 107 paths. Similarly to our analysis of default in a Merton setting, we extend our results in a Black-Cox setting to higher dimensions. In the upcoming results in dimensions three and four, we focus on the joint probability distribution in a Black-Cox setting with a debt of $90 using 104 , 107 and 107.5  paths:
1 Default MC Company 1 paths 104 107 2 107.5  104 107 3 107.5  104 107 107.5  0.0968 0.0961 0.0964 0.0968 0.0963 0.0962 0.0960 0.0963 0.0965 2, 3 1, 3 Company 1, 2 104 107 107.5  104 107 107.5  104 107 107.5  2 Defaults MC paths 0.1089 0.1082 0.1080 0.1087 0.1085 0.1081 0.1104 0.1080 0.1080 Company 1, 2, 3 104 107 107.5  3 Defaults MC paths 0.2233 0.2285 0.2284 Company 104 107 107.5  No Default MC paths 0.1596 0.1579 0.1584

Table 2.8: The probability distribution of defaults in a three dimensional Black-Cox setting From our three dimensional results in Table 2.8, there is a higher probability of 3 defaults, 0.2233 using 10 paths, 0.2285 using 107 paths and 0.2284 using 107.5  paths. Using 104 paths, the probability of non4

default is 0.1596, 1 default approximately 0.096 and 2 defaults varies between 0.1087 and 0.1104. Using 107

paths, the probability of non-default is 0.1579, 1 default is approximately 0.0061 and 2 defaults is approximately 0.1080. Additionally using 107.5  paths, the joint probability of non-default is 0.1584, 1 default

is approximately 0.0964 and 2 defaults is approximately 0.1080. Therefore, there is a low probability of 1

and 2 defaults using 104 , 107 and 107.5  paths. Similarly to our analysis in two dimensions, the absolute difference between the simulated probability distribution using 104 and 107 paths is low, between 0.0002 and 0.0052. Displayed in the following table is the error of our simulated probability distribution in three dimensions using equation (2.4): 27

CHAPTER 2. TYPES OF DEFAULT
1 Default Company 1 2 3 paths 104 107 104 107 10
4

2.3. DEFAULTS AS PER BLACK AND COX
3 Defaults Company 0.7400% 0.0925% 0.6481% 0.4269% 2.222% 0% 1, 2, 3 paths 104 107 2.190% 0.0876% No Default Company paths 104 107 0.8212% 0.2526%

2 Defaults Company 0.4149% 0.3112% 0.4149% 0.1037% 0.4149% 0.1037% 2, 3 1, 3 1, 2 paths 104 107 104 107 104 107

107

Table 2.9: Error of the joint probability distribution in a three Dimensional Black-Cox setting From Table 2.9, the error is less than 1% for the joint probability of one default using 104 and 107 paths. The error of only Company 1 defaulting is 0.4149% using 104 paths and 0.3112% using 107 paths. Additionally, the error of only Company 2 defaulting is 0.4149% using 104 paths and 0.1037% using 107 paths. Using 104 paths, the error of only Company 3 defaulting is 0.4149% and 0.1037% using 107 paths. Thus, the error of 1 default is minimal using both 104 and 107 paths. However, Company 2 and 3 defaulting and 3 defaults have a significantly higher error of approximately 2% using 104 paths. Therefore to decrease the error of our simulation, we increase the number of paths since with the use of 107 paths, the error is less than 1%. Additionally, the running time of our simulated approach in a Black-Cox setting was 1.078281 sec using 104 paths and 690.3685 sec using 107 paths. Extending our simulated joint probability distribution to a four dimensional setting, we continue to evaluate the probability of default using Di =90 in Appendix B.1. Similarly to our results in two and three dimensions, Appendix B.1 displays a higher probability of all 4 companies defaulting; 0.1662 using 104 paths, 0.1647 using 107 paths and 0.1645 using 107.5  paths. Using 104 paths, the probability of 1 default varies

between 0.0497 and 0.0517, 2 defaults between 0.0418 and 0.0482, 3 defaults between 0.0615 and 0.0600 and non-default is 0.1607. Additionally, the probability of 1 default is approximately 0.0520, 2 defaults 0.0441, 3 defaults 0.0637 and non-default 0.1603 using 107 paths. The probability of 1 default is approximately 0.0522, 2 defaults approximately 0.0443, 3 defaults is approximately 0.0637 and non-default 0.1603 using 107.5  paths. Therefore there is also a low probability of 1, 2 and 3 defaults using 104 , 107 and 107.5  paths. As previously mentioned in dimensions two and three, we compare the absolute difference of the joint probability distribution using 104 and 107 paths. From our four dimensional results, the absolute difference of our simulated joint probability distributions using 104 and 107 paths is low, between 0.0003 and 0.0039. Similarly to our analysis of dimensions two and three, we continue to compare the error of our simulated approach using 104 and 107 paths in four dimensions in Appendix B.2. In Appendix B.2, the error of 1 default is high using 104 paths. The error of only Company 1 defaulting is 4.7892% using 104 paths and

0.3831% using 107 paths. The error of only Company 2 defaulting is 0.9578% using 104 paths and 0.1915% using 107 paths. Additionally, the error of only Company 3 defaulting is 4.222% using 104 paths and 0% using 107 paths. Also, the error of only Company 4 defaulting is 0.7677% using 104 paths and 0.1919% using 107 paths. From the error of 1 default, 104 paths will not provide a precise approximation of the joint probability distribution since there are several joint probabilities that display an error that are high. 28

CHAPTER 2. TYPES OF DEFAULT

2.3. DEFAULTS AS PER BLACK AND COX

Some examples include the error of Company 1 and 2 defaulting, Company 1 and 3 defaulting, Company 2 and 3 defaulting, Company 3 and 4 defaulting using 104 paths. In comparison, the use of 107 paths decreases error in our joint probability distribution to less than 1%, implying 107 paths provides a more accurate approximation. Additionally, there is an increased error in our four dimensional setting compared to the error observed in two and three dimensions. Therefore, to extend our analysis of the joint probability distribution of defaults to higher dimensions, an increase in the number of paths may need to be used to achieve an accurate approximation with a reasonable level of error. The running time of our simulated approach in a four dimensional Black-Cox setting was 1.540 sec using 104 paths and 905.11 sec using 107 paths.

29

Chapter 3

Discretization Methods
In Section 2.2.1, we introduced an analytical solution to the Fokker-Planck equation in dimensions one and two as well as in three dimensions for the values of correlation:      (-cos( 3 ), -cos( 3 ), 0)    (-cos(  ), -cos(  ), 0) 4 3 12 , 13 , 23 = (3.1)     ( - cos ( ) , - cos ( ) , 0)  5 3    (-cos(  ), 0, 0)
N

for N  2, (see[15]). The analytical method used in [15] and [8] defined the probability density and distribution function to obtain the joint probability of non-default in a Black-Cox setting. In n dimensions however, we are unable to extend this approach as solutions are not explicitly defined. As a result, in Section 2.2.2 we

relied on a simulated Monte Carlo approach to approximate the joint probability distribution. Alternatively, we can approach the solution to the Fokker-Planck equation using discretization methods, allowing us to evaluate numerical solutions in n dimensions. In this section, we introduce 2 discretiztion methods, the Finite Difference and Finite Element Method. Using Finite Difference and Finite Element Methods, we are able to evaluate the joint probability distribution in a Black-Cox setting as a solution to the Fokker-Planck equation in n dimensions. We introduce a version of the Fokker-Planck equation; the heat equation in one and two dimensions to demonstrate both the Finite Difference and Finite Element Methods. We use the heat equation since it can be obtained from the Fokker-Planck equation with a transformation of the boundary. In one dimension, the Finite Difference Method uses a computational grid to evaluate a PDE with finite difference schemes for space and time. We will also define commonly used finite difference schemes; FTCS (Forward in Time, Centered in Space), BTCS (Backward in Time, Centered in Space) and CN (Crank-Nicolson). A similar method is used to discretize the heat equation in two dimensions. The Finite Element Method partitions the domain of the boundary condition into elements, allowing us to discretize complexly shaped boundaries. The Finite Element Method

30

CHAPTER 3. DISCRETIZATION METHODS

3.1. FINITE DIFFERENCE METHODS

focuses on solving a PDE in its integral form using test functions, v (x) in one dimension and v (x, y ) in two dimensions. Using this method, we are able to rewrite the weak form of a PDE as a basis of a finite element space, Vh . This produces a system of ODE's that can be numerically solved. In this section, we also discuss 2 computational tools that are capable of evaluating PDE's using the Finite Element Method; Getfem++ and FreeFem++. We describe the advantages of each tool as well as interfaces that are available. Both computational tools provide a solution to equation (2.2) and equation (2.3) numerically in at least dimensions two and three.

3.1

Finite Difference Methods

One of the methods we can use to numerically evaluate the solution to the heat equation and FokkerPlanck equation in one dimension is the Finite Difference Method. The Finite Difference Method approximates a differential quotient by reducing it to an algebraic system. In one dimension, this process evaluates a differential equation at an interior grid point, replacing the derivatives with a finite difference approximation. In one dimension, we define x to be the spatial dimension and t, the temporal dimension. To demonstrate a general Finite Difference Method solution in one dimension, we introduce a general parabolic equation which can be discretized using several methods: u 2u = 2 t  x u(a, t) = ua (t) u(b, t) = ub (t) u(x, 0) = f (x) where ua (t), ub (t) define the boundary at a and b respectively and the continuous function f (x) represents the initial condition of our PDE. With the Finite Difference Method, our first step is to introduce a partition over the interval [a,b]. This partition is denoted by: a = x 0 < x1 < · · · < xN - 1 < xN = b where the points x0 and xN are defined from the boundary grid points and x1 , x2 , . . . , xN -1 , the interior grid
-a points. To create a computational grid, we define Nx and Nt to be positive integers, such that hx = bN and x T ht = Nt . Additionally, we define the spatial coordinate xj =jhx for j=0, 1 . . . , Nx and time coordinate tm = mht for m=0, 1, . . . , Nt . Thus for each grid point, (xj , tm ), we approximate the solution, um j with commonly

axb

t>0

the first order difference approximations are:

used finite difference schemes. Suppose u is a differentiable real valued function on R and xj  R, hx >0,

31

CHAPTER 3. DISCRETIZATION METHODS forward difference: u (xj , tm )  backward difference: u (xj , tm )  centered difference: u (xj , tm ) 

3.1. FINITE DIFFERENCE METHODS

u(xj + hx , tm ) - u(xj , tm ) hx

u(xj , tm ) - u(xj - hx , tm ) hx

u(xj + hx , tm ) - u(xj - hx , tm ) 2hx

Additionally, several finite approximation schemes can be used: · FTCS (Forward in Time, Centered in Space): obtained by discretizing the differential equation at x=xj and t=tm as well as replacing the time derivative with a forward difference and the second spatial derivative with a second order centered difference. · BTCS (Backward in Time, Forward in Space): obtained by replacing the time derivative with a backward difference and the spatial derivative with a second order centered difference. · CN (Crank-Nicolson): this method considers an approximation at x=xj and t=tm-1/2 . This scheme approximates the time derivative by a centered difference: ut (xj , tm-1/2 )  u(xj , tm ) - u(xj , tm-1 ) ht

and the second spatial derivative by the second order centered difference: uxx (xj , tm-1/2 )  u(xj +1 , tm-1/2 ) + 2u(xj , tm-1/2 ) + u(xj -1 , tm-1/2 ) h2 t

as well as the half time values by averages: u(xj , tm-1/2 )  u(xj , tm ) + u(xj , tm-1 ) 2

(see[2]). This discretization method can be used to evaluate the Fokker-Planck equation or heat equation in n dimensions, allowing us to obtain the joint probability distribution in a Black-Cox setting numerically. In the following example, we use the FTCS scheme to evaluate the heat equation in 1 and 2 dimensions.

3.1.1

One Spatial Dimension Heat Parabolic

As previously mentioned, we will utilize the heat equation in one dimension to demonstrate the Finite Difference Method since it has a similar structure to the Fokker-Planck equation. Note that the heat equation 32

CHAPTER 3. DISCRETIZATION METHODS

3.1. FINITE DIFFERENCE METHODS

can be obtained from the Fokker-Planck equation with a transformation of the boundary presented in Section 2.2.1. This method presents another approach to numerically evaluating the joint probability distribution in a Black-Cox setting without utilizing Monte Carlo simulations or the probability density and distribution function. Described below is a one dimensional heat equation with arbitrary boundary and initial conditions: u 2u =D 2 t  x u(A, t) = uA (t) u(B, t) = uB (t) u(x, 0) = f (x) where D > 0 and constant, A and B are obtained from truncating the domain of x and the initial condition, f(x) is assumed to be continuous. The discontinuous initial condition presented in Section 2.2.1, the delta function  (x), may be substituted however we will obtain the weak form of the solution to our PDE. A weak solution implies that the solution, u may not be differentiable on the entire domain but on a small subset of x. This allows us to define the solution u using weak derivatives that satisfy our PDE. Using the Finite Difference Method, we first discretize the space variable, x then the time variable, t. Therefore, - A) let hx = (B and xj =A + jhx for j=0, 1, 2, . . . , Nx where Nx is a positive integer. To evaluate our partial Nx differential equation at an arbitrary interior grid point, xj , we replace the derivative on the right hand side of the equation with the second order central difference approximation. Using the boundary condition, we also define v0 (t)=uA (t) and vN (t)=uB (t) as well as vj (0)=f (xj ) from the initial condition. In matrix form, this information is represented as:  v ( t ) = v 1 ( t)  f = f ( x1 ) v 2 ( t) f ( x2 ) v 3 ( t) f ( x3 ) 0 ... -1 2 .. . ... ... v N - 1 ( t) f ( xN -1 ) T T AxB t>0

 b ( t) = - u A ( t )  -1   A=      2

T

0 - u B ( t)  .. .. . . 2         

-1 .. . .. .

-1

Note that with the use of a discontinuous initial condition such as  (x), we can substitute the point discontinuity in f with the upper limit of  (x). Using the matrix form of our initial and boundary conditions, our

33

CHAPTER 3. DISCRETIZATION METHODS PDE reduces to:

3.1. FINITE DIFFERENCE METHODS

dv ( t ) D =- [Av (t) + b(t)] dt ( hx ) 2 v (0) = f To complete the temporal discretization, we divide the time axis into uniform steps of length ht . Using tm =mht for m=0, 1, 2 . . . , Nt where Nt is a positive integer, we are able to approximate the solution at
m  vj (tm )  u(xj , tm ) to denote the fully discrete approximadiscrete time levels. We will use the notation wj tion where the subscript on w indicates the spatial location along the grid and the superscript, the time level.

Using the Forward in Time, Centered in Space (FTCS) approximation at the m th time level t=tm , we replace the time derivative with the first order forward difference approximation. This reduces our one dimensional heat equation to: D w(m+1) - w(m) =- [Aw(m) + b(m) ] ht ( hx ) 2 and w(0) = f where  (m ) w (m ) = w 1 w2
(m )

w3

(m )

...

w N -1

(m )

and b(m) = b(tm ).

T

Solving this equation for w(m+1) yields: w(m+1) = (I - A)w(m) - b(m)
m where  = (Dt hx )2 , (see[4]). Therefore by using the FTCS method in one dimension, we reduce the heat equation to an algebraic system that can be solved at the time level tm+1 . By altering the boundary

conditions and initial condition of our one dimensional heat equation, we can use a similar method to numerically evaluate the joint probability distribution in a Black-Cox setting.

3.1.2

Two Spatial Dimensions Heat Parabolic

We extend our analysis of the Finite Difference Method in one dimension to two spatial dimensions using a two dimensional heat equation. Similarly to our analysis in one dimension, we also approximate the solution to our two dimensional heat equation using the FTCS difference scheme. In two dimensions, the heat equation is described as: u 2u 2u = D( 2 + 2 ) t x y

34

CHAPTER 3. DISCRETIZATION METHODS

3.1. FINITE DIFFERENCE METHODS

subject to Dirichlet boundary conditions and initial condition:

with D > 0 and constant, t > 0 and restricted on a rectangular domain R = {(x, y )|a  x  b, c  y  d}

u(a, y, t) = u(b, y, t) = 0 u(x, c, t) = u(x, d, t) = 0 u(x, y, 0) = f (x, y ) The values a,b,c and d can be obtained from truncating the domain of x at a and b and y at c and d. Similarly to the initial condition in one dimension, we can substitute the continuous function f(x,y) with  (x) (y ) as defined in Section 2.2.1, however the solution of our PDE will be presented in its weak form. Similarly to our one dimensional initial condition, we can substitute the point discontinuity of our initial condition,  (x) (y ) with the upper limit of the discontinuity. To discretize our computational domain, we denote Nx , the number of sub-intervals along the x axis and Ny , the number of sub-intervals along the y axis. Thus, using: hx = b-a Nx d-c hy = Ny

we define a computational grid with xj =a + jhx for j=1, . . . , Nx and yk =c + khy for k=1, . . . , Ny where Nx and Ny are positive integers. For simplicity, it is assumed that hx = hy =. We evaluate the heat equation at an arbitrary grid point (xj , yk ) using the second order central difference to approximate the space derivative. After dropping the truncation error terms, the semi-discrete approximation is: dvj,k (t) vj -1,k (t) - 2vj,k (t) + vj +1,k (t) vj,k-1 (t) - 2vj,k (t) + vj,k+1 (t) = D( + ) dt 2 2 (3.2)

where vj,k (t)  u(xj , yk , t). Using the FTCS method, we evaluate the semidiscrete template at the time level t=tm by replacing the time derivative with the first order forward difference approximation. After solving the fully discrete equation at the time level t=tm+1 , we define: wj,k
(m ) (m+1)

= (wj -1,k + wj +1,k + wj,k-1 + wj,k+1 ) + (1 - 4)wj,k

(m )

(m )

(m )

(m)

(m )

(3.3)

ht where wj,k  vj,k (tm )  u(xj , yk , tm ) and  = D  2.

Similarly to the Finite Difference Method in one dimension, the two dimensional Finite Difference Method reduces the heat equation to an algebraic system. A similar method can be used to evaluate the FokkerPlanck equation in higher dimensions and evaluate the joint probability distribution in a Black-Cox setting. Alternatively by adjusting the initial and boundary conditions of the heat equation presented in this section, we can also numerically evaluate the joint probability distribution in a Black-Cox setting. The use of the Finite Difference Method allows us to extend our analysis of the joint probability distribution to n dimensions

35

CHAPTER 3. DISCRETIZATION METHODS using the Fokker-Planck equation or the heat equation.

3.2. FINITE ELEMENT METHOD

3.2

Finite Element Method

In addition to the Finite Difference Method, we introduce the Finite Element Method to numerically evaluate the joint probability distribution in a Black-Cox setting in n dimensions. This method solves partial differential equations in its integral form, therefore it does not approximate the solution to the original PDE but to its weak form. The weak form is used so that discontinuous solutions can be approximated, allowing us to utilize discontinuous initial and boundary conditions. This method also defines a piece-wise linear function, uh to approximate the solution to a PDE with a basis of test functions, i . In one spatial dimension, the test function is defined as v (x) and v (x, y ) in two spatial dimensions. The test function v , represents any function that is sufficiently well behaved for the integral to exist. The main advantage of the Finite Element Method is its ability to discretize the boundary of a given PDE into elements. From the geometry of the domain, a mesh can be generated from smaller sub-domains, allowing us to approximate the computational domain , as a union of simple geometries (triangular and quadrilateral shapes). This is a useful geometric property of the Finite Element Method as it allows us to discretize complexly shaped boundaries. As mentioned in Section 3.1, the heat equation can be obtained from the Fokker-Planck equation with a transformation of the boundary condition, thus resulting in a complexly shaped boundary. The dimension of the domain dictates the shape of the discretization as: · one dimensional domains (straight or curved lines) are subdivided into smaller line segments · two dimensional domains (planes or surfaces) into triangular or quadrilateral shapes · three dimensional domains (volumes) into tetrahedral and hexahedron shapes If the domain has a simple geometry or there are a small the number of elements, the mesh generation can be done manually. For more complex geometries or a larger number of elements, an automatic mesh generation scheme may be more beneficial. Different methods of discretizing the domain into elements will affect the computational time required. Similarly to our previous analysis of the Finite Difference Method, we will use the heat equation in one and two dimensions to demonstrate the Finite Element Method.

3.2.1

One Spatial Dimension Heat Parabolic

Similarly to our introduction of the Finite Difference Method, we will introduce an initial boundary value problem for the heat equation in one dimension to demonstrate the Finite Element Method. As mentioned previously, solutions to the Fokker-Planck equation using the initial and boundary conditions as described in Section 2.2.1, allow us to numerically evaluate the joint probability distribution in a Black-Cox setting.

36

CHAPTER 3. DISCRETIZATION METHODS The heat equation in one dimension is described as: 2u u (x, t) = D 2 (x, t) t x u(x, t) = 0 u(x, 0) = u0 (x) x x   x

3.2. FINITE ELEMENT METHOD

0tT 0tT

where D > 0 and constant and the initial condition u0 (x) is a continuous function. The continuous initial condition u0 (x) can be substituted with a discontinuous function  (x), however we will obtain a local solution to our PDE. With a discontinuous Finite Element Method, we approximate the solution, u element-wise. We use the Finite Element Method to derive a weak formulation of the heat equation by multiplying a test function v (x) and integrating over the domain, . This gives:  the weak form as: u (x, t)v (x)dx = t  D(




v u ) · ( )dx x x 
 v D( u x ) · ( x )dx and we can rewrite

Using ·, · to denote the inner product in L2 () such that au, v  = u , v  = au, v  t



0tT

A function uh maps the semidiscrete approximation from [0, T ] onto Vh where Vh represents the space of finite elements with respect to the triangulation of . Therefore, we define uh such that:  uh , v  = a  uh , v  t (3.4)

Using i with 1  i  M for M an integer, the basis for Vh is defined as: uh (x, t) =
M  j =1

 j ( t)  j ( x )

where j (t) is a set of unknown coefficients. Plugging this result into equation (3.4) and using the test function v = i , we obtain a system of ODE's: 
j    j , i   j ( t) =


j

a   j ,  i   j ( t)

This can be rewritten as: M  (t) = A(t) (3.5)

37

CHAPTER 3. DISCRETIZATION METHODS where   1 , 1      2 , 1  Mij = j , i  =  .  .  .   M , 1    a   2 , 1  Aij = aj , i  =  .  .  . a   M , 1   a   1 , 1     1 , 2    2 , 2  . . .   M , 2  a  1 , 2  ··· ··· . . . ··· ···

3.2. FINITE ELEMENT METHOD

 M , M 

and

  1 , M    2 , M    .  .  .  a  2 , M    .  .  . a  1 , M  

a  2 , 2  . . . a  M , 2 

··· . . . ···

a  M , M 

This describes a system of linear ODE's for the unknown coefficients =j (t). Additionally, the initial  0 0 0 condition uh (0)=u0 h can be written as (0)= where uh = j j j . There are various methods that can be used to obtain an explicit solution to this system, equation (3.5), such as utilizing the Finite Element Method to discretize space and the Finite Difference Method, Euler's method, backward Euler's method or Crank-Nicolson to discretize time, (see[1]).

3.2.2

Two Spatial Dimensions Heat Parabolic

Similarly to our previous examples of the Finite Difference Method, we will evaluate the heat equation in two dimensions using the Finite Element Method. In two dimensions, the heat equation is defined as:   2u u 2u (x, y, t) + 2 (x, y, t) (x, y, t) = D 2 t x y u(x, y, t) = 0 u(x, y, 0) = u0 (x, y, t) (x, y )   (x, y )    (x, y )   0tT 0tT

where D > 0 and constant and u0 (x, y, t) is a continuous function. Similarly to our one dimensional analysis, we can substitute u0 (x, y, t) with a discontinuous function  (x) (y ), however we will obtain a local solution to our PDE. Additionally, a discontinuous Finite Element Method requires element-wise solutions. By multiplying the heat equation by the test function v (x, y ), and integrating over the domain , the weak form is obtained:  u (x, y, t)v (x, y )dxdy = t  D(




u u v v , )· ( , )dxdy x y x y

The weak form can be simplified as:  where au, v  = 


u , v  = au, v  t

0tT

u v v D( u x , y )· ( x , y )dxdy . Given a finite element space Vh with i (x, y ) and i=1, 2, . . . , M

38

CHAPTER 3. DISCRETIZATION METHODS

3.3. COMPUTATIONAL TOOLS

for M a positive integer, we define a set of basis functions for Vh of the form: uh (x, y, t) = Substituting this into the weak form, produces: 
M  j =1  i (t)j (x, y ), v  = a M  j =1 M  j =1

j (t)j (x, y )

i (t)j (x, y ), v 

Using v (x, y ) = i (x, y ), we define a linear system of ordinary differential equations that can be expressed as: M  (t) = A(t) where Mij = j , i  and Aij = aj , i  (3.6)

Using the Finite Element Method, we are able to reduce the heat equation to a system of ODE's. Similarly to our one dimensional Finite Element Method results, there are several numerical methods that can be used to obtain explicit solutions to the system of ODE's, equation (3.6), such as a Forward Finite Difference approximation using an Explicit Euler method, Backward Finite Difference using an Implicit Euler method and a Crank-Nicolson method, (see[9]).

3.3

Computational Tools

Outlined in this subsection are 2 computational tools that are capable of numerically evaluating PDE's with arbitrary initial and boundary conditions using the Finite Element Method. In Section 3.1 and 3.2, we introduced 2 discretization methods to evaluate the heat equation in one and two dimensions, however there was significant computational effort required. Therefore in this subsection, we introduce tools that are capable of solving higher dimensional PDE's; specifically the Fokker-Planck equation or heat equation, with less computational effort. We will discuss the advantages of each program as well as the interfaces available. The computational tools that we focused on are Getfem++ and FreeFem++.

3.3.1

Getfem++

The Getfem++ toolbox is capable of building a generic finite element code where elements, integration methods and mesh dimensions are parameters that can be altered by the user. This is a useful aspect of Getfem++ since it allows the user to specify several parameters with little computational effort. To solve the Fokker-Planck equation in higher dimensions, a large number of elements and a more complex mesh

39

CHAPTER 3. DISCRETIZATION METHODS

3.3. COMPUTATIONAL TOOLS

to discretize the boundary may be required, thus the ability to specify these parameters will decrease the computational effort and time required. In our previous analysis, we focused on obtaining the heat equation from a transformation of the Fokker-Planck equation, resulting in a complexly shaped boundary. A large number of elements and a complex mesh is required in order to discretize the resulting domain, thus the ability to specify both the elements and the mesh is beneficial. The Getfem++ software is also capable of evaluating n dimensional PDE's. This allows us to numerically evaluate the joint probability distribution in a Black-Cox setting in higher dimensions, rather than relying on a simulated Monte Carlo approach as we did in Section 2.2.2. Another advantage of the Getfem++ program is its ability to build a numerical code to model the systems described by a partial differential equation and arbitrary boundary conditions. This allows us to solve the Fokker-Planck equation without a transformation to the heat equation. Additionally, this toolbox allows each element to be automatically updated after modifications are made to the mesh and is independent of the space dimension and integration methods used. The interface of Getfem++ is developed in C++, however it is also available in PythonTM and MATLAB® . In regards to this thesis, we are unable to utilize this computational tool because of time constraints associated with the interfaces available.

3.3.2

FreeFem++

Adapted in C++, FreeFem++ can generate solutions to non-linear systems in two and three dimensions. Similarly to Getfem++, the interface of FreeFem++ will limit our ability to utilize this tool because of time constraints. With FreeFem++, there is a limited computational dimension size, two or three, therefore it is less effective evaluating higher dimensional PDE's than the Getfem++ toolbox. As mentioned in Section 2.1.1, the analytical solution of the Fokker-Planck equation can be obtained explicitly from the probability density and distribution function in dimensions one and two, (see[8]). The probability density and distribution function is also defined in three dimensions for specific correlation values, (see[15]). Thus, there are methods available to evaluate the joint probability distribution in a Black-Cox setting in these dimensions. The main feature of this toolbox is its automated mesh generator that can adapt triangular elements as well as discontinuous elements. Similarly to Getfem++, the mesh and element generator allows us to evaluate the Fokker-Planck equation without transforming the boundary conditions as well as allowing us to discretize complexly shaped boundary conditions. Another characteristic of FreeFem++ is its ability to interpret a geometric input of the boundary by pieces, however when two boundaries intersect, the intersection points must be specified. Using the heat equation obtained from a transformed Fokker-Planck equation, the corresponding boundary is complexly shaped, therefore a descriptive tool to implement and describe the boundary condition is time effective. Additionally, FreeFem++ provides a variety of linear direct and iterative solvers as well as eigenvalue and eigenvector solvers. This allows us to obtain fully discretized approximations to the FokkerPlanck equation using several techniques. FreeFem++ also has the ability to utilize real or complex valued descriptions of the weak formulations of a PDE. Therefore there is a larger variety of PDE's that FreeFem++ is capable of evaluating in addition to the Fokker-Planck and heat equations.

40

Chapter 4

Analysis of Joint Probabilities
In this chapter, we expand on the results obtained in Section 2.1; a Merton setting and in Section 2.2; a Black-Cox setting, by performing a comparison in terms of various probabilistic measures. We are interested in numerically comparing our two structural definitions of default while also providing an overview of the probability distributions obtained in Chapter 2. This comparison will be presented via tables and figures recording percentage error per dimension. We also evaluate tail dependence in two and three dimensions in both a Merton and Black-Cox setting as well as 2 values of correlation, =0.3 and =0.9. The objective of this chapter is to compare the joint probability distributions and study dependence measures such as tail dependence in a Merton and Black-Cox setting. Our measure of tail dependence relies on conditional probabilities, allowing us to evaluate this measure in any dimension. We also describe our approximations of marginal probability and confidence intervals for tail dependence in a Merton and Black-Cox setting.

4.1

Merton vs Black-Cox Settings

Previously in Chapter 2, we evaluated the probability distribution in both a Merton and Black-Cox setting; in this chapter, we compare and further expand on the results we obtained. In particular we compare the joint probabilities of 1, 2, 3 and 4 defaults between our two structural models of interest using 107 paths. The differences will be presented in tables and figures recording error percentage-wise. In a Merton setting, we are able to analytically evaluate the joint probability distribution, however this is not the case in a Black-Cox setting. To make both methods comparable, we use a Monte Carlo simulation for both settings. We distinguish our error approximation in each setting with equation (2.1) in a Merton setting and equation (2.4) in a Black-Cox setting. In a Merton setting, we define our analytical solution as pAN and our simulated distribution as p ~107 . Using equation (2.4) in a Black-Cox setting, we use a similar ~107.5  approach to evaluate error where p ~107 represents our Monte Carlo distribution using 107 paths and p

41

CHAPTER 4. ANALYSIS OF JOINT PROBABILITIES is approximated using 107.5  paths. Two Dimensions

4.1. MERTON VS BLACK-COX SETTINGS

In dimensions two, three and four, we will compare the error obtained in our simulated distribution of 1 default in a Merton and Black-Cox setting. The following table describes the error obtained in a Merton and Black-Cox setting in two dimensions using equation (2.1) and equation (2.4) and 107 paths:
1 Default Company 1 2 Merton BC Merton BC 0.1246% 0.14677% 0.0623% 0.1956% Company 1, 2 Merton BC 0.0953% 0.32699% 2 Defaults Company Merton BC 0.00348% 0.1569 % No Default

Table 4.1: Comparison of error in a two dimensional setting In two dimensions, the error obtained in a Merton setting for only Company 1 defaulting was approximately 0.1246% and the error of only Company 2 defaulting using 107 paths is 0.00623% using 107 paths, implying a minimal value of error. Additionally, from Table (4.1) the error in our joint probability distribution using 107 paths is minimal and less than 1% in a Merton setting. In a similar Black-Cox setting, we rely on a simulated approach to approximate the error of our joint probability distribution using the values defaulting has an error of 0.14677% and 0.1956% for only Company 2 defaulting using 107 paths. Similarly obtained with 107 and 107.5  paths. The simulated distribution in a Black-Cox setting of only Company 1

to the error in a Merton setting, the error obtained using 107 paths is less than 1% in a Black-Cox setting. Additionally, there is a lower value of error in a Merton than in a Black-Cox setting however, the error in each setting is significantly low. We use a comparison of the joint probabilities obtained using a simulated approach in a Black-Cox and Merton setting to describe the impact of these structural models on the probability of default. We refer to Table 2.1 and Table 2.6 to compute the ratio of our joint probability distributions using 107 paths as: r= FBC FM (4.1)

where FBC represents the joint probability distribution in a Black-Cox setting and FM in a Merton setting. Using equation (4.1), we interpret the results as:

42

CHAPTER 4. ANALYSIS OF JOINT PROBABILITIES Ratio 1 Default Company 1 2 1.270 1.271 2 Defaults Company 1, 2 3.220

4.1. MERTON VS BLACK-COX SETTINGS

No Default Company 0.443

Table 4.2: Ratio comparison in a two dimensional setting In two dimensions there is a large difference between the joint probability of 2 defaults in a Black-Cox and Merton setting. From Table 2.6, the joint probability of 2 defaults was 0.3375 in a Black-Cox setting and 0.1048 in a Merton setting implying a large difference of approximately 322%. The joint probability of 1 default was approximately 0.2041 in a Black-Cox setting and approximately 0.1607 in a Merton setting with a difference of approximately 127%. Lastly, the joint probability of non-default was 0.2533 in a Black-Cox setting and 0.5739 in a Merton setting with a difference of 44%. We also model equation (4.1) using values of debt varying from $60 to $90. Each figure describes the relationship between the joint probabilities of default in a Merton and Black-Cox setting.

1 0.9 0.8 Ratio 0.7 0.6 0.5 0.4 90 85 85 90 90 75 85 80 70 75 70 65 65 60 60 Debt Company 1 Ratio 3.4 3.2 3 2.8 2.6 85 80 80 75 80 90

70

65

60

60

65

70

75

Debt Company 2

Debt Company 1

Debt Company 2

(a) no default

(b) all companies defaulting

2.2 2 2.2 Ratio 90 2 1.8 Ratio 1.6 1.4 1.2 1 0.8 90 70 75 80 85 1.8 1.6 1.4 1.2 1 0.8 90 85 80 75 70 65 Debt Company 1 Debt Company 2 60 60 65 70 75 80 85 90

85

80

75

70

60 65 60

65

Debt Company 2

Debt Company 1

(c) Only Company 1 defaulting

(d) Only Company 2 defaulting

Figure 4.1: Ratio comparison in a two dimensional setting for debt $60 to $90

43

CHAPTER 4. ANALYSIS OF JOINT PROBABILITIES

4.1. MERTON VS BLACK-COX SETTINGS

Using Figure (4.1), we visualize equation (4.1) using 2 values of debt defined as D1 and D2 . Our results simulate the joint probability distribution with a range of debt for D1 and D2 from $60 to $90. In Figure (4.1a), the ratio has a concave shape that is approximately 0.4 at D1 =90, D2 =90 and approximately 1 at D1 =60, D2 =60. As the values of debt both approach $60, the joint probability of non-default increases in both a Merton and Black-Cox setting, as expected. In a Black-Cox setting at a value of debt $90, the probability of non-default is low and as the value of debt decreases towards $60, the probability of non-default increases. In a Merton setting non-default is measured once at the time of maturity, T therefore there is an larger probability that Company 1 and 2 will not default in comparison to a Black-Cox setting. Thus, for the values of debt D1 and D2 , the ratio is less than 1 with a range of [0.4437, 0.9933]. The ratio in Figure (4.1b) displays a peak at the value of debt D1 =90, D2 =90, implying our ratio increases as both D1 and D2 and approach $90. As the values of debt increases to $90, the probability of both companies defaulting increases in both settings, however there is a large difference of approximately 322% between the joint probabilities in a Merton and Black-Cox setting. In a Black-Cox setting, default measured at every time t, implying a larger probability that Company 1 and 2 will default in a Black-Cox setting than in a Merton setting. Additionally, the ratio of the joint probability of default in a Merton and Black-Cox setting decreases as one value of debt approaches $90 and another approaches $60. We expect that as one value of debt decreases towards $60 from $90, the probability of both companies defaulting will decrease in both settings. For example, while the debt of Company 1 increases towards $90 and Company 2 approaches $60, the probability of both companies defaulting decreases in both a Black-Cox and Merton setting. There is a similar result as the debt of Company 2 increases towards $90 and Company 1 approaches $60 in a Merton and Black-Cox setting. The magnitude of the ratio has a range of [2.4583, 3.2204], which describes a large difference of the joint probability of default between these structural models. Figure (4.1c) describes the ratio of the joint probability of only Company 1 defaulting in a Merton and Black-Cox setting. The shape of the ratio is concave upwards with the lowest ratio occurring at the value of debt D1 =60 and D2 =90. As the debt of Company 2 increases towards $90 and Company 1 approaches $60, the probability of only Company 1 defaulting decreases. At the value of debt D1 =60 and D2 =90, the probability of only Company 1 defaulting is 0.0014 in a Black-Cox setting and approximately 0.0016 in a Merton setting, describing a difference of 87.5%. The largest ratio of 2.0350 occurs when D1 =90 and D2 =60 implying as the debt of Company 1 increases towards $90 and Company approaches $60, the probability of only Company 1 defaulting increases in both a Merton and Black-Cox setting with a large difference of approximately 200% between our structural models. The range of the ratio is between [0.8750, 2.0350] and at the value of debt D1 =70 and D2 =85 the ratio is approximately 1. The ratio of only Company 2 defaulting in Figure (4.1d) displays a similar shape as Figure (4.1c) however the smallest ratio occurs at D1 =90 and D2 =60. As the debt of Company 1 increases towards $90 and Company 2 approaches $60, the probability of only Company 2 defaulting decreases in a Merton and BlackCox setting. At the value of debt D1 =90 and D2 =60, the probability of only Company 2 defaulting is 0.0014 in a Black-Cox setting and 0.2629 in a Merton setting, describing a difference of 87.5%. Additionally, an increase in the debt of Company 2 towards $90 and Company 1 towards $60 results in an increase in the probability of Company 2 defaulting in a Merton and Black-Cox setting, with a difference of approximately 200%. The range of our ratio is [0.8750, 2.0334] where ratio is approximately 1 at the values of debt D1 =85 44

CHAPTER 4. ANALYSIS OF JOINT PROBABILITIES

4.1. MERTON VS BLACK-COX SETTINGS

and D2 =70, implying the joint probability of only Company 2 defaulting is similar in a Merton and Black-Cox setting. Three Dimensions Similarly to our analysis in two dimensions, we also analyze the error of our simulated approaches in three dimensions using 107 paths. In the following table, the error in a Merton and Black-Cox setting is presented percentage-wise using a debt of $90 and 107 paths:
1 Default Company 1 2 3 Merton BC Merton BC Merton BC 0.1867% 0.3112% 0% 0.1037% 0.0933% 0.1037% 2, 3 1, 3 Company 1, 2 Merton BC Merton BC Merton BC 0.18726% 0.0925% 0.1872% 0.6481% 0.18726% 0% 2 Defaults Company 1, 2, 3 Merton BC 0.1945% 0.0876% 3 Defaults Company Merton BC 0.1946% 0.2526% No Default

Table 4.3: Comparison of error in a three dimensional setting As previously mentioned, we will compare the error of the joint probability of 1 default in a Merton and Black-Cox setting. Firstly the error of only Company 1 defaulting in a Merton setting is 0.18674% and 0.3112% in a Black-Cox setting. Additionally, the error of only Company 2 defaulting was 0% in a Merton setting and 0.1037% in a Black-Cox setting. Furthermore, the error of only Company 3 defaulting is 0.0933% in a Merton setting and 0.1037% in a Black-Cox setting. From the errors of 1 default, the error is minimal and less than 1% in both settings. This is a result of using 107 paths, which provides a reasonably accurate approximation of the joint probability distribution in both a Merton and Black-Cox setting. In general, the error is smaller in a Merton setting than in a Black-Cox setting except for the error measuring the probability of Company 1 and 2 defaulting, Company 2 and 3 defaulting and 3 defaults. We expect the error to be greater in a Black-Cox setting than in a Merton setting since in a Black-Cox setting, default is measured at each time t. In a Merton setting however, default is only measured once at the time of maturity T, decreasing the likelihood of error. The probabilistic events where error is greater in a Merton setting than in a Black-Cox setting may be a result of the number of paths used in our simulations, since 107 paths is a relatively small number of paths that provides minimal error in each setting. A comparison of the joint probabilities in a Merton and Black-Cox setting obtained using 107 paths in three dimensions is displayed in Table 4.4. Similarly to our analysis in two dimensions, we compare the probability distributions obtained in Table 2.3 and Table 2.8 as a ratio; equation (4.1):

45

CHAPTER 4. ANALYSIS OF JOINT PROBABILITIES Ratio 1 Default Company 1 2 3 0.8989 0.8991 0.8924 2 Defaults Company 1, 2 1, 3 2, 3 2.0300 2.0317 2.0260

4.1. MERTON VS BLACK-COX SETTINGS

3 Defaults Company 1, 2, 3 4.4368

No Default Company 0.2751

Table 4.4: Ratio comparison in a three dimensional setting From Table 4.4 there is a large difference of the joint probability of 3 defaults and 2 defaults between our results in a Black-Cox and Merton setting. The joint probability of 3 defaults in a Black-Cox setting, seen in Table 2.8 was 0.2285 and 0.0515 in Table 2.3; a Merton setting, thus describing a difference of approximately 443%. The joint probability of 2 defaults also display a large difference of approximately 200%. In a BlackCox setting, the joint probability of 2 defaults was approximately 0.1080 and 0.0533 in a Merton setting. Additionally, the ratio of 2 defaults is similar for Company 1 and 2 defaulting, Company 1 and 3 defaulting and Company 2 and 3 defaulting. This is a result of the symmetry of the parameters used such as debt, volatility, correlation and mean in our simulation of the joint probability distribution. Also from Table 4.4 there is a moderate difference of the joint probability of 1 default between our simulation in a Merton and Black-Cox setting. The joint probability of 1 default measured in a Black-Cox setting was approximately 0.0961 and 0.1069 in a Merton setting, describing a difference of approximately 89%. Additionally, the ratio of 1 default is similar for only Company 1 defaulting, only Company 2 defaulting and only Company 3 defaulting, since the parameters used in a Merton and a Black-Cox setting are similar. Lastly, the joint probability of non-default measured in our Merton and Black-Cox setting displays a large difference. From Table 2.8 and Table 2.3 the joint probability of non-default is 0.1579 in a Black-Cox setting and 0.5739 in a Merton setting, implying a difference of 27.5%.

46

CHAPTER 4. ANALYSIS OF JOINT PROBABILITIES Four Dimensions

4.1. MERTON VS BLACK-COX SETTINGS

Lastly in Chapter 2, the probability distribution in a four dimensional setting was evaluated. In Appendix C.1, the error of our Merton and Black-Cox setting using a debt of $90 is displayed. The error in a Merton setting was 0.2624% for our simulation of the joint probability of only Company 1 defaulting and 0.38314% in a Black-Cox setting. The error of only Company 2 defaulting was 0.13106% in a Merton setting and 0.1915% in a Black-Cox setting. The error of the joint probability of only Company 3 defaulting was 0% in a Merton setting and in a Black-Cox setting. Additionally, the error of only Company 4 defaulting was 0% in a Merton setting and 0.1919% in a Black-Cox setting. As previously mentioned in Section 4.1.2, we expect the error in a Merton setting to be less than in a Black-Cox setting since default is only measured at the time of maturity T, decreasing the likelihood of error. Only the error of Company 1, 2 and 3 defaulting and Company 1, 3 and 4 defaulting display an error greater in a Merton setting than in a Black-Cox setting, however this is a result of the number of paths used in our simulation. 107 paths is a relatively small number of paths that provides a reasonably accurate approximation of the joint probability distribution in both a Merton and Black-Cox setting in four dimensions. Additionally, in four dimensions there are values of error that are larger than the errors obtained in two and three dimensions. The larger values of errors are a result of the dimension size as well as the number of paths used in our simulation. Even though the value of error is larger in four dimensions than in previous dimensions, the error remains minimal and less than 1%. However, we expect that as we increase dimension size, a larger number of paths will be required to achieve a precise simulation. In four dimensions, the ratio of our joint probability distributions in a Black-Cox and Merton setting can be compared using equation (4.1). We refer to Appendix A.1 and Appendix B.1 to compute equation (4.1) in a four dimensional setting. Similarly to the results of Table 4.4, there is a large difference of the joint probability of 4 defaults and 3 defaults in a Merton and Black-Cox setting. The joint probability of 4 defaults in a Merton setting was 0.0289 and 0.1647 in a Black-Cox setting, resulting in a difference of approximately 569%. The joint probability of 3 defaults was approximately 0.0638 in a Black-Cox setting and 0.0225 in a Merton setting with a difference of approximately 283%. From Appendix C.2, there is a difference of approximately 143% of the joint probability of 2 defaults. The joint probability of 2 defaults in a Merton setting was 0.0309 and approximately 0.0441 in a Black-Cox setting, describing a difference of approximately 143%. The joint probability of 1 default in a Merton setting was approximately 0.0762 and 0.0520 in a Black-Cox setting, implying a moderate difference of approximately 68%. Lastly, the joint probability of non-default in a Merton setting was 0.3996 and 0.1063 in a Black-Cox setting, describing a large difference of approximately 27%. Using Table 4.2, Table 4.4 and Appendix C.2, we compare the results of our ratio analysis for different dimensions. In all 3 tables the largest difference between the joint probabilities in a Merton and Black-Cox setting occurred in the joint probability of all companies defaulting. In two dimensions, the largest ratio occurred at 2 defaults, at 3 defaults in three dimensions, and 4 defaults in four dimensions, thus describing a large difference between the probability of all companies defaulting in a Merton and Black-Cox setting. 47

CHAPTER 4. ANALYSIS OF JOINT PROBABILITIES

4.1. MERTON VS BLACK-COX SETTINGS

From Chapter 2, the joint probability of all companies defaulting was larger in a Black-Cox setting than in a Merton setting in dimensions two, three and four, resulting in the large ratio seen in Table 4.2, Table 4.4 and Appendix C.2. Also as dimension size increases, the ratio of all companies defaulting may tend towards infinity since the probability of all companies defaulting in a Merton setting is low and the probability of all companies defaulting in a Black-Cox setting may be significantly larger. In dimensions two, three and four, the ratios measuring the probability of non-default have the smallest values. These ratios of non-default also describe a large difference between the joint probability of non-default in a Merton and Black-Cox setting, where the joint probability of non-default was significantly larger in a Merton setting than in a Black-Cox setting in dimensions two, three and four. As a result, the ratio computed with equation (4.1) is close to zero. This ratio may decrease as the dimension size increases since we expect that as dimension size increases, the probability of non-default in a Black-Cox setting will tend towards 0, while increasing in a Merton setting. We also compare the running time of our Monte Carlo simulation in dimensions two, three and four in a Merton and Black-Cox setting. Additionally for our comparison of running time, we use a simulated approach in both settings. The use of a simulated approach in a Merton setting allows us to compare the increase in running time as a result of the number of paths. In this comparison, we measure the running time of our simulated joint probability distribution using 107 paths. Dimension 2 3 4 Merton BC Merton BC Merton BC Time (sec) 314.1941 443.4000 525.9317 690.3685 691.1777 905.1156

Table 4.5: Comparison of running time in a Merton and Black-Cox setting From Table 4.5, there is an significant increase in running time as we increase dimension size and alter the structural setting. In a two dimensional Merton setting, there was a low running time of approximately 5.14 min using 107 paths. In a similar two dimensional Black-Cox setting, there was a running time of approximately 7.23 min using 107 paths. There is a similar result in dimensions three and four as well, where there is a larger running time in a Black-Cox setting than in a Merton setting. In three dimensions, the running time in a Merton setting was approximately 8.45 min and 11.3 min in a Black-Cox setting. In four dimensions, the running time in a Merton setting was approximately 11.3 min and 15.05 min in a Black-Cox setting. As previously mentioned in Chapter 2, the increased running time in a Black-Cox setting is a result of the structural model used. In a Merton setting, default is measured at the time of maturity, T whereas in a Black-Cox setting, default is measured at each time t in [0,T]. This significantly affects the running time. Lastly from Table 4.5, the running time of our simulations increases as the dimension size increases in both a Merton and Black-Cox setting. This is a result of the size of the simulated joint probability 48

CHAPTER 4. ANALYSIS OF JOINT PROBABILITIES

4.2. TAIL DEPENDENCE

distribution. As discussed in Chapter 2, our Monte Carlo approach will simulate 2n joint probabilities of default for n =2, 3 and 4. Therefore, the size of our simulated joint probability distribution increases as dimension size increases. In two dimensions, our simulated approach approximates 22 =4 joint probabilities, 23 =8 simulated joint probabilities in three dimensions and 24 =16 joint probabilities in four dimensions.

4.2

Tail Dependence

Next we use a well known measure called "tail dependence" to describe the dependence at the tail of the multivariate distribution functions associated to our two structural settings. We use the measure of tail dependence to describe the likelihood of default between several companies. We model tail dependence in both a Merton and Black-Cox setting with 2 values of correlation; =0.3 and =0.9. Additionally, we introduce marginal probabilities and confidence intervals to accurately describe the range of tail dependence for various values of debt.

4.2.1

Two Dimensions

We begin our analysis of tail dependence in a two dimensional setting, where we can define 2 random variables in our analysis, X1 and X2 . We expect that tail dependence will tend to zero as the values of debt approach infinity in a Merton setting since X1 and X2 are normal random variables. However, when we extend our tail dependence analysis to a two dimensional Black-Cox setting, we are unable to estimate the dependence between our random variables X1 and X2 . Therefore, our analysis of tail dependence will be computed via simulations. In an n dimensional setting, we define Xi for i = 1, . . . , n as: Merton : Black-Cox :
M Xi = Si ( T ) BC Xi = min Si (t) 0 t T

Our simulated tail dependence results are formulated from the following definition:
-1 -1 lim P (X1  F1 ( u ) | X 2  F2 (u)) u 0 F1 =F2

(4.2) (4.3)

=

x-

lim P (X1  x|X2  x)

where x = Fi-1 (u) for i = 1, 2 represents the inverse marginal distribution function for the distribution function F , (see[11]) allowing us to evaluate tail dependence as a conditional probability. This definition of tail dependence can be extended to higher dimensions with the assumption that X = (X1 , . . . , Xn ) is an n dimensional random vector with distribution function F: lim P (Xj  Fj-1 (u), j  / I |Xi  Fi-1 (u), i  I )
u 0 Fi =Fj

(4.4) (4.5)

=

x-

lim P (Xj  x, j  / I |Xi  x, i  I ) 49

CHAPTER 4. ANALYSIS OF JOINT PROBABILITIES

4.2. TAIL DEPENDENCE

equivalent to our simulation of tail dependence, equation (4.5), if µ1 = µ2 = . . . µn and 1 = 2 = . . . n . However, if either µi = µj or i = j then our simulated tail dependence using equation (4.5) will describe a "modified tail dependence".

for every I  {1, . . . , n}, I  / . It can be assumed that the tail dependence defined in equation (4.4) is

Our approach to simulating tail dependence uses a range of debt to approximate each conditional probability. For these simulated results, it is assumed that µ1 = µ2 = · · · = µn and 1 = 2 = · · · = n in each dimension n. We are also interested in the effect correlation has on the tail dependence in a Black-Cox and Merton setting, thus we introduce a  parameter to simulate 2 positive correlations; 0.3 and 0.9. Additionally, these correlation values simulate financial models that can be observed in the market. Graphically, the results of our multivariate tail dependence via simulations are compared using 107 paths, a range of debt $37 to $65 and with the parameters: Si = 100 i = 0.2 µi = 0.04 for i = 1 . . . n, j = 1 . . . n with n = 2. We plot the results of our tail dependence analysis in a Black-Cox simulation with a solid curve and a dashed curve in a Merton setting. The figure below displays the measure of tail dependence in a Merton and Black-Cox setting using 107 paths in two dimensions using =0.3 and =0.9.
0.09 0.08 0.07 0.06 tail dependence 0.05 0.04 0.03 0.02 0.01 0 35 tail dependence 40 45 50 debt 55 60 65 0.65 0.6 0.55 0.5 0.45 0.4 0.35 0.3 0.25 0.2 35

40

45

50 debt

55

60

65

(a) =0.3

(b) =0.9

Figure 4.2: Tail dependence in a two dimensional setting Our approach of evaluating tail dependence uses the marginal probability of a single company defaulting, which we will in later sections compare in two and three dimensions for the values of debt $37 to $65.

50

CHAPTER 4. ANALYSIS OF JOINT PROBABILITIES Marginal Probability of Default Debt 37 40 45 50 55 60 65 Black-Cox 0.00000033 0.00000274 0.000037324 0.00032699 0.00186555 0.0073736 0.02284174 Merton 0.00000018 0.00000163 0.00002137 0.00018269 0.00103069 0.00400908 0.012115643

4.2. TAIL DEPENDENCE

Table 4.6: Marginal probability of Company 2 defaulting in two dimensions From Table 4.6, the marginal probabilities increase as debt increases, however the marginal probabilities remain close to 0 implying a low probability of a single company defaulting. Also, the marginal probabilities are larger in a Black-Cox setting than a Merton setting for the values of debt $37 to $65. Using Moody's Corporate Default Ratings (2002) [12], we can financially interpret the value of debt and the marginal probability of default in a Black-Cox setting and in a Merton setting. With a value of debt $50 in Table (4.6), the marginal probability of default, 1.82e-4 in a Merton setting represents an A rated company. For the same value of debt in a Black-Cox setting, the marginal probability of approximately 3.26e-4, represents an A/Baa rated company. Additionally with a value of debt $65, the marginal probability in a Merton setting represents a Baa/Ba rated company and a Ba/B rating in a Black-Cox setting. Using this information, we estimate that with a value of debt $70 in a Merton and Black-Cox setting, a company is approximately B rated. We will use this information in later sections to approximate the portfolio value of companies with differing ratings and covariance parameters. Figure (4.2) shows that with =0.3, the simulated results of our tail dependence analysis in a Merton setting is tending towards zero. This is well known due to the Gaussian structure of the variables. In a Black-Cox setting, the tail dependence is also tending towards zero but at a faster rate. Also graphically, the tail dependence obtained in a Black-Cox setting is greater than in a Merton setting for each value of debt. In a Black-Cox setting the range of tail dependence is between [0, 0.0877] for values of debt $37 to $65 and [0, 0.0620] in a Merton setting. We can use the marginal probabilities displayed in Table 4.6 to interpret tail dependence and the probability of default. From the graphical results at a debt value of $45, the tail dependence in a Merton setting is 1.80898e-3 with a marginal probability of 2.137e-5. At that same value of debt, the tail dependence measured in a Black-Cox setting is also tending towards 0 with a value of approximately 2.71659e-3 and a marginal probability of 3.7324e-5. Using the marginal probability in a Merton setting, there is a low probability, 0.002137%, of a single company defaulting as well as a low probability that a second company will default as well. Similarly, in a Black-Cox setting there is a low probability of a single company defaulting, 0.00373%, with a low probability that a second company will default. For a value of debt $40 and less, tail dependence is approximately 0 in both a Merton and Black-Cox setting. The marginal probability at this value of debt represents a probability threshold of a single company defaulting re51

CHAPTER 4. ANALYSIS OF JOINT PROBABILITIES

4.2. TAIL DEPENDENCE

sulting in tail dependence in our simulations; 2.74e-6 in a Black-Cox setting and 1.63e-6 in a Merton setting. In the coming pages, we also compare the tail dependence obtained with =0.3 in higher dimensions as well as with an increased  value. Using =0.9, the range of tail dependence is larger in comparison to the values observed with =0.3. In a Merton setting, the tail dependence now moves in the range of [0.217, 0.5515] and lies in [0.2199, 0.58018] in a Black-Cox setting. Note the lower limit is greater than zero because we did not move much into the tail of the random variable. Even though the range of our simulated tail dependence values are larger, the relationship that is observed between the tail dependence in a Merton and Black-Cox setting is similar to our results obtained with =0.3. In particular, it seems the limiting tail dependence in a Black-Cox setting is zero, similarly to Merton's model. In general, our graphical results show that the tail dependence measured in a Black-Cox simulation is greater than the dependence in a Merton setting for each value of debt. The dependence decreases between the two structural approaches as debt decreases to $37, rendering the Black-Cox method as the best candidate to maintain higher dependence on the short-mid tail while converging to a Merton method in the long tail. The results of our simulations also reveal a debt threshold of $37 where our tail dependence calculations fail. This is due to the value of paths utilized in our initial simulations. To increase the accuracy of the analysis beyond this debt threshold, it is required to increase the value of paths used in our Monte Carlo simulations. We also construct confidence intervals to describe tail dependence. These confidence intervals are obtained through multiple simulations of tail dependence that are performed in order to increase the precision of our results using 107 paths. We formulated each interval to describe tail dependence with a 95% accuracy. Debt 37 40 45 50 55 60 65 Black-Cox 0 0 [0, 0.0005] [0.0069, 0.0091] [0.0198, 0.0206] [0.0445, 0.0483] [0.0877, 0.0886]
(a) =0.3

Merton 0 0 [0, 0.0084] [0.0027, 0.0081] [0.0122, 0.0153] [0.0314, 0.0343] [0.0616, 0.0628]

Debt 37 40 45 50 55 60 65

Black-Cox [0, 0.5] [0.1470, 0.3888] [0.2994, 0.3860] [0.3913, 0.4114] [0.4528, 0.4609] [0.5173, 0.5227] [0.5787, 0.5810]
(b) =0.9

Merton [0, 0.5] [0.1333, 0.3571] [0.2827, 0.3454] [0.3691, 0.4042] [0.4327, 0.4474] [0.4954, 0.4994] [0.5507, 0.5530]

Table 4.7: Confidence Intervals describing tail dependence in a two dimensional setting From the confidence intervals with =0.3, some observations can be established and compared in a higher dimensional setting. The first observation is that tail dependence in both a Merton and Black-Cox setting is 0 for values of debt less than $40. Also for values of debt greater than $50, the measure of tail dependence in the Black-Cox setting is greater than in a Merton setting. The simulated tail dependence results with =0.9, show that the confidence intervals near the debt thresh52

CHAPTER 4. ANALYSIS OF JOINT PROBABILITIES

4.2. TAIL DEPENDENCE

old of $37 have a large range. This is due to the poor level of precision achieved with a limited number of paths. The intervals obtained for values of debt $37, $40, $45 and $50, display a range of tail dependence that overlap between our Merton and Black-Cox simulations. Therefore, we are unable to accurately conclude the relationship between our Merton and Black-Cox tail dependence simulations at these values of debt. To construct an more precise approximation of tail dependence for these values of debt, it is required to either increase the number of simulated tail dependence results for each value of debt or increase the number of paths used in our Monte Carlo simulation. As previously mentioned, our simulated results used 107 paths, thus an increase in the number of paths used would increase the running time of our approach. We can approximate the running time of our simulation using 108 paths from the running time of our simulations using 107 paths. One tail dependence simulation in two dimensions for a single value of debt using 107 paths, requires a running time of 5.14 min in a Merton setting and 7.23 min in a Black-Cox setting. Therefore, the use of 108 paths will increase the running time to approximately 51.4 min in a Merton setting and approximately 72.3 min in a Black-Cox setting for each of debt. Another approach to increase the precision of our tail dependence results, is to increase the number of simulations we preform. The reason we are unable to use this approach is also a result of the running time of our tail dependence simulation. To evaluate tail dependence for the values of debt $37, $40, $45, $50, $55, $60 and $65 in a Merton setting using 107 paths requires approximately 36.65 min. For the same values of debt in a Black-Cox setting using 107 paths, the running time was 51.73 min. Thus, one measure of tail dependence via simulations requires approximately 88.38 min. From the confidence intervals obtained for values of debt greater than $55 using both =0.3 and =0.9 and 107 paths, the range of tail dependence has decreased and no longer overlap. As a result, we are able to accurately conclude that the tail dependence in a Black-Cox setting is greater than in a Merton setting with a 95% accuracy. We also interpret the value of debt $55, as a debt threshold for an accurate simulation of tail dependence using our parameters defined in Section 2.1.2.

4.2.2

Three Dimensions

We can easily extend our analysis of tail dependence to three dimensions. In the figures below, we modeled tail dependence in three dimensions using the same parameters previously defined in Section 4.2.1 with our simulations in two dimensions and 107 paths. The results of our tail dependence analysis in a Black-Cox simulation are modeled with a solid curve and a dashed curve in a Merton setting.

53

CHAPTER 4. ANALYSIS OF JOINT PROBABILITIES

4.2. TAIL DEPENDENCE

0.015

0.5 0.45 0.4

0.01 tail dependence tail dependence 0.005 0.2 0.15 0 35 0.1 35 40 45 50 debt 55 60 65 0.35 0.3 0.25

40

45

50 debt

55

60

65

(a) =0.3

(b) =0.9

Figure 4.3: Tail dependence in a three dimensional setting Similarly to our analysis of tail dependence in two dimensions, we display the marginal probabilities used in our tail dependence simulations in three dimensions. Marginal Probability of Default Debt 37 40 45 50 55 60 65 Black-Cox 0.00000043 0.00000236 0.00003736 0.00032240 0.00182674 0.00737566 0.02102310 Merton 0.00000022 0.00000125 0.00002158 0.00018074 0.00099797 0.00396634 0.01210816

Table 4.8: Marginal probability of Company 2 defaulting in three dimensions The marginal probabilities in two dimensions from Table 4.6, had a range of [3.3e-7, 2.284174e-2] in a Black-Cox setting and [1.8e-7, 1.2115643e-2] in a Merton setting for the values of debt $[37, 65]. From Table 4.8 in three dimensions, the range of the marginal probabilities is [4.3e-7, 2.10231e-2] in a Black-Cox setting and [2.2e-7, 1.210816e-2] in a Merton setting. Thus, the marginal probabilities in a Black-Cox and Merton settings are similar in dimensions two and three. Additionally, the marginal probabilities obtained are close to 0, implying the probability of a single company defaulting is low in two and three dimensions in both settings. The marginal probabilities may differ slightly from dimension two and three, as a result of the number of paths in our simulations. We can increase the precision of our marginal probabilities by increasing the number of paths used in our simulations, however the running time would be affected. As previously mentioned, 107 paths was used in our two dimensional Monte Carlo simulations, requiring 5.14 min in a Merton setting and 7.23 min in a Black-Cox setting. In three dimensions, the running time of our simulations was approximately 8.45 min in a Merton setting and 11.3 min in a Black-Cox setting using 107 paths. Thus by increasing the number of paths used in our simulation to 108 in three dimensions, the running time of our 54

CHAPTER 4. ANALYSIS OF JOINT PROBABILITIES

4.2. TAIL DEPENDENCE

approach in a Merton setting would increase to approximately 84.5 min and 113.0 min in a Black-Cox setting. For tail dependence in a three dimensional setting, we confirm many of the same conclusions observed in two dimensions. The simulated results with =0.3 have a range of tail dependence [0, 0.0087] in a Merton setting and [0, 0.14958] in a Black-Cox setting. In comparison to tail dependence in two dimensions, the range has increased in both settings. Graphically, the tail dependence in three dimensions is similar to our results in two dimensions, where the tail dependence in both a Merton and Black-Cox setting is tending towards 0. Additionally, the tail dependence in a Black-Cox setting is tending towards 0 at a faster rate than in a Merton setting. Moreover, at each value of debt the simulated tail dependence in our Black-Cox setting is greater than in a Merton setting. We compare in two and three dimensions, the value of debt with which tail dependence is approximately 0. In three dimensions at a debt of $50, the tail dependence for both settings is approximately 0 with the marginal probability of default, 3.2224e-4 in a Black-Cox setting and 1.8074e-4 in a Merton setting. This implies that in a Black-Cox setting there is a low probability of a single company, 0.018%, and low probability that a second and third company will default as well. Similarly in a Merton setting, there is a low probability of a single company defaulting, 0.032%, and a low probability that a second and third company will default as well. In two dimensions, we were only able to observe a tail dependence value of approximately 0 at a debt of $40. Therefore, the tail dependence is tending towards 0 faster in three dimensions than in two dimensions. This is a result of the dimension size and the probability of default. In two dimensions, tail dependence using equation (4.5) measures the conditional probability of Company 1 defaulting given that Company 2 defaults. In two dimensions if a single company defaults, another company has a high likelihood of defaulting as well. In three dimensions, equation (4.5) measures the conditional probability of Company 1 and 3 defaulting given that Company 2 has defaulted. Thus the conditional probability we use to measure tail dependence, has a lower likelihood of occurring in three dimensions than in two dimensions. Moreover, this is a result of the joint probability of default measured in three dimensions. In three dimensions there is a lower likelihood of 2 companies defaulting given a single company has defaulted than in two dimensions, where there is a greater likelihood that a company will default given that another company has already defaulted. Therefore in three dimensions, we expect that the tail dependence in three dimensions will tend towards 0 at a faster rate than in two dimensions. From our simulated results with =0.9, the range of tail dependence in a Merton setting is [0.15, 0.4059] and [0.16, 0.4366] in a Black-Cox setting. Comparing the range of tail dependence obtained using =0.9 with our simulated results using =0.3, there is an increase. Also from our simulated results, the tail dependence measured in a Black-Cox setting is greater than the tail dependence in a Merton setting at each value of debt. Similarly to our previous results, tail dependence is also tending towards 0 in both our Merton and Black-Cox simulations. However, we are unable to graphically display this result since our tail dependence in a three dimensional setting with =0.9 has a debt threshold of $37, similarly to our tail dependence model in two dimensions. In order to model an accurate tail dependence result near this threshold, it is required to increase the value of paths in our parameters or the amount of tail dependence simulations we conduct. Similarly to our previous results in two dimensions, we establish confidence intervals with a 95% accuracy 55

CHAPTER 4. ANALYSIS OF JOINT PROBABILITIES

4.2. TAIL DEPENDENCE

to describe our tail dependence in three dimensions using =0.3 and =0.9. The confidence intervals are used to interpret the marginal probabilities of default and tail dependence presented in three dimensions. Debt 37 40 45 50 55 60 65 Black-Cox 0 0 0 [0, 0.0003] [0.0010, 0.0016] [0.0047, 0.0051] [ 0.0147, 0.0151 ]
(a) =0.3

Merton 0 0 0 0 [ 0.0005, 0.0011] [0.0027, 0.0032] [ 0.0085, 0.0088]

Debt 37 40 45 50 55 60 65

Black-Cox [0, 0.20] [0.1176, 0.2222] [0.1675, 0.2294] [0.2422, 0.2546] [0.3057, 0.3118] [0.3682, 0.3727] [0.4356, 0.4378]
(b) =0.9

Merton [0, 0.50] [0.0769, 0.20] [0.175, 0.2133] [0.2226, 0.2434] [0.2873, 0.2948] [0.3458, 0.3503] [ 0.4042, 0.4080]

Table 4.9: Confidence Intervals describing tail dependence in a three dimensional setting Using Table 4.6 and Table 4.8, we compare the marginal probabilities used for our tail dependence simulations in two and three dimensions. From the confidence intervals in two dimensions with =0.3, Table 4.7, tail dependence is tending towards zero at a debt of $40 with a marginal probability of 2.74e-6 in a BlackCox setting. In a Merton setting at a value of debt $40 the marginal probability is 1.63e-6. These values represent a probability threshold of a single company defaulting resulting in tail dependence in our two dimensional simulation. In three dimensions with =0.3, from Table 4.9, the value of debt $50 represents the threshold of tail dependence in both a Merton and Black-Cox setting. In a Black-Cox setting at the debt of $50, the marginal probability is 3.224e-4 in a Black-Cox setting and 1.8074e-4 in a Merton setting. Our results imply that there is a lower marginal probability threshold for tail dependence in two dimensions than in three dimensions using =0.3. In conclusion, in a two dimensional setting we established confidence intervals to describe the measures of tail dependence for various values of debt. Recall that for =0.3 in two dimensions, the measure of tail dependence was approximately 0 in both a Merton and Black-Cox setting at a value of debt $40. Additionally, the marginal probability at a debt of $40 was 2.74e-6 in a Black-Cox setting and 1.63e-6 in a Merton setting. Also in two dimensions for values of debt greater than $55, the tail dependence in a Black-Cox setting is greater than in a Merton setting. In three dimensions with =0.3, the confidence intervals show that the measure of tail dependence is approximately 0 at a value of debt $50 in both a Black-Cox setting and Merton setting. The marginal probability of default at this value of debt in a Black-Cox setting is 3.22e-4 and 1.80e-4 in a Merton setting. Using =0.3 the simulated tail dependence values are tending towards 0 faster in three dimensions than in two dimensions, at a debt of $50 versus $40 respectively. Similarly to our analysis in two dimensions, in three dimensions the measure of tail dependence in a Black-Cox setting is greater than the tail dependence in a Merton setting for values of debt greater than $55. Thus for increasing values of debt, there is a greater tail dependence in our Black-Cox setting than in a Merton setting.

56

CHAPTER 4. ANALYSIS OF JOINT PROBABILITIES

4.2. TAIL DEPENDENCE

When  is increased to 0.9, the results of our confidence intervals in three dimensions are similar to the results described in two dimensions. Using =0.9 in two dimensions, we were unable to accurately conclude the value of debt with which tail dependence is approximately 0 as a result of the precision of our simulations. However, we are able to accurately describe the relationship of tail dependence between our Merton and Black-Cox settings for values of debt greater than $55. For values of debt greater than $55, the tail dependence in a Black-Cox setting is greater than in a Merton setting. In three dimensions the confidence intervals are also inconclusive at values of debt near the debt threshold of $37 since the range of tail dependence overlaps. As discussed in two dimensions, this is as a result of the number of paths used in our simulations. At a debt of $55, the confidence intervals in our Black-Cox and Merton setting no longer overlap and allows us to accurately estimate tail dependence and the confidence intervals obtained. We see that for values of debt greater than $55, the measure of tail dependence in a Black-Cox setting is greater than in a Merton setting. Thus in two and three dimensions for values of debt larger than $55, the simulated tail dependence in a Black-Cox setting is greater than in a Merton setting with 95% accuracy using =0.9.

57

Chapter 5

Portfolio Analysis
In this section, we analyze portfolio value in both a Merton and Black-Cox setting. Introduced are two definitions of portfolio value; one is associated to a credit portfolio and the second one to a market portfolio. A comparison of volatilities, correlations and portfolio allocations are also performed. One definition of portfolio value resembles a credit portfolio with the use of an indicator function to denote default or non-default with a flexibility of portfolio weights. Using this definition of a credit portfolio, we are able to analytically define and study portfolio value in dimensions one to three. Here two types of allocations are studied, the
1 n

allocation and the Minimum Variance Optimal Allocation as defined per

Markowitz. We rely mainly on a simulated approach to model a four dimensional portfolio in a Merton and Black-Cox setting using two sets of covariance parameters to model "normal" market conditions and "crisis" market conditions. Our first simulation will use the following parameters to simulate a "normal" market:
1 i =0.2 for i=1, . . . , 4, with a portfolio allocation of ai = n =0.25, =0.3, µi =0.04 and a debt of $70. A second simulation uses a minimal variance allocation of a1 =-0.0026, a2 =0.0582, a3 =0.2140 and a4 =0.7304, 1 =0.25, 2 =0.20, 3 =0.15 and 4 =0.10 with =0.9, µi =0.04 and debt $90 to simulate a "crisis" market.

A second definition of portfolio value represents a market portfolio where the underlyings are asset value, Si for i=1, . . . , 4. In a Merton setting, Si is measured at maturity time, T while the minimum asset value of Si (t) is measured in a Black-Cox setting. We compare and analyze the distribution of portfolio value in each structural model with credit and market portfolios both in a "normal" and "crisis" market. Additionally in this section, we introduce and evaluate the value of risk of our credit and market portfolios. The objective of this section is to describe the portfolio distribution and risk measures of a portfolio in a Merton and Black-Cox setting in a simulated "normal" and "crisis" market. We construct our results using credit and market definitions of portfolios and 2 sets of covariance parameters, allocation weights and debts. Additionally, we compare and evaluate the value at risk measured in a credit and market portfolio in a Merton and Black-Cox setting with a 1%, 5% and 10% probability.

58

CHAPTER 5. PORTFOLIO ANALYSIS

5.1. CREDIT PORTFOLIO DISTRIBUTION

5.1

Credit Portfolio Distribution

Previously in Chapter 4, we analyzed the joint probability distribution and tail dependence in a Merton and Black-Cox setting; in this chapter we evaluate and compare the distribution of portfolio value. Our first definition of portfolio value will model a credit portfolio. It defines for Company i = 1, . . . , n, the portfolio value  (T ) as:  (T ) = where ai represents the allocation of weight and
n  i=1

ai 1i >T

(5.1)

the corresponding weight to the portfolio in the event of non-default. We use this definition of portfolio value to numerically evaluate the distribution of portfolio value in a Merton and Black-Cox setting in four dimensions, allowing us to define the relationship between the probability distribution of portfolio value with the probability of default of the underlyings. Using this definition of a credit portfolio, equation (5.1), we are able to analytically define the relationship between portfolio value and probabilities of default in one, n 1 two and three dimensions assuming that ai = n with i=1 ai =1. We use Bj,n to represent default where n=dimension, j =number of defaults with j  n and j  0: Proposition 5.1.1. In dimensions one, two and three, we are able to analytically evaluate the relationship n 1 with i=1 ai =1. between the probability of default and portfolio value. It is assumed that ai = n P ( (T ) = 1) = P (B0,1 ) = 1 - P (1 < T ) P ( (T ) = 1) = P (B0,2 ) = 1 - P ( (T ) = 1) = P (B0,3 ) = 1 -
2  i

n

i=1

ai =1. This definition of credit portfolio allocates

P (i < T ) + P (1 < T, 2 < T ) P ( i < T ) +
3 

3  i

i1 ,i2

P (i1 < T, i2 < T ) - P (1 < T, 2 < T, 3 < T )

P ( (T ) = 0) = P (B1,1 ) = P (1 < T )  1 P (  ( T ) = ) = P ( B 1 ,2 ) = P (i < T ) - 2P (1 < T, 2 < T ) 2 i P ( (T ) =
1 2

2

3 3   2 ) = P ( B 1 ,3 ) = P ( i < T ) - 2 P (i1 < T, i2 < T ) + 3P (1 < T, 2 < T, 3 < T ) 3 i i ,i 3  1 P (i1 < T, i2 < T ) - 3P (1 < T, 2 < T, 3 < T ) ) = P ( B 2 ,3 ) = 3 i ,i
1 2

P ( (T ) = 0) = P (B2,2 ) = P (1 < T, 2 < T ) P ( (T ) =

P ( (T ) = 0) = P (B3,3 ) = P (1 < T, 2 < T, 3 < T )

Proof of the Proposition 5.1.1 . Using B0,2 are able to analytically define the portfolio value and the probability of default. B0,2 describes the event of 0 defaults in two dimensions, corresponding to the credit 59

CHAPTER 5. PORTFOLIO ANALYSIS portfolio value of $1. B0,2 = {1 > T, 2 > T } = {1 > T }  {2 > T } = {{1 < } \ {1 < T }}  {2 > T }

5.1. CREDIT PORTFOLIO DISTRIBUTION

= {1 < }  {2 > T } \ {1 < T }  {2 > T } = {1 < }  {{2 < } \ {2 < T }} \ {1 < T }  {{2 < } \ {2 < T }} = {1 < , 2 < } \ {1 < , 2 < T } \ {{1 < T, 2 < } \ {1 < T, 2 < T }} P (B0,2 ) = P (1 < , 2 < ) - P (1 < , 2 < T ) - P (1 < T, 2 < ) + P (1 < T, 2 < T ) =1-
2  i

P (i < T ) + P (1 < T, 2 < T )

Using the value of the credit portfolio associated with B0,2 , we define: P ( (T ) = 1) = P (B0,2 ) Note that other formulas follow similarly. Using a simulated Monte Carlo approach, we produce the distribution of a credit portfolio value in both a Merton and Black-Cox setting using 107 paths. The first parameters used to simulate a "normal" market are defined in four dimensions as: Si = 100 i = 0.2 µi = 0.04 ij = 0.3 Di = 70
1 =0.25 since the volatility parameters are equal for i = 1 . . . 4, j = 1 . . . 4. We also use an allocation of ai = n

for each Company i under our "normal" market conditions. Additionally, using the information presented in Table 4.8, a value of debt of $70 would represent a B rated company from the Moody's Credit Rated Default Scale (2002), (see[12]). This allows us to simulate a realistic portfolio using a variety of covariance parameters such as i =0.2, =0.3 and a debt of $70, that may be seen in current market conditions. The following results are established using 107 paths in both a Merton and Black-Cox setting.

60

CHAPTER 5. PORTFOLIO ANALYSIS

5.1. CREDIT PORTFOLIO DISTRIBUTION

0.9 0.8 0.7 0.6 0.5 0.4 0.3 0.2 0.1 0 -0.2

0.9 0.8 0.7 0.6 0.5 0.4 0.3 0.2 0.1 0 -0.2

0

0.2

0.4

0.6

0.8

1

1.2

0

0.2

0.4

0.6

0.8

1

1.2

(a) Merton

(b) Black-Cox

Figure 5.1: Distribution of a four dimensional credit portfolio in a "normal" market From the indicator function defined in equation (5.1), it is expected that the credit portfolio value is 1 2 3 contained in the set {0, 4 , 4 , 4 , 1}. From Figure (5.1a), in a Merton setting, the probability distribution of our credit portfolio is negatively skewed with a value of -3.604 and kurtosis 18.219. There is also a high probability of a portfolio value $1, implying a high probability of non-default. Similarly in a Black-Cox setting, Figure (5.1b), the probability distribution of portfolio value is negatively skewed with a value of -2.667 and kurtosis 10.678. There is also a high probability of a $1 portfolio value, i.e. a high probability of non-default. In Appendix D, the joint probabilities of default are displayed in a Merton and Black-Cox setting using 107 paths and a debt of $70. We use these tables to interpret credit portfolio value in both a Merton and Black-Cox setting under "normal" market conditions. Comparing the distributions in a Merton setting, Figure (5.1a) and Black-Cox setting, Figure (5.1b) the distributions have similar shapes, both are negatively skewed. Additionally, there is a high probability of portfolio value of $1 in both a Merton and Black-Cox setting; 0.8972 and 0.81494 respectively. There is also a low probability of portfolios valued at $0 since the probability of all 4 companies defaulting in both a Merton and Black-Cox setting is low; 1.773e-4 in a Merton setting and 7.222e-4 in a Black-Cox setting. Additionally, the portfolio value $0.75 in our credit portfolio corresponds to the probability of 1 default. Graphically from Figure (5.1a) and Figure (5.1b), there is a larger probability of 1 default in a Black-Cox setting than in a Merton setting. In a Black-Cox setting the joint probability of 1 default is approximately 0.0370 and 0.0220 in a Merton setting. For the portfolio value of $0.5, the joint probability of 2 defaults is approximately 0.0020 in a Merton setting and 0.0050 in a Black-Cox setting. The portfolio value of $0.25 represents the joint probability of 3 defaults which is approximately 0.00044 in a Merton setting and approximately 0.0014 in a Black-Cox setting. We also introduce another set of volatility parameters for Company i in our simulation of credit portfolio value to create richer probability distribution. In this simulation, the value of debt and covariance parameters are altered. This simulation uses a debt of $90, which represents an approximately C rated company using

61

CHAPTER 5. PORTFOLIO ANALYSIS

5.1. CREDIT PORTFOLIO DISTRIBUTION

Moody's Corporate Default Ratings (2002), (see[12]) as well as a correlation of =0.9 and µi =0.04. The volatilities are defined in four dimensions as: 1 = 0.25 2 = 0.20 3 = 0.15 4 = 0.10 We alter our covariance parameters to simulate a collection of companies with differing volatilities and a high correlation, to increase the likelihood of multiple defaults in both a Merton and Black-Cox setting. From the Minimum Variance Optimal Allocation equation as defined by Markowitz, we establish the asset allocation, a, from the covariance,  as: a= - 1 1 1 -1 1 (5.2)

Using equation (5.2), the resulting asset allocation is a1 =-0.0026, a2 =0.0582, a3 =0.2140 and a4 =0.7304. In the following figure, we see a richer variation of portfolio values and probability distribution using the parameters defined in "crisis" conditions.
0.7
0.35

0.6

0.3

0.5

0.25

0.4

0.2

0.3

0.15

0.2

0.1

0.1

0.05

0 -0.0026 0 0.05560.05820.2114 0.214 0.26960.27720.72780.7304 0.786 0.78860.94180.9444 1 1.0026

0 -0.0026 0 0.0556 0.0582 0.2114 0.214 0.2696 0.2772 0.7278 0.7304 0.786 0.7886 0.9418 0.9444 1 1.0026

(a) Merton

(b) Black-Cox

Figure 5.2: Distribution of a four dimensional credit portfolio in a "crisis" market Using a Monte Carlo simulation with 107 paths, the credit portfolio value is contained in $[-0.0026, 1.0026]. Similarly to our previous analysis of credit portfolio, we introduce the joint probability distribution in a Merton and Black-Cox setting using 107 paths, a debt of $90 and =0.9 in Appendix E. In Figure (5.2), the shape of the probability distribution in both a Merton and Black-Cox setting are similar with a heavily skewed distribution towards the left. The distribution has a skewness of -2.687 and kurtosis of 8.907 in a Merton setting and a skewness of -1.384 and kurtosis 3.263 in a Black-Cox setting. In a "crisis" market as described with our parameters, we expect a high codependence between companies implying a greater likelihood of default between multiple companies. In both settings, there is a high probability of a $1 portfolio value corresponding to the probability of non-default, which is 0.6327 in a Merton setting and 0.32030 in a Black-Cox setting. There is a higher probability of non-default in a Merton setting compared to in a Black-Cox setting since default is measured once at the time of maturity T. The portfolio value of $1.0026 corresponds the joint probability of only Company 1 defaulting, which is 0.07829 in a Merton setting and 62

CHAPTER 5. PORTFOLIO ANALYSIS

5.2. MARKET PORTFOLIO DISTRIBUTION

0.11242 in a Black-Cox setting. In Figure (5.2) the probability of 4 defaults is associated with a $0 portfolio value, which is 0.07304 in a Merton setting and 0.17398 in a Black-Cox setting. There is a higher probability of 4 defaults in a Black-Cox setting versus a Merton setting since there is a greater likelihood of all 4 companies defaulting when default is measured at each time t  [0, T ]. The portfolio value of $0.7304 represents the joint probability of Company 1, 2 and 3 defaulting which has a probability of 0.08363 in a Merton setting and 0.19045 in a Black-Cox setting. Similarly to the joint probability of 4 defaults and the portfolio value of $0, there is a higher probability of Company 1, 2 and 3 defaulting in a Black-Cox setting than in a Merton setting. We expect a greater likelihood of Company 1, 2 and 3 defaulting when measuring default at each time interval rather than once at the time of maturity. Lastly, in a Black-Cox setting, there is a high probability of a portfolio value of $0.944; which represents the joint probability of Company 1 and 2 defaulting; 0.06722 in a Merton setting and 0.13227 in a Black-Cox setting. Using our distribution of a credit portfolio under "normal" and 'crisis" conditions in Figure (5.1) and Figure (5.2), all distributions have a shape that is skewed to the left in both Merton and Black-Cox settings. Additionally using both sets of covariance parameters, portfolios valued at $1 have a high probability in each setting. This implies a high probability of non-default in both a Merton and Black-Cox setting in both a market under "normal" conditions and "crisis" conditions, i.e. our covariance parameters.

5.2

Market Portfolio Distribution

In addition to a credit portfolio, we analyze the distribution of a market portfolio in a Merton and BlackCox setting using asset value. The use of asset value in our model of market portfolios will provide a greater description of the distribution of portfolio value. The value of a portfolio,  (T ) is defined as:  (T ) = where Merton : Black-Cox :
M Xi = Si ( T ) BC Xi = min Si (t) 0 t T n  i=1

ai Xi

(5.3)

The market portfolio in equation (5.3), uses the asset value of Si for i = 1 . . . n in addition to the allocation M BC ai . In a Merton setting, Xi represents the asset value measured at the time of maturity T and Xi in a Black-Cox setting measures the minimum asset value from time t  [0, T ]. This portfolio can be seen as a "look back" portfolio, (see[8]). Similarly to our previous results using a credit portfolio, we define covariance parameters and debt in our analysis of market portfolios in "normal" and "crisis" conditions. Using i =0.2, =0.3, µi =0.04, a debt of $70 and ai =0.25, the distribution of portfolio value in a "normal" market is:

63

CHAPTER 5. PORTFOLIO ANALYSIS

5.2. MARKET PORTFOLIO DISTRIBUTION

0.45 0.4

0.35

0.3 0.35 0.25 0.3 0.25 0.2 0.15 0.1 0.1 0.05 0.05 0 40 0 40 0.2

0.15

60

80

100

120

140

160

180

200

220

50

60

70

80

90

100

(a) Merton

(b) Black-Cox

Figure 5.3: Distribution of a four dimensional market portfolio in a "normal" market The distribution of portfolio value in a Merton setting models portfolio value in a range of $[0, ] since

M the asset value Xi for i=1, . . . , 4 may be greater than $100 as a result of the structured measure of default.

In a Merton setting, default is measured at the time of maturity T , where there is no upper bound on the value of each asset. However in a Black-Cox setting, the portfolio value has a range of $[0, 100] since
BC measures the minimum value of the asset value Si (t) for time t in [0,T]. We analyze the the value of Xi

distribution of a market portfolio value defined with, equation (5.3) to compare with our previous definition of a credit portfolio value, equation (5.1) under "normal" market conditions. In a Merton setting, Figure (5.3a) the shape of the distribution is positively skewed with a value of 0.361 and kurtosis 3.246, whereas the distribution of our credit portfolio has a negatively skewed shape. Additionally, the peak of our distribution of a market portfolio occurs at a portfolio value of $[96.5, 113.04] with a probability of 0.4288691. In a Black-Cox setting, Figure (5.3b) the probability distribution displayed a negatively skewed shape with a value of -0.555 and kurtosis 3.132. The distribution of our credit portfolio under "normal" conditions was negatively skewed as well. Also, the peak of our market portfolio occurs at the portfolio value $[85, 90] with a probability of approximately 0.2968019. Using our definition of a market portfolio value defined with equation (5.3), the asset value Xi for i = 1 . . . , 4 is utilized. The figures below display the probability distribution of asset value Xi in a Merton and Black-Cox setting:

64

CHAPTER 5. PORTFOLIO ANALYSIS

5.2. MARKET PORTFOLIO DISTRIBUTION

0.5 0.45

0.35

0.3 0.4 0.35 0.3 0.2 0.25 0.15 0.2 0.15 0.1 0.05 0.05 0 0 50 100 150 200 250 300 0 30 0.1 0.25

40

50

60

70

80

90

100

(a) Merton

(b) Black-Cox

Figure 5.4: Distribution of X1 in a four dimensional market portfolio in a "normal" market Using the value of Xi in a Merton and Black-Cox setting, we can distinguish several properties. In a Merton setting, the distribution of asset value Xi displays a positively skewed shape with a value of 0.531 and kurtosis 3.517. In a Black-Cox setting the asset value has a negatively skewed distribution with a value of -0.856 and kurtosis 3.177. Additionally in a Black-Cox setting, the peak of our distribution occurs at the largest asset value of $[95, 100] with a probability of 0.30791. In a Merton setting there is a high probability, 0.47185, of the asset value $[85.01, 110.35]. Additionally, the heavy tails of our distribution of asset value Xi in a Merton is approximately at $200 and $45. In a Black-Cox setting the heavy tail is at approximately $50. Using our "crisis" conditions as defined in Section 5.1; a debt of $90, =0.9, µi =0.04 and volatility and allocation parameters, we will evaluate market portfolio value in a Merton and Black-Cox setting. In this simulation, we use the volatility parameters 1 =0.25, 2 =0.20, 3 =0.15 and 4 =0.10 with an allocation of a1 =-0.0026, a2 =0.0582, a3 =0.2140 and a4 =0.7304 to measure the probability distribution of our market portfolio.
0.45 0.4 0.35 0.3 0.25 0.2 0.15 0.1 0.05 0 50 0.45 0.4 0.35 0.3 0.25 0.2 0.15 0.1 0.05 0 55

100

150

200

60

65

70

75

80

85

90

95

100

(a) Merton

(b) Black-Cox

Figure 5.5: Distribution of a four dimensional market portfolio value in a "crisis" market In Figure (5.5), there are differing distribution shapes of market portfolio value in a Merton and Black65

CHAPTER 5. PORTFOLIO ANALYSIS

5.2. MARKET PORTFOLIO DISTRIBUTION

Cox setting. In Figure (5.5a) a Merton setting, the portfolio value distribution is positively skewed with a value of 0.305 and kurtosis 3.175 and a peak at the portfolio value of $[97.53, 111.46] with a probability of 0.444. In a Black-Cox setting, seen in Figure (5.5b) there is a negatively skewed distribution with a value of -1.094 and kurtosis 3.880 and a peak portfolio value $[95.62, 100] with a probability of 0.4013. In addition to the market portfolio value, we analyze and compare the asset value of each Company i in a Merton and Black-Cox setting. In the following figures, the asset value, Xi , in a Merton setting is modeled using 1 =0.25, 2 =0.20, 3 =0.15 and 4 =0.10, debt of $90, correlation =0.9, µi =0.04 and 107 paths:
0.45 0.4 0.35 0.3 0.3 0.25 0.25 0.2 0.2 0.15 0.15 0.1 0.05 0 0 50 100 150 200 250 300 350 400 0.1 0.05 0 0 50 100 150 200 250 300 0.5 0.45 0.4 0.35

(a) Company 1
0.45 0.4 0.35 0.3 0.25 0.2 0.15 0.1 0.05 0 0 50 100 150 200 250 0.45 0.4 0.35 0.3 0.25 0.2 0.15 0.1 0.05 0 40

(b) Company 2

60

80

100

120

140

160

180

(c) Company 3

(d) Company 4

Figure 5.6: Distribution of Xi in a Merton setting using a market portfolio in a "crisis" market In Figure (5.6) there are similar positively skewed distribution shapes for each Company i. For Company 1 in Figure (5.6a), the asset value has a range of $[24.01, 381.52] and a peak at the value of $[95.51, 131.26] with a probability of 0.4402. Also the distribution of X1 has a positive skewness of 0.664 and kurtosis 3.758. From Figure (5.6b), the asset value of Company 2 has a range of $[34.34, 287.71] with a high probability of 0.47186 of the asset value $[85.02, 110.35]. The distribution of X2 has a skewness of 0.513 and kurtosis 3.517. Using Figure (5.6c), the distribution of asset value in Company 3 has a range of $[47.63, 237.47] with a high probability, 0.4331, of the asset value $[85.60, 104.58]. The distribution of X3 has a skewness of 0.355 and kurtosis 3.143. The asset value of Company 4 in Figure (5.6d), has a range $[59.72, 175.85], with a high probability of 0.4170 of the asset value $[94.56, 106.17]. The distribution of X4 for Company 4, has a skewness of 0.261 and kurtosis 3.246. 66

CHAPTER 5. PORTFOLIO ANALYSIS

5.2. MARKET PORTFOLIO DISTRIBUTION

In comparison, we analyze the asset value of Company i in Black-Cox setting. The figures below use 1 =0.25, 2 =0.20, 3 =0.15 and 4 =0.10, =0.9, µi =0.04 and debt $90 to model asset value in a Black-Cox setting:
0.35 0.35

0.3

0.3

0.25

0.25

0.2

0.2

0.15

0.15

0.1

0.1

0.05

0.05

0 20

30

40

50

60

70

80

90

100

0 30

40

50

60

70

80

90

100

(a) Company 1
0.4 0.5 0.45 0.4 0.3 0.35 0.25 0.3 0.25 0.2 0.15 0.1 0.1 0.05 0.05 0 55

(b) Company 2

0.35

0.2

0.15

0 40

50

60

70

80

90

100

60

65

70

75

80

85

90

95

100

(c) Company 3

(d) Company 4

Figure 5.7: Distribution of Xi in a Black-Cox setting using a market portfolio in a "crisis" market For each Company i in a Black-Cox setting the probability distribution has a negatively skewed shape with heavy tails. In Figure (5.7a) the asset value has a range of $[24.01, 100] with a high probability, 0.2845, of the asset value $[92.40, 100]. The distribution of X1 has a negative skewness of -0.744 and kurtosis 2.904. The tail is approximately at $40. From Figure (5.7b) the asset value has a range of $[33.51, 100] with a high probability of 0.2845 of the asset value $[93.35, 100] in Company 2. The distribution of X2 has a skewness of -0.865-0.744 and kurtosis 3.188. In this figure, the tail is measured at approximately $45. Using Figure (5.7c) the distribution of the asset value of Company 3 has a range of $[47.24, 100] and the asset value $[94.72, 100] has a high probability of 0.3630. The distribution of X3 has a skewness of -1.003 and kurtosis 3.567. For the asset value in Company 3, the tail is measured at approximately $65. Company 4 in Figure (5.7d) has a range of $[59.59, 100] with a high probability of 0.45168 of the asset value $[95.95, 100]. The distribution of asset value for Company 4 has a tail at approximately $75 and a skewness of -1.219 and kurtosis 4.220. Using our 2 sets of covariance parameters and asset allocations defined in "normal" and "crisis" market conditions, we compare the distribution of market portfolio value in a Merton and Black-Cox setting. From 67

CHAPTER 5. PORTFOLIO ANALYSIS

5.3. RISK MEASURES OF A PORTFOLIO

Figure (5.3a) in a Merton setting under "normal" conditions, the distribution of market portfolio value has a positively skewed shape. The highest probability of portfolio value occurs at $[96.50, 113.04] with a probability of 0.42886. The parameters under "crisis" conditions in a Merton setting, also display a positively skewed shape, however the portfolio value of $[97.53, 111.46] has a high probability of 0.444 in Figure (5.5a). The distribution of market portfolio value in a Black-Cox setting display a negatively skewed shape with heavy tails in both a "normal" market and in a "crisis" market. Under "normal" conditions, the portfolio value $[85, 90] has a high probability of 0.29680 while in a "crisis" market there is a high probability, 0.40133, of a $[95.62, 100] portfolio value.

5.3

Risk Measures of a Portfolio

In this subsection, we introduce and evaluate the value at risk of our portfolios previously defined using a credit portfolio, equation (5.1) and a market portfolio, equation (5.3). We concentrate on the value at risk =0.01, =0.05 and =0.1. Value at risk is defined as the loss from adverse market movements over a fixed time. The probability that is associated with value at risk corresponds to the probability that a given loss is expected to occur. We use value at risk to compare the market risks of a company in a Merton and Black-Cox setting as well as with 2 sets of covariance parameters in a "normal" and "crisis" market. The measure of value at risk takes into account the correlation between various assets and risk factors. Mathematically, value at risk is defined as: Va R  P ( (T ) -  (0) < Va R ) =  where:  (0) : portfolio value at time 0  (T ) : portfolio value at time T and  (T ) -  (0) represents total lost. Therefore the value at risk of a portfolio measures the largest value such that the probability of portfolio loss greater than the value at risk is .

In our analysis, we interpret the measure of value at risk as the potential gain or loss of portfolio value. Firstly, we use the covariance parameters of i =0.2 and =0.3, debt of $70, µi =0.04 and ai =0.25 to produce "normal" market conditions. From the definition of credit portfolio defined with equation (5.1), we expect 1 2 3 that portfolio value will be contained in ${0, 4 , 4 , 4 , 1}. In a Merton and Black-Cox setting the value at risk

of our credit portfolio in a "normal" market is:

68

CHAPTER 5. PORTFOLIO ANALYSIS Merton =0.01 =0.05 =0.1
3 -$ 4 1 -$ 2 1 -$ 4

5.3. RISK MEASURES OF A PORTFOLIO Black-Cox -$ 3 4 -$ 1 2 -$ 1 2

Table 5.1: Value at risk of our credit portfolio in a "normal" market Introduced in Table 5.1, we analyze the value at risk of our portfolio value with a 1%, 5% and 10% probability in both a Merton and Black-Cox setting. With a 1% probability in both a Merton and BlackCox setting, the portfolio value may decrease by more than $0.25 implying a potential loss of -$0.75. In both a Merton and Black-Cox setting there is a 5% probability that the portfolio value may decrease by more than $0.5, describing a potential loss of -$0.5. In a Merton setting, there is a 10% probability that the portfolio value may decrease by more than $0.75; a potential loss of -$0.25 in our credit portfolio. Additionally in a Black-Cox setting, there is a 10% probability that the portfolio value will decrease by more than $0.5; a loss of -$0.5. Using  = 0.1 there is less potential loss in a Merton setting than in a Black-Cox setting. This shows that in a very simple setting how different value at risk can be in a Merton versus Black-Cox setting. Therefore, there is greater risk associated with our portfolios in a Black-Cox setting in the mid-tail of our distribution. Given our covariance parameters defined in a "normal" market, there is a 1% and 5% probability that the potential loss of portfolio value is similar in a Merton and Black-Cox setting. In addition to our definition of a credit portfolio that was introduced in Section 5.1, we analyzed a market portfolio defined with equation (5.3). Using equation (5.3), the value at risk of our market portfolio in a "normal" market is described as: Merton =0.01 =0.05 =0.1 -$36.5 -$19.96 -$19.96 Black-Cox -$30 -$25 -$25

Table 5.2: Value at risk of our market portfolio in a "normal" market With a 5% and 10% probability in a Merton setting, the portfolio value may decrease to $80.04 with a potential loss of -$19.96. In a Black-Cox setting, with a 5% and 10% probability, the portfolio value may decrease to $75 implying a potential loss of -$25. With a 1% probability in a Merton setting, the portfolio value may decrease to $63.5, implying a potential loss of -$36.5. In a Black-Cox setting, the portfolio value may decrease to $70 describing a potential loss of -$30. In a Merton setting, there is greater risk farther into the tail of our distribution of a market portfolio. A similar result is obtained in a Black-Cox setting. Thus, there is greater potential loss with a 1% probability than in the mid-tail of our distribution in both settings. Similarly to our previous analysis of portfolio value in Section 5.1, we evaluate the value at risk for our portfolios in "crisis" conditions. We evaluate the value at risk of our market and credit portfolios in "crisis" 69

CHAPTER 5. PORTFOLIO ANALYSIS

5.3. RISK MEASURES OF A PORTFOLIO

conditions using the volatility parameters that were introduced in Section 5.1 as: 1 = 0.25 2 = 0.20 3 = 0.15 4 = 0.10 and =0.9, µi =0.04 and debt of $90. Displayed in the tables below are the value at risk of our credit portfolio defined using equation (5.1) in a "crisis" Merton and Black-Cox setting: Merton =0.01 =0.05 =0.1 -$1.0026 -$1.0026 -$0.2722 Black-Cox -$1.0026 -$1.0026 -$1.0026

Table 5.3: Value at risk of our credit portfolio in a "crisis" market With a 1% and 5% probability in both a Merton and Black-Cox setting, the portfolio value may decrease by more than -$0.0026 implying is a potential loss of -$1.0026. In a Merton setting, there is a 10% probability that the portfolio value may decrease by more than $0.7278 with a potential loss of -$0.2722. Additionally in a Black-Cox setting, there is a 10% probability that the portfolio value will decrease by more than -$0.0026 with a potential loss of -$1.0026. Using =0.10 there is less potential loss in a Merton setting than in a Black-Cox setting, implying greater risk associated with our credit portfolio in a Black-Cox setting in the mid-tail of our distribution. Similarly to Table 5.1, the potential loss under "crisis" conditions of our credit portfolio in a Merton and Black-Cox setting are alike with a 1% and 5% probability. Comparing both Table 5.1 and Table 5.3 with a 1%, 5% and 10% probability, there is less potential loss in both a Merton and Black-Cox setting in "normal" conditions for a credit portfolio than under "crisis" conditions. The following table describes the value at risk of our market portfolio using equation (5.3) under "crisis" market conditions. The potential loss of our market portfolio in "crisis" conditions using 1 =0.25, 2 =0.20, 3 =0.15 and 4 =0.10 with a debt of $90, µi =0.04 and =0.9, are described as: Merton =0.01 =0.05 =0.1 -$30.32 -$16.40 -$16.40 Black-Cox -$22.18 -$17.73 -$17.73

Table 5.4: Value at risk of our market portfolio in a "crisis" market In Table 5.4, we continue to analyze the loss of our market portfolio with a 1%, 5% and 10% probability in a "crisis" market. With a 1% probability in a Merton setting, the portfolio value may decrease to $69.68 70

CHAPTER 5. PORTFOLIO ANALYSIS

5.3. RISK MEASURES OF A PORTFOLIO

implying a potential loss of -$30.32. In a Black-Cox setting, the portfolio value may decrease to $77.82 describing a potential loss of -$22.18 with a 1% probability. With a 5% and 10% probability in a Merton setting, the portfolio value may decrease to $83.60 with a potential loss of -$16.40. In a Black-Cox setting, with a 5% and 10% probability, the portfolio value may decrease to $82.27 implying a potential loss of -$17.73. Under "crisis" conditions, there is greater risk farther into the tail than in the mid-tail of our distribution in both a Merton and Black-Cox setting. Comparing both Table 5.2 and Table 5.4 with a 1%, 5% and 10% probability in a Merton setting, there is less potential loss i.e. less risk, under "crisis" market conditions using a market portfolio. In a Black-Cox setting, there is also less risk and potential loss using a market portfolio under "crisis" conditions than in "normal" conditions with a 1%, 5% and 10% probability.

71

Chapter 6

Conclusion
In this thesis, we used our simulations of the joint probability distribution of defaults in a Merton and Black-Cox setting to evaluate tail dependence, portfolio value and value at risk. Firstly, we analytically approached the joint probability distribution in a Merton setting in any dimension using the multivariate normal, which we simulated in MATLAB® with a function called mvncdf. Additionally, we used a simulated Monte Carlo approach with 104 and 107 paths. In a Black-Cox setting, analytical solutions to the FokkerPlanck equation are mathematically challenging, therefore we relied on a simulated approach to approximate the joint probability distribution. We concluded that 107 paths in both a Merton and Black-Cox setting provided a reasonably accurate approximation of the joint probability distribution in dimensions two, three and four. In each dimension we analyzed, there was a higher joint probability of all companies defaulting in a Black-Cox setting than in a Merton setting as well as a higher joint probability of non-default in a Merton setting than in a Black-Cox setting. We used the joint probability distributions we obtained in a Merton and Black-Cox setting to evaluate and compare tail dependence in dimensions two and three. We interpreted tail dependence as a conditional probability to measure the likelihood of multiple defaults. As a result of our initial parameters and the use of 107 paths, there was a higher tail dependence in a Black-Cox setting than in a Merton setting for =0.3 and =0.9 and values of debt $[37, 65] in both dimensions two and three. Note that using =0.9 requires an increased number of paths to accurately approximate tail dependence for values of debt less than $37. Also we observed that tail dependence is decreasing faster in a Merton setting than in a Black-Cox setting, however both were tending towards 0. As a result, we concluded that there was less likelihood of multiple companies defaulting for higher values of debt in a Black-Cox setting than in a Merton setting. Additionally, we used the joint probability distribution in a Merton and Black-Cox setting to analyze portfolio value in four dimensions. Initially, we defined 2 sets of covariance parameters and values of debt to simulate "normal" and "crisis" market conditions. In a "normal" market, we defined i =0.2, µ=0.04, =0.3 Di =$70 and ai =0.25. Our "crisis" market parameters were 1 =0.25, 2 =0.20, 3 =0.15 and 4 =0.10 with =0.9, µi =0.04, Di =$90 and a1 =-0.0026, a2 =0.0582, a3 =0.2140 and a4 =0.7304. In addition to a comparison 72

CHAPTER 6. CONCLUSION of these covariance parameters, we utilized two definitions of portfolio value; credit and market portfolio. We modeled the probability distribution of portfolio value as well as analyzed the joint probability distribution of defaults. We defined a credit portfolio to allocate asset weight to the portfolio value in the event of non-default. As a result in both "normal" and "crisis" market conditions, there was a higher probability of portfolios valued at $1 in a Merton setting than in a Black-Cox setting, implying a higher joint probability of non-default. We also observed a higher probability of portfolios valued at $0 in a Black-Cox setting than in a Merton setting, implying a higher joint probability of all companies defaulting in a Black-Cox setting than in a Merton setting. A market portfolio was defined using both the allocation of each asset as well as the asset value. The resulting portfolio in a Merton setting had no upper bound of portfolio value, however in a Black-Cox setting, portfolio value was contained within $[0, 100] since each asset value has a maximum value of $100. Additionally, under both "normal" and "crisis" market conditions, the distribution of market portfolio value was positively skewed in a Merton setting and negatively skewed in a Black-Cox setting. Lastly, we computed and compared the value at risk associated with our credit and market portfolios we defined in a Merton and Black-Cox setting. Using our credit portfolio, with a 1% and 5% probability, the potential loss in each setting was similar under both "normal" and "crisis" market conditions. There was also a 10% probability of a larger potential loss in a Black-Cox setting than in a Merton setting under both sets of market conditions; "normal" and "crisis". This implies greater risk associated with credit portfolios in a Black-Cox setting than in a Merton setting in the mid-tail of our distribution. For portfolio value defined using a market portfolio, there was less potential loss with a 5% and 10% probability than a 1% probability under both "normal" and "crisis" market conditions in a Merton and Black-Cox setting. Implying there is less risk associated with our portfolios in the mid-tail of our distribution. Therefore, there is greater risk farther into the tail of our distribution in both a Merton and Black-Cox setting under both "crisis" and "normal" market conditions. In conclusion, we used 2 structural definitions of default; Merton (see[10]) and Black-Cox (see[3]), to analyze tail dependence, portfolio value and value at risk using the joint probability distribution of defaults. We focused on results in dimensions two, three and four as well as an initial set of parameters that are realistic market conditions.

73

Appendix A

Four Dimensional Merton setting
We extend our analysis of the joint probability distribution in a Merton setting in four dimensions. The following appendices describe the results of our simulated and analytical approaches to evaluating the joint probability of defaults as well as the error associated with 104 and 107 paths. We outline the results simulated using 104 and 107 paths and Si =100, i = 0.2, µi =0.04, ij =0.3 and Di =90.

A.1

Joint Probability Distribution
1 Default MC AN Company 0.0748 0.0764 0.0773 0.0762 0.0744 0.0762 0.0748 0.0763 2, 4 3, 4 0.0763 2, 3 0.0762 1, 4 0.0763 1, 3 0.0762 1, 2 104 107 10
4

2 Defaults MC paths 0.0304 0.0309 0.0302 0.0309 0.0297 0.0309 0.0302 0.0309 0.0330 0.0309 0.0310 0.0309 0.0309 0.0309 0.0309 2, 3, 4 0.0309 1, 3, 4 0.0309 1, 2, 4 0.0309 AN Company 1, 2, 3

3 Defaults MC paths 104 107 10
4

4 Defaults AN Company 0.0225 0.0225 0.0225 0.0225 1, 2, 3, 4 104 107 MC paths 0.0286 0.0289 0.0289 AN Company

No Default MC paths 104 107 0.3975 0.3906 0.3906 AN

Company 1 2 3 4

paths 104 107 10
4

0.0217 0.0226 0.0240 0.0225 0.0223 0.0226 0.0231 0.0225

107 104 107 104 107

107 104 107 104 107 104 107 10
4

107 104 107 104 107

107

Table A.1: The probability distribution of defaults in a four dimensional Merton setting

A.2

Error

In the following table, we compare the error of our simulated joint probability distributions obtained using 104 and 107 paths.

74

APPENDIX A. FOUR DIMENSIONAL MERTON SETTING
1 Default Company 1 2 3 4 paths 104 10
7

A.2. ERROR
4 Defaults Company paths 104 10
7

2 Default Company 1.837% 0.2624% 1.3106% 0.13106% 2.3622% 0% 1.9659% 0% 2, 4 3, 4 2, 3 1, 4 1, 3 1, 2 paths 104 10
7

3 Defaults Company 1.6181% 0% 2.265% 0% 3.8834% 0 2.2653% 0% 6.796% 0% 0.323% 0% 2, 3, 4 1, 3, 4 1, 2, 4 1, 2, 3 paths 104 10
7

No Default Company 1.0380% 0% paths 104 107 0.0176% 0%

3.555% 0.444% 6.666% 0 0.888% 0.444% 2.666% 0%

1, 2, 3, 4

104 107 104 107 10
4

104 107 104 107 10
4

104 107 104 107 104 107

107

107 104 107 104 107

Table A.2: Error of the joint probability distribution in a four dimensional Merton setting

75

Appendix B

Four Dimensional Black-Cox setting
These appendices describe the four dimensional joint probability distribution in a Black-Cox setting. We rely on a simulated Monte Carlo approach to approximate the joint probability of defaults, using 104 , 107 and 107.5  paths. Our results are simulated in a Black-Cox setting using the same parameters as outlined in Appendix A.

B.1

Joint Probability Distribution
1 Default MC 2 Defaults MC Company 0.0497 0.0520 0.0522 0.0517 0.0521 0.0522 0.0499 0.0521 0.0521 0.0517 0.0520 0.0521 2, 4 2, 3 1, 4 1, 3 1, 2 104 107 107.5  104 107 107.5  104 107 107.5  104 107 107.5  104 107 3, 4 107.5  104 107 107.5  paths 0.0482 0.0443 0.0443 0.0418 0.0443 0.0443 0.0427 0.0443 0.0442 0.0469 0.0441 0.0443 0.0452 0.0442 0.0443 0.0420 0.0442 0.0443 2, 3, 4 1, 3, 4 1, 2, 4 Company 1, 2, 3 104 107 107.5  104 107 107.5  104 107 107.5  104 107 107.5  3 Defaults MC paths 0.0615 0.0638 0.0637 0.0660 0.0637 0.0638 0.0651 0.0639 0.0638 0.0657 0.0639 0.0637 Company 1, 2, 3, 4 104 107 107.5  4 Defaults MC paths 0.1662 0.1647 0.1645 Company 104 107 107.5  No Default MC paths 0.1607 0.1603 0.1603

Company 1

paths 104 107 107.5  104 107

2

3

107.5  104 107

4

107.5  104 107 107.5 

Table B.1: The probability distribution of defaults in a four dimensional Black-Cox setting

76

APPENDIX B. FOUR DIMENSIONAL BLACK-COX SETTING

B.2. ERROR

B.2

Error

The following table describes the error obtained from our simulated Monte Carlo approaches using 104 and 107 . We rely on a comparison between the joint probability distribution using 107.5  paths.
1 Default Company 1 2 3 4 paths 104 107 104 107 10
4

2 Defaults Company 4.7892% 0.3831% 0.9578% 0.1915% 4.222% 0% 0.7677% 0.1919% 2, 4 3, 4 2, 3 1, 4 1, 3 1, 2 paths 104 107 104 107 10
4

3 Defaults Company 8.8036% 0% 5.6433% 0% 3.3936% 0.2262% 5.8690% 0.4514% 2.0316% 0.2257% 5.1918% 0.2257% 2, 3, 4 1, 3, 4 1, 2, 4 1, 2, 3 paths 104 107 104 107 104 107 104 107 3.4536% 0.1569% 3.4482% 0.1567% 2.1978% 0.3139% 3.1397% 0.31397% 1, 2, 3, 4

4 Defaults Company paths 104 107 1.0334% 0.1215%

No Default Company paths 104 107 0.3762% 0%

107 104 107

107 104 107 104 107 104 107

Table B.2: Error of the joint probability distribution in a four dimensional Black-Cox setting

77

Appendix C

Comparison between Structural Models
The following tables expands on our analysis of Section 4.1 in four dimensions. We compare the error of the joint probability distribution in a Merton and Black-Cox setting using 107 paths. Additionally, we outline the ratio comparison between the joint probabilities of default in both settings.

C.1

Error

We expand on the comparison of error in four dimensions using a simulated approach and 107 paths in a Merton and Black-Cox setting. The following table compares the error of the joint probability distribution in each structural model.
1 Default Company 1 2 3 4 Merton BC Merton BC Merton BC Merton BC 0.2624% 0.3831% 0.13106% 0.1915% 0% 0% 0% 0.1919% 2, 4 3, 4 2, 3 1, 4 1, 3 Company 1, 2 Merton BC Merton BC Merton BC Merton BC Merton BC Merton BC 0% 0% 0% 0% 0% 0.2262% 0% 0.4514% 0% 0.2257% 0% 0.2257% 2, 3, 4 1, 3 ,4 1, 2, 4 2 Defaults Company 1, 2, 3 Merton BC Merton BC Merton BC Merton BC 0.444% 0.1569% 0% 0.1567% 0.444% 0.3139% 0% 0.3139% 3 Defaults Company 1, 2, 3, 4 Merton BC 0% 0.1215% 4 Defaults No Default Company Merton BC 0% 0%

Table C.1: Comparison of error in a four dimensional setting

C.2

Ratio

The following table describes the ratio comparison between our simulated joint probabilities of default in a Merton and Black-Cox setting.

78

APPENDIX C. COMPARISON BETWEEN STRUCTURAL MODELS Ratio 1 Default Company 1 2 3 4 0.680 0.683 0.683 0.6815 2 Defaults Company 1, 2 1, 3 1, 4 2, 3 2, 4 3, 4 1.433 1.433 1.4336 1.4336 1.430 1.4306 3 Defaults Company 1, 2, 3 1, 2, 4 1, 3, 4 2, 3, 4 2.823 2.8311 2.8274 2.840 4 Defaults Company 1, 2, 3, 4 5.6989 No Default Company 0.27214

C.2. RATIO

Table C.2: Ratio comparison in a four dimensional setting

79

Appendix D

Joint Probabiliy Distribution under "Normal" Market Conditions
Merton setting 1 Default Company 1 2 3 4 Merton 0.02202 0.02208 0.02215 0.02209 2 Defaults Company 1, 2 1, 3 1, 4 2, 3 2, 4 3, 4 Merton 0.00206 0.00209 0.00209 0.00208 0.00208 0.00206 3 Defaults Company 1, 2, 3 1, 2, 4 1, 3, 4 2, 3, 4 Merton 0.00044 0.00043 0.00044 0.00044 4 Defaults Company 1, 2, 3, 4 Merton 0.00017 No Default Company Merton 0.8972

Table D.1: The probability distribution of defaults in a four dimensional "normal" Merton setting

Black-Cox setting 1 Default Company 1 2 3 4 Black-Cox 0.03709 0.03704 0.03704 0.03699 2 Defaults Company 1, 2 1, 3 1, 4 2, 3 2, 4 3, 4 Black-Cox 0.00505 0.00510 0.00505 0.00505 0.00507 0.00507 3 Defaults Company 1, 2, 3 1, 2, 4 1, 3, 4 2, 3, 4 Black-Cox 0.00140 0.00142 0.00142 0.00143 4 Defaults Company 1, 2, 3, 4 Black-Cox 0.00072 No Default Company Black-Cox 0.81494

Table D.2: The probability distribution of defaults in a four dimensional "normal" Black-Cox setting

80

Appendix E

Joint Probability Distribution under "Crisis" Market Conditions
Merton setting 1 Default Company 1 2 3 4 Merton 0.07829 0.03030 0.00613 0.0001 2 Defaults Company 1, 2 1, 3 1, 4 2, 3 2, 4 3, 4 Merton 0.06722 0.01563 0.00065 0.00593 0.00023 0.00006 3 Defaults Company 1, 2, 3 1, 2, 4 1, 3, 4 2, 3, 4 Merton 0.08363 0.00476 0.00093 0.00028 4 Defaults Company 1, 2, 3, 4 Merton 0.07304 No Default Company Merton 0.6327

Table E.1: The probability distribution of defaults in a four dimensional "crisis" Merton setting

Black-Cox setting 1 Default Company 1 2 3 4 Black-Cox 0.11242 0.03181 0.00477 0.00006 2 Defaults Company 1, 2 1, 3 1, 4 2, 3 2, 4 3, 4 Black-Cox 0.13227 0.00006 0.00052 0.00578 0.00015 0.00003 3 Defaults Company 1, 2, 3 1, 2, 4 1, 3, 4 2, 3, 4 Black-Cox 0.19045 0.00623 0.00086 0.00019 4 Defaults Company 1, 2, 3, 4 Black-Cox 0.17398 No Default Company Black-Cox 0.32030

Table E.2: The probability distribution of defaults in a four dimensional "crisis" Black-Cox setting

81

Appendix F

Numerical Code in Two Dimensions
The following MATLAB® code evaluates the joint probability distribution in a two dimensional Merton setting using the multivariate normal with a function called mvncdf

% Joint Probability Distribution in a 2 dimensional Merton Setting format long n=2 ; T=1; r=0.04; rho=0.3; sigma(1)=0.2; sigma(2)=0.2; D(1)=90; %debt D(2)=90; S_0(1)= 100 ;% asset value of company 1 at time 0 S_0(2)= 100 ;% company 2 for i=1:n mean(i)= log(S_0(i)) + (r-0.5*(sigma(i)).^2)*T; end for i=1:n m(i)= sqrt(T)*sigma(i) ; end m; A=diag(m) ; for i=1:n for j=1:n if i==j B(i,j)=1 ; else B(i,j)=rho ; end end end COV=A*B*A ; % probability of default neginf=-10; posinf=10; De=90; for i=1:n

82

APPENDIX F. NUMERICAL CODE IN TWO DIMENSIONS

F.1. MERTON SETTING

XL(i)=(log(D(i))); end newXL=XL ; for i=1:n XU(i)=posinf; end newXU=XU ; x=n*ones(1,n); P_n=zeros(x); port_out=zeros(x) ; for i=1:n for j=1:n for k=1:n XU=newXU ; XL=newXL ; XL(i)=neginf; XL(j)=neginf; XU(j)=log(D(j)); XU(i)=log(D(i)); P_n(i,j)=mvncdf( XL, XU , mean, COV ) ; end end end % 1 company defaults for i=1:n Prob(i)=P_n(i,i); end % 2 companies default for i=1:n for j=i+1:n Prob(3)=P_n(i,j); end end A=sum(Prob); Prob(4)=1-A;% prob of non-default Prob

F.1

Merton Setting

We utilize a Monte Carlo simulation in two dimensions to approximate the joint probability distribution of defaults in a Merton setting.

function result = verfiyMerton2(S_ini,r,SIGMA,M,T,steps,dimension) delta = 1/250; CHOL = chol(SIGMA); S=cell(1,dimension); for i = 1:dimension S{i}=zeros(steps,2); S{i}(:,1)=S_ini(i); end for cnt_grid = 1:(T*1/delta)

83

APPENDIX F. NUMERICAL CODE IN TWO DIMENSIONS

F.2. BLACK-COX SETTING

W=randn(steps,dimension)*CHOL; % makes 1:250 W that contain step for cnt_stock = 1:dimension S{cnt_stock}(:,2)=S{cnt_stock}(:,1).* ... exp((r-SIGMA(cnt_stock,cnt_stock)/2)*delta + sqrt(delta)*W(:,cnt_stock)) S{cnt_stock}(:,1)=S{cnt_stock}(:,2); end end ind=cell(1,4); for i = 1:4 ind{i}=ones(steps,1); end for c=1:4 if c==1 % no default for cnt_n=1:dimension ind{c} = ind{c}.*(M(cnt_n) < S{cnt_n}(:,2)); end elseif c==2 % all companies default for cnt_n=1:dimension ind{c} = ind{c}.*(M(cnt_n) > S{cnt_n}(:,2)); end elseif c==3 % company 2 default and company 1 does not for cnt_n=1:dimension if cnt_n==1 ind{c} = ind{c}.*(M(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(M(cnt_n) > S{cnt_n}(:,2)); end end elseif c==4 % company 1 default and company 2 does not for cnt_n=1:dimension if cnt_n==2 ind{c} = ind{c}.*(M(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(M(cnt_n) > S{cnt_n}(:,2)); end end end end for p=1:4 result(p) = mean(ind{p}); end

;

F.2

Black-Cox Setting

The following code approximates the joint probability distribution of defaults in a Black-Cox setting.

function result2 = BlackCox2(S_ini,r,SIGMA,M,T,steps,dimension)

84

APPENDIX F. NUMERICAL CODE IN TWO DIMENSIONS

F.2. BLACK-COX SETTING

delta = 1/250 ; % number points 2 measured at CHOL = chol(SIGMA); S=cell(1,dimension); for i = 1:dimension S{i}=zeros(steps,2); S{i}(:,1)=S_ini(i); end ind=cell(1,4); ind{1}=ones(steps,1); for i = 2:4 ind{i}=zeros(steps,1); end ind1=cell(1,4); for i=1:3 % start ind1 as 1 and change to 0 when company defaults ind1{i}=ones(steps,1); end for cnt_grid = 1:(T*1/delta) W=randn(steps,dimension)*CHOL; % makes 1:250 W that contain step for cnt_stock = 1:dimension S{cnt_stock}(:,2)=S{cnt_stock}(:,1).* ... exp((r-SIGMA(cnt_stock,cnt_stock)/2)*delta + sqrt(delta)*W(:,cnt_stock)) S{cnt_stock}(:,1)=S{cnt_stock}(:,2); end for cnt_n=1:dimension % no default ind{1} = ind{1}.*(M(cnt_n) < S{cnt_n}(:,2)); %record company cnt_n default ind1{cnt_n} = ind1{cnt_n}.*(M(cnt_n) < S{cnt_n}(:,2)); end end for c=2:4 if c==2 % all company default ind{c} = ( (ind1{1}==0) + (ind1{2}==0) == 2 ) ; elseif c==3 % company 1 default and company 2 does not ind{c} = ( (ind1{1}==0) + (ind1{2}==1) == 2 ) ; elseif c==4 % company 2 default and company 1 doesnt ind{c} = ( (ind1{1}==1) + (ind1{2}==0) == 2 ) ; end end for p=1:4 result2(p) = mean(ind{p}); end

;

85

Appendix G

Numerical Code in Three Dimensions
The following MATLAB® codes approximate the joint probability distribution of defaults in three dimensions in a Merton and Black-Cox setting.

G.1

Merton Setting

function result = verfiyMerton3(S_ini,r,SIGMA,K,T,steps,dimension) delta = 1/250; CHOL = chol(SIGMA); S=cell(1,dimension); for i = 1:dimension S{i}=zeros(steps,2); S{i}(:,1)=S_ini(i); end for cnt_grid = 1:(T*1/delta) W=randn(steps,dimension)*CHOL; % makes 1:250 W that contain step for cnt_stock = 1:dimension S{cnt_stock}(:,2)=S{cnt_stock}(:,1).* ... exp((r-SIGMA(cnt_stock,cnt_stock)/2)*delta + sqrt(delta)*W(:,cnt_stock)) S{cnt_stock}(:,1)=S{cnt_stock}(:,2); end end ind=cell(1,8); for i = 1:8 ind{i}=ones(steps,1); end for c=1:8 if c==1 % no default for cnt_n=1:dimension ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); end

;

86

APPENDIX G. NUMERICAL CODE IN THREE DIMENSIONS

G.1. MERTON SETTING

elseif c==2 % all companies default for cnt_n=1:dimension ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end elseif c==3 % company 2 and 3 default and company 1 does for cnt_n=1:dimension if cnt_n==1 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end elseif c==4 % company 1 and 3 default and company 2 does for cnt_n=1:dimension if cnt_n==2 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end elseif c==5 % company 2 and 1 default and company 3 does for cnt_n=1:dimension if cnt_n==3 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end elseif c==6 % company 2 default and companies 1 and 3 do for cnt_n=1:dimension if cnt_n==1 || cnt_n==3 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end elseif c==7 % company 1 default companies 2 and 3 do not for cnt_n=1:dimension if cnt_n==2 || cnt_n==3 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end elseif c==8 %company 3 default companies 1 and 2 do not for cnt_n=1:dimension if cnt_n==1 || cnt_n==2 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2));

not

not

not

not

87

APPENDIX G. NUMERICAL CODE IN THREE DIMENSIONS

G.2. BLACK-COX SETTING

end end end for p=1:8 result(p) = mean(ind{p}); end end

G.2

Black-Cox Setting

function result2 = BlackCox3(S_ini,r,SIGMA,M,T,steps,dimension) delta = 1/250 ; CHOL = chol(SIGMA); S=cell(1,dimension); for i = 1:dimension S{i}=zeros(steps,2); S{i}(:,1)=S_ini(i); end ind=cell(1,8); ind{1}=ones(steps,1); for i = 2:8 ind{i}=zeros(steps,1); end ind1=cell(1,8); for i=1:3 % start ind1 as 1 and change to 0 when company defaults ind1{i}=ones(steps,1); end for cnt_grid = 1:(T*1/delta) W=randn(steps,dimension)*CHOL; % makes 1:250 W that contain step for cnt_stock = 1:dimension S{cnt_stock}(:,2)=S{cnt_stock}(:,1).* ... exp((r-SIGMA(cnt_stock,cnt_stock)/2)*delta + sqrt(delta)*W(:,cnt_stock)) S{cnt_stock}(:,1)=S{cnt_stock}(:,2); end for cnt_n=1:dimension % no default ind{1} = ind{1}.*(M(cnt_n) < S{cnt_n}(:,2)); %record company cnt_n default ind1{cnt_n} = ind1{cnt_n}.*(M(cnt_n) < S{cnt_n}(:,2)); end end for c=2:8 if c==2 % all companies default ind{c} = ( (ind1{1}==0) + (ind1{2}==0) + (ind1{3}==0) == 3 ) ; elseif c==3 % company 1 default and company 2,3 does not ind{c} = ( (ind1{1}==0) + (ind1{2}==1) + (ind1{3}==1) == 3 ) ;

;

88

APPENDIX G. NUMERICAL CODE IN THREE DIMENSIONS

G.2. BLACK-COX SETTING

elseif c==4 % company 2 default and company 1,3 does not ind{c} = ( (ind1{1}==1) + (ind1{2}==0) + (ind1{3}==1) == 3 ) ; elseif c==5 %company 3 default and company 1,2 does not ind{c} = ( (ind1{1}==1) + (ind1{2}==1) + (ind1{3}==0) == 3 ) ; elseif c==6 % company 1 and 2 default and company 3 does not ind{c} =( (ind1{1}==0) + (ind1{2}==0) + (ind1{3}==1) == 3 ) ; elseif c==7 % company 1 and 3 default and company 2 does not ind{c} = ( (ind1{1}==0) + (ind1{2}==1) + (ind1{3}==0) == 3 ) ; elseif c==8 % company 2 and 3 default and company 1 does not ind{c} = ( (ind1{1}==1) + (ind1{2}==0) + (ind1{3}==0) == 3 ) ; end end for p=1:8 result2(p) = mean(ind{p}); end

89

Appendix H

Numerical Code in Four Dimensions
In this appendix, the following MATLAB® codes approximate the joint probability distribution of defaults in a Merton and Black-Cox setting, as well as credit and market portfolio value in each setting.

H.1

Merton Setting

function result = verfiyMerton4(S_ini,r,SIGMA,K,T,steps,dimension) delta = 1/250; CHOL = chol(SIGMA); S=cell(1,dimension); for i = 1:dimension S{i}=zeros(steps,2); S{i}(:,1)=S_ini(i); end for cnt_grid = 1:(T*1/delta) W=randn(steps,dimension)*CHOL; % makes 1:250 W that contain step for cnt_stock = 1:dimension S{cnt_stock}(:,2)=S{cnt_stock}(:,1).* ... exp((r-SIGMA(cnt_stock,cnt_stock)/2)*delta + sqrt(delta)*W(:,cnt_stock)) S{cnt_stock}(:,1)=S{cnt_stock}(:,2); end end ind=cell(1,16); for i = 1:16 ind{i}=ones(steps,1); end for c=1:16 if c==1 % no default for cnt_n=1:dimension ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); end

;

90

APPENDIX H. NUMERICAL CODE IN FOUR DIMENSIONS

H.1. MERTON SETTING

elseif c==2 % all companies default for cnt_n=1:dimension ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end elseif c==3 % company 1 default and company 2,3,4 for cnt_n=1:dimension if cnt_n==2 || cnt_n==3 || cnt_n==4 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end elseif c==4 % company 2 default and company 1,3,4 for cnt_n=1:dimension if cnt_n==1 || cnt_n==3 || cnt_n==4 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end elseif c==5 % company 3 default and company 1,2,4 for cnt_n=1:dimension if cnt_n==1 || cnt_n==2 || cnt_n==4 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end elseif c==6 % company 4 default and company 1,2,3 for cnt_n=1:dimension if cnt_n==1 || cnt_n==2 || cnt_n==3 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end elseif c==7 % company 1 and 2 default and company for cnt_n=1:dimension if cnt_n==3 || cnt_n==4 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end elseif c==8 % company 1 and 3 default and company for cnt_n=1:dimension if cnt_n==1 || cnt_n==4 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2));

does not

does not

does not

does not

3,4 does not

2,4 does not

91

APPENDIX H. NUMERICAL CODE IN FOUR DIMENSIONS

H.1. MERTON SETTING

end end elseif c==9 % company 1 and 4 default and company 2,3 does not for cnt_n=1:dimension if cnt_n==2 || cnt_n==3 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end elseif c==10 % company 2 and 3 default and company 1,4 does not for cnt_n=1:dimension if cnt_n==1 || cnt_n==4 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end elseif c==11 % company 2 and 4 default and company 1,3 does not for cnt_n=1:dimension if cnt_n==1 || cnt_n==3 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end elseif c==12 % company 3 and 4 default and company 1,2 does not for cnt_n=1:dimension if cnt_n==1 || cnt_n==2 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end elseif c==13 % company 1,2,3 default and company 4 does not for cnt_n=1:dimension if cnt_n==4 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end elseif c==14 % company 1,2,4 default and company 3 does not for cnt_n=1:dimension if cnt_n==3 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end

92

APPENDIX H. NUMERICAL CODE IN FOUR DIMENSIONS

H.1. MERTON SETTING

elseif c==15 % company 1,3,4 default and company 2 does not for cnt_n=1:dimension if cnt_n==2 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end elseif c==16 % company 2,3,4 default and company 1 does not for cnt_n=1:dimension if cnt_n==1 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end end for p=1:16 result(p) = mean(ind{p}); end end

H.1.1

Credit Portfolio

% credit portfolio Merton setting in 4 dimensions format short S = 100*ones(4,1); n=4 ; T=1; r=0.04; rho=0.9; sigma(1)=0.25; sigma(2)=0.20; sigma(3)=0.15; sigma(4)=0.1; %portfolio weights a(1)=-0.0026; a(2)=0.0582; a(3)=0.2140; a(4)=0.7304; for i=1:n m(i)= sqrt(T)*sigma(i) ; end m; A=diag(m) ; for i=1:n for j=1:n if i==j B(i,j)=1 ; else B(i,j)=rho ; end end end SIGMA=A*B*A; K=[60;60;60;60]; % debts

93

APPENDIX H. NUMERICAL CODE IN FOUR DIMENSIONS

H.1. MERTON SETTING

dimension=4; steps = 10000000 ; % paths S_ini=100*ones(4,1); delta = 1/250; CHOL = chol(SIGMA); S=cell(1,dimension); for i = 1:dimension S{i}=zeros(steps,2); S{i}(:,1)=S_ini(i); end for cnt_grid = 1:(T*1/delta) W=randn(steps,dimension)*CHOL; % makes 1:250 W that contain step# paths, 3 dimensions for cnt_stock = 1:dimension S{cnt_stock}(:,2)=S{cnt_stock}(:,1).* ... exp((r-SIGMA(cnt_stock,cnt_stock)/2)*delta + sqrt(delta)*W(:,cnt_stock)); S{cnt_stock}(:,1)=S{cnt_stock}(:,2); end end ind=cell(1,16); for i = 1:16 ind{i}=ones(steps,1); end for c=1:16 if c==1 % no default for cnt_n=1:dimension ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); end elseif c==2 % all companies default for cnt_n=1:dimension ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end elseif c==3 % company 1 default and company 2,3,4 does not for cnt_n=1:dimension if cnt_n==2 || cnt_n==3 || cnt_n==4 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end elseif c==4 % company 2 default and company 1,3,4 does not for cnt_n=1:dimension if cnt_n==1 || cnt_n==3 || cnt_n==4 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end elseif c==5 % company 3 default and company 1,2,4 does not for cnt_n=1:dimension if cnt_n==1 || cnt_n==2 || cnt_n==4

94

APPENDIX H. NUMERICAL CODE IN FOUR DIMENSIONS

H.1. MERTON SETTING

ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end elseif c==6 % company 4 default and company 1,2,3 does not for cnt_n=1:dimension if cnt_n==1 || cnt_n==2 || cnt_n==3 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end elseif c==7 % company 1 and 2 default and company 3,4 does not for cnt_n=1:dimension if cnt_n==3 || cnt_n==4 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end elseif c==8 % company 1 and 3 default and company 2,4 does not for cnt_n=1:dimension if cnt_n==2 || cnt_n==4 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end elseif c==9 % company 1 and 4 default and company 2,3 does not for cnt_n=1:dimension if cnt_n==2 || cnt_n==3 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end elseif c==10 % company 2 and 3 default and company 1,4 does not for cnt_n=1:dimension if cnt_n==1 || cnt_n==4 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end elseif c==11 % company 2 and 4 default and company 1,3 does not for cnt_n=1:dimension if cnt_n==1 || cnt_n==3 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else

95

APPENDIX H. NUMERICAL CODE IN FOUR DIMENSIONS

H.1. MERTON SETTING

ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end elseif c==12 % company 3 and 4 default and company for cnt_n=1:dimension if cnt_n==1 || cnt_n==2 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end elseif c==13 % company 1,2,3 default and company 4 for cnt_n=1:dimension if cnt_n==4 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end elseif c==14 % company 1,2,4 default and company 3 for cnt_n=1:dimension if cnt_n==3 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end elseif c==15 % company 1,3,4 default and company 2 for cnt_n=1:dimension if cnt_n==2 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end elseif c==16 % company 2,3,4 default and company 1 for cnt_n=1:dimension if cnt_n==1 ind{c} = ind{c}.*(K(cnt_n) < S{cnt_n}(:,2)); else ind{c} = ind{c}.*(K(cnt_n) > S{cnt_n}(:,2)); end end end end PORT{1}=(a(1)+a(2)+a(3)+a(4))*ind{1}; PORT{2}=0*ind{2}; %1 defaults PORT{3}=(a(2)+a(3)+a(4))*ind{3}; PORT{4}=(a(1)+a(3)+a(4))*ind{4}; 1,2 does not

does not

does not

does not

does not

96

APPENDIX H. NUMERICAL CODE IN FOUR DIMENSIONS

H.1. MERTON SETTING

PORT{5}=(a(1)+a(2)+a(4))*ind{5}; PORT{6}=(a(1)+a(2)+a(3))*ind{6}; %2 defaults PORT{7}=(a(3)+a(4))*ind{7}; PORT{8}=(a(2)+a(4))*ind{8}; PORT{9}=(a(2)+a(3))*ind{9}; PORT{10}=(a(1)+a(4))*ind{10}; PORT{11}=(a(1)+a(3))*ind{11}; PORT{12}=(a(1)+a(2))*ind{12}; % 3 defaults PORT{13}=a(4)*ind{13}; PORT{14}=a(3)*ind{14}; PORT{15}=a(2)*ind{15}; PORT{16}=a(1)*ind{16}; for i=1:steps value(i)=PORT{1}(i) + PORT{2}(i) + PORT{3}(i)+PORT{4}(i)+PORT{5}(i) +PORT{6}(i)+PORT{7}(i)+PORT{8}(i) +PORT{9}(i)+PORT{10}(i)+PORT{11}(i)+PORT{12}(i)+PORT{13}(i)+PORT{14}(i)+PORT{15}(i)+PORT{16}(i); end x = value ; nbins=[-0.0026, 0, 0.0556, 0.0582, 0.2114, 0.2140 ,0.2696,0.2772,0.7278, 0.7304,0.786,0.7886, 0.9418, 0.9444, 1, 1.0026] ; [counts,centers] = hist(x,nbins) hist(x,nbins)

H.1.2

Market Portfolio

% market portfolio Merton setting in 4 dimensions format long S = 100*ones(4,1); n=4; T=1; r=0.04; rho=0.9; sigma(1)=0.25; sigma(2)=0.20; sigma(3)=0.15; sigma(4)=0.10; %portfolio weights a(1)=-0.0026; a(2)=0.0582; a(3)=0.2140; a(4)=0.7304; for i=1:n m(i)= sqrt(T)*sigma(i) ; end m; A=diag(m) ; for i=1:n for j=1:n if i==j B(i,j)=1 ; else B(i,j)=rho ; end end end

97

APPENDIX H. NUMERICAL CODE IN FOUR DIMENSIONS

H.2. BLACK-COX SETTING

SIGMA=A*B*A ; M=[90;90;90;90]; dimension=4; steps = 10000000; % paths S_ini=100*ones(4,1); delta = 1/250; % 1/250 % number points measured a t CHOL = chol(SIGMA); S=cell(1,dimension); for i = 1:dimension S{i}=zeros(steps,2); S{i}(:,1)=S_ini(i); end for i=1:steps minS1(i)=S{1}(i,1); minS2(i)=S{2}(i,1); minS3(i)=S{3}(i,1); minS4(i)=S{4}(i,1); end for cnt_grid = 1:(T*1/delta) W=randn(steps,dimension)*CHOL; % makes 1:250 W that contain s t e p for cnt_stock = 1:dimension S{cnt_stock}(:,2)=S{cnt_stock}(:,1).* ... exp((r-SIGMA(cnt_stock,cnt_stock)/2)*delta + sqrt(delta)*W(:,cnt_stock)) ; S{cnt_stock}(:,1)=S{cnt_stock}(:,2); end end MINS{1}=S{1}(:,2); MINS{2}=S{2}(:,2); MINS{3}=S{3}(:,2); MINS{4}=S{4}(:,2); %portfolio value VALUESTORE{1}=a(1)*MINS{1}; VALUESTORE{2}=a(2)*MINS{2}; VALUESTORE{3}=a(3)*MINS{3}; VALUESTORE{4}=a(4)*MINS{4}; for i=1:steps PORT(i)=VALUESTORE{1}(i) + VALUESTORE{2}(i) + VALUESTORE{3}(i)+ VALUESTORE{4}(i); end hist(PORT,10) [counts,centers] = hist(PORT,10)

H.2

Black-Cox Setting

function result2 = BlackCox4(S_ini,r,SIGMA,M,T,steps,dimension,a) delta = 1/250 ; CHOL = chol(SIGMA); S=cell(1,dimension); for i = 1:dimension

98

APPENDIX H. NUMERICAL CODE IN FOUR DIMENSIONS

H.2. BLACK-COX SETTING

S{i}=zeros(steps,2); S{i}(:,1)=S_ini(i); end ind=cell(1,16); ind{1}=ones(steps,1); for i = 2:16 ind{i}=zeros(steps,1); end ind1=cell(1,16); for i=1:4 % start ind1 as 1 and change to 0 when company defaults ind1{i}=ones(steps,1); end for cnt_grid = 1:(T*1/delta) W=randn(steps,dimension)*CHOL; % makes 1:250 W that contain step for cnt_stock = 1:dimension S{cnt_stock}(:,2)=S{cnt_stock}(:,1).* ... exp((r-SIGMA(cnt_stock,cnt_stock)/2)*delta + sqrt(delta)*W(:,cnt_stock)) S{cnt_stock}(:,1)=S{cnt_stock}(:,2); end for cnt_n=1:dimension % no default ind{1} = ind{1}.*(M(cnt_n) < S{cnt_n}(:,2)); %record company cnt_n default ind1{cnt_n} = ind1{cnt_n}.*(M(cnt_n) < S{cnt_n}(:,2)); end end for c=2:16 if c==2 % all companies default ind{c} = ( (ind1{1}==0) + (ind1{2}==0) + (ind1{3}==0) + (ind1{4}==0) elseif c==3 % company 1 default and company 2,3,4 does not ind{c} = ( (ind1{1}==0) + (ind1{2}==1) + (ind1{3}==1) + (ind1{4}==1) elseif c==4 % company 2 default and company 1,3,4 does not ind{c} = ( (ind1{1}==1) + (ind1{2}==0) + (ind1{3}==1) + (ind1{4}==1) elseif c==5 %company 3 default and company 1,2,4 does not ind{c} = ( (ind1{1}==1) + (ind1{2}==1) + (ind1{3}==0) + (ind1{4}==1) elseif c==6 %compnay 4 defaults and company 1,2,3 does not ind{c} = ( (ind1{1}==1) + (ind1{2}==1) + (ind1{3}==1) + (ind1{4}==0) elseif c==7 % company 1 and 2 default and company 3,4 does not ind{c} = ( (ind1{1}==0) + (ind1{2}==0) + (ind1{3}==1) + (ind1{4}==1) elseif c==8 % company 1 and 3 default and company 2,4 does not ind{c} = ( (ind1{1}==0) + (ind1{2}==1) + (ind1{3}==0) + (ind1{4}==1) elseif c==9 % company 1 and 4 default and company 2,3 does not ind{c} = ( (ind1{1}==0) + (ind1{2}==1) + (ind1{3}==1) + (ind1{4}==0) elseif c==10 % company 2 and 3 default and company 1,4 does not ind{c} = ( (ind1{1}==1) + (ind1{2}==0) + (ind1{3}==0) + (ind1{4}==1) elseif c==11 %company 2 and 4 default and company 1,3 does not ind{c} = ( (ind1{1}==1) + (ind1{2}==0) + (ind1{3}==1) + (ind1{4}==0) elseif c==12 %company 3 and 4 default and company 1,2 does not ind{c} = ( (ind1{1}==1) + (ind1{2}==1) + (ind1{3}==0) + (ind1{4}==0)

;

== 4 ) ; == 4 ) ; ==4 ) ; == 4 ) ; == 4 ) ; == 4 ) ; == 4 ) ; == 4 ) ; == 4 ) ; == 4 ) ; == 4 ) ;

99

APPENDIX H. NUMERICAL CODE IN FOUR DIMENSIONS

H.2. BLACK-COX SETTING

elseif c==13 %company 1,2 and 3 default ind{c} = ( (ind1{1}==0) + (ind1{2}==0) + (ind1{3}==0) + (ind1{4}==1) elseif c==14 %company 1,2 and 4 default and company 3 does not ind{c} = ( (ind1{1}==0) + (ind1{2}==0) + (ind1{3}==1) + (ind1{4}==0) elseif c==15 %company 1,3 and 4 default and company 2 does not ind{c} = ( (ind1{1}==0) + (ind1{2}==1) + (ind1{3}==0) + (ind1{4}==0) elseif c==16 %company 2 ,3 and 4 default and company 1 does not ind{c} = ( (ind1{1}==1) + (ind1{2}==0) + (ind1{3}==0) + (ind1{4}==0) end end for p=1:16 result2(p) = mean(ind{p}); end

== 4 ) ; == 4 ) ; == 4 ) ; == 4 ) ;

H.2.1

Credit Portfolio

% credit portfolio Black-Cox setting in 4 dimensions format long S = 100*ones(4,1); n=4 ; T=1; r=0.04; rho=0.9; sigma(1)=0.25; sigma(2)=0.20; sigma(3)=0.15; sigma(4)=0.10; %portfolio weights a(1)=-0.0026; a(2)=0.0582; a(3)=0.2140; a(4)=0.7304; %portfolio weights for i=1:n m(i)= sqrt(T)*sigma(i) ; end m; A=diag(m) ; for i=1:n for j=1:n if i==j B(i,j)=1 ; else B(i,j)=rho ; end end end SIGMA=A*B*A; M=[60;60;60;60]; % debt dimension=4; steps = 10000000 ; % paths S_ini=100*ones(4,1); delta = 1/250; CHOL = chol(SIGMA); S=cell(1,dimension); for i = 1:dimension

100

APPENDIX H. NUMERICAL CODE IN FOUR DIMENSIONS

H.2. BLACK-COX SETTING

S{i}=zeros(steps,2); S{i}(:,1)=S_ini(i); end ind=cell(1,16); ind{1}=ones(steps,1); for i = 2:16 ind{i}=zeros(steps,1); end ind1=cell(1,16); for i=1:4 % start ind1 as 1 and change to 0 when company defaults ind1{i}=ones(steps,1); end for cnt_grid = 1:(T*1/delta) W=randn(steps,dimension)*CHOL; % makes 1:250 W that contain step for cnt_stock = 1:dimension S{cnt_stock}(:,2)=S{cnt_stock}(:,1).* ... exp((r-SIGMA(cnt_stock,cnt_stock)/2)*delta + sqrt(delta)*W(:,cnt_stock)) S{cnt_stock}(:,1)=S{cnt_stock}(:,2); end for cnt_n=1:dimension % no default ind{1} = ind{1}.*(M(cnt_n) < S{cnt_n}(:,2)); %record company cnt_n default ind1{cnt_n} = ind1{cnt_n}.*(M(cnt_n) < S{cnt_n}(:,2)); end end for c=2:16 if c==2 % all company default ind{c} = ( (ind1{1}==0) + (ind1{2}==0) + (ind1{3}==0) + (ind1{4}==0) == 4 ) elseif c==3 % company 1 default and company 2,3,4 does not ind{c} = ( (ind1{1}==0) + (ind1{2}==1) + (ind1{3}==1) + (ind1{4}==1) == 4 ) elseif c==4 % company 2 default and company 1,3,4 does not ind{c} = ( (ind1{1}==1) + (ind1{2}==0) + (ind1{3}==1) + (ind1{4}==1) == 4 ) elseif c==5 %company 3 default and company 1,2,4 does not ind{c} = ( (ind1{1}==1) + (ind1{2}==1) + (ind1{3}==0) + (ind1{4}==1) == 4 ) elseif c==6 %compnay 4 defaults and company 1,2,3 does not ind{c} = ( (ind1{1}==1) + (ind1{2}==1) + (ind1{3}==1) + (ind1{4}==0) == 4 ) elseif c==7 % company 1 and 2 default and company 3,4 does not ind{c} = ( (ind1{1}==0) + (ind1{2}==0) + (ind1{3}==1) + (ind1{4}==1) == 4 ) elseif c==8 % company 1 and 3 default and company 2,4 does not ind{c} = ( (ind1{1}==0) + (ind1{2}==1) + (ind1{3}==0) + (ind1{4}==1) == 4 ) elseif c==9 % company 1 and 4 default and company 2,3 does not ind{c} = ( (ind1{1}==0) + (ind1{2}==1) + (ind1{3}==1) + (ind1{4}==0) == 4 ) elseif c==10 % company 2 and 3 default and company 1,4 does not ind{c} = ( (ind1{1}==1) + (ind1{2}==0) + (ind1{3}==0) + (ind1{4}==1) == 4 ) elseif c==11 %company 2 and 4 default and company 1,3 does not ind{c} = ( (ind1{1}==1) + (ind1{2}==0) + (ind1{3}==1) + (ind1{4}==0) == 4 ) elseif c==12 %company 3 and 4 default and company 2,3 does not ind{c} = ( (ind1{1}==1) + (ind1{2}==1) + (ind1{3}==0) + (ind1{4}==0) == 4 ) elseif c==13 %company 1,2 and 3 default and company 4 does not ind{c} = ( (ind1{1}==0) + (ind1{2}==0) + (ind1{3}==0) + (ind1{4}==1) == 4 )

;

; ; ; ; ; ; ; ; ; ; ; ;

101

APPENDIX H. NUMERICAL CODE IN FOUR DIMENSIONS

H.2. BLACK-COX SETTING

elseif c==14 %company 1,2 and 4 default and company 3 does not ind{c} = ( (ind1{1}==0) + (ind1{2}==0) + (ind1{3}==1) + (ind1{4}==0) == 4 ) ; elseif c==15 %company 1,3 and 4 default and company 2 does not ind{c} = ( (ind1{1}==0) + (ind1{2}==1) + (ind1{3}==0) + (ind1{4}==0) == 4 ) ; elseif c==16 %company 2,3 and 4 default and company 1 does not ind{c} = ( (ind1{1}==1) + (ind1{2}==0) + (ind1{3}==0) + (ind1{4}==0) == 4 ) ; end end for p=1:16 result2(p) = mean(ind{p}); end PORT{1}=(a(1)+a(2)+a(3)+a(4))*ind{1}; PORT{2}=0*ind{2}; %1 defaults PORT{3}=(a(2)+a(3)+a(4))*ind{3}; PORT{4}=(a(1)+a(3)+a(4))*ind{4}; PORT{5}=(a(1)+a(2)+a(4))*ind{5}; PORT{6}=(a(1)+a(2)+a(3))*ind{6}; %2 defaults PORT{7}=(a(3)+a(4))*ind{7}; PORT{8}=(a(2)+a(4))*ind{8}; PORT{9}=(a(2)+a(3))*ind{9}; PORT{10}=(a(1)+a(4))*ind{10}; PORT{11}=(a(1)+a(3))*ind{11}; PORT{12}=(a(1)+a(2))*ind{12}; % 3 defaults PORT{13}=a(4)*ind{13}; PORT{14}=a(3)*ind{14}; PORT{15}=a(2)*ind{15}; PORT{16}=a(1)*ind{16}; for i=1:steps value(i)=PORT{1}(i) + PORT{2}(i) + PORT{3}(i)+PORT{4}(i)+PORT{5}(i) +PORT{6}(i)+PORT{7}(i)+PORT{8}(i) +PORT{9}(i)+PORT{10}(i)+PORT{11}(i)+PORT{12}(i)+PORT{13}(i)+PORT{14}(i)+PORT{15}(i)+PORT{16}(i); end x = value ; nbins=[-0.0026, 0, 0.0556, 0.0582, 0.2114, 0.2140 ,0.2696,0.2772,0.7278, 0.7304,0.786,0.7886, 0.9418, 0.9444, 1, 1.0026] ; [counts,centers] = hist(x,nbins) hist(x,nbins)

H.2.2

Market Portfolio

% market portfolio Black-Cox setting in 4 dimensions format long S = 100*ones(4,1); n=4 ; T=1; r=0.04; rho=0.9; sigma(1)=0.25; sigma(2)=0.20; sigma(3)=0.15; sigma(4)=0.10;

102

APPENDIX H. NUMERICAL CODE IN FOUR DIMENSIONS

H.2. BLACK-COX SETTING

%portfolio weights a(1)=-0.0026; a(2)=0.0582; a(3)=0.2140; a(4)=0.7304; for i=1:n m(i)= sqrt(T)*sigma(i) ; end m; A=diag(m) ; for i=1:n for j=1:n if i==j B(i,j)=1 ; else B(i,j)=rho ; end end end SIGMA=A*B*A; M=[90;90;90;90]; %debt dimension=4; steps = 10000000 ; % paths S_ini=100*ones(4,1); delta = 1/250 ; % 1/250 % number points measured a t CHOL = chol(SIGMA); S=cell(1,dimension); for i = 1:dimension S{i}=zeros(steps,2); S{i}(:,1)=S_ini(i); end for i=1:steps minS1(i)=S{1}(i,1); minS2(i)=S{2}(i,1); minS3(i)=S{3}(i,1); minS4(i)=S{4}(i,1); end for cnt_grid = 1:(T*1/delta) W=randn(steps,dimension)*CHOL; % makes 1:250 W that contain step for cnt_stock = 1:dimension S{cnt_stock}(:,2)=S{cnt_stock}(:,1).* ... exp((r-SIGMA(cnt_stock,cnt_stock)/2)*delta + sqrt(delta)*W(:,cnt_stock)) ; S{cnt_stock}(:,1)=S{cnt_stock}(:,2); end % create array of asset value of company 1,2,3,4 at each point on path for cnt_n=1:4 if cnt_n==1 S1=S{1}(:,2); for i=1:steps if S{1}(i,2)<minS1(i) minS1(i)=S{1}(i,2); end end

103

APPENDIX H. NUMERICAL CODE IN FOUR DIMENSIONS

H.2. BLACK-COX SETTING

MINS{cnt_n}=minS1(:) ; elseif cnt_n==2 S2=S{2}(:,2); for i=1:steps if S{2}(i,2)<minS2(i) minS2(i)=S{2}(i,2); end end MINS{cnt_n}=minS2(:); elseif cnt_n==3 S3=S{3}(:,2); for i=1:steps if S{3}(i,2)<minS3(i) minS3(i)=S{3}(i,2); end end MINS{cnt_n}=minS3(:); else S4=S{4}(:,2); for i=1:steps if S{4}(i,2)<minS4(i) minS4(i)=S{4}(i,2); end end MINS{cnt_n}=minS4(:) ; end end end %portfolio value VALUESTORE{1}=a(1)*MINS{1}; VALUESTORE{2}=a(2)*MINS{2}; VALUESTORE{3}=a(3)*MINS{3}; VALUESTORE{4}=a(4)*MINS{4}; for i=1:steps PORT(i)=VALUESTORE{1}(i) + VALUESTORE{2}(i) + VALUESTORE{3}(i) +VALUESTORE{4}(i); end PORT; hist(PORT) [counts,centers] = hist(PORT)

104

References
[1] D. Arnold. Lecture notes on numerical analysis of partial differential equations. 9 2011. [2] K. Atkinson and W. Han. Theoretical Numerical Analysis: A Functional Analysis Framework. Springer, 2009. [3] F. Black and J. Cox. Valuing corporate securities: Some effects of bond indenture provisions. The Journal of Finance, pages 351­367, 5 1976. [4] B. Bradie. A Friendly Introduction to Numerical Analysis. Pearson Education Inc, 2007. [5] M. Escobar, B. Goetz, D. Neykova, and R. Zagst. Pricing two-assets barrier options under stochastic correlation via perturbation theory. International Journal of Theoretical and Applied Finance, 18, 2015. [6] M. Escobar and J. Hernandez. A note on the distribution of multivariate brownian extrema. International Journal of Stochastic Analysis, 2014. [7] M. Escobar, P. Hieber, and M. Scherer. Efficiently pricing double barrier derivatives in stochastic volatility models. Review of Derivatives Research, 17:191­216, 2013. [8] H. He, W. Keirstead, and J. Rebholz. Double lookbacks. Mathimatical Finance, 8(2):201­228, 1998. [9] Z. Li, T. Tang, and Z. Qiao. Numerical solutions of partial differential equations-an introduction to finite difference and element methods. 2 2011. [10] R. Merton. On the pricing of corporate debt: The risk structure of interest rates. The Journal of Finance, pages 449­470, 5 1974. [11] F. Schmid, R. Schmidt, T. Blumentritt, S. Gaiber, and M. Ruppert. Copula-based measures of mulitvariate association. In P. Jaworski, F. Durante, W. Hardle, and T. Rychlik, editors, Copula Theory and Its Applications, volume 198, pages 209­236. Springer-Verlag Berlin Heidelberg, 2010. [12] Moody's Investors Service. Corporate default and recovery rates 1920-2009. Global Corporate Finance, pages 1­78, 2 2010. [13] R. Seydel. Tools for Computational Finance. Springer-Verlag Berlin Heidelberg, 4 edition, 2009. [14] S. Shreve. Stochastic Calculus for Finance II, Continous Time Models. Springer, 2004. 105

REFERENCES

REFERENCES

[15] X. Wan. The method of images in the pricing of barrier derivatives in three dimensions. Master's thesis, Ryerson University, 350 Victoria St, Toronto, ON, CA, 2011.

106

