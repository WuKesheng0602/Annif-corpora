MODELING, FORCE ESTIMATION AND CONTROL OF STEERABLE CATHETERS FOR ROBOT-ASSISTED INTRA-CARDIAC NAVIGATION

by Shahir Hasanzadeh MSc., Mechanical Engineering, Ferdowsi University of Mashhad, 2009 BSc., Mechanical Engineering, Ferdowsi University of Mashhad, 2004

A dissertation presented to Ryerson University in partial fulfillment of the requirements for the degree of Doctor of Philosophy in the Program of Mechanical and Industrial Engineering

Toronto, Ontario, Canada, 2016 © Shahir Hasanzadeh 2016

AUTHOR'S DECLARATION FOR ELECTRONIC SUBMISSION OF A DISSERTATION I hereby declare that I am the sole author of this dissertation. This is a true copy of the dissertation, including any required final revisions, as accepted by my examiners. I authorize Ryerson University to lend this dissertation to other institutions or individuals for the purpose of scholarly research. I further authorize Ryerson University to reproduce this dissertation by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. I understand that my dissertation may be made electronically available to the public.

ii

Abstract
MODELING, FORCE ESTIMATION AND CONTROL OF STEERABLE CATHETERS FOR ROBOT-ASSISTED INTRA-CARDIAC NAVIGATION Doctor of Philosophy, 2016 Shahir Hasanzadeh Department of Mechanical and Industrial Engineering, Ryerson University

Intra-cardiac catheterization is an effective procedure for diagnosis and treatment of many cardiac disorders such as arrhythmia. The objective of the catheter manipulation is to accurately position the catheter tip at the target tissue on the endocardium and provide a stable contact force for a specific duration to the region of interest. However, this is a challenging task due to the high flexibility of the catheter, ineffective visualization and dynamic environment of the heart. Additionally, the catheter-tissue interaction force, that the procedure outcome highly depends on, is not known to the interventionalist during the catheterization. This thesis deals with improving the safety and effectiveness of the catheterization by making contributions to two main areas; catheter contact force estimation and automatic force/position control of a robotic catheter system. First, a quasi-static model of the planar catheter that predicts the catheter pose for the given actuation variables and external forces in the plane of catheter motion, is proposed. In the next step, the computational efficiency of the proposed model is utilized to develop an online approach for the estimation of the external force at the tip of a catheter

iii

based on the pose measurement. The proposed force estimation approach is also extended to 3D by developing an efficient model of the catheter that is derived by coupling the classical Cosserat rod model with a new model of the pull-wire actuation. Experiments performed using electromagnetic sensors verify the feasibility of the proposed schemes in medical applications. In the control area, a position control scheme for a robotic assisted manipulation system is proposed, using the experimentally obtained inverse kinematics that compensates for the non-smooth dynamics of the distal shaft bending mechanism. Compensation of the backlash behavior of the catheter due to its interaction with the surrounding veins is also incorporated in the control scheme. The proposed position controller is then adopted as the internal loop of a hybrid position/force controller that positions the catheter tip to the target tissue and simultaneously, regulates the contact force to a desired value. The viability of the proposed controllers is then verified through simulations and experiments.

iv

Acknowledgments
First and foremost, I would like to thank my supervisor, Dr. Farrokh Janabi-Sharifi, who made this work possible. Dr. Sharifi's involved guidance and constructive discussions during my PhD studies have been invaluable for the development and completion of this dissertation. I would also like to thank my supervisory committee members, Dr. Vincent Chan and Dr. Bill Lin and members of my examination committee, Dr. Soosan Beheshti and Dr. Nabil Simaan who helped me improve my thesis with their constructive feedback. This project would not have been possible without the contributions of many individuals. I appreciate the valuable advice and contribution of Dr. Asim Cheema, Interventional Cardiologist with St. Micheal's Hospital in Toronto, throughout this study. I am also grateful to Patrick Keenan for his great technical help in programming of the robotic catheter system. I would like to thank Devin Ostrom, Technical Officer with Robotics and Manufacturing Automation Lab (RMAL) at Ryerson University for his help and collaboration in preparation of required equipment. I would like to gratefully acknowledge valuable consultations of Dr. Shahryar Rahnamayan, Dr. Aleksandar Vakanski and Dr. Abdelkader Abdessameud in different stages of this project Many thanks to the members of RMAL lab: Ata, Lubna, Patrick, Hossein, Abdul, Akbar, Yasser and all the other students with whom I worked in the lab for providing such a pleasant working environment. The friendship and support they offered made my PhD study a memorable experience. My deepest gratitude goes to my parents Masoud and Parvin and my entire family. They have been a constant source of inspiration and motivation for me, and without their love and encouragement this work would not be possible.

v

Dedication
To my parents Masoud and Parvin, for their love and support.

vi

Table of Contents
Abstract Acknowledgments Dedication List of Figures List of Tables Nomenclature 1. Introduction 1.1. Catheter and Intra-cardiac Catheterization . . . . . 1.2. Remote Navigation Systems . . . . . . . . . . . . . 1.3. Research Motivation . . . . . . . . . . . . . . . . . 1.4. Related Work . . . . . . . . . . . . . . . . . . . . . 1.4.1. Related Work on Planar Catheter Modeling 1.4.2. Related Work on Spatial Catheter Modeling 1.4.3. Related Work on Force Estimation . . . . . 1.4.4. Related Position Control Work . . . . . . . 1.4.5. Related Work on Force Control . . . . . . . 1.5. Thesis Contributions . . . . . . . . . . . . . . . . . 1.6. Thesis Structure . . . . . . . . . . . . . . . . . . . . 2. Planar Catheter Modeling 2.1. Consecutive Models and Assumptions 2.2. Piecewise Circular Arc Approach . . 2.2.1. Kinematics . . . . . . . . . . 2.2.2. Statics . . . . . . . . . . . . . iii v vi xi xii xvi 1 1 2 4 6 6 8 10 11 13 14 16 18 19 20 21 22

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

. . . .

vii

2.2.3. Features of the PCAR Model 2.3. Experimental Validation . . . . . . . 2.3.1. Identification . . . . . . . . . 2.3.2. Verification . . . . . . . . . . 2.4. Summary . . . . . . . . . . . . . . . 3. Spatial Catheter Modeling 3.1. Cosserat Rod Model . . . . . . . . 3.1.1. Kinematics . . . . . . . . . 3.1.2. Forces and Moments . . . . 3.1.3. Constitutive Laws . . . . . . 3.1.4. Governing Equations . . . . 3.2. Tendon-driven Catheter Model . . 3.2.1. Tendon Actuation Model . . 3.2.2. Modeling External Forces . 3.2.3. Catheter Navigation Model 3.3. Experimental Results . . . . . . . . 3.4. Conclusions . . . . . . . . . . . . . 4. Planar Catheter Force Estimation 4.1. Introduction . . . . . . . . . . 4.2. Computation of the Estimated 4.3. Simulations Analysis . . . . . 4.4. Experimental Validation . . . 4.5. Conclusion . . . . . . . . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

25 27 27 29 30 32 32 33 34 35 35 36 36 38 44 45 51 52 52 54 55 59 60 63 63 63 68 68 70 73 74 75

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . Force . . . . . . . . . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

5. Spatial Catheter Force Estimation 5.1. Introduction . . . . . . . . . . . 5.2. Force Estimation . . . . . . . . 5.3. Simulations Analysis . . . . . . 5.3.1. Feasibility . . . . . . . . 5.3.2. Sensitivity Analysis . . . 5.3.3. Computation Time . . . 5.4. Experimental Validations . . . 5.5. Conclusions . . . . . . . . . . .

. . . . . . . .

. . . . . . . .

. . . . . . . .

. . . . . . . .

. . . . . . . .

. . . . . . . .

. . . . . . . .

. . . . . . . .

. . . . . . . .

. . . . . . . .

. . . . . . . .

. . . . . . . .

. . . . . . . .

. . . . . . . .

. . . . . . . .

. . . . . . . .

. . . . . . . .

. . . . . . . .

. . . . . . . .

. . . . . . . .

. . . . . . . .

viii

6. Catheter Position Control 6.1. Robotic Catheter . . . . . . . . . . . . . . . . 6.2. Characteristics of Robotic Catheter System . 6.2.1. Axial Translation . . . . . . . . . . . . 6.2.2. Twist . . . . . . . . . . . . . . . . . . 6.2.3. Steering . . . . . . . . . . . . . . . . . 6.3. Experimentally-based Inverse Kinematics (IK) 6.4. Position Controller . . . . . . . . . . . . . . . 6.4.1. Control Structure and Components . . 6.4.2. Althea® 2 Robotic Catheter System . . 6.4.3. Experimental Results . . . . . . . . . . 6.5. Conclusions . . . . . . . . . . . . . . . . . . .

. . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

78 79 80 80 82 85 86 89 89 91 93 97 98 98 99 102 102 103 106 109 110 111 113 113 115 119

7. Hybrid Position/Force Control of the Catheter 7.1. Introduction . . . . . . . . . . . . . . . . . . . . . . . 7.2. Force Control Structure . . . . . . . . . . . . . . . . 7.3. Simulation Analysis . . . . . . . . . . . . . . . . . . . 7.3.1. Simulation Environment . . . . . . . . . . . . 7.3.2. Inverse Kinematics of the Simulated Catheter 7.3.3. Effect of the Gains . . . . . . . . . . . . . . . 7.3.4. Optimal Controller Gains . . . . . . . . . . . 7.3.5. Sensitivity Analysis . . . . . . . . . . . . . . . 7.3.6. Regulation in Dynamic Environment . . . . . 7.4. Experimental Analysis . . . . . . . . . . . . . . . . . 7.4.1. Experimental Setup . . . . . . . . . . . . . . . 7.4.2. Experimental Results . . . . . . . . . . . . . . 7.5. Conclusion . . . . . . . . . . . . . . . . . . . . . . . 8. Future Directions and Conclusion 8.1. Future Works . . . . . . . . . 8.1.1. Modeling Research . . 8.1.2. Force Estimation . . . 8.1.3. Control Research . . . 8.2. Conclusion . . . . . . . . . . . A. Cardiac Arrhythmia

. . . . . . . . . . . . .

. . . . . . . . . . . . .

. . . . . . . . . . . . .

. . . . . . . . . . . . .

. . . . . . . . . . . . .

. . . . . . . . . . . . .

. . . . . . . . . . . . .

. . . . . . . . . . . . .

. . . . . . . . . . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

122 . 122 . 122 . 123 . 124 . 125 128

ix

B. Jacobian Matrices for the Planar Catheter Model Bibliography

132 134

x

List of Tables
2.1. Geometrical and mechanical properties of catheters. . . . . . . . . . 29 2.2. Experimental parameters and results. . . . . . . . . . . . . . . . . . 30 3.1. Computation time analysis for the proposed method. . . . . . . . . . 43 3.2. Geometrical and mechanical properties of catheters. . . . . . . . . . 47 3.3. Experiments parameters and results. . . . . . . . . . . . . . . . . . . 50 4.1. Computation time analysis for the direct and inverse problems. 5.1. Computation time for different force estimation schemes (sec). . . . 58 . . . 74

6.1. Curve fitting parameters for the IK curves. . . . . . . . . . . . . . . . 88

xi

List of Figures
1.1. Intra-cardiac intervention procedure. . . . . . . . . . . . . . . . . . . 1 1.2. Schematic view of a steerable catheter (a). Cross section of the distal shaft (b). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2 1.3. Structure of the thesis. . . . . . . . . . . . . . . . . . . . . . . . . . 16 2.1. Proposed consecutive model of the catheter. . . . . . . . . . 2.2. Configuration of the catheter approximated by three curves. 2.3. Curve angle (right) and shape (left) of two PCARs (1 = 2 = 3 m-1 , 1 = 2 = 0.5 m ). . . . . . . . . . . . . . . . . . 2.4. Experimental setup for the catheter static model. . . . . . . 2.5. Shape of the catheter obtained by experiment versus model. 3.1. 3.2. 3.3. 3.4. 3.5. 3.6. . . . . . . . . 1 m-1 , . . . . . . . . . . . . . 20 . 21 . 23 . 28 . 30 33 37 39 42 43 45 46 47 48 49 49

Kinematics of the nonlinear rod. . . . . . . . . . . . . . . . . . . . . . Tendon actuation model. . . . . . . . . . . . . . . . . . . . . . . . . . Schematic view of the catheter modeled as a rod. . . . . . . . . . . . Shape of the catheter as a result of the iterative solution of IVP. . . . Number of required algorithm iterations for catheter external forces. . Shape of the catheter as a result of the applied force in local frame (F1 = 0.05, 0.1, 0.15 N) . . . . . . . . . . . . . . . . . . . . . . . . . . 3.7. Variation of internal forces,moments and curvatures along the catheter -1 (F1 = 0.2 N, 0 = 70 mm). . . . . . . . . . c1 = 60 m , d = 40 mm, 3.8. Experimental setup. . . . . . . . . . . . . . . . . . . . . . . . . . . . 3.9. Shape of the catheter 2 obtained by experiment versus model for inplane forces. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3.10. Shape of the catheter 1 obtained by experiment versus model for outof-plane forces. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3.11. Shape of the catheter 2 obtained by experiment versus model for outof-plane forces . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

xii

4.1. Block diagram of the catheter force estimation. . . . . . . . . . . . 4.2. Schematic view of the catheter with the force angle. . . . . . . . . . 4.3. Estimated force compared with the real one for different sizes and directions of the applied force (initial curvature: 0.01 mm-1 ). . . . . 4.4. Estimated force compared with the real one for different sizes and directions of the applied force (initial curvature: 0.02 mm-1 ). . . . . 4.5. Estimated force compared with the real one for different sizes and directions of the applied force (initial curvature: 0.03 mm-1 ). . . . . 4.6. Effect of position sensing error on estimated force (scale 200 mm: 1 N). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.7. Experimental setup for force estimation. . . . . . . . . . . . . . . . 4.8. Estimated size and direction of the applied force versus real values. 5.1. Schematic view of the catheter with measurement points and the applied forces. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.2. Estimated force compared with the real one for different sizes and directions of the applied force. . . . . . . . . . . . . . . . . . . . . . 5.3. Size of the estimated force using the chosen approaches. . . . . . . . 5.4. Effect of the position measurement noise on the estimated force (scale 200 mm: 1 N). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.5. Standard deviation of the estimated force for different directions of the applied force. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.6. Error as a result of uncertainty in the distal shaft bending stiffness for different force directions. . . . . . . . . . . . . . . . . . . . . . . 5.7. Experimental setup for force estimation. . . . . . . . . . . . . . . . 5.8. Estimated force for different force sensing cases. . . . . . . . . . .

. 53 . 56 . 56 . 57 . 57 . 59 . 60 . 61

. 65 . 69 . 70 . 71 . 72 . 73 . 75 . 76

6.1. Robotic catheter manipulator of the Althea® 2 system. . . . . . . . . . 79 6.2. Pose measurement system and phantom. . . . . . . . . . . . . . . . . 80 6.3. Sinusoidal input and output for the axial translation. (a) amplitude=10 mm, frequency=1 rad/s, (b) amplitude =7.5 mm, frequency=1.5 rad/s. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 81 6.4. Backlash behavior of the robotic catheter system in axial direction. . 82 6.5. Sinusoidal input and output for the axial rotation. (a) amplitude=20 , frequency=1 rad/s, (b) amplitude =40 , frequency=0.5 rad/s. . . . . 83 6.6. Backlash behavior of the robotic catheter system for axial rotation. . 84

xiii

6.7. Schematic view of the catheter in the plane of deflection. . . . . . . . 6.8. Curvature of the distal shaft and the constant curvature model. . . . 6.9. Schematic view of the catheter and transseptal sheath. . . . . . . . . 6.10. Relative position of the catheter tip along z axis. . . . . . . . . . . . 6.11. Relative position of the catheter tip along x axis. . . . . . . . . . . . 6.12. Schematic diagram of the control loop for the robotic catheter system. 6.13. An overview of system components and their interactions. . . . . . . 6.14. The overall structure of the complete control software. . . . . . . . . 6.15. Path followed by the catheter tip during position controlled navigation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6.16. Performance of the controller for each of the coordinate axis. . . . . . 6.17. Commands to the stepper motors of the robotic catheter system. . . . 6.18. Effect of the controller gain on the convergence performance. . . . . . 6.19. Comparison between the path followed by the catheter tip for different values of gain. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7.1. 7.2. 7.3. 7.4. 7.5. 7.6. 7.7. Schematic diagram of the position/force controller. . . . . . . . . . Coordinate frames in catheter heart interaction. . . . . . . . . . . . Model of the interaction between the catheter and heart tissue. . . Schematic view of the catheter and intoducer sheath. . . . . . . . . Workspace of the distal shaft of the simulated catheter. . . . . . . Polynomials for fitting the inverse of (7.2). . . . . . . . . . . . . . . Position of the tip of the simulated catheter calculated using the approximate IK. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7.8. Position of the tip of the simulated catheter under position control based on Jacobian inverse and fitted curve IK. . . . . . . . . . . . 7.9. Shape of the catheter converging to the desired force and position. 7.10. Performance of the hybrid control of the catheter. . . . . . . . . . . 7.11. Effect of position controller PID gains on the force stabilization performance. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7.12. Effect of force controller PID gains on the force stabilization performance. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7.13. Step response of the system for the optimally-tuned PID gains. . . . 7.14. Response of the proposed controller to change in the stiffness of the catheter. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7.15. Response of the proposed controller to the heart tissue oscillation. . . . . . .

85 86 87 89 90 91 92 93 94 94 95 96 96 100 100 103 103 104 105

. 105 . 106 . 107 . 107 . 108 . 109 . 110 . 111 . 112

xiv

7.16. Contact force of the catheter for the oscillating tissue. . . . . . . . 7.17. Bode magnitude plot for different values of the force controller proportional gain. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7.18. Experimental setup for hybrid control. . . . . . . . . . . . . . . . . 7.19. Schematic view of the experimental setup. . . . . . . . . . . . . . . 7.20. Regulation of the contact force and position using the hybrid control for the first configuration. . . . . . . . . . . . . . . . . . . . . . . . 7.21. Commands to the stepper motors during the position/force regulation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7.22. Effect of the integral gain of the force controller. . . . . . . . . . . 7.23. Effect of the proportional gain of the force controller. . . . . . . . . 7.24. Effect of the integral gain of the position controller. . . . . . . . . 7.25. Effect of the proportional gain of the position controller. . . . . . . 7.26. Regulation of the contact force and position using the hybrid control for the second configuration. . . . . . . . . . . . . . . . . . . . . . . 7.27. Force regulation for different desired contact forces. . . . . . . . . .

. 113 . 113 . 114 . 115 . 116 . . . . . 117 117 118 118 119

. 120 . 120

A.1. The procedure of intra-cardiac catheterization. . . . . . . . . . . . . 129 A.2. Illustration of catheter ablation for different arrhythmias. AF (a), Atrial flutter (b), AVNRT (c), WPW syndrome in left chamber (d), WPW syndrome in right chamber (e) and VT (f). . . . . . . . . . . . 130

xv

Nomenclature
BVP DOF DOF EM IVP PCAR PID RF SVT VT k di ei E1 , E2 , E3 EI i EI1 boundary value problem degrees-of-freedom degrees-of-freedom electromagnetic initial value problem piecewise circular arcs proportional-integral-derivative radio-frequency supraventricular tachycardias ventricular tachycardias rotation angle of the knob orthonormal basis for the local frame orthonormal basis for the global frame right hand side of the PCAR kinematic equations. bending stiffness of the i-th segment bending stiffness along d1

EI2

bending stiffness along d2

xvi

Nomenclature f (s) Fg external force distribution vector external froce in global frame

Fm

external froce in local frame

FT

tendon tension force

Fx , Fy GJ

External forces torsional stiffness

Jo

orientation Jacobian matrix

Jp

position Jacobian matrix

 c1

curvature of the constant curvature model curvature along d1

0 c1

initial curvature along d1

c2

curvature along d2

0 c2

initial curvature along d2

i 0 i Kt

curvatue of the i-th curve initial curvature of the i-th segment tissue stiffness

xvii

Nomenclature total length of the catheter
i

length of the i-th curve internal moment vector internal force vector number of the PCAR curves Darboux vector pose of the catheter at the arc-length s

m(s) n(s) n  p(s)

pt b h 

pose of the catheter tip twist angle of the catheter body rotation angle of the handle continuous force applied to the catheter from the tendon

R(s) r(s) s i (s)

rotation matrix of the local frame w.r.t. the global frame position of the center-line of the rod in global frame arc length parameter angle between the horizontal axis and tangent to the curve for i-th curve torsion



0

initial torsion

(s) U

angle between the horizontal axis and tangent to the curve potential energy

xviii

Nomenclature v1 , v2 , v3 W xb local rate of change of the position of the center-line external work axila displacement of the catheter

xb xh xp , yp , zp xt , yt , zt

translation angle of the catheter body translation of the handle position of tip of the catheter position of tip of the catheter

xix

1. Introduction
1.1. Catheter and Intra-cardiac Catheterization
Intra-cardiac catheterization is an effective procedure for diagnosis and treatment of many cardiac disorders such as arrhythmia. Cardiac arrhythmias are irregularities in the electrical activity of heart, constituting one of the most common clinical diseases in cardiology [1]. It is estimated 350,000 Canadians are living with atrial fibrillation which is the most common type of arrhythmia [2]. The prevalent treatment of cardiac arrhythmias is catheter ablation (Fig. 1.1) which involves, advancing several steerable catheters into the patient's cardiac chambers to disrupt the pathways of abnormal electrical signals mainly by radio-frequency (RF) ablation. The objective of the catheter manipulation is to provide a stable contact force for a specific duration [3] with the region of interest on the endocardium. Based on the location of the origin of the abnormal electrical activities, different regions on the cardiac wall should be ablated. Different types of arrhythmias and the required ablation catheter technique are visually compared in Appendix A.
Distal shaft

Catheter body

Figure 1.1.: Intra-cardiac intervention procedure. Intra-cardiac catheterization is usually performed manually by axial translation and

1

1.2 Remote Navigation Systems twisting the proximal body and deflecting the distal shaft of the catheter, using a steering knob at the handle. Manipulations made by the interventionalist and the consequent catheter motions are depicted in Fig. 1.2(a). For commercially available ablation catheters, the pull-wire mechanism is usually used to translate the turning of the knob at the handle to the bending of the distal shaft. When the handle knob turns, the tendon, which is attached to the tip of the catheter through its body, is pulled causing change in distal shaft curvature (Fig. 1.2(b)).
Distal shaft Catheter body Handle

Steering knob (a) Teflon sheath Stainless steel winding

V

FT
V

e
Catheter sheath Pull wire (b)

Figure 1.2.: Schematic view of a steerable catheter (a). Cross section of the distal shaft (b). Manual navigation of steerable catheters is a challenging task and can entail prolonged exposure of the interventionalists and the patients to ionizing radiation. That is because the catheter shaft is highly flexible and is subject to the intracardiac blood flow and respiratory movements. Therefore accurate positioning of the catheter without having an estimate of the contact force and visualization of the anatomical area is difficult to realize. To facilitate the catheter navigation, various methods have been developed in academia and biomedical devices industry. The following section reviews robotic systems for catheter manipulation.

1.2. Remote Navigation Systems
Several technologies have been developed which allows the interventionalist to manipulate the EP/ablation catheter from within the control room instead of standing next to the patient table [4]. Using remote navigation systems are clearly advantageous over manual operation since, they (1) minimize the physician's fluoroscopy

2

1.2 Remote Navigation Systems exposure, (2) provide an ergonomic operation environment for the interventionalist, (3) improve catheter stability and reproducibility of the procedure, and (4) increase patients' safety by avoiding serious complications. The following list includes the existing robotic catheter navigation systems developed by medical industry. · Niobe I, II, and Epoch (Stereotaxis Inc.) - This system includes two permanent magnets which are placed on the sides of patient table. The catheter is navigated inside the magnetic field, by changing the relative orientation of the magnets. The interventionalist can control movement of magnets and thereby deflection of the catheter through the system's console in a separate room, away from radiation exposure. The system has been successfully deployed for electrophysiological mapping and cardiac ablation operations [5]. One limitation of this system is for the patients who have implantable cardioverter debrillator (ICD) or pacemaker because of the presence of ferrous metals in the construction of such devices. Another shortcoming of this system is that the limited force exerted by the catheter tip, as a result of the soft catheter exposed in a weak magnetic field, in some cases hinders effective contact between the catheter and the tissue. To deploy Niobe, the catheterization lab must be magnetically compatible with the system causing a high installation cost [4]. · Sensei (Hansen Medical Inc.) - The system uses two steerable sheaths through which a passive catheter is deployed. The outer and inner sheaths are manipulated via a pull-wire mechanism incorporated in a sheath-carrying robotic system. Recent product of this family, Artisan Extend Control Catheter, can measure the axial contact force and feed the data back to the interventionalist through the force sensor incorporated at the tip of the catheter [6]. One limitation of the robotic Sensei system is the high sheath diameter, which may result in more frequent vascular complications. Especially-designed catheters are required to be deployed along with their costly support systems to accomplish the operation. Deflection of the distal part of the catheter and guiding sheath is performed by 8 independent pull-wires and pulley mechanisms. Therefore, excessive number of components of the manipulation mechanism may risk the reliability of the overall system. · CGCITM (Magnetics Corp.) - Similar to Stereotaxis devices, catheter navigation in CGCI is performed by the electromagnetic field. The device is

3

1.3 Research Motivation composed of a system of 8 electromagnets that generate a variable magnetic field. The advantage of the variable electromagnetic field is that it allows rotation along longitudinal axis of the catheter. The catheter also moves faster than with the Stereotaxis device [7]. However, the CGCI still suffers from the limitations associated with the use of magnetic catheter. · Amigo (Catheter Robotics Inc.) - Using this simple mechanism, a conventional ablation catheter is advanced into a custom-made steerable sheath and manipulated via a manual controller away from ionizing radiation [8]. Similar systems, have also been developed in academia including the telerobotic system presented in [9] and Althea® [10] which was made in Robotics and Manufacturing Automation Lab (RMAL) at Ryesron University. The feasibility a and safety of Amigo has recently been studied in human ablation procedure [11]. Although the operator's fluoroscopy exposure time has been reduced comparing with the manual operation, no differences have been observed in the total procedure time and radiation exposure to the patient. Automatic navigation control of the catheter and heart movement compensation, as will be proposed in the subsequent section, can resolve the shortcomings of the similar robotic catheter systems.

1.3. Research Motivation
The robotic systems mentioned above, facilitate catheterization and reduce radiation exposure to the interventionalist. However, such technologies can be improved in several directions. Limitations of the existing robotic catheter system and enhancements proposed by this thesis are summarized below. · Limitation: Most of the current technologies do not provide the feedback for the contact force between the catheter and the heart tissue. The only robotic catheter system with force feedback relies on the axial force measured through the force sensor attached to the tip of the catheter. However, there are several issues with integration of force sensor to the tip of the catheter including extra cost, and reduced maneuverability of the distal shaft. Sensitivity of the force sensor to the noise and the temperature rise during the ablation is another issue with the force sensor equipped catheters. Also axial force information by itself cannot provide sufficient information for the compliant catheter control.

4

1.3 Research Motivation Proposed solution: For obtaining the contact force feedback between the catheter and heart tissue, instead of incorporating a force sensor at the tip of the catheter, the feasibility of pose-based force estimation is investigated for the catheter ablation. · Limitation: Automatic positioning of the catheter can potentially reduce the x-ray exposure time and contribute to the effectiveness of the procedure by accurate positioning of the tip electrode to the desired position of the heart tissue. However, the operations performed by the current technologies are still manual in nature. The existing robotic-assisted catheterization system either do not provide automatic navigation of the catheter or the minimal autonomy added to the procedure relies on their specially-designed sheath, thus cannot be used for the commercially available cardiac catheters. Proposed solution: In this thesis, the speed and effectiveness of the interventional procedure are enhanced by developing an automatic position control scheme for the commercial off-the-shelf intra-cardiac catheters. · Limitation: Current robotic cardiac catheter technologies do not provide heart motion compensation to allow the catheters to keep up with the fast motion of intra-cardiac structures. Maintaining stable contact between the catheter and the tissue, which is required for an effective ablation, in dynamic environment of the cardiac chamber, is still challenging for such systems. Proposed solution: A hybrid position/force controller is proposed to regulate the contact force between the catheter and the cardiac tissue during ablation procedure. In summary, the motivation of this thesis is to contribute to the ideal intra-cardiac catheterization, which is quick, effective and safe for both the patient and the interventionalist. This thesis offers alternative solutions to address the limitations of the cutting edge technologies of robotic catheterization. The solutions presented here lays the ground for the future medical applications by presenting a theoretical and experimental proof of concepts.

5

1.4 Related Work

1.4. Related Work
In this section, the research works related to different aspects of the current work are reviewed and the proposed approaches are highlighted against the existing studies.

1.4.1. Related Work on Planar Catheter Modeling
An accurate and efficient model for cardiac catheters is a main building block for the potential force estimation and control schemes of the catheterization procedure. A cardiac catheter can be thought as a preshaped flexible rod undergoing large deformation as a result of the external loads. Mathematical modeling of flexible rods has been the subject of research in robotics and computer graphics. In robotics literature, a steerable catheter is classified as a continuum robot which is continuously bending, i.e., an infinite degrees-of-freedom (DOFs) robot with an elastic structure. One simplifying approach for modeling a continuum robot is to approximate the robot as a rigid constant-curvature arc. The shape of such robots is assumed not to change as a result of the applied force, and thus, kinematic models can be worked out for many applications under the above assumption [12]. For instance, in [13] and [14] piecewise circular models have been presented for kinematics of a bionic handling assistant and a concentric tube steerable need, respectively. Also authors in [15] have presented a model for correcting the kinematics of a surgical continuum manipulator, experimentally based on vision segmentation. A more accurate modeling approach is expected to incorporate generalized forces applied to the robot by actuators and the environment into the kinematic model. Therefore, kinematic modeling requires static or dynamic analysis to determine the pose of any point along the robot. In 2D cases, closed-form solutions of the static equations can be obtained via elliptic integrals [16], [17]. However, the nonlinear integral can be numerically unstable and is computationally expensive, thereby hindering its real-time implementation. To overcome this problem, the authors in [18] used a pseudo-rigid-body model consisting of three rotational springs and three rigid links to model the behavior of an ablation catheter tip. Although the model provides results that are as accurate as elliptic integrals, the overall shape of the catheter cannot be obtained, and it is limited to the distal shaft portion of the catheter. A real-time method for the modeling of flexible cannulas has been proposed in [19], where the shape of the deflected robot is obtained via linear interpolation of the

6

1.4 Related Work existing pre-solved solutions. However, this approach is limited to beam-like objects without initial deflections. Another approach to make the model feasible for real-time control, by sacrificing the accuracy, is to adopt lumped parameters for modeling of a continuum robot. One of such efforts made in [20] where a specially-designed catheter has been modeled by a set of linear mass, spring, and damping elements. The model allows inclusion of internal friction of the device and thus provides improved accuracy for no external load conditions comparing to constant curvature model. However, the effect of the external forces are not considered in this model. A discrete dynamic model for octopus arm has also been presented in [21] to explore possible strategies of movement control. The arm has been modeled as a 2D array of discrete point masses connected by damped springs. The shortcoming of the model is that the non-linearity associated with the large deflections cannot be properly captured by the linearized model. Modeling thin deformable objects in computer graphics, in spite of their inherent difference with the problem at hand, is an active research literature, review of which might be inspiring to contribute to the catheter modeling. With a broad application ranging from modeling sutures in surgical simulation to hairs in animation, modeling thin deformable objects is a challenging problem in physically-based computer graphics. A class of these approaches discretizes the deformable object using simple mechanical elements, for instance, system of particle mass mutually attached by linear springs [22], rigid links attached via rotational springs [23] and connected beam elements [24]. Static analysis is usually reduced to an optimization problem aiming at finding the configuration associated with the least potential energy of the system for the given boundary conditions. Another similar approach is to approximate the flexible object with a series of connected curves e.g., helix [25] or spline [26], [27] and to perform the static analysis by obtaining minimal energy curve [28]. Linear finite element method (FEM) [29] and incremental FEM [30] have also been applied for static modeling of the thin objects in computer graphics. In spite of being computationally efficient, these approaches require prior knowledge of the surroundings of the object. Moreover, the non-linearity associated with the large deflection of the deformable object is not properly modeled in such approaches. In summary, the existing models do not fulfill the following requirements for the problem at hand: (1) Low dimensionality: Because the static analysis is to be

7

1.4 Related Work performed in real time, the DOF of the system should be minimized to enable tractability for real-time applications. The low dimensionality of the model is crucial in obtaining an efficient solution of the inverse problem online force estimation. (2) Arc-length parametrized representation: Because it is assumed the catheter to be inextensible, the overall length of the curve should remain constant. Parametric representations of the curves that are not isometric, e.g., B-spline, cannot provide an adequate representation because they apply an additional constraint to the analysis. (3) Accurate energy formulation: Considering the large deformation of the catheter, the potential energy of the catheter associated with its configuration should be accurately obtained (without linearization) based on the variables of the system model. This is particularly important for the accuracy of low-dimensional models. In Chapter 2, a planar model for the catheter is proposed that meets the aforementioned requirements. The parameters of the model are obtained through identification, leading to a model that accurately simulates static behavior of steerable catheters.

1.4.2. Related Work on Spatial Catheter Modeling
For the 3D case, theory of Cosserat rod has largely been applied for modeling of continuum robots. Cosserat rod theory has a long history beginning with the theory proposed by James Bernoulli in the late 1700s to describe bending of a rod in 2D. Further developments by different mathematicians were collected by Antman [31] who provided a geometrically exact system of equations for a special 3D dynamic beam called a Cosserat rod. The only limitation of the Cosserat rod from a real beam is that the cross-section of the rod is non-deformable. Kirchhoff rod (elastica) theory can be considered as a special case of Cosserat rod theory in which shear deformation and extension of the rod are neglected which is valid for slender rods. An early theoretical work toward elastica dynamics with embedded tendons is that of Davis and Hirschorn [32] where the dynamic model for a single flexible link has been derived based on Frenet formulation. The derived equations are in form of partial differential equations. In an experimental work [33], static behavior of a cable-driven planar flexible arm has been modeled using elastica theory. Using the obtained model, the optimal spacing of cable supports on a continuous backbone robot, which maximizes load capacity, has been obtained. In continuum robotics, Cosserat rod has been used for modeling robots with different driving mechanisms: tendon-driven [34], preshaped tubes [35], pneumatic actuators

8

1.4 Related Work [36] and magnetic catheters [37]. It has been mainly used to obtain an exact model for the robot when external load is considerable and therefore constant curvature assumption does not lead to accurate results. In [35], for instance, a pneumatically driven soft manipulator has been modeled using Cosserat rod theory. This method allows inclusion of weight of the robot into static model. Results have been shown to provide significantly improved agreement with the physical trunk when compared to constant curvature model. Cosserat rod theory has also been used in dynamic and static modeling of tendondriven continuum robots [38]. The effect of tendons which pass through channels of supporting disks has been included in the model for the tendon-driven continuum robots by coupling the Cosserat rod and Cosserat string model [38]. It has been shown that for out-of-plane loading, the coupled approach is more accurate than point moment assumption. However, besides its computational inefficiency, this approach cannot directly be applied to the steerable catheters where the tendon is confined in the sheath. In Chapter 3, a Cosserat rod based model will be developed for the steerable catheters in which the interaction forces between the catheter and sheath is obtained in local frame, as apposed to the approach in [38]. Therefore, the interaction model can be conveniently integrated with the catheter static equations to form an initial value problem leading to a computationally efficient model of tendon-driven steerable catheters. There have been efforts to reduce the computational cost of the Cosserat rod model to make the approach feasible for real-time control. An efficient method for calculation of force and compliance Jacobian matrices based on the derivative propagation has been developed in [39] that can reduce the computation time of the boundary value problem of the Cosserat rod model. In [34] a method, similar to shooting technique, has been used to solve the Cosserat rod equations for a continuum robot under a point load at the tip with some modifications to make the solution computationally efficient. However, the approach still relies on solving a boundary value problem that is associated with the convergence issues. In summary, existing Cosserat rod models of continuum robots cannot be directly applied to the problem at hand. The model should be modified to comply with the following conditions of the intra-cardiac catheter in catheterization procedure. (1) Computation time: The aim of the catheter model is to be used in online contact force estimation and navigation control of the interventional procedure. Therefore,

9

1.4 Related Work the quasi-static model of the intra-cardiac catheter should be fast enough to comply with the dynamic motion of the beating heart with the frequency higher than 10 Hz. This is not the case for majority of the current state-of-the-art models for the continuum robots. (2) Catheter body model: Both the commonly used steerable catheters and the tendon-driven continuum robots have similar actuation mechanism. However, body portion of the catheters are not affected by the tendon actuation but deflects by the external forces. This behavior of the catheter body should be properly included in the model. (3) Tendon-sheath model: To obtain an accurate model of the catheter, the interaction between the catheter and its surrounding sheath should be included in the model of the distal shaft. The tendon-sheath interaction has not been considered in the existing continuum robots because of the different actuation mechanism.

1.4.3. Related Work on Force Estimation
Although the value of the contact force between the catheter and tissue highly contributes to the effectiveness of the ablation, it is not available to the cardiologist in the traditional procedure. Several research and development activities have focused on providing the interventionalist with the feedback on the contact force during the procedure. Recently, catheter tip force sensors have been used in research [40, 41, 42, 43] and also made commercially available. For instance, Tacticath® and Thermocool® SmarttouchTM have been introduced by St. Jude Medical Inc. and Biosense Webster Inc., respectively. However, there are several issues with the use of these sensors, including potential complications due to the integration of the force sensor such as added weight, extra cost, and reduced maneuverability of the distal shaft. Alternatively, indirect force sensing methods have been proposed in the context of continuum robotics. The flexible nature of continuum robots has been utilized in [44] and [45], for intrinsic force sensing, i.e., determining certain components of an applied end-effector wrench by sensing the actuation loads. It has also been shown that the contact location can be found by sensing the relative positions of points on the robot shape [46]. A probabilistic approach for the force estimation of continuum robots based on tip pose measurements has been presented in [47]. The approach relies on iterative solutions of the BVP of the continuum robot model. Long computation time and the convergence problem of the Extended Kalman Filter disqualifies

10

1.4 Related Work the method for the online force estimation required in ablation procedures. The contact force estimation has recently been developed for ablation catheters based on the curvature measurement obtained from the imaging modalities. However, the approach is able to roughly estimate whether the size of the contact force is exceeding its safe threshold [48]. To overcome the shortcomings of the previous approaches for the case of intracardiac catheters, a force estimation method based on pose measurements is proposed in Chapter 4 for 2D catheter. This may be an attractive solution because the difficulties due to extra sensor integration can be avoided. In addition, the approach is computationally efficient, as apposed to the existing approaches, and can be used for real-time applications. The approach relies on catheter tip pose estimation, which is readily available in many clinical applications. For instance, there are a number of commercially available catheter tacking systems, including CARTO (Biosense Webster Inc., Diamond Bar, CA) and EnSite NavXTM (St. Jude Medical Inc., St. Paul, Minn.), which can be used for this purpose. Additionally, there have been some efforts to fuse different imaging modalities and tracking systems to localize the catheter inside the cardiac chamber [49]. An extension of the force estimation to 3D is also proposed in Chapter 5 which is, to the best of the author's knowledge, is the first 3D force estimation approach amenable to the ablation procedure.

1.4.4. Related Position Control Work
In the catheterization, the tip of the catheter is guided to reach to a desired region on the endocardium. Automatic positioning of the catheter tip can enhance the safety, by reducing the exposure time, and effectiveness of the catheterization procedure by accurate positioning of the RF electrodes to the desired tissue. Control of flexible catheters, and more broadly continuum robots, is an active research topic. Current trends in continuum robot modeling and position control involves the development of forward and inverse kinematic relationships, based on constant curvature or "semi-rigid structure" assumptions [12, 50, 51]. This assumption leads to a closed-form kinematic model of the flexible robot that allows the use of traditional position control algorithms developed for rigid robot manipulators. For instance, the performance of this approach has been studied for position control of a specially designed tendon-driven continuum manipulator [52, 53, 54], a multi-segment continuum robot [54] and an intra-cardiac catheter [55]. Tendon-driven continuum robots

11

1.4 Related Work suffer from non-linear actuation due to friction, backlash, and hysteresis of the tendon mechanism. Several researchers have focused on overcoming these nolinearities for more accurate control of continuum robots [53, 56]. The non-smooth behavior of a steerable catheter due to the tendon actuation mechanism has also been experimentally obtained [57] and modeled [20]. However, current kinematic-based controller developed for catheters [55] relies on a simplified model of the catheter which does not account for the backlash behavior of the distal shaft. In addition to the nonlinearities associated with the tendon mechanism, interaction of the catheter with the environment in which it navigates, contributes to the nonlinear behavior of the catheter. Modeling and compensation of the backlash behavior of the catheter as a result of its friction and buckling inside the guiding sheath has been performed in [58]. However, in this study, the catheter is passive, i.e., it can only move in the axial direction. Another approach for position control of continuum robots that has been specially proposed and implemented for concentric tubes is to use the static Jacobian instead of the kinematic one [59, 60]. This approach requires solution of static model of the catheter which is not practical for fast moving environment of the heart where the control frequency required is more than 10 Hz. Another drawback of the inverse kinematic control, based on constant curvature model, is the singularity of the catheter in multiple points of the workspace which degrades the stability of the motion in the vicinity of the singular points. One approach to avoid singularities is to adopt damped-least squares and singularity robust inverse formulations which come with the cost of limiting the workspace of the robot. In Chapter 6, a position control scheme is proposed for the robotic assisted catheter manipulation system, using the compensated IK, i.e., based on the curves fitted to the real non-smooth behaviour of the distal shaft rather than its simplified constant curvature model. The uniqueness of the proposed controller is that since it is based on the experimental data, it can intrinsically compensate for the non-smooth dynamics of the distal shaft due to the tendon actuation. As opposed to existing approaches, the controller is computationally efficient and singularity-free. Compensation of the backlash behavior of the catheter due to its interaction with the surrounding veins, for both axial translation and rotation, is also incorporated in the control scheme. That makes the proposed scheme an integrated control structure

12

1.4 Related Work for 3D navigation of the commercially-available cardiac catheters.

1.4.5. Related Work on Force Control
Regulating the contact force can improve the safety of the ablation procedure by avoiding the complications resulting from the excessive ablation forces on the endocardium. However, force control in the dynamic environment of the heart with the heart beating frequency of more than 1 Hz is challenging. In academia, there are a few studies that have dealt with the force control of the catheters and guidewires. Force control during the stage of catheter insertion in angioplasty procedure has been studied in [61]. In this research, impedance control methods have been implemented for the control of the insertion force and position of a special active catheter equipped with shape memory alloy actuators. Active motion compensation has been developed to compensate for the heart beat motion [58] followed by a force control in one (axial) direction to regulate the force applied by the catheter tip perpendicular to the heart tissue [62, 63, 40]. In these approaches, the effect of the orientation of the catheter relative to the tissue is not considered, i.e., it is assumed that the catheter can only move in the axial direction while the bending of the distal shaft is not actuated. An indirect impedance control for the class of continuum robots have been introduced and experimentally evaluated on a concentric tube robot [59]. The approach requires real-time solution of a static model of the robot. Due to the computational burden of the static analysis, this approach might not be practical for the ablation catheter navigating in the fast moving environment of the heart. More recently, a hybrid position/force control scheme has been proposed for multi-backbone continuum robots in [64]. In this study, two separate force and position controllers produce commands that are transformed into allowable directions using projection matrices allowing contact force regulation by the tendon-driven continuum manipulator. A force control scheme for a commercially available ablation catheter has also been presented based on the contact force estimation by an optical strain sensor attached to the distal shaft [65]. In a more recent effort of this research group [57], a scheme has been introduced for synchronizing the motion of the catheter tip with cardiac motion by altering the frequency of the distal shaft actuation . However, in these works, the combination of the axial displacement and distal shaft bending are not considered as actuation parameters of the catheter.

13

1.5 Thesis Contributions In Chapter 7, an efficient scheme is proposed for controlling the contact force between the catheter and tissue for commercially available active catheters considering both axial translation and bending of the distal shaft as actuation parameters. The performance of the control framework is evaluated through extensive simulations imitating the ablation procedure and experiments.

1.5. Thesis Contributions
Contributions of this thesis are summarized as the following: Quasi-static modeling of a planar catheter using piecewise circular curve: In Chapter 2 an efficient quasi-static model consisting of piecewise elastic elements is presented for steerable catheters. The uniqueness of the model is that it is lowdimensional and hence is computationally efficient. It can also incorporate modeling of the compound system (distal shaft and catheter body) with inhomogeneous mechanical properties. The experimental contribution of Chapter 2 is identification of the parameters of the new model and verification of the viability of the model to predict the shape of the catheter under the external force. An efficient catheter force estimation based on pose measurements using the piecewise circular curve model: Chapter 4 presents a model-based approach for the estimation of the force applied at the tip of the catheter using the pose data. The feature of the approach is that it is computationally efficient because of the availability of the closed-form Jacobian of the piecewise circular curve model and its low dimensionality. The experimental contribution of Chapter 4 is to demonstrate the feasibility of the proposed framework. A new spatial model of pull-wire driven intra-cardiac catheters based on the theory of Cosserat rod: The contribution of Chapter 3 is a new Cosserat-rod-based model for the deformation of pull-wire driven steerable catheters under external force. The significance of the model is that it leads to an initial value problem for the external forces in the local frame. A new model for the pull-wire actuation mechanism is incorporated

14

1.5 Thesis Contributions in the proposed model that accounts for the effect of the continuous force applied from the pull-wire to the surrounding sheath. In the second half of Chapter 3, the experimental contributions have been presented where the stiffness parameters of the model are identified and the model is verified against the real catheter. An efficient 3D force estimation scheme for intra-cardiac catheters based on the Cosserat-rod model and evaluation of different measurement quantities: In Chapter 5, a 3D force estimation approach is proposed based on the Cosserat-rod model of the catheter developed in Chapter 3. The novelty of the force estimation approach is that it takes advantage of the computational efficiency of the proposed catheter model by choosing the local frame as the coordinate frame in which the external forces are expressed. The force estimation approaches based on different combinations of the relative poses along the catheter as measurement quantities, are evaluated in terms of their feasibility, computation time and error sensitivity. The feasibility of the proposed schemes are validated by experiments performed using electromagnetic (EM) sensors. Position control of a robotic catheter using experimentally-based inverse kinematics: The contribution of Chapter 6 is development of a position control scheme for a robotic assisted manipulation system, using the experimentally obtained inverse kinematics. The uniqueness of the proposed controller is that since it is based on the experimental data, it can intrinsically compensate for the non-smooth dynamics of the distal shaft bending mechanism. As opposed to the existing approaches, the controller is computationally efficient and singularity-free. Compensation of the backlash behavior of the catheter due to its interaction with the surrounding veins, for both axial translation and rotation, is also incorporated in the controller. That makes the proposed scheme an integrated control structure for 3D navigation of the commercially-available cardiac catheters. The second half of Chapter 6 has been devoted to the experimental verification of the proposed position control framework. Hybrid position/force control for intra-cardiac ablation catheters: Chapter 7 introduces the idea of external hybrid position/force control of the catheter for the intra-cardiac ablation. The uniqueness of the proposed framework is that, as

15

1.6 Thesis Structure opposed to the existing literature, it accounts for both axial translation and bending of the distal shaft. It is also computationally efficient so that it can comply with the high speed motion of the cardiac tissue. Specific contributions of this chapter include (1) demonstration of the feasibility of the proposed scheme to regulate the contact force in dynamic heart environment through simulation (2) Obtaining the optimal force and position controllers gain (3) Experimental verification of the proposed control scheme.

1.6. Thesis Structure
Organization of the thesis and the connection between each chapter is visually presented in Fig. 1.3. As shown in this figure the contributions made in this thesis have been divided in three main areas, namely, modeling, force estimation and control.

Spatial force estimation Chapter 5 Planar force estimation Chapter 4

Hybrid position/force controller Chapter 7

Catheter Ablation
PCAR model Chapter 2 Cosserat-based model Chapter 3 Catheter-vein model Chapter 6

Position controller Chapter 6

Figure 1.3.: Structure of the thesis. Under the modeling category, the piecewise circular arc (PCAR) model is developed in Chapter 2 and the Cosserat-based model is introduced in Chapter 3 for predicting

16

1.6 Thesis Structure the shape of the distal shaft under external loads. These models are later be used as underlying components for the planar and spatial force estimation, respectively, in Chapters 4 and 5. An experimentally-based model for the catheter body is obtained in Chapter 6 to simulate the interaction between the catheter and the veins through which it passes. This model is then utilized in Chapter 6 to propose a position control scheme for the cardiac catheter. The presented position controller is used as the internal loop for the hybrid force/position controller introduced in Chapter 7. The thesis is concluded in Chapter 8 by providing directions for future research.

17

2. Planar Catheter Modeling
Developing enhanced catheter force/position strategies, subject of Chapter 7, and contact force estimation schemes, subject of Chapter 4 and Chapter 5, rely on a computationally efficient, yet accurate mathematical model of the catheter. For the former, the catheter model is used in the computation of the Jacobian matrix required for inverse kinematics of the catheter. For the later, iterative solutions of the catheter model equations within a root finding algorithm, e.g., LevenbergMarquardt algorithm, is required to estimate the contact force for the given shape of the catheter. This chapter and the subsequent chapter, deal with developing such a model for commercially available steerable catheters in EP/ablation procedures. Two catheter models have been proposed; piecewise circular arc (PCAR) approach for planar catheter which is presented in this chapter and Cosserat rod-based model for 3D case which will be discussed in the next chapter. The proposed models predict the catheter pose for the given actuation variables and external forces applied during the interventional procedure. The main feature of the proposed models is their computational efficiency. That makes them suitable for real-time applications. Although both models share the same feature, they differ in how the known external forces are represented in their formulations. In the PCAR model the external forces are expected to be known with respect to a fixed global coordinate frame. But the Cosserat rod-based model is more efficient when the external forces are defined in a special local coordinate frame attached to the tip of the catheter. Therefore, each catheter model is more suited for specific applications. For instance, the PCAR model might be more efficient in the Jacobian-based position control when a known external force is applied in a global frame, e.g., weight of a force sensor mounted to the catheter. In this chapter, it is assumed that the catheter deflects in the bending plane, i.e., no out-of-plane deformation occurs as a result of the applied force. This chapter starts with introducing the separate modeling approach for the distal portion and

18

2.1 Consecutive Models and Assumptions the remaining part of the catheter. The proposed PCAR model consists of arcshape elasticas connecting to form the back-bone curve of the catheter. Kinematic and static equations of the PCAR model are obtained in Section 2.2 for the general case. The subsequent section describes how Jacobian matrices for the static and kinematic equations of the PCAR model are derived in a closed-form leading to the computational efficiency of the force estimation and control algorithms. To empirically verify the PCAR model, first the parameters of the model are calibrated using a set of experimental data performed on an ablation catheter. Then the verification is conducted and the experimental results are discussed in Section 2.3.

2.1. Consecutive Models and Assumptions
During the intra-cardiac procedure, the catheter is inserted through the patient's vasculature, usually from the femoral vein, so that the distal shaft of the catheter could reach the cardiac chambers. The overall model of the catheter is divided into two separate parts: model of the distal shaft and model of the catheter body. The reason stems from the fact that the behavior and properties of the distal shaft is different than the remaining part of the catheter. The distal shaft comes in contact with the cardiac tissue to perform the EP study or ablation. Therefore, its surrounding sheath is made of a less stiffer material to make the distal shaft more flexible than the remaining part of the catheter. That causes the actuation mechanism to only bend the distal shaft of the catheter. The shape of the catheter body, however, is dictated by the shape of the veins in which it is inserted into. Therefore, the catheter body can be viewed as a media that transfers the axial displacement and rotation of the handle to the distal shaft. The main feature of such a separate catheter modeling approach is its computational efficiency since the model of the catheter body can be reduced to a simple mapping between its input and output displacements. Both models proposed in this chapter and the subsequent chapter, consist of separate models for the catheter body and the distal shaft. A schematic representation of the proposed consecutive model of the catheter is represented in Fig. 2.1. The catheter body model involves a mathematical representation which relates the twist and translation of the handle, h and xh respectively, to the twist and translation of the body, b and xb . The model of the distal shaft, on the other hand, maps the rotation

19

2.2 Piecewise Circular Arc Approach of the knob, k (subscript k denotes knob), as well as translation and rotation of the body to the instantaneous shape of the distal end of the catheter, more specifically position of the catheter tip (xt , yt , zt ).
b
xb

xh

xt , y t , zt
b
Catheter body model

h
k

xb
Distal shaft model

Figure 2.1.: Proposed consecutive model of the catheter. Using the proposed consecutive model, it is possible to simplify the catheter body model by finding a relation between the axial translation and twist of the handle and those of the distal shaft, instead of solving the instantaneous static equations. Such a relation for a commercially available ablation catheter is obtained in Chapter 6. Another assumption, which is made for both planar and spatial models of the catheter, is to ignore the dynamic effect of the catheter in the interventional procedures. In other words, the transient vibration of the catheter as a result of the applied force is neglected. This assumption can be justified by the low mass and inertia of the catheter, its high damping due to the surrounding fluid, internal friction of the distal shaft and low velocity of the catheterization procedure.

2.2. Piecewise Circular Arc Approach
This section introduces the PCAR approach in which the catheter backbone curve is parametrized using piecewise circular arcs. As opposed to the existing models of continuum robots, the proposed model satisfies all of the requirements mentioned in Section 1.4.1 for the problem at hand. Specifically, it is low-dimensional and

20

2.2 Piecewise Circular Arc Approach computationally efficient. It can also incorporate modeling of the compound system (distal shaft and catheter body) with inhomogeneous mechanical properties. It is assumed that the catheter deforms in a single plane. The justification for this is that due to the lower friction against the catheter twist compared to the axial motion, when a lateral contact force is applied to the catheter, it is easily rotated while remaining almost planar. The higher bending stiffness of the catheter in the lateral direction also assists the planar assumption in being accurate in the current application. In commercially available ablation catheters, the distal shaft is usually more flexible than the remainder of the catheter due to the different materials used for their surrounding sheath. In addition, the electrode rings near the tip of the catheter locally increase the bending stiffness. Therefore, assigning different bending stiffnesses to the piecewise curves is expected to lead to an accurate model of the catheter. The idea of using piecewise circular arcs for quasi-static modeling of flexible rods has been raised in the context of computer graphics, e.g., in [66]. However, the idea has not been applied in the context of continuum robotics or, specifically, steerable catheters for quasi-static modeling of the robot under the external loads.
y Fy Fx s O x
1 3 3 EI , 3

1 2
2

EI , 1

 (s)

EI , 2

Figure 2.2.: Configuration of the catheter approximated by three curves.

2.2.1. Kinematics
A typical ablation catheter is depicted in Fig. 2.2. Each point on the backbone curve of the steerable catheter is characterized by the angle, (s), where s is the arc length parameter. Therefore, the position of each point along the robot can be determined by ^s x (s) =
0

^s cos  ( ) d, y (s) =
0

sin  ( ) d.

(2.1)

21

2.2 Piecewise Circular Arc Approach This is the arc length parametrized representation of the curve and guarantees that the length of the curves remains constant. Assume a steerable catheter consisting of n consecutive tangent elasticas, i.e., homogeneous unshearable and inextensible slender mediums with stiffness EI i , curvature i and length i . The selection of the number of pieces is subject to the consideration given to the accuracy-efficiency trade-off. In this thesis, we assume n = 3, as depicted in Fig. 2.2. The first curve represents the portion of the catheter body that lies inside the cardiac chamber, whereas the distal shaft is modeled by the second and third curves. It is shown later that this selection of the number of curves gives satisfactory results for the problem at hand. Considering  = d/ds and the fact that the curves are constrained to be mutually tangent at their connection points, the curve angle associated with i-th curve, i (s), can be obtained as
i-1

i (s) = i s +
j =1

j (j

- i ).

(2.2)

For clarifications, curve angle and shape of a double curve PCAR is shown in Fig. 2.3. Substituting (2.2) into (2.1) and integrating, the results give xi (s) =
j j i- 1 1 1 1 sin i (s) + [ sin( p p ) - sin( p p )], i j +1 p=1 p=1 j =1 j

(2.3)

j j i-1 1 1 1 1 yi (s) = - cos i (s) + [ cos( p p ) - cos( p p )]. 1 i j p=1 p=1 j =1 j +1

(2.4)

The pose of the catheter tip, pt = {xt , yt , t }, can be obtained by setting s = in (2.2)-(2.4).

n i=1 i

2.2.2. Statics
In this section, equilibrium equations for the intra-cardiac catheter are derived considering the PCAR approach for its geometric modeling. It is assumed that the external forces in the horizontal and vertical directions, Fx and Fy , respectively, are applied at the tip of the catheter, e.g., where it comes into contact with the heart tissue in an ablation procedure. Therefore, the applied force at the tip is consider-

22

2.2 Piecewise Circular Arc Approach
0.7 0.6 1.6 0.5 1.4 2 1.8

Y position (m)

 (rad)

0.4 0.3 0.2 0.1 0 0

1.2 1 0.8 0.6 0.4 0.2

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0 0

0.2

0.4

0.6

0.8

1

X position (m)

Arclength s (m)

Figure 2.3.: Curve angle (right) and shape (left) of two PCARs (1 = 1 m-1 , 2 = 3 m-1 , 1 = 2 = 0.5 m ). ably higher than that at other parts of the distal shaft. However, this assumption can be easily relaxed to include drag forces resulting from the blood flow. Considering that shear and extension are neglected, the only potential energy term stored in the system as a result of the applied loads is elastic potential energy due to the bending. From continuum mechanics, the bending potential energy of a rod is defined as [67] ^ EI2 ds,
0

1 U= 2

(2.5)

where is the total length of the rod. The gravitational effect is neglected due to the low mass of the catheter. The total bending potential energies of the n circular curves can be written as 1 m 1 n 2 EI i i 2 + EI i i (i - 0 i i) , 2 i=1 2 i=m+1

U=

(2.6)

where m is the number of assigned curves for the catheter body. Bending of the distal shaft is modeled by assigning an initial value, 0 i , to the curvature of the piecewise curves associated with the distal shaft. Assuming the initial shape of the distal shaft as a constant-curvature curve is in accordance with [10], where this assumption has been experimentally verified for a typical intra-cardiac catheter. The external work of the system includes the work done by forces applied at the tip of the distal shaft

23

2.2 Piecewise Circular Arc Approach as follows:

W = Fx xt + Fy yt .

(2.7)

Using the virtual work principle, W = U , with (2.6) and (2.7), leads to n nonlinear algebraic equations with n unknowns: xt yt U + Fy = i i i

Fx

i = 1, 2, .., n

(2.8)

Note that the bending actuation of the catheter is included in this equation by the initial curvature 0 i . These equations can be solved numerically for the given external forces to obtain arc curvatures and consequently the shape of the catheter using (2.3) and (2.4). The equations have been derived for n =3 in the following cos (1 1 ) - 1 1 + sin (1 2 1 3 sin (1 1 ) -
1

P1 = Fy -Fy -
1

1

+ 2
2)

2 1

+ 3

3)

+
1

1

1

sin (1
2)

1)

2

2

sin (1
1

1

+ 2

+

3

sin (1

+ 2

Fx 2 sin (1 1 ) + 1 2 2 1 2 Fx - ( 1 cos (1 1 + 2 2 ) - 3
1

cos (1 cos (1
1

1)

1

1

+ 2
1)

2

+ 3

3 ))

+Fx

2

cos (1

1

+ 2

2)

+

1

cos (1

- EI 1 1

1

= 0,

(2.9)

P2 = -

Fx (sin (1 2 2

1)

- sin (1

1

+ 2

2)

+ 2

2

cos (1

1

+ 2

2 ))

Fx ( 2 cos (1 1 + 2 2 ) - 2 cos (1 1 + 2 2 + 3 3 )) 3 Fy + 2 (cos (1 1 + 2 2 ) - cos (1 1 ) + 2 2 sin (1 1 + 2 2 )) 2 Fy + ( 2 sin (1 1 + 2 2 + 3 3 ) - 2 sin (1 1 + 2 2 )) + EI 2 3

2

0 2 - 2 = 0, (2.10)

24

2.2 Piecewise Circular Arc Approach

P3 =

Fy (cos (1 3 2

1

+ 2

2

+ 3

3)

- cos (1

1

+ 2

2 ))

Fx (sin (1 1 + 2 2 ) - sin (1 1 + 2 2 + 3 3 ) + 3 3 cos (1 3 2 Fy 3 + sin (1 1 + 2 2 + 3 3 ) + EI 3 ( 2 + 3 ) 0 3 - 3 = 0. 3

1

+ 2

2

+ 3

3 ))

(2.11)

2.2.3. Features of the PCAR Model
Thanks to closed-form kinematic equations for the PCAR approach, the Jacobian matrix of the kinematic equations can be obtained in a closed-form. This feature is beneficial, specifically, for the computational efficiency of the curvature estimation stage of the force estimation approach, which will be detailed in Chapter 4. Without loss of generality and for the purpose of illustrating merits of the proposed model, assume the catheter consists of 3 circular curves. Equations (2.2)-(2.4) can thus give the position of the tip of the catheter for s = 1 + 2 + 3 . The curvature estimation involves solving the nonlinear equations (2.12)-(2.14) 1 sin 1 1 1 sin(1 2 1 sin 1 2
1

E1 =

1

+

1

+ 2 2 ) - 1 sin(1 3

1

+

1 sin(3 ( 3

1

+

2

+

3)

+ 1 (1 - 3 ) -

2 (2

- 3 )) -

+ 2 2 ) - xt = 0,

(2.12)

E2 = -

1 cos(3 ( 3

1 1 - cos 1 1 1
1

1

-
3)

1 cos(1 2 +
1 (1

1

+ 2 2 ) +
2 (2

1 cos 1 2

1

+

1 cos(1 3

1

+ 2 2 ) (2.13)

+

2

+

- 3 ) -

- 3 )) - yt = 0.

E3 = 3

3

+ 2

2

+ 1

1

- t = 0

(2.14)

where subscript t is associated with the tip of the catheter. Numerical solution of the above-mentioned equations requires calculation of the following Jacobian matrix

25

2.2 Piecewise Circular Arc Approach that is called kinematic Jacobian of the PCAR model,

E1 1 E2 1 E3 1 E1 2 E2 2 E3 2 E1 3 E2 3 E3 3

   . 

JKin = 

  

(2.15)

where E1 to E3 are the right hand side for the PCAR kinematic equations. The first element of the Jacobian matrix, and similarly all the elements, can be obtained in a closed-form as E1 1 = cos (1 1 1 -
1

1)

-

sin (1 1 ) 1 cos (1 - 1 2 2
1

1)

+

1

2

cos (1

1

+ 2

2)

3

cos (1

1

+ 2

2)

+

3

cos (1

1

+ 2

2

+ 3

3 ).

(2.16)

Static Jacobian of the PCAR model, which is obtained by taking derivative from static equations, (2.9) to (2.11), is defined as

P1 Fx P2 Fx P3 Fx P1 Fy P2 Fy P3 Fy

   . 

JSt =  




(2.17)

Similar to the kinematic Jacobian, the static Jacobian can be obtained in a closedform, for instance P1 1 = cos (1 Fx 1 -
1

1)

-

sin (1 1 ) 1 - cos (1 2 1 2 +
1

1)

++
3 ).

1

2

cos (1

1

+ 2

2)

3

cos (1

1

+ 2

2)

3

cos (1

1

+ 2

2

+ 3

(2.18)

The static and kinematic Jacobian matrices are provided in a closed-form in Appendix B. These two characteristics of the proposed model will be used in Chapter 4 to obtain an efficient force estimation scheme. Another benefit of the PCAR model is that it allows convenient inclusion of the kinematic constraints imposed by the environment into the model. An example

26

2.3 Experimental Validation of such constraints is the positional constraint at the location of puncture during transseptal catheterization. Assume the catheter passes through the inter-atrial septal wall at the arc-length sw . The location of the puncture is assumed to be known with respect to a global frame as xp and yp . The constraint equations simulating the transseptal punctures can be stated as

x(sw ) = xp , y (sw ) = yp , (2.19)

where the right hand side can be written as a function of the curvature of the piecewise arcs using (2.3) and (2.4).

2.3. Experimental Validation
This section describes the experiments conducted using a steerable catheter under various external loading conditions. The purpose is to identify the parameters of PCAR and examine its accuracy against the real catheter. In each of the following experiments, known point force is applied by hanging calibration weights at the tip of the catheter. To apply forces in directions other than the gravity direction, a two-link mechanism is used with a low-friction pulley attached at the end of the moving link (Fig. 2.4). By adjusting the angle of the moving link, a constant norm of the force can be applied in different directions to the tip of the catheter. The initial curvature of the catheter and its shape after deflection are obtained by measuring the position of the markers on the catheter using a coordinate measuring machine (CMM) machine (Mitutoyo AE112, resolution: 0.001mm). The direction of the applied force can also be obtained by measuring the string angle.

2.3.1. Identification
For the PCAR model to accurately emulate the static behavior of the real catheter, the PCAR parameters, EI i and i , should be experimentally identified. Three arcs are used for the modeling of the catheter. The first curve is associated with the body of the catheter; thus, its length is set to 1 = xb , where xb is the axial translation

27

2.3 Experimental Validation

F


xb

Figure 2.4.: Experimental setup for the catheter static model. of the catheter. In the catheterization procedure, this value is controlled, manually or through a robotic mechanism, to insert or detract the catheter inside the cardiac chamber. The remaining two curves model the distal shaft behavior; therefore, the number of PCAR parameters is reduced to one length (considering the given length of the distal shaft) and three flexural stiffness parameters. The identification process involves finding the stiffness and length of piecewise curves that minimize the sum of the distances between m points along the catheter obtained by the experiment and those predicted by the model for the set of 15 experiments. The minimization objective function can be formulated as follows
20 m

F itness =
k=1 j =1

||rmodel (sj ) - rdata (sj )||k ,

(2.20)

where the optimization parameters are EI 1 , EI 2 , EI 3 and 2 . The identification is implemented using the Nelder­Meade simplex algorithm in MATLAB for a commercially available ablation catheter, namely, ThermoCool SF (Biosense Webster, Los Angeles, CA). Justification for choosing the simplex algorithm is that the objective function is non-linear and its derivatives are not available. The results of the identification are listed in Table 2.1.

28

2.3 Experimental Validation Table 2.1.: Geometrical and mechanical properties of catheters. Identified parameters EI 1 1.490 Nmm2 2 EI 430 Nmm2 EI 3 250 Nmm2 19.2 mm 2 Measured parameters Length of distal shaft 70 mm Distal shaft diameter 7 F (2.33 mm)

2.3.2. Verification
To validate the presented model, point forces are applied with different sizes, F , and different angles, , to the tip of the catheter, which has an initial curvature of 0 and a length for the body portion of xb (Fig. 2.4). These parameters are listed in Table 2.2. The maximum distance error in the last column of this table is calculated for each experiment by measuring the distance between the marker positions and their associated points on the model. The shape of the catheter predicted by the model and that obtained experimentally are compared in Fig. 2.5. With the identified parameters, the maximum tip error over all 12 experiments is 1.85 mm, which corresponds to 2.5% of the total arc length of the catheter. The reported range of the model error is deemed acceptable for the problem at hand since, roughly speaking, the ablation procedure is effective for a region with the radius of less than 1 mm around the target point on the endocardium. The small increase in the error for the higher initial curvature cases may be due to the deviation of the initial shape of the distal shaft from the circular arc as a result of its inhomogeneous mechanical properties. This error contributes to almost 10% of the total error. Another reason is that it was assumed that the body portion of the catheter is initially straight, whereas small deflections of the body portion are observed for high initial curvatures of the distal shaft. The friction between the pulley and the string also increases the error by making the real force less than the weight of the calibration masses.

29

2.4 Summary
Exp.1 Exp.2 Exp.3 Exp.4 Exp.5 Exp.6 Exp.7 Exp.8 Exp.9 PCAR

60

40

20

Y (mm)

0

-20

-40

-60 -20 0 20 40 60 X (mm) 80 100 120 140

Figure 2.5.: Shape of the catheter obtained by experiment versus model. Table 2.2.: Experimental parameters and results.
No. xb (mm) 0 (mm-1 )  ( ) |F | (N) Max. error (mm)

1 2 3 4 5 6 7 8 9 10 11 12

48.5 48.5 48.5 48.5 48.5 41.3 41.3 41.3 41.3 41.3 41.3 41.3

0.0157 0.0157 0.0157 0.0157 0.0157 0.02 0.02 0.02 0.02 0.07 0.07 0.07

270 270 270 270 270 240 193 222 157 270 61 116

0.0125 0.0484 0.0895 0.1197 0.1578 0.1230 0.1578 0.1578 0.2220 0.2220 0.2866 0.2866

0.76 1.40 1.45 1.34 1.01 1.02 1.91 2.74 2.03 2.72 1.39 2.57

2.4. Summary
In this chapter, a quasi-static model for the planar catheter was developed. The catheter was modeled as a planar elastica, consisting of consecutive circular curves.

30

2.4 Summary The parameters of the model were obtained through experiments, leading to a precise description of the shape of the catheter for the given external forces. The approach incorporates modeling of the compound system (distal shaft and catheter body) with inhomogeneous mechanical properties. The low dimensionality of the model and the availability of the closed-form Jacobian for both kinematic and static equations, guarantees the time efficiency of its computation. Moreover, since the model provides the overall shape of the catheter, redundant pose sensing along the length of the catheter can be added to assist the reliability of the potential force estimation approach. The accuracy of the presented model was shown to be clinically acceptable. In Chapter 4 the details of the force estimation scheme based on the PCAR model will be presented.

31

3. Spatial Catheter Modeling
This chapter presents a new model for the three-dimensional quasi-static navigation of steerable catheters. Similar to the model presented in Chapter 4, the proposed model incorporates modeling of the compound system (distal shaft and catheter body) for axial translation. However, as opposed to the PCAR model, it is able to account for out-of-plane deformation of the catheter. The model presented in this chapter is derived by coupling the classical Cosserat rod model with an accurate model of the tendon actuation. This chapter is organized as follows. The governing equations of the catheter model based on Cosserat rod theory is derived in Section 3.1. Section 3.2 is structured around different aspects of the modeling of ablation catheters. It discusses the proposed approaches for accurate tendon actuation model, efficiency of the catheter model subjected to the external forces in real application and modeling the axial translation of the catheter. The proposed model is then compared with the experimental results in Section 3.3.

3.1. Cosserat Rod Model
In this section, a brief introduction of the Cosserat theory of elastic rods is given. Presented formulation and nomenclature are similar to Antman's work [31]. However, unlike the common applications of the Cosserat rod theory in continuum robots, e.g., [38], [36], the governing equations here are written in local frame. We take advantage of this form of the governing equations later in Section 3.2.2.1 where the equations constitute an initial value problem (IVP) for the forces given in the local frame at the tip. In that sense, the approach is similar to the one introduced in [68] for animation of flexible thin objects.

32

3.1 Cosserat Rod Model

3.1.1. Kinematics
Let ei , i = 1, 2, 3, denote a fixed, right-handed orthonormal basis for a global frame as depicted in Fig. 3.1. Let the position of the center-line of the rod (dash-dotted) with respect to the global frame, be defined by vector r(s)  R3 where s  [0, ] is the arc-length parameter and is the unstretched length of the rod. the orientation of the cross section of the rod is characterized by the material frame with the orthonormal basis di , i = 1, 2, 3, also called directors. The basis of directors is adapted to the curve: the third director d3 points in the tangent direction of the curve. The vectors d1 and d2 show the position of two material lines in the cross section of the rod. Therefore, the Cosserat rod can be fully defined by its center-line curve in space and its rotation of the cross-section with respect to the global frame, R(s)  SO(3) (special orthogonal group) where,

di (s) = R(s)ei ,

i = 1, 2, 3.

(3.1)



d3 ( s)
Local frame
d2 (s)

d1 (s)

c1
r(s)
e3

c2

Global frame
e2

e1

Figure 3.1.: Kinematics of the nonlinear rod. The strain vector v = [v1 , v2 , v3 ] can be defined as the local rate of change of the position of the center-line along the rod where v1 and v2 are shear strain along d1 and d2 , respectively and v3 is the stretch along the center-line. In other words, we have

 (s) = v1 d1 + v2 d2 + v3 d3 , r

(3.2)

33

3.1 Cosserat Rod Model where dot sign represents derivative with respect to arc-length. As a common assumption in the treatment of elastic rods, the shearing is neglected (v1 = v2 = 0) and rod is assumed to be inextensible (v3 = 1), thus (3.2) is reduced to

 (s) = d3 . r

(3.3)

The evolution of the basis di along the curve is represented by the Darboux vector  = c1 d1 + c2 d2 +  d3 where c1 and c2 are curvatures along d1 and d2 , respectively and  is torsion. The subscript c denotes the Cosserat rod model and distinguishes the symbol from the one used for the PCAR model. Considering the constant length of the unit vectors, the derivative of di with respect to the arc-length is reduced to the following vector product

 i =  × di , d

i = 1, 2, 3.

(3.4)

3.1.2. Forces and Moments
Let

n(s) = n1 d1 + n2 d2 + n3 d3 , m(s) = m1 d1 + m2 d2 + m3 d3 ,

(3.5) (3.6)

denote the internal force and moment vectors, respectively, acting on the crosssection originally at s in the reference configuration. Recall that n1 , n2 are shear forces, n3 denotes axial force, m1 , m2 are bending moments and m3 represents twisting moment. The local form for the force and moment balance is given by [31]

n  (s) + f (s) = 0, m  (s) + r  (s) × n(s) = 0.

(3.7) (3.8)

where () is defined as a derivative with respect to s and f = f1 d1 + f2 d2 + f3 d3 is the external force distribution vector per unit of s.

34

3.1 Cosserat Rod Model

3.1.3. Constitutive Laws
Linear constitutive laws are used to map the internal forces and moments to the local deformation of the rod,
0 0 m1 = EI1 (c1 - 0 c1 ), m2 = EI2 (c2 - c2 ), m3 = GJ ( -  ),

(3.9)

with E denoting the Young's modulus governing the bending resistance, G represents the shear modulus governing the torsional resistance, I1 and I2 are second moments of area of the cross section about d1 and d2 axes, respectively, and J = I1 + I2 is the polar moment of inertia of the cross section about d3 , originating at its centroid. Curvature and torsion of the rod in its initial state, when no external force is applied, are denoted by superscript zero in the above equations.

3.1.4. Governing Equations
Taking derivative of (3.5) with respect to arc-length and substituting from (3.4) for the derivative of the local frame basis, simplifies (3.7) to n 1 + c2 n3 -  n2 + f1 = 0, n 2 - c1 n3 +  n1 + f2 = 0, n 3 + c1 n2 - c2 n1 + f3 = 0.

(3.10)

which are the force balance equations along d1 , d2 and d3 . Similarly, (3.8) can be expanded by taking derivative from (3.6) and applying (3.4) when taking derivative of the moving basis, as well as using (3.5) and (3.3). The result is reduced to m  1 + c2 m3 -  m2 - n2 = 0, m  2 - c1 m3 +  m1 + n1 = 0, m  3 + c1 m2 - c2 m1 = 0. (3.11)

Substituting curvatures and torsions with their equivalent moments from (3.9) in (3.10) and (3.11) leads to a set of six ordinary differential equations with six unknowns (n1 , n2 , n3 , c1 , c1 ,  ) that can be solved numerically. Next section explains the application of the governing rod equations for the intra-cardiac catheter.

35

3.2 Tendon-driven Catheter Model

3.2. Tendon-driven Catheter Model
In the last section, the governing equations of the Cosserat rod has been derived. In the following, different modeling aspects that are required to be integrated in the overall model of intra-cardiac catheters are discussed.

3.2.1. Tendon Actuation Model
The distal shaft can be deflected as a result of pulling the tendon attached to its tip. Assume that d1 is initially perpendicular to the catheter deflection plane. The tendon actuation mechanism can be modeled by a single external moment which is applied at the tip along d1 , MT = FT e (Fig. 3.2) where FT is the tendon tension force. This approach, which has often been used in the modeling tendon-driven continuum robots (e.g., in [69]), is convenient because it leads to simple classical boundary conditions. However, more accurate model of the tendon actuation in 3D can be obtained by taking into account the effect of the tendons on the catheter. The effect of tendons which pass through channels of supporting disks has been included in the model for the tendon-driven continuum robots [38]. However, for the steerable catheters where the tendon is confined in the sheath, this analysis remains to be performed. In the case of the steerable catheter, since the central plate of the distal shaft and the tendons are constrained by the surrounding sheath, bending of the distal shaft causes the tendons to come in contact with the sheath. As opposed to the interaction between the tendon and supporting disks in continuum robots where a point force with a direction defined in the global frame is applied to the tendon [38], in catheters the force exerted from the tendon to the sheath is continuously applied in the material frame. To have a clear picture of the interaction force between the catheter and its surrounding sheath, assume that in a distal shaft, shown in Fig. 3.2, the tendon is pulled with the force FT . As a result of the tendon tension, a continuous force is applied from the surrounding sheath to the tendon making it comply with the sheath shape. Let us assume this continuous force per unit length is defined in the local frame along the tendon as  = 1 d1 + 2 d2 . To obtain the value of  for the given tendon tension force, we make use of the equilibrium equations for the tendon element depicted in Fig. 3.2.

36

3.2 Tendon-driven Catheter Model
d1 d3 e d2

FT (s)

Tendon element
FT

FT

Figure 3.2.: Tendon actuation model. The static friction in tendon-sheath and tendon-central plate interactions is neglected mainly because of the low normal forces between the interacting surfaces. As a result, tension force, FT is constant along the tendon. The tendon is assumed to behave as a string, i.e., it cannot support internal moments and shear forces. Hence, the force balance equation (3.7) is the only static equation of the tendon element. By substituting the internal forces of the string as n1 = n2 = 0, the force balance (3.7) along d3 , is reduced to

n 3 = 0,

(3.12)

and thus n3 = FT . Using the obtained internal forces, the force balance equations along d1 and d2 can be simplified to the following equations, describing the distributed force applied on the tendon

1 = -c2 (s)FT , 2 = c1 (s)FT .

(3.13) (3.14)

Note that the tendon tension is constant along the length under the frictionless assumption but curvature is a function of the arc-length. The continuous force applied to the catheter from the tendon, is apparently equal to  in the opposite direction. The model of the distal shaft coupled with the tendon actuation model

37

3.2 Tendon-driven Catheter Model can be obtained by introducing force distributions in (3.10) as f = -. Additionally, the tendon tension force is applied at the tip of the catheter in d3 direction, along with the moment MT which compensates for the eccentricity of the tendon tension force. All the interaction forces and moment applied from the tendon to the catheter have been depicted in Fig. 3.3.

3.2.2. Modeling External Forces
Consider a catheter with the distal shaft length and the body portion length d, lays out of the guiding sheath as depicted in Fig. 3.3 (guiding sheath is not depicted). The catheter can be modeled as a Cosserat rod with the assumptions mentioned earlier. It is assumed that the base of the rod is located at the origin and oriented along the global frame, i.e., r(0) = 0 and R(0) is equal to the identity matrix. Since the flexibility of the catheter is more than its axial and twisting frictions against the guiding sheath, an instantaneous fixed boundary condition for the base of the rod is justifiable to pursue the quasi-static analysis. Two scenarios for the external forces can be considered as follows. 3.2.2.1. Force in Local Frame In the rod model depicted in Fig. 3.3, we assume an external point force, Fm = F1 d1 + F2 d2 + F3 d3 , is applied at the end of the rod, s = + d, in addition to the force and moment resulting from the tendon actuation. In practice, the dominant external force is the contact force between the catheter and the surrounding tissue during the ablation. Thanks to the boundary conditions at the end of the rod, the derived ordinary differential equations can be treated as an IVP. The curvature parameters, internal forces and moments along the rod can be obtained by numerical integration of (3.10) and (3.11) using the the initial conditions at the tip. Once the curvatures (c1 ,c2 ), and torsion  are calculated, the initial values of the position and orientation of the rod at s = 0 are used as the initial value for integrating (3.4) to determine the spatial pose of the rod. Therefore, the pose of the rod can be obtained by two integration sweeps from the tip to the base and vice versa. Care should be taken while performing the second integration to maintain the membership of the rotation matrix to SO(3). One method is to adopt the unit quater-

38

3.2 Tendon-driven Catheter Model

( s )

FT F3 F1 MT d e3 e1 e2 F2

Figure 3.3.: Schematic view of the catheter modeled as a rod. nion for representing the rotation matrix. The quaternion is advantageous over Euler angle representation because it avoids the singularity and is more computationally stable. A unit quaternion is defined by a vector Q = (q1 , q2 , q3 , q4 ) with qk = ak sin(/2) for k = 1 to 3, and q4 = cos(/2). Here, (a1 , a2 , a3 )T is the rotation axis, and  denotes the rotation angle. Four quaternion parameters qk are coupled by the norm constraint |Q| = 1. The rotation matrix can then be written in terms of the quaternion as

2 2 2(q1 + q2 ) - 1 2(q2 q3 - q1 q4 ) 2(q2 q3 + q1 q3 )  2 2 + q3 ) - 1 2(q3 q4 - q1 q2 )  R =  2(q2 q3 + q1 q4 ) 2(q1 . 2 2 2(q2 q4 - q1 q3 ) 2(q2 q4 + q1 q2 ) 2(q1 + q4 )-1





(3.15)

By substituting (3.15) into (3.4) and after some manipulation we arrive at


 =1 Q 2

      

-q2 -q3 -q4 q1 -q4 q3 q4 q1 -q2 -q3 q2 q1

        

c1 c2 

   , 

(3.16)

which represents the rotation of the local frame by the quaternion parameters instead of directors. Equation (3.3) can also be represented by the quaternion parameters as

39

3.2 Tendon-driven Catheter Model

2(q2 q3 + q1 q3 )   r  = Rd3 =  2(q3 q4 - q1 q2 )  . 2 2 )-1 + q4 2(q1
 

(3.17)

One can obtain the rotation of the local frame and spatial position of the center-line of the catheter by numerical integration of (3.16) and (3.17), respectively. Note that the initial value of the quaternion and the position of the center-line are provided at s = 0. Assuming the simple Euler method for numerical solution of the ordinary differential equations (3.10) and (3.11), for n number of elements, the number of the operations can be approximated as 40n. Number of arithmetic operations and thus the computation time is independent of the size of the applied force or curvature of the catheter, indicating that the proposed method can be implemented in real-time for modeling the interventional procedure. The proposed model of the catheter can ideally be used in a contact force estimation algorithm. The details of the pose-based force estimation will be presented in Chapter 5. 3.2.2.2. Force in Global Frame Assume that the external force defined in the global frame, Fg = Fx e1 + Fy e2 + Fz e3 , is applied at the tip of the catheter with the boundary conditions discussed in the previous section. In practice, this force might be due to the cardiac blood flow (assuming the average of the drag forces along the catheter is applied as a point force) or the weight of the pose/force sensor mounted at the tip of the catheter. In either case, the magnitude of the force is perceived to be less than 0.12 N, as reported in [70] for the drag force of the cardiac blood flow. The objective here is to compute the Jacobian matrices required for the force/position control in an efficient manner. To take advantage of the computational efficiency of the IVP, in this section, an iterative treatment of the problem is proposed. The approach is basically similar to the shooting method for boundary value problems (BVPs) with the advantage of the computationally efficiency of the approach because of the initial guess is close to the final solution for the practical range of the applied force. The procedure is

40

3.2 Tendon-driven Catheter Model outlined as follows. The IVP discussed in the previous section is solved, iteratively with the initial assignment of the force in material frame being Fm = 0. This guess leads to a result close to the final solution, since the size of the external forces is perceived to be limited for the problem at hand. Then the procedure continues iteratively by assigning new guesses to the applied forces as Fm = RT ( + d)Fg with R( + d) being the rotation of the tip corresponding to the solution of the previous guess. Note that the Fg = RFm because of the definition in (3.1). The procedure continues until the difference between the consecutive rotation matrices is less than a threshold. The orientation difference index is defined here as Manhattan or L1 norm of orientation difference vector, i.e., Q = | q1 | + | q2 | + | q3 | for the two iterations where q1 , q2 and q3 are quaternion parameters representing the orientation of the tip cross section. It is worth noting that a more accurate orientation error quantity can be defined based on properties of the quaternion group algebra [71]. The procedure is outlined in Algorithm 3.1. Algorithm 3.1 Static analysis of a catheter for forces in global frame. Initialization: Set RT ( + d)[1] = 0 %Iterative solution of IVP. for n = 1 to Nmax % Maximum number of iterations Solve IVP for Fm = RT ( + d)[n]Fg Calculate RT ( + d)[n+1] if Q< % Error threshold Exit end The iterative shape of the catheter center-line, converging from the initial shape to the equilibrium state is shown in Fig. 3.4. The external force is given in the global frame as Fx = 0.1 N. Mechanical and geometrical properties of the catheter 1 in Table 3.2 have been chosen for this simulation and the rest of simulations in this section. As shown in the figure, the algorithm converges after 5 iterations, indicating the computational efficiency of the approach. The error threshold can control the accuracy of the algorithm against its computation time. In the following simulations error threshold is chosen as 0.001 rad. The tip position difference between the two iterative solution associated with this value of the error threshold is less than 1 µm. Convergence of the approach has been analyzed in Fig. 3.5 for the practical range of the external forces and curvatures of the catheter. The required number of algorithm iterations has been plotted against the size of the applied force in global frame for different curvatures covering straight

41

3.2 Tendon-driven Catheter Model

0.04
Final solution

Intermidiate shapes

Initial shape

0.03

Z (m)

0.02

0.01

0 0 0.01 0.02 0.03 Y (m) 0.01 X (m) -0.01 0 -0.02

Figure 3.4.: Shape of the catheter as a result of the iterative solution of IVP. distal shaft to the almost fully deflected one. The forces are assumed to be applied at the tip with the magnitude from 0 to 0.2 N. Results indicate that the algorithm converges to the solution for the conditions experienced by the catheter in the ablation procedure. As illustrated in Fig. 3.5, higher value of the applied force requires more iterations and thus computation time to converge. The number of iterations for |F| = 0.126 N, the upper bound of drag forces due to the cardiac blood flow, is less than 9 iterations which is associated with 0.0315 second computation time. More in-depth computation time analysis has been performed by comparing the computation speed of the proposed method with the conventional approach. To obtain the governing equations of the Cosserat rod for the conventional method, in equilibrium equations, (3.7) and (3.8), the internal forces and moments are remained in the global frame without being transformed to the local frame. Different orientation representation can also be used to quantify the orientation of the rod cross section. For instance quaternion has been used in [36], Euler angles in [72] and direct local curvatures and torsion in [34, 38] to represent the orientation. The obtained nonlinear differential equations, with the unknowns including the general forces and orientation parameters, together with the boundary conditions, which include given general forces in the global frame, form a BVP. Here, the conventional method is adopted by using the quaternion representation of the orientation, to obtain the

42

3.2 Tendon-driven Catheter Model
0 =0 1 30 1 =8 1 =16 1 =33 25 =50 0 1
0 0 0

Number of iterations

20

15

10

5

0 0

0.02

0.04

0.06

0.08

0.1

0.12

0.14

0.16

0.18

0.2

Applied force (N)

Figure 3.5.: Number of required algorithm iterations for catheter external forces. governing equations. The comparison between the proposed and the conventional approach was completed under MATLAB® environment on an Intel® Pentium® 4 computer with CPU speed of 3.00 GHz. For both methods, the computation time was recorded for fully solving the entire catheter shape by discretizing its length via 500 elements. The external force is applied at the tip of the catheter in the global frame with increasing size up to 0.2 N. Curvature of the distal shaft covers the working range of the catheter in the ablation procedure. The computation time for either methods has been listed in Table 3.1. Results indicate that the proposed method can satisfy the online control requirement of 20-30 Hz while conventional approach cannot be used due to the long computational time. Table 3.1.: Computation time analysis for the proposed method. Catheter loading and curvature
-1 |Fg |=0-0.05 N, 0 c1 =0-45 m -1 |Fg |=0.05-0.1 N, 0 c1 =0-45 m -1 |Fg |=0.1-0.15 N, 0 c1 =0-45 m -1 |Fg |=0.15-0.2 N, 0 c1 =0-45 m -1 |Fg |=0.2-0.25 N, 0 c1 =0-45 m

Proposed method 0.003-0.021 s 0.011-0.028 s 0.025-0.032 s 0.014-0.045 s 0.021-0.11 s

Conventional BVP 0.526-2.110 s 0.969-2.114 s 1.209-2.132 s 1.1664-2.137 s 1.211-2.156 s

43

3.2 Tendon-driven Catheter Model

3.2.3. Catheter Navigation Model
Up to now, we have focused on the bending of the distal shaft by the tendon actuation. But besides the bending of the distal shaft, navigation of the catheter is performed through the axial translation and twisting of the body. In a number of cases of the ablation treatment, a portion of the catheter body is required to lay out of the guiding sheath to allow the tip to reach the region of interest. The body of the catheter is usually made stiffer than the distal shaft, since it doesn't directly interact with the heart tissue. Modeling the compound system (catheter body plus distal shaft) requires special treatment since, beside the different stiffnesses, the catheter body is not affected by the tendon actuation but deflects by the external forces applied to the catheter. To model this behavior, first the tendon actuation model is modified by replacing the tendon tension moment, MT , with the equivalent initial constant curvature of the distal part of the catheter along d1 axis, 0 c1 = MT /EI1 , in (3.9). Note that the initial curvature here is the curvature when there is no external force is 0 applied. Other curvature parameters are zero at initial state, i.e., 0 c2 =  = 0. The two models are physically equivalent [51] but the latter allows us to simulate the compound system by attributing different curvatures along the catheter. We assign c0 1 and zero respectively, to the initial curvature of the body portion and the distal shaft of the catheter. Therefore, by substituting (3.9), (3.13) and (3.14) into (3.10) and (3.11), the governing equations for the distal shaft can be written as m1 m2 n3 m3 n2 - + FT ( + 0 c1 ) = 0, EI2 GJ EI1 m2 m1 n3 m3 n1 + - 0 FT = 0, n 2 - c1 n3 - EI1 GJ EI2 m1 n2 m2 n1 n 3 + - + 0 c1 n2 = 0, EI1 EI2 n 1 +

(3.18)

m  1 + m2 m3 (

1 1 - ) - n2 = 0, EI2 GJ 1 1 m  2 + m1 m3 ( - ) + n1 - 0 c1 m3 = 0, GJ EI1 1 1 m  3 + m1 m2 ( - ) + 0 c1 m2 = 0. EI1 EI2

(3.19)

44

3.3 Experimental Results For the catheter body portion, in (3.18) and (3.19), the terms associated with the initial curvature and tendon-sheath interaction are eliminated because the catheter body doesn't deflect by the tendon actuation. The governing equations are then solved consecutively for the distal shaft and the catheter body with their specified stiffness to obtain the shape of the catheter. The obtained shape of the catheter is depicted in Fig. 3.6 for the increasing force applied along d1 axis. The internal forces, moments and curvature parameters along the catheter are illustrated in Fig. 3.7. Modeling the axial translation of the catheter can now be performed by controlling the distance d. To simulate the catheter with only a portion of its distal shaft laying out of the guiding sheath, a negative value can be assigned to d in the proposed model. Twisting of the catheter with a certain angle is simulated by rotating the obtained shape, with the specified angle along e3 axis.

0.08 0.07

F=0.1
0.06 0.05 Z (m) 0.04 0.03 0.02 0.01 0 0.02 X (m) 0

F=0.05 Initial shape

F=0.15

0 -0.02 -0.04 0.02 -0.06 0.04 Y (m)

Figure 3.6.: Shape of the catheter as a result of the applied force in local frame (F1 = 0.05, 0.1, 0.15 N)

3.3. Experimental Results
This section explains several experiments conducted to examine the accuracy of the proposed model, with all the aspects introduced in section 3.2, against the real catheter. In the following experiments, a known point force is applied by hanging calibration weights at the tip of the catheter. To obtain the shape of the catheter,

45

3.3 Experimental Results

Internal force (N)

0.2 0.1 0 -0.1 0 x 10
-3

n1 n n
0.01 0.02 0.03 0.04 0.05 0.06 0.07 0.08 0.09 0.1 2 3

Internal moments (Nm)

10 5 0

m1 m
2

m3
0.01 0.02 0.03 0.04 0.05 0.06 0.07 0.08 0.09 0.1

-5 0

Curvatures (1/m)

60 40 20 0 0 0.01 0.02 0.03 0.04 0.05 0.06 0.07 0.08 0.09 0.1

1 2 

Arc length (m)

Figure 3.7.: Variation of internal forces,moments and curvatures along the catheter -1 (F1 = 0.2 N, 0 = 70 mm). c1 = 60 m , d = 40 mm, positions of the markers along the catheter are measured using a CMM machine (Mitutoyo AE112, resolution: 0.001mm) as shown in Fig. 3.8. First step to perform the experimental validation is to calculate the mechanical and geometrical parameters of the catheter. Length of the distal shaft and the body portion of the catheter can be accurately measured by the CMM machine. However, stiffness parameters of the catheter should be identified experimentally. In this analysis, constant bending stiffness is assumed for the distal shaft in both directions and GJ = 0.3846E (I1 + I2 ). The last equation is obtained by letting E which is a valid relation for homogenous Poisson's ratio,  = 0.3 in G = 2(1+ ) isotropic materials along with J = I1 + I2 . The identification process involves finding the pair of stiffness for each portion of the catheter that minimizes the sum of distances between m points along the catheter obtained by the experiment and those predicted by the model for the set of 20 experiments. The minimization objective function can be formulated similar to (2.20) for the planar case, for the optimization parameters EI1 , EI2 , Eb Ib1 and Eb Ib2 where subscript b denotes that the parameter is associated with the catheter body. The identification has been implemented using the Nelder­Meade simplex algorithm in MATLAB for two commercially available ablation catheters: Livewire (St. Jude Medical, St. Paul, MN) and SteeroCath-T (BostonScientific, Natick,

46

3.3 Experimental Results

Measured points d z y x

Fx

Figure 3.8.: Experimental setup. MA) which are named as catheter 1 and catheter 2, respectively. Results of the identification have been listed in Table 3.2. Table 3.2.: Geometrical and mechanical properties of catheters. Parameter EI1 (Nm2 ) EI2 (Nm2 ) GJ (Nm2 ) Eb Ib1 (Nm2 ) Eb Ib2 (Nm2 ) Gb Jb (Nm2 ) Distal shaft length (mm) Distal shaft diameter Catheter 1 0.0239e-3 0.1961e-3 0.0846e-3 0.0195e-3 0.7044e-3 0.2784e-3 70 7 F (2.33 mm) Catheter 2 0.1902e-3 0.4168e-3 0.2692e-3 0.6163e-3 0.8052e-3 0.5384e-3 70 7 F (2.33 mm)

To validate the proposed model, point forces with different sizes have been applied to the tip of the catheter with the initial curvature of 0 and body potion length d, (see Fig. 3.8). The initial curvature of the catheter can be obtained from measuring the shape before applying the force. Note that in a clinical setting, the initial curvature can be obtained by finding an off-line relation between the knob rotation and the distal shaft curvature. An example of such relations will be presented for a commercially available catheter in Chapter 6. The results have been listed in Table 3.3 for the forces along the x and y axes. Error is calculated for each experiment

47

3.3 Experimental Results by measuring the distance between the marker positions and their associated points on the model. The shape of the catheter obtained from the experiment and the one predicted by the model are compared in Fig. 3.9 to Fig. 3.11. As shown in these figures, the experimental results are in good agreement with the predicted points by the model. Mean value of the tip error for all the experiments reported in Table 3.3 is 1.97 mm which corresponds to 3.5% of the total length of the catheter.
60 #1 #2 #3 #4 #5 #6 #7 Cosserat

40

20 Y (mm) 0 -20 -40 0

20

40

60 Z (mm)

80

100

Figure 3.9.: Shape of the catheter 2 obtained by experiment versus model for inplane forces. One source of the error in the experiments is that the mechanical properties are not constant along the catheter. The electrodes close to the tip increase the local bending stiffness, causing the shape of the distal shaft to deviate from its assumed circular shape when no force is applied. This might explain higher maximum error for the higher initial curvature cases. Another factor that contributes to the error in the experiment is the fact that due to the low stiffness of the distal shaft, applying large forces causes plastic deformation, bringing about deviation of its mechanical properties over time. Catheter shape measurement is also subject to error since it requires manual positioning of the CMM needle to be tangent to the markers.

48

3.3 Experimental Results

70

60

50

40 Z (mm) #8 #9 #10 #11 #12 #13 #14 Cosserad

30

20

10

0 -20 0 X (mm) 20 -10 0 10 20 30 40 Y (mm) 50 60

Figure 3.10.: Shape of the catheter 1 obtained by experiment versus model for out-of-plane forces.

100 80 Z (mm) 60 40 20 0 60 40 Y (mm) 20 0 -50 50 0 #15 #16 #17 #18 #19 #20 #21 Cosserad

X (mm)

Figure 3.11.: Shape of the catheter 2 obtained by experiment versus model for out-of-plane forces .

49

3.3 Experimental Results

Table 3.3.: Experiments parameters and results.
No. 1 Catheter 2 2 3 4 5 7 8 Catheter 1 9 10 11 12 14 15 Catheter 2 16 d (mm) 40.9 40.9 40.9 40.9 40.9 40.9 40.9 -1 0 c1 (m ) 8 8 8 8 29 29 29 F (N) Max. error (mm) 1.95 3.26 1.10 1.88 1.09 2.47 3.02

6

13

32 32 32 34 34 34 34 48 48 48 48 18 18 18

57 57 57 29 29 29 29 12 12 12 12 48 48 48

Fy =-0.0648 Fy =-0.2215 Fy =-0.0125 Fy =-0.2215 Fy =-0.0646 Fy =-0.2220 Fy =-0.0258 Fx =0.012 Fx =0.026 Fx =0.032 Fx =0.008 Fx =0.012 Fx =0.026 Fx =0.039 Fx =0.008 Fx =0.012 Fx =0.026 Fx =0.049 Fx =0.012 Fx =0.026 Fx =0.049

1.62
2.16 2.87 1.05 1.38 1.91 2.03 2.24 2.40 2.93 0.79 1.09 2.52

1.59

17
18 19 20 21

50

3.4 Conclusions

3.4. Conclusions
An efficient model of the catheter is required as a building block for force estimation and model-based navigation control of the catheter. Considering the forces experienced by the catheter in a typical intra-cardiac operation, the model should be able to predict the shape of the catheter for the forces expressed in both global and local frames. This chapter proposed such a model for the catheter utilizing Cosserat rod theory to form an efficient IVP method and an iterative IVP approach respectively, for the forces given in local frame and global frame. A new model for the tendon actuation mechanism was also presented that accounted for the effect of the continuous force applied from the tendon to the surrounding sheath in material frame. In spite of being more accurate, the obtained model does not jeopardize the efficiency of the solution. Another challenge that was successfully dealt with was modeling axial motion of the compound system of the catheter body and the distal shaft, leading to an accurate and efficient navigation model for intra-cardiac catheter. Having performed several experiments simulating the condition of ablation operation, it was illustrated that the mechanical property of the catheter can be identified by bending stiffness in two directions for each section. Based on the identified parameters, the viability of the proposed 3D model of the catheter was experimentally verified to serve as a model that can later be used in force estimation or model-based control of the device. However, before this ends, a mapping between the translation and twist of the catheter handle and its end of the catheter body, which lies inside the guiding sheath, should be obtained. Experimental evaluation of such a mapping is the subject of Chapter 6. Integrating this mapping with the current model provides a complete model for the intra-cardiac catheter in practice.

51

4. Planar Catheter Force Estimation
4.1. Introduction
The objective of the ablation procedure is to apply a stable contact force to the region of interest on the endocardium for a specific duration [73]. The interaction force between the catheter and tissue should remain within an optimal range. Excessive contact force might cause severe complication such as cardiac perforation and weak contacts might result in an ineffective treatment [74]. However, contact force is not available for the interventionalist during the ablation in the traditional catheterization. Research and development activities have thus focused on providing the interventionalist with the contact force feedback during the procedure. This chapter introduces the contact force estimation using the measured pose data to improve the safety and effectiveness of the cardiac ablation procedure. The force estimation approach can potentially be used in conjunction with the existing pose sensing technologies to provide the forces applied by the catheter to the heart tissue in ablation procedures. The force estimation approach in this chapter is based on the PCAR model developed in Chapter 2. Therefore, similar to the PCAR model, it is assumed that the catheter remains in the bending plane as a result of the external force. The extension of the force estimation approach to 3D case, will be discussed in the next chapter. Both planar and spatial force estimation frameworks rely on computationally efficient models of the catheter. However, their underlying catheter models differ in how the known external forces are represented in their formulations. Consequently, the force estimated by each of the proposed force estimation approaches is defined in a different coordinate frame. The planar approach provides the forces in a fixed global frame but the spatial model estimates the forces in a specific local frame at the catheter tip. Considering a wider range of applications of the force estimation approaches, in the applications where the direction of the force is not of importance,

52

4.1 Introduction both methods might be equally suited. If the direction of the force is required to be accurately estimated with respect to a fixed frame, e.g., in needle insertion procedure, the planar force estimation is deemed superior. A block diagram displaying the force estimation scheme in high level is depicted in Fig. 4.1. The rest of this chapter is organized as follows. Section 4.2 proposes the force estimation approach and details its computation algorithm. The computation of the inverse problem requires iterative solution of the direct problem, the PCAR model. Hence, the computational efficiency of the PCAR model is advantageous to obtain an online force estimation algorithm. The proposed force estimation approach should be evaluated to asses if it can uniquely predict the contact force for a single measured pose. To do so, the condition experienced by the catheter in a typical ablation procedure are simulated and the estimated forces are compared with the real ones. This analysis is discussed in Section 4.3. The sensitivity to the measurement noise and computation time of the proposed force estimation approach are also evaluated in Section 3.2 through numerous simulations. Experimental validations of the force estimation approach are discussed in Section 4.4.
 ¯0 , x b Actuation parameters pt Catheter pose

Catheter

h- 1

 ¯ F Cont Contact force

g -1

Force estimation algorithm

Figure 4.1.: Block diagram of the catheter force estimation.

53

4.2 Computation of the Estimated Force

4.2. Computation of the Estimated Force
The catheter modeling problem introduced in Chapter 2, which will be referred to as the direct problem, can be simplified by two cascade functions g and h as follows:  ¯ = g (F,  ¯0 , xb ), p(s) = h( ¯, xb ), (4.1) (4.2)

where g represents n nonlinear equations of the PCAR model, (2.9) to (2.11) for n = 3. The function g provides the curvatures of the catheter at equilibrium,  ¯ = {i }, i = 1, 2, ..., n, for the given applied force, F = {Fx , Fy }, and the actuation parameters,  ¯0 = {0i } and xb . The shape of the catheter, p(s) = {x(s), y (s), (s)}, can then be calculated using the geometrical equations (2.2), (2.3) and (2.4), represented by function h in (4.2). For the force estimation, on the other hand, the objective is to find the external forces for the given actuation parameters and the current shape of the catheter. However, due to technical limitations, the shape of the catheter is not usually known for all of the arc lengths. Here, the feasibility of the force sensing technique is investigated for the case of having the pose of the catheter tip, pt , e.g., the solution of the following cascade functions:  ¯ = h-1 (pt , xb ,  ¯ 0 ), F = g -1 (¯ ,  ¯0 , xb ), (4.3) (4.4)

where h-1 and g -1 can be viewed as the inverse of h and g , respectively. For the curvature estimation, we again use the geometrical equations, (2.2)-(2.4), this time for the given actuation parameters and tip pose, pt . The roots of the three nonlinear equations are found to obtain n curvatures of the PCAR model. The resulting nonlinear system are solved using the Levenberg-Marquardt approach [75], as implemented by MATLAB's fsolve function. In section 4.3, it will be shown that for the given initial conditions of the Levenberg-Marquardt method, which are associated with the unloaded shape of the catheter, the algorithm converges to the global minimum, i.e., the real value of the contact force, for the simulated ablation operation.

54

4.3 Simulations Analysis After obtaining the curvatures, static equations of the PCAR will be solved for the estimation of the applied forces. This step requires the solution of n linear equations with 2 unknowns. The Levenberg-Marquardt algorithm is used to find the solutions of g -1 , which is associated with the force that minimizes the sum of squares of n static equations (2.8). The reason for choosing the Levenberg-Marquardt algorithm is that it can robustly handle non-linear non-square problems. The availability of the kinematic and static Jacobian matrices in closed-form (see Appendix B) can also be utilized within the algorithm to improve the speed of the convergence. The advantage of the PCAR approach for modeling the catheter is highlighted by the efficient computation of the functions h-1 and g -1 because the Jacobian required for either functions, (2.15) and (2.17), respectively, is available in a closed form. Moreover, the force estimation algorithm can fully utilize the low dimensionality of the PCAR model because the number of arithmetic operations in the calculation of the Jacobian in each iteration of the estimation algorithm is minimal.

4.3. Simulations Analysis
To verify the feasibility of the proposed force estimation approach, several simulations have been performed. In the simulations, the catheter is modeled by three PCARs with the parameters listed in Table 2.1. The catheter tip pose is used for the estimation of the contact force, following the procedure mentioned above. To demonstrate that the proposed method is able to converge to a unique solution under medical conditions, the initial curvatures and contact forces experienced by the catheter in an ablation procedure have been selected. The magnitudes of the forces are considered to be 0.15, 0.25 and 0.35 N, thereby simulating the range of contact forces used in intra-cardiac ablation [74], [76]. The direction of the applied forces, which is characterized by the angle , spans 180 degrees, as shown in Fig. 4.2 to simulate all the feasible force directions applied to the catheter by surrounding tissue. The estimated force versus the real external force are depicted in Fig. 4.3, Fig. 4.4 and Fig. 4.5 for initial curvatures of the distal shaft equal to 0.01, 0.02 and 0.03 mm-1 , respectively. For all of the simulations shown in Fig. 4.3, values of zero have been selected as the initial guess of the root-finding algorithm for the estimated forces in both directions. As depicted in this figure, the algorithm is able to accurately esti-

55

4.3 Simulations Analysis

F

 
F

Figure 4.2.: Schematic view of the catheter with the force angle. mate the applied forces in the x and y directions. The magnitude of the estimation error are about 10-5 N regardles of the size and direction of the applied force. These results imply the one-to-one relation between the tip pose and the estimated forces using the proposed approach for the practical range of the ablation procedure. It should be noted that the type and number of measurement parameters have been carefully selected to obtain such a one-to-one relation between the estimated force and the measurement quantities. Selecting the position (instead of the pose) of the tip as the measurement parameter, for instance, results in trapping in local minima and a considerable estimation error.
0.2 0.1 Estimated (|F|=0.15 N) Estimated (|F|=0.25 N) Estimated (|F|=0.35 N) Known

F x (N)

0 -0.1 -0.2 -0.3 120

140

160

180

200

220

240

260

280

300

0.2 0.1

F y (N)

0 -0.1 -0.2 -0.3 120 140 160 180 200 220 240

Estimated (|F|=0.15 N) Estimated (|F|=0.25 N) Estimated (|F|=0.35 N) Known

260

280

300

 (Degrees)

Figure 4.3.: Estimated force compared with the real one for different sizes and directions of the applied force (initial curvature: 0.01 mm-1 ).

56

4.3 Simulations Analysis

0.3 0.2 0.1 Estimated (|F|=0.15 N) Estimated (|F|=0.25 N) Estimated (|F|=0.35 N) Known

F x (N)

0 -0.1 -0.2 -0.3 180 0.1 0 Estimated (|F|=0.15 N) Estimated (|F|=0.25 N) Estimated (|F|=0.35 N) Known 200 220 240 260 280 300 320 340

F y (N)

-0.1 -0.2 -0.3

180

200

220

240

260

280

300

320

340

360

 (Degrees)

Figure 4.4.: Estimated force compared with the real one for different sizes and directions of the applied force (initial curvature: 0.02 mm-1 ).

0.3 0.2 0.1 Estimated (|F|=0.15 N) Estimated (|F|=0.25 N) Estimated (|F|=0.35 N) Known

F x (N)

0 -0.1 -0.2 200 0.1 0

220

240

260

280

300

320

340

360

380


Estimated (|F|=0.15 N) Estimated (|F|=0.25 N) Estimated (|F|=0.35 N) Known

F y (N)

-0.1 -0.2 -0.3

220

240

260

280

300

320

340

360

380

 (Degrees)

Figure 4.5.: Estimated force compared with the real one for different sizes and directions of the applied force (initial curvature: 0.03 mm-1 ).

57

4.3 Simulations Analysis The computation time of the direct and inverse problems have been investigated for the initial configurations and applied forces experienced by the cardiac catheter in a typical ablation procedure. For the latter, PCAR statics equations, (2.9) to (2.11), have been solved numerically for the known applied forces. The obtained tip poses are then fed to the force estimation algorithm to approximate the applied forces. The simulations have been implemented on an Intel® Pentium® 4 computer with a CPU speed of 3.00 GHz. The Levenberg-Marquardt algorithm has been implemented to solve both direct and inverse problems. The results listed in Table 4.1 demonstrate the feasibility of the proposed approach for the online force estimation in intracardiac procedures where the heart tissue moves with a frequency of approximately 1 Hz. Table 4.1.: Computation time analysis for the direct and inverse problems. Catheter loading and curvature |F|=0.05 |F|=0.10 |F|=0.15 |F|=0.20 |F|=0.25 N, N, N, N, N, 0 1 =0-0.045 0 1 =0-0.045 0 1 =0-0.045 0 1 =0-0.045 0 1 =0-0.045 mm-1 mm-1 mm-1 mm-1 mm-1 Direct problem 7.8 ms 8.2 ms 8.3 ms 9.0 ms 11 ms 12 ms Inverse problem 0.0190 0.0201 0.0188 0.0193 0.0245 s s s s s

-1 |F|=0.30 N, 0 1 =0-0.045 mm

0.0280 s

The effect of the pose measurement noise on the estimated force is illustrated in Fig. 4.6. In this simulation, a constant force, shown by the arrow, is applied at the tip of the catheter with different initial configurations. Assuming the position of the catheter tip is sensed with ±1 and ±2 mm measurement errors, as shown by two circles around the tip, the associated estimated forces for either case are indicated by the ellipses representing the end of the force arrow. As shown in this figure, in certain directions, the estimated force is more sensitive to the accuracy of the tip position measurement, therein making the force arrow follow an ellipse rather than a circle. It is also evident that the accuracy of the approach depends on the initial curvature of the catheter. The sensitivity of the force estimation approach to a tip angle error of ±3 is represented by a line in the middle of each ellipse. Therefore, the proposed approach is less sensitive to the tip angle noise of 3 compared to the tip position of 1 mm. Considering the accuracy of the position and orientation measurements of existing electromagnetic pose sensors used in medical applications, Fig. 4.6 shows that including the tip angle in the measurement quantities can improve

58

4.4 Experimental Validation the robustness of the force estimation algorithm against measurement noise.
50 40 30 Y (mm) 20 10 0 -10 0 20 40 60 X (mm) 80 100 120 140 Error: ± 1 mm Error: ± 2 mm Error: ± 3 °

Figure 4.6.: Effect of position sensing error on estimated force (scale 200 mm: 1 N).

4.4. Experimental Validation
To verify the feasibility of the proposed force estimation approach, a setup shown in Fig. 4.7 was prepared. The Aurora electromagnetic tracking system (NDI, Waterloo, ON, Canada) is deployed to track the positions of the catheter tip. Aurora provides the position and orientation (pose) of its small sensors placed in the electromagnetic field generator's measurement volume with an accuracy of 0.9 mm for the position measurements and 0.8 for the orientations. Position and orientation precision achieved by the sensor are 0.4 mm and 0.2 , respectively [77]. In the experiments, one sensor coil is attached to the tip of the distal shaft, as shown in Fig. 4.7. The position readings from the sensors are calibrated so that the sensor represents a point on the catheter's central line. For each experiment, first the initial shape of the catheter is measured using the EM sensor attached to a wooden stylus. The markers along the catheter are manually touched by the stylus to record the shape of the catheter. Then, a known point force is applied by hanging calibration weights at the tip of the catheter (i.e., for setting =-90 ). Using the algorithm introduced in Section 4.2, the size and the angle of the applied force are estimated for the given initial curvature of the catheter. Note that the tip pose data required for the force estimation algorithm are provided by the sensor attached to the tip of

59

4.5 Conclusion the catheter. The PCAR parameters in the algorithm are adjusted based on those listed in Table 2.1. Each experiment, for a specific weight, is repeated 10 times to assess the repeatability of the force estimation approach. The estimated forces are listed in Fig. 4.8.
Field generator

Sensor
F

Figure 4.7.: Experimental setup for force estimation. As shown in this figure, the proposed approach is able to predict the size of the applied force and its direction with an accuracy of ±0.02 N and ±10 degrees, respectively. The error of the estimated force direction is also shown to be larger for the smaller force magnitudes. This is because for smaller forces, the tip deflection is smaller; hence, the measurement error of the tip position greatly contributes to the error in the estimation of the direction of the applied force. Two main sources of error affect these experiments: the pose measurement error of the EM sensors and the discrepancy between the PCAR model and the real catheter. The latter can be reduced by including the weight of the added sensor in the static model.

4.5. Conclusion
In this chapter, a model-based approach for the estimation of the force applied at the tip of the catheter using the pose information was presented. The proposed force

60

4.5 Conclusion
0.2

Force magnitude (N)

0.15 0.1 0.05 0

Force direction,  (degree)

1

2

3

4

5

-80 -85 -90 -95 -100 -105 1 2 3 4 5

Experiment set number

Figure 4.8.: Estimated size and direction of the applied force versus real values. estimation scheme relies on the PCAR model of the catheter. Adopting the PCAR model in the force estimation scheme provides several benefits; the low dimensionality of the model and the availability of the closed-form Jacobian for both force and curvature estimation guarantee the computational efficiency of the algorithm. Moreover, because the model provides the overall shape of the catheter, redundant pose sensing along the length of the catheter can be added to increase the reliability of the force estimation approach. Several analysis were performed simulating the forces and configurations experienced by the catheter during the ablation procedure. It was shown, through these simulations that by selecting the pose of the tip as the measurement quantity, the proposed force estimation approach leads to a one-to-one relation between the input (tip pose data) and the output (estimated forces). The results of experiments, performed using the EM sensor attached to the tip of the catheter indicate the feasibility of the proposed scheme for estimating the contact force in an ablation procedure. Several directions can be suggested for further improving the robustness of the proposed technique. The accuracy of the model can be improved by adopting more piecewise curves in the model at the cost of higher computation times. However, the computation time can still be reduced by implementing more efficient numerical techniques in optimal programming platforms. Another improvement is to enhance the robustness of the proposed technique against environmental noise by utilizing

61

4.5 Conclusion the pose sensors along the catheter. Extending the proposed approach to 3D is another intuitive step that requires including torsional elastic energy to the potential energy of the system. The last two research objectives are accomplished in the next chapter.

62

5. Spatial Catheter Force Estimation
5.1. Introduction
In the previous chapter, the force estimation based on the PCAR model for planar catheter was discussed. In this chapter, the force estimation is extended to 3D case where the catheter can experience out-of-plane deflection. The core of the forceestimation algorithm is the spatial model of the catheter based on the Cosserat rod which was introduced in Chapter 3. As was shown therein, the proposed model is specially computationally efficient for when the external forces are in the local frame. In this chapter, we take advantage of this feature of the proposed model to develop a computationally efficient force estimation algorithm. During the ablation procedure, the catheter experiences axial translation and rotation. Therefore, absolute values of the position of the catheter cannot be chosen as measurement quantities of the force estimation scheme. In Section 5.2, different measurement quantities have been analyzed and compared in terms of feasibility, error sensitivity and computation time through simulations. The proposed force estimation approaches are experimentally verified in section 5.4.

5.2. Force Estimation
The catheter modeling problem that was introduced in Chapter 3 is the problem of finding the shape of the catheter as a result of the known external forces and the actuation parameters of the catheter. Here, we are more interested in the case when the known external forces are expressed in the local frame. This model which is referred to as direct problem, can be represented by function D in (5.1)

g(s) = D(Fm , q),

(5.1)

63

5.2 Force Estimation where q is the vector of actuator values. For the ablation catheter, the actuation parameters include the bending angle of the distal shaft, rotation angle and displacement of the handle. The external force in local frame attached to the tip of the catheter is denoted by Fm . Parameter g(s) is a homogeneous transformation defining the backbone position and orientation at arc length s. The unit quaternion denoted by a vector Q = (q1 , q2 , q3 , q4 ) with the parameters defined in Section 3.2.2.1, is used to represent the rotation of the local frame attached to the catheter backbone curve along x, y and z axes. The solution of the direct problem can be obtained by numerical integration of the IVP problem introduced in Section 3.2. For the force estimation, the objective is to find the external forces for the given actuation parameters and the current shape of the catheter. However, due to technical limitations, shape of the catheter is not usually available for all the arc-lengths. It is assumed that the pose of j -th sensor mounted on the catheter associated with the  arc-lengths sj , namely gj , are available. Pose sensors are numbered by subscript j , from zero at the tip to the base of the distal shaft as depicted in Fig. 5.1. Superscript star and () denote, respectively, that the quantity measured by the sensors and predicted by the model at the specific point. The force estimation can be represented by the function I as follows

 Fm = I (gj , q ).

(5.2)

The output of the force estimation problem is the estimated force expressed in the local frame. Choosing the local frame as the coordinate frame in which the external forces are expressed, has a significant effect on the computational efficiency of the force estimation approach. The contact force in the ablation procedure can be presented by the force estimation algorithm to the interventionalist either in the local or global frame of reference. However, from the algorithm implementation point of view, the underlying Cosserat model within the force estimation algorithm can considerably run faster if the forces are expressed in the local frame. To solve the indirect problem, one can use the solution of the direct problem iteratively to derive at the external forces that produce the same poses measured by the sensors. An efficient numerical implementation, e.g., Gauss­Newton, can be utilized in the core of the force estimation algorithm. These numerical solutions rely on the

64

5.2 Force Estimation
s2 h2 s1 h1

s0 F1 F3 F2

d e3 e1 e2

Figure 5.1.: Schematic view of the catheter with measurement points and the applied forces. computation of the position and orientation Jacobian matrices,  Qj ¯ rj , Jo = ,  Fm  Fm

Jp =

(5.3)

which can be calculated efficiently by finite difference, owing to the fact that (3.18) and (3.19) form an IVP. It is worth noting that because in the direct problem, it was assumed the external forces are expressed in the local frame, this is also the case for the estimated force by the force estimation algorithm. The objective of the root-finding algorithm is to find zeros for function L which, in its general form, is defined as the distance between an appropriate function of the measured position and orientation of the points along the catheter and the predicted ones by the model, i.e.,

L=

| (rj  ) -  (rj )| +

| (Q j ) -  (Qj )|.

(5.4)

where functions  (.) and  (.) are chosen based on practical considerations. Different scenarios can be considered for the number of measurement points and the quantities to be measured for the force estimation algorithm. In this research, six scenarios are selected for the function L and the performance of the force estimation algorithm for

65

5.2 Force Estimation each choice is evaluated. These scenarios have been selected to address difficulties in implementation of the force estimation approach in catheter ablation procedure. The difference between the measured orientation by the j -th sensor and the predicted one by the model at the arclength sj is quantified based on properties of the quaternion group algebra [71] as

j  ,j  = q4 ,j 

  

q 1,j q 2,j q 3,j





     - q4 (s0 )   

 q1 ,j  q2,j  q3 ,j





0 q 3,j -q 2,j

    -  

-q 3,j q 2,j 0 -q 1,j q 1,j 0

    

 q1 ,j  q2,j  q3 ,j

   . 

(5.5)

Case 1 (Absolute position of a single sensor): It is assumed that the position of the tip of the catheter is provided. In this case, L is defined as the position difference between the measured position and approximated one by the model, i.e.,

L = |r 0 - r0 |.

(5.6)

Case 2 (Absolute position and orientation of a single sensor): Due to the uncertainty associated with the dynamic environment of the heart, measured data might be noisy so that the accuracy of the force estimation may be adversely influenced. Using the additional sensory information might improve the performance of the force estimation approach. In this case, it is assumed that the orientation of the tip of the catheter can also be measured. To normalize the position difference and reconcile the entities with different units in the cost function, the position difference id divided by , the length of the distal shaft of the catheter. Value of L then is the summation of the position and orientation difference between the measured values and those predicted by the model, i.e., 1 L = |r 0 - r0 | + |

0 ,0 |.

(5.7)

Case 3 (Relative position of two sensors): Catheter ablation involves axial insertion of the catheter and thus translation of the distal shaft during the procedure. Therefore, relying on absolute values of the position of the measurement points along the catheter is not practical. To overcome this problem, relative position of the two points on the distal shaft is proposed as the measurement quantity for the

66

5.2 Force Estimation force estimation algorithm. An additional sensor is attached to the catheter at the arc length s = s1 as depicted in Fig. 5.1. Therefore, value L can be defined as the difference between the measured relative position of the two points and the predicted one by the model, i.e.,

 L = |r 1 - r0 - (r1 - r0 )|.

(5.8)

Case 4 (Relative position of two sensors and their absolute orientations): To increase the accuracy yet minimize the number of sensors, in addition to the relative position, absolute orientation of the two sensors are measured and fed to the force estimation algorithm. Note that here, similar to the case 3, the force estimation scheme does not rely on the absolute values of the position thus the estimated force is independent of the location of the catheter distal shaft inside the heart. Similar to (5.7), the first term of the cost function is normalized to restore consistency between the position and orientation error. 1  L = |r 1 - r0 - (r1 - r0 )| +
1

|
j =0

j  ,j |.

(5.9)

Case 5 (Relative orientation of two sensors): Beside its translation, the catheter might experience rotation due to the heart beating, respiratory motion and patient movements. Rotation of the catheter during the procedure, deteriorate the accuracy of the force estimation algorithms based on relative and absolute position measurements. To tackle this issue, we propose using solely the relative orientation of two sensors on the catheter to estimate the external force at the tip. Value L can be stated as the difference between the measured relative orientation of the two sensors and the relative orientation estimated by the model, i.e.,

L=|

0 ,1

-

0,1 |.

(5.10)

Case 6 (Relative orientation of three sensors): Mutual relative orientation of the second and the third sensor with respect to the tip sensor is chosen as the measurement quantities for the force estimation scheme. Similar to the case 5, the estimated force is independent of the overall position and orientation of the distal

67

5.3 Simulations Analysis shaft and
2

L=
j =1

|

0 ,j 

-

0,j |.

(5.11)

5.3. Simulations Analysis
To verify the performance of the proposed force estimation approach, several simulations have been performed for different measurement cases. The proposed force estimation algorithm is evaluated for each measurement quantity case, in terms of three criteria: feasibility, error sensitivity and computation time. In the simulations, the catheter is modeled as a Cosserat rod with the parameters identified in Section 3.3 and listed in Table 3.2 for the catheter 1. The distances of the second and the third sensors with the tip has been selected as h1 = 30 mm and h2 = 50 mm, respectively. Following the force estimation approach introduced in previous section, for each case, the nonlinear system formed by the associated L value is solved, using Levenberg-Marquardt method [75], as implemented by MATLAB's fsolve function.

5.3.1. Feasibility
Feasibility of the proposed force estimation approach for different measurement quantities is evaluated using numerous simulations covering the conditions experienced by the catheter in the ablation procedure. In each simulation a known force is applied at the tip of the catheter. The measurement quantities are obtained using the simulated catheter. Using the method introduced in the last section, the contact forces are estimated for difference measurement quantities and compared against the known value. The estimated force versus real external force applied at the tip of the catheter is shown in Fig. 5.2 for the cases 1 to 6. The magnitude of the applied forces is chosen as 0.2 N (as an average value of the contact force in ablation procedure) and their direction, which is characterized by the angle  (F1 = |F | cos , F2 = -|F | cos , F3 = |F | sin ), spans 2 angle. Initial conditions of the Levenberg-Marquardt method have been set to zero. Initial curvature and axial displacement are set to 10 m-1 and 0.01 m, respectively. Sensors 1 and 2 are attached to the distance h1 = 30 mm and h2 = 50 mm from the catheter tip.

68

5.3 Simulations Analysis

0.5 0 -0.5

-1 -1.5 -2 -2.5 0 0.5 0 -0.5 1 2

Case 1 Case 2 Case 3 Case 4 Case 5 Case 6 Real
3 4 5 6

F 2 (N)

F 1 (N)

-1 -1.5 -2 -2.5 0 0.5 1 2 3 4 5 6

0

F 3 (N)

-0.5

-1

-1.5 0 1 2 3 4 5 6

 (rad)

Figure 5.2.: Estimated force compared with the real one for different sizes and directions of the applied force.

69

5.3 Simulations Analysis As depicted in this figure, the estimated forces for the cases 2, 4 and 6 coincide the real values, indicating that the proposed approaches are able to uniquely estimate the applied forces in 3D. In other words, for these cases, the Levenberg-Marquardt method converges to the global minimum for the simulated ablation operation (Note that for each simulation case the global minimum is the value of the simulated contact force). However, this is not true for the cases 1, 3 and 5 in which the estimated values do not match the simulated values of the force. For these cases, the force estimation algorithm is not a one-to-one function of measurement quantities for some range of the applied force in ablation operation. Comparing cases 1, 3 and 5 with 2, 4 and 6, respectively, indicates that adding more measured quantities solves this issue. Having chosen case 2, 4 and 6 as feasible sensing cases, the performance of the force estimation approach is investigated for different force magnitude and initial curvatures. The size of the forces ranges from zero to 0.35 N, simulating the range of the contact force in intra-cardiac ablation [74, 76]. The analysis has been repeated for different initial curvatures of the catheter covering nearly straight distal shaft to the almost fully deflected one. A part of the simulation results has been depicted in Fig. 5.3 indicating that the force estimation approach for the measurement case 2, 4 and 6, is able to uniquely and accurately estimate the contact force in ablation procedure.
Force magnitude (N)
0.3
Case 2 Case 4 Case 6 Real

0.2

0.1

0 2 4 6 8 10 12 14

Simulation number

Figure 5.3.: Size of the estimated force using the chosen approaches.

5.3.2. Sensitivity Analysis
Error is inevitable in the position and orientation measurement of the proposed force estimation approaches. In this section, the effect of position and orientation error

70

5.3 Simulations Analysis on the accuracy of the estimated force is investigated for different force estimation approaches. In the first analysis the effect of the error in the position measurement on the estimated force is evaluated. In this simulation, a constant force of 0.15 N, shown by the arrow in Fig. 5.4, is applied at the tip of the catheter with two initial configurations. Assuming the position of the catheter tip is sensed with ±1 mm measurement error, as shown by a sphere around the tip, the associated estimated forces for each case are indicated by the lines representing the end of the force arrow. As shown in this figure, in spite of the noise added to the measured positions, the proposed approach can estimate the magnitude and direction of the contact force.
50

40

Z (mm)

30

20

10

0 0

Y (mm)

-20 -40 0 5 10 15

X (mm)

Figure 5.4.: Effect of the position measurement noise on the estimated force (scale 200 mm: 1 N). Quantitative analysis of the sensitivity for the spatial force estimation approach has been performed in the following. It is assumed that the position and orientation measurements are normally distributed variables with standard deviation of 1 mm and 0.8 , respectively. A constant norm of the force equal to 0.2 N is applied at the tip of the catheter with the direction characterized with angle , (F1 = |F | cos , F2 = 0, F3 = |F | sin ) ranging from zero to 2 . Two initial curvatures are considered for the distal shaft of the catheter namely 30 and 40 m-1 . The standard deviation of the estimated force in d1 and d3 directions is computed by

71

5.3 Simulations Analysis the linearized approximation (see [78] for more explanation) of the estimated force function assuming the random variables are independent. The Jacobian matrices for each case are computed numerically using the finite difference approach. Typical results of the simulations can be seen in Fig. 5.5. As shown in this figure, estimated axial force is more sensitive than lateral force to the pose error. The maximum standard deviation of the forces occurs at the two extreme angles, i.e., where the axial force is maximum. A contributing factor is the higher stiffness of the catheter in the axial direction. The standard deviation of the force is higher for the higher initial curvatures due to the lower stiffness of the distal shaft in extended configurations. As can be observed from Fig. 5.5, the force estimation based merely on the orientation of the sensors (case 6) has the highest sensitivity to the measurement error.
0.026

(N)
0.022

Standard deviation F

1

0.018

0.014

0.01

0 0.07

1

2

3

4

5

6

0.06

-1 Case 2, 0 c1 = 30 m -1 Case 4, 0 c1 = 30 m -1 Case 6, 0 c1 = 30 m

(N)

3

0.05

-1 0 Case 2, c 1 = 40 m -1 Case 4, 0 c1 = 40 m

Standard deviation F

0.04

-1 Case 6, 0 c1 = 40 m

0.03

0.02

0.01

0 0 1 2 3 4 5 6

 (rad)

Figure 5.5.: Standard deviation of the estimated force for different directions of the applied force. Mechanical properties of the catheter might be changing during the ablation due to

72

5.3 Simulations Analysis higher temperature of the ablation, repeated use and wearing of the catheter. The sensitivity of the force estimation algorithm against the change in bending stiffness of the distal shaft has been analyzed here by increasing the stiffness to 10 percent of the initial value. The results are shown for 0.2 N magnitude of the force applied in different directions, , at the tip of the catheter. As shown in Fig. 5.6, the maximum error for the norm of the estimated force is about 0.01 N which corresponds to 5 percent of the norm of the applied force. It is also evident that all the three force estimation cases produce fairy similar sensitivity against the bending stiffness of the catheter distal shaft.
11 10.5 10 9.5 9 8.5 8 0 x 10
-3

Estimated force error (N)

Case 2 Case 4 Case 6

1

2

3

4

5

6

 (rad)

Figure 5.6.: Error as a result of uncertainty in the distal shaft bending stiffness for different force directions.

5.3.3. Computation Time
The computation time of the proposed force estimation schemes has been listed in -1 Table 5.1 for the initial configurations 0 1 =0-45 m and applied forces experienced by the cardiac catheter in the ablation procedure. Simulation are performed under MATLAB® environment on an Intel® Pentium® 4 computer with CPU speed of 3.00 GHz. The computation time is recorded for each of the force estimation cases. It involves the time duration for iterative solution of the forward problem, (3.18) and (3.19), when the catheter length is discretized via 500 elements. As it is evident, all 6 schemes are capable of real-time implementation. However, case 6 is the fastest and 3 is the slowest approach for all the loading scenarios. It should be noted that the computation time could be reduced using real-time programing platforms like C.

73

5.4 Experimental Validations Table 5.1.: Computation time for different force estimation schemes (sec). Catheter loading |F|=0.05 |F|=0.10 |F|=0.15 |F|=0.20 |F|=0.25 N N N N N Case 1 0.038 0.045 0.072 0.065 0.077 Case 2 0.036 0.035 0.036 0.047 0.053 Case 3 0.097 0.091 0.099 0.111 0.083 Case 4 0.027 0.026 0.026 0.027 0.031 Case 5 0.031 0.026 0.026 0.028 0.028 Case 6 0.023 0.035 0.028 0.029 0.038

5.4. Experimental Validations
To verify the feasibility and perform the comparative study for the proposed force estimation methods, the setup shown in Fig. 5.7 have been prepared. The Aurora electromagnetic tracking system has been deployed to track the pose of the points along the catheter. A commercially available ablation catheter, catheter 1 with the identified parameters listed in Table 3.2, has been placed inside the sensing field of the field generator. A force sensor (Nano17, ATI Industrial Automation, Apex, NC, USA) is used to apply and measure the force on the catheter tip. The force sensor fixture is designed to apply forces in different directions by adjusting the relative angle of its arms. To estimate the applied force using three proposed sensing cases, proper number of sensor coils are attached to the catheter, i.e., one sensor at the tip for case 2, one sensor at the tip and one at the distance h1 = 30 mm from the tip for case 4 (as shown in Fig. 5.7) and three sensors, one at the tip and the other two at the distances h1 = 30 mm and h2 = 50 mm from the tip for the case 6. Position readings from the sensors are calibrated so that the sensor represents a point on the catheter's central line. For each sensing case, 5 sets of force are applied at the tip of the catheter by adjusting the force sensor fixture. The required poses measured by the attached pose sensors are then recorded and given to the associated force estimation algorithm to obtain the applied forces along the local frame at the tip. It should be noted that the readings of the force sensor are in the sensor local frame. Hence, they should be transformed to the local frame at the catheter tip to be consistent with the estimated forces obtained by the algorithm. Each experiment is performed 10 times to assess the repeatability of the force estimation approach. Results have been shown in Fig. 5.8. In this figure, the magnitude of the estimated force for each experiment and its mean value for each set of experiment are illustrated. As shown in this

74

5.5 Conclusions

Field generator

d1



d3

Pose sensor

Force sensor

Figure 5.7.: Experimental setup for force estimation. figure, the force estimation algorithm is able to predict the applied forces using the three measurement cases with the mean error of less than 0.01 N. The width of the estimation error for all the experiment sets are almost the same, indicating that the estimation error does not change with the size of the contact force. There exist two main sources of error in these experiments: the position measurement error of the electromagnetic sensors and the discrepancy between the Cosserat model and the real catheter. In the current research, the latter is minimized by the identification of the bending stiffness of the catheter. However, in real application the identified parameters might deviate from the original one due to wearing of the catheter or temperature rise in ablation procedure. To overcome this shortcoming, an adaptive approach can be deployed to tune the Cosserat model parameters in real-time during the procedure.

5.5. Conclusions
In this chapter, a model-based approach for the estimation of the force applied at the tip of the catheter was presented using the position sensor attached to the device. The proposed force estimation scheme relies on a quasi-static catheter model based on the theory of Cosserat rod, which was discussed in Chapter 3. The proposed Cosserat model is computationally efficient, particularly, when the forces are in the

75

5.5 Conclusions
0.26

0.25

0.24

0.23

Force magnitude (N)

Case 2 (mean value) Case 4 (mean value) Case 6 (mean value) Case 2 Case 4 Case 6 Measured value

0.22

0.21

0.2

0.19

0.18

0.17

0.16

Experiment set number

Figure 5.8.: Estimated force for different force sensing cases. local frame. The significance of the proposed force estimation is that we take advantage of this feature of the Cosserat model, along with the fact that the estimated force can be expressed in the local frame rather than the global frame to obtain a computationally efficient force estimation algorithm. Since the ablation procedure involves translation and rotation of the catheter, the force estimation scheme needs to be based on the quantities which do not change due to the catheter movement (solely change due to its deformation). Hence, force estimation approaches based on the relative position and orientation were proposed to cope with this issue. These approaches were compared in terms of their feasibility for the range of the ablation procedure forces, error sensitivity and computation time. It was concluded that the force estimation based on the relative orientation of three sensors along the catheter and force estimation based on the relative position of two sensors and their associate absolute orientation, can be successfully adopted in the ablation procedure. Both of these approaches can be implemented in real-time and lead to a unique estimated force for the range of forces in the ablation procedure. However, the approaches based on the relative pose are relatively more sensitive to the pose measurement error.

76

5.5 Conclusions In practice, there are two main factors contributing to the performance of the proposed force estimation schemes developed in this thesis. The first factor is the extent to which the catheter models, along with the assumptions therein, are consistent with the conditions experienced by the catheter in actual ablation procedure. For instance, the accuracy of the fixed boundary condition for the catheter at its insertion point to the cardiac chamber can affect the value of the estimated force along the catheter axis. Another assumption that seemingly have a significant effect on the results is assuming the force is applied at the tip of the catheter during the ablation. Although the main contact force is supposed to be applied to the electrodes at the tip of the catheter, the significance of the other contact forces should be validated by in vivo experiments. The second factor is the measurement accuracy of the requited poses along the catheter for the force estimation. To improve the accuracy a fusion of the developed technologies such as electromagnetic pose sensors and imaging modalities can be utilized. Both the planar force estimation approach presented in previous chapter and the spatial one presented here can be applied to various continuum robot architectures, regardless of their actuation mechanism. Although both methods share the same features, they differ in the coordinate frame in which the estimated force are represented. The planar and spatial approaches provide the contact force in, respectively, a fixed global and a tip local frame. Consequently, each of the methods might be suited to specific applications based on whether the direction of the contact force is required to be estimated with respect to a global frame. For either approach, the range of forces applied to the robot for a specific application should be evaluated to assess if it satisfies a one-to-one relation between measurement quantities and estimated forces. The force estimation approaches presented in this thesis can be applied on various commercially available catheter. However, the calibration procedure should be performed for each type of the off-the-shelf cardiac catheters to obtain the associated PCAR or Cosserat parameters.

77

6. Catheter Position Control
Cardiac catheterization involves driving the catheter tip to a desired location on the cardiac wall. Manual positioning of the catheter is a challenging task and is often achieved after several attempts depending on the experience of the operator. Nonsmooth behavior of the catheter in transferring the manipulation of the handle to the catheter tip motion, contributes to the difficulties of the manual catheter navigation. The non-smooth behavior of the catheter can be compensated in an automatic navigation control scheme. Such an experimentally-based automatic position control of the catheter can considerably reduce the x-ray exposure time and contribute to the effectiveness of the procedure by accurate positioning of the tip electrode to the desired position of the heart tissue. The state-of-the-art technologies in robotic catheter navigation were introduced in Chapter 1. The operations performed by these systems are manual in nature, i.e., the procedure is not automatically controlled. Another limitation of such technologies is their significant operation cost due to the use of specially designed sheaths instead of the commercially available cardiac catheters. The focus of this chapter is on the automatic positioning of the commonly available cardiac catheters. The rest of this chapter is organized as follows. Section 6.1 presents the components of the robotic catheter system which is used as the experimental test-bed for the rest of the chapter. In Section 6.2, characteristics of the robotic catheter system are identified for each degree of freedom of the robot. Section 6.3 discusses the experimentally-based inverse kinematics of the catheter. Section 6.4 introduces the structure and components of the position controller and discusses the experimental results.

78

6.1 Robotic Catheter

6.1. Robotic Catheter
The catheter manipulator consists of a 3 DOFs robotic catheter manipulator developed in the laboratory as shown in Fig. 6.1 to perform the catheter manipulation similar to the interventionalist's hand in the interventional procedure. The catheter manipulator is a component of Althea® 2 that has been recently retrofitted to accommodate faster response of the stepper motors experienced in v.1 of Althea® . Axial translation of the catheter is performed by the motorized linear stage (Velmex, Bloomfield, NY) which pulls/pushes two rotary stages and the catheter handle. The first rotary gear system is in charge of the axial rotation (twist) of the catheter. Bending of the distal portion of the catheter is performed by rotation of the steering knob using the second rotary stage. All three stages are driven by stepper motors coupled with the shaft encoders. A bidirectional ablation catheter, Blazer prime XP (Boston-Scientific, Natick, MA), with the diameter of 7 French and distal shaft length of 110 mm has been installed in the robotic system. To track the position of the desired points on the catheter, Aurora electromagnetic tracking system has been deployed. An EM sensor is attached to the tip of the catheter (as shown in Fig. 6.2) and is properly calibrated to provide the pose of the center-line of the tip. To simulate the interaction of the catheter with the blood vessels in which it slides, a phantom has been constructed as shown in Fig. 6.2. The phantom is made of PVC tubes connected to form the veins from the catheter insertion point to the right atrium in anterograde approach. The length, diameter and orientation of the tubes are based on torso computed tomography (CT) of a male patient.

Twist

Axial displacement

Knob rotation

Figure 6.1.: Robotic catheter manipulator of the Althea® 2 system.

79

6.2 Characteristics of Robotic Catheter System

Field generator

Phantom Pose sensor

Figure 6.2.: Pose measurement system and phantom.

6.2. Characteristics of Robotic Catheter System
The robotic catheter has three inputs, namely, axial translation, twist and knob rotation. The outputs are respectively axial translation and rotation of the catheter distal end and bending of the distal shaft. In order to characterize the input/output relation for the robotic catheter system, independent experiments have been performed for each of the motorized stages.

6.2.1. Axial Translation
Displacement of the linear stage of the robotic catheter does not necessarily cause the same axial displacement in the catheter tip. The relation between the axial translation of the catheter handle and the resultant displacement of the distal portion of the catheter might be affected by the interaction of the catheter body and the surrounding tissue through which it slides and the flexibility of the catheter shaft. To quantify this relation, the linear stage has been actuated with sinusoidal commands having different amplitudes and frequencies. The catheter is pulled/pushed through the phantom which mimics the human vasculature system from the catheter insertion point to the cardiac chamber. Catheter displacement has been measured and recorded using the EM sensor attached at the tip of the catheter. The sinusoidal input trajectory for one of the experiments has been shown in Fig. 6.3 along with the axial displacement of the catheter tip. A typical backlash behavior can be observed in all such experiments. To quantify the backlash behavior, it is more descriptive to plot the axial displacement of the tip

80

6.2 Characteristics of Robotic Catheter System
25
Output Input

(a)
20

Axial displacement (mm)

15

10

5

0 20 18 16

0

5

10

15

20

25

30

35

Time (sec)

(b)

Output Input

Axial displacement (mm)

14 12 10 8 6 4 2 0

0

5

10

15

20

25

30

35

Time (sec)

Figure 6.3.: Sinusoidal input and output for the axial translation. (a) amplitude=10 mm, frequency=1 rad/s, (b) amplitude =7.5 mm, frequency=1.5 rad/s. with respect to that of the handle (Fig. 6.4). As is shown in this figure, the width of backlash denoted by W and the backlash slope referred to m are almost fixed for all the amplitudes and frequencies. Each experiment was repeated 5 times for frequencies equal to 0.5, 1 and 1.5 rad/s and amplitudes of 7.5 and 10 mm. The mean value of the backlash width is 3.10.6 mm and backlash slope is 10.1 for all the experiments. During the experiments, it was observed that the backlash non-linearity in axial translation of the robotic catheter mainly occurred at the onset of motion due to buckling of the catheter at its insertion point to the vascular system. The source of the buckling, as has been observed in the experiments, is misorientation of the axis of the robotic catheter with respect to the femoral vein at the insertion point. The observations indicate that the friction between the catheter and the veins has minor effect on the axial translation behavior. This conclusion is further supported

81

6.2 Characteristics of Robotic Catheter System
Amplitude:7.5 mm Frequency:1.5 rad/s Amplitude:7.5 mm Frequency:1 rad/s

14 12

W

Output (mm)

10 8 6 4 2

m

20 18 16

0

5

10

15

Amplitude:10 mm Frequency:1.5 rad/s Amplitude:10 mm Frequency:0.5 rad/s

Input (mm)

Output (mm)

14 12 10 8 6 4 0 5 10 15

W

m

20

Input (mm)

Figure 6.4.: Backlash behavior of the robotic catheter system in axial direction. by the fact that in the catheterization procedure the friction between the catheter and veins is reduced due to the lubricative effect of the blood flow.

6.2.2. Twist
To parametrize the relation between the axial rotation of the handle and that of the distal portion of the catheter, the rotary stage is actuated with a sinusoidal input. To make sure the stepper motor is actually performing the sinusoidal command, a closed loop control scheme has been implemented by feeding back the pulses measured by the shaft encoder. The encoder readings along with the pose of the tip of the distal shaft have been recorded for different values of amplitude and frequency. The recorded data for two of such experiments is shown in Fig. 6.5 where the angular displacement of the catheter handle is depicted along with that of the distal shaft for two sets of amplitude and frequency. As shown in this figure, the amplitude of the

82

6.2 Characteristics of Robotic Catheter System distal end is lower than that of the handle for both cases. To draw a clearer picture of the twist behavior of the robotic catheter, output has been plotted against the input in Fig. 6.6. As shown in this figure, as opposed to the typical backlash behavior [79], the backlash width observed in the experiments is not significant. However, there is a considerable reduction in the slope of the input-output line when compared with the ideal system performance (dashed line in Fig. 6.6). As shown in parts (a) and (b) of the figure, the slope of the input-output curve, m, is approximately constant for all the amplitudes and frequencies. Each experiment was repeated 5 times for frequencies equal to 0.5, 1 and 1.5 rad/s and amplitudes of 20 , 40 and 60 . The mean value of the obtained backlash slope is 0.48  0.05 for all the experiments.
50

(a)
Angular displacement (
o

Input Output

40

)

30

20

10

0

0

5

10

15

20

25

30

Time (s)
80 70
o

Input Output

)
60 50 40 30 20 10 0 0 2 4 6 8 10 12 14 16

Angular displacement (

(b)

Time (s)

Figure 6.5.: Sinusoidal input and output for the axial rotation. (a) amplitude=20 , frequency=1 rad/s, (b) amplitude =40 , frequency=0.5 rad/s. The observation of insignificant backlash width indicates that the static friction between the catheter and its surroundings (simulated veins) does not have a considerable effect on the twist of the robotic catheter. In fact the large diameter of

83

6.2 Characteristics of Robotic Catheter System
35
Amplitude: 20 o Frequency:1 rad/s Amplitude: 20 o Frequency:0.5 rad/s

30

Output ( o)

25

20

15

(a)
10 0 75 70 65 60 55
Amplitude: 40 o Frequency:0.5 rad/s Amplitude: 40 o Frequency:0.2 rad/s

5

10

15

20

25

30

35

40

Input ( o)

Output ( o)

50 45 40 35 30 25 20 0 10 20 30 40 50 60 70 80

(b)
Input ( o)

Figure 6.6.: Backlash behavior of the robotic catheter system for axial rotation. the veins and their rather smooth angles cause little friction force against the axial rotation of the catheter. Note that the static friction contributes to the backlash width by hindering the motion at the onset of the oscillation. The slope of the obtained input-output curves is lower comparing with the ideal system, hence an axial rotation of the handle causes smaller angular displacement at the distal end. This behavior can be explained by the torsional flexibility of the catheter along its length. The shape of the path in which the catheter slides also affects how easily the torsional displacement transfers from one end to the other. Sharp angular changes along the path of the catheter might drastically reduce the slope, i.e., cause the reduction of the output amplitude. However, since the relative orientation of the veins is approximately constant, a fixed slope reduction can be assumed for the input-output relation of the twist behavior.

84

6.2 Characteristics of Robotic Catheter System

6.2.3. Steering
The rotary stage which drives the catheter knob is in charge of deflecting the distal shaft. To characterize the relation between the command to the knob and the bending of the distal shaft, the knob stepper motor is actuated with a sinusoidal command so that the distal shaft covers its entire workspace. Curvature is chosen as the parameter describing distal shaft bending. To calculate curvature at each time step, position of the tip of the catheter and the connecting point of the distal shaft to the catheter body are recorded. Assuming the distal shaft has a circular shape, curvature of the distal shaft, , can be approximated using 2(xT - xP ) , (xT - xP )2 + (zT - zP )2



(6.1)

where subscript T and P , respectively, denote the catheter tip and the distal shaft proximal end as shown in Fig. 6.7. Equation 6.1 is obtained from the following geometric relations shown in the figure:

(xT - xP )2 + (zT - zP )2 = 2r cos ,

cos  =

(xT - xP ) (xT - xP )2 + (zT - zP )2

.

xT

r z

zT

r  O x d
xP

 = 1/r

zP

Figure 6.7.: Schematic view of the catheter in the plane of deflection. Results of the experiment are shown in Fig. 6.8 where the measured curvature is compared with the ideal constant curvature model of the distal shaft. Two dead-

85

6.3 Experimentally-based Inverse Kinematics (IK) zone regions are noticeable in the figure; one occurs at zero curvature when the distal shaft passes through the straight configuration and the other at the extreme ends when the tension switches from one tendon to the other.
60
Constant curvature model Experiment

40

20

Curvature (m -1 )

0

-20

-40

-60 0 50 100 150

Time (s)

Figure 6.8.: Curvature of the distal shaft and the constant curvature model.

6.3. Experimentally-based Inverse Kinematics (IK)
During catheterization, the tip of the catheter should be guided to the region of interest to perform EP study or ablation using the electrodes at the tip. Therefore, position of the tip of the catheter has been chosen as the output of the robotic system that should be controlled. The inputs to the system are commands to the three stepper motors driving the axial translation, twist and bending of the distal shaft. For the purpose of position control, it is desirable to establish a relationship between the given position of the tip and the required input to the steppers, IK of the robotic catheter. In position control of the continuum robots, IK is often solved in real-time using inverse Jacobian of the robot [12]. However, IK solution based on inverse Jacobian is numerically unstable in the region close to singular configurations. One approach to avoid singularities is to adopt damped-least squares and singularity robust inverse formulations which come with the cost of limiting the workspace of the robot. Another difficulty in navigation control of catheters using Jacobian inverse [55] is that the nonlinearity associated with the backlash of the distal shaft has not been included in the inverse kinematics. To tackle these issues with the Jacobian-based

86

6.3 Experimentally-based Inverse Kinematics (IK) IK approach, in the following, the IK based on curves fitted to input-output data obtained through experiments is proposed. Schematic view of a cardiac catheter tilted around its axis with the angle b , has been shown in Fig. 6.9. It is assumed that the catheter distal shaft, with the length and body length d, has moved out of the introducing sheath. In addition to guiding the catheter, the guiding sheath provides stiffness during the interaction of the catheter and heart. It is assumed that the position of the points T and P are available with respect to an arbitrary fixed coordinate frame at O. Inverse kinematics involves obtaining parameters d, b and the knob rotation angle, k for the given position of the tip. At first, the rotation angle is obtained using the geometric relations depicted in T -yP Fig. 6.9, i.e., b = arctan y . Once the rotation angle of the distal end has been zT - zP calculated, the desired stepper command can be obtained from the model of the backlash of twist which is discussed in section 6.2.2. Having calculated the rotation angle, the z coordinate of the relative position of the tip and the point P in the D D = (zT - zP )/ cos b . - zP deflection plane, D, can be easily obtained as zT
D T

b

y x P d O z

Figure 6.9.: Schematic view of the catheter and transseptal sheath. Calculation of d and k relies on the experimentally-obtained mapping between the knob rotation angle and the coordinate of the tip of the catheter in the deflection plane. To obtain this, the knob is actuated with a linear command while the deflection plane is parallel to x-z plane, and the position of the tip with respect to the point P is recorded. The orientation of the bending plane of the distal shaft can be adjusted by the twist mechanism to make sure it is parallel to the predefined x-z

87

6.3 Experimentally-based Inverse Kinematics (IK) plane. The recorded positions for the half of the distal shaft workspace with respect to the knob rotation angle have been shown in Fig. 6.10 and Fig. 6.11. Tip positions for the constant curvature model of the distal shaft have also been calculated and shown against the recorded data. The backlash behavior of the distal shaft causes significant deviation of the trajectories from the constant-curvature model. To include these non-smooth nonlinearirties to the IK, yet to accomplish online implementation of the IK, the fitted curves to the obtained experimental data are used to approximate the IK. To do so, the experimental data describing the relative z coordinate of the tip with respect to the knob rotation angle (plot shown in Fig. 6.10) is fitted with two sinusoidal curves, namely curves 1 and 2. A sinusoidal curve, curve 3, is also fitted to the mapping between the relative x coordinate of the tip and knob rotation (plot shown in Fig. 6.11). As shown in Fig. 6.10 with the current selection of the curve fitting parameters, curve 2 averages the middle portion of the behavior of the distal shaft along z axis. However, increasing the number of curves can result in a more precise capturing of the experimental trajectory. Each fitted curve is a summation of two sine functions, i.e., 2 i=1 ai sin(bi x + ci ). Parameters of the curve fitting for the three curves have been listed in Table 6.1. Table 6.1.: Curve fitting parameters for the IK curves. Curve 1 Curve 2 Curve 3 a1 129.5 43.69 6612 b1 0.04428 0.02026 0.00053 c1 -1.325 1.225 -0.004 a2 115 2.217 17.37 b2 0.0479 0.2073 0.2082 c2 1.641 -7.337 2.309 R-square 0.986 0.982 0.999

Using the fitted curves in Fig. 6.10, the knob rotation angle, k can now be provided using the experimentally-based IK for the given relative z coordinate of the tip projected in the bending plane. Note that some of the relative z coordinates of the tip are associated with two values of the knob rotation angle. For these cases, the IK algorithm provides the command which is closest to the previous knob angle command. Having obtained the knob rotation angle, the axial displacement can then be obtained using the approximated curve in Fig. 6.11. The IK algorithm has been outlined in Algorithm 6.1.

88

6.4 Position Controller
Experiment Constant curvature Approximated

45 40 35 30 25 20 15

Rotation angle of the knob (

o

)

Curve 2

Curve 1
10 5 0 0 10 20 30 40 50 60 70 80 90

Z T -Z P (mm)

Figure 6.10.: Relative position of the catheter tip along z axis. Algorithm 6.1 Experimentally-based inverse kinematic algorithm. % Inputs are position of point T and P and rotation angle of the knob at the previous time step. n-1 function InverseKinematics(xT , yT , zT , xP , yP , zP ,k ) yT -yP set b = arctan zT -zP D set zT P = (zT - zP )/ cos b % Z coordinate of T relative to P on plane D. D n calculate k 1 from curve 1 using zT P D n calculatek 2 from curve 2 using zT P n - 1 n - 1 n n | | < |k if |k 2 - k 1 - k n n setk = k1 else n n setk = k 2 end if n calculate xD T P from curve 3 using k n D set d = xT P + xT n return dn , k end

6.4. Position Controller
6.4.1. Control Structure and Components
The objective of the position controller is to guide the tip of the catheter from its initial position to the desired one. The schematic diagram of the control loop structure for the robotic catheter system has been shown in Fig. 6.12. As shown in this figure, the IK algorithm proposed in the previous section is used as a component of

89

6.4 Position Controller

120 100 80
Curve 3 Experiment Constant curvature Approximated

X T -X P (mm)

60 40 20 0 -20 -40

0

5

10

15

20

25

30
o

35 )

40

45

Rotation angle of the knob (

Figure 6.11.: Relative position of the catheter tip along x axis. the position controller which is called twice in each time step. The IK algorithm is implemented in the feedback loop and right at the input, to provide k , d and b for the current tip position and the desired position, respectively. For the position controller block, traditional integral controller is chosen due to its simplicity and reliability which are vital characteristics for medical devices [80]. The position controller block consists of three independent integral controllers namely, knob, axial translation and twist controller which are responsible for the convergence of k , d and b , respectively, to their desired values. Performance of each controller can be modified by adjusting the value of the associated gains. The justification for selection of integral controller as the building block of the position controller is the high damping and low speed of the operation and the inherent relative commands of the actuators (stepper motors). To enhance the tracking performance of the closed loop controller, a backlash compensator is desired to modify the commanded trajectories to the robotic catheter system. The backlash compensator block in Fig. 6.12 alters the position controller outputs for axial translation and rotation. Note that compensation for the intrinsic backlash behavior of the knob actuation is already embedded in the experimentallybased IK algorithm. For the backlash compensation, an approach called inverse backlash , first introduced by Tao and Kokovic [79], is used. The inverse function of the backlash model obtained in Sections 6.2.1 and 6.2.2 are added to the associated actuator inputs to cancel the backlash nonlinearities. For the axial translation, the

90

6.4 Position Controller
Computer software
d ydzd xT T T

Inverse kinematics

+

-

Position controller

Backlash compensator

k , d, b Robotic
catheter

xT, yT z

T

Inverse kinematics

Figure 6.12.: Schematic diagram of the control loop for the robotic catheter system. compensator involves the addition of a term equal to the backlash width approximated in Fig. 6.4. For the axial rotation, the compensator multiplies the controller output by a value equal to the inverse of the backlash slope in the twist experiments (Fig. 6.6).

6.4.2. Althea® 2 Robotic Catheter System
The Althea® 2 Robotic Catheter System is a new version of the Althea® that has recently been retrofitted in the RMAL lab. The VXM stepping motor controllers (Velmex Inc., Bloomeld, NY) of the Althea® was shown to be the slowest component of the control loop because of the sequential run of its control program and inability of the controller to execute small displacements with high speed [77]. In the new version of the system, Arduino micro-controller has been utilized in conjunction with the MK4 stepper controller (SOC Robotics, Vancouver, BC) to simultaneously command all the three motorized axes of the robotic catheter. A force sensor (Nano17, ATI Industrial Automation, Apex, NC, USA) is also added to the new system that is able to communicate with the Althea® 2 software by sending the measured external forces applied to the catheter. This component is specially used in Chapter 7 to implement the hybrid position/force controller. Aurora electromagnetic tracking system is adopted to track the position of the desired points on the catheter. All the components of the Althea® 2 Robotic Catheter System and their interactions have been shown in Fig. 6.13. A program was written in Standard ISO C++ '98 to initialize and operate all the devices of the Althea® 2. The overall design of the control software including the main components and the data flow between them is shown in Fig. 6.14. As seen in

91

6.4 Position Controller

Pose feedback

Aurora EM sensor

Force feedback

ATI force sensor

Controller program GUI

Robotic catheter manipulator

MK4 stepper controller

Arduino microcontroller

Control command

Figure 6.13.: An overview of system components and their interactions. this figure, the program consists of four threads. The AuroraThread communicates with the Aurora tacking system via RS-232 serial interface. The data measured by the EM sensors is filtered and recorded within this thread. The ATIThread realizes the communication with the force sensor through USB interface. It also performs the required mathematical operations to calculate the value of the forces based on the calibration data of the sensor. In addition to interfacing with hardware, the program is responsible to calculate the outputs, commands to the stepper motors, based on the inputs, force and moment values from the force sensor and position and orientation values form the EM position sensor. These tasks have been performed within the ControlThread which is the main thread of the program. The position controller, backlash compensator and IK are the components that are implemented in this thread. The StepperThread communicates with the micro-controller through the USB port. The micro-controller receives the stepper commands and creates the suitable pulses for the steppers.

92

6.4 Position Controller

ControlThread Path planner USB PORT

ATIThread Force controller IK AuroraThread Pose controller

SERIAL PORT Pulses

Backlash compensator

StepperThread

Micro-controller

Figure 6.14.: The overall structure of the complete control software.

6.4.3. Experimental Results
Several experiments have been conducted to evaluate the performance of the proposed position controller. In the experiments, the catheter has been inserted through the phantom shown in Fig. 6.2 to simulate the vein catheter interaction. The goal of the experiments is to automatically navigate the tip of the catheter to the desired position set by the operator. To do so, the proposed position controller shown in Fig. 6.12 is implemented as the ControlThread of the Althea® 2 software. The number of pulses given to the stepper motors and the tip position have been recorded for each iteration of the control algorithm. Path followed by the tip of the catheter for three desired tip positions is depicted in Fig. 6.15. Initial configuration of the catheter for the three cases is the same as shown in the figure. The integral gains for knob rotation, axial translation and twist are set to be KIk = 0.005, KIa = 0.0075 and KIt = 0.05, respectively. As illustrated in Fig. 6.15, this set of controller gains produce a smooth navigation of the catheter from the initial configuration to the desired tip position. Iterative convergence of the tip of the catheter toward the desired position has been illustrated in Fig. 6.16. The positions are recorded with respect to the Aurora coordinate frame. The field generator of Aurora system has been adjusted so that its x axis is parallel to the catheter axis as shown in Fig. 6.15. As illustrated in Fig. 6.16, for all three cases, position of the catheter tip converges to the goal without significant overshoot

93

6.4 Position Controller and steady-state error. Input to the stepper motors commanded by the position controller for these experiments has been shown in Fig. 6.17. In the stepper motors, the change in the input pulses dictates the amount of the motor shaft rotation. As illustrated, the controller produces smooth commands, i.e., without jerky oscillations and steady-state error, for all three experiments.

Curve 3

50 40
Curve 2

Y (mm)

30 20 10 0 0 20 40
Curve 1

60

Z (mm)

50

-80

-60

-40

-20

X (mm)

Figure 6.15.: Path followed by the catheter tip during position controlled navigation.
50 45

X (mm)

40 35 30 25 0 60 40 50 100 150 200
Path 1 Path 2 Path 3

250

Y (mm)

20 0 -20 -40 0 50 40 50 100 150 200 250
Path 1 Path 2 Path 3

Z (mm)

30 20 10 0 50 100 150 200 250
Path 2 Path 3

Iterations

Figure 6.16.: Performance of the controller for each of the coordinate axis.

94

6.4 Position Controller
Axial translation Stepper command
14 12 10 8 6 4 2 0 5 × 10 5 50 100 150 200 250
Path 1 Path 2 Path 3

× 10 5

Twist stepper command

4 3 2
Path 2

1 0

Path 3

12

× 10 5

50

100

150

200

250

Knob stepper command

10 8 6 4 2 0 50 100 150 200 250
Path 1 Path 2 Path 3

Iterations

Figure 6.17.: Commands to the stepper motors of the robotic catheter system. The effect of the integral gain on the performance of the controller has been evaluated through the following experiments. Three values have been chosen for the integral gain of the linear axis which controls the axial displacement, d. Gain value for the knob and twist are set as 0.005 and 0.05, respectively during these experiments. The x and z coordinates of the tip position are depicted in Fig. 6.18 for different values of the gain. As shown, a higher value of gain results in higher speed of convergence and overshoot along x axis. However, it does not have a significant effect on the performance of the system in z axis. As shown in Fig. 6.19, the path followed by the tip of the catheter is affected by the gain values. Improper gain values might lead to a longer path with oscillatory motion. Run time for the control algorithm on a PC with a dual-core 2.4GHz 32 Bit processor is approximately 0.8 ms, which indicates that the online implementation of the proposed control scheme can be achieved for intra-cardiac interventions.

95

6.4 Position Controller

20 10 0

X (mm)

-10 -20 -30 -40 50 60 100 150 200 250
K Ik =0.0025 K Ik =0.0070 K Ik =0.0090

50

Z (mm)

40
K Ik =0.0025

30

K Ik =0.0070 K Ik =0.0090

20 50 100 150 200 250

Iterations

Figure 6.18.: Effect of the controller gain on the convergence performance.

60
KIk=0.0025 KIk=0.0070

55

KIk=0.0090

50

45

Z (mm)

40

35

30

25

20 -40

-30

-20

-10

0

10

20

X (mm)

Figure 6.19.: Comparison between the path followed by the catheter tip for different values of gain.

96

6.5 Conclusions

6.5. Conclusions
In this chapter, the backlash behavior of the catheter due to its interaction with its surrounding vascular system was quantified and compensated. It was concluded that this backlash behavior is more affected by the flexibility of the catheter shaft in transverse and torsional directions than the friction between the catheter and the internal veins. An IK algorithm based on the experimental data was established to capture the intrinsic non-smooth behavior of the distal shaft as a result of tendon actuation mechanism. A control scheme for guiding the catheter tip towards the goal was developed using the experimentally-based IK and the backlash compensation algorithm. Empirical results of the control implementations verify the feasibility of the proposed technique for driving the tip of the catheter to the desired location. The desired performance of the system can be achieved by tuning the gains of the individual controllers. The proposed experimentally-based IK control will be used as an internal loop for the hybrid force/position control structure of the catheter in the next chapter. In the analysis performed in this chapter, it was implicitly assumed that non-smooth behaviors of the catheter do not change over time. However, behavior of the distal shaft may vary due to its residual deformation and wearing during the catheterization. An adaptive approach can thus be proposed to adjust the controller parameters based on the measured behavior. Using the experimental setup developed in this chapter, the interaction between the catheter and veins were closely simulated. However, in-vivo experiments are deemed necessary to evaluate the sensitivity of the controller to the clinical conditions.

97

7. Hybrid Position/Force Control of the Catheter
7.1. Introduction
Navigation of the catheter inside the cardiac chamber can be divided into two phases; positioning the catheter from its initial location to the vicinity of the tissue of interest and stabilizing the contact force between the catheter and the tissue. The position control scheme discussed in the previous chapter guides the catheter through the first phase. For the ablation phase, a hybrid position/force controller is introduced in this chapter to stabilize the position of the catheter tip along the tissue and simultaneously, regulate the catheter contact force to a desired value. Controlling the contact force can improve the safety of the procedure by avoiding the complications resulting from the excessive ablation forces on the endocardium. Accurate positioning of the catheter tip to the desired location can significantly enhance the effectiveness of the procedure and avoid repeated ablation sessions. Manual regulation of the contact force is challenging due to the dynamic environment of the heart. The interventionalist's hand cannot comply with the high speed of the target tissue moving with the frequency of at least 1 Hz. Current robot-assisted catheter navigation technologies, introduced in Chapter 1, to the best of the author's knowledge, are not equipped with the contact force regulation scheme. This chapter begins with a brief review of the literature on the force control in robotics. The advantage of the external hybrid control for the case of the problem at hand is then discussed in Section 7.2. The structure and components of the external hybrid controller are then introduced in this section. Section 7.3 evaluates the performance of the proposed controller through different simulations. This section begins with introducing a simulation environment for ablation procedure based on the Cosserat model of the catheter and a model of the catheter/tissue interaction.

98

7.2 Force Control Structure A singularity-free IK model is then presented for the simulation purposes, based on the fitted polynomials, following the path discussed in Section 6.3. Using the singularity-free IK the position control will have similar structure as the one presented in Chapter 6. The rest of Section 7.3 is devoted to the evaluation of the effect of the controller gains on the performance of the system and finding the optimal gain parameters. The ability of the hybrid controller to regulate the contact force in the dynamic environment of the heart is then investigated through simulations. Section 7.4 deals with the experimental study performed using the robotic catheter system to evaluate the performance of the proposed hybrid control scheme. Lastly, the chapter concludes in Section 7.5.

7.2. Force Control Structure
A plethora of studies have been done on robot force control in the past three decades (see [81] for a review of the traditional robot force control approaches). The interaction control strategies can be categorized based on whether the direct control of the contact force to the desired value is available. The first category, indirect force control, includes compliance control and impedance control where the static or dynamic compliance of the manipulator can be adjusted. Since a safe and effective ablation procedure necessitates the regulation of the contact force between the catheter and the environment to a desired value, the second category, direct force control, is of interest. Hybrid position/force control [82], which is a widely adopted scheme in the second category, controls the position along the unconstrained task directions and the contact force along the constrained task directions. This approach highly relies on the detailed model of the environment [83] which is not available in the problem at hand. Another strategy which is known as external hybrid control [84], offers a number of advantages over the traditional hybrid position/force control. Stability of the controller in transition from the pure position control phase to the hybrid position/force control is a motivating factor for adopting this structure in the current work. The hybrid controller scheme that is proposed for position/force control of the catheter is depicted in Fig. 7.1. As illustrated in this figure, the hybrid controller consists of two control loops: an inner position control loop based on fitted curve inverse kinematics, which will be discussed in Section 7.3.2, and an outer force control

99

7.2 Force Control Structure loop that closes around the position control loop. The interaction of the catheter and the heart tissue is schematically shown in Fig. 7.2. Three coordinate frames are used in this figure. The base frame is fixed to the the point of catheter entry into the introducer sheath with its horizontal coordinate extended along the catheter axis. Force sensor frame which is denoted by xs and ys axes, is attached to the catheter tip and defines the directions of the measured contact force. Constraint frame is attached to the tissue with xc axis along the the contact plane and yc denotes the constrained motion direction.
yd xd t t
+

yr xr t t

Inverse kinematics

+

-

Position controller

, d

Fs
Catheter

xt , y t

Inverse kinematics
Tb c
Force controller Selection
+

EM position sensor

-

Tc s

Force sensor

Fd c

Figure 7.1.: Schematic diagram of the position/force controller.

xs

xc

yc ys

y

x

Figure 7.2.: Coordinate frames in catheter heart interaction. In order to embed the possibility of controlling motion along the unconstrained task d directions, the desired motion of the tip of the catheter, rd =(xd t , yt ) is provided

100

7.2 Force Control Structure to the inner loop. The EM sensors can measure the position and orientation of the catheter tip with respect to the base frame. The measured positions are fed back to the inner position controller while the orientation is used to convert the measured forces frame to the constraint frame. This transformation is denoted by Tc s in the controller block diagram. The force control loop regulates the contact force around the desired force vector Fd c which is defined in the complaint frame. The force values are provided by a force sensor mounted to the tip of the catheter. An example of a catheter equipped with such a force sensor is introduced in [85]. An alternative solution is to adopt the posebased force estimation approaches proposed in Chapter 4 and 5 to provide the force data. Selection block in the force control loop defines the direction along which the contact force is controlled. For example, assuming yc as the force-controlled direction, the selection matrix multiplies its input by the diagonal matrix S = diag [0, 1]. It should be noted that the use of selection matrix is limited to simple contact cases. For the general contact problem, the allowable relative motions and constraining wrenches for the force/motion control can be expressed by two dual vector subspace with the details discussed in [86]. Traditional PID controller is chosen for both position and force controllers with the proportional and integral gains denoted by Kpf , Kif and Kdf for the force controller and Kpp , Kip and Kdp for the position controller. Reliability and simplicity of the PID controllers make them an appealing choice in variety of medical applications [80]. The output of the force controller, which is in the form of tip displacement in constraint frame, is converted to the base frame, by Tb c block, to be compatible with the desired tip position. By implementing the proposed hybrid force/position control the catheterization can be viewed as a teleoperated robot-assisted procedure. In such a procedure, significant delays in the system can cause instability in the slave (catheter tip in this case) control. However, cardiac catheters exhibit low dynamics during the intervention because of their low mass and inertia, high damping due to the surrounding fluid and internal friction of the distal shaft. Therefore, very high rate feedback (close to zero delay) is neither necessary nor possible due to slow teleoperation of the tip from outside the body. For improved transparency it is a common practice to use 300Hz-1000 Hz sampling rate in haptic feedback [87]. Also in many surgical operations on almost stationary organs, most of information is within 1.5 Hz and thus

101

7.3 Simulation Analysis a sample rate of 3 Hz would capture most of information (95%) based on Nyquist theorem. However, for accurate motion more sampling rate is required [88]. In teleoperated ablation procedure, a Kalman filter can be deployed to predict the point between sampling points at lower frame rates (of 10-20Hz) to achieve more than 100 Hz sampling. Similar practice has been proposed in [88] and implemented for motion compensation in beating heart Mitral valve surgery in [89].

7.3. Simulation Analysis
7.3.1. Simulation Environment
To verify the viability of the proposed controller, a simulation environment has been built in which the catheter is modeled as a Cosserat rod following the method introduced in Chapter 3. To obtain the pose of the catheter as a result of the contact forces with the wall, Algorithm 3.1 is implemented. Mechanical and geometrical parameters of the catheter are chosen based on the identified values for a commercially available ablation catheter, SteeroCath-T (Boston Scientific, Natick, MA). These parameters have been listed in the second column of Table 3.2. To simulate the interaction between the catheter and the heart tissue in the ablation procedure, a mechanical model of the surrounding tissue is required. Biological tissues are known to be nonlinear, inhomogeneous and anisotropic. Various mathematical models exist to describe the tissue behavior. Here, for the sake of simplicity and due to the fact that the procedure is assumed quasi-static, the tissue is approximated as a linear spring with the stiffness Kt as depicted in Fig. 7.3. Contact between the catheter and the tissue is detected when yc - yh is not negative (Fig. 7.3(a)). The amount of the external force is not known when catheter interacts with the heart tissue. In this case, a root-finding solver, Newton-Raphson algorithm, is adopted to obtain the value of the contact force that makes yc - yh zero. The algorithm solution is the shape of the catheter subjected to an external force that makes the catheter tip lay in contact with the tissue as shown in Fig. 7.3(b).

102

7.3 Simulation Analysis

Kt y y
yh ye

yc

O x (a)

O

x (b)

Figure 7.3.: Model of the interaction between the catheter and heart tissue.

7.3.2. Inverse Kinematics of the Simulated Catheter
In this section, the IK component of the hybrid control introduced in Section 7.2 is developed for the purpose of simulation. The experimentally-based IK has already been obtained for a commercial ablation catheter in 3D in Section 6.3. Here, for the convenience of the presentation, we limit ourselves to the planar motion of the catheter. However, the analysis can be easily extended to 3D by adding the twist angle to the actuation parameters of the system. Assume that the catheter distal shaft with the length and body length d, has moved out of the intoducer sheath as depicted in Fig. 7.4. For deriving the kinematic model for the catheter, it is assumed that the catheter is rigid and the distal shaft forms a constant curvature arc as a result of the tendon actuation. Constant curvature assumption has been verified experimentally for tendon-driven continuum robots and proved to be a promising model when no external load is applied to the system [51, 10].
xt

yt

y

  (s) d

O

x

Figure 7.4.: Schematic view of the catheter and intoducer sheath. Each point on the backbone curve of the catheter is characterized by angle (s) which is between the horizontal axis and tangent to the curve at that point (CCW

103

7.3 Simulation Analysis for positive direction) and s is the arc-length. Using (2.1), the position of the tip of the catheter can be written as 1 sin  + d,  1 1 yt = - cos  ,   xt = (7.1) (7.2)

where  = d/ds is the curvature of the arc. Navigation of the catheter can be performed by adjusting the joint space parameter q = (, d). Since in practice, controlling the position of the tip is of interest, r = (xt , yt ) is taken as the operational space parameter. Taking derivative from (7.1) and (7.2), the Jacobian matrix, mapping the incremental joint space to the operational space, can be obtained as


J=

cos  - 
1 2

1
2

sin 

1 0

 .

cos  -

1 2

+  sin 

(7.3)

Inverse of the derived Jacobian matrix has multiple singular points along the catheter work space which are associated with the maximum and minimum values of xt and yt as shown in Fig. 7.5. Inverse kinematic solution based on the inverse Jacobian is not an appropriate method for motion control of the catheter since it is numerically unstable in the regions close to singular configurations.
0.05
 =33.1

y (m)

0

 =89.8

 =0

 =-33.1

-0.05 0 0.05 0.1

x (m)

Figure 7.5.: Workspace of the distal shaft of the simulated catheter. To address this problem, the inverse kinematics based on curves fitted to the inverse of (7.2) is proposed as follows. Three connected 9th order polynomials are obtained

104

7.3 Simulation Analysis that properly (with root square error equals to 0.26) approximate the inverse of (7.2) , i.e., (yt ) as depicted in Fig. 7.6. For a given tip position, the distal shaft curvature can be found using the obtained polynomials. The axial displacement can then be calculated using (7.1). Tip positions associated with the actuator variables obtained by the proposed inverse kinematics are compared with the real ones for a given tip trajectory in Fig. 7.7.
100 Exact Polynomial 1 Polynomial 2 Polynomial 3

50

 (m -1)

0

-50

-100 -0.06

-0.04

-0.02

0

0.02

0.04

0.06

yt (m)

Figure 7.6.: Polynomials for fitting the inverse of (7.2).
0.05

y (m)

0

Real Approximation -0.05 0 0.02 0.04 0.06 0.08 0.1 0.12

x (m)

Figure 7.7.: Position of the tip of the simulated catheter calculated using the approximate IK. The performance of the position controller based on the Jacobian inverse and the fitted curve inverse kinematics have been compared in Fig. 7.8 for a catheter nav-

105

7.3 Simulation Analysis igating close to a singular configuration. As depicted in this figure, the proposed approach is able to smoothly guide the catheter tip to the desired position whereas Jacobian based controller suffers from computational instability near to the singular posture. The instability of the Jacobian based controller is illustrated by the jitters in the trajectory of the catheter tip position. The advantages of the proposed IK over the inverse Jacobian method can thus be summarized as singularity avoidance and computational efficiency of the algorithm.
0.1 0.095 Fitted curve IK Desired Jacobian based IK

X t (m)

0.09 0.085 0.08 20 0.06 0.04 40 60 80 100 120 140 160 180 200

Y (m)

0.02 0 -0.02

t

20

40

60

80

100

120

140

160

180

200

Iteration number

Figure 7.8.: Position of the tip of the simulated catheter under position control based on Jacobian inverse and fitted curve IK.

7.3.3. Effect of the Gains
Several simulations have been performed to evaluate the performance of the hybrid controller in the ablation phase. In these simulations, the tip of the catheter is assumed to be placed in the proximity of the tissue. The wall is extended along x axis with the stiffness of Kt =1000 N/m2 which approximates the stiffness of the human heart tissue [90]. The shape of the catheter during the position/forcecontrolled navigation is depicted in Fig. 7.9. As illustrated, the catheter has deflected as a result of the contact force between the catheter and the tissue. The ability of the controller to converge the force (along y direction) and position (along x direction) to their desired values has been demonstrated in Fig. 7.9 and Fig. 7.10. Both force and the position have been stabilized simultaneously as illustrated in

106

7.3 Simulation Analysis Fig. 7.10. Trajectories of the control commands to the actuators of the simulated robotic catheter manipulator (axial translation and curvature of distal shaft) are shown in the left side of Fig. 7.10. It is evident that the length of the catheter is longer in the target than that of in the initial configuration because of the insertion of the catheter along the axial direction.
0.05 0.04 0.03 Initial 0.02 Y (m) Final 0.01 0 -0.01 -0.02 -0.03 Target

0

0.05 X (m)

0.1

0.15

Figure 7.9.: Shape of the catheter converging to the desired force and position.
Axial translation (m)
0.08
0.05

0.06

0.04

F (N)
10 20 30 40 50 60 70 80 90 100

0.02

y
0.02 0.01 0
0.14

0.04

0.03

Input curvature (1/m)

25 20

10

20

30

40

50

60

70

80

90

100

10 5 0 10 20 30 40 50 60 70 80 90 100

X (m)

15

0.12

t
0.1 0.08

Iteration number

10

20

30

40

50

60

70

80

90

100

Iteration number

Figure 7.10.: Performance of the hybrid control of the catheter.

107

7.3 Simulation Analysis

0.3

F y (N)

0.2

K pp=0.4 K pp=0.5 K pp=0.6 K pp=0.7

0.1

0 0.4

5

10

15

20

25

30

35

40

Iteration number

0.3

F y (N)

0.2

K ip=0 K =0.004
ip ip

K =0.008 0.1 K ip=0.012 K ip=0.016 0 0.4 0.3 5 10 15 20 25 30 35 40

Iteration number

F y (N)

0.2 0.1 0

K dp=0 K dp=0.1 K dp=0.2 K dp=0.3 5 10 15 20 25 30 35 40

Iteration number

Figure 7.11.: Effect of position controller PID gains on the force stabilization performance. Effect of the PID gains on the force stabilization performance of the controller has been illustrated in Fig. 7.11 and Fig. 7.12 for the position and force controllers, respectively. The desired contact force is chosen as 0.25 N for these analyses. As shown in Fig. 7.11, the main effect of the proportional gain of the position controller is to reduce the overshoot and increase the settling time. However, the proportional gain cannot exceed a certain value due to instability of the closed loop system. The higher is the value of the integral gain, the smaller is the overshoot and steady-state error. Differential gain slightly reduces the overshoot and increase the settling time. Following observations can be made by comparing the contact force responses shown in Fig. 7.12. The main effect of the proportional gain of the force controller is to reduce the overshoot of the response. The higher the integral gain is the smaller becomes the steady-sate error. The differential gain slightly reduces the overshoot of the response. These observations can be utilized for design and implementation of the hybrid controller for robot-assisted catheter navigation systems.

108

7.3 Simulation Analysis
0.4 0.3

F (N)

y

0.2 0.1

K =0.080
pf pf

K =0.090 K pf=0.010 K pf=0.011 0 0.4 0.3 5 10 15 20 25 30 35 40

Iteration number

F (N)

y

0.2 0.1 0 0.4

K if=0 K if=0.4E-3 K if=0.6E-3 K =0.8E-3
if

5

10

15

20

25

30

35

40

Iteration number

0.3

F y (N)

0.2

K df=0 K df=0.02

0.1

K df=0.04 K df=0.06

0

5

10

15

20

25

30

35

40

Iteration number

Figure 7.12.: Effect of force controller PID gains on the force stabilization performance.

7.3.4. Optimal Controller Gains
For the ablation procedure, the desirable response of the closed-loop controller is the one with higher speed and smaller overshoot. The latter is essential for the safety of the procedure by avoiding the complications resulting from the excessive contact forces. The former helps reduce the radiation exposure time. To obtain the optimal gain values, a cost function is defined based on the simulated step response of the closed loop system for different values of the desired contact force. The cost function J can be stated as the summation of the integrated absolute values of error, e, calculated over m iterations, for n cases of the contact forces, i.e.,
n m

J=

|e| , n

(7.4)

We select m = 40 and n = 3 (contact forces are 0.1, 0.2 and 0.3 N). It should be noted that the step response error is expected to be a continuous function (there is

109

7.3 Simulation Analysis no outlier in the data). Therefore, L1 norm of the error is a suitable error quantity for the above optimization problem. The optimal gains are obtained by minimizing (7.4) using the simplex search technique [91] as implemented by MATLAB's fminsearch function. The simplex search algorithm is suitable for nonlinear optimization problems that the derivatives of the cost function may not be known. The optimal gains of the force and position controllers are obtained as Kpp = 1.3704, Kip = 0.001, Kdp = 0.2122, Kpf = 0.0545, Kif = 0.1E -3, Kdf = 0.0062. The step responses of the closed-loop system with the optimal PID controllers, to different values of the desired contact forces are shown in Fig. 7.13
0.35

0.3

0.25

0.2

F y (N)
0.15 0.1 0.05 0

5

10

15

20

25

30

35

40

Iteration number

Figure 7.13.: Step response of the system for the optimally-tuned PID gains.

7.3.5. Sensitivity Analysis
Mechanical properties of the catheter deviate over time due to the plastic deformation and wear. Moreover, bending stiffness of catheters might slightly differ from one to another due to the imperfect manufacturing process. Therefore, controller performance should be robust against the uncertainty in the stiffness of the catheter. To verify the robustness of the proposed controller, the bending stiffness of the catheter distal shaft and the body has been increased by 10% in each 100 iterations. As shown in Fig. 7.14, the controller is able to compensate for the uncertainty of the catheter stiffness and regulate the contact force to the desired value.

110

7.3 Simulation Analysis
0.3

0.25

0.2

F y (N)

0.15

0.1

0.05

0 0 50 100 150 200 250 300 350 400 450 500

Iteration number

Figure 7.14.: Response of the proposed controller to change in the stiffness of the catheter.

7.3.6. Regulation in Dynamic Environment
Catheter ablation has been performed in the dynamic environment of the heart. The heart tissue and thus the ablation target position have periodic motions as a result of the heart beating and the respiratory motion of the chest. In order for the catheter to ablate the tissue effectively, the controller should be able to keep its contact with the moving cardiac wall and apply the desired contact force. Oscillatory motion of the heart tissue can be approximated by the summation of two sinusoidal functions as follows,

y (t) = Abeat sin beat t + Aresp sin resp t.

(7.5)

In (7.5) the first sinusoidal function simulates the heart beating with the frequency of beat =2 Hz and the amplitude of Abeat =1 mm. The second mode of oscillation which is caused by respiration can be approximated with a sinusoidal function with resp =0.33 Hz and Aresp =0.4 mm [92, 62]. Tracking performance of the proposed controller has been verified through the following simulation against the heart tissue oscillation. In this simulation, the optimal gain parameters have been chosen for the hybrid controller. Trajectories of the tissue and the catheter tip over time are depicted in Fig. 7.15. The two modes of the heart oscillation are apparent in the trajectory of the heart tissue. As shown in this figure, the proposed controller ensures that the catheter tip closely tracks the rapid

111

7.3 Simulation Analysis motion of the heart.
5 × 10 -3

0

Y t (m)

-5

Tip position Tissue

-10 5 × 10 -3 20 40 60 80 100 120 140 160 180 200

Iteration number

Tracking error (m)

0 -5 -10 -15 20 40 60 80 100 120 140 160 180 200

Iteration number

Figure 7.15.: Response of the proposed controller to the heart tissue oscillation. The obtained contact force trajectories for the simulations are shown in Fig. 7.16. As illustrated in this figure, the proposed control scheme is able to stabilize the contact force oscillation around different desired contact forces. The tissue tracking is achieved by oscillatory change in both axial translation and curvature of the distal shaft. To assess the performance of the system for the range of heart oscillation frequencies, magnitude of the contact force has been plotted against input frequencies in Fig. 7.17 (similar to Bode plot for linear time invariant systems). The frequency analysis performed for the closed loop system indicates that higher proportional gains for the force and position controllers provide better damping of the contact forces in high frequencies of the heart motion. The amplitude of the heart motion is assumed to be 1 mm in this analysis.

112

7.4 Experimental Analysis
0.35

0.3

0.25

0.2

F y (N)
0.15 0.1 0.05 0

5

10

15

20

25

30

35

40

45

50

55

60

Iteration number

Figure 7.16.: Contact force of the catheter for the oscillating tissue.
35

30

25 Magnitude (dB)

20

15

10 Kpp=0.5 K pf=0.05 5 Kpp=0.9 K pf=0.09 Kpp=0.7 K pf=0.07 0 0.5 1 1.5 2 Frequency (Hz) 2.5 3 3.5 4

Figure 7.17.: Bode magnitude plot for different values of the force controller proportional gain.

7.4. Experimental Analysis
7.4.1. Experimental Setup
The experimental setup used for verification of the proposed hybrid controller is shown in Fig. 7.18. To perform the experiments, the Althea® 2 robotic system is

113

7.4 Experimental Analysis deployed for automatic navigation of the catheter (Fig. 6.1). Similar to the experimental setup explained in Section 6.1, the Aurora electromagnetic tracking system is adopted to track the position of the desired points on the catheter. In addition to the components used for position control, a force sensor is included in the setup to apply and measure external forces to the catheter tip. The force sensor is mounted on an adjustable fixture to be able to be conveniently positioned with respect to the catheter. Three components of the measured forces in the force sensor coordinate frame are labeled as shown in Fig. 7.18.
Field generator

Force sensor
F y Fx Fz
x

y z

Electromagnetic sensor wire

Figure 7.18.: Experimental setup for hybrid control. The structure of the controller part of the program is similar to the one shown in Fig. 7.1. In fact the proposed hybrid controller is implemented as the ControlThread of the Althea® 2 software shown in Fig. 6.14. The internal position controller contains two calls of the experimentally-based inverse kinematics discussed in Section 6.3 and a PI controller for the position controller component. Once the catheter collides the force sensor, the external force controller is activated. The force controller in the external loop calculates the modified desired position based on the measured and desired contact forces. The results are then used in the position controller to provide the commands for the steppers. It was observed in simulations that the derivative component of the force and position controllers has an inconsiderable effect on the performance of the system. Therefore, PI controllers have been adopted in the experimental part.

114

7.4 Experimental Analysis

7.4.2. Experimental Results
To experimentally verify the performance of the proposed hybrid controller for different catheter-tissue relative configurations, the Nano17 force sensor is oriented parallel to the x and z axes as schematically shown in Fig. 7.19.
(2)

Force sensor

Z

(1)
X

Figure 7.19.: Schematic view of the experimental setup. For the first case, where the force sensor is along the x axis, the proposed hybrid controller is implemented to regulate the contact force between the catheter and the force sensor along z axis and position the tip of the catheter along the x axis. The x coordinate of the target is chosen on the center of the force sensor measuring plate to make sure that the catheter is in contact with the force sensor when it reaches the region of interest. Experimental results have been shown in Fig. 7.20. To illustrate the repeatability of the experiment, results have been presented for two experiments performed with similar conditions except the location of the force sensor along z axis. In experiment 2, the force sensor is located 6 mm closer to the origin of the global frame. For both experiments the gains of the force and position controllers have been selected as

Kpp = 0.083, Kip = 0.006, Kpf = 0.1, Kif = 0.003.

(7.6)

The value of the controller gains have been selected by manual tuning with the initial value of the parameters set to the optimal gains obtained through simulation in Section 7.3. As illustrated in Fig. 7.20, for both experiments, the controller stabilizes the contact force to the desired value with minimal overshoot. The position control is also smoothly achieved along the x direction. Smooth sliding of the catheter tip on the exterior plate of the force sensor has been facilitated by applying low friction

115

7.4 Experimental Analysis
0.025 0.02

Contact force (N)

0.015 0.01 0.005 0 6 × 10 -3 20 40 60 80 100 120
Experiment 1 Experiment 2

140
Experiment 1 Experiment 2

Iterations

X coordinate of tip (m)

4 2 0 -2 -4 20 40 60 80 100 120

140
Experiment 1 Experiment 2

-0.048

Z coordinate of tip (m)

Iterations

-0.049 -0.05 -0.051 -0.052 20 40 60 80 100 120 140

Iterations

Figure 7.20.: Regulation of the contact force and position using the hybrid control for the first configuration. tape on both surfaces. The stabilized position of the catheter tip along the z axis is different for the two experiments because of the shift of the force sensor location along this axis. The stepper commands that are the outputs of the controller have been shown for the motors actuating the knob and axial translation in Fig. 7.21. As illustrated in this figure, the controller produces smooth commands without jerky oscillations for both motors. To evaluate the effect of the proportional and integral gains of the position and force controller on the force regulation performance, following experimental analysis has been performed. The value of a specific gain is altered while the other parameters are remained constant. The hybrid controller is then implemented to regulate the force to a fixed desired value. The value of the contact forces are recorded and compared for each set of experiment. The effect of the integral and proportional gains of the force controller have been

116

7.4 Experimental Analysis
Knob stepper command
500 400 300 200 100 20 40 60 80 100 120
Experiment 1 Experiment 2

140

Linear stepper command

150

Iterations

100

50
Experiment 1 Experiment 2

0 20 40 60 80 100 120 140

Iterations

Figure 7.21.: Commands to the stepper motors during the position/force regulation. shown in Fig. 7.22 and Fig. 7.23. As illustrated in Fig. 7.22, the integral gain reduces the amplitude of the steady-state oscillation of the contact force around the desired value. As shown in Fig. 7.23, the proportional gain of the force controller affects the speed of the force regulation mainly at the beginning of the response.
0.04 0.035 0.03 0.025 0.02 0.015 0.01 0.005 0 -0.005 20 40 60 80 100 120 140

Contact force (N)

K pf=0.1, K if=0.006 K pf=0.1, K if=0.003 K pf=0.1, K if=0.010

Iterations

Figure 7.22.: Effect of the integral gain of the force controller. The effect of the integral gain of the position controller has been illustrated in Fig. 7.24. The higher is the value of the integral gain, the smaller become the overshoot and oscillation amplitude of the contact force in steady-state. Contact force readings for different values of the proportional gain of the position controller

117

7.4 Experimental Analysis
0.04 0.035 0.03

Contact force (N)

0.025 0.02 0.015 0.01
K pf=0.05, K if=0.003

0.005 0 -0.005 20 40 60 80 100

K pf=0.10, K if=0.003 K pf=0.15, K if=0.003 K pf=0.20, K if=0.003

120

140

Iterations

Figure 7.23.: Effect of the proportional gain of the force controller. are depicted in Fig. 7.25. As illustrated, higher value of this gain is associated with the larger overshoot and higher amplitudes of oscillation of the contact force around the desired value. As expected, the proportional gain of the position controller, similar to that of the force controller, mainly influences the transient behavior and the response is dominated by the integral gain over time.
0.035 0.03 0.025

Contact force (N)

0.02 0.015 0.01 0.005 0 -0.005 20 40 60 80 100 120 140
K pp=2.5, K K pp=2.5, K
ip ip

=0.1 =0.2

Iterations

Figure 7.24.: Effect of the integral gain of the position controller. For the second catheter-tissue configuration shown in Fig. 7.19, the hybrid controller regulates the contact force between the catheter and the force sensor along x axis and positions the tip of the catheter along the z direction. Results of 4 experiments have been shown in Fig. 7.26. In these experiments, values of the controller gain are set to (7.6) and remained constant. The desired contact force is set to 0.1 N

118

7.5 Conclusion
0.04 0.035 0.03 0.025 0.02 0.015 0.01 0.005 0 -0.005 20 40 60 80 100 120 140

Contact force (N)

K pp=0.8, K K pp=1.5, K K pp=3.5, K

ip ip ip

=0.15 =0.15 =0.15

Iterations

Figure 7.25.: Effect of the proportional gain of the position controller. along the z axis. Since the positive direction of the force sensor coordinate frame is outward as shown in Fig. 7.18, the sensor readings are negative once the catheter collides with the force sensor. As illustrated, the hybrid controller can regulate the contact force to the desired value and simultaneously, stabilize the tip position to the desired value along the z axis. The abrupt change in the position trajectories, which is specially evident in experiment 4, are caused by the static friction between the catheter and the force sensor. Once the actuation force exceeds the static friction along the z axis, the catheter tip is guided to the desired position by the controller command. In the following, the viability of the proposed hybrid controller for the desired contact forces experienced by the catheter during the ablation procedure has been evaluated. Three desired contact forces have been chosen, 0.2 , 0.25 and 0.3 N. The controller gains are remained constant but the relative position of the catheter and the target (force sensor) are varied. As shown in Fig. 7.27, the force regulation is achieved for all the desired forces indicating that the proposed hybrid controller has the potential to be implemented in the interventional procedure.

7.5. Conclusion
Safety and effectiveness of the cardiac ablation can be significantly improved by controlling the contact force between the catheter and the heart tissue. This chapter

119

7.5 Conclusion

0.05
Exp 1 Exp 2 Exp 3 Exp 4

0 Contact force (N)

-0.05

-0.1

-0.15

-0.2 0 -0.045 Tip position (Z coordinate) (m) 50 100 150

-0.05

-0.055

-0.06

-0.065

-0.07 20 40 60 80 Iterations 100 120 140

Figure 7.26.: Regulation of the contact force and position using the hybrid control for the second configuration.

0.05 0 -0.05 -0.1

Contact force (N)

-0.15 -0.2 -0.25 -0.3 -0.35 -0.4 0 50 100 150

Iterations

Figure 7.27.: Force regulation for different desired contact forces.

120

7.5 Conclusion introduced the idea of external hybrid control for catheter automatic navigation in intra-cardiac ablation. The inner position controller is closed by the external force control loop to ensure simultaneous convergence of the position and force to the desired values. The proposed control scheme proved feasible both through experiments and simulations. In the simulation part, the Cosserat rod model of the catheter was adopted along with an interaction model of the catheter and tissue as a simulation environment. An inner singularity-free position control based on the polynomials fitted to the inverse kinematics of the catheter distal shaft was developed. It was concluded that the proposed control scheme is computationally efficient, yet robust to the uncertainty involved in the ablation procedure. It was illustrated that the desired performance of the controller can be achieved by tuning the gains of the force and position PI controllers. The proportional gain of the position controller in the proposed hybrid control scheme, unlike the one in pure position controller suggested in Chapter 6, can improve convergence speed of the both desired position and contact force. The ability of the proposed control framework to track the dynamic heart tissue and regulate the contact force around the desired value was also verified through simulations. In the experiment part, the proposed hybrid controller was successfully implemented by the robotic catheter system. The results indicate that the control scheme is able to safely regulate the contact force to the desired value while the position of the catheter tip is controlled near the target. The gains of both position and force controller were tuned manually with the initial choice set to the optimal gains obtained through simulation. The robustness of the control scheme against the control gain parameters was evaluated through numerous the experiments. The hybrid control scheme presented here relies on a online contact force feedback, measured by the force sensor attached to the tip of the catheter. An alternative solution is to adopt the force estimation approaches introduced in Chapter 4 and 5 to develop a hybrid controller based on pose measurement. The development of such an integrated control system is an interesting area for future research.

121

8. Future Directions and Conclusion
8.1. Future Works
The contributions made in this thesis can be used as a foundation for the future research in variety of promising directions as follows.

8.1.1. Modeling Research
The catheter models developed in Chapters 2 and 3 have been shown to be accurate for different commercial cardiac catheters. However, to obtain a greater accuracy, it might be required in future to consider additional effects that are neglected in the current frameworks. First, the friction between the pull-wires and the sheath can be included in the model. Second, incorporating more accurate nonlinear constitutive laws for modeling the distal shaft behavior might be advantageous. Finding alternate modeling formulations is another area of future work. One possible solution is to extend the catheter model presented in Chapter 2 to three dimensions by including torsional elastic energy term to the potential energy of the system. To incorporate the out-of-plane deflection into the catheter, its backbone curve can be parametrized by piecewise helical curves, i.e., with a constant curvature and torsion. The governing equations for the system can then be found, similarly to the PCAR model, using the virtual work principle. Advantages of such a model are low dimensionality and the fact that the model is efficient for the external forces known in a global frame. Hence, in a wider applications, the model can be adopted in model-based position control schemes where a continuum robot is under the known external forces, e.g., load weight.

122

8.1 Future Works

8.1.2. Force Estimation
Although the proposed contact force estimations in Chapters 4 and 5 proved viable in the experimental settings, in-vivo experiments need to be performed to evaluate the performance of the approaches in medical settings with higher level of the noise and uncertainties. Investigation of the feasibility of the sensing of continuous forces and multiple external forces applied at different points along the catheter is also an interesting area of future investigation. Both the planar force estimation approach and the spatial one can be applied to various continuum robot architectures, regardless of their actuation mechanism. Based on the computational efficiency of their underlying models, the proposed force estimation approaches differ in the coordinate frame in which the estimated force are represented. The planar and spatial approaches provide the contact force in, respectively, a fixed global and a tip local frame. Consequently, each of the methods might be suited to specific applications based on whether the direction of the contact force is required to be estimated with respect to a global frame. For either approach, the range of forces applied to the robot for a specific application should be evaluated to assess if it satisfies a one-to-one relation between measurement quantities and estimated forces. During the ablation procedure, a visual feedback is provided to the interventionalist using an imaging modality, usually X-ray. Utilizing the existing visual feedback to estimate the catheter/tissue contact force might be of great interest since it avoids the extra cost associated with the use of additional sensors. First step for such force estimation approaches is to identify and extract the quantities that are stimulated by the catheter deflection, from the provided images. Second component of such system is a model of the catheter that relates the extracted quantities to the contact forces. The feasibility of such an image-based force estimation can be verified by assessing whether a one-to-one relation exists between the estimated contact forces and the extracted quantities. The computational efficiency of both model and image processing modules are essential for online implementation of such technique. Additional information about the relative pose of the catheter and the surrounding tissue, obtained from imaging modalities, can be integrated to the proposed pose-based force estimation approach to improve the accuracy and reliability of the estimation. More specifically, the direction of the interaction forces between the catheter and tissue can be approximated from the configuration of the robot with

123

8.1 Future Works respect to the cardiac anatomy. This information can be incorporated in the force estimation algorithm to assist the algorithm in finding the accurate estimated force. The underlying catheter models used within the proposed force estimation approaches assume the catheter stiffness parameters are constant. However, in real application the identified parameters might deviate from the original one due to wearing of the catheter or temperature rise in the ablation procedure. To overcome this shortcoming, an adaptive approach can be developed to tune the model parameters in real-time during the procedure.

8.1.3. Control Research
In the area of control, the approaches discussed in Chapters 6 and 7 lay the foundations for different directions of future research. The proposed position and hybrid position/force controller can be implemented along with a path planning technique to build an autonomous navigation platform for steerable catheters. The path planing module can provide trajectories that avoid cardiac structure, acting as an obstacle, on the path toward the target position. The performance of the proposed control schemes was evaluated in the laboratory settings. However, the conditions under which the experiments were performed can be modified to better simulate the medical conditions. For instance, force stabilization performance can be evaluated using an animal tissue to include the effect of the tissue stiffness and catheter/tissue friction in the experiment. The effect of the external forces that are experienced by the catheter during the catheterization procedure can also to be evaluated on the performance of the proposed position controller. Finally, in-vivo experiments need to be conducted for further evaluation of the control schemes. In the proposed position controller, the non-smooth behavior of the distal shaft was identified and compensated using the experimentally-based IK. In this analysis it was implicitly assumed that such nonlinearities do not change over time. However, behavior of the distal shaft may vary due to its residual deformation and wearing during the catheterization. An adaptive approach is thus deemed necessary to adjust the controller parameters accordingly. The hybrid control scheme presented in Chapters 7 relies on an online contact force feedback, measured by the force sensor attached to the tip of the catheter. An

124

8.2 Conclusion alternative solution is to adopt the force estimation approaches introduced in Chapter 4 and 5 to develop a hybrid controller based on the pose measurement. The development of such an integrated control system is an interesting area for future research.

8.2. Conclusion
In this thesis, theoretical grounds were laid and preliminary experimental proof of concepts were presented for developing several technologies to enhance the safety and effectiveness of the cardiac ablation procedure. More analyses, specially invivo experiments need be performed before bringing the proposed technique to the surgical room. The techniques developed here fall in three main categories; catheter force estimation, position control and force control. Force estimation technique: In the area of force estimation an online approach was proposed for the estimation of the external force at the tip of a planar catheter based on the pose measurement. The approach relies on a new efficient quasi-static model of the catheter wherein the catheter is modeled as an elastic rod consisting of piecewise circular curves, PCAR model. The model was experimentally proved viable to predict the shape of the catheter under the external forces. The catheter behavior is highly nonlinear due to the large deflection of the distal shaft and varying bending stiffness of the catheter along its length. However, the PCAR model can capture these nonlinearities mainly because it consists of circular arcs that complies with the initial shape of the distal shaft, i.e., when no external force is applied. Different stiffness values of the piecewise curves that can be obtained through the identification help incorporate inhomogeneous mechanical properties of the catheter in tho the PCAR model. Adopting the PCAR model in a force estimation scheme provides several benefits. The low dimensionality of the model and the availability of the closed-form Jacobian for both force and curvature estimation guarantee the computational efficiency of the algorithm. Moreover, because the model provides the overall shape of the catheter, redundant pose sensing along the length of the catheter can be added to increase the reliability of the force estimation approach. Theoretical analyses simulating the forces and configurations experienced by the catheter during the ablation procedure along with the experimental studies indicated the feasibility of the proposed scheme

125

8.2 Conclusion for estimating the contact force in the ablation procedure. An extension to the proposed planar force estimation approach to 3D was also developed in this thesis. The core of the proposed 3D pose-based force estimation is a quasi-static model of the catheter that is derived by coupling the classical Cosserat rod model with a new model of the pull-wire actuation. One feature of the catheter model is its computational efficiency due to the fact that the governing equations form an IVP for the known tip forces in the local frame. The novelty of the force estimation approach is that it takes advantage of the computational efficiency of the proposed catheter model by choosing the local frame as the coordinate frame in which the external forces are expressed. The proposed force estimation approach was also evaluated for different combinations of the relative poses along the catheter as measured quantities, in terms of feasibility, error sensitivity and computation time of the algorithm. It was concluded that the force estimation based on the relative orientation of three sensors along the catheter and force estimation based on the relative position of two sensors and their associate absolute orientation, can be successfully adopted in the ablation procedure. Both of these approaches can be implemented in real-time and lead to a unique estimated force for the range of forces in the ablation procedure. However, the approaches based on the relative pose are relatively more sensitive to the pose measurement error. Position control scheme: A new position control scheme for a robotic assisted catheter manipulation system was proposed and successfully implemented. The proposed position controller is based on the experimentally obtained inverse kinematics through which the non-smooth dynamics of the distal shaft is incorporated in the controller. To properly compensate for the backlash behavior of the system in axial translation and twist, due to its interaction with the veins though which it passes, an inverse backlash model was also included to the proposed controller. Hybrid position/force control scheme: The proposed position controller was employed to develop a hybrid position/force controller that positions the catheter tip to the target tissue and simultaneously, regulates the contact force to a desired value. The uniqueness of the proposed control scheme is that, as opposed to the existing literature, it accounts for both axial translation and bending of the distal shaft. It is also computationally efficient so that it can comply with the high speed motion of the cardiac tissue. The viability of the controller was verified through simulation and experiments.

126

8.2 Conclusion In the end, the contributions made through this research are summarized: · Quasi-static modeling of a planar catheter using piecewise circular curve · A new spatial model of pull-wire driven intra-cardiac catheters based on the theory of Cosserat rod · An efficient catheter force estimation based on pose measurements using the piecewise circular curve model · An efficient 3D force estimation scheme for intra-cardiac catheters based on the Cosserat-rod model and evaluation of different measurement quantities · A position control scheme for a robotic catheter using experimentally-based inverse kinematics · A hybrid position/force control for intra-cardiac ablation catheters

127

A. Cardiac Arrhythmia
In this chapter, cardiac arrhythmia that can be diagnosed and treated by intracardiac catheterization are introduced and the catheterization procedures for their treatment are briefly discussed. Cardiac arrhythmias are abnormalities in formation or conduction of heart electrical signals that leads to slow (bradycardia) or fast (tachycardia) heart rhythms [1]. Treatment of the patients with slow rhythms is performed by using pacemakers that are able to adapt their function to the needs of the body. However, the origin of the fast heart rhytms might be anywhere in the heart and results from a variety of mechanisms. Based on the location of the origin of the abnormal electrical activities, tachycardia is divided to two main groups: supra-ventricular tachycardia (SVT) and ventricular tachycardia (VT) which arises from the upper chambers (atria) and lower chamber (ventricle), respectively. For diagnosis and management of tachycardia, intra-cardiac catheterization is a common practice. However, catheter ablation of SVTs is typically more successful and more often performed. A conventional catheterization session procedures consists of the following operations: · Electrophysiology study - An EP study is a procedure performed to determine the site of origin or pathway of an arrhythmia. A cardiac electrophysiologist, usually inserts a sheath, which is a hollow plastic tube with a 30° curve at the end, into femoral vein (see Fig. A.1). Then several catheters are inserted through the sheath to reach to the cardiac chamber under fluoroscopic, or X-ray, guidance. These catheters are usually placed in well-defined regions, critical to the heart's normal conduction system, such as the right atrium, His bundle, and the right ventricle. These catheters allow the electrophysiologist to electrically map the origin and characteristics of the clinical arrhythmia. · Catheter ablation - Once the location of the arrhythmia is determined, a special ablation catheter is positioned at the site of the abnormal electrical

128

Cardiac Arrhythmia pathway. The small area of the heart tissue that contains the abnormal electrical pathway is disrupted by heating or cooling the tissue in radio-frequency ablation or cryoablation procedure, respectively.

Femoral vein Catheter

Figure A.1.: The procedure of intra-cardiac catheterization. Common types of SVTs that can be treated by catheter ablation include: · Atrial fibrillation (AF) - It is the most common cardiac arrhythmia. During AF, the atria can contract anywhere, in an irregular and chaotic fashion. To treat AF, catheter ablation is performed to electrically isolate the pulmonary veins with the delivery of RF energy (Fig. A.2(a)). The procedure involves creation of a `transseptal puncture' in the wall between the right atrium and left atrium (inter-atrial septal wall), using a needle which is passed through the steerable sheath. The ablation catheter is then guided to the left atrium through the steerable sheath, which is pivoted about the transseptal puncture location. · Atrial flutter - It is the result of a rapid electrical loop in the top right heart chamber, the right atrium. Atrial flutter catheter ablation delivers a linear ablation lesion to interrupt and terminate the abnormal electrical circuit (Fig.Fig. A.2(b)). · AV nodal reentrant tachycardia (AVNRT) - Patients with AVNRT have at least two pathways (slow and fast) of tissue in their AV node that allows for an abnormal electrical circuit to perpetuate within their AV node. In catheter ablation operation, radio-frequency energy is delivered, typically at

129

Cardiac Arrhythmia the site of the slow pathway, to eradicate the circuit that causes AVNRT (Fig.Fig. A.2(c)). · Wolff-Parkinson-White Syndrome (WPW Syndrome) - It is caused by the presence of an abnormal accessory electrical conduction pathway between the atria and the ventricles. Catheter can be inserted to either the right side of the cardiac chamber, as depicted in Fig. A.2 (e), or its left side based on the type of accessory pathway. For the left-sided WPW syndrome, there are two different ways for the catheter to reach the desired location for ablation. One involves placing the wire into the high pressure artery of the leg and passing it backwards into the left ventricle and then steer the catheter beneath the mitral valve. In the second approach, a catheter is passed and positioned above the mitral valve, through inter-atriall septum (Fig. A.2 (d)).
AV node

(a)

(b)

(c)

(d)

(e)

(f)

Figure A.2.: Illustration of catheter ablation for different arrhythmias. AF (a), Atrial flutter (b), AVNRT (c), WPW syndrome in left chamber (d), WPW syndrome in right chamber (e) and VT (f). Ventricular tachycardia is potentially the most dangerous heart rhythm disturbances, requiring the most aggressive therapy. Common types of VTs that can be treated by catheter ablation includes:

130

Cardiac Arrhythmia · Ventricular Tachycardia (VT) in patients without structural heart disease - These types of VT are typically caused by a focal mechanisms. The focal region of arrhythmia can be localized and ablated to remove the the origin of electrical abnormalities (Fig. A.2(f)).

131

B. Jacobian Matrices for the Planar Catheter Model
Members of the the kinematic Jacobian matrix for the PCAR model (n = 3) include E1 1 =- 2 (2 3 sin (1 1 1 2 3 -1 2 2 -1 2 3
1 1

1)

+ 1 2 2

1

cos (1
1

1

+ 2
1)

2)

cos (1 cos (1

1 1

+ 2 + 2

2

+ 3

3)

- 1 2 3
1

cos (1

2)

+ 1 2 3

cos (1

1 )),

1 E1 = 2 (3 sin (1 2 2 3 +2 2 -2 2
2 2

1)

- 3 sin (1
3)

1

+ 2
2

2) 1

cos (1 cos (1

1 1

+ 2 + 2

2

+ 3

+ 2 3

cos (1

+ 2

2)

2 )),

E1 1 = 2 (sin (1 3 3 +3
3

1

+ 2
2

2)

- sin (1
3 )),

1

+ 2

2

+ 3

3)

cos (1

1

+ 2

+ 3
1) 2)

1 E2 = 2 (2 3 cos (1 1 1 +1 2 3 -1 2 3
1 1

- 2 3 - 1 2 2 + 1 2 2
1 1

1

sin (1
1

1 2

+ 2 + 3

2) 3)

sin (1 sin (1

1

+ 2

sin (1
1 )),

+ 2

1)

+ 1 2 3 + 2

sin (1

E2 1 = 2 (3 cos (1 2 2 -2 2 +2 2
2 2

1

2)

- 3 cos (1
2

1)

sin (1 sin (1

1 1

+ 2 + 2

2) 2

+ 2 3
3 )),

sin (1

1

+ 2

2)

+ 3

132

Jacobian Matrices for the Planar Catheter Model

E2 1 = 2 (cos (1 3 3 +3
3

1

+ 2
2

2

+ 3
3 )),

3)

- cos (1

1

+ 2

2)

sin (1

1

+ 2

+ 3

E3 = 1

1,

E3 = 2

2,

E3 = 3

3.

Members of the the static Jacobian matrix for the PCAR model (n = 3) are P1 sin (1 1 ) 1 cos (1 1 ) = - - Fx 1 1 2 1 cos (1 1 cos (1 1 + 2 2 ) + - 3
1

1

cos (1 1 ) 1 cos (1 1 + 2 + 2 2 + 2 2 + 3 3 ) , 3
1 2)

2)

P1 cos (1 1 ) 1 sin (1 1 + 2 2 + 3 3 ) -2 -  + = + 1 Fy 1 2 3 1 sin (1 1 ) 1 sin (1 1 + 2 2 ) 1 sin (1 1 + 2 - + - 2 2 3 1 P2 = 2 (3 sin (1 Fx 2 3 +2 2
2 1)

sin (1 1 ,

1)

- 3 sin (1
3)

1

+ 2
2

2)

- 2 2
1

2

cos (1
2 )),

1

+ 2

2)

cos (1

1

+ 2

2

+ 3

+ 2 3

cos (1
1)

+ 2

1 P2 = 2 (3 cos (1 Fy 2 3 +2 2
2

1

+ 2
3)

2)

- 3 cos (1
2

sin (1
2

1

+ 2
1

2

+ 3
2 )),

- 2 2

sin (1

1

+ 2

2)

+2 3

sin (1

+ 2

P3 1 = (sin (1 Fx 3 2 +3
3

1

+ 2
2

2)

- sin (1
3 )),

1

+ 2

2

+ 3

3)

cos (1

1

+ 2

+ 3

P3 1 = 2 (cos (1 Fy 3 +3
3

1

+ 2
2

2

+ 3
3 )).

3)

- cos (1

1

+ 2

2)

sin (1

1

+ 2

+ 3

133

Bibliography
[1] S. K. S. Huang, M. A. Wood, and J. M. Miller, Catheter Ablation of Cardiac Arrhythmias. Elsevier Health Sciences, 2010. [2] S. Stewart, C. Hart, D. Hole, and J. McMurray, "Population prevalence, incidence, and predictors of atrial fibrillation in the renfrew/paisley study," Heart, vol. 86, no. 5, pp. 516­521, 2001. [3] D. C. Shah, H. Lambert, H. Nakagawa, A. Langenkamp, N. Aeby, and G. Leo, "Area under the real-time contact force curve (force­time integral) predicts radiofrequency lesion size in an in vitro contractile model," J. Cardiovasc. Electrophysiol., vol. 21, no. 9, pp. 1038­1043, 2010. [4] J. Petru and J. Skoda, "Robot-assisted navigation in atrial fibrillation ablationof any benefits?" Cor et Vasa, vol. 54, no. 6, pp. 408­413, 2012. [5] "Stereotaxis NIOBE Magnetic Navigation." [Online]. Available: //www.stereotaxis.com/physicians/stereotaxis-ablation. http:

[6] "Hansen Medical Sensei X Robotic Catheter System." [Online]. Available: http://www.hansenmedical.com/us/en/cardiac-arrhythmia/ sensei-robotic-system/product-overview. [7] D. Filgueiras-Rama, A. Estrada, J. Shachar, S. Castrejón, D. Doiny, M. Ortega, E. Gang, and J. L. Merino, "Remote magnetic navigation for accurate, real-time catheter positioning and ablation in cardiac electrophysiology procedures," J. Vis.Exp., no. 74, pp. 1­8, 2013. [8] "Catheter Robotics Amigo RCS." catheterrobotics.com/rcs-main. [Online]. Available: http://www.

[9] L. Cercenelli, E. Marcelli, and G. Plicchi, "Initial experience with a telerobotic system to remotely navigate and automatically reposition standard steerable ep catheters," ASAIO J., vol. 53, no. 5, pp. 523­529, 2007.

134

Bibliography [10] Y. Ganji and F. Janabi-Sharifi, "Catheter kinematics for intracardiac navigation," IEEE Trans. Biomed. Eng., vol. 56, no. 3, pp. 621­632, 2009. [11] T. Datino, A. Arenal, M. Pelliza, J. Hernández-Hernández, F. Atienza, E. González-Torrecilla, P. Avila, L. Bravo, and F. Fernández-Avilés, "Comparison of the safety and feasibility of arrhythmia ablation using the amigo robotic remote catheter system versus manual ablation," Am. J. Cardiol., vol. 113, no. 5, pp. 827­831, 2014. [12] R. J. Webster and B. A. Jones, "Design and kinematic modeling of constant curvature continuum robots: A review," Int. J. Rob. Res., vol. 29, no. 13, pp. 1661­1683, 2010. [13] T. Mahl, A. Hildebrandt, and O. Sawodny, "A variable curvature continuum kinematics for kinematic control of the bionic handling assistant," IEEE Trans. Rob., vol. 30, no. 4, pp. 935­949, 2014. [14] P. Sears and P. E. Dupont, "Inverse kinematics of concentric tube steerable needles," in Proc. IEEE Int. Conf. Robot. Autom., ICRA 2007. Roma, Italy, 2007, pp. 1887­1892. [15] R. J. Murphy, M. D. Kutzer, S. M. Segreti, B. C. Lucas, and M. Armand, "Design and kinematic characterization of a surgical manipulator with a focus on treating osteolysis," Robotica, vol. 32, no. 06, pp. 835­850, 2014. [16] K. Xu and N. Simaan, "Analytic formulation for kinematics, statics, and shape restoration of multibackbone continuum robots via elliptic integrals," J. of Mech. and Robot., vol. 2, no. 1, pp. 011 006­1­13, 2010. [17] M. Khoshnam, M. Azizian, and R. V. Patel, "Modeling of a steerable catheter based on beam theory," in Proc. IEEE Int. Conf. Robot. Autom. Saint Paul, Minnesota, USA, 2012, pp. 4681­4686. [18] M. Khoshnam and R. V. Patel, "A pseudo-rigid-body 3r model for a steerable ablation catheter," in Proc. IEEE Int. Robot. Autom. (ICRA 2013). Karlsruhe, Germany, 2013, pp. 4427­4432. [19] W. Wei and N. Simaan, "Modeling, force sensing, and control of flexible cannulas for microstent delivery," J. Dyn. Syst. Meas. Contr., vol. 134, no. 4, pp. 041 004­1­12, 2012. [20] J. Jung, R. S. Penning, and M. R. Zinn, "A modeling approach for robotic

135

Bibliography catheters: effects of nonlinear internal device friction," Adv. Robot., vol. 28, no. 8, pp. 557­572, 2014. [21] Y. Yekutieli, R. Sagiv-Zohar, R. Aharonov, Y. Engel, B. Hochner, and T. Flash, "Dynamic model of the octopus arm. i. biomechanics of the octopus reaching movement," J. Neurophysiol., vol. 94, no. 2, pp. 1443­1458, 2005. [22] V. Luboz, J. Lai, R. Blazewski, D. Gould, and F. Bello, "A virtual environment for core skills training in vascular interventional radiology," Biomed. Simul., pp. 215­220, 2008. [23] T. Alderliesten, P. A. Bosman, and W. J. Niessen, "Towards a real-time minimally-invasive vascular intervention simulation system," IEEE Trans. Med. Imag., vol. 26, no. 1, pp. 128­132, 2007. [24] K.-I. Anjyo, Y. Usami, and T. Kurihara, "A simple method for extracting the natural beauty of hair," in Proc. ACM SIGGRAPH Comput. Graph., vol. 26, no. 2, 1992, pp. 111­120. [25] M. Moll and L. E. Kavraki, "Path planning for deformable linear objects," IEEE Trans. Rob., vol. 22, no. 4, pp. 625­636, 2006. [26] J. Lenoir, P. Meseure, L. Grisoni, and C. Chaillou, "Surgical thread simulation," in Proc. ESAIM, vol. 12, 2002, pp. 102­107. [27] A. Theetten, L. Grisoni, C. Duriez, and X. Merlhiot, "Quasi-dynamic splines," in Proc. ACM symp. Solid and Phys. Model. Beijing, China, 2007, pp. 409­414. [28] H. Wakamatsu and S. Hirai, "Static modeling of linear object deformation based on differential geometry," Int. J. Rob. Res., vol. 23, no. 3, pp. 293­311, 2004. [29] S. Li, J. Qin, J. Gao, Y.-P. Chui, and P.-A. Heng, "A novel FEM-based numerical solver for interactive catheter simulation in virtual catheterization," J. Biomed. Imag., vol. 3, pp. 1­8, 2011. [30] C. Duriez, S. Cotin, J. Lenoir, and P. Neumann, "New approaches to catheter navigation for interventional radiology simulation," J. Comput. Aided Surg., vol. 11, no. 6, pp. 300­308, 2006. [31] S. Antman, Nonlinear Problems of Elasticity. Springer, 2005, vol. 107. [32] J. Davis and R. Hirschorn, "A model for the embedded tendon control of a slender three-dimensional flexible robot link," Dyn. Control, vol. 4, no. 2, pp. 185­208, 1994.

136

Bibliography [33] C. Li and C. D. Rahn, "Design of continuous backbone, cable-driven robots," J. Mech. Des., vol. 124, no. 2, pp. 265­271, 2002. [34] B. A. Jones, R. L. Gray, and K. Turlapati, "Three dimensional statics for continuum robotics," in Proc. IEEE/RSJ Int. Conf. Robot. Syst. St. Louis, MO, USA, 2009, pp. 2659­2664. [35] D. Rucker, B. A. Jones, and R. J. Webster, "A geometrically exact model for externally loaded concentric-tube continuum robots," IEEE Trans. Rob., vol. 26, no. 5, pp. 769­780, 2010. [36] D. Trivedi, A. Lotfi, and C. D. Rahn, "Geometrically exact models for soft robotic manipulators," IEEE Trans. Rob., vol. 24, no. 4, pp. 773­780, 2008. [37] I. Tunay, "Distributed parameter statics of magnetic catheters," in Proc. Annu. Int. Conf. Eng. Med. Biol. Soc. Boston, MA, USA, 2011, pp. 8344­8347. [38] D. Rucker and R. Webster, "Statics and dynamics of continuum robots with general tendon routing and external loading," IEEE Trans. Rob., vol. 27, no. 6, pp. 1033 ­1044, 2011. [39] D. C. Rucker and R. Webster, "Computing jacobians and compliance matrices for externally loaded continuum robots," in Proc. IEEE Int. Conf. Robot. Autom., ICRA 2011. Shanghai, China, 2011, pp. 945­950. [40] S. B. Kesner and R. D. Howe, "Robotic catheter cardiac ablation combining ultrasound guidance and force control," Int. J. Rob. Res., vol. 33, no. 4, pp. 631­644, 2014. [41] P. Polygerinos, L. D. Seneviratne, R. Razavi, T. Schaeffter, and K. Althoefer, "Triaxial catheter-tip force sensor for MRI-guided cardiac procedures," IEEE/ASME Trans. Mechatron., vol. 18, no. 1, pp. 386­396, 2013. [42] P. Polygerinos, P. Puangmali, T. Schaeffter, R. Razavi, L. D. Seneviratne, and K. Althoefer, "Novel miniature MRI-compatible fiber-optic force sensor for cardiac catheterization procedures," in Proc. IEEE Int. Conf. Robot. Autom. (ICRA 2013). Anchorage, Alaska, 2010, pp. 2598­2603. [43] P. Polygerinos, A. Ataollahi, T. Schaeffter, R. Razavi, L. D. Seneviratne, and K. Althoefer, "MRI-compatible intensity-modulated force sensor for cardiac catheterization procedures," IEEE Trans. Biomed. Eng., vol. 58, no. 3, pp. 721­726, 2011.

137

Bibliography [44] K. Xu and N. Simaan, "Intrinsic wrench estimation and its performance index for multisegment continuum robots," IEEE Trans. Rob., vol. 26, no. 3, pp. 555­561, 2010. [45] ----, "An investigation of the intrinsic force sensing capabilities of continuum robots," IEEE Trans. Rob., vol. 24, no. 3, pp. 576­587, 2008. [46] A. Bajo and N. Simaan, "Kinematics-based detection and localization of contacts along multisegment continuum robots," IEEE Trans. Rob., vol. 28, no. 2, pp. 291­302, 2012. [47] D. C. Rucker and R. Webster, "Deflection-based force sensing for continuum robots: a probabilistic approach," in Proc. IEEE/RSJ Int. Conf. Intell. Robot. Syst. San Francisco, CA, 2011, pp. 3764­3769. [48] M. Khoshnam and R. V. Patel, "Estimating contact force for steerable ablation catheters based on shape analysis," in Proc. IEEE/RSJ Int. Conf. Intell. Robot. Syst. Chicago, Illinois, 2014, pp. 3509­3514. [49] A. Z. Faranesh, P. Kellman, K. Ratnayaka, and R. J. Lederman, "Integration of cardiac and respiratory motion into MRI roadmaps fused with x-ray," Med. Phys., vol. 40, no. 3, pp. 032 302­1­8, 2013. [50] D. B. Camarillo, C. R. Carlson, and J. K. Salisbury, "Task-space control of continuum manipulators with coupled tendon drive," in Exp. Robot. Springer, 2009, pp. 271­280. [51] D. B. Camarillo, C. F. Milne, C. R. Carlson, M. R. Zinn, and J. K. Salisbury, "Mechanics modeling of tendon-driven continuum manipulators," IEEE Trans. Rob., vol. 24, no. 6, pp. 1262­1273, 2008. [52] R. S. Penning, J. Jung, J. A. Borgstadt, N. J. Ferrier, and M. R. Zinn, "Towards closed loop control of a continuum robotic manipulator for medical applications," in Proc. IEEE Int. Conf. Robot. Autom., ICRA 2011. Shanghai, China, 2011, pp. 4822­4827. [53] R. S. Penning, J. Jung, N. J. Ferrier, and M. R. Zinn, "An evaluation of closedloop control options for continuum manipulators," in Proc. IEEE Int. Conf. Robot. Autom., 2012, pp. 5392­5397. [54] A. Bajo, R. E. Goldman, and N. Simaan, "Configuration and joint feedback for enhanced performance of multi-segment continuum robots," in Proc. IEEE Int. Conf. Robot. Autom., ICRA 2011. Shanghai, China, 2011, pp. 2905­2912.

138

Bibliography [55] Y. Ganji, F. Janabi-Sharifi, and A. N. Cheema, "Robot-assisted catheter manipulation for intracardiac navigation," Int. J. of Comput. Assisted Radiol. Surg., vol. 4, no. 4, pp. 307­315, 2009. [56] K. Xu and N. Simaan, "Actuation compensation for flexible surgical snakelike robots with redundant remote actuation," in Proc. IEEE Int. Conf. Robot. Autom., ICRA 2006. Orlando, Florida, 2006, pp. 4148­4154. [57] M. Khoshnam and R. V. Patel, "Robotics-assisted catheter manipulation for improving cardiac ablation efficiency," in Proc. IEEE Int. Robot. Autom. (ICRA 2014). Hong Kong, China, 2014, pp. 308­313. [58] S. B. Kesner and R. D. Howe, "Position control of motion compensation cardiac catheters," IEEE Trans. Rob., vol. 27, no. 6, pp. 1045­1055, 2011. [59] M. Mahvash and P. E. Dupont, "Stiffness control of surgical continuum manipulators," IEEE Trans. Rob., vol. 27, no. 2, pp. 334­345, 2011. [60] R. Xu, A. Asadian, A. S. Naidu, and R. V. Patel, "Position control of concentrictube continuum robots using a modified jacobian-based approach," in Proc. IEEE Int. Robot. Autom. (ICRA 2013). Karlsruhe, Germany, 2013, pp. 5813­ 5818. [61] J. Jayender, R. V. Patel, and S. Nikumb, "Robot-assisted active catheter insertion: algorithms and experiments," Int. J. Rob. Res., vol. 28, no. 9, pp. 1101­1117, 2009. [62] G. Smoljkic, E. Vander Poorten, M. Sette, and J. Vander Sloten, "Towards bilateral teleoperation of a standard electrophysiology catheter," in Proc. SCATh Work. New Technolog. Comp./Robot Assist. Surg. Graz, Austria, 2011, pp. 1­6. [63] S. B. Kesner and R. D. Howe, "Force control of flexible catheter robots for beating heart surgery," in Proc. IEEE Int. Conf. Robot. Autom., ICRA 2011. Shanghai, China, 2011, pp. 1589­1594. [64] A. Bajo and N. Simaan, "Hybrid motion/force control of multi-backbone continuum robots," Int. J. Rob. Res., p. 0278364915584806, 2015. [65] M. Khoshnam, A. Yurkewich, and R. V. Patel, "Model-based force control of a steerable ablation catheter with a custom-designed strain sensor," in Proc. IEEE Int. Robot. Autom. (ICRA 2013). Karlsruhe, Germany, 2013, pp. 4479­ 4484.

139

Bibliography [66] B. K. Horn, "The curve of least energy," ACM Trans. Math. Software, vol. 9, no. 4, pp. 441­460, 1983. [67] B. Audoly and Y. Pomeau, Elasticity and Geometry: from Hair Curls to the Nonlinear Response of Shells. Oxford Univ. Press, 2010. [68] D. K. Pai, "Strands: Interactive simulation of thin solids using cosserat models," in Comput. Graphics Forum, vol. 21, no. 3, 2002, pp. 347­352. [69] I. A. Gravagne, C. D. Rahn, and I. D. Walker, "Large deflection dynamics and control for planar continuum robots," IEEE/ASME Trans. Mechatron., vol. 8, no. 2, pp. 299­307, 2003. [70] A. Salimi, J. Mohammadpour, K. Grigoriadis, and N. Tsekos, "Dynamic simulation of blood flow effects on flexible manipulators during intra-cardiac procedures on the beating heart," in Proc. ASME 2011 Dyn. Sys. Contol Conf. Arlington, VA, USA, 2011, pp. 478­494. [71] L. Sciavicco and L. Villani, Robotics: Modelling, Planning and Control. Springer, 2009. [72] D. Cao and R. W. Tucker, "Nonlinear dynamics of elastic rods using the cosserat theory: modelling and simulation," Int. J. Solids Struct., vol. 45, no. 2, pp. 460­477, 2008. [73] D. E. Haines, "Determinants of lesion size during radiofrequency catheter ablation: The role of electrode-tissue contact pressure and duration of energy delivery," J. Cardiovasc. Electrophysiol., vol. 2, no. 6, pp. 509­515, 1991. [74] F. Perna, E. K. Heist, S. B. Danik, C. D. Barrett, J. N. Ruskin, and M. Mansour, "Assessment of catheter tip contact force resulting in cardiac perforation in swine atria using force sensing technologyclinical perspective," Cir. Arrhythmia Electrophysiol., vol. 4, no. 2, pp. 218­224, 2011. [75] K. Levenberg, "A method for the solution of certain problems in least squares," Q. Appl. Math, vol. 2, pp. 164­168, 1944. [76] C. B. L. Di Biase, A. Natale et al., "Relationship between catheter forces, lesion characteristics, popping, and char formation: Experience with robotic navigation system," J. Cardiovasc. Electrophysiol., vol. 20, no. 4, pp. 436­440, 2008. [77] Y. Ganji, "A platform for robot-assisted intracardiac catheter navigation," Ph.D. dissertation, University of Waterloo, 2009.

140

Bibliography [78] K. O. Arras, "An introduction to error propagation: Derivation, meaning and examples of cy= fx cx fx," Swiss Federal Institute of Technology Lausanne (EPFL), Tech. Rep. EPFL-ASL-TR-98-01 R3, 1998. [79] G. Tao and P. V. Kokotovic, Adaptive Control of Systems with Actuator and Sensor Nonlinearities. John Wiley & Sons, Inc., 1996. [80] J. Troccaz, Ed., Medical Robotics. John Wiley and Sons, 2012. [81] B. Siciliano and L. Villani, Robot Force Control. Kluwer Academic Pub, 1999, vol. 540. [82] M. Raibert, "Hybrid position/force control of a manipulators," ASME J. Dyn. Sys. Meas. Control, vol. 102, pp. 126­133, 1981. [83] T.-S. Chung, "An inherent stability problem in cartesian compliance and an alternative structure of compliance control," IEEE Trans. Rob. Autom., vol. 7, no. 1, pp. 21­30, 1991. [84] J. De Schutter and H. Van Brussel, "Compliant robot motion ii. a control approach based on external control loops," Int. J. Rob. Res., vol. 7, no. 4, pp. 18­33, 1988. [85] K. Yokoyama, H. Nakagawa, D. C. Shah, Lambert et al., "Novel contact force sensor incorporated in irrigated radiofrequency ablation catheter predicts lesion size and incidence of steam pop and thrombusclinical perspective," Cir. Arrhythmia Electrophysiol., vol. 1, no. 5, pp. 354­362, 2008. [86] R. Featherstone, "Modeling and control of contact between constrained rigid bodies," IEEE Trans. Rob., vol. 20, no. 1, pp. 82­92, 2004. [87] G. Picinbono, J.-C. Lombardo, H. Delingette, and N. Ayache, "Improving realism of a surgery simulator: linear anisotropic elasticity, complex interactions and force extrapolation," J. Visual. Comput. Anim., vol. 13, no. 3, pp. 147­167, 2002. [88] J. Hu, C. Chang, N. Tardella, J. Pratt, and J. English, "Effectiveness of haptic feedback in open surgery simulation and training systems," Stud. Health Technol. Inform., vol. 119, pp. 213­218, 2006. [89] S. G. Yuen, P. M. Novotny, and R. D. Howe, "Quasiperiodic predictive filtering for robot-assisted beating heart surgery," in Proc. IEEE Int. Conf. Robot. Autom., ICRA 2008. Pasadena, CA, 2008, pp. 3875­3880.

141

Bibliography [90] M.-B. Edwards, E. R. Draper, J. W. Hand, K. M. Taylor, and I. R. Young, "Mechanical testing of human cardiac tissue: some implications for MRI safety," J. Cardiov. Magn. Reson., vol. 7, no. 5, pp. 835­840, 2005. [91] J. C. Lagarias, J. A. Reeds, M. H. Wright, and P. E. Wright, "Convergence properties of the nelder­mead simplex method in low dimensions," SIAM J. Optim., vol. 9, no. 1, pp. 112­147, 1998. [92] O. Bebek and M. C. Çavusoglu, "Intelligent control algorithms for roboticassisted beating heart surgery," IEEE Trans. Rob., vol. 23, no. 3, pp. 468­480, 2007.

142


