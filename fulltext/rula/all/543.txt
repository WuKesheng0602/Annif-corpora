Ryerson University

Digital Commons @ Ryerson
Theses and dissertations

1-1-2008

Improved diagnosis and navigation for CT colonography
Jinjie Ming
Ryerson University

Follow this and additional works at: http://digitalcommons.ryerson.ca/dissertations Part of the Electrical and Computer Engineering Commons Recommended Citation
Ming, Jinjie, "Improved diagnosis and navigation for CT colonography" (2008). Theses and dissertations. Paper 484.

This Thesis Project is brought to you for free and open access by Digital Commons @ Ryerson. It has been accepted for inclusion in Theses and dissertations by an authorized administrator of Digital Commons @ Ryerson. For more information, please contact bcameron@ryerson.ca.

Improved Diagnosis and Navigation
for CT Coionography

by

Jinjie Meng

A project

presented to Ryerson University in partial fulfillment of the requirement for the degree of
Master of Engineering

in the Program of Electrical and Computer Engineering

Toronto, Ontario, Canada, 2008

© Jinjie Meng, 2008

PROPERTY OF

Author's Declaration

I hereby declare that I am the sole author of this project.

I authorize Ryerson University to lend this project to other institutions or
individuals for the purpose of scholarly research.

I

further

authorize

Ryerson

University

to

reproduce

this

project

by

photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

Abstract

This project describes the development of an automatic segmentation

method and a novel navigation system that detect polyps using advanced
image processing and computer graphics techniques. The colon wall

segmentation method from the CT data set of abdomen is achieved by combining the active contouring model - level set method and the minima
detection using mathematical morphology theory. Polyp detection is

attained by analyzing surface curvature and texture information along on

the colon wall. Adding texture analysis provides a new feature for improving currently existing methods. As such, polyp candidates are examined not
only by their shape and size but also by their texture appearance.

Acknowledgements

This research is supported by the discovery grant of the Natural Science and
Engineering Research Council (NSERC) of Canada.

The medical expertise and knowledge for detection polyps from CT images is provide by Professor S Gallinger who poses valuable research experiences in colon cancer research, professor N Jaffer who is expert in radiology and colon cancer diagnosis, and Radiologist from Staten Island hospital, New York who contributes valuable expertise in colon cancer imaging.

Most important of all, I would like to extend my special thanks to Dr. Y Jiang,

my supervisor at the Department of Computer Science, Ryerson University.

Professor Jiang has involved in the field of medical image analysis and
computer science since she joined Ryerson University. She has more than 10

years of research experience in image analysis, computer graphics and object oriented programming. She has supported me through my years of graduate studies and provided me a great opportunity to work on this

research project under her guidance and supervision.

Table of Contents

1. Introduction 1.1 Clinical Problem

1 1

1.2 CT Colonography 1.3 Canger Relevance

1 4

1.3.1 Active Contour Modeling and Gray Scale Analysis
1.3.2 Reduction of Radiation Exposure
1.3.3 Navigation System

5
6
6

2. Background 2.1 Patient-Oriented Issues 2.2 Viewing System for Blind Spots 3. Methods
3.1 Colon Lumen Detection 3.1.1 Dilation
3.1.2 Erosion

7 9 10 12
12 13
14

3.1.3 Opening....

15

3.1.4 Closing
3.2 Colon Wall Detection

15
16

3.3 Polyp Detection
3.3.1 Curve Detection.. 3.4. An Innovative Viewing System

22
22 28

3.4.1 Mucosal Coloration 3.4.2 Front-and-Side-Viewing Colonoscope
3.4.3 Navigation System

28 29
30

4. Experimental Results
4.1 Architecture

33
33

4.2 test Results
5. Summary

34
39

5.1 Conclusion 5.2 Future Work

39 39

References

41

List of Figures

Figure 1: Dilation by a 3 x 3 structuring element
Figure 2: Erosion by a 3 x 3 structuring element Figure 3: Opening by a 7 x 7 circular structuring element

f

14
14 15

Figure 4: Closing by a 3 x 3 structuring element Figure 5: Level-set method

16 20

Figure 6: Initial curves segmented using active contour model
Figure 7: Angles in raster graphics Figure 8: Directional changes
Figure 9: Simplified directional changes Figure 10: Sharp turns

22
23 24
24 .25

Figure 11: [left-turn, right-turn] pairs Figure 12: A polyp candidate
Figure 13: Result of polyp detection
Figure 14: Texture analysis Figure 15: Front-view camera path

25 26
26
28 31

Figure 16: Software system architecture Figure 18: Segmentation result using level-set method

33 35

Figure 17: (a) A typical colon image, (b) A stack of CT colon images.... 34
Figure 19: Segmented result overlapped with the original image Figure 20: 3D colon image Figure 21: Inside-view of a 3D colon model
Figure 22: Mucosal coloration during fly through,

35 36 37

viewed regions shown in

light color, while unviewed dark

37

1. Introduction

1.1 Clinical Problem

Colorectal

carcinoma

currently

ranks

as the third

most

common

human

malignancy and the second leading cause of cancer-related death in North

America [1]. Unfortunately, colon cancer is most often discovered after the patient develops symptoms, and by then, the likelihood of a cure has diminished
substantially. Earlier detection and removal of polyps is the key to prevent colon cancer and can eliminate colon cancer in 90% of patients [2].

1.2 CT Colonography

Conventional

colonoscopy

is

the

most

accurate

diagnostic

procedure

for

detecting polyps that is currently available. However, it is expensive, invasive, uncomfortable, time consuming and carries a small risk of perforation and

death. Patients are often reluctant to undergo earlier examination [4].

However, conventional colonoscopy is not feasible as a population screening

test since endoscopists are not of sufficient number to accommodate the entire populations of patients. A minimally invasive, safe, and low-cost method to

evaluate the colon for pre-malignant polyps and early, curable colon cancer

would be preferred by most patients.

Recently, Computed Tomography Colonography (CT Colonography) h^s been developed as an alternative method to evaluate the entire colon for polyps [5]
which leads to an easier, more comfortable examination than other screening
tests.

CTColonography is a diagnose procedure of colon cancer that uses CT images of

patient's abdomen. Radiologists examine the colon through the CT data set and
the surfaces of colon are constructed using advanced computer graphic

technologies to detect polyps from CT images. The first CT colonoscopy system reported in the medical imaging literature was in the year 2000.

CT Colonography provides a safe, minimal-invasive approach to detect colonic
polyps using medical imaging and computer graphics technologies with 3D

software to create virtual

endoscopic

images

of the

colonic surface.

CT

Colonography has been advocated as a technique for providing mass screening

for colorectal carcinoma. It has emerged as a promising alternative procedure, with potentially lower complication rate, improved patient comfort and patient
acceptance.

Currently, however, CT Colonography is still impractical, mostly due to the
following restrictions:

1. There are limitations in the accuracy and robustness of current computer
aided detection (CAD) techniques for polyp detection, thereby reducing the

efficiency of radiologists in detecting polyps. There has been considerable
variation in the reported accuracy of CT Colonography. Several studies have

reported sensitivities of greater than 90% for detection of lesions sized 10
mm or more, [6-9] but other studies reported lower data ranging from 61% to 78%. [10-13] The largest recent single-center study reported poor results and considerable variation between readers, with sensitivities of 32%, 34%, and 72%. ([14] Most recently, Cotton et al. have reported that the

sensitivity of CT Colonography for finding participants with 1 or more lesions

sized at least 6 mm was 39.0% and for lesions sized at least 10 mm it was 55.0%. These results were significantly lower than those for conventional
colonoscopy, with sensitivities of 99.0% and 100%, respectively [15].

2.

Current CT Colonography techniques are time consuming. A typical CT Colonography examination produces 150-350 axial CT images each for the
j

supine

and

prone

imaging

data

sets,

yielding

a

total

of

300-700

images/patient. Despite the recent advances in image display technologies, studies show that the case interpretation time is still between 15 - 40 min

even when reading is done by experts in abdominal imaging, [16][17].

3.

The interpretation time for an entire CT Colonography examination should be reduced substantially before CT Colonography can be successfully

translated from the research arena to routine clinical practice.

1.3 Cancer Relevance

Accordingly, it has been suggested that CT Colonography can not be used as the

sole diagnostic tool in the detection of early colorectal carcinoma until the low
accuracy of polyp detection and procedure time are improved.

This

research

project aims to

improve

upon the current

methods of CT

Colonography in accuracy, speed and early polyp detection, which are the most common precursor of colorectal carcinoma. A computer assisted diagnosis (CAD)

system that improves the current system has been investigated and developed
with special emphasis on increasing the accuracy of polyp detection that leads

to more chances of cancer cure. In addition, our system reduces X-ray radiation and provides a computed cleansing procedure that may eliminate the need for physical bowel preparation. Supine positioned CT scans of patient abdomen is

used in our approach that improves the current method using both supine and
prone positioned CT scans. Therefore the X-ray radiation exposure to patients reduced by 50%.

As in Conventional Colonoscopy, it is essential that during CT Colonography all colonic mucosal surfaces must be adequately visualized and examined. This

includes

potential "blind

spots" situated

behind

prominent mucosal

folds,

especially within redundant, tortuous segments of colon. The colonic wall must be viewed circumferentially.

A unique viewing system is under development in this research. This new

system provides a way for more complete examination of the colonic wall,
including the "blind areas".

Through the collaborative efforts of clinical radiologists and computer graphic scientists, the individual techniques that are under development are integrated into a cohesive and complete methodology that specifically addresses and provides solutions to the current limitations of CT Colonography as documented

in the medical literature and achieves a faster, patient-friendly procedure, with
improved accuracy, and internal quality assurance.

The techniques developed in this research will achieve these improvements
j

by accomplishing the following goals:

1.3.1 Active Contour Modeling and Gray Scale Analysis

The post-processing technique will employ minima detection, Active Contour

Modeling techniques to perform colon segmentation, which will improve the

robustness of the segmentation method for abstracting colon from the raw CT
data.

After the colon has been segmented, the gray scale information will be analyzed to enhance the detection of polyps. This will improve upon the accuracy

achieved by previous methods that rely solely upon surface shape information.
We will analyze very detailed gray scale information as well as the colon surface
curvature information.

1.3.2 Reduction of Radiation Exposure

The CT Colonography procedure will be performed with the patient in a supine
position only (as opposed both supine and prone positioning that is commonly

used at the present). This approach will reduce radiation exposure to each
patient by 50%.

1.3.3 Navigation System

This new system, which is constructed from 3 combined components, provides for more complete examination of the colonic wall, including the "blind areas" that are obscured during the colonic fly-through portion (in another word,
screening portion) of the CT Colongraphy exam.

2. Background

Studies on the diagnostic accuracy of CT Colonography currently remains
inconclusive, with several studies citing perceptual errors and observer

experience

limiting

overall

accuracy. Although

clinically significant colonic

polyps are resolvable, given the spatial resolution of helical, multi-detector

computed tomography (CT), the accuracy and efficiency of viewing hundreds of axial images per exam are limited by human factors, such as attention span and
eye fatigue.

In response to this challenge, a variety of computer-aided diagnosis (CAD)
methods have been developed to improve both the accuracy and the efficiency of lesion detection in CT Colonography, as well as other diagnostic imaging

examinations
imaging.

which

require

solutions

to

difficulties

in

three

dimensional

Several different techniques and approaches to CAD for CT polyp detection have
been developed:

Vining et al [18] developed a method that measures abnormal wall thicknesses

using heuristics.

Other approaches have analyzed the morphology of the

mucosal surface. Summer et al [19, 20] have developed a method that uses size,

attenuation,

and

curvatures

calculated

with

convolution-based

partial

derivatives to find polyps. A software application [21, 22] is used with "filter 7" function to detect polyps. A reduction of the number of false-positive was
achievable by sampling the CT numbers of each voxel within a possible polyps
along a ray directed through the polyp.

Yoshida et al [16, 17] used shape index and curvedne$s (computed with partial
derivatives), directional gradient concentration, and quadratic discriminant analysis using both prone and supine datasets. Kiss et al [23] combined surface normal and sphere fitting methods. In addition, secondary CAD algorithms that

are designed to reduce the false-positive rate of primary CAD algorithms have
been proposed. Gokturk et al [24] applied support vector machines to shape and attenuation features to reduce false-positive's and reported a 50%Increase in specificity at a sensitivity level. Acar et al [25] have applied edge

displacement fields to reduce false-positives and reported a 23% increase in
specificity at a constant sensitivity level.

Paik et al [26] employed surface normal overlap method which uses a statistic model of anatomic shapes to simulate CT data to achieve polyp detection. This

methodology is able to distinguish between polyps and background anatomy
such as haustral folds.

These previously described CAD algorithms have achieved varying^ levels of
accuracy although they all leave room for improvement.

2.1 Patient-Oriented Issues

Despite initial enthusiasm for CT Colonography, a wide range of accuracy of the
technique has been reported in clinical trials. While Cotton et al suggest that the experience and training of the Radiologist reading the CT Colonography may be a significant factor, but it is not yet proven [27]. There are, however, a variety

of patient-related and technical limitations that can reduce accuracy, including
poor bowel preparation as well as anatomically-related problems, such as flat

colonic lesions, mobility of the colon, and blind-areas behind mucosal folds.

Some publications reported on computed cleansing methods to assist colon
segmentation. Chen et al. employed a principle component analysis on local intensity vector [28]. Artifacts are presented at locations where gas, colon wall, and contrast enhanced fluid are connected. Polyps of 5mm in diameter, if

located at these junctions could potentially be missed.

Lakare et al [29] described a cleansing method using segmentation rays. Their method requires the user to carefully study and select intersection

characteristics and assign classification and reconstruction tasks to the ray. The
junctions of three materials are not modeled. In other words, most current segmentation methods can not handle a less strict colon preparation scheme.

Serlie et al [30] proposed a cleansing method using histogram information in the image data. Over-segmentation could occur when the image data set has

poor contrast. An accurate, robust and efficient method would improve the
system.

2.2 Viewing System for Blind Spots

As stated above, one of the key goals of this research project is to investigate a

robust method for earlier and more accurate polyp detection. As in Conventional Colonoscopy, it is essential that during CT Colonography all cjolonic mucosal
surfaces must be adequately visualized and examined. This includes potential

"blind

spots" situated

behind

prominent

mucosal

folds,

especially within

redundant, tortuous segments of colon. The colonic wall must be viewed
circumferentially.

Several investigators have addressed the issue of "unviewed regions" in CT
Colonography [31 - 34]. Most recently, Hiyashi et al described a technique to

detect undisplayed regions during fly-through and to perform quantitative

evaluation [35]. In this process, the undisplayed regions are detected by
marking displayed triangles for surface rendering or displayed voxels for volume rendering. The voxels or triangles not having displayed marks are
considered to be undisplayed triangles or voxels.

10

Despite the problems created by blind areas, Cotton et al reported that the
incorporation of the fly-through data with the initial axial CT evaluation

increased the sensitivity of CT Coionography for the primary outcome (detection of participants with lesions <6 mm) by 17% to 56% but reduced specificity by 5%. For participants with lesions sized at least 10 mm, the fly-through data

increased the sensitivity by 12% to 67% and decreased the specificity by 1% [27]. Thus, any methodology that helps ensure that all mucosal surfaces are adequately visualized and examined, including the blind areas, potentially, could simultaneously improve detection rate, as well as to serve as an internal quality assurance measure of the technique itself.

We are developing a software solution to the problem of "blind areas" or "unvjewed techniques regions" and in CT Coionography, including incorporating Virtual three connected Mucosal

methodologies

Colonoscope

Coloration, and the Navigation System.

n

3. Methods

3.1 Colon Lumen Detection

A gray scale minima detection using mathematical morphology [39] was applied
to detect the colon lumen from the CT images of abdomen. This approach generates markers on every colon piece within the image and produces initial

curves of active contour model for colon wall segmentation.

Mathematical morphology is a broad set of image processing operations that
process images based on shapes. Morphological operations apply a structuring

element to an input image, creating an output image of the same size. In a
morphological operation, the value of each pixel in the output image is

generated based on a comparison of the corresponding pixel in the input image

with its neighbors. By choosing the size and shape of the neighborhood, one can
construct a morphological operation that is sensitive to specific shapes in the
input image.

A structuring element is a matrix consisting of O's and l's that can have any arbitrary shape and size. Structuring elements are typically much smaller than

the image being processed. The center pixel of the structuring element, called the origin, identifies the pixel of interest, or the pixel being processed. When a

12

morphological operation is carried out, the origin of the structuring element is
typically translated to each pixel position in the image, and then the points within the translated structuring element are compared with the underlying

image pixel values. The details of the comparison and the effect of the outcome
depend on which morphological operator is being used. By combining dilation

and erosion operators one can obtain algorithms for many image processing tasks, such as feature detection, image segmentation, image sharpening, and
image filtering, etc.

3.1.1 Dilation

Dilation of a binary image A by a structuring element B is defined by,

A © B = {c | c = a + b for some a e A and b e B}
For each background pixel the structuring element is superimposed on top of

the input image so that the origin of the structuring element coincides with the

input pi^el position. If at least one pixel in the structuring element coincides with
a foreground pixel in the image underneath, then the input pixel is set to the foreground value. If all ^he corresponding pixels in the image are background, however, the input pixel is left at the background value.

13

1
1

1

1
1

CD
1

1

1

Figure 1: Dilation by a 3 x 3 structuring element

3.1.2 Erosion

Let A denote a binary input image and B denote a structuring element, then the
erosion of A by B is given by,

A e B = {x I x + b e A for every b e B}
Erosion is similar to dilation in that if for every pixel in the structuring element,
the corresponding pixel in the image underneath is a foreground pixel, then the
input pixel is left as it is. If any of the corresponding pixels in the image are background, however, the input pixel is also set to background value.

1
1
1

1

1
1

1

1

Figure 2: Erosion by a 3 x 3 structuring element

14

3.1.3 Opening

Opening of A by B is obtained by the erosion of A by B, followed by dilation of the
resulting structure by B,

= (AQB)®B

While erosion can be used to eliminate small clumps of undesirable foreground
pixejs quite effectively, it has the big disadvantage that it will affect all regions

of foreground pixels indiscriminately. Opening gets around this by performing
both erosion and a dilation on the image.

1
1 1

1

1

1

1

1
1

1
1

1
1
1

1
1

1

1

Figure 3: Opening by a 7 x 7 circular structuring element

3.1.4 Closing

Closing of A by B is obtained by the dilation of A by B, followed by erosion of the resulting structure by B,

AmB = (A®B)QB
15

PROPERTY 0F

One of the uses of dilation is to fill in small background color holes in images. One of the problems with doing this, however, is that the dilation wpl also distort
all regions of pixels indiscriminately. By performing erosion on the image after
the dilation, i.e. a closing, it reduces some of this effect.

1

1

1 1

1 1

CD
1

1

Figure 4: Closing by a 3 x 3 structuring element

In this research, an opening operation is performed with a structuring element
size of 5 to reduce the noise level of the dataset.

3.2 Colon Wall Detection

After the lumen has been detected, the initial curves required by active contour model are established. The colon wall is segmented using active contour
segmentation techniques with the initial curves in the previous step.

Active

contour

models,

also

called

deformable

models,

provide

a

robust

foundation for the representation, simulation, and manipulation of complex

16

non-rigid anatomical structures [39]. The potency of deformable models stems
segmentation of anatomic structures by exploiting constraints derived from the image data together with a priori knowledge about the location, size, and shape of these structures. In recent years, deformable models based image

segmentation has seen emergence of two competing approaches - Snakes and
Level sets.

Snakes [40] can be viewed as Lagrangian geometric formulations wherein the
boundary of the model represented in a parametric form. The minimizing

energy along a curve embedded roughly around the object of interest is derived. The deformation energy function is minimized with 'internal' and 'external'
energies along its boundary. The geometric information is considered as an

internal energy and image gradients as an external energy. The models act like

elastic bodies that stabilizes at the deformation energy function is minimized.
The drawback of these approaches is a good initialization step is required, later improvement of the model can adopt topological changes. [41] The other type of active contour models using Eulerian framework called level set methods.

Level set methods [42, 43] provide a mathematical formulation for tracking the motion of curve including optimal path planning which can be recasted as front
propagation problems. The evolving constraints for propagation of interface can be defined in problem domain by exploiting constraints derived from the image

17

data together with a priori knowledge about the location, size, and shape of

these structures. The advantages of this approach include the ability to evolve
the model in the presence of sharp corners, cusps and changes in topology.

Level set method for image segmentation has been extensively evaluated over
the last few years. Level set model uses a function that depends on the image

gradient, as an edge detector to stop the curve evolution [43, 44]. The model

can only detect objects defined by gradient. This type of segmentation by using
only local information has been often frustrated by poor-contracted regions due
to occluding and occluded objects and often enhanced by their use of prior

shape information. Geometric shape models provide extrinsic information about an object and can be incorporated explicitly especially for medical image
segmentations where prior shape information can be collected. Human beings

view an object's appearance in an image by both its shape and by the view of

the object. Shape is a powerful property for distinguishing an object from its
surroundings in an image and should be used to complete the information
provided by local properties of the image.

A model using level set and shape prior has been developed to detect objects
occluded in an image [37, 38, 45]. Texture information applied to level set [46]

has also been reported with good results and should be explored for polyp
detection.

18

The general idea behind the level-set method is to apply a function <p(pj) to
the space the interface inhabits, where p is a point in the space, and ta point in

time. The function is initialized at t = 0, and then a scheme is used to approximate the value of <p(p,t) over small time increments.

The first step in applying the level-set method is to pick a mesh, or a grid of
points that covers the image. In general, the finer the mesh, the more accurate the level-set method is. Once a mesh is chosen, the next step is to initialize the value of 0(p,t) at each point of the mesh. For any point p in the mesh, which in the CT data is a pixel in the image, the function 0 is defined as follows,

Where d is the distance from the point p to the curve at the time t = 0. The

positive sjgn is used if the point p is outside the closed curve, while negative if the point p is inside. Thus the name of the level-set method is explained: at any
time fQf th§ evolving curve corresponds to the locus of all points p such that

r\P>to' =

' anc' that 'ocus 'sa 'eve' curve of the (j) function. The locus of all

points p such that r\P>t(y = c ' contour around the original curve, where c is
an arbitrary positive or negative constant.

Clearly, as the curve evolves in time, the value of the function <f> at each mesh

point evolves too. The rest of the level-set method consists of updating the

19

value of function 0 at each point using a good scheme over small increments of

time.

To illustrate the concept in another way, the level set approach takesthe original

curve, the black one on the left below, and builds it into a surface. That
cone-shaped surface, which is shown on the right below, has a great property; it intersects with the xy plane exactly where the curve sits. The surface on the right below is called the level set function, because it accepts any point as input

in the plane and hands back its height as output. The black front is called the
zero level set, because it is the collection of all points that are at height zero.

Figure 5: Level-set method

Imagine a saw that can cut a perfectly leveled slice of the surface and then drop
it onto the xy plane.

20

·

If the saw cuts the level set surface at height zero above the xy plane, the
ring that will drop to the xy plane will be the original black front.

·

If the saw cuts at some other height, a different ring will drop down, producing one of the grey curves instead.

The idea is that instead of moving the red front, one might try and instead move
the surface on the right. In other words, the level set function expands, rises, falls, and does all the work. To find out where the front is, get out the saw and

cut the surface at zero height.

The initial position of the interface gives initial data for a time-dependent problem. In other words, the solution starts at a given position and evolves in
time.

The level-set method takes the problem of a moving curve and trades it in for a moving surface. The reason why this is a good idea lies in that the red front at the surface on the right side can get wildly contorted, but the blue level set
function is well-behaved. All the complicated problems of breaking and merging

are easily handled. Better yet, everything works for three dimensional surfaces with no change.

In this research, level-set method is applied for colon wall detection after
minima detection. Each level set is defined using signed distance transform on

the boundaries resulting from the minima detection. The following image shows

21

a segmentation result on one image slice using minima detection and level set

method.

Figure 6: Initial curves segmented using active contour model

3.3 Polyp Detection

3.3.1 Curve Detection

Identifying colonic polyps using CAD is very challenging because polyps occur in various sizes and shapes, and because of thickened folds and retained stools

may mimic their shape and density.

In this research, curvature detection is achieved by using a computer-graphics based light-weighted detection mechanism that not only speeds up the overall detection process, but also suits the manual navigation system.

A digital image, or a raster graphics, is a data structure representing a generally rectangular grid of pixels viewable via a computer monitor, paper, or other

22

displaying medium. Images viewed on computer screens are dimensioned in pixels, screens are dimensioned in pixels, and video systems show pixels directly. This implies that, the angle between two adjacent pixels in a digital image can only be either 45, or 90, or 180 degrees. There are no other possible
values in between.

Figure 7: Angles in raster graphics

Based on this fact, the task of polyps-detection is mainly to pinpoint the sharp
turning points that could possibly lead to polyp candidates. The whole process is illustrated as follows.

First of all, mark all the pixels where direction changes happen. This means, for any two pixels in the segmented colon wall, draw a straight line between them.
If the line makes a perfect horizontal, vertical or 45 degree diagonal, the pixels

in between will not cause the curve to change direction, and will be discarded.
The following example illustrates a result of this step. The white dots represent

the pivots where direction changes occur around them.

23

Figure 8: Directional changes

Next, remove continuous marks, but keep the first one only for next cycle of
processing.

Figure 9: Simplified directional changes

In this step, keep the pixels that sharp turns happen around them. This is done

by selecting three highlighted pixels, and calculating the angle of the two line
segments between them. A threshold is applied to determine what kind of angle

qualifies a sharp turn. In this study, 40 degree is selected as the threshold, any

24

thing bigger than that will be considered a sharp turn.

Figure 10: Sharp turns

Further more, left-turn and right-turn marks are identified. An iteration process will go through all the marks in turns to access whether it serves as a central
point for a left or right turn among three consecutive marks. In the following example, the white dots represent left-turn marks, while the dark gray ones

characterize right-turn ones.

Figure 11: [left-turn, right-turn] pairs

25

The last step is to enumerate all possible [left-turn, right-turn] pairs to identify
potential polyp candidates. If the number of pixels in the curve within the
[left-turn, right-turn] range is greater than twice the distance between them,

the curve segment in candidate.

[left-turn,

right-turn]

will

be

regarded

as a

polyp

Figure 12: A polyp candidate

Figure 13: Result of polyp detection

3.3.2 Flat polyp Detection using Texture Analysis

After the segmentation step, the surface of the colon can be detected and the

26

gray scale information inside the colon can be abstracted and analyzed. For example, the textures for different features that reside in the colon can be classified; stool or polyps can be distinguished with good accuracy. This will improve the detection rate compared with methods that only use surface shape information to characterize the polyps. The textures between polyps and stool are different in nature. Polyps appear in grayscale with more homogeneity,
while the grayscale of stool varies in large scales.

A morphological operation called directional dilation can be utilized to dilate the
object on the positive norm direction of the curve that represents the colon wall.

The dilated region can then be used as the mask of the colon wall. Texture analysis will be applied on this thick region for search polyp candidates. This
step helps us to analyze the texture information around the polyp candidates

and allows us to detect the abnormality appearance of the polyp candidate not only by its shape, but also by its texture information. Adding texture analysis is more effective for detecting the flat polyps, which can only be achieved by looking at the abnormality of texture information on the detected thick region.
To date, there is no literature that addresses the flat polyp detection. Texture

analysis alsft helps distinguishing stools from polyps inside colon walls. Polyps
usually appear in grayscale with more homogeneity, while the grayscale of

stools varies in large scales.

27

The result from direct dilation is a thick ring around the colon wall. The thick ring is made semi-transparent, and the original CT image is placed underneath. By

doing so, it's easy to examine the area within the ring for abnormality, such as
particularly dark texture as the normal appearance of flat polyps.

Figure 14: Texture analysis

3.4. An Innovative Viewing System

Development of the 3-Component Viewing System is an essential part of our strategies to increase the overall accuracy of CT Colonography. A solution is provided in which the 3 major components of this viewing system work as a

single

tool

to

reduce

the

false-negative

rate

by

ensuring

the

complete

examination of the colonic mucosa, including the "blind areas" during the

colonic fly-through of CT Colonography. These components consist of:

3.4.1 Mucosal Coloration

28

Mucosal Coloration is a technique that provides a simple, automated process that converts the color of unviewed colonic mucosa from one shade or hue to another, as the mucosa is adequately observed.

To ensure adequate observation, in this study, as a portion of colonic mucosa is viewed, at a specified distance and angle of view (DAV), it would be transformed into a different shade or color (e.g. from yellow-tinted to pink). Thus, any

portion of the colonic mucosa that was not viewed in the required field of view would remain yellow-tinted. The optimum DAV would then be investigated as an

integral part of this study.

3.4.2 Front-and-Side-Viewing Colonoscope

False positive or false negative results, i.e. misidentification or failure to detect
polyps could occur. The 3-component viewing system built into this project

provides a means of guaranteeing that all surfaces of the colonic wall are
adequately examined, thus serving as an internal quality assurance mechanism

to reduce the incidence of false negative results.

There

are

two

types
scopes

of
and

endoscopes
side-viewing

used

by

gastroenterologists:
Virtual Colonoscopic

forward-viewing

scopes.

Fly-Through is generally displayed as if it is seen through a forward-viewing endoscope. The "virtual colonoscope" described here is capable of both

29

"front-viewing" for most of the fly-through, as well as "side-viewing" for looking
around mucosal folds, at "blind areas". The front-view or side-view option is

selected by the observer during the course of the examination, as needed.

3.4.3 Navigation System

Virtual navigation system, a computerized medical procedure for examining

tubular organs, has been increasingly considered as an alternative method for medical diagnosis and treatment. A virtual fly-through inside the tubular human organs is less invasive, safe and cost effective for medical examination and
surgical planning. The virtual exploration through patient-specific data assists

immensely radiologists to perform a diagnosis without physical operations on the patient. Surgical diagnosis and planning can also be done with reduced patient discomfort.

When harnessing the virtual colonoscopy system as a tool for detecting colon

polyps, it is a common practice to engage with automated fly-through based on the paths generated automatically. In the case of automated fly-through inside the colon, some "blind spots" will occur at backs of folds and can be missed out
by the virtual camera.

In this research, we propose a virtual colonoscopy navigation system based on

human-computer interaction. The method identifies the path of the virtual

30

cameras for a fly-through within the segmented colon, which is carried out by
means of level-set method above-mentioned. Two virtual cameras are deployed in the navigation system, a front-view camera, and a side view one. The

front-view camera path is selected as the geometric center of the colon walls. It flies through the 3D colon model.

Figure 15: Front-view camera path

In order to address the "blind spots" issue, a side-view camera is added to the
navigation system. The side-view virtual camera sits at the same location as the front-view one, and is always perpendicular to the fly-through direction. It can be rotated side way in order to scan the surrounding regions.

Both cameras are controlled by human viewers, using Up and Down arrow keys to control the fly-through of the front-view camera, and Left and Right arrow keys to rotate the side-view camera around the fly-through direction.

As the virtual cameras fly through the model, the navigation system keeps track of the position of the virtual cameras inside the model, displays the front-view

31

on one window, and side-view on another. The advantage of virtual exploration is that the surgeon can noninvasively perform a diagnosis and mark the position
of potential polyps for surgical planning.

Because the movements of cameras are controlled by user inputs, expensive
processing of finding optimum fly-through path can be alleviated, and the
navigation system is computationally efficient to deal with large and

complicated 3D Colon data.

The experimental

results showed

that about 20% of colon

regions were

classified as unobserved region in every fly-through exploration.

32

4. Experimental Results

A software system is designed and developed using Microsoft Visual C++, along
with Amira and VTK. Amira is a powerful, multifaceted software platform for visualizing, manipulating, and understanding life science and bio-medical data. And Visualization Toolkit (VTK) is an open source, freely available software
system for 3D computer graphics, image processing, and visualization.

4.1 Architecture
The flowchart blow demonstrates the architecture of the system, and outlines
the major steps involved in the whole process.

CT Colon

Images

Opening

Polyps

Smooth

Detection

Surface

IsoSurface
Construction

/±j

Smooth

nFI

Segmented

Images

3D Colon

Fly-Through Examination

Colon

Model

Coloration

Figure 16: Software system architecture

33

The input data (CT Colon Images) first goes through morphological opening smooth, then is segmented by level-set method, and later undergoes

polyp-detection procedure. The output is segmented colon data.

The segmented CT images then are built in to an IsoSurface, a 3D model ready
for fly-through examination. Then smoothing is applied to remove small rugged regions for better viewing experience.

The 3D colon model is then loaded into an application written inf VTK for
fly-through examination and colon coloration.

4.2 Test Results
We have collected 10 CT data sets of patient abdomen. The segmentation

results and surface generation are demonstrated in the figures follow:

The two figures below show a typical CT image(s) as input data.

Figure 17: (a) A typical colon image, (b) A stack of CT colon images

34

The following figure displays the segmentation result of a CT image using level set method.

Figure 18: Segmentation result using level-set method

Overlapping the segmented image with the original CT image creates a new image as shown below. It is safe to say that the segmentation result is accurate.

Figure 19: Segmented result overlapped with the original image

The segmented CT images are then loaded into Amira, and an IsoSurface is then constructed. In addition, the surface goes through a smoothing process to

35

remove small rugged regions. The surface construction result is a 3D colon
model ready for fly-through examination.

Figure 20: 3D colon Image

The following image represents an inside view of the 3D colon model.

36

Figure 21: Inside-view of a 3D colon model

The 3D colon model is then loaded into an application written by VTK for fly-through examination, which is done by manually controlling the position and
orientation of the front-view and side-view cameras. The image below gives an

impression of what a coloration result looks like.

Fly-Through View

Figure 22: Mucosal coloration during fly through, viewed regions shown in light color, while unviewed dark

37

The coloration is a real time process, and is done as the cameras move back and forth or sideway. It is a rather computational expensive operation. In order to speed up the fly-through process, the 3D colon model is scalded down first to

decrease the number of triangles there are in the IsoSurface. This results in a loss of image quality but immensely increases the coloration process and
augments the smoothness of fly-through examination.

By setting up the viewing distance of the front-view camera, the unviewed
region remains in its original color, blue in this example. The viewed one,

instead, is transformed to a different color, green in this case. In this way, the

unviewed region in the far distance will be highlighted. The "blind spots", which are not visualized by the cameras remain in blue, their original color as well.

38

5. Summary

5.1 Conclusion
This research proposal provides a comprehensive computer-processing

methodology for the CAD component of CT Colonography. The system under

development has been designed to find solutions to specific clinical problems,
through the application of computer graphic technology. The individual

techniques that are under development are integrated into a cohesive and complete methodology that specifically addresses, and provides solutions to, the limitations of CT Colonography as documented in the medical literature.

The overall

performance of the segmentation

method

is satisfactory. The

segmentation methodology described here also provides solutions to other

clinical problems. Our system improves the existing systems by searching more detailed information to classify polyps, provide a 100% surface coverage

viewing utility, and improved the accuracy of the polyp detection.

5.2 Future Work
Polyp detection needs to be enhanced to detect polyps smaller in size (less than 3 mm). More polyp samples need to be collected. Computation speed can also be improved.

39

In order to overcome the "blind-spot" issue, the current control method for
fly-through was purposely designed as a manual control system. Which means, views are in total control of both front-view and side-view cameras. It is

convenient in a way that human viewers have great latitude of manipulating the
positions and orientations, and the fly-through velocity of the cameras. However, a semi-automatic control system should provide a richer experience in

fly-through examination.

In addition, an innovative idea of flat-side-view has been raised in the course of

the

project development. The approach

is to capture the colonic surface

surrounding the side-view camera and flatten it to a 2D image. In this way, it makes possible to examine the folded colon regions without even having to rotate the side-way camera.

40

References

[1] R. T. Greenlee, T Murray, S Bolden, P. A. Wingo, "Cancer statistics", Ca
Cancer J Clin, vol50, pp7-33, 2000

[2] L. Li, D. Chen, S. Lakare, K. Kreeger, I. Bitter, A. Kaufman, M. Wax, P. Djuric,

and Z. Liang (2002), "An image segmentation approach to extract colon lumen through colonic material tagging and hidden Markov random field model for
virtual colonoscopy," SPIE Medical Imaging, 4683: 406-411, 2002.

[3] Hayashi Y, Mori K, Hasegawa J, Suenaga Y. Toriwaki J. "A method for
detecting undisplayed regions in virtual colonoscopy and its application to

quantitative

evaluation

of

fly-through

methods".

Academic

Radiology

10:1380-1391. December 2003.

[4] P. Orsoni, S Berdah, C Verrier etal "colonic perforation due to colonoscopy:
a retrospective study of 48 cases," Endoscopy, Vol. 29, pp 160-164, 1997

[5]

L

Hong,

A

Kaufman,

Y.-C Wei,

etal, "3D virtual

colonoscopy",

Proc.

Biomedical visualization, Altlanta, GA, pp 26-33, 1995

[6]

Macari

M,

Bini

EJ,

Xue

X,

et

al.

Colorectal

neoplasms:

prospective

comparison of thin-section lowdose multi-detector row CT colonography and
conventional colonoscopy for detection. Radiology. 2002; 224:383-392.

[7]

Fenlon HM, Nunes DP, Schroy PC, et al. A comparison of virtual and

conventional colonoscopy for the detection of colorectal polyps. N Engl J Med.
1999; 341:1496-1503.

41

[8] Yee J, Akerkar GA, Hung RK, et al. Coiorectai neoplasia:

performance

characteristics of CT coionography for detection in 300 patients. Radiology.
2001; 219:685-692.

[9] Laghi A, Iannaccone R, Carb one I, et al. Detection of coiorectai lesions with
virtual computed tomography coionography. Am J Surg. 2002; 183:124-131.

[10] Yee J, Akerkar GA, Hung RK, et al. Coiorectai neoplasia: performance
characteristics of CT coionography for detection in 300 patients. Radiology.
2001; 219:685-692.

[11] Laghi A, Iannaccone R, Carb one I, et al. Detection of coiorectai lesions with
virtual computed tomography coionography. Am J Surg. 2002;183:124-131.

[12] Fletcher JG, Johnson CD, Welch TJ, et al. Optimization of CT coionography

technique: prospective trial in 1980 patients. Radiology. 2000;216:704-7il.

[13] Pineau BC, Paskett ED, Chen J, et al. Virtual colonoscopy using oral
contrast compared to colonoscopy for the detection of patients with coiorectai polyps. Gastroenterology. 2003; 125:304-310.

[14] Mendelson RM, Foster NM, Edwards JT, et al. Virtual colonoscopy compared with conventional colonoscopy: a developing technology. Med J Aust. 2000;
173:472-475.

[15] Spinzi G, Belloni G, Martegani A, et al. Computed tomographic colonoscopy
and conventional colonoscopy for colon diseases: a prospective, blinded study.
Am J Gastroenterol. 2001;96:394-400.

[16] H Yoshiba and J Nappi, 'Three dimensional computer-aided diagnosis

42

scheme for detection of colonic polyps", IEEE trans on medical imaging, vol.20,
no 12, December 2001.

[17]

H

Yoshiba, Y Masutani,

P

MacEneaney,

D T Rubin, A

H

Dachman,

Computerized detection of polyps at CT Coionography on the basis of volumetric
features: Pilot Study, Radiology, vol. 2222, 2002,pp 327-336.

[18] Vining D J, Ge Y, Ahn D K, and Stelts D R, "Virtual colonoscopy with
computer assisted polyp detection Computer-Aided Diagnosis in medical

imaging K Doi H MacMahon, M L Giger and K R Hoffman Eds. Amsterdam. The
Netherlands: Elsevier Science B. V. 1999, pp 445 - 452

[19] Summers R M, Beauliu C F, Pusanik L M, Malley J D, Jeffery Jr. R B, Glazer D I, and Napel S, "Automated polyp detector for CT coionography: Feasibility
study", Radiology, vol. 216, pp 284-290, 2000

[20] Summers R M, Johnson C D, Pusanik L M, Malley J D, Youssef A M, and Reed
J E, " Automated polyp detection at CT coionography, Feasibility assessment in a human population," Radiology, vol 219, pp 51-59, 2001

[21] Summers R M, Selbie WS, Malley JD et al. Polypoid lesions of airways:

earlier

experience

with

computer

assisted

detection

by

using

virtual

bronchoscopy and surface curvature. Radiology 1998, vol 208, pp331-337

[22]

Summers

R

M,

Pusanik

L

M,

Malley

JD,

Automatic

detection

of

endobronchiai lesions with virtual bronchoscopy: comparison of two methods, Medical Imaging 1998: image processing San Diego, Calif: SPIE, Society of
Photo-Optical Instrumentation Engineers, 1998, pp 327-335.

[23] G Kiss, J V Cleynenbreugel, M Thomeer, P Suetens, and G Marchal,

43

"Computer-aided diagnosis in virtual coionography via combination of surface normal and
2002.

sphere fitting

methods'',

European

Radiology, vol.l2,pp77-81,

[24] S B Gokturk, C Tomasi, B Acar, C F Beaulieu, D S Paik, R B Jeffrey Jr, J Yee, and S Napel, "A startical 3D pattern processing method for computer-assisted detection of polyps in CT coionography", IEEE trans on medical imaging, vol 20,
ppl251-1260, dec. 2001.

[25] B Acar, C F Beaulieu, S B Gokturk, C Tomasi, D S Paik, R B Jeffrey Jr, J Yee, and S Napel, "Egde displacement field-based classification for improved

detection of polyps in CT coionography", IEEE trans on medical imaging, vol 21,
ppl461-1467, dec. 2002.

[26] D S Paik, C F Beaulieu, G D Rubin, B Acar, R B Jeffrey Jr, J Yee, J Dey and
S Napel, "Surface normail overlap/; A computer-aided detection algorithm with application to colonic polyps and lung nodules in helical CT", IEEE trans on
medical imaging, vol 23, pp661-675, June. 2004.

[27] Cotton PB. Durkalski VL. Pineau BC. Palesch YY. Mauldin PD. Hoffman B.
Vining DJ. Small WC. Affronti J. Rex D. Kopecky KK. Ackerman S. Burdick JS.
Brewington C. Turner MA. Zfass A. Wright AR. Iyer RB. Lynch P. Sivak MV. Butler

H. Computed Tomographic Coionography (Virtual Colonoscopy): A Multicenter Comparison With Standard Colonoscopy for Detection of Colorectal Neoplasia.
JAMA. 2004; 291:1713-1719

[28] D Chen, Z Liang, M Wax, L Li, B Li,

and A Kaufman, " A novel approach to
IEEE transaction

extract colon lumen from CT images for Virtual Colonoscopy",

on medical imaging, vol. 19, No. 12, pp 1220-1226, December 2000

44

[29]

S

Lakare,

M Wan,

M

Sato, A Kaufman, "3D digital

cleansing

using

segmentation

Rays",

IEEE

Visualization

2000

conference

Proceddings,

ACM/SIGGRAPH, Press, pp. 37-44, October 2000

[30] Serlie I, Truyen R, Florie J, Post F, van Vliet L, and Vos F, " Computed cleansing for virtual coionoscopy using a Three-material transition model", MICCAI 2003, R E Ellis and T M Peters Eds. Springer-Verlag Berlin Heidelberg,
LNCS 2879, pp 175-183.

[31] Mori K, Hayashi Y, Suenaga Y, Toriwaki J, Hasegawa J, Katada K. A method for detecting unobserved regions in virtual endoscopy system. Proceedings of
Society of Photo-Optical Instrumentation Engineers, San Diego, CA.

4321:Bellingham, WA: SPIE 2001:134-145February 18-20, 2001

[32]

Kreeger K,

Dachille F, Wax MR,

Kaufman AE.

Covering all clinically

significant areas of the colon surface in virtual coionoscopy. Proceedings of
Society of Photo-Optical Instrumentation Engineers, San Diego, CA.

4683:Bellingham, WA: SPIE 2002:198-206February 24-26, 2002

[33] Hayashi Y, Mori K, Hasegawa J, Suenaga Y, Toriwaki J. A method for
detecting undisplayed regions in virtual coionoscopy and its application to

quantitative evaluation of fly-through methods. Proceedings of Medical Image
Computing and Computer-Assisted Intervention. Tokyo, Japan: Springer

2002:631-638Lecture Notes in Computer Science

[34] Y, Mori K, Hasegawa J, Suenaga^f, Toriwaki J. Quantitative evaluation of observation methods in virtual coionoscopy based on the rate of undisplayed
region. Proceedings of Society of Photo-Optical Instrumentation Engineers, San Diego, CA. 5Q31:Bellingham, WA: SPIE 2003:69-78February 16-18, 2003

45

[35] Hayashi Y, Mori K, Hasegawa J, Suenaga Y. Toriwaki J.Q A method for detecting undisplayed regions in virtual colonoscopy and its application to
quantitative evaluation of fly-through methods. Academic Radiology

10:1380-1391. December 2003.

[36] Y Jiang, "On incorperating global constraints for
pp 443-451, IASTED Biomechnic conference 2004

bone fracture detection".,

[37] Y Jiang, and P Babyn Bone fracture detection using level set method with

global constraints", Computer Assisted Radiology and Surgery, pp 126-, 2004

[38] Serra J, Mathematical morphology, Academic Press, 1982

[39] Mclnerney T and Terzopoulos D, Deformable models in medical image

analysis:

A survey,

Deformable

models

in

medical

image analysis,

IEEE

Computer Society, 1998

[40] Kass M, Witkin A, and Terzopoulos D, Snakes: Active Contour model,
International journal of Computer vision, 321-333, 1988

[41]

Mclnerney T and Terzopoulos
of the International

D, Topologically adaptable snakes,
on Computer Vision,

in

proceedings

Conference

IEEE

Publications, Los Alamitos, CA, 1995.

[42] Osher S, and Sethian JA, Fronts Propagating with Curvature-Dependent
Speed: Algorithms Based on Hamilton-Jacobi Formulations, Journal of

Computational Physics, 79, pp. 12-49, 1988.

[43] Sethian JA, Level Set methods and fast marching methods, Cambridge
Press, 1999 \:

46

[44] G Sapiro, Geometric partial differential equations and image analysis,
Cambridge University Press, 2001

[45] Yunmei Chen, Sheshadri Thiruvenkadam, Hemant D Tagare, et al, Proc.

IEEE Workshop variational and level set method, On the incorporation of shape
priors into geometric active contours, 2001,pg. 145-152

[46] T F Chan and L A Vese, "Active contours without edges", IEEE transaction on image Processing, Vol 10, no. 2, February 2001

[47] Y Jiang, Y Jia, Active Contour Model with Shape Constraints for Bone

Fracture Detection, International Conference, 3rd Computer Graphics, Imaging
and Visualisation, 2006

47

