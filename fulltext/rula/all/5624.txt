VARIABLE TIME DOMAIN DISCRETIZATION METHODOLOGY FOR MOLECULAR DYNAMICS SIMULATION OF METALLIC COMPOUNDS

By

Jamal Zeinalov Master of Applied Science, Ryerson University (2006) Bachelor of Engineering, Ryerson University (2004)

A dissertation presented to Ryerson University in partial fulfillment for the degree of Doctor of Philosophy in the program of Aerospace Engineering

Toronto, Ontario, Canada, 2016 © Jamal Zeinalov 2016

Author's Declaration

I hereby declare that I am the sole author of this dissertation. This is a true copy of the dissertation, including any required final revisions, as accepted by my examiners. I authorize Ryerson University to lend this dissertation to other institutions or individuals for the purpose of scholarly research I further authorize Ryerson University to reproduce this dissertation by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. I understand that my dissertation may be made electronically available to the public.

ii

Acknowledgements

I would like to take this opportunity to express my gratitude to my thesis supervisor, Dr. Zouheir Fawaz for his help and motivation in the process of researching and writing of this work. Without his constant support, encouragement and guidance this work would not have been possible.

I would like to thank my family, my wife and three wonderful children, for their love and support during this journey. This work is dedicated to them.

iii

Abstract

VARIABLE TIME DOMAIN DISCRETIZATION METHODOLOGY FOR MOLECULAR DYNAMICS SIMULATION OF METALLIC COMPOUNDS

Jamal Zeinalov Doctor of Philosophy, Aerospace Engineering, Ryerson University, Toronto 2016

The present work proposes a methodology to improve the computational requirements of molecular dynamics simulations while maintaining or improving the fidelity of the obtained results. The most common method of molecular dynamics simulation at present is the multiforce, constant time-step, explicit computation, which advances a single time step at a time to determine the next state of the system. The present work proposes a variable time-step strategy, where a single large simulation is subdivided into multiple time domains which redistribute computational resources where they are needed the most: in areas of higher than average potential or kinetic energy or highly dynamic areas around impurity clusters, void formations and crack propagations. The research focuses on the simulation of metallic compounds, as these form the basis of most common molecular dynamics simulations, and have been very thoroughly investigated over the years, thus providing a very extensive body of work for the purpose of comparison and validation of the proposed methodology. The novel methodology presented in this work allows to alleviate some of the limitations associated with the molecular dynamics methodologies and go beyond traditional scales of simulation. The proposed method has been observed to deliver 5 to 20 percent increase in simulation size domain while maintaining or improving the accuracy and computational cycle time. The benefits were observed to be greater for large simulations with one or more areas of higher than average kinetic or potential energy levels, such as those found during crack initiation and propagation, coating-substrate interface, localized pressure application or large thermal gradient. The large difference allows for very clear prioritization of computational resources for high energy areas and as a result provides for iv

faster and more accurate simulation even with increased domain size. Conversely, this method has been observed to provide little to no benefit when simulating stable systems that are undergoing very slow change, such as (relatively) slow change in ambient temperature or pressure, or otherwise homogeneous internal and external boundary conditions. However, for the majority of applications described above, including coating deposition and additive manufacturing, the proposed methodology will yield substantial increase in both simulation size and accuracy, since in the aforementioned processes kinetic and potential energy gradients across the simulation are typically very significant.

v

Table of Contents
Author's Declaration ....................................................................................................................... ii Acknowledgements ........................................................................................................................ iii Abstract .......................................................................................................................................... iv List of Tables ................................................................................................................................. ix List of Figures ................................................................................................................................. x Nomenclature ............................................................................................................................... xiii 1. Introduction ................................................................................................................................. 1 2. Molecular Dynamics Overview .................................................................................................. 6 2.1 Outline ................................................................................................................................... 6 2.2 Physical Characteristics and Important Physical Quantities ................................................. 6 2.3 Simulation Representation .................................................................................................. 11 2.3.1 Space Construction ....................................................................................................... 11 2.3.2 Physical Characteristics ................................................................................................ 13 2.3.3 Simulation Setup........................................................................................................... 15 3. Potential Function Selection ..................................................................................................... 17 3.1 Outline ................................................................................................................................. 17 3.2 Potential Functions .............................................................................................................. 17 3.2.1 Early Models................................................................................................................. 17 3.2.2 Lenard-Jones Model ..................................................................................................... 20 3.2.3 Embedded Atom Method.............................................................................................. 22 3.2.4 Multiple Force Models ................................................................................................. 25 3.2.5 Monte Carlo Methods ................................................................................................... 27 3.2.6 Ab-Initio Methods ........................................................................................................ 28 3.3 Potential Function Application to Molecular System Simulation ....................................... 29

vi

3.3.1 Potential Function Application ..................................................................................... 29 3.3.2 Important Physical Characteristics ............................................................................... 30 4. Molecular Dynamics Simulation Boundary Conditions ........................................................... 33 4.1 Physical Boundary Conditions ............................................................................................ 33 4.1.1 Outline .......................................................................................................................... 33 4.1.2 Repeating Boundary ..................................................................................................... 34 4.1.3 Surface Boundary ......................................................................................................... 34 4.1.4 Crystal Boundary .......................................................................................................... 35 4.2 Statistical Ensembles ........................................................................................................... 36 4.2.1 Statistical Ensemble Overview ..................................................................................... 36 4.2.2 System Equilibrium ...................................................................................................... 37 4.2.3 Interaction with Boundary Conditions ......................................................................... 37 5. Molecular Dynamics Models Using Constant Time Step Methodology .................................. 39 5.1 Outline ................................................................................................................................. 39 5.2 Variation of Properties Under Changing Thermal Conditions............................................ 39 6. Variable Time Step Molecular Dynamics Model ..................................................................... 54 6.1 Outline ................................................................................................................................. 54 6.2 Overview of Model ............................................................................................................. 54 6.3 Theoretical Overview of Proposed Methodology ............................................................... 55 6.4 Two Body System Application ........................................................................................... 56 6.5 Large Model Application .................................................................................................... 61 6.6 Code Overview .................................................................................................................... 66 6.7 Methodology Application Example ­ Compressive Force Application ............................. 68 6.8 Methodology Application Example ­ Thermal Expansion ................................................. 72 6.9 Methodology Application Example ­ Deposition Process ................................................. 76 vii

7. Discussion ................................................................................................................................. 81 8. Conclusion ................................................................................................................................ 85 Appendices .................................................................................................................................... 87 Appendix A. Detailed Molecular Dynamics Formulation ........................................................ 87 Appendix B. Embedded Atom Model for Copper and Nickel .................................................. 89 References ..................................................................................................................................... 91

viii

List of Tables
Table 1. Some of the properties of metals and gasses compared to Lennard-Jones predicted values showing the effects of many-body dynamics. (Adopted from Daw [24]) ......................... 24 Table 2. Contribution of tensile loading and temperature to change in strain for each crystallographic configuration ...................................................................................................... 50 Table 3. Average Modulus of Elasticity for each crystallographic configuration in linear region ....................................................................................................................................................... 50 Table 4. Linear and Planar Particle Density in the Direction of Loading for Different Lattice Orientations ................................................................................................................................... 51 Table 5. Comparison of error and cycle computation time for two variable time step models and one constant time step model ........................................................................................................ 60 Table 6. Error and computational efficiency summary for pin compression simulation.............. 71 Table 7. Error and computational efficiency summary for thermal expansion simulation .......... 75 Table 8. Error and computational efficiency summary for metal deposition simulation ............. 80

ix

List of Figures
Figure 1. Simulation methods predominantly used at a any given time and size scales ................ 3 Figure 2.Schematic representation of MD simulation space, with primary simulation field shown in the center, surrounded by adjacent fields.................................................................................. 13 Figure 3. Atomic Bond Strength as Function of Inter-Atomic Spacing. Adopted from Petch [18] ....................................................................................................................................................... 19 Figure 4. Normalized relationship between inter-atomic distance and force according to LennardJones Potential function (Adopted from Bhushan [10]) ............................................................... 22 Figure 5. Typical normalized relationship between embedding energy and atomic density used in EAM potential calculations (Adopted from Daw [25]) ................................................................ 24 Figure 6. Bond potentials typically modeled for non-metallic compounds, including ionic, covalent, three particle angle and four particle dihedral potentials .............................................. 25 Figure 7. Surface vs. Bulk Particle Bond Distances for Metallic Compounds ............................. 35 Figure 8. Molecular Dynamics Model Properties: A Cylindrical Nano-Wire with BCC Crystal Structure ........................................................................................................................................ 40 Figure 9. Temperature and External Loading sample distribution ............................................... 46 Figure 10. Simulation Loading Regime ........................................................................................ 47 Figure 11. Typical Loading Regime ............................................................................................. 48 Figure 12. Relative effect of change in temperature (top) and tensile loading (bottom) on sample strain for (100) crystallographic orientation ................................................................................. 49 Figure 13. Relative effect of change in temperature (top) and tensile loading (bottom) on sample strain for (110) crystallographic orientation ................................................................................. 49 Figure 14. Relative effect of change in temperature (top) and tensile loading (bottom) on sample strain for (111) crystallographic orientation ................................................................................. 49 Figure 15. Linear particle density, defined as linear particle count, divided by length in the direction of applied pressure, P .................................................................................................... 51 Figure 16. Planar density defined as number of particles divided by the area in cross section normal to the applied pressure, P.................................................................................................. 51 Figure 17. Strain variation with Applied Pressure for (a) (100), (b) (110) and (c) (111) crystal lattice orientation. The present work has examined the variation in structural properties of x

metallic materials with BCC crystal structure through the simulation of Copper nano-wire through Molecular Dynamics methodologies based on EAM. The results have shown that the variation in strain correlate to material temperature, and crystal lattice orientation through variations in linear and planar particle densities. .......................................................................... 52 Figure 18. Compressive failure mode shown with highlighted shear failure plane ..................... 53 Figure 19. Strain results normalized with the inverse of square root of linear density plotted against applied pressure ................................................................................................................ 53 Figure 20. Particle distance (r) variation with time during single cycle ....................................... 57 Figure 21. Particle potential and force variation with time during single cycle ........................... 57 Figure 22. Variation of mean position error for variable time step models with the change in n parameter....................................................................................................................................... 58 Figure 23. Variation of particle position error during single cycle for variable time model with different n parameter values.......................................................................................................... 59 Figure 24. Comparison of position error during single cycle for constant time step and variable time step models ........................................................................................................................... 59 Figure 25. Variable Time Step Logic. Division of Simulation Into Multiple Time Domains Depending on Local Energy Levels .............................................................................................. 63 Figure 26. Normal distribution of energy and a representative time-step calculation applied to base time-step tn ............................................................................................................................ 65 Figure 27. Program Flow Chart .................................................................................................... 67 Figure 28. Setup for compressive pin model. Including model dimensions and loads applied. ... 68 Figure 29. Compressive model simulation snapshots at 50fs, 1000fs and 1900fs, shown with stress results .................................................................................................................................. 69 Figure 30. Mean kinetic energy error for constant and variable time step simulations plotted against time ................................................................................................................................... 70 Figure 31. Mean stress error for constant and variable time step simulations plotted against time ....................................................................................................................................................... 71 Figure 32. Setup for thermal expansion simulation. Including model dimensions and temperature gradient. ........................................................................................................................................ 73 Figure 33. Thermal expansion model simulation snapshots at 50fs, 1000fs and 1900fs, shown with kinetic energy results ............................................................................................................ 73 xi

Figure 34. Mean kinetic energy error for constant and variable time step simulations plotted against time ................................................................................................................................... 74 Figure 35. Mean stress error for constant and variable time step simulations plotted against time ....................................................................................................................................................... 75 Figure 36. Setup for metal deposition model. Including substrate and deposition dimensions.... 76 Figure 37. Default orientation of Nickel in substrate and deposition ........................................... 77 Figure 38. Metal deposition model simulation snapshots at 100fs, 300fs, 600fs, and 900fs shown with kinetic energy results ............................................................................................................ 78 Figure 39. Mean kinetic energy error for constant and variable time step simulations plotted against time ................................................................................................................................... 78 Figure 40. Mean stress error for constant and variable time step simulations plotted against time ....................................................................................................................................................... 79 Figure 41. Ratio of cycle time (seconds/fs) required to advance the simulation of constant timestep to variable time-step methodologies plotted against mean/median kinetic energy of the system ........................................................................................................................................... 81 Figure 42. Difference between mean stress error between constant and variable time-step methodologies, plotted against Mean/Median kinetic energy ratio .............................................. 82 Figure 43. Example of constant and variable time-step methodologies for a hypothetical crack propagation simulation, where high energy region is denoted by A, average energy region is denoted by B, and low energy regions is denoted by C ................................................................ 83 Figure 44. Expansion of molecular dynamics simulation domain achieved with the presented methodology ................................................................................................................................. 86 Figure 45. Distance (angstrom) vs. Potential (eV) graph for Copper ........................................... 89 Figure 46. Distance (Angstrom) vs. Density graph for Copper .................................................... 89 Figure 47. Density vs. Potential (eV) graph for Copper ............................................................... 89 Figure 48. Distance (angstrom) vs. Potential (eV) graph for Nickel ............................................ 90 Figure 49. Distance (Angstrom) vs. Density graph for Nickel ..................................................... 90 Figure 50. Density vs. Potential (eV) graph for Nickel ................................................................ 90

xii

Nomenclature
 T m n kB r t  a     E F U p  S     A  P dij V ER De Broglie thermal wavelength Temperature Atomic mass of particles Number of particles Boltzmann's constant Position Time Velocity Acceleration Stress Strain Lennard-Jones interaction distance parameter Lennard-Jones interaction energy parameter Modulus of elasticity Force Energy potential Momentum Particle density Surface energy per unit area Thermal scale factor Inter particle potential function Embedding function Area Local energy coefficient External pressure Distance between particles i and j Volume Error

xiii

1. Introduction
Molecular Dynamics simulations have become increasingly more important in the investigation of material properties and interactions at nanometer to micrometer scale over the past several decades. Initially conceived as a research tools they are becoming more common within a wide range of industries including aerospace engineering. Within aerospace, the molecular dynamics simulations are used to predict increasingly complex processes of material treatment and manufacturing, including coating deposition on turbine blades (and other high temperature, corrosive applications) and new material development including structural composite and additive manufactured parts. These new manufacturing processes rely on addition of relatively small (under micron) amounts of material to build up a complete part or coating level and are difficult to simulate using traditional continuum mechanics methods, because of the increased importance of molecular structure on such small scales. As such the methods employed in the molecular dynamics analysis are becoming increasingly more important to study within the field of aerospace engineering to ensure the comparable level of fidelity enjoyed by the simulations that are employed at more common scales using continuum mechanics models. The most significant limitation of the molecular dynamics simulations is the sheer number of atoms required for the simulation to predict the most important physical characteristics of the materials, including thermal expansion and conductivity, structural properties, strength, modulus of elasticity, isotropic and anisotropic behaviour, as well as failure modes and propagation rates. Larger models tend to better predict these properties but come at an increased computational cost. The study of material properties is an increasingly complex and evolving field. It is often driven by the increasingly more demanding requirements from engineering and scientific disciplines always looking to improve material properties. Aerospace Engineering is no exception; within the field's wide array of applications, the search to improve the material properties, to make them lighter, stronger, able to withstand higher temperatures is constantly ongoing coupled with demand for lighter structures and more efficient power plant operations. As a result of this search new methods in material synthesis and coating are being proposed and developed. These methods, however, often necessitate a deeper understanding of materials on molecular level; the material properties of metallic crystal lattice, the chemical processes occurring at the interface of 1

substrate and coating deposition and the nucleation and propagation of voids, the precursors to crack propagation, become critical to understanding and predicting the material properties on a more conventional physical level.1,2 Thin metallic and ceramic coating applications and parts created using additive manufacturing processes are some of the more widespread examples of new manufacturing methods and applications that necessities the simulation of molecular interactions in order to accurately predict the end properties of the materials. In case of coating applications the end goal is to provide the most resistance to oxidation of the metal substrate that will result from the spallation of coating. The spallation mechanism, where the coating eventually flakes off from the substrate metal, is strongly linked to the coating-substrate interface that is formed during the coating deposition process. Thorough investigation and modelling of this interface is not possible without the use of molecular dynamics to not only as certain how bonding structures are formed at the interface, but also to study the effects of deposition process variables, such as angle of deposition, presence of electro-magnetic field, size of deposition droplets, temperature, ambient pressure and atmospheric conditions on the interface bond formation. It is only through the use of molecular dynamics that it is indeed possible to explicitly assert and predict the coating behaviour during the lifetime of the application. Similarly, in the additive manufacturing processes, which themselves encompass a wide range of methods, the size of deposition particles, method of deposition, frequency, temperature and a host of other variables all play an important role in determining the physical properties of the part, and are impossible to evaluate without looking at molecular interactions of material especially at the point of material deposition. The study of material properties on nanometer to micrometer scale has been an active field of research for last several decades. In addition to the physical testing and study of the materials at the nano-scale through the experimental means, a simulation and modelling field of study has also evolved in parallel. Although, currently experimental research still comprises the majority of research and material development work, this may change as the simulation and modelling field becomes more mature, offering improved fidelity and scale of study.

2

There are three primary methodologies for simulation on the molecular scale. Ab-Initio or first principles method, that takes into account the quantum nature of the molecular structures, often modelling electron interactions and quantum fields. This method provides the most accurate results, but is also by far most computationally intensive and is not generally used to model more than a few hundred to a thousand atoms. Deterministic Molecular Dynamics is a semi-empirical method that treats each atom as a point mass and models all of the inter-atomic forces as energy potential approximations. This method is less accurate than the first principles method, but requires far fewer computational resources. It has been successfully used to model chemical processes and properties in metallic, plastic and carbon based compounds at conventional temperatures. Lastly probabilistic methods, based on Monte-Carlo methodology are also used. These are generally the least accurate of the three methods, since they often forgo time dependence and only focus on the general end state of the system. Figure 1 shows the extend of the use of the different methodologies on time and size scale.

Figure 1. Simulation methods predominantly used at a any given time and size scales
3

The focus of this work is on the molecular dynamics deterministic methodology as the one offering the best balance between fidelity and computational resources, and is focused on expanding the domain of the molecular dynamics methodology and bringing it closer to the continuum method scale. Currently, one of the biggest obstacles to expanding the simulation methodology and scope is the sheer computational resources requirements needed to accurately model physical phenomena at the molecular level. The number of atoms that are required to be modelled in modern simulations range from 10,000 to 1 million, with a constant push to be able to model more, and with the improvements in computational hardware and methodology this number is steadily increasing. The present study is aimed to deliver one such improvement in methodology that will allow for an increase in both the scale of the molecular modelling and fidelity, through the use of variable time-step methodology. At present, the most common molecular dynamics algorithms use a constant time-step setup. This means that regardless of processes develop during the simulation the time-step for all particles is consistent from start to finish. This presents a convenient simplification and allows the investigators to focus more on the development of energy potentials to better describe the system. However, this is also a rather wasteful approach to computational resources and system fidelity. The methodology proposed in this study uses a process of subdividing any simulation, when required, into discrete set of smaller domains, each of which is re-computed at different time intervals. Using this process the computational resources are prioritized for the areas where the most energy intensive process are occurring, including crack nucleation and propagation, interface between two or more different materials, or active chemical reactions, while more stable areas of simulation receive less priority and are re-calculated at longer time intervals. This approach is particularly beneficial in large simulation undergoing chemical, mechanical or thermal transformations as these processes can be more accurately modelled. This method can also deliver comparable results to a constant-time step methodology while using less computational resources, thereby increasing the time and size envelope and bringing the viable use of molecular dynamics methodology close to continuum mechanics threshold. The objective of this work was to increase the efficiency of the simulation, measured as the time required to advance simulation through a given period of time, by at least 10%. This objective 4

has been achieved and even surpassed, but only for systems that are undergoing high energy transformation, such as material deposition, high stress application, void formation or crack propagation. In general the efficiency has been show to increase by up to 20%, with the benefits increase correlated to the increased energy change across the simulation domain. In other words, for energetically homogeneous system this approach yielded the least benefit. The secondary objective of this work was to maintain and, if possible, increase the fidelity of the results, including strain, strain, kinetic and potential energy, while increasing the computational efficiency of the simulation. This objective has also been achieved, with the largest accuracy increases observed in the high energy sectors of the simulation. Work presented in the following chapters follows the research process undertaken during this study. Chapters 2, 3 and 4 constitute the review of the current state of research in the field and focus on the selection of most appropriate simulation framework for which the variable time step methodology may be applicable. These include the identification of most appropriate molecular dynamics methodology, boundary conditions and statistical ensembles. This is presented together with the overview of other techniques used in the field and the relative merits of each method, in particular as it applies to metallic material simulation. Chapter 5 summarizes the work performed by the author using standard simulation techniques and is presented as an overview of typical results that are currently obtained using molecular dynamics simulations. It is meant to introduce and summarize the results and limitations typical of classic molecular dynamics techniques. In chapter 6 the main thesis of this work is presented in the form of detailed theoretical analysis and applied simulation examples for the variable time domain methodology developed by the author. It includes derivation of the main concepts employed by the methodology and the illustration of the benefits of this methodology on several examples. Chapter 7 details the discussion based on the results presented in Chapter 6 and provides comparison between classic time step method employed by current molecular dynamics simulations and the novel variable time step method presented in this thesis.

5

2. Molecular Dynamics Overview
2.1 Outline This chapter covers the main topics and principles related to molecular dynamics simulations. It covers the underlying physical parameters that are required to set up the simulation as well as their application to the algorithm used to conduct detailed investigations. The algorithm used in this study is based on the contemporary works in the field of atomic modeling and includes the inter-atomic potential model that has been verified by other works in the field, most appropriate being an EAM (Embedded Atom Method). It has been set up to enable the output of most critical physical parameters that would need to be obtained from the system: position, velocity, acceleration, energy and temperature, as well as easy derivation of structural properties including stress, strain and modulus of elasticity. Modeling of material behaviour on nano-scale is necessarily different than performing similar analysis on larger scale. Here, the quantum nature of materials must be taken into account in order to obtain realistic results. This chapter provides a detailed overview of the construction of the modeling environment for the materials on nano-scale as well as physical considerations that are taken into account. The focus of this work is on metallic materials that have a defined crystal lattice arrangement. These types of materials are chosen since their analysis can then be facilitated by the means of similar simulation parameters as well as for their importance to engineering applications. The focus of this chapter is on defining the critical physical characteristics and their interactions required for the set up of a molecular Dynamics (MD) simulation. More extended topics of force interaction and boundary condition selection are covered in subsequent chapters. 2.2 Physical Characteristics and Important Physical Quantities Material properties on nano-scale may differ quite drastically from those on larger scale. Since the scope of this study only includes the metallic materials, the crystal lattice that is formed by individual atoms becomes of great importance as it dictates to the large extend the strength and the modulus of elasticity in any given direction. The strength and the elastic modulus of the material is also highly affected by the presence of point discontinuities in the form of vacancies 6

or impurities as well as larger formations that come in the form of line or plane dislocations. The analysis on this scale also requires a very careful treatment of temperature (atomic kinetic energy) and time step interval in order to ensure viable and relevant results. Although, there are a number of ways of modelling molecular interactions, with the most significant being discussed in the subsequent chapters, this study relies on the approximation of the atomic particles using Newtonian mechanics. As such, the important simulation properties that will be discussed in this chapter will be presented through the lens of Newtonian mechanics. Every particle (in this case an atomic nuclei), is represented as a point mass with described position and momentum. The forces acting on each particle are described by the potential function. The simulation advances at certain time intervals over which the forces acting on all atoms are calculated and the appropriate acceleration, velocity and new position are calculated. Although, not exact, since this type of simulation does not take into account quantum effects other than by an approximation through potential function and does not model other atomic particles explicitly, most notably electrons, it still provides a good approximation to a wide variety of applications as long as the simulation is restricted to the situations where quantum effects are not the dominant form of particle interaction. In order to make such assumptions it is first necessary to determine under what circumstances the classical model approaches the quantum model in its ability to describe inter-atomic behavior. It is beyond the scope of this work to go into the detailed derivation and analysis of the validity of such an approximation. The general conditions when the classical theory is valid can be described as3:

22 =  Mk B T ( 1)

Where M is the atomic mass, T is temperature, and  is de Broglie thermal wavelength. The approximation is valid when   , where a, is the mean nearest neighbor separation between particles. It can be seen from this equation that in general the approximation works better for 7

elements that are have higher atomic mass and have a more densely packed structure. In addition, at sufficiently low temperatures the quantum effects become important for any material. As such the classical mechanics approximation is usually safely made for metals (as they are typically heavier elements with close separation between particles), at typical engineering temperatures: -40C up to phase change temperatures, although there are numerous studies that have pushed the lower limit threshold even further4,5 and have been able to successfully model mechanical properties of metals at very low absolute temperatures. There are several critical physical quantities that must be defined for the simulation. They include atomic positioning, masses, velocities, acceleration, forces, temperatures and time steps. The atomic positioning is normally dictated by other factors in the simulation. Initially, it is defined through the material selection, crystal lattice type and initial temperature. It is then recalculated after each time step through velocity values. The mass of each atomic particle is usually defined once at the beginning of the simulation through the material selection process. Normally, quantum mass effects are not considered in these types of simulations since the particle velocities are relatively low. Velocity values are usually defined through initial temperature selection and may be somewhat randomized in scale and direction from the initial value to simulate a typical atomic system. The initial velocity values are also set up such that the average velocity of the system adds up to zero to eliminate potential drift of the center of mass of the simulation6. The velocity values are typically recalculated after each time step through acceleration values. Acceleration values are typically set to zero at the beginning of the simulation and recalculated after each time step through inter-atomic forces. The inter-atomic forces are described by the potential function. These functions come in several different varieties and will be covered in more detail later. The forces are recalculated after each time step through the differentiation of potential function. The position and velocity of each atomic particle can described as following at the beginning of the simulation:

( = 0) = (, ) ( 2)
8

 ( = 0) = (, ) ( 3)



= =1

,=0 = 0 ( 4)

At each time step Verlet algorithm can be used to recalculate the position and velocity from acceleration. The Verlet algorithm is used here as it provides more accurate results by calculating the mid-step velocity and using that value to calculate the final position of particle after time interval t7:

( +  ) = ( ) +  ( +

 )  2

( 5)

 ( +

 1 ) =  ( ) + ( + ) 2 2

( 6)

 ( +  ) =  ( +

 1 ) + ( + ) 2 2

( 7)

Here, the result calculated in the equation 6, the half-step velocity, is used to determine the final position of the particle after t interval, while the result obtained from equation 7 is stored for the use in the next step as initial velocity. The extra calculation of the half-step velocity minimizes the error as it takes into account the linear change in velocity during the time step.

9

The acceleration of each particle is set to zero at the start of the simulation and then subsequently determined after each time step through the forces acting on each particle within the system:

 ( = 0) = 0

( 8)

 ( +  ) =

 

( 9)

The forces acting on each particle are dictated by the inter-atomic potential selected for the simulation and will be covered more in-depth is later chapters. Temperature is less readily definable quantity in an atomic simulation. Here, the temperature variations become much more important and if required can be tightly controlled through the use of scale-functions. The temperature itself can be defined as function of velocity, mass and density of the material and is a measure of the vibration energy of each particle. The initial temperature specified at the beginning of the simulation dictates the initial velocity of atomic particles as well as initial atomic spacing (or density) while taking into account particle mass. Initial momentum of the atoms due to temperature can be determined from the following8:

1 2 ( )  = 3 
=1



( 10)

Here, the individual particle momentum, pi, can be determined from the temperature, T, through the number of particles N and the atomic mass mi. There are several types of temperature scaling that can be implemented. These can be incorporated into boundary condition definitions or applied individually to each particle. The 10

former type of temperature scaling will be treated in the chapter pertaining to the boundary conditions, while an example of latter is described below9:

 = 1 +

 0 ( - 1)    ( 11)

Where, T is the current temperature of the system, T0 is the desired temperature of the system and  is the scale factor that is multiplied to every particle velocity in the simulation once per time iteration. and  are time step and temperature time constant respectively. Time scale is of very high importance to the simulation as it has a major impact on the size and the length of the simulation run as well as accuracy of the results. When using deterministic potential functions the time step is dictated by the typical time of the atomic bond vibrations which are on the order of femto-second (10-15s) to minimize the discretization errors. As a rough rule the atoms should not move more than 1/20 of the typical inter-atomic distance, unless in the area of significant dynamic change (e.g. crack propagation or boundary area) 10. On the other hand the simulation duration should be extended for as long as possible to allow for the system to converge to the equilibrium state or follow the dynamic development of the system under changing loads or other external factors. The problem of simulation duration cannot be easily solved by adding additional processing power since time cannot be parallelized. This creates one of the main limiting factors of deterministic MD simulation, on one hand to achieve increased accuracy more precise formulations are desired; on the other hand these formulations often come at the additional computational cost and therefore limit the size of the simulation.

2.3 Simulation Representation 2.3.1 Space Construction Modeling simulation of inter-atomic interactions begins with the creation of a simulation space. This space contains all of the elements that will be considered in the simulation. Initially it is 11

populated by the atomic particles, defined with the appropriate initial conditions: position, which depends on the material type and crystal lattice, and momentum, which depends on temperature and material type as well. This type of space with three dimensions of position and momentum is called phase-space. The simulation space is naturally constrained by the computational limits and as such can only include a set number of particles. This number is usually too small to model even a single crystal of the material. In order to simulate a larger number of particles as well as provide boundary conditions for certain types of analysis, additional sections of material are introduced around the primary section. The particles in these sections do not undergo the physical simulation but are instead used to simulate the surrounding material around primary space.11 The surrounding atomic particles are coupled with the particles within the main simulation environment in order to keep the number of atomic particles within the space consistent. It is obvious that some of the particles from the main simulation field will drift into the adjacent surrounding fields as the simulation is performed. In this case it is important for the atomic particles from the surrounding fields to also drift into the main simulation space to keep the number of atomic particles consistent. This is accomplished by coupling the atomic particles from the surrounding fields with the particles in the main field11. Figure 2 shows a schematic representation of the simulation field surrounded by the adjacent fields that provide a boundary condition for the simulation. This figure also illustrates what happens when one of the particles crosses the main simulation boundary; an identical particle with identical momentum is introduced into the simulation from one of the adjoining fields.

12

Figure 2.Schematic representation of MD simulation space, with primary simulation field shown in the center, surrounded by adjacent fields.

2.3.2 Physical Characteristics The basis of the modeling algorithm is the set up and position of the atomic particles in the set crystal structure. This is accomplished by defining an array that represents each atom in the system as well as a matrix array containing X, Y, and Z coordinates of each atom as following:

[] = [1 , 2 , ... ,  ]

( 12)

13

1   [ ] = [ 1 1 

2 2 2

... ... ] ... 

( 13)

From this initial set of values the distance between any two atoms can be obtained by:

 = |( -  ) + ( -  ) + ( -  ) | ( 14)

2

2

2

Where rij is the scalar distance between two atomic particles. The number of particle pairs within the simulation is given by12:

 =

1  ( - 1) 2  

( 15)

Where Np denotes the number of pairs and Na denotes the number of atomic particles. The pair distance matrix therefore can be described by the following matrix array:

1,1 [] = [  ,1

  

1,-1  ] ,-1

( 16)

The next important property to consider is the moment of each atom. This quantity combines the mass of each individual atom and its velocity. Similarly in this case an array is set up to include each atom's mass (this allows for the evaluation of models that contain more than one element) as well as a matrix array that contain the x, y and z components of the particle velocity.

14

[] = [1 , 2 , ... ,  ]

( 17)

1  [ ] = [1 1 

2 2 2

... ... ] ... 

( 18)

Using these parameters the particle moment can be described as:

 =  

( 19)

Where pi denotes the particle momentum, mi denotes the particle mass and vi denotes the particle velocity. 2.3.3 Simulation Setup The initial setup parameters of the MD simulation must include the following information: Size of the simulation: This parameter indicates the number of particles to be included in the simulation. As discussed before this value typically limited to several thousand particles based on the hardware limitations. Time step: This value sets up the time step of the simulation. For most typical MD simulations this is in the order of one femto-second (10-15s). Material Type/Particle Density: This value specifies the mass of each particle in the simulation. This will be applied to all particles in the simulation in case of a homogeneous material simulation

15

Crystal Lattice: Here three typical choices are available ­ Face Centered Cubic (FCC), Body Centered Cubic (BCC) or Hexagonal Close Packed (HCP) type of crystal lattice. This pattern will be applied to the initial positioning of the atomic particles Temperature: This value specifies the initial temperature of the simulation. This value can either be kept constant through the simulation or allowed to change. In the initial set up of the system this value affects several parameters. It specifies the initial atomic spacing at the start as well as the average velocity of each atom at the start of the simulation. These factors define the initial setup of the simulation and provide a starting point for the analysis. Once the simulation has started some of these variables may vary or be kept constant throughout the simulation depending on the type of analysis. This chapter covers the first of the three main requirements to perform the successful MD simulation, namely the set up of the initial simulation parameters. The other two: inter-atomic interactions and boundary conditions are covered in the next chapters.

16

3. Potential Function Selection
3.1 Outline There are numerous different methodologies, ranging from ab-initio to empirical and from deterministic to probabilistic, that exist to describe the behavior of materials at inter-atomic scale. These methods usually do a good work of describing a particular set of systems with few of them accurate enough or computationally feasible to be applied to a broad spectrum of cases. This chapter takes account of the some of the most popular and successful methodologies, and in particular to their applicability to metallic materials. This chapter also describes the critical physical characteristics that an accurate atomic simulation must incorporate. One of the cornerstones of successful deterministic molecular dynamics simulation is definition of the inter-atomic forces potential. Because of the quantum nature of the physical interaction between atomic particles the most popular approach has been to approximate the inter-atomic forces through the use of Newtonian mechanics and approximating the quantum effects through potential functions. Other methods that calculate the forces ab initio from the quantum

principles are sometimes used as well, but they are generally much more computationally expensive. The classical approach with potential function approximation has been shown to provide reliable results as long as the conditions that are modeled are such as to minimize quantum properties of particles (i.e. extremely high and low temperatures, very low or very high density materials). For the materials that are the main focus of this work, namely metals used in engineering applications, both material type and typical engineering temperature range allows to make such assumptions. There have been numerous potential functions proposed by different researchers that will be covered below. Typically these functions prove to be reliable and accurate for a limited number of materials and cases as they are each only approximating the inter-atomic interactions. 3.2 Potential Functions 3.2.1 Early Models Physical mechanics and interactions on nano-level are significantly different from those on macro level. In order to predict the material behaviour through analytical or numerical analysis it 17

is first important to identify the prevalent mechanics on this level of analysis. The crystal structure of a material is of very high importance on the nano-scale level. It dictates the most important mechanical characteristics of the system. Because of the crystal structure the mechanical properties of the material at this level can no longer be characterized as isotropic even if at the large scale such assumption can be safely made. As a result the structural characteristics vary according to the direction in which the load is applied. The challenge of defining the material interactions and characteristics with an acceptable level of accuracy can be traced back to the development of quantum mechanics theory. Once it became possible to determine the atomic structure and the prevailing inter-atomic forces it was then possible to construct models that can predict the behaviour and local response of material at nano-level to applied stresses as well as show the mechanism by which the imperfections develop and grow13. While analytical models for the treatment of physical phenomena at nanolevel have been developed over the last three decades it has only became recently possible to verify and as a result develop new understanding of the theories through computational modeling of large systems of particles. It has been theorized and verified through experimentation that the ideal material properties depend on the crystal lattice structure and inter atomic bond strength. For homogeneous materials with a well defined crystal lattice it then becomes possible to approximate the ideal strength of the materials. A large body of research has been conducted in this area. The results suggest that the ultimate strength of the material should lie in the area of E/10 (where E is Young's modulus of regular materials)14. Liu et al15, using molecular simulation show the tensile strength of ideal copper to be 10.09 GPa, while the Young's modulus for copper is in the area of 120 GPa. Similarly Clatterbuck et al16, shows the ideal strength of iron to be 12.7 Gpa, while the Young's modulus for iron is 170 GPa. The tensile strength of a material can be described as a function of Young's modulus:

 =  ( 20)

18

For ideal material  would be in the area of 0.1, this however is far from the values obtained for regular materials. The actual values of  instead fall into range of 0.001 for common metals and alloys to 0.01 for strong steel alloys. The theoretical ideal strength of the materials has been calculated based on the inter-atomic attraction forces. The attraction forces have been first estimated form the Van der Waals equation and can be graphically represented as a sine function relating surface tension and interatomic spacing (Figure 3).

Figure 3. Atomic Bond Strength as Function of Inter-Atomic Spacing. Adopted from Petch [18]

From figure 3 the stress required to break the inter-atomic bond can be described as:

2 )  =  sin ( 

( 21)

Petch17 shows that from there the theoretical stress required to break the inter-atomic bonds can be described as:

19

 = 

  ( 22)

Where S is the surface energy per unit area and a is atomic spacing. The particular atomic structure of metals shows two prevalent physical interaction methods: the forces exerted by atoms on each other within the crystal structure, and the interactions between atoms and surrounding "electron sea"18. Within the crystal structure the forces depend on the structure geometry (e.g. bcc, fcc or other structures) and atomic spacing. The particular crystal arrangement influences the modulus of elasticity in a given direction and is the main reason for the anisotropic behaviour of metals on nano-scale.19 The electron sea density is a function of number of atoms in the area, and is thought to be locally homogeneous, although varying across crystal lattice according to the distribution of atoms.20 Crack propagation on nano-scale has a distinctly discrete nature since the imperfection can only grow by destroying individual bonds between atoms within a crystal lattice. This assumption holds true for ionic and covalent compounds where atomic bond interaction is strictly defined and atomic pair spacing and relative positioning plays a predominant role in determining the interactions of individual particles. At the same time this assumption is somewhat less valid for metals where metallic bonding makes the interaction between any two particular particles only one of the determining factors (the other one being the positioning of the atom within an electron potential created by all surrounding atoms). 3.2.2 Lenard-Jones Model Lenard-Jones algorithm is one the earliest proposed methods of inter-atomic interaction modeling. It models the pair-potential between two atomic entities. This method is commonly used in interactions between atoms with closed electron shells, and is typically applied to interactions between in polymer chains or noble gases. The Lenard-Jones potential form is shown in equation (23):21

20

  ( ) = 4 [( ) - ( ) ]   ( 23)





Where, rij is the distance between particles i and j, and  and  are Lenard-Jones interaction energy and diameter respectively. Values for a and b are typically set to 12 and 6 respectively, but may be varied depending on particular application.22 At close range the a variable dominates the equation causing a strong repulsive force, while at the larger distances the b variable is more dominant providing a weaker attractive force between the two atoms. Although theoretically the force between the two atoms never goes to zero, for modeling purposes a cut-off distance is usually introduced to save on computational resources since in the typical metallic pair interactions the pair force interaction show rapid drop off as can be seen in the example of Copper in Appendix C. Here, the pair potential shows rapid drop off and very small change in slope (which in turn determines the pair force interactions) beyond 5.5 angstrom. It is therefore computationally expedient to not calculate any pair force interactions beyond this distance at will have negligible effect on the particle dynamics, while saving significant computational resources.

21

Figure 4. Normalized relationship between inter-atomic distance and force according to Lennard-Jones Potential function (Adopted from Bhushan [10])
This method does not take into account the orientation of the bond and the atoms relative to each other. It also assumes that the bond strength does not change with the number of bonds, or coordination, each atom may have, which is not always the case, especially in metals. This method best used in applications where the bonds between neighbouring atomic entities are clearly defined as is the case with ionic or covalent bonding and modeling situations where the atomic coordination is fairly uniform and does not change over the course of the simulation. 3.2.3 Embedded Atom Method Embedded Atom Method was developed to better simulate the metallic bonding interactions found in most typical metals. This method reflects the fact that in metallic compounds the atoms are positioned within a sea of electrons and as the name suggests introduces potential energy

22

associated with embedding an atom into the electron density produced by surrounding atoms. The typical EAM potential is described in equation (24).23

 ( ) +    ( )  =  
  <

( 24)

 ( ) is the Where  ( ) represent the pair potential described earlier in equation 23, and  embedding energy as function of  , the density of the electron cloud produced by surrounding atoms. This methodology is particularly well suited to model metallic materials because of the dependence of bond strength on not only the pair distance but also on coordination of each atom. Coordination refers to the number of bonds an individual atom has. Figure 5 shows the ratios of embedding energy to cohesive energy of material, for metals it is shown that the embedding energy is not linearly scaled to cohesive energy but is rather proportional to the square root of the coordination energy. In other words as the coordination increases so does the cohesive energy of the atom but not in linear fashion. This can be explained by individual bonds getting weaker as the overall number of bonds increases. This phenomena is modelled by the embedding energy term above as it takes into account the density of the surrounding electron cloud and by extension other atomic nuclei to a given nucleus and the effect on the inter-atomic bonds. A typical distribution of an embedded energy as function of electron density is shown in Figure 6. The ability of the EAM method to model electron density allows for a more accurate modeling of defects including vacancies and discontinuities in the crystal structure for metallic materials. 24

23

Table 1. Some of the properties of metals and gasses compared to Lennard-Jones predicted values showing the effects of many-body dynamics. (Adopted from Daw [24])

The embedding function has an effect of indirectly accounting for the atomic coordination. It has been observed that in metals the overall bonding energy does not rise linearly with the increased coordination, but is rather scaled closer to a square root function. What this in effect means is that as the number of bonds that an individual atom develops increases the individual bond strength decreases.
Normalized EAM Potential function distribution
1 1 Normalized Embedding Energy -1 -3 -5 -7 -9 -11 -13 -15 Normalized Atomic Density 51 101 151 201

Figure 5. Typical normalized relationship between embedding energy and atomic density used in EAM potential calculations (Adopted from Daw [25])
24

3.2.4 Multiple Force Models In addition to atomic pair potential interactions described above that primarily addresses metallic non-bonding forces additional constructs are needed in some cases to describe other chemical bonding types. To describe structures with ionic and covalent bonds prevalent in non-metallic structures different, shown in figure 6, energy potential constructs exist.

Figure 6. Bond potentials typically modeled for non-metallic compounds, including ionic, covalent, three particle angle and four particle dihedral potentials

These types of bonds are typically modelled as harmonic form with specified molecular separation|rij |:25

 =  kij (rij )


2

( 25)

25

Here Ubond denotes the potential between two particles, similarly to equation 23, with the difference of being only dependent on the square of the distance between particles i and j as defined by term rijand the constant kij associated with this particular bond type. The bend angle between successive atomic particles (as in example of water molecule) is modeled with successive bond vectors and involves three particle positions:

 =  kij (ij )


2

( 26)

Here Uangle denotes the potential created by three particles and the two bonds that they form, dependent on the square of the angle between the two bonds i and j as defined by term ij and the constant kij associated with this particular bond type. The torsion bonds are defined with three successive bonds and four particle positions as following:

 =  kij [1 + cos(ni i + i )]


( 27)

In addition to the EAM potential, if electrostatic forces are significant, they can be modelled with the use of coulomb potentials, q and inter-particle distance  :26

 =  
 

   ( 28)

Here Uelectrostatic denotes the potential created by two particles i and j, dependent on the inverse of the distance between them, rij, their respective coulomb potentials qi and qj and the electrical permittivity of space, .The total potential of the system is the sum of the individual contributing potential functions:

 =  +  +  +  +  ( 29)

26

3.2.5 Monte Carlo Methods So far, the presented methodologies have all shown a deterministic approach to molecular simulation. The main downside of such a system has been shown to be computing resources necessary to advance in time to the next incremental state of the system. The small time step dictated by the inter-atomic spacing and prevalent potential allows for only relatively short time period of modeling to be performed. Such limitation may be acceptable when the system is undergoing a very rapid change but may be somewhat less usable if the change is more gradual. Monte Carlo (MC) technique allows for probabilistic approach to a given system. Rather than analyzing the system step-by-step, it calculates the possibility of the changes within the system and advances the system along those steps. The probability of an event which will take the system to a different state is generally described by a statistical function, with particular distribution dependent on the interaction potential chosen. One immediate advantage of such an approach is that significantly less computational time and resources is required to advance in the simulation allowing for longer simulation runs, since this methodology does not require explicit resolution to the equations of motion of each particles and as a result is not bound to the typical 1-10 femtosecond time-step range required to adequately resolve particle movement. The probability functions can still be time dependent, for example increasing or decreasing the likelihood of an event occurring depending on the time step, but this is no longer required and the simulation can completely forgo time relationship altogether, simply running until a convergent energy state is reached. Monte Carlo techniques have been applied to Molecular Dynamics simulations in lieu of deterministic techniques. The main mechanism of such an application usually involves the probability distribution functions which are either applied to the system or dynamically determined throughout the simulation run. The probability distribution parameters govern the likelihood of an event that would transform the given parameters of the system to a value beyond the local minima. This can be illustrated with an example of position displacement of a single particle within the crystal structure. Because of the vibration of each atomic particle the deterministic simulation must necessarily involve time steps that are small enough to represent that movement (this by 27

extension is how the temperature is represented in a given system). This is the main reason for the small time steps necessary for the deterministic methodologies. However these small movements of the atomic particle do not change the global energy level nor do they affect the local energy level when taken over a time period, since the atom effectively moves about the local energy minima position. The proposition of the MC method is to exclude these movement from calculation and focus on the probability of an atom to change its position to such an extend where it would now have a new energy minima. Such a move would change the energy of the system. The main advantage of such an approach is the computational time saved and by extension the increased simulation site of the experiment.27 Such methods have been applied to both low and high density applications (with former being more common) to determine the general system properties under given conditions. This method is generally not as often used when the detailed information about particle location and local energy is required, such as in a dynamic crack propagating situation. Nevertheless it is a useful tool that allows to determine the general material properties and behaviour at an atomic level over time periods longer than what is typically possible with deterministic techniques. 3.2.6 Ab-Initio Methods On the other end of the scale are the Ab-Initio or quantum methodologies that are deterministic in nature and also model the quantum interactions of the particles in great detail. Because they forgo the approximations of the Newtonian dynamics, in favour of higher accuracy they are also highly computationally expensive. Carr-Parrinello method was developed to model the interatomic interaction while considering the positions and energies of electrons. This approach models the electron orbital positioning and associated energies. It allows for the modeling of atomics (nuclei) behaviour as well as electron behaviour and as such offers the ability of modeling electrical properties of material.28 The movement of the atomic nuclei in this case is still modeled according to the classical Newtonian mechanics, however there is no empirical potential function explicitly set up to determine the inter-atomic interactions. Instead the electron location and energy level is tracked in addition to the atomic nuclei. The electron potential is what determines the inter-atomic interactions (in addition to atomic nuclei). 28

This method provides an initio methodology for molecular dynamics simulation as it derives the inter-atomic forces from the first principles of particle interaction rather than a potential function. As such this method can theoretically be applied to wide variety of cases and is not limited to a particular simulation subgroup (such as metals, gasses, protein chains, etc.). The main challenge in using this method is the computational expense at which the added accuracy and versatility come. The typical simulation times are measured in picoseconds (10-12 s) rather than nanoseconds (10-9 s). The simulation size is also reduced by several orders of magnitude to typically several thousand atoms.

3.3 Potential Function Application to Molecular System Simulation 3.3.1 Potential Function Application The Embedded Atom Method (EAM) has been shown to be a very convenient and accurate way of modeling of the metallic materials. The application of this function to the MD simulation however requires the calculation of the forces acting one each atom in the simulation. This is accomplished through the derivation of the force potential as a gradient of the total system potential:29


 = -  [ 
=1 

( ) ( )     )( )] +( + , 1      , ,  |  | ( 30)

Where the first term describes the pair potential interaction between atoms and the second term describes the embedding potential functions. The forces calculated according to the equation (30) are then used to determine the acceleration, velocity and the new position for each of the atomic particles. In order to save on the computational resources and increase the speed of the simulation it is possible to omit the computation of the above force interaction between the atoms that are too far away. In order to do this without impacting the accuracy of the algorithm in a meaningful way it 29

is first important to determine the circumstances under which this approximation can be applied. Firstly, for the pair-interaction potential it can be assumed that for a particle that is surrounded by other similar particles in all directions (i.e. when the simulation has similar boundary conditions in all directions) the pair potential interaction in all directions beyond a certain close radius would be the same. Similar reasoning can be used for the embedding function, since only nearby atoms will contribute the electrons used in the calculation of the embedding function. By employing this reasoning it is possible to reduce the computational time by only computing the pair-interaction and the embedding function force components for the atoms within a certain defined interaction distance. This can be accomplished by first checking the atomic pair distance, rij, before making the force computation. As mentioned before the embedded atom method does a particularly good job of describing the bonding energies of metallic materials. Because of the ability to vary the bonding strength based on local coordination it is possible to use this method to model the important phenomena involving metals: void formation, crack development and propagation, free surface behavior, crystal boundary interactions and dislocation formation. 3.3.2 Important Physical Characteristics In order to evaluate the results received from the simulation it is necessary to be able to quarry the critical parameters. Some of the most important parameters are already available through the iterative calculations performed at each time step: Particle position, velocity and forces acting one each particle. Other parameters have to be calculated from the available date: local and global temperature gradients, kinetic and potential energy of particles, stress and strain of material. Temperature of each particle can be obtained through its velocity, mass and Boltzmann's constant:

 =

1 2 2  ( 2 +  +  ) 3  

( 31)

30

Where Ti is the temperature of each particle, vix,viy,viz are the particle velocity components, mi is the particle mass and kB is the Boltzmann constant. The local energy of each particle can be obtained through the kinetic and potential components as following:

 =  + 

( 32)

 =

1 2 2  ( 2 +  +  ) 2  

( 33)

 ( )  = 

( 34)

Here the UKi and UPi represent kinetic and potential energy of particle i respectively, while Ui represents the total energy of a particle. The potential energy is a function of embedding function   ( ). As mentioned earlier the behaviour of the material at nano- and micro-scale is very seldom isotropic and as such depends on the crystal lattice orientation.

    

( 35)

 =

   ;  = ;  =   

( 36)

The average stress within the atomic system can be evaluated using Virial stress. Virial stress, gives the average stress of N atoms in the given volume, V.30

31

1  = -  
=1



1       +  2 [
=1 



 (     ) ] ( 37)

The right side of the equation is made up of two components. The first component depends on the atomic velocities, and therefore is a measure of stress due to thermal forces; the second component is the measure of inter-atomic forces and is a measure of internal stresses due to inter-atomic bonds (described by Lenard-Jones and EAM formulation). The    is the velocity of atom i,  is the force exerted by atom i on atom j,  is the mass of atom i. The  operator denotes the Kronecker tensor product, defined as:    = [              ]  

( 38)

The stress given by this equation must balance with the external applied stress on the system. Virial stress provides an average stress within the atomic simulation environment, but does not provide the local stress values which may be required in the areas of high stress concentration including inclusions, dislocations and crack nucleation and propagation sites. Typically the volume at which the stress would be evaluated would correspond to an atomic particle (nucleus) and the volume surrounding it. This method would therefore provide a local force distribution and can be used to evaluate local stresses due to discontinuities, voids, inclusions, cracks, dislocations and other defects.

32

4. Molecular Dynamics Simulation Boundary Conditions
4.1 Physical Boundary Conditions 4.1.1 Outline Boundary conditions play a very important role in molecular dynamics simulation and are a critical condition to consider in any scale transition model. The boundary condition can be broadly separated into three categories: free surface boundary condition, repeating boundary condition and interface. In this section these boundary conditions and their effects will be examined for implications to MD simulation through widely accepted methodologies that have been developed for this purpose: statistical ensembles and boundary condition definitions In order to create a realistic molecular dynamics simulation it is necessary not only to accurately represent the inter-atomic interactions, but also examine the physical environment and characteristics which affect the model. These are represented by two methodologies outlines in this section: boundary conditions and statistical ensembles. Boundary conditions are used to accurately model the boundaries of the simulation space and the resultant effects on the model space. The statistical ensembles are used to represent overreaching phenomena associated with any particular simulation model including, volume, temperature and energy limits of the system that may not be captured or maintained with the relatively small physical scope of MD simulation. The boundary conditions encountered at micro-level can be roughly subdivided into three categories. The repeating boundary condition describes the boundary behaviour of the modeling space that is located on the inferior of material, within the bulk; the surface boundary condition is used to describe the space that has at least one surface lying on the surface of the material, exposed to vacuum, or another substance with small amount of interaction (i.e. air); lastly the crystal boundary condition is used when the model contains a crystal lattice boundary between two or more crystals. The latter condition is typically most challenging to model as it can contain various crystal orientations, geometries and local irregularities. The statistical ensembles are often used to model the general system conditions that may otherwise `drift' if the simulation space alone was allowed to develop under the guide of any 33

given inter-atomic potential setup. The statistical ensembles can be used to hold certain physical parameters constant (or more realistically within a specified narrow band) throughout the simulation run. These can include temperature, volume or the overall energy of the system, to better approximate the bulk material properties.

4.1.2 Repeating Boundary The typical size of the MD simulation space usually incorporates on the order of 105 to 106 particles. This number is often smaller than the single crystal grain sizes found in most materials. The modeling space would therefore be surrounded by similarly structured material extending in all directions for significant (in micro-scale terms) distance. The most common way of treating this kind of boundary is though the so-called repeating boundary condition. This type of boundary essentially models continuous (within micro-scale) material extending beyond the simulation space in all directions. The type of boundary conditions calls for the extension of the physical properties beyond the boundaries of the simulation, but uses the movement in the MD simulation space to mimic the comparable movement of particles beyond the periodic boundary. Although the number of the spaces beyond the primary simulation space can theoretically be very high, in practice it is usually limited to no more than two or three as it provides a reasonably good approximation in most modeling cases and saves on computational resources. 4.1.3 Surface Boundary This type of boundary condition exists when the modeling space has one or more free surface which is not in contact with another solid material. Because this work deals with solid and particularly metallic substances, the free boundary would be considered surface exposed to gas, fluid or vacuum. As such, some particle interaction may be necessary to model but it cannot be treated in the same way as the periodic boundary described above. One important characteristic of metallic boundary condition is the perceptible (on atomic scale) shortening of the bonding distance in the surface boundary31, as shown in Figure 7. This occurs due to the aforementioned variation of bond strength with increased co-ordination. Since the

34

atoms in the boundary layer have smaller degree of coordination their bonds exhibit stronger attractive potential and as a result draw the atoms in the boundary layer closer together.

Figure 7. Surface vs. Bulk Particle Bond Distances for Metallic Compounds

4.1.4 Crystal Boundary Crystal boundary condition is a special type of constraint where one of the surfaces of the modeling space forms a boundary with another crystal. This type of boundary condition is necessarily different from the two mentioned above as it generally cannot be modeled using periodic boundary while at the same time can have a very complex surface geometry which plays a large role in inter-crystalline bonding. The modeling of this type of boundary condition is most complex of the three and has been approached in different ways by different researchers and will be examined more in depth in subsequent chapters.

35

4.2 Statistical Ensembles 4.2.1 Statistical Ensemble Overview Any molecular simulation, if left to run with the guidance of potential only, will eventually evolve into a system that has little resemblance to the actual physical behaviour of material. There are several reasons for this. Firstly, the model can only recreate a small part of a much bigger material and as such requires boundary conditions (as described above) that would mimic the true behaviour of atoms near the boundary. Secondly, the system may be subject to the external constraints that cannot be modeled by the potential function (since the potential function is explicitly a property of system particles only), such as constant temperature, constant energy or particular variation in one or both. Thirdly, small errors in calculations may increase or decrease the total energy level of the system creating a different physical reality than what is to be expected. Statistical Ensembles are generally used to take care of these phenomena and impose general conditions on the system. They can include very general requirements including variability of the total energy of the system, or can be applied to certain parts of the system selectively, as in the case of boundary conditions. Micro-canonical ensembles, or NVE, require that the number of particles, the volume and total energy of the system remains the same (in practice it is limited to a certain range E +E). A more general case is the canonical ensemble, or NVT, which allows the total energy of the system to fluctuate while still keeping the number of particles, the volume constant. In addition the temperature of the system is kept constant as well by tying each particle to a heat sink. A further generalization leads to a grand canonical ensemble which incorporates all of the elements of the canonical ensemble but also allows the transfer of particles from and to the system. The temperature is still kept the same via a heat sink.32 The use of these ensembles provides a convenient way of modeling the system according to a set of desired boundary conditions and external environment. This provides the second control method (after inter-atomic potential functions) over the particle interactions within the system.

36

4.2.2 System Equilibrium In order to maintain the simulation on the realistic course it is important to identify and maintain the system equilibrium characteristics. Depending on the type of system being modeled these may vary and encompass a wide range of properties: number of particles (most usual), temperature (relative atomic velocities), energy, and volume. The particular equilibrium constraints depend on the type of simulation being performed (general physical conditions) and the individual particle positions within the simulation (boundary conditions). System equilibrium may be maintained through the application of a statistical ensemble on the entire system or selective application of different ensembles on the various parts of the simulated space depending on the relative position and velocities of each particle. The former approach is most computationally efficient; however the latter approach is usually used in some form to accurately model the interaction with the material adjoining to the simulation space. The equilibrium is usually maintained through global or local scaling factors that are applied to all or selective atomic particles with respect to their velocity and sometimes position. Typically, after each time step iteration the equilibrium properties of the system are checked and the scaling factor is applied if the values are required to be brought back to the acceptable range. To save computational resources these scale checks are sometimes done after several time-steps if the system behaviour in general is not expected to change rapidly. 4.2.3 Interaction with Boundary Conditions In a simulation where stress is imposed on a set of atomic particles, the resulting moment of the atoms will increase indefinitely. This of course does not correspond to reality where particle movement is slowed down by interaction with neighbouring sections of material (in effect what is perceived as heat dissipation on a larger scale). The MD model however does not inherently have a capability to represent this phenomenon since it only has a set number of particles under consideration.33 This has given a rise to different methodologies that strive to account for moment transfer interactions with outside particles while maintain the integrity of the model and preserving acceptable computational resource requirements. One approach is to remove or add kinetic 37

energy to the system by scaling all particle velocities by a global factor that will maintain the same constant temperature level of the system. Another approach is to couple each particle to a local heat sink that will adjust the velocity of the atom by an individual constant that will simulate the inter-particle interactions with respect to velocity gradients. This approach is usually applied to the outer atoms of the model that allows them to mimic heat dissipation through interaction with surrounding material. Both of these methods have been used in MD simulations to obtain the constant temperature requirements imposed by the simulation framework.34 The above method corresponds to the canonical ensemble specified earlier, where the number of particles, volume and temperature remain the same. This is the most typical ensemble used in MD analysis. Although strictly speaking the particles may leave the simulation range, any given particle is typically replaced by the similar one entering the modeling space with the same energy from the space surrounding the model envelope. In certain cases however it may be beneficial to use the micro-canonical or grand canonical ensembles to better simulate the physical phenomena under investigation. The micro-canonical ensemble is predominantly used in the systems where the initial energy level is precisely known and conserved throughout the modeling phase. The grand canonical ensemble is used in the systems where significant mass transfer is expected to occur during the simulation timeframe.

38

5. Molecular Dynamics Models Using Constant Time Step Methodology
5.1 Outline In this chapter the molecular dynamics behaviour of particle simulation is examined under constant time-step regime. The purpose of this chapter is to establish the typical simulation behaviour of particles under various thermal and structural boundary conditions. The majority of the work covered in this chapter was conducted in order to validate the underlying molecular interaction methodology used by the author against the existing works and provides the foundation for the novel time-step variability approach that is presented in chapters 6 and 7.

5.2 Variation of Properties Under Changing Thermal Conditions Structural properties of materials can differ significantly on nanometer to micrometer scale from those observed on the more conventional size scale. In the case of metallic materials the isotropic properties no longer apply as the effects of crystal lattice orientation become significant. In addition temperature plays a significant role governing the rate of void and self-interstitial formation as well as local particle energy. The use of materials on such small scales is becoming increasingly prevalent in the growing nanotechnology industry and as a result requires accurate and definitive theories of material behaviour, structural and thermal properties and failure mechanisms. In order to better understand the mechanisms of failure formation and propagation in metallic compounds on nanometer to micrometer scale it is therefore important to study the material properties' range based on some of the key factors: the orientation of crystal lattice, ambient temperature and the external loading. Because of the challenges associated with physical testing of materials on such a small scale, simulation methods have been proposed and successfully implemented to achieve the same goals. In the case of metallic materials, semi-empirical, deterministic methodologies based on Newtonian mechanics have been used to accurately predict behaviour and properties of materials. 39

The present research has examined the strain and stress behaviour of BCC crystal wire structure as related to the temperature, defect rate as well as the crystallographic orientation (Figure 8). For this purpose the present works examines a BCC crystal structure modeled with an MD algorithm using an EAM35,36,37 model for pure Copper (Cu) crystals38,39. The material strength was observed through the variation in strain and stress behaviour of the nano-wire as a function of temperature, external loading, and crystallographic orientation. The simulation was

performed over a large number of time-steps to ensure an equilibrium stage was feasible and reached under the given conditions.

Figure 8. Molecular Dynamics Model Properties: A Cylindrical Nano-Wire with BCC Crystal Structure The material sample was modeled in the form of a wire, with a radius of 20 angstrom and the length of 100 angstrom, aligned in <100>, <110> and <111> crystallographic directions as shown in figure 1. The boundary conditions imposed on the simulation modeled the free boundary conditions on all sides, in effect representing the single crystal simulation, placing no additional restrictions on particle movement, except for the externally applied pressure in the direction of the wire axis at both extremities of the wire40,41. External pressure conditions included only compressive loading regimes.

40

The data was obtained through a molecular dynamics simulation using semi-empirical deterministic methodology based on EAM (Embedded Atom Method) inter atomic potential of the following general form42:

  ( ) +    ( )  =  
  <

( 39)
  ( ) is the embedding energy as function of Where  ( ) represents the pair potential, and  pi, the density of the electron cloud produced by surrounding atoms. The pair potential used in this study is described as:

 ( ) = - [1 +  (

  -( -1) - 1)]   

( 40)

And the embedding energy is described as:

  ( ) =     
Where the electron density function  is obtained as following:
-(
 -1) 

( 41)

 =  

( 42)

Here  and  are material specific constants used to define potential and density curves. The simulation space that is used to obtain the material properties was constructed with the use of boundary condition specifications, statistical ensemble routines and a deterministic potential methodology. The crystal structure is initialized with given material properties and conditions and is evolved through given time increments until equilibrium is reached or until it is clear that the system is dynamically evolving without the possibility of equilibrium. The analytical methodology selected for the simulation study is based on the Embedded Atom Method as described in equation (39). This equation describes the potential energy relation 41

between the particles within the simulation based on the pair potential and the embedding potential energy. Once calculated the potential energy can be used to obtain the forces acting on each particle through the following equation in gradient form43:

 = -   ( 43)
Or as a function of potential function terms:


 = -  [ 
=1 

( ) ( )     )( )] +( + , 1      , ,  |  | ( 44)

In addition to the internal forces the external pressure can be modeled as a set of orthogonal hydrostatic forces. In the form of:

  = [ 0 0

0  0

0 0] 

( 45)

In the present work only  component was applied. The external forces on each affected particle can then be determined through the following formulation:

  =  

( 46)

Where  is the area associated with each atomic nuclei. The area varies as a function of interatomic spacing and the crystal structure. If each particle is assumed to be associated with a spherical non ­overlapping volume, the area associated with each particle can be described as:

 =

2 4 2 2

( 47)

 =

( 48)

42

Where equation (47) describe the particle association area for FCC crystal and equation (48) describes the particle associated area for BCC crystal, and a denotes the single crystal structure cubic side. The stresses experienced by each particle were then calculated as a function of internal and applied forces and the area associated with each particle:

 =

   +  

( 49)

The particle behavior was determined using the force of each particle to calculate the acceleration, velocity and displacement as following:

 ( = 0) = 0

( 50)

  ( +  ) =

 +     

( 51)

Velocity values are usually defined through initial temperature selection and may be somewhat randomized in scale and direction from the initial value to simulate a typical atomic system. The initial velocity values are also set up such that the average velocity of the system adds up to zero to eliminate potential drift of the center of mass of the simulation. The velocity values are typically recalculated after each time step through acceleration values. Acceleration values are typically set to zero at the beginning of the simulation and recalculated after each time step through inter-atomic forces. The inter-atomic forces are described by the potential function. These functions come in several different varieties and will be covered in more detail later. The forces are recalculated after each time step through the potential function. The position and velocity of each atomic particle can described as following at the beginning of the simulation. At each time step Verlet algorithm can be used to recalculate the position and velocity from acceleration44. The Verlet algorithm is used here as it provides more accurate results by calculating the mid-step velocity and using that value to calculate the final position of particle after time interval t: 43

 ( = 0) = 1 (, ) 
= =1

( 52)

,=0 = 0 ( 53)  1 ) +  ( +  ) 2 2

 ( +  ) =  ( +

( 54) ( 55)

 ( = 0) = 2 (, )  ( +  ) =  ( ) +  ( +  )  2

( 56)

Here f1 is the function that describes the initial distribution of the particle velocities. It is typically set such that the average velocity of all particles to satisfies Boltzmann's equation (31). The f2 function is dependent on simulation temperature, which affects the spacing as well as the type of crystal structure used in the simulation. The statistical ensemble specified in the simulation specified a constant temperature bracket, number of particles, and pressure, while the total energy and volume of the system was allowed to fluctuate to observe equilibrium tendencies of the system 45. The constant temperature of the system was obtained through the use of uniform "heat-sink" that scaled the particle velocity and by extension the temperature of the system to the acceptable range46. The formulation used for the scaling is presented in equation (57):

| -  |  )  = (  ( 57)
Where  is the particle velocity,  is the average bulk velocity that corresponds to the given bulk temperature conditions,  is the allowable standard deviation for the individual particle velocity, and  is the smoothing coefficient designed to slowly bring the individual particle velocity into the acceptable range. Through experimentation it was determined that a  value of 44

1

approximately 50 is ideal to maintain the acceptable temperature range characteristics while exerting minimal control over natural particle movement and ensuring the convergence of the system temperature to proscribed levels. Crystal structure behaviour of most interest in this case was the strain behaviour of the crystal structure under applied loads in the three principal orthogonal directions as well as resultant stresses. In the cases where the crystal structure did not stabilized and strain continued to increase without convergence, a structural failure was assumed to have occurred47.

  = [ 0 0

0  0

0 0] 

( 58)

The stress of the system can be described by the virial stress theorem as following48:

 = -

1 1  [   + (  )]  2

( 59)

The external stress on the left hand side of the equation must balance out with internal stress on the right hand side, that break into two terms: the first term is a function of particle mass and velocity and therefore accounts for thermal stresses of the system; the second term is a function of inter-particle forces and represents internal mechanical stress of the system. In addition to virial stress, continuum stress, as defined in equation (49) was also observed and recorded. The strain if the system was measured in typical fashion, with the only difference being the being the relaxed length was taken as the base length of the material, as described in below :

 =

 -   

( 60)

45

The scope of the study included the study of effects of variation of simulation temperature, external applied pressure and crystallographic orientation on the stress and strain properties of the material49. The temperatures for the study were varied between 0K - 300K. The external pressure was varied from 1 - 10 GPa. Three crystallographic orientations that were considered were defined with orientation vectors of <100>, <110>, and <111>. In order to perform statistical sensitivity analysis of the relative importance of the temperature and external pressure the sample points were chosen through Latin hypercube sampling method50. The obtained distribution of temperature and external loading samples is shown in figure 9.

1E+10 9E+09 External Tensile Loading (Pa) 8E+09 7E+09 6E+09 5E+09 4E+09 3E+09 2E+09 1E+09 0 50 100 150 200 250 300 Temperature (K)

Figure 9. Temperature and External Loading sample distribution As it has been noted by other researchers51,52,53 the molecular dynamics simulation of a component with free boundary conditions, a relaxation period is typically necessary to arrive at an equilibrium representation of the free boundary region. This phenomenon has been observed in the present study as well, with the boundary region establishing a functional equilibrium within 10-12 seconds of the start of the simulation. 46

As a result the same relaxation time period has been allowed in all of the subsequent simulations followed by the uniform constant loading pressure regime. Figure 10 describes the typical loading regime followed by all simulations: a period of relaxation, with no external loading is followed by a relatively short ramp up stage, where external loading is linearly increased to desired magnitude and finally uniform loading phase that lasts until strain equilibrium is reached

Initial Relaxation Period
Applied Pressure P

Uniform Pressure Loading

time

Figure 10. Simulation Loading Regime

The observed typical observed behavior of wire under the simulation conditions is shown in figure 11. Here we observed a rapid contraction under relaxed conditions (Phase I), followed by convergence to a stable length (Phase II). Upon the application of external load the wire expanded until converging to a new equilibrium position (Phase III).

47

Figure 11. Typical Loading Regime The material behaviour has been recorded through the variation of stress, ambient temperature and crystallographic orientation of the wire. As show in figure 11 material strain increases almost linearly with the corresponding increase in tensile loading for all crystallographic

orientations until a non-linear region is reached, typically around 8-9 GPa load levels. A statistical analysis was carried out to observe the relative effect of temperature and external loading on strain behaviour in the linear expansion region where applied loading is less than 8 GPa. The results of the analysis shown in figures 12-14, show

48

Figure 12. Relative effect of change in temperature (top) and tensile loading (bottom) on sample strain for (100) crystallographic orientation

Figure 13. Relative effect of change in temperature (top) and tensile loading (bottom) on sample strain for (110) crystallographic orientation

Figure 14. Relative effect of change in temperature (top) and tensile loading (bottom) on sample strain for (111) crystallographic orientation The statistical analysis shows a slight linear correlation in strain caused by change in temperature and strong linear correlation in strain caused by change in tensile loading. The relative contributions of temperature and loading to strain variations are shown in table 2. 49

Table 2. Contribution of tensile loading and temperature to change in strain for each crystallographic configuration

The average modulus of elasticity for the linear expansion region has been calculated for each instance of crystallographic orientation and is summarized in table 3.

Table 3. Average Modulus of Elasticity for each crystallographic configuration in linear region

The elastic modulus show correlation to the planar and linear densities for each of the orientation modes shown in table 4 and is proportional to the inverse of square root of normalized linear particle density as defined in figure 15 and the square root of normalized planar density as defined in Figure 16 of the three lattice orientation as given by:

 

1 

  ( 61)

Where E is elastic modulus and  represents the linear particle density and  represents planar particle density in the direction of the loading.

50

Table 4. Linear and Planar Particle Density in the Direction of Loading for Different Lattice Orientations

P

l
Figure 15. Linear particle density, defined as linear particle count, divided by length in the direction of applied pressure, P

P
A

Figure 16. Planar density defined as number of particles divided by the area in cross section normal to the applied pressure, P 51

(a)

(b)

(c)

Figure 17. Strain variation with Applied Pressure for (a) (100), (b) (110) and (c) (111) crystal lattice orientation. The present work has examined the variation in structural properties of metallic materials with BCC crystal structure through the simulation of Copper nano-wire through Molecular Dynamics methodologies based on EAM. The results have shown that the variation in strain correlate to material temperature, and crystal lattice orientation through variations in linear and planar particle densities. The results show strong correlation of material properties including elastic modulus and strain behaviour to planar and linear crystal densities and the nature of anisotropic material properties within metallic crustal lattice. The dependency of material properties was observed to be in agreement with notable increase in elastic modulus correlated with temperature drop as shown by the statistical analysis of the strain results. Figure 19 shows the Strain results normalized with the relative linear/planar density term plotted against the applied external stress and shows the strong correlation of the anisotropic behaviour of elastic modulus to the square root of linear and planar density values. The observed failure mode in compression for the higher loading regimes, as shown in figure 18 was observed to be through shear failure rather than buckling, due to the short length of the sample geometry relative to radius.

52

Figure 18. Compressive failure mode shown with highlighted shear failure plane

2.00E-01

1.80E-01

1.60E-01

1.40E-01

BCC100 BCC110 BCC111

 

1.20E-01

1.00E-01

8.00E-02

6.00E-02

4.00E-02

2.00E-02

0.00E+00 1E+09

2E+09

3E+09

4E+09

5E+09

6E+09

7E+09

8E+09

Applied Pressure (Pa)

Figure 19. Strain results normalized with the inverse of square root of linear density plotted against applied pressure

53

6. Variable Time Step Molecular Dynamics Model
6.1 Outline This chapter provides detailed look at the proposed variable time step methodology, its derivation and applications. The methodology is examine through both the most basic two body pair interaction as well as the multi-body application and the modifications necessary to enable the methodology to function in large simulation domains. The applications include structural loading, thermal gradient and materials deposition to illustrate wide range of possible applications and the benefits achievable when using the proposed variable time step methodology.

6.2 Overview of Model The variability of time step within the molecular dynamics simulation present the common tradeoff between performance and accuracy: a shorter time interval between state calculations presents a more accurate picture of the events but requires longer time for the simulation to run. The main subject of this study is to establish the acceptable bounds of variability of the time step that strikes the right balance between accuracy and performance. Embedded Atom Method (EAM) was chosen as one of the most common MD routines to be studied. In a typical EAM simulation the potential energy function determines the energy potential between a pair of particles, while at the same time taking into account embedding potential, or a measure of how dense the space around any given particle is. The potential can then be calculated into force by numerical integration that can be applied to the particles, producing acceleration, velocity change and ultimately the new position of each particle. The time optimization studies54,55,56,57,58,59for the molecular dynamics simulations usually focus on the identifying the most optimal constant time step for a given simulation parameters including density, bond energy, mass60 or by forgoing the calculation of short range forces over a set time period and resolving the error by performing detailed calculations over longer time spans61. In this paper we look at the methodology of varying the time step throughout the

54

simulation based on energy, density and velocity parameters to minimize the error generated during each time step while minimizing the overall simulation run time. The pair-potential depends on the distance between any two particles and as such is directly influenced by the change of position that accompanies each time step. It becomes obvious then that a longer time step will increase the error associated with particle position as it applies constant potential and by extension force over a longer time period. One of the objectives of our research then becomes normalizing the error produced by the each time step by making it dependent on average or minimum particle velocity. This is one of the methods that will be examined in this paper.

6.3 Theoretical Overview of Proposed Methodology To determine the effect of variability of time step the concept was first applied to a simulation of single pair of metallic particles with embedded atom method (EAM) algorithm described in equation (39). The pair potential used in this study is described in equation (40) and the embedding energy is described in equation (41), where the electron density function  is obtained as shown in equation (42). The analytical methodology selected for the simulation study is based on the Embedded Atom Method. This equation describes the potential energy relation between the particles within the simulation based on the pair potential and the embedding potential energy. Once calculated the potential energy can be used to obtain the forces acting on each particle through equation (43) or as a function of potential function terms described in equation (44) The variability in time step was tied to the basic particle properties: velocity and inter-particle distance. The relationship that was used also took into account mass properties and variation in particle potential. The properties of the system were evaluated while under constant time step regime as well as variability in potential and kinetic energy, and the force exerted on each particle.

55

6.4 Two Body System Application Most common time step regime chosen in molecular dynamics simulation is that of constant magnitude. If we consider a single binary system of particles under pair-wise molecular dynamics simulation regime, the system will exhibit one dimensional vibration along the common axis. Plotted against time the distance between the two particles will vary as shown in figure 20. Moreover other system properties, namely the mean inter-particle potential and force exhorted on each particle (as a first derivative of potential function) will vary as shown in figure 21 with peak velocity reached concurrently with peak potential.

In order to take into account the natural properties of such system we have devised a time step formulation described in equation 62. Here the potential P and the force, described as the first derivative of potential
 

are both considered through an inverse exponential ratio that time step

increments get smaller as either Potential or Force values of the system get large.

 =

 (1 - )  +    / ( 62)

The experiments were set up to compare a high accuracy constant time step model, with the time step length on the order of 0.1 femtosecond (10-16 s), used as the control case for the purpose of this study, to the more commonly used experimental value of 1 femtosecond (10-15 s) as well as simulation where the variable time step described by equation 62 was used. The system was run of one cycle to study the in cycle error and behaviour produced by both systems as well as for multiple cycles to study the long term behaviour of the system

56

Figure 20. Particle distance (r) variation with time during single cycle

Figure 21. Particle potential and force variation with time during single cycle

57

The first order of experimental analysis was to determine the effect of n or proportionality constant on the time step results. Using the single cycle simulation, the time step formula was varied with n values ranging from 1/9 to 8/9 with the particle position compared to the control case. The results are shown in figure 22, with the least error reached when n values is 6/9 or 2/3. Looking at the error distribution during the single cycle, shown in figure 23, shows not only the reason the particular ratio produces the least error, but also the important phenomenon of error value symmetry, which minimises the sum of all error values during the single cycle. Comparison of the error distribution achieved in the variable time step method to that of the constant 1 femtosecond method is shown in figure 24, where the peak error is higher for the variable time step, but the sum error over single time step is higher for the constant time step method.

Figure 22. Variation of mean position error for variable time step models with the change in n parameter

58

Figure 23. Variation of particle position error during single cycle for variable time model with different n parameter values

Figure 24. Comparison of position error during single cycle for constant time step and variable time step models 59

The model was also evaluated over a long time period to ascertain long term stability of the system. Both constant time step and variable time step models performed with the same degree of stability. The position error and time required to calculate the behaviour of the system over a defined period were compared for the constant and variable time step model. It has been observed that variable time step model described by equation 63, produces smaller error than the comparable constant time step model while taking same time to compute.

 =

2  + 3 3 /

( 63)

Alternatively, by varying the base time step the variable model can be adjusted to produce the same error as the constant time step model while taking less time to execute. The summary of the comparison between these two variable time step models and the constant time model is shown in table 5.

Table 5. Comparison of error and cycle computation time for two variable time step models and one constant time step model
Mean position error (%) Constant Time step Variable Time step 1 Variable Time step 2 0.17 0.13 0.17 Cycle time (s) 30.0 30.0 23.7 Error diff -24% 0% Time diff 0% -21%

As the results in table 5 show the proposed method of time step calculation will enable a significantly faster run time for a given simulation setup or will provide a more accurate model results if the same run time length is maintained. For large systems either single or multiple time domains may be set up throughout the simulation, grouping the domains with high energy, density or active processes (i.e. active crack propagations) separately from the more peripheral areas of simulation, thereby only increasing the computational resources where warranted by simulation conditions, and varying these domain as simulation conditions change.

60

6.5 Large Model Application The two pair model discussed above illustrates the benefits of variable time approach. However, in order to apply this principle to large scale models several important considerations must be taken into account. In general any sizable molecular dynamics simulation has a lot of 'noise', in other words the local energy parameters change and fluctuate often and an average energy of the system by itself may not be a good indication of how time scale can be varied. In this case a large model may be broken down into sections that have similar energy levels where time scale can be varied individually. In order to simplify the computations the variable time scale have to be multiples of the base time scale parameters. The sectors where local average energy is close to the global average the time scale will remain same as the base time scale, in the sectors where local energy is higher the local time scale will be smaller, and in the sectors where the local energy is smaller the time scale will be larger.

=

_ - _ _

( 64)

 =  }  >    < 

( 65)

 =  } < 

( 66)

 =

1 }  >    

( 67)

61

Where k is a set of integers 1,2,3,...,k. The local cut off energy levels as well as the magnitude of time scale amplifications may be varied depending on the simulation parameters. This approach promotes the most efficient use of computational resources proportionally focusing on areas of high potential and kinetic energy. Equations (65) - (67) can be subdivided into more discrete domains if required by the simulation, where the energy range and variance are very large. The potential used in the simulations and the equations of motion associated are based on the Embedded Atom Method described earlier in this work, with the detailed derivation62 shown in Appendix A. The potential curves based on the pair particles distance and particle density for Copper and Nickel, used in the simulations presented further in this chapter, are shown in Appendix B. Figure 25 provides an overview of the methodology employed in time-domain discretization based on system and sub-domain energy levels. The energy (kinetic and potential) is calculated for each sub-domain of the simulation, and compared to the system energy.

62

Figure 25. Variable Time Step Logic. Division of Simulation Into Multiple Time Domains Depending on Local Energy Levels
63

If the local system is found to be within the average limits, defined as a number of standard deviations above and below the mean, the time-step assigned to the sub-domains remains same as the base specified for the simulation. If the local sub-domain energy level is above the average threshold the multiplication the multiplication factor is applied based on the predefined parameters. This rate could be uniform beyond the average energy threshold or can be further increased further with the increase in sub-domain energy. The principle is to decrease the timestep for the sub-domains compared to the base time-step such that the recalculation of the particle dynamics happens more often than the simulation average. If on the other hand the subdomain energy level is below the average threshold the inverse multiplication factor is applied, with the aim of increasing the time-step for these sub-domains, such that the particle dynamics are recalculated at much slower rate than the base time step. Figure 26 illustrates an example of time-step length dependence on energy distribution. In this example any sub-domain with local energy with one standard deviation from the mean will have base-time step applied without any modification. The particles in these sub-domains will be recalculated every tn seconds. The sub-domains with energy between one and two standard deviations above average will have a 1/2 factor applied to the time step, effectively calculating the local particle dynamics twice as often as average. For sub-domains with energy level above two standard deviations from mean, the time-step multiplication factor is further reduced to 1/4, meaning that sub-domains with these energy levels will be recalculated four times as often as average. On the other end of the spectrum, where sub-domain energy falls between one and two standard deviations below the mean energy level, the time-step is multiplied by the factor of two, effectively doubling the recalculation time period for particles in these sub-domains. For subdomains with energy levels lower than two standard deviations from the mean, the time-step factor is further increase to four, with particles now recalculated at a quarter of normal rate.

64

Figure 26. Normal distribution of energy and a representative time-step calculation applied to base time-step tn

In order to illustrate the benefits of variable time step several sets of simulation experiments were conducted. The behaviour of metallic pin under compressive loads, the thermal expansion under variable thermal boundary condition and metallic deposition process were simulated using variable time-step as well as conventional constant times-step methodologies. The results from both methodologies were compared to the base model that was simulated using constant timestep methodology but at 1/10 of the time step, thus providing more accurate simulation results. The benefits associated with variable time-step methodology over the conventional constant time step were measure using relative error in kinetic energy, as shown in equation (68), and stress, as shown in equation (69), between the simulations employing each of the methods and the control

65

simulation. In addition to error values, the computational efficiency was also measure comparing time required in seconds to calculate one femtosecond of the simulation.  =  - _ _

( 68)

 =

 - _ _

( 69)

6.6 Code Overview The program written to accommodate the simulations has employed the general molecular dynamics methodology with the ability to subdivide the simulation into local domains to calculate the local as well as global energy levels. A high level diagram of the code is shown in figure 27. First, the particle sets are created based on the desired crystal lattice type and orientation, the initial physical values of the system are set and boundary layers, including mechanical and thermal are applied. The system then loops over the time-steps, each time progressing by the either fixed time-step, in case of classic constant time-step simulation, or by the on-the-fly calculated lowest required time-step determined by the variable time-step methodology. During each time step the pair potential, particle density and potential-density calculations are made to determine the local dynamics of particles. If simulation is employing classic constant time-step methodology all particles are recalculated each time-step, if variable time-step methodology is used particles are recalculated according to the local sub-domain timestep intervals. For each recalculated particle, the updated force, acceleration, half-step and fullstep velocities as well as position is determined.

66

Figure 27. Program Flow Chart

Following that general system properties, including energy and stress are recalculated. The cycle is then repeated until simulation end time is reached. For variable time-step methodology an 67

additional step of recalculating the local sub-domain energy and determining the local time-step intervals is executed once the previous time-step assignments are complete. 6.7 Methodology Application Example ­ Compressive Force Application Metallic copper pin in FCC crystal configuration under compressive loading was simulated using the conventional constant time-step as well as proposed variable time-step methodologies. The simulation setup consisted of metallic pin as shown in figure 28 with compressive loads of 1 Newton applied to the ends of the pin. Three simulations were conducted two using constanttime step methodology with time-step lengths of 1fs and 10fs respectively and a variable timestep methodology with a base time-step of 10fs. The accuracy of the 10 fs simulations was compared to the control case of 1 fs time-step, comparing system energy level (potential and kinetic) as well as mean and maximum system stress.

Figure 28. Setup for compressive pin model. Including model dimensions and loads applied.
68

The simulation goal was to model the compression of the metallic pin under load and observe the stresses present in the sample as well as the variation in system kinetic energy. The system was modeled until an equilibrium state was reached after about 2000 fs. The system was observed to compress under loading and exhibit gradual increase in stress, until equilibrium levels started to be reached around 1500 fs mark. Figure 29 shows the three snapshot of the simulation, at the 50 fs, 1000 fs and 1900 fs marks showing the particle stresses.

Figure 29. Compressive model simulation snapshots at 50fs, 1000fs and 1900fs, shown with stress results

The simulation was repeated three times, with control case, classic time-step method and variable time-step method evaluated. The mean kinetic energy and stress values were evaluated and used in calculation of energy and stress error values as per equations (68) and (69). Mean kinetic energy error values are shown in figure 30, plotted against the time-step, shown for every 200 fs of simulation. In general the error for both variable and constant time-step methods was

69

observed to increase rapidly at start before reducing and settling in the 2%-6% range for the rest of the simulation
12% 10% 8% Ek Error (%) 6% 4% 2% 0% 0 200 400 600 800 1000 1200 1400 1600 1800 2000 Time Step (fs)

Constant Time-Step Variable Time-Step

Figure 30. Mean kinetic energy error for constant and variable time step simulations plotted against time

The rapid increase in error values at the start of the simulation is due to the high surface particle activity at the start of the simulation due to the surface effects causing the contraction of the outer layer of particles. For the entirety of the simulation the variable time-step methodology has shown a lower error value as can be seen from the figure 30. Mean stress error values are shown in figure 31, and in general follow the pattern similar to the kinetic energy error, experiencing rapid increase before settling in the general range of 15%-30%. Again, the error values recorded for the variable time-step methodology have been observed to be lower than those for the constant time-step methodology.

70

40% 35% 30% Stress Error (%) 25% 20% 15% 10% 5% 0% 0 200 400 600 800 1000 1200 1400 1600 1800 2000 Time Step (fs) Constant Time-Step Variable Time-Step

Figure 31. Mean stress error for constant and variable time step simulations plotted against time

The summary of the average mean error values as well as computation efficiency of the two methods is presented in table 6. The variable time-step methodology has been observed to reduce the mean kinetic energy error by an average of 17% while reducing the mean stress error by an average of 13%. The computational efficiency was observed to be nearly identical with a very slight speed up observed for the variable time-step methodology.

Table 6. Error and computational efficiency summary for pin compression simulation
Simulation Type Average kinetic energy error (%) Average stress error (%) Avg. computational efficiency (seconds/fs of simulation) Constant Time-Step Variable Time-Step 5.8 % 4.8 % 71 21.5 % 18.6 % 3.22 3.20

The result obtained in this experiment illustrate how the variable time-step methodology can deliver more accurate results while maintaining the computational efficiency. If conversely, the accuracy of the constant-time step was deemed to be acceptable, the variable time-step methodology could have been used to increase the base-time step of the simulation, until the accuracy was matched, but the computational efficiency was improved, allowing for longer simulation runs or larger models to be studied with same computational resources.

6.8 Methodology Application Example ­ Thermal Expansion In this simulation, metallic copper pin in FCC crystal configuration was once again used, with slightly larger simulation space, now containing 1600 particles. Thermal gradient was applied to the system as shown in figure 32, to study the kinetic energy variation as well as thermal stress created by the temperature gradient. Three simulations were once again conducted two using constant-time step methodology with time-step lengths of 1fs and 10fs respectively and a variable time-step methodology with a base time-step of 10fs. The accuracy of the 10 fs simulations was compared to the control case of 1 fs time-step, comparing system kinetic energy level as well as mean and maximum system stress.

The simulation goal was to model the kinetic energy and thermal stress of the metallic pin under thermal gradient and observe the stresses present in the sample as well as the variation in system kinetic energy. The system was modeled until an equilibrium state was reached after about 1800 fs. The system was observed to expand under thermal boundary conditions, with expansion volume increasing with temperature as expected. Figure 33 shows the three snapshot of the simulation, at the 50 fs, 1000 fs and 1900 fs marks showing the particle stresses.

72

Figure 32. Setup for thermal expansion simulation. Including model dimensions and temperature gradient.

Figure 33. Thermal expansion model simulation snapshots at 50fs, 1000fs and 1900fs, shown with kinetic energy results
73

The simulation was repeated three times, with control case, classic time-step method and variable time-step method evaluated. The mean kinetic energy and stress values were evaluated and used in calculation of energy and stress error values as per equations (68) and (69). Mean kinetic energy error values are shown in figure 30, plotted against the time-step, shown for every 200 fs of simulation. In general the error for both variable and constant time-step methods were observed to again increase rapidly at start before reducing and settling in the 5%-15% range for the rest of the simulation

50% 45% 40% 35% Ek Error (%) 30% 25% 20% 15% 10% 5% 0% 0 200 400 600 800 1000 1200 1400 1600 1800 2000 Time Step (fs) Constant Time-Step Variable Time-Step

Figure 34. Mean kinetic energy error for constant and variable time step simulations plotted against time

In this case the rapid increase in error values at the start of the simulation was due to the high rate of particle expansion at the start of the simulation while slowing down as the system reach equilibrium values. For the entirety of the simulation the variable time-step methodology has shown a lower error value as can be seen from the figure 34. Mean stress error values are shown in figure 35, and have exhibit a more uniform level of error throughout the simulation, remaining in the range of 30%-60%. Again, the error values recorded for the variable time-step methodology have been observed to be lower than those for the constant time-step methodology. 74

70% 60% 50% Stress Error (%) 40% 30% 20% 10% 0% 0 200 400 600 800 1000 1200 1400 1600 1800 2000 Time Step (fs) Constant Time-Step Variable Time-Step

Figure 35. Mean stress error for constant and variable time step simulations plotted against time
The summary of the average mean error values as well as computation efficiency of the two methods is presented in table 7. The variable time-step methodology has been observed to reduce the mean kinetic energy error by an average of 33% while reducing the mean stress error by an average of 17%. The computational efficiency was also observed to be better for variable timestep methodology.

Table 7. Error and computational efficiency summary for thermal expansion simulation
Simulation Type Average kinetic energy error (%) Average stress error (%) Avg. computational efficiency (seconds/fs of simulation) Constant Time-Step Variable Time-Step 16.2 % 10.8 % 47.6 % 39.3 % 4.55 4.12

75

The result obtained in this experiment illustrate improvements in both error reduction and computational efficiency that can be achieved with the variable time-step methodology. The base time-step can further be adjusted up (to improve computational efficiency further at the expense of accuracy) or down (to improve accuracy at the expense of computational efficiency) until desired combination of accuracy and computational efficiency are reached. 6.9 Methodology Application Example ­ Deposition Process In this case a highly dynamic system representing particle deposition of nickel onto same metal substrate was modelled. The highly dynamic system, representative of the coating deposition and additive manufacturing process, was predicted to highly benefit from the variable time-domain methodology, chiefly because of the combination of high energy gradient and similar energy level cluster concentrations typically expected in these situations. The simulation was setup as shown in figure 36, with substrate and deposition cluster. The deposition cluster was given an initial velocity to simulate the deposition process. Nickel in FCC crystal lattice orientation was used for both substrate and the deposition cluster as shown in figure 37.

24 Å

20 Å
90 Å

Figure 36. Setup for metal deposition model. Including substrate and deposition dimensions.
76

Figure 37. Default orientation of Nickel in substrate and deposition

The simulation was run for 1000 fs, while kinetic energy and particle stress values were observed. A snapshot of the simulation is shown in figure 38, with kinetic energy values plotted at 100 fs, 300 fs, 600 fs, and 900 fs marks. The simulation was again repeated three times, with control case, classic time-step method and variable time-step method evaluated. The mean kinetic energy and stress values were evaluated and used in calculation of energy and stress error values as per equations (68) and (69). Mean kinetic energy error values are shown in figure 39, plotted against the time-step, shown for every 100 fs of simulation. In this case the error values were observed to climb throughout the presentation, owing to the highly dynamic system development only reaching equilibrium towards the end of the simulation time, with the error values fluctuating from 1%-10%.

77

Figure 38. Metal deposition model simulation snapshots at 100fs, 300fs, 600fs, and 900fs shown with kinetic energy results

12% 10% 8% Ek Error (%) 6% 4% 2% 0% 0 100 200 300 400 500 600 700 800 900 1000 Time Step (fs)

Constant Time-Step Variable Time-Step

Figure 39. Mean kinetic energy error for constant and variable time step simulations plotted against time
78

Variable time-step methodology has shown to generally reduce the errors, with the different more pronounced as the simulation developed, as shown in figure 39. Mean stress error values are shown in figure 40, and have exhibit a more uniform level of error throughout the simulation, largely remaining in the range of 5%-20%. Again, the error values recorded for the variable time-step methodology have been observed to be lower than those for the constant time-step methodology.
30% 25% 20% 15% 10% 5% 0% 0 100 200 300 400 500 600 700 800 900 1000 Time Step (fs)

Stress Error (%)

Constant Time-Step Variable Time-Step

Figure 40. Mean stress error for constant and variable time step simulations plotted against time

The summary of the average mean error values as well as computation efficiency of the two methods is presented in table 8. The variable time-step methodology has been observed to reduce the mean kinetic energy error by an average of 37% while reducing the mean stress error by an average of 36%. The computational efficiency was also observed to be significantly better for variable time-step methodology.

79

Table 8. Error and computational efficiency summary for metal deposition simulation
Simulation Type Average kinetic energy error (%) Average stress error (%) Avg. computational efficiency (seconds/fs of simulation) Constant Time-Step Variable Time-Step 5.4 % 3.4% 12.2% 7.8% 14.3 11.9

As expected this type of simulation has benefitted greatly from the variable time-step methodology, recording significant improvement in both error values and the computational efficiency.

80

7. Discussion
As shown in chapter 6 the proposed variable time-step methodology can provide significant benefits compared to classic constant time-step methodology. In the simulation cases considered in this work, the reduction in error of up to 35% was obtained for both mean kinetic energy and particle stress values. By allocating the computational resources to the areas of relatively high kinetic and potential energy the variable time-step methodology provide both faster computational cycle and more accurate results. This benefit is observed to increase in systems with high energy gradient as well as the systems that are in general composed of few relatively high energy clusters. The latter can be identified by having larger mean to median kinetic energy value ratio. This trend has been observed in the simulations conducted in chapter 6. Figure 41 shows the increase in the ratio of computational cycle time of constant to variable time step methodologies, indicating that variable time-step methodology is more efficient, with the increase in Mean/Median kinetic energy for the deposition simulation. The data shows a nearly logarithmic trend with the benefits eventually tapering off.
1.60

tconstant (s/fs) / tvari1ble (s/fs)

1.50 1.40 1.30 1.20 1.10 1.00 0.90 0.80 0.70 0.00 1.00 2.00 3.00 4.00 5.00 6.00 7.00 8.00 9.00 Mean/Media Kinetic Energy

Figure 41. Ratio of cycle time (seconds/fs) required to advance the simulation of constant time-step to variable time-step methodologies plotted against mean/median kinetic energy of the system
81

Similar trend has been observed for the error difference between the constant and variable time step methods. With the increase of mean to median kinetic energy the difference between the errors produced by two methods (here the higher difference indicates the greater accuracy obtained by variable time-step method) also increases, as shown in figure 42, which track the values for differences in stress error in thermal expansion simulation against the mean/median kinetic energy
14%

12% ER (constnt) - ER(variable)

10%

8%

6%

4%

2% 1.0 1.1 1.2 1.3 1.4 1.5 1.6 Mean/Median Kinetic Energy

Figure 42. Difference between mean stress error between constant and variable time-step methodologies, plotted against Mean/Median kinetic energy ratio

82

These results are directly related to the time-step frequency recalculation mechanism, and reflect the fact that in a system with high energy gradient the high and low energy areas are more pronounced and it is therefore easier to identify which areas require more computational resources and which areas can be recalculated with much lower frequency. The highest benefits of the proposed methodology are realized in a system with fewer high energy clusters and majority of the particles falling into average or below average energy level areas. Figure 43 illustrates the mechanism by which the proposed variable time step methodology produces better results than the conventional constant time-step method. In this example there is a small high energy area surrounding the crack propagation (Region A) which has higher than average kinetic and potential energy, followed by system average area (Region B) which contains particles with average energy levels, surrounded by lower than average area (Region C) which contains particles with lower than average energy levels. Under constant time step method all particles would be recalculated with the same frequency, while under the variable time-step methodology, the particles in Region A would be recalculated twice as often as average, particles in Region B would be recalculated at the average rate, and particles in Region C would be recalculated at half the average rate.

Figure 43. Example of constant and variable time-step methodologies for a hypothetical crack propagation simulation, where high energy region is denoted by A, average energy region is denoted by B, and low energy regions is denoted by C
83

As long as number of particles in Region A is smaller than number of particles in Region C, the variable time-step methodology would yield benefit. This is the case with highly dynamic systems that model thermal expansion, structural transformation, and deposition processes, as they require a large number of particles surrounding the main process to provide realistic surrounding conditions and provide space for the event to develop. Figure 43 also implies another conclusion, namely that although overall the simulation results may be more accurate, for particles in Region C the results are actually less accurate, since the particle dynamics here are recalculated at a slower rate, and since particle in Region C usually make up the majority of the simulation, the data for the majority of the particles is actually less accurate. This is however more than mitigated by the fact that the particles in Region A are the main contributors to the system energy and stress, so providing higher recalculation rate for the particles in Region A, increases the accuracy for the overall system. The results obtained in the experiments presented in chapter 6 are scalable to larger simulations as these poses the same characteristics, namely limited radius neighbour lists, potential based on local particle density and direct pair-wise interactions, only with the larger number of particles, and can therefore assume to receive the same benefits as the simulations conducted on the smaller size scale. Conversely, the fewer benefits would be obtained for systems with low energy gradient and generally uniform energy levels. For such system, below a certain threshold the proposed methodology will no longer provide any benefit in computational efficiency or accuracy because of the computational overhead required by the variable time-step methodology to calculate and set-up discrete time-domains.

84

8. Conclusion
Present work has investigated the simulation methodology for the molecular dynamics analysis in the context of fundamental material properties at nanometer to micrometer scale and the importance of the processes and properties on this scale to an increasing number of engineering applications. The expansion of the model size and time scope allowed by the use of the variable time domains will enable larger and more accurate prediction of mechanical and chemical processes. As shown in previous chapter, the variability of the time domain is most useful when simulating the processes that yield a very large spread of potential or kinetic energy such as active structural processes (e.g. crack initiation or propagation), active chemical processes (e.g. coating deposition) and high thermal gradients (as may be the case with the engine components or microprocessor elements). In each of these cases the high energy gradient and the localized nature of the high energy domains lends itself nicely to the discrete time domain analysis. In the more uniform processes such as slow structural or thermal expansion the advantages would reduce with reduced energy level variability. The use of the presented methodology has allowed for a significant increase in both time and space scale of molecular dynamics simulations without the need for additional computational resources, by developing the sub-domain time variability principles, which allow for the prioritization of the high energy areas of the simulation. This in novel approach allows for the expansion of the semi-empirical simulation scope as shown in Figure 44, and moves the eventual goal of overlapping continuum and molecular simulation scales one step closer to reality. The time step variability and optimization methodologies proposed in this work include both pair-wise and small scale method which relies on identifying the energy level of the atomic pair during the vibration cycle and adjusting the time step increment for both of the atoms depending on the instantaneous kinetic and potential energy, as well as a large scale application of variable time step through introduction of discrete time domains for sections of the simulation, assigning fast recalculation cycles to areas of higher kinetic and potential energy concentration. Both of these methods attempt to push the boundaries of the molecular dynamics limit closer to the continuum mechanics threshold and bridge the simulation gap, that will eventually allow to perform continuous simulation of matter from smallest quantum scale up to the conventional engineering scales. 85

Figure 44. Expansion of molecular dynamics simulation domain achieved with the presented methodology
The work presented in this study can be expanded with further investigation in optimization of the discrete time domains and their relationship to local potential, kinetic energy and other factors is essential. Furthermore, greater variability of applications, including alloyed, nonmetallic and organic compounds should be investigated to gauge the extend of advantages that can be obtained under different particle interaction methodologies.

86

Appendices

Appendix A. Detailed Molecular Dynamics Formulation

Energy of the atom in Embedded Rom Method formulation:

 =  ( ) +  ( ( ))
 

( 70)

Here the first tem,( ), represents the pair-wise energy potential between two atoms, i and j, as a function of distance r. The second term is the combination of density potential function and the particle density function ( ) which depends on the particles distance r. The force can then be calculated as the negative derivative of potential function with respect to particle distance:
, , , ,  = - | + ,  +   |  

( 71)

, , Where  is the derivative of pair-potential interaction between atoms i and j, , and  are the

derivatives of the imbedding function for each of the atoms in any given pair interaction and
, , ,  is the derivative of pair-density function (in this case  and  are equivalent).

The resultant force Fi is then used to calculate the equations of motion for each atom according to the Varlet algorithm:

87

  ( + ) =

  

( 72)

 ( +  ) =  ( +

 1 ) +  ( +  ) 2 2 ( 73)
 )  2

 ( + ) =  () +  ( +

( 74)

88

Appendix B. Embedded Atom Model for Copper and Nickel

Figure 45. Distance (angstrom) vs. Potential (eV) graph for Copper

Figure 46. Distance (Angstrom) vs. Density graph for Copper

Figure 47. Density vs. Potential (eV) graph for Copper
89

Figure 48. Distance (angstrom) vs. Potential (eV) graph for Nickel

Figure 49. Distance (Angstrom) vs. Density graph for Nickel

Figure 50. Density vs. Potential (eV) graph for Nickel
90

References
1

Cox, B.N., et al, Modern Topics and Challenges in Dynamic Fracture. Journal of the mechanics

and physics of solids, Elsevier, Vol. 53, 565-596, 2005
2

Roundtree, C.L., et al, Atomistic Aspects of Crack Propagation in Brittle Materials:

Multimillion Atom Molecular SImulation. Annu. Rev. Mater. Res, Vol 32, 377-400, 2002
3

Ercolessi, F., A Molecular Dynamics Primer. Spring College in Computational Physics, ICTP,

Trieste, 1997
4

Vashishta, P, et al, Million Atom Molecular Dynamics Simulation of Materials on Parallel

Computers. Modeling and Simulation of Solids, 853-863, 1996
5

Plimpton, S. J., Hendrickson, B. A., Parallel Molecular Dynamics with the Embedded Atom

Method. Materials Theory and Modelling, MRS Proceedings 291, p37, 1993
6

Billing, G.D., Mikkelsen, K.V., Introduction to Molecular Dynamics and Chemical Kinetics.

Wiley-Interscience, New York, 2006
7

Field,M.J., A Practical Introduction to the Simulation of Molecular Systems. Cambridge. 2nd

ed. 2007
8

Bhushan, B., Handbook of Nanotechnology. Springer Varlag, 2nd ed. 2004 Berendsen, H., et al, " Molecular Dynamics with Coupling to an External bath". Journal of

9

Chemical Physics. V81, n8, pp 3684-90, 1984
10

Bhushan, B., Handbook of Nanotechnology. Springer Varlag, 2nd ed. 2004 Allen, M. P., Introduction to Molecular Dynamics Simulation. Computational Soft Matter:

11

From Synthetic Polymers to Proteins. NIC Series, Vol. 23, pp 1-28, 2004
12

Field, , M.J., A Practical Introduction to the Simulation of Molecular Systems. Cambridge.

2nd ed. 2007 91

13

Fong, Peter. Elementary Quantum Mechanics.World Scientific Publishing. Expand. Ed., 2005 Callister, W.D. Jr., Material Science and Engineering An Introduction. Wiley, 5th ed., Ch 3,

14

2000
15

Liu X.M. et al, Theoretical Strength if FCC Single Crystal Copper Based on Continuum

Model. Chin. Phys. Letters, Vol. 26, No. 2, pp 1031-1034, 2009
16

Clatterbuck, D.M. et al, The Ideal Strength of Iron in Tension and Shear.ActaMaterialia V. 51,

pp 2271-2283, 2003
17

Petch, N.J., The Fracture of Metals. Progress in Metal Physics, Vol. 5, p 1-52, 1954 Dowling, N.E., Mechanical Behavior of Materials. Prentice Hall, Third Edition, 2007 Agnew, S.R., et al., Microstructure and Mechanical Behavior of Nanacrystaline

18

19

Metals.Materials Science and Engineering. A285, pp 391-396, 2000
20

Telichev, I.Y., e al., Numerical Tensile Test of BCC Iron Crystal with Various Amounts of

Hydrogen Near Crack Tip. Computational Materials Science. Vol. 36, pp 272-280, 2006
21

Bhushan, B., Handbook of Nanotechnology. Springer Varlag, 2nd ed. 2004 Hailie, J.M., Molecular Dynamics Simulation, John Wiley & Sons, 1997 Daw, M.S, et al., Semiempirical, Quantum Mechanical Calculation of Hydrogen Embrittlement

22

23

in Metals. Phys. Rev. Letters., Vol. 50, No. 17, 1983
24

Daw, M.S., et al., The Embedded-Atom Method: a Review of Theory and Applications. Mat.

Sci. Reports., No. 9, pp 251-310, 1993
25

Stone, A. J., Theory of Intermolecular Forces., Clarenton Press, Oxford, 1996 Holm, C., Dealing With Long range Interactions: Polyelectrolytes. Computational Soft Matter:

26

From Synthetic Polymers to Proteins, 2004

92

27

Frenkel, D., Introduction to Monte Carlo Methods. Computational Soft Matter: From Synthetic

Polymers to Proteins. NIC Series, Vol. 23, pp 29-60, 2004
28

Car, R., Parinello, M., Unified Approach for Molecular Dynamics and Density-Functional

Theory. Phys.Rev.Letters., Vol.55, No. 22, 1985
29

Daw, M.S., Baskes, M.I., Embedded-Atom Method: Derivation and Application to Impurities,

Surfaces and Other Defects in Metals. Phys. Rev. B., Vol. 29, No. 12, 1984
30

Zhang, S., et al., Stress Generation Mechanisms in Carbon Thin Films Grown by Ion-Beam

Deposition. ActaMaterialia, Vol. 51, PP 5211-5222, 2003
31

Ceder, G., Marzari, N., Atomistic Computer Modeling of Materials (SMA5107).MIT Course.

Presented Spring 2005.
32

Allen, M. P., Introduction to Molecular Dynamics Simulation. Computational Soft Matter:

From Synthetic Polymers to Proteins. NIC Series, Vol. 23, pp 1-28, 2004
33

Daw, M.S., Embedded-Atom Method: Derivation and Application to Impurities, Surfaces and

Other Defects in Metals. American Physical Society, Physical Review B, Vol. 29, No. 12, 1984
34

Grest, G.S., Kremer, K., Molecular Dynamics Simulations of Polymers in the Presence of a

Heat Bath. Journal of Physical Review A., Vol. 33, pp 3628-3631, 1986
35

Daw, M.S., et al, The embedded-atom method: a review of theory and applications, Mat.

Science Rep. 9 (1993) 251-310
36

Foiles, S. M., et al, Embedded-atom-method functions for the fcc metals Cu, Ag, Au, Ni, Pd, Pt and their alloys, Phys. Rev. B, Vol. 33, No. 12 (1986)
37

Duparc, O. H., On the origins of Finnis-Sinclair potentials, Phil. Mag. Vol. 89, Nos. 34-36, 121, (2009)
38

Voter, A. F., Unclassified Technical Report # LA-UR 93-3901 (1993)

39

Narayan, K., Behdinan, K., Fawaz, Z., An engineering-oriented embedded-atom-method potential fitting procedure for pure fcc and bcc metals, J. of Mat. Proc. Tech. 182 (2007) 387397

93

40

Greengard, L., Rokhlin, V. A fast algorithm for particle simulation, J. of Comp. Phys. Vol. 73, 325-348 (1987)
41

Park, H. S., et al, Non-reflecting boundary conditions for atomistic, continuum and coupled atomistic/continuum simulations, Int. J. for Numer. Meth.Engng. 2005, Vol. 64, 237-259
42

Daw, M.S, et al., Semiempirical, Quantum Mechanical Calculation of Hydrogen Embrittlement in Metals. Phys. Rev. Letters., Vol. 50, No. 17, 1983
43

Baskes, M. I., Modified embedded-atom potential for cubic materials and impurities. Phys. Rev. B, Vol. 46, No. 5, 1992
44

Field, M.J., A Practical Introduction to the Simulation of Molecular Systems. Cambridge. 2nd ed. 2007
45

Ray, J.R., Rahman, A., Statistical Ensembles and molecular dynamics studies in anisotropic solids, J. Chem. Phys., Vol. 80, No. 9, (1984)
46

Rose, J. H., et al, Universal Feature of the Equation of State of Metals, Phys. Rev. B, Vol. 29, No. 6, 1984
47

Billing, G. D., Mikkelsen, K. V., Introduction to Molecular Dynamics and Chemical Kinetics, Wiley-Interscience, New York, 2006
48

Zhang, S., et al, Stress Generation Mechanisms in Carbon Thin Films Growth by Ion-Beam Deposition, Acta Mat. Vol. 51, PP 5211-5222, 2003
49

Sacks, J., et al, Design for Computer Experiments, American Stat. Assoc. Technometrics, Vol 31, No. 1, (1989) 50 Iman, R. I., Davenport, J. M., Ziegler, D. K., Latin Hypercube Sampling (program User's Guide), [LHC in Fortran], N.p. 1980, print
51

Satoodeh, A.R., Nickel Nanowire Under Uniaxial Load: A Molecular Dynamics Simulation Study, Comp. Mat. Sci. Vol. 44, PP 378-384, 2008
52

Chamati, H., et al ,Embedded-atom potential for Fe and its application to self ­diffusion on Fe(100), Surf. Sci. 600, (2006) 1793-1803
53

Horstemeyer, M. F., et al, Computational nanoscale plasticity simulations using embedded atom method, Theor. Appl. Fract. Mech., Vol. 37, (2001), 49-98

94

54

Villareal, M., Oviedo, O.,Leiva, E., A straightforward approach for the determination of the maximum time step for the simulation of nanometric metallic systems, J. Chem. Theory Comput., 8(5), pp 1744-1749, 2012
55

Stocker, U., Juchli, D., Van Gunsteren, W., Increasing the time step and efficiency of molecular dynamics simulations or structural refinement of large biomolecules, Molecular Simulation, 29 (2), pp 123-138, 2003
56

Komeiji, Y., Ewald summation and multiple time step method for molecular dynamics simulation of biological molecules, J. Molecular Structure (Theochem), Vol. 530, pp230-243, 2000
57

Kawata, M., Mikami, M., Acceleration of the canonical molecular dynamics simulation by the particle mesh Ewald method combined with the multiple time-step integrator algorithm, Chem. Phys. Letters, Vol. 313, pp 261-266, 1999
58

Tuckerman, M.E, et al, Molecular dynamics algorithm for multiple time scales: Systems with long range forces, J. Chem Phys., 94 (10), pp 6811-6815, 1991
59

Rao, F., Spichty, M., Thermodynamics and kinetics of large-time-step molecular dynamics, J. Comp. Chem., Vol 33, pp 475-483, 2012
60

Zheng, H., Wang, S., Zhang, Y., Increasing the time step with mass scaling in BornOppenheimer Ab Initio QM/MM molecular dynamics Simulations, Jour. of Comp. Chem., Vol 30, No 16, 2009
61

Pomes, R., McCammon, J., Mass and step length optimization for the calculation of equilibrium properties by molecular dynamics simulation, Chem. Phys. Lett., Vol. 166, No. 4, pp 425-428, 1990
62

Plimpton, S.J., Hendrickson, B.A, Parallel Molecular Dynamics with the Embedded Atom Method. Materials Theory and Modelling, MRS Proceedings 291, p 37, 1993

95

