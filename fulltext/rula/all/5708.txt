PRICING SPARK SPREAD OPTIONS IN ELECTRICITY MARKETS

by

Shivani Sharma Bachelor of Science, Ryerson University, 2014

A thesis presented to Ryerson University in partial fulfilment of the requirements for the Degree of Master of Science in the program of Applied Mathematics Toronto, Ontario, Canada, 2016 c Shivani Sharma 2016

Author's Declaration for Electronic Submission of a Thesis

I hereby declare that I am the sole author of this thesis. This is a true copy of the thesis, including any required final revisions, as accepted by my examiners.

I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research.

I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

I understand that my thesis may be made electronically available to the public.

ii

PRICING SPARK SPREAD OPTIONS IN ELECTRICITY MARKETS Master of Science, 2016 Shivani Sharma Applied Mathematics Ryerson University

This master's thesis develops a pricing method for spark spread options using a Monte Carlo method. The underlying commodities of interest, natural gas and uranium highlight the prevalence of natural gas power and nuclear power in Canada. To characterize the dynamics of electricity prices and capture specific features they have, two Levy models are proposed: a jump-diffusion model and a time-changed model. Real data are used to calibrate the models, using the daily average market prices for the last five years. We created a method to compute the price of the derivative under realistic modelling conditions using parameters found through the real data. Such models can be used to value the spark spread contracts to mitigate the risk associated the contracts.

iii

Acknowledgements

My sincere gratitude goes to my supervisors, Dr. Pablo Olivares and Dr. Alexander Alvarez. They provided me with excellent guidance and support from day one. I would like to thank my family who continuously motivated me everyday throughout my entire academic career and made all of the hard work worthwhile. Thank you.

iv

Dedication This work is dedicated to my grandfather; an honest, hard-working man; my inspiration, always. He would have been proud to know I am defending my Master's thesis.

v

TABLE OF CONTENTS

Author's Declaration

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

ii

Abstract

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

iii

Acknowledgements

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

iv

Dedication . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

v

List of Tables

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

ix

List of Figures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

xii

List of Appendices . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

xii

1

Introduction 1.1 1.2 1.3 1.4 1.5

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

1 1 3 4 7 8

The Ontario Electricity Market . . . . . . . . . . . . . . . . . . . . . . . . . Financial Electricity Contracts: A Look at the Nordic Market . . . . . . . . Derivative Products Based on Underlying Energy Assets . . . . . . . . . . . Thesis Objective and Results . . . . . . . . . . . . . . . . . . . . . . . . . . Outline . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

2

Modelling Electricity Prices . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2.1 Introduction to Levy Processes . . . . . . . . . . . . . . . . . . . . . . . . . 2.1.1 Levy- Ito Decomposition . . . . . . . . . . . . . . . . . . . . . . . . . vi

9 9 11

2.1.2 2.1.3 2.2 2.3 2.4 2.5 2.6

Levy-Khintchine Formula . . . . . . . . . . . . . . . . . . . . . . . . Examples of Levy Processes . . . . . . . . . . . . . . . . . . . . . . .

12 12 14 15 18 22 24

Inverse Gaussian Random Process . . . . . . . . . . . . . . . . . . . . . . . Future and Forward Prices . . . . . . . . . . . . . . . . . . . . . . . . . . . . Models for Pricing Electricity Contracts . . . . . . . . . . . . . . . . . . . . Multivariate Jump-Diffusion Model . . . . . . . . . . . . . . . . . . . . . . . Multivariate Time-Changed Models . . . . . . . . . . . . . . . . . . . . . . .

3

Monte Carlo Pricing of Spark Spread Contracts: Algorithm and Numerical Results 27 3.1 3.2 The Monte Carlo Method and Pricing Applications . . . . . . . . . . . . . . Algorithms of Monte Carlo Input Functions . . . . . . . . . . . . . . . . . . 3.2.1 3.2.2 3.2.3 3.2.4 3.3 3.4 3.5 3.6 3.7 Algorithm for Generating Brownian Motion . . . . . . . . . . . . . . Algorithm for Generating Compound Poisson Process . . . . . . . . The Inverse Gaussian Method . . . . . . . . . . . . . . . . . . . . . . Euler-Maruyama Algorithm . . . . . . . . . . . . . . . . . . . . . . . 27 29 30 31 33 34 44 44 48 52 55 55 66

Monte Carlo General Pricing Algorithm . . . . . . . . . . . . . . . . . . . . Computing the Future Price under a Jump Diffusion Model . . . . . . . . . Computing the Future Price under a Time Changed Model . . . . . . . . . Empirical Data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Monte Carlo Pricing Computation . . . . . . . . . . . . . . . . . . . . . . . 3.7.1 Monte Carlo Pricing under a Jump-Diffusion Model . . . . . . . . .

3.8

Monte Carlo Pricing under a Time-Changed Model . . . . . . . . . . . . . .

vii

3.8.1 3.9

Pricing Computation Comparison between Models . . . . . . . . . .

68 81

Regression Analysis: Estimation of Seasonal Components . . . . . . . . . .

4

Conclusions

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

86

References

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

112

viii

LIST OF TABLES

2.1

Variables and the Respective Parameters . . . . . . . . . . . . . . . . . . . .

26

3.1 3.2 3.3 3.4 3.5

Statistics of Empirical Data . . . . . . . . . . . . . . . . . . . . . . . . . . . Table of Empirical Correlation (ij ) . . . . . . . . . . . . . . . . . . . . . . Simulation Parameters Held Constant During Simulation . . . . . . . . . . Table of Least Square Estimators using a Seasonal Trend . . . . . . . . . . Table of Least Square Estimators using a Linear Trend . . . . . . . . . . . .

52 53 55 82 82

5.1 5.2

Variables and the Respective Parameters . . . . . . . . . . . . . . . . . . . . Variables and the Respective Parameters . . . . . . . . . . . . . . . . . . . .

113 114

ix

LIST OF FIGURES

3.1 3.2 3.3 3.4 3.5

Flowchart Depicting the functions created to obtain the Spark Spread Price. Three Dimensional Brownian Motion Simulation . . . . . . . . . . . . . . . Multivariate Compound Poisson Process Simulation . . . . . . . . . . . . . Inverse Gaussian Subordinator Simulation . . . . . . . . . . . . . . . . . . . Seasonalized Log Returns for Electricity, Uranium, and Natural Gas using the Jump-Diffusion model . . . . . . . . . . . . . . . . . . . . . . . . . . . .

29 31 36 37

38

3.6

Deasonalized Log Returns for Electricity, Uranium, and Natural Gas using the Jump-Diffusion model . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39

3.7

Spot Price Simulation for Electricity, Uranium, and Natural Gas using a Jump-Diffusion model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40

3.8

Seasonalized Log Returns for Electricity, Uranium, and Natural Gas using a Time-Changed . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41

3.9

Deseasonalized Log Returns for Electricity, Uranium, and Natural Gas using a Time-Changed model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 42

3.10 Spot Price Simulation for Electricity, Uranium, and Natural Gas using a Time-Changed model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3.11 Simulated Future Prices for Electricity, Uranium, and Natural Gas using a Jump-Diffusion Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47 43

x

3.12 Simulated Future Prices for Electricity, Uranium, and Natural Gas using a Time-Changed Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3.13 Empirical Pricing Series for Electricity, Uranium, and Natural Gas . . . . . 3.14 Spark Prices for Uranium . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3.15 Spark Prices for Natural Gas . . . . . . . . . . . . . . . . . . . . . . . . . . 3.16 Interaction of Spark Prices for Uranium with Lambda . . . . . . . . . . . . 3.17 Interaction of Spark Prices for Natural Gas with Lambda . . . . . . . . . . 3.18 Spark Spread Prices for Uranium Interaction with electricity and uranium . 3.19 Spark Spread Prices for Natural Gas Interaction with electricity and gas . 51 54 58 59 60 61 62 63 64 65 69 70

3.20 Spark Spread Prices for Uranium Interaction with 12 and 13 . . . . . . . . 3.21 Spark Spread Prices for Uranium Interaction with 12 and 13 . . . . . . . . 3.22 Future Prices for Uranium . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3.23 Future Prices for Natural Gas . . . . . . . . . . . . . . . . . . . . . . . . . . 3.24 Spark Spread Prices for Uranium Interaction with Inverse Gaussian variables a, b . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

71

3.25 Spark Spread Prices for Natural Gas Interaction with Inverse Gaussian variables a, b . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3.26 Spark Spread Prices for Uranium Interaction with electricity and uranium . 3.27 Spark Spread Prices for Natural Gas Interaction with electricity and gas . 72 73 74 75 76

3.28 Spark Spread Prices for Uranium Interaction with 12 and 13 . . . . . . . . 3.29 Spark Spread Prices for Natural Gas Interaction with 12 and 13 . . . . . .

xi

3.30 Difference in Spark Spread Prices when the Underlying is Uranium or Natural Gas for a Jump Diffusion Model . . . . . . . . . . . . . . . . . . . . . . . . 3.31 Difference in Spark Spread Prices when the Underlying is Uranium or Natural Gas for a Time Changed Model . . . . . . . . . . . . . . . . . . . . . . . . . 3.32 Difference in Spark Spread Prices for Uranium between a Jump Diffusion Model and Time Changed Model . . . . . . . . . . . . . . . . . . . . . . . . 3.33 Difference in Spark Spread Prices for Natural Gas between a Jump Diffusion Model and Time Changed Model . . . . . . . . . . . . . . . . . . . . . . . . 3.34 Regression Analysis of Empirical Data for Electricity . . . . . . . . . . . . . 3.35 Regression Analysis of Empirical Data for Uranium . . . . . . . . . . . . . . 3.36 Regression Analysis of Empirical Data for Natural Gas . . . . . . . . . . . . 80 83 84 85 79 78 77

xii

LIST OF APPENDICES

Appendix A: Code . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 88 Appendix B: Tables. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 112

xiii

Chapter 1

INTRODUCTION

In this chapter we will discuss the electricity market, and specifically the Ontario electricity market. To introduce the electricity market, general terminology will be explained as well as key components to general commodity markets . This project models an electricity market, with an application to Ontario market.

1.1

The Ontario Electricity Market

Commodity markets have been around since the beginning of civilization. A soft commodity market is as simple as trading wheat for something with value. This is also an example of a storable commodity. Modelling commodity markets is a well documented topic. Storable commodities have been traded since the existence of the market. This thesis focuses on the commodity market of electricity, which deals with the trade of electrical power. The electricity market has a unique attribute which vastly differentiates it from other markets. Electricity is rarely stored, since it is difficult and expensive to do so, and is referred to as a flow commodity since it is only useful if it is delivered during a specific period of time. Producers of electricity may store it indirectly, however consumers cannot buy for the purpose of storage. Trading in this market requires the time of delivery to be a factor in

1

the value of the commodity, which is specific to this market. Among all energy markets, electricity markets pose the highest challenge, as there are many unique characteristics. In addition to being a commodity that cannot be stored, the power network must be constantly balanced to prevent it from collapsing. See [16]. Electricity contracts guarantee the delivery of a specified amount of power for a specific future time, which is why electricity is traded in an auction system for standardization. See [5]. The guarantees are of significance since electricity is a permanent, basic necessity in today's society. This thesis focuses on stochastic modelling the spark spread option contracts. A spark spread option contract is a contract in the electricity market based on the difference between electricity and the underlying material. This thesis focuses on natural gas and uranium as underlying commodities because of the prevalence of gas power and nuclear power in Canada. Canada is third in terms of the size of its uranium reserves, globally. See [10]. In addition to fluctuations in prices of uranium and natural gas, there are other factors impacting the price of the contract, including a governing body, which affect the price of underlying materials. The governing body in question is the Independent Electricity System Operator (IESO), which is one of eight independent system operators in North America. IESO governs the operation of the electricity market and directs the operation of the bulk electrical system in Ontario, Canada. It oversees Ontario's wholesale electricity market and determines the price of electricity. We will observe a price cap in Ontario's electricity prices. The price to the consumer is based on the average yearly cost of power, which is based on supply,

2

demand, and IESO established rates. Time based pricing is to limit peak demand, which can prevent brown outs since there is potential for demand to exceed supply. A brown out is a drop in voltage in an electrical power supply system, whether intentional or unintentional, with the main purpose being to prevent a black out. Intentional brownouts are used for load reduction in an emergency, which may be for minutes or hours. Reducing peak demand also prevents the need for new sources of power. All of these factors are taken into account when IESO accepts a bid for power by a generating system. See [2].

1.2

Financial Electricity Contracts: A Look at the Nordic Market

In contrast, the Nordic Market operates on the Nord Pool system, containing various countries. There is no one set of rules dictating how trading for financial electricity contracts as they are different among underlying power exchanges. The market for electricity contracts functions without central coordination since the contracts are settled against a reference price. The reference price is generally the spot price for that day. One example of a trading market is the Nord Pool system which is the Nordic trading facility, it includes Noway, Sweden, Finland, and Denmark. The exchange traded at Nord Pool are written on the weighted average of the system price over a specified delivery period (DP), and the contracts are traded prior to this period. See [5]. The contracts are settled against hourly day ahead prices. The underlying amount of electrical energy can be calculated using the Nord Pool System Price equation, seen below Underlying Energy = DP  24M W h

3

where DP is the delivery period, 24 MWh is a conversion factor since the prices are hourly.

1.3

Derivative Products Based on Underlying Energy Assets

Before we discuss the derivative products, we must outline definitions of key terms. An option is a contract which gives the buyer the right, but not a necessary obligation, to buy or sell an underlying asset at a specific strike price or before a specific date. A Future contract, in contrast, is a contract between two parties where there is an obligation to buy or sell the asset at an agreed upon price today, which is the Futures price with delivery and payment at a future point, the delivery date. Now we will discuss the derivative products relevant to this thesis. A European Call option must be established is a financial contract between two parties, given to the owner. Typical contracts are calls and puts. A call option with strike price K and maturity T is only exercised when the payoff is "in the money", meaning when the difference between the spot price and strike price, is greater than zero. Mathematically, its payoff is given by: Payoff = max({ST - K } , 0) := {ST - K }+ where St is the spot price at time t. A put is only exercised when the payoff is "out of the money". Payoff = (K - ST )+ Electricity options are simply options where the underlying asset is electricity. The option grants the purchaser the right, but not the obligation, to buy or sell a fixed amount of 4

underlying electricity at the strike price by a maturity date. The electricity option contract contains parts specific to electricity, such as the underlying price, fuel type, delivery location and time, quality, volume, and others. Similar to other financial options, electricity options may be classified as electricity calls or electricity puts. A spark spread option is the difference between the price of power on the market and the total production price of fuel and generation. It is the net income to an electricity generation conglomerate as a result of purchasing the fuel, natural gas or uranium, to produce the electricity, and subsequently selling the energy produced. The expenses to the generator are covered within this margin in a spark spread option. The call option gives the right, but not the obligation to the buyer to purchase the price difference between the electricity and price of the underlying after accounting for the efficiency of the plant. The price difference is the spark spread, and the efficiency also accounts for the emission factor. The ones who have the right to exercise the option are the power plant operators and power consumers, with different purposes. The power plant operators could exercise their right to the option to hedge against market movements and low production power. The power consumers could exercise their right to the option to guarantee stable cash flow using an option premium. Unlike the spark spread option where the buyer is not obligated to buy, an electricity Future contract is a contract where one party is contractually obligated to buy from, or sell to, the other party a fixed amount of electricity at the Future price on the delivery date specified in the contract. This is a supply contract between a user and supplier where the

5

buyer is obligated to purchase the electricity supplied, and the seller is obligated to supply electricity. Electricity Future contracts are highly standardized; however, they follow a payoff structure similar to electricity forwards. Electricity Futures have contract specifications stipulating specific procedures, delivery conditions and locations, and trading conditions and locations, as in most financial Future contracts. The difference between electricity Future contracts and electricity forward contracts is the quantity of power. When the delivery amount is substantially smaller, electricity Future contracts are used. See [20] To hedge the variability of cash flow as a result of fluctuations in electricity price, we use an electricity swap contract. This contract refers a quantity of power to the variable spot price at the location of the generating institute or the consumer. A basis swap may be used to set a fixed price at a specific location not including the delivery point of the Futures contract. Here the buyer of the electricity basis swap must either pay or receive the difference between the contract price, and the spot price for that location at the time of the trade. There also exists a class of commodity linked products, such as contracts referring to the price of raw materials and energy. IESO, as mentioned earlier, is a crown corporation governing the electricity market in Ontario. The power generators in Ontario bid on power contracts and IESO accepts the bid based on power supply and demand. The value that the generators are paid is based on the highest bidder whose power is needed to meet supply. See [2]

6

1.4

Thesis Objective and Results

This thesis explores pricing spark spread contracts using the Monte Carlo Method, for electricity contracts for natural gas and uranium in Ontario. Under novel models that capture relevant specific features of electricity and raw primary materials such as jumps, volatility, and seasonal sensitivity. Computing prices through the model created is more complicated since the Future price is used in the payoff calculation, as opposed to the spot price. The novelty of this work lies in establishing spark prices together with the use of non-standard models. This will be further discussed in Chapter 2. To model the dynamics of Future prices in natural gas, uranium, and electricity, we propose two models: The Jump Diffusion Model, and The Time Changed Model. A significant application for this thesis is that we want to value the spark spread contracts to mitigate the risk associated with the contracts. The result of this master's thesis is the creation of a methodology using complex Levy models to price the spark spread contracts. The models themselves have three components, a mean reverting component, a seasonal component, and a jump component. The methodology includes statistical empirical analysis followed by software implementation in MATLAB, and complete algorithms for two pricing models. The result includes novel uses for the spark spread pricing model, and sensitivity analysis. Sensitivity analysis is used to understand risk factors, which may be used to hedge in future applications.

7

1.5

Outline

Chapter 1 discusses the electricity market in general, as well as the Ontario case. It also introduces the concepts used and motivation behind this line of research. Chapter 2 discusses electricity price modelling. The models, algorithm, and elements used to create the models are explained. In Chapter 3, we look at the empirical data obtained for the spark spread contracts in Ontario and analyse the data followed by a comparison with the models created. To conclude, Chapter 4 discusses the strengths of each of the models and where each model prevailed and where each model was weak.

8

Chapter 2

MODELLING ELECTRICITY PRICES

We are looking to find a fair price for spark spread options, which are the commodity transactions in the electricity market based on the difference between fuel and generation price, and electricity price. This is of interest to us since the spread fair price determines the economic value of the underlying commodities, in this case, namely uranium and gas. See [17]. To find the fair price for these options, we propose two models. The model evolution will be discussed in this chapter, beginning with the prices. The proposed models and their elements are explained as well as justification for each process. Since this thesis highlights the use of Future prices to calculate the payoffs, the characteristics of Future prices are emphasized. Examples of the Levy processes used in modelling, as well as the model evolution are subsequently discussed. We introduce the two models proposed, a multivariate jump diffusion model, and a multivariate time-changed model with additional features such as seasonality and mean-reverting factors.

2.1

Introduction to Levy Processes

A Levy process is a stochastic process with independent, stationary increments which is infinitely divisible. The increment in space represents the motion of a point whose successive displacements are random and independent, and not necessarily normally distributed. A

9

L´ evy process can be viewed as the continuous-time analog of a random walk. A property of the Levy process is that it follows a cadlag modification. The word cadlag comes from the french for "continu ` a droite, limites ` a gauche", which translates to right continuous with left limits. There are two subclasses within Levy processes where calculations are fairly simple which are time-changed processes and multivariate jump diffusion models. They will be discuss in sections 2.2 and 2.3 respectively. Definition 2.1. Given a filtration F = (Ft )t0 , the filtration is an indexed set of information from 0 to t, including the prices. Given a stochastic basis (, A, P, F), a stochastic process is a collection of real-valued random variables on the sample space , indexed by time. Then, (Xt )t0 , a stochastic process, is a collection or random variables where each Xt is a real-valued random variable on . The process X = (Xt )t0 is said to be a Levy process if and only if:

(1) It has Independent Increments: For any n  N, 0  t1 < t2 < ... < tn < , Xtk - Xtk-1 (k =1, 2,...,n) are independent random variables. (2) It has Stationary Increments: For any s<t, Xt - Xs is equal in distribution to Xt-s . (3) It is Continuous i.e. for s  0, Xt+s - Xs  0 as t  0 almost surely.

Well known examples of L´ evy processes are Brownian motion and the Poisson process. Other examples that will be discussed in this chapter are Inverse Gamma and Time-changed 10

processes. See [19]. Each process has a characteristic function which determines the distribution of the process. The characteristic function always exists and is uniformly continuous. It is defined below. See [12]. Definition 2.2. Defined on a stochastic basis, for a real - valued process (Xt )t0 , Xt () as the characteristic function of the process. Therefore, for Xt :

Xt (u) = E (eiuXt ), u  R

(2.1)

where Xt (u) is the characteristic function of the process. A characteristic exponent of a Levy process gives the rate of exponential divergence from initial conditions. See [18].

Xt (u) =

1 log Xt (u) t

2.1.1

Levy- Ito Decomposition

A Levy process can be decomposed into the sum of a Brownian motion, a linear drift and a pure jump process which captures all jumps of the process, referred to as the Levy-Ito Decomposition.

Xt = µt +  Wt + Zt

The Levy-Ito Decomposition states that any Levy process (Xt )t0 can be constructed as a sum of three independent processes. Given a L´ evy triplet (µ, 2 , ) there exist three independent L´ evy processes, which lie in the same probability space, such that:

11

The parameter µ is a Brownian motion with drift which is the absolutely continuous part of a measure and capturing the drift and diffusion;  2 is a compound Poisson process is the Levy measure. The process defined by X = (Xt )t0 is then a L´ evy process with triplet (a,  2 , ).

2.1.2

Levy-Khintchine Formula

The Levy-Khintchine Formula gives the characteristic function, which characterizes the distribution of a Levy process. A Levy process has three independent components: a linear drift, a Brownian motion and a compound Poisson process. The measure (dx) represents the intensity of the Poisson process with jump of size x. These three components, and thus the L´ evy­Khintchine representation, are fully determined by the L´ evy­Khintchine triplet (µ,  2 , ). The only non-deterministic continuous Levy process is a Brownian motion with drift. Theorem 2.3. Levy-Khinchine Formula If X = (Xt )t0 is a Levy process, then its characteristic function Xt (u) is given by

Xt (u) = exp

1 µiu -  2 u2 + 2

eiux - 1 - iuxI|x|<1 (dx) t
R\{0}

(2.2)

where µ  R,   0, I is the indicator function and  is the Levy measure of X.

2.1.3

Examples of Levy Processes

Example 2.1.1. Poisson Process

12

To introduce Levy Processes, we will look at one of the simplest examples, which is a Poisson process. Let (Xt )t0 be a random process with finite independent stationary increments. The increments are independent of the past, for example, if there is an average of five jumps within an interval, not observing a jump would not increase the probability of a jump. The Poisson analysis counts how many jumps in increments occur during the interval [0,t]. See [19]. Definition 2.4. (Nt )t0 is a Poisson process if and only if: (1) N0 = 0. (2) (Nt )t0 has stationary and independent increments (3) P (Nt = n) = e-t
(t)n n!

, n = 0, 1, 2,...

on interval length t and Poisson distributed with mean t. See [1] for a proof. Example 2.1.2. Brownian Motion Modelling the price process using geometric Brownian motion leads to calculating the expected value dependent on the spot price. Brownian Motion is described by the Wiener process, which is defined below. See [19]. Definition 2.5. (Wt )t0 is a Wiener process or Brownian motion if and only if: (1) W0 = 0. (2) (Wt )t0 has stationary and independent increments (3) (Wt )t0 is continuous 13

(4) (Wt )t0 is normally distributed with zero mean and variance  2 ; fWt (x) = where fWt (x) is the probability density function of (Wt ). Example 2.1.3. Compound Poisson Process

 1 e - 2t 2t

x2

,

We will be using a Compound Poisson Process to simulate a part of the Levy component in the Jump-diffusion model. It is given by

Nt

Nt

(0)

Zt =
k=1

Xk +
k=1

X0,k

(2.3)
(0)

where Xk  N (µJ , (J )2 ) and X0,k  N (µ0,J , 0,J ). The objects (Nt )t0 and (Nt )t0 are Poisson random variables. For each k, Xk is a normal random variable, and X0,k is a multivariate random variable simulating the common jumps between electricity and the two underlying commodities. For the proof for a compound poisson process in a one dimensional case, see [15].

2.2

Inverse Gaussian Random Process

The Inverse Gaussian distribution is a two parameter (a, b) continuous probability distribution on (0, ). As b   this distribution tends to a normal distribution. The parameters will be given as IG(a,b). For our Time Changed model, the Inverse Gaussian subordinator Lt
(j )

is defined below and will be used to simulate the time- changed process, BZt . See [19].

Definition 2.6. A time-change is any non-decreasing random process (Lt )t0 . When the time-change has positive, independent and stationary increments, the process is referred to as a subordinator. 14

The subordinator of the time-changed process, Lt , has the probability density function:

(j )

f (x; a, b) =

b 2x3

1 2

exp

-b(x - a)2 2a2 x

We sample from an IG(a,b) distribution, given the characteristic exponent IG of an L(j ) inverse Gaussian subordinator:

IG (j ) (u) = -aj (
Lt

-2iu + b2 j - bj )

(2.4)

2.3

Future and Forward Prices

The spot price of a commodity is the price at which the commodity could be traded at any given time in the marketplace. In contrast, a commodity's Future price is the price of the commodity in relation to its current spot price, time until delivery, risk-free interest rate, and storage costs at a future date. Electricity Futures have the same payoff structure as electricity forwards. However electricity Futures, like other financial Futures contracts, are highly standardized in terms of contract specifications, delivery conditions, trading locations, and settlement procedures. In contrast, Futures prices and spot prices are different because the market is always forwardlooking. The difference in a commodity's spot price and Future price is due to the cost of carry and interest rates. See [5]. Definition 2.7. We define a Future contract with delivery at the time T: The Futures price F(t,T) is the market quoted price at time t, for the delivery of the asset 15

at time T. During any time interval [t,s], the holder receives the amount F(s,T) - F(t,T). At time T, the holder pays the spot price at time T, F(T,T) and is entitled to receive the underlying. For the models created, a constant interest rate is used. This is a simplification, as stochastic models exist. Two in particular are the Hull-White One-Factor and Two-Factor model. The Hull-White model is used to model arbitrage free Future interest rates, whereas the Two-Factor model contains an additional disturbance term whose mean reverts to zero. The models developed calculate the respective Future prices based on a simulated spot price, and subsequently calculate the payoff and price of the spark spread option. The first step is to compute the Future prices; to reach the objective, we first understand the dynamic of Future prices. The Future price is the price of an asset which is agreed upon in a Future contract. The big question we are looking to answer is, "What is the fair price for the contract?". In general, the Future price should be the spot price, discounted by the cost of carry for the asset. The cost of carry is a peculiar issue in the electricity market, which will be discussed later in this chapter. For a forward contract on an underlying asset that is tradeable, we can define the Future price in terms of the spot price, interest, cost of carry, and any dividends for a Future contract on an underlying asset if the asset is tradeable. The derivatives are the raw materials used by the electricity generating systems. If those derivatives are tradeable and a dividend exists, the Future price is given by:

16

(r-q )(T -t) F (t, T1 ) = S0 e(r-q)T - N , i=1 Di e

(2.5)

where: F is the Future price to be paid at maturity (time T ) t is the current time r is the risk-free interest rate q is the cost-of-carry S0 is the spot price of the asset Di is a dividend that is guaranteed to be paid at time ti where t < ti < T . When the interest rates are deterministic, forward and Future prices are identical. This is because the Future price is a martingale under the risk-neutral measure, and the forward price is a martingale under the forward measure. These two measures are equal when the interest rate is not stochastic. When the interest rate is stochastic, there is a difference between forward and Futures prices. We assume q = 0, Di = 0. Selling an asset at a future date can cover a commitment by immediately buying and carrying until maturity the commodity that is to be delivered. The cost of using the asset is incurred, but profit from the utility of being able to trade the commodity is at maturity. Therefore, the return of buying a commodity today (that is, at time t) and delivering it at maturity (T1 ) should at least be equal to: F (t, T1 ) = e-r(T1 -t) E (ST1 /Ft ) (2.6)

The filtration Ft is the  - algebra generated by random variables, F (t, T1 ) represents the 17

commodity Future price and St is the commodity spot price.

2.4

Models for Pricing Electricity Contracts

The foundation of pricing the spark spread contracts is to compute Future prices for each commodity based on the spot price. The initial task is to simulate spot prices; therefore, the Euler-Maruyama Method is employed to solve the stochastic differential equation below.

~t dY

(j )

= dµt + dYt

(j )

(2.7)

For (Yt )t0 we assume a dynamic as:

Yt (j ) = j (r - mj - Yt (j ) )dt + dVt where (Vt )t0 is a Levy process.

(j )

(2.8)

We solve for YT , for j equal to 1, 2, and 3, defined as electricity, uranium, and natural gas respectively T is time at maturity. Spot prices ST = (ST , ST , ST ) are given by:
(j ) (1) (2) (3)

(j )

ST = S0 (j ) exp(YT ) j = 1, 2, 3

(j )

(j )

(2.9)

To model the dynamics of spot prices in electricity, natural gas, and uranium, we consider two models which will be described below. The first model is a multivariate jump-diffusion model and will be discussed in section 2.5. The second model is a Multivariate TimeChanged Model discussed in section 2.6. Both models have similar components such as a 18

mean-reverting nature and seasonality. In general terms, we assume a model for the logreturns of the three processes given by the sum of deterministic seasonal component plus a mean-reverting Levy component, dVt , as seen in equation (2.8). For (Vt )t0 we have created two variants. For the Jump-diffusion model, we have

dVt = dBt + dZt

where (Bt )t0 ) is a geometric Brownian process and (Zt )t0 is a multivariate compound Poisson process. For the Time-changed model, we have

dVt = dBZt Thus, we have the following models for the log-returns. The jump diffusion model under an Euler Maruyama Method (Risk Neutral) where mj is the compensator converting discounted prices into martingales is: Yt (j ) = j (r - mj - Yt (j ) )dt + dBt + dZt

(2.10)

for j = 1, 2, 3 The time-changed model is: Yt (j ) = j (r - mj - Yt (j ) )dt + dBZt for j = 0, 1, 2, 3 where r is the risk-free interest, j is the mean-reverting rate, mj varies between the two models, and µt is either the seasonal deterministic process or the linear trend. The 19

(2.11)

deterministic function µt is defined as either one of the following equations, based on the commodity. In section 3.9, the benefit of using

µt

(j )

= a0 + a1 (t), j = 1, 2, 3 =
(j ) b0

(j )

(j )

(j ) µt

+

(j ) b1 cos

2 (t) j = 1, 2, 3 Tp

(2.12)

where a0 , a, b0 , b are parameters in the model at Tp is the period in the seasonal component. The solution of Yt
(j )

is given by the equation below. Notice that by properly compen-

sating, it is a model in one of the possible risk neutral measures. The proof can be shown with the Ito formula for discontinuous processes. Proposition 2.8. Let Yt = (Yt , Yt , Yt ) the process given by equation (2.7), then Yt
(j ) (1) (2) (3)

= (r - mj )(1 - ej t ) +

(j ) t -j (t-s) dVs , j 0 e

= 1, 2, 3
(j )

Proof. Apply Ito Formula to fj (x, y ) = xej y and the process (Yt , t). Then: Yt ej t =
(j ) (j ) (j ) (j ) (j ) (j ) (j ) t j s t (j ) dYs +j 0 Ys ej s ds+(f (Ys +Ys , s)-f (Ys- , s)-f (Ys- , s)Dx f (Ys- , s)) 0 e t j s ds 0 e

1 = j (r - mj )  (1 - ej t ) - j j

+ j

t (j ) j s ds 0 Ys e (j )

+

(j ) t j s dVs 0 e

+ (Ys

(j )

+ Ys , s)ej s - Ys ej s - f (Ys )Ys ej s
(j ) t - j s dVs 0 e

(j )

(j )

(j )

= (r - mj )(1 - e-j t ) +

where Xt = Xt - Xt-1 is the jump size at t. Finally multiplying both sides by e-j t leads to the result. The Future prices at time t with delivery at T1 are F (t, T1 ) = (F (1) (t, T1 ), F (2) (t, T1 ), F (3) (t, T1 )). A spark is a call contract with maturity at time T , T < T1 and strike price K , written on 20

the spread of the Future prices of the source and electricity, denoted by j =1. Recall the spot price formula from (2.9). The relation between Future and spot prices in an arbitrage argument is given by: F (j ) (t, T1 ) = EQ (ST /Ft ), j = 1, 2, 3.
(j )

(2.13)

We analyze European spread options whose payoff at maturity T, for a strike price K, is given by: hura (T, T1 , K ) = (F (1) (T, T1 ) - cura F (2) (T, T1 ) - K )+ hgas (T, T1 , K ) = (F (1) (T, T1 ) - cgas F (3) (T, T1 ) - K )+ (2.14) (2.15)

where cura and cgas are the conversion factors to relate the electricity cost with the production cost of natural gas and nuclear power respectively. Since we are using a Monte Carlo method, we take n is very large we are able to compute the payoff using the following formula.

1 n

n

hura (T, T1 , K )
n=1

EQ [hura (T, T1 , K )]

(2.16)

1 n

n

hgas (T, T1 , K )
n=1

EQ [hgas (T, T1 , K )

(2.17)

Finally the fair price of the contracts at time T with strike price K will be given by the following equations which take the expectation of the payoffs, and discount the payoff. Let Cgas and Cura denote the price of a European spread option with payoff h(ST ) under the model given by equations 2.19 and 2.18. Cura (T, T1 , K ) = e-r(T -t) EQ [hura (T, T1 , K )] 21 (2.18)

Cgas (T, T1 , K ) = e-r(T -t) EQ [hgas (T, T1 , K )] The next proposition provides an expression for Future prices.

(2.19)

Proposition 2.9. Let St = (St , St , St ) be the process given by equation 2.9 and let F (t, T1 ) be its forward price at t with maturity at T1 (T < T1 ). It is given by: F (j ) (t, T1 ) = S0 Aj (T1 )Bj (t, T1 )et j = 1, 2, 3 where: Aj (T1 ) = e(r-mj )(1-e Bj (t, T1 ) = e
T1 t -j T1

(1)

(2)

(3)

(j )

(j )

(2.20)

)+µT

(j )

V (j ) (-iej (T1 -s) )ds

t Proof. Using proposition 2.7:

(j )

=

(j ) t -j (T1 -s) dVs 0 e

F (j ) (t, T1 ) = EQ [ST /Ft ] = Aj (T1 )EQ [e = S0 Aj (T1 )e = S0 Aj (T1 )e
(j ) (j )
(j ) t -j (T1 -s) dVs 0 e T1 t

(j )

(j ) t -j (T1 -s) dVs 0 e (j )

/Ft ]

EQ [e

T1 t

e-j (T1 -s) dVs
(j )

]

V (j )

(-ie-j (T1 -s)ds )et

2.5

Multivariate Jump-Diffusion Model

The methodology developed for the Jump-diffusion model simulates the process of the model. The first step in to algorithm is the solve the stochastic differential equation (SDE) using the Euler-Maruyama Method. The method includes a Brownian component, as well as a Compound Poisson process. The electricity market moves different as the seasons vary, which can be described as seasonality. A seasonal component can be added to the trajectory, 22

dµt . This will be discussed in detail in Section 3.9. We assume a multidimensional jump diffusion dynamics under the Risk Neutral Probability. Recall the Jump-diffusion model being used is: ~t dY
(j )

~t (j ) )dt + j dB (j ) + dZ (j ) = dµt + j (r - mj - Y t t

(2.21)

and from Pascucci (2011), mj is a vector with components:

mj = logZ (-i) See [13].

(2.22)

Consider the case of a bivariate model with both independent and common jumps with Gaussian distributions, Xk  N (µJ , (J )2 ) and X0,k  N (µ0,J , 0,J ) . The compensator mj for the jump diffusion process can be computed as
(j ) jj 2 (j ) 1 (j ) 2 1 1 mj = diag ()j e(µJ + 2 (J ) -1) + 0 e(µ0,J + 2 (0 ) -1) , j = 1, 2, 3 2

(j )

(j )

(j )

(2.23)

where the matrix  = (jl )j,l=1,2,3 is symmetric, positive, and definite. We use a Compound Poisson Process to partially simulate the Levy component of the Jump Diffusion Model.

Nt

(j )

Nt

(0)

Zt

(j )

=
k=1

Xk +
k=1

(j )

X0,k

(j )

(2.24)

We also define two sequences of independent and identically distributed 1x2 dimensional random vectors (Xk ) and (X0,k ). The components of the first vector denoted by (Xt ), j = 1, 2, 3 are independent with equal cumulative distribution function FX for every k. 23
(j )

The vectors X0,k = (X0,k , X0,k , X0,k )' have joint cumulative distribution function FX for every k. The process Zt = (Zt , Zt , Zt )' is a d-variate compound Poisson process with components where (Nt ) = (Nt , Nt , Nt ) is a vector of independent poisson processes with respective intensities j , j = 1, 2, 3. The processes correspond to the idiosyncratic and common jumps of the underlying assets of the interval [0,t] with jump sizes Xk , and X0,k . See [11] for Pricing Spark Spread contracts under some classes of Levy processes (working paper).
(1) (2) (3) (1) (2) (3)

(1)

(2)

(3)

2.6

Multivariate Time-Changed Models

We also consider an alternative model, which is a Levy process with infinitive activity, i.e infinitely many jumps in finite intervals. Specifically, an exponential multivariate time changed model. We can start to model this by allowing the relationship between calendar time and the pace of the market to be random. We call a stochastic process which models the random clock a time changed model. See [19]. We consider an exponential multivariate time changed Levy model with subordinator, given by a multivariate Inverse Gaussian process. The dependence between both underlying assets is given through the Brownian components as well as the time- changed subordinator. We also consider a drift given by mean reverting component. See [4]. Recall the Time-changed model ~t dY
(j )

~t (j ) )dt + dBZt =  (r - m - Y

(2.25)

24

where Zt
(0) (1) (j )

= Lt + cj L(t) j = 1, 2, 3
(3)

(0)

(j )

(2.26)

where (Lt )t0 = (Lt , Lt , Lt , Lt )t0 is a multivariate Levy process with independent components. The compensator can be calculated i 2 i 2 mj = L0 (- j ) + L(j ) (- cj j ) 2 2

(2)

(2.27)

The characteristic function IG is defined as a Normal Inverse Gaussian distribution L(j ) as follows:

IG (u) = -aj ( L(j )

-2iu + b2 j - bj
(1) (2)

(2.28)
(3)

We set Vt = dBZt for the context of the time changed process, BZt = (BZt , BZt , BZt ),  = (1 , 2 , 3 ) mean-reverting coefficients, and  = (1 , 2 , 3 ) are volatility coefficients, r = (µQ , µQ , µQ ) the risk-premium measure. Table 2.1 outlines the different characteristics of the distributions relevant to the techniques created. The jump-diffusion model uses a normal distribution for simulating the Brownian motion, and a poisson distribution in simulating the compound Poisson process. The time-changed model uses a normal distribution for simulating the Brownian motion, and an inverse Gaussian distribution for simulating the subordinator. Notice a normal distribution has zero skewness, assuming symmetry, which is not realistic specifically when observing the empirical pricing data. A Poisson distribution, and inverse Gaussian distribution have non-zero, positive skewness and excess kurtosis, imply(1) (2) (3)

25

Table 2.1: Variables and the Respective Parameters

Type Normal Distribution Poisson Distribution Inverse Gaussian Distribution

Mean µ  a

Standard Deviation 2 
a3 b

Skewness 0 - 2
1

Excess Kurtosis 0 -1

2 3( a b)

1

15a b

ing heavy tails. This is relevant to pricing data because it portrays lower risk in the prices simulated. These characteristics provide reasoning for creating two techniques which use a superposition of various distributions to characterize the dynamics of the empirical data.

26

Chapter 3

MONTE CARLO PRICING OF SPARK SPREAD CONTRACTS: ALGORITHM AND NUMERICAL RESULTS

In this chapter, we define the general algorithms to price spark spread options. The Monte Carlo Method is introduced followed by a flowchart which depicts the procedure of the pricing techniques created. The algorithm for each of the input functions is outlined: the Brownian motion simulation, the compound Poisson process simulation, the inverse Gaussian method simulation and the the Euler- Maruyama Method simulation. Each of these algorithms is introduced prior to the Monte Carlo general pricing algorithm to portray the procedure of the pricing technique. The algorithms to simulate the two proposed models, a Jump-Diffusion Model and a Time-Changed Model are then given, followed by the empirical data obtained. The numerical results are then computed.

3.1

The Monte Carlo Method and Pricing Applications

The Monte Carlo Method functions on two foundations; the Law of Large Numbers (LLN), and randomness. The LLN generally states that the average of the results from performing the same experiment a large number of times n should be close to its expected value, and usually becomes closer as n increases. See [7]. There are two laws within LLN; the Strong

27

Law of Large Numbers(SLLN), and the Weak Law of Large Numbers(WLLN). The Monte Carlo Method is convergent in both a strong and weak sense, therefore the SLLN is proposed below. Proposition 3.1. The Strong Law of Large Numbers. Let X1 , X2 , ..., Xn be an independent identically distributed sequence of random variables where E [X1 ] <  Then,
1 n  n=1 Xn

 E [X1 ]

as n  . See [21] The randomness comes from generating suitable random numbers using different generating techniques. A random number generator must be used for this method. Both pricing models created use various types of random numbers, each relevant to the processes used to characterize the dynamics of prices. The Jump Diffusion Model uses a combination of normal univariate, multivariate, and Poisson random numbers, whereas the Time Changed Model uses random numbers from an Inverse Gaussian distribution, as well as normally distributed random numbers. The algorithms for each component of the two techniques proposed to price the spark spread options are presented below. Figure 3.1 gives a breakdown of how the processes combine to give the desired output, the Spark Spread Price. The initial step is to simulate the processes used within each model. Three dimensional Brownian motion, a compound Poisson process, and an inverse Gaussian subordinator are the initial simulations required. Subsequently, the Euler - Maruyama method is used to simulate a trajectory of log return prices, used to compute the spot price. In parallel to the Euler Maruyama function, the 28

Figure 3.1: Flowchart Depicting the functions created to obtain the Spark Spread Price.

seasonality component, a characteristic function is computed, as well as a characteristic exponent is computed. These functions are inputs into the main pricing function. Since we propose two models to price the spark spread options, two main pricing functions exist, one for each model. The pricing functions then use the Monte Carlo Method and simulate the spark spread option price. To begin, the algorithms of the input functions are discussed. Followed by the algorithm of the Euler-Maruyama method, the Monte Carlo Method, and the Future pricing algorithm.

3.2

Algorithms of Monte Carlo Input Functions

Each process or function used in the methodology has its own respective algorithm which acts as the foundation to the software implementation. The algorithms for Brownian motion, compound Poisson process, inverse Gaussian process, Euler-Maruyama method, and the Monte Carlo method are described in this section.

29

3.2.1

Algorithm for Generating Brownian Motion

We begin with a three dimensional Brownian motion model, with dependent components B , µ, T, and  t, which outputs a n by j matrix of the Brownian component. In general, here is the algorithm to model the equation Xt = µt + Wt + Zt . Algorithm (1) The subintervals, n, is calculated using the maturity period T, and increment t as n=
T t

such that n is an integer

(2) The correlation matrix is created as    1 12 13       = 12 1 23       13 23 1

B

(3) The zero mean is given by
T

µ=

0 0 0

(4) Using a multivariate random number generator the three dimensional Brownian motion is simulated with zero mean and correlation B . Figure 3.2 demonstrates a daily three dimensional Wiener process simulation for t = [0,T], with zero mean and B obtained from empirical data analysis. Each index is represented with a different colour.

30

Figure 3.2: Three Dimensional Brownian Motion Simulation

Trajectory of Brownian Motion simulated using empirical correlation matrix (See section 3.10), with zero mean, maturity T = 1 year and t = 1 day.

3.2.2

Algorithm for Generating Compound Poisson Process

The next step is to model the compound Poisson process with the input parameters µj , j , j , T, and  t, which outputs a n by j matrix of the compound Poisson process component. The parameters are estimated from empirical data analysis. In general, here is the algorithm to model the equation Zt
(j )

=

Nt k=1

(j )

Xk +

(j )

Nt k=1

(0)

X0,k .

(j )

31

Algorithm (1) n is calculated using the maturity period T, and increment t as n = (2) Nt
(0) T t

and Nt

(j )

are simulated via a Poisson random number generator, with parameters

0 and j respectively. (3) Xk
(j )

are simulated via a normal random number generator, with parameters µj and

j . (4) X0,k is simulated via a multivariate normal random number generator, with parameters µ as
T (j )

µ=

µ1 µ2 µ3

and  as the covariance matrix   11 12 13        = 21 22 23       31 32 33 (5) The variables are correctly summed after created, and the compound Poisson process is simulated. Figure 3.3 demonstrates a daily compound Poisson process simulation for t = [0,T], with zero mean, ij = 0.01 and 0,1,2,3 = 5. Both the independent and common jumps are visible, which can be observed in the jumps that occur on the same days versus jumps that are unique to the index. 32

3.2.3

The Inverse Gaussian Method

The Time-Changed model proposed, uses an Inverse Gaussian subordinator. To sample from an IG(a,b) distribution, we use the following algorithm known as the IG generator of Michael, Schucany and Haas. See [9]. Algorithm (1) Generate a standard Normal random number v . (2) Set y = v 2 . (3) Set x = (a/b) + y/(2b2 ) - 4ab + y 2 /(2b2 ) (4) Generate a uniform random number u. (5) If u  a/(a + xb), then return the number x as the IG(a, b) random number, else return a2 /(b2 x) as the IG(a, b) random number Lt . (6) Finally, we simulate Zt
(j ) (j )

where
(j )

Zt

= L0 t + cj Lt

(j )

(3.1)

Figure 3.4 demonstrates an inverse Gaussian process simulation for t = [0,T], with a = 0.001 and b = 0.01. The parameters a and b represent the mean and standard deviation of the process, respectively. Evidently, the slope of the trajectory is varied. A steeper slope observed throughout the interval results in a greater change in the spot price.

33

3.2.4

Euler-Maruyama Algorithm

The Euler-Maruyama Method solves the stochastic differential equation dYt = (r - m - Yt )dt + dVt The error in the approximation is O(t) where t is the increment. This method is used over other existing methods of approximation, such as the Milstein method or the RungeKutta method for simplicity in implementation. We obtain values for Yend , Yend , Yend which are the final positions of the trajectory simulated using this method. Subsequently we will obtain the spot prices which will be directly used in the Future price calculations. Finally we add the seasonal component, µt . Algorithm (1) We begin by computing µt as in equation 3.27 or 3.26, depending on the underlying commodity. (2) We define dVt for each model. Recall that for the Jump diffusion method dVt is given by dVt = dBt + dZt and for the Time - Changed method dVt is given by dVt = dBZt where Zt
(j ) (1) (2) (3)

is defined as a Levy Process given by Zt

(j )

= L0 t + cj Lt .

(j )

(3) We simulate the specific mj as given in equations 2.23 and 2.27 (4) We solve the stochastic differential equation for Yt at each time t as in equation 2.7. (5) We solve for Yt = Yt + µt where Yt is the trajectory of seasonalized log returns. (6) We obtain YT , where T is maturity, and solve (2.9) for the spot price. 34

Obtaining the spot for each of index allows us to calculate the Future's price using expectation which is applied to the model. The model computes Future prices for each index within a loop to obtain values of Future prices. The payoff is initially calculated using the formulas (2.14) and (2.15). Using Monte Carlo simulation, determine the average payoff is computed; the fair price of the contact will be the discounted payoff using formula (2.18) and (2.19).

35

Figure 3.3: Multivariate Compound Poisson Process Simulation

Compound Poisson Process simulated for electricity, uranium, and natural gas using 0,1,2,3 = 5, with zero mean, ij = 0.01 maturity T = 1 year and t = 1 day. Both idiosyncratic and independent jumps are present.

36

Figure 3.4: Inverse Gaussian Subordinator Simulation

Inverse Gaussian subordinator simulated using a = 0.001, b = 0.01, maturity T = 1 year and t = 1 day.

37

Figure 3.5: Seasonalized Log Returns for Electricity, Uranium, and Natural Gas using the Jump-Diffusion model

Seasonalized Log Returns for Electricity, Uranium, and Natural Gas using the Jump-Diffusion model where dVt = dBt + dZt . The parameters used for this simulation are 0,1,2,3 = 1, with zero mean, 1,2,3 = 0.01, and  = 0.01. Notice that Figures 3.5 and 3.6 look almost identical; the seasonal component (annual and weekly periods) is weak and has very little impact on the log-return simulation with the chosen parameters. See section 3.9 for an estimation of parameters via regression.

38

Figure 3.6: Deasonalized Log Returns for Electricity, Uranium, and Natural Gas using the Jump-Diffusion model

Deasonalized Log Returns for Electricity, Uranium, and Natural Gas using the Jump-Diffusion model where dVt = dBt + dZt . The parameters used for this simulation are 0,1,2,3 = 1, with zero mean, 1,2,3 = 0.01, and  = 0.01. Notice that figures 3.5 and 3.6 look almost identical; the seasonal component (annual and weekly periods) is weak and has very little impact on the log-return simulation with the chosen parameters. See section 3.9 for an estimation of parameters via regression.

39

Figure 3.7: Spot Price Simulation for Electricity, Uranium, and Natural Gas using a JumpDiffusion model

Spot Price Simulation for Electricity, Uranium, and Natural Gas using the Jump-Diffusion model where dVt = dBt + dZt . The parameters used for this simulation are 0,1,2,3 = 1, with zero mean, 1,2,3 = 0.01, and  = 0.01.

40

Figure 3.8: Seasonalized Log Returns for Electricity, Uranium, and Natural Gas using a Time-Changed

Seasonalized Log Returns for Electricity, Uranium, and Natural Gas using the Time-Changed model where dVt = dBZt . The parameters used for this simulation are c0,1,2,3 = 1, with zero mean, 1,2,3 = 0.01,  = 0.01, a = 0.01, and b = 0.1.

41

Figure 3.9: Deseasonalized Log Returns for Electricity, Uranium, and Natural Gas using a Time-Changed model

Deasonalized Log Returns for Electricity, Uranium, and Natural Gas using the Time-Changed model where dVt = dBZt . The parameters used for this simulation are c0,1,2,3 = 1, with zero mean, 1,2,3 = 0.01,  = 0.01, a = 0.01, and b = 0.1.

42

Figure 3.10: Spot Price Simulation for Electricity, Uranium, and Natural Gas using a TimeChanged model

Spot Price Simulation for Electricity, Uranium, and Natural Gas using the Time-Changed where dVt = dBZt . The parameters used for this simulation are c0,1,2,3 = 1, with zero mean, 1,2,3 = 0.01,  = 0.01, a = 0.01, and b = 0.1.

43

3.3

Monte Carlo General Pricing Algorithm

The algorithm for pricing spark spread options using the Monte Carlo Simulation Method consists of the following steps: (1) Divide the interval (0,T) into n intervals of length t, repeating the 3 simulations to obtain the j-th simulation of the sequence of prices: St , S2t , S3t , ..., Snt = ST , for j = 1, 2, 3 (2) Compute Future price using equation (2.20) (3) Compute the approximation for expectation 1 n
(j ) (1) n (j ) (j ) (j ) (j ) (j )

(3.2)

h(ST )
n=1 (2)

(j )

EQ [h(ST )]
(j ) (1) (3)

(j )

(3.3)

where h(ST ) = (FT - curan FT - K )+ and h(ST ) = (FT - cgas FT - K )+ . (4) Compute the approximation for the price of the option P e-r(T -t) EQ [h(ST )]
(j )

(3.4)

3.4

Computing the Future Price under a Jump Diffusion Model

The algorithm designed to compute the Future price under a jump diffusion model is outlined below. The model contains a superposition of 3 processes: three dimensional Brownian motion, a compound Poisson process, and a seasonality component. Recall that the EulerMaruyama method gives the spot price at time t, t < T (maturity). 44

Algorithm (1) Once we obtain the spot price, we find the Future price using the formulas below: j = 1,2,3 F (j ) (t, T1 ) = S0 Aj (T1 )Bj (t, T1 )et Aj (T1 ) = e(r-mj )(1-e Bj (t, T1 ) = e t
(j ) t
T1 t -j T1

(j )

(j )

(3.5) (3.6) (3.7) (3.8)

)+µT

(j )

 (-iej (T1 -s) )

ds

=
0

e-j (T1 -s) dVs(j )

(a) Computing dVs for each respective model. Recall that dVt = dBt + dZt for the jump-diffusion model and dVt = dBZt for the time-changed model. (b) Evaluating e-j (T1 -s) multiplied by the increment dVs for every s. (c) Evaluating t
(j )

using the sum

(j ) t -j (T1 -s) dVs 0e

(2) From this simulation we obtain vectors for F (1) (t, T1 ), F (2) (t, T1 ), F (3) (t, T1 ) where the number of components corresponds to the number of simulated trajectories, m. (3) Once we have obtained the Future prices, we compute the payoff using the formulas below: hura (t, t1 , K ) = (F (1) (t, T1 ) - cura F (2) (t, T1 ) - K )+ hgas (t, t1 , K ) = (F (1) (t, T1 ) - cgas F (3) (t, T1 ) - K )+ (3.9) (3.10)

where hura (t, T1 , K ) and hgas (t, T1 , K ) are the payoffs for uranium and natural gas.

45

(4) We then take the expectation using a mean formula: ¯ ura = 1 h m ¯ gas = 1 h m
m

(hura (t, T1 , K ))
i=1 m

(3.11)

(hgas (t, T1 , K ))
i=1

(3.12)

(5) And finally, we are able to retrieve a price from the simulation using a discount equation: ¯ ura ) P riceura = e-rT (h ¯ gas ) P ricegas = e-rT (h (3.13) (3.14)

46

Figure 3.11: Simulated Future Prices for Electricity, Uranium, and Natural Gas using a Jump-Diffusion Model

Simulated Future Prices for Electricity, Uranium, and Natural Gas using a Jump-Diffusion Model: the graphs above show the Future prices computed using the Monte Carlo Method on a jump diffusion model with n = 1000.

47

3.5

Computing the Future Price under a Time Changed Model

The algorithm designed to compute the Future price under a time-changed model is outlined below. The model contains a superposition of 3 processes: three dimensional Brownian motion, an inverse Gaussian subordinator, and a seasonality component. Recall that the Euler-Maruyama method gives the spot price at time T (maturity). Algorithm (1) The first step is to calculate L(j ) with different values for a and b. L(j ) (u) = -aj ( -2iu + b2 j - bj )
t

(3.15)

(2) Then we find mj using equation (2.27) The next step in the time changed algorithm is to simulate the inverse Gaussian subordinator Lt compute Zt
(j ) (j )

for j = 0, 1, 2, 3 as mentioned in the section above. We then

where: Zt
(j )

= L0 t + cj Lt

(j )

(3.16)

This is where the time-changed component of the model begins. We will now simulate a Brownian motion, however, the random process is evaluated and random times given by Zt . We assume independence and generate BZt 1 , BZ 2 , BZ 3 . t t Now we compute Vt
(j ) (j )

where: dVt
(j )

= j dB

(j )
(j )

Zt

(3.17)

48

Now we use the Euler-Maruyama method to solve the stochastic differential equation to obtain Yt and St . dYt = dµt + (r - m - Yt )dt + dBZt (3.18)

After obtaining dYt , which is a n x j vector, we use YT , which is the solution to the equation at time T (maturity) for (2.9) to compute ST . Parallel to computing YT and ST using Euler Maruyama and the Log returns formula, we also compute t
(j )

where:
t (j ) t

=
0

e(j ) (sj -t) dVs(j )

(3.19)

Once again from this simulation we obtain vectors for F (1) (t, T1 ), F (2) (t, T1 ), F (3) (t, T1 ) using the Future price formula (2.20). After obtaining the Future prices, the process is the same as the jump-diffusion model. We compute the payoff using the formulas below: hura (t, t1 , K ) = (F (1) (t, T1 ) - cura F (2) (t, T1 ) - K )+ hgas (t, t1 , K ) = (F (1) (t, T1 ) - cgas F (3) (t, T1 ) - K )+ (3.20) (3.21)

where hura (t, t1 , K ) and hgas (t, T1 , K ) are the payoffs for the uranium and natural gas underlying commodities. We then approximate the expectation using a mean formula: ¯ ura = 1 h m
m

(hura (t, T1 , K ))
i=1

(3.22)

49

¯ gas = 1 h m

m

(hgas (t, T1 , K ))
i=1

(3.23)

And finally, we are able to retrieve a price from the simulation using a discount equation: ¯ ura ) P riceura = erT (h ¯ gas ) P ricegas = erT (h (3.24) (3.25)

50

Figure 3.12: Simulated Future Prices for Electricity, Uranium, and Natural Gas using a Time-Changed Model

Simulated Future Prices for Electricity, Uranium, and Natural Gas using a Time-Changed Model: the graphs above show the future prices computed using the Monte Carlo Method on a jump diffusion model with n = 1000.

51

3.6

Empirical Data

The empirical data is composed of historic daily prices for the commodities, electricity, uranium, and natural gas, obtained from Bloomberg for a five year period. Table 3.1: Statistics of Empirical Data

Series Electricity Uranium Natural Gas

Mean 27.7602 44.7978 38.4660

Median 25.9839 43.2500 38.6915

Standard Deviation 19.4909 9.6216 2.4476

Skewness 4.7171 0.4403 -0.1354

Excess Kurtosis 43.9029 2.7754 2.0720

The statistics above are calculated from the empirical pricing data of each commodity. Notably, the standard deviation of natural gas is 2.4476, quite lower than that of electricity or uranium. The skewness is non-zero for all 3, as well as the excess of kurtosis. Electricity has a high standard deviation that can be attributed to rather large jumps observed in the electricity Future series (see Figure 3.13). The peak of the electricity price is $275, compared to a mean of $27.76, a jump of over 1000%. In addition to high jumps, we also observe a strong mean reversion. The excess kurtosis is also very high, which depicts a heavy tail in the distribution, as seen in Figure 3.13. In Table 3.2 the empirical correlation values are presented. To obtain the values, the correlation function in MATLAB was used once the data had been aligned. Aligning the data involved manually omitting data from the electricity price series, since that data set is daily, whereas the underlying commodity data set was available for business days only. 52

Table 3.2: Table of Empirical Correlation (ij )

Series Electricity Uranium Natural Gas

Electricity 1 -0.0322 -0.1755

Uranium -0.0322 1 0.4646

Natural Gas -0.1755 0.4646 1

Once the data was aligned and the prices were organized by date, the correlation values were computed via MATLAB. The term (2,3) is found to be 0.465, which is logical based on market trends. This correlation value relates the price of the two underlying commodities, uranium and natural gas, with each other. It is coherent that the increase of one commodity price would affect the other. The terms for (1,2) and (1,3) were observed to be negative and insignificant in value.

53

Figure 3.13: Empirical Pricing Series for Electricity, Uranium, and Natural Gas

Empirical Pricing Series for Electricity, Uranium, and Natural Gas: the graphs above show the pricing data for the commodities of interest. The first graph shows the electricity pricing data 5 years. The second graph shows the uranium pricing data for 3 years. The third graph shows the natural gas pricing data for 2 years. High jumps and mean reversion are observed for the electricity price series. A gradual increase in combination with jumps and steadiness is observed in the uranium price series. A combination of and jumps, volatility, and mean reversion are observed in the natural gas price series. 54

3.7

Monte Carlo Pricing Computation

This section presents the results obtained from the methodology proposed to price spark spread options. Three dimensional graphs have been employed to represent the impact between the various parameters present in each model. The Monte Carlo method is used with n = 50000 runs for each iteration of each graph. It is recognized that a higher repetition would lead to more precise results. Table 3.3 indicates the parameters held constant when others are being changed, unless otherwise indicated, observed in Figures 3.14 -3.29. The assigned parameters are different from the empirical parameters since we are using broad modelling conditions, not specific to the market for a five year period. Table 3.3: Simulation Parameters Held Constant During Simulation

T 1

T1 1.5

K 0

 0.15

0 1

1 1

2 1

3 1

1 0.20

2 0.20

3 0.20

curan 0.5

cgas 1

3.7.1

Monte Carlo Pricing under a Jump-Diffusion Model

To observe the dynamics of the prices for the spark spread contracts under a jump-diffusion model, three dimensional graphs have been created. Figure 3.14 portrays the price of the spark spread option for uranium versus the maturity and strike price. As the strike price increases, the spark price decreases, as expected based on the payoff formula (2.14). As the maturity increases, there is a slight increase in the spark price. The slight, steady increase can be attributed to the fact that the price of the contract is based on the Future 55

price. As maturity, T, increases, the the Future maturity, T1 increased as well. Figure 2.15 graphs the price of the spark spread option for natural gas versus the maturity and strike price. The same trends as Figure 3.14 are observed, except we see more of an increase as maturity increases. The main difference between the two simulations, for spark spread contract prices of uranium and natural gas, is the conversion constants used, cura and cgas . The strike price range taken for these graphs was 0,...,10, and the maturity was taken as T = ( 0.25 0.50 0.75 1.00 1.25 ). Figures 3.16 and 3.17 show the interaction between spark spread prices for uranium and natural gas and the two variables associated with the compound Poisson process in the jump diffusion model. Lambda represents the jumps that occur in prices. Recall that this process was used as a part of the model since jumps were observed in the empirical data. Here, the interaction is shown between the price and both the lambda quantifying the common jump (jumps observed in all commodities) and the independent jump (jumps observed in only the respective commodity). In both graphs as the independent lambda was increased, an slight increase in the spark price was observed; however, very little variation in price (within cents) can be reserved to randomness as well. The minimal increase can be attributed to the fact that the jump size was taken as a zero mean. Although more jumps are observed, the price sees some insignificant change because both negative and positive jumps are observed, resulting in an expectation of zero. Figures 3.18 and 3.19 show the heavy interaction between electricity , uranium and electricity , gas . This parameter is characterized as the coefficient volatility of the Wiener

56

process in the jump diffusion model. In both commodities, as the independent volatility increased, the price of the spark spread option increased, almost linearly. As the volatility of electricity increased at the same rate, a much slower increase of the price was observed. As the two parameters increased together, a rapid increase was observed. This result is consistent with what was expected, as the volatility commonly represents the risk associated with the changes in that commodity's value. Figures 3.20 and 3.21 present the interaction between the spark spread option prices and the values in the correlation matrix, using in the Wiener process component. A relevant impact of these values is not observed in the given range. The range for the  values was obtained through the correlation values calculated using the empirical data. Obtaining the empirical correlation values posed a challenge, as the data available was daily for electricity prices, business daily for uranium prices, and sparse for natural gas. The accurate values can be found in table 3.2. The little variation observed in the graphs can be attributed to randomness in simulation.

57

Figure 3.14: Spark Prices for Uranium

Spark Prices for Uranium: The 3-D graph shows the interaction between T (Maturity of the Spark Spread Option), K (Strike Price of the Spark Spread Option) and the Price of the Spark Spread Option simulated through a jump-diffusion model.

58

Figure 3.15: Spark Prices for Natural Gas

Spark Prices for Natural Gas: The 3-D graph shows the interaction between T (Maturity of the Spark Spread Option), K (Strike Price of the Spark Spread Option) and the Price of the Spark Spread Option simulated through a jump-diffusion model.

59

Figure 3.16: Interaction of Spark Prices for Uranium with Lambda

Spark Prices for Uranium: The 3-D graph shows the interaction between 0 , 2 and the Price of the Spark Spread Option simulated through a jump-diffusion model, where 0 = 5 and 2 = 5

60

Figure 3.17: Interaction of Spark Prices for Natural Gas with Lambda

Spark Prices for Natural Gas: The 3-D graph shows the interaction between 0 , 2 and the Price of the Spark Spread Option simulated through a jump-diffusion model, where 0 = 1, .., 5 and 2 = 1, .., 5

61

Figure 3.18: Spark Spread Prices for Uranium Interaction with electricity and uranium

Spark Prices for Uranium: The 3-D graph shows the interaction between 1 , 2 and the Price of the Spark Spread Option simulated through a jump-diffusion model, where 1 = 0.05, ..., 0.25 and 2 = 0.05, ..., 0.25

62

Figure 3.19: Spark Spread Prices for Natural Gas Interaction with electricity and gas

Spark Prices for Natural Gas: The 3-D graph shows the interaction between 1 , 2 and the Price of the Spark Spread Option simulated through a jump-diffusion model, where 1 = 0.05, ..., 0.25 and 2 = 0.05, ..., 0.25

63

Figure 3.20: Spark Spread Prices for Uranium Interaction with 12 and 13

Spark Prices for Uranium: The 3-D graph shows the interaction between 12 , 13 and the Price of the Spark Spread Option simulated through a jump-diffusion model, where 12 = -0.20, ..., 0.20 and 13 = -0.10, ..., 0.10

64

Figure 3.21: Spark Spread Prices for Uranium Interaction with 12 and 13

Spark Prices for Natural Gas: The 3-D graph shows the interaction between 12 , 13 and the Price of the Spark Spread Option simulated through a jump-diffusion model, where 12 = -0.20, ..., 0.20 and 13 = -0.10, ..., 0.10

65

3.8

Monte Carlo Pricing under a Time-Changed Model

To observe the dynamics of the prices for the spark spread contracts under a time changed model, three dimensional graphs have been constructed. Figures 3.22 and 3.23 portrays the price of the spark spread option for uranium versus the maturity and strike price. As the strike price increases, the spark price decreases, as expected based on the payoff formula (2.14). As the maturity increases, there is a slight increase in the spark price, as seen in the jump diffusion model. Both graphs demonstrate a sharp increase in price, for uranium the increase is observed when the strike price was $4 and for natural gas the increase is observed at $6. Again, this difference may be attributed to the conversion constants used, cura and cgas . The strike price range taken for these graphs was 0,...,10, and the maturity was taken as T = ( 0.25 0.50 0.75 1.00 1.25 ). Figures 3.24 and 3.25 show the interaction between the spark spread option price and the inverse Gaussian process parameters, a and b. Recall that a represents the mean, µ and b represents the variance, . In both graphs, the price is almost constant as a increases. In Figure 3.24, a significant increase in price is observed exclusively when both a and b are being increased. In figure 3.25, a significant price increase is observed when only b is increased. For these simulations, a maturity of 1 year and a strike price of $0. Figures 3.26 and 3.27 show a minimal interaction between electricity , uranium and electricity , gas . This parameter is characterized as the coefficient volatility of the Wiener process in the Time-Changed model. In both commodities, very little variation in price is observed with the increase of either commodity's volatility. The variation observed was

66

within cents. This can be attributed to the fact that since the risk associated with both electricity, and the underlying commodity, the change of the spark spread option price remains somewhat constant. Recall that this option price is a difference between electricity Future price and the underlying Future price; if both were to increase or decrease together, the difference may remain somewhat constant. Figures 3.28 and 3.29 present the interaction between the spark spread option prices and the values in the correlation matrix, using in the Wiener process component. Very similar results were obtained via the same interaction for the jump diffusion model. Again, a relevant impact of these values is not observed in the given range. The range for the  values was obtained through the correlation values calculated using the empirical data. Obtaining the empirical correlation values posed a challenge, as the data available was daily for electricity prices, business daily for uranium prices, and sparse for natural gas. The accurate values can be found in Table 3.2. The little variation observed in the graphs can be attributed to randomness in simulation.

67

3.8.1

Pricing Computation Comparison between Models

To compare how each model interacts with different initial spot prices, figures 3.30 and 3.31 were created. Figure 3.30 displays the difference in spark spread price between natural gas and uranium using a jump diffusion model and figure 3.31 displays the difference in spark spread price between commodities using a time changed model. In addition to the initial spot price, another difference between the spark spread prices for each commodity is the conversion factor used. For convenience, the values used in simulation are cura = 1 and cgas = 0.5. For the jump diffusion model, as strike price increases, an almost steady decrease in price is observed. For the time changed model, there is a steep decrease in price when the strike price is approximately $6. Numerically, the range of the difference is the same. The highest difference in the spark spread price between commodities is at zero strike price and is $2.25- $2.42 for both models. Figures 3.32 ad 3.33 portray the difference in spark spread price for each commodity between models. For uranium, the maximum difference in price is approximately 78 cents, observed at strike price of $5. For natural gas, the maximum difference in price a little higher, approximately one dollar, observed at strike price of $7. For both commodities, as the strike price is $0 or $10, very little difference between the spark price is observed.

68

Figure 3.22: Future Prices for Uranium

Spark Spread Prices for Uranium: The 3-D graph shows the interaction between T (Maturity of the Spark Spread Option), K (Strike Price of the Spark Spread Option) and the Price of the Spark Spread Option simulated through a time-changed model.

69

Figure 3.23: Future Prices for Natural Gas

Spark Spread Prices for Natural Gas: The 3-D graph shows the interaction between T (Maturity of the Spark Spread Option), K (Strike Price of the Spark Spread Option) and the Price of the Spark Spread Option simulated through a time-changed model.

70

Figure 3.24: Spark Spread Prices for Uranium Interaction with Inverse Gaussian variables a, b

Spark Spread Prices for Uranium Interaction with Inverse Gaussian variables a, b. The variable a was altered between 0.0001 and 0.001 and b were altered between 0.05 and 0.20. The graph shows very little interaction between the spark spread price and the variables.

71

Figure 3.25: Spark Spread Prices for Natural Gas Interaction with Inverse Gaussian variables a, b

Spark Spread Prices for Uranium Interaction with Inverse Gaussian variables a, b. The variable a was altered between 0.0001 and 0.001 and b were altered between 0.05 and 0.20 The graph shows very little interaction between the spark spread price and a, and a proportional interaction between the spark spread price and b.

72

Figure 3.26: Spark Spread Prices for Uranium Interaction with electricity and uranium

Spark Spread Prices for Uranium Interaction with Inverse Gaussian variables a, b. The variable a was altered between 0.0001 and 0.001 and b were altered between 0.05 and 0.2

73

Figure 3.27: Spark Spread Prices for Natural Gas Interaction with electricity and gas

Spark Spread Prices for Natural Gas

74

Figure 3.28: Spark Spread Prices for Uranium Interaction with 12 and 13

Spark Prices for Uranium: The 3-D graph shows the interaction between 12 , 13 and the Price of the Spark Spread Option simulated through a time changed model, where 12 = -0.20, ..., 0.20 and 13 = -0.10, ..., 0.10

75

Figure 3.29: Spark Spread Prices for Natural Gas Interaction with 12 and 13

Spark Prices for Natural Gas: The 3-D graph shows the interaction between 12 , 13 and the Price of the Spark Spread Option simulated through a time changed model, where 12 = -0.20, ..., 0.20 and 13 = -0.10, ..., 0.10

76

Figure 3.30: Difference in Spark Spread Prices when the Underlying is Uranium or Natural Gas for a Jump Diffusion Model

Spark Spread Price Differences: The 3-D graph shows the interaction between T (Maturity of the Spark Spread Option), K (Strike Price of the Spark Spread Option) and the difference in the Price of the Spark Spread Option simulated through a jump diffusion model.

77

Figure 3.31: Difference in Spark Spread Prices when the Underlying is Uranium or Natural Gas for a Time Changed Model

Spark Spread Price Differences: The 3-D graph shows the interaction between T (Maturity of the Spark Spread Option), K (Strike Price of the Spark Spread Option) and the difference in the Price of the Spark Spread Option simulated through a time changed model.

78

Figure 3.32: Difference in Spark Spread Prices for Uranium between a Jump Diffusion Model and Time Changed Model

Spark Spread Price Differences: The 3-D graph shows the interaction between T (Maturity of the Spark Spread Option), K (Strike Price of the Spark Spread Option) and the difference in the Price of the Spark Spread Option simulated for Uranium between the two models.

79

Figure 3.33: Difference in Spark Spread Prices for Natural Gas between a Jump Diffusion Model and Time Changed Model

Spark Spread Price Differences: The 3-D graph shows the interaction between T (Maturity of the Spark Spread Option), K (Strike Price of the Spark Spread Option) and the difference in the Price of the Spark Spread Option simulated for Natural Gas between the two models.

80

3.9

Regression Analysis: Estimation of Seasonal Components
(j )

We assume two types of stationary maturity to describe the j-th component in µt

for the

log-return model. The linear trend observed in the uranium commodity is described by
(j ) (j ) (j )

µt

= a0 + a1 t, j = 1, 2, 3

(3.26)

The seasonal trend observed in the electricity and natural gas commodity is described by
(j ) (j ) (j )

µt
(j ) (j ) (j )

= b0 + b1 cos

2t , j = 1, 2, 3 Tp

(3.27)

where a0 , a1 , b0 , and b1 are computed analytically through regression analysis and can be seen in Tables 3.4 and 3.5. Tp is the period in which the seasonal trend is observed, taken to be 1 year. The period is yearly since the seasonal changes in commodity prices alter on an annual cycle. A linear trend is used for uranium since the commodity price for uranium is observed to be independent of the season or time of year. The correlation between season and price is observed for electricity and natural gas. A simple linear regression analysis was performed to the seasonal models using log returns of the real data using the formula. The reason two different trends are used is due to the effort of obtaining the best data fit. Least squares estimation is the method in regression analysis to minimize the sum of the squares of the errors made in the residual. See [6]. A residual is the difference between the observed value and the actual value. In this case, the observed value is the simulated spark spread price and the actual value is given by the empirical data. See the formulas below:

(j )

81

LSE =

(Yt

(j )

- f (a0 + a1 t))2

(j )

(j )

(3.28)

LSE =

(Yt

(j )

- f (b0 + b1 cos

(j )

(j )

2t Tp

2

(3.29)

In figures 3.22 and 3.24, a seasonal trend was used to fit the data. The slope is observed to be a line, as opposed to a cosine wave due to the small values of the least square estimators, b0 and b1 . The best fit observed was the linear trend for uranium, due to the coefficient of determination R2 = 0.735. A value of 1 for R2 is a perfect fit. Table 3.4: Table of Least Square Estimators using a Seasonal Trend

Commodity Electricity Uranium Natural Gas

b0 1.3005 1.6414 1.584

b1 0.0605 0.0062 -0.007

R2 0.0133 0.0022 0.0392

Table 3.5: Table of Least Square Estimators using a Linear Trend

Commodity Electricity Uranium Natural Gas

b0 1.4584 1.503 1.548

b1 -0.0004 0.0003 0.00009

R2 0.0566 0.735 0.564

82

Figure 3.34: Regression Analysis of Empirical Data for Electricity

Regression Analysis of Empirical Data for Electricity: Least square estimators were found to be b0 = 1.3005, b1 = 0.0605 and the coefficient of determination, R = 0.0133.

83

Figure 3.35: Regression Analysis of Empirical Data for Uranium

Regression Analysis of Empirical Data for Uranium: Least square estimators were found to be b0 = 1.503, b1 = 0.0003 and the coefficient of determination, R = 0.735.

84

Figure 3.36: Regression Analysis of Empirical Data for Natural Gas

Regression Analysis of Empirical Data for Natural Gas: Least square estimators were found to be b0 = 1.584, b1 = -0.007 and the coefficient of determination, R = 0.0392.

85

Chapter 4

CONCLUSIONS

The result of this master's thesis is the creation of a methodology using complex Levy models to price the spark spread contracts. It allows to incorporate empirical features such as jumps, seasonality, and mean reversion. The methodology included statistical empirical analysis followed by software implementation in MATLAB, and complete algorithms for two pricing models. The result includes novel use for the spark spread pricing models; sensitivity analysis and seasonal analysis. The results are best presented using three dimensional graphs, showing the presence, or lack of presence, of impacts of variables present in the models and the contract. The three dimensional graphs help portray relevance of parameters. The challenges faced during creation of the methodology give motivation for Future work on this topic. The empirical data of the electricity prices brought a unique challenge. Referring to the pricing series, a large jump around day 500 is observed where the price jumps from an average of $25 to close to $300 as show in Figure 3.13. This cannot be characterized by the processes proposed. Increasing the number of expected jumps would result in more jumps, and increasing the average jump size could account for the size, however a jump of 1100% is very difficult to simulate assuming normal jump sizes. Regression analysis was computed on the seasonal component using the empirical data.

86

The yearly seasonal component was found to be irrelevant through least square estimation, as after regression analysis. To obtain the correlation matrix of the underlying assets, , the data was matched by date. This preceded challenges, since daily pricing data was not available for each commodity. Daily pricing data was available for electricity, and business daily data was available for uranium, however natural gas posed a challenge as there was some incompleteness in the data set. Manual alignment of the data was performed to obtain accurate empirical correlation values.

87

Chapter 5

APPENDIX: CODE

5.1

Jump Diffusion Model

The function below is the main pricing function for the jump diffusion model. It calls upon other functions which are sequentially listed below.
1 function [ P r i c e u r a P r i c e g a s S 1 S 2 S 3 ] = f u t (K, T, d e l t a t , lambda 0 , lambda 1 , lambda 2 , lambda 3 , alpha , a l p h a 1 , a l p h a 2 , a l p h a 3 , v o l 1 , v o l 2 , v o l 3 , ro12 , ro13 , ro23 , Monte Carlo n ) 2 %Jump D i f f u s i o n Model 3 4 f o r mat l o n g 5 nrep = round (T/ d e l t a t ) ; 6 spot 1 = 30; 7 spot 2 = 53; 8 spot 3 = 24; 9 r = 0.03; 10 T 1 = T + ( 1 / 2 ) ; 11 c u r a n = 0 . 5 ; % c o n v e r s i o n 12 c g a s = 1;% c o n v e r s i o n 13 % K = 9 ; %s t r i k e p r i c e 14 s = l i n s p a c e ( 0 ,T, T/ d e l t a t ) ; %f o r i n t e g r a l c a l c u l a t i o n 15

88

16 %---------------------------- 17 %C a l c u l a t e m 1 , m 2 , m 3 18 19 mu J 1 = 0 ; 20 mu J 2 = 0 ; 21 mu J 3 = 0 ; 22 23 s i g 1 1 = 0 . 0 1 ; 24 s i g 1 2 = 0 . 0 1 ; 25 s i g 1 3 = 0 . 0 1 ; 26 s i g 2 1 = 0 . 0 1 ; 27 s i g 2 2 = 0 . 0 1 ; 28 s i g 2 3 = 0 . 0 1 ; 29 s i g 3 1 = 0 . 0 1 ; 30 s i g 3 2 = 0 . 0 1 ; 31 s i g 3 3 = 0 . 0 1 ; 32 33 mu 0 J1 = 0 ; 34 mu 0 J2 = 0 ; 35 mu 0 J3 = 0 ; 36 37 m 1 = lambda 1  ( exp ( mu J 1 + 1 / 2  ( s i g 1 1 ) . ^ 2 -1) ) + lambda 0  ( exp ( mu 0 J1 + 1 / 2  ( s i g 1 1 ) ^2 - 1 ) ) ; 38 m 2 = lambda 2  ( exp ( mu J 2 + 1 / 2  ( s i g 2 2 ) . ^ 2 -1) ) + lambda 0  ( exp ( mu 0 J2 + 1 / 2  ( s i g 2 2 ) ^2 - 1 ) ) ; 39 m 3 = lambda 3  ( exp ( mu J 3 + 1 / 2  ( s i g 3 3 ) . ^ 2 -1) ) + lambda 0  ( exp ( mu 0 J3 +

89

1 / 2  ( s i g 3 3 ) ^2 - 1 ) ) ; 40 41 %------------------- 42 %C a l c u l a t e A 43 44 [ mu t 1 , mu t 2 , mu t 3 ] = s e a s o n (T, d e l t a t ) ; 45 46 a 1 = ( ( r -m 1 )  (1 - exp(- a l p h a 1  d e l t a t ) ) + mu t 1 ( end ) ) ; 47 A 1 = exp ( a 1 ) ; 48 49 a 2 = ( ( r -m 2 )  (1 - exp(- a l p h a 2  d e l t a t ) ) + mu t 2 ( end ) ) ; 50 A 2 = exp ( a 2 ) ; 51 52 a 3 = ( ( r -m 3 )  (1 - exp(- a l p h a 3  d e l t a t ) ) + mu t 3 ( end ) ) ; 53 A 3 = exp ( a 3 ) ; 54 %-------------------- 55 %C a l c u l a t e B 56 57 [ B 1 B 2 B 3 ]= e y e j (T, d e l t a t ) ; 58 %-------------------- 59 %C a l c u l a t e Future p r i c e 60 61 f o r k = 1 : Monte Carlo n ; 62 63 [ Yend 1 Yend 2 Yend 3 l e v 1 l e v 2 l e v 3 ]= EulMar (T, d e l t a t , v o l 1 , v o l 2 , v o l 3 , lambda 0 , lambda 1 , lambda 2 , lambda 3 , ro12 , ro13 , ro23 , a l p h a ) ;

90

64 65 %C a l c u l a t e p s i 66 dv1 = h o r z c a t ( 0 , d i f f ( l e v 1 ) ) ; 67 dv2 = h o r z c a t ( 0 , d i f f ( l e v 2 ) ) ; 68 dv3 = h o r z c a t ( 0 , d i f f ( l e v 3 ) ) ; 69 70 e1 = sum ( exp ( ( a l p h a 1 )  ( s -T) )  dv1 ' ) ; 71 e 1 = exp ( e1 ) ; 72 e2 = sum ( exp ( ( a l p h a 2 )  ( s -T) )  dv2 ' ) ; 73 e 2 = exp ( e2 ) ; 74 e3 = sum ( exp ( ( a l p h a 3 )  ( s -T) )  dv3 ' ) ; 75 e 3 = exp ( e3 ) ; 76 77 %C a l c u l a t e s p o t p r i c e s 78 S 1 ( k ) = s p o t 1  exp ( ( Yend 1 ) ) ; 79 S 2 ( k ) = s p o t 2  exp ( ( Yend 2 ) ) ; 80 S 3 ( k ) = s p o t 3  exp ( ( Yend 3 ) ) ; 81 82 F 1 ( k ) = S 1 ( k ) .  A 1 .  B 1  e 1 ; 83 F 2 ( k ) = S 2 ( k ) .  A 2 .  B 2  e 2 ; 84 F 3 ( k ) = S 3 ( k ) .  A 3 .  B 3  e 3 ; 85 86 %p a y o f f 87 88 P ura ( k ) = ( ( F 1 ( k ) - c u r a n  F 2 ( k ) )-K) ; 89 P gas ( k ) = ( ( F 1 ( k ) - c g a s  F 3 ( k ) )-K) ;

91

90 91 Pay ura ( k ) = max( P ura ( k ) , 0 ) ; 92 Pay gas ( k ) = max( P gas ( k ) , 0 ) ; 93 94 end 95 96 % f a m e l e = mean ( F 1 ) 97 % famura = mean ( F 2 ) 98 % famgas = mean ( F 3 ) 99 100 %j o i n t h e s e i n t o one l i n e 101 p a y o f f u r a = mean ( Pay ura ) ;% t h e r e w i l l be n p a y o f f s 102 p a y o f f g a s = mean ( Pay gas ) ; 103 104 P r i c e u r a = mean ( exp(- r T)  ( p a y o f f u r a ) ) 105 P r i c e g a s = mean ( exp(- r T)  ( p a y o f f g a s ) ) 106 107 %Graph f u t u r e p r i c e 108 f i g u r e ; 109 s u b p l o t ( 3 , 1 , 1 ) ; 110 p l o t ( F 1 ) ; 111 t i t l e ( ' Future p r i c e s f o r e l e c t r i c i t y ' ) ; 112 s u b p l o t ( 3 , 1 , 2 ) ; 113 p l o t ( F 2 ) ; 114 t i t l e ( ' Future p r i c e s f o r uranium ' ) ; 115 s u b p l o t ( 3 , 1 , 3 ) ;

92

116 p l o t ( F 3 ) ; 117 t i t l e ( ' Future p r i c e s f o r gas ' ) ; 118 % % 119 p r i n t - d e p s c f u t p r i c e . e p s 120 121 122 f i g u r e ; 123 s u b p l o t ( 1 , 2 , 1 ) ; 124 h i s t ( Pay ura ) ; 125 t i t l e ( ' Uranium P a y o f f s ' ) ; 126 s u b p l o t ( 1 , 2 , 2 ) ; 127 h i s t ( Pay gas ) ; 128 t i t l e ( ' N a t u r a l Gas P a y o f f s ' ) ; 129 130 f i g u r e ; 131 s u b p l o t ( 1 , 2 , 1 ) ; 132 p l o t ( Pay ura ) ; 133 t i t l e ( ' Uranium P a y o f f s ' ) ; 134 s u b p l o t ( 1 , 2 , 2 ) ; 135 p l o t ( Pay gas ) ; 136 t i t l e ( ' N a t u r a l Gas P a y o f f s ' ) ; 137 138 end 139 140 %f u t ( 0 , 1 , 1 / 2 6 0 , 1 , 1 , 1 , 1 , 0 . 1 5 , 0 . 1 5 , 0 . 1 5 , 0 . 1 5 , 0 . 0 0 1 , 0 . 0 0 0 1 , 0 . 1 , 0 . 0 3 , 0 . 0 3 , 0 . 0 3 , 100)

93

141 142

The function below is the function for the compound Poisson process
1 function d e l t a z = zcpp (T, d e l t a t , lambda 0 , lambda 1 , lambda 2 , lambda 3 ) 2 %Compound P o i s s o n P r o c e s s 3 4 5 %c a l l each i n d e x o f Xk 6 d e l t a z 1 = c p p c (T, d e l t a t , lambda 1 ) ; 7 d e l t a z 2 = cpp d (T, d e l t a t , lambda 2 ) ; 8 d e l t a z 3 = c p p e (T, d e l t a t , lambda 3 ) ; 9 10 %c a l l X0k 11 XzeroK = c pp a (T, d e l t a t , lambda 0 ) ; 12 13 d e l t a Z 1 = d e l t a z 1 + ( XzeroK ( : , 1 ) ) ' ; 14 d e l t a Z 2 = d e l t a z 2 + ( XzeroK ( : , 2 ) ) ' ; 15 d e l t a Z 3 = d e l t a z 3 + ( XzeroK ( : , 3 ) ) ' ; 16 17 d e l t a z = h o r z c a t ( d e l t a Z 1 ' , d e l t a Z 2 ' , d e l t a Z 3 ' ) ; 18 19 f i g u r e ; 20 s u b p l o t ( 3 , 1 , 1 ) ; 21 p l o t ( d e l t a Z 1 ) ; 22 t i t l e ( 'CPP S i m u l a t i o n f o r E l e c t r i c i t y ' ) ;

94

23 x l a b e l ( ' Time t o Maturity ' ) ; 24 s u b p l o t ( 3 , 1 , 2 ) ; 25 p l o t ( d e l t a Z 2 ) ; 26 t i t l e ( 'CPP S i m u l a t i o n f o r Uranium ' ) ; 27 x l a b e l ( ' Time t o Maturity ' ) ; 28 s u b p l o t ( 3 , 1 , 3 ) ; 29 p l o t ( d e l t a Z 3 ) ; 30 t i t l e ( 'CPP S i m u l a t i o n f o r Gas ' ) ; 31 x l a b e l ( ' Time t o Maturity ' ) ; 32 33 end 34 35 %t o run zcpp ( 1 , 1 / 2 6 0 , 1 , 1 , 3 , 1 )

The function below is the function for the Wiener process.
1 function d e l t a b = brown (T, d e l t a t , ro12 , ro13 , r o 2 3 ) 2 %Brownian motion 3 nrep = round (T/ d e l t a t ) ; 4 5 SigB = [ 1 r o 1 2 r o 1 3 ; r o 1 2 1 r o 2 3 ; r o 1 3 r o 2 3 1 ] ; 6 mu = [ 0 , 0 , 0 ] ; 7 8 d e l t a b = mvnrnd (mu, ( SigB  d e l t a t ) , nrep ) ; 9 10 f i g u r e ; 11 p l o t ( d e l t a b ) ;

95

12 t i t l e ( ' Geometric Brownian Motion S i m u l a t i o n ' ) ; 13 x l a b e l ( ' Time t o Maturity ' ) ; 14 15 16 %B = cumsum ( d e l t a b ) 17 end 18 19 %t o run : brown ( 1 , 1 / 2 6 0 , 0 . 0 3 , 0 . 0 3 , 0 . 0 3 )

The function below is the function for the Euler Maruyama Method. It is similar in both models.
1 function [ Yend 1 Yend 2 Yend 3 l e v 1 l e v 2 l e v 3 ] = EulMar (T, d e l t a t , v o l 1 , v o l 2 , v o l 3 , lambda 0 , lambda 1 , lambda 2 , lambda 3 , ro12 , ro13 , ro23 , alpha ) 2 %E u l e r Maruyama Method 3 4 ro = 0 . 0 0 3 ; 5 Y 0 = 0; 6 deltat = 1/260; 7 nrep = round (T/ d e l t a t ) ; 8 r = 0.05; 9 spot 1 = 53; 10 s p o t 2 = 1 7 ; 11 s p o t 3 = 1 0 ; 12 13 %c a l l d e l t a B which i s a n by 2 matrix f o r t h e brownian motion

96

14 d e l t a b = brown (T, d e l t a t , ro12 , ro13 , r o 2 3 ) ; 15 16 %c a l l d e l t a Z which i s a n by 2 matrix f o r t h e compound p o i s s o n p r o c e s s 17 d e l t a z = zcpp (T, d e l t a t , lambda 0 , lambda 1 , lambda 2 , lambda 3 ) ; 18 19 %c r e a t e l e v f o r p s i which i s needed f o r f u t u r e p r i c e c a l c u l a t i o n 20 f o r k = 1 : nrep 21 l e v 1 ( k ) = d e l t a b ( k , 1 ) + d e l t a z ( k , 1 ) ; 22 l e v 2 ( k ) = d e l t a b ( k , 2 ) + d e l t a z ( k , 2 ) ; 23 l e v 3 ( k ) = d e l t a b ( k , 3 ) + d e l t a z ( k , 3 ) ; 24 end 25 26 %s e a s o n a l i t y 27 [ mu t 1 , mu t 2 , mu t 3 ] = s e a s o n (T, d e l t a t ) ; 28 29 %two mean terms needed f o r m 30 mu J 1 = 0 ; 31 mu J 2 = 0 ; 32 mu J 3 = 0 ; 33 mu 0 J1 = 0 ; 34 mu 0 J2 = 0 ; 35 mu 0 J3 = 0 ; 36 s i g 1 1 = 0 . 0 1 ; 37 s i g 1 2 = 0 . 0 1 ; 38 s i g 1 3 = 0 . 0 1 ; 39 s i g 2 1 = 0 . 0 1 ;

97

40 s i g 2 2 = 0 . 0 1 ; 41 s i g 2 3 = 0 . 0 1 ; 42 s i g 3 1 = 0 . 0 1 ; 43 s i g 3 2 = 0 . 0 1 ; 44 s i g 3 3 = 0 . 0 1 ; 45 46 cov = [ s i g 1 1 s i g 1 2 s i g 1 3 ; s i g 2 1 s i g 2 2 s i g 2 3 ; s i g 3 1 s i g 3 2 s i g 3 3 ] ; 47 mu 0 J = [ mu 0 J1 mu 0 J2 mu 0 J3 ] ; 48 49 m 1 = lambda 1  ( exp ( mu J 1 + 1 / 2  ( s i g 1 1 ) . ^ 2 -1) ) + lambda 0  ( exp ( mu 0 J1 + 1 / 2  ( s i g 1 1 ) ^2 - 1 ) ) ; 50 m 2 = lambda 2  ( exp ( mu J 2 + 1 / 2  ( s i g 2 2 ) . ^ 2 -1) ) + lambda 0  ( exp ( mu 0 J2 + 1 / 2  ( s i g 2 2 ) ^2 - 1 ) ) ; 51 m 3 = lambda 3  ( exp ( mu J 3 + 1 / 2  ( s i g 3 3 ) . ^ 2 -1) ) + lambda 0  ( exp ( mu 0 J3 + 1 / 2  ( s i g 3 3 ) ^2 - 1 ) ) ; 52 53 m 1 = ( ( 1 / 2 )  d i a g ( cov ) )  m 1 ; 54 m 2 = ( ( 1 / 2 )  d i a g ( cov ) )  m 2 ; 55 m 3 = ( ( 1 / 2 )  d i a g ( cov ) )  m 3 ; 56 57 m1 = m 1 ( 1 ) ; 58 m2 = m 2 ( 2 ) ; 59 m3 = m 3 ( 3 ) ; 60 61 %I n i t i a l i z e E u l e r Maruyama with k = 1 62 Y 1 1 s ( 1 ) = Y 0 + ( a l p h a  ( r -m1-Y 0 )  d e l t a t ) + v o l 1 .  d e l t a b ( 1 , 1 )+ d e l t a z ( 1 , 1 ) ;

98

%+ mu t 1 ( 1 ) ; 63 Y 1 2 s ( 1 ) = Y 0 + ( a l p h a  ( r -m2-Y 0 )  d e l t a t ) + v o l 2 .  d e l t a b ( 1 , 2 )+ d e l t a z ( 1 , 2 ) ; %+ mu t 2 ( 1 ) ; 64 Y 1 3 s ( 1 ) = Y 0 + ( a l p h a  ( r -m3-Y 0 )  d e l t a t ) + v o l 3 .  d e l t a b ( 1 , 3 )+ d e l t a z ( 1 , 3 ) ; %+ mu t 3 ( 1 ) ; 65 66 Y 1 1 ( 1 ) = Y 0 + ( a l p h a  ( r -m1-Y 0 )  d e l t a t ) + v o l 1 .  d e l t a b ( 1 , 1 )+ d e l t a z ( 1 , 1 )+ mu t 1 ( 1 ) ; 67 Y 1 2 ( 1 ) = Y 0 + ( a l p h a  ( r -m2-Y 0 )  d e l t a t ) + v o l 2 .  d e l t a b ( 1 , 2 )+ d e l t a z ( 1 , 2 )+ mu t 2 ( 1 ) ; 68 Y 1 3 ( 1 ) = Y 0 + ( a l p h a  ( r -m3-Y 0 )  d e l t a t ) + v o l 3 .  d e l t a b ( 1 , 3 )+ d e l t a z ( 1 , 3 )+ mu t 3 ( 1 ) ; 69 70 %E u l e r Maruyama T r a j e c t o r y 71 f o r k = 2 : nrep 72 73 Y 1 1 s ( k ) = Y 1 1 ( k - 1) + ( a l p h a  ( r -m1-Y 1 1 ( k - 1) )  d e l t a t ) + v o l 1 .  d e l t a b ( k , 1 )+ d e l t a z ( k , 1 ) ; %+ mu t 1 ( k ) ; 74 Y 1 2 s ( k ) = Y 1 2 ( k - 1) + ( a l p h a  ( r -m2-Y 1 2 ( k - 1) )  d e l t a t ) + v o l 2 .  d e l t a b ( k , 2 )+ d e l t a z ( k , 2 ) ; %+ mu t 2 ( k ) ; 75 Y 1 3 s ( k ) = Y 1 3 ( k - 1) + ( a l p h a  ( r -m3-Y 1 3 ( k - 1) )  d e l t a t ) + v o l 2 .  d e l t a b ( k , 3 )+ d e l t a z ( k , 3 ) ; %+ mu t 3 ( k ) ; 76 77 Y 1 1 ( k ) = Y 1 1 ( k - 1) + ( a l p h a  ( r -m1-Y 1 1 ( k - 1) )  d e l t a t ) + v o l 1 .  d e l t a b ( k , 1 )+ d e l t a z ( k , 1 ) + mu t 1 ( k ) ; 78 Y 1 2 ( k ) = Y 1 2 ( k - 1) + ( a l p h a  ( r -m2-Y 1 2 ( k - 1) )  d e l t a t ) + v o l 2 .  d e l t a b ( k , 2 )+

99

d e l t a z ( k , 2 ) + mu t 2 ( k ) ; 79 Y 1 3 ( k ) = Y 1 3 ( k - 1) + ( a l p h a  ( r -m3-Y 1 3 ( k - 1) )  d e l t a t ) + v o l 2 .  d e l t a b ( k , 3 )+ d e l t a z ( k , 3 ) + mu t 3 ( k ) ; 80 end 81 82 Y 1 = h o r z c a t ( Y 0 , Y 1 1 ) ; 83 Y 2 = h o r z c a t ( Y 0 , Y 1 2 ) ; 84 Y 3 = h o r z c a t ( Y 0 , Y 1 3 ) ; 85 86 Y 1s = h o r z c a t ( Y 0 , Y 1 1 s ) ; 87 Y 2s = h o r z c a t ( Y 0 , Y 1 2 s ) ; 88 Y 3s = h o r z c a t ( Y 0 , Y 1 3 s ) ; 89 90 91 S 1 = s p o t 1  exp ( ( Y 1 ) ) ; 92 S 2 = s p o t 2  exp ( ( Y 2 ) ) ; 93 S 3 = s p o t 3  exp ( ( Y 3 ) ) ; 94 95 %End term i s t h e output s i n c e i t i s needed t o c a l c u l a t e s p o t p r i c e s 96 Yend 1 = ( Y 1 ( end ) ) ; 97 Yend 2 = ( Y 2 ( end ) ) ; 98 Yend 3 = ( Y 3 ( end ) ) ; 99 100 % %Graph o f T r a j e c t o r y 101 f i g u r e ; 102 s u b p l o t ( 3 , 1 , 1 ) ;

100

103 p l o t ( Y 1 ) ; 104 t i t l e ( ' T r a j e c t o r y o f t h e E u l e r Maruyama Method f o r E l e c t r i c i t y ' ) ; 105 x l a b e l ( ' Time t o Maturity ( Days ) ' ) ; 106 s u b p l o t ( 3 , 1 , 2 ) ; 107 p l o t ( Y 2 ) ; 108 t i t l e ( ' T r a j e c t o r y o f t h e E u l e r Maruyama Method f o r Uranium ' ) ; 109 x l a b e l ( ' Time t o Maturity ( Days ) ' ) ; 110 s u b p l o t ( 3 , 1 , 3 ) ; 111 p l o t ( Y 3 ) ; 112 t i t l e ( ' T r a j e c t o r y o f t h e E u l e r Maruyama Method f o r N a t u r a l Gas ' ) ; 113 x l a b e l ( ' Time t o Maturity ( Days ) ' ) ; 114 115 116 f i g u r e ; 117 s u b p l o t ( 3 , 1 , 1 ) ; 118 p l o t ( S 1 ) ; 119 t i t l e ( ' Spot P r i c e S i m u l a t i o n f o r E l e c t r i c i t y ' ) ; 120 x l a b e l ( ' Time t o Maturity ( Days ) ' ) ; 121 y l a b e l ( ' P r i c e ( D o l l a r s ) ' ) ; 122 s u b p l o t ( 3 , 1 , 2 ) ; 123 p l o t ( S 2 ) ; 124 t i t l e ( ' Spot P r i c e S i m u l a t i o n f o r Uranium ' ) ; 125 x l a b e l ( ' Time t o Maturity ( Days ) ' ) ; 126 y l a b e l ( ' P r i c e ( D o l l a r s ) ' ) ; 127 s u b p l o t ( 3 , 1 , 3 ) ; 128 p l o t ( S 3 ) ;

101

129 t i t l e ( ' Spot P r i c e S i m u l a t i o n f o r N a t u r a l Gas ' ) ; 130 x l a b e l ( ' Time t o Maturity ( Days ) ' ) ; 131 y l a b e l ( ' P r i c e ( D o l l a r s ) ' ) ; 132 % 133 134 %Graph o f T r a j e c t o r y 135 f i g u r e ; 136 s u b p l o t ( 3 , 1 , 1 ) ; 137 p l o t ( Y 1s ) ; 138 t i t l e ( ' T r a j e c t o r y o f t h e S e a s o n a l i z e d E u l e r Maruyama Method f o r E l e c t r i c i t y ' ) ; 139 x l a b e l ( ' Time t o Maturity ( Days ) ' ) ; 140 s u b p l o t ( 3 , 1 , 2 ) ; 141 p l o t ( Y 2s ) ; 142 t i t l e ( ' T r a j e c t o r y o f t h e S e a s o n a l i z e d E u l e r Maruyama Method f o r Uranium ' ) ; 143 x l a b e l ( ' Time t o Maturity ( Days ) ' ) ; 144 s u b p l o t ( 3 , 1 , 3 ) ; 145 p l o t ( Y 3s ) ; 146 t i t l e ( ' T r a j e c t o r y o f t h e S e a s o n a l i z e d E u l e r Maruyama Method f o r N a t u r a l Gas ' ) ; 147 x l a b e l ( ' Time t o Maturity ( Days ) ' ) ; 148 149 150 end 151 152 %[Yend 1 Yend 2 Yend 3 l e v 1 l e v 2 l e v 3 ]= EulMar ( 1 , 1 / 2 6 0 , 0 . 2 , 0 . 2 , 0 . 2 , 1 , 1 , 1 , 1 , 0 . 0 3 , 0 . 0 3 , 0 . 0 3 , 0 . 0 0 1 ) t o run

102

5.2

Time Changed Model

The function below is the main pricing function for the time- changed model. It calls upon other functions which are sequentially listed below.
1 function [ P r i c e u r a P r i c e g a s ] = L j (T, K, d e l t a t , Y 0 , a , b , v o l 1 , v o l 2 , v o l 3 , ro12 , ro13 , ro23 , Monte Carlo n ) 2 %Time-Changed Model 3 4 f o r mat l o n g 5 6 nrep = round (T/ d e l t a t ) ; 7 T 1 = T + (1/2) ; 8 c uran = 0.5;% conversion 9 c g a s = 1;% c o n v e r s i o n 10 % K = 0 ; %s t r i k e p r i c e 11 s j = l i n s p a c e (T, T 1 , ( T-T 1 ) / d e l t a t ) ; %f o r f u t u r e p r i c e i n t e g r a l 12 s = l i n s p a c e ( 0 ,T, T/ d e l t a t ) ; %f o r 0 t o m a t u r i t y i n t e g r a l 13 14 s p o t 1 = 3 0 ; 15 s p o t 2 = 5 3 ; 16 s p o t 3 = 2 4 ; 17 s i g 0 = 0 . 0 1 ; 18 s i g 1 = 0 . 0 1 ; 19 s i g 2 = 0 . 0 1 ; 20 s i g 3 = 0 . 0 1 ; 21 %a l p h a j f o r bounds

103

22 a l p h a 0 = 0 . 1 5 ; 23 a l p h a 1 = 0 . 1 5 ; 24 a l p h a 2 = 0 . 1 5 ; 25 a l p h a 3 = 0 . 1 5 ; 26 c 0 = 1 ; 27 c 1 = 1 ; 28 c 2 = 1 ; 29 c 3 = 1 ; 30 r = 0 . 0 3 ; 31 32 m 0 = -a  (( 2  ( - 1/ 2  ( s i g 0 ) . ^ 2 ) + ( b ) . ^ 2 ) . ^ ( 1 / 2 ) - b ) + -a  (( 2  ( - 1/ 2  ( c 0 )  ( sig 0 ) .^2) + (b) .^2 ) .^(1/2) - b) ; 33 m 1 = -a  (( 2  ( - 1/ 2  ( s i g 1 ) . ^ 2 ) + ( b ) . ^ 2 ) . ^ ( 1 / 2 ) - b ) + -a  (( 2  ( - 1/ 2  ( c 1 )  ( sig 1 ) .^2) + (b) .^2 ) .^(1/2) - b) ; 34 m 2 = -a  (( 2  ( - 1/ 2  ( s i g 2 ) . ^ 2 ) + ( b ) . ^ 2 ) . ^ ( 1 / 2 ) - b ) + -a  (( 2  ( - 1/ 2  ( c 2 )  ( sig 2 ) .^2) + (b) .^2 ) .^(1/2) - b) ; 35 m 3 = -a  (( 2  ( - 1/ 2  ( s i g 3 ) . ^ 2 ) + ( b ) . ^ 2 ) . ^ ( 1 / 2 ) - b ) + -a  (( 2  ( - 1/ 2  ( c 3 )  ( sig 3 ) .^2) + (b) .^2 ) .^(1/2) - b) ; 36 37 %---------- 38 %C a l c u l a t e A 39 40 [ mu t 1 , mu t 2 , mu t 3 ] = s e a s o n (T, d e l t a t ) ; 41 42 a 1 = ( ( r -m 1 )  (1 - exp ( a l p h a 1  d e l t a t ) )  exp(- a l p h a 1  d e l t a t ) + mu t 1 ( end ) ) ; 43 A 1 = exp ( a 1 ) ;

104

44 45 a 2 = ( ( r -m 2 )  (1 - exp ( a l p h a 2  d e l t a t ) )  exp(- a l p h a 2  d e l t a t ) + mu t 2 ( end ) ) ; 46 A 2 = exp ( a 2 ) ; 47 48 a 3 = ( ( r -m 3 )  (1 - exp ( a l p h a 3  d e l t a t ) )  exp(- a l p h a 3  d e l t a t ) + mu t 3 ( end ) ) ; 49 A 3 = exp ( a 3 ) ; 50 %------------------ 51 %C a l c u l a t e B 52 53 %function 54 PH1 1 = ( a )  ( ( ( s i g 1 . ^ 2 )  ( exp ( 2  a l p h a 1  s j ) ) +(b ) . ^ 2 ) . ^ ( 1 / 2 ) ) - b ; 55 PH1 2 = ( a )  ( ( ( s i g 1 . ^ 2 )  ( c 1 )  ( exp ( 2  a l p h a 1  s j ) ) +(b ) . ^ 2 ) . ^ ( 1 / 2 ) ) - b ; 56 57 PH2 1 = ( a )  ( ( ( s i g 2 . ^ 2 )  ( exp ( 2  a l p h a 1  s j ) ) +(b ) . ^ 2 ) . ^ ( 1 / 2 ) ) - b ; 58 PH2 2 = ( a )  ( ( ( s i g 2 . ^ 2 )  ( c 2 )  ( exp ( 2  a l p h a 2  s j ) ) +(b ) . ^ 2 ) . ^ ( 1 / 2 ) ) - b ; 59 60 PH3 1 = ( a )  ( ( ( s i g 3 . ^ 2 )  ( exp ( 2  a l p h a 1  s j ) ) +(b ) . ^ 2 ) . ^ ( 1 / 2 ) ) - b ; 61 PH3 2 = ( a )  ( ( ( s i g 3 . ^ 2 )  ( c 3 )  ( exp ( 2  a l p h a 3  s j ) ) +(b ) . ^ 2 ) . ^ ( 1 / 2 ) ) - b ; 62 63 64 %Now we apply t h e t r a p e z o i d a l r u l e 65 CH1 2 = ( PH1 1 + PH1 2 ) ; 66 CH1 1 = t r a p z ( s j , CH1 2 ) ; 67 B 1 = exp ( CH1 1 ) ; 68 69 CH2 2 = ( PH2 1 + PH2 2 ) ;

105

70 CH2 1 = t r a p z ( s j , CH2 2 ) ; 71 B 2 = exp ( CH2 1 ) ; 72 73 CH3 2 = ( PH3 1 + PH3 2 ) ; 74 CH3 1 = t r a p z ( s j , CH3 2 ) ; 75 B 3 = exp ( CH3 1 ) ; 76 77 78 %------------------------- 79 80 f o r k = 1 : Monte Carlo n ; 81 82 [ Yend 1 Yend 2 Yend 3 dV 1 dV 2 dV 3]= EulMar2 (T, d e l t a t , a , b , v o l 1 , v o l 2 , v o l 3 , ro12 , ro13 , r o 2 3 ) ; 83 84 %C a l c u l a t e p s i 85 e1 = sum ( exp ( ( a l p h a 1 )  ( s -T) )  dV 1 ) ; 86 e 1 = exp ( e1 ) ; 87 e2 = sum ( exp ( ( a l p h a 2 )  ( s -T) )  dV 2 ) ; 88 e 2 = exp ( e2 ) ; 89 e3 = sum ( exp ( ( a l p h a 3 )  ( s -T) )  dV 3 ) ; 90 e 3 = exp ( e3 ) ; 91 92 %Log return 93 S 1 ( k ) = s p o t 1  exp ( ( Yend 1 ) ) ; 94 S 2 ( k ) = s p o t 2  exp ( ( Yend 2 ) ) ;

106

95 S 3 ( k ) = s p o t 3  exp ( ( Yend 3 ) ) ; 96 97 %Future p r i c e c a l c u l a t i o n 98 F 1 ( k ) = S 1 ( k ) .  A 1 .  B 1  e 1 ; 99 F 2 ( k ) = S 2 ( k ) .  A 2 .  B 2  e 2 ; 100 F 3 ( k ) = S 3 ( k ) .  A 3 .  B 3  e 3 ; 101 102 P ura ( k ) = ( ( F 1 ( k ) - c u r a n  F 2 ( k ) )-K) ; 103 P gas ( k ) = ( ( F 1 ( k ) - c g a s  F 3 ( k ) )-K) ; 104 105 Pay ura ( k ) = max( P ura ( k ) , 0 ) ; 106 Pay gas ( k ) = max( P gas ( k ) , 0 ) ; 107 108 end 109 110 p a y o f f u r a = mean ( Pay ura ) ; 111 p a y o f f g a s = mean ( Pay gas ) ; 112 113 P r i c e u r a = mean ( exp(- r T)  ( p a y o f f u r a ) ) 114 P r i c e g a s = mean ( exp(- r T)  ( p a y o f f g a s ) ) 115 116 f i g u r e ; 117 s u b p l o t ( 1 , 3 , 1 ) ; 118 p l o t ( S 1 ) ; 119 t i t l e ( ' Spot p r i c e s f o r e l e c t r i c i t y vs Time t o maturity ' ) ; 120 s u b p l o t ( 1 , 3 , 2 ) ;

107

121 p l o t ( S 2 ) ; 122 t i t l e ( ' Spot p r i c e s f o r uranium vs Time t o maturity ' ) ; 123 s u b p l o t ( 1 , 3 , 3 ) ; 124 p l o t ( S 3 ) ; 125 t i t l e ( ' Spot p r i c e s f o r g a s vs Time t o maturity ' ) ; 126 127 f i g u r e ; 128 s u b p l o t ( 1 , 3 , 1 ) ; 129 h i s t ( F 1 ) ; 130 t i t l e ( ' Future p r i c e s f o r e l e c t r i c i t y ' ) ; 131 s u b p l o t ( 1 , 3 , 2 ) ; 132 h i s t ( F 2 ) ; 133 t i t l e ( ' Future p r i c e s f o r uranium ' ) ; 134 s u b p l o t ( 1 , 3 , 3 ) ; 135 h i s t ( F 3 ) ; 136 t i t l e ( ' Future p r i c e s f o r gas ' ) ; 137 138 f i g u r e ; 139 s u b p l o t ( 1 , 2 , 1 ) ; 140 h i s t ( Pay ura ) ; 141 t i t l e ( ' Uranium P a y o f f s ' ) ; 142 s u b p l o t ( 1 , 2 , 2 ) ; 143 h i s t ( Pay gas ) ; 144 t i t l e ( ' N a t u r a l Gas P a y o f f s ' ) ; 145 146 f i g u r e ;

108

147 s u b p l o t ( 3 , 1 , 1 ) ; 148 p l o t ( F 1 ) ; 149 t i t l e ( ' Future p r i c e s f o r e l e c t r i c i t y ' ) ; 150 s u b p l o t ( 3 , 1 , 2 ) ; 151 p l o t ( F 2 ) ; 152 t i t l e ( ' Future p r i c e s f o r uranium ' ) ; 153 s u b p l o t ( 3 , 1 , 3 ) ; 154 p l o t ( F 3 ) ; 155 t i t l e ( ' Future p r i c e s f o r gas ' ) ; 156 157 end 158 159 % L j ( 0 , 1 , 1 / 2 6 0 , 0 , 0 . 0 0 0 1 , 0 . 1 , 0 . 1 5 , 0 . 1 5 , 0 . 1 5 , 0 . 0 5 , 0 . 0 5 , 0 . 0 5 , 1 0 ) 160 161 162 163 164

The function below is the function for the inverse Gaussian process.
1 function I 1 = I j (T, d e l t a t , a , b ) 2 %I n v e r s e Gaussian S u b o r d i n a t o r 3 4 nrep = round (T/ d e l t a t ) ; 5 I 0 = 0; 6

109

7 v = normrnd ( a , b ) ; 8 y = v.^2; 9 x = ( a /b ) + y / ( 2  ( b . ^ 2 ) ) - ( ( ( 4  a  b  y ) + ( y . ^ 2 ) ) . ^ ( 1 / 2 ) / ( 2  ( b . ^ 2 ) ) ) ; 10 u = normrnd ( a , b ) ; 11 t = a / ( a+(x  b ) ) ; 12 s = ( a . ^ 2 ) / ( ( b . ^ 2 )  x ) ; 13 14 i f u <= t 15 16 17 e l s e 18 19 20 21 end 22 23 I ( 1 ) = I 0 + outp ; 24 25 f o r k = 2 : nrep 26 27 v = normrnd ( a , b ) ; 28 29 y = v . ^ 2 ; 30 31 x = ( a /b ) + y / ( 2  ( b . ^ 2 ) ) - ( ( ( 4  a  b  y ) + ( y . ^ 2 ) ) . ^ ( 1 / 2 ) / ( 2  ( b . ^ 2 ) ) ) ; 32 outp = s ; outp = x ;

110

33 u = normrnd ( a , b ) ; 34 35 t = a / ( a+(x  b ) ) ; 36 s = ( a . ^ 2 ) / ( ( b . ^ 2 )  x ) ; 37 38 i f u <= t 39 40 41 e l s e 42 43 44 45 end 46 47 I ( k ) = I ( k - 1) + out ( k ) ; 48 end 49 50 I1 = horzcat ( I 0 , I ) ; out ( k ) = s ; out ( k ) = x ;

51 f i g u r e ; 52 p l o t ( I 1 ) ; 53 t i t l e ( ' I n v e r s e Gaussian S u b o r d i n a t o r ' ) 54 x l a b e l ( ' Time t o Maturity ( Days ) ' ) ; 55 56 end 57 58 %I j ( 1 , 1 / 2 6 0 , 0 . 0 0 1 , 2 0 )

111

5.3

Appendix: Tables

112

Table 5.1: Variables and the Respective Parameters

Name T rho deltat deltab lamda 0 oil lamda 1 oil lamda 2 oil lamda 1 oil lamda ura lamda ura mu J 1 mu J 2 mu 0 J1 mu 0 J2

Location Used brown brown brown brown levy levy levy levy levy levy levy levy levy levy

Parameter and Definition Maturity  - volatility Time increment n by 3 matrix of Brownian component 0 Oil 1 Oil 2 Oil 1 Oil ura ura µJ =1 µJ =2 µ1 µ2

113

Table 5.2: Variables and the Respective Parameters

Name sigma 1 1 sigma 1 2 sigma 1 3 sigma 2 1 sigma 2 2 sigma 2 3 sigma 3 1 sigma 3 2 sigma 3 3 r alpha Y0 c ura c oil

Location Used levy levy levy levy levy levy levy levy levy EulMar EulMar EulMar EulMar EulMar

Parameter and Definition 1,1 1,2 1,3 2,1 2,2 2,3 3,1 3,2 3,3 r = interest  = sensitivity Y0 - Initial iteration = 0 cura - conversion factor coil - conversion factor

114

REFERENCES

[1] Boxma, O. J., & Yechiali, U. (2008). Poisson Processes. Encyclopaedia of Statistics in Quality and Reliability. [2] Blume, S. W. (2007). Electric power system basics: For the nonelectrical professional. Hoboken, NJ: Wiley-Interscience. [3] Carlo Pozzi. "The Relationship between Spot and Forward Prices in Electricity Markets.The econometrics of energy systems.186-206. 2007 [4] E. Luciano and P. Semeraro. "Extending Time-Changed Levy Asset Models Through Multivariate Subordinators", Working Paper No. 42 March 2007. www.carloalberto.org. [5] Fred E. Benth and Jurate Saltyte-Benth. Analytical Approximation for the Price Dynamics of Spark Spread Options Studies in Nonlinear Dynamics & Econometrics. Vol 10. No. 3, 2006. [6] Hastie, Trevor; Tibshirani, Robert; Friedman, Jerome H. (2009). "The Elements of Statistical Learning" Springer-Verlag. [7] Hazewinkel, Michiel, ed. (2001), "Law of large numbers", Encyclopedia of Mathematics, Springer, ISBN 978-1-55608-010-4 [8] John Hull and Alan White, "The pricing of options on interest rate caps and floors using

115

the Hull­White model" in Advanced Strategies in Financial Risk Management, Chapter 4, pp 59­67. [9] Michael, J. R., Schucany, W. R., & Haas, R. W. (1976). Generating Random Variates Using Transformations with Multiple Roots. The American Statistician, 30(2), 88. [10] OECD. Uranium 2009: Resources, Production and Demand. OECD NEA Publication 6891. 2010 [11] Olivares, Pablo. Pricing Spark Contracts Under Some Classes of Levy Processes. Working Paper, 2016 [12] Papapantoleon, A. An Introduction to Levy Processes with Applications in Finance. 2000. [13] Pascucci, A. PDE and Martingale Methods in Option Pricing. Milan: Springer, 2011. [14] R. Carmona and V. Durrleman. "Pricing and Hedging Spread Options." SIAM Review. 45:4 627-685. 2003 [15] Cont, Rama, and Peter Tankov. Financial Modelling with Jump Processes. Boca Raton, FL: Chapman and Hall CRC, 2004. Print. [16] S.J. Deng and S.S. Oren. "Electricity derivatives and risk management" Energy. 31. 940-953. 2006. [17] S.J Deng., B. Johnson, A Sogomonian. Spark spread options and the valuation of

116

electricity generation assets. Proceedings of the 32nd Annual Hawaii International Conference on Systems Sciences. 1999. [18] Sandri, M. "Numerical Calculation of Lyapunov Exponents." Mathematica J. 6, 78-84, 1996. [19] Schoutens, W. (2003). Levy processes in finance: Pricing financial derivatives. Chichester, West Sussex: J. Wiley. [20] Stoft, S., Belden, T., Goldman, C., & Pickle, S. (1998). Primer on electricity futures and other derivatives. [21] Yuri Prokhorov. "Strong law of large numbers". Encyclopedia of Mathematics.

117

