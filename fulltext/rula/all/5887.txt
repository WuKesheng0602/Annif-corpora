Computer Physics Communications 207 (2016) 464­477

Contents lists available at ScienceDirect

Computer Physics Communications
journal homepage: www.elsevier.com/locate/cpc

CoFlame: A refined and validated numerical algorithm for modeling sooting laminar coflow diffusion flames
Nick A. Eaves a , Qingan Zhang a,1 , Fengshan Liu b , Hongsheng Guo b , Seth B. Dworkin c , Murray J. Thomson a,
a b c

Department of Mechanical and Industrial Engineering, University of Toronto, 5 Kings College Road, Toronto, Ontario, Canada, M5S 3G8 Measurement Science and Standards, National Research Council of Canada, 1200 Montreal Rd, Ottawa, Ontario, Canada, K1A 0R6 Department of Mechanical and Industrial Engineering, Ryerson University, 350 Victoria St, Toronto, Ontario, Canada, M5B 2K3

article

info

abstract
Mitigation of soot emissions from combustion devices is a global concern. For example, recent EURO 6 regulations for vehicles have placed stringent limits on soot emissions. In order to allow design engineers to achieve the goal of reduced soot emissions, they must have the tools to so. Due to the complex nature of soot formation, which includes growth and oxidation, detailed numerical models are required to gain fundamental insights into the mechanisms of soot formation. A detailed description of the CoFlame FORTRAN code which models sooting laminar coflow diffusion flames is given. The code solves axial and radial velocity, temperature, species conservation, and soot aggregate and primary particle number density equations. The sectional particle dynamics model includes nucleation, PAH condensation and HACA surface growth, surface oxidation, coagulation, fragmentation, particle diffusion, and thermophoresis. The code utilizes a distributed memory parallelization scheme with strip-domain decomposition. The public release of the CoFlame code, which has been refined in terms of coding structure, to the research community accompanies this paper. CoFlame is validated against experimental data for reattachment length in an axi-symmetric pipe with a sudden expansion, and ethylene­air and methane­air diffusion flames for multiple soot morphological parameters and gas-phase species. Finally, the parallel performance and computational costs of the code is investigated. Program summary Program title: CoFlame Catalogue identifier: AFAU_v1_0 Program summary URL: http://cpc.cs.qub.ac.uk/summaries/AFAU_v1_0.html Program obtainable from: CPC Program Library, Queen's University, Belfast, N. Ireland Licensing provisions: GNU General Public License, version 3 No. of lines in distributed program, including test data, etc.: 94964 No. of bytes in distributed program, including test data, etc.: 6242986 Distribution format: tar.gz Programming language: Fortran 90, MPI. (Requires an Intel compiler). Computer: Workstations. Operating system: Linux. RAM: From 16 GB to over 1000 GB depending on size of system being simulated Classification: 22.

Article history: Received 24 July 2015 Received in revised form 15 June 2016 Accepted 15 June 2016 Available online 29 June 2016 Keywords: Laminar diffusion flame Soot model Ethylene Methane

 This paper and its associated computer program are available via the Computer Physics Communication homepage on ScienceDirect (http://www.sciencedirect.com/ science/journal/00104655).  Corresponding author. Fax: +1 416 978 7753. E-mail address: murray.thomson@utoronto.ca (M.J. Thomson). 1 Currently at Thermal Reservoir Engineering, Canadian Natural Resources Limited, 855-2nd St SW, Calgary, Alberta, Canada, T2P 4J8.

http://dx.doi.org/10.1016/j.cpc.2016.06.016 0010-4655/© 2016 Elsevier B.V. All rights reserved.

N.A. Eaves et al. / Computer Physics Communications 207 (2016) 464­477

465

Nature of problem: Soot formation in laminar diffusion flames with detailed description of thermodynamics, kinetic, and transport data Solution method: Finite volume method utilizing the pseudo-transient SIMPLE algorithm and locally coupled chemistry solver Additional comments: The code was specifically developed for modeling soot formation in laminar diffusion flames Running time: From hours to a month depending on the complexity of the chemical mechanism and the disparity between the initial guess and the final solution. © 2016 Elsevier B.V. All rights reserved.

1. Introduction Reducing soot emissions from combustion processes is important due to the negative health and environmental effects of atmospheric soot. In order to achieve this goal, there has to be a fundamental understanding of the mechanisms of soot formation, including growth and oxidation, to allow for the determination of economically viable methods of reducing these emissions. Due to the highly complex nature of soot formation, detailed numerical models are employed to gain fundamental understanding of the factors that affect each mechanism of soot evolution. While significant progress has been made in this area, there are still many uncertainties. 1.1. Soot formation processes There are a significant number of physical processes that occur during soot formation. These include polycyclic aromatic hydrocarbon (PAH) gas-phase growth, particle nucleation, surface growth via surface reaction and PAH condensation, surface oxidation, particle coalescence, particle coagulation and fragmentation, gas-phase scrubbing, and radiation [1]. The first step is the formation of PAHs in the gas-phase. The formation of the first ring, or benzene, is thought to be the rate limiting step, thus much research has been done on the formation pathways for benzene. The primary routes involve C2 H2 (acetylene), C4 Hi , C3 H3 (propargyl), C5 H5 (cyclopentadiene), and CH3 [2­5]. Subsequent growth to larger aromatics has pre-dominantly been accepted to occur via the hydrogenabstraction­carbon-addition (HACA) mechanism [2], where a hydrogen is abstracted and a small aliphatic is added, primarily C2 H2 . However, key reactions involving reactions between PAHs and PAH radicals [6­8] and C4 H2 (diacetylene) [8] have recently been shown to be important as well. The next step is nucleation, which is the birth of a soot primary particle, and is theorized to occur from gas phase PAHs. The exact mechanism of nucleation is still unclear; however, there are three main theorized routes. The proposed routes are growth into curved fullerene-like structures [9], physical coalescence (dimerization) [10], and chemical reaction into crosslinked structures [10,11]. The first pathway relies on the HACA mechanism, which is known to be too slow to account for soot nucleation rates on its own [11]. The other two pathways may not necessarily be mutually exclusive, and it is hypothesized that the relative ratio between the two mechanisms is a function of temperature and radical populations [10].

After nucleation occurs, soot primary particles undergo multiple concurrent processes. Primary particles grow via surface reaction in a manner similar to the HACA mechanism for gas-phase PAHs [6,12­14] and PAH condensation (a physical binding of PAHs to the surface of existing soot particles). Nucleation and condensation both rely on physical PAH bonds; however, one acts to create new soot primary particles, while the other one acts to increase the size of existing soot primary particles. Individual soot primary particles can collide and form larger primary particles (coalescence) or form chains of primary particles or soot aggregates (coagulation). Either of these two events are not 100% efficient due to the thermal rebound effect [15,16]. Soot primary particles can reduce in size due to surface oxidation from OH and O2 , with OH oxidation dominating in fuel-rich regions and under O2 fuel-lean conditions. Finally, soot aggregates may undergo oxidation-driven fragmentation to form smaller aggregates containing fewer primary particles [17,18]. In premixed flames, oxidation is concurrent with growth processes, which is not true in diffusion flames. 1.2. Soot formation models Soot models can be divided into three general categories; empirical, semi-empirical, and detailed [19]. Empirical soot models are developed on the basis of experimentally derived phenomenological correlations of soot formation rates with combustion condition such as pressure, equivalence ratio, and temperature. Such models are easy to understand, easy to implement, and do not require heavy computational load. This is why most of the empirical modeling of soot formation can be found in literature that is related to gas turbine and diesel engines that are otherwise computationally intensive to simulate. The disadvantages of this type of soot model are the loss of detailed insights into the soot formation processes and lack of broad applicability. The next level of soot modeling with semiempirical soot models attempts to incorporate some aspects of the physics and chemistry of the phenomenon, as opposed to a correlation of experimental data. The widely used two-equation soot model of Fairweather et al. [20] is an example of the semiempirical soot models. Although some insights into soot formation mechanisms can be obtained from this type of model, it cannot provide detailed soot properties such as soot aggregate structure and size distribution, due to the neglect of the aggregate structure and polydispersity of soot particles. As computational resources have improved and the use of parallel computing has increased, modeling of soot formation for academic purposes has shifted towards using detailed models.

466

N.A. Eaves et al. / Computer Physics Communications 207 (2016) 464­477

Problems that were not previously computational tractable are now feasible. Detailed chemical kinetic mechanisms describing the pyrolysis of hydrocarbon fuels and the formation of soot nucleating PAH species have originally been proposed by Frenklach and coworkers [6,12,13], with subsequent works by Marinov et al. [21] and Slavinskaya and Frank [7,22]. In addition, different approaches for modeling soot particle evolution under concurrent nucleation, coagulation, surface growth and oxidation processes have also been developed. Representative approaches are the moment method [13,23], the stochastic method [24­26] and the sectional method [27­31]. Sectional aerosol dynamics models can provide the mean properties and the size distribution of soot particles. Conventional sectional models solve for only one variable per section such as soot mass fraction [27], which is not adequate for modeling soot aggregate structure. To model the formation and coagulation of the fractal-like soot aggregates, Park et al. [28] developed an advanced sectional model which solves two equations (number densities of aggregates and primary particles) per section. This advanced model has been implemented into a laminar coflow flame code, CoFlame [32­35]. The CoFlame code has undergone multiple improvements since it was originally developed [22,36­44]. Development has focused on bringing fundamental understanding into the sub-models to the greatest extend possible. The CoFlame code, which has been refined in terms of coding structure, can be downloaded from http://combustion.mie.utoronto.ca/?page_id=1005. 1.3. Agenda In the present study, the updated and architecturally refined CoFlame code is described in detail. The code is validated on atmospheric pressure ethylene­air and methane­air coflow diffusion flames and the computational performance is investigated. 2. Numerical model 2.1. Governing equations For the gaseous phase, the fully coupled elliptical conservation equations for mass, momentum, energy, and species mass fraction are solved. CoFlame utilizes the axi-symmetrical nature of the flame, and equations are solved in the two-dimensional (z and r ) cylindrical co-ordinate system. The equations are the same as in previous studies [22,32,34,36­45]. Conservation of mass: 1  r r

+

  2 µ u rv + . 3 r2 r 3 r z

2µ 

(3)

Conservation of species mass fractions:

      Yk  Yk 1  v + u =- r  Yk Vk,r -  Yk Vk,z r z r r z + Wk   k (k = 1, 2, . . . , KK ).
Conservation of energy: Cp v (4)

 T T + u r z      KK 1  T  T = r +  - hk Wk  k r r r z z k=1   KK   T T -  Cp,k Yk Vk,r + Vk,z r z k =1   T T -  Cp,s Ys Vs,r + Vs,z r z  - hs W s   s + Qr .
(5)



r v

 +

    u = 0. z

(1)

Conservation of axial and radial momentum:

  u u p 1  u + u =- + rµ v r z z r r r       u 2  µ  +2 µ - rv z z 3 z r r     2  u 1  v - µ + rµ +  gz 3 z z r r z   v v p 2  v v + u =- + rµ r z r r r r       v 21   + µ - µ rv z z 3 r r r     21  u  u 2µv - rµ + µ - 2 3 r r z z r r

In the preceding equations, u is the axial velocity, v is the radial velocity,  is the mixture density, µ is the viscosity, gz is the acceleration due to gravity, Yk is the kth species mass fraction, Vk,r and Vk,z are the kth species radial and axial diffusion velocities, Wk is the molecular weight of the kth species,   k is the production rate of the kth species due to gas phase chemical reaction and interactions with the solid soot phase, Cp is the mixture specific heat capacity at constant pressure, T is the temperature,  is the mixture thermal conductivity, hk is the specific enthalpy of the kth species, Cp,k is the specific heat capacity of the kth species at constant pressure, Cp,s is the specific heat capacity of soot at constant pressure (assumed to be the same as graphite), Ys is the soot mass fraction, Vs,r and Vs,z are the soot radial and axial diffusion velocities, hs is the specific enthalpy of soot (assumed to be the same as graphite), Ws is the molecular weight of soot (same as carbon), and Qr is the radiative heat transfer by soot, H2 O, CO2 , and CO. Soot particle dynamics are described using a fixed sectional method, in which soot particle mass ranges are divided logarithmically into thirty-five discrete sections. Thirty-five sections are sufficient to ensure the results for average soot morphological parameters no longer change when increasing the number of sections, as variations in the results are no longer seen when the number of sections is increased beyond thirty-five. Soot aggregates are assumed to be composed of spherical primary particles of equal size with a constant fractal dimension of 1.8 [46,47]. Two transport equations are solved for each section; those being aggregate number density (Nia ) and soot primary particle number density p (Ni ), where i = 1, 2, . . . , 35. The soot sectional model includes several processes, those being nucleation (nu), PAH condensation and HACA surface growth (sg ), surface oxidation (ox), coagulation (co), fragmentation (fr ), particle diffusion (Da i ), and thermophoresis (VTs ). Below are the governing soot particle dynamics equations: Conservation of soot aggregate number density:

(2)

    a a  Nia 1    Nia a  Ni a  Ni + u = r  Di +  Di v r z r r r z z      a 1    Ni   r  Nia VTs,r -  Nia VTs,z +  - r r z  t nu       Nia   Nia   Nia   Nia      + + + + t  t  t  t 
co sg ox fr

(i = 1, 2, . . . , 35).

(6)

N.A. Eaves et al. / Computer Physics Communications 207 (2016) 464­477

467

Conservation of soot primary particle number density:

v

 Ni  Ni   1   + u = r  Da +  Da i i r z r r r z z    p      Ni  1  p - r  Ni VTs,r -  Nip VTs,z +  r r z  t nu      p p   Np   Nip   +  Ni  +  Ni  + i  + t  t  t  t   
co sg ox fr

p Ni

p Ni

p

p

  Nip   =  t co

kji


mi-1 mj +mk mi+1 35  k=1


1-

j,k
2



a p j,k j,k Nja Nk

- p,i Nia

a i,k i,k Nk

(10)

(i = 1, 2, . . . , 35).
2.2. Soot formation model

(7)

 is the Kronecker delta function, j,k is the collision kernel of two aggregates in the jth and kth sections, p,i is the number of primary particles per aggregate in the ith section, and j,k is the coagulation
efficiency of two aggregates in the jth and kth sections and is set to 0.20 in this work [35]. The parameter  weights the newly formed mass into two adjacent sections such that the number and the mass of aggregates are conserved and is calculated as:

where mi is the representative mass of the ith section aggregate,

In order to close the system of equations, a number of models are required for the terms in Eqs. (6) and (7). The utilized models are discussed below. 2.2.1. Gas phase chemistry The mechanism in Chemkin format that is used with the CoFlame code is the one originally presented in [7], with modifications described in [36] and [22]. This mechanism [22] is chosen due to its ability to accurately predict soot volume fraction levels in all regions of an atmospheric C2 fuel (ethylene) flame [36] and enhance performance for methane flames [22]. This mechanism aims to accurately describe C2 /methane oxidation, with PAH growth up to five aromatic rings, and has been validated for high pressures [7,37]. It should be noted that this mechanism is a reduced mechanism which employs lumping of some PAH growth routes, such as diacetylene addition. The CoFlame code is compatible with other chemical mechanisms and has been tested on the mechanisms of Appel et al. [6], Marinov et al. [21], Raj et al. [48], and Wang et al. [49]. 2.2.2. Nucleation Soot particle nucleation is modeled by assuming soot nucleates through the collision and sticking of PAH species. The rate of nucleation is calculated according to kinetic theory as:

 mi+1 - (mj + mk )    mi+1 - mi =  mi-1 - (mj + mk )   mi-1 - mi

if mi  mj + mk  mi+1 (11) if mi-1  mj + mk  mi .

The factor p assigns primary particles to two adjacent sections so that primary particle size and number are conserved and is calculated as:

p =

mi mj + mk

(np,j + np,i ).

(12)

The collision kernel, j,k , is given by [53].

j,k = 4 Rabs (Dj + Dk )fD

(13)

where Rabs is the absorbing sphere cluster radius, Dj and Dk are the diffusion coefficients for soot particles in the jth and kth sections, and fD is the transition regime correction factor. The expression for the absorbing cluster radius is the same as that suggested by Zurita-Gotor and Rosner [54]. The diffusion coefficient, D, is calculated for both the free molecular and continuum regimes. The total diffusion coefficient utilized in Eq. (13) is the summation of these two values. The diffusion coefficient, D, is given by D= kB TCc (Kn) 3 µdm (14)

  p a  N1   N1  =  =  8 kB T (rA + rB )2 A2 [A][B] v   t nu  t nu µAB   p   Nia   =  Ni  = 0, i = 2, 3, . . . , 35   t nu  t nu

(8)

where  is the nucleation efficiency, kB is the Boltzmann constant, Av is Avogadro's number, µAB is the collisional reduced mass for the two colliding PAHs, rA and rB are the radii of the two colliding PAHs, and [A] and [B] are the concentrations of the two colliding PAHs. In this current work, nucleation is modeled to result from collisions of benzo[a]pyrene (BAPYR), secondary benzo[a]pyrenyl (BAPYR*S), and benzo(ghi)fluoranthene (BGHIF) [43]. The parameter  is set to 0.0001 [43]. 2.2.3. Coagulation The coagulation terms are calculated based on the collision kernel of soot aggregates in the entire Knudsen number regime [28, 50­52]. The source terms for aggregates and primary particles in the ith section are calculated as:

where kB is the Boltzmann constant, T is the gas temperature, µ is the gas viscosity, dm is the mobility diameter, Cc (Kn) is the Cunningham slip correction factor as a function of the Knudsen number Kn and is calculated as [55] Cc (Kn) = 1 + 1.612Kn. The Knudsen number is defined as Kn = 2mfp dm (16) (15)

where mfp is the mean free path of the gas, which is taken as the mean free path of air. The transition regime correction factor fD is obtained from a simple approximation of flux-matching theory and is calculated as fD = 1 + KnD 1 + 2KnD (1 + KnD ) (17)

  Nia   =  t co

kji


mi-1 mj +mk mi+1 35  k=1


1-

j,k
2

 a j,k j,k Nja Nk

where KnD is the diffusion Knudsen number which characterizes the transition between continuum and free molecular diffusion and is defined as (9) KnD =

- Nia

a i,k i,k Nk

mfp,12
Rabs

(18)

468

N.A. Eaves et al. / Computer Physics Communications 207 (2016) 464­477

where mfp,12 is the diffusion mean free path which is calculated as

mfp,12 = 

Dj + Dk
2kB T

(19)
1 mk

The source terms due to growth for aggregates and primary particles in the ith section are calculated using the 2-point method [58] as:





1 mj

+



where mj and mk is the mass of soot aggregates in the jth and kth sections. The mobility diameter of the soot aggregate is calculated by

  Nia    t sg

dm =

 0.43 2rp np         0.7     2Rf Df - 1
2

free molecular regime

(20) continuum regime

where rp is the primary particle radius, np is the number of primary particles in the aggregate, Df is the fractal dimension, and the outer radius of an aggregate Rf is defined by Rf = rp (fnp )1/Df where f is the volume filling factor and is set to 1.43 [56]. 2.2.4. PAH condensation, HACA surface growth, oxidation The PAH condensation model utilized is based on transition and continuum regime collision theory between soot aggregates and PAHs, with a prescribed collision efficiency,  , of 1.0 [35]. The mobility diameter of the PAH is taken to be the Lennard-Jones diameter. The HACA surface growth and oxidation model utilized is based on the HACA and oxidation soot surface reaction scheme developed by Frenklach and coworkers [6,14]. Table 1 displays the six surface reactions that are considered. Except for the reaction of soot with OH radicals (S6) which is modeled based on free molecular regime collision theory between OH and soot with a OH collision efficiency, OH , of 0.13 [57], the kinetics of the other surface reactions are described using the concept of soot surface sites, which can either be saturated (Csoot -H) or dehydrogenated (Csoot ·). In order to calculate the reaction rates, the concentrations of these two sites are required for each soot section. The concentration of total surface sites for soot section i, [Csoot - T]i , is calculated by (21)

  Nip    t sg

  I g ,i  - if i = 1   m  i +1 - m i    I g ,i Ig ,i-1 = - if i = 2, . . . , SN - 1 (24)  mi - mi-1 mi+1 - mi       I   g ,i-1 if i = SN mi - mi-1  I g ,i  - np,i if i = 1    m - mi i + 1      I g ,i - 1   np,i-1  mi - mi-1 (25) =  I g ,i    - np,i if i = 2, . . . , SN - 1   mi+1 - mi        Ig ,i-1 np,i-1 if i = SN mi - mi-1

where Ig ,i is the total of PAH condensation and HACA surface growth rates for the ith section in units of g/cc/sec and is always positive. The source terms due to oxidation for aggregates and primary particles in the ith section are calculated using the 2-point method [58] as:

  Nia    t ox

[Csoot - T]i =

 csoot-H As,i Ni
Av

(22)

  Nip    t ox

where  csoot-H is the number of sites per unit soot surface area and is set to a constant value of 2.3 × 1015 sites/cm2 [14], As,i is the surface area of soot particles in section i, and Ni is the number of soot particles in section i. The concentration of dehydrogenated sites for soot section i, [Csoot ·]i , is calculated from a steady state approximation by

  Iox,i Iox,i+1   + if i = 1 -   m - m mi  i+1 i    Iox,i Iox,i+1 = - if i = 2, . . . , SN - 1 (26)  mi - mi-1 mi+1 - mi       Iox,i   if i = SN mi - mi-1  Iox,i Iox,i   np,i+1 + np,i if i = 1 -    mi+1 - mi mi        Iox,i np,i  = mi - mi-1 (27)  Iox,i+1    - np,i+1 if i = 2, . . . , SN - 1   mi+1 - mi        Iox,i np,i if i = SN mi - mi-1

where Iox,i is the oxidation rate for the ith section in units of g/cc/sec and is always negative. 2.2.5. Fragmentation The oxidation-driven fragmentation model utilized assumes a 1:1 fragmentation pattern [35,45]. The source terms due to fragmentation for aggregates and primary particles in the ith section are calculated as:

[Csoot ·]i = [Csoot - H]i × (k1 H + k2 OH )
k-1 H2 + k-2 H2 O + k4 C2 H2 + k5 O2 + k1 H + k2 OH (23)

where H , OH , H2 , H2 O , C2 H2 , and O2 are mole fractions. The fractional term represents the portion of saturated sites that have been dehydrogenated and arises from a steady state approximation for [Csoot ·]i . The equation for [Csoot ·]i is modified from the original form presented in [6,14] to ensure that the fractional term cannot exceed unity. The concentration of saturated sites is then simply the number of total sites minus the number of dehydrogenated sites.

  Nia    t fr

   i,i+1 Si+1 Nia  +1      (i,i - 1)Si Nia =     + i,i+1 Si+1 Nia +1     a (i,i - 1)Si Ni

if i = 1 (28) if i = 2, . . . , SN - 1 if i = SN

N.A. Eaves et al. / Computer Physics Communications 207 (2016) 464­477 Table 1 HACA-based soot surface growth and oxidation reactions [6]. No. Reaction A (cm3 mol-1 s-1 ) 4.2 × 1013 1.0 × 1010 2.0 × 1013 8.0 × 107 2.2 × 1012 b Ea (kcal/mol) 13.0 1.43 0.0 3.8 7.5

469

S1 S2 S3 S4 S5 S6

Csoot Csoot Csoot Csoot Csoot Csoot

- H + H Csoot · +H2 - H + OH Csoot · +H2 O · +H  Csoot - H · +C2 H2  Csoot - H + H · +O2  2CO + product - H + OH  CO + product

OH

0.0 0.73 0.0 1.56 0.0 = 0.13

  Nip    t fr

 i,i+1 Si+1 Nia +1 npah,i+1     fs   (i,i - 1)Si Nia npah,i = i,i+1 Si+1 Nia  +1 np,i+1  +    fs  (i,i - 1)Si Nia npah,i

if i = 1 (29) if i = 2, . . . , SN - 1 if i = SN

where i,i and i,i+1 are breakage distribution functions and are calculated as:

where m is the polar angle index from 1 to M , l is the azimuthal angle index from 1 to L(m), µ and  are directional cosines,  is the spectral absorption coefficient, I is the spectral intensity, Ib is the spectral black-body intensity,  is a geometric constant [63],  is a weighting function associated with the direction defined by (m, l), r is the radial direction, and z is the axial direction. The set of discrete ordinates is defined using the T3 quadrature [64]. The validation of the original implementation of the DOM is available in [65,66]. 2.4. Discretization techniques As in previous works [22,32,34,36­45,67], the finite volume method is used to discretize the governing equations. A staggered mesh is used with a semi-implicit scheme to handle the pressure and velocity coupling and to solve the discretized equations at each discrete pseudo-time interval. The diffusive terms are discretized using a second-order central difference scheme while the convective terms are discretized using a power law scheme [68]. Due to using the power law scheme, care must be taken to ensure false diffusion is negligible by using sufficiently small grid spacings [68]. In this present work, numerical diffusion is estimated to be at least one order of magnitude lower than the real diffusion for the grids employed. The thermal properties of the gaseous species and chemical reaction rates are obtained by using CHEMKIN subroutines [69,70]. Based on sensitivity studies performed in [71], transport properties which include mixtureaveraged quantities for viscosities, conductivities, and diffusion coefficients, as well as thermal diffusion coefficients for H and H2 , are evaluated using TPLIB [72,73]. 2.5. Computational domain A generic schematic of a co-flow burner, flame, and computation domain along with boundary conditions utilized by the CoFlame code is depicted in Fig. 1. The boundary conditions are as described in [22,32,34,36­45], using free-slip conditions on the outer radial boundary, zero-gradient conditions on the outflow, and a symmetry boundary on the central axis. The inlet velocity is set as a top-hat profile as results are insensitive to the utilized profile type (top-hat or parabolic) as in previous studies [36]. There are two regions of interest for soot formation in the flame, those being the wing region (depicted on the schematic) and the centerline region, which runs along the central axis of the flame. Conjugate heat transfer between the fuel and air streams and the solid fuel tube is modeled by the harmonic mean method [38,68,74]. The harmonic mean method works by setting a very high value for viscosity for the control volumes in the solid fuel tube region when solving the momentum equations. The high viscosity allows a zero velocity inlet boundary condition to propagate and prevail in this region, consistent with it being a solid. To model the heat transfer in the fuel tube, values of specific heat capacity and conductivity for steel are assigned for the fuel tube region when solving the energy equation. This harmonic mean method alleviates the need to have

i,i =

fs - 2 fs - 1 fs fs - 1 (30)

i,i+1 =

.

The distribution functions weight the newly formed mass into two adjacent sections such that the number and mass of aggregates are conserved, and that the number and size of primary particles are also conserved. The fragmentation rate for aggregates in the ith section is taken from [59]: Si = A(np,i )1/Df (31)

where A is a coefficient that governs the overall fragmentation rate. As a first approximation, A is taken to be a first order function of the specific soot oxidation rate (the rate of removal of soot mass per unit soot surface area) rox,s , A = Crox,s where C is a constant and set to 1.0 × 10 [35,45].
5

(32)

2.2.6. Thermophoresis and diffusion The thermophoretic velocities VTs,z and VTs,r are calculated according to Gomez and Rosner [60]. VTs,xi = -0.55

µ T  T  xi

(xi = r , z ).

(33)

The aggregate diffusion coefficients are calculated in the same manner as for coagulation in the transition and continuum regimes. 2.3. Radiation model The radiation is modeled utilizing the discrete-ordinates method (DOM) and a statistical narrow-band correlated-k-based model developed in [61] and benchmarked in [62]. The DOM integrates the radiative transfer equation (RTE) along a prescribed number of discrete ordinates defined by a polar and azimuthal angle, which eases obtaining numerical solutions to the RTE. Below is the discrete ordinates form of the RTE in cylindrical co-ordinates:

-  Im,l +  Ib =

µm,l  rIm,l  Im,l + m,l r r z   1 m,l+1/2 Im,l+1/2 - m,l-1/2 Im,l-1/2 - r m,l

(34)

470

N.A. Eaves et al. / Computer Physics Communications 207 (2016) 464­477

after the momentum and pressure correction equations are solved globally [68] by the tri-diagonal matrix algorithm (TDMA) for penta-diagonal matrices, the gaseous species equations are solved in a coupled manner at each control volume to effectively deal with the stiffness of the system and speedup the convergence process. After iteration of the species equations, the sectional transport equations are also solved simultaneously in a similar fashion. The energy equation is then solved using TDMA to generate an updated global temperature field and a convergence check is performed. The algorithm is determined to be converged when the global rate of change of each variable (or residual) is less than 0.001. 3. CoFlame code performance In this section, the performance of the CoFlame code is investigated by performing validation against experimental data for an ethylene and a methane co-flow flame, parallel scaling tests, and discussing computational costs. 3.1. Validation The CoFlame code's flow solver is validated against experimental data for an axi-symmetric pipe with a sudden expansion. Subsequently, the code's species, energy, and soot dynamics solvers are validated against data for an ethylene and a methane co-flow flame. 3.2. Fluid dynamics solver To validate the fluid dynamics solver utilized by the CoFlame code, simulations for an axi-symmetric pipe with a sudden expansion are performed for a range of Reynolds Numbers and compared with experimental data available from Macagno and Hung [77]. Fig. 2 displays a diagram of the flow problem. The value of DO is 2.1 cm, D is 4.2 cm, and h is 1.05 cm. xr represents the reattachment length and varies with the flow Reynolds number, for which experimental data is available for Reynolds numbers from 10 to 140. The computational domain begins 2.0 cm below the expansion and extends a total of 35.2 cm in the axial direction, and is divided into 704(z ) × 84(r ) uniform control volumes. The results are verified to not be sensitive to increased length of the domain below the expansion, extent in the axial direction, and number of control volumes. For the inlet, a parabolic velocity profile for fullydeveloped laminar pipe flow is utilized as sensitivity to the inlet profile is observed for these flow cases. Fig. 2 displays a comparison between the numerical results from the CoFlame code with the experimental values obtained by Macagno and Hung [77] for re-attachment length for a range of Reynolds numbers. Overall, the trend with reattachment length is very well captured by the CoFlame code. It can be seen that the CoFlame results are in excellent agreement with the experimental values at lower Reynolds numbers, and at high Reynolds numbers the reattachment length is slightly over-predicted. As can be seen in the following section, the CoFlame code accurately predicts the axial velocity profiles in an ethylene­air diffusion flame, thus the employed fluid dynamics solver is suitable for the intended purpose of the CoFlame code. 3.2.1. Ethylene flame The flame chosen is the co-flow laminar diffusion ethylene­air flame originally investigated in [78], and has been exhaustively studied by multiple groups [36,41,46,78­83]. This flame is the only co-flow C2-fuel diffusion flame with published experimental data for soot aggregate and primary particle size and number densities. These characteristics make it an excellent choice for

Fig. 1. Schematic representation of the burner and flame, with coordinate axes and computational domain boundaries for the CoFlame code (image is not drawn to scale.)

separate solid and fluid domains with different discretizations and a heat transfer interface condition. Finally, to account for radiative heat transfer to and from the burner, the adsorption coefficient of control volumes within the solid fuel tube is set to a large number such that the fuel tube is optically nontransparent. 2.6. Parallelization strategy Due to the computational intensity of the problem, solutions would be intractable with serial processing. Therefore, distributedmemory parallelization with strip-domain decomposition is employed as described in [75]. The computational domain is divided uniformly into NPROC subdomains with the boundaries of each subdomain perpendicular to the z -axis, where NPROC is normally equal to the number of grid lines in the axial direction. The algorithm uses the Message Passing Interface [76] library to distribute the workload. The computations are performed on the General Purpose Cluster (GPC) and Sandy Bridge Cluster of the SciNet Computing Consortium, on 100 4-core Intel Xeon E5540s with 2.53 GHz chip speeds (GPC) or 50 8-core Intel Xeon E5-2650 2.0 GHz chip speeds (Sandy Bridge) and InfiniBand network interconnect. The algorithm requires a MPI Intel FORTRAN compiler for compatibility with other clusters. 2.7. Solution algorithm Pseudo-transient continuation is used to aid convergence from an arbitrary starting estimate [35]. At each pseudo-time step,

N.A. Eaves et al. / Computer Physics Communications 207 (2016) 464­477

471

Fig. 2. Computational domain for an axi-symmetric, suddenly expanding pipe, including co-ordinate systems.

preliminary soot model validation. The inner diameter of the fuel tube is 1.11 cm and of the co-flowing air tube is 10.20 cm. The fuel and air velocities are 3.98 cm/s and 8.90 cm/s respectively. The computational domain extends to 19.46 cm in the axial direction and 4.16 cm in the radial direction, and is divided into 400(z ) × 238(r ) non-uniform control volumes. The spacing in the z starts at 0.03 cm, and stretches beyond z = 9.8 with a stretching factor of 1.0335. The spacing in the r starts at 0.0125 cm, and stretches beyond control volume 189 (r = 1.175 cm) with a stretching factor of 1.05. It should be noted that the grid is refined in the radial direction from r = 0.1 to 0.5 to have a spacing of 0.003125 cm. This refinement is required to achieve a mesh independent solution. When performing a further halving of the spacing in both coordinate directions, all soot parameters change by less than 10%. The first 1.0 cm in the z direction are below the fuel tube exit plane. This distance is sufficient to ensure the temperature gradients at z = 0.0 (the bottom of the computational domain) are negligible, thus ensuring accurate boundary conditions. The outer radial boundary is within the radius of the oxidizer tube, thus the oxidizer tube is not included in the computational domain. The sensitivity of the results to the location of the outer radial boundary is tested by extending the outer radial boundary to 5.0 cm and negligible changes to the solution is observed. Fig. 3 displays a comparison between the experimental values and those computed with the CoFlame code for soot volume fraction along (a) the pathline of maximum soot along the wings, and (b) the centerline. Experimental data are those measured by Santoro et al. [79] using laser extinction, McEnally et al. [83] using thermocouple particle deposition (TPD), and Köylü et al. [82] by thermophoretic sampling particle diagnostic (TSPD) and transmission electron microscope (TEM) images. Experimental uncertainties for the Santoro et al. data are derived by accounting for the variation in plausible values of E (m), the refractive index of soot [84], which has been done in previous studies [37,44], while uncertainties for the other two data sets are taken directly from the source publications. Along the wings, the CoFlame code predicted soot profile is broader than the experimental profile; however, the computed data are qualitatively correct and within the experimental uncertainty in the growth region and slightly shifted in the oxidation region. A similar trend is observed along the centerline, with the numerically predicted profile being broader. The peak predicted soot volume fraction along the centerline is within experimental uncertainty; however, it is on the lower end of the range. The under-prediction of centerline soot volume fraction

Fig. 3. Comparison of experimental values and those computed with the CoFlame code for soot volume fraction along (a) the pathline of maximum soot on the wings and (b) the centerline for the ethylene­air Santoro Flame [79,82,83].

at atmospheric pressure is prevalent in the literature [27,32,35­ 37,43] and has been observed for many different soot formation models. The cause of the observed under-prediction may be due to missing physics or formation pathways leading to increased soot growth rates along the centerline of diffusion flames. Fig. 4 displays a comparison between the experimental values and those computed with the CoFlame code for primary particle diameter (dp ) along (a) the pathline of maximum soot along the wings, and (b) the centerline. Experimental data along the wings is taken from Megaridis and Dobbins [80], and those along the centerline by Köylü et al. [82]. Experimental uncertainties are taken directly from the source publications. Once again, the CoFlame code predicts a broader profile than the experiment along the wings and centerline; however, peak values are within experimental uncertainty. Along the centerline the numerical predictions capturing the overall flat nature of the experimental profiles but failing to predict the right magnitudes. Given that centerline soot volume fraction is on the low end of the experimental uncertainty along the centerline, the underprediction of primary particle diameters can be attributed to an insufficient amount of surface growth, either by the HACA mechanism or PAH condensation. For a given number density, soot

472

N.A. Eaves et al. / Computer Physics Communications 207 (2016) 464­477

Fig. 5. Comparison of experimental values and those computed with the CoFlame code for primary particle number density (Np ) along the pathline of maximum soot on the wings for the ethylene­air Santoro Flame [46,81].

taken from Iyer et al. [85], Puri et al. [46], and Köylü et al. [82]. The experimental uncertainties are taken directly from the source publications; however, no uncertainty is available for the Iyer et al. data. The CoFlame code predicted profile shapes are similar to the experimental data; however, the magnitudes are under-predicted, particularly on the centerline. Figs. 8­11 display a comparison of radial cuts of OH mole fraction, C2 H2 mole fraction, temperature, and axial velocity, at various axial heights, with experimental data taken from Santoro et al. [79], and Kennedy et al. [86]. Experimental uncertainties are taken from the source publications. The qualitative and quantitative agreement between the experimental data and CoFlame results is excellent for all four parameters.
Fig. 4. Comparison of experimental values and those computed with the CoFlame code for primary particle diameter (dp ) along (a) the pathline of maximum soot on the wings and (b) the centerline for the ethylene­air Santoro Flame [80,82].

volume fraction will scale with d3 p . Due to low radical pools, the centerline of a diffusion flame is PAH condensation dominated [36­ 38]; therefore, the under-predictions are attributed to insufficient PAH condensation. Fig. 5 displays a comparison of Np (primary particle number density) along the wings, with experimental data taken from Megaridis and Dobbins [81], and Puri et al. [46]. The experimental uncertainties for the Puri et al. data are taken from the source publication, while for the Megaridis and Dobbins data the variation of E (m) and uncertainty in the dp measurements used to derive the data are considered. Measurement data for Np along the centerline are not available. With the exception of very low axial heights, the CoFlame code predictions are within experimental uncertainty. Fig. 6 displays a comparison of Na (aggregate number density) along the (a) wings and (b) centerline, with experimental data taken from Santoro et al. [79], and Puri et al. [46]. The experimental uncertainty for Puri et al. is taken from the source publication, while the variation of E (m) is considered [84] to derive the uncertainty for the Santoro et al. data. The CoFlame code predictions are within experimental uncertainty along the wings; however, along the centerline the predicted profile is shifted axially, although the shape is well captured. Fig. 7 displays a comparison of np (average number of primaries per aggregate) along the (a) wings and (b) centerline, with experimental data

3.2.2. Methane flame The flame chosen is a co-flow laminar diffusion methane­air flame [87]. The burner geometry is the same as in [78]; however, the fuel and air velocities are 7.75 cm/s and 7.96 cm/s respectively. The computational domain and all model parameters are unchanged from the ethylene flame calculations. However, it should be noted that the refinement between r = 0.1 to 0.5 cm required for mesh independence for the ethylene-flame is not required for the methane­air flame although it is still used for these presented results. This flame was chosen as there are measurements for primary particle diameters in addition to soot volume fraction available. Fig. 12 displays a comparison between the experimental values and those computed with the CoFlame code for soot volume fraction (a) at the location of maximum soot volume fraction at each axial height, and (b) along the centerline. Experimental data are those measured by Lee et al. [87] using laser extinction, with uncertainties determined by considering the range of plausible values of E (m) [84]. On both the wings and centerline, the CoFlame code under predicts soot volume fraction, particularly at lower axial heights. Peak predicted values along the wing and centerline are within a factor of 3 of the experimental data. Fig. 13 displays a comparison between the experimental values and those computed with the CoFlame code for the maximum dp observed at various axial heights. Experimental data along the wings is taken from Lee et al. [87], with uncertainties taken from the publication as well. The numerically predicted profile is shifted axially and of lower magnitude than the experimental values;

N.A. Eaves et al. / Computer Physics Communications 207 (2016) 464­477

473

Fig. 6. Comparison of experimental values and those computed with the CoFlame code for aggregate number density (Na ) along (a) the pathline of maximum soot on the wings and (b) the centerline for the ethylene­air Santoro Flame [46,79].

Fig. 7. Comparison of experimental values and those computed with the CoFlame code for number of primaries per aggregate (np ) along (a) the pathline of maximum soot on the wings and (b) the centerline for the ethylene­air Santoro Flame [46,79].

however, the shape is well captured. Similar to the centerline of the ethylene­air flame, the under prediction of soot volume fraction can be attributed to insufficient surface growth, particularly PAH condensation. Given the scaling of soot volume fraction with dp , an increase in predicted soot volume fractions by approximately a factor of 2.2 would occur if diameters were predicted accurately. 3.3. Code performance 3.3.1. Computational cost From an arbitrary initial solution field (air at 1900 K), the CoFlame code takes a wall-time of approximately 152 h on 400 CPUs to reach a fully converged solution for the ethylene­air coflow diffusion flame and 134 h on 400 CPUs for the methane­air diffusion flame. The total computational cost varies significantly depending on the disparity from the initial solution field and the final solution. Once an initial converged solution is obtained for a given flame, re-converging the solution for different model parameters is significantly faster, by a factor of 2­4. Fig. 14 displays the total CPU-time taken for each of the sub-models in the CoFlame code during one iteration for the ethylene­air diffusion flame using the same computational domain as for the validation testing using 1 CPU processor. It can be seen that the solution of the species and soot equations

Fig. 8. Comparison of experimental values and those computed with the CoFlame code for radial cuts of OH mole fraction at two axial heights above the burner [79].

dominates the computation cost. Solving for the temperature also takes significant CPU resources. It should be noted that both the

474

N.A. Eaves et al. / Computer Physics Communications 207 (2016) 464­477

Fig. 9. Comparison of experimental values and those computed with the CoFlame code for radial cuts of C2 H2 mole fraction at two axial heights above the burner [86].

Fig. 10. Comparison of experimental values and those computed with the CoFlame code for radial cuts of temperature at two axial heights above the burner [79].

discrete ordinates method (DOM) and solving of the pressure correction equation are entirely serial processes in the CoFlame code, thus parallel scaling is limited by these two subroutines. 3.3.2. Strong scaling Strong scaling tests are performed on the CoFlame code with the same domain size and chemical mechanism as utilized for the ethylene­air diffusion flame validation case. Fig. 15 displays the parallel efficiency of the CoFlame code for 2­400 CPUs with the base model, and with one with double the number of sections for the soot sectional model. For the base model, the parallel efficiency remains above 75% up to 80 CPUs; however, there is a significant drop in efficiency when adding additional CPUs. The efficiency at 400 CPUs, which is the maximum parallelization for the stripdomain scheme utilized by the CoFlame code, is 39%. The reduction in parallel efficiency is primarily due to the serial nature of the DOM radiation model and pressure correction equation solution procedure employed by the CoFlame code (such reductions have been noted in other codes [88]) and the increase in required inter-node communication. Due to the solution algorithm utilized

for solving the gas-phase species and soot particle dynamics equations, the parallel scaling of the CoFlame code will improve as chemical mechanisms increase in size or the number of soot sections or equations per section are increased [36]. The increased scaling is due to the time required for the DOM algorithm and interprocess communication becomes smaller compared to the time required for solution of the species conservation of mass equations. Fig. 15 displays that when doubling the number of sections utilized to 70, the parallel efficiency at 80 CPUs increases from 77% to 91%, and at 400 CPUs from 39% to 70%. Very similar results for improved parallel efficiency are obtained when a chemical mechanism is utilized with 202 species as opposed to 94 in the base model. 3.3.3. Weak scaling Weak scaling tests are performed on the CoFlame code with a domain equal to NUMP (z ) × 238 (r ), where NUMP is the number of CPUs used. Fig. 16 displays the time per iteration for 4­512 CPUs with the base model and the model with 70 sections for the soot dynamics solver. The time per iteration is relatively constant up to 64 CPUs; however, it increases significantly after that point. As displayed in the previous section, the scaling of the CoFlame code

Fig. 11. Comparison of experimental values and those computed with the CoFlame code for radial cuts of axial velocity at various axial heights above the burner [79].

N.A. Eaves et al. / Computer Physics Communications 207 (2016) 464­477

475

Fig. 14. Distribution of time taken for the various sub-models of the CoFlame code for the ethylene­air diffusion flame (readers are referred to the online version to view the image in color).

Fig. 12. Comparison of experimental values and those computed with the CoFlame code for soot volume fraction along (a) the pathline of maximum soot on the wings and (b) the centerline for the methane­air [87].

Fig. 15. Parallel efficiency as a function of the number of cores for the CoFlame code on the ethylene­air coflow diffusion flame.

improves with increases in the number of sections in the sectional model or the size of the chemical kinetics mechanism. 4. Conclusions The details of the CoFlame code have been described in length, inclusive of modeling techniques, mathematical equations, and solution algorithm and procedure. The CoFlame code can model co-flow, laminar, axi-symmetric, sooting diffusion flames. The code solves axial and radial velocity, temperature, species conservation, and soot aggregate and primary particle number density equations. The sectional particle dynamics model includes nucleation, PAH condensation and HACA surface growth, surface oxidation, coagulation, fragmentation, particle diffusion, and thermophoresis. The public release of the CoFlame code, which has been refined in terms of coding structure, to the research community accompanies this paper. The CoFlame code is validated against experimental data for an axi-symmetric pipe experiencing a sudden expansion and all data available for ethylene­air and methane­air diffusion flames without altering any model parameters. The code shows good parallel scaling up to 80 CPUs and continual significant reduction

Fig. 13. Comparison of experimental values and those computed with the CoFlame code for the maximum primary particle diameter (dp ) at a given axial height for the methane­air [87].

476

N.A. Eaves et al. / Computer Physics Communications 207 (2016) 464­477 [16] A. D'Alessio, A.C. Barone, R. Cau, A. D'Anna, P. Minutolo, Proc. Combust. Inst. 30 (2005) 2595­2603. [17] K.G. Neoh, J.B. Howard, A.F. Sarofim, Proc. Combust. Inst. 20 (1985) 951­957. [18] F. Xu, A.M. El-Leathy, C.H. Kim, G.M. Faeth, Combust. Flame 132 (2003) 43­57. [19] I.M. Kennedy, Prog. Energy Combust. Sci. 23 (1997) 95­132. [20] M. Fairweather, W.P. Jones, H.S. Ledin, R.P. Lindstedt, Proc. Combust. Inst. 24 (1992) 1067­1074. [21] N.M. Marinov, W.J. Pitz, C.K. Westbrook, A.M. Vincitore, M.J. Castaldi, S.M. Senkan, C.F. Melius, Combust. Flame 114 (1998) 192­213. [22] V. Chernov, M.J. Thomson, S.B. Dworkin, N.A. Slavinskaya, U. Riedel, Combust. Flame 161 (2014) 592­601. [23] M.E. Mueller, G. Blanquart, H. Pitsch, Combust. Flame 156 (2009) 1143­1155. [24] M. Balthasar, M. Kraft, Combust. Flame 133 (2003) 289­298. [25] B. Zhao, Z. Yang, M.V. Johnston, H. Wang, A.S. Wexler, M. Balthasar, M. Kraft, Combust. Flame 133 (2003) 173­188. [26] S.H. Chung, A. Violi, Carbon 45 (2007) 2400­2410. [27] M.D. Smooke, C.S. McEnally, L.D. Pfefferle, R.J. Hall, M.B. Colket, Combust. Flame 117 (1999) 117­139. [28] S.H. Park, S.N. Rogak, W.K. Bushe, J.Z. Wen, M.J. Thomson, Combust. Theory Model. 9 (2005) 499­513. [29] M. Sirignano, J. Kent, A. D'Anna, Energy Fuels 27 (2013) 2303­2315. [30] H. Richter, S. Granata, W.H. Green, J.B. Howard, Proc. Combust. Inst. 30 (2005) 1397­1405. [31] T. Blacha, M. Di Domenico, P. Gerlinger, M. Aigner, Combust. Flame 159 (2012) 181­193. [32] Q. Zhang, H. Guo, F. Liu, G.J. Smallwood, M.J. Thomson, Proc. Combust. Inst. 32 (2009) 761­768. [33] Q. Zhang, M.J. Thomson, H. Guo, F. Liu, G.J. Smallwood, Combust. Flame 156 (2009) 697­705. [34] Q. Zhang, H. Guo, F. Liu, G.J. Smallwood, M.J. Thomson, Combust. Theory Model. 12 (2008) 621­641. [35] Q. Zhang, Detailed Modeling of Soot Formation/Oxidation in Laminar Coflow Diffusion Flames (Ph.D. thesis), University of Toronto, Toronto, Canada, 2009. [36] S.B. Dworkin, Q. Zhang, M.J. Thomson, N.A. Slavinskaya, U. Riedel, Combust. Flame 158 (2011) 1682­1695. [37] N.A. Eaves, A. Veshkini, C. Riese, Q. Zhang, S.B. Dworkin, M.J. Thomson, Combust. Flame 159 (2012) 3179­3190. [38] N.A. Eaves, M.J. Thomson, S.B. Dworkin, Combust. Theory Model. 185 (2013) 1799­1819. [39] M. Saffaripour, M. Kholghy, S.B. Dworkin, M.J. Thomson, Proc. Combust. Inst. 32 (2013) 1057­1065. [40] V. Chernov, Q. Zhang, M.J. Thomson, S.B. Dworkin, Combust. Flame 159 (2012) 2789­2798. [41] N.A. Eaves, S.B. Dworkin, M.J. Thomson, Proc. Combust. Inst. 35 (2015) 1787­1794. [42] A. Veshkini, S.B. Dworkin, M.J. Thomson, Combust. Flame 161 (2015) 3191­3200. [43] M. Saffaripour, A. Veshkini, M. Kholghy, M.J. Thomson, Combust. Flame 161 (2014) 848­863. [44] A. Khosousi, S.B. Dworkin, Proc. Combust. Inst. (2014) http://dx.doi.org/10. 1016/j.proci.2014.05.152. [45] Q. Zhang, M.J. Thomson, H. Guo, F. Liu, G.J. Smallwood, Combust. Sci. Technol. 182 (2010) 491­504. [46] R. Puri, T.F. Richardson, R.J. Santoro, R.A. Dobbins, Combust. Flame 92 (1993) 320­333. [47] A.G. Yazicioglu, C.M. Megaridis, A. Campbell, K. Lee, M.Y. Choi, Combust. Sci. Technol. 171 (2001) 71­87. [48] A. Raj, I.D.C. Prada, A.A. Amer, S.H. Chung, Combust. Flame 159 (2012) 500­515. [49] Y. Wang, A. Raj, S.H. Chung, Combust. Flame 160 (2013) 1667­1676. [50] J.Z. Wen, M.J. Thomson, M.F. Lightstone, S.N. Rogak, Energy Fuels 20 (2006) 547­559. [51] J.Z. Wen, M.J. Thomson, M.F. Lightstone, S.H. Park, S.N. Rogak, Combust. Sci. Technol. 178 (2006) 921­951. [52] J.Z. Wen, M.J. Thomson, S.H. Park, S.N. Rogak, M.F. Lightstone, Proc. Combust. Inst. 30 (2005) 1477­1484. [53] S.N. Rogak, R.C. Flagan, J. Colloid Interface Sci. 151 (1992) 203­224. [54] M. Zurita-Gotor, D.E. Rosner, J. Colloid Interface Sci. 255 (2002) 10­26. [55] C.M. Sorensen, G.M. Wang, Aerosol Sci. Technol. 33 (2000) 353­356. [56] K. Naumann, J. Aerosol Sci. 34 (2003) 1371­1397. [57] K.G. Neoh, J.B. Howard, Particulate Carbon-Formation during Combustion, Plenum, New York, 1981, pp. 261­277. [58] S.H. Park, S.N. Rogak, J. Aerosol Sci. 35 (2004) 1385­1404. [59] S.J. Harris, M.M. Maricq, J. Aerosol Sci. 33 (2002) 935­942. [60] A. Gomez, D.E. Rosner, Combust. Sci. Technol. 89 (1993) 335­362. [61] F. Liu, G.J. Smallwood, Ö. L. Gülder, J. Thermophys. Heat Transfer 14 (2000) 278­281. [62] F. Liu, H. Guo, G.J. Smallwood, Combust. Flame 138 (2004) 136­154. [63] K.H. Lee, R. Viskanta, J. Quant. Spectrosc. Radiat. Transfer 58 (1997) 329­345. [64] C.P. Thurgood, A. Pollard, H.A. Becker, J. Heat Transfer 117 (1995) 1068­1070. [65] F. Liu, J. Heat Transfer 121 (1999) 200­203. [66] F. Liu, I.O.L. Glder, G.J. Smallwood, Y. Ju, Int. J. Heat Mass Transfer 41 (1998) 2227­2236. [67] F. Liu, S.B. Dworkin, M.J. Thomson, G.J. Smallwood, Combust. Sci. Technol. 184 (2012) 966­979. [68] S.V. Patankar, Numerical Heat Transfer and Fluid Flow, Hemisphere, New York, 1980. [69] R. Kee, J. Miller, T. Jefferson, Chemkin: A General Purpose, Problem Independent, Transportable, Fortran Chemical Kinetics Code Package, Technical Report SAN80-8003, Sandia, 1980.

Fig. 16. Time per iteration as a function of the number of cores for the CoFlame code on the ethylene­air coflow diffusion flame.

in wall-clock time up to 400 CPUs. Future work should be aimed at removing empirically fitted constants with fundamental physics or well-validated functional forms. Supplemental material The CoFlame code, documentation, instructions, and the input files needed for the ethylene­air diffusion flame test case will be posted on a permanent website at http://combustion.mie. utoronto.ca/?page_id=1005. Acknowledgments Research was funded by Biofuelnet NSERC NCE. The authors acknowledge the Natural Sciences and Engineering Research Council of Canada for additional financial support. The authors would like to thank Dr. Nadezhda Slavinskaya and Prof. Uwe Riedel of the German Aerospace Center (DLR) for providing the chemical reaction mechanism, thermodynamic data, and transport data for ethylene combustion and PAH formation. Computations were performed on the Ryerson University Sandy Bridge computing cluster and the GPC supercomputer at the SciNet HPC Consortium. SciNet is funded by: the Canada Foundation for Innovation under the auspices of Compute Canada; the Government of Ontario; Ontario Research Fund--Research Excellence; and the University of Toronto. References
[1] B.S. Haynes, Gg.H. Wagner, Prog. Energy Combust. Sci. 7 (1981) 229­273. [2] M. Frenklach, D.W. Clary, W.C. Gardiner Jr., S.E. Stein, Proc. Combust. Inst. 20 (1984) 887­901. [3] J.A. Miller, C.F. Melius, Combust. Flame 91 (1992) 21­39. [4] S.E. Stein, J.A. Walker, M.M. Suryan, A. Fahr, Proc. Combust. Inst. 23 (1991) 85­90. [5] C.F. Melius, M.E. Colvin, N.M. Marinov, W. Pitz, S.M. Senkan, Proc. Combust. Inst. 1 (1996) 685­692. [6] J. Appel, H. Bockhorn, M. Frenklach, Combust. Flame 121 (2000) 122­136. [7] N.A. Slavinskaya, P. Frank, Combust. Flame 156 (2009) 1705­1722. [8] N.A. Slavinskaya, U. Riedel, S.B. Dworkin, M.J. Thomson, Combust. Flame 159 (2012) 979­995. [9] K. Homann, Angew. Chem., Int. Ed. Engl. 37 (1998) 2434­2451. [10] A. D'Anna, Proc. Combust. Inst. 32 (2009) 593­613. [11] H. Wang, Proc. Combust. Inst. 33 (2011) 41­67. [12] M. Frenklach, Phys. Chem. Chem. Phys. 4 (2002) 2028­2037. [13] M. Frenklach, H. Wang, in: H. Bochhorn (Ed.), Soot Formation in Combustion: Mechanisms and Models, Springer-Verlag, Berlin, 1994. [14] M. Frenklach, H. Wang, Proc. Combust. Inst. 23 (1991) 1559­1566. [15] H. Kellerer, R. Koch, S. Wittig, Combust. Flame 120 (2000) 188­199.

N.A. Eaves et al. / Computer Physics Communications 207 (2016) 464­477 [70] R. Kee, F. Rupley, J. Miller, A Fortran Chemical Kinetics Package for the Analysis of Gas-phase Chemical Kinetics, Technical Report SAN89-8009, Sandia, 1989. [71] S.B. Dworkin, M.D. Smooke, V. Giovangigli, Proc. Combust. Inst. 32 (2009) 1165­1172. [72] R. Kee, J. Warnatz, J. Miller, A Fortran Computer Code Package for the Evaluation of Gas-phase Viscosities, Conductivities, and Diffusion Coefficients, Technical Report SAN82-8209, Sandia, 1983. [73] R. Kee, J. Dixon-Lewis, J. Warnatz, M. Coltrin, J. Miller, A Fortran Computer Code Package for the Evaluation of Gas-phase Multicomponent Transport Properties, Technical Report SAN86-8246, Sandia, 1986. [74] S.V. Patankar, Toronto, p. 297. [75] S.B. Dworkin, J.A. Cooke, B.A.V. Bennett, B.C. Connelly, M.B. Long, M.D. Smooke, R.J. Hall, M.B. Colket, Combust. Theory Model. 13 (2009) 795­822. [76] W. Gropp, E. Lusk, R. Thakur, Using MPI-2: Advanced Features of the Message Passing Interface, first ed., The MIT Press, 1999. [77] E.O. Macagno, T. Hung, J. Fluid Mech. 28 (1967) 43­64. [78] R.J. Santoro, H.G. Semerjian, R.A. Dobbins, Combust. Flame 51 (1983) 203­ 218.

477

[79] R.J. Santoro, T.T. Yeh, J.J. Horvath, H. Semerjian, Combust. Sci. Technol. 53 (1987) 89­115. [80] C.M. Megaridis, R.A. Dobbins, Combust. Sci. Technol. 66 (1989) 1­16. [81] C.M. Megaridis, R.A. Dobbins, Proc. Combust. Inst. 22 (1988) 353­362. [82] Ü.Ö. Köylü, C.S. Mcenally, D.E. Rosner, L.D. Pfefferle, Combust. Flame 110 (1997) 494­507. [83] C.S. McEnally, Ü.Ö. Köylü, L.D. Pfefferle, D.E. Rosner, Combust. Flame 109 (1997) 701­720. [84] T.C. Williams, C.R. Shaddix, K.A. Jensen, J.M. Suo-Anttila, Int. J. Heat Mass Transfer 50 (2007) 1616­1630. [85] S.S. Iyer, T.A. Litzinger, S. Lee, R.J. Santoro, Combust. Flame 149 (2007) 206­216. [86] I.M. Kennedy, C. Yam, D.C. Rapp, R.J. Santoro, Combust. Flame 107 (1996) 368­382. [87] K. Lee, C.M. Megaridis, S. Zelepouga, A.V. Saveliev, L.A. Kennedy, O. Charon, F. Ammouri, Combust. Flame 121 (2000) 323­333. [88] M.R.J. Charest, C.P.T. Groth, Ö. L. Gülder, Combust. Theory Model. 14 (2010) 793­825.

