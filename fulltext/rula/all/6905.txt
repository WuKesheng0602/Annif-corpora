Nonlinear Attitude and Formation Estimation of Spacecraft and Multi-Agent Systems

by Michael Rososhansky
Master of Applied Science, Ryerson University (2010) Bachelor of Engineering, Ryerson University (2007)

A dissertation presented to Ryerson University in partial fulllment of the requirements for the degree of Doctor of Philosophy in the program of Aerospace Engineering

Toronto, Ontario, Canada, 2017 c Michael Rososhansky, 2017

AUTHOR'S DECLARATION FOR ELECTRONIC SUBMISSION OF A DISSERTATION

I hereby declare that I am the sole author of this dissertation. This is a true copy of the dissertation, including any required nal revisions, as accepted by my examiners. I authorize Ryerson University to lend this dissertation to other institutions or individuals for the purpose of scholarly research. I further authorize Ryerson University to reproduce this dissertation by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. I understand that my dissertation may be made electronically available to the public.

ii

Nonlinear Attitude and Formation Estimation of Spacecraft and Multi-Agent Systems
Michael Rososhansky Doctor of Philosophy, Aerospace Engineering, Ryerson University, Toronto (2017)

Abstract
This dissertation examines the state and parameter estimation problem of monolithic spacecraft and multi-agent systems in conjunction with the control algorithms. Nonlinear l-

tering techniques are investigated and applied to the problems of attitude estimation and control of monolithic spacecraft, distributed ltering for attitude estimation and control of satellite formation ying (SFF), and estimation and control of a multi-agent system in consensus tracking with uncertain dynamic model. The main objective is to investigate the performance of nonlinear ltering techniques under fault-free and fault-prone scenarios. In essence, the core of this research has been placed on identifying techniques to improve the eciency and reduce the variance of estimations in nonlinear ltering. The research is

primarily dedicated to the investigation of adaptive unscented Kalman lter (AUKF) and particle lter (PF). A nonlinear ltering technique has been proposed for sequential joint estimation of a multi-agent system in consensus tracking with uncertain dynamic model. The new lter is called marginalized unscented particle lter (MUPF). The proposed lter uses the Rao-Blackwellised principle to couple the particle ltering technique with unscented transform algorithm.

iii

Acknowledgements

This dissertation is a result of a continuous eort, over several years, in which I have experienced many uncertain and turbulent times. I owe a gratitude to many people who helped me along the way during the course of this journey. Without these people this dissertation would simply not be. First and foremost, I would like to express my heartfelt gratitude to Dr. Krishna Dev Kumar for his continuous support, guidance and motivation during this journey. Dr. Kumar, your guidance was indispensable to complete this dissertation. I would like to thank you for giving me the privilege to join and get some insight into your successful research group and for your skillful guidance in my own research. Furthermore, I would like to thank Dr. An-Min Zou for his guidance and discussions on estimation and control theory. I would also like to thank my colleagues Sobhan Etemadi, Afshin Rahimi, Alex Frias, Venkatesh Muthusamy and Min Adhikari. with you and spending time together. I enjoyed the fruitful discussions

I also enjoyed discussions and collaboration with

other researches worldwide Dr. Jesus Rooney Rivera Guillen and Waqas Manzur. Next, I would like to thank my friends Oren Kats, Misagh Aghajani, Boris Miller and Philip Milman. Thank you for your support, understanding and encouragement. I

appreciate your friendship. Also, I would like to thank my dear family. My parents Boris and Mila, my brothers Ronen and Ariel, you are truly the most devoted people I ever knew. Thank you so much for listening and motivating me to nish this research. Finally, I would like to thank my wife Michelle for supporting me and helping me to nalize this journey. My love, I don't know how I can ever thank you for being such a caring and understanding person that you are.

iv

For ... my loving parents Boris and Mila Rososhansky without whose support and endless love I would not have achieved this work.

v

Table of Contents Table of Contents

Author's Declaration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Abstract . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Acknowledgements List of Tables . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

ii iii iv x xi xiv xvi

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

List of Figures . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Nomenclature . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Abbreviations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

1 Introduction
1.1 1.2 1.3 1.4 Research Motivation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Signal Noise . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Filtering Theory . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Linear and Nonlinear Filtering Techniques 1.4.1 1.4.2 1.4.3 1.4.4 1.5 1.6 1.7 1.8 . . . . . . . . . . . . . . . . . .

1
2 4 4 6 6 9 10 11 12 13 14 16

Kalman Filter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Extended Kalman Filter . . . . . . . . . . . . . . . . . . . . . . . .

Unscented Kalman Filter . . . . . . . . . . . . . . . . . . . . . . . . Particle Filter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

Problem Statement . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Research Objectives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Main Contributions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Thesis Outline . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

2 Nonlinear Filters and Neural Networks
2.1 2.2 2.3 2.4 2.5 2.6 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Problem Statement . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Bayesian Estimation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

17
17 18 20 22 24 25

Unscented Kalman Filter . . . . . . . . . . . . . . . . . . . . . . . . . . . . Adaptive Unscented Kalman Filter . . . . . . . . . . . . . . . . . . . . . .

Monte Carlo Approximation . . . . . . . . . . . . . . . . . . . . . . . . . .

vi

Table of Contents
2.7 2.8 2.9 Bayesian Importance Sampling . . . . . . . . . . . . . . . . . . . . . . . . 26 28 33 35

Particle Filter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Chebyshev Neural Networks . . . . . . . . . . . . . . . . . . . . . . . . . .

2.10 Concluding Remarks

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

3 Attitude Estimation and Control of Monolithic Spacecraft
3.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3.1.1 3.1.2 3.2 Literature review . . . . . . . . . . . . . . . . . . . . . . . . . . . .

36
37 38 41 42 42 42 43 44 45 47 56 64 67 74

Objectives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

System Model, Filter Model, and Control Law . . . . . . . . . . . . . . . . 3.2.1 3.2.2 3.2.3 3.2.4 Dynamic equation Kinematic equations Filter models Control law . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

3.3

Simulation Results and Discussion . . . . . . . . . . . . . . . . . . . . . . . 3.3.1 3.3.2 3.3.3 3.3.4 Fault-free attitude estimation and control . . . . . . . . . . . . . .

Uncertainty in moment-of-inertia and external disturbances . . . . . Control command faults . . . . . . . . . . . . . . . . . . . . . . . .

Sensor faults . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

3.4

Conclusions

4 Distributed Attitude Estimation and Control of Spacecraft Formation Flying 75
4.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.1.1 4.1.2 4.2 Literature review . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76 78 80 81 82 82 83 84

Objectives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

System Model, Filter Model, and Control Law . . . . . . . . . . . . . . . . 4.2.1 4.2.2 4.2.3 4.2.4 Dynamic equations . . . . . . . . . . . . . . . . . . . . . . . . . . . Kinematic equations Filter models Control law . . . . . . . . . . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

vii

Table of Contents
4.3 Simulation Results and Discussion . . . . . . . . . . . . . . . . . . . . . . . 4.3.1 4.3.2 4.3.3 4.3.4 4.4 Fault-free spacecraft formation ying . . . . . . . . . . . . . . . . . 84 87 89 93 97 99

Uncertainty in moment-of-inertia and external disturbances . . . . . Control command faults . . . . . . . . . . . . . . . . . . . . . . . .

Measurements noise . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

Conclusions

5 Online Estimation and Control of Multi-Agent Systems
5.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.1.1 5.1.2 5.2 Literature review . . . . . . . . . . . . . . . . . . . . . . . . . . . .

100
101 103 105 106 107 107 108 109 111 113 115 122 129 136 142

Objectives . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

System Model, Filter Model, and Control Law . . . . . . . . . . . . . . . . 5.2.1 5.2.2 5.2.3 5.2.4 5.2.5 Dynamic equations . . . . . . . . . . . . . . . . . . . . . . . . . . . Joint estimation model . . . . . . . . . . . . . . . . . . . . . . . . . Filter model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Marginalized unscented particle lter . . . . . . . . . . . . . . . . . Control law . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

5.3

Simulation Results and Discussion . . . . . . . . . . . . . . . . . . . . . . . 5.3.1 5.3.2 5.3.3 5.3.4 Fault-Free multi-agent system . . . . . . . . . . . . . . . . . . . . . Uncertainty in dynamics model . . . . . . . . . . . . . . . . . . . .

External disturbances . . . . . . . . . . . . . . . . . . . . . . . . . . Control command fault . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

5.4

Conclusions

6 Conclusions
6.1 Summary of Contributions . . . . . . . . . . . . . . . . . . . . . . . . . . . 6.1.1 6.1.2 Attitude estimation and control of monolithic spacecraft . . . . . .

143
144 144

Distributed attitude estimation and control of spacecraft formation ying . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 145 146 147

6.1.3 6.2

Online estimation and control of multi-agent systems

. . . . . . . .

Future Work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

viii

Table of Contents
6.2.1 6.2.2 6.2.3 6.3 Proposal distributions . . . . . . . . . . . . . . . . . . . . . . . . . 147 148 148 149

Resampling strategies . . . . . . . . . . . . . . . . . . . . . . . . . . Improved nonlinear ltering techniques . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

Concluding Remarks

Appendices A Importance Sampling B Rao-Blackwellisation C Parameter Estimation of Chebyshev Neural Network
C.1 C.2 C.3 C.4 Parameter estimation under fault-free scenario . . . . . . . . . . . . . . . . Parameter estimation under uncertainty in dynamics model . . . . . . . . . Parameter estimation under external disturbances . . . . . . . . . . . . . . Parameter estimation under constant applied control command . . . . . . .

150 152 153 155
156 160 164 168

Bibliography

172

ix

List of Tables

List of Tables

1.1

Summary of developments in ltering theory . . . . . . . . . . . . . . . . .

7

3.1 3.2 3.3 3.4 3.5 3.6 3.7

Multinomial resampling algorithm . . . . . . . . . . . . . . . . . . . . . . . Time required to enter error region . . . . . . . . . . . . . . . . . . . . . .

46 55 56 61 64 67 70

Uncertainty in moment-of-inertia. . . . . . . . . . . . . . . . . . . . . . . . External disturbances. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

Constant applied torque. . . . . . . . . . . . . . . . . . . . . . . . . . . . . No control command during stabilization. Random noise levels. . . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

4.1 4.2 4.3 4.4 4.5 4.6 4.7 4.8

Initial attitude and angular velocity.

. . . . . . . . . . . . . . . . . . . . . . . . .

85 87 87 90 91 94 96 98

Mass moment-of-inertia tensor for each spacecraft in the formation.

Filter mass moment-of-inertia tensor for each spacecraft in the formation. . Uncertainty in moment-of-inertia. . . . . . . . . . . . . . . . . . . . . . . . External disturbances. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

Constant applied control commands.

No control command during formation stabilization. . . . . . . . . . . . . . Heterogeneous measurements. . . . . . . . . . . . . . . . . . . . . . . . . .

5.1 5.2 5.3 5.4 5.5

Parameters of agent's dynamics

. . . . . . . . . . . . . . . . . . . . . . . .

115 116 122 129 136

Initial conditions. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Uncertainty in dynamic system. . . . . . . . . . . . . . . . . . . . . . . . . External disturbances. . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

Constant applied control command. . . . . . . . . . . . . . . . . . . . . . .

x

List of Figures

List of Figures

1.1

Fault Classication . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

3

2.1 2.2 2.3

System diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Signal ow of unscented Kalman lter . . . . . . . . . . . . . . . . . . . . . Particle lter representation of posterior distribution . . . . . . . . . . . .

19 24 29

3.1 3.2 3.3 3.4 3.5 3.6 3.7 3.8 3.9

Estimated angular velocities. . . . . . . . . . . . . . . . . . . . . . . . . . . Estimated attitude response using adaptive unscented Kalman lter. . . . . Estimated attitude response using particle lter. . . . . . . . . . . . . . . . Spacecraft attitude error. . . . . . . . . . . . . . . . . . . . . . . . . . . . . Angular velocity residual. . . . . . . . . . . . . . . . . . . . . . . . . . . .

47 48 49 51 52 53 54 57 58

Root mean squared error for attitude response. . . . . . . . . . . . . . . . . Root mean squared error for angular velocity. . . . . . . . . . . . . . . . . . . . . . . . . . . .

Attitude response error under uncertainty in moment-of-inertia. Angular velocity residual under uncertainty in moment-of-inertia.

3.10 Root mean squared error of attitude response under uncertainty in momentof-inertia. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59

3.11 Root mean squared error of angular velocity under uncertainty in momentof-inertia. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60 62 63 65 66

3.12 Attitude response error under external disturbances. . . . . . . . . . . . . . 3.13 Angular velocity residual under external disturbances. . . . . . . . . . . . . 3.14 Attitude response error under constant applied control commands. . . . . . 3.15 Angular velocity residual under constant applied control commands. . . . . 3.16 Attitude response error when no control command is applied during stabilization. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

68

3.17 Angular velocity residual when no control command is applied during stabilization. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69 72

3.18 Attitude response error under sensor fault. . . . . . . . . . . . . . . . . . .

xi

List of Figures
3.19 Angular velocity residual under sensor fault. . . . . . . . . . . . . . . . . . 73

4.1 4.2 4.3 4.4 4.5 4.6 4.7

Communication graph for spacecraft formation . . . . . . . . . . . . . . . . Formation-keeping and station-keeping attitude errors. Uncertainty in moment-of-inertia tensor. External disturbances. . . . . . . . . . . .

81 88 90 92 95 96 98

. . . . . . . . . . . . . . . . . . .

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

Constant applied control commands.

No control command during formation stabilization. . . . . . . . . . . . . . Heterogeneous measurements. . . . . . . . . . . . . . . . . . . . . . . . . .

5.1 5.2 5.3 5.4 5.5 5.6 5.7 5.8 5.9

Communication graph for multi-agent system

. . . . . . . . . . . . . . . .

106 117 118 119 120 121 124 125 126 127

Estimation of uncertain dynamic model under fault-free scenario . . . . . . State estimates . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

Tracking error . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Control input under fault-free scenario . . . . . . . . . . . . . . . . . . . . .

Absolute error metric and relative error metric under fault-free scenario.

Estimation of uncertain dynamic model . . . . . . . . . . . . . . . . . . . . State estimates under uncertainty in dynamics model . . . . . . . . . . . .

Tracking error under uncertainty in dynamics model . . . . . . . . . . . . .

5.10 Control input under uncertainty in dynamics model . . . . . . . . . . . . . 5.11 Absolute error metric and relative error metric under uncertainty in dynamics model. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

128 131 132 133 134 135 137 138 139 140

5.12 Estimation of uncertain dynamics model under external disturbances 5.13 State estimates under external disturbances

. . . . . . . . . . . . . . . . .

5.14 Tracking error under external disturbances . . . . . . . . . . . . . . . . . . 5.15 Control law under external disturbances . . . . . . . . . . . . . . . . . . .

5.16 Absolute error metric and relative error metric under external disturbances. 5.17 Estimation of uncertain dynamics model under a constant control command 5.18 State estimates under a constant control command . . . . . . . . . . . . .

5.19 Tracking error under a constant control command . . . . . . . . . . . . . . 5.20 Control input under a constant control command . . . . . . . . . . . . . .

xii

List of Figures
5.21 Absolute error metric and relative error metric under a constant control command. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 141

C.1.1Parameter estimation with adaptive unscented Kalman lter. . . . . . . . . C.1.2Parameter estimation with marginalized unscented particle lter. . . . . . . C.2.1Parameter estimation under uncertainty of dynamic model using adaptive unscented Kalman lter. . . . . . . . . . . . . . . . . . . . . . . . . . . . .

157 159

161

C.2.2Parameter estimation under uncertainty of dynamic model using marginalized unscented particle lter. . . . . . . . . . . . . . . . . . . . . . . . . . . C.3.1Parameter estimation under external disturbances using adaptive unscented Kalman lter. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . C.3.2Parameter estimation under external disturbances using marginalized unscented particle lter. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . C.4.1Parameter estimation under constant applied control commands using adaptive unscented Kalman lter. . . . . . . . . . . . . . . . . . . . . . . . . . . C.4.2Parameter estimation under constant applied control commands using marginalized unscented particle lter. . . . . . . . . . . . . . . . . . . . . . 171 169 167 165 163

xiii

Nomenclature
Nomenclature

List of lowercase symbols
fk hk k n qd qe qi q ^
xk System transition function measurement function Time index Number of states Quaternion for desired attitude Quaternion for attitude tracking error Quaternion for attitude where

i = 1, 2, 3, 4

Quaternion for estimated attitude State variable at time Random sample Mean value of x Estimate of x Measurement at time

k k

(i) xk
x ¯ x ^ yk

i

at time

k i
at time

wk w ~k

(i)

Weight associated with particle Normalized weight

k

List of uppercase symbols
Cqe J K Np Pxx Pxy Q R
Direction cosine matrix related to quaternion Inertia matrix (kg Kalman Gain Number of random samples Covariance of matrix

qe

· m2 )

x

Cross covariance matrix Process noise matrix Measurement noise matrix

xiv

Nomenclature List of Greek symbols
i i d e  ^i  ^i
Control torque for

i = 1, 2, 3 i = 1, 2, 3

Angular velocity for

Desired angular velocity Angular velocity error Estimated angular velocity for Sigma points

i = 1, 2, 3

List of reference frames
B - x, y, z E - XI YI ZI O - x0 , y0 , z0
Spacecraft body-xed coordinate frame Earth centered inertial reference frame Local vertical local horizontal orbital reference frame

Notational conventions
i |·| · ) (· (^ ·) (¯ ·) (~ ·)
x x x x For all values

i = 1, 2, . . . , n

Absolute value Euclidean norm for vectors, induced norm for matrices Derivative of Estimation Mean value Estimation error Skew-symmetric matrix for vector x x is "distributed according" to D. x is "approximately equal" to y. x is "proportional" to y. The probability of event x given event y occurred.

(·)

with respect to time,

t

×

D y y

p(x|y)

xv

List of Figures
Abbreviations

ACS ARC AUKF CNN CSA ECI EKF FDI FUSE i.i.d KF MC MPF MUPF NASA PDF PF RBPF RW RWA SDE SIR SIS SMC UKF UT

Attitude Control System Ames Research Center Adaptive Unscented Kalman Filter Chebyshev neural network Canadian Space Agency Earth Centered Inertial frame Extended Kalman Filer Fault Detection and Isolation Far Ultraviolet Spectroscopic Explorer Independent and Identically Distributed Kalman Filter Monte Carlo Marginalized particle lter Marginalized unscented particle lter National Aeronautics and Space Administration Probability Distribution Function Particle Filter Rao-Blackwellized particle lter Reaction Wheel Reaction Wheel Assembly Stochastic Dierential Equations Sampling Importance Resampling Sequential Importance Sampling Sequential Monte Carlo Unscented Kalman Filter Unscented Transform

xvi

Chapter 1

Introduction

S

pacecraft and multi-agent systems are primarily utilized to implement cross cutting technologies and enhance future Earth and space observing missions. This research

addresses the problem of nonlinear attitude and formation estimation of monolithic spacecraft and multi-agent systems in sequential setting. Nonlinear lters provide a powerful

means for estimating the hidden state of dynamic systems given the trajectory of measurements. Since most dynamic systems are inherently nonlinear, the application of nonlinear ltering spreads into several disciplines including communication, machine learning, system identication, nance, and many others. Various nonlinear ltering techniques are investigated with the primarily focus of estimating the posterior distributions of the state and parameters of space systems. The attention of this research is directed to (1) sequential attitude estimation of monolithic spacecraft with unknown angular velocity measurements and the presence of faults, (2) sequential estimation of unmeasurable angular velocity and reference angular acceleration of Spacecraft Formation Flying, and (3) sequential joint estimation of uncertain dynamic models which describe the evolution of a distributed multiagent system in consensus tracking. Two nonlinear ltering techniques are investigated for online estimation of space systems, namely: adaptive unscented Kalman lter (AUKF) and sequential Monte Carlo

(SMC). One of the attractive merits of AUKF is that it oers an easy approach for online estimation of Gaussian distributions instead of evaluating nonlinear dynamic models. In this sense, the AUKF uses a set of appropriately chosen weighted points to parameterize the mean and covariance of the posterior distributions. On the other hand, the SMC technique allow online estimation by combining the powerful Monte-Carlo sampling methods with Bayesian inference. The SMC approach has been widely applied to state and parameters estimation, for the former of which it is sometimes called particle lter (PF). In this disser-

1

Chapter 1. Introduction
tation, SMC methods are referred to as particle lters. The basic idea of particle lter is to represent the posterior distributions by a number of independent random variables which are sampled directly from the state space and update the posterior once new measurements become available. The particles are properly located, weighted, and propagated recursively according to the Bayesian rule.

1.1

Research Motivation

In a world of limited resources, the development and launch of a successful spacecraft mission requires many scarce resources. Engineers, mathematician, scientists, computerprogrammers and professionals from many disciplines must be employed, countless tests must be performed, and changes must be continuously monitored. The cost of launching of a spacecraft start to accrue from the rst stages of design, to manufacturing and assembly, and continue to increase during the life of the spacecraft's mission. As the owner of a

spacecraft, corporations and government agencies would be interested in eliminating the risk of mission failure and reduce the probability of this scenario. For example, the Far Ultraviolet Spectroscopic Explorer (FUSE) spacecraft was FUSE was developed in

launched in 1999 with a total program cost of $120 million.

cooperation between NASA, the Canadian Space Agency (CSA), and the Centre National d'Etudes Spatiales of France [W. H. Moos 2000]. The FUSE was designed with four RW assemblies (RWA) used to control the attitude of the spacecraft and manage the angular momentum. Three wheels are arranged along the primary axes of the spacecraft, and a

fourth, or skewed, wheel is oriented equidistant from the others. Although the prime scientic instrument of FUSE continue to perform well, the attitude control system (ACS) have suered numerous failures, particularly with the Reaction Wheels (RWs) and gyroscopes which made science operation a challenge [Sahnow

et al. 2006].

One year after launch, FUSE experienced a partial failure of ACS components, which started to aect the operation of the spacecraft. The rst indication of a problem with a reaction wheel was received by the ground station in August 2000 when the pitch wheel showed signs of increased static friction. At the end of 2001, FUSE suered the rst

2

1.1. Research Motivation
permanent component failure that had aected the ability to control the spacecraft. By 2006, the spacecraft was operating on a single reaction wheel as the three reaction wheels aligned with the principal axes of the spacecraft have also failed. Various faults are possible in dynamic systems as presented in Figure 1.1. and

Abrupt

Permanent fault

refer to changes in parameter value that occur much faster then the

nominal process dynamics. Abrupt faults are relatively easy to detect since the fault eect is larger than the modeling uncertainty.

Transient Fault

results in a transient in system

variables. Typically, transient behavior vanishes after a certain time have elapsed, and for certain faults no evidence of fault is observable in the measurements.

Intermittent Fault

refer to faults that occur at irregular intervals in a system that functions normally at other times. Intermittent faults are dicult to troubleshoot since each individual factor does not create the fault alone, so the factors can only be identied while system malfunction occurs.

Incipient Fault Additive Fault

are small and slowly developing faults. It is generally dicult to detect an

incipient fault since the fault eect can be hidden in the uncertainty of the model. Finally, and

Multiplicative Fault

refer to faults that are either added or multiplied

as an input to the system dynamics. The FUSE case stresses the need to develop online ltering techniques and control laws capable of controlling the dynamic systems under the presence of uncertain dynamic models and various fault scenarios.

fault

fault

time Abrupt and Permanent Fault

time Transient Fault

fault

time Intermittent Fault

fault signal

fault

fault signal time Incipient Fault

+

faulty signal

X

faulty signal

Additive Fault

Multiplicative Fault

Figure 1.1: Fault Classication

3

Chapter 1. Introduction
1.2 Signal Noise
In this thesis signals

Signals can be classied in categories depending on their features.

are divided onto deterministic signals and stochastic signal. The deterministic signal are not eected by random noise and there is no uncertainty about their values. Stochastic

signals include an element of uncertainty which is usually removed through ltering process. The signal uncertainty is called

signal noise

which is a general term for unknown and

generally unwanted distortions of the signal. The noise component in the system state is unpredictable and carry no useful information. In most practical engineering problems, Therefore, the

the dynamic systems have traits that make them susceptible to noise.

ltering process is needed to isolate the desired state from the unwanted noise in the signal. Generally, the signal noise is classied based on its statistical properties (sometimes called the color of the noise) and by how it modies the intended signal. The color of the noise is distinguished by their spectral density i.e. white noise is a random signal having equal intensity at dierent frequencies, giving it a constant power spectral density. White noise has equal energy per cycle, meaning that its frequency spectrum is completely at. Because white noise contains the frequencies of all other type of noise, it is frequently used to include all other noise type. White noise got its name from 'white light' since white light contains the frequencies of all color, combined together. If there was no noise in the state, then the state become deterministic and no ltering process is needed.

1.3

Filtering Theory
describes the process of nding an approximate to the state variable given the

Estimation

trajectory of observations. The estimation process is used to approximate the unobserved state on the basis of an observed state trajectory containing noise. The noise in the measurements means that there is a certain degree of uncertainty in the measurements.

State

Estimation

refers to the study of estimating the states of a dynamic system from which we

observe indirect noisy measurements. The dynamic system evolves as a function of time and incorporates a process noise which implies that the dynamic system cannot be modeled entirely in a deterministic settings.

4

1.3. Filtering Theory
Filtering
process is referred to the practice of estimating the hidden state of a dynamic

system based on given observations, which are corrupted by random noise components . The dynamic system follows a process known as the

1

process model.

Since, the hidden state is used to

cannot be measured directly, a related process called the characterize the hidden state of the system.

measurement model

The most outstanding and lasting developments in modern ltering theory can be found in numerous engineering applications where the hidden state is estimated from noisy measurements. The research in the eld had started in late 1930's with the recasting and unifying of control and communication theories on statistical basis. This approach was possible due to the major contribution of Norbert Wiener World War II [Wiener Norbert 1949].

2

and Andrey Kolmogorov's work during

In 1950's, researches had started relaxing the un-

derlying assumptions of Wiener's contribution by replacing the covariance knowledge with state-space representation. This approach was possible due to the contribution of Rudolph E. Kalman [Kalman 1960], Ruslan Stratonovich, and Richard Battin

3

[Battin 1961].

The next theoretical contribution to ltering theory was the introduction of stochastic dierential equations (SDE) in the mid 1960's by Moshe Zakai who studied stochastic processes and their applications in information and control problems. Zakai [Zakai 1965] studied the ltering problem as a generalization of Kalman-Bucy lter and derived SDE for the posterior distribution which are modeled by a continuous Markov process. Za-

kai [Zakai 1969] derived a considerable simple solution for optimal lter, known as the

Zakai equation, which has been the starting point for further research work in the eld.
In 1990's researches had coupled the Monte Carlo technique with Bayesian algorithms. This technique is known as sequential Monte Carlo (SMC) and several closely related tech-

random noise component results from measurement inaccuracy, measurement distortions, model uncertainty etc. Without the noise component, the ltering problem would be deterministic and estimation would not be needed. 2 Kolmogorov was a chief Russian exponent of the theory of probability while developing parallel probabilistic theories to Wiener's work. For many years Wiener and Kolmogorov were on each other's heels in terms of development of probabilistic theory. Both greatly contributed to the ideas of ltering problem although they were not aware of each others early work [Wiener Norbert 1949]. 3 Richard Battin published similar results to Rudolph E. Kalman in an internal MIT Instrumentation Laboratory Report in September 1961.

1 The

5

Chapter 1. Introduction
niques have appeared in the scientic literature

i.e.,

particle lter, Monte Carlo lter,

condensation lter, bootstrap lter etc. The introduction of SMC has fundamentally inuenced the area of nonlinear ltering; it has extended the reach of nonlinear ltering to higher dimensional application and enlarged the range of practical applications. Table 1.1 present a brief historical development and contributions to ltering theory as arranged by year of development and contribution. It is unfortunately not been possible to include all leading researchers in the eld and highlight all contributions. For extensive study and great historical overview of nonlinear ltering theory please refer to The Oxford Handbook of Nonlinear Filtering [Crisan & Rozovskii 2011].

1.4

Linear and Nonlinear Filtering Techniques

The ltering techniques presented herein are organized according to the time of development, starting from Kalman lter (KF) and continuing with extended Kalman lter (EKF), unscented Kalman lter (UKF), and particle lter (PF). The description includes a short historical development, underling principle, and limitations of the ltering technique.

1.4.1 Kalman Filter
Historical Development:
The celebrated Kalman Filter (KF) is a widely used lter This well-known lter made the for state estimation and prediction of linear systems.

transition from a relatively abstract theory to application within a very short time during the early 1960's. The development of the lter resulted from continuous eorts by NASA during the 1950's to implement an estimator in space navigation problems. The primary objective was to develop the technology for a self-contained system which could be implemented in an on board digital computer. The system with pilot input was to guide the spacecraft from injection around the moon and to satisfy reentry corridor requirements on return to Earth. The research work on navigation was not proceeded very well at During the late 1950's,

NASA and they needed a major breakthrough [Schmidt 1981].

work begun to replace the statistical based Wiener-Kolmogorov theory with state-space description. This resulted in work similar to Kalman lter as we know it today. Research

6

Table 1.1: Summary of developments in ltering theory [Chen 2003]

.

Year Author
Innovation Spectral factorization Lattice lter Innovation, Whitening Orthogonal projection Conditional Markov process Recursive Riccati equation Partial dierential equation Partial dierential equation Monte Carlo Benes Sequential Monte Carlo, Bootstrap Unscented transformation Exact Exact Exact Approximation Exact Approximation Approximation Exact Exact Exact Approximation Exact Exact

Method

Solution

Comment
Linear, stationary Linear, stationary Linear, stationary, nite memory Linear, stationary LGQ, non-stationary, discrete Nonlinear, non-stationary LGQ, non-stationary, continuous Nonlinear, non-stationary Nonlinear, non-stationary Nonlinear, non-Gaussian, non-stationary Nonlinear, nite-dimensional Nonlinear, non-Gaussian, non-stationary Nonlinear, Gaussian, derivative-free

1941

Kolmogorov

1942

Wiener

1947

Levinson

1950

Bode& Shennon

1960

Kalman

1.4. Linear and Nonlinear Filtering Techniques

7

1960

Stratonovich

1961

Kalman & Bucy

1967

Kushner

1969

Zakai

1969

Handschin & Mayne

1981

Benes

1993

Gordon, Salmond & Smith

1997

Julier & Uhlmann

Chapter 1. Introduction
in this direction had started by Richard Bucy and James W. Follin [Bucy & James 1962], A.G. Carlton [Carlton & James 1956]. At the same time, Rudolph E. Kalman indepen-

dently developed a discrete-time lter which he presented at NASA Ames Research Center (ARC). In 1960, Kalman and Bucy [Kalman & Bucy 1961] became aware of each other's work and collaborated on the publication of a continuous-time Kalman lter. Additional historical notes on Kalman lter related to orbital dynamics and spacecraft guidance can be found in book by Richard Battin [Battin 1964]. The book by Dan Simon [Simon 2006] extensively elaborate on the discrete-time Kalman lter, continuous-time Kalman lter and optimal smoothing with Kalman lter. In 2009, Paul Zarchan and Howard Musso [Paul Zarchan 2000] published the third addition of progress in astronautics and aeronautics which extensively covers topic related to Kalman ltering and other ltering techniques.

Principle:

The Kalman lter [Kalman 1960], also known as Kalman-Bucy lter, is

an optimal linear ltering technique that represents a class of Bayesian estimator under conditions involving linear-Gaussian uncertainty. The KF is a model-based lter which

yields state and parameter estimations based on the properties of the dynamic model. The development of the lter represents a corner stone in state estimation and relies on a two steps iterative process of prediction and correction. The prediction step involves a time update based on a one-step Markov process where the observation is predicted; and the correction step involve a measurement update where the correction to the estimate of current state is calculated.

Issues:

The Kalman lter is limited to a range of linear dynamic models under Since most practical engineering systems possess

the assumption of a Gaussian noise.

some degree of nonlinearity, Kalman lter fail to provide an accurate state estimation. When applied to nonlinear systems large estimation errors are introduced in the process and the lter fails to converge [Martin E. Liggines 2009].

8

1.4. Linear and Nonlinear Filtering Techniques

1.4.2 Extended Kalman Filter
Historical Development:
In 1960's, Rudolph E. Kalman was invited to National Aeronautics and Space Administration (NASA) Ames Research Center (ARC) in California. Kalman presented his results at ARC where his work believed to provide a practical solution to trajectory estimation and control. By early 1961, Kalman lter was implemented in computer simulations of the circumlunar navigation problem [Schmidt 1981]. The

researchers at NASA realized that the lter could be divided into two parts: one part for time periods between sensor readings and another part for incorporating measurements. The eort at ARC accomplished several key steps in the development of Kalman ltering technique as a practical method for real-time onboard navigation of the Apollo mission. One of the major contributions was the development of the

extended Kalman lter

(EKF)

to show that nonlinearities of the trajectory model did not compromise the accuracy of EKF for the ranges of errors expected during the Apollo missions [Grewal S. Mohinder 2010].

Principle:

The EKF adapts the linear properties of Kalman lter to conditions in-

volving nonlinearity by employing a local linearization using Taylor expansion . The KF remains basic form of the EKF; however, partial derivatives are applied either to state transition or measurement models to develop a minimum variance estimate of the state.

4

Issues:

The need to evaluate a Jacobian matrix to approximate the true density In addition,

may cause the lter to diverge if the dynamic model is severely nonlinear.

a Gaussian approximation can never describe the distribution well especially if the true density is non-Gaussian (

i.e.

binomial, heavily skewed etc.), [Arulampalam

et al. 2002].

Finally, the EKF uses rst-order terms for state approximation and ignores higher-order terms resulting in a large estimation errors as higher order terms begin to dominate.

expansion is a representation of nonlinear functions as an innite sum of terms that are calculated from the values of the function's derivatives with respect to a single point. For example, the best linear approximation for the function f (x) is the rst-order Taylor expansion f (x)  f (a) + f (a)(x - a). Additional higher-order terms could be added to obtain a better approximation for f (x) near the point a (a) (a) (a) via the expression f (x)  f (a) + f 1! (x - a) + f 2! (x - a)2 + f 3! (x - a)3 + · · · .

4 Taylor

9

Chapter 1. Introduction

1.4.3 Unscented Kalman Filter
Historical Development:
Unscented Kalman Filter (UKF) was rst proposed by Simon Julier and Jerey K. Uhlmann [Julier & Uhlmann 1997] and further developed by Wan and Van der Merwe [Wan & Van Der Merwe 2000]. When the lter was developed at the Robotics Research Group (RRG) in Oxford, UK in 1994 it was called the "new lter". Due to the ambiguous and boring nature of the name, it was decided that a better name is needed for the ltering technique. Dierent names were identied for the lter and it was named Unscented Kalman Filter after a democratic vote by RRG members. In 1997, Julier and Uhlmann published the rst paper describing the UKF as a new extension to Kalman lter for nonlinear systems.

Principle:

The

UKF

provides

an

ecient

derivative-free

ltering

technique

for It is

computing approximate solution of discrete-time nonlinear estimation problems. built on the principle that

it is easier to approximate a probability distribution than it
[Julier & Uhlmann 1997]. The UKF

is to approximate an arbitrary nonlinear function
addresses the approximation issue through

unscented transformation sigma points.

(UT) principle which

is a deterministic sampling technique for selecting a set of specic sample points around the mean. These specic sample points are known as When sigma points

are propagated through nonlinear transition and measurement models, the mean and covariance of the state estimates can be accurately captured.

Issues:

The UKF uses specic and deterministic sigma points to calculate the mean and These sigma points propagate through the nonlinear

covariance of the state of interest.

transition model and the posterior distribution is calculated by averaging the sigma points. The number of sigma points is small and may not adequately represent complicated posteriori distributions which may include biases such as skewness, kurtosis and outliers. The UKF is valid only when the posterior distribution can be closely approximated by a Gaussian distribution since the underlying principle of the UKF uses the Kalman lter as a backbone. The UKF preserves the linear update structure of the Kalman lter which is optimal only in linear Gaussian dynamic systems.

10

1.4. Linear and Nonlinear Filtering Techniques

1.4.4 Particle Filter
Historical Development:
The particle lter had its beginning in 1940's; however, only in 1993, Gordon, Salmond, and Smith [Gordon & Smith 1993], presented the rst application of a Monte Carlo resampling algorithm in Bayesian inference. The authors

named the algorithm "The Bootstrap Filter" and demonstrated that bootstrap lter does not require any assumption about the state-space or system noise. In 1996, Kitagawa

[Kitagawa 1996], [Kitagawa 1998] introduced similar results and named it the "Monte Carlo Filter". The term "particle lter" was rst coined in 1996 by Pierre Del Moral Bearing the nature of a

[Del Moral 1996] in a published paper on nonlinear ltering.

recursive Bayesian estimation and sequential Monte Carlo simulation, particle lter has demonstrated its potential in various nonlinear, non-Gaussian, non-stationary estimation problems. The lter appears in the scientic literature under various names

i.e., sequential

importance sampling (SIS), bootstrap ltering, the condensation algorithm, interacting particle approximations, Monte Carlo ltering, sequential Monte Carlo (SMC) ltering, and survival of the ttest. As a result of its popularity several tutorials and books

have been published on the subject [Arnaud Doucet 2001], [Arulampalam [Chen 2003], [Doucet & Johansen 2008].

et al. 2002],

Principle:

The particle lter relaxes the Gaussian assumption of Kalman lters by

approximating the posterior distribution with discrete random measures composed of weighted particles. The

particles

are samples of the hidden state and the

weights

are

probability masses estimated using the Bayesian recursion. The lter implements sequential estimation by Monte Carlo simulation, where the samples drawn from the posterior distribution provide an approximation to the intractable integrals of the Bayesian equation.

Issues:

The particle lter is guaranteed to diverge as time increases.

To alleviate

the divergence issue, a proper proposal distribution must be selected and additional resampling steps must be introduced in order to reduce the variance of estimation. The simplicity of the particle ltering technique is deceptive since the technique is extremely eective and stable; however, the Monte Carlo simulation increases the computation cost.

11

Chapter 1. Introduction
1.5 Problem Statement

Nonlinear dynamic systems do not have an exact solution and various numerical approximation methods were proposed to address the intractability inherited in the Bayesian recursion. In contemplation of future space missions, it is of interest to estimate the state and parameters of space systems with strict demand for precise online estimation under the condition of

nonlinearity, non-Gaussian

and

non-stationary

models.

[PROB1] Nonlinear estimation.

The inherent nonlinearity of the system models is iden-

tied as one of the technological bridges to be crossed for successful implementation of a nonlinear estimation and control algorithms. A linear representation of the dynamic model does not accurately describe the behavior of the space system for a wide range of operating conditions and results in system divergence over time.

[PROB2] Non-stationary estimation.

Online estimation is a non-stationary process where

the joint probability changes with respect to time. The non-stationary process will have a time-varying mean, time-varying variance, or both. The challenge is to precisely estimate the non-stationary dynamics of the space systems.

[PROB3] Uncertain dynamic models.
models are unknown.

One of the challenges is to estimate the posterior

distributions of the space systems in online setting when the process and measurement This problem is known as

system identication

and is more

concerned with parameter estimation rather than state estimation problem.

[PROB4] Estimation delay.

A particular feature that aects the control of space systems

is the availability of accurate estimations. One of the challenges for online estimation and control is to estimate the states in the presence of delayed measurements or absence of measurements.

[PROB5] Presence of faults.

Space systems may experience various fault scenarios that

cause the system to deviate from its nominal operational regime and degrade the mission success. These faults may occur at the dynamic models, control commands, or sensor measurements.

12

1.6. Research Objectives
1.6 Research Ob jectives

The primarily objective is to investigate various nonlinear ltering techniques that provide precise state estimation for control of space systems in online setting. From practical

perspective, the goal is to implement ltering techniques capable of estimating nonlinear, non-Gaussian and non-stationary processes. The following objectives are identied:

[OBJ1]

Inverse problem:

Nonlinear ltering techniques are investigated for applica-

tions in attitude estimation of monolithic spacecraft with unknown angular velocity measurements, estimation of unmeasurable angular velocity and reference angular acceleration of spacecraft formation ying, and sequential joint estimation of an uncertain dynamic models which describe the evolution of a distributed multi-agent system in consensus tracking. The ltering problem is treated as an

inverse problem

where the states of interest are estimated from available observations. The intention is to use the fundamentals of Bayesian algorithm to compute the posteriori distribution.

[OBJ2] Uncertain

system dynamic modelling and estimation:

The problem arises

from an attempt to construct a mathematical model of an uncertain dynamic system given the measured data. System model is constructed sequentially through estimation of the system parameters in order to satisfy the requirements of online system tracking problem. The parameter estimation process determines the parameters of the system model with acceptable accuracy from sequential measurements, and the resulting model is by necessity an approximation of the true system dynamics.

[OBJ3]

Validation through simulation and analysis:

The performance of the pro-

posed lters is examined in the presence of faults in the system dynamic model, control law and sensor measurements. We approach the validation of the proposed nonlinear lters from two perspectives: conventional theoretical analysis and numerical simulation study. Analytical studies are performed using adequate nonlinear

ltering theory to demonstrate lter performance. Simulation studies are used as a design tool to demonstrate lter performance, compliance with design requirements, and validate established theoretical framework.

13

Chapter 1. Introduction
1.7 Main Contributions

The contributions of this dissertation are aligned with the research objectives outlined in Section 1.6. The eorts are directed towards computation of posterior distributions of The

nonlinear, non-Gaussian, and non-stationary dynamic models in sequential setting.

posterior distribution are computed using nonlinear ltering techniques and are valid for state and parameter estimations and control. The results are addressed through numerical simulations under fault-free and fault-prone scenarios. The following research contributions are presented:

1.

Online state and parameter estimation:

Investigation of adaptive unscented

Kalman lter and particle lter for state and parameter estimation serves the foundations of this research. The AUKF and its variants rely on parametric techniques to estimate the posterior distribution of the state and parameters .

5

In parametric

techniques, a closed form solution is used to describe the posterior probability density function (

i.e.

Gaussian distribution or other well dened distribution).

These parametric lters fail to converge if the dynamic system exhibits substantial nonlinearity and if the state and measurement noise are signicantly non-Gaussian. These limitations have increased the research interest in alternative strategies to estimate any state and measurement equations. Since many practical system and

measurement models are nonlinear and non-Gaussian, a signicant challenge is to nd an ecient estimation technique for online estimation and control from sequential observations. ltering The alternative is to apply a category of non-parametric

6

techniques which approximate the posterior distribution by a nite number

of random samples where each sample corresponds to a region in the state space.

techniques assumes that the data have come from a type of probability distribution and makes inference about the parameters of the distribution. Type of probability distributions include: discrete distributions, continuous distributions, mixed discrete/continuous distributions, joint distributions etc. 6 Non-parametric lters dier from parametric lters in that the model structure is not specied a priori but is instead determined from observations i.e. non-parametric lter makes no assumption about the probability distribution of the observations being assessed.

5 Parametric

14

1.7. Main Contributions
2.

Attitude Estimation and Control of Monolithic Spacecraft:

Accurate and

stable online attitude estimation techniques are investigated in order to increase the pointing capability of a monolithic spacecraft. The attitude must be estimated from available noisy measurements in order to maintain a desired orientation of the spacecraft relative to a reference frame. The contribution of this study is the estimation of spacecraft attitude, in the absence of angular velocity measurements, using two nonlinear ltering techniques in an online setting. Here, the estimated state vector is comprised of four quaternion and three angular velocities.

3.

Distributed Attitude Estimation and Control for Spacecraft Formation Flying: Nonlinear ltering techniques are investigated to obtain accurate estimations of angular acceleration and unmeasurable angular velocity for Spacecraft formation ying (SFF). The nonlinear lter coupled with an asymptotic output feedback attitude control law are utilized to estimate the unmeasurable angular velocity and angular acceleration of the SFF. Simulation results show fault reconstruction and recovery with formation stabilization in the presence of faults and uncertainty at the Spacecraft dynamic model, measurement model, and control commends. The

performance comparison between the nonlinear lters is illustrated with numerical simulation through calculations of formation-keeping error and station-keeping error. Here, the estimated state vector is comprised of 36 states for a total of 6 spacecraft where for each spacecraft the attitude and angular velocities are estimated.

4.

Online Estimation and Control of Multi-Agent Systems:

A nonlinear ltering

technique is developed for joint estimation which uses the Rao-Blackwellised principle to couple the particle lter with unscented transform (UT) technique. The proposed lter is applied in online joint estimation of an uncertain dynamic models, which describe the evolution of a distributed multi-agent system in consensus tracking. Chebyshev neural network (CNN) is incorporated as a universal approximation to learn an uncertain nonlinear functions of decentralized multi-agent dynamic system. This is a complex problem since the joint estimation vector is comprised of 180 states and parameters.

15

Chapter 1. Introduction
1.8 Thesis Outline

The dissertation is structured as follows: Chapter 2 provides a formal description of nonlinear ltering problem and Bayesian framework which serves as a foundation for all nonlinear lters described in this dissertation. The chapter also provides a detailed overview and mathematical development of the nonlinear lters presented in this dissertation i.e. adaptive unscented Kalman lter (AUKF) and particle lter (PF). Chapter 3 deals with estimation of nonlinear attitude stabilization of monolithic spacecraft where the quaternion and angular velocity of a spacecraft are estimated under a nite-time control law. The chapter also provides an evaluation of performance and comparison between adaptive unscented Kalman lter and particle lter. The evaluation of performance and comparison focuses on calculations of quaternion error and angular velocity residuals and measured by the root mean squared error (RMSE). Chapter 4 covers the problem of online distributed ltering for velocity-free attitude estimation of spacecraft formation ying (SFF). The AUKF and PF in parallel with an asymptotic output feedback attitude control law are utilized to estimate the unmeasurable angular velocity and angular acceleration of Spacecraft in formation ying. Here, the performance comparison between AUKF and PF is illustrated with numerical simulation of formation-keeping error and station-keeping errors. Chapter 5 deals with online estimation of uncertain dynamic function that describes the evolution of a decentralized multi-agent system in consensus tracking under bounded external disturbances, and process and measurement noise. Here, we develop a nonlinear lter for online estimation which uses the Rao-Blackwellised technique to couple the particle ltering algorithm with unscented transform (UT) principle. The lter is applied for system identication using a Bayesian neural network (NN) learning where the parameters of the NN are estimated using the AUKF and the proposed lter. Finally, the dissertation is concluded in Chapter 6 with summary of accomplishments and suggestions for future work. I hope this dissertation will provide a greater exposure to the reader on the eld of nonlinear estimation and will constitute a valuable source of information of various nonlinear ltering techniques which are applicable in the aerospace industry.

16

Chapter 2

Nonlinear Filters and Neural Networks

"The greatest physical tradition of Newton had necessarily been one of determinism, where a perfect knowledge of the universe at one instant is understood to involve a perfect knowledge of its history throughout all time. It would have been Newton's assumption that to give the present positions and speeds of the particles in a wave moving across a surface of the Charles [Charles River in Massachusetts] would allow us to plot the movement of this wave forever. Unfortunately, no perfect knowledge of the present is available to us with our limited measuring instruments, and the problem that faces the working physics is to nd how far one can go with the imperfect knowledge. For this it is required to work not with a single, xed universe but with many dierent universes simultaneously, each having some preassigned probability. It is not possible to tell what will happen in the future but what may happen at certain times, given certain conditions" [Wiener Norbert 1956].

2.1

Introduction

Nonlinear ltering theory deal with the problem of estimating the hidden state of a time varying dynamic system given access to measurements which are corrupted by a random noise component. stochastic process known as a directly. Instead, a The time varying dynamic system evolve according to a

process model, or system model, which can not be measured Inverse problem
since the state of interest are

measurement model, is used to correlate the desired hidden state to the

measurements. The ltering process is an

estimated from available measurements, where probability analysis are used to estimate the posterior distributions of the state. The posterior distributions provide a solution to ltering problem based on Bayesian algorithm.

17

Chapter 2. Nonlinear Filters and Neural Networks
The ltering problem was rst established in the early 1940s given the pioneering work of Norbert Wiener and Andrey N. Kolmogorov [Wiener Norbert 1949]. Wiener was rst

to estimate dynamic systems in the presence of noise in continuous-time domain whereas Kolmogorov studied the problem in discrete-time domain. The result of Wiener were included in a classied Defence Research Council report issued in January 1942. The report is known as "The Yellow Peril" because of the yellow cover of the book. This chapter explains the ltering problem and provides a mathematical treatment of nonlinear ltering techniques and Chebyshev neural networks (CNN). In Section 2.2, the ltering problem is formally dened in discrete-time domain. Section 2.3 covers Bayesian estimation theory which is the foundation to all nonlinear ltering techniques discussed in this dissertation. Section 2.4 introduces the well documented unscented Kalman lter (UKF) algorithm. Section 2.6 and Section 2.7 are crucial foundations for proper design of Sequential Importance Sampling (SIS) algorithm which is described in Section 2.8. Finally, Section 2.9 provides a mathematical description of Chebyshev neural networks.

2.2

Problem Statement

The problem of nonlinear ltering consists of computing the conditional distribution of the state variables at current time given the measured data accumulated up to that time. The hidden state variable measured data

xk

is not directly measured and need to be reconstructed from the

yk .

The state-space representation provides a convenient and compact way

to model and analyze the estimation problem with multiple inputs and outputs. To dene the estimation problem,

system model

is required to describe the evolution of the dynamic

system with respect to time. In addition,

measurement model

is needed to relate the noisy

measurements to the state. The system model is a one-step Markov process that describes the evolution of the state from

xk

to

xk+1 ; and, the measurement model relates the state
Figure 2.1 shows the system diagram.

vector to the measurement vector,

yk .

For online estimation and control problems, the interest is in a discrete-time models given its suitability for digital computation. A general discrete-time estimation problem in state-

18

2.2. Problem Statement
space representation is given as follows [Jazwinski 1970]:

xk+1 = fk (xk , uk ) + wk yk = hk (xk ) + vk

(2.1a) (2.1b)

where Equation (2.1a) represents the system model, and Equation (2.1b) is the measurement model. The function

fk : Rnx × Rnv  Rnx ,
1

describes the state evolution and can be describes the measure-

either a linear or nonlinear . The function ment model. The subscript time varying.

hk : Rnx × Rwn  Rny

k

in

fk

and

hk

indicates that the models themselves may be

xk  Rnx

is the

state vector
wk

which gives a complete information of the sys-

tem behaviour, and is necessary for control purpose,

yk  Rny

is the

measurement vector,
vk
is an additive

uk

is a deterministic control input,

is an additive process noise, and

measurement noise.

SYSTEM DISTURBANCE DESIRED STATE + _ STATE ERROR CONTROL LAW CONTROL COMMAND SYSTEM STATE

SYSTEM DYNAMICS

ESTIMATED STATE

FILTER / ESTIMATOR

MEASUREMENT MODEL

MEASUREMENT NOISE
Figure 2.1: System diagram

case of linear function, the estimation problem is simplied signicantly and Kalman lter can be implemented (see Chapter 1.4.1). For nonlinear functions, where the relationship between system model and measurement model breaks down, nonlinear lters have been developed i.e., unscented Kalman lter (UKF) or particle lter (PF).

1 In

19

Chapter 2. Nonlinear Filters and Neural Networks
2.3 Bayesian Estimation

The state estimation involves the construction of a posterior

probability density function

(pdf ) which describes the state of an evolving dynamic system. The posterior pdf, denoted as

p(xk |yk ), is the conditional probability of the state that is constructed from the prior dis-

tribution and the likelihood function according to Bayesian rule. Knowledge of the posterior distribution enable to extract the hidden state from the uncertain measurements. Dening the posterior distribution and extract the hidden state,

xk ,

from noisy measurement

yk

using Bayesian rule requires three characteristics: [Martin E. Liggines 2009] 1.

Prior distribution,

denoted as

p(xk |yk-1 ),

includes the historical trajectory of the

system state. The prior distribution is called a "prior" since the state distribution is known before an evidence of measurement is taken into account.

2.

Likelihood function, denoted as p(yk |xk ), characterizes the information of sensor measurements and available observations of the dynamic system.

3.

Evidence, denoted as p(yk |yk-1 ), characterizes the evidence obtained from the latest
measurement.

The detailed derivations of the recursive Bayesian estimation is developed by making the following assumptions: 1. The state vector,

xk  Rn , evolves according to the system model in Equation (2.1a); xk  p(xk |xk-1 ).
Here,

where the probabilistic nonlinear ltering model consists of a sequence of conditional probability distribution such that

p(xk |xk-1 )

is the proba-

bilistic model of the dynamic system.

2. The measurements are related to the state vector via the measurement model in Equation (2.1b); where the probabilistic nonlinear model consists of a sequence of conditional probability distribution such that

yk  p(yk |xk ).

Here,

p(yk |xk )

is the

probabilistic model of the measurements given the state.

3. The state of the dynamic system follows a rst-order Markov process,

p(xk |x0:k-1 ) =

p(xk |xk-1 );

where the Markov property implies that the conditional probability dis-

20

2.3. Bayesian Estimation
tribution of

xk depends only upon the given distribution xk-1 and not on the sequence
{yk ; k  N}
are conditionally independent of the given state

of states that preceded it.

4. The measurements

{xk ; k  N}

and of the marginal distribution

p(yk |xk ).

5. The initial pdf system model

p(x1 |y0 ) = p(x1 )

of the state vector is available together with the

fk

and measurement model

hk .

The posterior pdf is obtained recursively in two stages: the pdf

prediction

and

update.
k

Suppose

p(xk-1 |yk-1 )

at time step

k-1

is available. The prediction stage incorporate the via the

system model (Eq'n (2.1a)) to obtain a distribution of the state at time step Chapman-Kolmogorov Equation [Chen 2003].

p(xk |yk-1 ) =
Then at time step

p(xk |xk-1 )p(xk-1 |yk-1 )dxk-1

(2.2)

k

a measurement

yk

becomes available and may be used to update the

prior via Bayes rule

p(xk |yk ) = p(yk |yk-1 )

p(yk |xk )p(xk |yk-1 ) p(yk |yk-1 ) p(xk |yk ),

(2.3)

In order to compute the posterior distribution, inator involve the term

in the update stage, the denommust be solved. The

known as the

evidence equation

evidence equation is determined by the following integral

p(yk |yk-1 ) =

p(yk |xk )p(xk |yk-1 )dxk

(2.4)

Conceptually, the Bayesian approach for recursive estimation is simple to solve; however, the challenge is to evaluate the integrals in the Bayesian equation. The evaluation of the integrals is very dicult and can not be determined analytically since the large dimensionality of the integral causes numerical integration techniques to break down. Several

analytical solutions were developed to deal with the Bayesian equation under unique conditions. In particular, if the evolution process (Equation (2.1a)) and measurement process (Equation (2.1b)) are linear, and

x 0 , vk

and

wk

are additive, independent and Gaussian

then the Kalman Filter (KF) provide an optimal solution; otherwise, other approaches have to be implemented. This chapter covers few of the proposed approaches starting with a

21

Chapter 2. Nonlinear Filters and Neural Networks
basic overview of Unscented Kalman Filter in Section 2.4. A detailed work on Bayesian ltering is presented in the following books by Doucet & Gordon [Arnaud Doucet 2001], James Candy [Candy 2009], and Simo

Sa ¨rkk a ¨

[Särkkä 2013].

2.4

Unscented Kalman Filter

The Unscented Kalman Filter (UKF) has been widely used in many engineering applications incorporating both linear and nonlinear system dynamics. General application area of UKF may be divided into

state estimation, parameter estimation

and

joint estimation.

The lter

has been proposed by Simon Julier and Jerey K. Uhlmann [Julier & Uhlmann 1997]. The working mechanics of UKF involves propagation of a Gaussian random state vector through the nonlinear measurement model vector

xk

hk , to obtain a transformed random observation

yk

[Wan-Chun Li 2005]. The goal is to accurately estimate the mean value of the

observation

¯k y

and the covariance

Pyy

of the observation

yk

at time

k.

The UKF uses

the unscented transform process to generate a vector of sigma points whose mean and covariance is a close approximation of the actual system state. The unscented transform process involves three steps: First, for a given state vector a set of

xk

with

Nx

random variables,

(2Nx + 1)

sigma points are generated around

^k x

along with a set of associated

weights. The sigma points are propagated through the nonlinear measurement model obtain the vector of observations of the observation vector

hk

to

yk .

Next, the mean vector

¯ k and covariance matrix Pyy y

yk are calculated based on the distribution of these deterministic

sigma points and their weights. The UKF formulation is presented below [Rogers 2007].

UNSCENTED KALMAN FILTER (UKF)
1.

Compute weights
m) W( = 0 c) W( 0 m) W( i c) W( i

 , n+  2 = + (1 - U KF + U KF ), n+ 1 = , i = 1, . . . , 2n 2 (n + ) 1 = , i = 1, . . . , 2n 2 (n + )

(2.5a) (2.5b) (2.5c)

(2.5d)

22

2.4. Unscented Kalman Filter

2.

Establish symmetric sigma points about the state estimate
Xk - 1 =
( i)

  ^ k-1   x   

i=0
(2.6)

^ k-1 + (n + )Pi i = 1, 2, . . . , n x ^ k-1 - (n + )Pi i = n + 1, n + 2, . . . , 2n x

3.

Instantiate sigma points through the process model
^ (i) = fk (X (i) ) X k k-1
(2.7)

4.

Predict mean and covariance of states
¯k = x Pxx =
i=0 2n

Wi
i=0 2n

(m)

^ ( i) X k

(2.8a)

(c) ^ (i) ^ (i) - x ¯ k ][X ¯ k ]T + Q Wi [X k -x k

(2.8b)

5.

Instantiate sigma points through the measurement model
^ (i) = hk (X (i) ) Y k k -1
(2.9)

6.

Predict mean and covariance of measurements
¯k = y Pyy =
i=0 2n

Wi
i=0 2n

(m)

^ ( i) Y k

(2.10a)

(c) ^ (i) ^ (i) - y ¯ k ][Y ¯ k ]T + R Wi [Y k -y k

(2.10b)

7.

Predict cross covariance
2n

Pxy =
i=0
8.

^ -y ^ -x ¯ k ][Y ¯ k ]T W i [X k k
(c) (i) (i)

(2.11)

Gain calculation and update
-1 K = Pxy Pyy
(2.12a) (2.12b) (2.12c)

^k = x ¯ k + K (yk - y ¯k) x P + = Pxx - KPyy K T

23

Chapter 2. Nonlinear Filters and Neural Networks
The UKF parameter



in Equation (2.5) is a composite scaling parameter dened by and

 = (U KF )2 (n + ) - n, where U KF
the mean,

 determine the spread of the sigma points around U KF
is a design parameter for in Equation (2.6)

n

is the dimension of the augmented state and The term

the distribution [Wan & Van Der Merwe 2000]. represent the scaled

(n + )Pi P -.

ith

row/columns of the sqre root factor of

Figure 2.2 shows the

signal ow diagram of the unscented Kalman lter.

It is evident that the sigma points

are propagated through the process and measurements models after which the state and measurements statistics are estimated.

Figure 2.2: Signal ow of unscented Kalman lter [Abreu 2011]

2.5

Adaptive Unscented Kalman Filter

The following adaptive mechanism is used to adjust the process noise covariance matrices [Abreu 2011].

- Pxx = Pk  + Qk+1
If

(2.13)

=1

then the standard KF prediction occurs, if

>1

the lter will weight the data

exponentially so that the eect of current data is emphasized and information from older measurements is discounted, hence the name 'fading factor' or 'fading memory'.

24

2.6. Monte Carlo Approximation

=1+

trace (Rk ) 

(2.14)

This formulation guarantees that the adaptive factor will increase for larger values of The

Rk .

trace operation consists of the sum of the diagonal elements of a matrix, which indicates trace
operation becomes large

the size of the residual error. For larger residual errors the and increases the value of the adaptive factor. If the

Rk diagonal entries get larger the fading

factor will increase thus forcing the lter to base its estimates on new data. Whereas if the

Rk

matrix is close to zero the adaptive factor will be close to zero meaning that when

convergence is achieved it bases its estimates more on past data.

2.6

Monte Carlo Approximation
2

Monte Carlo

(MC) algorithm is a stochastic sampling approach aiming to tackle the com-

plex systems which are analytically intractable.

The power of MC technique is expressed
Much

in its ability to avoid numerical integration by mapping integrals into discrete sums.

of the initial development of Monte Carlo occurred during World War II at Los Alamos National Laboratory, with the work of Stanislaw Ulam, Nicholas Metropolis, Enrico Fermi and John von Neumann [Metropolis 1987]. Ulam invented the method while working on nuclear weapon projects and Metropolis used the term Monte Carlo to describe analytical methods using the propagation of random samples to represent changes in probability distributions [Metropolis & Ulam 1949]. Their contribution was central to the simulations required for the Manhattan Project, though severely limited by the computational tools at the time. The principle of Monte Carlo relies on the law of

unconscious statistician 3
with given probability

where the expected value of a function

fk (·) of a random variable x0:k

name was rst suggested by Stanislaw Ulam to highlight a method named after a city in Monaco principally because of a roulette, a simple random number generator. 3 The law of unconscious statistician is a theorem used to calculate the expected value of a function f (x) of a random variable x when the probability distribution of x is known but the distribution of f (x) is not known explicitly.

2 The

25

Chapter 2. Nonlinear Filters and Neural Networks
distribution

p(x0:k |y1:k )

is computed as follows

E(fk (x0:k )) =

fk (x0:k )p(x0:k |y1:k )dx0:k

(2.15)

The expected value in Equation (2.15) is approximated by avoiding the numerical integration and mapping the integral into a discrete sum as follows

1 E(fk (x0:k ))  Np

Np

fk (x0:k )
i=1

(i)

(2.16)

(i) where the samples x0:k are assumed to be independent and identically distributed (i.i.d)
support points for the approximation to hold. According to the

law of large numbers,

the

approximation almost surely converges to the expectation as the number of support points

Np

increases.

2.7

Bayesian Importance Sampling

The objective of importance sampling is to sample the distribution in the region of importance in order to achieve computational eciency. It is almost impossible to sample

directly from the posterior density function in Equation (2.15); therefore, a proposal distribution

q (x0:k |y1:k )

(see Appendix A for details) and a Bayesian algorithm are suggested

to approximate the posterior distribution as follows:

E(fk (x0:k )) =
Using Baye's rule

fk (x0:k )

p(x0:k |y1:k ) q (x0:k |y1:k )dx0:k q (x0:k |y1:k )

(2.17)

E(fk (x0:k )) = =
where the variable

fk (x0:k )

p(y1:k |x0:k )p(x0:k ) q (x0:k |y1:k )dx0:k p(y1:k )q (x0:k |y1:k ) wk (x0:k ) fk (x0:k ) q (x0:k |y1:k )dx0:k p(y1:k )

(2.18a)

(2.18b)

wk

is the unnormalized importance weight

wk =

p(y1:k |x0:k )p(x0:k ) q (x0:k |y1:k )

(2.19)

26

2.7. Bayesian Importance Sampling
furthermore, isolating the normalizing density

p(y1:k )

gives

E(fk (x0:k )) =
where

1 p(y1:k )

fk (x0:k )wk (x0:k )q (x0:k |y1:k )dx0:k

(2.20)

p(y1:k ) = =
therefore,

p(y1:k |x0:k )p(x0:k )

q (x0:k |y1:k ) dx0:k q (x0:k |y1:k )

(2.21a)

wk (x0:k )q (x0:k |y1:k )dx0:k

(2.21b)

E(fk (x0:k )) =
where the notation

Eq (wk (x0:k )fk (x0:k )) Eq (wk (x0:k ))

(2.22)

Eq (·) denotes expectation taken over the proposal distribution q (·|y1:k ).

Hence, by drawing samples from the proposal distribution the expectation can be approximates as follows

E(fk (x0:k )) 

1 Np

Np i=1 1 Np

fk (x0:k )wk (x0:k )
Np i=1

( i)

(i)

wk (x0:k )
(i)

(i)

(2.23a)

Np


i=1
where the normalized importance weight

fk (x0:k )w ~k (x0:k ) w ~k =
(i)
is given by

(i)

(2.23b)

(i) w ~k

wk
Np j =1

(i)

wk

(j )

(2.24)

thus as

Np

approaches innity, the posterior density function can be approximated as the

point-mass estimate

Np

p(x0:k |y1:k ) 
i=1
where

w ~k  (x0:k - x0:k )

(i)

(i)

(2.25)

 (·)

denotes the Dirac delta function. Importance sampling, in its simplest form, is

not adequate for sequential estimation since all the observations y1:k must be known before estimating

p(x0:k |y1:k ).

Every time a new observation becomes available the importance

sampling must be computed over the entire state sequence which increases computation complexity over time.

27

Chapter 2. Nonlinear Filters and Neural Networks
2.8 Particle Filter

The Bayesian importance sampling method (detailed in Section 2.7), can be modied for sequential estimations. In sequential settings, the lter is called

particle lter

(PF) or

sequential importance sampling

(SIS). The various versions of particle lters proposed in

literature can be regarded as special case of SIS algorithm. The details of the algorithm requires to characterize the posterior probability distribution measure weights

p(x0:k |y1:k )

with a random

p {x0:k , wk }i=1 , where {x0:k , i = 0, . . . , Np } are the state hypotheses with associated

(i)

(i) N

(i)

{wk , i = 0, . . . , Np }. k

(i)

x0:k

= {xj , j = 0, . . . , k }

is a set of all states from

x0

to

xk .

The weights are normalized to unity according to Equation (2.24) and the empirical is approximated as the weighted sum of all samples evaluated at

posterior density at

the dirac delta distribution given in Equation (2.25). Therefore, the true posterior density,

p(x0:k |y1:k ),

is expressed as a discrete weighted approximation to the true posterior density

where the weights are chosen using the principle of

importance sampling

(see Appendix A).

Figure 2.3 shows the distribution of state hypotheses bility mass

( i) xk and the corresponding proba-

wk

(i)

. Note that no specic assumption is made about the state distribution and

the approximation improves as the number of support points increases since the MonteCarlo representation becomes an equivalent characterization of the posterior density. The objective of sequential importance sampling (SIS) is to nd samples to approximate the priori density at each iteration and approximate the posterior density with the new set of samples. The derivation of the posterior density update equation requires to express the posterior density in terms of priori density, likelihood density and state transition function (see Chapter 2.3) and using the Bayesian rule to express the posterior density as follows:

p(x0:k |y1:k ) =

p(yk |x0:k , y1:k-1 )p(x0:k |y1:k-1 ) p(yk |y1:k-1 ) p(yk |x0:k , y1:k-1 )p(xk |x0:k-1 , y1:k-1 ) = p(x0:k-1 |y1:k-1 ) p(yk |y1:k-1 ) p(yk |xk )p(xk |xk-1 ) = p(x0:k-1 |y1:k-1 ) p(yk |y1:k-1 )  p(yk |xk )p(xk |xk-1 )p(x0:k-1 |y1:k-1 )

(2.26)

Selecting the weights according the principle of importance sampling (see Chapter 2.7), the

28

2.8. Particle Filter
_

0.08

0.06

_

Probability

0.04

_

0.02

_

0

12

3 45 6 7

8 9 10 11 12

13 14

15 16 17

18

19 20 21

22

23

Particle Number
Figure 2.3: Particle lter representation of posterior distribution

[Figure 1]: Particle Filter representation of posterior probability distribution in terms of Particle Number weights (probabilities) and particles (samples).
weight is dened by

wk 
where

(i)

p(x0:k |y1:k )
(i)

q (x0:k |y1:k )
(i)

(2.27)

q (x0:k |y1:k )
(i)

is the importance density from which the samples

( i) x0: k

are drawn from.

It is possible to select an importance density such that

q (x0:k |y1:k ) = q (xk |x0:k-1 , y1:k )q (x0:k-1 |y1:k-1 )
James V. Candy, Bayesian Signal Processing: Classical, Modern, and Particle Filter Methods, John Wiley &

(2.28)

The weight sons update equation is [Page derived Inc. Hoboken, New Jersey 238] by substituting Equations (2.26) and (2.28) into (2.27)

wk 

(i)

p(yk |xk )p(xk |xk-1 )p(x0:k-1 |y1:k-1 )
(i) (i) (i) (i)

q (xk |x0:k-1 , y1:k )q (x0:k-1 |y1:k-1 )
( i) (i) (i) ( i)

= wk -1

p(yk |xk )p(xk |xk-1 )
(i) (i) (i)

(2.29)

q (xk |x0:k-1 , y1:k )
(i) (i)

Equation (2.29) provides a mechanism for sequential update of the importance weights, given the appropriate choice of proposal distribution. Assuming a Markov process where

29

Chapter 2. Nonlinear Filters and Neural Networks
q (xk |x0:k-1 , y1:k ) = p(xk |xk-1 , yk ),
this case, only the importance density dependent on

x

(i) k has to be stored whereas the path

x

k-1 and k . In (i) 0:k-1 and the history of observations

x

y

y1:k-1 can be discarded.

Finally, the posterior density

p(xk |y1:k )
(i)

is approximated as

p(xk |y1:k ) 

Np

wk  (xk - xk )
( i)

(2.30)

i=1
It can be shown that as the number of support points increases

Np  

the posterior

density approximation in Equation (2.30) approaches the true posterior density

p(xk |y1:k ).

SEQUENTIAL IMPORTANCE SAMPLING (SIS) [Särkkä 2013]
1.

Draw Np samples from the prior distribution
i) x( 0  p(x0 ),

i = 1, 2, . . . , Np

(2.31)

2.

Initialize the importance weight
w0 =
(i)

1 , Np

i = 1, 2, . . . , Np

(2.32)

3.

For k = 1, . . . , T
(a)

Draw samples from the importance distribution
i) (i) (i) x( k  q (xk |x0:k-1 , y1:k ),

i = 1, 2, . . . , Np

(2.33)

(b)

Calculate the updated importance weights
wk = wk-1
(i) (i)

p(yk |xk )p(xk |xk-1 )
( i) (i) (i)

q (xk |x0:k-1 , y1:k )
(i) ( i)

,
Np i

i = 1, 2, . . . , Np
( i)

(2.34)

4.

Normalize the importance weight such that
w ~k =
( i)

w ~k = 1
(2.35)

wk
Np j =1

( i)

wk

(j )

30

2.8. Particle Filter
5.

Approximate the posterior distribution
Np

p(x0:k |y1:k ) 
i=1
The problem with SIS algorithm is that as

w ~k  (x0:k - x0:k ) k

(i)

(i)

(2.36)

increase, the distribution of the importance

(i) weight w ~k becomes more skewed. After few iterations all the particles have a zero or nearly
zero weight and the algorithm fails to adequately represent the posterior distribution. This is called the degeneracy problem.

Degeneracy Problem:

The particle lter suers from degeneracy problem where after

few iterations most of the particles except for a very few will have a insignicant weight. Degeneracy implies that a large computational eort is devoted to updating particles whose contribution to the posterior approximation

p(xk |y1:k )

is negligible. The degeneracy prob-

lem is an undesirable eect in particle lter and since the variance of the importance weight only increases over time, it is impossible to void the phenomenon. A well-know measure of degeneracy of the lter is the eective sample size [Liu 2008]

Nef f

dened as [Arnaud Doucet 2001],

Nef f =
where

Np i 1 + V ar(wk )

(2.37)

i wk

is the "true" weight.

i i i = p(xi wk k |y1:k )/q (xk |xk-1 , yk )
This can not be evaluated exactly, but an estimate

^ef f N

of

Nef f

can be obtained by

^ef f = N
where

1
Np i 2 i=1 (wk )

(2.38)

i wk

is the normalized weight in Equation (2.24). Notice that

Nef f  Np ,

and small

Nef f

implies sever degeneracy. One way of reducing the degeneracy phenomenon is to use

very large sample size. However, a very large sample size with a xed number of particles results in approximation with low computational eciency, especially when the true posterior changes over time [Wang & Chaib-draa 2012]. Several methods have been introduced to prevent the degeneracy problem[Arnaud Doucet 2001],[Robert & Casella 2005]. Simple

31

Chapter 2. Nonlinear Filters and Neural Networks
approaches to solve the degeneracy problem include: (1) selecting an optimal importance density and (2) use a resampling strategy.

Resampling:

The Sequential Importance Sampling (SIS) algorithm suers from degener-

acy problem where after few iterations all but one particle will have a negligible weight. The usual strategy around this is to introduce a resampling step. The resampling step is a crucial and computationally expensive part of SIS algorithm. With resampling, the particles with large weights are replicated and the ones with negligible weights are removed. After resampling, the future particles are more concentrated in domains of higher posterior probability, which entails improved estimates. The scientic literature on resampling identies mainly four resampling techniques in a particle lter setting. These include the multinomial, residual, stratied and systematic resampling algorithms. Resampling at every iteration is not necessary for on-line state

estimation since the resampling state consume computation power and may degrade the eciency of the algorithm. It is thus desired to prescribe a schedule for the resampling step to take place [Liu & Chen 1998]. Two resampling schedules are possible: (1)

deterministic
(2)

resampling schedular

where the resampling is performed at xed intervals

k, 2k, . . . , T .

dynamic resampling schedular

where a sequence of threshold are dened and the coecient

of variations is monitored. A detailed discussion on these specic resampling algorithm will be provided in the following chapters. The aim of resampling is to replace the prior set of

Np

particles by a new set of particles, where the particles have been duplicated or rejected

according to their corresponding weight. The higher the weight of a particle, the greater the chance that the particle will be drawn several times. A well argued choice of resampling method is justied as the entire estimation process benet from reduced complexity in the resampling step. Dierent variations of particle lters were developed and special cases

can be derived from the SIS algorithm by appropriate choice of importance sampling and modication of the resampling step. An investigation and detailed discussions on selection process of importance sampling and various resampling techniques are provided in the following chapters.

32

2.9. Chebyshev Neural Networks
2.9 Chebyshev Neural Networks

Chebyshev neural networks (CNN) have been implemented to conquer diculties with unknown nonlinearity and time-varying characteristics of many nonlinear dynamic systems. Basios et al. [Basios

et al. 1997]

have approximated a one-dimensional function

dened on a discrete set of points using orthogonal rst-order Chebyshev polynomials and articial feed-forward neural network. Lee and Jeng [Lee & Jeng 1998] proposed an approximate transformable technique to obtain a Chebyshev polynomials based (CPB) unied model neural networks for feedforward/recurrent neural networks via Chebyshev polynomials approximation. Based on this approximate transformable technique, Lee

and Jeng have derived a relationship between a single-layer neural networks and multilayer perceptron (MLP) neural networks based on Chebyshev polynomial model. It

is pointed out that this network has universal approximation capability and has faster convergence than the multilayer feed-forward neural network. Akritas [Akritas have applied CNN to reconstruct and predict a discrete chaotic maps.

et al. 2000]

The method is

based on feed-forward neural network which decomposes the analyzed chaotic map in orthogonal Chebyshev polynomials. A single-layer functional link neural network in which the need of hidden layer is eliminated by expanding the input pattern by Chebyshev polynomials is proposed for the purpose of dynamic nonlinear system identication [Patra & Kot 2002]. System identication schemes for unknown dynamic nonlinear

discrete time system has also been proposed using CNN in a feed-forward neural network framework that ensures identication of general nonlinear dynamical systems with smooth nonlinearities [Purwar

et al. 2007].

Second-order nonlinear ordinary dierential equations

of Lane-Emden type was solved using feed-forward CNN model and principle of error back propagation [Mall & Chakraverty 2014]. In this work, Mall implemented a single

layer neural network to eliminate the hidden layer by expanding the input pattern by Chebyshev polynomials. An adaptive recurrent CNN control system was also proposed

to control a permanent magnet synchronous motor (PMSM) servo-drive electric scooter with V-belt CVT under lumped nonlinear external disturbances [Lin 2015]. Essentially,

learning a nonlinear function boils down to obtaining a description of the conditional distribution through application of a mapping function. When the exact structure

33

Chapter 2. Nonlinear Filters and Neural Networks
of this mapping cannot be established a priori, it may be synthesized as a combination of parameterized basis functions and an estimated system weights. Essentially,

the unknown function can be approximated in a classical neural networks scheme as follows:

Theorem 1

[Poggio & Girosi 1990]:

A continuous function associated weight

f (x)

can be approximated as the product of a basis function and

^(x) = W  (x) +  f
where

(2.39)

^(x) f

is the approximation of the continuous function,

 (x)

is the basis function

with associated weight compact set.

W, 

is the approximation error, and x is the state vector over a

Denition

[Poggio & Girosi 1990]:

The quality of the approximation can be measured by a distance function

^(x) - f (x)|  = |f
where

(2.40)



determines the distance between the approximated function

^(x), f

and the

continuous function

f (x).

Problem statement
If

[Poggio & Girosi 1990]:

f (x)

is a continuous function dened on set x, and

^(x) f

is an approximating function

that depends continuously on parameters

W

and x, the approximation problem is to determine the

W

such that

^(x, W  ), f (x)]  [f ^(x, W ), f (x)]  [f
for all and

(2.41)

W

in the set

P , and W   Rm×N1

is the optimal weight matrix with

N1 = 2mN2 + 1

N2

is the order of the Chebyshev polynomials.

Several methods have been developed in constructing the basis functions tion (2.39)

 (x)

in Equa-

i.e.,

linear mapping, sigmoid function etc.

Here, the attention is directed

34

2.10. Concluding Remarks
to Chebyshev polynomial functions. The Chebyshev polynomial basis function

 (Xi )

(i = 1, 2, · · · , n)

is obtained by Chebyshev polynomial as follows (2.42)

i (Xi ) = (1, T1 (Xi,1 ), · · · , TN2 (Xi,1 ), · · · , T1 (Xi,2m ), · · · , TN2 (Xi,2m ))T
where

Ti (Xi,j ) (i = 1, 2, · · · , N2 , j = 1, 2, · · · , 2m) represent Chebyshev polynomials, which

are a set of orthogonal polynomials derived from the solution of Chebyshev dierential equations and obtained using the two-term recursive formula as follows

T0 (Xi,j ) = 1 T1 (Xi,j ) = Xi,j Ti+1 (Xi,j ) = 2Xi,j Ti (Xi,j ) - Ti-1 (Xi,j )
where (2.43)

T0 (Xi,j )

and

T1 (Xi,j )

are the initial conditions of CNN.

2.10

Concluding Remarks

Several approaches were developed to deal with nonlinear ltering which attempt to extract state estimations from noisy measurements. Throughout this dissertation, an emphasis is placed on studying two nonlinear lters which are the adaptive unscented Kalman lter (AUKF) and particle lter (PF). To understand, the development of these lters a background was needed in Bayesian algorithm which is covered in section 2.3. Section 2.4 covers the unscented Kalman lter (UKF) which provide a better nonlinear state approximation with reduced error as compared to KF or EKF. The unscented Kalman lter is an extension to Kalman lter which takes distinctly dierent approach to the nonlinear Gaussian problem. In this approach, a statistical method is developed where deterministic sigma points are transformed to a new nonlinear space and then statistics are calculated to obtain the required state approximation. Section 2.8 covers the sequential importance sampling (SIS) algorithm for state estimation. The SIS algorithm (also known as Sequential Monte Carlo (SMC) or particle lter) forms the basis for most sequential lters. Indeed, it has become traditional to present particle ltering and SMC as being the same thing in much of the literature although SMC encompasses a broader range of algorithms. 2.9, Chebyshev neural networks (CNN) have been introduced. Finally in Section

35

Chapter 3. Attitude Estimation and Control of Monolithic Spacecraft

Chapter 3

Attitude Estimation and Control of Monolithic Spacecraft

The demand for high resolution monolithic spacecraft missions requires to develop an accurate and stable online attitude estimation and control techniques in order to increase the pointing capability of the spacecraft. The attitude estimation requires a simultaneous input from multiple sensors that measure the orientation of the spacecraft relative to a reference frame. The attitude must be estimated since no sensor exist to measure the attitude directly and it must be estimated from available noisy measurements. Here, the spacecraft is controlled in the absence of angular velocity measurements where the adaptive unscented Kalman lter and particle lter are utilized to estimate the quaternion and angular velocities. The attention in this chapter is directed to (1) online estimation of spacecraft attitude and angular velocities using the adaptive unscented Kalman lter (AUKF) and particle ler (PF) techniques, and (2) investigate the behavior of the AUKF and PF in the presence of faults at the spacecraft dynamics, control law, or sensor measurements. The nonlinear ltering techniques in this chapter were selected since the spacecraft attitude problem is nonlinear and an approach is needed to estimates the spacecraft attitude with nonlinear lters. The chapter is organized as follows: Section 3.1 provides a brief introduction to the attitude estimation problem which includes a short overview of various techniques used to solve the problem. Section 3.2 presents the equation of motion of a monolithic spacecraft which includes the kinematic and dynamic equation in quaternion presentation. Section 3.3 provides attitude estimation results for stabilization of a monolithic spacecraft.

36

3.1. Introduction
3.1 Introduction

The orientation of a monolithic spacecraft with respect to a frame of reference is called the

attitude

of the spacecraft and the associated motion is the

attitude motion.

The spacecraft

attitude must be estimated and precisely controlled in order to achieve an accurate Earth pointing capability. frames: The The attitude of a spacecraft is dened by two distinct coordinate which is attached to the spacecraft at its center

body-xed coordinate frame,

of mass, and the

reference frame, which consist of an abstract coordinate system attached

to Earth, Sun, Moon, or other stars. The orientation of the body-xed frame with respect to a reference frame determines the attitude of the spacecraft. The attitude of the spacecraft is represented by three parameters where each parameter has a singularity or discontinuity for certain attitudes .

1

To overcome this singularity, a

higher-dimensional nonsingular parameterization technique was developed with one extra degree of freedom which enforces a constraint and increases the complexity of representation. This nonsingular parameter is known as the four-component quaternion representation for attitude. In this research, the four parameter quaternion and the spacecraft angular velocities are estimated using the adaptive unscented Kalman lter and particle lter. The spacecraft attitude and corresponding motion must be estimated since it is impossible to measure directly the exact state of the spacecraft and it must be estimated from noisy measurements. The proposed nonlinear ltering techniques are part of the computer program that receive sequential data from the spacecraft measurement models and compute appropriate state estimations. The state estimations are sent to the control law which control the

spacecraft actuators and position the spacecraft in desired attitude. The lter requires to determine the posterior probability density of a given dynamic system at each time instant, conditioned on the measurements available up to that time.

techniques to represent the spacecraft attitude include the direction cosines, Rodrigues parameters, rotation vectors, Euler angles, and Gibbs vector. Each of these techniques has its own advantages and disadvantages.

1 Practical

37

Chapter 3. Attitude Estimation and Control of Monolithic Spacecraft

3.1.1 Literature review
The Kalman ltering technique has been widely used for online spacecraft attitude estimation and control problems. The earliest published reference for attitude estimation is the work of J.L. Farrell [Farrell 1970] who studied the extent to which Kalman ltering of crude attitude measurements from Sun sensors and magnetometers could provide attitude accuracy equivalent to that obtained without smoothing from more elaborate instrumentation. Farrell represented the attitude by Euler angles and assumed torque free motion in the attitude prediction for both spinning and non-spinning rigid spacecraft. In the reported work, recognizable nonlinear eects could not be accurately estimated using Kalman lter. Review of Kalman lter for attitude estimation is given by Leerts [Leerts

et al. 1982]

who reviewed the developments of suitable algorithms for spacecraft equipped with threeaxis gyros and line-of-sight attitude sensors. Throughout the report the attitude was presented by quaternion because the representation is free from singularities which prevents gimbal-lock situation. Another short review of application and development of Kalman

lter techniques in the aerospace industry is provided in [Grewal S. Mohinder 2010]. Another reference work on attitude estimation using Kalman ltering technique is the work by Psiaki et. al. [Mark L. Psiaki 1990] who estimated the attitude, attitude rates and constant disturbance torques for a three-axis stabilized spacecraft using Kalman lter. Since a single three-axis magnetometer measurement provide only two-axes worth of attitude information and no attitude rate or disturbance torque information, Psiaki, proposed an attitude determination system that use a sequence of magnetometer measurements which are processed recursively in a Kalman lter setting. A recent technical report from the Department of Computer Science & Engineering at the University of Minnesota, Trawny and Roumeliotis [Nikolas Trawny 2005] created an extensive tutorial for quaternion algebra. In the report, Trawny and Roumeliotis used a Kalman Filter to estimate the attitude of a spacecraft using a quaternion representation. In their work, Trawny and Roumeliotis used an alternative approach to estimate position and orientation of the spacecraft by using data from an inertial measurement unit (IMU) as dynamic model replacement .

2

2 The

IMU is an electrical device that measures and reports the spacecraft translational accelerations

38

3.1. Introduction
The Kalman lter was originally developed as a tool for linear estimation and could not be applied directly to spacecraft attitude estimation given the nonlinear nature of the system dynamics. When the Kalman lter has been applied to nonlinear system it

generated reasonable estimation in localized settings but failed to converge in nonlinear problems. Therefore, nonlinear theory was needed to encompass estimation of nonlinear dynamic system. The extended Kalman lter (EKF) has been successfully applied to

nonlinear estimations and is the most widely used nonlinear ltering technique for attitude estimation. Vathsal [Vathsal 1987] presented a second-order lter using EKF technique for estimating the attitude quaternion using three-axis gyro and star-tracker measurement data. In his work, Vathsal expended the system and measurement models to second-order using Taylor series approximation and compared the quaternion estimation from the proposed lter to the performance of EKF. Vathsal concluded that the EKF worked well in the linear regime where the linear approximation of the nonlinear dynamic system is valid. lter failed to converge when the system dynamics is highly nonlinear. Modern research in attitude estimation is based on unscented Kalman lter (UKF) and particle lter (PF) scheme. Xiong [Xiong K. 2007] introduced a fault detection method for nonlinear systems using the residual generated by unscented Kalman lter. In the study, Xiong introduced a detection algorithm for satellite attitude sensor faults using the UKF and a local approach for detecting changes in the mean of a Gaussian process where the heading of the spacecraft is computed by the roll, pitch, and yaw representation. Xiong introduced faults in the Sun sensor, Earth sensor, the Gyroscope, and incipient faults in the Sun sensor. Rapoport and Oshman [Rapoport & Oshman 2004] studied fault tolerant ltering problem of system with nonlinear dynamics and fault-prone measurements channels. Their work is based on particle ltering approach for estimating the angular velocity of a spacecraft and fault parameters of the measurement channel using four fault-prone rate gyros. The system under investigation included the overall state vector with both system states and the parameters of the measurements channels. Since the size of the state vector can be However, the

and rotational velocities using a combination of three-axis accelerometers and gyroscopes.

39

Chapter 3. Attitude Estimation and Control of Monolithic Spacecraft
prohibitively large for ecient application of ordinary particle lter Rapoport and Oshman used the Row-Blackwellization technique which incorporate the interacting multiple model (IMM) algorithm. The reason for adopting the Row-Blackwellization technique is to bring the estimate the main system states to a reduced-size set of particles. In the work, the

rate gyros were assumed to suer from measurement noise and suddenly appearing and disappearing measurements biases that changed their values each time they appeared. To simplify the analysis it was assumed that the spacecraft is torque-free and no internal or external torques were acting on the spacecraft. Cheng and Crassidis [Cheng & Crassidis 2004] investigated spacecraft attitude estimation using the particle lter technique. The lter formulation, in their work, is based on star camera measurements using gyro-based or attitude dynamic-based model for attitude propagation. Cheng and Crassidis used the Modied Rodrigues parameters for attitude

parametrization to compute the samples mean and covariance of the spacecraft attitude. Their proposed work is primarily based on attitude estimation using the Bootstrap lter, which was proposed by Gordon, Salmond and Smith [Gordon & Smith 1993]. Cheng and Crassidis suggested to use a uniform attitude probability distribution as the initial attitude distribution and using gradually decreasing measurement variance in the computation of the importance weights for the particle lter based attitude estimator to obtain global convergence properties. In addition, they suggested to use as few particles as possible in the bootstrap lter since the computational cost of the lter is largely proportional to the number of particles. For the lter with a modest number of particles to work properly the sampling eciently has to be enhanced. The work was concluded by stating that for large initial errors the bootstrap lter has much better convergence properties than the unscented Kalman lter because the bootstrap lter implicitly captures higher order characteristics of the posterior distribution.

40

3.1. Introduction

3.1.2 Objectives
In the open literature, there has not been much emphasis on attitude estimation and control in an online setting under the presence of faults and without angular velocity measurements where the attitude is represented by the quaternion. The attitude estimation is based on dynamic models and measurement models where a recursive algorithm provides a sequential approach to combine the inputs of both models as they become available to estimate the attitude and angular velocity of the spacecraft. Here, the attitude and angular velocity

are estimated by AUKF or particle lter. Since, the estimation process is done online, a time-delay is introduced in the estimation algorithm to incorporate the estimation delay between sequential measurements. The main contributions of this research are as follows:

1.

Filter models:

Two lter models are constructed to estimate the full state of a The full state vector includes attitude

monolithic spacecraft in an online setting.

and angular velocity estimations. The attitude states and angular velocities of the spacecraft are estimated using nonlinear ltering techniques.

2.

Online estimation and control:

Online estimation and control algorithms for

monolithic spacecraft requires a sequential update of attitude states when new measurement becomes available. Here, the attitude and angular velocity are estimated using the adaptive unscented Kalman lter (AUKF) and particle lter (PF).

3.

Fault scenarios:

The proposed nonlinear lters are tested under abrupt, transient,

intermittent and incipient fault cases. The faults are introduced at the spacecraft dynamic model, the applied control command, and measurement model. The faults are applied at dierent time intervals in an attempt to investigate the lter performance.

4.

Performance evaluation:

Performance evaluation and comparison between AUKF

and PF. Here we challenge the claim by Cheng and Crassidis which states that for large initial errors the bootstrap lter (also known as particle lter) has much better convergence properties than UKF [Cheng & Crassidis 2004]. The investigation fo-

cuses on calculations of quaternion error and angular velocity residuals and measured by the matrix of a root mean squared error.

41

Chapter 3. Attitude Estimation and Control of Monolithic Spacecraft
3.2 System Model, Filter Model, and Control Law

The investigation of attitude estimation of monolithic spacecraft starts by dening the equation of motion of the spacecraft. Section 3.2.1 describes the dynamic equation of

monolithic spacecraft, and Section 3.2.2 describes the kinematic equations.

3.2.1 Dynamic equation
The dynamic equation of a monolithic rigid spacecraft is given by [Hughes 1986]

J  = - × J +  + 
where

(3.1)

 = [1 , 2 , 3 ]T I

is the angular velocity vector of the spacecraft with respect to an

inertial frame

and expressed in the body frame

B, J  R3×3

is the positive-denite mass

moment of inertia matrix,

  R3

is the applied control torque generated by actuators,



is the external disturbance, and

x×  R3×3

for a vector

x = [x1 , x2 , x3 ]T

denotes a

skew-symmetric matrix given by



0

-x3 0 x1

x2


(3.2)

 x× =   x3 - x2

 - x1   0

3.2.2 Kinematic equations
The kinematic equations of a monolithic spacecraft are given by [Hughes 1986]

q = q ¯ = [q1 , q2 , q3 ]T , I,

¯ 1  q4 I3 + q   = 1 A(q ) 2 2 -q ¯T q = [¯ q T , q4 ]T = [q1 , q2 , q3 , q4 ]T B



×



(3.3)

where

and the unit quaternion

represents the

attitude of a monolithic rigid spacecraft in the body frame frame which is dened by

with respect to the inertial

 q=

 ¯ sin(0 /2) cos(0 /2)





=

q ¯ q4

 
(3.4)

42

3.2. System Model, Filter Model, and Control Law
where

 ¯ = [1 , 2 , 3 ]T q q

denotes the principal axis, and

0

is the principal angle. The unit denotes a skew-symmetric

quaternion

satises the constraint

q = 1,

and

q ×  R3×3 q

matrix. Let of

denote a given attitude, then

-q

denote the same attitude after a rotation is given by

±2

about an arbitrary axis. The inverse of a quaternion

q -1 = [-q ¯T , q4 ]T , q qo
is a

and the quaternion error between

q

and

q ^

is denoted as

q ~= q ^-1

q

where

quaternion multiplication dened as [Shuster 1993]

 q qo = 

q4 q ¯o + qo4 q ¯+ q ¯ q ¯o q4 q o 4 - q ¯T q ¯o

×

 
(3.5)

3.2.3 Filter models
The lter model for estimating the state of a monolithic rigid spacecraft is given by

x ^k+1

= f (^ xk , k ) + wk

(3.6)

where

wk

is the process noise,

k

is the control torque, and x ^k is the seven elements state

vector, which is comprised of three angular velocities and four attitude motions represented in quaternion . The notation

3

(^ ·)

denotes the estimation of

( · ).

The augmented state

estimation vector is given by x ^k

^ =  ^k , q ¯k , q ^4k

T

, and

f (^ xk ,  )

is propagated through the

forth-order Runge-Kutta method as follows,

h f (^ xk ,  ) = x ^ k + ( K1 + K2 + K 3 + K4 ) 6
where for a given time step,

(3.7)

h > 0,

we dene

tk+1 = tk + h,

and

K1 = G(tk , x ^k ,  ) h h K2 = G(tk + , x ^ k + K1 ,  ) 2 2 h h K3 = G(tk + , x ^ k + K2 ,  ) 2 2 K4 = G(tk + h, x ^k + hK3 ,  )
quaternion q ^4 does not have to be estimated since it can be directly computed from the quaternion 2 2 2 2 constraint q ^1 + q ^2 + q ^3 +q ^4 = 1. Generally, q ¯(t)  0 as t  , which implies q ^4  +1 or q ^4  -1. Because q4 = -1 is unstable equilibrium point, it is obtained that q4  +1 as t   [Jin & Sun 2008].
3 The
(3.8)

43

Chapter 3. Attitude Estimation and Control of Monolithic Spacecraft
and the function

G(^ x)

is given as

 G(^ x) =   ^
is estimated angular velocity vector,

-1 (- ^ × Jm  ^ Jm 1 A(q )^  2

+ )

 
(3.9)

Jm  R3×3  ^ ×  R3×3

is the positive-denite mass moment of is the skew-symmetric matrix.

inertia matrix of the lter model, and given as

A(q )

is

 A(q ) = 
where

q4 I3 + q ¯ -q ¯T

×

  yk
which is given by (3.10)

q ¯ is

obtained directly from the measurement model

yk = [¯ qk ] + [vqk ]
where

(3.11)

yk  R3 are the measurements, q ¯k q4

is the quaternion, and

vqk

is the zero-mean additive

noise. Please note that and

is computed from the quaternion constraint

2 2 2 2 = 1, + q4 + q3 + q2 q1

q ×  R3×3

denotes a skew-symmetric matrix,

3.2.4 Control law
For controlling a monolithic spacecraft without angular velocity measurements, the following asymptotic attitude control law was selected [Zou

et al. 2014]
(3.12)

-1 × ¯  = Jm -k2  + Jm  ^ J ^ - 2  q ~

where

 ^

is the estimated angular velocity vector,

Jm q ^.

is the moment of inertia matrix, where

k1 , q

k2 , 

and



are tunable control parameters,

= ^ - ^d,

 ^ d = -k1 q ¯,

and

q ~= q ^-1

is the quaternion error between

q

and the estimate

Note that the control law is applied

to the system dynamics using sample and hold approach.

44

3.3. Simulation Results and Discussion
3.3 Simulation Results and Discussion

The following section provides simulation results and discussion on fault-free and faultprone scenarios of a monolithic spacecraft. The forth-order Runge-Kutta method was

implemented to numerically integrate the system model and lter model with an integration time step

t = 0.01sec

and

t = 0.01sec

for a simulation time of

Tsim = 600sec.

The desired

attitude trajectory is considered as follows,

qd = [0, 0, 0, 1].
of the states are set as:

System parameters:
[-0.6, 0.4, -0.2]T , q4 (0) =
ment of inertia matrix is

The

initial

conditions

q ¯(0) =

1- q ¯(0)

2 , and

 (0) = [1, 1, 1]T ,

the spacecraft mass mo[Wong 2001], and the where

J = [20 1.2 0.9; 1.2 17 1.4; 0.9 1.4 15]kg · m2

external disturbances vector is given by

 = dk [sin(t), cos(t), sin(2t)]T ,

dk = 0.1.
Nm, for

Control parameters:

The saturation limit of the control law is

|i |  0.1

(i =

1, 2, 3), the control parameters  = 1, k1 = 0.05, k2 = 15,  = 2,  = 10, and the spacecraft
moment of inertia matrix is

Jm = [20 0 0 ; 0 17 0 ; 0 0 15] kg · m2 .  ^ (0) = [0, 0, 0]T , q ^1 (0) = -0.6,
2.
The lter moment of iner-

Filter parameters:
tia is

The initial conditions are: and

q ^2 (0) = 0.4, q ^3 (0) = -0.2, Q = 1 × 10-3 ,

q ^4 (0) =

1- q ¯(0)

Jm = [20 0 0 ; 0 17 0 ; 0 0 15] kg · m2 .

The standard deviation of process noise is

and the standard deviation of measurement noise is

R = 1 × 10-4 .

The

covariance matrix of process noise is given by matrix of measurement noise is given by

2 In×n , Q = E {wwT } = Q

and the covariance

2 Im×m . R = E {vv T } = R

Adaptive Unscented Kalman Filter :
where

The scaling parameter

 = (AU KF )2 × (n + ) - n,
The

AU KF = 0.1, AU KF = 2,  = 0, and n is the dimension of the augmented state. =
(c) /(n + ), W0

(m) lter weights are W0 (c) Wi = 1/2(n + ), for

i = 1, 2, . . . , n

(m) 2 = /(n + ) + (1 - AU = KF + AU KF ), and Wi (m) (c) where Wi and Wi are the weight associated with
Note: the parameter

the mean and covariance matrices accordingly.

AU KF

determines

the spread of the sigma points around the mean knowledge of the distribution of the state is usually set to

¯ , AU KF x

is used to incorporate prior

^ , and  is a secondary scaling parameter which x  = 1 × 103 .

0.

The fading factor in adaptive unscented Kalman lter is

45

Chapter 3. Attitude Estimation and Control of Monolithic Spacecraft
Particle Filter :
q (x
(i) (i) k | 0:k-1 ,
The number of particles

Np = 100,

the resampling threshold for Eec-

tive Sample Size (ESS),

P F = 0.5,
(i) (i) k | k-1 ).

and the importance density was selected such that

x

y1:k ) = p(x x

To avoid the degeneracy of the particle ler, a resam-

pling (selection) stage is introduced to multiply samples with high importance rations while eliminating samples with low importance. Several resampling schemes have been proposed in the literature including multinomial resampling, residual resampling, systematic resampling, etc. For details on resampling strategies please refer to [Arulampalam [Douc

et al. 2002],

et al. 2005],

[Hol

et al. 2007].
4

The resampling algorithm selected in this research is

the multinomial resampling . The multinomial resampling algorithm is presented in Table 3.1. The key idea behind multinomial resampling is to uniformly generate Each particle is replicated

Np

new

independent particles from the old particle set. each

Ni

times

i.e.

x(i) produces Ni children.

Table 3.1: Multinomial resampling algorithm [Chen 2003]

Multinomial resampling algorithm
1. (a) Produce a uniform distribution

u  U (0, 1).

(b) Construct a cumulative distribution function for the importance weights. (c) Calculate

si =

i j =1

~ (j ) . W
the particle with index

2. Find

si

such that

si-1  u < si ,

i

is chosen.

3. Given

x(i)

~ (i) }, for j = 1, . . . , Np , generate new samples x(j ) {x(i) , W ~ ( i) . according to the associate weight W W (i) = 1/Np .

by duplicating

4. Reset

common problem with particle lter is weight degeneracy, which consist of unbounded increase in variance of the importance weight of the particles over time. The growth of variance is controlled by resampling methods which allows to maintain particle diversity.

4A

46

3.3. Simulation Results and Discussion

3.3.1 Fault-free attitude estimation and control
The purpose of this investigation is to compare the performance of adaptive unscented Kalman lter and particle lter under fault-free scenario. an optimal operating condition for any given system. This scenario represents

Here, the control law, system

dynamics and sensors are fully functioning and no external disturbances are present during simulation,

i.e. k = 0.

Figure 3.1 shows the estimated angular velocity

(^ 1 ,  ^2,  ^3) (q1z , q2z , q3z

using adaptive unscented Kalman lter and particle lter. tual spacecraft attitude response and

Figure 3.2 shows the ac-

(q1 , q2 , q3

and

q4 ) ,

the observed attitude and

q4z )

and the estimated attitude response

(^ q1 , q ^2 , q ^3

q ^4 )

using the adaptive

unscented Kalman lter.

Figure 3.3 shows the actual spacecraft attitude response

(q1 , q2 , q3

and

q4 )

plotted against the observed attitude response

(q1z , q2z , q3z

and

q4z )

and the estimated attitude response

(^ q1 , q ^2 , q ^3

and

q ^4 )

using the particle lter.

Next,

the estimated attitude response and angular velocities are evaluated based on error criteria.

2
1
UKF

2
1
PF

1.5

2 3

UKF

1.5

2 3

PF

Estimated Angular Velocity

UKF

Estimated Angular Velocity

PF

1

1

0.5

0.5

0

0

-0.5 0 100 200 300 400 500 600

-0.5 0 100 200 300 400 500 600

Time (s)

Time (s)

(a) Estimated angular velocity using AUKF

(b) Estimated angular velocity using PF

Figure 3.1: Estimated angular velocities.

47

Chapter 3. Attitude Estimation and Control of Monolithic Spacecraft

0.8 0.6 0.4
q1 q1 q1

0.8
q2

0.6
z

q2 q2

z

AUKF

0.4

AUKF

Attitude response

Attitude response
0 100 200 300 400 500 600

0.2 0 -0.2 -0.4 -0.6 -0.8 -1

0.2 0 -0.2 -0.4 -0.6 -0.8 0 100 200 300 400 500 600

Time (s)

Time (s)

(a) Estimated attitude response: q ^1
1 0.8 0.6 0.4
q3 q3 q3
z

(b) Estimated attitude response: q ^2
1 0.8 0.6
q4 q4 q4
z

AUKF

AUKF

Attitude response

0.2 0 -0.2 -0.4 -0.6 -0.8 -1 0 100 200 300 400 500 600

Attitude response

0.4 0.2 0 -0.2 -0.4 -0.6 -0.8 0 100 200 300 400 500 600

Time (s)

Time (s)

(c) Estimated attitude response: q ^3

(d) Estimated attitude response: q ^4

Figure 3.2: Estimated attitude response using adaptive unscented Kalman lter.

48

3.3. Simulation Results and Discussion

0.8
q1

0.8
q2

0.6 0.4

q1 q1

0.6
z

q2 q2

z

PF

0.4

PF

Attitude response

0.2 0 -0.2 -0.4 -0.6 -0.8 0 100 200 300 400 500 600

Attitude response

0.2 0 -0.2 -0.4 -0.6 -0.8 0 100 200 300 400 500 600

Time (s)

Time (s)

(a) Estimated attitude response: q ^1
1 0.8 0.6 0.4
q3 q3 q3
z

(b) Estimated attitude response: q ^2
1 0.8 0.6
PF

q4 q4 q4
z

PF

Attitude response

0.2 0 -0.2 -0.4 -0.6 -0.8 -1 0 100 200 300 400 500 600

Attitude response

0.4 0.2 0 -0.2 -0.4 -0.6 -0.8 0 100 200 300 400 500 600

Time (s)

Time (s)

(c) Estimated attitude response: q ^3

(d) Estimated attitude response: q ^4

Figure 3.3: Estimated attitude response using particle lter.

49

Chapter 3. Attitude Estimation and Control of Monolithic Spacecraft Performance Evaluation:
The attitude and angular velocities of a monolithic spacecraft

under fault-free scenario were analyzed. The following discussion revolves around the errors generated between the state and estimated state in terms of quaternion error and angular velocity residuals. The errors are quantied with respect to the performance index root

mean squared error (RMSE). The quaternion error between the attitude response and estimate attitude response is calculated according to Equation (3.5), and the angular velocity residual is calculated based on the dierence between the state and estimated state, such that

 ~ i = (i -  ^i)

for

i = 1, 2, 3.

Figure 3.4 shows quaternion error and Figure 3.5 shows

the residual between the angular velocity and estimated angular velocity. Considering the expense of computation time, the quaternion error and angular velocity residual shows that under the same control command, noise level, and external disturbances, the particle lter performs better than the adaptive unscented Kalman lter. Figures 3.6 and 3.7 show the root mean squared error (RMSE) for the quaternion error and angular velocity residual. The gures show the initial estimation error decay as a function of time. It is apparent that root mean squared error is much smaller for particle lter estimation as compared to adaptive unscented Kalman lter estimation. The quaternion error initially ranges between 0.006 to 0.008 for particle lter estimation; however, quaternion error increases between 0.010 to 0.012 of initial error. The magnitude of angular velocity error is much smaller than quaternion error; however the same conclusion can be made. The estimation error of particle lter is much smaller than the estimation error of adaptive unscented Kalman lter. Consider the time

t

as the time to enter the error region dened by

  [ q ~, w ~]

where

-3 q ~ = ±1 × 10

and

-6 w ~ = ±50 × 10

rad/sec. Table 3.2 shows the time required for the

attitude response and angular velocity residual to converge within the dened error region; where

tAUKF

and

tPF

are the time it takes the AUKF and particle lter to converge

bellow the error regions, and

t = tAUKF - tPF .

The calculations shows the time when

the system state vector enters the error region for particle lter which are 28-percent faster than adaptive unscented Kalman lter. Therefore, estimating the angular velocity using particle lter results in a faster convergence rate compared to adaptive unscented Kalman lter.

50

3.3. Simulation Results and Discussion

0.5 0.45 0.4 0.06 0.35 0.3 0.04 0.02 0 150
q1 q1
PF

0.4
q2

0.35 0.3 0.25 0.04 0.03

PF

AUKF

q2

AUKF

q 1 Error

q 2 Error

0.02 0.2 0.15 0.1 0.01 0 150 200 250

0.25 0.2 0.15 0.1 0.05 0 0 100

200

250

0.05 0 200 300 400 500 600 0 100 200 300 400 500 600

Time (s)

Time (s)

(a) Quaternion error |q ~1 |
0.45 0.4 0.35 0.3
q3 q3
PF

(b) Quaternion error |q ~2 |
1.05
q4

1 0.95 0.9 1.002 1 0.998 0.996 150

PF

AUKF

q4

AUKF

0.04 0.03

q 3 Error

q 4 Error
200 250

0.25 0.2 0.15 0.1 0.05 0 0 100

0.02 0.01 0 150

0.85 0.8 0.75 0.7 0.65

200

250

200

300

400

500

600

0

100

200

300

400

500

600

Time (s)

Time (s)

(c) Quaternion error |q ~3 |

(d) Quaternion error |q ~4 |

Figure 3.4: Spacecraft attitude error.

51

Chapter 3. Attitude Estimation and Control of Monolithic Spacecraft

1 0.9 0.8 4 0.7
1 Residual
1 1
PF

1 0.9 0.8 0.01 0.7
2 Residual
2 2
PF

10-3

AUKF

AUKF

3 2 1 0 150 200 250

0.6 0.5 0.4 0.3 0.2 0.1 0 0 100

0.6 0.5 0.4 0.3 0.2 0.1 0

0.005

0 150

200

250

200

300

400

500

600

0

100

200

300

400

500

600

Time (s)

Time (s)

(a) Angular velocity residual: | ~1|
1 0.9 0.8 8 0.7
3 Residual

(b) Angular velocity residual: | ~2|

3 3

PF

10

-3

AUKF

6 4 2 0 150 200 250

0.6 0.5 0.4 0.3 0.2 0.1 0 0 100

200

300

400

500

600

Time (s)

(c) Angular velocity residual: | ~3|

Figure 3.5: Angular velocity residual.

52

3.3. Simulation Results and Discussion

0.15
q1 q1
PF

0.25
q2 q2
PF

AUKF

0.2

AUKF

Root mean squared error

0.1

0.03 0.02 0.01 0 150 200 250

Root mean squared error

0.04

0.04 0.03 0.15 0.02 0.01 0.1 0 150 200 250

0.05

0.05

0 0 100 200 300 400 500 600

0 0 100 200 300 400 500 600

Time (s)

Time (s)

(a) RMSE: q1
0.7
q3
PF

(b) RMSE: q2
0.7
q3
PF

0.6 0.06 0.5 0.04 0.4 0.02 0.3 0 150 0.2 200

q3

0.6
AUKF

q3

AUKF

Root mean squared error

Root mean squared error

0.06 0.5 0.04 0.4 0.02 0.3 0 150 0.2 200 250

250

0.1

0.1

0 0 100 200 300 400 500 600

0 0 100 200 300 400 500 600

Time (s)

Time (s)

(c) RMSE: q3

(d) RMSE: q4

Figure 3.6: Root mean squared error for attitude response.

53

Chapter 3. Attitude Estimation and Control of Monolithic Spacecraft

0.18 0.16 0.14 10-3
1 1
PF

0.35
2
PF

0.3
AUKF

2

AUKF

Root mean squared error

Root mean squared error

4 3 2 1

0.01 0.25

0.12 0.1 0.08 0.06 0.04 0.02 0 0 100

0.2

0.005

0.15 0 150 0.1 200 250

0 150

200

250

0.05

0 200 300 400 500 600 0 100 200 300 400 500 600

Time (s)

Time (s)

(a) RMSE: 1
0.12
3
PF

(b) RMSE: 2

0.1

3

Root mean squared error

8 0.08 6 4 0.06 2

10

-3

AUKF

0.04

0 150

200

250

0.02

0 0 100 200 300 400 500 600

Time (s)

(c) RMSE: 3

Figure 3.7: Root mean squared error for angular velocity.

54

3.3. Simulation Results and Discussion

Table 3.2: Time required to enter error region

tAUKF
459.7

(sec)

tPF

(sec)

t

(sec)

tAUKF -tPF tAUKF

× 100

326.9

132.8

28.8%

Based on the simulation results above, the PF provided better attitude estimations then AUKF since the samples of the AUKF are drawn in a specic and deterministic manner rather than at random as in the particle lter. The unscented transformation principle,

the core of AUKF, is a deterministic sampling technique that chooses a set of specic sample points around the mean. Since the number of samples is small it may not represent adequately complicated posteriori distributions which may include biases

i.e.

skewness and

kurtosis of distribution. The particle lter, however, relies on a probabilistic framework as a way to perform state estimation and deal with uncertainty over time. The continuous distributions of the particle lter are approximated by discrete random measures composed of weighted particles. The particles are samples of the unknown hidden states and the

weights are the probability masses estimated using the Bayesian recursion.

55

Chapter 3. Attitude Estimation and Control of Monolithic Spacecraft

3.3.2 Uncertainty in moment-of-inertia and external disturbances
Various fault and uncertainty cases are introduced with the purpose of varying the estimation sensitivity of AUKF and PF. The faults are introduced at the Spacecraft dynamics, control command, and sensor measurements. For simplicity, only residuals of

attitude response and angular velocity along with performance indices are presented.

Case I: Uncertainty in Moment of Inertia
In the following case, abrupt faults introduces uncertainty in moment-of-inertia (MOI) in the spacecraft principal axes. The changes in MOI are compensated by the control command which is driven by the estimated states

i.e.

attitude response and angular velocity.

The purpose is to estimate the attitude response and angular velocity of the spacecraft using the AUKF and PF lters and compare the estimation response of the lters. Two faults occur at the spacecraft during the simulation time. The rst fault occurs 100-seconds after the start of simulation and second fault occurs 300-seconds and remains until the end of the simulation at 600-seconds. Table 3.3 presents fault times and the corresponding MOI matrix. The MOI of the lter remains the same during the simulation. Table 3.3: Uncertainty in moment-of-inertia.

Time [sec]

Inertia matrix [kg

· m2 ]

0<t 100 < t 300 < t

100 300 600

J = [20 1.2 0.9; 1.2 17 1.4; 0.9 1.4 15] J = [10 0 0; 0 10 0; 0 0 5] J = [5 0 0; 0 5 0; 0 0 2.5]

Figure 3.8 shows the attitude response error

q ~i

for

i = 1, 2, 3, 4. qi i = 1, 2, 3.

The attitude response

expressed in terms of quaternion is calculated as Figure 3.9 shows the angular velocity residual residual is calculated as

-1 q ~i = q ^i

according to equation (3.5). The angular velocity

 ~i

for

 ~ i = (i -  ^ i ).

Figure 3.10 shows the root mean squared error

(RMSE) for the attitude response and Figure 3.11 shows the root mean squared error (RMSE) for the angular velocity.

56

3.3. Simulation Results and Discussion

0.5 0.45 0.4 0.15 0.35 0.3 0.1 0.05 0 80
q1 q1
PF

0.4
q2

0.35 0.3 0.25 0.08 0.06

PF

AUKF

q2

AUKF

q 1 Error

q 2 Error

0.04 0.2 0.15 0.1 0.02 0 80 100 120 140 160 180

0.25 0.2 0.15 0.1 0.05 0 0 100

100

120

140

160

180

0.05 0 200 300 400 500 600 0 100 200 300 400 500 600

Time (s)

Time (s)

(a) Attitude response: |q ~1 |
0.45 0.4 0.35 0.3
q3 q3
PF

(b) Attitude response: |q ~2 |
1.05
q4

1 0.95 0.9 1.005 1

PF

AUKF

q4

AUKF

0.08 0.06

q 3 Error

q 4 Error

0.25 0.2 0.15 0.1 0.05 0 0 100

0.04 0.02 0 80 100 120 140 160 180

0.995 0.85 0.8 0.75 0.7 0.65 0.99 0.985 80 100 120 140 160 180

200

300

400

500

600

0

100

200

300

400

500

600

Time (s)

Time (s)

(c) Attitude response: |q ~3 |

(d) Attitude response: |q ~4 |

Figure 3.8: Attitude response error under uncertainty in moment-of-inertia.

57

Chapter 3. Attitude Estimation and Control of Monolithic Spacecraft

1 0.9 0.8 0.04 0.7
1 Residual
1 1
PF

1 0.9 0.8 0.04 0.7
2 Residual
2 2
PF

AUKF

AUKF

0.03 0.02 0.01 0 80 100 120 140 160 180

0.03 0.02 0.01 0 80 100 120 140 160 180

0.6 0.5 0.4 0.3 0.2 0.1 0 0 100

0.6 0.5 0.4 0.3 0.2 0.1 0

200

300

400

500

600

0

100

200

300

400

500

600

Time (s)

Time (s)

(a) Angular velocity residual: |w ~1 |
1 0.9 0.8 0.03 0.7 0.02
3 Residual

(b) Angular velocity residual: |w ~2 |

3 3

PF

AUKF

0.6 0.5 0.4 0.3 0.2 0.1 0 0 100 200 300 400 500 600 0.01 0 80

100

120

140

160

180

Time (s)

(c) Angular velocity residual: |w ~3 |

Figure 3.9: Angular velocity residual under uncertainty in moment-of-inertia.

58

3.3. Simulation Results and Discussion

0.15
q1 q1
PF

0.25
q2 q2
PF

AUKF

0.2

AUKF

Root mean squared error

0.1

0.06 0.04 0.02 0 80 100 120 140 160 180

Root mean squared error

0.08

0.1

0.15

0.05

0.1

0.05

0 80

100

120

140

160

180

0.05

0 0 100 200 300 400 500 600

0 0 100 200 300 400 500 600

Time (s)

Time (s)

(a) RMSE: q ~1
0.7
q3
PF

(b) RMSE: q ~2
0.5 0.45 0.4
q4 q4
PF

0.6 0.15 0.5 0.1 0.4 0.05 0.3 0 80 0.2 100 120 140 160

q3

AUKF

AUKF

Root mean squared error

Root mean squared error

0.1 0.35 0.3 0.25 0.2 0.15 0.1 0 80 0.05

180

100

120

140

160

180

0.1 0.05 0 0 100 200 300 400 500 600 0 0 100 200 300 400 500 600

Time (s)

Time (s)

(c) RMSE: q ~3

(d) RMSE: q ~4

Figure 3.10: Root mean squared error of attitude response under uncertainty in momentof-inertia.

59

Chapter 3. Attitude Estimation and Control of Monolithic Spacecraft

0.16
1

0.35
PF

2

0.14
1

PF

0.3
AUKF

2

AUKF

Root mean squared error

Root mean squared error

0.12 0.1

0.04 0.03 0.02

0.04 0.25 0.03 0.2 0.02 0.01 0.15 0 80 0.1 100 120 140 160 180

0.08 0.06 0.04 0.02 0 0 100

0.01 0 80 100 120 140 160 180

0.05

0 200 300 400 500 600 0 100 200 300 400 500 600

Time (s)

Time (s)

(a) RMSE: w ~1
0.1 0.09 0.08
3 3
PF

(b) RMSE: w ~2

AUKF

Root mean squared error

0.03 0.07 0.06 0.05 0.04 0.03 0.02 0.01 0 0 100 200 300 400 500 600 0.02 0.01 0 80

100

120

140

160

180

Time (s)

(c) RMSE: w ~3

Figure 3.11: Root mean squared error of angular velocity under uncertainty in moment-ofinertia.

60

3.3. Simulation Results and Discussion Case II: External disturbances
In the following case, the spacecraft experiences an external disturbance and the fault occurred at the Spacecraft dynamics. Two external disturbances are introduced during the simulation time. therefore, At the start if the simulation there is no external disturbance present; The rst disturbance occurs 100-seconds after the beginning of simulation

 = 0.

when an external force equivalent to

 = [sin(t); cos(t); sin(2t)] t =450-second

is applied for a duration when a random external

of 350-seconds. The second disturbance occurs at

disturbance acts on each one of the principal axes of the spacecraft. Table 3.4 presents the fault time and the corresponding external disturbance.

Table 3.4: External disturbances.

Time [sec]

External disturbances

0 < t <= 100 100 < t <= 450 450 < t <= 600

 = dk [sin(t); cos(t); sin(2t)]  = dk [sin(t); cos(t); sin(2t)]

where where

dk = 0 dk = 1
where

 = dk × [Random; Random; Random]

dk = 0.1

Figure 3.12 shows the attitude response error given the applied external disturbance. Figure 3.13 shows the angular velocity residual. The plots show that for a given external

disturbance, the particle lter tend to estimate the spacecraft states faster then the adaptive unscented Kalman lter. In addition, the magnitude of error for the particle is smaller then the adaptive unscented Kalman lter.

61

Chapter 3. Attitude Estimation and Control of Monolithic Spacecraft

0.5 0.45 0.4 0.15 0.35 0.3 0.1 0.05 0 80
q1 q1
PF

0.4
q2

0.35 0.3 0.25 0.1

PF

AUKF

q2

AUKF

q 1 Error

q 2 Error

0.05 0.2 0.15 0.1 0 80

0.25 0.2 0.15 0.1 0.05 0 0 100

100

120

140

160

180

100

120

140

160

180

0.05 0 200 300 400 500 600 0 100 200 300 400 500 600

Time (s)

Time (s)

(a) Attitude response: |q ~1 |
0.45 0.4 0.35 0.3
q3 q3
PF

(b) Attitude response: |q ~2 |
1.05
q4

1 0.95 0.9 1.005 1

PF

AUKF

q4

AUKF

0.08 0.06

q 3 Error

q 4 Error

0.25 0.2 0.15 0.1 0.05 0 0 100

0.04 0.02 0 80 100 120 140 160 180

0.995 0.85 0.8 0.75 0.7 0.65 0.99 0.985 80 100 120 140 160 180

200

300

400

500

600

0

100

200

300

400

500

600

Time (s)

Time (s)

(c) Attitude response: |q ~3 |

(d) Attitude response: |q ~4 |

Figure 3.12: Attitude response error under external disturbances.

62

3.3. Simulation Results and Discussion

1 0.9 0.8 0.02 0.7
1 Residual
1 1
PF

1 0.9 0.8 0.04 0.7
2 Residual
2 2
PF

AUKF

AUKF

0.015 0.01 0.005 0 80 100 120 140 160 180

0.03 0.02 0.01 0 80 100 120 140 160 180

0.6 0.5 0.4 0.3 0.2 0.1 0 0 100

0.6 0.5 0.4 0.3 0.2 0.1 0

200

300

400

500

600

0

100

200

300

400

500

600

Time (s)

Time (s)

(a) Angular velocity residual: | ~1|
1 0.9 0.8 0.03 0.7 0.02
3 Residual

(b) Angular velocity residual: | ~2|

3 3

PF

AUKF

0.6 0.5 0.4 0.3 0.2 0.1 0 0 100 200 300 400 500 600 0.01 0 80

100

120

140

160

180

Time (s)

(c) Angular velocity residual: | ~3|

Figure 3.13: Angular velocity residual under external disturbances.

63

Chapter 3. Attitude Estimation and Control of Monolithic Spacecraft

3.3.3 Control command faults
At this section, faults are introduced in the control command with the purpose of verifying the capacity of the lters to estimate the states. Two cases are investigated: (1) constant applied control commands are applied at dierent intervals during the simulations, and (2) no torque during stabilization.

Case I: Constant applied control command
In the following case, the spacecraft experience a fault where the control law sends out dierent torque magnitudes to each one of the principal axes. The rst fault occurs 100 seconds after the beginning of simulation when the controller send out a constant control command with magnitude of seconds, up until

1 = 0.050, 2 = 0.025,

and

3 = 0.075.

This fault last for 150 while

t = 250

sec, when the control command

1 = 0.050, 2 = 0.025
while

3

is

recovered and behaves as the desired control law ( continuous for 100 seconds, up until

i.e.,

as per Equation (3.12)). This fault

t = 350

sec, when

1 = 0.050,

1

and

2

change

as per desired control law. Finally, at

t = 500

sec, the control command is fully recovered Table 3.5 presents the fault

and send out a desired control law as per Equation (3.12). time and its corresponding applied control commands.

Table 3.5: Constant applied torque.

Time [sec]

Control command [Nm]

0 < t <= 100 100 < t <= 250 250 < t <= 350 350 < t <= 500 500 < t < 600

-1 × ¯  = Jm [-k2  2 -1 + Jm  ^ Jm  ^ - 2 2 sig1 (q ~)]

1 = 0.050, 2 = 0.025, 3 = 0.075
-1 × ¯ 1 = 0.050, 2 = 0.025, 3 = Jm [-k2  2 -1 + Jm  ^ Jm  ^ - 2 2 sig1 (q ~)] -1 × ¯)] 1 = 0.050, 2 = 3 = Jm [-k2  2 -1 + Jm  ^ Jm  ^ - 2 2 sig1 (q ~ -1 × ¯  = Jm [-k2  2 -1 + Jm  ^ Jm  ^ - 2 2 sig1 (q ~)]

Figure 3.14 shows the attitude response error and Figure 3.15 shows the angular velocity residual.

64

3.3. Simulation Results and Discussion

0.5 0.45 0.4 0.15 0.35 0.3 0.1 0.05 0 80
q1 q1
PF

0.4
q2

0.35 0.3 0.25 0.08 0.06

PF

AUKF

q2

AUKF

q 1 Error

q 2 Error

0.04 0.2 0.15 0.1 0.02 0 80 100 120 140 160 180

0.25 0.2 0.15 0.1 0.05 0 0 100

100

120

140

160

180

0.05 0 200 300 400 500 600 0 100 200 300 400 500 600

Time (s)

Time (s)

(a) Attitude response: |q ~1 |
0.45 0.4 0.35 0.3
q3 q3
PF

(b) Attitude response: |q ~2 |
1.05
q4

1 0.95 0.9 1.005 1

PF

AUKF

q4

AUKF

0.08 0.06

q 3 Error

q 4 Error

0.25 0.2 0.15 0.1 0.05 0 0 100

0.04 0.02 0 80 100 120 140 160 180

0.995 0.85 0.8 0.75 0.7 0.65 0.99 0.985 80 100 120 140 160 180

200

300

400

500

600

0

100

200

300

400

500

600

Time (s)

Time (s)

(c) Attitude response: |q ~3 |

(d) Attitude response: |q ~4 |

Figure 3.14: Attitude response error under constant applied control commands.

65

Chapter 3. Attitude Estimation and Control of Monolithic Spacecraft

1 0.9 0.8 0.02 0.7
1 Residual
1 1
PF

1 0.9 0.8 0.04 0.7
2 Residual
2 2
PF

AUKF

AUKF

0.015 0.01 0.005 0 80 100 120 140 160 180

0.03 0.02 0.01 0 80 100 120 140 160 180

0.6 0.5 0.4 0.3 0.2 0.1 0 0 100

0.6 0.5 0.4 0.3 0.2 0.1 0

200

300

400

500

600

0

100

200

300

400

500

600

Time (s)

Time (s)

(a) Angular velocity residual: | ~1|
1 0.9 0.8 0.03 0.7 0.02
3 Residual

(b) Angular velocity residual: | ~2|

3 3

PF

AUKF

0.6 0.5 0.4 0.3 0.2 0.1 0 0 100 200 300 400 500 600 0.01 0 80

100

120

140

160

180

Time (s)

(c) Angular velocity residual: | ~3|

Figure 3.15: Angular velocity residual under constant applied control commands.

66

3.3. Simulation Results and Discussion Case II: No control command during stabilization
In the following case, the control command is failed at

t = 50 seconds and at t =350 seconds

the control command is recovered. During the fault, the adaptive unscented Kalman lter is estimating the attitude response and the angular velocity of the spacecraft dynamics which experience an external disturbances of conditions for the states are set as:

 = 0.1[sin(t), cos(t), sin(2t)]T .

The initial

q ¯(0) = [-0.6, 0.4, -0.2]T , q4 (0) =

1- q ¯(0)

2 , and

 (0) = [0, 0, 0]T .
torque.

Table 3.6 presents the fault time and its corresponding applied control

Table 3.6: No control command during stabilization.

Time [sec]

Control command

0 < t <= 50 50 < t <= 350 350 < t < 600

-1 × ¯  ^ Jm  ^ - 2 2 sig1 (q ~)]  = Jm [-k2  2 -1 + Jm

 =0
-1 × ¯  ^ Jm  ^ - 2 2 sig1 (q ~)]  = Jm [-k2  2 -1 + Jm

Figure 3.16 shows the attitude response error and Figure 3.17 shows the angular velocity residual.

3.3.4 Sensor faults
Sensors design requires a crucial consideration to satisfy a specic mission on a spacecraft. For given spacecraft applications, the sensor must provide an acceptable physical characteristics, meet performance specications, and cope with interface sources and environmental conditions. The sensors are part of a larger system that is capable of processing and acting upon the information the sensor provide. This information is transmitted as a feedback

signal to the rest of the system in a standardized manner. The purpose of this section is limited to estimation of attitude response and angular velocity of a spacecraft using the particle lter and adaptive unscented Kalman lter under the eect of sensor faults.

67

Chapter 3. Attitude Estimation and Control of Monolithic Spacecraft

0.5 0.45 0.4 0.15 0.35 0.3 0.1 0.05 0 80
q1 q1
PF

0.4
q2

0.35 0.3 0.25 0.15 0.1 0.05 0 80

PF

AUKF

q2

AUKF

q 1 Error

q 2 Error
100 120 140 160 180

0.25 0.2 0.15

0.2 0.15 0.1

100

120

140

160

180

0.1 0.05 0 0 100 200 300 400 500 600 0.05 0 0 100 200 300 400 500 600

Time (s)

Time (s)

(a) Attitude response: |q ~1 |
0.45 0.4 0.35 0.3 0.9
q3 q3
PF

(b) Attitude response: |q ~2 |
1.05
q4

1 0.95 1.01 1 0.99 0.98 80

PF

AUKF

q4

AUKF

0.1

q 3 Error

q 4 Error
100 120 140 160 180

0.25 0.2 0.15 0.1 0.05 0 0 100

0.05

0.85 0.8 0.75 0.7 0.65

0 80

100

120

140

160

180

200

300

400

500

600

0

100

200

300

400

500

600

Time (s)

Time (s)

(c) Attitude response: |q ~3 |

(d) Attitude response: |q ~4 |

Figure 3.16: Attitude response error when no control command is applied during stabilization.

68

3.3. Simulation Results and Discussion

1 0.9 0.8 0.03 0.7 0.02
1 Residual 2 Residual
1 1
PF

1 0.9 0.8 0.06 0.7 0.04 0.6 0.5 0.4 100 120 140 160 180 0.3 0.2 0.1 0 0 100 200 300 400 500 600 0 100 200 300 400 500 600 0.02 0 80
2 2
PF

AUKF

AUKF

0.6 0.5 0.4 0.3 0.2 0.1 0 0.01 0 80

100

120

140

160

180

Time (s)

Time (s)

(a) Angular velocity residual: | ~1|
1 0.9 0.8 0.06 0.7 0.04
3 Residual

(b) Angular velocity residual: | ~2|

3 3

PF

AUKF

0.6 0.5 0.4 0.3 0.2 0.1 0 0 100 200 300 400 500 600 0.02 0 80

100

120

140

160

180

Time (s)

(c) Angular velocity residual: | ~3|

Figure 3.17: Angular velocity residual when no control command is applied during stabilization.

69

Chapter 3. Attitude Estimation and Control of Monolithic Spacecraft Case I: Heterogeneous measurements
In the following scenario, the sensor experience various faults resulting in random measurement levels during the simulation. Various sensor measurements deteriorate the capacity to accurately estimate the attitude response and angular velocity of the spacecraft. For

simulation purposes, the sensor sensitivity is altered multiple times to include random noise uctuations with the scope of testing the capacity of PF and AUKF to estimate the spacecraft states. Initially, a normal operating conditions for sensor error is assumed in the state measurements; however, at

t =100

seconds the noise in the measurements is

changing at three intervals during the simulation. Table 3.7 presents the faults time and its corresponding noise sensitivity.

Table 3.7: Random noise levels.

Time [sec]

Noise level

0 < t <= 100 100 < t <= 300 300 < t <= 500 500 < t < 600

Error = 0.05, Error = 2, Error = 0.001, Error = 10,

µ = 0, µ = 0, µ = 0, µ = 0,

 = 1 × 10-3  = 1 × 10-6  = 1 × 10-5  = 1 × 10-3

Figure 3.18 shows the attitude response error and Figure 3.19 shows the angular velocity residual of the spacecraft. The plots show that for a large measurement noise, the estimation error of the particle lter is smaller than the estimation error of the adaptive unscented Kalman lter; however, when the measurement noise level is small the estimation error of the adaptive unscented Kalman lter is smaller than the particle lter. This implies that, AUKF is capable of estimating the states better than PF for small measurement noise levels; whereas, the PF is capable of estimating the states better than AUKF for large noise measurements. The following conclusion is valid since the AUKF assign a predetermined constant weight to the distribution of the sigma points. When the measurement noise is small the constant weight assumption is valid and sucient to estimate the state. However, when the measurement noise is large, the constant weight assumption is valid only to a certain extent, but not completely, since the sigma points have a larger covariance matrix

70

3.3. Simulation Results and Discussion
resulting in a larger distribution of the sigma points. For a large measurement noise levels, the particle lter estimates the states more accurately than the AUKF for several reasons: First, the number of particles that estimates the distribution in PF is larger than the number of sigma points that estimates the distribution in the AUKF. Second, the weights assigned to the particles in the PF are assigned based on probability where a large weight implies higher estimate probability and a small weight imply less probability. The particles with less probability are vanished during the resembling stage while particles with large probabilities are replicated. The weight calculations in the PF diers from the AUKF since in the later the weights are constant throughout the simulation while in the PF the weight changes with probability. Third, a major assumption of the AUKF is that the sigma points are normally distributed whereas in the particle lter there is no assumption of particle distribution. The particle lter estimates the state distribution for any distribution even in the presence of kurtosis and skewness.

71

Chapter 3. Attitude Estimation and Control of Monolithic Spacecraft
0.25
q1 q1
PF

0.16
q2

0.14 0.12 0.1 0.08 0.06

PF

0.2 0.15 0.1 0.05 0.1 0 80

AUKF

q2

AUKF

0.15

q 1 Error

q 2 Error

0.04 0.08 0.06 0.04 0.02 0 80 100 120 140 160 180

100

120

140

160

180

0.05 0.02 0 0 100 200 300 400 500 600 0 0 100 200 300 400 500 600

Time (s)

Time (s)

(a) Attitude response: |q ~1 |
0.2 0.18 0.16 0.08 0.14 0.06 0.12 0.96 0.04 0.02 0 80 100 120 140 160 180
q3 q3
PF

(b) Attitude response: |q ~2 |
1.02 1 0.98 1.005 1 0.995 0.99 0.92 0.985 80 0.9 100 120 140 160
q4

AUKF

q 3 Error

q 4 Error

0.1 0.08 0.06 0.04 0.02 0 0 100

0.94

180

0.88 0.86 200 300 400 500 600 0 100 200 300 400 500

PF

q4

AUKF

600

Time (s)

Time (s)

(c) Attitude response: |q ~3 |

(d) Attitude response: |q ~4 |

Figure 3.18: Attitude response error under sensor fault.

72

3.3. Simulation Results and Discussion
1 0.9 0.8 0.02 0.7
1 Residual
1 1
PF

1 0.9 0.8 0.04 0.7
2 Residual
2 2
PF

AUKF

AUKF

0.015 0.01 0.005 0 80 100 120 140 160 180

0.03 0.02 0.01 0 80 100 120 140 160 180

0.6 0.5 0.4 0.3 0.2 0.1 0 0 100

0.6 0.5 0.4 0.3 0.2 0.1 0

200

300

400

500

600

0

100

200

300

400

500

600

Time (s)

Time (s)

(a) Angular velocity residual: | ~1|
1 0.9 0.8 0.03 0.7 0.02
3 Residual

(b) Angular velocity residual: | ~2|

3 3

PF

AUKF

0.6 0.5 0.4 0.3 0.2 0.1 0 0 100 200 300 400 500 600 0.01 0 80

100

120

140

160

180

Time (s)

(c) Angular velocity residual: | ~3|

Figure 3.19: Angular velocity residual under sensor fault.

73

Chapter 3. Attitude Estimation and Control of Monolithic Spacecraft
3.4 Conclusions

In this chapter, attitude estimation of monolithic spacecraft have be investigated in sequential setting under the presence of faults and unknown angular velocity measurements, where the attitude was represented by quaternion. The demand for online estimation and control requires a sequential update of attitude and angular velocity when a new measurements become available. Here, the attitude and the unknown angular velocity were estimated sequentially with adaptive unscented Kalman lter and particle lter. The successful design of the online particle lter for attitude estimation require to sample from a target distribution. Here, multinomial resampling algorithm was implemented for sequential state estimation. Since, the estimation process is done online, time-delay was introduced in the estimation algorithm to incorporate the estimation time between sequential measurements. Simulation results showed that PF provides better attitude estimations in comparison to AUKF since the samples of AUKF are drawn in a specic and deterministic manner rather than at random as in particle lter. The unscented transformation principle, the core of AUKF, is a deterministic sampling technique that chooses a set of specic sample points around the mean. Since the number of samples is small it may not represent adequately complicated posterior distributions which may include bias i.e. skewness, kurtosis or measurement outliers. The particle lter, however, relies on a probabilistic framework as a way to perform attitude estimation and deal with uncertainty over time. The posterior distribution of particle lter is approximated by discrete random measures composed of weighted particles. The particles are samples of the unknown hidden attitude and the weights are probability masses estimated using Bayesian recursions. In ordinary particle ltering, the larger the number of particles the more accurate the posterior distribution is. Therefore, the key requirement for particle ltering is to maintain suciently relatively large number of particles in order to adequately represent the posterior distribution. This number grows exponentially with the state vector dimensions. Low number of particles may cause degradation of the particles set and, consequently, might lead to divergence of the state estimate. In conclusion, considering the expense of computation time, the quaternion error under the same control input, noise level, external disturbance, etc. the particle lter estimated the attitude states better than adaptive unscented Kalman lter.

74

Chapter 4

Distributed Attitude Estimation and Control of Spacecraft Formation Flying

In this chapter, an ecient and accurate distributed nonlinear ltering techniques are proposed to estimate the unmeasurable angular velocity and reference angular acceleration of Spacecraft Formation Flying (SFF). The spacecraft formation is comprised of

N

space-

craft and a virtual leader which exchange partial information with other spacecraft in the formation. Each spacecraft runs its own lter to accurately approximate the posterior

distribution of the unmeasurable angular velocity while a distributed lter is incorporated to obtain a reference angular acceleration estimates of the virtual leader. The attitude is represented by modied Rodrigues parameters (MRP). Two nonlinear ltering techniques are investigated herein, the adaptive unscented Kalman lter (AUKF) and particle lter (PF). The AUKF and PF in parallel with a distributed lter and an asymptotic output feedback control law are utilized to simultaneously track a common time-varying reference attitude while the reference attitude is available only to a subset of the spacecraft in the formation. The aim is to motivate the application of particle ltering technique for distributed estimation of spacecraft formation ying. Simulation results show state estimation in spacecraft formation tracking in fault-free and fault-prone scenarios under presence of faults and uncertainty at the spacecraft dynamic models, control laws, and measurement models. The faults are unknown the lters and the control laws. The performance comparison between AUKF and PF is illustrated with numerical simulation through calculations of formation-keeping error and station-keeping error.

75

Chapter 4. Distributed Attitude Estimation and Control of Spacecraft Formation Flying
4.1 Introduction

Spacecraft Formation Flying (SFF) is an active research topic that deals with maintaining the state of formation between spacecraft. A growing number of space missions have

been identied as suitable to utilize SFF technology; where, the idea is to distribute the functionality of large spacecraft among smaller, less expensive cooperative spacecraft. Estimating the state of formation becomes a serious challenge in the presence of system faults and external disturbances

1

which causes a drift in both position and formation center

of the spacecraft. The issue with attitude estimation of spacecraft in formation ying gave rise to a great level of interest in both scientic and defense communities to develop systems for precise state estimation of spacecraft formation ying and autonomous rendezvous.

Modern guidance and navigation systems today rely on some form of nonlinear ltering algorithm based on probabilistic inference to compute the state estimate of the spacecraft. The nonlinear lter estimates the system dynamics by ltering out noisy measurements based on a two step iterative process of prediction and correction. The errors in the

dynamic process and measurement model are assumed to have a deterministic model and covariance model (

i.e.,

zero-mean Gaussian process) and some form of an optimality

conditions which minimizes the error covariance between estimated state and system state.

In the scientic literature, SFF and information sharing among spacecraft take on several dierent formation estimation architectures (FEA). These include centralized, distributed, and decentralized architectures [Kang 1.

et al. 2001]:
include a single formation-wide master lter that

Centralized estimation architecture

collect sensor measurements, control inputs, and spacecraft conguration in order to estimate the formation states. This is the simplest estimation architecture where all the necessary estimations occurs at a common processing station. Resource allocation is easy because the master lter is fully aware of the activities of each spacecraft and has an overall view of the entire formation. Centralized estimation architecture has

disturbance may result from gravitational perturbation, atmospheric drag, solar radiation pressure, electromagnetic forces, and/or Earth oblateness (dierential J2 ).

1 External

76

4.1. Introduction
a number of disadvantages: (1) erroneous readings from a single spacecraft have a drastic eect on the entire formation since state information cannot be obtained from other spacecraft in the formation, (2) severe computation loads imposed in the master lter resulting from global computation of state estimation and control as opposed to local computation at each spacecraft node, and (3) high communication overhead resulting from the demand of the master lter to have a complete state information of all spacecraft in the formation.

2.

Distributed estimation architecture

include an hierarchy of lters where each space-

craft runs its own local lter which provide estimates to the master lter then combines to local state estimation into formation state estimation. The principle of

distributed estimation is to reduce computation loads of centralized estimation by distributing the spacecraft in formation ying among the hierarchy of local lters. This architecture has the advantage of distributing the computation loads among local spacecraft; however, it retain the disadvantages pertaining to centralized architectures.

3.

Decentralized estimation architecture

is non-hierarchical and eliminate the need for Each spacecraft in a decentralized network

coordination by a central supervisor.

processes only its own measurements data in parallel with the other spacecraft. Although, the total computational burden over the entire formation is greater than it would be for a monolithic spacecraft. Requirements for data transmission between spacecraft are minimized, at the cost of locally maintaining an additional data vector.

In this research, we focus on developing distributed nonlinear lters for state estimation in the presence of an unmeasurable states for a spacecraft in formation ying.

77

Chapter 4. Distributed Attitude Estimation and Control of Spacecraft Formation Flying

4.1.1 Literature review
Several estimation algorithms have been proposed to estimate the state of spacecraft formation ying (SFF); these include Kalman lter (KF), extended Kalman lter (EKF), unscented Kalman lter (UKF), and particle lters. The EKF found the largest number of applications in SFF domain. Carpenter [Carpenter 2002] proposed a decentralized

architecture for autonomous establishment and maintenance of spacecraft formations using the EKF approach. In the reported work, local control has been achieved by processing local measurement information and transmission vectors from the other nodes. al. [Kim Kim et

et al. 2007]

formulated an EKF to estimate the relative attitude and position of

two spacecraft using line-of-sight (LOS) measurements coupled with gyro measurements from each spacecraft to determine relative attitude, position and gyro biases. The attitude kinematics were described by the quaternion while general relative orbital equations were used to describe the position. Nebelecky et al. [Nebelecky

et al. 2009]

achieved

a decentralized attitude estimation between three spacecraft through the use of a local EKF and data fusion process known as the Covariance Intersection algorithm. The EKF has been proposed for relative position and attitude estimation for spacecraft formation [Xing

et al. 2010].

In this reported work, a position sensitive diode (PSD) sensor has

been used to provide multiple line-of-sight (LOS) vectors from a feature point to beacons xed on the leader spacecraft. The LOS measurements were coupled with spacecraft

dynamics model and EKF to estimate relative attitude of the deputy and relative position of the feature point. Chen et al. [Chen

et al. 2010]

integrated measurements from

Global Position System (GPS) and Vision based Navigation (VISNAV) to form a relative navigation and attitude determination system for ultra-close spacecraft formation ying. Federal Kalman Filter (FKF) architecture was adopted for the relative navigation and attitude determination states estimation and optimal fusion of GPS/VISNAV subsystem.

Implementing the extended Kalman lter may result in large errors in the true posterior mean and covariance of the transformed random variables since the estimation is based on linearization of the system dynamics, which results in a suboptimal application of the recursive estimation of the standard Kalman Filter. Given the limitation of the extended

78

4.1. Introduction
Kalman lter in estimating the state of Spacecraft Formation Flying, an alternative ltering approach has been developed based on unscented transformation principles. The UKF has been proposed for relative spacecraft attitude and position estimation [Zhang

et al. 2015].

In the reposted work, Zhang assumed a full state feedback in estimating the spacecraft attitude and position and implemented the Generalized Rodrigues Parameters (GRP) to maintain the quaternion normalization constraint. The performance of the UKF depends on the accuracy of the system model and on prior statistical knowledge of the process and measurement noise. Since, the UKF cannot adapt itself to deal with the uncertainty model errors and since the statistical characteristics of the noises are dicult to obtain, other alternatives have been proposed for estimating the state of Spacecraft Formation Flying. One of the approaches is the particle ltering. The UKF resembles the particle lter algorithm but with a major and extremely important dierence. The samples are

drawn in a specic and deterministic manner rather than at random as in the particle lter. All the research paper above have considered a full state feedback and none of the research paper above have considered the development of a distributed adaptive unscented Kalman lter and distributed particle lter to estimate the unmeasurable angular velocity of spacecraft in formation ying.

79

Chapter 4. Distributed Attitude Estimation and Control of Spacecraft Formation Flying

4.1.2 Objectives
Several nonlinear ltering techniques and control algorithms have been proposed to track a time-varying reference trajectory under the availability of full state measurements. However, in the open literature there has not been much emphasis placed on distributed estimation under the assumption of partial information exchange between spacecraft while some of the attitude states are unmeasurable. The main contributions of this study are as follows:

1.

Estimation of unmeasurable angular velocities for SFF: An accurate nonlinear
ltering techniques for spacecraft formation ying are investigated to estimate the unmeasurable angular velocity of a spacecraft which tracks a common-time varying reference attitude. Two nonlinear ltering techniques are investigated herein, the

adaptive unscented Kalman lter (AUKF) and particle lter (PF). Six spacecraft are involved in the formation including one virtual leader and only measurements of spacecraft attitude are available for use where the attitude of is represented by modied Rodrigues parameters (MRP).

2.

Estimation of reference angular acceleration of a virtual leader in SFF: A
distributed lter is developed for estimating the reference angular acceleration of a virtual leader in spacecraft formation ying. The lter is developed such that the

attitude estimations of all spacecraft in the formation can track time-varying reference trajectory even in the absence of angular velocity measurements. Distributed lter is required since the virtual leader exchange only partial information with other spacecraft in formation. Here, we consider the case when the common time-varying reference attitude is available only to a subset of the spacecraft in formation.

3.

Performance evaluation:
measurement models.

Performance evaluation and comparison between AUKF

and PF for online estimation under faults in the dynamic models, control laws, and The performance comparison is illustrated with numerical

simulation through calculations of formation-keeping error and station-keeping error.

80

4.2. System Model, Filter Model, and Control Law
4.2 System Model, Filter Model, and Control Law

In this section, dynamic equations, kinematic equations, lter models, and control laws are constructed for spacecraft formation ying. Distributed ltering algorithms are

investigated for a group of spacecraft in formation where only measurements of spacecraft attitude are available and the virtual leader exchanges state information with a subset of the group members. Filters are constructed such that all spacecraft in formation can simultaneously track a time varying reference attitude. Figure 5.1 shows the communication graph for spacecraft formation.

Spacecraft 1

Spacecraft 2

Spacecraft 3

Virtual leader

Spacecraft 6

Spacecraft 5

Spacecraft 4

Figure 4.1: Communication graph for spacecraft formation

81

Chapter 4. Distributed Attitude Estimation and Control of Spacecraft Formation Flying

4.2.1 Dynamic equations
For a group of

n

spacecraft, the individual spacecraft is modeled as a rigid body with the

following dynamic equation for the

ith (i = 1, 2, · · · , n)
× Ji   i = -i Ji i + i

spacecraft [Hughes 1986] (4.1)

where

Ji  R3×3

is the mass moment-of-inertia matrix,

i  R 3

is the torque control,

i  R3

is the angular velocity of the

ith 

spacecraft in a body-xed frame, and

x×  R3×3

denotes the skew-symmetric matrix given by

0

-x3 0 x1

x2


(4.2)

 x× =   x3 - x2

 -x1   0

4.2.2 Kinematic equations
For a group of

n

spacecraft, the kinematic equation of the

ith (i = 1, 2, · · · , n)

spacecraft

in formation is given by [Hughes 1986]

q i = Ti (qi )i
where

(4.3)

i  R3

is the angular velocity of the

ith

spacecraft in a body-xed frame,

qi (t) 

R3

represents the Modied Rodriguez Parameters (MRPs) which describe the spacecraft

attitude with respect to an inertial frame [Shuster 1993]

qi (t) =
where

i (t) tan

i (t) 4

,

i  [0, 2 )rad
The matrix

(4.4)

i and

i denote the Euler eigenaxis and eigenangle, respectively.
T 1 1 - qi qi × T I3 + qi + qi q i . 2 2

Ti (qi ) 

R3×3

for MRPs is given by [Hughes 1986]

Ti (qi ) =

(4.5)

The spacecraft models in Equations (4.1) and (4.3) can be transformed as follows [Zou 2014]

q i = vi
v i For

(4.6a) (4.6b)

= fi (qi , vi ) + gi (qi )i

i = 1, 2, · · · , n,
and

where the function

i q fi (qi , vi ) = -Ti P i - Ti Ji-1 (Pi q i )× Ji Pi q i , Pi =

Ti-1 (qi ),

gi = Ti Ji-1 .

82

4.2. System Model, Filter Model, and Control Law

4.2.3 Filter models
Spacecraft lter model:
Each of the

n

spacecraft runs a lter to estimate the posterior

distribution of the spacecraft attitude and unmeasurable angular velocity. The estimated attitude motion and angular velocities are computed with the following model

x ^k+1

= f (^ xk , k ) + wk wk

(4.7)

where x ^k is the state vector, noise. The notation

k

is the control torque, and

is the additive process

( ^ · )

denotes the estimation of

( · ).

The function

f (^ xk , k )

is

propagated through the forth-order Runge-Kutta method as given by Equation (3.7) and Equation (3.8), where the function

G(^ x) is given as follows:    q ^i  i = 1, 2, · · · , n G(^ x) =  i v ^

(4.8)

where

i = v q ^ ^i

i and v ^

respectively, and

= fi (qi , v ^i ) + gi (qi )i , note that q ^i and v ^i are estimates of qi and vi , -1 i q fi (qi , v ^i ) = -Ti P i - Ti Jm,i (Pi q i )× Jm,i Pi q i with the following parameters
and

Pi = Ti-1 (^ qi ), gi = Ti Ji-1 ,

Jm  R3×3 q

is the positive-denite mass moment-of-inertia

matrix of the lter model. The vector

denotes the modied Rodrigues parameters (MRP)

and is obtained directly from the measurement model

yk

which is given by

yk = [qk ] + [vqk ]

(4.9)

Distributed lter model:

The virtual leader exchanges partial information with other

spacecraft in the formation and only the neighboring spacecraft have access to information. A distributed model is incorporated to estimate the reference angular acceleration of the

ith

SFF. The proposed distributed model is propagated through forth-order Runge-Kutta

method similar to the procedure in Equations (3.7) and (3.8),

n

p i = 
j =1
where

aij (pi - pj ) + ai0 (pi - v  0) pi (0) = 0,  is a constant parameter, aij

(4.10)

pi

is an estimation of v  0 where

is an element

of the weighted adjacency matrix

A which denotes the communication quality between the

83

Chapter 4. Distributed Attitude Estimation and Control of Spacecraft Formation Flying
ith
and

j th

spacecraft. The weighted adjacency element

aij (i = 1, 2, · · · , n, j = 1, 2, · · · , n) ai0 (i = 1, 2, · · · , n)
is a The element

is bounded, such that,

aii = 0

and

0 < aij < 1.

The parameter

constant which denes the adjacency matrix

B = diag {a10 , a20 , · · · , ai0 }. ai0 = 0.

ai 0 > 0

if the

ith

spacecraft has access to the leader, otherwise

4.2.4 Control law
The distributed asymptotic attitude coordination control law for a group of spacecraft is given by [Zou

et al. 2016]
-1 2 i = gi [-k1 k2  ^1i - k1 k3  ^2i - fi (qi , v ^i ) -  2  q ~i + pi ].
(4.11)

For

i = 1, 2, · · · , n,

where the parameters

k1 , k2 , k3 , ,

and



are some positive constants,

pi

is an estimation of v  0 , and

 ^1i

and

 ^2i

are the estimated lumped attitude state errors

including station-keeping and formation-keeping errors for the ith spacecraft in formation. The parameters

 ^1i

and

 ^2i

are dened as

n

 ^1i =
j =1 n

aij (^ qi - q ^j ) + ai0 (^ qi - q0 ) aij (^ vi - v ^j ) + ai0 (^ vi - v0 )
j =1

(4.12a)

 ^2i =
where v0

(4.12b)

= q 0 , ith

and

i = 1, 2, · · · , n.

The control law depends on attitude, velocity and

acceleration estimations and on the state of the virtual leader ( only if the spacecraft is a neighbor of the virtual leader.

i.e., q0 , v0 ,

and v  0 ) if and

4.3

Simulation Results and Discussion

Numerical simulations are presented to verify the performance of the online distributed estimation under fault-free and fault-prone scenarios. The faults may occur with the

system dynamics, control command, or measurement models. Here, the adaptive unscented Kalman lter (Chapter 1.4.3) and particle lter (Chapter 1.4.4) are implemented to obtain an online distributed estimation of unmeasurable angular velocity. The problem addressed in the present work is challenging given the fact that not all spacecraft in the formation

84

4.3. Simulation Results and Discussion
have direct access to the virtual leader. The virtual leader, labeled as spacecraft

0,

has The

states given by a time-varying reference trajectory for the spacecraft formation.

forth-order Runge-Kutta method was implemented to numerically integrate the system model and lter models with an integration time step simulation time of

t = 0.01sec

and

t = 0.01sec

for a

Tsim = 200sec.
The communication quality between spacecraft is expressed with

System parameters:

the weighted adjacency matrix

2

A = (aij )6×6 ,

where

a12 = a21 = 0.4, a16 = a61 = 0.6,
and

a23 = a32 = 0.6, a34 = a43 = 0.6, a45 = a54 = 0.8, a56 = a65 = 0.6,
elements. The symmetric weighted adjacency matrix the ith spacecraft has access to the virtual leader, otherwise

aij = 0

for all other

ai0 > 0 (i = 1, 2, . . . , n) is a constant if ai0 = 0.
The adjacency matrix

B =

diag[0.5, 0, 0, 0, 0, 0.5].

The reference attitude is

q0 = 0.2[cos(0.2t), sin(0.2t),



3]T

and the external disturbances are assumed as

i = 0.1[sin(it), cos(it), sin(2it)]T .

Table 4.1

shows the initial attitude and angular velocities, and Table 4.2 present the mass moment of inertia of each spacecraft [Zou

et al. 2016].

Table 4.1: Initial attitude and angular velocity.

Spacecraft

Initial attitude

Initial angular velocity

1 2 3 4 5 6

 q1 (0) = [0, 1, 3]T

 q2 (0) = -0.4[1, 1, 2]T  q3 (0) = 1.4[ 3, 1, 0]T  q4 (0) = -0.6[ 3, 0, 1]T  q5 (0) = 1.5[1, 2, 1]T  q6 (0) = -1.2[1, 1, 2]T

1 (0) = 0 2 (0) = 0 3 (0) = 0 4 (0) = 0 5 (0) = 0 6 (0) = 0

Control parameters:
and

The saturation limit of the control law is and the control parameters are

|ij |  0.1Nm,

where

i = 1, 2, · · · , n, j = 1, 2, 3, k3 = 20.
2 The

 = 2,  = 10, k1 = 0.5, k2 = 15,

weighted adjacency matrix A is a symmetric matrix (i.e., aij = aji and aii = 0) with the adjacency elements aij which denotes the communication quality between the ith and j th spacecraft, (i.e., aij > 0).

85

Chapter 4. Distributed Attitude Estimation and Control of Spacecraft Formation Flying Filter parameters:
are The standard deviation of the process noise and measurement noise and

Q = 1 × 10-3 ,

R = 1 × 10-4 .

The covariance matrix of process noise and and

measurement noise are given by

2 Q = E {wwT } = Q In×n ,

2 R = E {vv T } = R Im×m .

Adaptive unscented Kalman lter :
where

The scaling parameter and

3

2  = AU KF × (n + ) - n,

AU KF = 0.1, AU KF = 2,  = 0,

n

is the dimension of the augmented state.

(m) (c) 2 The lter weights are W0 = /(n + ), W0 = /(n + ) + (1 - AU KF + AU KF ), and (m) (c) (m) (c) Wi = Wi = 1/2(n + ), for i = 1, 2, . . . , n where Wi and Wi are the weight associated with the mean and covariance matrices. The fading factor in AUKF is

 = 1 × 103 .

Particle lter :
see [Carpenter

The number of particles

Np = 100,

and the resampling threshold for Ef-

fective Sample Size (ESS),

P F = 0.8.

The systematic resampling algorithm was selected,

et al. ], [Kitagawa 1996], or [Chen 2003], and the proposal distribution was
q (xk | xk-1 , y1:k-1 ) = N
xk ;

selected such that

f (xk-1 ), Q

(4.13)

where

N

xk ;

f (xk-1 ), Q

is the multivariate Gaussian distribution with expected value and

variance. See [Haug 2005] for details on the proposal distribution.

Attitude error matrices:

Performance comparison, between adaptive unscented Kalman

lter and particle lter, was investigated based on station-keeping and formation-keeping attitude error metrics. The station-keeping attitude error (SKAE) metric is dened as

6
SKAE

=
i=1

e1i

2

(4.14)

and the formation-keeping attitude error (FKAE) metric is dened as

6
FKAE

6

=
i=1 j =i+1

qi - qj 2 .

(4.15)

The station-keeping attitude error (SKAE) and formation-keeping attitude error (FKAE) are used as error metrics for all fault-prone scenarios in this simulation.

composite scaling parameter  is a function of three variables: (1) AU KF which determines ¯ , (2) AU KF which incorporate prior knowledge of the the spread of the sigma points around the mean x distribution of the state x, and (3)  which is a secondary scaling parameter usually set to 0.

3 The

86

4.3. Simulation Results and Discussion

4.3.1 Fault-free spacecraft formation ying
Six spacecraft are involved in the formation including one virtual leader. The spacecraft are modeled as rigid bodies, where the mass moment of inertia tensor for each Spacecraft is presented in Table (4.2) [Ren 2007]. The mass moment of inertia tensor of the lter

is given in Table (4.3). The purpose of this study is to compare the performance of the adaptive unscented Kalman lter and particle lter when no faults are introduced.

Table 4.2: Mass moment-of-inertia tensor for each spacecraft in the formation.

Spacecraft

Inertia matrix [kg

· m2 ]

1 2 3 4 5 6

J1 = [1.00 0.10 0.10; 0.10 0.10 0.10; 0.10 0.10 0.90] J2 = [1.50 0.20 0.30; 0.20 0.90 0.40; 0.30 0.40 2.00] J3 = [0.80 0.10 0.20; 0.10 0.70 0.30; 0.20 0.30 1.10] J4 = [1.20 0.30 0.70; 0.30 0.90 0.20; 0.70 0.20 1.40] J5 = [0.90 0.15 0.30; 0.15 1.20 0.40; 0.30 0.40 1.20] J6 = [1.10 0.35 0.45; 0.35 1.00 0.50; 0.45 0.50 1.30]

Table 4.3: Filter mass moment-of-inertia tensor for each spacecraft in the formation.

Spacecraft

Inertia matrix [kg

· m2 ]

1 2 3 4 5 6

Jm1 = [1.00 0 0; 0 0.10 0; 0 0 0.90] Jm2 = [1.50 0 0; 0 0.90 0; 0 0 2.00] Jm3 = [0.80 0 0; 0 0.70 0; 0 0 1.10] Jm4 = [1.20 0 0; 0 0.90 0; 0 0 1.40] Jm5 = [0.90 0 0; 0 1.20 0; 0 0 1.20] Jm6 = [1.10 0 0; 0 1.00 0; 0 0 1.30]

87

Chapter 4. Distributed Attitude Estimation and Control of Spacecraft Formation Flying
14
FKAE PF

6
SKAE PF

12

FKAE AUKF

5

SKAE AUKF

Formation-keeping attitude error

0.08 10 0.06 8 0.04 0.02 6 0 80 4 90 100 110 120

Station-keeping attitude error

0.4 4 0.3 0.2 0.1 80

3

2

90

100

110

120

2

1

0 0 20 40 60 80 100 120 140 160 180 200

0 0 20 40 60 80 100 120 140 160 180 200

Time (s)

Time (s)

(a) FKAE

(b) SKAE

Figure 4.2: Formation-keeping and station-keeping attitude errors.

Figure 4.2(a) presents the formation-keeping attitude error and Figure 4.2(b) shows the station-keeping attitude error. Under no fault condition, the particle lter estimates the spacecraft states with higher accuracy than AUKF resulting in a faster convergence of formation-keeping error and station-keeping errors. Here, performance of particle lter are possible due to small number of particles selected for practical application. As the

number of particles drawn from the posterior distribution increases, better approximation of the intractable integrals appearing in the Bayesian equation is possible at the expense of computation time. The small number of particles selected herein is sucient to approximate the continuous distributions and estimate the unknown hidden attitude states of the Spacecraft in formation ying.

88

4.3. Simulation Results and Discussion

4.3.2 Uncertainty in moment-of-inertia and external disturbances
In the following section, faults are introduces in the spacecraft dynamics with the purpose of comparing the accuracy of online distributed estimation between the adaptive unscented Kalman lter and particle lter. Ideally, the evaluation will be based on the capacity to estimate the attitude states and maintain a specied station keeping and formation keeping. Two possible scenarios are considered: In the rst scenario, uncertainty is introduced in the mass moment-of-inertia tensor. introduced. In the second scenario, external disturbances are

Case I: Uncertainty in Moment of Inertia
In the following case, uncertainty is introduced in the mass moment-of-inertia (MOI) tensor. The uncertainty in MOI reects a fault that may occur in the Spacecraft dynamics. Changes in MOI are compensated by the control command which is driven by the estimated states

i.e.

attitude response and angular velocity. Four faults are introduced at Spacecraft during

a simulation time of

200-seconds.

Initially, no fault occur at the Spacecraft dynamics and

the MOI corresponds to the MOI in Table (4.2). The rst fault occur 10-seconds after the start of simulation for a duration of (i.e.

40-seconds.

Here, the magnitude of uncertainty in MOI

Ixx , Iyy

and

Ixx )

increase signicantly, while the product of inertia (i.e.

Ixy , Ixz , Iyz 30-seconds.

etc.) remain unchanged. The second fault occur at 50-seconds for a duration of

During the fault, the magnitude of uncertainty in MOI decreases by 50 percent from the fault at previous interval. Finally, the third fault occur at 80-seconds and remains until the end of the simulation. The Uncertainty in MOI is calculated as

JF ault = Ji + Jk

(i = 1, 2, · · · , n)
and

where

Ji

is the mass moment-of-inertia tensor presented in Table (4.2),

Jk

is the uncertainty tensor as shown in Table (4.4).

Figure 4.3(a) shows the formation-keeping attitude error and Figure 4.3(b) shows the station-keeping attitude error. It is interesting to note that the uncertainty in mass moment-of-inertia tensor eect the formation-keeping attitude error (FKAE) and station -keeping attitude error (SKAE). Initially, the convergence rate of the adaptive unscented Kalman lter is slightly faster than the particle lter. This is because of computation

time required by the particle lter to estimate the states and establish formation-keeping

89

Chapter 4. Distributed Attitude Estimation and Control of Spacecraft Formation Flying
Table 4.4: Uncertainty in moment-of-inertia.

Time [sec]

Uncertainty in MOI tensor [kg

· m2 ]

0<t 10 < t 50 < t 80 < t

10 50 80 100

Jk = [0 0 0; 0 0 0; 0 0 0] Jk = [2 0 0; 0 3 0; 0 0 4] Jk = [1 0 0; 0 1.5 0; 0 0 2] Jk = [0.2 0 0; 0 0.3 0; 0 0 0.4]

14
FKAE PF

6
SKAE PF

12

FKAE AUKF

5

SKAE AUKF

Formation-keeping attitude error

0.03 10 0.02 8 0.01 6 0 100 4 110 120 130 140 150

Station-keeping attitude error

0.3 4 0.25 0.2 0.15 80

3

2

90

100

110

120

2

1

0 0 20 40 60 80 100 120 140 160 180 200

0 0 20 40 60 80 100 120 140 160 180 200

Time (s)

Time (s)

(a) Formation-Keeping Attitude Error

(b) Station-Keeping Attitude Error

Figure 4.3: Uncertainty in moment-of-inertia tensor.

and station-keeping. Once uncertainty in MOI decreases, the adaptive unscented Kalman lter approximate the hidden states to higher accuracy and the formation-keeping error and station-keeping error are reduced.

90

4.3. Simulation Results and Discussion Case II: External disturbances
In the following case, the spacecraft in formation experience external disturbances acting on each one of the principal axes. External disturbances to the

i

for

(i = 1, 2, · · · , n)

are added

ith

spacecraft dynamic equation (Equation 4.1) which result in a modied dynamic

equation

× Ji   i = -i Ji i + i + i

(4.16)

where the magnitude of the external disturbances is given in Table (4.5).

The ex-

ternal disturbances are introduced at four dierent time intervals during the simulation. At the start of the simulation, external disturbances equivalent to

i = 10-

[0.25 sin(t); 0.25 cos(t); 0.25 sin(2t)]

are introduced at the spacecraft dynamic model for

seconds. The second interval starts at to

t = 10-second when external disturbances equivalent
are applied to the spacecraft dynamic model for a

i = [0.5 sin(t); 0.5 cos(t); 0.5 sin(2t)]

duration of 15-seconds. The third interval starts at external disturbances equivalent to

t = 25-second

when the magnitude of are applied for a where external

i = [0.1 sin(t); 0.1 cos(t); 0.1 sin(2t)]

duration of 25-seconds. Finally, the last interval starts at disturbances are equivalent to

t = 50-seconds

i = [0.01 sin(t); 0.01 cos(t); 0.01 sin(2t)].

Table 4.5: External disturbances.

Time [sec]

External disturbance

0<t 10 < t 25 < t 50 < t

10 25 50 100

i = dk [sin(t); cos(t); sin(2t)] where dk = 0.25 i = dk [sin(t); cos(t); sin(2t)] where dk = 0.5 i = dk [sin(t); cos(t); sin(2t)] where dk = 0.1 i = dk [sin(t); cos(t); sin(2t)] where dk = 0.01

91

Chapter 4. Distributed Attitude Estimation and Control of Spacecraft Formation Flying
35
FKAE PF

15
SKAE PF SKAE AUKF

30

FKAE AUKF

Formation-keeping attitude error

25

Station-keeping attitude error
0 20 40 60 80 100 120 140 160 180 200

10

20

15

5

10

5

0

0 0 20 40 60 80 100 120 140 160 180 200

Time (s)

Time (s)

(a) Formation-Keeping Attitude Error

(b) Station-Keeping Attitude Error

Figure 4.4: External disturbances.

Figure 4.4(a) shows the formation-keeping attitude error and Figure 4.4(b) shows the station-keeping attitude error for spacecraft in formation ying in the presence of external disturbance. The gure shows the adaptive unscented Kalman lter experienced signi-

cantly large formation-keeping error and station keeping error in the presence of external disturbance. However, the eect of the external disturbance was not signicantly apparent in the particle lter. These signicantly large errors in formation-keeping and station-

keeping are directly impacted by the small number of sigma points used to estimate the posterior distribution of the states. Recall: the number of sigma points (sampling points) in AUKF is given by lter is

2Nx + 1

whereas the number of sampling points selected for the particle

Np = 100.

Small number of sampling points of AUKF is not sucient for state

estimation when the rate-of-change is large. For large rate-of-change the particle lter can estimate the posterior distribution to higher accuracy and lower the formation-keeping and station keeping errors. In the case of AUKF, formation-keeping error and station keeping error converge over a longer simulation time in comparison to particle lter.

92

4.3. Simulation Results and Discussion

4.3.3 Control command faults
In the following section, fault are introduced at the control command with the purpose of comparing the accuracy of estimation between adaptive unscented Kalman lter and particle lter with the scope of reducing the station-keeping and formation-keeping errors under the inuence of faults in the control command. Two cases are considered: In the

rst case, various magnitudes of control commands are applied at dierent time intervals. In the second case, there are no applied control commands during formation stabilization.

Case I: Constant applied control commands
In the following case, the distributed spacecraft in formation ying experience changes in the applied control commands as expressed in varying control signals and changes in control gains during the simulation time. for a duration of The simulation is divided into four intervals

200-seconds.

Table (4.6) presents the time interval of fault occurrences

and the corresponding applied control command. In the rst interval, a constant control command is applied where

1 , 3

and

6

receive one control command while

2 , 4

and

5

receive a dierent control command. The seconds interval starts at

t = 10-seconds

when

the control command generates a constant control signal to only several spacecraft in the formation with no regards to system dynamics. This fault continuous until where

t = 15-seconds

1 , 3 ,

and

6

are constant while

2 , 4

and

5

correspond to applied control law until

as per Equation (4.11). The third interval start at

t = 15-seconds

t = 25-seconds.

At this interval faulty applied control command were generated as a result of changes in control gains. The last interval start at

t = 25-seconds

to the end of simulation. At this

interval, the control command has been recovered and no fault is present.

93

Chapter 4. Distributed Attitude Estimation and Control of Spacecraft Formation Flying
Table 4.6: Constant applied control commands.

Time [sec]

Control command

0<t

10

i =

i (i = 1, 2, . . . , 6)   [0.050; 0.025; 0.075], for i = 1, 3, 6  [0.070; 0.050; 0.025],   [0.050; 0.025; 0.075],  According to Eqn. (4.11), for i = 2, 4, 5 for i = 1, 3, 6 for i = 2, 4, 5

10 < t 15 < t 25 < t

15 25 200

i =

i = According to Eqn. (4.11) (k1 = 1.25, k2 = 5, k3 = 10) i = According to Eqn. (4.11)

Figure4.5(a) show the formation-keeping attitude error and Figure4.5(b) show the station-keeping attitude error for SFF in the of presence dierent magnitudes of control commands. In the presence of dierent applied control commands, the AUKF and PF

estimate the spacecraft state to the same accuracy resulting in similar convergence of formation-keeping error and station-keeping errors. However, once the faulty condition

has recovered, the particle lter converge much faster than the AUKF.

94

4.3. Simulation Results and Discussion
25
FKAE PF FKAE AUKF

12
SKAE PF

Formation-keeping attitude error

20 0.08 0.06 15 0.04 0.02 10 0 100 110 120 130 140 150

10

SKAE AUKF

Station-keeping attitude error

0.35 8 0.3 0.25 6 0.2 0.15 100 110 120 130 140 150

4

5

2

0 0 20 40 60 80 100 120 140 160 180 200

0 0 20 40 60 80 100 120 140 160 180 200

Time (s)

Time (s)

(a) Formation-Keeping Attitude Error

(b) Station-Keeping Attitude Error

Figure 4.5: Constant applied control commands.

Case II: No control command during formation stabilization
In the following case, several spacecraft in formation receive no control command during formation stabilization and once control command has been recovered the control parameters are changing. The simulation is divided into four intervals for a duration of The rst interval starts at

200-seconds. 2 , 4 5

t = 0-seconds

and continues for

20-seconds.
and

At this interval, and

the control command does not generate a torque signal for receive a constant command. The second interval starts at

1 , 3

6

while

t = 20 continues for 20-seconds.

At this interval, the control command has been fully recovered, and the control command corresponds to Equation (4.11).

i.e.,

fault-free scenario,

The third interval, starts at

t = 40-seconds

and continues for

30-seconds.

Here, control parameters change as a result

of faulty control command. Finally, the last interval start at

t = 70-seconds

and continues

until the end of simulation. In this interval, the control command has been recovered and no fault is present. Table (4.7) present the fault time and corresponding applied control command. Figure 4.6(a) show the formation-keeping attitude error and Figure 4.6(b) show the station-keeping attitude error for Spacecraft in formation ying in the absence of applied control torque. The control command in Eqn. (4.11) is quite sensitive to the estimated

95

Chapter 4. Distributed Attitude Estimation and Control of Spacecraft Formation Flying
Table 4.7: No control command during formation stabilization.

Time [sec]

Torque magnitude

i (i = 1, 2, . . . , 6) for i = 1, 3, 6 for i = 2, 4, 5

0<t 20 < t 40 < t 70 < t

20 40 70 200

i =

  [0; 0; 0],  [0.050; 0.025; 0.075],

i = According to Eqn. (4.11)   [0.050; 0.025; 0.075], for i = 1, 3, 6 i =  According to Eqn. (4.11) ( = 0.5), for i = 2, 4, 5 i = According to Eqn. (4.11)

states computed by the AUKF and PF. The PF seems to estimate the state with higher accuracy as compared to AUKF resulting in a faster convergence of formation-keeping attitude error and station-keeping attitude error.

35
FKAE PF

15
SKAE PF SKAE AUKF

30

FKAE AUKF

Formation-keeping attitude error

25

Station-keeping attitude error
0 20 40 60 80 100 120 140 160 180 200

10

20

15

5

10

5

0

0 0 20 40 60 80 100 120 140 160 180 200

Time (s)

Time (s)

(a) Formation-Keeping Attitude Error

(b) Station-Keeping Attitude Error

Figure 4.6: No control command during formation stabilization.

96

4.3. Simulation Results and Discussion

4.3.4 Measurements noise
In the following section, relatively large random measurement noise is introduced with the purpose of comparing the capacity of adaptive unscented Kalman lter and particle lter to estimate the attitude states and reduce the station-keeping and formation-keeping errors under heterogeneous measurement noise. Heterogeneous noise levels which are introduced in measurements may result from various interface sources include electromagnetic elds, temperature, pressure, contamination and high-energy radiation.

Case I: Heterogeneous measurements
In the following case, heterogeneous measurements are generated during the simulation time. High noise levels deteriorate the capacity to measure and estimate the attitude

response of any dynamic system. Zero mean white Gaussian noise was used for both process noise and measurement noise; whereas, a random number generator was used in to draw samples at various noise levels. During the simulation, measurement sensitivity is altered at multiple intervals to include various noise uctuations with the scope of comparing the capacity of AUKF and PF to estimate the spacecraft states and reduce the formationkeeping error and station-keeping error. The measurement noise are calculated as follows:

measurementNoise = Error + N (µ,  )

(4.17)

where, error refers to typical measurement errors resulting from inaccuracies in measurement model, physical characteristics, or other environmental sources. and,

µ

is the mean value These parameters



is the uncertainty at dierent intervals during the simulation.

are presented in Table (4.8). Figure 4.7(a) show the formation-keeping attitude error and Figure 4.7(b) show the station-keeping attitude error for spacecraft in formation ying in the presence heterogeneous measurements. It is interesting to note that between

t=0

to

t = 60

when the noise level are relatively small, the formation-keeping error and station-

keeping error converge at the same rate for both AUKF and PF. This implies that both lters estimate the spacecraft states to the same accuracy. However, between

t = 60

to

t = 100

when the noise level increases, the particle lter estimates the spacecraft states

at higher accuracy and is able to reduce the formation-keeping error and station-keeping

97

Chapter 4. Distributed Attitude Estimation and Control of Spacecraft Formation Flying
14
FKAE PF

6
SKAE PF

12

FKAE AUKF

5

SKAE AUKF

Formation-keeping attitude error

10

Station-keeping attitude error
0 20 40 60 80 100 120 140 160 180 200

4

8

3

6

2

4

2

1

0

0 0 20 40 60 80 100 120 140 160 180 200

Time (s)

Time (s)

(a) Formation-Keeping Attitude Error

(b) Station-Keeping Attitude Error

Figure 4.7: Heterogeneous measurements.

errors to a larger extent as compared to AUKF.

Table 4.8: Heterogeneous measurements.

Time [sec]

Torque magnitude

i (i = 1, 2, . . . , 6)

0<t 10 < t 60 < t 100 < t

10 60 100 200

Error = 0.02; µ = 0;  = 1 × 10-7 Error = 0.1; µ = 0;  = 1 × 10-2 Error = 0.5; µ = 0;  = 1 × 10-3 Error = 0.08; µ = 0;  = 1 × 10-1

98

4.4. Conclusions
4.4 Conclusions

The aim of this chapter was to investigate the estimation results of adaptive unscented Kalman lter and particle ltering technique and estimate the unmeasurable angular velocity and reference angular acceleration of spacecraft formation ying (SFF) while tracking a common time-varying reference attitude. The virtual leader exchanges only partial information with other spacecraft in the formation and only the neighboring spacecraft have access to information. Distributed ltering approach is proposed to obtain a reference

angular acceleration estimates of the virtual leader and nonlinear lters were introduced to obtain an accurate estimation of unmeasurable angular velocity. The AUKF represent the state of the system using a Gaussian distribution while the particle lter represent the required posterior distribution by a set of random samples with associated weights and compute the estimates based on these samples. The samples are random particles of the hidden states and the weights are the probability masses estimated using the Bayesian recursion. The particle lter and adaptive unscented Kalman lter (AUKF) are compared in terms of the accuracy of estimating the unmeasurable angular velocity with the purpose of decreasing the station-keeping and formation-keeping attitude errors. The formation

ying was comprised of six spacecraft including a virtual leader which exchange partial information with other spacecraft in the formation. Particle lter has a clear advantage over AUKF and provide better state estimates under fault cases.

99

Chapter 5. Online Estimation and Control of Multi-Agent Systems

Chapter 5

Online Estimation and Control of Multi-Agent Systems

In this chapter, a lter for online joint estimation is proposed based on Rao-Blackwellised principle where the particle ltering technique is coupled with unscented transform algorithm. The new lter is called marginalized unscented particle lter (MUPF). The proposed lter is applied in online joint estimation of an uncertain dynamic models which describe the evolution of a distributed multi-agent system in consensus tracking. A Chebyshev neural network (CNN) is incorporated to describe the uncertain dynamic models of the multiagent system while nonlinear ltering policies are implemented to estimate the state of the multi-agent system and to train the internal parameters of the neural network as neatly as possible given a set of prior measurements. Much of the emphasis here is on accuracy of the joint estimation process, as well as the capacity to train CNN to determine the uncertain dynamics of the system. In this study, the AUKF and MUPF are compared under fault-free and fault-prone conditions at the multi-agent dynamics and control commands. These results are compared to the adaptive law which has been proposed for estimating the internal parameters of CNN. The chapter is organized as follows: Section 5.1 provide a brief introduction to the proposed marginalized unscented particle lter (MUPF) architecture, including the problem of estimating uncertain dynamic systems is outlined. Section 5.2.2 present the dynamic equation of a multi-agent system, the lumped error calculations, the control command and joint estimation algorithms. Section 5.3 provide the estimation results of uncertain dynamic of multi-agent system. The result compare between the adaptive unscented Kalman lter (AUKF), the marginalized unscented particle lter (MUPF), and the adaptive law under fault-free and fault-prone conditions.

100

5.1. Introduction
5.1 Introduction

Sequential state and parameter estimation of dynamic systems is known in the literature as a joint estimation process. If parameter uncertainty is introduced in dynamic model, the joint estimation is simultaneously arises. The mathematical framework of estimation theory provide the tools required to approach the joint estimation problem from a Bayesian perspective. The basic idea is to characterize the posterior distribution of the state and parameters of a dynamic system at current time given the knowledge of prior distribution and evidence from new measurements. Since there is no optimal solution to the joint

estimation process, suboptimal solutions are investigated. The unscented Kalman lter oers an easy approach for sequential joint approximation of a Gaussian distributions [Julier & Uhlmann 1997]. The lter provide an ecient

derivative-free ltering algorithm for computing approximate solutions to discrete-time nonlinear ltering problems. The idea is to calculates the statistics of Gaussian random variables which undergone a nonlinear transformation through implementation of

unscented

transformation (UT) principles.

The UT is a deterministic sampling technique that chooses

a set of specic sample points around the mean

i.e., sigma points.

When the sigma points

are propagated through the nonlinear transition and observation models, the mean and covariance of the state estimates can be accurately captured (for details see Chapter 2.4). Another popular sequential ltering strategy is the particle lter which provide a framework for online joint estimation by combining Monte-Carlo sampling methods with Bayesian lter [Gordon & Smith 1993]. The idea of particle lters is to represent the posterior distribution by a properly weighted support points,

i.e., particles, which are sampled directly importance sampling
principle

from the state-space. The particles are properly located, weighted, and propagated recursively according to the Bayesian rule. Particle lters rely on

which is aimed at sampling from a distribution in the region of "importance" in order to approximate the posterior distribution. Therefore, a good proposal distribution is essential to the eciency of importance sampling and choosing an appropriate proposal distribution is a crucial step in the implementation of particle lters. For more details, the reader may refer to Chapter 2.8, or [Arulampalam

et al. 2002], [Chen 2003], [Doucet & Johansen 2008].

101

Chapter 5. Online Estimation and Control of Multi-Agent Systems
Extensive research has been placed on identifying techniques to improve the eciency and reduce the variance of estimations in nonlinear lters. In this chapter, an idea to

improve the joint estimation process is proposed where Rao-Blacwellization principle is used to couple the particle lter with unscented transform algorithm. The proposed lter is applied in online estimation of an uncertain dynamic models which describe the evolution of a distributed multi-agent system in consensus tracking. The purpose of the lter is to trains the internal parameters of the third-order Chebyshev neural network (CNN) as neatly as possible given a set of prior measurements. The proposed idea to improve the eciency of a particle lter is by using a RaoBlacwellization technique to evaluate some of the ltering parameters analytically instead pure sampling methods. The technique is known as Rao-Blacwellization particle lter

(RBPF) [Casella & Robert 1996], [Doucet

et al. 2000], [Murphy & Russell 2001].

The idea

behind RBPF is that by conditioning a deterministic portion of the measurements, the posterior distribution can be approximated with a Gaussian distribution while the other measurements are approximated with a sampling techniques. The improvement is obtained by calculating a conditional expectation which involve integrating out the ancillary statistics. If the model admits partial analytical tractability, it is possible to combine the particle lter with optimal lters to obtain ecient high dimensional lters [Andrieu

et al. 2001].

In this way, better estimates are obtained with less variance than could be obtained with pure Monte Carlo sampling [Särkkä 2013]. In this chapter, an addition to the toolbox of estimation algorithms is proposed such that the Rao-Blackwellised principal couples the particle lter with the unscented transform algorithm. The new lter is called marginalized unscented particle lter (MUPF). Here, the MUPF is used to estimate the state and parameters of an uncertain dynamic models of a multi-agent system. The proposed approach is entirely dierent than other approaches since the complex task of joint estimation is broken down into state estimation using the particle lter while the internal parameters of a third-order Chebyshev neural networks are estimated using unscented transform principles. Here, the third-order CNN describes the uncertain dynamic model of a multi-agent system and the weights of the network are updated at each iteration.

102

5.1. Introduction

5.1.1 Literature review
A multi-agent system frequently distribute the task responsibilities among a number of individual agents, each operating with partial information of state estimates and response of other agents. In this environment, each agent operate in a

decentralized

architecture based

on the information received. Generally, the dynamic behavior of a multi-agent system is derived from a theoretical or physical model, assuming the analytical form of the underlying physical laws are known from rst principle. However, in many practical applications the description of a dynamic model is not exact and the physical laws governing the system are unknown or partially known. A broad range of techniques have been developed to deal with scenarios of unknown dynamic models and the theory become quite sophisticated. One of the proposed techniques have roots in neural networks (NN) which approximate any smooth function to an arbitrary accuracy. This makes NN suitable for estimating the uncertain nonlinear dynamics of a multi-agent system. The principles of NN are based on a mapping between a set of input measurements arriving at an input layer and a set of output estimates at an output layer. The mapping between inputs to output layers is completed through a hidden layer. If the right connections from the input layer to a large enough set of hidden layer exist, a representation can always be found such that any mapping will be performed from input to output layer through these hidden units [Rumelhart

et al. 1986].

In general, the rst layer has input measurements

which send information to a junction of a second layer of measurements, and then from the second junction to the third layer of output estimates. The junctions store parameters called "weights" that manipulate the measurements in the calculations [Bishop 1995]. In this work, a third-order Chebyshev neural networks (CNN) have been implemented as a universal approximation to learn the uncertain nonlinear functions in the agent dynamics (for details see Chapter 2.9). [Zou An-Min Zou, Krishna Dev Kumar, and Zeng-Guang Hou

et al. 2011] have applied CNN to approximate an uncertain nonlinear functions in the

problem of consensus tracking control for third-order multi-agent systems in the presence of uncertain dynamics and bounded external disturbance. In their work, the weights of the CNN were computed using the adaptive law. A similar work has been proposed in Arthur Kar Leaung Lin [Lin 2014], who studied multi-agent systems that orbit around asteroids.

103

Chapter 5. Online Estimation and Control of Multi-Agent Systems
The contribution of this work is dierent in a sense that the

joint estimation

process

of the multi-agent system is trained using sequential Bayesian approach. Joint estimation process for nonlinear dynamic systems is practically challenging and an open issue which arises when state and parameter uncertainty is introduced in the dynamic model. The

basic idea is to characterize the posterior distribution of the state and parameters of the multi-agent system at current time given the knowledge of prior distribution and evidence from new measurements. In this case, particle methods are primarily used to construct a sequential distribution of the state and parameters by allowing particles to fully explore the posterior distributions. One of the major drawbacks of particle ltering is that sampling in high-dimensional state-spaces can be inecient because of the large number of samples needed to represent the posterior distribution. To alleviate this issue, the

Rao-Blackwell

theorem was introduced to particle ltering [Doucet 1998], [de Freitas 2002]. Rao-Blackwell theory [Casella & Robert 1996] is a marginalization technique that is used to reduce the variance of estimation. This marginalization technique is one of the

ways for improving the eciency and reducing the variance of estimation in particle lters [Doucet

et al. 2000].

The implementation of Rao-Blackwell technique in particle ltering

is known variously in the scientic literature as [Fong

Rao-Blackwellized particle lter
or

(RBPF)

et al. 2002]
[Schön

[Särkkä

et al. 2007],

[Johansen

et al. 2012], marginalized particle lter mixtures Kalman lters
This is done

(MPF)

et al. 2006],

[Nordlund & Gustafsson 2009]

[Chen & Liu 2000]. The underlying principle of the technique is to increase the eciency of the sampling method by reducing the size of the state-space model.

by marginalizing out some of the variables analytically by combining the particle lter with an optimal lter. The class of models where marginalization using Rao-Blackwell

of a linear state components can be carried out usually depends on conditional linear Gaussian models. In this chapter, the linearity restriction of RBPF technique is partially relaxed by incorporating a sub-optimal lter. A similar idea has been proposed by Vihola [Vihola 2007], and in the textbook by Simo Särkkä (Chapter 7.5) [Särkkä 2013]; however, there is no documented literature to support the proposal. The Rao-Blackwell theorem

and the mathematical derivations of RBPF are given in Appendix B.

104

5.1. Introduction

5.1.2 Objectives
The objective of this research is to estimate the state and parameters of an uncertain dynamic model which describe the evolution of a distributed multi-agent system in consensus tracking. A nonlinear ltering technique is proposed such that the lter is capable of joint estimation in an online setting. The proposed lter reduces the dimensions of the state-space model and consequently reduce the variance of estimations by using the RaoBlackwellised principle to couple the particle lter technique with unscented transform algorithm. The main contributions of this research are as follows: 1.

Estimation of uncertain dynamic models:

Online estimation of an uncertain

dynamic models using nonlinear ltering techniques and the approximation property of Chebyshev neural network (CNN). A third-order CNN is used as a universal approximation to learn in a sequential setting an uncertain nonlinear function which describe the agent dynamics. A nonlinear lter is developed and implemented to

estimate the state of the multi-agent system and the internal parameters of CNN. An investigation is conducted to study a distributed multi-agent system in the presence of unknown system dynamics and external disturbance.

2.

Propose a nonlinear lter for joint estimation:

A nonlinear ltering technique

is proposed for online joint estimation which couples the particle ltering technique with the unscented transform through the Rao-Blackwellised principle. The proposed lter is used simultaneously in state estimation of a multi-agent system in consensus tracking and parameter estimation of a third-order Chebyshev neural network. Much of the emphasis here is on accuracy of the joint estimation process, as well as the capacity to estimate the parameters of CNN and determine the uncertain dynamics of the multi-agent system. The proposed lter allow to simplify the high dimen-

sional state-space model of the multi-agent system and jointly estimate the state and parameters in sequential setting.

3.

Estimation of unbounded parameters:

In contrast to existing parameter esti-

mation approaches, the estimation algorithms presented herein are not bounded to a predened set of values while the estimated uncertain dynamic function is properly

105

Chapter 5. Online Estimation and Control of Multi-Agent Systems
updated sequentially as new measurements arrive. The unbounded weight estimation really goes down to a parameter estimation problem where the weights of CNN are treated as parameters and are updated sequentially as new measurements become available.

4.

Evaluation of performance:

Performance evaluation and comparison between the

proposed nonlinear lter and other ltering techniques under fault-free and faultprone conditions. A comparison is conducted between the MUPF and AUKF under faults at the multi-agent dynamics and control commands. These results are compared to the adaptive law which has been proposed for estimating the internal parameters of CNN. The performance comparison in this research are illustrated with numerical simulations.

5.2

System Model, Filter Model, and Control Law

In this section, dynamic equations, kinematic equations, lter models, and control laws are constructed for a distributed multi-agent system in consensus tracking with uncertain dynamic model. Figure 5.1 shows the communication graph for the multi-agent system.

Agent 1
Virtual leader

Agent 2

Agent 3

Agent 6

Agent 5

Agent 4

Figure 5.1: Communication graph for multi-agent system

106

5.2. System Model, Filter Model, and Control Law

5.2.1 Dynamic equations
The term decentralized is often applied to systems comprising of multiple lters or controllers. Consider a class of nonlinear multi-agent systems with

n

agents in which the

ith

agent is considered by the following second-order dierential equation as x i v i where xi

= vi

(5.1) (5.2)

= fi (xi , vi ) + gi (xi )ui + i , i = 1, 2, · · · , n
are the state vectors of the

 Rm

and vi

 Rm

ith

agent,

fi (xi , vi )  Rm

is a

continuous unknown dynamic function,

gi (xi )  Rm×m is a nonsingular control gain matrix, i  Rm
is the external disturbance.

ui  R m

is the control input of the

ith

agent, and

5.2.2 Joint estimation model
The basic idea of joint estimation is to characterize the posterior distribution of the state and parameters of the dynamic model at current time given the knowledge of prior distribution and evidence from new measurements. To be more specic, consider the problem of estimating both the hidden state

xk

and parameter

k

of a discrete multi-agent system (5.3a) (5.3b)

zk+1 yk

= f (xk , k , uk , wk ) = h(xk , k , vk )

where zk+1 denotes the joint estimation vector which contains the parameter of interest and the state vector. The parameter of interest,

k  Rm×N1 ,

denotes the neural net-

work weights , and xk is an

1

n-dimensional state vector 
ny

with initial state x0 . The function

f :

nx

×

nv



nx nx

, denotes the state transition models in Equations (5.1)-(5.2), and

the function

h:

×

wn

is a nonlinear mapping of the measurements.

uk

de-

notes a deterministic control input,

wk

and

vk

are the transition and measurement noise,

respectively which are assumed to be uncorrelated with the network weights and initial conditions. The evolution of the network weights corresponds to a Markov process with initial probability

p(k=0 )

and transition probability

p(k |k-1 ).

evolution of the network weights are assumed to depend on the previous weight k-1 and additional stochastic parameter dk-1 .

1 The

107

Chapter 5. Online Estimation and Control of Multi-Agent Systems

5.2.3 Filter model
Filtering techniques are investigated for estimating the weights of a neural network which approximate an unknown nonlinear function. The lter model for estimating the state a multi-agent system is given by

^ ^ zk+1 = f ( ^k , k ) + wk k, x
where

(5.4)

wk

is the process noise,

k

is the control torque, x ^k is the estimated state vector,

^k = W  , W  , · · · , W   m×2 m×1 m×N1

T

is the estimated neural network weight, and

f (·)

is

propagated through the forth-order Runge-Kutta method given by Equation (3.7) with parameters dened by Equation (3.8) and with function

G(^ x)

given as follows

 G(^ x) = 
v i

x i

= vi

 
(5.5)

=

ficnn (xi , vi )

+ gi (xi )ui , i = 1, 2, · · · , n

Estimating the neural network weights is a parameter estimation process where the optimal weight

Wi

is estimated in online setting during the simulation.

The unknown function

ficnn (xi , vi )

in Equation (5.5) is approximated by a property of Chebyshev neural network

ficnn (xi , vi ) = Wi i (xi , vi ) + i
where

(5.6)

Wi  Rm×N1

is the optimal weight with

N1 = 2mN2 + 1

and

N2

is the order of the

Chebyshev polynomials,

i  R m

is the CNN approximation error, and

i (Xi )  RN1

with

T T Xi = ( xT i , vi )
function

denotes the Chebyshev polynomial basis function. The polynomial basis is obtained by the Chebyshev polynomial

i (Xi ) (i = 1, 2, · · · , n)

i (Xi ) = (1, T1 (Xi,1 ), · · · , TN2 (Xi,1 ), · · · , T1 (Xi,2m ), · · · , TN2 (Xi,2m ))T
where

(5.7)

Ti (Xi,j ) (i = 1, 2, · · · , N2 , j = 1, 2, · · · , 2m)

represents the Chebyshev polynomials

which are obtained using the recursive formula dened by Equation (2.43).

108

5.2. System Model, Filter Model, and Control Law

5.2.4 Marginalized unscented particle lter
The idea of MUPF is to partition the dynamic state space into two subspaces z0:k

=

{0:k ,
with the

x0:k }, such that the distribution

p(0:k , x0:k | k  Rm×N1

y1:k ) can be updated analytically and is the optimal neural network weight

eciently. The parameter of interest,

N1 = 2mN2 + 1

where

N2

is the order of the Chebyshev polynomial, and xk is Since the state xk conditioned on

n-dimensional state vector

with initial state x0 .

k

is reduced to nonlinear Gaussian state-space system, then the estimation is performed

analytically using the adaptive unscented Kalman lter .

2

The variance of estimation is

reduced by marginalizing out the parameter x0:k such that the full posterior distribution at time step

k

can be factorized as follows

p(0:k , x0:k | y1:k ) = p(x0:k | y1:k , 0:k )p(0:k | y1:k )
where adaptive unscented Kalman lter is used to evaluate the term since it is nonlinear and Gaussian, whereas the second term,

(5.8)

p(x0:k |

y1:k , 0:k )

p(0:k |y1:k )

is evaluated using

particle lter. From the second term the following recursion is obtained [Särkkä 2013]

p(0:k | y1:k )  p(yk | 0:k , y1:k-1 )p(0:k | y1:k-1 ) = p(yk | 0:k , y1:k-1 )p(k | 0:k-1 , y1:k-1 )p(0:k-1 | y1:k-1 ) = p(yk | 0:k , y1:k-1 )p(k | k-1 )p(0:k-1 | y1:k-1 )
The rst term is evaluated using AUKF with xed (5.9)

0:k

over the measurement model,

the second term is the transition model, and the third term is the posterior from the previous time step. Therefore, sampling the parameter

k

will generally require many

fewer particles than standard particle lter which would sample both xk and

k .

The

k

samples are updated as in standard particle lter and the xk distribution are updated using the AUKF, conditioned on the parameter unscented particle lter is described.

k .

Next, the algorithm for marginalized

the state x1:k , conditioned on 1:k could be reduced to a linear Gaussian state-space system, then the estimation can be performed using Kalman lter. This method is known as Rao-Blackwellized Particle Filter (RBPF) [Doucet 1998], [de Freitas 2002].

2 If

109

Chapter 5. Online Estimation and Control of Multi-Agent Systems MARGINALIZED UNSCENTED PARTICLE FILTER (MUPF)
1.

Prediction step using AUKF (see AUKF algorithm in Chapter2.4)
2n
x ¯k

=
i=0 2n

Wi

(m)

^ (i) ((i) ) X k k-1
(i) ( i) (i) (i)

(5.10a)

Pxx =
i=0
2.

^ ( ) - x ^ ( ) - x W i [X ¯k ][X ¯ k ]T + Q k k-1 k k-1

(c)

(5.10b)

For k = 1, . . . , T
(a)

Draw samples from the importance distribution
k  q (k | 0:k-1 , y1:k ),
(i) (i) ( i)

i = 1, 2, . . . , Np

(5.11)

(b)

Calculate the updated importance weights
(i) wk

=

(i) p(yk wk -1

| k , y1:k-1 )p(k | k-1 ) q (k | 0:k-1 , y1:k )
(i) ( i)

( i)

(i)

(i)

,

i = 1, 2, . . . , Np

(5.12)

( i) where the likelihood function is computed from AUKF and is conditioned on k such 2n (i) (i) (i) (m) ^ (i) (i) ^ (i) (i) that p(yk | k , y1:k-1 ) = Wi Y k (k-1 ) where Yk (k-1 ) = hk (Xk-1 , k-1 ). i=0
3.

Normalize the importance weight such that
(i) w ~k

Np i

w ~k = 1
(5.13)

( i)

=

wk
Np j =1

(i)

wk

(j )

4.

AUKF gain calculation and update (see AUKF algorithm in Chapter2.4)
-1 Kk = Pxy Pyy
x ^k (5.14a) (5.14b) (5.14c)

=x ¯k + Kk (yk - y ¯k )

+ T = Pxx - Kk Pyy Kk Pk

5.

Compute eective sample size and resample
^ef f = N
If

1
Np i 2 i=1 (wk )

(5.15)

^ef f N

is small perform resampling.

110

5.2. System Model, Filter Model, and Control Law
6.

Approximate the posterior distribution
Np

p(0:k , x0:k |y1:k ) 
i=1

+ w ~k  (0:k - 0:k )N (xk | x ^k , Pk )

(i)

(i)

(5.16)

5.2.5 Control law
The control law for the

ith

agent in the multi-agent system is [Zou

et al. 2011]
(5.17)

-1 ui = gi (-Wi i - K1i si - K2i si - i ), i = 1, 2, · · · , n

where term

K1i and K2i are positive denite, diagonal, and constant matrices.

The robust control

i  Rm (i = 1, 2, · · · , n)

is used to counteract the external disturbance and neural

network approximation error,

ij = i tanh
where

mku i sij 

, ku = 0.2785, j = 1, 2, · · · , m
The terminal sliding manifold

(5.18)

i

and



are positive constants.

si  Rm (i =

1, 2, . . . , n)

is expressed as

si = vi + 1 xi + 2 i
where

(5.19)

T T T mn si = (sT 1 , s2 , . . . , sn )  R

T T T T i = (1 , 2 , . . . , n )  Rmn
(5.20)

1 = diag{11 Im , 12 Im , . . . , 1n Im }  R(mn)×(mn) 2 = diag{21 Im , 22 Im , . . . , 2n Im }  R(mn)×(mn)
and

xi  Rm

and

vi  Rm (i = 1, 2, · · · , n)

for the

ith

agent are the lumped state error

measures which are dened as the sum of the absolute and relative state errors and depends only on the information of the neighbor agents of the are dened as

ith

agent. The lumped state errors

n

xi =
j =1 n

aij rxij + bi exi

(5.21)

vi =
j =1

aij rvij + bi evi

(5.22)

111

Chapter 5. Online Estimation and Control of Multi-Agent Systems
where

mn T T T T x = (x 1 , x2 , · · · , xn )  R

and

mn T T T T , aij v = (v 1 , v2 , · · · , vn )  R

is the

element of the weighted adjacency matrix are dened as follows:

3

A,

and the relative and absolute state errors

Relative Error :
(i = 1, 2, · · · , n)

The relative error is the state error of an individual agent with respect to The relative state error between the are dened by

another agent in the multi-agent system. and the

ith

agent

j th

agent

(j = 1, 2, · · · , n) rxij = xi - xj rvij = vi - vj

(5.23)

(5.24)

Absolute Error :

The absolute error is the state error of an individual agent with respect to

the desired trajectory. The absolute errors of the

ith

agent

(i = 1, 2, · · · , n)

are dened by

exi = xi - xd evi = vi - x d
where

(5.25)

(5.26) The common

mn T T T ex = (eT x1 , ex2 , · · · , exn )  R

and

mn T T T . ev = (eT v1 , ev2 , · · · , evn )  R

desired trajectory (

i.e.

xd and x  d ) is available to only a subset of agents and each agent in the

group has access to information of its neighbor agents only as expressed by the adjacency matrices

A

and

B

where

B = diag {a10 , a20 , · · · , ai0 },

and

ai0 > 0 (i = 1, 2, · · · , n) ai0 = 0.

is a

constant if the

ith

spacecraft has access to the leader, otherwise

3 The

j th

weighted adjacency matrix A denotes the communication quality between the ith agent and the agent and the weighted adjacency element aij is bounded, such that, aii = 0 and 0 < aij < 1.

112

5.3. Simulation Results and Discussion
5.3 Simulation Results and Discussion

In the following section, numerical simulations are presented for online consensus tracking of a distributed multi-agent system under fault-free and fault-prone scenarios. Here, the time-varying reference trajectory of a multi-agent system is provided by a virtual leader where the desired trajectory is available to a subset of the agents and each agent in the group has restricted access to information of its neighbor agents only. The purpose

is to estimate the uncertain dynamic function in an online setting where the dynamic function describes the evolution of a distributed multi-agent system. The uncertain

dynamic function is modeled as a third-order Chebyshev neural network (CNN) and three ltering algorithms are proposed to train the internal weights of CNN, namely, adaptive law, adaptive unscented Kalman lter and marginalized unscented particle lter. An

emphasis is placed on training the weights of a third-order CNN while constraining the work to sequential training and prediction. Sampling techniques in state-space setting

show how a CNN may be trained in environments where measurements arrive one at a time.

The communication quality between the virtual leader and each agent is expressed with a symmetric weighted adjacency matrix. matrices are given as follows For simulation purposes, the weighted adjacency

 0.0   0.7  0.0  A= 0.0   0.0  0.0

 0.7 0.0 0.0 0.0 0.0   0.0 0.6 0.0 0.0 0.0  0.6 0.0 0.7 0.0 0.0   0.0 0.7 0.0 0.8 0.0   0.0 0.0 0.8 0.0 0.9  0.0 0.0 0.0 0.9 0.0

B = diag 0.8, 0.0, 0.0, 0.0, 0.0, 0.9
The desired trajectory is given by x0

= 0.5(cos(t), sin(t))T , = 02×13 ,

and the initial weight matrices

of the CNN are given as follows: CNNAU KF

CNNM U P F

= 02×13 ,

CNNADT L

=

02×13 ,

for

i = 1, 2, . . . , 6.

The performance of the proposed lters are presented with an The absolute error matric (AER) is

absolute error matrix and a relative error matric.

113

Chapter 5. Online Estimation and Control of Multi-Agent Systems
dened as

n

AEM =
i=1
and the relative error matric (REM) is dened as

||exi ||2

(5.27)

n-1

n

REM =
i=1 j =i+1

||rxij ||2

(5.28)

The estimation techniques considered herein are the adaptive law, adaptive unscented Kalman lter and marginalized unscented particle lter (MUPF).

Adaptive unscented Kalman lter :
2 AU KF × (n + ) - n,
where

The

composite

scaling

parameter and

4

is



=

AU KF = 0.1, AU KF = 2,  = 0,

n

is the dimension

(m) = /(n + ), of the augmented state. The lter weight are calculated according to W0 ( c ) ( m ) (c) 2 = Wi = 1/2(n + ), for i = 1, 2, . . . , n W0 = /(n + )+(1 - AU KF + AU KF ), and Wi (c) (m) are the weight associated with the mean and covariance matrices and Wi where Wi
accordingly.

Adaptive law :

The adaptive law has been proposed by An-Min Zou, Krishna Dev Kumar

and Zeng-Guang Hou [Zou

et al. 2011].

The adaptive law for

Wi (i = 1, 2, · · · , n)

is

 i = i si iT W
where

(5.29)

si

is the terminal sliding manifold given by Equation (5.19),

i

is the Chebyshev

basis function given by Equation (5.7), and

i

is a positive constant.

Marginalized unscented particle lter :

The number of particles

Np = 100,

and the re-

sampling threshold for Eective Sample Size (ESS),

M U P F = 0.8. |
(i) 0:k-1 , y1:k )

For simplicity, the

resampling algorithm selected is the multinomial resampling.

The proposal distribution

(i) was selected from a known distribution such that q (k
4 The

= p(k | k-1 , y1:k ).

(i)

(i)

composite scaling parameter  is a function of three variables: (1) AU KF which determines the spread of the sigma points around the mean x ¯, (2) AU KF which incorporate prior knowledge of the distribution of the state x, and (3)  which is a secondary scaling parameter usually set to 0.

114

5.3. Simulation Results and Discussion
The parameters of the adaptive unscented Kalman lter which were implemented in the marginalized unscented particle lter were described in previous paragraph.

5.3.1 Fault-Free multi-agent system
In this section, the uncertain dynamic model of a distributed multi-agent system is estimated under fault-free scenario. The multi-agent system consists of a virtual leader and six follower agents, where the uncertain nonlinear function

fi (xi , vi )

is given by

fi (xi , vi ) =
where the parameters

+ 4xi2 sin(  4

h1i vi1 ) 2

4xi1 cos( h2i2vi2 )

(5.30)

h1i

and

h2i

are given in Table 5.1, and xi

= (xi1 , xi2 )T , vi = (vi1 , vi2 )T

are given in Table 5.2.

Table 5.1: Parameters of agent's dynamics

i h1i h2i

1 0.6 0.3

2 -0.2 0.4

3 0.4 -0.4

4 -0.3 -0.7

5 0.5 -0.2

6 0.5 -0.5

The external disturbances gain matrix

i (i = 1, 2, . . . , 6) in the agent's dynamic model and the control

gi

is given by

i =

0.1 sin( it ) 2 0.1 cos( it ) 2

,

gi = I2

(5.31)

Next, simulation results are presented in Figures 5.2-5.6 for the adaptive unscented Kalman lter, marginalized unscented particle lter, and the adaptive law under fault-free scenario. Figure 5.2 shows the estimation results of the uncertain dynamic model

^ ^ ^ T f i = (fi1 , fi2 ) (i =

1, 2, . . . , 6).

Figure 5.3 present the agent's state estimates x ^i

= (^ xi1 , x ^i2 )T (i = 1, 2, . . . , 6);

where, Figure 5.3 (a)-(b), are the state estimates using the adaptive law, Figure 5.3 (c)-(d), are the state estimates using the adaptive unscented Kalman lter, and Figure 5.3 (e)-(f ), are the state estimates using the marginalized unscented particle lter. Figure 5.4 present

115

Chapter 5. Online Estimation and Control of Multi-Agent Systems
Table 5.2: Initial conditions.

i 1 2 3 4 5 6
x1 (0) x2 (0) x3 (0) x4 (0) x5 (0) x6 (0)

xi

vi v1 (0) = [0, 0]T v2 (0) = [0, 0]T v3 (0) = [0, 0]T v4 (0) = [0, 0]T v5 (0) = [0, 0]T v6 (0) = [0, 0]T

= [1, 0.5]T = [1.8, -0.2]T = [0.2, -1.2]T = [-0.1, 1.2]T = [-0.6, 1.8]T = [1, -1.7]T

the agent's tracking error under fault-free scenario

ei = (ei1 , ei2 )T (i = 1, 2, . . . , 6);

where,

Figure 5.4 (a)-(b), are the tracking errors using the adaptive law, Figure 5.4 (c)-(d), are the tracking errors using the adaptive unscented Kalman lter, and Figure 5.4 (e)-(f ), are the tracking errors using the marginalized unscented particle lter. Figure 5.5 shows the control laws

ui = (ui1 , ui2 )T (i = 1, 2, · · · , 6).

Figure 5.6 (a) is the absolute error metric

(AEM), and Figure 5.6 (b) is the relative error metric (REM). Finally, the weights of the third-order Chebyshev neural network are presented in Appendix C.2.

116

5.3. Simulation Results and Discussion
10
hf
MUPF AUKF

6
hf

5

hf

4 2 0

MUPF AUKF

hf

hf ADTL

hf ADTL

hf 11

0

-5

hf 21
hf MUPF hf AUKF

-2 -4

-10

10

8 6 4
hf MUPF hf AUKF hf ADTL

5

hf ADTL

hf 12

hf 22
0 -5 4 2 0
hf MUPF hf
AUKF

2 0 -2 -4

10
hf MUPF

5

hf

AUKF

hf ADTL

hf ADTL

hf 13

-2 -4

hf 23
hf MUPF

0

-5 -6 -8 -10

10

10
hf MUPF

5

hf

AUKF

5

hf

AUKF

hf ADTL

hf ADTL

hf 14

0

hf 24
hf MUPF

0

-5

-5

-10

-10

10

10
hf MUPF

5

hf AUKF hf
ADTL

5

hf AUKF hf
ADTL

hf 15

0

hf 25
hf MUPF

0

-5

-5

-10

-10

10

10 5 0 -5
hf MUPF hf AUKF hf ADTL

5

hf AUKF hf ADTL

hf 16

0

-5

hf 26
0 0.5 1 1.5 2 2.5 3 3.5 4

-10 -15 0 0.5 1 1.5 2 2.5 3 3.5 4

-10

Time (s)

Time (s)

Figure 5.2:

Estimation of uncertain dynamic model under fault-free scenario

^ f i =

^ ^ T (f i1 , fi2 ) (i = 1, 2, . . . , 6).

117

Chapter 5. Online Estimation and Control of Multi-Agent Systems
2 2

Agent 1ADTL
1.5

Agent 2ADTL Agent 3ADTL Agent 4ADTL Agent 5ADTL

1.5 1 0.5

Agent 1ADTL Agent 2ADTL Agent 3ADTL Agent 4ADTL Agent 5ADTL Agent 6ADTL

1

State

State
20

0.5

Agent 6ADTL

0 -0.5

0 -1 -0.5 -1.5 -1 0 2 4 6 8 10 12 14 16 18 -2 0 2 4 6 8 10 12 14 16 18 20

Time (s)

Time (s)

(a) x ^i1ADT L
2 2

(b) x ^i2ADT L

Agent 1AUKF
1.5

Agent 2AUKF Agent 3AUKF Agent 4AUKF Agent 5AUKF

1.5 1 0.5

Agent 1AUKF Agent 2AUKF Agent 3AUKF Agent 4AUKF Agent 5AUKF Agent 6AUKF

1

State

State
20

0.5

Agent 6AUKF

0 -0.5

0 -1 -0.5 -1.5 -1 0 2 4 6 8 10 12 14 16 18 -2 0 2 4 6 8 10 12 14 16 18 20

Time (s)

Time (s)

(c) x ^i1AU KF
2 2

(d) x ^i2AU KF

Agent 1MUPF
1.5

Agent 2MUPF Agent 3MUPF Agent 4MUPF Agent 5MUPF

1.5 1 0.5

Agent 1MUPF Agent 2MUPF Agent 3MUPF Agent 4MUPF Agent 5MUPF Agent 6MUPF

1

State

State
20

0.5

Agent 6MUPF

0 -0.5

0 -1 -0.5 -1.5 -1 0 2 4 6 8 10 12 14 16 18 -2 0 2 4 6 8 10 12 14 16 18 20

Time (s)

Time (s)

(e) x ^i1M U P F

(f) x ^i2M U P F

Figure 5.3: State estimates x ^i

= (^ xi1 , x ^i2 )T (i = 1, 2, · · · , 6).

118

5.3. Simulation Results and Discussion
1.5 2

Agent 1ADTL
1

Agent 2ADTL Agent 3ADTL Agent 4ADTL Agent 6ADTL
Tracking error

1.5 1 0.5 0 -0.5 -1

Agent 1ADTL Agent 2ADTL Agent 3ADTL Agent 4ADTL Agent 5ADTL Agent 6ADTL

0.5

Tracking error

Agent 5ADTL
0

-0.5

-1 -1.5 -1.5 0 2 4 6 8 10 12 14 16 18 20 -2 0 2 4 6 8 10 12 14 16 18 20

Time (s)

Time (s)

(a) exi1ADT L
1.5 2

(b) exi2ADT L
Agent 1AUKF Agent 1AUKF Agent 2AUKF Agent 3AUKF Agent 4AUKF
Tracking error
0.5 0 -0.5 -1

1

Agent 2AUKF Agent 3AUKF Agent 4AUKF Agent 5AUKF Agent 6AUKF

1.5 1

0.5

Tracking error

Agent 5AUKF Agent 6AUKF

0

-0.5

-1 -1.5 -1.5 0 2 4 6 8 10 12 14 16 18 20 -2 0 2 4 6 8 10 12 14 16 18 20

Time (s)

Time (s)

(c) exi1AU KF
1.5 2

(d) exi2AU KF
Agent 1MUPF Agent 1MUPF Agent 2MUPF Agent 3MUPF Agent 4MUPF
Tracking error
0.5 0 -0.5 -1

1

Agent 2MUPF Agent 3MUPF Agent 4MUPF Agent 5MUPF Agent 6MUPF

1.5 1

0.5

Tracking error

Agent 5MUPF Agent 6MUPF

0

-0.5

-1 -1.5 -1.5 0 2 4 6 8 10 12 14 16 18 20 -2 0 2 4 6 8 10 12 14 16 18 20

Time (s)

Time (s)

(e) exi1M U P F

(f) exi2M U P F

Figure 5.4: Tracking error

ei = (exi1 , exi2 )T (i = 1, 2, · · · , 6).

119

Chapter 5. Online Estimation and Control of Multi-Agent Systems
10
UMUPF

5
UMUPF U
AUKF

5

U

AUKF

UADTL

0

UADTL

U11

0

U21
-5 -10 5
UMUPF UMUPF UAUKF UAUKF UADTL

-5

-10

5

0

0

UADTL

U12

-5

U22
-5 -10 20
UMUPF UAUKF

-10

-15

10

15 10

UMUPF UAUKF U
ADTL

5

U

ADTL

U13

U23
0 -5 10
UMUPF

5 0 -5 -10

10 5 0 -5
UMUPF U U
AUKF ADTL

5

U U

AUKF ADTL

U14

0

-5

U24
UMUPF UAUKF UADTL

-10 -15

-10

15 10 5 0 -5 -10

10
UMUPF

0

UAUKF UADTL

U15

U25
UMUPF

-10

-20

-30

20

40 30 20
UMUPF UAUKF UADTL

10

UAUKF UADTL

U16

0

U26
0 0.5 1 1.5 2 2.5 3 3.5 4

10 0

-10 -10 -20 -20 0 0.5 1 1.5 2 2.5 3 3.5 4

Time (s)

Time (s)

Figure 5.5: Control input under fault-free scenario

ui = (ui1 , ui2 )T (i = 1, 2, · · · , 6).

120

5.3. Simulation Results and Discussion

4 3.5 3 0.03 2.5

AEM MUPF AEM AUKF AEM ADTL

AEM

0.02 2 0.01 1.5 0 1 0.5 0 0 2 4 6 8 10 12 14 16 18 20 5 10 15

Time (s)

(a) AEM
14

REMMUPF
12

REMAUKF REMADTL

10 0.01 8

REM

0.005 6

4

0 15

16

17

18

19

20

2

0 0 2 4 6 8 10 12 14 16 18 20

Time (s)

(b) REM

Figure 5.6: Absolute error metric and relative error metric under fault-free scenario.

121

Chapter 5. Online Estimation and Control of Multi-Agent Systems

5.3.2 Uncertainty in dynamics model
In the following case, uncertainty is introduced in the multi-agent dynamic models (Equation 5.30) at four dierent intervals during a

20-seconds

simulation time. The simulation

reected changes in the magnitude of the multi-agent dynamics rather than changes in the frequency. Initial assumption is that no fault occurs at the interval between

0<t 10 < t

2.

At

this interval the dynamic model is modeled as Equation (5.30). The rst fault occurs at the interval between

2<t

10.

The second fault occurs at the interval between

15.

Finally, in the last interval between

10 < t

20,

the multi-agent dynamics is modeled as

Equation (5.30). Table 5.3 presents the fault time and the dynamics models. Table 5.3: Uncertainty in dynamic system.

Time [sec]

Dynamic model

0<t

2

fi (xi , vi ) = fi (xi , vi ) = fi (xi , vi ) = fi (xi , vi ) =

4xi2 sin(  + 4

h1i vi1 ) 2

4xi1 cos( h2i2vi2 ) 12xi2 sin(  + 4 5xi2 sin(  + 4 + 4xi2 sin(  4
h1i vi1 ) 2

2<t

10

12xi1 cos( h2i2vi2 )
h1i vi1 ) 2

10 < t

15

-4xi1 cos( h2i2vi2 )
h1i vi1 ) 2

15 < t

20

4xi1 cos( h2i2vi2 )

Figures 5.7-5.11 present the simulation results for the adaptive unscented Kalman lter, marginalized unscented particle lter, and the adaptive law under uncertainty in the multi-agent dynamic model. Figure 5.7 shows the estimation results of the uncertain dynamics model estimates x ^i

^ ^ ^ T (i = 1, 2, . . . , 6). f i = (fi1 , fi2 )

Figure 5.8 present the agent's state

= (^ xi1 , x ^i2 )T (i = 1, 2, . . . , 6);

where, Figure 5.8 (a)-(b), are the state estimates

using the adaptive law, Figure 5.8 (c)-(d), are the state estimates using the adaptive unscented Kalman lter, and Figure 5.8 (e)-(f ), are the state estimates using the marginalized unscented particle lter. Figure 5.9 present the agent's tracking error under uncertainty in the dynamic model

ei = (ei1 , ei2 )T (i = 1, 2, . . . , 6);

where, Figure 5.9 (a)-(b), are the

122

5.3. Simulation Results and Discussion
tracking errors using the adaptive law, Figure 5.9 (c)-(d), are the tracking errors using the adaptive unscented Kalman lter, and Figure 5.9 (e)-(f ), are the tracking errors using the marginalized unscented particle lter. Figure 5.10 show the control law

ui = (ui1 , ui2 )T

(i = 1, 2, · · · , 6).

Finally, the weights of the third-order Chebyshev neural network are

presented in Appendix C.2.

123

Chapter 5. Online Estimation and Control of Multi-Agent Systems
10
hf
MUPF

10
hf
MUPF

5

hf AUKF hf
ADTL

5

hf AUKF hf
ADTL

hf 11

0

hf 21
hf MUPF hf AUKF

0

-5

-5

-10

-10

10

10
hf MUPF

5

hf AUKF hf ADTL

5

hf ADTL

hf 12

hf 22
0 -5 5
hf MUPF hf AUKF

0

-5

-10

10
hf MUPF

5

hf AUKF hf
ADTL

0

hf

ADTL

hf 13

hf 23
-5 -10
10
hf MUPF

0

-5

-10

10
hf MUPF

5

hf AUKF hf ADTL

5

hf AUKF hf ADTL

hf 14

0

hf 24
hf MUPF

0

-5

-5

-10

-10

10

10
hf MUPF

5

hf AUKF hf ADTL

5

hf AUKF hf ADTL

hf 15

0

hf 25
hf MUPF

0

-5

-5

-10

-10

10

10 5 0 -5
hf MUPF hf AUKF hf ADTL

5

hf AUKF hf ADTL

hf 16

0

-5

hf 26
0 5 10 15 20

-10 -15 0 5 10 15 20

-10

Time (s)

Time (s)

Figure 5.7: Estimation of uncertain dynamic model

^ ^ ^ T f i = (fi1 , fi2 ) (i = 1, 2, . . . , 6).

124

5.3. Simulation Results and Discussion

2

2.5

Agent 1ADTL Agent 2ADTL
2 1.5 1

Agent 1ADTL Agent 2ADTL Agent 3ADTL Agent 4ADTL Agent 5ADTL Agent 6ADTL
0.5 0

1.5

Agent 3ADTL Agent 4ADTL Agent 5ADTL
State
20

1

State

Agent 6ADTL
0.5

0 -0.5 -0.5 -1 0 2 4 6 8 10 12 14 16 18 0 2 4 6 8 10 12 14 16 18

Time (s)

Time (s)

(a) x ^i1ADT L
2 2.5

(b) x ^i2ADT L

Agent 1AUKF
1.5

Agent 1AUKF
2 1.5 1

Agent 2AUKF Agent 3AUKF Agent 4AUKF Agent 5AUKF
State

Agent 2AUKF Agent 3AUKF Agent 4AUKF Agent 5AUKF Agent 6AUKF

1

State

0.5

Agent 6AUKF

0.5 0 -0.5

0

-0.5 -1 -1 0 2 4 6 8 10 12 14 16 18 20 2 4 6 8 10 12 14 16 18 20

Time (s)

Time (s)

(c) x ^i1AU KF
3 2.5 2 1.5 3

(d) x ^i2AU KF

Agent 1MUPF Agent 2MUPF Agent 3MUPF Agent 4MUPF Agent 5MUPF
State
1 2

Agent 1MUPF Agent 2MUPF Agent 3MUPF Agent 4MUPF Agent 5MUPF
0

State

1 0.5

Agent 6MUPF

Agent 6MUPF

-1 0 -2 -0.5 -1 0 2 4 6 8 10 12 14 16 18 20 -3 0 2 4 6 8 10 12 14 16 18 20

Time (s)

Time (s)

(e) x ^i1M U P F

(f) x ^i2M U P F

Figure 5.8:

State estimates under uncertainty in dynamics model x ^i

= (^ xi1 , x ^i2 )T (i =

1, 2, · · · , 6).

125

Chapter 5. Online Estimation and Control of Multi-Agent Systems

1.5

Agent 1ADTL Agent 2ADTL Agent 3ADTL Agent 4ADTL

2 1.5 1

Agent 1ADTL Agent 2ADTL Agent 3ADTL Agent 4ADTL Agent 5ADTL Agent 6ADTL

1

Tracking error

Tracking error
20

0.5

Agent 5ADTL Agent 6ADTL

0.5 0 -0.5 -1

0

-0.5

-1 -1.5 0 2 4 6 8 10 12 14 16 18 0 2 4 6 8 10 12 14 16 18 20

Time (s)

Time (s)

(a) exi1ADT L
2 1.5 1

(b) exi2ADT L
Agent 1AUKF Agent 2AUKF Agent 3AUKF Agent 4AUKF Agent 6AUKF
Tracking error
1.5

Agent 1AUKF Agent 2AUKF Agent 3AUKF Agent 4AUKF Agent 5AUKF Agent 6AUKF

1

Tracking error

0.5 0 -0.5 -1

Agent 5AUKF

0.5

0

-0.5

-1 -1.5 0 2 4 6 8 10 12 14 16 18 0 2 4 6 8 10 12 14 16 18 20

Time (s)

Time (s)

(c) exi1AU KF
2

(d) exi2AU KF
1.5

Agent 1MUPF
1.5

Agent 1MUPF
1

Agent 2MUPF Agent 3MUPF Agent 4MUPF Agent 6MUPF
Tracking error

Agent 2MUPF Agent 3MUPF Agent 4MUPF

1

Tracking error

0.5

Agent 5MUPF

0.5

Agent 5MUPF Agent 6MUPF

0

0

-0.5

-0.5
-1

-1
-1.5

-2 0 2 4 6 8 10 12 14 16 18 20

-1.5 0 2 4 6 8 10 12 14 16 18 20

Time (s)

Time (s)

(e) exi1M U P F

(f) exi2M U P F

Figure 5.9:

Tracking error under uncertainty in dynamics model

ei = (exi1 , exi2 )T (i =

1, 2, · · · , 6).

126

5.3. Simulation Results and Discussion
10
UMUPF

10
UMUPF

5

UAUKF UADTL

5

UAUKF UADTL

U11

0

U21
UMUPF

0

-5

-5

-10

-10

5

10
UMUPF

0

UAUKF UADTL

5

UAUKF UADTL

U12

-5

U22
U

0

-10

-5

-15

-10

10
MUPF

20 15 10
U
MUPF

UAUKF

UAUKF UADTL

5

UADTL

U13

U23
0 -5
10
U
MUPF AUKF

5 0 -5 -10

10
U

5

U

5 0 -5

MUPF AUKF

U

UADTL

UADTL

U14

0

-5

U24
U

-10 -15

-10

20 15 10
MUPF

10
U
MUPF

UAUKF UADTL

0

UAUKF UADTL

U15

5 0

U25
UMUPF

-10

-20 -5 -10 -30

20

40 30 20
UMUPF UAUKF UADTL

10

UAUKF UADTL

U16

0

U26
0 0.5 1 1.5 2 2.5 3 3.5 4

10 0

-10 -10 -20 -20 0 0.5 1 1.5 2 2.5 3 3.5 4

Time (s)

Time (s)

Figure 5.10:

Control input under uncertainty in dynamics model

ui = (ui1 , ui2 )T (i =

1, 2, · · · , 6).

127

Chapter 5. Online Estimation and Control of Multi-Agent Systems
4 3.5 3 0.3 2.5

AEM MUPF AEM AUKF AEM ADTL

AEM

0.2 2 0.1 1.5 1 0.5 0 0 2 4 6 8 10 12 14 16 18 20 0 15 16 17 18 19 20

Time (s)

(a) AEM
14

REMMUPF
12

REMAUKF REMADTL

10 0.2 8 0.15 0.1 6 0.05 4 0 15 16 17 18 19 20

REM
2 0 0 2 4 6

8

10

12

14

16

18

20

Time (s)

(b) REM

Figure 5.11: Absolute error metric and relative error metric under uncertainty in dynamics model.

128

5.3. Simulation Results and Discussion

5.3.3 External disturbances
The second-order dynamic equation which describes the multi-agent system, includes a bounded external disturbances (Equation 5.2). In the following case, the external dis-

turbances are altered at four dierent intervals during a rst interval, between

20-seconds 10,

simulation time.

In

0 < t

5,

the external disturbances are expressed as

i =

t T t ), cos( 2 )) . 0.1(sin( 2

The second interval, between

5 < t

reect an increase in

magnitude of the external disturbances. disturbances is given by,

In this interval the magnitude of the external The third interval, between

t t T i = 8(sin( 2 ), cos( 2 )) .

10 < t

15

reect changes in frequency of the external disturbances. nal disturbances are expressed as terval, between

In this interval, the exterFinally, in the last in-

i = 0.1(sin(2t), cos(2t))T .

10 < t

20,

the external disturbances are bounded by the expression

t t T i = 0.1(sin( 2 ), cos( 2 )) .

The external disturbances and their corresponding time intervals

are presented in Table 5.4. Table 5.4: External disturbances.

Time [sec]

External disturbances

0<t 5<t 10 < t 15 < t

5 10 15 20

t t T i = di (sin( 2 ), cos( 2 )) t t T i = di (sin( 2 ), cos( 2 ))

where

di = 0.1 di = 8 di = 0.1 di = 0.1

where

i = di (sin(2t), cos(2t))T
t T t i = di (sin( 2 ), cos( 2 ))

where

where

Figures 5.12-5.16 present the simulation results for the adaptive unscented Kalman lter, marginalized unscented particle lter, and the adaptive law under the presence of external disturbances. Figure 5.12 shows the estimation results of the uncertain dynamic model

^ ^ ^ T f i = (fi1 , fi2 ) (i = 1, 2, . . . , 6)

under external disturbances. Figure 5.13 present the where, Figure 5.13 (a)-(b), are the

agent's state estimates x ^i

= (^ xi1 , x ^i2 )T (i = 1, 2, . . . , 6);

state estimates using the adaptive law, Figure 5.13 (c)-(d), are the state estimates using the adaptive unscented Kalman lter, and Figure 5.13 (e)-(f ), are the state estimates using

129

Chapter 5. Online Estimation and Control of Multi-Agent Systems
the marginalized unscented particle lter. Figure 5.14 present the agent's tracking error under external disturbances

ei = (ei1 , ei2 )T (i = 1, 2, . . . , 6);

where, Figure 5.14 (a)-(b),

are the tracking errors using the adaptive law, Figure 5.14 (c)-(d), are the tracking errors using the adaptive unscented Kalman lter, and Figure 5.14 (e)-(f ), are the tracking errors using the marginalized unscented particle lter. Figure 5.15 show the control law

ui = (ui1 , ui2 )T (i = 1, 2, · · · , 6).

Finally, the weights of the third-order Chebyshev neural

network are presented in Appendix C.3.

130

5.3. Simulation Results and Discussion
10
hf
MUPF

10
hf
MUPF

5

hf AUKF hf ADTL

5

hf AUKF hf ADTL

hf 11

0

hf 21
hf MUPF

0

-5

-5

-10

-10

10

10
hf MUPF

5

hf AUKF hf ADTL

5

hf AUKF hf ADTL

hf 12

hf 22
hf

0

0

-5

-5

-10

-10

10
MUPF AUKF

10
hf

5

hf

5 0 -5

MUPF AUKF

hf

hf ADTL

hf ADTL

hf 13

0

-5

hf 23
hf MUPF

-10 -15

-10

10

10 5 0 -5
hf MUPF hf AUKF hf ADTL

5

hf AUKF hf ADTL

hf 14

0

-5

hf 24
hf MUPF

-10 -15

-10

10

10
hf MUPF

5

hf hf

AUKF ADTL

5

hf hf

AUKF ADTL

hf 15

0

hf 25
hf MUPF

0

-5

-5

-10

-10

10

10 5 0 -5
hf MUPF hf AUKF hf ADTL

5

hf AUKF hf ADTL

hf 16

0

-5

hf 26
0 5 10 15 20

-10 -15 0 5 10 15 20

-10

Time (s)

Time (s)

Figure 5.12: Estimation of uncertain dynamics model under external disturbances

^ f i =

^ ^ T (f i1 , fi2 ) (i = 1, 2, . . . , 6).

131

Chapter 5. Online Estimation and Control of Multi-Agent Systems
2 2.5

Agent 1ADTL
1.5

Agent 1ADTL
2 1.5 1

Agent 2ADTL Agent 3ADTL Agent 4ADTL Agent 5ADTL
State

Agent 2ADTL Agent 3ADTL Agent 4ADTL Agent 5ADTL Agent 6ADTL

1

State

0.5

Agent 6ADTL

0.5 0

0

-0.5 -0.5 -1 -1 -1.5 0 2 4 6 8 10 12 14 16 18 20 2 4 6 8 10 12 14 16 18 20

Time (s)

Time (s)

(a) x ^i1ADT L
2.5 2.5 2 1.5 1

(b) x ^i2ADT L

Agent 1AUKF
2

Agent 1AUKF Agent 2AUKF Agent 3AUKF Agent 4AUKF Agent 5AUKF Agent 6AUKF

Agent 2AUKF Agent 3AUKF Agent 4AUKF Agent 5AUKF
State
20

1.5

State

1

Agent 6AUKF

0.5 0

0.5

0

-0.5 -1 -1.5

-0.5

-1 0 2 4 6 8 10 12 14 16 18 0 2 4 6 8 10 12 14 16 18 20

Time (s)

Time (s)

(c) x ^i1AU KF
2.5

(d) x ^i2AU KF
2.5

Agent 1MUPF
2

2 1.5 1 0.5

Agent 1MUPF Agent 2MUPF Agent 3MUPF Agent 4MUPF Agent 5MUPF Agent 6MUPF

Agent 2MUPF Agent 3MUPF Agent 4MUPF Agent 5MUPF Agent 6MUPF
State

1.5

1

State

0 -0.5 -1 -1.5

0.5

0

-0.5

-2
-1 0 2 4 6 8 10 12 14 16 18 20

-2.5 0 2 4 6 8 10 12 14 16 18 20

Time (s)

Time (s)

(e) x ^i1M U P F

(f) x ^i2M U P F

Figure 5.13: State estimates under external disturbances x ^i

132

= (^ xi1 , x ^i2 )T (i = 1, 2, · · · , 6).

5.3. Simulation Results and Discussion

1.5

2

Agent 1ADTL Agent 2ADTL Agent 3ADTL Agent 4ADTL
Tracking error
1.5 1 0.5 0 -0.5

Agent 1ADTL Agent 2ADTL Agent 3ADTL Agent 4ADTL Agent 5ADTL Agent 6ADTL

1

Tracking error

0.5

Agent 5ADTL Agent 6ADTL

0

-0.5 -1 -1 -1.5

0

2

4

6

8

10

12

14

16

18

0

2

4

6

8

10

12

14

16

18

20

Time (s)

Time (s)

(a) exi1ADT L
1.5 2

(b) exi2ADT L
Agent 1AUKF Agent 2AUKF
1.5 1

Agent 1AUKF Agent 2AUKF Agent 3AUKF Agent 4AUKF Agent 5AUKF Agent 6AUKF
0 -0.5

1

Agent 3AUKF Agent 4AUKF
Tracking error
20

Tracking error

0.5

Agent 5AUKF Agent 6AUKF

0.5

0

-0.5 -1 -1 -1.5

0

2

4

6

8

10

12

14

16

18

0

2

4

6

8

10

12

14

16

18

Time (s)

Time (s)

(c) exi1AU KF
1.5
2

(d) exi2AU KF
Agent 1MUPF

Agent 1MUPF
1.5

1

Agent 2MUPF Agent 3MUPF Agent 4MUPF

Agent 2MUPF Agent 3MUPF Agent 4MUPF Agent 5MUPF Agent 6MUPF

1

0.5

Agent 5MUPF
Tracking error
20

Tracking error

Agent 6MUPF
0

0.5

0

-0.5

-0.5
-1

-1
-1.5

-1.5 0 2 4 6 8 10 12 14 16 18

-2 0 2 4 6 8 10 12 14 16 18 20

Time (s)

Time (s)

(e) exi1M U P F

(f) exi2M U P F

Figure 5.14: Tracking error under external disturbances

133

ei = (exi1 , exi2 )T (i = 1, 2, · · · , 6).

Chapter 5. Online Estimation and Control of Multi-Agent Systems
10
U
MUPF

10
U
MUPF

5

UAUKF UADTL

5

UAUKF UADTL

U11

0

U21
UMUPF UAUKF U
ADTL

0

-5

-5

-10

-10

10 5 0 -5 -10 -15

15 10 5 0 -5 -10
UMUPF UAUKF U
ADTL

U12

10
UMUPF

U22

20 15 10
UMUPF UAUKF UADTL

5

UAUKF UADTL

U13

0

U23
UMUPF

5 0

-5 -5 -10 -10

10

15 10 5
UMUPF UAUKF UADTL

5

UAUKF UADTL

U14

0

U24
UMUPF UAUKF UADTL

0 -5

-5 -10 -10 -15

15 10 5 0 -5 -10

20 10 0 -10 -20 -30
UMUPF UAUKF UADTL

U15

15 10 5
UMUPF UAUKF UADTL

U25

40 30 20
UMUPF UAUKF UADTL

U16

0 -5 -10 -15 0 5 10 15 20

U26

10 0 -10 -20 0 5 10 15 20

Time (s)

Time (s)

Figure 5.15: Control law under external disturbances

ui = (ui1 , ui2 )T (i = 1, 2, · · · , 6).

134

5.3. Simulation Results and Discussion
4 3.5 3 2.5

AEM MUPF AEM AUKF AEM ADTL

AEM

2 1.5 1 0.5 0 0 2 4 6 8 10 12 14 16 18 20

Time (s)

(a) AEM
14

REMMUPF
12

REMAUKF REMADTL

10

8

REM
6 4 2 0 0 2 4 6 8 10 12 14 16 18 20

Time (s)

(b) REM

Figure 5.16: Absolute error metric and relative error metric under external disturbances.

135

Chapter 5. Online Estimation and Control of Multi-Agent Systems

5.3.4 Control command fault
In the following case, faults in the control command are applied at three intervals during a simulation time of

20-seconds.

The rst interval, between

0<t

2, the control command is K2i si )

operating under ideal conditions and is expressed by Equation (5.17). The rst fault occurs at

2<t

6;

where the fast terminal sliding manifolds (K1i si and

generate a zero

control input while the uncertain dynamics model and robust control laws are minimized by a constant negative parameter. In the third interval, between

6<t

20,

the control

command is recovered and expressed by Equation (5.17). The control commands and their corresponding time intervals are presented in Table 5.5.

Table 5.5: Constant applied control command.

Time [sec]

Control command

0<t 2<t 6<t

2 6 20

-1 ui = gi (-Wi i - K1i si - K2i si - i ), -1 ui = gi (-Wi i - i )

i = 1, 2, · · · , n i = 1, 2, · · · , n i = 1, 2, · · · , n

-0.0125 -0.0125

,

-1 ui = gi (-Wi i - K1i si - K2i si - i ),

Figures 5.17-5.21 present the simulation results for AUKF, MUPF and adaptive law. Figure 5.17 shows the estimation results of the uncertain dynamic model

^ ^ ^ T f i = (fi1 , fi2 ) (i =

1, 2, . . . , 6).

Figure 5.18 present the agent's state estimates x ^i

= (^ xi1 , x ^i2 )T (i = 1, 2, . . . , 6);

where, Figure 5.18 (a)-(b), are the state estimates using the adaptive law, Figure 5.18 (c)(d), are the state estimates using the adaptive unscented Kalman lter, and Figure 5.18 (e)(f ), are the state estimates using the marginalized unscented particle lter. present the agent's tracking error, Figure 5.19

ei = (ei1 , ei2 )T (i = 1, 2, . . . , 6),

under the constant

control laws; where, Figure 5.19 (a)-(b), are the tracking errors using the adaptive law, Figure 5.19 (c)-(d), are the tracking errors using the adaptive unscented Kalman lter, and Figure 5.19 (e)-(f ), are the tracking errors using the marginalized unscented particle lter. Figure 5.20 and show the control laws

ui = (ui1 , ui2 )T (i = 1, 2, · · · , 6).

Finally, the weights

of Chebyshev neural network are presented in Appendix C.4.

136

5.3. Simulation Results and Discussion
10
hf MUPF

6 4 2 0
hf MUPF hf AUKF hf ADTL

5

hf AUKF hf ADTL

hf 11

0

-5

hf 21
hf MUPF hf AUKF

-2 -4

-10

10

10
hf MUPF hf AUKF

5

hf ADTL

5

hf ADTL

hf 12

0

hf 22
0 -5 -5 4 2 0
hf MUPF hf hf
AUKF ADTL

10
hf MUPF

5

hf hf

AUKF ADTL

hf 13

-2 -4

hf 23
hf MUPF

0

-5 -6 -8 -10

10

10
hf MUPF

5

hf AUKF hf ADTL

5

hf AUKF hf ADTL

hf 14

0

hf 24
hf MUPF

0

-5

-5

-10

-10

10

10
hf MUPF

5

hf AUKF hf ADTL

5

hf AUKF hf ADTL

hf 15

0

hf 25
hf MUPF

0

-5

-5

-10

-10

10

10 5 0 -5
hf MUPF hf AUKF hf ADTL

5

hf AUKF hf ADTL

hf 16

0

-5

hf 26
0 5 10 15 20

-10 -15 0 5 10 15 20

-10

Time (s)

Time (s)

Figure 5.17: Estimation of uncertain dynamics model under a constant control command

^ ^ ^ T f i = (fi1 , fi2 ) (i = 1, 2, . . . , 6).

137

Chapter 5. Online Estimation and Control of Multi-Agent Systems
2

Agent 1ADTL
1.5

2.5

Agent 2ADTL Agent 3ADTL Agent 4ADTL Agent 5ADTL
State

Agent 1ADTL
2 1.5 1 0.5 0 -0.5

Agent 2ADTL Agent 3ADTL Agent 4ADTL Agent 5ADTL Agent 6ADTL

1

State

Agent 6ADTL
0.5

0

-0.5

-1
-1 0 2 4 6 8 10 12 14 16 18 20

2

4

6

8

10

12

14

16

18

20

Time (s)

Time (s)

(a) x ^i1ADT L
2 2.5

(b) x ^i2ADT L

Agent 1AUKF
1.5

Agent 2AUKF Agent 3AUKF Agent 4AUKF Agent 5AUKF

2 1.5 1

Agent 1AUKF Agent 2AUKF Agent 3AUKF Agent 4AUKF Agent 5AUKF Agent 6AUKF

1

State

0.5

State
20

Agent 6AUKF

0.5 0

0 -0.5 -0.5 -1 -1 0 2 4 6 8 10 12 14 16 18 0 2 4 6 8 10 12 14 16 18 20

Time (s)

Time (s)

(c) x ^i1AU KF
3
3

(d) x ^i2AU KF

Agent 1MUPF
2.5

Agent 2MUPF Agent 3MUPF Agent 4MUPF Agent 5MUPF Agent 6MUPF
State
0 1 2

Agent 1MUPF Agent 2MUPF Agent 3MUPF Agent 4MUPF Agent 5MUPF Agent 6MUPF

2

1.5

State

1

0.5
-1

0
-2

-0.5

-1 0 2 4 6 8 10 12 14 16 18 20

-3 0 2 4 6 8 10 12 14 16 18 20

Time (s)

Time (s)

(e) x ^i1M U P F

(f) x ^i2M U P F

Figure 5.18:

State estimates under a constant control command x ^i

1, 2, · · · , 6).

138

= (^ xi1 , x ^i2 )T (i =

5.3. Simulation Results and Discussion

1.5

2

Agent 1ADTL Agent 2ADTL Agent 3ADTL Agent 4ADTL
Tracking error
1.5 1 0.5 0 -0.5

Agent 1ADTL Agent 2ADTL Agent 3ADTL Agent 4ADTL Agent 5ADTL Agent 6ADTL

1

Tracking error

0.5

Agent 5ADTL Agent 6ADTL

0

-0.5 -1 -1 -1.5

0

2

4

6

8

10

12

14

16

18

20

0

2

4

6

8

10

12

14

16

18

Time (s)

Time (s)

(a) exi1ADT L
1.5 2

(b) exi2ADT L
Agent 1AUKF Agent 1AUKF
1.5 1

1

Agent 2AUKF Agent 3AUKF Agent 4AUKF
Tracking error

Agent 2AUKF Agent 3AUKF Agent 4AUKF Agent 5AUKF Agent 6AUKF

Tracking error

0.5

Agent 5AUKF Agent 6AUKF

0.5 0 -0.5

0

-0.5 -1 -1 -1.5

0

2

4

6

8

10

12

14

16

18

20

0

2

4

6

8

10

12

14

16

18

20

Time (s)

Time (s)

(c) exi1AU KF
1.5
2

(d) exi2AU KF

Agent 1MUPF
1

Agent 2MUPF Agent 3MUPF Agent 4MUPF Agent 6MUPF
Tracking error

Agent 1MUPF
1.5 1 0.5 0 -0.5 -1

Agent 2MUPF Agent 3MUPF Agent 4MUPF Agent 5MUPF Agent 6MUPF

0.5

Tracking error

Agent 5MUPF

0

-0.5

-1
-1.5

-1.5 0 2 4 6 8 10 12 14 16 18 20

-2 0 2 4 6 8 10 12 14 16 18 20

Time (s)

Time (s)

(e) exi1M U P F

(f) exi2M U P F

Figure 5.19:

Tracking error under a constant control command

1, 2, · · · , 6).

139

ei = (exi1 , exi2 )T (i =

Chapter 5. Online Estimation and Control of Multi-Agent Systems
10
UMUPF

5
UMUPF UAUKF

5

UAUKF UADTL

0

UADTL

U11

0

U21
-5 -10 5
U
MUPF

-5

-10

5

U

MUPF

0

UAUKF UADTL

UAUKF

0

UADTL

U12

-5

U22
-5 -10 20
UMUPF UAUKF

-10

-15

10

15 10

UMUPF UAUKF UADTL

5

UADTL

U13

U23
0 -5
10
UMUPF

5 0 -5 -10

10 5 0
UMUPF U
AUKF

5

U

AUKF

UADTL

UADTL

U14

0

U24
-5 -10 -15 10
UMUPF UAUKF UMUPF

-5

-10

20 15 10

0

UAUKF UADTL

UADTL

U15

5 0

U25
UMUPF

-10

-20 -5 -10 -30

20

40 30 20
UMUPF UAUKF UADTL

10

UAUKF UADTL

U16

0

U26
0 5 10 15 20

10 0

-10 -10 -20 -20 0 5 10 15 20

Time (s)

Time (s)

Figure 5.20:

Control input under a constant control command

ui = (ui1 , ui2 )T (i =

1, 2, · · · , 6).

140

5.3. Simulation Results and Discussion
4 3.5 3 0.06 2.5

AEM MUPF AEM AUKF AEM ADTL

AEM

0.04 2 0.02 1.5 1 0.5 0 0 2 4 6 8 10 12 14 16 18 20 0 15 16 17 18 19 20

Time (s)

(a) AEM
14

REMMUPF
12

REMAUKF REMADTL

10 0.06 8

REM

0.04 0.02 0 15

6

4

16

17

18

19

20

2

0 0 2 4 6 8 10 12 14 16 18 20

Time (s)

(b) REM

Figure 5.21: Absolute error metric and relative error metric under a constant control command.

141

Chapter 5. Online Estimation and Control of Multi-Agent Systems
5.4 Conclusions

In this chapter, nonlinear state and parameter estimation techniques were investigated with the purpose of estimating an uncertain dynamic model which describes the evolution of a distributed multi-agent system in consensus tracking. A nonlinear lter was developed

which is capable of joint estimation in an online setting. The proposed lter uses the RaoBlackwellised principle to couple the particle ltering technique with unscented transform principle. The new lter is called a marginalized unscented particle lter (MUPF). A

Chebyshev neural network (CNN) was incorporated to describe the uncertain dynamic models of the multi-agent system while nonlinear ltering policies were implemented to estimate the state of the multi-agent system and to train the internal parameters of the neural network as neatly as possible given a set of prior measurements. The proposed lter was compared to the performance of the adaptive unscented Kalman lter and Adaptive Law under fault-free and fault-prone conditions at the multi-agent dynamics and control commands.

142

Chapter 6

Conclusions

Nonlinear ltering involve estimation of the hidden state or parameters of interest given a sequence of measurements. Generally, the hidden state and parameters have an innite set of possible values in its domain and the objective of ltering is to estimate the posterior distribution,

i.e.,

an optimal estimate given evidence up to the current time. Computa-

tion of the required posterior distribution provide a complete solution of the estimation problem; however the computation involves complicated statistical procedures and it requires knowledge of the initial density, the transition density, and the likelihood function. Since most dynamic systems are inherently nonlinear, the application of nonlinear ltering is wide spread in several disciplines including communication, machine learning, system identication, nance, and many others. In this research, the primarily focus was directed to joint estimation using Bayesian algorithms with application in space systems. The work addresses a comparison between sub-optimal and non-optimal lters for applications in nonlinear and non-stationary dynamic processes. Throughout the thesis an attempt was made to redesign the non-optimal lters in such a way that under theoretical and well documented statistical procedures the lter will become sub-optimal. Few of these steps included the introduction of a properly selected importance sampling in particle weight calculations, introduction of a resampling (selection) procedure to reduce the degeneracy of the particles, reducing the resampling procedure by introduction of an eective sample size, reducing the variance of the particle lter by introduction of Rao-Blackwellised procedure etc. Throughout the work, a compared was made between the adaptive unscented Kalman lter (AUKF) and particle lter estimation techniques. The investigated lters were compared throughout the research and applied to the problems of Attitude estimation and control of monolithic spacecraft, distributed ltering for velocity-free attitude estimation of spacecraft formation ying, and, online estimation and control of multi-agent systems.

143

Chapter 6. Conclusions
6.1 Summary of Contributions

Estimation of a nonlinear dynamic system is practically challenging and an open issue which arises since the hidden state of the dynamic model cannot be measured directly. Instead, a measurement model is designed to estimate the hidden state of the dynamic system as it evolves with time. The estimation process is then used to characterize the

posterior distribution of the hidden state and parameter given the knowledge of the prior distribution and evidence from new measurements. The empirical evidence represents the sequence of measurements taken from the physical reality. In this research dierent ltering techniques have been applied to solve several estimations problems in space systems.

6.1.1 Attitude estimation and control of monolithic spacecraft
Online attitude estimation and control of monolithic spacecraft plays a major role in any space application and it requires to develop an accurate and stable online attitude estimation algorithm in order to increase the pointing capability of the spacecraft. This problem is well understood and many research has been published on the topic from dierent estimation and control perspectives. Attitude estimation in a sequential setting was investigated with the presence of faults and unknown angular velocity measurements under quaternion constraints. Generally,

online state estimation in attitude problems requires a sequential update of the attitude and angular velocity when new measurements become available. In this research, the

attention was directed to (1) estimation of spacecraft attitude and angular velocity in a sequential setting and in the absence of angular velocity measurements, and (2) study the behavior of the sequential nonlinear lters in the presence of faults and uncertainties at the spacecraft dynamics, control commands, and sensor measurements. Two nonlinear ltering techniques were investigated to estimate the attitude and angular velocity, namely, adaptive unscented Kalman lter and particle lter. In particle ltering technique, the multinomial resampling algorithm was implemented to sample from the target distribution. The PF

provided accurate attitude estimations since the particle representation of the posterior distribution are drawn at random rather than in a specic and deterministic manner as

144

6.1. Summary of Contributions
in the AUKF. Generally, the AUKF generate a small number of samples from a Gaussian distribution and that may not represent adequately a complicated posterior distribution of the attitude which may include bias i.e. skewness, kurtosis of distribution or measurement outliers.

6.1.2 Distributed attitude estimation and control of spacecraft formation ying
Distributed spacecraft formation ying (SFF) is an active research topic that deal with maintaining a desired formation between spacecraft in a distributed setting. challenge of the problem is the requirement to estimate relative state ( A major

i.e.,

position and

velocity) and relative attitude with respect to a local point of the spacecraft group. The state estimation of becomes a serious challenge in the presence of system faults and external disturbances which causes a drift in both relative positions and formation center of the spacecraft. An ecient and accurate distributed nonlinear ltering techniques was investigated with the purpose of estimating the unmeasurable angular velocity and reference angular acceleration of the SFF which is comprised of six spacecraft and a virtual leader which exchange partial information with other spacecraft in the formation. The modied Rodrigues parameters (MRP) are incorporated to describe the spacecraft attitude with respect to an inertial frame. Each spacecraft runs its own local lter to accurately ap-

proximate the posterior distribution of the unmeasurable angular velocity while a global distributed lter is incorporated to obtain a reference angular acceleration estimates of the virtual leader. The distributed lter is required since the virtual leader exchange only partial information with other spacecraft in formation. The adaptive unscented Kalman lter (AUKF) and particle lter (PF) techniques were investigated in parallel with a global distributed lter and an asymptotic output feedback control law to simultaneously track a common time-varying reference attitude while the reference attitude is available only to a subset of the spacecraft in the formation. A comparison is conducted between the

particle lter and adaptive unscented Kalman lter in terms of the accuracy of estimating the unmeasurable angular velocity with the purpose of decreasing the station-keeping and formation-keeping attitude errors.

145

Chapter 6. Conclusions

6.1.3 Online estimation and control of multi-agent systems
A multi-agent system distribute the task responsibilities among a number of individual agents, each operating with partial information of state estimates and response of other agents. When the dynamic model of the multi-agent system is not exact or partially known neural networks techniques can be used to estimate any smooth function to an arbitrary accuracy. Chebyshev neural network (CNN) was introduced to describe the uncertain dynamic models of the multi-agent system and nonlinear ltering techniques are implemented to estimate the state of the multi-agent system and to train the internal parameters of the neural network as neatly as possible given a set of prior measurements. A nonlinear lter has been proposed such that the lter couples the particle ltering algorithm with Rao-Blackwellised technique and unscented transform principle and applied the proposed lter in online joint estimation of an uncertain dynamic models which describe the evolution of a distributed multi-agent system in consensus tracking. The new lter is called marginalized unscented particle lter (MUPF). The idea behind the proposed lter is to partition the dynamic state space into two separate subspaces such that the posterior distribution can be updated analytically and eciently. One part of the decomposed state space is estimated using a sub-optimal adaptive unscented Kalman lter whereas the other is estimated using particle ltering technique. Since the rst part is estimated with a suboptimal lter instead of a pure sampling approach, the computing power is saved and the variance is reduced. Most of the emphasis was placed on accuracy of the joint estimation process, as well as the capacity to estimate CNN and determine the uncertain dynamics of the system. The MUPF, AUKF and the adaptive law were investigated under fault-free and fault-prone conditions at the multi-agent dynamics and control commands.

146

6.2. Future Work
6.2 Future Work

Nonlinear ltering techniques have become one of the standard tools in estimation theory which allow the Bayesian paradigm to be routinely applied to sophisticated nonlinear dynamic models. As the understanding of nonlinear ltering techniques increase and technology is available to deal with the computational demand of these algorithm, better estimations and posteriori distributions could be expected. In addition, we may expected to deal with high dimensionality of complex nonlinear dynamic models where both state and parameters are estimated simultaneously. There are still many issues with implementing nonlinear lters which provide consistent, ecient, robust, with minimal variance of estimations. The future direction of this research include implementation of dierent proposal distributions and testing new resampling strategies for sequential Monte Carlo ltering technique with the general idea of improving nonlinear ltering techniques.

6.2.1 Proposal distributions
The sequential importance sapling (SIS) algorithm includes an importance sampling which help to sample the distribution in the region of importance in order to achieve the computational eciently. Selecting an eective proposal distribution still lacks rigorous theoretical justication and essentially selecting a proposal distribution becomes a design problem. Therefore, selecting an appropriate proposal distribution is a key in to apply a successful importance sampling. Generally, the optimal proposal distribution is a distribution that minimizes the conditional variance given the latest measurement. In the scientic liter-

ature, many proposal distributions were reported including prior distribution, likelihood distribution, EKF as proposal distribution and unscented Kalman lter. The idea behind unscented Kalman lter (UPF) [van der Merwe

et al. 2000], [Wan & Van Der Merwe 2000]

is to use Gaussian approximation for the proposal distribution of the SIS algorithm. This result in a lter that perform better since the rate at which the tails of the proposal distribution reduce to zero can be controlled. This research can be extended by identifying better proposal distribution which will reduce the computational eciently of the algorithm.

147

Chapter 6. Conclusions

6.2.2 Resampling strategies
The resampling step avoids the degeneracy problem in sequential importance sampling (SIS) algorithm where after few iterations all but one particle have a negligible weight. The resampling step replicate particles with large weights and remove the ones with negligible weight. The scientic literature on resampling strategies identies many approached for

resampling in particle ltering setting. Few of the strategies include multinomial, residual, stratied and systematic resampling, residual resampling, local Monte Carlo resampling, stratied sampling, Gibbs sampling etc. In this research primarily focus was placed on The extension to this research will

multinomial resampling and systematic resampling.

focus on proposing and testing dierent resampling strategies in order to select important samples in a more ecient way.

6.2.3 Improved nonlinear ltering techniques
There are many unanswered question in nonlinear ltering theory especially when it comes to joint estimation in high-dimensional spaces. For example,

how to select a prior distribuAnother

tion in order to compute the required posterior distribution which minimize the variance?
This is indeed an unsolved issue in nonlinear ltering and control problems. question relies on the Principle of Total Evidence. In general, the ltering process should follow the Principle of Total Evidence where all relevant measurements should be utilized for computing an updated posterior distribution. Collecting measurements is essential for computing the posterior distribution which minimize the mean squared error of estimation. From a Bayesian perspective this is an important aspect and new measurements have to be incorporated once a measurement from the physical world becomes available. The question is,

how many measurements are needed to generate an ecient posterior distribution?.

There is no immediate answer to these questions but the idea is to propose an "optimal" nonlinear lter which satisfy the following properties:

· Consistency :

The lter is consistent if the posterior distribution converges to the true

state almost surly as the number of measurements approaches innity.

· Eciency :

The lter is ecient if it produces the smallest error covariance matrix

148

6.3. Concluding Remarks
among all unbiased lter.

· Minimum variance :
variance-reduction,

Variance reduction is the central issue of various Monte Carlo

approximation methods, most of the proposed improvements are geared towards

i.e., selecting proposal distribution and resampling strategies.

· Robustness :

The lter is robust if it is insensitive to the gross measurement errors

and the uncertainties in measurements.

· Unbiasedness :

An lter is unbiased if its posterior distribution is equal to the true

state or parameter of interest.

6.3

Concluding Remarks

Nonlinear ltering techniques provide a powerful means for estimating the hidden state of a dynamic systems given the trajectory of measurements. In this dissertation an investigation of dierent perspectives of nonlinear ltering and proposed a nonlinear lter for joint estimation. The primarily emphasis was the application in space systems where the dynamic equations are highly nonlinear. I hope this dissertation provided a greater exposure to the eld of space systems and nonlinear ltering techniques, and constitute a valuable source of information of various nonlinear ltering techniques which are applicable in the aerospace industry.

149

Appendices

Appendix A. Importance Sampling

Appendix A

Importance Sampling

Typically, at any time distribution

t,

it is impossible to sample eciently from the target posterior

p(x0:t | y1:t ).

Instead, we estimate

p(x0:t | y1:t )

using the well know

importance
from

sampling

method [Halton 1962]. The basic idea is simple and it is based on the following Let us introduce an arbitrary importance distribution

observations.

q (x0:t | y1:t ), q (·)

which it is easy to get samples, and suppose that

p(x0:t | y1:t )  q (x0:t | y1:t ).

In addition, called

(i) let x
the

 q (x) i = 1, ...Ns

be samples that are easily generated from a proposal

importance density 1 .

Then, a weighted approximation to the target density is given by

Ns

p(x0:t | y1:t ) 
i=1
where the weight

w ~0:t  (x0:t - x0:t )

( i)

( i)

(A.1)

w ~0:t 

(i)

p(x0:t | y1:t ) q (x0:t | y1:t )

(A.2)

(i) is a normalized weight of the ith particle where the samples x0:t were drown from importance
density

q (x0:t |y1:t ).

In a sequential setting, approximation of the posterior distribution

p(x0:t |y1:t )

at each iteration is possible given samples constituting an approximation to If the importance density is chosen to factorize such that

p(x0:t-1 |y1:t-1 ).

q (x0:t | y1:t ) = q (xt | x0:t-1 , y1:t )q (x0:t-1 | y1:t-1 )

(A.3)

(i) then one can obtain samples x0:t  q (x0:t | y1:t ) by augmenting each of the existing samples (i) ( i) x0:t-1  q (x0:t-1 | y1:t-1 ) with the new samples xt  q (xt | x0:t-1 , y1:t-1 ).

notation x(i)  q (x) means that the state hypothesis x(i) is "distributed according to" importance density q (x) for i = 0, . . . , Np .

1 The

152

Appendix B

Rao-Blackwellisation

The underlying principle of RBPF is the partition of a dynamic state space subspaces

z0:t

into two

x0:t and r0:t , such that the distribution p(r0:t , x0:t | y1:t ) can be updated analyti-

cally and eciently. Here the dynamic state space is decomposed into two parts, one part is being calculated exactly using Kalman lters whereas the other is estimated using particle lter. Since the rst part is estimated exactly, the computing power is saved and the variance is reduced. If we were able to sample according to by [Doucet

N

i.i.d. random samples

(r0:t , x0:t ) i = 1, . . . , N ,
( i) (i)

p(r0:t , x0:t | y1:t ), then an empirical estimate of this distribution would be given

et al. 2000]
p ^N (r0:t , x0:t | y1:t ) = 1 N
N

(r(i) ,x(i) ) (dr0:t , dx0:t )
0:t 0:t

(B.1)

i=1

where

(r(i) ,x(i) )
0:t 0:t

denotes the Direc delta function located at

(r0:t , x0:t ).
(i) ( i)

It is easy to estimate

the expected value of any function t of the hidden variable with respect to this distribution,

f

E(ft ),

using

¯ (ft ) = E = 1 N

ft (r0:t , x0:t )^ pN (r0:t , x0:t | y1:t )dr0:t , dx0:t
N i) (i) ft (r( 0:t , x0:t )

(B.2)

(B.3)

i=1

This estimate is unbiased and from the law of large numbers, surly towards

¯ (ft ) E

converges almost

E(ft )

as

N  .

Typically, it is impossible to sample eciently from

the posterior distribution

p(r0:t , x0:t | y1:t ) an any time t so we focus on alternative methods. p(r0:t , x0:t | y1:t )
and

One way to estimate

E(ft )

consists of using the well-known im-

portance sampling method. Lets introduce an arbitrary distribution

q (r0:t , x0:t | y1:t ),

from

153

Appendix B. Rao-Blackwellisation
which it is easy to sample then,

E(ft ) =

Eq(r0:t ,x0:t | y1:t ) (ft (r0:t , x0:t )w(r0:t , x0:t )) Eq(r0:t ,x0:t | y1:t ) (w(r0:t , x0:t )) p(r0:t , x0:t | y1:t ) q (r0:t , x0:t | y1:t )
distributed according to

(B.4)

where the importance weight is equal to

w(r0:t , x0:t ) =
Given

(B.5)

N

i.i.d. samples

(r0:t , x0:t ) i = 1, . . . , N
(i) ( i)

q (r0:t , x0:t | y1:t ),

a

perfect Monte Carlo estimate of

E(ft )

is given by

¯ (ft ) = E
N

(i) ( i) ( i) N i=1 t ( 0:t , 0:t )w ( 0:t , (i) (i) N i=1 w ( 0:t , 0:t )

f r

x

r

r x

i) x( 0:t )

(B.6)

=
i=1

w ~0:t ft (r0:t , x0:t )
( i) (i) (i)

(B.7)

where the normalizing importance weights

w ~0:t

(i)

are equal to

w ~0:t =

(i)

w(r0:t , x0:t )
(i) (i) N i=1 ( i)

w(r0:t , x0:t )
(i)

(B.8)

This method is equivalent to the following point mass approximation of

p(r0:t , x0:t | y1:t )
(B.9)

p ¯(r0:t , x0:t | y1:t ) =

N

w ~0:t (r(i) ,x(i) ) (dr0:t , dx0:t )
(i)
0:t 0:t

i=1

154

Appendix C

Parameter Estimation of Chebyshev Neural Network

In this section, we present the parameter of the hidden layer of a third-order Chebyshev Neural Network (CNN). The parameters were computed using the adaptive unscented Kalman lter (AUKF) and a marginalized unscented particle lter (MUPF). The parameters were calculated for various fault free and fault prone scenarios.

155

Appendix C. Parameter Estimation of Chebyshev Neural Network
C.1 Parameter estimation under fault-free scenario

2

0.5

1.5

1.5

0.4

1

1

0.3

0.5

0.5

0.2

0

W1

W2

0

0.1

W3
-0.5 0 -1 -0.1 -1.5 -0.2 -2 1.2 1 1 0.8 0.5 0.6 1.5 0.4 0.2

-0.5

-1

-1.5

0.6 0.4 0.2 0 -0.2 -0.4 -0.6 -0.8 -1 -1.2

W4

W5

W6 W9 W 12
0 2 4 6 8 10 12 14 16 18 20

0

-0.5 0 -1 -0.2 -0.4 -1.5

1 0.5

0.6

1.5

0.4 0 0.2 -0.5

1

0.5

W7

-1 -1.5

W8

0

0

-0.2 -2 -0.4 -2.5 -3 -0.6

-0.5

-1

-1.5

2 1.5

0.5

1

0.5 1 0 0.5 0

W 10

0 -0.5

W 11

-0.5 -0.5

-1 -1 -1.5 -2 0 2 4 6 8 10 12 14 16 18 20 -1 -1.5 0 2 4 6 8 10 12 14 16 18 20

Time

Time

Time

156

C.1. Parameter estimation under fault-free scenario
1.5 2 1.5 1 1 0.5 0.5 0 -0.5 -0.5 -1 -1.5 -1 -2 -1.5 -2.5 -0.5 0 0.5 1

W 13

W 14

0

2 1.5 1 0.5

1.5 1 0.5 0 -0.5 -1

W 15
0.7 0.6 0.5 0.4 0.3 0.2 0.1 0 -0.1 -0.2

W 16

W 17

0 -0.5

-1.5 -1 -1.5 -2 -2 -2.5 -3

2 1.5

1

W 18 W 21 W 24
2 1 0

0.4

0.5 1 0 0.5

0.2

0

-0.2

W 19

0 -0.5

W 20

-0.5

-0.4 -1 -1 -1.5 -1.5 -2 -2 -0.6

-0.8

-1

2.5 2 1.5

2.5

2

2

1.5

1.5 1 0.5 0 -0.5 0 -1 -1.5 -2 -0.5 -0.5 1 1

W 22

W 23

0.5

0.5 0

-1

-1

2

1.5

1

0.5

W 25

W 26
0 -0.5 -1 -1.5 0 2 4 6 8 10 12 14 16 18 20

-1

-2

-3

-4 0 2 4 6 8 10 12 14 16 18 20

Time (s)

Time (s)

Figure C.1.1: Parameter estimation with adaptive unscented Kalman lter.

157

Appendix C. Parameter Estimation of Chebyshev Neural Network
2 0.5 1.5

1.5

0.4

1

1

0.3

0.5

0.5

0.2

0

W1

W2

0

0.1

W3
-0.5 0 -1 -0.1 -1.5 -0.2 -2 1 1.5 0.8 1 0.6 0.5 0.4

-0.5

-1

-1.5

0.6 0.4 0.2 0 -0.2 -0.4 -0.6 -0.8

W4

W5

W6 W9 W 12
0 2 4 6 8 10 12 14 16 18 20

0

0.2

-0.5

0 -1 -1.2 -0.2

-1

-1.5

0.5

0.6

1.5

0

0.4

1

-0.5 0.2 -1 0.5

W7

W8

0

0

-1.5 -0.2 -2 -0.4 -1 -0.5

-2.5

-3

-0.6

-1.5

2 1.5

0.5

1

0.5 1 0 0.5 0

W 10

0 -0.5

W 11

-0.5 -0.5

-1 -1 -1.5 -2 0 2 4 6 8 10 12 14 16 18 20 -1 -1.5 0 2 4 6 8 10 12 14 16 18 20

Time

Time

Time

158

C.1. Parameter estimation under fault-free scenario
1.5 2 1.5 1 1 0.5 0.5 0.4 1

0.8

0.6

W 13

W 14

0

0 -0.5

W 15
0.2 0 -0.2 -0.4 0.7 0.6 0.5 0.4 0.3 0.2 0.1 0 -0.1 -0.2

-0.5 -1 -1 -1.5 -1.5 -2

2

1.5 1 0.5

1.5

1 0 0.5 -0.5 -1 -1.5 -0.5 -2 -1 -2.5 -3

W 16

W 17

0

-1.5

1.5

1

W 18 W 21 W 24
1.5 1 0.5 0 -0.5

0.4

1

0.5

0.2

0.5 0 0 0

W 19

W 20

-0.5

-0.2

-0.5 -1 -1 -1.5 -0.6 -0.4

-1.5

-2

-2

-0.8

2 1.5 1 0.5

2.5

2

2 1.5 1.5 1

1

W 22

0 -0.5 -1 -1.5 -2

W 23
0.5

0.5

0 0 -0.5

-1

-0.5

2

1.5

1

0.5

W 25

W 26
0 -0.5 -1 -1.5 0 2 4 6 8 10 12 14 16 18 20

-1 -1.5 -2 -2.5 -3 -3.5 0 2 4 6 8 10 12 14 16 18 20

Time (s)

Time (s)

Figure C.1.2: Parameter estimation with marginalized unscented particle lter.

159

Appendix C. Parameter Estimation of Chebyshev Neural Network
C.2 Parameter estimation under uncertainty in dynamics model

2 1.5 1 0.5

4 3.5 3 2.5

2 1.5 1 0.5

W1

W2

0 -0.5

W3 W6 W9 W 12
0 2 4 6 8 10 12 14 16 18 20

2 1.5

0 -0.5

1 -1 -1.5 -2 0.5 0 -0.5 -1 -1.5 -2

2

2

2

0

1.5

1.5

-2 1 -4

1

0.5

W4

W5
-6

0.5

0 0

-8 -0.5

-0.5

-10

-1

-12

-1

-1.5

3 2

1

2.5 2

0.5 1 0 1.5 1 0.5 0 -0.5 -1 -4 -5 -1.5 -1 -1.5

0

W7

-1 -2 -3

W8
-0.5

5 4 3

1

2

0.5

1

0 2 -0.5

0

-1

W 10

1 0 -1 -2 -3 0 2 4 6 8 10 12 14 16 18 20

W 11

-1

-2

-1.5

-3

-2

-4

-2.5

-5 0 2 4 6 8 10 12 14 16 18 20

Time

Time

Time

160

C.2. Parameter estimation under uncertainty in dynamics model
7 6 5 1 4 3 0.5 2 1.5 3 2.5 2 1.5 1 0.5 1 0 -1 -1 -2 -3 -1.5 -2 -0.5 0 -0.5 -1 -1.5

W 13

W 14

2

0

2 1.5 1 0.5

4

W 15 W 18 W 21 W 24
2 0 -2 -4

8 7 6

2

0 5 -2 4 3 2

W 16

0 -0.5 -1 -1.5 -2

W 17
-4 -6

1 -8 0 -1

-10

2 1.5

5

5

0 1 -5 0.5

4

3

W 19

0 -0.5

W 20

-10

2

-15 -1 -20 -1.5 -2 -25

1

0

-1

2 1 0 -1

4 2

5

4 0 -2 -4 -6 -3 -8 -4 -5 -6 -10 0 -12 -14 -1 1 3

W 22

-2

W 23

2

5

4

3

2

W 25

1

W 26
-6 0 -8 -1 -10 -2 0 2 4 6 8 10 12 14 16 18 20 -12 0 2 4 6 8 10 12 14 16 18 20

Time (s)

Time (s)

Figure C.2.1: Parameter estimation under uncertainty of dynamic model using adaptive unscented Kalman lter.

161

Appendix C. Parameter Estimation of Chebyshev Neural Network
2 1.5 1 0.5 4 3.5 3 2.5 0.5 2 1.5 -0.5 1 -1 -1.5 -2 0.5 0 -0.5 -1 -1.5 -2 -0.5 2 1.5 1

W1

W2

0

W3 W6 W9
0 2 4 6 8 10 12 14 16 18 20

0

2

2

2.5 2

0

1.5 1.5 1 1

-2

-4

W4

W5

0.5

0.5 0

-6 0 -8 -0.5 -1 -1 -1.5 -0.5

-10

-12

3 2

1

2.5 2

0.5 1 0 1.5 1 0.5 0 -0.5 -1 -4 -5 -1.5 -1 -1.5

0

W7

-1 -2 -3

W8
-0.5 1

5 4 3 2

2

0.5

1

0

0

-0.5

-1

W 10

W 11

1 0 -1 -2 -3 0 2 4 6 8 10 12 14 16 18 20

-1

W 12
-2 -1.5 -3 -2 -4 -2.5 -5 0 2 4 6 8 10 12 14 16 18 20

Time

Time

Time

162

C.2. Parameter estimation under uncertainty in dynamics model
7 6 5 1 4 3 0.5 2 1.5 3 2.5 2 1.5 1 0.5 1 0 -1 -1 -2 -3 -1.5 -2 -0.5 0 -0.5 -1 -1.5

W 13

W 14

2

0

W 15

2 1.5 1

5

8 7 6

0 0.5

5 4 3

W 16

0 -0.5

W 17

W 18
-5 -10 5 0 -5 -10

2 1 0 -1

-1 -1.5 -2

2 1.5

5

4

1 3 0.5

W 19

W 20

0 -0.5

W 21 W 24
2 0 -2 -4

2

-15 -1 -20 -1.5 -2 -25

1

0

-1

2 1 0 -1

4 2 0 -2 -4 -6

4.5 4 3.5 3 2.5

W 22

-2 -3

W 23

2 1.5

-8 -4 -5 -6 -10 -12 -14

1 0.5 0 -0.5

5

4

3

2

W 25

1

W 26
-6 0 -8 -1 -10 -2 0 2 4 6 8 10 12 14 16 18 20 -12 0 2 4 6 8 10 12 14 16 18 20

Time (s)

Time (s)

Figure C.2.2: Parameter estimation under uncertainty of dynamic model using marginalized unscented particle lter.

163

Appendix C. Parameter Estimation of Chebyshev Neural Network
C.3 Parameter estimation under external disturbances

2 1.5 1

7 6

4

3 5

0.5 0 4

2

W1

W2

-0.5 -1 -1.5

3 2

W3 W6 W9 W 12
0 2 4 6 8 10 12 14 16 18 20

1

0 1

-2 -2.5 -3 0 -1

-1

-2

5

0.5 0

5

4

0

-0.5 3 -1

-5

W4

W5

-1.5 -2

2

-10 -2.5

1

0 -15 -3 -3.5 -20 -4 -1

-2

12

2.5 2 1.5 1

5 4 3 2 1 0 -1 -2 -3

10

8

6

W7

W8
4 2 0 -2

0.5 0 -0.5 -1 -1.5

6

4 3 2 1

2 1 0 -1 -2 -3 -4 -5 -6 0 2 4 6 8 10 12 14 16 18 20

4

2

0

W 10

W 11
-2 -4 -6 -8 0 2 4 6 8 10 12 14 16 18 20

0 -1 -2 -3 -4

Time

Time

Time

164

C.3. Parameter estimation under external disturbances
10 2 1.5 5 1 0.5 0 -1 0 -0.5 -5 -1 -1.5 -2 -15 -2.5 -2.5 -3 -3.5 -2 0.5 0 -0.5

W 13

W 14

W 15
8 6 4 2 0 2 0 8 6 4 2 0 2 1 0 -1

-1.5

-10

2 1.5 1 0.5 0 -0.5

10

3.5 3 2.5 2

W 16

W 17

W 18 W 24 W 26
-2 -3 -4 -5 -6 14 16 18 20 0 2 4 6 8 10

1.5 1

-1 -1.5 -2 -2.5

0.5 0 -2 -0.5

3

4

2

3

1 -2 0

2

1

W 19

W 20

-4

-1 -6 -2 -8

W 21
0 -1 -2 -3 2.5 2 1.5 1 0.5 0 -0.5 -1 12

-3

-4

-10

2.5 2 1.5 1 0.5

W 22

0 -0.5 -1 -1.5 -2 -2.5

W 23
4 3 2

-2 -4 -6 -8 -10

W 25

1

0

-1

-2 0 2 4 6 8 10 12

14

16

18

20

Time (s)

Time (s)

Figure C.3.1: Parameter estimation under external disturbances using adaptive unscented Kalman lter.

165

Appendix C. Parameter Estimation of Chebyshev Neural Network
2 1.5 1 5 0.5 0 4 2 7 6 3 4

W1

W2

-0.5 -1 -1.5

3 2

W3 W6 W9 W 12
0 2 4 6 8 10 12 14 16 18 20

1

0 1

-2 -2.5 -3 0 -1

-1

-2

5

0.5 0

5

4

0

-0.5 3 -1

-5

W4

W5

-1.5 -2

2

-10 -2.5

1

0 -15 -3 -3.5 -20 -4 -1

-2

12

2.5 2 1.5 1

5 4 3 2 1 0 -1 -2 -3

10

8

6

W7

W8
4 2 0 -2

0.5 0 -0.5 -1 -1.5

6

4 3 2 1

2 1 0 -1 -2 -3 -4 -5 -6 0 2 4 6 8 10 12 14 16 18 20

4

2

0

W 10

W 11
-2 -4 -6 -8 0 2 4 6 8 10 12 14 16 18 20

0 -1 -2 -3 -4

Time

Time

Time

166

C.3. Parameter estimation under external disturbances
10 8 6 4 2 2 1.5 1 0.5 -1 0 -0.5 -2 -4 -6 -8 -10 -1 -1.5 -2 -2.5 -2.5 -3 -3.5 -2 0.5 0 -0.5

W 13

W 14

W 15 W 18 W 24
2 1 0 -1

0

-1.5

2 1.5

10

3.5 3

8 1 0.5 0 -0.5 1 -1 -1.5 0 -2 -2.5 -2 0 -0.5 2 0.5 6 2 2.5

W 16

W 17

4

1.5

3

2

4

2

0

3

1 -2 0

2

1

W 19

W 20

-4

-1 -6 -2 -8

W 21
0 -1 -2 -3 2.5 2 1.5 1 0.5 0 -0.5 -1

-3

-4

-10

2.5 2 1.5 1 0.5

8 6 4 2 0 -2

W 22

0 -0.5 -1 -1.5 -2 -2.5

W 23
4 3 2

-4 -6 -8 -10

W 25

W 26
0 2 4 6 8 10 12 14 16 18 20

1

-2 -3

0 -4 -1 -5 -2 -6 0 2 4 6 8 10 12 14 16 18 20

Time (s)

Time (s)

Figure C.3.2: Parameter estimation under external disturbances using marginalized unscented particle lter.

167

Appendix C. Parameter Estimation of Chebyshev Neural Network
C.4 Parameter estimation under constant applied control command

2

0.6 0.5 0.4 0.3

1.5

1.5

1

1

0.5

0.5

0

W1

W2

0.2 0.1

0

W3
-0.5 -1 -1.5 -2 1.5 1 0.5

-0.5

0 -0.1 -0.2

-1

-1.5

1

1.2

1 0.5 0.8 0

0.6

W4

W5

W6
0.4 0.2 0 -0.2 0.6 0.4 0.2 0

0

-0.5

-0.5

-1

-1

-1.5

-1.5

12

1.5

10

1

8 0.5

6

W7

W8

W9 W 12
0 2 4 6 8 10 12 14 16 18 20

0

4 -0.2 2 -0.4 -1 -0.5

0

-2

-0.6

-1.5

1.5

0.4

1

1

0.2 0.5

0.5

0 0

0

-0.2

W 10

-0.5

W 11
-0.4

-0.5

-1

-0.6 -1

-1.5

-0.8

-2 0 2 4 6 8 10 12 14 16 18 20

-1

-1.5 0 2 4 6 8 10 12 14 16 18 20

Time

Time

Time

168

C.4. Parameter estimation under constant applied control command
1.5 2 1.5 1 1 0.5 0.5 0.6 0.8 1.2 1

W 13

W 14

0

0 -0.5

W 15
1 0

0.4 0.2 0 -0.2 -0.4

-0.5 -1 -1 -1.5 -1.5 -2

2 1.5 1 0.5

1.5

0.7 0.6 0.5 0.4 0.3 0.2 0.1 0 -0.1 -0.2

0.5

W 16

W 17

0 -0.5

-1 -1.5 -1 -1.5 -2 -2 -2.5 -3

2 1.5

1

W 18 W 21 W 24
1.5 1 0.5 0 -0.5

-0.5

0.4

0.5 1 0 0.5

0.2

0

W 19

0 -0.5

W 20

-0.5

-0.2

-1 -1 -1.5 -1.5 -2 -2

-0.4

-0.6

-0.8

2 1.5 1 0.5

2.5

2

2

1.5

1.5 1 1

W 22

0 -0.5

W 23

0.5

0.5 0 -1 -1.5 -2 0 -0.5

-0.5

-1

-1

2

1.5

1

0.5

W 25

W 26
0 -0.5 -1 -1.5 0 2 4 6 8 10 12 14 16 18 20

-1 -1.5 -2 -2.5 -3 -3.5 0 2 4 6 8 10 12 14 16 18 20

Time (s)

Time (s)

Figure C.4.1: Parameter estimation under constant applied control commands using adaptive unscented Kalman lter.

169

Appendix C. Parameter Estimation of Chebyshev Neural Network
2 0.6 0.5 0.4 0.3 0.5 0 1.5

1.5

1

1

0.5

W1

W2

0.2 0.1

0

W3
-0.5 -1 -1.5 -2 1.5 1 0.5

-0.5

0 -0.1 -0.2

-1

-1.5

1

1.2

1 0.5 0.8 0

0.6

W4

W5

W6
0.4 0.2 0 -0.2 0.6 0.4 0.2 0

0

-0.5

-0.5

-1

-1

-1.5

-1.5

0.5 0

1.5

1

-0.5 0.5 -1

W7

W8

-1.5 -2

W9 W 12
0 2 4 6 8 10 12 14 16 18 20

0

-0.2 -2.5 -0.4 -3 -3.5 -0.6

-0.5

-1

-1.5

1.5

0.4

1

1

0.2 0.5

0.5

0 0

0

-0.2

W 10

-0.5

W 11
-0.4

-0.5

-1

-0.6 -1

-1.5

-0.8

-2 0 2 4 6 8 10 12 14 16 18 20

-1

-1.5 0 2 4 6 8 10 12 14 16 18 20

Time

Time

Time

170

C.4. Parameter estimation under constant applied control command
1.5 2 1.5 1 1 0.5 0.5 0.6 0.8 1.2 1

W 13

W 14

0

0 -0.5

W 15 W 18 W 21 W 24
1.5 1 0.5 0 -0.5

0.4 0.2 0 -0.2 -0.4

-0.5 -1 -1 -1.5 -1.5 -2

2 1.5 1 0.5

1.5 1 0.5 0 -0.5 -1

0.7 0.6 0.5 0.4 0.3 0.2 0.1 0 -0.1 -0.2

W 16

0 -0.5

W 17

-1.5 -1 -1.5 -2 -2 -2.5 -3

2 1.5

1

0.4

0.5 1 0 0.5

0.2

0

W 19

0 -0.5

W 20

-0.5

-0.2

-1 -1 -1.5 -1.5 -2 -2

-0.4

-0.6

-0.8

2 1.5 1 0.5

2.5

2

2

1.5

1.5 1 1

W 22

0 -0.5

W 23

0.5

0.5 0 -1 -1.5 -2 0 -0.5

-0.5

-1

-1

2

1.5

1

0.5

W 25

W 26
0 -0.5 -1 -1.5 0 2 4 6 8 10 12 14 16 18 20

-1 -1.5 -2 -2.5 -3 -3.5 0 2 4 6 8 10 12 14 16 18 20

Time (s)

Time (s)

Figure C.4.2:

Parameter estimation under constant applied control commands using

marginalized unscented particle lter.

171

Bibliography

Bibliography
[Abreu 2011] Abreu, Noel.

Fault diagnosis with adaptive kalman lters and CMG design
Master's thesis, Ryerson University, 2011. 24

for picosatellite ACS.
[Akritas

et al. 2000]

Akritas, P., Antoniou, I, & Ivanov, V.V., Identication and prediction

of discrete chaotic maps applying a Chebyshev neural network,

Chaos, Solitons &

Fractals, Vol. 11, No. 1, 2000, Pages:
[Andrieu

337344. 33

et al. 2001]

Andrieu, Christophe, de Freitas, Nando, & Doucet, Arnaud, Rao-

Blackwellised Particle Filtering via Data Augmentation,

Advances in Neural Infor-

mation Processing Systems 14 [Neural Information Processing Systems: Natural and Synthetic, NIPS 2001, December 3-8, 2001, Vancouver, British Columbia, Canada],
2001, Pages: 561567. 102

[Arnaud Doucet 2001] Arnaud Doucet, Nando de Freitas, Neil Gordon,

Sequential Monte
11, 22, 31

Carlo Methods in Practice, Springer Science+Business Media Inc., 2001.
[Arulampalam

et al. 2002]

Arulampalam, Sanjeev, Simon, Maskell, Neil, Gordon, & Clapp,

Tim, A Tutorial on Partticle Filters for on-line nonlinear/non-Gaussian Bayesian Tracking,

IEEE Transactions on Signal Processing,

Vol. 2, 2002, Pages: 174188.

9, 11, 46, 101

[Basios

et al. 1997]

Basios, V., Bonushkina, A.Yu, & Ivanov, V.V., A method for approx-

imating one-dimensional functions,

Computers & Mathematics with Applications,

Vol. 34, No. 7-8, Oct, 1997, Pages: 687693. 33

[Battin 1961] Battin, Richard H., A Statistical Optimizing Navigation Procedure for Space Flight,

MIT Instrumentation Laboratory, Vol. R-341, September, 1961.

5

[Battin 1964] Battin, Richard,

Astronautical Guidance, McGraw-Hill New York, 1964. Neural Networks for Pattern Recognition,

8

[Bishop 1995] Bishop, Christopher M.,

Oxford

University Press, Inc., New York, NY, USA, 1995. 103

172

Bibliography
[Bucy & James 1962] Bucy, Richard, & James, Follin Jr. W., Adaptive nite time ltering,

IRE Transactions on Automatic Control,

Vol. 7, No. 4, July, 1962, Pages:

1019. 8 [Candy 2009] Candy, James V.,

Bayesian Signal Processing: Classical, Modern, and Par22

ticle Filtering Methods, John Wiley & Sons, Hoboken, New Jersey, USA, 2009.

[Carlton & James 1956] Carlton, AG, & James, Follin Jr. W., Recent developments in xed and adaptive ltering,

NATO Advanced Group for Aerospace R&D, AGAR-

Dograph, Vol. 21, 1956.
[Carpenter

8

et al. ]

Carpenter, James, Cliord, Peter, & Fearnhead, Paul, An Improved

Particle Filter for Non-linear Problems,

Department of Statistics, University of In-

Oxford, UK.

86

[Carpenter 2002] Carpenter, J. Russell, Decentralized control of satellite formations,

ternational Journal of Robust and Nonlinear Control,
March, 2002, Pages: 141161. 78

Vol. 12, No. 2-3, February-

[Casella & Robert 1996] Casella, George, & Robert, Christian P., Rao-Blackwellisation of sampling schemes,

Biometrika, Vol. 83, No. 1, 1996, Pages:

8194. 102, 104

[Chen & Liu 2000] Chen, Rong, & Liu, Jun S., Mixture Kalman Filters,

Journal of the

Royal Statistical Society. Series B., Vol. 62, No. 3, 2000, Pages:
[Chen

493508. 104

et al. 2010]

Chen, Junli, Wang, Xiaoliang, Shao, Xiaowei, & Duan, Dengping, An

integrated Relative Navigation system using GPS/VISNAV for ultra-close spacecraft formation ying,

2010 3rd International Symposium on Systems and Control in
803808. 78

Aeronautics and Astronautics, 2010, Pages:

[Chen 2003] Chen, Zhe, Bayesian Filtering: From Kalman Filters to Particle Filters and Beyond, 2003. 7, 11, 21, 46, 86, 101 [Cheng & Crassidis 2004] Cheng, Yang, & Crassidis, John L., Particle Filtering for Sequential Spacecraft Attitude Estimation,

AIAA Guidance, Navigation, and Control
118. 40, 41

Conference and Exhibit, Vol. AIAA 2004-5337, 2004, Pages:

173

Bibliography
[Crisan & Rozovskii 2011] Crisan, Dan, & Rozovskii, Boris,

The Oxford Handbook of Non-

linear Filtering, Oxford University Press, 2011.

6

[de Freitas 2002] de Freitas, Nando, Rao-Blackwellised particle ltering for fault diagnosis, 109

IEEE, Aerospace Conference Proceedings, Vol. 4, 2002, Pages:

17671772. 104,

[Del Moral 1996] Del Moral, Pierre, Non Linear Filtering: Interacting Particle Solution,

Markov Processes and Related Fileds, Vol. 2, No. 4, 1996, Pages:
[Douc

555580. 11

et al. 2005]
46

Douc, Randal, Cappé, Olivier, & Moulines, Eric, Comparison of Re-

sampling Schemes for Particle Filtering, . ISSN: 1845-5921, 2005, Pages: 6469.

[Doucet & Johansen 2008] Doucet, Arnaud, & Johansen, Adam M., A tutorial on particle ltering and smoothing: fteen years later, 2008. 11, 101

[Doucet

et al. 2000]

Doucet, Arnaud, Freitas, Nando de, Murphy, Kevin P., & Russell,

Stuart J., Rao-Blackwellised Particle Filtering for Dynamic Bayesian Networks,

Proceedings of the 16th Conference on Uncertainty in Articial Intelligence,
Inc. 102, 104, 153

UAI

'00, San Francisco, CA, USA, 2000, Pages: 176183. Morgan Kaufmann Publishers

[Doucet 1998] Doucet, Arnaud. On sequential simulation-based methods for bayesian ltering, . Rapport technique, Signal Processing Group, Department of Engineering University of Cambridge CB2 1PZ Cambridge, 1998. 104, 109

[Farrell 1970] Farrell, J.L., Attitude Determination by Kalman Filtering, Vol. 6, 1970, Pages: 419430. 38

Automatica,

[Fong

et al. 2002]

Fong, Willian, Godsill, Simon, Doucet, Arnaud, & West, Mike, Monte

Carlo Smoothing with Application to Audio Signal Enhancement,

IEEE Transac-

tions on Signal Procesing, Vol. 50, No. 2, 2002, Pages:

438449. 104

174

Bibliography
[Gordon & Smith 1993] Gordon, N.J., Salmond D.J., & Smith, A.F.M., Novel approach to nonlinear non-Gaussian Bayesian state estimation, No. 2, April 1993, Pages: 34603467. 11, 40, 101

IEEE Proceedings, Vol. 140,

[Grewal S. Mohinder 2010] Grewal S. Mohinder,

Andrews P. Angus,

Applications of

Kalman Filtering in Aerospace 1960 to the Present,

IEEE Control Systems Maga-

zine, Vol. 30, No. 3, June, 2010, Pages:

6978. 9, 38

[Halton 1962] Halton, John H, Sequential monte carlo,

Mathematical Proceedings of the

Cambridge Philosophical Society,
78. 152

Vol. 58. Cambridge Univ Press, 1962, Pages: 57

[Haug 2005] Haug, A.J.

A tutorial on Bayesian Estimation and Tracking Techniques

Applicable to Nonlinear and Non-Gaussian Processes, . Rapport technique Case 05-0211, MITRE Corporation Technical Report, February, 2005. 86

[Hol

et al. 2007]

Hol, Jeroen, Schön, Thomas, & Gustafsson, Fredrik.

On Resampling

Algorithms for Particle Filters, . Technical report LiTH-ISY-R-2766, Automatic Control at Linköpings Universitety, January, 2007. 46

[Hughes 1986] Hughes, P. C.,

Spacecraft attitude dynamics, Wiley, New York, 1986. Stochastic Processes and Filtering Theory,

42, 82

[Jazwinski 1970] Jazwinski, Andrew H., 19

1970.

[Jin & Sun 2008] Jin, Erdong, & Sun, Zhaowei, Robust controllers design with nite time convergence for rigid spacecraft attitude tracking control,

Aerospace Science and

Technology, Vol. 12, No. 4, 2008, Pages:
[Johansen

324330. 43

et al. 2012]

Johansen, Adam M., Whiteley, Nick, & Doucet, Arnaud, Exact ap-

proximation of Rao-Blackwellised particle lters,

16th IFAC Symposium on System
System Identication,

Identication, SYSID 2012, Brussels, Belgium. Published in:
Vol.16 (No.1). pp. 488-493, July, 2012. 104

175

Bibliography
[Julier & Uhlmann 1997] Julier, Simon J., & Uhlmann, Jerey K., New extension of the Kalman lter to nonlinear systems,

Proceedings of the SPIE - The International
182193. 10, 22, 101

Society for Optical Engineering, Vol. 3068, 1997, Pages:

[Kalman & Bucy 1961] Kalman, R.E, & Bucy, R.S., New Result in Linear Filtering and Prediction Theory,

Transactions of ASME, Series D, Journal of Basic Engineering,

Vol. 83, March, 1961, Pages: 95107. 8

[Kalman 1960] Kalman, R.E, A New Approach to Linear Filtering and Prediction Problem,

Transactions of ASME Series D, Journal of Basic Engineering,

Vol. 82,

March, 1960, Pages: 3445. 5, 8

[Kang

et al. 2001]

Kang, Bryan H., Hadaegh, Fred Y., & Scharf, Daniel P., Ke Nain-

Ping, Decentralized and self-centered estimation architecture for formation ying of spacecraft,

16th International Symposium on Space Flight Dynamics; Pasadena,
76

CA, United States, December, 2001.
[Kim

et al. 2007]

Kim, Son-Goo, Crassidis, John L., Cheng, Yang, Fosbury, Adam M., &

Junkins, John L., Kalman Filtering for Relative Spacecraft Attitude and Position Estimation,

Journal of Guidance, Control, and Dynamics,

Vol. 30, No. 1, 2007,

Pages: 133143. 78

[Kitagawa 1996] Kitagawa, Genshiro, Monte Carlo lter and smoother for non-Guassian non-linear state space models,

Journal of Computational and Graphical Statistics,

Vol. 5, 1996, Pages: 125. 11, 86

[Kitagawa 1998] Kitagawa, Genshiro, A self-orgenizing state-space model,

Journal of

Americal Statistical Associateion, Vol. 93, 1998, Pages:

12031215. 11

[Lee & Jeng 1998] Lee, Tsu-Tian, & Jeng, Jin-Tsong, The Chebyshev-Polynomials-Based Unied Model Neural Networks for Function Approximation,

IEEE Transactions

on Systems, Man, and Cybernatics, Part B: Cybernatics, Vol. 28, No. 6, December,
1998, Pages: 925935. 33

176

Bibliography
[Leerts

et al. 1982]

Leerts, E., Markley, F., & Shuster, M., Kalman Filtering for Space-

craft Attitude Estimation,

Journal of Guidance, Control, and Dynamics,

Vol. 5,

No. 5, September-October, 1982, Pages: 417429. 38

[Lin 2014] Lin, Arthur Kar Leaung. Control of Spacecraft Formation Flying Around Asteriods, . PhD thesis, Ryerson University, 2014. 103

[Lin 2015] Lin, Chih-Hong, Adaptive recurrent Chebyshev neural network control for PM synchronous motor servo-drive electric scooter with V-belt continuously variable transmission,

International Journal of Adaptive Control and Signal Processing,

Vol. 29, 2015, Pages: 805834. 33

[Liu & Chen 1998] Liu, Jun S., & Chen, Rong, Sequential Monte Carlo Methods for Dynamic Systems,

Journal of the American Statistical Association,

Vol. 93, 1998,

Pages: 10321044. 32

[Liu 2008] Liu, Jun S.,

Monte Carlo Strategies in Scientic Computing, Springer Publishing

Company, Incorporated, 2008. 31

[Mall & Chakraverty 2014] Mall, Susmita, & Chakraverty, S., Chebyshev Neural Network Based Model for Solving Lane-Emden Type Equations, Vol. 247, No. C, nov, 2014, Pages: 100114. 33

Appl. Math. Comput.,

[Mark L. Psiaki 1990] Mark L. Psiaki, Francois Martel, Parimal K. Pal, Three-axis attitude determination via Kalman ltering of magnetometer data,

Journal of Guid-

ance, Control, and Dynamics, Vol. 13, No. 3, 1990, Pages:

506514. 38

[Martin E. Liggines 2009] Martin E. Liggines, David L. Hall, James Llinas,

Handbook of

Multisensor Data Fusion: Theory and Practice, 2nd ed.,
Francis Group, Boca Raton, FL, USA, 2009. 8, 20

CRC Press, Taylor &

[Metropolis & Ulam 1949] Metropolis, Nicholas, & Ulam, Stanislaw, The Monte Carlo Method,

Journal of the American Statistical Association, Vol. 44, No. 247, Septem-

ber, 1949, Pages: 335341. 25

177

Bibliography
[Metropolis 1987] Metropolis, Nicholas, The Begining of the Monte Carlo Method,

Los

Almos Science,Special Issue, Stanislaw Ulam 1909-1984, No. 15, 1987, Pages:
130. 25

125

[Murphy & Russell 2001] Murphy, Kevin, & Russell, Stuart,

Rao-Blackwellised Particle

Filtering for Dynamic Bayesian Networks, A. Doucet, J. F. G. de Freitas, and N. J.
Gordon, Springer-Verlag, New York, NY, 2001. 102

[Nebelecky

et al. 2009]

Nebelecky, Christopher, Crassidis, John, Banas, William, Cheng, Decentralized Relative Attitude Estimation for Three-

Yang, & Fosbury, Adam,

Spacecraft Formation Flying Applications,

AIAA Guidance, Navigation, and Con78

trol Conference, Chicago, Illinois, August 2009.

[Nikolas Trawny 2005] Nikolas Trawny, Stergios I. Roumeliotis. Indirect Kalman Filter for 3D Attitude Estimation: A Tutorial for Quaternion Algebra, . Rapport technique TR-2005-002, Rev. 57, Department of Computer Science & Engineering, University of Minnesota, Multiple Autonomous Robotic Systems Laboratory, March, 2005. 38

[Nordlund & Gustafsson 2009] Nordlund, Per-Johan, & Gustafsson, Fredrik, Marginalized Particle Filter for Accurate and Reliable Terrain-Aided Navigation,

IEEE Transac13851399.

tions on Aerospace and Electronic Systems, Vol. 45, No. 4, 2009, Pages:
104

[Patra & Kot 2002] Patra, Jagdish Chandra, & Kot, Alex ChiChung, Nonlinear dynamic system identication using Chebyshev functional link articial neural networks,

IEEE Trans. Systems, Man, and Cybernetics, Part B,
511. 33

Vol. 32, 2002, Pages: 505

[Paul Zarchan 2000] Paul Zarchan, Howard Muso,

Fundamentals of Kalman Filtering: A

Practical Approach, Progress in Astronautics and Aeronautics, AIAA, third édition,
2000. 8

[Poggio & Girosi 1990] Poggio, Tomaso, & Girosi, Federico, Networks for approximation and learning,

Proceedings of the IEEE, Vol. 78, No. 9, 1990.

34

178

Bibliography
[Purwar

et al. 2007]

Purwar, S., Kar, I. N., & Jha, A. N., On-line System Identication

of Complex Systems Using Chebyshev Neural Networks, Vol. 7, No. 1, January, 2007, Pages: 364372. 33

Applied Soft Computing,

[Rapoport & Oshman 2004] Rapoport, Ilia, & Oshman, Yaakov, Fault Tolerant Particle Filtering Using IMM-Based Rao-Blackwellization,

AIAA Guidance, Navigation,
113. 39

and Control Conference and Exhibit, Vol. AIAA 2004-5416, 2004, Pages:

[Ren 2007] Ren, Wei, Distributed attitude alignment in spacecraft formation ying,

In-

ternational Journal of Adaptive Control and Signal Processing, Vol. 21, 2007, Pages:
95113. 87

[Robert & Casella 2005] Robert, Christian P., & Casella, George,

Monte Carlo Statistical

Methods (Springer Texts in Statistics),
NJ, USA, 2005. 31

Springer-Verlag New York, Inc., Secaucus,

[Rogers 2007] Rogers, Robert M.,

Applied Mathematics in Integrated Navigation Systems,

AIAA Inc., third edition, 2007. 22

[Rumelhart

et al. 1986]

Rumelhart, D. E., Hinton, G. E., & Williams, R. J.

Parallel

Distributed Processing: Explorations in the Microstructure of Cognition, Vol. 1, . Chapter: Learning Internal Representations by Error Propagation, Pages: 318362. MIT Press, Cambridge, MA, USA, 1986. 103

[Sahnow

et al. 2006]

Sahnow, David J., Kruk, Jerey W., Ake, Thomas B., Andersson,

B-G, Berman, Alice, Blair, William P., Boyer, Robert, Caplinger, James, Calvani, Humberto, Civeit, Thomas, Dixon, W. Van Dyke, England, Martin N., Kaiser, Mary Elizabeth, Kochte, Mark, Moos, H. Warren, & Roberts, Bryce A., Operations with the new FUSE observatory: three-axis control with one reaction wheel, . Vol. 6266, 2006. 2

[Särkkä

et al. 2007]

Särkkä, Simo, Vehtari, Aki, & Lampinen, Jouko, Rao-Blackwellized

Particle Filter for Multiple Target Tracking, January, 2007, Pages: 215. 104

Information Fusion,

Vol. 8, No. 1,

179

Bibliography
[Särkkä 2013] Särkkä, Simo,

Bayesian Filtering and Smoothing, IMS Textbook Series,

Vol. 3, Cambridge University Press, 2013. 22, 30, 102, 104, 109

[Schmidt 1981] Schmidt, Stanley F., The Kalman Filter: Its Recognition and Development for Aerospace Applications, Pages: 47. 6, 9

Journal of Guidance and Control, Vol. 4, No. 1, 1981,

[Schön

et al. 2006]

Schön, Thomas B., Gustafsson, Fredrik, & Karlsson, Rickard,

The

marginalized particle lter in practice,

Proceedings of IEEE Aerospace Conference,

Big Sky, 2006.

104

[Shuster 1993] Shuster, M. D., A survey of attitude representations,

Journal of Astro-

nautical Sciences, Vol. 41, No. 4, 1993, Pages:
[Simon 2006] Simon, Dan,

439517. 43, 82

Optimal State Estimation: Kalman, H , and Nonlinear Ap8

proaches, John Wiley & Sons Inc., Hoboken, New Jersey, 2006.
[van der Merwe

et al. 2000]

van der Merwe, Rudolph, Doucet, Arnaud, de Freitas, Nando, Rapport technique CUED/F-

& Wan, Eric.

The Unscented Particle Filter, .

INFENG/TR 380, Cambridge University Engineering Department, August, 2000. 147

[Vathsal 1987] Vathsal, S., Spacecraft Attitude Determination Using a Second-Order Nonlinear Filter,

Journal of Guidance, Control, and Dynamics,

Vol. 10, No. 6, 1987,

Pages: 559566. 39

[Vihola 2007] Vihola, Matti, Rao-blackwellised particle ltering in random set multitarget tracking,

IEEE Transactions on Aerospace and Electronic Systems, Vol. 43, April,

2007, Pages: 689705. 104

[W. H. Moos 2000] W. H. Moos, W. C. Cash, L. L. Cowie A. F. Davidsen A. K. Dupree P. D. Feldman S. D. Friedman, Overview Of The Far Ultraviolet Spectroscopic Explorer Mission,

The Astrophysical Journal, Vol. 538

L1-L6, July, 2000. 2

180

Bibliography
[Wan & Van Der Merwe 2000] Wan, Eric A, & Van Der Merwe, Rudolph, The unscented Kalman lter for nonlinear estimation,

Adaptive Systems for Signal Processing,

Communications, and Control Symposium 2000. AS-SPCC. The IEEE 2000. IEEE,
2000, Pages: 153158. 10, 24, 147

[Wan-Chun Li 2005] Wan-Chun Li, Ping Wei, Xian-Ci Xiao, An adaptive nonlinear lter of discrete-time system with uncertain covariance using unscented Kalman lter,

International Symposium on Communications and Information Technologies 2005, Proceedings, Vol. 1, 2005, Pages:
13891392. 22

[Wang & Chaib-draa 2012] Wang, Yali, & Chaib-draa, Brahim, metric particle Filter for State Estimation,

An Adaptive Nonpara-

2012 IEEE International Conference
May

on Robotics and Automation (RiverCentre, Saint Paul, Minniesota, USA),
14182012, Pages: 43554360. 31

[Wiener Norbert 1949] Wiener

Norbert,

1894-1964,

Extrapolation, Interpolation, and
[Cambridge]

Smoothing of Stationary Time Series, with Engineering Applications,

Technology Press of the Massachusetts Institute of Technology. Note: First published during the war as a classied report to Section D2, National Defense Research Committee., 1949. 5, 18

[Wiener Norbert 1956] Wiener Norbert, 1894-1964,

I am a Mathmatician: The later Life
17

of Prodigy, Doubleday & Company, Inc., Garden City, New-York, 1956.

[Wong 2001] Wong, H., de Queiroz M. S.-Kapila V., Adaptive tracking control using synthesized velocity from attitude measurements, Pages: 947953. 45

Automatica,

Vol. 37, No. 6, 2001,

[Xing

et al. 2010]

Xing, Yanjun, Cao, Xibin, Zhang, Shijie, Guo, Haibo, & Wang, Feng,

Relative position and attitude estimation for satellite formation with coupled translational and rotational dynamics, 455467. 78

Acta Astronautica,

No. 67, April, 2010, Pages:

181

Bibliography
[Xiong K. 2007] Xiong K., Chan C.W., Zhang H.Y., Detection of satellite attitude sensor faults using the UKF,

IEEE Transactions on Aerospace and Electronic Systems,

Vol. 43, No. 2, April, 2007, Pages: 480491. 39 [Zakai 1965] Zakai, Moshe, The Optimal Filtering of Markov Jump Processes in Additive White Noise,

Applied Research Laboratory Sylvania Electronic System,

Vol. Re-

search Note No.563, 1965. 5 [Zakai 1969] Zakai, Moshe, On the optimal ltering of diusion processes,

Zeitschrift

für Wahrscheinlichkeitstheorie und Verwandte Gebiete, Vol. 11, No. 3, 1969, Pages:
230243. 5 [Zhang

et al. 2015]

Zhang, Lijun, Li, Tong, Yang, Huabo, Zhang, Shifeng, Cai, Hong, &

Qian, Shan, Unscented Kalman Filtering for Relative Spacecraft Attitude and Position Estimation, 79 [Zou

Journal of Navigation,

Vol. 68, No. 03, 2015, Pages: 528548.

et al. 2011]

Zou, An-Min, Kumar, Krishna-Dev, & Hou, Zeng-Guang, Distributed

Consensus Control for Multi-Agent Systems Using Terminal Sliding Mode and Chebyshev Neural Networks,

International Journal of Robust and Nonlinear Con-

trol, Vol. 23, 2011, Pages:
[Zou

334357. 103, 111, 114 Kumar, Krishna-Dev, & de Ruiter, Anton H.J.,

et al. 2014]

Zou,

An-Min,

Quaternion-based output feedback attitude control for rigid spacecraft with nitetime convergence, December, 2014. 44 [Zou

et al. 2016]
mations,

Zou, An-Min, de Ruiter, Anton H. J., & Kumar, Krishna-Dev, Dis-

tributed nite-time velocity-free attitude coordination control for spacecraft for-

Automatica, Vol. 67, 2016, Pages:

4653. 84, 85

[Zou 2014] Zou, An-Min, Finite-Time Output Feedback Attitude Tracking Control for Rigid Spacecraft,

IEEE Transaction on Control Systems Technology, Vol. 22, No. 1,

January, 2014, Pages: 338345. 82

182

