NONLINEAR ATTITUDE CONTROL OF UNDERACTUATED SPACECRAFT
by

Alexander Frias Bachelor of Engineering, Ryerson University (2010) Master of Applied Science, Ryerson University (2012)

A dissertation presented to Ryerson University in partial fulfillment of the requirements for the degree of Doctor of Philosophy in the program of Aerospace Engineering

Toronto, Ontario, Canada, 2018 c Alexander Frias, 2018

AUTHOR'S DECLARATION
I hereby declare that I am the sole author of this dissertation. This is a true copy of the dissertation, including any required final revisions, as accepted by my examiners.

I authorize Ryerson University to lend this dissertation to other institutions or individuals for the purpose of scholarly research.

I further authorize Ryerson University to reproduce this dissertation by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

I understand that my dissertation may be made electronically available to the public.

ii

NONLINEAR ATTITUDE CONTROL OF UNDERACTUATED SPACECRAFT
Alexander Frias Doctor of Philosophy, Aerospace Engineering, Ryerson University, Toronto (2018)

ABSTRACT
This dissertation investigates the nonlinear control of the attitude for an underactuated rigid-body spacecraft system in the body-orbital and inertial frames. The problem involving the stabilization of the body-orbital attitude of an underactuated output-feedback system is examined. Using sliding mode control in conjunction with finite-time nonlinear observer, a novel observer-based control law is rigorously analyzed and proven to achieve attitude convergence. Under time-varying disturbances, inertia matrix uncertainties, and high initial errors, the proposed novel law achieves attitude convergence for three-axis stability and ultimate boundedness within 5 degrees and 0.01 deg/s, for attitude error norm and angular velocity norm, respectively. Next, the attitude control problem is rigorously analyzed in the inertial frame, where the underactuated rigid-body spacecraft system equations of motion are highly nonlinear, and the linearized equations of motion are not controllable. To this end, a generalized velocity-free time-varying state feedback controller is developed to achieve globally exponential stability with respect to the homogenous norm and proven to provide ultimate boundedness of all signals with 5 degrees attitude error norm and 0.5 rad/s angular velocity error norm. Finally, the inertial frame attitude stabilization problem is treated as an optimal control problem. For this case, the Legendre pseudospectral method is used to discretized the spacecraft dynamics into Legendre-Gauss-Lobatto (LGL) node points, where the Lagrange polynomial interpolation is applied to obtain a suitable candidate optimal control sequence. Model predictive control is used to implement the optimal control in predefined control windows sequentially to achieve three-axis stability for a rest-to-rest maneuver within 0.3 orbit. iii

ACKNOWLEDGEMENTS

This dissertation would not have been possible without the love, motivation, support and generally the positivity of my whole family, specially my loving parents, Eddie and Tess. Thank you. I dedicate this dissertation to you. Ryerson University have become my second home; many people have become more than just staff members during my academic career. I would like to thank all my professors for contributing to my academic knowledge and wellness. I would like to give my utmost sincere thanks to Mr. Jerry Karpynczyk and Mr. Peter Bradley, as mentors whom I have learned a great deal from. To the Aerospace Engineering Department: Ms. Leah Rogan, Ms. Kim Gallo, Mr. Primoz Cresnik, Dr. Hamid Ghaemi, and Dr. Bo Tan1 for putting a smile on my face whenever I see them. I appreciate your help and enthusiasm. A special thanks to the thesis committee: Dr. John Enright1 , Dr. Simant Upreti2 , Dr. Jinjun Shan3 , Dr. Cheung Poon4 and Dr. Ron Vogel5 . I would like to thank my SSDC/RAC lab colleagues for their contribution to my academic success as pillars of support and de/motivation when there were none: Y. Haddad, K. Chang, D. Braga, Dr. M. Rososhansky, Dr. A. Rahimi, Dr. S. Etemadi, M. Adhikari, C. Wozney, S. Patil, V. Muthusamy, M. Alger, D. Bolatti, E. Gleeson ...and to all lab colleagues I have not listed here. I apologize. Lastly, I would like to express my deepest gratitude to my academic supervisors/mentors: Dr. Anton H. J. de Ruiter1 and Dr. Krishna D. Kumar1 . Thank you both for your guidance, in academia and in life; your unyielding support that go above and beyond; and your motivation to push through and pursue knowledge. I am very much honored to be your student. And finally, I would like to thank my fianc√©e, Lily, for her love, care, support, and most of all, patience. I am thankful.

1 Dissertation Committee Member (Internal Examiner), Department of Aerospace Engineering, Ry-

erson University. 2 Dissertation Committee Member (Internal Examiner), Department of Chemical Engineering, Ryerson University. 3 Dissertation Committee Member (External Examiner), Dept. of Earth and Space Science and Engineering, York University. 4 Dissertation Committee Chair, Department of Aerospace Engineering, Ryerson University. 5 Dissertation Committee Chair, Department of Politics & Public Admin., Ryerson University.

iv

TABLE OF CONTENTS
AUTHOR'S DECLARATION ABSTRACT ACKNOWLEDGEMENTS LIST OF TABLES LIST OF FIGURES LIST OF SYMBOLS 1 Introduction 1.1 1.2 Rationale and Motivations . . . . . . . . . . . . . . . . . . . . . . . . . . Literature Review . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1.2.1 1.3 Underactuated systems . . . . . . . . . . . . . . . . . . . . . . . ii iii iv ix x xii 1 1 2 2 5

Problem Statement and Research Objectives . . . . . . . . . . . . . . . . 1.3.1 Body-orbital relative attitude stabilization for an underactuated rigid-body spacecraft system . . . . . . . . . . . . . . . . . 1.3.2 Inertial attitude stabilization for an underactuated rigid-body spacecraft system . . . . . . . . . . . . . . . . . . . . . . . . . . . 1.3.3 Output feedback control of an Underactuated rigid-body spacecraft system . . . . . . . . . . . . . . . . . . . . . . . . . . . 1.3.4 1.3.5 Lyapunov stability of observer-based nonlinear control system Optimal control of underactuated spacecraft using model predictive control . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

6

6

6 7

7 8

1.4

Research Overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

v

2

Mathematical Preliminaries 2.1

11

Vector Notations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11 2.1.1 2.1.2 Euclidean space . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11 Vector and matrix norms . . . . . . . . . . . . . . . . . . . . . . . 11

2.2

Topology . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12 2.2.1 2.2.2 2.2.3 Manifolds . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 15 Charts and maps . . . . . . . . . . . . . . . . . . . . . . . . . . . 15 Vector fields . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16

2.3 2.4

Homogeneity of Functions . . . . . . . . . . . . . . . . . . . . . . . . . . 18 Lyapunov Stability of Systems . . . . . . . . . . . . . . . . . . . . . . . . 21 2.4.1 Finite-time stability . . . . . . . . . . . . . . . . . . . . . . . . . . 23

2.5

Optimal Control . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24 2.5.1 The optimal control problem . . . . . . . . . . . . . . . . . . . . 25 27

3

Velocity-Free Nadir-pointing Attitude Stabilization 3.1 3.2

Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28 Problem Formulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30 3.2.1 3.2.2 3.2.3 Coordinate frames . . . . . . . . . . . . . . . . . . . . . . . . . . 30 Spacecraft attitude kinematics and dynamics . . . . . . . . . . . 31 Control objective . . . . . . . . . . . . . . . . . . . . . . . . . . . 32

3.3

Design of Underactuated Attitude Control Law . . . . . . . . . . . . . . 33 3.3.1 3.3.2 Control design for unactuated states . . . . . . . . . . . . . . . . 36 Control design for actuated states . . . . . . . . . . . . . . . . . 41 Full-state feedback control . . . . . . . . . . . . . . . . . . . . . . 42 Velocity-free feedback control . . . . . . . . . . . . . . . . . . . . 43 3.3.3 Observer design . . . . . . . . . . . . . . . . . . . . . . . . . . . 44

3.4 3.5

Main Result . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54 Numerical Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 55 3.5.1 3.5.2 3.5.3 3.5.4 Nominal disturbance-free case . . . . . . . . . . . . . . . . . . . 58 Nominal case with disturbances . . . . . . . . . . . . . . . . . . 59 All uncertainties and disturbances . . . . . . . . . . . . . . . . . 60 Effect of  parameter . . . . . . . . . . . . . . . . . . . . . . . . . 63

vi

3.6 4

Chapter Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 63

Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller 4.1 4.2 66

Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 66 Problem Formulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68 4.2.1 4.2.2 4.2.3 4.2.4 4.2.5 Attitude kinematics and dynamics . . . . . . . . . . . . . . . . . 68 Control objective . . . . . . . . . . . . . . . . . . . . . . . . . . . 69 Control design for unactuated states . . . . . . . . . . . . . . . . 71 Control design for actuated states . . . . . . . . . . . . . . . . . 78 Observer design . . . . . . . . . . . . . . . . . . . . . . . . . . . 90

4.3 4.4

Main Result . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 94 Numerical Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 95 4.4.1 4.4.2 4.4.3 Nominal disturbance-free case . . . . . . . . . . . . . . . . . . . 98 Nominal case with disturbances . . . . . . . . . . . . . . . . . . 98 All uncertainties and disturbances . . . . . . . . . . . . . . . . . 99

4.5 5

Chapter Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 101 103

Model Predictive Control of Underactuated Spacecraft 5.1 5.2

Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 103 Problem Formulation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105 5.2.1 5.2.2 5.2.3 Attitude kinematics and dynamics . . . . . . . . . . . . . . . . . 105 Optimal control . . . . . . . . . . . . . . . . . . . . . . . . . . . . 107 Pseudospectral discretization . . . . . . . . . . . . . . . . . . . . 108 Time-domain transformation . . . . . . . . . . . . . . . . . . . . 109 Lagrange polynomial interpolation . . . . . . . . . . . . . . . . 109 Differentiation and integration . . . . . . . . . . . . . . . . . . . 110 5.2.4 5.2.5 Model predictive control . . . . . . . . . . . . . . . . . . . . . . . 111 Stability analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . 112

5.3 5.4

Numerical Simulations . . . . . . . . . . . . . . . . . . . . . . . . . . . . 113 Chapter Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 115

vii

6

Concluding Remarks 6.1 6.2 6.3

119

Contributions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 120 Future Work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 121 122

BIBLIOGRAPHY

viii

LIST OF TABLES
3.1 4.1 5.1 Summary of parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . 56 Summary of parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . 96 MPC Parameters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 114

ix

LIST OF FIGURES
1.1 1.2 1.3 1.4 2.1 3.1 3.2 Research overview of the spacecraft attitude control . . . . . . . . . . . Overview of Chapter 3 . . . . . . . . . . . . . . . . . . . . . . . . . . . . Overview of Chapter 4 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8 9 9

Overview of Chapter 5 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10 Differential maps of a trajectory. . . . . . . . . . . . . . . . . . . . . . . . 17 Coordinate Topologies . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30 Attitude and angular velocity responses in nominal disturbance-free case . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59

3.3

Attitude and angular velocity responses in nominal case with disturbances . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 60

3.4 3.5

Control torque in nominal case with disturbances . . . . . . . . . . . . 60 Attitude and angular velocity responses with inertia matrix uncertainties, non-zero eccentricities and disturbances . . . . . . . . . . . . . 62

3.6 3.7 3.8 4.1

Effect of  on the transient response . . . . . . . . . . . . . . . . . . . . 64 Effect of  on attitude error . . . . . . . . . . . . . . . . . . . . . . . . . 64 Effect of  on the steady-state response . . . . . . . . . . . . . . . . . . . 64 Attitude and angular velocity responses in nominal disturbance-free case . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99

4.2

Attitude and angular velocity responses in nominal case with disturbances . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 99

4.3 4.4

Control torque in nominal case with disturbances . . . . . . . . . . . . 100 Attitude and angular velocity responses with inertia matrix uncertainties and disturbances . . . . . . . . . . . . . . . . . . . . . . . . . . . 102

x

5.1 5.2

Two-RW system topology. . . . . . . . . . . . . . . . . . . . . . . . . . . 105 time domain transformation into computational domain with distinct node points and the corresponding Lagrange interpolation polynomial.110

5.3 5.4 5.5 5.6 5.7 5.8 5.9

Optimal MPC Control Interpolation. . . . . . . . . . . . . . . . . . . . . 115 Optimal MPC Control Interpolation: 0  t  0.3 orbits. . . . . . . . . . 115 Optimal MPC Control Interpolation: 0.7  t  1.0 orbits. . . . . . . . . 116 MPC continuous dynamics control signals. . . . . . . . . . . . . . . . . 116 MPC continuous dynamics control signals at 0  t  0.3 orbit. . . . . . 117 MRP response. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 117 Angular momentum response. . . . . . . . . . . . . . . . . . . . . . . . 118

xi

LIST OF SYMBOLS
If applicable, the page where the symbol is defined is given in the parentheses. List of common symbols.

a Bi ( j ) Cij e ei f (x) FI Fo Fb Fi h I J K m , Me p q R S t Vx Lf V x

semi-major axis of the reference orbit ball of radius i > 0 centered on point j rotation matrix from Frame j to Frame i eccentricity of the reference orbit unit vector of ith axis vector field of x Earth-centered inertial frame orbital frame spacecraft body-fixed frame coordinate frame of the ith body angular momentum identity matrix spacecraft moment of inertia, cost function control gain mass of spacecraft, mass of the Earth modified Rodrigues parameters inertial unit quaternion orbital radius sliding variable temporal parameter Lyapunov function V with respect to x Lie derivative of V along the direction of the vector field f state parameter xii

km

N¬∑m¬∑s

kg¬∑m2

kg

km

s

body-orbital frame quaternion vector   ¬µ  o body-orbital frame quaternion scalar angular frequency geocentric gravitational constant of the Earth external torque orbital frame angular velocity
p

rad s-1

rad s-1

¬∑ (^ ¬∑) (~ ¬∑)

vector p-norm, with p = {1, 2, } estimated parameter error parameter parameter uncertainty skew-symmetry of parameter discrete-step of parameter supremum of parameter infimum of parameter set of parameters minimum of the set maximum of the set signum of parameter minimum eigenvalues of parameter maximum eigenvalues of parameter

(¬∑)

(¬∑)√ó (¬∑)k
sup (¬∑) inf (¬∑)

{¬∑ ¬∑ ¬∑ }
min {¬∑} max {¬∑} sgn(¬∑) min (¬∑) max (¬∑)

xiii

Dedicated to my parents, Alfredo and Teresita Frias. . .

xiv

CHAPTER 1

Introduction
This dissertation studies the attitude control of a underactuated rigid-body spacecraft system using nonlinear control methods and rigorous analysis of the stability.

The chapter is organized as follows. In the Section 1.1, the rationale behind the research on underactuated control system is explained as well as the motivations behind the methodologies considered. An overview of the literature of relevant topics on the underactuated control systems are covered in Section 1.2. These topics include the works from authors such as Crouch, Khalil, Slotine, and Hughes. Finally, the problem statement and the research objectives are outlined in Section 1.3.

1.1

Rationale and Motivations

The development of an attitude control system (ACS) for a spacecraft system to be autonomous, or have complex behaviors such as: capability to analyze mission situations, adapt to changes in environment, system, and uncertainties, or improve performance by learning without human intervention are features that attract technological research and development. If a failure in ACS occurs, in which, leads to a degradation of its actuator(s), can be recovered using a control algorithm and allows the spacecraft system to complete its mission even partially, then it can be considered as a success as opposed to a complete loss. A control algorithm for an underactuated control system can be applied in various ways: ACS redundancy, ACS actuator fault recovery, ACS for an underactuated system by design, reduction in fuel for attitude maneuver or correction. Thus, the development of a novel control design framework for an underactuated system is the motivation of this research. There 1

CHAPTER 1. Introduction have been many research conducted in the last decade regarding the ACS problem for the underactuated spacecraft system, the following section briefly outlines some significant research and development done in the field.

1.2
1.2.1

Literature Review
Underactuated systems

Underactuated systems are interesting to study from a theoretical and practical point of view. Control of underactuated systems is considered one of the most active topics within the field of dynamical system due to its potential applications. Underactuation is defined as any system having less control inputs that degrees-of-freedom. Any system, be it mechanical (robotics, mobile systems, marine systems, aerospace systems, flexible systems, locomotive systems, and industrial systems) or biological (animals, human anatomy), can be in a condition of underactuation. The underactuation property of an underactuated system is primarily caused by the following reasons [Xin and Liu, 2014]: ¬∑ Natural dynamics of the system (helicopters, underwater vessels, ships, spacecraft, or flexible-link robots) ¬∑ Intentional underactuated design (the Acrobot [Spong, 1995], the Pendubot [M. Zhang, 2002], the cart-pole [Aguilar-Ibanez, Mendoza-Mendoza, and Davila, 2014], or the translational oscillation with rotational actuator (TORA) [Gao et al., 2013]) ¬∑ Reduced actuation or complete actuator failure (complete loss of momentum wheels in a spacecraft, reduced actuation generation in mechanical systems) The research of the underactuated control systems problem typically fall into one or more of the following categories: 1. Stability and controllability: a problem involving the existence of trajectories that connects initial state to the desired state as well as remain in a prescribed

2

CHAPTER 1. Introduction region in the state space. This problem essentially pertains to finding the control signals that stabilizes a spacecraft, in which the desired error in the attitude and angular velocity of spacecraft system are zero. 2. Trajectory optimization and planning: a problem involving the computation of feasible trajectory for a given underactuated system that can connect the initial to the desired state in a given finite time. This problem pertains to the finding optimal (or improved) control signals while minimizing certain parameters in a form of a cost function. 3. Tracking: a problem involving the formulation of a feedback control law that can drive the tracking error to zero asymptotically for a given feasible trajectory, at least locally. A particular difficult problem for system that have nonlinearities which involves finding the control signals to stabilize the spacecraft with varying desired trajectory. 4. Set-point regulation: a problem involving the formulation of a feedback control law for given a desired equilibrium state qd that can make the system state  ) = (qd , 0) asymptotically stable, at least locally around the trajectory. ( q, q The problem of controlling the attitude motion of a rigid-body has been extensively studied in the literature and it is heavily applied in various fields of study, including spacecraft, robotics, and underwater vehicle dynamics. Initial studies in the topic done by Crouch [Crouch, 1984] discussed the possibility of controlling underactuated spacecraft using thrusters or momentum exchanging devices, in which the author concluded that using two independent torques is locally controllable while using one torque yields very serious theoretical and practical difficulties. A study conducted Byrnes and Isidori [Byrnes and Isidori, 1991] further support Crouch's findings and concluded that spacecraft with two controls are locally controllable and locally reachable, but these systems cannot be locally asymptotically stabilized by smooth feedback without using general nonlinear feedback design theory. Authors in Huang et al. [Huang et al., 2013] proposed the concept of a novel generalized inversion for piecewise-smooth asymptotic stabilization of underactuated rigid body dynamics under two degrees of actuation. This overcame the matrix

3

CHAPTER 1. Introduction dimensionality and rank which is widely used in solving the control problem with redundant degrees-of-freedom; this was important as the authors concluded that redundancy is a control variable in underactuated system. Other forms of treatments such as discontinuous state-feedback control and variable structure control strategies for underactuated system had been successfully implemented in literature [Horri and Hodgarts, 2003; Tsiotras and Luo, 2000; Coverstone-Carroll, 1996; Casagrande, Astolfi, and Parisini, 2008]. Control techniques such as sliding mode control in [G. Godard and K.D. Kumar, 2011] for nadir-pointing applications and backstepping have been successful in controlling underactuated systems [G. Godard and K. Kumar, 2010; R. Xu and Ozguner, 2008] and proved effective, resulting in asymptotic stability [Behal et al., 2002]. In this thesis, the nadir-pointing case (relative body-orbital) is also considered, however the strict requirement of higher-order sliding mode imposed in [G. Godard and K.D. Kumar, 2011] is not essential to stabilize the underacted system in case, thus essentially making the control system more robust. In addition, angular velocity is not needed for zero attitude convergence. Model predictive control techniques have also been successfully applied to underactuated spacecraft attitude control [H. Li, Yan, and Shi, 2017; Petersen, Leve, and Kolmanovsky, 2017a]. The authors in [Petersen, Leve, and Kolmanovsky, 2017a] needed to simplify the attitude dynamics model by constructing a linearized model to be implemented as system dynamics for the optimal control computation, leading to an oscillatory error response. In contrast to this thesis, the full nonlinear equations of motion are used in the computation of the optimal control and obtain the Legendre-Gauss-Lobatto optimal nodes, this effectively utilizes the highly nonlinear terms in the dynamics as factors to solving the optimal control leading to exponential convergence. Authors in Narikiyo et al. [Narikiyo, Sahashi, and Misao, 2008] proposed to combine passive velocity field vector control with decoupling vector field in stabilizing underactuated mechanical systems.

In more recent studies regarding the underactuated control problem, are published research by Xiao et al. [Xiao et al., 2014], where the authors developed a velocity-measurement free control scheme in conjunction with nonlinear observer 4

CHAPTER 1. Introduction for fault-tolerant control of underactuated system in the presence of disturbance and bias [Xiao et al., 2014]. However, the research conducted in this study dealt with a degradation of an actuator on certain axis, in which three-axis actuation was still viable, albeit reduced in certain axis. Contrasted to this thesis, complete absence of actuation in an axis is analyzed with rigor. Authors of Sun et al. [Sun and Fang, 2014] proposed online trajectory planning by incorporating swing-damping terms in a smooth trolley trajectory generation for swing elimination and precise trolley positioning. Authors in Zhang et al. [J. Zhang, Ma, and Meng, 2014] proposed attitude path planning for underactuated spacecraft using two flywheels as actuators. Using an optimal performance index as well as using Gauss Pseudospectral Method (GPM) for optimal path generation the authors were able to generate attitude trajectory for underactuated spacecraft which satisfies the spacecraft maneuver requirements as well as avoid friction influence caused by the flywheels. In comparison to this thesis, the pseudospectral optimal control theory approach is considered to optimize the state trajectory of the spacecraft and implemented using model predictive control, a methodological approach that has not been considered in the literature. Gui et al. [Gui, Vukovich, and S. Xu, 2015] addressed the tracking control of an underactuated spacecraft on the momentum-level set, and developed a control law in conjunction with the Lie group structure of the attitude configuration manifold SO(3) using transverse function (TF) approach developed by Morin and Samson [Morin and Samson, 2009] and analyzed the small-time local controllability of the system in [Gui, Jin, and S. Xu, 2015].

1.3

Problem Statement and Research Objectives

The attitude control system for a underactuated rigid-body spacecraft provide several advantages over attitude control systems in fully-actuated spacecraft; namely, weight, cost, and manufacturability. In this dissertation the following problems are analyzed and treated.

5

CHAPTER 1. Introduction

1.3.1

Body-orbital relative attitude stabilization for an underactuated rigid-body spacecraft system

The stabilization of the body-orbital relative attitude of a nadir-pointing underactuated rigid-body rigid-body spacecraft system using nonlinear control strategies.

Research objective: The proposed research objective for this problem is the development of the mathematical analysis to achieve stabilization of the body-orbital relative attitude for the underactuated spacecraft and develop a viable nonlinear control strategy using sliding mode control design methodology. To achieve effective stabilization the system dynamics is linearized and utilized to generate control parameters.

1.3.2

Inertial attitude stabilization for an underactuated rigid-body spacecraft system

The stabilization of the inertial attitude for a underactuated rigid-body spacecraft system under time-varying disturbances and uncertainties using nonlinear control is examined. Similar to approach to the nadir-pointing case, the inertial case differs due to the fact that the system dynamics are not linearizable, and therefore, limiting the control strategies that may be used.

Research Objective: The proposed research objective for this case is the development of the mathematical analysis to achieve inertial attitude stabilization using a generalized time-varying state feedback controller design.

1.3.3

Output feedback control of an Underactuated rigid-body spacecraft system

The problem of achieving attitude convergence of an output feedback system for a underactuated rigid-body spacecraft system is examined. In this case, only angular vector measurements are available and can be used.

6

CHAPTER 1. Introduction Research objective: The proposed strategy in treating an output feedback system for the underactuated rigid-body spacecraft without angular velocity (henceforth, velocity-free) is to apply a nonlinear observer-based control scheme. This is achieved using the homogeneity of functions.

1.3.4

Lyapunov stability of observer-based nonlinear control system

The problem of analyzing the stability of a nonlinear observer-based attitude control system for the rigid-body spacecraft is examined.

Research objective: The proposed research objective is to develop of the mathematical analysis for the stability of the nonlinear observer-based control system using Lyapunov stability theorems and homogeneity of Lyapunov functions. A Lyapunov function that is homogenous is designed and rigorously proven.

1.3.5

Optimal control of underactuated spacecraft using model predictive control

The problem of finding a finite-time optimal attitude control sequence for the underactuated rigid-body spacecraft system with two torques is examined. The problem extends to the application of continuous spacecraft dynamics model (as opposed to discretized spacecraft dynamics model), given dynamical constraints.

Research objective: In this problem the proposed research objective is the use pseudospectral optimal control theory. Legendre pseudospectral method of discretization to generate the optimal Legendre-Gauss-Lobatto node points and use Lagrange polynomial interpolation to interpolate an optimal control signals for the model predictive control application to stabilize the underactuated rigid-body spacecraft system.

7

CHAPTER 1. Introduction

1.4

Research Overview

The research conducted in this dissertation is described in the following manner. Chapter 1 gives a brief overview of the literature survey on the underactuated spacecraft system and problems pertaining to the research as seen in Figure 1.1 and the motivations and objectives of the research. Chapter 2 outlines the mathematical con-

F IGURE 1.1: Research overview of the spacecraft attitude control

cepts to assist the reader in understanding the materials in the subsequent chapters. Chapter 3 examines the attitude stabilization problem of the underactuated spacecraft system without using angular velocity measurements in the body-orbital frame as seen in Figure 1.2. In this chapter, sliding mode control and a nonlinear observer are used to solve the stability and control problems of the underactuated spacecraft system in the relative frame for a nadir-pointing application. Chapter 4 further investigates the problems in Chapter 2 but in the relative inertial frame as seen Figure 1.3. There are several control challenges in the inertial frame, mainly, the methods used in previous chapter is not applicable in the inertial frame, therefore a new method of control is needed. Chapter 5 proposes alternative methods to control the underactuated spacecraft, namely, the use of optimal control as seen in Figure 1.4. Nonlinear model predictive control deals with the optimization of the control input to stabilize the underactuated spacecraft system more effectively. Lastly, Chapter 6 concludes the dissertation with summary and future work. 8

CHAPTER 1. Introduction

F IGURE 1.2: Overview of Chapter 3

F IGURE 1.3: Overview of Chapter 4

9

CHAPTER 1. Introduction

F IGURE 1.4: Overview of Chapter 5

10

CHAPTER 2

Mathematical Preliminaries
This chapter presents the mathematical background required for the proceeding chapters. The chapter begins with the notations of Euclidean space and norms, a brief review of topics in differential geometry, namely the concepts of topological spaces, differential manifolds, charts and maps, tangent spaces, tangent and vector bundles, and Lie groups. An overview of dynamic stability, finite-time stability, and homogeneity of functions. Finally, we conclude the chapter with topics pertaining to optimal control theory.

2.1
2.1.1

Vector Notations
Euclidean space

The set of all n-dimensional vectors x = [ x1 , ¬∑ ¬∑ ¬∑ , xn ] T defines the n-dimensional Euclidean space denoted by Rn , where x1 , ¬∑ ¬∑ ¬∑ , xn are real valued numbers. We denote by R to represent the one-dimensional Euclidean space consisting of all real numbers. The set of all non-negative real numbers is denoted by R+ . Vectors in Rn can be added by adding their respective components and can be multiplied by a scalar. The inner product of two vectors x and y can be computed as x T y = in=1 xi yi . The standard basis vectors for R3 are denoted by e1 = [1, 0, 0] T , e2 = [0, 1, 0] T and e3 = [0, 0, 1] T . The identity matrix is denoted by I .

2.1.2

Vector and matrix norms
 0 for all x  Rn ,

The Euclidean norm of a vector x  Rn is denoted by x

with x = 0 if and only if x = 0. Given vectors x, y  Rn , x + y  x + y

11

CHAPTER 2. Mathematical Preliminaries and ax = | a| x for all a  R. Another property of vector norms is the triangle equality. Consider the class of p-norms defined by

x

p

= (| x1 | p + ¬∑ ¬∑ ¬∑ + | xn | p )1/ p ,

1  p. < 

(2.1)

The most commonly used norms are the 1-norm x


x

1

= in=1 | xi |, the -norm
1/2

= max| xi | and the Euclidean norm x
i

2

= xT x

. The H√∂lder inequality

is an important result in p-norms, which is given by

| x T y|  x
for all x, y  Rn .

p

y q,

1 1 + =1 p q

(2.2)

Let A  Rm√ón be an m √ó n matrix of real elements that defines a linear mapping y = Ax from Rn into Rm , the the induced p-norm of A is defined by Ax p = max A x p x p =1

A

p

= sup
x =0

p

(2.3)

and for p = {1, 2, } is given by

A

1

= max  | aij |,
j i =1

m

A

2

= max AT A

1/2

,

A



= max  | aij |
i j =1

n

(2.4)

where max A T A is the maximum eigenvalue of A T A .

2.2

Topology

Topology is required in order understand manifold and maps. The definition of a topological space is as follows: Definition 2.2.1. Topological Space Denoted by a pair (S, O), where S is a set and O  2S is a collection of open sets that are subsets of S and satisfies the following axioms: (i)   O and X  O is any arbitrary subset of S, (ii) if A is an arbitrary index set and {O a } a A  O is an arbitrary collection of open sets, then its union  a A O a  O, 12

CHAPTER 2. Mathematical Preliminaries (iii) if O1 , O2  O, then the intersection O1  O2  O. Thus, for given a set S, a collection of subsets O that are open sets is a topology on S. Definition 2.2.2. Topology of Sets. Let S be any given set. Then, (i) A subset C  S is called closed if its complement S\{C } is open. (ii) For point p  S, a neighborhood of p is an open set U  O for which p  U . (iii) A set A  S, then the interior of A is the subset of A defined by

int( A) =

{O  O | O  A} .

(iv) If A  S, then a point p  S is a limit point of A if, U  A = , for any neighborhood U of p. (v) A set A  S, then the closure of A is the subset of A defined by

cl( A) =

{C | C is closed and C  A} .

(vi) If A  S, then the boundary of A is the subset of S defined by bd( A) = cl  cl(S\{ A}). (vii) A subset B  O is a basis for O if, for every O  O, there exist an index set A and a collection of sets { Ba } a A  B such that O =  a A Ba . We say in this case that B generates O (viii) A cover of (S, O) is a subset {O a } a A  O with the property that S =  a A O a . ~a (ix) A cover O ~
~ ~ A a

is a refinement of a cover {O a } a A if, for every a  A, there

~  O. ~ such that O ~A exist a (x) A subset {O a } a A  O is locally finite if, for each p  S, there is a neighborhood

U such that the set { a  A | U  O =  is finite.
(xi) If A  S, then one defines a topology on A by { A  O | O  O}. This is called the subspace topology. 13

CHAPTER 2. Mathematical Preliminaries (xii) If B  A  S, then int A ( B) denotes the interior of B in the subspace topology on A. Definition 2.2.3. Set Properties. Let (S, O) be any arbitrary topological space. Then, (i) (S, O) is first-countable if, for every point p  S, there exist a sequence of neighborhood U j with U j  U . (ii) (S, O) is second-countable if, it has a countable basis. (iii) (S, O) is compact if, for every collection {O a } a A of open sets for which S =
j N

of p such that, for any neighborhood U of p, there exist j  N

 a A O a , there exist a finite subset { a1 , . . . , ak }  A such that S = k j =1 O a j .
(iv) A subset A  S is compact if A is compact with the subspace topology. (v) An open set U  S is relatively compact if its closure is compact. (vi) (S, O) is Hausdorff if, for each distinct points p1 , p2  S, there exist neighborhoods U1 of p1 and U2 of p2 such that U1  U2 = . (vii) (S, O) is connected if, when A  2S has the property that A is both open and closed, then A  {, S}, (viii) and it is disconnected if it is not connected. (ix) (S, O) is paracompact if its Hausdorff and every cover possesses a locally finite refinement. (x) A subset A  S of a topological space is dense if cl( A) = S. Given a point x  Rn and r > 0, Br ( x ) = {y  Rn : ¬Ø r ( x ) = { y  Rn : B y-x y-x

< r } and

 r } denote the open and closed balls of radius

r > 0 centered on x respectively. Given a differentiable function V ( x ) : Rn  R and vector field f ( x, t) : Rn √ó R  Rn , the Lie derivative of V along f is defined by L f V = (V / x ) f ( x, t). Given a vector x  Rn and  > 0, denote sig ( x ) =

[sig ( x1 ), . . . , sig ( xn )]T and sig ( xi ) = | xi | sgn( xi ), i = 1, 2, . . . , n, and sgn(¬∑) is the
signum function. The unit sphere in Rn is defined as Sn-1 = { x  Rn : x = 1}. 14

CHAPTER 2. Mathematical Preliminaries

2.2.1

Manifolds

Definition 2.2.4. Topological Manifold and Submanifold. A topological space M can be called a n-dimensional smooth manifold. A submanifold of M is a subset B  M with the property that for every b  B there is an admissible chart (U , ) in M with b  U which has the submanifold property, namely,  : U  E√óF and  (U  B ) =  (U )  ( E √ó { 0 } ) .

Definition 2.2.5. Tangent Space. For a manifold M and p  M the tangent space to M at p is the set of equivalence class of curves at p: Tp M = {[cm ] | c is a curve at m} . (2.5)

For a subset A  M, let the disjoint union, TM| A =  p A Tm M. We call TM = TM | M the tangent bundle of M. The mapping M : TM  M defined by M ([c]m ) = m is the tangent bundle projection of M.

2.2.2

Charts and maps

Definition 2.2.6. Chart. Suppose f : M  N , where M and N are C k manifolds ( f maps the set of M into N ). We say f is of class Cr , 0  r  k, if for each p  M and admissible chart (V , ) of N with f ( x )  V , there is a chart (U , ) of M satisfying p  U and f (U )  V , and such that the local representative of f , f ( ) =   f  -1 , is of class Cr . Proposition 1 (Continuous Mapping). Let f : M  N be a continuous map of manifolds. Then f is Cr iff the local representatives of f relative to a collection of charts which cover M and N are Cr . Similarly, if f : M  N and g : N  P are Cr maps, then so is g  f. Definition 2.2.7. Diffeomorphism. A map f : M  N where M and N are manifolds is called a Cr diffeomorphism if f is of class Cr , is a bijection, and f -1 : N  M is of class Cr . If a diffeomorphism exists between two manifolds, they are called diffeomorphic and a set of class Cr diffeomorphism of M is given by Diffr ( M ). 15

CHAPTER 2. Mathematical Preliminaries Definition 2.2.8. Higher-order differential maps. Let U be any open set subset of Rn and let f : U  Rm . (i) If Dr f exists and is continuous, then f is r-times continuously differentiable, or said to be a class Cr map. (ii) f is smooth or of class C  if, f is infinitely differentiable, ie., f or class Cr is define for each r  N. (iii) A bijection of open sets f : U  Rn  V  Rm is of class Cr and f -1 exists and also of class Cr , then the bijection f is considered a Cr -diffeomorphism. A pair (U ,  ) is called a coordinate chart of M at q  M where U is an open set of M containing the point q, and the homeomorphism  is a bijection from U to  (U )  Rn which composes of local coordinate functions ( x1 (q), . . . , x n (q)).

2.2.3

Vector fields

Definition 2.2.9. Vector fields. A vector field in an open set of a manifold U  M, where M  Rn , is a differentiable map which assigns to each q  U a vector w(q)  Tq M, where Tq M  Rn . The vector field w(q) is a differentiable at q  U , for some local parametrization p( x, y) at q. If q = ( x, y) and w (q) = ( a( x, y), b( x, y)), the functions a and b are differentiable functions in U . Thus, given a vector field w(q), it is logical to see if there exist a trajectory of this field, that is a differentiable parameterized curve (t) = ( x (t), y(t)), t  I , such that  (t) = w ((t)). The vector field w determines a system of differential equations, dx = a ( x , y ), dt dy = b ( x , y ), dt (2.6)

and that a solution to the given equations above is a trajectory. The following Theorems are useful pertaining to the (local) existence and uniqueness of solutions [Carmo, 1976]. Theorem 2.1 (do Carmo). [Carmo, 1976] Let w be a vector field in an open set U  Rn . Given p  U, there exists a trajectory  : I  U of w such that  (t) = w ((t)) , t  I with (0) = p. This trajectory is unique if another trajectory  : J  U with (0) = p agrees with  in I  J. I and J are open intervals of the line R containing the origin 0  R. 16

CHAPTER 2. Mathematical Preliminaries Theorem 2.2. [Carmo, 1976] Let w be a vector field in an open set U  Rn . For each p  U there exist a neighborhood V  U of p, an interval I, and a mapping  : V √ó I  U such that (i) For a fixed p  V, the curve (q, t), t  I, is the trajectory of w passing through q, such that  ( q, 0) = q,  (q, t) = w ((q, t)) t (2.7)

(ii) the parameterized curve  is differentiable. This means that the trajectory passing through q "varies differentiably with q." Geometrically this means that all trajectories which pass, for t = 0 in a certain neighbourhood V of q may be collected into a single differential map as seen in Figure 2.1. The map  is called the (local) flow of w at q.

F IGURE 2.1: Differential maps of a trajectory.

Proof. For proof of Theorem 2.1 and Theorem 2.2, please see sections "Lipschitz Conditions" and "Existence and Properties of Solutions of the System" in Hurewicz [Hurewicz, 1952]. Using Theorem 2.1 and Theorem 2.2, the following Lemma can be stated. Lemma 2.3. Let w be a vector field in an open set U  Rn and let p  U be such that w( p) = 0. Then there exist a neighborhood W  U of p and a differentiable function f : W  R such that f is constant along each trajectory of w and d f q = 0 for all q  W. Proof. See do Carmo [Carmo, 1976], pp. 177.

17

CHAPTER 2. Mathematical Preliminaries

2.3

Homogeneity of Functions

The following definitions are required facts about homogeneity of functions and vector fields. Definition 2.3.1. Dilation. Dilation is a mapping depending on the dilation coefficients ri > 0 for i = 1, ..., n, define r = (r1 , ..., rn )  Rn . Then, for any  > 0, x  Rn , we define the dilation
r ( x ) = [ r1 x , ..., rn x ] T to assign a global diffeomorphism.  n 1

Definition 2.3.2. Homogeneity of Functions. Let V : Rn  R, then it is said to be homogeneous of degree k with respect to dilation
r if  r V ( ( x )) = k+ri V ( x ),

for all  > 0 and x  Rn . Definition 2.3.3. Homogeneity of Vector Fields. Let f : Rn  Rn , then it is said to be homogeneous of degree k with respect to dilation
r if  r f i ( ( x )) = k+ri f i ( x ),

for all i = 1, ..., n,  > 0 and x  Rn , where f ( x ) = [ f 1 ( x ), ..., f n ( x )] T . A system is called homogenous if its vector field is homogenous.
r , then Proposition 2. Let V : Rn  R be homogenous of degree k with respect to  r , such that V (0) = 0. Let f : Rn  Rn be homogenous of degree k with respect to 

k = -ri for i = 1, ..., n, then f (0) = 0.
r (0)) = k V (0) for any  > 0, from which it follows that Proof. We have V (0) = V (

V (0) = 0. Similarly one finds that f (0) = 0 provided k = -ri for i = 1, ..., n. Proposition 3. (Rosier) [Rosier, 1992]. Let V : Rn  R be continuously differentiable and homogeneous of degree with respect
r . Then, its partial derivatives satisfy to 

V r ( ( x )) =   xi  18

-ri

V ( x ),  xi

CHAPTER 2. Mathematical Preliminaries for all i = 1, ..., n,  > 0 and x  Rn . Furthermore, if V (0)/ x = 0. Proof. By definition,
r (x) V (r1 x1 , ¬∑ ¬∑ ¬∑ , ri xi + h, ¬∑ ¬∑ ¬∑ , rn xn ) - V  V r ( ( x )) = lim .  xi h h 0

= ri for i = 1, ..., n, then

¬Ø = h/ri . This leads to Consider the change of variable h ¬Ø , ¬∑ ¬∑ ¬∑ , rn x n - V r ( x ) V  r1 x 1 , ¬∑ ¬∑ ¬∑ ,  r i x i + h V r  ( ( x )) = lim , ¬Ø / ri  xi h 0 h ¬Ø , ¬∑ ¬∑ ¬∑ , xn - V ( x ) V x1 , ¬∑ ¬∑ ¬∑ , x i + h , =  lim ¬Ø / ri h 0 h V =  ( x ),  xi where homogeneity of V ( x ) has been used in the second step. V (0)/ x = 0 if We see that

= ri for i = 1, ¬∑ ¬∑ ¬∑ , n as shown similarly to Proposition 1. This

concludes the proof. Proposition 4. Let V : Rn  R be continuously differentiable and homogeneous of degree
r , and let f : Rn  Rn be homogeneous of degree k with respect to r . with respect to  

Then, L f V ( x ) is homogeneous of degree

r . Furthermore, if either + k with respect to 

= ri , k = -ri or + k = -ri for i = 1, ..., n, then L f V (0) = 0.
Proof. By definition,
r L f V ( ( x )) = r r ( x )) f i ( ( x )),   xi ( n

V

i =1 n

=

i =1

  -r  x i ( x )  k +r f i ( x ),
i i

V

=  = 

+k +k

i =1

  x i ( x )  i ( x ),
f

n

V

L f V (x)

r follows from PropoHere, L f V ( x ) is homogeneous of degree + k with respect to 

sition 2. The last statement in the proposition follows from Propositions 1 and 2. This concludes the proof. Proposition 5. (Bhat et. al.) [S.P. Bhat and Bernstein, 2005]. 19

CHAPTER 2. Mathematical Preliminaries Consider two continuous functions f 1 , f 2 : Rn  R, homogeneous of degrees k1 , k2
r . In addition, suppose that f is positive definite. respectively with respect to dilation  1

Then,
k2 /k1 k2 /k1 - c1 f 1 ( x )  f 2 ( x )  - c2 f 1 ( x ),  x  Rn ,

(2.8)

where c1 = - minx: f1 (x)=1 f 2 ( x ) and c2 = - maxx: f1 (x)=1 f 2 ( x ). Proof. Define the set E = { x : f i ( x ) = 1}. Since f 1 ( x ) is continuous, the set E is closed. Furthermore, it can shown that since f 1 is continuous, homogenous and positive-definite, f 1 is radially unbounded, and therefore E is a bounded set. Consequently, E is compact. Hence, c1 and c2 are well-defined, and hence by definition,

- c1  f 2 ( x )  - c2 ,
for all x  E. Now, consider any x = 0. Then, setting y = r -1/k1
f1

(2.9)

(x)

( x ), we have by

homogeneity that f 1 (r -1/k1
f1

f 1 (y) =

(x)

( x )),

-1/k1 = ( f1 ( x ))k1 f 1 ( x )),

= 1.
Hence, y  E, and by (2.9),

- c1  f 2 (y) = f 2 (r -1/k1
f1

(x)

( x ))  -c2

(2.10)

By homogeneity f 2 (r -1/k1
f1

(x)

-1/k1 -k2 /k1 ( x )) = ( f 1 ( x ))k2 f 2 ( x )) = f 1 ( x ) f 2 ( x ). Substi-

tuting this into (2.10) and rearranging yields (2.8) for all x  R\ {0}. Finally, (2.8) holds trivially for x = 0, by Proposition 1 this concludes the proof. Proposition 6. (Rosier) [Rosier, 1992]. Consider the map  : (0, ) √ó Sn-1  Rn \{0} (where Sn-1 denotes the unit sphere in
r ( x ). Then,  is a bijection. Furthermore, denoting its inverse Rn ), defined by (t, x ) = t

-1 : Rn \{0}  (0, ) √ó Sn-1 , by ( x ) = -1 ( x ) = (t ( x ), y ( x )). 20

CHAPTER 2. Mathematical Preliminaries Then, t , y are C  on Rn \{0}, and lim t ( x ) = .

x 0

lim t ( x ) = 0,

x 

2.4

Lyapunov Stability of Systems

Consider the system described by

 = f ( x, t ). x

(2.11)

Definition 2.1. (Lyapunov stability) The equilibrium point xe = 0 of (2.11) is said to be 1. stable if, for every

> 0, there exist a  = ( ) > 0 such that
x (0) < 0  x ( t ) <

t  0,

(2.12)

2. unstable if it is not stable, 3. asymptotically stable if it is stable and  can be chosen such that

x(0) <   lim x(t) = 0.
t

(2.13)

Definition 2.4.1. Exponential stability. The equilibrium point xe = 0 of (2.11) is exponentially stable if there exist positive constants , k, and  such that x ( t )  k x (0) e -  t,

 x (0)    t  0

(2.14)

Given the definitions, we can now state the Lyapunov theorem for stability. Theorem 2.4 (Lyapunov theorem). Let V : D  R be a continuous differential function such that V (0) = 0 and V (x) > 0 in D \ {0} . (2.15)

The equilibrium point xe is said to be 21

CHAPTER 2. Mathematical Preliminaries 1. stable if  (x)  0 V 2. asymptotically stable if  (x)  0 V

x  D,

(2.16)

 x  D \ {0} .

(2.17)

The above definitions and theorem are valid in a neighborhood D around an equilibrium point. We define the theorem for global stability next. Theorem 2.5. Let V : Rn  R be a continuous differential function such that

V (0) = 0

and

V (x) > 0

x = 0.

(2.18)

If V (x) is radially unbounded ( x    V (x)  ) and  (x) < 0 V

x = 0,

(2.19)

then the equilibrium point xe = 0 is said to be globally asymptotically stable. Definition 2.4.2. Invariant set. A set S in the phase space is said to be invariant with respect to (2.11) if

x (0)  S  x ( t )  S

 t  R.

(2.20)

Definition 2.4.3. Positively invariant set. A set S in the phase space is said to be positively invariant with respect to (2.11) if x (0)  S  x ( t )  S We can now state La Salle's theorem. Theorem 2.6 (La Salle's theorem). Let   D be a compact set that is positively invariant with respect to (2.11). Let V : D  R be a continuously differentiable function such that  (x)  0 in . Let E be the set of all points in  where V  (x) = 0. Let M be the largest V invariant set in E. Then every solution starting in  approaches M as t  .

t  0.

(2.21)

22

CHAPTER 2. Mathematical Preliminaries

2.4.1

Finite-time stability

Consider the system  = f ( x, t), f (0, t) = 0 t  0, x (2.22)

where f : U √ó R+  R is continuous on an open neighbourhood U of the origin x = 0. The origin of the system is (locally) finite-time stable if it is Lyapunov stable and finite-time convergent in a neighborhood U0  U of the origin. Finite-time convergence means that for any non-zero initial condition x (t0 ) = x0  U0 at any initial time t0  R+ , there exists a settling time T ( x0 , t0 ) > 0 such that every solution x (t; t0 , x0 ) is defined for [t0 , T ), x (t; t0 , x0 )  U0 \{0} for t0  t  T , x (t; t0 , x0 ) = 0 for t > T and limtT x (t; t0 , x0 ) = 0. When U = U0 = Rn , the origin of the system is said to be globally finite-time stable. Next we illustrate some Lyapunov finite-time stability results. Lemma 2.7. Suppose that there is a continuously differentiable positive-definite function V ( x ) on a neighborhood U1  U of the origin, such that L f V ( x )  -kV  ( x ),  x  U1 , t  R+ ,

(2.23)

where k > 0 and 0 <  < 1, and L f V ( x ) is the Lie derivative of V along the trajectory f ( x, t). then the origin of the system (2.22) is locally finite-time stable. The settling time satisfies T ( x (t0 ), t0 )  t0 + V 1-  ( x (t0 ))/ (k (1 - )) . (2.24)

Proof. The condition (2.23) implies that the origin is asymptotically stable (since  = L f V ( x ) < 0 in a neighborhood of the origin, and V ( x ) does not depend on t V (otherwise additional conditions on V might need to be considered)). Consequently, there exists a neighborhood U0  U1 of the origin that x (t0 )  U0 implies that x (t; t0 , x0 )  U0 for all t  t0 and limt x (t; t0 , x0 ) = 0. Now, consider a trajectory such that of (2.22) and along this trajectory, using (2.23), we have  ( x (t))  -kV  ( x (t)), V ¬Ø) for some t ¬Ø > t0 . for all t > t0 . Suppose thatx (t; t0 , x0 ) = 0 on some interval t  [t0 , t 23

CHAPTER 2. Mathematical Preliminaries Then, define a function W ( x ) = V 1-  ( x ). Since this is continuously differentiable ¬Ø) on U1 \ {0}, we have for t  [t0 , t  ( x (t)) = (1 - ) V -  ( x (t))V  ( x (t))  -k (1 - ) V -  ( x (t))V  ( x (t)), W

which leads to  ( x (t))  -k (1 - ) . W Integrating this from t0 to t, we obtain the following: W ( x (t))  W ( x (t0 )) - k (1 - ) (t - t0 ) .

(2.25)

Hence, W ( x (t)) and V ( x (t)) must converge to zero in finite-time and this occurs when the right-hand side of (2.25) becomes zero, which happens when V ( x (t0 ))1-  = W ( x (t0 )) = k (1 - ) t - k (1 - ) t0 ,

which can be rearranged to give the right-hand side of (2.24). This concludes the proof.

2.5

Optimal Control

The general notion of the optimal control problem is to search for a control sequence or history of the control vector u(t)  U for t0  t  t f , in which forces the system state from initial value to its final value along a trajectory and minimizes (or maximizes) a cost function, J (q(t), u(t), t). The state history q(t)  M for t0  t  t f in which a result from the application of the (optimal) control history is called an optimal trajectory. Consider the control system of the form: u ( t )  U  Rm

 ( t ) = f u ( q ( t ), u ( t ), t ), q

q ( t )  M,

(2.26)

where M is a class C  -manifold, U is an arbitrary subset of Rm called the control set and f u (q(t), u(t), t) is a smooth vector field on M for a given u(t)  U . Moreover, the

24

CHAPTER 2. Mathematical Preliminaries admissible controls u(t)  U are locally bounded mappings. Next, we substitute the control u(t) into the control system (2.26) to obtain a ordinary differential equation  (t) = f u (q(t), u(t), t). By Carath√©odory's Theorem, any point q0  M the system q can be identified as a Cauchy problem [Agrachev and Sachkov, 2004]

 ( t ) = f u ( q ( t ), u ( t ), t ) q

q ( t0 ) = q0

(2.27)

which has a unique solution. In order to find the optimal control, we need to compare all the admissible controls attainable on the interval t0 , t f by using the following cost functional:
tf t0

J ( q ( t ), u ( t ), t ) =  q ( t f ), t f +

L [qu (t), u(t), t] dt

(2.28)

where  : M √ó R  R is the end cost function, the integrand L : M √ó U √ó R  R (also known as the Lagrangian) is a continuous mapping, qu (t) is a corresponding solution (optimal trajectory) to problem (2.28) and u(t) is the control history on interval t0 , t f .

2.5.1

The optimal control problem

Given all admissible control u = u(t) in t  t0 , t f , find the corresponding solution qu (t) of the Cauchy problem that minimizes the cost functional J (q(t), u(t), t) and satisfying the boundary condition:
tf t0

minimize such that

J ( q ( t ), u ( t ), t0 , t f ) =  q f , t f +

L [qu (t), u(t), t] dt

(2.29)

 (t) = q

f u ( q ( t ), u ( t ), t )

e L  e ( q0 , q f , t0 , t f )  eU h L  h ( q ( t ), u ( t ), t )  hU where q0  q(t0 ), q f  q(t f ), e L , eU  R Ne are the lower and upper bounds on the endpoint function, e : M √ó M √ó R √ó R  R Ne , h L , hU  R Nh are the lower and 25

CHAPTER 2. Mathematical Preliminaries upper bounds on the constraints function, h : M √ó U √ó R  R Nh . It is assumed that all nonlinear functions in problem (2.29) are continuously differentiable and Lipschitz-continuous over the domain M √ó U √ó R √ó R. The optimal control problem is the minimization problem for J (q(t), u(t), t0 , t f ) with control constraints and fixed boundary conditions.

26

CHAPTER 3

Velocity-Free Nadir-pointing Attitude Stabilization
This chapter examines the attitude stabilization of an underactuated nadir-pointing rigid spacecraft in a circular orbit in the presence of time-varying disturbances without any angular velocity measurements (velocity-free). The aim of this chapter is to develop a control system capable of stabilizing the underactuated rigid-body spacecraft system relative to its orbit. This is particularly important to satellites; for example, to ensure optimal positioning antenna for stable communication or the pointing of Earth-observing payloads. The spacecraft is placed in an orbital frame and the goal is to stabilize the spacecraft relative to this frame. Aside from spacecraft control we investigate a case where the angular velocity measurements is not available. A nonlinear observer is used to estimate the angular velocity of the spacecraft to complete an output feedback control law. A sliding mode control strategy is proposed for this stabilization problem in conjunction with a nonlinear observer. The Local ultimate-boundedness of the closed-loop system is rigorously proven. Numerical examples demonstrate the performance of the controller in the presence of timevarying disturbances, non-zero orbital eccentricity, inertia matrix uncertainties and measurement noise in a sampled-data implementation. In particular, even though the theoretical ultimate-boundedness guarantees are local, the numerical examples demonstrate ultimate-boundedness even with large initial attitude errors.

27

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization

3.1

Introduction

Angular velocity is a vital information that is required by most control strategies, measured using sensors or computed numerically using various parameterizations [Hughes, 1986]. There are works in literature investigating the underactuated spacecraft, some relevant results are outlined here. Authors in [Gui, Vukovich, and S. Xu, 2015] successfully treated the control of underactuated rigid spacecraft with two internal control torques by using a transverse function method and recently, in [Gui and Vukovich, 2017], a finite-time angular velocity observer was proposed. While the majority of the existing research in the literature on spacecraft attitude control use full-state feedback (attitude and angular velocity measurements are available) for control law formulation as such in the works by [G. Godard and K. Kumar, 2010; Godard, K. Kumar, and A. Zou, 2013; G. Godard, 2010; Trumpf et al., 2012; Khosravian and Namvar, 2012; Khosravian and Namvar, 2010; Tayebi, 2007; Seo and Akella, 2007], there has also been interest in velocity-free attitude control, since the availability of angular velocity measurements is not always satisfied for reasons such as cost limitations or rate gyro failure. The use of nonlinear observers were first discussed by [Salcudean, 1991], where the motivation was to obtain the angular velocity of a rigid-body from orientation and torque measurements only, without the noisy numerical differentiation. Examples of velocity-free control include [Lizarralde and Wen, 1996], where the authors developed a nonlinear filter of the quaternion using passivity approach without directly utilizing angular velocity measurements for a robot control problem. [Thakur and Akella, 2015] utilized velocity-free attitude-stabilization control law that ensures stabilization to the prescribed constant orientation using solely on vector measurements for feedback. Chunodkar and Akella [Chunodkar and Akella, 2014] developed an exponentially converging switching velocity observer for rigid-body attitude tracking control without angular velocity measurements and is independent of controller design and proved almost global exponential stability for the estimation error dynamics. The switching framework enabled the addition of terms to ensure Lyapunov stability. Recent works regarding velocity-free attitude control problem is published by [Xiao et al., 2014] and [Zlotnik and J. R. Forbes, 2017], where the

28

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization authors in [Xiao et al., 2014] developed a velocity-measurement free control scheme in conjunction with a nonlinear observer for fault-tolerant control system of a fully actuated spacecraft with actuator torque bias and in the presence of external disturbances. [Zlotnik and J. R. Forbes, 2017] developed nonlinear attitude estimator based on direct vector measurements while utilizing the attitude error function to achieve desirable convergence properties. To the author's best knowledge, velocity-free underactuated spacecraft attitude control has not been dealt with in the existing literature. The majority of the aforementioned literature on underactuated spacecraft attitude control is for stabilization to an inertially fixed desired attitude. By contrast, this chapter considers the underactuated attitude stabilization to a nadir-pointing attitude, similar to [Godard, K. Kumar, and A. Zou, 2013; G. Godard, 2010; G. Godard and K.D. Kumar, 2011] which outlined strategies involving the control of different underactuated axes. Notable improvements in this chapter over Godard et al. [Godard, K. Kumar, and A. Zou, 2013; G. Godard, 2010] include the following: 1) the control law in this chapter does not require angular velocity measurements; 2) the control law in this chapter does not require knowledge of the disturbance torques (needed in the computation of the higher order sliding mode in Godard et al. [Godard, K. Kumar, and A. Zou, 2013; G. Godard, 2010]); 3) this chapter considers the full nonlinear dynamics in the analysis of the closed-loop system behavior within a boundary layer of the sliding mode; 4) The full-state feedback in [G. Godard and K.D. Kumar, 2011] utilized higher order sliding mode which required a priori knowledge of the disturbances that needed to be met, this is not the case for the full-state feedback control law developed here. Chapter 3 is organized in the following manner. Section 3.2, presents the problem formulation including the development of the relative underactuated rigid-body spacecraft attitude dynamics and the control objective needed to be solved. In section 3.3 homogeneity of functions is used to design the observer-based control law, and the stability analysis is rigorously presented. Several examples of umerical simulations demonstrating the observer-based control law performance are included in Section 3.5. Finally, Section 3.6 summarizes the chapter.

29

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization

3.2

Problem Formulation

In this section the coordinate system used, the kinematics and dynamics of the spacecraft model are outlined, and the attitude control problem is defined.

3.2.1

Coordinate frames

As seen in Figure 3.1, the Earth-centered inertial frame, denoted by F I , has its origin at the center of the Earth, with the Z-axis passing through the celestial north pole, the X -axis directed towards the vernal equinox, and the Y -axis completes the righthanded triad. The orbital frame, as denoted by Fn , follows the instantaneous flight path with origin at the spacecraft's center of mass with the zn -axis pointing in the nadir direction, the yn -axis points along the direction of the orbit anti-normal and the xn -axis completing the triad. The spacecraft body-fixed frame is denoted by Fb .

F IGURE 3.1: Coordinate Topologies

30

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization

3.2.2

Spacecraft attitude kinematics and dynamics

The spacecraft is assumed to be in a Keplerian circular orbit of radius R. The corresponding orbital angular velocity is 0 = ¬µ/ R3 , where ¬µ  R represents the

gravitational parameter of the Earth [Ruiter, Damaren, and J. Forbes, 2013]. The orientation of the body-fixed frame relative to the orbital frame is represented by a unit quaternion [
T

 ] T  S3 , which can be written as    (3.1)   e sin(/2)  = ,  cos(/2)

  

where e  S2 and   [- ,  ] are the corresponding principal axis and angle of rotation, respectively. Note that   R is the scalar part. The corresponding transformation matrix Cbn  SO(3) that describes the rotational transformation from orbital coordinates to body coordinates is given by Cbn = ( 2 -
√ó
T T

 R3 is the vector part of the quaternion, while

)I + 2

- 2

√ó

,

(3.2)

where

 R3√ó3 denotes the skew-symmetric matrix of the vector as given by
 0
√ó

-
0
2 1


3 2

  =  

3

-
0

1

-

  .  

(3.3)

With the defined orbiting frame Fn , the angular velocity of spacecraft relative to the inertial frame, bI  R3 , given in the body-fixed frame is given by, bI = bn - 0 Cbn e2 , where, bn  R3 is the relative body-orbital angular velocity.

(3.4)

31

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization The kinematics equation of the spacecraft relative to the orbiting frame Fn are given by,    1  I +     =  2  - T 
√ó

   bn . (3.5)

The spacecraft dynamics are governed by Euler's equation given by [Hughes, 1986]
√ó  bI + bI J bI = u + g + d , J

(3.6)

where J  R3√ó3 is the spacecraft inertia matrix, u is the control torque, g is the gravity-gradient torque and d are the all other disturbance torques acting on the spacecraft. The spacecraft inertia matrix is assumed to have the form

J = diag{ Jx , Jy , Jz }.

It is assumed that the spacecraft is only actuated about the pitch and yaw axes, such that u = [0, y , z ] T . (3.7)

Remark. If the underactuated axis is the pitch axis, then due to the nature of the attitude dynamics of the spacecraft, three-axis stability is not achievable directly. The torque due to the gravity gradient, is given by [Hughes, 1986]
2 g = 30 (Cbn e3 )√ó JCbn e3 .

(3.8)

3.2.3

Control objective

The control objective in this chapter is to regulate the body-orbital states ( , bn ) to a neighborhood of the origin, without the use of angular velocity measurements. Due to the assumption of bounded time-varying disturbances, there is no stable equilibrium for which the control can drive to and due nature of underactuated system, it is more realistic to state that control objective be in the neighbourhood of the origin.

32

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization Substitution of (3.4) and (3.8) into (3.6), together with (3.5) lead to the equations of motion for and  , which are 1 ( I + 2
√ó



=

)bn ,

(3.9)

 bn = J -1 -(bn - 0 Cbn e2 )√ó J (bn - 0 Cbn e2 ) 
2 √ó + 3 0 (Cbn e3 )√ó JCbn e3 - 0 J bn Cbn e2 + u + d ,

(3.10)

3.3

Design of Underactuated Attitude Control Law

Since a local stability result will be obtained in this chapter, it is assumed that  (t) > 0 for all t  0 (the attitude error does not reach 180 degrees in rotation). Since ( ,  ) and (- , - ) represent the same attitude, one can take (choose the representation

( ,  ) for which  > 0)
= 1-
T

.

(3.11)

The kinematics in (3.9) can therefore be written as 1 1  + ( A( ) - I ) , 2 2

=

(3.12)

where A( ) = 1-
T

I+

√ó

(3.13)

The following well-known fact will be useful:

A( ) = 1,

(3.14)

for all satisfying Proposition 7.

 1. Using (3.14), the following result can be obtained. (1 + ), for all satisfying (1 - a ) - 1 = 1 -   1.
1 - a for 0  a  1,

A( ) - I 

Proof. Consider the function f ( a) =

and define g( a) = a - f ( a). The derivative of g( a) for 0  a  1 is given by 1 dg = 1-  da 2 1-a

33

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization Hence, at a = 0 we have dg/da = 1/2. This means that g( a) is initially increasing. Hence since g(0) = 0, we have g( a) > 0 for 0  a  , for some 1  a  0. Now, suppose that at some point 1  a > , g( a) < 0. By the intermediate value ¬Ø < a, such that g( a ¬Ø ) = 0. This point theorem (since g is continuous), there exist  < a  ¬Ø) = a ¬Ø . Expanding and re-arranging gives 1 - a ¬Ø = 1-a ¬Ø , which implies satisfies f ( a ¬Ø )2 = 1 - a ¬Ø , which leads to a ¬Ø (1 - a ¬Ø ) = 0. This has only two possibilities, that (1 - a ¬Ø = 0, 1. Hence, we have g( a)  0 for all 0  a  1, which implies that f ( a)  a for a all 0  a  1. Consequently, taking a =
T

, we have
2

1-

T

-1 

for all satisfying

 1. Finally,
A( ) - I

=  

( 1- ( 1-
2

T T

- 1) I + - 1) I +
,

√ó

,
√ó

,

+

where

√ó

=

has been made used of. This concludes the proof.

Proposition 7 shows that the kinematics in (3.12) consist of a linear part and a second order part in ( , bn ). A similar expansion for the dynamics equation in (3.10) is now obtained. First, rewrite (3.10) as
√ó √ó √ó  bn = J -1 -bn  J bn + 0 (bn J - J bn - ( J bn )√ó )Cbn e2
2 2 + 3 0 (Cbn e3 )√ó JCbn e3 - 0 (Cbn e2 )√ó JCbn e2 + u + d .

(3.15)

Each of the terms on the right hand side of (3.15) is now expanded. It is essential to separate the linear and nonlinear terms of the equations of motion. This will allows each term to be analyzed and design a control system to drive these terms to an

34

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization ultimately bound. First, we have 
Jy - Jz Jx  y  z Jz - Jx Jy  x z Jx - Jy Jz  x y

   ,   (3.16)

-J

-1

√ó bn J bn

  =  

which is second order in  . Next, using the identity

√ó √ó

=

T

-

T

I [Hughes,

1986] together with (3.11) and the definition in (3.13), we get 2 - 1-
T T T T

Cbn =

I+2 I+2

- 2 - 2

√ó √ó

,

=

,

= I+2

√ó √ó

- 2
√ó √ó

√ó

, , (3.17)

= I + 2 I - = I - 2 AT ( )
Consequently, Cbn e2 = e2 - 2 A T ( ) (3.15) becomes  0 J
-1 √ó (bn J √ó,

√ó

.

and upon expansion the second term in

-

√ó J bn

- ( J bn ) )Cbn e2

√ó

  =   

Jx + Jz - Jy 0  z Jx

     
√ó

0

-

Jx + Jz - Jy 0  x Jz

+20 J -1 (( J AT ( ) - J ( AT ( )
√ó

e2 ) √ó
√ó

e2 ) √ó - ( A T ( )

e2 )√ó J )bn , (3.18)

which consists of a linear and second order part in ( , bn ). For the third term in (3.15), first expand

(Cbn e3 )√ó JCbn e3 = (e3 - 2 AT ( )

√ó

e3 ) √ó J ( e3 - 2 A T ( )
√ó

√ó

e3 ) ,
√ó

√ó √ó = e3 Je3 + 2 ( Je3 )√ó - e3 J AT ( )

e3 + 4 ( A T ( )

e3 ) √ó J A T ( )

√ó

e3 .

35

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization
√ó Since J is diagonal and e3 = [0, 0, 1] T , therefore e3 Je3 = 0. Next, using A T ( ) =

I + A T ( ) - I , we have
√ó 2 ( Je3 )√ó - e3 J AT ( ) √ó √ó e3 = 2 ( Je3 )√ó - e3 J √ó √ó e3 + 2 ( Je3 )√ó - e3 J ( AT ( ) - I ) √ó

e3 ,

and expanding the first term leads to  ( Jz - Jy )  √ó 2 ( Je3 )√ó - e3 J A T ( ) √ó e3 = 2   ( Jz - Jx )  0  
1 2

   + 2 ( Je3 )√ó - e√ó J ( A T ( ) - I ) 3  

√ó

e3 .

Making use of the above results, one obtains 
2 -1 3 0 J (Cbn e3 )√ó JCbn e3 Jz - Jy 1 Jx Jz - Jx 2 Jy

    + 6 2 ( Je3 )√ó - e√ó J ( A T ( ) - I ) 0 3  
√ó √ó

=

2 6 0

    

e3

0

2 +120 ( AT ( )

e3 ) √ó J A T ( )

√ó

e3 ,

(3.19)

which consists of a linear and second order part in ( , bn ) ( A T ( ) - I is first order in , and this is multiplied by manner, one obtains 
2 -1 - 0 J (Cbn e2 )√ó JCbn e2 Jz - Jy 1 Jx

√ó

in (3.19) making the term second order). In a similar

    - 2 2 ( Je2 )√ó - e√ó J ( A T ( ) - I ) 0 2  
√ó √ó

=

2 2 0

    

0
Jx - Jy 3 Jz

e2

2 - 4 0 ( AT ( )

e2 ) √ó J A T ( )

√ó

e2 ,

(3.20)

which also consists of a linear and second order part in ( , bn ).

3.3.1

Control design for unactuated states
T T ] T , it is now partitioned into actuated and unbn T

Defining the state vector x = [

actuated states by defining x1 = [

x ] T , and x2 = [y , z ] T . Using the above

36

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization developments, and noting that bn = x e1 + [e2 e3 ] x2 , one can now obtain the dynamics for the unactuated states as ¬Ø 11 x1 + A ¬Ø 12 x2 + g( x1 ) + h( x1 , x2 ) + d, 1 = A x

(3.21)

where      =    0 0 0
2 ( J - J )/ J 8 0 z y x

¬Ø 11 A

  0 0 1/2  0  0    1/2 0 0 0  0  ¬Ø   , A12 =   0 0 0 0  1/2     0 0 0 0 0 ( Jx + Jz - Jy )/ Jx  

     ,   

 x ( A( ) - I )e1 /2  g ( x1 ) =   a ( x1 ),

T -1 a ( x 1 ) = 2 0  x e1 J (( J A T ( )

√ó

e2 ) √ó - J ( A T ( )
√ó

√ó

e2 ) √ó - ( A T ( )

√ó

e2 ) √ó J ) e1

2 T √ó + 6 0 e1 ( Je3 )√ó - e3 J ( AT ( ) - I ) 2 T +120 e1 ( A T ( )

e3

√ó

e3 ) √ó J A T ( )

√ó

e3
√ó

2 T √ó - 2 0 e1 ( Je2 )√ó - e2 J ( AT ( ) - I ) 2 T - 4 0 e1 ( A T ( )

e2

√ó

e2 ) √ó J A T ( ) 

√ó

e2 , 

 ( A( ) - I )[e2 e3 ] x2 /2  h ( x1 , x2 ) =   b ( x1 , x2 )

b ( x1 , x2 ) =

Jy - Jz T -1  y  z + 2 0 e1 J (( J A T ( ) Jx

√ó

e2 ) √ó

- J ( AT ( )

√ó

e2 ) √ó - ( A T ( )
T

√ó

e2 )√ó J )[e2 e3 ] x2 ,

d=

0 0 0 dx / Jx

.

(3.22)

Using Proposition 7, it is clear that g( x1 ) is second order in x1 . Now, suppose that x2 can be used as a control input for the unactuated states x1 . Using the Popov-Belevitch-Hautus test [Zhou and Doyle, 1998], it can be seen that

37

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization ¬Ø 11 , A ¬Ø 12 ) is controllable if and only if the matrix [ A ¬Ø 11 -  I A ¬Ø 12 ] has full the pair ( A ¬Ø 11 - A ¬Ø 12 K is Hurwitz. rank for all   C. Consequently, let K  R2√ó4 be such that A Next, we define the sliding variable

S = x2 + Kx1 .

(3.23)

Rearranging for x2 , we have x2 = S - Kx1 , and substituting into (3.21), we obtain ¬Ø 11 - A ¬Ø 12 K ) x1 + A ¬Ø 12 S + g( x1 ) + h( x1 , S - Kx1 ) + d. 1 = (A x

(3.24)

Furthermore, from the definition of h( x1 , x2 ) in (3.21)it can be seen that h( x1 , S - Kx1 ) = h1 ( x1 ) + h2 ( x1 , S),

where h1 ( x1 ) is second order in x1 , and h2 ( x1 , S) satisfies h2 ( x1 , S )  ( a x1 + b x1
2

) S + c S 2,

(3.25)

for some a, b, c > 0. ¬Ø 11 - A ¬Ø 12 K is Hurwitz, for any Q = Q T > 0, there exists a P = P T > 0 Since A ¬Ø 11 - A ¬Ø 12 K )T P + P( A ¬Ø 11 - A ¬Ø 12 K ) = - Q [Zhou and Doyle, 1998]. Fixing such that ( A Q = Q T > 0, consider the positive-definite function
T V1 ( x1 ) = x1 Px1 .

(3.26)

Taking the time-derivative of V1 along trajectories of (3.24), leads to
T T T T ¬Ø 12 S + d) + 2x1  1 = - x1 V Qx1 + 2x1 P( A P( g( x1 ) + h1 ( x1 )) + 2x1 Ph2 ( x1 , S),

 -min ( Q) x1 +2 P (( a x1

2 2

+2 P

¬Ø 12 x1 ( A

S + d )+2 P S 2 ).

x1

g ( x1 ) + h1 ( x1 )

+ b x1 3 ) S + c x1

¬Ø, for some 0 < S ¬Ø > 0. Then, S ¬Ø and d  d ¬Ø  1, d Suppose that S  S ¬Ø. Likewise, if the domain of x1 is restricted to x1 < 1, one has x1 S
3

2

 S 
2

 x1



38

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization x1 . Consequently,  1  -min ( Q) x1 V where  =
2

+2 P

¬Ø) + 2 P ¬Ø+d x1 (  S

x1

g ( x1 ) + h1 ( x1 )

¬Ø 12 + a + b + c. Next, since g( x1 ) and h( x1 ) are second order in x1 , A

given any  > 0, there exists  > 0 such that g( x1 ) + h1 ( x1 )   x1 , for any x1 satisfying x1 < . Consequently, for all x1 satisfying x1 < min{, 1},  1  -(min ( Q) - 2 P ) x1 V
2

+2 P

¬Ø) ¬Ø+d x1 (  S

We choose 0 <  < min ( Q)/(2 P ). Next, using the upper bound of
2

min ( P) x1

 V1 ( x1 )  max ( P) x1 2 ,

(3.27)

we have  1  - (min ( Q) - 2 P ) V1 + V max ( P) ¬Ø) ¬Ø+d 2 P (S min ( P)

V1

, , (3.28)

= - V1

(min ( Q) - 2 P ) P

V1 -

¬Ø) ¬Ø+d 2 P (S min ( P)

 1 < 0 when for all x1 satisfying x1 < min{, 1}. From (3.28), one sees that V ¬Ø) ¬Ø+d 2 P 2 (S min ( P)(min ( Q) - 2 P )
2

V1 ( x1 ) >

,

(3.29)

However, recall that this only holds when x1 < min{, 1}. By (3.27), V1 ( x1 ) < min ( P)(min{, 1})2 , implies that x1 < min{, 1}. Consequently, to guarantee feasibility for (3.29), the following restriction is made: ¬Ø) ¬Ø+d 2 P 2 (S < min ( P) min{, 1}. (min ( Q) - 2 P )

(3.30)

39

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization ¬Ø are small enough. The following preliminary result ¬Ø and d This is clearly satisfied if S is obtained. ¬Ø for all t  [0, T ), ¬Ø d(t)  d Lemma 3.1. Suppose that (3.30) holds, and that S(t)  S, for some T  R+

{}. If x1 (0) satisfies V1 ( x1 (0)) < min ( P)(min{, 1})2 , then

V ( x1 (t)) < min ( P)(min{, 1})2 for all t  [0, T ). If T = , and lim supt S(t)  ¬Ø then S < S, lim sup x1 (t) 
t

¬Ø) 2 P 2 (S + d . min ( P)(min ( Q) - 2 P )

 1 < 0 when (3.29) holds. Consequently, Proof. First, note that V    2 P
2 (S ¬Ø

V1 ( x1 (t))  min

¬Ø) +d

2

min ( P)(min ( Q) - 2 P )

, V1 ( x1 (0))

  

< min ( P)(min{, 1})2 ,

¬Ø, by definition of S , there for all t  [0, T ). Next, for any  > 0 satisfying S +  < S ¬Ø  0, such that for all t  t ¬Ø, S(t)  S + /2. Consequently, in (3.28) one exists t ¬Ø by S + /2 from time t ¬Ø onwards. If can replace S ¬Ø) 2 P 2 ((S + ) + d min ( P)(min ( Q) - 2 P )
2

¬Ø))  V1 ( x1 (t

,

then, V1 ( x1 (t))  ¬Ø) 2 P 2 ((S + ) + d min ( P)(min ( Q) - 2 P )

2

,

 1 < 0 on the boundary of this set. Define the set ¬Ø, since V for all t  t


E = { x1  R :
4

¬Ø) 2 P 2 ((S + ) + d min ( P)(min ( Q) - 2 P )

2

< V1 ( x1 ) < min ( P)(min{, 1})2 }.

¬Ø) lies in the interior of E. In this case, since E is Now consider the case that x1 (t compact, and the right-hand side of (3.28) is strictly negative on E, there exists a  1  -  for all x1  E. Consequently, there exists a finite time  > 0 such that V ¬Ø, such that t >t ¬Ø) 2 P 2 ((S + ) + d min ( P)(min ( Q) - 2 P )
2

V1 ( x1 (t)) 

,

40

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization for all t  t . Since  > 0 was arbitrary, it follows that ¬Ø) 2 P 2 (S + d min ( P)(min ( Q) - 2 P )
2

lim sup V1 ( x1 (t)) 
t

.

Applying (3.27) yields the desired expression for lim supt x1 (t) . This concludes the proof.

3.3.2

Control design for actuated states

Now that the result in Lemma 3.1 has been established, the control design task is to ¬Ø for all t  0. Note that the sliding variable S in (3.23) can guarantee that S(t)  S be rewritten as S = K1 bn + K2 , (3.31)

where K1 = [k4 I ], K2 = [k1 k2 k3 ], and k i denotes the ith column of K. Defining the reduced control torque ¬Øu = [y , z ] T ,  differentiating (3.31) and utilizing (3.9) and (3.15), leads to  =  ¬Øu +  ( ,  ), S (3.32)

(3.33)

where

 0 0     -1   = K1 J  1 0  ,   0 1



and
√ó √ó √ó 2  ( ,  ) = K1 J -1 -bn J bn + 0 (bn J - J bn - ( J bn )√ó )Cbn e2 + 30 (Cbn e3 )√ó JCbn e3
2 - 0 (Cbn e2 )√ó JCbn e2 + d + K2 A( )bn /2.

We find that  ( , bn )  1 + 2 bn + 3 bn

 2= ,

for some 1 , 2 , 3 > 0.

41

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization Full-state feedback control To motivate the velocity-free case, the full state feedback case is considered first. Define the control law to be ¬Øu = -1 u ¬Ø,  where ¬Ø = - (  S +  ), u with  > 0 and  =  tanh 2 k u S ¬Ø  , (3.35) (3.34)

¬Ø > 0 and k u = 0.2785. One has the following property [Polycarpou and where  Ioannou, 1996]: ¬Ø ST  - ST    Lemma 3.2. With the control law in (3.35), one has S(t)  min{ S(0) , ¬Ø/  (3.36)



¬Ø/}, and 

lim sup S(t) 
t

T Proof. Define Vs (S) = 1 2 S S. Differentiating along a trajectory of (3.33) with control

¬Ø. The conclusion can be  s  -2Vs +  law (3.35), and using (3.36) one obtains V reached by applying similar arguments as in the proof of Lemma 3.1. The main result for the full state feedback case can now be presented. ¬Ø,  in (3.35), such that  ¬Ø/ < S. ¬Ø Then, Theorem 3.3. Suppose that (3.30) holds. Select  provided x1 (0) and x2 (0) are chosen such that V1 ( x1 (0)) < min ( P)(min{, 1})2 and ¬Ø the following holds S(0)  S,

 ¬Ø) ¬Ø/ + d 2 P 2 (  lim sup x1 (t)  . min ( P)(min ( Q) - 2 P ) t
Proof. This follows immediately from Lemmas 3.1 and 3.2.

42

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization Velocity-free feedback control This subsection investigates the case where only the attitude error quaternion

( ,  )  S3 is available. The relative angular velocity bn is replaced in the con^ bn which comes from a finite-time observer that is trol law (3.35) by an estimate  ^ bI of the defined in the next section. The observer will actually provide an estimate  ^ bI , such that the estimate  ^ is obtained from spacecraft inertial angular velocity 

^ bn =  ^ bI + 0 Cbn e2 . 

(3.37)

^ bI is defined as The estimation error of  ~ = bI -  ^ bI . 

(3.38)

Consequently, since bn = bI + 0 Cbn e2 , one has ^ bn = bn -  ~ 

(3.39)

^ bn in (3.35) results in the control law Replacing bn with  ^+ ^ ), ¬Ø = -(S u

(3.40)

where ^ = K1  ^= ^ tanh ^ bn + K2 ,  S ^ ^ ku S 2 ¬Ø  ^ = 1 + 2  ^ bn + 3  ^ bn , 
2

. (3.41)

Recall that x = [ be rewritten as

T

T ] T . Using (3.35), (3.39) and (3.40), the control input (3.40) can bn

¬Ø = -(S + ) + u ¬Ø ( x,  ~ ), u where ^, ¬Ø ( x,  ~ ) =  K1  ~ +- u

(3.42)

(3.43)

^ in (3.40) can be viewed as a function noting that  in (3.35) is a function of x, while  ~ ) because of (3.39). Next, note that u ¬Ø in (3.43) is continuous in ( x,  ~ ) on of ( x, 

43

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization ¬Ø ( x, 0) = 0 for all x  R6 . R6 √ó R3 . Furthermore, u ~ )  R6 √ó R3 : x  r,  ~ = Proposition 8. Fix r > 0 and define the set W = {( x,  ~ 0}. Then, for any  > 0 there exists an (r ) > 0 such that  ¬Ø ( x,  ~ ) <  for all x satisfying x  r. u Proof. First, note that the set W is compact. Next, choose arbitrary  > 0. Conti¬Ø implies that for each point ( x, 0)  W , there exists nuity of u
x

< (r ) implies that

> 0 such that

¬Ø ( y,  ~ ) <  for all (y,  ~ )  B x ( x ) √ó B x (0) (where B ( x ) denotes the open ball of u radius centered on x). Next, the collection of all such sets B x ( x ) √ó B x (0) (with x  ¬Ø r (0)) form an open cover of W . Hence, since W is compact, there exist x1 , ..., xn  B ¬Ø r (0), such that W  B ~)  for all (y,  ¬Ø r (0) √ó B B
(r ) (0)
n i =1 n i =1

B xi ( xi ) √ó B xi (0). By construction,

¬Ø ( y,  ~) u
x1 , ..., xn }.

< 
Then,

B xi ( xi ) √ó B xi (0). Define (r ) = min{



n i =1

B xi ( xi ) √ó B xi (0), from which the conclusion follows.

Using Proposition 8, one obtains the following extension of Lemma 3.2. ¬Ø), where t ¬Ø  R+ Lemma 3.4. Fix r > 0, and suppose that x (t)  r for all t  [0, t

{  }.

¬Ø) im~ (t) < (r ) for all t  [0, t Then, for a given  > 0, there exists (r ) > 0 such that  plies that S(t)  min{ S(0) , ( + ¬Ø = , then if t lim sup S(t) 
t

¬Ø)/(2)} for all t  [0, t ¬Ø). Furthermore, 2 + 4  ¬Ø 2 + 4  2

+

1 T Proof. Define Vs (S) = 2 S S. Differentiating along a trajectory of (3.33) with control

¬Ø + ST u  s  -2Vs +  ¬Ø . Using Proposition 8, one obtains for law (3.42), one obtains V   ¬Ø. From this, it can be obtained that V s < 0  s  -2Vs +  2 Vs +  ¬Ø) that V t  [0, t when  Vs > 1 8 + ¬Ø 2 + 4   2 

The conclusion follows by applying similar arguments as in the proof of Lemma 3.1.

3.3.3

Observer design

Let q = (qv , q4 )  S3 be a unit quaternion representation of the spacecraft inertial attitude (note that this is directly related to ( ,  ), since the orbiting frame is known). 44

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization The spacecraft equations of motion relative to the inertial frame are then given by 1 B(q)bI , 2

 = q  bI J

(3.44) (3.45)

√ó = -bI J bI + g + u + d ,

where





 P(q)  √ó B(q) =   , P ( q ) = q4 I + q v . T -qv ^,  ^ bI be the estimates of q, bI respectively, and define the attitude estimation Let q ~ = (q ~v , q ~4 ) by C (q ~) = C ( q ) C T ( q ^) and  ~ = bI -  ^ bI , where error q
T T √ó C ( q ) = ( q2 4 - q v q v ) I + 2q v q v - q4 q v ,

(3.46)

^ satisfy is the rotation matrix corresponding to q. Let q  = 1 B(q ^ ^) p, q 2

(3.47)

 (q ^) = - p √ó C ( q ^). Consequently, it is for some p, or equivalently [Hughes, 1986], C  (q ~) = -(bI - C (q ~) p ) √ó C ( q ~), which is equivalent to straightforward to show that C  = B(q ~ ~)(bI - C (q ~ ) p ). q

(3.48)

The observer is now defined as  = ^ q  bI ^ J 1 ^) C T ( q ~)  ^ bI + 1 P-1 (q ~)sig (q ~v ) , B(q 2

(3.49) (3.50)

√ó ^ bI ^ bI + g + u + 2 J sig1 (q ~v ), = - J

~) is invertible where 1 , 2 > 0,   (1/2, 1), and 1 = 2 - 1. Note that P-1 (q ~v provided q

< 1. Since a local stability result is obtained, this restriction poses

no problem. Utilizing (3.45), (3.47), (3.48), (3.49), and (3.50), one obtains the error

45

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization equations v = ~ q 1 ~)  ~ - 1 P-1 (q ~)sig (q ~v ) , B(q 2

(3.51) (3.52)

√ó √ó  = -2 sig1 (q ~ ~v ) - J -1 (bI ^ bI ^ bI ) + J -1 d .  J bI -  J

~ , it is straightforward to show that Next, using the definition of 
√ó √ó √ó ^ bI ^ bI =  ~ √ó J bI + bI ~ - ~ √ó J ~. bI J bI -  J J

~v < 1, Finally, since a local stability result is pursued, with the assumption that q
T,  ~ T ] T , the observer error dynamics in (3.51) and ~4 > 0. Defining x ~ = [q ~v choose q

(3.52) can be written as ~,  = g ( x ~ ~ ) + f (q ~v ,  ~ , bI ) + d x

(3.53)

where       (3.54) ~)  ~v ,  ~)  0   g1  ( x  f 1 (q ~=  ~) =  ~v ,  ~ , bI ) =  g ( x ,  , f (q , d  ~) ~ , bI ) g2  ( x f 2 ( J -1 d ~) =  ~ /2 - 1 sig (q ~ v ) , g2  ( x ~ ) = -2 sig1 (q ~v ) g1  ( x ~v ,  ~) = f 1 (q 1 ~v ) - I )  ~, ( A(q 2

√ó ~ , bI ) = - J -1  ~ √ó J bI + bI ~ - ~ √ó J ~ . f 2 ( J

It can be verified that g is homogeneous of degree k =  - 1 with respect to the
r (x T ,   ~ T ]T . ~ ) = [q ~v dilation 

A strict Lyapunov function will now be constructed for the nominal system cor~  0). For the purposes of Lyapunov function responding to (3.53) (with f  d construction, the requirement on  will be relaxed to   (1/2, ). When  = 1, the ~ ) becomes vector field g ( x ~) = Mx ~, g  =1 ( x

46

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization where

  -1 I M= -2 I

 I /2  . 0

This is Hurwitz for any 1 , 2 > 0. Consequently, for fixed 1 , 2 > 0 there exists a positive-definite symmetric matrix N  R6√ó6 such that MT N + N M = - I .

(3.55)

¬Ø (x ~) = x ~T N x ~ . Note that this is infinitely continuously differentiable, Next, define V positive-definite and radially unbounded. Furthermore, by (3.55), one has ¬Ø (x ~) = - x ~ L g  =1 V
2

< 0.

(3.56)

The procedure in Rosier [Rosier, 1992] is now used to construct a homogeneous ¬Ø . To this end, define Lyapunov function from V
 0+

~) = V ( x

1 t
+1

¬Ø ( r () ( x ~ )))dt, a (V t

(3.57)

where  2 and a  C  (R, R) satisfies    0, t  (-, 1], a(t) =   1, t  [2, ) with da/dt  0 for all t  R. From the results in Rosier [Rosier, 1992], one obtains the following properties of V : Proposition 9. V : Rn  R in (3.57) is well-defined and satisfies the following properties: 1. V is positive-definite and radially unbounded. 2. V is homogeneous of degree with respect to the dilation  . ~ = 0. 3. V is infinitely differentiable on Rn \ {0} and continuously differentiable at x Next, the Lie derivative of V along g is examined. Since g (0) = 0, it is clear ~ ) for x = 0. By [Rosier (1992)], any x ~=0 that L g V (0) = 0. Hence, focus on L g V ( x ¬Ø ), for some  > 0 and x ¬Ø  S5 . By Proposition 4, L g V is can be written as  ( x 47
r () r ()

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization
r ()

~ = 0, homogeneous of degree + k with respect to the dilation  . Hence, for any x ~ ) = L g V ( ( x ¬Ø )) =  L g V ( x
r ()

+k

¬Ø ), L g V ( x

(3.58)

¬Ø  S5 , indicating that to show L g V ( x ~ ) < 0 for all x ~ = 0, it for some  > 0 and x ~ ) < 0 for all x ~  S5 . suffices to show that L g V ( x

Proposition 10. Choose 0 < a < 1 < b. Then, there exist 0 < l < L the following hold: ¬Ø (r() ()( x )) < 1 for all 0 < t < l 1. V t ¬Ø (r() ()( x )) > 2 for all t > L 2. V t 3.
L

V ( x ) =

1 t
+1

l

¬Ø ( a (V t

r ()

( x )))dt +

2 . kLk

(3.59)

~ = (y, z)  R3 √ó R3 : a  x ~  b}. Note that by Proof. Consider the set A = { x ~ equivalence of norms on R6 , there exist  ,  > 0 such that  x Hence, for t > 0,
r () 1

~   x ~ 1.  x

 (t y

1

+ t z 1 )  t

~ )  (t y (x

1

+ t z 1 )

which leads to   r () ~ )  max{t, t } x ~  t ( x ~ . min{t, t } x   ~  A, Hence, for x   r () ~ )  b max{t, t } a min{t, t }  t ( x   Next, note that max{t, t } < t1/2 , 0 < t < 1, and min{t, t } > t1/2 , t > 1,

(3.60)

(3.61)

¬Ø ( x ) at x = 0, there exists a  > 0, such that for all   (1/2, ). By continuity of V ¬Ø ( x ), there x   implies that V ( x )  1. Likewise, by radial unboundedness of V 48

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization ¬Ø ( x )  2. By (3.60), it follows that there exists an r > 0 such that x  r implies V exists 0 < t
r ()

~  A and   (1/2, ), 0  t  < L, such that for all x
r ()

implies that

~ )  , and t  L implies that t (x

¬Ø ( ~ )  r. Hence, V (x t

r ()

~ ))  1 when (x

¬Ø ( r () ( x ~ ))  2 when t  L, which are properties 1 and 2. Finally, 0  t  , and V t property 3 is obtained by applying these two properties to (3.57). This concludes the proof. ~  S5 and   (1/2, ), Using Proposition 10, for x
L r () ¬Ø r () t V r () ¬Ø ~ ) g ( x ~ )dt. ~ ))) ~ )) a (V (t ( x ( ( x (x ~ t ~ x x t +1

~) = L g V ( x

1

l

Next, the homogeneity of g of degree  - 1 with respect to dilation  t ( x ) g ( x ) = x Consequently,
L r ()

r ()

implies that

1 r () ~ )). g (t ( x  t -1

~) = L g V ( x

1 t
+

l

¬Ø ( r () ( x ¬Ø ( r () ( x ~ ))) L g V ~ ))dt. a (V t t

(3.62)

¬Ø ( r () ( x ~ , t ,  ) = L g V ~ )), which is continuous on R6 √ó Now, define the function h( x t ~ , t, 1) < 0 for all ( x ~ , t)  S5 √ó [ , L]. Consequently, since R+ √ó (1/2, ). By (3.56), h( x ~ , t, 1)   for all the set S5 √ó [ , L] √ó {1} is compact, there exists  < 0 such that h( x ~  S5 √ó [ , L]. Choose any  ¬Ø satisfying  <  ¬Ø < 0. Then, in a similar manner to the x ¬Ø , satisfying 0 <  ¬Ø  1/2, such that h( x ~ , t,  ) < proof of Proposition 8, there exists  ¬Ø < 0 for all ( x ~ , t)  S5 √ó [ , L] when 1 -  ¬Ø <  < 1+ ¬Ø . Finally, by properties 1. and  ¬Ø ( ~  S5 , the term a (V 2. of Proposition 10 and the definition of a(t), for any x t
r ()

~ ))) (x

must be positive on some sub-interval of [l , L] (otherwise a(s) cannot transition from ~ ) < 0 for all 0  1 as s goes from 1  2). Consequently, (3.62) shows that L g V ( x ~  S5 , and as explained previously, this implies that L g V ( x ~ ) < 0 for all x ~ = 0. x ¬Ø <  < 1 there exists c() > 0 such that Applying Proposition 5, for 1/2  
( +k)/

~ )  -c()V L g V ( x ~  R6 . for all x 49

~ ), (x

(3.63)

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization ~ ), Having obtained a Lyapunov function for the nominal system given by g ( x ~ in (3.53) are now dealt with. The term ~v ,  ~ , bI ) and d the remaining terms f (q ~v ,  ~ , bI ) is analyzed first, following the approach in [Du and S. Li, 2012] and f (q [Gui and Vukovich, 2016]. Suppose that there exists a 0 > 0, such that ~ ))   L f V ( ( x
r ()

+k c (  )

2

d,

(3.64)

~  S5 , when 0 <  < 0 , where d = minx for all x ~ S5 V
r ()

( +k)/

~ ). Define the set (x

~R:x ~ =  ( x ¬Ø ), x ¬Ø  S5 , 0   < 0 }. U = {x

(3.65)

Proposition 11 (Gui et. al. (Gui, Vukovich, and S. Xu, 2016)). The set U in (3.65) is open and contains the origin. If (3.64) holds, then by the definition of d, we obtain
r ()

~ ))   L f V ( ( x

+k c (  )

2

V

( +k)/

~ ), (x
r ()

(3.66)

~  S5 , when 0 <  < 0 . Any x ~ = 0 can be written as  ( x ¬Ø ), for some for all x ¬Ø  S5 [Rosier, 1992]. Hence, for arbitrary x ~ = 0, (3.66) leads to  > 0 and x ~ ) = L f V ( ( x ¬Ø ))   L f V ( x
r ()

+k c (  )

2

V

( +k)/

¬Ø ), (x

= = =

( +k)/ c() ¬Ø)  V ( x 2 ( +k)/ c() r () ¬Ø )) V ( ( x , 2 c (  ) ( +k)/ ~ ), V (x 2

(3.67)

where homogeneity of V has been applied in the fourth step. Continuity of L f V ~ = 0 also. As a result, combining (3.63) and (3.67), and V imply that (3.67) holds for x ~)  - L g + f V ( x c() ( V 2
+k)/

~ ),  x ~  U. (x

(3.68)

50

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization It remains to establish the condition in (3.64). Note that (3.64) is equivalent to the existence of 0 > 0, such that ~ )) L f V ( ( x c()  d, + k 2  ~  S5 , when 0 <  < 0 . For x ~ = [ ~T,  ~ T ] T  S5 , for all x ~ )) L f V ( ( x  +k
r () r ()

(3.69)

~v ,    ~ ) V r() ~ , bI ) V r() f (q f 2 (  ~ )) 1 ~ ( ( x + (  ( x )) ,  + k ~v ~ q     +k ~v ,    ~) ~ , bI ) V f (q f 2 (  - V ~) 1 ~ =  -1 (x ( x ) +  , + k ~v ~ q    +k ~v ,    ~ ) V ~ , bI ) V f (q f 2 (  ~) 1 ~ = (x + ( x ) , (3.70)  2  ~v ~ q    -1

=

~v where Proposition 3 and the fact that k =  - 1 have been used. Since V /q ~ are continuous, they are uniformly bounded on S5 . Hence, only the and V / ~v    ~ )/ and f 2 (  ~ , bI )/2-1 , need to be considered. The term f 1 terms f 1 (q ~v ,    ~) = is examined first. From (3.54), f 1 (q
1 2

~v ) - I )    ~ . For q ~v ( A(q

= 1

~  S5 ), this only makes sense when  < 1. Hence, the (which can occur when x search for 0 > 0 is restricted such that 0 < 1. Now, applying Proposition 7, for ~  S5 , and using the fact that q ~v ,  ~  x ~ = 1 yields f 1 (q ~v ,    ~ ) /  all x ~v    ~ )/  0 as   0, uniformly on S5 . (1 + )/2. Clearly, f 1 (q Next, J -1 we examine f2. From (3.54), ~ , bI ) f 2 (



~ (2 bI +  ~ )). J ( 

Now, bI is time-varying, so an additional

assumption is needed in order to be able to proceed. Assume that  is bounded ¬Ø . This then implies that bI   ¬Ø + 0 . Consequently, by some  ~ , bI ) f 2 (   2 -1 where the fact that ~ 

  1-  J -1

¬Ø + 0 ) +   ) , J (2( 

(3.71)



~ x

= 1 has been used.

It is now clear that

~ , bI )/2-1  0 as   0, uniformly on S5 , provided    ¬Ø. f 2 (  Based on the above analysis, one can conclude that it is indeed possible to find ¬Ø ) > 0, such that (3.64) holds for all x ~  S5 , when 0 <  < 0 ( ¬Ø ). It is important 0 (  ¬Ø ) is a function of the bound  ¬Ø , and consequently, so is the set U , to note that 0 (

51

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization ¬Ø ) decreases (and consegiven in (3.65). In fact, from (3.71) it can be seen that 0 ( ¬Ø ) shrinks) as  ¬Ø increases. To show the dependence of U on  ¬Ø , from this quently U ( ¬Ø ). point on it shall be denoted by U ( ¬Ø , it has been established that (3.68) holds on the open While for a given bound  ¬Ø ), it will be useful to find an open sublevel set of V , contained in U ( ¬Ø ), since set U ( this will then become an invariant set, and in the absence of the disturbance d , will ¬Ø ) is open, let be inside the domain of attraction of the observer. To this end, since U ( ¬Ø ). Let  ¬Ø = minx ~) >  > 0 be the radius of a closed ball contained inside U ( ~  S5 V ( x 0. The set ~  B (0) : V ( x ~) <  ¬Ø }, W = {x is such a set. ~ in (3.53) is handled. For any x ~  S5 , one has from (3.54) that Finally the term d
r ()

(3.72)

~ )) = Ld~V ( ( x

V r() ~ )) J -1 d , ( ( x ~   V ~ ) J -1 d , =  - (x ~  V ~ ) J -1   - (x ~ 

d ,

(3.73)

where Proposition 3 has been used. Assume that the external disturbance torque is ¬Ød , and define uniformly bounded by d   V ~) (x ~  J -1 , b = min V
~  S5 x

a = max
~  S5 x

( -)/

~ ) > 0. (x

By definition of b, V leads to

( -)/

~ )/b  1 for all x ~  S5 . Using these bounds in (3.73) (x ¬Ød a  b

~ ))  Ld~V ( ( x

r ()

-

V

( -)/

~ ), (x

~  S5 . Using the same homogeneity and continuity arguments as made from for all x equations (3.66) to (3.67), one finds that ¬Ød ( a V b
-)/

~)  Ld~V ( x ~  R6 . for all x

~ ), (x

(3.74)

52

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization ¬Ø , for trajectories Finally, combining (3.68) and (3.74), one finds that when    ¬Ø ) we have inside U (   (x ~ (t)) = L g + f V ( x ~ ) + Ld~V ( x ~ (t)), V

 -

c() ( V 2
( -)/

+  -1) /

~) + (x

¬Ød ( a V b

-)/

~ ), (x . (3.75)

= -V

~) (x

¬Ø c (  ) (2 -1) / a ~) - d V (x 2 b

  < 0 when From this, it is seen that V ¬Ød 2a c()b
/ (2 -1)

~) > V ( x

.

(3.76)

Consequently, to guarantee feasibility for (3.76), the following restriction is made (compare to (3.30)) ¬Ød 2a c()b
/ (2 -1)

¬Ø. <

(3.77)

¬Ød is small enough. This is clearly satisfied if  The following result is now obtained: ¬Ød for all t  ¬Ø , 1). Suppose that  (t)   ¬Ø and d (t)   Lemma 3.5. Choose   ( ¬Ø), for some t ¬Ø  R+ {}, and that (3.77) is satisfied. If x ~ (0) satisfies V ( x ~ (0)) <  ¬Ø, [0, t ~ (t)) <  ¬Ø and x ~ (t) <  for all t  [0, T ). If T = , then then V ( x ¬Ød 2a c()b
/ (2 -1)

~ (t))  lim sup V ( x
t

~ (t)   <  , , and lim sup x
t

where ~ , F=  = max x
~F x

~  U ( ¬Ø ) : V ( x ~)  x

¬Ød 2a c()b

/ (2 -1)

.

Proof. This can be obtained using similar arguments as in the proof of Lemma 3.1, ¬Ø) (see the definition of W in (3.72)), and ~ (t)  W  B (0) for all t  [0, t noting that x ¬Ø = , x ~ (t)  F  B (0) as t  . the fact that when t Remark. In the absence of disturbances (d  0), the observer in (3.49) and (3.50) is finite-time convergent when  < 1. As shown in [Du, S. Li, and Qian, 2011] and [A.M. Zou, 2014], finite-time control laws can generally provide convergence in finite-time. In comparison to asymptotic control laws, finite-time control laws 53

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization provide higher precision control performance and better disturbance rejection properties. Anticipating similar properties for finite-time observers, this is the reason why the parameter  has been included in the proposed observer. In the case  = 1, ¬Ø (x ~ ) directly (without the need a similar result to Lemma 4 can be obtained using V for V ), and in this case the observer becomes asymptotically convergent in the absence of disturbances. Ultimately,  provides another tuning parameter for the user to improve the closed-loop performance.

3.4

Main Result

The main result can now be presented. Theorem 3.6. Consider the system described by (3.9) and (3.10), together with the observerbased control law in (3.34), (3.37), (3.40), (3.49) and (3.50). Then, provided the disturbance torque d is small enough (as precisely outlined in (3.78) and (3.79)), the control and observer ~ are locally ultimately bounded. parameters can be chosen such that ,  ,  ¬Ø 11 - A ¬Ø 12 K is Hurwitz. Choose some  > 0, Proof. Choose K in (3.23) such that A and obtain the related  > 0 as explained in between equations (3.26) and (3.27). ¬Ø such that (3.30) holds. Now, the set G = {( x1 , S)  R6 : V1 ( x1 ) < ¬Ø, d Next, choose S ¬Ø } is bounded. It follows that since x is related to [ x1 , S] min ( P)(min{, 1})2 , S < S by the invertible linear transformation   x= I   0   x1  ,  -K I S
T ¬Ø x

¬Ø, x ¬Ø  G } is bounded also. Fix r > supx H x . that the set H = { x  R6 : x = T x ¬Ø in Lemma 3.4 such that Then, H  Br (0). Now, select  > 0, ,  + ¬Ø 2 + 4  2

¬Ø, <S

and obtain the corresponding (r ) > 0 in Lemma 3.4. Choose

 2 in (3.57), and

¬Ø , 1), where  ¬Ø is given in the paragraph between equations (3.62) and choose   ( ¬Ø = r in Lemma 3.5, and obtain the set U ( ¬Ø) (3.63). Noting that   x , take  54

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization in (3.65). Choose  > 0 as in paragraph before equation (3.72), such that  < (r ), ¬Ø (as also explained in that same paragraph). Noting from and choose a suitable  (3.22) that d  d / Jx , we now require from (3.30) and (3.77) the bound on the ¬Ø x , L}, where L > 0 satisfies ¬Ød = min{dJ disturbance torque to satisfy  2aL c()b
/ (2 -1)

¬Ø. <

~ (0) such Finally, consider the initial conditions such that x (0)  H  Br (0), and  ~ (0)) <  ¬Ø . Now, suppose that x (t) exits Br (0) after some finite time. By that V ( x construction of Br (0), x (t) must exit H before it can exit Br (0). By Lemmas 3.1, 3.2 and 3.5, this is impossible. Hence, x (t)  Br (0) for all t  0, and the ultimate bounds in Lemmas 3.1, 3.4 and 3.5 apply. This concludes the proof.

3.5

Numerical Examples

This section presents numerical examples to demonstrate the performance of the proposed observer-based controller under some realistic implementation conditions, including sampled measurements with measurement noise, sample and hold control implementation, uncertainties in the spacecraft inertia matrix, aerodynamic and solar pressure disturbance torques and small orbital eccentricities. Several numerical cases are proposed here. In the nominal case, the response of the system without any external disturbances and idealistic conditions are presented, as well as we draw comparison between idealistic response and sampled-data response. Next, we present the response with time-varying external disturbances to show feasibility of the observer-based control in dealing with external disturbances. Lastly, the case where uncertainties and time-vary disturbances are added to the sampled-data numerical simulations to demonstrate the robustness of the observer-based controller. While the following simulations are numerical implementation of the novel control law previously developed, in practice one would need to take account several practical issues and limitations: (1) hardware physical limitations such as control saturation (minimum and maximum values viable), instantaneous response, ramp-up, size, and geometrical limitations, (2) operational limitations such as computational

55

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization processing limitations of the on-board computer, signal delays, and signal interference, (3) un-modelled dynamics such as spacecraft flexible appendages. The spacecraft model is taken from [Godard, K. Kumar, and A. Zou, 2013]. The spacecraft is in a Keplerian orbit with semi-major axis a = 6878 km, and initial condition at perigee. The spacecraft nominal moments of inertia used in the control and observer design are Jx = 0.0020 kg¬∑m2 , Jy = 0.0017 kg¬∑m2 , and Jz = 0.0015 kg¬∑m2 . The aerodynamic and solar pressure torques are given by    2 a = 1.36 A f   - 5 √ó 10 [4 + 2 sin (0 t) + 0.5 sin (20 t)]  - [1 + 2 sin (0 t) + 0.5 sin (20 t)]    s = S f    2 √ó 10-5  1 + sin (0 t) + 0.5 sin (20 t)    ,   (3.78)

[1 - 2 sin (0 t)]   , 1 √ó 10-3 cos (0 t)   - 5 - 5 √ó 10 cos (0 t)

(3.79)

respectively, where A f = 1.0 √ó 10-11 and S f = 1.70 √ó 10-6 are derived from "worstcase scenarios" for the RyeSat spacecraft model as outlined in [Godard, K. Kumar, and A. Zou, 2013].
TABLE 3.1: Summary of parameters

Parameter a K1 , K2

Value 6878 km 0 1 0 0 0.005 0 , 0.65 0 1 0.005 0 0.005 (0.1, 1 √ó 10-2 , 0.9, 1, 0.5, 0.01, 1, 1.5) [0.0020, 0.0017, 0.0015] kg¬∑m2

(, , , 1 , 2 , 1 , 2 , 3 ) [ Jx , Jy , Jz ] Nominal Disturbance-Free (0), bI (0)
Nominal Disturbance (0), bI (0) [a , s ] Disturbances and Uncertainties e diag{ J } ^ bI (0) qv , (0), bI (0), 

[0.5245, 0.5915, 0.1585]T , 0 rad/s [0.5245, 0.5915, 0.1585]T , 0 rad/s time-varying
e  (0, 0.05) ¬±5 % ¬±5 deg, ¬±100 deg, ¬±0.1 deg /s, ¬±1.4 deg /s

56

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization In the numerical examples, attitude measurements are generated at sample times tk (k = 0, 1, ...) according to qvm (tk ) = q4 (tk )qve,k + q4e,k qv (tk ) + qv (tk )√ó qve,k , q4m (tk ) = q4 (tk )q4e,k - qv (tk )T qve,k , (3.80)

where qve,k is generated with MATLAB's "randn" random number generator, with standard deviation of 0.1 √ó 180/(6 ) in each component and q4e,k =
T q 1 - qve ,k ve,k .

Consequently, (qve,k , q4e,k ) is a unit quaternion representing a random rotational measurement error with 0.1 degree error (3-sigma). Using the measured attitude qm = (qvm , q4m ), the measured rotation matrix from orbital to body coordinates is computed as Cbn,m (tk ) = C (qm (tk ))Cin (tk ), (3.81)

where Cin is the rotation matrix from orbiting to inertial coordinates, which can be obtained from the orbital position and velocity vectors. The corresponding measured attitude error quaternion (
m ( tk ), m ( tk ))

is then extracted from Cbn,m (tk ) as

[Ruiter, Damaren, and J. Forbes, 2013]
√ó
T = (Cbn ,m ( tk ) - Cbn,m ( tk )) / (4m ( tk )),

m (tk )

m ( t k ) =

(trace[Cbn,m (tk )] + 1)1/2 . 2

The sampled-data implementation of the proposed observer-based control law is ^m (tk ) -  ^ m (tk ) , ¬Øu (t) = -1 -S   (t) = ^ q 1 ^(t))C T (q ~m (t))  ^ bI (t) + 1 P-1 (q ~m (t))sig (q ~vm (t)) , B(q 2

 bI (t) = - ^ ^ bI (t)√ó J  ^ bI (t) + g,m (tk ) + u (t) + 2 J sig1 (q ~vm (t)), J then for t  [tk , tk+1 ), where ^ m ( t k ) = K1  ^ m ( t k ) + K2 S
m ( t k ),

^ m (tk ) =  ^ bI (tk ) + 0 (tk )Cbn,m (tk )e2 ,  ^m (tk ) ^ m (tk )k u S 2 ¬Ø 

^ m (tk ) =  ^ m (tk ) tanh 

,

57

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization ^ m = 1 + 2  ^ m ( t k ) + 3  ^ m (tk ) 2 ,  ~m = ( q ~vm , q ~4m ) is given by and q ~vm (t) = -q4m (tk )q ^v ( t ) + q ^4 (t)qvm (tk ) - q ^v (t)√ó qvm (tk ), q ~4 m ( t ) = q 4 m ( t k ) q ^4 (t) + qvm (tk )T q ^v ( t ). q The sample period in this chapter is chosen to be  T = tk+1 - tk = 0.1 seconds as a limited example. Although in practice, the sample period can be at a much slower rate and can have measurement unavailability (drop-outs), and the system response for such frequencies and cases are not presented here. The numerical integration is performed using a 4th order Runge-Kutta method with step size equal to  T . Smaller step sizes were also tested, but did not produce any noticeable change in results.

3.5.1

Nominal disturbance-free case

The purpose of the example in this subsection is two-fold: (1) to demonstrate the performance of the observer-based control law under ideal conditions (zero orbital eccentricity, perfect knowledge of the spacecraft inertia matrix, no external disturbances other than gravity-gradient); (2) to compare the performance of the ideal continuous-time (not sampled-data) observer-based control in the absence of measurement noise with the sampled-data observer-based control with noisy measurements. The spacecraft attitude relative to the orbiting frame is given by

(0) = [0.5245, 0.5915, 0.1585], while the initial orbital angular velocity is given by
bI (t) = 0 rad/s. Figure 3.2 shows the resulting attitude and angular velocity responses, respectively. It can be seen that the attitude responses are almost identical, attitude convergence is achieved roughly by 1 orbit. While the angular velocity responses are similar, with the sampled-data angular velocity response exhibiting some noise evidently during steady-state, this is due to the presence of noise on the measurements. From this, it can be seen that the sampled-data observer-based control approximates

58

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization the proposed continuous-time control very well. Having established this, the examples presented in the remaining subsections are for the sampled-data controller only.

Continuous 1 (,) 0.5 0 x y z  0 (,) 1 0.5

Sampled-Data x y z 

0 x 10
-3

0.5

1

1.5

2

0 x 10
-3

0.5

1

1.5

2

1 0  (rad/s) -1 -2 -3

1 0  (rad/s) x y z -1 -2 -3 0.5 1 1.5 Time (Orbits) 2

x y z

-4 0

-4 0

0.5

1 1.5 Time (Orbits)

2

F IGURE 3.2: Attitude and angular velocity responses in nominal disturbance-free case

3.5.2

Nominal case with disturbances

The purpose the example in this subsection is to demonstrate the performance of the sampled-data observer-based control law under nominal conditions (zero orbital eccentricity, perfect knowledge of the spacecraft inertia matrix), but with the inclusion of the aerodynamic and solar pressure disturbance torques. Figure 3.3 shows the resulting attitude and angular velocity responses. Figure 3.4 shows the spacecraft control torques. Comparing Figure 3.3 to Figure 3.2, it can be seen that the while the attitude and angular velocity errors still converge to a neighborhood of the origin, the presence of the disturbance torques results in steady-state attitude errors within

¬±0.01 in the quaternion vector and ¬±10-4 rad/s in the angular velocity, which is to
be expected since the disturbance torques act about all three spacecraft axes, while the control torque is limited to the pitch and yaw axes.

59

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization
Attitude Error 1.2 1 0.8 0.6 (,) 0.4 0.2 0 -0.2 -0.4 0 0.5 1 1.5 2 -4 0 0.5 1 1.5 Time (Orbits) 2 
x
-3

1 0

x 10

Angular Velocity Error

y z   (rad/s) -1 -2 -3

x 
y

z

F IGURE 3.3: Attitude and angular velocity responses in nominal case with disturbances
5 0 -5 -10 -15 -20 0 y z 10 20 Time (s) 30 40 -1 6000 6100 6200 Time (s) x 10
-6

Initial 1

-7 x 10 Steady-State Snapshot

0.5  (Nm)

u (Nm)

0

u

-0.5

y  6300
z

6400

F IGURE 3.4: Control torque in nominal case with disturbances

3.5.3

All uncertainties and disturbances

The purpose of the example in this subsection is to demonstrate the robustness of the sampled-data observer-based control law to uncertainties in the spacecraft inertia matrix and non-zero (emax = 0.05) orbital eccentricities, in the presence of measurement noise for a variety of initial conditions with large initial attitude errors. Furthermore, we conduct test cases for randomized initial conditions, true spacecraft inertia matrix, and orbital eccentricity in a form of fifty Monte-Carlo style simulations. While, this certainly does not represent the probability distribution of the standard error, this simulation is presented to mildly illustrate the efficacy of the controller.

60

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization The true spacecraft inertia matrix is generated as follows. First, the true principal inertia matrix is computed according to   Jx + p x  Jp =  0   0 0 Jy + py 0 0 0 Jz + pz   ,   

where p x , py , pz are generated using MATLAB's "randn" random number generator, each with standard deviation of 3 √ó 10-5 kg¬∑m2 . This corresponds to approximately 5% uncertainty (3-sigma) in the principal inertias. Then, the true spacecraft inertia matrix is obtained as Jt = C (q J ) J p C (q J )T , where q J = (qvJ , q4 J ), qvJ is generated with MATLAB's "randn" random number generator, with standard deviation of 5 √ó 180/(6 ) in each component and q4 J =
T q . Consequently, q is a unit quaternion representing a 5 degree (3-sigma) 1 - qvJ vJ J

random rotation of the principal axes frame. It should be noted that Jt is only used in the numerical propagation of the true attitude dynamics. The observer-based controller uses the nominal inertia matrix J . The orbital eccentricity is generated using MATLAB's "rand" function taking values in the interval e  (0, 0.05). It should be noted that the controller is assumed to have access to high quality orbital data, from which the eccentricity can be computed, so the true eccentricity is used by the controller in the computation of the instantaneous orbital angular velocity 0 (tk ). The initial true attitude is obtained as (0) = a sin(/2),  (0) = cos(/2), where a  S2 is generated using MATLAB's "randn" function followed by normalization, and   R is generated using MATLAB's "randn" function, with standard deviation of 100 √ó 180/(3 ), corresponding to an initial attitude error of 100 degrees (3-sigma). The initial true inertial angular velocity bI (0) is generated using MATLAB's "randn" function, with standard deviation of 0.1 √ó 180/(3 ) corresponding to an initial angular velocity of 0.1 degrees/second (3-sigma). The initial estimated ^ bI (0) is generated using MATLAB's "randn" function, inertial angular velocity 

61

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization with standard deviation of 1.4 √ó 180/(3 ) corresponding to an initial estimated angular velocity of 1.4 degrees/second (3-sigma). Finally, the initial estimated attitude ^(0) is taken as the initial attitude quaternion measurement qm as generquaternion q ated in (3.80). For clarity in presenting the results of all 50 simulations, the attitude error is presented as the principal angle of rotation corresponding to , which is given by  = 2 sin-1 (

).

The angular velocity error is presented as  . Figure 3.5 shows the resulting attitude and angular velocity responses. It can be seen that in all cases, they converge to neighborhoods of zero. There is even one anomalous case where the attitude error initially grows to 180 degrees, which is due to a high initial angular velocity value, however, the controller still manages to recover the ultimate boundedness. These results demonstrate that even though the theoretical guarantee of ultimate boundedness for the proposed observer-based controller is local and is obtained under nominal conditions where the inertia matrix is perfectly known, the orbit eccentricity is zero, control is continuous and measurements are available without measurement noise, when implemented under realistic conditions in a sampled-data manner the control law retains the ultimate boundedness property even for large initial conditions and dynamic uncertainties.
Attitude Error 180 160 Angular Velocity Error (deg/s) 140 Attitude Error (deg) 120 100 80 60 40 20 0 0 1 2 3 Time (Orbits) 4 0 0 1 2 3 Time (Orbits) 4 0.2 0.25 Angular Velocity Error

0.15

0.1

0.05

F IGURE 3.5: Attitude and angular velocity responses with inertia matrix uncertainties, non-zero eccentricities and disturbances

62

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization

3.5.4

Effect of  parameter

In Section 3.3.3, it was mentioned that the observer parameter  provides an additional parameter to tune the closed-loop system performance. This is investigated numerically here, for the sampled-data control implementation with measurement noise, disturbances and system uncertainty. The initial conditions are the same as in subsection 3.5.1, while the true eccentricity and inertia matrix are generated as described in subsection 3.5.3. All control and observer parameters are kept fixed as in Table 3.1, while  takes the values 0.8, 0.85, 0.9, 0.95, 1. Figure 3.6 and 3.7 shows the resulting transient response of various , while Figure 3.8 shows the corresponding steady-state response. While the transient responses are similar across the considered range of , at steady-state (as seen in Figure 3.8), the attitude error initially decreases as  decreases from 1, but then increases as  becomes smaller. The angular velocity error shows a consistent increase as  decreases from 1. An explanation for this can be found by considering the innovation terms in the observer, which ~v ). From its definition, it is clear that 0 > 1 > 2 implies have the form sig (q

|sig1 ( x )| > |sig2 ( x )|, for any x  (-1, 1). This fact makes the observer more sensitive to measurement noise, once the estimation error becomes small. On the other hand, this fact also makes the observer more robust to system uncertainties and disturbances. The combination of these observations can explain the results observed in Figure 3.8. Namely, when  initially decreases from 1, the effects of system uncertainties and disturbances on the observer are reduced without significantly increasing sensitivity to measurement noise. The result is improved steady-state attitude performance. However, when  is further decreased, then measurement noise becomes the dominant effect, and consequently closed-loop performance deteriorates.

3.6

Chapter Summary

This chapter has treated the velocity-free attitude control problem for a nominally nadir-pointing underactuated rigid spacecraft in circular orbits with actuation about only two axes. An observer-based control law has been proposed by combining a

63

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization

100

Attitude Error
=0.80 =0.85 =0.90 =0.95 =1

0.45 0.4

Angular Velocity Error
=0.80 =0.85 =0.90 =0.95 =1

80

Angular Velocity Error (deg/s)
1.5

0.35 0.3 0.25 0.2 0.15 0.1 0.05

Attitude Error (deg)

60

40

20

0 0 0.5 1

0 0 0.5 1 1.5

Time (Orbits)

Time (Orbits)

F IGURE 3.6: Effect of  on the transient response

F IGURE 3.7: Effect of  on attitude error
1.5

Attitude Error
=0.80 =0.85 =0.90 =0.95 =1

0.01

Angular Velocity Error
=0.80 =0.85 =0.90 =0.95 =1

Angular Velocity Error (deg/s)
4

0.008

Attitude Error (deg)

0.006

1

0.004

0.002

0.5 0 3 3.2 3.4 3.6 3.8 3 3.2 3.4 3.6 3.8 4

Time (Orbits)

Time (Orbits)

F IGURE 3.8: Effect of  on the steady-state response

64

CHAPTER 3. Velocity-Free Nadir-pointing Attitude Stabilization sliding mode control law with an observer to estimate the spacecraft angular velocity. A rigorous analysis has been presented demonstrating that with the proposed observer-based control law, the closed-loop system is locally ultimately bounded. Finally, numerical examples have been presented of a sampled-data implementation of the proposed observer-based control law that demonstrate robustness to uncertainties in the spacecraft inertia matrix, non-zero orbital eccentricity and measurement noise, as well as convergence for large initial attitude errors.

65

CHAPTER 4

Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller
The problem of regulating the attitude of an inertial pointing underactuated rigid body spacecraft using two torques under time-varying disturbances and inertia matrix uncertainties is examined. A generalized time-varying state feedback controller is proposed that is more versatile in gain tuning, potentially leading to a better performance in comparison to literature. Furthermore, the measurement of angular velocity of the spacecraft is no longer required to achieve asymptotic stability near the origin. The stability of the combined controller-observer system is proven rigorously to show local ultimate boundedness of all signals. Comprehensive numerical examples are shown with sampled-data implementation of the observer-based control law to demonstrate convergence even for very large initial attitude errors.

4.1

Introduction

Contrasted to Chapter 3, this chapter utilizes previously developed tools and methodologies to investigate the inertial pointing attitude stabilization of an underactuated rigid body spacecraft using two torques. Since the equations of motion relative to the inertial frame (as opposed to the body-orbital frame in Chapter 3) are highly nonlinear and non-linearizable, for this reason, the previously established observer-based controller is not applicable. Thus, this chapter is motivated by the

66

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller development of a generalized time-varying nonlinear controller for the inertial attitude control problem. In [A.M. Zou, 2014], the author investigated attitude tracking of a rigid spacecraft through geometric homogeneity and Lyapunov theories. The authors used finite-time time-varying continuous output feedback controller that is based on backstepping technique to achieve semi-global finite-time stability that proved faster convergence rate, better disturbance and parameter perturbation rejection property and higher accuracy control performance than the asymptotic controller. Authors in [Gui, Vukovich, and S. Xu, 2015] investigated spin-axis stabilization of an axisymmetric spacecraft using bounded two torques using a saturated proportional-derivative controller in the uncertainty-free case to produce bounded control torques a priori while ensuring asymptotic stability of closed-loop system. The authors in [Gui, Vukovich, and S. Xu, 2015] designed an adaptive controller based on a sliding-mode-like function to achieve better robustness to inertial uncertainties and disturbances as well as actuator saturation. Similarly, the authors also investigated attitude stabilization of a spacecraft using two parallel control moment gyroscopes using zero momentum and utilized modified direct-inverse (MDI) steering laws by treating internal and external singularities separately [Gui, Vukovich, and S. Xu, 2016].

Utilizing the homogeneity of systems, a velocity-free time-varying continuous feedback controller is formulated to achieve globally exponentially stable with respect to the homogenous norm. The stability of the unactuated closed-loop system and full nominal closed-loop system along with the combined observer-controller system are rigorously proven to provide ultimate boundedness of all signals.

The main features of this chapter is two-fold: 1) a slight generalization of an already existing state-feedback controller for exponential convergence similar to [Morin and Samson, 1997] to achieve inertial attitude stabilization. However, the formulation allows more flexibility with gain selection which can potentially lead to better closed-loop performance and more suitable to implement; 2) the design of an angular velocity observer to remove the necessity of angular velocity measurements 67

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller in the control law. This chapter is organized in the following manner. The problem formulation is constructed in Section 4.2. Also in Section 4.2, the definition of the control objective, the control design for unactuated and actuated states, the observer design, and main results are presented. The numerical examples are produced in Section 4.4 to show effectiveness of the control-observer system for inertial attitude stabilization.

4.2
4.2.1

Problem Formulation
Attitude kinematics and dynamics

The attitude kinematics and dynamics are reproduced here for convenience. 1 B(q) , 2

 = q

(4.1) (4.2)

 = - √ó J  + u + d , J

where





 P(q)  √ó B(q) =   , P ( q ) = q4 I + q v , T -qv J  R3√ó3 is the spacecraft inertia matrix, u is the control torque and d is the disturbance torque. We further separate the disturbance torque into the gravity-gradient ¬Ød , torque g , and other external disturbances  ¬Ød , d = g + 

where g = 3 ¬µ (C (q) R)√ó JC (q) R, R 5 (4.3)

and R  R3 is the orbital position vector in inertial coordinates, and
T T √ó C ( q ) = ( q2 4 - q v q v ) I + 2q v q v - q4 q v ,

(4.4)

is the rotation matrix corresponding to q.

68

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller A nominal spacecraft inertia matrix Jn  R3√ó3 is assumed known, such that J = Jn +  J , where  J  R3√ó3 is the inertia matrix uncertainty. The nominal spacecraft inertia matrix is assumed to have the form

Jn = diag{ Jx , Jy , Jz }.

It is assumed that the spacecraft is only actuated about the roll and pitch axes, such that   (4.5)  1 0    , u = Jn Hu, H =  0 1     0 0

where u = [u x , uy ] T is the to be designed control input. To accommodate an angular velocity observer, the control input will be partitioned as u = un + u, where un is an ideal state-feedback control law, while u represents the deviation from un due to the estimation error of the angular velocity.

4.2.2

Control objective

The control objective in this chapter is to regulate the states (qv ,  ) to a neighborhood of the origin, without the use of angular velocity measurements, in the presence of inertia matrix uncertainties and external disturbance torques. Due to the assumption of bounded time-varying disturbances, there is no stable equilibrium for which the control can drive to and due nature of underactuated system, it is more realistic to state that control objective be in the neighbourhood of the origin.

Since a local stability result will be obtained in this chapter, it is assumed that q4 (t)  0 for all t  0 (the attitude error does not exceed 180 degrees in rotation). Since (qv , q4 ) and (-qv , -q4 ) represent the same attitude, one can take (choose the representation (qv , q4 ) for which q4 > 0)
Tq . 1 - qv v

q4 =

(4.6)

69

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller The kinematics of qv in (4.1) can therefore be written as 1 1  + q√ó v + ( 2 2
T q - 1)  . 1 - qv v

v = q

(4.7)

The attitude dynamics in (4.2) can now be rewritten as
-1 √ó -1  = - Jn   Jn  + Hun +  + Jn d ,

(4.8)

where
-1 √ó -1 -1  = Jn  Jn  - J -1  √ó J  + ( J -1 - Jn ) Jn Hun + J -1 Jn H u + ( J -1 - Jn )d .

Define the unactuated state vector  = [q1 , q2 , q3 , z ] T , the actuated state vector y =

[x , y ]T , and the full state vector x = [ T , yT ]T . The equations of motion in (4.7)
and (4.8) can be written as     (4.9)    f  ( , y)    ~ ) + D,  + g( x ) + h( x, t, d ,  J ,   =  un y
 x f ( x ,u n )

where

x /2    y /2  f  ( , y) =   ( + q  - q  )/2  z 2 x 1 y  cz  x y 



     ,            ,        
T

T  (q2 z - q3 y + ( 1 - qv qv - 1)x )/2   (q  - q  + ( 1 - q T q - 1) )/2 y 1 z  3 x v v   T q - 1)  /2  ( 1 - qv v z  g( x ) =   0    c x y z   cy  x z

  ~) =  h( x, t, d ,  J , 

03 √ó 1
T

  70



03√ó1 e3 e1 e2
-1  Jn d

e3 e1 e2

  , D = 

 ,

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller where c x = ( Jy - Jz )/ Jx , cy = ( Jz - Jx )/ Jy , cz = ( Jx - Jy )/ Jz , and in the definition of ~ ), we recognize in advance that we will design a continuous nominal h( x, t, d ,  J ,  state-feedback control law un ( x, t), such that when implemented with the estimated ^ , the control deviation will be a continuous function u( x, t,  ~ ), angular velocity  ~ = - ^ is the angular velocity estimation error. where  Assumption 4.1. It is assumed that cz = 0, otherwise z becomes uncontrollable for the nominal dynamics. ¬Ødm > 0 such that d (t)  dm and  ¬Ød (t)   ¬Ødm Assumption 4.2. There exist dm ,  for all t  0.
r ( x ) = (  q ,  q , 2 q , 2  ,  ,  ), it is straightforDefining the dilation  z x y 2 3 1

ward to verify that the nominal vector field f ( x, un ) is homogeneous of degree
r provided that the state-feedback control inputs u ( x , t ) and zero with respect to  nx r , we define the uny ( x, t) are homogeneous of degree 1. Related to the dilation 

homogeneous norm
4 2 2 4 4 1/4  ( x ) = ( q4 . 1 + q2 + q3 +  z +  x +  y )

(4.10)

4.2.3

Control design for unactuated states

We first consider the nominal dynamics for the unactuated states  , given by

 = f  (  , y ), 

(4.11)

where we treat the actuated states y as the control input. We define a reduced
¬Ø r dilation and a reduced homogeneous norm for the unactuated states as  ( ) =

(q1 , q2 , 2 q3 , 2 z ) and
4 2 2 1/4 ¬Ø (  ) = ( q4  , 1 + q2 + q3 +  z )

(4.12)

respectively.
¬Ø r r ( x ). Since f (  , y ) is homogeneous of degree Remark.  ( ) is compatible with   r , if we design a control law y = v (  , t ), where both comzero with respect to  ¬Ø r ponents v x and vy are homogeneous of degree 1 with respect to  , the resulting

71

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller closed-loop vector field f  ( , v( , t)) becomes homogeneous of degree zero with
¬Ø r . respect to 

Consider the control law ¬Ø ( ) sin(t/ ), v x (  , t ) = - k 1 q1 - k 3  vy ( , t) = -k2 q2 +  ( ) sin(t/ ), where

(4.13)

   ( k 4 q3 + k 5  z ) /  ¬Ø ( ),  = 0,  ( ) =   0,  = 0,

(4.14)

and k1 , k2 > 0, k3 , k4 , k5 satisfy cz k3 k4 , cz k3 k5 > 0, and

> 0. It is straightforward to

¬Ø r verify that both v x and vy are homogeneous of degree 1 with respect to  .

Remark. The control law in (4.13) is a generalization of the one presented in [Morin and Samson, 1997] and [H. Li, Yan, and Shi, 2017], in which k3 = k4 = k5 = 1. Treating these as variables allows the user a greater ability to tune the closed-loop performance. Proposition 12.  ( ) is continuous on R4 . ¬Ø ( ) is positive-definite and continuous on R4 , it is clear that  ( ) is Proof. Since  continuous on R4 \ {0}. Thus, we just need to consider  = 0. First, note that  2 1/2 , where a = max{| k |, | k |}. Next, | k 4 q3 + k 5  z |  a ( | q3 | + |  z | )  2 a ( q2 5 4 3 + z )
2 1/2 / ( q2 +  2 )1/4 = ( q2 +  2 )1/4  0 as ( q ,  )  0. Consequently, given ( q2 z 3 z z 3 + z ) 3 3 2 1/2 < > 0, there exists  > 0 such that (q3 , z ) <  implies that (q2 3 + z )  2 1/4 . As a result,  ( /( 2a))(q2 <  implies that (q3 , z ) < , which 3 + z )

leads to

| k 4 q3 + k 5  z | 



2 1/2 2 1/4 ¬Ø (  ). 2 a ( q2 < ( q2   3 + z ) 3 + z )

Thus, lim 0  ( ) = 0, and  is continuous at  = 0 also. This concludes the proof.

72

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller Taking y = v( , t) in (4.13) and substituting into (4.11) gives the nominal unactuated closed-loop dynamics

 = f  ( , v( , t)) = f 0 ( ) + f 1 ( ) sin(t/ ) + f 2 ( ) cos(2t/ ), 

(4.15)

where

     f 0 ( ) =     

-k1 q1 /2 -k2 q2 /2 (z + (k1 - k2 )q1 q2 )/2
cz k1 k2 q1 q2 - cz k3 k4 q3 /2 - cz k3 k5 z /2  

     ,         .   

¬Ø ( )/2 -k3   ( )/2 ¬Ø ( )/2 q1  ( )/2 + k3 q2  ¬Ø (  ) - c z k 1 q1  (  ) c z k 2 k 3 q2 

0 0 0 cz (k3 k4 q3 + k3 k5 z )/2

    f 1 ( ) =    

         , f 2 ( ) =       

Unsurprisingly, vector fields f 0 ( ), f 1 ( ), f 2 ( ) are all homogeneous of degree zero
¬Ø r with respect to  .

We now proceed to construct a homogeneous strict Lyapunov function for (4.15). As in [H. Li, Yan, and Shi, 2017], consider
4 2 2 V ( ) = aq4 1 + bq2 + cq3 + d z + eq3 z ,

(4.16)

where a, b, c, d, e > 0. It is straightforward to see that V ( ) is homogeneous of degree
¬Ø r 4 with respect to  . A necessary and sufficient condition for V ( ) to be positive-

definite, is that 4cd > e2 . (4.17)

This can be obtained by considering that V ( ) is positive-definite if and only if cq2 3+
2 + eq  is positive-definite in ( q ,  ). In turn, since d z z 3 z 3


2 cq2 3 + d z + eq3 z =

 c



q3  z

 

e/2   q3   , e/2 d z

73

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller
2 cq2 3 + d z + eq3 z is positive-definite if and only if the above matrix is positive-

definite, leading to (4.17). We now first consider the averaged system corresponding to (4.15) given by the vector field f 0 ( ). We find that the Lie derivative of V along f 0 is given by
4 2 2 L f0 V ( ) = -2ak1 q4 1 - 2bk 2 q2 - ( ecz k 3 k 4 /2) q3 - ( dcz k 3 k 5 - e /2) z

+(c - dcz k3 k4 - ecz k3 k5 /2)q3 z + (c(k1 - k2 ) + ecz k1 k2 )q1 q2 q3 +(2dcz k1 k2 + e(k1 - k2 )/2)q1 q2 z .
By Young's inequality, we have
2 2 2 2 2 2 2 | q3  z |  q2 3 /2 + z /2, | q1 q2 q3 |  q1 q2 / (2 ) +  q3 /2, | q1 q2 z |  q1 q2 / (2 ) + z /2,

(4.18)

for any  > 0. Applying Young's inequality again to the second two inequalities leads to
4 2 4 4 2 | q1 q2 q3 |  ( q4 1 + q2 ) / (4 ) +  q3 /2, | q1 q2 z |  ( q1 + q2 ) / (4 ) + z /2.

Utilizing these inequalities, we can now upper-bound L f0 V ( ) in (4.18) by L f0 V ( )  - (2ak1 - |c(k1 - k2 ) + ecz k1 k2 |/(4)

-|2dcz k1 k2 + e(k1 - k2 )/2|/(4)) q4 1 - (2bk2 - |c(k1 - k2 ) + ecz k1 k2 |/(4) -|2dcz k1 k2 + e(k1 - k2 )/2|/(4)) q4 2 - (ecz k3 k4 /2 - |c(k1 - k2 ) + ecz k1 k2 |/2 -|c - dcz k3 k4 - ecz k3 k5 /2|/2) q2 3 - (dcz k3 k5 - e/2 - |2dcz k1 k2 + e(k1 - k2 )/2|/2
2 -|c - dcz k3 k4 - ecz k3 k5 /2|/2) z .

(4.19)

74

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller We now proceed to choose a, b, c, d, e to make V ( ) positive-definite and L f0 V ( ) negative definite. First, fix e > 0. Next, choose d > 0 such that

d > e / (2c z k 3 k 5 ).

(4.20)

Next, we set c = dcz k3 k4 + ecz k3 k5 /2. (4.21)

To ensure that an appropriate d > 0 is chosen, recall that (4.17) must hold. Substituting (4.21) into (4.17) leads to 4d2 cz k3 k4 + 4decz k3 k5 /2 > e2 .

(4.22)

Noting that the left-hand sides of (4.20) and (4.22) both tend to positive infinity as d increases, we can choose d > 0 to simultaneously satisfy (4.20) and (4.22), and then with c given by (4.21), the condition in (4.17) is automatically satisfied. Next, having chosen appropriate c, d, e, select  > 0 small enough such that

ecz k3 k4 > |c(k1 - k2 ) + ecz k1 k2 |, dcz k3 k5 - e/2 > |2dcz k1 k2 + e(k1 - k2 )/2|/2.
2 With this choice of c, d, e, , the coefficients of q2 3 , z in (4.19) are negative. Finally 4 choose a, b > 0 large enough to make the coefficients of q4 1 , q2 in (4.19) negative. We

now summarize our initial findings. Proposition 13. Consider f 0 ( ) as defined in (4.15), with k1 , k2 > 0 and k3 , k4 , k5 satisfying cz k3 k4 , cz k3 k5 > 0. Then, there exists a smooth positive-definite V : R4  R satisfying ¬Ø 4 ( )  V ( )   2  ¬Ø 4 (  ), L f 0 V (  )  -  3  ¬Ø 4 (  ), 1  for all   R4 , for some  1 ,  2 ,  3 > 0. Proof. Consider V ( ) as constructed above, which is homogeneous of degree 4 with
¬Ø r respect to  . From Proposition 4, L f0 V ( ) is homogeneous of degree 4 with re¬Ø r spect to  . Since V is positive-definite, and L f0 V is negative definite, the result

(4.23)

75

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller follows from Corollary 1, with  1 = min : ¬Ø ( )=1 V (  ),  2 = max : ¬Ø ( )=1 V (  ) and  3 = - max : ¬Ø ( )=1 L f 0 V (  ). This concludes the proof. We now proceed to the full nominal reduced system in (4.15), following the general approach presented in [Morin and Samson, 1997]. The Lie derivative of V along f  is given by V V f 1 ( ) sin(t/ ) + f 2 ( ) cos(2t/ ).  

L f  V ( ) = L f0 V ( ) +

The last two terms here require treatment. Consider the function ~ (  , t / ), W ( , t) = V ( ) + V

(4.24)

where ~ ( , t) = cos(t) V f 1 ( ) - 1 sin(2t) V f 2 ( ). V  2  ~ ( , t) is simply the negative anti-derivative with respect to t of the two Note that V terms we wish to eliminate in L f  V ( ). For W ( , t) to be a suitable candidate for a Lyapunov function, it needs to be continuously differentiable. Now, V ( ) and f 2 ( ) are smooth. However, f 1 is smooth everywhere except at  = 0, so we need to check that (V / ) f 1 is continuously differentiable at  = 0. Since (/ )((V / ) f 1 ) is smooth on R4 \ {0}, it is enough to show that (/i )((V / ) f 1 )( )  0 as 

 0 for i = 1, 2, 3, 4. We recog-

nize utilizing Proposition 3 that (/i )((V / ) f 1 ) is homogeneous of degree 3 for i = 1, 2, and homogeneous of degree 2 for i = 3, 4 on R4 \ {0}. By Rosier [Rosier,
¬Ø r 1992], any  = 0 can be written as  =  (y ( )), where y ( )  S3 . Conset ( )

quently for  = 0,  i V fi  V ¬Ø r f i ( (y ( ))) , t ( )   V k = t ( ) f i (y ( )) , i   i

( )

=

k  t (  ) p,

76

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller where k = 3 for i = 1, 2 and k = 2 for i = 3, 4, and  i V fi 
¬Ø r ( (y ( ))) . t ( )

p = max
 S3

k (  )  0 as By Rosier [Rosier, 1992], t



 0, and consequently so does

(/i )((V / ) f 1 )( ). We conclude that W ( , t) is at least continuously differentiable in all of its arguments. We shall now find restrictions on function for (4.15). We now evaluate ~ W V W + f  ( , v( , t)) = L f0 V ( ) + f  ( , v( , t)). t  

> 0 such that W ( , t) is a strict Lyapunov

(4.25)

~ and (V ~ / ) f  are both continuous, periodic in t with period T = 2 , Noting that V
¬Ø r and homogeneous of degree 4 with respect to  , from Corollary 1 we obtain

~ (  , t ) |  1  ¬Ø 4 (  ), |V for all ( , t)  R4 √ó R, where

~ V ¬Ø 4 (  ), f  ( , v( , t))  2  

1 =

¬Ø ( )=1,0t T } { (  ,t ) : 

max

~ (  , t ) |,  2 = |V

¬Ø ( )=1,0t T } { (  ,t ) : 

max

~ V f  ( , v( , t)) . 

Consequently, from Proposition 13 we find that ¬Ø 4 (  ), W (  , t )  (  1 - 1 )  W W ¬Ø 4 (  ), ( , t) + f  ( , v( , t))  -(  3 - 2 ) t  (4.26)

for all ( , t)  R4 √ó R. From this, it is clear that W ( , t) is a strict Lyapunov function for (4.15), provided 0< Next, we summarize the results. Proposition 14. Consider the control law in (4.13), with k1 , k2 > 0 and k3 , k4 , k5 satisfying cz k3 k4 , cz k3 k5 > 0. Consider V ( ) as obtained in Proposition 13, and let satisfy (4.27).

< min {  1 /1 ,  3 /3 } .

(4.27)

77

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller Then, W ( , t) as defined in (4.24) is continuously differentiable, and satisfies W W ¬Ø 2 ¬Ø 1 ¬Ø 3 ¬Ø 4 ( )  W ( , t)   ¬Ø 4 (  ), ¬Ø 4 (  ),  ( , t) + f  ( , v( , t))  -  t  ¬Ø 1,  ¬Ø 2,  ¬Ø 3 > 0. for all ( , t)  R4 √ó R, for some 
¬Ø r , Proof. By construction W ( , t) is homogeneous of degree 4 with respect to 

and W /t( , t) + (W / ) f  ( , v( , t)) is also homogeneous of degree 4 by Proposition 4. They are both continuous and periodic with period T = 2 . As shown, when satisfies (4.27), W is positive-definite, while W /t( , t) +

(W / ) f  ( , v( , t)) is negative definite. Corollary 1 then yields the result with
¬Ø 1 = min ¬Ø  ¬Ø ( )=1,0t T W (  , t ),  2 = max ¬Ø ( )=1,0t T W (  , t ) and ¬Ø3 = -  max W /t( , t) + (W / ) f  ( , v( , t)).

¬Ø ( )=1,0t T 

This concludes the proof. Corollary 4.2.1. Under the conditions stated in Proposition 14, the nominal unactuated states closed-loop dynamics in (4.15) are globally exponentially stable with respect to the ¬Ø. homogeneous norm  Proof. Let  (0) be given, and  (t) the resulting trajectory of (4.15). By Proposition 14, along the trajectory  (t), the Lyapunov function W ( , t) satisfies  (  ( t ), t ) = W W W (  ( t ), t ) + f  ( (t), v( (t), t)), t  ¬Ø 3 ¬Ø 4 ( (t)),  -

¬Ø 3/ ¬Ø 2 )W (  ( t ) , t ) .  -(  By the Comparison Principle [Khalil, 1998], W ( (t), t)  W ( (0), 0)e-( 3 / 2 )t . Ap¬Ø ¬Ø ¬Ø 2/ ¬Ø 1 )1/4  ¬Ø ( (t))  (  ¬Ø ( (0))e-( 3 /(42 ))t . This plying Proposition 14 again leads to  ¬Ø ¬Ø

concludes the proof.

4.2.4

Control design for actuated states

We now consider the full nominal system corresponding to (4.9), given by the vector field f ( x, un ). In the previous section, we established that if the actuated states 78

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller y = [x , y ] T is treated as a control input to the nominal unactuated state dynamics f  ( , y), then the nominal unactuated state dynamics are globally exponentially stable with control law y = v( , t). We now wish to design the control law un for the actuated states such that y becomes close to v( , t). However, to ensure that
r , we must do so in a way f ( x, un ) is homogeneous of degree zero with respect to 

that unx ( x, t) and uny ( x, t) are homogeneous of degree 1. Following the methodology in [Morin and Samson, 1997], we choose

unx ( x, t) = -k x (x - v x ( , t)), uny ( x, t) = -k y (y - vy ( , t)),

(4.28) (4.29)

¬Ø r where k x , k y > 0. Since v x , vy are homogeneous of degree 1 with respect to  (which r ), it is readily seen that u ( x , t ) and u ( x , t ) are homogeneous is compatible with  nx ny r. of degree 1 with respect to 

Remark. For selection of the gains, we can first consider the averaged reduced closed-loop system corresponding to (4.15) given by

 = f 0 (  ). 

Linearizing this yields the following averaged reduced dynamics for  , given by

 i + (k i /2)qi = 0, q

for i = 1, 2, and ¬®3 + (cz k3 k5 /2)q  3 + (cz k3 k4 /4)q3 = 0. q These are standard first and second order linear systems, for which there are a wealth of results. Based on these the gains k1 to k5 may be designed to yield the desired averaged reduced closed-loop dynamics. Following this, tuned to yield the overall closed-loop performance. We can now proceed to construct a strict Lyapunov Function for the full nominal closed-loop system described by the vector field f ( x, un ), with control law given by (4.28) and (4.29). Following the approach given in [Morin and Samson, 1997]. In 79

> 0 and k x , k y may be

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller the sequel, it is assumed that k1 , k2 , k3 , k4 , k5 , have all been chosen to satisfy the

conditions stated in Proposition 14. Define the functions s3 - v3 i (  , t ) ds, vi ( ,t)) 3 i4 /4 + 3v4 i (  , t ) /4 - i vi (  , t ),
i

i ( , t, i ) =

=

(4.30)

for i = x, y. As remarked in [Morin and Samson, 1997], i ( , t, i )  0 for all

( , t, i )  R4 √ó R √ó R, and i ( , t, i ) = 0 if and only if i = vi ( , t). It is also
straightforward to see from the second line in (4.30) that i is homogeneous of der . Finally, using a similar approach as was used to establish gree 4 with respect to 

continuous differentiability of W ( , t) in (4.24), it can be shown that i ( , t, i ) is also continuously differentiable on R4 √ó R √ó R. We now consider 1 ¬Ø ( x, t) = W ( , t) +  V x (  , t ,  x ) + kx 1 y ( , t, y ). ky

(4.31)

¬Ø r Since W ( , t) is homogeneous of degree 4 with respect to  , which is compatible r , we find that V ¬Ø ( x, t) is homogeneous of degree 4 with respect to r . We also with  

¬Ø ( x, t) is continuously differentiable, periodic with period T = 2 , and know that V non-negative. To show that it is in fact positive-definite, for any t  R, V ( x, t) = 0 implies that W ( , t) = 0 and i ( , t, i ) = 0 for i = x, y (since they are all nonnegative). W ( , t) = 0 implies that  = 0, which implies that vi ( , t) = 0 for i = x, y. As remarked above, i ( , t, i ) = 0 then implies that i = 0 for i = x, y. Conversely, it is straightforward to see from its definition that V (0, t) = 0 for all t  R. Hence, V ( x, t) is positive-definite, and by Corollary 1 we obtain ~ 1 4 ( x )  V ~ 2 4 ( x ), ¬Ø ( x, t)    ~ 1 = min(x)=1,0tT V ~ 2 = max(x)=1,0tT V ¬Ø ( x, t) > 0,  ¬Ø ( x , t ). where 

(4.32)

80

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller We now compute ¬Ø ¬Ø V V + f ( x, un ( x, t)) = t x W W + f  ( , v( , t)) t  1 x 1 y + unx ( x, t) + uny ( x, t) k y y k x x y y x 1 x 1 + + f  ( , y) + + f  ( , y) t  t  ky kx

+

W f  ( , y) - f  ( , v( , t)) . 

(4.33)

where we have added and subtracted (W / ) f  ( , v( , t)). We now deal with (4.33) line by line. First, by Proposition 14, we have W W ¬Ø 3 ¬Ø 4 (  ). + f  ( , v( , t))  -  t  Next, by (4.28), (4.29) and (4.30), we have i uni ( x, t) = -k i (i3 - v3 i (  , t ))( i - vi (  , t )), i for i = x, y. It can be readily seen that only if i = vi ( , t). Furthermore,
i i uni ( x , t )

(4.34)

(4.35)

 0, and

i i uni ( x , t )

= 0 if and

i i uni ( x , t )

is homogeneous of degree 4 with

r . As a consequence, the function respect to 

3 3 3 ¬Ø 4 ( ) + (x F ( x, t) =  - v3 x (  , t ))(  x - v x (  , t )) + ( y - vy (  , t ))( y - vy (  , t )) ,

(4.36)
r . It is also periis positive-definite and homogeneous of degree 4 with respect to 

odic with period T = 2 . Now, define the functions on (R6 \ {0}) √ó R.  i + i f  (  , y ) / F ( x , t ), i = x , y. t 

Hi ( x, t) =

r , since the nuThese functions are homogeneous of degree zero with respect to 

merator and denominator are both homogeneous of degree 4. Define i =

x S5 ,0t T

max

Hi ( x, t) > 0,

(4.37)

81

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller
r for i = x, y. Then, any x = 0 can be written as  (y ( x )), where y ( x )  S5 , and t (x) 0 ( x ) H (  ( x ), t )   . As a result, r (y ( x )), t) = t Hi ( x, t) = Hi ( y i i t (x)

 i + i f  (  , y )   i F ( x , t ), i = x , y, t  for all ( x, t)  R6 √ó R (note that (4.38) can be directly verified for x = 0).

(4.38)

Define the set X = {( x, t) : x  S5 , 0  t  T } \ {( x, t) : y = v( x, t)}, and consider the following function
W 

G ( x, t) =

f  ( , y) - f  ( , v( , t))

¬Ø 3 /2) ¬Ø 4 ( ) - (

3 - v3 (  , t ))(  - v (  , t )) + (  3 - v3 (  , t ))(  - v (  , t )) (x y y x x y y x

.

r . We now show Note that G ( x, t) is homogeneous of degree zero with respect to 

that G ( x, t) is bounded from above on X . Suppose to the contrary that it is unbounded. Then, we can find a sequence {( xi , ti )}  X  S5 √ó [0, T ], such that limi G ( xi , ti ) = . Since S5 √ó [0, T ] is compact, taking a subsequence if neces¬Ø)  S5 √ó [0, T ]. By con¬Ø, t sary, it follows that {( xi , ti )} converges to an element ( x tinuity of the numerator of G ( x, t) and the compactness of S5 √ó [0, T ], the numerator is bounded. Hence, the denominator of G ( xi , ti ) must converge to zero, that is, ¬Ø). Now, since x ¬Ø = v( ¬Ø, t ¬Ø  R5 , it must be that  ¬Ø = 0 (since otherwise we would also y ¬Ø = v(0, t) = 0). By continuity of |(W / )( f  ( , y) - f  ( , v( , t)))|, this term have y converges to zero as i  , and the numerator of G ( xi , ti ) becomes negative for large enough i. However, this contradicts the original assertion that limi G ( xi , ti ) = . Consequently, G ( x, t) is bounded from above on X . Taking 3 = sup G ( x, t),
( x ,t )  X

(4.39)

we obtain W f  ( , y) - f  ( , v( , t))  ¬Ø 3 /2) ¬Ø 4 ( )  (
3 + 3 (  x - v3 x (  , t ))(  x - v x (  , t )) 3 +(y - v3 y (  , t ))( y - vy (  , t )) ,

(4.40)

82

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller for all ( x, t)  R6 √ó R. Inequality (4.40) can be shown to hold directly for the case y = v( x, t), while for (R6 √ó R) \ {( x, t) : y = v( x, t)} (4.40) can be shown to hold by applying similar homogeneity arguments as before. Finally, substituting (4.34), (4.35), (4.38) and (4.40) into (4.33), we obtain ¬Ø V t ¬Ø V ¬Ø 3 /2 -  x / f ( x, un ( x, t))  -(  x k x - y / ¬Ø 4 ( ) k y )

+

-( -(

k x - 3 -  x / k y - 3 -  x /

k x - y / k x - y /

3 k y )(x - v3 x (  , t ))(  x - v x (  , t )) 3 k y )(y - v3 y (  , t ))( y - vy (  , t )),

(4.41) ¬Ø / t  t + ( V ¬Ø / x ) f ( x, un ( x, t)) is negative defifor all ( x, t)  R6 √ó R. We see that V nite if we choose k x , k y such that ¬Ø 3 /2 -  x / 0 <  0 < 0 < k x - y /

ky , ky , ky . (4.42)

k x - 3 -  x / k y - 3 -  x /

k x - y / k x - y /

These inequalities are clearly feasible for k x , k y (simply make them large enough). Next, the following Proposition is proposed. Proposition 15. Consider the control law defined in (4.13), (4.28) and (4.29), where k1 , k2 , k3 , k4 , k5 , satisfy the conditions stated in Proposition 14, and k x , k y satisfy (4.42). Then,

¬Ø ( x, t) as defined in (4.31) is continuously differentiable, and satisfies V ¬Ø ¬Ø ~ 1 4 ( x )  V ~ 2 4 ( x ), V ( x, t) + V f ( x, un ( x, t))  -  ~ 3V ¬Ø ( x, t)   ¬Ø ( x , t ),  t x ~ 1,  ~ 2,  ~ 3 > 0. for all ( x, t)  R6 √ó R, for some 
¬Ø ¬Ø ( x, t) is homogeneous of degree 4 with respect to r Proof. By construction V  , and

¬Ø /  t ( x , t ) + ( V ¬Ø / x ) f ( x, un ( x, t)) is also homogeneous of degree 4 by Proposition V 4. They are both continuous and periodic with period T = 2 . The first inequality in the Proposition has already been obtained in (4.32). As shown, when k x , k y sat¬Ø /  t ( x , t ) + ( V ¬Ø / x ) f ( x, un ( x, t)) is negative definite. Corollary 1 then isfy (4.42), V

83

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller ¬Ø /  t ( x , t ) + ( V ¬Ø / x ) f ( x, un ( x, t))  - a4 ( x ), where yields V a=- ¬Ø /  t ( x , t ) + ( V ¬Ø / x ) f ( x, un ( x, t)). V

( x )=1,0t T

max

~ 3 = a/  ~ 2 by appliThe second inequality in the Proposition is then obtained with  cation of the first inequality in the Proposition. This concludes the proof. Having obtained a global strict Lyapunov function for the nominal system corresponding to (4.9), as in Proposition 15, we shall now proceed to the full system without uncertainties and disturbances, described by f ( x, un ) and g( x ) in (4.9). We follow the approach in Du et al. [Du and S. Li, 2012] and Gui and Vukovich [Gui, Vukovich, and S. Xu, 2016]. Suppose that there exists a 0 > 0, such that ~3  r ¬Ø ( Lg V ( x ), t )  4 , 2 for all ( x, t)  S5 √ó R, when 0 <  < 0 , where = ¬Ø ( x , t ). V

(4.43)

x S5 ,0t T

min

(4.44)

Define the set
r ¬Ø ), x ¬Ø  S5 , 0   < 0 }. U0 = { x  R : x =  (x

(4.45)

Proposition 16 (Gui et al. (Gui, Vukovich, and S. Xu, 2016)). The set U0 in (4.45) is open and contains the origin. If (4.43) holds, then by the definition of , we obtain
r ¬Ø ( Lg V ( x ), t )  4

~3  ¬Ø ( x , t ), V 2

(4.46)

r (x ¬Ø ), for some for all ( x, t)  S5 √ó R when 0 <  < 0 . Any x = 0 can be written as 

¬Ø  S5 . Hence, for arbitrary x = 0, (4.46) leads to  > 0 and x
r ¬Ø ( x, t) = L f V ¬Ø ( ¬Ø ), t )  4 Lg V (x

~3  ¬Ø (x ¬Ø , t ), V 2 (4.47)

=

~3 ~3   r ¬Ø ( ¬Ø  ( x , t ), ¬Ø ), t ), = V (x V 2 2

84

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller ¬Ø has been used. Continuity of L f V ¬Ø and V ¬Ø imply that (4.47) where homogeneity of V holds for x = 0 also with any t  R. As a result, combining Proposition 15 and (4.47), ~3 ¬Ø ¬Ø V V  ¬Ø ( x , t ), ( x, t) + ( f ( x, un ( x, t)) + g( x ))  - V t x 2 for all ( x, t)  U0 √ó R. It remains to establish the condition in (4.43). Note that (4.43) is equivalent to the existence of 0 > 0, such that ¬Ø ( r ( x ), t ) ~3 Lg V    , 2 4 for all x  S5 , when 0 <  < 0 . We have for ( x, t)  S5 √ó [0, T ] and  > 0 ¬Ø ( r ( x ), t ) Lg V  4 1 4
6 r r ( x ), t) gi ( ( x )),   xi ( 6

(4.48)

(4.49)

= =

¬Ø V

i =1

r ( x )) ¬Ø gi ( V ( x , t ) ,   xi ri i =1

¬Ø / x is continuous, it is uniformly where Proposition 3 has been used. Since V
r ( x )) / ri need bounded on S5 √ó [0, T ], which is compact. Hence, only the terms gi ( r , we define the reduced to be considered for i = 1, ..., 6. Related to the dilation  ~ r dilation for qv by  (qv ) = (q1 , q2 , 2 q3 ). From (4.9), we see that for i = 1, 2, r ( x )) / ri | is upper-bounded by terms of the form | gi (

|  q j 2  z | = 2 |q j z |/2  2 /2, j = 1, 2, 2 |2 q3  j | = 2 |q3  j |/2  2 /2, j = x, y, 2
~ ( q ) T r ~ r |( 1 -  v  ( qv ) - 1)  j | ~ r  | j |  (qv ) /2  /2, j = x, y

2

where we have used the fact that |q j |, |k |, qv  1, j = 1, 2, 3, k = x, y, z for x  S5 ,
~ ~ r r and the fact that  (qv )   (qv ) 1

 max{, 2 } for qv  1, together with

~ r Proposition 7. Note that Proposition 7 can only be applied if  (qv )  1, which

requires that   1. As a consequence, max{, 2 } = , and we require 0  1.

85

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller In a similar manner, for i = 3, we obtain
2 ~ ( q ) T r ~ r |( 1 -  v  ( q v ) - 1)   z |

22 Finally, for i = 5, 6, we obtain
~ r ( x ))| | gi (

 /2.



   x, i = 5, 2  |c j | , j =   y, i = 6

Putting everything together, we obtain ¬Ø ( r ( x ), t ) Lg V   b1 2 + b2 , 4 where b1 = a1 + a2 + a5 |c x | + a6 |cy |, b2 = ( a1 + a2 + a3 )/2 and ¬Ø V ( x, t) ,  xi

(4.50)

ai = max

S5 √ó[0,T ]

(4.51)

for i = 1, ..., 6. From (4.50), we now find that (4.49) is satisfied for 0 <  < 0 , when 0 = min{1, (
2 + 2b  ~ b2 1 3  - b2 ) / (2b1 ) }.

(4.52)

As result, we get the following. Lemma 4.3. Consider the control law defined in (4.13), (4.28) and (4.29), where k1 , k2 , k3 , k4 , k5 , and satisfy the conditions stated in Proposition 14, and k x , k y satisfy (4.42). Then,

 = f ( x, un ( x, t)) + g( x ) is locally exponentially stable. the closed-loop system defined by x ¬Ø ( x, t) as given in Proposition 15 satisfies (4.48) Proof. By the previous development, V for all ( x, t)  U0 √ó R. By Remark 1, there exists a  > 0, such that the closed ¬Ø  (0) is contained in U0 . Let x (0)  B ~ ~ 1/4 (0)  B (0). homogeneous ball B ( 1 / 2 )  ~ 2 4 ( x (0)) <  ~ 1 4 . Let x (t) be the trajectory ¬Ø ( x (0), 0)   Then, by Proposition 15, V  = f ( x, un ( x, t)) + g( x ) resulting from initial condition x (0). From Proposition of x ~ 1 4 implies that x (t)  B (0). By (4.48), we have ¬Ø ( x ( t ), t ) <  15, we note that V  ( x (t), t)  0 while x (t)  U0 . Consequently, we have V ¬Ø ¬Ø ( x ( t ), t )  V ¬Ø ( x (0), 0) < V ~ 1 4 while x (t)  U0 . Since x (t) cannot leave U0 before leaving B (0) (the boundary  86

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller of B (0) is contained in U0 ), we must therefore have x (t)  B (0) for all t  0. Finally, in a similar manner as in the proof of Corollary 4.2.1, we obtain ( x (t))  ~ 2/ ~ 1 )1/4 ( x (0))e-( 3 /(42 ))t . This concludes the proof. ( Next, we handle the uncertainties and disturbances contained in the terms h( x, t, ~ ), D in (4.9). First, we define   R3 such that d ,  J ,    (4.53) 03√ó1  ¬Ø= ~ ) + D.    = h( x, t, d ,  J ,  
~ ~

We temporarily assume that there exist im > 0, such that |i (t)|  im for i = 1, 2, 3. This will be made rigorous shortly.
r (x ¬Ø ), for some x ¬Ø  S5 . Again, any non-zero x  U0 can be written as x = 

Therefore, for any ( x, t)  U0 √ó R with x = 0, ¬Ø V ¬Ø = ( x, t) x ¬Ø r V ¬Ø, ¬Ø ), t )  ( ( x x  ¬Ø r ¬Ø r ¬Ø r V V V ¬Ø ), t)1 + ¬Ø ), t)2 + ¬Ø ), t)3 , = ( ( x ( ( x ( ( x z x y  ¬Ø ¬Ø ¬Ø V V V ¬Ø , t)1 + 3 ¬Ø , t)2 + 3 ¬Ø , t)3 , = 2 (x (x (x z x y

 2 a4 1m + 3 ( a5 2m + a6 3m ),  2 = = ( a5 2m + a6 3m ) ¬Ø 3/4 a4 1m ¬Ø 1/2 ¬Ø , t ) + 3 ¬Ø , t ), V (x V (x 1/2  3/4 1/2 a4 1m ( a5 2m + a6 3m ) 4 ¬Ø 4 ¬Ø ¬Ø ¬Ø , t)  V ( x , t ) +  V (x 1/2  3/4 ( a5 2m + a6 3m ) ¬Ø 3/4 a4 1m ¬Ø 1/2 V ( x, t) + V ( x , t ), 1/2  3/4

3/4

, (4.54)

¬Ø , V ¬Ø / x and the defiwhere Proposition 3, the homogeneity and periodicity of V nitions of  and ai in (4.44) and (4.51) have been made use of. By Proposition 3, ¬Ø /i )(0, t) = 0 for i = x, y, z and for all t  R. Hence, (4.54) holds for x = 0 also. ( V Consequently, combining (4.54) with (4.48), we find that ¬Ø ¬Ø V V ¬Ø 1/2 ( x, t) ¬Ø )  -V ( x, t) + ( f ( x, un ( x, t)) + g( x ) +  t x ~3  ¬Ø 1/2 ( x, t) - c1 V ¬Ø 1/4 ( x, t) - c2 , V 2 (4.55)

87

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller for all ( x, t)  U0 √ó R, where

c1 =

( a5 2m + a6 3m ) a4 1m , c2 = 1/2 . 3/4 

It is now straightforward to determine that the left-hand side of (4.55) is strictly negative when ¬Ø ( x , t ) > , V where  = c1 + (4.56)

4 ~ c2 1 + 2c2  3  . ~3 

(4.57)

With reference to the proof of Lemma 4.3, we require ~ 1 4 , <

(4.58)

since if this holds, then in a manner similar to the proof of Lemma 4.3, (4.55) shows that for any initial x (0)  B(  ~ 1 / ~ 2 )1/4  (0), the resulting solution x ( t ) of (4.9) cannot leave B (0). Furthermore, along such a trajectory, ¬Ø ( x ( t ), t )  , lim sup V
t

(4.59)

and by Proposition 15 it follows that  ~1 
1/4

lim sup ( x (t)) 
t

.

(4.60)

The final item required is to obtain suitable bounds im . First, since we assume qv is available, we define the estimate of x
T

^= x

^ z ^ x ^y qv 

.

(4.61)

The velocity-free control law is then defined as ^ , t) = un ( x ^ , t ) = u n ( x , t ) +  u ( x , t,  ~ ), u( x

(4.62)

88

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller where ~ ) = un ( x ^ , t ) - u n ( x , t ),  u ( x , t,  ~ ), satisfying u( x, t, 0) = 0 for all ( x, t)  is a continuous periodic function of ( x, t,  R6 √ó R. ¬Ø ¬Ø  (0). Then, for any ¬Ø > 0 and define the set W = B Proposition 17. Fix  ¬Ø (0) √ó R √ó B dm  > 0 there exist ~ < with  ¬Ø , dm ,  ), 2 ( ¬Ø , dm ,  ) 1 (

> 0 such that  J 

¬Ø , dm ,  ) 1 (

together

¬Ø , dm ,  ) 2 (

~ ) <  for all ( x, t, d )  W. imply that h( x, t, d ,  J , 

¬Ø ¬Ø =B ¬Ø is com¬Ø  (0). First, note that the set W Proof. Define the set W ¬Ø (0) √ó [0, T ] √ó B dm ¬Ø . Choose arbipact in R6 √ó R √ó R3 . Note that h( x, t, d , 0, 0) = 0 for all ( x, t, dm )  W trary  > 0. Continuity of h on R3 √ó R √ó R3 √ó R3√ó3 √ó R3 implies that for each point ¬Ø , there exists z = ( x, t, d )  W
1,z , 2,z

> 0 and a neighborhood Vz  R3 √ó R √ó R3 of
1,z

¬Ø,  ¬Ø,  ¬Ød ,  J ,  ¬Ød ),  J ,  ¬Ø, t ~ ) <  for all (( x ¬Ø, t ~ )  Vz √ó B z, such that h( x

(0) √ó B

2,z

(0).

¬Ø ) form an open cover of W ¬Ø . Since Next, the collection of all such sets Vz (with z  W ¬Ø is compact, there exist z1 , ..., zn  W , such that W ¬Ø  W ¬Ø,  ¬Ø,  ¬Ød ,  J ,  ¬Ød ),  J ,  ¬Ø, t ~ ) <  for all (( x ¬Ø, t ~)  h( x fine ¬Ø , dm ,  ) i (
n i =1 Vzi n i =1 Vzi .

By construction,
2,zi

√óB

1,zi

(0) √ó B

(0). De-

= min{
2,zi

i,z1 , ..., i,zn }

¬Ø √ó B (0) √ó B (0)  for i = 1, 2. Then, W 2 1

n i =1 Vzi

√óB

1,zi

(0) √ó B

(0), from which the conclusion follows by recognizing that

¬Ø may be replaced h is periodic and therefore the interval [0, T ] in the definition of W by R to obtain the result on the set W . This concludes the proof. Finally, we obtain the following result. Lemma 4.4. Consider the control law defined in (4.13), (4.28) and (4.29), where k1 , k2 , k3 , k4 , k5 , k x , k y , satisfy the conditions stated in Proposition 15. Let  > 0 be as defined in

the proof of Lemma 4.3. Consider im > 0 for i = 1, 2, 3, such that  as defined in (4.57) satisfies (4.58). Suppose that dm satisfies dm / Jz < i1 , dm / Jx < i2 and dm / Jy < i3 . Choose  > 0 such that  + dm / Jz  i1 ,  + dm / Jx  i2 and  + dm / Jz  i3 . ¬Ø > , obtain Choosing  that  J ¬Ø  R+ t ¬Ø , dm ,  ), 2 ( ¬Ø , dm ,  ) 1 ( ~ (t) and that 

> 0 from Proposition 17. Suppose
¬Ø], for some for all t  [0, t

<

¬Ø , dm ,  ), 1 (

<

¬Ø , dm ,  ), 2 (

{}. Let x (0)  B(  ~ 1 / ~ 2 )1/4  (0), with x ( t ) the resulting trajectory of (4.9).

89

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller ¬Ø]. Furthermore, if this holds for any t ¬Ø  0, then Then, x (t)  B (0) for t  [0, t  ~1 
1/4

lim sup ( x (t)) 
t

.

¬Ø ( x, t) as given in Proof. By Proposition 17, and the stated conditions on  and dm , V ¬Ø Proposition 15 satisfies (4.55) for all ( x, t)  (B ¬Ø (0) ¬Ø U0 ) √ó R. Since (B ¬Ø (0) U0 ) 

¬Ø  (0), it follows by similar arguments to those given following equation (4.58) that B ¬Ø  0, x (t) cannot leave B (0) during the interval [0, T ]. Finally, if this holds for any t then the arguments leading up to (4.60) are valid. This concludes the proof.

4.2.5

Observer design

^,  ^ be the estimates of q,  respectively, and define the attitude estimation error Let q ~ = (q ~v , q ~4 ) by C (q ~) = C ( q ) C T ( q ^) and  ~ = - ^ . Let q ^ satisfy q  = 1 B(q ^ ^) p, q 2

(4.63)

 (q ^) = - p √ó C ( q ^). Consequently, it is for some p, or equivalently [Hughes, 1986], C  (q ~) = - (  - C ( q ~) p ) √ó C ( q ~), which is equivalent to straightforward to show that C  = B(q ~ ~)( - C (q ~ ) p ). q

(4.64)

The observer is now defined as  = ^ q 1 ~)  ^ + 1 P-1 (q ~)sig (q ~v ) , ^) C T ( q B(q 2

(4.65) (4.66)

 = - ^ ^ √ó Jn  ^ + gn + u + 2 J sig1 (q ~v ), Jn  where 1 , 2 > 0,   (1/2, 1), 1 = 2 - 1 and ¬µ (C (q) R)√ó Jn C (q) R, R 5

gn = 3

(4.67)

~) is invertible provided is the nominal gravity-gradient torque. Note that P-1 (q ~v q

< 1. Since a local stability result is obtained, this restriction poses no prob-

lem. Utilizing (4.2), (4.5), (4.62), (4.63), (4.64), (4.65), and (4.66), one obtains the error

90

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller equations v = ~ q 1 ~)  ~ - 1 P-1 (q ~)sig (q ~v ) , B(q 2

(4.68) (4.69)

-1 -1 ~ + Jn  = -2 sig1 (q ¬Ød , ~ ~v ) - Jn ^ √ó Jn  ^)+  ( √ó Jn  -  

where
-1 √ó -1 ~ = Jn ~ ))   Jn  - J -1  √ó J  + ( J -1 - Jn ) Jn H (un ( x, t) + u( x, t,  -1 -1 ¬Ød . + J -1 g - Jn gn + ( J -1 - Jn )

~ , it is straightforward to show that Next, using the definition of  ^ √ó J ^ = ~ √ó J  + √ó J  ~ - ~ √ó J ~. √ó J  - 

~v < 1, Finally, since a local stability result is pursued, with the assumption that q
T,  ~4 > 0. Defining x ~ = [q ~v ~ T ] T , the observer error dynamics in (4.68) and choose q

(4.69) can be written as ~ ( x , t,  ~,  = g ( x ¬Ød , r,  ~ ~ ) + f~(q ~v ,  ~ , ) + h ~ ,  J) + d x

(4.70)

where   ~) =  g ( x   ~ ( x , t,  ¬Ød , R,  ~ ,  J) =  h  ~ ~)  ~v ,  ~)  g1  ( x  f 1 (q ~v ,  ~ , ) =   , f~(q , ~) ~ , ) g2  ( x f~2 (    03 √ó 1  0  ~=  , d  , -1  ~ ¬Ød  Jn  

(4.71)

~) =  ~ /2 - 1 sig (q ~ v ) , g2  ( x ~ ) = -2 sig1 (q ~v ) g1  ( x 1 ~v ) - I )  ~, ~v ,  ~ ) = ( A(q f~1 (q 2
-1 ~ ,  ) = - Jn ~ √ó Jn  +  √ó Jn  ~ - ~ √ó Jn  ~ . f~2 ( 

Note that ~ ( x , t,  ¬Ød , R,  ~ , 0) = 0, h

91

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller ¬Ød , R,  ~ )  R6 √ó R √ó R3 √ó (R3 \ {0}) √ó R3 . It can be verified that g is hofor all ( x, t,  mogeneous of degree k =  - 1 with respect to the dilation e
r () T ,   ~ ) = [q ~v ~ T ]T . (x

For a spacecraft in a bounded orbit about a primary body, the following assumption can be made. Assumption 4.5. There exist 0 < Rm < R M such that R(t)  O for all t  0, where O = { R  R3 : Rm  R  R M . Proposition 18 (Chapter 3). Given 1 , 2 > 0 and ¬Ø  (1/2, 1) with  2, there exists 

¬Ø , 1): corresponding V : Rn  R satisfying the following properties for   ( 1. V is positive-definite and radially unbounded. 2. V is homogeneous of degree with respect to the dilation e
r ()

.

~ = 0. 3. V is infinitely differentiable on Rn \ {0} and continuously differentiable at x ~ )  -c()V 4. L g V ( x
( +k)/

~ ) for all x ~  R6 , with c() > 0. (x

¬Ø > 0, there exists an open set U ( ¬Ø ) containing the origin such that x   ¬Ø 5. Given  implies that ~)  - L g + f~V ( x ~  U ( ¬Ø ). for all x ¬Ø , it has been established that (4.72) holds on the open While for a given bound  ¬Ø ), it will be useful to find an open sublevel set of V , contained in U ( ¬Ø ), set U ( since this will then become an invariant set, and in the absence of uncertainty and disturbance, will be inside the domain of attraction of the observer. To this end, ¬Ø ) is open, let  > 0 be the radius of a closed ball contained inside U ( ¬Ø ). since U ( ¬Ø = minx ~ ) > 0. The set Let  ~  S5 V ( x ~  B (0) : V ( x ~) <  ¬Ø }, W = {x (4.73) c() ( V 2
+k)/

~ ), (x

(4.72)

is such a set. ~ and d ~ in (4.70) are handled. Similar to Proposition 17, we have Finally the terms h the following result.

92

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller ¬Ø ¬Ø,  ¬Ø > 0 and define the set Y = B Proposition 19. Fix  ¬Ødm (0) √ó ¬Ø (0) √ó [0, T ] √ó B ¬Ø O√óB ¬Ø (0). Then, for any  > 0 there exist ¬Ødm ,  ¬Ø,  ¬Ø, ) 3 ( ¬Ødm ,  ¬Ø,  ¬Ø, ) 3 (

> 0 such that  J



~ ( x , t,  ~ = h ¬Ød , R,  ¬Ød , R,  ~ ,  J ) <  for all ( x, t,  ~ )  Y. implies that 
r ()

~  S5 and  > 0 small enough that e Using Proposition 3, for any x

~)  (x

¬Ø  (0), one has from (4.71) and Proposition 18 that when  ¬Ø   in the definition of B the set W in (4.73),
r ()

e Lh ~ +d ~V ( 

~ )) = (x

V re () -1 ~ + Jn ¬Ød ), ~ ))( ( (x  ~   V -1 ~ + Jn ¬Ød ), ~ )( =  - (x  ~  V -1 ¬Ød ), ~ ) ( + Jn (x    - ~  ¬Ødm ,  ¬Ø,  ¬Ø ,  ). 3 (
-)/

(4.74)

¬Ø when ( x, t)  B ¬Ø (0) √ó R, provided  J <

Define

a = max
~  S5 x

V ( ~ ) , b = min V (x ~  ~  S5 x

~ ) > 0. (x

By definition of b, V leads to

( -)/

~ )/b  1 for all x ~  S5 . Using these bounds in (4.74) (x
-1  ¬Ødm ) a( + Jn  b
r ()

~ ))  Ld~V ( ( x

r ()

-

V

( -)/

~ ), (x

~  S5 with  > 0 small enough that e for all x ¬Ø B ¬Ø (0) √ó R and  J < ¬Ødm ,  ¬Ø,  ¬Ø ,  ). 3 (

¬Ø  (0), provided ( x, t)  ~)  B (x

Using the same arguments as surrounding

equation (4.54), one finds that
-1  ¬Ødm ) ( a( + Jn V b -)/

~)  Lh ~ +d ~V ( x

~ ), (x

(4.75)

¬Ø ¬Ø  (0), provided ( x, t)  B ~B for all x ¬Ø (0) √ó R and  J <

¬Ødm ,  ¬Ø,  ¬Ø ,  ). 3 (

¬Ø Finally, combining (4.72) and (4.75), one finds that when ( x, t)  B ¬Ø (0) √ó R and J < ¬Ødm ,  ¬Ø,  ¬Ø ,  ), 3 ( ~ (t) inside B (0) we have for trajectories x

  (x ~ (t)) = L g + f~V ( x ~ ) + Lh ~ (t)), V ~ +d ~V ( x

 -

c() ( V 2
( -)/

+  -1) /

= -V

~) (x

-1  ¬Ødm ) ( -)/ a( + Jn ~ ), V (x b -1  ¬Ødm ) c (  ) (2 -1) / a( + Jn ~) - V (x 2 b

~) + (x

. (4.76)

93

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller   < 0 when From this is is seen that V
-1  ¬Ødm ) 2a( + Jn c()b
/ (2 -1)

~) > V ( x

.

(4.77)

Consequently, to guarantee feasibility for (4.77), the following restriction is made
-1  ¬Ødm ) 2a( + Jn c()b
/ (2 -1)

¬Ø. <

(4.78)

¬Ødm > 0 and  > 0 are small enough. The following result This is clearly satisfied if  is obtained. ¬Ø ¬Ø], for some ¬Ø , 1). Suppose that x (t)  B Lemma 4.6. Choose   ( ¬Ø (0) for all t  [0, t ¬Ø  R+ t ¬Ø  (0)  U (  ¬Ø ) and obtain  ¬Ø = minx ~ ). {}. Select  > 0 such that B ~  S5 V ( x

¬Ødm > 0 is small enough that  > 0 can be selected such ¬Ø >  , suppose that  Selecting  that (4.78) is satisfied, and obtain corresponding nally, suppose  J ¬Ødm ,  ¬Ø,  ¬Ø, ) 3 ( from Proposition 18. Fi-

<

¬Ødm ,  ¬Ø,  ¬Ø ,  ). 3 (

~ (0)  W where W is defined in (4.73), then If x

¬Ø]. If this holds for any t ¬Ø  0, then ~ (t)) <  ¬Ø and x ~ (t) <  for all t  [0, t V ( x
-1  ¬Ødm ) 2a( + Jn c()b
/ (2 -1)

~ (t))  lim sup V ( x
t

~ (t)   <  , , and lim sup x
t

where
-1  ¬Ødm ) 2a( + Jn c()b
/ (2 -1)

~ , F=  = max x
~F x

~  B (0) : V ( x ~)  x

.

Proof. This can be obtained using similar arguments as in the proof of Lemma 4.4, ¬Ø] (see the definition of W in (4.73)), and ~ (t)  W  B (0) for all t  [0, t noting that x ¬Ø  (0) as t  . This concludes ¬Ø  0, x ~ (t)  F  B the fact that if this holds for any t the proof.

4.3

Main Result

The main result can now be presented. Theorem 4.7. Consider the system described by (4.1) and (4.2), together with the observerbased control law in (4.5), (4.13), (4.28), (4.29), (4.62), (4.65) and (4.66). Then, provided 94

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller the disturbance torque d and inertia uncertainty  J are small enough, the control and observer parameters can be chosen such that the closed-loop system states are locally ultimately bounded. Proof. Choose control law parameters k1 , k2 , k3 , k4 , k5 , k x , k u , as in the statement of Lemma 4.4. In addition, for small enough dm > 0, it is possible to choose parameters ¬Ø ,  , as in the statement of Lemma 4.4, and obtain related ,  also as in Lemma 4.4. ¬Ø , 1), and 1 , 2 > 0. Choose  > 0 as in Lemma 3, For the observer, choose   ( with the added restriction that   ¬Ø , dm ,  ) 2 ( ¬Ø > 0 as in Lemma 3. and obtain  ¬Ø , dm ,  ), 2 ( ¬Ø , dm ,  ) 1 (

¬Ødm > 0 is small enough that  > 0 can be selected such ¬Ø >  , suppose that  Selecting  that (4.78) is satisfied, and obtain corresponding ¬Ø , dm ,  ), Finally, suppose  J < min{ 1 ( ¬Ødm ,  ¬Ø,  ¬Ø, ) 3 ( from Proposition 18.

¬Ødm ,  ¬Ø,  ¬Ø ,  ) }. 3 (

Now, consider the set H = B (0) √ó B (0), and consider the initial conditions x (0)  ~ (0)  W (as in Lemma 3). It is clear that B(  ~ 1 / ~ 2 )1/4  (0) (as in Lemma 4.4), and x ~ (0))  H , and that therefore ( x (t), x ~ (t)) must remain in H over some interval ( x (0), x ¬Ø), with t ¬Ø > 0. By Lemmas 4.4 and 4.6, it can be inferred that x (t) cannot reach [0, t ~ (t) reaches the boundary of B (0), and vice-versa. the boundary of B (0) before x ~ (t)) to leave H is if x (t) and x ~ (t) both reach the So, the only possibility for ( x (t), x ¬Ø > 0 be that respective boundaries of B (0) and B (0) at the same time instant. Let t ¬Ø)) =  and x ¬Ø) ~ (t time instant. We then have ( x (t ~ (t))  H =  , while ( x (t), x

¬Ø ¬Ø. By definition of  ¬Ø]. ¬Ø , we therefore have x (t)  B for 0  t < t ¬Ø (0) for t  [0, t ¬Ø) <  , and subsequently by Lemma 4.4 that ~ (t By Lemma 3, it then follows that x ¬Ø)  B (0), which is a contradiction. Hence, we see that ( x (t), x ~ (t))  H for all x (t t  0. By Lemmas 4.4 and 4.6, it then follows that they are ultimately bounded. This concludes the proof.

4.4

Numerical Examples

This section presents numerical examples to demonstrate the performance of the proposed observer-based controller under realistic implementation conditions, including sampled measurements with measurement noise, sample and hold control implementation, uncertainties in the spacecraft inertia matrix, aerodynamic and 95

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller solar pressure disturbance torques and small orbital eccentricities. For comments on practical implementations, one can refer Section 3.5.

The spacecraft model is taken from Godard et al. [Godard, K. Kumar, and A. Zou, 2013]. The spacecraft is in a Keplerian orbit with semi-major axis a = 6878 km, and initial condition at perigee. The spacecraft nominal moments of inertia used in the control and observer design are Jx = 0.0020 kg¬∑m2 , Jy = 0.0017 kg¬∑m2 , and Jz = 0.0015 kg¬∑m2 . The aerodynamic and solar pressure torques are given by  1 + sin (0 t) + 0.5 sin (20 t)   2 a = 1.36 A f   - 5 √ó 10 [4 + 2 sin (0 t) + 0.5 sin (20 t)]  - [1 + 2 sin (0 t) + 0.5 sin (20 t)]    s = S f    2 √ó 10-5     ,   (4.79)

[1 - 2 sin (0 t)]   , 1 √ó 10-3 cos (0 t)   - 5 √ó 10-5 cos (0 t)

(4.80)

respectively, where A f = 1.0 √ó 10-11 and S f = 1.70 √ó 10-6 are derived from "worstcase scenarios" for the RyeSat spacecraft model as outlined in [Godard, K. Kumar, and A. Zou, 2013]. Table 4.1 shows the control and observer parameters.
TABLE 4.1: Summary of parameters Parameter a (k1 , k2 , k3 , k4 , k5 , k x , k y ) (, 1 , 2 ) [ Jnx , Jny , Jnz ] Nominal Disturbance-Free (0), bI (0) Nominal Disturbance (0), bI (0) [a , s ] Disturbances and Uncertainties diag{ J } ^ bI (0) qv , (0), bI (0),  Value 6878 km (0.04, 0.04, 0.04, 0.1, 5, 0.05, 0.05) (0.9, 0.04, 0.02) [0.0020, 0.0017, 0.0015] kg¬∑m2

[0.5245, 0.5915, 0.1585] T , 0 rad/s [0.5245, 0.5915, 0.1585] T , 0 rad/s time-varying ¬±5 % ¬±5 deg, ¬±180 deg, ¬±5 deg s-1 , ¬±1.4 deg s-1

96

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller In the numerical examples, attitude measurements are generated at sample times tk (k = 0, 1, ...) according to qvm (tk ) = q4 (tk )qve,k + q4e,k qv (tk ) + qv (tk )√ó qve,k , q4m (tk ) = q4 (tk )q4e,k - qv (tk )T qve,k , (4.81)

where qve,k is generated with MATLAB's "randn" random number generator, with standard deviation of 0.1 √ó 180/(6 ) in each component and q4e,k =
T q 1 - qve ,k ve,k .

Consequently, (qve,k , q4e,k ) is a unit quaternion representing a random rotational measurement error with 0.1 degree error (3-sigma). The sampled-data implementation of the proposed observer-based control law is

u (t) = Jn Hun ( xm (tk ), tk )),  (t) = ^ q 1 ^(t))C T (q ~m (t))  ^ (t) + 1 P-1 (q ~m (t))sig (q ~vm (t)) , B(q 2

 (t) = - ^ ^ (t)√ó J  ^ (t) + g,m (tk ) + u (t) + 2 J sig1 (q ~vm (t)), J then for t  [tk , tk+1 ), where
T

xm (tk ) =

T (t ) qvm k

^ z (tk )  ^ x (tk )  ^ y (tk ) 

.

~m = ( q ~vm , q ~4m ) is given by and q ~vm (t) = -q4m (tk )q ^v ( t ) + q ^4 (t)qvm (tk ) - q ^v (t)√ó qvm (tk ), q ~4 m ( t ) = q 4 m ( t k ) q ^4 (t) + qvm (tk )T q ^v ( t ). q The sample period in this chapter is chosen to be  T = tk+1 - tk = 0.1 seconds, measurement limitations outlined in Section 3.5 also applies here. Numerical integration is performed using a 4th order Runge-Kutta method with step size equal to  T . Smaller step sizes were also tested, but did not produce any noticeable change in results.

97

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller

4.4.1

Nominal disturbance-free case

The purpose of the example in this subsection is two-fold: (1) to demonstrate the performance of the observer-based control law under ideal conditions (perfect knowledge of the spacecraft inertia matrix, no external disturbances other than gravity-gradient); (2) to compare the performance of the ideal continuous-time (not sampled-data) observer-based control in the absence of measurement noise with the sampled-data observer-based control with noisy measurements. The spacecraft attitude relative to the orbiting frame is given by qv (0) = [0.5245, 0.5915, 0.1585], q4 (0) = 1 - qv (0)T qv (0), while the initial orbital angular velocity is given by

 (0) = 0 rad/s. Figure 4.1 shows the resulting attitude and angular velocity responses, respectively. It can be seen that the attitude and angular velocity responses are similar, with the sampled-data responses exhibiting some noise, which is due to the presence of noise on the measurements.The sampled-data approximates continuous-time control, attributing to the finite-time observer-based controller. Having established this, the examples presented in the remaining subsections are for the sampled-data controller only.

4.4.2

Nominal case with disturbances

The purpose the example in this subsection is to demonstrate the performance of the sampled-data observer-based control law under nominal conditions (perfect knowledge of the spacecraft inertia matrix, and gravity-gradient torque), but with the inclusion of the aerodynamic and solar pressure disturbance torques. The initial conditions are the same as in Section 4.4.1. Figure 4.2 shows the resulting attitude and angular velocity responses. Figure 3 shows the spacecraft control torques. Comparing Figure 4.2 to Figure 4.1, it can be seen that the while the attitude and angular velocity errors still converge to a neighborhood of the origin, the presence of the disturbance torques results in slightly larger steady-state attitude and angular velocity errors, which is to be expected since the disturbance torques act about all three spacecraft axes, while the control torque is limited to the roll and pitch axes.

98

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller

Continuous
1
q1 q2 q3 q4

Sampled-Data
1
q1 q2 q3 q4

0.5

0.5

q

0

q
0 0.2 0.4 0.6 0.8 1

0

-0.5

-0.5

-1

-1 0 0.2 0.4 0.6 0.8 1

0.05

0.05

(rad/s)

x y

(rad/s)

0

0
x y

-0.05

z

-0.05

z

-0.1 0 0.2 0.4 0.6 0.8 1

-0.1 0 0.2 0.4 0.6 0.8 1

Time (Orbits)

Time (Orbits)

F IGURE 4.1: Attitude and angular velocity responses in nominal disturbance-free case
Attitude Error
1 0.8 0.6 0.4
q1 q2 q3 q4

Angular Velocity Error
0.04
x y

0.02

z

0

(rad/s)
0 0.2 0.4 0.6 0.8 1

q

0.2 0 -0.2

-0.02

-0.04

-0.06 -0.4 -0.6 -0.8 -0.08

-0.1 0 0.2 0.4 0.6 0.8 1

Time (Orbits)

F IGURE 4.2: Attitude and angular velocity responses in nominal case with disturbances

4.4.3

All uncertainties and disturbances

The purpose of the example in this subsection is to demonstrate the robustness of the sampled-data observer-based control law to uncertainties in the spacecraft inertia matrix, in the presence of measurement noise for a variety of initial conditions with large initial attitude errors. To this end, one hundred simulations are performed, 99

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller

8 6 4 2 0

10-6

Control Torque
x y

(Nm)
u

-2 -4 -6 -8 -10 -12 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1

Time (Orbits)

F IGURE 4.3: Control torque in nominal case with disturbances

where the true spacecraft inertia matrix, initial conditions are randomly generated. Remark. While one hundred simulations with random variables are performed. The purpose of the simulations is only to showcase the observer-based control system and its robustness. The data should not be taken as a probability distribution statistics. The true spacecraft inertia matrix is generated as follows. First, the true principal inertia matrix is computed according to   Jx + p x  Jp =  0   0 0 Jy + py 0 0 0 Jz + pz   ,   

where p x , py , pz are generated using MATLAB's "randn" random number generator, each with standard deviation of 3 √ó 10-5 kg¬∑m2 . This corresponds to approximately 5% uncertainty (3-sigma) in the principal inertias. Then, the true spacecraft inertia matrix is obtained as Jt = C (q J ) J p C (q J )T , where q J = (qvJ , q4 J ), qvJ is generated with MATLAB's "randn" random number generator, with standard deviation of 5 √ó 180/(6 ) in each component and q4 J =
T q . Consequently, q is a unit quaternion representing a 5 degree 1 - qvJ vJ J

(3-sigma) random rotation of the principal axes frame. It should be noted that Jt is only used in the numerical propagation of the true attitude dynamics. The observer-based controller uses the nominal inertia matrix J . 100

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller

The initial true attitude is obtained as qv (0) = a sin(/2), q4 (0) = cos(/2), where a  S2 is generated using MATLAB's "randn" function followed by normalization, and   R is generated using MATLAB's "randn" function, with standard deviation of  /3, corresponding to an initial attitude error of 180 degrees (3-sigma). The initial true inertial angular velocity  (0) is generated using MATLAB's "randn" function, with standard deviation of 5 √ó  /(3 √ó 180) corresponding to an initial angular velocity of 5 degrees/second (3-sigma). The initial estimated inertial an^ (0) is generated using MATLAB's "randn" function, with standard gular velocity  deviation of 1.4 √ó  /(3 √ó 180) corresponding to an initial estimated angular velocity of 1.4 degrees/second (3-sigma). Finally, the initial estimated attitude quaternion ^(0) is taken as the initial attitude quaternion measurement qm (0) as generated in q (4.81). For clarity in presenting the results of all 100 simulations, the attitude error is presented as the principal angle of rotation corresponding to , which is given by  = 2 sin-1 ( qv ).

The angular velocity error is presented as  . Figure 4.4 shows the resulting attitude and angular velocity responses. It can be seen that in all cases, they converge to neighborhoods of zero, even with very large initial attitude errors. These results demonstrate that even though the theoretical guarantee of ultimate boundedness for the proposed observer-based controller is local and the control is continuous and measurements are available without measurement noise, when implemented under realistic conditions in a sampled-data manner the control law retains the ultimate boundedness property even for large initial conditions.

4.5

Chapter Summary

This chapter investigated the velocity-free attitude control problem for the inertial attitude stabilization of underactuated rigid spacecraft in circular orbits using two

101

CHAPTER 4. Inertial Attitude Stabilization using a Generalized Time-Varying Nonlinear Controller

180 160

Attitude Error

25

Angular Velocity Error

Angular Velocity Error (deg/s)
0 0.2 0.4 0.6 0.8 1

140

20

Attitude Error (deg)

120 100 80 60 40 20 0

15

10

5

0 0 0.2 0.4 0.6 0.8 1

Time (Orbits)

Time (Orbits)

F IGURE 4.4: Attitude and angular velocity responses with inertia matrix uncertainties and disturbances

torques. Utilizing the homogeneity of systems, a velocity-free time-varying continuous feedback controller is formulated. A proposed observer-based control law combining a sliding mode control law with a observer is used to estimate the spacecraft angular velocity. A rigorous analysis has been presented to demonstrate that proposed observer-based control laws, both the reduced nominal closed-loop system and full nominal closed-loop system, are locally ultimately bounded. Numerical examples have been presented of a sampled-data implementation of the proposed observer-based control law that demonstrate robustness to uncertainties in the spacecraft inertia matrix, non-zero orbital eccentricity and measurement noise, as well as convergence for large initial attitude errors.

102

CHAPTER 5

Model Predictive Control of Underactuated Spacecraft
The space system of study is a small satellite equipped with two reaction wheels that provide two control torques. This chapter proposes the MPC-based strategy to stabilize the spacecraft's attitude with a pair of reaction wheels under the assumption of zero total system angular momentum. The attitude stabilization of a spacecraft using two torques supplied by reaction wheels aligned about the principal axes of the spacecraft is investigated in this chapter. Unlike other methods, MPC allows for the direct incorporation of practically important constraints such as spacecraft pointing, angular velocity, and wheel rate constraints. Unlike the majority of MPC applications to attitude control in the literature, which use an approximate discretized dynamics model, the exact continuous dynamics model is utilized in the MPC formulation. Numerical examples demonstrate the efficacy of the proposed approach.

5.1

Introduction

The stabilization of an underactuated spacecraft is complex, as such system does not have a controllable linearization, and is not feedback linearizable. This becomes further problematic when stabilizing using internal torque actuators. This chapter extends the inertial attitude control problem of Chapter 4. It deals with finding control actions using optimal control theory and model predictive control to effectively stabilize the underactuated rigid-body spacecraft system.

103

CHAPTER 5. Model Predictive Control of Underactuated Spacecraft Stabilization using internal torque actuators such as momentum-exchanging devices like reaction wheels (RWs) or control moment gyroscopes (CMGs) can achieve better precision than external actuators such as rockets or thrusters [Petersen, Leve, and Kolmanovsky, 2017b]. The comparative study between actuators is not outlined in this chapter. There are several drawbacks in using internal torque actuators, namely the total angular momentum in the spacecraft system must be conserved. The complete dynamics of the spacecraft with two reaction wheels is not controllable [Krishnan, McClamroch, and Reyhanoglu, 1995]. With the assumption of zero total angular momentum, the spacecraft dynamics is locally controllable at any equilibrium attitude in finite time but cannot be asymptotically stabilized to any equilibrium attitude using time-invariant continuous feedback. However, by using model predictive control (MPC), we can generate control laws that can be used to stabilize the attitude for an underactuated spacecraft. The study of model predictive control (MPC) has gained much attention in the recent years due to its ability to generate feedback controllers with enforced constraints on dynamical continuous-time systems. MPC has a rich history [Mayne, 2014b; Qin and Badgwell, 2003] in academic literature and in the process industries, where proven to be more effective in comparison other multivariable control alternatives. MPC optimizes a control sequence while minimizing a specified cost function over a finite horizon. Analysis of its stability and optimality can be found in Mayne [Mayne, 2014a]. Application of MPC in underactuated systems by design or by result of on-board failures is not well-addressed. When there are fewer number of available torques than degrees-of-freedom, the spacecraft degrades to to an underactuated nonholonomic system that results in highly nonlinear equations of motion, which can result in uncontrollability of the equations (kinematics and dynamics) of the spacecraft[Crouch, 1984]. See Fontes [Fontes, 2001] for construction of a stabilizing nonlinear MPC for time-varying nonlinear system with input constraint. Furthermore, the system equations are not feedback linearizable which when linearized, possesses an uncontrollability linearization.MPC had been widely used in literature to solve attitude problems. Petersen et al. [Petersen, Leve, and Kolmanovsky, 2017a] proposed the use MPC to control a spacecraft with two reaction wheels. Utilizing zero momentum strategy and approximate model of the system dynamics, a 104

CHAPTER 5. Model Predictive Control of Underactuated Spacecraft state-discontinuous feedback locally stabilizing control law for pointing equilibrium was generated via MPC while satisfying constraints. It was proven that the attitude equations can be reduced in the case where angular momentum is zero [Krishnan, McClamroch, and Reyhanoglu, 1995]. This implied the possibility of rest-to-rest maneuvers as the reduced equations are small-time locally controllable (STLC). Gui et al. [Gui, Vukovich, and S. Xu, 2015] investigated the equilibrium STLC of combined dynamics of spacecraft with three or more independent-type CMGs in pyramid and roof-type configurations. Assuming constant inertial angular momentum and no external torques the spacecraft was stabilized via time-invariant piecewise continuous feedback laws with controllability proofs while imposing singular avoidance constraints.

5.2
5.2.1

Problem Formulation
Attitude kinematics and dynamics

F IGURE 5.1: Two-RW system topology.

Consider a spacecraft with equipped with two reaction wheels (RW) with coordinate topology shown in Figure 5.1. The frame of the ith reaction wheel is represented by the orthogonal set Fwi = {ri1 , ri2 , ri3 }, for i = 1, 2, where ri1 and ri3 are set to aligned with the rigid-body spacecraft body frame and ri2 = ri3 √ó ri1 , to complete the righthanded triad. More specifically, we align the reaction wheel's spin axis (ri3 ) with one 105

CHAPTER 5. Model Predictive Control of Underactuated Spacecraft of the spacecraft's principal axis with reaction wheel angular velocity, i  R for i = 1, 2. Without the loss of generality, assume that the reaction wheels are aligned in the body principal axes, yb and zb , making the spacecraft xb -axis an unactuated axis. Thus, classifying this system as underactuated. Let the angular momentum of the reaction wheels be denoted by h and given by the equation:

hi = Jw i , i = 1, 2

(5.1)

The total angular momentum contribution of the reaction wheel array, h, with inertia Jw can be expressed as h = Aw  hi = Jw 1 r13 + Jw 2 r23 .
i =1 n

(5.2)

The total angular momentum of the spacecraft-RW system with respect to F I , written in Fb is written as H = J  + A w h, where (5.3)

 0 0      Aw =   1 0 ,   0 1



(5.4)

is RW configuration matrix, J  R3√ó3 is the spacecraft inertia matrix.

When no external torque ( H = 0) act on the spacecraft (this assumption is realistic after detumbling has occured), H will remain a constant, and  can be solved directly from (5.3) and the zero-momentum restriction imposes the following:  = - J -1 A w h .

(5.5)

Remark. If the spacecraft's angular momentum is initially non-zero ( H = 0), then due to the conservation of angular momentum, regardless of its new attitude vector, the angular momentum will remain non-zero and the spacecraft cannot be stabilized with respect to the origin without some form of external torque.

106

CHAPTER 5. Model Predictive Control of Underactuated Spacecraft Assuming the angular momentum contribution of the reaction wheel in (5.3) is negligible [Kurokawa, 2007; S. Bhat and Tiwari, 2009], then the equations of motion that describes the dynamics of the system that evolves in the angular momentum level set diffeomorphic to R3 √ó Tn is given by:  = - S ( p ) J -1 A w h , p  = u, h

(5.6) (5.7)

where S( p) = 1 (1 - pT p) I + 2 ppT + 2 p√ó , 4

p = [ p1 , p2 , p3 ] T  R3 denotes the Modified Rodrigues Parameters (MRPs) which describes the spacecraft orientation. h = [h1 , h2 , . . . , hn ] T  Rn represents the angular momentum vector and u = [u1 , u2 , . . . , un ] T  Rn is the control input vector with |ui |  umax for i = 1, 2, . . . , n. The rotation matrix corresponding to the MRPs, p is given by C ( p) = I + 8 p √ó p √ó - 4(1 - p T p ) p √ó , (1 + p T p )2 (5.8)

Let the state vector of (5.6) and be denoted by x = ( p, h)  M with configuration manifold M = R3 √ó Rn . Then, the dynamics represented by (5.6) can be written in control system form as:  = f 0 ( x ) +  u i f i ( x ), x
i =1 n

x  M,

ui  umax

(5.9)

where the terms f 0 ( x ) = -S( p) J -1 ( Aw h) , 0 and f i ( x ) = (0, ei ) are called the drift vector field and control vector fields, respectively. Here, ei denotes the ith standard basis vector in Rn .

5.2.2

Optimal control

Recall in Chapter 2, that the optimal control problem is is the minimization problem for J (q(t), u(t), t0 , t f ) with control constraints and fixed boundary conditions under the assumption that the solution to the minimization exists in the Sobolev space denoted by W mx , √ó W mu , for m x  1 and mu  0. Given all admissible control

107

CHAPTER 5. Model Predictive Control of Underactuated Spacecraft u = u(t) in t  t0 , t f , find the corresponding solution x  (t) of the problem that minimizes the cost functional J ( x (t), u(t), t) and satisfying the boundary condition:
tf t0

min. such that

J ( x ( t ), u ( t ), t0 , t f ) =  x f , t f +

L [ x (t), u(t), t] dt

(5.10)

 = - S ( p ) J -1 A w h , p  = u, h x ( t0 ) = x0 , x (t f ) = x f , h ( x )  g ( x ), umin  u(t)  umax , where the term h( x )  g( x ) describes the path constraints of the problem described by (5.10). The optimal control problem is the minimization problem for (5.10) with control constraints and fixed boundary conditions. The next step is to discretize the dynamics described by (5.9). In this chapter, the optimization problem was discretized using pseudospectral discretization method, which is described next.

5.2.3

Pseudospectral discretization

In this chapter we use pseudospectral optimal control theory (Legendre pseudospectral method) to solve the underactuated spacecraft attitude stabilization. Pseudospectral optimal control theory is a spectral-based algorithm for solving nonlinear optimization control problems. The optimal trajectory is computed using transformation of the physical domain to the computational domain, interpolate using Lagrange polynomial interpolation, weighted differentiation, and weighted integration [I. Ross and Karpenko, 2012]. Much of foundation of pseudospectral optimal control theory, a theoretical-computational framework for solving an optimal problem, is the direct consequence of the Stone-Weierstrass approximation theorem. The Weierstrass approximation theorem states that a continuous real-valued function on

108

CHAPTER 5. Model Predictive Control of Underactuated Spacecraft a compact interval can be uniformly approximated by a set of polynomial sequence. The theorem is stated as follows: Theorem 5.1 (Stone-Weierstrass (I. Ross and Karpenko, 2012)). Let R  [t0 , t f ]  x (t)  R be a continuous function. Then, there exists a set of algebraic polynomial sequence W = t  xN
 N =0

such that, x (t) - x N (t) = 0.

N   t  [ t ,t ] 0 f

lim

sup

Since, the optimal state trajectory, x  (t), is assumed to exist in the Sobolev space (Wmx , √ó Wmu , ) - the optimal solution space, it then follows that there exist a polynomial sequence W that converges to x  (t) in the function space, L . The feasibility of the generated optimal control can be confirmed by numerical integration of the continuous dynamics of the underactuated spacecraft system using 4th order Runge-Kutta routine.

Time-domain transformation For a finite-horizon optimal control problem, the physical time domain t  [t0 , t f ] is mapped by affine transformation into computational domain of   [-1, 1] using the following, t = ( ) = t f + t0 2 t f - t0 2  =  -1 ( t ) = 2 t f - t0 t f + t0 t f - t0 (5.11)

+





t-

with derivative d = dt t f - t0 2 (5.12)

Equations (5.11) and (5.12) are used to the computation of the Legendre-GaussLobatto (LGL) quadrature node points spacing as seen in Figure 5.2.

Lagrange polynomial interpolation Let the set of N LGL node points, ti  R, on the interval [-1, 1] be denoted by  = {t : i = 0, ¬∑ ¬∑ ¬∑ , N }  R N . Then, the corresponding Lagrange interpolant can be

109

CHAPTER 5. Model Predictive Control of Underactuated Spacecraft

F IGURE 5.2: time domain transformation into computational domain with distinct node points and the corresponding Lagrange interpolation polynomial.

written as x N (t) =
i =0

 i (t)xi

N

-1  t  1

(5.13)

where i (t) is the N -th order Lagrange interpolating polynomial is given by

i (t) =

j=0, j =i



N

t - tj , ti - t j

(5.14)

the numerator of (5.14) is zero except when j = i at each LGL node point, ti . When j = i, Equation (5.14) satisfies the Kronecker relationship i (tk ) = ik , where    1, j = i jk (tk ) =   0, j = i. Remark. Using Equation (5.13), the optimal control polynomial can be interpolated and is given by u N (t) =
i =0 N

 i (t)ui

- 1  t  1.

(5.15)

Differentiation and integration The derivative at node points of the N -th order Lagrange interpolating polynomial is given by dx N (t) dt
N

=
t = ti

i =0

 Dji xi

(5.16)

110

CHAPTER 5. Model Predictive Control of Underactuated Spacecraft where D ji is the differentiation matrix given by di (t) dt

D ji =

.
t = ti

(5.17)

Similarly, the integration at node points of the N -th order Lagrange interpolating polynomial is given by
1

-1

x N (t)dt =

i =0 -1



N

1

i (t)dtxi .

(5.18)

5.2.4

Model predictive control

Let the generic cost function be:
tk + T tk

J ( x ( t k ), u k ( ¬∑ ), t0 , t f ) =

( x, u)d ,

(5.19)

where x (tk ) = ( pk , k ), tk is the sample instants, uk (¬∑) is the control over the interval

[tk , tk + T ] and ( x, u) is a positive semi-definite function of x and u satisfying ( x, u)   x 2 ,  > 0,  x, u, and (0, 0) = 0.

Now, consider the following system:

 = f ( x , u ), x

f (0, 0) = 0.

(5.20)

We assume that (5.20) has a unique solution x (t)  X (t)  Rn for a given x (t0 ), u(¬∑)  U (t)  Rm , (0, 0)  X (t) √ó U (t). Moreover, for a given x (tk ), uk (t), t  [tk , tk + T ], let xk (t) be the resulting solution over the interval t = [tk , tk + T ]. Then, the end-point constraint, xk (tk + T ) = 0, is required. General MPC algorithm

Given x (t) at time tk Compute uk (t) for interval t  [tk , tk + T ] Set u(t) = uk (t) over interval [tk , tk+1 ) Repeat process at time tk+1 with x (tk+1 ) = xk (tk+1 )

111

CHAPTER 5. Model Predictive Control of Underactuated Spacecraft

where we have x (t) = xk (t) and u(t) = uk (t) for all t  [tk , tk+1 ).

The next step is to compute the control uk (t) for the interval [tk , tk + T ]. Suppose that at time tk-1 , for a given feasible x (tk-1 ) we have a feasible uk-1 (t), ie. xk-1 (t)  X (t), uk-1 (t)  U (t), and xk-1 (tk + T ) = 0 for all t  [tk-1 , tk-1 + T ]. Define a candidate control:    u k -1 ( t ), t  [ t k , t k + T -  t ) ¬Ø k (t) = u .   0, t  [tk , tk + T - t)

(5.21)

5.2.5

Stability analysis

¬Ø k  uk-1 on the interval [tk , tk + T - t) and Since the solutions are unique and u tk + T - t = tk-1 + T , we have    x k -1 ( t ), t  [ t k , t k + T -  t ) ¬Ø k (t) = x .   0, t  [tk , tk + T - t)

(5.22)

where ( x (t), u(t)) = (0, 0) is feasible, since (0, 0)  X (t) √ó U (t). Then, we have the following result:
tk t k -1 t k -1 + T -  t tk tk + T tk + T -t

J ( x (tk-1 ), uk-1 (¬∑)) =

( x (t), u(t))dt +

¬Øk , u ¬Ø k )dt + (x

0 dt (5.23)

¬Øk) = Next, define Jk-1 = J ( x (tk-1 ), u(tk-1 )), and J ( x (tk ), u
tk + T tk + T -t

t k -1 + T -  t tk

¬Øk , u ¬Ø k )dt + (x

0 dt, then we have Jk-1 =

tk t k -1

¬Ø k ). Choose uk (¬∑) to sat( x, u)dt + J ( x (tk ), u

¬Ø (tk )), ie. improve on uk regardless of optimality. isfy Jk = J ( x (tk ), u(¬∑))  J ( x (tk ), u Then, we have
tk t k -1 tk t k -1

Jk - Jk-1  -

( x, u)dt  -

x 2 dt,

(5.24)

or Jk-1 - Jk  
tk t k -1

x 2 dt.

(5.25)

112

CHAPTER 5. Model Predictive Control of Underactuated Spacecraft Summing from k = 1 to m, we have

k =1

 ( Jk-1 - Jk )   

m

m

tk

k = 1 t k -1

x 2 dt

J0  J0 - Jm   The second line of (5.26) holds for all m  0.

k = 1 t k -1



m

tk

(5.26) x dt.
2

Now, for a given t  0, there exist m  0 such that t  tm . Then we have,
t

h

t0

x 2 dt  h

tm t0

x 2 dt  J0 .

(5.27)

Thus, it holds for all t  0. Hence, x (t)  L2 . If X (t), U (t) is required to be contained in compact sets, and that f (¬∑, ¬∑) be con = f ( x, u) is bounded, meaning x (t) is uniformly tinuous in its arguments, then x continuous. By Barbalat's Lemma, lim x (t) = 0.
t

Remark. Since x (t) = xk (t), u(t) = uk (t) for all t  [tk , tk+1 ) and xk , uk are feasible by design, then ( x (t), u(t))  X (t) √ó U (t), for all t  0. The feasibility of this method  (t0 ), a feasible u0 (t), t  [t0 , t0 + T ) needs to depends the given initial condition x be found. If it exists, then by previous analysis, each subsequent problem remains feasible.

5.3

Numerical Simulations

This section presents a numerical simulation to demonstrate the performance of the proposed MPC and the numerical problem proposed in this section is solved using DIDO c , a MATLAB c toolbox for solving optimal control problems [I. Ross, 2015]. The DIDO c program implements a fast spectral algorithm based on pseudospectral optimal control theory [I. Ross and Karpenko, 2012; Gong, Fahroo, and I. Ross, 2008], where all functions are expanded to an infinite series of special basis function and truncated to a convergence tolerance. DIDO c have been successfully used in several practical examples, which attained reputable results [Fahroo and I. M. Ross, 2013; Hurni, Sekhavat, and I. Ross, 2010; Karpenko et al., 2012; Bedrossian et al., 2009]. The spacecraft parameters are taken from [Godard, K. Kumar, and A. Zou, 2013]. 113

CHAPTER 5. Model Predictive Control of Underactuated Spacecraft The spacecraft is in a Keplerian orbit with semi-major axis a = 6878 km, and given initial conditions at perigee. The spacecraft nominal moments of inertia in the control and observer design are Jx = 0.0020 kg¬∑m2 , Jy = 0.0017 kg¬∑m2 , and Jz = 0.0015 kg¬∑m2 . The initial attitude is p0 = [0.3168, 0.3168, 0.0957] T with a zero-momentum restriction, in which assumes detumbling has occurred. The optimization program and MPC parameters are outlined in Table 5.1. The time horizon is chosen to be 1 orbit, to match the simulation window using one hundred optimal control node points for better interpolation performance. The MPC control window is generally chosen as a one-tenth of the orbital period. The dynamics of the spacecraft is integrated using 4th order Runge-Kutta with standard step size of 0.1 second. Due to
TABLE 5.1: MPC Parameters

Parameter Time Horizon Number of Nodes MPC Control Window Cost Function gains

Parameter T (orbit) N  T (orbit) [ a, b, c ]

Value 1.0 100 T /10 (102 )[1, 1, 0.1]

computational limitations, only a single orbit simulation is performed and optimal candidate control signals generated for ten control windows can be seen in Figure 5.3 (ti , for i = 0, ¬∑ ¬∑ ¬∑ , 9) with 0.1 orbit spacing. The control signals are then interpolated and used as control input to the underactuated spacecraft plant. It can be seen from Figure 5.4, that a new control trajectory is sequentially generated, for example, at t = 0.1 and t = 0.2 orbits, respectively. From Figures 5.4, 5.6, and 5.7, the applied torque is 5.672 √ó (10)-6 Nm. As seen in Figure 5.5, by t = 0.9 orbit the optimal

control solver has generated ten interpolated control signals for the MPC. The MRP and momentum response of continuous plant are given by Figures 5.8 and 5.9, respectively, where the underactuated rigid-body spacecraft system is stabilized from a rest-to-rest maneuver within t = 0.3 orbit with steady-state bound of ¬±2 √ó (10)-3 in the MRP vector.

114

CHAPTER 5. Model Predictive Control of Underactuated Spacecraft

F IGURE 5.3: Optimal MPC Control Interpolation.

F IGURE 5.4: Optimal MPC Control Interpolation: 0  t  0.3 orbits.

5.4

Chapter Summary

In this Chapter, the optimal control of an underactuated spacecraft with two reaction wheels using model predictive control was examined. The continuous dynamics model was used to generate an optimal control sequence using pseudospectral optimal control theory and interpolated using Lagrange polynomial interpolation. The effectiveness of the MPC was numerically simulated for small underactuated spacecraft where rest-to-rest stabilization was achieved in 0.3 orbit with a maximum

115

CHAPTER 5. Model Predictive Control of Underactuated Spacecraft

F IGURE 5.5: Optimal MPC Control Interpolation: 0.7  t  1.0 orbits.

F IGURE 5.6: MPC continuous dynamics control signals.

control torque of no greater than (10)-5 Nm.

116

CHAPTER 5. Model Predictive Control of Underactuated Spacecraft

F IGURE 5.7: MPC continuous dynamics control signals at 0  t  0.3 orbit.

F IGURE 5.8: MRP response.

117

CHAPTER 5. Model Predictive Control of Underactuated Spacecraft

F IGURE 5.9: Angular momentum response.

118

CHAPTER 6

Concluding Remarks
6.1 Contributions

This section outlines the key contributions of this research. These contributions arise from the problem statements, proven in the chapters and summarized the key findings as follows. 1 A novel nonlinear observer-based attitude control law that achieves attitude convergence without any angular velocity measurements for a nadir-pointing underactuated rigid-body spacecraft system in the presence of time-varying disturbances, non-zero orbital eccentricity, inertia matrix uncertainties, measurement noise in a sample-data implementation. The novel control law also guarantees ultimate boundedness of all signals even with high initial errors. 2 A generalized novel time-varying attitude control law that achieves convergence in inertial attitude for the underactuated rigid-body spacecraft system. The novel control law allows design flexibility that can lead to better performance. 3 An implementation of an optimal model predictive control to an underactuated spacecraft using pseudospectral optimal control theory with continuous dynamics model to achieve stabilization for a underactuated rigid-body spacecraft system with two reaction wheels.

119

CHAPTER 6. Concluding Remarks

6.2

Conclusions

The objective of this dissertation was to investigate the nonlinear control of the attitude for an underactuated spacecraft system in accordance to the problem statements and research objectives outlined in Chapter 1. In summary, control design development and rigorous stability proofs were presented in Chapter 3 for the bodyorbital frame attitude control problem, then extended to the inertial frame in Chapter 4. Thereafter, Chapter 5 presented a method of generating optimal control signals to stabilize the underactuated control system described in the previous chapters. The velocity-free attitude control problem for a nominally nadir-pointing and inertial-pointing underactuated rigid-body spacecraft in circular orbits with actuation about only two axes were examined in 3 and 4, respectively. An observerbased control law was proposed by combining a sliding mode control law (Chapter 3) with an finite-time nnonlinear observer to estimate the spacecraft angular velocity. Where in Chapter 4, the homogeneity of systems was utilized to develop a generalized velocity-free time-varying state feedback controller that achieved globally exponentially stable with respect to the homogenous norm. A rigorous analysis was presented demonstrating that with the proposed observer-based control laws, the closed-loop system was locally ultimately bounded. Numerical examples were presented of a sampled-data implementation of the proposed observer-based control law that demonstrate robustness to uncertainties in the spacecraft inertia matrix, non-zero orbital eccentricity and measurement noise, as well as convergence for large initial attitude errors. Lastly, in Chapter 5, the Legendre pseudospectral method was used discretized the spacecraft dynamics into Legendre-Gauss-Lobatto node points, and Lagrange polynomial interpolation was applied to obtain a candidate optimal control sequence. Model predictive control was used to implement the optimal control in predefined control windows sequentially to achieve stability for rest-to-rest maneuver.

120

CHAPTER 6. Concluding Remarks

6.3

Future Work

The problem of controlling the attitude of an underactuated rigid spacecraft is still pose many realistic challenges. In recent years, there have been several major advancements in the MPC theory and particularly in applications. However MPC is limited to the computation power and the accuracy of the interpolating polynomial. Increasing the number of nodes in the optimal control generation would yield better results, but at the expense of computation cost and time, which can impose practical limitations where MPC can be applied. In Chapter 5, although reaction wheels are used for torque generation, other internal torque actuators can be used, namely, in CMGs. Singularities in CMG is a problem in many applications, by using pseudospectral optimal control theory, singularities can be added as path constraints. Thus eliminating problems due to singularities.

121

BIBLIOGRAPHY
Agrachev, A.A. and Y. Sachkov (2004). Control theory from the geometric viewpoint. 1st ed. Vol. 87. Encyclopedia of Mathematical Sciences. Springer-Verlag. ISBN: 354402100199. Aguilar-Ibanez, C., J. Mendoza-Mendoza, and J. Davila (2014). "Stabilization of the cart pole system: by sliding mode control". In: Nonlinear Dynamics, pp. 1¬≠9. Bedrossian, N. et al. (2009). "Zero Propellant Maneuver Guidance". In: IEEE Control Systems Magazine 29.5, pp. 53¬≠73. Behal, A. et al. (2002). "Nonlinear tracking control of an underactuated spacecraft". In: Journal of Guidance, Control, and Dynamics 25.5, pp. 979¬≠985. Bhat, S. and P. Tiwari (2009). "Controllability of spacecraft attitude using control moment gyroscopes". In: IEEE Transactions on Automatic Control 54.3, pp. 585¬≠ 590. Bhat, S.P. and D.S. Bernstein (2005). "Geometric homogeneity with application to finite-time stability". In: Mathematics of Control, Signals, and Systems 17.2, pp. 101¬≠ 127. Byrnes, C. and A. Isidori (1991). "On the attitude stabilization of rigid spacecraft". In: IEEE Transactions on Automatic Control 27.1, pp. 87¬≠95. Carmo, M. do (1976). Differential geometry of curves and surfaces. 1st ed. Prentice-Hall, Inc. ISBN: 0132125897. Casagrande, D., A. Astolfi, and T. Parisini (2008). "Global asymptotic stabilization of the attitude and the angular rates of an underactuated non-symmetric rigid body". In: Automatica 44.7, pp. 1781¬≠1789. Chunodkar, A. and M. Akella (2014). "Switching Angular Velocity Observer for Rigid-Body Attitude Stabilization and Tracking Control". In: Journal of Guidance, Control, and Dynamics.

122

BIBLIOGRAPHY Coverstone-Carroll, V. (1996). "Detumbling and reorienting underactuated rigid spacecraft". In: Journal of Guidance, Control, and Dynamics 19.3, pp. 708¬≠710. Crouch, P. (1984). "Spacecraft attitude control and stabilization: applications of geometric control theory to rigid body models". In: IEEE Transactions on Automatic Control 29.4, pp. 321¬≠331. Du, H. and S. Li (2012). "Semi-global finite-time attitude stabilization by output feedback for a rigid spacecraft". In: Proc. IMechE Part G: Journal of Aerospace Engineering. Vol. 227. 12. IMechE, pp. 1881¬≠1891. Du, H., S. Li, and C. Qian (2011). "Finite-time attitude tracking control of spacecraft with application to attitude synchronization". In: IEEE Transactions on Automatic Control 56.11, pp. 2711¬≠2717. Fahroo, F. and I. M. Ross (2013). "Enhancing the Practical Agility of UAVs via Pseudospectral Optimal Control". In: Recent Advances in Research on Unmanned Systems 444, pp. 1¬≠30. Fontes, F. (2001). "A general framework to design stabilizing nonlinear model predictive controllers". In: Systems & Control Letters 42.2, pp. 127¬≠143. Gao, B. et al. (2013). "Stabilizing control of an underactuated 2-dimensional TORA with only rotor angle measurement". In: Asian Journal of Control 15.3, pp. 1¬≠12. Godard, G. (2010). "Fault Tolerant Control of Spacecraft". PhD Thesis. Ryerson University. Godard, G. and K. Kumar (2010). "Fault tolerant reconfigurable satellite formation using adaptive variable structure techniques". In: Journal of Guidance, Control and Dynamics 33.3, pp. 969¬≠984. Godard, G. and K.D. Kumar (2011). "Robust attitude stabilization of spacecraft subject to actuator failures". In: Acta Astronautica 68, pp. 1242¬≠1259. Godard, K. Kumar, and A. Zou (2013). "A novel single thruster control strategy for spacecraft attitude stabilization". In: Acta Astronautica 86.7, pp. 55¬≠67. Gong, Q., F. Fahroo, and I.M. Ross (2008). "Spectral Algorithm for Pseudospectral Methods in Optimal Control". In: Journal of Guidance, Control, and Dynamics 31.3, pp. 460¬≠471. Gui, H., L. Jin, and S. Xu (2015). "Small-time local controllability of spacecraft attitude using control moment gyros". In: Automatica 53.1, pp. 141¬≠148. 123

BIBLIOGRAPHY Gui, H. and G. Vukovich (2016). "Global finite-time attitude tracking via quaternion feedback". In: Systems and Control Letters 97, pp. 176¬≠183. -- (2017). "Finite-time angular velocity observers for rigid-body attitude tracking with bounded inputs". In: International Journal of Robust and Nonlinear Control 27, pp. 15¬≠38. Gui, H., G. Vukovich, and S. Xu (2015). "Attitude tracking of a rigid spacecraft using two internal torques". In: IEEE Transactions on Aerospace and Electronic Systems 51.4, pp. 2900¬≠2913. -- (2016). "Attitude stabilization of a spacecraft with two parallel control moment gyros". In: Journal of Guidance, Control, and Dynamics 39.3, pp. 724¬≠731. Horri, N.M. and S. Hodgarts (2003). "Attitude stabilization of an Underactuated satellite using two wheels". In: Proceedings of the 2003 IEEE Aerospace Conference. Vol. 6, pp. 2629¬≠2635. Huang, J. et al. (2013). "Generalised inversion based attitude control for underactuated spacecraft". In: Acta Automatica Sinica 39.3, pp. 285¬≠292. Hughes, P. (1986). Spacecraft attitude dynamics. Dover Publications, Inc. Chap. 1-4, 8,9. Hurewicz, W. (1952). Chapter 2: Lectures on Ordinary Differential Equations. Cambridge, Massachusetts. Hurni, M.A., P. Sekhavat, and I.M. Ross (2010). "An Info-Centric Trajectory Planner for Unmanned Ground Vehicles". In: Dynamics of Information Systems: Theory and Applications, pp. 213¬≠232. Karpenko, M. et al. (2012). "First Flight Results on Time-Optimal Spacecraft Slews". In: Journal of Guidance, Control and Dynamics 35.2, pp. 367¬≠376. Khalil, H.K. (1998). Nonlinear Systems. 3rd Edition. Upper Saddle River, New Jersey: Prentice Hall, pp. 102¬≠103. Khosravian, A. and M. Namvar (2010). "Globally Exponential Estimation of Satellite Attitude using a Single Vector Measurement and Gyro". In: pp. 364¬≠369. -- (2012). "Rigid Body Attitude Control Using a Single Vector Measurement and Gyro". In: IEEE Transactions on Automatic Control 57.5, pp. 1273¬≠1279. Krishnan, H., N.H. McClamroch, and M. Reyhanoglu (1995). "Attitude Stabilization of a Rigid Spacecraft Using Two Momentum Wheel Actuators". In: Journal of Guidance, Control and Dynamics 18.2, pp. 256¬≠263. 124

BIBLIOGRAPHY Kurokawa, H. (2007). "Survey of theory and steering laws of single gimbal control moment gyros". In: Journal of Guidance, Control, and Dynamics 30.5, pp. 1331¬≠1340. Li, H., W. Yan, and Y. Shi (2017). "Continuous-time model predictive control of under-actuated spacecraft with bounded control torques". In: Automatica 75, pp. 144¬≠153. Lizarralde, F. and J. Wen (1996). "Attitude Control Without Angular Velocity Measurement: A Passivity Approach". In: IEEE Trans. on Automatic Control 41.3, pp. 468¬≠472. Mayne, D.Q. (2014a). "Constrained model predictive control: Stability and optimality". In: Automatica 36.6, pp. 789¬≠814. -- (2014b). "Model predictive control: Recent developments and future promise". In: Automatica 50.12, pp. 2967¬≠2986. Morin, P. and C. Samson (1997). "Time-Varying Exponential Stabilization of a Rigid Spacecraft with Two Control Torques". In: IEEE Transactions on Automatic Control 42.4, pp. 528¬≠534. -- (2009). "Control of nonholonomic mobile robots based on the transverse function approach". In: IEEE Transactions on Robotics 25.5, pp. 1058¬≠1073. Narikiyo, T., J. Sahashi, and K. Misao (2008). "Control of a class of underactuated mechanical system". In: Nonlinear Analysis: Hybrid Systems 2.2, pp. 231¬≠241. Petersen, C.D., F. Leve, and I. Kolmanovsky (2017a). "Model predictive control of an underactuated spacecraft with two reaction wheels". In: Journal of Guidance, Control, and Dynamics 40, pp. 320¬≠332. -- (2017b). "Underactuated spacecraft switching law for two reaction wheels and constant angular momentum". In: Journal of Guidance, Control, and Dynamics 39.9, pp. 2086¬≠2099. Polycarpou, M. and P. Ioannou (1996). "A robust adaptive nonlinear control design". In: Automatica 32.3, pp. 432¬≠427. Qin, S.J. and T.A. Badgwell (2003). "A survey of industrial model predictive control technology". In: Control Engineering Practice 11.7, pp. 733¬≠764. Rosier, L. (1992). "Homogeneous Lyapunov Function for homogeneous continuous vector field". In: Systems and Control Letters 19.6, pp. 467¬≠473.

125

BIBLIOGRAPHY Ross, I.M. (2015). A Primer on Pontryagin's Principle in Optimal Control. Second Edition. San Francisco: Collegiate Publishers. Chap. 3.2. Ross, I.M. and M. Karpenko (2012). "A Review of Pseudospectral Optimal Control: From Theory to Flight". In: Annual Reviews in Control 36.2, pp. 182¬≠187. Ruiter, A. de, C. Damaren, and J. Forbes (2013). Spacecraft Dynamics and Control: An Introduction. 1st ed. West Sussex, United Kingdom: John Wiley & Sons, Ltd. ISBN: 9781118342367. Salcudean, S. (1991). "A globally convergent angular velocity observer for rigid body motion". In: IEEE Transactions on Automatic Control 36.12, pp. 1493¬≠1497. Seo, D. and M. Akella (2007). "Separation Property for the Rigid-Body Attitude Tracking Control Problem". In: Journal of Guidance, Control and Dynamics 30.6, pp. 1569¬≠1576. Spong, M.W. (1995). "The swing up control problem for the Acrobot". In: IEE Control Systems 15.1, pp. 49¬≠55. Sun, N. and Y. Fang (2014). "An efficient online trajectory generating method for underactuated crane systems". In: International Journal Robust Nonlinear Control 24, pp. 1653¬≠1663. Tayebi, A. (2007). "A velocity-free attitude tracking controller for rigid spacecraft". In: pp. 6430¬≠6434. Thakur, D. and M. Akella (2015). "Gyro-Free Rigid-Body Attitude Stabilization Using only Vector Measurements". In: Journal of Guidance, Control, and Dynamics 38.4, pp. 811¬≠818. Trumpf, J. et al. (2012). "Analysis of Non-Linear Attitude Observers for TimeVarying Reference Measurements". In: IEEE Transactions on Automatic Control 37.11, pp. 2789¬≠2800. Tsiotras, P. and J.H. Luo (2000). "Control of underactuated spacecraft with bounded inputs". In: Automatica 36.8, pp. 1153¬≠1169. Xiao, B. et al. (2014). "Fault-tolerant control of spacecraft with attitude-only measurement under actuator failures". In: Journal of Guidance, Control, and Dynamics AIAA Early Edition, pp. 1¬≠12. Xin, X. and Y. Liu (2014). Control design and analysis for underactuated robotic systems. 1st ed. Springer. ISBN: 9781447162506. 126

BIBLIOGRAPHY Xu, R. and U. Ozguner (2008). "Sliding mode control of a class of underactuated systems". In: Automatica 44.1, pp. 233¬≠241. Zhang, J., K. Ma, and G. Meng (2014). "Controllability analysis and attitude path planning of underactuated spacecraft systems". In: Aerospace Science and Technology 33, pp. 76¬≠81. Zhang, M. (2002). "Hybrid control of the pendubot". In: IEEE/ASME Transaction on Mechantronics 7.1, pp. 79¬≠86. Zhou, K. and J.C. Doyle (1998). Essentials of Robust Control. Upper Saddle River, NJ: Prentice Hall. Zlotnik, D. E. and J. R. Forbes (2017). "Nonlinear Estimator Design on the Special Orthogonal Group Using Vector Measurements Directly". In: IEEE Transactions on Automatic Control 62.1, pp. 149¬≠160. Zou, A.M. (2014). "Finite-time output feedback attitude tracking control for rigid spacecraft". In: IEEE Transactions on Control Systems Technology 22.1, pp. 338¬≠345.

127


