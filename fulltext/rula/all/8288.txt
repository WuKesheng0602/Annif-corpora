Finite system approximation in colloidal systems with aggregation and break-up

by

Salina Aktar Master of Philosophy, BUET, 2012 Master of Science, University of Dhaka, 2005 Bachelor of Science, University of Dhaka, 2003

A thesis presented to Ryerson University

in partial fulfillment of the requirements for the degree of Master of Science in the program of Applied Mathematics

Toronto, Ontario, Canada, 2018 c Salina Aktar, 2018

AUTHOR'S DECLARATION FOR ELECTRONIC SUBMISSION OF A THESIS
I hereby declare that I am the sole author of this thesis. This is a true copy of the thesis, including any required final revisions, as accepted by my examiners. I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research. I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. I understand that my thesis may be made electronically available to the public.

ii

Abstract
Finite system approximation in colloidal systems with aggregation and break-up Master of Science, 2018 Salina Aktar Applied Mathematics Ryerson University

In this Thesis, reactive multiparticle collision dynamics (RMPC) is used to simulate red blood cell cluster concentration profiles in the presence of aggregation, as well as when aggregation and break-up are present together. RMPC dynamics involves local collisions, reactions and free-streaming of particles. Reactive mechanisms are used to model the aggregation and break-up of particles. This analogy is motivated by a system of ODES called the Smoluchowski differential equations that have been used to model aggregating systems in the well-mixed case. Exact solutions for the (infinite) systems of ODEs for the Smoluchowski equation are compared to a numerical ODE system solution where the maximum cluster size is N (finite) rather than infinite as assumed in the Smoluchowski equation. The numerical ODE solution is compared to the exact solution in the infinite system when the maximum cluster size is 20 or less. Stochastic RMPC simulations are performed when the maximum cluster size N = 3, and the simulation domain is a cubic volume subject to periodic boundary conditions. Constant and equal aggregation and break-up rates are considered, as well as much smaller aggregation rates compared to break-up rates and vice-versa. Two different initial conditions are considered: monomer-only, as well as non-zero initial concentrations for clusters of all sizes. The simulation for the RMPC (finite), numerical ODE (finite) and exact (infinite) can be shown to have good agreement in the equilibrium concentrations of the chemical species in the system in some cases, although agreement is poor in other cases. This work is an important stepping stone that can be expanded to incorporate flow conditions into the particle dynamics in future work, so as to more accurately investigate pathological conditions including atherosclerotic plaque formation.

iii

Acknowledgements
I would like to express my sincere gratitude to my supervisor, Dr.Katrin Rohlf for the continuous support of my MSc study and related research, for her patience, motivation, and immense knowledge. Her guidance helped me all the time of research and writing of this thesis.I could not have imagined having better advisor and mentor for my whole study period. I have infinite gratitude towards my supervisor for tolerating my infinite limitations. I am forever grateful to Dr. Rohlf, who not only spent many a morning but also given me the guidance how to write a nice research writing.She always given me the freedom keeping my interest,implement my own ideas to be done in the whole research through my flexibility.So,I would like to thank her heartily. I also wish to thank all of the committee members on my Thesis:Dr. Jean-Paul Pascal,Dr. Kathleen Wilkie and Dr. Alexey Rubtsov. I am extremely grateful to my parents.The foundation for my education started at home. They provided me all the supports from my childhood to this level as this was also their dream to be a graduate student and hold my degree from a university in Canada.Additionally ,I would like to express my thankful to my husband(Shumon),my princes (Mihal and Samil) and my two brothers for supporting me spiritually throughout my study and my life in general. I remember my father and one of my cousin who are passed away. They always inspired and motivated me to learn mathematics in every steps of my life. Last but not least,my sincere appreciation to the Department of Applied Mathematics at Ryerson University for the opportunity to study here and its esteemed professors for their constant encouragement. I would like to thank Steve Kanellis,who helped me technically.He helped me to operate the programming language FORTRAN 90,solved Miktex errors and data backup immediately in my laptop.

iv

Dedication
I would like to dedicate this thesis to youth in Bangladesh who are really deprived from the touch of education in cause of their poverty.

v

Contents
Author's Declaration Abstract Acknowledgements Dedication List of Figures 1 Introduction 1.1 1.2 1.3 1.4 Biological Modelling . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Particle-Based Methods of RBC aggregation . . . . . . . . . . . . . . . . . . . . . . . . . . . . Specific Aim and Methodology . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Thesis Organization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . ii iii iv v viii 1 1 2 4 4 6 6 7 8 10 10 11 11 12 12 13 15 21 22

2 Reactive MPC Dynamics 2.1 2.2 2.3 2.4 2.5 Reaction Mechanism . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Particle Collisions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Free-Streaming . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Transport Coefficients . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Boundary condition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

3 Infinite System 3.1 3.2 3.3 3.4 3.5 3.6 3.7 Aggregation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Fragmentation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Classical aggregation-fragmentation process . . . . . . . . . . . . . . . . . . . . . . . . . . . . Exact solution for aggregation Exact solution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

Exact solution in aggregation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Exact solution: aggregation/fragmentation . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

vi

4 Finite System 4.1 4.2 4.3 4.4 4.5 4.6 Aggregation-Fragmentation System with Maximum Cluster Size Cluster concentration . . . . . . . . . . . . . . . . Cluster concentration with aggregation only . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Cluster concentration E = F

26 26 27 27 36 40 40 49 50 50 50 60 63 66 70 70 71 72 73

Cluster concentration E = 2F . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Cluster concentration F = 2E . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

5 Stochastic Simulations 5.1 5.2 5.3 5.4 5.5 5.6 Case 1: Varying break-up rates . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Case 2: Varying aggregation rate . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Case 3: Varying initial condition . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Case 4: Varying initial condition F Case 5: Varying initial condition E E . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . F . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

Case 6: i, j -dependent rates . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

6 Conclusions and Future Work 6.1 6.2 6.3 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Future work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

References

vii

List of Figures
2.1 Diagrammatic representation of the multiparticle collision rule. The upper panel shows the center of mass velocity and pre-collision velocities of the particles relative to the center of mass. The lower panel shows the result of adding back the center of mass velocities to get the post-collision velocities. The figure is a slight modification of [19] as modified by [17]. 4.1 . . . . 9

Simulation of 1st, 3rd, and 5th cluster concentration of Numerical (N = 5) vs Exact solution (infinite system) for Kij = 8, Wij = 0 with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 28

4.2

Simulation of 1st, 3rd, and 5th cluster concentration of Numerical (N = 5) vs Exact solution (infinite system) for Kij = 8, Wij = 0 with the initial concentration C1 (0) = (1 - q )2 , C3 (0) = q 2 (1 - q )2 and C5 (0) = q 4 (1 - q )2 for q = 0.75. . . . . . . . . . . . . . . . . . . . . . . . . . . 29

4.3

Simulation of 1st, 5th and 10th cluster concentration of Numerical (N = 10) vs Exact solution (infinite system) for Kij = 8, Wij = 0 with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30

4.4

Simulation of 1st, 5th, 10th, and 20th cluster concentration of Numerical (N = 20) vs Exact solution (infinite system) for Kij = 8, Wij = 0 with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 31

4.5

Simulation of 1st, 3rd, and 5th cluster concentration of Numerical (N = 5) vs Exact solution (infinite system) for Kij = 8, Wij = 5 with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32

4.6

Simulation of 1st, 3rd, and 5th cluster concentration of Numerical (N = 5) vs Exact solution (infinite system) for Kij = 8, Wij = 5 with the initial concentration C1 (0) = (1 - q )2 , C3 (0) = q 2 (1 - q )2 and C5 (0) = q 4 (1 - q )2 for q = 0.75. . . . . . . . . . . . . . . . . . . . . . . . . . . 33

4.7

Simulation of 1st, 5th and 10th cluster concentration of Numerical (N = 10) vs Exact solution (infinite system) for Kij = 8, Wij = 5 with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34 Simulation of 1st, 5th, 10th, and 20th cluster concentration of Numerical (N = 20) vs Exact solution (infinite system) for Kij = 8, Wij = 5 with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35

4.8

viii

4.9

Simulation of 1st, 3rd, and 5th cluster concentration of Numerical (N = 5) vs Exact solution (infinite system) for Kij = 0.8, Wij = 0.8 (E = F ) with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 36

4.10 Simulation of 1st, 3rd, and 5th cluster concentration of Numerical (N = 5) vs Exact solution (infinite system) for Kij = 0.8, Wij = 0.8 (E = F ) with the initial concentration C1 (0) = (1 - q )2 , C3 (0) = q 2 (1 - q )2 and C5 (0) = q 4 (1 - q )2 for q = 0.75. . . . . . . . . . . . . . . . . 4.11 Simulation of 1st, 5th and 10th cluster concentration of Numerical (N = 10) vs Exact solution (infinite system) for Kij = 0.8, Wij = 0.8 (E = F ) with the initial condition C1 (0) = 1 and Ck (0) = 0,for k  2. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.12 Simulation of 1st, 5th, 10th, and 20th cluster concentration of Numerical (N = 20) vs Exact solution (infinite system) for Kij = 0.8, Wij = 0.8 (E = F ) with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.13 Simulation of 1st, 3rd and 5th cluster concentration of Numerical (N = 5) vs Exact solution (infinite system) for Kij = 0.8, Wij = 0.4 (E = 2F ) with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.14 Simulation of 1st, 3rd, and 5th cluster concentration of Numerical (N = 5) vs Exact solution (infinite system) for Kij = 0.8, Wij = 0.4 (E = 2F ) with the initial concentration C1 (0) = (1 - q )2 , C3 (0) = q 2 (1 - q )2 and C5 (0) = q 4 (1 - q )2 for q = 0.75. . . . . . . . . . . . . . . . . 4.15 Simulation of 1st, 5th and 10th cluster concentration of Numerical (N = 10) vs Exact solution (infinite system) for Kij = 0.8, Wij = 0.4 (E = 2F ) with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.16 Simulation of 1st, 5th, 10th and 20th cluster concentration of Numerical (N = 20) vs Exact solution (infinite system) for Kij = 0.8, Wij = 0.4 (E = 2F ) with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.17 Simulation of 1st, 3rd, and 5th cluster concentration of Numerical (N = 5) vs Exact solution (infinite system) for Kij = 0.6, Wij = 1.2 (F = 2E ) with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.18 Simulation of 1st, 3rd, and 5th cluster concentration of Numerical (N = 5) vs Exact solution (infinite system) for Kij = 0.6, Wij = 1.2 (F = 2E ) with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.19 Simulation of 1st, 5th and 10th cluster concentration of Numerical (N = 10) vs Exact solution (infinite system) for Kij = 0.6, Wij = 1.2 (F = 2E ) with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4.20 Simulation of 1st, 5th, 10th, and 20th cluster concentration of Numerical (N = 20) vs Exact solution (infinite system) for Kij = 0.6, Wij = 1.2 (F = 2E ) with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.1 Time evolution of 1st cluster concentration of Exact, ODE and stochastic simulation for i) E = 0.1, F = 0.01 (red curves), ii) E = 0.1, F = 0.05 (black curves) and iii) E = 0.1, F = 0.1 (blue curves), with the initial condition C1 (0) = 1 and C2 (0) = C3 (0) = 0. . . . . . . . . . . . ix 51 48 47 46 45 44 43 42 41 39 38 37

5.2

Simulation of 2nd cluster concentration of Exact, ODE and stochastic solution vs time for (E = 0.1, F = 0.01(red)),(E = 0.1, F = 0.05(black))and (E = 0.1, F = 0.1(blue)) with the initial condition C1 (0) = 1 and C2 (0) = C3 (0) = 0. . . . . . . . . . . . . . . . . . . . . . . . . 52

5.3

Simulation of 3rd cluster concentration of Exact, ODE and stochastic solution vs time for (E = 0.1, F = 0.01(red)),(E = 0.1, F = 0.05(black))and (E = 0.1, F = 0.1(blue)) with the initial condition C1 (0) = 1 and C2 (0) = C3 (0) = 0. . . . . . . . . . . . . . . . . . . . . . . . . 53

5.4

Simulation of 1st cluster concentration of Exact, ODE and stochastic solution vs time for (F = 0.1, E = 0.05(red)),(F = 0.1, E = 0.01(black))and (F = 0.1, E = 0.1(blue)) with the initial condition C1 (0) = 1 and C2 (0) = C3 (0) = 0. . . . . . . . . . . . . . . . . . . . . . . . . 54

5.5

Simulation of 2nd cluster concentration of Exact, ODE and stochastic solution vs time for (F = 0.1, E = 0.05(red)),(F = 0.1, E = 0.01(black))and (F = 0.1, E = 0.1(blue)) with the initial condition C1 (0) = 1 and C2 (0) = C3 (0) = 0. . . . . . . . . . . . . . . . . . . . . . . . . 55

5.6

Simulation of 3rd cluster concentration of Exact, ODE and stochastic solution vs time for (F = 0.1, E = 0.05(red)),(F = 0.1, E = 0.01(black))and (F = 0.1, E = 0.1(blue)) with the initial condition C1 (0) = 1 and C2 (0) = C3 (0) = 0. . . . . . . . . . . . . . . . . . . . . . . . . 56 Simulation of 1st cluster concentration of Exact, ODE and stochastic solution vs time at E = F = 0.1 with the initial concentration C1 (0) = (1 - q )2 , C2 (0) = q (1 - q )2 and C3 (0) = q 2 (1 - q )2 for different values of q . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57

5.7

5.8

Simulation of 2nd cluster concentration of Exact, ODE and stochastic solution vs time at E = F = 0.1 with the initial concentration C1 (0) = (1 - q )2 , C2 (0) = q (1 - q )2 and C3 (0) = q 2 (1 - q )2 for different values of q . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58

5.9

Simulation of 3rd cluster concentration of Exact, ODE and stochastic solution vs time at E = F = 0.1 with the initial concentration C1 (0) = (1 - q )2 , C2 (0) = q (1 - q )2 and C3 (0) = q 2 (1 - q )2 for different values of q . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59

5.10 Simulation of 1st cluster concentration of Exact, ODE and stochastic solution vs time at E = 0.1, F = 0.01 with the initial concentration C1 (0) = (1 - q )2 , C2 (0) = q (1 - q )2 and C3 (0) = q 2 (1 - q )2 for different values of q . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.11 Simulation of 2nd cluster concentration of Exact, ODE and stochastic solution vs time at E = 0.1, F = 0.01 with the initial concentration C1 (0) = (1 - q )2 , C2 (0) = q (1 - q )2 and C3 (0) = q 2 (1 - q )2 for different values of q . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.12 Simulation of 3rd cluster concentration of Exact, ODE and stochastic solution vs time at E = 0.1, F = 0.01 with the initial concentration C1 (0) = (1 - q )2 , C2 (0) = q (1 - q )2 and C3 (0) = q 2 (1 - q )2 for different values of q . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.13 Simulation of 1st cluster concentration of Exact, ODE and stochastic solution vs time at E = 0.01, F = 0.1 with the initial concentration C1 (0) = (1 - q )2 , C2 (0) = q (1 - q )2 and C3 (0) = q 2 (1 - q )2 for different values of q . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.14 Simulation of 2nd cluster concentration of Exact, ODE and stochastic solution vs time at E = 0.01, F = 0.1 with the initial concentration C1 (0) = (1 - q )2 , C2 (0) = q (1 - q )2 and C3 (0) = q 2 (1 - q )2 for different values of q . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64 63 62 61 60

x

5.15 Simulation of 3rd cluster concentration of Exact, ODE and stochastic solution vs time at E = 0.01, F = 0.1 with the initial concentration C1 (0) = (1 - q )2 , C2 (0) = q (1 - q )2 and C3 (0) = q 2 (1 - q )2 for different values of q . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.16 Simulation of 1st cluster concentration of Exact, ODE and stochastic solution vs time with the initial concentration C1 (0) = (1 - q )2 , C2 (0) = q (1 - q )2 and C3 (0) = q 2 (1 - q )2 for different values of q . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.17 Simulation of 2nd cluster concentration of Exact, ODE and stochastic solution vs time with the initial concentration C1 (0) = (1 - q )2 , C2 (0) = q (1 - q )2 and C3 (0) = q 2 (1 - q )2 for different values of q . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.18 Simulation of 3rd cluster concentration of Exact, ODE and stochastic solution vs time with the initial concentration C1 (0) = (1 - q )2 , C2 (0) = q (1 - q )2 and C3 (0) = q 2 (1 - q )2 for different values of q . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 68 67 66 65

xi

Chapter 1

Introduction
1.1 Biological Modelling

The blood circulation in the human body is a delicate system in which the essential functions of delivering oxygen and nutrients to the tissues and cells, and taking away metabolic waste products, is carried out by the heart, the blood and blood vessels. The cardiovascular system spans through the entire body and provides an essential support mechanism for all other body tissues. Blood has been extensively studied at the macroscopic, as well as microscopic level, for nearly half a century, and has been a key focus of medical, biological, chemical, physical, mathematical and pharmaceutical studies [5]. Significant efforts have been made to obtain correct models for blood flow so as to investigate mechanical and bio-chemical properties, as well as coagulation of blood in healthy and diseased conditions. In particular, coagulation of blood can be affected through complex flow geometries as can arise in atherosclerosis and thus it is important to understand this phenomenon. To describe red blood cell (RBC) coagulation, or aggregation of RBCs, the collision theory of chemical reactions can be used as an analogy [23]. The flow of blood is affected by three key parts: blood vessels, periodic pumping of the heart, and cellular constituents of blood itself. Blood vessels have varying diameters and elastic properties that influence blood flow and are categorized as arteries, veins and capillaries. The larger blood vessels that carry blood away from the heart are arteries while veins carry blood towards it. The smaller capillaries allow for exchange of water and chemicals between the blood and the tissues. The periodic contractions of the heart lead to pulsatile flows. Finally, blood consists of a fluid component called plasma and blood cells that are suspended within it. Blood plasma is an aqueous solution of electrolytes, proteins and small organic molecules such as glucose, that occupies roughly 50 - 60% of the blood volume. The remaining portion contains blood cells including primarily erythrocytes (or red blood cells - RBCs), thrombocytes (or platelets), and leukocytes (or white blood cells - WBCs). The properties of blood depend on the extent of aggregation of suspended erythrocytes in plasma that grow in size as they aggregate [15], the total number of RBC aggregates in an elementary volume, and on the kinetic changes of the size distributions [22]. In 1 mm3 volume of blood, millions of red blood cells (RBCs) interact with each other and stick together

1

CHAPTER 1. INTRODUCTION

1.2. PARTICLE-BASED METHODS OF RBC AGGREGATION

to form larger clusters called rouleaux in a process called aggregation. Large RBC aggregates formed in autologous plasma resemble a stack of coins when observed under light microscopy. In flow, RBC clusters are easily broken up, leading to shear-dependent aggregation that is believed to be the reason that blood behaves like a non-Newtonian fluid. Newtonian flow behaviour is observed when blood flows through the larger diameter arteries where flows have high shear rates, but remarkable non-Newtonian behaviour is observed when it flows through small diameter arteries, or capillaries, where the shear rates are much lower. Additionally, the rouleaux formation leads to an increase in the viscosity of blood at low shear rates [33] causing a flattened parabolic velocity profile rather than a parabolic profile corresponding to Newtonian flow. The solid core that is formed at the center, which is the cause for the flattened parabolic velocity profile, requires a minimum amount of shear stress to be broken up. This minimum shear stress is called a yield stress, and is a non-Newtonian parameter [24]. Normal human blood is believed to have a yield stress value between 0.01 and 0.06 dyn/cm2 . Complex flow geometries, such as local constrictions in blood vessels, can also cause or affect RBC aggregation. The ultrasonic echo intensity of blood has been found to depend on the concentration of suspended RBCs and RBC aggregates of various sizes in the plasma. Additionally, increased RBC aggregation leads to increased microvascular flow resistance that in turn affects aggregation in blood vessels as a result of decreased overall microcirculatory blood flow. Furthermore, larger RBC aggregates can impede flow in the smaller capillaries leading to no-flow conditions. Murata[21] investigated time-independent effects of aggregation and sedimentation on the flow of human blood in narrow horizontal tubes as flow resistance is increased. It was observed that small aggregates are formed under comparatively high shearing forces, while large aggregates form in low shear conditions. Studying the fluid dynamical aspects of blood flow through a stenosed artery is useful to develop our fundamental understanding of circulatory disorders. Stenosis is the narrowing of the blood flow area through the development of an arteriosclerotic plaque, that leads to increased flow resistance and associated reduction in blood supply downstream. This can cause serious cardiovascular diseases including myocardial infarction and cerebral strokes[33]. Many computational studies have been carried out so as to simulate stenosed flow. Experimental observations show that there is a higher RBC concentration at the flow axis [29]. Tsubota et. al. [30] presented a two-dimensional particle model for blood flows between two parallel rigid plates. The more recent work of Zhang et. al.[34] used another simulation approach for two-dimensional blood flow using the immersedboundary lattice Boltzmann algorithm. AlMomani et. al.[4] used the computational fluid dynamics (CFD) model to perform micro-scale simulations of platelet-RBC interactions in shear flow.

1.2

Particle-Based Methods of RBC aggregation

Using particle-based methods to simulate RBC dynamics has become increasingly attractive over the years. In such methods, positions and velocities of particles are recorded and evolved in time. These methods can be divided into microscopic, mesoscopic and macroscopic particle-based methods, characterized according to an appropriate length scale. For example, a microscopic approach includes molecular dynamics (MD) simulations, and mesoscopic methods include the Lattice-Boltzmann method (LBM) [28, 20], dissipative

2

CHAPTER 1. INTRODUCTION

1.2. PARTICLE-BASED METHODS OF RBC AGGREGATION

particle dynamics (DPD) [10] and multiparticle collision dynamics (MPC) [19, 11, 12, 13]. Smoothed particle hydrodynamics(SPH) [8] is a macroscopic approach. These methods focus primarily on the fluid dynamics aspects of blood rather than the aggregation and break-up processes of RBCs and how these affect fluid flow or how flow affects the aggregation process. The focus of this Thesis is on RBC aggregation using a mesoscopic approach called Reactive Multiparticle collision dynamics (RMPC), which is an extension of MPC that additionally allows reaction mechanisms. In this way, the method can be extended to include flow conditions without having to combine different computational methods. Multiparticle collision (MPC) dynamics was first introduced by Malevanets and Kapral in 1999 and is a method that conserves mass, energy and momentum throughout the system [19]. The main steps in MPC are: local collisions and free-streaming. This method is also often referred to as stochastic rotation dynamics (SRD), although MPC is the more common name in the literature. Due to an efficient local collision algorithm, which involves a stochastic rotation operator, this method is classified as mesoscopic [2]. MPC has been used in a number of flow applications [18, 6, 3]. Specifically in [6, 1], the method has been used to simulate flow through a local constriction. RBC aggregation is not part of these studies, and all particles in the system are the same type, eg. fluid particles. MPC can easily be extended to include different particle types for multi-component systems where there are different chemical species for example [14]. Incorporation of reaction events in the MPC dynamics gave rise to the Reactive multiparticle collision dynamics (RMPC). Interesting applications have been investigated with RMPC including pattern-forming chemically reacting systems [14], diffusion-influenced reaction dynamics [31], reaction-diffusion fronts [32], and diffusion-influenced signaling pathways [27]. In the initial introduction of the RMPC method, reactions had to conserve the total number of particles in the system. Extension of RMPC to allow for reactions that change the number of particles through a reactive mechanism was first introduced in [25, 26] and later applied to a bistable biochemical system by Chen et. al. [7]. MPC dynamics leads to diffusive motion of the particles in the system, so that RMPC simulates a reaction-diffusion system. Most biological functions, as well as the core of chemistry, can be described by complex biochemical reaction networks. The reactive event, as well as the diffusion term, come into play when dealing with reactions. Diffusion-influenced reaction dynamics can be based on the equation [14]  c(r, t) = R(c(r, t)) + D2 c(r, t) t Here c = (c1 , c2 , . . . , cs ) is a vector of the concentrations of the s chemical species, R is a vector-valued function of the reaction rates and D is the matrix of diffusion coefficients. For a well-mixed system, where spatial effects are assumed negligible, one can use the simple chemical rate equations d c(t) = R(c(t)) dt for the evolution of the concentrations of the chemical species, although stochastic effects may be exhibited in spatially distributed reacting systems. Reactions considered include reactions for s chemical species Xl ,

3

CHAPTER 1. INTRODUCTION (l = 1, . . . , s) such as: u1 X1 + u2 X2 + .... + us Xs and u ¯1 X1 + u ¯2 X2 + ... + u ¯s Xs kr - kf -

1.3. SPECIFIC AIM AND METHODOLOGY

u ¯1 X1 + u ¯2 X2 + ... + u ¯s Xs

u1 X1 + u2 X2 + .... + us Xs

Here ul and u ¯l are the stoichiometric coefficients for the reactions. In RMPC dynamics, reactions occur locally in a cell just like the collisions, and occur at discrete times  . Unlike for reaction-diffusion master equations (RDME), or Gillespie-multi-particle methods (GMP), RMPC particles have positions and velocities that are continuous in space. In this Thesis, this recently developed particle-based method called RMPC is used to investigate the aggregation properties of particles. Simulating the aggregation properties of particles can most effectively be done using particle-based methods for reactive media. The total number of clusters before and after the break-up need not be conserved in the process of RBC aggregation and break-up. The traditional kinetic theory descriptions in the form of the Boltzmann equations can not handle the fluctuations in particle numbers. As such, the reactive multiparticle collision dynamics is an appropriate formalism for the study of RBC aggregation. The RBC aggregation and break-up will be treated like chemical reactions, and various reaction rates are considered. Although the method is capable of incorporating flow, the results in this Thesis are for aggregation and break-up in no-flow conditions.

1.3

Specific Aim and Methodology

The purpose of this thesis is to analyze the aggregation properties of particles in no-flow conditions, and how changes in reaction rates affect the aggregation properties of particles that are also able to break up. The research is motivated by particle interactions, namely aggregation and breakup of red blood cells. The thesis will present simulation results for aggregation of particles in no-flow conditions for constant aggregation and break-up rates, and considers one case where reaction rates are cluster-size-dependent. Numerical results are assessed and important conclusions and future work are discussed. In the Thesis we will refer to break-up as fragmentation.

1.4

Thesis Organization

The thesis is organized as follows: In chapter 2 the RMPC background is presented, discussing the reaction mechanism, the collision rule and the free-streaming of the particles with appropriate boundary conditions. In chapter 3, the exact solution for a reactive mechanism for an infinite system describing aggregation only, as well as aggregation with break-up of particles, is found and analyzed. Chapter 4 provides the numerical ODE solution for a finite system in which there is a maximum cluster size. Both the cases for aggregation only, and aggregation together with break-up are considered. In Chapter 5, we provide the results for 4

CHAPTER 1. INTRODUCTION

1.4. THESIS ORGANIZATION

particle-based simulations using RMPC and compare the results to the exact solution for the infinite system as well as the finite ODE solution. Constant aggregation and break-up rates are considered, much larger aggregation rates compared to break-up rates are discussed, smaller break-up rates compared to aggregation rates are presented, and a case for cluster-size dependent rates is also shown. A summary of the key findings, a discussion of the results and important conclusions and future work is contained in chapter 6.

5

Chapter 2

Reactive Multiparticle Collision Dynamics
In this chapter the basic properties of reactive multiparticle collision dynamics(RMPC) are discussed and the numerical implementation of RMPC dynamics is explained. We have modeled the dynamics of a 3-D system consisting of particles satisfying the reactive mechanism associated with aggregation and break-up of red blood cells. The boundary condition to model particle interaction is discussed. RMPC dynamics is a process made up of three basic elements that occur at discrete time steps. The elements are: collisions between particles, reactions, and ballistic particle motion in the form of free-streaming. The system volume V , containing N particles, is divided into subvolumes or cells V with collisions and reactions occurring locally in each subvolume, followed by free-streaming of particles irrespective of this subdivision. The velocity distribution of the particles in the RMPC method are taken from the same Maxwell-Boltzmann probability distribution that is given by m 2kB T
3 2

p(v) = which has zero mean and variance
kB T m

exp -

m v2 2kB T

. Here kB is the Boltzmann constant, m is the mass of a particle, and

T is the system temperature. The reason for assigning velocities from this distribution is that, it has been shown that particles in an RMPC system satisfy this particular velocity distribution at equilibrium [19].

2.1

Reaction Mechanism

Suppose the reactive mechanisms for s chemical species Xl (l = 1, ...s) include a set of r reactions R with respective rate constants k in the form
s

R :
l=1

u l Xl

k -

s

u ¯ l Xl
l=1

( = 1, ...r),

6

CHAPTER 2. REACTIVE MPC DYNAMICS

2.2. PARTICLE COLLISIONS

where u ¯ l and u l are the stoichiometric coefficients for reaction  and the subscript l denotes the chemical species type. Suppose there are Nl particles of species l in cell  . Then summing over all chemical species gives the total number of particles in a cell as N  =
s l=1

Nl . It is assumed that reactions occur independently

in a cell for every time step. The probability b  that reaction R occurs in cell  with reaction rate k , in
  the time interval (t, t + dt) is b  dt = k (V )h dt, where h is the combinatorial factor that accounts for the

number of different ways the reaction can occur in the cell, and k (V ) indicates that rate constants have been scaled by the cell volume V . For a randomly chosen reaction R in V we have
s  b  = k (V )h = k (V ) l=1

Nl ! Nl - u l !

.

  Note that the combinatorial factor h  = 0 if ul > Nl for a given species l in the cell, in which case reaction

R will not happen in the cell since b  = 0. In RMPC, at discrete time intervals  , each particle in the system is considered for a reaction separately. For example, suppose the chemical species of a given particle in the system is Xl0 . If a particular chemical species Xl0 is part of more than one reaction mechanism, one of the possible reactions for that species is chosen randomly. Another random number is then drawn, and if it is less than (Nl - 1)! 0 Nl - u l ! 0
s

k (V )
l=1 l=l0

Nl ! Nl - u l !

,

then reaction R will take place in cell  changing the chemical species of particles involved in the reaction mechanism according to the stoichiometry of the reaction.

2.2

Particle Collisions

Suppose the system volume V is divided into Nc cells or subvolumes of equal volume Vc . Let Lx , Ly and Lz be the number of subvolumes in the x, y and z -directions so that Nc = (Lx )(Ly )(Lz ) and V = Nc Vc . Collisions update the velocities of particles based on local information in cell  according to two rules: an all-species collision followed by a single-species collision. Each collision rule amounts to a random rotation operator acting on the deviation of a given particle velocity from the average velocity in the cell. For a randomly chosen rotation angle, the rotation operator  ^ is given by [9, 27]  R11 R12 R22 R32 R13  
2 2 lx + (1 - lx )c

lx ly (1 - c ) - lz s
2 2 ly + (1 - ly )c

lx lz (1 - c ) + ly s
2 2 lz + (1 - lz )c

 (2.1)

  ^ =  R21 R31

   R23   = lx ly (1 - c ) + lz s R33 lx lz (1 - c ) - ly s

 ly lz (1 - c ) + lx s  

ly lz (1 - c ) + lx s

  where lx = cos  1 - 2 , ly = sin  1 - 2 , lz = , and  and  are random numbers on the interval [0, 2 ] and [-1, 1] respectively. The abbreviated form c = cos  and s = sin  is used for clarity and  represents the randomly chosen rotation angle specifying the collision rule. Let the set of rotation angles for 7

CHAPTER 2. REACTIVE MPC DYNAMICS

2.3. FREE-STREAMING

the all-species collision rule be  and for the single-species collision rule for species l be l where l = 1, . . . s. Then    in (2.1) leads to the all-species collision rule while  = l  l gives a single-species collision. Application of the all-species collision rule then updates the velocity vj (t) of particle j at time t in cell  at discrete time steps  according to vj (t +  ) = V +  ^  (vj (t) - V ). where the mass center velocity of all of the particles in the cell is given by 1 N
N

(2.2)

V =

vn
n=1

(2.3)

with N being the number of particles in the cell at that time. The collision rule (2.2) is the all-species collision rule as there is no distinction between the species of the particles in the cell in which particle j resides. If there is more than one species in the system, different diffusivities of the particles can be incorporated into the dynamics by using a different set of collision angles
l l for the different species. Then, rule (2.2) with  ^ for  = l  l and mass center velocity V of species

type l instead of V leads to the single-species collision rule. Applying the single-species rule following the all-species rule leads to the combined velocity update of particle j over the time step  as
l l l vj (t +  ) = V +  ^ V - V +  ^  ^  vj (t) - V . l Note that V is the pre-collision mass center velocity of all the particles in cell  at time t, and V uses the

post-collision velocity information after the all-species rule is applied. In Figure 2.1 a diagrammatic representation of the collision rule (2.2) can be seen. Although the figure shows the rule for two particles, there can be any number of particles in the cell, and in particular, if there is only one particle in the cell, the collision rule leaves the particle's velocity unchanged. It is worth mentioning that that collision rule (2.2) conserves mass, momentum and energy locally in a collision cell as shown in [19]. Additionally, the collision rule of MPC dynamics is much more efficient numerically compared to other particle-based methods. Following the collision rules is the free-streaming of particles discussed next.

2.3

Free-Streaming

In RMPC dynamics, positions and velocities of particles are continuous vectors. The free-streaming step updates the position of particle j , rj (t), using the post-reaction and post-collision velocity vj (t +  ), leading to the new position of the particle at t +  rj (t +  ) = rj (t) + vj (t +  ).

8

CHAPTER 2. REACTIVE MPC DYNAMICS

2.3. FREE-STREAMING

Figure 2.1: Diagrammatic representation of the multiparticle collision rule. The upper panel shows the center of mass velocity and pre-collision velocities of the particles relative to the center of mass. The lower panel shows the result of adding back the center of mass velocities to get the post-collision velocities. The figure is a slight modification of [19] as modified by [17]. 9

CHAPTER 2. REACTIVE MPC DYNAMICS

2.4. TRANSPORT COEFFICIENTS

2.4

Transport Coefficients

Using the MPC rule (2.2), the transport properties of the system can be computed. For example, the diffusion coefficient Dl for a particular species l in the system can be shown to satisfy the Green-Kubo formula [27] Dl = where l = kB T  2m 1 + l 1 - l 1 2 + cos  3 3 1 l

1 + 

1 2 + cos  3 3

1 1 - l 

+

1 2 + cos l 3 3

1-

.

Here,  is the average mass density of all particles in a cell or subvolume, while l is the average mass density of particles of species type l in a cell, and  and l are the random rotation angles for the all-species and single-species collision rules respectively.

2.5

Boundary condition

The simulation domain is a cubic volume with total length L on each side, say. Periodic boundary conditions are used in all of our simulations so that if the x-position at time t +  is greater than L, that is, x(t +  ) = L + dx for some value dx, then it is replaced by dx instead. This amounts to the particle exiting the right part of the domain by a distance dx, and being placed that same distance from the left part of the domain instead. The same thing is done for the y and z directions.

10

Chapter 3

Infinite System
In this chapter, we derive the exact solution for an infinite system in which the particles aggregate, as well as for aggregation and fragmentation combined. We present solutions for two initial conditions: only monomers initially, as well as a distribution in concentrations for different sized particles.

3.1

Aggregation

Aggregation can be defined as a non-equilibrium process where reactive clusters join together when they meet. It is normally an irreversible process so that the typical mass of a collection of aggregates grows monotonically in time. There are many examples of aggregating systems, including the curdling of milk, the coagulation of blood, and the formation of stars by gravitational accretion. Aggregation can be schematically written as a set of reactive mechanisms as follows: Ai + Aj Kij - Ai+j .

Here, As represents a cluster of size s, also called an s-mer, so that this reactive mechanism represents the irreversible union of clusters of size i and j at rate Kij . The corresponding set of reactive mechanisms can be cast into a system of ordinary differential equations for the concentration Ck (t) of a cluster of size k and is given by 1 dCk = dt 2


Kij Ci Cj - Ck
i+j =k i=1

Kik Ci ,

k = 1, 2, ...

The first term on the right hand side represents all possible combinations of the creation of clusters of size k due to the aggregation of an i-mer with a j -mer, each occuring at rate Kij Ci Cj . The factor Kij is called the reaction kernel and represents the rate at which an i-mer and a j -mer meet. The second (loss) term accounts for the loss of clusters of size k due to their aggregation with other clusters in the system. The prefactor 1 2 in the gain term ensures the correct counting of combinations of aggregates. For example, when 11

CHAPTER 3. INFINITE SYSTEM i = j , there will be a
1 2 Kij Ci Cj

3.2. FRAGMENTATION
1 2 Kji Cj Ci term, leading to a total contribution of the 2 the 1 2 Kii Ci term. The reaction rates Kij form an infinite

term, as well as a

sum of these two, while when i = j , there is only

matrix, that is usually assumed to be symmetric so that Kij = Kji and Kik = Kki . Further note that the system is an infinite system since k goes to infinity. Additionally the upper limit of the second sum on the right hand side is infinity, making this a set of equations for what we will refer to as the infinite system.

3.2

Fragmentation

Fragmentation can be defined as the breakup of clusters, which can happen by external forces or through collisions for example. Some key examples of fragmentation processes include the breaking of chemical bonds in polymer degradation and combustion which occurs at the molecular level, or in red blood cell clusters suspended in shear flow. Fragmentation can be schematically written as a set of reactive mechanisms as follows: Ai+j Wi+j,i - Ai + Aj

This is simply the reverse of the aggregation process from the previous section. In this case an (i + j )-mer breaks up into an i-mer and j -mer at rate Wi+j,i . The corresponding set of reactive mechanisms can be cast into a system of ordinary differential equations for the concentration Ck (t) of a cluster of size k as dCk = dt


Wik Ci -
i=k+1

1 2

k -1

Wki Ck ,
i=1

k = 1, 2, ...

The first term on the right hand side represents the creation of clusters of size k due to the breakup of a larger sized cluster, each occuring at rate Wik Ci for i > k . The factor Wik is called the reaction kernel and represents the rate at which a k -mer is produced after break-up of an i-mer. The second (loss) term accounts for the loss of clusters of size k due to their break-up into smaller ones. The prefactor
1 2

in the loss

term corrects for double-counting of most of the terms. For example, the i = 1 term and the i = k - 1 term both represent the breakup of the k -mer into clusters of size 1 and size k - 1. The reaction rates Wik form an infinite matrix just like the rates for aggregation, and one also usually assumes them to be symmetric so that Wik = Wki . This is again an infinite system as k goes to infinity, as does the limit of the first sum on the right hand side, making this again what we will call the infinite system.

3.3

Classical aggregation-fragmentation process

The deterministic model for an infinite system combining coagulation and fragmentation leads to the differential equations for the cluster concentration Ck (t) of clusters of size k at time t as: 12

CHAPTER 3. INFINITE SYSTEM

3.4. EXACT SOLUTION FOR AGGREGATION

dCk 1 = dt 2





Kij Ci Cj - Ck
i+j =k i=1

Kik Ci +
i=k+1

1 Wik Ci - Ck 2

k-1

Wki ,
i=1

k = 1, 2, ...

3.4

Exact solution for aggregation

The solution for the Smoluchowski equation corresponding to aggregation in the infinite system for constant reaction rates is well-known and derived here. Recall from Section 3.1 that the infinite system of ordinary differential equations is given by 1 dCk = dt 2


Kij Ci Cj - Ck
i+j =k i=1

Kik Ci ,

k = 1, 2, ...

(3.1)

Taking Kij = Kik = E , where E is a constant, the time evolution of the concentration Ck (t) is: dCk 1 = dt 2


ECi Cj - Ck
i+j =k i=1

ECi .

(3.2)

For the constant kernel aggregation rates,the solution technique involves an exponential ansatz given by [16] Ck (t) = A(t)a(t)k-1 (3.3)

with as yet unknown A(t) and a(t). One typically uses an initial monomer concentration, that is C1 (0) = 1 and Ck (0) = 0, k > 1, which implies A(0) = 1 and a(0) = 0. This fact explains why we choose the power k - 1 rather than k for a. Differentiating this expression gives the relationship dCk  k-1 + A(k - 1)ak-2 a = Aa  dt Substitution of (3.4) and (3.3) into equation (3.2) gives  + A(k - 1)ak-2 a a k -1 A  = 1 2


(3.4)

A2 ai+j -2 E - Aak-1
i+j =k i=1

EAai-1

(3.5)

Divide both sides of the equation by Ck (t) = Aak-1 and rearrange:  k-1 Aa A(k - 1)ak-2 a  + = Aak-1 Aak-1 
1 2 i+j =k

A2 ai+j -2 E

Aak-1

-

Aak-1 E i=1 Aai-1 Aak-1



  A (k - 1)a  1A + = E (k - 1) - EA ai-1 A a 2a i=1



 A (k - 1)a  1A + = E (k - 1) - EA(1 - a)-1 A a 2a 13

CHAPTER 3. INFINITE SYSTEM

3.4. EXACT SOLUTION FOR AGGREGATION



 A (k - 1)a  1A EA + = E (k - 1) - A a 2a 1-a

Since this equation should hold for all values of k , and A and a are independent of k , all coefficients of powers of k should be zero. Equating coefficients of k -dependent and k -independent terms leads to  A EA =- A 1-a and a  1 EA = a 2 a (3.7) (3.6)

To simplify the solution process, one can use conservation of mass in the Smoluchowski equation. Mass in the Smoluchowski equation is defined as
k1

kCk , which is conserved since multiplication of (3.2) by k and kCk (t) =
k1 k 1

summing over k leads to

d dt

kCk = 0. Thus,
k1

kCk (0) = 1 based on the monomer-only

initial condition. Substituting the ansatz (3.3) into this leads to kCk = A
k1 k 1

kak-1 = A(1 - a)-2

so that mass conservation implies A = (1 - a)2 . (3.8)

Substituting this into (3.7) gives a separable ODE for a(t) that can be solved using standard methods: a  =  1 E (1 - a)2 2

da 1 1 = E (1 - a)2 dt 2 1 1 = Et + C 1-a 2 (3.9)



To find the constant of integration C , apply the initial condition a(0) = 0: 1 E (0) + C = 1 2 C=1 Hence 1 1 = Et + 1 1-a 2

14

CHAPTER 3. INFINITE SYSTEM 2 2 + Et Et 2 + Et
2

3.5. EXACT SOLUTION

1-a=  a(t) = Thus, using (3.8) gives A(t) = Finally from (3.3) Ck (t) =
2. (2 + Et)

1-

Et 2 + Et

=

4 (2 + Et)
2

4

Et 2 + Et

k-1

=

4E k-1 tk-1 (2 + Et)
k+1

(3.10)

which is the solution to the aggregating system with constant reaction rates E and monomer-only initial condition for the infinite system.

3.5

Exact solution for aggregation and fragmentation

The solution for the Smoluchowski equation corresponding to aggregation in the infinite system can also be derived with the addition of fragmentation when reaction rates are constant and there are only monomers initially in the system. Recall that the evolution equation for the concentration of a cluster of size k , Ck (t) evolves according to the equations: dCk 1 = dt 2
 

Kij Ci Cj - Ck
i+j =k i=1

Kik Ci +
i=k+1

1 Wik Ci - Ck 2

k -1

Wki ,
i=1

k = 1, 2, .....

Taking Kij = Kji = E , and Wik = Wki = F , the time evolution of the concentration Ck (t) in presence of aggregation and breakup is: 1 dCk = dt 2
 

ECi Cj - Ck
i+j =k i=1

ECi +
i=k+1

1 F Ci - Ck 2

k -1

F,
i=1

k = 1, 2, ....

(3.11)

We again use the exponential ansatz to solve the equation, which was Ck (t) = A(t)a(t)k-1 (3.12)

with as yet unknown A(t) and a(t). Again, the monomer-only initial condition implies A(0) = 1 and a(0) = 0. Substituting into (3.11), also using (3.4) gives A2 Eak-1 F Aak-1 1 1  k-1 + A(k - 1)ak-2 a + - Aak-1 (k - 1)F Aa  = EA2 (k - 1)ak-2 - 2 1-a 1-a 2

15

CHAPTER 3. INFINITE SYSTEM Divide both sides of the equation by Ck (t) = Aak-1 and rearrange:

3.5. EXACT SOLUTION

 A (k - 1)a  1 EA(k - 1) AE Fa 1 + = - + - F (k - 1) A a 2 a 1-a 1-a 2 Since this equation should hold for all values of k , and A and a are independent of k , all coefficients of powers of k should be zero. Equating coefficients of k -dependent and k -independent terms leads to

 AE Fa A =- + A 1-a 1-a and 1 EA 1 a  = - F a 2 a 2
d dt

(3.13)

(3.14)

Recall that this system can be simplified using conservation of mass, which still holds with the fragmentation terms as well. This again implies kCk = 0, leading to A = (1 - a)2 .
k 1

Substituting this into (3.14) gives the ODE for a(t) that can be solved: 1 E (1 - a)2 1 a  = - F a 2 a 2 1 1 a  = E (1 - a)2 - aF 2 2 da 1 F 1 = Ea2 + (-E - )a + E dt 2 2 2 To solve this DE, we let a = u + y1 , where y1 is a constant to be determined, and u(t) is the new unknown function. To find the constant y1 , we substitute this expression into the DE to get du dt = = Taking E+ y1 =
F 2

(3.15)

1 F 1 2 E (y1 + u) + -E - (y1 + u) + E 2 2 2 1 2 F 1 1 F Ey + -E - y1 + E + Euy1 + Eu2 + -E - 2 1 2 2 2 2

u

+ E

EF +

F2 4

(3.16)

16

CHAPTER 3. INFINITE SYSTEM leaves only u-dependent terms with resulting DE for u given by du 1 F = Euy1 + Eu2 + -E - dt 2 2 This is a Bernoulli equation in the form du - (Q + 2y1 R)u = Ru2 dt
1 with R = 2 E and Q = (-E - F 2

3.5. EXACT SOLUTION

u

).
1 u

Hence, to solve we use the substitution w =

to get:

dw + (Q + 2y1 R)w = -R dt   E+ dw  F  + -E - + 2  dt 2 dw + dt
F 2

+ E F2 4

EF +

F2 4



 1  E w = - 1 E 2 2



EF +

1 w=- E 2
EF + F 4
2

This is a linear DE, so use the Integrating Factor I.F. = e e
EF + F 4
2

t

: 1 =- E 2 e
EF + F 4
2

t

dw + dt d dt

EF +

F2 4
2

e

EF + F 4

2

t

w

t



w e

EF + F 4

t

1 =- E 2

e
2

EF + F 4

2

t

 we

EF + F 4

2

t

=

Ee -2

EF + F 4

t

+C EF +
F2 4

w= -2  1 = u -2

E EF + E EF +
F2 4
2

+
F2 4

C e
EF + F 4
2

t

+ e
t

C
EF + F 4
2

t

-2e u= -2C

EF + F 4

EF +

F2 4
2

(3.17)
t

EF +

F2 4

+ Ee

EF + F 4

17

CHAPTER 3. INFINITE SYSTEM To find the constant of integration C , apply the initial condition u(0): -2 u|t=0 = -2 C Since a = y1 + u from (3.15), a|t=0 = 0  (y1 + u)|t=0 = 0
F 2 F2 4

3.5. EXACT SOLUTION

EF + EF +

F2 4

(3.18) +E

F2 4

(3.19)

E+ 

+ E 

EF +

+ u|t=0 = 0
F2 4

E+

 u|t=0 = -  Substituting for u|t=0 from (3.18) gives -2  -2C which can be used to solve for C : 2E C= -2 EF +
F2 4

F 2

+ E

EF +

 

EF + EF +

F2 4

 = -

E+

F 2

+ E

EF +

F2 4

 

F2 4

+E

EF +

F2 4

-E E+ E+
F 2

F 2

+

EF + EF +
F2 4

F2 4

(3.20) +

Substituting the value of C into equation (3.17), -2e  u(t) = - E2 +
EF 2 EF + F 4
2

t

EF + +E

F2 4

E+

F 2
2

+
t

EF + E+

F2 4 F2 4

-E

EF +

F2 4

e

EF + F 4

F 2

+

EF +

Thus, the solution for a(t) = y1 + u(t) is

18

CHAPTER 3. INFINITE SYSTEM

3.5. EXACT SOLUTION

(E + a(t) =

F 2

)+ E

EF +

F2 4

2 e + E2 +
EF 2

EF + F 4

2

t

EF + -E e

F2 4

E+
2

F 2 t

+

EF + E+
F 2

F2 4

-E
2

EF +

F2 4

EF + F 4

+

EF +

F2 4

(3.21) giving the solution for A(t) = (1 - a(t)) as

 A(t) = 1 -

(E +

F 2

)+ E

EF +

F2 4

2 e - E2 + From,
EF 2

EF + F 4

2

t

2 EF + -E e
F2 4

E+
2

F 2 t

+

EF + E+
F 2

F2 4

-E

EF +

F2 4

EF + F 4

+

EF +

F2 4

    

Ck (t) = A(t)a(t)k-1

  Ck (t) = A(t)a(t)k-1 = 1 -

(E +

F 2

)+ E

EF +

F2 4

2 e - E2 +  × (E +
F 2 EF 2

EF + F 4

2

t

2 EF + -E e
F2 4

E+
2

F 2 t

+

EF + E+
F 2

F2 4

-E

EF +
F2 4

F2 4

EF + F 4

+

EF +

F2 4

    

)+ E

EF +

2 e + E2 +
EF 2

EF + F 4

2

t

k-1 EF + -E e
F2 4

E+
2

F 2 t

+

EF + E+
F 2

F2 4

-E

EF +

F2 4

EF + F 4

+

EF +

F2 4

    

(3.22)

which is the solution to the aggregation-breakup system with constant reaction rates E ,F and monomer-only initial condition for the infinite system. Taking F  0 in this solution gives the aggregation solution from the previous section, which can be 19

CHAPTER 3. INFINITE SYSTEM
EF + F 4
2

3.5. EXACT SOLUTION

seen as follows: Apply the Taylor's series approximation for the term e EF + t+ 2!
F2 4

t

as

2

e

EF + F 4

2

t

=1+

F2 EF + 4

t2 + ...... (3.23)

in the equation (3.21) to get (E + a(t) =
F 2

)+ E

EF +

F2 4

2 1+ + E2 +
EF 2

EF + EF +
F2 4

F2 4

t + O(t2 )

EF +
F2 4 t

F2 4

E+

F 2

+

EF +
EF 2

F2 4

-E

- 1+

EF +

+ O(t2 )

E2 +

+E

EF +

F2 4

(E + a(t) =

F 2

)+ E

EF +

F2 4 3

(2E + F ) EF + + -2E

F2 4

+ 2Et EF +
F2 4

F2 4

+ F EF +
F2 4

F2 4

t + 2 EF + EF +
F2 4

F2 4

+

EF +
F2 4

F2 4

t + O(t2 )

EF +

- E2

EF +

t-

EF 2

t - E EF +

t + O(t2 ) (3.24)

For F - 0, equation (3.24) becomes a(t) = 1 + 2E -2E - E 2 t 2 -2 - Et

a(t) = 1 + a(t) = giving the solution for A(t) = (1 - a(t)) as A(t) = Finally from,
2

Et 2 + Et

4 (2 + Et)
2

Ck (t) = A(t)a(t)k-1 Ck (t) = 4 (2 + Et)
2

Et 2 + Et

k-1

=

4E k-1 tk-1 (2 + Et)
k+1

which is the solution to the aggregating system with constant reaction rates E and monomer-only initial 20

CHAPTER 3. INFINITE SYSTEM

3.6. EXACT SOLUTION IN AGGREGATION

condition for the infinite case with no break-up (F = 0) from the previous section.

3.6

Exact solution in aggregation for non-zero initial concentration for all clusters

The exact solution (3.10) from Section 3.4 was for aggregating systems governed by the Smoluchowski differential equation that have an initial monomer concentration 1, and zero initial concentration for the other particle cluster sizes. We can also find an exact solution if we change the initial concentration for other particles to be non-zero, namely for Ck (0) = (1 - q )2 q k-1 for some 0  q < 1 [16], and it is derived here. Based on this initial condition for Ck , we have the initial condition a(0) = q , which from the equation (3.9) leads to 1 1 E (0) + C = 2 1-q C= 1 1-q

Hence using (3.9) leads to the solution for this new initial condition 1 1 1 = Et + 1-a 2 1-q  1 Et(1 - q ) + 2 = 1-a 2(1 - q ) 2(1 - q ) 2 + Et(1 - q ) 2(1 - q ) 2 + Et(1 - q ) 2(1 - q ) 2 + Et(1 - q )
2 2

1-a=

 a(t) = 1 - Thus

A(t) = (1 - a)2  A(t) = Finally Ck (t) = A(t) (a(t))
k -1



2(1 - q ) 2 + Et(1 - q )

1-

2(1 - q ) 2 + Et(1 - q )

k -1

.

which is the solution to the aggregating system with constant reaction rates E and non-zero initial condition for clusters of all sizes, in the infinite system.

21

CHAPTER 3. INFINITE SYSTEM

3.7. EXACT SOLUTION: AGGREGATION/FRAGMENTATION

3.7

Exact solution in aggregation and fragmentation with nonzero initial concentration

The exact solution (3.22) from Section 3.5 was for systems for which clusters can aggregate and break up, with an initial monomer concentration 1, and zero initial concentration for the other particle cluster sizes. Again, we can also find an exact solution if we change the initial concentration for other particles to be non-zero in this case, namely for Ck (0) = (1 - q )2 q k-1 for some 0  q < 1 [16], and it is derived here. Applying the initial condition a(0) = q in the equation (3.19) gives a|t=0 = q  (y1 + u)|t=0 = q

 u|t=0 = q - y1 E+ =q-
F 2

+ E

EF +

F2 4

qE - E -  u|t=0 = Equating the equations (3.25) and (3.18) qE - E -
F 2

F 2

- E

EF +

F2 4

(3.25)

- E

EF +

F2 4

-2 = -2C
F2 4

EF + EF +

F2 4

F2 4

+E

qE - E - 

F 2

- E

EF +

2 = 2C

EF + EF +

F2 4

F2 4
2

-E

 2C

2E EF + F F2 4 -E = EF + 4 F qE - E - 2 - EF + E qE - E -
F 2

F2 4

+
F 2

EF + -

F2 4 F2 4

C= 2 EF +
F2 4

qE - E -

EF +

22

CHAPTER 3. INFINITE SYSTEM

3.7. EXACT SOLUTION: AGGREGATION/FRAGMENTATION

Putting this value of C in equation (3.17) gives 2e u(t) = E qE - E -
F 2 EF + F 4
2

t

EF +
F2 4

F2 4

qE - E -
F 2

F 2

-

EF +
F2 4

F2 4 EF + F 4
2

+

EF +

- E qE - E -

-

EF +

e

t

Since a(t) = y1 + u(t) the solution for a(t) is

(E + a(t) =

F 2

)+ E

EF +

F2 4

(3.26)
2

2e + E qE - E - so that
F 2

EF + F 4

t

EF +
F2 4

F2 4

qE - E -
F 2

F 2

-

EF +
F2 4

F2 4 EF + F 4
2

+

EF +

- E qE - E -

-

EF +

e

t

A(t) = (1 - a(t)) gives  A(t) = 1 - (E +
F 2

2

)+ E

EF +

F2 4

2e - E qE - E - Thus the solution is
F 2

EF + F 4

2

t

2 EF +
F2 4 F2 4

qE - E -
F 2

F 2

-

EF +
F2 4

F2 4 EF + F 4
2

+

EF +

- E qE - E -

-

EF +

e

   t

Ck (t) = A(t)a(t)k-1

23

CHAPTER 3. INFINITE SYSTEM  = 1 -
F 2

3.7. EXACT SOLUTION: AGGREGATION/FRAGMENTATION
F2 4

(E +

)+ E

EF +

2e - E qE - E -  × (E +
F 2 F 2

EF + F 4

2

t

2 EF +
F2 4 F2 4

qE - E -
F 2

F 2

-

EF +
F2 4

F2 4 EF + F 4
2

+

EF +
F2 4

- E qE - E -

-

EF +

e

   t

)+ E 2e

EF +

EF + F 4

2

t

k-1 EF +
F2 4 F2 4

qE - E -
F 2

F 2

-

EF +
F2 4

F2 4 EF + F 4
2

+ E qE - E -
F 2

+

EF +

- E qE - E -

-

EF +

e

   t

which is the solution to the aggregating system with break-up and constant reaction rates E , F and non-zero initial condition for all cluster sizes in the infinite system. Taking F  0 in this solution gives the aggregation solution from the previous section, which can be seen as follows: Apply the Taylor's series approximation for the term e EF + t+ 2!
F2 4 EF + F 4
2

t

as

2

e

2 EF + F 4

t

=1+

F2 EF + 4

t2 + ...... (3.27)

(E + a(t) =

F 2

)+ E

EF +

F2 4

2 1+ + E qE - E -
F 2

EF + EF +

F2 4

t + O(t2 )

EF +
F 2

F2 4

qE - E -
F2 4

F 2

-

EF + EF +

F2 4 F2 4

+

F2 4

- E qE - E -

-

EF +

1+

t + O(t2 )

(E + a(t) = EF + +
F2 4

F 2

)+ E

EF +

F2 4

2(q - 1)E - F - 2 EF +
F2 4

EF +

F2 4

+ 2(q - 1)E - F - 2
F 2

EF +
F2 4

F2 4

EF +

F2 4

t + O(t2 )

2E - E qE - E -

-

EF +

t + O(t2 )

24

CHAPTER 3. INFINITE SYSTEM

3.7. EXACT SOLUTION: AGGREGATION/FRAGMENTATION

(E + a(t) =

F 2

)+ E

EF +

F2 4

2(q - 1)E - F - 2 +

EF +

F2 4

+ 2(q - 1)E - F - 2
F 2

EF +
F2 4

F2 4

EF +

F2 4

t + O(t2 ) (3.28)

2E - E qE - E -

-

EF +

t + O(t2 )

Taking the limit F - 0 equation (3.28) becomes, a(t) = 1 + 2qE - 2E 2E - qE 2 t + E 2 t 2q - 2 2 - qEt + Et 2(1 - q ) 2 + Et(1 - q )

a(t) = 1 + a(t) = 1 -
2

giving the solution for A(t) = (1 - a(t)) in the limit as A(t) = Finally from, Ck (t) = A(t) (a(t))
k-1

2(1 - q ) 2 + Et(1 - q )
2

2



2(1 - q ) 2 + Et(1 - q )

1-

2(1 - q ) 2 + Et(1 - q )

k -1

we get the solution from Section 3.6, which is the solution to the aggregating system with constant reaction rates E and no break-up (F = 0) with non-zero initial condition for all cluster sizes in the infinite system.

25

Chapter 4

Finite System
4.1 Aggregation-Fragmentation System with Maximum Cluster Size
In the finite system compared to the infinite system, one assumes that there is a maximum sized cluster that can form. The Smoluchowski equations for coagulation-fragmentation for a finite system with maximum cluster size N , say, leads to the finite system of differential equations for the concentration Ck (t) of clusters of size k at time t which is given by: 1 dCk = dt 2
N -k N

Kij Ci Cj - Ck
i+j =k i=1

Kik Ci +
i=k+1

1 Wik Ci - Ck 2

k -1

Wki ,
i=1

k = 1, 2, . . . , N

Note that in this equation, the only difference from the Smoluchowski equation in the previous chapter is that the sums on the right-hand side have a finite upper limit rather than . As an example, we write down the finite system equations for a maximum cluster size N = 5. In this case, the time evolution for C1 to C5 are listed below: dC1 2 = -K11 C1 - K21 C1 C2 - K31 C1 C3 - K41 C1 C4 + W21 C2 + W31 C3 + W41 C4 + W51 C5 dt dC2 1 1 2 2 = K11 C1 - K12 C1 C2 - K22 C2 - K32 C2 C3 + W32 C3 + W42 C4 + W52 C5 - W21 C2 dt 2 2

dC3 1 1 1 1 = K12 C1 C2 + K21 C2 C1 - K13 C1 C3 - K23 C2 C3 + W43 C4 + W53 C5 - W31 C3 - W32 C3 dt 2 2 2 2

26

CHAPTER 4. FINITE SYSTEM 4.2. CLUSTER CONCENTRATION WITH AGGREGATION ONLY

dC4 1 1 1 1 1 1 2 = K22 C2 + K31 C1 C3 + K13 C3 C1 - K14 C1 C4 + W54 C5 - W41 C4 - W42 C4 - W43 C4 dt 2 2 2 2 2 2

1 1 1 1 1 1 1 1 dC5 = K23 C2 C3 + K32 C3 C2 + K14 C1 C4 + K41 C4 C1 - W51 C5 - W52 C5 - W53 C5 - W54 C5 dt 2 2 2 2 2 2 2 2 In the next sections, we demonstrate the general behaviour of solutions in this finite system compared to the infinite system.

4.2

Cluster concentration with aggregation only

Here we compare the finite system solution for various values of N to the exact solution for the infinite system as given in Chapter 3 for the aggregating system only. For demonstration purposes we take Kij = 8, and Wij = 0 and consider monomer-only initial condition for various values of N , and different initial condition for N = 5. From Figures 4.1, 4.3, and 4.4, we conclude that there are some differences in the N = 5 curves compared to the infinite system (Figure 4.1), while N = 10 and N = 20 curves agree well with the infinite system. Thus, it is feasible to consider a finite system with a max cluster size of 10 for this scenario. From Figure 4.2 it can be seen that the agreement between the infinite system exact solution and the finite system numerical solution may not be as good when the monomer-only initial condition is changed to one where there are clusters of all sizes present initially.

4.3

Cluster concentration with aggregation and fragmentation

Here we compare the finite system solution for various values of N to the exact solution for the infinite system when there is aggregation and break-up. For demonstration purposes we take Kij = 8, and Wij = 5 with monomer-only initial condition for N = 5, 10 and 20. We consider the monomer-only initial condition in Figures 4.5, 4.7 and 4.8, and demonstrate a non-zero initial condition for all cluster sizes in the N = 5 case in Figure 4.6. From Figures 4.5, 4.7 and 4.8, we conclude that the simulation comparing the ODE for the finite system to the exact solution for the infinite system there is very good agreement when N is as small as 5 (Figure 4.5), and there is no distinguishable difference between the pairs of curves for all cluster sizes when N = 10 and N = 20. In these figures, the initial condition is the monomer-only initial condition. When the initial condition includes clusters of all sizes, then the agreement is not as good (see Figure 4.6).

27

CHAPTER 4. FINITE SYSTEM

4.3. CLUSTER CONCENTRATION

1 0.9 0.8 0.7 0.6

Concentration over time for N=5
Exact:C
1

ODE-numerical:C 1 Exact:C 3 ODE-numerical:C 3 Exact:C 5 ODE-numerical:C 5

Ck

0.5 0.4 0.3 0.2 0.1 0 0 1 2 3 4 5 6 7 8 9 10

time
Figure 4.1: Simulation of 1st, 3rd, and 5th cluster concentration of Numerical (N = 5) vs Exact solution (infinite system) for Kij = 8, Wij = 0 with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2.

28

CHAPTER 4. FINITE SYSTEM

4.3. CLUSTER CONCENTRATION

0.07

Concentration over time for N=5
Exact:C 1 ODE-numerical:C 1 Exact:C 3 ODE-numerical:C 3 Exact:C 5 ODE-numerical:C 5

0.06

0.05

0.04

Ck
0.03 0.02 0.01 0 0 1 2 3 4 5 6 7 8 9 10

time
Figure 4.2: Simulation of 1st, 3rd, and 5th cluster concentration of Numerical (N = 5) vs Exact solution (infinite system) for Kij = 8, Wij = 0 with the initial concentration C1 (0) = (1 - q )2 , C3 (0) = q 2 (1 - q )2 and C5 (0) = q 4 (1 - q )2 for q = 0.75.

29

CHAPTER 4. FINITE SYSTEM

4.3. CLUSTER CONCENTRATION

1 0.9 0.8 0.7 0.6

Concentration over time for N=10
Exact:C 1 ODE-numerical:C 1 Exact:C 5 ODE-numerical:C 5 Exact:C 10 ODE-numerical:C 10

Ck

0.5 0.4 0.3 0.2 0.1 0 0 1 2 3 4 5 6 7 8 9 10

time
Figure 4.3: Simulation of 1st, 5th and 10th cluster concentration of Numerical (N = 10) vs Exact solution (infinite system) for Kij = 8, Wij = 0 with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2.

30

CHAPTER 4. FINITE SYSTEM

4.3. CLUSTER CONCENTRATION

1 0.9 0.8 0.7 0.6

Concentration over time for N=20
Exact:C
1 1

ODE-numerical:C Exact:C 5

ODE-numerical:C 5 Exact:C
10 10

ODE-numerical:C Exact:C 20

Ck

0.5 0.4 0.3 0.2 0.1 0 0 1 2 3 4 5 6 7

ODE-numerical:C 20

8

9

10

time
Figure 4.4: Simulation of 1st, 5th, 10th, and 20th cluster concentration of Numerical (N = 20) vs Exact solution (infinite system) for Kij = 8, Wij = 0 with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2.

31

CHAPTER 4. FINITE SYSTEM

4.3. CLUSTER CONCENTRATION

1 0.9 0.8 0.7 0.6

Concentration over time for N=5
Exact:C 1 ODE-numerical:C 1 Exact:C 3 ODE-numerical:C 3 Exact:C 5 ODE-numerical:C 5

Ck

0.5 0.4 0.3 0.2 0.1 0 0 1 2 3 4 5 6 7 8 9 10

time
Figure 4.5: Simulation of 1st, 3rd, and 5th cluster concentration of Numerical (N = 5) vs Exact solution (infinite system) for Kij = 8, Wij = 5 with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2.

32

CHAPTER 4. FINITE SYSTEM

4.3. CLUSTER CONCENTRATION

1 0.9 0.8 0.7 0.6

Concentration over time for N=5
Exact:C
1

ODE-numerical:C 1 Exact:C
3

ODE-numerical:C 3 Exact:C
5

ODE-numerical:C 5

Ck

0.5 0.4 0.3 0.2 0.1 0 0 1 2 3 4 5 6 7 8 9 10

time
Figure 4.6: Simulation of 1st, 3rd, and 5th cluster concentration of Numerical (N = 5) vs Exact solution (infinite system) for Kij = 8, Wij = 5 with the initial concentration C1 (0) = (1 - q )2 , C3 (0) = q 2 (1 - q )2 and C5 (0) = q 4 (1 - q )2 for q = 0.75.

33

CHAPTER 4. FINITE SYSTEM

4.3. CLUSTER CONCENTRATION

1 0.9 0.8 0.7 0.6

Concentration over time for N=10
Exact:C
1

ODE-numerical:C 1 Exact:C
5

ODE-numerical:C 5 Exact:C
10

ODE-numerical:C 10

Ck

0.5 0.4 0.3 0.2 0.1 0 0 1 2 3 4 5 6 7 8 9 10

time
Figure 4.7: Simulation of 1st, 5th and 10th cluster concentration of Numerical (N = 10) vs Exact solution (infinite system) for Kij = 8, Wij = 5 with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2.

34

CHAPTER 4. FINITE SYSTEM

4.3. CLUSTER CONCENTRATION

1 0.9 0.8 0.7 0.6

Concentration over time for N=20
Exact:C 1 ODE-numerical:C 1 Exact:C 5 ODE-numerical:C 5 Exact:C 10 ODE-numerical:C 10 Exact:C 20 ODE-numerical:C 20

Ck

0.5 0.4 0.3 0.2 0.1 0 0 1 2 3 4 5 6 7

8

9

10

time
Figure 4.8: Simulation of 1st, 5th, 10th, and 20th cluster concentration of Numerical (N = 20) vs Exact solution (infinite system) for Kij = 8, Wij = 5 with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2.

35

CHAPTER 4. FINITE SYSTEM

4.4. CLUSTER CONCENTRATION E = F

1.2

Concentration over time for N=5
Exact:C 1 ODE-numerical:C
1

1

Exact:C

3

ODE-numerical:C 3 Exact:C

0.8

5

ODE-numerical:C 5

Ck

0.6

0.4

0.2

0 0 1 2 3 4 5 6 7 8 9 10

time
Figure 4.9: Simulation of 1st, 3rd, and 5th cluster concentration of Numerical (N = 5) vs Exact solution (infinite system) for Kij = 0.8, Wij = 0.8 (E = F ) with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2.

4.4

Cluster concentration for equal aggregation and fragmentation

Here we compare the finite system solution for various values of N to the exact solution for the infinite system for equal aggregation and break-up rates . For demonstration purposes we take Kij = 0.8, and Wij = 0.8 with monomer-only initial condition for maximum cluster size N = 5, 10, 20 and non-zero initial condition for a finite system with N = 5. From Figures 4.9, 4.11 and 4.12, we conclude that there is essentially no distinguishable difference between the ODE solution for the finite system and the exact solution for the infinite system for this monomer-only initial condition. It can be noted that the concentration of monomers decreases and clusters of size 5 increases slightly, but the rest of the cluster sizes are essentially unchanged and there is no major variation.

36

CHAPTER 4. FINITE SYSTEM

4.4. CLUSTER CONCENTRATION E = F

1 0.9 0.8 0.7 0.6

Concentration over time for N=5
Exact:C 1 ODE-numerical:C 1 Exact:C 3 ODE-numerical:C 3 Exact:C 5 ODE-numerical:C 5

Ck

0.5 0.4 0.3 0.2 0.1 0 0 1 2 3 4 5 6 7 8 9 10

time
Figure 4.10: Simulation of 1st, 3rd, and 5th cluster concentration of Numerical (N = 5) vs Exact solution (infinite system) for Kij = 0.8, Wij = 0.8 (E = F ) with the initial concentration C1 (0) = (1 - q )2 , C3 (0) = q 2 (1 - q )2 and C5 (0) = q 4 (1 - q )2 for q = 0.75.

37

CHAPTER 4. FINITE SYSTEM

4.4. CLUSTER CONCENTRATION E = F

1 0.9 0.8 0.7 0.6

Concentration over time for N=10
Exact:C 1 ODE-numerical:C 1 Exact:C 5 ODE-numerical:C 5 Exact:C 10 ODE-numerical:C 10

Ck

0.5 0.4 0.3 0.2 0.1 0 0 1 2 3 4 5 6 7 8 9 10

time
Figure 4.11: Simulation of 1st, 5th and 10th cluster concentration of Numerical (N = 10) vs Exact solution (infinite system) for Kij = 0.8, Wij = 0.8 (E = F ) with the initial condition C1 (0) = 1 and Ck (0) = 0,for k  2.

38

CHAPTER 4. FINITE SYSTEM

4.4. CLUSTER CONCENTRATION E = F

1 0.9 0.8 0.7 0.6

Concentration over time for N=20
Exact:C 1 ODE-numerical:C 1 Exact:C 5 ODE-numerical:C 5 Exact:C 10 ODE-numerical:C 10 Exact:C 20 ODE-numerical:C
20

Ck

0.5 0.4 0.3 0.2 0.1 0 0 1 2 3 4 5 6 7

8

9

10

time
Figure 4.12: Simulation of 1st, 5th, 10th, and 20th cluster concentration of Numerical (N = 20) vs Exact solution (infinite system) for Kij = 0.8, Wij = 0.8 (E = F ) with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2.

39

CHAPTER 4. FINITE SYSTEM

4.5. CLUSTER CONCENTRATION E = 2F

In the case for non-zero initial concentration for all clusters, Figure 4.10 we see once again that there are differences between the finite and infinite system solutions.

4.5

Cluster concentration for aggregation and fragmentation when E=2F

In Figures 4.13 to 4.16 we compare the finite system solution for various values of N with the exact solution for the infinite system when the aggregation rate is twice the break-up value. For demonstration purposes we take Kij = 0.8, and Wij = 0.4 with monomer-only initial condition for maximum cluster sizes N = 5, 10, 20 (Fig. 4.13, 4.15 and 4.16) and also apply different initial condition when the maximum cluster size is N = 5 (Fig. 4.14). There is very good agreement between the finite system solution and that for the infinite system when N = 5 (Figure 4.13) and essentially no difference when N = 10 and N = 20 (Figures 4.15 and 4.16) when there are only monomers present initially. Once again when there are initial concentrations of all clusters, (Fig. 4.14) the agreement is not as good as for the monomer-only initial condition.

4.6

Cluster concentration for aggregation and fragmentation rate when F=2E

Here we compare the finite system solution for various values of N to the exact solution for the infinite system when the break-up rate is twice the aggregation rate. For demonstration purposes we take Kij = 0.6, and Wij = 1.2 with monomer-only initial condition for systems with maximum cluster size N = 5, 10, 20 and for non-zero initial condition with maximum cluster size N = 5. From Figure 4.17 we see that the curve for the 1st cluster concentration decreases for a small time and then is unchanged while the 3rd cluster concentration increases before it reaches its equilibrium value. However, the 5th cluster concentration is very small in this case. Additionally, the 5th cluster concentration and all larger clusters in the larger systems are very small for all time (Fig. 4.19, 4.20). In this particular scenario, the exact solution for the infinite system and the finite system solution already agree well for a very small system size N = 5. Changing the initial condition leads to some disagreement between the infinite system solution and the finite (N = 5) case as can be seen in Figure 4.18.

40

CHAPTER 4. FINITE SYSTEM

4.6. CLUSTER CONCENTRATION F = 2E

1 0.9 0.8 0.7 0.6

Concentration over time for N=5
Exact:C
1

ODE-numerical:C 1 Exact:C
3

ODE-numerical:C 3 Exact:C
5

ODE-numerical:C 5

Ck

0.5 0.4 0.3 0.2 0.1 0 0 1 2 3 4 5 6 7 8 9 10

time
Figure 4.13: Simulation of 1st, 3rd and 5th cluster concentration of Numerical (N = 5) vs Exact solution (infinite system) for Kij = 0.8, Wij = 0.4 (E = 2F ) with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2.

41

CHAPTER 4. FINITE SYSTEM

4.6. CLUSTER CONCENTRATION F = 2E

1 0.9 0.8 0.7 0.6

Concentration over time for N=5
Exact:C 1 ODE-numerical:C 1 Exact:C 3 ODE-numerical:C 3 Exact:C 5 ODE-numerical:C 5

Ck

0.5 0.4 0.3 0.2 0.1 0 0 1 2 3 4 5 6 7 8 9 10

time
Figure 4.14: Simulation of 1st, 3rd, and 5th cluster concentration of Numerical (N = 5) vs Exact solution (infinite system) for Kij = 0.8, Wij = 0.4 (E = 2F ) with the initial concentration C1 (0) = (1 - q )2 , C3 (0) = q 2 (1 - q )2 and C5 (0) = q 4 (1 - q )2 for q = 0.75.

42

CHAPTER 4. FINITE SYSTEM

4.6. CLUSTER CONCENTRATION F = 2E

Concentration over time for N=10 1 Exact:C 0.9 0.8 0.7 0.6
k

1 1

ODE-numerical:C Exact:C
5

ODE-numerical:C Exact:C
10

5

ODE-numerical:C

10

C

0.5 0.4 0.3 0.2 0.1 0 0 1 2 3 4 5 time 6 7 8 9 10

Figure 4.15: Simulation of 1st, 5th and 10th cluster concentration of Numerical (N = 10) vs Exact solution (infinite system) for Kij = 0.8, Wij = 0.4 (E = 2F ) with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2.

43

CHAPTER 4. FINITE SYSTEM

4.6. CLUSTER CONCENTRATION F = 2E

1 0.9 0.8 0.7 0.6

Concentration over time for N=20
Exact:C
1

ODE-numerical:C 1 Exact:C 5 ODE-numerical:C 5 Exact:C 10 ODE-numerical:C 10 Exact:C 20 ODE-numerical:C 20

Ck

0.5 0.4 0.3 0.2 0.1 0 0 1 2 3 4 5 6 7

8

9

10

time
Figure 4.16: Simulation of 1st, 5th, 10th and 20th cluster concentration of Numerical (N = 20) vs Exact solution (infinite system) for Kij = 0.8, Wij = 0.4 (E = 2F ) with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2.

44

CHAPTER 4. FINITE SYSTEM

4.6. CLUSTER CONCENTRATION F = 2E

1.2

Concentration over time for N=5
Exact:C 1 ODE-numerical:C 1 Exact:C 3 ODE-numerical:C 3 Exact:C 5 ODE-numerical:C 5

1

0.8

Ck

0.6

0.4

0.2

0 0 1 2 3 4 5 6 7 8 9 10

time
Figure 4.17: Simulation of 1st, 3rd, and 5th cluster concentration of Numerical (N = 5) vs Exact solution (infinite system) for Kij = 0.6, Wij = 1.2 (F = 2E ) with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2.

45

CHAPTER 4. FINITE SYSTEM

4.6. CLUSTER CONCENTRATION F = 2E

1 0.9 0.8 0.7 0.6

Concentration over time for N=5
Exact:C 1 ODE-numerical:C Exact:C 3 ODE-numerical:C Exact:C
5 3 1

ODE-numerical:C 5

Ck

0.5 0.4 0.3 0.2 0.1 0 0 1 2 3 4 5 6 7 8 9 10

time
Figure 4.18: Simulation of 1st, 3rd, and 5th cluster concentration of Numerical (N = 5) vs Exact solution (infinite system) for Kij = 0.6, Wij = 1.2 (F = 2E ) with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2.

46

CHAPTER 4. FINITE SYSTEM

4.6. CLUSTER CONCENTRATION F = 2E

1 0.9 0.8 0.7 0.6

Concentration over time for N=10
Exact:C
1

ODE-numerical:C 1 Exact:C 5 ODE-numerical:C 5 Exact:C
10

ODE-numerical:C 10

Ck

0.5 0.4 0.3 0.2 0.1 0 0 1 2 3 4 5 6 7 8 9 10

time
Figure 4.19: Simulation of 1st, 5th and 10th cluster concentration of Numerical (N = 10) vs Exact solution (infinite system) for Kij = 0.6, Wij = 1.2 (F = 2E ) with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2.

47

CHAPTER 4. FINITE SYSTEM

4.6. CLUSTER CONCENTRATION F = 2E

1 0.9 0.8 0.7 0.6

Concentration over time for N=20

Ck

0.5 0.4 0.3 0.2 0.1 0 0 1

Exact:C 1 ODE-numerical:C 1 Exact:C 5 ODE-numerical:C 5 Exact:C 10 ODE-numerical:C 10 Exact:C 20 ODE-numerical:C 20

2

3

4

5

6

7

8

9

10

time
Figure 4.20: Simulation of 1st, 5th, 10th, and 20th cluster concentration of Numerical (N = 20) vs Exact solution (infinite system) for Kij = 0.6, Wij = 1.2 (F = 2E ) with the initial condition C1 (0) = 1 and Ck (0) = 0, for k  2.

48

Chapter 5

Stochastic Simulations
Dimensionless RMPC simulations are performed on a 3-d cubic domain with Lx = 50 = Ly = Lz and x = y = z = 1, giving Nc = 503 cells of unit volume. For all our RMPC simulations we have a maximum cluster size of N = 3 so that the average cell density is  = C1 + C2 + C3 giving a total number of particles in the system as Lx Ly Lz . Additionally, we take the mass of a particle to be m = 1, the system energy kB T /m = 0.3, and fixed time step  = 1 as is commonly used. In each simulation, we compare the stochastic RMPC results with the finite system (N = 3) ODE solution from Chapter 4, as well as the infinite system solution from Chapter 3 where possible, and take 500 time steps, at which point the systems have reached an equilibrium state. The reaction mechanism is implemented as follows: for a given particle of species k , pick one of the possible reactions for that chemical species randomly, and then change its species Kik type based on the reactive mechanism. For example, in the aggregation mechanism Ai + Ak Ai+k , the - particle of species type k becomes an (i + k )-mer if another randomly drawn number is less than Kik n i. For the numerical implementation, the particles are placed uniformly in the cubic domain, randomly assigned velocities from a Maxwell-Boltzmann velocity distribution with zero mean and temperature T . Both monomer-only initial conditions and non-zero initial condition for all cluster sizes (monomers, dimers and trimers for N = 3) as discussed in the previous chapters are considered. In the following sections we include the exact solution (infinite system, Chapter 3), the RMPC simulation, and the numerical ODE solution (finite system, Chapter 4) for six different cases:

· Case 1: initial monomer concentration of 1 for fixed rate of aggregation Kij = E = 0.1 with varying fixed rates of break-up · Case 2: initial monomer concentration of 1 for fixed rate of break-up Wij = F = 0.1 with varying fixed rates of aggregation · Case 3: initial monomer, dimer and trimer concentration for fixed rate of aggregation Kij = E = 0.1 and break-up Wij = F = 0.1 as initial concentrations change (varying q ) 49

CHAPTER 5. STOCHASTIC SIMULATIONS

5.1. CASE 1: VARYING BREAK-UP RATES

· Case 4: initial monomer, dimer and trimer concentration for fixed rate of aggregation Kij = E = 0.1 and break-up Wij = F = 0.01 as initial concentrations change (varying q ) · Case 5: initial monomer, dimer and trimer concentration for fixed rate of aggregation Kij = E = 0.01 and break-up Wij = F = 0.1 as initial concentrations change (varying q ) · Case 6: initial monomer, dimer and trimer concentration for aggregation rates K11 = 0.1, K12 = 0.001 = K21 and break-up rates W2 = 0.001, W3 = 0.1 as initial concentrations change (varying q )

5.1

Case 1: Effect of varying break-up rate

We consider the time evolution of the system with initial monomer-only concentration of 1. We take  = 1 so that initially there are 12500 particles in the system. We fix the aggregation rate Kij = E = 0.1 and vary the break-up rate Wij = F = 0.01, 0.05 and 0.1. The time evolution of the monomers C1 , dimers C2 and trimers C3 are shown in Figures 5.1, 5.2 and 5.3 respectively . From Figures 5.1, 5.2 and 5.3, it is observed that there is nice agreement only for the monomer concentration when varying the break-up rates F . Additionally, for the smallest F value (F = 0.01), the stochastic results give best agreement with the numerical ODE solution. All curves (RMPC, ODE-numerical and Exact) predict lower equilibrium concentrations for C1 , C2 and C3 as the break-up rate F decreases.

5.2

Case 2: Effect of varying aggregation rate

The time evolution of the system with initial monomer-only concentration of 1 is considered so that we again have  = 1 and 12500 particles in the system initially. We fix the break-up rates Wij = F = 0.1 and vary the aggregation rate Kij = E = 0.05, 0.01 and 0.1. The results are shown in Figures 5.4, 5.5 and 5.6. From Figures 5.4, 5.5 and 5.6, it is observed that there is fairly good agreement for the monomer and dimer concentrations. Additionally, for the smallest E value (E = 0.01), the infinite system gives the best agreement with the numerical ODE solution, and in this latter case, there is little difference between the numerical ODE solution (N = 3) and the RMPC results shown by the stochastic solution curve. All curves (RMPC, ODE-numerical and Exact) predict lower equilibrium concentrations for C2 and C3 as the aggregation rate decreases, while the equilibrium concentration for C1 increases.

5.3

Case 3: Effect of varying the initial condition, E = F = 0.1

Here we apply the initial concentration profile Ck = (1 - q )2 q k-1 , k  1, so that the initial monomer concentration is C1 = (1-q )2 , the initial dimer concentration is C2 = q (1-q )2 and initial trimer concentration is C3 = q 2 (1 - q )2 . We fix the aggregation rate at E = 0.1, and the break-up rate at F = 0.1 and consider the q values 0.25, 0.5 and 0.75. This gives resulting initial concentrations as follows: For q = 0.25 : C1 = 0.5625, C2 = 0.140 and C3 = 0.035,  = 0.7375 and the number of particles in the system is 92188. For

50

CHAPTER 5. STOCHASTIC SIMULATIONS

5.3. CASE 3: VARYING INITIAL CONDITION

1.2

Time Evolution of C1
Stochastic ODE-numerical Exact Stochastic ODE-numerical Exact Stochastic ODE-numerical Exact

1

0.8

C1

0.6

0.4

0.2

0 0 50 100 150 200 250 300 350 400 450 500

time
Figure 5.1: Time evolution of 1st cluster concentration of Exact, ODE and stochastic simulation for i) E = 0.1, F = 0.01 (red curves), ii) E = 0.1, F = 0.05 (black curves) and iii) E = 0.1, F = 0.1 (blue curves), with the initial condition C1 (0) = 1 and C2 (0) = C3 (0) = 0.

51

CHAPTER 5. STOCHASTIC SIMULATIONS

5.3. CASE 3: VARYING INITIAL CONDITION

0.35 0.3 0.25 0.2

Time Evolution of C2

C2

0.15 0.1 0.05 0 -0.05 0 50 100 150 200 250 300 350 400 450 500
Stochastic ODE-numerical Exact Stochastic ODE-numerical Exact Stochastic ODE-numerical Exact

time
Figure 5.2: Simulation of 2nd cluster concentration of Exact, ODE and stochastic solution vs time for (E = 0.1, F = 0.01(red)),(E = 0.1, F = 0.05(black))and (E = 0.1, F = 0.1(blue)) with the initial condition C1 (0) = 1 and C2 (0) = C3 (0) = 0.

52

CHAPTER 5. STOCHASTIC SIMULATIONS

5.3. CASE 3: VARYING INITIAL CONDITION

0.7

Time Evolution of C3
Stochastic ODE-numerical Exact Stochastic ODE-numerical Exact Stochastic ODE-numerical Exact

0.6

0.5

0.4

C3
0.3 0.2 0.1 0 0 50 100 150 200 250 300 350 400 450 500

time
Figure 5.3: Simulation of 3rd cluster concentration of Exact, ODE and stochastic solution vs time for (E = 0.1, F = 0.01(red)),(E = 0.1, F = 0.05(black))and (E = 0.1, F = 0.1(blue)) with the initial condition C1 (0) = 1 and C2 (0) = C3 (0) = 0.

53

CHAPTER 5. STOCHASTIC SIMULATIONS

5.3. CASE 3: VARYING INITIAL CONDITION

1.1 1 0.9 0.8

Time Evolution for C1
Stochastic ODE-numerical Exact Stochastic ODE-numerical Exact Stochastic ODE-numerical Exact

C1

0.7 0.6 0.5 0.4 0.3 0 50 100 150 200 250 300 350 400 450 500

time
Figure 5.4: Simulation of 1st cluster concentration of Exact, ODE and stochastic solution vs time for (F = 0.1, E = 0.05(red)),(F = 0.1, E = 0.01(black))and (F = 0.1, E = 0.1(blue)) with the initial condition C1 (0) = 1 and C2 (0) = C3 (0) = 0.

54

CHAPTER 5. STOCHASTIC SIMULATIONS

5.3. CASE 3: VARYING INITIAL CONDITION

0.3

Time Evolution for C2

0.25

0.2

0.15

C2
0.1

0.05

0

-0.05 0 50 100 150 200 250 300

Stochastic ODE-numerical Exact Stochastic ODE-numerical Exact Stochastic ODE-numerical Exact

350

400

450

500

time
Figure 5.5: Simulation of 2nd cluster concentration of Exact, ODE and stochastic solution vs time for (F = 0.1, E = 0.05(red)),(F = 0.1, E = 0.01(black))and (F = 0.1, E = 0.1(blue)) with the initial condition C1 (0) = 1 and C2 (0) = C3 (0) = 0.

55

CHAPTER 5. STOCHASTIC SIMULATIONS

5.3. CASE 3: VARYING INITIAL CONDITION

0.3

Time Evolution for C3
Stochastic ODE-numerical Exact Stochastic ODE-numerical Exact Stochastic ODE-numerical Exact

0.25

0.2

C3

0.15

0.1

0.05

0 0 50 100 150 200 250 300 350 400 450 500

time
Figure 5.6: Simulation of 3rd cluster concentration of Exact, ODE and stochastic solution vs time for (F = 0.1, E = 0.05(red)),(F = 0.1, E = 0.01(black))and (F = 0.1, E = 0.1(blue)) with the initial condition C1 (0) = 1 and C2 (0) = C3 (0) = 0.

56

CHAPTER 5. STOCHASTIC SIMULATIONS

5.3. CASE 3: VARYING INITIAL CONDITION

0.6

Time Evolution for C 1

0.5

0.4

0.3

0.2

Stochastic(q=0.25) ODE-numerical(q=0.25) Exact(q=0.25) Stochastic(q=0.5) ODE-numerical(q=0.5) Exact(q=0.5) Stochastic(q=0.75) ODE-numerical(q=0.75) Exact(q=0.75)

C1

0.1

0 0 100 200 300 400 500

time
Figure 5.7: Simulation of 1st cluster concentration of Exact, ODE and stochastic solution vs time at E = F = 0.1 with the initial concentration C1 (0) = (1 - q )2 , C2 (0) = q (1 - q )2 and C3 (0) = q 2 (1 - q )2 for different values of q . q = 0.5 : C1 = 0.25, C2 = 0.125 and C3 = 0.0625,  = 0.4375 and 54688 particles in the system. For q = 0.75 : C1 = 0.0625, C2 = 0.046 and C3 = 0.035,  = 0.1435 and 17938 particles in the system. From Figures 5.7, 5.8 and 5.9, one key observation is that the infinite solution curves for all three cluster sizes tend to an equilibrium value that is independent of the initial condition (eg. all q values give the same equilibrium concentration). This however, is not the case for the numerical ODE solution, nor for the stochastic results, which change based on the initial condition. Comparing the stochastic and numerical ODE solutions only, we see that there is better agreement in the C1 and C2 curves for smaller q values, while the C3 curves match best when q is largest.

57

CHAPTER 5. STOCHASTIC SIMULATIONS

5.3. CASE 3: VARYING INITIAL CONDITION

0.18 0.16 0.14 0.12 0.1

Time Evolution for C 2

0.08 0.06 0.04 0.02 0 0 100 200 300 400 500

Stochastic(q=0.25) ODE-numerical(q=0.25) Exact(q=0.25) Stochastic(q=0.5) ODE-numerical(q=0.5) Exact(q=0.5) Stochastic(q=0.75) ODE-numerical(q=0.75) Exact(q=0.75)

C2

time
Figure 5.8: Simulation of 2nd cluster concentration of Exact, ODE and stochastic solution vs time at E = F = 0.1 with the initial concentration C1 (0) = (1 - q )2 , C2 (0) = q (1 - q )2 and C3 (0) = q 2 (1 - q )2 for different values of q .

58

CHAPTER 5. STOCHASTIC SIMULATIONS

5.3. CASE 3: VARYING INITIAL CONDITION

0.15

Time Evolution for C 3

0.1

0.05

Stochastic(q=0.25) ODE-numerical(q=0.25) Exact(q=0.25) Stochastic(q=0.5) ODE-numerical(q=0.5) Exact(q=0.5) Stochastic(q=0.75) ODE-numerical(q=0.75) Exact(q=0.75)

C3
0 0 100 200 300 400 500

time
Figure 5.9: Simulation of 3rd cluster concentration of Exact, ODE and stochastic solution vs time at E = F = 0.1 with the initial concentration C1 (0) = (1 - q )2 , C2 (0) = q (1 - q )2 and C3 (0) = q 2 (1 - q )2 for different values of q .

59

CHAPTER 5. STOCHASTIC SIMULATIONS 5.4. CASE 4: VARYING INITIAL CONDITION F

E

0.6

Time Evolution for C 1
Stochastic(q=0.25) ODE-numerical(q=0.25) Exact(q=0.25) Stochastic(q=0.5) ODE-numerical(q=0.5) Exact(q=0.5) Stochastic(q=0.75) ODE-numerical(q=0.75) Exact(q=0.75)

0.5

0.4

C1

0.3

0.2

0.1

0 0 50 100 150 200 250 300 350 400 450 500

time
Figure 5.10: Simulation of 1st cluster concentration of Exact, ODE and stochastic solution vs time at E = 0.1, F = 0.01 with the initial concentration C1 (0) = (1 - q )2 , C2 (0) = q (1 - q )2 and C3 (0) = q 2 (1 - q )2 for different values of q .

5.4

Case 4: Effect of varying the initial condition, F

E

Here, the initial concentration profile Ck = (1 - q )2 q k-1 , k  1 as used in the previous section, is applied. In this case, instead of equal aggregation and break-up rates, the aggregation rates are taken to be E = 0.1, with much smaller break-up rates F = 0.01. Again, q = 0.25, 0.5 and 0.75 are considered. The results are shown in Figures 5.10, 5.11 and 5.12. From Figures 5.10, 5.11 and 5.12, it can again be seen that the exact/infinite ODE solution has an equilibrium value independent of the initial condition (eg. all q values give the same equilibrium concentration), while again, this is not the case for the numerical ODE solution nor the stochastic results. However, unlike the previous section, for the smaller break-up rates compared to aggregation rates, the numerical ODE solution agrees very well with the stochastic solution for all initial conditions for C1 , fairly good for all C2

60

CHAPTER 5. STOCHASTIC SIMULATIONS 5.4. CASE 4: VARYING INITIAL CONDITION F

E

0.25

Time Evolution for C 2

0.2
Stochastic(q=0.25) ODE-numerical(q=0.25) Exact(q=0.25) Stochastic(q=0.5) ODE-numerical(q=0.5) Exact(q=0.5) Stochastic(q=0.75) ODE-numerical(q=0.75) Exact(q=0.75)

0.15

C2
0.1 0.05 0 0 100 200 300 400 500

time
Figure 5.11: Simulation of 2nd cluster concentration of Exact, ODE and stochastic solution vs time at E = 0.1, F = 0.01 with the initial concentration C1 (0) = (1 - q )2 , C2 (0) = q (1 - q )2 and C3 (0) = q 2 (1 - q )2 for different values of q .

61

CHAPTER 5. STOCHASTIC SIMULATIONS 5.4. CASE 4: VARYING INITIAL CONDITION F

E

0.45 0.4 0.35 0.3 0.25

Time Evolution for C 3
Stochastic(q=0.25) ODE-numerical(q=0.25) Exact(q=0.25) Stochastic(q=0.5) ODE-numerical(q=0.5) Exact(q=0.5) Stochastic(q=0.75) ODE-numerical(q=0.75) Exact(q=0.75)

C3
0.2 0.15 0.1 0.05 0 0 50 100 150 200 250 300

350

400

450

500

time
Figure 5.12: Simulation of 3rd cluster concentration of Exact, ODE and stochastic solution vs time at E = 0.1, F = 0.01 with the initial concentration C1 (0) = (1 - q )2 , C2 (0) = q (1 - q )2 and C3 (0) = q 2 (1 - q )2 for different values of q .

62

CHAPTER 5. STOCHASTIC SIMULATIONS 5.5. CASE 5: VARYING INITIAL CONDITION E

F

0.9 0.8 0.7 0.6 0.5

Time Evolution for C 1

0.4 0.3 0.2 0.1 0 0 100 200 300 400 500

Stochastic(q=0.25) ODE-numerical(q=0.25) Exact(q=0.25) Stochastic(q=0.5) ODE-numerical(q=0.5) Exact(q=0.5) Stochastic(q=0.75) ODE-numerical(q=0.75) Exact(q=0.75)

C1

time
Figure 5.13: Simulation of 1st cluster concentration of Exact, ODE and stochastic solution vs time at E = 0.01, F = 0.1 with the initial concentration C1 (0) = (1 - q )2 , C2 (0) = q (1 - q )2 and C3 (0) = q 2 (1 - q )2 for different values of q . curves, and best agreement for larger q values only in the C3 curves.

5.5

Case 5: Effect of varying the initial condition, E

F

Here the initial concentration profile Ck = (1 - q )2 q k-1 , k  1 as used in the previous two sections is applied again. In this case, the break-up rates are taken to be F = 0.1, with much smaller aggregation rates E = 0.01. Again, q = 0.25, 0.5 and 0.75 is considered. The results are shown in Figures 5.13, 5.14 and 5.15. From Figures 5.13, 5.14 and 5.15, it can again be seen that the exact/infinite ODE solution has an equilibrium value independent of the initial condition (eg. all q values give the same equilibrium concentration), while again, this is not the case for the numerical ODE solution nor the stochastic results. The numerical ODE solution does not agree with the stochastic solution for all initial conditions for C1 , it is fairly close to C2 when q = 0.75, but agrees well for C3 , especially for q = 0.5 and q = 0.75. The numerical and stochastic 63

CHAPTER 5. STOCHASTIC SIMULATIONS 5.5. CASE 5: VARYING INITIAL CONDITION E

F

0.15

Time Evolution for C 2
Stochastic(q=0.25) ODE-numerical(q=0.25) Exact(q=0.25) Stochastic(q=0.5) ODE-numerical(q=0.5) Exact(q=0.5) Stochastic(q=0.75) ODE-numerical(q=0.75) Exact(q=0.75)

0.1

C2
0.05 0 0 50 100 150 200 250 300 350 400 450 500

time
Figure 5.14: Simulation of 2nd cluster concentration of Exact, ODE and stochastic solution vs time at E = 0.01, F = 0.1 with the initial concentration C1 (0) = (1 - q )2 , C2 (0) = q (1 - q )2 and C3 (0) = q 2 (1 - q )2 for different values of q .

64

CHAPTER 5. STOCHASTIC SIMULATIONS 5.5. CASE 5: VARYING INITIAL CONDITION E

F

0.07

Time Evolution for C 3
Stochastic(q=0.25) ODE-numerical(q=0.25) Exact(q=0.25) Stochastic(q=0.5) ODE-numerical(q=0.5) Exact(q=0.5) Stochastic(q=0.75) ODE-numerical(q=0.75) Exact(q=0.75)

0.06

0.05

0.04

C3
0.03 0.02 0.01 0 0 50 100 150 200 250 300 350 400 450 500

time
Figure 5.15: Simulation of 3rd cluster concentration of Exact, ODE and stochastic solution vs time at E = 0.01, F = 0.1 with the initial concentration C1 (0) = (1 - q )2 , C2 (0) = q (1 - q )2 and C3 (0) = q 2 (1 - q )2 for different values of q .

65

CHAPTER 5. STOCHASTIC SIMULATIONS

5.6. CASE 6: I , J -DEPENDENT RATES

0.9 0.8 0.7 0.6 0.5

Time Evolution for C 1

0.4 0.3 0.2 0.1 0 0 100 200 300 400 500

Stochastic(q=0.25) ODE-numerical(q=0.25) Exact(q=0.25) Stochastic(q=0.5) ODE-numerical(q=0.5) Exact(q=0.5) Stochastic(q=0.75) ODE-numerical(q=0.75) Exact(q=0.75)

C1

time
Figure 5.16: Simulation of 1st cluster concentration of Exact, ODE and stochastic solution vs time with the initial concentration C1 (0) = (1 - q )2 , C2 (0) = q (1 - q )2 and C3 (0) = q 2 (1 - q )2 for different values of q . solution curves are closest to the infinite system solution for the smallest q values (q = 0.25) for all cluster sizes in the finite system. Here for smaller aggregation rates (E than for C1 . F ) there is best agreement in C3 , and better agreement for C2

5.6

Case 6: Effect of varying the initial condition with i, j -dependent rates

In this case, the effect of varying q for the initial concentrations Ck = (1 - q )2 q k-1 for k  1 is considered, where the aggregation and break-up rates can be cluster-size dependent. The rates are taken to be K11 = 0.1, K12 = 0.0001 = K21 , W2 = 0.001, and W3 = 0.1. The results are shown in Figures 5.16, 5.17 and 5.18. Note that the q = 0 curve corresponds to the monomer-only initial condition. From Figures 5.16, 5.17 and 5.18, it is observed that both the finite system ODE and RMPC solution 66

CHAPTER 5. STOCHASTIC SIMULATIONS

5.6. CASE 6: I , J -DEPENDENT RATES

1 0.9 0.8 0.7 0.6

Time Evolution for C 2
Stochastic(q=0) ODE-numerical(q=0) Stochastic(q=0.25) ODE-numerical(q=0.25) Stochastic(q=0.5) ODE-numerical(q=0.5) Stochastic(q=0.75) ODE-numerical(q=0.75)

C2

0.5 0.4 0.3 0.2 0.1 0 0 50 100 150 200 250 300 350 400 450 500

time
Figure 5.17: Simulation of 2nd cluster concentration of Exact, ODE and stochastic solution vs time with the initial concentration C1 (0) = (1 - q )2 , C2 (0) = q (1 - q )2 and C3 (0) = q 2 (1 - q )2 for different values of q .

67

CHAPTER 5. STOCHASTIC SIMULATIONS

5.6. CASE 6: I , J -DEPENDENT RATES

0.07

Time Evolution for C 3
Stochastic(q=0) ODE-numerical(q=0) Stochastic(q=0.25) ODE-numerical(q=0.25) Stochastic(q=0.5) ODE-numerical(q=0.5) Stochastic(q=0.75) ODE-numerical(q=0.75)

0.06

0.05

0.04

C3
0.03 0.02 0.01 0 0 50 100 150 200 250 300 350 400 450 500

time
Figure 5.18: Simulation of 3rd cluster concentration of Exact, ODE and stochastic solution vs time with the initial concentration C1 (0) = (1 - q )2 , C2 (0) = q (1 - q )2 and C3 (0) = q 2 (1 - q )2 for different values of q .

68

CHAPTER 5. STOCHASTIC SIMULATIONS

5.6. CASE 6: I , J -DEPENDENT RATES

curves agree well for all cluster sizes and are best when q is largest (q = 0.75). The RMPC simulation curves, in general, agree well for C1 ,C2 and C3 , they agree best for the largest q value, and in the C3 curve there is noise at q = 0 which is the monomer-only initial condition.

69

Chapter 6

Conclusions and Future Work
6.1 Summary

The rheological behaviour of blood in the microcirculation is primarily governed by the presence of red blood cells (RBCs) and their respective interaction. It is believed that RBCs are the main contributors to the non-Newtonian behaviour of blood. This is because the RBC interaction involves aggregation, which leads to larger three-dimensional clusters, which affect the overall viscosity of the flowing blood in the smaller vessels contained in the microcirculation. Changes in RBC interaction, as a result of cardiovascular diseases or haematological changes in the components of blood themselves, affect the blood circulation and are important in clinical diagnosis and disease management. Reactive Multiparticle Collision Dynamics (RMPC) extends the well-developed particle-based method called Multiparticle Collision Dynamics (MPC), and is a mesoscopic method that can simulate spatially distributed chemically reacting systems in equilibrium conditions. The dynamics of RMPC includes the MPC dynamics of collisions and free-streaming, and adds reactions to the mechanism. It is ideally suited to model the aggregation and break-up mechanism for RBC interactions that can be idealized through a set of reactive mechanisms, and hence RBC aggregation is the motivation for the work in this Thesis. This Thesis considered a reactive mechanism modeling RBC interaction in the form of a Smoluchowski equation, which is a coupled system of ODES for an infinite number of variables. Aggregation was considered separately, as well as aggregation and break-up together. Exact solutions are possible for constant aggregation and break-up rates for the infinite system of ODEs. This exact solution was used to determine how large a finite system would have to be to agree with results for the infinite system. For the finite system, numerical solutions to the finite ODE system were obtained, as well as stochastic simulations using the RMPC method. Both the monomer-only initial condition, as well as initial concentrations for all cluster sizes was considered. In the case where no exact solution for the Smoluchowski equation was possible, the numerical ODE system solution in the finite case was compared to the stochastic RMPC solution. For the Smoluchowski equation and the finite system ODE, we considered finite systems where the maximum cluster size was N = 5, 10, 20, when aggregation and break-up rates were equal (Kij = Wij ), when the aggregation rate was twice the

70

CHAPTER 6. CONCLUSIONS AND FUTURE WORK

6.2. CONCLUSIONS

break-up rate (Kij = 2Wij ) and when the break-up rate was twice the aggregation rate (Wij = 2Kij ). For RMPC results, N = 3 was considered, and applied to two different initial conditions for the following three cases: equal aggregation and breakup rates, aggregation rates that are much smaller than breakup rates, and breakup rates that are much smaller than aggregation rates. The initial conditions considered included monomer-only initial condition and non-zero monomer, dimer and trimer initial condition. For the last simulation we take different aggregation and break-up rates for the monomer-only initial condition and for non-zero monomer, dimer and trimer initial condition.

6.2

Conclusions

The RMPC dynamics has been successfully applied to simulate the concentration profiles through a 3 - d cubic domain. The exact solution (infinite system), the RMPC simulation, and the numerical ODE solution were compared for six different cases giving the key findings: · The effect of varying break-up rate for fixed aggregation rate with monomer-only initial concentration shows that the stochastic result gives best agreement with the numerical ODE solution for the smallest break-up rate, and all curves (RMPC, ODE-numerical and Exact) have decreasing equilibrium concentrations for monomer, dimer and trimer concentrations as the break-up rate decreases. · The effect of varying aggregation rate for fixed break-up rate with monomer-only initial concentration shows that all three solutions predict lower equilibrium concentrations for trimers when the aggregation rate is decreased while the equilibrium concentration increases for monomers . · The effect of varying the initial condition for equal aggregation and break-up rates shows that the RMPC solution agrees best with the numerical ODE for monomers and dimers for small q , while it is best for trimers when the parameter q is largest. · The effect of varying the initial condition for F E , shows that the numerical ODE solution agrees

very well with the RMPC solution for monomers and fairly well for dimers. But the best agreement is seen for trimers for the largest value of q in the initial condition. · The effect of varying the initial condition for E dimers rather than monomers. · The effect of varying the initial condition when there are i, j -dependent rates, shows that both the RMPC and ODE simulations agree best for the largest value of q in the initial condition when there particle concentrations are all non-zero initially, although there is a little bit of noise for the monomeronly initial condition. We can summarize our results in two parts, that is, when there are only monomers initially, the simulation for the RMPC(finite), numerical ODE(finite) and exact(infinite) have the best agreement in the equilibrium concentration mostly for monomers. When the initial condition varies, better agreement can be found for 71 F , shows that there is best agreement between

the numerical ODE solution and the RMPC simulation results for trimers, and better agreement for

CHAPTER 6. CONCLUSIONS AND FUTURE WORK

6.3. FUTURE WORK

dimers and trimers. However, the exact(infinite) solution shows some key differences in these cases so that finite system effects are clearly visible.

6.3

Future work

The RMPC algorithm used in this work was for maximum cluster size N = 3 only. Larger maximum cluster sizes should be considered and is part of future work. All simulations in our work used no flow conditions. We plan on obtaining simulations for blood in flow conditions. Simulation of aggregation and break-up rates for particles with constant versus cluster size-dependent rates in flow conditions is an additional goal, as well as more realistic biological applications for systems that incorporate flow and complex flow geometries to study changes in aggregation/break-up dynamics. Future extensions to applications for reactions and flows in small physical and biochemical systems is also of interest.

72

References
[1] T. Akhter and K. Rohlf. Quantifying compressibility and slip in multiparticle collision (mpc) flow through a local constriction. Entropy, 16:418­442, 2014. [2] E. Allahyarov and G. Gompper. Mesoscopic model for solvent dynamics. Phys. Rev.E, 66:036702, 2002. [3] E. Allahyarov and G. Gompper. Mesoscopic solvent simulations: multiparticle - collision dynamics of three dimensional flows. Phys. Rev.E, 66:036702(9), 2002. [4] T. AlMomani, H.S. Udaykumar, J.S. Marshall, and K.B. Chandran. Micro-scale dynamic simulation of erythrocyte-platelet interaction in blood flow. Annals of Biomedical Engineering, 36:905­920, 2008. [5] O.K. Baskurt and H.J. Meiselman. Blood rheology and hemodynamics. Seminars in Thrombosis and Hemostasis, 29:435­450, 2003. [6] S. K. Bedkihal, J. C. Kumaradas, and K. Rohlf. Steady flow through a constricted cylinder by multiparticle collision dynamics. Biomechanics and Modeling in Mechanobiology, 12:929­939, 2013. [7] J. X. Chen, J. X. Zhu, Y. H. Zhao, W. G. Sun, J. R. Xu, and H. Ying. Simulating bistable biochemical systems by means of reactive multiparticle collision dynamics. Commun. Nonlinear Sci. Numer. Simul., 19:250512, 2014. [8] R. A. Gingold and J. J. Monaghan. Smoothed particle hydrodynamics:theory and application to nonspherical stars. Mon. Not. R. Astron. Soc., 181:375­389, 1977. [9] H. Hijar and Sutmann. Hydrodynamic fluctuations in thermostatted multiparticle collision dynamics. Phys.Rev.E, 83:046708, 2011. [10] P. J. Hoogerbrugge and J. M. Koelman. Simulating microscopic hydrodynamic phenomena with dissipative particle dynamics. Europhysics Letters, 19:155160, 1992. [11] T. Ihle and D. M. Kroll. Stochastic rotation dynamics: a galilean-invariant mesoscopic model for fluid flow. Phys. Rev.E, 63:020201, 2001. [12] T. Ihle and D. M. Kroll. Stochastic rotation dynamics: I. formalism, galilean invariance, and greenkubo relations. Phys. Rev.E, 67:066705, 2003.

73

REFERENCES

REFERENCES

[13] T. Ihle and D. M. Kroll. Stochastic rotation dynamics: Ii. transport coefficients, numerics, and long-time tails. Phys. Rev.E, 67:066706, 2003. [14] R. Kapral. Multiparticle collision dynamics : simulation of complex systems on mesoscales. Adv. Chem. Phys., 120:82628270, 2004. [15] S.Y. Kim, I.F. Miller, B.Sigel, P.C. Macke, and J. Justin. Ultrasonic evaluation of erythrocyte aggregation dynamics. Biorheology, 26:723­736, 1989. [16] P. L. Krapivsky, S. Render, and E. B. Naim. A kinetic view of statistical physics. Cambridge University Press, 2010. [17] P. Kunwar. Shear viscosity calculation for particle-based flow. MSc Thesis, Ryerson University, 2014. [18] A. Lamura and G. Gompper. Numerical study of flow around a cylinder using multiparticle collision dynamics. Eur.Phys.J.E, 9:477­485, 2002. [19] A. Malevanets and R. Kapral. Mesoscopic model for solvent dynamics. J. Chem. Phys., 110:8605­8613, 1999. [20] G. R. McNamara and G. Zanetti. Use of the boltzmann equation to simulate lattice-gas automata. Phys. Rev. Lett., 61:2930­2948, 1998. [21] T. Murata. Effects of sedimentation of small red blood cell aggregates on blood flow in narrow horizontal tubes. Journal of Biorheology, 33:267­283, 1996. [22] S. Oka. A physical theory of erythrocyte sedimentation. Biorheology, 22:315­321, 1985. [23] V. G. Petrov and I. Edissonov. The role of aggregation kinetics in the sedimentation of erythtocytes. Biorheology, 33:353­364, 1996. [24] K. Rohlf. Theoretical studies on blood flow in small vessels. PhD Thesis,University of Waterloo, 2002. [25] K. Rohlf. Stochastic phase-space descriptions for reactions that change particle numbers. Journal of Mathematical Chemistry, 45:141­160, 2009. [26] K. Rohlf, S. Fraser, and R. Kapral. Reactive multiparticle collision dynamics. Comput. Phys. Commun., 179:1329, 2008. [27] R. Strehl and K. Rohlf. Multiparticle collision dynamics for diffusion-influenced signaling pathways. Physical Biology, 13:046004, 2016. [28] Y. Ting, P. T. Nhan, and T. L. Chwee. Particle-based simulations of red blood cellsa review. Journal of Biomechanics, 49:22552266, 2016. [29] A. Tosenberger. Blood flow modelling and applications to blood coagulation and atherosclerosis. HAL, 2014. 74

REFERENCES

REFERENCES

[30] K. Tsubota, S. Wada, H. Kamada, Y. Kitagawa, R. Lima, and T. Yamaguchi. A particle method for blood flow simulation, application to flowing red blood cells and platelets. Journal of the Earth Simulator, 5:2­7, 2006. [31] K. Tucci and R. Kapral. Mesoscopic model for diffusion-influenced reaction dynamics. J. Chem. Phys., 120:826270, 2004. [32] K. Tucci and R. Kapral. Mesoscopic multiparticle collision dynamics of reaction-diffusion fronts. J. Chem. Phys., B 109:213004, 2005. [33] J. Venkatesan, D. S. Sankar, K. Hemalatha, and Y. Yatim. Mathematical analysis of casson fluid model for blood rheology in stenosed narrow arteries. Journal of Applied Mathematics, 2013. [34] J. Zhang, P.C. Johnson, and A.S. Popel. Effects of erythrocyte deformability and aggregation on the cell free layer and apparent viscosity of microscopic blood flows. Microvasc Res, 77:265­272, 2009.

75

