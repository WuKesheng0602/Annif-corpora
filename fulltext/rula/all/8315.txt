RECOVERY OF VALUABLE INCOMPLETELYRECORDED CN TOWER LIGHTNING RETURNSTROKE CURRENT DERIVATIVE SIGNALS

by

Lakmini Perera

Bachelor of Applied Science Electrical Engineering University of Toronto, Toronto, Canada, 2015

A thesis presented to Ryerson University in partial fulfillment of the requirements for the degree of Master of Applied Science in the Program of Electrical and Computer Engineering

Toronto, Ontario, Canada, 2018 Â© Lakmini Perera, 2018

AUTHOR'S DECLARATION
I hereby declare that I am the sole author of this thesis. This is a true copy of the thesis,
including any required final revisions, as accepted by my examiners.

I authorize Ryerson University to lend this thesis to other institutions or individuals for the
purpose of scholarly research.

I further authorize Ryerson University to reproduce this thesis by photocopying or by other
means, in total or in part, at the request of other institutions or individuals for the purpose scholarly research.

of

I understand that my thesis may be made electronically available to the public.

(Lakmini Perera)

ABSTRACT
Thesis Title: Recovery of Valuable Incompletely-Recorded CN Tower Lightning Return-Stroke Current Derivative Signals Degree: Master of Applied Science, 2018 Student Name: Lakmini Perera Graduate program: Electrical and Computer Engineering, Ryerson University Lightning is a captivating natural phenomenon but indisputably terrifying. Therefore, lightning studies have played an essential role in establishing safety regulations to protect lives and infrastructures. Among the many simulating functions that were utilized in the past for modelling the lightning return-stroke current, Heidler and Pulse functions overcame certain limitations, including the time derivative discontinuities. Incompletely-recorded current derivative signals represent another challenge in lightning research. This thesis proposes a double-term Pulse function that could be investigated with the double-term Heidler function for modelling the lightning return-stroke current. The time derivative of both Pulse and Heidler functions have been used to simulate the current derivative signals recorded on June 10, 1996. Some of these return-stroke signals exceded the maximum set level. Consequently, the double-term simulating functions were used to recover a large incompletelyrecorded return-stroke current derivative signal. The R 2 fitting factor was used to evaluate the quality of each fitting to determine which simulating function is better suited to model and recover valuable return-stroke current signals.
iii

ACKNOWLEDGEMENTS
I would like to express my deepest gratitude and appreciation to my supervisor Prof. Ali M. Hussein for his guidance, support, advice, and encouragement throughout the research work. His knowledge, expertise, and persistent help on my research are highly valuable. It was a great pleasure working with him and I am honored to have had the privilege of working under his supervision. I am really grateful for the opportunity to participate in two international lightningrelated conferences, which helped me to present my research and be exposed to the work of other researchers, in the same research area, around the world. This work was funded in part by the Natural Sciences and Engineering Research Council of Canada, NSERC Discovery Grant (2012-2017), which is gratefully acknowledged. I would like to acknowledge the Department of Electrical, Computer and Biomedical Engineering and the School of Graduate Studies at Ryerson University for their support through funding and facilities provided during this research. Furthermore, I would like to extend my thanks to all my Professors who taught me during my graduate studies at Ryerson University. A special thank you to my parents, sister, and my loving husband for their moral support, patience, encouragement, and wise advice during my years of study. Without your continuous support, I would not have gotten where I am today. Words cannot express my sincerest gratitude and appreciation and thank you for believing in me.

iv

TABLE OF CONTENTS
AUTHOR'S DECLARATION ....................................................................................................... ii ABSTRACT ................................................................................................................................... iii ACKNOWLEDGEMENTS ........................................................................................................... iv LIST OF TABLES ....................................................................................................................... viii LIST OF FIGURES ....................................................................................................................... ix Chapter 1 1. General Introduction ............................................................................................................ 1 Introduction .................................................................................................................... 1 Organization of the Study .............................................................................................. 6

Chapter 2 2. Literature Survey ................................................................................................................. 8 Introduction .................................................................................................................... 8 Simulating Functions ..................................................................................................... 8 Data Recovery Methodologies ..................................................................................... 11 Summary ...................................................................................................................... 12

v

Chapter 3 3. Lightning ............................................................................................................................ 13 Introduction .................................................................................................................. 13 Physics of Lightning .................................................................................................... 14 3.2.1. Precipitation Model............................................................................................... 14 3.2.2. Convection Model ................................................................................................. 16 3.2.3. Tripolar model ...................................................................................................... 17 Process of Lightning Formation ................................................................................... 20 Categorization of Lightning ......................................................................................... 24 3.4.1. Tall-Structure Lightning ....................................................................................... 26 Measurement Systems .................................................................................................. 27 Summary ...................................................................................................................... 33

Chapter 4 4. Simulating Functions ......................................................................................................... 34 Introduction .................................................................................................................. 34 Current Waveform Parameters..................................................................................... 35 Single-Term Heidler and Pulse Functions ................................................................... 38 Double-Term Heidler and Proposed Double-Term Pulse Functions ........................... 42 Summary ...................................................................................................................... 47

vi

Chapter 5 5. Modelling Process .............................................................................................................. 48 Introduction .................................................................................................................. 48 Matching Waveforms ................................................................................................... 48 Estimating the Decay Constants using Single-Term Simulating Functions ................ 55 Estimating the Decay Constants using Double-Term Simulating Functions ............... 58 Single-Term Simulating Functions .............................................................................. 60 Double-Term Simulating Functions ............................................................................. 67 Summary ...................................................................................................................... 76

Chapter 6 6. Recovery of Incomplete Signals ........................................................................................ 77 Introduction .................................................................................................................. 77 Recovery of Artificially-Cut Signal ............................................................................. 77 Recovery of Incompletely-Recorded Signal ................................................................ 81 Summary ...................................................................................................................... 84

Chapter 7 7. Conclusions & Future Work .............................................................................................. 85

REFERENCES ............................................................................................................................. 88 NOMENCLATURE ..................................................................................................................... 93

vii

LIST OF TABLES
Table 5.1 Fitting Results and R2 Factor for the 3rd Return-stroke Current Derivative Signal ........................................................................................................................... 61 Table 5.2 Fitting Results and R2 Factor for the 6th Return-stroke Current Derivative Signal ........................................................................................................................... 65 Table 5.3 Fitting Results and R2 Factor for the 3rd Return-stroke Current Derivative Signal ........................................................................................................................... 69 Table 5.4 Fitting Results and R2 Factor for the 6th Return-stroke Current Derivative Signal ........................................................................................................................... 73 Table 6.1 Fitting Results and R2 Factor ........................................................................................ 80 Table 6.2 Fitting Results and R2 Factor ........................................................................................ 83

viii

LIST OF FIGURES
Figure 1.1: Thunderstorms and the global circuit ........................................................................... 5 Figure 3.2: Precipitation model of thundercloud structure ........................................................... 15 Figure 3.3: Convection model of thundercloud structure ............................................................. 16 Figure 3.4: Tripolar model of thundercloud structure .................................................................. 18 Figure 3.5: Charge reversal temperature level and the electric charge acquired by the collisioins of light particles with large graupel particles ............................................. 19 Figure 3.6: Various stages in the formation of negative cloud-to-ground lightning .................... 23 Figure 3.7: Types of cloud-to-ground lightning ........................................................................... 25 Figure 3.8: Canadian National Tower (as observed from the Toronto Island) ............................. 27 Figure 3.9: CN Tower and lightning measurement systems ......................................................... 29 Figure 3.10: Old Rogowski coil encircles one-fifth of CN Tower steel structure ........................ 31 Figure 3.11: New Rogowski coil encircles the whole CN Tower steel structure ......................... 31 Figure 3.12: CN Tower measurement system setup, 1990-2003 .................................................. 32 Figure 4.1: Current derivative waveform...................................................................................... 36 Figure 4.2: Current waveform; as well as the current peak, 90%, 50% and 10% current levels ............................................................................................................................ 37 Figure 5.1: The 3rd return-stroke current derivative waveform. A zoomed-in view illustrates the starting point at which di/dt  0 ............................................................ 49 Figure 5.2: The 6th return-stroke current derivative waveform. A zoomed-in view illustrates the starting point at which di/dt  0 ............................................................ 49 Figure 5.3: The first time window, (1), second time window, (2), third time window, (3), shown 6th return-stroke current derivative measured signal and its current waveform. ....................................................................................................... 51 Figure 5.4: The first time window of the 6th return-stroke current derivative measured signal ........................................................................................................................... 52 Figure 5.5: The first time window of the 3rd return-stroke current derivative measured signal ........................................................................................................................... 52 Figure 5.6: The third time window of the 3rd return-stroke current waveform............................. 53 Figure 5.7: The third time window of the 6th return-stroke current waveform ............................. 54 Figure 5.8: The 6th return-stroke current signal and the fitting of the decay function described by (32) into third time window 14 Â­ 62 s.................................................. 56 Figure 5.9: The 3rd return-stroke current waveform and the fitting of the decay function described by (33) and (34) into third time window 30 Â­ 60 s ..................... 57 Figure 5.10: The 6th return-stroke current waveform and the fitting of the decay function described by (35) into the third time window 14 Â­ 62 s ............................. 59

ix

Figure 5.11: The 3rd return-stroke current waveform and the fitting of the decay function described by (35) and (36) into the third time window 30 Â­ 60 s ............... 59 Figure 5.12: Fitting of time derivative of Heidler and Pulse functions for the 3 rd returnstroke current derivative measured signal. The zoomed-in view shows the fitting of the simulating functions near the maximum amplitude. .............................. 62 Figure 5.13: Heidler and Pulse functions' fittings for the 3rd return-stroke current signal. The zoomed-in view shows the fitting of the simulating functions near the current peak. .................................................................................................. 63 Figure 5.14: Time derivative of Heidler and Pulse functions for the fitting of the 6 th return-stroke current derivative measured signal. The zoomed-in view shows the fitting of the simulating functions near the maximum amplitude. ............. 66 Figure 5.15: Heidler and Pulse functions' fittings of the 6th return-stroke current waveform. The zoomed-in view shows the fitting of the simulating functions near the current peak. .................................................................................. 67 Figure 5.16: Fitting the time derivative of Heidler and Pulse functions to the 3 rd returnstroke current derivative measured signal. The zoomed-in view shows the fitting of the simulating functions near the maximum amplitude. .............................. 70 Figure 5.17: Fitting Heidler and Pulse functions to the 3 rd return-stroke current waveform. The zoomed-in view shows the fitting of the simulating functions near the current peak. .................................................................................. 71 Figure 5.18: Fitting time derivative of Heidler and Pulse functions to 6 th return-stroke current derivative measured signal. The zoomed-in view shows the fitting of the simulating functions near the maximum amplitude. ......................................... 74 Figure 5.19: The fitting of Heidler and Pulse functions of the 6 th return-stroke current waveform. The zoomed-in view shows the fitting of the simulating functions near the current peak. .................................................................................. 75 Figure 6.1: Artificially-cut waveform obtained by cutting the recorded return-stroke current derivative waveform at 50% level from the peak ........................................... 78 Figure 6.2: Time derivative of the proposed double-term Pulse function of the artificially-cut return-stroke current derivative waveform fitting ............................... 79 Figure 6.3: The fitting of the proposed double-term Pulse function of the artificiallycut current waveform................................................................................................... 79 Figure 6.4: The fitting of the time derivative of Heidler function of the 7 th returnstroke current derivative waveform (incompletely recorded waveform) .................... 82 Figure 6.5: Current waveform of the recovered 7th return-stroke current derivative signal (obtained by numerical integration) .................................................................. 83

x

Chapter 1 1. General Introduction
Introduction
Lightning is one of the most intriguing phenomenon known to man. According to scientific research on origin of life, lightning had a great impact on creating the organic molecules, which is the building block of all life forms [1]. Ancient civilizations were so captivated by this natural phenomenon, which seems so ordinary to us, to the extent that lightning and thunder crest into their ancient religious beliefs. In Greek mythology, Zeus (the god of sky and thunder) uses lightning as his weapon [1]Â­[3]. Thor (the god of thunder), in Norse mythology, carries a hammer associated with lightning as a weapon [1], [3]. In Hinduism, Indra (the god of weather and war) has a thunderbolt in one hand [1], [3], [4]. In Chinese mythology, Tien Mu (Mother of lightning) uses flashing mirrors to create lightning [1], [5]. Lei Gong is a Taoism deity who produce thunder using a drum and a mallet, and punish evil mortals/spirits [5]. In some of these ancient beliefs, the gods associated with lightning and thunder were considered the kings of all gods. Thus, lightning was a symbol of power and a weapon for protection. Following Benjamin Franklin's discovery that lightning was electrical through his experiments, many scientists carried out numerous experiments to better understand the lightning phenomenon [6]. Despite its fascinating beauty, lightning is undoubtedly frightening. Apart from
1

tornadoes and hurricanes, for many decades lightning has been considered a major natural problem with devastating results including, property damages, forest fires, human injuries and fatalities, disruptions and damages to telecommunication systems, damages to transmission lines, and disruptions to aviation and aerospace industry. In Canada, the cost of annual lightning-related distructions range from $600 million to $1 billion. The majority of these distructions are to forestry and electrical powerlines [7], [8]. Thus, it is important to advance our understanding of the lightning discharge by analyzing its characteristics in order to develop systems, establish regulations and standards to protect humans and properties. The lightning strike fatalities and injuries have decreased significantly due to the development of lightning safety regulations that have been put in place during the past decade [8], [9]. Some of the main objectives of this study are listed below:  Improve the modelling of the lightning return-stroke current derivative waveform using the double-term simulation functions to acquire more accurate fit. The study proposes a double-term Pulse function that could be investigated and compared with the double-term Heidler function for modelling the lightning return-stroke current to determine which simulating function is better suited to model the CN Tower lightning return-stroke current.  Incompletely-recorded large current derivative return-stroke signals presents a big challenge and represent valuable waveforms for the lightning modelling process. It is important to successfully recover large valuable incompletely-recorded signals, which are valuable for the evaluation of tall-structure lightning return-stroke models by comparing the simulated electric and magnetic fields with those measured [10].

2

Lightning studies and collected data have many advantages in our day-to-day lives. The main advantages are highlighted below [7]Â­[9], [11]Â­[14]: 1. Weather: Tracking, recording, and forecasting severe weather to warn the public. 2. Aviation industry: Help in issuing warnings to protect aircrafts and ground crew, as well as avoiding flying routes with heavy lightning strikes. 3. Forestry: Early detection of areas that are more likely to start fires due to lightning-strikes. Help to allocate necessary resources and take actions to save time and valuable property. 4. Protection of electrical infrastructures: Establish systems to improve the protection of transmission and distribution systems. Also, restoration due to lightning damages will costs billions of dollars. 5. Insurance industry: Investigation of lighting damage claims. In 2013 in USA, one-hundred thousand homeowners claimed insurance for damages caused by lightning. 6. Outdoor activities: Improved forecasting helps people to better plan their outdoor activities (for example, playing in open fields, fishing, and working outdoors in open fields during thunderstorms). It is worth mentioning that lightning plays a major role in maintaining the earth's electrical field, at about 100 V/m. As illustrated in Figure 1.1, lighting creates the global circuit. During a thunderstorm, atmospheric electrical current flows upwards whereas during fine weather it flows downward. Thunderstorms supply the earth with sufficient charges, which acts as a battery, by means of corona discharge, lightning current, and rain. This keeps the earth negatively charged.

3

On the otherhand the atmosphere is positively charged. Electrosphere range, located at 50 km above earth's surface, is a great conduction medium for slow propagating waves such as radio signals [3], [15]. Furthermore, lightning influences the chemistry of the atmosphere. Lightning channels discharge fixed nitrogen into the atmosphere. Nitrogen is called fixed when it is in a less stable form in comparison with the dinitrogen molecule, N2. Therefore, fixed nitrogen produced by lightning can be easily absorbed by plants during photosynthesis. In addition, this unstable molecule can react more easily with other types of gases found in the atmosphere, besides N 2, to form chemicals like nitric acid. Nitric acid is used to produce ammonium nitrate, which helps in ground fertilization [1], [3].

4

Figure 1.1: Thunderstorms and the global circuit

5

Organization of the Study
This thesis is divided into seven chapters, which are summarized below: Chapter 1 introduces the history behind the study of lightning. It highlights the importance of conducting lightning studies and how it benefits our everyday life. This chapter emphasized the importance of lightning and the role it plays in the global circuit and the chemistry of the atmosphere. In addition, it describes the objective and the motivation behind this research. Chapter 2 presents the existing research conducted on the methods and techniques used to simulate lightning current signals. It also discusses various algorithms used to recover valuable missing data. In addition, it highlights the advantages and drawbacks found in each study. Chapter 3 provides a basic introduction to the physics behind lightning. It describes thunderstorm cloud structures, types of lightning, lightning formation highlighting important terminologies, and tall-structure lightning. Moreover, the chapter discusses how the lightning return-stroke current is measured at the Canadian National (CN) Tower. Chapter 4 defines important waveform parameters and the requirements requirements of suitable simulating functions for the modelling process. Firstly, it introduces the single-term Heidler function, as well as Pulse function. In the second part, it introduces the double-term Heidler function and proposes a double-term Pulse function. In Chapter 5, the simulating functions described in the previous chapter are used to model the recorded signals. It describes the steps of preparing the raw data prior to starting the simulation process. It also focuses on utilizing the important characteristics of the simulation functions to

6

better estimate the analytical parameters. In this chapter, both the single-term and the double-term models are used to investigate and select suitable models for return-stroke lightning current signals. Chapter 6 proposes a solution to address the issue of incompletely-recorded large signals. An artificially-cut signal is to be recovered for testing the proposed algorithm before applying it on an actual incompletely-recorded CN Tower lightning current derivative signals. Chapter 7 presents final conclusions and highlight on the key findings in this research work. Furthermore, this chapter provides recommendations and suggestions for future work.

7

Chapter 2 2. Literature Survey
Introduction
In the past, researchers investigated a number of simulating functions for modelling lightning return-stroke currents. The incompletely recorded current derivative signals, which exceeded the maximum measured signal set level, represented another challenge [10]. In fact these incompletely recorded current derivative signals, whose peaks are well above the noise level, proved to be quite valuable for modelling purpose. In this chapter, various lightning return-stroke current simulating functions and data recovery methods are reviewed and presented.

Simulating Functions
References [16]Â­[19] discuss lightning returning stroke models that are based on the attachment process of connecting leaders, the effect of corona on the propagating current pulse, current attenuation along the propagating channel, current reflections at both ends of the channel, and the preliminary breakdown process leading to the return stroke. Reference [16] specifically discusses a mathematical model developed to simulate the first return-stroke by considering the attachment process of the upward-connecting leader. The proposed model assumes that the upward-connecting leader is developed completely inside streamer zone of a downward propogating leader, which means the connecting leader speed is
8

assumed to be much higher compared with the upward-connecting leaders initiated by tallstructures. Furthermore, the proposed model considers the slow wavefront of the channel-base current signal including the upward connecting-leader. By incorporating the slow wavefront, this model overcomes some of the limitations faced by the current generation (CG), travelling current source (TCS) and Diendorfer-Uman (DU) models. The return-stroke models described in [17], [18] are channel based current models. Paper [17] combines CG model and current dissipation (CD) model to create a return-stroke model that considers the reflections at ground level without incorporating current discontinuities of the returnstroke. Furthermore, the proposed return-stroke model can be utilized to analyze the effect of ground conductivity on return stroke current and variations of return-stroke velocity along the channel. The losses and scattering during the current pulse propagation along the channel and current reflections at both ends of the channel are considered in the generalized traveling current source return-stroke model (GTCS), discussed in [18]. As described in [18], extended GTCS model is a generalized return-stroke model and "engineering" return stroke models are a special case of this extended GTCS model. The initial breakdown stage, intermediate stage, and stepped leader (BIL) model, described in [19], considers various stages of the preliminary breakdown in the lightning flash before the return-stroke is observed. Even though this model is useful in the general understanding of the lightning flash breakdown process, these stages may differ in thunderstorms. Thus, this model is too generic and not standardized yet. Heidler and Pulse functions, described in [20]Â­[24], are widely popular in tall-structure lightning return-stroke modeling. Many simulating functions, including the double-exponential
9

and Jones modified double-exponential functions, [21], [22], [24], [25], are found to create problems in modelling the lightning return-stroke current due to discontinuities in their first and second current derivatives. On the other hand, Heidler and Pulse functions do not have the discontinuity problems [21], [22], [24]. As discussed in [21], [22], 3-section transmission line model and Heidler function can be utilized to model a measured current derivative signal. Returnstroke models proposed in [26]Â­[29] are derived considering Heidler and Pulse functions. New channel-base current (NCBC) model is used to approximate long stroke currents [26], [27]. The proposed model can be used in the frequency-domain calculations due to its simple, analytically differentiable, and integrable properties. In [28], [29], Heidler function is estimated using a linear combination of exponential functions in time domain and analytically transformed into frequency domain using Fourier transform to obtain a more accurate expression. As explained in [30], the double-exponential and Heidler functions are more suitable for modelling single-peaked lightning return-stroke current signals. Therefore, the paper proposes two complex exponential functions that render pole-residue models of the measured return-stroke currents. One important application of this proposed pole-residue model is the improved simulation and evaluation of lightning current in surge arresters, and improved modelling of single-peaked and double-peaked lightning return-stroke current signals. Analytically Extended Function (AEF) has discontinuities in its second derivative. In order to address this issue, lightning current first derivative (AEFD) is introduced which is discussed in [31]. The proposed model is able to approximate the lightning return-stroke current waveforms with extreme values (steep waveforms). In addition, the proposed function is combined with special mathematical functions, such as Gamma and Lambda functions, to calculate the charge transfer and the specific energy of the measured lightning signal.
10

Many of the popular simulating functions, such as Heidler and Pulse functions, contain single peaks. A multi-peak modelling function is proposed in [32], [33] to capture some of the details of the measured lightning return-stroke that may be missed. Other analytical models are discussed and compared in [34]. These models include the gas dynamic model, derived using radial evolution of the lightning channel and its associated shockwaves, the electromagnetic model, derived using Maxwell equations, the distributed-circuit model, and the engineering model, based on observed lightning return-stroke characteristics.

Data Recovery Methodologies
References [35]Â­[37] are suitable for the recovery of complex signals where data are missing at random. They incorporate multiple techniques to accurately recover the missing data points. Paper [35] utilizes regression models such as linear, Poisson, logistic, or a mixture of these (depends on the complexity of the problem). This allows flexibility and estimation of the missing data on a case by case situation. Algorithms discussed in [35]Â­[37] are based on an autoregressive parameter estimation technique, combined with interpolation or extrapolation. Algorithms like Resonator Based Spectral Observer (RBO), as discussed in [38], is able to handle data loss but too complicated. As explained in [39], [40], complex data recovery algorithms require more computational resources and thus more expensive. Paper [39], based on Fast Fourier Transform, and paper [40], based on several linear prediction coefficients (LPC), address the drawbacks mentioned above making it simpler and cost effective. Other simple techniques include Maximum Likelihood Estimator (MLE), multiples sine function decomposition (MSFD), and Laplacian solvers, as discussed in [41]Â­[43].

11

Algorithms explained in [44]Â­[47] are used for the recovery of more sensitive signals such as audio or signals with severe degradations. The quality of the signal is considered during the recovery process and do not modify the given data samples as explained in [44]Â­[46]. The data recovery algorithm discussed in [47] is able to restore missing data without relying on any information about previous or the next set of data.

Summary
Many researchers have studied tall-structure lightning models, including CG, CD, TCS, engineering models, etc. One of the main drawbacks of some simulating functions is the discontinuities in its second current derivative. However, simulating functions such as Heidler and Pulse functions are used in many lightning return-stroke models to overcome such limitations. As was explained earlier, analyzing these problems in the frequency domain can further improve the modelling of lightning return-stroke current signals. The incompletely recorded current derivative signals is another challenge faced by many researchers dealing with valuable data. The incompletely recorded current derivative signals that have high peak amplitude levels are very valuable in modelling tall-structure lightning. There are several studies discussing various data recovery algorithms (using simple and complex algorithms) trying to restore the missing data as accurately as possible. But none of the aforementioned studies discuss the function of tall-structure lightning data recovery utilizing simulating functions such as Heidler and Pulse functions.

12

Chapter 3 3. Lightning
Introduction
Benjamin Franklin started to investigate electricity in 1746. In 1752, during a thunderstorm, Franklin conducted his famous experiment when he flew a kite with a conducting string and a key tied to the bottom of the string. During a thunderstorm, he observed sparks flying from the key to his knuckles. This experiment proved that thunderclouds are electrically charged and lightning is electrical [6]. This chapter introduces two main models used to understand the dipole structure of the thundercloud. Modifications were made to these presumed structures to propose a more accurate representation of a thundercloud. In addition, this chapter discusses important lighting terminologies and different types of lightning. Lastly, it introduces the Canadian National (CN) Tower, which played a vital role in this research on tall-structure lightning.

13

Physics of Lightning
In addition to Franklin's observation on thunderclouds, he discovered that most thunder clouds are negative but could be also positive. Since his discovery, lightning is defined as transfer of charges, either positive or negative, between two regions in a cloud (intracloud discharge), between two different clouds (intercloud discharge), between cloud and air (cloud-to-air discharge), or between cloud and ground (cloud-to-ground discharge) [6], [15], [48]. Even though lightning is commonly associated with thunderstorms, there are other circumstances for lightning to occur during snowstorms, sandstorms, or above a volcanic eruption. Hence lightning occurs because a certain region of the atmosphere accumulates enough charges and results in an electrical breakdown of the air (electric field of the region surpasses the local dielectric strength of air) [3], [6], [15], [48]. In order for lightning to take place, positive and negative charges must be separated from each other (cloud electrification) [15]. After Franklin's observation of thunderclouds, it was assumed that thunderclouds had a simple dipole structure. This hypothetical structure is further investigated using precipitation and convection models.

3.2.1. Precipitation Model
The precipitation model, illustrated in Figure 3.2, describes a charge transfer between heavy and light particles in a thundercloud. A thundercloud contains heavy particles such as raindrops, hailstones and graupel particles, and light particles such as small water droplets and ice crystals. The heavy particles get pulled down by gravity and as they get pulled down, heavy particles pass light particles and collide with them. This collision results in transfer of charges,
14

where heavy particles become negatively charged whereas light particles become positively charged. Thus, negatively charged particles accumulate at the bottom of the cloud, whereas positively charged particles accumulate at the top of the cloud [15].

Figure 3.1: Precipitation model of thundercloud structure

15

3.2.2. Convection Model
The second type of hypothetical dipole model is the convection model illustrated in Figure 3.3. This particular model assumes that two external sources, cosmic rays and corona discharges (positive charges) from earth's surface, supply the thundercloud with necessary electric charges. First, positive and negative charges in air molecules above the thundercloud are separated due to the ionization process of the cosmic rays. Second, warm air carries the corona positive charges, produced at the earth's surface in the upwards direction or by "convection." When positive charges reach the top of the cloud, they attract the negative charges above the thundercloud, formed due to ionization process of the cosmic rays, to the cloud's boundary and enter the cloud. Next, negative charges quickly attach to the particles found inside the cloud such as small water droplets and ice crystals, which forms a "negative screening layer." It is believed that downdrafts then carry negative charges of the screening layer downwards to the base of the cloud. Thus, it creates a dipole structure. Although the two models discussed above may look similar, the convection model doesn't evoke precipitation and the precipitation model doesn't evoke convection [1], [15].

Figure 3.2: Convection model of thundercloud structure
16

3.2.3. Tripolar model
However, there was a big controversy about the structure of a thundercloud. Wilson, inventor of cloud chamber, concluded that a thundercloud is a positive dipole, whereas Simpson, a researcher who measured the charge on rain droplets from thunderclouds, concluded that a thundercloud is a negative dipole [15]. Since this controversial conclusions and many decades of close observations, it was concluded that thunderclouds are tripolar as illustrated in Figure 3.4; a positive region at the top of the cloud, a small positive region at the bottom, and a main negative region in the middle. Looking at the two suggested models, many believed that the corona discharges, the positive charges that are produced at the earth's surface (based on the convection model), were responsible for the small positive region at the bottom of the tripolar structure. However, after the measurement of the electric flux, it was concluded that it was too small to form the positive layer at the bottom of the tripolar structure and the convection model was proved to be inadequate to explain the tripolar structure. Therefore, several modifications were made to the precipitation model to explain the simple tripolar structure of a thundercloud, especially the positively charged region at the bottom [15]. The explanation for the positive layer at the bottom in a tripolar structure lies in the microphysics of charge transfer. The heavy graupel particles in a thundercloud get pulled down by gravity and as they get pulled down, they collide with light particles. The charge transferred to each particle is dependent on a critical temperature as shown in Figure 3.5. The critical temperature is called the "charge-reversal temperature," which is about -15 o C (at a height of 6 km). At a temperature below the critical temperature, the falling heavy graupel particles acquire negative
17

charge, whereas lighter particles acquire positive charge. At a temperature above the critical temperature, the falling heavy graupel particles acquire positive charge, whereas lighter particles acquire negative charge (Figure 3.5). Thus, the positively charged heavy graupel particles form the lower positive region of the tripolar structure [15] (Figure 3.4).

Figure 3.3: Tripolar model of thundercloud structure

18

Figure 3.4: Charge reversal temperature level and the electric charge acquired by the collisioins of light particles with large graupel particles

19

Process of Lightning Formation
As discussed in the previous chapter, any cloud-to-ground lightning discharges start in the cloud. This section highlights the key stages in a typical negative cloud-to-ground lightning discharge, which is illustrated in Figure 3.6. Also, specific terminologies used to describe lightning is explained in details. The Flash is a complete discharge of lightning that lasts about one-tenth of a second. Each flash contains at least one high-current pulse termed stroke. For a flash that contains one stroke, it is called a single-stroke flash, whereas if there are more than one stroke, it is called a multi-stroke flash. Each stroke is typically 20-25 ms apart [3]. Visually speaking, the existence of multiple strokes causes the flickering-effect, which is clearly observed. When the time between each stroke is very small, the human eye doesn't detect the flickering, whereas when the time between each stroke is longer, the human eye observe the flickering. (The same concept is used to produce movies and TV, which make them appear continuous to the human eye) [6]. The cloud-to-ground discharge first begins locally between small positively charged layer at the bottom and negatively charged layer above it. This preliminary breakdown inside the cloud frees the electrons in the negatively charged region, which were once attached to light particles (such as small water droplets and ice particles). Recall, an electron is a fundamental particle that has a small mass and carry negative electric charge. Due to their extremely small mass compared to other particles, such as small water droplets and ice particles in the negatively charged region, electrons are free to move around very easily. These free electrons eventually move to the small positive region at the bottom of the cloud and neutralize it. And they continue moving towards the ground and creates a channel to move negative charges from the cloud to ground. This is called a
20

stepped leader [1], [3], [6], [48]. The name `stepped' is given because it appears to move downwards in a zig-zag path creating a step-like pattern. Many scientists define the stepped leader as a weakly luminous pre-discharge and categorized into two main groups: -type and -type. The two main types are distinguished based on downward speed, length in the steps, and luminosity [1]. As explained in [1], according to Schonland, 55% to 70% stepped leader types are -type. When this large negatively charged stepped leader is closer to the ground level, it induces a large amount of positive charges on the ground, especially on objects above ground level (houses, trees, buildings, tall towers, etc.). This large amount of positive charges are attracted to the large amount of negative charges from the stepped leader and attempt to join due to its opposite polarities. This attempt of union between large amount of positive and negative charges, launch upward-moving-discharges from the ground level. An upward-moving discharge come in contact with the stepped leader moving downward and attach themselves [3], [6]. This attachment process determine what is known as the striking-point and its distance from usually the top of the ground object is called the striking distance. The striking distance is a very important parameter in lightning protection design, especially overhead ground-wire protection as explained in [3]. The process of attachment is quite similar to a switch closing in order to complete a circuit [1]. The negative charges situated at tip of the downward-moving leader move at a very high velocity and violently towards the ground, causing high currents to flow, and it becomes highly luminous near the ground level. After, the channel luminosity becomes brighter at higher and higher altitudes, where it propagates upwards and finally reaches the cloud [6]. The bright luminous features of a lightning flash is produced by the upward-moving return-stroke. The human eye is not fast enough to register the movement of the upward propagating return stroke. It is believed that most of the lightning damages are caused by the return-stroke current [1], [6].
21

After a small period of time, the return-stroke current will die down and stop flowing. If there are no subsequent return-strokes the lightning flash has ended. When additional charges are available, it results in subsequent return strokes. K-streamer (klein or N) and J-streamer (junction) processes increase the availability of negative charges at the top of the channel due to electrical discharge from upward propagating return-strokes and high negative region of the cloud. The additional charges creates a smooth and continuous downward leader called dart leader. The dart leader propagates easily down the channel, created by the previous return-stroke, depositing negative charges along the channel, which set the opportunity for a subsequent return stroke. However, subsequent return-stroke currents maybe smaller in comparison with the first returnstroke current [1], [6].

22

Figure 3.5: Various stages in the formation of negative cloud-to-ground lightning

23

Categorization of Lightning
Lightning can be categorized into several groups, including cloud-to-ground, intra-cloud (lightning flashes occuring within a thunder cloud), inter-cloud (cloud-to-cloud), and cloud-to-air. Cloud-to-ground lightning is the most common type and can be categorized further based on the direction of the motion and type of the charge of the leader [15], [49]. Cloud-to-ground lightning can be categorized into four groups [1], [3] (illustrated in Figure 3.7): 1) Downward negative lightning 2) Upward negative lightning 3) Downward positive lightning 4) Upward positive lightning Downward negative lightning is the most common cloud-to-ground lightning. It accounts for 90% of the world cloud-to-ground lightning [15]. It is initiated by a downward negativelycharged leader, which descends negative charge to ground. Downward positive lightning, accounts for less than 10% of world cloud-to-ground lightning discharge, is initiated by a downward positively-charged leader, which descends positive charges ground. Upward lightning, both negative and positive, are initiated by mountain tops or tall man-made structures, such as Canadian National (CN) Tower [15].

24

Figure 3.6: Types of cloud-to-ground lightning

25

3.4.1. Tall-Structure Lightning
Tall-structures are struck by both upward-initiated and downward-initiated lightning, which is similar to cloud-to-ground lightning. The starting point of tall-structure lightning studies is attributed to McEachron (1939) who photographed the Empire State Building in New York and conducted current measurements in 1935 when upward-initiated lightning was discovered. Most of lightning discharges observed at the Empire State building were upward-initiated, which originated at the tip of the structure. Since this discovery, many researchers followed McEachron's footsteps to better understand tall-structure lightning. It was found out that the majority of tall-structure lightning is upward-initiated and the frequency of occurrence increases with the height of the structure. For example, Berger discovered that out of all tall-tower lightning at Lugano, Switzerland, 75% of the discharges are upward-initiated as explained in [48]. According to the research conducted by Berger and Vogelsanger [48], 85% of upward-initiated lighting flashes have positively charged leaders [3]. Upward-initiated lightning originated by man-made tall-structures are similar to naturally occurring upward-initiated lightning. First, the upward-propogating leader carry positive charges towards the cloud. However, when this upward-moving leader reaches the cloud, there are no return strokes. The leader current, measured at ground, combines smoothly into a `continuous current' that flows between cloud and the structure. Next, the downward moving dart-leader initiates subsequent return-stroke current peaks, which interrupts the continuous-current flow between cloud and the structure [3], [48].

26

Measurement Systems
The construction of the Canadian National (CN) Tower, located in Toronto, began in 1973 and after 40 months of construction, it was finally opened to the public on June 26th, 1976 [50]. For over 30 years, it was the world's tallest free standing structure, 553 m in height, until the rise of Burj Khalifa in Dubai, 828 m in height, United Arab Emirates in 2007 [51]. However, until now the CN tower is the tallest free standing structure in the Western Hemisphere (Figure 3.8). Since 1978, tall structure lightning studies have been carried out based on observations at the CN Tower and in its vicinity. Although, the flash density in the Toronto area is approximately 2.5 flashes per square kilometer per year, the tower receives dozens of direct strikes yearly [49]. The CN Tower received 65, 70, and 48 direct flashes in 1990, 1991, and 1992, respectively [52]. On August 24th, 2011, the CN Tower was struck with 52 flashes within 84 minutes, possibly, the severest CN Tower storm on record [53].

Figure 3.7: Canadian National Tower (as observed from the Toronto Island)
27

In May 1991, simultaneous measurement of important CN Tower lightning return-stroke parameters commenced. The lightning measurement systems consisted of five independent components [52]: 1) The current derivative measurement system, which is located at the CN Tower (Figure 3.9) 2) One video system (VHS), Ontario Hydro Technology Building (Figure 3.9) 3) Second video system (VHS), Rosebrugh Building, University of Toronto (Figure 3.9) 4) Electric and magnetic field measurement system, Rosebrugh Building, University of Toronto (Figure 3.9) 5) Return-stroke velocity measurement system, Rosebrugh Building, University of Toronto (Figure 3.9) The current derivative measurement system, placed at the CN Tower, contains two Rogowski coils, placed at different elevations. The induced voltage at the output of each coil is proportional to the rate of change of the current. The current is determined by numerically integrating the measured signal. In 1990, the first Rogowski coil, Figure 3.9, is 3 meter long with 40 MHz bandwidth, is placed at 474 m above ground level (AGL). A second Rogowski, Figure 3.9, is 6 meter long with 20 MHz bandwidth, is installed at 509 m AGL in 1997 [53], [54].

28

Adapted from [55] (with permission from the author) Figure 3.8: CN Tower and lightning measurement systems

29

The old Rogowski coil encircles only one-fifth of the steel structure at 474 m AGL (Figure 3.10). Based on the five-sided steel structure configuration, the measured signal is expected to be 20% of the total current derivative signal [53], [54], [56]. The old coil is connected, via 146 m, 50 , tri-axial (double shielded coaxial) cable, to the recording station, placed at 410 m AGL, Figure 3.9. The new Rogowski coil encircles the whole steel structure at 509 m AGL, thus the total current derivative signal (Figure 3.11). The new coil is connected to the recording station at 410 m AGL via the optical fiber link. The new noise-protected current derivative recording system, consisting of the new coil and the optical fiber link, supressed a lot of noise, related issues faced by the old recording system [55]. The recording station, located at 410 m above ground, has one or more real-time digitizers, computer controller, and an optical transmission system. In 1990, recording station contained two 10 ns, 10 bit, double-channel with segmented memories Tektronix RTD 710A digitizers. This digitizer allows the capturing of eight return strokes per flash. For lightning flashes with more than eight return strokes, all return stroke were not captured due to limitations of the digitizer. This recording system is illustrated in Figure 3.12, which was used to capture the data used in this research study.

30

Figure 3.9: Old Rogowski coil encircles one-fifth of CN Tower steel structure

Figure 3.10: New Rogowski coil encircles the whole CN Tower steel structure

31

Figure 3.11: CN Tower measurement system setup, 1990-2003

In 2003, the RTD 710A digitizers were replaced by two 2 ns, 8 bit, double-channel, 1 MB/channel memory LeCroy LT342L Waverunner digitizers. The LeCroy allowed to capture up to twenty 200 s current derivative signals (maximum sampling rate of 500 MS/s). In 2007, a new 8 bit, double-channel, 64 MB/channel memory NI PCI-5114 high-speed digitizer was acquired (maximum sampling rate of 250 MS/s). For the first time, the recording station allowed to continuously record the lightning flashes for two seconds, set at 220 ns resolution. In 2015, 4 ns, 10 bit, 2 GB/channel memory, double-channel NI PXIe 5160 system was acquired. It was set to continuously record two full seconds of the lightning current derivative signal (maximum sampling rate of 50 GS/s) [53], [55]. The video recording system originally consisted of two low speed VHS cameras (Hitachi VM-3100A) and a set of video recorders (RCA VR 250, Hitachi VT-3050 A), located 2 km North and 11.8 km West of the CN Tower, respectively. Each VHS camera operated at 30 frames/second (33.3 ms resolution). In 1996, Phantom v2.0 high-speed digital system was added to the video

32

recording system, operating at 1000 frames/second and triggered by sudden changes in brightness. In 2006, Phantom v2.0 was upgraded with a more advanced system (Phantom v5.0) [55], [57]. The electric and magnetic field measurement system, which was located at Rosebrugh Building at the University of Toronto, recorded the vertical component of the electric field (E z), the radial component of the magnetic field (Hr), and the azimuthal component of the magnetic field (H). The sensors were connected to a recoding station, identical to the recording station placed at the tower then. A return-stroke velocity measuring system was also located at Rosebrugh Building, containing 35-mm single-lens reflex camera and eight photo-diodes for the measurement of the return stroke velocity [52].

Summary
Benjamin Franklin discovered that lightning is electrical and proved that thunderclouds are electrically charged through his famous kite-experiment in 1752. The chapter introduced two main models, precipitation and convection, used to understand the electrical dipole structure of the thundercloud. Since then, modifications have been made to these presumed structure to propose a more accurate representation of a thundercloud called tripolar model. This chapter also discussed important lighting formation highlighting important lightning terminologies, types of lightning and tall-structure lighting. Obviously, CN Tower lightning strokes played the major role in this research. That is why this chapter discussed how the lightning data was recorded and including the major improvements done on the measurement systems for acquiring accurate data.

33

Chapter 4 4. Simulating Functions
Introduction
Many researchers did investigate a number of simulating functions for modelling the lightning return-stroke current and its time derivative, such as the double exponential function [22]Â­[24]. However, such functions were found to create problems in modelling the lightning return-stroke current due to discontinuities in their first and second time derivatives [24], [25]. On the other hand, Heidler function and Pulse function do not have such discontinuity problems [22], [58]. Therefore, a simulation function must satisfy the minimum four requirements, shown below, to successfully simulate the lightning return-stroke current () and its time derivative [24], [59]. 1) The simulation function must be differentiable (should not have any discontinuities) and must be zero at the instant of time  = 0.

2) The first time derivative

of simulating function must be zero at time  = 0 and

must not have any discontinuities at time  = 0. 3) The second time derivative of a simulating function must not have any discontinuities. 4) The simulating function must properly fit the measured current derivative signal.

34

Current Waveform Parameters
In modelling lightning return-stroke current waveforms, there are important parameters to consider [22], [24], [59]. They are highlighted below and illustrated in Figure 4.1 and Figure 4.2: 1) Current rise time 2) Maximum current steepness and time at which it occurs 3) Current peak 4) Time to 50% of current peak 5) Charge transfer Current rise time is the difference in time starting at 10% level to 90% level of current peak. It shows how fast the wavefront is. One issue with lightning current is the high-frequency interference and it is important that the simulating function is able to model the fine details of the measured data during the current rise [24]. Maximum current steepness is the location where the first current derivative reaches its maximum. This is an important parameter for both modelling of the lightning return-stroke current and for important calculations. From a Power Engineer's point-of-view, maximum current steepness and current peak values are important parameters for the lightning electromagnetic pulse (LEMP) calculations [24].

35

The current peak is considered to be the first peak reached by the current waveform before the arrival of reflections. The higher peak is called the absolute peak (Figure 4.2), which is a result of reflections from CN Tower's structural discontinuities, as explained in [10], [53], [60]. The other important parameters, time to 50% of the current peak and the charge transfer in the lightning channel, are used in engineering calculations on lightning protection.

Current Derivative [kA/Âµs]



Figure 4.1: Current derivative waveform

36

Current [kA]

Figure 4.2: Current waveform; as well as the current peak, 90%, 50% and 10% current levels

37

Single-Term Heidler and Pulse Functions
The simulating functions, Heidler and Pulse functions, each consists of a rise function () and a decay function (). Rise and decay functions have a decoupling relationship with the condition that during the rise ()  1 and during the decay ()  1 [24]. This decoupling relationship enables one to investigate the influence of each parameter on the current function [24], [59]. The general single-term current waveform of each simulation function is defined as: () =   ()  () Mathematically, the Heidler current function and its derivative are defined as in [24], [58]:   1+ () = ()     (1)

() = 



(2)

 1    - - ( +  )  

(3)

 () = ()   Where,    

  - 1 2 -   

-

   3 - 1 2 1 + + ( +  )   

(4)

 is a control parameter of the amplitude of the single-term current function ()  is the rise time constant  is the decay time constant  is an exponent value that is greater than or equal to 1.1
38

Similarly, Pulse current function and its derivative are defined as [58]:


() =  1 -  () = ()     

 1 

(5)

-

(6)

1 -   

  ()  = ()      Where,    

2  - -   1 -  

  1 - 



1 - 

 1  +    

(7)

 is a control parameter of the amplitude of single-term current function ()  is the rise time constant  is the decay time constant  is an exponent value that is greater than or equal to 1.1

To obtain the best fit for the measured current derivative waveform, the time derivatives of Heidler and Pulse functions are used for the simulation. The current functions are then obtained by integrating the simulated current derivatives. Some constraints are introduced to improve the fitting of each current derivative simulation as in [10], [21], [22]. Constraints force the analytical parameters such as ,  , and  to reach their optimal values, which yields a better fit of the simulated current. These constraints include:

39

()  ()| ()   () 

=0 =  = 

(8) (9) (10)

=0

(11)

Where,       is the maximum amplitude of the current function () is the time at which the current reaches its initial peak is the maximum steepness of the current function () or the maximum amplitude
( )

of the current derivative function 



is the time at which the maximum steepness of the current function () or the time
( )

at which the maximum amplitude of the current derivative function

occurs

Forcing the maximum steepness constraint (11),

( )

= 0, provides the best fit as

explained in [10], [22], [58]. Applying the maximum steepness constraint on the second time derivative of Heidler function (4) and simplifying the mathematical equation gives the following expression:

40

 = 

 + 1  - 1

(12)

Equation (12) is substituted into (2) and (3) where  is the only unknown.  () =   1+ () = ()      - 1  + 1   - 1  + 1 ( )  + 1 +   - 1

(13)

 -  

(14)



Applying the same forcing constraint described in (11) on the second time derivative of Pulse function (7) and simplifying gives the following expression:

 = 

(15)

Equation (15) is substituted into (5) and (6) where  is the only unknown.

() =  1 - 



(16)

() = ()  

  1 - 

-

1 

(17)

41

Double-Term Heidler and Proposed Double-Term Pulse Functions
Mathematically, double-term Heidler current function and its derivative are defined as [10], [21], [58].    1+     1+ 

() = 



+ 



=  () +  ()

(18)

() =  ()  

 1 -  

-

 (  + 

)

+  () 

)  1  ( - -    + 

(19)

 ()  =    +  2 



 

 - 1 2 -    

+

 (  + 

) 2 (  +   ( 

)

-

3 - 1  )

-

+

2  +    +  1 



-

 - 1 2 -  

+

) 2 (  + 

+ 

-

3 - 1 2 -  

-

(20)

42

Where,      and  are control amplitude parameters of the double-term current function ()   and  and  are the rise times of the double-term current function () are decay time constants of the double-term current function ()

 and  are exponent that are greater than or equal to 1.1

The proposed double-term Pulse function is defined in (21) and its first and second timederivatives are given in (22) and (23), respectively.

() = 

1 - 



+ 

1 - 



=  () +  ()

(21)

() =  ()  

 

 1 - 

-

1 

+  () 

 

 1 - 

-

1 

(22)

43

 () =  

1 - 



       1 -  

2 -  

 + 1 - 

1 

 - 

 1 - 

   +   

1 - 



       1 -       

2 +  

 1 - 

1  - +  



 1 - 

(23)

Where,   and  are control parameters of the amplitude of the double-term current function ()      and  and  are rise time constants of the double-term current function () are decay time constants of the double-term current function ()

 and  are exponent values that are greater than or equal to 1.1

To obtain the best fit for the measured current derivative waveform, the time derivative of Heidler and Pulse functions are used here for the simulation. Then, the simulated current derivatives are integrated to obtain the current function.

44

Similar to single-term simulating functions, constraints force the analytical parameters  ,  ,  ,  ,  , and  to reach their optimal values, which yields a better fit of the simulated
( )

current. Forcing the maximum steepness constraint (11),

= 0, provides the best fit.

However, it was not possible to directly apply the maximum steepness constraint on the double-term Heidler function and obtain a closed expression for  and  . Therefore, the

maximum steepness constraint (11) is applied onto equation (18) to derive the following expressions.    - 1 2 -    (  +  ) 2    +  3 - 1 

 (

) =  (

)

+

-

-

2 

+

2 

(24)

 (

)= -

  1+  



 

 - 1 2 -  

+

 (  + 

) 2 (  + 

)

-

3 - 1 2 -  

+

2 

(25)

 =

 ( )  ( )

(26)

Then, the expression for  is substituted into (19) to acquire the final expression (27), which is be used in the fitting process.

45

() =  ()  

)  1  (  - -    + 

+

 ( )   ( )

 1 -  

-

 (  + 

) (27)

For the proposed double-term Pulse function, same procedure is applied onto equation (21) to derive the following expressions.

 (

  ) =  ()     

 1 - 

-

2  

 1 - 

+

1 

 - 

   

 1 - 

    

(28)

 (

) = 1 - 



          

 1 - 

-

2  

 1 - 

+

1 

 - 

   

 1 - 

(29)

 =

 ( )  ( )

(30)

Equation (30) is substituted into (22) to derive the final expression (31), which is to be used in the fitting process.
46

() =  ()  

 

 1 - 

-

1 

+

 ( )   ( )

 

 1 - 

-

1 

(31)

Summary
Investigating simulating functions for modelling the lightning return-stroke current, it was found out that Heidler and Pulse functions are more appropriate, assuming they do not face problems arising from discontinuities in their first and second time derivatives. When modelling the lightning return-stroke current, there are key parameters to consider: current rise time, and the maximum current steepness and the time at which it occurs, current peak, time to 50% of the current peak value, and charge transfer. Knowledge of these parameters are important in lightning protection in order to increase the safety regulations to better protect main infrastructures (for example, power-lines, buildings and houses) and most importantly people. This chapter also introduced the single-term Heidler and Pulse functions, as well as the doubleterm Heidler and the proposed double-term Pulse functions. The time derivatives of Heidler and Pulse functions are used to obtain the best fit for the measured current derivative waveform. The simulated current derivative functions are integrated to obtain the current functions. Constraints are used to improve the fitting of the measured return-stroke lightning current waveform. The maximum steepness constraint is found to give the best fitting and applied on single-term and double-term simulating functions as explained in [10], [22], [58]. The derived expressions of single-term and double-term simulating functions, (14), (17), (27) and (31), are to be used in the modelling process in the subsequent chapters.

47

Chapter 5 5. Modelling Process
Introduction
The lightning modelling process, described in this chapter, utilize the 3 rd and the 6th returnstroke current derivatives from a multi-stroke flash recorded at the CN Tower on June 10 th 1996 at 23:44:03. Before starting the modelling process, the raw data needs to be analyzed to choose an appropriate starting point on the measured waveform and identify the measured data unaffected by reflections. This chapter will also model the measured lightning current derivative data utilizing single-term and double-term simulating functions, as described in Chapter 4.

Matching Waveforms
For the fitting process, the starting point of the current derivative waveform is chosen from the measured lightning return-stroke current derivative [21]. The starting point of the 3 rd returnstroke current derivative waveform at which
( )

 0 has been determined to be at

 = - 0.50 . Figure 5.1 illustrates that the 3rd return-stroke current derivative signal is shifted to the right by  = - 0.50  . The 6th return-stroke current derivative signal is to be used in the same manner and it is illustrated in Figure 5.2.

48

STARTING POINT -0.5s
Current Derivative [kA/Âµs]
Current Derivative [kA/Âµs]

ZOOMED

Figure 5.1: The 3rd return-stroke current derivative waveform. A zoomed-in view illustrates the starting point at which di/dt  0

40 35 30 25 20 15 10 5 0 -5 -1

STARTING POINT -0.21s

ZOOMED

-0.8

-0.6

-0.4

-0.2

0 Time [Âµs]

0.2

0.4

0.6

0.8

1

Figure 5.2: The 6 return-stroke current derivative waveform. A zoomed-in view illustrates the starting point at which di/dt  0

th

49

The measured waveforms are then divided into three time windows. The decoupling relationship of Heidler and Pulse functions (both single-term and double-term) allow the signal to be easily divided into sections [22]. The three time windows are described in Figure 5.3 using the 6th return-stroke current derivative waveform: 1) First time window: contains the initial impulse before the arrival of reflections 2) Second time window: contains the early decay part of the waveform and reflections 3) Third time window: contains the decay portion of the waveform, in which the decay factor is less affected by reflections Figure 5.4 illustrates the first time window of the 3rd return-stroke current derivative measured signal. The duration of the first time window is 0    1.06  because reflections from the space deck is visible after  = 1.06  [10]. Likewise, Figure 5.5 depicts the first time window of the 6th return-stroke current derivative measured signal. The duration of this first time window is 0    1.06 . These first time windows will be used in the modelling of singleterm and double-term simulating functions in Chapter 5.5 and 5.6.

50

(1)
Current Derivative [kA/Âµs]

(2)

(3)

Current [kA]

Figure 5.3: The first time window, (1), second time window, (2), third time window, (3), shown 6th return-stroke current derivative measured signal and its current waveform.

51

FIRST TIME WINDOW 0 - 1.6s

Figure 5.5: The first time window of the 3rd return-stroke current derivative measured signal
40 35 30 25 20 15 10 5 0 -5

FIRST TIME WINDOW 0 - 0.6s

0.2

0.4 Time [Âµs]

0.6

0.8

1

Figure 5.4: The first time window of the 6th return-stroke current derivative measured signal
52

Figures 5.6 and Figure 5.7 illustrate the third time windows of the 3 rd and 6th return-stroke current waveforms obtained by numerically integrating their current derivative measured waveforms, respectively. These time windows are used to estimate the single-term simulating functions' decay time constants,  , as explained in Chapter 5.3. Similarly, the third time windows are used to determine the double-term simulating functions' decay time constants,  explained in Chapter 5.4. and  , as

THIRD TIME WINDOW 30 - 60s

Figure 5.6: The third time window of the 3rd return-stroke current waveform

53

12

10

8

6

4

THIRD TIME WINDOW 14 - 62s

2

0

10

20

30 Time [Âµs]

40

50

60

Figure 5.7: The third time window of the 6th return-stroke current waveform

54

Estimating the Decay Constants using Single-Term Simulating Functions
First step in approximating the analytical parameters is to estimate the decay time constant,  . In order to estimate  , it is necessary to observe the behaviour of Hiedler and Pulse current functions when    . During the decay portion, both simulating functions described in (2) and (5) are simplified to:

() =     can be estimated by fitting the decay function described by (32) in the third time window using MATLAB Curve Fitting Toolbox. For matching the 6th return-stroke current waveform, using the third time window described in Figure 5.7, it was found that  = 113.9  and I = 9.747kA with R2 fitting of 0.9248. This fitting is illustrated in Figure 5.8. R 2 fitting factor defines the goodness-of-fit in statistics. It describes the square of the correlation between the observed data and the fitted data. R 2 fitting factor varies between 0 and 1; close to 1 indicates a good fit [22]. Another method is to calculate the decay time constant analytically. Suppose  and  are two arbitrary points and  and  are the corresponding current values for each respectively. The two equations using (32) are defined as follows:

(32)

 () =     () =   

(33)

55

Using (33), the decay time constant is expressed as follows:  -   ln 

 =

(34)

For the 3rd return-stroke current measured waveform, it was difficult to estimate the decay time constant using MATLAB Fitting Toolbox and fitting was extremely poor. Thus, the analytical method was used to estimate  and MATLAB Fitting Toolbox was used to find I. It was found out that  = 405.13  and I = 16.71 kA with R2 fitting of 0.64 (closer to 1 which indicates a good fit). This fitting is illustrated in Figure 5.9.

Current [kA]

Figure 5.8: The 6th return-stroke current signal and the fitting of the decay function described by (32) into third time window 14 Â­ 62 s

56

20 18 16 14 12 10 8 6 4 2 0 10 20 30 Time [Âµs] 40 50 60

Figure 5.9: The 3rd return-stroke current waveform and the fitting of the decay function described by (33) and (34) into third time window 30 Â­ 60 s

57

Estimating the Decay Constants using Double-Term Simulating Functions
Similar to estimating the analytical parameters for single-term simulating functions, the first step in approximating the analytical parameters in double-term simulating functions is to estimate the decay time constants  are simplified to: and  . During the decay portion, both simulating functions

() =     and 

+    can be estimated by fitting the decay function described by (35) into a chosen

(35)

third time window, using MATLAB. For the 6th return-stroke current measured waveform, using the third time window described in Figure 5.7, it was found out that  = 0.09754 ,  =

110 ,  = 0.2785 , and  = 9.834  with R2 fitting of 0.9325, indicating a good fit. The fitting process is illustrated in Figure 5.10. For the 3rd return-stroke current measured waveform, it was difficult to estimate the decay time constants using MATLAB Fitting Toolbox and fitting was extremely poor. Thus, analytical method (36) was used to estimate   with  and MATLAB Fitting Toolbox was used to find  ,  , and = 405.13  ,  = 0.2785 ,  = 16.6 , and

fixed. It was found that 

 = 0.09754  with R2 fitting of 0.6317, indicating a reasonable fit. This fitting is illustrated in Figure 5.11.  -   ln 
58



=

(36)

12

10

8

6

4

2

0

10

20

30 Time [Âµs]

40

50

60

Figure 5.10: The 6th return-stroke current waveform and the fitting of the decay function described by (35) into the third time window 14 Â­ 62 s
20 18 16 14 12 10 8 6 4 2 0 10 20 30 Time [Âµs] 40 50 60

Figure 5.11: The 3 return-stroke current waveform and the fitting of the decay function described by (35) and (36) into the third time window 30 Â­ 60 s
59

rd

Single-Term Simulating Functions
The time derivative of single-term Heidler and Pulse functions described by (14) and (17), respectively, are used in the fittings of 3rd and 6th current derivative measured waveforms. The fitting is conducted using MATLAB Curve Fitting Toolbox to estimate the unknowns  and  . The single-term Heidler and Pulse functions' fittings obtained for the 3 rd current derivative measured waveform and its current waveform are illustrated in Figure 5.12 and Figure 5.13,

respectively. The analytical parameters obtained for this waveform is summarized in Table 5.1 along with R2 fitting factor. Observing Figure 5.12, first characteristic to emphasize is  , time at which maximum

amplitude of current derivative occurs. The time derivative of single-term Heidler and Pulse current waveforms match  of the 3rd current derivative measured waveform, which was

attained using the forcing constraint. Thus, the maximum steepness of the current occurs at the same instant of time. Table 5.1 indicates that the time derivative of the single-term Pulse function simulation was able to fit 95.65% of the current derivative measured waveform peak, whereas that using time derivative of single-term Heidler function was able to fit only 90.84% of the peak. Hence, the time derivative of the single-term Pulse function is a more suitable simulation function to fit the 3rd current derivative measured waveform. However, Pulse simulation function did not achieve the maximum amplitude of the current derivative measured waveform at  (Figure 5.12

zoomed-in view). The maximum amplitude of 3rd current derivative measured waveform is 53.42 kA/s and the time derivative of the single-term Pulse function estimated it to be 49.27 kA/s. More work must be done to match the current derivative measured waveform peak.

60

Figure 5.13 indicates that the peak of 3rd return-stroke current waveform was reached by Heidler function simulation. Figure 5.13 (zoomed-in view) illustrates that Pulse function simulation reached the current peak slower compared with Heidler's. However, both simulating functions reasonably simulated the 3rd return-stroke current signal (obtained by numerically integrating the measured return-stroke current derivative signal).

Table 5.1 Fitting Results and R2 Factor for the 3rd Return-stroke Current Derivative Signal

Single-term Simulating Function Heidler Pulse

I [kA] 11.4 11.4

 [s] 0.9051 0.08487

 [s] 405.13 405.13

 18.9 4.0314 Ã 10

R2 0.9084 0.9565

61

60

50

40

30

20

10

0

-10

0.5

1

1.5 Time [Âµs]

2

2.5

3

60 55 50 45 40 35 30 25 20 0.75

ZOOMED

0.8

0.85

0.9 Time [Âµs]

0.95

1

1.05

Figure 5.12: Fitting of time derivative of Heidler and Pulse functions for the 3 rd return-stroke current derivative measured signal. The zoomed-in view shows the fitting of the simulating functions near the maximum amplitude.

62

12

10

8

6

4

2

0 0.5 1 1.5 Time [Âµs] 2 2.5 3

14 13 12 11 10 9 8 7 6

ZOOMED

0.8

1

1.2

1.4 Time [Âµs]

1.6

1.8

2

Figure 5.13: Heidler and Pulse functions' fittings for the 3rd return-stroke current signal. The zoomed-in view shows the fitting of the simulating functions near the current peak.

63

The same methodology described using the 3rd return-stroke current derivative measured waveform was followed to fit the simulation functions for the 6 th return-stoke current derivative measured waveform. Heidler and Pulse functions' fittings obtained for the 6 th return-stroke current derivative measured waveform and its current waveform are illustrated in Figure 5.14 and Figure 5.15, respectively. The analytical parameters obtained for this waveform are summarized in Table 5.2 along with R2 fitting factor. In Figure 5.14,  waveforms match  of the time derivative of single-term Heidler and Pulse current

of the 6th return-stroke current derivative measured waveform, which was

attained using the maximum steepness constraint. Similar to the simulation of the 3 rd return-stroke current derivative measured waveform, the maximum steepness of the current occurs at the same instant of time. Table 5.2 indicates that the time derivative of the single-term Pulse function did fit 94.56% of the current derivative measured waveform peak, whereas using the time derivative of the single-term Heidler function allowed only to fit 87.77% of the peak. So, the time derivative of the single-term Pulse function proves to be more suitable for simulating the 6 th return-stroke current derivative signal. However, the time derivative of the single-term Pulse function exceeded the time derivative peak as shown in the zoomed-in view (Figure 5.14). The maximum amplitude of the 6th return-stroke current derivative measured waveform is 36.97 kA/s, the time derivative of the single-term Heidler function estimated it to be 36.38 kA/s, and the time derivative of the single-term Pulse function estimated it to be 38 kA/s. Therefore, the time derivative of singleterm Heidler function estimated the maximum amplitude of the 6 th return-stroke current derivative measured waveform at  much better, in comparison with the time derivative of the single-term

Pulse function estimation, even though it has a lower R 2 fitting factor.

64

Figure 5.15 indicates that the peak of the 6th return-stroke current waveform was reached by Heidler function simulation. Observing Figure 5.15 (zoomed-in view), shows that Pulse function simulation reached the current peak slower compared with Heidler's. However, both simulating functions fairly simulated the 6th return-stroke current signal (obtained by numerically integrating the measured return-stroke current derivative signal).

Table 5.2 Fitting Results and R2 Factor for the 6th Return-stroke Current Derivative Signal

Single-term Simulating Function Heidler Pulse

I [kA] 7.9 7.9

 [s] 0.4242 0.07672

 [s] 113.9 113.9

 7.678 209.37

R2 0.8777 0.9456

65

40 35 30 Current Derivative [kA/Âµs] 25 20 15 10 5 0 -5 -10 0.5 1 1.5 Time [Âµs] 2 2.5 3

38 36 34 32 30 28 26 24 22 20

ZOOMED

0.35

0.4 Time [Âµs]

0.45

0.5

Figure 5.14: Time derivative of Heidler and Pulse functions for the fitting of the 6 th return-stroke current derivative measured signal. The zoomed-in view shows the fitting of the simulating functions near the maximum amplitude.

66

10 9 8 7 Current [kA] 6 5 4 3 2 1 0 -1 0.5 1 1.5 Time [Âµs] 9 2 2.5 3

8.5

ZOOMED
8

7.5

7

6.5

6

5.5

0.5

1 Time [Âµs]

1.5

Figure 5.15: Heidler and Pulse functions' fittings of the 6th return-stroke current waveform. The zoomed-in view shows the fitting of the simulating functions near the current peak.

67

Double-Term Simulating Functions
The time derivative of double-term Heidler and the proposed double-term Pulse functions described by (27) and (31) are, respectively, used in fitting the 3rd and 6th return-stroke current derivative signals. The fitting is conducted using MATLAB Fitting Toolbox to estimate the unknowns:  ,  ,  ,  ,  ,  and  .

The double-term Heidler function and the proposed double-term Pulse function simulation fittings, obtained for the 3rd return-stroke current derivative signal and its current waveform are illustrated in Figure 5.16 and Figure 5.17, respectively. The analytical parameters obtained for this waveform is summarized in Table 5.3 along with the R 2 fitting factor. Observing Figure 5.16, the first characteristic to emphasize is  ; the time at which the

maximum amplitude of current derivative occurs. The time derivative of the proposed double-term Pulse current waveform matches the  of the 3rd return-stroke current derivative measured

waveform, whereas the time derivative of double-term Heidler waveform is shifted to the right by 0.02s. The location of the simulated peak based on the proposed double-term Pulse function is close to the measured peak. Table 5.3 indicates that the simulation based on the time derivative of the proposed doubleterm Pulse and double-term Heidler functions produced excellent fittings of R 2 = 0.9745 and R2 = 0.966, respectively. The simulation based on the proposed double-term Pulse function produced a slightly better fit than that based on double-term Heidler function. Furthermore, the location of the maximum current derivative peak based on the proposed double-term Pulse function simulation is much closer than that using double-term Heidler function (Figure 5.16, zoomed-in view).
68

However, the maximum amplitude of the 3rd return-stroke current derivative measured waveform is 53.42 kA/s, the time derivative of the proposed double-term Pulse function estimated it to be 48.6 kA/s and the time derivative of double-term Heidler function estimated it to be 49.11 kA/s. Figure 5.17 indicates that the current peak of 3rd return-stroke current waveform was not reached by double-term Heidler and the proposed double-term Pulse functions. Figure 5.17 (zoomed-in view) illustrates the proposed double-term Pulse function rises and try to reach the current peak slightly slower than that of Heidler's. Both double-term Heidler and the proposed double-term Pulse functions reasonably simulated the measurement (obtained by numerically integrating the measured return-stroke current derivative signal).

Table 5.3 Fitting Results and R2 Factor for the 3rd Return-stroke Current Derivative Signal

Doubleterm I1 Simulating [kA] Function Heidler Pulse

I2 [kA]



[s]

 [s]

 [s]

 [s]





R2

16.6 0.09754

0.9272

0.1519 405.13 0.2785

17.72 1.072 Ã 10

1.829 1.944

0.966 0.9745

16.6 0.09754 0.07855 0.1969 405.13 0.2785

69

50

Current Derivative [kA/Âµs]

40

30

20

10

0

-10

0.5

1

1.5 Time [Âµs]

2

2.5

3

ZOOMED
50 Current Derivative [kA/Âµs]

45

40

35

30

25 0.8 0.85 0.9 Time [Âµs] 0.95 1

Figure 5.16: Fitting the time derivative of Heidler and Pulse functions to the 3 rd return-stroke current derivative measured signal. The zoomed-in view shows the fitting of the simulating functions near the maximum amplitude.

70

14

12

10

8

6

4

2

0 0.5 1 1.5 Time [Âµs] 2 2.5 3

13

ZOOMED

12

Current [kA]

11

10

9

8

7

1

1.2

1.4 Time [Âµs]

1.6

1.8

2

Figure 5.17: Fitting Heidler and Pulse functions to the 3 rd return-stroke current waveform. The zoomed-in view shows the fitting of the simulating functions near the current peak.

71

The same methodology described using the 3rd return-stroke current derivative signal was used for fitting the simulation functions to the 6th return-stroke current derivative signal. The double-term Heidler function and the proposed double-term Pulse function fittings obtained for the 6th return-stroke current derivative signal and its current waveform are illustrated in Figure 5.18 and Figure 5.19, respectively. The analytical parameters obtained for this waveform is summarized in Table 5.4 along with the R2 factor. In Figure 5.18,  the  of the time derivative of the double-term Heidler function matches

of the 6th return-stroke current derivative signal. This result was attained using the

maximum steepness constraint, whereas the time derivative of the proposed double-term Pulse function waveform is shifted to the right by 0.01s. The proper location of the peak is better obtained using the time derivative of the double-term Heidler function. Table 5.4 indicates that the simulation based on the time derivative of the proposed doubleterm Pulse and double-term Heidler functions produced, respectively, excellent fittings: R2 = 0.9975 and R2 = 0.998. The simulation based on double-term Heidler function produced a slightly better fit than that based on the proposed double-term Pulse function. However, the location of the maximum current derivative peak based on the proposed double-term Pulse function simulation is much closer than that using the double-term Heidler function (Figure 5.18, zoomed-in view). The maximum amplitude of the 6th return-stroke current derivative measured signal is 36.97 kA/s, the time derivative of the double-term Heidler function estimated it to be 37.93 kA/s and the time derivative of the proposed double-term Pulse function estimated it to be 37.45 kA/s. Thus, the maximum current derivative peak based on the proposed double-term Pulse function simulation is much closer than that using the double-term Heidler function (Figure 5.18, zoomed-in view).
72

Figure 5.19 indicates that the peak of the 6th return-stroke current waveform was not reached using the double-term Heidler function and the proposed double-term Pulse function. But the proposed double-term Pulse current function has a minor overshoot in comparison with the double-term Heidler current function. Observing Figure 5.19 (zoomed-in view) shows that doubleterm Heidler current function reaches the current peak slower in comparison with the proposed double-term Pulse current function. Generally, the double-term Heidler and the proposed doubleterm Pulse current functions reasonably simulated the measurement (obtained by numerically integrating the measured return-stroke current derivative signal).

Table 5.4 Fitting Results and R2 Factor for the 6th Return-stroke Current Derivative Signal

Doubleterm Simulating Function Heidler Pulse

I1 [kA] 9.989 8.136

I2 [kA]

 [s] 0.4164 0.0723



[s]

 [s] 110 110



[s]





R2

1.923 Ã 10 95.953

0.4484 0.04226

0.09754 0.09754

12.25 361.2

13.98 6.191 Ã 10

0.998 0.9975

73

40 35 30 25 20 15 10 5 0 -5 -10 0.5 1 1.5 Time [Âµs] 2 2.5 3

38

ZOOMED

36

34

32

30

28

26 0.35 0.4 0.45 Time [Âµs] 0.5

Figure 5.18: Fitting time derivative of Heidler and Pulse functions to 6 th return-stroke current derivative measured signal. The zoomed-in view shows the fitting of the simulating functions near the maximum amplitude.

74

9 8 7 Current [kA] 6 5 4 3 2 1 0

0.5

1

1.5 Time [Âµs]

2

2.5

9

ZOOMED
8.5 8 Current [kA]

7.5

7

6.5

6

5.5

0.5

1 Time [Âµs]

1.5

Figure 5.19: The fitting of Heidler and Pulse functions of the 6 th return-stroke current waveform. The zoomed-in view shows the fitting of the simulating functions near the current peak.

75

Summary
This chapter utilized the 3rd and the 6th return-stroke current derivative signals from one of the multi-stroke flashes recorded at the CN Tower on June 10 th 1996 storm at 23:44:03 to model. Single-term and double-term simulating functions were used in order to model the measured lightning current signals. Prior to starting the modelling process, an appropriate starting point was chosen and the measured signal was divided into three time windows. The decay time constants, for single-term and double-term simulating functions, were estimated using the third time window of the current signals. The other analytical parameters were estimated using the first time window of the recorded signals. Using single-term simulation functions, it was observed that the single-term Pulse function matched the recorded 3rd and 6th return-stroke current derivative signals better than using Heidler function. On the other hand, single-term Heidler function estimated the 3 rd and 6th return-stroke current waveforms better than the single-term Pulse function. However, observing the R 2 fitting factor for each simulation single-term Heidler and Pulse functions were able to fairly simulate the measured lightning return-stroke currents. Furthermore, using the double-term Heidler function and the proposed double-term Pulse function significantly improved the fittings of the current derivative signals, especially the rise time and decay time constants. In conclusion, double-term Heidler function and the proposed double-term Pulse function markedly improved tall-structure lightning return-stroke current derivative and current models.

76

Chapter 6 6. Recovery of Incomplete Signals
Introduction
One of the biggest challenges faced by many researchers is the incompletely-recorded return-stroke current derivative signals, which exceeded the maximum signal set levels [10]. These incompletely-recorded return-stroke current derivative signals, such as the 7 th return-stroke current derivative signal from a multi-stroke flash recorded at the CN Tower on June 10 th 1996 at 23:44:03, whose peaks markedly exceeded the noise level, are quite valuable for modelling purpose. Prior to starting the recovery of the incompletely-recorded 7 th return-stroke current derivative signal, a completely recorded signal with negligible amount of noise, the 6th return-stroke current derivative signal is artificially cut and the recovery process is applied on it.

Recovery of Artificially-Cut Signal
The measured data of the 6th return-stroke current derivative within the interval 0.35s < t < 0.55s is removed to obtain a waveform that is artificially cut at the 50% level from the peak, as illustrated in Figure 6.1. The methodology described in Chapter 5 using the 6th return-stroke current derivative measured waveform is followed to fit the simulating functions for the artificially-cut 6 th return-

77

stroke current derivative waveform. The fitting results obtained for the artificially-cut 6 th returnstroke current derivative waveform and its current waveform are illustrated in Figure. 6.2 and Figure 6.3, respectively. The analytical parameters obtained for this waveform is summarized in Table 6.1 along with the R2 fitting factor.

Current Derivative [kA/Âµs]

Figure 6.1: Artificially-cut waveform obtained by cutting the recorded returnstroke current derivative waveform at 50% level from the peak

78

Current Derivative [kA/Âµs]

Figure 6.2: Time derivative of the proposed double-term Pulse function of the artificially-cut return-stroke current derivative waveform fitting

Current [kA]

Figure 6.3: The fitting of the proposed double-term Pulse function of the artificially-cut current waveform.

79

Table 6.1 Fitting Results and R2 Factor I1 [kA] Artificiallycut ReturnStroke Current Derivative Waveform [s] [s] R2

 [s]



 [s]







7.051 Ã 10

1.859 0.07991

110

0.09754

4.577

227.6 0.9955

The recovery of the artificially-cut return-stroke current derivative waveform is obtained using the time derivative of the proposed double-term Pulse function. It was found to be more successful in the recovery of the artificially-cut return-stroke current derivative waveform in comparison with the time derivative of double-term Heidler function. In Figure 6.2,  of the time derivative of Pulse function waveform, which was attained

using the maximum steepness constraint, is shifted to the right by 0.02 s. Table 6.1 indicates that the simulation based on the time derivative of the proposed double-term Pulse function produced an excellent fitting of R2 = 0.9955. Furthermore, the time location of the current derivative peak, based on the proposed double-term Pulse function (Figure 6.2), is close to the location of the measured current derivative peak. Additionally, the maximum amplitude of the 6 th return-stroke current derivative measured waveform is 36.97 kA/s and the recovery using the time derivative of the proposed double-term Pulse function estimated peak is 36.52 kA/s. Thus, the maximum current derivative peak based on the proposed double-term Pulse function simulation is proved to be closer to the measured data.

80

Figure 6.3 indicates that the peak of the 6th return-stroke current waveform was not reached by Pulse function. It has a minor overshoot. However, the proposed double-term Pulse function reasonably recovered the artificially-cut 6th return-stroke current derivative waveform.

Recovery of Incompletely-Recorded Signal
The same methodology described in section 6.2 using the artificially-cut 6th return-stroke current derivative waveform is followed to fit the simulating functions for 7 th return-stroke current derivative waveform, the incompletely-recorded signal. The recovery of the incompletelyrecorded signal is obtained using the time derivative of the double-term Heidler function. It is found to be more successful in the recovery process in comparison with the time- derivative of the proposed double-term Pulse function. The fitting results obtained for the 7 th return-stroke current derivative waveform is illustrated in Figure 6.4. The analytical parameters obtained for this waveform is summarized in Table 6.2 along with the R 2 fitting factor. In Figure 6.4,  the  of the time derivative of double-term Heidler function waveform match

of the incompletely-recorded 7th return-stroke current derivative waveform, which was

attained using the maximum steepness constraint. Table 6.2 indicates that the simulation based on the time derivative of double-term Heidler function produced an excellent fitting of R 2 = 0.9843. The maximum amplitude of the 7th return-stroke current derivative waveform estimated by the time- derivative of Heidler function is 140.1kA/s. Thus, the double-term Heidler function simulation is very close to the measured data and reasonably recovered missing data.

81

The recovered 7th return-stroke current derivative waveform can be further analyzed by obtaining its current waveform through numerical integration. The current waveform of the recovered 7th return-stroke current derivative waveform is illustrated in Figure 6.5. The current peak level is 23 kA.

Current Derivative [kA/Âµs]

Figure 6.4: The fitting of the time derivative of Heidler function of the 7 th returnstroke current derivative waveform (incompletely recorded waveform)

82

25 Current Peak Level

20

15

10

5

0

1

2 Time [Âµs]

3

4

Figure 6.5: Current waveform of the recovered 7th return-stroke current derivative signal (obtained by numerical integration)

Table 6.2 Fitting Results and R2 Factor I1 [kA] 7th Return-stroke Current Derivative Waveform [s] [s] R2

 [s] 0.4695



 [s]







8.136

14.61

4.623 0.003905

11

95.33 0.9843

83

Summary
This chapter highlights one of the biggest challenges faced by many researches in the field of lightning studies, which is the many incompletely-recorded signals that exceeded the maximum signal set levels. In fact these incompletely recorded current derivative signals, whose peaks are well above the noise level, proved to be quite valuable for modelling purpose [10]. First, a complete large return-stroke current derivative signal with negligible amount of noise recorded on June 10th 1996, is artificially cut. Then, the time derivatives of the double-term simulating functions are used to try to recover the original artificially-cut signal for evaluating the proposed algorithm before applying it on the signal that was incompletely-recorded. The proposed method reasonably recovered the incompletely-recorded waveform. Furthermore, using the recovered signal it is possible to conduct further analysis and determine important waveform parameters such as current peak level, maximum current steepness and time at which it occurs, as well as the charge transfer. Such large signals would be utilized for the evaluation of tall-structure lightning modelling [10].

84

Chapter 7 7. Conclusions & Future Work
Following Benjamin Franklin's discovery that lightning was electrical through his experiments, many scientists carried out numerous experiments to better understand the lightning phenomenon. Although lightning is very captivating, it has devastating results on every-day life. Therefore, it is important to further study lightning to develop regulations and standards to protect both humans and properties. The first objective of this study is to improve and expand the lightning return-stroke models using double-term simulation functions. A new double-term Pulse function was proposed and was compared with the double-term Heidler function to determine which simulating function is better suited to model the tall-structure lightning return-stroke current. One of the biggest challenges faced by many researches in this field is incompletelyrecorded signals, which exceeded the maximum signal set levels. Incompletely recorded current derivative signals, whose peaks are well above the noise level, proved to be quite valuable for modelling purpose. The second objective is to successfully recover valuable incompletelyrecorded signals. The lightning modelling process described in this study used two recorded return-stroke current derivative signals from one of the multi-stroke flashes recorded at the CN Tower on June

85

10th 1996. The time derivative of the double-term Heidler and the proposed double-term Pulse functions were used in the fitting process. Before starting the fitting process, an appropriate starting point was chosen from each set of raw data. Due to decoupling characteristic of the simulating functions, each of the recorded waveforms were divided into three time windows in order to estimate the analytical parameters. The first time window was used in the modelling process and the third timewindow was used to estimate the decay time constants in the single-term and double-term simulating functions. Although the single-term Heidler and Pulse functions fairly simulated the 3 rd and 6th returnstroke current waveforms, it was found out that double-term Heidler and the proposed double-term Pulse functions resulted in a significant improvement. Thus, double-term simulation functions are better suited to model tall-structure lightning return-stroke currents. The next step was to investigate the recovery of valuable incompletely-recorded signals, such as the 7th return-stroke current derivative signal, recorded on June 10th 1996. Prior to starting the recovery of the incompletely-recorded 7th return-stroke current derivative signal, a completely recorded signal of the same flash, with negligible amount of noise, the 6 th return-stroke current derivative signal, was artificially cut and the recovery process was applied to it. It was concluded that the proposed method reasonably recovered the incompletelyrecorded 7th return-stroke current derivative signal. It was possible to determine important waveform parameters such as the current peak level, maximum current steepness and time at which it occurs, as well as charge transfer. Such large signals would be used for the evaluation of tallstructure lightning modelling.

86

The modelling process can be further improved by investing in the double-term Heidler and the proposed double-term Pulse functions more in-depth. More analytical parameters can be introduced to improve the fitting process. Also, exploring the effects of dividing the measured signal into more than three time windows and the choice of the starting point have on the accuracy of the analytical estimation of differeent parameters. It is worth emphasizing that this study only focused on the return-stroke lightning current data measured at the CN Tower. However, the same process of modelling and recovery of the incompletely-recorded signals can be applied on many other situations such as on current data measured at other tall-structures, important signals recorded in the medical field, and the recovery of other valuable signals.

87

REFERENCES
[1] V. A. Rakov and M. A. Uman. Lightning: physics and effects. Cambridge, U.K.: Cambridge University Press, 2003, pp. 1-687. [2] N. S. Gill. "What You Need to Know About the Greek God Zeus?" ThoughtCo. [Online]. Available: https://www.thoughtco.com/profile-of-the-greek-god-zeus-111915, March 22, 2018. [Accessed: 02-Jul-2018]. [3] M. A. Uman. The Lightning Discharge. Mineola, N.Y: Dover Publications, 2001, pp.1-377. [4] E. D. Perry. "Indra in the Rig-Veda." Journal of the American Oriental Society, vol. 11, pp. 117-208, October 28, 1882. [5] R. Storm. The Encyclopedia of Eastern Mythology: Legends of the East The Fabulous Myths and Tales of the Heroes, Gods and Warriors of Ancient Egypt, Arabia, Persia, India, Tibet, China and Japan. 13th ed. Pennsylvania, U.S.A: Lorenz Books, May 16, 2003, pp.1-256. [6] M. A. Uman. All about lightning. Mineola, N.Y: Dover Publications, 1986, pp.1-167. [7] North Carolina League of Municipalities. "Lightning Damage - ReadyNCLocal.org." [Online]. Available: http://www.readynclocal.org/storm-damage.aspx. [Accessed: 02-Jul-2018]. [8] R. L. Holle. "Some aspects of global lightning impacts," in International Conference on Lightning Protection (ICLP), Shanghai, China, October 11-18, 2014, pp. 1390Â­1395. [9] R. L. Holle. "Recent studies of lightning safety and demographics," in International Conference on Lightning Protection (ICLP), Vienna, Austria, September 2-7, 2012, pp. 1Â­14. [10] M. S. Rahimian and A. M. Hussein. "ATP Modeling of Tall-Structure Lightning Current: Estimation of Return-Stroke Velocity Variation and Upward-Connecting Leader Length." IEEE Trans. on Electromagnetic Compatibility, vol. 57, no. 6, pp. 1576Â­1592, December 2015. [11] M. Hajikhani, M. Z. A. Ab-Kadir, M. Izadi, C. Gomes, and J. Jasni. "Lightning fatalities and injuries in Malaysia from 2008 to 2015," in 33rd International Conference on Lightning Protection (ICLP), Estoril, Portugal, September 25-30, 2016, pp. 1Â­6. [12] A. Nag, M. J. Murphy, W. Schulz, and K. L. Cummins. "Lightning locating systems: Characteristics and validation techniques," in International Conference on Lightning Protection (ICLP), Shanghai, China, October 11-18, 2014, pp. 1070Â­1082. [13] B. Mills, D. Unrau, C. Parkinson, B. Jones, J. Yessis, and K. Spring. Striking Back: An Assessment of Lightning related Fatality and Injury Risk in Canada. Toronto, Ontario: Environment Canada, September 2006, pp.1-38. [14] K. L. Cummins and M. J. Murphy. "An Overview of Lightning Locating Systems: History, Techniques, and Data Uses, With an In-Depth Look at the U.S. NLDN." IEEE Trans. on Electromagnetic Compatibility, vol. 51, no. 3, pp. 499Â­518, August 2009.

88

[15] E. R. Williams. "The electrification of thunderstorms." Scientific American, vol. 259, pp.88-99, November 1988. [16] V. Cooray, R. Montano, and V. Rakov. "A model to represent negative and positive lightning first strokes with connecting leaders." Journal of Electrostatics, vol. 60, no. 2Â­4, pp. 97Â­109, March 2004. [17] V. Cooray and V. A. Rakov. "Engineering Lightning Return Stroke Models Incorporating Current Reflection From Ground and Finitely Conducting Ground Effects." IEEE Trans. on Electromagnetic Compatibility, vol. 53, no. 3, pp. 773Â­781, August 2011. [18] M. Ignjatovic et al. "Generalized traveling current source return stroke model with current reflections and attenuation along the channel," in International Conference on Lightning Protection (ICLP), Shanghai, China, October 11-18, 2014, pp. 367Â­371. [19] K. Mehranzamir, B. Salimi, and Z. Abdul-Malek. "Comparative study of lightning models with lightning discharges in Malaysia," in Annual Report Conference on Electrical Insulation and Dielectric Phenomena, Shenzhen, China, October 20-23, 2013, pp. 1085Â­1088. [20] K. LundengÃ¥rd, M. Ranci, V. Javor, and S. Silvestrov. "Estimation of pulse function parameters for approximating measured lightning currents using the Marquardt least-squares method," in International Symposium on Electromagnetic Compatibility, Gothenburg, Sweden, October 23, 2014, pp. 571Â­576. [21] M. Milewski and A. M Hussein. "Tall-Structure Lightning Return-Stroke Modelling," in 14th International Middle East Power Systems Conference (MEPCON'10), Cairo University, Egypt, December 19-21, 2010, Paper ID313, pp. 947Â­952. [22] K. Elrodesly and A. M Hussein. "Cn Tower Lightning Return-Stroke Current Simulation." Journal of Lightning Research, vol. 4, no. 1, pp. 60Â­70, July 2012. [23] Y. Chen and L. Wang. "Research on channel-base current of lightning return stroke," in Second International Conference on Mechanic Automation and Control Engineering, Hohhot, China, July 1517, 2011, pp. 7579Â­7582. [24] F. Heidler and J. Cveti. "A class of analytical functions to study the lightning effects associated with the current front." European Transactions on Electrical Power, vol. 12, no. 2, pp. 141Â­150, March 22, 2002. [25] R. D. Jones. "On the Use of Tailored Return-Stroke Current Representations to Simplify the Analysis of Lightning Effects on Systems." IEEE Trans. on Electromagnetic Compatibility, vol. EMC-19, no. 2, pp. 95Â­96, May 1977. [26] V. Javor. "New functions for representing IEC 62305 standard lightning currents," in 30th International Conference on Lightning Protection (ICLP), Cagliari, Italy, September 13-17, 2010, pp. 1Â­5. [27] V. Javor and P. D. Rancic. "A Channel-Base Current Function for Lightning Return-Stroke Modeling." IEEE Trans. on Electromagnetic Compatibility, vol. 53, no. 1, pp. 245Â­249, February 2011. 89

[28] S. Vujevic, D. Lovric, and Z. Balaz. "Numerical approximation of the lightning current function," in SoftCOM 2009 - 17th International Conference on Software, Telecommunications Computer Networks, Hvar, Croatia, September 24-26, 2009, pp. 19Â­23. [29] S. Vujevi and D. Lovri. "Exponential approximation of the Heidler function for the reproduction of lightning current waveshapes." Electric Power Systems Research, vol. 80, no. 10, pp. 1293Â­1298, October 2010. [30] M. Y. Tomasevich, A. C. S. Lima, and R. F. S. Dias. "Approximation of Lightning Current Waveforms Using Complex Exponential Functions." IEEE Trans. on Electromagnetic Compatibility, vol. 58, no. 5, pp. 1686Â­1689, October 2016. [31] V. Javor. "Lightning current derivatives approximation," in 24th International Conference on Software, Telecommunications and Computer Networks (SoftCOM), Split, Croatia, September 22-24, 2016, pp. 1Â­4. [32] V. Javor. "Modeling of Lightning Strokes Using Two-Peaked Channel-Base Currents." International Journal of Antennas and Propagation, vol. 2012, Article ID 318417, pp. 1Â­7, 2012. [33] V. Javor, "Representing measured lightning discharge currents by the multi-peaked function," in 23rd International Conference on Software, Telecommunications and Computer Networks (SoftCOM), Split, Croatia, September 16-18, 2015, pp. 56Â­59. [34] V. A. Rakov and M. A. Uman. "Review and evaluation of lightning return stroke models including some aspects of their application." IEEE Trans. on Electromagnetic Compatibility, vol. 40, no. 4, pp. 403Â­426, November 1998. [35] T. E. Raghunathan, J. Lepkowski, J. H. Van Hoewyk, and P. W. Solenberger. "A Multivariate Technique for Multiply Imputing Missing Values Using a Sequence of Regression Models." Survey Methodology, vol. 27, No.1, pp.85-95, June 2001. [36] K. Kazlauskas, and R. Pupeikis. "Missing Data Restoration Algorithm." Informatica, vol. 25, no. 2, pp. 209Â­220, June 2014. [37] P. Medentzidou and C. Kotropoulos. "Restoration of missing data in Greek folk music by interpolation techniques," in Digital Media Industry Academic Forum (DMIAF), Santorini, Greece, July 4-6, 2016, pp. 107Â­112. [38] G. Peceli. "A common structure for recursive discrete transforms." IEEE Transactions on Circuits and Systems, vol. 33, no. 10, pp. 1035Â­1036, October 1986. [39] L. Sujbert and G. Orosz. "FFT-Based Spectrum Analysis in the Case of Data Loss." IEEE Transactions on Instrumentation and Measurement, vol. 65, no. 5, pp. 968Â­976, May 2016. [40] N. Khan et al. "Implementation of linear prediction techniques in state estimation," in 10th International Bhurban Conference on Applied Sciences Technology (IBCAST), Islamabad, Pakistan, January 15-19, 2013, pp. 77Â­83.

90

[41] T. Abatzoglou and P. Convery. "Maximum Likelihood Restoration of Missing Samples in Sinusoidal Data," in Conference Record of the Thirty-Ninth Asilomar Conference onSignals, Systems and Computers, Pacific Grove, CA, USA, October 30 Â­ Novermber 2, 2005, pp. 942Â­945. [42] Y. Zhang, W. Ding, W. Lao, Y. Wang, and H. Tan. "Restoration of missing time-series data via multiple sine functions decomposition with Guangzhou-temperature application," in 2nd International Conference on Systems and Informatics (ICSAI 2014) , Shanghai, China, November 1517, 2014, pp. 459Â­464. [43] G. B. Eslamlou, A. Jung, and N. Goertz. "Smooth graph signal recovery via efficient Laplacian solvers," in IEEE International Conference on Acoustics, Speech and Signal Processing (ICASSP ), New Orleans, LA, USA, March 5-9, 2017, pp. 5915Â­5919. [44] P. J. Wolfe and S. J. Godsill. "Interpolation of missing data values for audio signal restoration using a Gabor regression model," in IEEE International Conference on Acoustics, Speech, and Signal Processing (ICASSP '05), Philadelphia, PA, USA, March 23, 2005, vol. 5, pp. 517- 520. [45] Y. Tan, C. Zhang, and X. Chen. "Bayesian analysis of incomplete data from accelerated life testing with competing failure modes," in 8th International Conference on Reliability, Maintainability and Safety, Chengdu, China, July 20-24, 2009, pp. 1268Â­1272. [46] P. Stoica, J. Li, J. Ling, and Y. Cheng. "Missing data recovery via a nonparametric iterative adaptive approach." IEEE Signal Processing Letters, vol.16, no.4, pp. 241-244, February 10, 2009. [47] M. R. Khammar, M. I. Saripan, M. H. Marhaban, A. J. Ishak, and F. Zolfaghari. "Restoration of missing data in old archives based on genetic algorithm," in 2nd International Conference on Electronic Design (ICED), Penang, Malaysia, August 19-21, 2014, pp. 409Â­414. [48] M. A. Uman, Lightning. Mineola, N.Y: Dover Publications, 1984, pp.1-291. [49] W. Janischewskyj, A. M. Hussein, V. Shostak, I. Rusan, J.-X. Li, and J.-S. Chang. "Statistics of lightning strikes to the Toronto Canadian National Tower (1978-1995)." IEEE Transactions on Power Delivery, vol. 12, no.3, pp. 1210Â­1221, July 1997. [50] La Tour CN Tower. "History - Astounding." [Online]. Available: http://www.cntower.ca/en-ca/about-us/history/astounding.html. [Accessed: 02-Jul-2018]. [51] M. McMordie. "CN Tower." [Online]. Available: https://www.thecanadianencyclopedia.ca/en/article/cn-tower/, March 4, 2015. [Accessed: 02-Jul-2018]. [52] A. M. Hussein, W. Janischewskyj, J.S. Chang, V. Shostak, W. Chisholm, P. Dzurevych and Z.I. Kawasaki. "Simultaneous measurement of lightning parameters for strokes to the Toronto Canadian National Tower." Journal of Geophysical Research-Atmosphere, vol. 100, no. 5, pp. 8853-8861, May 1995. [53] A. M. Hussein, S. Kazazi, M. Anwar, M. Yusouf, and P. Liatos. "CN Tower lightning characteristics based on current-recorded flashes," in 32nd International Conference on Lightning Protection (ICLP), Shanghai, China, October 13-17, 2014, pp. 2028-2034. 91

[54] D. A. Ward and J. L. T. Exon. "Using Rogowski coils for transient current measurements." Engineering Science and Education Journal, vol. 2, no.3, pp. 105Â­113, June 1993. [55] A. M. Hussein. "CN Tower Lightning Parameters," in X International Symposium on Lightning Protection (SIPDA), Curitiba, Brazil, November 9-13, 2009, pp. 107Â­133. [56] A. M. Hussein and S. Kazazi. "Characteristics of a tall-structure severe lightning storm," in International Symposium on lightning Protection (SIPDA), Belo Horizonte, Brazil, October 7-11, 2013, pp. 146-151. [57] A. M. Hussein and M. Milewski. "CN tower lightning flash components," in International Symposium on Lightning Protection (SPIDA), Fortaleza, Brazil, October 3-7, 2011, pp. 7Â­13. [58] C. Yazhou, L. Shanghe, W. Xiaorong, and Z. Feizhou. "A new kind of lightning channel-base current function," in 3rd International Symposium on Electromagnetic Compatibility, Beijing, China, May 2124, 2002, pp. 304Â­307. [59] F. Heidler, J. M. Cvetic, and B. V. Stanic. "Calculation of lightning current parameters." IEEE Transactions on Power Delivery, vol. 14, no. 2, pp. 399Â­404, Apr. 1999. [60] A. M Hussein, M. Milewski, E. Burnazovic, and W. Janischewskyj. "Current Waveform Characteristics of CN Tower Negative and Positive Lightning," in X International Symposium on Lightning Protection (SIPDA), Curitiba, Brazil, November 9-13, 2009, pp.451-456.

92

NOMENCLATURE
CG TCS DU CD GTCS NCBC AEF AEFD LPC MLE MSFD LEMP          ,   ,   ,   ,  current generation travelling current source Diendorfer-Uman current dissipation generalized traveling current source new channel-base current Analytically Extended Function Analytically Extended Function derivative Prediction coefficients Maximum Likelihood Estimator multiples sine function decomposition lightning electromagnetic pulse control parameter of the amplitude of the single-term current function rise time constant (s) of single-term current function decay time constant (s) of single-term current function an exponent value that is greater than or equal to 1.1 of single-term current function maximum amplitude of the current function (kA) time at which the current reaches its initial peak (s) maximum steepness of the current function or the maximum amplitude of the current derivative function (kA) time at which the maximum steepness of the current function (s) control amplitude parameter of the double-term current function the rise time (s) of the double-term current function the decay time (s) of the double-term current function an exponent that is greater than or equal to 1.1 of double-term current function

93


