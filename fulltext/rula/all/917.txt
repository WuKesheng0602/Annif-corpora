Ryerson University

Digital Commons @ Ryerson
Theses and dissertations

1-1-2011

The method of images in the pricing of barrier derivatives in three dimensions
Xianzhang Wen
Ryerson University

Follow this and additional works at: http://digitalcommons.ryerson.ca/dissertations Part of the Applied Mathematics Commons Recommended Citation
Wen, Xianzhang, "The method of images in the pricing of barrier derivatives in three dimensions" (2011). Theses and dissertations. Paper 995.

This Thesis is brought to you for free and open access by Digital Commons @ Ryerson. It has been accepted for inclusion in Theses and dissertations by an authorized administrator of Digital Commons @ Ryerson. For more information, please contact bcameron@ryerson.ca.

The Method of Images in the Pricing of Barrier Derivatives in Three Dimensions

by

Xianzhang Wen

A thesis presented to Ryerson University in partial fulfillment of the requirement for the degree of Master of Applied Science in the Program of Applied Mathematics Toronto, Ontario, Canada, 2011 c Xianzhang Wen, 2011

Author's Declaration
I hereby declare that I am the sole author of this thesis. I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research. Signature

I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. Signature

ii

Instructions on Borrowers
Ryerson University requires the signatures of all persons using or photocopying this thesis. Please sign below, and give address and date.

iii

Abstract
Title of Thesis: The Method of Images in the Pricing of Barrier Derivatives in Three Dimensions

Xianzhang Wen Department of Mathematics, School of Graduate Studies, Ryerson University Thesis directed by: Dr. Marcos Escobar and Dr. Sebastian Ferrando

The thesis describes the joint distributions of minima, maxima and endpoint values for a three dimensional Wiener process. In particular, the results provide the joint cumulative distributions for the maxima and/or minima of the components of the process. The densities are obtained explicitly for special type of correlations by the method of images; the analysis requires a detailed study of partitions of the sphere by means of spherical triangles. The joint densities obtained can be used to obtain explicit expressions for prices of options in financial mathematics. We provide closed-form expressions for the price of several barrier type derivatives with a three dimensional geometric Wiener process as underlying. These solutions are found for special correlation matrices and are given by linear combinations of three dimensional Gaussian cumulative distributions. In order to extend the results to a wider set of correlation matrices, the method of random correlations is outlined.

iv

Acknowledgments
First and foremost, I would like to thank my supervisors, Dr. Marcos Escobar and Dr. Sebastian Ferrando, for many insightful conversations and discussions during the development of the ideas in this thesis, for helpful comments on the text, and for providing research assistant positions during the summer term of 2010 and May of 2011. It has been a pleasure and a privilege to be their student. I would like to thank the Department of Mathematics and its professors at Ryerson University. Particularly, I would like to thank my courses' teachers, Dr. Pablo Olivares, Dr. Silvana Ilie, Dr. Garnet Ord, Dr. Jean-Paul Pascal, and Dr. Katrin Rohlf, for their kindness, knowledge and hard work. Many thanks to Steve Kanellis for his assistance in the computer Lab. I would like to thank my classmates for their helpful suggestions and ideas during my study at Ryerson University. I would like to thank Ryerson University for providing teaching assistant positions, Ryerson Graduate Scholarship(RGS) and Ontario Graduate Scholarship(OGS) during my study at Ryerson. Finally I would like to thank my family members: my wife, my daughter and son. I would not have finished my study without their many sacrifices on my behalf.

v

Contents
1 Introduction 2 Existing Results 2.1 One Dimensional Results . . . . . . . . . . . . . . . . 2.2 Two Dimensional Results . . . . . . . . . . . . . . . . 2.3 Numerical Solution for the One Dimensional Case . . 2.4 The Numerical Solution for the Two Dimensional Case 2.5 The Method of Images . . . . . . . . . . . . . . . . . . 3 Method of Images for the Three Dimensional Case 3.1 Some Lemmas . . . . . . . . . . . . . . . . . . . . . . 3.2 The Division of the Sphere . . . . . . . . . . . . . .   3.2.1 The Case of (  2 , 2 , n ), n  2 . . . . . . . . .    3.2.2 The Case of ( 2 , 3 , 3 ) . . . . . . . . . . . .   3.2.3 The Case of (  2, 3, 4) . . . . . . . . . . . .   3.2.4 The Case of (  2, 3, 5) . . . . . . . . . . . . 3.3 Symmetric Points . . . . . . . . . . . . . . . . . . . .   3.3.1 The Case of (  2 , 2 , n ), n  2 . . . . . . . .    3.3.2 The Case of ( 2 , 3 , 3 ) . . . . . . . . . . . .   3.3.3 The Case of (  2, 3, 4) . . . . . . . . . . . .   3.3.4 The Case of (  2, 3, 5) . . . . . . . . . . . . 1 6 6 7 9 11 20 23 24 26 26 27 28 32 35 35 37 40 42

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

. . . . . . . . . . .

4 Density Functions for Some Special Correlations 47 4.1 The Simplifications to The Heat Equation and its Solutions . . . 47 4.2 Some Special Cases for i and i . . . . . . . . . . . . . . . . . . 51 4.3 The Density Functions of the Minimum (or maximum) and Endpoints of Y (t) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51 5 Applications to Finance 57 5.1 Lookback European Option . . . . . . . . . . . . . . . . . . . . . 59 5.2 Digital Call . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 65 vi

6 Solution for Random Correlation 68 6.1 The cases of minimum or maximum . . . . . . . . . . . . . . . . 68 6.2 The Mixing cases . . . . . . . . . . . . . . . . . . . . . . . . . . . 72 7 Appendixes 75 7.1 Appendix for Chapter 2 . . . . . . . . . . . . . . . . . . . . . . . 75 7.2 Appendix for Chapter 3 . . . . . . . . . . . . . . . . . . . . . . . 79 7.3 Appendix for Chapter 4 . . . . . . . . . . . . . . . . . . . . . . . 87

vii

List of Figures
1.1 The line y = ln(0.8) is the barrier for the case of one dimension. The option is not available if the log price goes through the barrier line . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . The simulation of the solution for the one dimensional equation (2.13)-(2.15) in space, by choosing x1 = -1, x2 = 1, 1 = 1, t = 1/2000, x = 1/100, tmax = 1/10 . . . . . . . . . . . . . . . . . . The simulation of the solution of one dimension equation (2.13)(2.15) in space, by choosing x1 = -1, x2 = 1, 1 = 1, t = 1/50, x = 1/50, tmax = 4 . . . . . . . . . . . . . . . . . . . . . The grid of triangular domain to create w(j, k ) . . . . . . . . . . The simulation results of numerical solution with D = 4, m1 = -2/5, m2 = -1/2, tmax = 1, x = 1/30, t = 1/200, 1 = 2 = 1. The error between the numerical solution and exact solution is about 8.0 × 10-4 . . . . . . . . . . . . . . . . . . . . . . . . . . The simulation results of exact solution with D = 4, m1 = -2/5, m2 -1/2, tmax = 1, x = 1/30, t = 1/200, 1 = 2 = 1 . . . . . . . For n = 5, the signs of every domain for the 2-dimensional case, the sign ± relate to the sign of g in (2.25) . . . . . . . . . . . . .

3

2.1

12

2.2

2.3 2.4

13 16

2.5 2.6 3.1 3.2 3.3 3.4 3.5 3.6 3.7 4.1 6.1 6.2 6.3 6.4

18 = 19 22

The spherical triangles of (/2, /3, /3) in the first slices . . . 29 The spherical triangles of (/2, /3, /4) in the first slice . . . 31 The spherical triangles of (/2, /3, /5) in the first slice . . . 34 The symmetric points of (/2, /2, /6) for k = 0, j = 1, 2 . . . 36 The symmetric points of (/2, /3, /3)for k = 0, j = 1, 2, 3, 4 . 39 The symmetric points of (/2, /3, /4) for k = 0, j = 1, 2, 3, 4, 5, 6 43 The symmetric points of (/2, /3, /5) for k = 0, j = 1, · · · , 12 46 The set of sources for solving equation (4.13) for some parameters 52 The The The The picture picture picture picture of of of of convexhull convexhull convexhull convexhull of of of of set set set set ^ F ¯ F ^ H ¯ H . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70 71 73 74

viii

List of Tables
2.1 5.1 5.2 5.3 6.1 The errors analysis for the one dimensional PDE. The error= | the exact solution (2.16)- the numerical solution (2.17)|. . . . . Exact option values obtained using (5.16) . . . . . . . . . . . . . The prices of Monte Carlo Simulation . . . . . . . . . . . . . . . The prices of digital call by (5.18) . . . . . . . . . . . . . . . . . The prices of mixed digital call . . . . . . . . . . . . . . . . . . . 11 65 66 67 74

ix

Chapter 1

Introduction
In the early 1970's, after the introduction of geometric Brownian motion in finance, Fisher Black and Myron Scholes [1973] made a major breakthrough by deriving the Black-Scholes formula for the most representative end-point (i.e. path independent) derivative, a European call option, becoming a most significant result in pricing financial instruments. Since then, quite a large number of publications have dealt with end-point derivatives generalizing this formula, for example, allowing for stochastic volatility as in Heston [1991] and Hull and White [1987] as well as for several other underlyings like in collateralized debt obligations (see, for example, Hull and White [2004]). A more general type of derivatives are the path-dependent ones, a prominent example is given by barrier options which include down-and-out options in one dimension (see Rubinstein and Reiner [1991], Sepp [2006]) and the more general family of lookback options in two dimensions (see He et.al. [1998] and Lipton [2001]). It has been proven to be difficult to derive closed-form solutions in higher dimensional settings and therefore the literature has resorted to approximations and/or simulations, see Metzler [2008] for a review. A standard one-asset lookback call (or put) gives its holder the right to buy (or sell ) the underlying asset at its minimum (or maximum) price over a certain period. Analytical solutions for the option can be derived along the lines of Rubinstein and Reiner [1991]. In the paper by He et al. [1998], the authors generalized the option to two assets. They considered options, in particular double lookback options, whose payoffs depend on the extremal (i.e., maximum and/or minimum) prices of the two assets over a given period. In this thesis, we study lookback options in three dimensions, i.e. options based on three underlying assets which may depend on at most three barriers. In particular, our setting allows to introduce and handle the notion of triple lookback options. These products can be seen as options with the standard "double lookback" component plus a third lookback which could represent the behavior of an index and therefore a tracking of market conditions. In other words, if the minimum value of an index remains above a threshold (or the maximum below a threshold) then the double lookback option is of interest and 1

could be exercised otherwise the underlying double lookback has no value. In general, we let, for i = 1, 2, 3, Si (t): the price of the underlying asset i at current date t; r: the risk free interest rate; i : standard deviation of the underlying asset i, i.e the volatility; Wi (t): a Wiener process with mean 0 and variance t. The assumptions and definitions used in this thesis are: · the value of underlying asset is assumed to follow the log-normal distribution dSi (t) = rSi (t)dt + i Si (t)dWi (t); · there are no transaction costs or taxes; · there are no dividends during the life of the option; · no arbitrage opportunities; · security trading is continuous; · Ki is the exercise price; · T is the maturity date; · i = r -
2 i 2

the drift rate;

· correlation dWi (t), dWj (t) = ij dt, i = j . Letting Yi (t) = ln(Si (t)), Si (0) = 1, we have, by Ito ^'s formula, dYi (t) = i dt + i dWi , i = 1, 2, 3. One of our main objectives is to find the density/distribution function of the minimum and endpoints of Y (t), see Figure 1.1. P ( Y1 (t)  dy1 , Y2 (t)  dy2 , Y3 (t)  dy3 , min Y1 (s) > m1 ,
0<s<t 0<s<t

(1.1)

min Y2 (s) > m2 , min Y3 (s) > m3 )
0<s<t

= p (y1 , y2 , y3 , m1 , m2 , m3 , t) dy1 dy2 dy3 , where Yi (0) > mi . It is known, see [24], that the density function p satisfies the following PDE: p p 1 (y, t) = - i (y, t)+ t y 2 i i=1
3 3 2 i i=1

2p 2p (y, t). (1.2) (y, t)+ i j ij 2 yi yi yj i<j 2

1.4

1.3

1.2

log price y

1.1

1

0.9

0.8

0.7

0

0.2

0.4 time t

0.6

0.8

1

Figure 1.1: The line y = ln(0.8) is the barrier for the case of one dimension. The option is not available if the log price goes through the barrier line

3

Since t = 0, Yi (0) = ln(Si (0)) = 0, i = 1, 2, 3, the initial condition is p(y1 , y2 , y3 , t = 0) =  (y1 ) (y2 ) (y3 ), (1.3)

where  (x) is the Dirac delta function with a spike at x = 0. We refer to Equations (1.2)-(1.3) as Fokker Planck Equation. We also add the boundary conditions: p(y1 = m1 , y2 , y3 , t) = 0, p(y1 , y2 = m2 , y3 , t) = 0, p(y1 , y2 , y3 = m3 , t) = 0.

(1.4)

The equations (1.2), (1.3) and (1.4) will be referred as the PDE problem associated to the density (1.1). To obtain the density/distribution functions with respect to the endpoints and distribution w.r.t the minimum, namely (1.1), we will solve Equations (1.2), (1.3) and (1.4). The fact that a general solution in multi-dimensions has not been found after a century of study gives an indication of the difficulty of the problem. The successful solution of the two dimensional case in [12] provided a new impetus to explore the multi-dimensional case. Two different techniques are used in [12], one such technique relies in finding an orthogonal coordinate system that has a two-fold property, it allows for a solution to the Laplace equation by means of separation of variables while keeping the boundary conditions orthogonal. This coordinate system is simply the polar coordinate system. Unfortunately, an extension to three dimensions along these lines is not successful; the reason being that the eleven coordinate systems which allow for a solution of the Laplace equation by means of separation of variables (see [23] and the references therein) do not keep the boundary conditions orthogonal. This last statement can be checked considering case by case. The second technique employed in [12] makes use of the method of images, this approach requires to restrict the correlation values to a set of specific values. This last approach is successfully extended in the present thesis to the three dimensional case. There have been several approximating solutions to the multi-dimensional problem described above, an example is given by [1] (see also the review provided in [22]). Reference [1] considers the case where the off diagonal elements of the correlation matrix are small enough so they can be treated as a perturbation. The joint probability density is then expanded in powers of the off diagonal correlation matrix elements. Reference [22] provides actual simulations of the perturbation; and provides evidence that the approximation to the survivor function is remarkably accurate under appropriate conditions. However, the approach is not available for the case where the correlations are not small. This is contrast to our thesis where we provide exact solutions for a specific set of correlations which are not small. The organization of the thesis is as follows: 4

· In Section 2.1, we recall some results for the one dimensional case. In Section 2.2, we review some results for the two dimensional case. We also show that the solution which is obtained by the method of images equals the solution obtained by the method of separation of variables. In section 2.3 and 2.4, we provide numerical solutions for both one and two dimensional cases. Section 2.5 discusses the Method of Images. · In Section 3.1 we provide some Lemmas which are very useful for the partition of R3 . The formula of the arc length on the sphere will be deduced, as well as the formula of symmetric points between their boundaries will be obtained. In Section 3.2, inspired by Proposition 6 from [8], we obtain the division of three dimensional sphere for all four cases, i.e.,            (  2 , 3 , 3 ),( 2 , 3 , 4 ),( 2 , 3 , 5 ), ( 2 , 2 , n ), n = 2, 3, 4, · · · . In Section 3.3, symmetrical points are obtained for each of the R3 domains under consideration. · In Section 4.1, we simplify PDE (1.2)-(1.4) to a heat Equation. The solutions of the Heat Equation for all four cases are provided by the method of images. In Section 4.2, solutions of some special cases for ij = 1 or ij = 0 are presented. In Section 4.3, we reach the conclusion that the density functions can be obtained for some special correlations. · In Section 5.1, we show the applications to lookback European option, while we compare the numerical results of analytic solution to the simulation results by Monte Carlo Method. In Section 5.2, we give the applications to lookback Digital option. · In Chapter 6, we consider the solution for random correlations. · The Appendixes provide proofs for some of the results in the thesis.

5

Chapter 2

Existing Results
In this chapter, we will recall some results which were introduced in [12]. We also point out an error in paper[12] (see Section 2.2). The following notation will be used freely: given a process Y (t) define Y (t)  sup0<s<t Y (s) and Y (t)  inf 0<s<t Y (s).

2.1

One Dimensional Results
P (Y1 (t)  dy, Y 1 (t)  M1 )  P (Y 1 (t))  g (y, M1 , t; 1 )dy, y  M1 , M1  0 G(M1 , t; 1 ), M1  0 g+- (y, m1 , M1 , t; 1 )dy, y  [m1 , M1 ], m1  0  M1 G+- (m1 , M1 , t; 1 ), m1  0  M1 , y  [m1 , M1 ].

Following [12], we define

P (Y1 (t)  dy, Y 1 (t)  m1 , Y 1 (t)  M1 )  P (Y 1 (t)  m1 , Y 1 (t)  M1 ) 

Theorem 1. (i) The probability density/distribution functions for the maximum (or the minimum) of a Brownian motion with constant drift is given by
2 2 1 y - 1 t  (  )(1 - e-(4M1 -4M1 y)/21 t ), y  M1 , M1  0, 1 t 1 t (2.1) 2 M1 - 1 t - M -  t 1 1  ) - e21 M1 /1 N (  G(M1 , t; ) = N ( ), M1  0, (2.2) 1 t 1 t  where (z ) = exp(-z 2 /2)/ 2 is the standard normal density, and N (·) is the corresponding distribution function.

g (y, M1 , t; ) =

6

(ii) The joint probability density function of the maximum, minimum, and end point of a Brownian motion with a constant drift, denoting y as the random variable, for y  [m1 , M1 ], m1  0  M1 , is given by g+- (y, m1 , M1 ) = exp( -(
2 1 y y - 2n(M1 - m1 ) 1 t 1  [(  - ) ) 2 2 1 21 n=- 1 t 1 t 

y - 2n(M1 - m1 ) - 2m1  )]. 1 t

(2.3)

This density can be expressed in the equivalent form g+- (y, m1 , M1 ) =
2 1 y 2 t 2 -n2  2 1 t exp( 2 - 12 ) exp( ) M1 - m1 1 21 n=- 2(M1 - m1 )2 

× sin(

-m 1 n (y - m1 ) ) sin( ). M1 - m1 M1 - m1

(2.4)

(iii) The joint probability distribution function of maximum and minimum of a Brownian motion with constant drift, for m1  0  M1 , is given by G+- (m1 .M1 , t; 1 )


=
n=-

e2n1 (M1 -m1 )/1 {[N ( -N (

2

M1 - 1 t - 2n(m1 - m1 )  ) 1 t

m1 - 1 t - 2n(m1 - m1 )  )] 1 t 2 M1 - 1 t - 2n(m1 - m1 ) - 2m1  ) -e2m1 1 /1 }{[N ( 1 t m1 - 1 t - 2n(m1 - m1 ) - 2m1  -N ( )]} 1 t

(2.5)

2.2

Two Dimensional Results

In [12], the authors considered Equations(1.2)-(1.4) in the case of two dimensions. Defining P (Y1 (t)  dy1 , Y2 (t)  dy2 , Y 1 (t)  m1 , Y 2 (t)  m2 ) = p(y1 , y2 , m1 , m2 , t)dy1 dy2 , they obtained the analytic solution, by solving the partial differential equation by the method of separation variables, Theorem 2. For y1  m1 , y2  m2 , where m1  0, m2  0, p(y1 , y2 , m1 , m2 , t) = ea1 y1 +a2 y2 +bt 1 2 7 1 - 2 h(y1 , y2 , m1 , m2 , t), (2.6)

where 2 h(y1 , y2 , m1 , m2 , t) =  t


e-(r
i=1

2

2 +r0 )/2t

sin

n0 n rr0 sin I(n)/ ( ),   t

and as for other parameters, please see page 206 of paper [12]. At the same time, by making use of the method of images, they obtained the following corollary Corollary 1. Suppose the same assumptions hold as in Theorem 2, except that the correlation  can take the only special values  n = - cos( ). n Then the density function p has the special form p(x1 , x2 , m1 , m2 , t) = ea1 x1 +a2 x2 +bt h(z1 , z2 , m1 , m2 , t), 1 2 1 - 2 n (2.7)

where h is a finite sum of bivariate normal densities
n-1

h(z1 , z2 , m1 , m2 , t) =
k=0

+ - [gk (z1 , z2 , t) + gk (z1 , z2 , t)]

and
± gk (z1 , z2 , t) = 1 2 ±(2 )-1 exp(- 2 [(z1 - r0 cos( 2k n ± 0 ))

(2.8) (2.9)

+(z2 -

r0 sin( 2k n

± 0 )) ]).

2

± We should point out a mistake in (2.8), the correct expression for gk (z1 , z2 , t) is given by: ± gk (z1 , z2 , t) = 1 ±2k ±(2t)-1 exp(- 2 ± 0 ))2 t [(z1 - r0 cos( n k ± 0 ))2 ]). +(z2 - r0 sin( ±2 n

Theorem 2 and Corollary 1 are two important mathematical tools used in [12], the distribution functions can be obtained by the above results, as well as the price of many exotic options. As we indicated, these two results have been reached by different methods. Then, it is natural to investigate the consistency of using both approaches by checking if, for the same value of , the solutions (2.6) and (2.7) agree. We provide the proof in an appendix.
 ), where mo is an integer. Solution (2.6) and Theorem 3. If n = - cos( m o solution (2.7)are the same.

8

2.3

Numerical Solution for the One Dimensional Case

In this section, we will study the numerical solutions of the following FokkerPlanck equation, g 1 2 2g g = 1 (2.10) - 1 , t 2 x2 x with absorbing boundaries g (x1 , t) = g (x2 , t) = 0, and initial condition g (x, 0) =  (x), (2.12) where  denotes the Dirac delta function with a spike at x = 0. To tackle equation (2.10)-(2.12), we will follow the following strategy. (i) To simplify the system (2.10), (2.11) and (2.12) to Heat equation. (ii) To choose the value of  (·), such that the exact solution can be approximated by the numerical solution. (iii) To check the errors between the numerical solutions and exact solutions. At first, we focus on problem (i), which is to simplify system (2.11) to a Heat equation. Let g (x, t) = eax+bt q (x, t), where a, b are constants to be determined. Then we have g t g x 2g x2 Hence, bq (x, t)+ If we let q (x, t) 1 2 2 q (x, t)  2 q (x, t) q (x, t) (a q (x, t)+2a = 1 + )-1 (aq (x, t)+ ). t 2 x x2 x a= b= then, we obtain the Heat Equation: 1 2 2q q = 1 , t 2 x2 9 (2.13)
1 2 1 2 1 -1 2, 2 1

(2.11)

= = =

q (x, t) ) t q (x, t) eax+bt (aq (x, t) + ) x q (x, t)  2 q (x, t) eax+bt (a2 q (x, t) + 2a + ). x x2 eax+bt (bq (x, t) +

with boundaries q (x1 , t) = q (x2 , t) = 0, and initial condition q (x, 0) =  (x). (2.15) By solving (2.13),(2.14) and (2.15) (see [12],) we can obtain the exact solution q (x, t) = 2 x2 - x1


(2.14)

exp(-
n=1

2 n2  2 1 t x1 x - x1 ) sin(- ) sin n ( ). 2(x2 - x1 )2 x2 - x1 x2 - x1 (2.16)

Secondly, we turn to obtain the numerical solutions of (2.13),(2.14) and (2.15) instead of (2.10),(2.11) and (2.12). Step 1. Establishing the computational template. Making use of Crank-Nicolson scheme, we get the numerical solution of q (x, t) as follows
n+1 n 2 wj - wj 1 n+1 n+1 n+1 n n + wj + wj = [wn - 2wj +1 + wj -1 - 2wj +1 ]. t 4(x)2 j -1

Denote  =

2 1 t 2(x)2 ,



    C=    0 0 and      D=   

1+ - 2 0 . . .

- 2 1+ - 2 . . . 0 0
 2

0 - 2 1+ . . . 0 0 0

··· ··· ··· .. . ··· ···

0 0 0 . . . 1+ - 2 0 0 0 . . . 1-
 2

0 0 0 . . . - 2 1+ 0 0 0 . . . 1-
 2

        

1- 0 . . .
 2

1- . . . 0 0
 2

0··· 0··· 1 -  ··· . .. . . .
 2

     .   

0 0

0 0

··· ···

Hence, for n = 1, 2, · · · , M , we have wn+1 = C \Dwn . (2.17)

n n n where wn = (w1 , w2 , · · · , wN +1 ) , n = 1, 2, · · · M . Since coefficient matrix C is a diagonally dominant matrix, which is nonsingular. Hence we can solve (2.17).

Step 2. The approximation of  function. 10

No. 1 2 3 4 5 6

x 1/20 1/25 1/30 1/35 1/40 1/50

t 1/20 1/25 1/30 1/35 1/40 1/50

 10 12.5 15 17.5 20 25

error 2.7807 × 10-7 2.9367 × 10-7 1.8202 × 10-5 9.13 × 10-5 3.7327 × 10-4 0.0033

error/(x2 + t2 ) 5.5614 × 10-5 9.1773 × 10-4 0.0082 0.0559 0.2986 4.1743

Table 2.1: The errors analysis for the one dimensional PDE. The error= | the exact solution (2.16)- the numerical solution (2.17)|.

In order to get the solution of system (2.17), we need to know w1 which is the initial value. Since  (x) = 0 if x = 0, and R  (x)dx = 1. Hence,  -Dirac function can be approximated by ~(x) =  0,
1 x , x x as x  [-  2 , 2 ] otherwise.

1 Then we need to determine the number j0 such that wj = 1/(x). At first, 0 x(j ) = x1 + j x and j0 = 1. For j = 1, 2, · · · , if |x(j )|  |x(j0 )|, then we denote j0 = j . With a loop, we can get that x(j0 ) is the node which is the nearest to 1 1 x = 0. We let wj = x(j0 ) = 1/(x), and wj = 0, for j = j0 . 0

Finally, we focus on the stability and error analysis. Normally, it is well known that Crank-Nicolson scheme is unconditionally stable. Also the scheme is second-order accurate in both space and time. However, if the initial condition is  Dirac function which is not continuous, we can find in table 2.1 that the scheme is neither unconditionally stable nor secondorder accurate in space and time. Since the changes of x make the initial function  (x) change. Which means that the PDE which we are dealing with has different initial values along with x, see Figures 2.1, 6.4, and Table 2.1.

2.4

The Numerical Solution for the Two Dimensional Case

In this section, we study the numerical solutions of the following Fokker-Planck equation g g g 1 2 2g 2g 1 2 2g = -1 - 2 + 1 + 1 2 + 2 , 2 t x y 2 x xy 2 y 2 with boundary conditions g (x = m1 , y, t) = g (x, y = m2 , t) = 0, 11

One dimension approximation 1.4

1.2

1

0.8 g 0.6 0.4 numerical solution, delta=1/100 approximated exact solution 0.2 0 -1

-0.5

0 x

0.5

1

Figure 2.1: The simulation of the solution for the one dimensional equation (2.13)-(2.15) in space, by choosing x1 = -1, x2 = 1, 1 = 1, t = 1/2000, x = 1/100, tmax = 1/10

12

One dimension approximation 0.012

0.01

0.008

0.006

g

0.004

0.002

numerical solution, delta=1/50 approximated exact solution

0 -1

-0.5

0 x

0.5

1

Figure 2.2: The simulation of the solution of one dimension equation (2.13)(2.15) in space, by choosing x1 = -1, x2 = 1, 1 = 1, t = 1/50, x = 1/50, tmax = 4

13

and initial condition g (x, y, 0) =  (x) (y ). The procedure is very similar to the one employed in Section 2.3 in the sense that we can make some substitutions, and we just need to study the numerical analysis of the following Heat Equation. u 1 2u 2u = ( 2 + 2 ), t 2 z1 z2 with initial condition u(z1 , z2 , t = 0) =  (z1 - z10 ) (z2 - z20 ), and boundary conditions u(L1 , t) = u(L2 , t) = 0, where z10 =  1
1-2
1 [- m 1 +

(2.18)

(2.19)

(2.20)

m2 2 ], z20

2 = -m 2 ,

L1 = {(z1 , z2 ) : z2 = 0}, L2 = {(z1 , z2 ) : z2 = -

1 - 2 z1 } 

To obtain the numerical solution of (2.18)-(2.20), we need to solve the following problems: (i) Because the domain is not closed, we need to add a suitable boundary, such that we can get the numerical solutions which can approximate the exact solution; (ii) The approximation of  function at suitable node; (iii) The computational template of PDE; (iv) The order of the discrete Laplacian operator; (v) The construction of the discrete Laplacian operator.  In the following, we consider a special case, which is  = - 2/2; then, we can obtain that the exact solution of (2.19)-(2.20) is given by:
3

u=
k=0

+ - [gk (z1 , z2 , t) + gk (z1 , z2 , t)],

(2.21)

where
± gk =±

1 1 exp(- [ 2t 2t

k (z1 - r0 cos( ±2 ± 0 ))2 4 k +(z2 - r0 sin( ±2 ± 0 ))2 ]), 4

14

2 + z 2 ,  = arctan( z20 ). Then we deal with the numerical soluand r0 = z10 20 0 z10 tion of system (2.19)-(2.20), according to the problems (i)-(v).

Step 1. We add a boundary, such that the domain of PDE is closed. From the exact solution (2.21), we can find that u  0, when z1  . Hence for a constant D which is relatively large, we give a boundary condition as follows, u(z1 = D, z2 , t) = 0. (2.22) Step 2. The computational template of (2.19)-(2.20) and (2.22). In order to fix the problem, we make use of BTCS method combining to the discrete Poisson problem. For n = 1, 2, · · · , M , we have
n+1 n+1 n+1 n+1 n+1 n -(wj -1,k + wj +1,k + wj,k-1 + wj,k+1 ) + (1 + 4)wj,k = wj,k , dt where  = 2 2 . We remark that the unknowns are numbered in lexicographic order in the grid. We suppose that wl = w(j, k ), then, we obtain:

wn+1 = A\wn ,

(2.23)

N -2) where w = (w1 , w2 , · · · , wL ) , L = (N -1)( is given by step 3. A is the 2 discrete Laplacian operator to be described in step 4.

Step 3. Determining the order of the discrete Laplacian operator matrix A. For a regular domain [0, D] × [0, D], let dx = dy = , N = D/dx, which is supposed to be an integer. Then the order of matrix A is (N - 1)2 . In addition, if we consider the boundary (2.19), the order of matrix A = [(N - 1)2 - (N - 1)]/2 = The dimension of A is
(N -1)(N -2) 2

(N - 1)(N - 2) . 2

×

(N -1)(N -2) . 2

Step 4. Constructing the discrete Laplacian operator. We denote that the unknowns are numbered in lexicographic order in the grid (see figure 6.4). Suppose that wl = w(j, k ), we need to get the relationship between the order number l and node (j, k ), see figure 2.3. 1. For k = 2, we have l = j - k ; 2. for k = 3, we have l = N - 2 + j - k ; 3. for k = 4, we have l = 2N - 5 + j - k ; 4. for k = 5, l = 3N - 9 + j - k, · · · . We let a2 = 0, a3 = -2, a4 = -5, a5 = -9, · · · . Then we have b2 = a3 - a2 = -2, b3 = a4 - a3 = -3, b4 = a5 - a4 = -4, · · · , bk = ak+1 - ak = -k . Hence we 15

The triangular Domain 4 3.5 3 2.5 2 1.5 1 0.5 0 y

0

0.5

1

1.5

2 x

2.5

3

3.5

4

Figure 2.3: The grid of triangular domain to create w(j, k )

16

can get ak+1 = ak+1 - ak + ak - ak1 + · · · + a3 - a2 = bk + bk-1 + · · · + b2 = -k - (k - 1) - · · · - 3 - 2 (k - 1)(k + 2) = - . 2
k+1) Moreover, ak = - (k-2)( . Therefore, we get the relationship between the 2 order number l and the correspond node (j, k ),

l = (k - 2)N -

(k + 1)(k - 2) + j - k. 2

k-2) Now we construct the discrete Laplacian operator. Let l = (k -2)N - (k+1)( + 2 j - k, N -2) , we have A(s, s) = 1 + 4; (i) For s = 1, 2, · · · , (N -1)( 2

(ii) For k = 2, 3, · · · , N - 2; j = k + 1, · · · , N - 1, we have A(l, l + 1) = -; (iii) For k = 2, 3, · · · , N - 2; j = k + 2, · · · , N , we have A(l, l + N - k - 1) = -; (iv) For k = 2, 3, · · · , N - 2; j = k + 2, · · · , N , we have A(l, l - 1) = -; (v) For k = 3, · · · , N - 1; j = k + 1, · · · , N , we have A(l, l - N + k ) = -. The coefficient matrix A is diagonally dominant, which is non-singular, hence we can solve (2.23). Step 5. As we did in the Section 2,  (x - x0 ) can be approximated by ~(x - x0 ) =  0,
1 x ,

as x  [x0 - otherwise

x 2 , x0

+

x 2 ]

Then we need to determine the number (j0 , k0 ) such that the initial node w1 (j0 , k0 ) = 1/()2 . Let x(j ) = j , y (j ) = j , p = 0, q = 0. For k = 2, 3, · · · , N, j = 1, · · · , N , if |x(j ) - z10 | <= |p - z10 |, then p = x(j ). Using a loop, we can get j0 , and x(j0 ) is the node which is the nearest point to z10 . By a similar way, we can get k0 , and y (k0 ) is the nearest point to z20 . Then We let w1 (j0 , k0 )1 = 1/()2 , w1 (j, k )1 = 0, j = j0 , k = k0 . Step 6. The code of the case of two dimensions in space is placed in Appendix. In our experiment, we choose D = 4, m1 = -2/5, m2 = -1/2, tmax = 1, x = 1/30, t = 1/200, 1 = 2 = 1. The error between the numerical solution and exact solution is about 8.2 × 10-4 , see figures 2.4 and 2.6. 17

0.02

0.015

0.01

0.005

0 4 3 2 1 y 0 0 1 x 3 2 4

Figure 2.4: The simulation results of numerical solution with D = 4, m1 = -2/5, m2 = -1/2, tmax = 1, x = 1/30, t = 1/200, 1 = 2 = 1. The error between the numerical solution and exact solution is about 8.0 × 10-4 .

18

0.02

0.015

0.01

0.005

0 4 3 2 1 y 0 0 1 x 3 2 4

Figure 2.5: The simulation results of exact solution with D = 4, m1 = -2/5, m2 = -1/2, tmax = 1, x = 1/30, t = 1/200, 1 = 2 = 1

19

2.5

The Method of Images

The nature of the method of images is to replace the boundary conditions by a set of fictitious source terms so that the solution of the original equation satisfying the appropriate boundary conditions reduces to that of finding solutions of the equations. In the case of linear differential equations, the process of obtaining the final solution divides into three distinct steps (see [25]). 1) Solving the differential equation appropriate to a point source in an infinite medium, but with no boundary conditions except that of good behavior at infinity. 2) Find the set of image source, and 3) Adding the solution in 1) over the set of images obtained in step 2). In general, the solution of step 1) is usually relatively simple. The key point is how to find the set of image source. In the following, we will describe how the method of images is applied to solve the partial differential equations (2.18)(2.20). Step 1) Solving the equations (2.18) and (2.20), we obtain, for arbitrary initial point (^ z10 , z ^20 )  R2 , u= 1 1 exp[- ((z1 - z ^10 )2 ) + (z2 - z ^20 )2 ]. 2 t 2t

Step 2) Finding the set of image source, we denote x = r cos , y = r sin , and, for k = 0, 1, 2, · · · , n - 1,
+ Tk = {(x, y )|r  0,

2k (2k + 1)  }, n n 2k (2k - 1)  }. n n

- Tk = {(x, y )|r  0,

+ We suppose that the initial point (z10 , z20 )  T0 , and z10 = r0 cos 0 , z20 = + r0 sin 0 . Then we can obtain that the conjugate points of (z10 , z20 ) in the Tk - 2k 2k 2k and Tk can be expressed as (r0 cos( n + 0 ), r0 sin( n + 0 )) and (r0 cos( n - 0 ), r0 sin( 2k n - 0 )), respectively. Step 3) Letting ± gk (z1 , z2 , t) = ±(2t)-1 × (2.24)

2k 2k 1 [(z1 - r0 cos( ± 0 ))2 + (z2 - r0 sin( ± 0 ))2 ]), 2t n n we obtain the general solution of equations (2.18)-(2.20), by adding the two functions in (2.24), exp(-
n-1

u=
k=0

+ - [gk (z1 , z2 , t) + gk (z1 , z2 , t)].

(2.25)

20

Step 4) We check that (2.25) is the solution of (2.18)-(2.20). It is easy to check that
+ gk (z1 , z2 , t = 0) =  (z1 - r0 cos(

2k 2k + 0 )) (z2 - r0 sin( + 0 )), n n 2k 2k - 0 )) (z2 - r0 sin( - 0 )). n n

and
- gk (z1 , z2 , t = 0) = - (z1 - r0 cos(

Obviously, u(z1 , z2 , t = 0) satisfies the initial condition of (2.20). To check the boundary conditions of (2.19), we let z1 = r cos , z2 = r sin . Then
+ gk (z1 , z2 , t) =

1 1 2k 2 exp(- [r2 + r0 - 2rr0 cos( -  + 0 )]), 2t 2t n 1 2k 1 2 exp(- [r2 + r0 - 2rr0 cos( -  - 0 )]). 2t 2t n 1 1 2j 2 exp(- [r2 + r0 - 2rr0 cos( +  + 0 )]). 2t 2t n

and
- gk (z1 , z2 , t) = -

Letting j = n - k, j = 1, 2, 3, ..., n,
- g ^j (z1 , z2 , t) = -

+ - (1). If  = 0, which is equivalent to z2 = 0, we have gk (z1 , 0, t)+gk (z1 , 0, t) = 0. Hence u(z1 , z2 = 0, t) = 0.

(2). If  =

 n,

 which is equivalent to z2 = z1 tan n , we find that

+ gk (z1 , z1 tan

 1 1 (2k - 1) 2 , t) = exp(- [r2 + r0 - 2rr0 cos( + 0 )]), n 2t 2t n

and
- g ^j (z1 , z1 tan

 1 1 (2j + 1) 2 , t) = - exp(- [r2 + r0 - 2rr0 cos( + 0 )]). n 2t 2t n   - , t ) = -g ^j ((z1 , z1 tan , t). n n

Hence, for j = k - 1, k = 1, 2, · · · , n - 1
+ gk (z1 , z1 tan

1) + 0 ) = cos(-  Since cos( (2n- n n + 0 ), we obtain + g0 (z1 , z1 tan

  - , t) = -g ^n -1 ((z1 , z1 tan , t). n n
n-1 + gk (z1 , z2 , t) - gk (z1 , z2 , t) k=0

Therefore,
n-1

u(z1 , z2 , t) =
k=0

+

is the solution of equations (2.18)-(2.20). 21

1 0.8 0.6 _ 0.4 0.2 0 -0.2 -0.4 + -0.6 -0.8 -1 -1 -0.5 0 0.5 1 _ + _ _ + + + _

Figure 2.6: For n = 5, the signs of every domain for the 2-dimensional case, the sign ± relate to the sign of g in (2.25)

22

Chapter 3

Method of Images for the Three Dimensional Case
A main goal of the thesis is to obtain an analytical expression for (1.1) and related quantities. The fact that a general solution in multi-dimension has not been found after a century of study, see Sommerfeld 1894 (in German) for an initial approach to the topic, shows the difficulty of the problem. The success in solving the two dimensional case by He et. al. 1998, and specially the procedure used in that paper, provides a good framework to explore in multi-dimensions. Their solution was based on the finding of a orthogonal coordinates system that has a two-fold property, first it allows for a solution to the Laplace equation by means of separation of variables, and secondly it keeps the boundary conditions orthogonal, this coordinates system is the simple Polar Coordinates. Unfortunately, the extension to three dimensions is not successful. The reason is that there are only eleven coordinates systems that allow for a solution of the Laplace equation by means of separation of variables (see http://mathworld.wolfram.com/LaplacesEquation.html and the literature therein), but none of them keep the boundary conditions orthogonal. This last statement can be actually checked for each of the systems. Another approach is developed in [1]. Mark B. Wise and Vineer Bhansali considered the case where the off diagonal elements of the correlation matrix are small enough to treat them as a perturbation. They expanded the joint probability density in powers of the off diagonal correlation matrix elements (for details, see [1] ). In [22], Adam Metzler simulated the perturbation. He indicated that the approximation to the survivor function is remarkably accurate for reasonably small values of N. However, the approach is not available if the correlation ij is not small. Given the above mentioned complications, we lowered the original goal and will look for a solution in three dimension for particular correlation values. The method of images is a very useful technique to find explicit solutions for some special multi-dimensional PDE. In [8], Eugene Gutkin and Paul K Newton gave 23

the following Proposition for the unit sphere in three dimensions. Remark 1. We refer to Gutkin and Newton [2004] for the definition of a spherical polygon  as well as the definition of the associated group  . These notions are used in the next proposition. Proposition 1. Let  be a spherical polygon, and let  =  . Then the triple , ,  satisfies the 'assumptions' of the method of images if and only if  is one of the following polygons: 1. It is a hemisphere. 2. It is the bi-gon with the angle /n, where n = 2, 3, .... 3. It is one of the following triangles: (i) The triangle (/2, /2, /n), where n = 2, 3, .... (ii) The triangle (/2, /3, /3). (iii) The triangle (/2, /3, /4). (iv) The triangle (/2, /3, /5). Inspired by Proposition 1, we solve equations (1.2)-(1.4) for four particular triangle cases: (/2, /2, /n), (/2, /3, /3), (/2, /3, /4) and (/2, /3, /5). In particular, we refer to Section 4 (see the paragraph below (4.8)) where we make explicit the connection between the spherical polygons listed in Proposition 1 and the boundary conditions of the PDE under consideration in this thesis. Some lemmas are provided in Section 3.2. These lemmas are used in Section 3.3 to find the geodesic splitting the sphere as well as to find in Section 3.4 the symmetrical points which are equivalent to the initial condition.

3.1

Some Lemmas

In this section, we will give some lemmas which are useful in the next sections for dividing sphere. The proofs of these lemmas are in the corresponding Appendix. Lemma 1. Suppose that x = x(), y = y (), z = z (),   (0, 0 ) is the intersection of plane z = ax + by and the unit sphere x = cos() sin(), y = sin() sin(), z = cos(),   [0,  ],   [0, 2 ]. Then the length of the arc is tan(0 -  ) tan( ) arctan  + arctan  , 2 2 1+a +b 1 + a2 + b2
b where tan( ) = a , if a = 0. Or

(3.1)

arctan( 1 + a2 + b2 tan(0 +  )) - arctan( 1 + a2 + b2 tan( )), where tan( ) = a b , if b = 0. 24

(3.2)

Remark 2. If x = cos(0 ) sin(), y = sin(0 ) sin(), z = cos(),   [1 , 2 ], then the arc length from 1 to 2 is 2 - 1 . This follows easily by noticing that
2

dl =
l 1

2 2 x2  + y + z d = 2 - 1 .

Lemma 2. Suppose that z = ax + by is a plane, and z0 > ax0 + by0 . Then the symmetric point of (x0 , y0 , z0 ) with respect to the plane can be expressed as (xs , ys , zs ) = A(x0 , y0 , z0 ) , where   A=
-a2 +b2 +1 a2 +b2 +1 -2ab a2 +b2 +1 2a a2 +b2 +1 -2ab a2 +b2 +1 2 a -b2 +1 a2 +b2 +1 2b a2 +b2 +1 2a a2 +b2 +1 2b a2 +b2 +1 2 a +b2 -1 a2 +b2 +1

(3.3)   .

Moreover, AA = I . Where I is the identity matrix. Letting x = r cos() sin(), y = r sin() sin(), z = r cos(), r > 0,   [0,  ],   [0, 2 ], for integer N > 2, k = 0, 1, 2, · · · , N - 1,
+ Dk - Dk

= {(x, y, z ) : r  0,   [0,  ],   [

2k 2k  , + ]}, N N N 2k  2k = {(x, y, z ) : r  0,   [0,  ],   [ - , ]}, N N N

+  By rotating Dk around z axis with angle 2 N in a counter clockwise direction, + + + we can obtain Dk+1 . For convenience, we denote DN = D0 . Therefore, for + + + + + an arbitrary point (xk , yk , zk )  Dk , by the above rotation of Dk , we can + + + + obtain the point (xk+1 , yk+1 , zk+1 )  Dk+1 which is the rotated image point of + + + (x+ k , yk , zk )  Dk . Moreover, + + + + + (x+ k+1 , yk+1 , zk+1 ) = B (xk , yk .zk ) ,

where

 cos( 2 N ) 2  sin( N ) B= 0



 - sin( 2 N ) 2 cos( N ) 0

 0 0  1

+ + + In fact, for arbitrary point (x+ 0 , y0 , z0 )  D0 , by rotating the point around 2k z axis with angle N in a counter clockwise direction, we can obtain its rotating + + + point (x+ k , yk , zk )  Dk which can be expressed by + + + + + + (x+ k , yk , zk ) = Bk (x0 , y0 , z0 ) ,

(3.4)

where

k cos( 2N ) + 2k  Bk = sin( N ) 0



k - sin( 2N ) 2k cos( N ) 0

 0 0 . 1

(3.5)

25

+ It is very easy to check that Bk (B + )k = I . - + + + - - Similarly, letting (x- 0 , y0 , z0 )  D0 be a symmetric point of (x0 , y0 , z0 ) - - - with respect to y = 0, obtained by rotating the point (x0 , y0 , z0 ) around z - - k axis with angle 2N in a counter clockwise direction, hence (x- 0 , y0 , z 0 ) = - - - - + + + , (x0 , -y0 , z0 ) . Therefore, we can get its rotating point (xk , yk , zk )  Dk and it can be expressed by - - - + + + (x- k , yk , zk ) = Bk (x0 , y0 , z0 ) ,

(3.6)

where
- Bk

k cos( 2N ) 2k  = sin( N ) 0



k sin( 2N ) k - cos( 2N ) 0

 0 0 . 1

(3.7)

- - It is very easy to check that Bk (Bk ) = I (identity ). - - - + It is easy to see that DN = D0 for t = 1, 2, · · · N , Dt and Dt -1 are neigh1) ) x . At the same time, for t = bor with common boundary y = tan( (2t- N - + t 0, 1, · · · , N - 1, Dt )x. and Dt are neighbor with common boundary y = tan( 2N

- - - + + Lemma 3. Suppose that (x+ s , ys , zs ) and (xt , yt , zt ) are expressed in (3.4) and (3.6), respectively. Then we have - - - (i) For t = 1, 2, · · · , N , then (x- t , yt , zt )  Dt is the symmetric point of 1) + + + + )x. (xt-1 , yt-1 , zt-1 )  Dt-1 with respect to y = tan( (2t- N - - - (ii) For t = 0, 1, · · · , N - 1, then (x- t , yt , zt )  Dt is the symmetric point of + + + + 2t (xt , yt , zt )  Dt with respect to y = tan( N )x.

3.2

The Division of the Sphere

In this section, we provide the geodesic arc lines that split the sphere into triangles such that the method of images can be applied according to Proposition 1.

3.2.1

The Case of (  ,  ,  ), n  2 2 2 n
2k 2k  , + ],   [0, /2]}, k = 0, 1, 2, · · · , n - 1; n n n 2k 2k  , + ],   [/2,  ]}, k = 0, 1, 2, · · · , n - 1; n n n 26

We divide the sphere (r = 1, center O(0, 0, 0)) into 4n slices, which are
+ Tk, 1 = {(,  ) :   [ + Tk, 2 = {(,  ) :   [

- Tk, 1 = {(,  ) :   [

2k  2k - , ],   [0, /2]}, k = 0, 1, 2, · · · , n - 1; n n n 2k  2k - , ],   [/2,  ]}, k = 0, 1, 2, · · · , n - 1. n n n

and
- Tk, 2 = {(,  ) :   [

We denote the north pole as P , the south pole as Q, the intersection between (2k-1)  = /2 and  = 2k n as Ak , the intersection between  = /2 and  = n as Bk , for k = 0, 2, · · · , n - 1. Obviously, we can see that the spherical triangles   P Ak Bk , P Ak Bk+1 , and QAk Bk , QAk Bk+1 , are of (  2 , 2 , n ), n  2.

3.2.2

The Case of (  , , ) 2 3 3

We first divide the sphere into 6 slices. Then each slices is divided into 4 spherical triangles in step 2 and step 3. Step 2 focuses on positive slices while step 3 on negatives. 1. At first, we divide the sphere (r = 1, center O(0, 0, 0)) into six slices, which are 2k 2k  + Tk = {(, ) :   [ , + ],   [0,  ]}, k = 0, 1, 2; 3 3 3 and
- Tk = {(, ) :   [

2k  2k - , ],   [0,  ]}, k = 0, 1, 2. 3 3 3

+ 2. Secondly, we divide T0 into four spherical triangles. At first we set some + special points on T0 . They are

A(sin( ), 0, cos( )), C (sin(2 ), 0, cos(2 )),   B (sin() cos( ), sin() sin( ), cos()) 3 3   D(sin( -  ) cos( ), sin( -  ) sin( ), cos( -  )), 3 3 where  = arccos(
 3 1 3 ),  = arccos( 3 ) (see figure 3.1 + T0 , there are three geodesics, which

).

On the domain connect AB, BC and CD respectively. If we denote the north pole as P , the south pole as Q.We + have divided T0 into four spherical triangles P AB, ABC, BCD, CDQ. For convenience, we denote the spherical triangles from top to bottom as + + T0 j , j = 1, 2, 3, 4. Now, we turn to find the spherical triangles of Tk . It is + + + easy to see that T1 and T2 are obtained by rotating T0 in a counter   and 43 , respectively. By rotating clockwise direction with angles 23 arcs AB, BC and CD in a counter clockwise direction with angle 2k 3 , + we can get new arcs which can divide Tk into four spherical triangles, for k = 1, 2. We denote the spherical triangles from top to bottom as + Tkj , k = 1, 2, j = 1, 2, 3, 4. 27

- 3. Finally, we find the spherical triangles of Tk . At first, the symmetric points of B and D with respect to  = 0 are   B (sin() cos(- ), sin() sin(- ), cos()), 3 3

  D (sin( -  ) cos(- ), sin( -  ) sin(- ), cos( -  )). 3 3 As we did in the step 2, there are three geodesics, which connect AB , B C - and CD , respectively. Hence, we have divided T0 into four spherical - triangles P AB , AB C, BCD , CD Q. We denote them as T0 j, j = 1, 2, 3, 4 from top to bottom. By rotating arcs AB , B C and CD in a counter clockwise direction with angle 2k 3 , we can get new arcs which - can divide Tk into four spherical triangles, for k = 1, 2. We denote the - spherical triangles from top to bottom as Tkj , k = 1, 2, j = 1, 2, 3, 4.
  We prove that all the spherical triangles which we obtained are of (  2 , 3 , 3 ). The proof of the following lemmas are in Appendix. At first, we need to get the side arc length.

and

Lemma 4.  + 2 = . Lemma 5. (i) For the spherical triangle P AB , the side arc length of P A, P B and AB are ,  and  , respectively. (ii) For the spherical triangle ABC , the side arc length of AB, BC and AC are ,  and  , respectively. (iii) For the spherical triangle BCD, the side arc length of BD, BC and CD are ,  and  , respectively. (iv) For the spherical triangle CDQ, the side arc length of CD, CQ and DQ are ,  and  , respectively. Lemma 6. The spherical triangles P AB, ABC, BCD and CDQ are of   the form (  2 , 3 , 3 ).

3.2.3

, , ) The Case of (  2 3 4

We follow as the previous two cases. 1. We divide the sphere (r = 1, center O(0, 0, 0)) into eight slices, which are
+ Fk = {(, ) :   [

2k 2k  , + ],   [0,  ]}, k = 0, 1, 2, 3; 4 4 4 2k  2k - , ],   [0,  ]}, k = 0, 1, 2, 3. 4 4 4 28

and
- Fk = {(, ) :   [

Figure 3.1: The spherical triangles of (/2, /3, /3) in the first slices

29

+ 2. We divide F0 into six spherical triangles. At first we set some special points + on F0 . They are

A(sin( ), 0, cos( )), C (1, 0, 0),   B (sin() cos( ), sin() sin( ), cos()), 4 4   D(cos( ), sin( ), 0), F (sin( -  ), 0, cos( -  )). 4 4   E (cos( ) sin( - ), sin( ) sin( - ), cos( - )), 4 4 where  =
 4,

= arccos(
+ F0 ,

 3 3 )(see

figure 3.2).

On the domain there are five geodesics, which connect AB, BC , CD,CE and EF , respectively. If we denote the north pole as P , the + south pole as Q. We have divided F0 into six spherical triangles P AB , ABC , BCD, CDE ,CEF , EF Q. For convenience, we denote + these spherical triangles from top to bottom as F0 j , j = 1, 2, 3, 4.
+ + It is easy to see that Fk is obtained by rotating F0 in a counter clockwise 2k direction with angles 4 , k = 1, 2, 3. By rotating arcs AB, BC, CD, CE and EF in a counter clockwise direction with angle 2k 4 , we can get new + arcs which can divide Fk into six spherical triangles, for k = 1, 2, 3. We + denote the spherical triangles from top to bottom as Fkj , k = 1, 2, 3, j = 1, 2, 3, 4, 5, 6. - 3. We find the spherical triangles of Fk .

At first, the symmetric points of B, D and E with respect to  = 0, which is y = 0, are     B (sin() cos(- ), sin() sin(- ), cos()), D (cos(- ), sin(- ), 0) 4 4 4 4 and   E (sin( -  ) cos(- ), sin( -  ) sin(- ), cos( -  )). 4 4

As we did in the step 2, there are five geodesics, which connect AB , B C , - CD , CE and F E , respectively. Hence, we have divided F0 into six spherical triangles P AB , AB C , BCD , CD E , CE F and - E F Q. We denote them as F0 j , j = 1, 2, 3, 4, 5, 6 from top to bottom. By rotating arcs AB , B C , CD , CE and E F in a counter clockwise - direction with angle 2k 4 , we can get new arcs which can divide Fk into six spherical triangles, for k = 1, 2, 3. We denote the spherical triangles - from top to bottom as Fkj , k = 1, 2, 3, j = 1, 2, 3, 4, 5, 6.
  Next, we prove that all the spherical triangles which we got are of (  2 , 3 , 4 ). At first, we need to get the side arc length.

30

Figure 3.2: The spherical triangles of (/2, /3, /4) in the first slice

31

Lemma 7. (i) For the spherical triangle P AB , the side arc length of P A, P B  and AB are  4 ,  and 2 - , respectively. (ii) For the spherical triangle ABC , the side arc length of AB, BC and AC  are  2 - ,  and 4 , respectively. (iii) For the spherical triangle BCD, the side arc length of BD, BC and CD  are  2 - ,  and 4 , respectively. (iv) For the spherical triangle CDE , the side arc length of CD, CE and DE  are  4 ,  and 2 - , respectively. (v) For the spherical triangle CEF , the side arc length of EF, CE and CF  are  2 - ,  and 4 , respectively. (vi) For the spherical triangle EF Q, the side arc length of F Q, EQ and EF  are  4 ,  and 2 - , respectively. Lemma 8. The spherical triangles P AB, ABC, BCD, CDE, CEF   and EF Q are of the form (  2 , 3 , 4 ).

3.2.4

, , ) The Case of (  2 3 5

It is similar to Sections 3.1 to 3.3, we just follow the next 3 steps. 1. We divide the sphere (r = 1, center O(0, 0, 0)) into ten slices, which are, for k = 0, 1, 2, 3, 4
+ Wk = {(, ) :   [

2k 2k  , + ],   [0,  ]}; 5 5 5 2k  2k - , ],   [0,  ]}. 5 5 5

and
- Wk = {(, ) :   [

+ 2. We divide W0 into 12 spherical triangles. At first we set some special points + on W0 . They are

A(sin( ), 0, cos( )), C (sin(2 ), 0, cos(2 )),   B (sin() cos( ), sin() sin( ), cos()), 5 5   D(cos( ) sin( +  ), sin( ) sin( +  ), cos( +  )), 5 5   E (cos( ) sin( + 2 ), sin( ) sin( + 2 ), cos( + 2 )), 5 5 F (sin(2 + ), 0, cos(2 + )),   G(cos( ) sin( - 2 ), sin( ) sin( - 2 ), cos( - 2 )), 5 5 H (sin( -  -  ), 0, cos( -  -  )), K (sin( - ), 0, cos( - ))   L(cos( ) sin( -  ), sin( ) sin( -  ), cos( -  )). 5 5 32

where  = arcsin(l),  = arcsin( figure 3.3).

 3l 2 ), 

= arcsin(l sin(  5 )), l =

) 4 sin(   5 (see 15

+ On the domain W0 , there are ten geodesics, which connect AB, BC , CD, CE, EF , CG, F G, GH, GK and KL, respectively. If we denote the north pole as P , the south pole as Q, the intersection of CG and EF as M . We + have divided W0 into 12 spherical triangles P AB , ABC , BCD, CDE ,CEM , CM F , EM G, M F G, F GH , HGK ,GKL and KLQ. For convenience, we denote these spherical triangles from + top to bottom as W0 j , j = 1, 2, · · · , 5, 6, 7, · · · , 11, 12 (we denote CM F + + as W06 and EM G as W012 ). + Now, We turn to find the spherical triangles of Wk . It is easy to see that + + Wk is obtained by rotating W0 in a counter clockwise direction with angles 2k 5 , k = 1, 2, 3, 4. By rotating arcs AB, BC , CD ,CE , EF, CG, F G, GH , GK and KL in a counter clockwise direction with angle 2k 5 , we can get + new arcs which can divide Wk into 12 spherical triangles, for k = 1, 2, 3, 4. We denote the spherical triangles from top to bottom (the order of j is + + the same as Wo ) as Wkj , k = 1, 2, 3, 4, j = 1, 2, · · · , 5, 6, 7, · · · , 11, 12. - 3. We find the spherical triangles of Wk .

At first, the symmetric points of B, D, E, G and L with respect to  = 0, which is the plane y = 0, are   B (sin() cos(- ), sin() sin(- ), cos()), 5 5   D (cos(- ) sin( +  ), sin(- ) sin( +  ), cos( +  )), 5 5   E (cos(- ) sin( + 2 ), sin(- ) sin( + 2 ), cos( + 2 )), 5 5   G (cos(- ) sin( - 2 ), sin(- ) sin( - 2 ), cos( - 2 )), 5 5   L (cos(- ) sin( -  ), sin(- ) sin( -  ), cos( -  )). 5 5 As we did in the step 2, there are ten geodesics, which connect AB , B C , CD , CE , E F , CG , F G , G H, G K and KL , respectively. Also, we denote M as the intersection of arcs CG and F E , Hence, we have divided - W0 into 12 spherical triangles P AB , AB C , B CD , CD E ,CE M , CM F , E M G , M F G , F G H , HG K ,GKL and KL Q. For convenience, we denote these spherical triangles from top to bottom - - as W0 j , j = 1, 2, · · · , 11, 12 (we denote CM F as W06 and E M G - - as W0 ,12 ). by rotating W0 in a counter clockwise direction with angles 2k 5 , k = 1, 2, 3, 4. By rotating arcs AB , B C , CD , CE , E F , CG , F G , G H, G K and KL in a clockwise direction with angle 2k 5 , we can get new - arcs which can divide Wk into 12 spherical triangles, for k = 1, 2, 3, 4. We denote the spherical triangles from top to bottom (or from left to right) - as Wkj , k = 1, 2, 3, 4, j = 1, 2, · · · , 11, 12. 33

Figure 3.3: The spherical triangles of (/2, /3, /5) in the first slice
  Next, we prove that all the spherical triangles which we got are of (  2 , 3 , 5 ). At first, we need to give the following lemma, 4 sin(  )  5 , 15

Lemma 9. If l =

then ++ =  . 2

Now we need to get the side arc length. Lemma 10. (i) For the spherical triangle P AB , the side arc length of P A, P B and AB are ,  and  , respectively. (ii) For the spherical triangle ABC , the side arc length of AB, BC and AC are ,  and  , respectively. 34

(iii) For the spherical triangle BCD, the side arc length of BD, BC and CD are ,  and  , respectively. (iv) For the spherical triangle CDE , the side arc length of CD, CE and DE are ,  and  , respectively. (v) For the spherical triangle QLK , the side arc length of QL, QK and LK are ,  and  , respectively. (vi) For the spherical triangle LKG, the side arc length of LK, KG and LG are ,  and  , respectively. (vii) For the spherical triangle KGH , the side arc length of KH, KG and GH are ,  and  , respectively. (viii) For the spherical triangle GHF , the side arc length of GH, GF and F H are ,  and  , respectively.

Lemma 11. (i) The arc length of CG is 2 . (ii) The arc length of EF is 2 . (iii) The plane OEF is vertical to plane OCG. (iv) If M be the intersection of arcs EF and CG, then the arcs length of M F and M C are  and  , respectively.

Lemma 12. The spherical triangles P AB , ABC , BCD, CDE ,CEM , CM F , EM G, M F G, F GH , HGK ,GKL and KLQ are of the   form (  2 , 3 , 5 ).

3.3

Symmetric Points

In this section, we provide the set of source points symmetrical to the initial condition needed for the method of images. Let x = r cos() sin(), y = r sin() sin(), z = r cos(), r  0,   [0,  ],   [0, 2 ].

3.3.1

The Case of (  ,  ,  ), n  2 2 2 n
± ± Hkj = R+ × Tkj .

We denote, for k = 0, 1, 2, · · · n, j = 1, 2,

35

Figure 3.4: The symmetric points of (/2, /2, /6) for k = 0, j = 1, 2
± ± We say that (x0 , y0 , z0 )  Hkj , for specific k, j , if (0 , 0 )  Tkj , r0  0. In this + + + + section, we always set (x0,1 , y0,1 , z0,1 ) = (x0 , y0 , z0 )  H0,1 . See figure 3.4, for ± R0 ,j = Aj (x0 , ±y0 , z0 ) . It is easy to see that, for k = 1, 2, · · · , n, j = 0, 1 + + + (x+ k,j , yk,j , zk,j ) = Bk Aj (x0 , y0 , z0 ) ,

and
- - - (x- k,j , yk,j , zk,j ) = Bk Aj (x0 , y0 , z0 ) , ± where Bk are expressed in (3.5) and (3.7),  1 0 A2 =  0 1 0 0

A1 = I ,  0 0 . -1

(3.8)

36

3.3.2

The Case of (  , , ) 2 3 3

As before, we denote, for k = 0, 1, 2, j = 1, 2, 3, 4, where k represents slices and j triangles ± ± Hkj = R+ × Tkj .
± ± We state that (x0 , y0 , z0 )  Hkj , for specific k, j , if (0 , 0 )  Tkj , r0  0. In this + + + + section, we always set (x0,1 , y0,1 , z0,1 ) = (x0 , y0 , z0 )  H0,1 , where (x0 , y0 , z0 ) is the point for the initial condition. There are three steps to find the symmetric points: + + + 1. To find point (x+ 0,j , y0,j , z0,j )  H0,j , j = 2, 3, 4, which is the symmetric point + + + of (x+ 0,j -1 , y0,j -1 , z0,j -1 ) with respect to the boundary between H0,j and + - - - H0,j -1 for j = 2, 3, 4. Also by symmetry, we can get (x0,j , y0,j , z0 ,j )  - - - - H0,j , j = 2, 3, 4, which is the symmetric point of (x0,j -1 , y0,j -1 , z0,j -1 ) - - with respect to the boundary between H0 ,j and H0,j -1 for j = 2, 3, 4. + + + + + + 2. We obtain point (x+ k,j , yk,j , zk,j )  Hk,j , j = 1, 2, 3, 4, by rotating (x0,j , y0,j , z0,j ) 2k around z axis in a counter clockwise direction with angle 3 . At the - - - same time, we can obtain (x- k,j , yk,j , zk,j )  Hk,j , j = 1, 2, 3, 4, by rotating - - (x- 0,j , y0,j , z0,j ) around z axis in a counter clockwise direction with angle 2k 3 . - - + + + 3. We prove that (x- k,j , yk,j , zk,j ) is the symmetric point of (xk,j , yk,j , zk,j ) with - + respect to the boundary between Hk,j and Hk,j for k = 0, 1, 2, j = 1, 2, 3, 4; - - - + + and (xk,j , yk,j , zk,j ) is the symmetric point of (x+ k-1,j , yk-1,j , zk-1,j ) with - + and Hk,j for k = 1, 2, j = 1, 2, 3, 4. respect to the boundary between Hk,j

Next, we develop these steps.
+ + + + + + Step 1. To find point (x+ 0,j , y0,j , z0,j )  H0,j , j = 2, 3, 4, such that (x0,j , y0,j , z0,j ) + + is the symmetric point of (x+ 0,j -1 , y0,j -1 , z0,j -1 ) with respect to the boundary be+ + ± tween H0,j and H0,j -1 for j = 2, 3, 4. See figure 3.5, where R0 j = Aj (x0 , ±y0 , z0 ) , A1 = I , and Aj can be presented as follows.

(i) For j = 2, since the plane OAB is z = symmetric matrix is   A2 =  0
1 3



2 2 x,

by Lemma 2, we have the

2 2 3

  0 232  1 0 , 0 -1 3

(3.9)

+ + and (x+ 0,2 , y0,2 , z0,2 ) = A2 (x0 , y0 , z0 ) .

37

(ii) For j = 3, since the plane OBC is z = - the symmetric matrix is    A=
5 6  3 6

  2 6 4 x + 4 y,  2 3 6 3 -1 3

by Lemma 2, we have

-

2 3

3 6 1 2  6 3

- 

  , = A3 (x0 , y0 , z0 ) , with   .


+ + Letting A3 = AA2 , then we get (x+ 0,3 , y0,3 , z0,3 )    3 2 2 1 - 6 6 3   1 A3 =  23 0 2   6 - 32 -1 3 3 

(3.10)

(iii) For j = 4, since the plane OCD is z = - 42 x - 46 y , by Lemma 2, we have the symmetric matrix is     2 5 - 63 -  6  3   1 A =  - 63 2 - 36  .   - 32 - 36 - 1 3
+ + Letting A4 = AA3 , then we get (x+ 0,4 , y0,4 , z0,4 ) = A4 (x0 , y0 , z0 ) , with     3 2 2 1 - - 6 3   6 1 (3.11) A4 =  23 , - 0 2  2 6 1 - 6 - 3 -3

Step 2. By setting A1 = I , we can get, for k = 0, 1, 2, j = 1, 2, 3, 4,
+ + + (x+ k,j , yk,j , zk,j ) = Bk Aj (x0 , y0 , z0 ) ,

and

- - - (x- k,j , yk,j , zk,j ) = Bk Aj (x0 , y0 , z0 ) ,

± ± The following Lemma states this the relationship for (x± k,j , yk,j , zk,j ). + + Lemma 13. (i) For k = 0, 1, 2, j = 1, 2, 3,(x+ k,j , yk,j , zk,j ) is the symmetric + + + + point of (xk,j +1 , yk,j +1 , zk,j +1 ) with respect to the boundary between Hk,j + and Hk,j +1 . - - - (ii) For k = 0, 1, 2, j = 1, 2, 3,(x- k,j , yk,j , zk,j ) is the symmetric point of (xk,j +1 , - - - - yk,j +1 , zk,j +1 ) with respect to the boundary between Hk,j and Hk,j +1 . - - Step 3. By Lemma 3, we can prove that (x- k,j , yk,j , zk,j ) is the symmet+ + - ric point of (x+ k,j , yk,j , zk,j ) with respect to the boundary between Hk,j and + - - - Hk,j for k = 0, 1, 2, j = 1, 2, 3, 4; and (xk,j , yk,j , zk,j ) is the symmetric point of + + - + (x+ k-1,j , yk-1,j , zk-1,j ) with respect to the boundary between Hk,j and Hk,j for k = 1, 2, j = 1, 2, 3, 4.

38

Figure 3.5: The symmetric points of (/2, /3, /3)for k = 0, j = 1, 2, 3, 4

39

3.3.3

The Case of (  , , ) 2 3 4
± ± . Hkj = R+ × Fkj

We denote, for k = 0, 1, 2, 3, j = 1, 2, 3, 4, 5, 6,

± ± We say that (x0 , y0 , z0 )  Hkj , for specific k, j , if (0 , 0 )  Fkj , r0  0. In + + + + this section, we always set (x0,1 , y0,1 , z0,1 ) = (x0 , y0 , z0 )  H0,1 . There are three steps to obtain symmetric points: + + + 1. To find point (x+ 0,j , y0,j , z0,j )  H0,j , j = 2, 3, 4, 5, 6, which is the symmet+ + + ric point of (x0,j -1 , y0,j -1 , z0,j -1 ) with respect to the boundary between + + H0 ,j and H0,j -1 for j = 2, 3, 4, 5, 6. Also by symmetry, we can get - - - (x- 0,j , y0,j , z0,j )  H0,j , j = 1, 2, 3, 4, 5, 6, which is the symmetric point - - - - of (x0,j -1 , y0,j -1 , z0,j -1 ) with respect to the boundary between H0 ,j and - H0,j -1 for j = 2, 3, 4, 5, 6. + + + 2. To find point (x+ k,j , yk,j , zk,j )  Hk,j , j = 1, 2, 3, 4, 5, 6, which is obtained + + by rotating (x+ 0,j , y0,j , z0,j ) around z axis in a counter clockwise direction - - - 2k with angle 4 . At the same time, we can get (x- k,j , yk,j , zk,j )  Hk,j , j = - - 1, 2, 3, 4, 5, 6, which is obtained by rotating (x- 0,j , y0,j , z0,j ) around z axis 2k in a counter clockwise direction with angle 4 . - - 3. By Lemma 3, we can prove that (x- k,j , yk,j , zk,j ) is the symmetric point of + + - + (x+ k,j , yk,j , zk,j ) with respect to the boundary between Hk,j and Hk,j for - - - k = 0, 1, 2, 3, j = 1, 2, 3, 4, 5, 6; and (xk,j , yk,j , zk,j ) is the symmetric point + + - of (x+ k-1,j , yk-1,j , zk-1,j ) with respect to the boundary between Hk,j and + Hk,j for k = 1, 2, 3, j = 1, 2, 3, 4, 5, 6.

Next, we develop steps 1 and 2. + + + Step 1. We find point (x+ 0,j , y0,j , z0,j )  H0,j , j = 2, 3, 4, 5, 6, such that + + + + + + (x0,j , y0,j , z0,j ) is the symmetric point of (x0,j -1 , y0 ,j -1 , z0,j -1 ) with respect to + + the boundary between H0 ,j and H0,j +1 for j = 2, 3, 4, 5, 6. See figure 3.6, where ± R0j = Aj (x0 , ±y0 , z0 ) , A1 = I , and Aj can be presented as follows. (i) For j = 2, since the plane OAB is z = x, from Lemma 2 we obtain that the symmetric matrix is   0 0 1 A2 =  0 1 0  , (3.12) 1 0 0
+ + and (x+ 0,2 , y0,2 , z0,2 ) = A2 (x0 , y0 , z0 ) .

40

(ii) For j = 3, since the plane OBC is z = y , symmetric matrix is  1 0 A= 0 0 0 1

by Lemma 2 we obtain that the  0 1 , 0

+ + Letting A3 = AA2 , then we get (x+ 0,3 , y0,3 , z0,3 ) = A3 (x0 , y0 , z0 ) , with   0 0 1 (3.13) A3 =  1 0 0  . 0 1 0

(iii) For j = 4, since the plane OCD is z symmetric matrix is  1 A= 0 0

= 0, by Lemma 2 we obtain that the 0 1 0  0 0 . -1

+ + Letting A4 = AA3 , then we get (x+ 0,4 , y0,4 , z0,4 ) = A4 (x0 , y0 , z0 ) , with   0 0 1 0 , A4 =  1 0 (3.14) 0 -1 0

(iv) For j = 5, since the plane OCE is the symmetric matrix is  1 A= 0 0

z = -y , by Lemma 2 we obtain that  0 0 0 -1  . -1 0

+ + Letting A5 = AA4 , then we get (x+ 0,4 , y0,4 , z0,4 ) = A5 (x0 , y0 , z0 ) , with   0 0 1 1 0 , A5 =  0 (3.15) -1 0 0

(v) For j = 6, since the plane OEF is z = -x, by Lemma 2 we obtain that the symmetric matrix is   0 0 -1 1 0 . A= 0 -1 0 0
+ + Letting A6 = AA5 , then we get (x+ 0,4 , y0,4 , z0,4 ) = A6 (x0 , y0 , z0 ) , with   1 0 0 A6 =  0 1 0  , (3.16) 0 0 -1

41

Step 2 By setting A1 = I , we can get, for k = 0, 1, 2, 3, j = 1, 2, 3, 4, 5, 6
+ + + (x+ k,j , yk,j , zk,j ) = Bk Aj (x0 , y0 , z0 ) ,

and

- - - (x- k,j , yk,j , zk,j ) = Bk Aj (x0 , y0 , z0 ) ,

± ± The following Lemma is to state that the relationship of (x± k,j , yk,j , zk,j ). + + Lemma 14. (i) For k = 0, 1, 2, 3, j = 1, 2, 3, 4,(x+ k,j , yk,j , zk,j ) is the symmetric + + + point of (x+ k,j +1 , yk,j +1 , zk,j +1 ) with respect to the boundary between Hk,j + and Hk,j +1 . - - (ii) For k = 0, 1, 2, 3, j = 1, 2, 3, 4,(x- k,j , yk,j , zk,j ) is the symmetric point of - - - - (x- k,j +1 , yk,j +1 , zk,j +1 ) with respect to the boundary between Hk,j and Hk,j +1 .

The proof of the Lemma is very similar to Lemma 3.4.1 and, therefore, we omit it. The proof of step 3 is very similar to that of the previous section and so we also omit it.

3.3.4

The Case of (  , , ) 2 3 5
± ± Hkj = R+ × Wkj .

We denote, for k = 0, 1, 2, 3, 4, j = 1, 2, · · · , 12,

± ± We say that (x0 , y0 , z0 )  Hkj , for specific k, j , if (0 , 0 )  Wkj , r0  0. In this + + + + section, we always set (x0,1 , y0,1 , z0,1 ) = (x0 , y0 , z0 )  H0,1 . As we did in the above sections, we calculate the matrix one by one. There are three steps to obtain symmetric points: + + + 1. To find point (x+ 0,j , y0,j , z0,j )  H0,j , j = 2, 3, · · · , 10, 11, which is the sym+ + metric point of (x+ 0,j -1 , y0,j -1 , z0,j -1 ) with respect to the boundary be+ + + + tween H0,j and H0,j -1 for j = 2, 3, · · · , 10, 11. The point (x+ 0,12 , y0,12 , z0,12 ) + + is the symmetric point of (x+ 0,5 , y0,5 , z0,5 ) with respect to the boundary be+ + - - tween H0,12 and H0,5 . Also by symmetry, we can get (x- 0,j , y0,j , z0,j )  - - - - H0,j , j = 1, 2, · · · , 10, 11, which is the symmetric point of (x0,j -1 , y0,j -1 , z0 ,j -1 ) - - with respect to the boundary between H0,j and H0,j -1 for j = 2, 3, · · · , 10, 11. - - - - - The point (x- 0,12 , y0,12 , z0,12 ) is the symmetric point of (x0,5 , y0,5 , z0,5 ) with - - respect to the boundary between H0 ,12 and H0,5 . + + + 2. To find point (x+ k,j , yk,j , zk,j )  Hk,j , j = 1, 2, · · · , 11, 12, which is obtained + + + by rotating (x0,j , y0,j , z0,j ) around z axis in a counter clockwise direction - - - - with angle 2k 5 . At the same time, we can get (xk,j , yk,j , zk,j )  Hk,j , j = - - - 1, 2, · · · , 11, 12, which is obtained by rotating (x0,j , y0,j , z0,j ) around z axis in a counter clockwise direction with angle 2k 5 .

42

Figure 3.6: The symmetric points of (/2, /3, /4) for k = 0, j = 1, 2, 3, 4, 5, 6

43

- - 3. By Lemma 3, we can prove that (x- k,j , yk,j , zk,j ) is the symmetric point of + + - + (x+ k,j , yk,j , zk,j ) with respect to the boundary between Hk,j and Hk,j for - - - k = 0, 1, 2, 3, 4, j = 1, 2, · · · , 11, 12; and (xk,j , yk,j , zk,j ) is the symmetric + + - point of (x+ k-1,j , yk-1,j , zk-1,j ) with respect to the boundary between Hk,j + and Hk,j for k = 1, 2, 3, 4, j = 1, 2, · · · , 11, 12.

Next, we develop step 1 and step 2. + + + Step 1. We find point (x+ 0,j , y0,j , z0,j )  H0,j , j = 2, 3, · · · , 11, 12, such that + + + + + + (x0,j , y0,j , z0,j ) is the symmetric point of (x0,j -1 , y0 ,j -1 , z0,j -1 ) with respect to + + the boundary between H0 ,j and H0,j +1 for j = 2, 3, · · · , 11, 12. See figure 3.7, ± where R0j = Aj (x0 , ±y0 , z0 ) , A1 = I , and Aj can be presented as follows.
1 - 5 A2 =  0 2  5



2  0  5 1 0 , 1 0  5 2  5

(3.17)   ,   ,   ,    ,    ,    ,  (3.23) (3.22) (3.21) (3.20) (3.19) (3.18)

  A3 =    A4 =    A5 =     A6 =     A7 =   

 - 5+1 5  5 4 sin(  5) 2  5+ 5

1 - 4 sin(  )  - 1+1 5 1 2 sin(  5)
5

0
1  5 2  5

 - 5+1 5  5 4 sin(  5) 2  5+ 5

1 4 sin(  5) 1  1+ 5 1 - 2 sin(  5)  1- 5 8 sin(  5) 1 5- 1  5-1 4 sin(  5) 5-1 8 sin(  5) 1  1-  5 1- 5 4 sin(  5) 5-1 8 sin(  5) 1  1-  5 1- 5 4 sin(  5)  5-1 4 sin(  5)  

0
1  5 2  5

1  5-  5 5- 5 8 sin(  5)  - 5-2 5 1  5-  5 5- 5 8 sin(  5)  - 5-2 5

0
1  5 2  5

0
1  5

 4-5 5-  5 1- 5 8 sin(  5) 2  5- 5 1  5

2  5 - 5 5-1 4 sin(  5) 1 - 5 2  5 - 5 5- 1 4 sin(  5) 1 - 5

 1 A8 =   - 2 sin(  5) 2 - 5+5

0
1 2 sin(  5)

44



 1 A9 =   - 2 sin(  5)  - 5+2 5   A10 = 
 - 5-1 5  1- 5 8 sin(  5) 2 - 5

1  5

 1- 5 4 sin(  5)

0 1 - 2 sin(  )
5

2  5 - 5 5- 1 4 sin(  5) 1 - 5 2  5 - 5 5- 1 4 sin(  5) 1 - 5

  ,    , (3.25) (3.24)

0

 5- 5 8 sin(  5) 1  1- 5  5- 5 8 sin(  5) 1  1- 5

  A11 =   A12  = 

0

1 5- 1  5- 5 8 sin(  5)

0

 (3.26)

0

 4-5 5-  5 1- 5 8 sin(  5) 2  5- 5

 1- 5 8 sin(  5) 1 5-1  5-1 4 sin(  5)

2  5 - 5 5- 1 4 sin(  5) 1 - 5

 0 , -1   . 

(3.27)

By setting A1 = I , we can get, for k = 0, 1, 2, 3, 4, j = 1, 2, 3, 4, 5, 6 · · · , 12
+ + + (x+ k,j , yk,j , zk,j ) = Bk Aj (x0 , y0 , z0 ) ,

and

- - - (x- k,j , yk,j , zk,j ) = Bk Aj (x0 , y0 , z0 ) .

The similar Lemma can be obtained as Lemma 14 for the relationship between the above points. Also step 3 can be obtained in a similar way to the previous section, so we omit it.

45

Figure 3.7: The symmetric points of (/2, /3, /5) for k = 0, j = 1, · · · , 12

46

Chapter 4

Density Functions for Some Special Correlations
4.1 The Simplifications to The Heat Equation and its Solutions

To obtain the solution of (1.2)-(1.4), we will proceed to simplify the PDE to the Heat Equation. Letting d=
2 1 12 1 2 13 1 3

12 1 2 2 2 23 2 3 12 1 2 2 2 23 2 3 1 2 3

13 1 3 23 2 3 2 3 13 1 3 23 2 3 2 3 13 1 3 23 2 3 2 3 1 2 3 ,

,

a1 =

1 d

1 2 3

(4.1)

1 a2 = d 1 d

2 1 12 1 2 13 1 3 2 1 12 1 2 13 1 3

,

(4.2)

a3 =

12 1 2 2 2 23 2 3

,

(4.3)

b =

2 2 2 2 2 2 1 a1 + 2 a2 + 3 a3 + 12 1 2 a1 a2 + 13 1 3 a1 a3 2 +23 2 3 a2 a3 - 1 a1 - 2 a2 - 3 a3 ,

(4.4)

and p(x1 , x2 , x3 , m1 , m2 , m3 , t) = q (x1 , x2 , x3 , t) exp(a1 x1 + a2 x2 + a3 x3 + bt), 47

we have
q t

=

2 2 2  2 q 2q + 23 x 2 2 x2 2 3 2q 2q +12 1 2 x1 x2 + 13 1 3 x 1 x3

2 1 2q 2 x2 1

+

 q + 23 2 3 x , 2 x3

2

with boundary conditions q (x1 = m1 , x2 , x3 , t) = 0, q (x1 , x2 = m2 , x3 , t) = 0, q (x1 , x2 , x3 = m3 , t) = 0, and initial condition q (x1 , x2 , x3 , t = 0) =  (x1 ) (x2 ) (x3 ). We continue to simplify the above PDE. z1 = z2 = z3 =
m2 m1 1 - 12 x2 - ( x1 - 1 2 ), 1-2 12 x2 -m2 2 , 13 -12 23 m1 - [ x1 - 2 2 2 1 (1-2 12 )(1-12 -13 -23 +212 13 23 ) 1-2 x3 -m3 23 -12 13 x2 -m2 12 + - 13 -12 13 -12 23 2 23  3 ],



z10 = z20 = z30 =

13 -12 23 m1 [ - 2 2 2 1 (1-2 12 )(1-12 -13 -23 +212 13 23 ) 1-2 23 -12 13 -m2 -m3 12 + 13 -12 23 2 - 13 -12 23 3 ],

-

m1 1 ( - 1 1-2 12 - m2 , 2



m2 - 12 - ), 2

and q (x1 , x2 , x3 , m1 , m2 , m3 , t) = we have h(z1 , z2 , z3 , t) 1 2 3
2 2 1 - 2 12 - 13 - 23 + 212 13 23

,

h 1 2h 2h 2h = [ 2 + 2 + 2 ], t 2 z1 z2 z3

(4.5)

with initial condition h(z1 , z2 , z3 , t = 0) = 1 (z1 - z10 ) (z2 - z20 ) (z3 - z30 ), and boundary conditions h(L1 , z2 , z3 , t) = 0, h(z1 , L2 , z3 , t) = 0, h(z1 , z2 , L3 , t) = 0, 48 (4.7) (4.6)

where  2 1- L1 = {(z1 , z2 , z3 ) : z2 = - 12 12 z1 }, L2 = {(z1 , z2 , z3 ) : z2 = 0}, L3 = {(z1 , z2 , z3 ) : z3 = 
-13 +12 23 [z1 2 2 1-2 12 -13 -23 +212 13 23

+

23 1-2 12 13 -12 23 z2 ]}.



(4.8)

We will make use of the method of images to solve the Heat Equation (4.5)(4.7). At first, we consider the relationships between the special correlations and the triangles which we analyzed in the above section. For the case of (/2, /3, /3), we find that the boundaries of triangular  P AB are the intersection of sphere and planes z2 = tan(/3)z1 , z2 = 0, z3 = 2/2z1 . Considering the Equation (4.7) and P AB , we can obtain that 12 = - cos(/3), 13 = - cos(/3), 23 = 0. Similarly, we can obtain the other cases. In conclusion, we have i). For the case of (/2, /3, /3), 12 = - cos(/3), 13 = - cos(/3), 23 = 0; ii). For the case of (/2, /3, /4), 12 = - cos(/4), 13 = - cos(/3), 23 = 0; iii). For the case of (/2, /3, /5), 12 = - cos(/5), 13 = - cos(/3), 23 = 0; iv). For the case of (/2, /2, /N ), 12 = - cos(/N ), 13 = 0, 23 = 0, where N  2. In the remaining of this thesis we will always assume (unless said otherwise) that
   (H) (12 , 13 , 23 ) = ( 12 , 13 , 0), where (12 , 13 )  H and  1 1 2 1 1 H = {(- , - ), (- , - ), (- cos(/5), - )}  HN , 2 2 2 2 2

where HN = {(- cos(/N ), 0), N  2}. We can obtain the density functions of the minimum and endpoints of Y (t) for the following cases:
1 i). For 12 = 13 = - cos(/3) = - 2 , 23 = 0, we take J1 = 2, J2 = 4;

ii). For 12 = - cos(/4) = - J1 = 3, J2 = 6;

 2 2 , 13

= - cos(/3) = - 1 2 , 23 = 0, we take

1 iii). For 12 = - cos(/5), 13 = - cos(/3) = - 2 , 23 = 0, we take J1 = 5, J2 = 12 ;

49

iv). For 12 = - cos(/N ), 13 = 23 = 0, N  2, we take J1 = N - 1, J2 = 2. The parameters J1 and J2 represent the size of the range of values for the variables j and k (used in in Sections 3.4.1-3.4.4) respectively. So (J1 + 1) · J2 is the total number of source points. Now, we Consider the following heat equation, for arbitrary b1 , b2 , b3 ,
 u  u  u =1 2 + z 2 + z 2 ] 2 [ z1 2 3 u(z1 , z2 , z3 , 0) =  (z1 - b1 ) (z2 - b2 ) (z3 - b3 ). u t
2 2 2

Using Fourier Transform, the solution of the above equation can be expressed as u(z1 , z2 , z3 , t) = 1 1 exp[- [(z1 - b1 )2 + (z2 - b2 )2 + (z3 - b3 )2 ]]. 2t (2t)3/2

+ Now, we turn to consider the following PDE, for (x0 , y0 , z0 )  H0 ,1 ,

 

 u  u  u =1 2 [ x2 + y 2 + z 2 ] u(x, y, z, 0) =  (x - x0 ) (y - y0 ) (z - z0 )  u(L1 , t) = u(L2 , t) = u(L3 , t) = 0,

u t

2

2

2

(4.9)

where

 2 1- L1 = {(x, y, z ) : y = - 12 12 x}, L2 = {(x, y, z ) : y = 0}, 13 L3 = {(x, y, z ) : z =  - x}, 2 2
1-12 -13

We denote, for k = 0, 1, · · · , J1 , j = 1, · · · , J2
± gk,j =±

1 1 ± 2 ± 2 2 exp[- [(x - x± k,j ) + (y - yk,j ) + (z - zk,j ) ], 3 / 2 2t (2t)

± ± ± where (x± k,j , yk,j , zk,j ) = Bk Aj (x0 , y0 , z0 ) , which can be obtained in the above ± chapter for different cases, and Bk are provided in (3.5),(3.7) in different cases. Now, we obtain the solution of system (4.9),

Theorem 4. The solution of system (4.9) can be expressed as
J1 J2 + - (-1)j -1 [gk,j (x, y, z, t) + gk,j (x, y, z, t)], k=0 j =1

u(x, y, z, t) =

(4.10)

where J1 , J2 are defined in (i)-(iv). The proof of the Theorem is in the Appendix.

50

4.2

Some Special Cases for i and i

In the previous section, Theorem 4 is not available for some extreme/special cases like, for example, i = 1 for some i. In this section, we shall consider some special cases for i and i , i = 1, 2, 3. The proofs are presented in the corresponding appendix. Theorem 5. 1). If 12 = 1, 13 = 23 = 0, and 1 = 2 =  , then we obtain p =
1 -x2 4m2 3 -4m3 x3  ( x ) - x3 - 3 t 2t 2 2 3   ]  ( )[1 - e 2 2 3 t 3 t

×e 2 x2 - 22 t [e-

2

2 2

(x1 +x2 )2 8 2 t

- e-

(x1 +x2 -4 max(m1 ,m2 ))2 8 2 t

].

(4.11)

2) . If 13 = 23 = 12 = 1, i = , i = 1, 2, 3, then we obtain that the density function can be expressed as, for mi /  max{mj /, mk / }, for i = j, k , and j = k, and i, j, k = 1, 2, or 3. p = exp(  2 xj xi xk xi x1 - 2 t) ( - ) ( - ) 2  2     2 1 x2 ( x - 2 m i i) × [exp(- i 2 ) - exp(- )]. 2t 2t 2 2t

(4.12)

3) . If 12 = 1, 13 = 23 = -1, i = 0, i = 1, 2, 3, then we obtain that the density function can be expressed as p =  [ - 1 x1 /1 - x2 /2 x1 /1 + x2 /2  ( ) ( + x3 /3 ) 2 4t 2 [exp(- (z2 - w2k )2 (z2 + w2k )2 ) - exp(- )] 4t 4t (4.13)

 k=0 

(z2 - w2k-1 )2 (z2 + w2k-1 )2 ) - exp(- )]], 4t 4t k=1   where z2 = 2(x3 /3 -m3 /3 ), z20 = - 2m3 / 3 , w2k = 2kr0 +z20 , w2k-1 = 2kr0 - z20 , r0 = 2 max(-m1 /1 , -m2 /2 ) - 2m3 /3 , k = 0, 1, 2, · · · . See figure 4.1 for wi . [exp(-

4.3

The Density Functions of the Minimum (or maximum) and Endpoints of Y (t)
1  =  12 13  12 1 0 51  13 0  1

We denote in this thesis,

(4.14)

2 a set of source in the plane 1.8 1.6 1.4 1.2 1 0.8 0.6 0.4 0.2 0 -4 -3 -2 -1 0 X 1 2 3 4 -w3 -w2 -w1 -w0 w0 w1 w2 w3 Y

Figure 4.1: The set of sources for solving equation (4.13) for some parameters

52

and  µ± k,j =  t  ± - zk,j  1 2 [x±  13 + ] + t1 a1 k,j 2  1-12 1-12 -2 13  - x± ±   12 12 13 zk,j  ± + yk,j + t2 a2 + ×  1-k,j 2 2 )(1-2 -2 ) (1 -   12 12 13 12 2 ±  zk,j 1-   2 12 + t3 a3 2
1-12 -13

    .   (4.15)

Then the inverse of  is   -1 =  

1 2 1-2 12 -13 -12 2 1-2 12 -13 -13 2 1-2 12 -13

-12 2 1-2 12 -13 1-2 13 2 1-2 12 -13 12 13 2 1-2 12 -13

-13 2 1-2 12 -13 12 13 2 1-2 12 -13 1-2 12 2 1-2 12 -13

  .  (4.16)

Theorems 6 to 9, given next, follow directly from results in Section 3.1 and  Theorem 4, we assume ( 12 , 13 )  H, J1 , J2 are as defined in Theorem 4. Theorem 6.
 1). If 12 =  12 , 13 = 13 , 23 = 0. Then we have for y1  m1 , y2  m2 , y3  m3 , where m1  0, m2  0, m3  0, the density function

p(y1 , y2 , y3 , t, m1 , m2 , m3 ) =

exp(a1 y1 + a2 y2 + a3 y3 + bt)
2 1 2 3 1 - 2 12 - 13 ×h(z1 , z2 , z3 , t, m1 , m2 , m3 ), (4.17)

where h is expressed as (4.10), by changing x, y, z to z1 , z2 , z3 and u to h, a1 , a2 , a3 , b are in (4.1)-(4.4). 2). For m1  0, m2  0, m3  0, letting A± k,j = exp[a1 m1 + a2 m2 + a3 m3 + bt +
-1 ± (µ± µk,j k,j )  2

-

± 2 1 2t ((xk,j )

± 2 ± 2 + (yk,j ) + (zk,j ) )], we have 0<s<t 0<s<t

P

( =

0<s<t J1

min Y1 (s) > m1 , min Y2 (s) > m2 , min Y3 (s) > m3 )
J2 + - - (-1)j -1 [A+ k,j (0, 0, 0, -µk,j , ) - Ak,j (0, 0, 0, -µk,j , )].

k=0 j =1

3). For M1  0, M2  0, M3  0, i = P (

2 i 2

- r, we have
0<s<t

Y1 (t)  dy1 , Y2 (t)  dy2 , Y3 (t)  dy3 , max Y1 (s) < M1 ,
0<s<t

max Y2 (s) < M2 , max Y3 (s) < M3 )
0<s<t

=

p(-y1 , -y2 , -y3 , t, -M1 , -M2 , -M3 )dy1 dy2 dy3 . 53

Moreover, letting A± k,j = exp[-a1 M1 - a2 M2 - a3 M3 + bt + ± 2 ± 2 ± 2 1 (( x ) + ( y ) + (zk,j ) )], we have k,j k,j 2t P ( =
k=0 j =1 0<s<t J1 0<s<t 0<s<t

-1 ± (µ± µk,j k,j )  2

-

max Y1 (s) < M1 , max Y2 (s) < M2 , max Y3 (s) < M3 )
J2 + - - (-1)j -1 [A+ k,j (0, 0, 0, -µk,j , ) - Ak,j (0, 0, 0, -µk,j , )].

 Theorem 7. If 12 = - 12 , 13 = -13 , 23 = 0.

1). For M1  0, m2  0, m3  0, 1 = have P (

2 1 2

- r, 2 = r -

2 2 2 , 3

=r-

2 3 2 ,

we

Y1 (t)  dy1 , Y2 (t)  dy2 , Y3 (t)  dy3 , max Y1 (s) < M1 ,
0<s<t 0<s<t

min Y2 (s) > m2 , min Y3 (s) > m3 )
0<s<t

= p(-y1 , y2 , y3 , t, -M1 , m2 , m3 )dy1 dy2 dy3 . Moreover, letting A± k,j = exp[-a1 M1 + a2 m2 + a3 m3 + bt + ± 2 ± 2 ± 2 1 2t ((xk,j ) + (yk,j ) + (zk,j ) )], we have P ( =
k=0 j =1 0<s<t J1 0<s<t 0<s<t
-1 ± µk,j (µ± k,j )  2

-

max Y1 (s) < M1 , min Y2 (s) > m2 , min Y3 (s) > m3 )
J2 + - - (-1)j -1 [A+ k,j (0, 0, 0, -µk,j , ) - Ak,j (0, 0, 0, -µk,j , )].

2). For m1  0, M2  0, M3  0, 1 = r - have P (

2 1 2 , 2

=

2 2 2

- r, 3 =

2 3 2

- r, we

Y1 (t)  dy1 , Y2 (t)  dy2 , Y3 (t)  dy3 , min Y1 (s) > m1 ,
0<s<t 0<s<t

max Y2 (s) < M2 , max Y3 (s) < M3 )
0<s<t

= p(y1 , -y2 , -y3 , t, M1 , -M2 , -M3 )dy1 dy2 dy3 . Moreover, letting A± k,j = exp[a1 m1 - a2 M2 - a3 M3 + bt + ± 2 ± 2 ± 2 1 2t ((xk,j ) + (yk,j ) + (zk,j ) )], we have P ( =
k=0 j =1 0<s<t J1 0<s<t 0<s<t
-1 ± µk,j (µ± k,j )  2

-

min Y1 (s) > m1 , max Y2 (s) < M2 , max Y3 (s) < M3 )
J2 + - - (-1)j -1 [A+ k,j (0, 0, 0, -µk,j , ) - Ak,j (0, 0, 0, -µk,j , )].

54

 Theorem 8. If 12 =  12 , 13 = -13 , 23 = 0.

1). For m1  0, m2  0, M3  0, 1 = r - have P (

2 1 2 , 2

=r-

2 2 2 , 3

=

2 3 2

- r, we

Y1 (t)  dy1 , Y2 (t)  dy2 , Y3 (t)  dy3 , min Y1 (s) > m1 ,
0<s<t 0<s<t

min Y2 (s) > m2 , max Y3 (s) < M3 )
0<s<t

=

p(y1 , y2 , -y3 , t, m1 , m2 , -M3 )dy1 dy2 dy3 .
-1 ± (µ± µk,j k,j )  2

Moreover, letting A± k,j = exp[a1 m1 + a2 m2 - a3 M3 + bt + ± 2 ± 2 ± 2 1 (( x ) + ( y ) + (zk,j ) )], we have k,j k,j 2t P ( =
k=0 j =1
2 1 2 2 2 2

-

0<s<t J1

min Y1 (s) > m1 , min Y2 (s) > m2 , max Y3 (s) < M3 )
0<s<t 0<s<t J2 + - - (-1)j -1 [A+ k,j (0, 0, 0, -µk,j , ) - Ak,j (0, 0, 0, -µk,j , )].

2). For M1  0, M2  0, m3  0, 1 = have P (

- r, 2 =

- r, 3 = r -

2 3 2 ,

we

Y1 (t)  dy1 , Y2 (t)  dy2 , Y3 (t)  dy3 , max Y1 (s) < M1 ,
0<s<t 0<s<t

max Y2 (s) < M2 , min Y3 (s) > m3 )
0<s<t

=

p(-y1 , -y2 , y3 , t, -M1 , -M2 , m3 )dy1 dy2 dy3 .
-1 ± µk,j (µ± k,j )  2

Moreover, letting A± k,j = exp[-a1 M1 - a2 M2 + a3 m3 + bt + ± 2 ± 2 ± 2 1 2t ((xk,j ) + (yk,j ) + (zk,j ) )], we have P ( =
k=0 j =1  Theorem 9. If 12 = - 12 , 13 = 13 , 23 = 0. 0<s<t J1 0<s<t 0<s<t

-

max Y1 (s) < M1 , max Y2 (s) < M2 , min Y3 (s) > m3 )
J2 + - - (-1)j -1 [A+ k,j (0, 0, 0, -µk,j , ) - Ak,j (0, 0, 0, -µk,j , )].

1). For M1  0, m2  0, M3  0, 1 = have P (

2 1 2

- r, 2 = r -

2 2 2 , 3

=

2 3 2

- r, we

Y1 (t)  dy1 , Y2 (t)  dy2 , Y3 (t)  dy3 , max Y1 (s) < M1 ,
0<s<t 0<s<t

min Y2 (s) > m2 , max Y3 (s) < M3 )
0<s<t

=

p(-y1 , y2 , -y3 , t, -M1 , m2 , -M3 )dy1 dy2 dy3 . 55

Moreover, letting A± k,j = exp[-a1 M1 + a2 m2 - a3 M3 + bt + ± 2 ± 2 ± 2 1 (( x ) + ( y ) + (zk,j ) )], we have k,j k,j 2t P ( =
k=0 j =1
2 1 2 , 2 2 2 2

-1 ± (µ± µk,j k,j )  2

-

0<s<t J1

max Y1 (s) < M1 , min Y2 (s) > m2 , max Y3 (s) < M3 )
0<s<t 0<s<t J2 + - - (-1)j -1 [A+ k,j (0, 0, 0, -µk,j , ) - Ak,j (0, 0, 0, -µk,j , )].

2). For m1  0, M2  0, m3  0, 1 = r - have P (

=

- r, 3 = r -

2 3 2 ,

we

Y1 (t)  dy1 , Y2 (t)  dy2 , Y3 (t)  dy3 , min Y1 (s) > m1 ,
0<s<t 0<s<t

max Y2 (s) < M2 , min Y3 (s) > m3 )
0<s<t

= p(y1 , -y2 , y3 , t, m1 , -M2 , m3 )dy1 dy2 dy3 . Moreover, letting A± k,j = exp[a1 m1 - a2 M2 + a3 m3 + bt + ± 2 ± 2 ± 2 1 2t ((xk,j ) + (yk,j ) + (zk,j ) )], we have P ( =
k=0 j =1 0<s<t J1 0<s<t 0<s<t
-1 ± µk,j (µ± k,j )  2

-

min Y1 (s) > m1 , max Y2 (s) < M2 , min Y3 (s) > m3 )
J2 + - - (-1)j -1 [A+ k,j (0, 0, 0, -µk,j , ) - Ak,j (0, 0, 0, -µk,j , )].

The proof of the above Theorems are in the Appendix. Remark 3. The matrix  is shared by all above cases. However, we must have different values of a1 , a2 , a3 , b and µ, since these parameters change according to the number of minimum and maximum

56

Chapter 5

Applications to Finance
We consider that stock prices are log-normally distributed, the interest rate is constant, and continuous trading without transaction costs, taxes, or other market frictions is permitted. There are four assets: one risk-fee bond and three risky stocks. The prices of the bond and stocks (So (t), S1 (t), S2 (t), S3 (t)) are determined by  So (t) = ert ,    Si (t)  Y (t) ), i = 1, 2, 3, = ln( S i i (0) (5.1) 2 i  DYi (t) = (r - 2 )dt + i dWi , i = 1, 2, 3,    (dW, dW ) = Rdt. Here R is the correlation. According to the Black-Scholes economy, the discounted contingent claim V (t) price V  (t) = S is a martingale, its values at date 0 can be determined by o (t) taking the conditional expectation of its terminal value V  (0) = E Q [V  (T )]. There are many types of derivatives that could be priced using this framework. We provide a list of possible payoffs along with a financial motivation. These payoff involve exactly three extrema. We select two examples, the Lookback Digital Option and the Lookback European Option, for which we provide all the required pricing computations in the next subsections. The same analysis could be performed for products with extrema in two underlyings and an endpoint on a third underlying, these examples are described in a second list. · Lookback Digital Option. This product gives one dollar if three different stock/indexes performed above a threshold (ai ). This gives protection against downward co-movement of, for example, three different sectors of the market that could be critical for a portfolio.
3

1{S i (T )>ai }
i=1

(5.2)

57

· Lookback European Option. This is a generalization of a Correlation Option (see Bakshi and Madan [2001]) to an option on the correlation matrix. This also allows for protection against downward co-movements of the underlyings due to its barrier component.
3 3

max{0, Si (T ) - Ki }
i=1 i=1

1{S i (t)>ai }

(5.3)

· Market Double Minima. This is a call or put on the difference between the minimum of S1 and the minimum of S2 given favorable market conditions as seen from S3 , an index, above a threshold: max{0, (a1 S1 (T ) - a2 S2 (T )) ± K } · 1S3 (T )>K3 . (5.4)

· Market Double Maxima. This is a call or put on the difference between the maximum of S1 and the maximum of S2 given favorable market conditions as seen from S3 : max{0, (a1 S1 (T ) - a2 S2 (T )) ± K } · 1S3 (T )>K3 (5.5)

· Market Double Lookback Spread. This is a call or put on the spread between the maximum S1 and the minimum of S2 given market conditions are favorable: max{0, (a1 S1 (T ) + a2 S2 (T ) + a3 S3 (T )) ± K }. (5.6)

· Triple Basket Minima. This is a call or put on a basket of minimum values for the underlying stocks, protecting against a worst case scenario for a real portfolio with weights ai : max{0, (a1 S1 (T ) + a2 S2 (T ) + a3 S3 (T )) ± K } (5.7)

· Triple Basket Maxima. This is a call or put on a basket of maximum values for the underlying stocks, protecting against a worst case scenario (short positions) for a real portfolio with weights ai : max{0, (a1 S1 (T ) + a2 S2 (T ) + a3 S3 (T )) ± K } 58 (5.8)

Examples of options attainable in closed-form using our methodology but with less than three extrema are: · Double lookback Options on three assets. A general payoff would be: f (S1 (T ), S2 (T ), S3 (T )) f (S1 (T ), S2 (T ), S3 (T )) (5.9) (5.10)

· Single lookback Options on three assets. A general payoff would be: f (S1 (T ), S2 (T ), S3 (T )) f (S1 (T ), S2 (T ), S3 (T )) (5.11) (5.12)

In general these types of options can be useful for investors with special investment needs. In this section we focus on two of those cases a Lookback European option and a Lookback Digital Call.

5.1

Lookback European Option

In this section, we shall consider the Lookback European call option
3 3

V =
i=1

max{0, Si (T ) - Ki }
i=1

1{S i (T )>exp(mi )} ,

(5.13)

where Si (T ) is the price of stock i at the expiration date T , Ki is the strick price of stock i at the expiration date, S i (t) = min0st Si (s), mi  0 is constant, 1(·) is indicator function. By Theorem 4.1, we know that the price at time 0 of the call is

C

= × ×

[ea1 x1 +a2 x2 +a3 x3 2 1 2 3 1 - 2 -  l l l 1 2 3 12 13 (S1 (0)ex1 - K1 )(S2 (0)ex2 - K2 )(S3 (0)ex3 - K3 )
s t

e(b-r)T







(5.14)

+ - (-1)j -1 (gk,j (z1 , z2 , z3 , T ) + gk,j (z1 , z2 , z3 , T ))]dx1 dx2 dx3 , k=0 j =1

where li = max{mi , ln(Ki /Si (0))}, the values of J1 , J2 depend on the corre59

lations 12 , 13 . They are defined in Theorem 4. Since
± gk,j

z1 z2 z3

±1 1 ± 2 ± 2 2 exp(- ((z1 - x± k,j ) + (z2 - yk,j ) + (z3 - zk,j ) )) 2T (2T )3/2 x1 - m1 12 x2 - m2 1 = - 2 2 1 2 1 - 12 1 - 12 x2 - m2 = 2 -13 x1 - m1 = 2 2 2 1 (1 - 12 )(1 - 12 - 13 ) 12 13 x2 - m2 + 2 2 2 (1 - 2 12 )(1 - 12 - 13 ) = + 1 - 2 12 1- 2 12 - 2 13 x3 - m3 3

± ± ± and (x± k,j , yk,j , zk,j ) = Bk Aj (z10 , z20 , z30 ) .

Letting x ^i = C = ×

xi -mi i

in (5.14), then by dropping off the hat of xi , we have e[a1 m1 +a2 m2 +a3 m3 +(b-r)T ]

l3 -m3 3

1 1-

l1 -m1 1

2 12

-


2 13

l2 -m2 2

[e(a1 1 x1 +a2 2 x2 +a3 3 x3 )

(5.15)

^1 (0)e1 x1 - K1 )(S ^2 (0)e2 x2 - K2 )(S ^3 (0)e3 x3 - K3 ) × (S
J1 J2 + - (-1)j -1 (gk,j (z1 , z2 , z3 , T ) + gk,j (z1 , z2 , z3 , T ))]dx1 dx2 dx3 , k=0 j =1

×

^i (0) = Si (0)emi , where S
± gk,j

z1 z2 z3

±1 1 ± 2 ± 2 2 exp(- ((z1 - x± k,j ) + (z2 - yk,j ) + (z3 - zk,j ) )) 3 / 2 2T (2T ) 1 12 = x1 - x2 2 1 - 12 1 - 2 12 = x2 -13 12 13 = x1 + x2 2 2 2 2 2 (1 - 12 )(1 - 12 - 13 ) (1 - 12 )(1 - 2 12 - 13 ) = + 1 - 2 12
2 1 - 2 12 - 13

x3

60

Since

± 2 ± 2 2 (z1 - x± k,j ) + (z2 - yk,j ) + (z3 - zk,j )

=

1 - 2 1 - 2 13 12 2 x2 2+ 2 2 2 x3 1- - 1 - 12 - 13 1 - 2 -  12 13 -213 -212 + 2 x1 x2 + 1 - 2 - 2 x1 x3 1 - 2 12 - 13 12 13 212 13 + 2 x2 x3 1 - 2 12 - 13 1 2 12 x2 1 2 13 + + +[ + 2 1 - 2 12 212 x± k,j 1 - 2 12 [-x± k,j +
± - 2yk,j + ± 13 zk,j 2 1 - 2 12 - 13

]x1 ]x2

± -212 13 zk,j 2 2 (1 - 2 12 )(1 - 12 - 13 )

± -2zk,j

1 - 2 12

2 1 - 2 12 - 13

x3

± 2 ± 2 2 +(x± k,j ) + (yk,j ) + (zk,j ) .

Let

^1 (0)e1 x1 - K1 )(S ^2 (0)e2 x2 - K2 )(S ^3 (0)e3 x3 - K3 ) ea1 1 x1 +a2 2 x2 +a3 3 x3 (S = I1 + I2 + I3 + I4 + I5 + I6 + I7 + I8

and

I1 I2 I3 I4 I5 I6 I7 I8

= = = = = = = =

^1 (0)S ^2 (0)S ^3 (0) exp((a1 + 1)1 x1 + (a2 + 1)2 x2 + (a3 + 1)3 x3 ) S ^1 (0)S ^2 (0)K3 exp((a1 + 1)1 x1 + (a2 + 1)2 x2 + a3 3 x3 ) -S ^1 (0)K2 S ^3 (0) exp((a1 + 1)1 x1 + a2 2 x2 + (a3 + 1)3 x3 ) -S ^2 (0)S ^3 (0) exp(a1 1 x1 + (a2 + 1)2 x2 + (a3 + 1)3 x3 ) -K1 S ^1 (0)K2 K3 exp((a1 + 1)1 x1 + a2 2 x2 + a3 3 x3 ) S ^2 (0)K3 exp(a1 1 x1 + (a2 + 1)2 x2 + a3 3 x3 ) K1 S ^3 (0) exp(a1 1 x1 + a2 2 x2 + (a3 + 1)3 x3 ) K1 K2 S -K1 K2 K3 exp(a1 1 x1 + a2 2 x2 + a3 3 x3 ). 61

We just calculate I1 g + . For other cases, we can do similarly.
± I1 gk,j

=

^1 (0)S ^2 (0)S ^3 (0) S 3 / (2T ) 2 1 1 1 - 2 1 - 2 13 12 2 × exp{- { x2 x2 1+ 2+ 2 2 2 2 2 x3 2T 1 - 12 - 13 1 - 12 - 13 1 - 2 -  12 13 -213 -212 + 2 x1 x2 + 1 - 2 - 2 x1 x3 1 - 2 12 - 13 12 13 212 13 + 2 x2 x3 1 - 2 12 - 13 ± -[ -[ -[ 2 1 - 2 12 1 - 2 12
± 2zk,j

(x± k,j +

± -13 zk,j 2 1 - 2 12 - 13

) + 2T 1 (a1 + 1)]x1 + 2T 2 (a2 + 1)]x2

-212 x± k,j

± + 2yk,j +

± 212 13 zk,j 2 2 (1 - 2 12 )(1 - 12 - 13 )

1 - 2 12

2 1 - 2 12 - 13

+ 2T 3 (a3 + 1)]x3

± 2 ± 2 2 +(x± k,j ) + (yk,j ) + (zk,j ) }}.

We denote

  -1 =  

1 2 1-2 12 -13 -12 2 1-2 12 -13 -13 2 1-2 12 -13

-12 2 1-2 12 -13 1-2 13 2 1-2 12 -13 12 13 2 1-2 12 -13

-13 2 1-2 12 -13 12 13 2 1-2 12 -13 1-2 12 2 1-2 12 -13

   

and let  µ± k,j,1  = T      
- zk,j 1  13 (x± ) + T 1 (a1 + 1) k,j + 2 1-2 1-2 12 12 -13 ± ± -12 xk,j 12 13 zk,j ±  2 + yk,j + T 2 (a2 + 2 1- (1- )(1-2 -2 )



±

   + 1)  .  



± zk,j

12

12

12

13

1-2 12

2 1-2 12 -13

+ T 3 (a3 + 1)
1 2 . 1-2 12 -13

It is easy to check that det(-1 ) =
± I1 gk,j

 We have, for X = (x1 , x2 , x3 ) / T

=

.

-1 ± ^1 (0)S ^2 (0)S ^3 (0) (µ± µk,j,1 S k,j,1 )  × exp( ) 3 / 2 2 (2T ) 1 ± 2 ± 2 )2 + (yk,j ) + (zk,j ) ]} × exp{- [(x± 2T k,j -1 (X - µ± (X - µ± k,j,1 )  k,j,1 ) × exp(- ) 2

62

Similarly, we have  µ± k,j,2  = T      



± -13 zk,j ± 1  ( x + ) + T 1 (a1 + 1) k,j 2 1-2 1-2 12 12 -13 ± ± 12 13 zk,j -12 xk,j ±  2 + yk,j + + T 2 (a2 2 1-  (1- )(1-2 -2 ) ± zk,j

   + 1)  ,  

12

12

12

13

 

1-2 12

2 1-2 12 -13

+ T 3 a3

µ± k,j,3

 = T 

     

-13 z ± ± 1 (xk,j +  2 k,j 2 ) + T 1 (a1 + 1) 2 1-12 1-12 -13 ± -12 x± 12 13 zk,j ±  k,j  + y + + T 2 a2 k,j 2 2 1-  (1- )(1-2 -2 )

    ,   





± zk,j

12

12

12

13

1-2 12

2 1-2 12 -13

+ T 3 (a3 + 1)
±

µ± k,j,4

 = T

     



- zk,j 1  13 (x± ) + T 1 a1 k,j + 2 1-2 1-2 12 12 -13 ± -12 x±   12 13 zk,j ±  k,j + yk,j + 1-2 (1-2 )(1-2 -2 ) z±

12

12

12

13

k,j 

1-2 12

2 1-2 12 -13

+ T 3 (a3 + 1)
±

  + T 2 (a2 + 1)  ,       ,      + T 2 (a2 + 1)  ,      + T 2 a2  ,      + T 2 a2  .  

 µ± k,j,5  = T  µ± k,j,6  = T            

-13 z ± 1 (xk,j +  2 k,j 2 ) + T 1 (a1 + 1) 1-2 1-12 -13 12 ± -12 x± 12 13 zk,j ±  k,j + T 2 a2 + yk,j +  2 2 1-  (1- )(1-2 -2 )





± zk,j

12

12

12

13

1-2 12

2 1-2 12 -13

+ T 3 a3
±



- zk,j 1  13 (x± ) + T 1 a1 k,j + 2 1-2 1-2 12 12 -13 ± -12 x±   12 13 zk,j ±  k,j + yk,j + 1-2 (1-2 )(1-2 -2 ) z±

12

12

12

13

k,j 

1-2 12

2 1-2 12 -13

+ T 3 a3
±

 µ± k,j,7  = T        µ± k,j,8  = T      

-13 z ± 1 (xk,j +  2 k,j 2 ) + T 1 a1 1-2 1-12 -13 12 ± -12 x± 12 13 zk,j ±  k,j + yk,j +  2 2 1-  (1- )(1-2 -2 )



k,j 

z±

12

12

12

13

1-2 12

2 1-2 12 -13

+ T 3 (a3 + 1)
±

-13 z ± 1 (xk,j +  2 k,j 2 ) + T 1 a1 1-2 1-12 -13 12 ± 12 13 zk,j -12 x± ± k,j  2 + yk,j +  2 1-  (1- )(1-2 -2 )





± zk,j

12

12

12

13

1-2 12

2 1-2 12 -13

+ T 3 a3 63

We also have, for X = (x1 , x2 , x3 ) , s = 1, 2 · · · 8
± Is gk,j (X ) = ± -1 (X - µ± (X - µ± C ± (k, j, s) k,j,s )  k,j,s ) ), exp( - 3 / 2 2 (2T )

where C (k, j, s) is constant. Moreover, ^1 (0)S ^2 (0)S ^3 (0) exp( C ± (k, j, 1) = S ^1 (0)S ^2 (0)K3 exp( C ± (k, j, 2) = -S ^1 (0)K2 S ^3 (0) exp( C ± (k, j, 3) = -S ^2 (0)S ^3 (0) exp( C ± (k, j, 4) = -K1 S ^1 (0)K2 K3 exp( C (k, j, 5) = S
± -1 ± (µ± µk,j,1 k,j,1 ) 

2

-

1 ± 2 ± 2 2 ((x± k,j ) +(yk,j ) +(zk,j ) )), 2T

-1 ± (µ± µk,j,2 k,j,2 ) 

2
-1 ± (µ± µk,j,3 k,j,3 ) 

- - -

1 ± 2 ± 2 2 ((x± k,j ) +(yk,j ) +(zk,j ) )), 2T 1 ± 2 ± 2 2 ((x± k,j ) +(yk,j ) +(zk,j ) )), 2T 1 ± 2 ± 2 2 ((x± k,j ) +(yk,j ) +(zk,j ) )), 2T

2
-1 ± (µ± µk,j,4 k,j,4 ) 

2 -1 µ± k,j,5 2 - - -

(µ± k,j,5 )

1 ± 2 ± 2 2 ((x± k,j ) +(yk,j ) +(zk,j ) )), 2T 1 ± 2 ± 2 2 ((x± k,j ) +(yk,j ) +(zk,j ) )), 2T 1 ± 2 ± 2 2 ((x± k,j ) +(yk,j ) +(zk,j ) )), 2T

^2 (0)K3 exp( C ± (k, j, 6) = K1 S ^3 (0) exp( C ± (k, j, 7) = K1 K2 S C ± (k, j, 8) = -K1 K2 K3 exp(

-1 ± (µ± µk,j,6 k,j,6 ) 

2
-1 ± (µ± µk,j,7 k,j,7 ) 

2 -1 µ± k,j,8 2

(µ± k,j,8 )

-

1 ± 2 ± 2 2 ((x± k,j ) +(yk,j ) +(zk,j ) )). 2T

[a1 m1 +a2 m2 +a3 m3 +(b-r )T ] ± Therefore, Denoting A± C (k, j, s), k,j,s = e 1 li = -  T max{0, ln(Ki /Si (0)) - mi }, we have
i

8

J1

J2 + - - (-1)j -1 [A+ k,j,s (l1 , l2 , l3 , -µk,j,s , )-Ak,j,s (l1 , l2 , l3 , -µk,j,s , )].

C=
s=1 k=0 j =1

The following theorem makes use of the notation introduced above.

Theorem 10. The value of European call (5.13) at 0 is
8 J1 J2 + - - (-1)j -1 [A+ k,j,s (l1 , l2 , l3 , -µk,j,s , )-Ak,j,s (l1 , l2 , l3 , -µk,j,s , )]. s=1 k=0 j =1

C=

(5.16) 64

There are two possible numerical ways of obtaining the solutions for a Lookback European option (as well as other options), one possibility is to setup the numerical solution of the PDE directly, the other possibility is by simulation. In the three dimensional context of the thesis, both approaches are time consuming. To obtain the solution by simulation, for example, the time that spent in a Monte Carlo simulation for the lookback European option was about 10 days. On the other hand, it takes less than 2 minutes by making use of the closed form solutions obtained in this thesis. In the following, we give some numerical solutions of (5.16). Let us assume 12 = 13 = - 1 2 , m1 = -0.1, m2 = -0.2, m3 = -0.3, r = 0, 1 = 2 = 3 = 2 , 1 = 2 = 3 = r - 1 /2; S1 = S2 = S3 = 100, K1 = K2 = K3 = K, T = 1, then we provide the next price using our formula. See table 5.1

 K 30 40 50 60 70 80 90 0.0001 3.4300×105 2.1600×105 1.2500×105 6.4000×104 2.7000×104 8.0000×103 1.0000×102 0.001 3.4300×105 2.1600×105 1.2500×105 6.4000×104 2.7000×104 7.9998×103 9.9990×102 0.01 3.4293×105 2.1594×105 1.2495×105 6.3960×104 2.6970×104 7.9800×103 9.9000×102 0.1 2.0999×105 1.3172×105 7.5711×104 3.8266×104 1.5681×104 4.2680×103 4.2376×102 0.2 4.4050×104 2.8173×104 1.6621×104 8.7166×103 3.7794×103 1.1454×103 1.8350×102

Table 5.1: Exact option values obtained using (5.16)

In the following, by choosing t = 1/30000, and M = 30000 paths, we give the simulation of equation (1.2) by Monte Carlo Method with same parameters as before. The tables show that the error from Monte Carlo is particularly large for large values of the volatility. See table 5.2

5.2

Digital Call
3 3

In this section, we will consider the Digital call option V =
i=1

1Si (t)>Ki
i=1

1S i >exp(mi ) .

(5.17)

65

 K 30 40 50 60 70 80 90 0.0001 3.43×105 2.160×105 1.25×105 6.4×104 2.7×104 8.0×103 1.0×103 0.001 3.4299×105 2.1599×105 1.25×105 6.4×104 2.7×104 8.0×103 1.0×103 0.01 3.4294×105 2.1594×105 1.2492×105 6.397×104 2.697×104 7.98×103 9.900×102 0.1 2.1143×105 1.3316×105 7.515×104 3.850×104 1.579×104 4.28×103 4.10×102 0.2 4.616×104 2.998×104 1.762×104 8.76×103 3.89×103 1.118×103 1.8×102

Table 5.2: The prices of Monte Carlo Simulation

The approach is very similar to that in Section 5.1. Letting li = max{mi , ln(Ki /Si (0))}, we have that the the value of the call at time 0 is C=
(b-r )T e  2 1 2 3 1-2 12 -13

   l1 l2 l3

s k=0

t a1 x1 +a2 x2 +a3 x3 j =1 [e

+ - ×(-1)j -1 (gk,j (z1 , z2 , z3 , T ) + gk,j (z1 , z2 , z3 , T ))]dx1 dx2 dx3 .

the values of J1 , J2 depend on the correlations 12 , 13 .
[a1 m1 +a2 m2 +a3 m3 +(b-r )T ] ± Let A± C (k, j ), where k,j = e

C ± (k, j ) = exp(  µ± k,j  = T      

1 ± 2 ± 2 2 ((x± k,j ) + (yk,j ) + (zk,j ) )), 2T  ± -13 zk,j  1 2 (x±  + ) + T  a 1 1 k,j 2  1-12 1-2 12 -13  ± -12 x± 12 13 zk,j ± k,j  2 + yk,j +  + T 2 a2  . 2 2 2 1-12 (1-12 )(1-12 -13 )   2 ±  zk,j 1-12  2 2 + T 3 a3 2 -
1-12 -13

-1 ± (µ± µk,j k,j ) 

We have the following Theorem
1 Theorem 11. Let li = -   max{0, ln(Ki /Si (0)) - mi }. The vale of Digital i T call at time 0 is J1 J2 + - - (-1)j -1 [A+ k,j (l1 , l2 , l3 , -µk,j , ) - Ak,j (l1 , l2 , l3 , -µk,j , )]. k=0 j =1

C=

(5.18) In the following, we give some numerical solutions of (5.18). By letting 12 = 13 = - 1 2 , m1 = -0.1, m2 = -0.2, m3 = -0.3, r = 0, 1 = 2 = 3 = , 1 = 66

2 2 = 3 = r - 1 /2; S1 = S2 = S3 = 100, K1 = K2 = K3 = K, T = 1,then we have

 K 30 40 50 60 70 80 90 0.05 9.5211×10-1 9.5211×10-1 9.5211×10-1 9.5211×10-1 9.5211×10-1 9.5210×10-1 9.1524×10-1 0.1 6.1690×10-1 6.1690×10-1 6.1690×10-1 6.1690×10-1 6.1690×10-1 6.0658×10-1 4.1073×10-1 0.15 2.9205×10-1 2.9205×10-1 2.9205×10-1 2.9205×10-1 2.9205×10-1 2.7463×10-1 1.5737×10-1 0.2 1.1317×10-1 1.1317×10-1 1.1317×10-1 1.1317×10-1 1.1317×10-1 1.0525×10-1 6.1577×10-2

Table 5.3: The prices of digital call by (5.18)

67

Chapter 6

Solution for Random Correlation
Correlations are known to be stochastic for financial products (see Engle [2002]). Our framework can be easily adjusted to the case of random correlations. In this section we consider that the correlation matrix associated to the process St , which we will denote by R, is a random correlation matrix. We suppose that R = (ij )3×3 and ii = 1, ij = ji , -1  ij  1. Therefore, it is enough to consider a three dimensional random correlation vector  = (12 , 13 , 23 ) instead of the full matrix R. We will refer to a random vector  or to its associated matrix interchangeably. These random correlation vectors will take values in the set of correlations considered in previous sections of the thesis, these latter correlations provide solvable joint densities/distibutions, this fact is crucial for the developments in this section. Such correlation matrices R will be called admissible. The solutions for random correlations are presented for two broad cases, the case of three minima or three maxima (which will correspond to negative correlations) and that of mixing extrema (which will correspond to positive and negative correlations). In either case, the convex hull generated by the set of solvable correlations will be described; it can be interpreted as the set of possible correlation matrices resulting from taking an expected value of an admissible random correlation matrix R.

6.1

The cases of minimum or maximum

In previous sections we have obtained the density functions for the minimum and endpoints of Y (t) for some special correlations. Similar results can be obtained for the case of maximum and endpoints of Y (t). Let us first define the set of all 68

possible solvable correlations F : F1 = { 1 1 1 (- cos (/5), - , 0), (- cos (/5), 0, - ), (0, - cos (/5), - ), 2 2 2 1 1 1 (- , - cos(/5), 0), (- , 0, - cos(/5)), (0, - , - cos(/5))}, 2 2 2 { (0, 0, 0), (- cos (/n), 0, 0), (0, - cos (/n), 0), (0, 0, - cos (/n)), for n  3} 1 1 1 (- cos (/4), - , 0), (- cos (/4), 0, - ), (0, - cos (/4), - ), 2 2 2 1 1 1 (- , - cos(/4), 0), (- , 0, - cos(/4)), (0, - , - cos(/4))} 2 2 2

F2 =

F3 = {

1 1 1 1 1 1 F4 = {(- , - , 0), (- , 0, - ), (0, - , - )} 2 2 2 2 2 2 Consider the usual process, dYi = i dt + i dWi , dWi (t), dWj (t) = ij dt, i = j. (6.1)

In order to simplify the notation consider: Y  (Y1 , Y2 , Y3 ), dy  (dy1 , dy2 , dy3 ), m  (m1 , m2 , m3 ), mi < 0, y = (y1 , y2 , y3 ) and Mi > 0. From the results in the previous sections, for any vector   F = F1  F2  F3  F4 , we can obtain the joint density/distribution functions by switching the coordinates y1 , y2 and y3 , p(Y (t)  dy & Y (t) > m), or p(Y (t)  dy & Y (t) < M ), where the last density/distribution can be obtained by considering the process ^i  -Yi with  Y ^ i  -i . Remark 4. The density implied from the correlations (11 , 12 , 13 ) = (-1, 0, 0), (0, -1, 0) and (0, 0, -1) can be approximated by the density of the correlation (- cos(/n), 0, 0), (0, - cos(/n), 0) and (0, 0, - cos(/n)) respectively, for n large enough. Definition 1. Elements   F will be called admissible correlation vectors. Given a discrete probability space with probabilities pn , define, on such a space, an admissible random correlation matrix R = (ij ) to be a matrix-valued random variable on this space such that   (12 , 13 , 23 ) is admissible. Theorem 12 shows that, by making use of our knowledge of the density/distribution function for any correlation in F , we can calculate the value of any option depending on a random correlation taking values on the set F . More formally, we assume that the model (6.1) holds conditionally on the outcome of a given admissible random correlation R. 69

0

-0.2

-0.4

-0.6

-0.8 -0.5 -0.8 -0.6 -0.4 -0.2 0 -1

0

-1 -1

^ Figure 6.1: The picture of convexhull of set F
2 Theorem 12. Consider the process (6.1) with i = r - i /2 conditioned on the outcome of an admissible random correlation vector n . In particular, n  F with associated known probability pn . Then, the value of any option is given as a weighted sum: 

V  (0) =
n=1

pn e-rT E Q [V  (T )| = n ].

(6.2)

Proof. A direct conditional expectation computation gives:
P [E Q (V  (T ))] = V  (0) = e-rT E Q (V  (T )) = e-rT ER N N

e-rT
n=1

pn E Q [V  (T )| = n ] =
i=1

pn e-rT E Q [V (T )| = n ].

The convex hull of F can be characterized as the set of all of the convex combinations of finite subsets of points from F : that is, the set of points of n the form j =1 tj xj , where n is an arbitrary natural number, the numbers tj are non-negative and sum to 1, and the points xj are in F . So the convex hull Hconvex (F ) of set F is:
n n

Hconvex (F ) = {
j

j j : j  0,
j =1

 j = 1 ,  j  F }.

If we denote ^= F { 1 1 1 (- cos(/5), - , 0), (- cos(/5), 0, - ), (0, - cos(/5), - ) 2 2 2 1 1 (- , - cos(/5), 0), (0, - , - cos(/5)), (-1/2, 0, - cos(/5)) 2 2 (0, 0, 0), (-1, 0, 0), (0, -1, 0), (0, 0, -1)}, 70

1 0.8 0.6 0.4 0.2 0 -0.2 -0.4 -0.6 -0.8 -1 1

0.5

0

-0.5

-1

-1

-0.5

0

0.5

1

¯ Figure 6.2: The picture of convexhull of set F ^ ). For exIt is easy to check that, for all   F , then we have   Hconvex (F 1 1 1 , -1 , 0) =  ( - 1 , 0 , 0) +  (0 , - 1 , 0) and ( - cos( / 4) , -1 ample, (- 2 2 2 2 4 , 0) = 2 cos(/4)-1 1 a  (- cos(/5), - 2 , 0) + b  (-1, 0, 0) + b  (0, -1, 0), where a = 2 cos(/5)-1 , b = cos(/5)-cos(/4) ^ ). If R is a random correlation . Hence Hconvex (F )  Hconvex (F
o o o ^ matrix, and E (R) = Ro = (o ij )3×3 , o = (12 , 13 , 23 ) lies in Hconvex (F ). By Caratheodary's Theorem, there exist at most 4 elements, denoted by 1 , 2 , 3 , 4 , ^ , such that in F 4 2 cos(/5)-1

o = 1 1 + 2 2 + 3 3 + 4 4 ,
i=1

 i = 1 ,  i  0.

Therefore, we have the following theorem. Theorem 13. Assume that the random correlation matrix R with E (R) = Ro = o o o ^ (o ij ), o = (12 , 13 , 23 ), which lies in Hconvex (F ). Then there exist at most 4 ^ such that elements, denoted by 1 , 2 , 3 , 4 , in F
4

o = 1 1 + 2 2 + 3 3 + 4 4 ,
i=1

 i = 1 ,  i  0.

In the following, we will consider a special case 1 = 2 = 3 . We find that the convex hull becomes much larger, since we can obtain the density functions for 12 = 13 = 23 = 1, and 12 = 1, 13 = 23 = 0 see Section 4.3. By switching the coordinates y1 , y2 and y3 , we can obtain the density functions for correlations (0, 1, 0) and (0, 0, 1). It is interesting to remark that if we consider the special case 1 = 2 = 3 then, the convex hull becomes larger. To show this, we note that under this condition, it can be seen that one can obtain the density functions for the cases 71

12 = 13 = 23 = 1, and 12 = 1, 13 = 23 = 0. Therefore the convex hull of ¯ , where the set F ¯=F ^  {(1, 1, 1), (1, 0, 0), (0, 1, 0), (0, 0, 1)}, F would be bigger allowing for more positive average correlation matrices Ro = ^ ) and Hconvex (F ¯ ); E (R), Figure 6.1 displays Hconvex (F For 1 = 2 = 3 =  , the above Theorems allow us to compute the values of options for some positive correlations of the cases of minimum and endpoints ¯ ). (or maximum and endpoints) of Y (t) (see the convex hull of set F

6.2

The Mixing cases

In the following, we will consider the mixing case. for simplicity we will mostly restrict to the case of one maximum and two minima, for M1 > 0, m2 < 0, m3 < ^1 (t) = -Y1 (t),  0, the density function p can be obtained, by using Y ^1 = ^1 =  -1 , dY ^ 1 dt + 1  (-dw1 ), P (Y1 (t)  dy1 , Y2 (t)  dy2 , Y3 (t)  dy3 , max Y1 (s) < M1 ,
0<s<t 0<s<t

min Y2 (s) > m2 , min Y3 (s) > m3 )
0<s<t 0<s<t

=

^1 (s) > -M1 , ^1 (t)  dy1 , Y2 (t)  dy2 , Y3 (t)  dy3 , min Y P (Y
0<s<t

min Y2 (s) > m2 , min Y3 (s) > m3 )
0<s<t

=

p (y1 , y2 , y3 , -M1 , m2 , m3 , t) dy1 dy2 dy3 .

Analogously to the previous section, we introduce: H1 = { 1 1 1 (cos(/5), , 0), (cos(/5), 0, - ), (0, cos(/5), - ), 2 2 2 1 1 1 ( , cos(/5), 0), ( , 0, - cos(/5)), (0, , - cos(/5))} 2 2 2

H2 = {

(0, 0, 0), (cos(/n), 0, 0), (0, cos(/n), 0), (0, 0, - cos(/n)), for n  3)} { 1 1 1 (cos(/4), , 0), (cos(/4), 0, - ), (0, cos(/4), - ), 2 2 2 1 1 1 ( , cos(/4), 0), ( , 0, - cos(/4)), (0, , - cos(/4))} 2 2 2 1 1 1 1 1 1 H4 = {( , , 0), ( , 0, - ), (0, , - )}. 2 2 2 2 2 2 72

H3 =

0

-0.2

-0.4

-0.6 0 0.5 -1 1 0.8 0.6 0.4 1

-0.8

0.2

0

^ Figure 6.3: The picture of convexhull of set H For any correlation   H = H1  H2  H3  H4 , we can obtain the density functions p (y1 , y2 , y3 , t, -M1 , m2 , m3 ) dy1 dy2 dy3 . We also can show that any ^ ),where point   H , then   Hconvex (H ^ = H { 1 1 1 (cos(/5), , 0), (cos(/5), 0, - ), (0, cos(/5), - ) 2 2 2 1 1 ( , cos(/5), 0), (0, , - cos(/5)), (1/2, 0, - cos(/5)) 2 2 (0, 0, 0), (1, 0, 0), (0, 1, 0), (0, 0, -1)}.

The approach is similar to Theorems 6.1 and 6.2 that we can calculate the values of some call options by using these densities for some correlations (some ^ ). components are positive) lie in Hconvex (H For the case of 1 = 2 = 3 =  , we make use of Lemma 6.1, we have ¯ =H ^  {(-1, -1, 1), (-1, 0, 0), (0, -1, 0), (0, 0, 1)} H ¯ ) is much larger that Hconvex (H ^ ). It is easy to see that Hconvex (H Similarly, we can deal with the other mixed cases. For example, letting ^i (t) = -Yi (t),  ^i =  Y ^ i = -i , dY ^ dt + i  (-dWi ), i = 1, 2, we can obtain the density functions for some correlation (with positive components) P (Y1 (t)  dy1 , Y2 (t)  dy2 , Y3 (t)  dy3 , max Y1 (s) < M1 ,
0<s<t 0<s<t

max Y2 (s) < M2 , min Y3 (s) > m3 )
0<s<t 0<s<t

^1 (t)  dy1 , Y ^2 (t)  dy2 , Y3 (t)  dy3 , min Y ^1 (s) > -M1 , = P (Y
0<s<t

^2 (s) > -M2 , min Y3 (s) > m3 ) min Y
0<s<t

= p (y1 , y2 , y3 , -M1 , -M2 , m3 , t) dy1 dy2 dy3 , 73

1

0.5

0

-0.5 -1 -1 1 0 0.5 0 -0.5 -1 1

¯ Figure 6.4: The picture of convexhull of set H  K 30 40 50 60 70 80 90 100 110 0.05 9.5211×10-1 9.5211×10-1 9.5211×10-1 9.5211×10-1 9.5211×10-1 9.5210×10-1 9.1537×10-1 2.2495×10-1 7.8233×10-13 0.1 6.1517×10-1 6.1517×10-1 6.1517×10-1 6.1517×10-1 6.1517×10-1 6.0538×10-1 4.0806×10-1 1.7553×10-2 3.2751×10-6 0.15 2.7576×10-1 2.7576×10-1 2.7576×10-1 2.7576×10-1 2.7576×10-1 2.5987×10-1 1.4369×10-1 1.1326×10-2 7.3710×10-5 0.2 9.1287×10-2 9.1287×10-2 9.1287×10-2 9.1287×10-2 9.1287×10-2 8.4791×10-2 4.6725×10-2 6.4734×10-3 2.0401×10-4

Table 6.1: The prices of mixed digital call

and obtain the similar convex hull. We just remark that the same previous developments, for convex hulls and pricing of derivatives under a random correlation matrix, can be done for the density/distribution. In table 6.1, we give some numerical solutions of (6.2), By letting p1 =  2 1 1 1/3, p2 = 1/4, p3 = 1/4, p4 = 1/6, 1 = (- 2 , - 2 , 0), 2 = (- 2 , - 1 2 , 0), 3 = (- cos(/5), - 1 , 0) ,  = ( - cos( / 8) , 0 , 0) , m = - 0 . 1 , m = - 0 . 2 , m = -0.3, r = 4 1 2 3 2 2 0, 1 = 2 = 3 = , 1 = 2 = 3 = r - 1 /2; S1 = S2 = S3 = 100, K1 = K2 = K3 = K, T = 1.

74

Chapter 7

Appendixes
7.1 Appendix for Chapter 2

The Proof of Theorem 3. The solution obtained by Theorem 1.1, for general  (see page 225 of [7]), is


H (r, , t) =
0

2 t n 2 no e- 2 sin( ) sin( )J n (ro )J n (r)d,    n=1  



Letting  = H (r, , t)

 mo , mo 

 N , we have
2 t 2mo  e- 2 sin(nmo ) sin(nmo o )Jnmo (ro )Jnmo (r)d  n=1 2 t mo  e- 2 cos(nmo (o - ))Jnmo (ro )Jnmo (r)d  n=1



=
0 



=
0



-
0

2 t mo  e- 2 cos(nmo ( + o ))Jnmo (ro )Jnmo (r)d  n=1



By additional Theorem, we have


Jo ( Hence

x2

+

y2

- 2xy cos ) = Jo (x)Jo (y ) + 2
n=1

Jn (x)Jn (y ) cos(n).

Jn (x)Jn (y ) = and

1  1 



Jo (
0

x2 + y 2 - 2xy cos ) cos(n)d,



Jnmo (x)Jnmo (y ) =

Jo (
0

x2 + y 2 - 2xy cos ) cos(nm0 )d. 75

Since
 0

e-p

2 2

t

J (at)t +1 dt =

a a2 exp( - ), (2p2 ) +1 4p2

we have
 0

e-

2 t 2

Jo (

2 - 2rr cos )d = r 2 + ro o

2 r2 + ro - 2rro cos  1 exp(- ). t 2t

Letting

2 t mo  e- 2 cos(nmo )Jnmo (ro )Jnmo (r)d,  n=1



h1 (r, , t) =
0

then we have h1 (r, , t)


=
0 

mo   2 n=1
 0 



 0

e-

2 t 2

cos(nmo )Jo ( x2 + y 2 - 2xy cos ) cos(nm0 )dd


=
0

mo  - 2 t e 2 Jo ( x2 + y 2 - 2xy cos )[ cos(nmo ) cos(nmo )]dd 2 n=1


=

mo  2 t n=1

exp(-
0

2 r2 + ro - 2rro cos  ) cos(nmo )d · cos(nmo ). 2t

Denoting fk (x) = exp(-

2 k r 2 +ro -2rro cos( 2 mo +x) ), 2t

by Fourier Transform, we have


ao k) k) fk (x) = + a( b( n cos(nx) + n sin(nx), 2 n=1 n=1 where
k) a( n =

(k)



1 



exp(-
-

k 2 r2 + ro - 2rro cos( 2 mo + x )

2t

) cos(nx)dx, n = 0, 1, 2, · · · ,

and
k) b( n

1 = 



exp(-
-

k 2 r2 + ro - 2rro cos( 2 mo + x )

2t 76

) sin(nx)dx, n = 1, 2, · · · .

Now, we consider
k) a( n

= = =

1  1  1 



exp(-
-
k + 2 mo k - + 2 mo k + 2 mo k - + 2 mo

k 2 r2 + ro - 2rro cos( 2 mo + x )

2t

) cos(nx)dx

exp(- exp(-

2 r 2 + ro - 2rro cos(y ) 2k ) cos(n(y - ))dy 2t mo 2 2k r 2 + ro - 2rro cos(y ) )[cos(ny ) cos( ) 2t mo

+ sin(ny ) sin( =

2k )]dy mo 2 1  r2 + ro - 2rro cos(y ) 2k ) cos(ny ) cos( exp(- )dy  - 2t mo 1 


+ = and
k) b( n

exp(-
- 

2 r 2 + ro - 2rro cos(y ) 2k ) sin(ny ) sin( )dy 2t mo

1 

exp(-
-

2 r2 + ro - 2rro cos(y ) 2k ) cos(ny ) cos( )dy, 2t mo

= = =

1  1  1 



exp(-
-
k + 2 mo k - + 2 mo k + 2 mo k - + 2 mo

k 2 - 2rro cos( 2 r 2 + ro mo + x)

2t

) sin(nx)dx

exp(- exp(-

2 r 2 + ro - 2rro cos(y ) 2k ) sin(n(y - ))dy 2t mo 2 - 2rro cos(y ) r 2 + ro 2k )[sin(ny ) cos( ) 2t mo

- cos(ny ) sin( =

2k )]dy mo 2 1  r 2 + ro - 2rro cos(y ) 2k exp(- ) sin(ny ) cos( )dy  - 2t mo 1 


-

exp(-
- 

2 r2 + ro - 2rro cos(y ) 2k ) cos(ny ) sin( )dy 2t mo 2 r2 + ro - 2rro cos(y ) 2k ) cos(ny ) sin( )dy. 2t mo

1 = -  We consider
mo -1 k) a( n = k=0

exp(-
-

1 



exp(-
-

2 r2 + ro - 2rro cos y ) cos(ny )dy 2t mo -1 k=0 kn cos( 2m ) = mo . o

mo -1

cos(
k=0

2kn ). mo

If n = smo , s  N , we have

77

If n = smo + d, 1  d  mo - 1, then we have
mo -1

cos(
k=0

2kn ) mo

= =

n sin m o 3n n 1 n 5n 3n {sin + [sin - sin + sin - sin + ··· mo 2 mo mo mo mo (2mo - 3)n n (2mo - 1)n + sin - sin ]}/ sin mo mo mo (2mo -1)n n n sin m +1 ] 2 [- sin mo + sin mo o n sin m o

2(mo -1)n n n n n 4n n sin m + sin m cos 2 mo + sin mo cos mo + · · · + sin mo cos mo o o

= =

0.

Similarly,
k=mo -1 k) b( n = k=0

1 



exp(-
-

2 r2 + ro - 2rro cos y ) cos(ny )dy 2t

mo -1

sin(
k=0

2kn ). mo

o kn If n = smo , s  N , we have k=0 sin( 2m ) = 0. o If n = smo + d, 1  d  mo - 1, then we have

m -1

mo -1

sin(
k=0

2kn ) mo

= =

n sin m o 1 n 3n 3n 5n [cos - cos + cos - cos + ··· 2 mo mo mo mo (2mo - 3)n (2mo - 1)n n + cos - cos ]/ sin mo mo mo 1 n 2 [cos mo -1)n - cos (2mo ] mo n sin m o

2(mo -1)n n n n 4n n sin m sin 2 mo + sin mo sin mo + · · · + sin mo sin mo o

= =

0.
mo -1 (k) k=0 bn

Therefore, we obtain that
mo -1 k) a( n = k=0 2m o   0

= 0, for all n = 1, 2, · · · ; and if n = smo , s  N, otherwise .

exp(-

0,

2 r 2 +ro -2rro cos(y ) ) cos(ny )dy, 2t

78

Hence,
mo -1

fk (x)
k=0

=

mo 




exp(-
0

2 r 2 + ro - 2rro cos(y ) )dy 2t

+

2mo  n=1



exp(-
0

2 r2 + ro - 2rro cos(y ) ) cos(nmo y )dy · cos(nmo x) 2t

Letting x = o -  and x =  + o respectively, we have
mo -1

fk (o - )
k=0

=

mo 




exp(-
0

2 - 2rro cos(y ) r2 + ro )dy 2t

+ and

2mo  n=1



exp(-
0

2 r 2 + ro - 2rro cos(y ) ) cos(nmo y )dy · cos(nmo (o - )), 2t

mo -1

fk ( + o )
k=0

=

mo 




exp(-
0

2 r2 + ro - 2rro cos(y ) )dy 2t

+

2mo  n=1



exp(-
0

2 r 2 + ro - 2rro cos(y ) ) cos(nmo y )dy · cos(nmo ( + o )). 2t

Therefore, we have H (r, , t) = Which ends our proof. 1 2t
mo - 1

[fk (o - ) - fk ( + o )].
k=0

7.2

Appendix for Chapter 3

The Proof of Lemma 1 In fact the length of the curve is
0

dl =
l 0

2 2 x2  + y + z d.

79

Since x2 
2 y 2 z

=

2 sin2 () sin2 () + cos2 () cos2 () ·  - 2 sin() cos() sin() cos() ·  ,

2 = cos2 () sin2 () + sin2 () cos2 () ·  + 2 sin() cos() sin() cos() ·  , 2 = sin2  ·  .

Hence, dl =
l 0

0

2 d. sin2 () + 

Since cos() = a sin() cos() + b sin() sin(), we have sin2 () = 1 ,  = sin2 ()[a sin() - b cos()]. 1 + (a cos() + b sin())2 

Therefore, we obtain
0

dl =
l 0

1 + a2 + b2 d. 1 + (a cos() + b sin())2 =
 a , a2 +b2 0

(7.1)

Letting sin( ) =

 b , cos( ) a2 +b2

then we have

dl =
l

1 + a2 + b2
0

d . 1 + (a2 + b2 ) cos2 ( -  )
1 1+t2 ,

Letting t = tan( -  ), then we have d =

and

tan(0 -  ) tan( ) dl = arctan  + arctan  . 2 2 1+a +b 1 + a2 + b2 l To obtain (3.2), we continue (7.1), by letting sin( ) =
 b , a2 +b2  a , cos( ) a2 +b2

=

then we have
0

dl =
l

1 + a2 + b2
0

d . 1 + (a2 + b2 ) sin2 ( +  )
1 1+t2 ,

Letting t = tan( +  ), then we have d = dl = arctan(
l

and 1 + a2 + b2 tan( )).

1 + a2 + b2 tan(0 +  )) - arctan(

The Proof of Lemma 2. First, we can obtain easily that the normal vector of z = ax + by is n = 0 -ax0 -by0 . (a, b, -1). And the distance from (x0 , y0 , z0 ) to z = ax + by is d = z 1+a2 +b2 80

Hence, the symmetric point of (xs , ys , zs ) of (x0 , y0 , z0 ) with respect to z = ax + by is (xs , ys , zs ) = (x0 , y0 , z0 ) + k (a, b, -1),  0 -ax0 -by0 )  where k satisfies k a2 + b2 + 1 = 2d = 2(z . Hence, we have 1+a2 +b2 xs ys zs = = = -2ab 2a -a2 + b2 + 1 x0 + 2 y0 + 2 z0 a2 + b2 + 1 a + b2 + 1 a + b2 + 1 -2ab a2 - b2 + 1 2b x0 + 2 y0 + 2 z0 2 2 2 a +b +1 a +b +1 a + b2 + 1 2a 2b a2 + b2 - 1 x + y + z0 . 0 0 a2 + b2 + 1 a2 + b2 + 1 a2 + b2 + 1

The Proof of Lemma 3 (2t-1) + (i).For t = 1, 2, · · · , N ,we suppose that yt )x+ -1 < tan( t-1 . Then we N (2t-1) have the normal of the plane n = {- tan( N ), 1, 0}. Hence the symmetric (2t-1) + + + point of (x+ )x is t-1 , yt-1 , zt-1 )  Ds with respect to y = tan( N
+ + x, y (^ ^, z ^) = (x+ t-1 , yt-1 , zt-1 ) + k (- tan(

(2t - 1) ), 1, 0), N

Where k =

2(tan(

(2t-1) + )x+ t-1 -yt-1 ) N (2 t - 1)  1+tan2 ( ) N

. Therefore,

x ^ = y ^ = z ^ = Hence, we have x ^ y ^ and x ^ y ^  

2(2t - 1) + 2(2t - 1) + )xt-1 + sin( )yt-1 N N 2(2t - 1) + 2(2t - 1) + sin( )xt-1 - cos( )yt-1 N N + + zt -1 = z 0 . cos(  -1) sin( 2(2tN ) -1)  · - cos( 2(2tN )

-1) ) cos( 2(2tN =  sin( 2(2t-1) ) N

x+ t-1 + yt -1

,

-1) ) cos( 2(2tN 2(2 t - 1) =  sin( ) N



 -1) sin( 2(2tN ) -1)  - cos( 2(2tN ) x+ 0 + y0

1) cos( 2(t- ) N 2( t - 1)  ·  sin( ) N

1)  - sin( 2(t- ) N 2(t-1) cos( N )  ·

.

So we reach the conclusion that,     +   -  t t xt x0 x ^ cos( 2N ) sin( 2N ) 0 -  +  t t  y ^  =  sin( 2N ) - cos( 2N ) 0   y0 =  yt . + - z ^ 0 0 1 z0 zt 81

(2t-1) + It is very similar to prove the case of yt )x+ -1 > tan( t- 1 . N + t (ii).For t = 0, 1 · · · , N - 1, and yt < tan( 2N )x+ t . Then we have the normal + + 2t of the plane n = {- tan( N ), 1, 0}. Hence the symmetric point of (x+ t , yt , z t )  + 2t Dt with respect to y = tan( N )x is + + (^ x, y ^, z ^) = (x+ t , yt , zt ) + k (- tan(
+ t )x+ 2(tan( 2N t -yt ) . t 1+tan2 ( 2N )

2t ), 1, 0), N

Where k =

Therefore,

x ^ = cos(

4t + 4t + )xt + sin( )y N N t 4t + 4t + )xt - cos( )y y ^ = sin( N N t + + . z ^ = zt = z0   t sin( 4N ) t  - cos( 4N )

Hence, we have x ^ y ^ and x ^ y ^
t cos( 4N ) 4 t =  sin( N ) t ) cos( 4N 4t  sin( N ) =

x+ t + yt

,



  t t t sin( 4N ) cos( 2N ) - sin( 2N ) t   t t - cos( 4N ) sin( 2N ) cos( 2N ) 

x+ 0 + y0

.

Hence, by substituting s = N - t, we arrive    t t x ^ ) sin( 2N ) cos( 2N 2t t  y   ^ sin( N ) - cos( 2N ) = z ^ 0 0

at:  +   -  x0 xt 0 +  -  0   y0 =  yt . + - 1 z0 zt

+ t It is very similar to prove the case of yt > tan( 2N )x+ t .

The Proof of Lemma 4 We just check that 2 =  - .
 Since   (0,  2 ),   (0, 2 ), so we just need to check

1 cos(2 ) = cos( - ) = - . 3 Since 1 1 cos(2 ) = 2 cos2 ( ) - 1 = 2 - 1 = - . 3 3 82

Which means  + 2 =  . The Proof of Lemma 5. By Remark 1.2, it follows that the length of arcs P A, AB, BD and DQ is  and the length of arcs P B and CQ is .  (i).Since the plane OAB is z = 22 x, by taking a = 22 , b = 0 in Lemma 1.1,  tan(  ) the length of arc AB is arctan(  33 ) = arctan( 2) =  .
2

(ii). Since the plane of OBC is z = - 42 x + 46 y , by taking a = - the length of arc BC is   2 2 arctan( ) = arctan(2 2) = . 2 (iii). Since the plane of OCD is z = -  - 46 , the length of arc CD is
 2 4 x





 2 4 ,b

=

 6 4 ,

-

 6 4 y,

by taking a = -



2 4 ,b

=

 arctan( 2) = .

The Proof of Lemma ?? We just make use of the formula sin(1 ) sin(2 ) sin(3 ) = = , sin(arcAB ) sin(arcP B ) sin(arcP A ) where 1 =  3 is the angle between arcP B and arcP A , 2 is the angle between arcAB and arcP A , 3 is the angle between arcP B and arcAB . We can easily  to find that 2 =  2 and 3 = 3 . Similarly, we can derive that the spherical   triangles ABC, BCD and CDQ are of type (  2 , 3 , 3 ). The Proof of Lemma 7 By the Remark 1.2, it follows that the arc length of P A, AC, CD, CF and F Q is  4 , the arc length of P B and EQ is  and the arc length of BD and DE is  -  . 2 (i).Since the plane OAB is z = x, by taking a = 1, b = 0 in Lemma 1.1, the  tan(  ) length of arc AB is arctan( 24 ) = arctan( 2/2) =  2 - . (ii). Since the plane  of OBC is z = y , by taking a = 0, b = 1, the length of arc BC is arctan( 2) = . By the symmetry of sphere, we can attain the desired conclusions (i) - (vi). The Proof of Lemma 8 We just make use of the formula sin(1 ) sin(2 ) sin(3 ) = = , sin(arcAB ) sin(arcP B ) sin(arcP A ) 83

where 1 =  4 is the angle between arcP B and arcP A , 2 is the angle between arcAB and arcP A , 3 is the angle between arcP B and arcAB . We can easily  to find that 2 =  2 and 3 = 3 . Similarly, we can obtain that the spherical   triangles ABC, BCD, CDE, CEF and EF Q are of type (  2 , 3 , 4 ). The Proof of Lemma 9 We just prove that  arcsin(l) + arcsin( Which means 1 - l2 That is   3 l) = - arcsin(l sin( )). 2 2 5

 3 2  3 2 1- l - l = l sin( ). 4 2 5

   4 3 sin( )l3 + (7 + 4 sin2 ( ))l2 - 4 = 0. 5 5
4 sin(  )  5 15

Substituting l =

into the above equation, we have

   (48 + 16 5) sin2 ( ) = 20 + 4 5. 5 Which is   5- 5 sin ( ) = . 5 8
2

Hence we complete the proof. The Proof of Lemma 10. We just give the proof of (i)-(iv). The proof of (v)-(viii) can be got by the antisymmetry of sphere. By Remark 1.2, it follows that the arc length of P A and AC is  , the arc length of P B is  and the arc length of BD and DE is  . (i).Since the plane OAB is z = cot( )x, by taking a = cot( ), b = 0 in tan(  5) ) = arctan(tan(  Lemma 1.1, the length of arc AB is arctan(  5 ) sin( )). 2
1+cot ( )

Since

  sin(arctan(tan( ) sin( ))) = l sin( ). 5 5 Hence the length of arc AB is  . (ii). Since the plane OBC is z = cot(2 )x + cot(  5 )(cot( ) - cot(2 ))y ,  1+ 5 1 and cot(2 ) = 2 , cot( ) = 2 . By taking a = cot(2 ), b = cot(  5 )(cot( ) - b in Lemma 1.1, the length of arc BC is cot(2 )), tan( ) = a arctan(tan(  2 sin(/5)   - ) ) + arctan(2 cos( )). 5 5 5

 2 sin(/5)  Since tan() = 3 - 5 = tan(arctan(tan(  ) + arctan(2 cos(  5 - ) 5 ))). 5 Hence the length of arc BC is . 84

 (iii). Since the plane OCD is z = cot(2 )x+(csc(  5 ) cot(+ )-cot( 5 ) cot(2 ))y ,   -1 5+1 1  and cot(2 ) = 2 , cot( + ) = 5 2 , cos( 5 ) = 4  . By taking a = cot(2 ), b = 5- 5   b csc( 5 ) cot( +  ) - cot( 5 ) cot(2 ), tan( ) = a = 3 = tan(  4 sin  5 ) in Lemma 1.1, 5   2 2 we have 1 + a + b = 2 sin( 5 ), the length of arc CD is

   5-1 arctan(tan( )/(2 sin( ))) = arctan( ) = . 5 5 2 (iv). Since the plane OCE is z = cot(2 )x+(csc(  +2 )-cot(  5 ) cot( 5 ) cot(2 ))y ,   5-3 5+1 1  and cot(2 ) = 2 , cot( + 2 ) = , cos( ) = . By taking a = 4 5 4  5- 3 3   b cot(2 ), b = csc( 5 ) cot( + 2 ) - cot( 5 ) cot(2 ) = 8 sin(  ) , tan( ) = a = 5   5- 3 5   = tan(- 5 ), we have 1 + a2 + b2 = 2 sin( 5 ), the length of arc CE 4 sin  5 is    2 arctan(tan( )/(2 sin( ))) - arctan(tan( )/(2 sin( ))). 5 5 5 5  2   Since tan() = 3- 5 = tan[arctan(tan( 5 )/(2 sin( 5 )))-arctan(tan(  5 )/(2 sin( 5 )))]. Hence the length of arc CE is . The Proof of Lemma 11  (i). The plane OCG is z = cot(2 )x - [csc(  5 ) cot(2 ) + cot( 5 ) cot(2 )]y .   b Letting a = cot(2 ), b = -[csc( 5 ) cot(2 ) + cot( 5 ) cot(2 )], tan( ) = a =    5+ 5 5 2 2 - 4 sin(  ) , we have 1 + a + b = 2 sin(  ) , the arc length CG is
5 5

tan(  tan( ) 5 - ) ) + arctan(  ). arctan(  2 2 1+a +b 1 + a2 + b2 Since tan(  tan( ) 5 - ) ) + arctan(  )) = 2 = tan(2 ). tan(arctan(  2 2 1+a +b 1 + a2 + b2 Hence, we obtain that the arc length of CG is 2 .  (ii). The plane OEF is z = cot( +2 )x +[csc(  5 ) cot( +2 ) - cot( 5 ) cot( +   2 )]y . Letting a = cot( + 2 ), b = csc( 5 ) cot( + 2 ) - cot( 5 ) cot( + 2 )],     5 b 2 + b2 = 5(3- 5) , the arc length EF tan( ) = a = - 45+ 1 + a  , we have sin( 5 ) 8 sin(  5) is tan(  tan( ) 5 - ) ) + arctan(  ). arctan(  2 2 1+a +b 1 + a2 + b2 Since tan(  tan( ) 2 5 - ) ) + arctan(  )) =  = tan(2 ). tan(arctan(  2 2 2 2 5 1+a +b 1+a +b Hence, we obtain that the arc length of EF is 2 . 85

1  (iii). The normal vector of plane OCG is n1 = (-1, 2 , -1 (cot(  5 ) + csc( 5 )));  2  The normal vector of plane OEF is n2 = (-1, - 3-4 5 , 3-4 5 (cot(  5 ) + csc( 5 ))). Since     3- 5 3- 5 - (cot( ) + csc( ))2 n1 · n2 = 1 - 8 8 5 5    3 + (5) 5+ 5 3- 5 8 4(1 + 5)  +  +  ) = - ( 8 8 5- 5 5- 5 5- 5 = 0.

Therefore, the plane OEF is vertical to plane OCG. (iv). Let M be the intersection of arcs EF and CG. It satisfies
1 z=1 (csc(  + cot(  2x - 5) 5 ))y 2  3- 5 3- 5  z = - 4 x + 4 (csc(  5 ) + cot( 5 ))y.   By solving the above equation, we can get the coordinate of M is (cos( 10 ), sin( 10 ), 0). It is easy to obtain that the arc length of M F and M C are  and  , respectively. At the same time, we can obtain that the arc length of M E and M C are  and  , respectively.

The Proof of Lemma 12. We just make use of the formula sin(1 ) sin(2 ) sin(3 ) = = , sin(arcAB ) sin(arcP B ) sin(arcP A ) where 1 =  5 is the angle between arcP B and arcP A , 2 is the angle between arcAB and arcP A , 3 is the angle between arcP B and arcAB . We can easily to  find that 2 =  2 and 3 = 3 . Similarly, we can obtain that the other spherical    triangles are of type ( 2 , 3 , 5 ). The Proof of Lemma 13. + + (i). We suppose that the boundary between H0 ,j and H0,j +1 is z = ax + by . By (5.2), we have
+ + + (x+ k,j , yk,j , zk,j ) = Bk Aj (x0 , y0 , z0 ) ,

and Where

+ + + (x+ k,j +1 , yk,j +1 , zk,j +1 ) = Bk AAj (x0 , y0 , z0 ) .

  A=

-a2 +b2 +1 a2 +b2 +1 -2ab a2 +b2 +1 2a a2 +b2 +1

-2ab a2 +b2 +1 a2 -b2 +1 a2 +b2 +1 2b a2 +b2 +1

2a a2 +b2 +1 2b a2 +b2 +1 2 a +b2 -1 a2 +b2 +1

  .

Therefore,
+ + + + -1 + + + (x+ (xk,j , yk,j , zk,j ), k,j +1 , yk,j +1 , zk,j +1 ) = Bk A(Bk )

86

where

cos( 2k 3 )  Bk = - sin( 2k 3 ) 0



sin( 2k 3 ) cos( 2k 3 ) 0 a12 a22 a32

 0 0 . 1  a13 a23  , a33

A computation gives:
-1 Bk ABk

 a11 1  a21 = 2 a + b2 + 1 a31

where a11 a12 a13 a22 a23 a33 a21 a31 a32 4k 4k ) + 2ab sin( ) + 1, 3 3 4k 4k = (b2 - a2 ) sin( ) - 2ab cos( ) + 1, 3 3 2k 2k = 2a cos( ) - 2b sin( ), 3 3 4k 4k = (a2 - b2 ) cos( ) - 2ab sin( ) + 1, 3 3 2k 2k = 2a sin( ) + 2b cos( ), 3 3 = a2 + b2 - 1, = a12 , = a13 , = a23 . = (b2 - a2 ) cos(

+ + 2k On the other hand, the boundary between Hk,j and Hk,j +1 is z = (a cos( 3 ) - 2k 2k b sin( 2k 3 )x + (b cos( 3 ) + a sin( 3 )y . Hence, the symmetric point + + + + + + (^ xk,j +1 , y ^k,j +1 , z ^k,j +1 )  Hk,j +1 of (x+ k,j , yk,j , zk,j ) with respect to the boundary + + between Hk,j and Hk,j +1 can be got by Lemma 1.2, which is + + ^ + + + (^ x+ ^k,j ^k,j k,j +1 , y +1 , z +1 ) = A(xk,j , yk,j , zk,j ) .

^ = Bk AB -1 . Therefore, we obtain our concluIt is not difficult to check that A k sion (i). Similarly, we can prove the conclusion (ii).

7.3

Appendix for Chapter 4

The proof of Theorem 4. It is easy to check the initial condition. Hence, we just need to check the boundaries of system (4.3) (i). For the boundary condition L1 , L2 , we just check the case (i). It can be done by the same approach for other cases. We let x = r cos() sin(), y = r sin() sin(), z = r cos(), 87

+ + x+ 0,j = rj cos(0,j ) sin(0,j ), y0,j = rj sin(0,j ) sin(0,j ), z0,j = rj cos(0,j ).

Then we have

 + 2k  xk,j = rj cos( 3 + 0,j ) sin(0,j ), + 2k y = rj sin( 3 + 0,j ) sin(0,j ),  k,j + zk,j = rj cos(0,j ),  - 2k  xk,j = rj cos( 3 - 0,j ) sin(0,j ), y - = rj sin( 2k 3 - 0,j ) sin(0,j ),  k,j + zk,j = rj cos(0,j ).

and

Moreover,
+ gk,j = 1 (2t)3/2 1 2 2k 2 exp{- 2 t [r + rj - 2rrj ( cos( 3 + 0,j - ) sin( ) sin(0,j ) + cos() cos(0,j ))]},

and
- gk,j = 1 (2t)3/2 1 2 2k 2 exp{- 2 t [r + rj - 2rrj ( cos( 3 - 0,j - ) sin( ) sin(0,j ) + cos() cos(0,j ))]}.

+ - If  = 0, which is equivalent to y = 0, we have gk,j + g3 -k,j = 0, k = 0, 1, 2. Hence u(x, y = 0, z ; t) = 0.  If  =  3 , which is equivalent to y = x tan( 3 ), we find that + gk,j = 1 (2t)3/2 1 2 2 exp(- 2 t [r + rj - 2rrj ( 1) cos( (2k- + 0,j ) sin() sin(0,j ) 3 + cos() cos(0,j ))]),

and
- gk,j = 1 (2t)3/2 1 2 2 exp(- 2 t [r + rj - 2rrj ( 1) cos( (2k- - 0,j ) sin() sin(0,j ) 3 + cos() cos(0,j ))]).

Hence,
+ - + - + - g0 ,j = -g1,j , g1,j = -g0,j , g2,j = -g2,j ,

Therefore, we have u(x, y = x tan(  3 ), z ; t) = 0. (ii) For the boundary L3 , that is z =  take ± off,)
-13 x, 2 1-2 12 -13

we let, (for simple, we

Ik,j = (x - xk,j )2 + (y - yk,j )2 + (z - zk,j )2 .
2 2 2 2 2 x2 k1,j 1 + yk1,j 1 + zk1,j 1 = xk2,j 2 + yk2,j 2 + zk2,j 2 . If Ik1,j 1 = Ik2,j 2 on the boundary L3, it is equivalent to yk1,j 1 = yk2,j 2 and

xk1,j 1 -

13 1- 2 12 -

zk1,j 1 2 13

= xk2,j 2 - 88

13
2 1 - 2 12 - 13

zk2,j 2 .

(7.2)

Denoting(xk1,j 1 , yk1,j 1 , zk1,j 1 ) = Bk1 Ak1 (x0 , y0 , z0 ) , (xk2,j 2 , yk2,j 2 , zk2,j 2 ) = Bk2 Ak2 (x0 , y0 , z0 ) , we have xk1,j 1 = a11 x0 + a12 y0 + a13 z0 , yk1,j 1 = a21 x0 + a22 y0 + a23 z0 , zk1,j 1 = a31 x0 + a32 y0 + a33 z0 , xk2,j 2 = b11 x0 + b12 y0 + b13 z0 , yk2,j 2 = b21 x0 + b22 y0 + b23 z0 , zk2,j 2 = b31 x0 + b32 y0 + b33 z0 . Therefore, Equ(7.2) is equivalent to, for i = 1, 2, 3 a 2i = b 2i , a 1i + -13 1- 2 12 - a3i 2 13 = b1i + -13
2 1 - 2 12 - 13

b 3i .

(7.3)

(iii). Using (7.3), we get, for the case (i), which is z =
+ + I0 ,1 = I0,2 , + - I2 ,1 = I0,3 , - - I2 ,1 = I0,4 , + - I1 ,2 = I1,4 , - + I2 ,2 = I2,4 , - - I2 ,3 = I2,4 , + + I1 ,1 = I0,4 , - - I0 ,1 = I0,2 , - + I1 ,1 = I0,3 , + + I2 ,2 = I2,3 , - - I1 ,2 = I1,3 , + + I1 ,3 = I1,4 .



2 2 x

Hence,
+ + g0 ,1 = g0,2 , + - g2 ,1 = -g0,3 , - - g2 ,1 = g0,4 , + - g1 ,2 = -g1,4 , - + g2 ,2 = -g2,4 , - - g2 ,3 = g2,4 , + + g1 ,1 = g0,4 , - - g0 ,1 = g0,2 , - + g1 ,1 = -g0,3 , + + g2 ,2 = g2,3 , - - g1 ,2 = g1,3 , + + g1 ,3 = g1,4 .

Therefore, for the case (i), on the boundary z = 0. 89

 2 2 x,

we have u(x, y, z, t) =

(iv). From (7.3), we get, for the case (ii), which is z = x
- - + + ± ± I0 , 1 = I0, 2 , I 1, 1 = I0, 3 , I 1, 1 = I0, 3 + - - + ± ± I2 ,1 = I0,5 , I2,1 = I0,5 , I3,1 = I0,4 , ± ± + - - + I1 ,2 = I1,3 , I2,2 = I0,6 , I2,2 = I0,6 , + - - + ± ± I3 ,2 = I1,4 , I3,2 = I1,4 , I2,3 = I1,6 , + - - + ± ± I3 ,3 = I1,5 , I3,3 = I1,5 , I3,4 = I3,5 , + - - + ± ± I2 ,4 = I3,6 , I2,4 = I3,6 , I2,5 = I2,6 .

Hence,
± ± + - - + g0 ,1 = g0,2 , g1,1 = -g0,3 , g1,1 = -g0,3 + - - + ± ± g2 ,1 = -g0,5 , g2,1 = -g0,5 , g3,1 = g0,4 , ± ± + - - + g1 ,2 = g1,3 , g2,2 = -g0,6 , g2,2 = -g0,6 , + - - + ± ± g3 ,2 = -g1,4 , g3,2 = -g1,4 , g2,3 = g1,6 , + - - + ± ± g3 ,3 = -g1,5 , g3,3 = -g1,5 , g3,4 = g3,5 , + - - + ± ± g2 ,4 = -g3,6 , g2,4 = -g3,6 , g2,5 = g2,6 .

Therefore, for the case (ii), on the boundary z = x, we have u(x, y, z, t) = 0.

(v). From (7.3), we get, for the case (iii), which is z = cot(/5)x
± ± + - - + I0 , 1 = I0, 2 , I 1, 1 = I0, 4 , I 1, 1 = I0, 3 + + - + + - I2 ,1 = I0,6 , I2,1 = I0,5 , I3,1 = I0,5 , - - + - - - I3 , 1 = I0, 6 , I 4, 1 = I0, 3 , I 4, 1 = I0, 4 + - - - + + I1 ,2 = I1,4 , I1,2 = I1,3 , I2,2 = I0,7 , - + + - - - I2 ,2 = I0,12 , I3,2 = I0,12 , I3,2 = I0,7 , + + - + + - I4 ,2 = I4,3 , I4,2 = I4,4 , I1,3 = I1,5 , + + - - + + I2 ,3 = I0,8 , I2,3 = I1,12 , I3,3 = I4,12 , - - - + + - I3 ,3 = I0,8 , I4,3 = I4,5 , I1,4 = I1,6 , + + - - + + I2 ,4 = I0,9 , I2,4 = I1,7 , I3,4 = I4,7 ,

90

- - - + + + I3 , 4 = I0, 9 , I 4, 4 = I4, 6 , I 1, 5 = I1, 6 , + + - - + + I2 ,5 = I0,10 , I2,5 = I1,8 , I3,5 = I4,8 , - - - - + - I3 ,5 = I0,10 , I4,3 = I1,6 , I2,6 = I1,10 , - - + + - + I2 ,6 = I1,9 , I3,6 = I4,9 , I3,6 = I4,10 , + + + + - + I1 ,12 = I1,7 , I2,12 = I0,11 , I2,12 = I1,8 , + - - - - - I3 ,12 = I4,8 , I3,12 = I0,11 , I4,12 = I4,7 , + - - + + - I2 ,7 = I1,11 , I2,7 = I1,9 , I3,7 = I4,9 , - + + + - + I3 ,7 = I4,11 , I2,8 = I1,11 , I2,8 = I1,10 , + - - - + - I3 ,8 = I4,10 , I3,8 = I4,11 , I2,9 = I2,11 , - - + + - + I2 ,9 = I2,10 , I3,9 = I3,10 , I3,9 = I4,11 , + + - - I2 ,10 = I2,11 , I3,10 = I3,11 ,

Hence,
± ± + - - + g0 ,1 = g0,2 , g1,1 = -g0,4 , g1,1 = -g0,3 + + - + + - g2 ,1 = g0,6 , g2,1 = -g0,5 , g3,1 = -g0,5 , - - + - - - g3 ,1 = g0,6 , g4,1 = -g0,3 , g4,1 = g0,4 + - - - + + g1 ,2 = -g1,4 , g1,2 = g1,3 , g2,2 = g0,7 , - + + - - - g2 ,2 = -g0,12 , g3,2 = -g0,12 , g3,2 = g0,7 , + + - + + - g4 ,2 = g4,3 , g4,2 = -g4,4 , g1,3 = -g1,5 , + + - - + + g2 ,3 = g0,8 , g2,3 = g1,12 , g3,3 = g4,12 , - - - + + - g3 ,3 = g0,8 , g4,3 = -g4,5 , g1,4 = -g1,6 , + + - - + + g2 ,4 = g0,9 , g2,4 = g1,7 , g3,4 = g4,7 ,

- - - + + + g3 ,4 = g0,9 , g4,4 = -g4,6 , g1,5 = g1,6 , + + - - + + g2 ,5 = g0,10 , g2,5 = g1,8 , g3,5 = g4,8 , - - - - + - g3 ,5 = g0,10 , g4,3 = g1,6 , g2,6 = -g1,10 , - - + + - + g2 ,6 = g1,9 , g3,6 = g4,9 , g3,6 = -g4,10 , + + + + - + g1 ,12 = g1,7 , g2,12 = g0,11 , g2,12 = -g1,8 , + - - - - - g3 ,12 = -g4,8 , g3,12 = g0,11 , g4,12 = g4,7 , + - - + + - g2 ,7 = -g1,11 , g2,7 = -g1,9 , g3,7 = -g4,9 , - + + + - + g3 ,7 = -g4,11 , g2,8 = g1,11 , g2,8 = -g1,10 , + - - - + - g3 ,8 = -g4,10 , g3,8 = g4,11 , g2,9 = -g2,11 , - - + + - + g2 ,9 = g2,10 , g3,9 = g3,10 , g3,9 = -g4,11 , + + - - g2 ,10 = g2,11 , g3,10 = g3,11 ,

91

Therefore, for the case (iii), on the boundary z = cot(/5)x, we have u(x, y, z, t) = 0. (v). From (7.3), we get, for the case (iv), which is z = 0,
± ± gk, 1 = gk,2 , k = 0, 1, 2, · · · , N.

Therefore, for the case (iii), on the boundary z = 0, we have u(x, y, z, t) = 0. In conclusion, by the above steps, the solution of the heat equation can be expressed as (4.10). The Proof of Theorem 5. (1) If we let 13 = 23 = 0, 12 = 1 in (1.2)-(1.4). We suppose that 1 = 2 =  . Then we have 1 = 2 , and
2 2 2p p  2  2 p  2  2 p 3  p p + + + 2 = - i , 2 2 2 t 2 x1 2 x2 2 x3 x1 x2 i=1 xi
2 Letting p = exp(   2 x2 +

3

3 2 x3 3

 -1 2 ( 2 +

2

2 3 2 )t)q , 3

we have

2  2 q 2  2 q 2q 2  2 q q + + 3 2 + 2 = , 2 2 t 2 x1 2 x2 2 x3 x1 x2 Letting q (x1 , x2 , x3 , t) = q1 (x1 , x2 , t)q2 (x3 , t), we have
2 1 q1  2  2 q1  2  2 q2  2  2 q1 1 q2 2  q1 ) = - -  ( - 3 ( - ) = µ, q2 t 2 x2 q1 t 2 x2 2 x2 x1 x2 3 1 2

and

  

q2 t

q2 (x3 = m1 , t)   q2 (x3 , t = 0) By solving the above equation, we have q2 (x3 , t) = and     
q1 t

q2 = 23  + µq2 x2 3 =0 =  (x3 )

2

2

eµt x2 (x3 - 2m3 )2  [exp(- 3 ) - exp(- )] 2 2t 23 t 23 3 2t

q1 (x1 = m1 , x2 , t)  q1 (x1 , x2 = m2 , t)    q1 (x1 , x2 , t = 0)

q1 = 21  + 22 x2 1 =0 =0 =  (x1 ) (x2 )

2

2

 2  2 q1 x2 2

 q1 - µq1 + 1 1 x 1 x2

2

92

m1 m2 Letting x = x1 - > 0, y = x2 - > 0, q1 = q ^1 e-µt , then dropping the hat,   we have  q 2  2 q1  2 q1 1  q1 1 =1  2 + 2 y 2 + xy t 2 x   q1 (x = 0, y, t) = 0  q (x, y = 0, t) = 0   1 m2 1 q1 (x, y, t = 0) =  2  (x + m 1 ) (y + 2 ) x +y -y   ,v = x , h = 1 2 q1 , 2 2 -m1 /1 -m2 /2 -m1 /1 +m2 /2   , vo = , and 2 2

Letting u =

then we have the initial point uo =

   

 h = u 2 h(u = -v, v, t) = 0  h(u = v, v, t) =0   h(u, v, t = 0) =  (u - uo ) (v - vo ) h t

2

Since u > 0, so we have  2h  h = u 2 t h(u = |v |, v, t) = 0  h(u, v, t = 0) =  (u - uo ) (v - vo )

(7.4)

Before we solve (7.4), we consider the solution of the following equation h(u, v, t = 0)
h t  h = u 2 =  (u - uo ) (v - vo )
2

(7.5)

Substituting h = h1 (u, t)h2 (v, t) into (7.5), then we have h1 Then h2 h1  2 h1 + h2 = h2 . t t u2

1  2 h2 1  2 h1 h1 = ( - ) = -c2 . 2 h2 t h1 u t h2 =  (v - vo ) exp(-c2 t),

Hence, we have

The approach is very similar to the above, we have (u - uo )2 ec t h1 (u, t) =  exp(- ). 4t 4t Hence, we have the solution of (7.5) as follows h=  (v - vo ) (u - uo )2  exp(- ). 4t 4t
2

Now we consider the boundary condition of (7.4). Obviously, when v = vo , then we have h2 = 0 and h = 0. When v = vo , the boundary of (7.4) becomes 93

h(u = |vo |, vo , t) = 0. Making use of the Method of Images, we obtain that the solution of (7.4) can be expressed as h=  ( v - vo ) (u - uo )2 (u - 2|vo | + uo )2  [exp(- ) - exp(- )]. 4t 4t t

Hence, we have q1 = =  (v - vo ) (u - 2|vo | + uo )2 (u - uo )2  [exp(- ) - exp( - )] 4t 4t 2 2 t 1 -x2  ( x ) (x1 + x2 )2 2  [exp( - ) 8 2 t 2 2 t (x1 + x2 - 4 max(m1 , m2 ))2 - exp(- )]. 8 2 t

Therefore, the solution of (1.2)-(1.4) can be expressed as p =
1 -x2 4m2 3 -4m3 x3  ( x ) - x3 - 3 t 2t 2 2 3    ( )[1 - e ] 2 2 3 t 3 t

×e 2 x2 - 22 t [e-

2

2 2

(x1 +x2 )2 8 2 t

- e-

(x1 +x2 -4 max(m1 ,m2 ))2 8 2 t

].

2). Since i = , i = 1, 2, 3, so i =  = r -
 2

p = e q , we can eliminate the first partial derivative term. Letting xi i 13 = 23 = 12 = 1, and y ^i =  -m i in (3), and taking off the hat, we have i q = t
3 i=1

x1 -  t 2

2

2 2 ,i

= 1, 2, 3. If we let

1 2q 2 + 2 yi

1i<j 3

2q , yi yj

(7.6)

m1 m2 3 For simple, we suppose that m 3  max{ 1 , 2 }. Letting z1 = y1 - y3 , z2 = t y2 - y3 , z3 = y3 , s = 2 , we have

 q  s     q (z3 = -z1 , z1 , z2 , s) q (z3 = -z2 , , z1 , z2 , s)      q (z3 = 0, z1 , z2 , s) q (z1 , z2 , z3 , s = 0)

 q = z 2 3 =0 = 0, = 0, =  (z1 - z10 ) (z2 - z20 ) (z3 - z30 ) m3 3
3  0, z30 = - m 3  0. We consider

2

m3 m2 1 where z10 = - m 1 + 3  0, z20 = - 2 + the following initial equation q s
2

q (z1 , z2 , z3 , s = 0)

 q = z 2 3 =  (z1 - z10 ) (z2 - z20 ) (z3 - z30 )

94

Letting q = p1 (z1 , z2 , s)p2 (z3 , s), then we have p1 Then p2 p1  2 p2 + p2 = p1 2 . s s z3

1  2 p1 1  2 p2 p2 = ( 2 - ) = -c2 . p1 s p2 z3 s p1 =  (z1 - z10 ) (z2 - z20 ) exp(-c2 s),
2

Hence, we have

The approach is very similar to the above, we have
3 (z3 + 3 ) ec s p2 (z3 , s) =  exp(- ) 4s 4s

m

2

Hence, the solution of the above initial equation is q =  (z1 - z10 ) (z2 - z20 ) 
3 (z3 + 3 ) 1 exp(- ). 4s 4s

m

2

Now, we add the boundaries. If z1 = z10 , or z2 = z20 , then we have q = 0, m3 1 which satisfies the boundaries. If z1 = z10 = -( m 1 - 3 ), and z2 = z20 = m2 m3 -( 2 - 3 ). Since z3  0, we do not need to consider the boundary conditions q (z3 = -z1 , z1 , z2 , s) = 0, q (z3 = -z2 , , z1 , z2 , s) = 0, For q (z3 = 0, z1 , z2 , s) = 0, we have q =  (z1 - z10 ) (z2 - z20 ) 
3 3 ) ) (z3 + 3 (z3 - 3 1 [exp(- ) - exp(- )]. 4s 4s 4s

m

2

m

2

Hence, we have, considering t = 2s, q = ( x1 y2 (x3 - 2m3 )2 x3 x2 x3 1 [exp(- 3 2 ) - exp(- )]. - ) ( - )  2 1 3 2 3 2t3 2t3 2t

3). For the case of 12 = 1, 13 = -1, 23 = -1, it is similar to (7.6) consider the following equation p = s Letting
3 i=1

2p 2p 2p 2p +2 -2 -2 2 xi x1 x2 x1 x3 x2 x3

(7.7)

x1 + x2 x1 - x2  ,y ^2 =  ,y ^3 = x3 , 2 2 taking off the hat, we have y ^1 =  2p 2p 2p p =2 2 + 2 -2 2 , s y1 y3 y1 y3 95

with boundary conditions p(y1 = y2 , y2 , y3 , s) = 0, p(y1 = -y2 , y2 , y3 , s) = 0, p(y1 , y2 , y3 = 0, s) = 0, and initial condition p(y1 , y2 , y3 , s = 0) =  (y1 - y10 ) (y2 - y20 ) (y3 - y30 ),
+m2 /2 -m1 /1 where y10 = - m1 /1 , y20 = m2 /2 , y30 = -m3 /3 . By using the 2 2 method of separation variables, we have

p =  (y2 - y20 )p2 (y1 , y3 , t), where p2 (y1 , y3 , s) satisfies, since y1  0   2 p2  2 p2 p2  2 p2 =2 2 + -2 2 , 2 s y1 y3 y1 y3 p2 (y1 = |y20 |, y3 , s) = 0, p2 (y1 , y3 = 0, s) = 0, p2 (y1 , y3 , s = 0) =  (y1 - y10 ) (y3 - y30 ). Letting  1 z1 =  y1 + y3 , z2 = 2y3 , 2 p2  2 p2 =2 2 , s z2 1 1 p2 (z1 =  |y20 | +  z2 , z2 , s) = 0, 2 2 p2 (z1 , z2 = 0, s) = 0, p2 (z1 , z2 , s = 0) =  (z1 - z10 ) (z2 - z20 ),  1 =  y + y30 , z20 = 2y30 . By the method of separation variables, 2 10

we have

where z10 we have

1 p2 =  (z1 -  y10 - y30 )p3 (z2 , s), 2 where p3 (z2 , s) satisfies  2 p3 p3 =2 2 , s z2  p3 (z2 = -|y20 | + 2z10 , s) = 0, p3 (z2 = 0, s) = 0, p3 (z2 , s = 0) =  (z2 - z20 ). 96 (7.8)

 Denoting r0 = 2z10 - |y20 |, w2k = 2kr0 + z20 , w2k-1 = 2kr0 - z20 , for k = 0, 1, 2, · · · , the solution of the above equation can be presented as p3 =  1 [ 8s -
 (z2 -w2k )2 ) k=0 [exp(- 8s w2k ) - exp(- (z2 + )] 8s
2k-1 ) - exp(- (z2 +w )]. 8s 2 2

 (z2 -w2k-1 )2 ) k=1 [exp(- 8s

(7.9)

In conclusion, we have the solution, t = 2s, p =  [ - 1 x1 /1 - x2 /2 x1 /1 + x2 /2  ( ) ( + x3 /3 ) 2 4t 2 [exp(-
k=0  k=1



(z2 - w2k )2 (z2 + w2k )2 ) - exp(- )] 4t 4t (z2 - w2k-1 )2 (z2 + w2k-1 )2 ) - exp(- )]. 4t 4t

[exp(-

The Proof of Theorem 6. Since P ( min Y1 (s) > m1 , min Y2 (s) > m2 , min Y3 (s) > m3 )
0<s<t   m2 0<s<t 0<s<t  m3

=
m1 K1 K2

exp(a1 x1 + a2 x2 + a3 x3 + bt) 1 2 3
2 1 - 2 12 - 13

×
k=0 j =1

+ - (-1)j -1 [gk,j (z1 , z2 , z3 , t) + gk,j (z1 , z2 , z3 , t)]dx1 dx2 dx3 ,

where
± gk,j

= = = =

z1 z2 z3

±1 1 ± 2 ± 2 2 exp(- ((z1 - x± k,j ) + (z2 - yk,j ) + (z3 - zk,j ) )) 2T (2T )3/2 1 x1 - m1 x2 - m2 12 - 2 2 1 2 1 - 12 1 - 12 x2 - m2 2 -13 12 13 x1 - m1 x2 - m2 + 2 2 2 2 2 2 1 2 (1 - 12 )(1 - 12 - 13 ) (1 - 12 )(1 - 12 - 13 ) + 1 - 2 12 1- 2 12 - 2 13 x3 - m3 3

97

Letting x ^i =

xi -mi i , 0<s<t

then dropping off the hat of xi , we have
0<s<t 0<s<t

P ( min Y1 (s) > m1 , min Y2 (s) > m2 , min Y3 (s) > m3 ) = ×
0 J1 0 J2 + - (-1)j -1 [gk,j (z1 , z2 , z3 , t) + gk,j (z1 , z2 , z3 , t)]dx1 dx2 dx3 , k=0 j =1 0

1
2 1 - 2 12 - 13   

exp(a1 m1 + a2 m2 + a3 m3 + bt) exp(a1 1 x1 + a2 2 x2 + a3 3 x3 )

× where
± gk,j

= = = =

z1 z2 z3

±1 1 ± 2 ± 2 2 exp(- ((z1 - x± k,j ) + (z2 - yk,j ) + (z3 - zk,j ) )) 3 / 2 2T (2t) 12 1 x1 - x2 2 1 - 12 1 - 2 12 x2 -13 12 13 x1 + x2 2 2 2 2 2 (1 - 12 )(1 - 12 - 13 ) (1 - 12 )(1 - 2 12 - 13 ) + 1 - 2 12
2 1 - 2 12 - 13

x3

Since
± exp(a1 1 x1 + a2 2 x2 + a3 3 x3 )gk,j

=

1 - 2 1 - 2 1 1 1 13 12 2 x2 x2 × exp{- { 1+ 2+ 2 2 2 2 2 x3 3 / 2 2t 1 - 12 - 13 1 - 12 - 13 1 - 2 -  (2t) 12 13 -212 -212 212 13 + 2 x1 x2 + (1 - 2 - 2 ) x1 x3 + 1 - 2 - 2 x2 x3 1 - 2 12 - 13 12 13 12 13 ± -[ -[ -[ 2 1 - 2 12 1 - 2 12
± 2zk,j

[x± k,j +

± -13 zk,j 2 1 - 2 12 - 13

] + 2t1 (a1 + 1)]x1 + 2t2 (a2 + 1)]x2

-212 x± k,j

± + 2yk,j +

± 212 13 zk,j 2 2 (1 - 2 12 )(1 - 12 - 13 )

1 - 2 12

2 1 - 2 12 - 13

+ 2t3 (a3 + 1)]x3

± 2 ± 2 2 +(x± k,j ) + (yk,j ) + (zk,j ) }}.

We denote

  -1 =  

1 2 1-2 12 -13 -12 2 1-2 12 -13 -13 2 1-2 12 -13

-12 2 1-2 12 -13 1-2 13 2 1-2 12 -13 12 13 2 1-2 12 -13

-13 2 1-2 12 -13 12 13 2 1-2 12 -13 1-2 12 2 1-2 12 -13

   

98

and let  µ± k,j =  2 t  ± - zk,j  2 2 [x±  13 + ] + 2t1 (a1 + 1) k,j 2  1-12 1-12 -2 13  -2 x± ± 2  12 k,j 12 13 zk,j  ± + 2yk,j + + 2t2 (a2 + 1) ×  1-2 2 )(1-2 -2 ) (1 -   12 12 13 12 2 ±  2zk,j 1-   2 12 + 2t3 (a3 + 1) 2
1-12 -13 x1  x3 Hence, for X = (  , x2t ,  ) t t ± exp(a1 1 x1 + a2 2 x2 + a3 3 x3 )gk,j

    .  

=

.

-1 ± (µ± µk,j 1 k,j )  × exp( ) 3 / 2 2 (2t) 1 ± 2 ± 2 × exp(- ((x± )2 + (yk,j ) + (zk,j ) )) 2t k,j -1 (X - µ± (X - µ± k,j )  k,j ) × exp(- ) 2
-1 ± µk,j (µ± k,j )  2

Therefore, Denoting A± k,j = exp(a1 m1 + a2 m2 + a3 m3 + bt + ± 2 ± 2 ± 2 1 2t ((xk,j ) + (yk,j ) + (zk,j ) )), we have
J1 J2

-

P =
k=0 j =1

+ - - (-1)j -1 [A+ k,j (0, 0, 0, -µk,j , ) - Ak,j (0, 0, 0, -µk,j , )].

This part is just for solving the PDE(4.9) in another area. We turn to ± solve the solution of Heat Equation (4.9) on the domain Hk,j . If (^ x0 , y ^0 , z ^0 )  ± ± Hk0 ,j0 , we need to get solution of the Heat Equation on Hk0 ,j0 . Considering the following equation  1 2u 2u 2u   u t = 2 [  x ^2 +  y ^2 +  z ^2 ] (7.10) u(^ x, y ^, z ^, 0) =  (^ x-x ^0 ) (^ y-y ^0 ) (^ z-z ^0 )   u(L ^ 1 , t) = u(L ^ 2 , t) = u(L ^ 3 , t ) = 0, where ^1 L ^2 L ^3 L = = =
± {(^ x, y ^, z ^) : (0, 1, 0)(Bk Aj0 )-1 (^ x, y ^, z ^) = 0}, 0  ± -1 {(^ x, y ^, z ^) : (tan( ), -1, 0)(Bk0 Aj0 ) (^ x, y ^, z ^) = 0},  3 2 ± {(^ x, y ^, z ^) : ( , 0, -1)(Bk Aj0 )-1 (^ x, y ^, z ^) = 0}, 0 2

99

we have the following Theorem Theorem 7.3.1. The solution of Equation (7.10) can be expressed as
+ x0 , y ^0 , z ^0 )  Hk , (i) If (^ 0 ,j0 2 4 - + (^ x, y ^, z ^, t) + g ^k,j (^ x, y ^, z ^, t)], (-1)j -j0 [^ gk,j k=0 j =1

u(^ x, y ^, z ^, t) =

(7.11)

- (ii) If (^ x0 , y ^0 , z ^0 )  Hk , 0 ,j0 2 4 + - (-1)j -j0 [^ gk,j (^ x, y ^, z ^, t) + g ^k,j (^ x, y ^, z ^, t)], k=0 j =1

u(^ x, y ^, z ^, t) = - where
± g ^k,j =±

(7.12)

1 1 ± 2 ± 2 2 exp[- [(^ x-x ^± y-y ^k,j ) + (^ z-z ^k,j ) ], k,j ) + (^ 3 / 2 2t (2t)

and

± ± ± ± ± (^ x± ^k,j ,z ^k,j ) = (Bk Aj0 )Bk Aj (Bk Aj0 )-1 (^ x0 , y ^0 , z ^0 ) . k,j , y 0 0

Proof. We give the proof of (i). By the similar way, we can prove (ii). By Equation (7.11), we can find that
+ g ^0 x, y ^, z ^, t = 0) =  (^ x-x ^0 ) (^ y-y ^0 ) (^ z-z ^0 ), ,1 (^

Otherwise,

± g ^k,j (^ x, y ^, z ^, t = 0) = 0.

Therefore, u(^ x, y ^, z ^, t) satisfies the initial condition. Denoting ± (x0 , y0 , z0 ) = (Bk Aj0 )-1 (^ x0 , y ^0 , z ^0 ) , 0
+ Then we know that (x0 , y0 , z0 )  H0 ,1 . By Theorem 4, the solution of (4.10) is 2 4 + - (-1)j -1 [gk,j (x, y, z, t) + gk,j (x, y, z, t)]. k=0 j =1

u(x, y, z, t) = Letting Then we have ^± I k,j

± 2 ± 2 2 ^± = (^ I x-x ^± y-y ^k,j ) + (^ z-z ^k,j ) . k,j k,j ) + (^

 x ^-x ^± k,j ± ± ± . ^-y ^k,j = (^ x-x ^± ^-y ^k,j ,z ^-z ^k,j )· y k,j , y ± z ^-z ^k,j  100

+ + Letting (Bk Aj0 )-1 (^ x, y ^, z ^) = (x, y, z ) , we know that (x, y, z )  H0 ,1 . Since 0 -1 -1 (Aj0 ) = (Aj0 ) , (Bk0 ) = (Bk0 ) Hence, we have

 x - x± k,j ± ± ± -1 ^± (^ . (Bk0 )-1 ·Bk0 Aj0  y - yk,j I ^, z ^, t) = (x-x± k,j x, y k,j , y -yk,j , z -zk,j )(Aj0 ) ± z - zk,j  Hence, we have
± ^± (^ I ^, z ^, t) = Ik,j (x, y, z, t). k,j x, y

From the proof of Theorem 4, we know the fact that u(^ x, y ^, z ^, t) = 0 on ^1, L ^2, L ^ 3 is equivalent to u(x, y, z, t) = 0 on the boundaries the boundaries L L1 , L2 , L3 . Which finishes the proof of Theorem 7.3.1. From the proof of Theorem 7.3.1 we obtain the following corollary.
± ± Corollary 7.3.1. Suppose that (^ x0 , y ^0 , z ^0 )  Hk , (^ x, y ^, z ^)  Hk , and 0 ,j0 0 ,j0 ± ± -1 -1 (x0 , y0 , z0 ) = (Bk0 Aj0 ) (^ x0 , y ^0 , z ^0 ) , (x, y, z ) = (Bk0 Aj0 ) (^ x, y ^, z ^) . Then the relationship between the solution of (4.9) and the solution of (7.10) is

u(^ x, y ^, z ^, t) = ±(-1)j0 -1 u(x, y, z, t).

101

Bibliography
[1] Bhansali V. and Wise M. (2008), Correlated random walks and the joint survival probability. arXiv:0812.2000v1 [q-fin.ST]. [2] Bakshi, G. and Madan, D. (2000). Spanning and derivative-security valuation. Journal of Financial Economics, 55, 205-238. [3] Black, F and Scholes, M(1973), The Pricing of Options and Corporate Liabilities, Journal of Political Economy, 81:637-654. [4] Brian Bradie, A Friendly Introduction to Numerical Analysis, 2006 Pearson Education, Inc. [5] Carslaw, H. S. and Jaeger, J. C. (1986). Conduction of heat in solids. Oxford University Press, Oxford, 2nd edition. [6] Cleve B. Moler(2004), Numerical Computing with Matlab, The Mathworks, Inc. Siam. [7] Engle, R. F. (2002), Dynamic conditional correlation - a simple class of multivariate GARCH models. Journal of Business and Economic Statistics, 17, 339­350. [8] Eugene Gutkin and Paul K. Newton(2004), The Method fo Images and Green's Function for Spherical Domains, Journal of Physics A: Mathematical and General, 37,11989-12003. [9] Goldman, M.B., H. B. Sosin, and M. A. Gatto(1979), Path Dependent Options:'Buy at the Low, Sell at the High', Journal of Finance 34,11111127, [10] Goldman, M.B., H. B. Sosin, and L. A. Shepp(1979), On Contingent Claims that Insure Ex-Post Optiomal Stock Market Timing, Journal of Finance 34, 401-413. [11] Heston, S. A(1993) Closed-Form Solution for Options with Stochastic Volatility with Applications to Bond and Currency Options. The Review of Financial Studies, Vol. 6, No. 2, pp. 327-343 102

[12] Hua He, William P(1998). Keirstead and Joachim Rebholz, Double Lookbacks, Mathematical Finance, Vol.8 No.3, 201-228. [13] Hull, J. C. Options(2000), Futures, and Other Derivative securities, Fourth Edition. Prentice Hall, New York. [14] Hull, J. C. and White, A. D. (1987). The pricing of options on assets with stochastic volatilities. Journal of Finance, 42, 281-300. [15] Hull, J., and A. White (2004), Valuation of a CDO and an nth to Default CDS without Monte Carlo Simulation, Journal of Derivatives, 2, 8-23. [16] Iyengar, S. (1985). Hitting lines with two-dimensional Brownian motion. SIAM Journal of Applied Mathematics, 45, 983-989. [17] Karatzas, I., and S. Shreve(1991), Brownian Motion and Stochastic Calculus, 2nd ed., Berlin, Springer-Verlag. [18] Korenev, B. G.(2002), Bessel Function and their Applications, Chapman and Hall/CRC. [19] Lipton, A. (2001). Mathematical Methods for Foreign Exchange: A Financial Engineer?s Approach. World Scientific Publishing Co. Pte. Ltd., Singapore. [20] Masaaki Kijima(2002), Stochastic Processes with Applications to Finance, Chapman and Hall/CRC, New York. [21] Metzler, A. (2009). On the first passage problem for correlated Brownian motion. Statistics and Probability Letters, doi:10.1016/j.spl.11.001. [22] Metzler A.(2008) , Multivariate first-passage models in credit risk. Ph.D. Thesis, University of Waterloo. [23] Moon, P. and Spencer, D.E. (1988), Eleven coordinate systems. Field Theory Handbook, Including Coordinate Systems, Differential Equations and Their Solutions, 2nd. edition, New York Springer-Verlag, 1-48. [24] Risken, H. (1989), The Fokker-Planck equation, 2nd edition. Springer Verlag. [25] Rowlands, G.(1960), The method of images and the solutions of certain partial differential equations. Applied Scientific Research Section B, Vol 8. 62-72 [26] Rubinstein, M. and Reiner, E. (1991), `Breaking Down the Barriers', Risk Magazine 4 (September). [27] Sacerdote, L. (1990). On the solution for the Fokker-Planck equation for a Feller process. Advances in Applied Probability, 22, 101-110. 103

[28] Sepp, A. (2006). Extended CreditGrades model with stochastic volatility and jumps. Wilmott Magazine, 54, 50-62. [29] Shepp, L. (1979), The joint density of the maximum and its location for a Wiener process with drift. Journal of Applied Probability, 16, 423-427. [30] Sommerfel, A.(1894), Zur analytischen theorie der warmeleitung. Math. Ann., 45, 263-277.

104

