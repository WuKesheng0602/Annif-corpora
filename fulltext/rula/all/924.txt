TISSUE CHARACTERIZATION OF  PROSTATE CANCER USING  QUANTITATIVE ANALYSIS OF LOW  FREQUENCY ULTRASOUND 
   by  ERVIS SOFRONI, B.SC., RYERSON UNIVERSITY,TORONTO,2011 

 
A thesis   presented to Ryerson University  in partial fulfillment of the  requirements for the degree of  Master of Science  in the Program of  Computer Science     
© Ervis Sofroni 2011 

 

 

Author's Declaration 
  I hereby declare that I am the sole author of this thesis.   I  authorize  Ryerson  University  to  lend  this  thesis  or  dissertation  to  other  institutions  or  individuals for the purpose of scholarly research.   *__________________________________           I  further  authorize  Ryerson  University  to  reproduce  this  thesis  by  photocopying  or  by  other  means,  in  total  or  in  part,  at  the  request  of  other  institutions  or  individuals  for  the  purpose  of  scholarly research.   *__________________________________  

 
 

 

II   

ABSTRACT  
 

TISSUE CHARACTERIZATION OF PROSTATE CANCER USING  QUANTITATIVE ANALYSIS OF LOW FREQUENCY ULTRASOUND    MSc., 2011, Ervis Sofroni, Computer Science, Ryerson University   
Current  accepted  methodologies  used  for  detection  of  the  prostate  tumor  involve  measurements  of  prostate specific antigen (PSA) levels, patient age followed by ultrasound guided biopsies leaving a lot to  desire  in  the  ability  to  correctly  identify  lesions.  Also  PSA  level  test  has  been  shown  to  produce  a  high  number  of  false  positives  leading  to  unnecessary  invasive  biopsies.  The  goal  of  this  thesis  is  to  investigate  the  use  of  transrectal  conventional  low  frequency  (110MHz)  ultrasound  as  a  noninvasive  imaging  modality  for  the  detection  of  prostate  tumors.  Currently  we  are  investigating  the  use  of  multi  parameter  spectroscopic  analysis  of  the  ultrasound  radiofrequency  signal  in  combination  with  ultrasound  elastrographic  imaging  of  the  prostate  and  correlating  the  results  with  wholemount  histopathology  from  radical  prostatectomy.  Ten  patients  with  prostate  cancer  prior  to  surgery  were  subjected  to  transrectal  conventional  low  frequency  ultrasound  scans.  Parametric  maps  are  generated  for  each  individual  spectral  parameter.  Ratios  of  disease  area  versus  normal  prostatic  tissue  are  identified  using  low  frequency  ultrasound  and  compared  with  the  equivalent  ratios  obtained  from  wholemount  histopathology.  Preliminary  results  show  that  areas  of  suspected  disease  identified  by  spectral  parameters  correlate  with  areas  of  disease  presence  in  the  corresponding  wholemount  sections.  An  initial  software  platform  performing  visualization  of  areas  of  disease  based  on  parametric  maps generated from spectral analysis methods was developed.  

 

 

III   

Acknowledgments 
 

I  would  like  to  acknowledge  the  support  of  all  the  individuals  who  assisted  and  supported  me  through the years of this research. I would like to acknowledge my supervisor Dr. Alireza Sadeghian  for providing me the opportunity to continue my education and reach my goals and without whose  support I would not have been able to accomplish this work.    I  would  also  like  to  acknowledge  and  thank  Dr.  Gregory  Czarnota  for  allowing  me  to  conduct  research  in  his  laboratory  at  Sunnybrook  Health  Sciences  Centre,  and  who  provided  me  with  constant guidance and access to data.   I  wish  to  extend  my  gratitude  to  Dr.  Michael  Kolios  who  as  part  of  my  supervisory  committee  has  assisted  me  in  building  the  fundamental  understanding  of  the  physics  needed  to  progress  with  my  research.    Additionally, I would like to thank all the members of the Czarnota lab team and Sunnybrook Health  Sciences Centre staff who have provided me guidance and assistance through the years.  I  would  like  to  extent  my  gratitude  and  thank  my  colleague  and  fellow  student  Naum  Papanicolau  who throughout the years of my research has proven to be a valuable resource and friend. 
   

 

IV   

Contents 
  Author's Declaration ..................................................................................................................................... II  ....................................................................................................................................................... III  ABSTRACT  Acknowledgments  ........................................................................................................................................ IV  List of Figures ............................................................................................................................................... VI  Chapter 1 ­ Introduction  ...............................................................................................................................  1  1.1  Prostate Cancer .............................................................................................................................  1 

1.2 Ultrasound Imaging .............................................................................................................................  4  1.3 Ultrasound Scattering .........................................................................................................................  7  1.4 Tissue Characterization .....................................................................................................................  12  1.5 Spectral Analysis in Tissue Characterization .....................................................................................  13  1.6 Research Motivation .........................................................................................................................  18  1.7 Contributions .................................................................................................................................... 19  Chapter 2 ­ Materials and Methods ...........................................................................................................  20  2.1 Experimental Design and Data Collection .........................................................................................  20  2.2 Data Analysis ..................................................................................................................................... 25  2.2.1 Spectral Analysis ........................................................................................................................  25  2.2.2 Parametric Image Generation and Analysis ...............................................................................  28  Chapter 3 ­ Results and Discussion ............................................................................................................  31  3.1 Results ............................................................................................................................................... 31  3.2 Discussion  .......................................................................................................................................... 35  Chapter 3 ­ Future Work ............................................................................................................................  37  3.1 Correlation and Validation ............................................................................................................  37  3.2 Optimization of Visualization and Segmentation .........................................................................  38  3.3 Elastography in Tissue Characterization .......................................................................................  40  3.3 Segmentation of Elastography ......................................................................................................  42  Appendix ..................................................................................................................................................... 43  A.1: Software Architecture and Implementation ...............................................................................  43  Figures ......................................................................................................................................................... 51  Tables .......................................................................................................................................................... 75  Bibliography ................................................................................................................................................ 78  V   

 

List of Figures  
  1. Sinusoidal waveform representation of a sound wave.   2.  Longitudinal  representation  of  a  sound  wave  where  the  particle  motion  (rarefaction  and  compression) is parallel with  the direction of propagation (Left). Shear wave representation  of a  sound  wave  where  the  particle  motion  is  perpendicular  to  the  direction  of  wave  propagation  (Right).   3. Pictorial  representation  of  some  of  the  basic  building  blocks  for  an  ultrasound  transducer.  The  electrodes  apply  alternating  potential  difference  causing  a  piezoelectric  effect.  As  a  result  the  piezoelectric  crystal  vibrates  at  a  high  rate  therefore  converting  the  electrical  energy  into  a  mechanical sound wave. The result of the electrical input is a corresponding ultrasound pulse.  4. Representative  Amode  trace  prior  to  envelope  detection  through  the  middle  of  the  prostate  acquired  using  an  Ultrasonix  RP  scanner  with  a  transrectal  probe.  A  typical  transverse  Bmode  image  of  the  prostate  composed  of  multiple  Amode  traces  after  signal  envelope  detection  and  processing to create a quality contrast twodimensional image of the prostate gland  (Right).  5. The  interaction  of  the  incident  plane  wave  of  wavelength  smaller  than  the  object  which  causes  portion  of  the  incident  wave  to  reflect  and  refract.  The  ratio  of  the  incident  wave  to  the  reflected  wave  requires  knowing  the  acoustic  impedance  for  both  mediums  Z1  and  Z2  and  is  dependent on the incident angle 1 and refraction angle 2.   6. Values for the mean and standard deviation for spectral intercept and midband fit. These values  represent  the  data  from  the  learning  set  used  in  training  a  neural  classifier.  The  cancerous  set  was comprised of 29 independent ROI's. The BPH and benign set comprises of a combined set of  60  independent  ROI's.  (Fellepa  at  al,  Typing  of  Prostate  Tissue  by  Ultrasonic  Spectral  Analysis,  1996)  7. (Top)  Highfrequency  ultrasound  images  of  Acute  Myeloid  Leukemia  (AML)  cell  pellets  submerged  into  saline  buffer  then  treated  with  chemotherapeutic  agent  cisplatinum  for  0,6,12,24  and  48  hours  inducing  a  variable  degree  of  apoptotic  cell  death.  (Bottom)  Representative  corresponding  histological  analysis  stained  with  H&E,  depicting  the  degree  of 

VI   

apoptotic  cells  present  in  the  pallet.(Czarnota  et  al,    Ultrasound  imaging  of  apoptosis:  high resolution noninvasive monitoring of programmed cell death in vitro, in situ and in vivo,1999)  8. (First  row)  Representative  lowfrequency  ultrasound  images  of  PC3  tumors  indicating  variability  in  echogenisity  depending  on  treatment  regimen.  In  left  to  right  order:  untreated  tumor,  8  Gy  radiation,  antivasculature  microbubble  treatment  and  8Gy  radiation  followed  by  ,  anti vasculature  microbubble  treatment.  (Second  row)  Normalized  power  spectra  taken  before  treatment and 24 hours following treatment for each group.  (Third row) Low  magnification light  microscopy  images  of  TUNEL  stained  PC3  tumor  slices.  (Forth  row)  Light  microscopy  images  of  H&E  stained  PC3  tumor  slices  at  high  magnification.  (Papanicolau,  Conventional  frequency  ultrasound detection of tumor response in vivo to cancer treatment administration,2009)  9. Schematic of the biplanar transrectal probed used in this experiment. (Courtesy of Vermon S.A.)  10. Schematic of the direction of the scan and the probes realive position to the prostate gland.  11. Depiction of 6 dB analysis window determined from the power spectra of the reference pulse.  12. The  red  curve  is  a  representative  power  spectra  corresponding  to  an  ROI  representative  of  the  entire  prostate  grand.   The  black  curve  is  a  power  spectra  collected  from  a  phantom  to  be  used  for  normalization,  taken  with  the  same  machine  settings  as  the  one  collected  from  tissue.  The  blue curve is the resulting normalized power spectra obtained from the subtraction of the tissue  power  spectra  by  the  phantom  power  spectra.  The  linear  regression  is  shown  with  the  yellow  line corresponding to the 6dB analysis window.  13. The main steps followed in our analysis mechanism are illustrated here starting with the Bmode  reconstruction  from  raw  RF  data  shown  on  the  left  most  of  the  image.  The  second  step  is  the  generation  of  the  parametric  images  for  each  of  the  three  spectral  parameters  under  investigation.  The  second  image  is  a  representative  parametric  image  generated  using  the  mid band  fit  parameter.  The  second  last  image  is  the  corresponding  image  of  the  manual  segmentation  of  the  parametric  image  in  which  only  the  areas  of  the  prostatic  gland  are  included.  Also  in  this  stage  the  threshold  value  is  discovered  and  in  turn  applied  to  all  the  parametric slides for each prostate. In the last phase only the thresholded areas where the MBF  parameter  suggests  high  likelihood  of  carcinoma  presence  in  the  prostate  are  extracted.  The  areas  within  the  bounds  of  the  prostate  still  present  in  the  image  are  then  added  to  compute  the total are of suspicion.  14. Top  row  displays  ultrasound  images  reconstructed  from  RF  data.  Each  individual  image  represents  a  stationary  plane  through  the  prostate  in  the  direction  base  to  apex.  All  the  images  shown  are  obtained  from  one  representative  patient  and  are  separated  by  a  5  mm  gap  in  VII   

between.  The  second  row  displays  the  resulting  parametric  images  of  the  MBF  parameter  from  the  same  planes  obtained  as  a  result  of  spectral  analysis.  The  third  row  displays  the  resulting  parametric  images  of  the  spectral  intercept  obtained  from  the  same  planes.  The  last  row  displays  the  corresponding  slices  obtained  from  histological  analysis.  The  histology  slice  are  representative 4 µm slices obtained from 5 mm blocks which correspond to the same regions for  which  the  ultrasound  RF  data  was  collected.  On  the  histology  images  areas  of  prostatic  carcinoma  are  contoured  with  green  color.  Areas  of  abnormal  glandular  activity  are  contoured  in orange.  15. A graphical representation of the MBF percent area versus the corresponding percent area from  the histopathological findings for all the steps collected from Patient 1 (Left). A linear regression  analysis  is  showing  with  the  solid  line.  The  0MHz  spectral  intercept  versus  the  hisptopathological  analysis  corresponding  to  the  percent  disease  area  as  well  as  a  linear  regression noted with a solid line (Right).  16. Cumulative scatter plot depicting the percent disease area obtained from MBF parameter versus  the  percent  disease  area  obtained  from  histological  analysis.  The  data  shown  in  this  graph  represents  all  the  data  pairs  from  individual  steps  collected  for  the  entire  patient  population  which  participated  in  the  study.  The  solid  line  represents  the  best  fit  line  obtained  from  liner  regression with the corresponding 95% confidence interval is depicted with a broken line.  17. Cumulative  scatter  plot  depicting  the  percent  disease  area  obtained  from  the  spectral  intercept  parameter  versus  the  percent  disease  area  obtained  from  histological  analysis.  The  data  shown  in  this  graph  represents  all  the  data  pairs  from  individual  steps  collected  for  the  entire  patient  population  which  participated  in  the  study.  The  solid  line  represents  the  best  fit  line  obtained  from  linear  regression  with  the  corresponding  95%  confidence  interval  depicted  with  a  broken  line.  18. In  this  graph  the  each  point  represents  a  patient  who  participated  in  or  study.  The  Yaxis  shows  the  average  percent  disease  area  computed  from  all  the  slides  belonging  to  the  patient.  The  X axis  is  the  average  percent  disease  area  calculated  by  adding  the  results  of  histopathological  analysis  of  each  slide  pertaining  to  the  patient.  The  solid  line  represents  the  linear  regression  goodness of fit with the 95 % confidence interval shown in the broken line.  19. In  this  graph  the  each  point  represents  a  patient  who  participated  in  or  study.  The  Yaxis  shows  the average 0MHz intercept percent disease area computed from all the slides belonging to the  patient.  The  Xaxis  is  the  average  percent  disease  area  calculated  by  adding  the  results  of 

VIII   

histopathological  analysis  of  each  slide  pertaining  to  the  patient.  The  solid  line  represents  the  linear regression goodness of fit with the 95 % confidence interval shown in the broken line.  20. High  level  conceptual  model  of  application  architecture  depicting  the  various  layers  and  their  scope.  The  vtkDotNetWrapper  acts  a  middleware  layer  of  communication  joining  the  native  .NET framework with the VTK win32 librariers.  21. Representative elastrogram obtained from the same patient shown in Figure 14. The elastogram  was  obtained  using  Ultrasonix  RP  ultrasound  system  with  a  curvilinear  transrectal  transducer  pulsed  at  10  MHz  with  a  sampling  frequency  of  20  MHz.   The  color  bar  on  the  right  hand  side  shows the color distribution corresponding to the relative tissue stiffness distribution.  22. A  visual  representation  of  the  various  components  comprising  of  the  Spectral  Analysis  Module.  Each  individual  component  communicates  with  the  rest  through  a  system  of  delegates  passing  through the Main Container.  23. An illustration of the communication pathways between the various components in the Spectral  Analysis  Module.  In  this  scenario,  the  System  Control  invokes  a  frame  change  event  (  the  frame  number  from  an  multiframe  ultrasound  file)  with  the  Main  Control.  Since,  all  the  available  components  are  registered  with  the  Main  Control;  the  Main  invokes  a  global  change  frame  event.  24. Visual  representation  of  the  display  pipeline  utilized  by  the  Display  Control  component.  The  visualization  pipeline  above  the  dashed  line  shows  the  VTK  objects  utilized  in  the  visualization  process  prior  to  rendering.  The  red  arrows  delineate  the  classes  which  define  how  the  dataset  will  be  visualized.  These  objects  can  encompass  various  filters  and  functions  which  define  the  visualization  properties  of  an  object  and  may  include  color,  opacity,  lighting,  texture,  etc.  The  path  shown  with  black  arrows  shows  the  path  which  the  dataset  takes  from  the  basic  structure  through  the  various  filters  which  change  the  state  of  the  data  to  create  the  volume  prior  to  rendering.  Bellow  the  dashed  line  is  the  graphical  pipeline.  Once  the  volume  object  is  created  and  the  visualization  properties  are  added,  the  volume  object  undergoes  through  the  rendering  process. Finally the result of the rendering process is displayed by the rendering window.  25. An  illustration  of  the  steps  taken  in  generating  parametric  images  from  spectral  parameters  using  a  sliding  window  algorithm.  Step  1  defines  the  size  of  the  sliding  window,  referring  to  the  number  of  scan  lines  (x  direction)  and  number  of  data  points  per  scan  line  (y  direction).  The  window  is  used  to  compute  the  spectral  values  pertaining  to  the  position  at  the  center  of  the  window.  The  second  step  is  the  extraction  of  the  data  point  required  to  compute  the  averaged  power  spectra  for  the  window  in  the  current  position.  The  third  step  involves  the  normalization  IX   

of  the  averaged  power  spectra  and  computation  of  the  values  for  each  individual  spectral  parameter,  MBF,  0MHz  intercept  and  spectral  slope.  The  values  are  placed  in  separate  data  arrays and the window changes position by one scan line in the X direction. Once the end of the  scan lanes has been reached, the sliding window changes position back to the first scan line and  window  size  down  in  the  Y  direction.  Once  the  sliding  window  has  traversed  the  entire  image,  the  resulting  parametric  images  are  displayed  for  the  user  to  apply  custom  color  transfer  functions.  When the process is performed on an ultrasound volume, the sliding window repeats  the process over to the next available frame   

X   

Chapter 1 ­ Introduction  
1.1 Prostate Cancer 
Prostate cancer is among the leading cancer related deaths in men, with a high number of newly  diagnosed  cases  yearly.  The  United  States  of  America  National  Cancer  Institute  reported  192,280  new  cases  prostate  cancer  diagnosis  in  2009,  the  same  year  27,360  patient  deaths  were  reported  as  a  result  of  prostate  cancer  [1].   Prostate  cancer,  most  frequently  adenocarcinoma  of  the  prostate  with  a  tumor  growth  rate  varying  from  slow  to  moderate,  is  generally  considered  to  respond  successfully  to  available  treatments.  Current  acceptable  treatments  vary  based  upon  the  stage  of  disease  and  the  overall  health  of  the  patient.  Radical  prostatectomy  is  a  surgical  method  reserved  for  stage  I  and  II  disease  where  the  patient  is  in  good  overall  health  and  the  tumor  is  localized  in  the  prostate  gland  [2,  3].  Postsurgery,  during  a  typical  course  of  a  patient's  treatment  the  institution  providing  the  treatment  performs  a  pathological  assessment and  diagnosis  of the extracted  tissue.  The main goal for this assessment from a  clinical  care  provider's  perspective  is  to  evaluate  the  margins  of  the  prostate.  In  this  procedure,  the  tissue is evaluated under  high magnification light microscopy in order to determine the  proximity of  the  disease  to  the  boundaries  of  the  prostatic  gland.  The  findings  of  pathological  assessment  yield  negative  margins  when  there  is  no  disease  present  at  the  boundaries  of  the  prostate.  Positive  margins  are  an  indication  that  the  borders  of  the  prostatic  gland  have  tumour  presence  which  in  turn  translates  to  a  high chance of the disease having spread outside of the prostatic gland. Since pathological assessment is  the  current  standard  in  patient  care  we  adopted  a  similar  but  more  extensive  method  to  evaluate  the  performance  of  the  spectral  parameters.  Patients  with  clinically  confirmed  cancer  present  in  the  prostate  gland  and/or  surrounding  tissue  (  stages  I,  II)  or  patients  with  stage  III  disease  (invasion  of  deeper  tissue),  generally  undergo  definitive  externalbeam  radiation  therapy  [1,  4].    Other  treatment  modalities  being  practiced  and  investigated  in  clinical  settings  include  interstitial  brachytherapy, 

1   

hormonal treatment, cryosurgery, postoperative radiation delivery and cytotoxic agents [1]. The average  age,  at  clinical  diagnosis  for  prostate  cancer  in  men  is  72  years  of  age,  but  it  can  be  much  earlier  with  PSA  testing.   Treatment  options  are  largely  influenced  by  age  and  the  general  health  of  the  patient  as  coexisting  medical  problems  can  make  certain  treatments  unavailable  [1].  It  is  a  common  belief  that  early  detection  of  the  disease  can  improve  treatment  options  as  well  as  long  term  survival  rate  of  patients.   Screening of patients for prostate cancer is a very controversial topic; studies have shown mixed  results  and  lack  of  direct  benefits  with  respect  to  prostate  cancer  mortality  rates  of  screened  patients  [5]. A wellknown screening  mechanism available to  clinicians  has been digital  rectal examination  (DRE).  A study performed in Sweden attempting to evaluate the benefits of DRE screening which included 9026  men  between  the  ages  of  50  to  69  found  no  difference  in  the  mortality  rate  between  screened  patients  and  control  unscreened  patients.   The  1494  patients  who  were  screened  with  DRE  in  a  3  year  interval  revealed  a  prostate  cancer  related  mortality  rate  of  1.3%  (20  patients).  The  same  1.3%  mortality  rate  was  also  observed  in  the  control  group  of  7532  with  97  cancer  related  deaths  [6].  In  the  late  1980s  prostate  specific  antigen  (PSA)  assays  became  widely  available  for  screening  purposes.  Prostate  specific  antigen based testing has proven to add additional value in increasing the number of early detections of  prostate  tumor.  This  method  is  relatively  cost  effective  and  reproducible  and  has  added  a  more  objective  set  of  criteria  to  the  screening  process.  Even  though  it  has  been  shown  that  there  is  no  PSA  level  which  is  necessary  cancerfree,  the  value  of  4.0  ng/ml  is  often  used  as  a  cutoff  for  further  examination  and  biopsy  [7].  A  10  year  case  study  reported  that  71%  of  patients  with  PSA  levels  above  4.0  ng/ml  had  clinically  significant  cancer  in  a  5  year  span  with  91%  specificity  over  10  years  [8].  It  is  believed  that  lowering  the  PSA  level  cutoff  will  increase  the  number  of  prostate  cancer  detections,  however  it  will  also  increase  the  risk  of  false  positive  patients  being  subjected  to  biopsy  procedure,   which  is  both  expensive  and  could  cause  further  complications  in  a  patient's  overall  health  [9].  It  has  2   

been  demonstrated  that  in  65  ­  83%  of  men  with  high  PSA  levels,  during  the  course  of  1  year  the  PSA  levels  to  return  back  to  normal  [1012].  Several  causes  have  been  identified  as  reasons  for  men  to  have  elevated  PSA  levels,   some  of  which  are  biological  in  their  nature  and  others  pharmaceutically  induced  [13].    Imaging of the prostate gland for the purpose of screening and diagnosis is feasible using various  imaging  modalities  such  as  magnetic  resonance  imaging  (MRI),  computed  tomography  (CT)  and  ultrasound.  These  imaging  modalities  are  characterized  by  their  merits  and  disadvantages.  Even  though  they  all  possess  the  capability  of  successfully  imaging  the  prostate,  transrectal  ultrasound  (TRUS)  is  the  most  commonly  used  method.  The  reason  for  this  is  attributed  to  the  relatively  low  cost  of  modern  ultrasound  systems  in  combination  with  high  portability  and  safety.  Unlike  MRI  and  CT,  TRUS  employs  no  contrast  agent  or  ionizing  radiation,  respectively.  In  terms  of  ultrasound  it  does  not  induce  any  significant biothermal effects when used at clinically acceptable settings [14, 15]. The use of TRUS as an  evaluation  tool  for  patients  with  prostatic  carcinoma  has  demonstrated  to  have  a  sensitivity  range  from  71%  to  92%  for  carcinoma  of  the  prostate  and  60%  to  85%  for  subclinical  tumors.  Even  though  TRUS  indicates  promising  results  in  its  ability  to  detect  prostatic  disease,  it  is  generally  used  as  a  diagnostic  followup  technique  rather  than  an  initial  screening  modality.    Transrectal  ultrasound  is  the  primary  imaging modality widely used in contemporary prostate biopsies. There is evidence to suggest that TRUS  guided biopsies have ultimately increased the detection capabilities of biopsies by targeting areas with a  high  likelihood  of  disease  presence  [16,  17]  .    Considering  the  vital  role  that  TRUS  imaging  plays  in  clinical care, investigating its full capabilities in combination with advancements in signal processing and  analysis,  can  potentially  add  additional  benefits  to  screening  and  monitoring  mechanism  that  are  currently in place for prostate cancer patients.  This work investigates the use of TRUS in clinical settings  in combination with spectral analysis methods as a detection and treatment monitoring modality. 

3   

1.2 Ultrasound Imaging  
Acoustic  waves  are  a  form  of  mechanical  pressure  transporting  energy  as  they  travel  through  a  conducting  medium  creating  alternating  particle  compression  and  rarefaction  areas.  Sound  wave  propagation  can  be  described  as  a  sinusoidal  waveform  with  a  characteristic  pressure  (p),  wavelength  (),  frequency  (f)  and  velocity.  Figure  1  shows  a  typical  sinusoidal  waveform  representation  of  a  sound  wave  with  some  of  its  defining  characteristics.      When  acoustic  waves  travel  in  parallel  to  a  particle's  motion  they  are  called  longitudinal  waves.  This  type  of  motion  is  observed  predominately  in  fluids.  In  solids  there  are  two  types  of  wave  propagation,  longitudinal,  and  shear  waves,  the  latter  where  the  direction of the wave is perpendicular to a particle's motion. Figure 2 depicts such particle movement in  relation to direction of the propagation. Ultrasound is a form of an acoustic wave where the frequency is  greater  than  20  kHz,  the  upper  limit  of  human  hearing.    In  modern  ultrasound  imaging  systems  the  ultrasound wave is generated when an electric current is applied to the piezoelectric crystals comprising  the  ultrasound  transducer  array.  The  principle  of  piezoelectric  effect,  which  has  allowed  for  such  technology  to  be  developed,  was  first  discovered  by  the  Currie  brothers  when  they  observed  that  by  exerting mechanical pressure to certain crystals an electric potential would be created. The reciprocal of  that  behavior  was  proven  in  1881  by  physicist  Gabriel  Lippman  who,  using  thermodynamic  principles  proved  that  a  mechanical  deformation  can  be  created  when  applying  a  voltage  differential  to  piezoelectric  crystals.  Figure  3  is  a  representation  of  a  typical  single  element  transducer.  The  electrodes  placed  at  the  sides  of  the  piezoelectric  crystal  create  an  alternating  potential  difference  at  a  resonant  frequency which in turn due to the properties of the crystal causes the crystals to vibrate at the selected  frequency. This mechanism converts electrical energy to mechanical sound waves, and since the process  is  done  at  very  high  frequencies  the  output  is  an  ultrasound  pulse.  The  reverse  occurs  when  the  ultrasound  wave  reflects  back  from  the  object  under  investigation.  The  mechanical  wave  front  hits  the  transducer's  piezoelectric  crystal  which  in  turn  then  vibrates  creating  a  potential  difference.  The  4   

amplitude  of  the  voltage  in  the  created  current  can  be  considered  equivalent  to  the  pressure  amplitude  of the ultrasound wave.   Ultrasound  transducers  employ  a  "pulseecho"  technique  where  the  electrical  signal  stimulating  the  piezoelectric  crystal  is  not  continuously  on.  This  allows  the  ultrasound  transducer  to  first  emit  an  ultrasound pulse then receive the reflection of the pulse which is called the echo. By calculating the time  it  takes  for  the  pulse  to  reach  the  target  and  for  the  echo  to  return  to  the  source  the  distance  between  the  source  and  the  target  can  be  estimated  assuming  a  set  velocity  of  the  ultrasound  wave  through  the  medium.  When  plotting  the  pressure  amplitude  estimated  by  the  voltage  values  versus  time,  the  distance  to  the  object  can  be  estimated.  This  is  typically  called  an  Amode  scan.  Since  an  Amode  scan  can  only  measure  distance  in  onedimensional  space,  this  method  alone  cannot  be  used  for  imaging.  This  technique  nevertheless  was  first  used  successfully  by  the  military  in  SONAR  (sound  navigation  and  ranging)  technology  where  in  a  pulseecho  manner  underwater  ultrasound  waves  were  used  to  locate  and  range  the  distance  of  submerged  objects  such  as  submarines.  When  combining  multiple  Amode  traces,  either  by  doing  a  sweep  of  the  object  with  a  single  element  transducer  or  by  combining  multiple  elements  into  an  array,  a  twodimensional  trace  of  the  object  can  be  created  and  an  image  formed.   By  taking  the  signal  envelope  of  each  individual  Amode  trace  and  assigning  brightness  values  to  the  corresponding intensities  of the reflected echo signal, information regarding  the reflection  properties of  the  propagating  medium  can  be  displayed  as  an  image  commonly  using  a  gray  scale.  Given  that  the  B mode  image  is  constructed  from  multiple  Amode  traces  often  the  vertical  axis  in  a  Bmode  image  represents  the  depth  and  the  horizontal  axis  the  width  of  the  investigating  object.  The  gray  value  of  each  pixel  in  the  resulting  image  represents  the  power  of  the  reflected  signal  at  that  position  in  space.  Figure  4  presents  a  representative  twodimensional  transverse  image  of  the  prostatic  gland  acquired  using an Ultrasonix RP system with a transrectal ultrasound curvilinear array transducer on the right and  on the left a representative Amode trace through the center of the prostate at the position indicated by  5   

the  vertical  dashed  line.  Visually  one  can  correlate  the  "spikes"  in  amplitude  in  the  Amode  trace  to  areas of higher brightness at the corresponding position in the Bmode image.       

6   

1.3 Ultrasound Scattering  
Ultrasound  imaging  captures  interactions  of  an  ultrasound  wave  with  the  propagating  medium  (often  tissue).  Physical  properties  of  the  propagating  medium  can  have  significant  effects  on  the  backscatter  signal  and  the  resulting  obtained  image.  The  acoustic  properties  of  the  material  are  significant  in  ultrasound  imaging,  since  images  are  constructed  from  the  echo  signal  reflected  from  the  medium. The reflection is a result of an acoustic impedance difference between the materials within the  medium.  The  acoustic  impedance  of  a  material  is  a  property  defined  as  the  product  of  the  materials  density  and  the  speed  of  sound  within  the  medium;  with  units  of  measure  are  Rayls  (kg/m2/s).  Acoustic  impedance  is  a  characteristic  property  of  the  material  and  does  not  depend  on  the  frequency  of  the  sound pulse [15]. The equation for acoustic impedance is given by:      where  Z  is  the  acoustic  impedance,   is  the  density  of  the  material  and   is  the  speed  of  sound  in  the  material.  The  speed  of  sound  also  can  vary  based  on  the  composition  of  the  material;  thus  speed  of  sound can be derived from the following equation:    1  

 

 

2

 

where   is  the  speed  of  sound  in  m/s  ,   is  the  bulk  modulus  describing  the  compressibility  of  the  material  (the  change  in  pressure  that  is  required  to  decrease  the  volume  of  the  material,  measured  in  Pascals), and    the material density in kg/m3 .     There  is  a  direct  relationship  between  the  wavelength  of  the  incident  ultrasound  pulse  and  the  source  causing  the  backscatter.  This  relationship  can  be  grouped  into  3  types  of  interactions:  specular,  diffuse  and  diffractive  scattering.  In  general  the  intensity  of  reflected  sound  wave  is  a  function  of  the  7   

cross section of the scatter and the intensity reflection ratio (RR) of the scatter. Figure 5 is an illustration  of  the  interaction  of  a  planar  incident  wave  with  mediums  of  varying  acoustic  impedance.  When  the  cross  section  of  the  medium  (homogeneous)  is  greater  in  order  of  magnitude  compared  to  the  wavelength  then  reflection  and  refraction  occur.  In  this  scenario  when  the  wavelength  of  the  incident  wave  is  very  small  compared  to  the  size  of  the  scatterer,  the  reflection  process  can  be  approximated  by  rays  incident  to  a  flat  surface  where  the  scattered  wave  front  is  a  replica  of  the  shape  of  the  scattering  object.  The  associated  reflection  ratio  is  a  result  of  acoustic  impedance  mismatch  between  the  coupling  and the scatter medium.  The reflection ratio is described by:   

   

 

3

 

RR  is  the  reflection  ratio  and  Z1 and  Z2  which  are  the  acoustic  impedances  of  the  propagating  medium  and the scattering body respectively. This relation is independent of the insonifying frequency.    Tissue  however  is  comprised  of  small  heterogeneous  structures  with  asymmetric  surfaces.  The  employed  ultrasound  beam  that  interacts  with  tissue  is  scattered  in  many  directions  by  small  sub wavelength  point  scatterers.  This  type  of  interaction  is  considered  to  be  independent  of  the  incident  wave  and  it  is  termed  diffuse  scattering  and  the  tissue  scatterers  are  termed  Rayleigh  scatters.  The  portion  of  the  wave  that  is  scattered  back  to  the  source  is  known  as  the  backscatter  echo  signal.  The  intensity  of  the  scattered  wave  under  such  conditions  varies  by  the  fourth  power  of  frequency  as  was  discovered  to  by  Lord  Rayleigh  [15].    Lord  Rayleigh  derived  the  ratio  between  the  intensity  of  the  incident  wave  and  the  scattered  intensity  from  rigid  spheres  of  a  diameter  much  smaller  than  the  wavelength as follows: 

8   

   

3 1 9 1 2

/ /

cos

1

 

4

 

where  IS    is  the  scattering  intensity,  Ii  the  incident  intensity    and  the  subscripts  1,  2  indicating  the  properties  of  the  scattering  object  and  that  of  the  surrounding  medium  respectively.  Density  is  denoted  by   and   is  the  compressibility,   is  the  radius  of  a  scatterer  sphere,     the  scatter  distance  from  the  source,   is the relative angle to the incident wave and k is the wave number, which is described by:  2

    Compressibility   is given by: 

 

5

 

   

1

 

6

 

where   is  the  wavelength,    is  the  density,  and   is  the  speed  of  sound.   In  typical  clinical  frequencies  (<  15  MHz),  the  scattering  interactions  can  be  approximated  as  Rayleigh  scatters  because  the  wavelength  of  the  ultrasound  pulse  is  orders  of  magnitude  larger  when  compared  with  the  micro structural  tissue  scatterer  sizes  which  are  on  the  order  of  tens  of  microns.  As  a  result  the  backscatter  signal  intensity  is  dependent  on  the  fourth  power  of  the  incident  frequency  and  the  sixth  power  of  the  scatter's diameter [15].   The  third  type  of  scattering  occurs  when  an  isonifying  wavelength  is  proportional  to  the  size  of  the  scattering.  This  diffracting  scattering  scenario  was  described  for  sound  by  Faran  in  1951  and  is 

9   

known  in  optics  as  Mietype  scattering  [15,  18,  19].  The  solution  for  the  scattering  caused  by  elastic  spheres in water was derived by Faran as:  2

   

cos

 

7

 

where  Jn  and  Yn  are  Bessel  spherical  functions  of  first  and  second  order,   is  the  relative  angle  to  the  incident  wave  which  is  equal  to   for  backscatter,   is  the  nth  order  of  Legendre  polynomial  and   is 

the coefficient defined by the boundary conditions between the sphere and the surrounding medium.   Another important factor that can affect the intensity of the backscattered signal is attenuation.  Attenuation  can  be  defined  as  continuous  loss  of  mechanical  energy  as  the  ultrasound  pressure  wave  propagates  through  the  tissue.  The  predominant  cause  for  the  loss  in  pressure  amplitude  is  absorption  in  which  the  incoming  energy  is  converted  to  thermal  energy.  Attenuation  is  a  function  of  the  pulse  or  sound frequency, the penetration depth and the attenuation coefficient of the medium and is defined as  follows:      where   is  the  attenuation,   is  the  attenuation  coefficient  of  the  medium  given  in  ( / ),       8  

the  distance  traveled  through  the  medium,     the  frequency  of  the  ultrasound  pulse.  Because  attenuation  is  frequency  dependent,  the  penetration  depth  which  can  be  imaged  is  also  dependent  upon the frequency employed within a medium with the same attenuation coefficient.    In  general  the  intensity  of  the  backscatter  signal  is  a  complex  scattering  interaction  affected  by  the physical  properties of  the scattering source such as the effective size of  the scatterer, concentration  10   

of  the  scatterers  in  the  medium,  their  density  and  compressibility  and  physical  distribution  in  the  medium.  Given  the  complex  interactions  between  the  ultrasound  pulse  and  the  physical  properties  of  the effective scatterers in tissue, a 2dimentional intensity map (Bmode) is not sufficient to describe the  characteristics  of  the  underlying  medium,  and  thus  more  sophisticated  quantitative  techniques  are  necessary  to  gain  more  detailed  information  regarding  the  underlying  characteristics  of  the  micro structure.     

11   

1.4 Tissue Characterization  
Since a conventional Bmode ultrasound image is reconstructed by taking the signal envelope of  the  backscatter  radiofrequency  (RF)  signal,  which  then  is  processed  by  various  filters  to  increase  signal  and  decrease  noise,  a  significant  amount  of  information  generated  by  the  scattering  medium  is  lost.  B Mode  images  can  also  vary  based  on  the  ultrasound  machine  being  used  and  user  specified  settings,  making  it  difficult  to  achieve  unified  objective  interpretations  or  draw  definitive  clinically  relevant  conclusions in the absence of standardization. Ultrasound tissue characterization utilizes various analysis  techniques  of  the  backscattered  ultrasound  signal  in  order  to  generate  quantitative  measurements  regarding  the  underlying  tissue  microstructure.  Quantitative  ultrasound  (QUS)  techniques  employ  various  methods  of  analyzing  the  backscattered  radiofrequency  signal  to  interpret  various  acoustic  properties  and  relate  them  to  features  of  the  tissue  microstructure.  One  such  technique  is  known  as  spectral  analysis  which  evaluates  parameters  derived  from  the  frequency  distribution  of  the  backscattered  signal.  This  technique  has  been  demonstrated  to  possess  the  capacity  to  differentiate  between  various  tissue  types  [20].  Statistical  methods  can  also  be  used  to  analyze  the  amplitude  distribution  of  the  backscattered  signal  envelope.  Additionally    new  emerging  tissue  characterization  quantitative  algorithms  have  been  developed  and  used  to  utilize  the  ultrasound  backscatter  signal  to  measure the elastic properties of tissues in order to distinguish tissue structures.         

12   

 1.5 Spectral Analysis in Tissue Characterization 
Power spectrum analysis is a quantitative ultrasound method that can be used to investigate the  scatterer  properties  within  tissue  when  interacting  with  an  ultrasound  pulse.  The  foundation  for  quantitative  ultrasound relies on  converting the  echo signals of  the  transducer from  the time  domain to  the  frequency  domain,  (often  by  applying  a  Fourier  transform)  and  interpreting  the  frequency  distribution  of  the  backscattered  signal  which  normally  is  not  utilized  during  Bmode  image  formation.  Ultrasound  spectral  analysis  has  been  used  successfully  as  a  framework  capable  of  distinguishing  tissue  types  largely  through  the  work  of  investigators  such  as  Lizzi  and  Fellepa  etc  [20,  21].  A  theoretical  framework  using  spectral  analysis  was  established  by  Lizzi  et  al  in  which  he  demonstrated  use  of  this  analytical  analysis  model  of  echo  signals  relating  them  to  tissue  acoustic  properties  [22]  .  In  several  studies performed  by this  group, the use of tissue characteristics such as scatter size, concentration and  acoustic  impedance  where  compared  with  clinical  data  and  theoretical  models  [2326].    It  was  demonstrated  that  the  analysis  of  the  frequency  distribution  of  the  backscatter  echo  signal  can  provide  complementary  information  in  distinguishing  tissue  types  of  the  retina,  liver,  lymph  nodes  and  prostate  [24,  2629].  The  analytical  model  put  forth  by  Lizzi  is  a  three  part  process.  In  his  method  RF  data  are  acquired  and  the  power  spectrum  is  calculated,  the  power  spectrum  is  then  normalized  to  remove  any  system  transfer  functions  and  parameters  from  linear  regression  of  the  normalized  power  spectra  (or  a  fitted  model)  are  obtained  and  related  to  known  tissue  features.  The  power  spectra  in  this  thesis  were  computed  as  the  magnitude  of  the  Fourier  Transform  values  squared  for  each  individual  RF  scan  line  (intensity values). In the case of a broadband linear array transducer the power spectra can be averaged  across scan lines. Calibration of the spectrum is performed to remove changes in the shape of the power  spectrum  curve  added  by  the  transfer  function  of  electromechanical  characteristics  of  the  transducer  and  other  associated  electronic  components  in  the  acquisition  system.  A  planar  reflector  placed  perpendicular  to  the  ultrasound  beam  at  the  center  of  focal  area  often  a  glass  plate  or  metal  sheet  13   

(strong  reflectors)  (or  a  tissue  mimicking  phantom),  can  be  utilized  to  obtain  power  spectra  for  calibration.  In  this  method,  Lizzi's  group  divides  the  power  spectrum  obtained  from  tissue  by  the  one  obtained  from  a  strong  reflector.    The  normalization  process  ensures  that  the  shape  of  the  remaining  normalized  power  spectrum  best  fits  the  result  of  the  ultrasound  beam  with  the  tissue.  Normalized  power  spectra  are  often  expressed  in  decibels  relative  to  the  calibration  curve  (dBr).    Lizzi  has  demonstrated  that  the  amplitude  of  normalized  power  spectra  can  vary  according  to  the  type  of  tissue  structure. In the case of diffuse vitreous hemorrhages where Rayleigh scattering has been observed, the  amplitude  obtained  from  power  spectra  is  10  dB  lower  then  power  spectra  obtained  from  asteroid  hyalosis.  Moreover,  by  applying  a  linear  regression  based  bestfit  line  to  the  normalized  power  spectra  tissue  determining  spectral  parameters  can  be  extracted:  midband  fit  as  an  indication  of  the  overall  level  of  integrated  backscatter,  the  spectral  slope  of  the  bes  fit  line  on  the  normalized  power  spectrum  as an indication of the average scatter size and the 0MHz intercept of the bestfit line as an indicator of  the  scatter  concentration.   The  midband  fit  parameter  is  the  value  obtained  from  the  midpoint  of  the  bestfit  line  within  the  analysis  window.  As  an  indicator  of  overall  integrated  backscatter  the  midband  fit  parameter  is  dependent  upon  scatter  shape,  size,  acoustic  impedance,  concentration  and  distribution. The spectral slope is the slope of the resulting linear regression best fit line in the selected  6  dB  bandwidth  and  is  related  to  the  average  scatterer  size  within  the  tissue.   The  0MHz  parameter  is  obtained  by  extending  the  line  of  best  fit  outside  the  analysis  bandwidth  in  order  to  obtain  the  amplitude value at the 0MHz point which has been theoretically correlated by Lizzi to the concentration  of scatterers within the propagating medium.  Feleppa  has  shown  encouraging  results  in  determining  the  range  of  ultrasonic  spectral  parameters  in  histopathologically  positive  prostate  samples  in  comparison  with  disease  free  prostate  samples  where  a  decrease  of  approximately  10  dBr  in  the  midband  fit  and  the  0MHz  intercept  parameter  was  indicated  [30].  In  his  work,  Feleppa  uses  neural  net  classifiers  to  predict  likelihood  of  14   

malignancy in the prostate which is then compared to disease free tissue [3133]. Figure 6 demonstrates  the  mean  and  the  standard  deviation  between  the  three  main  types  of  clinically  relevant  tissue  present  in  the  prostate,  computed  from  independent  ROI's  corresponding  with  the  biopsy  sites  [30].  In  this  figure  Fellepa  et  al  present  data  which  make  up  a  neural  net  learning  set  including  29  regions  with  confirmed  cancer  and  combined  60  regions  of  confirmed  BPH  and  benign  tissue  [30].  The  method  used  to  differentiate  between  malignant  and  benign  tissue  incorporated  a  database  of  known  biopsy  tissue  samples,  ultrasound  RF  data  collected  prior  to  biopsy,  histological  results  of  the  biopsy  for  comparison,  as well as patient characteristics such as PSA levels and age among other parameters. Multidimensional  vectors  created  from  the  parameters  serve  as  inputs  to  the  neural  net  classifier,  which  was  initially  trained  on  a  subset  of  the  data  in  order  to  establish  the  proper  network  weights  and  the  layer  depth  of  the  multilayer  perceptron.    After  iterations  of  the  training  set,  the  classifier  was  then  provided  the  remaining  data  for  verification  and  comparison  with  histopathological  findings.    Receiver  operator  curves  (ROC)  were  then  used  to  measure  the  performance  of  the  classifier.  An  approximate  30%  increase in detection was demonstrated through the use of the multilayer perceptron classifier, with the  ROC  curve  areas  of  0.844  +/0.018  in  comparison  to  the  level  of  suspicion  (LOS)  method  used  by  urologist with an ROC area of 0.638 +/ 0.029 [34].    Different    research  initiated  by  Kolios  and  Czarnota    demonstrated  that  spectral  analysis  was  successfully  able  to  detect  morphological  changes  in  cellular  structure  as  a  result  of  cancer  therapy  administration  in  cell  pellets  [19,  3537].    Exposing  cell  samples  comprised  of  acute  myeloid  leukemia  (AML) cells to the chemotherapeutic agent cisplatin which induces apoptotic cell death, resulting in cells  undergoing  canonical  apoptotic  morphological  and  structural  changes  of  membrane  blebbing,  nuclear  condensation  and  fragmentation.  High  frequency  ultrasound  (2030  MHz)  was  used  to  collect  data  at  0,  24,  48  and  72  hours  after  cisplatin  exposure  and  revealed  an  increase  in  backscatter  echogenicity  proportional  to  increase  in  apoptotic  cell  death  determined  through  histology  [35,  36].  Figure  7  15   

illustrates  representative  ultrasound  images  of  AML  cell  samples  obtained  at  25  MHz  ultrasound  and  also high magnification histological images to demonstrate  the degree of apoptotic cell death. Increases  in  signal  backscatter  were  found  to  show  a  good  correlation  to  increased  levels  of  apoptotic  cell  death  by  comparing  the  ultrasound  signal  intensity  and  features  with  corresponding  immunohistochemistry  stained cytological samples. Apoptotic changes in cell morphology corresponded to increases of up to 25  times in ultrasound backscatter signal intensity [35, 36, 38].   The  work  done  by  Vlad  et  al  recently,  demonstrated  the  ability  of  spectral  analysis  to  detect  tissue  changes  at  a  cellular  level  in  an  in  vivo  mouse  model.  The  use  of  spectral  analysis  of  high frequency  ultrasound  (15  ­  30  MHz)  was  be  used  as  a  viable  tool  to  monitor  changes  in  cell  viability  in  mouse  and  rat  models,  ranging  from  detection  of  ischemic  cell  death  in  rat  livers  to  monitoring  tumor  response  to  radiation  treatment  as  early  as  24h  posttreatment  in  mouse  head  and  neck  tumor  models  (FaDu  and  C6661)  [3840].  The  spectral  parameters  of  midbandfit  and  spectral  slope  exhibited  an  increase ranging from 6.5 to 8.2 dBr and 0.77 to 0.90 dBr/MHz, respectively 24 hours after being treated  with  radiation  at  0,  2,  4  and  8  Gray  [39].    In  extending  the  use  of  ultrasound  spectral  analysis  for  tissue  typing  Papanicolau  et  al  have  demonstrated  that  conventional  low  frequency  ultrasound  with  spectral  and  statistical  analysis  of  radiofrequency  echo  signals  has  the  capability  to  monitor  the  response  of  various  cancer  therapies  in  SCID  mouse  models  employing  a  PC3  tumor  xenograft  [41].    In  his  work,  32  SCID  mice  where  PC3  tumor  xenographs  were  treated  with  antivascular  ultrasound  activated  micro bubble  therapy,  a  single  dose  of  8  Gy  100Kv  Xray  radiation,  and  a  combination  of  both.  The  mice  were  scanned  using  both  high  (2030  MHz)  as  well  as  low  frequency  ultrasound  at  10  MHz  prior  to  treatment  and  then  again  after  24  hours.  The  study  found  good  correlation  in  the  changes  in  spectral  parameters  between  the  high  and  low  frequency  ultrasound  data.   The  changes  in  the  spectral  midband  fit,  slope  and  0MHz  intercept  agreed  with  histopathological  findings  confirming  the  presence  of  gross  forms  of  cell  death  which  include  apoptosis,  necrosis  and  mitosis.  Figure  8  shows  representative  low  frequency  16   

ultrasound images from  each of the four treatment groups as well as the  corresponding spectral  curves,  histopathology  analysis  images  from  TUNEL  and  H&E  stained  tissue  samples.      Additionally  the  use  of  quantitative  ultrasound  methods  has  been  successfully  used  by  Oelze  et  al  to  distinguish  and  characterize  between  mammary  fibroadenomas  in  rats  and  mammary  carcinomas  in  mice  by  investigating estimated average scatterer diameter and acoustic concentration [4244].      

17   

1.6 Research Motivation 
The hypothesis of this thesis is that ultrasound imaging at clinical settings employing a frequency  range  between  1  ­  10  MHz  could  be  used  to  quantifiably  characterize  prostatic  carcinoma  in  patients.  The  high  rate  of  prostate  cancer  diagnosis  combined  with  current  inefficient  methods  of  imaging  and  analysis  has  prompted  a  great  deal  of  research  aiming  to  improve  patient  diagnosis  and  care  in  the  safest  and  most  cost  effective  methods.  As  previously  stated  in  the  preceding  sections  quantitative  ultrasound  methods  have  been  demonstrated  to  provide  a  safe  mechanism  to  observe  soft  tissue  structures.  It  has  been  demonstrated  that  spectroscopic  analysis  of  the  raw  radiofrequency  signal  has  the  ability  to  differentiate  malignancy  in  soft  tissues  in  eye,  breast  and  prostate  tissues  creating  the  potential  to  improve  diagnosis.  For  instance  in  the  case  of  prostate  cancer  this  should  enable  clinicians  to  better  target  suspicious  regions  during  a  patient's  biopsy.  The  use  of  spectral  and  statistical  analysis  methods, both in  the high  and  the lowfrequency range  possesses the ability  to  detect changes in tissue  microstructure thus providing the ability to create a mechanism capable of monitoring effects of cancer  treatments. The work in this thesis investigates the use of spectral analysis in a clinical setting employing  low  frequency  ultrasound  in  differentiating  prostatic  carcinoma  in  patients  and  comparing  the  results  with gold standard histopathology and qualitative ultrasound elastography.  

 

 

18   

1.7 Contributions   
The  work  presented  in  this  thesis  was  made  possible  with  the  collaboration  of  Dr.  Czarnota's  laboratory  at  Sunnybrook  Health  Sciences  Center  involving  primary  experimental  setup,  patient  section  and tissue specimen for histological examination. During my involvement in the laboratory I participated  in  organizing  the  clinical  trial  involving  20  patients,  performed  data  acquisition  and  patient  followup.  My  primary  focus  and  individual  contribution  is  in  the  spectral  analysis  of  the  radiofrequency  data  acquired  with  emphasis  on  spectral  parameters  as  presented  in  this  thesis.  Additionally  I  contributed  in  the  development  of  a  visualization  software  suite  to  display  3D  parametric  mapping  of  ultrasound  images and test this with results of my current work in spectral analysis. The following chapter describes  in detail the patient selection, experimental setup as well as the methods used and the results obtained.      

19   

Chapter 2 ­ Materials and Methods 
2.1 Experimental Design and Data Collection 
In  order  to  evaluate  the  viability  of  using  quantitative  ultrasound  methods  to  detect  and  monitor  treatment  of  prostatic  carcinoma  our  experimental  approach  was  composed  of  the  three  phases:  1) Data collection, 2) Data analysis and 3) Data verification.   In  the  data  collection  phase  the  data  was  collected  as  part  of  a  clinical  trial  titled  "New  Conventional  Frequency  Functional  Ultrasound  Analysis  for  Imaging  of  Prostate  Cancer  Extent  and  Response  in  Human  Cancer  Patients"  at  Sunnybrook  Health  Sciences  Centre  and  approved  by  the  Sunnybrook  Research  Ethics  Board.  The  trial  was  designed  to  include  20  men  diagnosed  with  localized  palpable  prostate  cancer  to  be  treated  with  radical  prostatectomy.  The  reason  for  such  a  criterion  was  to  permit  a  wide  variety  of  patient  PSA  levels,  age  and  overall  health  or  external  factors.    Also  it  is  necessary to mention that the radical prostatectomy treatment method also allowed examination of the  prostate  tissue  specimen  after  excision  for  further  comparison.  Patients  with  localized  prostatic  carcinoma  were  recruited  at  Sunnybrook  Health  Science  Centre  and  with  their  consent;  ultrasound  imaging was performed prior to surgery.   Table  1  presents  the  clinically  relevant  characteristics  for  the  first  group  of  patients  that  participated  in  the  study.  All  the  patients  participating  had  PSA  scores  higher  than  4.0  ng/ml,  with  one  exception.    The  participants  were  diagnosed  with  T2  or  T3  clinical  stage  with  confirmed  positive  biopsies.    The  ultrasound  scans  were  performed  with  patients  on  an  operating  room  table  with  the  patient stabilized in lithotomy position.  An inhouse railbased, probe mount fixture was used to mount  the  transrectal  ultrasound  probe  to  the  base  of  the  table.  The  fixture  permitted  steady  gradual  calibrated  probe  movement  both  in  the  axial  and  lateral  direction.  Scans  were  performed  using  an  Ultrasonix  RP  ultrasound  system  running  Sonix  RP  3.1  software  in  investigative  digital  RF  acquisition 

20   

mode.  The  probe  used  was  a  biplanar  transrectal  ultrasound  probe  from  Vermon  S.A.  containing  a  curvilinear  128  element  linear  array  transducer  at  the  tip  of  the  probe  to  allow  for  sagittal  RF  acquisition.  Another  128  element  linear  array  transducer  was  located  beneath  the  tip  of  the  probe  allowing for axial RF capture as shown in Figure 9.   Table  2  presents  the  acoustic  properties  of  the  biplanar  transrectal  probe  as  provided  by  the  manufacturer.    During  the  ultrasound  acquisition  scan,  the  probe  was  mounted  to  an  inhouse  railing  system  and  inserted  into  the  patient  rectal  cavity.  When  capturing  transverse  RF  data  the  curvilinear  transducer was active and the ultrasound beam would in principle be perpendicular to patient's urethra.  Using  the  dials  on  the  railing  system,  the  probe  was  guided  to  the  base  of  the  prostate  which  served  as  the  starting  position  of  RF  data  acquisition.  The  position  of  the  probe  was  updated  after  RF  data  was  acquired by 5 mm increments following a trajectory from the base of the prostate to the apex, along the  rectal  wall.  The  number  of  steps  at  which  data  was  collected  varied  depending  on  the  size  of  each  patient's  prostate.  Several  ultrasound  RF  frames  were  captured  at  each  position  ~20  while  the  probe  was  stationary,  for  averaging  of  the  frames  and  therefore  minimizing  slight  patient  movements  during  the  acquisition  period.  Figure  10  presents  a  schematic  representation  of  the  probe's  directional  movement  along  the  rectal  wall  with  transverse  single  captures  representing  each  stationary  step.   Along  with  the  raw  RF  data,  acquisition  of  Bmode  data  and  elastography  images  took  place  at  each  step.  The  RF  data  for  each  step  was  acquired  employing  the  curvilinear  array  transducer  pulsed  at  10MHz.  The  sampling  frequency  during  the  RF  acquisition  was  40MHz  (chosen  to  satisfy  Nyquist's  criteria).  While  all  the  other  parameters  of  the  ultrasound  machine,  such  as  transmit  and  received  power,  were  maintained  constant  the  only  parameter  that  was  varied  was  the  receiver  gain.  The  line  density  utilized  was  512  which  with  an  80%  sector  width  permitting  for  410  RF  lines  per  frame  with  an  average  of  2040  data  points  per  scan  line.  The  exact  number  of  data  points  varied  depending  on  the  depth  of  the  image.  The  RF  data  from  each  scan  was  saved  digitally.    In  attempting  to  visualize  the  21   

prostate gland in three dimensions the RF frames from each step were averaged and combined together  to  create  a  3D  representation  using  linear  interpolation  to  fill  the  gaps  between  the  steps.   Since  the  stationary  RF  acquisition  steps  were  5  mm  apart,  a  pronounced  bias  was  observed  when  attempting  to  visualize  the  prostate  gland  in  three  dimensions  due  to  the  lack  of  sufficient  information  for  the  interpolation  method  used  to  properly  recreate  a  smooth  transitional  figure.  The  lack  of  more  refined  increments  on  the  mounting  system  for  the  transrectal  probe  limited  the  ability  to  capture  RF  data  at  increments  smaller  than  5mm.   A  compromise  was  made  to  add  one  more  freehand  ultrasound  scan  in  RF  acquisition  mode  in  order  to  encompass  the  entire  prostatic  gland  in  the  same  direction  as  the  collected  steps,  from  the  base  of  the  prostate  to  apex.  An  important  factor  for  choosing  a  freehand  sweep  is  that  it  does  not  increase  significantly  the  overall  time  for  which  the  patient  is  exposed  in  a  lithotomy position for the duration of the scan.  The sweep of the prostatic gland was done ultimately in  a  freehand  fashion  which  provided  more  data  from  a  visualization  aspect.  Approximately  120  frames  of  RF  data  were  captured  during  the  single  freehand  RF  sweep  for  an  average  prostate.  However  this  method does not fully eliminate the error in depicting the prostate in three dimensions, as the scan was  acquired freehand and would make the calculation of the probe's position inconsistent due to variability  in the speed  of hand movements as well as considerable overlap between frames due  to the ultrasound  beam width and the rate at which data was captured. For this reason the data collected from the sweep  was not used in calculations but only as a visual aid.   In a similar manner, the linear array transducer located perpendicular to the curvilinear array on  the  probe  was  used  to  scan  in  the  axial  direction.  Without  extracting  the  probe  from  the  patient  the  active  transducer  was  changed  to  the  linear  array  and  the  probe  oriented  in  the  middle  of  the  prostatic  gland, and then oriented to the patient's right most position where the prostate was still visible. Several  RF  data  frames  were  captured  at  stationary  positions  along  the  middle  of  the  prostate.  The  increments  for each step were 15° from the patient's right to left. In similar fashion accompanying Bmode data and  22   

corresponding  elastograms  were  recorded.  For  visualization  purposes  a  freehand  sweep  of  the  prostate  was  performed  using  the  linear  transducer  from  the  patient's  right  to  left.  Each  patient  in  the  trial  underwent ultrasound scans during a single session which lasted approximately 1 hour. This method was  relatively  noninvasive  and  considerably  minimized  the  amount  of  pain  and  other  side  effects  when  compared to current methods of diagnosis such as biopsy.   Shortly  after  data  acquisition  (days  to  12  weeks),  patients  underwent  a  radical  prostatectomy  surgery.  The  result  of  a  radical  prostatectomy  procedure  is  the  effective  removal  of  the  prostatic  gland  from  the  patient,  which  normally  also  requires  the  removal  of  the  seminal  vessels.  After  surgery  was  performed,  the  specimen  was  collected  for  histopathological  investigation.  Following  the  standards  of  care  at  Sunnybrook  Health  Science  Centre  after  surgery  the  specimen  was  first  prepared  by  O.R.   Pathology  where  initial  an  examination  of  the  tissue  was  done.  The  specimen  was  first  stained  with  two  dyes  on  the  surface  withgreen  to  mark  the  patient's  left  and  blue  marking  patient's  right  side.  Additionally  partial  tissue  was  removed  for  clinical  analysis  including  the  seminal  vessels;  approximately  a 5 mm slice of the bladder neck and a 5 mm slice of the apex. Following the partial tissue removal from  the  prostate,  the  remaining  tissue  was  then  sent  for  whole  mount  fixation  and  sectioning.  The  process  of the whole  mount fixation  used in this study required  the specimen to be fixed for 8 up  to 24  hours in  5%  formalin.  The  tissue  was  then  embedded  in  histomer  and  mounted  in  such  fashion  that  the  specimen's  urethra  was  horizontal  to  the  surface  of  the  container.  Once  the  histomer  solidified,  using  a  Rival  meat  slicer  confirmed  5  mm  slices  were  sectioned  in  a  serial  fashion  from  apex  to  base  at  an  approximate  90°  degree  orientation,  perpendicular  to  the  urethra,  also  matching  the  orientation  at  which ultrasound scans were performed.  The slices were then placed in cassettes and submerged again  in  a  formalin  solution  overnight  ensuring  that  every  part  of  the  specimen  was  fixed.  After  the  fixation  process  was  completed,  each  slice  was  then  embedded  into  a  paraffin  block  for  processing  in  a  tissue  processor.  Final  sectioning  was  performed  on  a  Leica  2500  motorized  sliding  microtome  using  23   

disposable  blades.  Sections  which  floated  out  in  at  50°  C  water  bath  were  then  placed  up  on  an  adhesion  coated  2x3  inches  glass  slide.  Staining  was  then  performed  on  each  slide,  one  slide  per  block.  The slide was then stained with haematoxylin and eosin (H&E) which stains for DNA and nucleic material  within  tissue.  The  stained  glass  slides  were  subsequently  then  digitized  at  maximum  resolution  using  a  TissueScope 4000 digital microscope. The digital images were then sent for pathological assessment to a  pathologist  who  in  turn  examined  the  section  and  delineated  areas  of  disease  presence  and  abnormal  glandular  activity.    The  results  of  this  process  are  digital  images  of  the  prostate  slices  with  contoured  areas  of  confirmed  disease  and  glandular  activity  in  the  same  orientation  at  which  the  ultrasound  scan  was performed.     

24   

2.2 Data Analysis 
After  each  individual  scan  was  performed,  data  was  saved  to  a  flat  file  for  post  processing.  The  files  we  exported  from  the  machine  allowing  for  custom  built  software  tools  to  be  used  in  order  to  calculate and extract the desired parameters.   2.2.1 Spectral Analysis  The  RF  files  obtained  during  the  ultrasound  scans  contain  backscatter  intensity  data  associated  with every  element and scan line for the particular transducer  used.  In our analysis of the  experimental  data  we  analysed  the  frequency  distribution  of  the  backscatter  signal  to  obtain  a  further  insight  of  the  tissue  microstructure  within  the  prostatic  gland.  Specifically,  we  investigated  information  contained  within  the  power  dispersal  of  the  backscatter  signal  as  it  is  distributed  through  the  frequency  range,  (power  spectrum  analysis).  A  custom  tool  was  developed  in  our  laboratory  to  run  in  a  Matlab  environment  to  perform  spectral  calculations.  The  basic  building  block  of  the  algorithm  was  to  compute  the  power  spectrum  of  the  RF  signal  employing  the  Fast  Fourier  Transform  (FFT)  found  in  the  Matlab  environment. Matlab  made use of the following functions to compute  the  FFT  and its inverse to convert  the input matrix from the time domain to the frequency domain and viceversa.  

   

 

9

 

       

 

10  

25   

where N is the length of the vector and  is the Nth root of unity described as follows;      Power  spectrum  analysis  was  performed  either  on  the  entire  RF  data  matrix  or  a  region  of  interest  which  was  manually  selected.  For  this  reason  the  equivalent  Bmode  image  was  reconstructed  from  the  RF  data  without  performing  any  filtering  or  other  image  enhancing  techniques.  Reconstructing  the Bmode image from the RF data first required taking the signal envelope of the backscatter intensity  and  passing  the  resulting  values  to  a  log  function  to  logarithmically  compress  the  data  for  minimal  contrast enhancement. The Matlab sequence used was as follows;      where Y is the resulting Bmode matrix and X is the RF data matrix.   Once  a  region  of  interest  (ROI)  was  selected,  the  logarithmically  compressed  Bmode  data  was  disregarded  and  the  corresponding  RF  data  submatrix  corresponding  to  the  ROI  extracted  and  the  power  spectrum  calculated.  In  order  to  perform  power  spectrum  analysis  the  RF  data  was  converted  from  the  time  domain  to  the  frequency  domain  by  applying  the  FFT  of  the  RF  data  matrix.    The  FFT  function  was  applied  to  every  individual  RF  line  in  the  selected  ROI;  the  resulting  magnitude  of  the  computed  spectrum  was  then  squared  and  logarithmically  compressed  in  order  to  obtain  the  power  spectra  in  decibel  scale.  The  process  was  repeated  for  all  individual  RF  lines  present  in  the  ROI  and  the  resulting  power  spectra  vectors  corresponding  to  each  individual  line  averaged  across  all  indices.  The  resulting  power  spectrum  vector  comprises  the  frequency  component  and  a  magnitude  component  in  decibels.    In  order  to  remove  any  system  transfer  function  artefacts  the  resulting  power  spectra  was  10 log   12  
/

 

11  

26   

normalized.  Normalization  was  achieved  by  calibrating  the  power  spectra  obtained  from  the  ROI  to  the  power spectra collected from a reference pulse.  The reference pulse used was obtained using the same  system settings at which the  RF data was collected  during clinical data acquisition during the  trial.  Using  the same system settings reference RF data was collected by imaging a tissue mimicking agar embedded  glass  bead   phantom  model  [45]  .   After  having  obtained  the  RF  data  from  the  reference  phantom  the  same  process  was  followed  as  for  the  clinical  RF  data  in  order  to  extract  a  reference  power  spectrum.  Since both power spectra are scaled logarithmically a subtraction was performed to obtain a normalized  power spectrum.       where   NPS  is  the  normalized  power  spectra,  PS  is  the  power  spectra  collected  from  the  patients  and  RPS  is  the  reference  power  spectra  extracted  from  the  phantom,  and  x  is  the  position  along  the  frequency component of the power spectrum vector.   Having  obtained  a  normalized  power  spectrum,  a  window  of  analysis  was  selected  in  order  to  extract spectral parameters related to underlying tissue micro structure. Common practice suggests that  the  majority  of  signal  power  is  contained  in  a  6  dB  window  from  the  peak  magnitude  of  the  center  frequency  of  the  transducer.  Figure  11  is  a  graphical  representation  of  the  selection  of  the  6dB  analysis  window  from  the  power  spectra  of  the  reference  pulse.  Having  identified  the  peak  magnitude  in  the  reference spectra a 6 dB window delineates the bandwidth in the normalized power spectrum for which  linear  regression  analysis  is  performed.  A  linear  regression  was  applied  to  the  resulting  frequency  range  of the normalized power spectrum using Matlab's polyfit() algorithm implementation.        13  

27   

A first degree polynomial fit of least squares function was employed as;      The  function  finds  the  coefficients  of  polynomial  p(x)  and  the  result  is  a  row  vector  of  length  n+1  containing  the  polynomial  coefficients  in  descending  power.  Figure  12  depicts  the  process  of  normalization  of  the  power  spectra.  The  red  curve  depicts  is  a  typical  power  spectrum  obtained  from  prostate  tissue  using  the  system  previously  described.  The  black  curve  depicts  the  power  spectrum  obtained  from  the  tissue  mimicking  glass  bead  phantom  as  a  reference  used  for  normalization.  The  curve  shown  in  blue  is  a  depiction  the  normalized  power  spectra,  resulting  from  the  subtraction  in  a  logarithmic  scale  of  the  ROI  spectrum  by  the  reference  spectra,  as  well  as  the  linear  regression  applied  on the normalized power spectra across the 6dB analysis window, shown in yellow.  2.2.2 Parametric Image Generation and Analysis    The  goal  of  this  study  was  to  investigate  the  capacity  of  spectral  analysis  as  a  method  of  characterizing  malignancy  in  the  prostate.  In  order  to  ascertain  this  capacity,  parametric  maps  were  generated  for  all  three  spectral  parameters  namely  midband  fit,  spectral  slope  and  0MHz  intercept.  Employing  the  spectral  analysis  method  described  above  the  RF  data  extracted  from  the  ROI  served  as  input matrix to a sliding window algorithm which calculated all three parameters of interest in our study.  The size of the sliding window was a user defined parameter. In this study results were obtained using a  4x4  window  from  the  index  being  computed  thus  using  9x9  data  points  in  order  to  perform  spectral  calculations.  In  this  method  the  result  for  an  input  matrix  of  dimensions  N  x  M  is  a  matrix  of  (N   2windowsize)  x  (M  ­  2windowsize).  For  each  data  point  in  the  input  matrix,  9  RF  scan  lines  and  9  data  points  are  used  to  calculate  the  power  spectrum  which  in  turn  is  normalized,  log  compressed  and  the  28      14  

corresponding  midband,  spectral  slope  and  0MHz  intercept  values  are  computed  and  placed  in  the  corresponding  position  in  the  three  output  matrices  over  the  whole  image.   Since  the  selection  of  the  ROIs  ensures  inclusion  of  the  entire  visible  prostate  captured  by  the  ultrasound  data  the  resulting  matrices  are  parametric  representations  of  the  prostate.  This  permitted  the  application  of  a  colour  transfer  function  in  order  to  obtain  a  visual  representation  of  the  corresponding  spectral  parameters.  This  process  was  repeated  for  all  the  acquisition  steps  over  the  prostate  for  each  patient.  Once  the  output  matrices were generated for all  the desired spectral  parameters and  the colour transfer function  was  applied,  the  data  was  exported  as  an  image  retaining  the  scale  of  the  output  matrix.  Using  a  Java  package  for  bidirectional  communication  and  data  exchange  from  Matlab  to  ImageJ  (MIJ)  [46]  the  parametric images were  processed using the  tools provided in ImageJ. Once  the  data was  imported into  ImageJ  the  matrix  was  then  normalized  to  a  gray  scale  with  range  of  0255.  Having  normalized  the  data  to  a  gray  scale  the  bounds  of  prostate  structure  captured  at  each  step  was  manually  contoured.  Using  the  image  extraction  method  in  ImageJ  the  normalized  data  incorporated  within  the  contoured  bounds  was  extracted  from  the  input  matrix  in  order  to  eliminate  the  effect  of  tissue  outside  of  the  prostatic  gland  in  area  computations.  By  extracting  the  prostate  gland  region  in  images,  the  effective  area  of  the  prostate  was  calculated  for  each  step,  and  the  same  computation  performed  for  all  the  patients  depending on the available number of steps per patient.  In  order  to  differentiate  between  normal  prostatic  tissue,  abnormal  glandular  tissue  (BPH)  and  prostatic  carcinoma,  we  investigated  methods  of  classifying  the  values  for  each  of  the  spectral  parameters.  Since  the  range  of  values  for  each  parameter  varied  between  patients  an  absolute  threshold  cutoff  to  be  attributed  to  a  particular  tissue  type  was  not  used  but  a  histogram  threshold  value of approximately 67% of the maximum was arbitrary chosen and evaluated. The set threshold was  evaluated  on  a  contoured  image,  adjusted  if  necessary  to  take  into  consideration  patient  variability  in  baseline signal intensity and applied to all images. This was done for each parameter.  29   

Digital  histology  images  with  contoured  areas  of  disease  were  inputted  into  ImageJ  for  quantification.  The  quantification  was  performed  again  in  two  phases;  the  first  phase  computing  the  total area of disease contoured by a pathologist for each prostate slice. The second phase computed the  total  area  occupied  by  prostatic  tissue.  This  process  allowed  for  the  calculation  of  the  same  ratio  between  disease  and  healthy  tissue.  It  is  important  to  note,  that  during  the  fixation  process  and  whole  mount  slicing  tissue  removed  from  the  patient  undergoes  minor  but  unknown  deformations.  This  factor  had a significant influence in choosing to examine the histology images with respect to determining only  a  ratio  between  disease  and  the  remaining  tissue.  Even  though  various  deformable  image  co registration  methods  using  finite  elements  which  could  account  for  such  deformations  have  been  proposed in the literature, their scope is not the goal of this thesis.  Having established the same ratio in  determining  the  presence  of  disease  in  the  prostate  gland  for  both  the  parametric  images  generated  using  spectral  analysis  and  the  pathological  assessment  which  is  currently  the  gold  standard  practice  in  patient care this ratio was employed as the criterion of evaluating and validating our findings.   Since  the  ultrasound  scans  were  performed  at  static  steps  with  5mm  spacing,  and  the  whole  mount  histological  slicing  was  performed  at  the  same  frequency,  a  general  comparison  should  be  possible between the percent disease areas computed from the spectral parameters and the histological  slices.      

30   

Chapter 3 ­ Results and Discussion 
3.1 Results 
In  this  study  we  have  achieved  to  create  a  basic  framework  for  using  low  frequency  ultrasound  at clinical settings to extrapolate areas of suspected  disease in the prostate. Results indicated the ability  to  identify  regions  of  the  prostate  with  a  high  likelihood  of  disease  presence.  Of  the  three  spectral  parameters  investigated,  the  spectral  midband  fit  and  the  spectral  0MHz  intercept  showed  a  considerable  degree  of  sensitivity  to  changes  in  the  internal  structure  of  the  prostate  gland.  In  contrast,  spectral slope which is an indication of average scatter size did not seem to be sensitive to the presence  of  cancer  regions  in  the  prostate.  Figure  14  is  a  visual  representation  of  general  findings  illustrating  the  various  aspects  of  our  analysis.  The  top  row  depicts  standard  Bmode  images  from  one  patient  reconstructed  from  the  raw  RF  data  without  any  additional  signal  altering  modifications.  Each  of  the  B mode  images  represents  an  independent  scan  plane  through  the  prostate,  separated  from  a  5  mm  gap  between  steps.  The  Bmode  images  allow  for  capturing  hypo  echoic  areas,  as  they  are  representations  of  the  backscatter  intensity  from  the  prostate,  however  they  do  not  convey  very  useful  information  which  can  be  attributed  to  morphological  changes  in  the  tissue  microstructure  and  its  interactions  with  the  ultrasound  pulse.  The  second  row  illustrates  the  results  of  spectral  analysis,  converted  into  parametric  images  of  the  prostate.  Each  image  corresponds  to  the  same  spatial  step  and  is  obtained  from  the  corresponding  Bmode  image  shown  in  the  first  row.    The  midband  fit  parameter  indicated  relative  variations  ranging  between  9  to  15  dBr  (dB  relative  to  the  calibration  curve)  between  areas  of  gross  disease  presence  and  areas  of  normal  tissue.    Visual  analysis  demonstrated  that  data  were  sensitive  enough  to  permit  delineation  of  bulk  disease  presence  in  the  prostate.   The  images  in  the  last  row  are  digitized  images  from  the  nominally  corresponding  hematoxylin  and  eosin  stained  representative  4  µm  thick  slices,  taken  from  5  mm  tissue  blocks  corresponding  to  each  ultrasound  acquisition.  The  areas  of  disease  in  the  histology  images  correlated  fairly  well  with  suspected  areas  of  31   

disease  calculated  using  the  midband  fit  parameter  with  the  resulting  parametric  images.   The  method  of  analysis  using  the  MBF  parameter  indicated  a  9.1%  area  of  potential  disease  in  the  MBF  parametric  image  compared  to  7.8%  disease  area  in  the  H&E  stained  image  for  the  first  slice.    The  reamaining  representative  slice  results  were  19.28%  ultrasound  to  18.2%  in  H&E  (slice  2),  15.1%  ultrasound  to  12.3% H&E (slice 3) and 8.7% ultrasound to 8.8% H&E for slice 4 for this representative patient.  In  contrast  to  the  MBF  parameter,  the  0MHz  intercept  parameter  did  not  demonstrate  a  comparable  degree  of  correspondence.  Figure  14    row  three  displays  the  corresponding  0MHz  intercept  parametric  images,  calculated  at  the  same  steps  as  the  Bmode  and  parametric  MBF  parameter for this patient.  The corresponding results calculated in the manner discussed above were as  follows:    9.7%  disease  calculated  from  the  0­MHz  compared  to  7.8%  obtained  from  the  histological  analysis for the first slice. Moreover, a 6.8% disease value was calculate compared to 18.2% (slice 2), 5.6  %  ultrasound  to  12.3%  H&E  (slice  3)  and  5.9%  ultrasound  to  8.8%  H&E  for  slice  4.   Table  3  contains  a  summary of the results for the first patient.  A  summary  of  data  for  the  individual  prostate  specimen  was  calculated  by  adding  individual  frame  data  and  calculating  an  average  percentage  area  of  disease.  Similarly,  histopathological  averages  were  calculated  by  determining  the  total  area  of  demarcated  malignancy  and  averaging  over  the  entire  specimen  volume.  Histopatological  results  for  the  first  patient  resulted  in  an  11.8%  average  area  of  malignancy,  compared  to  the  calculated  average  percent  disease  area  obtained  from  the  spectral  parameters  indicating  a  13.5%   disease  area  for  MBF  parameter  and  a  7.0%  disease  area  obtained  from  the 0MHz intercept parameter.      

32   

Figure  15  displays  data  obtained  for  a  single  representative  patient,  summarizing  computed  parametric  average  areas.  Individual  points  on  the  left  graph  represent  the  corresponding  percent  disease  area  computed  for  the  MBF  parameter  (left  graph)  versus  the  area  found  in  the  histological  analysis  for  individual  steps  along  the  prostate  gland  specimen.  The  graph  on  the  right  similarly  shows  the  resulting  graph  corresponding  to  the  spectral  0MHz  intercept  data.  Additionally,  a  linear  regression  best  fit  curve  is  plotted  with  a  corresponding  95%  confidence  interval.  The  linear  regression  analysis  revealed  an  R­squared  value  of  0.894  for  the  MBF  percent  disease  area  but  only  a  Rsquare  value  of  0.1196 for the 0MHz intercept parameter.   Following  the  same  methodology,  a  summary  plot  of  all  data  pairs  between  each  individual  spectral  parameter  area  calculations  and  the  corresponding  histological  analysis  results  for  individual  steps  analysed  across  all  patients  was  generated.   As  the  analysis  method  was  consistent  across  all  the  patients,  in  order  to  increase  the  sample  size  to  permit  for  a  more  comprehensive  statistical  analysis  of  the  patient  population,  the  individual  scan  steps  across  all  patients  were  combined  into  one  dataset  of  corresponding  data  pairs.  Figure  16  provides  the  corresponding  graphical  summary  of  all  corresponding  parametric and histopathologic data pairs for calculated percent disease areas from the ultrasound data  to  observed  percent  disease  area  determined  from  pathology  for  all  the  patients  participating  in  our  study.  In  order  to  assess  our  results  a  linear  regression  based  goodness  of  fit  test  was  performed  across  all data pairs, shown by the solid line along with the corresponding 95% confidence interval indicated by  the  broken  line.  The  goodness  of  fit  test  revealed  an  Rsquare  value  of  0.8232  across  all  data  pairs.  Assuming  a  nonGaussian  distribution,  a  nonparametric  Pearson  correlation  test  was  performed  revealing  an  r  value  of  0.9073  with  a  95%  CI  of  0.8330  to  0.9494  indicating  a  significant  correlation  (alpha < 0.05) with a Pvalue less than 0.001. 

33   

Figure  17  presents  results  of  data  for  all  patient  data  pairs  for  the  0MHz  percent  disease  area  with  corresponding  percent  disease  obtained  from  histopathological  analysis  across  all  analyzed  data  pairs.  The  goodness  of  fit  test  for  the  0MHz  intercept  parameter  revealed  a  relatively  poor  Rsquare  value of 0.2775 indicated with a solid line in Figure 17. Performing a nonparametric Pearson correlation  test  on  the  spectral  intercept  parameter  in  comparison  to  histology  findings  revealed  a  correlation  coefficient Pearson r value of 0.5268 with a 95% confidence interval of 0.2653 to 0.7161 and a Pvalue of  0.003. Furthermore, in addition to analyzing data on individual slice basis a goodness of fit test based on  the  average  disease  area,  was  computed  using  the  spectral  MBF  parameter  and  histological  results.  Figure  18  displays  the  graphical  representation  of  averaging  the  MBF  and  corresponding  histology  pairs  for  each  patient  individually.  The  average  percent  disease  area  computed  from  the  MBF  parameter  is  shown  on  the  Yaxis,  and  the  corresponding  average  disease  obtained  from  histopathologic  analysis  is  plotted  on  the  Xaxis.  A  goodness  of  fit  test  using  linear  regression  revealed  an  Rsquare  0.9885.  A  non parametric  Pearson  correlation  test  revealed  a  significant  correlation  (alpha  =  0.05)  with  an  r  value  of  0.9943  with  a  95%  confidence  interval   0.9599  to  0.9992  and  a  twotailed  Pvalue  of  0.0001.  The  linear  regression line is shown with a solid line in Figure 18 and the 95% confidence interval with a dotted line.  In  contrast,  inspecting  the  averages  computed  areas  using  the  0MHz  spectral  intercept  showed  an  R square  value  of  0.5426  for  the  linear  regression  goodness  of  fit  test.  The  Pearson  nonparametric  correlation  test  indicated  a  nonsignificant  (alpha  0.05)  r  value  of  0.7366  with  a  95%  confidence  interval 0.372  to  0.9582  and  a  twotailed  Pvalue  of  0.059.  Figure  19  shows  the  corresponding  graph  of  the averaged 0MHz spectral intercept.     

34   

3.2 Discussion  
In conclusion we have established a preliminary analysis framework to quantify soft tissue types  using  quantitative  ultrasound  spectral  analysis  to  identify  potential  areas  of  malignancy  in  the  prostate.  From  our  investigation,  we  found  a  significant  variance  in  the  range  of  values  for  each  of  the  spectral  parameters  between  patients.    Variation  in  the  range  of  the  spectral  parameters  can  be  attributed  to  several factors that greatly impact ultrasound imaging such as overall size, density and internal structure  of  the  prostate  varying  from  patient  to  patient.    The  fact  that  all  the  participating  candidates  are  patients with biopsy confirmed presence of prostatic carcinoma allowed for the patients to be evaluated  as  distinct  target  subset.   Based  on  our  results  the  spectral  midband  fit  parameter  appears  to  be  most  sensitive  to  the  presence  of  prostatic  carcinoma  formations  in  the  prostate.  Comparing  the  results  of  estimated  percent  disease  areas  computed  using  the  MBF  parameter  to  those  provided  from  histopathological  analysis,  MBF  values  were  observed  to  be  greater  than  the  current  histology  gold  standard.  These  observations  lead  us  to  believe  that  the  presence  of  disease  is  detected  with  a  high  sensitivity.   Conversely,  the  spectral  0MHz  intercept  does  not  indicate  a  comparable  sensitivity  as  the  results  obtained  from  the  histopathological  analysis.  The  0MHz  intercept  parameter  based  disease  estimations  were  observed  to  be  lower  than  those  obtained  from  histology.  Furthermore,  the  spectral  slope  was  observed  to  be  invariant  to  the  presence  of  prostatic  carcinomas.  The  high  variability  observed  in  the  spectral  slope  parameter  as  an  indicator  of  average  scatter  sizes  suggests  that  the  prostate  gland  is  highly  heterogeneous  and  moreover  the  size  of  tumour  cells  do  not  appear  to  demonstrate  a  consistent  variability  in  comparison  to  nonmalignant  prostatic  tissue.  This  may  be  related  to  the  influence  of  higher  order  glandular  prostatic  intraepithelial  neoplasia  which  changes  with  carcinoma  development,  as  well  as  changes  occurring  at  cellular  level.  The  results  presented  in  this  thesis  are  in  general  agreement  with  similar  type  of  studies  found  in  the  literature.  In  comparison  with  work  done  by  Feleppa`s  group  in  tissue  characterization  of  the  prostate  our  findings  were  in  general  35   

agreement.  Our  results  indicated  that  spectral  analysis  could  be  used  to  detect  malignancy  in  the  prostate.  This  work  demonstrated  that  the  midband  fit  parameter  is  most  sensitive  to  the  presence  of  tumour  in  the  prostate;  Feleppa's  group  has  demonstrated  similar  results  with  this  respect.  The  mid band  fit  values  in  the  cancerous  regions  exhibited  ~  10  dB  average  lower  than  cancer  free  areas.  The  0 MHz  intercept  as  an  independent  parameter  exhibited  a  relatively  poor  performance  in  identifying  the  tumour  extent  in  the  prostate.  In  contrast  Feleppa's  group  combines  all  the  spectral  parameters  with  external  patient  factors  such  as  age  and  PSA  in  their  classifications  of  tumour  regions.  The  findings  of  our  study  were  in  complete  agreement  with  Feleppa's  groups  with  respect  to  spectral  slope  parameter  exhibiting high variability and inconsistency in predicting potential areas of disease. 

 

 

36   

Chapter 3 ­ Future Work 
3.1 Correlation and Validation  The  goal  of  the  work  presented  in  this  thesis  was  to  investigate  the  use  of  conventional  low  frequency  ultrasound  used  in  clinical  setting  as  a  mechanism  to  characterize  and  quantify  malignancy  in  the  prostate.  It  was  demonstrated  in  this  thesis  that  changes  in  tissue  microstructure  caused  by  the  presence  of  prostatic  carcinoma  can  be  quantified  employing  ultrasound  at  clinically  relevant  frequencies.  The  efficacy  of  the  proposed  framework,  which  at  its  core  utilizes  spectral  analysis,  was  demonstrated  using  a  subset  of  patients  with  biopsyconfirmed  presence  of  prostatic  carcinoma.  The  examination  of  the  power  spectra  obtained  from  patients  in  vivo  was  indicated  that  the  spectral  mid band  fit  parameter  and  0MHz  intercept  can  be  utilized  to  quantify  areas  of  suspected  disease  in  the  prostate.  The  verification  of  the  results  was  performed  by  comparing  putative  "disease"  areas  detected  via  the  spectral  parameters  with  the  current  accepted  clinical  standard,  histopathological  analysis.  The  work presented in this thesis is a correlation between the data collected using lowfrequency ultrasound  with  histological  analysis  images  obtained  from  wholemount  histology.  The  findings  of  this  study  demonstrate  a  relative  correlation  of  the  results  of  spectral  analysis  compared  with  histological  analysis  with  the  degree  of  correlation  depending  on  the  particular  spectral  parameter.  In  order  to  further  improve  the  correlation  between  spectral  analysis  and  histological  analysis  a  more  precise  spatial  data  acquisition  and  analysis  mechanism  is  required.  In  order  to  improve  the  results  obtained  from  spectral  parameters  further  investigation  into  optimization  on  acquiring  the  ultrasound  data  and  its  analysis  is  required.  Also,  new  advancements  in  ultrasound  transducer  technologies  in  the  development  of  2 dimensional transducer arrays may provide more accurate results.   Threedimensional  histology  is  another  mechanism  which  may  permit  improvements  in  spatial  correlation  between  quantitative  spectral  methods  and  the  histological  analysis.  As  previously  mentioned  the  histological  analysis  was  obtained  from  representative  4  µm  slices  obtained  from  5  mm  37   

blocks.  In  addition,  due  to  regulatory  reasons  which  ensure  optimum  patient  care,  two  sections  were  removed  from  the  specimen  obtained  postsurgery.  Each  section  removed  was  approximately  45  mm,  and  removed  from  the  apex  and  the  base  of  the  prostate  respectively.  Utilization  of  3D  histology  can  make  available  multiple  representative  slices  obtained  from  each  individual  5  mm  tissue  block.   When  combining  the  slices  from  each  block  a  far  more  accurate  three  dimensional  histological  model  of  the  prostate  gland  could  be  recreated.  This  method  may  improve  spatial  correlation  between  histological  analysis  and  ultrasound  imaging  which  is  collected  at  5  mm  increments,  as  it  may  account  for  sudden  changes in tissue structure in more refined and accurate spatial grid.   3.2 Optimization of Visualization and Segmentation   In  order  to  visualize  the  results  obtained  via  spectral  analysis  of  the  backscattered  ultrasound  signal,  a  visualization  model  was  implemented.  The  visualization  and  analysis  framework  utilized  in  this  thesis  is  based  on  a  two  dimensional  analysis  method  which  is  then  applied  to  a  stack  of  ultrasound  frames  in  order  to  create  a  three  dimensional  parametric  volume  of  the  prostate  for  each  individual  spectral parameter. The analysis framework was implemented using Visual C++ (VC++) in a Visual Studio  environment  based  on  the  .NET  2.5  framework.  This  implementation  choice  allowed  for  rapid  developing  of  graphical  user  interfaces  (GUI)  while  utilizing  the  execution  speed  advantage  provided  by  compiled  languages  into  native  machine  code.  While  all  the  spectral  calculations  of  the  ultrasound  backscattered  signal  were  performed  in  Visual  C++  the  visualization  was  performed  entirely  using  Visualization  Tool  Kit  (VTK)  integrated  into  the  .Net  framework.  VTK  is  an  open  source  software  library  which allows  for three dimensional visualization of computer graphics as well  as powerful  modeling and  processing  of  image  datasets  [47].    The  integration  of  VTK  with  the  .NET  platform  was  accomplished  using  as  middleware  a  set  of  .NET  wrapper  classes  developed  by  Dr.  Václav  Skala  and  Milan  Frank  [48,  49].  Figure  20  demonstrates  the  high  level  architecture  of  the  main  building  blocks  on  which  a  graphical application is built within the .NET framework as proposed by Skala and Frank.  38   

The  analysis  and  visualization  software  created  was  based  in  a  combination  of  a  structured  and  event  driven  architecture  comprised  of  several  independent  modules.  The  analysis  and  data  access  modules  were  designed  using  a  monolithic  architecture  acting  as  selfcontained  event  driven  applications. In contrast the data visualization aspect was designed as filter ­ pipeline architecture while  employing  an  object  oriented  approach.  The  software  package  was  comprised  of  a  spectral  analysis,  parametric  generation,  reporting  and  batch  processing,  data  feed  and  repository,  and  a  visualization  module  and  a  main  control  user  interface.  The  details  of  regarding  the  implementation  are  provided  in  Appendix X.   While  the  software  developed  is  a  powerful  tool  capable  of  analyzing  spectral  data  for  user  specified ROIs, it lacks the ability to independently identify the structure of the prostate accurately. As a  result  manual  selection  of  the  prostate  region  is  required.  The  implementation  of  segmentation  algorithms  in  image  processing  can  significantly  improve  the  accuracy  in  the  selection  of  ROIs  for  the  purpose of accurately calculating the ratio of malignance in the ultrasound images.   Furthermore,  improvements  in  the  thresholding  methodology  are  required  in  order  to  accurately  identify  areas  of  suspected  disease  in  the  parametric  images  generated  from  the  spectral  parameters.  Currently  the  thresholding  of  the  parametric  images  was  performed  manually  using  arbitrarily determined   guidelines. The manual selection of the threshold cutoff value does not allow for  the  use  of  spectral  analysis  to  be  utilized  on  an  unknown  population  sample.   Artificial  intelligence  (A.I.)  methods can be employed in the future in order to improve the thresholding mechanism and ultimately  the  identification  of  suspected  areas  of  disease  in  the  ultrasound  images.  The  most  prevailing  implementations  of  A.I.  involve  the  use  of  neural  networks,  more  specifically  multilayer  perceptron  classifiers  [27,  30].  Support  vector  machines  (SVM)  are  another  type  of  classifier  which  have  been  demonstrated  to  successfully  perform  classification  of  multidimensional  datasets.  SVMs  can  be  utilized 

39   

to  consider  not  only  the  results  of  the  spectral  analysis  parameters  but  also  factors  external  to  ultrasound imaging such as PSA levels, age, ethnicity and other clinically relevant patient facts.    3.3 Elastography in Tissue Characterization  Elastography  presents  another  method  of  employing  ultrasound  waves  as  a  method  of  quantitative  analysis,  and  does  this  by  exploiting  elastic  properties  of  soft  tissue.  Common  practices  suggest  that  cancerous  lesions  very  often  are  significantly  stiffer  then  the  surrounding  tissue  which  enables  physicians  to  use  palpation  to  examine  and  detect  tumors  on  accessible  organs  such  as  breast  and  prostate  [5052].  However  the  ability  of  palpation  to  detect  potential  cancerous  regions  depends  greatly  on  the  ability  of  the  professional  administering  the  exam  and  it  has  limited  depth  range.  More  importantly  the  results  of  palpation  are  not  easily  quantifiable  and  cannot  provide  accurate  measurements of size and location.  Ultrasound elastography imaging attempts to provide an alternative  to  palpation  by  providing  a  quantifiable  visual  map  of  the  elastic  properties  of  tissue  at  an  increased  penetration depth. Generally, soft tissue methods of imaging can be grouped into two categories: in the  first  group  tissue  deformation  and  strain  parameters  are  extrapolated  under  quasistatic  compression,  and  in  the  second  category,  dynamic  compression  or  natural  vibrations  are  used  [5254].  Both  methods  estimate  tissue  deformation  by  using  time  delay  techniques  by  tracing  the  tissue  displacement  or  relaxation prior to and post compression. Based on the imaging method used and the type of processing  of  the  RF  echo  signal  a  variety  of  elastograms  can  be  generated  depicting  stiffness  variability  including  measures  such  as  axial  strain,  lateral  strain,  Young's  and  Poisons  modules  [52].  Since  the  realization  of  utilizing  ultrasound  technology  to  examine  mechanical  elastic  properties  of  soft  tissue  several  computational  methods  have  been  developed  such  as  timedomain  cross  correlation,  power  spectral  analysis,  Fourier  base  speckle  phased  tracking  and  adaptive  timedomain  cross  correlation.  Conventionally  practiced  mechanisms  that  estimate  the  local  axial  strain  compute  and  display  the  gradient  of  displacement  that  the  ultrasound  speckle  pattern  exhibits  under  compression.  The  time  40   

domain  cross  correlation  (TDCC)  obtains  the  displacement  by  interpolating  the  maximum  peak  of  the  correlation  function  between  corresponding  RF  Alines  before  and  after  axial  compression  is  applied.  Time stretching of the RF lines is performed to reduce the noise and improve the accuracy of correlation  between  pre  and  post  compression  [52,  54,  55].  It  has  been  demonstrated  that  the  estimation  of  the  elastic  properties  of  soft  tissue  can  be  used  to  differentiate  potential  cancer  regions  in  vivo.  The  use  of  elastography  has  been  applied  in  the  detection  of  large  breast  tumors  [56].  Elastography  can  also  be  used  to  both  detect  and  potentially  to  guide  biopsies  of  the  prostate  [50].  Preliminary  methods  suggest  the  feasibility  of  obtaining  high  quality  elastography  images  of  the  prostate  using  current  transrectal  probing  techniques.   Current  brachytherapy  practices  use  a  water  balloon  of  known  volume  around  the  transrectal  probe  for  coupling  reasons.  The  water  volume  in  the  balloon  can  be  changed  in  a  controllable  fashion  allowing  for  the  pressure  to  be  calculated  and  therefore  a  known  compression  would be applied to the prostate. This method permits creating elastograms with a low contrast to noise  ratio using current clinical settings.        

41   

3.3 Segmentation of Elastography  The  current  implementation  of  elastography  image  formation  in  the  Ultrasonix  RP  system  used  in this study  allows for the formation relative elastrograms. The  elastograms obtained in the study  were  created  using  an  adaptive  timedomain  cross  correlation  algorithm.  In  essence,  this  method  compare  the  individual  RF  lines  from  one  ultrasound  frame  to  the  next  creating  a  cross  correlation  matrix.  The  coefficients  of  the  cross  correlation  matrix  are  interpreted  as  a  relative  scale  depicting  tissue  compressibility as it varies through time. The higher correlation coefficients are interpreted as a result of  lesser  compressibility  which  is  an  indication  of  harder  tissue  presence.    A  representative  elastogram  collected  using  the  previously  mentioned  algorithm  on  an  Ultrasonix  RP  system  is  shown  in  Figure  21.  The  pulsing  frequency  employed  was  10  MHz  with  a  sampling  frequency  of  20  MHz.  The  stiffer  tissue  regions  are  depicted  in  dark  blue  color  relative  to  the  softer  regions  depicted  in  red,  the  relative  color  scale is shown on the right hand side of Figure 21. The cross correlation method of forming elastrograms  from ultrasound provides information when used as a ratio between two regions of interests.  However,  this  method  lacks  quantitative  data  to  classify  tissue  when  the  goal  of  the  investigation  is  to  measure  and  identify  areas  of  a  specific  stiffness.  Since  this  method  compares  the  relative  stiffness  between  two  or  more  regions  it  requires  that  the  user  must  have  knowledge  of  the  regions  of  interest  prior  to  elastrogram  collection  which  then  in  turn  will  provide  the  ability  to  obtain  a  relative  stiffness  ratio  between  those  regions.  For  the  purpose  of  the  study  a  more  absolute  stiffness  measurement  technique  is require with a controlled experimental setup. However, with the use of more advanced A.I techniques  the  relative  stiffness  values  maybe  prove  to  be  a  valuable  addition  when  combined  with  spectral  analysis  methods  and  other  patient  characteristics  and  provide  a  broader  perspective  when  attempting  to classify tissue type in the prostate. 

 

 

42   

Appendix  
A.1: Software Architecture and Implementation  The  software  package  presented  in  this  thesis  was  created  to  overcome  some  of  the  limitations  that  exist  in  the  current  Matlab  environment.  Although,  Matlab  is  a  powerful  computational  environment  that  provides  a  distinct  advantage  and  significantly  simplifies  the  process  of  working  with  complex  mathematical  problems  and  matrix  manipulations,  it  lacks  in  the  ability  to  visualize  and  render  complex  scenes  comprised  of  large  amount  of  data.  Also,  since  Matlab  is  built  on  Java,  program  interfaces  built  in  Matlab  generally  experience  a  slower  performance  since  the  resulting  code  needs  to  be  interpreted  by  the  Java  Virtual  Machine  (JVM).  In  order  to  improve  performance  the  proposed  solution  makes  use  of  the  Graphical  Processing  Unit  (GPU)  to  perform  the  visualization  tasks  using  VTK  which is built as a graphical library interfacing with  OpenGL. Computational  performance  was optimized  by removing the JVM interpretation layer and coding in Visual C++ therefore compiling the code directly  to  machine  language  designed  for  Intel  x86  and  x64  platforms.  The  application  layer  is  built  on  top  of  DotNet framework 3.5.   A  bottom  ­up  software  design  paradigm  with  rapid  prototyping  was  used  to  build  the  software.  Utilizing  Object  Oriented  programing  principles  the  software  package  was  compartmentalized  into  independent  modules.  Each  individual  module  was  further  compartmentalized  into  six  components  Control  Menu,  Data  Control,  Display  Control,  System  Control,  Data  Repository  and  Main  Control.  Each  component  is  designed  as  abstraction  therefore  every  module  added  to  the  package  needs  to  implement  these  interfaces.  The  software  was  designed  to  be  an  event  driven  architecture  and  the  communication  between  each  component  was  achieved  using  a  global  delegate  system.  In  essence  when  an  event  is  raised  the  corresponding  delegates  are  invoked  and  each  component  has  sufficient  capacity  to  update  itself  appropriately.  The  Control  Menu  functions  as  the  main  hub  for  file  IO 

43   

operations  such  as  opening  the  ultrasound  files  and  saving  operations  performed  on  the  data.  Data  Control  acts  as  properties  display  and  interactions  component  pertaining  to  each  type  of  analysis  performed.  System  Control  is  the  main  component  responsible  for  handling  visual  user  operations  performed  on  the  data  prior  analysis  such  as  selection  of  ROIs,  frame  changes,  frame  extraction  etc.   Data  Repository  is  a  component  not  visible  to  the  user  which  maintains  the  state  of  the  data  at  all  time.  It contains all the data and external information required to perform all the types of analysis available in  each  module  as  well  as  the  results  of  such  analysis.  The  Data  Repository  functions  as  the  main  hub  where each component independently updates the data depending on individual requirements and acts  as a temporary storage container. Display Control is the main visualization component which its primary  responsibility  is  to  visually  represent  the  ultrasound  data  and  handle  visual  user  interactions  with  the  data.  Since  all  the  visualization  operations  are  performed  in  the  Display  Control  the  integration  of  VTK  with  each  module  is  done  here.  The  Main  Control  is  the  container  which  initiates  execution  keeping  track  of  each  individual  component  within  a  module  and  updates  them  accordingly.  There  are  three  main  modules  included  into  this  initial  platform,  Spectral  Analysis  Module,  Parametric  Module  and  the  Reporting  Module.   Figure  22  is  a  visual  representation  of  each  individual  component  comprising  of  the  Spectral  Analysis  Module.  The  position  of  each  individual  component  does  not  change  through  the  various modules. However, the appearance and the enabled functionalities of each component vary.    Since  the  behaviour  of  each  module  is  driven  either  by  user  events  or  change  in  the  state  of  data, the communication process between the main components comprising each module is achieved in  a  twostep  delegate  system.   When  a  component  raises  an  event,  the  invoked  event  is  delegated  to  the  Main  Control  component,  step  one.  The  Main  Control  upon  receiving  the  invoked  event  raises  a  global  even  to  all  the  controls.  Only  when  a  global  even  has  been  invoked  from  the  Main  Control  then  each  individual  component  updates  itself  accordingly.  This  communication  process  ensures  data  integrity  at  all  times  without  user  performance.  This  architecture  allows  for  scalability  of  behaviour  updates  of  44   

individual  components  without  affecting  the  others.    Also,  the  addition  of  new  components  into  the  Main  Control  container  can  be  performed  with  easy  since  the  delegate  interface  is  the  identical  even  though  the  behaviour  and  functionality  varies.    Figure  23  is  shows  a  demonstration  of  a  of  the  communication  pathways  between  the  components  registered  with  the  Main  Control  of  the  Spectral  Analysis  Module  during  a  user  invoked  change  frame  event.  Upon  the  user  manually  changing  the  selected  frame  from  a  multiframe  ultrasound  file,  the  System  Control  component  invokes  a  delegate  with  the Main Control. It is the responsibility of the  Main Control to invoke a global change  frame event  with  all  the  registered  components  of  the  specific  module.    Only  upon  receiving  the  global  delegate  invocation  of  change  frame  event  from  the  Main  Control  all  the  components  registered  will  update  accordingly.   The  component  which  originated  the  event  does  not  update  itself  until  the  global  event  is  raised  from  the  Main.  During  the  update  process  components  may  communicate  directly  with  the  Data  Repository to retrieve, insert or update existing data.   The  ultrasound  RF  data  as  well  as  the  parametric  images  are  stored  in  the  Data  Repository  component. Each individual set of data to be displayed is stored into a vtkImageData object.  The class 
vtkImageData  is  a  basic  type  of  data  structure  designed  specifically  to  accommodate  2D  and  3D 

images.   There  exist  four  main  properties  that  define  the  vtkImageData  structure.  Dimensions  of  the  image  define  the  size  of  the  image  as  the  number  of  data  point  comprising  the  image  or  volume.  Origin  defines the three dimensional position in space of the point (0, 0, 0).  Spacing property defines the voxel  dimensions  and  scalar  type  defines  the  primitive  data  type  comprising  the  image  such  as  integer,  float,  double etc.   The  visualization  component  of  each  module  is  contained  within  the  Display  Control  component.  The  display  pipeline  is  a  demand  driven  pipeline  because  the  rendering  process  occurs  as  needed. In essence only the parts of the volume visible to the user are rendered, as the view of the user 

45   

changes  the  rendering  process  demands  the  new  updated  data  to  be  proceed  through  the  pipeline  as  needed.  This  type  of  rendering  makes  the  memory  requirements  significantly  easier  to  manage  by  average  PCs  because  it  does  not  require  the  entire  data  comprising  the  volume  to  be  loaded  onto  the  graphics memory. However, this method does require the entire volume data to loaded and kept on the  system memory for the duration of the display pipeline.    The  display  pipeline  is  divided  into  two  parts  the  visualization  and  the  graphics  pipeline.  The  visualization  pipeline  comprises  of  the  volume  data  source  with  the  corresponding  filters  and  data  mappers.  The  visualization  pipeline  comprises  of  three  data  conversion  filters  and  a  custom  piecewise  mapping.   The  filters  used  are  the  vtkImageMathematics which  allows  for  the  extrapolation  of  the  absolute  value  from  RF  data  set.  Second,  the  output  of  the  absolute  value  filter  serves  as  input  to  the 
vtkImageLogarithmicScale filter  converting  the  data  to  log  scale.  Since,  the  requirements  of  the 

mapping  filters  need  the  dataset  to  have  a  scalar  type  of  unsigned  char,  the  output  of 
vtkImageLogarithmicScale is  used  as  input  to  the  vtkImageCast filter  which  in  turn  converts 

the  scalar  types  from  integers  to  unsigned  char.  In  order  to  define  the  vtkProp  properties  of  the  volume,  two  VTK  functions  are  defined.  The  first  defines  the  opacity  of  the  volume  as  a  piecewise  function  using  the  vtkPiecewiseFunction  class,  allowing  for  the  definition  of  the  degree  of  transparency  as  it  is  distributed  along  the  pixel  value  range.  The  color  distribution  is  handled  by  the 
vtkColorTransferFunction  filter  in  which  the  RGB  color  space  and  the  distribution  range  of  pixel 

mapping  is  defined.    The  opacity  and  the  color  transfer  function  are  combined  to  create  a 
vtkVolumeProperty  object.  Also,  in  the  vtkVolumeProperty  object  the  interpolation  between  the 

voxels  is  defined,  cubic  interpolation  was  used  in  this  implementation.  The  volume  properties  are  passed  to  the  mapper  object  along  with  the  data  source  for  the  visualization  to  occur.  In  this  implementation 
vtkVolumeRayCastMapper 

was 

used 

in 

combination 

with 

the 

vtkVolumeRayCastCompositeFuntion which defines the type of ray mapping. 

46   

The  graphics  part  of  the  pipeline  starts  with  the  creation  of  the  object  to  be  rendered  which  defines  the  3D  volume.  The  3D  ultrasound  dataset  outputted  from  the  vtkVolumeRayCastMapper is  passed  as  an  input  connection  a  vtkVoume  object.  The  next  step  in  the  graphics  pipeline  is  defining  a 
vtkRenderer  objects  which  performs  the  rendering  of  the  volume.  Each  individual  renderer  is  capable 

of  rendering  multiple  graphics  objects.  The  rendering  process  takes  place  in  a  renderer  window.  The 
vtkRenderWindow  object  is  capable  of  accommodating  multiple  renderers  and  defines  the  world  in 

which  each  individual  rendering  process  takes  place.  The  interactions  between  the  user  and  the  objects  in  the  rendering  window  are  handled  via  vtkRenderWindowInteractor  class  objects.  Multiple  interactors  can  exist  in  a  rendering  window  for  our  purposes  only  one  interactor  is  associated  with  the  volume  object.  Figure  24  is  a  graphical  representation  of  the  display  pathway  that  the  ultrasound  volume dataset undergoes. The pathway is divided into two parts the visualization part transforming the  raw data into a volume with the desired visualization properties. The properties that can be defined may  include  opacity,  color,  texture,  contouring  and  various  lighting  and  mapping  effects.   The  second  part  of  the  pathway  encompasses  properties  that  define  the  rendering  process  as  well  as  the  display  scene.  Each  display  scene  is  comprised  of  actors  to  be  displayed,  rendering  processes  and  other  global  properties.    The  interactor  used  by  the  Display  Control  allows  the  user  to  perform  simple  operations  in  the  scene.  These  types  of  operations  do  not  affect  the  overall  processes  flow  of  the  application  and  only  include  operations  such  as  zooming  in  and  out  of  the  displayed  ultrasound  volume  as  well  as  rotational  transformations.  The  user  interactions  associated  with  the  selection  and  visualization  of  ROIs  are  handled by a combination of VTK widgets and data extraction objects. Although, VTK has at its disposal a  variety  of  widgets,  the  implementation  of  the  Spectral  Analysis  Module  uses  a  vtkBoxWidget  object.  Other widgets such as the spline widget may be utilized at a later time to allow the user the selection of  irregular  shape  ROIs.  The  vtkBoxWidget  class  allows  of  the  creation  of  a  3D  rectangular  box  object  to  47   

be  placed  in  the  scene  along  with  the  ultrasound  volume.  The  advantage  of  utilizing  VTK  widget  objects  is that they provide a comprehensive set of interaction capabilities while being associated with graphical  object present in the display scene. The widget class contains its own internal visualization and graphical  pipeline  without  requiring  a  lot  of  intervention  from  a  development  perspective.  In  this  application  the 
vtkBoxWidget  object  was  utilized  in  order  to  draw  on  the  scene  a  visual  wireframe  which  delineates 

the volume to be extracted for spectral analysis. The faces of the box widget can be moved freely by the  user  in  order  to  adjust  the  volume  prior  to  extraction.  The  six  points  defining  the  box  widget  in  combination  with  the  voxel  dimensions  of  the  rendered  ultrasound  volume  were  used  to  compute  the  dimension  for  the  volume  needed  to  be  extracted.   The  extraction  process  itself  was  performed  using  another  VTK  class  object  called  vtkExtractVOI.  The  input  connection  to  the  vtkExtractVOI  object  was  the  unfiltered  and  unprocessed  dataset  as  it  was  first  stored  in  a  vtkImageData  structure.  Once  the  desired  volume  was  extracted  the  Display  Control  inserts  the  extracted  vtkImageData  output  to  the Data Repository and signals the Main Control.    The  Parametric  Image  generation  module  follows  the  same  structure  and  in  essence  is  an  extension  of  Spectral  Analysis.  The  purpose  of  this  module  is  to  generate  parametric  maps  based  on  each individual spectral parameter. The main difference between the two is that the Parametric Module  uses  a  slightly  modified  algorithm  to  generate  the  parametric  maps  which  is  based  on  a  sliding  window  algorithm.  While  the  Spectral  analysis  computes  averaged  global  values  for  each  individual  spectral  parameter  pertaining  to  the  user  selected  ROI,  the  Parametric  Module  uses  a  smaller  window  of  data  points  to  compute  the  spectral  values.  The  averaging  performed  on  a  large  user  selected  ROI,  can  potentially  misrepresent  the  true  values  of  the  spectral  parameters  due  to  a  heterogeneous  tissue  composition. The sliding window algorithm allows the user to investigate and find the balance in the size  of  the  averaged  region.  The  larger  the  window  size  the  more  computationally  expensive  the  image  generation  becomes.  Furthermore  the  large  window  size  increases  the  influence  of  data  points  residing  48   

further  from  the  current  calculation  point.  Figure  25  illustrates  the  main  concepts  used  to  generate  parametric  images  from  the  spectral  parameters.   The  first  step  in  the  generation  of  parametric  images  is  the  definition  of  the  size  for  the  sliding  window  by  the  user,  referring  to  the  number  of  scan  lines  (x  direction)  and  number  of  data  points  per  scan  line  (y  direction)  illustrated  in  Figure  25.  The  window  is  used  to  compute  the  spectral  values  pertaining  to  the  position  at  the  center  of  the  window.  Therefore,   resulting  parametric  images  generated  are  2x  the  widow  size  shorter  in  height  and  2x  the  window  size  smaller  in  width.The  second  step  is  the  extraction  of  the  data  point  required  to  compute  the  averaged  power  spectra  for  the  window  in  the  current  position.  The  third  step  involves  the  normalization  of  the  averaged  power  spectra  with  the  reference  power  spectrum.  The  computation  of  the  values  for  each  individual  spectral  parameter,  MBF,  0MHz  intercept  and  spectral  slope  are  extracted  from  the  normalized  power  spectrum.  The  values  are  placed  in  separate  data  arrays  corresponding  to  each  individual parameter and the window changes position by one scan line in the X direction. Once the end  of the scan  lines has been reached, the sliding window changes  position back to the first scan line and  a  window size length down in the Y direction. Once the sliding window has traversed the entire image, the  resulting  parametric  images  are  displayed  for  the  user  to  apply  custom  color  transfer  functions.   When  the  process  is  performed  on  an  ultrasound  volume,  the  sliding  window  repeats  the  process  over  to  the  next available frame.   The  combination  of  Spectral  Analysis  Module  with  the  Parametric  Image  Module  creates  a  powerful  platform  allowing  for  a  variety  of  applications  in  the  Medical  Biophysics  field  when  spectral  analysis  is  applicable.  This  platform  has  been  used  with  success  in  performing  pre  and  post  treatment  spectral  analysis  of  tumors  in  mouse  model  xenographs.  In  the  work  presented  in  this  thesis,  this  platform  was  used  to  perform  spectral  analysis  and  generate  parametric  maps  of  spectral  parameters  for  low  frequency  ultrasound  RF  data  obtained  from  patients  with  prostatic  carcinomas.  Another  application  where  this  platform  is  being  utilized  to  perform  spectral  analysis  and  parametric  map  49   

generation  involves  the  treatment  monitoring  in  a  currently  undergoing  study  of  patients  with  locally  advance  breast  cancer.  The  goal  of  the  study  is  the  classification,  at  the  early  stages  of  the  treatment  process,  of  patients  responding  to  the  treatment  versus  patients  on  which  a  particular  treatment  is  not  having an effect.    

 

 

50   

Figures 

 
Figure 1: Sinusoidal waveform representation of a sound wave.  

  51   

Figure  2:  (Left)  Longitudinal  representation  of  a  sound  wave  where  a  particle's  motion  (rarefaction  and  compression)  is  parallel  with  the  direction  of  propagation.   (Right)  Shear  wave  representation  of  a  sound  wave  where  the  particle  motion  is  perpendicular to the direction of wave propagation.  

 

 
Figure  3:  Pictorial  representation  of  basic  building  components  of  an  ultrasound  transducer.  Electrodes  apply  alternating  potential  difference  causing  a  piezoelectric  effect.  As  a  result  a  piezoelectric  crystal  vibrates  at  high  cyclical  rates  therefore  converting  the  electrical  energy  into  a  mechanical  sound  wave.  The  result  of  the  electrical  input  is  a  corresponding  ultrasound pulse.  

52   

 
Figure  4:  (Left)  Representative  Amode  trace  prior  to  envelope  detection  through  the  middle  of  the  prostate  acquired  using  an  Ultrasonix  RP  scanner  with  a  transrectal  probe.  (Right)  A  typical  transverse  Bmode  image  of  the  prostate  composed  of  multiple Amode traces after signal envelope detection and processing to create a quality contrast twodimensional image of  the prostate gland. 

53   

 
Figure  5:  The  interaction  of  the  incident  plane  wave  of  wavelength  smaller  than  the  object  which  cause  portion  of  the  incident  wave  to  reflect  and  refract.  The  ratio  of  the  incident  wave  to  the  reflected  wave  requires  knowing  the  acoustic  impedance for both mediums Z1 and Z2  and is dependent on the incident angle 1  and refraction angle 2 . 

54   

 
Figure 6: Values for the mean and standard deviation for spectral intercept and midband fit. These values represent the data  from  the  learning  set  used  in  training  the  neural  classifier.  Cancerous  set  comprises  of  29  independent  ROI's  .  BPH    and  benign  set  comprises  of  a  combined  set  of  60  independent  ROI's.  (Fellepa  at  al,  Typing  of  Prostate  Tissue  by  Ultrasonic  Spectral Analysis, 1996)[30] 

55   

 
Figure 7: (Top) Highfrequency ultrasound images of Acute Myeloid Leukemia (AML) cell pellets submerged into saline buffer  then  treated  with  chemotherapeutic  agent  cisplatinum  for  0,6,12,24  and  48  hours  inducing  a  variable  degree  of  apoptotic  cell  death.  (Bottom)  Representative  corresponding  histological  analysis  stained  with  H&E,  depicting  the  degree  of  apoptotic  cells  present  in  the  pellet.(Czarnota  et  al,    Ultrasound  imaging  of  apoptosis:  highresolution  noninvasive  monitoring  of  programmed cell death in vitro, in situ and in vivo,1999) [35] 

56   

 
Figure  8:  (First  row)  Representative  lowfrequency  ultrasound  images  of  PC3  tumors  indicating  variability  in  echogenicity  depending  on  treatment  regimen.  In  left  to  right  order:  untreated  tumor,  8  Gy  radiation,  antivasculature  microbubble  treatment and 8Gy radiation followed by , antivasculature microbubble treatment. (Second row) Normalized power spectra  taken  before  treatment  and  24  hours  following  treatment  for  each  group.  (Third  row)  Low  magnification  light  microscopy  images  of  TUNEL  stained  PC3  tumor  slices.  (Forth  row)  Light  microscopy  images  of  H&E  stained  PC3  tumor  slices  at  high  magnification.  (Papanicolau,  Conventional  frequency  ultrasound  detection  of  tumor  response  in  vivo  to  cancer  treatment  administration,2009)[41] 

57   

 
Figure 9: Schematic of the biplanar transrectal probed used in this experiment. (Courtesy of Vermon S.A.) 

58   

 
Figure 10: Schematic of the direction of the scan and the probes realive position to the prostate gland. 

 

59   

 
Figure 11: Depiction of 6dB analysis window determined from the power spectra of the reference pulse. 

60   

 

 
Figure  12:    The  red  curve  is  a  representative  power  spectra  corresponding  to  an  ROI  representative  of  the  entire  prostate  gland.    The  black  curve  is  a  power  spectra  collected  from  a  phantom  to  be  used  for  normalization,  taken  with  the  same  machine  settings  as  the  one  collected  from  tissue.  The  blue  curve  is  the  resulting  normalized  power  spectra  obtained  from  the  subtraction  of  the  tissue  power  spectra  by  the  phantom  power  spectra.  The  linear  regression  is  shown  with  the  yellow  line corresponding to the 6dB analysis window.  

61   

 
Figure  13:  The  main  steps  followed  in  our  analysis  mechanism  are  illustrated  here  starting  with  the  Bmode  reconstruction  from  raw  RF  data  shown  on  the left  most  of  the image.  The  second  step  is  the  generation  of  the  parametric  images  for  each  of  the  three  spectral  parameters  under  investigation.  The  second  image  is  a  representative  parametric  image  generated  using  the  midband  fit  parameter.  The  second  last  image  is  the  corresponding  image  of  the  manual  segmentation  of  the  parametric  image  in  which  only  the  areas  of  the  prostatic  gland  are  included.  Also  in  this  stage  the  threshold  value  is  discovered  and  in  turn  applied  to  all  the  parametric  slides  for  each  prostate.  In  the  last  phase  only  the  thresholded  areas  where the MBF parameter suggests high likelihood of carcinoma presence in the prostate are extracted. The areas within the  bounds of the prostate still present in the image are then added to compute the total are of suspicion.  

62   

 
Figure  14:  Top  row  displays  ultrasound  images  reconstructed  from  RF  data.  Each  individual  image  represents  a  stationary  plane through the prostate in the direction base to apex. All the images shown are obtained from one representative patient  representing  4  acquisition  steps  which  are  separated  by  a  5  mm  gap  in  between.  The  second  row  displays  the  resulting  parametric  images  of  the  MBF  parameter  from  the  same  planes  obtained  as  a  result  of  spectral  analysis.  The  third  row  displays  the  resulting  parametric  images  of  the  spectral  intercept  obtained  from  the  same  planes.  The  last  row  displays  the  corresponding  slices  obtained  from  histological  analysis.  The  histology  slices  are  representative  4  µm  slices  obtained  from  5  mm  blocks  which  correspond  to  the  same  regions  for  which  the  ultrasound  RF  data  was  collected.  On  the  histology  images  areas of prostatic carcinoma are contoured with green color. Areas of abnormal glandular activity are contoured in orange.  

    63   

 
Figure  15:  (Left)  A  graphical  representation  of  the  MBF  percent  area  versus  the  corresponding  percent  area  from  the  histopathological findings for all the steps collected from Patient 1. A linear regression analysis is showing with the solid line.  (Right) The 0MHz spectral intercept versus the hisptopathological analysis corresponding to the percent disease area as well  as a linear regression noted with a solid line.  

64   

 
Figure  16:  Cumulative  scatter  plot  depicting  the  percent  disease  area  obtained  from  MBF  parameter  versus  the  percent  disease  area  obtained  from  histological  analysis.  The  data  shown  in  this  graph  represents  all  the  data  pairs  from  individual  steps  collected  for  the  entire  patient  population  which  participated  in  the  study.  The  solid  line  represents  the  best  fit  line  obtained from liner regression with the corresponding 95% confidence interval is depicted with a broken line.  

65   

 
Figure  17:  Cumulative  scatter  plot  depicting  the  percent  disease  area  obtained  from  the  spectral  intercept  parameter  versus  the percent disease area obtained from histological analysis. The data shown in this graph represents all the data pairs from  individual steps collected for the entire patient population which participated in the study. The solid line represents the best  fit line obtained from linear regression with the corresponding 95% confidence interval depicted with a broken line. 

66   

 
Figure  18:  In  this  graph  the  each  point  represents  a  patient  who  participated  in  our  study.  The  Yaxis  shows  the  average  percent  disease  area  computed  from  all  the  slides  belonging  to  each  individual  patient.  The  Xaxis  is  the  average  percent  disease area calculated by adding the results of histopathological analysis of each slide pertaining to each individual patient.  The solid line represents the linear regression goodness of fit with the 95 % confidence interval shown in the broken line.  

67   

 
Figure 19: In this graph the each point represents a patient who participated in or study. The Yaxis shows the average 0MHz  intercept  percent  disease  area  computed  from  all  the  slides  belonging  to  the  patient.  The  Xaxis  is  the  average  percent  disease  area  calculated  by  adding  the  results  of  histopathological  analysis  of  each  slide  pertaining  to  the  patient.  The  solid  line represents the linear regression goodness of fit with the 95 % confidence interval shown in the broken line. 

68   

 
Figure  20:  High  level  conceptual  model  of  application  architecture  depicting  the  various  layers  and  their  scope.  The  vtkDotNetWrapper  acts  a  middleware  layer  of  communication  joining  the  native  .NET  framework  with  the  VTK  win32  librariers.  

 

69   

 
Figure  21:  Representative  elastrogram  obtained  from  the  same  patient  shown  in  Figure  14.  The  elastogram  was  obtained  using  Ultrasonix  RP  ultrasound  system  with  a  curvilinear  transrectal  transducer pulsed  at  10  MHz  with  a  sampling  frequency  of  20  MHz.   The  color  bar  on  the  right  hand  side  shows  the  color  distribution  corresponding  to  the  relative  tissue  stiffness  distribution.  

 

70   

 
Figure  22:   A  visual  representation  of  the  various  components  comprising  of  the  Spectral  Analysis  Module.  Each  individual  component communicates with the rest through a system of delegates passing through the Main Container.  

 

71   

 
Figure 23:  An illustration of the communication pathways between the various components in the Spectral Analysis Module.  In  this  scenario,  the  System  Control  invokes  a  frame  change  event  (  the  frame  number  from  an  multiframe  ultrasound  file)  with  the  Main  Control.  Since,  all  the  available  components  are  registered  with  the  Main  Control,  the  Main  invokes  a  global  change frame event.  

 

72   

 
Figure  24:  Visual  representation  of  the  display  pipeline  utilized  by  the  Display  Control  component.  The  visualization  pipeline  above the dashed line shows the VTK objects utilized in the visualization process prior to rendering. The red arrows delineate  the classes which define how the dataset will be visualized. These objects can encompass various filters and functions which  define  the  visualization  properties  of  an  object  and  may  include  color,  opacity,  lighting,  texture,  etc.  The  path  shown  with  black  arrows  shows  the  path  which  the  dataset  takes  from  the  basic  structure  through  the  various  filters  which  change  the  state  of  the  data  to  create  the  volume  prior  to  rendering.  Bellow  the  dashed  line  is  the  graphical  pipeline.  Once  the  volume  object  is  created  and  the  visualization  properties  are  added,  the  volume  object  undergoes  through  the  rendering  process.  Finally the result of the rendering process is displayed by the rendering window.   

73   

 
Figure  25:    An  illustration  of  the  steps  taken  in  generating  parametric  images  from  spectral  parameters  using  a  sliding  window  algorithm.  Step  1  defines  the  size  of  the  sliding  window,  referring  to  the  number  of  scan  lines  (x  direction)  and  number  of  data  points  per  scan  line  (y  direction).  The  window  is  used  to  compute  the  spectral  values  pertaining  to  the  position  at  the  center  of  the  window.  The  second  step  is  the  extraction  of  the  data  point  required  to  compute  the  averaged  power  spectra  for  the  window  in  the  current  position.  The  third  step  involves  the  normalization  of  the  averaged  power  spectra  and  computation of  the  values  for  each  individual  spectral  parameter,  MBF,  0MHz  intercept  and  spectral  slope.  The  values are placed in separate data arrays and the window changes position by one scan line in the X direction. Once the end  of the scan lanes has been reached, the sliding window changes position back to the first scan line and window size down in  the  Y  direction.  Once  the  sliding  window  has  traversed  the  entire  image,  the  resulting  parametric  images  are  displayed  for  the  user  to  apply  custom  color  transfer  functions.    When  the  process  is  performed  on  an  ultrasound  volume,  the  sliding  window repeats the process over to the next available frame. 

 

74   

Tables 
 

Gleeson  PSA  Patient#  Age  (ng/ml)  stage 

Clinical  stage/ 

Clinical stage /secondary 

#  of  Lymph #  of  Lymph  nodes  examined  nodes  involved  Path state 

(out of 10)  Primary 

1  2  3  4  5  6 

65  74  74  68  68  53 

11  34.92  7.12  7.99  6.36  5 

9  8  9  7  9  7 

4  3  4  3  4  3 

5  5  5  4  5  4 

left 5; right 3 0  4  6  0  4  5  0  1  0  1  0  pT2  pT3a  pT3a  pT3a  pT3a 

7  8  9 

72  67  69 

3.33  7.8  8.77 

7  7  7 

3  4  4 

4  3  3 

0  0  0 

0  0  0 

pT3a  pT3a  pT2 

Table 1  Clinical relevant patient characteristics for the first group of participants in the study. 

  

 

75   

 

Curvilinear Array 

Linear Array 

Center Frequency 

6.5   +/ 10% MHz 

7 +/ 10% MHz 

Number of Elements 

128 

128 

Pitch 

0.205 mm 

0.42 mm 

Curvature Radius 

10 mm 

 none 

Elevation 

7 mm (measured 4.5 mm) 

 5 mm 

Elevation Focus 

35 mm 

 20 mm 

Bandwidth 

 > 60% 

 > 60% 

Matching 

none 

none 

Table  2   Acoustic  specifications  for  the  biplanar  transrectal  probe,  comprising  of  two  linear  array  transducers.  (Courtesy  of  Vermon S.A. and Ultrasonix) 

             

76   

Percent Disease Area (Patient 1)
Slice #  1  2  3  4  Average  H&E  7.82  18.17  12.3  8.8  11.8  MBF  11.08  19.3  15.1  8.73  13.55  0 MHz  9.67  6.83  5.6  5.9  7.0 

Table  3    Summarized  results  from  Patient  1.  The  slice  number  represents  the  probes  position  as  it  moves  away  from  the  base  of  the  prostate.  The  H&E  column  is  the  result  of  the  histological  analysis  preformed  by  a  pathologist,  which  is  used  as  our gold standard for our results are compared against it. 

 

 

77   

Bibliography 
[1]  [2]  [3]    S. American Cancer, "American Cancer Society.: Cancer Facts and Figures 2010," ed, 2010.  B.  S.  W.  Catalona  Wj,  "Nervesparing  radical  prostatectomy:  evaluation  of  results  after  250  patients," The Journal of Urology, vol. 3, pp. 538543, 1990.  H. Zincke, et al., "Radical prostatectomy for clinically localized prostate cancer: longterm results  of  1,143  patients  from  a  single  institution,"  Journal  of  clinical  oncology  :  official  journal  of  the  American Society of Clinical Oncology, vol. 12, pp. 22432245, Nov 1994.  W.  Duncan,  et  al.,  "Carcinoma  of  the  prostate:  results  of  radical  radiotherapy  (19701985),"  International journal of radiation oncology, biology, physics, vol. 2, pp. 365367, 1993.  M.  B.  Garnick,  "Prostate  cancer:  screening,  diagnosis,  and  management,"  Annals  of  internal  medicine, vol. 10, pp. 804818, 1993.  G.  Sandblom,  et  al.,  "Clinical  consequences  of  screening  for  prostate  cancer:  15  Years  followup  of a randomised controlled trial in Sweden," European Urology, vol. 46, pp. 717723, 2004.  D. S. Smith, et al., "Use of lower prostate specific antigen cutoffs for prostate cancer screening in  black and white men," Journal of Urology, vol. 160, pp. 17341738, 1999.  P.  H.  Gann,  et  al.,  "A  prospective  evaluation  of  plasma  prostatespecific  antigen  for  detection  of  prostatic cancer," Journal of the American Medical Association, vol. 273, pp. 289294, 1995.  P.  Lodding,  et  al.,  "Characteristics  of  screening  detected  prostate  cancer  in  men  50  to  66  years  old  with  3  to  4  ng./Ml.  Prostate  specific  antigen,"  Journal  of  Urology,  vol.  159,  pp.  899903,  1998.  D.  S.  Smith,  et  al.,  "Longitudinal  screening  for  prostate  cancer  with  prostatespecific  antigen,"  Journal of the American Medical Association, vol. 276, pp. 13091315, 1996.  C.  H.  Harris,  et  al.,  "Prospective  longitudinal  evaluation  of  men  with  initial  prostate  specific  antigen levels of 4.0 ng./ml. or less," Journal of Urology, vol. 157, pp. 17401743, 1997.  J. A. Eastham, et al., "Variation of Serum ProstateSpecific Antigen Levels: An Evaluation of Year toYear  Fluctuations,"  Journal  of  the  American  Medical  Association,  vol.  289,  pp.  26952700,  2003.  B.  Carter,  et  al.,  "Prostatespecific  antigen  variability  in  men  without  prostate  cancer:  Effect  of  sampling interval on prostatespecific antigen velocity," Urology, vol. 45, pp. 591596, 1995.  R.  L.  Waterhouse  and  M.  I.  Resnick,  "The  use  of  transrectal  prostatic  ultrasonography  in  the  evaluation  of  patients  with  prostatic  carcinoma,"  Journal  of  Urology,  vol.  141,  pp.  233239,  1989.  L. T. Szabo, Diagnostic ultrasound imaging: inside out: Elsevier Academic Press  2004.  K.  K.  Hodge,  et  al.,  "Ultrasound  guided  transrectal  core  biopsies  of  the  palpably  abnormal  prostate," Journal of Urology, vol. 142, pp. 6670, 1989.  L.  A.  Eskew,  et  al.,  "Systematic  5  region  prostate  biopsy  is  superior  to  sextant  method  for  diagnosing carcinoma of the prostate," Journal of Urology, vol. 157, pp. 199203, 1997.  Faran,  Jr.,  "Sound  Scattering  by  Solid  Cylinders  and  Spheres,"  The  Journal  of  the  Acoustical  Society of America, vol. 23, pp. 405418, 1951.  R.  E.  Baddour, et  al.,  "Highfrequency  ultrasound  scattering  from  microspheres  and  single  cells,"  The Journal of the Acoustical Society of America, vol. 117, pp. 934943, 2005.  E.  J.  Feleppa  and  M.  M.  Yaremko,  "Ultrasonic  Tissue  Characterization  for  Diagnosis  and  Monitoring," Engineering in medicine & biology, vol. 6, pp. 1826, 1987.  F.  L.  Lizzi,  "Theoretical  framework  for  spectrum  analysis  in  ultrasonic  tissue  characterization,"  vol. 73, p. 1366, 1983. 

[4]  [5]  [6]  [7]  [8]  [9] 

[10]  [11]  [12] 

[13]  [14] 

[15]  [16]  [17]  [18]  [19]  [20]  [21] 

78   

[22]  [23]  [24] 

[25] 

[26]  [27]  [28]  [29]  [30]  [31] 

[32] 

[33]  [34] 

[35]  [36]  [37]  [38]  [39]  [40]  [41] 

[42] 

F.  L.  Lizzi,  et  al.,  "Theoretical  framework  for  spectrum  analysis  in  ultrasonic  tissue  characterization," The Journal of the Acoustical Society of America, vol. 73, pp. 13661373, 1983.  F. L. Lizzi, et al., "Ultrasonic spectrum analysis for tissue evaluation," Pattern Recognition Letters,  vol. 24, pp. 637658, 2003.  F.  L.  Lizzi,  et  al.,  "Statistics  of  ultrasonic  spectral  parameters  for  prostate  and  liver  examinations,"  IEEE  Transactions  on  Ultrasonics,  Ferroelectrics,  and  Frequency  Control,  vol.  44,  pp. 935942, 1997.  F.  L.  Lizzi,  et  al.,  "Relationship  of  Ultrasonic  Spectral  Parameters  to  Features  of  Tissue  Microstructure," Ultrasonics, Ferroelectrics and Frequency Control, IEEE Transactions on, vol. 34,  pp. 319329, 1987.  F.  L.  Lizzi,  et  al.,  "Comparison  of  theoretical  scattering  results  and  ultrasonic  data  from  clinical  liver examinations," Ultrasound in Medicine & Biology, vol. 14, pp. 377385, 1988.  E.  J.  Feleppa,  et  al.,  "Ultrasonic  spectralparameter  imaging  of  the  prostate,"  International  Journal of Imaging Systems and Technology, vol. 8, pp. 1125, 1997.  E.  J.  Feleppa,  et  al.,  "Diagnostic  spectrum  analysis  in  ophthalmology:  A  physical  perspective,"  Ultrasound in Medicine and Biology, vol. 12, pp. 623631, 1986.  T.  Noritomi,  et  al.,  "In  vitro  investigation  of  lymph  node  metastasis  of  colorectal  cancer  using  ultrasonic spectral parameters," Ultrasound in Medicine and Biology, vol. 24, pp. 235243, 1998.  E.  J.  Feleppa,  et  al.,  "Typing  of  prostate  tissue  by  ultrasonic  spectrum  analysis,"  Ultrasonics,  Ferroelectrics and Frequency Control, IEEE Transactions on, vol. 43, pp. 609619, 1996.  E.  J.  Feleppa,  et  al.,  "Progress  in  twodimensional  and  threedimensional  ultrasonic  tissuetype  imaging  of  the  prostate  based  on  spectrum  analysis  and  nonlinear  classifiers,"  Molecular  Urology, vol. 3, pp. 303311, 1999.  E. J. Feleppa, et al., "Twodimensional and threedimensional tissuetype imaging of the prostate  based  on  ultrasonic  spectrum  analysis  and  neuralnetwork  classification,"  Proceedings  of  SPIE   The International Society for Optical Engineering, vol. 3982, pp. 152160, 2000.  W. Gnadt, et al., "Classification of prostate tissue using neural networks," pp. 35693572.  E. J. Feleppa, et al., "New developments in tissuetype imaging (TTI) for guiding prostate biopsies  and for planning and  monitoring  treatment of prostate  cancer," in Ultrasonics Symposium, 2004  IEEE, pp. 834837.  G.  J.  Czarnota,  "Ultrasound  imaging  of  apoptosis:  highresolution  noninvasive  monitoring  of  programmed cell death in vitro, in situ and in vivo," vol. 81, pp. 520527, 1999.  M.  C.  Kolios,  et  al.,  "Ultrasonic  spectral  parameter  characterization  of  apoptosis,"  Ultrasound  in  Medicine and Biology, vol. 28, pp. 589597, 2002.  G.  J.  Czarnota,  et  al.,  "Ultrasonic  biomicroscopy  of  viable,  dead  and  apoptotic  cells,"  Ultrasound  in Medicine and Biology, vol. 23, pp. 961965, 1997.  R.  M.  Vlad,  et  al.,  "Quantitative  Ultrasound  Characterization  of  Cancer  Radiotherapy  Effects  In  Vitro," International Journal of Radiation Oncology Biology Physics, vol. 72, pp. 12361243, 2008.  R.  M.  Vlad,  et  al.,  "Quantitative  ultrasound  characterization  of  responses  to  radiotherapy  in  cancer mouse models," Clinical Cancer Research, vol. 15, pp. 20672075, 2009.  R.  M.  Vlad,  et  al.,  "Highfrequency  ultrasound  for  monitoring  changes  in  liver  tissue  during  preservation," Physics in Medicine and Biology, vol. 50, pp. 197213, 2005.  Naum  Papanicolau,  "Conventional  Frequency  Ultrasound  Detection  of  Tumor  Responce  In  Vivo  to  Cancer  Treatment  Administration,"  MSc,  Electrical  and  Computer  Engineering,  Ryerson  Univeristy, Toronto, 2009.  M. L. Oelze, et al., "Differentiation and characterization of rat mammary fibroadenomas and 4T1  mouse  carcinomas  using  quantitative  ultrasound  imaging,"  IEEE  Transactions  on  Medical  Imaging, vol. 23, pp. 764771, 2004.  79 

 

[43]  [44] 

[45]  [46] 

[47]  [48]  [49]  [50]  [51]  [52] 

[53]  [54]  [55]  [56] 

M.  L.  Oelze,  et  al.,  "Ultrasonic  quantification  of  the  tissue  microstructure  of  spontaneous  mammary tumors in rats," in IEEE Ultrasonics Symposium, Munich, 2002, pp. 13691372.  M.  L.  Oelze,  et  al.,  "Differentiation  of  tumor  types  in  vivo  by  scatterer  property  estimates  and  parametric  images  using  ultrasound  backscatter,"  in  IEEE  Ultrasonics  Symposium,  Honolulu,  2003, pp. 10141017.  F.  Dong,  et  al.,  "Nonlinearity  parameter  for  tissuemimicking  materials,"  Ultrasound  in  Medicine  and Biology, vol. 25, pp. 831838, 1999.  D.  Sage,  et  al.,  "MIJ,"  1.3.6  ed:  Biomedical  Image  Group  (BIG),  Ecole  Polytechnique  Fédérale  de  Lausanne  (EPFL),  Switzerland,  2009,  pp.  A  Java  package  for  bidirectional  communication  and  data exchange from Matlab to ImageJ.  Kitware. (Visualization Toolkit). Available: http://www.vtk.org/  M.  Frank,  "Visualization  Toolkit  for  C#  in  Scope  of  ROTOR  Project,"  Master  of  Science,  Department of Computer Science and Engineering, University of West Bohemia, Pilsen, 2003.  M.  Frank.  (2003,  January  2009).  VTK.NET.  Available: http://graphics.zcu.cz/research/VTKforNET/download/index.html  S. K. Alam, et al., "Prostate elastography  Preliminary in vivo results," 2005, pp. 339345.  P.  Chaturvedi,  et  al.,  "Ultrasonic  and  elasticity  imaging  to  model  diseaseinduced  changes  in  softtissue structure," Medical Image Analysis, vol. 2, pp. 325338, 1998.  J.  Ophir,  et  al.,  "Elastography:  Ultrasonic  estimation  and  imaging  of  the  elastic  properties  of  tissues," Proceedings of the Institution of Mechanical Engineers, Part H: Journal of Engineering in  Medicine, vol. 213, pp. 203233, 1999.  J.  Ophir,  et  al.,  "Elastography:  Ultrasonic  imaging  of  tissue  strain  and  elastic  modulus  in  vivo,"  European Journal of Ultrasound, vol. 3, pp. 4970, 1996.  T. J. Hall, "AAPM/RSNA Physics Tutorial for Residents: Topics in US  Beyond the Basics: Elasticity  Imaging with US," Radiographics, vol. 23, pp. 16571671, 2003.  E.  S.  Burnside,  et  al.,  "Differentiating  benign  from  malignant  solid  breast  masses  with  US  strain  imaging," Radiology, vol. 245, pp. 401410, 2007.  A.  Thomas,  et  al.,  "Realtime  elastography   An  advanced  method  of  ultrasound:  First  results  in  108 patients with breast lesions," Ultrasound in Obstetrics and Gynecology, vol. 28, pp. 335340,  2006. 

   

80   


