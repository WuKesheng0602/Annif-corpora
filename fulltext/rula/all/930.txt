Pricing Spread Options under Levy Jump-Diffusion Models

by Matthew Cane B. Eng. Mgmt., Mechanical Engineering and Management McMaster University Hamilton, Ontario, Canada, 2009

A Thesis presented to Ryerson University in partial fulfillment of the requirements for the degree of Master of Science in the Program of Applied Mathematics

Toronto, Ontario, Canada, 2011 c Matthew Cane, 2011

I hereby declare that I am the sole author of this thesis or dissertation. I authorize Ryerson University to lend this thesis or dissertation to other institutions or individuals for the purpose of scholarly research.

I further authorize Ryerson University to reproduce this thesis or dissertation by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

ii

Pricing Spread Options under Levy Jump-Diffusion Models Master of Science, 2011 Matthew Cane Applied Mathematics Ryerson University

Abstract
This thesis examines the problem of pricing spread options under market models with jumps driven by a Compound Poisson Process and stochastic volatility in the form of a CIR process. Extending the work of Dempster and Hong, and Bates, we derive the characteristic function for two market models featuring normally distributed jumps, stochastic volatility, and two different dependence structures. Applying the method of Hurd and Zhou we use the Fast Fourier Transform to compute accurate spread option prices across a variety of strikes and initial price vectors at a very low computational cost when compared to Monte-Carlo pricing methods. We also examine the sensitivities to the model parameters and find strong dependence on the selection of the jump and stochastic volatility parameters.

iii

Acknowledgments
My gratitude and thanks goes to my supervisor Dr. Pablo Olivares, and my co-supervisor Dr. Marcos Escobar for their guidance, help and motivation; to all my classmates who persevered through unending assignments with me; to my coworkers for their help and understanding of the irritability that comes with all-night programming sessions followed by early work days; to my family for their support and encouragement even during the hours when it seemed this would never get finished; and to Kristy, who pushed me to go after this degree and my dreams, who stood by me and worked with me through all the late nights in the lab, who listened to my complaints about a lack of sleep without once suggesting that I start my work earlier next time, and whose unwavering belief in me made completing this project possible.

iv

Contents
1 Introduction 2 Derivatives and the Pricing Problem 2.1 2.2 The Pricing Problem . . . . . . . . . . . . . . . . . . . . . . . Derivatives: Definitions . . . . . . . . . . . . . . . . . . . . . 2.2.1 2.2.2 Spread Options . . . . . . . . . . . . . . . . . . . . . . Other Multivariate Derivatives . . . . . . . . . . . . . 1 4 4 5 5 6 9 9 10 11 15 17 17 17 18 19 20 20 29 29 32

3 Pricing Methods 3.1 3.2 Monte Carlo Simulation . . . . . . . . . . . . . . . . . . . . . Fourier Transform Pricing . . . . . . . . . . . . . . . . . . . . 3.2.1 Hurd and Zhou's Method . . . . . . . . . . . . . . . . 3.2.2 Greeks . . . . . . . . . . . . . . . . . . . . . . . . . . .

4 Market Models 4.1 Univariate Models . . . . . . . . . . . . . . . . . . . . . . . . 4.1.1 4.1.2 4.1.3 4.2 4.2.1 Black-Scholes . . . . . . . . . . . . . . . . . . . . . . . Heston Stochastic Volatility . . . . . . . . . . . . . . . Bates . . . . . . . . . . . . . . . . . . . . . . . . . . . Multivariate Bates . . . . . . . . . . . . . . . . . . . .

Multivariate Models . . . . . . . . . . . . . . . . . . . . . . .

5 Numerical Computation of Spread Option Prices 5.1 5.2 Pricing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Parameter Sensitivities . . . . . . . . . . . . . . . . . . . . . . v

5.3

Effect of Discretization and Truncation . . . . . . . . . . . . .

42 45

6 Conclusion

vi

List of Tables
5.1 5.2 5.3 5.4 5.5 5.6 5.7 5.8 Comparison of Monte-Carlo method with FFT method for proportional volatility case for umin = 20. . . . . . . . . . . . Comparison of Monte-Carlo method with FFT method for Independent Volatilities case for umin = 20. . . . . . . . . . . Comparison of Monte-Carlo method with FFT method for proportional volatility case while varying jump parameters . . Run times in seconds for FFT vs. Monte-Carlo Simulation, u ¯min = 20 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Comparison of Prices for variation in Moneyness and Time to Maturity T . . . . . . . . . . . . . . . . . . . . . . . . . . . Comparison of Prices for Variation in Asset-Volatility Correlation s(m)v with s(1)s(2) = -0.5 . . . . . . . . . . . . . . . . Comparison of Prices for Variation in Jump Frequency  and Asset Correlation s(1)s(2) . . . . . . . . . . . . . . . . . . . . 5.9 Comparison of Prices for variation in Mean Jump Size k(m) . 5.10 Comparison of Prices for variation in  (m) . . . . . . . . . . . 5.12 Variation in Price for various choices of = ( 1,
2 ),

30 30 31 31 34

Comparison of Prices for variation in Moneyness and Strike K 35 37 39 40 41

5.11 Comparison of Prices for variation in Jump-Size Variance (m) 42 actual 43 44 price = 8.77 . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5.13 Variation in Prices with change in N and u ¯min . . . . . . . .

vii

List of Figures
5.1 5.2 5.3 5.4 5.5 5.6 5.7 5.8 5.9 Price Difference between Proportional Volatility Model and Independent Volatility Model with Asset Correlation s(1)s(2) Price with Variation in Moneyness and Time to Maturity . . Price with Variation in Moneyness and Strike . . . . . . . . . Price with Variation in Asset-Volatility Correlation s(m)v , s(1)s(2) = +0.5 . . . . . . . . . . . . . . . . . . . . . . . . . . Price with Variation in Asset-Volatility Correlation s(m)v , s(1)s(2) = -0.5 . . . . . . . . . . . . . . . . . . . . . . . . . . Price with Variation in Mean Jump Size . . . . . . . . . . . . Price with Variation in Asset-Volatility Multiplier  (m) . . . . Price with Variation in Jump-Size Variance . . . . . . . . . . 37 40 41 42 Price with Variation in Jump Frequency and Asset Correlation 38 36 33 34 35

viii

Chapter 1

Introduction
Options are a class of derivative securities (securities whose value depends on another asset) which give the holder the right to execute a trade or receive a payoff at a given time (called the maturity). They range from the most basic call and put options, which give the holder the right to buy or sell a stock at a certain price, to complex exotic options such as basket options, whose value is a function of the prices of many stocks. Options are often used to hedge against the uncertainty in the future price of assets. For example, a car company may purchase call options on steel to lock in a future price. Options can also be used to speculate on the future movement of the underlying securities (the assets from which the option derives its value). The problem of pricing options is a crucial one in finance, as improperly valuing options can decrease the profitability of firms using them to hedge, or can lead to losses for traders attempting to profit through their sale. The Fundamental Theorem of Arbitrage Pricing says that the value of any derivative in a complete market is simply the expected value of the derivative at maturity, discounted back to the present time at the risk free rate [10]. Since we know both the time to maturity and can observe the risk free rate, all that remains is to calculate the expected value of the option. This calculation, however, is easier said than done. There are many different models describing how the price of a stock changes with time, and many options have complex payoff functions which are difficult to analyze. 1

While the Black-Scholes model [4] was an important leap for the mathematical modeling of asset prices, the model makes many assumptions that don't hold true in financial markets. Heston [15] extended the Black-Scholes model by including a stochastic volatility term to better model the volatility smiles and smirks observed in financial markets. Cont and Tankov [9] provide an extensive overview of the use of jumps in market models, while Bates [3] presents a model including both stochastic volatility and jumps and prices European call options under this market model. As Alvarez, Escobar and Olivares [2], and Cont and Tankov [9] note the presence of both jumps and stochastic volatility terms allows for a much greater flexibility in modeling both shorter and longer term smiles. Another growing area of interest is the modeling of assets in multivariate settings, and the pricing of derivatives whose value depends on multiple assets. These derivatives allow a hedger to protect themselves against things like the production cost of a product, or changes in the exchange rates for assets denominated in other currencies. Spread options in particular have been studied quite thoroughly in the works of Dempster and Hong [11], Hurd and Zhou [17], Carmona and Durrleman [6], and Hikspoors and Jaimungal [16]. Spread options provide a unique challenge, however, as analytical solutions are unavailable for most market models, and all of the authors above rely on numerical methods in some form for all but the most basic of models. Fourier transform methods, such as those introduced by Carr and Madan [7] and outlined in depth by Eberlein, Glau, and Papapantoleon [12], provide an efficient method for pricing options under a variety of market models. This thesis will extend the work of Dempster and Hong [11] and apply the Fourier transform methods introduced by Hurd and Zhou [17] to price spread options under two jump-diffusion market models with stochastic volatility. Chapter 2 will present a variety of multi-asset options and look at the problem of pricing derivative securities. Chapter 3 examines both Monte-Carlo and Fourier transform methods for pricing options, and walks through the derivation of the pricing method outlined by Hurd and Zhou [17]. It also presents two small modifications to extend their method beyond the base case where the strike price K is equal to 1, and an algo2

rithm to select a Fourier step size to guarantee both assets fall on the pricing grid. Chapter 4 looks at the development of market models describing the movement of asset prices, and the rationale behind our selection of market models. We examine the need to include both stochastic volatility and jump terms in our market model, and present two market models which feature both these characteristics. We then work through the derivation of the characteristic function for both of our market models. Chapter 5 will look at the numerical results from our implementation of both a Monte-Carlo and Fourier transform pricing tool, and examine the sensitivity of our models to the various input parameters. Finally, Chapter 6 contains a summary of the work presented, as well as suggestions for future areas of investigation.

3

Chapter 2

Derivatives and the Pricing Problem
2.1 The Pricing Problem

The Fundamental Theorem of Arbitrage Pricing states that the value of any derivative security is equal to the expected value of that derivative at maturity, discounted1 at the risk-free rate [10]. For a derivative with an arbitrary payoff, P (XT ), dependant on the value of an asset X at maturity date T , the Fundamental Theorem of Arbitrage Pricing states that the value (or price) of the derivative at time t is given by: V (X |Xt ) = e-rf (T -t) EQ (P (XT )|Xt ) where rf 2 is the risk-free interest rate, Q indicates a Risk-Neutral Measure 3 or the measure for which the discounted price is a martingale, and EQ
Discounting refers to the process of reducing the value of a future payout by some rate to calculate the value of that future payout today (it's present value). 2 Note that in this case we take rf to be a constant, for models where the risk-free rate varies, the e-rf T term should appear inside the expectation. 3 While we take for granted in this paper the fact that the risk-neutral measure under our model is unique, this is not the case for all market models.
1

4

indicates the expected value under Q as defined for a random variable X as:


EQ (X ) =
-

xf (x)dx

(2.1)

where f (x) is the probability density function of X . This calculation is relatively straightforward if the PDF of X is known, however in most cases this is not true, and the models for which the PDF is known often rely on poor assumptions and fail to capture important characteristics of the financial markets. As such, researchers have sought out other methods to evaluate the formula given in (2.1), often relying on numerical methods to do so.

2.2
2.2.1

Derivatives: Definitions
Spread Options

Spread options are derivatives whose value is based on the difference between two asset prices. The value of a European Call spread option at maturity T is given by: VT (S1 , S2 , K ) = (S1 - S2 - K )+ where K is called the strike price, and the notation (x)+ indicates maximum of 0 and x. Spread options are used both as hedging tools and as speculative instruments. Spread options are common in commodity markets, where they can be used to hedge against the conversion or production costs for raw goods. For example the crack spread is based on the difference in prices between refined oil products (such as gasoline) and crude oil, while the value of a spark spread is used to gain exposure to the production cost of electricity. Spread options can also be used as speculative tools, as they allow the purchaser to effectively "bet" on the correlation between the two assets. For example, if an investor believes that the correlation between the assets will 5

decrease (and thus the spread may widen) the investor would long a call4 , while if they believe a correlation increase will occur (and thus the spread will likely hold at the same level), they should write a call on the underlying assets. As stated earlier, the price of a spread option is determined by the expected value of the option at maturity discounted at the risk free rate, i.e.: P (K ) = e-rf (T -t) EQ (ST - ST - K )+ |St , St
(1) (2) (1) (2)

The pricing of spread options is a widely studied topic as the methods developed to price them often serve as a stepping stone to pricing more complicated multivariate assets. Dempster and Hong [11], and Hurd and Zhou [17] both use Fourier transform methods to price spread options and also extend their methods to other option types, while Hikspoors and Jaimungal [16] look at models for spread options in Energy markets. In addition, Carmona and Durrleman [6] provide a broad overview of the various methods used to price spread options, and of the various types of spread options actually available in the market.

2.2.2

Other Multivariate Derivatives

While this thesis explores only the pricing of spread options, here we present other multivariate derivatives and their payoffs to illustrate a selection of the products that are traded both over-the-counter and through exchanges. The methods developed later in this thesis for pricing spread options are easily extended to the derivatives outlined below. Exchange Options Exchange options give the purchaser the right (but not the obligation) to exchange one asset for another at maturity. The Exchange option can be
A "call" is an option which pays some function of the asset prices less the strike price, while a put pays the strike price less some function of the asset prices. To go "long" a derivative is to purchase it (i.e. to receive the payoff at maturity) while to go "short" a derivative is to sell the derivative (i.e. to receive payment initially and pay the payoff at maturity)
4

6

seen as a specific case of a spread option with K = 0. The payoff for an exchange option is then given as: P (XT ) = (XT - XT )
(1) (2) +

Margrabe [18] first looked at the value of these options under the BlackScholes framework, while Cheang and Chiarella [8] evaluate exchange options under a jump-diffusion market model. Basket Options Basket options are a multivariate extension of a European call or put. A basket option takes the weighted average of a group of d stocks (the basket) as the underlying, and produces a payoff equal to the maximum of 0 and the difference between the weighted average and the strike (or the opposite difference for the case of a put). Index options, whose value depends on the movement of an equity or other financial index such as the S&P500, are examples of basket options. The payoff for a basket option is given by:
d + (i) wi XT

P (XT ) =
i=1

-K

Hurd and Zhou [17] provide an extension of their spread pricing method to pricing a specific higher-dimension basket option where the first asset, X (1) has weight 1, and the other assets in the basket, X (2) ...X (d) have weight -1. Correlation Options A correlation option is another extension of the plain vanilla European call to two dimensions. Its payout is the product of two European calls with different strikes. Similar to spread options correlation options allow the purchaser to speculate on how asset prices will move together, as the option requires both assets to move in the same direction in order for the value at maturity to be non-zero. The payoff of a correlation option is given as: 7

P (XT ) = (XT - K1 ) (XT - K2 )

(1)

+

(2)

+

Dempster and Hong [11] outline a method for pricing correlation options, and use the techniques outlined to extend their method to price spread options using Fourier transform methods. Quanto Options Quanto Options are options in which the contract is settled in a different currency from the currency of the underlying asset. The contract is settled at maturity at a fixed exchange rate determined at the initiation of the contract. In a quanto option our market model must capture the dynamics of both the underlying asset and the exchange rate (since the actual exchange rate may change, but the settlement exchange rate is a constant) between the currencies involved in the transaction. Quantos are attractive instruments for both speculators and hedgers as they provide an exposure to the underlying asset without assuming any foreign exchange risk. The payout of a European quanto call option on an asset Xt denominated in currency U , with strike K , maturity T , and settled in currency C is given as: P (XT ) = RC/U  (XT - K )+ where RC/U is the fixed rate of exchange between U and C as set at the beginning of the contract.

8

Chapter 3

Pricing Methods
3.1 Monte Carlo Simulation

Monte-Carlo methods are often the simplest numerical pricing methods to implement, however they are also the most computationally costly. MonteCarlo methods rely on the simulation of a large set of sample price paths based on an Euler (or other) discretization of our market model, and take the average of the payouts at maturity over the set of sample paths. If we denote XT,j the value of the asset(s) at time T for the j th simulated path, then the Monte-Carlo price of a derivative with payoff function P (XT ), after N sample paths is given by:
N

V (X0 ) =
j =1

P (XT,j ) . N

The benefit of Monte-Carlo methods is mainly their flexibility. Once a given market model is implemented in a Monte-Carlo setting, one simply needs to add a variety of payoff functions based on the sample paths to create a robust pricing tool. While Monte-Carlo methods allow for a great degree of freedom, and are often the only method available to price certain exotic options, their computational cost is often far too great to justify their use. In addition, as the models used to describe the asset prices increase

9

in complexity, and the number of assets modeled also increases, the computational cost increases significantly, which makes ensuring convergence in a reasonable time nearly impossible.

3.2

Fourier Transform Pricing

Fourier Transform methods provide an efficient and widely-used alternative to Monte-Carlo and other numerical methods when the characteristic function of the underlying market model is known. Carr and Madan [7] first used the Fourier transform to price European call options, while both Dempster and Hong [11], and Hurd and Zhou [17] derived Fourier Transform methods to price spread options. Eberlien et al. [12] give an overview of both the univariate and multivariate cases which have been examined so far, and look at pricing options based on the minimum price of a basket of assets. Fourier Transform methods rely on knowledge of the characteristic function for the underlying market model. The characteristic function of a random vector X = (X (1) , X (2) , ..., X (d) ) is denoted XT (u) with u = (u1 , u2 , ..., ud ), and is defined as: XT (u) = E eiu·X where a · b denotes the scalar product of a and b. This formulation can be alternately viewed as the Fourier transform of the probability density function of the underlying random vector X . Since the characteristic functions of many market models are known or can be derived, pricing through Fourier transform techniques can allow a trader to easily compare the effects of various models on the price of an option, and provides a great deal of flexibility in the development of numerical pricing tools. Knowing the Fourier transform of the price process of a given market model, there are several approaches that can be taken to price an option. Carr and Madan [7] apply Fourier transform techniques in the univariate case to price call options by expressing the Fourier transform of the damped payoff function1 as a function of the Characteristic Function XT (u) of the
1

The payoff function CT (K ) = (ST - K )+ is not square-integrable, however the

10

underlying market model. Specifically, they show that the price of a European Call is given by: e-K CT (K ) = 2 with T (u) defined as: T (u) = e-rf T XT (u - ( + 1)i) 2 +  - u2 + i(2 + 1)u


e-iuK T (u)du
-

Dempster and Hong extend the work of Carr and Madan to two dimensions, using the Fourier transform to price correlation and spread options. For spread options they first note that the boundary of the payoff region for a spread is non-linear, and use a matrix of spread prices produced by the Fast Fourier Transform (FFT) to create an estimate of the non-linear boundary. While their work provides a template for the type of analysis necessary, the methods they present are specific to the correlation and spread options respectively, and are not easily extended to other payoffs.

3.2.1

Hurd and Zhou's Method

Hurd and Zhou's method [17] takes a different approach from Dempter and Hong's. Rather than integrating over the payoff region, Hurd and Zhou derive the characteristic function of the payoff function, and then take the inverse Fourier transform of the product of the characteristic functions of the given market model and the payoff function. Their method is applicable not just to spread options, but is easily extendible to other derivatives, as one simply needs to find Fourier transform of the payoff function and substitute it into the appropriate formula. For a derivative dependent on two assets, ^ (u), the price at with an arbitrary payoff P (XT ) with Fourier transform P
damped payoff function cT (K ) = e-K CT (K ),  > 0 is.

11

time t = 0 of the derivative can be calculated as: V (X0 ) = e-rf T (2 )2
R2 + i

^ (u)d2 u eiu·X0 XT (u)P

(3.1)

where we note that if the increments in Xt - X0 are independent of X0 (as it will be in all the models we analyze), we can write: E(eiu·XT |X0 ) = eiu·X0 XT (u) As Hurd and Zhou suggest, this integration can be numerically calculated using the inverse Fast Fourier Transform. We begin by discretizing the complex domain as:  = {u(k) = (u(k1 ), u(k2 ))|k = (k1 , k2 ),  {0, 1, ..., (N -1)}2 }, u(ki ) = -u ¯+ki  over N points, with  being the step-size in the complex domain and u ¯= choices for N ,  and u ¯, we can discretize the real domain as:  = {x(l) = x(l1 ), x(l2 )|l = (l1 , l2 ),  {0, ..., (N - 1)}2 }, x(li ) = -x ¯ + li   where   = estimated as:
2 N N 2

being the truncated end-points for our numerical integration. Based on our

and x ¯ =

N  2 .

The value of our payoff P can then be

V (X0 )  (-1)l1 +l2 e-rf T

N 2

2

e-

·x(l) 2

1 N2

-2ik·l N -1 N H (k) k1 ,k2 =1 e

= (-1)l1 +l2 e-rf T

N 2

e-

·x(l) [ifft2(H (k ))] (l) (2)

where the initial price is the vector X0 = (X0 , X0 ), and ifft2(J ) indicates the 2-Dimensional inverse fast Fourier transform (or any discrete Fourier transform) of J , and H (k) is defined as: ^ (u(k) + i ) H (k) = (-1)k1 +k2 Xt (u(k) + i )P

(1)

12

^ (u) is defined as the Fourier transform of the payoff function. There where P are a variety of multidimensional payoff functions with known Fourier transforms. Eberlein et al. [12], for example, give the transform of a payoff paying the minimum of a basket of assets less a strike (K ) to be: ^ (u) = P K 1+i (-1)d
d m=1 (ium )
d m=1 (um )

1+i

d m=1 (um )

(3.2)

^ (u) Hurd and Zhou also give the Fourier transform of a spread option, P for the case of K = 1 as: ^ (u) = (i(u1 + u2 ) - 1)(-iu2 ) P (iu1 + 1) where (a) is the complex gamma function defined for (3.3) (a) > 0. The

derivation of this formula is quite straightforward, and is outlined here as in ^ (u), u = (u1 , u2 ) Hurd and Zhou [17] for completeness. We start by defining P as: P (x) = (2 )-2
R2 + i

^ (u)d2 u eiu·x P

(3.4)

with

= ( 1,

2 ),

restrictions on , e

2 > 0, 1 ·x P (x) is

+

2

< -1 (it can be shown that with these

square integrable). By the Fourier inversion

theorem, we know that: ^ (u) = P
R2 + i

e-iu·x P (x)d2 x

(3.5)

We then apply our knowledge of the payoff region of P (x) to restrict the intervals which we're integrating over. If we let x(m) = ln(S (m) ), m = 1, 2 for a spread option with K = 1, our payoff function becomes: P (x) = (ex
(1)

- ex

(2)

- 1)+ .

Given that x(1) = ln(S (1) ) we know that x(1) > 0 is a lower bound on x(1) , and we also know that the value of the payoff is zero in any regions where 13

ex

(2)

> ex

(1)

- 1. By Fubini's Theorem we can rewrite equation (3.6) as:

(1)

^ (u) = P
0

e-iu1 x


 

ln(ex

(1)

-1)

e-iu2 x [ex
-
(1) (1)

(2)

(1)

=
0

e-iu1 x (ex

1 - 1)(1-iu2 ) [ -iu - 2
(1)

- 1 - ex ]dx(2)  dx(1) (3.6)
1 (1) 1-iu2 ]dx .

(2)



(3.7)

If we perform the change of variables z = e-x 1 ^ (u) = P (1 - iu2 )(-iu2 )
1 iu1

^ (u) becomes: then P
1-iu2

z
0

1-z z

dz . z

(3.8)

We then note that the Beta function is defined as: (b)(b) = B (a, b) = (a + b)
0 1

z a-1 (1 - z )b-1 dz.

Applying this to equation (3.8), and knowing that by the properties of the gamma function (z ) = (z - 1)(z - 1), we can derive equation (3.3) above. This method can be easily extended to the case of K = 1, K > 0, by simply making a change of variables. If we define the spread value when K = 1 and with initial asset prices S0 , S0
(1) (2) (1) (2)

by:
(2) + (1) (2)

Spr (S0 , S0 , 1) = e-rf T EQ (ST - ST - 1) |S0 , S0 then for the case of K = 1 we can write the spread price as:

(1)

Spr (S0 , S0 , K ) = e-rf T EQ (ST - ST - K ) |S0 , S0 If we make a simple change of variable, Yt becomes:
(m)

(1)

(2)

(1)

(2)

+

(1)

(2)

.

=

St K

(m)

then our equation

14

Spr (S0 , S0 , K ) = e-rf T EQ K YT = K  e-rf T  EQ =K

(1)

(2)

(1)

- YT
(1)

(2)

-1
(2)

+

|Y0 , Y0
+

(1)

(2)

YT

- YT

-1

|Y0 , Y0
(1)

(1)

(2)

(1) (2)  Spr (Y0 , Y0 , K )

= K  Spr

S0 S0 , ,1 . K K

(2)

We can also take steps to ensure that both of our initial asset prices land on the inverse grid  . Hurd and Zhou implement a model with equal step sizes of  m and   =
2 N

along the x and y axes of the complex and real

planes respectively. If we instead specify the step size along each axes of each plane (i.e.  (1) ,  (2) and  (1) ,  (2) ), we can eliminate the need for any interpolation between grid points. We can additionally specify a minimum integration interval in the complex plane umin , and use the algorithm given in 3.2.1 to find a step size size with a minimum truncation error and each initial asset price on the grid. Algorithm 3.2.1. Algorithm for Selecting Step Size  (m) given N , S0 and umin 1. Select N , u ¯min 2. For each asset m = 1, 2, with initial price S0
(m) S0 /K , (m) (m)

set log-price X0

(m)

=

strike price K.

3. For j = 1 to N 4. Set u ¯T est =
i-N/2 X0
(m)

5. If u ¯T est > u ¯min then return u ¯T est 6. Else Loop.

3.2.2

Greeks

One of the other benefits of Fourier transform methods are that they allow for easy computation of the Greeks. The Greeks represent the sensitivity of 15

the price to the various parameters in a given model, and are used both as a measure of risk, and as a means to hedge against the risk of a given factor. For example, one could protect against changes in the risk free rate rf by creating a portfolio with a total  =
V rf

equal to 0.

By substituting the partial derivative of the characteristic function with respect to the required parameter into equation (3.1) above, one can find the desired Greek. For example, for a spread option, the delta (sensitivity to the price of the underlying asset) with respect to the long-asset is given by: (1) = V (K ) e-rf T = (2 )2 S (1) eiu·X0  (u; T ) ^ P (u)d2 u (1) S0

R2 + i

The other Greeks can be defined in a similar manner by replacing the
 (u;T ) S0
(1)

with the appropriate partial derivative.

16

Chapter 4

Market Models
4.1
4.1.1

Univariate Models
Black-Scholes

The Black-Scholes model [4] was one of the first models used to price European options. The model describes the movement of an asset price over time as: dSt = St µdt + St dWt , where µ is the expected return of the asset,  is the volatility of the asset and Wt is a Wiener process. While the Black-Scholes method is popular due to its ability to provide analytical prices for a variety of payoffs, it does have several shortcomings, based primarily on the assumptions about the movement of assets prices. First, it assumes that the returns on an asset distribute normally, when in fact evidence has displayed that they do not (in fact they have fatter tails, and non-zero skew and kurtosis). In addition, it assumes that the volatility of the underlying asset is a constant, an assumption which also does not hold true in financial markets. Because of these shortcomings, many other models have been developed to attempt to address some of the criticisms levied at the Black-Scholes model while retaining the simplicity in analysis that it contains.

17

4.1.2

Heston Stochastic Volatility

Heston's model was one of the first to introduce a stochastic volatility component [15]. The Heston model extends the traditional Black-Scholes model by adding a stochastic volatility component, driven by a Cox-Ingersoll-Ross (CIR) process. The model describes the movement of the stock price and volatility as: dSt = St µdt + St  Vt dWtS Vt dWtV . (4.1)

dVt =  ( - Vt )dt + 

The CIR process is ideal for modeling the volatility of an asset because it contains a mean reverting term, which is observed in the volatility of assets in the market, and is strictly positive, as a volatility must be positive (when yt hits zero the stochastic term vanishes, and the process moves back towards its mean) [9]. The parameters of the CIR process  ,  , and  represent the rate of mean reversion, long-run mean of the variance, and volatility of the variance respectively. The Wiener process which drives the CIR process can also be related to the Wiener process driving the asset price using the equation1 dWtV = dWts + 1 - 2 dZt .

Stochastic volatility methods are used primarily because of their ability to produce an implied volatility smile. The volatility smile is the phenomena observed in options markets where at-the-money options show a lower implied volatility than both in and out-of-the-money options.2 By adding a stochastic volatility process to our market model we are better able to replicate the smiles observed in the market, and can therefore be more confident
1 While this holds for the single asset case, in the multivariate setting the Cholesky decomposition of the covariance matrix defines the relationships between assets and volatilities, see [14]. 2 An options "moneyness" refers to the current intrinsic value of the option. An at-themoney option is one where the current price of the underlying asset is equal to the strike price, while for in and out-of the-money options current value of the underlying asset is above and below the strike respectively.

18

in the prices that our model produces. These effects, however, are only seen for longer maturities, as the stochastic volatility component alone is unable to produce realistic behaviour for shorter maturities.

4.1.3

Bates

The Bates model [3] extends the Heston model by adding jumps to the price process. From our model given in (4.1), we add a jump term St- dZt , where the jumps are described by a Compound Poisson process to produce the model given below: dSt = St µdt + St  Vt dWtS + St- dZt Vt dWtV (4.2)

dVt =  ( - Vt )dt +  where Zt is a compound poisson process.

A Compound Poisson Process Xt is a stochastic process defined by:
Nt

Xt =
i=1

Yi

(4.3)

where Nt is the number of jumps up to time t, which follows a Poisson distribution with parameter , and Yi are independent and identically distributed jumps. Our model assumes that the jumps are drawn from a normal distribution with mean k and variance 2 . The timing of the jumps is set such that Ti - Ti-1 is distributed exponentially with parameter . While Equation (4.3) describes a univariate Compound Poisson Process, we will extend it to our n-dimensional space in the next section by assuming jump sizes for the assets have the same as the correlation matrix as the one used with the Wiener Processes driving the asset price. The Bates model has the benefit of incorporating both stochastic volatility and jumps, which overcomes some of the problems with shorter maturities that the Heston model experiences [9]. The jump component can be calibrated to effectively generate smiles and skews at shorter maturities, while the stochastic volatility parameters can be used for long-term smiles.

19

4.2
4.2.1

Multivariate Models
Multivariate Bates

Extending the Bates model to the multivariate case, our market model describes the movement in asset prices and volatilities as: dSt dVt
(m)

= St

(m) (m)

µ

dt + St

(m) (m)



Vt

(m)

dWt
(m)

S (m)

+ St- dZt

(m)

(m)

(4.4)

(m)

=  (m) ( (m) - Vt
S (m)

(m)

)dt +  (m)

Vt

dWt

V (m)

for m = 1, 2, ...d

where Wt

and Wt

V (m)

are Wiener processes driving the movement of

the mth asset and volatility respectively, and Zt is a compound poisson process with jump intensity factor  and jump sizes distributed multivariate log-normally (log(Zt )  N (k, 2 )). Applying Ito's lemma to Xt dXt
(m) (m)

= ln St

(m)

produces: Vt
(m)

1 2 (m) = (r - k(m) -  (m) Vt )dt +  (m) 2
(m)

dWt

S (m)

+ dZt

(m)

(4.5)

where Zt

is a compound Poisson process with multivariate normal dis-

tribution, Zt  N (k, 2 ). The drift component µ(m) is fixed under the risk-neutral measure to be r - k(m) . Since the jump and continuous components of our model are independent, the characteristic function of Xt is the product of the characteristic functions of each component:
c (u)Z (u). Xt (u) = Xt t

As such we first consider only the continuous component of our model, where we define dXt dXt
(m) c (m) c

as: Vt
(m)

1 2 (m) = (r - k(m) -  (m) Vt )dt +  (m) 2

dWt

S (m)

20

with dXt
(m)

= dXt

(m) c

+ dZt

(m)

.

Theorem 4.2.1. For the market model described in (4.4) the characteristic function of the continuous component of Xt satisfies the following PDE: 0= f + t +
d m=1 d

f x(m)

1 2 r - k(m) -  (m) v (m) 2

+

f  (m) ( (m) - v (m) ) v (m)

1 2f s s  (m)  (n) 2 m,n=1 x(m) x(n) (m) (n)

v (m) v (n)

+2

2f s(m) v(n)  (m)  (n) v (m) v (n) ( m ) ( n ) x v 2f + (m) (n) v(m) v(n) v (m) v (n)  (m)  (n) v v (4.6)

with terminal condition f (x, v, T, u) = eiu·x . Proof: Following the arguments of Cont and Tankov [9], and Heston [15] we let:
c f (x, v, t, u) = EQ (eiu·XT |x = Xt , v = Vt )
c

where EQ denotes the expectation under the risk-neutral measure Q. If we
c to be X c and V = V then f is the characteristic function of X c . take Xt t 0 t 0

Applying Ito's lemma to f gives us:

d

df =
m=1

f f dx(m) + (m) dv (m) ( m ) x v

+

1 2 m,n=1

d

2f d[x(m) , x(n) ] x(m) x(j )

+2

2f 2f f (m) (n) d [ x , v ] + d[v (m) , v (n) ] + dt. ( m ) ( j ) ( m ) ( j ) t x v v v (4.7)

21

We know that: d[x(m) , x(n) ] = s(m) s(n) d[x(m) , v (n) ] = s(m) v(n) d[(v (m) , v (n) ] = v(m) v(n) v (m) v (n) dt v (m) v (n)  (m) dt v (m) v (n)  (m)  (n) dt

where [A, B ] denotes the quadratic covariation of A, B , defined as in Cont and Tankov [9] as:
t t

[A, B ]t = At Bt - A0 B0 -
0

As- dBs -
0

Bs- dAs .

Applying this to equation (4.7) yields:
d

df =
m=1

f x(m)

1 2 (r - k(m) -  (m) v (m) )dt +  (m) 2 v (m) dWt
v(i)

v (m) dWt

s(i)

+ +

f  (m) ( (m) - v (m) )dt +  (m) v (m) 1 2
d m,n=1 2f

2f s s  (m)  (n) x(m) x(j ) (m) (n)

v (m) v (n) dt

s v  (m) v (m) v (n)  (m) dt x(m) v (n) (m) (n) 2f f dt + (m) (n) v(m) v(n) v (m) v (n)  (m)  (n) dt + t v v +2 (4.8) We can show that f is a martingale by iterated expectations, and therefore the drift term must be equal to zero. Applying this to equation (4.8) produces the result stated in (4.6). In general equation (4.6) is non-linear in the co-efficients and a solution is not available without making simplifying assumptions. We now consider two specific cases of our model, and limit ourselves to two assets. In the first, we assume no correlation between the asset prices

22

in the continuous component (although we allow for correlation through the jumps) which we'll refer to as the Independent Volatility Case (in the sense that each asset has an Independent Volatility driving its correlated continuous component). In the second we extend the models of Dempster and Hong [11], and Bates [3], which features a single stochastic volatility process which drives both assets, to include jumps. We refer to this case as the Proportional Volatility or Common Volatility case. In both cases we assume that the compound Poisson process driving the jumps is independent of the Wiener processes driving the continuous components of our price processes. For the Independent Volatility case, we make the following assumptions: s(m) s(n) v(m) v(n) s(m) v(n) =0 =0 =0 for m = n; 1 for m = n for m = n; 1 for m = n for m = n (4.9)

Given the simplifications given in (4.9), we can solve the PDE given in (4.6). Theorem 4.2.2. For the market model described in (4.4), with the assumptions given in (4.9) the characteristic function of Xt is given by:

23

c (u)Z (u) Xt (u) = Xt t

(4.10)

where
c (u) Xt = eiu·X0 +C (T -t)+V0 ·D(T -t)

Zt (u) = et(exp(iu D(m) (s) = C (s) =
m=1

T k - 1 uT u)-1) 2 (m)

2 (m) (1 - e- s ) (m) 2 (m) - ( (m) -  (m) )(1 - e- s )
2

iu(m) r - k(m)  (m)  (m)
2  (m)

s
(m) s

-

2 ln

2 (m) - ( (m) -  (m) )(1 - e- 2 (m)

)

+ ( (m) -  (m) )s

1 2 2 2  (m) = -  (m) (iu(m)  (m) + u(m)  (m) ) 2  (m) =  (m) - i (m)  (m) s(m) v(m) u(m)  (m) = for m = 1, 2. Proof: Our assumptions reduce the PDE given in (4.6) to:
2

 (m) - 2 (m)  (m)

2

2

0=
m=1

f x(m) 2f

1 2 r - k(m) -  (m) v (m) 2
(m) 2 (m)

+

f  (m) ( (m) - v (m) ) v (m) + f . t

+

1 2

2 x(m)

v

+2

2f  2 f (m) (m) 2 (m) (m) (m)    v  + s v ( m ) ( m ) 2v x(m) v (m) v (m) (4.11)

Extending the work of Heston [15] we guess a solution of the form: f (x, v, t, u) = eiu·x+C (T -t)+v ·D(T -t)

24

where C (T - t) and D (T - t) = D1 (T - t) D2 (T - t)

are functions of t alone. Applying our guess to (4.11) gives us:
2 2

C +
m=1

D(m) v (m) =
m=1

1 2 iu(m) r - k(m) -  (m) v (m) 2
2 2 1 -u(m)  (m) v (m) 2

+D(m)  (m) ( (m) - v (m) ) +
2

2 (m) (m) + 2(iu(m) D(m) s(m) v(m)  (m) v (m)  (m) ) +D(  m) v

(4.12) where C and D represent the derivatives with respect to t of C and D respectively. This produces a series of Riccati ODE's: 1 2 2 D(m) (s) = -  (m) iu(m) + u(m) -  (m) - iu(m) s(m) v(m)  (m)  (m) D(m) 2 1 (m) 2 +  D(m) 2 (4.13) 2 for m = 1, 2, and
2

C (s) =
m=1

iu(m) r - k(m)

+  (m)  (m) D(m) (s)

(4.14)

which, following from the terminal condition of (4.6), have initial conditions D(m) (0) = 0 and C (0) = 0. The solutions to these equations are given in (4.10) above. It should be noted that because the continuous components of the asset prices are independent of each other, the characteristic function given above can also be written as: Xt (u) = X (1),c (u)X (2),c (u)Zt (u)
t t

where X (m),c (u) is the characteristic function of the continuous component of the mth asset, as given by Albrecher et al [1]. Looking at the jump component, we know from the LevyKhintchine 25
t

formula (see [9]) that the characteristic function of a compound poisson process is given by: E(eiu·Zt ) = et
Rd

(eiu·x -1)f (dx)

where f is the cumulative distribution function of the jump size distribution. Since the jumps in Zt are distributed normally with mean k and covariance matrix , t he characteristic function of the jump component is given as: Zt (u) = et(e
(iu k- 1 2 u u )

-1)

where in this case indicates the transpose operator. We now consider the case of proportional stochastic volatilities as in Dempster and Hong [11]. In this case we require only one volatility process for all of the assets and use the parameter  (m) to allow for varying volatilities between the assets. Our model for the log-prices and volatility is thus: dXt dXt
(m)

= dXt

(m) c

+ dZt

(m)

(m) c

dVt

1 2 = (r - k(m) -  (m) Vt )dt +  (m) 2 =  ( - Vt )dt +  Vt dWtV .

Vt dWt

S (m)

(4.15)

Theorem 4.2.3. For the market model described in (4.15), the characteristic function of Xt is given by:

26

c (u)Z (u) Xt (u) = Xt t

(4.16)

where
c (u) Xt = eiu·X0 +C (T -t)+V0 D(T -t)

(4.17)

D (s) = C (s) =

2 (1 - e-s ) 2 - ( -  )(1 - e-s )
d

iu(m) r - k(m)
m=1 d (m) 2 (m)

s-
d

 2 ln 2

2 - ( -  )(1 - e-s ) 2

+ ( -  )s

1  = - 2

i
m=1 2

u

+
m,n=1

 (m)  (n) u(m) u(n) s(m) s(n)

 =  - i (
m=1

s(m) v u(m) )

 =

2

- 2 2  (4.18)

with Zt (u) defined as in (4.10) above. Proof: Repeating the analysis above the characteristic function of Xt must satisfy the following PDE:
(c)

d

0=
m=1

f x(m)
d m,n=1

1 2 r - k(m) -  (m) v (m) 2

+

2f s v  (m) v x(m) v (m) + f 1 2f 2 f  ( - v ) +  v+ . 2 v 2 v t (4.19)

1 + 2

2f s s  (m)  (n) v x(m) x(n) (m) (n)

As above we guess the following form of the solution: f (x, v, t, u) = eiu·x+C (T -t)+vD(T -t) .

27

Which, when applied to equation (4.19) yields the ODE's: 1 D (s) = - 2
d d


m=1

(m) 2

d

iu

(m)

+

(u(m) u(n)  (m)  (n) s(m) s(n) )
m,n=1

+

1 iu(m) s(m) v  (m) -  D +  2 D 2 2 m=1
d

(4.20)

C (s) =
m=1

iu(m) r - k(m) + D (s).

Once again, our initial conditions are C (0) = 0 and D (0) = 0. The solutions to (4.20) are: D (s) = C (s) =
m=1

2 (1 - e-s ) 2 - ( -  )(1 - e-s )
d

iu(m) r - k(m)

s-

 2 ln 2

2 - ( -  )(1 - e-s ) 2

+ ( -  )s .

where 1  = - 2
d

i
m=1 2

(m) 2 (m)

d

u

+
m,n=1

 (m)  (n) u(m) u(n) s(m) s(n)

 =  - i (
m=1

s(m) v um )

 =

 2 - 2 2 .

28

Chapter 5

Numerical Computation of Spread Option Prices
5.1 Pricing

Table 5.1 compares the results produced by Monte-Carlo simulation with the results produced by our Fast-Fourier transform method for the proportional volatility case for various strikes. The second column give s the prices obtained from 1, 000, 000 Monte-Carlo simulations of 2000 time steps each, while the subsequent columns present the percent error obtained using the FFT method for various values of N . Much like Hurd and Zhou we observe that the price produced by our FFT method is consistently biased low against the Monte-Carlo price, although we observe that the bias is greater in magnitude than under their models. One possible reason for this is the presence of jumps in our model which increase the potential for error in our Monte-Carlo simulation (as we require more simulations for convergence), and also may increase the truncation error under our model. In spite of this, it is obvious that the FFT method provides an accurate means for the price of a spread option under our common volatility jump-diffusion model. Similarly Table 5.2 compares the errors for the Independent Volatilities case. In this case we see an error of a similar magnitude to the proportional 29

Table 5.1: Comparison of Monte-Carlo method with FFT method for proportional volatility case for umin = 20.
S0 = 100 , S0 = 96,  (1) = 1,  (2) = 0.5,  = 1,  = 0.04,  = 0.05, V0 = 0.04,  = 1, k(1) = k(2) = 0.05,  (1) =  (2) = 0.05, S (1)S (2) = 0.5, S (1)V = -0.5, S (2)V = 0.25, rf = 0.1, T = 1 K MC 128 256 512 1024 2 8.359781 -0.008902 -0.008902 -0.008855 -0.008902 2.2 8.264856 -0.009001 -0.009001 -0.008967 -0.009 2.4 8.170669 -0.009127 -0.009127 -0.009081 -0.009127 2.6 8.063694 -0.007571 -0.00757 -0.007533 -0.00757 2.8 7.984489 -0.009357 -0.009356 -0.009308 -0.009356 3 7.879148 -0.007781 -0.00778 -0.007743 -0.00778 3.2 7.787975 -0.007905 -0.007905 -0.007849 -0.007905 3.4 7.697545 -0.008 -0.008 -0.007956 -0.008 3.6 7.633466 -0.011431 -0.011431 -0.011392 -0.011431 3.8 7.544433 -0.011586 -0.011586 -0.011531 -0.011586 4 7.456122 -0.010902 -0.010902 -0.010856 -0.010901
(1) (2)

volatility case, but we note that there is significantly less discretization error in this case, as the error size remains fairly constant as we increase the number of steps. Table 5.2: Comparison of Monte-Carlo method with FFT method for Independent Volatilities case for umin = 20.
= 96,  (1) = 1,  (2) = = 100 , S0 S0  = 0.05, V0 = 0.04,  = 1, k(1) = k(2) 0.05, S (1)S (2) = 0.5, S (1)V = -0.5, S (2)V = K MC 128 256 2 10.227759 -0.00744657937788033 -0.007447 2.2 10.132205 -0.007322 -0.007322 2.4 10.065256 -0.009958 -0.009958 2.6 9.947149 -0.007493 -0.007493 2.8 9.890918 -0.011133 -0.011133 3 9.73777 -0.00495 -0.00495 3.2 9.715475 -0.011996 -0.011996 3.4 9.597358 -0.00922 -0.00922 3.6 9.525911 -0.011181 -0.011181 3.8 9.43138 -0.010694 -0.010694 4 9.339695 -0.010437 -0.010437
(1) (2)

0.5,  = 1,  = 0.04, = 0.05,  (1) =  (2) = 0.25, rf = 0.1, T = 1 512 1024 -0.007447 -0.007447 -0.007322 -0.007322 -0.009958 -0.009958 -0.007493 -0.007493 -0.011133 -0.011133 -0.00495 -0.00495 -0.011996 -0.011996 -0.00922 -0.00922 -0.011181 -0.011181 -0.010694 -0.010694 -0.010437 -0.010437

We also examine the accuracy of our method when we vary the jump parameters, to ensure that our method is flexible in the arguments that it 30

produces reliable results for. As we see in Table 5.3 we continue to generate reliable results even as we increase the jump parameters to introduce further volatility into our model. This result is encouraging, as it gives us comfort that our model can be modified to better simulate a variety of assets while still generating accurate results. Table 5.3: Comparison of Monte-Carlo method with FFT method for proportional volatility case while varying jump parameters
S0
(1)

= 100 , S0 = 96, K = 1,  (1) = 1,  (2) = 0.5,  = 1,  = 0.04,  = 0.05, V0 = 0.04,  = 1, k(1) = k(2) = 0.05,  (1) =  (2) = 0.05, S (1)S (2) = -0.5, S (1)V = +0.5, S (2)V = -0.25, rf = 0.1, T = 1, N = 512, u ¯min = 40 (1) (2) k =k 0.05 0.10 0.15 0.20 0.25 2 -0.0033 -0.0057 -0.0006 -0.0029 -0.0038 3 -0.0007 -0.0059 -0.0036 -0.0031 -0.0048  4 -0.0017 -0.0026 -0.0037 -0.0037 -0.0040 5 -0.0033 -0.0061 -0.0045 -0.0011 -0.0038 6 -0.0064 -0.0037 -0.0004 -0.0019 -0.0003

(2)

In addition to the accuracy of the method, it is also useful to compare the computational effort required to price spread options under each method. We can compare the execution times for the FFT method for both the proportional volatility case and the independent volatility case, as well as for 1,000,000 Monte-Carlo simulations of 2000 time steps, which are given in table 5.4. This is where the benefits of the FFT method become more clear, as Table 5.4: Run times in seconds for FFT u ¯min = 20 Grid Size Proportional Volatility 64 0.020426 128 0.050574 256 0.233219 512 0.997439 1024 3.970557 MC 1368.67 vs. Monte-Carlo Simulation, Independent Volatilities 0.054677 0.084188 0.346391 1.454524 5.920600 1503.42

the FFT method vastly outperforms the Monte-Carlo method. In addition, 31

because of the additional variance introduced when we add a jump component to our model the Monte-Carlo method is very slow to converge and requires a high number of simulations and a fine grid to accurately generate a price. Our Proportional Volatility Case also outperforms the Independent Volatility case, due mainly to the fact that the Independent Volatility case essentially requires the calculation of 3 characteristic functions (one for each asset-volatility pair, and one for the correlated jumps), while our Proportional Volatility case requires only 2 (one for the continuous component, and one for the jumps). Finally, we compare the FFT prices produced by the Proportional Volatility and Independent Volatility Cases. Fixing all parameters but the correlation (since this is essentially the area where the two models vary) Figure 5.1 shows the difference in prices Pprop - Pind for various values of the correlation between assets. Note that while the independent case does not have correlation between the Wiener processes driving the continuous component, it does have correlation in the jump component. The results appear as we would expect them to, with the Independent Volatility Case producing a higher prices when the correlation in the Proportional Volatility case is high, while the reverse is true when the correlation in the Proportional Volatility case is low. It should be noted that we see a much greater difference in prices when we decrease the Common Volatility correlation, showing the price in the Common Volatility model is much more dependent on the correlation.

5.2

Parameter Sensitivities

We now consider just the Proportional Volatility case, and examine the sensitivities of the price to the various parameters in our model. For all the cases stated below the following parameters were used, unless otherwise stated: S0
(1)

= 100 , S0

(2)

= 96,  (1) = 1,  (2) = 0.5,  = 1,  = 0.04,  = 0.05,

V0 = 0.04,  = 1, k(1) = k(2) = 0.05, (1) = (2) = 0.05, S (1)S (2) = 0.5, S (1)V = -0.5, S (2)V = 0.25, rf = 0.1, T = 1, K = 1. We additionally select a grid size of N = 512, damping parameter = (-3, 1), and a minimum truncation interval of umin = 40, with the actual truncation interval 32

4

Difference in Price From FFT

3

2

1

0

-1 1

-2

-3

0.5

-4 0

-5 -0.5 1 0.8 0.6

-6

0.4

0.2

0

-0.2

-0.4

-0.6

-1 -0.8 -1

Independent Volatility Case

Common Volatility Case

Figure 5.1: Price Difference between Proportional Volatility Model and Independent Volatility Model with Asset Correlation s(1)s(2)

selected using Algorithm (3.2.1). We first look at some simpler plots to confirm that the prices produced when we vary our parameters behave as we intuitively know they should. Figure 5.2 and Table 5.5 show the price as we vary both the initial moneyness of our option and the time to maturity. Obviously we would expect the price of the option to increase as the option ranges from out-of-the-money to in the money, and also to increase as the time to maturity rises, both facts which we observe. The data shows that a large variation based on the moneyness and time to maturity, and the plot also shows that at shorter maturities the effect of increasing the moneyness of the option is much greater, which we would again expect. In Figure 5.3 we look at how moneyness and strike affect the price of the our spread option. We again observe results as we expect, with the price increasing as both the moneyness increases, and as the strike decreases. We also notice that for a given strike the change in price is non-linear as a function of the moneyness, an indication of a skew in the implied volatilities. 33

14

12

10

Price

8

6

4

2

0 5 4 3 2 1 0 -1 -2 -3 -4 0.4 0.2 0 0.6 0.8 1.2 1 1.4 1.6 2 1.8

S (1) - S (2)

T

Figure 5.2: Price with Variation in Moneyness and Time to Maturity
 (1) = 1,  (2) = 0.5,  = 1,  = 0.04,  = 0.05, V0 = 0.04,  = 1, k(1) = k(2) = 0.05,  (1) =  (2) = 0.05, S (1)S (2) = 0.5, S (1)V = -0.5, S (2)V = 0.25, rf = 0.1, K = 1

Table 5.5: Comparison of Prices for variation in Moneyness Maturity T T 0.1 0.31 0.52 0.73 0.94 1.16 5 4.79 6.3 7.41 8.33 9.13 9.86 4 4.06 5.67 6.82 7.76 8.57 9.3 3 3.4 5.08 6.25 7.21 8.03 8.78 2 2.8 4.53 5.72 6.69 7.52 8.27 1 2.28 4.02 5.22 6.19 7.03 7.78 (1) (2) S0 - S0 0 1.82 3.55 4.75 5.72 6.56 7.31 -1 1.43 3.12 4.31 5.27 6.11 6.87 -2 1.1 2.73 3.9 4.86 5.69 6.44 -3 0.83 2.37 3.51 4.46 5.29 6.03 -4 0.62 2.05 3.16 4.09 4.91 5.65

and Time to

1.37 10.52 9.97 9.45 8.95 8.46 8 7.55 7.13 6.72 6.32

1.58 11.13 10.6 10.08 9.58 9.1 8.64 8.19 7.76 7.35 6.96

1.79 11.71 11.18 10.67 10.17 9.69 9.23 8.79 8.36 7.95 7.55

2 12.25 11.73 11.22 10.73 10.26 9.8 9.35 8.92 8.51 8.11

While the calculation of the implied volatilities and correlations is beyond the scope of this paper, it should be noted that the skews and smiles in univariate models tend to occur because the market is overestimating the 34

14

12

10

Price

8

6

4

2

0 10 8 6 4 2 0 -2 -4 -6 -8 -10 1 0 3 2 4 5 7 6 8 9 10

S (1) - S (2)

K

Figure 5.3: Price with Variation in Moneyness and Strike
S0 = 100 , S0 = 96,  (1) = 1,  (2) = 0.5,  = 1,  = 0.04,  = 0.05, V0 = 0.04,  = 1, k(1) = k(2) = 0.05,  (1) =  (2) = 0.05, S (1)S (2) = 0.5, S (1)V = -0.5, S (2)V = 0.25, rf = 0.1
(1) (2)

Table 5.6: Comparison of Prices for variation in Moneyness and K 0.25 1.28 2.3 3.33 4.36 5.38 5 12.92 12.28 11.67 11.07 10.49 9.93 4 11.57 10.98 10.4 9.84 9.31 8.79 3 10.32 9.76 9.23 8.71 8.22 7.74 2 9.15 8.64 8.14 7.67 7.21 6.78 1 8.07 7.6 7.15 6.71 6.3 5.91 S (1) - S (2) 0 7.08 6.65 6.24 5.85 5.47 5.12 -1 6.18 5.79 5.42 5.07 4.73 4.41 -2 5.37 5.02 4.68 4.37 4.07 3.79 -3 4.64 4.32 4.02 3.74 3.48 3.23 -4 3.98 3.7 3.44 3.19 2.96 2.74

Strike K 6.41 9.39 8.29 7.28 6.36 5.53 4.78 4.11 3.52 3 2.54 7.43 8.87 7.81 6.85 5.97 5.17 4.46 3.83 3.27 2.77 2.34 8.46 8.37 7.35 6.43 5.59 4.83 4.16 3.56 3.03 2.57 2.16 9.49 7.89 6.91 6.03 5.23 4.51 3.87 3.31 2.81 2.37 2

volatility of away from the money options (which, since the price of an option is a function of the volatility, translates into higher than expected prices). Thus the non-linearity we see in the price can be taken as evidence of the 35

presence of a skew in our implied volatilities and correlations, as we would expect with both a stochastic volatility and jump component.

8.84

8.82

8.8

8.78

Price

8.76

8.74

8.72

8.7

8.68

8.66 1 0.8 0.6 0.4 0.2 0 -0.2 -0.4 -0.6 -0.8 -0.4 -0.6 -1 -0.8 -1 -0.2 0 0.4 0.2 0.6 0.8 1

S1 ,V

S2 ,V

Figure 5.4: Price with Variation in Asset-Volatility Correlation s(m)v , s(1)s(2) = +0.5
S0
(1)

= 100 , S0 = 96,  (1) = 1,  (2) = 0.5,  = 1,  = 0.04,  = 0.05, V0 = 0.04,  = 1, k(1) = k(2) = 0.05,  (1) =  (2) = 0.05, rf = 0.1, T = 1, K = 1

(2)

We consider next the variation of the correlation between each asset and the driving volatility process. We look first at the case where the assets have positive correlation, as given in Figure 5.5. In this plot we see an increase in the price as the correlation between the short asset and the volatility increases, while we also observe an increase in the price for a constant s(2)v as we decrease the value of s(1)v . The highest price is observed for a strong correlation between the short asset and the volatility, and a strong negative correlation between the the long asset and the volatility. In the alternative case, as shown in Figure 5.5, we see the surface rotated, with the maximum price occurring when both s(1)v and s(2)v = 1. For both cases however, as Table 5.7 shows, the selection of correlation parameters has very small effects on the price produced, as we see little variation between

36

12.56

12.55

12.54

12.53

12.52

12.51

12.5

12.49

12.48

12.47 0.8 0.6 0.4 0.2 0 -0.2 -0.4 -0.6 -0.8 -0.6 -0.8 -1 -1 -0.4 -0.2 0 0.4 0.2 0.6 0.8

S1 ,V

S2 ,V

Figure 5.5: Price with Variation in Asset-Volatility Correlation s(m)v , s(1)s(2) = -0.5
S0
(1)

= 100 , S0 = 96,  (1) = 1,  (2) = 0.5,  = 1,  = 0.04,  = 0.05, V0 = 0.04,  = 1, k(1) = k(2) = 0.05,  (1) =  (2) = 0.05, rf = 0.1, T = 1, K = 1

(2)

the high and low prices produced in this example. Table 5.7: Comparison of Prices for Variation in Asset-Volatility Correlation s(m)v with s(1)s(2) = -0.5 s(2)v -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 -1 12.47 12.48 12.49 12.5 12.5 12.51 12.52 12.53 -0.8 12.47 12.48 12.49 12.5 12.51 12.51 12.52 12.53 -0.6 12.48 12.48 12.49 12.5 12.51 12.52 12.52 12.53 -0.4 12.48 12.49 12.49 12.5 12.51 12.52 12.53 12.53 -0.2 12.48 12.49 12.5 12.5 12.51 12.52 12.53 12.54 s(1)v 0 12.48 12.49 12.5 12.51 12.51 12.52 12.53 12.54 0.2 12.48 12.49 12.5 12.51 12.51 12.52 12.53 12.54 0.4 12.48 12.49 12.5 12.51 12.52 12.52 12.53 12.54 0.6 12.48 12.49 12.5 12.51 12.52 12.53 12.53 12.54 0.8 12.48 12.49 12.5 12.51 12.52 12.53 12.53 12.54

0.6 12.53 12.54 12.54 12.54 12.54 12.55 12.55 12.55 12.55 12.55

0.8 12.54 12.54 12.55 12.55 12.55 12.55 12.56 12.56 12.56 12.56

37

Looking at the effects of the jump frequency and asset correlation in Figure 5.6 we see interesting results. While we see the expected results of the price increasing with both the frequency of jumps, and as our correlation moves towards -1, the increase in price is not linear.

20

18

16

14

12

10

8

6 10 9 8 7 6 5 4 3 2 1 0 1 0.8 0.6 0.2 0.4 0 -0.2 -0.4 -0.6 -0.8 -1



S1 ,S2

Figure 5.6: Price with Variation in Jump Frequency and Asset Correlation
S0 k(1)
(1)

= 100 , S0 = 96,  (1) = 1,  (2) = 0.5,  = 1,  = 0.04,  = 0.05, V0 = 0.04, = k(2) = 0.05,  (1) =  (2) = 0.05, S (1)V = -0.5, S (2)V = 0.25, rf = 0.1, T = 1, K=1

(2)

As seen in table 5.8 for lower jump frequencies the effects of decreasing the correlation tends to decrease in the area around -1, while for higher jump frequencies the effect remains strong right to s(1)s(2) = -1. Obviously as we increase the jump frequency for negative correlations we expect more jumps to occur, and as such we expect more sudden movements of the underlying asset prices in opposite directions, which manifests itself in the higher prices produced under our model. We also observe that both parameters have a strong effect on the price, as we see it range from the low end of 7.02 up to 18.9 at the high end. It is also interesting to observe the effects of varying the mean jump size parameter, k , for each asset. As Figure 5.7 shows we see a large increase 38

Table 5.8: Comparison of Prices for Variation in Jump Frequency  and Asset Correlation s(1)s(2) s(1)s(2) -1 -0.8 -0.6 -0.4 -0.2 0 0.2 0.4 0.6 0.1 13.37 14.07 14.74 15.39 16.02 16.63 17.22 17.79 18.35 1.14 12.85 13.51 14.14 14.76 15.35 15.92 16.48 17.03 17.56 2.18 12.3 12.92 13.51 14.09 14.64 15.18 15.71 16.22 16.72 3.23 11.71 12.29 12.84 13.38 13.9 14.4 14.89 15.37 15.84 4.27 11.1 11.62 12.13 12.62 13.1 13.56 14.01 14.46 14.89  5.31 10.43 10.91 11.37 11.81 12.24 12.66 13.07 13.47 13.86 6.35 9.72 10.13 10.54 10.93 11.31 11.68 12.04 12.39 12.74 7.39 8.93 9.28 9.62 9.95 10.27 10.58 10.89 11.19 11.49 8.44 8.05 8.32 8.58 8.84 9.09 9.33 9.57 9.81 10.04 9.48 7.02 7.19 7.35 7.52 7.68 7.83 7.99 8.14 8.3 in the price produced as we move away from equal expected jump sizes. While this result is expected (if we believe one asset will jump with larger magnitude than the other than naturally we should believe that the spread between the assets will change), the extent of the variation is interesting to observe. We also observe that the price increases as long as the mean jump sizes are not equal, but regardless of the sign of the mean jump sizes. Table 5.9 shows that the price is extremely sensitive to the mean jump size, and particularly to the differences in the mean jump size. This effect is magnified when we increase the parameter  as the number of jumps, and hence the effect of the jumps on the price increases. In these cases the slope as we leave the region where the mean jump sizes are equal tends to increase more rapidly. Figure 5.8 shows the variation in price for different values of the assetvolatility multiplier,  (m) . For both assets we see an increase as we increase  (m) , as this tends to increase the overall volatility of each asset. The effects of  (m) are more muted than other parameters, as shown in Table 5.10, as they tend to linearly increase the price and the price does not seem to be more strongly related to either  (1) or  (2) . Finally, we examine the effect of

0.8 18.9 18.08 17.21 16.29 15.31 14.24 13.08 11.77 10.27 8.45

39

20

18

16

14

12

10

8 0.2 0.15 0.1 0.05 0 -0.05 -0.1 -0.15 -0.2 -0.2 -0.1 -0.15 -0.05 0 0.1 0.05 0.15 0.2

Figure 5.7: Price with Variation in Mean Jump Size
S0 = 100 , S0 = 96,  (1) = 1,  (2) = 0.5,  = 1,  = 0.04,  = 0.05, V0 = 0.04,  = 1,  (1) =  (2) = 0.05, S (1)S (2) = 0.5, S (1)V = -0.5, S (2)V = 0.25, rf = 0.1, T = 1, K = 1
(1) (2)

Table 5.9: Comparison of Prices for variation in Mean Jump Size k(m) k(2) -0.2 -0.15 -0.1 -0.05 0 0.05 0.1 0.15 -0.2 8.87 9.56 10.55 11.77 13.14 14.58 16.06 17.52 -0.15 8.57 8.81 9.38 10.26 11.39 12.67 14.03 15.42 -0.1 8.83 8.65 8.77 9.22 10 11.03 12.23 13.51 -0.05 9.6 9.07 8.76 8.74 9.08 9.76 10.7 11.81 (1) 0 10.81 10.01 9.35 8.9 8.75 8.96 9.53 10.38 k 0.05 12.39 11.39 10.46 9.67 9.07 8.77 8.86 9.32 0.1 14.3 13.16 12.04 10.98 10.03 9.28 8.82 8.77 0.15 16.49 15.27 14.01 12.76 11.55 10.45 9.52 8.9 0.2 18.97 17.69 16.35 14.97 13.57 12.21 10.92 9.81 varying the jump-size variance on the price, as shown in Figure 5.9. As we increase the variance in the jumps for both assets we see the price increase, as we would expect, and in a non-linear fashion. Increases in the variance for the long asset tend to have a greater effect on the price, since there's a 40

0.2 18.95 16.81 14.82 13.01 11.41 10.09 9.13 8.71 9.01

13

12

11

Price

10

9

8

7

6 1.4 1.3 1.2 1.1 1 0.9 0.8 0.7 0.6 0.7 0.6 0.5 0.5 0.8 0.9 1 1.2 1.1 1.3 1.4

1

2

Figure 5.8: Price with Variation in Asset-Volatility Multiplier  (m)

(1) S0 (1)

= 100 , S0 = 96,  = 1,  = 0.04,  = 0.05, V0 = 0.04,  = 1, k(1) = k(2) = 0.05, =  (2) = 0.05, S (1)S (2) = 0.5, S (1)V = -0.5, S (2)V = 0.25, rf = 0.1, T = 1, K = 1

(2)

 (1)

Table 5.10: Comparison of Prices for variation in  (2) 0.5 0.6 0.7 0.8 0.9 1 0.5 6.13 6.52 6.98 7.52 8.1 8.72 0.6 6.53 6.83 7.21 7.68 8.2 8.77 0.7 7.01 7.23 7.54 7.93 8.39 8.9 0.8 7.55 7.7 7.94 8.26 8.66 9.11 0.9 8.15 8.23 8.41 8.67 9 9.39 1 8.77 8.81 8.93 9.13 9.41 9.74 1.1 9.43 9.42 9.5 9.65 9.86 10.15 1.2 10.1 10.06 10.1 10.2 10.37 10.6 1.3 10.79 10.72 10.72 10.78 10.91 11.1 1.4 11.49 11.4 11.37 11.39 11.48 11.63

 (m) 1.1 9.36 9.37 9.45 9.61 9.84 10.14 10.49 10.89 11.34 11.83 1.2 10.03 10 10.04 10.15 10.33 10.58 10.88 11.24 11.64 12.09 1.3 10.72 10.65 10.66 10.73 10.86 11.06 11.32 11.63 11.99 12.4 1.4 11.41 11.32 11.3 11.33 11.43 11.59 11.8 12.07 12.39 12.75

greater probability that the long asset will increase it's spread over the short asset and increasing the variance of jumps in both assets tends to compound the effects, as we would expect. Table 5.11 shows that the jump-size variance parameter has a fairly substantial effect on the price, as increasing from 0.02 to 0.2 can cause an increase of 40% in the price of the spread. 41

13 12.5 12 11.5 11

Price

10.5 10 9.5 9 8.5 8 0.2 0.18 0.16 0.14 0.12 0.1 0.08 0.06 0.04 0.02 0 0 0.02 0.04 0.06 0.08 0.1 0.12 0.14 0.16 0.18

0.2

1

2

Figure 5.9: Price with Variation in Jump-Size Variance
S0 = 100 , S0 = 96,  (1) = 1,  (2) = 0.5,  = 1,  = 0.04,  = 0.05, V0 = 0.04,  = 1, k(1) = k(2) = 0.05, S (1)S (2) = 0.5, S (1)V = -0.5, S (2)V = 0.25, rf = 0.1, T = 1, K = 1
(1) (2)

Table 5.11: Comparison of Prices for variation in Jump-Size (2) 0.02 0.04 0.06 0.08 0.1 0.12 0.02 8.52 8.57 8.68 8.84 9.05 9.29 0.04 8.64 8.65 8.72 8.84 9.01 9.22 0.06 8.87 8.84 8.86 8.94 9.07 9.25 0.08 9.19 9.12 9.11 9.14 9.23 9.37 0.1 9.6 9.5 9.44 9.44 9.49 9.58 (1) 0.12 10.09 9.95 9.87 9.83 9.83 9.88 0.14 10.64 10.48 10.36 10.29 10.26 10.27 0.16 11.25 11.07 10.93 10.83 10.76 10.74 0.18 11.92 11.73 11.56 11.43 11.34 11.28 0.2 12.64 12.43 12.25 12.1 11.98 11.89

Variance (m) 0.14 9.55 9.46 9.46 9.54 9.71 9.98 10.33 10.75 11.26 11.84 0.16 9.84 9.72 9.69 9.74 9.88 10.11 10.41 10.81 11.27 11.82 0.18 10.13 10 9.95 9.97 10.08 10.27 10.54 10.89 11.32 11.83 0.2 10.44 10.29 10.22 10.22 10.29 10.45 10.69 11 11.4 11.87

5.3

Effect of Discretization and Truncation

As Hurd and Zhou [17] observe, the effect of varying the damping parameter on the price is relatively small. It should be noted, however that this is 42

not universally true, and that for values of seen in Table (5.12).

2

< 0.2, or for

1

-

2

- 1 < 0.2

we do observe some error in the prices produced by our FFT method, as

Table 5.12: Variation in Price for various choices of = ( 1 , = 8.77
2

2 ),

actual price

1

-3.0 -2.9 -2.8 -2.7 -1.6 -1.5 -1.4 -1.3 -1.2

0.1 10.7 10.7 10.7 10.7 10.7 10.7 10.7 10.71 11.34

0.2 8.81 8.81 8.81 8.81 8.81 8.81 8.82 9.39 1.20E+15

0.3 8.77 8.77 8.77 8.77 8.77 8.78 9.33 -

0.4 8.77 8.77 8.77 8.77 8.78 9.31 -

0.5 8.77 8.77 8.77 8.77 9.29 -

1.6 8.77 8.77 8.78 9.12 -

1.7 8.77 8.78 9.11 7.17E+13 -

1.8 8.78 9.1 -

1.9 9.08 -

We can also test the sensitivity of our model to variations in the number of steps and the step size. Note that since u ¯=
N 2

for a fixed N if we attempt

to decrease the truncation error by increasing u ¯ (or, in the case of our optimal step size algorithm, u ¯min ), our discretization error will increase, as the step size integration interval is proportional to the step-size. Fortunately, however, our method shows very little sensitivity to either the step-size or the truncation interval, as displayed in Table 5.13.

43

Table 5.13: Variation in Prices with change in N and u ¯min N 128 256 512 1024 40 8.777635 8.772048 8.772048 8.772048 60 8.772241 8.772048 8.772048 80 8.777052 8.772048 8.772048 u ¯min 120 8.772060 8.772048 140 8.772223 8.772048 160 8.773194 8.772048

44

Chapter 6

Conclusion
This thesis has extended the work of Dempster and Hong [11] to investigate two multivariate market models with both jumps and stochastic volatility, and derived the characteristic function under each model. Using Fourier transform techniques and an implementation of Hurd and Zhou's [17] pricing method we were able to produce results which very closely matched those produced by Monte-Carlo methods in a fraction of the time. As expected, we saw that the prices produced under our models were very sensitive to both the jump and correlation parameters. Having these additional components in our models gives us powerful tools to shape our model through parameter variation to better reflect certain characteristics observed in financial markets such as volatility and correlation smiles and smirks. On the other hand, this underscores the need for development of model calibration tools, which is not a straightforward task in the presence of jumps. Further work is needed to investigate the effects of adding jumps to the volatility processes, and the effects of stochastic correlation. Other areas of investigation should include models where the assets don't follow the same price process (for example hybrid securities where the payoff may be based on assets from different asset classes such as a rate and currency), and their use in pricing exotic derivatives. Finally, the extension of the model to the more general d-dimensional 45

case and to a wider variety of derivatives is also a worthwhile pursuit, as methods in these areas are often limited to Monte-Carlo simulation, which, as we demonstrated in this case, can be extremely slow to converge particularly in the presence of jumps.

46

Bibliography
[1] Albrecher, H. et al. , 2007, "The Little Heston Trap.", Wilmott Magazine, January issue, 83-92, 2007. [2] Alvarez, A., Escobar, M. and P. Olivares, "Pricing Spread Options Under Stochastic Covariance and Jumps", working paper, Ryerson University. [3] Bates, D. S., 1996, "Jumps and Stochastic Volatility: Exchange Rate Processes Implicit in Deutsche Mark Option," The Review of Financial Studies, 9, 69-107. [4] Black, F. and M. Scholes, 1973, "The Pricing of Options and Corporate Liabilities", Journal of Political Economy, 81(3), 637-654. [5] Brandimarte, Paolo, 2005, Numerical Methods in Finance and Economics, Wiley. [6] Carmona, R. and V. Durrleman, 2003, "Pricing and hedging spread options," SIAM Review, 45, 627-685 [7] Carr, P., Madan, D. 1999. Option valuation using the fast Fourier transform, Journal of Computational Finance, 2(4), 61-73. [8] Cheang, G. H. L. and C. Chiarella, "Exchange Options under Jump-Diffusion Dynamics," 2008, Quantitative Finance Research Centre Research Paper No. 235. Available at SSRN: http://ssrn.com/abstract=1352126

47

[9] Cont, R. and P. Tankov, 2003, Financial Modelling with Jump Processes, Chapman/Hall. [10] Delbaen, F. and W. Schachermayer, 1994, "A General Version of the Fundamental Theorem of Asset Pricing," Mathematische Annalen, 300(1), 463520. [11] Dempster, M.A.H. and S.S.G. Hong, "Spread option valuation and the fast Fourier transform", Mathematical Finance - Bachelier Congress 2000, 203-220. Springer. [12] Eberlein, E., Glau, K. and A. Papapantoleon, 2009. "Analysis of Fourier transform valuation formulas and applications," working paper, Freiburg University. [13] Escobar, M. and P. Olivares, 2010, "The Principal Component Stochastic Volatility Model: Estimation and Pricing of Mountain Range Derivatives", working paper, Ryerson University. [14] Glasserman, Paul, 2003, Monte Carlo Methods in Financial Engineering, Springer. [15] Heston, S. L., 1993, "A Closed-Form Solution for Options with Stochastic Volatility with Applications to Bond and Currency Options," The Review of Financial Studies, 6, 327-343. [16] Hikspoors, S. and S. Jaimungal, 2006, "Energy Spot Price Models and Spread Options Pricing," International Journal of Theoretical and Applied Finance, 10(07), 1111-1135. [17] Hurd, T. R. and Z. Zhou, 2009, "A Fourier transform method for spread option pricing", SIAM Journal on Financial Mathematics, 1, 142-157. [18] Margrabe, W., 1978, "The Value of an Option to Exchange One Asset for Another," Journal of Finance, American Finance Association, 33(1), 177-86. [19] Shoutens, W., 2003, Levy Processes in Finance, Wiley. 48

[20] Stein, E. M. and J.C. Stein, 1991, "Stock Price Distributions with Stochastic Volatility: An Analytic Approach", The Review of Financial Studies, 4, 727-752.

49

