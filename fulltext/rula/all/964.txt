STOCHASTIC MODELLING OF RESIDUAL TROPOSPHERIC
DELAYS

By

Hassan Elobeid Ibrahim
B.Eng. (Hons), Ryerson University,

A thesis

to Ryerson University

In partial fulfillment of the
requirement for the degree of
Master of Applied Science

in the Program of Civil Engineering

Toronto, Ontario, Canada, 2008 © Hassan Elobeid Ibrahim 2008 PROP»iY©F

ryersok mimm uwwt

ABSTRACT

DECLARATION

I hereby declare that I am the sole author of the thesis. I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research.

Hassan Elobeid Ibrahim

STOCHASTIC MODELLING OF RESIDUAL TROPOSPHERIC DELAYS
MASc. of Civil Engineering, Ryerson University
2008

Hassan Ibrahim

Real-time and near real-time precise point positioning (PPP) requires shorter solution
convergence time. Residual tropospheric delay, which exists as a result of the limitations
of current tropospheric correction models, is a limiting factor for fast PPP convergence.

I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or part, at the request of other institutions or individuals for the
purpose of scholarly research.

To overcome the limitations of existing tropospheric models, we proposed a new

approach. In this approach, the bulk of the tropospheric delay is accounted for using an
Hassan Ibrahim

empirical model, while the residual component is accounted for stochastically. The analysis of many daily tropospheric residuals data series for stations spanning North America shows that the residual component can be accounted for using an exponential cosine model. A random walk (RW) model was also developed and used along with the NOAA tropospheric corrections with Vienna Mapping Function 1. It is shown that the
RW improved the accuracy of station coordinates within the PPP convergence time by a
few centimetres.

in
n

This research became possible by the partial funding provided by The Natural Sciences
ACKNOWLEDGMENT

I would like to express my sincere gratitude to my supervisor, Dr. Ahmed El-Rabbany for his continuous and unlimited support, encouragement, guidance, advice, and his
wonderful friendship since I was an undergraduate student at Ryerson and through my
graduate studies. I feel honoured to have had the opportunity to have him as my mentor
and to be a member of his research team.

and Engineering Research Council of Canada (NSERC), The Geomatics for Informed
Decisions (GEOIDE), The Network Centres of Excellence (NCE), The Ontario Graduate Scholarship for Science and Technology (OGSST),
Scholarship (OGS).

and The Ontario Graduate

And, lastly I would like to thank my wife, whose support and understanding got me
through the toughest of times and gave me the courage to strive.

I am grateful to Pierre Heroux and Francois Lahaye from Geodetic Survey Division

(GSD) of the Natural Research Canada (NRCan) for providing me with the GPSpace ®
software source code. I further thank Francois for his continuous support and broadening
my horizons through technical discussions.

I would also like to thank my friend Hamad Yousif from Ryerson University for providing me with Lagrange Interpolation code. My lab mates: Mohamed Elsobeiey,
Abdulla Alnaqabi, and Amit Joshi were especially forthcoming with their valuable inputs
and creative ideas and I would like to wish them luck for their future endeavours

Thanks to Seth Gutman and Susan Sahm from the National Oceanic and Atmospheric Administration (NOAA) Forecast Systems Laboratory (FSL), for providing me with the
NOAA model software and access to the NOAA model grid files, without which my
research would have been incomplete.

IV

TABLE OF CONTENTS

DECLARATION ABSTRACT
ACKNOWLEDGMENT DEDICATION

ii Hi
iv vi

TABLE OF CONTENTS

vii

LIST OF TABLES LIST OF FIGURES
DEDICATION

xi xii 1
1

1

INTRODUCTION
1.1 Background on Thesis Work

To my parents, wife, and daughter

1.2

Problem Statement

3

1.3
1.4

Research Objectives
Thesis Outline

3
4

1.5

Thesis Contributions

5

2

OVERVIEW OF GPS
2.1 2.2 2.3 Introduction GPS Space Segment Control Segment

6
6 7 8

2.4
2.5 2.6
2.6.1 2.6.2

User Segment
GPS Signal Structure GPS Errors and Biases
Satellite Clock Error Receiver Clock Error

10
11 12
12 13

VI

vn

2.6.3
2.6.4 2.6.5

Receiver Noise
Antenna Phase Center GPS Ephemeris Errors

13
l4 14

4.1
4.1.1 4.1.2

Random Processes
Gauss-Markov (GM) Process Periodic Random (PR) Process

50
50 52

2.6.6
2.6.7

Ionospheric Delay
Tropospheric Delay

15
15

4.1.3
4.2

Random Walk Process
Residual Tropospheric Delay Time Series

52
52

2.6.8
2.6.9
2.7
2.7.1
2.7.2

Multipath
Selective Availability
GPS Positioning Modes
Point Positioning
Relative Positioning

16
17
iO
1O
iO
1 8
1 Q

4.2.1 4.2.2
4.2.3

Data and Data Sources Interpolation of ZTD Data
Residuals Zenith Total Tropospheric Delay

52 54
56

4.3
4.4

Linear Trend Removal
Assessment of Tropospheric Delay Models

58
58

2.7.3

Precise Point Positioning (PPP)

l9

4.5 4.6 4.7 4.7.1 4.7.2 4.7.3

Autocovariance Estimation Empirical Autocovariance Models Stochastic Modelling Results Results for Saastamoinen- and Hopfield-Based Residuals Results for NOAA-Based Residuals Random Walk Modelling

59 60 60 60 64 74

3

TROPOSPHERIC DELAY MODELS

24

3.1
3.2

The Atmosphere
Neutral Atmosphere

24
ZD

3.3

Tropospheric Zenith Delay Modelling

27

3.3.1
3.3.2

Fundamentals
Empirical Hydrostatic and Wet Zenith Delay Models

27
29
5

RESULTS AND ANALYSIS
5.1
5.2 5.3

76
76
79 81

3.4

The IGS Tropospheric Product

39

VMF1 vs. NMF
NOAA-VMF1 vs. Hopfield-NMF Implementation of Random Walk Stochastic Model

3.5
3.6
3.7
4

Mapping Functions
Tropospheric Delay Models in GPSpace
Implementation of NOAA Tropospheric Delay Corrections into GPSpace

40
47
48
6

CONCLUSIONS AND RECOMMENDATIONS 6.1 Conclusions
Recommendations for Future Research

84 84
86

STOCHASTIC CHARACTARICTICS OF RESIDUAL TROPOSPHERIC

DELAY

49

6.2

IX

Vlll

REFERENCES
APPENDIX I: DAILY RESIDUAL TROPOSPHERIC DELAY TIME SERIES

88

LIST OF TABLES Table 3.1 Correction term B for the refined Saastamoinen model (Hofmann-Wellenhof et

FOR SAASTAMOINEN, HOPFIELD AND NOAA MODELS
APPENDIX II: DAILY RESIDUAL TROPOSPHERIC DELAY TIME SERIES

92

al.,2001) Table 3.2 Correction term SR in meters for refined Saastamoinen model (Hofmann-

31

FOR NOAA MODEL

93

Wellenhof et al., 2001)
Table 3.3 Coefficients of baby et al. model for wet zenith delay (Mendes, 1999) Table 3.4 Niell Mapping Function coefficients (Leick, 2004)

32
34 42

APPENDIX HI: ESTIMATED AUTOCOVARIANCE FUNCTION OF RESIDUAL

TROPOSPHERIC DELAY
APPENDIX IV: RESIDUAL TROPOSPHERIC DELAY OVER THE YEAR
APPENDIX V: FITTING OF THE ESTIMATED AUTOCOVARIANCE

95
97

Table 4.1 The ACF and correlation time for different order GM processes (Gelb, 1974)51 Table 4.2 Correlation time based on first-order Gauss Markov for Saastamoinen- and

FUNCTION
APPENDIX VI: AUTOCOVARIANCE FUNCTION FITTING RMS APPENDIX VII: FLUNCTUATION OF MODELS' COEFFIEINETS APPENDIX VIII: MEAN OF AUTOCOVARIANCE FUNCTION EMPIRICAL

102
105 107

Hopfield-based residuals (minutes)

63

Table 4.3 Coefficients mean and standard deviation of empirical ACF for Saastamoinen-

based residuals
Table 4.4 Coefficients mean and standard deviation of empirical ACF models for

64

MODELS'COEFFICIENTS
APPENDIX IX: SAASTAMOINEN-, HOPFIELD- AND NOAA-BASED

108

Hopfield-based residuals
Table 4.5 Correlation time based on first-order Gauss Markov model for NOAA-based

64

STOCHASTIC MODLES COEFFICIENTS MEAN
APPENDIX X: DAILY MEAN OF RANDOM WALK NOISE RATE

109
HI

residuals (minutes)

72

Table 4.6 Coefficients mean and standard deviation of empirical ACF models for NOAA-

based residuals

72

XI

LIST OF FIGURES
Figure 2.1 GPS Segments (from AERO, 2008)

Figure 4.9 Distribution of days processed for NOAA-based ZTD residuals at 10 stations

over 2006

65
66 67

Figure 2.2 GPS Constellation (from AERO, 2008)

8

Figure 4.10 NOAA-based residual ZTD at 8 stations on day 20 of 2006 Figure 4.11 NOAA-based ZTD residual at station USNO over 2006

Figure 2.3 Positions of Master Control station and Monitor Stations (from NASA, 2008)9 Figure 2.4 Multipath Acquisition (from GPS-System, 2008) 17

Figure 4.12 IGS new ZTD product at station ALGO over 2007
Figure 4.13 NOAA ZTD at station ALGO over 2007 Figure 4.14 Spike in NOAA ZTD at station USNO on day 75 of 2006

67
68 68

Figure 3.1 Atmosphere Regions (adapted from Leick, 1995)
Figure 3.2 Thickness of polytropic layers for the troposphere (adapted from Hofmann-

25

Wellenhofetal.,2001)

35
39

Figure 4.15 Autocovariance function of NOAA-based residual ZTD at 8 stations on day

Figure 3.3 Flowchart of NOAA tropospheric delay software processing (from Gutman et
al., 2003)

20 of 2006

69

Figure 4.16 Fitting of ACF of NOAA-based residual at station NLIB on day 280 of 2006
70

Figure 4.1 IGS station distribution in North America (IGS, 2008) Figure 4.2 Lagrange interpolation error for day 15 of 2006 at station MD01

53 56
Figure 4.17 Fitting RMS of NOAA-based residual at station JPLM over 2006

71

Figure 4.3 NOAA-, Hopfield -, and Saastamoinen-based residual ZTD before removing
the linear trend

Figure 4.18 Fluctuations of coefficients of NOAA-based stochastic models at station

57

FLIN over 2006

73

Figure 4.4 NOAA-, Hopfield -, and Saastamoinen-based residual ZTD after removing the
linear trend

Figure 4.19 Mean of stochastic models' coefficients of the NOAA-based residual ZTD at

58

different stations
Figure 4.20 Daily mean of RW noise rate at station ALGO over 2006

74
75 77

Figure 4.5 NOAA-, Saastamoinen-, and Hopfield-based residual ZTD at station ALGO
on day 15 of 2006 Jy
59

Figure 5.1 Improvement in X-coordinates when using VMF1 against NMF

Figure 4.6 Hopfield- and Saastamoinen-based residual ZTD before linear trend removed

Figure 5.2 Improvement in Y-coordinate estimates when using VMF1 against NMF .... 78
Figure 5.3 Improvements in Z-coordinate estimates when using VMF1 against NMF... 78 Figure 5.4 Comparing Latitude estimates using NOAA and VMF1 one time and in another Hopfield and NMF at station PIE1 on day 15 of 2006 80

at station USNO on day 279 of 2006

61

Figure 4.7 Hopfield- and Saastamoinen-based residual ZTD after linear trend removed at

station USNO on day 279 of 2006
Figure 4.8 Mean of model coefficients at station ALGO

61
62

Xlll

xn

Figure 5.5 Comparing Longitude estimates using NOAA and VMF1 on time and in
another Hopfield and NMF at station PIE 1 on day 15 of 2006 80

Figure IV.6 NOAA-based residual ZTD at station JPLM over 2006

99

Figure IV.7 NOAA-based residual ZTD at station MD01 over 2006

100
100

Figure 5.6 Comparing height estimates using NOAA and VMF1 one time and in another

Hopfield and NMF at station PIE1 on day 15 of 2006
Figure 5.7 Comparing Latitude estimate using RW stochastic for ZTD one time and in another for residual ZTD at station PIE1 on day 15 of 2006
Figure 5.8 Comparing Longitude estimates using RW stochastic model for ZWD one

81

Figure IV.8 NOAA-based residual ZTD at station NLIB over 2006
Figure IV.9 NOAA-based residual ZTD at station PRDS over 2006

100
101

82

Figure V. 1 Fitting of autocovariance of NOAA-based residual at station JPLM on day

215 of 2006

102

time and in another for residual ZTD at station PIE1 on day 15 of 2006 Figure 5.9 Comparing height estimates using RW stochastic model for ZWD one time

83

Figure V.2 Fitting of ACF of Hopfield-based residual at station JPLM on day 215 of

2006

102

and in another for residual ZTD at station PIE1 on day 15 of 2006

83

Figure V.3 Fitting of ACF of Hopfield-based residual at station MDO1 on day 45 of 2006
103

Figure I.I NOAA-, Hopfield-, and Saastamoinen-based ZTD at station PRDS on day 201 of 2006
Figure II. 1 NOAA-based residual ZTD at 10 stations on day 110 of 2006
92

vz
93

Figure V.4 Fitting of ACF of Saastamoinen-based residual at station USNO on day 180

of 2006

103

Figure II.2 NOAA-based residual ZTD at 10 stations on day 202 of 2006
Figure II.3 NOAA-based residual ZTD at 9 stations on day 304 of 2006

93
94

Figure V.5 Fitting of ACF of NOAA-based residual at station HLFX on day 104 of 2006
104

Figure III. 1 ACF of NOAA-based residual ZTD at 9 stations on day 110 of 2006 Figure III.2 ACF of NOAA-based residual ZTD at 10 stations on day 202 of 2006

95 95

Figure V.6 Fitting of ACF of NOAA-based residual at station HLFX on day 158 of 2006
104

Figure III.3 ACF of NOAA-based residual ZTD at 10 stations on day 304 of 2006
Figure IV. 1 NOAA-based residual ZTD at station ALGO over 2006 Figure IV.2 NOAA-based residual ZTD at station AMC2 over 2006 Figure IV.3 NOAA-based residual ZTD at station FLIN over 2006 Figure IV.4 NOAA-based residual ZTD at station HLFX over 2006 Figure IV.5 NOAA-based residual ZTD at station HOLB over 2006

96
97 97 98 98 99

Figure VI. 1 Fitting RMS of NOAA-based residual at station AMC2 over 2006 Figure VI.2 Fitting RMS of NOAA-based residual at station FLIN over 2006 Figure VI. 3 Fitting RMS of NOAA-based residual at station FLIN over 2006

105 105 106

Figure VII. 1 Fluctuation of models coefficients at HOLB for NOAA based residual... 107 Figure VII.2 Fluctuation of models coefficients at NLIB for NOAA based residual 107

xv
xiv

Figure VIII. 1 Mean of stochastic models' coefficients of the Saastamoinen-based residual
ZTD at different stations 108

Figure VIII.2 Mean of stochastic models' coefficients of the Hopfield-based residual ZTD
at different stations 108

1

INTRODUCTION

Figure IX. 1 Model coefficients mean of coefficient at station JPLM Figure IX.2 Model coefficients mean of coefficient at station MDO1

109 109

1.1

Background on Thesis Work

Figure IX.3 Model coefficients mean of coefficient at station PRDS Figure IX.4 Model coefficients mean of coefficient at station USNO Figure X. 1 Daily mean random walk noise rate at station AMC2 over 2006
Figure X.2 Daily mean random walk noise rate at station FLIN over 2006

110 110 111
111

GPS is affected by a number of errors and biases, including receiver clock error, multipath, tropospheric and ionospheric delays, and satellite clock and orbital errors. Tropospheric delay represents one of the dominant errors after the availability of precise orbits and clock products from the International GNSS Service (IGS). The tropospheric delay correction is essential for unbiased GPS coordinate solutions (Vollath et al., 2003). Tropospheric delay occurs as a result of the transmission of the GPS signal through the
troposphere, the lower layer of the atmosphere. It delays the carrier phase and the code

Figure X.3 Daily mean random walk noise rate at station HLFX over 2006
Figure X.4 Daily mean random walk noise rate at station HOLB over 2006 Figure X.5 Daily mean random walk noise rate at station JPLM over 2006 Figure X.6 Daily mean random walk noise rate at station MD01 over 2006 Figure X.7 Daily mean random walk noise rate at station NLIB over 2006
Figure X.8 Daily mean random walk noise rate at station PRDS over 2006 Figure X.9 Daily mean random walk noise rate at station USNO over 2006

112
112 113 113 114
114 115

measurements equally for signals with a frequency of 15 GHZ or less (Hay and Wong,
2000).

Tropospheric delay consists of two components: the first component is the hydrostatic or dry portion and the second component is the wet portion. The hydrostatic component represents about 90% of the total tropospheric delay, while the wet component represents the remaining 10%. The hydrostatic component can be estimated very precisely with

empirical models (El-Rabbany, 2006), while the wet component is hard to estimate
precisely with empirical models. This is because it is not easy to measure the water
content along the path of the GPS signal.

xvi

1

1.2

Problem Statement

In GPS Precise Point Positioning (PPP), tropospheric path delay is typically expressed as a product of unknown total zenith path delay (ZPD), which is modelled as a random walk process noise, and a known mapping function relating slant path delay to ZPD (Kouba
and Heroux, 2001). Alternatively, the tropospheric path delay can be modelled as a function of zenith hydrostatic and wet delays, with two different mapping functions, plus

Although empirical tropospheric delay models account for the hydrostatic tropospheric delay with very high accuracy, a good model for the wet part is still not available. This is mainly because of the strong temporal and spatial variations of the water content in the atmosphere, which is difficult to measure along the GPS signal path. As a result, a residual tropospheric error component remains unmodelled. The temporal and spatial correlation of the unmodelled residual may slow down the conversion of the PPP
solution.

tropospheric gradients (Gao et al., 2004). In such a case, the zenith wet delay and two

gradient coefficients are to be estimated. Unfortunately, unlike the zenith hydrostatic
delay, the zenith wet delay is highly correlated with the total zenith tropospheric delay (Gutman at al., 2003), which in turn is known to be highly correlated with the height
component of the station coordinates (Kouba, 2003). The existence of such high cross-

This research attempts to model the residual tropospheric delay stochastically by utilizing
ZTD residuals of three tropospheric delay models, namely the Saastamoinen, Hopfield

correlation as well as the temporal correlation of the tropospheric path delay slows down

and NOAA, are stochastically modelled. The data used in this research was obtained for
stations spanning a region covering United States and part of Canada. Therefore,

the convergence of the PPP solution. More recently, a number of regional and local
monitoring networks have been established to generate tropospheric corrections. Among

stochastic models obtained in this research will be valid for the region covering the
United States and most of the populated portion of Canada.

them is the NOAA tropospheric correction model, which incorporates GPS observations

into numerical weather prediction (NWP) models (Gutman at aL, 2003). The model is distributed as a 2-D grid file, which is updated hourly and contains the zenith
tropospheric delay over the U.S. and surrounding regions (including a large portion of

1.3

Research Objectives

Canada). Unfortunately, however, although the model improved the positioning solution compared to the empirical tropospheric delay models (e.g., Saastamoinen and Hopfield
models), a residual tropospheric error component remains unmodelled. Such a residual

The main objective of this research is to improve tropospheric delay modelling, which not only speeds up the GPS solution convergence but also improves the GPS positioning
accuracy. This will be fulfilled through a number of tasks as follows:

error component is found to be temporally correlated, which may slow down the
conversion of the PPP solution.

1

Estimation of total zenith tropospheric delay using empirical and NWP-based
tropospheric delay models.

2

Retrieval of total zenith tropospheric delay residuals using the new IGS
tropospheric product as a reference. ·*

Chapter 4 presents the theory of stochastic modelling, and the stochastic modelling

methodology followed in this thesis to model the residual tropospheric delay for each of the Saastamoinen-, Hopfield-, and NOAA-based residuals. Results of the stochastic
models for the Saastamoinen- Hopfield-, and the NOAA-based residual tropospheric
delay are also presented.

3

Estimation of autocovariance functions using daily time series of total zenith
residuals tropospheric delay.

4 5

Fitting of the estimated autocovariance functions to empirical covariance models. Assessing the obtained stochastic models for seasonal and geographical location
variations.

Chapter 5 presents the tropospheric models and the mapping functions available in the GPSpace PPP software. Also this chapter shows how the NOAA tropospheric delay correction is implemented into the GPSpace software. The results of implementation of the NOAA tropospheric delays into the GPSpace software and its effect on the
positioning accuracy are also given in this chapter.

6

Estimation of the random walk noise rate of NOAA-based zenith total residual
tropospheric delay.

1.4

Thesis Outline
In chapter 6, the main conclusions, as extracted from the obtained results and performed

Chapter 1 presents a background on thesis work, problem statement, research objectives,
thesis outlines and thesis contributions.

analysis, are presented. In addition, recommendations for future research work are given.

Chapter 2 provides an overview of the GPS in section 1. In section 2, the GPS biases and

errors are discussed. In section three, the GPS point and relative positioning, and Precise
Point Positioning (PPP) are presented.

1.5

Thesis Contributions

The contributions of this research can be summarized as: · to develop stochastic models for residual tropospheric delays.

Chapter 3 provides an overview of the various atmospheric layers. It also discusses a

·

to develop regional stochastic models for NOAA-based residual tropospheric delay that can be applied for all of United States and the southern part of Canada.

number of widely-used empirical tropospheric delay models with emphasis on the NOAA tropospheric delay model. This chapter ends with a discussion on common tropospheric
mapping functions, including the recently-developed Vienna mapping function 1
(VMF1). 4

· · ·

to implement the NOAA-based model into the GPSpace software. to improve the accuracy of point positioning. to shorten the PPP solution convergence time.
5

2

OVERVIEW OF GPS

2.2

GPS Space Segment

The GPS constellation consisted nominally of 24 operational satellites, arranged so that

2.1

Introduction

there were four satellites placed in each of the six orbital planes (Figure 2.2) to ensure continuous worldwide coverage, originally known as the initial operational capability

The GPS is a satellite-based navigation system that was originally developed by the United States Department of Defence (DOD) in early 1970s. GPS was initially

(IOC) that was completed in July of 1993, which was officially confirmed on December
8, 1993 (El-Rabbany, 2006).

developed as a military system to fulfill military requirements but later made available
for civilian use and has since become a dual-use system that is accessible by both military and civilian users (El-Rabbany, 2006). GPS provides continuous positioning and timing
information worldwide no matter the weather condition is. Since GPS serves an

With this constellation geometry, four to ten GPS satellites are visible anywhere in the world at any given time if an elevation angle of 10° is considered. The GPS satellite

unlimited number of users, both civilian and military, it has been designed as a one-way

orbits are nearly circular (an elliptical shape with a maximum eccentricity of about 0.01)

passive system where the users can only receive satellite signals (El-Rabbany, 2006). GPS consists of three segments: the space segment, the control segment and the user
segment (Hofmann-Wellenhof et al., 2001) (Figure 2.1).

with an inclination of 55° to the equator. The semi-major axis of the GPS orbit is 26578 kilometres (Xu, 2007). This has a corresponding GPS orbital period of approximately 12
sidereal hours (~ 11 hours, 58 minutes).

Figure 2.1 GPS Segments (from AERO, 2008)

control segment manages all the satellites with the primary task being the tracking of the GPS satellites in order to determine and predict satellite positions, system integrity,
behaviour of the on-board atomic clocks, atmospheric correction, satellite almanac and

other considerations. The control segment also ensures that the satellite orbits and atomic
clocks remain within acceptable limits.

Currently there are 12 GPS monitor stations (El-Rabbany, 2006) (Figure 2.3) located in

Colorado Springs, Hawaii, Kwajalein, Diego Garcia, Washington, DC (the US Naval
Observatory), United Kingdom (Hermitage), Ecuador (Quito), Argentina (Buenos Aires),
Figure 2.2 GPS Constellation (from AERO, 2008)

Ascension Island, Bahrain (Manama), and Australia (Adelaide). These stations' locations

are selected in such a way that each GPS satellite can be tracked by at least ten monitor
The current GPS constellation as of May 21, 2008 consists of 14 Block IIA, 12 Block IIR and six Block IIR-M satellites (USNO, 2008). This makes the total number of

stations (El-Rabbany, 2006). Each of the monitor stations collects GPS observations that are transmitted to the master control station for processing to produce predicted satellite navigation data (El-Rabbany, 2006). This predicted data is then transmitted to the GPS
satellites through the GPS ground antennas.

operational GPS satellites to be 32. All GPS satellites are equipped with on-board atomic clocks: Block II/IIA satellite has two Cesium (Cs) and two Rubidium (Rb) clocks while Block IIR satellite has three Rubidium atomic clocks (USNO, 2008). At any given time only one clock is selected to provide the frequency and the timing requirements for the generation of the GPS signal. The stability of these clocks is in the order of 1 to 2 parts

~, England

nington DC
tomtaK So bar

Hawaii

fe
iscension Isl
r»'?r tea Btabon

Moratn Station
·

<  ·

Kwa|ale
[

Mantai Sal i

in 1013 over a period of one day (El-Rabbany, 2006).

Diego Garcia
PAanitw Station

*
Australia
M&* Mentor St=ii

Argentmia
'JG A Monitor Station

·

2.3

Control Segment

The GPS control segment consists of a master control station, monitor stations, and

Figure 2.3 Positions of Master Control station and Monitor Stations (from NASA,
2008)

ground control antennas. The control segment is considered the 'brain' of the GPS. The
8

The master control station, which is located at Falcon Air Force Base in Colorado
Springs, Colorado, is responsible for the overall management of the remote monitoring

2.5

GPS Signal Structure

Each GPS satellite transmits a signal that consists of five components. These components are two sine waves (also known as frequency carriers), two digital codes and a navigation

and transmission sites. Being the centre for support operations, it calculates any position or clock errors for each individual satellite based on information received from the monitor stations and then 'orders' the appropriate ground antennas to relay the requisite
corrective information back to that satellite.

message. The two carrier frequencies generated on the L-band are LI with a frequency
of 1575.42 MHz and a wavelength of 19 centimetres, and L2 with a frequency of 1227.60

MHz and a wavelength of 24.4 centimetres. All GPS satellites transmit the same carrier frequencies while the codes transmitted are unique to each satellite. The coarse

There are four ground antennas located at the same site as the monitor stations at

acquisition-code (C/A-code) used to be transmitted on the LI frequency only.

Each

Ascension Island, Diego Garcia, Kwajalein, and Cape Canaveral, Florida. The ground
antennas are capable to transmit commands and data to the satellites and receive
telemetry and ranging data from the satellites (Hofmann-Wellenhof et al., 2007).

satellite transmits a unique C/A-code that enables the GPS receiver to identify which satellite is transmitting a particular code (El-Rabbany, 2006). This code has a repeating
duration of 1 millisecond consisting of a stream of 1,023 binary digits. The precision-

code (P-code) is transmitted on both the LI and L2 frequencies. Each satellite is assigned
a unique one-week segment of the precision code that is 266 days in overall length. The

2.4

User Segment

duration of one bit is 0.1 microseconds.

The GPS user segment includes all the equipment of the military personnel and civilian
users of the system who receive GPS signals (El-Rabbany, 2006). These equipments
As a result of the GPS modernization a civilian L2 (L2C) is transmitted by all Block IIR-

include a GPS receiver and antenna. In general the GPS receiver is composed of an

M GPS satellites and later design satellites. L2C consist of two codes, civilian moderate length code (CM), which is 10230-bit in length and is repeating every 20 ms, and civilian long length code (CL), which is 767250-bit in length and is repeating every 1500 ms.

antenna, receiver processor and a highly stable clock. It may also include a display for
providing position and speed information. A receiver is usually characterized by its

number of channels. The receiver number of channels indicates how many satellites the receiver can monitor simultaneously. Now-a-days most of GPS receivers have typical
number of channels between 9 and 12 (El-Rabbany, 2006).

Also as part of the GPS modernization, Block IIF GPS satellite will transmit a safety-oflife civilian signal (L5) of a frequency 1176.45 MHz.

11 10

2.6

GPS Errors and Biases

computing the distance to the satellites, GPS receivers subtract the satellite clock errors from the reported transmit time to come up with the signal travel time.

There are several types of random and systematic errors that affect the accuracy of GPS
observations. These errors can be classified as errors related to the GPS satellite, errors

related to the GPS receiver and errors related to the atmosphere (El-Rabbany, 2006).

2.6.2

Receiver Clock Error

Similar to GPS satellite clock errors, any error in the GPS receiver clock causes

The satellite related-errors include satellite clock errors, ephemeris errors and the effect
of selective availability. Receiver related-errors include receiver clock errors, receiver

inaccuracy in distance between the satellite and the receiver antennas phase centres.

However, the receiver clock error is much larger compared to the satellite clock error. GPS receivers are normally equipped with inaccurate clocks (crystal clocks) compared to

noise, antenna phase center variation and multipath. The atmospheric errors include the
effect of the ionosphere and the troposphere on the GPS signal. The following paragraphs
discuss some of these errors mentioned above.

satellite clocks. One way to remove the receiver clock error is applying the technique of differencing between satellites. Another way of dealing with the GPS receiver error is
considering it as one of the estimation process unknowns (El-Rabbany, 2006).

2.6.1

Satellite Clock Error

GPS satellites are equipped with atomic clocks (Cesium and/or Rubidium clocks). Although, atomic clocks are highly accurate, but they are not perfect. As we mentioned
2.6.3 Receiver Noise

earlier GPS satellite clocks have a stability that is about 1 to 2 part in 1013 over the period
of one day. This range of stability means the satellite clock error is in the range of 8.64 to 17.28 ns (El-Rabbany, 2006). One nanosecond of inaccuracy in a satellite clock results in

GPS Receivers introduce some noise that affects the GPS observation. The level of the receiver noise varies from receiver to another. The noise comes essentially from the
thermal noise, which is caused by the electrons movement within the receiver's parts (Teunissen and Kelusberg, 1998). In high quality receivers, however, the receiver noise

about 30 centimetres of error in measuring the distance to that satellite. The satellite
clock error can cause about 2.59 m to 5.18 m in the range between the satellite and the

is negligible (less than one millimetre) for carrier phase and a few centimetres for code
phase (El-Rabbany, 2006).

receiver. To resolve the satellite clock drifts, they are continuously monitored by ground stations and compared with the master control clock systems that are combinations of more than 10 very accurate atomic clocks. The errors and drifts of the satellites' clock are calculated and included in the messages that are transmitted by the satellites. In

12

13

2.6.4

Antenna Phase Center

where the baseline lengths are hundreds or thousands of Errors may limit the accuracy of the baseline solution.

mens

Depending on the satellite azimuth and elevation, and the intensity of the GPS signal, the
GPS signal may reaches the receiver antenna at different points. This point is called the

antenna phase center. Generally, in each antenna the phase center is different from the
geometrical center. The antenna phase center variation causes an error in the range

2.6.6

Ionospheric Delay

The ionosphere is the upper layer of the atmosphere. It extends from 50 km to 1000 km altitudes. As a result of ionizing radiation, electrons exist in the ionosphere layer (Teunissen and Kelusberg, 1998). Electrons exist in quantities that enough to influence the GPS signal. The ionosphere is a dispersive medium, it has two effects on the GPS signal, it bends the signal and changes its speed. The bending effect can be neglected since it causes negligible range error, however, it causes significant range error, it speeds up the carrier phase beyond the speed of light while it delay the code (El-Rabbany, 2006).

between the receiver and the satellite. The size of this error is on the order of a few
centimetres (El-Rabbany, 2006), and it depends on the antenna's type.

2.6.5

GPS Ephemeris Errors

Ephemeris errors are the error in the GPS satellite position. Ephemeris errors are caused as a result of the limitations in modelling the forces acting onto the GPS satellite (ElRabbany, 2006). position) errors. The GPS signal contains information about the ephemeris (orbital The broadcast ephemerides for a satellite are the predictions of the

In general, ionospheric delay can reach range error of the order of 5m to 15m, and up to 150m with severe solar activity. One way of delaying with ionospheric delay error is

current satellite position and velocity as determined by the Master Control Station. These are uploaded to the GPS satellites, and transmitted to the user receiver in the navigation message. The precise ephemeris are post-processed values derived by, for example, the
International GNSS Service (IGS), and available to users post-mission via the Internet. Ephemeris errors are due to the slight deviations in the orbital paths of the satellites from

using empirical models such as Klobuchar, the coefficients of which are included with
navigation message.

2.6.7

Tropospheric Delay

The troposphere is the lower layer of the Earth atmosphere, which contains water vapours, is known as the troposphere. The thickness of the troposphere layer is not constant. It reaches 9 and 16 km over the poles and the equator respectively (Teunissen and Kleusberg, 1998). The effect of the troposphere on the GPS signal is that it delays both the carrier and the code. Tropospheric delay can be separated into its wet and dry

their predicted path.

Broadcast ephemeris errors are typically at the few metre level,
Ephemeris errors are

while the precise ephemeris errors are at the decimetre-level.

largely mitigated by differential correction (in DGPS Positioning) or in doubledifferenced observables (formed from carrier phase measurements) when the receivers
are not up to a few tens of kilometres apart. In very high precision applications and/or
14

15

components.

As we mentioned earlier in chapter one, the dry component represents

can be categories as: hardware and software solutions as well as careful site selection
(Xia, 2004).

about 90% of the delay and can be predicted with a fairly high degree of accuracy using
mathematical models (El-Rabbany, 2006). The wet component of the troposphere delay

depends on the amount of water vapour that the GPS signal has to pass through on its way to the receiver. frequency systems. The effects of the troposphere cannot be removed using dual It was found that using default meteorological data (1010 mb for

atmospheric pressure, 20°C for temperature, and 50% for relative humidity) for the most
part gives satisfactory results (El-Rabbany, 2006).

2.6.8

Multipath

Figure 2.4 Multipath Acquisition (from GPS-System, 2008)

Multipath is one of the major error sources that affect the GPS signal. Multipath happens
when the signal coming from the satellite antenna reaches the receiver antenna through different paths (see Figure 2.4), as a result of signal refection by surrounding objects to
the antenna. The direct signal and the reflected signals interfere at the antenna.

2.6.9

Selective Availability

Originally, GPS designed in a way that accuracy of using the P-code receiver for real time autonomouous positioning to be superior compared to the C/A code, however, the obtained accuracy of the two receivers was almost the same (El-Rabbany). To keep the

Multipath has effect on both carrier phase and code measurements, but its error size is larger on the pseudorange measurements compared to the carrier measurements (ElRabbany, 2006). Multipath can cause a size of error of a quarter of a cycle on the carrier

C/A code receiver accuracy degraded the US DoD had introduced the so-called selective availability (SA) on satellite Block II (El-Rabbany, 2006). This intentional degradation or SA was implemented to introduce types of errors: the first one is delta error; it results

measurements. The error on the pseudorange can reach tens of meters (El-Rabbany,
2006).

from dithering the satellite clocks. The second one is called epsilon error; it is an additional slowly varying orbital error (El-Rabbany, 2006). SA was active from March

25, 1990 till May 2nd, 2000. When the SA was on the nominal horizontal and vertical
There is no a good general model to deal with Multipath yet, as the satellite-reflectorerrors can reach up to 100m and 156m respectively.

antenna geometry hard to predict (El-Rabbany, 2006). Methods of mitigating multipath
16

17

2.7

GPS Positioning Modes

2.7.3

Precise Point Positioning (PPP)

There are two ways to acquire position using GPS: point positioning and relative, or
differential, positioning.

An alternative approach to DGPS is Precise Point Positioning (PPP). Using the PPP technique with un-differenced GPS observations, positions can be estimated logistically simpler than using the DGPS technique (Heroux et al., 2004). This requires precise

2.7.1

Point Positioning

satellite coordinates and clocks. It also requires proper modelling or estimation of the errors that cancel out in case of DGPS. PPP substitutes the burden of carrying out field procedures that are otherwise needed in DGPS to mitigate errors to proper modelling and
estimation (Heroux et al., 2004).

In GPS point positioning the location of a point on or above the Earth's surface is
obtained by using one GPS receiver. GPS point positioning is also known as standalone or autonomous positioning. In point positioning the receiver tracks four or more satellites
to determine its position with respect to the center of the Earth.

In this chapter, the theory of PPP is reviewed with emphasis on tropospheric delay
2.7.2 Relative Positioning

modelling and estimation within the GPSpace PPP software. GPSpace software has been

A more accurate positioning mode compared to point positioning is relative positioning.
developed by the Geodetic Survey Division (GSD) of National Research Canada

Relative or differential GPS (DGPS) positioning is the determination of a point position
(NRCan) for PPP. Section four of chapter three, , will give a detailed explanation of the

using two GPS receivers. In DGPS the two GPS receivers simultaneously receive signals
contributions made by the present study to the GPSpace software to accommodate for the

from the same satellites. One of the two receivers is static at a known position point and
NOAA tropospheric corrections.

selected as a reference. The other receiver is placed at the point where we need to
determine the position.

The point positioning ionospheric-free linear combinations of dual-frequency GPS pseudorange (P) and carrier-phase observations (0) can be expressed in terms of station

Differential GPS (DGPS) techniques have been applied for precise positioning since they
coordinates, clock, troposphere, and ambiguity parameters as (Kouba, 2000):

cancel out receiver and satellite clock errors and reduce significantly the atmospheric
lr=p + C(dt-dT) + Tr+£p (2.1)
(2.2)

delay (Heroux et al., 2004). Although DGPS can provide precise positioning, it has some

disadvantages: limited applicability area, accuracy depends on baseline length, errors in reference station coordinates can be propagated to the newly established stations, and an
increase in logistical complications.
where:

18

19

lp is the ionosphere-free combination of LI and L2 pseudoranges (2.54P1-1.54P2), /o is the ionosphere-free combination of LI and L2 carrier-phases (2.54O1-1.54O2),
dt is the station clock offset from GPS time,

Linearization of observation equations (2.3) and (2.4) a round a-priori parameters and
observations (Xo,)become, in matrix form:

AS+W-V=0

(2.5)

dT is the satellite clock offset from GPS time, c is vacuum speed of light,
Tr is the signal path delay due to the neutral atmosphere (mainly the troposphere), A is the carrier wave length of LI or L2, N is the ambiguity of the carrier-phase ionosphere-free linear combination, and ep and f^are the relevant measurement noise components, including multipath and

Where A is the design matrix, 8 is the vector of corrections to the unknown parameters X,

W = /(X0,) is the misclosure vector and V is the vector of residuals. The design matrix is formed by taking the partial derivatives of four types of parameters: station coordinates (x, y, z), receiver clock error (dt), tropospheric ZPD and non-integer
carrier phase ambiguities (N)
P)
ax,
A =

3/(X, p)
axv

df(X, P)
ax,

df(X, p)
dxdt

df(X, P)

df(X, P)
dX i
'v{j=l.n.tio)

biases residuals,

,*)
ax,

df(X,0)
ax.

,*)
ax.

a/(x, ,,,>
ax dt
ax.nil

(2.6)

p is the geometrical range between the satellite and the receiver antennas' phase centres it
expressed as: where

a/

=x-xs

ax,

'

axv"

P

'

dxz ~

P

'

ax,

 = 0or\

where (Xs, Yx, Zs) are the satellite antenna phase centre coordinates and (x, y, z) are the
receiver antenna phase centre coordinates.
Substituting the tropospheric path delay Tr by the ZPD multiplied by a mapping function

X

y
z

dt

zpd

and removing the satellite clock error (dT) in (2.1) and (2.2) gives the following
equations:

N' (j=l,nsat)

The least-squares solution is defined as:

fp=p+C*dt+M*ZPD+ep-P = O f^ =p + C*dt+M *ZPD+N*A+e<p-® = 0

(2.3) (2.4)

x + ATPAyl ATPW S = -(Px!)

(2.7)

Where, P is a-priori weighted constraints to the unknown parameters. Therefore, the
estimated parameters are:

20

21

And the covariance matrix is:
(2.8)

Since the carrier-phase ambiguities are constant over time, therefore,

Ce(n!

,)

=0. Also, in static mode the station coordinates are constant, and as a
=Ce(y )A[ =Ce{y )Ai =0 . The receiver clock process noise can

consequence Ce(x )
Adjustment Procedure

vary as a function of frequency stability but is normally set to white noise with largeCf(<#). Since the zenith path delay parameter varies in the order of a few
centimetres per hour, therefore, a random walk process of 2, 3, 4 or 5 mm Hhour can
be assigned to the ZPD.

In the GPSpace estimation process there are four types of parameters which need to be
estimated: station coordinates receiver clock, tropospheric zenith path delay, and carrierphase ambiguities. The adjustment procedure is a sequential filter that adjusts to different
user environment or dynamics. The adjustment considers the variation of the parameters

between observations epochs and accounts for it by using stochastic process for these
variations.

PPP Solution Convergence

PPP convergence time depends on many factors including: geometry and number of satellites, observations' quality, user environment and sampling rate (Heroux et al.,

For the adjustment a-priori estimate for the parameter is needed. Wm epoch i the iflftM
parameter estimate can be given as:

2004). While these factors vary, the time needed from the first epoch to reach a

converged solution will vary. At the first epoch, the PPP solution depends entirely on the

y»J,
The propagated covariance matrix at epoch / is given as:

"

(2.9)

pseudorange observation because the carrier-phase ambiguities are not known and the solution reflects the GPS receiver code precision and the multipath at the site (Kouba,

(2.10)

2000). After collecting more observations the solution starts to improve. The ambiguities
and the station coordinates in static mode converge to constant values while the receiver

where 0
0 0 0 0 0 0 0

0 0
0

0 0
0 0 0

clock and the tropospheric zenith path delay parameters fluctuate as a function of their
assigned process noise.

Ce(y)^
0

0

Ce{z)^
0 0
0

0

0 0
0

Ce[d
0 0

0

(2.11)

0

0

[ I -urxi) / ^

22

23

neutral atmosphere on the GPS signal is denoted as tropospheric refraction, tropospheric
path delay, or tropospheric delay (Hofmann-Wellenhof et al., 2001).

3

TROPOSPHERIC DELAY MODELS
Above the tropopause is the stratosphere, where the temperature increases and reaches

This chapter begins with a general overview of the atmosphere in section one. Section two is about the neutral atmosphere while section three includes the fundamentals of empirical tropospheric modelling. In section four, we present a number of common dry
and wet empirical tropospheric delay models with emphasis on the NOAA model. In the last section, we present a number of well-known and widely accepted mapping functions with an emphasis on the Vienna mapping function 1 (VMF1).

the maximum at the stratopause at an altitude of 50 km. Following the stratopause is the mesosphere, where the temperature decreases until it reaches the minimum at the mesopause at an altitude of 80-85 km. The temperature increases rapidly in the beginning of the thermopause, followed by a constant or a slight increase in temperature throughout
the rest of the thermosphere (Leick, 1995).

magneto sphere

thermo sphere
1500 km

3.1

The Atmosphere
upper

The atmosphere around the Earth is divided into different regions. These regions are classified based on their common physical properties such as temperature, composition,
100
cm

atmosphere

ionosphere

state of mixing, and ionization. The regions of the atmosphere are called spheres and the
mesopause

boundaries between them are called pauses (Leick 1995).
mesosphere

50 km

Figure 3.1 shows some of the atmosphere regions.
stratopause

lower atmosphere

In the classification based on temperature, the lowest region of the atmosphere is called

Figure 3.1 Atmosphere Regions (adapted from Leick, 1995)

the troposphere. The temperature in this region decreases in a rate of 10 Kelvin/km. The first boundary above the troposphere is the tropopause: it exists at an altitude of 10-12 Km. The troposphere is the lower and nonionized part of the atmosphere; it extends from the surface of the earth up to a height of about 40 km. The effect of the troposphere or the
24

There are two different regions, with regards to the ionization classification,: the ionosphere and the magnetosphere. The ionosphere exists at an altitude of 50-1500 km,

25

and is characterized by the high number of free electrons and positively charged atoms

related to the refractive index, a relation between the troposphere delay and the meteorological parameters (atmospheric pressure, temperature, and relative humidity)
exists.

and molecules. The ionization is caused mainly by the effect of the ultraviolet radiation.

The free electrons affect the GPS signal by advancing the carrier and delaying the code
by the same amount (El-Rabbany, 2006). The magnetosphere exists above the
ionosphere, where the geomagnetic field manages the particle motion.

3.3

Tropospheric Zenith Delay Modelling

3.3.1

Fundamentals

3.2

Neutral Atmosphere

Fermat's principle states that the travel time of light (or any electromagnetic wave) between two arbitrary points is stationary with respect to neighbouring paths (Mendes,

The propagation of the GPS signal through the neutral atmosphere is frequency

independent because the neutral atmosphere is a non-dispersive medium for radio waves

1999). Therefore, the paths of an electromagnetic wave are determined by the condition
of the minimum time At as:

with frequencies below 15 GHz. Therefore, it affects the code modulation and the carrier phases in the same way. The effect is a delay that reaches 2.0-2.5 m in the zenith direction and increases with the decrease of the elevation angle, resulting to a delay of
20-28 m at a 5° angle (Leick, 2004).

At = \dt
path

(3-1)

. ds dt =--
v

(3.2)

The effect of the neutral atmosphere on the radio signal or the GPS signal is a result of the variability of the refractive index of the neutral atmosphere. The effect on the GPS
signal includes: first, increasing the signal travel time, and second, bending of the signal
path. The delay of the signal happens because signal's speed is decreased below the speed of light as the refractive index is more than unity. The variability of the refractive
index along the signal path is responsible for the signal path bending.

where ds is the distance and v is the velocity of the electromagnetic wave, by substituting
(3.2) in (3.1) we get:
f ds
path

At

J

ds
v

(3.3)

The velocity v is related to the refractive index of the troposphere n as:
c

n = --
v

(3.4)

At any point within the atmosphere the refractive index can be expressed as a function of atmospheric pressure, temperature, and relative humidity. As the troposphere delay is
26

where c is the speed of light

27

Using Equation (3.4) into (3.3) yields
At=-- \ nds

geometric

length

of the

signal

path and

the

geometric

path

are

identical,

i.e.

(3.5)

f ds = \ds . Therefore Equation 3.11 can be written for the zenith direction as:
path geo

c J

path

Therefore the distance along the signal path is:
s = cxAt =
path

ZTD=
path

(3.12)

nds

(3.6)

where ZTD is the tropospheric total delay in the zenith direction.

Introducing the

refractivity as N = (n -l)xl06and back substituting it in Equation 3.5 we get:
and the geometrical distance is defined as:
ZTD =

/= jds
The neutral atmospheric delay is defined by:

(3.7)

j Nds
path

(3.13)

3.3.2
(3.8)

Empirical Hydrostatic and Wet Zenith Delay Models

Separating the refractivity into hydrostatic (dry) and wet components yields

or

N=N,+N

(3.14)

d = f nds- \ ds
path geo

(3.9)

where the dry component results from the dry atmosphere and the wet component from

By adding and subtracting the geometric length of the signal path, j ds , in Equation
(3.9) we get:

the water vapour (Hofmann-Wellenhof et al., 2001). Using the dry and wet refractivity,
the dry and wet zenith delays (ZHD and ZWD) can be expressed as:
hds

(3.15)

d= \ nds- \ds+ J ds- jds
path ptith path geo

(3.10) and

ZWD = 10"6

(3.16)

= \(n-l)ds
path

path

J*-J

ds

(3.11)

geo

Therefore, obtaining ZHD and ZWD require models for the refractivity and solving of the integrations in Equations (3.15) and (3.16). The hydrostatic refractivity Nh depends on the

In Equation 3.11, the first term on the right-hand side is the delay experienced by the signal and the second is the delay due to the signal bending (Medes 1999). At zenith, the

total pressure p. The equilibrium of ideal gas condition is applied in the integration of the retroactivity. Although, the hydrostatic refractivity is based on the laws of ideal gas, its

integration requires assumptions about the variation of temperature and gravity along the

28

29

signal path The temporal and spatial variation of the partial water vapour pressure pwv,

Saastamoinen model was refined with additional correction terms and the total zenith
delay given as:

complicates the integration of the wet refractivity.

In the following paragraphs we

present various models where meteorological surface data were used.

ZTD =

0.002277
cosz

ps +

(1255

+ 0.05 \-et-Btan2 z + SR

(3.20)

Saastamoinen Model

The correction term obtained with interpolation of the values in Tables 3.1 and 3.2.

The Saastamoinen model was obtained using the ideal gas laws and simplified

Table 3.1 Correction term B for the refined Saastamoinen model (HofmannWellenhofetal.,2001) Height (km)
0.0

assumptions regarding variations in pressure, temperature, and relative humidity with
height (Hofmann-Wellenhof et al., 2001). The hydrostatic zenith delay is given as:
0.002277 P,

B(mb) 1.156 1.079 1.006 0.938
0.874

ZHD =

(1 -0.0026cos 20-0.00000028//v)

(3.17)

0.5
1.0

and the wet zenith delay is given as:

1.5
2.0

ZWD = 0.0022771 -- + 0.5 es

(3.18) 2.5
3.0

0.813
0.757

where <p is the latitude of the station, Hs is the orthometric height of the station in km, Ts is the surface temperature in Kelvin, Ps is the total pressure in millibars and es is the
partial pressure due to water vapour in millibars. All the meteorological measurements

4.0
5.0

0.654
0.563

are measured at the station or alternatively a standard atmospheric model can be used. The partial pressure es can be obtained from the relative humidity as (Feng et al., 2001):
7.?*rv Ts+237.3

es = /?//*6.U*10v

(3.19)

where RH is the relative humidity and Ts as defined above.

30

31

Table 3.2 Correction term SR in meters for refined Saastamoinen model
(Hofmann-Wellenhof et al., 2001)
Zenith angle Station height above sea level (km) 0 0.003 0.006
0.012 0.020 0.031

Baby et al. Model

Baby et al. (1988) introduced the acceleration gravity as:

0.5
0.003

1.0 0.002

1.5
0.002 0.005 0.009

2.0 0.002 0.004 0.008 0.013 0.021 0.026 0.033 0.044

3.0

4.0

5.0 0.001
0.002 0.004 0.007

o m

(3.22)
1+-

60° 00' 66° 00'

0.002 0.003 0.006 0.011
0.017

0.001
0.003 0.005

0.006 0.011
0.018 0.028

0.005 0.010 0.017 0.025 0.032
0.041 0.054
0.062

where gs is the surface gravity at the station,

70° 00'
73° 00' 75° 00' 76° 00' 77° 00' 78° 00' 78° 30' 79° 00' 79° 30'
79° 45'

0.015 0.023
0.029

0.009
0.014 0.017

Rda\

(3.23)

0.011
0.014 0.018 0.024
a

0.039 0.050
0.065

0.035
0.045

0.021
0.027

(3.24)

0.037 0.049 0.056 0.065
0.077

0.022 0.030
0.034 0.040

andrv = ro+Hs, where r0 is the radius of the earth, the authors used r0 equal 6378000 m.

0.059
0.068 0.079

0.036
0.042

0.075
0.087 0.102

0.051
0.059

0.028 0.033 0.039 0.043
0.047

They combined Equations 3.16 and 3.22, and substitute ki as provided by Bean and
Dutton (Mendes, 1999) to obtain:

0.072 0.085 0.092 0.100

0.049
0.058

0.093
0.101

0.070
0.076

0.047
0.052

0.022277P, L
rvcr(// + l)

(3.25)

0.111
0.121

0.083 0.091

0.068
0.068

80° 00'

0.110

0.083

0.056

The wet zenith delay given by Baby et al. (1988) is:

ZWD = 10"3x[/

^

(3.26)

Davis et al. Model

where Us is the relative humidity, v and y are empirical coefficients related to seasonal and climate variations (Mendes, 1999). The coefficients were obtained by fitting a one-

Davis et al. model is an improved model of the Saastamoinen (Mendes, 1999) it is given
as:

year radiosonde data and listed in Table 3.3. Their dimensions are mm.(%)"1 and ° C1 for
ZHD =

0.0022468P

(1 - 0.0026 cos 2(/) - 0.00000028//v)

(3.21)

v and ^respectively.

32

33

Table 3.3 Coefficients of babv et al. model for *«* TM»itli delay (Mendes, 1999)
Latitude
Climate

Interval
Min - max

wet layer

earth's surface

Figure 3.2 Thickness of polytropic layers for the troposphere (adapted from
Hofmann-Wellenhof et al., 2001)

The Hopfield model presents the dry and wet refractivity components as a function of the

receiver height above
Witchayangkoon, 2000):

the earth's

surface

and

is

given

in the

following forms

Vo

H,

(3.27)

Hopfield Model

In 1969, Hopfield developed a tropospheric delay model using data covering the whole
Earth. The model applies a single layer polytropic atmosphere model extending from the Earth's surface to altitude of about 11 km for the wet layer and 40 km for the dry layer
where,

Hw-h

(3.28)

(see Figure 3.2) (Witchayangkoon, 2000; Hofmann et al., 2001). Hopfield model is built
on a relationship between dry refractivity at height h to that at the surface that was
derived empirically on the bases of extensive measurements (Leick, 2004)
Hd =40136 + 148.72(r-273.16)
// =11000

.empirically determined power of the height ratio,
apolytropic thickness for the dry layer (m),

apolytropic thickness for the wet layer (m),

34

35

NTwP =kJA_

* ^iteipospheric refracitity for the station at the
Earth's surface as a function of pressure in

tropospheric wet delay from integrated precipitated water (IPW), retrieved from the
weather model, as follows:

millibars and temperature in Kelvin, : wet tropospheric refractivity for t the station at

-2-+JL *IPW 71

(3.32)

,= (3.139 ±0.02)x\05xk2/Pa
Tm= 70.2 + 0.72 *7>f

(3.33)
(3.34)

the Earth's surface as a function of water vapour

pressure in millibars, pressure in millibars and
temperature in Kelvin,

K -> -- K 2

R,,

XK|

(3.35)

/t, =(n.6±0.05)k/hPa

(3.36)
(3.37)

The NOAA Model

The US National Oceanic and Atmospheric Administration (NOAA) tropospheric delay model has been developed by the NOAA Forecast Systems Lab (FSL) (Gutman et al. 2003). The model is based on numerical weather prediction (NWP) models, where

k2=(l0A±2.2)k/hPa

Rd =(287.06±0.0\)JKg-lK -1

(3.38)

Rv =(461.525 + 0.0031)7^-' K~[

(3.39)

surface- and space-based meteorological measurements and others, are combined into the
model (Ahn et al. 2006). The NOAA model estimates the zenith hydrostatic (dry)
tropospheric delay as follows:

where ZWD is the zenith wet tropospheric delay, IPW is integrated precipitated water,

Tsfc is the temperature, Rd is the dry air constant, and Rv is the wet air constant.

ZHD = ( 2.2768 ± 0.0024) x 10~3 x ---f

P.f,

(3.29)

The NOAA Tropospheric Delay software

The FSL of NOAA has also developed a software package that consists of a number of

/ (X, H) = (1 - 0.00266 cos 2X - 0.00028H)

(3-30>

modules. Those modules interact together to perform a number of steps to compute and
predict values of hydrostatic, wet and total zenith tropospheric delay.

Psfc =[A/f°'93-(l.313xl0-5)*//|

15.255

where ZHD is the zenith dry tropospheric delay, H is the orthometric height in Km, and

Alt is the altimeter setting in mbar. The NOAA model also estimates the zenith

The ZWD is computed by using meteorological data from a numerical weather prediction

(NWP) model and Equation (3.32). The ZWD values along with the altimeter setting
37

36

values are then placed in a 20 km grid that covers part of North America. Hourly grid files are generated and stored in an FTP server. The first two lines of each grid file
include the minimum longitude and latitude, respectively. Each of the subsequent lines
1
f

Input
*., <p, h, t

Output ZHD,
ZWD
i

7

contains the longitude, latitude, ZWD, and the altimeter setting.

FTP Wx Model Grid
fromFSL

Compute ZHD

at X, qi, t

|

The software contains the geoid code to compute the geoidal height. The input arguments

i

Compute N at 'k, C|j using

Compute H
at
--»

Compute ZWD & ALT at \vf

Interp
--»

ZWD & ALT to time =t

Compute Psfc
--*

of the software are latitude, longitude, ellipsoidal height, and an optional argument

GEOID 99

@<t-l)&(tH)

at*.,q»,t

representing the time. If the time argument is left blank, a default gives two results keeping the current time as the datum: an analysis of one hour before the datum and a
prediction of two hours after the datum.
where,

Figure 3.3 Flowchart of NOAA tropospheric delay software processing (adapted
from Gutman et al., 2003)

<ft = rough latitude NOAA software Flow
X = rough longitude

To generate an output from the software, the orthometric height is first estimated through
a code-generated geoid height. The software then retrieves the ZWD and the altimeter setting from a grid file based on the user's longitude and latitude. The software interpolates between the longitude and latitude for the desired ZWD and altimeter setting. The altimeter setting is then used to compute the total pressure by using Equation 3.30. The total pressure is then used in Equation 3.28 to compute the zenith hydrostatic delay

h = rough ellipsoidal height t = time of observation
N = approximate geoidal height H = approximate orthometric height

ZHD = zenith hydrostatic signal delay (m) ZWD = zenith wet signal delay (m)

(ZHD). Finally, the zenith total delay is obtained by summing the ZWD to the ZHD.
Figure 3.3 represents a flowchart of the NOAA software processing flow.

3.4

The IGS Tropospheric Product

Legacy IGS tropospheric product comes as a daily file, of the Zenith Total Delay (ZTD),

with a sampling rate of 1-2 hours, and is based on submitted solutions from all IGS
39

38

ana

lysis centers (AC) (Byun et al. 2005). In 2003, a new tropospheric delay product with

is used; where / is representing h (hydrostatic) or W (wet) and the coefficients a, b and c
are defined for the hydrostatic component as:

si

ignificant improvement in the accuracy of ZTD values was proposed by the IGS (Byun

et al., 2005). The new product is also generated as a daily file of five-minute intervals for each of the IGS reference stations; it is available at: (JPL, 2006) and (CDDIS, 2006). This new product is estimated as one of the adjustment parameters. This product is considered the most accurate ZTD because precise satellite orbits and clocks are used (Sung et al. 2005), and therefore is treated in this research as error free and a benchmark against which the ZTD obtained by using any of the empirical tropospheric delay models will be
compared.

ah = [l.232 + O.O139cos0-O.O2O9//v + 0.00215(7; -283)]xl0~3
bh = [3.1612-O.16OOcos0-O.O331//, +0.00206(7, -283)]xl0"3 cA=[71.244-4.293cos0-O.149//v -0.0021 (7V-283)]xlO"3
and for the wet component as:

, ,
-

.

,  ,::
!

aw =[0.583-0.011 cos0-0.052//, + 0.0014(7; -283)]xlO-3 bw =[l.4O2-O.lO2cos0-O.lOl//,+0.0020(7;. -283)]xlO-3 cw= [45.85-1.91 cos0-1.29//, +0.015(7,-283)]xl0"3

3.5

Mapping Functions

Niell Mapping Function (NMF)

Tropospheric delay mapping functions relate the tropospheric zenith delay to the slant

Niell (1996) developed a mapping function given as:
a.

delay. The exact mapping function is complicated by the temporal and spatial variability
1+

of the troposphere (Leick 2004). A number of mapping functions have been developed,
mf{e)=

1+

b,
1+c.
a,

1+
,-3

 + H. xlO

1

1+

K
1+c,,,
aht

including Marini, Niell, Vienna and others.
Marini Mapping Function

sine
sine +

sine

(3.41)
'"

sine

i

ci n

z?

.4-

sine +c.

sine +ch

Marini (1972) presented a continued fraction of the mapping function. The function then specified by Herring (1992) with three constants and normalized to unity at the zenith.
For the dry and wet components, the mapping function (Hofmann-Wellenhof et al., 2001)
1+mf(e) =
sin e + -

where e is elevation angle, Hs is the station height and at, bt , and c; are hydrostatic or

wet MF coefficients. The hydrostatic MF coefficients are functions of the station latitude and day of the year. The typical formula for the three coefficients is given as:

(^_doy-2%\
365.25
a:

(3.42)

(3.40)
b:

sin e + -

sin e + C;

40

41

Where a

havg

and a,

1a>np

are determined at the five latitudes corresponding to the U.S.

Isobaric Mapping Function (IMF)

In the recent years, efforts have been concentrated into developing mapping functions
which are based on Numerical Weather Models (NWM). Niell (2001) proposed the

Standard atmosphere Supplements, day is the day of the year and g is the station
latitude. The second term of the right hand side of Equation 3.42 is the height correction
to be applied to the hydrostatic MF only. Table 3.4 contains the NMF coefficients, where aw, bw and cw are the wet MF coefficients; they are function of the station latitude only. For latitudes below or equal 15°, the coefficients are constant. The coefficient for

Isobaric Mapping Function (IMF), which has shown significant improvements compared
to NMF, especially for the dominant hydrostatic MF and in height (Vey et al. 2006). IMF
is given as:

latitudes not tabulated in Table 3.4 can be obtained by linear interpolation.
Table 3.4 Niell Maj jping Function coefficients (Leick, 2004)
^atitude Coefficients

1+ 1+
sine +
sine

a

1+c
a

(3.43)

sine +c

15°
1.2769934

30°
1.2683230

45°
1.2465397

60°
1.2196049

75°
1.2045996

aKi xlO3
bh ch xlO3 xlO3

The IMF uses input parameters based on raytracing through radiosonde data (Boehm,

2.9153695

2.9152299

2.9288445

2.9022565

2.9024912

2003). Niell (2001) established empirical approximation in terms of a NWM global grid
of 200hPa isobaric heights, for the hydrostatic MF coefficients, and linear

62.610505

62.837393

63.721774

63.824265

64.258455

approximations, based on a global grid ratios of NWM slant wet delays at 3.3° elevation
and its zenith delay (Kouba, 2007).

ahmt xlO3
bh xlO3 xlO3

0

1.2709626

2.6523662

3.4000452

4.1202191

0

2.1414979

3.0160779

7.2562722

11.723375

"amp

Vienna Mapping Function (VMF)
0
9.0128400 4.3497037 84.795348

ch

170.37206

The Vienna Mapping function (VMF) was introduced by Boehm and Schuh (2004). The
hydrostatic and wet VMFs are given, respectively, as:

«H,xl03

5.8021897

5.6794847

5.8118019

5.9727542

6.1641693

K xio3

1.4275268

1.5138625

1.4572752

1.5007428

1.7599082

^xlO3

4.3472961
--------^----

4.6729510
--^--·----

4.3908931

4.4626982

5.4736038

42

43

1+-%
mt

VMF1 Grid:

The VMF1 coefficients "a" are given on a global grid of 2.5x2.0 degrees, with 2.0
(3.44)

degrees sampling from north to south and 2.5 degrees from east to west. For each

sin e +

sin e + ch

coefficient ah (hydrostatic coefficient) and aw (wet coefficient) there are four files per day
at time 0, 6, 12, 18 UT. The first two digits of the file name indicate whether it is for ah

1+-

or aw. The next five digits indicate the year and the day of the year. The file extension
1 + c..
a.

»/*(') = ·

(3.45)

shows the hour of the day. The first line in each file shows the values in degrees for north, south, west, east, spacing north-south, and spacing west-east. The remaining of the file includes parameters in latitude bands running from north to south, and from west to east within each band. The hydrostatic coefficients ah refer to zero height; therefore, correction for the gridded and station heights is needed. In addition to the ah and aw coefficients, the hydrostatic and wet zenith delays are also provided on the grid in meters, and their files are starting with zh and zw for hydrostatic and wet zenith delays
respectively.

sin e +

sin e + cw

where mfh and mfw are the hydrostatic and wet mapping functions, e is the satellite
elevation angle, ah, bh, ch, and aw, bw, cw are coefficients for the hydrostatic and wet mapping functions, respectively. The more significant coefficients ah and aw are fitted to
raytracing with the NWM of the European Center for Medium-Range weather forecast (ECMWF) in 6 hours intervals. The remaining coefficients (i.e., bh, bw, ch, and cw) are

obtained through empirical representations (Kouba 2007). An updated version of the

VMF, with improved empirical representation of the coefficients bh, bw, Ch, and cw, is
known as VMF1. The hydrostatic and wet coefficients b and c are given, respectively, as:
To use VMF1 an input file, which contains the VMF1 coefficients, is needed. The VMF1

coefficients files are provided for IGS, (GPS), IVS (VLBI), and IDS (DORIS) stations. For IGS stations the files are available at (ECMWF1, 2008). Each file contains a time series of records, containing the following information: station name, modified Julian
date, hydrostatic coefficient "ah", wet coefficient "aw", hydrostatic zenith delay in meter, wet zenith delay in meter, mean temperature in Kelvin (to covert the wet zenith delay into Integrated Precipitated Water (IPW)), pressure at the station in hPa, temperature at the

bh = 0.002905

ch = 0.0634+0.0014 cos 2<p
where (p is the latitude.

bw = 0.00146

cw = 0.04391

44

45

mmmmmmrmmwf

PROPHWVfF

station in degree Celsius, water vapour pressure at the station in hPa, and the approximate
orthometric height.

9

n

(3.47)
n=0 m=0

Then, the global grid of the mean values, a0 and of the amplitudes, A for the hydrostatic

Global mapping Function (GMF)

GMF, a spherical harmonic fit to the VMF1, is a less precise mapping function, which can be used as a backup for VMF1 (Kouba 2007). Similar to NMF, GMF is an empirical mapping function that can be estimated from station latitude, longitude, height and day of
the year.

and wet coefficients of the continued fraction form were expanded into spatial spherical harmonic coefficients up to degree and order of 9 according to Equation 3.47 in the least
square sense. The hydrostatic and wet coefficient a can be determined for any site by
using Equation 3.46.

The GMF is determined by using 15 x 15 global grids of mean profiles for pressure,

3.6

Tropospheric Delay Models in GPSpace

temperature, and humidity for each month from the European Centre for Medium-Range

In GPSpace, there are two options to deal with the tropospheric delay. In the first option,
the hydrostatic component is substituted using empirical tropospheric delay model, where

weather Forecast (ECMWF) from 40 years of reanalyzed data. From September 1999 till
August 2002, the coefficients ah and aw were determined by applying the same strategy
for VMF1. Using the empirical equations of b and c from VMF1, the parameters a, were

the ZWD is considered as one of the least-squares solution parameters that are estimated
epoch by epoch. In the second option the ZHD and ZWD are evaluated using empirical
tropospheric delay models and mapped to the slant direction using their corresponding mapping functions. In the first option, a-priori value of the zenith wet delay is needed,

derived by a single raytrace at 3.3° initial elevation angle. Therefore, for the 312 grid
points, 36 monthly values ah and aw were obtained. The hydrostatic coefficients at the mean sea level were obtained by using the height correction given by Niell (1996). The mean value, a0 and the annual amplitudes, A of the sinusoidal function in Equation (2.38) were fitted to the times series of the, a parameters at each grid point, with phases referred
to January 28, corresponding to NMF.
(3.46)

and obtained using an empirical tropospheric delay model. Hopfield model is the default
tropospheric model and Chao model is given as another option. In the second option, when tropospheric zenith path delay is not a one of the least-squares parameter, the

Hopfield model is used to evaluate the ZPD at each epoch. When the VMF1 is used as mapping function: instead of obtaining ZHD and ZWD using the empirical models, the values are provided within the VMF1 input file, which are based on numerical weather

365
where:

)

prediction model.

46

47

3.7

Implementation of NOAA Tropospheric Delay Corrections into GPSpace

The current version of the GPSpace® software does not include the NOAA model. Therefore, part of this research deals with the implementation of the NOAA model corrections into the GPSpace. This is done through the modification of the VMFl input file by replacing the ZHD and ZWD values in the VMFl input file by the NOAA model values. The VMFl input file was further modified to contain 24 epochs per day instead of
4 epochs.

4

STOCHASTIC CHARACTARICTICS OF RESIDUAL
TROPOSPHERIC DELAY

As mentioned in Chapter one, a complete modelling of the tropospheric delay must
account for the residual tropospheric delay, which results from the deficiencies in the
current empirical tropospheric delay models. A complete model includes functional and
stochastic parts.

This chapter includes in sections one through six the methodology we followed to
stochastically model the Hopfield-, Saastamoinen-, and NOAA-based residual

tropospheric delays. In the first section of this chapter we will highlight the theory of

random processes and time series autocovariance. We will show the methodology used to calculate the residual tropospheric delay and its estimated autocovariance function
(ACF). Finally we will present how the estimated ACF is used to fit empirical
autocovariance models.

Section seven provides different results of stochastic modelling steps. Results include

residuals tropospheric delay generation, autocovariance functions generation and
empirical autocovariance functions fittings. Stochastic modelling results include results

of modelling Saastamoinen- and Hopfield-based residuals tropospheric delay for five
stations over Canada and United States as well as results of NOAA-based regional

48

49

stochastic models for North America. Results of the regional stochastic models are based on data from ten IGS station spanned over North America.

The autocovariance time (i.e.,

the

1/e point) equals

I/Pi for first-order GM and

2.1461945/(32 for second-order GM. Table 4.1 shows the correlation times for GM
processes with different orders.

4.1

Random Processes

Table 4.1 The ACF and correlation time for different order GM processes (Gelb, 1974)
Order ofGM
process

A random process is a stochastic model which describes the probability structure of a time series (Box and Jenkins 1976). Classes of stochastic models for stationary processes

ACF

Correlation time

include the following processes: Gauss-Markov, Periodic Random, and Random Walk,
which are explained in the sub sections below

1
X

1

4.1.1

Gauss-Markov (GM) Process

2

(Tyf'^(i+j32

T

)

2.14619450

Gauss-Markov (GM) random process is a stationary process that has an exponential

A
r

autocovariance function. GM process is useful in various engineering applications since it
describes and provides a good approximation for many physical random processes. The

3

<

)
T

2.90462999

4

general formula of the autocovariance function of p-order GM is given in Gelb (1974) as:
o -n -I

+5

'r' +15
2 2 ,,,

1

3.51264850

A
4.03422535

R

to{2p-2)\n\{p-n-\)\

(3.48)

5

I
·

T

A

The autocovariance function of a zero mean first-order GM process is defined by a
decaying exponential of the form: (3.49)
P

·

·

and the second-order GM autocovariance function is given by:
(3.50)

^
.V:F,;;;

2 _M&

h(2p-2)\n\(p-n-iy.

(p-\)\(2Pp

T

)""""'

Solved when

where ax is the standard deviation, fti is the reciprocal of the correlation time and x is the
time lag.

50

51

4.1.2

Periodic Random (PR) Process

days over 2006, included: new IGS tropospheric product, metrological data (met RINEX files), and the NOAA tropospheric model grid files. The new IGS tropospheric product
was used as the reference to generate residual tropospheric delays. The met RINEX files

It is a random process that has an autocovariance function with periodic behaviour. A Periodic Random (PR) process can be represented by an exponential and periodic
function as:

were used as input to the Hopfield and the Saastamoinen models to compute tropospheric

f^
where /? and a are positive quantities that have the same dimension (l/time).

(3.51)

ZTD. The NOAA grid files were used to generate the NOAA tropospheric delays using

the NOAA model software. More data from another five stations, including AMC2,
FLIN, HLFX, HOLB, and NLIB (see Figure 4.1), was collected to emphasize the
NOAA-base residual tropospheric delays.

4.1.3

Random Walk Process

A random walk process is a process where the current value of a variable is composed of its previous value plus an error term defined as white noise. The discrete expression of
the random walk process is given in Tralli and Lichten (1990) as:

x{t + T) = m*x(t) + 4r*wrw

(3.52)

where m is the correlation time, x is the lag, and w is a zero mean white noise. The random walk process noise rate can be given as:

<?·,,., =,

(3.53)

4.2

Residual Tropospheric Delay Time Series
section we present the methodology followed in forming the Hopfield-,

In this

Saastamoinen-, and NOAA-based residual tropospheric delay time series.

Figure 4.1 IGS station distribution in North America (IGS, 2008)

4.2.1

Data and Data Sources

Using the Hopfield and the Saastamoinen models, a five-minute interval daily time series of ZTD were generated for the first stations except MD01, which its time series interval was 15 minute. For all the ten stations a daily time series of five-minute interval of new
53

At the beginning of this research we used data from five reference IGS stations; namely,

ALGO, JPLM, MDO1, PRDS, and USNO (see Figure 4.1). This data, which is for many

52

IGS ZTD were also generated. The precise station coordinates in the NAD83 datum were
used as input for the NOAA software to estimate the NOAA-based total zenith
tropospheric delays at each of the above mentioned stations. The output of the NOAA software included records of estimated and predicted dry, wet, and total zenith

a = '{t-to)(t-t
i -to){ti -f

-tn)

(3.55)

Since the coefficient a,- is a function of t, it can be referred to as Lt(t) which is called Lagrange operator. Now, substituting tby to, t\, ti, .... tn in Equation 4.8 we get:

tropospheric delays; recorded every one hour. From these records, daily time series at one
hour interval of ZTD were retrieved.

[1
0

fort=tA
otherwise

(3.56)

4.2.2

Interpolation of ZTD Data

Substituting again t by to, t\, ti, .... tn in Equation 4.7 we get:

To generate ZTD residuals at five-minute intervals the Lagrange interpolation method
was used to interpolate the Hopfield and Saastamoinen ZTD for station MDO1 as well as
the NOAA ZTD for all the stations. We selected Lagrange interpolation method after

h) =fo, p(tj) =fi, p(t2) =f2,..., p(tn) =fn

(3.57)
;=o

testing a few other methods (including Linear, Spline... etc). To test the accuracy of the interpolation, a daily time series of one hour interval was

extracted from the IGS ZTD time series. The extracted time series was then interpolated
Lagrange Interpolation Method:

to a five-minute interval by using the Lagrange method.

The residual between the

Lagrange Interpolation method is based on an algebraic expression to fit a particular data
interpolated time series and the original IGS ZTD time series was then evaluated, and set to a certain polynomial, whose degree equals the number of data points, in such a way used to measure the interpolation accuracy. Figure 4.2shows interpolation error for day

that it returns the exact value of the function at each data point.

15 of 2006 for station MDO1.

Assume fo, fi, f2, · ·,/; be the values of a given data at times to, tj, t2, ..., tn, respectively.
The approximated value of/, denoted by p{i), at any time t is given by (Spiegel, 1999):

/,
;=o

(3.54)

where:

54

55

from the corresponding values of the Saastamoinen, Hopfield and NOAA tropospheric correction models (see Equations 3.58, 3.56, and 3.57).
^TDN0AA=ZTDN0AA-ZTDlGS

(3.58)
(3.59) (3.60)

*ZTDSAAS=ZTDSMS-ZTD1GS
AZTDH0P=ZTDH0P-ZTDIGS

where AztdN0AA, AztdSAAS and AztdH0P are the NOAA- , Saastamoinen- and Hopfieldbased residual total tropospheric delays, respectively. ztdN0AA, ztdSAAS, and ztdH0P are the delays from the NOAA, Saastamoinen and Hopfield models

tropospheric ztdlcs

respectively.
250

is the new IGS total tropospheric delay. Figure 4.3 shows an

500

750

1000

1250

1445

Time (minute)

example of residual tropospheric delays for each of the above models for day 147 of 2006
for MDOl station.

Figure 4.2 Lagrange interpolation error for day 15 of 2006 at station MDOl

30

The disadvantage of Lagrange interpolation method is that its accuracy degrades at the
beginning and the end of the data (as seen in Figure 4.2); to overcome this limitation we added more data points at the beginning and the end in order to avoid having large
interpolation error.

20

r

J o
a

I

\
rfepd
w
1

4.2.3

Residuals Zenith Total Tropospheric Delay

-20

-- NOAA * "
500 750 1000

To develop the stochastic models, residual zenith tropospheric delay data series were
-30

1 1 1

Hopfield Saastamoinen
1250 1430

250

generated for the Saastamoinen, Hopfield and NOAA tropospheric correction models. To compute the residuals, values of the new IGS tropospheric delay product were subtracted

Time (minute)

Figure 4.3 NOAA-, Hopfield -, and Saastamoinen-based residual ZTD before
removing the linear trend

56

57

4.3

Linear Trend Removal

Saastamoinen and Hopfield models followed a similar trend with almost the same offset.

Figure 4.5 shows residuals comparison of the three models on a typical day. For more

As seen in, Figure 4.3 some residual data series exhibit linear trends. To avoid distortion
plots see Appendix I.

in the estimated autocovariance functions, linear trends from all daily residual data series were removed using MATLAB. Figure 4.4 shows the residual tropospheric delays data
series for day 147 of 2006 for MDO1 station without the linear trend.
35

NOAA - Saastamoinen - Hopfield

30

15



-- NOAA -- Hopfield
-- Saastamoinen

10

r

1
a 5

A

12

"53

I
Q

o-

p

\

I

\

>

I

N

\

I
d
o

-5

| .10
-15

I

V
Y

200

400

600

800

1000

1200

1430

Time (min)

V
1430

Figure 4.5 NOAA-, Saastamoinen-, and Hopfield-based residual ZTD at station ALGO on day 15 of 2006

-20

250

500

750

1000

1250

4.5

Autocovariance Estimation

Time (minute)

As indicated earlier, daily time series of residual tropospheric delays obtained by

Figure 4.4 NOAA-, Hopfield -, and Saastamoinen-based residual ZTD after
removing the linear trend

comparing

the

new

IGS

tropospheric

product

with

the

NOAA,

Hopfield

and

Saastamoinen ZTD. These residual time series were used to generate estimates of

4.4

Assessment of Tropospheric Delay Models

autocovariance function (ACF) for different days over 2006 and different geographical
locations using the unbiased autocovariance function, which can be defined as:

Before stochastically model the Hopfield-, Saastamoinen-, and NOAA-based residual
ZTD, we used them to assess their tropospheric delay models. The assessment criteria is the based on the size of the residual. The assessment's result revealed that the NOAA residual was the least, compared to the Saastamoinen and Hopfield. The results for the
58

x{t)x{t+T)
IV -- T t=0

(3.61)

59

where, t is the time, x is the time lag and N is the series total number of points.

4.6

Empirical Autocovariance Models

To have an empirical representation of the autocovariance function of residual total tropospheric delay time series, three functions were tested as potential empirical autocovariance functions for the stochastic model. The first two models are the first- and second-order Gauss-Markov which are given in Table 4.1. The third model is the
Random Periodic or the Exponential cosine which given by Equation 4.4. The best model
was selected as the one with the least root-mean-square (RMS) in the least-square sense.
200

""*" Hopfield -"·" Saastamoinen
400 600 800 1000 1200 1430

Time (minute)

4.7

Stochastic Modelling Results

Figure 4.6 Hopfield- and Saastamoinen-based residual ZTD before linear trend
removed at station USNO on day 279 of 2006

4.7.1

Results for Saastamoinen- and Hopfield-Based Residuals

15

opfield

The daily Saastamoinen- and Hopfield-based residual tropospheric delay data series described in sections 4.2.3 and 4.3 (e.g. see Figure 4.6 and Figure 4.7) were used to
develop the empirical autocovariance function. The estimated autocovariance functions
for the residuals were computed using Equation 3.59. To avoid distortion at large lags,
S s
10

ij±-S.lastamoinen

2

g
-

ft

H N

ft
1 J J

only the first 10% of the data record of the estimated autocovariance were considered in
developing the empirical covariance function.
13
O

-i

w
^p 1
1

TM

1 1

-15

1

200

400

600

800

1000

1200

1430

Time (minute)

Figure 4.7 Hopfield- and Saastamoinen-based residual ZTD after linear trend removed at station USNO on day 279 of 2006

60

61

For five IGS reference stations from Canada and the USA, three models were developed to stochastically account for the Saastamoinen and Hopfield-based residual tropospheric delays. The exponential cosine model was found to be the best fitting model for all the
stations, having the least root-mean-square (RMS) value in the least-square sense.

time was also almost similar for the Saastamoinen- and Hopfield- based stochastic

models coefficients. For the five stations used in this research for Hopfield- and
Saastamoinen-based residuals, the correlation time was found to be ranging from about hour and a half to two hours. Table 4.2 presents the correlation times of Saastamoinen-

Comparing the stochastic models coefficients for Saastamoinen- and Hopfield-based
residuals tropospheric delay showed that the stochastic models coefficients were very

and Hopfield-based residual tropospheric delay models for stations ALGO, JPLM,
MDOl,PRDS,andUSNO.

similar (see Figure 4.8 and Appendix VII for more plots). As such, any one model can be
used to account for the Saastamoinen- or Hopfield-based tropospheric delay residuals.
Table 4.2 Correlation time based on first-order Gauss Markov for Saastamoinenand Hopfield-based residuals (minutes)

Correlation Time (min)
Station
INOAA

0.025

Saastamoinen
125 119
94

Hopfield
127

I

iHopfield
ISaastamoienn

ALGO
JPLM MDO1 PRDS USNO

0.02

117 95
94 139

a

41

£ 0.015

93 138

0.005

The mean and the standard deviation of each of the estimated coefficients of the three empirical autocovariance models are given in Tables 4.3 and 4.4 for the SaastamoinenlstG.-M. Coeff. 2nd C- M. Coeff. Exp. Cos. I st Coeff. Exp. Cos. 2st Coeff.

Model Coefficient

and Hopfield-based residuals.

Examining the standard

deviations

of the different

Figure 4.8 Mean of model coefficients at station ALGO

coefficients we notice that the first coefficient of the Exponential Cosine has the least standard deviation for all five stations.

Using the first-order Gauss Markov model, we were able to compute the correlation times for the Saastamoinen- and Hopfield-based ZTD residuals. As expected, the correlation

62

63

r
Table 4.3 Coefficients mean and standard deviation of empirical ACF for
Saastamoinen-based residuals
Empirical ACF Model Station First-order Gauss-Markov Second-order Gauss-Markov Coefficient Mean 0.01928 0.01989 0.02434 0.02407
0.01794

of the NOAA-based residual daily time series for eight stations on day 20 of 2006. More daily plots for the other seasons of the year are available in Appendix II.

Exponential

Exponential

Cosine 1st
Coefficient Mean 0.00451 0.00491 STD 0.0043
0.0033

Cosine 2nd

Coefficient
Mean 0.00799
0.00837

Coefficient Mean 0.003431 0.005029 0.005408 0.006586
0.003114

STD 0.0055 0.0052
0.0124

STD 0.0103
0.0093

STD 0.0074 0.0065

ALGO
JPLM




ALGO
AMC2 FLIN

MD01
PRDS USNO

0.01064
0.01071

0.0239
0.0107
0.0078

0.00671
0.00639 0.00407

0.0088
0.0034

0.0109
0.0067
0.0072

0.0060
0.0043

  

HLFX HOLB JPLM

0.00726

0.0028



Table 4.4 Coefficients mean and standard deviation of empirical ACF models for
Hopfield-based residuals
Empirical First-order Gauss-Markov Mean
0.00787 Second-order Gauss-Markov

MDO1
NLIB

 

PRDS USNO

Exponential

Exponential

ACF
Model Station

Cosine 1st
Coefficient
Mean
0.00442 0.00499 STD

Cosine 2nd

Coefficient
Mean 0.003374
0.005372

STD 0.0053 0.0051 0.0125 0.0062
0.0043

Mean 0.01905 0.02027
0.02413

STD
0.0099 0.0092 0.0241

STD
0.0074

50

100

150

200

250

300

350

Day of Year
0.0039
0.0034 0.0088

ALGO
JPLM

Figure 4.9 Distribution of days processed for NOAA-based ZTD residuals at 10
0.00857
0.01051
0.0064

stations over 2006

MDO1 PRDS USNO

0.00661

0.005404 0.006588
0.002978

0.0108
0.0067

0.01061
0.00717

0.02388 0.01776

0.0109 0.0079

0.00627
0.00401

0.0033 0.0028

0.1029

4.7.2

Results for NOAA-Based Residuals

A total of 1350 daily data series at five-minute intervals of NOAA-based ZTD residuals for the ten stations were generated. The residual data series were spanned over many days representing the various seasons of 2006 (see Figure 4.9). Figure 4.10shows an example
65

64

ALGO
40

 AMC2

FLIN

HLFX

HOLB

JPLM

MDO1

NLIB

-40;

200

400

600

800

1000

1200

1425

:o5

FEB06

APR 06

JUN06

AUG06

OCT06

DEC 06

Time (min)

Time (month)

Figure 4.10 NOAA-based residual ZTD at 8 stations on day 20 of 2006

Figure 4.11 NOAA-based ZTD residual at station USNO over 2006

2600

Figure 4.11 shows the variations of the NOAA-based ZTD residuals at station USNO over 2006. Except for a few spikes, the NOAA-based residual can be considered to have

2550

no significant variations over the whole year. This indicates that the NOAA model accounts for the seasonal variations quite well; which was confirmed again by Figures
4.12 and 4.13 that show the trend of the new IGS ZTD and the NOAA ZTD, respectively. For more examples of plots of NOAA-based residual over 2006 see Appendix IV.

Investigation of the spikes in the NOAA-based ZTD residuals data series showed that they exist as a result of odd records of the ZTD in the NOAA model output. Figure 4.14
shows an example of such odd records.
Figure 4.12 IGS new ZTD product at station ALGO over 2007

22D°gC06

FEB07

APR 07

JUN07

AUG07

OCT07

DEC 07

Time (month)

66

67

2600

--

!
1

!
1

!
1

i

The Estimated ACF of NOAA-Based Residual Tropospheric Delay
The estimated autocovariance functions for the residuals were obtained using Equation

<

2550

]

r

] :

;

2500

1

.
j || 1 11

i
+ -- -- --

(3.17). Figure 4.15 shows the estimate autocovariance function for nine stations for day
20 of 2006. Appendix III includes more estimated autocovariance functions plots. As

2450

2400

23001

mmI kill
FEB07 APR 07 JUN07 AUG07
OCT07 DEC 07

mentioned

earlier:

to

avoid

distortion were

at

large

lags, in

only

the

first

10% the

of the

autocovariance

function

values

considered

developing

empirical

autocovariance function.

2250

Time (month)

ALGO

AMC2

FLIN

HLFX

HOLB

JPLM

MDO1

NLIB

PRDS

Figure 4.13 NOAA ZTD at station ALGO over 2007

...

NewIGSZTD ---- NOAA ZTD

f

\J
if


-

600
l_.

800

KM)

1200

1425

Lag (min)

·

Figure 4.15 Autocovariance function of NOAA-based residual ZTD at 8 stations on
day 20 of 2006
600 800

Time (mini

The estimated autocovariances were used to develop the empirical autocovariance

Figure 4.14 Spike in NOAA ZTD at station USNO on day 75 of 2006

function models through the least-squares (LS) estimation technique. The same three empirical models that were considered earlier for the Saastamoinen and Hopfield 69

68

residuals are utilized again: the first-order Gauss-Markov, the second-order GaussMarkov and the exponential cosine models. Inspection of the RMS of LS model fits show

-*-- 1st Gauss - Markov -*-- Exponential Cosine
0.4500 0.4000

----2nd Gauss - Markov

that the exponential cosine model provided the best fit most of the time for all the
stations. Figure 4.16 shows an example of the three models least squares fit for day 280

0.3500 0.3000 0.2500

A

of year 2006 for the NLIB station. For more fitting plots see Appendix V. Figure 4.16 shows fitting RMS at station JPLM over 2006, Appendix VI contains similar plots for
some other stations.
tza

0.2000 0.1500 0.1000 0.0500

M
20

1 *

J
40 60

1 n

i

*

Estimated ACF

0.0000 -0.0500

First-order Gauss Markov Fit Second-order Gauss Markov Fit Exponential cosine Fit

80

100

Day number

Figure 4.16 Fitting RMS of NOAA-based residual at station JPLM over 2006

To examine the correlation time of the residual tropospheric delay we used the first-order
Gauss-Markov. Table 4.5 shows the average correlation time over the whole year for each station. By examining the correlation time of the stations, we were able to group the stations used in this research into three groups: eastern, middle and western. The eastern
20
40

60

80

100

120

140

Lag (minute)

group includes HLFX, ALGO and FLIN; the middle group includes AMC2, NLIB, PRDS and USNO: and the western group includes HOLB, JPLM and MDO1. The

Figure 4.16 Fitting of ACF of NOAA-based residual at station NLIB on day 280 of
2006

correlation time for the three groups was in the range of 100 minutes, 75 minutes and 110 minutes for the eastern, middle, and western groups, respectively. Results of the

correlation time indicated that the proposed stochastic model, first order Gauss-Markov,

70

71

was geographically dependent. Tables 4.6 shows the empirical ACF models coefficients
means and standard deviations, computed for all the stations.

Figure 4.17 shows example of models' coefficients fluctuations throughout the year 2006. The exponential cosine model first coefficient, which carries most of the model
weight, has less variation compared to the second coefficient. The first-order Gauss-

Table 4.5 Correlation time based on first-order Gauss Markov model for NOAAbased residuals (minutes)
Station

Markov coefficient has more variations compared to the exponential cosine model's first coefficient, while the second-order Gauss Markov model coefficient has the highest variations. Appendix VII contains more plots of models' coefficients fluctuations at different stations.

Correlation Time (min)
97

Station JPLM

Correlation Time (min)
111 108 85 63
73

A1GO AMC2 FLIN
HLFX
HOLE

66 119
90 128

MDO1
NLIB

PRDS USNO

First-order Gauss-Markov Coefficient · Second-order Gauss-Markov Coefficient · Exponential Cosine First Coefficient Exponential Cosine Second Coefficient
0.08 0.07 0.06

Table 4.6 Coefficients mean and standard deviation of empirical ACF models for
NOAA-based residuals
Empirical
ACF First-Order Second-Order
Gauss-Markov Mean
0.02353 0.03190 0.02470 0.01900

Exponential Cosine 1
st

Exponential

0.05

Cosine 2nt

i

"S
g

0.04
0.03
0.02
0.01

Model
Station

Gauss- Markov
Mean
0.01036 0.01510 0.01110 0.00780 0.00840 0.00897 0.00924 0.01170 0.01584 0.01378

Coefficient
Mean
0.00439

Coefficient
Mean
0.009328 0.011600 0.008300 0.006700 0.006000

STD
0.0054 0.0068 0.0070 0.0042 0.0058 0.0051 0.0057

STD
0.0095 0.0117 0.0121 0.0074 0.0101 0.0091 0.0101 0.0102

STD
0.0027 0.0036 0.0034 0.0021 0.0028 0.0024 0.0031
0.0032

STD
0.0052 0.0058 0.0077 0.0067 0.0076 0.0067 0.0069 0.0060 0.0058 0.0055

U

ALGO
AMC2

0.00700
0.00440 0.00280 0.00350 0.00362

0.00 -0.01 -0.02

FLIN
HLFX HOLE JPLM

0.01990 0.02099
0.02153 0.02580 0.03294 0.02943

Day Number

0.007373
0.007428
0.010000

MDO1
NLIB

0.00391
0.00450

Figure 4.17 Fluctuations of coefficients of NOAA-based stochastic models at station
FLIN over 2006

0.0059
0.0070 0.0067

PRDS USNO

0.0119
0.0114

0.00647
0.00585

0.0030 0.0030

0.012625 0.011420

Figure 4.18, shows the mean of the NOAA-based residual stochastic models at different stations. For similar plots for the Hopfield- and Saastamoinen-based residuals refer to Appendix VIII.

72

73

rate is seasonal dependent. It starts at about 2 mm/Vhour at the beginning of the year to
0.035

0.03

I

1st Gauss - Markov Coeff
2nd Gauss - Markov Coeff.

reach a maximum of about 5 mm/Vhour around the middle of the year and then reverts to 2 mm/Vhour at the end of the year.

Exponential Cosine 1st Coeff. Exponential Cosine 2nd Coeff.

0.025

6 -

1*1

h
2
83

o

as

4 -

'3
Z

S 3
ALGO JPLM MDO1 PRDS USNO

+

.

-fc.

Station

1 2 S3
as

©

+ *% ++
* +

Figure 4.18 Mean of stochastic models' coefficients of the NOAA-based residual
ZTD at different stations
100 200
300

Day of the year

4.7.3

Random Walk Modelling

Figure 4.20 Daily mean of RW noise rate at station ALGO over 2006

For simplicity, we also considered the random walk process, a special case of the firstWe modified the GPSpace PPP software to estimate the total zenith residual tropospheric order Gauss-Markov process with infinite correlation time, to stochastically account for delay instead of the wet zenith tropospheric delay so as to use the NOAA-based residual

the NOAA-based residual tropospheric delays. Since it is easier to implement than any of random walk model The NOAA hydrostatic and wet zenith delays were used along with the other empirical covariance models, the random walk process was used to account for
the corresponding VMF1 values to correct for the tropospheric delay, while the residual the zenith total residual tropospheric delay within the GPSpace PPP software. We zenith tropospheric delay was estimated along with other unknown parameters using the obtained the random walk process noise rate for each of the ten reference stations in this
method of least squares.

study by using Equation 3.9. Figure 4.20 shows the daily mean random walk process noise rate at station ALGO over 2006. For the other 9 stations, daily mean random walk rate see Appendix VIII. From the plots we can conclude that the daily mean random walk

74

75

5

RESULTS AND ANALYSIS

VMF1 was used while in the second case the NMF was selected. Figure 5.1, 5.2 and 5.3
show the improvement in station's coordinates' accuracy when the VMF1 was compared

In the first section of this chapter, results comparing the effects of NMF and VMF1 on

to NMF. From the figures, we can see that using VMF1 improved the three components of the station's position by an average of 1 mm.

positioning accuracy will be presented, which were obtained by using the GPSpace PPP
software. The purpose of this section was to show the effect of using a mapping function
based on numerical weather prediction model.

Section two, contains results of positioning using GPSpace PPP software. These results
were compiled to show comparisons of positioning accuracy and solution convergence
time by using empirical tropospheric model based on site meteorological measurements

(Hopfield model) and empirical tropospheric model based on numerical weather
prediction model (NOAA model).

0.4

0.6

0.8

1.0

In section three, we present results of using the RW stochastic model of the NOAA-based residual tropospheric delays along with NOAA tropospheric corrections. Each of the figures in this section contains two plots for two GPSpace positioning solutions. The first solution when tropospheric delay parameter is the ZTD, and the second when the
tropospheric delay parameter is the residual ZTD with its RW stochastic model.

Time (day)

Figure 5.1 Improvement in X-coordinates when using VMF1 vs. NMF

5.1

VMFlvs.NMF

To show the advantage of using NWM-based mapping function, the GPSpace PPP software was used to estimate station's coordinates for two cases. In the first case the

76

77

5.2

NOAA-VMFl vs. Hopfield-NMF

To estimate stations' coordinates using the Hop field model as tropospheric delay model and NMF as the mapping function by using the GPSpace PPP software, 30 daily
observation files were processed. We then compared those coordinates with the

corresponding sets obtained by using the NOAA tropospheric model and the VMFl. Since the NOAA model is not supported by the GPSpace, we introduced its tropospheric
delay corrections to GPSpace through the VMFl input file. We modified the VMFl input

file
0.4 0.6 0.8
1.0

to

accommodate the hourly NOAA tropospheric

correction.

To

do

this,

we

interpolated the VMFl parameters from a six-hour interval to one-hour interval using Lagrange interpolation method. Figures 5.4 through 5.9 show the coordinate differences

Time (day)

Figure 5.2 Improvement in Y-coordinate estimates when using VMFl vs. NMF

between the GPSpace solutions and the published sets for stations PIE1 and JPLM. All
the figures show that the solution improved when the NOAA and VMFl were used simultaneously. The results, between 5 and 20 minutes at the beginning of the day, show a significant improvement which vouches for the model's efficiency.

0.2

0.4

0.6

0.8

1.0

Time (day)

Figure 5.3 Improvements in Z-coordinate estimates when using VMFl vs. NMF

78

79

40 r

Hopfield-NMF

-- Hopfi eld-NMF \-VMFl
400 f

NOAA-VMF1
20 -

200 -20 100

-40

0

-kx
}
i

-60

-100

r-

-80 4

-200

-100 ;

-300

-12";.

40

50

60

70

90

100

20

30

40

50

60

70

xo

90

100

Time (minute)

Time (minute)

Figure 5.4 Comparing Latitude estimates using NOAA and VMF1 vs. Hopfield and
NMF at station PIE1 on day 15 of 2006

Figure 5.6 Comparing height estimates using NOAA and VMF1 vs. Hopfield and

NMF at station PIE1 on day 15 of 2006

r

"T

~~

\

ieldNMF A-VMF1

5.3

Implementation of Random Walk Stochastic Model

150

As mentioned earlier, the default tropospheric delay parameter to be estimated within
100

GPSpace is the ZWD. The ZHD is obtained using Hopfield or Chao tropospheric delay
50

models. To test our RW model, we modified the GPSpace software to accept in addition
0

to the ZHD correction the ZWD. In this case instead of estimating the ZWD parameter
-SO

the GPSpace will estimate the total zenith tropospheric delay residual. A suitable value of
-100

residual tropospheric delay random walk noise rate will be used for the purpose to
p

10

30

40

50

60

70

80

90

Time (minute)

account for the residual tropospheric delay fluctuation.

Figure 5.5 Comparing Longitude estimates using NOAA and VMF1 vs. Hopfield
and NMF at station PIE1 on day 15 of 2006
A comparison was made between the coordinates obtained with the GPSpace before and after the modification mentioned above. Figures 5.7 through 5.9 show the latitude,

longitude and ellipsoidal height differences for station PIE1 on day 15 of 2006. The two

80

81

plots in each of the figures are: coordinate differences after using a RW noise rate of
5mm/Vhour for the ZWD parameter and 2mm/Vhour for residual tropospheric delay,
since the observation file is for a day lies in the first quarter of the year.

2(X)

-- -- -when estimating ZWD

-- when estimating residual ZTD
150
i

--

---

--.

-- ~- when estimating ZWD ^"TMTM when estimating residual ZTD
-50

r

-150

0

10

20

30

40

50

60

70

80

90

100

Time (minute)

Figure 5.8 Comparing Longitude estimates when ZTD RW stochastic model is used vs. residual ZTD RW stochastic model at station PIE1 on day 15 of 2006

-- -- -when estimating ZWD

1200

10

30

40

50

60



when estimating residual ZTD

Time (minute)
300

t

--

-

Figure 5.7 Comparing Latitude estimate when ZTD RW stochastic model is used vs. residual ZTD RW stochastic model at station PIE1 on day 15 of 2006

-300

/ II
10
20

30

40

50

60

70

80

90

100

Time (minute)

Figure 5.9 Comparing height estimates when ZTD RW stochastic model is used vs. residual ZTD RW stochastic model at station PIE1 on day 15 of 2006

82

83

research to complement the Saastamoinen, Hopfield and NOAA models. Additionally,

6

CONCLUSIONS AND RECOMMENDATIONS

the RW model was developed for the NOAA model.

6.1

Conclusions

Data sets from five IGS reference stations located in Canada and USA were used to
develop the covariance model for the Saastamoinenand Hopfield-based residual

In this thesis we have assessed three empirical tropospheric delay models, namely the

tropospheric delays. Of the three covariance model examined, the exponential cosine function was found to be the best-fitting model for all the stations, in the least-squares
sense. Examining the coefficients of the covariance models for the Saastamoinen- and Hopfield-based residual tropospheric delays showed that they are almost identical. This

Saastamoinen, Hopfield and NOAA. The assessment has been performed using daily zenith residual tropospheric delays throughout the year 2006. To ensure that spatial
variations are taken into account, we examined tropospheric data series at various

geographical locations across North America. The new highly accurate IGS tropospheric
correction product was used as a reference. It has been shown that all three tropospheric delay models do not sufficiently correct for the total tropospheric delay. As such, a
residual tropospheric error component remains unmodelled. In addition, the performance

indicates that only one stochastic model can be used to account for either of the
Saastamoinen- and Hopfield-based residual tropospheric delays.

Data sets from ten stations spanning North America were used to derive the parameters of three potential stochastic models to account for the NOAA-based residual tropospheric delays. The exponential cosine function was found to be the best-fitting model for all the stations, in the least-squares sense. Comparing models' coefficients from different

of the NOAA model was found to be superior to that of the Saastamoinen and Hopfield.
The performances of the Saastamoinen and Hopfield models were comparable.

The residual tropospheric delays were found to be positively correlated over a period varying from one hour to more than two hours. Unless accounted for, such correlated residual tropospheric delay is expected to slow down the convergence of the GPS solution. In addition, an overestimation of the accuracy of both the observations and the
resulting position estimates would be expected.

stations revealed that they were season independent but were affected by geographical location to a certain degree. Examining the parameters of the first-order Gauss-Markov

model shows that the correlation time of the NOAA-based residual tropospheric delays is
varies in the range of 100 minutes, 75 minutes and 110 minutes for the eastern, middle, and western regions, respectively.

To account for the residual tropospheric delays, three stochastic models, namely first- and second-order Gauss Markov models and the exponential cosine, were developed in this
85

84

When VMF1 was selected in the GPSpace software, the positioning accuracy was

·

For real-time

applications,

stochastic

models

of the

NOAA-based

residual

improved by an average of lmm compared to NMF. Additionally, implementation of the
NOAA tropospheric corrections also improved the positioning accuracy within the

tropospheric delays should be developed using the predicted part of NOAA tropospheric corrections. · More data from stations spanning North America are needed to develop regional
stochastic models for Hopfield- and Saastamoinen-based residual tropospheric delays.

convergence time by a few centimetres.
positioning accuracy was insignificant.

After convergence, the improvement in

Implementation of the RW stochastic model to account for NOAA-based residual
tropospheric delay showed that it is insignificant within the convergence time zone;
however, it showed minor improvement after the convergence time.

·

A global stochastic model could be developed for Hopfield and/or Saastamoinen
models using well-distributed worldwide IGS stations.

6.2

Recommendations for Future Research

To benefit from the foundation laid by this research, future research should concentrate
on the following recommendations.

·

As NOAA-based tropospheric residuals are season-independent, more data from

other years would improve the robustness of the stochastic models developed in
this research.

·

To rigorously account for residual tropospheric delays, it is recommended that

stochastic models developed in this study be used to modify the GPS observation's covariance matrix. Although this leads to fully populated
covariance matrix, its inverse, which is needed in the least-squares estimation,
will be a block diagonal when first-order Gauss Markov model is used. · A Kalman filter-based algorithm, which uses first-order Gauss Markov model to account for residual tropospheric delay, is recommended to be developed.
86
87

REFERENCES Ahn YW, Lachapelle G, Skone S, Gutman S, Sahm S (2006) Analysis of GPS RTK Performance Using external NOAA Tropospheric Corrections Integrated with a Multiple Reference Station Approach. GPS Solutions Vol. 10, No. 3, pp. 171-186. Baby, H.B., P. Gole, and J. Lavergnat (1988). "A model for the tropospheric excess path length of radio waves from surface meteorological measurements." Radio Science,
Vol. 23, No. 6, pp. 1023-1038.

El-Rabbany, A. (2006). Introduction to GPS:

The Global Positioning System, 2nd

Edition, Artech House Inc., Norwood, Massachusetts. Feng Y., Bai Z.,Fang P., Williams A. (2001)."GPS Water Vapour Experimental Results From Observations of the Australian Regional GPS Network (ARGN)" 2001-A

Spatial Odyssey: 42nd Australian Surveyors Congress.

Gao, Y, S Skone, K Chen, N A Nicholson (2004) "Real-Time Sensing Atmospheric
Water Vapor Using Precise GPS Orbit and Clock Products". Proceedings of the ION
GSNN 2005, 21-24 September, Long Beach, CA, pp. 2343-2352.

Bisnath. S., David D., Allen C, Michael P. (2004) " Analysis of the Utility of the NOAA-Generated Tropospheric Refraction Corrections for the Next Generation Nationwide DGPS Service" Institute of Navigation, National Technical Meeting ,2124 September, Long Beach, CA, pp. 1288-1297.

Gelb,

A.

(ED.)

(1974).

"Applied

Optimal

Estimation" Massachusetts

Institute

of

Technology, Cambridge. GPS-System. (GPS-explained) (2008). ULR: www.kowoma.de/en/gps/multipath.gif

(retrieved on June 29, 2008). Gutman, S., T. Fuller-Rowell, D. Robinson (2003). "Using NOAA Atmospheric Models

Boehm J. and Schuh H. (2003). "Vienna Mapping Functions", Proceedings of the 16th Working Meeting on European VLB I for Geodesy and Astronomy, May 9-10,
Leipzig, Germany, pp. 131-143.

to Improve Ionospheric and Tropospheric Corrections." U.S. Coast Guard DGPS
Symp., Portsmouth, VA, 19 June.

Boehm J., Niell A., Tregoning P. and Schuh H. (2006). "Global Mapping Function (GMF): A new empirical mapping function based on numerical weather model data", Journal of Geophysical Research Letters, VOL. 33, L07304, DOI:
10.1029/2005GL024361.

Hay, C, and Wong, J. "Enhancing (2000). GPS: Tropospheric Delay Prediction at the Master Control Station" GPS World, Vol. 11, No. 1, January 2000, pp. 56-62. Heroux P.,Kouba J., Collins P. and Lahaye F. (2001). "GPS Carrier-Phase Point

Box G.E.P and G.M. Jenkins. (1976). "Time Series Analysis, Forecasting and Control".
Holden-Day Inc., San Francisco, California, USA.

Positiong with Precise Orbit Products." Proceedings of the International Symposium on Kinematic Systems in Geodesy, Geomatics and Navigation, Banff, Canada, pp. 518-528.

Byun S H, Y E, Bar-Sever, Gendt G (2005). "The New Tropospheric Product of the International GPS Service", Proceedings of the ION GNSS 2005, 14-16 September,
Long beach, CA, pp. 241-249.

Hofmann-Wellenhof, B., Lichtenegger, H., and Collins, J. (2001). "Global Positioning
System: Theory and Practice", Springer-Verlag Wien, New York.

Byun S. H., Bar-Server Y. E., Gendt G. (2005) " The New Tropospheric Product of the International GNSS Service" Institute of Navigation, National Technical Meeting ,
13-16 September, Long Beach, CA, pp. 241-249.

Hofmann-Wellenhof, B., Lichtenegger, H., and Wasle, E. (2008). "Global Navigation Satellite Systems GPS, GLONASS, Galileo & New York. more", Fourth, revised edition. Springer-Verlag Wien,

IGS (2004). International GPS Service Homepage, http://igscb.jpl.nasa.gov/.

CDDIS (2006). Crustal Dynamics data Information system. ftp://cddis.gsfc.nasa.gov/pub/gps/products/trop new (Accessed on December 14,
2006).

IGS (2007). International GPS Service Homepage.
ftp://sideshow.jpl.nasa.gov/pub/igs_trop/trop_new.

ECMWF (2008). European Centre for Medium-Range Weather Forecast home page. (http://mars.hg.tuwien.ac.at/~ecmwfl/GPS) (Accessed on June 10, 2008).

IGS (2008) International GPS Service Homepage http://igscb.jpl.nasa.gov/network/maps/all nam.html.
JPL (2006). Jet Propulsion Laboratory, ftp://sideshow.jpl.nasa.gov/pub/igs trop/trop new (Accessed on July 20, 2006).

El-Rabbany A (1994) "The Effect of Physical Correlation on the Ambiguity Resolution and Accuracy Estimation in GPS Differential Positioning", Ph.D. thesis. New
Brunswick University.

88

89

Kouba J, Heroux P (2001) "Precise Point Positioning Using Orbit and Clock Products"
GPS Solutions vol. 5, No. 2, pp. 12-28.

Vollath U., Brockmann E.and Chen X. (2003)."Troposphere: Signal or Noise?" Institute
of Navigation, GPS/GNSS, 9-12 September, Portland, OR, pp. 1709-1717.

Kouba J., (2007). "Implementation and testing of the gridded Vienna Mapping Function
1 (VMF1)", Journal of Geophysics Research.

Xia, L. (2004)." Multipath in GPS Navigation and Positioning, GPS Solutions", 8, April,
pp. 49-50.

Kouba, J. (2003). "A Guide to Using International GPS Service (IGS)." Available at
http://igscb.jpl.nasa.gov/igscb/resource/pubs/GuidetoUsingIGSProducts.pdf.

Xu G. (2007)." GPS Theory, Algorithms and Applications". 2nd edition. Springer-Berlin,
Heidelberg, New York.

Leick, A. (1995). "GPS Satellite Surveying", 2nd Edition, John Wiley & sons, Inc. Leick, A. (2004). "GPS Satellite Surveying", 3rd Edition, John Wiley & sons, Inc.
Manning D. (2005)."NGA GPS Monitor Station High-Performance Cesium Frequency Standard Stability: From NGA Kalman filter Clock Estimates", Journal of IEEE pp.
840-847.

Marini, J. W. (1972). "Correction of satellite tracking data for an arbitrary tropospheric
profile." Radio Science, Vol. 7, No. 2, pp. 223-231.

Mendes, V. B. (1999). "Modeling Modelling the neutral-atmosphere propagation delay in radiometric space techniques.", Ph.D. dissertation, Department of Geodesy and Geomatics Engineering Technical Report No. 199, University of New Brunswick,
Fredericton, New Brunswick, Canada, 353 pp.

NASA (2008). ULR: http://visibleearth.nasa.gov/) (retrieved on June 29, 2008).

Niell, A. E. (1996) "Global mapping functions for the atmosphere delay at radio wavelengths." Journal of Geophysical Research, Vol. 101, No. B2, pp. 3227-3246. Spiegel, M.R. (1999). "Mathematical Handbook of Formulas and Tables" McGraw Hill.

Teunissen, P. J. G, and A. Kleusberg (eds.) (1998)."GPS for Geodesy", 2nd Edition, New
York Springer-Verlag.

The Aerospace Corporation (2008) .ULR:

www.aero.org/.../crosslink/summer2002/03.html (retrieved on June 15, 2008).

Tralli D. and Lichten S. (1990)."Stochastic Estimation of Tropospheric Path Delays in Global Positioing System geodetic Measurements", Journal of Geodesy, VOL. 64,
No. 2, DOI: 10.1007/BF02520642 pp. 127-159.

Vey S, Fritche M, Dietrich R, Rothacher M, Riilke A, Steigenberger P (2006) "Influence of mapping Function Parameters on Global GPS Network Analyses: Comparison between NMF and IMF" Journal of Geophysics Research
DOI:10.1029/2005GL024361.
90 91

APPENDIX I: DAILY RESIDUAL TROPOSPHERIC DELAY TIME

APPENDIX II: DAILY RESIDUAL TROPOSPHERIC DELAY TIME
SERIES FOR NOAA MODEL
ALGO AMC2 FLIN HLFX HOLB JPLM MDO1 NLIB PRDS USNO

SERIES FOR SAASTAMOINEN, HOPFIELD AND NOAA MODELS

50

--- NOAA ---- Hopfield --·-- Saastamoinen

40

2(K)

400

600

800

1000

1200

1425

Time (min)

500

1.000

1,425

Time (minute)

Figure II. 1 NOAA-based residual ZTD at 10 stations on day 110 of 2006

Figure I.I NOAA-, Hopfield-, and Saastamoinen-based ZTD at station PRDS on day
201 of 2006

ALGO
80

AMC2

FLIN

HLFX

HOLB

JPLM

MDO1

NLIB

PRDS

USNO

1
1 I

i
i

40

1

r\
^ /

A j \

-20 [

-40

^---^
i

200

4(X)

1(X)O

1200

1425

Time (min)

Figure II.2 NOAA-based residual ZTD at 10 stations on day 202 of 2006
93

92

T
APPENDIX III: ESTIMATED AUTOCOVARIANCE FUNCTION OF
 ALGO --- AMC2
40

HLFX

HOLB

JPLM

MDO1

NLIB

PRDS

USNO

RESIDUAL TROPOSPHERIC DELAY
-- ALGO AMC2 FL1N HLFX HOLB JPLM MDO1 NLIB PRDS USNO

200

4(X)

600

800

l(X)0

1200

1425

Time (min)
2(X) 400 600 800
1000

1200

1425

Figure II.3 NOAA-based residual ZTD at 9 stations on day 304 of 2006

Lag (min)

Figure III.l ACF of NOAA-based residual ZTD at 9 stations on day 110 of 2006

ALGO

AMC2

FLIN

HLFX

HOLB

JPLM

MDO1

NLIB

PRDS

USNO

200

400

600

800

1000

1200

1425

Lag (min)

Figure 111.2 ACF of NOAA-based residual ZTD at 10 stations on day 202 of 2006
94 95

APPENDIX IV: RESIDUAL TROPOSPHERIC DELAY OVER THE
r---M.GO^--AMC2 -- HLFX --- HOLB
2.5

JPLM- - MPOlj-- NLIB

PRPS

USNO

YEAR
80

60

40

I £ "20
Q
H N -40
-60

-80

200

400

600

800

1000

1200

1425

Lag (min)

FEB06

APR 06

JUN06

AUG06

OCT06

DEC 06

Time (month)

Figure III.3 ACF of NOAA-based residual ZTD at 10 stations on day 304 of 2006

Figure IV. 1 NOAA-based residual ZTD at station ALGO over 2006

APR 06

JUN 06

AUG 06

OCT06

DEC 06

Time (month)

Figure IV.2 NOAA-based residual ZTD at station AMC2 over 2006

96

97

T
100

so

80

FEB06

APR 06

JUN06

AUG06

OCT06

DEC 06

Time (month)
:os

FEB06

APR 06

JUN06

AUG06

OCT06

DEC 06

Time (month)

Figure IV.5 NOAA-based residual ZTD at station HOLB over 2006

Figure IV.3 NOAA-based residual ZTD at station FLIN over 2006
60

100

40

20

1
I

-20

IS

§1

-40
-60

1
Q
H N

-80

-100

-120

DEC 05
FEB06 APR 06 JUN06 AUG06

FEB06

APR 06

JUN06

AUO06

OCT06

DEC 06

OCT06

DEC 06

Time (month)

Time (month)

Figure IV.6 NOAA-based residual ZTD at station JPLM over 2006

Figure IV.4 NOAA-based residual ZTD at station HLFX over 2006
98
99

FEB06

APR 06

JUN06

AUG06

OCT06

DEC 06

de'cos

FEB06

APR 06

JUN06

AUG06

OCT06

DEC 06

Time (month)

Time (month)

Figure IV.7 NOAA-based residual ZTD at station MDO1 over 2006

Figure IV.9 NOAA-based residual ZTD at station PRDS over 2006

100

FEB06

APR 06

JUN06

AUG06

OCT06

DEC 06

Time (month)

Figure IV.8 NOAA-based residual ZTD at station NLIB over 2006

100

101

APPENDIX V: FITTING OF THE ESTIMATED
AUTOCOVARIANCE FUNCTION
Estimated ACF
0.9

\
1 1

Estimated ACF -^First-order Gauss Markov Fit -^H-Second-order Gauss Markov Fit ""Exponential cosine Fit

0.8

-^- First-order Gauss Markov Fit
0.9 f

0.7

V

-·-Second-order Gauss Markov Fit

i

0.6
i
i

---- Exponential cosine Fit
0.5

0.4

s

s


0.3
0.2

0.1

i
n

i i

i i

20

40

60

80

100

120

140

Lag (minute)

0.4

20

40

60

80

100

120

140

Figure V.3 Fitting of ACF of Hopfield-based residual at station MDOl on day 45 of
2006

Lag (minute)

Figure V.I Fitting of autocovariance of NOAA-based residual at station JPLM on
day 215 of 2006

Estimated ACF
0.95

-A~ First-order Gauss Markov Fit
-·-Second-order Gauss Markov Fit

Estimated ACF

First-order Gauss Markov Fit Second-order Gauss Markov Fit Exponential cosine Fit

0.9

s ----Exponential cosine Fit
*

0.85

>

0.75

§

0.7
0.65

0.6

0.55

NX V
20 40
60 80

0.5

100

120

140

Lag (minute)
60 80 100
120

140

Lag (minute)

Figure V.4 Fitting of ACF of Saastamoinen-based residual at station USNO on day 180 of 2006

Figure V.2 Fitting of ACF of Hopfield-based residual at station JPLM on day 215 of
2006
102

103

APPENDIX VI: AUTOCOVARIANCE FUNCTION FITTING RMS
Estimated ACF

First-order Gauss Markov Fit Second-order Gauss Markov Fit
Exponential cosine Fit
0.45

--a-- First-order Gauss-Markov -«-- Exponential Cosine

--«

-- Second-order Gauss-Markov

0.40
0.35 0.30 0.25 0.20
0.15

~ 7 I tWl
I 20 40

v
1

0.10 0.05

0.00
120
140

*
60

nl Jim
80 100

ffll

40

60

80

100

-0.05

Lag (minute)

Day Number

Figure V.5 Fitting of ACF of NOAA-based residual at station HLFX on day 104 of
2006

Figure VI.l Fitting RMS of NOAA-based residual at station AMC2 over 2006

Estimated ACF

-*- First-order Gauss Markov Fit -·-Second-order Gauss Markov Fit --" Exponential cosine Fit

First-order Gauss-Markov Exponential Cosine

Second-order Gauss-Markov

Day Number

Lag (minute)

Figure VI.2 Fitting RMS of NOAA-based residual at station FLIN over 2006

Figure V.6 Fitting of ACF of NOAA-based residual at station HLFX on day 158 of
2006
104

105

 First-order Gauss-Markov · Exponential Cosine

 Second-order Gauss-Markov

APPENDIX VII: FLUNCTUATION OF MODELS' COEFFIEINETS
' First-order Gauss-Markov Coefficient  Second-order Gauss-Markov Coefficient · Exponential Cosine First Coefficient  Exponential Cosine Second Coefficient

0.06 0.05
0.04

£

°03

I a02
0.01 0.00 -0.01

-0.02

Day Number

Day Number

Figure VII. 1 Fluctuation of models coefficients at HOLE for NOAA based residual ·First-order Gauss-Markov Coefficient Second-order Gauss-Markov Coefficient Exponential Cosine First Coefficient  Exponential Cosine Second Coefficient

Figure VI.3 Fitting RMS of NOAA-based residual at station FLIN over 2006

Day Number

Figure VII.2 Fluctuation of models coefficients at NLIB for NOAA based residual

106

107

APPENDIX IX: SAASTAMOINEN-, HOPFIELD- AND NOAA-

APPENDIX VIII: MEAN OF AUTOCOVARIANCE FUNCTION
EMPIRICAL MODELS' COEFFICIENTS
list Gauss - Markov CoefT
J2ii(t Gauss - Markov Coeff.

BASED STOCHASTIC MODLES COEFFICIENTS MEAN
0.025

|noaa

JHopfield
(Exponential Cosine 1st Coeff. (Exponential Cosine 2nd Coeff
0.02

JSaastamoinen

,2 0.015
--

1

0.01 -

0.005

0

lstO.-M. Coeff.

2nd G. - M. Coeff.

1 st Exp. Cos. M. Coeff.

2nd Exp. Cos. M. Coeff.

Station

Model Coefficent

Figure VIII.l Mean of stochastic models' coefficients of the Saastamoinen-based
residual ZTD at different stations
0.025 r-

Figure IX. 1 Model coefficients mean of coefficient at station JPLM

0.025

NOAA Hopfield
Saastamoinen

0.02

0.015

11st Gauss - Markov Coeff. |2nd Gauss - Markov Coeff. |Exponential Cosine 1st Coeff.

1

I

0.02

y

0.015

|Exponential Cosine 2nd Coeff.
0.01

0.01

0.005

0.005

0--

ALGO

JPLM

MDO1

PRDS

USNO

Station

lstG. - M. Coeff.

2nd G. - M. Coeff.

1 st Exp. Cos. M. Coeff.

2nd Exp. Cos. M. Coeff.

Model Coefficient

Figure VIII.2 Mean of stochastic models' coefficients of the Hopfield-based residual
ZTD at different stations
108

Figure IX.2 Model coefficients mean of coefficient at station MDO1
109

APPENDIX X: DAILY MEAN OF RANDOM WALK NOISE RATE
0.035

NOAA

Hopfield
Saastamoinen
0.03

©

3.2 3.0 -

+

0.025

0.02 -

0.015

0.01

0.005

lstO.-M.Coeff

2nd Ci. - M. Coeff.

1 st Kxp. Cos. CoelT.

2nd Kxp. Cos. Ccieli.

Model Coefficent

Figure IX.3 Model coefficients mean of coefficient at station PRDS

NOAA

Figure X.I Daily mean random walk noise rate at station AMC2 over 2006

Hopfield
Saastamoinen

Isi G. - M. Coeff.

2nd Ci. - M. Oolff.

isc Iixp. Cos. Coeff.

2nd Kxp. Cos. Coeff.

Model Coefficient

Figure IX.4 Model coefficients mean of coefficient at station USNO

Figure X.2 Daily mean random walk noise rate at station FUN over 2006

110

RWRNmoaa/i(nlthsdkeur
<

2.8 2.6 2.4-

+

+

* +

+

+

2.2 2.0 -

+ +t+++t
+
+ +

++
*

1.8 1.6 -

*
+

+

±*V +

+

*

+#

+++ 
+



+

1.41.2 -

+
100 200

300

Day of the year

4-

O

I
3 + +

+
+

Z

a

2

a Pi

I

I 1

*

f *+++ +++ +

+

H-*

i
50 100 150

-

200

250

300

350

Day of the year

111

Random Walk Noise Rate mm/(hour)A0.5
o
en
i_

a
Random Walk Noise Rate mm/(hour)A0.5
-t
J I 1--

a
w

ro
cn

b
--I !

ro

in

o

M

»

cn

_

s
I
§

9

*+

s
o

i
fa

&
>
o
n ro

©
+

M + *
S,
-*--

I"
re

re
S3

°

**
Si

I
I
+>

+

+

+

s

s
to o

Random Walk Noise Rate mm/(hour)A0.5
p
ro

Random Walk Noise Rate mm/(hour)A0.5
ro CO
u

n

p-"--^t\>rococo4i

in

b

cn

b

cn

inbinbinbinb

0

+

<

+

+
+
85
1

+
h
8

s +

+
5
a o

*+
s
+
O

+
·++

+
+
*" + +
EL
8
O
S3 O

O
8
sr
ro

+ +··*
+
°
85
65

·1

*

f
SS3
S3

4
i
+

++ J
S3

+

s

N3

+h

I
+ ·**

5"
CO

+
o o

^

"

+

h

 

+

*

o
ft

CO

1

s

+

+ *1

TO*
Random Walk Noise Rate mm/(hour)A0.5
p w

3
ore
w

3
Random Walk Noise Rate mm/(hour)A0.5
IO
--I 1_
i

in
90

b

in

Sf
CO

cn

at
i

©
&9
+
re
+

H*

H*+
3

cc

i
a
o

S
a

i
4*

o


SL

*<
s?

©

o
n

S3

5?

&9
VI

;+

©"

*4

o'

i

u

s

©
O

o
re

S

TO*

3

Random Walk Noise Rate mm/(hour)A0.5

so

O

+

i
SB

i

a
o

§

-

2L
o

O
Si

H-

*
s.

2
re

S
 +
H

+

5'

o
n

*++ +

r


