Spatial Data Analysis for Laser Scanning Based Shape Error Inspection

by

Haibin Jia Master of Applied Science in Mechanical Engineering Ryerson University Toronto, Ontario, Canada

A thesis presented to Ryerson University in partial fulfillment of the requirement for the degree of Doctorate of Philosophy in the Program of Aerospace Engineering.

Toronto, Ontario, Canada, 2011

© Haibin Jia, 2011

AUTHOR'S DECLARATION
I hereby declare that I am the sole author of this thesis.

I authorize Ryerson University to lend this thesis to other institutions or individuals for the purpose of scholarly research.

I further authorize Ryerson University to reproduce this thesis by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

ii

INSTRUCTIONS ON BORROWERS
Ryerson University requires the signatures of all persons using or photocopying this thesis. Please sign below, and give address and date. Name Signature Address Date

iii

ABSTRACT
Spatial Data Analysis for Laser Scanning Based Shape Error Inspection A thesis for the degree of Doctorate of Philosophy, 2011 by Haibin Jia Department of Aerospace Engineering, Ryerson University

Laser scanning, a widely used technology, has been highly developed and adopted in various industrial applications. The methodologies used for scanner data processing are mostly point based. In this thesis, a new approach is presented to analyze spatial data obtained from a 3-D laser scanner for shape error inspection. Different from traditional methodologies, the method proposed in this research is frequency based.

The method utilizes the Fourier transform to decompose a 2-D curve or 3-D shape into its spatial components by applying two 1-D FFT (Fast Fourier Transform) on 2-D curves or two 2-D FFT on 3-D shapes. The spatial components including frequency, amplitude, and phase are defined as shape characteristics to represent the shape under inspection. By relating spatial components with GD&T (Geometric Dimensioning and Tolerancing) standards using proper analysis techniques, such as frequency spectrum and cross correlation, shape errors can be detected and characterized.

One of the applications of this method is automated inspection. In this research, the iv

spatial data method is applied to MIG (Metal Inert Gas) weld inspection. Experiments are carried out to analyze the 2-D curve of a projection weld data, and the 3-D scanning data directly. A MIG weld inspection system is also developed for production use.

Keywords: Spatial data analysis, laser scanner, Fourier transform, MIG weld, automated inspection

v

ACKNOWLEDGMENTS
I would like to express my gratitude to those who gave me the possibility to complete this thesis.

I am deeply indebted to my supervisor Dr. Jeff Xi and my co-supervisor Dr. Vincent Chan for support, guidance and encouragement throughout this thesis.

I would like to thank Van-Rob Inc. and OCE for their financial assistance on this project. Especially many thanks to Bo Lindgren, Vice President of Engineering of Van-Rob Inc., for the continuous support and constructive suggestions during the progress of this project. I would also like to thank Cheng Zeng, Henry Huang and Min Xiao, Process Engineering Specialists at Van-Rob for their valuable inputs.

My classmates from the Department of Aerospace Engineering supported me in my research work. I want to thank them for all their help.

vi

TABLE OF CONTENTS
AUTHOR'S DECLARATION.....................................................................ii ABSTRACT...........................................................................................iv ACKNOWLEDGEMENTS.........................................................................vi TABLE OF CONTENTS...........................................................................vii LIST OF FIGURES..................................................................................x LIST OF TABLES...............................................................................xviii NOMENCLATURE................................................................................xix CHAPTER 1  INTRODUCTION ..................................................................................... 1  1.1  1.2  1.3  Background of vision inspection and problem statement .................................... 1  Objective of the thesis research ............................................................................ 3  Organization of the thesis ..................................................................................... 4 

CHAPTER 2  LITERATURE REVIEW .......................................................................... 5  2.1  2.2  2.3  Inspection methods review ................................................................................... 5  3-D laser scanning technology ............................................................................. 7  Current spatial data analysis methods ................................................................ 13  Methods for 1-D modeling inspection ........................................................ 16  Methods for 2-D modeling inspection ........................................................ 18  Methods for 3-D modeling inspection ........................................................ 19 

2.3.1  2.3.2  2.3.3  2.4 

Summary ............................................................................................................ 24 

CHAPTER 3  SPATIAL DATA ANALYSIS METHOD ............................................. 25  3.1  3.2  2-D Problem ­ Parametric Equations ................................................................. 26  Fourier transform for 2-D curve ......................................................................... 32  vii

3.3  3.4 

Fourier transform for 3-D shape......................................................................... 43  Summary ............................................................................................................ 48 

CHAPTER 4  SPATIAL DATA ANALYSIS FOR SHAPE ERROR INSPECTION .. 49  4.1  4.2  Geometric dimensioning and tolerancing standards .......................................... 49  Spatial data analysis method for 2-D curve inspection ...................................... 51  Profile of a line- overall size change........................................................... 51  Profile of a line- shape errors ...................................................................... 60 

4.2.1  4.2.2  4.3  4.4 

Spatial data analysis method for 3-D shape inspection ...................................... 70  Summary ............................................................................................................ 74 

CHAPTER 5  EXPERIMENTS ON MIG WELD INSPECTION ................................. 75  5.1  5.2  Welding process, weld defects and inspection methods .................................... 75  Spatial data analysis method .............................................................................. 84  1-D Fourier transform on 2-D projection data ............................................ 88  2-D Fourier transform directly on the 3-D point clouds ........................... 104 

5.2.1  5.2.2  5.3 

Geometry projection method ............................................................................ 107  Methodology ............................................................................................. 107  Implementation issues ............................................................................... 114  Experimental results.................................................................................. 120 

5.3.1  5.3.2  5.3.3  5.4  5.5 

Template method .............................................................................................. 123  Summary .......................................................................................................... 126 

CHAPTER 6  MIG WELD INSPECTION SYSTEM IMPLEMENTATION ............. 127  6.1  6.2  System hardware introduction .......................................................................... 128  Implementation issues and software development ........................................... 130 

viii

6.2.1  6.2.2  6.2.3  6.3 

Image registration ..................................................................................... 131  Spatial data analysis method implementation ........................................... 139  Template method ...................................................................................... 155 

Summary .......................................................................................................... 159 

CHAPTER 7  CONCLUSION ..................................................................................... 160  7.1  7.2  7.3  7.4  Conclusions ...................................................................................................... 160  Main research contributions ............................................................................. 161  Publications ...................................................................................................... 162  Future work ...................................................................................................... 163 

REFERENCES ............................................................................................................... 164  APPENDIX A:  WELD DEFECT DETECTION CALCULATION VALUES .......... 168  APPENDIX B:  SOFTWARE DEVELOPMENT ROAD MAP ................................. 169  B.1  B.2  B.3  B.4  B.5  B.6  B.7  Main Software Interface ................................................................................... 169  Teach mode (Minimum Algorithm and Average Algorithm) .......................... 172  Analysis window .............................................................................................. 173  PLC and Software Test Program ...................................................................... 174  Data Collection Program .................................................................................. 175  Limit, Bee Hive Threshold and Tolerance Setup Module ............................... 176  Nuts Detection .................................................................................................. 177 

APPENDIX C:  MIG WELD INSPECTION SOFTWARE INTRODUCTION ......... 181  C.1  C.2  Software interface ............................................................................................ 182  MIG weld inspection system floor tests ........................................................... 189 

ix

LIST OF FIGURES
Figure 2.1: Coordinate Measurement Machine .................................................................. 5  Figure 2.2: Triangulation laser scanner .............................................................................. 9  Figure 2.3: Hand-held laser scanner ................................................................................... 9  Figure 2.4: Surface image of a TFT-LCD pannel [15] ..................................................... 16  Figure 2.5: Four horizontal grey-level profiles for the TFT-LCD .................................... 17  Figure 2.6: Color image thresholding and boundary following for a microdrill inspection: (a) original image, (b) color thresholding and boundary following [23] .......................... 18  Figure 3.1: A circle with radius of 1 ................................................................................. 26  Figure 3.2: Graph of x and y series' parametric equations ............................................... 27  Figure 3.3: Fourier transform on x and y series of a circle ............................................... 30  Figure 3.4: Cycloids generated from Fourier coefficients ................................................ 33  Figure 3.5: A 10mm by 10mm square .............................................................................. 34  Figure 3.6: Graph of x and y series of the 10 by 10 square .............................................. 35  Figure 3.7: Fourier transfrom of x and y series of a square .............................................. 36  Figure 3.8: Fourier transform of x+yi of a square ............................................................ 37  Figure 3.9: Combination of frequency .............................................................................. 38  Figure 3.10: A 2-D cross shape......................................................................................... 39  Figure 3.11: x and y series of the cross............................................................................. 39  Figure 3.12: Fourier transforms of cross' x and y seires .................................................. 40  Figure 3.13: Fourier transform of cross' complex notation x+yi ..................................... 41  Figure 3.14: Combination of frequency ............................................................................ 42  Figure 3.15: 3-D Geometries generation .......................................................................... 44 x

Figure 3.16: X and Y matrix of a sphere .......................................................................... 45  Figure 3.17: 2-D Fourier transfom on X and Y matrix ..................................................... 46  Figure 3.18: A sphere with 19 sliced profiles ................................................................... 47  Figure.4.1 GD&T Standards ­ profile of line and profile of a surface [35] ..................... 50  Figure 4.2: The amplitude and phase components on x, y series of a square ................... 52  Figure 4.3: 1-D Fourier transform on x and y series......................................................... 53  Figure 4.4: Comparison of a 10mm quarter circle and a 15mm quarter circle ................. 53  Figure 4.5: Comparison of x and y series ......................................................................... 54  Figure 4.6: 1-D Fourier transform on x and y series of two profiles ................................ 55  Figure 4.7: Cross correlation of frequency and amplitude between x and y series .......... 56  Figure 4.8: Comparison of a 10mm quarter circle and an 8mm quarter circle ................. 56  Figure 4.9: Comparison of x and y series of two profiles................................................. 57  Figure 4.10: 1-D Fourier transform on x and y series of two profiles .............................. 58  Figure 4.11: Cross correlation of x and y series of two profiles ....................................... 59  Figure 4.12: Relationship between profile size and values of amplitudes ........................ 60  Figure 4.13: A profile has a bump shape error ................................................................. 61  Figure 4.14: Comparison of error profile and standard profile ......................................... 61  Figure 4.15: 1-D Fourier transform on x and y series....................................................... 62  Figure 4.16: Amplitude and phase changes on y1 series .................................................. 62  Figure 4.17: Cross correlation of error profile and standard profile ................................. 63  Figure 4.18: Zoom in view of amplitude cross correlation ............................................... 63  Figure 4.19: Compare of a bigger bump shape error with the standard profile ................ 64  Figure 4.20: Comparison of 1-D Fourier transform of two profiles ................................. 64 

xi

Figure 4.21: Cross correlation of a bigger bump shape error and standard profile .......... 65  Figure 4.22: Comparison of a profile with crater and the standard profile....................... 65  Figure 4.23: Comparison of 1-D Fourier transform.......................................................... 66  Figure 4.24: Cross correlation of the profile with crater and the standard profile............ 66  Figure 4.25: Relationship between shape errors and peak amplitude (unit: mm) ............ 67  Figure 4.26: Relationship between shape errors and peak average amplitude (unit: mm) 68  Figure 4.27: Relationship between shape errors and ........................................................ 68  Figure 4.28: Relationship between shape errors and average phase (unit: degree) .......... 69  Figure 4.29: Relationship between shape errors and ........................................................ 69  Figure 4.30: x and y coordinate projections of two cubes ................................................ 71  Figure 4.31: 2-D FFT on y coordinates ............................................................................ 72  Figure 4.32: Amplitudes comparison between the ideal and error shape ......................... 72  Figure 4.33: A zoomed view of amplitudes comparison .................................................. 73  Figure 5.1: Typical weld defects [34] ............................................................................... 76  Figure 5.2: Using weld gauge to inspect different types of defects[35] ........................... 77  Figure 5.3: Principle of a 3-D laser scanning ................................................................... 78  Figure 5.4: SICK IVC-3D laser scanner ........................................................................... 80  Figure 5.5: 1-2-3 gauge block used for laser scanner calibration ..................................... 81  Figure 5.6: Scanning image of the 1-2-3 gauge block ...................................................... 82  Figure 5.7: Radiator support ............................................................................................. 84  Figure 5.8: Point cloud of one weld .................................................................................. 84  Figure 5.9: Leg size of a T-joint ....................................................................................... 85  Figure 5.10: MIG welds to be inspected ........................................................................... 85 

xii

Figure 5.11: A scanning cross section .............................................................................. 86  Figure 5.12: Weld being inspected ................................................................................... 87  Figure 5.13: Projection method......................................................................................... 88  Figure 5.14: A closed contour of the weld projection data ............................................... 89  Figure 5.15: The middle portion with weld and base metals ............................................ 90  Figure 5.16: Connect the ends to create a 2-D closed contour ......................................... 90  Figure 5.17: Fourier transform of good welds .................................................................. 91  Figure 5.18: Maximum and minimum profile of a bad weld ............................................ 92  Figure 5.19: The middle portion with weld and base metals ............................................ 92  Figure 5.20: 2-D closed shape of a bad weld .................................................................... 93  Figure 5.21: Fourier transform of the bad weld ................................................................ 94  Figure 5.22: Comparison of a good and bad weld ............................................................ 94  Figure 5.23: Frequency and phase difference of y series.................................................. 95  Figure 5.24: Cross correlation of x and y series of a bad weld ......................................... 95  Figure 5.25: Example of bad weld with undercut ............................................................. 96  Figure 5.26: The middle portion with weld and base metals ............................................ 96  Figure 5.27: 2-D closed shape of a bad weld .................................................................... 97  Figure 5.28: Fourier transform of the bad weld ................................................................ 98  Figure 5.29: Comparison of a good and bad weld ............................................................ 98  Figure 5.30: Frequency and phase difference between a good and bad weld................... 99  Figure 5.31: Cross correlation of x and y series of a bad weld ......................................... 99  Figure 5.32: Example of bad weld with undercut ........................................................... 100  Figure 5.33: The middle portion with weld and base metals .......................................... 100 

xiii

Figure 5.34: 2-D closed shape of a bad weld .................................................................. 101  Figure 5.35: Fourier transform of the bad weld .............................................................. 102  Figure 5.36: Comparison of a good and bad weld .......................................................... 102  Figure 5.37: Frequency and phase difference between a good and bad weld................. 103  Figure 5.38: Cross correlation of x and y series of a bad weld ....................................... 103  Figure 5.39: 3-D point clouds of a weld ......................................................................... 104  Figure 5.40: 3-D point cloud of a good weld .................................................................. 105  Figure 5.41: 2-D Fourier transform of a good weld........................................................ 105  Figure 5.42: 3-D point cloud of a bad weld .................................................................... 106  Figure 5.43: 2-D Fourier transform of a bad weld .......................................................... 106  Figure 5.44: Fourier transform difference of a good and bad weld ................................ 107  Figure 5.45: Weld geometry ........................................................................................... 109  Figure 5.46: Finding the minimum A, B and C .............................................................. 112  Figure 5.47: Projection method....................................................................................... 112  Figure 5.48: The minimum and maximum edge of the point strip ................................. 113  Figure 5.49: The rotation along X, Y and Z axes ........................................................... 115  Figure 5.50: Calibration process ..................................................................................... 115  Figure 5.51: Calibration result ........................................................................................ 117  Figure 5.52: The orientation of the projection data ........................................................ 118  Figure 5.53: Software interface....................................................................................... 119  Figure 5.54: Engine cradle .............................................................................................. 124  Figure 5.55: Three types of welds................................................................................... 124  Figure 5.56: Common weld defects in production.......................................................... 125 

xiv

Figure 6.1: MIG welding inspection system layout ........................................................ 128  Figure 6.2: MCC USB 24-Channel Digital I/O Module ................................................. 129  Figure 6.3: Reference hole in a scanning image ............................................................. 132  Figure 6.4: The Minimum Difference: 1 pixel or less, less than 0.4mm ........................ 133  Figure 6.5: The maximum difference: 5 pixel, 2.0 mm .................................................. 133  Figure 6.6: Difference of 3 pixel, 1.2 mm ...................................................................... 134  Figure 6.7: Difference in Z direction .............................................................................. 135  Figure 6.8: Registration features ..................................................................................... 136  Figure 6.9: Difference (a) before and (b) after registration ............................................ 138  Figure 6.10: A closer view of difference (a) before and (b) after registration................ 138  Figure 6.11: Inspection flow chart .................................................................................. 139  Figure 6.12: Raw data is registered using reference feature ........................................... 140  Figure 6.13: The truncated image contains weld and base metals .................................. 141  Figure 6.14: 2-D FFT of a good weld #783 .................................................................... 141  Figure 6.15: Weld #779 being inspected ........................................................................ 142  Figure 6.16: 2-D FFT of scanning image# 0779............................................................. 142  Figure 6.17: 2-D FFT subtraction of weld #783 and #779 ............................................. 143  Figure 6.18: Weld #648 - burn through .......................................................................... 145  Figure 6.19: Phase component with or without unwrap comparison.............................. 147  Figure 6.20: Phase difference with or without unwrap comparison ............................... 147  Figure 6.21: Projection data of weld #783 ...................................................................... 148  Figure 6.22: Projection data of weld #779 ...................................................................... 148  Figure 6.23: Comparison of shape indices of weld #783 and weld #779 ....................... 149 

xv

Figure 6.24: Cross correlation between x and y series of weld #783 and 779 ............... 149  Figure 6.25: Amplitude and phase difference between weld #783 and #779 ................. 150  Figure 6.26: Projection data of weld #648 ...................................................................... 151  Figure 6.27: Comparison of weld#783 and weld #648 ................................................... 151  Figure 6.28: Cross correlation of weld #783 and weld #648 .......................................... 152  Figure 6.29: Amplitude and phase difference between weld #783 and weld #648 ........ 152  Figure 6.30: Three types of welds and their scanning images ........................................ 156  Figure 6.31: Decision making ......................................................................................... 157  Figure B.1: Part being hold by a lift assist ...................................................................... 170  Figure B.2: Main software version 10 ............................................................................ 171  Figure B.3: Teach mode ­ minimum algorithm.............................................................. 172  Figure B.4: Teach mode ­ average algorithm................................................................. 172  Figure B.5: Analysis window ......................................................................................... 173  Figure B.6: PLC & software testing program ................................................................. 174  Figure B.7: Data collection program .............................................................................. 175  Figure B.8: Total 8 nuts on Delta cradle ......................................................................... 177  Figure B.9: ROI of nuts detection ................................................................................... 178  Figure B.10: M8 nuts present.......................................................................................... 179  Figure B.11: M8 nuts missing ......................................................................................... 180  Figure B.12: M8 nuts missing ......................................................................................... 180  Figure C.1: Start the inspection program ........................................................................ 181  Figure C.2: Inspection results ......................................................................................... 182  Figure C.3: Software panels............................................................................................ 183 

xvi

Figure C.4: Teach Mode (Training Mode) Selection...................................................... 183  Figure C.5: Teach Mode Interface .................................................................................. 184  Figure C.6: Analysis window ......................................................................................... 184  Figure C.7: Limits and tolerance setup tool .................................................................... 185  Figure C.8: Password is needed when update templates ................................................ 185  Figure C.9: Templates update tool .................................................................................. 186  Figure C.10: Pop-up message box confirms the template update ................................... 186  Figure C.11: Review function ......................................................................................... 187  Figure C.12: Review inspection log................................................................................ 187  Figure C.13: Percentage calculation ............................................................................... 188  Figure C.14: Reset confirmation message box ............................................................... 188  Figure C.15: Laser scanner cell testing flow .................................................................. 189 

xvii

LIST OF TABLES
Table 2.1: List of inspections, data representation and geometry characteristics ............. 15  Table 4.1: Amplitude values for different size of quarter circles ..................................... 59  Table 4.2: Shape indices changes of different type of shape errors.................................. 67  Table 5.1: Manual measurement of 1-2-3 gauge block (unit: mm) .................................. 80  Table 5.2: 1-2-3 gauge block three inch edge measurement ............................................ 82  Table 5.3: 1-2-3 gauge block vertical direction measurement .......................................... 83  Table 5.4: Experiments results for geometry projection method .................................... 122  Table 6.1: Image difference check .................................................................................. 134  Table 6.2: Difference between different parts and loadings without registration........... 136  Table 6.3: Difference between different parts and loadings with registration ................ 137  Table 6.4: Mean value and standard deviation between good welds and #783 .............. 144  Table 6.5: Mean value and the square of deviation of four bad welds ........................... 145  Table A.1 Weld defect detection calculation values....................................................... 168 

xviii

NOMENCLATURE
A AX[k] amplitude component, leg size A amplitudes of the cosine curve at frequency k radius of the cycloid, linear equation coefficent amplitude ratio for  amplitude ratio for  leg size B amplitudes of the sine curve at frequency k. linear equation coefficent throat thickness calibration point linear equation coefficient density of ROI parabola equation coefficient parabola equation coefficient frequency component, parabola equation coefficient, spatial frequency frequency ratio for  frequency ration for  parabola equation coefficient total height of ROI frequency xix

a
a

a
B BX[k]

b
C CP

c
Dn

d

e
f

f
f
g

H k

l
Ml Mc

length of weld linear equation coefficient matrix parabola equation coefficient matrix number of sampling points number of cross sections number of digitalized intervals intersection point rotation matrix radius, spatial scanning resolution parameter coordinate x or series x cross correlation of series x and y coordinate y or series y height on point i

N N cs

n
Pi
R
r

t

x
x-y
y

Zi

Greek Symbols

 

phase component angular parameter angular parameter rotation angle on x rotation angle on y rotation angle on z pi xx


x
y

z


CHAPTER 1 INTRODUCTION
1.1 Background of vision inspection and problem statement

The basic requirement in manufacturing is that the product and its components meet the specifications established by the design engineer. These specifications include dimension and geometric tolerances such as: flatness, roundness, and angularity. Dimensions are important because they determine how well the components of a product fit together during assembly. Other specifications are important, such as, flatness of a surface, roundness of a shaft or hole, parallelism between two surfaces, etc. To meet these basic manufacturing requirement, i.e. to determine whether a product, its components, subassemblies, or starting materials conform to the design specifications established by the product designer, inspection is needed before, during, and after manufacturing.

Manual inspection, also known as naked eye inspection, was, is and will be a major inspection method used in manufacturing. In theory, human inspectors can be utilized to detect missing components. However, in practice, continuous miniaturization and the increasing speed of assembly of these components make human inspection obsolete and the use of industrial vision inspection systems a necessity. Over the last thirty years, more and more of the researchers' attentions have been attracted to automatic vision inspection systems. A great deal of research has already been carried out to meet the demands of automatic vision inspection systems in industry. These systems have been applied in dimensional analysis, on-line inspection, and component quality control [1]. A lot of industrial activities have benefited from the application of industrial automatic vision 1

inspection

systems.

These

activities

include

delicate

electronics

component

manufacturing [2-3], quality textile production [4], printing [5], circuits manufacturing [6], agriculture [7] and others. This technology improves productivity and quality and provides a competitive advantage to industry.

In most of cases, the vision inspection system utilizes a 2-D digital camera to obtain image information of the object being inspected. The image is sent to a computer system to be processed and a final decision as to whether the object being inspected is qualified or not is sent out from the computer back to operator. The application of 3-D laser scanner technology was introduced to industry in recent years. A 3-D laser scanner is a device that analyzes an object by collecting data of its shape and is widely used in industrial design, plastic surgery, reverse engineering, rapid prototyping, quality control, product inspection and even crime scene recreation.

There are many image processing techniques useful for machine vision inspection. The choice of the technique is primarily based on the type of inspection and application. Various algorithms have been developed to process the spatial data obtained by different measurement equipment in order to achieve different inspection tasks. However, the potential of industrial vision inspection systems has not yet been fully exploited. For example, to date, the vision inspection systems are mainly used as a screening inspection, and the identification and removal of defective products, rather than as a process for continuous improvement of a manufacturing system.

2

1.2

Objective of the thesis research

The objective of the research is to develop a new spatial data analysis method for inspection of shape errors of manufacturing parts. This method will be used to analyze spatial data for 1-D, 2-D and 3-D geometries that are digitized by a laser scanner. The method transforms spatial data into its harmonic information including frequency, amplitude and phase. An analysis method is developed to relate the harmonic information of spatial data to different types of shape error. Experiments are carried out to verify the method on MIG weld inspection.

The scopes of this research include:      Process 2-D curves using 1-D Fourier transform Extend 1-D Fourier transform to 3-D shapes using a slicing approach Process 3-D shapes using 2-D Fourier transform Analyze shape characteristics based on the frequency spectrum Relate shape characteristics with GD&T shape errors (profile of a line and profile of a surface)      Apply spatial data analysis method on MIG weld size and shape error inspection Apply 2-D FFT on 3-D scanning point cloud to check overall shape error Apply 1-D FFT on 2-D projection data to check type of defects Develop a projection method for leg size inspection. Develop an automatic system for MIG weld inspection for production use

3

1.3

Organization of the thesis

This thesis is organized into seven chapters:  Charter 1 is the introduction of the thesis.

 Chapter 2 reviews the types of inspection methods, previous approaches of industrial vision inspection and current spatial data analysis methods used in different manufacturing inspection.  In Chapter 3, a new spatial data analysis method is introduced. The method can be applied for 1-D curves, 2-D curves and 3-D shapes. This chapter explains how a spatial data can be represented by harmonic information: frequency, amplitude and phase.  Chapter 4 introduces the application of proposed spatial data analysis method to GD&T standards. This chapter also introduces how to apply this method into 2-D curve and 3-D shape inspection.  In Chapter 5, the experiments of spatial data analysis methods on MIG weld inspection are presented. The method is tested on 2-D projection data and 3-D scanning data directly.  Chapter 6 introduces the implementation of a 3-D laser scanner MIG weld inspection system. System algorithms, software development, and hardware components are presented.  Chapter 7 summarizes conclusions, contributions and discusses future work.

4

CHAPTER 2 LITERATURE REVIEW
In this chapter, firstly, commonly used industrial inspection methods are reviewed. Next, 3-D laser scanning technologies is reviewed, which is followed by the study of current spatial data analysis methods for 1-D curves, 2-D curves and 3-D shapes.

2.1

Inspection methods review

Generally, inspection methods can be divided into manual inspection and computer aided inspection. Manual inspection uses mechanical measuring tools such as gauges. Computer aided inspection uses sensing devices, and can be divided into contact and noncontact methods. Contact methods probe the subject through physical touch. A coordinate measuring machine (CMM) is an example of a contact 3-D scanner. It is used mostly in manufacturing and can be very precise.

Figure 2.1: Coordinate Measurement Machine 5

The disadvantage of CMMs is that they require contact with the object being scanned. Thus, the act of scanning the object might modify or damage the object. This is very significant when scanning delicate or valuable objects such as historical artifacts. The other disadvantage of CMMs is that they are relatively slow compared to other scanning methods. Other contact methods are the hand driven touch probes used to digitize clay models in the computer animation industry.

Non-contact inspection methods utilize a sensor located at a pre-defined distance from the object's surface to measure or gage the desired features. Compared to contact methods, non-contact inspection technologies give a greater flexibility in the digitization of surfaces and can provide for higher resolution. Moreover, contact methods can measure only one criterion each time, i.e. a part being inspected may need more than one measurement for dimension accuracy, form accuracy and surface defects. For non-contact methods, these can be done at the same time.

Non-contact inspection technologies include sound waves, X-rays, magnetic waves, lasers, etc. which can be classified as optical and non-optical. Among these methods, optical technology is generally preferred. Currently, optical technology is mainly based on cameras or on laser scanners. Cameras translate a three dimensional scene of objects being inspected into a two dimensional digital photogrammetry. Laser scanners analyze a real-world object or environment to collect data on its shape. A laser scanner usually creates a point cloud of geometric samples on the surface of the subject. These points can then be used to generalize the shape of the subject; this process is called reconstruction. 6

Optical inspection technology is widely used to build machine vision systems in recent research. Machine vision systems are referred to as automated vision inspection, and those have been applied to a variety of manufacturing applications, all with the goal of improving quality and productivity in manufacturing processes [8]. Machine vision may be described as the acquisition and analysis of vision information. Typically, an industrial vision inspection system can be decomposed into a sequence of processing steps [9 - 11]: image acquisition to acquire images by a digital camera or laser scanner; image enhancement to improve the quality of the image for subsequent processing; defect recognition to detect defects by comparing the current image with a template image; defect classification to classify the defect type by feature extraction and classification; and decision making to decide if the image should be judged as good or defective.

2.2

3-D laser scanning technology

3-D laser scanning technology has been widely used in recent years. Its high precision, quick speed, the simplicity of handling, the strong anti-interference ability and the convenient data processing make it increasingly accepted. The large-sized, complex, anomalous and non-standard entity can be real-time measured, digitized, modeled in the computer and analysis can be easily carried out. A 3-D scanner is a device that collects the shape information in form of 3-D coordinates. The collected information, defined as point clouds can then be used to construct three dimensional models useful for a wide variety of applications. Some common applications of this technology include reverse engineering, industrial design, computer vision, inspection and documentation of cultural 7

artifacts. The point clouds collected by 3-D scanners are usually not used directly. Most applications do not use point clouds, but instead use polygonal 3-D model. The process of converting a point cloud into a polygonal 3-D model is called reconstruction or meshing. Reconstruction involves finding and connecting adjacent points in order to create a continuous surface. The reconstructed 3-D models can then be used for further applications.

The majority of the employed scanners use optical methods for capturing and measuring three-dimensional surfaces. In general, capturing and measuring spatial structures can be divided into three different basic approaches: triangulation, structured light and contact scanning methods. Due to their flexible application, optical triangulation methods have seen the greatest use in industry [12].

The triangulation method is an active scanner that emits a structured laser light to scan the environment. The triangulation 3-D laser scanner shines a laser on the subject and uses a camera to look for the location of the laser dot. Depending on how far away the laser strikes a surface, the laser dot appears at different places in the camera's field of view. Figure 2.2 shows how a triangulation 3-D laser scanner works. This technique is called triangulation because the laser dot, the camera and the laser emitter form a triangle. The length of one side of the triangle, the distance between the camera and the laser emitter is known. The angle of the laser emitter related to the camera is also known. The distance of the object from the camera can be determined by looking at the location of the laser dot in the camera's image. These three pieces of information fully determine the 8

shape and size of the triangle and gives the location of the laser dot. In most cases a laser stripe, instead of a single laser dot, is swept across the object to speed up the acquisition process.

Figure 2.2: Triangulation laser scanner

Many hand-held and portable laser scanner can be found in market. Hand-held laser scanners create a 3-D image through the triangulation mechanism described above. A laser dot or line is projected onto an object from a hand-held device and a sensor measures the distance to the surface. Figure 2.3 is an example of a hand-held laser scanner.

Figure 2.3: Hand-held laser scanner 9

Spatial data is collected in relation to an internal coordinate system. Therefore to collect data where the scanner is in motion and the position of the scanner must be determined. The position can be determined by the scanner using reference features on the surface being scanned (typically adhesive reflective tabs) or by using an external tracking method (external encoder). This data is sent to a computer and recorded as data points within three-dimensional space; with processing this can be converted into a triangulated mesh and then a computer-aided design model to be used by other applications. Handheld laser scanners can also combine this data with passive, visible-light sensors - which capture surface textures and colors - to rebuild a full 3-D model. The point clouds produced by 3-D scanners can be used directly for measurement and visualization in the architecture and construction world.

A lot of areas have benefited from 3-D laser scanning, including entertainment, reverse engineering, arts, medical and manufacturing. 3-D scanners are used by the entertainment industry to create digital 3-D models for both movies and video games. In cases where a real-world equivalent of a model exists, it is much faster to scan the real-world object than to manually create a model using 3-D modeling software. Frequently, artists sculpt physical models of what they want and scan them into digital form rather than directly creating digital models on a computer.

Reverse engineering of a mechanical component requires a precise digital model of the objects to be reproduced. Rather than a set of points, a precise digital model can be represented by a polygon mesh, a set of flat or curved NURBS surfaces, or a CAD solid 10

model. A 3-D laser scanner can be used to digitize free-form or gradually changing shaped components as well as prismatic geometries, whereas a coordinate measuring machine is usually used only to determine simple dimensions of a highly prismatic model. These data points are then processed to create a usable digital model, usually using specialized reverse engineering software.

There have been many research projects undertaken via the scanning of historical sites and artifacts both for documentation and analysis purposes. The combined use of 3-D scanning and 3-D printing technologies allows the duplication of real objects without the use of traditional plaster casting techniques, which in many cases, can be too invasive for precious or delicate cultural heritage artifacts[13].

3-D laser scanners are also used in medicine to capture the 3-D shape of a patient in orthotics and dentistry. It is gradually supplanting tedious casting methods. A CAD/CAM software is then used to design and manufacture the orthosis,

prosthesis or dental implants. Many chair side dental CAD/CAM systems and Dental Laboratory CAD/CAM systems use 3-D laser scanner technologies to capture the 3-D surface of a dental preparation.

The digitalization of real-world objects is of vital importance in various application domains. This method is especially applied in industrial quality assurance to measure the geometric dimension accuracy. Industrial processes such as assembly are complex, highly automated and typically based on CAD data. The problem is that the same degree of 11

automation is also required for quality assurance. It is, for example, a very complex task to assemble a modern car, since it consists of many parts that must fit together on the production line. The optimal performance of this process is guaranteed by quality assurance systems. Especially the geometry of the metal parts must be checked in order to assure that they have the correct dimensions, fit together and finally work reliably.

Within highly automated processes, the resulting geometric measures are transferred to machines that manufacture the desired objects. Due to mechanical uncertainties and abrasions, the result may differ from its digital nominal. In order to automatically capture and evaluate these deviations, the manufactured part must be digitized as well. For this purpose, 3-D scanners are applied to generate point samples from the object's surface which are finally compared against the nominal data.

The process of comparing 3-D data against a CAD model is referred to as CADCompare, and can be a useful technique for applications such as determining wear patterns on molds and tooling, determining accuracy of final build, analyzing gap and flush, or analyzing highly complex sculpted surfaces. At present, laser triangulation scanners, structured light and contact scanning are the predominant technologies employed for these industrial purposes, with contact scanning remaining the slowest, but overall most accurate option.

The disadvantages of 3-D laser scanning technology are the high cost, data handling, registration, modeling, noise, etc. Since the 3-D laser scanner is limited to its field of 12

view, there is a danger of occlusions where the laser light path is blocked by obstructions (possible solutions for this are several scan passes). The high costs of a reliable scanner unit have to be considered as another disadvantage. Moreover, a complete scanning system has to be calibrated so that the geometrical disposition of all the elements can be determined exactly. A 3-D laser scanner has special requirements to the object surface being scanned. To obtain better scanning quality and less noise, a layer of white powder spray paint or powder coating is required as a preprocessing procedure. Another disadvantage of this method is the time required for the digitization of large surfaces.

2.3

Current spatial data analysis methods

The objects or parts being inspected are described in one dimensional, two dimensional or three dimensional modeling in different applications. One dimensional (1-D) modeling can be an edge profile or a grey level profile of one specific line in an image. Most of published works were carried out based on color or grey scale images taken by camera which is a two dimensional (2-D) modeling. In general, for a 2-D modeling inspection, they fall into one of three categories: reference comparison (or referential approaches), non-referential approaches, and hybrid [14]. The reference methods execute a real pointto-point (or feature-to-feature) comparison between the image to be inspected and the "standard" image. Therefore, 2-D modeling has its advantages in texture analysis and shape analysis.

13

Although some defects can be found with 2-D inspection, 3-D volume measurement results in higher accuracy. In most published works, 3-D modeling is obtained from a set of 2-D images taken by a CCD camera, whose image can be either a gray scale or color image. Different techniques are used to reconstruct the 3-D modeling from 2-D images including stereovision techniques, shape from shading techniques (SFS), etc. For the 2-D based methods that detect 3-D shapes indirectly from a surface inclination, they have the inherent limitation of being unable to describe the shape of the surface precisely. The main advantages of this approach are simple instrumentation and the speed of acquisition; on the other hand, the accuracy of the reconstructed surface is quite poor. The best way to obtain a 3-D modeling is to use a 3-D laser scanner. 3-D laser scanners provide more accurate results with less computational cost for a 3-D shape analysis. 3-D modeling is represented by point clouds (See Figure 5.8 in Chapter 5). A point cloud is a set of vertices in a three-dimensional coordinate system. These vertices are usually defined by X, Y and Z coordinates. Point clouds themselves are generally not directly usable in most 3-D applications, and therefore are usually converted to triangle mesh models, NURBS surface models, or CAD models through a process commonly referred to as reverse engineering so that they can be used for various purposes.

Dimensional modeling can be further divided into two categories: open geometry and close geometry. Point or an edge modeling, 1-D modeling, is an open geometry. A closed contour or curve, 2-D modeling, is a close geometry. One major application of a closed contour is shape analysis. The goal of shape analysis is to find a shape description of a closed contour which contains sufficient information to distinguish between differently 14

shaped regions or objects in a 2-D image. Table 1 lists typical inspection problems. The data representations and geometry characteristics used by researchers are also listed.

Table 2.1: List of inspections, data representation and geometry characteristics Data Applications Representation TFT-LCD defect detection [15] Label printing [16] Texture inspection [17] PCB soldering inspection [4, 18] Medicine [19] Weld shape inspection [2] 1-D 1-D or 2-D 2-D 2-D or 3-D 2-D or 3-D 2-D or 3-D Characteristics Open Open or close Close Close Close Close Geometry

Different algorithms were developed for different dimensional modeling. For 1-D modeling, the 1-D Fourier transform and its inverse transform are popular algorithms [17]. Area calculation, histogram analysis, boundary following, image subtraction and feature matching are techniques used for 2-D modeling. Fourier analysis has also been applied to interpret two dimensional plane shapes in geography and cartography. 3-D modeling inspection methods can be split in two categories: 2-D based (image-based) and 3-D based (CAD model based). Techniques used for 2-D based inspection include shape

15

from shading (SFS), curve fitting, etc. The details of these algorithms are reviewed below.

2.3.1 Methods for 1-D modeling inspection
Tsai and Huang [15] introduced an automatic defect inspection method for a patterned thin film transistor-liquid crystal display (TFT-LCD) panels using one-dimensional Fourier reconstruction and wavelet decomposition. Figure 2.4 demonstrates the magnified two dimensional image of a TFT-LCD panel at a resolution of 60 pixels per mm. Their method directly works on the 1-D line images and fully uses the inherent geometric structure of a TFT-LCD panel. The problem of defect detection in TFT-LCD panel surfaces can be considered as the identification of anomalies in a periodic 1-D grey-level signal, see examples in Figure 2.4.

Figure 2.4: Surface image of a TFT-LCD pannel [15] It first eliminates the frequency components that represent the periodic pattern of a TFTLCD line image in the 1-D Fourier spectrum and then back-transforms the 1-D Fourier domain image to the 1-D spatial domain image using the inverse Fourier transform. The 16

Fourier reconstruction process can effectively remove the patterned background and distinctly preserve local anomalies in the resulting 1-D image. Wavelet decomposition is further applied to remove uneven illumination in the filtered image so that defects can be easily segmented with simple statistical control limits.

Figure 2.5: Four horizontal grey-level profiles for the TFT-LCD panel image in Figure 2.4 [15]

For a faultless TFT-LCD line image, the reconstruction process will result in a flat horizontal line, see Figure 2.5(a) and (b). Conversely, high fluctuation of a line will be generated in the reconstruction for a defective TFT-LCD line image, see Figure 2.5 (c) and (d). The simple statistical process control limits can then be used to set up the thresholds for distinguishing between defective segments and uniform background in each reconstructed 1-D line image. 17

2.3.2 Methods for 2-D modeling inspection
There are many image processing techniques useful for 2-D modeling inspection. These techniques include area calculation, histogram analysis, boundary following, image subtraction and feature matching [8, 20-22]. The choice of the techniques is primarily based on the types of inspection and application [23]. Figure 2.6 is an example of automated visual inspection for microdrills in printed circuit board production. The colour images of microdrills are first derived, and the boundary of the lip relief plane is extracted, the red lines in Figure 2.6(b). A robust K-curvature corner detection algorithm is then used to detect the corners on the blade boundaries and to split boundaries into segments. The least-squares linear regression method is used to fit the segments into linear equations. With the fitted equations, the intersections on the boundaries of two facets are located and their distances (gap or overlap) are measured. In addition, the defects of taper and flare are identified by comparing the angle measurements with predefined specifications.

(a)

(b)

Figure 2.6: Color image thresholding and boundary following for a microdrill inspection: (a) original image, (b) color thresholding and boundary following [23] 18

Fourier analysis, named after Joseph Fourier's introduction of the Fourier series, is the decomposition of a function with sinusoidal functions of different frequencies that can be recombined to obtain the original function. Fourier analysis has been applied to interpret two dimensional plane shapes in geography and cartography. A Dual Axis Fourier Shape Analysis method was introduced by Moellering and Rayer, which can decompose a 2-D curve into a harmonic series and has been used in geography and cartography for analyzing the geometry of the surveyed data [24].

Moellering, et al. [24-27] applied Fourier transform techniques on closed 2-D contours for shape analysis and classification. Their results show that a 2-D figure can be decomposed into its shape frequency components where these components, variance, and modulus ratio can be directly interpreted in terms of the importance, ellipiticity, and rotation of each frequency.

2.3.3 Methods for 3-D modeling inspection
In general, automated 3-D modeling inspection methods can be split in two categories: 2D based and 3-D based. In most of published works, a 3-D inspection is carried out based on a 2-D image taken by a CCD camera, this image being either a gray scale or color image. These methods need an extra preprocessing to convert 2-D data into 3-D data. Du [1] and Kong [18] obtained the 3-D shape parameters of weld joints by using a shape from shading (SFS) technology. Xi [28] and Garcia [29] introduced a CAD-based method that is to analyze and characterize the shape error by a set of components that are decomposed using the Fourier transform. 19

It is clear that, for a 3-D shape inspection, using the 3-D spatial data obtained from a laser scanner is a straightforward and simple way than using a 2-D gray scale image. More importantly, using a 3-D spatial data can avoid the errors in reconstructing the 3-D image from a 2-D image. The shape parameters or shape errors can be acquired by applying the appropriate subsequent processing algorithms.

2-D based methods - Shape from shading (SFS) technology Shape recovery is a classic problem in computer vision. The goal is to derive a 3-D scene description from one or more 2-D images. In computer vision, the techniques to recover shape are called shape from X techniques, where X can be shading, stereo, motion, texture, etc [18]. Shape from shading (SFS) deals with the recovery of the shape from a gradual variation of shading in the image. Among various visual inspection techniques, SFS has its advantages that (1) it is simple to install devices, (2) the cost of the inspection devices is lower and they do not require a special expensive illumination source, for instance, a structured light, and (3) it is easy to implement because it avoids complicated calibration procedures and image-matching in the subsequent data processing [2]. The technology is widely used for remote sensing, and pattern recognition.

In SFS, given a gray scale image, the aim is to recover the light source and the surface shape at each pixel in the image. SFS techniques can be divided into four groups: minimization approaches, propagation approaches, local approaches and linear approaches. Du [1] and Kong [18] presented their weld joint inspection method by using SFS technology. Du recorded the image of the weld bead with an optical sensing method 20

and then calculated the 3-D shape parameters with the shape from shading technology based on a single image in the computer vision domain. Du's algorithm is a minimization approach. The algorithm is implemented using a hierarchical structure or called pyramid structure in order to reduce the computation time. Also the resolution of the image is reduced by a factor of two between adjacent resolution layers. This may cause information loss to a certain extent.

Du tested the algorithm on a synthetic image of a sphere. The experiments show that there is a rotation distortion on boundary conditions and there are bigger errors in the brighter region along the illuminant direction. Du improved the algorithm by adding proper boundary conditions and adjusting the factor of brightness error function adaptively. The implemented algorithm is tested on the detection of a weld bead shape. To obtain better results, a specific illumination structure must be set up first. The experiments showed a certain degree of reconstruction errors due to the deviation between the practical surface albedo and ideal.

Kong [18] and Takagi [30] also introduced similar inspection algorithms in SFS technology. The differences between their methods are changes in the illumination structure and the shape reconstruction algorithms. Kong applied a closed ring light source to avoid out-source illumination. The shape recovery algorithm of Kong is similar to Du's.

21

Takagi introduced a tiered illumination system which has two tiered ring light sources arranged at two different angles. Images taken by a TV camera are gray scale images. By using the gray-scale values on the soldered surface in the images, each picture element in the inspection object area is divided into flat sections and slanted sections. The change in the pattern at the center portion of the soldered section forms a symbol string. The obtained symbol string can be classified and be used for error inspection. Takagi also introduced an image processing algorithm to improve the inspection accuracy.

2-D based method - Curve fitting method Yu [31] proposed a least square fitting algorithm for solder joint shape inspection. The profile image of solder joint shape is curve fitted by using least square fitting. Then the approximate ideal circle parameters including center and radius are estimated. The deviation between solder joint shape and the approximate ideal circle is used as an inspection measure. This method has its limitation that it is only suitable for inspection of a regular round shape joint, with need of image preprocessing steps for noise removal, registration and edge detection.

An inspection method based on laser vision sensing is adopted by Fu [32]. Firstly, a laser stripe image is acquired with a laser vision sensor based on principles of optical triangulation. Then the acquired laser stripe image is processed by medium filter, binary processing, laser stripe centerline extraction, and feature recognition algorithms. At last, the information about weld shape dimension is obtained. The laser stripe images are taken on each cross section on the fillet weld, and the curve fitting is carried out for all 22

the cross sections. To obtain high accuracy, cross sections must be scanned and inspected as many as possible. Obviously, this process is time consuming and repetitious.

Although 2-D inspection is still more prevalent than automated 3-D inspection practiced in industries a recent study revealed that automated 3-D inspection is preferred by many companies [18].

3-D based methods Xi [28], Garcia [29] and Prieto [33] presented methods based on the CAD model of parts being inspected. Garcia and Prieto acquired the spatial data of the parts being inspected by setting up their own image acquisition system. They all discussed the strategies on how to obtain an optimum 3-D data in their paper. Their inspection methodologies are quite similar which compared a cloud of 3-D points with the CAD model of the part. The CAD model is used for both registration and reference purposes. Their CAD model based inspection methods can be regarded as a three-dimensional reference method which executes a segment-to-segment (or feature-to-feature) comparison between the model to be inspected and the standard CAD model. A 3-D shape error analysis is presented by Xi which can be applied to analyzing 3-D shapes. Xi's method extends Moellering and Rayer's concept of curve harmonics from 2-D into 3-D based on the spatial modal expansion method. Xi tested his method with a simulation model and a rapid prototyping part made by stereo lithography. Tests show that a 3-D geometry can be considered as being formed by a series of modal expansions, and as such a 3-D shape error can be analyzed by the 2-D Fourier transform. 23

2.4

Summary

In this chapter, commonly used inspection methods are reviewed; follow by the introduction of 3-D laser scanning technology. The previous approaches of industrial vision inspection and spatial data analysis methods used in different manufacturing inspection are reviewed. The advantages and disadvantages of these methods are discussed. Most of current inspection algorithms are point based methods. These methods apply a point-to-point comparison between the spatial data set under inspection and a standard spatial data set. Though the point based methods can separate bad parts from good parts, they cannot reveal the shape characteristics of a spatial data set, hence not able to disclose the defect type of a bad part. The method proposed in this thesis is a frequency based method which decomposes a spatial data set into their spatial frequency components. By studying frequency, amplitude and phase, this method can be used to not only detect defects but also reveal their types. Furthermore, by linking the shape errors with system inputs, a diagnosis system can be achieved to identify the source of the shape error.

24

CHAPTER 3 SPATIAL DATA ANALYSIS METHOD
The deformable body concept is widely used by researchers in the CAD modeling and computer vision areas. The idea is to represent an object by a set of well-defined primitives (components). These graphic primitives (or called base geometry) are a set of functions which include 2-D and 3-D points, lines, polygons, curves, surfaces and polyhedra. These primitives are stored in a database which is combined with a rendering mechanism such as meshing, and used to visualize the object from its surface representation. By changing (deforming) the shape of the base geometry or the connection between the base geometries, the shape of the 3-D shape will change.

In this chapter, the concept of deformable body is adopted to develop a spatial data analysis method. Through the introduction of decomposition of a 2-D curve into its x and y series, a new method is proposed to decompose a 3-D shape into two 2-D plane series either using parametric equations or a slicing method. The details are discussed in the following sections.

25

3.1

2-D Problem ­ Parametric Equations

A curve in the Cartesian coordinate system is said to be parameterized if the set of coordinates on the curve, ( x, y) , are represented as functions of a variable t .The variable

t is called a parameter and the relations between x, y and t are called the parametric
equation. There are several advantages of parametric equations over the Cartesian equations. First of all, parametric equations are able to describe more curves in a "functional" way. Second, the curves from parametric equations have an "orientation" to associate a direction to the curve. For example, it is easy to write the equation of a circle centered at the origin with radius r as: x2  y 2  r 2 A circle of radius r equal to 1mm is plotted in Figure 3.1, (3.1)

Figure 3.1: A circle with radius of 1 Using the parametric equations, variable x and y can be rewritten as a function of t ,
x  r cos(t ) y  r sin(t )

(3.2) (3.3)

26

where 0  t  2 . If the circle is a closed curve, in a single cycle, t is changing from 0 to
2 . For an open curve, t is changing from 0 to angle  . If the number of sampling point

is N, then


also,

2 N

(3.4)

  2 f

(3.5)

therefore, spatial frequency is f  1 N (3.6)

Variable x and y of the circle with sampling points of 100 can be viewed as two series of sinusoids with the same single frequency and the same amplitudes. These two waves are plotted as in Figure 3.2

Figure 3.2: Graph of x and y series' parametric equations 27

In line with the concept of deformable bodies, the circle can be chosen as a base geometry because it only contains a single sinusoid in x and a single sinusoid in y. If the amplitudes of x and y series are different, the function will plot an ellipse. If a second frequency is added onto both x and y series, some interesting figures can be created. More examples will be discussed in the later sections.

In reality, not all 2-D curves are as simple as a circle. Therefore, harmonic analysis is introduced to obtain the parametric equations of a geometric shape. For a given closed plane curve, firstly, it can be digitized as a Cartesian pair ( x, y) at a uniform arc length interval. The digitization produces two orthogonal series, x and y; each will be subject to harmonic analysis separately. As shown by Fourier, so long as it is continuous and singlevalued and has a finite set of maxima and minima, a series can be represented exactly by a set of sinusoids. This is essentially accomplished by the least-squares fitting of the amplitudes of sine and cosine functions for integer frequencies. The result is that N equally spaced intervals are replaced by n amplitudes, for series x,
AX [ k ]  iBX [ k ]  1 n 1 2 jk x[ j ]exp( i )  n j 0 N

(3.7)

where AX[k] and BX[k] are the amplitudes of the cosine and sine curves at frequency k/N. The Fourier transform is particularly valuable due to its reversibility, which is a quite desirable property of shape quantifiers. It is given as
x[ j ]   ( AX [k ]  iBX [k ]) exp(i
k 0 n 1

2 jk ) N

(3.8)

28

In the other words, the reversibility may be used to generate N equally spaced intervals from the N amplitudes. The y series will have a similar result to x series that is

AY [k ]  iBY [k ] 

1 n 1 2 jk y[ j ]exp(i )  n j 0 N

(3.9)

Likewise, the reverse transform is written as
y[ j ]   ( AY [k ]  iBY [k ]) exp(i
k 0 n 1

2 jk ) N

(3.10)

The amplitudes Ax  k  , Ay  k  and the phases  x  k  ,  y  k  of the sinusoid at frequency k are calculated as,
Ax  k   Ay  k  

 AX  k    BX  k 
2

2

(3.11)

 AY  k    BY  k 
2

2

(3.12)

x  k   tan 1

AX  k  BX  k 
AY  k  BY  k 

(3.13)

 y  k   tan 1

(3.14)

Figure 3.3 is the Fourier transform on x and y series of the circle. Figure 3.3(a) is the amplitude vs. frequency of x series. Figure 3.3(c) is the amplitude vs. frequency of y series. The comparison of Figure 3.3(a) and Figure 3.3(c) shows that x and y series have some amplitude for a circle. Figure 3.3(b) and Figure 3.3(d) are the phase vs. frequency of x and y series. The results show that x and y series of a circle have different phases.

29

Figure 3.3: Fourier transform on x and y series of a circle

The coordinate pair x, y may be also written in complex notation x  yi . The Fourier transform equation is

X  k   iY  k  

1 n 1  2 jk  x  j   iy  j  exp  i    n j 0 N  

(3.15)

and the reverse transform is

n 1  2 jk  x  j   iy  j     X  k   iY  k  exp  i   N  k 0

(3.16)

where
X  k   AX  k   BY  k 

(3.17)

30

Y  k   BX  k   AY  k 

(3.18)

and the components AX , BX , AY and BY may be extracted by using the symmetry in Fourier series,

 AY  k  

Y  k   Y  k 
2

(3.19)

Where k  n  k . The modulus of the complex amplitude X  k   iY  k  is given by
AXY  k   X  k   iY  k  

 X  k   Y  k 
2

2

0k n

(3.20)

The phase   k  is given by

xy  k   tan 1

X k  Y k 

(3.21)

The results of Fourier transform bring additional distinctive information of a 2-D curve by calculating the cross correlation between x and y series. These information also include the cross correlation of frequency, amplitude and phase.

Therefore, for a given 2-D geometric shape, by applying Fourier transform on x, y series, a group of characteristics indices can be obtained. These characteristics indices are frequency, amplitude Ax  k  , Ay  k  and AXY  k  , phase  x  k  ,  y  k  and xy  k  , cross correlation of x and y series Ax  y and x  y , all these can be simply written as,
k x  [ f x , Ax ,  x ]
k y  [ f y , Ay ,  y ]

(3.22) (3.23)

31

and the cross-correlation k x  y between k x and k y is
k x  y  [ f x  y , Ax  y ,  x  y ]

(3.24)

Each 2-D geometric shape has its own unique characteristics indices. The applications of characteristics indices might include pattern recognition, text detection, inspection, and so on. In this research, the characteristics indices are utilized for quality inspection of MIG welds. The detail is discussed in Chapter 4 and 5.

3.2

Fourier transform for 2-D curve

To illustrate the value of harmonic analysis and to explain how to use the harmonic analysis on a given 2-D curve, a number of examples are discussed in this section. First, a set of cycloids is generated from pairs of frequencies and amplitudes to demonstrate how the components are combined to create protrusions and indentations. Second, a set of 2-D geometric shapes are decomposed. As mentioned in the previous sections, if a second frequency is added to the parametric equations of the circle, some interesting shapes can be formed. The equations are shown below:

x  a cos( )  a cos( f  ) y  a sin( )  a sin( f  )

(3.25) (3.26)

where a is the radius of the cycloid, a is the amplitude ratio, f is frequency ratio. These parameters are also called Fourier coefficients. Figure 3.3 shows the cycloids generated by taking various ratios of the amplitudes and of the frequencies of Fourier

32

components. The frequency ratios range from 1:-5 to 1:-2 and 1:2 to 1:5 and nine amplitude ratios are between 50:1 and 1:50.

Figure 3.4: Cycloids generated from Fourier coefficients Several interesting shapes can be found in Figure 3.3. One occurs when the frequency ratio is A:B and the amplitude ratio is B:A, for example, when the frequency ratio is 1:3 and the amplitude ratio is 3:1. The positive/negative frequency ratios produce external cusps of the order n+1 and the positive/positive frequency ratios produce internal cusps of the order n-1, One can also identify a cusp line when the frequency ratio is 1:-1 and the amplitude ratio is 1:1. The shapes of the bicycloids gradually become more circular from the cusp line as it proceeds upward and downward. The figures are very circular when amplitude ratios reach 1:50 or 50:1. The difference between the top rows and the bottom 33

rows is that in the top rows the locus goes around as many times as the higher frequency specifies and the locus in the bottom rows only goes around once because it is dominated by the first frequency. The example of cycloids generation shows that by combining two simple frequencies, some interesting cycloids can be formed. In general, the more frequencies added the more complex the shape will be.

From the cycloid generation it becomes clear that by combining a very few frequency components, simple figures can be created. To verify the method, the next step is to analyze some standard geometric shapes. A square with size of 10mm by 10mm is decomposed, as shown in Figure 3.5.

Figure 3.5: A 10mm by 10mm square

The square is digitalized into 40 uniform length intervals. The x and y series each contain 41 points (N=41) including the start and end points, and are plotted as shown in Figure 3.6.

34

Figure 3.6: Graph of x and y series of the 10 by 10 square

The Fourier transforms of x and y series are shown in Figure 3.7. In this research, MATLAB is used to perform Fourier transform as well as the reverse transform. The fast Fourier transform (FFT) algorithm of MATLAB returns the discrete Fourier transform (DFT) of vector X, computed with the FFT algorithm. The function fft(X,N) returns the N-point DFT. If the length of X is less than N, X is padded with trailing zeros to length N. If the length of X is greater than N, the sequence X is truncated. When X is a matrix, the length of the columns is adjusted in the same manner. In this example, N is set to be the default length same as X. The reverse transform is performed by the function ifft. ifft(X) returns the inverse discrete Fourier transform (DFT) of vector X, computed with a 35

fast FFT. ifft(X,N) returns the N-point inverse DFT of vector X. In this example N is the length of X, which is 41. Series y is calculated using the same algorithm as series x. Figure 3.7 show that the Fourier transform of a square has similar results as a circle. The x and y series have same amplitudes but different phases.

Figure 3.7: Fourier transfrom of x and y series of a square The Fourier transform of the complex notation x+yi is plotted as shown in Figure 3.8. Figure 3.8(a) shows the relationship of amplitude and frequency. Figure 3.8(b) is phase versus frequency.

36

Figure 3.8: Fourier transform of x+yi of a square

The Fourier transform of the square in this example is decomposed into 41 frequencies. The amplitude and phase of each frequency k can be calculated as the way it is explained in previous section. To perfectly represent the shape, the complete information of all 41 frequencies is needed. Figure 3.9 shows the results of combination of different amount of components. Figure 3.9(a) clearly shows that the square has a base figure of circle. With more components add-on, the four corners of the square are becoming sharper. The square becomes perfect until all frequency components are added together.

37

Y (mm)

Y (mm)

X (mm)

X (mm)

(a): frequency1 to 2

(b): frequency 1 to 8

Y (mm)

Y (mm)

X (mm)

X (mm)

(c): frequency 1 to 20

(d): frequency 1 to 35

Y (mm)

X (mm)

Y (mm)

X (mm)

(e): frequency 1 to 40

(f): full frequency

Figure 3.9: Combination of frequency 38

The second geometric shape being analyzed is a cross, as shown in Figure 3.10. The size of the cross is 21mm by 21mm. The cross is digitalized into 84 uniform length intervals. The x and y series each contain 85 points including the start and end points, and are plotted as shown in Figure 3.11.

Figure 3.10: A 2-D cross shape

Figure 3.11: x and y series of the cross 39

The Fourier transforms of x and y series are shown in Figure 3.12. Figure 3.12(a) and 3.12(c) are the amplitude versus frequency of x and y series. Figure 3.12(b) and 3.12(d) are the phase versus frequency of x and y series. Same results can be seen from Figure 3.12 that x and y series of a cross have same amplitudes but different phases.

Figure 3.12: Fourier transforms of cross' x and y seires

The Fourier transform of the complex notation x+yi is plotted as shown in Figure 3.13. Figure 3.13(a) is the amplitude versus frequency and Figure 3.13(b) is the phase versus frequency.

40

Figure 3.13: Fourier transform of cross' complex notation x+yi Similar to the analysis of the square, the Fourier transform of the cross in this example is decomposed into 85 frequencies. To perfectly represent the shape, the complete information of all 85 frequencies is needed. Figure 3.14 shows the results of combination of different amount of components. Figure 3.14(a) clearly shows that the cross also has a base figure of circle. Unlike the square, with more components add-on, the four corners of the circle are becoming internal cusps. The cross becomes perfect until the last frequency is added, see Figure 3.14(f).

41

Y (mm)

Y (mm)

X (mm)

X (mm)

(a): frequency 1 to 5

(b): frequency 1 to 10

Y (mm)

Y (mm)

X (mm)

X (mm)

(c): frequency 1 to 70

(d): frequency 1 to 80

Y (mm)

X (mm)

Y (mm)

X (mm)

(e): frequency 1 to 83

(f): full frequency

Figure 3.14: Combination of frequency 42

The examples of the square and cross shows that a given 2-D geometric shape can be decomposed into frequency, amplitude and phase components by using harmonic analysis. Every shape has its own distinctive set of characteristics indices: frequency, amplitude and phase. To fully represent a 2-D curve, the complete set of characteristics indices must be used.

3.3

Fourier transform for 3-D shape

By extending the concept of curve harmonics from 2-D into 3-D, changes in a 3-D shape may be considered in terms of amplitude and frequency ratios with respect to a selected basis. In this case, a sphere is used as a base geometry by using spherical coordinates in a parametric form:
x  a sin( ) cos( ) y  a sin( ) sin( ) z  a cos( )

(3.27) (3.28) (3.29)

where a is the radius,  is 0  180 , and  is 0  360 . After adding the amplitude and frequency ratios, the new equations are:
x  a sin( ) cos( )  a sin( f )a cos( f  ) y  a sin( ) sin( )  a sin( f ) a cos( f  )
z  a cos( )  a cos( f )

(3.30) (3.31) (3.32)

43

where a , a , f and f are the amplitude and frequency ratios with respect to  and  . Boundary conditions are given:

cos(0 )  c10 ; cos( f0 )  c20 ; sin( 0 )  s10 ; sin( f  0 )  s20 ;

cos(n )  c1n ; cos( fn )  c2 n ; sin( n )  s1n ; sin( f  n )  s2 n ;
(3.33)

These boundary conditions are created to restrict the start and end points of the shapes. In Figure 3.15, the bodies are generated by changing the frequency ratio from 1:-4 to 1:-1 and 1:2 to 1:4 while the amplitude ratio is 1:1 and 1:2. After adding the third parameter z, the cycloids extend from 2-D plain figures to 3-D shapes. This indicates that an arbitrary 3-D geometry may be generated by or decomposed into a series of modes.

Figure 3.15: 3-D Geometries generation Similar to the analysis of a circle, the x and y series of a sphere can be digitalized along

 and  directions. Instead of producing two 1-D orthogonal x and y series, it produces

44

two M by N matrix, the size of M and N depending on the digitalization interval. Each matrix also may be subject to harmonic analysis separately, as shown in Figure 3.16.

Y (mm)

X (mm)

Figure 3.16: X and Y matrix of a sphere Instead of applying 1-D Fourier transform, 2-D Fourier transform is used to get spectral information on X and Y matrix. The results are shown in Figure 3.17. Figure 3.17(a) and Figure 3.17 (b) are the X and Y matrix. Figure 3.17(c) shows the 2-D FFT results of X matrix. Figure 3.17(d) shows the 2-D FFT results of Y matrix.

Y (mm)

X (mm)

Z (mm)

45

Figure 3.17: 2-D Fourier transfom on X and Y matrix Another method to analyze a sphere is by using a slicing approach along one direction, normally along z axis, a 3-D shape can be divided into a series of 2-D contour curve which can be analyzed using the same way as discussed in the previous section. By applying 1-D Fourier transform on each sliced profile, the harmonic components can be obtained.

46

Figure 3.18: A sphere with 19 sliced profiles Figure 3.18 shows a sphere sliced into nineteen profiles. The amplitudes, frequencies and phases components on each profile can be found as
kix  [ fix , Aix , ix ]
kiy  [ f iy , Aiy , iy ]

(3.34) (3.35)

Here, i is the index on z axis. The results of x and y series depend on the way of digitalization and the resolution. Furthermore, the cross-correlation ki ( x  y ) between kix and kiy can be written as,
ki ( x  y )  [ f i ( x  y ) , Ai ( x  y ) , i ( x  y ) ]

(3.36)

The characteristics indices are created based on the { kix , kiy , ki ( x  y ) }.

47

3.4

Summary

In this chapter, a method is introduced to decompose a 2-D curve into two orthogonal series, and 1-D Fourier transform is applied on each series to obtain the harmonic components: frequency, amplitude and phase. The cross correlation between the Fourier transform components of x and y series is proposed. Theses information combines together to be characteristics indices representing a shape. This method is extended to a 3-D shape. Depending on the decomposition methods, either 1-D FFT or 2-D FFT is applied to obtain harmonic components for 3-D shapes.

48

CHAPTER 4 SPATIAL DATA ANALYSIS FOR SHAPE ERROR INSPECTION
In Chapter 3, a new spatial data analysis method was introduced, which can decompose a 2-D curve or 3-D shape into a set of shape indices. This method is now used for shape inspection. Shape inspection is a process to compare the shape indices of a shape under inspection (called live shape) with those of a standard shape (called template).

4.1

Geometric dimensioning and tolerancing standards

Geometric dimensioning and tolerancing (GD&T) is a standard used to define precisions on the important features of the product geometry. Dimensioning specifications define the nominal geometry. Tolerancing specifications define the allowable variation for the size and form of individual features, as well as the allowable variation in orientation and location between features. In other words, GD&T sets the limits for inspection of various features.

There are several standards available worldwide that describe the symbols and define the rules used in GD&T. One such standard is American Society of Mechanical Engineers (ASME) Y14.5M-1994. Other standards, such as those from the International Organization for Standardization (ISO), vary slightly. This research is based on Y14.5M standard, which provides a fairly complete set of standards for GD&T. The following information can be generated using GD&T: 49



Clear and concise techniques for defining a reference coordinate system (datum) on a component or assembly to be used throughout the manufacturing and inspection processes.



Proper application of geometric dimensioning with consideration of logical mechanical design process and design for manufacturing.



Use of symbols and numbers to represent geometric dimensions and tolerances for accurate definition of design, manufacturing and inspection requirements.

GD&T standards include fourteen standards: straightness, flatness, circularity, cylindricity, profile of a line, profile of a surface, perpendicularity, angularity, parallelism, symmetry, positional tolerance, concentricity, circular runout, and total runout. The main focus of this research is to inspect the weld quality using a laser scanner. As introduced before, a laser scanner can obtain the surface data of an object. Therefore, the analysis focuses on two GD&T standards, profile of a line and profile of a surface. Figure 4.1 shows the definition of profile of a line and profile of a surface.

Figure.4.1 GD&T Standards ­ profile of line and profile of a surface [35] 50

4.2

Spatial data analysis method for 2-D curve inspection

As discussed in Chapter 3, by applying a Fourier transform to a given 2-D curve, the frequency f , amplitude A , and phase  information on both x and y series can be obtained as,

k x  [ f x , Ax ,  x ] k y  [ f y , Ay ,  y ]
Furthermore, the cross-correlation k x  y between k x and k y can be written as,
k x  y  [ f x  y , Ax  y ,  x  y ]

(4.1)

(4.2)

k x , k y , and k x  y are defined as shape indices or called shape descriptors. Every shape has

its own distinctive set of shape indices. To fully represent a 2-D curve, the complete set of shape indices must be used. Any shape changes of a given curve will change its shape indices at the same time. Furthermore, a relationship can be created between the shape indices k x , k y , k x  y  and the shape errors for shape inspection.

4.2.1 Profile of a line- overall size change
An example of how shape changes will affect the shape indices of a 2-D curve is discussed in this section. A quarter of circle with a radius of 10mm is shown in Figure 4.2(a). This quarter circle is defined as a standard profile in the following analysis and is digitized into 50 uniform intervals. The x and y series can be plotted separately. Figure 4.2b) and 4.2(c) are the plot of x and y series.

51

Figure 4.2: The amplitude and phase components on x, y series of a square By applying 1-D Fourier Transform on x and y series separately, the relationships between the amplitude, phase and frequency are shown in Figure 4.3. The figures show that for the quarter circle, x and y series have same amplitudes but different phases at different frequencies.

52

Figure 4.3: 1-D Fourier transform on x and y series Next, analysis is carried out when the overall size of the quarter circle is changed. A quarter circle with radius of 15mm is compared to the standard profile, as shown in Figure 4.4. The new profile is plotted in red, and the standard one is in blue color.

Figure 4.4: Comparison of a 10mm quarter circle and a 15mm quarter circle 53

Figure 4.5(a) and Figure 4.5(b) compare the x and y series of the two profiles. The x and y series of the standard profile are plotted in blue color, and the x1 and y1 series of the 15mm quarter circle are plotted in red color.

Figure 4.5: Comparison of x and y series By applying 1-D Fourier transform on x and y series separately, the relationships between the amplitude, phase and frequency of the new x1 and y1 are shown in Figure 4.6. Also in this figure, FFT results of both standard x and y series and new x1 and y1 series are plotted together for comparison.

54

Figure 4.6: 1-D Fourier transform on x and y series of two profiles Figure 4.6(a) is the comparison of the amplitude component of two x series. Figure 4.6(b) is the comparison of the phase component of two x series. Figure 4.6(c) is the comparison of the amplitude component of two y series. Figure 4.6(d) is the comparison of the phase component of two y series. It is clear that x and y series both change on amplitude when the size of the quarter circle changes, but there is no change on phase components.

Figure 4.7 is the amplitude and phase component cross correlation of x and y series. The curve in blue color is the cross correlation of x and y series of the standard profile, and the red one is the cross correlation of x1 and y1 series of the larger size profile. As in Figure 4.7, changes are only found in amplitude component. This example clearly shows that the amplitude components decide the scale of a 2-D curve. If only the amplitude changes without any changes on phase component, a 2-D curve will only change in manner of scale. 55

Figure 4.7: Cross correlation of frequency and amplitude between x and y series The above example tested how shape indices change when a larger size profile is compared to the standard profile. Next, a smaller size profile is co mpared with the standard profile. Figure 4.8 compares an 8mm quarter circle with the standard 10mm profile. The standard profile is still plotted in blue, and the smaller profile is plotted in red color.

Figure 4.8: Comparison of a 10mm quarter circle and an 8mm quarter circle 56

Figure 4.9 compares the x1 and y1 series (in red color) of the 8mm profile with the x and y series (in blue color) of the standard 10mm profile.

Figure 4.9: Comparison of x and y series of two profiles

A 1-D Fourier transform is applied on x and y series separately, the relationships between the amplitude, phase and frequency of the new x1 and y1 are shown in Figure 4.10. The comparison of FFT results of both standard x and y series and new x1 and y1 series are also shown in Figure 4.10.

57

Figure 4.10: 1-D Fourier transform on x and y series of two profiles

Similar results can be seen from these figures, that changes are found on amplitude vs. frequency on both x and y series, but no changes on phase vs. frequency. The difference is that a smaller profile has an amplitude value that is smaller than the standard profile.

Figure 4.11 is the amplitude and phase component cross correlation of x and y series. The curve in blue color is the cross correlation of x and y series of the standard profile, and the red one is the cross correlation of the 8mm profile. As in Figure 4.11, changes are only found in the amplitude component. The peak value and average value of the amplitude cross correlation of x1 and y1 series is smaller than those of the standard profile. 58

Figure 4.11: Cross correlation of x and y series of two profiles

Table 4.1 lists the values of peak amplitude, average amplitude and average amplitude cross correlation on y series of different size quarter circles. Table 4.1: Amplitude values for different size of quarter circles
Diameter (mm) 2 4 6 8 10 12 14 16 18 20 Peak Amplitude (mm) 0.6 1.3 1.9 2.5 3.2 3.8 4.4 5.1 5.7 6.3 Average Amplitude (mm) 0.1 0.1 0.2 0.2 0.3 0.3 0.4 0.4 0.5 0.5 Average Amplitude Cross Correlation (mm2) 0.0 0.1 0.3 0.5 0.8 1.2 1.6 2.2 2.7 3.4

59

Figure 4.12 plots the relationship between the profile size and the values of peak amplitude, average amplitude and average amplitude cross correlation. From the plot, it can be seen that peak amplitude and average amplitude is linear to the size of the profile. The average amplitude cross correlation is non-liner to the size of the profile, and the value is increased when the size of the profile is increased.

Figure 4.12: Relationship between profile size and values of amplitudes

4.2.2 Profile of a line- shape errors
The analysis of the overall size changes of a line profile shows that size changes will change the values of amplitude. These changes can be found on the peak amplitude, average amplitude and amplitude of cross correlation. Following analysis is carried out on shape errors. Suppose a profile has a bump shape error, see Figure 4.13.

60

Figure 4.13: A profile has a bump shape error Figure 4.14 compares the x and y series of the error profile and the standard profile. The x and y series of the standard profile are plotted in blue color, and the x1 and y1 series of the error profile are plotted in red color. In this case, only y1 series of error profile is changed. The Fourier transform of error profile and standard profile is compared and shown in Figure 4.15.

Figure 4.14: Comparison of error profile and standard profile 61

Figure 4.15: 1-D Fourier transform on x and y series Figure 4.16 is the zoom in view of changes on y series. Figure 4.16(a) shows the amplitude changes on y series. Figure 4.16(b) is the zoom in view of phase vs. frequency of y series.

Figure 4.16: Amplitude and phase changes on y1 series 62

The same results can be found in cross correlation of the error profile and the standard profile, see Figure 4.17.

Figure 4.17: Cross correlation of error profile and standard profile Figure 4.18 is the zoom in view of amplitude and phase cross correlation. Changes are found on both amplitude and phase cross correlation.

Figure 4.18: Zoom in view of amplitude cross correlation 63

Figure 4.19 shows another example with a bigger bump shape error. Figure 4.20 compares the Fourier transform of this bigger bump profile with the standard profile. Figure 4.21 is the comparison of amplitude and phase cross correlation.

Figure 4.19: Compare of a bigger bump shape error with the standard profile

Figure 4.20: Comparison of 1-D Fourier transform of two profiles 64

Figure 4.21: Cross correlation of a bigger bump shape error and standard profile As error size increases, noticeable changes can be seen on both amplitude and phase components of y series as well as cross correlation. Figure 4.22 compares a profile with crater and the standard profile.

Figure 4.22: Comparison of a profile with crater and the standard profile Figure 4.23 is the Fourier transform comparison of two profiles. Changes are found on both amplitude and phase on y series. 65

Figure 4.23: Comparison of 1-D Fourier transform Figure 4.24 shows the cross correlation of the two profiles. Changes are found on both amplitude cross correlation and phase cross correlation, the comparison values are listed in Table 4.2.

Figure 4.24: Cross correlation of the profile with crater and the standard profile 66

Table 4.2 lists the shape indices values of profiles with bump or crater errors. The values show that a shape with a bump error has a larger amplitude than the standard profile. On the contrary, a shape with a crater has a smaller amplitude than the standard profile. Table 4.2: Shape indices changes of different type of shape errors
Peak Amplitude (mm) Average Amplitude (mm) Average Phase (degree) Average Amplitude Cross Correlation (mm2) 0.8 0.8 0.8 0.9 0.9 Average Phase Cross Correlation (degree2) -23.8 -23.7 -23.7 -23.7 -88.3

Error Types

Big Crater Small Crater Standard Small Bump Big Bump

2.8 3.1 3.2 3.3 3.5

0.2 0.2 0.3 0.3 0.3

2.3 2.3 2.3 2.3 8.6

Figure 4.25, Figure 4.26 and Figure 4.27 plot the relationships between peak amplitude, average amplitude, average amplitude cross correaltion and different type of errors.

Figure 4.25: Relationship between shape errors and peak amplitude (unit: mm) 67

Figure 4.26: Relationship between shape errors and peak average amplitude (unit: mm)

Figure 4.27: Relationship between shape errors and average amplitude cross correlation changes (unit: mm2) Figure 4.28 and Figure 4.29 are the relationship between average phase, average phase cross correlation and shape errors. The result from both calculations and charts show that for a quarter of circle, either a bump or crater will change the values of phase

68

components. The difference is that bumps have a larger influence on phase changes than craters.

Figure 4.28: Relationship between shape errors and average phase (unit: degree)

Figure 4.29: Relationship between shape errors and average phase cross correlation (unit: degree2)

69

Above analysis shows that for a given profile, the overall size changes or shape errors will change their shape indices. For overall size changes, the size of the profile will affect the values related to amplitude (amplitude, average amplitude and average amplitude cross correlation). A shape with a bump or crater errors will change both amplitude (amplitude, average amplitude and average amplitude cross correlation) and phase components (average phase and average phase cross correlation).

4.3

Spatial data analysis method for 3-D shape inspection

It has been discussed in Chapter 3 that there are two methods to analyze a 3-D shape. One method is that the x and y series of a 3-D shape can be digitalized along  and

 directions. Instead of producing two 1-D orthogonal x and y series, it produces two M×
N matrix, with the size of M and N depending on the digitalization interval. Each matrix also may be subject to harmonic analysis separately. Rather than applying 1-D Fourier transform, a 2-D Fourier transform is used to get spectral information on x and y matrix.

The other method to analyze a 3-D shape is by using a slicing approach along one direction, normally along the z axis. A 3-D shape can be divided into a series of 2-D contour curve which can be analyzed using the same way discussed for a 2-D curve. By applying a 1-D Fourier transform on each sliced profile, the harmonic components can be obtained.

70

Figure 4.30 is an example of analysis of profile of a surface. Figure 4.30(c) and 4.30(f) are an ideal shape of cube and a cube with a shape error on one surface to be analyzed. Figure 4.30(a) and 4.30(d) are the projections of x coordinates of two cubes along z axis. Figure 4.30(b) and 4.30(e) are the projections of y coordinates along z axis. The shape error can be seen in y coordinate as shown in Figure 4.30(e).

Figure 4.30: x and y coordinate projections of two cubes

The 2-D Fourier transform is applied on y coordinate only. Figure 4.31 shows the spectrum results of the two y coordinates.

71

Figure 4.31: 2-D FFT on y coordinates To show the differences between the two y coordinates, the error surface is extracted from the whole body and the 2-D Fourier transform is applied. Figure 4.32 shows the result of transform.

Figure 4.32: Amplitudes comparison between the ideal and error shape 72

Figure 4.33 plots the results together to shows the differences which are the white color zones.

Figure 4.33: A zoomed view of amplitudes comparison From the above examples, it can be seen that, shape errors in a 3-D shape will be also expressed as changes in frequency and amplitude. Similarly to what have been introduced in the previous section for 2-D curves, these changes can be used for manufacturing inspection. The results from 2-D FFT can be used for overall shape error detection.

73

4.4

Summary

In this chapter, geometric dimensioning and tolerancing (GD&T) standards are introduced. The main focuses of research are profile of a line and profile of a surface. A quarter circle is used to verify when the overall size changed or a standard profile has a shape error (bump or crater) and how shape indices change. The analysis shows that overall size changing will only change the amplitude components (amplitude and amplitude cross correlation). For the quarter circle example, a larger size profile has a positive amplitude change and a smaller size profile has a negative amplitude change compared to the standard profile. This conclusion can be used to detect the trend of a size change. Shape errors on a profile will affect both amplitude and phase components. Examples were shown to verify the shape indices changes when a profile has a bump or crater. A cube was used to verify the feasibility of the spatial analysis method on 3-D shapes. 2-D FFT was applied to detect shape errors.

74

CHAPTER 5 EXPERIMENTS ON MIG WELD INSPECTION
In this chapter, experiments on MIG weld quality inspection are presented. In Section 5.1, welding process and typical weld defects are introduced. In Section 5.2, a projection method is introduced in order to apply the spatial data analysis method. The discussion is focused on how to apply the spatial data analysis method to 2-D projection data and 3-D scanning data for weld shape error inspection. A geometry projection method is introduced in Section 5.3 for weld leg size inspection and a template method is developed for production tests in Section 5.4.

5.1

Welding process, weld defects and inspection methods

Metal Inert Gas (MIG) welding is one of the most commonly used arc welding processes. In this process, the weld is shielded by an external gas to prevent air reacting chemically with the molten metal. The external gas can be argon, helium, CO2, argon + oxygen or other gas mixtures. A consumable electrode wire is continuously fed from a spool to the arc zone and then transferred to the molten weld pool under the heat generated between the end of the electrode wire and the work piece. The fused electrode material is supplied to the surfaces of the work pieces to form a joint. The operation types of MIG welding include: manual, mechanized, semi-automatic and automatic. MIG welding is suitable for structural steel, aluminum, stainless steel and nickel alloys, etc. One of the advantages of MIG welding is that a continuous weld can be produced without interruption. The main 75

disadvantages are the expensive, non-portable equipment and the limitation of indoor applications due to the effect of wind that may disperse the shielding gas. MIG welding is widely used in the automobile industry.

The geometry of a weld affects the quality and the safety of a welded structure. Two parameters that influence the geometric quality of a weld are the weld leg size and the weld surface profile [34]. The purpose of welding inspection is to inspect the leg size and to locate and determine the size of any discontinuities. Discontinuities are interruptions in the normal crystalline structure of the metal. Discontinuities that are too large or too numerous within the weld become defects. Defects will compromise the weld's overall strength. Typical MIG welding defects are: lack of fusion, excessive penetration, solidification cracking, porosity, undercut, spatter, crater cracking, short weld, off location, burn through, and small leg size or called thin weld, etc. In this research, a 3-D laser scanner is used to obtain only the surface information of a weld, and the detectable defects include porosity, undercut, crater cracking, short weld, off location, burn through and thin weld. Figure 5.1 shows typical defects for different type of welds.

Figure 5.1: Typical weld defects [34] 76

Common inspection methods include: visual inspection, X-Ray inspection, ultrasonic testing, air or water pressure testing, etc [35]. Visual inspection is the most common inspection method that can reveal spatter, excessive buildup, incomplete slag removal, cracks, heat distortion, and undercut. Typical tools for visual inspection are weld gauges, magnifying glasses, and tape measures or calipers [35]. Figure 5.2 shows how to use weld gauges to inspect different type of weld defects.

Figure 5.2: Using weld gauge to inspect different types of defects[35] More advanced visual inspection methods include computer vision and laser scanning. In the past few years, some weld inspections are carried out with 2-D images taken by a digital camera. As introduced in Chapter 2, the 2-D technique requires specialized illumination and optical filters in order to distinguish welds from the background and cannot measure the two most critical parameters of the weld's height and volume.

77

3-D technology allows the height component of the welds to be measured which can result in a direct or extrapolated volume measurement. Laser scanners usually provide more accurate results with less computational cost for a 3-D shape analysis. 3-D modeling is usually represented by point clouds. It is clear that, for a 3-D shape inspection, using the 3-D spatial data obtained from a laser scanner is a more straightforward and simpler way than using a 2-D grayscale image. More importantly, using a 3-D spatial data can avoid the errors in reconstructing the 3-D image from a 2-D image. The scanning process can be described by a scanning plane that moves in a certain direction, called scanning direction, as shown in Figure 5.3.

Figure 5.3: Principle of a 3-D laser scanning In the scanning plane, there is a scanning window, called field of view (FOV), defined by scanning width L and the depth of view D. Only the scanning image data falling within FOV (shaded area in Figure 5.3) will be collected. As the scanner moves, it generates a 78

rectangular tube volume that defines an acceptable scanning data region. A 3-D image is generated from profiles, where each profile represents a cross-section of the object. A profile is created when the laser passes the object, which is reflected as a line on the object.

The laser scanner is driven by a motion system such as a robot arm. The robot arm controls the path of the laser scanner along the direction of welds at a specific speed. The robot arm controller sends a trigger signal to the laser scanner to start and stop the scanning process. The 3-D image is saved for further processing.

The scanning data is digitalized by a laser scanner and is represented in the manner of point clouds. There are two ways to find the shape error by using the proposed spatial data analysis method. One way applies 1-D FFT on the 2-D curve of the projection data of a weld. This method is used to inspect the leg sizes. The other method applies 2-D FFT directly on 3-D point clouds to find overall shape errors. The detail is discussed in following sections.

A SICK IVC-3D laser scanner is used in this project, see Figure 5.4. The IVC-3D is the first smart camera in the world that is designed to inspect and measure in three dimensions. With tools that are designed to measure height, volume, shape and profiles, 3-D applications can be easily solved with the IVC-3D smart camera. The scanner provides information about object height, shape and volume, and can instantly provide true metric dimensions at production speeds. The scanner is independent of contrast and 79

color and can easily interface with PLCs, robots and control systems that support Ethernet/IP or OPC. The advantages of SICK IVC-3D camera ensure the success of the project.

Figure 5.4: SICK IVC-3D laser scanner The laser scanner is calibrated using a 1-2-3 gauge block. The dimension of the 1-2-3 gauge block is manually measured and the values are listed in Table5.1.

Table 5.1: Manual measurement of 1-2-3 gauge block (unit: mm)
1'' 25.41 25.40 25.38 25.42 25.40 25.41 25.40 25.39 25.42 25.41 25.40 2'' 50.80 50.83 50.85 50.82 50.79 50.80 50.78 50.77 50.79 50.85 50.81 3'' 76.19 76.17 76.16 76.18 76.17 76.16 76.16 76.18 76.15 76.16 76.17

1 2 3 4 5 6 7 8 9 10 AVG

80

The 1-2-3 gauge block is placed on a fixture and a surface area of two inch by three inch is scanned by the SICK 3-D laser scanner, see Figure 5.5.

Figure 5.5: 1-2-3 gauge block used for laser scanner calibration Figure 5.6 is the scanning image of the gauge block. The dimension of the 1-2-3 gauge block in a scanning image is obtained by multiplying the number of pixels with scanning resolution. The resolution on both horizontal and vertical directions is 0.2 mm. The flatness of the gauge block is better than 0.0001" across the surface, which exceeds the measurement resolution of the laser scanner. The errors for the 2 inch surface and the 3 inch surface are calculated as:
error2'' 

(average  50.81)  100% 50.81
(average  76.17)  100% 76.17

(5.1)

error3'' 

(5.2)

81

Figure 5.6: Scanning image of the 1-2-3 gauge block Table 5.2 lists the measurements of three inch edge of the 1-2-3 gauge block. The measurement is taken at every 20 pixels.

Table 5.2: 1-2-3 gauge block three inch edge measurement

# 68 88 108 128 148 168 188 208 228 248

Staring index 51 51 51 51 51 51 51 51 51 51

Ending index 431 431 431 431 432 431 431 431 431 431 AVG Error

No. of Pixels 380 380 380 380 381 380 380 380 380 380 380.10

Size (mm) 76.00 76.00 76.00 76.00 76.20 76.00 76.00 76.00 76.00 76.00 76.02 -0.20%

Table 5.3 is the measurements of two inch edge of the 1-2-3 gauge block. The measurement is also taken at every 20 pixels. The error is 0.41%. Possible sources of errors are robot movement, laser line reflection and scanner itself.

82

Table 5.3: 1-2-3 gauge block vertical direction measurement

# Staring index 100 61 120 61 140 61 160 61 180 60 200 60 220 60 240 60 260 59 280 59

Ending Index 316 316 316 315 315 315 315 315 315 315 AVG Variation

No. of Pixels 255 255 255 254 255 255 255 255 256 256 255.10

Size (mm) 51.00 51.00 51.00 50.80 51.00 51.00 51.00 51.00 51.20 51.20 51.02 0.41%

83

5.2

Spatial data analysis method

The part being inspected is a radiator support with 60 welds. Figure 5.7 is the CAD drawing of the part being inspected.

Figure 5.7: Radiator support In this research, a laser scanner is used as a data acquisition device. As mentioned before, the laser scanner gathers the 3-D digital data directly. Most of the laser scanners have a self-position function that can export the exact positions x, y, and z of a point cloud. Figure 5.8 is a point cloud of a part being inspected.

Figure 5.8: Point cloud of one weld 84

Two major types of MIG welds are the T-joint and the lap joint. In this research, the major concern is T-joint weld inspection. Typical weld cross-sections of a T-joint are shown in Figure 5.9. The leg sizes include the fillet leg sizes A, B, and the throat size C. Figure 5.9 shows the locations of these parameters with respect to the weld.

Figure 5.9: Leg size of a T-joint Figure 5.10 shows the picture of welds to be inspected, and Figure 5.11 is one of the scanning cross sections.

Figure 5.10: MIG welds to be inspected 85

Y (mm)

X (mm)

Figure 5.11: A scanning cross section The traditional method is to calculate the leg sizes (A, B, C) on each scanning cross section [39-41], and then find the minimum value from all the scanning cross sections to determine the quality of the weld. This method is also called cross section method. Suppose a weld of l long is being inspected by a laser scanner along the length direction, which is in parallel to the Z axis, as shown in Figure 5.12; the scanning spatial resolution is r . Then, the number of scanning cross sections, denoted by N cs , along the Z axis is defined as
N cs  l r

(5.3)

86

Figure 5.12: Weld being inspected Therefore, to check the quality of this weld, N cs computations are needed. To shorten the computation times, a projection method is proposed. The main idea is to project the entire scanning data covering the weld length onto a plane perpendicular to the scanning plane. Figure 5.13 (a) shows the original scanning data set of a weld. The Z axis is the scanning direction along the weld length and the x-y plane is the plane perpendicular to the scanning direction. Figure 5.13(b) shows the point stripe after projecting onto the x-y plane. As a result, the scanning data only needs to be processed once on a projection plane. The projection method can be also used for leg size calculation and more details are discussed in Sec 5.3, geometry projection method.

(a): Scanning data and its coordinate system 87

(b): Points stripe after projection Figure 5.13: Projection method

5.2.1 1-D Fourier transform on 2-D projection data
The proposed methodology consists of two parts: 1) applying a 1-D Fourier transform on the 2-D projection data of the welds and 2) applying a 2-D Fourier transform directly on the 3-D point clouds to check overall shape errors. As introduced in Chapters 3 and 4, a 2-D curve can be represented by one complete set of Fourier descriptors. In this research the 2-D curve is the projection of the welds being inspected, and the set of Fourier descriptors are the shape indices represented as amplitudes, frequencies and phases. The analysis will be carried out on the middle portion of the projection, which are the weld and a small portion of base metal. The edge of the projection composes of a closed contour, as shown in Figure 5.14 and a set of Fourier descriptors can be obtained based on the analysis of the contour.

88

Figure 5.14: A closed contour of the weld projection data

If two shapes are the same, their corresponding Fourier components are equal. In practice, there are rarely any two identical 2-D curves, and therefore, a tolerance zone is used. A qualified area is formed by a set of qualified Fourier parameters. The inspection can be carried out by comparing the Fourier components of a part being inspected with the tolerance zone created by the qualified welds.

The analysis of a good weld is first discussed here. Figure 5.15 shows the maximum and minimum edge of a good weld projection zone. The middle portion is extracted which contains the weld and a small portion of two base metals.

89

Figure 5.15: The middle portion with weld and base metals The starting and ending points of the maximum and minimum edges are connected to form a closed 2-D curve, see Figure 5.16 below.

Figure 5.16: Connect the ends to create a 2-D closed contour The Fourier transform of the good weld is shown in Figure 5.17. The x and y series are plotted separately. Figure 5.17(a) and 5.17(d) are the original x and y series. By applying

90

1-D Fourier Transform on x and y series separately, the relationships between the amplitude, phase and frequency are shown in Figure 5.17(b), 5.17(c), 5.17(e) and 5.17(f).

Figure 5.17: Fourier transform of good welds

Now, the projection of a short weld is analyzed and represented by its shape indices. The maximum and minimum edge of the bad weld is shown in Figure 5.18. It can be easily noticed that there is a convex curve at the top of the minimum edge (in this figure, the y axis is negative). The middle portion is extracted which contains the weld and a small portion of two base metals, as shown in Figure 5.19.

91

Figure 5.18: Maximum and minimum profile of a bad weld

Figure 5.19: The middle portion with weld and base metals

The starting and ending points of the maximum and minimum edges are connected to form a closed 2-D curve, see Figure 5.20 below.

92

Figure 5.20: 2-D closed shape of a bad weld The Fourier transform of the bad weld is shown in Figure 5.21. The x and y series are plotted in Figure 5.21(a) and 5.21(d). By applying a 1-D Fourier Transform on x and y series separately, the relationships between the amplitude, phase and frequency are shown in Figure 5.21(b), 5.21(c), 5.21(e) and 5.21(f). Figure 5.22 compares the Fourier transform of the good and bad welds. Figure 5.22(a) shows that there are no changes in x series. Changes are found in y series as shown in Figure 5.22(d). The curve in blue color is the y series of the good weld, and the curve in red color is y1 series of the bad weld. In Figure 5.22(e), amplitude vs. frequency, and Figure 5.22(f), phase vs. frequency, the results of two welds shows significant differences. Figure 5.23 are the differences of amplitude and phase.

93

Figure 5.21: Fourier transform of the bad weld

Figure 5.22: Comparison of a good and bad weld 94

Figure 5.23: Frequency and phase difference of y series Figure 5.24 is the frequency and phase component cross correlation of x and y series. The curve in blue color is the cross correlation of x and y series of the good weld, and the red one is the cross correlation of x1 and y1 series of the bad weld. It shows that for a short weld, there are both changes in the amplitude and frequency.

Figure 5.24: Cross correlation of x and y series of a bad weld 95

Figure 5.25 is an example of a defect weld with undercut. The middle portion which contains the weld and a small portion of two base metals is extracted and shown in Figure 5.26.

Figure 5.25: Example of bad weld with undercut

Figure 5.26: The middle portion with weld and base metals 96

A closed 2-D contour is formed by connecting the starting and ending points of the maximum and minimum edges, as shown in Figure 5.27.

Figure 5.27: 2-D closed shape of a bad weld The Fourier transform of the undercut weld is shown in Figure 5.28. The original x and y series are plotted in Figure 5.28(a) and 5.28(d). Figure 5.28(b), 5.28(c), 5.28(e) and 5.28(f) are the plots of amplitude versus frequency and phase versus frequency. Figure 5.29 is the comparison of the good weld and the undercut weld. As with the previous analysis, the blue curve is the y series of good weld, and the red curve is the y series of the undercut weld. In this research, the x series of a scanning data represents the width resolution of the line laser. If the width resolution setup between two scans are the same, and also if the same portion which contains base metal and weld is extracted for analysis, then the index on x series is same. In the other words, the spatial components on the x series between two same setup scanning images are the same. Therefore, the comparison can be only taken on the y series. In Figure 5.29(e), amplitude vs. frequency, the difference between two welds is minor. Figure 5.29(f), phase vs. frequency, shows significant differences. Figure 5.30 shows the differences of amplitude and phase. 97

Figure 5.28: Fourier transform of the bad weld

Figure 5.29: Comparison of a good and bad weld 98

Figure 5.30: Frequency and phase difference between a good and bad weld Figure 5.31 is the amplitude and phase component cross correlation of x and y series. The blue curve is the cross correlation of x and y series of the good weld, and the red one is the cross correlation of x1 and y1 series of the undercut weld. It shows that for undercut weld, there are minor changes in amplitude but major changes in phase.

Figure 5.31: Cross correlation of x and y series of a bad weld 99

Figure 5.32 is an example of a small leg size weld. The middle portion is shown in Figure 5.33.

Figure 5.32: Example of bad weld with undercut

Figure 5.33: The middle portion with weld and base metals 100

Figure 5.34 is the closed 2-D contour of the small leg size weld.

Figure 5.34: 2-D closed shape of a bad weld The Fourier transform of the weld is shown in Figure 5.35. The x and y series are plotted in Figure 5.35(a) and 5.35(d). The same procedure is taken as previous analysis. Figure 5.35(b), 5.35(c), 5.35(e) and 5.35(f) shows the results of Fourier transform. Figure 5.36 compares the Fourier transform of the good and the small leg size welds. The curve in blue color is the y series of the good weld, and the curve in red color is the y1 series of the bad weld. The comparison of a good weld and a small leg size weld is similar to the example in section 4.2.1, overall size changes. Therefore, they have similar analysis results. Minor changes are found on phase components. The scale of amplitude changes are decided by how the weld changes on its size. Figure 5.37 shows the difference in amplitude and phase.

101

Figure 5.35: Fourier transform of the bad weld

Figure 5.36: Comparison of a good and bad weld 102

Figure 5.37: Frequency and phase difference between a good and bad weld Figure 5.38 is the amplitude and phase component cross correlation of x and y series.

Figure 5.38: Cross correlation of x and y series of a bad weld 103

The blue color curve is the cross correlation of the good weld's x and y series, and the red one is the cross correlation of x1 and y1 series of the bad weld. It also shows that for a small leg size, there are minor changes in phase. The change in amplitude is decided by how small a weld is.

5.2.2 2-D Fourier transform directly on the 3-D point clouds
A 1-D Fourier transform analysis is one way to check the quality of the welds. The other way is to apply a three dimensional shape analysis directly on the 3-D point clouds. Figure 5.39 is a weld being inspected.

Figure 5.39: 3-D point clouds of a weld A standard point cloud will be analyzed to obtain the shape indices. Like what has been done for 2-D closed contour, a qualified area will be formed by the Fourier components of a set of good welds. Inspection will be carried out by comparing the Fourier components of a point cloud with this standard tolerance zone. Figure 5.40 is the point cloud of a good weld. It only includes the weld and a small portion of the base metals.

104

Figure 5.41 is the 2-D Fourier transform of the good weld. There are four major frequencies in the figure located at the four corners.

Figure 5.40: 3-D point cloud of a good weld

Figure 5.41: 2-D Fourier transform of a good weld

105

Figure 5.42 is the point cloud of a bad weld. It can be noticed that there is a convex curve at the front end of the weld. The 2-D Fourier transform is applied on the 2-D matrix. The result is shown in Figure 5.43.

Figure 5.42: 3-D point cloud of a bad weld Figure 5.43 is the 2-D Fourier transform of the bad weld. From the figure, it can be seen that the four major frequencies have significant changes.

Figure 5.43: 2-D Fourier transform of a bad weld 106

A subtraction operation is done to clearly show the difference of the Fourier transform between the good and bad welds. Figure 5.44 is the difference of the 2-D Fourier transform results. The quality inspection is carried out by checking the Fourier transform differences between a weld and standard weld.

Figure 5.44: Fourier transform difference of a good and bad weld

5.3

Geometry projection method

The dimension inspection of MIG welds is used to determine the leg sizes of the weld. A geometry projection method is introduced in this section [36]. The method searches the minimum leg sizes of a weld on the projection data instead of each profile to reduce the processing time.

5.3.1 Methodology
As introduced in section 5.2, to inspect the quality of a weld, traditional methods calculate the leg sizes on each cross section through a geometry reconstruction process. 107

The geometry reconstruction process consists of lines and curve fitting, and leg size computation. On the ith cross section, the points are divided into three segments, left, center and right. The point sets on the left and right segments are used to fit two straight lines which represent two base metals. The linear equations of two straight lines can be expressed as
ax  by  c  0

(5.4)

The linear equation coefficient matrix is defined as M l ,
a   Ml   b   c  

(5.5)

Therefore, the coefficient matrix for the ith left segment is

 ai _ l    M l  yi _ l    bi _ l   ci _ l   i
The coefficient matrix for the ith right segment is

(5.6)

 ai _ r    M l  yi _ r    bi _ r   ci _ r   

(5.7)
i

The coordinates of the intersection point P 1 , as shown in Figure 5.45, of these lines can be easily obtained by solving the following two equations
X P1  bi _ l ci _ r  bi _ r ci _ l ai _ l bi _ r  ai _ r bi _ l ai _ r ci _ l  ai _ l ci _ r ai _ l bi _ r  ai _ r bi _ l

(5.8)

YP1 

(5.9)

108

Figure 5.45: Weld geometry The point set of the center segment is reconstructed to be a second order polynomial known as a parabola, and the equation is expressed as

dx 2  ex  fy  g  0
The coefficient matrix for the ith center segment, denoted by M c , is defined as

(5.10)

 di _ c  e  i_c  M c  yi _ c     fi _ c      gi _ c  i

(5.11)

By solving the parabola equation with the two straight line equations respectively, the coordinates of intersection points P2 and P3 can be obtained. In general, a straight line and a parabola having two intersection points, here noted as P2 _1 , P2 _ 2 , P3 _1 , and P3_ 2 .
2  ai _ l fi _ c  ei _ c bi _ l   ei _ c bi _ l  ai _ l fi _ c   4bi _ l di _ c  bi _ l fi _ c gi _ c  fi _ c ci _ l   X  P2 _ 1  2bi _ l di _ c   2  ai _ l ei _ c bi _ l  ai _ l 2 fi _ c  ai _ l  ei _ cbi _ l  ai _ l fi _ c   4bi _ l di _ c  bi _ l f i _ c gi _ c  f i _ c ci _ l   2bi _ l ci _ l di _ c YP  2 _1  2bi _ l 2 di _ c 

(5.12)

109

2  ai _ l f i _ c  ei _ c bi _ l   ei _ c bi _ l  ai _ l f i _ c   4bi _ l d i _ c  bi _ l f i _ c g i _ c  f i _ c ci _ l   X P2 _ 2   2bi _ l di _ c   2  a e b  ai _ l 2 fi _ c  ai _ l  ei _ c bi _ l  ai _ l f i _ c   4bi _ l d i _ c  bi _ l f i _ c g i _ c  f i _ c ci _ l   2bi _ l ci _ l d i _ c YP  i _ l i _ c i _ l 2_2  2bi _ l 2 d i _ c 

(5.13)

2  ai _ r f i _ c  ei _ c bi _ r   ei _ c bi _ r  ai _ r fi _ c   4bi _ r di _ c  bi _ r f i _ c gi _ c  f i _ c ci _ r   X P3 _ 1   2bi _ r di _ c   2  a e b  ai _ r 2 fi _ c  ai _ r  ei _ c bi _ r  ai _ r fi _ c   4bi _ r di _ c  bi _ r fi _ c gi _ c  fi _ c ci _ r   2bi _ r ci _ r di _ c YP  i _ r i _ c i _ r 3_1  2bi _ r 2 di _ c 

(5.14)

2  ai _ r fi _ c  ei _ c bi _ r   ei _ cbi _ r  ai _ r fi _ c   4bi _ r di _ c  bi _ r f i _ c gi _ c  fi _ c ci _ r   X P3 _ 2   2bi _ r di _ c   2  a e b  ai _ r 2 fi _ c  ai _ r  ei _ c bi _ r  ai _ r f i _ c   4bi _ r di _ c  bi _ r fi _ c gi _ c  fi _ c ci _ r   2bi _ r ci _ r di _ c YP  i _ r i _ c i _ r 3_ 2  2bi _ r 2 di _ c 

(5.15)

The point P2 is the one which is closer to point P 1 , and it can be determined by searching the minimum distance of P2 _1 to P 1 and P 1 , same as the point P 3 . The distances of 2 _ 2 to P
P2 _1 to P 1, P 1, P 1 and P 1 are: 2 _ 2 to P 3 _1 to P 3_ 2 to P

P2 _1 P ( X P1  X P2 _ 1 ) 2  (YP1  YP2 _ 1 ) 2 1 
( X P1  X P2 _ 2 ) 2  (YP1  YP2 _ 2 ) 2 P2 _ 2 P 1  ( X P1  X P3 _ 1 ) 2  (YP1  YP3 _ 1 ) 2 P3_1 P 1  ( X P1  X P3 _ 2 ) 2  (YP1  YP3 _ 2 ) 2 P3_ 2 P 1 
The intersection points P 1, P 2 and P 3 are used to calculate the fillet leg size A and B, (5.16)

A  ( X P1  X P2 ) 2  (YP1  YP2 ) 2 B  ( X P1  X P3 ) 2  (YP1  YP3 ) 2

(5.17) (5.18)

110

To calculate the throat thickness C, another point P4 is needed, as shown in Figure 5.7. Line PP 1 5 is perpendicular to line P 2P 3 . The point P 4 is the intersection point of the line

PP 1 5 and the curve P 2P 3 , and its coordinates can be obtained by solving the equation of
line PP 1 5 and the curve P 2P 3 . The throat thickness C is the distance from point P 1 to P 4. Therefore, the throat thickness C is:

C  ( X P1  X P4 ) 2  (YP1  YP4 ) 2

(5.19)

To inspect the weld quality, the leg sizes on all N cs scanning cross sections must be calculated and then the minimum value is searched. The quality of the weld is defined by the minimum values of A, B and C, as shown in Figure 5.46. If the minimum values of A, B and C all meet the requirements, the weld is considered qualified. If either of the A, B, C minimum value is smaller than the defined values, the weld is considered unqualified. As can be seen, this is a time consuming process since it repeatedly performs fitting of two lines and one curve, determination of three intersection points and the leg sizes on each scanning cross sections. To shorten the computation times, the projection method introduced in the previous section is used here to calculate the leg sizes.

111

Figure 5.46: Finding the minimum A, B and C Instead of calculating leg sizes on all the scanning cross sections, the projection method only calculates the minimum or maximum leg sizes on the projection plane, as shown in Figure 5.47.

Figure 5.47: Projection method 112

Because there is only a strip of point cloud, the minimum and maximum edges need to be determined by searching the minimum and maximum y values along x axis. In Figure 5.48, the blue line represents the minimum edge and the red line represents the maximum edge.

Figure 5.48: The minimum and maximum edge of the point strip The same geometry reconstruction process for the cross section method is applied. The difference is that the projection method only calculates the leg sizes on the minimum projection edge instead of all N cs cross sections. The calculation iteration is reduced from N cs to only one. Therefore, the coefficient matrix for the left segment on the minimum edge is
 al   M l  yl     bl   cl   min 

(5.20)

113

the coefficient matrix for the right segment is
 ar   M l  yr     br    cr   min

(5.21)

The coefficient matrix for the center segment curve M c on the minimum edge is

 dc  e  M c  yc    c   fc     g c  min

(5.22)

If the leg sizes on the minimum edge are all larger than the requirements, it means that the leg sizes on the whole weld are larger than those values, considered as qualified. If one of values are smaller than the requirements, it means that there is a spot that is not welded to satisfaction, hence considered unqualified.

5.3.2 Implementation issues
The issues pertaining to the implementation are discussed in this section and the software development is presented.

5.3.2.1 Data calibration
The scanning laser is not always perfectly perpendicular to the weld, as shown in Figure 5.49. The point cloud may have a small angle on X, Y and Z direction. Among these three directions, the angles on the X and Y directions will cause distortion when projecting the scanning data along the Z direction onto the X-Y plane.

114

Figure 5.49: The rotation along X, Y and Z axes A calibration process is carried out to rotate the point cloud vertical to the projection plane. To determine the angles on the X and Y directions, two pairs of four calibration points are selected. Two points which have the same value on the X axis are selected to determine the angle on the X direction, noted as calibration points CP1 ( X 1 , Y1 , Z1 ) and CP2 ( X 1 , Y2 , Z 2 ) , see Figure 5.50.

Figure 5.50: Calibration process 115

Therefore, angle  x is calculated as

 x   arctan 

 Z 2  Z1    Y2  Y1 

(5.23)

The negative sign is added because the angle is used to rotate the point cloud backward. The other two points which have the same value on the Y axis are selected to determine the angle in the Y direction, here noted as calibration points CP3 ( X 3 , Y3 , Z 3 ) and CP4 ( X 4 , Y3 , Z 4 ) . Therefore, angle  y is calculated as:

 y   arctan 

 Z3  Z 4    X3  X4 

(5.24)

 z is the rotation along the welds, therefore, it does not affect the results of projection,
here, we define  z  0 . The rotation matrix applied for calibration is defined as

 cos  y cos  z  R   sin  x sin  y cos  z  cos  x sin  z   cos  x sin  y cos  z  sin  x sin  z 

 cos  y sin  z  sin  x sin  y sin  z  cos  x cos  z cos  x sin  y sin  z  sin  x cos  z

   sin  y cos  y  cos  x cos  y  

sin  y

(5.25)

Calibration of the scanning data is done by multiplying the rotation matrix R with the original raw data matrix. Figure 5.51 shows a comparison before and after calibration.

116

Figure 5.51: Calibration result

5.3.2.2 Minimum and maximum edge determination
In this method, inspection is carried out by comparing the minimum values of leg size A, B and C with the user defined values. Therefore, these three leg sizes must be calculated on the minimum edge of the projection data. A program is written to find the minimum 117

edge of the projection data. In general, the projection data has two orientations due to the scanning process and each of them has both the minimum and maximum edges, as shown in Figure 5.52.

Figure 5.52: The orientation of the projection data To find the minimum edge, first, the orientation of the projection data must be determined. This is done by finding the sign of the slope of the two fitting straight lines. If the slope of the straight line on the left is negative, the projection data is open to the top; otherwise, it is open to the bottom. Once the orientation of the projection data is determined, the data on the minimum edge can be obtained by searching either the minimum or maximum Y value along the X direction depending on the orientation.

5.3.2.3 Software development
The software is developed with MATLAB. The software calculates three parameters and compares them with the values defined by the user. If the calculated values are all larger than the values defined by the user, the weld is qualified, otherwise it is unqualified. The scanning data is saved as a txt file that contains the X, Y and Z values of all the points. 118

The txt file can be imported into MATLAB automatically. The program plots the weld as the scanning data is loaded, as shown in Figure 5.53.

Figure 5.53: Software interface Next, the user inputs specifications and then presses the `Inspection' button to calculate the three parameters of the minimum edge of the projection point strip. The values are displayed on the right corner of the program window of Figure 5.53, along with the inspection result.

119

5.3.3 Experimental results
The method was tested on a total of 70 welds. To verify the accuracy of the method, the experimental results of the projection method were compared with those of line by line (cross section) method. The average difference of the 70 welds is 0.101mm. Table 5.4 shows the inspection results of five different welds. In this table, the results of line by line (cross section) method are also listed to compare the accuracy of the projection method. The results show that a uniform or regular weld shape has a higher accuracy. The photos of weld No. 1 and 2 show that they all have a uniform shape, therefore, the difference between two methods is less than 0.1mm. Weld No. 3 has a staircase shape, also an undercut can be seen in the photo, and weld No. 4 has an unqualified start and ending. These factors complicate the projection profile and cause the difference between the two methods to be larger than 0.1mm but still less than 0.2 mm.

The largest difference is 0.41mm, the leg size C of weld No. 5, which is caused by the bimodal curve in the projection profile, and this 0.41mm difference is accepted by the manufacture. Meanwhile, as mentioned in section 2, the point set of center segment is reconstructed to be a second order polynomial known as a parabola, which represents the cross section of the welds. The second order polynomial cannot perfectly reproduce the actual curve. This will cause a small error when finding the intersection point P2 and P3 and subsequently affects the leg sizes. By increasing the order of the fitting curve, the accuracy can be increased. However, a higher order curve needs more computation time. Compared to normal human vision, the caliper method and existing laser scanning 120

methods, the accuracy of the projection method is still higher than most traditional methods.

More tests were carried out to compare the processing time for the projection method with the line by line method. The average processing time of the projection method for a scanned data which has 111 cross sections is around 0.10 seconds. For the traditional method, it takes 1.8 seconds, which is 18 times slower than the projection method.

121

Table 5.4: Experiments results for geometry projection method
No. Original Photo Projection View Projection Line by line Method Method
A=3.01mm A=3.09mm B=2.73mm C=2.28mm B=2.81mm C=2.31mm

Difference
A=0.08mm B=0.08mm C=0.03mm

1

A=3.21mm B=1.80mm

A=3.11mm B=1.84mm C=2.03mm

A=0.10mm B=0.04mm C=0.11mm

2

C=1.92mm

A=1.81mm B=2.13mm

A=1.85mm B=2.24mm C=2.18mm

A=0.04mm B=0.11mm C=0.01mm

3

C=2.19mm

A=4.03mm

A=4.10mm B=2.23mm C=2.04mm

A=0.07mm B=0.11mm C=0.12mm

4

B=2.34mm C=2.16mm

A=3.57mm B=1.41mm

A=3.47mm B=1.49mm C=1.81mm

A=0.10mm B=0.08mm C=0.41mm

5

C=1.40mm

122

5.4

Template method

Template method is an improved form of image subtraction, in which the extracted features from the object and those defined by the model are compared. The advantage of this matching is that it greatly compresses the data for storage, and at the same time reduces the sensitivity to the input data and enhances the robustness of the system. This matching process is also called feature matching.

One of the major limitations of the template method is that an enormous number of templates must be used, making the procedure computationally expensive. This problem can be eliminated if the features to be matched are invariant in size, location, and rotation. The disadvantages of this method are that it requires large data storage for the ideal image patterns, and precise registration is necessary for comparison. Once the base image is changed, the templates must be drawn again. To get better inspection results, the template optimism usually has to be interfered manually.

In this research, an intelligent MIG weld inspection system is developed to check the quality of an engine cradle, which has 69 MIG welds including lap joints and T-joints. Figure 5.54 is the CAD drawing of an engine cradle, both front and back sides. The shapes of the welds are in straight, u shape and ring shape (see Figure 5.55). The defect types includes small leg size, off location, burn through, porosity, etc., as shown in Figure 5.56. The basic idea is to scan a certain amount of qualified engine cradles, and then create templates of all the welds. This process is also called teaching mode. The next 123

step is to scan an engine cradle right after production, compare the welds with the templates to check the quality. The result is displayed on a computer screen for rework operator as reference. At the same time, the result is recorded for future analysis and data tracking, and also provides a real time quality monitor for maintenance department and management team.

(a) Front side Figure 5.54: Engine cradle

(b) Back side

(a) Straight weld

(b) U shape weld Figure 5.55: Three types of welds 124

(c) Ring weld

(a) Burn through

(b) Off location

(c)Porosity

(d) Small leg size

Figure 5.56: Common weld defects in production

Because there are variations from robot movement, scanner and part itself, a registration algorithm is necessary to minimize the influence of these variations and to improve the inspection accuracy in addition. The details of the registration method are discussed in Chapter 6.

A systematic introduction of the intelligent MIG inspection system, including algorithm (template creation, registration, decision making, and statistics tools), software development, hardware development and practical experiments will be introduced in Chapter 6. 125

5.5

Summary

In this chapter, experiments were carried out on applying spatial data analysis method for MIG weld inspection. A 1-D FFT is applied on 2-D projection data and a 2-D FFT is directly applied on 3-D scanning point clouds to inspect weld shape errors. The results show that a defect weld can be detected by comparing the spatial components of a good and bad weld.

A geometry projection method was also presented for leg size inspection. The method is mostly used for T-joint welds. The method reduces the inspection time by working on projection data instead of cross section data. An intelligent MIG welding 3-D inspection software is developed based on the projection method. The experiment results show that the method is effective for T-joint welds leg sizes inspection which has the same accuracy as traditional methods but more efficiency.

The last method being presented is the template method for engine cradle inspection. More details are introduced in the next chapter.

126

CHAPTER 6 MIG WELD INSPECTION SYSTEM IMPLEMENTATION
In previous chapters, a spatial data analysis method was introduced and the application of this method for MIG weld shape error inspection was discussed. In this chapter, the implementation issues and software development for both the spatial data analysis method and template method are introduced. A registration method is presented. The registration method prepares the scanning image for further analysis by eliminating the variations of robot movement, scanner, and the part itself. A template method is also introduced for MIG weld inspection. A comparison between the spatial analysis method and the template method is discussed. The entire system hardware components are also presented. The entire system development includes an algorithm (spatial data analysis method, template creation, registration, decision making, and statistics tools), software development, hardware development and practical experiments (in lab and in production line).

127

6.1

System hardware introduction

A laser scanner cell was built during the summer 2010. The layout of the cell is shown in Figure 6.1. The cell consists of a Panasonic industrial robot, an index table and a computer cabinet. The SICK 3-D laser scanner is mounted on the robot through a special handler adaptor so that the scanner can rotate to a specific angle to have the best accessibility and field of view. A holding fixture is mounted on an index table. The index table rotates 360 degrees to let the robot have full accessibility to the parts. The fixture has two locating pins (one two-way pin and one four-way pin) to ensure loading repeatability. Two pneumatic clamps hold the part tightly onto the fixture.

Figure 6.1: MIG welding inspection system layout 128

The Panasonic robot, index table, laser scanner and computer cabinet communicate with each other through a PLC. The computer uses a USB Digital I/O module to send and receive signals from PLC. The module is shown in Figure 6.2. The digital I/O module is controlled by MATLAB codes. The robot sends a trigger to the laser scanner to turn on the laser light. The SICK laser scanner has an easy-to-use graphical user interface for fast application development. The software sets the configurations of the laser scanner, including field of view, length of scanning, resolution on width direction, profile rate, etc. The configuration can be saved to the scanner's built-in memory so that the scanner can run without a PC. Scanned images are sent to a computer through an Ethernet connection for further image processing. Robot movement is predefined and optimized so that the minimum cycle time is reached to fulfill the requirement of production.

Figure 6.2: MCC USB 24-Channel Digital I/O Module

129

6.2

Implementation issues and software development

The goal of the project is to develop a cost effective MIG weld 3-D laser scanning system and an in house software for MIG weld quality monitoring. This can provide a robust MIG weld 3-D surface scanning system for burn through, undercut, too small leg size, and short weld detection for critical welds. Perspective benefits of an automatic welding quality monitoring system are:



Reduce the tough, inefficient and difficult visual inspection methods and replace them with automatic sensing and detection



Better quality assurance on the critical welds. The system can detect any obvious bad welds such as burn through, pin hole, off location and too small leg size.



Cost savings on elimination of some inspection personnel. The maintenance operators perform those jobs when there is a quality alert.

 

An automated go/no-go parts separation Advanced technology and tools, for new potential business with an industrial partner

This system can inspect the qualities and dimensions of MIG welds based on the measurement data obtained from a 3-D laser scanner operated by an industrial robot. The objective was to replace the company's manual visual inspection of welds and nuts.

The software development went through different phases from lab tests to production tests. In lab tests, methods proposed in this thesis including spatial data analysis, 130

geometry projection, and template methods that have been verified for feasibility. Each method shows their advantages and disadvantages.



Spatial data analysis method has a short processing time but the threshold is hard to define due to the complexity of the weld shapes.



Geometry projection method can accurately calculate the leg size but can be only used for T-joint welds inspection.



Template method is easy to apply. The only disadvantage is the need to keep templates updated.

More details are discussed in the following sections.

As of today, this software has been integrated with a laser scanner and a robot, forming an inspection cell for a production floor test. The inspection routine can be embedded in the robot control program; the robot moves the scanner to the first weld, the PLC turns on the scanner to scan the weld and turns it off once done, then moves onto the next weld. While scanning, the software inspects the weld in terms of quality and dimensions. If a weld is found unqualified, a signal is sent to the operator.

6.2.1 Image registration
In this research, the scanning data contains variations from robot motion, index table, fixture design, scanner and the part itself. These variations bring noise and affect the accuracy of the inspection. Each scanning image contains both welds and other information that is not useful for inspection. Therefore a window method is needed to 131

extract the weld from the raw scanning data. To make sure the extraction is accurate, a registration method is necessary.

Image registration is the process of establishing point-by-point correspondence between two images of a scene. This process is used in various computer vision applications, such as stereo depth perception, motion analysis, change detection, object localization, object recognition, and image fusion. Image registration is a crucial step in all image analysis.

To show the requirement of a registration method, research is carried out to evaluate the accuracy of the robot motion, index table, fixture design and the scanner itself by comparing the relative position of a hole on the left hand side of an engine cradle, as shown in Figure 6.3.

Figure 6.3: Reference hole in a scanning image

The first test is to check the differences between the same parts of different scans; a part is reloaded after every two scans. The difference between two scanning images is verified 132

by subtracting one image from the other. If two images are in perfect alignment, the difference will equal no image. Figure 6.4 shows the minimum difference by overlapping two scanning images on U-shape welds. In the picture, each grid is one pixel, and the resolution is 0.4 mm. The value of the green color in the picture is zero, which means there is no difference on this pixel between the two images.

Figure 6.4: The Minimum Difference: 1 pixel or less, less than 0.4mm

Figure 6.5: The maximum difference: 5 pixel, 2.0 mm Figure 6.5 shows an example of the maximum difference. The difference between two scans is 5 pixels, or 2.0 mm. Table 6.1 shows the difference between all ten scans, the 133

part was reloaded every 2 scans, the unit is a pixel. The maximum difference is 5 pixels, 2mm. Most of the differences between the two images are under 3 pixels. The worst scanning image is `7_flus2', the difference between this data set and another data set is 3.29 pixels. The average difference is less than 2 pixels, or 0.8mm. Table 6.1: Image difference check 0_flus2 0_flus2 1_flus2 2_flus2 3_flus2 4_flus2 5_flus2 6_flus2 7_flus2 8_flus2 Avg 1_flus2 4 4 2_flus2 3 1 2 3_flus2 1 3 2 2 4_flus2 1 3 2 1 1.75 5_flus2 2 2 1 2 1 1.6 6_flus2 3 1 1 2 2 1 1.8 7_flus2 1 5 5 2 2 4 4 3.29 8_flus2 3 1 1 2 2 1 1 4 1.875 9_flus2 4 1 1 3 3 1 1 4 1 2.25 Avg 2.44 2.29 2 2 2 1.75 2 4 1

Next, the difference between different parts is also checked. The part is also reloaded after every 2 scans. Figure 6.6 shows the difference as 3 pixels, 1.2 mm.

Figure 6.6: Difference of 3 pixel, 1.2 mm 134

The difference along the Z direction (height) is also checked. The result is shown in Figure 6.7. The wave shape in this picture shows the difference along the Z axis as 1 pixel, or 0.4mm.

Figure 6.7: Difference in Z direction Table 6.2 lists the difference between all 10 scans of two different parts, the part was reloaded after each scan, the unit is a pixel. The results show a larger differences than case 1, since both the reloading errors and part differences are included.

135

Table 6.2: Difference between different parts and loadings without registration 0_flus2 0_flus2 1_flus2 2_flus2 3_flus2 4_flus2 5_flus2 6_flus2 7_flus2 8_flus2 Avg 2 2 1_flus2 3 5 4 2_flus2 2 3 2 2.33 3_flus2 1 3 2 1 1.75 4_flus2 3 4 1 1 2 2.2 5_flus2 3 5 1 2 2 1 2.33 6_flus2 2 1 4 2 3 4 4 2.86 7_flus2 3 4 1 2 2 1 1 4 2.25 8_flus2 9_flus2 Avg 3 2.44 1 3.25 5 2.26 4 2 3 2.4 5 2.75 5 3.33 2 3 5 5 3.67

The above study shows that a registration is required to eliminate the variation of robot movement, parts stamping, scanner, etc. A reference feature is needed to do an image registration. Usually, a reference feature is defined by using a closed shape feature in the same scanning image, such as a hole or any closed shape. For example, in Figure 6.8, a circle or a closed shape is used as registration features.

Figure 6.8: Registration features

136

The following pages show the results after adding a registration program. The registration is done by using the center of the hole or the closed shape feature as a registration point. To find the center of the shape, a least square fitting method is used.

All those data which differences are larger than 2 pixels in the previous study were retested. The values in brackets are the difference after registration. Figure 6.9 and Figure 6.10 show that the position difference can be reduced to 1 pixel or less by using a registration method.

Table 6.3: Difference between different parts and loadings with registration 0_flus2 0_flus2 1_flus2 2_flus2 3_flus2 4_flus2 5_flus2 6_flus2 7_flus2 8_flus2 Avg 1_flus2 4(1) 4 2_flus2 3(1) 1 2 3_flus2 1 3(1) 2(1) 2 4_flus2 1 3(1) 2(1) 1 1.75 5_flus2 2(1) 2 1 2(1) 1 1.6 6_flus2 3(1) 1 1 2(1) 2(1) 1 1.8 7_flus2 1 5(1) 5(1) 2(1) 2(1) 4(1) 4(1) 3.29 8_flus2 3(1) 1 1 2(1) 2(1) 1 1 4(1) 1.875 9_flus2 4(1) 1 1 3(1) 3(1) 1 1 4(1) 1 2.25 Avg 2.44 2.29 2 2 2 1.75 2 4 1

137

Figure 6.9: Difference (a) before and (b) after registration A closer view of with and without registration is shown below.

Figure 6.10: A closer view of difference (a) before and (b) after registration 138

6.2.2 Spatial data analysis method implementation
The spatial data analysis method introduced in this thesis was tested in the lab. In Chapter 5, examples show that differences could be found in shape indices between a good weld and a bad weld by using the spatial data analysis method. In this section, the method to utilize these differences for quality inspection is discussed. The chart below shows the inspection flow.
START

A weld is scanned and image is sent to a computer Register and truncate the image
Apply 2-D FFT on 3-D data and compare with tolerance

Part is good? Yes Send a good signal

No

Apply 1-D FFT on projection data to check defect type

Send a bad signal and defect type

END

Figure 6.11: Inspection flow chart 139

6.2.2.1 Overall shape error inspection
As introduced in Chapter 5, 2-D FFT is used to check overall shape errors. The following examples show how to check overall shape errors on a straight weld.

1) A good weld (weld ID#: 783) is scanned and a registration point is calculated by using the reference feature in the scanning image and the coordinates of the registration point is saved, as shown in Figure 6.12.

Figure 6.12: Raw data is registered using reference feature

2) The scanning image is truncated by a predefined window. Only the weld and a small portion of base metal are kept, as seen in Figure 6.13.

140

Figure 6.13: The truncated image contains weld and base metals 3) 2-D FFT is applied on the truncated image. And the result is saved as a reference.

Figure 6.14: 2-D FFT of a good weld #783 4) Scan another weld (weld ID#: 779) and go through the same procedures to obtain the result of 2-D FFT. Figure 6.15 is the weld#779 being inspected. Figure 6.16 is the 2-D FFT result of the weld.

141

Figure 6.15: Weld #779 being inspected

Figure 6.16: 2-D FFT of scanning image# 0779 To locate the difference of these welds, a subtraction operation is done to the two 2-D FFT results. Figure 6.17 is the subtraction of two 2-D FFT results. The mean value and the square of deviation of the subtraction result are then calculated. 142

Figure 6.17: 2-D FFT subtraction of weld #783 and #779 Table 6.4 lists the mean value and the square of deviation between fifty good welds and weld #783. The average and standard deviation are calculated. Meanwhile, the maximum and minimum values are also searched. These values are used to create an inspection tolerance. In the previous analysis of Chapter 3, a larger profile has a mean value that is bigger than a standard profile. In weld inspection, as long as the size of the weld is bigger than a standard weld, the quality is decided as good. Therefore, the tolerance set by these fifty welds is -6 which means if the mean value of a weld is larger than -6 the weld is decided as good weld, otherwise, it is a bad weld. The square of the deviation is calculated as:

Deviation 2  ( Mean  Average) 2

(6.1)

The square of the deviation is also called variance and is used to measure how far the data is away from the average value.

143

Table 6.4: Mean value and standard deviation between good welds and #783

Scanning ID# 743 744 745 746 747 748 750 751 752 753 754 755 756 758 759 760 761 762 763 764 765 766 767 768 769
Average Standard Deviation Max Min

Mean
1.3298 3.7804 -1.3402 8.3927 9.7419 4.0933 4.4697 -1.8156 -2.2660 -0.3554 -2.7686 6.4332 -2.6833 -1.9557 -2.1161 7.3218 -3.5128 -4.5120 1.0851 8.5397 3.9997 4.1628 -3.5227 5.4896 5.7130 2.7943 4.2608 9.7419 -5.0340

Deviation
2.1447 0.9724 17.0940 31.3423 48.2694 1.6874 2.8070 21.2510 25.6065 9.9205 30.9457 13.2417 30.0039 22.5623 24.1119 20.4984 39.7793 53.3818 2.9213 33.0098 1.4530 1.8728 39.9043 7.2647 8.5189

Scanning ID# 771 772 773 774 775 776 777 778 780 784 789 791 792 793 794 795 796 797 799 800 802 803 804 805 806

Mean
5.6472 7.4645 -1.8947 5.9956 -1.4188 5.2444 5.0692 -5.0340 1.4576 -4.3114 2.8211 -0.4141 4.5529 6.4703 4.9642 5.5348 -0.4103 8.1809 8.8447 7.0401 1.4547 7.1487 5.5855 8.4681 3.5487

Deviation
8.1391 21.8109 21.9866 10.2484 17.7501 6.0031 5.1752 61.2820 1.7867 50.4907 0.0007 10.2937 3.0927 13.5131 4.7085 7.5104 10.2694 29.0156 36.6075 18.0270 1.7945 18.9609 7.7909 32.1922 0.5691

17.7917 15.6896 61.2820 0.0007

144

A variance is used to decide the defect types. To determine an inspection threshold, a number of similar defective welds are required. The mean value and the variance are calculated for these welds. The lower and higher boundaries are defined by searching the minimum and maximum values. Table 6.5 lists the mean value and the square of deviation of four major types of defects. The biggest difference is weld #648, which is 235.0049. The scanning image of weld #648 is shown in Figure 6.18. The weld #648 is a bad weld with burn through. Table 6.5: Mean value and the square of deviation of four bad welds

Weld ID# 796 753 779 648

Type of defect Undercut Small leg size Short weld Burn through

Mean -11.3506 -18.2438 -30.8898 -235.0049

Deviation^2 200.1 442.6 1134.6 56992.2

Figure 6.18: Weld #648 - burn through

145

Weld #779 is a short weld at the ending, see Figure 6.15. However, due to the complexity of the weld shape, in most cases, the defect might include both shape and size errors at the same time. The mean value of weld #779 is -11.3506 which is smaller than the tolerance. If the mean value of a bad weld is negative and also the square of deviation is larger than 80 (the deviation of tolerance and average value), the weld is judged as a bad weld. To further check the defect type of #779, 1-D FFT on projection data is carried out.

6.2.2.2 Defect type inspection
Although most of shape defects can be detected by applying 2-D FFT on 3-D scanning data, 1-D FFT is still needed for small or local defect which can be easily seen on the projected data. Also, the 1-D FFT can be used for defect type detection. The following examples discuss how to use 1-D FFT to detect defect types.

In MATLAB, the phase component of a Fourier transform is calculated ranging between  . However, to clearly define the difference between two profiles, a function called unwrap is used to correct phase angles to produce smoother phase plots. It corrects the radian phase angles in a vector by adding multiples of 2 when absolute jumps between consecutive elements of the vector are greater than or equal to the default jump tolerance of  radians. Figure 6.19 (a) shows the phase comparison without unwrap function. The difference of two profiles is in disorder. The difference becomes observable after using the unwrap function, as shown Figure 6.19(b). The same result can be found in phase cross correlation, see Figure 6.20. The use of the unwarp function can help to distinguish the error profile from standard profile more easily. 146

Figure 6.19: Phase component with or without unwrap comparison

Figure 6.20: Phase difference with or without unwrap comparison 147

1) The projection data of scanning images are used for 1-D FFT analysis. Figure 6.21 is the projection data of weld #783. Figure 6.22 is the projection data of weld #779.

Figure 6.21: Projection data of weld #783

Figure 6.22: Projection data of weld #779 2) 1-D FFT is applied on the projection data as introduced in Chapter 5. Figure 6.23 is the 1-D FFT result comparison of weld #783 and weld #779. 148

Figure 6.23: Comparison of shape indices of weld #783 and weld #779 Figure 6.24 is the cross correlation of two welds. The difference of amplitude and phase vs. frequency is shown in Figure 6.25.

Figure 6.24: Cross correlation between x and y series of weld #783 and 779 149

Figure 6.25: Amplitude and phase difference between weld #783 and #779 3) Similar to 2-D FFT analysis, the mean value of the amplitude and phase difference is calculated. In this case, the mean value of amplitude difference is 0.0392, and the mean value of phase difference is 7.5842.

The same procedures were carried out on weld #648 to confirm the weld defect type of burn through. The projection data of weld #648 is shown in Figure 6.26. The 1-D FFT result comparison of weld #648 and weld #783 is shown in Figure 6.27. The cross correlation is shown in Figure 6.28. The amplitude and phase difference of weld #783 and weld #648 is shown in Figure 6.29.

150

Figure 6.26: Projection data of weld #648

Figure 6.27: Comparison of weld#783 and weld #648 151

Figure 6.28: Cross correlation of weld #783 and weld #648

Figure 6.29: Amplitude and phase difference between weld #783 and weld #648 152

The mean value of amplitude difference is -1.6420, and the mean value of phase difference is 40.8978. The analysis shows that major changes happen on both amplitude and phase indices. The cross correlation result has the same conclusion.

In Appendix A, a table lists the mean value and the square of deviation value (both good welds and bad welds) for all indices: amplitude vs. frequency, phase vs. frequency, amplitude cross correlation, and phase cross correlation. These values are used to decide the threshold for each defect types. To determine the threshold, a number of similar defective welds are required. The boundaries are defined by searching the maximum and minimum values. However, the threshold needs to be updated when the welding process is changed, for example, the robot path, welding input parameters, part stamping variation, etc. The reason is that the welding process changes will affect the shape of welds and therefore the values of spatial component are changed at the same time.

The reason for checking both 2-D FFT and 1-D FFT is that small defects are difficult for the 2-D FFT to recognize. Generally, a scanning image contains thousands of data points. In most of cases, the size of a small defect is only 1 to 5% of the entire image, such as a small burn through or a local small leg size. However these defects can be seen in the projection data (see examples in Chapter 5).

The advantages of the spatial data analysis method are:



The inspection is carried out on a frequency based, not point by point inspection compared to traditional methods. 153



The types of weld defects are connected with changes of shape indices; therefore a diagnosis can be achieved by searching in an error database.



A bad weld can be found in both 2-D FFT and 1-D FFT. 2-D FFT is for overall shape error inspection. 1-D FFT detects defect types.

The disadvantages of the spatial data analysis method are:



The inspection procedure is time-consuming due to two stage inspections (2-D FFT for overall shape error inspection and 1-D FFT for defect type detection).

154

6.2.3 Template method
As introduced in Chapter 5, a template matching algorithm is also developed to check the quality of the welds. The system first scans a certain amount of qualified parts, and then creates templates of all the welds using a minimum value algorithm. The next step is to scan a part right after production, and compare the welds with the templates to check the quality. The result is shown to the rework operator as a reference and also recorded for future analysis and data traceability.

The MIG welds being inspected are lap joints and T joints. The defect types include small leg size, off location, burn through, undercut, etc. First, templates are created for all the welds. To create templates, a certain amount of qualified engine cradles is scanned. This process is also called the teaching mode. Figure 6.30 shows three types of welds: straight, u shape and ring shape. Their templates are also shown in the picture. However, since the scanning direction of a ring weld is along its radius, it is shown as a straight weld.

A MIG weld inspection system using the template method is built and tested. The software development road map can be found in Appendix B. More system software introduction and floor test results are presented in Appendix C.

155

(a) Straight weld

(b) U shape weld

(c) Ring weld

Figure 6.30: Three types of welds and their scanning images The minimum value algorithm is used to create weld templates. The method compares two qualified scanning images on a pixel by pixel basis. The smaller value is saved to form a template. To ensure the high accuracy of the templates, a registration method is needed. Also, to ensure the updated templates are used, a template update tool was developed. The details will be discussed in following sections.

156

The next phase of inspection is to scan an engine cradle right after production, and then compare the images with the saved templates to check the quality. In a similar method as the template creation, to ensure the accuracy of inspection, live scanning images also need to be registered before comparing with the templates. The live scanning images are registered to the same reference points in creating templates.

The decision of the inspection is made by checking the difference between the live image and the template. A subtraction operation is carried out to obtain the difference. An example is shown in Figure 6.31.

Figure 6.31: Decision making The difference of a qualified weld and template should be above a reference plane. If there are points under this reference plane, it means the size of the weld is smaller than the template. The more points under the reference plane the smaller the weld. In an actual 157

case, a limit is set to measure the number of points under the reference plane. These limits are obtained through large number of experiments.

The advantages of the template method compared to the spatial data analysis method are:



Since the number of thresholds needed for decision making of a template method (number of points under reference plane) is less than the spatial data analysis method (frequency, amplitude, phase, and cross correlation); the template method requires less computation than the spatial data analysis method, which result in shorter cycle time.

The disadvantages of the template method are:

  

The template method can only distinguish bad welds and good welds A complex decision making system is needed The template method involves point by point inspection, therefore, the inspection process may be computationally expensive when dealing with larger resolution images

 

The template method cannot tell the type of defects Templates need to be updated frequently

158

6.3

Summary

In this chapter, the implementation issues to a MIG weld inspection system are discussed. A laser scanner cell was built and tested in the lab. System hardware and components of the laser scanner cell were introduced. The approaches of applying spatial data analysis methods and template methods for MIG weld inspections were presented. The discussion was focused on how to apply the spatial data analysis method on MIG weld inspection for both overall shape errors and weld defect detection. Experiments show that by applying 2-D FFT directly on the 3-D scanning data after registration and truncation, the overall shape errors can be detected from the frequency based information. Afterwards, 1-D FFT is applied on projection data to detect the weld defect types.

The algorithm for the template method was introduced. The algorithms including registration, template creation, decision making were discussed. The advantages and disadvantages of the spatial data analysis method and the template method were listed and compared.

159

CHAPTER 7 CONCLUSION
7.1 Conclusions

In this thesis, a new spatial data analysis method is presented. The method is developed to analyze spatial data that was obtained by a 3-D laser scanner. The discussion was focused on both 2-D curve and 3-D shape analysis. The method utilizes the advantages of harmonic analysis, which is also known as Fourier transform, to obtain the harmonic information of a 2-D curve or 3-D shape. The harmonic information, the frequency, amplitude, and phase are defined as shape characteristics which represent the shape or body itself just like gene to a human. One of the significant applications of this method is automated inspection.

Research was carried out on inspection methods; 3D laser scanning technology; existing spatial data analysis methods for 1-D, 2-D and 3-D data; Fourier transform and its application; MIG weld inspection, etc. A projection method was developed for radiator support MIG weld inspection. Approaches, such as data calibration, maximum and minimum edge detection, have been developed. A journal paper was composed to summarize the achievements of projection method and was submitted in Aug 2009.

An inspection system is developed for engine cradle MIG weld quality inspection. Research on template method, registration method, decision making algorithms, nuts detection, etc. has been completed. A fully functional automatic laser scanner inspection cell is built and is currently running at Van-Rob Inc.'s North York plant. 160

7.2

Main research contributions

1. Use Fourier transform to obtain shape information on 2-D curves and 3-D shapes
The Fourier transform is a mathematical operation that decomposes a signal into its constituent frequencies. In this research, the Fourier transform is used to decompose a 2D curve or 3-D shape to obtain its harmonic information: frequency, amplitude and phase. For a 2-D curve, two 1-D FFT is applied on x and y series, and cross correlation is calculated between x and y series. A set of shape indices is created by this method. For a 3-D shape, two 2-D FFT is applied on x and y matrixes. A 3-D shape can be also analyzed by using a slicing method.

2. Apply spatial data analysis method on shape error inspections
The proposed spatial data analysis method is applied for shape error inspections. The method was verified on checking overall size changes and shape errors on a quarter circle. The quarter circle is an example of GD&T standard, profile of a line. The proposed method can be also used for 3-D shape error inspection.

3. Apply spatial data analysis method on MIG weld inspection
The proposed method was tested for MIG weld inspection. The method shows its ability of checking different types of weld defects such as undercut, small leg size, short weld, burn through, etc. by applying 1-D FFT on projection data. The analysis also showed that the method can detect overall shape error by applying 2-D FFT directly on 3-D scanning data. 161

4. A geometry projection method is developed for MIG weld leg size inspection
The projection method presented in this thesis is a brand new method for T-joint inspection. Different from the traditional leg sizes inspection methods which calculate the minimum values on all cross sections, the proposed method searches the minimum leg sizes on the projection data. The method significantly reduces the inspection time by working on projection data instead of cross section data. An intelligent MIG welding 3D inspection software is developed based on the projection method. The experiment results show that the method is effective for T-joint weld leg sizes inspection which has the same accuracy as traditional methods but more efficiency.

5. MIG weld inspection system was built and tested
An automated MIG weld inspection system was developed. The approaches to the MIG weld inspection system are presented. The algorithms including template creation, registration, decision making, and nuts detection methods were discussed and then followed by the system hardware and software introduction. A laser scanner cell was built.

7.3

Publications

A projection method for dimensional inspection of 3D MIG welds was proposed in [36]

162

7.4

Future work

In this thesis, spatial data analysis method was verified as to its feasibility in shape error inspection, future work includes:

   

research on the spatial data analysis method for industrial inspection applications; a training method to establish thresholds for the spatial method use of Neural Networks as defect identification method research on a diagnostic system that can link the shape characteristics with system input parameters

163

REFERENCES
[1] Du Q., Chen S., and Lin T., "Inspection of weld shape based on the shape from shading", International Journal of Advanced Manufacturing Technology, Vol. 27, pp.667-671, 2006 [2] Tseng C., Lai M., and Lee P., "Image inspection system for defect detection of multilayer ceramic capacitors", Proceedings - 2006 International Conference on Intelligent Information Hiding and Multimedia Signal Processing, pp.659-662, Pasadena, California, USA, 2006 [3] Kobayashi H.H., Hara Y., Doi H., Takai K., and Sumiya A, "Hybrid defect detection method based on the shape measurement and feature extraction for complex patterns", IEICE Transactions on Information and Systems, Vol. E83D, No. 7, pp.1338-1345, 2006 [4] Liu H., and Han J., "Defect detection in textiles using optimal Gabor Wavelet filter", Proceedings of the World Congress on Intelligent Control and Automation, pp.10005-10007, Dalian, China, 2006 [5] Furtler J., Bodenstorfer E., Mayer K.J., Brodersen J., Heiss D., Penz H., Eckel C., Gravogl K.,and Nachtnebel H., "High-performance camera module for fast quality inspection in industrial printing applications", Proceedings of SPIE-IS and T Electronic Imaging - Machine Vision Applications in Industrial Inspection Vol. 65030J, San Jose, California, USA, 2007 [6] Nagarajan R., Yaacob S., Pandian P., Karthigayan M., Hj Amin S., and Khalid M., "A real time marking inspection scheme for semiconductor industries", International Journal of Advanced Manufacturing Technology, Vol. 34, No.9-10, pp.926-932, 2007 [7] Zhou L., Chalana V., and Kim Y., "PC-based machine vision system for real-time computer-aided potato inspection", International Journal of Imaging Systems and Technology, Vol. 9, No. 6, pp.423-33, 1998

164

[8]

Huang C., Um C., and Uu M.C., "Comparison of Image Proceulng Algorithms and Neural Networks in Machine Vision Inspection", Computers and Industrial Engineering, Vol. 23, No. 1-4, pp.105-108, 1992

[9]

Foster III J.W., Griffin P.M., Messier S. L., and Villalobos J. R., "Automated visual inspection_A tutorial", Computers and Industrial Engineering, Vol. 18, No. 4, pp. 493-504, 1990.

[10] Newman T.S., "A Survey of Automated Visual Inspection. Computer Vision and Image Understanding", Computer Vision and Image Understanding, Vol. 61, No. 2, pp.231-262, 1995 [11] Gallegos-Hernandez A., J. Ruiz-Sanchez F., and Villalobos-Cano R., "2D Automated Visual Inspection System for the Remote Quality Control of SMD Assembly", IECON Proceedings (Industrial Electronics Conference), Vol. 3, pp.2219-2224, Spain, 2002 [12] Teutsch C., "Model-based Analysis and Evaluation of Point Sets from Optical 3D Laser Scanners", Magdeburger Schriften zur Visualisierung. Shaker Verlag, Vol. 1, 2007. [13] Lerma J.L, and Biosca J.M, "Segmentation and Filtering of Laser Scanner Data for Cultural Heritage", CIPA 2005 XX International Symposium, pp. 115-118, Torino, Italy, 2005 [14] Moganti M, Ercal F, Dagli C.H., and Tsunekawa S, "Automatic PCB inspection algorithms: a survey", Journal of Computer Vision and Image Understanding Vol. 63, No.2, pp.287-313, 1996 [15] Tsai D.M., and Hung C.Y., "Automatic defect inspection of patterned thin film transistor-liquid crystal display (TFT-LCD) panels using one-dimensional Fourier reconstruction and wavelet decomposition", International Journal of Production Research, Vol. 43, No. 21, p4589­4607, 2005 [16] Jia H, Xi F, Ghasempoor A and Dawoud A, "A Tolerance Method for Industrial Image-based Inspection", The International Journal of Advanced Manufacturing Technology, Vol. 43, No. 11-12, pp.1223-1234, 2008

165

[17] Tsai D.M. and Lin C.P., "Fast Defect Detection in Textured Surfaces Using 1D Gabor Filters", International Journal of Advanced Manufacturing Technology, Vol. 20, pp.664­675, 2002 [18] Kong FH, "A new method of inspection based on shape from shading", 1st International Congress on Image and Signal Processing, pp. 291-294, Sanya, Hainan, China, 2008 [19] McInerney T, and Terzopoulos D, "Deformable Models in Medical Image Analysis:A Survey", Medical Image Analysis, Vol. 1, No.2, pp.91­108,1996 [20] Velten J., Kummert A., and Maiwald D., "Image Processing Algorithms for Video Based Real-Time Railroad Track Inspection", Midwest Symposium on Circuits and Systems, Vol.1, pp.530-533, 1999 [21] Zhang Y., Zhang Z., and Zhang J., "Deformation Visual Inspection of Industrial Parts with Image Sequence", Machine Vision and Applications, No.15, pp. 115-220, 2004 [22] Porter G. B., "An Application of Grey Level Image Processing to An Industrial Dimensional Inspection Problem", Pattern Recognition, Vol.14, No.1-6, pp.405-410, 1981 [23] Tien F.C., Yeh C.H. and Hsieh K.H., "Automated visual inspection for microdrills in printed circuit board production", International Journal of Production, vol. 42, no. 12, pp.2477­2495, 2004 [24] Moellering H., Rayner J.N., "The harmonic analysis of spatial shapes using dual axis Fourier shape analysis", Geographical Analysis, Vol. 13, no. 1, pp.64-77, 1981 [25] Crimmins T.R., "A complete set of Fourier descriptors for two-dimensional shapes", IEEE Transactions on System, Man, and Cybernetics, Vol. smc-12, No. 6, pp.848855, 1982 [26] Kuhl F.P., Giardina C.R., "Elliptic Fourier features of a closed contour", Computer Graphics and Image Processing, Vol. 18, pp.236-258, 1982 [27] Do N.D., Osowski S., "Shape recognition using FFT preprocessing and neural network", The International Journal for Computation and Mathematics in Electrical and Electronic Engineering, Vol. 17, No. 5-6, pp.658-66, 1998 166

[28] Xi F., "3D Shape Error Analysis Using a Spatial Modal Expansion Method", Proceedings of the 1998 CIRP International Conference on Intelligent Computation in Manufacturing Engineering, pp.351-356, Capri, Italy, 1998 [29] Garcia D., Sebastian J.M., Sanchez F.M., Jimenez L.M., Gonzalez J.M., "3D inspection system for manufactured machine parts", Proceedings of the SPIE - The International Society for Optical Engineering, Vol. 3652, pp.250-260, USA, 1999 [30] Takagi Y, Hata S, Beutel W, "Visual inspection machine for solder joints using tiered illumination", Proceedings of the SPIE - The International Society for Optical Engineering, Vol. 1386, pp. 21-29, 1990 [31] Yu L., Yang Y., Sun S., "Solder joint shape inspection using least square fitting", Chinese Journal of Scientific Instrument, Vol. 28, No. 7, pp.1255-1258, 2007 [32] Fu X., Lin S., Yang C., Fan C., Qian X., "Inspection of fillet weld shape dimension based on laser vision sensing", Hanjie Xuebao/Transactions of the China Welding Institution, Vol. 29, No. 7, pp.47-50, 2008 [33] Prieto F., Lepage R., Boulanger P., Redarce T, "Inspection of 3D parts using high accuracy range data", Proceedings of the SPIE - The International Society for Optical Engineering, Vol. 3966, pp.82-93, USA, 2000 [34] Chang C.L., and Chen Y.H., "Measurements of fillet weld by 3D laser scanning system", International Journal of Advanced Manufacturing Technology, Vol. 25, pp.466­470, 2005 [35] Lee J., Im P., Park Y.J., and Kim J., "Welding bead and chamfer inspection by means of laser vision", Proceedings of SPIE Vol. 4190, pp. 41-50, 2001 [36] Jia H., Xi F., Chan V., Guo, H., and Zeng. C, "A Projection Method for Dimensional Inspection of 3D MIG Welds", International Journal of Advanced Manufacturing Technology, Submitted in 2009 [37] Noruk J., "Visual weld inspection enters the new millennium", MCB University Press, Vol. 21, No. 4, pp. 278-282, 2001

167

APPENDIX A: WELD DEFECT DETECTION CALCULATION VALUES
Table A.1 Weld defect detection calculation values

Good Welds Scanning ID 780 778 777 776 775 774 773 772 771 Average STD Amplitude Difference Mean Deviation^2 -0.0367 0.0022 -0.0669 0.0003 -0.1768 0.0086 -0.1687 0.0072 -0.0670 0.0003 -0.0884 0.0000 0.0781 0.0263 -0.0871 0.0000 -0.1423 0.0034 -0.0840 0.0054 0.0777 0.0085 Phase Difference Mean Deviation^2 -7.4770 3.9804 -13.8471 69.9766 -0.5396 24.4263 -0.4815 25.0040 -5.9613 0.2298 -6.7054 1.4970 0.0056 30.1127 -7.4615 3.9188 -6.8693 1.9249 -5.4819 17.8967 4.4871 22.8580 Bad Welds 30.6827 590.5678 189.4560 1254.2860 168 Amplitude Cross Correlation Difference Mean Deviation^2 -0.1977 0.0991 -0.3607 0.0231 -0.9530 0.1940 -0.9094 0.1575 -0.3612 0.0229 -0.4767 0.0013 0.4212 0.8719 -0.4694 0.0019 -1.3061 0.6297 -0.5126 0.2224 0.5002 0.3133 Phase Cross Correlation Difference Mean Deviation^2 1993.1000 826270.1324 543.2000 292579.2768 216.0219 753569.9661 192.7552 794506.2090 1393.0000 95415.5170 1684.3000 360232.8643 -2.2233 1180111.2998 1986.9000 815037.0466 1749.9000 443281.6800 1084.1060 617889.3324 833.7419 339791.5322

753 779 796 648

-1.0028 0.0046 -0.0001 1.6420

0.7405 0.0078 0.0070 2.9790

0.0573 -29.7835 -19.2462 -40.8978

-1.0050 0.0083 -0.0002 8.8524

0.2425 0.2713 0.2625 87.7024

-21.0052 10927.0000 7060.9000 16372.0000

1221270.7152 96882562.7327 35722066.7841 233719703.6347

APPENDIX B: ROAD MAP
B.1

SOFTWARE DEVELOPMENT

Main Software Interface

The software development of MIG weld inspection system has been gone through several phases. The first version of the software has only one basic function that is to calculate the leg sizes of a T-joint weld and compare to the pre-defined values to check the quality. A Picza 3-D laser scanner was used for data acquisition. The algorithm used in this version is projection method. In the second version, 3-D data comparison function was added.

The Third version of software was developed based on SICK 3-D laser scanner, more function modules were added, including teach mode and analysis window. The interface is more users friendly, live and difference image are displayed at the same time. The software also displays system status, etc. Only eight welds on front side of delta engine cradle is scanned and inspected. These welds include four ring welds, two straight welds and four u-shape welds. The algorithm used in this version is template method.

The software interface layout was updated in the fourth version. More welds were added for inspection, including eight ring welds, four straight welds, six u-shape welds and seven nuts detection. The software was developed for E-flex engine cradle for lab tests. In version 5, the software interface layout was updated in this version. Welds being 169

inspection include eight ring welds, four straight welds, six u-shape welds and four nuts detection. The software was developed for Delta engine cradle for lab tests. Two more inspection locations were added in software version 6. They are two straight welds on the back of engine cradle, SL1 and SL2. The software was developed for both Delta and Eflex engine cradles.

A limit, bee hive threshold and tolerance setup module was added in version 7. The module can save and load values for different production lines. The function of this module was introduced in Chapter 6. Version 8 was developed for a new holding fixture, as shown in picture below. The new fixture is rotate 180 degree upside down to fit the lift assist. The changing is due to the less of labor. With lift assist, only one operator is needed to load and unload the part instead of two operators.

Figure B.1: Part being hold by a lift assist In this version, the software only checks the welds, nuts and features on front side of delta engine cradle, including four ring welds, four u-shape welds, twelve straight welds, 170

four nuts and two spacers. The plant flow is: 1. Parts load on scanner cell to check front side; 2. Result is shown to rework operator while he is checking back side of the cradle; 3. Operator repairs front side welds when necessary. Inspection of a M12 nut on front engine bracket is added in version 9. Also, the name of the welds, nuts and spacers are updated to be consistent with production ID.

In version 10, an automatic update function is added. The function is used when more than one weld's parameters are changed and more than one weld templates need to be updated. The function automatically updates all templates regardless inspection result. To turn on the automatic update function, press the AUTO UPDATE button before scanning. A message box will reminds user that a qualified part must be scanned.

Figure B.2: Main software version 10 171

B.2

Teach mode (Minimum Algorithm and Average Algorithm)

Teach mode was developed using both minimum and average algorithm at the beginning of the project. Minimum algorithm was decided as final choice after discussing with company engineers.

Figure B.3: Teach mode ­ minimum algorithm

Figure B.4: Teach mode ­ average algorithm 172

B.3

Analysis window

The interface of analysis windows has no major changes during the development of the system.

Figure B.5: Analysis window

173

B.4

PLC and Software Test Program

The program was developed tests the PLC hardware, and the communication between PLC controller, computer, robot controller and scanner, etc. The program tests both functionality and stability.

Figure B.6: PLC & software testing program

174

B.5

Data Collection Program

An automatic data collection program was developed basing on the PLC and Software Test Program mentioned in previous section. The program automatically displays current scanning image and saves scanning images in pre-defined folder.

Figure B.7: Data collection program

175

B.6

Limit, Bee Hive Threshold and Tolerance Setup Module

The first version of limit, bee hive threshold and tolerance setup module has only a basic function of saving user defined parameters according to three production lines.

Version 2 of limit, bee hive threshold and tolerance setup can also display previous setups and save new setups according to different production lines.

Version 3 of limit, bee hive threshold and tolerance setup has been improved for technician and engineers tuning purposes. The program loads and displays last inspection parameters as reference. Also, a button to call out template update tool is added for convenience. In the newest version, setup for M12 nut inspection on front engine bracket is added. Also, the name of the welds, nuts and spacers are updated to be consistent with production ID.

176

B.7

Nuts Detection

Nuts detection is one of the additional objectives set by the company management team after they find out the advantages of laser scanner. The presence of the nuts is really important to both customers and company itself. Figure B.8 shows the location of eight nuts.

Figure B.8: Total 8 nuts on Delta cradle The target is to check the presence of the nuts. To let the scanner `see' the nuts, the scanner needs a special angle, so that the laser shooting on the nuts can travel back to the camera. Due to the size and accessibility limitation, only a small portion of the nuts can be seen by laser scanner, which is the area inside the red circles in Figure B.9.

177

Figure B.9: ROI of nuts detection One of the major advantages of 3-D laser scanner is that it measures the height of the objects. In Figure B.9, the areas that have any color means there is height information measured by the camera. The areas in black means there are no objects inside the field of view. In the other word, the value of those pixels in black is zero. The nuts detection just utilizes this feature. Firstly, a region of interest (ROI) is defined which must cover the nuts. Secondly, the number of pixels, n inside the ROI is counted. The total height H of this ROI is calculated as:
H   Zi
i 1 n

(A.1)

where Zi is the height on point i . And the density Dn of ROI is calculated as,

178

Dn 

H  n

Z
i 1

n

i

n

(A.2)

Figure B.10 is an example when nuts are present. In zone 1, there are total 132 pixels. The total height is 6858, and the density is 51.9545. In Zone 2, there are total 120 pixels. The total height is 5531, and the density is 46.0917.

Number of Pixels Zone1: 132 Zone2: 120 Density: Zone1: 51.9545 Zone2: 46.0917 Sum: Zone1: 6858 Zone2: 5531

Figure B.10: M8 nuts present Figure B.11 is an example when nuts are missing. Figure B.12 is the example of nuts on the top of the engine cradle. The densities of two ROI are 85.5159 and 147.2333. On Eflex cradle, there are four M6 nuts. The hole is smaller than M8, therefore the ROI are smaller than M8 nuts.

179

Number of Pixels Zone1: 132 Zone2: 120 Density: Zone1: 0 Zone2: 0

Figure B.11: M8 nuts missing

Number of Pixels: Zone1: 126 Zone2: 90 Density: Zone1: 85.5159 Zone2: 147.2333 Sum: Zone1: 10775 Zone2: 13251

Figure B.12: M8 nuts missing

180

APPENDIX C:

MIG WELD INSPECTION

SOFTWARE INTRODUCTION
The software is programmed in MATLAB and is packed into executable program for production application. Double click the `MIG Welding Inspection System' icon on the computer desktop, and then click the `START' button to start the inspection, see Figure B.1.

Figure C.1: Start the inspection program The software will automatically detect the image pool during the scanning process. Once the pre-defined number (current setup is 25) is reached, the software will inspect the quality of each weld right away, the result will be shown within 5 seconds. The result is shown on the left hand window, with green color for good welds and red color for bad welds. If the parts being inspected is decided as qualified, the clamp holding the part will 181

open automatically, otherwise, the clamp will keep closing until auto cycle rest key is turned. Figure C.2 shows the screen shot when a bad weld is detected.

Figure C.2: Inspection results

C.1

Software interface

The main interface consists of six major panels: results direct show zone, limit and tolerance setup panel, live scanning image, review and statistics tool, status panel and template update tool panel, see Figure C.3. The program provides a `Mode Selection' menu, see Figure C.4. Under the modules: `Mode Selection' menu there are four different



`Teach Mode (Minimum Algorithm)' to launch the teaching mode (training mode);

 

`Analysis' to view the details of all unqualified welds; `Limits and Tolerance Setup' to setup the limits and tolerance for each weld; 182



`Template Update Tool' to update weld template(s) when welding parameter is changed by technician

Limit and Tolerance Setup Panel Result Direct Show Zone Live Scanning Image Review and Statistics Tool Status Panel Template Update Tool

Figure C.3: Software panels

Figure C.4: Teach Mode (Training Mode) Selection Teach mode is used to create templates for each weld, the interface is shown in Figure C.5. This function is used when inspection software is running at the first time. To create templates, first, input the number of image sets to create templates (The default number is five), and then click on the `CREATE TEMPLATE' button, follow the instruction on the 183

screen. The parts used to create templates must have been manually checked as good parts.

Figure C.5: Teach Mode Interface Analysis mode display the scanning images and camparison images for all unqualified welds. Figure C.6 is the screen shot of the analysis window.

Figure C.6: Analysis window 184

The inspection system check each weld basing on a set of parameters. These parameters are mean value, limit, tolerance and bee hive threshold. Each weld has its own set of settings. The values of these settings are acquired from the analysis of a great amount of experiments. Due to the part variations of different production lines, the software reserves the options for line selection, as shown in Figure C.7.

Figure C.7: Limits and tolerance setup tool Due to the frequent changes of welding parameters or welding robot position, the shape of the welds change frequently. Therefore, it is necessary to update the template(s) when there is a weld shape change. To update the template, click `UPDATE TOOL' in the template update panel. To prevent misoperation, password is needed, see Figure C.8.

Figure C.8: Password is needed when update templates 185

In the template update tool window, click the weld(s) to be updated or click on "update all" to update templates of all welds. Figure C.9 is the screen shot of the templates update tool.

Figure C.9: Templates update tool A pop-up message box will display when update is done.

Figure C.10: Pop-up message box confirms the template update 186

The software provides a review function for quality department and management team to track earlier inspection results, including both raw images and decisions on each weld.

Figure C.11: Review function Statistics tool provides data log, error percentage calculation and file export functions. Log function lists all the inspection results of each part. Error percentage calculation function computes the error rate on each weld. The user can also export the data log into excel files for further analysis.

Figure C.12: Review inspection log 187

Figure C.13: Percentage calculation Reset button will reset all current process to initial state, including empty image pool, clear status panel and image dispay zone, etc.

Figure C.14: Reset confirmation message box

188

C.2

MIG weld inspection system floor tests

The first phase testing of laser scanner cell has been carried out from September to November 2010. The laser scanner cell testing includes hardware reliability tests and software tuning. The hardware reliability tests include robot path adjustment and PLC communication tests. The target of software tuning includes both reliability and accuracy. The testing is scheduled to run every day from 8am to 3pm covering the day time shift. In the first two testing weeks, 150 parts, more than 3600 images have been collected. These data are used to tune the software package, including window functions, registration functions, rotation functions, software flow, and software interface. Figure C.15 shows the work flow of laser scanner cell testing.

Figure C.15: Laser scanner cell testing flow

189

Operator unloads the part from conveyor at location 1. And then loads the part on the laser scanner cell holding fixture at location 2. Operator swipe the button to start the inspection. The machine runs about 60 seconds. The result is shown on the computer screen and recorded for future analysis. The rework operator unloads the part from the holding fixture and loads it onto the rework station at location 3. A correlation study of is taken to compare the results from operator and computer. During this phase of testing, 100% Nut detection (For all Delta nuts and E-Flex Nuts), 28 critical welds and 8 nuts for delta, 28 critical welds and 13 nuts for E-Flex per part were considered currently (at rings, control arm and front rails). Welds can be added or removed based on request.

Current cycle time is 55s for Delta cradle (exclude loading and unloading time). The parts are loaded and unloaded manually during the first phase testing.

Issues that arise during the first phase testing are:

 Zinc residue
­ Brings noise to scanning data. Problem solved by filling the data based on the size of the noise

 Welds differences between production lines
­ Different templates are created for each production lines, and also different limit and tolerance setups for 3 lines

 Welds parameters change frequently
­ weld templates need to be adjusted accordingly

 Subjective quality standards from different rework operators
190

­

Affect the limit and tolerance setup, the correlation study helps to match the standards between computer and operators

At the end of first phase testing, total 900 parts were scanned; more than 20,000 images were collected so far. The accuracy of nut detection is 100% and about 98% accuracy on weld inspection, the 2% fault alarm are on good welds but detected as bad welds

191

