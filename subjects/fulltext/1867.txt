Ryerson University

Digital Commons @ Ryerson
Theses and dissertations

1-1-2012

Modeling and Analysis of a Flywheel Energy Storage System for Voltage Regulation
Kamran Masteri Farahani
Ryerson University

Follow this and additional works at: http://digitalcommons.ryerson.ca/dissertations Part of the Energy Systems Commons Recommended Citation
Farahani, Kamran Masteri, "Modeling and Analysis of a Flywheel Energy Storage System for Voltage Regulation" (2012). Theses and dissertations. Paper 1288.

This Thesis is brought to you for free and open access by Digital Commons @ Ryerson. It has been accepted for inclusion in Theses and dissertations by an authorized administrator of Digital Commons @ Ryerson. For more information, please contact bcameron@ryerson.ca.

MODELING AND ANALYSIS OF A FLYWHEEL ENERGY STORAGE SYSTEM FOR VOLTAGE REGULATION

by

Kamran Masteri Farahani, B.A.S.c, Toronto, 2010

A thesis presented to Ryerson University in Partial Fulfillment of the Requirements for the degree of Master of Applied Science in the program of Electrical and Computer Engineering

Toronto, Ontario, Canada, 2012 ©(Kamran Masteri Farahani) 2012

Author's Declaration Page

I hereby declare that I am the sole author of this thesis or dissertation. I authorize Ryerson University to lend this thesis or dissertation to other institutions or individuals for the purpose of scholarly research.

I further authorize Ryerson University to reproduce this thesis or dissertation by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research.

ii

Thesis Title: modeling and analysis of a flywheel energy storage system for voltage regulation Degree: Master of Applied Science Convocation Year: 2012 Student Name: Kamran Masteri Farahani Graduate Program: Electrical and Computer Engineering Ryerson University

ABSTRACT
Ontario in 21st century is progressing rapidly to source a bulk of its energy supply from green and renewable energy sources, including wind energy. However there are technical challenges. A significant limiting factor in the large-scale integration of wind energy is the inherent intermittent nature of wind supply. The purpose of the research project is to develop appropriate control systems to integrate energy storage into the Ontario electricity grid given that energy storage constitutes a fundamental component of a modernized electricity grid. The challenges are multiple. Given that wind generators driven by wind have an output that is intermittent and highly variable, as a result the power supply voltages on distribution lines change at a rapid rate. This research develops a control strategy for the flywheel system to inject or draw real power to or from the connected line on a voltage command, thereby mitigating voltage swings created by variable and intermittent power supply from wind generators.

iii

ACKNOWLEDGEMENTS
I would like to thank my supervisor Dr. Bala Venkatesh for giving me the opportunity to work on this thesis. I am greatly indebted for his encouragement, support and guidance given during this project. I attribute the level of my Master's degree to his encouragement and effort and without him this thesis, too, would not have been completed or written. One simply could not wish for a better or friendlier supervisor.

I was delighted to interact with Dr. David Xu by attending his classes and having him as my co-supervisor. His insights to Power Electronic designs are second to none. Besides, he sets an example of a world-class researcher for his rigor and passion on research. I also wish to thank Dr. Daniel Cheng for his interest in this topic and patience during the preparation of this thesis and sharing his technical knowledge and spending his valuable time during the crucial parts.

Financial supports from the Centre of Urban Energy and Department of Electrical and Computer Engineering are greatly acknowledged.

iv

DEDICATION

"Dedicated to my beloved family who have provided me encouragement and support throughout my studies"

v

TABLE OF CONTENT
Title page Author's Declaration Page Abstract Acknowledgements Dedication Table of Contents List of Tables List of Figures 1. Introduction 1.1 General 1.2 Introduction to flywheel 1.3 Literature survey: Electrical energy storage and topologies 1.3.1 Electrochemical energy storage 1.3.2 Electrostatic energy storage 1.3.3 Electromagnetic energy storage 1.3.4 Electromechanical energy storage 1.4 Power quality 1.5 Voltage sags 1.6 Objective of this thesis 1.7 Chapter-wise outline 2. System configuration and control system 2.1 System configuration 2.2 Controlling strategy 2.2.1 Field oriented control 2.2.2 Voltage oriented control 2.3 Summary 3 Proposed voltage regulation 3.1 Introduction 3.2 Tasks to solve the problem 3.3 Thevenin theorem 3.4 Thevenin voltage of the 96 bus system 3.5 Thevenin impedance of the 96 bus system 3.6 Verifying the Thevenin system 3.7 Optimization algorithm 3.8 Complete formulation 4 Tests and results 4.1 Outcome from the algorithm 4.2 Test Results 4.3 Implementation of the algorithm in the control drive as look-up tables 4.4 Comparison between Different Scenarios 4.5 Summary 5 Conclusion and Future Work 5.1 Conclusion References Appendix I Ii Iii Iv V Vi Vii Viii 1 1 1 7 8 9 10 11 12 15 17 18 19 19 20 21 22 23 24 24 24 25 26 27 30 31 34 35 35 37 38 39 39 40 40 41 44

vi

LIST OF TABLES

Table 1.1 Table 1.2 Table 1.3 Table 1.4 Table 1.5 Table 4.1 Table 4.2

Flywheel shape factors Specific strengths of flywheel materials Comparison of typical flywheel energy storage capabilities Technical and economic aspects of different mitigation methods Pre-Contingency voltage limits P and Q of the flywheel in order to keep Vpcc within the limit Power sequences of the flywheel to keep Vpcc within the limit

6 6 7 15 17 35 37

vii

LIST OF FIGURES

Figure 1.1 Figure 2.1 Figure 2.2 Figure 2.3 Figure 2.4 Figure 3.1 Figure 3.2

Possible sag mitigation method Basic circuit of flywheel energy storage system Single Line Diagram of a flywheel energy storage system Field oriented control model breakup Voltage oriented control model breakup Wind-turbine generator bus is open in H.O.N.I. 96 bus system Finding the voltage at bus 7081 when wind-turbine is generating 9MW in 96-bus system

12 20 21 22 23 27 30

Figure 3.3

Finding the voltage at bus 7081 when wind-Turbine is generating 9MW in Thevenin system

30

Figure 3.4 Figure 4.1 Figure 4.2

Representation of the equivalent system Ratios of P and Q of the flywheel with respect to Pwind Comparing the value of apparent power when P=0 and P 0

32 36 39

viii

Chapter 1 INTRODUCTION

1.1

General Power quality problems such as voltage sags are commonly caused by large

wind turbines connected to the far end of long feeders or switching in/out of large loads. Controlling these voltage sags is important aspect in providing a quality supply to customers. In the past, several methods of controlling voltage sags have been investigated such as static var sources, etc. This thesis explores the use flywheel to mitigate power quality problems.

1.2

Introduction to Flywheel This section provides a gives brief introduction of flywheel, voltage sags, energy

storage and topology. In this chapter various systems for protecting industrial processes against voltage sags have been compared (flywheel, static UPS, dynamic voltage restorer, statcom, shunt connected synchronous motor and a transformerless series injector). A flywheel stores kinetic energy by accelerating a heavy cylindrical mass (flywheel) using an electric motor. To discharge, the flywheel drives a generator to produce electricity. The earliest form of a flywheel is found in the Neolithic spindle and the potter's wheel [1]. The wheel is a disc made of wood, stone or clay. It rests on a fixed pivot and can be rotated around its center. The energy stored in a potter's flywheel

1

is about 500J, which is by no means negligible [2]. The main disadvantages are friction and material integrity. Most of energy is lost in overcoming frictional losses. There were two important developments during Industrial Revolution in the nineteenth century: one is the use of flywheels in steam engines and the other is extensive use of iron. Making the flywheels out of iron had the benefit of greater material integrity. Also they could be built in a single piece and could handle more mass and moment of inertia compare to other flywheels in the same volume. More recently, the ability of a flywheel to deliver high power in a short time has been used in applications such as mechanical presses, lubrication or cooling pumps, mine locomotives, inertial friction welding and inertial starters. By development of science towards the use of high-strength composite materials, the new generation flywheels were made. These new flywheels can store more energy at higher speeds for a given mass than a steel flywheel. It was after this breakthrough that engineers thought of using a composite flywheel energy storage system for electric vehicles and stationary power backup [20]. Flywheels store energy in the form of kinetic energy. The amount of energy `E' stored in a flywheel varies linearly with moment of inertia `I' and with the square of the angular velocity ` '. 
# $ $

(1.1)

The moment of inertia is a physical quantity, which depends on the mass and shape of the flywheel. It is defined as the integral of the square of the distance `x' from the axis of rotation to the differential mass ` '. I $  2

(1.2)

The solution for a cylindrical flywheel of mass `m' and radius `r' will be:  J$ and 
# $

(1.2a)

 J$

$

(1.2b)

Since the energy stored is proportional to the square of angular velocity, increasing the angular speed increases stored energy more effectively than increasing mass. On the other hand, increasing angular speeds result in increased frictional losses and hence thermal problems. With the help of magnetic bearing technology, the frictional losses due to bearings can be overcome, but at the expense of reliability. Also the energy stored can be expressed in terms of peripheral velocity `v', which is defined as the product of perpendicular distance from the axis of rotation and angular speed as:

The tensile strength, ' , of the material limits the peripheral velocity, and hence the amount of energy stored. For a mass density ` ', the tensile strength is defined as: $ (1.4)



J

or



# $

 $

(1.3)

Energy density is a term generally used to characterize an energy storage system. Usually high energy density is preferred, but this can pose thermal problems. Energy density, ` ', is loosely defined for a flywheel as the ratio of energy stored to its mass:
# $

J$

$

(1.5)

3

The volume energy density, ` ', is obtained by substituting `m' in the stored energy equation, as the product of volume and the mass density:  `
# $

J$

$

(1.6)

Therefore, if the dimensions are fixed, the maximum energy stored per volume ' depends on the tensile strength of the material as: 
# $

(1.7)

where `

' is the maximum tensile strength of the flywheel material. ' is

Similarly the maximum energy stored per mass ` 
#  $ 

(1.8)

Therefore, the maximum energy storage capacity can be achieved by using a material with a low density and high tensile strength. Depending on the application, either volume energy density or mass energy density takes precedence during the design stage. For a transportation application, mass energy density is a major consideration, since mass is a limiting factor. The energy density expressions above apply for a simple rim type flywheel. There are many designs for flywheels, and the general expression of maximum energy stored per mass is:  H




(1.9)

4

where `K' is defined as the flywheel shape factor, which depends on the geometry of the flywheel. The flywheel shape factors for several different types of flywheels are given in Table 1.1. The value of `K' is obtained from the equation for the moment of inertia (1.2). The stress distribution in a flywheel due to centrifugal loading becomes complex for shape factors greater than 0.5, and a detailed analysis needs to be done to safely achieve it. For low speed flywheels, the best way to maximize stored energy is by increasing moment of inertia. A massive rim or disc made of high density material such as cast iron or steel is sufficient in these cases. The main advantages of low speed flywheels are that they use a well-established technology and they are cheaper to build. [2] For high-speed applications, small discs with a constant stress profile, built with a low density and high strength materials, are better for maximizing energy density. The most commonly used composite material is Kevlar, a plastic material reinforced with glass, carbon or aramid fibers. The main disadvantage of this material is its high cost. The cheapest composite material is S-glass, but this material has lower fatigue strength. The specific strengths of different flywheel materials are listed in Table 1.2. A comparison of flywheel energy storage capabilities is given in Table 1.3. [2] There is also a safety factor, which limits the amount of stored energy available for discharge [3]. When this is considered, the useful energy stored per mass is given by:  { .  $ { H
 

(1.10)

where `S' is the ratio of minimum to maximum operating speed, usually set at 0.2. So the maximum amount of energy stored doesn't depend directly on inertia or on the 5

angular velocity, since either of these can be chosen independently to obtain the required design stress. And within the design stress, the amount of energy stored is linearly proportional to the moment of inertia and to the square of its angular velocity.

Flywheel Shape Constant stress disk Constant thickness disc Thin rim Constant stress bar Rod or circular brush Flat pierced disc

K 0.931 0.606 0.500 0.500 0.333 0.305

Table 0.1 Flywheel Shape Factors [2]

Flywheel Material Cast iron Carbon steel Alloy steel Wood Kelvar S-glass Graphite

Specific Strength(kJ/kg) 19 44 100 130 1700 1900 8900

Table 0.2 Specific strengths of flywheel materials [2]

6

Material Wood birch Mild steel S-Glass Maraging steel Carbon 60% fibre Kevlar 60% fibre

Density ( 0.55 7.80 1.90 8.00 1.55 1.40

X ) 

Useful Energy( 21.0 29.5 70.5 86.4 185.4 274.3

 ) X

Mass of the Flywheel( X{ 1720 1220 509 417 194 131

0.3 Comparison of typical flywheel energy storage capabilities [3]

New designs of flywheel include the improvement of driving program for generating motor. It is done to increase the rotational speed of a compact flywheel energy storage system that uses a superconducting magnetic bearing (SMB) and a permanent magnet bearing (PMB)[14].

1.3 Literature Survey: Electrical Energy Storage and Topologies This section discusses different available electrical energy storage technologies and the reason for preferably using flywheel energy storage. Energy can neither be created nor destroyed. But it can be transformed from one form to another. Electrical energy is the form of energy that can be transmitted efficiently and easily transformed to other forms of energy. The main disadvantages with electrical energy involve storing it economically and efficiently. Electrical energy can be converted and stored in different forms: Electrochemical Energy Electrostatic Energy 7

-

Electromagnetic Energy Electromechanical Energy

1.3.1 Electrochemical Energy Storage In this type of storage, electrical energy is converted and stored in the form of chemical energy. There are two main categories: batteries and fuel cells [3]. Batteries use internal chemical components for energy conversion and storage whereas fuel cells use synthetic fuel (for example Hydrogen, methanol or hydrazine) supplied and stored externally. Both use two electrodes, an anode and a cathode, that exchange ions through an electrolyte internally and exchange electrons through an electric circuit externally. The Lead-acid battery, discovered by Plante in 1859, is the most widely used battery. The battery consists of pairs of lead electrode plates immersed in a dilute sulphuric acid that acts as an electrolyte. Every alternate lead plate is coated with lead dioxide. Discharging results in the conversion of both of the electrodes to lead sulphate. Charging restores the plates to lead and lead dioxide. The physical changes in electrodes during charging and discharging deteriorates the electrodes and hence reducing their life. The main advantages are they have a well-established technology. The main drawbacks with batteries are: Slow response during energy release Limited number of charge discharge cycles Relatively short life time High internal resistance Low energy density Maintenance requirements for some types Environmental hazards 8

W. R. Grove demonstrated the first hydrogen-oxygen fuel cell in 1839. The byproduct of a Hydrogen fuel cell is water. By electrochemical decomposition of water into hydrogen and oxygen and holding them apart, hydrogen fuel cells store electrical energy. During discharge, the hydrogen is combined with oxygen, converting the chemical energy to electrical energy. The main advantages are environment friendly. The main drawbacks with fuel cells as energy storage elements are: Slow response during energy release Temperature dependence Corrosion problems Hydrogen storage Inefficient transfer of electrical energy to chemical energy

1.3.2 Electrostatic Energy Storage Electric energy can be converted and stored in the form of electrostatic field between the parallel plates of a charged capacitor. The amount of energy stored is proportional to square of the voltage across the parallel plates and to its capacitance. For a fixed voltage, the volume energy density for a parallel plate capacitor is proportional to capacitance, which is proportional to the permittivity of the insulator between the parallel plates. Most of the insulators have relative permittivity in the range of 1 to 10. Due to the small capacitance, ordinary capacitors can store very limited amount of energy. Ultracapacitors use electrochemical material for improving permittivity and hence energy density. They require less maintenance and have much longer lifetimes compared to batteries. They have high energy density and do not have moving parts. The main drawbacks with capacitors are: 9

-

Cost Temperature dependence Not rugged

1.3.3 Electromagnetic Energy Storage Electric energy can be converted and stored in the form of an electromagnetic field. A Superconducting magnetic energy storage (SMES) coil consists of a superconducting coil carrying large DC currents. The amount of energy stored is proportional to the square of the DC current flowing through the coil and to its inductance. The volume energy density is proportional to the permeability of the material used for the coil. In order to keep the temperature of the superconductor below its critical temperature, a cryogenic cooling system is required. Increasing the DC current increases the amount of energy stored. Once the current in the coil reaches its maximum value, the voltage across it is zero and the SMES is fully charged. This storage scheme has very low losses due to negligible resistance in the coil. Also SMES coils can be built for larger energy and power. The main drawbacks with SMES are: Cost Reliability in maintaining cryogenic cooling Compensation of external stray fields Electromagnetic forces on the conductors Bulk/volume

10

1.3.4

Electromechanical Energy Storage

Electrical energy can be converted and stored in the form of kinetic energy in a flywheel. Motor/generator sets, DC machines and induction machines are used for energy conversion. The amount of energy stored in a flywheel is proportional to the square of angular velocity and to its inertia for a given design stress. The energy storage technologies discussed above have their own advantages and disadvantages but the following advantages make flywheels a viable alternative to other energy storage systems: Low cost High power density Ruggedness Greater number of charge discharge cycles Longer life Less maintenance Environmental friendly Fast response during energy release

Flywheels can be designed for low speed or high-speed operation. A low speed flywheel has advantages of lower cost and the use of proven technologies when compared to a high-speed flywheel system. The main disadvantages are: less energy stored per volume higher losses increased volume and mass

11

1.4

Power Quality Sags are known to be among the most costly power quality phenomena in

industry. Different solutions exist to reduce the costs incurred due to sags: they are often structured in the four categories listed in Figure 1.1 [5].

Figure 1.1 Possible sag mitigation method

Modifications in the process equipment itself (Number 1 and 2 in Figure 1.1) tend to be the cheapest to implement but are not always possible because manufacturers have not made suitable equipment readily available in the market. Modifying the grid, (Number 4 in Figure 1.1), although an interesting option, is not always possible and is likely to be very expensive. The only methods that can generally be applied are protective measures installed between the sensitive process and the grid (Number 3 in Figure 1.1), and these are discussed in this section. In theory, installing an uninterruptible power supply (UPS) is the easiest way to protect sensitive processes against all sags. However, due to its considerable purchase and maintenance costs, UPS equipment is installed on a structural basis only in places where the damage resulting from power supply problems is very high, such as in hospitals, computer facilities and financial institutions. In other cases, including most 12

industrial processes, the installation of protective equipment must be subject to a costbenefit analysis, which often shows that installing a UPS is too expensive [6]. This section discusses some of the physical and performance characteristics of various voltage-sag protective product categories currently available on the market in comparative terms. For each type, each characteristic is indicated as an advantage (+), neutral (=) or as a disadvantage (-). Size Some systems are currently only available in sizes larger than 1 MW (-), while others are also sold in sizes smaller than or equal to 100 kW (+). Purchase cost Since the decision to buy mitigation equipment to prevent damage due to voltage sags is the outcome of a cost-benefit analysis, the purchase price of the system is very important. Although contracts are made on an individual basis and can vary substantially, rough guidelines are provided for the purchase and installation cost of a medium-sized (between 100 kVA and 500 kVA) device if available. Three price categories are defined: - : > 250 euro per kVA = : 150-250 euro per kVA + : < 150 euro per kVA Maintenance Depending on the type of system, the maintenance costs may be substantial. This section only distinguishes whether annual maintenance is required (-) or not (+).

13

Efficiency Many systems require continuous electricity demand due to the use of power electronics, the use of moving parts (flywheel) or cooling (SMES), resulting in a reduction of the overall efficiency. Three categories are distinguished: + : losses <0.5% of rated power = : losses 0.5-2% of rated power - : losses >2% of rated power Reaction time Some of the protection devices need to detect the voltage sag before they can react. This may result in transient process behaviour. The reaction (activation) time of the protective device is divided into three categories: + : reaction or activation transient < 1 ms = : transient 1-5 ms - : transient > 5 ms Voltage harmonics Some of the mitigation systems are also able to continuously compensate for voltage harmonics originating from the supplying network (+) while others do not influence voltage harmonics (=). Current harmonics If the downstream load contains many power electronic applications, such as variable speed drives, the current will be highly non-linear. Some voltage sag mitigation systems have the ability to draw a linear current from the network despite the non-linear loads (+), while others do not influence current harmonics (=).

14

Reactive power Some applications have the ability to supply or draw reactive power continuously (+) while others cannot (=). Summary Table 1.4 summarises the performance of the described systems with regard to these parameters.

Table 1.4 Technical and economic aspects of different mitigation methods

If we consider the characteristics of the new flywheel system designed by Temporal Power, then the negative point for efficiency of the flywheel could be overcome and thus change to positive as well, which makes it a superior option.

1.5 Voltage Sags Voltage sag as defined by IEEE Standard 1159-1995, IEEE Recommended Practice for Monitoring Electric Power Quality, is a decrease in RMS voltage at the power frequency for durations from 0.5 cycles to 1 minute, reported as the remaining voltage.

15

Voltage sags can occur on utility systems both at distribution voltages and transmission voltages. Voltage sags that occur at higher voltages will normally spread through a utility system and will be transmitted to lower voltage systems via transformers. One of the most worrying trends is the integration of wind energy in distribution and transmission networks which are exposed to voltage sags. The behaviour of the wind turbine is important not only under normal working conditions but also when voltage sags do occur. In some countries, especially those where there are large wind energy installations, Transmission System Operators (TSO) and Distribution System Operators (DSO) are particularly concerned about this problem, consequently their Grid Codes are continuously being revised. Voltage sags are becoming an increasing concern due to the sensitivity shown by the wind generation, caused by the adjustment of protective devices, especially in wind turbines that use power electronics to support a Double-Fed Induction Generator (DFIG). As a result, many grid codes establish immunity levels against voltage sag. In Ontario under pre-contingency conditions with all facilities in service, or with a critical element(s) out of service after permissible control actions and with loads modeled as constant MVA, the IESO controlled grid is to be capable of achieving acceptable system voltages. The table below indicates the maximum and minimum voltages generally applicable. These values are obtained from Chapter 4 of the "Market Rules", and CSA standards for distribution voltages below 50 kV [4].

16

Transformer Stations, Nominal Bus Voltage (KV) 500 230 115 e.g. 44, 27.6, 13.8 kV Maximum Continuous (KV) Minimum Continuous (KV) 550 490 250 220 127* 113 106% 98%

Table 01.5: Pre-Contingency Voltage Limits

* However certain buses can be assigned specific maximum and minimum voltages as required for operations. In case of Wind Turbine generators these limitations are stiffer and voltage is bounded within 1% of its nominal value. 1.6 Objective of this Thesis This thesis aims to develop an optimal control strategy for flywheel systems to regulate feeder voltages. The control model considers both the flywheel system and the connected distribution system feeder characteristics to determine the optimal settings for the flywheel such that feeder voltages are held nearly constant. For simulation, an induction machine is used for bi-directional transfer of energy to the flywheel. Two voltage sourced converters share a common DC link constitute the power electronic interface between the electricity grid and the induction machine. This power electronic interface is used for the bi-directional flow of energy for charging and discharging the flywheel ­ a mechanical battery ­ through the induction machine with DC link as medium. An inner control system is used to generate gate pulses for each converter. Using an optimization algorithm, an outer control system detects voltage sag and regulates the voltage at the point of common coupling with the electricity grid.

17

This thesis presents the modeling, simulation and analysis of a flywheel energy storage system (FESS) for voltage regulation.

1.7 The

Chapter-wise Outline system configuration and control system modeling was done using

MATLAB/Simulink and is explained in Chapter 2. The proposed voltage regulation is presented in Chapter 3. The simulated performance of the flywheel energy storage system in mitigating voltage sag is analyzed in Chapter 4.

18

Chapter 2 System Configuration and Control System
2.1 System Configuration The basic circuit consists of an energy storage system, power electronic interface LCL filter and a three phase source that represents electric grid system as shown in Fig. 2.1. The energy storage system in this case is a flywheel coupled to an induction machine. The induction machine is used for energy conversion. The power electronic interface consists of two voltage sourced converters connected through a common DC link [18]. One voltage source converter interfaces with the energy conversion and storage system and the other with the electric grid system.

The flywheel energy storage system has three modes of operation: Charge mode Stand-by mode Discharge mode

During charge mode, the VSC interfacing the electric grid system runs as a rectifier and the other as an inverter, with the transferred energy accelerating the flywheel to its rated speed. In this mode, energy is stored in the flywheel in the form of kinetic energy. The energy flow is from grid system to flywheel with induction machine as energy converter. Once the flywheel reaches its charge speed, the storage system is in standby mode and is ready to discharge when the PCC bus sees a voltage sag. 19

During discharge mode, the VSC interfacing the grid system runs as an inverter injecting the required voltage in series with the line to correct the voltage sag. The flywheel VSC runs as a rectifier. The flywheel slows as it discharges. In this mode, the stored energy is used for sag correction and energy flow is from the flywheel to hydro grid system [15].

Inverter Rectifier

Rectifier Inverter

Hydro grid

LCL Filter

I-M

PCC FLYWHEEL

Figure 2.1 Basic circuit of flywheel energy storage system

2.2

Controlling Strategy

A Flywheel energy storage system consisting of the following components that were modeled in MATLAB/Simulink: · Two voltage sourced converters · Induction machine · Flywheel · Control system

20

Fig. 2.2 shows a single line diagram of a flywheel energy storage system. To simplify modeling and testing, it is broken into two sub models. Each sub model is separately modeled, tested and integrated to make it a complete model. The sub models are: · Field oriented control model · Voltage oriented control model

Hydro grid

LCL Filter

I-M

Figure 2.2 Single Line Diagram of a flywheel energy storage system

2.2.1 Field Oriented Control Fig. 2.3 shows the outline of the field oriented control drive that was modeled in SIMULINK. It has the following sub models [16]:

· · · ·

Induction machine model Field oriented controller model DC link capacitor for DC voltage regulation Voltage sourced converter

21

Hydro grid

LCL Filter

I-M

Figure 2.3 Field Oriented Control Model Breakup

The performance of this model was found adequate for the purposes of controlling voltage at the point of interconnection. The control meets and exceeds requirements as set by Canadian Standard Association guidelines.

2.2.2 Voltage Oriented Control Fig. 2.4 shows the outline of a voltage oriented control as it was modeled in Simulink. It has the following sub models [17]:

· · ·

3-phase AC power supply Series transformer and filters Voltage sourced converter

22

Hydro grid

LCL Filter

I-M

Figure 2.4 Voltage Oriented Control Model Breakup

This model was modeled on Matlab/Simulink environment. Simulation tests show that the system adequate and meets requirements when the system parameters are appropriately designed. Tests were conducted on site to verify if the response times and control is adequate. The lab tests also confirm this aspect.

2.3

Summary

In this chapter available control strategies are modeled and tested. The voltage oriented control is chosen for further work as a physical model is readily available.

23

Chapter 3 PROPOSED VOLTAGE REGULATION
3.1 Introduction This chapter focuses on the design of an algorithm to regulate the voltage at PCC using Temporal Power flywheel. The optimization algorithm reveals the

necessary amount of `P' and `Q' that the flywheel has to generate in order to keep the PCC voltage within the limit (1% Error). To optimize the `P' and `Q' generated by the flywheel, the minimum value of Apparent Power `S' has to be found using MATLAB. case of injecting only Reactive Power (~ Also to see the effect of having Active power involved in voltage regulating, the 0) from the flywheel has been 0. Finally, the

considered and its result has been compared to the case that ~ be generated to regulate the voltage at PCC.

size of the flywheel is obtained, considering the maximum amount of P and Q needs to

3.2

Tasks to Solve the Problem 1- Use a sample distribution system with a wind generator akin to Hydro One's system. 2- Transform the 96 bus system to the 2 bus system, considering the system is unbalanced. a) Perform a power flow analysis on Hydro-One data (96 bus System) in order to find bus voltages (using PSS®E 32). b) Change the loads from constant-power-loads to constant-admittanceloads. 24

c) Determine the Thevenin voltage of the 96 bus system (using PSS®E 32). d) Write a program that creates the Y bus matrix of the 96 bus system. (Considering Constant-Admittance-Loads, Shunts, Charging and Tap Ratios in Y bus matrix using MATLAB) e) Determine the Thevenin impedance of the 96 bus system using theories related to the Y bus matrix. f) Test the 2 bus Thevenin system characteristics and see if it matches the 96 bus system using PSS®E 32. 3- Based on the 2 bus system, design an optimization algorithm which calculates the necessary amount of ~ limit.(Using MATLAB) and  in order to keep  within the

4- Program the control drives so it recognizes the optimized ~ values as its reference, (using SYPY Pro): a) Create Look-Up tables according to the algorithm result.

and 

b) Write a program that uses the Look-Up table and linear interpolation technique. 5- Perform a test at Temporal Power location.

3.3

Thevenin Theorem

Thevenin's theorem states that it is possible to reduce any linear circuit to an equivalent circuit with just a single voltage source and series impedance. It is especially useful in analyzing power systems and other circuits where one particular resistor in the circuit (called the "load" resistor) is subject to change, and re-calculation of the circuit is

25

necessary with each trial value of load resistance, to determine voltage across it and current through it. Steps to follow for Thevenin's Theorem: 1) Find the Thevenin source voltage by removing the load resistor from the original circuit and calculating voltage across the open connection points where the load resistor used to be. 2) Find the Thevenin resistance by removing all power sources in the original circuit (voltage sources shorted and current sources open) and calculating total resistance between the open connection points. 3) Draw the Thevenin equivalent circuit, with the Thevenin voltage source in series with the Thevenin resistance. The load resistor re-attaches between the two open points of the equivalent circuit. 4) Analyze voltage and current for the load resistor following the rules for series circuits.

3.4

Thevenin Voltage Of The 96-Bus System

In this case, positive sequence is being tested, considering the system is unbalanced. According to the theory the wind-turbine generator has been disconnected in order to find the open circuit voltage at Bus-7081(Wind-turbine bus).

26

Figure 3.1: wind-turbine turbine generator bus is open in H.O.N.I. 96 bus system

By doing load flow analysis using PSSE, it can be seen from Figure 3.1 1 that: per-unit

3.5

Thevenin Impedance Of The 96 96-Bus System

For this experiment 100% load capacity and positive sequence voltages are being used. In order to find the Thevenin impedance, the first step is to change the loads to constant-admittance admittance loads and then the Y Y-Bus Bus matrix has to be created and the last step is to use the relationship between thevenin's theorem and bus impedance matrix.

Steps to calculate the Constant Constant-Admittance-Loads:
1) and of the loads are known, therefore we perform a power flow analysis on

Hydro-One One data (96 bus System) in order to find bus voltages V (using PSSE). 2) The following formula is known

27

 3) We also know that:  4) From (3.1) and (3.2) => $ 0 I

~

-  $ 0 I ~ - 

(3.1)

(3.2)

(3.3)

I and I Therefore:   - 

(3.4)

(3.5)

(3.6) (3.7)

 Y-Bus Matrix:

The second step to find the Thevenin impedance is to create the Y-bus matrix. It had to be created in a way that includes all the elements of the 96 bus system (using MATLAB). In power engineering, Y-bus is an n x n symmetric matrix describing a power system with n buses. It represents the nodal admittance of the buses in a power system. I I## | I$# I# I#$ I$$ I# I$ | I

I$

(3.8)

28

The admittances Y11, Y22 , ... Ynn are called the self-admittances at the nodes, and each equals to the sum of all the admittances terminating on the node which includes: Tap ratios, Line Charging, Constant-Admittance-Loads and Shunt Capacitors I - -I - J (3.9)

The other admittances are the mutual admittances of the nodes, and each equals the negative of the sum of all admittances connected directly between the nodes identified by the double subscripts.

Relationship between Thevenin's Theorem And Y-Bus Matrix: According to the theory, in the relation V = Zbus*I (3.10)

the node or bus voltages (Vi , i = 1, ... , n) are the open circuit voltages. Let us assume that the currents injected in buses 1, ... , k - 1 and k + 1, ... , n are zero when a short circuit occurs at bus k . Then Thevenin impedance at bus k is: HB E
= =

EE

(3.11)

So to follow the theory, the Z matrix was obtained by inverting the Y matrix and then the diagonal element of the desired bus is our Thevenin impedance(using MATLAB): I I{ I  % -  %% I
#

(3.12) (3.13)

" #

" # " #{

29

3.6

Verifying The Thevenin System

In order to test the Thevenin system, the following tasks were done (using PSSE): First the 96 bus system was tested by making the Wind Wind-turbine turbine generator produce 9MW of power. Then by Power Flow analysis, the voltage at bus 7081 was recorded.

Figure 3.2: : Finding the voltage at bus 7081 when Wind Wind-turbine is generating 9MW in 96-bus 96 system

In the next step, the same procedure is performed on the Thevenin system and the same value for is expected.

Figure 3.3: : finding the voltage at bus 7081 when wind wind-Turbine is generating 9MW in Thevenin system

The result of the above test verified that the Thevenin system is accurate and has the same characteristics of the 96 96-bus system.

30

"

##

"

#

  ~JJ

(3.14)

3.7

Optimization Algorithm

After creating the two bus system, some boundaries and assumptions had to be considered in order to optimize the result: Boundaries: ~ 3 WXX 3 ~ WXX

(3.15) (3.16)

 {J JJJ IIJJ{



~

3 WXYYXXX 3 

(3.17) (3.18) (3.19)

 

3 WXYYXXX 3 ~

3 WXYYXXX 3  3 WVV 3  3

(3.20) 3 (3.21)

WVV

Assumptions: 1. KC
>

changes from 0 to 0.09 Per-unit with 0.01 steps => KC 
>

MKB??

        3  . 3 
MKB??

 %  % 3  3 

(3.22)

is limited between 0 and 1 (Per-unit) (3.23)

2. 

MKB??

is limited between -1 and 1 (Per-unit)
MKB??

(3.24)

31

3. 

MKB??

is limited between -2 and 2 (Per-unit) . 3 
MKB??

3  .01

(3.25)

4. Voltage at PCC is limited between 0.99 and 1.01 (Per-unit)  %%  3 6// 3  5. Angle at PCC is limited between ­Pi and Pi => . 3 3 (3.27) (3.26)

Other necessary steps in doing optimization are: - Setting of the constraints - Setting of the objective function of the system. Considering the 2 bus model, equations were derived that relate the following elements of the system together (Fig. 3.4): KC
>

,

MKB??

,

MKB??

, 6// , 

6//

, HB?J and HB?J  MKB?? =?  MKB?? =? Flywheel

HB

  HB?J ~  %

-  %%

   Fig. 3.4 Representation of the Equivalent System

    

Wind Generator  %

32

Then the objective function has to be assigned, which in this case is finding the minimum value of the Apparent Power S of the Flywheel in order to keep the 6// Consider the base MVA values of:  I ~
MKB??





  {H{   {{
%

(3.28) (3.29) (3.30)

I I

#

I

0I

(3.31) (3.32)

{        Y        %  %{ (Per-unit) 
MKB??

(3.33)

The challenge is to determine optimal values for:  

Consider the power flowing into the PCC bus from the thevenin's equivalent as below: 
%

 
%

.~ {.~

-~ -~

-  { - 

(3.34)

(3.35)

This equation (3.35) is rearranged as below:
$ {JJ - J { . $

~

- 

{

. I

{

(3.36)

33

The above equation is divided into 2 separate equations for real and reactive powers and forms the constraints: Real Elements: JJ .  $ J   ~ ~   - .~
$

I I
$

(3.37)

Imaginary Elements:

(3.38)

Third equation is:

-

(3.39)

Objective Function: The objective function is chosen to minimize the inverter size. The best way is minimizing the apparent power of the flywheel which will reduce the current through the inverters and consequently reducing the size of the inverter. Minimizing the apparent power is also a cheaper solution. Thus the objective is: Minimum  ~
$

-

$

(3.40)

3.8 Complete Formulation In conclusion, the objective of the problem is defined by (3.40) and it is subject to equality constraints (3.37) ­ (3.39) and inequality constraints (3.15) to (3.21). This is solved using `fmincon' function in Matlab.

34

Chapter 4 TESTS and RESULTS
4.1 Outcome from the Algorithm The complete formulation was solved for the formulation with objective (3.40) and constraints (3.37) ­ (3.39) and (3.15) to (3.21). The following results (Table 4.1) were achieved after running the optimization algorithm for positive sequence (Using MATLAB): Pw Pflywheel+ Qflywheel+

0 0.01 0.02 0.03 0.04 0.05 0.06 0.07 0.08 0.09

-3.15E-08 -1.69E-09 2.64E-08 0.000576 0.001045 0.001397 0.00164 0.001782 0.001832 0.001798

-3.43E-07 -9.61E-09 -1.26E-07 -0.002342921 -0.00459828 -0.006700473 -0.008643174 -0.010421475 -0.012029588 -0.013463244

Table 4.1: Results of P and Q of the flywheel in order to keep Vpcc within the limit

35

4.00E-03 2.00E-03 0.00E+00 0 -2.00E-03 -4.00E-03 P -6.00E-03 Q -8.00E-03 -1.00E-02 -1.20E-02 -1.40E-02 -1.60E-02
Figure 4.1: Ratios of P and Q of the flywheel with respect to Pwind

0.01

0.02

0.03

0.04

0.05

0.06

0.07

0.08

0.09

Due to the fact that the system is unbalanced, all the steps above have to be repeated for zero sequence as well. The final results are in Table 4.2.

The data in Figure 4.2 demonstrates the values of P and Q that have to be used as a reference in order to keep the Voltage at PCC within the 1% limit.

36

(V+=1.0307)
Pw 0 0.01 0.02 0.03 0.04 0.05 0.06 0.07 0.08 P+ -3.15E-08 -1.69E-09 2.64E-08 0.000576 0.001045 0.001397 0.00164 0.001782 0.001832 Q+ -3.43E-07 -9.61E-09 -1.26E-07 -0.002342921 -0.00459828 -0.006700473 -0.008643174 -0.010421475 -0.012029588

(V0=1.1199) (LOAD AT 100%)
P0 3.95E-07 0.000757352 0.002107598 0.003031538 0.003550202 0.003693278 0.003499366 0.003016445 0.002300295 Q0 4.86E-07 -0.001712873 -0.005332927 -0.008704941 -0.011782775 -0.014520254 -0.016872259 -0.018799668 -0.020266432 ST 1.20E-06 0.001872853 0.005734546 0.014043273 0.021737075 0.028671771 0.034826174 0.04018567 0.044733039

0.09

0.001798

-0.013463244

0.00141396

-0.02124597

0.048458392

Table 4.2: Power sequences of the flywheel in order to keep Vpcc within the limit

4.2 Test Results After the algorithm was simulated successfully, next step was the actual implementation of it into the controller drives. The goal was achieved by using SYPT Pro software and the concept of look-up tables. Test result was successful, because according to look-up tables the drives were choosing the right amount of active and reactive power as a reference point to deliver.

37

4.3 Implementation of the Algorithm In The Control Drive As Look-Up Tables

In order to upload the optimization algorithm into the flywheel system, it was necessary to communicate with controller Drives. The best possible way to communicate to control system was to use look-up tables. Therefore 20 tables got implemented and each table had all the data from figure 6 for cases of different Load percentage and shunt capacitors situation (ON/OFF) [19]. Also inside the program a function was implemented that uses linear interpolation for special cases. For example if:   ~     and  (4.1)

Then the program calculates the appropriate values of ~ interpolation:

using

If the two known points are given by the coordinates (x0,y0) and (x1,y1), the linear interpolant is the straight line between these points. For a value x in the interval (x0,x1), the value y along the straight line is given from the equation:

(4.2)

The final result will be sent into the control system to be used as a reference P and Q.

38

4.4

Comparison between Different Scenarios  and ~  . Result

With the intention of understanding the effect of Active Power in voltage regulation, a comparison has been done between the case of ~ voltage, the value of 

shows that when the flywheel injects only reactive Power into the system to regulate the will be slightly higher compare to the time that it injects the

combination of P and Q. The following figure shows the difference:
4.00E-02

3.50E-02 P=0 3.00E-02 Both P and Q

2.50E-02

2.00E-02

1.50E-02

1.00E-02

5.00E-03

0.00E+00 0 0.01 0.02 0.03 0.04 0.05 0.06 0.07 0.08 0.09

Figure 4.2: comparing the value of Apparent Power when P=0 and P 0

4.5 Summary According to this chapter, flywheel is fully capable of voltage regulation and keeping it within the limits. However, the result shows only a small amount of difference between flywheel's performance and the technology that already exists.

39

Chapter 5 CONCLUSION AND FUTURE WORK
5.1 Conclusion

The thesis proposes a new control scheme for flywheel in conjunction with feeder models to optimally control voltage at point of common coupling. The modeling and analysis of a flywheel energy storage system for voltage regulation has been presented. A control system has been proposed for voltage regulation and energy control. In conclusion, proprietary control techniques built on customer specifications that give Temporal Power a superior product that has been validated. The outcomes of this project's development work are: a) A PC based control system for Temporal Power's flywheel system. This control system with the flywheel is readily deployable for a demo. The control system would have hardware and software components. b) A theoretical model of the flywheel, drive system and control system that would enable potential customers of this flywheel to simulate the flywheel. Through simulation, potential customers would be enabled to ascertain benefits of the flywheel for their system. c) A tuning method for the control system so that it fits potential customer requirements.

40

REFERENCES
[1] [2] G. Genta, Kinetic Energy Storage, University Press, Cambridge, 1985. A. Ter-Gazarian, Energy Storage Systems For Power Systems, IEE Power and Energy Series, 1994. [3] J. G. Ciezki, R. W. Ashton, "Selection and stability issues associated with a Navy shipboard DC Zonal electric distribution system," IEEE Transactions on Power Delivery, Vol. 15, No. 2, pp. 665-669, April 2000. [4] [5] Math. H. J. Bollen, Understanding Power Quality Problems, IEEE Press, 2000. A. T. Adediran, H. Xiao and K.L. Butler, "Fault Studies of an U.S. Naval Shipboard Power System," NAPS, Univerity of Waterloo, Canada, pp 1-18 to 1-25, October 2000. [6] R. S. Weissbach, G. G. Karady and R. G. Farmer, "Dynamic Voltage Compensation on Distribution Feeders using Flywheel Energy Storage," IEEE Transactions on Power Delivery, Vol.14, No.2, pp. 465-471, April 1999. [7] PSCAD/EMTDC User's Manual, Manitoba HVDC Research Center, Manitoba, Canada. [8] [9] B. K. Bose, Modern Power Electronics and AC Drives, Prentice Hall PTR, 2002. Field Oriented Control of 3 phase AC Motors, BPRA073, Texas Instruments Europe, 1998. [10] D. W. Novotny and T. A. Lipo, Vector Control and Dynamics of AC Drives, Oxford Science Publications, 1997. [11] P. L. Jansen and R. D. Lorenz, "A Physically Insightful Approach to the Design and Accuracy Assessment of Flux Observers for Field Oriented Induction Machine

41

Drives," IEEE Transactions on Industry Applications, Vol 30, No. 1, pp. 101-110, Jan/ Feb., 1994. [12] W. Dib, A. Barabanov, R. Ortega, and F. Lamnabhi-Lagarrigue, "An explicit solution of the power balance equations of structure preserving power system models," IEEE Trans. Power Syst., vol. 24, no. 2, pp. 759­765, May 2009. [13] Keyou Wang, Mariesa L. Crow, "Power System Voltage Regulation via STATCOM Internal Nonlinear Control," IEEE TRANSACTIONS ON POWER SYSTEMS, VOL. 26, NO. 3, pp.1252-1262, August 2011. [14] M. Subkhan, M. Komori, "New Concept for Flywheel Energy Storage System

Using SMB and PMB," IEEE Transactions On Applied Superconductivity, Vol. 21, No. 3, June 2011 [15] Trong Duy Nguyen, King Jet Tseng, Shao Zhang, Hoan Thong Nguyen, "On The Modeling and Control of a Novel Flywheel Energy Storage System," IEEE Conference on Industrial Electronics (ISIE), pp. 1395 ­ 1401, 2010 [16] Zhang Yaou, Zhao Wansheng, and Kang Xiaoming, "Control of the Permanent Magnet Synchronous Motor Using Model Reference Dynamic Inversion," Wseas Trans. On Systems and Control, Issue 5, Vol. 5, pp. 301 ­ 311, May 2010. [17] Oliveira, J.G. "Power electronics and control of two-voltage-level flywheel based all-electric driveline," IEEE Conference pp. 1659 ­ 1665, June 2011 [18] P.H. Mellor, N. Schofield, D. Howe, "Flywheel and Supercapacitor Peak Power Buffer Technologies", IEEE Colloquium, Vol 50, pp. 47-52. 2009 [19] Zhihui Guo, Wenyuan Li, Adriel Lau, Tito Inga-Rojas, and Ke Wang, "Detecting XOutliers in Load Curve Data in Power Systems", IEEE Transactions On Power Systems, Vol. 27, No. 2, 2012 42

[20] S.M. Drouilhet, "Power Flow Management in a High Penetration Wind-Diesel Hybrid Power System withShort-Term Energy Storage," presented at Burlington, Vermont, Windpower '99, June 20­23, 1999

43

APPENDIX

Creating Y-bus Matrix and calculating Zthevenin in MATLAB The purpose of this program is to create Y-bus matrix and Calculate Thevenin impedance using Hydro One data. Load data of Hydro One system 100% Load Bus Number 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 Load in Per-Unit 0 0 0 0 0 0 0 0 0.003448+0.001435i 0.003448+0.001435i 0 0 0 0 0 0 0 0 0 0 0.006003+0.019088i 0 0 0 0 0 0 0.000236+0.000087i 0.000095+0.000033i 0 0 Shunt Caps in Per unit 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.003i 0 0.003i 44

32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78

0 0.000095+0.000033i 0.000095+0.000033i 0 0.000667+0.000278i 0.000667+0.000278i 0 0 0 0 0 0 0 0 0 0 0 0.001014+0.000444i 0.00109+0.000454i 0 0 0 0 0 0 0 0 0 0 0 0.000318+0.000164i 0.004368+0.002126i 0 0 0 0.000236+0.000087i 0.000212+0.000079i 0.001886+0.000699i 0.001886+0.000699i 0 0 0 0 0 0 0 0 45

0 0 0 0 0 0 0 0 0.003i 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0

79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96

0 0 0 0 0 0 0 0.0126+0.006102i 0 0.001014+0.000444i 0 0.0134+0.00649i 0 0 0.002428+0.0009i 0.002216+0.000821i 0.000095+0.000033i 0

0.0192i 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0

Branch data of Hydro One system The following table shows the branch data of Hydro One system used to create Y-bus Matrix and to calculate Thevenin Impedance.

From Bus
1 2 3 4 5 6 7 8 9 10 11 12 13 14

To Bus
2 3 4 5 6 7 8 9 10 11 12 13 14 15

R R0 X X0 (Perunit) (Perunit) (Perunit) (Perunit)
0.001499 0.000804 0.000402 0.00067 0.000268 0.036859 0.004289 0.030693 0.053211 0.002547 0.001206 0.00134 0.000536 0.00067 0.001499 0.0022 0.0011 0.0018 0.0007 0.0998 0.0116 0.0831 0.1441 0.0069 0.0033 0.0036 0.0015 0.0018 0.044975 0.00318 0.00159 0.00265 0.00106 0.145738 0.016959 0.12136 0.210393 0.010069 0.00477 0.0053 0.00212 0.00265 0.044975 0.0086 0.0043 0.0072 0.0029 0.3952 0.046 0.3291 0.5705 0.0273 0.0129 0.0144 0.0057 0.0072

b/2 (Perunit)
0 1.64E-08 8.19E-09 1.36E-08 5.46E-09 7.51E-07 8.74E-08 6.25E-07 1.08E-06 5.19E-08 2.46E-08 2.73E-08 1.09E-08 1.36E-08

a
1 1 1 1 1 1 1 1 1 1 1 1 1 1

46

15 16 17 18 19 20 21 22 23 23 24 25 26 27 28 28 29 29 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 43 44 45 46 46 47 48 49 49 50 51 51 52 53 54 55 56 57

16 17 18 19 20 21 22 23 24 65 25 26 27 28 29 67 30 71 95 31 32 33 34 35 36 37 38 39 40 41 42 43 44 86 45 46 47 87 48 49 50 88 51 52 89 53 54 55 56 57 58

0.000804 0.000536 0.005093 0.01863 0.008846 0.000804 0.000938 0.003217 0.005897 0.001206 0.000804 0.001206 0.005629 0.004557 0.032972 0.002547 0.03019 0.002547 0.003619 0.024196 0.059165 0.011615 0.023956 0.001452 0.024682 0.031216 0.043194 0.030853 0.0098 0.013067 0.012341 0.007985 0.044646 0.026134 0.003267 0.034483 0.009074 0.005808 0.002178 0.001815 0.014882 0.014882 0.010163 0.003267 0.00363 0.057776 0.01108 0.01108 0.03799 0.011872 0.007123

0.0022 0.0015 0.0138 0.0505 0.024 0.0022 0.0025 0.0087 0.016 0.0033 0.0022 0.0033 0.0152 0.0123 0.0893 0.0069 0.0793 0.0069 0.0098 0.0635 0.135 0.0265 0.0546 0.0033 0.0563 0.0712 0.0985 0.0704 0.0224 0.0298 0.0282 0.0182 0.1018 0.0596 0.0075 0.0787 0.0207 0.0132 0.005 0.0041 0.0339 0.0339 0.0232 0.0075 0.0083 0.1292 0.0248 0.0248 0.085 0.0266 0.0159

0.00318 0.00212 0.020138 0.073664 0.034977 0.00318 0.00371 0.012719 0.023318 0.00477 0.00318 0.00477 0.022258 0.018019 0.130369 0.010069 0.074663 0.010069 0.014309 0.05984 0.09813 0.019265 0.039734 0.002408 0.040938 0.051774 0.071641 0.051172 0.016255 0.021673 0.020469 0.013245 0.074049 0.043346 0.005418 0.057193 0.015051 0.009632 0.003612 0.00301 0.024683 0.024683 0.016857 0.005418 0.00602 0.027111 0.005199 0.005199 0.017826 0.005571 0.003342

0.0086 0.0057 0.0546 0.1997 0.0948 0.0086 0.0101 0.0345 0.0632 0.0129 0.0086 0.0129 0.0604 0.0489 0.3535 0.0273 0.2124 0.0273 0.0388 0.1703 0.2808 0.0551 0.1137 0.0069 0.1172 0.1482 0.205 0.1465 0.0465 0.062 0.0586 0.0379 0.2119 0.1241 0.0155 0.1637 0.0431 0.0276 0.0103 0.0086 0.0706 0.0706 0.0482 0.0155 0.0172 0.0626 0.012 0.012 0.0412 0.0129 0.0077

1.64E-08 1.09E-08 1.04E-07 3.79E-07 1.8E-07 1.64E-08 1.91E-08 6.55E-08 1.2E-07 2.46E-08 1.64E-08 2.46E-08 1.15E-07 9.28E-08 6.72E-07 5.19E-08 3.53E-07 5.19E-08 7.37E-08 2.83E-07 4.1E-07 8.04E-08 1.66E-07 1.01E-08 1.71E-07 2.16E-07 2.99E-07 2.14E-07 6.78E-08 9.05E-08 8.54E-08 5.53E-08 3.09E-07 1.81E-07 2.26E-08 2.39E-07 6.28E-08 4.02E-08 1.51E-08 1.26E-08 1.03E-07 1.03E-07 7.04E-08 2.26E-08 2.51E-08 2.45E-06 4.7E-07 4.7E-07 1.61E-06 5.03E-07 3.02E-07

1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1

47

58 59 60 61 62 63 65 67 68 68 69 71 72 73 74 75 76 77 78 79 80 81 82 83 84 87 89 90 91 93

59 60 61 62 63 64 66 68 69 93 70 72 73 74 75 76 77 78 79 80 81 82 83 84 85 96 90 91 92 94

0.004749 0.004749 0.028492 0.022161 0.078354 0.022952 0.002815 0.015816 0.004113 0.017822 0.074029 0.007372 0.001072 0.001742 0.006031 0.125186 0.051602 0.016352 0.007238 0.011393 0 0 0 0 0 0.000233 0.005808 0.011978 0.014882 0.094135

0.0106 0.0106 0.0637 0.0496 0.1753 0.0513 0.0076 0.0428 0.0083 0.036 0.1494 0.02 0.0029 0.0047 0.0163 0.339 0.1397 0.0443 0.0196 0.0309 0 0 0 0 0 0.000233 0.0132 0.0273 0.0339 0.1899

0.002228 0.002228 0.01337 0.010399 0.036766 0.01077 0.011129 0.062535 0.005535 0.023986 0.099634 0.029148 0.00424 0.006889 0.023848 0.49498 0.204033 0.064655 0.028618 0.045046 0.0001 0.0001 0.0001 0.0001 0.0001 0.0028 0.009632 0.019867 0.024683 0.126695

0.0051 0.0051 0.0309 0.024 0.0849 0.0249 0.0302 0.1696 0.0156 0.0677 0.2812 0.079 0.0115 0.0187 0.0647 1.3421 0.5532 0.1753 0.0776 0.1221 0.0001 0.0001 0.0001 0.0001 0.0001 0.0028 0.0276 0.0569 0.0706 0.3576

2.01E-07 2.01E-07 1.21E-06 9.39E-07 3.32E-06 9.73E-07 5.73E-08 3.22E-07 2.22E-08 9.62E-08 4E-07 1.5E-07 2.18E-08 3.55E-08 1.23E-07 2.55E-06 1.05E-06 3.33E-07 1.47E-07 2.32E-07 0 0 0 0 0 0 4.02E-08 8.29E-08 1.03E-07 5.08E-07

1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1

48

Creating Y-bus Matrix and calculating the Thevenin impedance The following program is written in MATLAB:

clear all clc; num = 0; percent=100; Branchdata = Branchdatas(num); % Calling "Branchdatas.m" for Branch Data Loaddata = Loaddatas(percent); FromBus = Branchdata(:,1); ToBus = Branchdata(:,2); r = Branchdata(:,3); x = Branchdata(:,4); b = Branchdata(:,5); a = Branchdata(:,6); % From bus number % To bus number % HONI 96 bus system

% Resistance, R % Reactance, X % Ground Admittance, B/2 % Tap setting value

BusNum = Loaddata(:,1); % Bus numbers with loads yload = Loaddata(:,2); % Load values in terms of G+jB in P.U. Shunt = Loaddata(:,3); z = r + 1i*x; y = 1./z; b = 1i*b; % Z matrix % To get inverse of each element % Make B imaginary

nbus = max(max(FromBus),max(ToBus));

% no. of buses 49

nbranch = length(FromBus); Y = zeros(nbus,nbus);

% no. of branches

% Initialise YBus

Zmatrix = zeros(nbus,nbus);

% Formation of the Off Diagonal Elements for k=1:nbranch Y(FromBus(k),ToBus(k)) = Y(FromBus(k),ToBus(k))-y(k)/a(k); Y(ToBus(k),FromBus(k)) = Y(FromBus(k),ToBus(k)); end

% Formation of Diagonal Elements for m =1:nbus for n =1:nbranch if FromBus(n) == m Y(m,m) = Y(m,m) + y(n)/(a(n)^2) + b(n)+ (1*yload(n)) + (Shunt(n)); elseif ToBus(n) == m && ToBus(n) == nbus Y(m,m) = Y(m,m) + y(n) + b(n)+ (1*yload(m)) + (Shunt(m)); elseif ToBus(n) == m Y(m,m) = Y(m,m) + y(n) + b(n); end end end

Y

% Bus Admittance Matrix 50

X=Y; X(:,1)=[]; X(1,:)=[]; %Zbus= Y\eye(nbus) Zbus=inv(X); %Zbus=inv(Y) %H=Zbus*Y; %Zth80_80=Zbus(80,80) %Zth3_3=Zbus(3,3) %Rth=real(Zth); %Lth=imag(Zth); Zbus(81,81) % Bus Impedance Matrix

51

Optimization Algorithm MATLAB was used for optimization. The optimization program includes three parts: Objective function, Constraints and Fmincon function

Fmincon function clear all clc; global Rpu Lpu a Rpu0 Lpu0 a0 Pw Smax Smin Qmax Qmin Deltamax Deltamin Pmax Pmin Vmax Vmin Vmax0 Vmin0

%Positive Seq % Vth = 1.0307; %100

% Zth = 0.5628 + 1.8619i; %100 % Vth = 1.0263; %75

% Zth = 0.539 + 1.8637i; %75 % Vth = 1.0215; %50

% Zth = 0.5152 + 1.8647i;%50 % Vth = 1.0165; %25

% Zth = 0.4916 + 1.8650i;%25 Vth = 1.0133; %10

Zth = 0.4775 + 1.8648i;%10

Rpu=real(Zth); Lpu=imag(Zth);

%Line Resistance %Line Inductance 52

a=1/Vth;

% Vth0 = 1.1199;

%100

% Zth0 = 2.3708 + 4.8472i; %100 % Vth0 = 1.1148; %75

% Zth0 = 2.1159 + 4.9498i; %75 % Vth0 = 1.106; %50

% Zth0 = 1.8539 + 5.0238i; %50 % Vth0 = 1.0946; %25

% Zth0 = 1.5895 + 5.0690i; %25 Vth0 Zth0 = 1.0866; %10

= 1.4317 + 5.0825i; %10

Rpu0=real(Zth0); Lpu0=imag(Zth0); a0=1/Vth0;

%Line Resistance %Line Inductance

for Pw=0:1:9

Qmin=-3; Smin=0; Pmin=-1;

Qmax=3; Smax=1; Pmax=1; 53

Vmin=Vth-(Vth*0.01); Vmin0=Vth0-(Vth0*0.01);

Vmax=Vth+(Vth*0.01); Vmax0=Vth0+(Vth0*0.01);

Deltamin=-2*pi; Deltamax=2*pi; Stmin=0; Stmax=1;

options=optimset('algorithm','interior-point','MaxFunEvals',5000,'MaxIter',5000);

lb = [Qmin Pmin Vmin Deltamin Smin Qmin Pmin Vmin0 Deltamin Smin Stmin]; %Defining Lower Boundaries ub = [Qmax Pmax Vmax Deltamax Smax Qmax Pmax Vmax0 Deltamax Smax Stmax]; %Defining Upper Boundaries

x0 = [0, 0 , 0 , 0 , 0 , 0, 0 , 0 , 0 , 0, 0]; %using initial guesses

[x,fval]=fmincon(@Fun_RV,x0,[],[],[],[],lb,ub,@Confun_RV,options);

ReactivePower=x(1); ActivePower=x(2); ApparentPower= x(5); Pwtemp=Pw+1; Result(Pwtemp , 1:9) = [ 10, Vth, Vth0, (Pw/100), ActivePower , ReactivePower , x(7), x(6), x(11)] end

54

Constraints Function

function [c , ceq] = Confun_RV(x) global Rpu Lpu a Pw

%Nonlinear inequality Constraints : c = [];

%Nonlinear equality Constraints :

% [((1/a) - V??) / Z]* . V?? = P + jQ -> ((V/a)?? - V^2) / Z* = -Pw + P + jQ -> % (V/a).(Cos? + jSin?) - V^2 = (-Pw + P + jQ) * (R - jX) ->

% (V/a) . Cos(?) - (V^2) = (-Pw+P)R + (-) QX -> % (V/a) . Cos(?) - (V^2) - (-Pw+P)R - (+) QX = 0 (1) REAL PART

% (V/a) * Sin(?) = -(+)(-Pw+P)X + QR -> % (V/a) * Sin(?) +(-) (-Pw+P)X - QR = 0 (2) IMAGINARY PART

%S = Sqrt(P^2 + Q^2) -> %S - Sqrt(P^2 + Q^2) = 0 (3) APPARENT POWER

% x(1)-> Q 55

% x(2)-> P % x(3)-> V % x(4)-> Tetha % x(5)-> S ceq = [( (x(3)/a) * cos(x(4)) ) - ( x(3)^2 ) - ( ((-Pw/100)+x(2)) *Rpu ) + ( x(1)*Lpu ) ; %(1) ( (x(3)/a) * sin(x(4)) ) - ( ((-Pw/100)+x(2)) * Lpu ) - ( x(1) * Rpu); %(2) ( x(5) - sqrt ( x(2)^2 + x(1)^2 ) ) %(3) ]; end

Objective function function f = Fun_RV(x) %Finding the minimum of Apparent Power S = Sqrt(Q^2 + P^2) f = x(5);

56

