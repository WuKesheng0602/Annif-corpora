Ryerson University

Digital Commons @ Ryerson
Theses and dissertations

1-1-2012

A Fast, Fully Automated Prostate Boundary Segmentation Using Probabilistic Approaches In Ultrasound Images
Rasa Vafaie
Ryerson University

Follow this and additional works at: http://digitalcommons.ryerson.ca/dissertations Part of the Electrical and Computer Engineering Commons Recommended Citation
Vafaie, Rasa, "A Fast, Fully Automated Prostate Boundary Segmentation Using Probabilistic Approaches In Ultrasound Images" (2012). Theses and dissertations. Paper 1711.

This Thesis is brought to you for free and open access by Digital Commons @ Ryerson. It has been accepted for inclusion in Theses and dissertations by an authorized administrator of Digital Commons @ Ryerson. For more information, please contact bcameron@ryerson.ca.

A FAST, FULLY AUTOMATED PROSTATE BOUNDARY SEGMENTATION USING PROBABILISTIC APPROACHES IN ULTRASOUND IMAGES

Rasa Vafaie
BASc, Azad University Central Tehran Branch, Tehran, Iran, 2008

A Thesis Presented to Ryerson University In partial fulfillment of the Requirements for the degree of Master of Applied Science In the Program of Electrical and Computer Engineering

Toronto, Ontario, Canada, 2012 © Rasa Vafaie, 2012

Author's Declaration

I hereby declare that I am the sole author of this thesis or dissertation. I authorize Ryerson University to lend this thesis or dissertation to other institutions or individuals for the purpose of scholarly research. Author's Signature: ----------------------------------I further authorize Ryerson University to reproduce this thesis or dissertation by photocopying or by other means, in total or in part, at the request of other institutions or individuals for the purpose of scholarly research. Author's Signature: ------------------------------------

ii

A FAST, FULLY AUTOMATED PROSTATE BOUNDARY SEGMENTATION USING PROBABILISTIC APPROACHES IN ULTRASOUND IMAGES

Master of Applied Science 2012 Rasa Vafaie Electrical and Computer Engineering Ryerson University Toronto, Ontario, Canada

Abstract
Segmentation of prostate boundaries in transrectal ultrasound (TRUS) images plays a great role in prostate cancer diagnosis. Due to the low signal to noise ratio and existence of the speckle noise in TRUS images, prostate image segmentation has proven to be an extremely difficult task. In this thesis report, a fast fully automated hybrid segmentation method based on probabilistic approaches is presented. First, the position of the initial model is automatically estimated using prostate boundary representative patterns. Next, the Expectation Maximization (EM) algorithm and Markov Random Field (MRF) theory are utilized in the deformation strategy to optimally fit the initial model on the prostate boundaries. A less computationally EM algorithm and a new surface smoothing technique are proposed to decrease the segmentation time. Successful experimental results with the average Dice Similarity Coefficient (DSC) value 93.9±2.7% and computational time around 9 seconds validate the algorithm. iii

Acknowledgements

I would like to express my gratitude and appreciation to my supervisor Dr. Javad Alirezaie in the department of Electrical and Computer engineering at Ryerson University. Dr. Alirezaie was a great mentor for me throughout my post-graduate studies. He allowed me to grow as a student and I have gained a great deal of valuable experience under his supervision. I would like to express my appreciation to my co-supervisor Dr. Paul Babyn in the Department of Medical imaging at university of Saskatchewan and Saskatoon Health region. Without Dr. Babyn's data and medical expertise this thesis would not have been possible.

iv

To my beloved mother and father Fariba and Massoud and my kind sister Dorsa. Without your love and support I would not be where I am today. I am truly blessed to have you in my life.

v

Table of Contents
Chapter 1 ................................................................................................................................. 1
1 2 Introduction ............................................................................................................................. 1 Literature review ................................................................................................................... 12 2.1 Prostate boundary Segmentation algorithms (1996-2002) ............................................... 12
Edge-based algorithms ........................................................................................................... 13 Texture-based algorithms ....................................................................................................... 16 Model-based algorithms ......................................................................................................... 17 2.1.1 2.1.2 2.1.3

Chapter 2 ............................................................................................................................... 12

2.2

Prostate boundary Segmentation algorithms (2002-2012) ............................................... 19
Boundary segmentation using Gabor filters (Deformable model-2003) ................................ 22 Boundary segmentation using PDAF and IMM (Probabilistic filters-2004) ......................... 24 Boundary segmentation using deformable super-ellipse (Hybrid-2004) ............................... 26 Boundary segmentation using Fuzzy Inference system (Probabilistic filters-2005 ) ............. 28 Gland segmentation using Self-organizing maps (Classifier based-2005)............................. 30 Boundary segmentation using image warping (Curve based-2006)....................................... 32 Boundary segmentation using dot-pattern selective cells (Deformable model-2007)............ 34 Boundary segmentation using Genetic Algorithms (Hybrid method-2008) .......................... 36 Boundary segmentation using Partial active shape model (Hybrid method 2010) ................ 40 Boundary segmentation using Graph cuts (Hybrid method-2011)......................................... 41

2.2.1 2.2.2 2.2.3 2.2.4 2.2.5 2.2.6 2.2.7 2.2.8 2.2.9 2.2.10

Chapter 3 ............................................................................................................................... 42
3 Methodology........................................................................................................................... 42 3.1 Model pose parameters ..................................................................................................... 44
Pre-processing ........................................................................................................................ 44 Representative patterns .......................................................................................................... 46 Template Matching using Normalized Cross-correlation ...................................................... 48 Prostate Model Construction .................................................................................................. 51 3.1.1 3.1.2 3.1.3 3.1.4

3.2

Model deformation ........................................................................................................... 53
Prostate model important points ............................................................................................ 53 Adaptive threshold and Probability distribution parameters via EM algorithm ..................... 55 Markov Random Field (MRF) modeling ............................................................................... 61 Model deformation strategy ................................................................................................... 63

3.2.1 3.2.2 3.2.3 3.2.4

Chapter 4 ............................................................................................................................... 68
4 Experimental results ............................................................................................................. 68 4.1 4.2 Model pose parameters ..................................................................................................... 68 Model deformation ........................................................................................................... 72

vi

4.3 5

Validation and performance evaluation ............................................................................ 77

Chapter 5 ............................................................................................................................... 81
Conclusion and Future work ................................................................................................ 81 5.1 5.2 5.3 5.4 Discussion on initial model pose parameters ................................................................... 81 Discussion on model deformation strategy ...................................................................... 82 Limitations........................................................................................................................ 82 Future work ...................................................................................................................... 83

References .............................................................................................................................. 84 List of accepted publications ................................................................................................ 91

vii

List of Tables
Table  1-1 Relative advantages and disadvantages of the various prostate imaging modalities ............. 4 Table  2-1 Prostate boundary segmentation algorithms (1996-2002) ................................................... 13 Table  2-2 Prostate boundary segmentation algorithms (2002-2012) ................................................... 21 Table  2-3 Semi-automatic and automatic prostate boundary segmentation algorithms (since 2002) .. 22 Table  4-1 affine transformation parameters and Dice similarity measurement results ........................ 70 Table  4-2 Comparison between the initial model and the deformed model ......................................... 74 Table  4-3 Quantitative evaluation of prostate boundary segmentation in TRUS imaging ................... 79 Table  4-4 Segmentation time comparison ............................................................................................ 80

viii

List of Figures
Figure  1-1 Coronal view of the Urinary bladder .................................................................................... 2 Figure  1-2 Comparison of prostate imaging techniques ......................................................................... 3 Figure  1-3 A schematic diagram of a conventional ultrasound imaging system .................................... 6 Figure  1-4 Three major challenges in TRUS images ............................................................................. 7 Figure  2-1 Edge-based prostate boundary segmentation using integrated edge maps ......................... 14 Figure  2-2 Edge-based boundary segmentation using stick-shaped and anisotropic filter................... 15 Figure  2-3 Prostate gland segmentation using neural networks ........................................................... 17 Figure  2-4 Construction of the Point distribution model (PDM) ......................................................... 18 Figure  2-5 Prostate boundary segmentation using Gabor filter bank features ..................................... 24 Figure  2-6 Prostate boundary segmentation using probabilistic filters ................................................ 25 Figure  2-7 Deformable super-ellipse models ....................................................................................... 27 Figure  2-8 Prostate contrast enhancement using Fuzzy Inference System (FIS) ................................. 30 Figure  2-9 Prostate gland segmentation using Self-organizing maps .................................................. 32 Figure  2-10 Prostate boundary segmentation using image warping and ellipse fitting ........................ 34 Figure  2-11 Prostate boundary segmentation using dot-pattern selective cells .................................... 36 Figure  2-12 Prostate boundary segmentation using Multi-populations Genetic Algorithm (MPGA) . 39 Figure  3-1 The schematic diagram of the proposed prostate boundary segmentation algorithm ......... 43 Figure  3-2 Perpendicular lines drawn from the starting point on the tangent line ............................... 44 Figure  3-3 Strip structure...................................................................................................................... 45 Figure  3-4 Representative pattern construction .................................................................................... 47 Figure  3-5 Template matching using Normalized cross-correlation .................................................... 49 Figure  3-6 Boundary highlighted image construction .......................................................................... 50 Figure  3-7 Prostate model construction ................................................................................................ 51 Figure  3-8 Finding the model pose parameters using sliding inner product ........................................ 52 Figure  3-9 Prostate six important points .............................................................................................. 54 Figure  3-10 Prostate 11 fundamental points for each side of the prostate............................................ 54 Figure  3-11 Typical histogram of TRUS images ................................................................................. 59 Figure  3-12 The histogram of the pixels inside the field of view ......................................................... 60 Figure  3-13 Binary image resulting from adaptive threshold.............................................................. 60 Figure  3-14 A comparison between binary image and MRF labeled image ........................................ 62 Figure  3-15 Perpendicular windows in deformation strategy .............................................................. 63

ix

Figure  3-16 Model deformation ........................................................................................................... 64 Figure  3-17 Model smoothing .............................................................................................................. 66 Figure  3-18 Iterative deformation procedure........................................................................................ 67 Figure  4-1 Box plot showing the relationship between the sensitivity factor and Dice coefficient ..... 69 Figure  4-2 Manual and automatic prostate boundary segmentation results in model initialization ..... 71 Figure  4-3 The boxplot of the global control parameter in MRF ..................................................... 73 Figure  4-4 The boxplot of the perpendicular window's length ............................................................ 73 Figure  4-5 The boxplot of the perpendicular window's width ............................................................. 74 Figure  4-6 Comparison between the initial model (Left) and the deformed model (Right) ................. 76

x

List of Acronyms
AAM AC ACM ANN ASM BPH CT DM DOG DSC EM ESD ESR FIS GA GLCM HD ILS-DLA IMM MAD MaxD MD MPGA MRF MRI NCC NVP OE OV PASM PCa PCA PDAF PDM SN SOM TRUS Active Appearance Model Accuracy Active Contour Model Artificial Neural Network Active Shape Model Benign Prostate Hyperplasia Computed Tomography Deformable Model Difference of Gaussians Dice's Similarity Coefficient Expectation Maximization Equally Spaced Distance-based Equally Spaced Rotation-based Fuzzy Inference System Genetic Algorithm Gray Level Co-occurrence Matrix Hausdorf Distance Iterative Least Squares Dictionary Learning Algorithm Interactive Multiple Model Mean Absolute Distance Maximum Distance Mean Distance Multi-population Genetic algorithm Markov Random Field Magnetic Resonance Imaging Normalized Cross-correlation Normal Vector Profile Overlap Error Overlap Partial Active Shape Model Prostate Cancer Principal Component Analysis Probabilistic Data Association Filter Point Distribution Model Sensitivity Self-organizing Maps Transrectal Ultrasound Images

xi

Chapter 1
1 Introduction
Prostate is a walnut shaped organ located between the bladder neck and the urogenital diaphragm in males. It lies in front of the rectum and behind the pubic bone (Figure  1-1) [1]. The prostate's main function is to control the urine flow. It consists of 70% glandular tissue and 30% muscular tissue with a total approximate weight of an ounce. Throughout the men's aging process, the prostate gland keeps growing. After the age of twenty five, the growth of the gland significantly reduces. However, most men especially after the age of forty five will face a prostate gland enlargement. The average normal prostate gland size is 3 3 5 cm and its volume should not exceed an approximate volume of 25 ml [2]. Although the prostate gland is not a life sustaining organ, its continual increase in size is referred to Benign Prostate Hyperplasia (BPH) [3], can lead to severe difficulties. BPH tightens the urethra causing decreased urine flow. It is very crucial to detect the gland growth in its early stages and provide medical treatment to overcome the disease, improving the quality of life in elderly men. A considerably more serious disease compared to BPH is prostate cancer (PCa) that threatens human life. In terms of newly diagnosed cancer cases, after lung cancer, prostate cancer is the second most common cancer among men worldwide. According to global cancer statistics published in 2011, over 900,000 men are estimated to be diagnosed

1

with prostate cancer and in almost 250,000 it is fatal [4]. Prostate cancer incidence rate is very high in developed countries including Australia, Western Europe, and North America. For instance in Canada, approximately 35,000 men are diagnosed with prostate cancer every year [5]. However, the mortality rates of PCa in developed countries have been decreasing due to the advancement of medical technology and improvement in medical imaging techniques. Physicians have been utilizing various medical imaging modalities for detecting BPH and PCa. Magnetic Resonance Imaging (MRI), Computed Tomography (CT), and Ultrasound imaging are the main prostate imaging modalities. Each one of these modalities has unique advantages and disadvantages and is appropriate for particular applications including diagnosis,

Figure  1-1 Coronal view of the Urinary bladder ­ prostate gland is located on the floor of the bladder

follow-up, and treatment of the prostate diseases (Table  1-1). For example, CT is the best modality with the ability to monitor the spread of cancer cells into bone tissues. Moreover,

2

due to the high radiation attenuation of the Brachytherapy seeds, the radiation sources located inside the gland appear as bright spots (high-intensity areas) in CT images allowing improved seed visibility compared to other modalities (Figure  1-2a). However, in contrast to MRI and Ultrasound imaging, the radiation of CT is harmful for the human body and it cannot be used in prostate volume determination. The low soft-tissue contrast in CT images makes it extremely difficult to detect cancerous lesions. Additional disadvantages for CT include high cost and lack of portability. Among all prostate imaging techniques, MRI images have the highest soft-tissue contrast especially T2-weighted images [6]. This advantage provides the ability for radiotherapists to easily discriminate the prostate from the surrounding tissues. Also, the resolution of the intra gland tissue, which is a very essential factor for lesion and cancer nodules detection, is considerably higher compared to CT and Ultrasound images [7] (Figure  1-2b).

(a)

(b)

(c)

Figure  1-2 Comparison of prostate imaging techniques (a) a CT image (brachytherapy seeds are clearly visible) (b) an MRI T2-weighted image (high soft-tissue contrast) (c) an ultrasound image.

MRI has numerous disadvantages which may necessitate use of other imaging modalities. Similar to CT imaging, MRI is expensive, not portable, requires a long examination from 20 to 90 minutes and is susceptible to motion artifacts. There is also a restriction for obese people who cannot fit in the MRI equipment and also for patients utilizing pacemaker. The 3

fusion of MRI and ultrasound imaging has been offered as an inexpensive alternative solution for extracting prostate biopsy samples. MRI/Ultrasound fusion guided biopsy technique [8] takes
Table  1-1 Relative advantages and disadvantages of the various prostate imaging modalities (Ghose et. al [9] ) Advantages Disadvantages

CT

Expensive Radiation involved Useful in determining spread of prostate Not portable cancer to bone tissues Poor soft-tissue contrast Useful in determining effectiveness of Difficult to detect lesions prostate brachytherapy Cancer staging is difficult Difficult to implement real time imaging Useful in determining prostate volume No radiation involved High contrast for soft-tissues Allows lesion detection Enables functional imaging of prostate Staging of cancer possible

MRI

Expensive Not portable Difficult to implement real time imaging

TRUS

Useful in determining prostate volume No radiation involved Inexpensive Portable Useful for real time imaging

Low contrast images Difficult to detect lesions Speckle Shadow artifacts Cancer staging is difficult

advantage of high soft-tissue contrast in MRI imaging and the advantages of ultrasound imaging including its simplicity, cost effectiveness, real-time nature and the ability to determine the prostatic volume. In this method, the high spatial resolution T2-weighted MRI image is fused with real time ultrasound to guide physicians directly to the suspected tumors for biopsy. This technology not only has the ability of identifying suspicious areas, but also makes it possible to resample the same location over time. In order to virtually map the

4

suspicious tumors obtained from MRI images into the ultrasound images, it is required to first segment the prostate boundaries in transrectal ultrasound (TRUS) images. Although the boundary segmentation algorithms have significantly improved in the last decade, most radiologists and surgeons prefer to manually outline the prostate boundaries due to its reliability. However, manual boundary segmentation is a very tedious time consuming and irreproducible process. Moreover, significant inter-observer and intra-observer variability are two other important concerns in manual segmentation. The inter-observer variability is the amount of variation between the segmentation results of observers for a particular image. Intra-observer variability is the amount of variation between the segmentation results of one observer when segmenting the same image more than once. As a result, there is a strong demand to develop a highly reliable automatic boundary segmentation algorithm for transrectal ultrasound images. In order to describe the challenges of prostate boundary segmentation in ultrasound images, first it is necessary to introduce the ultrasound imaging modality. In an ultrasound imaging system, a piezoelectric crystal-based transducer transmits the ultrasound wave through human-body tissue and generates medical images based on the reflected wave. The frequency range of ultrasound waves for the purpose of medical imaging is from 2 to 10 MHz [10]. In each transducer, first, the electrical energy is converted to the mechanical energy for propagating sound waves in a medium. The returned signal from tissue is detected by the transducer and using an electromagnetic coil is then converted to the electrical energy. Ultrasound imaging equipment is consisted of transmitter and receiver switching circuit, pulse generator, control panel, analog to digital converter, computer

5

processing and display system [10]. Figure  1-3 illustrates a conventional ultrasound imaging system.

Pulse Generation and timing

Transmitter/ Receiver Circuit

Control Circuit

Data Acquisition Analog-to-Digital Converter

Computer Imaging Storage and Processing

Display

Figure  1-3 A schematic diagram of a conventional ultrasound imaging system

Several modes of ultrasound imaging modes are being used in medical imaging including amode, b-mode, c-mode and Doppler. Transrectal ultrasound is a b-mode ultrasound imaging technique which constructs two dimensional V shape images representing the changes in acoustic impedance of tissue [10]. Ultrasound images suffer from very poor quality, therefore, the segmentation algorithm should have the ability of overcome ultrasound imaging limitations including shadow artifacts, low signal to noise ratio, presence of micro-calcifications, and speckle noise (Figure  1-2c). More specifically, the challenges for prostate boundary segmentation in TRUS images can be classified into three major categories [11] [12] including: 1) Presence of discontinuous boundaries at the anterior part of the prostate due to shadowing artifacts, 2) Existence of similar intensity distribution regions inside and outside of the prostate, and 3)

6

Existence of the dissimilar intensity distribution regions belonging to a particular class. These challenges are described in detail in the following. In the shadow artifacts areas, it is impossible to detect a boundary that distinguishes the prostate and non-prostate regions. Therefore, the algorithm should use neighborhood boundaries information to estimate the location of prostate boundary. The blue circle labeled with C in Figure  1-4a and the region pointed out by arrow A in Figure  1-4b illustrate the

unclear boundaries at the anterior side of the prostate in TRUS images. The second challenge in boundary segmentation is the existence of regions with similar texture in both prostate and non-prostate areas. As a result, due to the overlap between the intensity distributions, a linear classifier cannot be employed to separate the prostate and non-prostate areas. The

(a)

(b)

Figure  1-4 Three major challenges in TRUS images (a) Low signal to noise ratio and poor quality of TRUS images (rectangle ). Arrows in right side point to two distinct regions with similar intensity distributions and left Arrows point to two same class regions with different intensity distributions. Shadowing artifacts is depicted by circle (Yan et. al [11]) - (b) Arrow points to shadowing artifacts. Arrows and points to two similar intensity distribution regions belonging to two distinct class. Arrows and points to dissimilar intensity similarity regions belonging to the same class (Zhan and Shen [12])

7

regions pointed out by arrows

and

in Figure  1-4b have exactly similar intensity

distributions while belonging to two distinct classes. On the other hand, many regions can be found in the same class with dissimilar intensity distributions. For instance, the intensity distributions of the regions pointed out by arrows and in Figure  1-4b are totally

different while they belong to the same class (Prostate). Due to the challenges mentioned above, prostate boundary segmentation in transrectal ultrasound images remains to be a very difficult task. Despite the extensive efforts made to develop a fully automated segmentation algorithm, a reliable and accurate segmentation technique has yet to be accomplished. Two comprehensive surveys, one published by Shao et al. [13] in 2003 and the other by Ghose et al. [9] in 2012, concisely reviewed all the developed algorithms. The purpose of the surveys was to classify the existing algorithms into broad categories and to compare the advantages and disadvantages of the same category algorithm. In the survey published in 2003, the prostate segmentation algorithms in TRUS images were classified into three categories: Edge-based, texture-based and model-based algorithms. Edge-based algorithms detect the prostate gland edges and boundaries and then connect the specific edges together in order to segment the prostate. Texture-based algorithms are another approach for boundary outlining based on texture energy measurements that classify each pixel of the image into the prostate or non-prostate region. Model-based algorithms use a priori knowledge of the prostate shape to capture the shape variability in the same class of objects. It was indicated that model-based algorithms are more promising compared to edge-based and texture-based algorithms. The reason for this statement is the problem of absent edges and boundary discontinuity in the edge-based algorithms and computational complexity in the texture-based algorithms. As a result, since 2003, researchers have been motivated to employ model-based techniques in

8

their proposed algorithms. However, model-based methods alone do not provide adequate segmentation results and it is essential to incorporate other techniques to achieve the desirable outcome. For this reason, in the survey published in 2012, a distinct category was added, hybrid algorithms. Hybrid algorithms are referred to those techniques that combine the advantages of two or more categories to obtain more reliable and robust segmentation results. The proposed hybrid algorithm in this thesis has been developed in such a way to combine and utilize the advantages of the edge-based, texture-based and model-based algorithms. The proposed method consists of two phases: 1) Initial model pose estimation and 2) Model deformation. In the first phase, utilizing both edge-based and model-based techniques, an approximate location of the prostate gland in TRUS images is obtained. In the second phase, combining both texture-based and model-based techniques, the initial model is deformed in such a way to best fit the prostate boundaries and provide the final boundary segmentation. Each phase consists of sequential steps that are briefly described below. In the first phase, a fast fully automated model pose initialization method based on template matching using normalized cross-correlation (NCC) is proposed. Using lower and upper boundary representative patterns, a strip rotates around the center of the probe and emphasizes the prostate boundaries. Representative patterns are constructed from a dictionary learning method, referred to as iterative least squares dictionary learning algorithm (ILS-DLA). Affine transformation parameters then transform the prostate model to a position that best fit on the emphasized boundaries. The obtained initial model is an acceptable approximation of the prostate gland.

9

In the second phase, a new model deformation strategy for prostate boundary segmenting in transrectal ultrasound images is proposed. The Expectation Maximization algorithm (EM) and Markov Random Field (MRF) theory are utilized in the deformation strategy to optimally fit the initial model on the prostate boundaries. For the purpose of real time therapy, a less computational complex EM approach is proposed for obtaining the probability distribution parameters. Also, a new internal force energy that uses 2D geometric transformations is presented that prevents model fault deformation. The contributions of the proposed algorithm are summarized in the following: 1) Initial model pose estimation   New edge emphasizing technique using radial strips New representative pattern construction technique

2) Model deformation strategy     New prostate landmarks indication Fast and less computational Expectation Maximization (EM) algorithm New local search procedure using MRF New model surface curvature preserving technique using 2D geometric transformation The thesis report is organized as follows: In chapter 2, a comprehensive study on the existing developed algorithms is performed. In the first section chapter 2, those categories and their related works given in survey (2003) are briefly described. In the next section, the most recent algorithms (since 2002 to present) are explained in detail. In chapter 3, the methods and materials of the proposed algorithm are presented in two sections. The first section is

10

dedicated to the initial model pose estimation and in the next section the model deformation strategy is fully described. The experimental results and the algorithm evaluation are given in chapter 4. Finally future work and conclusion are stated in Chapter 5.

11

Chapter 2
2 Literature review
Almost two decades ago, the first computer-aided prostate boundary segmentation algorithm was designed for improving the efficiency and assisting radiologists and surgeons. Since that time, excessive advancements have been made and the segmentation algorithms have become more rapid and reliable. In this literature review, in order to highlight the progress and advantages of the recent algorithms, the segmentation algorithms were categorized based on the year that they were published. The algorithms which are published before 2002 are briefly reviewed in section  2.1 and those which were developed after 2002 are explained in detail in section  2.2.

2.1

Prostate boundary Segmentation algorithms (1996-2002)

In 2003, Shao et al. [13] provided a great survey for prostate boundary detection algorithms in ultrasound images. The purposes of the survey were (a) To categorize the algorithms based on the utilized methods and materials (b) To describe the advantages and disadvantages of the proposed algorithms. The authors indicated that all the developed algorithms can be categorized into three broad categories: 1) Edge-based algorithms, 2) Texture-based

12

algorithms, and 3) Model-based algorithms. A number of related works for each category is given in Table  2-1.
Table  2-1 Prostate boundary segmentation algorithms (1996-2002) Category Related works

Edge-based

Maximum/Minimum filter [14] Weak membrane fitting [15] RBR and harmonics method [16]

Texture-based

Pixel classifying based on 4 energy terms [17]

Model-based

Feed forward Neural networks [18] Feature modeling [19]

A brief explanation about each category and their related works are given in the following sub-sections. 2.1.1 Edge-based algorithms

Edge-based algorithms are referred to the techniques that first employ an edge detector filter to emphasize the boundary edges and then connect the discontinuous boundaries to obtain a closed prostate contour. However, due to the presence of the speckle noise and the poor quality of transrectal ultrasound images, it is clear that simple edge detector filters (e.g. Sobel and Prewitt) do not give the desirable results. Therefore, most of the edge-based algorithms first enhance the quality of the image in the preprocessing part and then utilize more sophisticated edge detector filters to achieve accurate segmentation results.

13

In 1998, Aarnink et al. [14] developed an edge-based algorithm where maximum/minimum filters were first utilized in the preprocessing part in order to increase the signal to noise ratio of the ultrasound images. Since image gradient and image second derivative were further used in the edge enhancement algorithm, it was essential to reduce the high frequency noise for preserving false edge detection. For this purpose, prior to the edge detection procedure, a smoothing filter was applied to the ultrasound images. A multi-resolution edge detection technique based on the global and local standard deviation values was then employed for highlighting the prostate boundaries. A comparison between local and global standard deviation values determines whether the gray level transition exists or not. Those regions with greater standard deviation values are then analyzed in a multi-resolution manner in order to construct the edge map (Figure  2-1b). Final boundary outlining was accomplished by connecting the enhanced edges using interpolation and incorporating prior knowledge (Prostate shape).

(a)

(b)

(c)

Figure  2-1 Edge-based prostate boundary segmentation using integrated edge maps (a) Maximum/minimum filtered image (b) Edge detected image using global and local standard deviation values (c) The final prostate contour

In 2000, Pathak et al. [20] presented a new edge-based algorithm where stick-shaped and anisotropic filters were employed to enhance the contrast of the ultrasound images. Stickshaped filter calculates the average gray-level intensity value along each line passing through the center of an square matrix around each pixel of the image, and then assigning the 14

maximum average gray-level value to that particular pixel. This filter while preserving the edges of the prostate boundaries, at the same time also applies image smoothing and reduces the speckle noise (Figure  2-2b). Although a significant improvement in signal to noise ratio is achieved by applying the stick-shaped filter, the filtered image still suffers from speckle noise. Since the boundary edges are detected with the use of the Canny edge detector, it is essential to completely remove the impact of the speckle noise from the image. For this purpose, prior to applying the edge detector filter, a weak membrane fitting algorithm is utilized in the stick-shaped filtered image (Figure  2-2c). Weak membrane fitting algorithm is very similar to nonlinear anisotropic diffusion filtering technique which treats each pixel of the image depending on the neighborhood pixels information. A great advantage of anisotropic diffusion filter is that it has control on the blurring. That is, it prevents smoothing

(a)

(b)

(c)

(d)

(e)

(f)

Figure  2-2 Edge-based boundary segmentation using stick-shaped and anisotropic filter (a) Original TRUS image (b) Stick-shaped filtered image (c) Result of weak membrane fitting on stick-shaped filtered image (d) Canny edge detector before a priori knowledge (e) result after a priori knowledge (f) final boundary segmentation result

15

across boundaries by applying less blurring. Canny edge detector filter is then applied on the image to highlight the boundaries. As illustrated in Figure  2-2c, there exist many false edges around the prostate gland. Using a priori knowledge of a bean-shaped of the prostate, the false boundaries are removed from the image (Figure  2-2e). Final boundary outlining is accomplished manually by the guide of the remaining edges. 2.1.2 Texture-based algorithms

Texture-based algorithms are another approach for prostate gland segmentation in TRUS images. These algorithms, based on texture measurements, categorize each region of the image into the prostate and non-prostate regions. Prater and Richard [18] proposed a texturebased algorithm in which four different micro texture energies were measured for each pixel. The idea behind the feature extraction and texture energies was that the prostate gland is surrounded by a bright halo and the intensity distribution inside the prostate is completely different from the other areas. For this purpose, local window means in four directions were calculated and considered as the input feature vector for a neural network system. In order to train the network and determine the network weights, a set of manually segmented images is utilized first in the training process (Figure  2-3b). In order to evaluate the classification, the authors trained the network with mid-gland images and tested with adjacent images (Figure  2-3c and Figure  2-3d). It was shown that the accuracy of the segmentation is directly related to the number of the network's layers. A significant improvement was observed by increasing the number of the input features and the number of the hidden layers. However, there was a huge trade-off between accuracy and computational complexity.

16

(a)

(b)

(c)

(d)

Figure  2-3 Prostate gland segmentation using neural networks (a) Original TRUS image (b) Manually segmented image (c) Segmentation of training image (d) Segmentation of adjacent image

2.1.3

Model-based algorithms

Model-based algorithms have been proposed as a third approach to prostate boundary segmentation. These algorithms use a priori knowledge of the shape of the object. Modelbased algorithms are divided into two sub-categories: a) Deformable contour models b) Statistical modeling. Active contour models (ACM or snakes) have been commonly used in segmentation algorithms and were first developed by Kass et al. [21]. In this technique, based on the energy minimization problem, the surface of the model deforms until it reaches the edges. The minimization problem consists of two main energy functions referred to as Internal and External energy terms. The model deformation is performed under influence of the external energy. One of the common external energy terms is the image intensity gradient along perpendicular direction to the model surface. In order to preserve contour curvature and smoothness, Internal energy is utilized to constrain the model deformation from being widespread. The other model-based technique, Statistical modeling was first introduced by Cootes et al. [22] and has been widely used in segmentation of the objects with the well-defined shapes

17

and appearances. The statistical prostate boundary modeling technique consists of two major parts: 1) Boundary modeling, and 2) Local search procedure. These steps are described in the following paragraphs. 1) Boundary modeling refers to a shape descriptor function which is a representative of a set of manually segmented boundaries. In order to construct a prostate model from training images, first it is essential to represent the manually outlined boundaries with a set of landmark points. Since there is no significant landmark point in prostate shape (e.g. no corner, no high curvature and etc.), the prostate contours are sampled into a fixed number of points. Equally spaced distance-based (ESD) and equally spaced rotation-based (ESR) are two common surface sampling techniques which are illustrated in Figure  2-4a and Figure  2-4b respectively. In order to reduce the variability in the shape and location of the prostate contours (Figure  2-4c), the sampled contours should be aligned to a reference shape by using geometric transformations (Figure  2-4d). Finally, the Point Distribution Model (PDM) is constructed based on the statistical information provided by aligned sampled contours. The statistical parameters including mean, covariance matrix, eigenvectors and their corresponding eigenvalues are obtained using the location of sampled points [22].

(a)

(b)

(c)

(d)

Figure  2-4 Construction of the Point distribution model (PDM) (a) Equally spaced distance-based (ESD) shape modeling (b) Equally spaced-rotation based (ESR) shape modeling (c) a set of manually outlined boundaries (d) a set of aligned prostate contours

18

2) Local search procedure is performed on each one of the sampling points in order to detect the location of strong edges. The location of the sampled points is further adjusted with the location of the detected edges. The resulting shape is a deformed version of the prostate model and may no longer resemble to the prostate shape. In order to return the deformed model into a prostate shape, optimization problems are employed to construct the closest prostate shape. Wu et al. [19] proposed a new model based algorithm in which the Genetic Algorithm (GA) was utilized to find the optimum pose parameters. The author claimed that a significant reduction in computational complexity can be achieved by employing GA instead of search algorithms. A complete explanation about GA algorithms and their application in modelbased algorithms is given in section  2.2.8.

2.2

Prostate boundary Segmentation algorithms (2002-2012)

In late June 2012, Ghose et al. [9] provided a complete survey on prostate segmentation algorithms that had been developed for all imaging modalities including ultrasound, magnetic resonance, and computed tomography. All recent proposed algorithms were analyzed and briefly discussed in order to find the most efficient and reliable method. In this literature review, only those algorithms that are designed for ultrasound images are considered. Based on the methods and materials used in algorithms, the segmentation techniques were divided into four broad categories including 1) Contour and shaped based, 2) Region based, 3) Supervised and unsupervised classification, and 4) Hybrid. A brief explanation of each category is given in the following paragraphs.

19

Contour and shape based algorithms use a priori knowledge of the prostate shape in order to segment the boundaries. These methods based on the energy information calculated from the edges, fit a shape model or a contour onto the prostate boundaries. These algorithms are again divided into three sub-categories including edge-based, probabilistic filters, and deformable models. Region based algorithms use an energy minimization framework by comparing the local statistical parameters in training and testing images. Local intensity distribution and standard deviation are the parameters that are commonly considered in the energy minimization problem. Level sets and graph partition based algorithms are the sub-categories of the region based algorithms. Supervised and unsupervised classification methods label each pixel of the ultrasound image into the prostate or non-prostate area. Supervised methods classify the pixels based on a priori knowledge obtained from the training set. Unsupervised methods perform clustering by grouping similar pixels together based on the feature measurements. Hybrid algorithms are referred to those techniques that combine some of the above mentioned categories to achieve prostate boundary segmentation. The main goal of the hybrid algorithms is to use the advantages of other categories in order to obtain more reliable and robust segmentation results. Taxonomy of the developed prostate boundary segmentation algorithms is given in Table  2-2.

20

Table  2-2 Prostate boundary segmentation algorithms (2002-2012) Method Sub-category Sub-sub-category

Edge based Probabilistic filters

Contour and shaped based Deformable filters

Deformable mesh Level sets Active shape models Curve based Active contour model

Region based

Level sets Graph partition based

Supervised and unsupervised classifications

Cluster based Classifier based

Hybrid methods

In this literature review, in order to cover each category and explain their related works in detail, an attempt has been made to describe the methods based on the order of publishing year. The most important and interesting works since 2002 are listed in Table  2-3. Also, for each algorithm, it is shown that whether it is fully automated or not.

21

Table  2-3 Semi-automatic and automatic prostate boundary segmentation algorithms (since 2002) Reference Year Methodology Automatic

Shen et al. [23] Abolmaesumi [24] Gong et al. [25] Sahba et al. [26] Zaim [27] Badiei et al. [28] Mohamed et al. Zaim et al. [29] Cosio [30] Yan et al. [31] Ghose et al. [32] Ghose et al. [33] Ghose et al.

2003 2004 2004 2005 2005 2006 2006 2007 2008 2010 2010 2011 2012

DM-ASM (Gabor features) Probabilistic filters (Kalman, PDAF and IMM) DM-Curve fitting Probabilistic filter Classifier-ANN DM-Curve fitting Classifier-SVM DM-ACM EM and ASM ACM and ASM Wavelets and AAM EM and AAM Quadrature filter and AAM

Yes No No No Yes No Yes Yes Yes Yes No Yes No

In the following sub-sections a complete explanation of each one of the above algorithms is provided. 2.2.1 Boundary segmentation using Gabor filters (Deformable model-2003)

A fully automated model-based boundary segmentation method was introduced by Shen et al. [23] in 2003 where Gabor features were utilized for model deformation. In order to perform the feature extraction in a multi-scale and multi-orientation manner, they generated a Gabor filter bank by dilating and rotating the Gabor's mother function in three scaling stages and six different orientation directions (Figure  2-5a). The Gabor filter has the ability of simultaneously performing both edge detection and noise reduction (smoothing). This is because the Gabor function is a modulation of a Gaussian kernel and a sinusoidal wave as defined below, ( ) ( ) ( ( ) )

Eq.  2.1

22

The Gaussian factor in the real part performs the image smoothing and to some extent removes the speckle noise in TRUS images (Figure  2-5d). The imaginary part exactly acts as an edge detector filter and due to the multi-orientation nature of the Gabor filter it also provides the edge directions (Figure  2-5e). Figure  2-5b illustrates one-dimensional Gabor filter where the edge detector and smooth filters are shown in dashed and solid lines respectively. In their method, polar coordinate system with the origin at the probe center was preferred to the Cartesian coordinate system and the Gabor features were extracted along radial directions. In order to obtain valid Gabor responses in the polar coordinate system, the rotation of the probe in each radial direction was also considered in the regular Gabor function. This resulted in obtaining a set of rotation non-invariant Gabor features which were further utilized in the model deformation. Similar to the other model-based algorithms, prostate boundary detection was performed by minimizing the total energy function. The total energy function is a weighted summation of the external and internal energies. In their method, both real and imaginary parts of the rotation non-invariant Gabor features were used to determine the external energy. This makes the algorithm more robust in boundary detection since in the case that the imaginary part detects a false boundary; the real part will modifies the false detection by checking the intensity distribution around the prostate boundaries. In order to preserve the model curvature, a vector of geometric attributes was proposed to be considered as the internal energy. Also, another novel technique was used for preserving the shape of the model in the deformation strategy. If a model point is forced to be displaced by the external energy, its neighbors will be displaced consequently. The propagation of the neighbors' displacement obeys a Gaussian function in such a way that the

23

deformed model point locates on the peak and the right and left neighbors lie on the Gaussian bell curve (Figure  2-5c).

(a)

(b)

(c)

(d)

(e)

(f)

Figure  2-5 Prostate boundary segmentation using Gabor filter bank features (a) frequency spectrum of the multi-scale and multi-orientation Gabor filter (b) one-dimensional Gabor filter consists of smooth and edge detector filters (c) Gaussian displacement propagation of a deformed model point and its neighbors (d) smooth image (Real part) (e) edge detected image (Imaginary part) (f) segmented boundary

Although their fully automated algorithm had many advantages, the feature extraction computations were extremely intensive due to the multi-scale and multi-orientation manner of the Gabor filter bank; therefore, it was not appropriate for real time therapy. Also, according to the author's claim, the model initialization was not accurate enough. 2.2.2 Boundary segmentation using PDAF and IMM (Probabilistic filters-2004)

In order to overcome the disadvantages of the aforementioned method, Abolmaesumi and Sirouspour [24] proposed a probabilistic filter segmentation technique which utilized 24

interactive multiple model (IMM) and probabilistic data association filter (PDAF) for outlining the prostate boundaries. Since their algorithm unlike the model-based algorithms did not have any optimization problems, it was computationally more efficient and it was able to segment the prostate boundaries in a significantly shorter amount of time. In the preprocessing part of their methodology, the stick filter was used to reduce the speckle noise and enhance the boundary edges (similar to the proposed method by Pathak et al. [20] described in section  2.1.1). Figure  2-6b shows the boundary enhanced image resulted by applying the stick filter to the original TRUS image. The edge detection procedure was performed along the radii starting from a seed point located inside the prostate gland. The authors assume that the detected edges are a trajectory of a moving object whose motion forms a particular model. However, due to the low contrast and the speckle noise in TRUS images, there is always a random vibration in the trajectory of the detected edges (Figure  2-6c). This random vibration (error) was further modeled by a zero-mean white Gaussian noise in the Kalman filter algorithm. The statistical Kalman filter was used in order to estimate the optimal boundary locations based on the predicted boundaries. Since it was possible that two or more edges be detected on each radius, the authors utilized PDAF and IMM in order to solve the multi model problem. The PDAF algorithm followed by the IMM

(a)

(b)

(c)

(d)

Figure  2-6 Prostate boundary segmentation using probabilistic filters (a) Original TRUS image (b) Stick filtered image (c) Edged detected image prior to Kalman estimator (d) Final segmentation result

25

estimator finds the optimum prostate boundary edges based on a set of Kalman filters outputs (Figure  2-6d). Their proposed algorithm suffers from two important disadvantages. First, the algorithm is not fully automated such that the position of the seed points should be determined by a user. Second, the selected seed point should have direct access to all prostate boundaries. The later disadvantage does not occur for the majority of TRUS images, however, there exist some images in which the prostate gland appears as a more complicated shape. 2.2.3 Boundary segmentation using deformable super-ellipse (Hybrid-2004)

In contrast to the last described method, Gong et al. [25] preferred to use deformable shape models in their boundary segmentation algorithm. One of the great advantages of the deformable models is their ability to remove the gap between prostate boundaries caused by shadowing artifacts. This task can be obtained by incorporating additional knowledge of the prostate shape into the deformable model algorithms. These shape constraints restrict the model from false deformation leading to a significant improvement in the segmentation performance. In their method, the parametric super-ellipse model was proposed as an alternative parametric shape modeling approach such that the walnut shape and the nearconvex surface of the prostate gland was considered as the prior shape knowledge. The advantage of the ellipse parametric model is the capability of constructing a variety of natural shapes with only a few parameters. The initial model position is defined by the model pose parameters including scaling ( ), rotation ( ), and translation ( , ). In order to incorporate

the capability of constructing the walnut shape models, the authors added the square-ness ( ), aspect ratio ( ), tapering ( ), and bending ( ) parameters to the model parameters. As

26

a result, by varying only 8 parameters, deformable super-ellipse can construct a variety of prostate shapes (Figure  2-7).

Figure  2-7 Deformable super-ellipse models

An area minimizing problem was further utilized to fit the parametric super-ellipse model on the boundaries. The evaluation results of the fitting the parametric model on around 600 manually segmented images indicated that the deformable super-ellipse models are adequately reliable to be used in prostate boundary segmentation. Also, they compared the parametric super-ellipse model with the Fourier descriptor. Even with increasing the number of harmonics, both Hausdorff distance and mean absolute distance of the super-ellipse model was less than Fourier descriptor. Moreover, Fourier descriptor compared to super-ellipse models needs more parameters to extract the prostate boundaries. For instance, a Fourier descriptor with three harmonics has 14 parameters leading to a high computation load and is far away from real-time segmentation. A boundary segmentation algorithm based on the Bayesian framework was utilized to obtain 8 optimize super-ellipse deformation parameters. The shape and pose prior were modeled with Gaussian distributions and the edge-map of the image was considered as the likelihood in the Bayes rule. An edge detection methodology exactly similar to the technique proposed by Pathak et al. [15] was employed to strengthen the prostate boundaries. In this robust technique, Stick filter, edge-preserving weak membrane, and Canny edge detector respectively perform the contrast enhancement and true edge preservation in noisy images. 27

The parametric deformation supper-ellipse model has many advantages in prostate boundary segmentation including low computation burden and the ability in modeling a variety of prostate shapes. However, in the model initialization step, it is required that more than two initial points be selected by a user. This drawback causes the algorithm to be categorized as a semi-automatic prostate boundary segmentation algorithm. 2.2.4 Boundary segmentation using Fuzzy Inference system (Probabilistic filters2005 ) In 2005, Sahba et al. [26] proposed a new method that probabilistic filters and a fuzzy inference system (FIS) were utilized to perform the automatic boundary outlining. Their segmentation strategy was based on the fact that the prostate boundaries can be extracted more accurately in a perfectly contrast enhanced image. Therefore, they performed several sequential steps in order to enhance the contrast of the prostate gland. A coarse estimation of the prostate boundary was the main prerequisite for their proposed contrast enhancement fuzzy system. For this purpose, a probabilistic method similar to the algorithm described earlier (Abolmaesumi [24]) was utilized in order to roughly segment the gland. In their method, Kalman filter was used to estimate the location of the boundary edges on the radial lines drawn from a seed point located inside the prostate. The position of the seed point had to be selected manually in [24] but in the present work this task is accomplished automatically. To obtain the position of the seed point, first, the ultrasound image were smoothed using median and average filter. Next, Top-hat and Bottom-hat filters were utilized to enhance the contrast of the image. These filters are a combination of morphological operations and their principal application is in correcting the non-uniform background illumination [34]. Due to the presence of the speckle noise, the authors considered the 28

background of the ultrasound images as a non-uniform illumination region and then employed the Top-hat and Bottom-hat filters together to isolate the surrounding tissues. Afterward, the filtered image was converted to the binary image and the holes inside the bright objects were filled using morphological operations. Finally, after applying multiple erosions, the center of the remaining bright object was considered as the position of the seed point. Using Kalman estimator, the polar coordinates (with the origin at the seed point) of the prostate boundaries in the thresholded image were estimated. Kalman estimator was utilized to prevent the fault edge detection and also to predict the position of unclear edges caused by shadow artifacts. A course prostate contour was then obtained by connecting the estimated boundary edges together. In order to determine a prostate boundary region, two more contours were further constructed in such a way that the course contour exactly place between them. A fuzzy inference system was further utilized to manipulate the gray-level values of the pixels located inside the boundary region. The fuzzy regulations in their proposed method are listed as follows: 1) If the pixel is not located inside the prostate region then its gray-level remains the same 2) If the pixel is located inside the prostate region and it is a dark pixel then change its gray-level to a darker pixel 3) If the pixel is located inside the prostate region and it is a gray pixel then change its gray-level to a dark pixel 4) If the pixel is located inside the prostate region and it is a bright pixel then change its gray-level to a brighter pixel. Figure  2-8 compares the contrast of the original image, the enhanced image by Top-hat and Bottom-hat filter, and the enhanced image by FIS technique.

29

(a)

(b)

(c)

Figure  2-8 Prostate contrast enhancement using Fuzzy Inference System (FIS) (a) Original TRUS image (b) Top-hat and Bottom-hat filtered image (c) FIS contrast enhanced image

As illustrated in Figure  2-8c, a significant contrast enhancement is achieved in the prostate region. The boundary extraction can now be performed by utilizing the Canny edge detector on the enhanced image. The edges around the coarse contour are considered as potential prostate boundaries. The discontinuous boundaries are further connected by a straight line in order to obtain a continuous contour. Although the position of the seed point in the described method was determined automatically, the first required data for the Kalman estimator had to be provided manually. Therefore, this algorithm cannot be considered in the category of the fully automated algorithms. 2.2.5 Gland segmentation using Self-organizing maps (Classifier based-2005)

In 2005, Zaim [27] developed a fully automated prostate gland segmentation based on Selforganizing maps (SOM). SOM is an unsupervised Artificial Neural Networks (ANN) used when the output answer is not known and it is desired to find the structure and pattern of data. SOM uses both competitive and cooperative training to cluster and classify the input data. Each input vector was formed by four different features. The pixel intensity value and its coordinates ( ) were assigned to the first three features of the input vector. The last

feature was a texture feature and it was calculated by applying morphological and texture 30

filters. First, median and top-hat filters were utilized to outline the speckle pattern in TRUS images. The second-order Gray level co-occurrence (GLCM) filter was further used to find the homogenous regions. GLCM is a very powerful texture filter which specifies the occurrence probability of all pixel combinations in an image. Since in the homogenous areas there is no significant gray-level difference, it is expected to find large probability values in the vicinity of the GLCM matrix diagonal. Based on the texture information in the GLCM matrix, the author found the best threshold value that gives the highest contrast. The forth feature of the input vector is derived from the high contrast thresholded image (Figure  2-9b). In the competitive training procedure of the SOM, every four dimensional input vector is presented to every neuron of the neural network. The neurons adjust their weights in each epoch to become more like the input data. Epoch is referred to as the number of the times that the input data is fed to the neurons. The advantage of SOM compared to the regular Neural Networks is that the neurons not only adjust themselves to the input data but also adjust themselves to neighbouring neurons as well. A two layer SOM was constructed to map the four dimensional data in to the two-class output, i.e., prostate and non-prostate. In the first layer, a 2 3 network classifies the input data into 6 different categories. In each category, those input data that are more topologically close are grouped together. The second layer of SOM then performs the final classification and assigns a binary label to each pixel of the TRUS image. As illustrated in Figure  2-9c, there exist many misclassified pixels inside and outside of the prostate gland. The author utilized morphological filters to modify the misclassified pixels. The false positive scattered pixels located outside of the prostate gland are destroyed by erosion. The false negative holes inside the gland are filled by dilation Figure  2-9 (d).

31

(a)

(b)

(c)

(d)

Figure  2-9 Prostate gland segmentation using Self-organizing maps (a) Original TRUS image (b) GLCM thresholded image (c) Classified image using SOM (d) Final segmentation using morphological operations

The main advantage of the described method is its capability in segmenting the prostate gland without any user-interaction. However, from the segmentation results, it is clear that the accuracy of the algorithm is not satisfactory. It is essential to combine a model-based algorithm to obtain a smooth surface. The extensive computational burden in extracting the texture features is another disadvantage of this method. Although the size of the images were reduced by a factor of five, the GLCM algorithm and SOM network are time consuming approaches which is in contrast to real- time processing. 2.2.6 Boundary segmentation using image warping (Curve based-2006)

In 2006, Badiei et al. [28] presented a new 2D prostate boundary segmentation technique based on image warping and ellipse fitting. The idea behind their method is that the prostate gland shape (bean-shape) can be considered as a warped version of an ellipse. The pressure of the ultrasound probe during imaging procedure causes the mid-anterior of the prostate to change its shape from oval to a deformed shape. In order to remove the impact of this pressure, the authors proposed a warping function that was capable of converting the prostate shape into an ellipse model. For this purpose, a polar coordinate system at the origin of the ultrasound probe was first defined. In the new coordinate system each pixel of the image is represented by a radius and an angle ( ). In order to warp the mid-anterior of the prostate,

32

only those pixels of the image that are close to the probe center (small radius) and their angle is around / should be warped. To provide these conditions, the warping function consists

of a combination of sinusoidal and exponential function was proposed as below
Eq.  2.2

( ) where

(

)

determines the amount of stretch in the radial direction. As is clear from the Eq.  2.2,

the amount of stretch is minimum for those pixels with large radius and the angle around 0 or . Prior to the image warping, a user selects 6 boundary points on the original TRUS images (unwarped images). By applying the warping function, the selected boundary points in the warped image lie on an ellipse function (Figure  2-10b). The authors obtained the parameters of the ellipse function by solving the least square elliptical fit problem. The elliptical fit optimization problem calculates the ellipse function parameters in such a way that the selected boundary points in the warped image have the minimum distance from the ellipse contour. This ellipse contour was then utilized as an initial contour in the prostate boundary detection technique proposed by Abolmaesumi [24] (described earlier). In this technique Probabilistic Data Association Filter (PDAF), Kalman estimator and Interactive Multiple Model (IMM) are employed to predict the unclear prostate boundaries in shadow areas (Figure  2-10c). After performing edge detection, the inverse warping function is utilized to convert back the warped image to the original TRUS image (Figure  2-10d).

33

(a)

(b)

(c)

(d)

Figure  2-10 Prostate boundary segmentation using image warping and ellipse fitting (a) Initialization (b) warped image (c) boundary detection using PDAF and IMM (d) reverse warped image

The advantages of the described algorithm can be listed as 1) low computational burden 2) does not require training models 3) the segmented boundary is smooth, continues, with no sharp edge, and it is symmetric. However, its major disadvantage is the need of manually selecting six boundary points in the initialization part. The other disadvantage of the described method is that the value of of in Eq.  2.2 must also be selected manually. The value

in warping function determines the amplitude of the stretch and has a direct impact on was selected separately, this

the overall segmentation process. For each image, the value of

is a time consuming process and is not suitable for real-time applications. 2.2.7 Boundary segmentation using dot-pattern selective cells (Deformable model2007) In 2007, Zaim and Jankun [29] proposed a new model-based prostate boundary segmentation algorithm where dot-pattern texture energy map was utilized as an external energy to deform the model. Since most model-based algorithms use gradient information in model deformation strategy, their goal was to develop a more robust external energy function to work well even in poor contrast TRUS images. Due to the presence of speckle noise in ultrasound images, the use of one directional gradient can result in false edge detections and ultimately inaccurate segmentation. Instead, analysing a local neighborhood in both x and y

34

directions can significantly improve the boundary detection algorithm. For this purpose, the authors utilized a texture-based feature extraction technique referred to as Dot-pattern selective cells. Dot-pattern is a set of equidistant distributed cells forming a 2D geometric lattice. The first step of the dot-pattern feature extraction technique is the response computation of center-surround cells to the input image. Center-surround cells show a heavy reaction to the bright spots of a certain size and a weak reaction to the other regions. Therefore, center-surround cells can be modelled with a Difference of Gaussians (DOG) function

(

)

Eq.  2.3

where

and

are normalizing constants and

is the standard deviation of the Gaussian

function (Figure  2-11a). In order to obtain the dot-pattern responses, the input image and DOG functions with different standard deviation values are then convolved together. The texture feature extraction is highly sensitive to the image pixel intensities; therefore, it is necessary to normalize the convolution values. The contrast normalization is performed by dividing the convolution values to the local average gray-level intensities. This normalization guarantees that the texture features are dependent to the intensity values. After calculating a set of dot-pattern responses, the spot detection algorithm is utilized to obtain the textural features. The spot detection process consists of four main steps: 1) Nonmaxima suppression, 2) low response removal, 3) lateral inhibition, and 4) winner-takes-all competition. Each one of these steps examine a threshold rule and produces a binary mask [35], [36]. The pixel-wise multiplication of all four binary masks produces a dot-pattern

35

image such that the pixels with intensity value equal to +1 indicate the position of the spots. The constructed dot-pattern image is further considered as an energy map to guide the model deformation (Figure  2-11c). Similar to other model-based algorithms, the location of the prostate model contour was determined by solving an energy minimization problem between the external and internal energies. External energies pull the model surface toward the locations with high dot-pattern energy (Figure  2-11d) while internal energy preserves the model curvature and smoothness.

(a)

(b)

(c)

(d)

Figure 2  -11 Prostate boundary segmentation using dot-pattern selective cells (a) Plot of 2D Difference of Gaussians (b) input TRUS image (c) Energy map image using dot-pattern selective cells (d) final model-based segmentation

Although the proposed algorithm is fully automated, it suffers from two major disadvantages. First, the accuracy of the boundary segmentation is not satisfying as compared to earlier algorithms. Second, the texture-based feature extraction methods are generally

computationally expensive and are not suitable for real-time applications. Since there is no discussion about algorithm complexity, it seems that the proposed method also has a huge computational burden. 2.2.8 Boundary segmentation using Genetic Algorithms (Hybrid method-2008)

In 2008, Cosío [30] employed Multi-population Genetic Algorithm (MPGA) to fully automatically segment the prostate boundaries in Transurethral images. The shape of the

36

prostate gland in transurethral images is slightly different from the prostate shape in transrectal images (Figure  2-12a). However, due to the similarity of the challenges faced in both imaging techniques, the proposed method is considered in this literature review. In this work, unlike most model-based algorithms, a new automatic model pose initialization method was utilized to overcome the drawback of user interaction dependency. In this method, a pixel classification technique is first employed to label each pixel of the image as a prostate or non-prostate area. A group of the labeled pixels in the binary image forms a closed object which is an acceptable estimation of the prostate gland. Next, the pose parameters of an Active Shape Model (ASM) are calculated in such a way that the surface of the model lies on the object boundaries. The pixel classification is accomplished by utilizing Bayes' discriminant functions. For this purpose, each training ultrasound image is subdivided into three regions including 1) prostate, 2) surrounding tissue (hale), and 3) background. A set of three components samples is then extracted from each region of the image to train the classifier. The components of each sample consist of pixel grey level intensities and their corresponding coordinates (x,y). By collecting the samples of all training images, a statistical population can be obtained. In order to find the statistical parameters of each region, the pixel intensity distribution of ultrasound images was modelled with a mixture of three Gaussian models. Expectation Maximization (EM) algorithm is then utilized to obtain the mean and standard deviation values of the model of each class. The calculated statistical parameters form the likelihood functions which are one of the requisites of Bayes' classifier. The other term required for Bayes' classifier is the prior probability values of each class. This term can also be calculated from the training set by dividing the number of samples of a particular region by the total 37

number of samples. Now, based on the prior probabilities and likelihood functions, the posterior probability of each region can be calculated. The label of each pixel is determined by a comparison of the posterior probability values of all three regions. If the posterior probability of the prostate region is greater than two other regions, that pixel is identified as a target and its label is set to +1 (Figure  2-12b). The model pose parameters including scaling, translation (in both directions), and rotation determine the location of the ASM in the binary image. The aim of the model initialization is to find the optimum pose parameter values in such a way that the distance between the constructed ASM surface and the object boundaries is minimized. These optimum values are obtained by solving a fitting optimization problem. Since there are many unknown variables and the search space is too large in the optimization problem, the author utilized Multipopulation Genetic algorithm (MPGA) to solve the objective function. Genetic algorithm (GA) is an optimization technique that mimics the evolution of the natural systems [37]. GA is not a calculus-based algorithm and the optimum values are found by a heuristic search technique. Genetic algorithm follows five sequential phases in an iterative manner to find the optimum solution. These phases are ordered as follows: 1) Initial population, 2) Fitness function, 3) Selection, 4) Crossover, and 5) Mutation. The initial population begins with randomly generated states. The randomly generated states should fall in the range of model parameters. Since the GA algorithm only works in a binary system, it is first required to convert the parameter values into a stream of binary numbers. In the next step, the numerical values of the objective function are calculated using fitness function and the worst string based on the relative fitness values are eliminated from the population. In the crossover phase, each pair of the selected strings exchanges a portion of their information to create a 38

new population. The average objective function value of the new generated strings indicates a significant improvement after only one iteration. In the Mutation step, in order to preserve good strings from being destroyed in the cross over phase, a few numbers of bits (maximum 5% of the total number of bits) are changed from 1 to 0 or vice versa. These phases iteratively will be applied to the population until the objective function value converges to the optimum value. The main advantage of GA is that in each generation there is a progressive improvement on the objective function. In order to prevent the algorithm to be trapped in the local minima, the Multi-population GA was utilized in the model pose initialization. The only difference between MPGA and GA is that the calculations are performed on a set of parallel populations and some strings frequently migrate from one population to another. After finding the approximate location of the ASM in the binary image, the final prostate boundary contour is obtained by adjusting the initial model to the gray level ultrasound image. The Contour adjustment is achieved by solving another MPGA optimization problem. The objective function is to minimize the average gray level difference along the lines perpendicular to the ASM surface. The perpendicular lines are drawn from the inside to the

(a)

(b)

(c)

(d)

Figure  2-12 Prostate boundary segmentation using Multi-populations Genetic Algorithm (MPGA) (a) a typical transurethral image (b) Classified binary image and the initial model contour (c) pixel profile sampling along perpendicular lines (d) Comparison between fully automated (black) and manually (white) segmentation

39

outside of the prostate contour in such a way that the center of each line lies onto the model surface (Figure  2-12c). Although the proposed method by Cosío is fully automated and the final segmentation results are adequately accurate (Figure  2-12d), the computational load of the algorithm is extremely high. The processing time of around 14 minutes is completely unacceptable for real time applications. 2.2.9 Boundary segmentation using Partial active shape model (Hybrid method 2010) In 2010, Yan et al. [11] proposed a fully automatic TRUS image segmentation method, where a partial active shape model (PASM) was used in order to improve the defects of previous algorithms specially in shadow areas. The difference of PASM method with common deformation strategies is that only partial salient contours are used for shape estimation and non-salient parts are removed. Therefore, the energy function consists of an extra energy term EPASM to prevent the fault deformation in the missing boundaries. The PASM term is a positive weighted parameter of distance between a point from the model and the corresponding point on the estimated shape. Similar to most of prostate segmentation algorithms, dark to bright transition from the inside to the outside of the prostate gland was considered as the main feature for computing the external energy. For this purpose, Normal Vector Profile (NVP) which is a set of sticks perpendicular to the initial model contour was used for removing non-salient contour points. The model continuity and curvature was preserved by the internal energy term which in turn was dependent on the average distance between all the model points and the position of two adjacent points.

40

2.2.10

Boundary segmentation using Graph cuts (Hybrid method-2011)

In 2011, Ghose et al. [33] presented a new statistical shape model approach using graph cuts in a Bayesian framework for automatic prostate outlining. K-means clustering was used to provide initial parameters required for Expectation Maximization (EM). The obtained posterior probabilities from EM were utilized in Markov Random Field (MRF) modeling to apply spatial constraints. The output of the MRF modeling was a labeled image consisting of a foreground (the prostate) and background (non-prostate). A method similar to the traditional Active Appearance Model (AAM) was used for the prostate segmentation. The aim of the AAM is matching the statistical model to a new image. For this purpose, the sum of squared difference of intensity between the model and the final shape is minimized. However, in their methodology, posterior probabilities obtained from MRF modeling were replaced with intensity.

41

Chapter 3
3 Methodology

The proposed fully automated prostate boundary segmentation method consists of two main phases: 1) Prostate model pose parameters estimation 2) Model deformation strategy. In the first phase, the approximate location of the prostate in a TRUS image is estimated. The prostate model pose parameters including scaling, rotation, and translation are obtained from a new pattern recognition and template matching techniques. In the second phase, the initial model with the estimated pose parameters is deformed in order to best fit on the prostate boundaries. Numerous probabilistic techniques including Expectation Maximization (EM) and Markov Random Field (MRF) are utilized as an external force to deform the initial model and a new internal force based on the geometric transformation is used to preserve the curvature and smoothness of the model and prevent the fault deformation. The schematic diagram of the methodologies and algorithms implemented in the proposed prostate boundary segmentation is illustrated in Figure  3-1.

42

Phase (1) Initial model position estimation

Original input TRUS image

Phase (2) Model deformation
Extracting pixels inside the field of view

Strip construction

Representative pattern construction

Template matching using normalized crosscorrelation

Expectation maximization (Gaussian of Mixture Models)

Heuristic Threshold

Probability distribution parameters

Return back the strips into the circular shape

Markov Random Field (MRF) modeling

Model construction using PDM

Local search in Perpendicular windows Sliding inner products Model deformation Model pose parameters (Scaling, Rotation, Translation)

Surface smoothing

Initial model location estimation

Final segmentation

Figure  3-1 The schematic diagram of the proposed prostate boundary segmentation algorithm

43

3.1

Model pose parameters

In the TRUS images, all the edges and speckle noises are approximately perpendicular to the line drawn from the center of the probe. The main idea behind the proposed method is that the image can be analyzed as a set of strips such that all the edges and speckle noises appear as a horizontal line in each strip. This characteristic leads to a significant reduction in the computation time as compared to all multi-orientation techniques. 3.1.1 Pre-processing

The strips or radial windows are running from the exterior of the probe location to the image margins. For this purpose, a semicircle is drawn from the center of the ultrasound probe. Radius length of the semicircle depends on the probe size. The radii of the semicircle have an angle with the horizontal axis of the image. For each angle, a tangent line to the semicircle is considered as a starting point of a perpendicular line. Figure  3-2 shows the method of drawing the perpendicular lines in an image.

Figure  3-2 Perpendicular lines drawn from the starting point on the tangent line to the endpoint at image margins

Each strip is formed by considering each perpendicular line drawn from the tangent line as a column of a matrix. In order to cover the entire image data inside the field of view of the

44

ultrasound images, the strips are formed at every one degree from shown in Figure  3-3.

to

as

(a)

(b)

(c)
Figure  3-3 Strip structure (a) strip position at (b) edges and speckle noises appear as horizontal lines in the strip (c) a set of strips from 15 to 165 degree (the red window is the strip shown in (b))

One of the important factors that directly impacts the segmentation results is the width of the strip. The parameters that determine the width of the strip are the number of active transducer elements in the ultrasound probe and the width of the transducer [38].After extracting the strips from the TRUS images, a concise and efficient template, best representative of the prostate boundaries is required in the template matching procedure. Studies on the properties of prostate shape in ultrasound images show that upper and lower boundaries of the prostate have different features. One of the most effective features of the upper boundaries is the dark 45

to bright transition of pixel gray-levels from the inner gland to outer region of the prostate. In contrast to upper boundaries, lower boundaries are always close to the ultrasound probe and there is a bright to dark transition of the intensities. Therefore, it is required to construct two distinct representative patterns for the upper and lower boundaries. 3.1.2 Representative patterns

A set of prostate boundary templates collected from training images with known background truths are required to construct a set of representative patterns. This pattern construction is performed using a conventional dictionary learning method. These methods are capable of generating an optimized dictionary from a set of training data. Among a variety of dictionary learning algorithms, the iterative least squares dictionary learning algorithm (ILS-DLA) presented by Engan et al [39] is applied in our approach, because of its simplicity and efficiency. In ILS-DA, an optimized dictionary is iteratively updated from a set of training

templates by solving the optimization problem defined by  where  subject to  
Eq.  3.1

is a training matrix including training data vectors and of a set of sparse coefficient vectors

is the . The

coefficient matrix consisting

cardinality is denoted by   which determines the sparseness factor of the coefficient vectors. In order to form the training matrix, each prostate boundary template (Figure  3-4a) is divided into a column-wise vector . The training matrix is then obtained by vertically

concatenating a set of these column-wised vectors. The straight forward solution for the optimization problem (Eq.  3.1) is the minimization of the Frobenius norm. In cases where there is an existing solution, the minimization problem demands a tedious computation. To

46

overcome this issue, a two-step iterative solution approach is proposed as an alternative strategy. In the first step, the coefficient matrix
()

is computed by
()

(

()

)

(

()

)

Eq.  3.2

where an initial dictionary step, the dictionary the first step. Thus,

( )

provided by a user is used in the first iteration. In the next

is updated by utilizing the computed coefficient matrix obtained from

(

)

(

()

)

()

(

()

)

Eq.  3.3

The iterative process continues until the difference between updated dictionaries converges to a pre-set error. An example of representative pattern construction from a set of upper

(a)

(b)

(c)

(d)

(e)

Figure  3-4 Representative pattern construction (a) an upper boundary observation at (b) zoom to region of interest (c) A set of upper boundary observations from different images (d) upper boundary representative pattern (e) result of the same procedure for the lower boundary

47

boundary observations is illustrated in Figure  3-4. The next section explains how these constructed representative patterns are utilized in prostate boundary recognition. 3.1.3 Template Matching using Normalized Cross-correlation

Cross-correlation is commonly used for similarity measurement between two signals and it is the basic statistical approach to image registration. The cross-correlation of the image the template is defined by ( )  ( ) ( ) and

Eq.  3.4

where

and

are the location of the template on the image. Cross-correlation is very

sensitive to bright spots and linear changes of intensities in the template and the image. This drawback can cause an inaccurate matching result. Therefore, normalized cross-correlation (NCC) [40] has been extensively used in the template matching applications due to its advantages over traditional cross-correlation. Normalized cross-correlation is indicated by   [ ( ( ) ) ] (   ( ) )  
Eq.  3.5

where  is the mean of the image under the template window and template. The value of (

is the mean of the is the strip

) varies between -1.0 to 1.0. In our method,

formed in the preprocessing part (Figure  3-5a) and

is the representative pattern

(Figure  3-5b). The normalized cross-correlation of a strip and the upper representative pattern is computed and illustrated in Figure  3-5c. The threshold value for the cross correlation determines whether the region under the template window belongs to the prostate boundary. The target is identified when ( 48 )exceeds the threshold value (Figure  3-5d).

Due to the difference in the dimensions of the NCC matrix (Figure  3-5c) and the input strip (Figure  3-5a), relative offsets displace the peaks of the NCC matrix to the corresponding position in the boundary highlighted strip (Figure  3-5d).

(a)

(b)

(c)

(d)

(e)
Figure  3-5 Template matching using Normalized cross-correlation (a) an extracted strip (b) upper boundary representative pattern (c) result of normalized cross-correlation (d) processed strip resulted from thresholding (e) a set of processed strips from 15 to 165 degree (the red window is the strip shown in (d))

The heuristic threshold value in our proposed method is defined by ( )
Eq.  3.6

49

where

 (

)

Eq.  3.7

and

(

)

. In the above equations,

and

are the row and column size of the computed normalized cross-correlation and determines the sensitivity of the matching process. Alternating from 0 to 1 results in

sweeping the threshold from mean to maximum of NCC. Figure  3-6a and Figure  3-6b depict the reconstruction procedure resulting from processing the strips separately and putting them back into a circular shape. A similar technique is applied to lower boundary detection. The

(a)

(b)

(c)

(d)

Figure  3-6 Boundary highlighted image construction (a) putting back the strips into the circular shape (b) upper boundary highlighted image (c) lower boundary highlighted image (d) boundary highlighted image resulted from the lower and upper boundary addition

50

only difference is that the lower boundary representative pattern is replaced for normalized cross-correlation (Figure  3-6c). Final boundary detected image is achieved by adding the output of the upper and lower boundary detected images together (Figure  3-6d). 3.1.4 Prostate Model Construction

The prostate model construction method consists of three main parts: 1) Manual prostate boundary segmentation of a set of training examples 2) Aligning the training set 3) Capturing the statistics of a set of aligned shapes. In the manual segmentation step, a trained observer places a set of points on the prostate boundary. The points will be automatically sorted by the minimum possible distance. Therefore, it is not necessary to place the points in any particularly order. Cubic interpolation is then applied on the located points in order to form a

(a)

(b)

(c)

(d)

(e)

(f)

Figure  3-7 Prostate model construction (a) selected points by an expert (b) cubic interpolation (c) a set of boundaries (d) translation alignment (e) scale alignment (f) constructed model

51

continuous contour on the prostate boundary. To build a model, a set of manually segmented training examples is required. These shapes must be aligned together by translating, scaling and rotation to be as close as possible. Alignment is performed by minimizing the distance between equivalent points on different shapes. Finally, the prostate model is constructed from a set of aligned shapes based on the point distribution model (PDM) and principal component analysis (PCA) described in [22] and [41] (Figure  3-7). The final step of the boundary segmentation method is the computation of the model pose parameters. For this purpose, a set of sliding inner products of the constructed model (Figure  3-7f) (with different scales in and directions) and the highlighted boundary image (Figure  3-6d) are calculated. and

are selected to be the scaling parameters of the model when the inner product of that scale is the global maximum among all other scales. The displacement of the centers of the TRUS image and the scaled model in the location that best fit the boundaries determines the translation parameters and .

Figure  3-8 Finding the model pose parameters using sliding inner product of the model and boundary highlighted image

52

3.2

Model deformation

The initial model which is obtained is a reliable approximation of the prostate location. However, with precise inspection on model boundaries, it was realized that some prostate boundaries are far from the initial model. Therefore, these distances should be reduced as much as possible by utilizing a model deformation strategy. In deformation strategies, based on impact of internal and external forces, the location of each initial model point is displaced so that the new point exactly situate on the prostate boundary. 3.2.1 Prostate model important points

The question that now arises is which points of the contour model should be designated for the model deformation procedure? Two important parameters that directly impact the deformation results are position of each selected point and the total number of the selected points. The more selected points result in higher computational time which is in contrast to real time applications. On the other hand, if the number of selected points is not chosen adequately, the performance of the deformation strategy will significantly reduce. For this purpose, Mahdavi et al. [42] offered six fundamental points that are best representative of the prostate shape. These points which are depicted in Figure  3-9 are: 1) mid-posterior (P.1) 2) lowest posterior lateral (P.3) 3) extreme right (P.7) 4) mid anterior (P.11) 5) intersection of the perpendicular line drawn from the midpoint of P.3 and P.7 with the model boundary (P.5) 6) intersection of the perpendicular line drawn from the midpoint of P.7 and P.11 with the model boundary (P.9). In order to increase the accuracy of the deformation procedure, we added one more point between each pair of the adjacent aforementioned points. Thus, for the

53

right side of the prostate, the total number of points is increased to 11 points (Figure  3-10) and with regard to the presence of bilateral symmetry, overall the number of the designated points for both sides of the prostate extents to 20 points.

Figure  3-9 Prostate six important points (Mahdavi et al. [42])

Figure  3-10 Prostate 11 fundamental points for each side of the prostate

After determining the position of the fundamental points, a local search is performed on the surrounding points in order to detect the prostate boundaries. The most common external force used in deformation algorithms is the gradient of pixel gray levels in the normal direction of the model surface. However, it is proven that gradient is not a reliable external force due to the presence of shadow artifacts and micro-calcifications in ultrasound images. In order to overcome the stated drawback, we utilized Markov Random Field (MRF). The MRF is a powerful statistical modeling framework which has been widely used in image 54

processing and computer vision applications. In our case, the use of MRF provides two advantages. First, it removes remarkable amounts of micro-calcifications and the bright spots inside the prostate gland. Second, it fills the gaps and dark spots existing in the surrounding tissue. Consequently, the surrounding tissue becomes more homogenous and significant improvement in discontinuous boundaries is achieved. One of the prerequisites for MRF is the initial classification, that is, each pixel of the image is required to be labeled as prostate or non-prostate tissue. Due to the wide gray- level intensity variation in TRUS images, a global constant threshold does not provide an appropriate classification. Therefore, an adaptive threshold is required for every single image. The other prerequisites for MRF are the probability distribution parameters of each class. For instance, for a set of Gaussians, these parameters might be the means and covariance. Expectation maximization (EM) algorithm is a powerful method in order to solve the maximum-likelihood parameter estimation problem. In our case, the EM algorithm [43] is utilized for estimating the distribution parameters and computing the adaptive threshold value. 3.2.2 Adaptive threshold and Probability distribution parameters via EM algorithm

To find the probability distribution parameters, it is necessary to determine the type of the distribution functions in advance. This task should be accomplished by analyzing the image histogram. An investigation on the histogram of TRUS images indicates that a significant amount of pixels have low intensity value (Figure  3-11). Most of these pixels are uninformative and located outside of the field of view. By excluding these pixels, the data set is reduced to a vector of image intensities, i.e., . A study on the histogram

of the reduced data set shows that a mixture of two Gaussian models can be suitable 55

representation of the intensity distribution (Figure  3-12). In general, a mixture model is a probabilistic model for M component densities mixed together. That is,

(

)



(

)

Eq.  3.8

where

is a set of parameters for the probability distribution function such that 

. The mixing

coefficient of each component is defined by

. In order to find the

probability distributions parameters, the EM algorithm optimizes the incomplete-data loglikelihood expression

( (

))

 (

)



(

(

))

Eq.  3.9

by applying a two-step iterative approach. These steps are referred to as expectation step (Estep) and maximization step (M-step). First, the algorithm computes the expected value of the likelihood with respect to the initial distribution parameters and the given data set. In the second step, the values of the parameters that maximize the expected likelihood are updated. A summary of the parameter estimation equations [44] for a set of Gaussian component distributions with mean and covariance are given below

 (

)

Eq.  3.10

 

( ( )

)

Eq.  3.11

56



( 

)( (

)( )

)

Eq.  3.12

where

are a set of appropriate parameters which are guessed for the

component in the

expectation step. In the above equations, every single pixel is considered as an individual data point. In

other words, the upper bound of all summations is equal to the total number of pixels . Since the EM algorithm updates the distribution parameters in an iterative manner, the large value of will cause high computation load. In order to reduce the computational

complexity, we propose a faster approach for image processing applications. The new approach is based on the property that all image intensities are integer and limited to a particular range. In our approach, instead of utilizing each image pixel as an individual data, the total number of identical intensity pixels is considered. As a result, the upper bound of all summations is decreased to the number of image gray-levels (e.g. 256). That is, all pixels with identical gray-level are only employed once in the computations. For this purpose, we derive the distribution parameters based on the expected value theorem as follows:



(

)



(

)

Eq.  3.13

where

is the total number of pixels that their intensity value is

such that 

.

From Bayes' theorem, we can write the posterior probability of the component as
( )

(

)

(

)

Eq.  3.14

and by substituting (Eq.  3.14) in (Eq.  3.13), we obtain

57



(

)



(

)

Eq.  3.15

Similarly, it is easy to show that

 (

)



(

)

Eq.  3.16

The left hand sides of equations (Eq.  3.15) and (Eq.  3.16) are the nominator and denominator of equation (Eq.  3.11). Hence, we can express the mean value by   ( ( ) )

Eq.  3.17

A similar technique is applied for calculating the variance. That is, from the expected value formula defined by ( we obtain   ( ( ) ) ) ( )
Eq.  3.18

(

)

Eq.  3.19

Finally, by substituting equation (Eq.  3.16) in equation (Eq.  3.10), the mixing coefficient parameters becomes



(

)

Eq.  3.20

The upper summation bound in equations (Eq.  3.17), (Eq.  3.19) and (Eq.  3.20) clearly indicates a significant computation complexity reduction compared to the traditional EM

58

algorithm.

These equations perform both E-step and M-step simultaneously until

convergence occurs. Now that we have the probability distribution parameters, we can obtain the adaptive threshold value. The threshold value, as illustrated in Figure  3-12, is determined by the intersection between prostate and non-prostate probability distribution functions. Initial pixel labeling required for MRF is performed by assigning a label -1 to the intensities less than the threshold value, and +1 to those pixels that have intensity greater than the threshold.

x 10 6

4

5

Number of pixels

4

3

2

1

0
0 50 100 150 200 250

Gray level
Figure  3-11 Typical histogram of TRUS images

59

Figure  3-12 The histogram of the pixels inside the field of view and the probability distributions of the prostate and non-prostate regions

Figure  3-13b shows the binary image resulting from applying the threshold on an original TRUS image.

(a)

(b)

Figure  3-13 Binary image resulting from adaptive threshold (a) an original TRUS image (b) Binary image resulting from applying the adaptive threshold

60

3.2.3

Markov Random Field (MRF) modeling

In image analysis, contextual constraints are very crucial in interpreting visual information. The reason that Markov Random Field (MRF) theory [45] has been widely used in low-level and high-level computer vision problems is that it models context-dependent image pixels. In order to utilize the MRF theory, first it is essential to determine three fundamental MRF components: Site, neighborhood and clique. In 2D images, each image pixel represents the site of a rectangular lattice. For an image of size ( ) . A neighborhood system , a set of sites is denoted by relates each site to its neighbors.

In our approach, we used the second-order neighborhood system so that every single site is surrounded by 8 of its neighbors. For each site, a clique is referred to a subset of

neighborhood sites. Depending on the order of the neighborhood system, a clique can be either in the form of a single-site, a pair of neighboring sites, a triple of neighboring sites and so on. By utilizing the adaptive threshold value obtained from the EM algorithm, we assigned a label value value by to each site in . In MRF, the probability that a random variable takes the

obeys a Gibbs distribution. That is, for a set of labeled random variables denoted , the probability is
( )

( ) where

Eq.  3.21

is a global control parameter called temperature and

is a normalizing constant .

The function ( ) is the energy over all potential cliques

and is given by

61

( )

 ( )

Eq.  3.22

where

is a set of all considered clique forms. ) of the

Once we have the a priori probability ( ) and the likelihood density (

observation , we use Bayesian rule to update the label values [46]. The posterior probability then becomes ( ) ( ) ( )

(

)

Eq.  3.23

A comparison between the posterior probabilities determines the class of each pixel. The density function ( ) does not affect the labeling process since it has the same value for both observations. The iterative labeling process continues until no more alterations apply to any label. A comparison between the initial thresholded image and the MRF labeled image is illustrated in Figure  3-14. As expected, the surrounding tissue has become more homogenous and a large number of the micro-calcifications are removed from the inside of the prostate

(a)

(b)

Figure  3-14 A comparison between binary image and MRF labeled image (a) Binary image resulting from applying the adaptive threshold (b) MRF labelled image

62

gland. These improvements positively impact on the accuracy of the model deformation strategy. 3.2.4 Model deformation strategy

In the deformation procedure, a local search displaces the initial model points in order to best fit on the prostate boundaries. The search area around each model point, as illustrated in (Figure  3-15), is a window perpendicular to the model surface. Each pixel inside the windows takes a value of -1 or +1 based on its corresponding label in the MRF image. To find the new boundary points, we need to define a representative pattern for the prostate boundaries. This pattern should detect the transition line between the prostate and nonprostate regions. For this purpose, we assigned -1 (prostate label) to each lower half element of the pattern and +1 (non-prostate label) to the upper half elements. The pattern is then correlated with the labeled pixels located inside the windows to find the best match coordination.

Figure  3-15 Perpendicular windows in deformation strategy

63

The points with updated coordinates outline a deformed boundary surface. A comparison between the initial model and the deformed model is shown in Figure  3-16. It can be seen that a significant improvement is achieved in detecting the boundaries by deforming the initial model. However, still some points are far away from the prostate boundaries and the deformed model is no longer similar to the prostate shape. In order to overcome these drawbacks, we used 2D geometric transformations [47] for returning back the deformed model into the prostate shape.

(a)

(b)

Figure  3-16 Model deformation (a) Initial model (DSC 93.0%) (b) The deformed model after one iteration (DSC 94.39%)

It is required to obtain the transformation parameters in such a way that the transformed initial model points be as close as possible to the deformed model points . These

parameters can be obtained by solving the minimization problem defined by  where 
Eq.  3.24

is a combination of translation, rotation and scaling parameters. That is,

64

 [

 ][

 ][

]

Eq.  3.25

Consequently,

[

]

Eq.  3.26

In the ideal case, the transformation matrix corresponding reference point

maps exactly each model point

into its

. Therefore, it can be expressed as

[ [ ][

]
Eq.  3.27

]

For each point, the matrix multiplication gives

Eq.  3.28

Then, by adding both sides of the above equations for all the points we obtain

Eq.  3.29

[

]

[

] [ ]

The equation (Eq.  3.29) is a linear system that can be easily solved using LU factorization.

65

Although the assumption made in equation (Eq.  3.27) does not always occur, the proposed solution is a close approximation of estimating the transformation parameters. Now, as illustrated in Figure  3-17, we can obtain a prostate shape model that its surface has minimum distance from the deformed model. This transformed model is then considered as an initial model to be used in the deformation procedure. The iterative deformation process continues until the changes in the surface of the prostate boundary converge (Figure  3-18).

(a)

(b)

Figure  3-17 Model smoothing (a) The deformed model after one iteration (DSC 94.39%) (b) Transformed model (DSC 95.0%)

66

Figure  3-18 Iterative deformation procedure (DSC values 1) 93.0% 2) 94.3% 3) 95.8% 4) 95.8% 5) 96.4% 6) 96.1%)

67

Chapter 4
4
4.1

Experimental results
Model pose parameters

The proposed segmentation method has been applied to 50 TRUS images. The size of the images is 768 by 1024 pixels. In order to demonstrate the effectiveness and robustness of the approach, the training images used in the pattern construction step (Figure  3-4) are kept separate from the testing images (Figure  4-2). To speed up the process in the model pose parameter determination step, the boundary highlighted images and the constructed model are resized to 1/8 of their original size. Shrinking the model and the boundary highlighted image drastically reduces the computation time. Dice similarity coefficient (DSC) is adopted to evaluate the reliability of the method performance. DSC quantifies the overlap between the automatic and manual segmentations and the correspondence between two images. DSC is defined as ( ) ( )/( ) where and represent binary label images.

The final segmentation result of the proposed algorithm is directly related to the value of the sensitivity factor ( in Eq.  3.6). To find the optimum sensitivity value, , different values of 68

are applied to all of the testing images. The resulting box plot illustrated in Figure  4-1 indicates the impact of the sensitivity factor on the segmentation results. Optimum value is selected as based on the values of the median, lower and upper quartile, smallest and

largest observations.

0.95 0.9

Dice coefficient %

0.85 0.8 0.75 0.7 0.65 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1

k
Figure  4-1 Box plot showing the relationship between the sensitivity factor and Dice coefficient values for all testing images

The transformation parameters and the DSC values of 10 testing images computed using optimum sensitivity are given in Table  4-1. The computation times are obtained from running the program in MATLAB environment using an Intel core i7 processor (3.4 GHz - 12GB RAM).

69

Table  4-1 affine transformation parameters and Dice similarity measurement results

Image No.

tx
(pixels)

ty
(pixels) 48 8 40 80 32 -8 0 32 64 0

sx
0.41 0.41 0.53 0.41 0.44 0.54 0.55 0.41 0.48 0.55

sy
0.46 0.57 0.48 0.41 0.55 0.62 0.61 0.57 0.42 0.61

DSC %

Time (sec)

1 2 3 4 5 6 7 8 9 10

40 40 8 24 48 48 112 32 16 0

93.2% 92.4% 92.7% 90.8% 93.6% 92.8% 92.1% 91.2% 92.0% 93.0%

3.08 3.16 3.06 3.05 3.10 3.05 3.03 3.12 3.08 3.07

The comparison of manual and automatic segmentation results of 10 testing images in Table  4-1 is illustrated in Figure  4-2. Manually segmented boundaries are shown in green and the automatically segmented regions are depicted in red.

70

Figure  4-2 Manual and automatic prostate boundary segmentation results in model initialization

71

4.2

Model deformation

The proposed fully automated segmentation algorithm has been applied to 50 TRUS images. In order to find the optimum value for the variables used in the methodology, we considered 20 images as a training set and 30 images as a testing set. We have examined the impact of each variable on the performance of the algorithm by analyzing the Dice Similarity Coefficient (DSC). According to the boxplot in Figure  4-3, it can be observed that the DSC median value is almost identical for all global controls greater than 2 and there exist many false deformations in this range. Therefore, the optimum value for the global control parameter in MRF equation is selected to be 0.75. The width and length of the

perpendicular windows are other important parameters in determining the algorithm accuracy. The boxplot in Figure  4-4 shows that the interval between 120 and 160 pixels is a proper choice for window's length. Due to the fact that the size of the perpendicular windows directly impacts on the computation complexity, we selected the window's length of 120 pixels. This length also has the greatest DSC median value among all other choices. The optimum value of the last parameter is selected based on the data shown in Figure  4-5. Since this boxplot does not provide a certainty about selecting the window's width, we made our decision based on a trade-off between accuracy and computation complexity. It can be observed that the interval between 21 and 25 pixels is the best width choice because of the high median DSC value and less computation complexity. After obtaining the optimum parameters from the training set, the algorithm is evaluated on the testing set. The segmentation results of 10 testing images are listed in Table  4-2.

72

0.96

0.94

Dice coefficient %

0.92

0.9

0.88

0.86

0.84
0.25 0.5 0.75 1 1.25 1.5 1.75 2 2.25 2.5 2.75 3 3.25 3.5 3.75 4 4.25 4.5 4.75 5

Global control

Figure  4-3 The boxplot of the global control parameter

in MRF

0.95

Dice coefficient %

0.9

0.85

0.8

50 60 70 80 90 100 110 120 130 140 150 160 170 180 190 200 210 220 230 240 250

Length (Pixels)

Figure  4-4 The boxplot of the perpendicular window's length

73

0.98

0.96

Dice coefficient %

0.94

0.92

0.9

0.88

0.86 5 9 13 17 21 25 29 33 37 41 45 49 53 57 61 65 69 73 77 81 85

Width (Pixels)

Figure  4-5 The boxplot of the perpendicular window's width

Table  4-2 Comparison between the initial model and the deformed model
DSC% Initial

Image

#

model

Time (sec)

DSC % Deformed

Time (sec)

DSC% Improved

Total Time (sec)

1 2 3 4 5 6 7 8 9 10

93.2% 92.4% 92.7% 90.8% 93.6% 92.8% 92.1% 91.2% 92.0% 93.0%

3.08 3.16 3.06 3.05 3.10 3.05 3.03 3.12 3.08 3.07

96.3% 95.7% 93.6% 89.2% 95.7% 94.1% 96.3% 94.7% 93.4% 96.6%

6.43 6.35 6.51 6.67 6.15 6.23 6.25 6.37 6.30 6.49

3.1% 3.3% 0.9% -1.6% 2.1% 1.3% 4.2% 3.5% 1.4% 3.6%

9.51 9.51 9.57 9.72 9.25 9.28 9.28 9.49 9.38 9.56

74

Segmentation results comparison before and after the deformation strategy indicates a noticeable DSC improvement. The average DSC value is improved to 93.9% compared with the average DSC value 90.6% of the initial model before deformation. Figure  4-6clearly shows the improvement in segmenting the prostate boundaries. In this figure, manually segmented boundaries are shown in green and the automatically segmented regions are depicted in red.

75

Figure  4-6 Comparison between the initial model (Left) and the deformed model (Right)

76

4.3

Validation and performance evaluation

According to the explanation given in the 2012 survey [9] and most of the published papers, the quantitative comparison among the proposed algorithms is extremely difficult due to the lack of access to the public datasets and availability of software. Therefore, vast majority of the published papers have compared their results with the gold standard method, i.e., manually segmented images. Numerous error-based measurement methods have been utilized in order to accomplish the quantitative evaluation. These evaluation metrics are summarized as follows [9]: Hausdorf distance (HD): Given a set of finite points and B

(

) )

( ( (

) ( 

))
Eq.  4.1

Where (

)

Mean Distance (MD): Given signed distance

between each corresponding points

between the algorithmic segmented surface and ground truth.



Eq.  4.2

Mean absolute distance (MAD):

 Maximum distance (MaxD):

| |

Eq.  4.3

77

| |

Eq.  4.4

Dice similarity coefficient (DSC): TP=true positive, TN=true negative, FP=false positive, and FN=false negative

( Sensitivity (SN):

)

(

)

Eq.  4.5

Eq.  4.6

Accuracy (AC):

Eq.  4.7

Overlap (OV) and overlap error (OE):

Eq.  4.8

A quantitative comparison of performance evaluation between the reviewed algorithms (given in Chapter 2) and our proposed method is listed in Table  4-3. The segmentation time comparison among existing algorithms is given in Table  4-4.

78

Table  4-3 Quantitative evaluation of prostate boundary segmentation in TRUS imaging

Reference

Year

Metric

Performance Value

Validation

Shen et al. [23] Abolmaesumi [24] Gong et al. [25] Sahba et al. [26] Zaim [27] Badiei et al. [28] Zaim et al. [29] Cosio [30] Yan et al. [31] Ghose et al. [33] Proposed method

2003 2004 2004 2005 2005 2006 2007 2008 2010 2011 2012

MD OV MD HD MD OV SN AC MAD MaxD OV MAD MaxD MAD DSC DSC

3.2( 1.28mm) 0.87 pixels 98% 1.36 mm 3.42 1.52 mm 3.3 1.3 pixels 91% 97.4 1% 93.5 1.9% 0.67 mm 2.25 0.56 92% 1.65 mm 3.93 mm 2.01 mm 97 0.01 % 93.9±2.7%

8 images 6 images 125 images 19 images 10 images 17 images 10 images 22 images 10 datasets 23 datasets 3 datasets 50 images

79

Table  4-4 Segmentation time comparison Reference Year Image size Processor Time

Shen et al. [23] Abolmaesumi [24] Gong et al. [25] Sahba et al. [26] Zaim [27] Badiei et al. [28] Zaim et al. [29] Cosio [30] Yan et al. [31] Ghose et al. [33] Proposed method

2003 2004 2004 2005 2005 2006 2007 2008 2010 2011 2012

N/A 512x512 256x256 N/A 489x382 480x640 489x382 512x512 640x480 348x237 768x1024

500 MHz N/A P4 ­ 2GHz N/A 789MHz P4 ­ 1.7 GHZ N/A 2 GHz Core 2 1.86GHz Core 2 Duo 1.5 GHZ i7 ­ 3.4 GHz

64 sec N/A 5 sec N/A 12 sec 25.35 sec N/A 14 min 0.3 sec (C++) 5.97 sec 9.5 sec

80

Chapter 5
5 Conclusion and Future work

In this study, a novel fully automated prostate boundary segmentation method for ultrasound images is presented. The comprehensive literature review shows that hybrid algorithms which combine the edge-based, texture-based and model-based techniques for prostate boundary segmentation are more robust compared to algorithms that only employ one of these steps. The two-phase proposed hybrid method first utilizes edge-based and modelbased techniques to estimate the initial model position in TRUS images and then in the deformation strategy, a combination of texture-based and model-based techniques determine the final prostate boundary contour.

5.1

Discussion on initial model pose parameters

We have presented a new model initialization technique that automatically estimates the model pose parameters. In order to reduce the computational complexity, we first decompose TRUS images into a set of strips running from the ultrasound probe, because template matching is performed only in one direction. In each strip, a representative pattern identifies the prostate boundaries based on normalized cross correlation. The other advantage of our proposed algorithm is that the final results are obtained without applying any preprocessing 81

filter which imposes a massive computation. The obtained results demonstrate that the template matching based on a combination of normalized cross-correlation and optimized representative patterns reliably performs in noisy images.

5.2

Discussion on model deformation strategy

We have presented a new model deformation strategy based on probabilistic approaches. Markov Random Field (MRF) theory is utilized in order to strengthen the boundary edges and to remove the micro-calcifications inside the prostate gland. The probability distribution parameters are obtained from Expectation Maximization algorithm. In order to reduce the computational complexity, we propose a faster EM approach. In this method, instead of considering each image pixel as individual data, we used the number of pixels that have identical intensity values. We also exclude all uninformative pixels located outside of the field of view to obtain more accurate probability distribution parameters. Furthermore, we develop a new internal force energy for our model deformation strategy where 2D geometric transformations are utilized to preserve the prostate model shape. The results of this study have shown that the proposed deformation strategy is a reliable technique especially for the images with shadow artifacts.

5.3

Limitations

It is shown that the segmentation results are promising for most of our TRUS images. However, there are a few limitations in the proposed algorithm that should be considered. For instance, the final prostate boundary contour is highly dependent to the position of the initial model. That is, if the model pose parameters are inaccurately estimated in the first phase, the model deformation strategy in the second phase cannot detect the prostate boundary edges

82

precisely. The fault model initialization is observed when the upper boundary of the bladder is also presents in the TRUS images. In this case, the upper boundary of the bladder is mistakenly identified as a prostate upper boundary and the pose parameters will be estimated based on the position of the bladder.

5.4

Future work

In order to overcome the drawback mentioned in the previous section, we plan to remove the negative impact of the presence of the bladder by applying some constraints to the algorithm. Since the lower boundary of the prostate is always close to the ultrasound probe, the distance between the model surface and the probe center can be considered as a constraint for the algorithm. This distance should not exceed beyond a specific level. Another important consideration is the issue of the process computation time. Despite the fact that we significantly reduced the computation complexity, the algorithm still is not fast enough to meet the real time therapy. In order to speed up the computations, instead of applying MRF on the entire image, we can consider only those pixels that are located inside the perpendicular windows. Moreover, in our future work we plan to optimize the codes and implement them in C++. We also plan to provide more TRUS images from different datasets. Our TRUS image database is now limited to only three datasets (50 images). A more completed database can significantly improve our evaluations and it may also highlight the possible limitations of the algorithm.

83

References
[1] P. W. Tank and Thomas R Gest, Atlas of Anatomy, 1st ed.: Lippincott Williams and Wilkins, 2008. [2] M. Mitterbergera, W. Horningera, F. Aignerb, and G. M. Pinggeraa, "Ultrasound of the prostate," Cancer Imaging, vol. 10, pp. 40-48, 2010. [3] S.J. Berry, D.S. Coffey, P.C. Walsh, and L.L. Ewing, "The development of human benign prostatic hyperplasia withage," Urology, vol. 132, pp. 474-479, 1984. [4] A. Jemal et al., "Global cancer statistics," CA: A Cancer Journal for Clinicians, vol. 61, pp. 69-90, 2011. [5] Prostate Cancer Canada. (2012, July 29th) Prostate Cancer Canada Network (PCCN). [Online]. http://www.prostatecancer.ca/ [6] G. M. Villeirs, K. L.Verstraete, W. J. De Neve, and G. O. De Meerleer, "Magnetic resonance imaging anatomy of the prostate and periprostatic area: a guide for radiotherapists," Radiotherapy and Oncology, vol. 76, no. 1, pp. 99-106, 2005. [7] N. Makni et al., "Combining a deformable model and a probabilistic framework for an automatic 3D segmentation of prostate on MRI," International Journal of Computer Assisted Radiology and Surgery, vol. 4, no. 2, pp. 181-188, 2009. [8] P. A. Pinto et al., "Magnetic Resonance Imaging/Ultrasound Fusion Guided Prostate Biopsy Improves Cancer Detection Following Transrectal Ultrasound Biopsy and

84

Correlates With Multiparametric Magnetic Resonance Imaging," The Journal of Urology, vol. 186, no. 4, pp. 1281-1285, 2011. [9] S. Ghose et al., "A survey of prostate segmentation methodologies in ultrasound, magnetic resonance and computed tomography images," Computer Methods and Programs in Biomedicine, June 2012. [10] A. P. Dwhawan, Medical Image Analysis, 2nd ed.: Wiley, 2011. [11] P. Yan, S. Xu, Turkbey B, and J. Kruecker, "Discrete Deformable Model Guided by Partial Active Shape Model for TRUS Image Segmentation," Biomedical Engineering, IEEE Transactions on , vol. 57, no. 5, pp. 1158-1166, 2010. [12] Y. Zhan and D. Shen, "Deformable segmentation of 3-D ultrasound prostate images using statistical texture matching method," Medical Imaging, IEEE Transactions on , vol. 25, no. 3, pp. 256-272, 2006. [13] K. V. Ling F. Shao, W. S. Ng, and R. U. Wu, "Prostate Boundary Detection From Ultrasonographic Images," Journal of Ultrasound in Medicine, vol. 22, pp. 605-623, 2003. [14] R. Aarnink et al., "Edge detection in prostatic ultrasound images using integrated edge maps," Ultrasonics, pp. 635-642, 1998. [15] S.D. Pathak, D. R. Haynor, and Y. Kim, "Edge-guided boundary delineation in prostate ultrasound images," Medical Imaging, IEEE Transactions on , vol. 19, no. 12, pp. 1211-

85

1219, 2000. [16] Y. Liu, W. Ng, M. Teo, and H. Lim, "Computerised prostate boundary estimation of ultrasound images using radial bas-relief method," Medical and Biological Engineering and Computing, vol. 35, no. 5, pp. 445-454, 1997. [17] C. G. Keen W. D. Richard, "Automated texture-based segmentation of ultrasound images of the prostate," Computerized Medical Imaging and Graphics, vol. 20, no. 3, pp. 131-140, 1996. [18] William D. Richard James S. Prater, "Segmenting ultrasound images of the prostate using neural networks," Ultrasonic Imaging, vol. 14, no. 2, pp. 159-185, 1992. [19] R. Y. Wu, K. V. Ling, and W. S. Ng, "Automatic prostate boundary recognition in sonographic images using feature model and genetic algorithm," Jouranal of Ultrasound in Medicine, vol. 19, no. 11, pp. 771-782 , 2000. [20] S. D. Pathak, D. R. Haynor, and Y. Kim, "Edge-guided boundary delineation in prostate ultrasound images," Medical Imaging, IEEE Transactions on , vol. 19, no. 12, pp. 12111219, 2000. [21] M. Kass, A. Witkin, and D. Terzopoulos, "Snakes: Active contour models," International Journal of Computer Vision, vol. 1, no. 4, pp. 321-331, 1988. [22] T. Cootes, D. Cooper, C. Taylor, and J. Graham, "Active shape models--their training and application," Computer Vision and Image Understanding (CVIU), vol. 61, pp. 273-

86

297, 1995. [23] D Shen, Y Zhan, and C. Davatzikos, "Segmentation of prostate boundaries from ultrasound images using statistical shape model," Medical Imaging, IEEE Transactions on , vol. 22, no. 4, pp. 539-551, 2003. [24] R. Abolmaesumi and M.R. Sirouspour, "Segmentation of prostate contours from ultrasound images," Acoustics, Speech, and Signal Processing, 2004. Proceedings. (ICASSP '04). IEEE International Conference on , vol. 3, pp. III 517-520, 2004. [25] L. Gong, S.D. Pathak, D. R. Haynor, P. S. Cho, and K. Yongmin, "Parametric shape modeling using deformable superellipses for prostate segmentation," Medical Imaging, IEEE Transactions on , vol. 23, no. 3, pp. 340-349, 2004. [26] F. Sahba, H. R. Tizhoosh, and M.M.A Salama, "Segmentation of prostate boundaries using regional contrast enhancement," Image Processing, 2005. ICIP 2005. IEEE International Conference on , vol. 2, pp. II- 1266-9, 2005. [27] A. Zaim, "Automatic Segmentation of the Prostate from Ultrasound Data Using FeatureBased Self Organizing Map," Proceedings of Scandinavian Conference in Image Analysis, pp. 1259-1265, 2005. [28] S. Badiei, S. Salcudean, J. Varah, and W. Morris, "Prostate Segmentation in 2D Ultrasound Images Using Image Warping and Ellipse Fitting," Medical Image Computing and Computer-Assisted Intervention ­ MICCAI 2006, vol. 4191, pp. 17-24, 2006.

87

[29] A. Zaim and J. Jankun, "An Energy-Based Segmentation of Prostate from Ultrasouind Images using Dot-Pattern Select Cells," Acoustics, Speech and Signal Processing, ICASSP 2007. IEEE International Conference on , vol. 1, pp. I-297-I-300, 2007. [30] F. Arámbula Cosío, "Automatic initialization of an active shape model of the prostate," Medical Image Analysis, vol. 12, no. 4, pp. 469-483, 2008. [31] Pingkun Yan, Sheng Xu, B. Turkbey, and J. Kruecker, "Discrete Deformable Model Guided by Partial Active Shape Model for TRUS Image Segmentation," Biomedical Engineering, IEEE Transactions on, vol. 57, no. 5, pp. 1158-1166, 2010. [32] S. Ghose et al., "Texture Guided Active Appearance Model Propagation for Prostate Segmentation," Prostate Cancer Imaging. Computer-Aided Diagnosis, Prognosis, and Intervention, vol. 6367, pp. 111-120, 2010. [33] S. Ghose et al., "Statistical Shape and Probability Prior Model for Automatic Prostate Segmentation," Digital Image Computing Techniques and Applications (DICTA), 2011 International Conference on, pp. 340-345, 2011. [34] R. C. Gonzalez and R. E. Woods, Digital image processing, 3rd ed. Upper Saddle River, New Jersey: Pearson Prentice Hall, 2007. [35] P. Kruizinga and N. Petkov, "Computational model of dot pattern selective cells," Biological Cybernetics, vol. 83, no. 4, pp. 313-325, 2000. [36] N. Petkov and W. Visser, "Modifications of centersurround,spot detection and dot-

88

pattern detection selective operators," 2005. [37] D.E. Goldberg, Genetic algorithms in search, optimization, and machine learning.: Addison-wesley, 1989. [38] B. Beulen, A. Verkaik, N. Bijnens, M.Rutten, and F. Van de vosse, "Perpendicular ultrasound velocity measurement by 2D cross correlation of RF data. Part A: validation in a straight tube," Springer, Experiments in Fluids, vol. 49, pp. 1177-1186, 2010. [39] K. Engan, K. Scretting, and J. Husoy, "Family of iterative LS-based dictionary learning algorithms, ILS-DLA, for sparse signal representation," Digital Signal Processing, vol. 17, pp. 32-49, 2007. [40] J. Yoo and T. Han, "Fast Normalized Cross-Correlation," Springer, Circuits, Systems, and Signal processing, vol. 28, pp. 819­843, 2009. [41] A. C. Hodge, A. Fenster, B. Downey, and H. M. Ladak, "Prostate boundary segmentation from ultrasound images using 2D active shape models: Optimisation and extension to 3D," Computer Methods and Programs in Biomedicine, vol. 84, pp. 99-113, 2006. [42] S. S. Mahdavi, N. Chng, I. Spadinger, W. J. Morris, and S. E. Salcudean, "Semiautomatic segmentation for prostate interventions," Medical Image Analysis, vol. 15, no. 2, pp. 226-237, 2011. [43] A. P. Dempster, N. M. Laird, and D. B. Rubin, "Maximum Likelihood from Incomplete Data via the EM Algorithm," Journal of the Royal Statistical Society. Series B 89

(Methodological), pp. 1-38, 1977. [44] J. Bilmas, "A gentle tutorial of the EM algorithm and its application to parameter estimation for gaussian mixture and hidden markov models," U.C. Berkeley, ICSI-TR97-021, 1997. [45] S.Z. Li, Markov Random Field in Image Analysis, 3rd ed. Berlin: Springer, 2009. [46] S.Z Li, Markov Random Field Modeling in Computer Vision. Berlin, Heidelberg: Springer, 1994. [47] G. Arfken, Mathematical Methods for physicists, 3rd ed. Orlando, FL: Academic Press, 1985.

90

List of accepted publications
1) Rasa Vafaie, Javad Alirezaie, Paul Babyn, "A Fast Model-based Prostate Boundary Segmentation using Normalized Cross-correlation and Representative Patterns in Ultrasound Images", IEEE EMBS conference on biomedical engineering and sciences (IECBES), 2012, Langkawi, Malaysia. 2) Rasa Vafaie, Javad Alirezaie, Paul Babyn, "Fully automated model-based prostate boundary segmentation using Markov Random Field in ultrasound images", Digital Image Computing Techniques and Applications (DICTA), 2012 IEEE International Conference on, Fremantle, Western Australia.

91

